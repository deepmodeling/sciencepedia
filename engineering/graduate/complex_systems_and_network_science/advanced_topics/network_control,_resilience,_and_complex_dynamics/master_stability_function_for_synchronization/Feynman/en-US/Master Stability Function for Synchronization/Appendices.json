{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a direct test of the core Master Stability Function (MSF) logic. Given the network's spectral properties and the oscillator's stability function, you will determine which modes of perturbation will decay, leading to synchronization. This practice solidifies the fundamental mapping between the Laplacian eigenvalues $\\lambda_k$ and the stability parameter $\\alpha$, which is central to the MSF framework .",
            "id": "4286364",
            "problem": "Consider a network of $N$ identical, continuously differentiable oscillators with diffusive coupling over an undirected, connected graph. Let the node dynamics be given by $\\dot{x}_{i}=f(x_{i})$ and the coupling be through a smooth output function $h(x)$, with coupling strength $\\sigma0$. The coupling is structured by the combinatorial graph Laplacian $L$, so that the network equations can be written in the standard form\n$$ \\dot{x}_{i}=f(x_{i})-\\sigma\\sum_{j=1}^{N}L_{ij}h(x_{j}) $$\nAssume the coupling output Jacobian satisfies $D h(s)=I$ along the synchronous trajectory $s(t)$, and that the Jacobian $D f(s)$ exists.\n\nWithin the framework of the Master Stability Function (MSF), defined as the maximum Lyapunov exponent of the linear variational blocks parameterized by a scalar $\\alpha$ (Master Stability Function (MSF): $\\Lambda(\\alpha)$), suppose that stability is achieved when the MSF is strictly negative on an open interval $(\\alpha_{1},\\alpha_{2})$, with $(\\alpha_{1},\\alpha_{2})=(0.8,3.0)$.\n\nThe network Laplacian has the following spectrum (listed with multiplicities): $\\lambda_{1}=0$, $\\lambda_{2}=0.6$, $\\lambda_{3}=1.1$, $\\lambda_{4}=1.4$, $\\lambda_{5}=1.4$, $\\lambda_{6}=2.2$, $\\lambda_{7}=3.8$, $\\lambda_{8}=4.0$, $\\lambda_{9}=4.5$, $\\lambda_{10}=5.2$, $\\lambda_{11}=6.0$, $\\lambda_{12}=6.0$. The coupling strength is fixed at $\\sigma=0.75$.\n\nUsing only the foundational principles of linearization about the synchronous solution and mode-wise decomposition along the Laplacian eigenbasis, determine the integer number $S$ of linearly stable transverse eigenmodes of the synchronization state for this network at the given coupling strength. Count each nonzero Laplacian eigenvalue according to its multiplicity, and do not count the zero eigenvalue associated with perturbations tangent to the synchronization manifold. Because the interval $(\\alpha_{1},\\alpha_{2})$ is open, any mode whose parameter equals an endpoint is not stable.\n\nReport $S$ as an exact integer. No rounding is required.",
            "solution": "The validity of the provided problem statement is affirmed. It is scientifically grounded within the established framework of the Master Stability Function for network synchronization, is well-posed with all necessary information provided, and is stated in objective, formal language. There are no contradictions, ambiguities, or factual unsoundness. We may therefore proceed with a solution.\n\nThe problem asks for the number of linearly stable transverse eigenmodes of a synchronization state in a network of coupled oscillators. The stability of the synchronous state, $x_i(t) = s(t)$ for all oscillators $i=1, \\dots, N$, is determined by analyzing the evolution of small perturbations, $\\delta x_i = x_i(t) - s(t)$. The network dynamics are given by:\n$$ \\dot{x}_{i}=f(x_{i})-\\sigma\\sum_{j=1}^{N}L_{ij}h(x_{j}) $$\nLinearizing this system around the synchronous state $s(t)$ yields the variational equation for the perturbations:\n$$ \\dot{\\delta x_i} = Df(s(t))\\delta x_i - \\sigma\\sum_{j=1}^{N}L_{ij}Dh(s(t))\\delta x_j $$\nThe problem states that the Jacobian of the output function along the synchronous trajectory is the identity matrix, $Dh(s) = I$. The variational equation simplifies to:\n$$ \\dot{\\delta x_i} = Df(s(t))\\delta x_i - \\sigma\\sum_{j=1}^{N}L_{ij}\\delta x_j $$\nThis is a system of coupled linear differential equations. To decouple them, we project the perturbation vector $\\delta \\mathbf{x} = (\\delta x_1, \\dots, \\delta x_N)^T$ onto the eigenbasis of the graph Laplacian $L$. Since the graph is undirected, $L$ is a real symmetric matrix and possesses a complete orthonormal set of eigenvectors $v_k$ with corresponding real eigenvalues $\\lambda_k$ for $k=1, \\dots, N$. Any perturbation can be expressed as a linear combination of these eigenvectors with coefficients $\\eta_k(t)$ that are vectors in the state space of a single oscillator: $\\delta \\mathbf{x}(t) = \\sum_{k=1}^N \\eta_k(t) v_k$.\n\nSubstituting this decomposition into the vectorized form of the variational equations, we obtain a set of $N$ decoupled equations, one for each eigenmode:\n$$ \\dot{\\eta}_k = [Df(s) - \\sigma \\lambda_k I] \\eta_k $$\nThis equation has the generic form of the master stability equation, $\\dot{\\zeta} = [Df(s) - \\alpha I] \\zeta$, where the parameter $\\alpha$ for the $k$-th mode is given by $\\alpha_k = \\sigma \\lambda_k$. The Master Stability Function (MSF), $\\Lambda(\\alpha)$, is the maximum Lyapunov exponent of this generic equation. The $k$-th mode is linearly stable if and only if its corresponding maximum Lyapunov exponent is negative, i.e., $\\Lambda(\\alpha_k)  0$.\n\nThe problem states that synchronization is stable when the MSF is strictly negative, which occurs for $\\alpha$ in the open interval $(\\alpha_1, \\alpha_2) = (0.8, 3.0)$. Therefore, a transverse mode corresponding to a Laplacian eigenvalue $\\lambda_k$ is stable if its associated parameter $\\alpha_k = \\sigma \\lambda_k$ lies within this interval:\n$$ 0.8  \\sigma \\lambda_k  3.0 $$\nThe problem specifies a coupling strength of $\\sigma = 0.75$. The task reduces to checking this condition for each non-zero Laplacian eigenvalue given in the problem statement. The non-zero eigenvalues (transverse modes) and their multiplicities are:\n$\\lambda_2=0.6$, $\\lambda_3=1.1$, $\\lambda_4=1.4$ (multiplicity $2$), $\\lambda_6=2.2$, $\\lambda_7=3.8$, $\\lambda_8=4.0$, $\\lambda_9=4.5$, $\\lambda_{10}=5.2$, $\\lambda_{11}=6.0$ (multiplicity $2$).\n\nWe now calculate $\\alpha_k = 0.75 \\lambda_k$ for each eigenvalue and check if it falls in the interval $(0.8, 3.0)$:\n\\begin{itemize}\n    \\item For $\\lambda_2=0.6$: $\\alpha_2 = 0.75 \\times 0.6 = 0.45$. Since $0.45 \\notin (0.8, 3.0)$, this mode is unstable.\n    \\item For $\\lambda_3=1.1$: $\\alpha_3 = 0.75 \\times 1.1 = 0.825$. Since $0.825 \\in (0.8, 3.0)$, this mode is **stable**.\n    \\item For $\\lambda_4=1.4$ and $\\lambda_5=1.4$: $\\alpha_{4,5} = 0.75 \\times 1.4 = 1.05$. Since $1.05 \\in (0.8, 3.0)$, these two modes are **stable**.\n    \\item For $\\lambda_6=2.2$: $\\alpha_6 = 0.75 \\times 2.2 = 1.65$. Since $1.65 \\in (0.8, 3.0)$, this mode is **stable**.\n    \\item For $\\lambda_7=3.8$: $\\alpha_7 = 0.75 \\times 3.8 = 2.85$. Since $2.85 \\in (0.8, 3.0)$, this mode is **stable**.\n    \\item For $\\lambda_8=4.0$: $\\alpha_8 = 0.75 \\times 4.0 = 3.0$. Since the interval $(0.8, 3.0)$ is open, the endpoint is not included. This mode is unstable.\n    \\item For $\\lambda_9=4.5$: $\\alpha_9 = 0.75 \\times 4.5 = 3.375$. Since $3.375 \\notin (0.8, 3.0)$, this mode is unstable.\n    \\item For $\\lambda_{10}=5.2$: $\\alpha_{10} = 0.75 \\times 5.2 = 3.9$. Since $3.9 \\notin (0.8, 3.0)$, this mode is unstable.\n    \\item For $\\lambda_{11}=6.0$ and $\\lambda_{12}=6.0$: $\\alpha_{11,12} = 0.75 \\times 6.0 = 4.5$. Since $4.5 \\notin (0.8, 3.0)$, these two modes are unstable.\n\\end{itemize}\n\nTo find the total number of stable transverse eigenmodes, $S$, we count the modes identified as stable, respecting their multiplicities:\n\\begin{itemize}\n    \\item One mode from $\\lambda_3$.\n    \\item Two modes from the degenerate eigenvalue $\\lambda_4=\\lambda_5=1.4$.\n    \\item One mode from $\\lambda_6$.\n    \\item One mode from $\\lambda_7$.\n\\end{itemize}\nThe total count is $S = 1 + 2 + 1 + 1 = 5$.\nThere are $5$ linearly stable transverse eigenmodes for the given network and coupling strength.",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "Building upon the basic stability check, this problem requires you to first derive the network's properties from its structure. You will calculate the Laplacian spectrum for a path graph and use it to determine the minimum coupling strength $\\sigma_{\\min}$ needed to achieve synchronization for a given MSF type . This exercise demonstrates the crucial link between network topology, represented by the algebraic connectivity $\\lambda_2$, and the conditions required for stable collective behavior.",
            "id": "4286341",
            "problem": "Consider a network of $n$ identical oscillators with diffusive coupling on a simple undirected graph, modeled by\n$$\n\\dot{\\mathbf{x}}_{i} = \\mathbf{F}(\\mathbf{x}_{i}) - \\sigma \\sum_{j=1}^{n} L_{ij}\\,\\mathbf{H}(\\mathbf{x}_{j}), \\quad i=1,\\dots,n,\n$$\nwhere $\\mathbf{F}$ is the node vector field, $\\mathbf{H}$ is the coupling output function, $\\sigma$ is the scalar coupling strength, and $L$ is the combinatorial Laplacian $L = D - A$ of the underlying graph with degree matrix $D$ and adjacency matrix $A$. The network is a path graph on $n = 5$ nodes (i.e., a chain of $5$ nodes with $4$ edges, all weights equal to $1$). Assume the Master Stability Function (MSF) framework applies with variational modes parameterized by $\\alpha = \\sigma \\lambda$, where $\\lambda$ is a Laplacian eigenvalue. Suppose the master stability function (MSF) is of type II, meaning there exists a bounded interval $(\\alpha_{\\ell}, \\alpha_{u})$ with $0  \\alpha_{\\ell}  \\alpha_{u}$ such that all variational modes are linearly stable if and only if $\\alpha \\in (\\alpha_{\\ell}, \\alpha_{u})$. Take $\\alpha_{\\ell} = 1$ and $\\alpha_{u} = 10$.\n\nTasks:\n- Compute the full Laplacian spectrum $\\{\\lambda_{k}\\}_{k=1}^{5}$ of the path graph on $5$ nodes and identify the algebraic connectivity $\\lambda_{2}$ and the largest eigenvalue $\\lambda_{5}$.\n- Using only fundamental definitions of Laplacian eigenmode decomposition and linearization of the synchronized manifold, derive the condition on $\\sigma$ under which complete synchronization is linearly stable for a type II MSF.\n- Using the given $(\\alpha_{\\ell}, \\alpha_{u})$, determine the minimal coupling $\\sigma_{\\min}$ that guarantees all transverse modes are in the MSF stability interval for this network. State any feasibility condition you check.\n\nReport only the exact value of $\\sigma_{\\min}$ as your final answer. No units are required. If any numerical approximation is used in intermediate reasoning, it must be justified, but the final answer must be exact.",
            "solution": "We begin from the definitions. The combinatorial Laplacian $L$ of an undirected graph is $L = D - A$, where $D$ is the diagonal degree matrix and $A$ is the adjacency matrix. For a path graph on $n$ nodes, the degrees are $1$ at the two endpoints and $2$ at the internal nodes. The Laplacian eigenvalues for a path graph on $n$ nodes are well known and given by the formula\n$$\n\\lambda_{k} = 2 - 2 \\cos\\!\\left(\\frac{(k-1)\\pi}{n}\\right), \\quad k = 1,2,\\dots,n,\n$$\nwhich follows from the discrete cosine transform diagonalizing the tridiagonal Laplacian with free ends.\n\nFor $n = 5$, we obtain\n$$\n\\lambda_{k} = 2 - 2 \\cos\\!\\left(\\frac{(k-1)\\pi}{5}\\right), \\quad k = 1,2,3,4,5.\n$$\nHence,\n- For $k=1$: $\\lambda_{1} = 2 - 2 \\cos(0) = 2 - 2 = 0$.\n- For $k=2$: $\\lambda_{2} = 2 - 2 \\cos\\!\\left(\\frac{\\pi}{5}\\right)$.\n- For $k=3$: $\\lambda_{3} = 2 - 2 \\cos\\!\\left(\\frac{2\\pi}{5}\\right)$.\n- For $k=4$: $\\lambda_{4} = 2 - 2 \\cos\\!\\left(\\frac{3\\pi}{5}\\right)$.\n- For $k=5$: $\\lambda_{5} = 2 - 2 \\cos\\!\\left(\\frac{4\\pi}{5}\\right)$.\n\nWe now evaluate these using exact trigonometric values:\n$$\n\\cos\\!\\left(\\frac{\\pi}{5}\\right) = \\frac{1+\\sqrt{5}}{4}, \\quad \\cos\\!\\left(\\frac{2\\pi}{5}\\right) = \\frac{\\sqrt{5}-1}{4}, \\quad \\cos\\!\\left(\\frac{3\\pi}{5}\\right) = -\\frac{\\sqrt{5}-1}{4}, \\quad \\cos\\!\\left(\\frac{4\\pi}{5}\\right) = -\\frac{1+\\sqrt{5}}{4}.\n$$\nThus,\n$$\n\\lambda_{1} = 0,\n$$\n$$\n\\lambda_{2} = 2 - 2 \\cdot \\frac{1+\\sqrt{5}}{4} = 2 - \\frac{1+\\sqrt{5}}{2} = \\frac{4 - (1+\\sqrt{5})}{2} = \\frac{3 - \\sqrt{5}}{2},\n$$\n$$\n\\lambda_{3} = 2 - 2 \\cdot \\frac{\\sqrt{5}-1}{4} = 2 - \\frac{\\sqrt{5}-1}{2} = \\frac{4 - (\\sqrt{5}-1)}{2} = \\frac{5 - \\sqrt{5}}{2},\n$$\n$$\n\\lambda_{4} = 2 - 2 \\cdot \\left(-\\frac{\\sqrt{5}-1}{4}\\right) = 2 + \\frac{\\sqrt{5}-1}{2} = \\frac{4 + (\\sqrt{5}-1)}{2} = \\frac{3 + \\sqrt{5}}{2},\n$$\n$$\n\\lambda_{5} = 2 - 2 \\cdot \\left(-\\frac{1+\\sqrt{5}}{4}\\right) = 2 + \\frac{1+\\sqrt{5}}{2} = \\frac{4 + (1+\\sqrt{5})}{2} = \\frac{5 + \\sqrt{5}}{2}.\n$$\nTherefore, the algebraic connectivity (the second-smallest eigenvalue) is\n$$\n\\lambda_{2} = \\frac{3 - \\sqrt{5}}{2},\n$$\nand the largest eigenvalue is\n$$\n\\lambda_{5} = \\frac{5 + \\sqrt{5}}{2}.\n$$\n\nNext, we derive the synchronization stability condition using the Master Stability Function (MSF). Linearizing about the synchronized solution $\\mathbf{x}_{1} = \\cdots = \\mathbf{x}_{n} = \\mathbf{s}(t)$ and projecting onto the Laplacian eigenbasis yields decoupled variational modes of the form\n$$\n\\dot{\\boldsymbol{\\eta}}_{k} = \\left[ D\\mathbf{F}(\\mathbf{s}(t)) - \\alpha\\, D\\mathbf{H}(\\mathbf{s}(t)) \\right] \\boldsymbol{\\eta}_{k}, \\quad \\alpha = \\sigma \\lambda_{k},\n$$\nfor $k = 1,\\dots,n$. The $k=1$ mode ($\\lambda_{1} = 0$) is tangent to the synchronization manifold and does not affect transverse stability. For all transverse modes $k \\geq 2$, the largest Lyapunov exponent of the scalar parameter family $\\alpha$ must be negative. For a type II MSF, stability occurs if and only if $\\alpha \\in (\\alpha_{\\ell}, \\alpha_{u})$. Therefore, for all $k \\in \\{2,3,\\dots,n\\}$ we require\n$$\n\\alpha_{\\ell}  \\sigma \\lambda_{k}  \\alpha_{u}.\n$$\nThis is equivalent to the interval constraint on $\\sigma$:\n$$\n\\frac{\\alpha_{\\ell}}{\\lambda_{2}}  \\sigma  \\frac{\\alpha_{u}}{\\lambda_{n}},\n$$\nbecause $\\lambda_{2}$ is the smallest positive Laplacian eigenvalue and $\\lambda_{n}$ is the largest. Hence the minimal coupling that ensures all transverse modes are stable is\n$$\n\\sigma_{\\min} = \\frac{\\alpha_{\\ell}}{\\lambda_{2}}.\n$$\n\nWith $\\alpha_{\\ell} = 1$ and $\\lambda_{2} = \\frac{3 - \\sqrt{5}}{2}$, we obtain\n$$\n\\sigma_{\\min} = \\frac{1}{\\frac{3 - \\sqrt{5}}{2}} = \\frac{2}{3 - \\sqrt{5}}.\n$$\nRationalizing the denominator,\n$$\n\\sigma_{\\min} = \\frac{2}{3 - \\sqrt{5}} \\cdot \\frac{3 + \\sqrt{5}}{3 + \\sqrt{5}} = \\frac{2(3 + \\sqrt{5})}{9 - 5} = \\frac{2(3 + \\sqrt{5})}{4} = \\frac{3 + \\sqrt{5}}{2}.\n$$\n\nFinally, we verify feasibility against the upper bound using $\\alpha_{u} = 10$ and $\\lambda_{5} = \\frac{5 + \\sqrt{5}}{2}$. The maximal allowable coupling is\n$$\n\\sigma_{\\max} = \\frac{\\alpha_{u}}{\\lambda_{5}} = \\frac{10}{\\frac{5 + \\sqrt{5}}{2}} = \\frac{20}{5 + \\sqrt{5}}.\n$$\nSince\n$$\n\\sigma_{\\min} = \\frac{3 + \\sqrt{5}}{2} \\approx 2.618 \\quad \\text{and} \\quad \\sigma_{\\max} = \\frac{20}{5 + \\sqrt{5}} \\approx 2.764,\n$$\nwe have $\\sigma_{\\min}  \\sigma_{\\max}$, so there exists a feasible interval of $\\sigma$ ensuring synchronization. The significance of the algebraic connectivity $\\lambda_{2}$ is explicit: larger $\\lambda_{2}$ lowers $\\sigma_{\\min} = \\alpha_{\\ell}/\\lambda_{2}$, making synchronization achievable at weaker coupling; conversely, the small $\\lambda_{2}$ of a path graph requires stronger coupling to cross the MSF stability threshold.\n\nThus, the exact minimal coupling is\n$$\n\\sigma_{\\min} = \\frac{3 + \\sqrt{5}}{2}.\n$$",
            "answer": "$$\\boxed{\\frac{3+\\sqrt{5}}{2}}$$"
        },
        {
            "introduction": "In the previous exercises, the Master Stability Function was provided as a given. This final practice challenges you to compute the MSF yourself from first principles for the classic logistic map, a fundamental model of chaos . By implementing the numerical procedure, you will gain hands-on experience with the complete workflow, bridging the gap from the microscopic rules of oscillator dynamics to the macroscopic prediction of network-wide synchronization.",
            "id": "4286295",
            "problem": "You are given a network of $N$ identical discrete-time dynamical units (maps) coupled diffusively through a symmetric graph Laplacian. Each node has scalar state $x_i(n) \\in [0,1]$ and intrinsic dynamics given by the logistic map $f(x) = r x (1 - x)$, where $r > 0$ is the logistic parameter. The coupling uses the identity coupling function $h(x) = x$ with strength $\\sigma \\ge 0$, and the network is encoded by an adjacency matrix $A$ with graph Laplacian $L = D - A$, where $D$ is the diagonal degree matrix. The synchronous solution is the state where $x_i(n) = s(n)$ for all $i$, and the concept of the Master Stability Function (MSF) is used to determine its linear stability. The Master Stability Function (MSF) $\\Lambda(\\alpha)$ is defined as the largest Lyapunov exponent of the transverse variational dynamics parameterized by a real scalar $\\alpha$ that emerges from the combination of coupling strength and Laplacian eigenvalues. Synchronization is linearly stable if $\\Lambda(\\alpha)  0$ for all relevant $\\alpha$ values associated with the nontrivial Laplacian eigenmodes.\n\nStarting from the core definitions of diffusive coupling and linearization around the synchronous solution, implement a numerical procedure to approximate the Master Stability Function $\\Lambda(\\alpha)$ for the logistic map. Your procedure must:\n- Iterate the synchronous orbit $s(n)$ under $f(x) = r x (1 - x)$ starting from some $s(0) \\in (0,1)$, discard a transient, and use a sufficiently long trajectory to approximate long-time averages.\n- Construct the variational (transverse) dynamics along $s(n)$, and compute the largest Lyapunov exponent of this scalar, time-dependent linear recursion for a range of $\\alpha$ values. Use a grid of $\\alpha$ values spanning the interval induced by the networkâ€™s Laplacian spectrum and the coupling strength $\\sigma$.\n- Determine synchronization stability for a given network and coupling as follows: compute the spectrum of the Laplacian $L$, order its eigenvalues so that $0 = \\lambda_1 \\le \\lambda_2 \\le \\cdots \\le \\lambda_N$, and evaluate the MSF $\\Lambda(\\alpha)$ over the closed interval $[\\sigma \\lambda_2, \\sigma \\lambda_N]$. Declare the synchronous state linearly stable if and only if the maximum of $\\Lambda(\\alpha)$ over this interval is strictly negative.\n\nYour program must implement the above and report, for each specified test case, a boolean indicating whether the synchronous state is linearly stable (true) or unstable (false) according to the Master Stability Function criterion.\n\nUse purely mathematical units (dimensionless). Angles do not appear, so no angle unit is required. All outputs must be booleans.\n\nTest Suite:\n- Case $1$: Logistic parameter $r = 2.8$, network is a ring of $N = 10$ nodes (each node connected to its two nearest neighbors with periodic boundary conditions), coupling strength $\\sigma = 0.02$.\n- Case $2$: Logistic parameter $r = 2.8$, network is a ring of $N = 10$ nodes, coupling strength $\\sigma = 0.06$.\n- Case $3$: Logistic parameter $r = 3.9$, network is a ring of $N = 20$ nodes, coupling strength $\\sigma = 0.18$.\n- Case $4$: Logistic parameter $r = 3.9$, network is a star graph of $N = 20$ nodes (one hub connected to $N-1$ leaves), coupling strength $\\sigma = 0.18$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where each $result_k$ is a boolean corresponding to the synchronization stability for Case $k$.",
            "solution": "The analysis of synchronization stability for the network of coupled logistic maps proceeds via the Master Stability Function (MSF) formalism. The core of this method involves linearizing the system's dynamics around the desired synchronous solution and analyzing the growth or decay of perturbations in the eigenmodes of the network's coupling structure.\n\nThe dynamics of the $N$-node network are governed by the set of equations:\n$$x_i(n+1) = f(x_i(n)) - \\sigma \\sum_{j=1}^{N} L_{ij} h(x_j(n)), \\quad i=1, \\dots, N$$\nwhere $x_i(n) \\in [0,1]$ is the state of node $i$ at discrete time $n$. The intrinsic dynamics are given by the logistic map, $f(x) = r x (1-x)$, and the coupling is specified by the function $h(x)=x$, the coupling strength $\\sigma \\ge 0$, and the graph Laplacian $L=D-A$. The matrix $D$ is the diagonal degree matrix and $A$ is the adjacency matrix.\n\nA synchronous solution exists where all nodes evolve identically, $x_i(n) = s(n)$ for all $i$. Substituting this into the system equation, the coupling term $\\sigma \\sum_{j=1}^{N} L_{ij} s(n)$ vanishes because the sum of elements in any row of a Laplacian matrix is zero, i.e., $\\sum_{j} L_{ij} = 0$. Thus, the synchronous trajectory $s(n)$ is governed by the dynamics of a single, uncoupled logistic map:\n$$s(n+1) = f(s(n)) = r s(n) (1 - s(n))$$\nThis trajectory is generated numerically by iterating the map from an initial condition $s(0) \\in (0,1)$.\n\nTo determine the linear stability of this solution, we analyze the evolution of small perturbations, $x_i(n) = s(n) + \\delta_i(n)$. Linearizing the system around the synchronous trajectory $s(n)$ results in a variational equation for the vector of perturbations $\\vec{\\delta}(n) = [\\delta_1(n), \\dots, \\delta_N(n)]^T$:\n$$\\vec{\\delta}(n+1) = \\left[ f'(s(n))I - \\sigma L \\right] \\vec{\\delta}(n)$$\nHere, $f'(s(n)) = r(1-2s(n))$ is the derivative of $f(x)$ evaluated along the synchronous trajectory, and $I$ is the $N \\times N$ identity matrix.\n\nThe problem is simplified by diagonalizing the Laplacian matrix $L$. Since the network adjacency matrix $A$ is symmetric (undirected graph), $L$ is also symmetric and possesses a complete orthonormal set of eigenvectors $\\vec{v}_k$ with corresponding real eigenvalues $0 = \\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_N$. Any perturbation $\\vec{\\delta}(n)$ can be decomposed in this eigenbasis: $\\vec{\\delta}(n) = \\sum_{k=1}^N c_k(n) \\vec{v}_k$. Substituting this expansion into the variational equation and leveraging the property $L\\vec{v}_k = \\lambda_k \\vec{v}_k$ decouples the $N$-dimensional dynamics into $N$ independent scalar recursions for the mode amplitudes $c_k(n)$:\n$$c_k(n+1) = [f'(s(n)) - \\sigma \\lambda_k] c_k(n)$$\nThe mode corresponding to $\\lambda_1 = 0$ represents a uniform shift of all nodes and lies within the synchronization manifold. The stability of the synchronous state is therefore determined by the transverse modes, corresponding to $k=2, \\dots, N$.\n\nThe Master Stability Function (MSF), $\\Lambda(\\alpha)$, is defined as the largest Lyapunov exponent of the generic one-dimensional variational equation parameterized by a real variable $\\alpha$:\n$$\\eta(n+1) = [f'(s(n)) - \\alpha] \\eta(n)$$\nThe Lyapunov exponent is given by the long-term time average:\n$$\\Lambda(\\alpha) = \\lim_{M \\to \\infty} \\frac{1}{M} \\sum_{n=0}^{M-1} \\ln |f'(s(n)) - \\alpha|$$\nNumerically, we approximate this by generating a long trajectory of $s(n)$ of length $M_{iter}$ after discarding $N_{trans}$ transient steps:\n$$\\Lambda(\\alpha) \\approx \\frac{1}{M_{iter}} \\sum_{n=N_{trans}}^{N_{trans}+M_{iter}-1} \\ln |r(1-2s(n)) - \\alpha|$$\nThe stability of the $k$-th transverse mode is given by the sign of $\\Lambda(\\sigma\\lambda_k)$. The synchronous state is linearly stable if and only if all transverse modes decay, meaning $\\Lambda(\\sigma\\lambda_k)  0$ for all $k \\in \\{2, \\dots, N\\}$. This condition can be succinctly checked by evaluating the maximum of the MSF over the interval spanned by the relevant scaled eigenvalues:\n$$\\max_{\\alpha \\in [\\sigma\\lambda_2, \\sigma\\lambda_N]} \\Lambda(\\alpha)  0$$\n\nThe implemented algorithm follows these steps:\n1.  For each test case, the appropriate Laplacian matrix $L$ is constructed for the specified network (ring or star). Its eigenvalues $\\lambda_k$ are computed and sorted.\n2.  The synchronous trajectory $s(n)$ for the given logistic parameter $r$ is generated. A transient phase of $2000$ iterations is discarded, and the subsequent $10000$ iterations are used for analysis.\n3.  The stability interval $[\\alpha_{min}, \\alpha_{max}] = [\\sigma \\lambda_2, \\sigma \\lambda_N]$ is determined. This interval is discretized into a fine grid of $1000$ points.\n4.  For each point $\\alpha$ on the grid, the MSF value $\\Lambda(\\alpha)$ is calculated by averaging $\\ln|f'(s(n)) - \\alpha|$ over the stored synchronous trajectory.\n5.  The maximum value of $\\Lambda(\\alpha)$ across the grid is found. If this maximum is strictly less than $0$, the system is declared stable (true); otherwise, it is unstable (false).",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the synchronization stability problem for the given test cases\n    using the Master Stability Function (MSF) approach.\n    \"\"\"\n\n    # --- Numerical Parameters ---\n    # Number of iterations to discard for the synchronous orbit transient\n    N_TRANSIENT = 2000\n    # Number of iterations to use for averaging in Lyapunov exponent calculation\n    N_ITERATE = 10000\n    # Initial condition for the synchronous orbit\n    S0 = 0.5\n    # Number of points to sample the Master Stability Function\n    ALPHA_GRID_SIZE = 1000\n\n    def get_ring_laplacian(N):\n        \"\"\"Constructs the graph Laplacian for a ring network of N nodes.\"\"\"\n        adj = np.zeros((N, N), dtype=float)\n        for i in range(N):\n            adj[i, (i + 1) % N] = 1\n            adj[i, (i - 1 + N) % N] = 1\n        deg = np.diag(np.sum(adj, axis=1))\n        return deg - adj\n\n    def get_star_laplacian(N):\n        \"\"\"Constructs the graph Laplacian for a star network of N nodes.\"\"\"\n        adj = np.zeros((N, N), dtype=float)\n        # Node 0 is the hub\n        for i in range(1, N):\n            adj[0, i] = 1\n            adj[i, 0] = 1\n        deg = np.diag(np.sum(adj, axis=1))\n        return deg - adj\n\n    def compute_stability(r, N, network_type, sigma):\n        \"\"\"\n        Determines the synchronization stability for a given parameter set.\n\n        Args:\n            r (float): Logistic map parameter.\n            N (int): Number of nodes in the network.\n            network_type (str): Type of network ('ring' or 'star').\n            sigma (float): Coupling strength.\n\n        Returns:\n            bool: True if the synchronous state is linearly stable, False otherwise.\n        \"\"\"\n        # Step 1: Construct Laplacian and get its eigenvalues.\n        if network_type == 'ring':\n            L = get_ring_laplacian(N)\n        elif network_type == 'star':\n            L = get_star_laplacian(N)\n        else:\n            raise ValueError(\"Unknown network type specified.\")\n\n        # np.linalg.eigvalsh is efficient for symmetric matrices and returns sorted eigenvalues.\n        eigenvalues = np.linalg.eigvalsh(L)\n        \n        # The eigenvalues are 0 = lambda_1 = lambda_2 = ... = lambda_N.\n        # We need the interval spanned by the transverse modes.\n        lambda_2 = eigenvalues[1]\n        lambda_N = eigenvalues[-1]\n\n        # Step 2: Generate the synchronous trajectory s(n).\n        s_full = np.zeros(N_TRANSIENT + N_ITERATE)\n        s_full[0] = S0\n        for n in range(N_TRANSIENT + N_ITERATE - 1):\n            s_full[n+1] = r * s_full[n] * (1.0 - s_full[n])\n        \n        # Keep only the part of the trajectory after the transient.\n        sync_trajectory = s_full[N_TRANSIENT:]\n\n        # Step 3: Define the interval for stability analysis and compute the MSF.\n        alpha_min = sigma * lambda_2\n        alpha_max = sigma * lambda_N\n\n        if np.isclose(alpha_min, alpha_max):\n            # If all transverse eigenvalues are identical, the interval is a single point.\n            alpha_values = np.array([alpha_min])\n        else:\n            alpha_values = np.linspace(alpha_min, alpha_max, ALPHA_GRID_SIZE)\n\n        # Pre-compute the derivative f'(s(n)) = r(1-2s(n)) along the trajectory.\n        f_prime_s = r * (1.0 - 2.0 * sync_trajectory)\n        \n        max_lyapunov = -np.inf\n\n        # Calculate the MSF Lambda(alpha) for each alpha in the grid.\n        for alpha in alpha_values:\n            # We compute log|f'(s(n)) - alpha|. Add a small epsilon to avoid log(0)\n            # though it's highly unlikely with floating point numbers.\n            log_terms = np.log(np.abs(f_prime_s - alpha) + 1e-100)\n            \n            # The Lyapunov exponent is the time average of these log terms.\n            lyapunov_exp = np.mean(log_terms)\n            \n            if lyapunov_exp  max_lyapunov:\n                max_lyapunov = lyapunov_exp\n\n        # Step 4: Determine stability based on the sign of the maximum Lyapunov exponent.\n        return max_lyapunov  0.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'r': 2.8, 'N': 10, 'network': 'ring', 'sigma': 0.02},\n        {'r': 2.8, 'N': 10, 'network': 'ring', 'sigma': 0.06},\n        {'r': 3.9, 'N': 20, 'network': 'ring', 'sigma': 0.18},\n        {'r': 3.9, 'N': 20, 'network': 'star', 'sigma': 0.18},\n    ]\n\n    results = []\n    for case in test_cases:\n        is_stable = compute_stability(case['r'], case['N'], case['network'], case['sigma'])\n        # Format the boolean as a lowercase string as per output requirements.\n        results.append(str(is_stable).lower())\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}