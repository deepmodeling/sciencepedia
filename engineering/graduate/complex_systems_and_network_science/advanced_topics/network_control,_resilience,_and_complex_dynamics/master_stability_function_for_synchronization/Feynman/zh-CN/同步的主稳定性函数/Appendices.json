{
    "hands_on_practices": [
        {
            "introduction": "掌握了主稳定性函数（MSF）的理论后，首要的实践是将其直接应用于判断一个给定网络的同步稳定性。这个练习旨在巩固核心准则：通过计算每个横向模式对应的参数 $\\alpha_k = \\sigma \\lambda_k$ 并检验其是否落在已知的稳定区间内，我们可以逐一判断各个模式的稳定性。通过这项基础计算 ，您将能够清晰地理解耦合强度 $\\sigma$ 和网络谱 $\\{\\lambda_k\\}$ 是如何共同决定整个系统同步命运的。",
            "id": "4286364",
            "problem": "考虑一个由$N$个相同的、连续可微的振子组成的网络，它们在一个无向连通图上进行扩散耦合。设节点动力学由$\\dot{x}_{i}=f(x_{i})$给出，耦合通过一个光滑输出函数$h(x)$实现，耦合强度为$\\sigma0$。耦合由组合图拉普拉斯算子$L$构成，因此网络方程可以写成标准形式$\\dot{x}_{i}=f(x_{i})-\\sigma\\sum_{j=1}^{N}L_{ij}h(x_{j})$。假设耦合输出的雅可比矩阵在同步轨道$s(t)$上满足$D h(s)=I$，并且雅可比矩阵$D f(s)$存在。\n\n在主稳定性函数（MSF）框架下，MSF被定义为由标量$\\alpha$参数化的线性变分块的最大李雅普诺夫指数，记为$\\Lambda(\\alpha)$。假设当MSF在一个开区间$(\\alpha_{1},\\alpha_{2})$上严格为负时，系统达到稳定，且该区间为$(\\alpha_{1},\\alpha_{2})=(0.8,3.0)$。\n\n网络拉普拉斯算子的谱（按重数列出）如下：$\\lambda_{1}=0$, $\\lambda_{2}=0.6$, $\\lambda_{3}=1.1$, $\\lambda_{4}=1.4$, $\\lambda_{5}=1.4$, $\\lambda_{6}=2.2$, $\\lambda_{7}=3.8$, $\\lambda_{8}=4.0$, $\\lambda_{9}=4.5$, $\\lambda_{10}=5.2$, $\\lambda_{11}=6.0$, $\\lambda_{12}=6.0$。耦合强度固定为$\\sigma=0.75$。\n\n仅使用关于同步解的线性化和沿拉普拉斯算子特征基的模态分解这两个基本原理，确定在该耦合强度下，此网络同步态的线性稳定横向本征模的数量$S$（一个整数）。根据重数计算每个非零拉普拉斯特征值，并且不计算与同步流形相切的扰动相关的零特征值。由于区间$(\\alpha_{1},\\alpha_{2})$是开区间，任何参数等于端点的模态都是不稳定的。\n\n将$S$报告为一个精确整数，无需四舍五入。",
            "solution": "所提供问题的陈述是有效的。它在网络同步的主稳定性函数既定框架内具有科学依据，是良定的，提供了所有必要信息，并以客观、正式的语言陈述。不存在矛盾、歧义或事实错误。因此，我们可以着手求解。\n\n问题要求计算耦合振子网络中同步态的线性稳定横向本征模的数量。同步态 $x_i(t) = s(t)$（对于所有振子 $i=1, \\dots, N$）的稳定性是通过分析小扰动 $\\delta x_i = x_i(t) - s(t)$ 的演化来确定的。网络动力学由以下方程给出：\n$$ \\dot{x}_{i}=f(x_{i})-\\sigma\\sum_{j=1}^{N}L_{ij}h(x_{j}) $$\n将此系统在同步态$s(t)$附近进行线性化，得到关于扰动的变分方程：\n$$ \\dot{\\delta x_i} = Df(s(t))\\delta x_i - \\sigma\\sum_{j=1}^{N}L_{ij}Dh(s(t))\\delta x_j $$\n问题陈述，输出函数沿同步轨道的雅可比矩阵是单位矩阵，$Dh(s) = I$。变分方程简化为：\n$$ \\dot{\\delta x_i} = Df(s(t))\\delta x_i - \\sigma\\sum_{j=1}^{N}L_{ij}\\delta x_j $$\n这是一个耦合线性微分方程组。为了解耦这些方程，我们将扰动向量$\\delta \\mathbf{x} = (\\delta x_1, \\dots, \\delta x_N)^T$投影到图拉普拉斯算子$L$的特征基上。由于图是无向的，$L$是一个实对称矩阵，拥有一套完备标准正交的特征向量$v_k$及对应的实特征值$\\lambda_k$（$k=1, \\dots, N$）。任何扰动都可以表示为这些特征向量的线性组合，其系数$\\eta_k(t)$是单个振子状态空间中的向量：$\\delta \\mathbf{x}(t) = \\sum_{k=1}^N \\eta_k(t) v_k$。\n\n将此分解代入向量化的变分方程中，我们得到一组$N$个解耦的方程，每个方程对应一个本征模：\n$$ \\dot{\\eta}_k = [Df(s) - \\sigma \\lambda_k I] \\eta_k $$\n该方程具有主稳定性方程的通用形式 $\\dot{\\zeta} = [Df(s) - \\alpha I] \\zeta$，其中第$k$个模态的参数$\\alpha$由$\\alpha_k = \\sigma \\lambda_k$给出。主稳定性函数（MSF）$\\Lambda(\\alpha)$是这个通用方程的最大李雅普诺夫指数。第$k$个模态是线性稳定的，当且仅当其对应的最大李雅普诺夫指数为负，即$\\Lambda(\\alpha_k)  0$。\n\n问题陈述，当主稳定性函数（MSF）严格为负时，同步是稳定的，这种情况发生在$\\alpha$处于开区间$(\\alpha_1, \\alpha_2) = (0.8, 3.0)$内。因此，与拉普拉斯特征值$\\lambda_k$对应的横向模态是稳定的，如果其关联参数$\\alpha_k = \\sigma \\lambda_k$落在此区间内：\n$$ 0.8  \\sigma \\lambda_k  3.0 $$\n问题指定的耦合强度为$\\sigma = 0.75$。任务简化为对问题陈述中给出的每个非零拉普拉斯特征值检查此条件。非零特征值（横向模态）及其重数如下：\n$\\lambda_2=0.6$, $\\lambda_3=1.1$, $\\lambda_4=1.4$ (重数 $2$), $\\lambda_6=2.2$, $\\lambda_7=3.8$, $\\lambda_8=4.0$, $\\lambda_9=4.5$, $\\lambda_{10}=5.2$, $\\lambda_{11}=6.0$ (重数 $2$)。\n\n现在我们为每个特征值计算$\\alpha_k = 0.75 \\lambda_k$，并检查其是否落在区间$(0.8, 3.0)$内：\n\\begin{itemize}\n    \\item 对于 $\\lambda_2=0.6$：$\\alpha_2 = 0.75 \\times 0.6 = 0.45$。由于 $0.45 \\notin (0.8, 3.0)$，该模态不稳定。\n    \\item 对于 $\\lambda_3=1.1$：$\\alpha_3 = 0.75 \\times 1.1 = 0.825$。由于 $0.825 \\in (0.8, 3.0)$，该模态是**稳定的**。\n    \\item 对于 $\\lambda_4=1.4$ 和 $\\lambda_5=1.4$：$\\alpha_{4,5} = 0.75 \\times 1.4 = 1.05$。由于 $1.05 \\in (0.8, 3.0)$，这两个模态是**稳定的**。\n    \\item 对于 $\\lambda_6=2.2$：$\\alpha_6 = 0.75 \\times 2.2 = 1.65$。由于 $1.65 \\in (0.8, 3.0)$，该模态是**稳定的**。\n    \\item 对于 $\\lambda_7=3.8$：$\\alpha_7 = 0.75 \\times 3.8 = 2.85$。由于 $2.85 \\in (0.8, 3.0)$，该模态是**稳定的**。\n    \\item 对于 $\\lambda_8=4.0$：$\\alpha_8 = 0.75 \\times 4.0 = 3.0$。由于区间 $(0.8, 3.0)$ 是开区间，不包括端点。该模态不稳定。\n    \\item 对于 $\\lambda_9=4.5$：$\\alpha_9 = 0.75 \\times 4.5 = 3.375$。由于 $3.375 \\notin (0.8, 3.0)$，该模态不稳定。\n    \\item 对于 $\\lambda_{10}=5.2$：$\\alpha_{10} = 0.75 \\times 5.2 = 3.9$。由于 $3.9 \\notin (0.8, 3.0)$，该模态不稳定。\n    \\item 对于 $\\lambda_{11}=6.0$ 和 $\\lambda_{12}=6.0$：$\\alpha_{11,12} = 0.75 \\times 6.0 = 4.5$。由于 $4.5 \\notin (0.8, 3.0)$，这两个模态不稳定。\n\\end{itemize}\n\n为了找到稳定的横向本征模的总数$S$，我们计算被确定为稳定的模态数量，并计及其重数：\n\\begin{itemize}\n    \\item 来自 $\\lambda_3$ 的一个模态。\n    \\item 来自简并特征值 $\\lambda_4=\\lambda_5=1.4$ 的两个模态。\n    \\item 来自 $\\lambda_6$ 的一个模态。\n    \\item 来自 $\\lambda_7$ 的一个模态。\n\\end{itemize}\n总数为 $S = 1 + 2 + 1 + 1 = 5$。\n对于给定的网络和耦合强度，存在$5$个线性稳定的横向本征模。",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "理论的应用不止于检验稳定性，更在于预测同步所需的条件。在此练习  中，您将从一个具体的网络拓扑——路径图——出发，首先计算其拉普拉斯谱。这个过程将揭示网络的代数连通度 $\\lambda_2$ 如何成为同步的关键瓶颈，并让您能够亲手推导出保证同步稳定所需的最小耦合强度，从而深刻体会网络结构是如何直接塑造集体动力学的。",
            "id": "4286341",
            "problem": "考虑一个由 $n$ 个相同振子组成的网络，它们在一个简单无向图上进行扩散耦合，其模型为\n$$\n\\dot{\\mathbf{x}}_{i} = \\mathbf{F}(\\mathbf{x}_{i}) - \\sigma \\sum_{j=1}^{n} L_{ij}\\,\\mathbf{H}(\\mathbf{x}_{j}), \\quad i=1,\\dots,n,\n$$\n其中 $\\mathbf{F}$ 是节点向量场，$\\mathbf{H}$ 是耦合输出函数，$\\sigma$ 是标量耦合强度，$L$ 是底层图的组合拉普拉斯矩阵 $L = D - A$，其中 $D$ 是度矩阵，$A$ 是邻接矩阵。该网络是一个包含 $n = 5$ 个节点的路径图（即一个由 $5$ 个节点和 $4$ 条边组成的链，所有边的权重都等于 $1$）。假设主稳定性函数（Master Stability Function, MSF）框架适用，其变分模式由 $\\alpha = \\sigma \\lambda$ 参数化，其中 $\\lambda$ 是一个拉普拉斯特征值。假设主稳定性函数（MSF）是II型的，这意味着存在一个有界区间 $(\\alpha_{\\ell}, \\alpha_{u})$，其中 $0  \\alpha_{\\ell}  \\alpha_{u}$，使得所有变分模式都是线性稳定的，当且仅当 $\\alpha \\in (\\alpha_{\\ell}, \\alpha_{u})$。取 $\\alpha_{\\ell} = 1$ 和 $\\alpha_{u} = 10$。\n\n任务：\n- 计算包含 $5$ 个节点的路径图的完整拉普拉斯谱 $\\{\\lambda_{k}\\}_{k=1}^{5}$，并确定代数连通度 $\\lambda_{2}$ 和最大特征值 $\\lambda_{5}$。\n- 仅使用拉普拉斯特征模式分解和同步流形线性化的基本定义，推导对于II型MSF，完全同步是线性稳定的关于 $\\sigma$ 的条件。\n- 使用给定的 $(\\alpha_{\\ell}, \\alpha_{u})$，确定保证该网络中所有横向模式都处于MSF稳定区间内的最小耦合强度 $\\sigma_{\\min}$。说明您检查的任何可行性条件。\n\n最终答案只报告 $\\sigma_{\\min}$ 的精确值。不需要单位。如果在中间推理中使用了任何数值近似，必须给出理由，但最终答案必须是精确的。",
            "solution": "我们从定义开始。无向图的组合拉普拉斯矩阵 $L$ 是 $L = D - A$，其中 $D$ 是对角度矩阵，$A$ 是邻接矩阵。对于一个有 $n$ 个节点的路径图，两个端点的度为 $1$，内部节点的度为 $2$。一个有 $n$ 个节点的路径图的拉普拉斯特征值是众所周知的，由以下公式给出\n$$\n\\lambda_{k} = 2 - 2 \\cos\\!\\left(\\frac{(k-1)\\pi}{n}\\right), \\quad k = 1,2,\\dots,n,\n$$\n该公式可通过离散余弦变换对具有自由端的三角拉普拉斯矩阵进行对角化得到。\n\n对于 $n = 5$，我们得到\n$$\n\\lambda_{k} = 2 - 2 \\cos\\!\\left(\\frac{(k-1)\\pi}{5}\\right), \\quad k = 1,2,3,4,5.\n$$\n因此，\n- 对于 $k=1$：$\\lambda_{1} = 2 - 2 \\cos(0) = 2 - 2 = 0$。\n- 对于 $k=2$：$\\lambda_{2} = 2 - 2 \\cos\\!\\left(\\frac{\\pi}{5}\\right)$。\n- 对于 $k=3$：$\\lambda_{3} = 2 - 2 \\cos\\!\\left(\\frac{2\\pi}{5}\\right)$。\n- 对于 $k=4$：$\\lambda_{4} = 2 - 2 \\cos\\!\\left(\\frac{3\\pi}{5}\\right)$。\n- 对于 $k=5$：$\\lambda_{5} = 2 - 2 \\cos\\!\\left(\\frac{4\\pi}{5}\\right)$。\n\n我们现在使用精确的三角函数值来计算这些特征值：\n$$\n\\cos\\!\\left(\\frac{\\pi}{5}\\right) = \\frac{1+\\sqrt{5}}{4}, \\quad \\cos\\!\\left(\\frac{2\\pi}{5}\\right) = \\frac{\\sqrt{5}-1}{4}, \\quad \\cos\\!\\left(\\frac{3\\pi}{5}\\right) = -\\frac{\\sqrt{5}-1}{4}, \\quad \\cos\\!\\left(\\frac{4\\pi}{5}\\right) = -\\frac{1+\\sqrt{5}}{4}.\n$$\n因此，\n$$\n\\lambda_{1} = 0,\n$$\n$$\n\\lambda_{2} = 2 - 2 \\cdot \\frac{1+\\sqrt{5}}{4} = 2 - \\frac{1+\\sqrt{5}}{2} = \\frac{4 - (1+\\sqrt{5})}{2} = \\frac{3 - \\sqrt{5}}{2},\n$$\n$$\n\\lambda_{3} = 2 - 2 \\cdot \\frac{\\sqrt{5}-1}{4} = 2 - \\frac{\\sqrt{5}-1}{2} = \\frac{4 - (\\sqrt{5}-1)}{2} = \\frac{5 - \\sqrt{5}}{2},\n$$\n$$\n\\lambda_{4} = 2 - 2 \\cdot \\left(-\\frac{\\sqrt{5}-1}{4}\\right) = 2 + \\frac{\\sqrt{5}-1}{2} = \\frac{4 + (\\sqrt{5}-1)}{2} = \\frac{3 + \\sqrt{5}}{2},\n$$\n$$\n\\lambda_{5} = 2 - 2 \\cdot \\left(-\\frac{1+\\sqrt{5}}{4}\\right) = 2 + \\frac{1+\\sqrt{5}}{2} = \\frac{4 + (1+\\sqrt{5})}{2} = \\frac{5 + \\sqrt{5}}{2}.\n$$\n所以，代数连通度（第二小特征值）是\n$$\n\\lambda_{2} = \\frac{3 - \\sqrt{5}}{2},\n$$\n最大特征值是\n$$\n\\lambda_{5} = \\frac{5 + \\sqrt{5}}{2}.\n$$\n\n接下来，我们使用主稳定性函数（MSF）推导同步稳定性条件。在同步解 $\\mathbf{x}_{1} = \\cdots = \\mathbf{x}_{n} = \\mathbf{s}(t)$ 附近进行线性化，并投影到拉普拉斯特征基上，得到如下形式的解耦变分模式\n$$\n\\dot{\\boldsymbol{\\eta}}_{k} = \\left[ D\\mathbf{F}(\\mathbf{s}(t)) - \\alpha\\, D\\mathbf{H}(\\mathbf{s}(t)) \\right] \\boldsymbol{\\eta}_{k}, \\quad \\alpha = \\sigma \\lambda_{k},\n$$\n对于 $k = 1,\\dots,n$。$k=1$ 模式（$\\lambda_{1} = 0$）与同步流形相切，不影响横向稳定性。对于所有横向模式 $k \\geq 2$，标量参数族 $\\alpha$ 的最大李雅普诺夫指数必须为负。对于II型MSF，稳定性发生的条件是当且仅当 $\\alpha \\in (\\alpha_{\\ell}, \\alpha_{u})$。因此，对于所有 $k \\in \\{2,3,\\dots,n\\}$，我们需要\n$$\n\\alpha_{\\ell}  \\sigma \\lambda_{k}  \\alpha_{u}.\n$$\n这等价于对 $\\sigma$ 的区间约束：\n$$\n\\frac{\\alpha_{\\ell}}{\\lambda_{2}}  \\sigma  \\frac{\\alpha_{u}}{\\lambda_{n}},\n$$\n因为 $\\lambda_{2}$ 是最小的正拉普拉斯特征值，而 $\\lambda_{n}$ 是最大的。因此，确保所有横向模式都稳定的最小耦合强度是\n$$\n\\sigma_{\\min} = \\frac{\\alpha_{\\ell}}{\\lambda_{2}}.\n$$\n\n给定 $\\alpha_{\\ell} = 1$ 和 $\\lambda_{2} = \\frac{3 - \\sqrt{5}}{2}$，我们得到\n$$\n\\sigma_{\\min} = \\frac{1}{\\frac{3 - \\sqrt{5}}{2}} = \\frac{2}{3 - \\sqrt{5}}.\n$$\n将分母有理化，\n$$\n\\sigma_{\\min} = \\frac{2}{3 - \\sqrt{5}} \\cdot \\frac{3 + \\sqrt{5}}{3 + \\sqrt{5}} = \\frac{2(3 + \\sqrt{5})}{9 - 5} = \\frac{2(3 + \\sqrt{5})}{4} = \\frac{3 + \\sqrt{5}}{2}.\n$$\n\n最后，我们使用 $\\alpha_{u} = 10$ 和 $\\lambda_{5} = \\frac{5 + \\sqrt{5}}{2}$ 来验证相对于上界的可行性。最大允许耦合强度为\n$$\n\\sigma_{\\max} = \\frac{\\alpha_{u}}{\\lambda_{5}} = \\frac{10}{\\frac{5 + \\sqrt{5}}{2}} = \\frac{20}{5 + \\sqrt{5}}.\n$$\n由于\n$$\n\\sigma_{\\min} = \\frac{3 + \\sqrt{5}}{2} \\approx 2.618 \\quad \\text{和} \\quad \\sigma_{\\max} = \\frac{20}{5 + \\sqrt{5}} \\approx 2.764,\n$$\n我们有 $\\sigma_{\\min}  \\sigma_{\\max}$，所以存在一个可行的 $\\sigma$ 区间来保证同步。代数连通度 $\\lambda_{2}$ 的重要性是显而易见的：较大的 $\\lambda_{2}$ 会降低 $\\sigma_{\\min} = \\alpha_{\\ell}/\\lambda_{2}$，使得在较弱的耦合下可以实现同步；相反，路径图的较小 $\\lambda_{2}$ 需要更强的耦合才能跨越MSF稳定性阈值。\n\n因此，精确的最小耦合强度是\n$$\n\\sigma_{\\min} = \\frac{3 + \\sqrt{5}}{2}.\n$$",
            "answer": "$$\\boxed{\\frac{3+\\sqrt{5}}{2}}$$"
        },
        {
            "introduction": "在许多实际研究中，主稳定性函数并非已知，而是需要根据具体的振子动力学进行计算。这个计算练习  将指导您完成这一关键步骤，通过为耦合逻辑斯蒂映象网络编写数值程序，从第一性原理计算其MSF。这项实践不仅能将您对MSF定义的理论理解转化为具体的计算技能，更为您独立研究新系统的同步问题奠定了坚实的基础。",
            "id": "4286295",
            "problem": "给定一个由 $N$ 个相同的离散时间动力学单元（映象）组成的网络，它们通过一个对称的图拉普拉斯算子进行扩散耦合。每个节点具有标量状态 $x_i(n) \\in [0,1]$，其内禀动力学由逻辑斯谛映象 $f(x) = r x (1 - x)$ 给出，其中 $r  0$ 是逻辑斯谛参数。耦合使用恒等耦合函数 $h(x) = x$，耦合强度为 $\\sigma \\ge 0$。网络由邻接矩阵 $A$ 编码，其图拉普拉斯算子为 $L = D - A$，其中 $D$ 是对角度矩阵。同步解是所有节点状态均为 $x_i(n) = s(n)$ 的状态，使用主稳定性函数（Master Stability Function, MSF）的概念来确定其线性稳定性。主稳定性函数（MSF）$\\Lambda(\\alpha)$ 定义为横向变分动力学的最大李雅普诺夫指数，该动力学由一个实数标量 $\\alpha$ 参数化，$\\alpha$ 由耦合强度和拉普拉斯特征值的组合产生。如果对于所有与非平凡拉普拉斯特征模态相关的 $\\alpha$ 值，都有 $\\Lambda(\\alpha)  0$，则同步是线性稳定的。\n\n从扩散耦合和围绕同步解进行线性化的核心定义出发，实现一个数值程序来近似逻辑斯谛映象的主稳定性函数 $\\Lambda(\\alpha)$。您的程序必须：\n- 从某个 $s(0) \\in (0,1)$ 开始，在 $f(x) = r x (1 - x)$ 下迭代同步轨道 $s(n)$，舍弃一个暂态过程，并使用足够长的轨迹来近似长时间平均值。\n- 沿 $s(n)$ 构建变分（横向）动力学，并对一系列 $\\alpha$ 值计算这个标量、时变线性递归的最大李雅普诺夫指数。使用一个覆盖由网络拉普拉斯谱和耦合强度 $\\sigma$ 决定的区间的 $\\alpha$ 值网格。\n- 按如下方式确定给定网络和耦合的同步稳定性：计算拉普拉斯算子 $L$ 的谱，将其特征值排序为 $0 = \\lambda_1 \\le \\lambda_2 \\le \\cdots \\le \\lambda_N$，并在闭区间 $[\\sigma \\lambda_2, \\sigma \\lambda_N]$ 上评估 MSF $\\Lambda(\\alpha)$。当且仅当 $\\Lambda(\\alpha)$ 在此区间上的最大值严格为负时，宣告同步状态是线性稳定的。\n\n您的程序必须实现以上步骤，并根据主稳定性函数准则，为每个指定的测试用例报告一个布尔值，指示同步状态是线性稳定（true）还是不稳定（false）。\n\n使用纯数学单位（无量纲）。不出现角度，因此不需要角度单位。所有输出必须是布尔值。\n\n测试套件：\n- 情况1：逻辑斯谛参数 $r = 2.8$，网络为 $N = 10$ 个节点的环形网络（每个节点与其两个最近邻居相连，具有周期性边界条件），耦合强度 $\\sigma = 0.02$。\n- 情况2：逻辑斯谛参数 $r = 2.8$，网络为 $N = 10$ 个节点的环形网络，耦合强度 $\\sigma = 0.06$。\n- 情况3：逻辑斯谛参数 $r = 3.9$，网络为 $N = 20$ 个节点的环形网络，耦合强度 $\\sigma = 0.18$。\n- 情况4：逻辑斯谛参数 $r = 3.9$，网络为 $N = 20$ 个节点的星形图（一个中心节点连接到 $N-1$ 个叶节点），耦合强度 $\\sigma = 0.18$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4]$），其中每个 $result_k$ 是对应于情况 $k$ 的同步稳定性的布尔值。",
            "solution": "耦合逻辑斯谛映象网络的同步稳定性分析通过主稳定性函数（MSF）形式体系进行。该方法的核心在于围绕期望的同步解将系统动力学线性化，并分析网络耦合结构的特征模态中扰动的增长或衰减。\n\n这个 $N$ 节点网络的动力学由以下方程组决定：\n$$x_i(n+1) = f(x_i(n)) - \\sigma \\sum_{j=1}^{N} L_{ij} h(x_j(n)), \\quad i=1, \\dots, N$$\n其中 $x_i(n) \\in [0,1]$ 是节点 $i$ 在离散时间 $n$ 的状态。内禀动力学由逻辑斯谛映象 $f(x) = r x (1-x)$ 给出，耦合由函数 $h(x)=x$、耦合强度 $\\sigma \\ge 0$ 和图拉普拉斯算子 $L=D-A$ 指定。矩阵 $D$ 是对角度矩阵，$A$ 是邻接矩阵。\n\n存在一个同步解，其中所有节点都以相同的方式演化，$x_i(n) = s(n)$ 对所有 $i$ 成立。将此代入系统方程，耦合项 $\\sigma \\sum_{j=1}^{N} L_{ij} s(n)$ 会消失，因为拉普拉斯矩阵任意一行的元素之和为零，即 $\\sum_{j} L_{ij} = 0$。因此，同步轨迹 $s(n)$ 由单个、非耦合的逻辑斯谛映象的动力学决定：\n$$s(n+1) = f(s(n)) = r s(n) (1 - s(n))$$\n该轨迹是通过从一个初始条件 $s(0) \\in (0,1)$ 开始迭代映象来数值生成的。\n\n为了确定该解的线性稳定性，我们分析小扰动 $x_i(n) = s(n) + \\delta_i(n)$ 的演化。围绕同步轨迹 $s(n)$ 对系统进行线性化，得到扰动向量 $\\vec{\\delta}(n) = [\\delta_1(n), \\dots, \\delta_N(n)]^T$ 的变分方程：\n$$\\vec{\\delta}(n+1) = \\left[ f'(s(n))I - \\sigma L \\right] \\vec{\\delta}(n)$$\n这里，$f'(s(n)) = r(1-2s(n))$ 是 $f(x)$ 的导数在同步轨迹上求得的值，$I$ 是 $N \\times N$ 的单位矩阵。\n\n通过对角化拉普拉斯矩阵 $L$ 可以简化问题。由于网络邻接矩阵 $A$ 是对称的（无向图），$L$ 也是对称的，并拥有一套完备的正交归一特征向量 $\\vec{v}_k$ 及其对应的实数特征值 $0 = \\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_N$。任何扰动 $\\vec{\\delta}(n)$ 都可以在这个特征基中分解：$\\vec{\\delta}(n) = \\sum_{k=1}^N c_k(n) \\vec{v}_k$。将此展开式代入变分方程，并利用 $L\\vec{v}_k = \\lambda_k \\vec{v}_k$ 的性质，可以将 $N$ 维动力学解耦为 $N$ 个关于模态振幅 $c_k(n)$ 的独立标量递归：\n$$c_k(n+1) = [f'(s(n)) - \\sigma \\lambda_k] c_k(n)$$\n与 $\\lambda_1 = 0$ 对应的模态代表所有节点的均匀平移，位于同步流形内。因此，同步状态的稳定性由横向模态决定，对应于 $k=2, \\dots, N$。\n\n主稳定性函数（MSF）$\\Lambda(\\alpha)$ 定义为由实变量 $\\alpha$ 参数化的通用一维变分方程的最大李雅普诺夫指数：\n$$\\eta(n+1) = [f'(s(n)) - \\alpha] \\eta(n)$$\n李雅普诺夫指数由长时间平均值给出：\n$$\\Lambda(\\alpha) = \\lim_{M \\to \\infty} \\frac{1}{M} \\sum_{n=0}^{M-1} \\ln |f'(s(n)) - \\alpha|$$\n在数值上，我们通过生成一个长度为 $M_{iter}$ 的长轨迹 $s(n)$，并舍弃 $N_{trans}$ 个暂态步长来近似这个值：\n$$\\Lambda(\\alpha) \\approx \\frac{1}{M_{iter}} \\sum_{n=N_{trans}}^{N_{trans}+M_{iter}-1} \\ln |r(1-2s(n)) - \\alpha|$$\n第 $k$ 个横向模态的稳定性由 $\\Lambda(\\sigma\\lambda_k)$ 的符号给出。当且仅当所有横向模态都衰减时，同步状态是线性稳定的，即对所有 $k \\in \\{2, \\dots, N\\}$ 都有 $\\Lambda(\\sigma\\lambda_k)  0$。这个条件可以通过评估 MSF 在相关缩放特征值所构成的区间上的最大值来简明地检验：\n$$\\max_{\\alpha \\in [\\sigma\\lambda_2, \\sigma\\lambda_N]} \\Lambda(\\alpha)  0$$\n\n实现的算法遵循以下步骤：\n1. 对于每个测试用例，为指定的网络（环形或星形）构建相应的拉普拉斯矩阵 $L$。计算其特征值 $\\lambda_k$ 并进行排序。\n2. 生成给定逻辑斯谛参数 $r$ 的同步轨迹 $s(n)$。舍弃一个包含 2000 次迭代的暂态阶段，并使用随后的 10000 次迭代进行分析。\n3. 确定稳定性区间 $[\\alpha_{min}, \\alpha_{max}] = [\\sigma \\lambda_2, \\sigma \\lambda_N]$。将此区间离散化为一个包含 1000 个点的细网格。\n4. 对于网格上的每个点 $\\alpha$，通过对存储的同步轨迹上的 $\\ln|f'(s(n)) - \\alpha|$ 进行平均，来计算 MSF 值 $\\Lambda(\\alpha)$。\n5. 找到整个网格上 $\\Lambda(\\alpha)$ 的最大值。如果该最大值严格小于 0，则系统被宣告为稳定（true）；否则，它是不稳定（false）。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the synchronization stability problem for the given test cases\n    using the Master Stability Function (MSF) approach.\n    \"\"\"\n\n    # --- Numerical Parameters ---\n    # Number of iterations to discard for the synchronous orbit transient\n    N_TRANSIENT = 2000\n    # Number of iterations to use for averaging in Lyapunov exponent calculation\n    N_ITERATE = 10000\n    # Initial condition for the synchronous orbit\n    S0 = 0.5\n    # Number of points to sample the Master Stability Function\n    ALPHA_GRID_SIZE = 1000\n\n    def get_ring_laplacian(N):\n        \"\"\"Constructs the graph Laplacian for a ring network of N nodes.\"\"\"\n        adj = np.zeros((N, N), dtype=float)\n        for i in range(N):\n            adj[i, (i + 1) % N] = 1\n            adj[i, (i - 1 + N) % N] = 1\n        deg = np.diag(np.sum(adj, axis=1))\n        return deg - adj\n\n    def get_star_laplacian(N):\n        \"\"\"Constructs the graph Laplacian for a star network of N nodes.\"\"\"\n        adj = np.zeros((N, N), dtype=float)\n        # Node 0 is the hub\n        for i in range(1, N):\n            adj[0, i] = 1\n            adj[i, 0] = 1\n        deg = np.diag(np.sum(adj, axis=1))\n        return deg - adj\n\n    def compute_stability(r, N, network_type, sigma):\n        \"\"\"\n        Determines the synchronization stability for a given parameter set.\n\n        Args:\n            r (float): Logistic map parameter.\n            N (int): Number of nodes in the network.\n            network_type (str): Type of network ('ring' or 'star').\n            sigma (float): Coupling strength.\n\n        Returns:\n            bool: True if the synchronous state is linearly stable, False otherwise.\n        \"\"\"\n        # Step 1: Construct Laplacian and get its eigenvalues.\n        if network_type == 'ring':\n            L = get_ring_laplacian(N)\n        elif network_type == 'star':\n            L = get_star_laplacian(N)\n        else:\n            raise ValueError(\"Unknown network type specified.\")\n\n        # np.linalg.eigvalsh is efficient for symmetric matrices and returns sorted eigenvalues.\n        eigenvalues = np.linalg.eigvalsh(L)\n        \n        # The eigenvalues are 0 = lambda_1 = lambda_2 = ... = lambda_N.\n        # We need the interval spanned by the transverse modes.\n        lambda_2 = eigenvalues[1]\n        lambda_N = eigenvalues[-1]\n\n        # Step 2: Generate the synchronous trajectory s(n).\n        s_full = np.zeros(N_TRANSIENT + N_ITERATE)\n        s_full[0] = S0\n        for n in range(N_TRANSIENT + N_ITERATE - 1):\n            s_full[n+1] = r * s_full[n] * (1.0 - s_full[n])\n        \n        # Keep only the part of the trajectory after the transient.\n        sync_trajectory = s_full[N_TRANSIENT:]\n\n        # Step 3: Define the interval for stability analysis and compute the MSF.\n        alpha_min = sigma * lambda_2\n        alpha_max = sigma * lambda_N\n\n        if np.isclose(alpha_min, alpha_max):\n            # If all transverse eigenvalues are identical, the interval is a single point.\n            alpha_values = np.array([alpha_min])\n        else:\n            alpha_values = np.linspace(alpha_min, alpha_max, ALPHA_GRID_SIZE)\n\n        # Pre-compute the derivative f'(s(n)) = r(1-2s(n)) along the trajectory.\n        f_prime_s = r * (1.0 - 2.0 * sync_trajectory)\n        \n        max_lyapunov = -np.inf\n\n        # Calculate the MSF Lambda(alpha) for each alpha in the grid.\n        for alpha in alpha_values:\n            # We compute log|f'(s(n)) - alpha|. Add a small epsilon to avoid log(0)\n            # though it's highly unlikely with floating point numbers.\n            log_terms = np.log(np.abs(f_prime_s - alpha) + 1e-100)\n            \n            # The Lyapunov exponent is the time average of these log terms.\n            lyapunov_exp = np.mean(log_terms)\n            \n            if lyapunov_exp > max_lyapunov:\n                max_lyapunov = lyapunov_exp\n\n        # Step 4: Determine stability based on the sign of the maximum Lyapunov exponent.\n        return max_lyapunov  0.0\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'r': 2.8, 'N': 10, 'network': 'ring', 'sigma': 0.02},\n        {'r': 2.8, 'N': 10, 'network': 'ring', 'sigma': 0.06},\n        {'r': 3.9, 'N': 20, 'network': 'ring', 'sigma': 0.18},\n        {'r': 3.9, 'N': 20, 'network': 'star', 'sigma': 0.18},\n    ]\n\n    results = []\n    for case in test_cases:\n        is_stable = compute_stability(case['r'], case['N'], case['network'], case['sigma'])\n        # Format the boolean as a lowercase string as per output requirements.\n        results.append(str(is_stable).lower())\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}