{
    "hands_on_practices": [
        {
            "introduction": "要理解违约如何在金融网络中传导，首先需要掌握其清算机制。第一个练习将引导您直接应用基础的Eisenberg-Noe模型，为一个小型三银行系统计算清算支付向量。通过手动求解这个例子，您将对模型的定点均衡以及决定银行违约与否的条件建立起具体而深刻的理解。",
            "id": "4306720",
            "problem": "考虑一个由三家银行（索引为 $i \\in \\{1,2,3\\}$）组成的金融系统，该系统由 Eisenberg–Noe (EN) 框架建模。每家银行 $i$ 对系统有总额为 $\\bar{p}_{i} \\ge 0$ 的名义负债，并拥有 $\\ge 0$ 的外部资产 $a_{i}$。相对负债矩阵 $\\Pi$ 的元素 $\\Pi_{ij} \\in [0,1]$ 代表银行 $i$ 的名义总负债中欠债权人 $j$ 的比例，当 $\\bar{p}_{i}  0$ 时，$\\sum_{j=1}^{3} \\Pi_{ij} = 1$。设 $p \\in \\mathbb{R}_{+}^{3}$ 表示清算时的实现支付向量。\n\n假设有限责任和按比例偿还，因此每家银行的实现支付等于其名义总负债和其可用资源（外部资产加上实现的银行间流入资金）中的较小者。形式上，对于每家银行 $i$，清算支付必须满足：\n$$\n0 \\le p_{i} \\le \\bar{p}_{i}, \\quad p_{i} = \\min\\!\\left\\{ \\bar{p}_{i},\\ a_{i} + \\sum_{j=1}^{3} \\Pi_{j i}\\, p_{j} \\right\\}.\n$$\n\n给定以下实例（所有数值均使用相同的货币单位）：\n- 名义总负债向量 $\\bar{p} = (\\bar{p}_{1}, \\bar{p}_{2}, \\bar{p}_{3}) = (100, 90, 80)$。\n- 相对负债矩阵\n$$\n\\Pi \\;=\\;\n\\begin{pmatrix}\n0   0.5   0.5 \\\\\n0.4   0   0.6 \\\\\n0.5   0.5   0\n\\end{pmatrix}.\n$$\n- 外部资产向量 $a = (a_{1}, a_{2}, a_{3}) = (20, 30, 35)$。\n\n从 Eisenberg–Noe 框架中包含的有限责任和按比例偿还的定义出发，推导清算问题的不动点方程，并显式求解清算向量 $p$。在不动点处确定违约集合 $D = \\{\\, i \\in \\{1,2,3\\} : p_{i}  \\bar{p}_{i} \\,\\}$。\n\n答案格式要求：将您的最终答案以单行矩阵的形式报告，该矩阵包含六个条目，顺序为 $(p_{1}, p_{2}, p_{3}, d_{1}, d_{2}, d_{3})$，其中如果银行 $i$ 违约，则 $d_{i} = 1$，否则 $d_{i} = 0$。无需四舍五入。不要在最终的方框答案中包含单位。",
            "solution": "该问题被验证为具有科学依据、良定且客观。这是 Eisenberg–Noe 金融清算模型的一个标准应用，所有必要数据均已提供。\n\n清算向量 $p=(p_1, p_2, p_3)$ 由每家银行 $i \\in \\{1,2,3\\}$ 的不动点条件确定：\n$$\np_{i} = \\min\\!\\left\\{ \\bar{p}_{i},\\ a_{i} + \\sum_{j=1}^{3} \\Pi_{j i}\\, p_{j} \\right\\}\n$$\n其中 $\\bar{p} = (100, 90, 80)$ 是名义总负债向量，$a = (20, 30, 35)$ 是外部资产向量，$\\Pi$ 是相对负债矩阵。项 $\\sum_{j=1}^{3} \\Pi_{j i}\\, p_{j}$ 代表银行 $i$ 收到的银行间总资产。这个和可以用 $\\Pi$ 的转置（记作 $\\Pi^T$，其中 $(\\Pi^T)_{ij} = \\Pi_{ji}$）来表示。方程组为：\n$$\n\\begin{pmatrix} p_1 \\\\ p_2 \\\\ p_3 \\end{pmatrix} = \\min\\!\\left\\{ \\begin{pmatrix} \\bar{p}_1 \\\\ \\bar{p}_2 \\\\ \\bar{p}_3 \\end{pmatrix}, \\begin{pmatrix} a_1 \\\\ a_2 \\\\ a_3 \\end{pmatrix} + \\Pi^T \\begin{pmatrix} p_1 \\\\ p_2 \\\\ p_3 \\end{pmatrix} \\right\\}\n$$\n给定矩阵 $\\Pi$，其转置为：\n$$\n\\Pi^T =\n\\begin{pmatrix}\n0   0.4   0.5 \\\\\n0.5   0   0.5 \\\\\n0.5   0.6   0\n\\end{pmatrix}\n$$\n清算支付的方程组变为：\n$$\np_1 = \\min\\{100,\\, 20 + 0.4 p_2 + 0.5 p_3\\} \\\\\np_2 = \\min\\{90,\\, 30 + 0.5 p_1 + 0.5 p_3\\} \\\\\np_3 = \\min\\{80,\\, 35 + 0.5 p_1 + 0.6 p_2\\}\n$$\n为了解这个方程组，我们可以将银行集合划分为两个不相交的子集：违约银行集合 $D = \\{i : p_i  \\bar{p}_i\\}$ 和有偿付能力银行集合 $S = \\{i : p_i = \\bar{p}_i\\}$。对于银行 $i \\in D$，其实际支付等于其可用资源。对于银行 $i \\in S$，其实际支付等于其名义负债，并且其可用资源必须足以覆盖这些负债。\n这就引出了基于一个假设划分 $(D, S)$ 的以下方程和不等式组：\n对于 $i \\in D$：$p_i = a_i + \\sum_{j=1}^{3} \\Pi_{ji} p_j$\n对于 $i \\in S$：$p_i = \\bar{p}_i$ 且 $a_i + \\sum_{j=1}^{3} \\Pi_{ji} p_j \\ge \\bar{p}_i$\n\n让我们首先检验没有银行违约的假设，即 $D = \\emptyset$ 且 $S = \\{1, 2, 3\\}$。这将意味着 $p = \\bar{p} = (100, 90, 80)$。我们必须检查所有银行的资源约束是否都得到满足。\n对于银行1：$a_1 + \\sum_{j=1}^{3} \\Pi_{j1} p_j = 20 + 0.4(90) + 0.5(80) = 20 + 36 + 40 = 96$。\n偿付能力的条件是 $96 \\ge \\bar{p}_1 = 100$，这是不成立的。因此，假设 $D = \\emptyset$ 是不正确的。至少银行1必须违约。\n\n让我们检验假设 $D = \\{1\\}$ 和 $S = \\{2, 3\\}$。这意味着：\n1. 银行1违约：$p_1  100$，所以 $p_1 = 20 + 0.4 p_2 + 0.5 p_3$。\n2. 银行2有偿付能力：$p_2 = \\bar{p}_2 = 90$。\n3. 银行3有偿付能力：$p_3 = \\bar{p}_3 = 80$。\n\n我们将 $p_2$ 和 $p_3$ 的值代入 $p_1$ 的方程中：\n$$\np_1 = 20 + 0.4(90) + 0.5(80) = 20 + 36 + 40 = 96\n$$\n这给出了一个候选解向量 $p = (96, 90, 80)$。现在，我们必须验证这个解与我们对划分 $(D,S)$ 的初始假设是否一致。\n- 对于银行 $1 \\in D$：$p_1  \\bar{p}_1$ 是否成立？我们有 $96  100$。这与假设一致。\n- 对于银行 $2 \\in S$：$p_2 = \\bar{p}_2$ 是否成立且其资源是否充足？我们设定 $p_2=90$。我们必须检查 $a_2 + \\sum_{j=1}^{3} \\Pi_{j2} p_j \\ge \\bar{p}_2$ 是否成立。\n$$\n30 + 0.5 p_1 + 0.5 p_3 = 30 + 0.5(96) + 0.5(80) = 30 + 48 + 40 = 118\n$$\n条件是 $118 \\ge 90$，这是成立的。这与假设一致。\n- 对于银行 $3 \\in S$：$p_3 = \\bar{p}_3$ 是否成立且其资源是否充足？我们设定 $p_3=80$。我们必须检查 $a_3 + \\sum_{j=1}^{3} \\Pi_{j3} p_j \\ge \\bar{p}_3$ 是否成立。\n$$\n35 + 0.5 p_1 + 0.6 p_2 = 35 + 0.5(96) + 0.6(90) = 35 + 48 + 54 = 137\n$$\n条件是 $137 \\ge 80$，这是成立的。这也与假设一致。\n\n由于对划分 $D=\\{1\\}, S=\\{2,3\\}$ 的所有条件都得到满足，这个划分是正确的，并且唯一的清算向量是 $p = (96, 90, 80)$。\n\n违约集合是 $D = \\{i : p_i  \\bar{p}_i\\}$。\n- 银行1：$p_1 = 96  \\bar{p}_1 = 100$，所以银行1违约。违约指示符为 $d_1 = 1$。\n- 银行2：$p_2 = 90 = \\bar{p}_2 = 90$，所以银行2不违约。违约指示符为 $d_2 = 0$。\n- 银行3：$p_3 = 80 = \\bar{p}_3 = 80$，所以银行3不违约。违约指示符为 $d_3 = 0$。\n\n最终的清算向量是 $p=(p_1, p_2, p_3) = (96, 90, 80)$，违约指示符向量是 $d=(d_1, d_2, d_3) = (1, 0, 0)$。最终答案必须以单行矩阵 $(p_1, p_2, p_3, d_1, d_2, d_3)$ 的形式报告。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n96  90  80  1  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然手动计算对于小型系统富有启发性，但分析现实世界中的金融网络需要一种可扩展的算法。本练习旨在挑战您实现用于求解任意网络中Eisenberg-Noe清算向量的强大迭代方法——虚拟违约算法（Fictitious Default Algorithm, FDA）。通过证明该算法的收敛性并将其应用于不同的测试案例，您不仅能巩固理论知识，还将掌握一个用于系统性风险分析的实用工具。",
            "id": "4306697",
            "problem": "考虑一个包含 $n$ 家银行的金融网络中的艾森伯格-诺伊（Eisenberg–Noe, EN）银行间清算支付模型。设 $L \\in \\mathbb{R}_{+}^{n \\times n}$ 为名义银行间负债矩阵，其中 $L_{i j}$ 表示银行 $i$ 对银行 $j$ 的债务。设 $\\bar{p} \\in \\mathbb{R}_{+}^{n}$ 为各银行对所有债权人（包括存款人等非银行债权人）的名义总负债向量，设 $x \\in \\mathbb{R}_{+}^{n}$ 为各银行可用于偿付负债的外生资产向量。定义相对负债矩阵 $\\Pi \\in [0,1]^{n \\times n}$，其中当 $\\bar{p}_{i}  0$ 时，$\\pi_{i j} = \\frac{L_{i j}}{\\bar{p}_{i}}$；当 $\\bar{p}_{i} = 0$ 时，$\\pi_{i j} = 0$。EN 清算机制旨在寻求一个支付向量 $p \\in \\mathbb{R}_{+}^{n}$，该向量遵循有限责任和绝对优先原则：每家银行 $i$ 支付 $p_{i} = \\min\\{\\bar{p}_{i}, x_{i} + \\sum_{j=1}^{n} \\pi_{j i} p_{j}\\}$。\n\n任务 A（实现）：实现用于计算上述定义的清算支付向量 $p$ 的虚拟违约算法（Fictitious Default Algorithm, FDA）。您的实现必须对任意 $n$ 具有通用性，并且仅依赖于所提供的基本定义。不应引入本问题陈述之外的任何额外假设。\n\n任务 B（终止性证明）：提供一个清晰的证明，说明对于一个包含 $n$ 家银行的系统，在所述的 EN 模型假设下，FDA 在至多 $n$ 次迭代内终止，并解释为什么每次迭代要么严格增加违约银行的集合，要么终止。\n\n任务 C（应用于测试套件）：将您的实现应用于以下参数集 $(L, \\bar{p}, x)$ 的测试套件，并为每种情况计算相应的清算支付向量 $p$。\n\n- 测试用例 $1$ （顺利路径，预计无违约）：$n = 3$, \n  $$L = \\begin{pmatrix}\n  0   1   0.5 \\\\\n  0.5   0   0.5 \\\\\n  0.2   0.3   0\n  \\end{pmatrix}, \\quad \\bar{p} = \\begin{pmatrix} 1.5 \\\\ 1.0 \\\\ 0.5 \\end{pmatrix}, \\quad x = \\begin{pmatrix} 2.0 \\\\ 0.7 \\\\ 0.6 \\end{pmatrix}.$$\n- 测试用例 $2$ （存在外部债务的级联违约）：$n = 3$, \n  $$L = \\begin{pmatrix}\n  0   0.9   0 \\\\\n  0   0   0.9 \\\\\n  0.9   0   0\n  \\end{pmatrix}, \\quad \\bar{p} = \\begin{pmatrix} 1.5 \\\\ 1.5 \\\\ 1.5 \\end{pmatrix}, \\quad x = \\begin{pmatrix} 0.1 \\\\ 0.1 \\\\ 0.1 \\end{pmatrix}.$$\n- 测试用例 $3$ （边界情况：一家总负债为零的银行）：$n = 2$,\n  $$L = \\begin{pmatrix}\n  0   0 \\\\\n  0.4   0\n  \\end{pmatrix}, \\quad \\bar{p} = \\begin{pmatrix} 0.0 \\\\ 0.4 \\end{pmatrix}, \\quad x = \\begin{pmatrix} 0.0 \\\\ 0.0 \\end{pmatrix}.$$\n- 测试用例 $4$ （边缘案例：单家银行，仅对社会有负债）：$n = 1$,\n  $$L = \\begin{pmatrix} 0 \\end{pmatrix}, \\quad \\bar{p} = \\begin{pmatrix} 1.0 \\end{pmatrix}, \\quad x = \\begin{pmatrix} 0.3 \\end{pmatrix}.$$\n\n输出规范：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[result1,result2,result3]$）。对于每个测试用例，按银行索引（从 $1$ 到 $n$）的顺序，将计算出的支付向量 $p$ 作为浮点数的嵌套列表输出。因此，最终输出必须是 $[[p^{(1)}_1,\\ldots,p^{(1)}_{n_1}],[p^{(2)}_1,\\ldots,p^{(2)}_{n_2}],\\ldots]$ 的形式，不含任何额外文本。\n\n所有量均为无量纲量，必须作为实数处理。角度和物理单位不适用。每个测试用例的答案是代表该情况下清算支付的浮点数列表。",
            "solution": "该问题要求实现用于艾森伯格-诺伊（Eisenberg–Noe, EN）银行间清算模型的虚拟违约算法（Fictitious Default Algorithm, FDA），提供其理论证明，并将其应用于一个特定的测试套件。\n\n### 问题形式化\n\n首先，我们根据所提供的定义将模型形式化。我们有一个包含 $n$ 家银行的系统。\n- $L \\in \\mathbb{R}_{+}^{n \\times n}$：名义银行间负债矩阵，其中 $L_{ij}$ 是银行 $i$ 欠银行 $j$ 的金额。\n- $\\bar{p} \\in \\mathbb{R}_{+}^{n}$：名义总负债向量，其中 $\\bar{p}_i$ 是银行 $i$ 欠所有债权人（银行间和外部）的总金额。\n- $x \\in \\mathbb{R}_{+}^{n}$：各银行可用的外生资产向量。\n- $\\Pi \\in [0,1]^{n \\times n}$：相对负债矩阵，其条目为当 $\\bar{p}_i  0$ 时 $\\pi_{ij} = \\frac{L_{ij}}{\\bar{p}_i}$，当 $\\bar{p}_i = 0$ 时 $\\pi_{ij} = 0$。值 $\\pi_{ij}$ 代表银行 $i$ 的总支付中流向银行 $j$ 的部分。\n\n目标是找到清算支付向量 $p \\in \\mathbb{R}_{+}^{n}$，它是不动点方程的解：\n$$ p_i = \\min\\left\\{\\bar{p}_i, c_i(p)\\right\\} \\quad \\text{for } i=1, \\dots, n $$\n其中 $c_i(p)$ 是银行 $i$ 可用的总现金：\n$$ c_i(p) = x_i + \\sum_{j=1}^{n} (\\text{payment from } j \\text{ to } i) $$\n银行 $j$ 的一笔支付 $p_j$ 按比例分配给其债权人。从银行 $j$ 到银行 $i$ 的支付是 $p_j \\frac{L_{ji}}{\\bar{p}_j} = p_j \\pi_{ji}$。因此，银行 $i$ 从银行间系统获得的收入是 $\\sum_{j=1}^{n} p_j \\pi_{ji}$。请注意，求和是针对 $\\pi_{ji}$ 的第一个索引。\n因此，不动点方程为：\n$$ p_i = \\min\\left\\{\\bar{p}_i, x_i + \\sum_{j=1}^{n} \\pi_{ji} p_j\\right\\} \\quad (*) $$\n如果银行 $i$ 能够全额偿付其负债，即 $p_i = \\bar{p}_i$，则称其有偿付能力。如果 $p_i  \\bar{p}_i$，则其违约，这发生在当其可用现金 $c_i(p)$ 小于 $\\bar{p}_i$ 时。在违约情况下，银行会支付其所有可用现金，因此 $p_i = c_i(p)$。\n\n### 任务 A 和 B：虚拟违约算法及其终止性\n\n虚拟违约算法（FDA）是用于找到该清算向量 $p$ 的迭代过程。\n\n**算法描述（任务 A 的概念基础）**\n\n该算法迭代地构建一个违约银行集合。设 $V = \\{1, \\dots, n\\}$ 为所有银行的集合。\n\n1.  **初始化**：从一个候选违约银行集合 $D_0 = \\emptyset$ 开始。假设在 $A_0 = V \\setminus D_0$ 中的银行是有偿付能力的。\n2.  **迭代 $k$（对于 $k \\ge 1$）**：\n    a. 给定前一次迭代的违约银行集合 $D_{k-1}$，我们定义一个假设的支付向量 $p^{(k-1)}$。假设在 $A_{k-1} = V \\setminus D_{k-1}$ 中的银行 $j$ 是有偿付能力的，并全额支付其债务，即 $p_j^{(k-1)} = \\bar{p}_j$。\n    b. 对于 $D_{k-1}$ 中的银行 $i$（虚拟违约银行），它们的支付由其可用现金决定。它们的现金包括其外生资产 $x_i$ 加上从所有其他银行收到的款项。这导致了一个关于支付 $(p_i)_{i \\in D_{k-1}}$ 的线性方程组：\n       $$ p_i = x_i + \\sum_{j \\in A_{k-1}} \\pi_{ji} \\bar{p}_j + \\sum_{j \\in D_{k-1}} \\pi_{ji} p_j \\quad \\text{for all } i \\in D_{k-1} $$\n       该系统可以写成矩阵形式 $(I - \\Pi_{D_{k-1}, D_{k-1}}^T) p_{D_{k-1}} = x_{D_{k-1}} + \\Pi_{D_{k-1}, A_{k-1}}^T \\bar{p}_{A_{k-1}}$，其中 $p_{D_{k-1}} = (p_i)_{i \\in D_{k-1}}$ 且 $\\Pi^T$ 是相对负债矩阵的转置。$p_{D_{k-1}}$ 的解给出了 $D_{k-1}$ 中银行的支付额。\n    c. 现在我们有了完整的假设支付向量 $p^{(k-1)}$，其分量对于 $j \\in A_{k-1}$ 是 $\\bar{p}_j$，对于 $j \\in D_{k-1}$ 是刚计算出的值。\n    d. 使用这个向量 $p^{(k-1)}$，我们识别出“真正的”违约银行。如果一家银行 $i$ 的总可用资产小于其总负债，则该银行违约：\n       $$ x_i + \\sum_{j=1}^n \\pi_{ji} p_j^{(k-1)}  \\bar{p}_i $$\n       设所有此类银行的集合为 $D_k$。\n    e. **终止检查**：如果 $D_k = D_{k-1}$，则违约银行集合已稳定。算法终止，最终的清算向量为 $p = p^{(k-1)}$。否则，我们令 $k \\to k+1$ 并重复此过程。\n\n**终止性证明（任务 B）**\n\n我们必须证明该算法在至多 $n$ 次迭代（更新违约集合的迭代）内终止。\n\n1.  **违约集合的单调性**：我们证明违约集合序列是非递减的，即对于所有 $k \\ge 1$，有 $D_{k-1} \\subseteq D_k$。\n    设 $p^{(k-1)}$ 为基于违约集合 $D_{k-1}$ 计算出的假设支付向量。根据构造，对于任何银行 $j$，我们有 $p_j^{(k-1)} \\le \\bar{p}_j$。\n    集合 $D_k$ 定义为 $D_k = \\{i \\in V \\mid x_i + \\sum_{j} \\pi_{ji} p_j^{(k-1)}  \\bar{p}_i\\}$。对于 $D_{k-1}$ 中的任何银行 $i$，其支付由清算方程 $p_i^{(k-1)} = x_i + \\sum_{j} \\pi_{ji} p_j^{(k-1)}$ 决定。EN 模型的一个已知性质是，违约银行的支付严格小于其负债，因此 $p_i^{(k-1)}  \\bar{p}_i$。将 $p_i^{(k-1)}$ 的方程代入此不等式，得到 $x_i + \\sum_{j} \\pi_{ji} p_j^{(k-1)}  \\bar{p}_i$。这正是银行 $i$ 属于 $D_k$ 的条件。因此，$D_{k-1}$ 中的任何银行也必定在 $D_k$ 中。所以，$D_{k-1} \\subseteq D_k$。\n\n2.  **严格增加或终止**：如果算法不终止，则 $D_k \\neq D_{k-1}$。结合 $D_{k-1} \\subseteq D_k$，这意味着 $D_{k-1}$ 是 $D_k$ 的一个真子集。\n    因此，违约集合的基数必须严格增加：$|D_k|  |D_{k-1}|$。\n\n3.  **有界增长**：基数序列 $|D_0|, |D_1|, |D_2|, \\ldots$ 是一个整数序列。它从 $|D_0| = 0$ 开始。只要算法不终止，该序列就是严格递增的：\n    $$ 0 = |D_0|  |D_1|  |D_2|  \\dots $$\n    违约银行的集合是所有银行集合 $V$ 的一个子集，所以其大小以 $n$ 为界：$|D_k| \\le n$。\n    一个有上界的严格递增整数序列必须是有限的。该序列最多可以有 $n+1$ 个元素（$0, 1, \\dots, n$）。这意味着违约集合最多只能增长 $n$ 次。在至多 $n$ 次增加违约集合的迭代之后，它必须稳定下来。\n\n因此，对于一个包含 $n$ 家银行的系统，虚拟违约算法保证在至多 $n$ 次更新迭代内终止。\n\n### 任务 C：应用于测试套件\n\n上述算法被实现并应用于四个测试用例。该实现计算相对负债矩阵 $\\Pi$，然后进入 FDA 的迭代循环。在每次循环中，它识别当前的违约（$D$）和有偿付能力（$A$）的银行集合，为 $D$ 中的银行求解支付的线性系统，检查 $A$ 中是否有新的违约银行，并在集合 $D$ 不再增长时终止。\n\n- **测试用例 1** 是一个“顺利路径”，其中所有银行都有足够的外生资产和银行间应收款项来覆盖其债务。算法在第一次迭代中以空的违约集合终止，因此所有银行都全额支付其负债，$p = \\bar{p}$。\n- **测试用例 2** 举例说明了传染性级联违约。最初假设所有银行都有偿付能力，但随后发现没有一家能履行其债务。所有三家银行都被添加到违约集合中。随后的迭代为违约银行的支付求解一个 $3 \\times 3$ 的线性系统，此时违约集合稳定，算法终止。\n- **测试用例 3** 涉及一家总负债为零的银行。这样的银行将始终支付 $p_i=0$，因为这是其负债（$0$）和其资产之间的最小值。另一家银行违约，因为它没有外生资产，也收不到任何支付。\n- **测试用例 4** 是一个简单的单银行系统，它因为其外生资产少于其对外部债权人的负债而违约。\n\n每个测试用例的最终计算出的支付向量 $p$ 由所提供的程序计算得出。",
            "answer": "[[1.5, 1.0, 0.5],[0.25, 0.25, 0.25],[0.0, 0.0],[0.3]]"
        },
        {
            "introduction": "研究系统性风险的最终目的不仅在于预测危机，更在于探索如何防范危机。最后一个练习将Eisenberg-Noe框架应用于一个关键的政策问题：在系统遭受冲击后，稳定整个网络所需的最小资本注入是多少？通过计算这个数值，您将学习如何运用这些模型作为量化工具，为监管干预和危机管理提供决策支持。",
            "id": "2435808",
            "problem": "考虑一个由 $n$ 个机构组成的金融系统，该系统由一个有向加权负债网络表示。设 $L \\in \\mathbb{R}_{\\ge 0}^{n \\times n}$ 为名义负债矩阵，其中 $L_{ij}$ 是机构 $i$ 对机构 $j$ 的债务。定义总名义负债向量 $\\bar{p} \\in \\mathbb{R}_{\\ge 0}^{n}$ 为\n$$\n\\bar{p}_i \\equiv \\sum_{j=1}^{n} L_{ij}.\n$$\n定义相对负债矩阵 $\\Pi \\in \\mathbb{R}_{\\ge 0}^{n \\times n}$ 为\n$$\n\\Pi_{ij} \\equiv \n\\begin{cases}\n\\dfrac{L_{ij}}{\\bar{p}_i},  \\text{若 } \\bar{p}_i  0, \\\\\n0,  \\text{若 } \\bar{p}_i = 0,\n\\end{cases}\n$$\n使得 $\\Pi$ 的每行之和最多为 $1$。设 $x \\in \\mathbb{R}_{\\ge 0}^{n}$ 为任何冲击发生前的外部资产向量。\n\n对指定节点 $i \\in \\{1,\\dots,n\\}$ 的一个大小为 $S_0 \\ge 0$ 的初始冲击会将其外部资产减少至 $x_i' = \\max\\{x_i - S_0, 0\\}$，而对于所有 $k \\ne i$，$x_k' = x_k$。然后可以向受冲击节点 $i$ 单独注入一笔非负资本 $\\Delta C \\ge 0$，得到注资后的外部资产 $x_i'' = x_i' + \\Delta C$ 和对于所有 $k \\ne i$ 的 $x_k'' = x_k'$。\n\n支付根据 Eisenberg–Noe 不动点模型进行清算：一个清算支付向量 $p \\in \\mathbb{R}_{\\ge 0}^{n}$ 必须满足\n$$\np = \\min\\left\\{\\bar{p},\\, \\Pi^\\top p + x''\\right\\},\n$$\n其中最小值为逐分量取值，$x''$ 是注资后的外部资产向量。\n\n定义“稳定网络”为所有机构全额支付，即清算支付等于总名义负债：$p = \\bar{p}$。换句话说，稳定要求在给定冲击和仅对节点 $i$ 注入资本的情况下，所有机构根据 Eisenberg–Noe 模型能够实现全额偿付。\n\n任务。对于下面的每个测试用例，计算在指定节点 $i$ 受到初始冲击 $S_0$ 后，为稳定网络所需的最小资本注入 $\\Delta C_{\\min}$（资本单位与 $x$ 和 $L$ 相同）。如果仅对节点 $i$ 注入任何有限的非负资本 $\\Delta C$ 都无法使所有机构实现全额偿付，则该测试用例返回数值 $-1.0$。\n\n您的程序必须生成单行输出，其中包含所有结果，形式为方括号内的逗号分隔列表，每个数字四舍五入到恰好 $6$ 位小数。例如，四个结果的有效输出形式为 $[r_1,r_2,r_3,r_4]$，其中每个 $r_k$ 显示到 $6$ 位小数。\n\n使用以下测试套件。在每个案例中，网络规模为 $n = 3$。\n\n测试用例 1（一般情况）：\n- 受冲击的节点索引：$i = 1$（使用基于 1 的索引；您的程序内部可以使用基于 0 的索引，但必须遵循此处给出的数据）。\n- 初始冲击：$S_0 = 1.5$。\n- 负债矩阵：\n$$\nL = \\begin{bmatrix}\n0   2   0 \\\\\n0   0   1 \\\\\n1   0   0\n\\end{bmatrix}.\n$$\n- 外部资产：\n$$\nx = \\begin{bmatrix}\n2 \\\\\n1 \\\\\n0.5\n\\end{bmatrix}.\n$$\n\n测试用例 2（冲击后已稳定，需要零注入）：\n- 受冲击的节点索引：$i = 1$。\n- 初始冲击：$S_0 = 0.2$。\n- 负债矩阵：\n$$\nL = \\begin{bmatrix}\n0   2   0 \\\\\n0   0   1 \\\\\n1   0   0\n\\end{bmatrix}.\n$$\n- 外部资产：\n$$\nx = \\begin{bmatrix}\n2 \\\\\n1 \\\\\n0.5\n\\end{bmatrix}.\n$$\n\n测试用例 3（仅在受冲击节点注资无法稳定）：\n- 受冲击的节点索引：$i = 3$。\n- 初始冲击：$S_0 = 0$。\n- 负债矩阵：\n$$\nL = \\begin{bmatrix}\n0   1   0 \\\\\n0   0   1 \\\\\n0   0   0\n\\end{bmatrix}.\n$$\n- 外部资产：\n$$\nx = \\begin{bmatrix}\n0.1 \\\\\n0.1 \\\\\n0.1\n\\end{bmatrix}.\n$$\n\n测试用例 4（零负债节点受冲击的边界情况）：\n- 受冲击的节点索引：$i = 1$。\n- 初始冲击：$S_0 = 10.0$。\n- 负债矩阵：\n$$\nL = \\begin{bmatrix}\n0   0   0 \\\\\n1   0   0 \\\\\n0   1   0\n\\end{bmatrix}.\n$$\n- 外部资产：\n$$\nx = \\begin{bmatrix}\n0.5 \\\\\n0.5 \\\\\n1.0\n\\end{bmatrix}.\n$$\n\n最终输出格式要求。您的程序应生成单行输出，按顺序包含测试用例 1 到 4 的结果，形式为方括号内的逗号分隔列表，每个值四舍五入到恰好 $6$ 位小数，例如\n$$\n[\\Delta C_{\\min}^{(1)},\\Delta C_{\\min}^{(2)},\\Delta C_{\\min}^{(3)},\\Delta C_{\\min}^{(4)}].\n$$\n如果仅通过对受冲击节点注资无法实现稳定，则该案例打印 $-1.000000$。",
            "solution": "问题陈述经过验证。\n\n步骤1：提取给定条件\n- 机构数量为 $n$。\n- 名义负债矩阵为 $L \\in \\mathbb{R}_{\\ge 0}^{n \\times n}$，其中 $L_{ij}$ 是机构 $i$ 对 $j$ 的债务。\n- 总名义负债向量为 $\\bar{p} \\in \\mathbb{R}_{\\ge 0}^{n}$，定义为 $\\bar{p}_i \\equiv \\sum_{j=1}^{n} L_{ij}$。\n- 相对负债矩阵为 $\\Pi \\in \\mathbb{R}_{\\ge 0}^{n \\times n}$，定义为若 $\\bar{p}_i  0$，则 $\\Pi_{ij} \\equiv L_{ij}/\\bar{p}_i$；若 $\\bar{p}_i = 0$，则 $\\Pi_{ij} = 0$。\n- 外部资产向量为 $x \\in \\mathbb{R}_{\\ge 0}^{n}$。\n- 大小为 $S_0 \\ge 0$ 的初始冲击施加于一个指定节点 $i$。\n- 冲击后的外部资产向量 $x'$ 定义为 $x_i' = \\max\\{x_i - S_0, 0\\}$ 以及对于 $k \\ne i$ 的 $x_k' = x_k$。\n- 向受冲击节点 $i$ 注入资本 $\\Delta C \\ge 0$。\n- 注资后的外部资产向量 $x''$ 定义为 $x_i'' = x_i' + \\Delta C$ 以及对于 $k \\ne i$ 的 $x_k'' = x_k'$。\n- 清算支付向量 $p \\in \\mathbb{R}_{\\ge 0}^{n}$ 满足不动点方程 $p = \\min\\left\\{\\bar{p},\\, \\Pi^\\top p + x''\\right\\}$。\n- 网络稳定定义为所有机构全额支付的条件，即 $p = \\bar{p}$。\n- 任务是找到稳定网络所需的最小资本注入 $\\Delta C_{\\min}$。如果仅通过对节点 $i$ 注资无法实现稳定，则值为 $-1.0$。\n- 提供了四个测试用例，其中包含 $n$、$L$、$x$、$i$ 和 $S_0$ 的具体值。\n\n步骤2：使用提取的给定条件进行验证\n- **科学依据**：该问题基于金融清算领域的 Eisenberg–Noe 模型，这是计算经济学中系统性风险分析的基石。该模型在数学上是严谨的，并被广泛接受。在此框架内，其前提在事实上是合理的。\n- **良态性**：该问题要求在一组线性不等式的约束下，求一个非负量 $\\Delta C$ 的最小值。这种结构是良态的。解的存在性和唯一性条件由问题的约束明确定义。\n- **客观性**：所有术语都经过了精确的数学定义。指令清晰明确，没有主观性语言。\n- **完整性与一致性**：该问题提供了构建解决方案所需的所有必要数据（$L, x, i, S_0$）和定义。没有内部矛盾。\n\n步骤3：结论与行动\n问题有效。这是一个在公认经济模型背景下定义明确的数学练习。现在将构建一个解决方案。\n\n问题的核心是确定实现网络稳定所需的最小非负资本注入 $\\Delta C_{\\min}$。稳定被定义为清算支付向量 $p$ 等于总名义负债向量 $\\bar{p}$，即 $p = \\bar{p}$。\n\n清算过程由不动点方程决定：\n$$\np = \\min\\left\\{\\bar{p}, \\Pi^\\top p + x''\\right\\}\n$$\n其中最小值为逐分量取值。为了实现稳定，必须有 $p = \\bar{p}$。将此条件代入方程可得：\n$$\n\\bar{p} = \\min\\left\\{\\bar{p}, \\Pi^\\top \\bar{p} + x''\\right\\}\n$$\n此等式成立的充要条件是，对于每个机构 $k \\in \\{1, \\dots, n\\}$，以下不等式都得到满足：\n$$\n\\bar{p}_k \\le (\\Pi^\\top \\bar{p})_k + x''_k\n$$\n这个包含 $n$ 个线性不等式的系统表示了每个机构的总可用资金（来自其他机构的收款，$\\Pi^\\top \\bar{p}$，加上其自身注资后的外部资产，$x''$）足以覆盖其总名义负债 $\\bar{p}$ 的条件。让我们展开矩阵-向量乘积项：\n$$\n(\\Pi^\\top \\bar{p})_k = \\sum_{j=1}^{n} (\\Pi^\\top)_{kj} \\bar{p}_j = \\sum_{j=1}^{n} \\Pi_{jk} \\bar{p}_j\n$$\n注资后的外部资产向量 $x''$ 取决于初始冲击 $S_0$ 和资本注入 $\\Delta C$，两者都施加于单个节点 $i$。$x''$ 的分量为：\n$$\nx''_k = \\begin{cases}\n\\max\\{x_i - S_0, 0\\} + \\Delta C,  \\text{若 } k=i \\\\\nx_k,  \\text{若 } k \\ne i \\text{ 且 } k \\text{ 不是受冲击节点}\n\\end{cases}\n$$\n更准确地说，冲击施加于节点 $i$，之后对同一节点 $i$ 进行注资。设受冲击节点的索引为 $i_{shock}$。\n那么对于任何节点 $k$：\n$$\nx'_k = \\begin{cases}\n\\max\\{x_{i_{shock}} - S_0, 0\\},  \\text{若 } k=i_{shock} \\\\\nx_k,  \\text{若 } k \\ne i_{shock}\n\\end{cases}\n$$\n而注资后的资产为：\n$$\nx''_k = \\begin{cases}\nx'_{i_{shock}} + \\Delta C,  \\text{若 } k=i_{shock} \\\\\nx'_k,  \\text{若 } k \\ne i_{shock}\n\\end{cases}\n$$\n我们将此代入我们的不等式系统。\n\n对于任何节点 $k \\ne i_{shock}$：\n$$\n\\bar{p}_k \\le \\sum_{j=1}^{n} \\Pi_{jk} \\bar{p}_j + x'_k = \\sum_{j=1}^{n} \\Pi_{jk} \\bar{p}_j + x_k\n$$\n此条件与冲击 $S_0$ 和注入 $\\Delta C$ 无关。让我们为每个节点 $k$ 定义注资前的“偿付能力缺口”：\n$$\nG_k = \\bar{p}_k - \\left( \\sum_{j=1}^{n} \\Pi_{jk} \\bar{p}_j + x'_k \\right)\n$$\n为了仅通过向节点 $i_{shock}$ 注入资本就能实现稳定，所有其他节点 $k \\ne i_{shock}$ 必须自身具有偿付能力。也就是说，对于所有 $k \\ne i_{shock}$，必须有 $G_k \\le 0$。如果存在任何 $k \\ne i_{shock}$ 使得 $G_k  0$，那么注入到节点 $i_{shock}$ 的任何资本都无法弥补节点 $k$ 的短缺。在这种情况下，稳定是不可能的，结果为 $-1.0$。\n\n对于受冲击的节点 $k = i_{shock}$，稳定条件为：\n$$\n\\bar{p}_{i_{shock}} \\le \\sum_{j=1}^{n} \\Pi_{j,i_{shock}} \\bar{p}_j + x''_{i_{shock}}\n$$\n代入 $x''_{i_{shock}} = x'_{i_{shock}} + \\Delta C$：\n$$\n\\bar{p}_{i_{shock}} \\le \\sum_{j=1}^{n} \\Pi_{j,i_{shock}} \\bar{p}_j + x'_{i_{shock}} + \\Delta C\n$$\n我们可以重新整理这个不等式以求解所需的注入 $\\Delta C$：\n$$\n\\Delta C \\ge \\bar{p}_{i_{shock}} - \\left( \\sum_{j=1}^{n} \\Pi_{j,i_{shock}} \\bar{p}_j + x'_{i_{shock}} \\right) = G_{i_{shock}}\n$$\n由于资本注入必须为非负（$\\Delta C \\ge 0$），所需的最小资本注入为 $\\Delta C_{\\min} = \\max\\{0, G_{i_{shock}}\\}$。\n\n完整的算法如下：\n1.  给定 $L$，$x$，$i_{shock}$（基于1的索引）和 $S_0$。将 $i_{shock}$ 转换为基于0的索引。\n2.  从 $L$ 计算总名义负债向量 $\\bar{p}$：$\\bar{p}_i = \\sum_j L_{ij}$。\n3.  计算相对负债矩阵 $\\Pi$。对于每一行 $i$：如果 $\\bar{p}_i  0$，则 $\\Pi_{ij} = L_{ij} / \\bar{p}_i$；否则 $\\Pi_{ij} = 0$。\n4.  计算冲击后的外部资产向量 $x'$。令 $i_{idx} = i_{shock} - 1$。\n    - $x'_{i_{idx}} = \\max\\{x_{i_{idx}} - S_0, 0\\}$。\n    - 对于所有 $k \\ne i_{idx}$，$x'_k = x_k$。\n5.  计算在完全偿付假设下，来自其他机构的总预期收款向量：$v = \\Pi^\\top \\bar{p}$。\n6.  对于每个机构 $k=0, \\dots, n-1$，计算偿付能力缺口 $G_k = \\bar{p}_k - (v_k + x'_k)$。\n7.  检查不可能性。对于每个 $k \\ne i_{idx}$，如果 $G_k  0$，则稳定是不可能的。返回 $-1.0$。\n8.  如果步骤7的检查通过，则计算所需的最小注入：$\\Delta C_{\\min} = \\max\\{0, G_{i_{idx}}\\}$。返回此值。\n\n此过程正确地解决了问题陈述的所有方面。",
            "answer": "[0.500000,0.000000,-1.000000,9.500000]"
        }
    ]
}