{
    "hands_on_practices": [
        {
            "introduction": "本练习是钉扎控制分析的基础。通过分析一个简单的路径图，我们可以直观地理解钉扎单个节点如何能稳定整个网络。此练习  的目标是通过分析闭环系统矩阵的特征值来证明稳定性，这是理解钉扎控制机制的第一步。",
            "id": "4297419",
            "problem": "考虑一个具有 $n \\geq 2$ 个节点的简单路径图 $P_{n}$，节点按顺序从 $1$ 标记到 $n$，且边权重为单位值。令 $L \\in \\mathbb{R}^{n \\times n}$ 为图拉普拉斯矩阵，根据第一性原理定义如下：对于每个节点 $i$，$L_{ii}$ 等于节点 $i$ 的度，$L_{ij} = -1$ 如果节点 $i$ 和 $j$ 相邻，否则 $L_{ij} = 0$。使用标量增益 $K > 0$ 将单个节点固定在一端，具体为节点 $1$。将钉扎矩阵 $P \\in \\mathbb{R}^{n \\times n}$ 定义为对角矩阵，其中 $P_{11} = 1$，所有其他对角线元素等于 $0$。闭环网络矩阵为\n$$\nA_{c} = -\\big(L + K P\\big).\n$$\n任务：\n- 仅使用上述定义和初等矩阵及谱理论，推导对于一般 $n$ 和 $K > 0$ 时 $A_{c}$ 的显式三对角形式。\n- 使用拉普拉斯矩阵的二次型特征和钉扎增广，确定对于任何 $K > 0$，$A_{c}$ 的所有特征值是否都严格为负。\n- 计算行列式 $\\det(A_{c})$ 的闭式解，作为 $n$ 和 $K$ 的函数。\n\n你的最终答案必须是 $\\det(A_{c})$ 的单一简化解析表达式。不包含单位。无需数值舍入。",
            "solution": "按照要求，问题分三部分进行分析：推导闭环矩阵 $A_{c}$ 的形式，确定其特征值的符号，以及计算其行列式。\n\n首先，我们推导矩阵 $A_{c}$ 的显式形式。\n节点标记为 $1, 2, \\dots, n$ 的路径图 $P_{n}$ 具有连接节点 $i$ 和节点 $i+1$ 的边，其中 $i=1, \\dots, n-1$。\n节点 $i$ 的度，记为 $\\deg(i)$，对于端点（$i=1$ 和 $i=n$）为 $1$，对于内部节点（$i=2, \\dots, n-1$）为 $2$。\n图拉普拉斯矩阵 $L \\in \\mathbb{R}^{n \\times n}$ 由其元素定义：\n- $L_{ii} = \\deg(i)$\n- 如果节点 $i$ 和 $j$ 相邻，$L_{ij} = -1$。\n- 否则 $L_{ij} = 0$。\n\n对于路径图 $P_n$，这产生以下对称三对角矩阵：\n$$\nL = \\begin{pmatrix}\n1  -1  0  \\cdots  0  0 \\\\\n-1  2  -1  \\cdots  0  0 \\\\\n0  -1  2  \\cdots  0  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n0  0  0  \\cdots  2  -1 \\\\\n0  0  0  \\cdots  -1  1\n\\end{pmatrix}\n$$\n钉扎矩阵 $P$ 被给定为对角矩阵，其中 $P_{11}=1$，所有其他元素等于 $0$。我们可以将 $P$ 写成 $e_1 e_1^T$，其中 $e_1$ 是标准基向量 $(1, 0, \\dots, 0)^T$。\n钉扎增益为 $K > 0$。\n矩阵 $L + K P$ 是通过将 $K$ 加到 $L$ 的 $(1,1)$ 元素上得到的：\n$$\nL + K P = \\begin{pmatrix}\n1+K  -1  0  \\cdots  0  0 \\\\\n-1  2  -1  \\cdots  0  0 \\\\\n0  -1  2  \\cdots  0  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n0  0  0  \\cdots  2  -1 \\\\\n0  0  0  \\cdots  -1  1\n\\end{pmatrix}\n$$\n闭环网络矩阵 $A_{c}$ 定义为 $A_{c} = -(L + K P)$。因此其显式形式为：\n$$\nA_{c} = \\begin{pmatrix}\n-(1+K)  1  0  \\cdots  0  0 \\\\\n1  -2  1  \\cdots  0  0 \\\\\n0  1  -2  \\cdots  0  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n0  0  0  \\cdots  -2  1 \\\\\n0  0  0  \\cdots  1  -1\n\\end{pmatrix}\n$$\n这就是所要求的 $A_c$ 的显式三对角形式。\n\n其次，我们确定对于任何 $K > 0$，$A_c$ 的所有特征值是否都严格为负。\n设 $\\lambda$ 是 $A_c$ 的一个特征值，其对应的特征向量为 $v \\neq 0$。则 $A_c v = \\lambda v$。\n代入 $A_c$ 的定义，我们有 $-(L+KP)v = \\lambda v$，这意味着 $(L+KP)v = (-\\lambda)v$。\n这表明 $\\lambda$ 是 $A_c$ 的一个特征值，当且仅当 $-\\lambda$ 是矩阵 $M = L+KP$ 的一个特征值。\n因此，$A_c$ 的所有特征值都严格为负，当且仅当 $M$ 的所有特征值都严格为正。一个矩阵的所有特征值都严格为正，当且仅当它是正定的。我们使用二次型特征来检查 $M$ 是否是正定的。\n\n对于任何非零向量 $x \\in \\mathbb{R}^n$，$M$ 的二次型是 $x^T M x = x^T(L+KP)x = x^T L x + K x^T P x$。\n图拉普拉斯矩阵 $L$ 的二次型已知为 $x^T L x = \\sum_{(i,j) \\in E} w_{ij}(x_i - x_j)^2$，其中 $E$ 是边的集合，$w_{ij}$ 是边权重。对于单位权重的路径图，这变为：\n$$\nx^T L x = \\sum_{i=1}^{n-1} (x_i - x_{i+1})^2\n$$\n这一项是平方和，所以 $x^T L x \\geq 0$。\n钉扎项是 $x^T P x$。由于 $P = \\mathrm{diag}(1, 0, \\dots, 0)$，我们有 $x^T P x = x_1^2$。\n结合这些， M 的二次型是：\n$$\nx^T M x = \\sum_{i=1}^{n-1} (x_i - x_{i+1})^2 + K x_1^2\n$$\n考虑到 $K > 0$，右侧的两项都是非负的。因此，对于任何向量 $x$，$x^T M x \\geq 0$，这意味着 $M$ 是半正定的。\n要成为正定矩阵，我们必须对于所有非零 $x$ 有 $x^T M x > 0$。让我们找出 $x^T M x = 0$ 的条件：\n$$\n\\sum_{i=1}^{n-1} (x_i - x_{i+1})^2 + K x_1^2 = 0\n$$\n由于两项都是非负的，它们的和为零当且仅当两项都各自为零：\n1. $\\sum_{i=1}^{n-1} (x_i - x_{i+1})^2 = 0 \\implies x_i - x_{i+1} = 0 \\text{ for all } i=1, \\dots, n-1$。这意味着 $x_1 = x_2 = \\cdots = x_n$。\n2. $K x_1^2 = 0$。由于 $K>0$，这意味着 $x_1^2 = 0$，所以 $x_1 = 0$。\n\n结合这两个条件，我们有 $x_1=x_2=\\cdots=x_n=0$。这意味着 $x$ 必须是零向量。\n因此，对于任何非零向量 $x \\in \\mathbb{R}^n$，我们有 $x^T M x > 0$。矩阵 $M = L+KP$ 对于任何 $K>0$ 都是正定的。\n因此，$L+KP$ 的所有特征值都严格为正。由于 $A_c$ 的特征值是它们的相反数，所以对于任何 $K > 0$，$A_c$ 的所有特征值都严格为负。\n\n第三，我们计算行列式 $\\det(A_c)$。\n根据定义 $A_c = -(L+KP)$，并使用行列式的性质，我们有：\n$$\n\\det(A_c) = \\det(-(L+KP)) = (-1)^n \\det(L+KP)\n$$\n我们需要计算 $\\det(L+KP)$。令 $M_k$ 为 $M = L+KP$ 的左上角 $k \\times k$ 主子矩阵，并令 $D_k = \\det(M_k)$。矩阵 $M$ 是三对角的：\n$$\nM = \\begin{pmatrix}\n1+K  -1    \\\\\n-1  2  -1   \\\\\n \\ddots  \\ddots  \\ddots  \\\\\n  -1  2  -1 \\\\\n   -1  1\n\\end{pmatrix}_{n \\times n}\n$$\n我们可以找到 $D_k$ 的一个递推关系。\n$D_1 = 1+K$。\n$D_2 = \\det \\begin{pmatrix} 1+K  -1 \\\\ -1  2 \\end{pmatrix} = 2(1+K) - 1 = 2K+1$。\n对于 $k \\in \\{3, \\dots, n-1\\}$，沿 $M_k$ 的最后一行进行余子式展开，得到递推关系：\n$$\nD_k = 2 D_{k-1} - (-1)(-1)D_{k-2} = 2 D_{k-1} - D_{k-2}\n$$\n我们观察到一个模式：$D_k = kK+1$。让我们验证这个递推关系：\n$kK+1 = 2((k-1)K+1) - ((k-2)K+1) = (2k-2)K+2 - (k-2)K-1 = (2k-2-k+2)K + (2-1) = kK+1$。\n该模式对于 $k \\ge 3$ 成立，也适用于 $k=1$ 和 $k=2$。因此，$D_k = kK+1$ 对于 $k=1, \\dots, n-1$ 成立。\n\n为了找到 $D_n = \\det(M)$，我们沿 $n \\times n$ 矩阵 $M$ 的最后一行展开。对角线元素是 $a_{nn}=1$。\n$D_n = a_{nn} D_{n-1} - c_{n-1}b_{n-1} D_{n-2}$ 其中 $a_{nn}=1$，$b_{n-1}=-1$，$c_{n-1}=-1$。\n$D_n = 1 \\cdot D_{n-1} - (-1)(-1)D_{n-2} = D_{n-1} - D_{n-2}$。\n使用我们的公式 $D_k = kK+1$：\n$D_{n-1} = (n-1)K+1$\n$D_{n-2} = (n-2)K+1$\n将这些代入 $D_n$ 的表达式中：\n$$\n\\det(L+KP) = D_n = ((n-1)K+1) - ((n-2)K+1) = (n-1-n+2)K = K\n$$\n这可以使用矩阵树定理来确认。$L+K e_1 e_1^T$ 的行列式由 $K$ 乘以 $L$ 的伴随矩阵的主主子式给出，该主子式是生成树的数量，即 $\\tau(P_n)=1$。因此 $\\det(L+KP)=K \\cdot 1 = K$。\n\n最后，我们计算 $\\det(A_c)$：\n$$\n\\det(A_c) = (-1)^n \\det(L+KP) = (-1)^n K\n$$\n这个表达式就是所要求的作为 $n$ 和 $K$ 的函数的行列式的闭式解。",
            "answer": "$$\n\\boxed{(-1)^n K}\n$$"
        },
        {
            "introduction": "在确认了钉扎可以实现网络稳定后，下一步自然是量化其控制性能。本练习将星形图作为一种常见的网络拓扑结构，并引入代数连通度作为衡量同步速度和鲁棒性的关键性能指标。通过这个练习 ，我们将揭示钉扎增益 $K$ 如何直接增强这一关键的网络属性。",
            "id": "4297392",
            "problem": "考虑一个有 $n \\geq 3$ 个节点的星形图，其中包含一个中心节点和 $n-1$ 个叶节点。设节点索引 $0$ 表示中心节点，索引 $1,2,\\dots,n-1$ 表示叶节点。图拉普拉斯矩阵 $L$ 定义为 $L = D - A$，其中 $D$ 是对角度矩阵，$A$ 是邻接矩阵。在钉扎控制中，将一个标量钉扎增益 $K \\geq 0$ 应用于中心节点，得到钉扎拉普拉斯矩阵 $L + K P$，其中 $P$ 是对角钉扎矩阵，满足 $P_{00} = 1$ 且当 $i \\neq 0$ 时 $P_{ii} = 0$。\n\n从图拉普拉斯矩阵和钉扎矩阵的定义出发，利用对称性和合适的基分解，推导该星形拓扑下 $L + K P$ 的精确谱（所有特征值及其重数）。然后，将钉扎网络的代数连通度定义为 $L + K P$ 的最小特征值，并利用你得到的谱特征，说明该量如何依赖于 $K$ 和 $n$，包括其关于 $K$ 的单调性以及当 $K \\to \\infty$ 时的渐近行为。\n\n将你的最终答案表示为关于 $n$ 和 $K$ 的单个闭式解析表达式，用于描述 $L + K P$ 的代数连通度 $\\lambda_{2}(K)$。无需进行数值近似或舍入。",
            "solution": "该问题要求解星形图的钉扎拉普拉斯矩阵的谱，特别是其最小特征值的表达式，该特征值被定义为钉扎网络的代数连通度。\n\n首先，我们为一个有 $n \\geq 3$ 个节点的星形图构建矩阵。中心节点的索引为 $0$， $n-1$ 个叶节点的索引为 $1, 2, \\dots, n-1$。\n\n邻接矩阵 $A$ 的元素满足 $A_{0i} = A_{i0} = 1$（对于 $i \\in \\{1, \\dots, n-1\\}$），所有其他元素均为 $0$。\n度矩阵 $D$ 是一个对角矩阵，其中 $D_{00} = \\deg(0) = n-1$ 且 $D_{ii} = \\deg(i) = 1$（对于 $i \\in \\{1, \\dots, n-1\\}$）。\n\n图拉普拉斯矩阵 $L$ 由 $L = D - A$ 给出。其矩阵形式为：\n$$\nL =\n\\begin{pmatrix}\nn-1  -1  -1  \\cdots  -1 \\\\\n-1  1  0  \\cdots  0 \\\\\n-1  0  1  \\cdots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\n-1  0  0  \\cdots  1\n\\end{pmatrix}\n$$\n钉扎矩阵 $P$ 是一个对角矩阵，其中 $P_{00} = 1$ 且当 $i \\neq 0$ 时 $P_{ii} = 0$。钉扎拉普拉斯矩阵，我们记为 $M$，是 $M = L + K P$，其中 $K \\geq 0$ 是钉扎增益。\n$$\nM = L + K P =\n\\begin{pmatrix}\nn-1+K  -1  -1  \\cdots  -1 \\\\\n-1  1  0  \\cdots  0 \\\\\n-1  0  1  \\cdots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\n-1  0  0  \\cdots  1\n\\end{pmatrix}\n$$\n为了找到 $M$ 的谱，我们求解特征值问题 $M\\mathbf{v} = \\lambda\\mathbf{v}$，其中 $\\lambda$ 是一个特征值，$\\mathbf{v} = (v_0, v_1, \\dots, v_{n-1})^T$ 是对应的特征向量。该矩阵方程对应于以下线性方程组：\n\\begin{align}\n(n-1+K)v_0 - \\sum_{i=1}^{n-1} v_i = \\lambda v_0 \\quad (1) \\\\\n-v_0 + v_i = \\lambda v_i \\quad (2_i) \\quad \\text{for } i = 1, \\dots, n-1\n\\end{align}\n由于叶节点具有置换对称性，$M$ 的特征空间可以被分解。我们基于这种对称性来分析特征向量。\n\n情况1：特征向量满足 $v_i = c$（对于所有 $i \\in \\{1, \\dots, n-1\\}$）。\n这对应于位于由 $(1, 0, \\dots, 0)^T$ 和 $(0, 1, \\dots, 1)^T$ 张成的二维子空间中的特征向量。方程变为：\n\\begin{align}\n(n-1+K)v_0 - (n-1)c = \\lambda v_0 \\\\\n-v_0 + c = \\lambda c\n\\end{align}\n从第二个方程，我们得到 $-v_0 = (\\lambda - 1)c$。由于 $n \\ge 3$，对于未钉扎星形图拉普拉斯矩阵的已知特征值（$\\{0, n, 1, \\dots, 1\\}$），$\\lambda=1$ 是一个潜在的特征值。如果 $\\lambda=1$，则 $v_0=0$。将 $v_0=0$ 代入第一个方程得出 $-(n-1)c = 0$，所以 $c=0$，这给出了零向量。因此，$\\lambda=1$ 不是这类特征向量的特征值。我们可以假设 $\\lambda \\neq 1$ 并写出 $c = \\frac{-v_0}{\\lambda-1} = \\frac{v_0}{1-\\lambda}$。对于非平凡特征向量，必须有 $v_0 \\neq 0$。\n将 $c$ 代入第一个方程并除以 $v_0$：\n$$ (n-1+K) - \\frac{n-1}{1-\\lambda} = \\lambda $$\n乘以 $1-\\lambda$ 得到：\n$$ (n-1+K)(1-\\lambda) - (n-1) = \\lambda(1-\\lambda) $$\n$$ n-1 - (n-1)\\lambda + K - K\\lambda - (n-1) = \\lambda - \\lambda^2 $$\n$$ -\\lambda(n-1+K) + K = \\lambda - \\lambda^2 $$\n$$ \\lambda^2 - (n-1+K+1)\\lambda + K = 0 $$\n$$ \\lambda^2 - (n+K)\\lambda + K = 0 $$\n这个二次方程给出了两个特征值，我们记为 $\\lambda_+$ 和 $\\lambda_-$：\n$$ \\lambda_{\\pm} = \\frac{(n+K) \\pm \\sqrt{(n+K)^2 - 4K}}{2} $$\n判别式为 $(n+K)^2 - 4K = n^2 + 2nK + K^2 - 4K = n^2 + 2(n-2)K + K^2$。由于 $n \\geq 3$ 且 $K \\geq 0$，判别式为非负，因此特征值为实数。\n\n情况2：与叶节点的对称子空间正交的特征向量。\n这些特征向量具有形式 $\\mathbf{v} = (v_0, v_1, \\dots, v_{n-1})^T$，其中 $\\sum_{i=1}^{n-1} v_i = 0$。\n将此代入方程（1）：\n$$ (n-1+K)v_0 - 0 = \\lambda v_0 \\implies (n-1+K-\\lambda)v_0 = 0 $$\n从方程 $(2_i)$：\n$$ -v_0 + v_i = \\lambda v_i \\implies v_i(1-\\lambda) = v_0 $$\n如果我们假设 $\\lambda \\neq 1$，则对所有 $i=1, \\dots, n-1$ 有 $v_i = v_0/(1-\\lambda)$。条件 $\\sum v_i = 0$ 意味着 $(n-1)v_0/(1-\\lambda) = 0$。由于 $n \\ge 3$，这意味着 $v_0 = 0$。如果 $v_0=0$，则对所有 $i$ 都有 $v_i=0$，这导致了平凡零向量。\n因此，必须有 $\\lambda=1$。\n如果 $\\lambda=1$，方程 $(2_i)$ 变为 $-v_0 + v_i = v_i$，这意味着 $v_0=0$。\n方程 (1) 变为 $(n-1+K) \\cdot 0 - \\sum v_i = 1 \\cdot 0$，即 $0 - 0 = 0$。只要 $\\sum v_i = 0$，此式就成立。\n所以，任何形如 $(0, v_1, \\dots, v_{n-1})^T$ 且满足 $\\sum_{i=1}^{n-1} v_i = 0$ 的向量都是特征值为 $\\lambda=1$ 的特征向量。这类向量构成的子空间维数为 $(n-1)-1 = n-2$。\n因此，$\\lambda=1$ 是一个重数为 $n-2$ 的特征值。\n\n$M=L+KP$ 的全谱为 $\\{ \\lambda_-, \\lambda_+, 1, \\dots, 1 \\}$，其中 $1$ 的重数为 $n-2$。\n\n问题将钉扎网络的代数连通度 $\\lambda_2(K)$ 定义为 $M$ 的最小特征值。我们必须求 $\\min(\\lambda_-, \\lambda_+, 1)$。由于 $\\sqrt{(n+K)^2 - 4K} \\ge 0$，我们有 $\\lambda_- \\le \\lambda_+$。所以我们需要将 $\\lambda_-$ 与 $1$ 进行比较。\n我们来检验 $\\lambda_-  1$：\n$$ \\frac{n+K - \\sqrt{(n+K)^2 - 4K}}{2}  1 $$\n$$ n+K - 2  \\sqrt{(n+K)^2 - 4K} $$\n由于 $n \\ge 3$ 且 $K \\ge 0$，左边 $n+K-2 \\ge 1 > 0$。我们可以对两边进行平方：\n$$ (n+K-2)^2  (n+K)^2 - 4K $$\n$$ ((n+K)-2)^2  (n+K)^2 - 4K $$\n$$ (n+K)^2 - 4(n+K) + 4  (n+K)^2 - 4K $$\n$$ -4n - 4K + 4  -4K $$\n$$ -4n + 4  0 \\implies 4  4n \\implies 1  n $$\n这对于 $n \\ge 3$ 成立。因此，对于所有 $K \\ge 0$，都有 $\\lambda_-  1$。\n最小的特征值是 $\\lambda_-$。因此，代数连通度为：\n$$ \\lambda_2(K) = \\lambda_- = \\frac{n+K - \\sqrt{(n+K)^2 - 4K}}{2} $$\n\n现在我们分析其性质。对于 $K=0$，$\\lambda_2(0) = \\frac{n-\\sqrt{n^2}}{2}=0$，这是正确的，因为未钉扎的拉普拉斯矩阵是半正定的，其最小特征值为 $0$。\n\n关于 $K$ 的单调性：我们计算导数 $\\frac{d\\lambda_2}{dK}$。\n$$ \\lambda_2(K) = \\frac{1}{2} \\left( n+K - \\sqrt{K^2+2(n-2)K+n^2} \\right) $$\n$$ \\frac{d\\lambda_2}{dK} = \\frac{1}{2} \\left( 1 - \\frac{2K+2(n-2)}{2\\sqrt{K^2+2(n-2)K+n^2}} \\right) = \\frac{1}{2} \\left( 1 - \\frac{K+n-2}{\\sqrt{(n+K)^2-4K}} \\right) $$\n为了证明该导数为正，我们需要证明 $1 > \\frac{K+n-2}{\\sqrt{(n+K)^2-4K}}$，即 $\\sqrt{(n+K)^2-4K} > K+n-2$。\n对两边（均为正）平方：$(n+K)^2-4K > (K+n-2)^2$。这可以化简为 $1  n$，此式成立。因此，$\\frac{d\\lambda_2}{dK} > 0$，$\\lambda_2(K)$ 是关于 $K$ 的单调递增函数。\n\n当 $K \\to \\infty$ 时的渐近行为：\n为求极限，我们乘以其共轭式：\n$$ \\lambda_2(K) = \\frac{(n+K - \\sqrt{(n+K)^2 - 4K})(n+K + \\sqrt{(n+K)^2 - 4K})}{2(n+K + \\sqrt{(n+K)^2 - 4K})} $$\n$$ \\lambda_2(K) = \\frac{(n+K)^2 - ((n+K)^2 - 4K)}{2(n+K + \\sqrt{(n+K)^2 - 4K})} = \\frac{4K}{2(n+K + \\sqrt{K^2+2(n-2)K+n^2})} $$\n$$ \\lambda_2(K) = \\frac{2K}{n+K + K\\sqrt{1+\\frac{2(n-2)}{K}+\\frac{n^2}{K^2}}} $$\n分子分母同除以 $K$：\n$$ \\lambda_2(K) = \\frac{2}{\\frac{n}{K}+1 + \\sqrt{1+\\frac{2(n-2)}{K}+\\frac{n^2}{K^2}}} $$\n当 $K \\to \\infty$ 时取极限：\n$$ \\lim_{K\\to\\infty} \\lambda_2(K) = \\frac{2}{0+1 + \\sqrt{1+0+0}} = \\frac{2}{2} = 1 $$\n代数连通度 $\\lambda_2(K)$ 从 $0$（当 $K=0$ 时）开始单调增加，并在 $K \\to \\infty$ 时渐近地趋近于 $1$。\n\n代数连通度 $\\lambda_2(K)$ 的最终表达式即为 $\\lambda_-$ 的表达式。\n$$ \\lambda_2(K) = \\frac{n+K - \\sqrt{(n+K)^2 - 4K}}{2} $$",
            "answer": "$$\\boxed{\\frac{n+K - \\sqrt{(n+K)^2 - 4K}}{2}}$$"
        },
        {
            "introduction": "这个更高级的练习将我们从分析引向设计，其核心问题是：我们应该在哪里施加控制？“最优”控制的定义取决于我们选择的性能目标。本练习  比较了两种不同的优化准则——一种关注最差情况下的收敛速度（谱优化），另一种关注对噪声的平均响应（能量优化）。通过在环形图上评估不同钉扎方案，我们将探索有效控制器布局背后的设计原理。",
            "id": "4297382",
            "problem": "考虑一个包含四个节点 $G$ 的无向、无权循环图，其顶点集为 $\\{1,2,3,4\\}$，边集为 $\\{(1,2),(2,3),(3,4),(4,1)\\}$。网络状态为 $\\mathbf{x}(t) \\in \\mathbb{R}^{4}$，其在带有钉扎反馈的线性一致性动力学下向参考状态 $\\mathbf{x}_{r}=\\mathbf{0}$ 演化：\n$$\n\\frac{d\\mathbf{x}}{dt} \\;=\\; -\\big(L + \\kappa P\\big)\\,\\mathbf{x},\n$$\n其中，$L$ 是图 $G$ 的拉普拉斯矩阵，$\\kappa0$ 是钉扎增益，$P$ 是一个对角选择矩阵，如果节点 $i$ 被钉扎，则其元素 $P_{ii}=1$，否则 $P_{ii}=0$。设定 $\\kappa=1$ 并将钉扎节点数固定为 $m=2$。由于图的对称性，我们只需比较两种非同构的钉扎配置：\n- 相邻钉扎：$S_{\\mathrm{adj}}=\\{1,2\\}$。\n- 相对钉扎：$S_{\\mathrm{opp}}=\\{1,3\\}$。\n\n定义谱最优准则为最大化最小特征值 $\\lambda_{\\min}\\big(L+\\kappa P\\big)$，该特征值决定了钉扎一致性的最差情况指数收敛速率。定义能量最优准则为最小化稳态扰动-状态能量度量\n$$\nJ(P) \\;=\\; \\operatorname{tr}\\!\\big((L+\\kappa P)^{-1}\\big),\n$$\n该度量量化了在对称正定漂移矩阵 $L+\\kappa P$ 下，从作用于状态的单位白噪声加性扰动到状态输出的平方 $\\mathcal{H}_{2}$（其中 $\\mathcal{H}_{2}$ 代表平方可积传递函数的Hardy空间）响应。\n\n任务：\n1. 从拉普拉斯算子定义和用于 $\\mathcal{H}_{2}$ 能量的线性时不变李雅普诺夫方程出发，推导当前对称且严格稳定情况下的表达式 $J(P)=\\operatorname{tr}\\big((L+\\kappa P)^{-1}\\big)$。根据第一性原理和线性系统理论中公认的事实，论证每一步。\n2. 对于 $\\kappa=1$ 时的每种钉扎配置 $S_{\\mathrm{adj}}$ 和 $S_{\\mathrm{opp}}$，使用尊重循环图自同构的对称性约简方法计算 $A(P)=L+\\kappa P$ 的谱。根据这些谱，精确计算 $\\lambda_{\\min}\\big(A(P)\\big)$ 和 $J(P)$。\n3. 识别谱最优和能量最优的钉扎配置（它们可能一致也可能不一致），并通过解释钉扎位置如何重塑除最差模式外的模态谱来解释任何差异（或缺乏差异）。\n4. 最后，计算比率\n$$\nR \\;=\\; \\frac{J\\big(P_{\\mathrm{spectral\\text{-}opt}}\\big)}{J\\big(P_{\\mathrm{energy\\text{-}opt}}\\big)},\n$$\n并给出其值。如果需要近似，将最终数值答案四舍五入到四位有效数字。不需要物理单位。",
            "solution": "该问题被验证为具有科学依据、提法恰当且客观。它提出了网络控制理论领域一个标准的、可解的问题。\n\n### 第1部分：能量度量 $J(P)$ 的推导\n\n我们从受到加性扰动的线性时不变（LTI）系统开始：\n$$\n\\frac{d\\mathbf{x}}{dt} \\;=\\; A\\mathbf{x} + B\\mathbf{w}\n$$\n其中 $\\mathbf{x} \\in \\mathbb{R}^n$ 是状态向量，$A \\in \\mathbb{R}^{n \\times n}$ 是系统矩阵，$\\mathbf{w} \\in \\mathbb{R}^p$ 是不相关单位白噪声过程的向量（即 $\\mathbb{E}[\\mathbf{w}(t)\\mathbf{w}(\\tau)^T] = I_p \\delta(t-\\tau)$），$B \\in \\mathbb{R}^{n \\times p}$ 是输入矩阵。\n\n在我们的问题中，系统动力学由 $\\frac{d\\mathbf{x}}{dt} = -(L + \\kappa P)\\mathbf{x}$ 给出。扰动被描述为“作用于状态的单位白噪声加性扰动”。这意味着输入矩阵 $B$ 是单位矩阵 $I_n$（其中 $n=4$），系统矩阵是 $A = -(L + \\kappa P)$。\n\n从扰动输入 $\\mathbf{w}$ 到状态输出 $\\mathbf{x}$（即输出矩阵 $C=I_n$）的平方 $\\mathcal{H}_2$ 范数定义为状态的稳态协方差矩阵的迹，$X = \\lim_{t\\to\\infty} \\mathbb{E}[\\mathbf{x}(t)\\mathbf{x}(t)^T]$。对于一个稳定的LTI系统，矩阵 $X$ 是代数李雅普诺夫方程的唯一、对称、半正定解：\n$$\nAX + XA^T + BB^T \\;=\\; 0\n$$\n对于我们的特定系统，我们代入 $A = -(L + \\kappa P)$ 和 $B = I_n$。图 $G$ 是无向的，因此其拉普拉斯矩阵 $L$ 是对称矩阵。钉扎矩阵 $P$ 是对角矩阵，因此也是对称的。所以，系统矩阵 $A = -(L + \\kappa P)$ 是对称的，即 $A=A^T$。李雅普诺夫方程变为：\n$$\n-(L + \\kappa P)X - X(L + \\kappa P) + I_n I_n^T \\;=\\; 0\n$$\n$$\n-2(L + \\kappa P)X + I_n \\;=\\; 0\n$$\n为使此方程对 $X$ 有唯一解，矩阵 $L + \\kappa P$ 必须是可逆的。一个连通图的拉普拉斯矩阵 $L$ 是半正定的，具有一个对应于特征向量 $\\mathbf{1}$（全1向量）的零特征值。钉扎至少一个节点（即 $P \\neq 0$）确保了 $(L+\\kappa P)\\mathbf{1} = L\\mathbf{1} + \\kappa P\\mathbf{1} = \\mathbf{0} + \\kappa P\\mathbf{1} \\neq \\mathbf{0}$。由于 $L$ 和 $\\kappa P$ 都是半正定的，它们的和 $L+\\kappa P$ 也是半正定的。因为它不再有特征值为0的特征向量 $\\mathbf{1}$，所以它没有零特征值，因此是正定且可逆的。\n\n求解 $X$，我们得到：\n$$\nX \\;=\\; \\frac{1}{2}(L + \\kappa P)^{-1}\n$$\n那么平方 $\\mathcal{H}_2$ 范数是：\n$$\n\\|\\cdot\\|_{\\mathcal{H}_2}^2 \\;=\\; \\operatorname{tr}(X) \\;=\\; \\operatorname{tr}\\left(\\frac{1}{2}(L + \\kappa P)^{-1}\\right) \\;=\\; \\frac{1}{2} \\operatorname{tr}\\big((L + \\kappa P)^{-1}\\big)\n$$\n问题将能量度量定义为 $J(P) = \\operatorname{tr}((L + \\kappa P)^{-1})$。因此，该度量是平方 $\\mathcal{H}_2$ 范数的两倍。这完成了基于所述原理的推导。\n\n### 第2部分：钉扎配置的谱和能量分析\n\n该图是包含 $n=4$ 个节点的循环图。其拉普拉斯矩阵 $L = D-A_G$ 为：\n$$\nL \\;=\\; \\begin{pmatrix} 2  -1  0  -1 \\\\ -1  2  -1  0 \\\\ 0  -1  2  -1 \\\\ -1  0  -1  2 \\end{pmatrix}\n$$\n给定 $\\kappa=1$。用于分析的矩阵是 $A(P) = L+P$。\n\n#### 情况1：相邻钉扎 ($S_{\\mathrm{adj}}=\\{1,2\\}$)\n钉扎矩阵为 $P_{\\mathrm{adj}} = \\operatorname{diag}(1,1,0,0)$。\n$$\nA_{\\mathrm{adj}} = L+P_{\\mathrm{adj}} = \\begin{pmatrix} 3  -1  0  -1 \\\\ -1  3  -1  0 \\\\ 0  -1  2  -1 \\\\ -1  0  -1  2 \\end{pmatrix}\n$$\n该矩阵关于置换 $\\pi=(1,2)(3,4)$ 是对称的，这相当于将图沿垂直轴反射。我们可以通过将 $\\mathbb{R}^4$ 分解为此置换的对称和反对称子空间来对 $A_{\\mathrm{adj}}$ 进行块对角化。\n对称子空间（$\\pi$ 的特征值为 $+1$ 的特征向量）由 $\\mathbf{v}_1=(1,1,0,0)^T$ 和 $\\mathbf{v}_2=(0,0,1,1)^T$ 张成。$A_{\\mathrm{adj}}$ 在此子空间上的作用是：\n$A_{\\mathrm{adj}}\\mathbf{v}_1 = (2,2,-1,-1)^T = 2\\mathbf{v}_1 - \\mathbf{v}_2$\n$A_{\\mathrm{adj}}\\mathbf{v}_2 = (-1,-1,1,1)^T = -\\mathbf{v}_1 + \\mathbf{v}_2$\n矩阵表示为 $M_{\\mathrm{sym}} = \\begin{pmatrix} 2  -1 \\\\ -1  1 \\end{pmatrix}$。其特征方程为 $(2-\\lambda)(1-\\lambda)-1 = \\lambda^2-3\\lambda+1=0$，特征值为 $\\lambda = \\frac{3 \\pm \\sqrt{5}}{2}$。\n\n反对称子空间（$\\pi$ 的特征值为 $-1$ 的特征向量）由 $\\mathbf{v}_3=(1,-1,0,0)^T$ 和 $\\mathbf{v}_4=(0,0,1,-1)^T$ 张成。$A_{\\mathrm{adj}}$ 在此子空间上的作用是：\n$A_{\\mathrm{adj}}\\mathbf{v}_3 = (4,-4,1,-1)^T = 4\\mathbf{v}_3 + \\mathbf{v}_4$\n$A_{\\mathrm{adj}}\\mathbf{v}_4 = (1,-1,3,-3)^T = \\mathbf{v}_3 + 3\\mathbf{v}_4$\n矩阵表示为 $M_{\\mathrm{anti}} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$。其特征方程为 $(4-\\lambda)(3-\\lambda)-1 = \\lambda^2-7\\lambda+11=0$，特征值为 $\\lambda = \\frac{7 \\pm \\sqrt{5}}{2}$。\n\n$A_{\\mathrm{adj}}$ 的谱为 $\\left\\{ \\frac{3-\\sqrt{5}}{2}, \\frac{3+\\sqrt{5}}{2}, \\frac{7-\\sqrt{5}}{2}, \\frac{7+\\sqrt{5}}{2} \\right\\}$。\n最小特征值为 $\\lambda_{\\min}(A_{\\mathrm{adj}}) = \\frac{3-\\sqrt{5}}{2}$。\n能量度量为 $J(P_{\\mathrm{adj}}) = \\operatorname{tr}(A_{\\mathrm{adj}}^{-1}) = \\sum_i \\frac{1}{\\lambda_i}$：\n$$\nJ(P_{\\mathrm{adj}}) = \\left(\\frac{1}{\\frac{3-\\sqrt{5}}{2}} + \\frac{1}{\\frac{3+\\sqrt{5}}{2}}\\right) + \\left(\\frac{1}{\\frac{7-\\sqrt{5}}{2}} + \\frac{1}{\\frac{7+\\sqrt{5}}{2}}\\right)\n$$\n$$\nJ(P_{\\mathrm{adj}}) = \\left(\\frac{2(3+\\sqrt{5}) + 2(3-\\sqrt{5})}{9-5}\\right) + \\left(\\frac{2(7+\\sqrt{5}) + 2(7-\\sqrt{5})}{49-5}\\right) = \\frac{12}{4} + \\frac{28}{44} = 3 + \\frac{7}{11} = \\frac{40}{11}\n$$\n\n#### 情况2：相对钉扎 ($S_{\\mathrm{opp}}=\\{1,3\\}$)\n钉扎矩阵为 $P_{\\mathrm{opp}} = \\operatorname{diag}(1,0,1,0)$。\n$$\nA_{\\mathrm{opp}} = L+P_{\\mathrm{opp}} = \\begin{pmatrix} 3  -1  0  -1 \\\\ -1  2  -1  0 \\\\ 0  -1  3  -1 \\\\ -1  0  -1  2 \\end{pmatrix}\n$$\n该矩阵关于置换 $\\pi=(1,3)(2,4)$ 是对称的，这是一个 $180$ 度的旋转。我们进行类似的块对角化。\n对称子空间（$\\pi$ 的特征值为 $+1$ 的特征向量）由 $\\mathbf{v}_1=(1,0,1,0)^T$ 和 $\\mathbf{v}_2=(0,1,0,1)^T$ 张成。$A_{\\mathrm{opp}}$ 的作用是：\n$A_{\\mathrm{opp}}\\mathbf{v}_1 = (3,-1,3,-1)^T = 3\\mathbf{v}_1 - \\mathbf{v}_2$\n$A_{\\mathrm{opp}}\\mathbf{v}_2 = (-2,2,-2,2)^T = -2\\mathbf{v}_1 + 2\\mathbfv_2$\n矩阵表示为 $M_{\\mathrm{sym}} = \\begin{pmatrix} 3  -2 \\\\ -1  2 \\end{pmatrix}$。其特征方程为 $(3-\\lambda)(2-\\lambda)-2 = \\lambda^2-5\\lambda+4=0$，即 $(\\lambda-1)(\\lambda-4)=0$，特征值为 $\\lambda=1, 4$。\n\n反对称子空间（$\\pi$ 的特征值为 $-1$ 的特征向量）由 $\\mathbf{v}_3=(1,0,-1,0)^T$ 和 $\\mathbf{v}_4=(0,1,0,-1)^T$ 张成。$A_{\\mathrm{opp}}$ 的作用是：\n$A_{\\mathrm{opp}}\\mathbf{v}_3 = (3,-1,-3,1)^T = 3\\mathbf{v}_3 - \\mathbf{v}_4$\n$A_{\\mathrm{opp}}\\mathbf{v}_4 = (0,2,0,-2)^T = 0\\mathbf{v}_3 + 2\\mathbf{v}_4$\n矩阵表示为 $M_{\\mathrm{anti}} = \\begin{pmatrix} 3  0 \\\\ -1  2 \\end{pmatrix}$。由于这是一个三角矩阵，其特征值是对角线上的元素：$\\lambda=2, 3$。\n\n$A_{\\mathrm{opp}}$ 的谱为 $\\{1, 2, 3, 4\\}$。\n最小特征值为 $\\lambda_{\\min}(A_{\\mathrm{opp}}) = 1$。\n能量度量为 $J(P_{\\mathrm{opp}}) = \\sum_i \\frac{1}{\\lambda_i}$：\n$$\nJ(P_{\\mathrm{opp}}) = \\frac{1}{1} + \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{4} = \\frac{12+6+4+3}{12} = \\frac{25}{12}\n$$\n\n### 第3部分：最优配置与解释\n\n**谱最优配置：** 最大化 $\\lambda_{\\min}$。\n- $\\lambda_{\\min}(A_{\\mathrm{adj}}) = \\frac{3-\\sqrt{5}}{2} \\approx 0.382$\n- $\\lambda_{\\min}(A_{\\mathrm{opp}}) = 1$\n由于 $1  \\frac{3-\\sqrt{5}}{2}$，**相对钉扎**配置 $S_{\\mathrm{opp}}$ 是谱最优的。\n\n**能量最优配置：** 最小化 $J(P)$。\n- $J(P_{\\mathrm{adj}}) = \\frac{40}{11} \\approx 3.636$\n- $J(P_{\\mathrm{opp}}) = \\frac{25}{12} \\approx 2.083$\n由于 $\\frac{25}{12}  \\frac{40}{11}$，**相对钉扎**配置 $S_{\\mathrm{opp}}$ 是能量最优的。\n\n在这种情况下，两种最优性准则一致。相对钉扎配置 $S_{\\mathrm{opp}}$ 在两种度量下都更优。没有需要解释的差异。这种一致性的原因在于完整的谱分布。相对钉扎的谱 $\\{1, 2, 3, 4\\}$，优于相邻钉扎的谱 $\\left\\{\\frac{3-\\sqrt{5}}{2}, \\frac{7-\\sqrt{5}}{2}, \\frac{3+\\sqrt{5}}{2}, \\frac{7+\\sqrt{5}}{2}\\right\\} \\approx \\{0.38, 2.38, 2.62, 4.62\\}$，不仅在最小特征值上，而且在很大程度上全面占优。\n\n这两种方案之间的差异可以从物理上解释。对节点 $\\{1,2\\}$ 进行相邻钉扎会产生一个连续的钉扎节点块和一个连续的未钉扎节点块 $\\{3,4\\}$。这个未钉扎的“尾部”控制不佳，导致一个衰减非常慢的模式（一个“软”模式），由小的特征值 $\\lambda_{\\min}(A_{\\mathrm{adj}}) \\approx 0.382$ 表示。相反，对节点 $\\{1,3\\}$ 进行相对钉扎可以更均匀地分布控制力。每个未钉扎的节点（2和4）都直接连接到一个钉扎节点和一个未钉扎节点，打破了任何大的、不受控制的子结构。这导致所有网络模式更有效的“硬化”，表现为更大的 $\\lambda_{\\min}$ 和一个通常“更好”的谱，从而得到更小的能量度量 $J(P)$。\n\n### 第4部分：最终比率计算\n比率定义为：\n$$\nR \\;=\\; \\frac{J\\big(P_{\\mathrm{spectral\\text{-}opt}}\\big)}{J\\big(P_{\\mathrm{energy\\text{-}opt}}\\big)}\n$$\n从第3部分，我们确定谱最优配置为 $S_{\\mathrm{opp}}$，因此 $P_{\\mathrm{spectral\\text{-}opt}} = P_{\\mathrm{opp}}$。\n我们还确定能量最优配置为 $S_{\\mathrm{opp}}$，因此 $P_{\\mathrm{energy\\text{-}opt}} = P_{\\mathrm{opp}}$。\n因此，该比率变为：\n$$\nR \\;=\\; \\frac{J(P_{\\mathrm{opp}})}{J(P_{\\mathrm{opp}})} = 1\n$$\n其值恰好为 $1$，无需近似。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}