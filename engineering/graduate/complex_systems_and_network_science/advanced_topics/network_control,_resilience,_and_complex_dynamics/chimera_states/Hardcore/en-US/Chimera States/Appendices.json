{
    "hands_on_practices": [
        {
            "introduction": "This first exercise establishes the fundamental workflow for any computational study in nonlinear dynamics. Before simulating complex phenomena like chimera states, one must construct a logical sequence of steps, from parameter definition to final analysis. Mastering this procedural backbone  is the essential first step toward successful and reproducible numerical experimentation.",
            "id": "1666625",
            "problem": "A student in an introductory course on nonlinear dynamics is tasked with numerically investigating chimera states. These are special spatiotemporal patterns in networks of identical oscillators where a subset of oscillators synchronizes while the rest remain incoherent. The student considers a one-dimensional ring of $N$ identical phase oscillators with non-local coupling, governed by the Kuramoto-Sakaguchi equations:\n$$ \\frac{d\\theta_i}{dt} = \\omega - \\frac{K}{2R+1} \\sum_{j=i-R}^{j=i+R} \\sin(\\theta_i - \\theta_j + \\alpha) $$\nHere, $\\theta_i$ is the phase of the $i$-th oscillator (with indices taken modulo $N$), $\\omega$ is the uniform natural frequency, $K$ is the coupling strength, $R$ is the coupling radius defining the neighborhood size, and $\\alpha$ is a phase lag parameter.\n\nTo find a chimera state, the student must perform a sequence of steps in a precise order. Below are five fundamental actions required for this numerical experiment:\n\n(i) Evolve the system of $N$ coupled Ordinary Differential Equations (ODEs) forward in time using a numerical integration method (e.g., Runge-Kutta) for a large number of time steps.\n(ii) Specify the fixed parameters of the system: the number of oscillators $N$, their natural frequency $\\omega$, the coupling strength $K$, the coupling radius $R$, and the phase lag $\\alpha$.\n(iii) After the evolution, analyze the behavior of the oscillators to check for the hallmark of a chimera state: the coexistence of a group of oscillators with identical effective frequencies and another group with a distribution of different effective frequencies.\n(iv) Set the initial condition for the system by assigning a phase $\\theta_i(0)$ to each oscillator at time $t=0$. For chimeras, a specially prepared non-uniform state is often required.\n(v) Ignore the data from the initial portion of the time evolution to ensure that any transient behavior has decayed and the system has settled onto its long-term attractor.\n\nWhich of the following options represents the correct logical sequence of these actions to successfully set up and execute the simulation to search for a chimera state?\n\nA. (ii) → (iv) → (i) → (v) → (iii)\n\nB. (ii) → (iv) → (iii) → (i) → (v)\n\nC. (iv) → (ii) → (i) → (v) → (iii)\n\nD. (ii) → (i) → (iv) → (v) → (iii)\n\nE. (ii) → (iv) → (i) → (iii) → (v)",
            "solution": "We are to determine the correct logical sequence of actions to numerically search for a chimera state in the given system of $N$ nonlocally coupled phase oscillators governed by the Kuramoto-Sakaguchi equations\n$$\n\\frac{d\\theta_{i}}{dt}=\\omega-\\frac{K}{2R+1}\\sum_{j=i-R}^{i+R}\\sin\\!\\big(\\theta_{i}-\\theta_{j}+\\alpha\\big),\n$$\nwith indices taken modulo $N$. This defines an initial value problem for $N$ coupled first-order ODEs. For such a problem, one must first fully specify the vector field and the initial condition before performing any time integration, then integrate forward, remove transients to focus on the long-term behavior (attractor), and finally analyze observables that reveal the chimera signature.\n\nFirst, one must specify the fixed parameters of the model to define the right-hand side map $f:\\mathbb{T}^{N}\\to\\mathbb{R}^{N}$ of the ODE. Writing the system compactly as\n$$\n\\dot{\\theta}_{i}=f_{i}(\\theta;\\omega,K,R,\\alpha), \\quad i\\in\\{1,\\dots,N\\},\n$$\nwe see that the vector field depends on the constants $N$, $\\omega$, $K$, $R$, and $\\alpha$. Without these, the ODE is not fully defined. Therefore, step (ii) must precede all others.\n\nSecond, an initial value problem requires an initial condition. One must assign phases $\\theta_{i}(0)$ for all $i$. Since the goal is to find a chimera state, one typically chooses a specially prepared non-uniform initial condition to bias the dynamics toward coexistence of coherent and incoherent groups. Thus step (iv) naturally follows after specifying the parameters in step (ii).\n\nThird, with the vector field $f$ and initial condition $\\theta(0)$ specified, one can numerically integrate the ODE forward in time using an appropriate method (for example, a Runge-Kutta scheme), which is step (i). This produces a trajectory $t\\mapsto\\theta(t)$.\n\nFourth, to observe the long-term behavior, one discards an initial transient interval to allow the trajectory to approach its attractor. Denote a transient time $T_{\\mathrm{trans}}$ and only consider data for $t\\geq T_{\\mathrm{trans}}$. This is step (v). This practice ensures that any initial-condition-induced short-time effects do not contaminate asymptotic diagnostics.\n\nFifth, one analyzes the post-transient dynamics to detect the chimera hallmark: coexistence of a synchronized subgroup and an incoherent subgroup. A standard diagnostic is the effective frequency of each oscillator, computed as a long-time average after the transient:\n$$\n\\Omega_{i}=\\lim_{T\\to\\infty}\\frac{\\theta_{i}(T_{\\mathrm{trans}}+T)-\\theta_{i}(T_{\\mathrm{trans}})}{T}.\n$$\nIn a chimera, there exists a subset of indices for which $\\Omega_{i}$ take an identical value (phase-locked group) and a complementary subset where $\\Omega_{i}$ are distributed over an interval (drifting group). This analysis corresponds to step (iii) and must come after integration and transient removal.\n\nPutting the logically necessary order together yields the sequence: specify parameters (ii) → set initial condition (iv) → integrate (i) → discard transients (v) → analyze for chimera (iii). Among the given options, this corresponds to option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once a simulation is run, the next critical task is to robustly identify and quantify the observed patterns. This hands-on coding exercise  guides you through developing a complete algorithmic pipeline for segmenting a network into coherent and incoherent domains using the local Kuramoto order parameter, $R_i$. You will generate synthetic data and apply rigorous validation metrics, mirroring the workflow of modern research in complex systems.",
            "id": "4268035",
            "problem": "Consider a ring network of $N$ phase oscillators with phases $\\theta_i \\in [0,2\\pi)$ in radians, indexed by $i \\in \\{0,1,\\dots,N-1\\}$ with periodic boundary conditions. A chimera state is a spatiotemporal pattern in which a subset of oscillators is phase-coherent while the complementary subset is phase-incoherent. Starting from foundational definitions, design and implement an algorithm that segments the ring into coherent and incoherent domains using thresholds on a local order parameter, and then validates the classifications against synthetic data with known ground-truth domains.\n\nThe foundational base for the derivation is the Kuramoto order parameter (KOP). For a given set of phases $\\{\\theta_j\\}$, the global KOP is defined by\n$$\nR = \\left| \\frac{1}{N} \\sum_{j=0}^{N-1} e^{\\mathrm{i} \\theta_j} \\right| ,\n$$\nwhich measures the overall phase coherence of the network. To perform spatial segmentation, define the local neighborhood $\\mathcal{N}_i$ of node $i$ as the set of indices\n$$\n\\mathcal{N}_i = \\{i-w, i-w+1, \\dots, i+w\\} \\ (\\text{taken modulo } N),\n$$\nwhere $w$ is a positive integer and the neighborhood size is $m = 2w+1$. The local KOP at node $i$ is then\n$$\nR_i = \\left| \\frac{1}{m} \\sum_{j \\in \\mathcal{N}_i} e^{\\mathrm{i} \\theta_j} \\right| .\n$$\nIn domains where phases are locally coherent, $R_i$ is close to $1$, whereas in incoherent regions with nearly uniform random phases, the average of unit complex numbers tends to cancel, making $R_i$ close to $0$ as $m$ grows.\n\nClassification rule. Given two thresholds $T_{\\text{coh}}$ and $T_{\\text{incoh}}$ satisfying $1 \\ge T_{\\text{coh}} \\ge T_{\\text{incoh}} \\ge 0$, classify each node $i$ as follows:\n- coherent if $R_i \\ge T_{\\text{coh}}$,\n- incoherent if $R_i \\le T_{\\text{incoh}}$,\n- indeterminate otherwise.\nThe angle unit throughout is radians.\n\nSynthetic data generation. Construct synthetic chimera snapshots with known ground truth labels as follows. Fix $N$, a coherent fraction $f \\in [0,1]$, a phase slope $k \\ge 0$ in radians per node, and noise levels $\\sigma_c \\ge 0$ and $\\sigma_u \\ge 0$ for coherent and incoherent domains, respectively. Let $C = \\lfloor f N \\rfloor$ be the size of the coherent domain, occupying indices $i = 0,1,\\dots,C-1$, and let the incoherent domain occupy indices $i = C,\\dots,N-1$. Draw a base phase $\\theta_0 \\sim \\mathrm{Uniform}(0,2\\pi)$. Generate phases by\n$$\n\\theta_i =\n\\begin{cases}\n\\theta_0 + k i + \\eta_i \\pmod{2\\pi},  i \\in \\{0,\\dots,C-1\\},\\ \\eta_i \\sim \\mathcal{N}(0,\\sigma_c^2),\\\\\n\\phi_i + \\xi_i \\pmod{2\\pi},  i \\in \\{C,\\dots,N-1\\},\\ \\phi_i \\sim \\mathrm{Uniform}(0,2\\pi),\\ \\xi_i \\sim \\mathcal{N}(0,\\sigma_u^2).\n\\end{cases}\n$$\nDefine the ground-truth label $y_i = 1$ if $i  C$ and $y_i = 0$ otherwise.\n\nValidation metrics. Let $\\hat{y}_i \\in \\{1,0,-1\\}$ be predicted labels for node $i$ based on the rule above, where $-1$ denotes indeterminate. Consider only covered nodes with $\\hat{y}_i \\ne -1$ to evaluate classification. Define the coverage fraction\n$$\n\\text{coverage} = \\frac{\\#\\{i : \\hat{y}_i \\ne -1\\}}{N} .\n$$\nOn the covered subset, define accuracy\n$$\n\\text{accuracy} = \n\\begin{cases}\n\\frac{\\#\\{i : \\hat{y}_i = y_i \\}}{\\#\\{i : \\hat{y}_i \\ne -1\\}},  \\text{if } \\#\\{i : \\hat{y}_i \\ne -1\\}  0,\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\nFor each class $c \\in \\{0,1\\}$ on the covered subset, define precision $\\text{Prec}_c = \\frac{\\text{TP}_c}{\\text{TP}_c + \\text{FP}_c}$ and recall $\\text{Rec}_c = \\frac{\\text{TP}_c}{\\text{TP}_c + \\text{FN}_c}$ with the conventions that divisions by zero yield a value of $0$. Define the class-wise $F_1$ score by\n$$\nF_{1,c} =\n\\begin{cases}\n\\frac{2 \\,\\text{Prec}_c \\,\\text{Rec}_c}{\\text{Prec}_c + \\text{Rec}_c},  \\text{if } \\text{Prec}_c + \\text{Rec}_c  0,\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\nand the macro $F_1$ score by $F_1^{\\text{macro}} = \\tfrac{1}{2}(F_{1,0} + F_{1,1})$. If coverage is zero, set both accuracy and $F_1^{\\text{macro}}$ to $0$.\n\nAlgorithmic task. Implement:\n1. A generator for synthetic chimera snapshots as specified, with reproducible randomness given a seed.\n2. A computation of the local KOP $R_i$ for all $i$ using neighborhoods of half-width $w$ on the ring.\n3. A segmentation of nodes using thresholds $T_{\\text{coh}}$ and $T_{\\text{incoh}}$.\n4. A validation against ground truth using the coverage, accuracy, and macro $F_1$ metrics defined above, computed only on covered nodes.\n\nTest suite. Your program must evaluate the algorithm on the following parameter sets and return the metrics for each set in order. Angles are in radians, and neighborhoods use periodic indexing.\n- Case 1 (general mixed chimera, happy path): $N=128$, $w=4$ (so $m=9$), $T_{\\text{coh}}=0.92$, $T_{\\text{incoh}}=0.60$, $f=0.50$, $k=0.02$, $\\sigma_c=0.03$, $\\sigma_u=0.20$, seed $=1$.\n- Case 2 (fully coherent domain): $N=128$, $w=4$, $T_{\\text{coh}}=0.95$, $T_{\\text{incoh}}=0.50$, $f=1.00$, $k=0.01$, $\\sigma_c=0.02$, $\\sigma_u=0.20$ (unused but provided), seed $=2$.\n- Case 3 (high noise, likely indeterminacy): $N=128$, $w=6$ (so $m=13$), $T_{\\text{coh}}=0.90$, $T_{\\text{incoh}}=0.70$, $f=0.50$, $k=0.02$, $\\sigma_c=0.30$, $\\sigma_u=0.30$, seed $=3$.\n- Case 4 (single threshold boundary, no indeterminacy): $N=128$, $w=2$ (so $m=5$), $T_{\\text{coh}}=0.80$, $T_{\\text{incoh}}=0.80$, $f=0.30$, $k=0.03$, $\\sigma_c=0.05$, $\\sigma_u=0.40$, seed $=4$.\n\nFinal output format. Your program should produce a single line of output containing the results for the four cases as a comma-separated list enclosed in square brackets, where each case’s result is the list $[\\text{accuracy},\\text{coverage},F_1^{\\text{macro}}]$. For example, the output must have the form\n$$\n\\big[ [a_1,c_1,f_1], [a_2,c_2,f_2], [a_3,c_3,f_3], [a_4,c_4,f_4] \\big],\n$$\nwith each $a_i$, $c_i$, and $f_i$ a real number.",
            "solution": "The problem requires the design and implementation of an algorithm to identify chimera states in a ring network of phase oscillators. This involves generating synthetic data with known ground-truth domains, calculating a local order parameter to classify nodes, and evaluating the classification performance using well-defined metrics. The approach is systematically constructed from foundational principles of network science and statistical analysis.\n\nThe solution proceeds in four stages: (1) generation of synthetic phase data representing a chimera state, (2) computation of the local Kuramoto order parameter for each oscillator, (3) classification of oscillators into coherent, incoherent, or indeterminate states based on this parameter, and (4) validation of the classification against the ground truth using specified performance metrics.\n\n**1. Synthetic Chimera State Generation**\n\nTo validate the classification algorithm, we first construct a synthetic snapshot of oscillator phases with known coherent and incoherent domains. The network consists of $N$ oscillators on a ring, indexed by $i \\in \\{0, 1, \\dots, N-1\\}$.\n\nThe ground-truth structure is defined by a coherent fraction $f \\in [0,1]$. A block of $C = \\lfloor f N \\rfloor$ oscillators, with indices $i \\in \\{0, 1, \\dots, C-1\\}$, forms the coherent domain (ground-truth label $y_i=1$). The remaining $N-C$ oscillators, with indices $i \\in \\{C, \\dots, N-1\\}$, form the incoherent domain (ground-truth label $y_i=0$).\n\nThe phases $\\theta_i \\in [0, 2\\pi)$ are generated as follows, using a reproducible pseudorandom number generator initialized with a given seed:\n\n-   **Coherent Domain ($i \\in \\{0, \\dots, C-1\\}$)**: The phases are designed to be strongly correlated. A single base phase $\\theta_{\\text{base}}$ is drawn from a uniform distribution, $\\theta_{\\text{base}} \\sim \\mathrm{Uniform}(0, 2\\pi)$. The phases of the coherent oscillators are then determined by a linear progression with a phase slope $k \\ge 0$ (in radians per node), plus a small amount of Gaussian noise. The phase for oscillator $i$ is given by:\n    $$\n    \\theta_i = (\\theta_{\\text{base}} + k i + \\eta_i) \\pmod{2\\pi}\n    $$\n    where the noise term $\\eta_i$ is drawn from a normal distribution with mean $0$ and variance $\\sigma_c^2$, i.e., $\\eta_i \\sim \\mathcal{N}(0, \\sigma_c^2)$. The small noise level $\\sigma_c$ ensures that the phases remain close to the deterministic sequence $\\theta_{\\text{base}} + ki$.\n\n-   **Incoherent Domain ($i \\in \\{C, \\dots, N-1\\}$)**: The phases are designed to be uncorrelated. For each oscillator $i$ in this domain, a new, independent phase $\\phi_i$ is drawn from the uniform distribution $\\mathrm{Uniform}(0, 2\\pi)$. An additional Gaussian noise term is also added. The phase for oscillator $i$ is:\n    $$\n    \\theta_i = (\\phi_i + \\xi_i) \\pmod{2\\pi}\n    $$\n    where the noise term $\\xi_i$ is drawn from a normal distribution $\\mathcal{N}(0, \\sigma_u^2)$. The combination of uniformly distributed base phases $\\phi_i$ and noise $\\xi_i$ results in a set of largely uncorrelated phases.\n\nThe modulo $2\\pi$ operation ensures all phases lie within the interval $[0, 2\\pi)$.\n\n**2. Local Coherence Measurement**\n\nTo distinguish between the coherent and incoherent regions spatially, we employ the local Kuramoto order parameter (KOP), $R_i$. This metric quantifies the degree of phase synchronization within a local neighborhood of each oscillator.\n\nThe neighborhood $\\mathcal{N}_i$ for oscillator $i$ is defined as the set of $m = 2w+1$ oscillators centered at $i$, where $w$ is the neighborhood half-width. Due to the ring topology, indices are taken modulo $N$:\n$$\n\\mathcal{N}_i = \\{ (i-w+j) \\pmod N \\mid j=0, 1, \\dots, 2w \\}\n$$\nThe local KOP, $R_i$, is the magnitude of the mean of the phasors $e^{\\mathrm{i}\\theta_j}$ for all oscillators $j$ in the neighborhood $\\mathcal{N}_i$:\n$$\nR_i = \\left| \\frac{1}{m} \\sum_{j \\in \\mathcal{N}_i} e^{\\mathrm{i} \\theta_j} \\right|\n$$\nConceptually, if the phases $\\theta_j$ in the neighborhood are nearly identical, the corresponding unit vectors on the complex plane will point in similar directions, and their average will have a magnitude $R_i$ close to $1$. Conversely, if the phases are uniformly distributed, the vectors will tend to cancel each other out, resulting in an average with magnitude $R_i$ close to $0$.\n\nComputationally, this calculation is performed for each oscillator $i$ by first converting the phase vector $\\boldsymbol{\\theta}$ to a vector of complex phasors $\\mathbf{z} = (e^{\\mathrm{i}\\theta_0}, \\dots, e^{\\mathrm{i}\\theta_{N-1}})$. Then, for each $i$, we sum the phasors corresponding to the indices in $\\mathcal{N}_i$, divide by the neighborhood size $m$, and take the absolute value. The periodic boundary condition is handled by wrapping indices as required.\n\n**3. Threshold-Based Segmentation**\n\nWith the local order parameter $R_i$ computed for every oscillator, we can classify each node. The classification rule uses two thresholds, $T_{\\text{coh}}$ and $T_{\\text{incoh}}$, which must satisfy $1 \\ge T_{\\text{coh}} \\ge T_{\\text{incoh}} \\ge 0$. The predicted label $\\hat{y}_i$ for each node $i$ is assigned as follows:\n\n-   If $R_i \\ge T_{\\text{coh}}$, the node is classified as **coherent** ($\\hat{y}_i = 1$).\n-   If $R_i \\le T_{\\text{incoh}}$, the node is classified as **incoherent** ($\\hat{y}_i = 0$).\n-   If $T_{\\text{incoh}}  R_i  T_{\\text{coh}}$, the node's state is **indeterminate** ($\\hat{y}_i = -1$).\n\nThis rule partitions the network into three sets: a set predicted to be coherent, a set predicted to be incoherent, and a set for which the classification is ambiguous. The gap between $T_{\\text{coh}}$ and $T_{\\text{incoh}}$ creates a buffer zone, reducing misclassifications for nodes with intermediate $R_i$ values, which often occur at the boundary between domains or in regions with high noise.\n\n**4. Quantitative Validation**\n\nThe final step is to evaluate the performance of the classification algorithm. The evaluation is performed only on the subset of nodes that were not classified as indeterminate (i.e., where $\\hat{y}_i \\in \\{0, 1\\}$).\n\nThe following metrics are computed:\n\n-   **Coverage**: The fraction of nodes that receive a definitive classification (coherent or incoherent).\n    $$\n    \\text{coverage} = \\frac{\\#\\{i : \\hat{y}_i \\ne -1\\}}{N}\n    $$\n-   **Accuracy**: Among the covered nodes, the fraction that are correctly classified.\n    $$\n    \\text{accuracy} = \\frac{\\#\\{i : \\hat{y}_i = y_i \\text{ and } \\hat{y}_i \\ne -1\\}}{\\#\\{i : \\hat{y}_i \\ne -1\\}}\n    $$\n    If coverage is $0$, accuracy is defined to be $0$.\n\n-   **Macro $F_1$ Score**: This metric provides a balanced measure of performance across both classes (coherent and incoherent). It is the average of the $F_1$ scores for each class. For each class $c \\in \\{0, 1\\}$, we calculate precision ($\\text{Prec}_c$) and recall ($\\text{Rec}_c$) on the covered subset.\n    -   True Positives ($\\text{TP}_c$): $\\#\\{i : \\hat{y}_i=c \\text{ and } y_i=c\\}$.\n    -   False Positives ($\\text{FP}_c$): $\\#\\{i : \\hat{y}_i=c \\text{ and } y_i \\ne c\\}$.\n    -   False Negatives ($\\text{FN}_c$): $\\#\\{i : \\hat{y}_i \\ne c \\text{ and } y_i=c \\text{ and } \\hat{y}_i \\ne -1\\}$.\n    \n    The precision and recall are then:\n    $$\n    \\text{Prec}_c = \\frac{\\text{TP}_c}{\\text{TP}_c + \\text{FP}_c}, \\quad \\text{Rec}_c = \\frac{\\text{TP}_c}{\\text{TP}_c + \\text{FN}_c}\n    $$\n    with divisions by zero yielding $0$. The $F_1$ score for class $c$ is the harmonic mean of precision and recall:\n    $$\n    F_{1,c} = \\frac{2 \\cdot \\text{Prec}_c \\cdot \\text{Rec}_c}{\\text{Prec}_c + \\text{Rec}_c}\n    $$\n    again with division by zero yielding $0$. Finally, the macro-averaged $F_1$ score is:\n    $$\n    F_1^{\\text{macro}} = \\frac{1}{2}(F_{1,0} + F_{1,1})\n    $$\n    If coverage is $0$, $F_1^{\\text{macro}}$ is also set to $0$.\n\nThese four steps constitute a complete pipeline for generating, analyzing, and validating a chimera state detection algorithm based on local phase coherence.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef generate_chimera_snapshot(N, f, k, sigma_c, sigma_u, seed):\n    \"\"\"\n    Generates a synthetic chimera snapshot with ground truth labels.\n\n    Args:\n        N (int): Number of oscillators.\n        f (float): Fraction of coherent oscillators.\n        k (float): Phase slope for the coherent domain.\n        sigma_c (float): Noise level (std dev) for the coherent domain.\n        sigma_u (float): Noise level (std dev) for the incoherent domain.\n        seed (int): Seed for the random number generator.\n\n    Returns:\n        tuple: A tuple containing:\n            - np.ndarray: The array of phases theta.\n            - np.ndarray: The ground truth labels y (1 for coherent, 0 for incoherent).\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    \n    theta = np.zeros(N)\n    y = np.zeros(N, dtype=int)\n    \n    # Coherent domain\n    C = int(np.floor(f * N))\n    if C > 0:\n        y[:C] = 1\n        base_phase = rng.uniform(0, 2 * np.pi)\n        coherent_indices = np.arange(C)\n        noise_c = rng.normal(0, sigma_c, size=C)\n        theta[:C] = (base_phase + k * coherent_indices + noise_c) % (2 * np.pi)\n        \n    # Incoherent domain\n    if N - C > 0:\n        incoherent_indices = np.arange(C, N)\n        num_incoherent = len(incoherent_indices)\n        phi = rng.uniform(0, 2 * np.pi, size=num_incoherent)\n        noise_u = rng.normal(0, sigma_u, size=num_incoherent)\n        theta[C:] = (phi + noise_u) % (2 * np.pi)\n        \n    return theta, y\n\ndef compute_local_kop(theta, w):\n    \"\"\"\n    Computes the local Kuramoto order parameter for each oscillator.\n\n    Args:\n        theta (np.ndarray): Array of oscillator phases.\n        w (int): Half-width of the neighborhood.\n\n    Returns:\n        np.ndarray: The array of local KOP values R_i.\n    \"\"\"\n    N = len(theta)\n    m = 2 * w + 1\n    R = np.zeros(N)\n    phasors = np.exp(1j * theta)\n    \n    # Pad the phasors array to handle periodic boundary conditions easily\n    padded_phasors = np.pad(phasors, (w, w), mode='wrap')\n    \n    for i in range(N):\n        # The neighborhood of node i in the original array corresponds to\n        # the slice from i to i + 2w in the padded array.\n        neighborhood_sum = np.sum(padded_phasors[i : i + m])\n        R[i] = np.abs(neighborhood_sum / m)\n        \n    return R\n\ndef classify_nodes(R, T_coh, T_incoh):\n    \"\"\"\n    Classifies nodes based on local KOP and thresholds.\n\n    Args:\n        R (np.ndarray): Array of local KOP values.\n        T_coh (float): Coherence threshold.\n        T_incoh (float): Incoherence threshold.\n\n    Returns:\n        np.ndarray: Array of predicted labels (1: coherent, 0: incoherent, -1: indeterminate).\n    \"\"\"\n    y_hat = np.full(R.shape, -1, dtype=int)\n    y_hat[R >= T_coh] = 1\n    y_hat[R = T_incoh] = 0\n    return y_hat\n\ndef calculate_metrics(y, y_hat):\n    \"\"\"\n    Calculates coverage, accuracy, and macro F1 score.\n\n    Args:\n        y (np.ndarray): Ground truth labels.\n        y_hat (np.ndarray): Predicted labels.\n\n    Returns:\n        list: A list containing [accuracy, coverage, f1_macro].\n    \"\"\"\n    N = len(y)\n    covered_mask = y_hat != -1\n    num_covered = np.sum(covered_mask)\n    \n    coverage = num_covered / N\n    \n    if num_covered == 0:\n        return [0.0, 0.0, 0.0]\n        \n    y_covered = y[covered_mask]\n    y_hat_covered = y_hat[covered_mask]\n    \n    accuracy = np.sum(y_covered == y_hat_covered) / num_covered\n    \n    F1_scores = []\n    for c in [0, 1]:  # 0: incoherent, 1: coherent\n        tp = np.sum((y_hat_covered == c)  (y_covered == c))\n        fp = np.sum((y_hat_covered == c)  (y_covered != c))\n        fn = np.sum((y_hat_covered != c)  (y_covered == c))\n        \n        prec_denom = tp + fp\n        rec_denom = tp + fn\n        \n        precision = tp / prec_denom if prec_denom > 0 else 0.0\n        recall = tp / rec_denom if rec_denom > 0 else 0.0\n        \n        f1_denom = precision + recall\n        f1 = (2 * precision * recall / f1_denom) if f1_denom > 0 else 0.0\n        F1_scores.append(f1)\n        \n    f1_macro = np.mean(F1_scores)\n    \n    return [accuracy, coverage, f1_macro]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        {'N': 128, 'w': 4, 'T_coh': 0.92, 'T_incoh': 0.60, 'f': 0.50, 'k': 0.02, 'sigma_c': 0.03, 'sigma_u': 0.20, 'seed': 1},\n        {'N': 128, 'w': 4, 'T_coh': 0.95, 'T_incoh': 0.50, 'f': 1.00, 'k': 0.01, 'sigma_c': 0.02, 'sigma_u': 0.20, 'seed': 2},\n        {'N': 128, 'w': 6, 'T_coh': 0.90, 'T_incoh': 0.70, 'f': 0.50, 'k': 0.02, 'sigma_c': 0.30, 'sigma_u': 0.30, 'seed': 3},\n        {'N': 128, 'w': 2, 'T_coh': 0.80, 'T_incoh': 0.80, 'f': 0.30, 'k': 0.03, 'sigma_c': 0.05, 'sigma_u': 0.40, 'seed': 4},\n    ]\n\n    results = []\n    for params in test_cases:\n        # 1. Generate synthetic data\n        theta, y = generate_chimera_snapshot(\n            params['N'], params['f'], params['k'], params['sigma_c'], params['sigma_u'], params['seed']\n        )\n        \n        # 2. Compute local KOP\n        R = compute_local_kop(theta, params['w'])\n        \n        # 3. Classify nodes\n        y_hat = classify_nodes(R, params['T_coh'], params['T_incoh'])\n        \n        # 4. Validate and calculate metrics\n        metrics = calculate_metrics(y, y_hat)\n        results.append(metrics)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "To gain deeper insight beyond numerical results, we turn to analytical theory, which provides predictive power and a fundamental understanding of system behavior. This advanced practice  delves into the mathematical origins of chimera states by using the powerful Ott-Antonsen (OA) ansatz for a continuum of oscillators. Your task is to perform a bifurcation analysis to derive the critical coupling strength, $K_{c}$, at which a stationary chimera state emerges, connecting abstract theory directly to observable phenomena.",
            "id": "4268042",
            "problem": "Consider a continuum of phase oscillators on a ring parameterized by position $x \\in [0, 2\\pi)$ with nonlocal sinusoidal coupling. Assume a Lorentzian distribution of natural frequencies with center $\\omega_{0}$ and half-width $\\Delta  0$. Under the Ott–Antonsen (OA) reduction, the complex order parameter field $Z(x,t)$ obeys a closed evolution equation driven by the nonlocal mean field $H(x,t)$, which is defined as the spatial convolution of $Z$ with a coupling kernel $G$. Let the coupling kernel be the normalized cosine kernel $G(s) = \\frac{1}{2\\pi} \\left( 1 + A \\cos s \\right)$, with parameter $A \\in \\mathbb{R}$ such that $\\int_{0}^{2\\pi} G(s)\\,\\mathrm{d}s = 1$. Consider the Sakaguchi phase-lag equal to zero, and transform into a co-rotating frame at frequency $\\Omega$ such that $\\omega_{0} - \\Omega = 0$. Seek stationary chimera-like solutions with a time-independent $Z(x)$ that are weakly nonuniform in space. Impose self-consistency between $Z(x)$ and the nonlocal mean field\n$$\nH(x) = \\int_{0}^{2\\pi} G(x - x')\\,Z(x')\\,\\mathrm{d}x',\n$$\nand assume a weakly modulated first-harmonic ansatz\n$$\nZ(x) = c + d \\cos x,\n$$\nwith $c \\in \\mathbb{R}$ and $|d| \\ll |c|$. Starting from the OA-reduced stationarity condition in the co-rotating frame, linearize consistently in the small modulation amplitude $d$ while retaining the nonlinearity in the uniform component $c$. Enforce self-consistency at the level of constant and first-harmonic Fourier components to eliminate $c$ and obtain the onset condition for a nontrivial spatial modulation $d \\neq 0$. Derive a closed-form analytic expression for the critical coupling strength $K_{c}$ at which the stationary spatially modulated solution bifurcates from the uniform stationary solution, expressed in terms of $\\Delta$ and $A$. Your final answer must be a single closed-form expression. No rounding is required.",
            "solution": "The problem requires the derivation of the critical coupling strength $K_{c}$ for the onset of a spatially modulated stationary solution (a chimera state) in a continuum of phase oscillators. The derivation will proceed by analyzing the stationarity condition of the governing Ott-Antonsen (OA) equation under a weakly modulated ansatz.\n\nThe evolution of the complex order parameter field $Z(x,t)$ for a continuum of oscillators with a Lorentzian frequency distribution of half-width $\\Delta$ and center $\\omega_{0}$ coupled nonlocally is described by the Ott-Antonsen equation. As specified, we move to a co-rotating frame with frequency $\\Omega = \\omega_{0}$. In this frame, the OA equation for stationary solutions ($\\frac{\\partial Z}{\\partial t} = 0$) simplifies considerably. The original OA equation is $\\frac{\\partial Z}{\\partial t} = -(\\Delta + i\\omega_{0})Z + \\frac{K}{2}(H - H^{*}Z^{2})$. Transforming to the co-rotating frame via $Z(x,t) = \\mathcal{Z}(x,t) \\exp(-i\\omega_{0}t)$, and seeking stationary solutions $\\mathcal{Z}(x,t) = Z(x)$, we obtain the stationarity condition:\n$$\n\\Delta Z(x) = \\frac{K}{2} \\left( H(x) - H(x)^{*} Z(x)^{2} \\right)\n$$\nwhere $K$ is the coupling strength. The nonlocal mean field $H(x)$ is given by the convolution of $Z(x)$ with the coupling kernel $G(s)$:\n$$\nH(x) = \\int_{0}^{2\\pi} G(x - x') Z(x') \\,\\mathrm{d}x'\n$$\nThe problem provides the coupling kernel $G(s) = \\frac{1}{2\\pi} (1 + A \\cos s)$ and a specific real-valued ansatz for the weakly nonuniform stationary solution:\n$$\nZ(x) = c + d \\cos x\n$$\nwhere $c \\in \\mathbb{R}$ is the amplitude of the uniform component and $|d| \\ll |c|$ is the small amplitude of the spatial modulation. Since $Z(x)$ is real, we have $Z(x)^{*} = Z(x)$. The mean field $H(x)$ will also be real, as $G(s)$ and $Z(x)$ are real. Therefore, $H(x)^{*} = H(x)$. The stationarity condition simplifies to:\n$$\n\\Delta Z(x) = \\frac{K}{2} H(x) \\left( 1 - Z(x)^{2} \\right)\n$$\nFirst, we compute the mean field $H(x)$ by substituting the ansatz for $Z(x')$ and the kernel $G(x-x')$ into the integral definition:\n$$\nH(x) = \\int_{0}^{2\\pi} \\frac{1}{2\\pi} \\left( 1 + A \\cos(x-x') \\right) (c + d \\cos x') \\,\\mathrm{d}x'\n$$\nWe expand $\\cos(x-x') = \\cos x \\cos x' + \\sin x \\sin x'$ and perform the integration term by term. Using the orthogonality relations of trigonometric functions on the interval $[0, 2\\pi)$, such as $\\int_{0}^{2\\pi} \\cos x' \\,\\mathrm{d}x' = 0$, $\\int_{0}^{2\\pi} \\sin x' \\,\\mathrm{d}x' = 0$, and $\\int_{0}^{2\\pi} \\cos^{2} x' \\,\\mathrm{d}x' = \\pi$, we find:\n$$\nH(x) = \\frac{1}{2\\pi} \\left[ c\\int_{0}^{2\\pi} \\mathrm{d}x' + A \\cos x \\int_{0}^{2\\pi} d \\cos^{2} x' \\,\\mathrm{d}x' \\right]\n$$\n$$\nH(x) = \\frac{1}{2\\pi} [c(2\\pi) + A \\cos x (d\\pi)] = c + \\frac{Ad}{2} \\cos x\n$$\nNow, substitute the expressions for $Z(x)$ and $H(x)$ into the simplified stationarity condition:\n$$\n\\Delta (c + d \\cos x) = \\frac{K}{2} \\left(c + \\frac{Ad}{2} \\cos x\\right) \\left( 1 - (c + d \\cos x)^{2} \\right)\n$$\nThe problem requires us to linearize in the small amplitude $d$, while retaining the nonlinearity in $c$. We expand the right-hand side and keep terms up to first order in $d$:\n$$\n1 - (c + d \\cos x)^{2} = 1 - (c^{2} + 2cd \\cos x + d^{2}\\cos^{2} x) \\approx 1 - c^{2} - 2cd \\cos x\n$$\nSubstituting this back into the equation:\n$$\n\\Delta (c + d \\cos x) \\approx \\frac{K}{2} \\left(c + \\frac{Ad}{2} \\cos x\\right) (1 - c^{2} - 2cd \\cos x)\n$$\nExpanding the product on the right-hand side and neglecting terms of order $d^{2}$ and higher:\n$$\n\\Delta c + \\Delta d \\cos x \\approx \\frac{K}{2} \\left[ c(1-c^{2}) - 2c^{2}d \\cos x + \\frac{Ad}{2}(1-c^{2}) \\cos x \\right]\n$$\n$$\n\\Delta c + \\Delta d \\cos x \\approx \\frac{K}{2} c(1-c^{2}) + \\frac{K}{2} d \\left[ \\frac{A}{2}(1-c^{2}) - 2c^{2} \\right] \\cos x\n$$\nFor this equation to hold for all $x \\in [0, 2\\pi)$, the coefficients of the constant term (zeroth Fourier mode) and the $\\cos x$ term (first Fourier mode) must be equal on both sides.\n\nEquating the constant terms ($\\mathcal{O}(d^{0})$):\n$$\n\\Delta c = \\frac{K}{2} c(1-c^{2})\n$$\nThis equation describes the uniform stationary states. It has the trivial solution $c=0$ (incoherent state) and, for $K  2\\Delta$, the nontrivial solution $c \\neq 0$ corresponding to the synchronized state. Since we are looking for a bifurcation from the uniform synchronized state, we consider $c \\neq 0$. Dividing by $c$, we get:\n$$\n\\Delta = \\frac{K}{2} (1-c^{2}) \\quad \\implies \\quad 1-c^{2} = \\frac{2\\Delta}{K}\n$$\nThis also gives $c^{2} = 1 - \\frac{2\\Delta}{K}$.\n\nEquating the coefficients of the $\\cos x$ terms ($\\mathcal{O}(d^{1})$):\n$$\n\\Delta d = \\frac{K}{2} d \\left[ \\frac{A}{2}(1-c^{2}) - 2c^{2} \\right]\n$$\nThe onset of the spatially modulated solution corresponds to the bifurcation point where a solution with a non-zero modulation amplitude, $d \\neq 0$, becomes possible. At this bifurcation point, the coupling strength is the critical value $K_{c}$. For $d \\neq 0$, we can divide by $d$ to get the bifurcation condition:\n$$\n\\Delta = \\frac{K_{c}}{2} \\left[ \\frac{A}{2}(1-c^{2}) - 2c^{2} \\right]\n$$\nWe now have a system of two algebraic equations for $c^{2}$ and $K_{c}$. We use the expression for $1-c^{2}$ and $c^{2}$ from the uniform state equation at the critical point $K=K_{c}$:\n$$\n1-c^{2} = \\frac{2\\Delta}{K_{c}} \\quad \\text{and} \\quad c^{2} = 1 - \\frac{2\\Delta}{K_{c}}\n$$\nSubstituting these into the bifurcation condition:\n$$\n\\Delta = \\frac{K_{c}}{2} \\left[ \\frac{A}{2} \\left( \\frac{2\\Delta}{K_{c}} \\right) - 2 \\left( 1 - \\frac{2\\Delta}{K_{c}} \\right) \\right]\n$$\nNow, we solve this equation for $K_{c}$.\n$$\n\\Delta = \\frac{K_{c}}{2} \\left[ \\frac{A\\Delta}{K_{c}} - 2 + \\frac{4\\Delta}{K_{c}} \\right]\n$$\nDistribute the $\\frac{K_{c}}{2}$ term:\n$$\n\\Delta = \\frac{A\\Delta}{2} - K_{c} + 2\\Delta\n$$\nRearrange the terms to isolate $K_{c}$:\n$$\nK_{c} = \\frac{A\\Delta}{2} + 2\\Delta - \\Delta\n$$\n$$\nK_{c} = \\frac{A\\Delta}{2} + \\Delta = \\Delta \\left( 1 + \\frac{A}{2} \\right)\n$$\nThis gives the final closed-form expression for the critical coupling strength:\n$$\nK_{c} = \\frac{\\Delta (A+2)}{2}\n$$",
            "answer": "$$\\boxed{\\frac{\\Delta(A+2)}{2}}$$"
        }
    ]
}