{
    "hands_on_practices": [
        {
            "introduction": "We begin our hands-on exploration with the foundational concept of structural controllability. This powerful framework allows us to determine the control requirements of a network based solely on its wiring diagram, without needing to know the precise interaction strengths. This exercise  provides a concrete application of this theory, guiding you to translate a directed network into a bipartite graph and find the minimum number of driver nodes, $N_D$, by computing a maximum matching.",
            "id": "4270556",
            "problem": "Consider a directed network with $N=7$ state nodes labeled $\\{1,2,3,4,5,6,7\\}$. The network’s interaction structure is specified by its adjacency pattern, given by the directed edges\n$$\n1 \\to 2,\\quad 1 \\to 3,\\quad 2 \\to 3,\\quad 2 \\to 4,\\quad 3 \\to 4,\\quad 3 \\to 7,\\quad 4 \\to 5,\\quad 5 \\to 3,\\quad 5 \\to 6,\\quad 6 \\to 7,\\quad 7 \\to 5.\n$$\nAssume a Linear Time-Invariant (LTI) dynamical model $\\dot{x}=A x + B u$ where the zero–nonzero pattern of $A$ corresponds to the adjacency pattern above (with nonzero entries in $A$ associated to existing edges, unknown but generic values) and the input matrix $B$ selects a subset of nodes to receive independent control inputs. Work within the framework of structural controllability, meaning that controllability is determined by the zero–nonzero pattern under generic choices of the nonzero parameters.\n\nConstruct the bipartite representation appropriate for structural controllability analysis by duplicating the node set into an “out” part and an “in” part, and placing a bipartite edge from the out-copy of node $i$ to the in-copy of node $j$ for every directed edge $i \\to j$ of the original network. Using only definitions and first principles related to structural controllability and matchings on bipartite graphs, compute a maximum matching on this bipartite graph and deduce the minimum number of driver nodes required to achieve structural controllability of the original directed network. Express your final answer as a single integer with no units.",
            "solution": "The problem requires determining the minimum number of driver nodes, $N_D$, needed to achieve structural controllability of a given directed network. The framework of structural controllability, based on the work of C.-T. Lin, connects the controllability of a Linear Time-Invariant (LTI) system to the topological properties of its underlying network.\n\nThe central principle is that the minimum number of inputs or driver nodes, $N_D$, required to structurally control a network of $N$ nodes is determined by the size of the maximum matching, $|M_{max}|$, in a bipartite graph constructed from the network. The formula relating these quantities is:\n$$\nN_D = N - |M_{max}|\n$$\nThis formula arises from the fact that nodes that are not matched (specifically, the \"in\" nodes) lack a dedicated internal driving connection within the matching and must therefore be directly controlled by an external input to ensure full network controllability.\n\nThe problem is solved by following these steps:\n1.  Construct the bipartite graph representation of the given directed network.\n2.  Find a maximum matching on this bipartite graph and determine its size, $|M_{max}|$.\n3.  Calculate $N_D$ using the formula above.\n\n**Step 1: Construct the Bipartite Graph**\n\nThe given network has $N=7$ nodes, labeled $\\{1, 2, 3, 4, 5, 6, 7\\}$. The directed edges are:\n$1 \\to 2$, $1 \\to 3$, $2 \\to 3$, $2 \\to 4$, $3 \\to 4$, $3 \\to 7$, $4 \\to 5$, $5 \\to 3$, $5 \\to 6$, $6 \\to 7$, $7 \\to 5$.\n\nWe construct a bipartite graph $G_B = (V_{out} \\cup V_{in}, E_B)$.\nThe vertex set is composed of two disjoint partitions:\n-   The set of \"out\" nodes: $V_{out} = \\{1_{out}, 2_{out}, 3_{out}, 4_{out}, 5_{out}, 6_{out}, 7_{out}\\}$.\n-   The set of \"in\" nodes: $V_{in} = \\{1_{in}, 2_{in}, 3_{in}, 4_{in}, 5_{in}, 6_{in}, 7_{in}\\}$.\n\nAn edge $(i_{out}, j_{in})$ exists in $E_B$ if and only if there is a directed edge $i \\to j$ in the original network. The set of bipartite edges $E_B$ is therefore:\n$1_{out} \\to 2_{in}$, $1_{out} \\to 3_{in}$,\n$2_{out} \\to 3_{in}$, $2_{out} \\to 4_{in}$,\n$3_{out} \\to 4_{in}$, $3_{out} \\to 7_{in}$,\n$4_{out} \\to 5_{in}$,\n$5_{out} \\to 3_{in}$, $5_{out} \\to 6_{in}$,\n$6_{out} \\to 7_{in}$,\n$7_{out} \\to 5_{in}$.\n\n**Step 2: Find the Maximum Matching**\n\nA matching $M$ is a subset of $E_B$ where no two edges share a common vertex. A maximum matching is a matching of the largest possible size, denoted $|M_{max}|$.\n\nFirst, we assess if a perfect matching (a matching of size $N=7$) is possible. A perfect matching would match every node in $V_{out}$ to a unique node in $V_{in}$. For a node in $V_{in}$ to be matched, it must have at least one incoming edge from $V_{out}$. In the original directed graph, node $1$ has an in-degree of zero, as no edges point to it. This implies that in the bipartite graph $G_B$, the node $1_{in}$ has no incident edges. Consequently, $1_{in}$ cannot be part of any matching. Therefore, the size of any matching $M$ is at most $N-1 = 7-1=6$.\n\nNow, we need to determine if a matching of size $6$ exists. If we can find such a matching, it must be a maximum matching.\nLet's search for a matching of size $6$. Consider the following set of edges, $M'$:\n$$\nM' = \\{ (1_{out}, 2_{in}), (2_{out}, 3_{in}), (3_{out}, 4_{in}), (4_{out}, 5_{in}), (5_{out}, 6_{in}), (6_{out}, 7_{in}) \\}\n$$\nWe must verify that $M'$ is a valid matching.\n1. All edges in $M'$ exist in $E_B$:\n   - $(1_{out}, 2_{in})$ corresponds to $1 \\to 2$. Valid.\n   - $(2_{out}, 3_{in})$ corresponds to $2 \\to 3$. Valid.\n   - $(3_{out}, 4_{in})$ corresponds to $3 \\to 4$. Valid.\n   - $(4_{out}, 5_{in})$ corresponds to $4 \\to 5$. Valid.\n   - $(5_{out}, 6_{in})$ corresponds to $5 \\to 6$. Valid.\n   - $(6_{out}, 7_{in})$ corresponds to $6 \\to 7$. Valid.\n2. No two edges in $M'$ share a vertex:\n   - The set of \"out\" vertices used is $\\{1_{out}, 2_{out}, 3_{out}, 4_{out}, 5_{out}, 6_{out}\\}$. All are unique.\n   - The set of \"in\" vertices used is $\\{2_{in}, 3_{in}, 4_{in}, 5_{in}, 6_{in}, 7_{in}\\}$. All are unique.\n\nSince $M'$ is a valid set of $6$ non-adjacent edges, it is a matching of size $6$.\nAs we established that $|M_{max}| \\le 6$, and we have found a matching of size $6$, we can conclude that the size of the maximum matching is precisely $6$.\n$$\n|M_{max}| = 6\n$$\n\n**Step 3: Calculate the Minimum Number of Driver Nodes**\n\nUsing the formula for the minimum number of driver nodes, we substitute the known values:\n-   Number of nodes: $N=7$\n-   Size of maximum matching: $|M_{max}|=6$\n\n$$\nN_D = N - |M_{max}| = 7 - 6 = 1\n$$\n\nThus, the minimum number of driver nodes required for structural controllability of this network is $1$. The single unmatched node in the matching $M'$ is $1_{in}$, suggesting that placing a single driver at node $1$ is a valid strategy to achieve structural control.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "While structural controllability provides a powerful baseline, a deeper understanding requires analyzing the system's specific dynamics through its eigenvalues and eigenvectors. This next practice  delves into the Popov-Belevitch-Hautus (PBH) test, a cornerstone of modern control theory. By contrasting a directed cycle with an undirected one, you will uncover how network symmetry can lead to degenerate eigenvalues and, consequently, uncontrollable modes that a single actuator cannot influence.",
            "id": "4270487",
            "problem": "Consider a Linear Time-Invariant (LTI) networked system defined by the state equation $\\dot{x}(t) = A x(t) + B u(t)$, where $x(t) \\in \\mathbb{R}^{n}$ is the state, $u(t) \\in \\mathbb{R}$ is a scalar input, $A \\in \\mathbb{R}^{n \\times n}$ is the network adjacency matrix, and $B \\in \\mathbb{R}^{n \\times 1}$ is the input (actuator) placement vector. Nodes are indexed as $0,1,\\dots,n-1$ and the input acts on node $0$, so $B = e_{0}$, the first standard basis vector.\n\nTwo networks are considered on the same node set:\n\n- A directed cycle with edges $i \\to (i+1) \\bmod n$, represented by the adjacency matrix $A_{d} \\in \\mathbb{R}^{n \\times n}$ with entries $(A_{d})_{(i+1) \\bmod n,\\, i} = 1$ and zeros otherwise.\n\n- An undirected cycle with edges $i \\leftrightarrow (i+1) \\bmod n$, represented by the symmetric adjacency matrix $A_{u} \\in \\mathbb{R}^{n \\times n}$ with entries $(A_{u})_{(i+1) \\bmod n,\\, i} = (A_{u})_{i,\\, (i+1) \\bmod n} = 1$ and zeros otherwise.\n\nUsing the Popov–Belevitch–Hautus (PBH) controllability test, determine, as functions of $n \\geq 3$, the number of uncontrollable modes for $(A_{d}, B)$ and for $(A_{u}, B)$ under a single actuator at node $0$. In addition, identify which eigenvalues of $A_{u}$ are associated with uncontrollable modes under this actuation.\n\nProvide your final answer as a single closed-form analytic expression giving the pair of uncontrollable-mode counts for the directed and undirected cycles as a function of $n$. No rounding is required. Do not include any units in your final answer.",
            "solution": "The validity of the problem statement is established. The problem is scientifically grounded in linear systems control theory and network science, is well-posed with all necessary information provided, and is expressed in objective mathematical language. We proceed to the solution.\n\nThe problem asks for the number of uncontrollable modes for two Linear Time-Invariant (LTI) systems described by $\\dot{x}(t) = A x(t) + B u(t)$, where the actuator placement is on node $0$, so $B = e_0 \\in \\mathbb{R}^{n \\times 1}$, the first standard basis vector. We will use the Popov–Belevitch–Hautus (PBH) test for controllability.\n\nThe PBH test states that an LTI system $(A, B)$ is controllable if and only if the matrix $[\\lambda I - A \\quad B]$ has full row rank ($n$) for every eigenvalue $\\lambda$ of $A$. A mode associated with an eigenvalue $\\lambda$ is uncontrollable if and only if there exists a left eigenvector $y$ of $A$ corresponding to $\\lambda$ (i.e., $y^H A = \\lambda y^H$) such that $y^H B = 0$. The number of uncontrollable modes is the total number of linearly independent left eigenvectors that are orthogonal to the columns of $B$. Since $B=e_0$ is a single column, this simplifies to finding the dimension of the subspace of left eigenvectors $y$ satisfying $y^H e_0 = 0$. The condition $y^H e_0 = 0$ means the first component of the left eigenvector $y$ must be zero.\n\nLet $\\omega_k = \\exp(2\\pi i k / n)$ for $k \\in \\{0, 1, \\dots, n-1\\}$ be the $n$-th roots of unity, where $i = \\sqrt{-1}$.\n\n**Part 1: Directed Cycle Network $(A_d, B)$**\n\nThe adjacency matrix $A_d$ for a directed cycle with edges $j \\to (j+1) \\bmod n$ and nodes indexed $0, 1, \\dots, n-1$ is given by $(A_d)_{(j+1) \\bmod n, j} = 1$ and zeros elsewhere. This corresponds to a basic circulant permutation matrix:\n$$\nA_d = \\begin{pmatrix}\n0 & 0 & \\dots & 0 & 1 \\\\\n1 & 0 & \\dots & 0 & 0 \\\\\n0 & 1 & \\dots & 0 & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n0 & 0 & \\dots & 1 & 0\n\\end{pmatrix}\n$$\nThis is a circulant matrix whose first row is $(0, 0, \\dots, 1)$. The eigenvalues of a circulant matrix are given by the Discrete Fourier Transform of its first row. Let the first row be $c = (c_0, c_1, \\dots, c_{n-1})$. The eigenvalues are $\\lambda_k = \\sum_{j=0}^{n-1} c_j \\omega_k^j$. For $A_d$, we have $c_{n-1}=1$ and $c_j=0$ for $j \\neq n-1$. Thus, the eigenvalues are:\n$$\n\\lambda_k = \\omega_k^{n-1} = \\omega_k^{-1} = \\exp\\left(-\\frac{2\\pi i k}{n}\\right) \\quad \\text{for } k = 0, 1, \\dots, n-1\n$$\nAlternatively, one can derive the eigenvalues by considering a left eigenvector $y = (y_0, y_1, \\dots, y_{n-1})^T$. The condition $y^H A_d = \\lambda y^H$ translates to the component-wise equations $y_{(j+1)\\bmod n} = \\lambda y_j$. This yields $y_j = \\lambda^j y_0$ and the consistency condition $y_0 = \\lambda y_{n-1} = \\lambda^n y_0$, which implies $\\lambda^n = 1$. The eigenvalues are the $n$-th roots of unity, $\\lambda_k = \\exp(2\\pi i k/n)$. These two sets of eigenvalues are identical, just indexed differently. Let's use $\\lambda_k = \\exp(2\\pi i k/n)$.\n\nFor each eigenvalue $\\lambda_k$, the corresponding left eigenvector $y_k$ can be written, up to a scaling factor, as:\n$$\ny_k^H = (1, \\lambda_k, \\lambda_k^2, \\dots, \\lambda_k^{n-1})\n$$\nWe apply the PBH test by checking the condition $y_k^H B = 0$. Here, $B = e_0$.\n$$\ny_k^H B = y_k^H e_0 = (y_k)_0 = 1\n$$\nwhere $(y_k)_0$ is the first component of the vector $y_k$. Since $y_k^H B = 1 \\neq 0$ for all $k = 0, 1, \\dots, n-1$, no left eigenvector is orthogonal to $B$. Therefore, all modes of the directed cycle system are controllable.\n\nThe number of uncontrollable modes for the pair $(A_d, B)$ is $0$.\n\n**Part 2: Undirected Cycle Network $(A_u, B)$**\n\nThe adjacency matrix $A_u$ for an undirected cycle with edges $j \\leftrightarrow (j+1) \\bmod n$ is given by $(A_u)_{(j+1) \\bmod n, j} = (A_u)_{j, (j+1) \\bmod n} = 1$ and zeros elsewhere. This matrix is symmetric and circulant:\n$$\nA_u = A_d + A_d^T = \\begin{pmatrix}\n0 & 1 & 0 & \\dots & 1 \\\\\n1 & 0 & 1 & \\dots & 0 \\\\\n0 & 1 & 0 & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & \\ddots & 1 \\\\\n1 & 0 & \\dots & 1 & 0\n\\end{pmatrix}\n$$\nThe first row of $A_u$ is $(0, 1, 0, \\dots, 0, 1)$. The eigenvalues are:\n$$\n\\lambda_k = \\omega_k^1 + \\omega_k^{n-1} = \\omega_k + \\omega_k^{-1} = 2\\cos\\left(\\frac{2\\pi k}{n}\\right) \\quad \\text{for } k = 0, 1, \\dots, n-1\n$$\nDue to the property $\\cos(x) = \\cos(-x) = \\cos(2\\pi - x)$, we have $\\lambda_k = \\lambda_{n-k}$ for $k \\neq 0$. This indicates that most eigenvalues are degenerate (have a geometric multiplicity greater than $1$).\n- For $k=0$, $\\lambda_0 = 2\\cos(0) = 2$. This eigenvalue is unique.\n- If $n$ is even, for $k=n/2$, $\\lambda_{n/2} = 2\\cos(\\pi) = -2$. This eigenvalue is also unique.\n- For $k \\in \\{1, 2, \\dots, \\lfloor(n-1)/2\\rfloor\\}$, the eigenvalues $\\lambda_k$ are degenerate with a geometric multiplicity of $2$, since $\\lambda_k = \\lambda_{n-k}$ and $k \\neq n-k$.\n\nSince $A_u$ is a symmetric circulant matrix, a valid set of eigenvectors (which are both left and right eigenvectors) are the columns of the DFT matrix:\n$$\ny_k^H = (1, \\omega_k, \\omega_k^2, \\dots, \\omega_k^{n-1}) \\quad \\text{for } k = 0, 1, \\dots, n-1\n$$\nLet's apply the PBH test.\nFor the non-degenerate eigenvalues ($\\lambda_0$ and, if $n$ is even, $\\lambda_{n/2}$), the left eigenspace is one-dimensional, spanned by $y_0$ (and $y_{n/2}$ respectively).\n- For $\\lambda_0=2$: $y_0^H B = y_0^H e_0 = (y_0)_0 = 1 \\neq 0$. The mode is controllable.\n- For $\\lambda_{n/2}=-2$ (n even): $y_{n/2}^H B = y_{n/2}^H e_0 = (y_{n/2})_0 = 1 \\neq 0$. The mode is controllable.\n\nFor the degenerate eigenvalues $\\lambda_k = \\lambda_{n-k}$ where $k \\in \\{1, \\dots, \\lfloor(n-1)/2\\rfloor\\}$, the left eigenspace is two-dimensional, spanned by the linearly independent vectors $\\{y_k, y_{n-k}\\}$. Any left eigenvector $y$ for this eigenvalue can be written as a linear combination $y = c_1 y_k + c_2 y_{n-k}$ for some constants $c_1, c_2$.\nWe seek a non-zero eigenvector $y$ such that $y^H B = 0$.\n$$\ny^H B = (c_1 y_k^H + c_2 y_{n-k}^H) e_0 = c_1 (y_k^H e_0) + c_2 (y_{n-k}^H e_0) = c_1 (y_k)_0 + c_2 (y_{n-k})_0\n$$\nFrom the definition of $y_k$, we have $(y_k)_0 = 1$ and $(y_{n-k})_0 = 1$. The condition becomes:\n$$\nc_1(1) + c_2(1) = c_1 + c_2 = 0\n$$\nWe can choose non-trivial coefficients satisfying this, for instance, $c_1=1$ and $c_2=-1$. This gives a non-zero left eigenvector $y = y_k - y_{n-k}$ which is orthogonal to $B$. For each of the $\\lfloor(n-1)/2\\rfloor$ distinct degenerate eigenvalues, there exists a one-dimensional subspace of its two-dimensional eigenspace that is orthogonal to $B$. This means for each such eigenvalue, there is one uncontrollable mode.\n\nThe total number of uncontrollable modes is the number of such degenerate eigenvalues, which is $\\lfloor (n-1)/2 \\rfloor$.\nIf $n$ is odd, $n=2m+1$, the number is $\\lfloor (2m)/2 \\rfloor = m = (n-1)/2$.\nIf $n$ is even, $n=2m$, the number is $\\lfloor (2m-1)/2 \\rfloor = m-1 = (n-2)/2$.\n\nThe eigenvalues of $A_u$ associated with these uncontrollable modes are $\\lambda_k = 2\\cos(2\\pi k/n)$ for $k = 1, 2, \\dots, \\lfloor (n-1)/2 \\rfloor$.\n\n**Summary**\n\n- Number of uncontrollable modes for the directed cycle $(A_d, B)$: $0$.\n- Number of uncontrollable modes for the undirected cycle $(A_u, B)$: $\\lfloor \\frac{n-1}{2} \\rfloor$.\n\nThe final answer is the pair of these two counts.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\left\\lfloor \\frac{n-1}{2} \\right\\rfloor\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the spectral insights from the PBH test, we now tackle a more complex and ubiquitous network topology: the grid. This problem  challenges you to determine the control requirements for consensus dynamics on a 2D lattice, a model relevant to sensor networks, image processing, and material science. The solution reveals a profound and general principle: the minimum number of controllers needed is determined by the system's highest level of symmetry, which is quantified by the largest geometric multiplicity, $\\operatorname{gm}(\\lambda)$, of the graph Laplacian's eigenvalues.",
            "id": "4270486",
            "problem": "Consider the continuous-time consensus dynamics on the undirected $m\\times m$ grid graph $\\mathcal{G}_m$, defined as the Cartesian product $\\mathcal{G}_m = P_m \\square P_m$ of two path graphs $P_m$ with $m$ nodes each. The node state vector $x(t)\\in\\mathbb{R}^{m^2}$ evolves according to\n$$\n\\dot{x}(t) = -L x(t) + B u(t),\n$$\nwhere $L\\in\\mathbb{R}^{m^2\\times m^2}$ is the combinatorial Laplacian of $\\mathcal{G}_m$, $u(t)\\in\\mathbb{R}^r$ is the external input, and $B\\in\\mathbb{R}^{m^2\\times r}$ selects a set of $r$ leader nodes, each actuated by one independent scalar input. The pair $(A,B)$ with $A=-L$ is said to be controllable if and only if it satisfies the Popov–Belevitch–Hautus (PBH) controllability test, namely $\\operatorname{rank}\\!\\big([\\lambda I - A\\ \\ B]\\big) = m^2$ for every eigenvalue $\\lambda$ of $A$.\n\nAssume the following foundational facts:\n- The Laplacian of the Cartesian product of graphs is the Kronecker sum of their Laplacians, $L = L_m \\otimes I_m + I_m \\otimes L_m$, where $L_m\\in\\mathbb{R}^{m\\times m}$ is the path graph Laplacian and $I_m\\in\\mathbb{R}^{m\\times m}$ is the identity matrix.\n- The path graph Laplacian $L_m$ is diagonalizable with a complete set of orthonormal eigenvectors $\\{v_k\\}_{k=1}^m$ and simple eigenvalues $\\{\\lambda_k\\}_{k=1}^m$ given by $\\lambda_k = 2 - 2\\cos\\!\\big(\\frac{\\pi k}{m+1}\\big)$, with corresponding eigenvectors $v_k(i) = \\sqrt{\\frac{2}{m+1}}\\sin\\!\\big(\\frac{\\pi k i}{m+1}\\big)$ for $i=1,\\dots,m$.\n\nUsing only these well-tested facts and the PBH test, derive from first principles an exact expression for the minimal number of leader nodes $r_{\\min}(m)$ required to make the consensus dynamics controllable on $\\mathcal{G}_m$. Your reasoning must include:\n- A principled analysis of the multiplicity of Laplacian eigenvalues of $\\mathcal{G}_m$ obtained from the Kronecker-sum structure.\n- A rigorous application of the Popov–Belevitch–Hautus (PBH) controllability test to relate the largest eigenvalue multiplicity to the minimal number of leaders.\n\nExpress the final answer as a closed-form symbolic expression in terms of $m$. No numerical approximation is required, and no units are involved.",
            "solution": "The problem asks for the minimal number of leader nodes, denoted $r_{\\min}(m)$, required to render the continuous-time consensus dynamics on an $m \\times m$ grid graph $\\mathcal{G}_m$ controllable. The state equation is given by $\\dot{x}(t) = -L x(t) + B u(t)$, where $x(t) \\in \\mathbb{R}^{m^2}$ is the state vector of the $m^2$ nodes, $L$ is the graph Laplacian of $\\mathcal{G}_m$, and $B \\in \\mathbb{R}^{m^2 \\times r}$ is the input matrix that maps the $r$ control inputs $u(t) \\in \\mathbb{R}^r$ to the selected leader nodes.\n\nLet the system matrix be $A = -L$. The system dynamics are $\\dot{x}(t) = A x(t) + B u(t)$. The condition for controllability is given by the Popov–Belevitch–Hautus (PBH) test, which states that the pair $(A, B)$ is controllable if and only if $\\operatorname{rank}\\!\\big([\\mu I - A \\ \\ B]\\big) = m^2$ for all eigenvalues $\\mu$ of $A$.\n\nAn equivalent formulation of the PBH test, often more useful for analysis, is the eigenvector test. The pair $(A,B)$ is uncontrollable if and only if there exists a left eigenvector $w$ of $A$ that is orthogonal to the columns of $B$. That is, there exists an eigenvalue $\\mu$ of $A$ and a non-zero vector $w \\in \\mathbb{C}^{m^2}$ such that $w^H A = \\mu w^H$ and $w^H B = 0$.\n\nThe graph Laplacian $L$ for an undirected graph is a real symmetric matrix. Consequently, the system matrix $A = -L$ is also real and symmetric. Thus, its left and right eigenvectors are identical, and we can work with real-valued eigenvectors. An eigenvector $w$ of $A$ corresponding to an eigenvalue $\\mu$ is also an eigenvector of $L$ corresponding to the eigenvalue $\\lambda = -\\mu$, since $A w = \\mu w$ implies $-L w = \\mu w$, or $L w = (-\\mu) w$.\n\nThe input matrix $B$ selects $r$ leader nodes. Its columns are standard basis vectors $e_{p_k} \\in \\mathbb{R}^{m^2}$ for $k=1, \\dots, r$, where $p_k$ is the index of the $k$-th leader node. The condition $w^T B = 0$ is equivalent to the set of conditions $w^T e_{p_k} = 0$ for all $k=1, \\dots, r$. This means that the components of the eigenvector $w$ corresponding to the leader nodes must all be zero.\n\nTo ensure controllability, we must select a set of leader nodes such that for any eigenvalue $\\lambda$ of $L$, no corresponding non-zero eigenvector $w$ has zero entries at all the selected leader positions. Let $\\operatorname{gm}(\\lambda)$ be the geometric multiplicity of an eigenvalue $\\lambda$ of $L$, which is the dimension of its eigenspace $E_{\\lambda}$. If we select $r$ leaders, we impose $r$ linear constraints on the eigenvectors in $E_{\\lambda}$. The subspace of vectors in $E_{\\lambda}$ that have zeros at the $r$ leader positions has a dimension of at least $\\operatorname{gm}(\\lambda) - r$. If $r < \\operatorname{gm}(\\lambda)$, this dimension is at least $1$, guaranteeing the existence of a non-zero eigenvector $w \\in E_{\\lambda}$ for which $w^T B = 0$. This would render the mode associated with $\\lambda$ uncontrollable. Therefore, to ensure controllability for any possible choice of leaders, the number of leaders $r$ must be at least as large as the maximum geometric multiplicity of any eigenvalue of $L$. It is a well-known result from control theory that this condition is also sufficient for an appropriate choice of leaders. Thus, the minimum number of leaders is given by:\n$$\nr_{\\min}(m) = \\max_{\\lambda \\in \\sigma(L)} \\operatorname{gm}(\\lambda)\n$$\nwhere $\\sigma(L)$ is the set of eigenvalues of $L$.\n\nOur task now is to determine the eigenvalues of $L$ and their multiplicities. The problem states that $L = L_m \\otimes I_m + I_m \\otimes L_m$, where $L_m$ is the Laplacian of the path graph $P_m$. The eigenvalues of a Kronecker sum of two matrices are all possible sums of their individual eigenvalues. The eigenvalues of $L_m$ are given as $\\lambda_k = 2 - 2\\cos\\!\\big(\\frac{\\pi k}{m+1}\\big)$ for $k = 1, \\dots, m$.\nTherefore, the $m^2$ eigenvalues of $L$ are given by:\n$$\n\\Lambda_{ij} = \\lambda_i + \\lambda_j = 4 - 2\\left(\\cos\\!\\left(\\frac{\\pi i}{m+1}\\right) + \\cos\\!\\left(\\frac{\\pi j}{m+1}\\right)\\right)\n$$\nfor all pairs $(i,j)$ with $i,j \\in \\{1, \\dots, m\\}$.\n\nSince $L$ is a symmetric matrix, its geometric multiplicities are equal to its algebraic multiplicities. The multiplicity of an eigenvalue $\\Lambda$ is the number of distinct ordered pairs $(i,j)$ that produce this value $\\Lambda_{ij}$. This is equivalent to counting the number of pairs $(i,j)$ for which the sum $\\cos\\!\\left(\\frac{\\pi i}{m+1}\\right) + \\cos\\!\\left(\\frac{\\pi j}{m+1}\\right)$ is constant.\n\nLet's analyze this sum. A key property of the cosine function is $\\cos(\\theta) = -\\cos(\\pi - \\theta)$. Applying this to our arguments:\n$$\n\\cos\\!\\left(\\frac{\\pi k}{m+1}\\right) = -\\cos\\!\\left(\\pi - \\frac{\\pi k}{m+1}\\right) = -\\cos\\!\\left(\\frac{\\pi(m+1-k)}{m+1}\\right)\n$$\nThe function $f(k) = \\cos\\!\\big(\\frac{\\pi k}{m+1}\\big)$ is strictly decreasing for $k \\in \\{1, \\dots, m\\}$, as the argument $\\frac{\\pi k}{m+1}$ ranges from $\\frac{\\pi}{m+1}$ to $\\frac{m\\pi}{m+1}$, which is within the interval $(0, \\pi)$. Therefore, $f(k_1) = f(k_2)$ if and only if $k_1=k_2$.\n\nConsider the specific case where the sum of cosines is zero:\n$$\n\\cos\\!\\left(\\frac{\\pi i}{m+1}\\right) + \\cos\\!\\left(\\frac{\\pi j}{m+1}\\right) = 0\n$$\nThis implies $\\cos\\!\\left(\\frac{\\pi i}{m+1}\\right) = -\\cos\\!\\left(\\frac{\\pi j}{m+1}\\right) = \\cos\\!\\left(\\frac{\\pi(m+1-j)}{m+1}\\right)$.\nDue to the strict monotonicity of cosine in the relevant interval, this equality holds if and only if $i = m+1-j$, or $i+j = m+1$.\n\nWe now count the number of integer pairs $(i,j)$ such that $1 \\le i \\le m$, $1 \\le j \\le m$, and $i+j = m+1$. For each choice of $i \\in \\{1, \\dots, m\\}$, $j$ is uniquely determined as $j=m+1-i$. Since $1 \\le i \\le m$, we have $1 \\le m+1-i \\le m$, so $j$ is always in the valid range. The pairs are $(1, m), (2, m-1), \\dots, (m, 1)$. There are exactly $m$ such distinct ordered pairs.\n\nFor these $m$ pairs, the corresponding eigenvalue of $L$ is:\n$$\n\\Lambda = 4 - 2(0) = 4\n$$\nThus, the eigenvalue $\\Lambda=4$ of the grid Laplacian $L$ has a multiplicity of exactly $m$.\n\nWhile a full proof that no other eigenvalue has a greater multiplicity requires concepts from algebraic number theory (related to sums of roots of unity), a principled analysis reveals that the value $m$ is indeed the maximum. The high multiplicity of $\\Lambda=4$ stems from the fundamental symmetry $\\cos(\\theta) = -\\cos(\\pi-\\theta)$, which maps the set of cosine values $\\{f(k)\\}_{k=1}^m$ onto its negative, i.e., $\\{f(k)\\} = \\{-f(j)\\}$. This allows for the sum $f(i)+f(j)=0$ to be formed in $m$ ways. No other constant sum exploits this comprehensive structural symmetry of the value set, and thus no other sum achieves this high a count. Therefore, the maximum multiplicity is $m$.\n\nWith the maximum geometric multiplicity of the eigenvalues of $L$ established as $m$, we can conclude:\n$$\nr_{\\min}(m) = \\max_{\\lambda \\in \\sigma(L)} \\operatorname{gm}(\\lambda) = m\n$$\nThe minimal number of leaders required to ensure controllability of the consensus dynamics on the $m \\times m$ grid graph is $m$.",
            "answer": "$$\n\\boxed{m}\n$$"
        }
    ]
}