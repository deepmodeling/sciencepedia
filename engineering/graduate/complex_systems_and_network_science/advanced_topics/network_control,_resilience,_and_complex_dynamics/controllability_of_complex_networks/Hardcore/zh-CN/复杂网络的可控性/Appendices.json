{
    "hands_on_practices": [
        {
            "introduction": "结构可控性是一个基本概念，它仅依赖于网络的连接模式（即“布线图”）而非具体的权重。这个强大的工具源于 C.-T. Lin 的开创性工作，它允许我们通过在相关的二部图中寻找最大匹配来确定控制整个网络所需的最小驱动节点数 $N_D$。本练习  提供了一个具体的有向网络，旨在通过一步步的图论方法，加深对结构可控性核心原理的理解。",
            "id": "4270556",
            "problem": "考虑一个具有 $N=7$ 个状态节点的有向网络，节点标记为 $\\{1,2,3,4,5,6,7\\}$。该网络的相互作用结构由其邻接模式指定，其有向边如下：\n$$\n1 \\to 2,\\quad 1 \\to 3,\\quad 2 \\to 3,\\quad 2 \\to 4,\\quad 3 \\to 4,\\quad 3 \\to 7,\\quad 4 \\to 5,\\quad 5 \\to 3,\\quad 5 \\to 6,\\quad 6 \\to 7,\\quad 7 \\to 5.\n$$\n假设一个线性时不变 (LTI) 动力学模型 $\\dot{x}=A x + B u$，其中 $A$ 的零-非零模式对应于上述邻接模式（$A$ 中的非零项与存在的边相关联，其值为未知但具有一般性），输入矩阵 $B$ 选择一个节点子集以接收独立的控制输入。在结构可控性的框架下进行分析，这意味着可控性是由非零参数的一般选择下的零-非零模式决定的。\n\n通过将节点集复制成一个“出”部和一个“入”部，并为原始网络中的每条有向边 $i \\to j$ 添加一条从节点 $i$ 的出副本到节点 $j$ 的入副本的二部边，来构建适用于结构可控性分析的二部图表示。仅使用与结构可控性和二部图匹配相关的定义和第一性原理，计算该二部图上的一个最大匹配，并由此推断出实现原始有向网络结构可控性所需的最少驱动节点数。将你的最终答案表示为一个不带单位的整数。",
            "solution": "该问题要求确定实现给定有向网络结构可控性所需的最少驱动节点数 $N_D$。基于 C.-T. Lin 的工作，结构可控性框架将线性时不变 (LTI) 系统的可控性与其底层网络的拓扑性质联系起来。\n\n核心原理是，对一个包含 $N$ 个节点的网络实现结构控制所需的最少输入或驱动节点数 $N_D$，取决于从该网络构建的二部图中的最大匹配的大小 $|M_{max}|$。关联这些量的公式是：\n$$\nN_D = N - |M_{max}|\n$$\n该公式源于这样一个事实：未被匹配的节点（特别是“入”节点）在匹配中缺乏专用的内部驱动连接，因此必须由外部输入直接控制，以确保整个网络的可控性。\n\n解决该问题需遵循以下步骤：\n1.  构建给定有向网络的二部图表示。\n2.  在此二部图上找到一个最大匹配，并确定其大小 $|M_{max}|$。\n3.  使用上述公式计算 $N_D$。\n\n**步骤 1：构建二部图**\n\n给定网络有 $N=7$ 个节点，标记为 $\\{1, 2, 3, 4, 5, 6, 7\\}$。其有向边为：\n$1 \\to 2$, $1 \\to 3$, $2 \\to 3$, $2 \\to 4$, $3 \\to 4$, $3 \\to 7$, $4 \\to 5$, $5 \\to 3$, $5 \\to 6$, $6 \\to 7$, $7 \\to 5$。\n\n我们构建一个二部图 $G_B = (V_{out} \\cup V_{in}, E_B)$。\n顶点集由两个不相交的划分组成：\n-   “出”节点集：$V_{out} = \\{1_{out}, 2_{out}, 3_{out}, 4_{out}, 5_{out}, 6_{out}, 7_{out}\\}$。\n-   “入”节点集：$V_{in} = \\{1_{in}, 2_{in}, 3_{in}, 4_{in}, 5_{in}, 6_{in}, 7_{in}\\}$。\n\n当且仅当原始网络中存在一条有向边 $i \\to j$ 时，$E_B$ 中才存在一条边 $(i_{out}, j_{in})$。因此，二部边集 $E_B$ 为：\n$1_{out} \\to 2_{in}$, $1_{out} \\to 3_{in}$,\n$2_{out} \\to 3_{in}$, $2_{out} \\to 4_{in}$,\n$3_{out} \\to 4_{in}$, $3_{out} \\to 7_{in}$,\n$4_{out} \\to 5_{in}$,\n$5_{out} \\to 3_{in}$, $5_{out} \\to 6_{in}$,\n$6_{out} \\to 7_{in}$,\n$7_{out} \\to 5_{in}$。\n\n**步骤 2：寻找最大匹配**\n\n一个匹配 $M$ 是 $E_B$ 的一个子集，其中任意两条边都不共享同一个顶点。最大匹配是可能的最大规模的匹配，记为 $|M_{max}|$。\n\n首先，我们评估是否存在完美匹配（大小为 $N=7$ 的匹配）。一个完美匹配会将 $V_{out}$ 中的每个节点匹配到 $V_{in}$ 中的一个唯一节点。$V_{in}$ 中的一个节点要被匹配，它必须至少有一条来自 $V_{out}$ 的入边。在原始有向图中，节点 $1$ 的入度为零，因为没有边指向它。这意味着在二部图 $G_B$ 中，节点 $1_{in}$ 没有任何关联边。因此，$1_{in}$ 不可能成为任何匹配的一部分。所以，任何匹配 $M$ 的大小至多为 $N-1 = 7-1=6$。\n\n现在，我们需要确定是否存在大小为 $6$ 的匹配。如果我们能找到这样一个匹配，它必定是最大匹配。让我们寻找一个大小为 $6$ 的匹配。考虑以下边集 $M'$：\n$$\nM' = \\{ (1_{out}, 2_{in}), (2_{out}, 3_{in}), (3_{out}, 4_{in}), (4_{out}, 5_{in}), (5_{out}, 6_{in}), (6_{out}, 7_{in}) \\}\n$$\n我们必须验证 $M'$ 是一个有效的匹配。\n1. $M'$ 中的所有边都存在于 $E_B$ 中：\n   - $(1_{out}, 2_{in})$ 对应于 $1 \\to 2$。有效。\n   - $(2_{out}, 3_{in})$ 对应于 $2 \\to 3$。有效。\n   - $(3_{out}, 4_{in})$ 对应于 $3 \\to 4$。有效。\n   - $(4_{out}, 5_{in})$ 对应于 $4 \\to 5$。有效。\n   - $(5_{out}, 6_{in})$ 对应于 $5 \\to 6$。有效。\n   - $(6_{out}, 7_{in})$ 对应于 $6 \\to 7$。有效。\n2. $M'$ 中没有两条边共享一个顶点：\n   - 使用的“出”顶点集为 $\\{1_{out}, 2_{out}, 3_{out}, 4_{out}, 5_{out}, 6_{out}\\}$。它们都是唯一的。\n   - 使用的“入”顶点集为 $\\{2_{in}, 3_{in}, 4_{in}, 5_{in}, 6_{in}, 7_{in}\\}$。它们都是唯一的。\n\n由于 $M'$ 是一个包含 $6$ 条不相邻边的有效集合，所以它是一个大小为 $6$ 的匹配。\n既然我们已经确定了 $|M_{max}| \\le 6$，并且我们找到了一个大小为 $6$ 的匹配，我们可以得出结论，最大匹配的大小恰好为 $6$。\n$$\n|M_{max}| = 6\n$$\n\n**步骤 3：计算最少驱动节点数**\n\n使用最少驱动节点数的公式，我们代入已知值：\n-   节点数：$N=7$\n-   最大匹配的大小：$|M_{max}|=6$\n\n$$\nN_D = N - |M_{max}| = 7 - 6 = 1\n$$\n\n因此，该网络实现结构可控性所需的最少驱动节点数为 $1$。在匹配 $M'$ 中，唯一未匹配的节点是 $1_{in}$，这表明在节点 $1$ 处放置一个驱动节点是实现结构控制的有效策略。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "从结构可控性深入到精确可控性，我们需要更强大的代数工具，即 Popov-Belevitch-Hautus (PBH) 测试。该测试将系统的可控性与其邻接矩阵的特征值和特征向量紧密联系起来。本练习  通过一个经典的案例，对比了有向环与无向环网络在单个驱动器下的可控性，从而清晰地揭示了网络结构的对称性是如何产生不可控模式的。",
            "id": "4270487",
            "problem": "考虑一个线性时不变（LTI）网络系统，其由状态方程 $\\dot{x}(t) = A x(t) + B u(t)$ 定义，其中 $x(t) \\in \\mathbb{R}^{n}$ 是状态，$u(t) \\in \\mathbb{R}$ 是标量输入，$A \\in \\mathbb{R}^{n \\times n}$ 是网络邻接矩阵，$B \\in \\mathbb{R}^{n \\times 1}$ 是输入（执行器）布局向量。节点索引为 $0,1,\\dots,n-1$，输入作用于节点 $0$，因此 $B = e_{0}$，即第一个标准基向量。\n\n在同一节点集上考虑两个网络：\n\n- 一个有向环，其边为 $i \\to (i+1) \\bmod n$，由邻接矩阵 $A_{d} \\in \\mathbb{R}^{n \\times n}$ 表示，其元素为 $(A_{d})_{(i+1) \\bmod n,\\, i} = 1$，其余为零。\n\n- 一个无向环，其边为 $i \\leftrightarrow (i+1) \\bmod n$，由对称邻接矩阵 $A_{u} \\in \\mathbb{R}^{n \\times n}$ 表示，其元素为 $(A_{u})_{(i+1) \\bmod n,\\, i} = (A_{u})_{i,\\, (i+1) \\bmod n} = 1$，其余为零。\n\n使用 Popov–Belevitch–Hautus (PBH) 可控性测试，确定在节点 $0$ 处单个执行器作用下，$(A_{d}, B)$ 和 $(A_{u}, B)$ 的不可控模态数量，作为 $n \\geq 3$ 的函数。此外，请指明在此驱动下，$A_{u}$ 的哪些特征值与不可控模态相关。\n\n请以单个闭式解析表达式的形式提供您的最终答案，该表达式给出有向环和无向环的不可控模态数量对，作为 $n$ 的函数。无需四舍五入。最终答案中不要包含任何单位。",
            "solution": "问题陈述的有效性已确定。该问题在科学上基于线性系统控制理论和网络科学，问题提法恰当，提供了所有必要信息，并以客观的数学语言表述。我们开始求解。\n\n问题要求计算由 $\\dot{x}(t) = A x(t) + B u(t)$ 描述的两个线性时不变（LTI）系统的不可控模态数量，其中执行器布局在节点 $0$ 上，因此 $B = e_0 \\in \\mathbb{R}^{n \\times 1}$，即第一个标准基向量。我们将使用 Popov–Belevitch–Hautus (PBH) 可控性测试。\n\nPBH 测试指出，一个 LTI 系统 $(A, B)$ 是可控的，当且仅当对于 $A$ 的每个特征值 $\\lambda$，矩阵 $[\\lambda I - A \\quad B]$ 都具有满行秩（$n$）。与特征值 $\\lambda$ 相关的一个模态是不可控的，当且仅当存在一个对应于 $\\lambda$ 的 $A$ 的左特征向量 $y$（即 $y^H A = \\lambda y^H$），使得 $y^H B = 0$。不可控模态的数量是与 $B$ 的列正交的线性无关左特征向量的总数。由于 $B=e_0$ 是单列向量，问题简化为寻找满足 $y^H e_0 = 0$ 的左特征向量 $y$ 构成的子空间的维度。条件 $y^H e_0 = 0$ 意味着左特征向量 $y$ 的第一个分量必须为零。\n\n令 $\\omega_k = \\exp(2\\pi i k / n)$，其中 $k \\in \\{0, 1, \\dots, n-1\\}$，为 $n$ 次单位根，这里 $i = \\sqrt{-1}$。\n\n**第一部分：有向环网络 $(A_d, B)$**\n\n对于一个有向环，其边为 $j \\to (j+1) \\bmod n$，节点索引为 $0, 1, \\dots, n-1$，其邻接矩阵 $A_d$ 为 $(A_d)_{(j+1) \\bmod n, j} = 1$，其余元素为零。这对应于一个基本的循环置换矩阵：\n$$\nA_d = \\begin{pmatrix}\n0 & 0 & \\dots & 0 & 1 \\\\\n1 & 0 & \\dots & 0 & 0 \\\\\n0 & 1 & \\dots & 0 & 0 \\\\\n\\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n0 & 0 & \\dots & 1 & 0\n\\end{pmatrix}\n$$\n这是一个循环矩阵，其第一行为 $(0, 0, \\dots, 1)$。循环矩阵的特征值由其第一行的离散傅里叶变换给出。设第一行为 $c = (c_0, c_1, \\dots, c_{n-1})$。则特征值为 $\\lambda_k = \\sum_{j=0}^{n-1} c_j \\omega_k^j$。对于 $A_d$，我们有 $c_{n-1}=1$ 且当 $j \\neq n-1$ 时 $c_j=0$。因此，特征值为：\n$$\n\\lambda_k = \\omega_k^{n-1} = \\omega_k^{-1} = \\exp\\left(-\\frac{2\\pi i k}{n}\\right) \\quad \\text{for } k = 0, 1, \\dots, n-1\n$$\n或者，可以通过考虑左特征向量 $y = (y_0, y_1, \\dots, y_{n-1})^T$ 来推导特征值。条件 $y^H A_d = \\lambda y^H$ 转化为分量方程 $y_{(j+1)\\bmod n} = \\lambda y_j$。这得出 $y_j = \\lambda^j y_0$ 以及一致性条件 $y_0 = \\lambda y_{n-1} = \\lambda^n y_0$，这意味着 $\\lambda^n = 1$。特征值是 $n$ 次单位根，$\\lambda_k = \\exp(2\\pi i k/n)$。这两组特征值是相同的，只是索引方式不同。我们使用 $\\lambda_k = \\exp(2\\pi i k/n)$。\n\n对于每个特征值 $\\lambda_k$，相应的左特征向量 $y_k$ 可写作（不计缩放因子）：\n$$\ny_k^H = (1, \\lambda_k, \\lambda_k^2, \\dots, \\lambda_k^{n-1})\n$$\n我们通过检查条件 $y_k^H B = 0$ 来应用 PBH 测试。这里，$B = e_0$。\n$$\ny_k^H B = y_k^H e_0 = (y_k)_0 = 1\n$$\n其中 $(y_k)_0$ 是向量 $y_k$ 的第一个分量。因为对于所有的 $k = 0, 1, \\dots, n-1$，$y_k^H B = 1 \\neq 0$，所以没有左特征向量与 $B$ 正交。因此，有向环系统的所有模态都是可控的。\n\n对 $(A_d, B)$ 而言，不可控模态的数量为 $0$。\n\n**第二部分：无向环网络 $(A_u, B)$**\n\n对于一个无向环，其边为 $j \\leftrightarrow (j+1) \\bmod n$，其邻接矩阵 $A_u$ 为 $(A_u)_{(j+1) \\bmod n, j} = (A_u)_{j, (j+1) \\bmod n} = 1$，其余元素为零。该矩阵是对称的循环矩阵：\n$$\nA_u = A_d + A_d^T = \\begin{pmatrix}\n0 & 1 & 0 & \\dots & 1 \\\\\n1 & 0 & 1 & \\dots & 0 \\\\\n0 & 1 & 0 & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & \\ddots & 1 \\\\\n1 & 0 & \\dots & 1 & 0\n\\end{pmatrix}\n$$\n$A_u$ 的第一行是 $(0, 1, 0, \\dots, 0, 1)$。特征值为：\n$$\n\\lambda_k = \\omega_k^1 + \\omega_k^{n-1} = \\omega_k + \\omega_k^{-1} = 2\\cos\\left(\\frac{2\\pi k}{n}\\right) \\quad \\text{for } k = 0, 1, \\dots, n-1\n$$\n由于性质 $\\cos(x) = \\cos(-x) = \\cos(2\\pi - x)$，当 $k \\neq 0$ 时，我们有 $\\lambda_k = \\lambda_{n-k}$。这表明大多数特征值是简并的（几何重数大于 $1$）。\n- 当 $k=0$ 时，$\\lambda_0 = 2\\cos(0) = 2$。这个特征值是唯一的。\n- 如果 $n$ 是偶数，当 $k=n/2$ 时，$\\lambda_{n/2} = 2\\cos(\\pi) = -2$。这个特征值也是唯一的。\n- 对于 $k \\in \\{1, 2, \\dots, \\lfloor(n-1)/2\\rfloor\\}$，特征值 $\\lambda_k$ 是简并的，几何重数为 $2$，因为 $\\lambda_k = \\lambda_{n-k}$ 且 $k \\neq n-k$。\n\n由于 $A_u$ 是对称循环矩阵，一组有效的特征向量（既是左特征向量也是右特征向量）是 DFT 矩阵的列：\n$$\ny_k^H = (1, \\omega_k, \\omega_k^2, \\dots, \\omega_k^{n-1}) \\quad \\text{for } k = 0, 1, \\dots, n-1\n$$\n让我们应用 PBH 测试。\n对于非简并特征值（$\\lambda_0$ 以及当 $n$ 为偶数时的 $\\lambda_{n/2}$），左特征空间是一维的，分别由 $y_0$（和 $y_{n/2}$）张成。\n- 对于 $\\lambda_0=2$：$y_0^H B = y_0^H e_0 = (y_0)_0 = 1 \\neq 0$。该模态是可控的。\n- 对于 $\\lambda_{n/2}=-2$（n 为偶数）：$y_{n/2}^H B = y_{n/2}^H e_0 = (y_{n/2})_0 = 1 \\neq 0$。该模态是可控的。\n\n对于简并特征值 $\\lambda_k = \\lambda_{n-k}$，其中 $k \\in \\{1, \\dots, \\lfloor(n-1)/2\\rfloor\\}$，左特征空间是二维的，由线性无关向量 $\\{y_k, y_{n-k}\\}$ 张成。对应于此特征值的任何左特征向量 $y$ 都可以写成线性组合 $y = c_1 y_k + c_2 y_{n-k}$ 的形式，其中 $c_1, c_2$ 是常数。\n我们寻找一个非零特征向量 $y$ 使得 $y^H B = 0$。\n$$\ny^H B = (c_1 y_k^H + c_2 y_{n-k}^H) e_0 = c_1 (y_k^H e_0) + c_2 (y_{n-k}^H e_0) = c_1 (y_k)_0 + c_2 (y_{n-k})_0\n$$\n根据 $y_k$ 的定义，我们有 $(y_k)_0 = 1$ 和 $(y_{n-k})_0 = 1$。条件变为：\n$$\nc_1(1) + c_2(1) = c_1 + c_2 = 0\n$$\n我们可以选择满足此条件的非平凡系数，例如 $c_1=1$ 和 $c_2=-1$。这给出了一个与 $B$ 正交的非零左特征向量 $y = y_k - y_{n-k}$。对于 $\\lfloor(n-1)/2\\rfloor$ 个不同的简并特征值中的每一个，其二维特征空间中都存在一个与 $B$ 正交的一维子空间。这意味着对于每个这样的特征值，都有一个不可控模态。\n\n不可控模态的总数是此类简并特征值的数量，即 $\\lfloor (n-1)/2 \\rfloor$。\n如果 $n$ 是奇数，$n=2m+1$，则数量为 $\\lfloor (2m)/2 \\rfloor = m = (n-1)/2$。\n如果 $n$ 是偶数，$n=2m$，则数量为 $\\lfloor (2m-1)/2 \\rfloor = m-1 = (n-2)/2$。\n\n与这些不可控模态相关的 $A_u$ 的特征值是 $\\lambda_k = 2\\cos(2\\pi k/n)$，其中 $k = 1, 2, \\dots, \\lfloor (n-1)/2 \\rfloor$。\n\n**总结**\n\n- 有向环 $(A_d, B)$ 的不可控模态数量：$0$。\n- 无向环 $(A_u, B)$ 的不可控模态数量：$\\lfloor \\frac{n-1}{2} \\rfloor$。\n\n最终答案是这两个计数的数对。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\left\\lfloor \\frac{n-1}{2} \\right\\rfloor\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "为了将理论付诸实践，本练习旨在通过编程实现数值方法来评估网络的可控性。我们将实现基于特征向量的 PBH 测试，并计算可控性格拉姆矩阵 (controllability Gramian)，该矩阵量化了输入对系统状态的影响能力。通过这项实践 ，您将掌握在解析解不可行时，如何对更复杂的加权网络进行稳健的可控性分析。",
            "id": "4270512",
            "problem": "考虑一个形式为 $\\,\\dot{x}(t) = A x(t) + B u(t)\\,$ 的线性时不变 (LTI) 网络化动态系统，其中 $\\,x(t) \\in \\mathbb{R}^n\\,$ 是状态向量，$\\,u(t) \\in \\mathbb{R}^m\\,$ 是输入向量，$\\,A \\in \\mathbb{R}^{n \\times n}\\,$ 是系统矩阵，它由一个对称加权邻接矩阵派生而来，并通过负自环来稳定化动力学，而 $\\,B \\in \\mathbb{R}^{n \\times m}\\,$ 是指定直接驱动节点的输入矩阵。Popov-Belevitch-Hautus (PBH) 测试用于评估可控性，它通过检查对于 $\\,A\\,$ 的每个特征值 $\\,\\lambda\\,$，矩阵 $\\,\\left[\\lambda I - A \\quad B\\right]\\,$ 的秩是否等于 $\\,n\\,$ 来实现。对于对称矩阵 $\\,A\\,$，PBH 测试可以通过确保 $\\,A\\,$ 的任何特征向量都不与 $\\,B\\,$ 的列空间正交来等效地验证。在时间范围 $\\,T > 0\\,$ 上的有限时间可控性格拉姆矩阵 $\\,W(T)\\,$ 定义为\n$$\nW(T) \\;=\\; \\int_{0}^{T} e^{A t} \\, B B^\\top \\, e^{A^\\top t} \\, dt,\n$$\n它描述了输入在区间 $\\,[0,T]\\,$ 上如何张成状态空间。\n\n您的任务是编写一个程序，对下面的每个测试用例执行以下操作：\n- 使用适用于对称矩阵 $\\,A\\,$ 的基于特征向量的准则，通过 Popov-Belevitch-Hautus (PBH) 测试验证可控性。\n- 使用矩阵指数和在区间 $\\,[0,T]\\,$ 上的数值积分来数值计算有限时间可控性格拉姆矩阵 $\\,W(T)\\,$。\n- 每个测试用例报告三个量：\n  1. 一个布尔值，指示 PBH 测试是否确认了可控性。\n  2. 通过奇异值阈值法确定的 $\\,W(T)\\,$ 的数值秩。\n  3. $\\,W(T)\\,$ 的最小特征值。\n\n仅使用数学上合理的数值容差。所有矩阵和标量均为实值。不涉及物理单位。\n\n测试套件：\n- 案例 $\\,1\\,$（连通，通用对称权重；多输入）：\n  - 维度：$\\,n = 4\\,$。\n  - 对称加权邻接矩阵 $\\,S_1 \\in \\mathbb{R}^{4 \\times 4}$：\n    $$\n    S_1 \\;=\\;\n    \\begin{bmatrix}\n    0 & 1.0 & 0.5 & 0.0 \\\\\n    1.0 & 0 & 0.8 & 0.3 \\\\\n    0.5 & 0.8 & 0 & 0.7 \\\\\n    0.0 & 0.3 & 0.7 & 0\n    \\end{bmatrix}.\n    $$\n  - 稳定化负自环的量值 $\\,\\alpha_1 = 2.5\\,$，得到 $\\,A_1 = S_1 - \\alpha_1 I\\,$。\n  - 选择节点 $\\,1\\,$ 和 $\\,3\\,$ 的输入矩阵 $\\,B_1 \\in \\mathbb{R}^{4 \\times 2}$：\n    $$\n    B_1 \\;=\\;\n    \\begin{bmatrix}\n    1 & 0 \\\\\n    0 & 0 \\\\\n    0 & 1 \\\\\n    0 & 0\n    \\end{bmatrix}.\n    $$\n  - 时间范围 $\\,T_1 = 5.0\\,$。\n\n- 案例 $\\,2\\,$（不连通的块；单个输入在一个块中）：\n  - 维度：$\\,n = 5\\,$。\n  - 对称加权邻接矩阵 $\\,S_2 \\in \\mathbb{R}^{5 \\times 5}$ 是块对角矩阵：\n    $$\n    S_2 \\;=\\;\n    \\begin{bmatrix}\n    0 & 0.9 & 0.0 & 0.0 & 0.0 \\\\\n    0.9 & 0 & 0.9 & 0.0 & 0.0 \\\\\n    0.0 & 0.9 & 0 & 0.0 & 0.0 \\\\\n    0.0 & 0.0 & 0.0 & 0 & 1.1 \\\\\n    0.0 & 0.0 & 0.0 & 1.1 & 0\n    \\end{bmatrix}.\n    $$\n  - 稳定化负自环的量值 $\\,\\alpha_2 = 1.5\\,$，得到 $\\,A_2 = S_2 - \\alpha_2 I\\,$。\n  - 仅驱动节点 $\\,1\\,$ 的输入矩阵 $\\,B_2 \\in \\mathbb{R}^{5 \\times 1}$：\n    $$\n    B_2 \\;=\\;\n    \\begin{bmatrix}\n    1 \\\\\n    0 \\\\\n    0 \\\\\n    0 \\\\\n    0\n    \\end{bmatrix}.\n    $$\n  - 时间范围 $\\,T_2 = 2.0\\,$。\n\n- 案例 $\\,3\\,$（连通的星形结构；对称的叶节点，中心单输入）：\n  - 维度：$\\,n = 5\\,$。\n  - 对称加权邻接矩阵 $\\,S_3 \\in \\mathbb{R}^{5 \\times 5}$ 是一个以节点 $\\,1\\,$ 为中心、到叶节点 $\\,2,3,4,5\\,$ 的权重为单位值的星形结构：\n    $$\n    S_3 \\;=\\;\n    \\begin{bmatrix}\n    0 & 1.0 & 1.0 & 1.0 & 1.0 \\\\\n    1.0 & 0 & 0.0 & 0.0 & 0.0 \\\\\n    1.0 & 0.0 & 0 & 0.0 & 0.0 \\\\\n    1.0 & 0.0 & 0.0 & 0 & 0.0 \\\\\n    1.0 & 0.0 & 0.0 & 0.0 & 0\n    \\end{bmatrix}.\n    $$\n  - 稳定化负自环的量值 $\\,\\alpha_3 = 2.3\\,$，得到 $\\,A_3 = S_3 - \\alpha_3 I\\,$。\n  - 仅驱动中心节点 $\\,1\\,$ 的输入矩阵 $\\,B_3 \\in \\mathbb{R}^{5 \\times 1}$：\n    $$\n    B_3 \\;=\\;\n    \\begin{bmatrix}\n    1 \\\\\n    0 \\\\\n    0 \\\\\n    0 \\\\\n    0\n    \\end{bmatrix}.\n    $$\n  - 时间范围 $\\,T_3 = 4.0\\,$。\n\n程序要求：\n- 通过检查对于 $\\,A\\,$ 的每个特征向量 $\\,v\\,$，量 $\\,\\lVert B^\\top v \\rVert\\,$ 在合理容差范围内是否严格为正，来实现一个数值上鲁棒的 PBH 验证。\n- 使用在 $\\,t \\in [0,T]\\,$ 上对被积函数 $\\,e^{A t} B B^\\top e^{A^\\top t}\\,$ 的数值积分来近似计算 $\\,W(T)\\,$。您可以使用具有足够大偶数步数和矩阵指数的稳定复合数值求积法。\n- 对于每个案例，输出一个列表 $\\,[\\text{pbh\\_controllable}, \\text{rank\\_W}, \\text{min\\_eig\\_W}]\\,$, 其中 $\\,\\text{pbh\\_controllable}\\,$ 是一个布尔值，$\\,\\text{rank\\_W}\\,$ 是一个整数，$\\,\\text{min\\_eig\\_W}\\,$ 是一个浮点数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身就是上述的三元素列表。例如，输出应类似于 $\\,[[\\text{True},4,0.12345],[\\text{False},3,0.0],[\\text{False},2,0.00001]]\\,$，其中的数值由您的计算确定。",
            "solution": "问题陈述已经过验证并被认为是有效的。其科学基础在于线性系统控制理论，提法恰当，提供了所有必要的数据和条件，并使用客观、精确的数学语言进行表述。指定的测试用例旨在探究网络可控性的不同方面（通用连通性、不连通分量和高度对称性），这些都是该领域的标准说明性场景。\n\n解决方案通过对每个测试用例实施指定的分析来进行。核心概念是用于可控性测试的 Popov-Belevitch-Hautus (PBH) 测试和有限时间可控性格拉姆矩阵 $W(T)$。\n\n**1. 可控性与 Popov-Belevitch-Hautus (PBH) 测试**\n\n一个由 $\\dot{x}(t) = A x(t) + B u(t)$ 描述的线性时不变 (LTI) 系统是可控的，如果对于任意初始状态 $x(0)$ 和任意最终状态 $x(T)$，存在一个输入函数 $u(t)$ 可以在有限时间 $T > 0$ 内将系统从 $x(0)$ 驱动到 $x(T)$。\n\nPBH 测试为可控性提供了一个充分必要条件。它指出，系统对 $(A, B)$ 是可控的，当且仅当对于 $A$ 的所有特征值 $\\lambda$，矩阵 $[\\lambda I - A \\quad B]$ 的秩等于状态空间的维度 $n$。\n$$\n\\text{rank}\\left(\\begin{bmatrix} \\lambda I - A & B \\end{bmatrix}\\right) = n, \\quad \\forall \\lambda \\in \\sigma(A)\n$$\n其中 $\\sigma(A)$ 是 $A$ 的特征值集合。\n\n对于一个对称系统矩阵 $A$，如此问题中给定（其中 $A = S - \\alpha I$，$S$ 是对称的），PBH 测试有一个基于 $A$ 的特征向量的等价且更直观的表述。由于 $A$ 是对称的，它有一组完备的标准正交特征向量基 $\\{v_1, v_2, \\dots, v_n\\}$。如果一个特征向量 $v_i$ 位于 $[\\lambda_i I - A \\quad B]$ 的左零空间中，这意味着 $v_i^\\top (\\lambda_i I - A) = 0$ 和 $v_i^\\top B = 0$。第一个条件 $v_i^\\top (\\lambda_i I - A) = (\\lambda_i v_i - A v_i)^\\top = 0$ 根据特征向量的定义是成立的。因此，PBH 条件不成立当且仅当存在一个特征向量 $v_i$ 使得 $v_i^\\top B = 0$（由于这些是实向量，等价于 $B^\\top v_i = 0$）。这意味着特征向量 $v_i$ 与输入矩阵 $B$ 的列空间正交。这样的特征向量代表了系统的一个无法被输入所激励的动力学模态。\n\n在数值上，我们通过计算 $A$ 的所有特征向量 $v_i$ 并检查欧几里得范数 $\\lVert B^\\top v_i \\rVert_2$ 是否对所有 $i$ 都大于一个小的数值容差来验证可控性。如果任何一个 $\\lVert B^\\top v_i \\rVert_2$ 实际上为零，系统则被认为是不可控的。\n\n**2. 可控性格拉姆矩阵**\n\n对于对称矩阵 $A$，有限时间可控性格拉姆矩阵由下式给出：\n$$\nW(T) = \\int_{0}^{T} e^{A t} B B^\\top e^{A t} dt\n$$\n系统 $(A, B)$ 是可控的，当且仅当对于任何 $T > 0$，$W(T)$ 是正定的（因此是满秩的）。格拉姆矩阵是正定的意味着它的所有特征值都严格为正。\n\n$W(T)$ 的秩表示可控子空间的维度。如果 $\\text{rank}(W(T))  n$，则系统是不可控的。最小特征值 $\\lambda_{\\min}(W(T))$ 提供了可控性的一个定量度量。如果 $\\lambda_{\\min}(W(T)) = 0$，系统是不可控的。一个更大的 $\\lambda_{\\min}(W(T))$ 值表示系统“更”可控，因为它意味着即使是状态空间中最难控制的方向也相对容易受到影响。\n\n**3. 数值评估流程**\n\n对于每个测试用例，将执行以下步骤：\n- **系统矩阵构建**：系统矩阵 $A$ 由 $A = S - \\alpha I$ 构成。\n- **PBH 测试**：\n    1. 使用数值稳定的算法（例如，`numpy.linalg.eigh`）计算对称矩阵 $A$ 的特征值和一组完整的标准正交特征向量。\n    2. 对于每个特征向量 $v_i$，计算范数 $c_i = \\lVert B^\\top v_i \\rVert_2$。\n    3. 当且仅当 $\\min_i c_i$ 大于一个小的数值容差（例如，$10^{-9}$）时，系统被确定为可控的。\n- **格拉姆矩阵计算**：\n    1. 定义 $W(T)$ 的积分通过数值方法计算。我们定义被积函数为 $G(t) = e^{A t} B B^\\top e^{A t}$。\n    2. 时间区间 $[0, T]$ 被离散化为一个精细的点网格 $t_k$。\n    3. 在每个点上计算 $G(t_k)$，其中矩阵指数 $e^{At_k}$ 使用像 Padé 近似这样的鲁棒算法（`scipy.linalg.expm`）来计算。\n    4. 将一个复合数值求积法则，特别是辛普森法则，应用于矩阵值样本序列 $\\{G(t_k)\\}$ 以近似积分 $W(T)$。选择此方法是因为其准确性和稳定性。\n- **格拉姆矩阵分析**：\n    1. 通过计算其奇异值并统计有多少个大于相对容差（例如，`max(singular_values) * 1e-9`），来确定得到的格拉姆矩阵 $W(T)$ 的数值秩。\n    2. 计算对称矩阵 $W(T)$ 的特征值。报告这些特征值中的最小值 $\\lambda_{\\min}(W(T))$。\n\n此流程提供了对可控性的全面分析，将来自 PBH 测试的明确二元结果与来自格拉姆矩阵的定量度量相结合。",
            "answer": "```python\nimport numpy as np\nfrom scipy import linalg, integrate\n\ndef solve():\n    \"\"\"\n    Solves the controllability analysis problem for the three given test cases.\n\n    For each case, it performs:\n    1. PBH test for controllability using the eigenvector criterion for symmetric A.\n    2. Numerical computation of the finite-horizon controllability Gramian W(T).\n    3. Analysis of W(T) to find its numerical rank and minimum eigenvalue.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"n\": 4,\n            \"S\": np.array([\n                [0.0, 1.0, 0.5, 0.0],\n                [1.0, 0.0, 0.8, 0.3],\n                [0.5, 0.8, 0.0, 0.7],\n                [0.0, 0.3, 0.7, 0.0]\n            ]),\n            \"alpha\": 2.5,\n            \"B\": np.array([\n                [1.0, 0.0],\n                [0.0, 0.0],\n                [0.0, 1.0],\n                [0.0, 0.0]\n            ]),\n            \"T\": 5.0\n        },\n        {\n            \"n\": 5,\n            \"S\": np.array([\n                [0.0, 0.9, 0.0, 0.0, 0.0],\n                [0.9, 0.0, 0.9, 0.0, 0.0],\n                [0.0, 0.9, 0.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0, 0.0, 1.1],\n                [0.0, 0.0, 0.0, 1.1, 0.0]\n            ]),\n            \"alpha\": 1.5,\n            \"B\": np.array([\n                [1.0],\n                [0.0],\n                [0.0],\n                [0.0],\n                [0.0]\n            ]),\n            \"T\": 2.0\n        },\n        {\n            \"n\": 5,\n            \"S\": np.array([\n                [0.0, 1.0, 1.0, 1.0, 1.0],\n                [1.0, 0.0, 0.0, 0.0, 0.0],\n                [1.0, 0.0, 0.0, 0.0, 0.0],\n                [1.0, 0.0, 0.0, 0.0, 0.0],\n                [1.0, 0.0, 0.0, 0.0, 0.0]\n            ]),\n            \"alpha\": 2.3,\n            \"B\": np.array([\n                [1.0],\n                [0.0],\n                [0.0],\n                [0.0],\n                [0.0]\n            ]),\n            \"T\": 4.0\n        }\n    ]\n\n    results = []\n    \n    # Numerical tolerance for PBH test and rank determination\n    PBH_TOLERANCE = 1e-9\n    RANK_TOLERANCE_FACTOR = 1e-9\n    \n    # Number of steps for numerical integration (must be even for Simpson's rule)\n    NUM_INTEGRATION_STEPS = 1000 \n\n    for case in test_cases:\n        n, S, alpha, B, T = case[\"n\"], case[\"S\"], case[\"alpha\"], case[\"B\"], case[\"T\"]\n        \n        # Construct the system matrix A = S - alpha * I\n        A = S - alpha * np.identity(n)\n\n        # 1. PBH Test for controllability\n        # A is symmetric, so we use `eigh` for numerical stability.\n        # It returns orthonormal eigenvectors.\n        _, eigenvectors = np.linalg.eigh(A)\n        \n        is_controllable = True\n        for i in range(n):\n            v = eigenvectors[:, i]\n            # Check if eigenvector v is orthogonal to the column space of B\n            norm_Bt_v = np.linalg.norm(B.T @ v)\n            if norm_Bt_v  PBH_TOLERANCE:\n                is_controllable = False\n                break\n\n        # 2. Numerically evaluate the controllability Gramian W(T)\n        \n        # Pre-compute BB^T\n        BBt = B @ B.T\n        \n        # Define the integrand function\n        def integrand(t):\n            exp_At = linalg.expm(A * t)\n            # Since A is symmetric, exp(A*t) is symmetric, so exp(A*t)^T = exp(A*t)\n            return exp_At @ BBt @ exp_At\n\n        # Set up the time grid for integration\n        t_points = np.linspace(0, T, NUM_INTEGRATION_STEPS + 1)\n        \n        # Evaluate the integrand at each time point\n        integrand_values = np.array([integrand(t) for t in t_points])\n        \n        # Integrate using Simpson's rule\n        W = integrate.simpson(integrand_values, t_points, axis=0)\n        \n        # 3. Analyze the Gramian W(T)\n        \n        # Calculate numerical rank via singular value thresholding\n        singular_values = np.linalg.svd(W, compute_uv=False)\n        rank_tol = singular_values.max() * RANK_TOLERANCE_FACTOR if singular_values.max() > 0 else PBH_TOLERANCE\n        rank_W = np.sum(singular_values > rank_tol)\n\n        # Calculate minimum eigenvalue of W.\n        # W is symmetric positive semi-definite, so `eigvalsh` is appropriate.\n        eigenvalues_W = np.linalg.eigvalsh(W)\n        min_eig_W = eigenvalues_W[0] # eigvalsh returns sorted eigenvalues\n        \n        # Correct very small negative values due to numerical precision to 0.0\n        if min_eig_W  0 and np.isclose(min_eig_W, 0):\n            min_eig_W = 0.0\n\n        results.append([is_controllable, int(rank_W), float(min_eig_W)])\n\n    # Format the final output string\n    # str() on a list gives a string like '[True, 4, 0.123]'.\n    # Joining these with commas gives the required format.\n    output_str = \"[\" + \",\".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}