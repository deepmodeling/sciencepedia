## 引言
在复杂系统和网络科学的研究中，网络（或图）是描述从社交互动到生物分子再到信息流等各种系统中实体间相互关系的核心抽象工具。然而，为了利用计算机对这些复杂的拓扑结构进行分析、模拟和预测，我们必须将抽象的图结构转化为精确、规范且可计算的数据格式。这一步，即[网络表示](@entry_id:752440)，是连接理论与实践的桥梁，但不同的表示方法在效率、功能和适用性上存在巨大差异，为特定问题选择最佳表示法是进行有效分析的关键。本文旨在解决如何根据网络特性和分析目标选择和应用最合适的表示法这一核心问题。

本文将系统地引导读者深入理解[网络表示](@entry_id:752440)的世界。在“原理与机制”一章中，我们将从第一性原理出发，详细阐述[邻接矩阵](@entry_id:151010)、[关联矩阵](@entry_id:263683)和[边列表](@entry_id:265772)的定义、数学性质及其在处理不同图类型时的优缺点。接着，在“应用与跨学科连接”一章中，我们将展示这些表示法如何驱动关键[图算法](@entry_id:148535)，影响计算性能，并作为强大的建模工具应用于生物信息学、材料科学和机器学习等前沿领域。最后，通过“动手实践”部分，读者将有机会将理论知识转化为实际的编程技能。通过这三章的学习，您将掌握有效表示和分析[复杂网络](@entry_id:261695)的关键知识。

## 原理与机制

在网络科学中，图（或网络）是描述实体（节点）及其相互关系（边）的抽象数学结构。为了对这些结构进行分析和计算，我们必须将其用精确的、计算机可读的格式来表示。本章将深入探讨网络的三种[基本表示](@entry_id:157678)方法：[邻接矩阵](@entry_id:151010)、[关联矩阵](@entry_id:263683)和[边列表](@entry_id:265772)。我们将从第一性原理出发，阐明它们的定义、数学性质、相互关系以及在不同场景下的优劣权衡。

### 图表示的基础

从形式上看，一个图 $G$ 是一个[有序对](@entry_id:269702) $(V, E)$，其中 $V$ 是一个**节点**（vertices）的[有限集](@entry_id:145527)合，而 $E$ 是一个**边**（edges）的[有限集](@entry_id:145527)合。根据边的性质，图可以分为不同类型：

- **[无向图](@entry_id:270905) (Undirected Graph)**：边是无序的节点对，表示对称关系。例如，一条连接节点 $u$ 和 $v$ 的边表示为 $\{u, v\}$。
- **[有向图](@entry_id:920596) (Directed Graph)**：边是有序的节点对，表示非对称关系。从节点 $u$ 指向节点 $v$ 的边表示为 $(u, v)$，其中 $u$ 是**尾**（tail），$v$ 是**头**（head）。
- **[加权图](@entry_id:274716) (Weighted Graph)**：每条边 $e \in E$ 关联一个数值（权重），通常由权重函数 $w: E \to \mathbb{R}$ 定义。
- **[多重图](@entry_id:261576) (Multigraph)**：允许两个节点之间存在多条**平行边**（parallel edges）。在这种情况下，$E$ 是一个多重集（multiset）。
- **[自环](@entry_id:274670) (Self-loop)**：一条连接节点与其自身的边，例如 $\{u, u\}$ 或 $(u, u)$。**简单图**（simple graph）特指没有平行边和自环的图。

任何一种矩阵或列表表示法，本质上都是对这一抽象结构 $(V, E)$ 的一种编码。这种编码的实现并非唯一，它依赖于我们如何为节点和边进行标记和排序。一个至关重要的前提是，要完整地从一种表示中重建一个带标签的网络，我们必须提供一个从表示内部的索引（例如矩阵的行/列号）到网络中具[体节](@entry_id:187163)点标签（例如“服务器A”、“用户B”）的映射。这通常通过一个[双射函数](@entry_id:266779) $\phi: \{1, \dots, n\} \to V$ 来实现，其中 $n = |V|$ 是节点总数。这个映射常常以一个有序的节点列表形式给出，但它的存在是必不可少的，否则我们只能重建一个同构的图，而无法确定节点的具体身份。

### 邻接矩阵

[邻接矩阵](@entry_id:151010)是最直观和最常用的[网络表示](@entry_id:752440)方法之一。对于一个有 $n$ 个节点的图，其邻接矩阵 $A$ 是一个 $n \times n$ 的方阵。

#### 定义与性质

邻接矩阵的核心思想是用矩阵的元素来记录节点间的连接关系。给定一个将节点 $V$ 映射到索引 $\{1, \dots, n\}$ 的标签函数，矩阵元素 $A_{ij}$ 的定义如下：

- 对于**无权[有向图](@entry_id:920596)**，如果存在从节点 $i$ 到节点 $j$ 的边，则 $A_{ij} = 1$，否则 $A_{ij} = 0$ 。
- 对于**[加权图](@entry_id:274716)**，$A_{ij}$ 通常存储从 $i$ 到 $j$ 的边的权重。如果不存在这样的边，则 $A_{ij} = 0$。
- 对于**[多重图](@entry_id:261576)**，$A_{ij}$ 可以存储从 $i$ 到 $j$ 的平行边的数量（即**[重数](@entry_id:136466)**）。

这种定义方式直接导致了邻接矩阵的结构与图的类型密切相关：

- **简单无向图**：由于边 $\{i, j\}$ 是无序的，存在 $\{i, j\}$ 意味着存在 $\{j, i\}$。这使得邻接矩阵是**对称的**（$A_{ij} = A_{ji}$）。同时，[简单图](@entry_id:274882)没有自环，因此对角[线元](@entry_id:196833)素均为零（$A_{ii} = 0$）。从关系的角度看，[边集](@entry_id:267160) $E$ 对应于节点集 $V$ 上的一个**无反射的对称关系**。

- **简单[有向图](@entry_id:920596)**：边的方[向性](@entry_id:144651)意味着 $A_{ij} = 1$ 并不意味着 $A_{ji} = 1$。因此，邻接矩阵通常是**非对称的**。无[自环](@entry_id:274670)的特性同样使得对角[线元](@entry_id:196833)素为零（$A_{ii} = 0$）。在这种情况下，[边集](@entry_id:267160) $E$ 对应于一个**无反射关系**。

#### 从矩阵中提取节点属性

[邻接矩阵](@entry_id:151010)不仅编码了图的结构，还使得计算基本节点属性变得非常方便。例如，在[有向图](@entry_id:920596)中，一个节点的**出度**（out-degree）和**入度**（in-degree）可以直接通过对矩阵的行和列求和得到。

- **[出度](@entry_id:263181)** $k^{\mathrm{out}}_{i}$ 是从节点 $i$ 出发的边的数量。根据定义，$A_{ij}=1$ 表示存在一条从 $i$到 $j$ 的边。因此，将第 $i$ 行的所有元素相加，即可得到节点 $i$ 的出度：
  $$k^{\mathrm{out}}_{i} = \sum_{j=1}^{n} A_{ij}$$

- **入度** $k^{\mathrm{in}}_{i}$ 是指向节点 $i$ 的边的数量。根据定义，$A_{ji}=1$ 表示存在一条从 $j$到 $i$ 的边。因此，将第 $i$ 列的所有元素相加，即可得到节点 $i$ 的入度：
  $$k^{\mathrm{in}}_{i} = \sum_{j=1}^{n} A_{ji}$$

例如，考虑一个由[边列表](@entry_id:265772) $E=\{1\to 2, 1\to 3, 2\to 3, 2\to 2, 3\to 1\}$ 定义的[有向图](@entry_id:920596)。其[邻接矩阵](@entry_id:151010)为：
$$A = \begin{pmatrix} 0 & 1 & 1 \\ 0 & 1 & 1 \\ 1 & 0 & 0 \end{pmatrix}$$
节点2的出度是第二行的和，$k^{\mathrm{out}}_{2} = 0+1+1=2$。节点3的入度是第三列的和，$k^{\mathrm{in}}_{3} = 1+1+0=2$。值得注意的是，节点2存在一个[自环](@entry_id:274670)（$2 \to 2$），这体现在对角线元素 $A_{22}=1$ 上。自环同时对节点的出度和入度贡献了1。

#### 处理复杂图的扩展

对于更复杂的图，[邻接矩阵](@entry_id:151010)的定义可以相应扩展。对于[多重图](@entry_id:261576)，[矩阵元](@entry_id:186505)素 $A_{ij}$ 存储了从 $i$ 到 $j$ 的边的数量。这种方式虽然简洁，但会丢失信息：如果平行边具有各自独特的属性（如不同的权重或容量），这些信息在求和（或计数）的过程中就会丢失。

自环在邻接矩阵中表现为非零的对角[线元](@entry_id:196833)素 $A_{ii}$ 。例如，在无向图中，一个在节点 $i$ 处的[自环](@entry_id:274670)通常被定义为对该节点的度贡献2。一种常见的约定是，如果节点 $i$ 有 $\ell_i$ 个自环，则 $A_{ii} = 2\ell_i$，这样可以保持度计算公式 $d_i = \sum_{j} A_{ij}$ 的一致性。

### [关联矩阵](@entry_id:263683)

与[邻接矩阵](@entry_id:151010)关注“节点-节点”关系不同，[关联矩阵](@entry_id:263683)关注的是“节点-边”关系。它提供了一种不同的视角来审视[网络结构](@entry_id:265673)。对于一个有 $n$ 个节点和 $m$ 条边的图，其[关联矩阵](@entry_id:263683)是一个 $n \times m$ 的矩阵。

#### 定义与性质

[关联矩阵](@entry_id:263683)主要有两种形式：无符号和有符号。

- **无符号[关联矩阵](@entry_id:263683) (Unsigned Incidence Matrix)** $C$：通常用于无向图。矩阵元素 $C_{ve}$ 定义为：
  $$C_{ve} = \begin{cases} 1 & \text{如果节点 } v \text{ 是边 } e \text{ 的一个端点} \\ 0 & \text{其他情况} \end{cases}$$
  在这种定义下，矩阵的每一列（对应一条边）恰好有两个值为1的元素，分别位于该边两个端点所对应的行。这清晰地揭示了每条边与哪两个节点相关联。

- **有符号[关联矩阵](@entry_id:263683) (Signed Incidence Matrix)** $B$：这是更有力的表示，常用于[有向图](@entry_id:920596)，或为无向图的每条边任意指定一个方向后的情况。矩阵元素 $B_{ve}$ 定义为：
  $$B_{ve} = \begin{cases} +1 & \text{如果节点 } v \text{ 是边 } e \text{ 的头} \\ -1 & \text{如果节点 } v \text{ 是边 } e \text{ 的尾} \\ 0 & \text{其他情况} \end{cases}$$
  每一列（对应一条有向边）因此恰好有一个 $+1$ 和一个 $-1$。这种表示不仅编码了边的端点，还通过符号编码了边的**方向**。仅凭一列，我们就能确定一条边的两个端点以及它的流向。如果我们将边的方向反转，对应的列向量会整体乘以 $-1$，但端点信息保持不变。

#### 特殊情况的处理

[关联矩阵](@entry_id:263683)在处理某些图结构时展现出独特的性质。

- **[多重图](@entry_id:261576)**：如果节点 $i$ 和 $j$ 之间存在两条平行的边 $e_1$ 和 $e_2$，那么在[关联矩阵](@entry_id:263683)中，与 $e_1$ 和 $e_2$ 对应的两列将会是完全相同的（在有符号情况下，取决于它们的方向是否相同，可能相差一个负号）。这意味着，仅从[关联矩阵](@entry_id:263683)本身，我们无法区分这两条平行的边。这是[关联矩阵](@entry_id:263683)的一个局限性。

- **[自环](@entry_id:274670)**：自环在有符号[关联矩阵](@entry_id:263683)中的表现尤为特殊和重要。考虑一个在节点 $i$ 上的[自环](@entry_id:274670) $e$。根据定义，节点 $i$ 既是边 $e$ 的头（贡献+1）也是尾（贡献-1）。因此，在矩阵中，$B_{ie} = (+1) + (-1) = 0$。所有其他行在该列中也为零。这意味着**一个[自环](@entry_id:274670)在有符号[关联矩阵](@entry_id:263683)中对应一个全零的列向量**。这个看似奇怪的特性，在图拉普拉斯算子等高级概念中具有深远的影响。

### [边列表](@entry_id:265772)

[边列表](@entry_id:265772)可能是最简单、最灵活的图表示方法。

#### 定义与灵活性

顾名思义，[边列表](@entry_id:265772)就是一个简单地列出图中所有边的列表。列表中的每一项都描述了一条边，通常是通过其端点的标识符来实现的。

- 对于无向图，列表可能包含如 $\{\{u_1, v_1\}, \{u_2, v_2\}, \dots\}$ 的无序对。
- 对于[有向图](@entry_id:920596)，则是如 $\{(u_1, v_1), (u_2, v_2), \dots\}$ 的[有序对](@entry_id:269702)。
- 对于[加权图](@entry_id:274716)，每一项可以是一个三元组，如 $(u, v, w)$。

[边列表](@entry_id:265772)最大的优点在于其**灵活性**。它天然地支持[多重图](@entry_id:261576)，因为只需在列表中包含重复的边即可。更重要的是，[边列表](@entry_id:265772)的每一项可以被扩展为一个复杂的记录或对象，从而存储任意数量的**逐边属性**（per-edge attributes），例如边的唯一标识符、容量、类型、颜色等。这使得[边列表](@entry_id:265772)成为处理需要丰富边属性的网络（例如在[网络流问题](@entry_id:166966)中，每条平行边都可能有不同的容量）时的理想选择[@problem_id:4291950, @problem_id:4291942]。

#### 完整性问题

[边列表](@entry_id:265772)的一个主要缺点是它本身不存储关于**孤立节点**（即不与任何边相连的节点）的信息。一个只包含边的列表无法完整定义图的节点集 $V$。因此，为了完整地表示一个图，除了[边列表](@entry_id:265772) $E$ 之外，还必须额外存储完整的节点集 $V$ 。

### 表示、[不变性](@entry_id:140168)与同构

一个核心概念是，[邻接矩阵](@entry_id:151010)和[关联矩阵](@entry_id:263683)的最终形式取决于我们为[节点选择](@entry_id:637104)的标签（或顺序）。如果改变节点的标签顺序，矩阵也会随之改变。这种改变不是任意的，而是遵循着精确的数学变换规则。

假设我们有两个不同的节点标签映射 $\ell$ 和 $\ell'$。这相当于对矩阵的行和列进行了一次置换。设这个置换由一个**[置换矩阵](@entry_id:136841)** $P$ 描述。那么，新旧表示之间的关系为：

- **[邻接矩阵](@entry_id:151010)**：$A^{(\ell')} = P^{-1}A^{(\ell)}P$。这是一个**[相似变换](@entry_id:152935)**。由于[置换矩阵](@entry_id:136841)是正交的（$P^{-1} = P^{\top}$），这个关系也常写作 $A^{(\ell')} = P^{\top}A^{(\ell)}P$。
- **[关联矩阵](@entry_id:263683)**：$B^{(\ell')} = P^{-1}B^{(\ell)}$。这表示矩阵的行根据置换 $P$ 进行了重新排列。

这个变换性质引出了一个深刻的结论：那些在[相似变换](@entry_id:152935)下保持不变的矩阵属性，才是图的“内在”属性，它们不依赖于我们如何标记节点。最重要的例子就是邻接矩阵的**特征值多重集**（即图的**谱**）。由于[相似变换](@entry_id:152935)不改变矩阵的特征值，图的谱是一个**[图同构](@entry_id:143072)不变量**。这意味着，如果两个图是同构的（即结构上完全相同，只是节点标签不同），它们的邻接矩阵的谱也必然相同。这为通过谱来研究图结构（即谱图理论）奠定了基础。

### 特殊结构与应用

#### [二分图](@entry_id:262451)

[二分图](@entry_id:262451)是一类其节点可以被划分为两个不相交的集合 $U$ 和 $V$，使得所有边都连接一个 $U$ 中的节点和一个 $V$ 中的节点的图。这种特殊的结构在其[矩阵表示](@entry_id:146025)中留下了清晰的印记。

如果我们按照先 $U$ 后 $V$ 的顺序排列节点，那么图的邻接矩阵 $A$ 会呈现出一种特殊的**块结构**：
$$ A = \begin{pmatrix} 0 & B \\ B^{\top} & 0 \end{pmatrix} $$
这里的 $0$ 是全[零矩阵](@entry_id:155836)。$m \times n$ 的[块矩阵](@entry_id:148435) $B$ 被称为**[双邻接矩阵](@entry_id:1121539)**（biadjacency matrix），它的元素 $B_{ij}$ 表示是否存在一条从 $U$ 中第 $i$ 个节点到 $V$ 中第 $j$ 个节点的边。$A$ 的非零特征值与 $B$ 的奇异值有着直接的对应关系（$\lambda = \pm \sigma$），而 $A$ 的[最大特征值](@entry_id:1127078)等于 $B$ 的最大[奇异值](@entry_id:152907)。对于加权二分图，其[拉普拉斯算子](@entry_id:146319) $L$ 也具有相似的块结构：
$$ L = \begin{pmatrix} D_U & -W \\ -W^{\top} & D_V \end{pmatrix} $$
其中 $W$ 是加权[双邻接矩阵](@entry_id:1121539)，$D_U$ 和 $D_V$ 是由 $W$ 导出的对角度矩阵。

#### [自环](@entry_id:274670)与拉普拉斯算子

自环的存在对不同的图矩阵有着截然不同的影响，这一点在定义[拉普拉斯算子](@entry_id:146319)时尤为关键。考虑两种常见的[拉普拉斯算子](@entry_id:146319)定义：

1.  **组合[拉普拉斯算子](@entry_id:146319)** $L = D - A$：其中 $D$ 是度对角矩阵，$A$ 是邻接矩阵。如前所述，一个在节点 $i$ 上的[自环](@entry_id:274670)会使 $A_{ii}$ 增加，同时也会使[出度](@entry_id:263181) $d_{\mathrm{out}}(i)$ （以及 $D_{ii}$）增加相同的量。在这两个量相减时，[自环](@entry_id:274670)的贡献恰好**相互抵消**。因此，这种方式定义的拉普拉斯算子 $L$ 不受[自环](@entry_id:274670)影响。
2.  **基于[关联矩阵](@entry_id:263683)的拉普拉斯算子** $L_u = \tilde{B}W\tilde{B}^{\top}$：其中 $\tilde{B}$ 是有符号[关联矩阵](@entry_id:263683)，$W$ 是边权重的[对角矩阵](@entry_id:637782)。如前所述，[自环](@entry_id:274670)在 $\tilde{B}$ 中对应一个零列。因此，在构造 $L_u$ 的过程中，自环的贡献项为零，同样不会对最终的 $L_u$ 产生影响。

这意味着，所有基于拉普拉斯算子谱的图属性，如[代数连通度](@entry_id:152762)（用于衡量网络连接的鲁棒性）或谱聚类，都对自环不敏感。然而，这并不意味着[自环](@entry_id:274670)在所有情况下都无足轻重。在**随机游走**模型中，转移[概率矩阵](@entry_id:274812)通常定义为 $P = D_{\mathrm{out}}^{-1}A$。在这种情况下，[自环](@entry_id:274670)会增加对角[线元](@entry_id:196833)素 $P_{ii}$ 的值，即增加了游走者停留在当前节点的“**持有概率**”。这会改变随机游走的动力学行为，例如影响其[平稳分布](@entry_id:194199)和[混合时间](@entry_id:262374)。

### [计算复杂性](@entry_id:204275)权衡

选择哪种表示方法不仅是理论问题，更是一个实际的计算问题。不同的表示在存储开销和执行基本操作的效率上存在显著差异。以计算所有节点的[度序列](@entry_id:267850)这一基本任务为例，我们可以清晰地看到这些差异。

假设图有 $N$ 个节点和 $M$ 条边：

- **邻接矩阵 (Adjacency Matrix)**：要计算节点 $i$ 的度，需要遍历第 $i$ 行的所有 $N$ 个元素。为了计算所有 $N$ 个节点的度，总操作数与矩阵的大小成正比，即 $\Theta(N^2)$。这种方法的计算量与边的数量 $M$ 无关。

- **[关联矩阵](@entry_id:263683) (Incidence Matrix)**：如果[关联矩阵](@entry_id:263683)以稠密数组形式存储，计算节点 $i$ 的度需要遍历第 $i$ 行的所有 $M$ 个元素。对所有 $N$ 个节点执行此操作，总[时间复杂度](@entry_id:145062)为 $\Theta(NM)$。

- **[边列表](@entry_id:265772) (Edge List)**：我们可以初始化一个长度为 $N$ 的全零数组来存储度。然后，遍历[边列表](@entry_id:265772)中的 $M$ 条边。对于每一条边 $\{u, v\}$，我们将对应节点 $u$ 和 $v$ 的度数加一。这个过程总共需要 $\Theta(N)$ 的初始化时间和 $\Theta(M)$ 的遍历时间，总复杂度为 $\Theta(N+M)$。

下表总结了这些差异及其在**[稀疏图](@entry_id:261439)**（$M = \Theta(N)$，常见于现实世界网络）和**[稠密图](@entry_id:634853)**（$M = \Theta(N^2)$）中的表现：

| 表示方法 | 一般复杂度 | [稀疏图](@entry_id:261439) ($M=\Theta(N)$) | [稠密图](@entry_id:634853) ($M=\Theta(N^2)$) |
| :--- | :--- | :--- | :--- |
| 邻接矩阵 | $\Theta(N^2)$ | $\Theta(N^2)$ | $\Theta(N^2)$ |
| [关联矩阵](@entry_id:263683) | $\Theta(NM)$ | $\Theta(N^2)$ | $\Theta(N^3)$ |
| [边列表](@entry_id:265772) | $\Theta(N+M)$| $\Theta(N)$ | $\Theta(N^2)$ |

这个比较清楚地表明，对于大规模稀疏网络，**[边列表](@entry_id:265772)**（以及与其密切相关的**邻接列表**，它为每个节点存储一个其邻居的列表）在存储和计算效率上远优于稠密的[矩阵表示](@entry_id:146025)。而邻接矩阵的优势在于能够以 $O(1)$ 的时间快速判断任意两个节点间是否存在边，这在处理[稠密图](@entry_id:634853)或需要频繁进行此类查询的算法中非常有用。理解这些权衡是为特定问题选择合适数据结构的关键。