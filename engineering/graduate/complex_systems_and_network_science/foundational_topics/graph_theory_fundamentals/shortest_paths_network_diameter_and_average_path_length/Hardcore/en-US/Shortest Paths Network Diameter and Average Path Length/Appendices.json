{
    "hands_on_practices": [
        {
            "introduction": "Mastering fundamental concepts begins with applying them to simple, well-understood systems. This practice grounds you in the core definitions of network distance, diameter ($D$), and average path length ($L(G)$) by having you derive these metrics from first principles for three canonical graph families: the path ($P_n$), the cycle ($C_n$), and the complete graph ($K_n$). By working through these analytical derivations, you will build an intuition for how a network's topology directly determines its global structural properties .",
            "id": "4302457",
            "problem": "Consider three families of undirected, unweighted, simple, connected graphs on $n$ vertices: the path graph $P_n$ $(n \\geq 2)$, the cycle graph $C_n$ $(n \\geq 3)$, and the complete graph $K_n$ $(n \\geq 2)$. For a graph $G$ with vertex set $V$, define the graph-theoretic distance $d_G(u,v)$ between vertices $u$ and $v$ to be the length (number of edges) of a shortest path between $u$ and $v$. The diameter $D(G)$ is defined as $D(G) = \\max\\{ d_G(u,v) : u,v \\in V, u \\neq v \\}$. The average path length $L(G)$ is defined as the average of $d_G(u,v)$ over all unordered pairs of distinct vertices, that is,\n$$\nL(G) = \\frac{2}{n(n-1)} \\sum_{ \\{u,v\\} \\subset V,\\, u \\neq v } d_G(u,v).\n$$\nDefine the exact distance distribution of $G$ to be the sequence $\\{N_k(G)\\}_{k \\geq 1}$ where $N_k(G)$ is the number of unordered vertex pairs at distance exactly $k$. Starting strictly from these definitions and first principles of graph distances, derive the exact distance distributions $\\{N_k(P_n)\\}$, $\\{N_k(C_n)\\}$, and $\\{N_k(K_n)\\}$ as functions of $n$, and from them compute closed-form expressions for the average path lengths $L(P_n)$, $L(C_n)$, and $L(K_n)$, along with the diameters $D(P_n)$, $D(C_n)$, and $D(K_n)$. Express your final answer as a single row matrix in the order\n$$\n\\big(L(P_n),\\, L(C_n),\\, L(K_n),\\, D(P_n),\\, D(C_n),\\, D(K_n)\\big),\n$$\nusing exact symbolic forms. Do not round; provide exact expressions. If a piecewise expression is necessary, present it explicitly within your final answer.",
            "solution": "The problem is valid as it is a well-posed, self-contained, and scientifically grounded problem in standard graph theory. The solution proceeds by analyzing each of the three graph families—path graph ($P_n$), cycle graph ($C_n$), and complete graph ($K_n$)—to determine their respective distance distributions, from which the diameter and average path length are derived.\n\n**1. The Path Graph $P_n$ ($n \\geq 2$)**\nLet the vertices of $P_n$ be labeled $v_0, v_1, \\dots, v_{n-1}$, such that edges exist between $v_i$ and $v_{i+1}$ for $i=0, \\dots, n-2$. The graph is a line. The shortest path between any two vertices $v_i$ and $v_j$ is unique and its length is given by the graph-theoretic distance $d_{P_n}(v_i, v_j) = |i-j|$.\n\nThe distance distribution, $N_k(P_n)$, is the count of unordered pairs $\\{v_i, v_j\\}$ such that $|i-j| = k$. For a fixed distance $k \\in \\{1, 2, \\dots, n-1\\}$, the pairs are of the form $\\{v_i, v_{i+k}\\}$. The index $i$ can range from $0$ to $n-1-k$. Thus, the pairs are $\\{v_0, v_k\\}, \\{v_1, v_{k+1}\\}, \\dots, \\{v_{n-1-k}, v_{n-1}\\}$. The number of such pairs is $(n-1-k) - 0 + 1 = n-k$.\nThe distance distribution is:\n$$\nN_k(P_n) = n-k \\quad \\text{for } k \\in \\{1, 2, \\dots, n-1\\}\n$$\nand $N_k(P_n)=0$ for $k \\geq n$.\n\nThe diameter, $D(P_n)$, is the maximum possible distance, which is the maximum value of $k$ for which $N_k(P_n)  0$. This occurs for $k=n-1$, corresponding to the distance between the endpoints $v_0$ and $v_{n-1}$.\n$$\nD(P_n) = n-1\n$$\nThe average path length, $L(P_n)$, is the sum of all distances, $S_{P_n}$, divided by the total number of pairs, $\\binom{n}{2} = \\frac{n(n-1)}{2}$.\n$$\nS_{P_n} = \\sum_{\\substack{\\{u,v\\} \\subset V \\\\ u \\neq v}} d(u,v) = \\sum_{k=1}^{n-1} k \\cdot N_k(P_n) = \\sum_{k=1}^{n-1} k(n-k)\n$$\nUsing the standard formulas for sums of powers, $\\sum_{i=1}^{m} i = \\frac{m(m+1)}{2}$ and $\\sum_{i=1}^{m} i^2 = \\frac{m(m+1)(2m+1)}{6}$, with $m=n-1$:\n$$\nS_{P_n} = n \\sum_{k=1}^{n-1} k - \\sum_{k=1}^{n-1} k^2 = n \\frac{(n-1)n}{2} - \\frac{(n-1)n(2(n-1)+1)}{6}\n$$\n$$\nS_{P_n} = \\frac{n^2(n-1)}{2} - \\frac{n(n-1)(2n-1)}{6} = \\frac{3n^2(n-1) - n(n-1)(2n-1)}{6}\n$$\n$$\nS_{P_n} = \\frac{n(n-1)}{6} [3n - (2n-1)] = \\frac{n(n-1)(n+1)}{6} = \\frac{n(n^2-1)}{6}\n$$\nThe average path length is then:\n$$\nL(P_n) = \\frac{S_{P_n}}{\\binom{n}{2}} = \\frac{\\frac{n(n^2-1)}{6}}{\\frac{n(n-1)}{2}} = \\frac{n(n-1)(n+1)}{6} \\cdot \\frac{2}{n(n-1)} = \\frac{n+1}{3}\n$$\n\n**2. The Cycle Graph $C_n$ ($n \\geq 3$)**\nLet the vertices of $C_n$ be labeled $v_0, v_1, \\dots, v_{n-1}$ in order around the cycle. An edge exists between $v_i$ and $v_{i+1 \\pmod n}$. The distance between two vertices $v_i$ and $v_j$ is the length of the shorter of the two paths along the cycle:\n$$\nd_{C_n}(v_i, v_j) = \\min(|i-j|, n - |i-j|)\n$$\nThe diameter, $D(C_n)$, is the longest of these shortest paths. By symmetry, we can find the vertex most distant from $v_0$. The distance to $v_k$ is $\\min(k, n-k)$. This function of $k$ is maximized when $k$ is as close to $n-k$ as possible, i.e., $k \\approx \\frac{n}{2}$. The maximum value is $\\lfloor \\frac{n}{2} \\rfloor$.\n$$\nD(C_n) = \\lfloor \\frac{n}{2} \\rfloor\n$$\nThe distance distribution $N_k(C_n)$ depends on the parity of $n$. By symmetry, for a given vertex $v_i$ and a distance $k$ such that $1 \\leq k  \\frac{n}{2}$, there are exactly two vertices at distance $k$. This gives $n$ pairs at distance $k$. If $n$ is even and $k=\\frac{n}{2}$, there is only one antipode for each vertex, giving $\\frac{n}{2}$ pairs.\n\nCase 1: $n$ is odd. Let $n=2m+1$. The maximum distance is $m = \\frac{n-1}{2}$. For any $k \\in \\{1, 2, \\dots, m\\}$, there are $n$ pairs at distance $k$.\n$$\nN_k(C_{2m+1}) = n \\quad \\text{for } k \\in \\{1, \\dots, m\\}\n$$\nThe sum of distances is $S_{C_n} = \\sum_{k=1}^{m} k \\cdot n = n \\frac{m(m+1)}{2}$. Substituting $m=\\frac{n-1}{2}$:\n$$\nS_{C_n} = n \\frac{\\frac{n-1}{2}(\\frac{n-1}{2}+1)}{2} = n \\frac{(\\frac{n-1}{2})(\\frac{n+1}{2})}{2} = \\frac{n(n^2-1)}{8}\n$$\nThe average path length for odd $n$ is:\n$$\nL(C_n) = \\frac{S_{C_n}}{\\binom{n}{2}} = \\frac{\\frac{n(n^2-1)}{8}}{\\frac{n(n-1)}{2}} = \\frac{n(n-1)(n+1)}{8} \\cdot \\frac{2}{n(n-1)} = \\frac{n+1}{4}\n$$\nCase 2: $n$ is even. Let $n=2m$. The maximum distance is $m=\\frac{n}{2}$. For $k \\in \\{1, ..., m-1\\}$, $N_k(C_{2m}) = n$. For $k=m$, $N_m(C_{2m}) = \\frac{n}{2}$. The sum of distances is:\n$$\nS_{C_n} = \\left(\\sum_{k=1}^{m-1} k \\cdot n\\right) + m \\cdot \\frac{n}{2} = n \\frac{(m-1)m}{2} + \\frac{nm}{2} = \\frac{nm}{2} ((m-1)+1) = \\frac{nm^2}{2}\n$$\nSubstituting $m=\\frac{n}{2}$:\n$$\nS_{C_n} = \\frac{n(\\frac{n}{2})^2}{2} = \\frac{n(\\frac{n^2}{4})}{2} = \\frac{n^3}{8}\n$$\nThe average path length for even $n$ is:\n$$\nL(C_n) = \\frac{S_{C_n}}{\\binom{n}{2}} = \\frac{\\frac{n^3}{8}}{\\frac{n(n-1)}{2}} = \\frac{n^3}{8} \\cdot \\frac{2}{n(n-1)} = \\frac{n^2}{4(n-1)}\n$$\n\n**3. The Complete Graph $K_n$ ($n \\geq 2$)**\nIn the complete graph $K_n$, every distinct pair of vertices $\\{u,v\\}$ is connected by an edge. Therefore, the shortest path has length $1$ for all distinct pairs.\n$$\nd_{K_n}(u,v) = 1 \\quad \\text{for all } u \\neq v\n$$\nThe distance distribution consists of only one non-zero term. The number of pairs at distance $k=1$ is the total number of pairs of vertices:\n$$\nN_1(K_n) = \\binom{n}{2} = \\frac{n(n-1)}{2}, \\text{ and } N_k(K_n) = 0 \\text{ for } k  1\n$$\nThe diameter, $D(K_n)$, is the maximum distance, which is $1$.\n$$\nD(K_n) = 1\n$$\nThe average path length, $L(K_n)$, is also $1$, as every pair is at distance $1$:\n$$\nL(K_n) = \\frac{\\sum d(u,v)}{\\binom{n}{2}} = \\frac{1 \\cdot N_1(K_n)}{\\binom{n}{2}} = \\frac{\\binom{n}{2}}{\\binom{n}{2}} = 1\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{n+1}{3}  \\begin{cases} \\frac{n+1}{4}  n \\text{ is odd} \\\\ \\frac{n^2}{4(n-1)}  n \\text{ is even} \\end{cases}  1  n-1  \\lfloor \\frac{n}{2} \\rfloor  1 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "In most real-world networks, connections are not uniform; they have associated costs, times, or capacities represented by edge weights. This exercise introduces this crucial layer of complexity, challenging you to compare hop-based distances ($d_h$) with weighted shortest path distances ($d_w$) on a small network. You will discover firsthand how a path with few edges can be an \"expensive\" detour, a fundamental insight for accurately modeling realistic systems where the cheapest or fastest route is not always the most direct one .",
            "id": "4302468",
            "problem": "Consider an undirected, positively weighted network with node set $V=\\{1,2,3,4,5,6\\}$. Edges are symmetric and have the following weights $w_{ij}=w_{ji}$ for each listed unordered pair $\\{i,j\\}$:\n- $\\{1,2\\}$ with $w_{12}=9$,\n- $\\{2,3\\}$ with $w_{23}=1$,\n- $\\{3,4\\}$ with $w_{34}=1$,\n- $\\{4,5\\}$ with $w_{45}=1$,\n- $\\{5,6\\}$ with $w_{56}=1$,\n- $\\{6,1\\}$ with $w_{16}=2$,\n- $\\{1,3\\}$ with $w_{13}=3$,\n- $\\{2,5\\}$ with $w_{25}=2$,\n- $\\{3,6\\}$ with $w_{36}=8$,\n- $\\{2,4\\}$ with $w_{24}=10$.\nAny unordered pair $\\{i,j\\}$ not listed has no edge.\n\nUse only the foundational definitions stated here:\n- A path between nodes $i$ and $j$ is any sequence of nodes $(i=v_{0},v_{1},\\dots,v_{k}=j)$ such that each consecutive unordered pair $\\{v_{\\ell},v_{\\ell+1}\\}$ is an edge. Its weighted length is the sum $\\sum_{\\ell=0}^{k-1} w_{v_{\\ell} v_{\\ell+1}}$.\n- The weighted shortest-path distance $d_{w}(i,j)$ is the minimum weighted length over all paths between $i$ and $j$.\n- The hop-based (unweighted) shortest-path distance $d_{h}(i,j)$ is the minimum number of edges $k$ over all paths between $i$ and $j$, ignoring weights.\n- For an undirected network on $n$ nodes, the average shortest-path length is the mean of $d(i,j)$ over all unordered pairs with $ij$, namely $L=\\frac{2}{n(n-1)}\\sum_{ij} d(i,j)$, where $d$ denotes either $d_{w}$ or $d_{h}$ accordingly.\n\nTasks:\n1. Compute $d_{w}(i,j)$ for all unordered pairs $ij$ using the definition of weighted path length.\n2. Compute $d_{h}(i,j)$ for all unordered pairs $ij$ by counting hops on the underlying unweighted graph.\n3. From these, compute the weighted average shortest-path length $L_{w}$ and the hop-based average shortest-path length $L_{h}$.\n4. Report the ratio $R=L_{w}/L_{h}$ as a simplified exact fraction.\n\nIn your reasoning, explicitly identify at least one unordered pair for which the weighted shortest path uses more hops than the hop-based shortest path because of heavy direct edges (a detour), and at least one unordered pair where a one-hop connection (a hop-based shortcut) is not chosen by the weighted metric in favor of a multi-hop lighter path. Express your final answer as a simplified fraction. Do not round.",
            "solution": "The problem is well-defined, scientifically grounded, and provides all necessary information to proceed with a solution. The graph is specified by its node set $V=\\{1,2,3,4,5,6\\}$, its edge set, and the corresponding positive weights. The tasks are to compute hop-based and weighted shortest-path distances, the respective average path lengths, and the ratio of these averages, along with illustrating specific path-finding phenomena.\n\nThe number of nodes is $n=6$. The number of unordered pairs of distinct nodes is $\\binom{n}{2} = \\binom{6}{2} = \\frac{6 \\times 5}{2} = 15$. The average shortest-path length $L$ is calculated as $L=\\frac{1}{15}\\sum_{ij} d(i,j)$. The problem statement has a factor of $2$ in the numerator and $n(n-1)$ in the denominator, which is equivalent: $L = \\frac{2}{n(n-1)}\\sum_{ij} d(i,j) = \\frac{2}{6 \\times 5}\\sum_{ij} d(i,j) = \\frac{1}{15}\\sum_{ij} d(i,j)$.\n\nFirst, we compute the hop-based shortest-path distances $d_h(i,j)$ for all $15$ unordered pairs $\\{i,j\\}$. This is equivalent to finding the shortest path on the unweighted version of the graph, where each edge has a length of $1$. This can be done by inspection or by running a Breadth-First Search (BFS) starting from each node.\n\nThe hop-based distances $d_h(i,j)$ for $ij$ are:\n- For paths from node $1$: $d_h(1,2)=1$, $d_h(1,3)=1$, $d_h(1,6)=1$. Paths to nodes $4$ and $5$ require $2$ hops, e.g., $1 \\to 3 \\to 4$ and $1 \\to 6 \\to 5$. So, $d_h(1,4)=2$, $d_h(1,5)=2$.\n- For paths from node $2$: $d_h(2,3)=1$, $d_h(2,4)=1$, $d_h(2,5)=1$. The shortest path to node $6$ requires $2$ hops, e.g., $2 \\to 5 \\to 6$. So, $d_h(2,6)=2$.\n- For paths from node $3$: $d_h(3,4)=1$, $d_h(3,6)=1$. The shortest path to node $5$ requires $2$ hops, e.g., $3 \\to 4 \\to 5$. So, $d_h(3,5)=2$.\n- For paths from node $4$: $d_h(4,5)=1$. The shortest path to node $6$ requires $2$ hops, e.g., $4 \\to 5 \\to 6$. So, $d_h(4,6)=2$.\n- For paths from node $5$: $d_h(5,6)=1$.\n\nSummary of $d_h(i,j)$ for $ij$:\n$d_h(1,2)=1, d_h(1,3)=1, d_h(1,4)=2, d_h(1,5)=2, d_h(1,6)=1$\n$d_h(2,3)=1, d_h(2,4)=1, d_h(2,5)=1, d_h(2,6)=2$\n$d_h(3,4)=1, d_h(3,5)=2, d_h(3,6)=1$\n$d_h(4,5)=1, d_h(4,6)=2$\n$d_h(5,6)=1$\n\nThe sum of these distances is:\n$$ \\sum_{ij} d_h(i,j) = (1+1+2+2+1) + (1+1+1+2) + (1+2+1) + (1+2) + 1 = 7+5+4+3+1 = 20 $$\nThe hop-based average shortest-path length $L_h$ is:\n$$ L_h = \\frac{2}{6(5)} \\sum_{ij} d_h(i,j) = \\frac{1}{15}(20) = \\frac{4}{3} $$\n\nNext, we compute the weighted shortest-path distances $d_w(i,j)$. Since the graph is small and all weights are positive, we can find these by careful inspection of paths or by applying Dijkstra's algorithm from each node.\n\nThe weighted shortest-path distances $d_w(i,j)$ for $ij$ are:\n- $d_w(1,2)$: path $1 \\to 3 \\to 2$ has weight $w_{13}+w_{23}=3+1=4$. The direct edge has weight $w_{12}=9$. Thus, $d_w(1,2)=4$.\n- $d_w(1,3)$: direct edge weight is $w_{13}=3$. This is the shortest path. $d_w(1,3)=3$.\n- $d_w(1,4)$: path $1 \\to 3 \\to 4$ has weight $3+1=4$. Path $1 \\to 6 \\to 5 \\to 4$ has weight $2+1+1=4$. $d_w(1,4)=4$.\n- $d_w(1,5)$: path $1 \\to 6 \\to 5$ has weight $2+1=3$. $d_w(1,5)=3$.\n- $d_w(1,6)$: direct edge weight is $w_{16}=2$. This is the shortest path. $d_w(1,6)=2$.\n- $d_w(2,3)$: direct edge weight is $w_{23}=1$. This is the shortest path. $d_w(2,3)=1$.\n- $d_w(2,4)$: path $2 \\to 3 \\to 4$ has weight $1+1=2$. The direct edge has weight $w_{24}=10$. Thus, $d_w(2,4)=2$.\n- $d_w(2,5)$: direct edge weight is $w_{25}=2$. This is the shortest path. $d_w(2,5)=2$.\n- $d_w(2,6)$: path $2 \\to 5 \\to 6$ has weight $2+1=3$. $d_w(2,6)=3$.\n- $d_w(3,4)$: direct edge weight is $w_{34}=1$. This is the shortest path. $d_w(3,4)=1$.\n- $d_w(3,5)$: path $3 \\to 4 \\to 5$ has weight $1+1=2$. $d_w(3,5)=2$.\n- $d_w(3,6)$: path $3 \\to 4 \\to 5 \\to 6$ has weight $1+1+1=3$. The direct edge has weight $w_{36}=8$. Thus, $d_w(3,6)=3$.\n- $d_w(4,5)$: direct edge weight is $w_{45}=1$. This is the shortest path. $d_w(4,5)=1$.\n- $d_w(4,6)$: path $4 \\to 5 \\to 6$ has weight $1+1=2$. $d_w(4,6)=2$.\n- $d_w(5,6)$: direct edge weight is $w_{56}=1$. This is the shortest path. $d_w(5,6)=1$.\n\nSummary of $d_w(i,j)$ for $ij$:\n$d_w(1,2)=4, d_w(1,3)=3, d_w(1,4)=4, d_w(1,5)=3, d_w(1,6)=2$\n$d_w(2,3)=1, d_w(2,4)=2, d_w(2,5)=2, d_w(2,6)=3$\n$d_w(3,4)=1, d_w(3,5)=2, d_w(3,6)=3$\n$d_w(4,5)=1, d_w(4,6)=2$\n$d_w(5,6)=1$\n\nThe sum of these distances is:\n$$ \\sum_{ij} d_w(i,j) = (4+3+4+3+2) + (1+2+2+3) + (1+2+3) + (1+2) + 1 = 16+8+6+3+1 = 34 $$\nThe weighted average shortest-path length $L_w$ is:\n$$ L_w = \\frac{2}{6(5)} \\sum_{ij} d_w(i,j) = \\frac{1}{15}(34) = \\frac{34}{15} $$\n\nAs required, we identify two specific instances of divergence between hop-based and weighted paths.\n1. An unordered pair for which the weighted shortest path uses more hops than the hop-based shortest path:\nConsider the pair $\\{1,4\\}$. The hop-based shortest path length is $d_h(1,4)=2$, achieved by paths such as $1 \\to 3 \\to 4$. The weighted shortest path length is $d_w(1,4)=4$. This minimum weight is achieved by two paths: $1 \\to 3 \\to 4$ (weight $3+1=4$, $2$ hops) and $1 \\to 6 \\to 5 \\to 4$ (weight $2+1+1=4$, $3$ hops). The existence of the latter path, with $3$ hops, demonstrates a case where a weighted shortest path contains more hops ($3$) than the hop-based shortest path length ($d_h(1,4)=2$).\n\n2. An unordered pair where a one-hop connection is not chosen in favor of a multi-hop lighter path:\nConsider the pair $\\{2,4\\}$. There is a direct edge (a one-hop connection) between nodes $2$ and $4$ with a large weight of $w_{24}=10$. The hop-based shortest path length is therefore $d_h(2,4)=1$. However, the weighted shortest path is not this direct edge. Instead, the path $2 \\to 3 \\to 4$ has a total weight of $w_{23}+w_{34}=1+1=2$. Since $2  10$, the multi-hop path is chosen over the direct one-hop connection.\n\nFinally, we compute the ratio $R = L_w / L_h$.\n$$ R = \\frac{L_w}{L_h} = \\frac{34/15}{4/3} = \\frac{34}{15} \\times \\frac{3}{4} = \\frac{34 \\times 3}{15 \\times 4} = \\frac{17 \\times 2 \\times 3}{5 \\times 3 \\times 2 \\times 2} = \\frac{17}{5 \\times 2} = \\frac{17}{10} $$\nThe ratio is a simplified exact fraction as requested.",
            "answer": "$$\\boxed{\\frac{17}{10}}$$"
        },
        {
            "introduction": "While exact calculations are instructive, they become computationally infeasible for the massive networks encountered in practice. This exercise addresses this real-world challenge by introducing a powerful technique: estimating the average path length ($\\ell$) via random sampling of source nodes. You will not only implement this efficient approximation method but also learn to quantify its precision by deriving a confidence interval using Hoeffding's inequality, providing a rigorous way to report results from large-scale network analysis .",
            "id": "4302440",
            "problem": "Consider a finite, simple, undirected, unweighted, and connected graph $G=(V,E)$ with $|V|=n$. The shortest path distance between two vertices $u,v \\in V$ is denoted $d(u,v)$, defined as the minimum number of edges in any path connecting $u$ and $v$. The network diameter $D$ is defined as $D=\\max_{u,v \\in V} d(u,v)$. The average path length $\\ell$ is defined over unordered vertex pairs as\n$$\n\\ell \\;=\\; \\frac{2}{n(n-1)} \\sum_{u  v} d(u,v).\n$$\nBreadth-First Search (BFS) computes $d(r,v)$ for all $v \\in V$ when rooted at a vertex $r$. You will construct an estimator $\\widehat{\\ell}$ for $\\ell$ by sampling BFS trees rooted at $m$ independently and identically distributed (i.i.d.) uniform random vertices, and then derive a confidence interval using Hoeffding’s inequality based on fundamental definitions and bounds.\n\nStarting from the core definitions above, define, for a uniformly random root $R$ in $V$, the root-conditional average shortest path length\n$$\nZ_R \\;=\\; \\frac{1}{n-1} \\sum_{v \\in V \\setminus \\{R\\}} d(R,v).\n$$\nFor i.i.d. samples $R_1, R_2, \\ldots, R_m$ drawn uniformly from $V$, set\n$$\n\\widehat{\\ell} \\;=\\; \\frac{1}{m} \\sum_{i=1}^m Z_{R_i}.\n$$\nUsing the fact that $0 \\le d(u,v) \\le D$ for all $u,v \\in V$, derive a confidence interval for $\\ell$ based on Hoeffding’s inequality for bounded independent random variables. Use the bound range $[a,b]=[0,D]$ for the $Z_{R_i}$.\n\nYour program must perform the following for each test case:\n- Compute the exact network diameter $D$ and the exact average path length $\\ell$ using fundamental definitions and BFS without shortcuts or approximations.\n- Estimate $\\widehat{\\ell}$ by sampling $m$ i.i.d. uniform roots from $V$ and averaging $Z_{R_i}$.\n- Compute a two-sided confidence interval $[\\widehat{\\ell}-\\varepsilon,\\widehat{\\ell}+\\varepsilon]$ with confidence level $1-\\delta$, where $\\varepsilon$ is derived by inverting Hoeffding’s inequality for the sample mean of $m$ i.i.d. bounded variables in $[0,D]$. Explicitly,\n$$\n\\varepsilon \\;=\\; D \\sqrt{\\frac{\\ln\\!\\left(\\frac{2}{\\delta}\\right)}{2m}}.\n$$\nClamp the interval to the feasible range $[0,D]$.\n\nUse purely mathematical and algorithmic reasoning based on the definitions of shortest paths, diameter, and average path length. Do not use any external data or probabilistic shortcuts other than the stated i.i.d. uniform sampling of roots. All computations are dimensionless; no physical units are involved.\n\nTest Suite:\nProvide results for the following three ($3$) test cases. For reproducibility, when sampling the $m$ roots, use a fixed pseudo-random number generator seed of $12345$ and sample with replacement (i.i.d. uniform over $V$).\n\n1. Path graph with $n=5$ vertices $V=\\{0,1,2,3,4\\}$ and edges $E=\\{(0,1),(1,2),(2,3),(3,4)\\}$. Use $m=1$ and $\\delta=0.05$.\n2. Star graph with $n=6$ vertices $V=\\{0,1,2,3,4,5\\}$, center $0$ connected to all leaves, edges $E=\\{(0,1),(0,2),(0,3),(0,4),(0,5)\\}$. Use $m=2$ and $\\delta=0.05$.\n3. Two-dimensional grid graph of size $3 \\times 3$ with $n=9$ vertices labeled by coordinates $(i,j)$ for $i,j \\in \\{0,1,2\\}$ mapped to integers $\\{0,\\ldots,8\\}$ in row-major order, with edges between orthogonally adjacent vertices. Use $m=9$ and $\\delta=0.05$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a comma-separated list in square brackets of the form $[\\widehat{\\ell},\\text{lower},\\text{upper},D,\\ell]$ with all entries as decimal floats. For example, the full output across the three test cases must look like $[[\\widehat{\\ell}_1,\\text{lower}_1,\\text{upper}_1,D_1,\\ell_1],[\\widehat{\\ell}_2,\\text{lower}_2,\\text{upper}_2,D_2,\\ell_2],[\\widehat{\\ell}_3,\\text{lower}_3,\\text{upper}_3,D_3,\\ell_3]]$.",
            "solution": "We begin from the foundational graph-theoretic definitions. Let $G=(V,E)$ be a finite, simple, undirected, unweighted, and connected graph with $|V|=n$. For any two vertices $u,v \\in V$, the shortest path distance $d(u,v)$ is the minimum number of edges in any path between $u$ and $v$, computed by Breadth-First Search (BFS) rooted at $u$ or $v$. The network diameter $D$ is defined by $D=\\max_{u,v \\in V} d(u,v)$, and the average path length over unordered distinct pairs is\n$$\n\\ell \\;=\\; \\frac{2}{n(n-1)} \\sum_{u  v} d(u,v).\n$$\n\nConstructing the estimator. Define a random variable for a uniformly random root $R \\in V$:\n$$\nZ_R \\;=\\; \\frac{1}{n-1} \\sum_{v \\in V \\setminus \\{R\\}} d(R,v).\n$$\nThis $Z_R$ is the conditional average distance from $R$ to all other vertices. Consider independent and identically distributed (i.i.d.) samples $R_1,\\ldots,R_m \\sim \\text{Uniform}(V)$, and define the sample mean\n$$\n\\widehat{\\ell} \\;=\\; \\frac{1}{m} \\sum_{i=1}^m Z_{R_i}.\n$$\nWe claim $\\mathbb{E}[Z_R]=\\ell$, hence $\\widehat{\\ell}$ is an unbiased estimator of $\\ell$. To see this, expand and use symmetry:\n$$\n\\mathbb{E}[Z_R] \\;=\\; \\frac{1}{n} \\sum_{r \\in V} \\frac{1}{n-1} \\sum_{v \\in V \\setminus \\{r\\}} d(r,v)\n\\;=\\; \\frac{1}{n(n-1)} \\sum_{r \\in V} \\sum_{v \\in V \\setminus \\{r\\}} d(r,v).\n$$\nThe double sum counts each ordered pair $(u,v)$ with $u \\neq v$ exactly once, so\n$$\n\\mathbb{E}[Z_R] \\;=\\; \\frac{1}{n(n-1)} \\sum_{u \\neq v} d(u,v)\n\\;=\\; \\frac{2}{n(n-1)} \\sum_{u  v} d(u,v)\n\\;=\\; \\ell.\n$$\nThus $\\widehat{\\ell}$ is unbiased for $\\ell$.\n\nBounding and concentration. Each distance satisfies $0 \\le d(u,v) \\le D$. For any fixed $r$, the average $Z_r$ is a mean of $(n-1)$ terms, each in $[0,D]$, hence $Z_r \\in [0,D]$. The variables $Z_{R_1},\\ldots,Z_{R_m}$ are i.i.d. and bounded in $[0,D]$. By Hoeffding’s inequality for bounded independent random variables,\n$$\n\\mathbb{P}\\left( \\left| \\frac{1}{m} \\sum_{i=1}^m Z_{R_i} - \\mathbb{E}[Z_R] \\right| \\ge \\varepsilon \\right)\n\\;\\le\\; 2 \\exp\\!\\left( - \\frac{2 m \\varepsilon^2}{(b-a)^2} \\right),\n$$\nwhere $[a,b]=[0,D]$. Setting the right-hand side equal to $\\delta$ and solving for $\\varepsilon$ yields\n$$\n\\varepsilon \\;=\\; (b-a) \\sqrt{ \\frac{\\ln(2/\\delta)}{2m} }\n\\;=\\; D \\sqrt{ \\frac{\\ln(2/\\delta)}{2m} }.\n$$\nTherefore, with probability at least $1-\\delta$, the interval\n$$\n\\left[ \\widehat{\\ell} - \\varepsilon,\\; \\widehat{\\ell} + \\varepsilon \\right]\n$$\ncontains $\\ell$. Because $\\ell \\in [0,D]$, we clamp this interval to $[0,D]$.\n\nAlgorithmic design.\n\n1. Exact shortest paths and diameter. For each vertex $u \\in V$, run BFS to obtain distances $d(u,v)$ to all $v \\in V$. Compute the eccentricity $e(u)=\\max_{v} d(u,v)$; then $D=\\max_{u} e(u)$. For the exact average path length $\\ell$, sum $d(u,v)$ over unordered pairs by accumulating $\\sum_{u} \\sum_{vu} d(u,v)$ and divide by $\\binom{n}{2}$.\n\n2. Sampling estimator. Using a fixed pseudo-random seed for reproducibility, draw $m$ i.i.d. uniform roots with replacement from $V$. For each root $r$, run BFS to compute distances $d(r,v)$; then compute $Z_r = \\frac{1}{n-1} \\sum_{v \\neq r} d(r,v)$. Average these to obtain $\\widehat{\\ell}$.\n\n3. Confidence interval. Compute $D$ exactly as above. Set $\\varepsilon = D \\sqrt{ \\frac{\\ln(2/\\delta)}{2m} }$ and output the clamped interval $[\\max\\{0,\\widehat{\\ell}-\\varepsilon\\},\\min\\{D,\\widehat{\\ell}+\\varepsilon\\}]$.\n\nComplexity. Each BFS runs in time $\\mathcal{O}(n+|E|)$. Computing exact $D$ and $\\ell$ requires $n$ BFS runs, with total time $\\mathcal{O}(n(n+|E|))$ for small graphs in the test suite. The sampling step runs $m$ BFS traversals with time $\\mathcal{O}(m(n+|E|))$.\n\nTest cases detail.\n\n1. Path graph with $n=5$, edges $E=\\{(0,1),(1,2),(2,3),(3,4)\\}$; set $m=1$, $\\delta=0.05$. The exact diameter is $D=4$, and the exact average path length is $\\ell=2$.\n\n2. Star graph with $n=6$, edges $E=\\{(0,1),(0,2),(0,3),(0,4),(0,5)\\}$; set $m=2$, $\\delta=0.05$. The exact diameter is $D=2$, and the exact average path length is $\\ell=\\frac{5}{3}$.\n\n3. Grid graph $3 \\times 3$ with $n=9$ and orthogonal adjacency; set $m=9$, $\\delta=0.05$. The exact $D$ and $\\ell$ are computed via BFS as specified.\n\nFinal output is a single line string:\n$$\n\\big[ [\\widehat{\\ell}_1,\\text{lower}_1,\\text{upper}_1,D_1,\\ell_1],\\; [\\widehat{\\ell}_2,\\text{lower}_2,\\text{upper}_2,D_2,\\ell_2],\\; [\\widehat{\\ell}_3,\\text{lower}_3,\\text{upper}_3,D_3,\\ell_3] \\big].\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef bfs_distances(n, adj, root):\n    \"\"\"Compute shortest path distances from root to all nodes in an unweighted graph using BFS.\"\"\"\n    from collections import deque\n    dist = [-1] * n\n    dist[root] = 0\n    q = deque([root])\n    while q:\n        u = q.popleft()\n        for v in adj[u]:\n            if dist[v] == -1:\n                dist[v] = dist[u] + 1\n                q.append(v)\n    return dist\n\ndef exact_diameter_and_avg_path_length(n, adj):\n    \"\"\"Compute exact diameter D and exact average path length ell via BFS.\"\"\"\n    # Accumulate distances and eccentricities\n    total_sum = 0\n    num_pairs = n * (n - 1) // 2\n    diameter = 0\n    all_dists = []\n    for u in range(n):\n        du = bfs_distances(n, adj, u)\n        # Eccentricity of u\n        ecc_u = max(du)\n        diameter = max(diameter, ecc_u)\n        all_dists.append(du)\n    # Sum over unordered pairs u  v\n    for u in range(n):\n        du = all_dists[u]\n        for v in range(u + 1, n):\n            total_sum += du[v]\n    ell = total_sum / num_pairs\n    return diameter, ell\n\ndef sample_estimator(n, adj, m, rng):\n    \"\"\"Estimate ell by sampling m i.i.d. uniform roots and averaging mean distances.\"\"\"\n    z_values = []\n    for _ in range(m):\n        r = int(rng.integers(0, n))\n        d = bfs_distances(n, adj, r)\n        # Exclude self distance (0) and compute mean to other vertices\n        s = sum(d)  # includes 0 at index r\n        z_r = (s) / (n - 1)  # since d[r]=0, sum over all includes 0; same as sum_{v!=r} d(r,v)/(n-1)\n        z_values.append(z_r)\n    hat_ell = float(np.mean(z_values)) if z_values else 0.0\n    return hat_ell\n\ndef build_path_graph(n):\n    \"\"\"Build adjacency list for a path graph with n vertices 0..n-1.\"\"\"\n    adj = [[] for _ in range(n)]\n    for i in range(n - 1):\n        adj[i].append(i + 1)\n        adj[i + 1].append(i)\n    return adj\n\ndef build_star_graph(n, center=0):\n    \"\"\"Build adjacency list for a star graph with n vertices, center connected to all others.\"\"\"\n    adj = [[] for _ in range(n)]\n    for v in range(n):\n        if v != center:\n            adj[center].append(v)\n            adj[v].append(center)\n    return adj\n\ndef build_grid_graph(rows, cols):\n    \"\"\"Build adjacency list for an orthogonal 2D grid graph with given rows and cols, row-major indexing.\"\"\"\n    n = rows * cols\n    adj = [[] for _ in range(n)]\n    def idx(i, j):\n        return i * cols + j\n    for i in range(rows):\n        for j in range(cols):\n            u = idx(i, j)\n            if i  0:\n                v = idx(i - 1, j)\n                adj[u].append(v); adj[v].append(u)\n            if j  0:\n                v = idx(i, j - 1)\n                adj[u].append(v); adj[v].append(u)\n    # Remove duplicate edges that might have been added twice; ensure uniqueness\n    adj = [sorted(list(set(neigh))) for neigh in adj]\n    return adj\n\ndef hoeffding_epsilon(D, m, delta):\n    \"\"\"Compute epsilon from Hoeffding's inequality for bounded variables in [0,D].\"\"\"\n    if m = 0:\n        return 0.0\n    return float(D * np.sqrt(np.log(2.0 / delta) / (2.0 * m)))\n\ndef format_case_result(values):\n    \"\"\"Format a list of floats into a bracketed, comma-separated string with fixed decimals and no spaces.\"\"\"\n    return \"[\" + \",\".join(f\"{v:.6f}\" for v in values) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (n, adj, m, delta)\n    # Use fixed RNG seed for reproducible sampling with replacement.\n    rng = np.random.default_rng(12345)\n\n    # Test case 1: Path graph n=5, m=1, delta=0.05\n    n1 = 5\n    adj1 = build_path_graph(n1)\n    m1 = 1\n    delta1 = 0.05\n\n    # Test case 2: Star graph n=6, m=2, delta=0.05\n    n2 = 6\n    adj2 = build_star_graph(n2, center=0)\n    m2 = 2\n    delta2 = 0.05\n\n    # Test case 3: Grid graph 3x3, n=9, m=9, delta=0.05\n    rows3, cols3 = 3, 3\n    adj3 = build_grid_graph(rows3, cols3)\n    n3 = rows3 * cols3\n    m3 = 9\n    delta3 = 0.05\n\n    test_cases = [\n        (n1, adj1, m1, delta1),\n        (n2, adj2, m2, delta2),\n        (n3, adj3, m3, delta3),\n    ]\n\n    results_str = []\n\n    for (n, adj, m, delta) in test_cases:\n        # Exact diameter and exact average path length\n        D_exact, ell_exact = exact_diameter_and_avg_path_length(n, adj)\n        # Sampling estimator\n        hat_ell = sample_estimator(n, adj, m, rng)\n        # Hoeffding epsilon and CI clamped to [0, D_exact]\n        eps = hoeffding_epsilon(D_exact, m, delta)\n        lower = max(0.0, hat_ell - eps)\n        upper = min(float(D_exact), hat_ell + eps)\n        # Collect case result: [hat_ell, lower, upper, D_exact, ell_exact]\n        case_values = [hat_ell, lower, upper, float(D_exact), float(ell_exact)]\n        results_str.append(format_case_result(case_values))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        }
    ]
}