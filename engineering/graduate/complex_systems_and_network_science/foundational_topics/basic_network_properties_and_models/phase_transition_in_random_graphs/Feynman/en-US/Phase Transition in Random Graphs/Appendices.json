{
    "hands_on_practices": [
        {
            "introduction": "Our exploration begins in the subcritical regime of the Erdős–Rényi random graph, where the network is fragmented into many small, isolated components. This first exercise provides a quantitative handle on this structure by modeling component exploration as a Galton-Watson branching process. By calculating the expected component size for an average degree $\\lambda \\lt 1$, you will solidify your understanding of why network-wide connectivity is impossible in this phase .",
            "id": "4297278",
            "problem": "Consider the Erdős–Rényi random graph $G(n,p_{n})$ with $p_{n}=\\lambda/n$, where $\\lambda \\in (0,1)$ is a fixed constant and $n$ is the number of vertices. Let $V$ be a uniformly chosen vertex from $\\{1,2,\\dots,n\\}$, and let $C(V)$ denote the connected component containing $V$. Define $\\chi_{n}=\\mathbb{E}[\\,|C(V)|\\,]$, the expected size of the component of a randomly chosen vertex.\n\nUsing only fundamental definitions and well-tested facts, proceed as follows:\n- Model the breadth-first exploration of $C(V)$ and justify, in the limit $n \\to \\infty$, the local tree-like structure and the approximation by a Galton–Watson branching process with a suitable offspring distribution.\n- For a subcritical Galton–Watson branching process with mean offspring strictly less than $1$, derive from first principles an expression for the expected total progeny (the total number of individuals ever born), starting from the defining recursion of the generation sizes and their expectations.\n- Argue why the limiting expected component size $\\chi := \\lim_{n \\to \\infty} \\chi_{n}$ coincides with the expected total progeny of the corresponding subcritical Galton–Watson process.\n\nYour task is to compute $\\chi$ explicitly as a closed-form analytic expression in terms of $\\lambda$. Express your final answer as a single closed-form analytic expression. No rounding is required, and no units are involved.",
            "solution": "The problem is valid as it is a well-posed, scientifically grounded, and objective question within the established theory of random graphs. We proceed with the solution by following the structured approach outlined in the problem statement.\n\nThe quantity of interest is $\\chi = \\lim_{n \\to \\infty} \\chi_{n}$, where $\\chi_{n} = \\mathbb{E}[|C(V)|]$ is the expected size of the connected component containing a uniformly chosen vertex $V$ in an Erdős–Rényi random graph $G(n, p_{n})$ with $p_{n} = \\lambda/n$ and $\\lambda \\in (0,1)$. By the symmetry of the $G(n, p_n)$ model, all vertices are statistically equivalent, so the expectation is the same regardless of which vertex is chosen. We can therefore analyze the component size for a fixed vertex, say $v_0$.\n\nFirst, we model the exploration of the component $C(v_0)$ using a breadth-first search (BFS) and justify its approximation by a Galton-Watson (GW) branching process in the limit $n \\to \\infty$. The BFS exploration proceeds in generations.\nGeneration $k=0$ consists of the starting vertex, $\\{v_0\\}$.\nGeneration $k=1$ consists of the neighbors of $v_0$. For each of the other $n-1$ vertices, an edge to $v_0$ exists independently with probability $p_n = \\lambda/n$. The number of neighbors of $v_0$, let's call this $Z_1$, follows a binomial distribution $B(n-1, p_n)$. As $n \\to \\infty$, $p_n \\to 0$ and the mean of the distribution $(n-1)p_n = (n-1)\\lambda/n \\to \\lambda$. In this limit, the binomial distribution converges to a Poisson distribution with mean $\\lambda$. Thus, the number of individuals in the first generation is asymptotically described by a Poisson$(\\lambda)$ random variable.\n\nFor a vertex $u$ in generation $k$, we explore its neighbors to find the individuals of generation $k+1$. These are the neighbors of $u$ that have not yet been discovered in generations $0, 1, \\dots, k$. In the regime $p_n = \\lambda/n$, the graph is sparse. The probability of short cycles is small, which means that the local neighborhood of any vertex is, with high probability, a tree. This is the \"local tree-like\" property. For $\\lambda  1$, the graph is in the subcritical regime, where all connected components are small (of size at most $O(\\log n)$ with high probability). Therefore, when exploring from a vertex in generation $k$, the number of already visited vertices is negligible compared to $n$. The number of potential new neighbors for any vertex is approximately $n$. The number of new offspring for each vertex in generation $k$ can thus be independently approximated by a Poisson$(\\lambda)$ distribution.\n\nThis description matches a Galton-Watson branching process: a process starting with one ancestor ($Z_0 = 1$) where each individual independently gives birth to a number of offspring according to a fixed probability distribution. Here, the offspring distribution is Poisson$(\\lambda)$. The mean of this distribution, which is the mean number of offspring per individual, is $\\mu = \\mathbb{E}[\\text{Poisson}(\\lambda)] = \\lambda$. Since $\\lambda \\in (0,1)$ is given, the process is subcritical ($\\mu  1$), which implies that the process dies out with probability $1$ and the total progeny is finite.\n\nSecond, we derive the expected total progeny for such a subcritical GW process from first principles. Let $Z_k$ be the number of individuals in generation $k$, with $Z_0 = 1$. Let the offspring of each individual be an independent random variable with mean $\\mu$. The number of individuals in generation $k+1$ is the sum of the offspring of the $Z_k$ individuals in generation $k$. Using the law of total expectation:\n$$ \\mathbb{E}[Z_{k+1}] = \\mathbb{E}[\\mathbb{E}[Z_{k+1} | Z_k]] $$\nGiven $Z_k$, each of the $Z_k$ individuals produces on average $\\mu$ offspring, so $\\mathbb{E}[Z_{k+1} | Z_k] = Z_k \\mu$. Substituting this back, we get:\n$$ \\mathbb{E}[Z_{k+1}] = \\mathbb{E}[Z_k \\mu] = \\mu \\mathbb{E}[Z_k] $$\nThis recurrence relation, with the initial condition $\\mathbb{E}[Z_0] = \\mathbb{E}[1] = 1$, can be solved by induction:\n$$ \\mathbb{E}[Z_k] = \\mu^k \\mathbb{E}[Z_0] = \\mu^k $$\nThe total progeny, $T$, is the total number of individuals in the process, including the ancestor. It is the sum of the sizes of all generations:\n$$ T = \\sum_{k=0}^{\\infty} Z_k $$\nBy the linearity of expectation, the expected total progeny is:\n$$ \\mathbb{E}[T] = \\mathbb{E}\\left[\\sum_{k=0}^{\\infty} Z_k\\right] = \\sum_{k=0}^{\\infty} \\mathbb{E}[Z_k] $$\nThe exchange of expectation and summation is justified because $Z_k$ are non-negative random variables (Tonelli's theorem). Substituting our result for $\\mathbb{E}[Z_k]$ yields:\n$$ \\mathbb{E}[T] = \\sum_{k=0}^{\\infty} \\mu^k $$\nThis is a geometric series. Since the process is subcritical, $\\mu \\in (0,1)$, the series converges to:\n$$ \\mathbb{E}[T] = \\frac{1}{1-\\mu} $$\n\nFinally, we argue that the limiting expected component size $\\chi$ is equal to the expected total progeny of the corresponding GW process. As established, the process of exploring the component $C(V)$ in $G(n, \\lambda/n)$ converges in the limit $n \\to \\infty$ to a GW process with mean offspring $\\mu = \\lambda$. The size of the component, $|C(V)|$, corresponds to the total progeny, $T$, of this GW process. Therefore, the limiting expected component size equals the expected total progeny:\n$$ \\chi = \\lim_{n \\to \\infty} \\mathbb{E}[|C(V)|] = \\mathbb{E}[T] $$\nSubstituting $\\mu = \\lambda$ into the expression for $\\mathbb{E}[T]$, we obtain the final result:\n$$ \\chi = \\frac{1}{1-\\lambda} $$\nThis expression gives the expected size of the component to which a randomly chosen vertex belongs in the subcritical regime of the Erdős–Rényi random graph.",
            "answer": "$$ \\boxed{\\frac{1}{1-\\lambda}} $$"
        },
        {
            "introduction": "As the average degree $\\lambda$ crosses the critical threshold of 1, the network undergoes a dramatic transformation with the emergence of a giant component. This exercise challenges you to quantify the size of this nascent giant component in the supercritical regime where $\\lambda \\gt 1$. Using the powerful generating function formalism, you will derive the celebrated result showing how the giant component's fractional size scales near the critical point, a hallmark of a continuous phase transition .",
            "id": "4297218",
            "problem": "Consider the Erdős–Rényi (ER) random graph model $G(n,p)$ with $p=\\lambda/n$ and $n$ large, so that the asymptotic degree distribution is Poisson with mean $\\lambda$. In the supercritical regime, where $\\lambda1$, a giant connected component occupies a positive fraction of vertices. The fraction $\\rho$ of vertices in the giant component can be obtained from the exploration process of a typical component via the associated Poisson Galton–Watson branching process and the generating-function formalism for the degree and excess-degree distributions. Starting from these fundamentals and the fact that the extinction probability of the associated branching process satisfies a fixed-point relation determined by the excess-degree generating function, derive the leading-order asymptotic expression for the fraction $\\rho$ of vertices in the giant component when $\\lambda=1+\\epsilon$ with $0\\epsilon\\ll 1$. Your derivation must explicitly justify the scaling of $\\rho$ with $\\epsilon$, and then compute the first nontrivial term in $\\epsilon$. The final answer must be a single closed-form expression in $\\epsilon$ for the leading-order asymptotic fraction $\\rho$. No numerical rounding is required.",
            "solution": "The problem asks for the derivation of the leading-order asymptotic expression for the fraction of vertices in the giant component, $\\rho$, in an Erdős–Rényi graph $G(n,p)$ with $p=\\lambda/n$ and $\\lambda = 1+\\epsilon$ for small positive $\\epsilon$.\n\nThe derivation proceeds by relating the size of the giant component to the properties of a Galton-Watson branching process that describes the exploration of a vertex's connected component. The primary tool for this analysis is the generating function formalism.\n\nFirst, we define the relevant probability distributions and their generating functions. In the limit of large $n$, the degree distribution of a vertex in $G(n, p=\\lambda/n)$ is a Poisson distribution with mean $\\lambda$:\n$$P(k) = e^{-\\lambda} \\frac{\\lambda^k}{k!}$$\nThe generating function for this degree distribution, $G_0(x)$, is defined as $G_0(x) = \\sum_{k=0}^{\\infty} P(k) x^k$. For the Poisson distribution, this is:\n$$G_0(x) = \\sum_{k=0}^{\\infty} e^{-\\lambda} \\frac{\\lambda^k}{k!} x^k = e^{-\\lambda} \\sum_{k=0}^{\\infty} \\frac{(\\lambda x)^k}{k!} = e^{-\\lambda} e^{\\lambda x} = \\exp(\\lambda(x-1))$$\n\nNext, we consider the exploration process. When we arrive at a vertex by traversing an edge, the number of its *other* neighbors (its excess degree) follows a different distribution. The probability that a randomly chosen edge leads to a vertex of degree $k$ is proportional to $k P(k)$. The generating function for the excess degree distribution, $G_1(x)$, is given by:\n$$G_1(x) = \\frac{\\sum_{k=1}^{\\infty} k P(k) x^{k-1}}{\\sum_{k=1}^{\\infty} k P(k)}$$\nThe denominator is the mean degree, $\\langle k \\rangle = \\lambda$. The numerator is the derivative of the degree generating function, $G_0'(x)$. Thus:\n$$G_1(x) = \\frac{G_0'(x)}{\\lambda}$$\nFor our Poisson case, $G_0'(x) = \\frac{d}{dx} \\exp(\\lambda(x-1)) = \\lambda \\exp(\\lambda(x-1))$. Therefore, the excess degree generating function is:\n$$G_1(x) = \\frac{\\lambda \\exp(\\lambda(x-1))}{\\lambda} = \\exp(\\lambda(x-1))$$\nA crucial property of the Poisson distribution is that the degree and excess degree generating functions have the same form: $G_0(x) = G_1(x)$.\n\nThe fraction of vertices belonging to the giant component, $\\rho$, is $1$ minus the fraction of vertices belonging to finite components. A vertex belongs to a finite component if and only if the branching process starting from it dies out. Let $u$ be the probability that the component exploration along a single edge terminates, i.e., the sub-tree explored from that edge is finite. This $u$ is the extinction probability of a branching process whose offspring distribution is the excess degree distribution. It is given by the smallest non-negative solution to the fixed-point equation:\n$$u = G_1(u)$$\nFor a randomly chosen vertex of degree $k$, its entire component is finite only if the exploration along all of its $k$ edges leads to finite sub-trees. The probability of this is $u^k$. To find the total probability that a randomly chosen vertex is in a finite component, we average this over the degree distribution $P(k)$:\n$$1-\\rho = \\sum_{k=0}^{\\infty} P(k) u^k = G_0(u)$$\nThis gives the relation for the giant component fraction: $\\rho = 1 - G_0(u)$.\n\nCombining these results for the specific case of the Poisson ER graph, we use the fact that $G_0(x) = G_1(x)$. The fixed-point equation for $u$ becomes $u = G_0(u)$. Substituting this into the expression for $\\rho$, we find a direct relationship between $\\rho$ and $u$:\n$$\\rho = 1 - G_0(u) = 1 - u$$\nThus, to find the asymptotic behavior of $\\rho$, we need to find the asymptotic behavior of the extinction probability $u$. The problem is reduced to solving the fixed-point equation for $u$ near the critical point.\n\nThe equation is $u = \\exp(\\lambda(u-1))$. We are given $\\lambda = 1+\\epsilon$ with $0  \\epsilon \\ll 1$. For $\\lambda  1$, there exists a unique solution $u \\in [0, 1)$ in addition to the trivial solution $u=1$. As $\\epsilon \\to 0$, this solution $u$ approaches $1$. We can express this by writing $u = 1-\\rho$, where we anticipate that $\\rho$ will be small when $\\epsilon$ is small. Substituting $u=1-\\rho$ and $\\lambda=1+\\epsilon$ into the fixed-point equation:\n$$1 - \\rho = \\exp((1+\\epsilon)((1-\\rho)-1))$$\n$$1 - \\rho = \\exp(-(1+\\epsilon)\\rho)$$\nTo analyze this equation for small $\\epsilon$ and $\\rho$, we perform a Taylor expansion of the exponential function on the right-hand side. For a small argument $z$, $\\exp(z) = 1 + z + \\frac{z^2}{2} + O(z^3)$. Here, the argument is $z = -(1+\\epsilon)\\rho$.\n$$1 - \\rho = 1 - (1+\\epsilon)\\rho + \\frac{1}{2} (-(1+\\epsilon)\\rho)^2 + O(\\rho^3)$$\n$$1 - \\rho = 1 - (1+\\epsilon)\\rho + \\frac{1}{2} (1+\\epsilon)^2 \\rho^2 - O(\\rho^3)$$\nSubtracting $1$ from both sides and rearranging terms:\n$$0 = -\\rho + (1+\\epsilon)\\rho - \\frac{1}{2}(1+\\epsilon)^2 \\rho^2 + O(\\rho^3)$$\n$$0 = \\epsilon\\rho - \\frac{1}{2}(1+\\epsilon)^2 \\rho^2 + O(\\rho^3)$$\nThis equation has two solutions for $\\rho$. One is the trivial solution $\\rho=0$, which corresponds to $u=1$ (extinction is certain, no giant component). We are interested in the non-trivial solution for the supercritical regime, so we can divide by $\\rho$:\n$$0 = \\epsilon - \\frac{1}{2}(1+\\epsilon)^2 \\rho + O(\\rho^2)$$\nThis equation reveals the scaling relationship between $\\rho$ and $\\epsilon$. For the equation to hold as $\\epsilon \\to 0$, $\\rho$ must also approach $0$. To find the leading-order behavior, we can neglect higher-order terms in both $\\epsilon$ and $\\rho$. The equation becomes:\n$$\\epsilon \\approx \\frac{1}{2}(1+O(\\epsilon))^2 \\rho \\approx \\frac{1}{2}\\rho$$\nThis justifies the scaling: $\\rho$ is of the same order as $\\epsilon$, specifically $\\rho \\propto \\epsilon$.\n\nTo find the first nontrivial term, we solve the equation $\\epsilon = \\frac{1}{2}(1+\\epsilon)^2 \\rho$ for $\\rho$:\n$$\\rho = \\frac{2\\epsilon}{(1+\\epsilon)^2}$$\nSince we seek the leading-order asymptotic expression for small $\\epsilon$, we can expand the denominator $(1+\\epsilon)^{-2} = 1 - 2\\epsilon + 3\\epsilon^2 - \\dots$:\n$$\\rho = 2\\epsilon(1 - 2\\epsilon + O(\\epsilon^2)) = 2\\epsilon - 4\\epsilon^2 + O(\\epsilon^3)$$\nThe leading-order term, which is the first nontrivial term in the expansion for $\\rho$ in powers of $\\epsilon$, is therefore $2\\epsilon$.",
            "answer": "$$\\boxed{2\\epsilon}$$"
        },
        {
            "introduction": "Moving beyond the specific case of the Erdős–Rényi model, we seek a more universal criterion for the onset of large-scale connectivity. This advanced practice introduces the non-backtracking matrix, whose spectral radius governs the proliferation of paths in the network. By connecting the growth of non-backtracking walks to the critical point of bond percolation, you will derive a general condition for the emergence of a giant component applicable to graphs with arbitrary degree distributions .",
            "id": "4297232",
            "problem": "Consider a sparse random graph generated by the configuration model with $n$ vertices, where each vertex has an independent degree drawn from a distribution $P(k)$ supported on the nonnegative integers, with finite first and second moments $\\mathbb{E}[K]$ and $\\mathbb{E}[K^{2}]$. Let $B$ denote the non-backtracking matrix acting on the space of directed edges: its rows and columns are indexed by directed edges $i \\to j$, and its entries satisfy $B_{i \\to j,\\, k \\to \\ell} = 1$ if and only if $j = k$ and $\\ell \\neq i$, and $B_{i \\to j,\\, k \\to \\ell} = 0$ otherwise. Assume the graph is in the sparse regime where the local neighborhoods converge to Galton–Watson trees, and that the degree distribution is such that a giant connected component (GCC) may or may not exist depending on a control parameter.\n\nYou are to reason from first principles about non-backtracking walks and branching processes, without using pre-derived formulas that give the answer directly. Specifically:\n\n1. Using the locally tree-like property of the configuration model and the notion of following a uniformly random edge to a vertex, derive the asymptotic growth factor of the expected number of non-backtracking walks of length $t$ as $t \\to \\infty$, and from this compute the spectral radius $\\rho(B)$ of the non-backtracking matrix in the $n \\to \\infty$ limit, expressed purely in terms of degree moments of $P(k)$.\n\n2. Consider independent bond percolation on the same configuration model graph, where each edge is retained with probability $p \\in (0,1)$ and deleted otherwise. Using the linear stability of the trivial fixed point of the standard cavity (message passing) equations for percolation on locally tree-like graphs, deduce the critical bond occupation probability $p_{c}$ at which the GCC first appears in the limit $n \\to \\infty$, expressed as a function of $\\rho(B)$ and the degree moments of $P(k)$.\n\nYour final answer should be a single closed-form analytic expression for the bond percolation threshold $p_{c}$ in terms of $\\mathbb{E}[K]$ and $\\mathbb{E}[K(K-1)]$. No rounding is required. Do not include any physical units.",
            "solution": "The solution is developed in two parts as requested.\n\n**Part 1: Derivation of the Spectral Radius of the Non-Backtracking Matrix**\n\nThe non-backtracking matrix $B$ describes the propagation of non-backtracking walks on the graph. Its spectral radius, $\\rho(B)$, governs the exponential growth rate of the number of such walks. In a large sparse random graph (which is locally tree-like), a non-backtracking walk can be viewed as a branching process. We aim to find the average number of new branches created at each step.\n\nConsider a walk that arrives at a vertex $v$ by traversing an edge. The number of possible next steps for a non-backtracking walk is the number of other edges connected to $v$, which is $k_v - 1$, where $k_v$ is the degree of vertex $v$. To find the average growth factor, we must average this quantity over all vertices $v$ that can be reached by following a random edge.\n\nA vertex reached by following a random edge is not a uniformly random vertex. The probability of landing on a vertex of degree $k$, which we denote $q(k)$, is proportional to $k$ times the probability $P(k)$ that a uniformly chosen vertex has degree $k$. This is because higher-degree vertices have more edges leading to them. The total number of edge ends (\"stubs\") in the graph is $\\sum_i k_i \\approx n\\mathbb{E}[K]$. The number of stubs attached to vertices of degree $k$ is $n P(k) k$. Therefore, the probability of a random stub connecting to a vertex of degree $k$ is:\n$$q(k) = \\frac{n k P(k)}{n \\mathbb{E}[K]} = \\frac{k P(k)}{\\mathbb{E}[K]}$$\nThis is the probability distribution for the degree of a vertex found at the end of a randomly chosen edge.\n\nThe average number of new paths leading away from such a vertex is the expectation of $(K-1)$, where the degree $K$ is drawn from this distribution $q(k)$. This average branching factor is the spectral radius $\\rho(B)$ in the large $n$ limit.\n$$ \\rho(B) = \\mathbb{E}_{q(k)}[K-1] = \\sum_{k=1}^{\\infty} (k-1) q(k) = \\sum_{k=1}^{\\infty} (k-1) \\frac{k P(k)}{\\mathbb{E}[K]} $$\nWe can rewrite the summation:\n$$ \\rho(B) = \\frac{1}{\\mathbb{E}[K]} \\sum_{k=0}^{\\infty} (k^2 - k) P(k) = \\frac{1}{\\mathbb{E}[K]} \\left( \\sum_{k=0}^{\\infty} k^2 P(k) - \\sum_{k=0}^{\\infty} k P(k) \\right) $$\nThe terms in the parentheses are, by definition, the second and first moments of the degree distribution $P(k)$.\n$$ \\rho(B) = \\frac{\\mathbb{E}[K^2] - \\mathbb{E}[K]}{\\mathbb{E}[K]} = \\frac{\\mathbb{E}[K(K-1)]}{\\mathbb{E}[K]} $$\nThis is the asymptotic spectral radius of the non-backtracking matrix.\n\n**Part 2: Derivation of the Bond Percolation Threshold**\n\nWe use the cavity method to find the critical probability $p_c$ for bond percolation. Let $u_{i \\to j}$ be the probability that vertex $i$ is *not* connected to the giant component in the \"cavity graph\", which is the original graph with vertex $j$ removed. In the locally tree-like limit, this is equivalent to the graph with edge $(i, j)$ removed.\n\nA giant component exists if there is a non-trivial solution ($u_{i \\to j}  1$) to the self-consistency equations. The critical point $p_c$ is where the trivial solution ($u_{i \\to j} = 1$ for all edges, meaning no GCC) becomes unstable.\n\nFor vertex $i$ to be disconnected from the GCC in the cavity graph, it must be that for each of its other neighbors $k \\in \\mathcal{N}(i) \\setminus \\{j\\}$, the connection through that neighbor fails. This failure occurs if either the edge $(i,k)$ is removed by percolation (probability $1-p$), or the edge is present (probability $p$) but vertex $k$ is itself not connected to the GCC in its respective cavity graph (probability $u_{k \\to i}$). Since these events are independent for each neighbor $k$:\n$$ u_{i \\to j} = \\prod_{k \\in \\mathcal{N}(i) \\setminus \\{j\\}} \\left[ (1-p) + p \\cdot u_{k \\to i} \\right] $$\nWe test the stability of the trivial fixed point $u=1$ by introducing a small perturbation, $u_{i \\to j} = 1 - \\epsilon_{i \\to j}$, where $\\epsilon_{i \\to j} \\ll 1$.\n$$ 1 - \\epsilon_{i \\to j} = \\prod_{k \\in \\mathcal{N}(i) \\setminus \\{j\\}} \\left[ (1-p) + p(1 - \\epsilon_{k \\to i}) \\right] = \\prod_{k \\in \\mathcal{N}(i) \\setminus \\{j\\}} \\left[ 1 - p \\epsilon_{k \\to i} \\right] $$\nFor small $\\epsilon$, we linearize the product: $\\prod_m (1-x_m) \\approx 1 - \\sum_m x_m$.\n$$ 1 - \\epsilon_{i \\to j} \\approx 1 - \\sum_{k \\in \\mathcal{N}(i) \\setminus \\{j\\}} p \\epsilon_{k \\to i} $$\nThis gives the linearized equation for the perturbations:\n$$ \\epsilon_{i \\to j} = p \\sum_{k \\in \\mathcal{N}(i) \\setminus \\{j\\}} \\epsilon_{k \\to i} $$\nThis equation describes the propagation of the perturbation vector $\\vec{\\epsilon}$ on the directed edges of the graph. The sum on the right-hand side is precisely the action of the transpose of the non-backtracking matrix, $B^T$, on the vector $\\vec{\\epsilon}$. The entry $(B^T)_{i \\to j, k \\to i}$ is 1 if $k \\in \\mathcal{N}(i) \\setminus \\{j\\}$ and 0 otherwise. Thus, the equation is $\\vec{\\epsilon} = p B^T \\vec{\\epsilon}$.\n\nThe trivial solution becomes unstable when this linear system allows for a non-zero solution for $\\vec{\\epsilon}$, which happens when $p B^T$ has an eigenvalue of 1. The threshold for instability is determined by the largest eigenvalue (spectral radius) of the operator.\n$$ 1 = p_c \\cdot \\rho(B^T) $$\nSince the spectral radius of a matrix and its transpose are equal, $\\rho(B^T) = \\rho(B)$. The critical condition is:\n$$ p_c \\rho(B) = 1 \\implies p_c = \\frac{1}{\\rho(B)} $$\nSubstituting the result for $\\rho(B)$ from Part 1 gives the final answer:\n$$ p_c = \\frac{\\mathbb{E}[K]}{\\mathbb{E}[K(K-1)]} $$\nThis is the Molloy-Reed criterion for the emergence of a giant component, derived here in the context of bond percolation.",
            "answer": "$$\\boxed{\\frac{\\mathbb{E}[K]}{\\mathbb{E}[K(K-1)]}}$$"
        }
    ]
}