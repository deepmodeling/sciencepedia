{
    "hands_on_practices": [
        {
            "introduction": "在临界点以下（即 $\\lambda \\lt 1$），随机图由许多孤立的小型连通分支构成。这个练习  将引导你使用 Galton-Watson 分支过程这一强大工具，将连通分支的探索过程模型化。通过计算一个亚临界分支过程的期望后代总数，你将能够推导出随机选择的节点所属连通分支的平均大小，从而定量地理解亚临界状态的图结构。",
            "id": "4297278",
            "problem": "考虑一个 Erdős–Rényi 随机图 $G(n,p_{n})$，其中 $p_{n}=\\lambda/n$，$\\lambda \\in (0,1)$ 是一个固定常数，$n$ 是顶点数。设 $V$ 是从 $\\{1,2,\\dots,n\\}$ 中均匀选取的一个顶点，并设 $C(V)$ 表示包含 $V$ 的连通分量。定义 $\\chi_{n}=\\mathbb{E}[\\,|C(V)|\\,]$，即随机选取顶点的连通分量的期望大小。\n\n仅使用基本定义和公认事实，按以下步骤进行：\n- 对 $C(V)$ 的广度优先搜索过程进行建模，并在极限 $n \\to \\infty$ 下，证明其局部树状结构以及可以通过具有合适后代分布的 Galton–Watson 分支过程进行近似的合理性。\n- 对于平均后代数严格小于 $1$ 的亚临界 Galton–Watson 分支过程，从第一性原理出发，从各代种群大小及其期望的定义性递推关系开始，推导其期望总后代数（所有曾出现过的个体总数）的表达式。\n- 论证为何极限期望连通分量大小 $\\chi := \\lim_{n \\to \\infty} \\chi_{n}$ 与相应的亚临界 Galton–Watson 过程的期望总后代数一致。\n\n你的任务是计算 $\\chi$，并用 $\\lambda$ 表示成一个闭式解析表达式。将最终答案表示为单个闭式解析表达式。无需四舍五入，不涉及单位。",
            "solution": "该问题在随机图论的既定理论中是一个适定、有科学依据且客观的问题，因此是有效的。我们按照问题陈述中概述的结构化方法进行解答。\n\n我们感兴趣的量是 $\\chi = \\lim_{n \\to \\infty} \\chi_{n}$，其中 $\\chi_{n} = \\mathbb{E}[|C(V)|]$ 是 Erdős–Rényi 随机图 $G(n, p_{n})$（$p_{n} = \\lambda/n$ 且 $\\lambda \\in (0,1)$）中均匀选取的顶点 $V$ 所在连通分量的期望大小。根据 $G(n, p_n)$ 模型的对称性，所有顶点在统计上是等价的，因此无论选择哪个顶点，期望值都相同。因此，我们可以分析一个固定顶点（例如 $v_0$）的连通分量大小。\n\n首先，我们使用广度优先搜索 (BFS) 对连通分量 $C(v_0)$ 的探索过程进行建模，并证明在极限 $n \\to \\infty$ 下，它可以用 Galton-Watson (GW) 分支过程来近似。BFS 探索按代进行。\n第 $k=0$ 代由起始顶点 $\\{v_0\\}$ 组成。\n第 $k=1$ 代由 $v_0$ 的邻居组成。对于其他 $n-1$ 个顶点中的每一个，与 $v_0$ 之间独立地以概率 $p_n = \\lambda/n$ 存在一条边。$v_0$ 的邻居数量（我们称之为 $Z_1$）服从二项分布 $B(n-1, p_n)$。当 $n \\to \\infty$ 时，$p_n \\to 0$，该分布的均值 $(n-1)p_n = (n-1)\\lambda/n \\to \\lambda$。在此极限下，二项分布收敛于均值为 $\\lambda$ 的泊松分布。因此，第一代中的个体数量渐近地由一个泊松$(\\lambda)$随机变量描述。\n\n对于第 $k$ 代中的一个顶点 $u$，我们探索其邻居以找到第 $k+1$ 代的个体。这些是 $u$ 的邻居中尚未在第 $0, 1, \\dots, k$ 代中被发现的顶点。在 $p_n = \\lambda/n$ 的情况下，图是稀疏的。短环路出现的概率很小，这意味着任何顶点的局部邻域都以高概率是一棵树。这就是“局部树状”性质。对于 $\\lambda  1$，图处于亚临界状态，此时所有连通分量都很小（大小至多为 $O(\\log n)$ 的概率很高）。因此，当从第 $k$ 代的一个顶点开始探索时，已访问过的顶点数量与 $n$ 相比可以忽略不计。任何顶点的潜在新邻居数量近似为 $n$。因此，第 $k$ 代中每个顶点的新后代数量可以独立地用泊松$(\\lambda)$分布来近似。\n\n这个描述与 Galton-Watson 分支过程相符：一个从单个祖先 ($Z_0 = 1$) 开始的过程，其中每个个体根据一个固定的概率分布独立地产生若干后代。在这里，后代分布是泊松$(\\lambda)$。该分布的均值，即每个个体的平均后代数，是 $\\mu = \\mathbb{E}[\\text{Poisson}(\\lambda)] = \\lambda$。由于给定 $\\lambda \\in (0,1)$，该过程是亚临界的 ($\\mu  1$)，这意味着该过程以概率 $1$ 灭绝，且总后代数是有限的。\n\n其次，我们从第一性原理推导这种亚临界 GW 过程的期望总后代数。设 $Z_k$ 是第 $k$ 代的个体数量，其中 $Z_0 = 1$。设每个个体的后代数是一个均值为 $\\mu$ 的独立随机变量。第 $k+1$ 代的个体数量是第 $k$ 代中 $Z_k$ 个个体的后代总和。使用全期望定律：\n$$ \\mathbb{E}[Z_{k+1}] = \\mathbb{E}[\\mathbb{E}[Z_{k+1} | Z_k]] $$\n给定 $Z_k$，这 $Z_k$ 个个体中的每一个平均产生 $\\mu$ 个后代，所以 $\\mathbb{E}[Z_{k+1} | Z_k] = Z_k \\mu$。将其代回，我们得到：\n$$ \\mathbb{E}[Z_{k+1}] = \\mathbb{E}[Z_k \\mu] = \\mu \\mathbb{E}[Z_k] $$\n这个递推关系，在初始条件 $\\mathbb{E}[Z_0] = \\mathbb{E}[1] = 1$ 下，可以通过归纳法求解：\n$$ \\mathbb{E}[Z_k] = \\mu^k \\mathbb{E}[Z_0] = \\mu^k $$\n总后代数 $T$ 是过程中个体的总数，包括祖先。它是所有各代规模的总和：\n$$ T = \\sum_{k=0}^{\\infty} Z_k $$\n根据期望的线性性，期望总后代数为：\n$$ \\mathbb{E}[T] = \\mathbb{E}\\left[\\sum_{k=0}^{\\infty} Z_k\\right] = \\sum_{k=0}^{\\infty} \\mathbb{E}[Z_k] $$\n因为 $Z_k$ 是非负随机变量，所以交换期望和求和是合理的（根据 Tonelli 定理）。代入我们关于 $\\mathbb{E}[Z_k]$ 的结果，得到：\n$$ \\mathbb{E}[T] = \\sum_{k=0}^{\\infty} \\mu^k $$\n这是一个几何级数。由于过程是亚临界的，$\\mu \\in (0,1)$，该级数收敛于：\n$$ \\mathbb{E}[T] = \\frac{1}{1-\\mu} $$\n\n最后，我们论证极限期望连通分量大小 $\\chi$ 等于相应 GW 过程的期望总后代数。如前所述，在 $G(n, \\lambda/n)$ 中探索连通分量 $C(V)$ 的过程，在极限 $n \\to \\infty$ 下收敛于一个平均后代数为 $\\mu = \\lambda$ 的 GW 过程。连通分量的大小 $|C(V)|$ 对应于这个 GW 过程的总后代数 $T$。因此，极限期望连通分量大小等于期望总后代数：\n$$ \\chi = \\lim_{n \\to \\infty} \\mathbb{E}[|C(V)|] = \\mathbb{E}[T] $$\n将 $\\mu = \\lambda$ 代入 $\\mathbb{E}[T]$ 的表达式，我们得到最终结果：\n$$ \\chi = \\frac{1}{1-\\lambda} $$\n这个表达式给出了在 Erdős–Rényi 随机图的亚临界状态下，一个随机选择的顶点所属连通分量的期望大小。",
            "answer": "$$ \\boxed{\\frac{1}{1-\\lambda}} $$"
        },
        {
            "introduction": "在前一个练习的基础上，我们知道平均连通分支大小是描述亚临界状态的一个重要指标。然而，为了更深刻地理解相变，我们还必须关注系统在平均值附近的涨落，尤其是在接近临界点时。这个练习  深入探讨了连通分支大小的方差，它将揭示当系统逼近临界点 $\\lambda \\to 1$ 时，这些涨落是如何发散的，这是临界现象的一个标志性特征。",
            "id": "4297259",
            "problem": "考虑稀疏 Erdős–Rényi (ER) 随机图 $G(n,p)$，其中 $p=\\lambda/n$，$ \\lambda \\in (0,1)$ 是一个固定参数。令 $S_{n}$ 表示包含一个均匀选择的顶点的连通分量的大小。在复杂系统和网络科学中，一个经过充分验证的事实是，对于 $\\lambda1$，当 $n \\to \\infty$ 时，$S_{n}$ 的分布收敛于一个亚临界 Galton–Watson (GW) 分支过程的总后代 $T$ 的分布，该过程的后代数量是独立同分布的 Poisson$(\\lambda)$ 随机变量。仅使用分支过程和条件期望/方差的基本原理，计算极限分量大小分布的方差（解释为 $\\operatorname{Var}(T)$）作为 $\\lambda$ 的函数，并确定当 $\\lambda \\to 1^{-}$ 时其主阶发散性。将你的最终答案表示为关于 $\\lambda$ 的单个闭式解析表达式。无需四舍五入，也不涉及物理单位。",
            "solution": "我们旨在计算一个亚临界 Galton-Watson (GW) 分支过程的总后代数 $T$ 的方差。该过程从一个祖先开始，每个个体的后代数是服从参数为 $\\lambda$ 的泊松分布的独立随机变量。\n\n总后代数 $T$ 可以递归地表示。令 $N$ 为初始祖先的后代数，则 $N \\sim \\text{Poisson}(\\lambda)$。总后代数 $T$ 是祖先本身 (1)，加上其 $N$ 个后代各自生成的子树的总后代数之和。令 $T_i$ 为第 $i$ 个后代子树的总后代数，$i=1, 2, \\ldots, N$。每个 $T_i$ 都是与 $T$ 同分布的独立随机变量。因此，我们有关系式：\n$$\nT = 1 + \\sum_{i=1}^{N} T_i\n$$\n其中，如果 $N=0$，则和为空，值为0。\n\n我们使用全方差定律（或称 Eve 定律）来计算 $\\operatorname{Var}(T)$：\n$$\n\\operatorname{Var}(T) = \\mathbb{E}[\\operatorname{Var}(T|N)] + \\operatorname{Var}(\\mathbb{E}[T|N])\n$$\n我们分别计算右侧的两项。\n\n首先，我们计算条件期望 $\\mathbb{E}[T|N]$。给定 $N=n$，\n$$\n\\mathbb{E}[T|N=n] = \\mathbb{E}\\left[1 + \\sum_{i=1}^{n} T_i\\right] = 1 + \\sum_{i=1}^{n} \\mathbb{E}[T_i]\n$$\n由于每个 $T_i$ 与 $T$ 同分布，我们有 $\\mathbb{E}[T_i] = \\mathbb{E}[T]$。因此，$\\mathbb{E}[T|N=n] = 1 + n\\mathbb{E}[T]$。作为随机变量 $N$ 的函数，条件期望为 $\\mathbb{E}[T|N] = 1 + N\\mathbb{E}[T]$。\n我们知道（或可从 $\\mathbb{E}[T] = \\mathbb{E}[1 + N\\mathbb{E}[T]] = 1 + \\mathbb{E}[N]\\mathbb{E}[T] = 1 + \\lambda\\mathbb{E}[T]$ 推出），亚临界过程的期望总后代数为 $\\mathbb{E}[T] = \\frac{1}{1-\\lambda}$。\n\n现在，我们计算第二项 $\\operatorname{Var}(\\mathbb{E}[T|N])$：\n$$\n\\operatorname{Var}(\\mathbb{E}[T|N]) = \\operatorname{Var}(1 + N\\mathbb{E}[T])\n$$\n由于 $\\mathbb{E}[T]$ 是一个常数，这简化为：\n$$\n\\operatorname{Var}(\\mathbb{E}[T|N]) = \\operatorname{Var}(N\\mathbb{E}[T]) = (\\mathbb{E}[T])^2 \\operatorname{Var}(N)\n$$\n对于泊松分布，其方差等于其均值，即 $\\operatorname{Var}(N) = \\lambda$。代入这些值：\n$$\n\\operatorname{Var}(\\mathbb{E}[T|N]) = \\left(\\frac{1}{1-\\lambda}\\right)^2 \\lambda = \\frac{\\lambda}{(1-\\lambda)^2}\n$$\n\n接下来，我们计算第一项 $\\mathbb{E}[\\operatorname{Var}(T|N)]$。首先计算条件方差 $\\operatorname{Var}(T|N=n)$：\n$$\n\\operatorname{Var}(T|N=n) = \\operatorname{Var}\\left(1 + \\sum_{i=1}^{n} T_i\\right) = \\operatorname{Var}\\left(\\sum_{i=1}^{n} T_i\\right)\n$$\n由于 $T_i$ 是独立同分布的，和的方差等于方差的和：\n$$\n\\operatorname{Var}\\left(\\sum_{i=1}^{n} T_i\\right) = \\sum_{i=1}^{n} \\operatorname{Var}(T_i) = n\\operatorname{Var}(T)\n$$\n所以，作为随机变量 $N$ 的函数的条件方差是 $\\operatorname{Var}(T|N) = N\\operatorname{Var}(T)$。\n对其取期望：\n$$\n\\mathbb{E}[\\operatorname{Var}(T|N)] = \\mathbb{E}[N\\operatorname{Var}(T)] = \\mathbb{E}[N]\\operatorname{Var}(T) = \\lambda\\operatorname{Var}(T)\n$$\n\n现在，我们将这两项代回全方差定律方程：\n$$\n\\operatorname{Var}(T) = \\lambda\\operatorname{Var}(T) + \\frac{\\lambda}{(1-\\lambda)^2}\n$$\n我们可以解出 $\\operatorname{Var}(T)$：\n$$\n\\operatorname{Var}(T) - \\lambda\\operatorname{Var}(T) = \\frac{\\lambda}{(1-\\lambda)^2}\n$$\n$$\n\\operatorname{Var}(T) (1-\\lambda) = \\frac{\\lambda}{(1-\\lambda)^2}\n$$\n$$\n\\operatorname{Var}(T) = \\frac{\\lambda}{(1-\\lambda)^3}\n$$\n这是总后代数方差关于 $\\lambda$ 的闭式解析表达式。\n\n当 $\\lambda \\to 1^{-}$ 时，分子 $\\lambda \\to 1$，而分母 $(1-\\lambda)^3 \\to 0^+$。因此，$\\operatorname{Var}(T)$ 发散。其主阶发散行为由 $(1-\\lambda)^{-3}$ 决定，即 $\\operatorname{Var}(T) \\sim (1-\\lambda)^{-3}$。我们的表达式精确地描述了这种行为。",
            "answer": "$$\n\\boxed{\\frac{\\lambda}{(1-\\lambda)^{3}}}\n$$"
        },
        {
            "introduction": "现在我们将目光转向超临界状态（即 $\\lambda \\gt 1$）。一旦平均度超过临界阈值，网络结构就会发生戏剧性变化，出现一个占据了整个网络有限比例节点的“巨连通分支”。这个练习  专注于量化这个宏观新特征的大小，通过分析分支过程的灭绝概率，你将推导出在临界点刚过的区域，巨连通分支大小随参数变化的标度行为。",
            "id": "4297218",
            "problem": "考虑 Erdős–Rényi (ER) 随机图模型 $G(n,p)$，其中 $p=\\lambda/n$ 且 $n$ 很大，因此渐近度分布是均值为 $\\lambda$ 的泊松分布。在 $\\lambda1$ 的超临界状态下，一个巨连通分量占据了正比例的顶点。巨连通分量中的顶点比例 $\\rho$ 可以通过典型分量的探索过程，借助相关的泊松 Galton–Watson 分支过程以及度分布和超度分布的生成函数形式体系来获得。从这些基本原理出发，并利用相关分支过程的灭绝概率满足一个由超度生成函数确定的不动点关系这一事实，推导当 $\\lambda=1+\\epsilon$ 且 $0\\epsilon\\ll 1$ 时，巨连通分量中顶点比例 $\\rho$ 的领头阶渐近表达式。你的推导必须明确证明 $\\rho$ 随 $\\epsilon$ 的标度关系，然后计算 $\\epsilon$ 的第一个非平凡项。最终答案必须是关于领头阶渐近比例 $\\rho$ 的单个 $\\epsilon$ 的闭式表达式。不需要进行数值四舍五入。",
            "solution": "该问题要求在 Erdős–Rényi 图 $G(n,p)$ 中，当 $p=\\lambda/n$ 且 $\\lambda = 1+\\epsilon$（其中 $\\epsilon$ 为小的正数）时，推导巨连通分量中顶点比例 $\\rho$ 的领头阶渐近表达式。\n\n推导过程通过将巨连通分量的大小与描述顶点连通分量探索过程的 Galton-Watson 分支过程的性质联系起来。此分析的主要工具是生成函数形式体系。\n\n首先，我们定义相关的概率分布及其生成函数。在 $n$ 很大的极限下，$G(n, p=\\lambda/n)$ 中顶点的度分布是均值为 $\\lambda$ 的泊松分布：\n$$P(k) = e^{-\\lambda} \\frac{\\lambda^k}{k!}$$\n该度分布的生成函数 $G_0(x)$ 定义为 $G_0(x) = \\sum_{k=0}^{\\infty} P(k) x^k$。对于泊松分布，它是：\n$$G_0(x) = \\sum_{k=0}^{\\infty} e^{-\\lambda} \\frac{\\lambda^k}{k!} x^k = e^{-\\lambda} \\sum_{k=0}^{\\infty} \\frac{(\\lambda x)^k}{k!} = e^{-\\lambda} e^{\\lambda x} = \\exp(\\lambda(x-1))$$\n\n接下来，我们考虑探索过程。当我们通过遍历一条边到达一个顶点时，它的*其他*邻居的数量（其超度）遵循不同的分布。随机选择的一条边指向一个度为 $k$ 的顶点的概率与 $k P(k)$ 成正比。超度分布的生成函数 $G_1(x)$ 由下式给出：\n$$G_1(x) = \\frac{\\sum_{k=1}^{\\infty} k P(k) x^{k-1}}{\\sum_{k=1}^{\\infty} k P(k)}$$\n分母是平均度 $\\langle k \\rangle = \\lambda$。分子是度生成函数的导数 $G_0'(x)$。因此：\n$$G_1(x) = \\frac{G_0'(x)}{\\lambda}$$\n对于我们的泊松情况，$G_0'(x) = \\frac{d}{dx} \\exp(\\lambda(x-1)) = \\lambda \\exp(\\lambda(x-1))$。因此，超度生成函数为：\n$$G_1(x) = \\frac{\\lambda \\exp(\\lambda(x-1))}{\\lambda} = \\exp(\\lambda(x-1))$$\n泊松分布的一个关键性质是度生成函数和超度生成函数具有相同的形式：$G_0(x) = G_1(x)$。\n\n属于巨连通分量的顶点比例 $\\rho$ 是 $1$ 减去属于有限分量的顶点比例。一个顶点属于有限分量，当且仅当从它开始的分支过程灭绝。设 $u$ 为沿单条边进行的分量探索终止的概率，即从该边探索的子树是有限的。这个 $u$ 是一个分支过程的灭绝概率，其子代分布是超度分布。它由以下不动点方程的最小非负解给出：\n$$u = G_1(u)$$\n对于一个随机选择的度为 $k$ 的顶点，其整个分量是有限的，当且仅当沿其所有 $k$ 条边的探索都导向有限子树。这个概率是 $u^k$。为了找到随机选择的顶点位于有限分量中的总概率，我们对度分布 $P(k)$ 进行平均：\n$$1-\\rho = \\sum_{k=0}^{\\infty} P(k) u^k = G_0(u)$$\n这给出了巨连通分量比例的关系式：$\\rho = 1 - G_0(u)$。\n\n将这些结果结合到泊松 ER 图的特定情况中，我们利用 $G_0(x) = G_1(x)$ 这一事实。$u$ 的不动点方程变为 $u = G_0(u)$。将此代入 $\\rho$ 的表达式，我们发现 $\\rho$ 和 $u$ 之间存在直接关系：\n$$\\rho = 1 - G_0(u) = 1 - u$$\n因此，要找到 $\\rho$ 的渐近行为，我们需要找到灭绝概率 $u$ 的渐近行为。问题简化为在临界点附近求解 $u$ 的不动点方程。\n\n方程为 $u = \\exp(\\lambda(u-1))$。给定 $\\lambda = 1+\\epsilon$ 且 $0  \\epsilon \\ll 1$。对于 $\\lambda > 1$，除了平凡解 $u=1$之外，还存在一个唯一的解 $u \\in [0, 1)$。当 $\\epsilon \\to 0$ 时，这个解 $u$ 趋近于 $1$。我们可以通过写成 $u = 1-\\rho$ 来表达这一点，我们预期当 $\\epsilon$ 很小时，$\\rho$ 也很小。将 $u=1-\\rho$ 和 $\\lambda=1+\\epsilon$ 代入不动点方程：\n$$1 - \\rho = \\exp((1+\\epsilon)((1-\\rho)-1))$$\n$$1 - \\rho = \\exp(-(1+\\epsilon)\\rho)$$\n为了分析这个关于小 $\\epsilon$ 和 $\\rho$ 的方程，我们对右侧的指数函数进行泰勒展开。对于小自变量 $z$，$\\exp(z) = 1 + z + \\frac{z^2}{2} + O(z^3)$。在这里，自变量是 $z = -(1+\\epsilon)\\rho$。\n$$1 - \\rho = 1 - (1+\\epsilon)\\rho + \\frac{1}{2} (-(1+\\epsilon)\\rho)^2 + O(\\rho^3)$$\n$$1 - \\rho = 1 - (1+\\epsilon)\\rho + \\frac{1}{2} (1+\\epsilon)^2 \\rho^2 - O(\\rho^3)$$\n两边减去 $1$ 并重新整理各项：\n$$0 = -\\rho + (1+\\epsilon)\\rho - \\frac{1}{2}(1+\\epsilon)^2 \\rho^2 + O(\\rho^3)$$\n$$0 = \\epsilon\\rho - \\frac{1}{2}(1+\\epsilon)^2 \\rho^2 + O(\\rho^3)$$\n这个方程有两个关于 $\\rho$ 的解。一个是平凡解 $\\rho=0$，对应于 $u=1$（灭绝是必然的，没有巨连通分量）。我们对超临界状态的非平凡解感兴趣，所以我们可以除以 $\\rho$：\n$$0 = \\epsilon - \\frac{1}{2}(1+\\epsilon)^2 \\rho + O(\\rho^2)$$\n这个方程揭示了 $\\rho$ 和 $\\epsilon$ 之间的标度关系。为了使方程在 $\\epsilon \\to 0$ 时成立，$\\rho$ 也必须趋近于 $0$。为了找到领头阶行为，我们可以忽略 $\\epsilon$ 和 $\\rho$ 中的高阶项。方程变为：\n$$\\epsilon \\approx \\frac{1}{2}(1+O(\\epsilon))^2 \\rho \\approx \\frac{1}{2}\\rho$$\n这证明了该标度关系：$\\rho$ 与 $\\epsilon$ 是同阶的，具体来说 $\\rho \\propto \\epsilon$。\n\n为了找到第一个非平凡项，我们求解方程 $\\epsilon = \\frac{1}{2}(1+\\epsilon)^2 \\rho$ 以得到 $\\rho$：\n$$\\rho = \\frac{2\\epsilon}{(1+\\epsilon)^2}$$\n因为我们寻求的是关于小 $\\epsilon$ 的领头阶渐近表达式，我们可以展开分母 $(1+\\epsilon)^{-2} = 1 - 2\\epsilon + 3\\epsilon^2 - \\dots$：\n$$\\rho = 2\\epsilon(1 - 2\\epsilon + O(\\epsilon^2)) = 2\\epsilon - 4\\epsilon^2 + O(\\epsilon^3)$$\n因此，领头阶项，即 $\\rho$ 关于 $\\epsilon$ 幂次展开的第一个非平凡项，是 $2\\epsilon$。",
            "answer": "$$\\boxed{2\\epsilon}$$"
        }
    ]
}