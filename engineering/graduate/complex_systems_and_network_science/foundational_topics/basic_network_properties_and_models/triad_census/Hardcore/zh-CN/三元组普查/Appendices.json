{
    "hands_on_practices": [
        {
            "introduction": "掌握三元组普查的第一步是能够可靠地对任何给定的三节点子图进行分类。这项练习 () 旨在挑战你超越直观的视觉检查，基于节点的度数和互惠性指标等同构不变量，建立一个形式化的算法流程。这项实践将为你进行所有后续的三元组分析打下坚实的基础。",
            "id": "4312800",
            "problem": "考虑一个包含 $3$ 个已标记节点的有向简单图，图中无自环，且任意有序节点对之间最多只有一条有向边。这 $3$ 个节点上的导出子图可以归类为三元组普查（triad census）的 $16$ 个同构类之一，传统上用名称 $\\{003, 012, 102, 021D, 021U, 021C, 111D, 111U, 030T, 030C, 201, 120D, 120U, 120C, 210, 300\\}$ 表示。任务是构建一种算法，仅使用节点的入度和出度，以及无序节点对的互反性指标，将任意给定的 $3$ 节点有向导出子图分类到这 $16$ 个类别之一。\n\n基本基础。使用图论中的以下核心定义和事实作为基础出发点：\n- 一个有向简单图 $G = (V, E)$ 包含一个有限的节点集 $V$ 和一个有向边集 $E \\subseteq V \\times V$，图中无自环，且不同节点之间每个方向最多只有一条边。\n- 对于一个节点 $i \\in V$，其入度 $d_i^{in}$ 是形如 $(j, i) \\in E$ 的边的数量，其出度 $d_i^{out}$ 是形如 $(i, j) \\in E$ 的边的数量。\n- 对于任意不同的节点组成的无序对 $\\{i,j\\}$，定义互反性指标 $M_{ij}$：如果 $(i,j) \\in E$ 和 $(j,i) \\in E$ 同时成立，则 $M_{ij}$ 为 $1$，否则为 $0$。\n- 对于一个 $3$ 节点导出子图，存在 $3$ 个无序对（二元组）。每个二元组要么是空二元组（两个方向都没有边），要么是非对称二元组（恰好存在一条有向边），要么是互反二元组（两条有向边都存在）。令 $m$ 表示互反二元组的数量，$a$ 表示非对称二元组的数量，$n$ 表示空二元组的数量。则有 $m + a + n = 3$。有向边的总数 $|E|$ 满足 $$|E| = \\sum_{i=1}^{3} d_i^{out} = \\sum_{i=1}^{3} d_i^{in} = 2m + a,$$ 因为每个互反二元组贡献 $2$ 条有向边，每个非对称二元组贡献 $1$ 条有向边。\n\n设计目标。基于上述基础，推导出一个完整的决策过程，该过程仅使用每个节点的度对 $\\{(d_i^{in}, d_i^{out})\\}_{i=1}^{3}$ 和 $3$ 个无序对的互反性指标 $\\{M_{ij}\\}$，来识别 $3$ 节点导出子图唯一的三元组普查类别。该分类必须对于节点标签是同构不变的。\n\n输出规格。根据以下映射，使用整数标识符对 $16$ 个三元组类别进行编码：\n- $003 \\mapsto 0$\n- $012 \\mapsto 1$\n- $102 \\mapsto 2$\n- $021D \\mapsto 3$\n- $021U \\mapsto 4$\n- $021C \\mapsto 5$\n- $111D \\mapsto 6$\n- $111U \\mapsto 7$\n- $030T \\mapsto 8$\n- $030C \\mapsto 9$\n- $201 \\mapsto 10$\n- $120D \\mapsto 11$\n- $120U \\mapsto 12$\n- $120C \\mapsto 13$\n- $210 \\mapsto 14$\n- $300 \\mapsto 15$\n\n您的程序必须实现该分类算法，并将其应用于以下包含 $16$ 个导出子图的测试套件，每个子图由其在节点 $\\{1,2,3\\}$ 上的有向边集指定：\n- 测试 $1$：$\\varnothing$。\n- 测试 $2$：$\\{(1,2)\\}$。\n- 测试 $3$：$\\{(1,2),(2,1)\\}$。\n- 测试 $4$：$\\{(1,2),(1,3)\\}$。\n- 测试 $5$：$\\{(2,1),(3,1)\\}$。\n- 测试 $6$：$\\{(1,2),(2,3)\\}$。\n- 测试 $7$：$\\{(1,2),(2,1),(1,3)\\}$。\n- 测试 $8$：$\\{(1,2),(2,1),(3,1)\\}$。\n- 测试 $9$：$\\{(1,2),(1,3),(2,3)\\}$。\n- 测试 $10$：$\\{(1,2),(2,3),(3,1)\\}$。\n- 测试 $11$：$\\{(1,2),(2,1),(1,3),(3,1)\\}$。\n- 测试 $12$：$\\{(1,2),(2,1),(1,3),(2,3)\\}$。\n- 测试 $13$：$\\{(1,2),(2,1),(3,1),(3,2)\\}$。\n- 测试 $14$：$\\{(1,2),(2,1),(1,3),(3,2)\\}$。\n- 测试 $15$：$\\{(1,2),(2,1),(1,3),(3,1),(2,3)\\}$。\n- 测试 $16$：$\\{(1,2),(2,1),(1,3),(3,1),(2,3),(3,2)\\}$。\n\n最终输出格式要求。您的程序应生成单行输出，其中包含一个逗号分隔的列表，内含按测试 1 到 16 的顺序排列的 $16$ 个整数标识符，并用方括号括起来（例如 $[r_1,r_2,\\dots,r_{16}]$）。此问题不涉及物理单位或角度。程序必须在没有任何输入的情况下运行，并且不得访问外部文件或网络。如上所述，该算法的决策逻辑必须仅使用每个节点的度和互反性指标。",
            "solution": "### 步骤 1：提取已知信息\n问题为 $3$ 节点有向导出子图的分类提供了以下数据、定义和约束：\n- **图结构**：该图是一个包含 $3$ 个已标记节点的有向简单图。它没有自环，且任意有序节点对之间最多只有一条有向边。\n- **节点集**：$V = \\{1, 2, 3\\}$。\n- **入度和出度**：对于一个节点 $i \\in V$，其入度 $d_i^{in}$ 是入边的数量，其出度 $d_i^{out}$ 是出边的数量。\n- **互反性指标**：对于任意不同的节点组成的无序对 $\\{i,j\\}$，$M_{ij} = 1$ 如果 $(i,j)$ 和 $(j,i)$ 都是边，否则 $M_{ij} = 0$。\n- **二元组计数**：对于 $3$ 个二元组（无序节点对），$m$ 是互反二元组的数量，$a$ 是非对称二元组的数量，$n$ 是空二元组的数量。这些计数满足 $m + a + n = 3$。\n- **边计数关系**：有向边的总数 $|E|$ 由 $|E| = \\sum_{i=1}^{3} d_i^{out} = \\sum_{i=1}^{3} d_i^{in} = 2m + a$ 给出。\n- **设计目标**：分类算法必须仅使用每个节点的度对 $\\{(d_i^{in}, d_i^{out})\\}_{i=1}^{3}$ 和 $3$ 个无序对的互反性指标 $\\{M_{ij}\\}$。该分类必须是同构不变的。\n- **输出映射**：提供了一个从 $16$ 个三元组普查类别名称到整数标识符 $0$ 至 $15$ 的具体映射。\n- **测试套件**：提供了一个包含 $16$ 个测试用例的列表，每个用例由节点 $\\{1,2,3\\}$ 上的有向边集定义，用于验证。\n\n### 步骤 2：使用提取的已知信息进行验证\n根据验证标准对问题陈述进行评估：\n\n1.  **科学依据**：该问题植根于网络科学和图论这一成熟领域，特别涉及由 Holland 和 Leinhardt 开发的网络模体分析标准工具——三元组普查。所有定义（入度、出度、互反性）都是标准的。$3$ 节点有向图的 $16$ 个同构类的枚举是该领域的一个基础性成果。该问题具有科学合理性。\n2.  **适定性**：问题要求提供一种算法，将任何 $3$ 节点有向图唯一地分类到 $16$ 个不同的同构类之一。如下文所示，所提供的信息（度对和互反性指标）足以构建一个完整且明确的分类方案。因此，存在唯一且有意义的解。\n3.  **客观性**：问题使用精确、形式化的数学语言陈述。所有术语都有明确定义，目标清晰且可量化。没有主观或基于观点的内容。\n4.  **不完整或矛盾的设定**：问题是自洽的。所有必要的定义和约束均已提供。这些定义在内部是一致的（例如，边数、度和二元组计数之间的关系成立）。\n5.  **不切实际或不可行**：问题处理的是抽象的数学对象（图），不涉及物理约束。指定的任务在计算上是可行的。\n6.  **病态或结构不良**：问题结构良好。目标是找到一种同构不变的分类方法，而提供的输入（度和互反性）是可用于构造此类不变量的属性。\n7.  **伪深刻、微不足道或同义反复**：问题解决的是一个非平凡的分类任务。虽然解决方案是系统性的，但它需要仔细的推导来证明给定的信息基础是充分的，这构成了一个有效的概念性练习。\n8.  **超出科学可验证性范围**：问题及其解决方案完全属于数学领域，可以进行形式化验证。\n\n### 步骤 3：结论与行动\n此问题有效。这是一个适定、有科学依据且在图论中被形式化指定的任务。将提供解决方案。\n\n### 分类算法的推导\n\n目标是仅使用节点度和二元组互反性，为 $3$ 节点有向子图创建一个同构不变的分类程序。同构不变属性是指对于同一同构类中的所有图都相同的属性。\n\n设三个节点为 $v_1, v_2, v_3$。可用于分类的信息是度对集合 $\\{(d_1^{in}, d_1^{out}), (d_2^{in}, d_2^{out}), (d_3^{in}, d_3^{out})\\}$ 和互反性指标集合 $\\{M_{12}, M_{13}, M_{23}\\}$。\n\n为确保同构不变性，我们必须使用不依赖于节点任意标签的特征。我们可以如下构造这些特征：\n1.  **总互反数 ($m$)**：互反二元组的数量，$m = \\sum_{\\{i,j\\}} M_{ij}$，在节点重标记下是不变的。\n2.  **排序度序列**：度对的集合依赖于节点标签。然而，这些度对的排序列表是同构不变量。我们将按字典序对度对列表 $(d_i^{in}, d_i^{out})$ 进行排序。\n\n因此，任何三元组类别的唯一签名将是元组 $(m, \\text{SortedDegreePairs})$。我们将证明该签名唯一地标识了 $16$ 个三元组类别中的每一个。\n\n分类程序如下：\n1.  给定一个 $3$ 节点子图的边集，计算 $3$ 个节点中每个节点的入度和出度。\n2.  计算互反二元组的数量 $m$。\n3.  将三个 $(d^{in}, d^{out})$ 度对组成一个列表并按字典序排序。\n4.  $m$ 和排序后的度对列表的组合构成了一个唯一的键，该键直接映射到 $16$ 个三元组类别之一。\n\n我们现在系统地为 $16$ 个类别中的每一个推导其签名。这些类别按互反二元组的数量 $m \\in \\{0, 1, 2, 3\\}$ 进行分组。\n\n**情况 $m=0$（无互反二元组）**\n边的总数为 $|E| = a$。\n-   **类别 003 (ID 0)**：$a=0, n=3 \\implies |E|=0$。所有度均为 $(0,0)$。\n    -   签名：$m=0$，排序后的度：$((0,0), (0,0), (0,0))$。\n-   **类别 012 (ID 1)**：$a=1, n=2 \\implies |E|=1$。一条边 $(v_1, v_2)$。度：$d_1: (0,1)$，$d_2: (1,0)$，$d_3: (0,0)$。\n    -   签名：$m=0$，排序后的度：$((0,0), (0,1), (1,0))$。\n-   **类别 021 (IDs 3, 4, 5)**：$a=2, n=1 \\implies |E|=2$。\n    -   **021D (ID 3)**：“向下”结构，例如 $(v_1, v_2), (v_1, v_3)$。一个源节点。度：$d_1: (0,2)$，$d_2: (1,0)$，$d_3: (1,0)$。\n        -   签名：$m=0$，排序后的度：$((0,2), (1,0), (1,0))$。\n    -   **021U (ID 4)**：“向上”结构，例如 $(v_2, v_1), (v_3, v_1)$。一个汇节点。度：$d_1: (2,0)$，$d_2: (0,1)$，$d_3: (0,1)$。\n        -   签名：$m=0$，排序后的度：$((0,1), (0,1), (2,0))$。\n    -   **021C (ID 5)**：“循环”路径，例如 $(v_1, v_2), (v_2, v_3)$。度：$d_1: (0,1)$，$d_2: (1,1)$，$d_3: (1,0)$。\n        -   签名：$m=0$，排序后的度：$((0,1), (1,0), (1,1))$。\n-   **类别 030 (IDs 8, 9)**：$a=3, n=0 \\implies |E|=3$。\n    -   **030T (ID 8)**：传递性竞赛图，例如 $(v_1,v_2), (v_2,v_3), (v_1,v_3)$。度：$d_1: (0,2)$，$d_2: (1,1)$，$d_3: (2,0)$。\n        -   签名：$m=0$，排序后的度：$((0,2), (1,1), (2,0))$。\n    -   **030C (ID 9)**：循环竞赛图，例如 $(v_1,v_2), (v_2,v_3), (v_3,v_1)$。度：$d_1: (1,1)$，$d_2: (1,1)$，$d_3: (1,1)$。\n        -   签名：$m=0$，排序后的度：$((1,1), (1,1), (1,1))$。\n\n**情况 $m=1$（一个互反二元组）**\n边的总数为 $|E| = 2+a$。\n-   **类别 102 (ID 2)**：$a=0, n=2 \\implies |E|=2$。一个互反二元组，例如 $(v_1,v_2), (v_2,v_1)$。度：$d_1: (1,1)$，$d_2: (1,1)$，$d_3: (0,0)$。\n    -   签名：$m=1$，排序后的度：$((0,0), (1,1), (1,1))$。\n-   **类别 111 (IDs 6, 7)**：$a=1, n=1 \\implies |E|=3$。\n    -   **111D (ID 6)**：互反二元组 + 出边，例如 $(v_1,v_2), (v_2,v_1), (v_1,v_3)$。度：$d_1: (1,2)$，$d_2: (1,1)$，$d_3: (1,0)$。\n        -   签名：$m=1$，排序后的度：$((1,0), (1,1), (1,2))$。\n    -   **111U (ID 7)**：互反二元组 + 入边，例如 $(v_1,v_2), (v_2,v_1), (v_3,v_1)$。度：$d_1: (2,1)$，$d_2: (1,1)$，$d_3: (0,1)$。\n        -   签名：$m=1$，排序后的度：$((0,1), (1,1), (2,1))$。\n-   **类别 120 (IDs 11, 12, 13)**：$a=2, n=0 \\implies |E|=4$。\n    -   **120D (ID 11)**：互反二元组 + 两条出边，例如 $(v_1,v_2), (v_2,v_1), (v_1,v_3), (v_2,v_3)$。度：$d_1: (1,2)$，$d_2: (1,2)$，$d_3: (2,0)$。\n        -   签名：$m=1$，排序后的度：$((1,2), (1,2), (2,0))$。\n    -   **120U (ID 12)**：互反二元组 + 两条入边，例如 $(v_1,v_2), (v_2,v_1), (v_3,v_1), (v_3,v_2)$。度：$d_1: (2,1)$，$d_2: (2,1)$，$d_3: (0,2)$。\n        -   签名：$m=1$，排序后的度：$((0,2), (2,1), (2,1))$。\n    -   **120C (ID 13)**：互反二元组 + 路径，例如 $(v_1,v_2), (v_2,v_1), (v_1,v_3), (v_3,v_2)$。度：$d_1: (1,2)$，$d_2: (2,1)$，$d_3: (1,1)$。\n        -   签名：$m=1$，排序后的度：$((1,1), (1,2), (2,1))$。\n\n**情况 $m=2$（两个互反二元组）**\n边的总数为 $|E| = 4+a$。\n-   **类别 201 (ID 10)**：$a=0, n=1 \\implies |E|=4$。例如 $(v_1,v_2), (v_2,v_1), (v_1,v_3), (v_3,v_1)$。枢纽节点 $v_1$。度：$d_1: (2,2)$，$d_2: (1,1)$，$d_3: (1,1)$。\n    -   签名：$m=2$，排序后的度：$((1,1), (1,1), (2,2))$。\n-   **类别 210 (ID 14)**：$a=1, n=0 \\implies |E|=5$。两个互反二元组 + 一条非对称边，例如 $(v_1,v_2), (v_2,v_1), (v_1,v_3), (v_3,v_1), (v_2,v_3)$。度：$d_1: (2,2)$，$d_2: (1,2)$，$d_3: (2,1)$。\n    -   签名：$m=2$，排序后的度：$((1,2), (2,1), (2,2))$。\n\n**情况 $m=3$（三个互反二元组）**\n-   **类别 300 (ID 15)**：$a=0, n=0 \\implies |E|=6$。完全有向图。度：$d_1, d_2, d_3$ 均为 $(2,2)$。\n    -   签名：$m=3$，排序后的度：$((2,2), (2,2), (2,2))$。\n\n此分析证实，签名 $(m, \\text{SortedDegreePairs})$ 对于 $16$ 个同构类中的每一个都是唯一的。算法可以预先计算这些签名并将其存储在查找表中，以实现高效分类。实现部分将构建此查找表，用于将测试图计算出的签名映射到其对应的整数 ID。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the triad census classification problem for the given test suite.\n    \"\"\"\n\n    # Mapping from triad census names to the specified integer IDs.\n    CLASS_TO_ID = {\n        '003': 0, '012': 1, '102': 2, '021D': 3, '021U': 4,\n        '021C': 5, '111D': 6, '111U': 7, '030T': 8, '030C': 9,\n        '201': 10, '120D': 11, '120U': 12, '120C': 13, '210': 14,\n        '300': 15\n    }\n\n    # This signature map is the core of the classification algorithm.\n    # It maps the unique signature (m, sorted_degree_pairs) to a triad class ID.\n    # The degree pairs are sorted lexicographically.\n    SIGNATURE_TO_ID = {\n        # m = 0\n        (0, ((0, 0), (0, 0), (0, 0))): CLASS_TO_ID['003'],\n        (0, ((0, 0), (0, 1), (1, 0))): CLASS_TO_ID['012'],\n        (0, ((0, 2), (1, 0), (1, 0))): CLASS_TO_ID['021D'],\n        (0, ((0, 1), (0, 1), (2, 0))): CLASS_TO_ID['021U'],\n        (0, ((0, 1), (1, 0), (1, 1))): CLASS_TO_ID['021C'],\n        (0, ((0, 2), (1, 1), (2, 0))): CLASS_TO_ID['030T'],\n        (0, ((1, 1), (1, 1), (1, 1))): CLASS_TO_ID['030C'],\n        # m = 1\n        (1, ((0, 0), (1, 1), (1, 1))): CLASS_TO_ID['102'],\n        (1, ((1, 0), (1, 1), (1, 2))): CLASS_TO_ID['111D'],\n        (1, ((0, 1), (1, 1), (2, 1))): CLASS_TO_ID['111U'],\n        (1, ((1, 2), (1, 2), (2, 0))): CLASS_TO_ID['120D'],\n        (1, ((0, 2), (2, 1), (2, 1))): CLASS_TO_ID['120U'],\n        (1, ((1, 1), (1, 2), (2, 1))): CLASS_TO_ID['120C'],\n        # m = 2\n        (2, ((1, 1), (1, 1), (2, 2))): CLASS_TO_ID['201'],\n        (2, ((1, 2), (2, 1), (2, 2))): CLASS_TO_ID['210'],\n        # m = 3\n        (3, ((2, 2), (2, 2), (2, 2))): CLASS_TO_ID['300'],\n    }\n\n    def classify_triad(edges):\n        \"\"\"\n        Classifies a 3-node directed graph based on its edge set.\n        The algorithm uses only node degrees and mutuality indicators as required.\n        Nodes are assumed to be 1, 2, 3 as in the problem, but are mapped to\n        0, 1, 2 for array indexing.\n        \"\"\"\n        num_nodes = 3\n        adj = np.zeros((num_nodes, num_nodes), dtype=int)\n        for u, v in edges:\n            if 1 = u = num_nodes and 1 = v = num_nodes:\n                adj[u - 1, v - 1] = 1\n\n        # Calculate in-degrees and out-degrees for each node.\n        # axis=0 sums columns (incoming edges), axis=1 sums rows (outgoing edges).\n        in_degrees = adj.sum(axis=0)\n        out_degrees = adj.sum(axis=1)\n\n        degree_pairs = []\n        for i in range(num_nodes):\n            degree_pairs.append((in_degrees[i], out_degrees[i]))\n\n        # Sort the degree pairs to create an isomorphism-invariant feature.\n        # Python's default tuple sorting is lexicographical.\n        degree_pairs.sort()\n        \n        # Calculate mutuality indicators and the total count of mutual dyads (m).\n        m = 0\n        node_indices = range(num_nodes)\n        for i in node_indices:\n            for j in range(i + 1, num_nodes):\n                if adj[i, j] == 1 and adj[j, i] == 1:\n                    m += 1\n\n        # The signature is the tuple of m and the sorted degree pairs.\n        # The list of pairs must be converted to a tuple to be a dictionary key.\n        signature = (m, tuple(degree_pairs))\n\n        # Look up the signature to get the class ID.\n        return SIGNATURE_TO_ID.get(signature)\n\n    # Test suite from the problem statement.\n    test_cases = [\n        set(),                                             # Test 1: 003\n        {(1, 2)},                                          # Test 2: 012\n        {(1, 2), (2, 1)},                                  # Test 3: 102\n        {(1, 2), (1, 3)},                                  # Test 4: 021D\n        {(2, 1), (3, 1)},                                  # Test 5: 021U\n        {(1, 2), (2, 3)},                                  # Test 6: 021C\n        {(1, 2), (2, 1), (1, 3)},                          # Test 7: 111D\n        {(1, 2), (2, 1), (3, 1)},                          # Test 8: 111U\n        {(1, 2), (1, 3), (2, 3)},                          # Test 9: 030T\n        {(1, 2), (2, 3), (3, 1)},                          # Test 10: 030C\n        {(1, 2), (2, 1), (1, 3), (3, 1)},                  # Test 11: 201\n        {(1, 2), (2, 1), (1, 3), (2, 3)},                  # Test 12: 120D\n        {(1, 2), (2, 1), (3, 1), (3, 2)},                  # Test 13: 120U\n        {(1, 2), (2, 1), (1, 3), (3, 2)},                  # Test 14: 120C\n        {(1, 2), (2, 1), (1, 3), (3, 1), (2, 3)},          # Test 15: 210\n        {(1, 2), (2, 1), (1, 3), (3, 1), (2, 3), (3, 2)},  # Test 16: 300\n    ]\n\n    results = []\n    for case in test_cases:\n        result_id = classify_triad(case)\n        results.append(str(result_id))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在学会了如何对三元组进行分类之后，网络科学中的一个关键问题是理解它们在不同类型网络中的普遍程度。这项练习 () 让你踏出统计分析的第一步，通过计算经典的 Erdős–Rényi 随机图模型中特定三元组（021D 和 021U）的期望数量。它将向你介绍一些基本技巧，例如使用期望的线性性质和对称性论证。",
            "id": "4312773",
            "problem": "考虑一个有向Erdős–Rényi (ER) 随机图 $G_{n,p}$，它建立在 $n$ 个已标记顶点上，其中对于任意一对不同的顶点 $(i,j)$（$i \\neq j$），一条有向边（弧）$i \\to j$ 以概率 $p \\in (0,1)$ 独立存在。在有向三元组普查中，$021\\mathrm{D}$ 类指的是由三个顶点构成的诱导三元组，其中恰好包含两条弧，这两条弧均从同一个顶点发出，指向另外两个顶点（一个出星形），且这三个顶点之间没有其他弧；$021\\mathrm{U}$ 类指的是包含两条弧的诱导三元组，这两条弧均从另外两个顶点指向同一个顶点（一个入星形），且这三个顶点之间没有其他弧。令 $X_{021\\mathrm{D}}$ 和 $X_{021\\mathrm{U}}$ 分别表示随机变量，用于计数 $G_{n,p}$ 中与 $021\\mathrm{D}$ 和 $021\\mathrm{U}$ 同构的三元顶点组上的诱导子图的数量。\n\n从ER模型在边方向反转下的对称性以及边的独立性出发，证明 $\\mathbb{E}[X_{021\\mathrm{D}}] = \\mathbb{E}[X_{021\\mathrm{U}}]$，并推导出它们的共同期望值，表示为关于 $n$ 和 $p$ 的闭式解析表达式。将你的最终答案表示为单个符号表达式。不需要数值近似。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、良构且客观。\n\n### 步骤 1：提取已知条件\n- **图模型**：有向Erdős–Rényi随机图 $G_{n,p}$，建立在 $n$ 个已标记顶点上。\n- **边规则**：对于任意有序的不同顶点对 $(i,j)$，弧 $i \\to j$ 以概率 $p \\in (0,1)$ 独立存在。\n- **三元组类别 $021\\mathrm{D}$**：一个三顶点上的诱导子图，恰好有两条弧，形成一个出星形（例如，$i \\to j$, $i \\to k$，且 $i,j,k$ 之间没有其他弧）。\n- **三元组类别 $021\\mathrm{U}$**：一个三顶点上的诱导子图，恰好有两条弧，形成一个入星形（例如，$j \\to i$, $k \\to i$，且 $i,j,k$ 之间没有其他弧）。\n- **随机变量**：$X_{021\\mathrm{D}}$ 和 $X_{021\\mathrm{U}}$ 分别是这些诱导子图的计数。\n- **目标**：\n    1. 利用对称性证明 $\\mathbb{E}[X_{021\\mathrm{D}}] = \\mathbb{E}[X_{021\\mathrm{U}}]$。\n    2. 推导出这个共同期望值，作为关于 $n$ 和 $p$ 的闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题设定在随机图论的既定数学框架内。模型（$G_{n,p}$）、研究对象（三元组普查）和目标（计算期望值）在复杂系统和网络科学中都是标准且明确定义的。$021\\mathrm{D}$ 和 $021\\mathrm{U}$ 三元组类别的定义是精确且标准的。该问题是自洽的，所有必要的参数（$n, p$）和定义均已提供。不存在矛盾、歧义或违反科学原理的情况。\n\n### 步骤 3：结论与行动\n此问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n\n根据问题陈述的要求，解答分为两部分。\n\n**第一部分：利用对称性证明期望相等**\n\n令 $G = (V, E)$ 是有向 Erdős–Rényi 随机图 $G_{n,p}$ 的一个实现，其中 $V$ 是 $n$ 个顶点的集合，$E$ 是有向边（弧）的集合。对于任意一对不同的有序顶点 $(i,j)$，弧 $i \\to j$ 存在于 $E$ 中的概率为 $P(i \\to j) = p$，对所有顶点对均独立。\n\n考虑一个图变换，该变换反转每条弧的方向。令 $G' = (V, E')$ 为一个图，其中当且仅当弧 $i \\to j$ 存在于 $E$ 中时，弧 $j \\to i$ 才存在于 $E'$ 中。$G'$ 中任何特定弧构型的概率都可以与 $G$ 中相应的反转构型的概率相关联。\n\n在 $G'$ 中弧 $j \\to i$ 存在的概率为 $P(j \\to i \\in E') = P(i \\to j \\in E) = p$。由于 $G$ 中各条弧的选择是独立的，因此 $G'$ 中各条弧的选择也是独立的。因此，反转后的图 $G'$ 也是来自同一随机图系综 $G_{n,p}$ 的一个实现。这意味着在所有可能图的空间上的概率分布对于 $G$ 和 $G'$ 是相同的。因此，任何图属性的期望对于这两个分布都是相同的。\n\n现在，考虑在这种反转变换下三元组类型之间的关系。假设一组三个顶点 $\\{u,v,w\\}$ 在 $G$ 中形成一个 $021\\mathrm{D}$ 类型的诱导子图。不失一般性地，令 $u$ 为中心，则弧为 $u \\to v$ 和 $u \\to w$。根据诱导子图的定义，这三个顶点之间没有其他弧。当我们反转所有弧得到 $G'$ 时，这个特定三元顶点组上的弧变为 $v \\to u$ 和 $w \\to u$，且它们之间没有其他弧。这个构型恰好是 $G'$ 中一个以 $u$ 为中心的 $021\\mathrm{U}$ 类型的诱导子图。\n\n这建立了一一对应关系：实例 $G$ 中的每个 $021\\mathrm{D}$ 型诱导三元组都精确对应于反转实例 $G'$ 中的一个 $021\\mathrm{U}$ 型诱导三元组。因此，$G$ 中 $021\\mathrm{D}$ 型三元组的数量（记为 $X_{021\\mathrm{D}}(G)$）等于 $G'$ 中 $021\\mathrm{U}$ 型三元组的数量（记为 $X_{021\\mathrm{U}}(G')$）。我们有 $X_{021\\mathrm{D}}(G) = X_{021\\mathrm{U}}(G')$。\n\n由于 $G$ 和 $G'$ 是从相同的概率分布中抽取的，定义在它们之上的任何随机变量的期望都是相同的。因此，\n$$\n\\mathbb{E}[X_{021\\mathrm{D}}] = \\mathbb{E}_G[X_{021\\mathrm{D}}(G)] = \\mathbb{E}_{G'}[X_{021\\mathrm{U}}(G')] = \\mathbb{E}[X_{021\\mathrm{U}}]\n$$\n这证明了 $021\\mathrm{D}$ 和 $021\\mathrm{U}$ 型三元组的期望数量是相等的。\n\n**第二部分：共同期望值的推导**\n\n我们将计算期望值 $\\mathbb{E}[X_{021\\mathrm{D}}]$。$\\mathbb{E}[X_{021\\mathrm{U}}]$ 的结果将是相同的。\n\n我们使用指示变量法和期望的线性性。令顶点集为 $V = \\{1, 2, \\dots, n\\}$。令 $\\mathcal{T}$ 为从 $V$ 中取出的所有不同顶点的无序三元组的集合。这种三元组的数量为 $|\\mathcal{T}| = \\binom{n}{3}$。\n\n对于每个顶点三元组 $T = \\{i, j, k\\} \\in \\mathcal{T}$，令 $I_T$ 为一个指示随机变量，如果顶点 $\\{i,j,k\\}$ 上的诱导子图是 $021\\mathrm{D}$ 型，则 $I_T = 1$，否则 $I_T = 0$。\n\n$021\\mathrm{D}$ 型三元组的总数是这些指示变量在所有可能的三元组上的总和：\n$$\nX_{021\\mathrm{D}} = \\sum_{T \\in \\mathcal{T}} I_T\n$$\n根据期望的线性性，期望值为：\n$$\n\\mathbb{E}[X_{021\\mathrm{D}}] = \\mathbb{E}\\left[\\sum_{T \\in \\mathcal{T}} I_T\\right] = \\sum_{T \\in \\mathcal{T}} \\mathbb{E}[I_T]\n$$\n指示变量的期望是它所指示事件的概率：$\\mathbb{E}[I_T] = P(I_T = 1)$。由于 $G_{n,p}$ 模型的对称性，这个概率对于所有的三元组 $T$ 都是相同的。我们来计算一个一般三元组 $\\{i, j, k\\}$ 的这个概率。\n\n要使 $\\{i, j, k\\}$ 上的诱导子图为 $021\\mathrm{D}$ 型，必须有一个顶点是两条弧的“源点”，且这三个顶点之间不能存在其他弧。有 $3$ 种选择哪个顶点作为源点。\n我们首先假设顶点 $i$ 是源点。这需要以下弧构型：\n1. 弧 $i \\to j$ 必须存在。概率为 $p$。\n2. 弧 $i \\to k$ 必须存在。概率为 $p$。\n3. 弧 $j \\to i$ 必须*不*存在。概率为 $1-p$。\n4. 弧 $k \\to i$ 必须*不*存在。概率为 $1-p$。\n5. 弧 $j \\to k$ 必须*不*存在。概率为 $1-p$。\n6. 弧 $k \\to j$ 必须*不*存在。概率为 $1-p$。\n\n在3个顶点之间，有 $\\binom{3}{2} \\times 2 = 6$ 条可能的有向弧。对于以 $i$ 为中心的诱导 $021\\mathrm{D}$ 三元组的特定情况，这6条潜在的弧中必须恰好有2条存在，另外4条必须不存在。由于每条弧的存在是一个独立事件，这种特定构型（以 $i$ 为中心）的概率是各个概率的乘积：\n$$\nP(\\text{中心是 } i) = p \\cdot p \\cdot (1-p) \\cdot (1-p) \\cdot (1-p) \\cdot (1-p) = p^2 (1-p)^4\n$$\n对于 $\\{i,j,k\\}$ 上的诱导子图而言，“中心是 $i$”、“中心是 $j$”和“中心是 $k$”这三个事件是互斥的。例如，如果中心是 $i$，弧 $j \\to i$ 必须不存在；如果中心是 $j$，弧 $j \\to i$ 就必须存在。因此，三元组 $\\{i, j, k\\}$ 形成一个 $021\\mathrm{D}$ 型三元组的总概率是这三种构型概率的总和：\n$$\nP(I_T=1) = P(\\text{中心是 } i) + P(\\text{中心是 } j) + P(\\text{中心是 } k) = 3 p^2 (1-p)^4\n$$\n现在我们可以计算总期望：\n$$\n\\mathbb{E}[X_{021\\mathrm{D}}] = \\sum_{T \\in \\mathcal{T}} P(I_T=1) = |\\mathcal{T}| \\times (3 p^2 (1-p)^4)\n$$\n代入 $|\\mathcal{T}| = \\binom{n}{3}$：\n$$\n\\mathbb{E}[X_{021\\mathrm{D}}] = \\binom{n}{3} \\cdot 3 p^2 (1-p)^4\n$$\n展开二项式系数 $\\binom{n}{3} = \\frac{n(n-1)(n-2)}{3 \\cdot 2 \\cdot 1} = \\frac{n(n-1)(n-2)}{6}$：\n$$\n\\mathbb{E}[X_{021\\mathrm{D}}] = \\frac{n(n-1)(n-2)}{6} \\cdot 3 p^2 (1-p)^4 = \\frac{n(n-1)(n-2)}{2} p^2 (1-p)^4\n$$\n这就是 $X_{021\\mathrm{D}}$ 和 $X_{021\\mathrm{U}}$ 的共同期望值。",
            "answer": "$$\n\\boxed{\\frac{n(n-1)(n-2)}{2} p^2 (1-p)^4}\n$$"
        },
        {
            "introduction": "识别网络模体（motif）需要将观察到的三元组数量与在适当的零模型中预期的数量进行比较。这项练习 () 通过对比两种不同的零模型，让你深入审视“适当”这一概念。它将展示零模型的选择不仅仅是一个技术细节，而是能够从根本上改变关于一个模式是显著过多还是过少的科学结论。",
            "id": "4312795",
            "problem": "考虑一个具有 $n=60$ 个顶点的有向简单网络。三元组普查（triad census）统计有向网络中3节点子图的同构类数量。前馈环路（feed-forward loop, FFL）三元组是一种传递性有向三元组，它由三个节点构成，包含弧 $A \\to B$、$A \\to C$ 和 $B \\to C$，且没有互易弧；在标准三元组普查表示法中，这类通常记为 $030\\mathrm{T}$。给定该网络的以下全局统计数据：\n- 对于任意有序的不同节点对，存在一条弧的边际概率为 $p=0.25$，因此每个无序二元组（节点对）的期望弧数为 $d=2p=0.5$。\n- 无序节点对的二元组状态分布为：互易二元组概率 $m=0.18$（两个方向的弧都存在），非对称二元组概率 $a=0.14$（恰好存在一个方向的弧），以及空二元组概率 $u=0.68$（两个方向都没有弧），因此满足 $2m+a=d$。\n- 观测到的 FFL 三元组数量为 $T_{\\mathrm{obs}}=300$。\n\n考虑两种零模型：\n- 零模型 $\\mathcal{N}_1$：有向 Erdős–Rényi (ER) 模型，其中每个可能的有向弧以概率 $p$ 独立存在，二元组状态由独立的弧生成。\n- 零模型 $\\mathcal{N}_2$：保持互易性的二元组独立模型，其中每个无序二元组以概率 $m$、$a$、$u$ 被独立地赋予一个状态，对于非对称二元组，其方向在两个可能方向上等可能，且在不同二元组之间是独立的。\n\n仅从三元组普查的核心定义、零模型中的独立性假设以及初等概率论出发，推导在每种零模型下，一个给定的三节点组形成 FFL 三元组的期望概率，并由此得出 FFL 三元组的期望数量。利用这些结果评估与每种零模型相比，FFL 是过表达还是欠表达。为使评估量化，通过将不同的三节点组视为具有所推导出的 FFL 概率的独立伯努利试验，来近似每种零模型下三元组计数的方差，并计算相应的 z-分数 $z=(T_{\\mathrm{obs}}-\\mathbb{E}[T])/\\sqrt{\\mathrm{Var}(T)}$。\n\n哪个选项正确地给出了期望数量、表达评估，并证明了一个不恰当的零模型（此处为 $\\mathcal{N}_1$）相对于一个更恰当的零模型（$\\mathcal{N}_2$）可以颠倒过表达/欠表达的符号？\n\nA. 在 $p=0.25$ 的零模型 $\\mathcal{N}_1$ 下，期望的 FFL 数量为 $\\binom{60}{3}\\cdot 6p^3(1-p)^3\\approx 1353$，呈现欠表达，z-分数约为 $-29$。在 $a=0.14$ 的零模型 $\\mathcal{N}_2$ 下，期望的 FFL 数量为 $\\binom{60}{3}\\cdot \\tfrac{3}{4}a^3\\approx 70$，呈现过表达，z-分数约为 $27$，因此两种零模型下的表达符号相反。\n\nB. 在零模型 $\\mathcal{N}_1$ 下，期望的 FFL 数量为 $\\binom{60}{3}\\cdot p^3(1-p)^3\\approx 226$，在零模型 $\\mathcal{N}_2$ 下为 $\\binom{60}{3}\\cdot \\tfrac{1}{2}a^3\\approx 130$；两种情况下 FFL 相对于期望都是过表达的。\n\nC. 在零模型 $\\mathcal{N}_1$ 下，期望的 FFL 数量为 $\\binom{60}{3}\\cdot 2p^3(1-p)^3\\approx 451$，而在零模型 $\\mathcal{N}_2$ 下为 $\\binom{60}{3}\\cdot \\tfrac{3}{4}a^2\\approx 504$；两种情况下 FFL 都是欠表达的。\n\nD. FFL 的期望概率与互易性无关，在任何匹配 $p$ 的零模型下都等于 $6p^3(1-p)^3$；由于 $T_{\\mathrm{obs}}=300$，它在两种零模型下都是欠表达的。",
            "solution": "用户要求我分析一个关于有向网络中前馈环路（FFL）三元组模体的问题。我将首先验证问题陈述，如果有效，则继续进行完整推导和对给定选项的评估。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n- 网络类型：有向简单网络\n- 顶点数：$n=60$\n- 关注的模体：前馈环路（FFL），一种传递性有向三元组，包含弧 $A \\to B$、$A \\to C$ 和 $B \\to C$，且没有互易弧。这对应于三元组同构类 $030\\mathrm{T}$。\n- 全局网络统计数据：\n    - 边际弧概率：$p=0.25$\n    - 每个无序二元组的期望弧数：$d=2p=0.5$\n    - 无序节点对的二元组状态概率：\n        - 互易二元组概率 ($m$)：$m=0.18$\n        - 非对称二元组概率 ($a$)：$a=0.14$\n        - 空二元组概率 ($u$)：$u=0.68$\n    - 提供的一致性检查：$2m+a = 2(0.18) + 0.14 = 0.36 + 0.14 = 0.50 = d$，满足条件。同时，概率之和为 1：$m+a+u = 0.18+0.14+0.68=1.0$。\n- 观测到的 FFL 三元组数量：$T_{\\mathrm{obs}}=300$\n- 用于比较的零模型：\n    - $\\mathcal{N}_1$：有向 Erdős–Rényi (ER) 模型，其中 $n(n-1)$ 个可能的有向弧中的每一个都以概率 $p=0.25$ 独立存在。\n    - $\\mathcal{N}_2$：保持互易性的二元组独立模型，其中 $\\binom{n}{2}$ 个无序二元组中的每一个都以概率 $m, a, u$ 独立地被赋予一个状态（互易、非对称、空）。对于非对称二元组，单弧的方向以 $1/2$ 的概率选择两个可能性中的一个。\n- 任务：推导每种零模型下 FFL 的期望数量 $\\mathbb{E}[T]$。通过计算 z-分数 $z=(T_{\\mathrm{obs}}-\\mathbb{E}[T])/\\sqrt{\\mathrm{Var}(T)}$ 来评估 FFL 模体的过表达/欠表达情况，其中近似认为不同的三节点组是独立的伯努利试验。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n- **科学基础：** 该问题深深植根于网络科学，特别是在网络模体分析领域。三元组普查、FFL、Erdős–Rényi 模型和配置模型（如 $\\mathcal{N}_2$）等概念都是该领域的标准内容。\n- **定义明确：** 该问题是定义明确的。所有必要的参数（$n, p, m, a, u, T_{\\mathrm{obs}}$）都已提供，并且零模型被精确定义。任务要求计算具体的、可计算的量。\n- **客观性：** 语言是客观和技术性的。\n- **一致性：** 如第 1 步所示，提供的数值（$p, m, a, u$）内部是一致的。\n- **缺陷检查：** 该问题没有违反任何无效性标准。这是一个标准的、非平凡的网络概率分析练习，突出了零模型选择的关键作用。\n\n**第 3 步：结论与行动**\n\n问题陈述有效。我将继续进行推导。\n\n### 推导与解答\n\n网络中不同三节点组的总数为 $N_{triples} = \\binom{n}{3}$。当 $n=60$ 时，该值为：\n$$ \\binom{60}{3} = \\frac{60 \\times 59 \\times 58}{3 \\times 2 \\times 1} = 10 \\times 59 \\times 58 = 34220 $$\n\nFFL 是一种在三个节点上的特定类型的导出子图。问题将其定义为 $030\\mathrm{T}$ 类的传递性有向三元组，这意味着恰好有三条有向边形成一个传递模式（例如，$A \\to B, B \\to C, A \\to C$），且这三个节点之间没有其他边。这意味着连接这些节点的三个二元组必须都是非对称的。\n\n**在零模型 $\\mathcal{N}_1$（有向 ER 模型）下的分析**\n\n在 $\\mathcal{N}_1$ 下，每个可能的 $n(n-1)$ 个有向弧都以概率 $p=0.25$ 独立存在。对于一个给定的三节点组，比如说 $\\{V_1, V_2, V_3\\}$，存在 $2\\binom{3}{2}=6$ 个可能的有向弧。\n\n要形成一个 FFL，我们需要恰好 3 条弧形成一个传递模式，并且另外 3 条潜在的弧必须不存在。让我们考虑一个特定的 FFL 配置，例如 $V_1 \\to V_2, V_1 \\to V_3, V_2 \\to V_3$。这需要以下六个独立事件：\n1.  弧 $V_1 \\to V_2$ 存在（概率 $p$）\n2.  弧 $V_2 \\to V_1$ 不存在（概率 $1-p$）\n3.  弧 $V_1 \\to V_3$ 存在（概率 $p$）\n4.  弧 $V_3 \\to V_1$ 不存在（概率 $1-p$）\n5.  弧 $V_2 \\to V_3$ 存在（概率 $p$）\n6.  弧 $V_3 \\to V_2$ 不存在（概率 $1-p$）\n\n这个特定配置的概率是 $p^3(1-p)^3$。\n\n对于任意给定的三节点组，有多种方式可以形成 FFL。一个 FFL 有一个唯一的“源”节点（出度为 2）、“中间”节点（入度为 1，出度为 1）和“汇”节点（入度为 2）。我们可以从 3 个节点中选择源节点，从剩下的 2 个节点中选择汇节点，最后一个就是中间节点。这就在一个标记的三节点组上给出了 $3 \\times 2 \\times 1 = 3! = 6$ 种可能的、互斥的 FFL 配置。\n\n一个随机选择的三节点组形成 FFL 的概率 $P_{FFL}(\\mathcal{N}_1)$ 是这 6 种配置的概率之和：\n$$ P_{FFL}(\\mathcal{N}_1) = 6 \\cdot p^3(1-p)^3 $$\nFFL 的期望数量 $\\mathbb{E}[T_{\\mathcal{N}_1}]$ 是三节点组总数乘以这个概率：\n$$ \\mathbb{E}[T_{\\mathcal{N}_1}] = \\binom{n}{3} \\cdot 6 p^3(1-p)^3 $$\n使用给定值 $n=60$ 和 $p=0.25$：\n$$ \\mathbb{E}[T_{\\mathcal{N}_1}] = 34220 \\cdot 6 \\cdot (0.25)^3 (1-0.25)^3 = 34220 \\cdot 6 \\cdot \\left(\\frac{1}{4}\\right)^3 \\left(\\frac{3}{4}\\right)^3 = 34220 \\cdot 6 \\cdot \\frac{27}{4096} = 34220 \\cdot \\frac{162}{4096} \\approx 1353.18 $$\n观测数量为 $T_{\\mathrm{obs}}=300$，远低于期望数量 $\\approx 1353$。因此，相对于 $\\mathcal{N}_1$，FFL 是**欠表达**的。\n\n为了计算 z-分数，我们近似方差为 $\\mathrm{Var}(T) \\approx N_{triples} P_{FFL} (1-P_{FFL}) \\approx \\mathbb{E}[T] (1-P_{FFL})$。\n$$ P_{FFL}(\\mathcal{N}_1) = 6 \\cdot \\frac{27}{4096} \\approx 0.03955 $$\n$$ \\mathrm{Var}(T_{\\mathcal{N}_1}) \\approx 1353.18 \\cdot (1 - 0.03955) \\approx 1299.66 $$\n$$ \\sigma_{\\mathcal{N}_1} = \\sqrt{\\mathrm{Var}(T_{\\mathcal{N}_1})} \\approx \\sqrt{1299.66} \\approx 36.05 $$\nz-分数为：\n$$ z_1 = \\frac{T_{\\mathrm{obs}} - \\mathbb{E}[T_{\\mathcal{N}_1}]}{\\sigma_{\\mathcal{N}_1}} \\approx \\frac{300 - 1353.18}{36.05} \\approx -29.21 $$\n\n**在零模型 $\\mathcal{N}_2$（保持互易性的二元组模型）下的分析**\n\n在 $\\mathcal{N}_2$ 下，连接节点 $\\{V_1, V_2, V_3\\}$ 的三个二元组的状态是独立的。要形成一个 FFL，所有三个二元组都必须是非对称的。单个二元组为非对称的概率是 $a=0.14$。所有三个都是非对称的概率是 $a^3$。\n\n给定这三个二元组都是非对称的，我们需要找到它们的朝向形成传递模式（FFL）而不是循环模式的概率。对于每个非对称二元组，有两种可能的朝向，每种的概率都是 $1/2$。因此对于三个二元组，有 $2^3 = 8$ 种等可能的朝向模式。\n这 8 种模式对应于 3 个标记顶点上所有可能的锦标赛的边集。其中有两种循环锦标赛（$V_1 \\to V_2 \\to V_3 \\to V_1$ 和 $V_1 \\to V_3 \\to V_2 \\to V_1$）和 $8-2=6$ 种传递锦标赛（FFL）。\n因此，在三个二元组都是非对称的条件下，形成 FFL 的条件概率是 $6/8 = 3/4$。\n\n一个随机选择的三节点组形成 FFL 的概率 $P_{FFL}(\\mathcal{N}_2)$ 是：\n$$ P_{FFL}(\\mathcal{N}_2) = P(\\text{所有 3 个二元组都是非对称的}) \\times P(\\text{模式是传递的} | \\text{3 个非对称二元组}) $$\n$$ P_{FFL}(\\mathcal{N}_2) = a^3 \\cdot \\frac{3}{4} $$\nFFL 的期望数量 $\\mathbb{E}[T_{\\mathcal{N}_2}]$ 是：\n$$ \\mathbb{E}[T_{\\mathcal{N}_2}] = \\binom{n}{3} \\cdot \\frac{3}{4} a^3 $$\n使用给定值 $n=60$ 和 $a=0.14$：\n$$ \\mathbb{E}[T_{\\mathcal{N}_2}] = 34220 \\cdot \\frac{3}{4} \\cdot (0.14)^3 = 34220 \\cdot 0.75 \\cdot 0.002744 \\approx 70.42 $$\n观测数量为 $T_{\\mathrm{obs}}=300$，远高于期望数量 $\\approx 70$。因此，相对于 $\\mathcal{N}_2$，FFL 是**过表达**的。\n\n为了计算 z-分数，我们再次近似方差：\n$$ P_{FFL}(\\mathcal{N}_2) = 0.75 \\cdot (0.14)^3 \\approx 0.002058 $$\n$$ \\mathrm{Var}(T_{\\mathcal{N}_2}) \\approx 70.42 \\cdot (1 - 0.002058) \\approx 70.27 $$\n$$ \\sigma_{\\mathcal{N}_2} = \\sqrt{\\mathrm{Var}(T_{\\mathcal{N}_2})} \\approx \\sqrt{70.27} \\approx 8.38 $$\nz-分数为：\n$$ z_2 = \\frac{T_{\\mathrm{obs}} - \\mathbb{E}[T_{\\mathcal{N}_2}]}{\\sigma_{\\mathcal{N}_2}} \\approx \\frac{300 - 70.42}{8.38} \\approx 27.39 $$\n\n**结论与选项评估**\n\n- 在 $\\mathcal{N}_1$ 下，$\\mathbb{E}[T] \\approx 1353$ 且 $z \\approx -29$，表明显著的欠表达。\n- 在 $\\mathcal{N}_2$ 下，$\\mathbb{E}[T] \\approx 70$ 且 $z \\approx 27$，表明显著的过表达。\n- 零模型的选择颠倒了关于模体显著性的结论。$\\mathcal{N}_1$ 是一个较差的零模型，因为它与观测到的二元组普查不匹配（例如，它预测的互易性为 $m=p^2=0.0625$，远低于观测到的 $m=0.18$）。$\\mathcal{N}_2$ 更为合适，因为它在构造上就保留了二元组结构。\n\n现在我将评估每个选项。\n\n**A. 在 $p=0.25$ 的零模型 $\\mathcal{N}_1$ 下，期望的 FFL 数量为 $\\binom{60}{3}\\cdot 6p^3(1-p)^3\\approx 1353$，呈现欠表达，z-分数约为 $-29$。在 $a=0.14$ 的零模型 $\\mathcal{N}_2$ 下，期望的 FFL 数量为 $\\binom{60}{3}\\cdot \\tfrac{3}{4}a^3\\approx 70$，呈现过表达，z-分数约为 $27$，因此两种零模型下的表达符号相反。**\n- $\\mathbb{E}[T_{\\mathcal{N}_1}]$ 的公式是正确的。计算值 $\\approx 1353$ 是正确的。欠表达的评估和 $z \\approx -29$ 是正确的。\n- $\\mathbb{E}[T_{\\mathcal{N}_2}]$ 的公式是正确的。计算值 $\\approx 70$ 是正确的。过表达的评估和 $z \\approx 27$ 是正确的。\n- 表达符号被颠倒的观察是正确的。\n- **结论：正确。**\n\n**B. 在零模型 $\\mathcal{N}_1$ 下，期望的 FFL 数量为 $\\binom{60}{3}\\cdot p^3(1-p)^3\\approx 226$，在零模型 $\\mathcal{N}_2$ 下为 $\\binom{60}{3}\\cdot \\tfrac{1}{2}a^3\\approx 130$；两种情况下 FFL 相对于期望都是过表达的。**\n- $\\mathbb{E}[T_{\\mathcal{N}_1}]$ 的公式不正确；它缺少了组合因子 $6$。\n- $\\mathbb{E}[T_{\\mathcal{N}_2}]$ 的公式不正确；它使用了因子 $1/2$ 而不是正确的 $3/4$。\n- 两种情况下 FFL 都是过表达的结论是不正确的（对于 $\\mathcal{N}_1$ 是欠表达）。\n- **结论：不正确。**\n\n**C. 在零模型 $\\mathcal{N}_1$ 下，期望的 FFL 数量为 $\\binom{60}{3}\\cdot 2p^3(1-p)^3\\approx 451$，而在零模型 $\\mathcal{N}_2$ 下为 $\\binom{60}{3}\\cdot \\tfrac{3}{4}a^2\\approx 504$；两种情况下 FFL 都是欠表达的。**\n- $\\mathbb{E}[T_{\\mathcal{N}_1}]$ 的公式不正确；它使用了因子 $2$ 而不是 $6$。\n- $\\mathbb{E}[T_{\\mathcal{N}_2}]$ 的公式不正确；它使用了 $a^2$ 而不是 $a^3$。\n- 两种情况下 FFL 都是欠表达的结论是不正确的（对于 $\\mathcal{N}_2$ 是过表达）。\n- **结论：不正确。**\n\n**D. FFL 的期望概率与互易性无关，在任何匹配 $p$ 的零模型下都等于 $6p^3(1-p)^3$；由于 $T_{\\mathrm{obs}}=300$，它在两种零模型下都是欠表达的。**\n- 概率与零模型的互易性结构无关的说法是错误的。我们的推导明确显示了 $\\mathcal{N}_1$ 和 $\\mathcal{N}_2$ 的两个不同概率，尽管两个模型都受到相同的经验弧密度 $p$ 的约束（因为 $d=2p$ 与 $m, a, u$ 一致）。\n- 在两种零模型下都是欠表达的结论是错误的。\n- **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}