{
    "hands_on_practices": [
        {
            "introduction": "在研究随机网络时，区分抽象的图结构（无标记图）与其实际的节点标记实现（有标记图）至关重要。此练习旨在通过应用图论的核心概念——同构和自同构群，来阐明这两者之间的联系。通过计算一个特定无标记图的标记实现数量 ，您将掌握如何量化图的对称性，并理解它如何影响我们在 Erdős-Rényi 模型中定义的概率空间。",
            "id": "4138818",
            "problem": "在随机图的 Erdős-Rényi (ER) 模型 $G(n,p)$ 中，我们可以将结果视为固定顶点集上的标记图，或在同构意义下的未标记图，后者将代表相同抽象结构的标记方式归为一类。请使用核心定义解释标记图（具有显式顶点集 $\\{1,2,\\dots,n\\}$）和未标记图（图同构关系下标记图的等价类）之间的区别，并描述自同构如何编码结构对称性，以识别代表同一未标记图的标记方式。\n\n然后，考虑一个顶点数为 $n=12$ 的未标记图 $H$，它由三个三顶点路 $P_{3}$、一个二顶点完全图 $K_{2}$ 和一个孤立顶点 $K_{1}$ 的不交并构成。计算 $H$ 在顶点集 $\\{1,2,\\dots,12\\}$ 上的不同标记实现的确切数量；也就是说，在顶点集 $\\{1,2,\\dots,12\\}$ 上与 $H$ 同构的标记图的数量。请以精确整数形式给出最终答案，无需四舍五入。",
            "solution": "该问题包含两部分。第一部分是关于图论基本概念的解释性任务，第二部分是组合计数中的计算任务。在验证问题陈述后，我将依次解决每个部分。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n- **上下文**：Erdős-Rényi (ER) 模型 $G(n,p)$。\n- **需要解释的概念**：\n    1. 标记图（顶点集为 $\\{1, 2, \\dots, n\\}$）和未标记图（同构类）之间的区别。\n    2. 自同构在关联这两个概念中的作用。\n- **计算任务**：\n    - **未标记图 $H$**：一个有 $n=12$ 个顶点的图。\n    - **$H$ 的结构**：以下图的不交并：\n        - $3$ 个三顶点路（$P_3$）。\n        - $1$ 个二顶点完全图（$K_2$）。\n        - $1$ 个孤立顶点（$K_1$）。\n    - **目标**：计算在顶点集 $\\{1, 2, \\dots, 12\\}$ 上与 $H$ 同构的不同标记图的数量。\n    - **输出格式**：一个精确整数。\n\n**步骤2：使用提取的已知信息进行验证**\n问题陈述在科学上是合理的，基于图论和组合计数的既定原则。提及 $G(n,p)$ 模型为区分标记图空间和未标记图空间的重要性提供了相关背景，但问题本身是图枚举中的一个标准练习。图 $H$ 的定义是精确且自洽的；其各连通分支的顶点数之和 ($3 \\times 3 + 1 \\times 2 + 1 \\times 1$) 正确地等于指定的总顶点数 ($n=12$)。问题是适定的，提供了所有必要信息以得出一个唯一的、可验证的解。术语是标准的且无歧义。因此，该问题被认定为有效。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n### 第1部分：概念解释\n\n**标记图** $G=(V, E)$ 由一个固定的、可区分的顶点集合 $V$（通常取为整数集合 $\\{1, 2, \\dots, n\\}$）和一个由 $V$ 的2元子集组成的集合 $E$（代表边）正式定义。在同一顶点集 $V$ 上的两个标记图，例如 $G_1=(V, E_1)$ 和 $G_2=(V, E_2)$，当且仅当它们的边集不相同时，即 $E_1 \\neq E_2$，被认为是不同的。对于一个有 $n$ 个顶点的集合，有 $\\binom{n}{2}$ 条可能的边，由于每条边都可以选择包含或不包含，因此在 $n$ 个顶点上有 $2^{\\binom{n}{2}}$ 个不同的标记图。\n\n相比之下，**未标记图**是一个只捕捉拓扑结构而忽略顶点具体身份的抽象概念。其形式化定义依赖于图同构的概念。两个标记图 $G_1=(V_1, E_1)$ 和 $G_2=(V_2, E_2)$ 是**同构的**，如果存在一个双射函数 $\\phi: V_1 \\to V_2$（称为同构映射），它保持邻接性。也就是说，对于任意一对顶点 $u, v \\in V_1$，边 $\\{u, v\\}$ 在 $E_1$ 中当且仅当边 $\\{\\phi(u), \\phi(v)\\}$ 在 $E_2$ 中。同构在所有标记图的集合上定义了一个等价关系。一个未标记图正是此关系下的一个等价类。一个同构类中的所有图共享相同的抽象结构。\n\n连接标记图和未标记图世界的桥梁是**自同构**。一个图 $G=(V, E)$ 的自同构是从 $G$ 到其自身的同构——即一个保持边集的顶点集 $V$ 的置换 $\\sigma$。对于一个图 $G$，所有这些自同构在函数复合运算下构成一个群，称为 $G$ 的**自同构群**，记作 $\\text{Aut}(G)$。这个群的大小 $|\\text{Aut}(G)|$ 量化了图的结构对称性。一个完全不对称的图只有一个恒等自同构 ($|\\text{Aut}(G)|=1$)，而像完全图 $K_n$ 这样的高度对称图则有很大的自同构群 ($|\\text{Aut}(K_n)| = n!$)。\n\n为了找到在 $n$ 个顶点上对应于单个未标记图 $H$ 的不同标记图的数量，我们可以按如下方式推理。从 $H$ 在顶点集 $\\{1, 2, \\dots, n\\}$ 上的一个特定标记实现（比如 $G_0$）开始。我们可以通过置换顶点标记来生成其他标记图。共有 $n!$ 种这样的置换。然而，如果一个置换 $\\sigma$ 是 $G_0$ 的一个自同构，那么将它应用于 $G_0$ 的顶点会得到完全相同的标记图。更一般地，两个置换 $\\pi_1$ 和 $\\pi_2$ 产生相同的标记图，当且仅当 $\\pi_1(G_0) = \\pi_2(G_0)$，这等价于 $\\pi_2^{-1}\\pi_1$ 是 $G_0$ 的一个自同构。这意味着对于任何给定的标记实现，恰好有 $|\\text{Aut}(G_0)|$ 个置换会产生它。根据轨道-稳定子定理，总置换数 ($n!$) 是不同标记图的数量（轨道的阶）与其中任一图的对称性数量（稳定子的阶，即 $|\\text{Aut}(H)|$）的乘积。因此，在 $n$ 个顶点上与未标记图 $H$ 同构的不同标记图的数量由以下公式给出：\n$$ \\text{标记实现数量} = \\frac{n!}{|\\text{Aut}(H)|} $$\n\n### 第2部分：计算\n\n问题要求计算在顶点集 $\\{1, 2, \\dots, 12\\}$ 上与未标记图 $H$（即不交并 $3P_3 \\cup K_2 \\cup K_1$）同构的标记图的数量。这里 $n=12$。根据上面推导的公式，我们必须首先计算 $H$ 的自同构群的大小 $|\\text{Aut}(H)|$。\n\n一个不交并图的自同构必须将连通分支映射到同构的连通分支。$H$ 的结构包含三种不同构的连通分支类型：$P_3$、$K_2$ 和 $K_1$。其中有 $m_1 = 3$ 个相同的 $C_1 = P_3$ 副本， $m_2 = 1$ 个 $C_2 = K_2$ 副本，以及 $m_3 = 1$ 个 $C_3 = K_1$ 副本。\n\n这样一个不交并图的自同构群的大小，是由每一类同构连通分支的自同构群大小的乘积给出的。对于一类由 $m$ 个相同连通分支 $C$ 组成的集合，其对自同构群大小的贡献是 $|\\text{Aut}(C)|^m \\cdot m!$。第一项考虑了 $m$ 个连通分支各自的内禀对称性，而 $m!$ 项则考虑了这 $m$ 个相同连通分支自身的置换。\n因此，$H$ 的自同构群的大小为：\n$$|\\text{Aut}(H)| = \\left(|\\text{Aut}(P_3)|^{3} \\cdot 3!\\right) \\cdot \\left(|\\text{Aut}(K_2)|^{1} \\cdot 1!\\right) \\cdot \\left(|\\text{Aut}(K_1)|^{1} \\cdot 1!\\right)$$\n\n接下来，我们确定每种独立连通分支类型的自同构群的大小：\n1.  **$|\\text{Aut}(P_3)|$**：三顶点路有一个度为2的中心顶点和两个度为1的端点。任何自同构都必须固定中心顶点，只能置换两个端点。因此，存在2个自同构（恒等变换和交换两个端点）。$|\\text{Aut}(P_3)|=2$。\n2.  **$|\\text{Aut}(K_2)|$**：二顶点完全图由两个度为1的顶点组成。它们在结构上是不可区分的，可以相互交换。所以，$|\\text{Aut}(K_2)|=2$。\n3.  **$|\\text{Aut}(K_1)|$**：只有一个顶点的图仅有平凡（恒等）自同构。所以，$|\\text{Aut}(K_1)|=1$。\n\n将这些值代入 $|\\text{Aut}(H)|$ 的公式中：\n$$|\\text{Aut}(H)| = (2^3 \\cdot 3!) \\cdot (2^1 \\cdot 1!) \\cdot (1^1 \\cdot 1!) = (8 \\cdot 6) \\cdot (2 \\cdot 1) \\cdot (1 \\cdot 1) = 48 \\cdot 2 = 96$$\n\n$H$ 的自同构群的大小是 $96$。\n现在，我们可以计算 $H$ 在 $12$ 个顶点上的不同标记实现数量：\n$$ \\text{标记图数量} = \\frac{n!}{|\\text{Aut}(H)|} = \\frac{12!}{96} $$\n$12!$ 的值是 $479,001,600$。\n$$ \\frac{12!}{96} = \\frac{479,001,600}{96} $$\n为了简化计算：\n$$ \\frac{12!}{96} = \\frac{12 \\cdot 11!}{12 \\cdot 8} = \\frac{11!}{8} $$\n由于 $11! = 39,916,800$，我们有：\n$$ \\frac{39,916,800}{8} = 4,989,600 $$\n因此，在顶点集 $\\{1, 2, \\dots, 12\\}$ 上与 $H$ 同构的不同标记图有 $4,989,600$ 个。",
            "answer": "$$\\boxed{4989600}$$"
        },
        {
            "introduction": "Erdős-Rényi 模型的两个经典变体，$G(n,p)$ 和 $G(n,M)$，其核心区别在于边的生成过程，这直接影响了网络的统计特性。通过从第一性原理推导并比较两种模型中最基本的局部属性——节点度——的分布 ，您将深入理解独立边选择与固定边数之间的统计差异，并精确量化其对网络方差的影响。",
            "id": "4138816",
            "problem": "考虑 Erdős–Rényi 随机图模型及其两个典范系综：固定边数系综 $G(n,M)$ 和独立边系综 $G(n,p)$，两者都作用于 $n \\geq 3$ 个带标签的顶点。在 $G(n,M)$ 中，从所有 $\\binom{n}{2}$ 条可能的无向边中，无放回地均匀选择 $M$ 条边。在 $G(n,p)$ 中，$\\binom{n}{2}$ 条可能的边中的每一条都以概率 $p$ 独立存在。\n\n固定一个顶点 $v$。令 $D_M$ 表示 $v$ 在 $G(n,M)$ 中的度，令 $D_p$ 表示 $v$ 在 $G(n,p)$ 中的度。仅使用基本定义和关于有放回和无放回抽样的已确立事实，从第一性原理推导 $G(n,M)$ 中 $D_M$ 的分布和 $G(n,p)$ 中 $D_p$ 的分布。然后，设置 $p^{\\star} = \\frac{M}{\\binom{n}{2}}$ 以使两个系综中的期望度数相匹配，并精确量化 $D_M$ 的方差与 $D_{p^{\\star}}$ 的方差有何不同。\n\n将由\n$$\ns(n) \\equiv \\frac{\\mathrm{Var}(D_{M})}{\\mathrm{Var}(D_{p^{\\star}})}\n$$\n定义的精确乘性方差缩减因子 $s(n)$ 表示为仅依赖于 $n$ 的单一闭式表达式。无需进行数值舍入，也不涉及单位。最终答案必须是单一的解析表达式。",
            "solution": "该问题要求推导在 $G(n,p)$ 和 $G(n,M)$ 随机图模型中，一个固定顶点 $v$ 的度分布，然后比较它们的方差。\n\n首先，我们分析 $G(n,p)$ 模型中固定顶点 $v$ 的度 $D_p$ 的分布。在此模型中，图有 $n$ 个顶点，并且 $\\binom{n}{2}$ 条可能的边中的每一条都以概率 $p$ 独立地被包含在图中。对于一个特定顶点 $v$，有 $n-1$ 条潜在的边将其连接到其他 $n-1$ 个顶点。这 $n-1$ 条边中每一条的存在都是一次独立的伯努利试验，成功概率为 $p$。度 $D_p$ 是成功试验的总次数。因此，$D_p$ 的分布是参数为 $n-1$ 和 $p$ 的二项分布。\n\n$D_p \\sim \\mathrm{Binomial}(n-1, p)$\n\n$D_p$ 的概率质量函数 (PMF) 由下式给出：\n$$P(D_p = k) = \\binom{n-1}{k} p^k (1-p)^{n-1-k}$$\n对于 $k \\in \\{0, 1, \\dots, n-1\\}$。二项分布 $\\mathrm{Binomial}(N, \\pi)$ 的方差为 $N\\pi(1-\\pi)$。因此，$D_p$ 的方差为：\n$$\\mathrm{Var}(D_p) = (n-1)p(1-p)$$\n\n接下来，我们分析 $G(n,M)$ 模型中固定顶点 $v$ 的度 $D_M$ 的分布。在此模型中，从总共 $N_{\\text{total}} = \\binom{n}{2}$ 条可能的边中，无放回地随机均匀选择 $M$ 条边。这是一个经典的无放回抽样场景。为了找到 $D_M$ 的分布，我们可以使用超几何分布对其进行建模。\n\n总体由所有 $N_{\\text{total}} = \\binom{n}{2}$ 条可能的边组成。我们可以将此总体划分为两组：\n1.  与顶点 $v$ 关联的 $K = n-1$ 条边。\n2.  不与顶点 $v$ 关联的 $N_{\\text{total}} - K = \\binom{n}{2} - (n-1)$ 条边。\n\n我们从这个总体中抽取一个大小为 $M$（图中总边数）的样本。顶点 $v$ 的度 $D_M$ 是我们样本中包含的第一组（成功项）中的边数。\n因此，$D_M$ 的分布是一个超几何分布，其总体大小为 $N_{\\text{total}} = \\binom{n}{2}$，总体中的成功项数为 $K = n-1$，样本大小为 $m = M$。\n\n$D_M$ 的 PMF 由下式给出：\n$$P(D_M = k) = \\frac{\\binom{K}{k}\\binom{N_{\\text{total}}-K}{m-k}}{\\binom{N_{\\text{total}}}{m}} = \\frac{\\binom{n-1}{k}\\binom{\\binom{n}{2}-(n-1)}{M-k}}{\\binom{\\binom{n}{2}}{M}}$$\n对于 $k \\in \\{\\max(0, M-(\\binom{n}{2}-(n-1))), \\dots, \\min(n-1, M)\\}$。超几何分布的方差为 $m \\frac{K}{N_{\\text{total}}}\\left(1-\\frac{K}{N_{\\text{total}}}\\right)\\left(\\frac{N_{\\text{total}}-m}{N_{\\text{total}}-1}\\right)$。代入我们问题的参数：\n$$\\mathrm{Var}(D_M) = M \\frac{n-1}{\\binom{n}{2}}\\left(1 - \\frac{n-1}{\\binom{n}{2}}\\right)\\left(\\frac{\\binom{n}{2}-M}{\\binom{n}{2}-1}\\right)$$\n\n问题要求在期望度数相匹配时比较这些方差。$G(n,p)$ 中的期望边数为 $\\binom{n}{2}p$。$G(n,M)$ 中的边数固定为 $M$。令两者相等得到 $M = \\binom{n}{2}p$，这导出了定义 $p^{\\star} \\equiv \\frac{M}{\\binom{n}{2}}$。通过此选择，期望度数相等：\n$$E[D_{p^{\\star}}] = (n-1) p^{\\star} = (n-1)\\frac{M}{\\binom{n}{2}}$$\n$$E[D_M] = M \\frac{K}{N_{\\text{total}}} = M\\frac{n-1}{\\binom{n}{2}}$$\n\n现在我们通过将 $p = p^{\\star}$ 代入二项分布方差公式来计算 $D_{p^{\\star}}$ 的方差：\n$$\\mathrm{Var}(D_{p^{\\star}}) = (n-1)p^{\\star}(1-p^{\\star}) = (n-1)\\frac{M}{\\binom{n}{2}}\\left(1 - \\frac{M}{\\binom{n}{2}}\\right)$$\n\n我们被要求找出比率 $s(n) = \\frac{\\mathrm{Var}(D_M)}{\\mathrm{Var}(D_{p^{\\star}})}$。将两个方差的表达式代入，我们得到：\n$$\ns(n) = \\frac{M \\frac{n-1}{\\binom{n}{2}}\\left(1 - \\frac{n-1}{\\binom{n}{2}}\\right)\\left(\\frac{\\binom{n}{2}-M}{\\binom{n}{2}-1}\\right)}{(n-1)\\frac{M}{\\binom{n}{2}}\\left(1 - \\frac{M}{\\binom{n}{2}}\\right)}\n$$\n假设 $M>0$ 且 $M\\binom{n}{2}$，我们可以进行化简。分子中的项 $M \\frac{n-1}{\\binom{n}{2}}$ 与分母中的项 $(n-1)\\frac{M}{\\binom{n}{2}}$ 相等。消去这些公共因子后，我们得到：\n$$\ns(n) = \\frac{\\left(1 - \\frac{n-1}{\\binom{n}{2}}\\right)\\left(\\frac{\\binom{n}{2}-M}{\\binom{n}{2}-1}\\right)}{1 - \\frac{M}{\\binom{n}{2}}}\n$$\n现在，我们分别处理分子和分母中的表达式。分母可以写为：\n$$ 1 - \\frac{M}{\\binom{n}{2}} = \\frac{\\binom{n}{2}-M}{\\binom{n}{2}} $$\n代入后，表达式变为：\n$$\ns(n) = \\frac{\\left(1 - \\frac{n-1}{\\binom{n}{2}}\\right)\\left(\\frac{\\binom{n}{2}-M}{\\binom{n}{2}-1}\\right)}{\\frac{\\binom{n}{2}-M}{\\binom{n}{2}}}\n$$\n我们可以消去公共项 $\\binom{n}{2}-M$，得到：\n$$\ns(n) = \\left(1 - \\frac{n-1}{\\binom{n}{2}}\\right) \\frac{\\binom{n}{2}}{\\binom{n}{2}-1} = \\frac{\\binom{n}{2} - (n-1)}{\\binom{n}{2}} \\frac{\\binom{n}{2}}{\\binom{n}{2}-1} = \\frac{\\binom{n}{2} - (n-1)}{\\binom{n}{2}-1}\n$$\n此表达式仅依赖于 $n$，符合要求。我们现在代入二项式系数的定义 $\\binom{n}{2} = \\frac{n(n-1)}{2}$，并进行化简。\n分子是：\n$$\\binom{n}{2} - (n-1) = \\frac{n(n-1)}{2} - (n-1) = (n-1)\\left(\\frac{n}{2}-1\\right) = \\frac{(n-1)(n-2)}{2}$$\n分母是：\n$$\\binom{n}{2} - 1 = \\frac{n(n-1)}{2} - 1 = \\frac{n^2-n-2}{2} = \\frac{(n-2)(n+1)}{2}$$\n因此，比率 $s(n)$ 为：\n$$\ns(n) = \\frac{\\frac{(n-1)(n-2)}{2}}{\\frac{(n-2)(n+1)}{2}}\n$$\n对于 $n \\geq 3$，项 $n-2$ 非零，可以消去：\n$$\ns(n) = \\frac{n-1}{n+1}\n$$\n这就是乘性方差缩减因子。超几何方差中的项 $\\frac{N_{\\text{total}}-m}{N_{\\text{total}}-1}$ 是一个有限总体校正因子，它解释了由无放回抽样引起的负相关性。与 $G(n,p)$ 模型中的独立抽样相比，该因子导致了方差的减小。",
            "answer": "$$\\boxed{\\frac{n-1}{n+1}}$$"
        },
        {
            "introduction": "分析诸如三角形之类的小型子图的出现是理解随机网络结构和相变现象的关键。这项高级练习将引导您探索稀疏随机图的精细结构，通过计算一个顶点参与多个三角形的渐近概率 ，您将掌握运用矩方法和组合渐近分析等前沿技术，这些技能对于研究网络基元（motifs）和临界行为至关重要。",
            "id": "4138824",
            "problem": "考虑一个在 $n$ 个标记顶点上的 Erdős-Rényi (ER) 随机图模型 $G(n,p)$，其中 $\\binom{n}{2}$ 条可能的边中的每一条都以概率 $p$ 独立存在。固定一个特定顶点 $v$。令 $D_v$ 表示 $v$ 的度，令 $T_v$ 表示包含 $v$ 的三角形数量，其中一个包含 $v$ 的三角形定义为一个来自 $V \\setminus \\{v\\}$ 的不同顶点的无序对 $\\{i,j\\}$，使得边 $(v,i)$、$(v,j)$ 和 $(i,j)$ 都存在。\n\n在稀疏情况下 $p = c/n$，$c  0$ 且与 $n$ 无关。通过对 $D_v$ 取条件，并仅使用边的独立性和二项分布与泊松分布的基本定义进行渐近推理，从第一性原理推导 $T_v$ 的分布。然后，通过显式地组合枚举产生共享顶点 $v$ 的多个三角形的最小边构型，并仅使用边的独立性和计数论证，量化当 $n \\to \\infty$ 时 $v$ 参与至少 $2$ 个三角形的渐近概率。\n\n你的最终答案必须是一个关于 $c$ 和 $n$ 的单一闭式解析表达式，该表达式在渐近上精确到并包括 $n^{-2}$ 阶的项（即，你可以丢弃 $o(n^{-2})$ 的项）。不要提供数值近似。不需要单位。最终答案仅以解析表达式形式表示。",
            "solution": "我们首先处理问题的第一部分：在顶点 $v$ 的度 $D_v$ 为条件下，推导 $T_v$ 的分布。\n令 $v$ 为图 $G(n,p)$ 中的一个固定顶点。$v$ 的度 $D_v$ 是通过边与 $v$ 连接的顶点数。图中还有 $n-1$ 个其他顶点，对于每个顶点 $i \\in V \\setminus \\{v\\}$，边 $(v,i)$ 以概率 $p$ 存在，且与其他所有边独立。因此，$D_v$ 是 $n-1$ 次独立伯努利试验的成功次数之和，这意味着 $D_v$ 服从二项分布：\n$$D_v \\sim \\text{Bin}(n-1, p)$$\n在稀疏情况下，$p = c/n$，$c0$ 为常数，期望度为 $\\mathbb{E}[D_v] = (n-1)p = (n-1)c/n \\to c$ 当 $n \\to \\infty$ 时。在此极限下，二项分布收敛于泊松分布，所以 $D_v \\stackrel{d}{\\to} \\text{Pois}(c)$。\n\n现在，我们以事件 $D_v=k$ 为条件。这意味着 $v$ 恰好有 $k$ 个邻居。令 $N(v)$ 为这 $k$ 个邻居的集合。一个包含 $v$ 的三角形由 $v$ 和它的两个邻居（例如 $i$ 和 $j$）构成，前提是边 $(i,j)$ 存在。顶点 $i$ 和 $j$ 都必须属于 $N(v)$。$N(v)$ 中不同顶点对 $\\{i,j\\}$ 的数量为 $\\binom{k}{2}$。\n对于每个这样的顶点对 $\\{i,j\\} \\subset N(v)$，边 $(i,j)$ 以概率 $p$ 存在。这 $\\binom{k}{2}$ 条潜在边的存在是相互独立的，并且也独立于连接 $v$ 与其邻居的边（我们已对后者取了条件）。\n包含 $v$ 的三角形总数（记为 $T_v$）是这 $\\binom{k}{2}$ 条边中存在的数量。因此，在 $D_v=k$ 的条件下，$T_v$ 服从二项分布：\n$$T_v | (D_v = k) \\sim \\text{Bin}\\left(\\binom{k}{2}, p\\right)$$\n\n接下来，我们计算 $v$ 参与至少 $2$ 个三角形的渐近概率 $P(T_v \\ge 2)$。我们使用容斥原理（或矩方法）。令 $A_{ijk}$ 表示在顶点 $\\{i,j,k\\}$ 上存在三角形的事件。我们关心的是包含 $v$ 的三角形。我们用 $\\mathcal{T}_{ij}$ 表示三角形 $\\{v,i,j\\}$ 存在的事件。\n至少 $k$ 个事件发生的概率由 Bonferroni 不等式给出：$P(\\text{发生}\\ge k) = \\sum_{j=k}^N (-1)^{j-k} \\binom{j-1}{k-1} S_j$，其中 $S_j$ 是所有 $j$-重交集概率之和。对于 $k=2$，我们有：\n$$P(T_v \\ge 2) = S_2 - 2S_3 + 3S_4 - \\dots$$\n这里，$T_v$ 是计算包含 $v$ 的三角形的随机变量，$S_k = \\mathbb{E}\\left[\\binom{T_v}{k}\\right]$ 是包含 $v$ 的无序 $k$-元组三角形的期望数量。我们的任务是计算这个概率，使其精确到 $n^{-2}$ 阶。\n\n我们必须计算 $S_2 = \\mathbb{E}\\left[\\binom{T_v}{2}\\right]$，即包含 $v$ 的三角形对的期望数量。这正是题目所要求的“显式组合枚举最小边构型”。一对包含 $v$ 的三角形可以通过两种最小的方式形成，具体取决于它们如何共享除 $v$ 之外的顶点。设这两个三角形为 $\\{v,i,j\\}$ 和 $\\{v,k,l\\}$。\n\n情况1：两个三角形共享一条与 $v$ 相关联的边。\n这意味着它们还共享一个额外的顶点，例如，三角形为 $\\{v,i,j\\}$ 和 $\\{v,i,k\\}$，其中 $i,j,k \\in V \\setminus \\{v\\}$ 是不同的顶点。这种构型需要 $3$ 个其他顶点，并形成一个以 $v$ 为根的“钻石”图。\n所需的边集为 $\\{(v,i), (v,j), (v,k), (i,j), (i,k)\\}$。共有 $5$ 条不同的边。这样一个特定构型存在的概率是 $p^5$。\n为了计算这种构型的数量，我们首先从 $n-1$ 个可用顶点中选择 $3$ 个，有 $\\binom{n-1}{3}$ 种方法。对于每组 $3$ 个顶点，比如 $\\{i,j,k\\}$，它们中的任何一个都可以作为两个三角形共享的中心顶点（如上面的 $i$）。这给出了 $3$ 种方式。所以，这种构型的总数是 $3\\binom{n-1}{3}$。\n此情况对 $S_2$ 的贡献是 $3\\binom{n-1}{3}p^5$。\n\n情况2：两个三角形仅共享顶点 $v$。\n三角形为 $\\{v,i,j\\}$ 和 $\\{v,k,l\\}$，其中 $\\{i,j\\} \\cap \\{k,l\\} = \\emptyset$。这种构型需要从 $V \\setminus \\{v\\}$ 中选择 $4$ 个不同的顶点 $\\{i,j,k,l\\}$。\n所需的边集为 $\\{(v,i), (v,j), (i,j), (v,k), (v,l), (k,l)\\}$。共有 $6$ 条不同的边。此特定构型的概率为 $p^6$。\n为了计算这种构型的数量，我们从 $n-1$ 个顶点中选择 $4$ 个，有 $\\binom{n-1}{4}$ 种方法。对于每组 $4$ 个顶点，我们需要将它们分成两对以形成三角形。有 $3$ 种方法可以做到这一点（例如，$\\{i,j\\},\\{k,l\\}$；$\\{i,k\\},\\{j,l\\}$；$\\{i,l\\},\\{j,k\\}$）。\n此情况对 $S_2$ 的贡献是 $3\\binom{n-1}{4}p^6$。\n\n综合这些情况，我们得到 $S_2 = 3\\binom{n-1}{3}p^5 + 3\\binom{n-1}{4}p^6$。现在我们代入 $p=c/n$ 并进行渐近展开。\n对于第一项：\n$$3\\binom{n-1}{3}p^5 = 3 \\frac{(n-1)(n-2)(n-3)}{6} \\left(\\frac{c}{n}\\right)^5 = \\frac{1}{2}(n^3 - 6n^2 + O(n)) \\frac{c^5}{n^5} = \\frac{c^5}{2n^2} + O(n^{-3})$$\n对于第二项：\n$$3\\binom{n-1}{4}p^6 = 3 \\frac{(n-1)(n-2)(n-3)(n-4)}{24} \\left(\\frac{c}{n}\\right)^6 = \\frac{1}{8}(n^4 - 10n^3 + O(n^2)) \\frac{c^6}{n^6} = \\frac{c^6}{8n^2} + O(n^{-3})$$\n所以，$S_2$ 的展开式为：\n$$S_2 = \\frac{c^5}{2n^2} + \\frac{c^6}{8n^2} + O(n^{-3})$$\n现在我们必须考虑容斥公式中的高阶项。下一项是 $-2S_3$。$S_3 = \\mathbb{E}\\left[\\binom{T_v}{3}\\right]$ 是三元组三角形的期望数量。对 $S_3$ 的主要贡献来自于边数最少的构型。例如，在 $\\{v,i,j,k\\}$ 上的一个 $K_4$ 子图包含 $3$ 个以 $v$ 为顶点的三角形。这个 $K_4$ 构型需要 $\\binom{4}{2}=6$ 条边。选择 $3$ 个顶点 $\\{i,j,k\\}$ 的方法有 $\\binom{n-1}{3}$ 种。其概率为 $p^6$。\n对 $S_3$ 的贡献是 $\\binom{n-1}{3}p^6 = \\left(\\frac{n^3}{6} + O(n^2)\\right)\\left(\\frac{c}{n}\\right)^6 = \\frac{c^6}{6n^3} + O(n^{-4})$。所有其他形成 $3$ 个三角形的构型都涉及更多的边或更多的顶点，导致其贡献为 $O(n^{-3})$ 阶或更小。\n因此，$S_3 = O(n^{-3})$。\n概率的完整表达式是 $P(T_v \\ge 2) = S_2 - 2S_3 + \\dots = S_2 + O(n^{-3})$。\n用 $S_2$ 近似 $P(T_v \\ge 2)$ 的误差是 $O(n^{-3})$ 阶，也就是 $o(n^{-2})$。因此，为了找到精确到 $n^{-2}$ 阶的所需表达式，我们只需要保留 $S_2$ 中直到 $n^{-2}$ 阶的项。\n$$P(T_v \\ge 2) = \\frac{c^5}{2n^2} + \\frac{c^6}{8n^2} + o(n^{-2})$$\n合并这些项得到最终的渐近表达式。\n$$P(T_v \\ge 2) = \\frac{4c^5 + c^6}{8n^2} + o(n^{-2}) = \\frac{c^5(4+c)}{8n^2} + o(n^{-2})$$\n精确到并包括 $n^{-2}$ 阶的渐近正确表达式就是这个主导部分。",
            "answer": "$$\\boxed{\\frac{c^{5}(4+c)}{8n^{2}}}$$"
        }
    ]
}