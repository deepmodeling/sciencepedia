{
    "hands_on_practices": [
        {
            "introduction": "Understanding system dynamics archetypes begins with translating their qualitative feedback structures into precise mathematical language. This first practice focuses on the canonical \"Limits to Growth\" archetype by modeling it with the logistic differential equation. By deriving the analytical solution for population growth under resource constraints, you will develop a foundational understanding of how a reinforcing process and a balancing process interact to produce the characteristic S-shaped growth curve .",
            "id": "4147273",
            "problem": "Consider a complex adaptive system exhibiting the \"Limits to Growth\" system dynamics archetype, in which an initially reinforcing process is counteracted by a balancing feedback due to resource saturation. Let the aggregated state variable $X(t)$ represent the population of active agents (in individuals) at time $t$. A widely accepted macroscopic representation of this archetype is the logistic Ordinary Differential Equation (ODE), which models the net rate of change as the product of a per-capita reinforcing growth and a saturation-induced balancing term: \n$$\\frac{dX}{dt} = r\\,X\\left(1 - \\frac{X}{K}\\right).$$\nGiven $r=0.4$, $K=100$, and the initial condition $X(0)=10$, derive the closed-form analytic expression for $X(t)$ satisfying the ODE and the initial condition, and then evaluate $X(20)$. Round your final numerical value to $4$ significant figures and express the final answer in individuals.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the established theory of population dynamics and system dynamics, presenting a well-posed initial value problem with all necessary data and no internal contradictions. It is objective, formalizable, and solvable using standard mathematical techniques.\n\nThe problem requires solving the logistic Ordinary Differential Equation (ODE) for a state variable $X(t)$ representing a population size. The governing equation is:\n$$\n\\frac{dX}{dt} = r\\,X\\left(1 - \\frac{X}{K}\\right)\n$$\nThe provided parameters are the intrinsic growth rate $r = 0.4$, the carrying capacity $K = 100$, and the initial condition $X(0) = 10$.\n\nThis is a first-order nonlinear ODE that can be solved using the method of separation of variables. First, we rearrange the equation to separate the variables $X$ and $t$:\n$$\n\\frac{dX}{X\\left(1 - \\frac{X}{K}\\right)} = r\\,dt\n$$\nTo integrate the left-hand side, we first simplify the expression and then use partial fraction decomposition.\n$$\n\\frac{dX}{X\\frac{K-X}{K}} = \\frac{K}{X(K-X)} dX = r\\,dt\n$$\nWe decompose the term $\\frac{K}{X(K-X)}$ into partial fractions:\n$$\n\\frac{K}{X(K-X)} = \\frac{A}{X} + \\frac{B}{K-X}\n$$\nMultiplying both sides by $X(K-X)$ gives:\n$$\nK = A(K-X) + B(X)\n$$\nTo find the coefficients $A$ and $B$, we can substitute convenient values for $X$.\nFor $X = 0$, we get $K = A(K - 0)$, which implies $A = 1$.\nFor $X = K$, we get $K = B(K)$, which implies $B = 1$.\nThus, the decomposition is:\n$$\n\\frac{K}{X(K-X)} = \\frac{1}{X} + \\frac{1}{K-X}\n$$\nNow, we can substitute this back into the separated differential equation and integrate both sides:\n$$\n\\int \\left(\\frac{1}{X} + \\frac{1}{K-X}\\right) dX = \\int r\\,dt\n$$\nPerforming the integration yields:\n$$\n\\ln|X| - \\ln|K-X| = rt + C\n$$\nwhere $C$ is the constant of integration. The negative sign in front of the second logarithm arises from the integration of $\\frac{1}{K-X}$ with respect to $X$.\nUsing the properties of logarithms, we can combine the terms on the left side:\n$$\n\\ln\\left|\\frac{X}{K-X}\\right| = rt + C\n$$\nExponentiating both sides to solve for the ratio $\\frac{X}{K-X}$:\n$$\n\\left|\\frac{X}{K-X}\\right| = \\exp(rt + C) = \\exp(C)\\exp(rt)\n$$\nSince $X(t)$ represents a population, for $0  X  K$, the term inside the absolute value, $\\frac{X}{K-X}$, will be positive. We can thus remove the absolute value signs and define a new constant $A_0 = \\exp(C)$:\n$$\n\\frac{X}{K-X} = A_0\\exp(rt)\n$$\nWe determine the constant $A_0$ using the initial condition $X(0) = 10$. At $t=0$:\n$$\n\\frac{X(0)}{K - X(0)} = A_0\\exp(r \\cdot 0) = A_0\n$$\nSubstituting the given values $K=100$ and $X(0)=10$:\n$$\nA_0 = \\frac{10}{100 - 10} = \\frac{10}{90} = \\frac{1}{9}\n$$\nNow we substitute this value of $A_0$ back into the equation relating $X$ and $t$:\n$$\n\\frac{X}{K-X} = \\frac{1}{9}\\exp(rt)\n$$\nThe next step is to solve for $X(t)$.\n$$\n9X = (K-X)\\exp(rt)\n$$\n$$\n9X = K\\exp(rt) - X\\exp(rt)\n$$\n$$\n9X + X\\exp(rt) = K\\exp(rt)\n$$\n$$\nX(9 + \\exp(rt)) = K\\exp(rt)\n$$\n$$\nX(t) = \\frac{K\\exp(rt)}{9 + \\exp(rt)}\n$$\nFor computational convenience, we can divide the numerator and the denominator by $\\exp(rt)$:\n$$\nX(t) = \\frac{K}{9\\exp(-rt) + 1}\n$$\nThis is the closed-form analytic expression for $X(t)$. Substituting the known values for the parameters $K=100$ and $r=0.4$:\n$$\nX(t) = \\frac{100}{1 + 9\\exp(-0.4t)}\n$$\nThe problem requires us to evaluate $X(20)$. We substitute $t=20$ into the derived expression:\n$$\nX(20) = \\frac{100}{1 + 9\\exp(-0.4 \\times 20)} = \\frac{100}{1 + 9\\exp(-8)}\n$$\nNow, we calculate the numerical value.\n$$\n\\exp(-8) \\approx 0.0003354626\n$$\n$$\nX(20) \\approx \\frac{100}{1 + 9(0.0003354626)} = \\frac{100}{1 + 0.0030191634} = \\frac{100}{1.0030191634}\n$$\n$$\nX(20) \\approx 99.6989934\n$$\nThe problem states that the final numerical value must be rounded to $4$ significant figures. The calculated value is $99.6989934...$. The first four significant figures are $9, 9, 6, 9$. The fifth significant figure is $8$, which is greater than or equal to $5$, so we round up the fourth significant figure. This changes $99.69$ to $99.70$. The trailing zero is significant and must be included.\nThe final evaluated population is $99.70$ individuals.",
            "answer": "$$\n\\boxed{99.70}\n$$"
        },
        {
            "introduction": "Delays are a critical and often underestimated feature of complex systems, frequently causing policies to fail in unexpected ways—a phenomenon known as \"policy resistance.\" This exercise provides a concrete demonstration of this principle by comparing a simple balancing loop with and without a perception delay . Through solving a delay-differential equation, you will see firsthand how acting on outdated information can lead to overshoot and oscillations, turning a smoothly regulating system into an unstable one.",
            "id": "4147224",
            "problem": "A single-state balancing loop in a complex adaptive system regulates a deviation variable $x(t)$ toward the goal $x^{\\star}=0$ by proportional correction with gain $k0$. When the regulating agent omits the perception delay, the loop is modeled by the ordinary differential equation $\\dot{x}(t)=-k\\,x(t)$. When the agent’s perception is delayed by a constant $\\tau0$, the loop is modeled by the delay-differential equation $\\dot{x}(t)=-k\\,x(t-\\tau)$. Consider a unit deviation history $x(t)=1$ for all $t\\le 0$ (representing a unit step deviation at $t=0$). Define the dimensionless gain $a\\equiv k\\,\\tau$.\n\nStarting only from the definitions of derivative and integral and the piecewise history, perform the following steps.\n\nOne, derive the response $x(t)$ for the delayed model on the first two method-of-steps intervals $0\\le t\\tau$ and $\\tau\\le t2\\tau$.\n\nTwo, by analyzing the resulting expressions, determine conditions on $a$ under which the delayed response exhibits a sign reversal (i.e., $x(t)$ crosses zero) within the first two intervals, and specialize to the case $a=\\frac{3}{4}$ to demonstrate that a sign reversal occurs in $\\left[\\tau,2\\tau\\right)$.\n\nThree, for $a=\\frac{3}{4}$, compute the first zero-crossing time $t_{\\mathrm{cross}}$ and report the normalized quantity $t_{\\mathrm{cross}}/\\tau$ as a closed-form expression.\n\nFour, solve the undelayed model $\\dot{x}(t)=-k\\,x(t)$ with $x(0)=1$ and argue whether its response crosses zero, thereby connecting the mathematical result to the notion of policy resistance in a balancing loop with delayed perception.\n\nProvide your final answer as an exact closed-form expression for $t_{\\mathrm{cross}}/\\tau$ with no rounding or numerical approximation of constants. Do not include any units in your final answer.",
            "solution": "The problem statement is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n- Undelayed Model: $\\dot{x}(t)=-k\\,x(t)$, with gain $k0$.\n- Delayed Model: $\\dot{x}(t)=-k\\,x(t-\\tau)$, with delay $\\tau0$.\n- Goal state: $x^{\\star}=0$.\n- History condition: $x(t)=1$ for all $t\\le 0$.\n- Initial condition for the undelayed model: $x(0)=1$.\n- Definition of dimensionless gain: $a\\equiv k\\,\\tau$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes a linear time-invariant system with a constant delay, a fundamental topic in control theory and system dynamics. The models presented are standard representations of a balancing feedback loop. The concept of policy resistance due to delays is a core principle in the study of complex systems. The problem is scientifically and mathematically sound.\n- **Well-Posed**: The problem provides a first-order delay-differential equation with a specified history function, which, through the method of steps, guarantees a unique and continuous solution. The questions are precise and lead to definite answers.\n- **Objective**: The problem is stated using precise mathematical language and quantitative definitions, free from ambiguity or subjective content.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically grounded, well-posed, and objective. A full solution will be provided.\n\nThe solution proceeds by addressing the four parts of the problem in sequence.\n\n**One: Response Derivation on the First Two Intervals**\n\nWe use the method of steps to solve the delay-differential equation $\\dot{x}(t)=-k\\,x(t-\\tau)$ with the history $x(t)=1$ for $t \\le 0$.\n\n*Interval 1: $0 \\le t  \\tau$*\nFor $t$ in this interval, the argument of the delayed term, $t-\\tau$, lies in the range $[-\\tau, 0)$. According to the history condition, $x(t-\\tau)=1$ for this range. The differential equation thus simplifies to an ordinary differential equation (ODE):\n$$ \\dot{x}(t) = -k \\cdot 1 = -k $$\nWe integrate this equation from $s=0$ to $s=t$, starting from the initial value $x(0)=1$ (given by the history function at the boundary).\n$$ \\int_{0}^{t} \\dot{x}(s) \\, ds = \\int_{0}^{t} (-k) \\, ds $$\n$$ x(t) - x(0) = -kt $$\nSubstituting $x(0)=1$:\n$$ x(t) = 1 - kt \\quad \\text{for } 0 \\le t \\le \\tau $$\nWe include $t=\\tau$ because the solution is continuous at the interval boundaries.\n\n*Interval 2: $\\tau \\le t  2\\tau$*\nFor $t$ in this interval, the argument $t-\\tau$ lies in the range $[0, \\tau)$. In this range, the function $x$ is defined by the solution from the first interval: $x(s) = 1-ks$ for $s \\in [0, \\tau]$. Thus, we have $x(t-\\tau) = 1-k(t-\\tau)$.\nThe differential equation becomes:\n$$ \\dot{x}(t) = -k \\, x(t-\\tau) = -k [1 - k(t-\\tau)] = -k + k^2(t-\\tau) $$\nWe integrate this equation from $s=\\tau$ to $s=t$, starting from the value $x(\\tau)$ which is determined from the first interval's solution: $x(\\tau) = 1-k\\tau$.\n$$ \\int_{\\tau}^{t} \\dot{x}(s) \\, ds = \\int_{\\tau}^{t} [-k + k^2(s-\\tau)] \\, ds $$\n$$ x(t) - x(\\tau) = \\left[-ks + \\frac{k^2}{2}(s-\\tau)^2\\right]_{\\tau}^{t} $$\n$$ x(t) - x(\\tau) = \\left(-kt + \\frac{k^2}{2}(t-\\tau)^2\\right) - \\left(-k\\tau + \\frac{k^2}{2}(\\tau-\\tau)^2\\right) $$\n$$ x(t) - x(\\tau) = -kt + k\\tau + \\frac{1}{2}k^2(t-\\tau)^2 = -k(t-\\tau) + \\frac{1}{2}k^2(t-\\tau)^2 $$\nSubstituting $x(\\tau) = 1-k\\tau$:\n$$ x(t) = (1-k\\tau) - k(t-\\tau) + \\frac{1}{2}k^2(t- \\tau)^2 $$\n$$ x(t) = 1 - k\\tau - kt + k\\tau + \\frac{1}{2}k^2(t-\\tau)^2 $$\n$$ x(t) = 1 - kt + \\frac{1}{2}k^2(t-\\tau)^2 \\quad \\text{for } \\tau \\le t \\le 2\\tau $$\n\n**Two: Analysis of Sign Reversal**\n\nA sign reversal occurs when $x(t)$ crosses zero. Since $x(0)=1$, this means we are looking for the first time $t$ where $x(t)=0$.\n\n*Analysis on $0 \\le t  \\tau$*\nThe solution is $x(t) = 1-kt$. Setting $x(t)=0$ gives $1-kt=0$, which implies $t = 1/k$. A sign reversal occurs in this interval if $0  1/k  \\tau$, which simplifies to $1  k\\tau$. Using the dimensionless gain $a=k\\tau$, the condition is $a1$.\n\n*Analysis on $\\tau \\le t  2\\tau$*\nWe consider the case where no sign reversal occurred in the first interval, i.e., $a \\le 1$. If $a \\le 1$, then $x(t) = 1-kt \\ge 1-k\\tau = 1-a \\ge 0$ for all $t \\in [0, \\tau]$, so the function is non-negative on the first interval.\nThe solution in the second interval is $x(t) = 1 - kt + \\frac{1}{2}k^2(t-\\tau)^2$. We seek $t \\in [\\tau, 2\\tau)$ such that $x(t)=0$.\nLet's use the dimensionless time $\\hat{t}=t/\\tau$. The interval becomes $1 \\le \\hat{t}  2$. The equation $x(t)=0$ becomes:\n$$ 1 - (k\\tau)(t/\\tau) + \\frac{1}{2}(k\\tau)^2(t/\\tau - 1)^2 = 0 $$\n$$ 1 - a\\hat{t} + \\frac{1}{2}a^2(\\hat{t}-1)^2 = 0 $$\nExpanding this quadratic in $\\hat{t}$:\n$$ 1 - a\\hat{t} + \\frac{1}{2}a^2(\\hat{t}^2 - 2\\hat{t} + 1) = 0 $$\n$$ \\frac{1}{2}a^2\\hat{t}^2 + (-a-a^2)\\hat{t} + (1+\\frac{1}{2}a^2) = 0 $$\n$$ a^2\\hat{t}^2 - 2a(1+a)\\hat{t} + (a^2+2) = 0 $$\nThe roots for $\\hat{t}$ are given by the quadratic formula:\n$$ \\hat{t} = \\frac{2a(1+a) \\pm \\sqrt{4a^2(1+a)^2 - 4a^2(a^2+2)}}{2a^2} = \\frac{1+a \\pm \\sqrt{(1+a)^2 - (a^2+2)}}{a} $$\n$$ \\hat{t} = \\frac{1+a \\pm \\sqrt{1+2a+a^2 - a^2-2}}{a} = \\frac{1+a \\pm \\sqrt{2a-1}}{a} $$\nFor real roots, the discriminant must be non-negative: $2a-1 \\ge 0$, which implies $a \\ge 1/2$.\nWe are interested in the first crossing, which corresponds to the smaller root, $\\hat{t}_1 = \\frac{1+a - \\sqrt{2a-1}}{a}$.\nWe need to find the condition on $a$ for this root to be in the interval $[\\tau, 2\\tau)$, which corresponds to $\\hat{t}_1 \\in [1, 2)$. We already assumed $a \\le 1$.\nThe condition $\\hat{t}_1 \\ge 1$ is $\\frac{1+a - \\sqrt{2a-1}}{a} \\ge 1 \\implies 1+a - \\sqrt{2a-1} \\ge a \\implies 1 \\ge \\sqrt{2a-1} \\implies 1 \\ge 2a-1 \\implies 2 \\ge 2a \\implies a \\le 1$. This is consistent with our assumption.\nThe condition $\\hat{t}_1  2$ is $\\frac{1+a-\\sqrt{2a-1}}{a}  2 \\implies 1+a-\\sqrt{2a-1}  2a \\implies 1-a  \\sqrt{2a-1}$.\nSince we are in the range $a \\in [1/2, 1]$, $1-a$ is non-negative, so we can square both sides:\n$(1-a)^2  2a-1 \\implies 1-2a+a^2  2a-1 \\implies a^2 - 4a + 2  0$.\nThe roots of $a^2-4a+2=0$ are $a = \\frac{4 \\pm \\sqrt{16-8}}{2} = 2 \\pm \\sqrt{2}$. The quadratic is negative between these roots, so $2-\\sqrt{2}  a  2+\\sqrt{2}$. Combining this with $a \\in [1/2, 1]$, the condition for a sign reversal in $[\\tau, 2\\tau)$ is $a \\in (2-\\sqrt{2}, 1]$.\nFor $a=3/4$, we have $2-\\sqrt{2} \\approx 2-1.414 = 0.586$, so $a=0.75$ is within the range $(2-\\sqrt{2}, 1]$. Therefore, a sign reversal occurs in $[\\tau, 2\\tau)$.\n\n**Three: Calculation of $t_{\\mathrm{cross}}/\\tau$ for $a=3/4$**\n\nWe use the formula derived for the normalized crossing time $\\hat{t}_1 = t_{\\mathrm{cross}}/\\tau$ with $a=3/4$:\n$$ \\frac{t_{\\mathrm{cross}}}{\\tau} = \\hat{t}_1 = \\frac{1+a - \\sqrt{2a-1}}{a} $$\nSubstituting $a=3/4$:\n$$ \\frac{t_{\\mathrm{cross}}}{\\tau} = \\frac{1+\\frac{3}{4} - \\sqrt{2\\left(\\frac{3}{4}\\right)-1}}{\\frac{3}{4}} = \\frac{\\frac{7}{4} - \\sqrt{\\frac{3}{2}-1}}{\\frac{3}{4}} = \\frac{\\frac{7}{4} - \\sqrt{\\frac{1}{2}}}{\\frac{3}{4}} $$\n$$ \\frac{t_{\\mathrm{cross}}}{\\tau} = \\frac{\\frac{7}{4} - \\frac{1}{\\sqrt{2}}}{\\frac{3}{4}} = \\frac{\\frac{7}{4} - \\frac{\\sqrt{2}}{2}}{\\frac{3}{4}} = \\frac{\\frac{7-2\\sqrt{2}}{4}}{\\frac{3}{4}} = \\frac{7-2\\sqrt{2}}{3} $$\nThis is the required closed-form expression.\n\n**Four: Solution of Undelayed Model and Connection to Policy Resistance**\n\nThe undelayed model is the ODE $\\dot{x}(t) = -k x(t)$ with the initial condition $x(0)=1$.\nThis is a separable equation: $\\frac{dx}{x} = -k dt$.\nIntegrating both sides gives $\\ln|x| = -kt + C$, where $C$ is the constant of integration.\nExponentiating both sides gives $|x(t)| = \\exp(-kt+C) = \\exp(C)\\exp(-kt)$.\nThis can be written as $x(t) = A\\exp(-kt)$, where $A=\\pm\\exp(C)$.\nUsing the initial condition $x(0)=1$, we find $1 = A\\exp(0)$, so $A=1$.\nThe solution is:\n$$ x(t) = \\exp(-kt) $$\nSince the exponential function $\\exp(y)$ is strictly positive for any real argument $y$, and $-kt$ is real for $t \\ge 0$, the response $x(t)$ is always positive. It starts at $x(0)=1$ and decays asymptotically to the goal $x^*=0$ but never reaches or crosses it.\n\n**Connection to Policy Resistance**: The undelayed system exhibits ideal behavior, monotonically approaching the goal. The corrective action is always based on the current, correct state of the system. In contrast, the delayed system can exhibit overshoot and oscillation. For $a=k\\tau  2-\\sqrt{2}$, the system overcorrects and crosses the target $x=0$. This is because the regulating agent acts on old information ($x(t-\\tau)$). By the time the current state $x(t)$ has neared the goal, the past state $x(t-\\tau)$ is still significantly large, prompting a continued strong correction. This drives the current state past the goal into negative territory. This phenomenon, where the system's structural delays cause it to react in ways that undermine the intended smooth regulation, is a classic example of \"policy resistance\". The delay introduces unintended consequences (overshoot) that resist the simple policy of proportional correction.",
            "answer": "$$\\boxed{\\frac{7-2\\sqrt{2}}{3}}$$"
        },
        {
            "introduction": "Modern analysis of complex systems relies heavily on computational simulation, which operates in discrete time. This practice bridges the gap between continuous-time theory and discrete-time application by exploring the \"Limits to Growth with Delay\" archetype as a difference equation . You will perform a formal stability analysis to derive the conditions under which the system remains stable and then verify your analytical findings by implementing a computer simulation, a core workflow in complex adaptive systems modeling.",
            "id": "4147282",
            "problem": "Consider the discrete-time delayed growth model with a single balancing feedback delay, defined for integer time $t \\in \\{0,1,2,\\dots\\}$ by\n$$\nX_{t+1} \\;=\\; X_t \\;+\\; r\\,X_t\\left(1-\\frac{X_{t-\\ell}}{K}\\right),\n$$\nwhere $K0$ is a constant carrying capacity, $r0$ is a scalar growth rate, and $\\ell \\in \\{0,1,2,\\dots\\}$ is an integer delay length. This equation is a canonical instance of the \"Limits to Growth with Delay\" system dynamics archetype: there is a reinforcing growth term $r\\,X_t$ and a balancing feedback $-\\frac{r}{K}X_t\\,X_{t-\\ell}$ that acts with delay $\\ell$. The task is to determine, from first principles, the local stability of the equilibrium and the stability boundary as a function of the delay $\\ell$, and to verify the boundary numerically via simulation.\n\nStarting from the fundamental base of discrete-time local stability analysis for nonlinear systems:\n- For a nonlinear discrete-time system $X_{t+1}=F(X_t,X_{t-1},\\dots,X_{t-\\ell})$, local stability of an equilibrium $X^\\star$ is assessed by linearizing the system around $X^\\star$ to obtain a linear time-invariant (LTI) delayed difference equation for small deviations $\\epsilon_t = X_t - X^\\star$, and then analyzing the characteristic equation of that linearization.\n- For an LTI delayed difference equation of the form $\\epsilon_{t+1} = \\sum_{j=0}^{\\ell} a_j \\epsilon_{t-j}$, local asymptotic stability holds if and only if all complex roots $z$ of the characteristic equation lie strictly inside the unit circle, that is, if $|z|1$ for all roots.\n- Loss of local stability occurs when one or more characteristic roots cross the unit circle $|z|=1$; the stability boundary is therefore obtained by placing $z$ on the unit circle and finding the parameter values at which the characteristic equation is satisfied.\n\nYour tasks:\n1. Derive, from the above base and the given model, the LTI delayed difference equation that governs the small deviations $\\epsilon_t = X_t - K$ around the equilibrium $X^\\star=K$, and obtain the corresponding characteristic polynomial in the complex variable $z$.\n2. Using the unit-circle crossing condition $|z|=1$ with $z=e^{i\\theta}$, where the angle $\\theta$ must be treated in radians, derive an explicit analytic expression for the smallest positive $r$ (denote it by $r_{\\mathrm{crit}}(\\ell)$) at which local stability of $X^\\star=K$ is lost as a function of the delay $\\ell$. Ensure that your derivation identifies which crossing (that is, which value of $\\theta$) produces the earliest loss of stability for a given $\\ell$.\n3. Implement a deterministic simulation of the delayed growth model to empirically verify the stability boundary for selected values of $\\ell$. Use the following simulation design:\n   - Initialize the history $X_t$ for $t=0,1,\\dots,\\ell$ as $X_t = K + \\delta$, where $\\delta0$ is a small perturbation. Use $\\delta=10^{-4}$.\n   - For each case, run the system for a fixed number of steps $T$ and test local stability by checking whether the absolute deviation $|X_t - K|$ in a trailing window of length $W$ steps is uniformly below a tolerance $\\tau$. Use $T=3000$, $W=200$, and $\\tau=10^{-6}$.\n   - Declare the simulation \"stable\" if $\\max_{t \\in \\{T-W+1,\\dots,T\\}} |X_t-K|  \\tau$. If during simulation $|X_t|$ exceeds $10^{12}$ at any step, immediately declare it \"unstable\" to avoid numerical overflow.\n4. For each test case, compute $r_{\\mathrm{crit}}(\\ell)$ from your analytic expression, then simulate two runs: one with $r = 0.95\\times r_{\\mathrm{crit}}(\\ell)$ (below the boundary) and one with $r = 1.05\\times r_{\\mathrm{crit}}(\\ell)$ (above the boundary), keeping $K=100$ fixed in all tests. Report a boolean for each run indicating whether the simulation is stable according to the criterion described above.\n5. Test suite. Use the following parameter values:\n   - Case A (happy path, no delay): $\\ell=0$, $K=100$.\n   - Case B (short delay): $\\ell=1$, $K=100$.\n   - Case C (moderate delay): $\\ell=2$, $K=100$.\n   - Case D (long delay edge case): $\\ell=10$, $K=100$.\n6. Final output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list of the form $[\\ell, r_{\\mathrm{crit}}, s_{\\mathrm{below}}, s_{\\mathrm{above}}]$, where $r_{\\mathrm{crit}}$ is a float rounded to ten decimal places, $s_{\\mathrm{below}}$ and $s_{\\mathrm{above}}$ are booleans indicating stability below and above the boundary, respectively. For example, a valid output for two cases would look like\n$[[0,2.0000000000,True,False],[1,1.0000000000,True,False]]$\nwith no additional whitespace or text. Angles used in the derivation must be in radians. There are no physical units in this problem, and all numerical answers must be expressible as floats or booleans.",
            "solution": "The problem requires an analysis of the local stability of the non-trivial equilibrium of a discrete-time delayed growth model, the derivation of the stability boundary, and its numerical verification. The model is given by the difference equation\n$$\nX_{t+1} = X_t + r\\,X_t\\left(1-\\frac{X_{t-\\ell}}{K}\\right)\n$$\nwhere $X_t$ is the population at integer time $t \\ge 0$, $r0$ is the intrinsic growth rate, $K0$ is the carrying capacity, and $\\ell \\in \\{0, 1, 2, \\dots\\}$ is the feedback delay.\n\nFirst, we determine the equilibrium points $X^\\star$ by setting $X_{t+1} = X_t = X_{t-\\ell} = X^\\star$. Substituting into the equation gives:\n$$\nX^\\star = X^\\star + r\\,X^\\star\\left(1-\\frac{X^\\star}{K}\\right)\n$$\nThis simplifies to $r\\,X^\\star(1 - X^\\star/K) = 0$. Since $r0$, we have two equilibria: the trivial equilibrium $X^\\star=0$ and the non-trivial carrying-capacity equilibrium $X^\\star=K$. The problem specifies analyzing the stability of the latter, $X^\\star=K$.\n\nTo analyze the local stability, we linearize the system around the equilibrium $X^\\star=K$. Let $X_t = K + \\epsilon_t$, where $\\epsilon_t$ is a small perturbation. Substituting this into the model equation yields:\n$$\nK + \\epsilon_{t+1} = (K + \\epsilon_t) + r(K + \\epsilon_t)\\left(1 - \\frac{K + \\epsilon_{t-\\ell}}{K}\\right)\n$$\nSimplifying the term in the parenthesis:\n$$\n1 - \\frac{K + \\epsilon_{t-\\ell}}{K} = \\frac{K - (K + \\epsilon_{t-\\ell})}{K} = -\\frac{\\epsilon_{t-\\ell}}{K}\n$$\nSubstituting this back into the equation for $\\epsilon_{t+1}$:\n$$\nK + \\epsilon_{t+1} = K + \\epsilon_t + r(K + \\epsilon_t)\\left(-\\frac{\\epsilon_{t-\\ell}}{K}\\right)\n$$\n$$\n\\epsilon_{t+1} = \\epsilon_t - \\frac{r}{K}(K + \\epsilon_t)\\epsilon_{t-\\ell}\n$$\n$$\n\\epsilon_{t+1} = \\epsilon_t - r\\epsilon_{t-\\ell} - \\frac{r}{K}\\epsilon_t\\epsilon_{t-\\ell}\n$$\nFor a local analysis, we consider only the first-order terms in $\\epsilon$. The term $\\frac{r}{K}\\epsilon_t\\epsilon_{t-\\ell}$ is a second-order term and is neglected. This yields the linear time-invariant (LTI) delayed difference equation for the perturbation:\n$$\n\\epsilon_{t+1} = \\epsilon_t - r\\epsilon_{t-\\ell}\n$$\nThe stability of the equilibrium is determined by the stability of this linear system. We seek solutions of the form $\\epsilon_t = c z^t$ for some complex number $z$. Substituting this ansatz into the LTI equation:\n$$\nc z^{t+1} = c z^t - r c z^{t-\\ell}\n$$\nAssuming a non-trivial solution ($c \\neq 0$) and $z \\neq 0$, we can divide by $c z^{t-\\ell}$ to obtain the characteristic equation:\n$$\nz^{\\ell+1} = z^\\ell - r\n$$\n$$\nz^{\\ell+1} - z^\\ell + r = 0\n$$\nThe equilibrium $X^\\star=K$ is locally asymptotically stable if and only if all roots $z$ of this characteristic polynomial lie strictly inside the unit circle in the complex plane, i.e., $|z|1$. A loss of stability occurs when one or more roots cross the unit circle, meaning $|z|=1$.\n\nTo find the stability boundary, we set $z=e^{i\\theta}$, where $\\theta$ is the crossing angle in radians. The characteristic equation becomes:\n$$\n(e^{i\\theta})^{\\ell+1} - (e^{i\\theta})^\\ell + r = 0\n$$\n$$\ne^{i(\\ell+1)\\theta} - e^{i\\ell\\theta} + r = 0\n$$\nUsing Euler's formula, $e^{i\\phi} = \\cos(\\phi) + i\\sin(\\phi)$, we can separate the real and imaginary parts of this equation:\n$$\n[\\cos((\\ell+1)\\theta) - \\cos(\\ell\\theta) + r] + i[\\sin((\\ell+1)\\theta) - \\sin(\\ell\\theta)] = 0\n$$\nFor this equation to hold, both the real and imaginary parts must be zero. From the imaginary part:\n$$\n\\sin((\\ell+1)\\theta) - \\sin(\\ell\\theta) = 0 \\implies \\sin((\\ell+1)\\theta) = \\sin(\\ell\\theta)\n$$\nThis trigonometric equation has two families of solutions for an integer $k$:\n1. $(\\ell+1)\\theta = \\ell\\theta + 2k\\pi \\implies \\theta = 2k\\pi$. This corresponds to a root crossing at $z=e^{i(2k\\pi)}=1$.\n2. $(\\ell+1)\\theta = \\pi - \\ell\\theta + 2k\\pi \\implies (2\\ell+1)\\theta = (2k+1)\\pi \\implies \\theta = \\frac{(2k+1)\\pi}{2\\ell+1}$. This corresponds to a pair of complex-conjugate roots crossing the unit circle.\n\nIn the first case ($\\theta = 2k\\pi$), we substitute $\\theta=0$ into the equation for the real part:\n$r = \\cos(\\ell \\cdot 0) - \\cos((\\ell+1) \\cdot 0) = \\cos(0) - \\cos(0) = 1-1=0$.\nSince the problem states $r0$, this crossing at $z=1$ only occurs at the limit $r=0$ and does not define the stability boundary for positive growth.\n\nIn the second case, we use the angles $\\theta_k = \\frac{(2k+1)\\pi}{2\\ell+1}$ in the equation for the real part to find the value of $r$ at the crossing:\n$$\nr = \\cos(\\ell\\theta_k) - \\cos((\\ell+1)\\theta_k)\n$$\nUsing the prosthaphaeresis identity $\\cos(A) - \\cos(B) = -2\\sin\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$:\n$$\nr = -2\\sin\\left(\\frac{(2\\ell+1)\\theta_k}{2}\\right)\\sin\\left(\\frac{-\\theta_k}{2}\\right) = 2\\sin\\left(\\frac{(2\\ell+1)\\theta_k}{2}\\right)\\sin\\left(\\frac{\\theta_k}{2}\\right)\n$$\nSubstituting the expression for $\\theta_k$:\n$$\n\\frac{(2\\ell+1)\\theta_k}{2} = \\frac{(2\\ell+1)}{2} \\frac{(2k+1)\\pi}{2\\ell+1} = \\frac{(2k+1)\\pi}{2}\n$$\nThus, the expression for $r$ becomes:\n$$\nr = 2\\sin\\left(\\frac{(2k+1)\\pi}{2}\\right)\\sin\\left(\\frac{\\theta_k}{2}\\right) = 2\\sin\\left(k\\pi + \\frac{\\pi}{2}\\right)\\sin\\left(\\frac{(2k+1)\\pi}{2(2\\ell+1)}\\right)\n$$\nSince $\\sin(k\\pi + \\pi/2) = (-1)^k$, we have:\n$$\nr_k = 2(-1)^k \\sin\\left(\\frac{(2k+1)\\pi}{2(2\\ell+1)}\\right)\n$$\nWe seek the smallest positive value of $r$, which is the critical value $r_{\\mathrm{crit}}(\\ell)$ at which stability is first lost as $r$ is increased from $0$. We need to find the integer $k$ that provides this minimum positive $r_k$.\n- If $k$ is an even integer, $k=2m$, then $(-1)^k=1$, and $r_k = 2\\sin\\left(\\frac{(4m+1)\\pi}{2(2\\ell+1)}\\right)$. For $r_k  0$, we need the argument of the sine to be in $(2j\\pi, (2j+1)\\pi)$ for some integer $j$. The smallest positive value is obtained with the smallest argument, which corresponds to $j=0$ and $m=0$ (i.e., $k=0$).\n- If $k$ is an odd integer, $k=2m+1$, then $(-1)^k=-1$, and $r_k = -2\\sin\\left(\\frac{(4m+3)\\pi}{2(2\\ell+1)}\\right)$. For $r_k  0$, we need the argument of the sine to be in $((2j-1)\\pi, 2j\\pi)$.\nBy inspecting the sine function, the smallest positive value of $r_k$ will be generated by the argument closest to zero. This occurs for $k=0$, which yields:\n$$\nr_{\\mathrm{crit}}(\\ell) = r_0 = 2\\sin\\left(\\frac{\\pi}{2(2\\ell+1)}\\right)\n$$\nThis is the explicit analytic expression for the stability boundary. The first loss of stability occurs as a complex-conjugate pair of roots crosses the unit circle at angles $\\pm\\theta_0 = \\pm\\frac{\\pi}{2\\ell+1}$. For $\\ell=0$, $r_{\\mathrm{crit}}(0) = 2\\sin(\\pi/2)=2$, and the crossing angle is $\\theta_0=\\pi$, corresponding to $z=-1$, which correctly recovers the stability boundary of the standard discrete logistic map.\n\nThe design for the numerical verification involves simulating the system for parameter sets just below and just above the analytically derived critical boundary $r_{\\mathrm{crit}}(\\ell)$. The simulation is initialized with a small perturbation from the equilibrium, $X_t = K+\\delta$ for $t \\in \\{0, \\dots, \\ell\\}$. The system is evolved for $T=3000$ steps. Stability is assessed by examining the system's behavior over the last $W=200$ steps. If the absolute deviation from equilibrium, $|X_t-K|$, remains below a small tolerance $\\tau=10^{-6}$ for all $t$ in this trailing window, the system is declared stable. If the system's state grows excessively ($|X_t|10^{12}$), it is immediately declared unstable. This procedure empirically tests whether a small perturbation decays (stability) or grows (instability) as predicted by the linear stability analysis. The tests with $r=0.95 \\times r_{\\mathrm{crit}}(\\ell)$ are expected to be stable, while those with $r=1.05 \\times r_{\\mathrm{crit}}(\\ell)$ are expected to be unstable.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_rcrit(l: int) - float:\n    \"\"\"\n    Calculates the critical growth rate r_crit for a given delay l.\n    The analytical formula is r_crit(l) = 2 * sin(pi / (2 * (2*l + 1))).\n    \"\"\"\n    return 2.0 * np.sin(np.pi / (2.0 * (2.0 * l + 1.0)))\n\ndef simulate(l: int, K: float, r: float) - bool:\n    \"\"\"\n    Simulates the discrete-time delayed growth model.\n\n    Args:\n        l: The integer delay length.\n        K: The carrying capacity.\n        r: The scalar growth rate.\n\n    Returns:\n        A boolean indicating whether the simulation was stable.\n    \"\"\"\n    delta = 1e-4\n    T = 3000\n    W = 200\n    tau = 1e-6\n    overflow_threshold = 1e12\n\n    # State array to hold the time series. Size is T+1 to store X_0, ..., X_T.\n    X = np.zeros(T + 1)\n    \n    # Initialize the history from t=0 to t=l with a small perturbation.\n    # X[0], ..., X[l]\n    for i in range(l + 1):\n        X[i] = K + delta\n    \n    # Run the simulation from t=l to t=T-1 to calculate X[l+1], ..., X[T].\n    for t in range(l, T):\n        # The model equation: X_{t+1} = X_t + r * X_t * (1 - X_{t-l} / K)\n        # indices in array: X[t+1] from X[t] and X[t-l]\n        term = 1.0 - X[t - l] / K\n        X[t + 1] = X[t] + r * X[t] * term\n        \n        # Check for numerical overflow, which indicates instability.\n        if abs(X[t + 1])  overflow_threshold:\n            return False  # Unstable\n\n    # Assess stability by checking the deviation from K in a trailing window.\n    # The window includes time steps from T-W+1 to T.\n    # In the array, this corresponds to indices from T-W+1 to T (inclusive).\n    trailing_window = X[T - W + 1 : T + 1]\n    max_deviation = np.max(np.abs(trailing_window - K))\n    \n    # The simulation is stable if the max deviation is below the tolerance.\n    return max_deviation  tau\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (l, K)\n        (0, 100.0),\n        (1, 100.0),\n        (2, 100.0),\n        (10, 100.0),\n    ]\n\n    results = []\n    for l, K in test_cases:\n        r_crit = calculate_rcrit(l)\n        \n        # Simulate with r just below the critical boundary\n        r_below = 0.95 * r_crit\n        s_below = simulate(l, K, r_below)\n        \n        # Simulate with r just above the critical boundary\n        r_above = 1.05 * r_crit\n        s_above = simulate(l, K, r_above)\n        \n        # Append the formatted result for this test case\n        results.append([l, r_crit, s_below, s_above])\n\n    # Format the final output string as specified\n    formatted_results = []\n    for res in results:\n        l_val, rc_val, sb_val, sa_val = res\n        rc_str = f\"{rc_val:.10f}\"  # Round to 10 decimal places\n        sb_str = str(sb_val)      # \"True\" or \"False\"\n        sa_str = str(sa_val)      # \"True\" or \"False\"\n        formatted_results.append(f\"[{l_val},{rc_str},{sb_str},{sa_str}]\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}