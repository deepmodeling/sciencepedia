{
    "hands_on_practices": [
        {
            "introduction": "对系统动力学原型（System Dynamics Archetypes）的理解，不仅仅停留在绘制因果回路图的定性层面，更在于掌握其背后的动态行为。本练习将引导我们将最经典的“成长上限”（Limits to Growth）原型转化为一个精确的数学模型——逻辑斯谛方程（logistic equation）。通过求解这个常微分方程 ，你将亲手推导出系统从指数增长到最终饱和的完整S形轨迹，从而将抽象的系统结构与具体的动态行为紧密联系起来。",
            "id": "4147273",
            "problem": "考虑一个表现出“增长极限”系统动力学原型的复杂自适应系统，其中一个初始的增强过程因资源饱和而受到一个平衡反馈的抵消。设聚合状态变量 $X(t)$ 代表在时间 $t$ 的活跃主体数量（单位：个体）。这种原型的一个广泛接受的宏观表示是逻辑斯谛常微分方程（ODE），它将净变化率建模为人均增强性增长与饱和引起的平衡项的乘积：\n$$\\frac{dX}{dt} = r\\,X\\left(1 - \\frac{X}{K}\\right).$$\n给定 $r=0.4$，$K=100$，以及初始条件 $X(0)=10$，推导满足该常微分方程和初始条件的 $X(t)$ 的闭式解析表达式，然后计算 $X(20)$ 的值。将最终数值四舍五入到 $4$ 位有效数字，并以个体为单位表示最终答案。",
            "solution": "问题陈述经评估有效。它在科学上基于已建立的种群动力学和系统动力学理论，提出了一个适定的初值问题，包含所有必要数据且无内部矛盾。它是客观的、可形式化的，并且可以使用标准数学技术求解。\n\n问题要求解一个代表种群大小的状态变量 $X(t)$ 的逻辑斯谛常微分方程（ODE）。其控制方程为：\n$$\n\\frac{dX}{dt} = r\\,X\\left(1 - \\frac{X}{K}\\right)\n$$\n提供的参数为内禀增长率 $r = 0.4$，环境承载力 $K = 100$，以及初始条件 $X(0) = 10$。\n\n这是一个一阶非线性常微分方程，可以使用分离变量法求解。首先，我们重新整理方程以分离变量 $X$ 和 $t$：\n$$\n\\frac{dX}{X\\left(1 - \\frac{X}{K}\\right)} = r\\,dt\n$$\n为了对左侧进行积分，我们首先简化表达式，然后使用部分分式分解。\n$$\n\\frac{dX}{X\\frac{K-X}{K}} = \\frac{K}{X(K-X)} dX = r\\,dt\n$$\n我们将项 $\\frac{K}{X(K-X)}$ 分解为部分分式：\n$$\n\\frac{K}{X(K-X)} = \\frac{A}{X} + \\frac{B}{K-X}\n$$\n两边同乘以 $X(K-X)$ 得到：\n$$\nK = A(K-X) + B(X)\n$$\n为了求系数 $A$ 和 $B$，我们可以代入方便的 $X$ 值。\n对于 $X = 0$，我们得到 $K = A(K - 0)$，这意味着 $A = 1$。\n对于 $X = K$，我们得到 $K = B(K)$，这意味着 $B = 1$。\n因此，分解结果为：\n$$\n\\frac{K}{X(K-X)} = \\frac{1}{X} + \\frac{1}{K-X}\n$$\n现在，我们可以将其代回分离后的微分方程并对两边进行积分：\n$$\n\\int \\left(\\frac{1}{X} + \\frac{1}{K-X}\\right) dX = \\int r\\,dt\n$$\n执行积分得到：\n$$\n\\ln|X| - \\ln|K-X| = rt + C\n$$\n其中 $C$ 是积分常数。第二个对数前面的负号是由于对 $\\frac{1}{K-X}$ 关于 $X$ 积分产生的。\n利用对数的性质，我们可以合并左边的项：\n$$\n\\ln\\left|\\frac{X}{K-X}\\right| = rt + C\n$$\n两边取指数以求解比值 $\\frac{X}{K-X}$：\n$$\n\\left|\\frac{X}{K-X}\\right| = \\exp(rt + C) = \\exp(C)\\exp(rt)\n$$\n由于 $X(t)$ 代表一个种群，对于 $0  X  K$，绝对值内的项 $\\frac{X}{K-X}$ 将为正。因此我们可以去掉绝对值符号，并定义一个新常数 $A_0 = \\exp(C)$：\n$$\n\\frac{X}{K-X} = A_0\\exp(rt)\n$$\n我们利用初始条件 $X(0) = 10$ 来确定常数 $A_0$。在 $t=0$ 时：\n$$\n\\frac{X(0)}{K - X(0)} = A_0\\exp(r \\cdot 0) = A_0\n$$\n代入给定值 $K=100$ 和 $X(0)=10$：\n$$\nA_0 = \\frac{10}{100 - 10} = \\frac{10}{90} = \\frac{1}{9}\n$$\n现在我们将 $A_0$ 的值代回关联 $X$ 和 $t$ 的方程中：\n$$\n\\frac{X}{K-X} = \\frac{1}{9}\\exp(rt)\n$$\n下一步是求解 $X(t)$。\n$$\n9X = (K-X)\\exp(rt)\n$$\n$$\n9X = K\\exp(rt) - X\\exp(rt)\n$$\n$$\n9X + X\\exp(rt) = K\\exp(rt)\n$$\n$$\nX(9 + \\exp(rt)) = K\\exp(rt)\n$$\n$$\nX(t) = \\frac{K\\exp(rt)}{9 + \\exp(rt)}\n$$\n为了计算方便，我们可以将分子和分母同除以 $\\exp(rt)$：\n$$\nX(t) = \\frac{K}{9\\exp(-rt) + 1}\n$$\n这就是 $X(t)$ 的闭式解析表达式。代入已知参数值 $K=100$ 和 $r=0.4$：\n$$\nX(t) = \\frac{100}{1 + 9\\exp(-0.4t)}\n$$\n问题要求我们计算 $X(20)$。我们将 $t=20$ 代入推导出的表达式：\n$$\nX(20) = \\frac{100}{1 + 9\\exp(-0.4 \\times 20)} = \\frac{100}{1 + 9\\exp(-8)}\n$$\n现在，我们计算数值。\n$$\n\\exp(-8) \\approx 0.0003354626\n$$\n$$\nX(20) \\approx \\frac{100}{1 + 9(0.0003354626)} = \\frac{100}{1 + 0.0030191634} = \\frac{100}{1.0030191634}\n$$\n$$\nX(20) \\approx 99.6989934\n$$\n问题规定最终数值必须四舍五入到 $4$ 位有效数字。计算值为 $99.6989934...$。前四位有效数字是 $9, 9, 6, 9$。第五位有效数字是 $8$，大于或等于 $5$，所以我们将第四位有效数字向上取整。这使得 $99.69$ 变为 $99.70$。末尾的零是有效数字，必须保留。\n最终评估的种群数量为 $99.70$ 个体。",
            "answer": "$$\n\\boxed{99.70}\n$$"
        },
        {
            "introduction": "在真实的复杂系统中，反馈回路中的“延迟”（delay）无处不在，它也是导致系统行为复杂难测的关键因素。本练习  深入探讨了延迟如何从根本上改变一个简单调节回路的动态特性。通过对比无延迟和有延迟两种情况，你将从数学上揭示为何看似合理的纠正措施，会因为信息或执行的滞后而导致“政策阻力”（policy resistance），即产生目标超越（overshoot）和振荡等非预期后果。",
            "id": "4147224",
            "problem": "在一个复杂自适应系统中，一个单状态平衡回路通过增益为 $k>0$ 的比例校正来调节偏差变量 $x(t)$，使其趋向目标 $x^{\\star}=0$。当调节主体忽略感知延迟时，该回路由常微分方程 $\\dot{x}(t)=-k\\,x(t)$ 建模。当主体的感知存在一个恒定的延迟 $\\tau>0$ 时，该回路由延迟微分方程 $\\dot{x}(t)=-k\\,x(t-\\tau)$ 建模。考虑单位偏差历史 $x(t)=1$ 对所有 $t\\le 0$（表示在 $t=0$ 时有一个单位阶跃偏差）。定义无量纲增益 $a\\equiv k\\,\\tau$。\n\n仅从导数和积分的定义以及分段历史出发，执行以下步骤。\n\n第一，对于延迟模型，在步进法的前两个区间 $0 \\le t \\le \\tau$ 和 $\\tau \\le t \\le 2\\tau$ 上推导响应 $x(t)$。\n\n第二，通过分析所得表达式，确定延迟响应在前两个区间内出现符号反转（即 $x(t)$ 穿过零点）时 $a$ 所需满足的条件，并具体到 $a=\\frac{3}{4}$ 的情况，证明在 $\\left[\\tau,2\\tau\\right)$ 内会发生符号反转。\n\n第三，对于 $a=\\frac{3}{4}$，计算首次穿过零点的时间 $t_{\\mathrm{cross}}$，并将归一化量 $t_{\\mathrm{cross}}/\\tau$ 以闭式表达式的形式报告。\n\n第四，求解无延迟模型 $\\dot{x}(t)=-k\\,x(t)$（其中 $x(0)=1$），并论证其响应是否穿过零点，从而将数学结果与带感知延迟的平衡回路中的“政策阻力”概念联系起来。\n\n以 $t_{\\mathrm{cross}}/\\tau$ 的精确闭式表达式作为最终答案，不对常数进行四舍五入或数值近似。最终答案中不包含任何单位。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 无延迟模型：$\\dot{x}(t)=-k\\,x(t)$，增益 $k0$。\n- 延迟模型：$\\dot{x}(t)=-k\\,x(t-\\tau)$，延迟 $\\tau0$。\n- 目标状态：$x^{\\star}=0$。\n- 历史条件：$x(t)=1$ 对所有 $t\\le 0$。\n- 无延迟模型的初始条件：$x(0)=1$。\n- 无量纲增益的定义：$a\\equiv k\\,\\tau$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础**：该问题描述了一个带恒定延迟的线性时不变系统，这是控制理论和系统动力学中的一个基本课题。所给出的模型是平衡反馈回路的标准表示。由延迟引起的政策阻力概念是复杂系统研究中的一个核心原则。该问题在科学上和数学上都是合理的。\n- **适定性**：问题提供了一个带有指定历史函数的一阶延迟微分方程，通过步进法可以保证其解的唯一性和连续性。问题表述精确，可以得出确定的答案。\n- **客观性**：问题使用精确的数学语言和定量定义进行陈述，没有歧义或主观内容。\n\n**步骤3：结论与行动**\n该问题是有效的，因为它具有科学基础、适定性和客观性。将提供完整解答。\n\n解答过程将依次处理问题的四个部分。\n\n**第一部分：前两个区间上的响应推导**\n\n我们使用步进法求解延迟微分方程 $\\dot{x}(t)=-k\\,x(t-\\tau)$，历史条件为 $x(t)=1$ 对所有 $t \\le 0$。\n\n*区间1：$0 \\le t \\le \\tau$*\n在此区间内，$t$ 的延迟项参数 $t-\\tau$ 位于 $[-\\tau, 0)$ 范围内。根据历史条件，在此范围内 $x(t-\\tau)=1$。因此，该微分方程简化为常微分方程（ODE）：\n$$ \\dot{x}(t) = -k \\cdot 1 = -k $$\n我们从初始值 $x(0)=1$（由边界处的历史函数给出）开始，对该方程从 $s=0$ 积分到 $s=t$。\n$$ \\int_{0}^{t} \\dot{x}(s) \\, ds = \\int_{0}^{t} (-k) \\, ds $$\n$$ x(t) - x(0) = -kt $$\n代入 $x(0)=1$：\n$$ x(t) = 1 - kt \\quad \\text{for } 0 \\le t \\le \\tau $$\n我们包含 $t=\\tau$ 是因为解在区间边界处是连续的。\n\n*区间2：$\\tau \\le t \\le 2\\tau$*\n在此区间内，$t$ 的参数 $t-\\tau$ 位于 $[0, \\tau]$ 范围内。在此范围内，函数 $x$ 由第一个区间的解定义：$x(s) = 1-ks$ 对 $s \\in [0, \\tau]$。因此，我们有 $x(t-\\tau) = 1-k(t-\\tau)$。\n该微分方程变为：\n$$ \\dot{x}(t) = -k \\, x(t-\\tau) = -k [1 - k(t-\\tau)] = -k + k^2(t-\\tau) $$\n我们从第一个区间的解确定的值 $x(\\tau) = 1-k\\tau$ 开始，对此方程从 $s=\\tau$ 积分到 $s=t$。\n$$ \\int_{\\tau}^{t} \\dot{x}(s) \\, ds = \\int_{\\tau}^{t} [-k + k^2(s-\\tau)] \\, ds $$\n$$ x(t) - x(\\tau) = \\left[-ks + \\frac{k^2}{2}(s-\\tau)^2\\right]_{\\tau}^{t} $$\n$$ x(t) - x(\\tau) = \\left(-kt + \\frac{k^2}{2}(t-\\tau)^2\\right) - \\left(-k\\tau + \\frac{k^2}{2}(\\tau-\\tau)^2\\right) $$\n$$ x(t) - x(\\tau) = -kt + k\\tau + \\frac{1}{2}k^2(t-\\tau)^2 = -k(t-\\tau) + \\frac{1}{2}k^2(t-\\tau)^2 $$\n代入 $x(\\tau) = 1-k\\tau$：\n$$ x(t) = (1-k\\tau) - k(t-\\tau) + \\frac{1}{2}k^2(t- \\tau)^2 $$\n$$ x(t) = 1 - k\\tau - kt + k\\tau + \\frac{1}{2}k^2(t-\\tau)^2 $$\n$$ x(t) = 1 - kt + \\frac{1}{2}k^2(t-\\tau)^2 \\quad \\text{for } \\tau \\le t \\le 2\\tau $$\n\n**第二部分：符号反转分析**\n\n当 $x(t)$ 穿过零点时，发生符号反转。由于 $x(0)=1$，这意味着我们在寻找第一个使 $x(t)=0$ 的时间 $t$。\n\n*在 $0 \\le t \\le \\tau$ 上的分析*\n解为 $x(t) = 1-kt$。令 $x(t)=0$ 得到 $1-kt=0$，这意味着 $t = 1/k$。如果 $0  1/k \\le \\tau$，则在此区间内发生符号反转，这简化为 $1 \\le k\\tau$。使用无量纲增益 $a=k\\tau$，条件是 $a \\ge 1$。\n\n*在 $\\tau \\le t \\le 2\\tau$ 上的分析*\n我们考虑在第一个区间内没有发生符号反转的情况，即 $a  1$。如果 $a  1$，那么 $x(t) = 1-kt > 1-k\\tau = 1-a > 0$ 对所有 $t \\in [0, \\tau)$ 成立，所以函数在第一个区间上是正的。\n在第二个区间内的解是 $x(t) = 1 - kt + \\frac{1}{2}k^2(t-\\tau)^2$。我们寻找 $t \\in [\\tau, 2\\tau)$ 使得 $x(t)=0$。\n让我们使用无量纲时间 $\\hat{t}=t/\\tau$。区间变为 $1 \\le \\hat{t}  2$。方程 $x(t)=0$ 变为：\n$$ 1 - (k\\tau)(t/\\tau) + \\frac{1}{2}(k\\tau)^2(t/\\tau - 1)^2 = 0 $$\n$$ 1 - a\\hat{t} + \\frac{1}{2}a^2(\\hat{t}-1)^2 = 0 $$\n将这个关于 $\\hat{t}$ 的二次方程展开：\n$$ 1 - a\\hat{t} + \\frac{1}{2}a^2(\\hat{t}^2 - 2\\hat{t} + 1) = 0 $$\n$$ \\frac{1}{2}a^2\\hat{t}^2 + (-a-a^2)\\hat{t} + (1+\\frac{1}{2}a^2) = 0 $$\n$$ a^2\\hat{t}^2 - 2a(1+a)\\hat{t} + (a^2+2) = 0 $$\n$\\hat{t}$ 的根由二次公式给出：\n$$ \\hat{t} = \\frac{2a(1+a) \\pm \\sqrt{4a^2(1+a)^2 - 4a^2(a^2+2)}}{2a^2} = \\frac{1+a \\pm \\sqrt{(1+a)^2 - (a^2+2)}}{a} $$\n$$ \\hat{t} = \\frac{1+a \\pm \\sqrt{1+2a+a^2 - a^2-2}}{a} = \\frac{1+a \\pm \\sqrt{2a-1}}{a} $$\n对于实数根，判别式必须为非负：$2a-1 \\ge 0$，这意味着 $a \\ge 1/2$。\n我们关心的是第一次穿越，它对应较小的根，$\\hat{t}_1 = \\frac{1+a - \\sqrt{2a-1}}{a}$。\n我们需要找到使该根位于区间 $[\\tau, 2\\tau)$ 内时 $a$ 满足的条件，这对应于 $\\hat{t}_1 \\in [1, 2)$。我们已经假设 $a  1$。\n条件 $\\hat{t}_1 \\ge 1$ 是 $\\frac{1+a - \\sqrt{2a-1}}{a} \\ge 1 \\implies 1+a - \\sqrt{2a-1} \\ge a \\implies 1 \\ge \\sqrt{2a-1} \\implies 1 \\ge 2a-1 \\implies 2 \\ge 2a \\implies a \\le 1$。这与我们的假设一致。\n条件 $\\hat{t}_1  2$ 是 $\\frac{1+a-\\sqrt{2a-1}}{a}  2 \\implies 1+a-\\sqrt{2a-1}  2a \\implies 1-a  \\sqrt{2a-1}$。\n由于我们处于 $a \\in [1/2, 1)$ 的范围内，$1-a$ 是正的，所以我们可以对两边平方：\n$(1-a)^2  2a-1 \\implies 1-2a+a^2  2a-1 \\implies a^2 - 4a + 2  0$。\n$a^2-4a+2=0$ 的根是 $a = \\frac{4 \\pm \\sqrt{16-8}}{2} = 2 \\pm \\sqrt{2}$。二次函数在这些根之间为负，所以 $2-\\sqrt{2}  a  2+\\sqrt{2}$。将此与 $a \\in [1/2, 1)$ 结合，在 $[\\tau, 2\\tau)$ 内发生符号反转的条件是 $a \\in (2-\\sqrt{2}, 1)$。\n对于 $a=3/4$，我们有 $2-\\sqrt{2} \\approx 2-1.414 = 0.586$，所以 $a=0.75$ 在 $(2-\\sqrt{2}, 1)$ 范围内。因此，在 $[\\tau, 2\\tau)$ 内会发生符号反转。\n\n**第三部分：计算 $a=3/4$ 时的 $t_{\\mathrm{cross}}/\\tau$**\n\n我们使用为归一化穿越时间推导的公式 $\\hat{t}_1 = t_{\\mathrm{cross}}/\\tau$ 并代入 $a=3/4$：\n$$ \\frac{t_{\\mathrm{cross}}}{\\tau} = \\hat{t}_1 = \\frac{1+a - \\sqrt{2a-1}}{a} $$\n代入 $a=3/4$：\n$$ \\frac{t_{\\mathrm{cross}}}{\\tau} = \\frac{1+\\frac{3}{4} - \\sqrt{2\\left(\\frac{3}{4}\\right)-1}}{\\frac{3}{4}} = \\frac{\\frac{7}{4} - \\sqrt{\\frac{3}{2}-1}}{\\frac{3}{4}} = \\frac{\\frac{7}{4} - \\sqrt{\\frac{1}{2}}}{\\frac{3}{4}} $$\n$$ \\frac{t_{\\mathrm{cross}}}{\\tau} = \\frac{\\frac{7}{4} - \\frac{1}{\\sqrt{2}}}{\\frac{3}{4}} = \\frac{\\frac{7}{4} - \\frac{\\sqrt{2}}{2}}{\\frac{3}{4}} = \\frac{\\frac{7-2\\sqrt{2}}{4}}{\\frac{3}{4}} = \\frac{7-2\\sqrt{2}}{3} $$\n这就是所要求的闭式表达式。\n\n**第四部分：无延迟模型的解及与政策阻力的联系**\n\n无延迟模型是常微分方程 $\\dot{x}(t) = -k x(t)$，初始条件为 $x(0)=1$。\n这是一个可分离方程：$\\frac{dx}{x} = -k dt$。\n对两边积分得到 $\\ln|x| = -kt + C$，其中 $C$ 是积分常数。\n对两边取指数得到 $|x(t)| = \\exp(-kt+C) = \\exp(C)\\exp(-kt)$。\n这可以写成 $x(t) = A\\exp(-kt)$，其中 $A=\\pm\\exp(C)$。\n使用初始条件 $x(0)=1$，我们发现 $1 = A\\exp(0)$，所以 $A=1$。\n解是：\n$$ x(t) = \\exp(-kt) $$\n由于指数函数 $\\exp(y)$ 对任何实数参数 $y$ 都是严格为正的，并且对于 $t \\ge 0$，$-kt$ 是实数，所以响应 $x(t)$ 总是正的。它从 $x(0)=1$ 开始，渐近衰减至目标 $x^*=0$，但永远不会达到或穿过它。\n\n**与政策阻力的联系**：无延迟系统表现出理想的行为，单调地逼近目标。校正行动总是基于系统当前、正确的状态。相比之下，延迟系统可能表现出超调和振荡。当 $a=k\\tau > 2-\\sqrt{2}$ 时，系统会过度校正并穿过目标 $x=0$。这是因为调节主体基于旧信息（$x(t-\\tau)$）采取行动。当当前状态 $x(t)$ 已接近目标时，过去的状态 $x(t-\\tau)$ 仍然相当大，从而促使持续进行强力校正。这会将当前状态推过目标，进入负值区域。这种由于系统的结构性延迟导致其反应方式破坏了预期的平滑调节的现象，是“政策阻力”的一个典型例子。延迟引入了意想不到的后果（超调），这些后果抵制了简单的比例校正策略。",
            "answer": "$$\\boxed{\\frac{7-2\\sqrt{2}}{3}}$$"
        },
        {
            "introduction": "此项练习是一次综合性的挑战，它融合了“成长上限”与“延迟”这两个核心概念，引导我们分析一个更为复杂的“延迟下的成长上限”（Limits to Growth with Delay）离散系统。在实际问题中，确定系统在何种参数条件下能够保持稳定至关重要，因为过高的增长率或过长的延迟都可能导致系统崩溃或陷入混沌。这项练习  要求你不仅要通过解析推导来确定系统的稳定性边界，还要编写代码进行数值模拟来验证你的理论结果，这体现了理论分析与计算实践相结合的强大能力。",
            "id": "4147282",
            "problem": "考虑一个具有单个平衡反馈延迟的离散时间延迟增长模型，其定义在整数时间 $t \\in \\{0,1,2,\\dots\\}$ 上，由下式给出：\n$$\nX_{t+1} \\;=\\; X_t \\;+\\; r\\,X_t\\left(1-\\frac{X_{t-\\ell}}{K}\\right),\n$$\n其中 $K>0$ 是一个恒定的环境承载力，$r>0$ 是一个标量增长率，而 $\\ell \\in \\{0,1,2,\\dots\\}$ 是一个整数延迟长度。此方程是“带延迟的增长极限”系统动力学原型的一个典范实例：其中有一个增强增长项 $r\\,X_t$ 和一个以延迟 $\\ell$ 作用的平衡反馈 $-\\frac{r}{K}X_t\\,X_{t-\\ell}$。任务是从第一性原理出发，确定平衡点的局部稳定性以及作为延迟 $\\ell$ 函数的稳定性边界，并通过模拟对该边界进行数值验证。\n\n从非线性系统离散时间局部稳定性分析的基本基础出发：\n- 对于一个非线性离散时间系统 $X_{t+1}=F(X_t,X_{t-1},\\dots,X_{t-\\ell})$，一个平衡点 $X^\\star$ 的局部稳定性是通过在 $X^\\star$ 周围对系统进行线性化来评估的，从而得到一个关于小偏差 $\\epsilon_t = X_t - X^\\star$ 的线性时不变 (LTI) 延迟差分方程，然后分析该线性化的特征方程。\n- 对于形式为 $\\epsilon_{t+1} = \\sum_{j=0}^{\\ell} a_j \\epsilon_{t-j}$ 的 LTI 延迟差分方程，局部渐近稳定性成立的充要条件是特征方程的所有复根 $z$ 都严格位于单位圆内部，即对所有根都有 $|z|1$。\n- 当一个或多个特征根穿过单位圆 $|z|=1$ 时，局部稳定性就会丧失；因此，稳定性边界是通过将 $z$ 置于单位圆上，并找到使特征方程成立的参数值来获得的。\n\n你的任务：\n1. 根据上述基础和给定模型，推导出控制平衡点 $X^\\star=K$ 周围小偏差 $\\epsilon_t = X_t - K$ 的 LTI 延迟差分方程，并得到相应的关于复变量 $z$ 的特征多项式。\n2. 使用单位圆穿越条件 $|z|=1$ 及 $z=e^{i\\theta}$（其中角度 $\\theta$ 必须以弧度处理），推导出使 $X^\\star=K$ 的局部稳定性丧失的最小正 $r$ 值（记为 $r_{\\mathrm{crit}}(\\ell)$）作为延迟 $\\ell$ 的函数的显式解析表达式。确保你的推导能够确定对于给定的 $\\ell$，哪一次穿越（即哪个 $\\theta$ 值）导致了最早的稳定性丧失。\n3. 实现延迟增长模型的确定性模拟，以经验性地验证所选 $\\ell$ 值的稳定性边界。使用以下模拟设计：\n   - 将 $t=0,1,\\dots,\\ell$ 的历史值 $X_t$ 初始化为 $X_t = K + \\delta$，其中 $\\delta0$ 是一个小扰动。使用 $\\delta=10^{-4}$。\n   - 对每种情况，将系统运行固定步数 $T$，并通过检查长度为 $W$ 步的尾随窗口中的绝对偏差 $|X_t - K|$ 是否一致地低于容差 $\\tau$ 来测试局部稳定性。使用 $T=3000$，$W=200$，以及 $\\tau=10^{-6}$。\n   - 如果 $\\max_{t \\in \\{T-W+1,\\dots,T\\}} |X_t-K|  \\tau$，则宣称模拟为“稳定”(stable)。如果在模拟过程中 $|X_t|$ 在任何步骤超过 $10^{12}$，为避免数值溢出，立即宣称其为“不稳定”(unstable)。\n4. 对每个测试用例，根据你的解析表达式计算 $r_{\\mathrm{crit}}(\\ell)$，然后模拟两次运行：一次使用 $r = 0.95\\times r_{\\mathrm{crit}}(\\ell)$（边界以下），另一次使用 $r = 1.05\\times r_{\\mathrm{crit}}(\\ell)$（边界以上），在所有测试中保持 $K=100$ 不变。为每次运行报告一个布尔值，指示模拟是否根据上述标准是稳定的。\n5. 测试套件。使用以下参数值：\n   - 情况 A（理想情况，无延迟）：$\\ell=0$, $K=100$。\n   - 情况 B（短延迟）：$\\ell=1$, $K=100$。\n   - 情况 C（中等延迟）：$\\ell=2$, $K=100$。\n   - 情况 D（长延迟边缘情况）：$\\ell=10$, $K=100$。\n6. 最终输出格式。你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果必须是 $[\\ell, r_{\\mathrm{crit}}, s_{\\mathrm{below}}, s_{\\mathrm{above}}]$ 形式的列表，其中 $r_{\\mathrm{crit}}$ 是一个四舍五入到十位小数的浮点数，$s_{\\mathrm{below}}$ 和 $s_{\\mathrm{above}}$ 分别是表示边界以下和以上稳定性的布尔值。例如，两个用例的有效输出应如下所示：\n$[[0,2.0000000000,True,False],[1,1.0000000000,True,False]]$\n不含额外的空白或文本。推导中使用的角度必须以弧度为单位。本问题中没有物理单位，所有数值答案必须能表示为浮点数或布尔值。",
            "solution": "该问题要求分析一个离散时间延迟增长模型的非平凡平衡点的局部稳定性，推导稳定性边界，并进行数值验证。该模型由以下差分方程给出\n$$\nX_{t+1} = X_t + r\\,X_t\\left(1-\\frac{X_{t-\\ell}}{K}\\right)\n$$\n其中 $X_t$ 是在整数时间 $t \\ge 0$ 的种群数量，$r>0$ 是内禀增长率，$K>0$ 是环境承载力，$\\ell \\in \\{0, 1, 2, \\dots\\}$ 是反馈延迟。\n\n首先，我们通过设置 $X_{t+1} = X_t = X_{t-\\ell} = X^\\star$ 来确定平衡点 $X^\\star$。代入方程得到：\n$$\nX^\\star = X^\\star + r\\,X^\\star\\left(1-\\frac{X^\\star}{K}\\right)\n$$\n这简化为 $r\\,X^\\star(1 - X^\\star/K) = 0$。由于 $r>0$，我们有两个平衡点：平凡平衡点 $X^\\star=0$ 和非平凡的环境承载力平衡点 $X^\\star=K$。问题指定分析后者的稳定性，即 $X^\\star=K$。\n\n为了分析局部稳定性，我们在平衡点 $X^\\star=K$ 周围对系统进行线性化。令 $X_t = K + \\epsilon_t$，其中 $\\epsilon_t$ 是一个小扰动。将此代入模型方程得出：\n$$\nK + \\epsilon_{t+1} = (K + \\epsilon_t) + r(K + \\epsilon_t)\\left(1 - \\frac{K + \\epsilon_{t-\\ell}}{K}\\right)\n$$\n简化括号中的项：\n$$\n1 - \\frac{K + \\epsilon_{t-\\ell}}{K} = \\frac{K - (K + \\epsilon_{t-\\ell})}{K} = -\\frac{\\epsilon_{t-\\ell}}{K}\n$$\n将此代回 $\\epsilon_{t+1}$ 的方程中：\n$$\nK + \\epsilon_{t+1} = K + \\epsilon_t + r(K + \\epsilon_t)\\left(-\\frac{\\epsilon_{t-\\ell}}{K}\\right)\n$$\n$$\n\\epsilon_{t+1} = \\epsilon_t - \\frac{r}{K}(K + \\epsilon_t)\\epsilon_{t-\\ell}\n$$\n$$\n\\epsilon_{t+1} = \\epsilon_t - r\\epsilon_{t-\\ell} - \\frac{r}{K}\\epsilon_t\\epsilon_{t-\\ell}\n$$\n对于局部分析，我们只考虑 $\\epsilon$ 的一阶项。项 $\\frac{r}{K}\\epsilon_t\\epsilon_{t-\\ell}$ 是一个二阶项，因此被忽略。这得到了关于扰动的线性时不变 (LTI) 延迟差分方程：\n$$\n\\epsilon_{t+1} = \\epsilon_t - r\\epsilon_{t-\\ell}\n$$\n平衡点的稳定性由这个线性系统的稳定性决定。我们寻找形式为 $\\epsilon_t = c z^t$ 的解，其中 $z$ 是某个复数。将此拟设代入 LTI 方程：\n$$\nc z^{t+1} = c z^t - r c z^{t-\\ell}\n$$\n假设一个非平凡解（$c \\neq 0$）且 $z \\neq 0$，我们可以除以 $c z^{t-\\ell}$ 得到特征方程：\n$$\nz^{\\ell+1} = z^\\ell - r\n$$\n$$\nz^{\\ell+1} - z^\\ell + r = 0\n$$\n平衡点 $X^\\star=K$ 是局部渐近稳定的，当且仅当该特征多项式的所有根 $z$ 都严格位于复平面的单位圆内部，即 $|z|1$。当一个或多个根穿过单位圆时，稳定性丧失，即 $|z|=1$。\n\n为了找到稳定性边界，我们设 $z=e^{i\\theta}$，其中 $\\theta$ 是以弧度为单位的穿越角。特征方程变为：\n$$\n(e^{i\\theta})^{\\ell+1} - (e^{i\\theta})^\\ell + r = 0\n$$\n$$\ne^{i(\\ell+1)\\theta} - e^{i\\ell\\theta} + r = 0\n$$\n使用欧拉公式 $e^{i\\phi} = \\cos(\\phi) + i\\sin(\\phi)$，我们可以分离此方程的实部和虚部：\n$$\n[\\cos((\\ell+1)\\theta) - \\cos(\\ell\\theta) + r] + i[\\sin((\\ell+1)\\theta) - \\sin(\\ell\\theta)] = 0\n$$\n为使此方程成立，实部和虚部都必须为零。从虚部可得：\n$$\n\\sin((\\ell+1)\\theta) - \\sin(\\ell\\theta) = 0 \\implies \\sin((\\ell+1)\\theta) = \\sin(\\ell\\theta)\n$$\n对于整数 $k$，这个三角方程有两族解：\n1. $(\\ell+1)\\theta = \\ell\\theta + 2k\\pi \\implies \\theta = 2k\\pi$。这对应于根在 $z=e^{i(2k\\pi)}=1$ 处穿越。\n2. $(\\ell+1)\\theta = \\pi - \\ell\\theta + 2k\\pi \\implies (2\\ell+1)\\theta = (2k+1)\\pi \\implies \\theta = \\frac{(2k+1)\\pi}{2\\ell+1}$。这对应于一对共轭复根穿过单位圆。\n\n在第一种情况下（$\\theta = 2k\\pi$），我们将 $\\theta=0$ 代入实部的方程：\n$r = \\cos(\\ell \\cdot 0) - \\cos((\\ell+1) \\cdot 0) = \\cos(0) - \\cos(0) = 1-1=0$。\n由于问题规定 $r>0$，这种在 $z=1$ 处的穿越仅在极限 $r=0$ 时发生，并不定义正增长的稳定性边界。\n\n在第二种情况下，我们在实部的方程中使用角度 $\\theta_k = \\frac{(2k+1)\\pi}{2\\ell+1}$ 来找到穿越点处的 $r$ 值：\n$$\nr = \\cos(\\ell\\theta_k) - \\cos((\\ell+1)\\theta_k)\n$$\n使用和差化积恒等式 $\\cos(A) - \\cos(B) = -2\\sin\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$：\n$$\nr = -2\\sin\\left(\\frac{(2\\ell+1)\\theta_k}{2}\\right)\\sin\\left(\\frac{-\\theta_k}{2}\\right) = 2\\sin\\left(\\frac{(2\\ell+1)\\theta_k}{2}\\right)\\sin\\left(\\frac{\\theta_k}{2}\\right)\n$$\n代入 $\\theta_k$ 的表达式：\n$$\n\\frac{(2\\ell+1)\\theta_k}{2} = \\frac{(2\\ell+1)}{2} \\frac{(2k+1)\\pi}{2\\ell+1} = \\frac{(2k+1)\\pi}{2}\n$$\n因此，$r$ 的表达式变为：\n$$\nr = 2\\sin\\left(\\frac{(2k+1)\\pi}{2}\\right)\\sin\\left(\\frac{\\theta_k}{2}\\right) = 2\\sin\\left(k\\pi + \\frac{\\pi}{2}\\right)\\sin\\left(\\frac{(2k+1)\\pi}{2(2\\ell+1)}\\right)\n$$\n由于 $\\sin(k\\pi + \\pi/2) = (-1)^k$，我们有：\n$$\nr_k = 2(-1)^k \\sin\\left(\\frac{(2k+1)\\pi}{2(2\\ell+1)}\\right)\n$$\n我们寻求 $r$ 的最小正值，即临界值 $r_{\\mathrm{crit}}(\\ell)$，在该值处，当 $r$ 从0开始增加时，稳定性首次丧失。我们需要找到提供这个最小正 $r_k$ 的整数 $k$。\n- 如果 $k$ 是偶数，$k=2m$，则 $(-1)^k=1$，且 $r_k = 2\\sin\\left(\\frac{(4m+1)\\pi}{2(2\\ell+1)}\\right)$。为了使 $r_k > 0$，正弦函数的自变量需要在 $(2j\\pi, (2j+1)\\pi)$ 区间内（对于某个整数 $j$）。最小的正值是通过最小的自变量得到的，这对应于 $j=0$ 和 $m=0$（即 $k=0$）。\n- 如果 $k$ 是奇数，$k=2m+1$，则 $(-1)^k=-1$，且 $r_k = -2\\sin\\left(\\frac{(4m+3)\\pi}{2(2\\ell+1)}\\right)$。为了使 $r_k > 0$，正弦函数的自变量需要在 $((2j-1)\\pi, 2j\\pi)$ 区间内。\n通过考察正弦函数，可知 $r_k$ 的最小正值将由最接近零的自变量生成。这在 $k=0$ 时发生，得出：\n$$\nr_{\\mathrm{crit}}(\\ell) = r_0 = 2\\sin\\left(\\frac{\\pi}{2(2\\ell+1)}\\right)\n$$\n这是稳定性边界的显式解析表达式。稳定性的首次丧失发生在一对共轭复根以角度 $\\pm\\theta_0 = \\pm\\frac{\\pi}{2\\ell+1}$ 穿过单位圆时。对于 $\\ell=0$，$r_{\\mathrm{crit}}(0) = 2\\sin(\\pi/2)=2$，穿越角为 $\\theta_0=\\pi$，对应于 $z=-1$，这正确地恢复了标准离散逻辑斯蒂映射的稳定性边界。\n\n数值验证的设计涉及对刚好低于和刚好高于解析推导的临界边界 $r_{\\mathrm{crit}}(\\ell)$ 的参数集进行系统模拟。模拟用平衡点的一个小扰动进行初始化，$X_t = K+\\delta$ 对于 $t \\in \\{0, \\dots, \\ell\\}$。系统演化 $T=3000$ 步。通过检查系统在最后 $W=200$ 步的行为来评估稳定性。如果与平衡点的绝对偏差 $|X_t-K|$ 在这个尾随窗口内的所有 $t$ 都保持在小容差 $\\tau=10^{-6}$ 以下，则系统宣告为稳定。如果系统的状态过度增长（$|X_t|>10^{12}$），则立即宣告为不稳定。这个过程经验性地检验小扰动是如线性稳定性分析所预测的那样衰减（稳定）还是增长（不稳定）。使用 $r=0.95 \\times r_{\\mathrm{crit}}(\\ell)$ 的测试预期是稳定的，而使用 $r=1.05 \\times r_{\\mathrm{crit}}(\\ell)$ 的测试预期是不稳定的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_rcrit(l: int) - float:\n    \"\"\"\n    Calculates the critical growth rate r_crit for a given delay l.\n    The analytical formula is r_crit(l) = 2 * sin(pi / (2 * (2*l + 1))).\n    \"\"\"\n    return 2.0 * np.sin(np.pi / (2.0 * (2.0 * l + 1.0)))\n\ndef simulate(l: int, K: float, r: float) - bool:\n    \"\"\"\n    Simulates the discrete-time delayed growth model.\n\n    Args:\n        l: The integer delay length.\n        K: The carrying capacity.\n        r: The scalar growth rate.\n\n    Returns:\n        A boolean indicating whether the simulation was stable.\n    \"\"\"\n    delta = 1e-4\n    T = 3000\n    W = 200\n    tau = 1e-6\n    overflow_threshold = 1e12\n\n    # State array to hold the time series. Size is T+1 to store X_0, ..., X_T.\n    X = np.zeros(T + 1)\n    \n    # Initialize the history from t=0 to t=l with a small perturbation.\n    # X[0], ..., X[l]\n    for i in range(l + 1):\n        X[i] = K + delta\n    \n    # Run the simulation from t=l to t=T-1 to calculate X[l+1], ..., X[T].\n    for t in range(l, T):\n        # The model equation: X_{t+1} = X_t + r * X_t * (1 - X_{t-l} / K)\n        # indices in array: X[t+1] from X[t] and X[t-l]\n        term = 1.0 - X[t - l] / K\n        X[t + 1] = X[t] + r * X[t] * term\n        \n        # Check for numerical overflow, which indicates instability.\n        if abs(X[t + 1])  overflow_threshold:\n            return False  # Unstable\n\n    # Assess stability by checking the deviation from K in a trailing window.\n    # The window includes time steps from T-W+1 to T.\n    # In the array, this corresponds to indices from T-W+1 to T (inclusive).\n    trailing_window = X[T - W + 1 : T + 1]\n    max_deviation = np.max(np.abs(trailing_window - K))\n    \n    # The simulation is stable if the max deviation is below the tolerance.\n    if max_deviation  tau:\n        return True # Stable\n    else:\n        return False # Unstable\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (l, K)\n        (0, 100.0),\n        (1, 100.0),\n        (2, 100.0),\n        (10, 100.0),\n    ]\n\n    results = []\n    for l, K in test_cases:\n        r_crit = calculate_rcrit(l)\n        \n        # Simulate with r just below the critical boundary\n        r_below = 0.95 * r_crit\n        s_below = simulate(l, K, r_below)\n        \n        # Simulate with r just above the critical boundary\n        r_above = 1.05 * r_crit\n        s_above = simulate(l, K, r_above)\n        \n        # Append the formatted result for this test case\n        results.append([l, r_crit, s_below, s_above])\n\n    # Format the final output string as specified\n    formatted_results = []\n    for res in results:\n        l_val, rc_val, sb_val, sa_val = res\n        rc_str = f\"{rc_val:.10f}\"  # Round to 10 decimal places\n        sb_str = str(sb_val)      # \"True\" or \"False\"\n        sa_str = str(sa_val)      # \"True\" or \"False\"\n        formatted_results.append(f\"[{l_val},{rc_str},{sb_str},{sa_str}]\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}