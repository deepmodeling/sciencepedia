{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础练习开始，旨在巩固离散时间线性系统稳定性分析的核心技能。这项练习要求我们从基本原理出发，推导出决定一个二维动态系统稳定性的代数条件 。更重要的是，它通过将这些条件在参数空间中可视化，帮助我们建立起对“稳定性区域”的直观理解，这是连接抽象数学判据与具体系统行为的关键一步。",
            "id": "4123610",
            "problem": "考虑一个复杂自适应系统中标量宏观可观测量的一个聚合的、依赖于记忆的更新规则，其模型为二阶线性递推关系\n$$\ny_{t+1} \\;=\\; a\\,y_t \\;+\\; b\\,y_{t-1},\n$$\n其中$a$和$b$是无量纲实参数，分别编码瞬时响应和一步记忆。令二维状态为$\\mathbf{x}_t = (y_t, y_{t-1})^{\\top}$，因此不动点$\\mathbf{x}^{\\ast} = \\mathbf{0}$是系统的一个平衡点。在线性时不变系统的离散时间稳定性分析中，不动点的渐近稳定性等价于舒尔稳定性，即雅可比矩阵（在此为线性递推的系统矩阵）的所有特征值都严格位于单位圆盘内部。\n\n仅使用离散时间稳定性的基本原理和针对2次多项式的朱莉判据，完成以下任务：\n\n1.  从第一性原理和朱莉判据的构造出发，推导出关于$(a,b)$的显式代数不等式，这些不等式是不动点$\\mathbf{x}^{\\ast} = \\mathbf{0}$舒尔稳定的充分必要条件。\n\n2.  通过将这些不等式解释为$(a,b)$平面中的半平面约束，并定性地描述由此产生的稳定区域$\\mathcal{S}$（凸性、边界线和顶点），来解释这些不等式的几何意义。\n\n3.  计算稳定区域$\\mathcal{S}$在$(a,b)$平面中的确切勒贝格面积。\n\n将最终面积表示为一个精确的无量纲数。无需四舍五入。",
            "solution": "该问题要求分析二阶线性递推关系$y_{t+1} = a\\,y_t + b\\,y_{t-1}$的不动点$\\mathbf{x}^{\\ast} = \\mathbf{0}$的稳定性。此分析将通过使用朱莉判据推导参数$(a,b)$的舒尔稳定性条件，从几何上解释这些条件，并计算所得稳定区域的面积来完成。\n\n首先，我们将二阶递推关系表示为一阶向量-矩阵方程。设状态向量为$\\mathbf{x}_t = (y_t, y_{t-1})^{\\top}$。则动力学由下式给出：\n$$\n\\mathbf{x}_{t+1} = \\begin{pmatrix} y_{t+1} \\\\ y_t \\end{pmatrix} = \\begin{pmatrix} a  b \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} y_t \\\\ y_{t-1} \\end{pmatrix} = A \\mathbf{x}_t\n$$\n其中$A = \\begin{pmatrix} a  b \\\\ 1  0 \\end{pmatrix}$是系统矩阵，也称为特征多项式的友矩阵。\n\n不动点$\\mathbf{x}^{\\ast} = \\mathbf{0}$是渐近稳定的，当且仅当矩阵$A$的所有特征值的模都严格小于$1$。这是矩阵$A$的舒尔稳定性的定义。$A$的特征值$\\lambda$是特征方程$\\det(A - \\lambda I) = 0$的根。\n$$\n\\det\\left(\\begin{pmatrix} a  b \\\\ 1  0 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\\right) = \\det\\begin{pmatrix} a-\\lambda  b \\\\ 1  -\\lambda \\end{pmatrix} = (a-\\lambda)(-\\lambda) - b = \\lambda^2 - a\\lambda - b = 0\n$$\n设特征多项式为$P(\\lambda) = \\lambda^2 - a\\lambda - b$。为满足舒尔稳定性，$P(\\lambda)$的根必须严格位于复平面的单位圆盘内部。\n\n**1. 使用朱莉判据推导稳定性条件**\n\n朱莉判据为一个多项式的所有根都位于单位圆盘内提供了充分必要条件。对于形如$P(\\lambda) = c_2\\lambda^2 + c_1\\lambda + c_0$且系数为实数、$c_2 > 0$的二次多项式，其条件为：\n1. $P(1) > 0$\n2. $(-1)^2 P(-1) > 0$，可简化为$P(-1) > 0$\n3. $|c_0|  c_2$\n\n对于我们的特征多项式$P(\\lambda) = \\lambda^2 - a\\lambda - b$，其系数为$c_2=1$，$c_1=-a$，$c_0=-b$。由于$c_2=1>0$，我们可以直接应用朱莉判据。\n\n条件 1: $P(1) > 0$\n$$\nP(1) = 1^2 - a(1) - b = 1 - a - b > 0 \\implies a+b  1 \\quad \\text{或} \\quad b  1-a\n$$\n\n条件 2: $P(-1) > 0$\n$$\nP(-1) = (-1)^2 - a(-1) - b = 1 + a - b > 0 \\implies a-b > -1 \\quad \\text{或} \\quad b  1+a\n$$\n\n条件 3: $|c_0|  c_2$\n$$\n|-b|  1 \\implies |b|  1 \\implies -1  b  1\n$$\n\n因此，不动点$\\mathbf{x}^{\\ast} = \\mathbf{0}$渐近稳定的充分必要条件是关于参数$(a,b)$的以下三个不等式：\n1. $a+b  1$\n2. $a-b > -1$ (或 $b-a  1$)\n3. $|b|  1$\n\n**2. 稳定区域的几何解释**\n\n这组不等式在$(a,b)$平面中定义了一个区域$\\mathcal{S}$，称为稳定区域。我们将每个不等式解释为一个开半平面：\n- $b  1-a$：直线$b = 1-a$下方的区域。\n- $b  1+a$：直线$b = 1+a$下方的区域。\n- $b > -1$：直线$b = -1$上方的区域。\n- $b  1$：直线$b = 1$下方的区域。\n\n稳定区域$\\mathcal{S}$是这些半平面的交集。我们可以证明条件$b1$是多余的。该区域的上边界由$b  \\min(1-a, 1+a)$确定。\n- 当$a \\ge 0$时，$1-a \\le 1+a$，所以边界是$b  1-a$。因为$a \\ge 0$，所以$1-a \\le 1$，因此$b1-a$意味着$b1$。\n- 当$a  0$时，$1+a  1-a$，所以边界是$b  1+a$。因为$a0$，所以$1+a1$，因此$b1+a$意味着$b1$。\n因此，不等式$b1$被另外两个上界不等式$b  1-a$和$b  1+a$所蕴含。\n\n于是，稳定区域$\\mathcal{S}$由简化的三个不等式定义：\n1. $b  1-a$\n2. $b  1+a$\n3. $b > -1$\n\n该区域是$(a,b)$平面中的一个开三角形。\n- **凸性**：由于$\\mathcal{S}$是三个凸集（开半平面）的交集，它本身也是一个凸集。\n- **边界与顶点**：区域的边界是直线$b = 1-a$、$b = 1+a$和$b = -1$。$\\mathcal{S}$闭包的顶点是这些直线的交点：\n    - $b=1-a$和$b=1+a$的交点：\n      $1-a = 1+a \\implies 2a=0 \\implies a=0$。则$b=1$。顶点为$(0,1)$。\n    - $b=1-a$和$b=-1$的交点：\n      $-1 = 1-a \\implies a=2$。顶点为$(2,-1)$。\n    - $b=1+a$和$b=-1$的交点：\n      $-1 = 1+a \\implies a=-2$。顶点为$(-2,-1)$。\n稳定区域$\\mathcal{S}$是顶点为$(-2, -1)$、$(2, -1)$和$(0, 1)$的三角形的内部。\n\n**3. 稳定区域的面积**\n\n我们计算三角形区域$\\mathcal{S}$在$(a,b)$平面中的勒贝格面积。我们可以取连接顶点$(-2,-1)$和$(2,-1)$的线段作为三角形的底。该线段位于直线$b=-1$上。\n- 底的长度是$a$坐标之差：\n  $$ \\text{底} = 2 - (-2) = 4 $$\n- 三角形的高是从第三个顶点$(0,1)$到底所在直线$b=-1$的垂直距离。这是$b$坐标之差：\n  $$ \\text{高} = 1 - (-1) = 2 $$\n- 三角形的面积由公式$\\frac{1}{2} \\times \\text{底} \\times \\text{高}$给出。\n  $$ \\text{面积}(\\mathcal{S}) = \\frac{1}{2} \\times 4 \\times 2 = 4 $$\n稳定区域$\\mathcal{S}$的确切勒贝格面积为$4$。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "在掌握了线性分析的基础后，我们接着探讨其局限性。这项练习展示了一个在复杂自适应系统中常见的现象：即使一个不动点是线性稳定的，非线性效应也可能在它附近催生出更复杂的动态行为，例如不变的极限环 。这个思想实验作为一个警示，提醒我们不能完全依赖线性化方法来预测系统的全局行为，并突出了非线性在创造新动力学模式中的关键作用。",
            "id": "4123556",
            "problem": "考虑一个复杂自适应系统 (CAS) 框架内，两个耦合自适应性状局部共同演化的离散时间模型。设时间 $t$ 的状态为 $x_t \\in \\mathbb{R}^2$，并定义其复数表示为 $z_t = x_{t,1} + i x_{t,2} \\in \\mathbb{C}$。其更新规则在内部平衡点附近由非线性范式指定\n$$\nz_{t+1} = \\big(\\rho + \\alpha |z_t|^2\\big)\\, z_t \\, \\exp\\!\\big(i\\big(\\theta + \\beta |z_t|^2\\big)\\big),\n$$\n其中参数满足 $0\\rho1$, $\\alpha0$, $\\theta \\in (0,2\\pi)$ 及 $\\beta \\in \\mathbb{R}$。分析的基础是：(i) 通过雅可比线性化对不动点稳定性的离散时间定义，以及 (ii) 对于一个集合，在某个映射作用下，其像集与原集合相等的集合不变性条件。\n\n任务：\n1. 使用线性化的定义，计算映射在不动点 $z^* = 0$ 处的雅可比矩阵，并确定其特征值的模。根据这些模的大小，说明其对局部稳定性的影响。\n2. 使用集合的不变性条件，推导在该映射下非平凡不变闭合曲线（不变循环）的半径 $r0$ 的精确表达式（如果该半径存在）。解释尽管不动点是局部线性稳定的，但非线性项在创建此不变循环中所起的作用。\n3. 对参数值 $\\rho = 0.995$ 和 $\\alpha = 0.200$，计算任务2中求得的半径。将最终数值四舍五入至五位有效数字。答案以无单位的纯数形式表示。",
            "solution": "我们从适用于离散时间动力系统的核心定义开始：一个不动点 $z^*$ 满足 $z_{t+1} = z_t = z^*$；其局部稳定性由在 $z^*$ 处的雅可比矩阵的特征值决定，特别是其模是否小于1。一个集合 $S$ 在映射 $F$ 下是不变的，需满足 $F(S) = S$。对于 $\\mathbb{C} \\cong \\mathbb{R}^2$ 上的径向对称映射，一条闭合不变曲线可以由其在诱导的径向动力学下的恒定半径 $r0$ 来表征。\n\n任务1：计算在 $z^* = 0$ 处的雅可比矩阵，并推断特征值的模及稳定性。\n\n定义映射 $F:\\mathbb{C}\\to\\mathbb{C}$ 为\n$$\nF(z) = \\big(\\rho + \\alpha |z|^2\\big)\\,z\\, \\exp\\!\\big(i\\big(\\theta + \\beta |z|^2\\big)\\big).\n$$\n在 $z=0$ 处，与 $|z|^2$ 成正比的非线性项消失。关于 $z=0$ 的一阶（线性）近似为\n$$\nF(z) \\approx \\rho\\, z\\, \\exp(i\\theta).\n$$\n将 $z$ 解释为 $\\mathbb{R}^2$ 中的一个向量，此线性化是绕原点旋转角度 $\\theta$ 后再按因子 $\\rho$ 进行缩放。因此，在 $z^*=0$ 处的雅可比矩阵为\n$$\nJ(0) = \\rho \\begin{pmatrix}\n\\cos\\theta  -\\sin\\theta \\\\\n\\sin\\theta  \\cos\\theta\n\\end{pmatrix}.\n$$\n$J(0)$ 的特征值是共轭复数对\n$$\n\\lambda_{1,2} = \\rho \\big(\\cos\\theta \\pm i \\sin\\theta\\big) = \\rho \\exp(\\pm i\\theta),\n$$\n两者的模均为\n$$\n|\\lambda_{1}| = |\\lambda_{2}| = \\rho.\n$$\n由于 $0\\rho1$，特征值的模严格小于1，这意味着不动点 $z^* = 0$ 在线性化下是局部渐近稳定的。\n\n任务2：推导非平凡不变闭合曲线的半径。\n\n我们分析半径 $r_t = |z_t|$ 的诱导动力学。根据该映射，\n$$\n|z_{t+1}| = \\big|\\big(\\rho + \\alpha |z_t|^2\\big)\\, z_t \\, \\exp\\!\\big(i\\big(\\theta + \\beta |z_t|^2\\big)\\big)\\big| = \\big(\\rho + \\alpha r_t^2\\big)\\, r_t,\n$$\n因为指数因子的模为1。因此，径向动力学由一维映射描述\n$$\nr_{t+1} = g(r_t) = \\big(\\rho + \\alpha r_t^2\\big)\\, r_t.\n$$\n具有恒定半径 $r0$ 的闭合不变曲线对应于映射 $g$ 的一个正不动点 $r0$，即，\n$$\nr = \\big(\\rho + \\alpha r^2\\big)\\, r.\n$$\n此条件得出 $r=0$ 或\n$$\n\\rho + \\alpha r^2 = 1.\n$$\n求解 $r0$ 可得\n$$\nr = \\sqrt{\\frac{1 - \\rho}{\\alpha}}.\n$$\n因为 $0\\rho1$ 且 $\\alpha0$，平方根下的量为正，所以存在一个非平凡的半径 $r0$。这条闭合不变曲线是线性化方法无法预测的，因为线性化只评估在 $z^* = 0$ 附近任意近的局部行为；与 $|z|^2$ 成正比的非线性项产生了一个依赖于振幅的增长因子，该因子恰好在推导出的半径处等于1，从而生成了不变循环。\n\n为完整起见，我们可以通过计算 $g$ 在 $r$ 处的导数来评估此不变循环的径向稳定性。计算\n$$\ng'(r) = \\frac{d}{dr}\\big(\\rho r + \\alpha r^3\\big) = \\rho + 3\\alpha r^2.\n$$\n在不变半径处，使用 $\\alpha r^2 = 1 - \\rho$ 可得\n$$\ng'(r) = \\rho + 3(1 - \\rho) = 3 - 2\\rho.\n$$\n对于 $0\\rho1$，$g'(r) \\in (1,3)$，因此该不变循环是径向不稳定的（排斥的）。这展示了线性分析的局限性：尽管在不动点处 $|\\lambda|1$ 因而具有局部渐近稳定性，但非线性项可以生成一个附近的不变结构（此处为一个排斥的闭合曲线），而这仅从雅可比矩阵是无法推断的。\n\n任务3：对 $\\rho = 0.995$ 和 $\\alpha = 0.200$ 计算半径。\n\n将给定参数代入精确表达式：\n$$\nr = \\sqrt{\\frac{1 - \\rho}{\\alpha}} = \\sqrt{\\frac{1 - 0.995}{0.200}} = \\sqrt{\\frac{0.005}{0.200}} = \\sqrt{0.025}.\n$$\n因此，\n$$\nr = 0.158113883\\ldots\n$$\n四舍五入至五位有效数字，其值为\n$$\nr \\approx 0.15811.\n$$\n在给定的归一化下，此半径没有单位。",
            "answer": "$$\\boxed{0.15811}$$"
        },
        {
            "introduction": "最后，我们将稳定性分析的工具应用于复杂系统研究的一个核心问题：网络中的集体行为。这项练习将带领我们分析一个由相互耦合的动力学单元组成的网络，并探究其同步状态的稳定性 。通过这个实践，我们将学习如何将对单个单元的分析扩展到一个庞大的互动整体，并揭示网络的连接结构（即拓扑）如何决定整个系统的宏观稳定性，从而在局部动力学和涌现的全局模式之间建立起桥梁。",
            "id": "4123594",
            "problem": "考虑一个由 $N$ 个相同的离散时间动力学单元组成的网络，这些单元通过一个无向连通图进行扩散耦合，该图的邻接矩阵为 $A \\in \\mathbb{R}^{N \\times N}$，图拉普拉斯矩阵为 $L = D - A$，其中 $D$ 是对角度矩阵。每个单元是一个参数为 $r  0$ 的 logistic 映射，定义为 $f(x) = r x (1 - x)$。该网络系统根据以下方程演化：\n$$\nx_{i,t+1} = f(x_{i,t}) - \\varepsilon \\sum_{j=1}^N L_{ij} f(x_{j,t}), \\quad i = 1, \\dots, N,\n$$\n其中 $\\varepsilon \\ge 0$ 是耦合强度，$t \\in \\mathbb{Z}_{\\ge 0}$ 是离散时间。\n\n同步平衡态是所有单元共享相同值的状态，即对每个 $i$ 都有 $x_{i,t} = x^\\star$，其中 $x^\\star$ 是孤立 logistic 映射的一个不动点。当 $r  1$ 时，非平凡不动点为 $x^\\star = 1 - \\frac{1}{r}$。同步平衡态的稳定性取决于网络拓扑，具体取决于图拉普拉斯矩阵 $L$ 的谱，特别是其代数连通度（定义为 $L$ 的第二小特征值 $\\lambda_2$）和最大特征值 $\\lambda_N$。\n\n仅从 logistic 映射、同步平衡态、离散时间系统的线性化以及无向连通图的拉普拉斯矩阵的谱性质这些基本定义出发，推导同步平衡态的稳定性条件（用耦合强度 $\\varepsilon$ 和拉普拉斯特征值表示），并用此条件计算稳定性裕度。稳定性裕度定义为使得同步平衡态相对于所有横向模式保持线性稳定的 $\\varepsilon \\ge 0$ 值区间的宽度。\n\n你的程序必须：\n- 对每个测试用例，计算使同步平衡态线性稳定的 $\\varepsilon \\ge 0$ 区间，并返回三个值 $[\\varepsilon_{\\text{lower}}, \\varepsilon_{\\text{upper}}, \\text{width}]$，其中 $\\varepsilon_{\\text{lower}}$ 是下界，$\\varepsilon_{\\text{upper}}$ 是上界，且 $\\text{width} = \\max\\{\\varepsilon_{\\text{upper}} - \\varepsilon_{\\text{lower}}, 0\\}$。如果稳定区间为空，则为该用例输出 $[0.0, 0.0, 0.0]$。\n- 使用以下网络和参数的测试套件：\n    1. 一个具有 $N = 5$ 个节点和 $r = 2.5$ 的路径图。\n    2. 一个具有 $N = 6$ 个节点和 $r = 3.0$ 的循环（环形）图。\n    3. 一个具有 $N = 5$ 个节点和 $r = 3.2$ 的完全图。\n    4. 一个具有 $N = 8$ 个节点和 $r = 3.8$ 的循环（环形）图。\n- 对每个图，按如下方式构造邻接矩阵 $A$：\n    - 路径图：$A_{i,i+1} = A_{i+1,i} = 1$ 对 $i = 1, \\dots, N-1$ 成立，其他情况为 $0$。\n    - 循环（环形）图：$A_{i,i+1} = A_{i+1,i} = 1$ 对 $i = 1, \\dots, N-1$ 成立，$A_{1,N} = A_{N,1} = 1$，其他情况为 $0$。\n    - 完全图：$A_{ij} = 1$ 对 $i \\ne j$ 成立，且 $A_{ii} = 0$。\n- 计算拉普拉斯矩阵 $L = D - A$ 及其特征值，并在评估稳定性时仅使用代数连通度 $\\lambda_2$ 和最大特征值 $\\lambda_N$。\n- 将最终输出表示为单行，其中包含一个用方括号括起来的逗号分隔列表，每个元素对应一个测试用例，本身是 $[\\varepsilon_{\\text{lower}}, \\varepsilon_{\\text{upper}}, \\text{width}]$ 形式的列表。所有数值输出必须是十进制数（浮点数）。程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，\"[[e1_lower,e1_upper,e1_width],[e2_lower,e2_upper,e2_width],...]\"）。\n\n此问题不涉及任何物理单位或角度；所有量都是无量纲的。",
            "solution": "### 稳定性条件的推导\n\n网络化系统的动力学由下式给出\n$$\nx_{i,t+1} = f(x_{i,t}) - \\varepsilon \\sum_{j=1}^N L_{ij} f(x_{j,t})\n$$\n对每个单元 $i \\in \\{1, \\dots, N\\}$ 成立，其中 $f(x) = rx(1-x)$ 是 logistic 映射，$\\varepsilon \\ge 0$ 是耦合强度，$L$ 是底层网络的图拉普拉斯矩阵。该系统可以写成紧凑的向量形式。令 $\\mathbf{x}_t = (x_{1,t}, x_{2,t}, \\dots, x_{N,t})^T$ 为系统在时间 $t$ 的状态向量。令 $F(\\mathbf{x}_t)$ 为向量函数，其第 $i$ 个分量是 $f(x_{i,t})$。系统动力学可以表示为：\n$$\n\\mathbf{x}_{t+1} = F(\\mathbf{x}_t) - \\varepsilon L F(\\mathbf{x}_t) = (I - \\varepsilon L) F(\\mathbf{x}_t)\n$$\n其中 $I$ 是 $N \\times N$ 单位矩阵。我们将整个系统的映射表示为 $G(\\mathbf{x}) = (I - \\varepsilon L) F(\\mathbf{x})$。\n\n同步平衡态是一个状态 $\\mathbf{x}^\\star = (x^\\star, x^\\star, \\dots, x^\\star)^T$，它是系统的一个不动点，即 $G(\\mathbf{x}^\\star) = \\mathbf{x}^\\star$。要使该状态成为平衡态，$x^\\star$ 必须是孤立 logistic 映射的不动点，即 $f(x^\\star) = x^\\star$。问题指明了当 $r1$ 时的非平凡不动点是 $x^\\star = 1-1/r$。我们可以验证 $\\mathbf{x}^\\star$ 是整个系统的一个不动点：因为 $F(\\mathbf{x}^\\star) = \\mathbf{x}^\\star$，且对于任何无向图的拉普拉斯矩阵，$L$ 的行和为零，所以 $L\\mathbf{x}^\\star = \\mathbf{0}$。因此 $G(\\mathbf{x}^\\star) = (I - \\varepsilon L) \\mathbf{x}^\\star = \\mathbf{x}^\\star - \\mathbf{0} = \\mathbf{x}^\\star$。\n\n为了分析这个不动点的线性稳定性，我们计算映射 $G(\\mathbf{x})$ 在 $\\mathbf{x}^\\star$ 处的雅可比矩阵 $J$。\n$$\nJ_{ij} = \\frac{\\partial G_i}{\\partial x_j}\\bigg|_{\\mathbf{x}=\\mathbf{x}^\\star} = \\delta_{ij} f'(x^\\star) - \\varepsilon L_{ij} f'(x^\\star)\n$$\n其中 $\\delta_{ij}$ 是克罗内克 delta。令 $\\alpha = f'(x^\\star)$。那么雅可比矩阵可以写成 $J = \\alpha I - \\varepsilon \\alpha L = \\alpha(I - \\varepsilon L)$。\n\n同步平衡态 $\\mathbf{x}^\\star$ 是线性稳定的，当且仅当雅可比矩阵 $J$ 的所有特征值 $\\mu$ 的模都小于 1，即 $|\\mu|  1$。$J$ 的特征值与图拉普拉斯矩阵 $L$ 的特征值直接相关。令 $0 = \\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_N$ 为 $L$ 的特征值。$J$ 的特征值为 $\\mu_k = \\alpha(1 - \\varepsilon \\lambda_k)$，其中 $k=1, \\dots, N$。\n\n问题关注的是相对于横向模式的稳定性，这些模式对应于破坏同步的扰动，与 $k=2, \\dots, N$ (其中 $\\lambda_k > 0$) 相关联。\nlogistic 映射在不动点 $x^\\star = 1 - 1/r$ 处的导数为：\n$$\n\\alpha = f'(x^\\star) = r(1 - 2(1 - 1/r)) = 2 - r\n$$\n稳定性条件是对于所有 $k=2, \\dots, N$，都有 $|(2-r)(1 - \\varepsilon \\lambda_k)|  1$。\n该不等式可写为 $-1  (2-r)(1 - \\varepsilon \\lambda_k)  1$。\n\n根据 $r$ 的值，我们分两种情况进行分析：\n\n**情况 1：$2  r \\le 3$**。此时 $-1 \\le 2-r  0$。不等式变为：\n$$\n\\frac{1}{2-r} > 1 - \\varepsilon \\lambda_k > \\frac{-1}{2-r}\n$$\n由于 $2-r$ 是负数，$\\frac{1}{2-r} \\le -1$，所以左侧不等式 $1 - \\varepsilon \\lambda_k  \\frac{1}{2-r}$ 对于任何 $\\varepsilon \\ge 0, \\lambda_k > 0$ 都是满足的。因此，我们只需要考虑右侧不等式：\n$$\n1 - \\varepsilon \\lambda_k > \\frac{-1}{2-r} \\implies \\varepsilon \\lambda_k  1 + \\frac{1}{2-r} = \\frac{r-1}{r-2}\n$$\n这必须对所有 $k=2, \\dots, N$ 成立，因此我们必须满足最严格的约束，即对应于最大特征值 $\\lambda_N$ 的约束：\n$$\n\\varepsilon  \\frac{r-1}{(r-2)\\lambda_N}\n$$\n因此，稳定区间是 $\\varepsilon \\in [0, \\frac{r-1}{(r-2)\\lambda_N})$。\n$\\varepsilon_{\\text{lower}} = 0$, $\\varepsilon_{\\text{upper}} = \\frac{r-1}{(r-2)\\lambda_N}$。\n\n**情况 2：$r > 3$**。此时 $2-r  -1$。不等式仍然是：\n$$\n\\frac{1}{2-r} > 1 - \\varepsilon \\lambda_k > \\frac{-1}{2-r}\n$$\n现在 $0  \\frac{-1}{2-r}  1$。两边不等式都有意义。\n$$\n1 + \\frac{1}{2-r}  \\varepsilon\\lambda_k  1 - \\frac{1}{2-r}\n$$\n$$\n\\frac{r-3}{r-2}  \\varepsilon\\lambda_k  \\frac{r-1}{r-2}\n$$\n这必须对所有 $k=2, \\dots, N$ 成立。因此，$\\varepsilon$ 的区间是所有这些单个区间的交集：\n$$\n\\max_{k=2,\\dots,N} \\left( \\frac{r-3}{(r-2)\\lambda_k} \\right)  \\varepsilon  \\min_{k=2,\\dots,N} \\left( \\frac{r-1}{(r-2)\\lambda_k} \\right)\n$$\n这给出了稳定区间的边界：\n$$\n\\varepsilon_{\\text{lower}} = \\frac{r-3}{(r-2)\\lambda_2}, \\quad \\varepsilon_{\\text{upper}} = \\frac{r-1}{(r-2)\\lambda_N}\n$$\n仅当 $\\varepsilon_{\\text{lower}}  \\varepsilon_{\\text{upper}}$ 时，此区间非空。\n\n### 计算程序\n以下 Python 代码实现了上述推导的逻辑，用于计算给定测试用例的稳定性裕度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef construct_graph_laplacian(N, graph_type):\n    \"\"\"\n    Constructs the adjacency and Laplacian matrices for a given graph type.\n\n    Args:\n        N (int): Number of nodes.\n        graph_type (str): Type of graph ('path', 'cycle', 'complete').\n\n    Returns:\n        numpy.ndarray: The graph Laplacian matrix L.\n    \"\"\"\n    A = np.zeros((N, N))\n    if graph_type == 'path':\n        for i in range(N - 1):\n            A[i, i + 1] = 1\n            A[i + 1, i] = 1\n    elif graph_type == 'cycle':\n        for i in range(N - 1):\n            A[i, i + 1] = 1\n            A[i + 1, i] = 1\n        A[0, N - 1] = 1\n        A[N - 1, 0] = 1\n    elif graph_type == 'complete':\n        A = np.ones((N, N)) - np.eye(N)\n    \n    D = np.diag(np.sum(A, axis=1))\n    L = D - A\n    return L\n\ndef compute_stability_margin(N, r, graph_type):\n    \"\"\"\n    Computes the stability margin for the synchronized equilibrium.\n\n    Args:\n        N (int): Number of nodes.\n        r (float): Logistic map parameter.\n        graph_type (str): Type of graph.\n\n    Returns:\n        list: A list containing [e_lower, e_upper, width].\n    \"\"\"\n    # 1. Construct Laplacian and find its eigenvalues\n    L = construct_graph_laplacian(N, graph_type)\n    # Use eigvalsh for symmetric matrices; it returns sorted eigenvalues\n    eigenvalues = np.linalg.eigvalsh(L)\n    \n    # Filter out numerical noise around the zero eigenvalue\n    # and find the relevant eigenvalues lambda_2 and lambda_N.\n    # For a connected graph, there is one zero eigenvalue.\n    lambda_2 = eigenvalues[1]\n    lambda_N = eigenvalues[-1]\n    \n    # Check for pathological cases where eigenvalues might be zero\n    if lambda_2  1e-9 or lambda_N  1e-9:\n        # This can happen if the graph is not connected as assumed, or N is too small.\n        # But for the given test cases, this should not occur.\n        return [0.0, 0.0, 0.0]\n\n    e_lower = 0.0\n    e_upper = 0.0\n    \n    # 2. Apply derived stability formulas\n    if 2.0  r = 3.0:\n        # For this regime, the lower bound for stability is epsilon = 0\n        e_lower = 0.0\n        e_upper = (r - 1.0) / ((r - 2.0) * lambda_N)\n    elif r > 3.0:\n        # For this regime, both bounds depend on the spectrum\n        e_lower = (r - 3.0) / ((r - 2.0) * lambda_2)\n        e_upper = (r - 1.0) / ((r - 2.0) * lambda_N)\n\n    # 3. Check if the stability interval is valid\n    if e_lower >= e_upper:\n        # If the lower bound is greater than or equal to the upper bound,\n        # the stability interval is empty.\n        e_lower = 0.0\n        e_upper = 0.0\n    \n    width = max(0.0, e_upper - e_lower)\n    \n    return [e_lower, e_upper, width]\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        {'N': 5, 'r': 2.5, 'graph_type': 'path'},\n        {'N': 6, 'r': 3.0, 'graph_type': 'cycle'},\n        {'N': 5, 'r': 3.2, 'graph_type': 'complete'},\n        {'N': 8, 'r': 3.8, 'graph_type': 'cycle'},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_stability_margin(case['N'], case['r'], case['graph_type'])\n        results.append(result)\n\n    # Format the final output string as a list of lists.\n    # `str(sublist)` naturally produces the required '[...]' format for each sublist.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}