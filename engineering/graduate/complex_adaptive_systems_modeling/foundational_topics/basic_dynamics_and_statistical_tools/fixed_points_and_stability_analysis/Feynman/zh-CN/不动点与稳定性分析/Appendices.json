{
    "hands_on_practices": [
        {
            "introduction": "在复杂自适应系统中，模型的参数往往决定了其长期行为。这项练习将带领我们探索一个基本问题：系统参数如何影响其平衡点的稳定性。我们将通过分析一个带有记忆效应的二阶离散时间系统，运用Jury稳定性判据这一经典代数工具，来推导出保证系统稳定所需的参数条件。通过将这些代数不等式转化为参数空间中的几何区域，我们不仅能从理论上掌握稳定性的概念，还能直观地“看到”稳定区域的形状和边界，这对于理解和设计稳健的自适应系统至关重要。",
            "id": "4123610",
            "problem": "考虑一个复杂自适应系统中标量宏观可观测量的一个聚合的、依赖于记忆的更新规则，该规则被建模为二阶线性递推关系\n$$\ny_{t+1} = a y_t + b y_{t-1},\n$$\n其中 $a$ 和 $b$ 分别是编码瞬时响应和单步记忆的无量纲实数参数。令二维状态为 $\\mathbf{x}_t = (y_t, y_{t-1})^{\\top}$，则不动点 $\\mathbf{x}^{\\ast} = \\mathbf{0}$ 是系统的一个平衡点。在线性时不变系统的离散时间稳定性分析中，不动点的渐近稳定性等价于舒尔稳定性（Schur stability），即雅可比矩阵（此处为线性递推的系统矩阵）的所有特征值都严格位于单位圆盘内部。\n\n仅使用离散时间稳定性的基本原理和针对2次多项式的朱利判据（Jury test），完成以下任务：\n\n1. 从第一性原理和朱利判据的构造出发，推导关于参数 $(a,b)$ 的、使得不动点 $\\mathbf{x}^{\\ast} = \\mathbf{0}$ 具有舒尔稳定性的充要条件的显式代数不等式。\n\n2. 通过将这些不等式解释为 $(a,b)$ 平面上的半平面约束，来解释它们的几何意义，并定性地描述由此产生的稳定区域 $\\mathcal{S}$（凸性、边界线和顶点）。\n\n3. 计算稳定区域 $\\mathcal{S}$ 在 $(a,b)$ 平面上的确切勒贝格面积。\n\n将最终面积表示为一个精确的无量纲数。无需四舍五入。",
            "solution": "该问题要求分析二阶线性递推关系 $y_{t+1} = a y_t + b y_{t-1}$ 的不动点 $\\mathbf{x}^{\\ast} = \\mathbf{0}$ 的稳定性。此分析将通过使用朱利判据推导参数 $(a,b)$ 的舒尔稳定性条件，从几何上解释这些条件，并计算所得稳定区域的面积来完成。\n\n首先，我们将二阶递推关系表示为一阶向量-矩阵方程。令状态向量为 $\\mathbf{x}_t = (y_t, y_{t-1})^{\\top}$。则动态方程由下式给出：\n$$\n\\mathbf{x}_{t+1} = \\begin{pmatrix} y_{t+1} \\\\ y_t \\end{pmatrix} = \\begin{pmatrix} a  b \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} y_t \\\\ y_{t-1} \\end{pmatrix} = A \\mathbf{x}_t\n$$\n其中 $A = \\begin{pmatrix} a  b \\\\ 1  0 \\end{pmatrix}$ 是系统矩阵，也称为特征多项式的友矩阵（companion matrix）。\n\n不动点 $\\mathbf{x}^{\\ast} = \\mathbf{0}$ 是渐近稳定的，当且仅当矩阵 $A$ 的所有特征值的模都严格小于 $1$。这就是矩阵 $A$ 的舒尔稳定性的定义。$A$ 的特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根。\n$$\n\\det\\left(\\begin{pmatrix} a  b \\\\ 1  0 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\\right) = \\det\\begin{pmatrix} a-\\lambda  b \\\\ 1  -\\lambda \\end{pmatrix} = (a-\\lambda)(-\\lambda) - b = \\lambda^2 - a\\lambda - b = 0\n$$\n令特征多项式为 $P(\\lambda) = \\lambda^2 - a\\lambda - b$。为了满足舒尔稳定性， $P(\\lambda)$ 的根必须严格位于复平面的单位圆盘内部。\n\n**1. 使用朱利判据推导稳定性条件**\n\n朱利判据为多项式的根位于单位圆盘内提供了充要条件。对于形如 $P(\\lambda) = c_2\\lambda^2 + c_1\\lambda + c_0$ 且具有实系数和 $c_2 > 0$ 的二次多项式，其条件为：\n1. $P(1) > 0$\n2. $(-1)^2 P(-1) > 0$，可简化为 $P(-1) > 0$\n3. $|c_0|  c_2$\n\n对于我们的特征多项式 $P(\\lambda) = \\lambda^2 - a\\lambda - b$，系数为 $c_2=1$，$c_1=-a$，以及 $c_0=-b$。由于 $c_2=1>0$，我们可以直接应用朱利判据。\n\n条件 1：$P(1) > 0$\n$$\nP(1) = 1^2 - a(1) - b = 1 - a - b > 0 \\implies a+b  1 \\quad \\text{或} \\quad b  1-a\n$$\n\n条件 2：$P(-1) > 0$\n$$\nP(-1) = (-1)^2 - a(-1) - b = 1 + a - b > 0 \\implies a-b > -1 \\quad \\text{或} \\quad b  1+a\n$$\n\n条件 3：$|c_0|  c_2$\n$$\n|-b|  1 \\implies |b|  1 \\implies -1  b  1\n$$\n\n因此，不动点 $\\mathbf{x}^{\\ast} = \\mathbf{0}$ 渐近稳定的充要条件是关于参数 $(a,b)$ 的以下三个不等式：\n1. $a+b  1$\n2. $a-b > -1$ (或 $b-a  1$)\n3. $|b|  1$\n\n**2. 稳定区域的几何解释**\n\n这组不等式在 $(a,b)$ 平面中定义了一个区域 $\\mathcal{S}$，称为稳定区域。我们将每个不等式解释为一个开半平面：\n- $b  1-a$：直线 $b = 1-a$ 下方的区域。\n- $b  1+a$：直线 $b = 1+a$ 下方的区域。\n- $b > -1$：直线 $b = -1$ 上方的区域。\n- $b  1$：直线 $b = 1$ 下方的区域。\n\n稳定区域 $\\mathcal{S}$ 是这些半平面的交集。我们可以证明条件 $b1$ 是多余的。该区域的上边界由 $b  \\min(1-a, 1+a)$ 决定。\n- 当 $a \\ge 0$ 时，$1-a \\le 1+a$，所以边界是 $b  1-a$。由于 $a \\ge 0$，$1-a \\le 1$，因此 $b1-a$ 蕴含 $b1$。\n- 当 $a  0$ 时，$1+a  1-a$，所以边界是 $b  1+a$。由于 $a0$，$1+a1$，因此 $b1+a$ 蕴含 $b1$。\n因此，不等式 $b1$ 已被另外两个上界不等式 $b  1-a$ 和 $b  1+a$ 所蕴含。\n\n因此，稳定区域 $\\mathcal{S}$ 由以下简化的三个不等式集合定义：\n1. $b  1-a$\n2. $b  1+a$\n3. $b > -1$\n\n这个区域是 $(a,b)$ 平面中的一个开三角形。\n- **凸性**：由于 $\\mathcal{S}$ 是三个凸集（开半平面）的交集，它本身也是一个凸集。\n- **边界和顶点**：该区域的边界是直线 $b = 1-a$、$b = 1+a$ 和 $b = -1$。$\\mathcal{S}$ 的闭包的顶点是这些直线的交点：\n    - $b=1-a$ 和 $b=1+a$ 的交点：\n      $1-a = 1+a \\implies 2a=0 \\implies a=0$。则 $b=1$。顶点为 $(0,1)$。\n    - $b=1-a$ 和 $b=-1$ 的交点：\n      $-1 = 1-a \\implies a=2$。顶点为 $(2,-1)$。\n    - $b=1+a$ 和 $b=-1$ 的交点：\n      $-1 = 1+a \\implies a=-2$。顶点为 $(-2,-1)$。\n稳定区域 $\\mathcal{S}$ 是以 $(-2, -1)$、$(2, -1)$ 和 $(0, 1)$ 为顶点的三角形的内部。\n\n**3. 稳定区域的面积**\n\n我们计算 $(a,b)$ 平面中三角形区域 $\\mathcal{S}$ 的勒贝格面积。我们可以将连接顶点 $(-2,-1)$ 和 $(2,-1)$ 的线段作为三角形的底边。该线段位于直线 $b=-1$ 上。\n- 底边的长度是 $a$ 坐标之差：\n  $$ \\text{base} = 2 - (-2) = 4 $$\n- 三角形的高是从第三个顶点 $(0,1)$ 到包含底边的直线 $b=-1$ 的垂直距离。这是 $b$ 坐标之差：\n  $$ \\text{height} = 1 - (-1) = 2 $$\n- 三角形的面积由公式 $\\frac{1}{2} \\times \\text{base} \\times \\text{height}$ 给出。\n  $$ \\text{Area}(\\mathcal{S}) = \\frac{1}{2} \\times 4 \\times 2 = 4 $$\n稳定区域 $\\mathcal{S}$ 的确切勒贝格面积是 $4$。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "线性化分析是理解平衡点附近动态的有力工具，但它是否总是能揭示全貌？这项练习旨在挑战线性思维的局限性，通过一个精心设计的非线性模型来展示其不足之处。我们将分析一个在原点处线性稳定的系统，但会发现非线性项能够在平衡点附近催生出一个全新的动态结构——一个不变的闭合轨道。这个思想实验揭示了非线性动力学的丰富性，强调了即便一个不动点是局部稳定的，系统在稍大的尺度上也可能展现出复杂的周期性行为，这对于理解从生态系统到神经网络中出现的振荡现象具有深刻的启发意义。",
            "id": "4123556",
            "problem": "在一个复杂自适应系统（CAS）框架内，考虑一个用于描述两个耦合自适应性状局部协同演化的离散时间模型。设时间 $t$ 的状态为 $x_t \\in \\mathbb{R}^2$，并定义其复数表示为 $z_t = x_{t,1} + i x_{t,2} \\in \\mathbb{C}$。其更新规则在内部平衡点附近由以下非线性范式指定\n$$\nz_{t+1} = \\big(\\rho + \\alpha |z_t|^2\\big)\\, z_t \\, \\exp\\!\\big(i\\big(\\theta + \\beta |z_t|^2\\big)\\big),\n$$\n其中参数满足 $0\\rho1$，$\\alpha>0$，$\\theta \\in (0,2\\pi)$，以及 $\\beta \\in \\mathbb{R}$。分析的基本依据是：(i) 通过雅可比线性化对不动点稳定性的离散时间定义，以及 (ii) 在一个映射下集合的不变性条件，该条件定义为将映射应用于该集合并要求像集相等。\n\n任务：\n1. 使用线性化的定义，计算映射在不动点 $z^* = 0$ 处的雅可比矩阵，并确定其特征值的模。根据这些模的大小，说明其对局部稳定性的影响。\n2. 使用集合的不变性条件，推导该映射下一个非平凡不变闭合曲线（不变循环）的半径 $r>0$ 的精确表达式（如果该半径存在）。解释尽管不动点是局部线性稳定的，但非线性项在创建此不变循环中的作用。\n3. 对于参数值 $\\rho = 0.995$ 和 $\\alpha = 0.200$，计算任务2中求得的半径。将最终数值四舍五入至五位有效数字。答案以无单位的纯数表示。",
            "solution": "我们从离散时间动力系统的核心定义开始：不动点 $z^*$ 满足 $z_{t+1} = z_t = z^*$；其局部稳定性由在 $z^*$ 处的雅可比矩阵的特征值决定，特别是特征值的模是否小于1。在一个映射 $F$ 下的不变集 $S$ 满足 $F(S) = S$。对于 $\\mathbb{C} \\cong \\mathbb{R}^2$ 上的径向对称映射，一个闭合不变曲线可以由其在导出的径向动力学下的恒定半径 $r>0$ 来表征。\n\n任务1：计算在 $z^* = 0$ 处的雅可比矩阵，并推断特征值的模和稳定性。\n\n定义映射 $F:\\mathbb{C}\\to\\mathbb{C}$ 如下：\n$$\nF(z) = \\big(\\rho + \\alpha |z|^2\\big)\\,z\\, \\exp\\!\\big(i\\big(\\theta + \\beta |z|^2\\big)\\big).\n$$\n在 $z=0$ 处，与 $|z|^2$ 成正比的非线性项消失。关于 $z=0$ 的一阶（线性）近似为\n$$\nF(z) \\approx \\rho\\, z\\, \\exp(i\\theta).\n$$\n将 $z$ 解释为 $\\mathbb{R}^2$ 中的一个向量，这个线性化是一个角度为 $\\theta$ 的旋转，然后是一个因子为 $\\rho$ 的缩放。因此，在 $z^*=0$ 处的雅可比矩阵是\n$$\nJ(0) = \\rho \\begin{pmatrix}\n\\cos\\theta  -\\sin\\theta \\\\\n\\sin\\theta  \\cos\\theta\n\\end{pmatrix}.\n$$\n$J(0)$ 的特征值是复共轭对\n$$\n\\lambda_{1,2} = \\rho \\big(\\cos\\theta \\pm i \\sin\\theta\\big) = \\rho \\exp(\\pm i\\theta),\n$$\n两者的模均为\n$$\n|\\lambda_{1}| = |\\lambda_{2}| = \\rho.\n$$\n因为 $0\\rho1$，特征值的模严格小于1，这意味着不动点 $z^* = 0$ 在线性化下是局部渐近稳定的。\n\n任务2：推导非平凡不变闭合曲线的半径。\n\n我们分析半径 $r_t = |z_t|$ 的导出动力学。根据映射，\n$$\n|z_{t+1}| = \\big|\\big(\\rho + \\alpha |z_t|^2\\big)\\, z_t \\, \\exp\\!\\big(i\\big(\\theta + \\beta |z_t|^2\\big)\\big)\\big| = \\big(\\rho + \\alpha r_t^2\\big)\\, r_t,\n$$\n因为指数因子的模为1。因此，径向动力学由以下一维映射描述\n$$\nr_{t+1} = g(r_t) = \\big(\\rho + \\alpha r_t^2\\big)\\, r_t.\n$$\n一个具有恒定半径 $r>0$ 的闭合不变曲线对应于 $g$ 的一个不动点 $r$（其中 $r>0$），即，\n$$\nr = \\big(\\rho + \\alpha r^2\\big)\\, r.\n$$\n该条件得出 $r=0$ 或\n$$\n\\rho + \\alpha r^2 = 1.\n$$\n求解 $r>0$ 可得\n$$\nr = \\sqrt{\\frac{1 - \\rho}{\\alpha}}.\n$$\n因为 $0\\rho1$ 且 $\\alpha>0$，平方根下的量为正，所以存在一个非平凡的半径 $r>0$。这个闭合不变曲线是线性化无法预测的，因为线性化只评估了任意接近 $z^* = 0$ 的局部行为；与 $|z|^2$ 成正比的非线性项产生了一个依赖于振幅的增长因子，该因子恰好在推导出的半径处等于1，从而生成了不变循环。\n\n为求完整，我们可以通过计算 $g$ 在 $r$ 处的导数来评估此不变循环的径向稳定性。计算\n$$\ng'(r) = \\frac{d}{dr}\\big(\\rho r + \\alpha r^3\\big) = \\rho + 3\\alpha r^2.\n$$\n在不变半径处，使用 $\\alpha r^2 = 1 - \\rho$ 可得\n$$\ng'(r) = \\rho + 3(1 - \\rho) = 3 - 2\\rho.\n$$\n对于 $0\\rho1$，$g'(r) \\in (1,3)$，因此不变循环是径向不稳定的（排斥的）。这展示了线性分析的局限性：尽管在不动点处 $|\\lambda|1$ 因而具有局部渐近稳定性，但非线性项可以生成一个附近的不变结构（此处为一个排斥的闭合曲线），而这仅从雅可比矩阵是无法推断的。\n\n任务3：对于 $\\rho = 0.995$ 和 $\\alpha = 0.200$ 计算半径。\n\n将给定参数代入精确表达式中：\n$$\nr = \\sqrt{\\frac{1 - \\rho}{\\alpha}} = \\sqrt{\\frac{1 - 0.995}{0.200}} = \\sqrt{\\frac{0.005}{0.200}} = \\sqrt{0.025}.\n$$\n因此，\n$$\nr = 0.158113883\\ldots\n$$\n四舍五入到五位有效数字，该值为\n$$\nr \\approx 0.15811.\n$$\n在给定的归一化下，该半径没有单位。",
            "answer": "$$\\boxed{0.15811}$$"
        },
        {
            "introduction": "复杂系统通常由大量相互作用的单元组成，其集体行为不仅取决于单个单元的动力学，更深刻地依赖于它们之间的连接结构。这项计算实践将我们的分析从单个系统扩展到网络层面，探讨耦合动力单元的同步稳定性问题。我们将看到，网络的拓扑结构——通过其图拉普拉斯矩阵的谱（特别是代数连通度）来量化——如何直接决定了整个系统维持同步状态的能力。通过这个练习，你将亲手计算并验证网络结构对集体动态稳定性的关键影响，这是理解复杂自适应系统中“结构决定功能”这一核心原则的绝佳途径。",
            "id": "4123594",
            "problem": "考虑一个由 $N$ 个相同的离散时间动力学单元组成的网络，这些单元通过一个无向连通图进行扩散耦合，该图的邻接矩阵为 $A \\in \\mathbb{R}^{N \\times N}$，图拉普拉斯矩阵为 $L = D - A$，其中 $D$ 是对角度矩阵。每个单元是一个参数为 $r > 0$ 的逻辑斯谛映射，定义为 $f(x) = r x (1 - x)$。该网络系统根据以下方程演化：\n$$\nx_{i,t+1} = f(x_{i,t}) - \\varepsilon \\sum_{j=1}^N L_{ij} f(x_{j,t}), \\quad i = 1, \\dots, N,\n$$\n其中 $\\varepsilon \\ge 0$ 是耦合强度，$t \\in \\mathbb{Z}_{\\ge 0}$ 是离散时间。\n\n同步平衡态是指所有单元共享相同值的状态，即对所有 $i$ 都有 $x_{i,t} = x^\\star$，其中 $x^\\star$ 是孤立逻辑斯谛映射的一个不动点。当 $r > 1$ 时，非平凡不动点是 $x^\\star = 1 - \\frac{1}{r}$。同步平衡态的稳定性通过图拉普拉斯矩阵 $L$ 的谱依赖于网络拓扑，特别是其代数连通度（定义为 $L$ 的第二小特征值 $\\lambda_2$）和最大特征值 $\\lambda_N$。\n\n仅从逻辑斯谛映射、同步平衡态、离散时间系统的线性化以及无向连通图拉普拉斯矩阵的谱性质等基本定义出发，推导同步平衡态的稳定性条件（用耦合强度 $\\varepsilon$ 和拉普拉斯特征值来表示），并用此计算稳定性边际。稳定性边际定义为同步平衡态对所有横向模式保持线性稳定的 $\\varepsilon \\ge 0$ 值区间的宽度。\n\n您的程序必须：\n- 对于每个测试用例，计算同步平衡态线性稳定的 $\\varepsilon \\ge 0$ 区间，并返回三个值 $[\\varepsilon_{\\text{lower}}, \\varepsilon_{\\text{upper}}, \\text{width}]$，其中 $\\varepsilon_{\\text{lower}}$ 是下界，$\\varepsilon_{\\text{upper}}$ 是上界，$\\text{width} = \\max\\{\\varepsilon_{\\text{upper}} - \\varepsilon_{\\text{lower}}, 0\\}$。如果稳定区间为空，则该用例输出 $[0.0, 0.0, 0.0]$。\n- 使用以下测试套件中的网络和参数：\n    1. 一个具有 $N = 5$ 个节点和 $r = 2.5$ 的路径图。\n    2. 一个具有 $N = 6$ 个节点和 $r = 3.0$ 的环形图。\n    3. 一个具有 $N = 5$ 个节点和 $r = 3.2$ 的完全图。\n    4. 一个具有 $N = 8$ 个节点和 $r = 3.8$ 的环形图。\n- 对于每个图，按如下方式构造邻接矩阵 $A$：\n    - 路径图：对于 $i = 1, \\dots, N-1$，$A_{i,i+1} = A_{i+1,i} = 1$，其余为 $0$。\n    - 环形图：对于 $i = 1, \\dots, N-1$，$A_{i,i+1} = A_{i+1,i} = 1$，$A_{1,N} = A_{N,1} = 1$，其余为 $0$。\n    - 完全图：对于 $i \\ne j$，$A_{ij} = 1$ 且 $A_{ii} = 0$。\n- 计算拉普拉斯矩阵 $L = D - A$ 及其特征值，并在评估稳定性时仅使用代数连通度 $\\lambda_2$ 和最大特征值 $\\lambda_N$。\n- 将最终输出表示为包含在方括号中的单个行，其中包含一个逗号分隔的列表，每个元素对应一个测试用例，并且本身是 $[\\varepsilon_{\\text{lower}}, \\varepsilon_{\\text{upper}}, \\text{width}]$ 形式的列表。所有数值输出必须是十进制数（浮点数）。程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，\"[[e1_lower,e1_upper,e1_width],[e2_lower,e2_upper,e2_width],...]\"）。\n\n本问题不涉及物理单位或角度；所有量均为无量纲量。",
            "solution": "用户希望得到一个关于耦合逻辑斯谛映射网络中同步平衡态稳定性条件的详细推导，然后编写一个程序来计算特定测试用例的稳定性边际。\n\n### 问题验证\n\n该问题是网络动力学系统稳定性分析中一个明确定义的练习。所有组成部分——逻辑斯谛映射、通过图拉普拉斯矩阵的扩散耦合、同步态的概念以及线性稳定性分析——在科学文献中都是标准且严格定义的。该问题是自洽的、科学上合理的且客观的。因此，该问题被认为是**有效的**。\n\n### 稳定性条件的推导\n\n网络系统的动力学由下式给出\n$$\nx_{i,t+1} = f(x_{i,t}) - \\varepsilon \\sum_{j=1}^N L_{ij} f(x_{j,t})\n$$\n对于每个单元 $i \\in \\{1, \\dots, N\\}$，其中 $f(x) = rx(1-x)$ 是逻辑斯谛映射，$\\varepsilon \\ge 0$ 是耦合强度，$L$ 是底层网络的图拉普拉斯矩阵。该系统可以写成紧凑的向量形式。设 $\\mathbf{x}_t = (x_{1,t}, x_{2,t}, \\dots, x_{N,t})^T$ 是系统在时间 $t$ 的状态向量。设 $F(\\mathbf{x}_t)$ 是一个向量函数，其第 $i$ 个分量是 $f(x_{i,t})$。则系统动力学可以表示为：\n$$\n\\mathbf{x}_{t+1} = F(\\mathbf{x}_t) - \\varepsilon L F(\\mathbf{x}_t) = (I - \\varepsilon L) F(\\mathbf{x}_t)\n$$\n其中 $I$ 是 $N \\times N$ 的单位矩阵。我们用 $G(\\mathbf{x}) = (I - \\varepsilon L) F(\\mathbf{x})$ 表示整个系统的映射。\n\n同步平衡态是一个状态 $\\mathbf{x}^\\star = (x^\\star, x^\\star, \\dots, x^\\star)^T$，它是系统的一个不动点，即 $G(\\mathbf{x}^\\star) = \\mathbf{x}^\\star$。为了使这个状态成为一个平衡态，$x^\\star$ 必须是孤立逻辑斯谛映射的一个不动点，即 $f(x^\\star) = x^\\star$。问题指定了当 $r>1$ 时的非平凡不动点，即 $x^\\star = 1-1/r$。让我们验证 $\\mathbf{x}^\\star$ 是整个系统的一个不动点。\n$$\nG(\\mathbf{x}^\\star) = (I - \\varepsilon L) F(\\mathbf{x}^\\star)\n$$\n向量 $F(\\mathbf{x}^\\star)$ 是 $(f(x^\\star), \\dots, f(x^\\star))^T = (x^\\star, \\dots, x^\\star)^T = \\mathbf{x}^\\star$。\n$$\nG(\\mathbf{x}^\\star) = (I - \\varepsilon L) \\mathbf{x}^\\star = \\mathbf{x}^\\star - \\varepsilon L \\mathbf{x}^\\star\n$$\n任何无向图的图拉普拉斯矩阵 $L$ 都具有每行之和为零的性质，这意味着全一向量 $\\mathbf{1} = (1, \\dots, 1)^T$ 是 $L$ 的一个特征向量，其特征值为 $0$，即 $L\\mathbf{1} = \\mathbf{0}$。由于 $\\mathbf{x}^\\star = x^\\star \\mathbf{1}$，我们有 $L\\mathbf{x}^\\star = x^\\star L\\mathbf{1} = \\mathbf{0}$。因此，$G(\\mathbf{x}^\\star) = \\mathbf{x}^\\star$，这证实了对于任何 $\\varepsilon$，同步态确实是网络系统的一个不动点。\n\n为了分析这个不动点的线性稳定性，我们计算映射 $G(\\mathbf{x})$ 在 $\\mathbf{x}^\\star$ 处的雅可比矩阵 $J$。雅可比矩阵的元素是 $J_{ij} = \\frac{\\partial G_i}{\\partial x_j}|_{\\mathbf{x}=\\mathbf{x}^\\star}$。\n$G(\\mathbf{x})$ 的第 $i$ 个分量是 $G_i(\\mathbf{x}) = f(x_i) - \\varepsilon \\sum_{k=1}^N L_{ik} f(x_k)$。它关于 $x_j$ 的偏导数是：\n$$\n\\frac{\\partial G_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\left( f(x_i) - \\varepsilon \\sum_{k=1}^N L_{ik} f(x_k) \\right) = \\delta_{ij} f'(x_i) - \\varepsilon L_{ij} f'(x_j)\n$$\n其中 $\\delta_{ij}$ 是克罗内克 δ。在同步不动点 $\\mathbf{x}^\\star$（其中对所有 $i$ 都有 $x_i = x^\\star$）处求值，我们得到：\n$$\nJ_{ij} = \\delta_{ij} f'(x^\\star) - \\varepsilon L_{ij} f'(x^\\star)\n$$\n令 $\\alpha = f'(x^\\star)$。则雅可比矩阵可以写成 $J = \\alpha I - \\varepsilon \\alpha L = \\alpha(I - \\varepsilon L)$。\n\n同步平衡态 $\\mathbf{x}^\\star$ 是线性稳定的，当且仅当雅可比矩阵 $J$ 的所有特征值 $\\mu$ 的模都小于 $1$，即 $|\\mu|  1$。$J$ 的特征值与图拉普拉斯矩阵 $L$ 的特征值直接相关。设 $0 = \\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_N$ 是 $L$ 的特征值，对应的特征向量为 $\\mathbf{v}_1, \\mathbf{v}_2, \\dots, \\mathbf{v}_N$。那么，对于每个特征向量 $\\mathbf{v}_k$：\n$$\nJ \\mathbf{v}_k = \\alpha(I - \\varepsilon L) \\mathbf{v}_k = \\alpha(\\mathbf{v}_k - \\varepsilon L\\mathbf{v}_k) = \\alpha(\\mathbf{v}_k - \\varepsilon \\lambda_k \\mathbf{v}_k) = \\alpha(1 - \\varepsilon \\lambda_k) \\mathbf{v}_k\n$$\n因此，$J$ 的特征值是 $\\mu_k = \\alpha(1 - \\varepsilon \\lambda_k)$，对于 $k=1, \\dots, N$。稳定性条件是对于所有 $k$，都有 $|\\mu_k|  1$。\n\n逻辑斯谛映射的导数是 $f'(x) = r(1-2x)$。在不动点 $x^\\star = 1 - 1/r$ 处，这个导数是：\n$$\n\\alpha = f'(x^\\star) = r(1 - 2(1 - 1/r)) = r(1 - 2 + 2/r) = 2 - r\n$$\n问题要求的是关于*横向模式*的稳定性。这些模式对应于打破同步的扰动，与 $k=2, \\dots, N$ 的特征向量 $\\mathbf{v}_k$ 相关（其中 $\\lambda_k > 0$）。$k=1$ 时的模式是同步模式（$\\lambda_1=0$, $\\mathbf{v}_1 = \\mathbf{1}$），它对应于不动点 $x^\\star$ 本身的稳定性。问题指定的 $r$ 值可能使得 $x^\\star$ 不稳定（$r \\ge 3$）。我们关注 $k=2, \\dots, N$ 的条件 $|\\mu_k|  1$。\n$$\n|(2-r)(1 - \\varepsilon \\lambda_k)|  1 \\quad \\text{对于 } k=2, \\dots, N\n$$\n这个不等式必须对所有横向模式成立。所有测试用例的 $r > 2$，所以 $2-r$ 是负数。令 $\\beta = -(2-r) = r-2 > 0$。条件变为 $|\\beta(1-\\varepsilon\\lambda_k)|  1$。\n$$\n-1  \\beta(1 - \\varepsilon \\lambda_k)  1 \\implies -\\frac{1}{\\beta}  1 - \\varepsilon \\lambda_k  \\frac{1}{\\beta}\n$$\n$$\n1 - \\frac{1}{\\beta}  \\varepsilon \\lambda_k  1 + \\frac{1}{\\beta}\n$$\n我们需要找到满足这个条件（对于从 $\\lambda_2$ 到 $\\lambda_N$ 的所有 $\\lambda_k$）的 $\\varepsilon \\ge 0$ 的区间。\n\n我们分析 $r>2$ 的两种情况：\n情况 1: $2  r \\le 3$。这意味着 $0  \\beta \\le 1$，所以 $1/\\beta \\ge 1$。\n在这种情况下，$1 - 1/\\beta \\le 0$。不等式 $1-1/\\beta  \\varepsilon\\lambda_k$ 的左侧对于任何 $\\varepsilon \\ge 0$ 和 $\\lambda_k > 0$ 都成立。稳定性仅受右侧约束：\n$$\n\\varepsilon \\lambda_k  1 + \\frac{1}{\\beta} \\implies \\varepsilon  \\frac{1 + 1/\\beta}{\\lambda_k}\n$$\n这必须对所有 $k=2, \\dots, N$ 成立。因此，我们需要满足最严格的约束，这对应于最大的 $\\lambda_k$：\n$$\n\\varepsilon  \\min_{k=2,\\dots,N} \\left( \\frac{1+1/\\beta}{\\lambda_k} \\right) = \\frac{1+1/\\beta}{\\lambda_N}\n$$\n代入 $\\beta=r-2$，上界为 $\\varepsilon_{\\text{upper}} = \\frac{1+1/(r-2)}{\\lambda_N} = \\frac{r-1}{(r-2)\\lambda_N}$。下界为 $\\varepsilon_{\\text{lower}} = 0$。稳定区间是 $[0, \\frac{r-1}{(r-2)\\lambda_N})$。\n\n情况 2: $r > 3$。这意味着 $\\beta > 1$，所以 $0  1/\\beta  1$。\n在这种情况下，$1-1/\\beta$ 是正数。$\\varepsilon\\lambda_k$ 的两个界都是正数。\n$$\n\\frac{1-1/\\beta}{\\lambda_k}  \\varepsilon  \\frac{1+1/\\beta}{\\lambda_k}\n$$\n这必须对所有 $k=2, \\dots, N$ 成立。$\\varepsilon$ 的区间是所有这些单个区间的交集。\n$$\n\\max_{k=2,\\dots,N} \\left( \\frac{1-1/\\beta}{\\lambda_k} \\right)  \\varepsilon  \\min_{k=2,\\dots,N} \\left( \\frac{1+1/\\beta}{\\lambda_k} \\right)\n$$\n$(1/\\lambda_k)$ 的最大值出现在最小的 $\\lambda_k$ 处，即 $\\lambda_2$。$(1/\\lambda_k)$ 的最小值出现在最大的 $\\lambda_k$ 处，即 $\\lambda_N$。由于 $1-1/\\beta$ 和 $1+1/\\beta$ 都是正数，我们有：\n$$\n\\varepsilon_{\\text{lower}} = \\frac{1-1/\\beta}{\\lambda_2} = \\frac{r-3}{(r-2)\\lambda_2}\n$$\n$$\n\\varepsilon_{\\text{upper}} = \\frac{r-1}{(r-2)\\lambda_N}\n$$\n稳定区间是 $(\\frac{r-3}{(r-2)\\lambda_2}, \\frac{r-1}{(r-2)\\lambda_N})$。只有当 $\\varepsilon_{\\text{lower}}  \\varepsilon_{\\text{upper}}$ 时，这个区间才非空。如果不满足此条件，则稳定区间为空。\n\n总结给定测试用例 $(N, r, \\text{graph})$ 的计算步骤：\n1. 构造邻接矩阵 $A$ 和拉普拉斯矩阵 $L=D-A$。\n2. 计算 $L$ 的特征值，并确定 $\\lambda_2$（第二小）和 $\\lambda_N$（最大）。\n3. 如果 $2  r \\le 3$，设置 $\\varepsilon_{\\text{lower}} = 0$ 和 $\\varepsilon_{\\text{upper}} = \\frac{r-1}{(r-2)\\lambda_N}$。\n4. 如果 $r > 3$，计算 $\\varepsilon_{\\text{lower}} = \\frac{r-3}{(r-2)\\lambda_2}$ 和 $\\varepsilon_{\\text{upper}} = \\frac{r-1}{(r-2)\\lambda_N}$。\n5. 如果 $\\varepsilon_{\\text{lower}} \\ge \\varepsilon_{\\text{upper}}$，则区间为空；设置 $\\varepsilon_{\\text{lower}} = 0.0$，$\\varepsilon_{\\text{upper}} = 0.0$，$\\text{width} = 0.0$。\n6. 否则，计算宽度为 $\\text{width} = \\varepsilon_{\\text{upper}} - \\varepsilon_{\\text{lower}}$。\n7. 返回 $[\\varepsilon_{\\text{lower}}, \\varepsilon_{\\text{upper}}, \\text{width}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef construct_graph_laplacian(N, graph_type):\n    \"\"\"\n    Constructs the adjacency and Laplacian matrices for a given graph type.\n\n    Args:\n        N (int): Number of nodes.\n        graph_type (str): Type of graph ('path', 'cycle', 'complete').\n\n    Returns:\n        numpy.ndarray: The graph Laplacian matrix L.\n    \"\"\"\n    A = np.zeros((N, N))\n    if graph_type == 'path':\n        for i in range(N - 1):\n            A[i, i + 1] = 1\n            A[i + 1, i] = 1\n    elif graph_type == 'cycle':\n        for i in range(N - 1):\n            A[i, i + 1] = 1\n            A[i + 1, i] = 1\n        A[0, N - 1] = 1\n        A[N - 1, 0] = 1\n    elif graph_type == 'complete':\n        A = np.ones((N, N)) - np.eye(N)\n    \n    D = np.diag(np.sum(A, axis=1))\n    L = D - A\n    return L\n\ndef compute_stability_margin(N, r, graph_type):\n    \"\"\"\n    Computes the stability margin for the synchronized equilibrium.\n\n    Args:\n        N (int): Number of nodes.\n        r (float): Logistic map parameter.\n        graph_type (str): Type of graph.\n\n    Returns:\n        list: A list containing [e_lower, e_upper, width].\n    \"\"\"\n    # 1. Construct Laplacian and find its eigenvalues\n    L = construct_graph_laplacian(N, graph_type)\n    # Use eigvalsh for symmetric matrices; it returns sorted eigenvalues\n    eigenvalues = np.linalg.eigvalsh(L)\n    \n    # Filter out numerical noise around the zero eigenvalue\n    # and find the relevant eigenvalues lambda_2 and lambda_N.\n    # For a connected graph, there is one zero eigenvalue.\n    lambda_2 = eigenvalues[1]\n    lambda_N = eigenvalues[-1]\n    \n    # Check for pathological cases where eigenvalues might be zero\n    if lambda_2  1e-9 or lambda_N  1e-9:\n        # This can happen if the graph is not connected as assumed, or N is too small.\n        # But for the given test cases, this should not occur.\n        return [0.0, 0.0, 0.0]\n\n    e_lower = 0.0\n    e_upper = 0.0\n    \n    # 2. Apply derived stability formulas\n    if 2.0  r = 3.0:\n        # For this regime, the lower bound for stability is epsilon = 0\n        e_lower = 0.0\n        e_upper = (r - 1.0) / ((r - 2.0) * lambda_N)\n    elif r > 3.0:\n        # For this regime, both bounds depend on the spectrum\n        e_lower = (r - 3.0) / ((r - 2.0) * lambda_2)\n        e_upper = (r - 1.0) / ((r - 2.0) * lambda_N)\n\n    # 3. Check if the stability interval is valid\n    if e_lower >= e_upper:\n        # If the lower bound is greater than or equal to the upper bound,\n        # the stability interval is empty.\n        e_lower = 0.0\n        e_upper = 0.0\n    \n    width = max(0.0, e_upper - e_lower)\n    \n    return [e_lower, e_upper, width]\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        {'N': 5, 'r': 2.5, 'graph_type': 'path'},\n        {'N': 6, 'r': 3.0, 'graph_type': 'cycle'},\n        {'N': 5, 'r': 3.2, 'graph_type': 'complete'},\n        {'N': 8, 'r': 3.8, 'graph_type': 'cycle'},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_stability_margin(case['N'], case['r'], case['graph_type'])\n        results.append(result)\n\n    # Format the final output string as a list of lists.\n    # `str(sublist)` naturally produces the required '[...]' format for each sublist.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}