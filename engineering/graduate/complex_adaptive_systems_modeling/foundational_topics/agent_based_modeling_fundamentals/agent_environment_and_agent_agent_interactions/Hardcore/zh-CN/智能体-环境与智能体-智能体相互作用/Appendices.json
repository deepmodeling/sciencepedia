{
    "hands_on_practices": [
        {
            "introduction": "本练习探讨了当智能体在争夺资源时，简单的个体策略（“鹰派”和“鸽派”）如何通过演化博弈动力学，在种群层面上涌现出复杂的集体行为。通过推导和分析复制子方程，我们将亲手揭示一个稳定混合策略的存在，这是理解复杂适应系统中多样性如何维持的关键。这个实践将加强你从微观互动规则推导宏观系统动态的能力。",
            "id": "4113883",
            "problem": "考虑一个大型、均匀混合的智能体种群，其成员采用两种纯策略：鹰 ($H$) 和鸽 ($D$)。它们成对竞争一个收益为 $V>0$ 的资源。如果两只鹰相遇，由于存在受伤的可能性（成本为 $C>0$），每只鹰的期望收益为 $(V-C)/2$。如果一只鹰和一只鸽相遇，鹰获得 $V$，鸽获得 $0$。如果两只鸽相遇，每只鸽获得 $V/2$。令 $x \\in [0,1]$ 表示种群中鹰的比例。假设选择动态遵循源于演化博弈论的复制动力学方程，其中一个策略的增长率与其相对于种群平均收益的优势成正比。\n\n从随机匹配下的期望收益和复制动力学的核心定义出发，推导关于 $x(t)$ 的一维常微分方程，并用它来计算所有不动点。根据 $V$ 和 $C$ 显式地分析每个不动点的线性稳定性。确定存在混合内部均衡的参数区域，并判断其局部稳定性。在复杂自适应系统中智能体间相互作用的背景下解释你的结果，说明相互作用的收益如何塑造种群构成。\n\n你最终报告的量必须是在其存在的参数区域内，作为 $V$ 和 $C$ 函数的内部不动点处鹰的比例 $x^{\\ast}$ 的解析表达式。将你的最终答案表示为一个封闭形式的表达式，不要包含任何单位。无需四舍五入。",
            "solution": "问题陈述已经过验证，被认为是自洽的、在演化博弈论中有科学依据且提法恰当的。我们可以开始求解。\n\n该问题描述了鹰鸽博弈。令 $H$ 表示鹰策略，$D$ 表示鸽策略。成对竞赛的收益是给定的。我们可以用一个矩阵 $A$ 来表示这些收益，其中条目 $A_{ij}$ 是使用策略 $i$ 的参与者在与使用策略 $j$ 的参与者博弈时获得的收益。令第一行/列对应鹰，第二行/列对应鸽。\n收益如下：\n- 鹰 vs. 鹰：每只获得 $\\frac{V-C}{2}$。因此，$A_{HH} = \\frac{V-C}{2}$。\n- 鹰 vs. 鸽：鹰获得 $V$，鸽获得 $0$。因此，$A_{HD} = V$ 且 $A_{DH} = 0$。\n- 鸽 vs. 鸽：每只获得 $\\frac{V}{2}$。因此，$A_{DD} = \\frac{V}{2}$。\n\n因此，收益矩阵为：\n$$ A = \\begin{pmatrix} \\frac{V-C}{2} & V \\\\ 0 & \\frac{V}{2} \\end{pmatrix} $$\n种群由比例为 $x$ 的鹰和比例为 $1-x$ 的鸽组成，其中 $x \\in [0,1]$。我们假设随机匹配。鹰的期望收益 $E_H(x)$ 是其对阵鹰的收益乘以遇到鹰的概率 ($x$)，加上其对阵鸽的收益乘以遇到鸽的概率 ($1-x$)：\n$$ E_H(x) = x \\cdot A_{HH} + (1-x) \\cdot A_{HD} = x \\left(\\frac{V-C}{2}\\right) + (1-x)V $$\n$$ E_H(x) = \\frac{Vx}{2} - \\frac{Cx}{2} + V - Vx = V - \\frac{Cx}{2} - \\frac{Vx}{2} $$\n类似地，鸽的期望收益 $E_D(x)$ 为：\n$$ E_D(x) = x \\cdot A_{DH} + (1-x) \\cdot A_{DD} = x(0) + (1-x)\\frac{V}{2} = \\frac{V}{2} - \\frac{Vx}{2} $$\n复制动力学方程描述了鹰的比例 $x$ 的演化过程。一个策略的种群份额增长率与它的期望收益和种群平均收益 $\\bar{E}(x)$ 之间的差值成正比。该方程为：\n$$ \\frac{dx}{dt} = x(E_H(x) - \\bar{E}(x)) $$\n其中 $\\bar{E}(x) = x E_H(x) + (1-x) E_D(x)$。复制动力学方程一个更方便的形式是：\n$$ \\frac{dx}{dt} = x(1-x)(E_H(x) - E_D(x)) $$\n让我们计算期望收益的差值：\n$$ E_H(x) - E_D(x) = \\left(V - \\frac{Cx}{2} - \\frac{Vx}{2}\\right) - \\left(\\frac{V}{2} - \\frac{Vx}{2}\\right) = V - \\frac{Cx}{2} - \\frac{V}{2} = \\frac{V}{2} - \\frac{Cx}{2} = \\frac{1}{2}(V-Cx) $$\n将此代入复制动力学方程，得到关于 $x(t)$ 的一维常微分方程：\n$$ \\frac{dx}{dt} = \\frac{1}{2} x(1-x)(V-Cx) $$\n不动点（记为 $x^*$）是 $\\frac{dx}{dt} = 0$ 的解。\n$$ \\frac{1}{2} x^*(1-x^*)(V-Cx^*) = 0 $$\n该方程产生三个潜在的不动点：\n1. $x^*_1 = 0$（纯鸽种群）\n2. $x^*_2 = 1$（纯鹰种群）\n3. $x^*_3 = \\frac{V}{C}$（内部或混合种群）\n\n为了分析这些不动点的稳定性，我们考察常微分方程右侧函数（我们记为 $f(x) = \\frac{1}{2} x(1-x)(V-Cx)$）的导数的符号。如果 $f'(x^*)  0$，不动点 $x^*$ 是局部稳定的；如果 $f'(x^*) > 0$，则是不稳定的。\n我们用乘法法则计算 $f'(x)$：\n$f(x) = \\frac{1}{2} (x-x^2)(V-Cx)$\n$f'(x) = \\frac{1}{2} \\left[ (1-2x)(V-Cx) + (x-x^2)(-C) \\right]$\n\n现在，我们在每个不动点处计算 $f'(x)$ 的值：\n- $x^*_1 = 0$ 的稳定性：\n$$ f'(0) = \\frac{1}{2} \\left[ (1-0)(V-0) + (0-0)(-C) \\right] = \\frac{1}{2}V $$\n因为给定 $V0$，所以 $f'(0) > 0$。因此，不动点 $x^*_1=0$ 是不稳定的。这意味着如果将少数鹰引入鸽子种群，它们的比例将会增长。\n\n- $x^*_2 = 1$ 的稳定性：\n$$ f'(1) = \\frac{1}{2} \\left[ (1-2)(V-C) + (1-1)(-C) \\right] = \\frac{1}{2} (-1)(V-C) = \\frac{1}{2}(C-V) $$\n稳定性取决于 $C$ 和 $V$ 的相对大小。\n  - 如果 $V > C$，则 $C-V  0$，所以 $f'(1)  0$。不动点 $x^*_2=1$ 是稳定的。\n  - 如果 $C > V$，则 $C-V > 0$，所以 $f'(1) > 0$。不动点 $x^*_2=1$ 是不稳定的。\n\n- 内部不动点 $x^*_3 = V/C$ 的稳定性：\n这个不动点只有在区间 $(0, 1)$ 内才具有生物学意义。因为 $V0$ 且 $C0$，所以 $x^*_3 > 0$ 总是成立。条件 $x^*_3  1$ 要求 $\\frac{V}{C}  1$，这意味着 $C > V$。因此，只有在受伤成本大于资源价值的参数区域，即 $C > V$ 时，才存在混合内部均衡。\n\n让我们在这个区域（$C > V$）分析其稳定性：\n$$ f'\\left(\\frac{V}{C}\\right) = \\frac{1}{2} \\left[ \\left(1-2\\frac{V}{C}\\right)\\left(V-C\\frac{V}{C}\\right) + \\left(\\frac{V}{C}-\\left(\\frac{V}{C}\\right)^2\\right)(-C) \\right] $$\n项 $(V-C\\frac{V}{C})$ 等于 $(V-V)=0$。\n$$ f'\\left(\\frac{V}{C}\\right) = \\frac{1}{2} \\left[ 0 + \\left(\\frac{V}{C}-\\frac{V^2}{C^2}\\right)(-C) \\right] = \\frac{1}{2} \\left[ \\frac{V}{C}\\left(1-\\frac{V}{C}\\right)(-C) \\right] = -\\frac{V}{2}\\left(1-\\frac{V}{C}\\right) $$\n在该不动点存在的区域，$C > V$，这意味着 $\\frac{V}{C}  1$，所以 $1 - \\frac{V}{C} > 0$。因为给定 $V0$，所以导数表达式中除了开头的负号外，所有项都是正的。\n因此，$f'(V/C)  0$。内部不动点 $x^*_3 = V/C$ 在其存在时是局部稳定的。\n\n在智能体间相互作用背景下的解释：\n该模型展示了种群层面的结构是如何从简单的局部互动规则（收益）中涌现出来的。\n- **如果 $V > C$**：资源的收益超过了冲突的成本。攻击性（鹰）行为总是更有利。系统演化为鹰的单一文化（$x=1$）。相互作用会驱逐合作性/非攻击性（鸽）的智能体。\n- **如果 $C > V$**：冲突的成本很高。虽然纯鹰种群是不稳定的（变异的鸽子不会遭受高昂的战斗成本，并会入侵），纯鸽种群也是不稳定的（变异的鹰会轻易地剥削鸽子）。系统自组织成一个稳定的多态状态，其中鹰和鸽共存。鹰的比例 $x^* = V/C$ 被精确地平衡，使得两种策略的期望收益相等（$E_H(x^*) = E_D(x^*)$）。这种稳定的混合状态是演化稳定策略的一个例子，这是复杂自适应系统中的一个核心概念，其中智能体策略受到选择。局部的智能体间相互作用（收益）动态地调节全局种群构成，维持多样性。\n\n问题要求给出在内部不动点存在的参数区域内，鹰的比例 $x^*$ 的解析表达式。这个不动点是 $x^*_3 = V/C$，它存在于区域 $C > V$ 中。",
            "answer": "$$\\boxed{\\frac{V}{C}}$$"
        },
        {
            "introduction": "这个练习将智能体与环境的互动形式化为一个统一的马尔可夫过程，这是建模复杂适应系统的核心技术。你将学习如何通过结合环境的转移概率和智能体的策略，构建一个在联合状态-动作空间上的马尔可夫链。计算其平稳分布，可以让我们理解系统在长期运行中，在不同状态和动作上花费的时间比例。",
            "id": "4113946",
            "problem": "考虑一个智能体与一个环境进行交互，该环境被建模为一个有限状态、有限动作的马尔可夫决策过程（MDP）。该环境有一个有限状态空间 $\\mathcal{S}=\\{s_{1},s_{2}\\}$，智能体有一个有限动作空间 $\\mathcal{A}=\\{a_{1},a_{2}\\}$。环境动态由转移核 $P(s' \\mid s,a)$ 指定，智能体遵循一个平稳随机策略 $\\pi(a \\mid s)$。在每个离散时间步 $t$，给定当前状态 $s_{t}\\in\\mathcal{S}$，智能体从 $\\pi(\\cdot\\mid s_{t})$ 中采样一个动作 $a_{t}\\in\\mathcal{A}$，然后环境从 $P(\\cdot\\mid s_{t},a_{t})$ 中采样下一个状态 $s_{t+1}\\in\\mathcal{S}$。\n\n给定以下具体数值表示的环境动态和策略，所有值都为严格正数以确保遍历性：\n\n- 对于 $s_{1}$：\n  - $P(s_{1}\\mid s_{1},a_{1})=\\tfrac{1}{2}$, $P(s_{2}\\mid s_{1},a_{1})=\\tfrac{1}{2}$,\n  - $P(s_{1}\\mid s_{1},a_{2})=\\tfrac{1}{3}$, $P(s_{2}\\mid s_{1},a_{2})=\\tfrac{2}{3}$。\n- 对于 $s_{2}$：\n  - $P(s_{1}\\mid s_{2},a_{1})=\\tfrac{1}{4}$, $P(s_{2}\\mid s_{2},a_{1})=\\tfrac{3}{4}$,\n  - $P(s_{1}\\mid s_{2},a_{2})=\\tfrac{2}{3}$, $P(s_{2}\\mid s_{2},a_{2})=\\tfrac{1}{3}$。\n- 策略：\n  - $\\pi(a_{1}\\mid s_{1})=\\tfrac{2}{3}$, $\\pi(a_{2}\\mid s_{1})=\\tfrac{1}{3}$,\n  - $\\pi(a_{1}\\mid s_{2})=\\tfrac{1}{2}$, $\\pi(a_{2}\\mid s_{2})=\\tfrac{1}{2}$。\n\n任务：\n\n1. 仅使用马尔可夫过程、条件概率和平稳性的基本定义，构建由智能体-环境交互在联合空间 $\\mathcal{S}\\times\\mathcal{A}$ 上引出的马尔可夫链。请给出从任意 $(s,a)\\in\\mathcal{S}\\times\\mathcal{A}$ 到任意 $(s',a')\\in\\mathcal{S}\\times\\mathcal{A}$ 的单步转移概率。\n\n2. 从第一性原理出发，推导在 $\\mathcal{S}\\times\\mathcal{A}$ 上的平稳分布的形式，该形式应以 $\\mathcal{S}$ 上的平稳状态占据分布和智能体策略来表示。\n\n3. 根据上述数值规范，计算在 $\\mathcal{S}\\times\\mathcal{A}$ 上的唯一平稳分布。将你的最终答案以行向量的形式报告，顺序为 $(s_{1},a_{1})$, $(s_{1},a_{2})$, $(s_{2},a_{1})$, $(s_{2},a_{2})$，使用精确的分数值。不要四舍五入。",
            "solution": "该问题被验证为自洽、有科学依据且定义明确。这是马尔可夫决策过程理论中的一个标准问题。\n\n整个智能体-环境系统在联合状态-动作空间 $\\mathcal{S} \\times \\mathcal{A}$ 上构成一个马尔可夫链。设该链在时间步 $t$ 的状态为对 $(s_t, a_t)$。我们的任务是找出该链的转移概率及其平稳分布。\n\n**任务 1：联合空间上的转移概率**\n\n我们希望找到从一个状态-动作对 $(s, a)$ 到后续状态-动作对 $(s', a')$ 的单步转移概率。这表示为 $T((s', a') \\mid (s, a)) = P(s_{t+1}=s', a_{t+1}=a' \\mid s_t=s, a_t=a)$。\n\n使用条件概率的定义，我们可以将其分解为：\n$$P(s_{t+1}=s', a_{t+1}=a' \\mid s_t=s, a_t=a) = P(a_{t+1}=a' \\mid s_{t+1}=s', s_t=s, a_t=a) P(s_{t+1}=s' \\mid s_t=s, a_t=a)$$\n\n根据问题描述，该过程演化如下：\n1. 环境从分布 $P(\\cdot \\mid s_t, a_t)$ 中采样下一个状态 $s_{t+1}$。这意味着转移到状态 $s'$ 的概率仅取决于当前状态 $s$ 和动作 $a$。因此，\n$$P(s_{t+1}=s' \\mid s_t=s, a_t=a) = P(s' \\mid s, a)$$\n2. 智能体接着从其策略 $\\pi(\\cdot \\mid s_{t+1})$ 中采样下一个动作 $a_{t+1}$。这意味着动作 $a'$ 的选择仅取决于新状态 $s'$。因此，动作的条件概率简化为：\n$$P(a_{t+1}=a' \\mid s_{t+1}=s', s_t=s, a_t=a) = \\pi(a' \\mid s')$$\n\n结合这两个结果，联合空间 $\\mathcal{S} \\times \\mathcal{A}$ 上马尔可夫链的转移概率由环境的转移概率和智能体的策略概率的乘积给出：\n$$T((s', a') \\mid (s, a)) = P(s' \\mid s, a) \\pi(a' \\mid s')$$\n这个表达式给出了从任意对 $(s, a)$ 移动到任意其他对 $(s', a')$ 的概率。请注意，此转移概率与前一个动作 $a$ 无关。\n\n**任务 2：平稳分布的形式**\n\n设 $\\mu(s, a)$ 是联合空间 $\\mathcal{S} \\times \\mathcal{A}$ 上的一个平稳分布。根据定义，它必须对所有 $(s', a') \\in \\mathcal{S} \\times \\mathcal{A}$ 满足平衡方程：\n$$\\mu(s', a') = \\sum_{s \\in \\mathcal{S}} \\sum_{a \\in \\mathcal{A}} \\mu(s, a) T((s', a') \\mid (s, a))$$\n代入任务 1 中 $T((s', a') \\mid (s, a))$ 的表达式：\n$$\\mu(s', a') = \\sum_{s \\in \\mathcal{S}} \\sum_{a \\in \\mathcal{A}} \\mu(s, a) P(s' \\mid s, a) \\pi(a' \\mid s')$$\n我们可以将 $\\pi(a' \\mid s')$ 从求和中提取出来，因为它不依赖于求和变量 $s$ 和 $a$：\n$$\\mu(s', a') = \\pi(a' \\mid s') \\left[ \\sum_{s \\in \\mathcal{S}} \\sum_{a \\in \\mathcal{A}} \\mu(s, a) P(s' \\mid s, a) \\right]$$\n\n现在，设 $d(s)$ 为仅在状态空间 $\\mathcal{S}$ 上的平稳分布。该分布由智能体的策略 $\\pi$ 引出。这个仅含状态的马尔可夫链的转移概率由 $P_\\pi(s' \\mid s) = \\sum_{a \\in \\mathcal{A}} \\pi(a \\mid s) P(s' \\mid s, a)$ 给出。平稳分布 $d(s)$ 满足 $d(s') = \\sum_{s \\in \\mathcal{S}} d(s) P_\\pi(s' \\mid s)$。\n\n我们提出 $\\mu(s, a) = d(s) \\pi(a \\mid s)$ 的形式，并验证它是否满足平衡方程。如果这个形式是正确的，将其代入 $\\mu(s', a')$ 平衡方程的右侧，应该得到 $d(s') \\pi(a' \\mid s')$。\n代入 $\\mu(s, a) = d(s) \\pi(a \\mid s)$：\n\\begin{align*} \\sum_{s \\in \\mathcal{S}} \\sum_{a \\in \\mathcal{A}} \\mu(s, a) T((s', a') \\mid (s, a)) = \\sum_{s \\in \\mathcal{S}} \\sum_{a \\in \\mathcal{A}} [d(s) \\pi(a \\mid s)] [P(s' \\mid s, a) \\pi(a' \\mid s')] \\\\ = \\pi(a' \\mid s') \\sum_{s \\in \\mathcal{S}} d(s) \\left[ \\sum_{a \\in \\mathcal{A}} \\pi(a \\mid s) P(s' \\mid s, a) \\right] \\\\ = \\pi(a' \\mid s') \\sum_{s \\in \\mathcal{S}} d(s) P_\\pi(s' \\mid s)\\end{align*}\n根据平稳状态分布 $d(s)$ 的定义，我们有 $\\sum_{s \\in \\mathcal{S}} d(s) P_\\pi(s' \\mid s) = d(s')$。因此，表达式变为：\n$$\\pi(a' \\mid s') d(s') = \\mu(s', a')$$\n这证实了我们提出的形式是正确的。联合空间 $\\mathcal{S} \\times \\mathcal{A}$ 上的平稳分布是 $\\mu(s, a) = d(s) \\pi(a \\mid s)$，其中 $d(s)$ 是策略引出的在 $\\mathcal{S}$ 上的马尔可夫链的平稳分布。\n\n**任务 3：平稳分布的计算**\n\n首先，我们必须计算在 $\\mathcal{S} = \\{s_1, s_2\\}$ 上马尔可夫链的转移矩阵 $P_\\pi$。其元素为 $P_\\pi(s' \\mid s) = \\sum_{a \\in \\mathcal{A}} \\pi(a \\mid s) P(s' \\mid s, a)$。\n\n$P_\\pi(s_1 \\mid s_1) = \\pi(a_1 \\mid s_1)P(s_1 \\mid s_1, a_1) + \\pi(a_2 \\mid s_1)P(s_1 \\mid s_1, a_2) = (\\frac{2}{3})(\\frac{1}{2}) + (\\frac{1}{3})(\\frac{1}{3}) = \\frac{1}{3} + \\frac{1}{9} = \\frac{4}{9}$。\n$P_\\pi(s_2 \\mid s_1) = 1 - P_\\pi(s_1 \\mid s_1) = 1 - \\frac{4}{9} = \\frac{5}{9}$。\n\n$P_\\pi(s_1 \\mid s_2) = \\pi(a_1 \\mid s_2)P(s_1 \\mid s_2, a_1) + \\pi(a_2 \\mid s_2)P(s_1 \\mid s_2, a_2) = (\\frac{1}{2})(\\frac{1}{4}) + (\\frac{1}{2})(\\frac{2}{3}) = \\frac{1}{8} + \\frac{1}{3} = \\frac{3+8}{24} = \\frac{11}{24}$。\n$P_\\pi(s_2 \\mid s_2) = 1 - P_\\pi(s_1 \\mid s_2) = 1 - \\frac{11}{24} = \\frac{13}{24}$。\n\n转移矩阵为 $P_\\pi = \\begin{pmatrix} \\frac{4}{9}  \\frac{5}{9} \\\\ \\frac{11}{24}  \\frac{13}{24} \\end{pmatrix}$。\n\n设平稳状态分布为 $d = \\begin{pmatrix} d_1  d_2 \\end{pmatrix}$，其中 $d_1 = d(s_1)$ 且 $d_2 = d(s_2)$。它必须满足 $d P_\\pi = d$ 和 $d_1 + d_2 = 1$。\n方程 $d P_\\pi = d$ 得出：\n$$d_1 \\frac{4}{9} + d_2 \\frac{11}{24} = d_1$$\n$$d_2 \\frac{11}{24} = d_1 (1 - \\frac{4}{9}) = d_1 \\frac{5}{9}$$\n代入 $d_2 = 1 - d_1$：\n$$(1-d_1) \\frac{11}{24} = d_1 \\frac{5}{9}$$\n$$\\frac{11}{24} - \\frac{11}{24}d_1 = \\frac{5}{9}d_1$$\n$$\\frac{11}{24} = d_1 \\left(\\frac{5}{9} + \\frac{11}{24}\\right) = d_1 \\left(\\frac{5 \\cdot 8 + 11 \\cdot 3}{72}\\right) = d_1 \\left(\\frac{40+33}{72}\\right) = d_1 \\frac{73}{72}$$\n$$d_1 = \\frac{11}{24} \\cdot \\frac{72}{73} = \\frac{11 \\cdot 3}{73} = \\frac{33}{73}$$\n且 $d_2 = 1 - d_1 = 1 - \\frac{33}{73} = \\frac{40}{73}$。\n所以，平稳状态分布为 $d(s_1) = \\frac{33}{73}$ 且 $d(s_2) = \\frac{40}{73}$。\n\n最后，我们计算联合空间的平稳分布 $\\mu(s, a) = d(s) \\pi(a \\mid s)$。各分量按 $(s_1, a_1), (s_1, a_2), (s_2, a_1), (s_2, a_2)$ 的顺序列出：\n1. $\\mu(s_1, a_1) = d(s_1) \\pi(a_1 \\mid s_1) = \\frac{33}{73} \\cdot \\frac{2}{3} = \\frac{11 \\cdot 2}{73} = \\frac{22}{73}$。\n2. $\\mu(s_1, a_2) = d(s_1) \\pi(a_2 \\mid s_1) = \\frac{33}{73} \\cdot \\frac{1}{3} = \\frac{11}{73}$。\n3. $\\mu(s_2, a_1) = d(s_2) \\pi(a_1 \\mid s_2) = \\frac{40}{73} \\cdot \\frac{1}{2} = \\frac{20}{73}$。\n4. $\\mu(s_2, a_2) = d(s_2) \\pi(a_2 \\mid s_2) = \\frac{40}{73} \\cdot \\frac{1}{2} = \\frac{20}{73}$。\n\n在 $\\mathcal{S} \\times \\mathcal{A}$ 上的平稳分布为行向量 $\\begin{pmatrix} \\frac{22}{73}  \\frac{11}{73}  \\frac{20}{73}  \\frac{20}{73} \\end{pmatrix}$。\n各分量之和为 $\\frac{22+11+20+20}{73} = \\frac{73}{73} = 1$，符合要求。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{22}{73}  \\frac{11}{73}  \\frac{20}{73}  \\frac{20}{73} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在许多真实世界的系统中，信息传递和行动执行都存在时间延迟，这个练习探讨了这种延迟如何从根本上改变系统的动态。我们将一个包含延迟反馈的智能体-环境系统线性化，并分析其稳定性，从而揭示一个重要的现象：霍普夫分岔（Hopf bifurcation）。通过这个实践，你将从第一性原理出发，推导出延迟如何导致一个原本稳定的系统失稳并产生持续振荡。",
            "id": "4113902",
            "problem": "考虑一个由相互作用的智能体组成的大种群，该种群与一个共享环境相耦合。令该种群的聚合状态相对于平衡点的宏观偏差表示为 $x(t)$，并令环境驱动信号 $u(t)$ 由一个策略映射 $\\pi(\\cdot)$ 作用于聚合状态的延迟观测值来确定，即 $u(t)=\\pi\\!\\left(x(t-\\tau)\\right)$，其中 $\\tau0$ 是一个感知与执行延迟，源于智能体-环境以及智能体-智能体之间的信息处理延迟。假设在平衡点 $x^{\\ast}=0$ 附近，联合的智能体-环境动力学可以线性化为\n$x'(t)=\\alpha\\,x(t)+\\beta\\,u(t)$\n且策略可以线性化为\n$u(t)\\approx k\\,x(t-\\tau)$\n其中常数系数 $\\alpha,\\beta,k\\in\\mathbb{R}$ 由微观到宏观的闭合关系确定（例如，$\\alpha$ 表示智能体的内在弛豫，$\\beta$ 表示环境到智能体的增益，而 $k=\\pi'(0)$ 表示局部策略的斜率）。假设此线性化有效，并且霍普夫分岔 (Hopf bifurcation) 是相关的局部不稳定性机制，其定义为一对共轭复特征根穿越虚轴。\n\n仅从线性化的延迟耦合系统和霍普夫分岔的定义出发，推导出一对纯虚特征根存在的必要条件，并求出使平衡点 $x^{\\ast}=0$ 通过霍普夫分岔失去稳定性的最小正临界延迟 $\\tau_{c}$，用 $\\alpha$、$\\beta$ 和 $k$ 表示。你的推导必须从第一性原理出发，通过假设指数解并分离实部和虚部来进行，并且必须指明纯虚根存在所需的任何非简并条件。\n\n然后，对于高增益负反馈的具体情况，即 $\\alpha=-0.4\\,\\text{s}^{-1}$，$\\beta=1.0\\,\\text{s}^{-1}$ 和 $k=-1.0$（使得 $u(t)\\approx -x(t-\\tau)$），计算最小正临界延迟 $\\tau_{c}$ 的数值（以秒为单位）。所有角度均以弧度表示。将最终数值答案四舍五入到 $4$ 位有效数字，并以秒为单位报告。",
            "solution": "用户希望我解决以下问题：\n考虑一个由相互作用的智能体组成的大种群，该种群与一个共享环境相耦合。令该种群的聚合状态相对于平衡点的宏观偏差表示为 $x(t)$，并令环境驱动信号 $u(t)$ 由一个策略映射 $\\pi(\\cdot)$ 作用于聚合状态的延迟观测值来确定，即 $u(t)=\\pi\\!\\left(x(t-\\tau)\\right)$，其中 $\\tau0$ 是一个感知与执行延迟，源于智能体-环境以及智能体-智能体之间的信息处理延迟。假设在平衡点 $x^{\\ast}=0$ 附近，联合的智能体-环境动力学可以线性化为\n$x'(t)=\\alpha\\,x(t)+\\beta\\,u(t)$\n且策略可以线性化为\n$u(t)\\approx k\\,x(t-\\tau)$\n其中常数系数 $\\alpha,\\beta,k\\in\\mathbb{R}$ 由微观到宏观的闭合关系确定（例如，$\\alpha$ 表示智能体的内在弛豫，$\\beta$ 表示环境到智能体的增益，而 $k=\\pi'(0)$ 表示局部策略的斜率）。假设此线性化有效，并且霍普夫分岔 (Hopf bifurcation) 是相关的局部不稳定性机制，其定义为一对共轭复特征根穿越虚轴。\n\n仅从线性化的延迟耦合系统和霍普夫分岔的定义出发，推导出一对纯虚特征根存在的必要条件，并求出使平衡点 $x^{\\ast}=0$ 通过霍普夫分岔失去稳定性的最小正临界延迟 $\\tau_{c}$，用 $\\alpha$、$\\beta$ 和 $k$ 表示。你的推导必须从第一性原理出发，通过假设指数解并分离实部和虚部来进行，并且必须指明纯虚根存在所需的任何非简并条件。\n\n然后，对于高增益负反馈的具体情况，即 $\\alpha=-0.4\\,\\text{s}^{-1}$，$\\beta=1.0\\,\\text{s}^{-1}$ 和 $k=-1.0$（使得 $u(t)\\approx -x(t-\\tau)$），计算最小正临界延迟 $\\tau_{c}$ 的数值（以秒为单位）。所有角度均以弧度表示。将最终数值答案四舍五入到 $4$ 位有效数字，并以秒为单位报告。\n\n所述问题在动力系统理论框架内是形式上合理且适定的。它展示了对线性延迟微分方程的标准分析，这是许多 STEM 领域中一个有效且广泛使用的模型。所有给定的参数和定义都是清晰、一致且有科学依据的。因此，可以着手求解。\n\n线性化系统由两个方程描述：\n$x'(t) = \\alpha\\,x(t) + \\beta\\,u(t)$\n$u(t) = k\\,x(t-\\tau)$\n\n将第二个方程代入第一个方程，得到关于聚合状态偏差 $x(t)$ 的单个线性延迟微分方程（DDE）：\n$$\nx'(t) = \\alpha\\,x(t) + \\beta k\\,x(t-\\tau)\n$$\n为了分析平衡点 $x(t) = 0$ 的稳定性，我们寻找形式为 $x(t) = C e^{\\lambda t}$ 的解，其中 $\\lambda \\in \\mathbb{C}$ 是一个特征根，$C$ 是一个非零常数。将这个拟设代入 DDE 得到：\n$$\n\\lambda C e^{\\lambda t} = \\alpha C e^{\\lambda t} + \\beta k C e^{\\lambda(t-\\tau)}\n$$\n两边同除以 $C e^{\\lambda t}$，得到关于根 $\\lambda$ 的特征方程：\n$$\n\\lambda = \\alpha + \\beta k e^{-\\lambda \\tau}\n$$\n当一个参数（此处为延迟 $\\tau$）变化时，一对共轭复根穿越虚轴，此时发生霍普夫分岔。在分岔点，存在一个纯虚根 $\\lambda = i\\omega_c$，其中 $\\omega_c \\in \\mathbb{R}$ 且 $\\omega_c \\neq 0$。不失一般性，我们取 $\\omega_c  0$ 来表示不稳定性开始时的振荡频率。\n\n将 $\\lambda = i\\omega_c$ 代入特征方程：\n$$\ni\\omega_c = \\alpha + \\beta k e^{-i\\omega_c \\tau}\n$$\n使用欧拉公式 $e^{-i\\theta} = \\cos(\\theta) - i\\sin(\\theta)$，我们展开指数项：\n$$\ni\\omega_c = \\alpha + \\beta k (\\cos(\\omega_c \\tau) - i\\sin(\\omega_c \\tau))\n$$\n$$\ni\\omega_c = (\\alpha + \\beta k \\cos(\\omega_c \\tau)) - i(\\beta k \\sin(\\omega_c \\tau))\n$$\n为使此等式成立，方程两边的实部和虚部必须分别相等。\n\n令实部相等：\n$$\n0 = \\alpha + \\beta k \\cos(\\omega_c \\tau) \\quad \\implies \\quad \\cos(\\omega_c \\tau) = -\\frac{\\alpha}{\\beta k}\n$$\n令虚部相等：\n$$\n\\omega_c = - \\beta k \\sin(\\omega_c \\tau) \\quad \\implies \\quad \\sin(\\omega_c \\tau) = -\\frac{\\omega_c}{\\beta k}\n$$\n为了使这两个方程相容，延迟 $\\tau$ 必须使得对于某个 $\\omega_c  0$，这两个条件同时满足。我们可以使用基本三角恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$（其中 $\\theta = \\omega_c \\tau$）来消去 $\\tau$：\n$$\n\\left(-\\frac{\\alpha}{\\beta k}\\right)^2 + \\left(-\\frac{\\omega_c}{\\beta k}\\right)^2 = 1\n$$\n$$\n\\frac{\\alpha^2}{(\\beta k)^2} + \\frac{\\omega_c^2}{(\\beta k)^2} = 1\n$$\n$$\n\\alpha^2 + \\omega_c^2 = (\\beta k)^2\n$$\n求解 $\\omega_c^2$：\n$$\n\\omega_c^2 = (\\beta k)^2 - \\alpha^2\n$$\n为了发生霍普夫分岔，我们需要一个非零的实频率 $\\omega_c$，这意味着 $\\omega_c^2  0$。这导出了必要的非简并条件：\n$$\n(\\beta k)^2  \\alpha^2 \\quad \\text{or equivalently} \\quad |\\beta k|  |\\alpha|\n$$\n如果此条件成立，分岔点出现的新生振荡的频率为：\n$$\n\\omega_c = \\sqrt{(\\beta k)^2 - \\alpha^2}\n$$\n现在我们求解临界延迟 $\\tau_c$。我们有方程组：\n$$\n\\cos(\\omega_c \\tau) = -\\frac{\\alpha}{\\beta k} \\quad \\text{and} \\quad \\sin(\\omega_c \\tau) = -\\frac{\\omega_c}{\\beta k}\n$$\n$\\omega_c \\tau$ 的值由这两个方程确定。令 $\\theta_0 = \\arccos\\left(-\\frac{\\alpha}{\\beta k}\\right)$，其中 $\\arccos$ 的值域为 $[0, \\pi]$。这个角的正弦值非负，即 $\\sin(\\theta_0) \\geq 0$。我们必须匹配 $\\sin(\\omega_c \\tau) = - \\omega_c / (\\beta k)$ 的符号。\n\n情况1：$\\beta k  0$。此时，$-\\frac{\\omega_c}{\\beta k} > 0$。这与 $\\sin(\\theta_0)$ 的符号相匹配。因此，所有可能的角为 $\\omega_c \\tau = \\theta_0 + 2n\\pi$，其中 $n \\in \\mathbb{Z}$。最小的正延迟 $\\tau_c$ 对应于 $n=0$：\n$$\n\\tau_c = \\frac{1}{\\omega_c} \\arccos\\left(-\\frac{\\alpha}{\\beta k}\\right) \\quad \\text{for} \\quad \\beta k  0\n$$\n情况2：$\\beta k > 0$。此时，$-\\frac{\\omega_c}{\\beta k}  0$。这要求一个正弦值为负的角。最小的正角是 $2\\pi - \\theta_0$。因此，$\\omega_c \\tau = 2\\pi - \\theta_0 + 2n\\pi$。最小的正延迟 $\\tau_c$ 对应于 $n=0$：\n$$\n\\tau_c = \\frac{1}{\\omega_c} \\left(2\\pi - \\arccos\\left(-\\frac{\\alpha}{\\beta k}\\right)\\right) \\quad \\text{for} \\quad \\beta k > 0\n$$\n这些是最小正临界延迟的通用表达式。\n\n现在，我们将此应用于给定的具体情况：$\\alpha = -0.4\\,\\text{s}^{-1}$，$\\beta = 1.0\\,\\text{s}^{-1}$ 和 $k = -1.0$。\n\n首先，计算乘积 $\\beta k$：\n$$\n\\beta k = (1.0\\,\\text{s}^{-1})(-1.0) = -1.0\\,\\text{s}^{-1}\n$$\n由于 $\\beta k  0$，我们将使用情况1的公式。\n\n接下来，检查非简并条件 $|\\beta k|  |\\alpha|$：\n$$\n|\\beta k| = |-1.0\\,\\text{s}^{-1}| = 1.0\\,\\text{s}^{-1}\n$$\n$$\n|\\alpha| = |-0.4\\,\\text{s}^{-1}| = 0.4\\,\\text{s}^{-1}\n$$\n条件 $1.0 > 0.4$ 成立。因此，可能发生霍普夫分岔。\n\n计算临界频率 $\\omega_c$：\n$$\n\\omega_c = \\sqrt{(\\beta k)^2 - \\alpha^2} = \\sqrt{(-1.0)^2 - (-0.4)^2} = \\sqrt{1.0 - 0.16} = \\sqrt{0.84}\\,\\text{s}^{-1}\n$$\n现在，计算反余弦函数的参数：\n$$\n-\\frac{\\alpha}{\\beta k} = -\\frac{-0.4}{-1.0} = -0.4\n$$\n使用 $\\beta k  0$ 时 $\\tau_c$ 的公式：\n$$\n\\tau_c = \\frac{1}{\\omega_c} \\arccos\\left(-\\frac{\\alpha}{\\beta k}\\right) = \\frac{1}{\\sqrt{0.84}} \\arccos(-0.4)\n$$\n我们现在计算数值。角度必须以弧度为单位。\n$$\n\\arccos(-0.4) \\approx 1.98231368 \\text{ rad}\n$$\n$$\n\\sqrt{0.84} \\approx 0.916515139 \\text{ s}^{-1}\n$$\n$$\n\\tau_c \\approx \\frac{1.98231368}{0.916515139} \\text{ s} \\approx 2.1628731 \\text{ s}\n$$\n将结果四舍五入到 $4$ 位有效数字，我们得到：\n$$\n\\tau_c \\approx 2.163 \\text{ s}\n$$",
            "answer": "$$\n\\boxed{2.163}\n$$"
        }
    ]
}