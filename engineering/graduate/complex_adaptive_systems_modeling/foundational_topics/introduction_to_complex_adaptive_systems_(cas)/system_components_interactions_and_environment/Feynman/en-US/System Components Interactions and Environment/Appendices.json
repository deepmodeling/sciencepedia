{
    "hands_on_practices": [
        {
            "introduction": "A system's interaction with its environment often begins at its boundaries. This exercise explores this fundamental concept using a reaction-diffusion model, a cornerstone of spatial dynamics. By comparing absorbing (hostile) and reflecting (impermeable) boundary conditions, you will derive the conditions for population persistence and gain a deeper intuition for how habitat edges can determine survival or extinction .",
            "id": "4146899",
            "problem": "Consider a single-species reaction–diffusion system modeling the density $u(x,t)$ on a bounded one-dimensional habitat $[0,L]$, where $L>0$. The environment consists of two habitat edges at $x=0$ and $x=L$ separating the habitat from a surrounding matrix. Assume local mass balance and Fickian diffusion hold: the population flux $J(x,t)$ obeys $J=-D\\,\\partial_x u$, with diffusion coefficient $D>0$, and the within-habitat population dynamics is governed by a smooth reaction term $f(u)$ with $f(0)=0$ and $f^{\\prime}(0)=r>0$. The governing Partial Differential Equation (PDE) on $x\\in(0,L)$ is therefore $\\partial_t u=-\\partial_x J+f(u)$.\n\nEdges can be idealized as either perfectly inhospitable (absorbing) or perfectly impermeable (reflecting). In the absorbing case, any individual that reaches the boundary is removed by the surrounding matrix; in the reflecting case, there is no exchange across the boundary.\n\nDefine mathematically consistent boundary conditions for the two cases and, using only conservation, Fick’s law, and linearization about the extinction state $u\\equiv 0$, deduce how the persistence threshold depends on $D$, $r$, and $L$. Here, “persistence” means that small positive perturbations of $u\\equiv 0$ grow initially in time rather than decay. You may use that the principal eigenvalue of the negative Laplacian on $[0,L]$ with absorbing edges is strictly positive, while with reflecting edges it is zero.\n\nSelect all statements that are correct.\n\nA. Absorbing edges correspond to imposing $u(0,t)=u(L,t)=0$, and reflecting edges correspond to imposing $\\partial_x u(0,t)=\\partial_x u(L,t)=0$. Linearizing at $u\\equiv 0$ yields a threshold of the form $r-D\\,\\lambda_1>0$, where $\\lambda_1$ is the principal eigenvalue of $-\\partial_{xx}$ with the corresponding boundary condition. Therefore, under reflecting edges $\\lambda_1=0$ and any $r>0$ leads to initial growth, whereas under absorbing edges $\\lambda_1>0$ and sufficiently small $r$ or large $D$ prevent persistence.\n\nB. Under reflecting edges on $[0,L]$, the principal eigenvalue equals $\\pi^2/L^2$, so the persistence threshold $r>D\\,\\pi^2/L^2$ is identical to that under absorbing edges.\n\nC. On $[0,L]$ with absorbing edges, the persistence condition is equivalent to $L>\\pi\\sqrt{D/r}$.\n\nD. Under absorbing edges, increasing $D$ facilitates persistence because stronger diffusion spreads the population and reduces local depletion, thereby lowering the linear threshold.\n\nE. With reflecting edges and a logistic nonlinearity $f(u)=r\\,u\\,(1-u/K)$ with $K>0$, any nontrivial, nonnegative initial condition persists and tends toward a positive spatially uniform equilibrium, whereas with absorbing edges there exists a critical habitat length $L_c>0$ below which all solutions go extinct.",
            "solution": "The problem statement is analyzed for validity.\n\n**Step 1: Extract Givens**\n-   Governing PDE: $\\partial_t u = -\\partial_x J + f(u)$ on the domain $x \\in (0,L)$, where $L>0$.\n-   Population density: $u(x,t)$.\n-   Population flux: $J(x,t) = -D\\,\\partial_x u$, with diffusion coefficient $D>0$.\n-   Combined PDE: $\\partial_t u = D\\,\\partial_{xx} u + f(u)$.\n-   Reaction term properties: $f(u)$ is smooth, $f(0)=0$, and $f'(0)=r>0$.\n-   Boundary conditions (described physically):\n    -   Absorbing: At $x=0$ and $x=L$, any individual is removed.\n    -   Reflecting: At $x=0$ and $x=L$, there is no exchange.\n-   Persistence definition: Small positive perturbations of the extinction state $u\\equiv 0$ grow initially in time.\n-   Provided information: The principal eigenvalue of the negative Laplacian ($-\\partial_{xx}$) on $[0,L]$ is strictly positive for absorbing edges and zero for reflecting edges.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem uses the reaction-diffusion equation, a foundational model in mathematical ecology, chemical kinetics, and many other fields. Fick's law of diffusion is a standard, empirically validated principle. The assumptions on the reaction term describe logistic-type growth near extinction, which is a common and valid assumption.\n-   **Well-Posed:** The problem asks to derive a persistence threshold via linear stability analysis, a standard and well-defined mathematical procedure for differential equations. The descriptions of the boundary conditions, though physical, have standard mathematical formalizations.\n-   **Objective:** The language is precise, quantitative, and free of subjective content.\n\nThe problem is a classic exercise in the linear stability analysis of reaction-diffusion systems. It is self-contained, scientifically sound, and mathematically well-posed. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. A full solution will be derived.\n\n### Derivation of the Persistence Threshold\n\n**1. Mathematical Formulation of Boundary Conditions**\nThe population flux is given by $J(x,t) = -D\\,\\partial_x u$.\n-   **Reflecting edges**: The condition of \"no exchange\" or \"perfectly impermeable\" implies that the flux across the boundary is zero. Thus, $J(0,t) = 0$ and $J(L,t) = 0$. Since $D>0$, this is equivalent to the zero-flux Neumann boundary conditions:\n    $$ \\partial_x u(0,t) = 0 \\quad \\text{and} \\quad \\partial_x u(L,t) = 0 $$\n-   **Absorbing edges**: The condition of \"perfectly inhospitable\" where individuals are \"removed\" implies that the population density at the boundary must be zero at all times. This corresponds to the homogeneous Dirichlet boundary conditions:\n    $$ u(0,t) = 0 \\quad \\text{and} \\quad u(L,t) = 0 $$\n\n**2. Linear Stability Analysis of the Extinction State**\nThe problem concerns the initial growth of small perturbations around the trivial steady state $u(x,t) \\equiv 0$. We linearize the governing PDE, $\\partial_t u = D\\,\\partial_{xx} u + f(u)$, around $u=0$.\nUsing a Taylor expansion for $f(u)$ around $u=0$: $f(u) = f(0) + f'(0)u + O(u^2)$.\nGiven $f(0)=0$ and $f'(0)=r$, for small $u$, we have $f(u) \\approx r u$.\nThe linearized PDE is:\n$$ \\partial_t u = D\\,\\partial_{xx} u + r u $$\nWe seek solutions using the method of separation of variables, $u(x,t) = T(t)\\phi(x)$. Substituting this into the linearized PDE yields:\n$$ T'(t)\\phi(x) = D T(t)\\phi''(x) + r T(t)\\phi(x) $$\nDividing by $T(t)\\phi(x)$ gives:\n$$ \\frac{T'(t)}{T(t)} = D\\frac{\\phi''(x)}{\\phi(x)} + r $$\nLet $T'(t)/T(t) = \\sigma$, where $\\sigma$ is the growth rate. Then $T(t) \\propto e^{\\sigma t}$. The spatial part must satisfy:\n$$ D\\phi''(x) + r\\phi(x) = \\sigma \\phi(x) \\implies -D\\phi''(x) = (r-\\sigma)\\phi(x) $$\nThis is an eigenvalue problem for the operator $-D\\partial_{xx}$. It is standard to analyze this in terms of the eigenfunctions of the negative Laplacian, $-\\partial_{xx}$, which satisfy $-\\phi_n''(x) = \\lambda_n \\phi_n(x)$ subject to the relevant boundary conditions.\nSubstituting this into the linearized PDE for a solution mode $u_n(x,t) \\propto e^{\\sigma_n t}\\phi_n(x)$:\n$$ \\sigma_n \\phi_n = D(-\\lambda_n \\phi_n) + r \\phi_n = (r - D\\lambda_n)\\phi_n $$\nThe growth rate of the $n$-th mode is thus $\\sigma_n = r - D\\lambda_n$.\nThe perturbation will grow if at least one mode grows, i.e., if $\\max_n(\\sigma_n) > 0$. The maximum growth rate corresponds to the smallest eigenvalue, $\\lambda_1$, known as the principal eigenvalue.\nTherefore, the condition for persistence (instability of $u \\equiv 0$) is:\n$$ \\sigma_1 = r - D\\lambda_1 > 0 $$\n\n**3. Applying the Criterion to Each Case**\n-   **Reflecting (Neumann) edges**: The eigenvalue problem is $-\\phi'' = \\lambda \\phi$ with $\\phi'(0)=\\phi'(L)=0$. The eigenfunctions are $\\phi_n(x) = \\cos(n\\pi x/L)$ for $n=0,1,2,...$, and the eigenvalues are $\\lambda_n = (n\\pi/L)^2$. The principal eigenvalue is for $n=0$, which is $\\lambda_1 = \\lambda_0 = 0$.\n    The persistence condition $r - D\\lambda_1 > 0$ becomes $r-D(0) > 0$, or simply $r > 0$. Since we are given $r>0$, the extinction state is always unstable, and persistence is always possible for any $D>0, L>0$.\n\n-   **Absorbing (Dirichlet) edges**: The eigenvalue problem is $-\\phi'' = \\lambda \\phi$ with $\\phi(0)=\\phi(L)=0$. The eigenfunctions are $\\phi_n(x) = \\sin(n\\pi x/L)$ for $n=1,2,3,...$, and the eigenvalues are $\\lambda_n = (n\\pi/L)^2$. The principal eigenvalue is for $n=1$, which is $\\lambda_1 = (\\pi/L)^2$.\n    The persistence condition $r - D\\lambda_1 > 0$ becomes $r - D(\\pi/L)^2 > 0$. This inequality imposes a constraint on the parameters $r, D, L$.\n\n### Evaluation of Options\n\n**A. Absorbing edges correspond to imposing $u(0,t)=u(L,t)=0$, and reflecting edges correspond to imposing $\\partial_x u(0,t)=\\partial_x u(L,t)=0$. Linearizing at $u\\equiv 0$ yields a threshold of the form $r-D\\,\\lambda_1>0$, where $\\lambda_1$ is the principal eigenvalue of $-\\partial_{xx}$ with the corresponding boundary condition. Therefore, under reflecting edges $\\lambda_1=0$ and any $r>0$ leads to initial growth, whereas under absorbing edges $\\lambda_1>0$ and sufficiently small $r$ or large $D$ prevent persistence.**\n-   The formulation of the boundary conditions is correct as derived above.\n-   The general form of the persistence threshold, $r - D\\lambda_1 > 0$, is also correct.\n-   For reflecting (Neumann) edges, the principal eigenvalue $\\lambda_1$ is indeed $0$, so the condition reduces to $r > 0$, which is given. Thus, any small perturbation will grow.\n-   For absorbing (Dirichlet) edges, the principal eigenvalue $\\lambda_1 = (\\pi/L)^2 > 0$. The condition is $r > D(\\pi/L)^2$. If $r$ is too small, or $D$ is too large, this inequality is violated, and the population cannot persist.\n-   The statement is entirely consistent with the derivation.\n-   Verdict: **Correct**.\n\n**B. Under reflecting edges on $[0,L]$, the principal eigenvalue equals $\\pi^2/L^2$, so the persistence threshold $r>D\\,\\pi^2/L^2$ is identical to that under absorbing edges.**\n-   This statement is incorrect. The principal eigenvalue for reflecting (Neumann) boundary conditions is $\\lambda_1 = 0$. The value $\\pi^2/L^2$ is the principal eigenvalue for absorbing (Dirichlet) boundary conditions. The persistence thresholds for the two cases are fundamentally different.\n-   Verdict: **Incorrect**.\n\n**C. On $[0,L]$ with absorbing edges, the persistence condition is equivalent to $L>\\pi\\sqrt{D/r}$.**\n-   The persistence condition for absorbing edges is $r - D(\\pi/L)^2 > 0$.\n-   Rearranging the inequality:\n    $$ r > D\\frac{\\pi^2}{L^2} \\implies rL^2 > D\\pi^2 \\implies L^2 > \\frac{D\\pi^2}{r} $$\n-   Taking the square root of both sides (since $L>0$):\n    $$ L > \\sqrt{\\frac{D\\pi^2}{r}} = \\pi\\sqrt{\\frac{D}{r}} $$\n-   This matches the statement exactly.\n-   Verdict: **Correct**.\n\n**D. Under absorbing edges, increasing $D$ facilitates persistence because stronger diffusion spreads the population and reduces local depletion, thereby lowering the linear threshold.**\n-   The persistence condition is $r > D(\\pi/L)^2$. This can be written as $D < r(L/\\pi)^2$.\n-   To facilitate persistence, one must make it easier to satisfy this condition. Increasing the diffusion coefficient $D$ makes the inequality *harder* to satisfy. Therefore, increasing $D$ *hinders* persistence, it does not facilitate it.\n-   Physically, a larger $D$ increases the rate at which individuals are lost to the inhospitable absorbing boundaries, which is detrimental to population survival. The reasoning provided in the option is flawed for this boundary condition type.\n-   Verdict: **Incorrect**.\n\n**E. With reflecting edges and a logistic nonlinearity $f(u)=r\\,u\\,(1-u/K)$ with $K>0$, any nontrivial, nonnegative initial condition persists and tends toward a positive spatially uniform equilibrium, whereas with absorbing edges there exists a critical habitat length $L_c>0$ below which all solutions go extinct.**\n-   **Reflecting edges:** The linear analysis shows $u\\equiv 0$ is unstable for any $r>0$, with the instability driven by the spatially constant mode ($\\phi_0=const.$). In the full nonlinear system with logistic growth, this initial growth is stabilized by the nonlinear term $-ru^2/K$. Because no individuals are lost at the boundaries, the total population grows, and diffusion smooths out spatial variations. It is a well-known result for the Fisher-KPP equation with Neumann boundary conditions that solutions with any nontrivial, nonnegative initial data converge to the stable, spatially uniform equilibrium $u(x,t) \\to K$.\n-   **Absorbing edges:** The linear analysis identified a persistence condition $L > \\pi\\sqrt{D/r}$. This defines a critical habitat length $L_c = \\pi\\sqrt{D/r}$. If $L < L_c$, the trivial solution $u\\equiv 0$ is linearly stable. For the logistic model, since $f(u) = ru(1-u/K) \\le ru$, any solution $u(t,x)$ is bounded above by the solution to the linearized problem, which decays to zero when $L<L_c$. By the comparison principle for PDEs, the solution $u(x,t)$ must also decay to zero. Thus, if the habitat is smaller than the critical length $L_c$, the population goes extinct.\n-   Both parts of the statement are established consequences of the preceding analysis applied to the specific logistic model.\n-   Verdict: **Correct**.",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "Real-world environments are rarely static; they fluctuate, often randomly. This practice tackles the challenge of modeling a system subject to a stochastic environment, revealing a critical pitfall of naive 'mean-field' approximations. You will use the properties of stochastic processes and the principle of timescale separation to derive a corrected model that properly accounts for environmental variability, a crucial skill for building robust models of complex systems .",
            "id": "4146932",
            "problem": "A large, well-mixed population with Susceptible–Infected–Susceptible (SIS) dynamics evolves under an exogenous environment that modulates contact rates. Let the state variable be the infected fraction $i(t) \\in [0,1]$, and consider the mean-field limit $N \\to \\infty$ where fluctuations due to demographic noise vanish. The instantaneous infection rate is $\\beta(E(t)) i(t) \\bigl(1 - i(t)\\bigr)$ and the recovery rate is $\\gamma i(t)$, with $\\gamma > 0$ constant. The environment $E(t)$ is modeled as an Ornstein–Uhlenbeck (OU) process with mean $\\mu$, relaxation time $\\tau$, and noise intensity $D$, namely\n$$\n\\mathrm{d}E(t) \\;=\\; -\\frac{1}{\\tau}\\bigl(E(t)-\\mu\\bigr)\\,\\mathrm{d}t \\;+\\; \\sqrt{2D}\\,\\mathrm{d}W_t,\n$$\nwhere $W_t$ is a standard Wiener process. The contact-modulated infection rate is assumed to be $\\beta(E) \\,=\\, \\beta_0 \\exp\\bigl(\\alpha E\\bigr)$ with $\\beta_0 > 0$ and $\\alpha \\in \\mathbb{R}$. The conventional mean-field closure that replaces $E(t)$ by its mean $\\mu$ yields $\\beta(\\mu)$, but this neglects environmental variability and its interaction with nonlinear infection dynamics.\n\nStarting only from the definitions of the mean-field SIS model and properties of the Ornstein–Uhlenbeck process (stationarity, Gaussian invariance, and ergodicity), and from well-tested facts about expectations of smooth functions of Gaussian random variables, do the following:\n\n- Explain why replacing $\\beta(E(t))$ by $\\beta(\\mu)$ generally breaks mean-field self-consistency when the environment fluctuates, using the convexity or concavity of the relevant functions to argue the direction of bias introduced by variability.\n\n- Under a separation of time scales assumption in which the environment relaxes rapidly relative to the epidemic dynamics (i.e., $\\tau$ is sufficiently small that $E(t)$ is effectively stationary and rapidly mixing on the time scale of $i(t)$), derive a corrected deterministic mean-field equation for $i(t)$ in which the random $\\beta(E(t))$ is replaced by an effective constant $\\beta_{\\mathrm{eff}}$ obtained by averaging over the stationary distribution of $E(t)$. Justify any independence or averaging assumptions you use in the derivation from first principles of the large-population and fast-environment limits.\n\n- Using the stationary distribution of the Ornstein–Uhlenbeck process, compute $\\beta_{\\mathrm{eff}}$ in closed form in terms of $\\beta_0$, $\\alpha$, $\\mu$, and the stationary environmental variance $\\sigma^2$ (recall that for the OU process above, $\\sigma^2 = D\\tau$ at stationarity). Then, solve for the nontrivial endemic equilibrium $i^{\\star}$ of the corrected mean-field equation, provided it exists (i.e., for parameter values such that the endemic equilibrium is positive).\n\nYour final answer must be a single closed-form analytic expression for the corrected endemic equilibrium $i^{\\star}$ in terms of $\\beta_0$, $\\alpha$, $\\mu$, $\\sigma^2$, and $\\gamma$. Do not include units in the final answer. If any approximation is used, clearly state it in your derivation; no numerical rounding is required.",
            "solution": "The problem is first validated to ensure it is scientifically sound and well-posed.\n\n### Step 1: Extract Givens\n-   **Model**: Susceptible–Infected–Susceptible (SIS) dynamics in a large, well-mixed population ($N \\to \\infty$).\n-   **State Variable**: Infected fraction $i(t) \\in [0,1]$.\n-   **Instantaneous Infection Rate**: $\\beta(E(t)) i(t) \\bigl(1 - i(t)\\bigr)$.\n-   **Instantaneous Recovery Rate**: $\\gamma i(t)$, with $\\gamma > 0$ constant.\n-   **Environment Process $E(t)$**: Ornstein–Uhlenbeck (OU) process described by the stochastic differential equation (SDE):\n    $$\n    \\mathrm{d}E(t) \\;=\\; -\\frac{1}{\\tau}\\bigl(E(t)-\\mu\\bigr)\\,\\mathrm{d}t \\;+\\; \\sqrt{2D}\\,\\mathrm{d}W_t\n    $$\n    where $\\mu$ is the mean, $\\tau$ is the relaxation time, $D$ is the noise intensity, and $W_t$ is a standard Wiener process.\n-   **Infection Rate Function**: $\\beta(E) = \\beta_0 \\exp\\bigl(\\alpha E\\bigr)$, with $\\beta_0 > 0$ and $\\alpha \\in \\mathbb{R}$.\n-   **Stationary Environmental Variance**: $\\sigma^2 = D\\tau$.\n-   **Time-scale Assumption**: The environment relaxes rapidly relative to epidemic dynamics ($\\tau$ is small).\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a standard extension of a canonical epidemiological model (SIS) to include environmental stochasticity, a common practice in theoretical ecology and epidemiology. The models used—the mean-field SIS model and the Ornstein-Uhlenbeck process—are cornerstones of their respective fields. The functional form for the infection rate is a standard choice. The problem is well-posed, providing all necessary definitions, parameters, and a clear set of tasks that lead to a unique, derivable solution. The language is objective and precise. The problem is free from scientific unsoundness, ambiguity, and internal contradictions. It is a substantive theoretical problem requiring the application of established mathematical techniques (Jensen's inequality, averaging over a stationary distribution of a stochastic process).\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution is provided below.\n\n### Derivation\n\nThe dynamics of the infected fraction $i(t)$ in the mean-field limit are described by the ordinary differential equation:\n$$\n\\frac{\\mathrm{d}i}{\\mathrm{d}t} = \\text{rate of infection} - \\text{rate of recovery}\n$$\nGiven the functional forms, this becomes a stochastic differential equation driven by the environmental noise in $E(t)$:\n$$\n\\frac{\\mathrm{d}i}{\\mathrm{d}t} = \\beta(E(t)) i(t) \\bigl(1 - i(t)\\bigr) - \\gamma i(t)\n$$\n\n**Part 1: Bias of the conventional mean-field closure**\n\nThe conventional mean-field closure approximates the stochastic term $\\beta(E(t))$ by its value at the mean of the environment, $\\beta(\\langle E(t) \\rangle)$. For the OU process at stationarity, $\\langle E(t) \\rangle_{\\text{stat}} = \\mu$. Thus, this closure approximates the true average infection parameter $\\langle \\beta(E(t)) \\rangle_{\\text{stat}}$ with $\\beta(\\mu)$.\n\nTo analyze the bias of this approximation, we examine the convexity of the function $\\beta(E) = \\beta_0 \\exp(\\alpha E)$. A function $\\phi(x)$ is convex if its second derivative $\\phi''(x) \\ge 0$, and strictly convex if $\\phi''(x) > 0$. The derivatives of $\\beta(E)$ with respect to $E$ are:\n$$\n\\frac{\\mathrm{d}\\beta}{\\mathrm{d}E} = \\beta_0 \\alpha \\exp(\\alpha E)\n$$\n$$\n\\frac{\\mathrm{d}^2\\beta}{\\mathrm{d}E^2} = \\beta_0 \\alpha^2 \\exp(\\alpha E)\n$$\nSince $\\beta_0 > 0$ and $\\exp(\\alpha E) > 0$ for all real $E$, the sign of the second derivative is determined by $\\alpha^2$. For any $\\alpha \\in \\mathbb{R}$ such that $\\alpha \\neq 0$, we have $\\alpha^2 > 0$, which implies $\\frac{\\mathrm{d}^2\\beta}{\\mathrm{d}E^2} > 0$. Therefore, $\\beta(E)$ is a strictly convex function of $E$ for any non-zero $\\alpha$.\n\nJensen's inequality states that for a random variable $E$ and a convex function $\\beta(E)$, the expectation of the function is greater than or equal to the function of the expectation: $\\langle \\beta(E) \\rangle \\ge \\beta(\\langle E \\rangle)$. For a strictly convex function and a non-degenerate random variable (i.e., one with non-zero variance), the inequality is strict:\n$$\n\\langle \\beta(E) \\rangle > \\beta(\\langle E \\rangle)\n$$\nIn our case, the stationary environmental process $E(t)$ has mean $\\mu$ and variance $\\sigma^2 = D\\tau > 0$ (for $D, \\tau > 0$). Thus:\n$$\n\\langle \\beta(E(t)) \\rangle_{\\text{stat}} > \\beta(\\mu)\n$$\nThis demonstrates that the conventional closure, which replaces the true average effect of the environment $\\langle \\beta(E(t)) \\rangle_{\\text{stat}}$ with $\\beta(\\mu)$, systematically underestimates the effective transmission rate whenever environmental fluctuations are present and $\\alpha \\neq 0$. This underestimation is a direct consequence of the nonlinear (specifically, convex) relationship between the environment and the transmission rate.\n\n**Part 2: Corrected mean-field equation**\n\nUnder the assumption of time-scale separation, the environment $E(t)$ fluctuates on a much faster time scale (of order $\\tau$) than the epidemic prevalence $i(t)$. This allows us to average the effect of the rapid environmental fluctuations on the slow epidemic dynamics. The SDE for $i(t)$ can be formally written over a time interval $\\Delta t$ that is large compared to $\\tau$ but small enough that $i(t)$ does not change significantly:\n$$\n\\frac{\\mathrm{d}i}{\\mathrm{d}t} \\approx \\left\\langle \\beta(E(t)) \\right\\rangle_{\\text{stat}} i(t) \\bigl(1 - i(t)\\bigr) - \\gamma i(t)\n$$\nwhere $\\langle \\cdot \\rangle_{\\text{stat}}$ denotes the average over the stationary distribution of the ergodic process $E(t)$. We define an effective constant transmission rate $\\beta_{\\mathrm{eff}}$ as this stationary average:\n$$\n\\beta_{\\mathrm{eff}} := \\langle \\beta(E(t)) \\rangle_{\\text{stat}} = \\int_{-\\infty}^{\\infty} \\beta(E) p_{\\text{stat}}(E) \\mathrm{d}E\n$$\nThe corrected deterministic mean-field equation for the infected fraction $i(t)$ is therefore:\n$$\n\\frac{\\mathrm{d}i}{\\mathrm{d}t} = \\beta_{\\mathrm{eff}} i(t) \\bigl(1 - i(t)\\bigr) - \\gamma i(t)\n$$\n\n**Part 3: Calculation of $\\beta_{\\mathrm{eff}}$ and the endemic equilibrium $i^{\\star}$**\n\nThe stationary distribution of the specified Ornstein-Uhlenbeck process is a Gaussian (normal) distribution with mean $\\mu$ and variance $\\sigma^2 = D\\tau$. Its probability density function is:\n$$\np_{\\text{stat}}(E) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(E-\\mu)^2}{2\\sigma^2} \\right)\n$$\nWe compute $\\beta_{\\mathrm{eff}}$ by integrating $\\beta(E) = \\beta_0 \\exp(\\alpha E)$ against this density:\n$$\n\\beta_{\\mathrm{eff}} = \\int_{-\\infty}^{\\infty} \\beta_0 \\exp(\\alpha E) \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(E-\\mu)^2}{2\\sigma^2} \\right) \\mathrm{d}E\n$$\nThis is the expectation of $\\exp(\\alpha E)$ where $E \\sim \\mathcal{N}(\\mu, \\sigma^2)$. This expectation is a standard result related to the moment-generating function of a normal distribution. Let's derive it by completing the square in the exponent:\n$$\n\\alpha E - \\frac{(E-\\mu)^2}{2\\sigma^2} = \\alpha E - \\frac{E^2 - 2E\\mu + \\mu^2}{2\\sigma^2} = -\\frac{1}{2\\sigma^2} [E^2 - 2E(\\mu + \\alpha\\sigma^2) + \\mu^2]\n$$\n$$\n= -\\frac{1}{2\\sigma^2} \\left( [E - (\\mu + \\alpha\\sigma^2)]^2 - (\\mu + \\alpha\\sigma^2)^2 + \\mu^2 \\right)\n$$\n$$\n= -\\frac{[E - (\\mu + \\alpha\\sigma^2)]^2}{2\\sigma^2} + \\frac{(\\mu + \\alpha\\sigma^2)^2 - \\mu^2}{2\\sigma^2}\n$$\n$$\n= -\\frac{[E - (\\mu + \\alpha\\sigma^2)]^2}{2\\sigma^2} + \\frac{\\mu^2 + 2\\mu\\alpha\\sigma^2 + \\alpha^2\\sigma^4 - \\mu^2}{2\\sigma^2}\n$$\n$$\n= -\\frac{[E - (\\mu + \\alpha\\sigma^2)]^2}{2\\sigma^2} + \\alpha\\mu + \\frac{1}{2}\\alpha^2\\sigma^2\n$$\nSubstituting this back into the integral for $\\beta_{\\mathrm{eff}}$:\n$$\n\\beta_{\\mathrm{eff}} = \\frac{\\beta_0}{\\sqrt{2\\pi\\sigma^2}} \\int_{-\\infty}^{\\infty} \\exp\\left( -\\frac{[E - (\\mu + \\alpha\\sigma^2)]^2}{2\\sigma^2} + \\alpha\\mu + \\frac{1}{2}\\alpha^2\\sigma^2 \\right) \\mathrm{d}E\n$$\nThe term $\\exp\\left(\\alpha\\mu + \\frac{1}{2}\\alpha^2\\sigma^2\\right)$ is constant with respect to $E$ and can be factored out:\n$$\n\\beta_{\\mathrm{eff}} = \\beta_0 \\exp\\left(\\alpha\\mu + \\frac{1}{2}\\alpha^2\\sigma^2\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{[E - (\\mu + \\alpha\\sigma^2)]^2}{2\\sigma^2} \\right) \\mathrm{d}E\n$$\nThe integral is of a Gaussian probability density function (with mean $\\mu + \\alpha\\sigma^2$ and variance $\\sigma^2$) over its entire domain, which equals $1$. Thus, the effective transmission rate is:\n$$\n\\beta_{\\mathrm{eff}} = \\beta_0 \\exp\\left(\\alpha\\mu + \\frac{1}{2}\\alpha^2\\sigma^2\\right)\n$$\nFinally, we solve for the nontrivial endemic equilibrium $i^{\\star}$ from the corrected mean-field equation by setting $\\frac{\\mathrm{d}i}{\\mathrm{d}t} = 0$:\n$$\n0 = i^{\\star} \\left[ \\beta_{\\mathrm{eff}}(1 - i^{\\star}) - \\gamma \\right]\n$$\nThis equation has two solutions: the disease-free equilibrium $i^{\\star} = 0$, and the endemic equilibrium found by solving:\n$$\n\\beta_{\\mathrm{eff}}(1 - i^{\\star}) - \\gamma = 0\n$$\n$$\n1 - i^{\\star} = \\frac{\\gamma}{\\beta_{\\mathrm{eff}}}\n$$\n$$\ni^{\\star} = 1 - \\frac{\\gamma}{\\beta_{\\mathrm{eff}}}\n$$\nThis equilibrium is positive and\nthus biologically meaningful provided $\\beta_{\\mathrm{eff}} > \\gamma$. Substituting the expression for $\\beta_{\\mathrm{eff}}$:\n$$\ni^{\\star} = 1 - \\frac{\\gamma}{\\beta_0 \\exp\\left(\\alpha\\mu + \\frac{1}{2}\\alpha^2\\sigma^2\\right)}\n$$\nThis can be rewritten as:\n$$\ni^{\\star} = 1 - \\frac{\\gamma}{\\beta_0} \\exp\\left(-\\left(\\alpha\\mu + \\frac{1}{2}\\alpha^2\\sigma^2\\right)\\right)\n$$\nThis is the final closed-form expression for the corrected endemic equilibrium.",
            "answer": "$$\n\\boxed{1 - \\frac{\\gamma}{\\beta_0} \\exp\\left(-\\alpha\\mu - \\frac{1}{2}\\alpha^{2}\\sigma^{2}\\right)}\n$$"
        },
        {
            "introduction": "Complex systems are defined by both their internal interaction structures and their coupling to the external environment. This practice synthesizes these two aspects by modeling an epidemic on a population with household clustering, subject to environmental seasonality. You will combine analytical and computational approaches to determine the threshold for an outbreak and simulate its final size, representing a complete workflow from theoretical modeling to quantitative prediction .",
            "id": "4146749",
            "problem": "Consider a population structured into households undergoing a Susceptible-Infected-Recovered (SIR) epidemic with two interaction channels: within-household contacts and between-household community contacts. Let the total population size be $N$, decomposed into households of sizes $n \\in \\{1,2,\\dots\\}$ with a household-size distribution $P_H(n)$, where $\\sum_n P_H(n) = 1$. Assume mass-action within and between households at the mesoscopic level and negligible demographic turnover over the epidemic timescale. The infectious period is exponentially distributed with rate $\\gamma$ (in $\\mathrm{day}^{-1}$), so that recovery occurs at rate $\\gamma I(t)$. Within-household contact intensity is parameterized by a per-contact transmission rate $\\beta_h$ (in $\\mathrm{day}^{-1}$ per contact), while community transmission is parameterized by a time-varying per-contact rate $\\beta_c(t)$ (in $\\mathrm{day}^{-1}$ per contact) that captures environmental seasonality. The community contact rate per infectious individual is $c_c$ (contacts per $\\mathrm{day}$), and the within-household per-infectious contactable neighbors per person is encoded by the household clustering term\n$$\nc_h \\equiv \\frac{\\mathbb{E}\\left[n(n-1)\\right]}{\\mathbb{E}[n]} = \\frac{\\sum_n n(n-1) P_H(n)}{\\sum_n n P_H(n)},\n$$\nwhich is the expected number of within-household neighbors per person under the individual-weighted household-size distribution. The environment drives seasonality in community transmission via\n$$\n\\beta_c(t) = \\beta_0 \\left(1 + a \\sin\\left(\\frac{2\\pi t}{T}\\right)\\right),\n$$\nwhere $\\beta_0$ (in $\\mathrm{day}^{-1}$ per contact) is the baseline community per-contact transmission rate, $a \\in [0,1)$ is the dimensionless seasonality amplitude, and $T$ (in $\\mathrm{day}$) is the season length.\n\nUsing the mass-action approximation for aggregated dynamics, the mesoscopic SIR equations are\n$$\n\\frac{dS}{dt} = -\\lambda(t) S, \\quad \\frac{dI}{dt} = \\lambda(t) S - \\gamma I, \\quad \\frac{dR}{dt} = \\gamma I,\n$$\nwith the force of infection\n$$\n\\lambda(t) = \\left(\\beta_h c_h + \\beta_c(t) c_c\\right)\\frac{I(t)}{N}.\n$$\nAssume initial conditions $S(0) = N - I_0$, $I(0) = I_0$, $R(0) = 0$, with $I_0 \\ll N$.\n\nYour tasks are:\n1. Starting only from the given definitions and equations, derive the invasion threshold for the baseline community transmission parameter $\\beta_0$ under periodic environmental forcing, using linear stability analysis appropriate for linear time-periodic systems. The threshold must be expressed in $\\mathrm{day}^{-1}$ per contact units. Clearly state the mathematical reasoning and any required intermediate results that lead from the base equations to the threshold condition.\n2. Compute the final outbreak size, defined as $R(t_\\mathrm{end})/N$, as a decimal fraction (not a percentage), for a sufficiently long horizon $t_\\mathrm{end}$ so that $I(t_\\mathrm{end}) \\approx 0$. Use numerical integration to solve the SIR system with the specified seasonality and parameters in each test case.\n\nYour program must implement the following test suite, producing results for each case in order. For each case, output two floats: the final outbreak size $R(t_\\mathrm{end})/N$ and the derived invasion threshold value for $\\beta_0$ in $\\mathrm{day}^{-1}$ per contact units. Use $t_\\mathrm{end} = 1095$ (days) in all cases, and express angles in radians where applicable.\n\n- Case 1 (happy path, moderate clustering and seasonality):\n  - $N = 100000$, $I_0 = 10$, $\\gamma = 0.2$ $\\mathrm{day}^{-1}$, $\\beta_h = 0.05$ $\\mathrm{day}^{-1}$ per contact, $c_c = 8$ contacts/day, $a = 0.2$, $T = 365$ days, $\\beta_0 = 0.03$ $\\mathrm{day}^{-1}$ per contact.\n  - Household-size distribution $P_H(n)$: $P_H(1) = 0.2$, $P_H(2) = 0.3$, $P_H(3) = 0.25$, $P_H(4) = 0.15$, $P_H(5) = 0.1$.\n\n- Case 2 (boundary: no clustering, nonseasonal community):\n  - $N = 100000$, $I_0 = 10$, $\\gamma = 0.2$ $\\mathrm{day}^{-1}$, $\\beta_h = 0.05$ $\\mathrm{day}^{-1}$ per contact, $c_c = 8$ contacts/day, $a = 0.0$, $T = 365$ days, $\\beta_0 = 0.026$ $\\mathrm{day}^{-1}$ per contact.\n  - Household-size distribution $P_H(n)$: $P_H(1) = 1.0$.\n\n- Case 3 (edge: strong clustering sustains transmission even without community):\n  - $N = 100000$, $I_0 = 10$, $\\gamma = 0.2$ $\\mathrm{day}^{-1}$, $\\beta_h = 0.08$ $\\mathrm{day}^{-1}$ per contact, $c_c = 8$ contacts/day, $a = 0.5$, $T = 365$ days, $\\beta_0 = 0.0$ $\\mathrm{day}^{-1}$ per contact.\n  - Household-size distribution $P_H(n)$: $P_H(3) = 0.1$, $P_H(4) = 0.4$, $P_H(5) = 0.3$, $P_H(6) = 0.2$.\n\n- Case 4 (boundary: high seasonality amplitude but subcritical average):\n  - $N = 100000$, $I_0 = 10$, $\\gamma = 0.2$ $\\mathrm{day}^{-1}$, $\\beta_h = 0.05$ $\\mathrm{day}^{-1}$ per contact, $c_c = 8$ contacts/day, $a = 0.8$, $T = 365$ days, $\\beta_0 = 0.010$ $\\mathrm{day}^{-1}$ per contact.\n  - Household-size distribution $P_H(n)$: same as Case 1.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as:\n$$\n\\left[\\;z_1,\\;\\beta_{0,\\mathrm{th},1},\\;z_2,\\;\\beta_{0,\\mathrm{th},2},\\;z_3,\\;\\beta_{0,\\mathrm{th},3},\\;z_4,\\;\\beta_{0,\\mathrm{th},4}\\;\\right],\n$$\nwhere $z_i$ is the final outbreak size fraction for case $i$, and $\\beta_{0,\\mathrm{th},i}$ is the threshold baseline community per-contact transmission rate for case $i$ in $\\mathrm{day}^{-1}$ per contact units. Ensure scientific realism and internal consistency in your derivations and computations. No user input is required; all parameters are specified above.",
            "solution": "The problem presents a Susceptible-Infected-Recovered (SIR) model for an infectious disease spreading through a population structured into households. The model incorporates two modes of transmission: within-household and between-household (community). The community transmission rate is subject to periodic environmental forcing. The tasks are to first derive the invasion threshold for the baseline community transmission rate, $\\beta_0$, and second, to compute the final outbreak size for a set of specified scenarios.\n\nThe solution is structured into two main parts corresponding to the two tasks.\n\nPart 1: Derivation of the Invasion Threshold for $\\beta_0$\n\nThe criterion for an epidemic to invade a population is that the number of infectious individuals, $I(t)$, must initially exhibit sustained growth. This is determined by analyzing the stability of the disease-free equilibrium (DFE), which for this system corresponds to the state $(S, I, R) = (N, 0, 0)$. The DFE is unstable if a small perturbation (the introduction of infectious individuals) grows over time.\n\nWe begin with the equation for the rate of change of the infected population:\n$$\n\\frac{dI}{dt} = \\lambda(t) S - \\gamma I\n$$\nThe force of infection, $\\lambda(t)$, is given by:\n$$\n\\lambda(t) = \\left(\\beta_h c_h + \\beta_c(t) c_c\\right)\\frac{I(t)}{N}\n$$\nwhere the community transmission rate is time-dependent:\n$$\n\\beta_c(t) = \\beta_0 \\left(1 + a \\sin\\left(\\frac{2\\pi t}{T}\\right)\\right)\n$$\nTo analyze the initial phase of the epidemic, we assume the number of infected individuals is very small compared to the total population, $I(t) \\ll N$. In this limit, the susceptible population is approximately constant, $S(t) \\approx N$. Substituting this approximation and the expression for $\\lambda(t)$ into the equation for $I(t)$ yields:\n$$\n\\frac{dI}{dt} \\approx \\left(\\beta_h c_h + \\beta_c(t) c_c\\right)\\frac{I(t)}{N} N - \\gamma I(t)\n$$\nThis simplifies to a linear, first-order ordinary differential equation with a time-periodic coefficient:\n$$\n\\frac{dI}{dt} = \\left[ \\left(\\beta_h c_h + \\beta_c(t) c_c \\right) - \\gamma \\right] I(t)\n$$\nSubstituting the expression for $\\beta_c(t)$:\n$$\n\\frac{dI}{dt} = \\left[ \\beta_h c_h + \\beta_0 c_c \\left(1 + a \\sin\\left(\\frac{2\\pi t}{T}\\right)\\right) - \\gamma \\right] I(t)\n$$\nThis equation is of the form $\\frac{dI}{dt} = f(t) I(t)$, where $f(t)$ is a $T$-periodic function representing the instantaneous growth rate of the infection. According to Floquet theory for linear time-periodic systems, the solution $I(t)$ will grow unboundedly if the average of the growth rate $f(t)$ over one period $T$ is positive. The invasion condition is therefore:\n$$\n\\frac{1}{T} \\int_0^T f(t) dt > 0\n$$\n$$\n\\frac{1}{T} \\int_0^T \\left[ \\beta_h c_h + \\beta_0 c_c + a \\beta_0 c_c \\sin\\left(\\frac{2\\pi t}{T}\\right) - \\gamma \\right] dt > 0\n$$\nThe integral of the sinusoidal term over one full period is zero:\n$$\n\\int_0^T \\sin\\left(\\frac{2\\pi t}{T}\\right) dt = \\left[-\\frac{T}{2\\pi} \\cos\\left(\\frac{2\\pi t}{T}\\right)\\right]_0^T = -\\frac{T}{2\\pi}(\\cos(2\\pi) - \\cos(0)) = 0\n$$\nThus, the time-averaged growth rate depends only on the constant terms. The invasion condition simplifies to:\n$$\n\\beta_h c_h + \\beta_0 c_c - \\gamma > 0\n$$\nAn equivalent perspective is to consider the time-averaged basic reproduction number, $\\langle R_0 \\rangle$. The instantaneous reproduction number is $R_0(t) = (\\beta_h c_h + \\beta_c(t) c_c) / \\gamma$. Invasion occurs if $\\langle R_0 \\rangle = \\frac{1}{T}\\int_0^T R_0(t) dt > 1$, which yields the same inequality.\n\nThe invasion threshold for $\\beta_0$, denoted $\\beta_{0,\\text{th}}$, is the critical value of $\\beta_0$ at which this inequality becomes an equality, marking the boundary between epidemic growth and decay.\n$$\n\\beta_h c_h + \\beta_{0,\\text{th}} c_c - \\gamma = 0\n$$\nSolving for $\\beta_{0,\\text{th}}$ gives:\n$$\n\\beta_{0,\\text{th}} = \\frac{\\gamma - \\beta_h c_h}{c_c}\n$$\nThis expression represents the baseline community transmission rate required to initiate an epidemic, given the existing within-household transmission. A special case arises if the within-household transmission is sufficient to sustain an epidemic on its own, i.e., if $\\beta_h c_h > \\gamma$. In this scenario, the numerator $\\gamma - \\beta_h c_h$ becomes negative. As $\\beta_0$ must be non-negative, any value of $\\beta_0 \\ge 0$ will lead to an outbreak. The threshold is effectively zero in this case. Therefore, the physically correct expression for the threshold is:\n$$\n\\beta_{0,\\text{th}} = \\max\\left(0, \\frac{\\gamma - \\beta_h c_h}{c_c}\\right)\n$$\nThis formula will be used to compute the threshold for each test case, requiring the pre-computation of the household clustering term $c_h = \\frac{\\sum_n n(n-1) P_H(n)}{\\sum_n n P_H(n)}$ from the given household size distributions.\n\nPart 2: Computation of Final Outbreak Size\n\nOnce an epidemic is established, its progression is governed by the full non-linear system of differential equations, as the depletion of susceptibles, $S(t)$, becomes significant. The final outbreak size, $z = R(t_\\mathrm{end}) / N$, cannot be determined from the linear analysis alone. We must numerically integrate the complete system of ODEs:\n$$\n\\frac{dS}{dt} = -\\left(\\beta_h c_h + \\beta_0 \\left(1 + a \\sin\\left(\\frac{2\\pi t}{T}\\right)\\right) c_c\\right)\\frac{I(t)}{N} S(t)\n$$\n$$\n\\frac{dI}{dt} = \\left(\\beta_h c_h + \\beta_0 \\left(1 + a \\sin\\left(\\frac{2\\pi t}{T}\\right)\\right) c_c\\right)\\frac{I(t)}{N} S(t) - \\gamma I(t)\n$$\n$$\n\\frac{dR}{dt} = \\gamma I(t)\n$$\nThese equations are solved numerically using the initial conditions $S(0) = N - I_0$, $I(0) = I_0$, and $R(0) = 0$. The integration is performed over the time interval $[0, t_\\mathrm{end}]$, where $t_\\mathrm{end} = 1095$ days is sufficiently long for the number of infected individuals to fall to a negligible level, $I(t_\\mathrm{end}) \\approx 0$. The final size is then the fraction of the population in the recovered compartment at $t_\\mathrm{end}$.\n\nThe implementation will proceed by first defining a function to calculate $c_h$ for each case's household distribution. Then, for each test case, the derived formula is used to compute $\\beta_{0,\\text{th}}$. Subsequently, a numerical ODE solver, specifically `scipy.integrate.solve_ivp`, is employed to solve the non-linear system. The final state vector yields $R(t_\\mathrm{end})$, from which the final size fraction $z$ is calculated. The results for all cases are then consolidated into the specified output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the SIR model problem for all test cases.\n    For each case, it calculates the invasion threshold for beta_0 and the final outbreak size.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            \"N\": 100000, \"I0\": 10, \"gamma\": 0.2, \"beta_h\": 0.05,\n            \"c_c\": 8, \"a\": 0.2, \"T\": 365, \"beta_0\": 0.03,\n            \"ph_dist\": {1: 0.2, 2: 0.3, 3: 0.25, 4: 0.15, 5: 0.1}\n        },\n        # Case 2\n        {\n            \"N\": 100000, \"I0\": 10, \"gamma\": 0.2, \"beta_h\": 0.05,\n            \"c_c\": 8, \"a\": 0.0, \"T\": 365, \"beta_0\": 0.026,\n            \"ph_dist\": {1: 1.0}\n        },\n        # Case 3\n        {\n            \"N\": 100000, \"I0\": 10, \"gamma\": 0.2, \"beta_h\": 0.08,\n            \"c_c\": 8, \"a\": 0.5, \"T\": 365, \"beta_0\": 0.0,\n            \"ph_dist\": {3: 0.1, 4: 0.4, 5: 0.3, 6: 0.2}\n        },\n        # Case 4\n        {\n            \"N\": 100000, \"I0\": 10, \"gamma\": 0.2, \"beta_h\": 0.05,\n            \"c_c\": 8, \"a\": 0.8, \"T\": 365, \"beta_0\": 0.010,\n            \"ph_dist\": {1: 0.2, 2: 0.3, 3: 0.25, 4: 0.15, 5: 0.1}\n        },\n    ]\n\n    results = []\n    t_end = 1095.0\n\n    for case in test_cases:\n        # Task 1: Calculate the invasion threshold for beta_0\n        \n        # Calculate household clustering term c_h\n        ph_dist = case[\"ph_dist\"]\n        E_n = sum(n * p for n, p in ph_dist.items())\n        E_n_n_minus_1 = sum(n * (n - 1) * p for n, p in ph_dist.items())\n        c_h = E_n_n_minus_1 / E_n if E_n > 0 else 0.0\n\n        # Calculate threshold beta_0_th\n        gamma = case[\"gamma\"]\n        beta_h = case[\"beta_h\"]\n        c_c = case[\"c_c\"]\n        numerator = gamma - beta_h * c_h\n        beta_0_th = max(0.0, numerator / c_c)\n\n        # Task 2: Compute the final outbreak size via numerical integration\n        \n        def sir_model_ode(t, y, params):\n            \"\"\"Defines the system of ODEs for the SIR model.\"\"\"\n            S, I, R = y\n            N, gamma_val, beta_h_val, c_c_val, a_val, T_val, beta_0_val, c_h_val = params\n\n            beta_c_t = beta_0_val * (1 + a_val * np.sin(2 * np.pi * t / T_val))\n            force_of_infection_per_capita = (beta_h_val * c_h_val + beta_c_t * c_c_val) * I / N\n            \n            dSdt = -force_of_infection_per_capita * S\n            dIdt = force_of_infection_per_capita * S - gamma_val * I\n            dRdt = gamma_val * I\n            \n            return [dSdt, dIdt, dRdt]\n\n        N = case[\"N\"]\n        I0 = case[\"I0\"]\n        \n        # Initial conditions and time span\n        y0 = [N - I0, I0, 0.0]\n        t_span = [0.0, t_end]\n        \n        # Parameter tuple for the ODE solver\n        params = (\n            N, case[\"gamma\"], case[\"beta_h\"], case[\"c_c\"],\n            case[\"a\"], case[\"T\"], case[\"beta_0\"], c_h\n        )\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            fun=sir_model_ode,\n            t_span=t_span,\n            y0=y0,\n            args=(params,),\n            method='RK45',\n            rtol=1e-6,\n            atol=1e-6\n        )\n        \n        #\n        # Extract the final number of recovered individuals at t_end\n        R_final = sol.y[2, -1]\n        final_size_fraction = R_final / N\n        \n        results.append(final_size_fraction)\n        results.append(beta_0_th)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}