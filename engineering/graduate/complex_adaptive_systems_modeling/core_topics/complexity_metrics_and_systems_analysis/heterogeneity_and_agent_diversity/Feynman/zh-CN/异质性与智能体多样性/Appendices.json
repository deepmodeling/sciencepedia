{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你完成一个经典的经济建模实践。我们将看到如何从异质性主体的个体决策出发，推导出精确的、聚合的市场层面行为（资产需求）。这个练习对于理解微观基础如何在适当的设定下，即便在存在多样性的情况下也能导向易于处理的宏观规律至关重要。",
            "id": "4125499",
            "problem": "考虑一个单期经济体，其中包含总质量为 $M>0$ 的连续统代理人。每个代理人 $i$ 选择一个风险资产头寸 $y_i \\in \\mathbb{R}$，以最大化期末消费 $c_i$ 的期望效用。代理人的偏好为常数绝对风险规避（CARA; Constant Absolute Risk Aversion），由 $u_i(c) = -\\exp(-\\rho_i c)$ 给出，其中特定于代理人的绝对风险规避参数 $\\rho_i$ 在代理人之间是异质的。风险资产的期末随机回报为 $X$，服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态分布，记作 $X \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。无风险资产的总回报率为 $R_f > 0$。风险资产在期初以价格 $P > 0$ 进行交易。\n\n每个代理人 $i$ 拥有初始财富 $W_i > 0$，并将 $y_i$ 单位分配给风险资产，以价格 $P$ 为购买融资，并将其余财富投入无风险资产。代理人 $i$ 的期末消费为\n$$\nc_i \\;=\\; R_f\\,(W_i - P y_i) \\;+\\; y_i X.\n$$\n代理人选择 $y_i$ 以最大化 $\\mathbb{E}[u_i(c_i)]$。\n\n代理人的异质性通过 $\\rho_i$ 的分布来体现：$\\rho_i$ 的值独立地从形状参数为 $g>1$、速率参数为 $\\lambda>0$ 的伽马分布中抽取，其概率密度函数为\n$$\np(\\rho) \\;=\\; \\frac{\\lambda^{g}}{\\Gamma(g)}\\,\\rho^{g-1}\\,\\exp(-\\lambda \\rho), \\quad \\rho>0,\n$$\n其中 $\\Gamma(\\cdot)$ 表示伽马函数。\n\n仅使用期望效用最大化的基本定义、正态分布的性质以及CARA效用设定，通过将个体最优 $y_i$ 对分布 $p(\\rho)$ 进行积分，并对代理人总质量 $M$ 进行聚合，来推导风险资产的总需求 $Y(P)$。将您的最终答案表示为关于 $M$、$\\mu$、$\\sigma^{2}$、$P$、$R_f$、$g$ 和 $\\lambda$ 的单个闭式解析表达式。不需要进行数值近似或四舍五入。最终表达式中不包含单位。",
            "solution": "代理人的问题是选择 $y_i$ 来最大化 $\\mathbb{E}\\big[-\\exp(-\\rho_i c_i)\\big]$，其中 $c_i = R_f(W_i - P y_i) + y_i X$ 且 $X \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。因为 $c_i$ 是 $X$ 的仿射函数，且 $X$ 服从正态分布，所以 $c_i$ 也服从正态分布。我们利用正态分布的矩生成函数来刻画 $\\mathbb{E}[\\exp(-\\rho_i c_i)]$。\n\n将 $c_i$ 写为\n$$\nc_i \\;=\\; R_f W_i \\;+\\; y_i \\mu \\;-\\; R_f P y_i \\;+\\; y_i (X - \\mu).\n$$\n由于 $X - \\mu \\sim \\mathcal{N}(0,\\sigma^{2})$，我们得到 $c_i$ 是一个正态分布，其均值为\n$$\n\\mathbb{E}[c_i] \\;=\\; R_f W_i \\;+\\; y_i \\mu \\;-\\; R_f P y_i\n$$\n方差为\n$$\n\\mathrm{Var}(c_i) \\;=\\; y_i^{2}\\,\\sigma^{2}.\n$$\n对于一个正态随机变量 $Z \\sim \\mathcal{N}(m,s^{2})$，对任意实数 $t$，其期望为 $\\mathbb{E}[\\exp(t Z)] = \\exp\\!\\big(t m + \\tfrac{1}{2} t^{2} s^{2}\\big)$。应用此性质，令 $t=-\\rho_i$ 和 $Z=c_i$，我们得到\n$$\n\\mathbb{E}\\big[\\exp(-\\rho_i c_i)\\big] \\;=\\; \\exp\\!\\Big(-\\rho_i\\,\\mathbb{E}[c_i] \\;+\\; \\tfrac{1}{2}\\,\\rho_i^{2}\\,\\mathrm{Var}(c_i)\\Big)\n\\;=\\; \\exp\\!\\Big(-\\rho_i\\big(R_f W_i + y_i \\mu - R_f P y_i\\big) + \\tfrac{1}{2}\\rho_i^{2} y_i^{2} \\sigma^{2}\\Big).\n$$\n因此，期望效用为\n$$\n\\mathbb{E}\\big[u_i(c_i)\\big] \\;=\\; -\\,\\exp\\!\\Big(-\\rho_i\\big(R_f W_i + y_i \\mu - R_f P y_i\\big) + \\tfrac{1}{2}\\rho_i^{2} y_i^{2} \\sigma^{2}\\Big).\n$$\n最大化 $\\mathbb{E}[u_i(c_i)]$ 关于 $y_i$ 的问题等价于最小化指数部分\n$$\nB_i(y_i) \\;=\\; -\\rho_i\\big(R_f W_i + y_i \\mu - R_f P y_i\\big) \\;+\\; \\tfrac{1}{2}\\rho_i^{2} y_i^{2} \\sigma^{2},\n$$\n因为函数 $-\\exp(\\cdot)$ 在其参数上是严格递减的。$B_i(y_i)$ 关于 $y_i$ 的导数为\n$$\n\\frac{d B_i}{d y_i} \\;=\\; -\\rho_i(\\mu - R_f P) \\;+\\; \\rho_i^{2}\\,\\sigma^{2}\\, y_i.\n$$\n将一阶条件设为零，得到\n$$\n-\\rho_i(\\mu - R_f P) \\;+\\; \\rho_i^{2}\\,\\sigma^{2}\\, y_i^{\\ast} \\;=\\; 0\n\\quad \\Longrightarrow \\quad\ny_i^{\\ast} \\;=\\; \\frac{\\mu - R_f P}{\\rho_i\\,\\sigma^{2}}.\n$$\n请注意，$W_i$ 在最优选择中被消除了，因为CARA偏好与正态风险相结合会产生与财富无关的风险需求。\n\n总需求 $Y(P)$ 是个体需求在总体上的积分，并按总质量 $M$ 进行缩放。当异质性仅存在于 $\\rho_i$ 时，我们有\n$$\nY(P) \\;=\\; M \\int_{0}^{\\infty} \\frac{\\mu - R_f P}{\\rho\\,\\sigma^{2}}\\, p(\\rho)\\, d\\rho\n\\;=\\; \\frac{M(\\mu - R_f P)}{\\sigma^{2}} \\int_{0}^{\\infty} \\frac{1}{\\rho}\\, p(\\rho)\\, d\\rho\n\\;=\\; \\frac{M(\\mu - R_f P)}{\\sigma^{2}}\\,\\mathbb{E}\\!\\left[\\frac{1}{\\rho}\\right].\n$$\n对于 $\\rho \\sim \\text{Gamma}(g,\\lambda)$，其形状参数为 $g>1$，速率参数为 $\\lambda>0$，\n$$\np(\\rho) \\;=\\; \\frac{\\lambda^{g}}{\\Gamma(g)}\\,\\rho^{g-1}\\,\\exp(-\\lambda \\rho), \\quad \\rho>0,\n$$\n伽马分布的一个标准性质是\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{\\rho}\\right] \\;=\\; \\frac{\\lambda}{g-1},\n\\quad \\text{valid for } g>1.\n$$\n将此代入总需求表达式，得到\n$$\nY(P) \\;=\\; \\frac{M(\\mu - R_f P)}{\\sigma^{2}}\\,\\frac{\\lambda}{g-1}\n\\;=\\; \\frac{M\\,\\lambda\\,(\\mu - R_f P)}{\\sigma^{2}\\,(g-1)}.\n$$\n这是一个通过对绝对风险规避的异质分布上的一阶条件进行积分而得到的闭式总需求函数。",
            "answer": "$$\\boxed{\\frac{M\\,\\lambda\\,(\\mu - R_f P)}{\\sigma^{2}\\,(g-1)}}$$"
        },
        {
            "introduction": "从解析模型转向计算模拟，本练习旨在探索群体异质性的*结构*如何塑造集体动态。通过实现一个门槛采纳模型，你将研究主体门槛的双峰分布——代表了不同的人群亚组——如何导致复杂的、非线性的扩散模式。这是基于主体的建模中的一项核心技能，展示了宏观层面的动力学如何从微观层面属性的分布中涌现。",
            "id": "4125496",
            "problem": "考虑一个测度为 $1$ 的总体，该总体由异质性主体构成，每个主体都由一个个人采纳阈值 $\\theta \\in [0,1]$ 来表征。时间是离散的，由 $t \\in \\{0,1,2,\\dots\\}$ 索引。令 $x_t \\in [0,1]$ 表示在时间 $t$ 的采纳者比例。一个主体在时间 $t+1$ 采纳，当且仅当其观察到的暴露水平（在充分混合近似下，假定等于全局采纳比例 $x_t$）超过其阈值。采纳是吸收性的：一旦一个主体采纳，她将一直是采纳者。总体中的阈值分布是异质的，并被建模为定义在 $[0,1]$ 上的两个 Beta 分布的双峰混合模型。\n\n该混合模型由众数位置 $m_1 \\in (0,1)$ 和 $m_2 \\in (0,1)$、集中度参数 $c_1 > 0$ 和 $c_2 > 0$ 以及混合权重 $w \\in [0,1]$ 进行参数化。对于每个分量 $i \\in \\{1,2\\}$，定义 Beta 分布的形状参数 $\\alpha_i = 1 + m_i c_i$ 和 $\\beta_i = 1 + (1 - m_i) c_i$，这保证了当 $\\alpha_i > 1$ 且 $\\beta_i > 1$ 时，Beta 分布的众数位于 $m_i$。令 $F_i(x)$ 表示参数为 $(\\alpha_i, \\beta_i)$ 的 Beta 分布的累积分布函数 (CDF)。总体阈值的 CDF 是一个混合分布\n$$\nG(x) = w \\, F_1(x) + (1 - w) \\, F_2(x),\n$$\n它通过众数的位置和权重以及它们的集中度来捕捉主体的多样性。\n\n在充分混合阈值采纳的假设下，采纳者的比例演化为一个单调非减过程，由下式给出\n$$\nx_{t+1} = \\max\\{x_t, G(x_t)\\},\n$$\n其中初始采纳比例为 $x_0 \\in [0,1]$。将扩散速度操作性地定义为 $x_t$ 达到给定的目标采纳水平 $a \\in (0,1)$（特别是 $a = 0.5$ 和 $a = 0.9$）时的最早迭代指数；将这些时间表示为 $\\tau_{0.5}$ 和 $\\tau_{0.9}$。将扩散广度定义为极限 $x^{\\ast} = \\lim_{t \\to \\infty} x_t$，它是在单调吸收动态下一个满足 $x^{\\ast} = G(x^{\\ast})$ 的不动点。\n\n从阈值采纳和累积分布函数的基本定义出发，实现一个确定性模拟，该模拟能够：\n- 如上所述，为给定的参数 $m_1$、$m_2$、$c_1$、$c_2$ 和 $w$ 计算混合 CDF $G(x)$。\n- 迭代更新规则 $x_{t+1} = \\max\\{x_t, G(x_t)\\}$，直到在容差 $\\varepsilon = 10^{-10}$ 内收敛到一个不动点，或达到最大迭代次数上限 $T_{\\max} = 1000$。\n- 记录 $\\tau_{0.5}$ 和 $\\tau_{0.9}$ 分别为满足 $x_t \\ge 0.5$ 和 $x_t \\ge 0.9$ 的最小 $t$；如果这些目标在 $T_{\\max}$ 次迭代内未达到，则将相应的时间记录为 $-1$。\n- 报告扩散广度 $x^{\\ast}$，即收敛时的最终 $x_t$（如果在上限内未实现收敛，则为 $T_{\\max}$ 时的值）。\n\n所有量都是无单位的分数，以 $[0,1]$ 区间内的小数表示。时间是计算迭代次数的整数。\n\n使用以下参数集测试套件，每个参数集指定为一个元组 $(m_1, c_1, m_2, c_2, w, x_0)$：\n1. $(0.10, 80, 0.80, 80, 0.70, 0.05)$\n2. $(0.05, 20, 0.90, 20, 0.30, 0.02)$\n3. $(0.40, 50, 0.60, 50, 0.50, 0.05)$\n4. $(0.20, 100, 0.50, 10, 1.00, 0.01)$\n5. $(0.50, 10, 0.95, 100, 0.00, 0.05)$\n6. $(0.15, 30, 0.85, 30, 0.50, 0.20)$\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是 $[x^{\\ast}, \\tau_{0.5}, \\tau_{0.9}]$ 形式的列表，其中 $x^{\\ast}$ 是浮点数，$\\tau_{0.5}, \\tau_{0.9}$ 是整数。因此，最终输出是根据测试套件排序的列表的列表，例如 $[[x^{\\ast}_1, \\tau_{0.5,1}, \\tau_{0.9,1}], \\dots, [x^{\\ast}_6, \\tau_{0.5,6}, \\tau_{0.9,6}]]$.",
            "solution": "问题陈述已经过严格验证，被认为是科学上合理、定义明确且完整的。它描述了一个异质性主体群体中的经典阈值扩散模型，这是复杂适应系统研究中的一个核心重要课题。该公式在数学上是精确的，在计算上是可行的。\n\n该问题要求对社会扩散的确定性过程进行模拟。我们考虑一个主体群体，其中每个主体对于采纳一种行为或创新都有一个个人阈值 $\\theta$。群体中的异质性由这些阈值的分布来捕捉。如果现有采纳者的比例 $x_t$ 超过一个主体的个人阈值 $\\theta$，该主体就会采纳。\n\n**1. 模型构建**\n\n模型的核心是群体状态与主体特征分布之间的相互作用。\n\n**主体异质性与阈值分布：**\n主体阈值的多样性由一个概率分布建模。累积分布函数 (CDF)，记为 $G(x)$，给出了阈值 $\\theta \\le x$ 的群体比例。问题为阈值指定了一个双峰分布，由两个 Beta 分布的混合构成。这是一个灵活的选择，适合于对具有不同主体集群（例如，“早期采纳者”和“后期大多数”）的群体进行建模。\n\n群体的阈值 CDF 由下式给出：\n$$\nG(x) = w \\cdot F_1(x) + (1 - w) \\cdot F_2(x)\n$$\n其中 $F_1(x)$ 和 $F_2(x)$ 是两个 Beta 分布分量的 CDF，$w \\in [0,1]$ 是混合权重。\n\n**Beta 分布参数化：**\n每个 Beta 分布分量都定义在区间 $[0,1]$ 上。Beta 分布通常由两个形状参数 $\\alpha$ 和 $\\beta$ 来参数化。问题提供了一种基于众数（最频繁的阈值）$m_i \\in (0,1)$ 和每个分量 $i \\in \\{1,2\\}$ 的集中度参数 $c_i > 0$ 的直观参数化方法。形状参数推导如下：\n$$\n\\alpha_i = 1 + m_i c_i\n$$\n$$\n\\beta_i = 1 + (1 - m_i) c_i\n$$\n该公式确保了 $\\alpha_i > 1$ 和 $\\beta_i > 1$，这是存在唯一内部众数的条件。Beta($\\alpha_i, \\beta_i$) 分布的众数由 $(\\alpha_i - 1) / (\\alpha_i + \\beta_i - 2)$ 给出。代入 $\\alpha_i$ 和 $\\beta_i$ 的表达式可以证实众数确实是 $m_i$：\n$$\n\\text{Mode} = \\frac{(1 + m_i c_i) - 1}{(1 + m_i c_i) + (1 + (1 - m_i) c_i) - 2} = \\frac{m_i c_i}{m_i c_i + (1 - m_i) c_i} = \\frac{m_i c_i}{c_i} = m_i\n$$\n对于参数为 $(\\alpha_i, \\beta_i)$ 的 Beta 分布，其 CDF $F_i(x)$ 是正则化不完全 Beta 函数 $I_x(\\alpha_i, \\beta_i)$。\n\n**采纳动态：**\n采纳者比例在离散时间步 $t=0, 1, 2, \\dots$ 上演化。在任何时间 $t$，愿意采纳的主体比例是其阈值被当前采纳水平达到或超过的那些主体的比例，即所有阈值 $\\theta \\le x_t$ 的主体。这个比例恰好是 $G(x_t)$。\n问题陈述采纳是吸收性的，意味着已采纳的主体永远不会恢复原状。这意味着采纳者比例 $x_t$ 不会减少。因此，动态过程由以下从初始采纳比例 $x_0$ 开始的迭代映射捕获：\n$$\nx_{t+1} = \\max\\{x_t, G(x_t)\\}\n$$\n此方程确保序列 $\\{x_t\\}$ 是单调非减且上有界（上界为 1）。根据单调收敛定理，该序列保证收敛到一个极限，我们将其记为扩散广度 $x^* = \\lim_{t \\to \\infty} x_t$。这个极限 $x^*$ 将是满足条件 $y \\ge G(y)$ 的最小的 $y \\ge x_0$ 值，代表了系统的稳定均衡。\n\n**2. 算法实现**\n\n任务是为一组给定的参数 $(m_1, c_1, m_2, c_2, w, x_0)$ 模拟这些动态，并报告扩散广度 $x^*$ 和扩散速度（用达到特定采纳水平所需的时间 $\\tau$ 来衡量）。\n\n**模拟过程：**\n对于每个测试用例，算法按以下步骤进行：\n1.  **初始化**：\n    -   设置时间步 $t=0$。\n    -   将初始采纳比例 $x_t$ 设置为给定的 $x_0$。\n    -   初始化目标时间 $\\tau_{0.5} = -1$ 和 $\\tau_{0.9} = -1$，表示它们尚未达到。\n    -   定义最大迭代次数 $T_{\\max} = 1000$ 和收敛容差 $\\varepsilon = 10^{-10}$。\n\n2.  **迭代循环**：\n    -   模拟从 $t=0$ 到 $T_{\\max}-1$ 进行迭代。在每一步中：\n        a. 根据给定的众数和集中度参数计算 Beta 形状参数 $\\alpha_1, \\beta_1, \\alpha_2, \\beta_2$。\n        b. 在当前采纳水平 $x_t$ 处评估混合 CDF $G(x_t)$。这需要计算 Beta 分布的 CDF $F_1(x_t)$ 和 $F_2(x_t)$，这可以通过使用数值库函数（例如 `scipy.stats.beta.cdf`）来完成。\n        c. 计算下一个状态 $x_{t+1} = \\max\\{x_t, G(x_t)\\}$。\n        d. 检查是否首次越过采纳阈值：\n           - 如果 $x_{t+1} \\geq 0.5$ 且 $\\tau_{0.5}$ 仍为 $-1$，则设置 $\\tau_{0.5} = t+1$。\n           - 如果 $x_{t+1} \\geq 0.9$ 且 $\\tau_{0.9}$ 仍为 $-1$，则设置 $\\tau_{0.9} = t+1$。\n        e. 检查收敛性：如果 $|x_{t+1} - x_t|  \\varepsilon$，则系统已达到稳定状态。循环终止，并将 $x^*$ 设置为 $x_{t+1}$。\n        f. 为下一次迭代更新状态：$x_t \\leftarrow x_{t+1}$。\n\n3.  **终止与输出**：\n    -   如果循环在达到 $T_{\\max}$ 时仍未收敛而完成，则将 $x_t$ 的最终值作为 $x^*$。\n    -   该测试用例的最终结果是 $[x^*, \\tau_{0.5}, \\tau_{0.9}]$。\n\n该算法为问题提供了一个完整、确定性且可验证的解决方案。它将使用 Python 实现，并利用 `scipy` 库来获得所需的统计函数。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import beta\n\ndef solve():\n    \"\"\"\n    Solves the bimodal threshold diffusion problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # (m1, c1, m2, c2, w, x0)\n        (0.10, 80, 0.80, 80, 0.70, 0.05),\n        (0.05, 20, 0.90, 20, 0.30, 0.02),\n        (0.40, 50, 0.60, 50, 0.50, 0.05),\n        (0.20, 100, 0.50, 10, 1.00, 0.01),\n        (0.50, 10, 0.95, 100, 0.00, 0.05),\n        (0.15, 30, 0.85, 30, 0.50, 0.20),\n    ]\n\n    T_max = 1000\n    epsilon = 1e-10\n    \n    all_results = []\n\n    for case in test_cases:\n        m1, c1, m2, c2, w, x0 = case\n\n        # Calculate Beta distribution parameters\n        alpha1 = 1 + m1 * c1\n        beta1 = 1 + (1 - m1) * c1\n        alpha2 = 1 + m2 * c2\n        beta2 = 1 + (1 - m2) * c2\n\n        # Initialize simulation variables\n        x_t = x0\n        tau_05 = -1\n        tau_09 = -1\n        \n        # Main simulation loop\n        for t in range(T_max):\n            # Calculate the mixture CDF G(x_t)\n            cdf1 = beta.cdf(x_t, alpha1, beta1)\n            cdf2 = beta.cdf(x_t, alpha2, beta2)\n            G_xt = w * cdf1 + (1 - w) * cdf2\n            \n            # Apply the update rule\n            x_t_plus_1 = max(x_t, G_xt)\n\n            # Check for reaching targets for the first time\n            if x_t_plus_1 = 0.5 and tau_05 == -1:\n                tau_05 = t + 1\n            if x_t_plus_1 = 0.9 and tau_09 == -1:\n                tau_09 = t + 1\n            \n            # Check for convergence\n            if abs(x_t_plus_1 - x_t)  epsilon:\n                x_t = x_t_plus_1\n                break\n            \n            # Update state\n            x_t = x_t_plus_1\n        \n        # Store the results for this case\n        x_star = x_t\n        all_results.append([x_star, tau_05, tau_09])\n    \n    # Format the final output string to be a list of lists without spaces\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n\n```"
        },
        {
            "introduction": "最后的练习解决了一个建模中的关键挑战：我们如何将模型与真实世界的数据联系起来？在处理像基于主体的模型这样的复杂系统时，其似然函数通常是难以处理的。本练习向你介绍合成似然法（synthetic likelihood），这是一种强大的基于模拟的推断技术，它允许你通过比较模型生成的汇总统计量与观测数据，来估计控制主体异质性的参数。",
            "id": "4125483",
            "problem": "考虑一个包含$N$个主体的基于主体的模型（ABM），这些主体具有异构的个体参数$\\{\\phi_{i}\\}_{i=1}^{N}$，其中每个$\\phi_{i}$都是从一个由群体级参数向量$\\theta \\in \\mathbb{R}^{p}$参数化的分布中独立抽取的。令$X(\\theta)$表示在固定$\\theta$下运行ABM所生成的随机系统状态，令$s(X(\\theta)) \\in \\mathbb{R}^{d}$为一个$d$维总结性统计量向量，该向量编码了由主体异质性所塑造的聚合结果（例如，某个感兴趣结果的跨主体均值和跨主体离散度）。假设以下基本前提：\n- 根据针对相关但弱相关聚合量的中心极限定理（CLT），对于足够大的$N$和固定的$\\theta$，$s(X(\\theta))$的分布可以由一个均值为$\\mu_{\\theta} \\in \\mathbb{R}^{d}$、协方差为$\\Sigma_{\\theta} \\in \\mathbb{R}^{d \\times d}$的多元高斯分布很好地近似。\n- 在相同$\\theta$下的独立模拟重复实验是从$s(X(\\theta))$的分布中进行的独立同分布抽样。\n- 在对$S$次独立重复实验进行聚合时，无偏样本协方差使用因子$1/(S-1)$。\n\n现给定一个从经验数据中计算得出的观测总结性向量$s_{\\text{obs}} \\in \\mathbb{R}^{d}$，该数据由一个未知的真实异质性参数$\\theta^{\\star}$生成。合成似然通过将在$\\theta$下的$S$次独立模拟中计算出的经验估计量$(\\widehat{\\mu}_{\\theta}, \\widehat{\\Sigma}_{\\theta})$替换$(\\mu_{\\theta}, \\Sigma_{\\theta})$，来近似难解的似然$p(s_{\\text{obs}} \\mid \\theta)$，从而在总结性统计量空间中得到一个代入式高斯似然。\n\n任务1（推导）：从高斯近似下$s_{\\text{obs}}$的似然定义出发，推导代入式合成对数似然$\\widetilde{\\ell}_{\\text{SL}}(\\theta; s_{\\text{obs}})$的闭式表达式，该表达式用$d$、$\\widehat{\\mu}_{\\theta}$和$\\widehat{\\Sigma}_{\\theta}$表示，其中\n$$\n\\widehat{\\mu}_{\\theta} \\equiv \\frac{1}{S} \\sum_{r=1}^{S} s^{(r)}(\\theta), \n\\quad\n\\widehat{\\Sigma}_{\\theta} \\equiv \\frac{1}{S-1} \\sum_{r=1}^{S} \\left(s^{(r)}(\\theta) - \\widehat{\\mu}_{\\theta}\\right)\\left(s^{(r)}(\\theta) - \\widehat{\\mu}_{\\theta}\\right)^{\\top},\n$$\n且$s^{(r)}(\\theta)$表示在参数$\\theta$下总结性向量的第$r$次独立模拟抽样。\n\n任务2（求值）：对于$d = 2$和$S = 5$，假设在固定的$\\theta$下，五个独立的模拟总结性向量为\n$$\ns^{(1)}(\\theta) = \\begin{pmatrix} 0.8 \\\\ 1.7 \\end{pmatrix}, \\quad\ns^{(2)}(\\theta) = \\begin{pmatrix} 1.2 \\\\ 2.3 \\end{pmatrix}, \\quad\ns^{(3)}(\\theta) = \\begin{pmatrix} 1.1 \\\\ 2.1 \\end{pmatrix}, \\quad\ns^{(4)}(\\theta) = \\begin{pmatrix} 0.9 \\\\ 1.9 \\end{pmatrix}, \\quad\ns^{(5)}(\\theta) = \\begin{pmatrix} 1.0 \\\\ 2.0 \\end{pmatrix}.\n$$\n观测到的总结性向量为\n$$\ns_{\\text{obs}} = \\begin{pmatrix} 1.05 \\\\ 2.15 \\end{pmatrix}.\n$$\n使用任务1的结果，为这些数据计算代入式合成对数似然$\\widetilde{\\ell}_{\\text{SL}}(\\theta; s_{\\text{obs}})$的数值。将您的最终数值答案四舍五入到四位有效数字。不需要单位。",
            "solution": "用户提供了一个提法明确且有科学依据的问题陈述，需要一个分为两部分的解答：先进行推导，然后进行数值评估。\n\n### 任务1：代入式合成对数似然的推导\n\n问题指明总结性统计量向量$s(X(\\theta))$的分布可用多元高斯分布$\\mathcal{N}(\\mu_{\\theta}, \\Sigma_{\\theta})$近似。合成似然方法用通过$S$次独立模拟计算出的经验估计值$(\\widehat{\\mu}_{\\theta}, \\widehat{\\Sigma}_{\\theta})$来代替真实未知的参数$(\\mu_{\\theta}, \\Sigma_{\\theta})$。\n\n一个均值为$\\mu$、协方差矩阵为$\\Sigma$的$d$维多元高斯分布，其对向量$x$的概率密度函数 (PDF) 由下式给出：\n$$\np(x \\mid \\mu, \\Sigma) = \\frac{1}{(2\\pi)^{d/2} \\det(\\Sigma)^{1/2}} \\exp\\left(-\\frac{1}{2}(x-\\mu)^{\\top}\\Sigma^{-1}(x-\\mu)\\right)\n$$\n在合成似然的背景下，我们在观测到的总结性统计量$s_{\\text{obs}}$处评估此PDF，并使用样本估计量$\\widehat{\\mu}_{\\theta}$和$\\widehat{\\Sigma}_{\\theta}$代替$\\mu$和$\\Sigma$。这就得到了代入式合成似然$\\widetilde{L}_{\\text{SL}}(\\theta; s_{\\text{obs}})$：\n$$\n\\widetilde{L}_{\\text{SL}}(\\theta; s_{\\text{obs}}) = p(s_{\\text{obs}} \\mid \\widehat{\\mu}_{\\theta}, \\widehat{\\Sigma}_{\\theta}) = \\frac{1}{(2\\pi)^{d/2} \\det(\\widehat{\\Sigma}_{\\theta})^{1/2}} \\exp\\left(-\\frac{1}{2}(s_{\\text{obs}}-\\widehat{\\mu}_{\\theta})^{\\top}\\widehat{\\Sigma}_{\\theta}^{-1}(s_{\\text{obs}}-\\widehat{\\mu}_{\\theta})\\right)\n$$\n代入式合成对数似然$\\widetilde{\\ell}_{\\text{SL}}(\\theta; s_{\\text{obs}})$是该表达式的自然对数：\n$$\n\\widetilde{\\ell}_{\\text{SL}}(\\theta; s_{\\text{obs}}) = \\ln\\left( \\widetilde{L}_{\\text{SL}}(\\theta; s_{\\text{obs}}) \\right)\n$$\n应用对数的性质，$\\ln(a/b) = \\ln(a) - \\ln(b)$以及$\\ln(\\exp(x)) = x$，我们得到：\n$$\n\\widetilde{\\ell}_{\\text{SL}}(\\theta; s_{\\text{obs}}) = \\ln(1) - \\ln\\left((2\\pi)^{d/2} \\det(\\widehat{\\Sigma}_{\\theta})^{1/2}\\right) - \\frac{1}{2}(s_{\\text{obs}}-\\widehat{\\mu}_{\\theta})^{\\top}\\widehat{\\Sigma}_{\\theta}^{-1}(s_{\\text{obs}}-\\widehat{\\mu}_{\\theta})\n$$\n由于$\\ln(1) = 0$并使用性质$\\ln(ab) = \\ln(a) + \\ln(b)$，该表达式简化为：\n$$\n\\widetilde{\\ell}_{\\text{SL}}(\\theta; s_{\\text{obs}}) = -\\left( \\ln\\left((2\\pi)^{d/2}\\right) + \\ln\\left(\\det(\\widehat{\\Sigma}_{\\theta})^{1/2}\\right) \\right) - \\frac{1}{2}(s_{\\text{obs}}-\\widehat{\\mu}_{\\theta})^{\\top}\\widehat{\\Sigma}_{\\theta}^{-1}(s_{\\text{obs}}-\\widehat{\\mu}_{\\theta})\n$$\n使用性质$\\ln(a^b) = b\\ln(a)$，我们得出最终的闭式表达式：\n$$\n\\widetilde{\\ell}_{\\text{SL}}(\\theta; s_{\\text{obs}}) = -\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\det(\\widehat{\\Sigma}_{\\theta})) - \\frac{1}{2}(s_{\\text{obs}}-\\widehat{\\mu}_{\\theta})^{\\top}\\widehat{\\Sigma}_{\\theta}^{-1}(s_{\\text{obs}}-\\widehat{\\mu}_{\\theta})\n$$\n该表达式用数据维度$d$、样本均值$\\widehat{\\mu}_{\\theta}$和样本协方差矩阵$\\widehat{\\Sigma}_{\\theta}$定义了合成对数似然。\n\n### 任务2：数值评估\n\n我们有以下给定数据：\n- 维度 $d=2$\n- 模拟次数 $S=5$\n- 模拟的总结性向量：\n$$\ns^{(1)}(\\theta) = \\begin{pmatrix} 0.8 \\\\ 1.7 \\end{pmatrix}, \\quad s^{(2)}(\\theta) = \\begin{pmatrix} 1.2 \\\\ 2.3 \\end{pmatrix}, \\quad s^{(3)}(\\theta) = \\begin{pmatrix} 1.1 \\\\ 2.1 \\end{pmatrix}, \\quad s^{(4)}(\\theta) = \\begin{pmatrix} 0.9 \\\\ 1.9 \\end{pmatrix}, \\quad s^{(5)}(\\theta) = \\begin{pmatrix} 1.0 \\\\ 2.0 \\end{pmatrix}\n$$\n- 观测的总结性向量：\n$$\ns_{\\text{obs}} = \\begin{pmatrix} 1.05 \\\\ 2.15 \\end{pmatrix}\n$$\n\n**步骤1：计算样本均值 $\\widehat{\\mu}_{\\theta}$**\n$$\n\\widehat{\\mu}_{\\theta} = \\frac{1}{S} \\sum_{r=1}^{S} s^{(r)}(\\theta) = \\frac{1}{5} \\left( \\begin{pmatrix} 0.8 \\\\ 1.7 \\end{pmatrix} + \\begin{pmatrix} 1.2 \\\\ 2.3 \\end{pmatrix} + \\begin{pmatrix} 1.1 \\\\ 2.1 \\end{pmatrix} + \\begin{pmatrix} 0.9 \\\\ 1.9 \\end{pmatrix} + \\begin{pmatrix} 1.0 \\\\ 2.0 \\end{pmatrix} \\right)\n$$\n$$\n\\widehat{\\mu}_{\\theta} = \\frac{1}{5} \\begin{pmatrix} 0.8+1.2+1.1+0.9+1.0 \\\\ 1.7+2.3+2.1+1.9+2.0 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 5.0 \\\\ 10.0 \\end{pmatrix} = \\begin{pmatrix} 1.0 \\\\ 2.0 \\end{pmatrix}\n$$\n\n**步骤2：计算样本协方差矩阵 $\\widehat{\\Sigma}_{\\theta}$**\n首先，我们计算中心化向量 $s^{(r)}(\\theta) - \\widehat{\\mu}_{\\theta}$：\n$s^{(1)}-\\widehat{\\mu}_{\\theta} = \\begin{pmatrix} -0.2 \\\\ -0.3 \\end{pmatrix}$, $s^{(2)}-\\widehat{\\mu}_{\\theta} = \\begin{pmatrix} 0.2 \\\\ 0.3 \\end{pmatrix}$, $s^{(3)}-\\widehat{\\mu}_{\\theta} = \\begin{pmatrix} 0.1 \\\\ 0.1 \\end{pmatrix}$, $s^{(4)}-\\widehat{\\mu}_{\\theta} = \\begin{pmatrix} -0.1 \\\\ -0.1 \\end{pmatrix}$, $s^{(5)}-\\widehat{\\mu}_{\\theta} = \\begin{pmatrix} 0.0 \\\\ 0.0 \\end{pmatrix}$。\n现在，我们计算外积之和：\n$$\n\\sum_{r=1}^{5} (s^{(r)}-\\widehat{\\mu}_{\\theta})(s^{(r)}-\\widehat{\\mu}_{\\theta})^{\\top} =\n\\begin{pmatrix} 0.04  0.06 \\\\ 0.06  0.09 \\end{pmatrix} +\n\\begin{pmatrix} 0.04  0.06 \\\\ 0.06  0.09 \\end{pmatrix} +\n\\begin{pmatrix} 0.01  0.01 \\\\ 0.01  0.01 \\end{pmatrix} +\n\\begin{pmatrix} 0.01  0.01 \\\\ 0.01  0.01 \\end{pmatrix} +\n\\begin{pmatrix} 0.00  0.00 \\\\ 0.00  0.00 \\end{pmatrix}\n= \\begin{pmatrix} 0.10  0.14 \\\\ 0.14  0.20 \\end{pmatrix}\n$$\n无偏样本协方差为：\n$$\n\\widehat{\\Sigma}_{\\theta} = \\frac{1}{S-1} \\sum_{r=1}^{S} (s^{(r)}-\\widehat{\\mu}_{\\theta})(s^{(r)}-\\widehat{\\mu}_{\\theta})^{\\top} = \\frac{1}{4} \\begin{pmatrix} 0.10  0.14 \\\\ 0.14  0.20 \\end{pmatrix} = \\begin{pmatrix} 0.025  0.035 \\\\ 0.035  0.050 \\end{pmatrix}\n$$\n\n**步骤3：计算对数似然的各项**\n需要评估的对数似然表达式为：\n$$\n\\widetilde{\\ell}_{\\text{SL}} = -\\frac{2}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\det(\\widehat{\\Sigma}_{\\theta})) - \\frac{1}{2}(s_{\\text{obs}}-\\widehat{\\mu}_{\\theta})^{\\top}\\widehat{\\Sigma}_{\\theta}^{-1}(s_{\\text{obs}}-\\widehat{\\mu}_{\\theta})\n$$\n第1项：常数项\n$$\n-\\ln(2\\pi) \\approx -1.837877\n$$\n第2项：对数行列式项\n$$\n\\det(\\widehat{\\Sigma}_{\\theta}) = (0.025)(0.050) - (0.035)^2 = 0.00125 - 0.001225 = 0.000025 = 2.5 \\times 10^{-5}\n$$\n$$\n-\\frac{1}{2}\\ln(\\det(\\widehat{\\Sigma}_{\\theta})) = -\\frac{1}{2}\\ln(2.5 \\times 10^{-5}) \\approx -\\frac{1}{2}(-10.596635) \\approx 5.298317\n$$\n第3项：马氏距离项\n首先，计算逆协方差矩阵$\\widehat{\\Sigma}_{\\theta}^{-1}$：\n$$\n\\widehat{\\Sigma}_{\\theta}^{-1} = \\frac{1}{\\det(\\widehat{\\Sigma}_{\\theta})} \\begin{pmatrix} 0.050  -0.035 \\\\ -0.035  0.025 \\end{pmatrix} = \\frac{1}{0.000025} \\begin{pmatrix} 0.050  -0.035 \\\\ -0.035  0.025 \\end{pmatrix} = 40000 \\begin{pmatrix} 0.050  -0.035 \\\\ -0.035  0.025 \\end{pmatrix} = \\begin{pmatrix} 2000  -1400 \\\\ -1400  1000 \\end{pmatrix}\n$$\n接下来，计算偏差向量$s_{\\text{obs}}-\\widehat{\\mu}_{\\theta}$：\n$$\n\\Delta s = s_{\\text{obs}}-\\widehat{\\mu}_{\\theta} = \\begin{pmatrix} 1.05 \\\\ 2.15 \\end{pmatrix} - \\begin{pmatrix} 1.0 \\\\ 2.0 \\end{pmatrix} = \\begin{pmatrix} 0.05 \\\\ 0.15 \\end{pmatrix}\n$$\n现在，计算二次型$(\\Delta s)^{\\top}\\widehat{\\Sigma}_{\\theta}^{-1}(\\Delta s)$：\n$$\n(\\Delta s)^{\\top}\\widehat{\\Sigma}_{\\theta}^{-1}(\\Delta s) = \\begin{pmatrix} 0.05  0.15 \\end{pmatrix} \\begin{pmatrix} 2000  -1400 \\\\ -1400  1000 \\end{pmatrix} \\begin{pmatrix} 0.05 \\\\ 0.15 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0.05(2000) + 0.15(-1400)  0.05(-1400) + 0.15(1000) \\end{pmatrix} \\begin{pmatrix} 0.05 \\\\ 0.15 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 100 - 210  -70 + 150 \\end{pmatrix} \\begin{pmatrix} 0.05 \\\\ 0.15 \\end{pmatrix} = \\begin{pmatrix} -110  80 \\end{pmatrix} \\begin{pmatrix} 0.05 \\\\ 0.15 \\end{pmatrix}\n$$\n$$\n= (-110)(0.05) + (80)(0.15) = -5.5 + 12.0 = 6.5\n$$\n第三项是$-\\frac{1}{2}(6.5) = -3.25$。\n\n**步骤4：将各项相加**\n$$\n\\widetilde{\\ell}_{\\text{SL}}(\\theta; s_{\\text{obs}}) \\approx -1.837877 + 5.298317 - 3.25 = 0.21044\n$$\n将结果四舍五入到四位有效数字，得到$0.2104$。",
            "answer": "$$\n\\boxed{0.2104}\n$$"
        }
    ]
}