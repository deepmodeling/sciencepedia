{
    "hands_on_practices": [
        {
            "introduction": "本次练习聚焦于随机动力学中的一个核心模型：几何布朗运动，它描述了波动与系统规模成正比的过程。通过解决这个问题，您将掌握应用伊藤引理求解随机微分方程的关键技巧，并理解伊藤积分和斯特拉托诺维奇积分这两种随机积分解释之间的微妙而关键的区别 。这是分析各种存在乘性噪声的复杂系统的基础技能。",
            "id": "4145296",
            "problem": "考虑一个介观状态变量 $x_t$，它表示一个由许多相互作用的智能体组成的复杂自适应系统的总体活动水平。微观异质性和内生反馈产生乘性涨落，这可以很好地用随机微分方程 (SDE) $dx_t = a\\,x_t\\,dt + b\\,x_t\\,dW_t$ 来建模，其中 $W_t$ 是一个标准维纳过程（布朗运动），$a \\in \\mathbb{R}$ 和 $b \\in \\mathbb{R}$ 是常数，且初始条件 $x_00$ 是确定性的。假设存在一个满足伊藤积分有效性的标准条件的常规带滤概率空间。\n\n仅从伊藤和斯特拉托诺维奇随机积分的基本定义、伊藤引理以及 $W_t$ 具有平稳独立增量且 $W_t \\sim \\mathcal{N}(0,t)$ 这一事实出发，完成以下任务：\n\n- 当相同的动力学过程表示为斯特拉托诺维奇形式 $dx_t = \\alpha(x_t)\\,dt + \\beta(x_t)\\circ dW_t$ 时，推导其漂移项，并精确地展示对于乘性噪声，斯特拉托诺维奇漂移与伊藤漂移有何不同。\n- 通过对SDE进行适当变换，得到 $x_t$ 的闭式表达式，并用它来计算一阶矩和二阶矩。\n- 根据这些矩，明确地用 $x_0$、$a$、$b$ 和 $t$ 计算 $\\mathbb{E}[x_t]$ 和 $\\mathrm{Var}(x_t)$。\n\n将最终答案表示为单个解析表达式。无需四舍五入，不涉及单位。最终答案必须以单个行矩阵的形式给出，按顺序包含伊藤漂移、斯特拉托诺维奇漂移、均值 $\\mathbb{E}[x_t]$ 和方差 $\\mathrm{Var}(x_t)$。",
            "solution": "该问题陈述已经过验证，被认为是科学上成立、适定且客观的。它提出了随机微积分中的一个标准问题，特别是几何布朗运动的分析，这是复杂系统研究中的一个基本模型。该问题是自洽的，并提供了推导唯一、有意义解所需的所有必要信息。\n\n给定的随机微分方程 (SDE) 是伊藤形式：\n$$dx_t = a\\,x_t\\,dt + b\\,x_t\\,dW_t$$\n这对应于一般的伊藤SDE $dx_t = \\mu(x_t, t)\\,dt + \\sigma(x_t, t)\\,dW_t$，其中伊藤漂移系数为 $\\mu(x_t) = a\\,x_t$，扩散系数为 $\\sigma(x_t) = b\\,x_t$。初始条件为 $x_0  0$。\n\n首先，我们推导等价的斯特拉托诺维奇SDE $dx_t = \\alpha(x_t)\\,dt + \\beta(x_t)\\circ dW_t$ 的漂移项。两种表示法中的扩散系数是相同的，因此 $\\beta(x_t) = \\sigma(x_t) = b\\,x_t$。伊藤积分和斯特拉托诺维奇积分之间的关系是转换的基础。斯特拉托诺维奇积分使用中点法则定义，这导出了以下恒等式：\n$$\\int_0^t \\sigma(x_s) \\circ dW_s = \\int_0^t \\sigma(x_s) dW_s + \\frac{1}{2} \\int_0^t \\frac{\\partial \\sigma}{\\partial x}(x_s) \\sigma(x_s) ds$$\n右边的第二项是伊藤-斯特拉托诺维奇修正项，通常称为噪声诱导漂移。\n将此关系代入斯特拉托诺维奇SDE，我们得到：\n$$dx_t = \\alpha(x_t) dt + \\int_0^t \\sigma(x_s) dW_s + \\frac{1}{2} \\int_0^t \\frac{\\partial \\sigma}{\\partial x}(x_s) \\sigma(x_s) ds$$\n其微分形式为：\n$$dx_t = \\left(\\alpha(x_t) + \\frac{1}{2} \\frac{\\partial \\sigma}{\\partial x}(x_t) \\sigma(x_t)\\right) dt + \\sigma(x_t) dW_t$$\n将其与伊藤SDE $dx_t = \\mu(x_t) dt + \\sigma(x_t) dW_t$ 进行比较，我们可以确定漂移系数之间的关系：\n$$\\mu(x_t) = \\alpha(x_t) + \\frac{1}{2} \\frac{\\partial \\sigma}{\\partial x}(x_t) \\sigma(x_t)$$\n因此，斯特拉托诺维奇漂移系数 $\\alpha(x_t)$ 可以用伊藤漂移 $\\mu(x_t)$ 和扩散项 $\\sigma(x_t)$ 表示为：\n$$\\alpha(x_t) = \\mu(x_t) - \\frac{1}{2} \\frac{\\partial \\sigma}{\\partial x}(x_t) \\sigma(x_t)$$\n对于给定的问题，我们有 $\\mu(x_t) = a\\,x_t$ 和 $\\sigma(x_t) = b\\,x_t$。$\\sigma$ 关于 $x$ 的偏导数为：\n$$\\frac{\\partial \\sigma}{\\partial x}(x_t) = \\frac{\\partial}{\\partial x} (b\\,x_t) = b$$\n将这些代入漂移的转换公式：\n$$\\alpha(x_t) = a\\,x_t - \\frac{1}{2} (b) (b\\,x_t) = a\\,x_t - \\frac{1}{2}b^2 x_t = \\left(a - \\frac{1}{2}b^2\\right) x_t$$\n伊藤漂移系数是 $\\mu(x_t) = a\\,x_t$。斯特拉托诺维奇漂移系数是 $\\alpha(x_t) = (a - \\frac{1}{2}b^2)x_t$。差项 $-\\frac{1}{2}b^2 x_t$ 是由于在使用斯特拉托诺维奇积分的中点估算时，过程 $x_t$ 与随机增量 $dW_t$ 之间存在相关性，而这一特性在非预期的伊藤积分中是不存在的。\n\n接下来，我们求 $x_t$ 的闭式解。噪声的乘性特质提示我们进行对数变换。设 $Y_t = f(x_t) = \\ln(x_t)$。我们应用伊藤引理来找到 $Y_t$ 的动力学。对于一个二阶可导函数 $f(x_t)$，伊藤引理表述为：\n$$df(x_t) = f'(x_t) dx_t + \\frac{1}{2} f''(x_t) (dx_t)^2$$\n对于 $f(x) = \\ln(x)$，其导数为 $f'(x) = \\frac{1}{x}$ 和 $f''(x) = -\\frac{1}{x^2}$。二次变分项 $(dx_t)^2$ 使用伊藤乘法规则 $dt \\cdot dt = 0$、$dt \\cdot dW_t = 0$ 和 $dW_t \\cdot dW_t = dt$ 计算得出：\n$$(dx_t)^2 = (a\\,x_t\\,dt + b\\,x_t\\,dW_t)^2 = a^2 x_t^2 (dt)^2 + 2ab\\,x_t^2\\,dt\\,dW_t + b^2 x_t^2 (dW_t)^2 = b^2 x_t^2 dt$$\n将这些代入 $dY_t = d(\\ln x_t)$ 的伊藤引理中：\n$$d(\\ln x_t) = \\frac{1}{x_t} dx_t + \\frac{1}{2} \\left(-\\frac{1}{x_t^2}\\right) (b^2 x_t^2 dt)$$\n现在，我们代入 $dx_t$ 的表达式：\n$$d(\\ln x_t) = \\frac{1}{x_t} (a\\,x_t\\,dt + b\\,x_t\\,dW_t) - \\frac{1}{2} b^2 dt$$\n$$d(\\ln x_t) = a\\,dt + b\\,dW_t - \\frac{1}{2} b^2 dt = \\left(a - \\frac{1}{2}b^2\\right)dt + b\\,dW_t$$\n这是一个关于 $Y_t = \\ln(x_t)$ 的简单线性SDE。我们可以将其从 $t=0$ 积分到 $t$：\n$$\\int_0^t d(\\ln x_s) = \\int_0^t \\left(a - \\frac{1}{2}b^2\\right) ds + \\int_0^t b\\,dW_s$$\n$$\\ln(x_t) - \\ln(x_0) = \\left(a - \\frac{1}{2}b^2\\right)t + b(W_t - W_0)$$\n根据标准维纳过程的定义 $W_0=0$，上式可简化为：\n$$\\ln\\left(\\frac{x_t}{x_0}\\right) = \\left(a - \\frac{1}{2}b^2\\right)t + bW_t$$\n对两边取指数，得到 $x_t$ 的闭式解：\n$$x_t = x_0 \\exp\\left(\\left(a - \\frac{1}{2}b^2\\right)t + bW_t\\right)$$\n\n最后，我们计算一阶矩和二阶矩，即 $\\mathbb{E}[x_t]$ 和 $\\mathrm{Var}(x_t)$。\n对于一阶矩（均值），我们对 $x_t$ 取期望：\n$$\\mathbb{E}[x_t] = \\mathbb{E}\\left[x_0 \\exp\\left(\\left(a - \\frac{1}{2}b^2\\right)t + bW_t\\right)\\right]$$\n由于 $x_0$ 和 $t$ 是确定性的，我们可以重新整理：\n$$\\mathbb{E}[x_t] = x_0 \\exp\\left(\\left(a - \\frac{1}{2}b^2\\right)t\\right) \\mathbb{E}[\\exp(bW_t)]$$\n为了计算 $\\mathbb{E}[\\exp(bW_t)]$，我们利用 $W_t$ 服从正态分布 $W_t \\sim \\mathcal{N}(0, t)$ 这一事实。因此，随机变量 $bW_t$ 服从 $\\mathcal{N}(0, b^2 t)$。对于一个正态随机变量 $Z \\sim \\mathcal{N}(\\mu_Z, \\sigma_Z^2)$，其期望 $\\mathbb{E}[\\exp(Z)]$ 由其在1处的矩母函数给出，即 $\\exp(\\mu_Z + \\frac{1}{2}\\sigma_Z^2)$。这里，对于 $Z=bW_t$，有 $\\mu_Z=0$ 和 $\\sigma_Z^2=b^2 t$。\n或者，我们可以使用 $W_t \\sim \\mathcal{N}(0, t)$ 的矩母函数，即 $M_{W_t}(k) = \\mathbb{E}[\\exp(kW_t)] = \\exp(\\frac{1}{2}k^2 t)$。在 $k=b$ 处求值：\n$$\\mathbb{E}[\\exp(bW_t)] = \\exp\\left(\\frac{1}{2}b^2 t\\right)$$\n将此结果代回 $\\mathbb{E}[x_t]$ 的表达式中：\n$$\\mathbb{E}[x_t] = x_0 \\exp\\left(\\left(a - \\frac{1}{2}b^2\\right)t\\right) \\exp\\left(\\frac{1}{2}b^2 t\\right) = x_0 \\exp\\left(at - \\frac{1}{2}b^2 t + \\frac{1}{2}b^2 t\\right)$$\n$$\\mathbb{E}[x_t] = x_0 \\exp(at)$$\n\n为了求方差 $\\mathrm{Var}(x_t) = \\mathbb{E}[x_t^2] - (\\mathbb{E}[x_t])^2$，我们首先需要二阶矩 $\\mathbb{E}[x_t^2]$。\n$$x_t^2 = \\left(x_0 \\exp\\left(\\left(a - \\frac{1}{2}b^2\\right)t + bW_t\\right)\\right)^2 = x_0^2 \\exp\\left(2\\left(a - \\frac{1}{2}b^2\\right)t + 2bW_t\\right) = x_0^2 \\exp\\left((2a - b^2)t + 2bW_t\\right)$$\n取期望：\n$$\\mathbb{E}[x_t^2] = x_0^2 \\exp((2a - b^2)t) \\mathbb{E}[\\exp(2bW_t)]$$\n我们使用 $W_t$ 的矩母函数（MGF）在 $k=2b$ 处计算 $\\mathbb{E}[\\exp(2bW_t)]$：\n$$\\mathbb{E}[\\exp(2bW_t)] = M_{W_t}(2b) = \\exp\\left(\\frac{1}{2}(2b)^2 t\\right) = \\exp\\left(\\frac{1}{2}(4b^2)t\\right) = \\exp(2b^2 t)$$\n将此结果代入 $\\mathbb{E}[x_t^2]$ 的表达式中：\n$$\\mathbb{E}[x_t^2] = x_0^2 \\exp((2a - b^2)t) \\exp(2b^2 t) = x_0^2 \\exp(2at - b^2 t + 2b^2 t) = x_0^2 \\exp((2a+b^2)t)$$\n现在我们可以计算方差：\n$$\\mathrm{Var}(x_t) = \\mathbb{E}[x_t^2] - (\\mathbb{E}[x_t])^2 = x_0^2 \\exp((2a+b^2)t) - (x_0 \\exp(at))^2$$\n$$\\mathrm{Var}(x_t) = x_0^2 \\exp(2at) \\exp(b^2 t) - x_0^2 \\exp(2at)$$\n提出公因式 $x_0^2 \\exp(2at)$：\n$$\\mathrm{Var}(x_t) = x_0^2 \\exp(2at) (\\exp(b^2 t) - 1)$$\n\n总结一下，所求的四个量是：\n1.  伊藤漂移系数: $a\\,x_t$\n2.  斯特拉托诺维奇漂移系数: $\\left(a - \\frac{1}{2}b^2\\right)x_t$\n3.  均值: $x_0 \\exp(at)$\n4.  方差: $x_0^2 \\exp(2at) (\\exp(b^2 t) - 1)$",
            "answer": "$$\\boxed{\\begin{pmatrix} a\\, x_t  \\left(a - \\frac{1}{2}b^2\\right)x_t  x_0 \\exp(at)  x_0^2 \\exp(2at) \\left(\\exp(b^2 t) - 1\\right) \\end{pmatrix}}$$"
        },
        {
            "introduction": "在几何布朗运动分析的基础上，本练习通过引入李雅普诺夫指数的概念，深入探讨了随机系统的长期行为。您将推导这个关键的稳定性指标，并揭示一个反直觉的现象——噪声诱导的稳定性，即随机波动可以抑制一个在确定性条件下不稳定的系统 。这个实践突显了随机性如何以确定性模型无法预测的方式从根本上改变系统行为。",
            "id": "4145305",
            "problem": "考虑一个标量主体级状态 $x_t$，它在由随机微分方程（SDE）的 Itô 诠释建模的乘性环境波动下演化，\n$$\ndx_t \\;=\\; a\\,x_t\\,dt \\;+\\; b\\,x_t\\,dW_t,\n$$\n其中 $a \\in \\mathbb{R}$ 是一个恒定的确定性增长参数，$b \\in \\mathbb{R}$ 是一个恒定的噪声强度，$W_t$ 是标准布朗运动（维纳过程）。假设 $x_0 \\neq 0$ 且该系统在 Itô 意义下进行诠释。\n\n在复杂自适应系统建模的框架下，与该标量过程相关的随机线性余循环的最大李雅普诺夫指数 $\\lambda$ 通过几乎必然极限定义为\n$$\n\\lambda \\;=\\; \\lim_{t \\to \\infty} \\frac{1}{t}\\,\\ln|x_t|.\n$$\n\n从布朗运动作为具有独立高斯增量的连续时间鞅的基本定义出发，并利用适用于二次连续可微函数的 Itô 引理，推导给定 SDE 的最大李雅普诺夫指数 $\\lambda$ 的闭式表达式。然后，使用 $\\lambda$ 的符号作为原点在李雅普诺夫意义下几乎必然指数稳定性的判据，确定当确定性系统本会不稳定时，哪些参数配置定性上允许通过噪声实现原点的镇定。\n\n将您的最终答案表示为关于 $a$ 和 $b$ 的单个解析表达式。无需四舍五入。不包含物理单位。",
            "solution": "该问题要求推导标量随机过程 $x_t$ 的最大李雅普诺夫指数 $\\lambda$，并找出噪声引发镇定的条件。\n\n状态 $x_t$ 根据几何布朗运动的 Itô 随机微分方程 (SDE) 演化：\n$$\ndx_t = a\\,x_t\\,dt + b\\,x_t\\,dW_t\n$$\n其中 $a$ 和 $b$ 是实常数，$W_t$ 是标准维纳过程。初始状态为 $x_0 \\neq 0$。\n\n最大李雅普诺夫指数由几乎必然极限定义：\n$$\n\\lambda = \\lim_{t \\to \\infty} \\frac{1}{t}\\,\\ln|x_t|\n$$\n\n为了找到 $\\lambda$ 的闭式表达式，我们必须首先找到 $\\ln|x_t|$ 的一个显式解。我们可以通过对函数 $f(x_t) = \\ln|x_t|$ 应用 Itô 引理来实现这一点。由于该 SDE 对 $x_t$ 是线性的且 $x_0 \\neq 0$，过程 $x_t$ 对于任何有限时间 $t  0$ 几乎必然永远不会为零。因此，函数 $\\ln|x_t|$ 是良定义的，并且对于所有相关的 $x_t$ 值，其导数都可以计算。\n\n令 $y_t = f(x_t) = \\ln|x_t|$。函数 $f(x)$ 关于 $x$ 的一阶和二阶导数是：\n$$\nf'(x) = \\frac{d}{dx}(\\ln|x|) = \\frac{1}{x}\n$$\n$$\nf''(x) = \\frac{d^2}{dx^2}(\\ln|x|) = -\\frac{1}{x^2}\n$$\n适用于函数 $f(x_t)$ 的 Itô 引理表明：\n$$\ndf(x_t) = f'(x_t)\\,dx_t + \\frac{1}{2}f''(x_t)\\,(dx_t)^2\n$$\n在 Itô 诠释中，二次变差项 $(dx_t)^2$ 使用规则 $(dt)^2 = 0$，$dt\\,dW_t = 0$ 和 $(dW_t)^2 = dt$ 来计算。\n$$\n(dx_t)^2 = (a\\,x_t\\,dt + b\\,x_t\\,dW_t)^2 = (a\\,x_t)^2(dt)^2 + 2ab\\,x_t^2\\,dt\\,dW_t + (b\\,x_t)^2(dW_t)^2\n$$\n只保留 $dt$ 的最低阶项，即 $(dW_t)^2=dt$，得到：\n$$\n(dx_t)^2 = b^2 x_t^2 dt\n$$\n将 $f(x)$ 的导数和 $(dx_t)^2$ 的表达式代入 Itô 引理：\n$$\nd(\\ln|x_t|) = \\left(\\frac{1}{x_t}\\right) (a\\,x_t\\,dt + b\\,x_t\\,dW_t) + \\frac{1}{2}\\left(-\\frac{1}{x_t^2}\\right) (b^2 x_t^2 dt)\n$$\n化简这些项，我们得到 $y_t = \\ln|x_t|$ 的 SDE：\n$$\nd(\\ln|x_t|) = (a\\,dt + b\\,dW_t) - \\frac{1}{2}b^2 dt\n$$\n$$\nd(\\ln|x_t|) = \\left(a - \\frac{1}{2}b^2\\right)dt + b\\,dW_t\n$$\n这是一个关于 $\\ln|x_t|$ 的简单线性 SDE，可以通过从 $t=0$ 到一个通用时间 $t$ 的直接积分来求解：\n$$\n\\int_0^t d(\\ln|x_s|) = \\int_0^t \\left(a - \\frac{1}{2}b^2\\right)ds + \\int_0^t b\\,dW_s\n$$\n$$\n\\ln|x_t| - \\ln|x_0| = \\left(a - \\frac{1}{2}b^2\\right)t + b(W_t - W_0)\n$$\n根据标准维纳过程的定义，$W_0=0$。因此，$\\ln|x_t|$ 的显式解是：\n$$\n\\ln|x_t| = \\ln|x_0| + \\left(a - \\frac{1}{2}b^2\\right)t + b\\,W_t\n$$\n现在，我们将此表达式代入李雅普诺夫指数 $\\lambda$ 的定义中：\n$$\n\\lambda = \\lim_{t \\to \\infty} \\frac{1}{t} \\left[ \\ln|x_0| + \\left(a - \\frac{1}{2}b^2\\right)t + b\\,W_t \\right]\n$$\n我们分别计算每一项的极限：\n$$\n\\lambda = \\lim_{t \\to \\infty} \\frac{\\ln|x_0|}{t} + \\lim_{t \\to \\infty} \\frac{\\left(a - \\frac{1}{2}b^2\\right)t}{t} + \\lim_{t \\to \\infty} \\frac{b\\,W_t}{t}\n$$\n第一项当 $t \\to \\infty$ 时趋于零，因为 $\\ln|x_0|$ 是一个常数：\n$$\n\\lim_{t \\to \\infty} \\frac{\\ln|x_0|}{t} = 0\n$$\n第二项是一个常数：\n$$\n\\lim_{t \\to \\infty} \\left(a - \\frac{1}{2}b^2\\right) = a - \\frac{1}{2}b^2\n$$\n第三项涉及维纳过程的长期行为。布朗运动（一种连续时间鞅）的强大数定律指出，当 $t \\to \\infty$ 时，$\\frac{W_t}{t}$ 几乎必然收敛于 $0$。\n$$\n\\lim_{t \\to \\infty} \\frac{W_t}{t} = 0 \\quad (\\text{几乎必然地})\n$$\n结合这些结果，我们得到李雅普诺夫指数的闭式表达式：\n$$\n\\lambda = 0 + \\left(a - \\frac{1}{2}b^2\\right) + b \\cdot 0 = a - \\frac{1}{2}b^2\n$$\n问题的第二部分要求找出允许噪声诱导镇定的条件。当一个在没有噪声时本不稳定的系统，因噪声的存在而变得稳定时，就会发生这种现象。\n确定性系统对应于 $b=0$，得到常微分方程 $dx_t = a\\,x_t\\,dt$。如果 $a  0$，则原点是一个不稳定的平衡点。\n如果随机系统的最大李雅普诺夫指数为负，即 $\\lambda  0$，则该系统被认为是几乎必然指数稳定的。\n因此，当同时满足以下两个条件时，就会发生噪声诱导的镇定：\n1. 不稳定的确定性动力学：$a  0$。\n2. 稳定的随机动力学：$\\lambda  0$。\n\n代入我们推导出的 $\\lambda$ 表达式，第二个条件变为：\n$$\na - \\frac{1}{2}b^2  0 \\quad \\implies \\quad a  \\frac{1}{2}b^2\n$$\n因此，噪声诱导镇定的参数配置由不等式 $0  a  \\frac{1}{2}b^2$ 给出。参数空间 $(a, b)$ 的这个区域表征了这样一类系统：其中正的增长率 $a$ 被足够强的乘性噪声（强度为 $b$）所克服，导致状态几乎必然地指数衰减至原点。问题要求给出所推导的单个解析表达式，即 $\\lambda$ 的表达式。",
            "answer": "$$\\boxed{a - \\frac{1}{2}b^2}$$"
        },
        {
            "introduction": "最后的这个实践练习将理论与数据分析相结合，解决一个由 Michael B. Elowitz 等研究人员开创的系统生物学经典问题。利用成对的时间序列数据，您将推导并实现一种方法，将基因表达中观测到的总变异分解为内在（过程内部）和外在（共享环境）两部分 。该练习展示了随机过程的数学框架如何为从实验测量中提取机理性的见解提供强大工具。",
            "id": "4145310",
            "problem": "您将获得在离散时间点上，于同一单细胞内同时测量的、来自两个相同荧光报告基因的成对蛋白质计数时间序列。将时间索引 $t$ 处的这对数据建模为随机变量 $X_t$ 和 $Y_t$，分别代表报告基因1和报告基因2的计数。假设存在一个潜在外在状态 $Z_t$，它在时间 $t$ 对两个报告基因产生相同的影响，并假设在给定 $Z_t$ 的条件下，$X_t$ 和 $Y_t$ 条件独立。任务是从第一性原理出发，设计一种计算方法，利用协方差将单个报告基因的总可观测方差分解为其内在分量和外在分量。\n\n使用的基本原理：\n- 全方差定律：对于任意随机变量 $X$ 和潜在变量 $Z$，$$\\mathrm{Var}(X) = \\mathbb{E}\\big[\\mathrm{Var}(X \\mid Z)\\big] + \\mathrm{Var}\\big(\\mathbb{E}[X \\mid Z]\\big).$$\n- 给定外在状态下，两个报告基因的条件独立性和可交换性：$$X \\perp\\!\\!\\!\\perp Y \\mid Z \\quad \\text{and} \\quad X \\mid Z \\stackrel{d}{=} Y \\mid Z.$$\n- 协方差的性质：对于任意两个随机变量 $X$ 和 $Y$，$$\\mathrm{Cov}(X,Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y].$$\n\n本问题的定义：\n- 将内在方差分量定义为 $$\\sigma_{\\mathrm{int}}^2 \\equiv \\mathbb{E}\\big[\\mathrm{Var}(X \\mid Z)\\big].$$\n- 将外在方差分量定义为 $$\\sigma_{\\mathrm{ext}}^2 \\equiv \\mathrm{Var}\\big(\\mathbb{E}[X \\mid Z]\\big).$$\n- 单个报告基因的可观测总方差为 $$\\sigma_{\\mathrm{tot}}^2 \\equiv \\mathrm{Var}(X).$$\n\n您的程序必须对每对时间序列，仅使用成对数据的样本统计量（均值、方差、协方差）来计算 $\\sigma_{\\mathrm{int}}^2$、$\\sigma_{\\mathrm{ext}}^2$ 和 $\\sigma_{\\mathrm{tot}}^2$ 的估计量。从全方差定律和条件独立性假设开始推导，并基于两个报告基因之间的协方差推导出估计量。然后实现最终的计算。\n\n科学真实性和约束条件：\n- 两个报告基因是相同的并且是同时测量的，因此在给定外在状态的条件下，其条件分布是相同的，并且内在噪声源在报告基因之间是独立的。\n- 因为方差是非负的，最终报告的估计值必须位于非负象限。如果任何无约束的估计量因抽样变异性而产生负值，则将您的估计值投影以满足 $$\\sigma_{\\mathrm{int}}^2 \\ge 0, \\quad \\sigma_{\\mathrm{ext}}^2 \\ge 0, \\quad \\sigma_{\\mathrm{int}}^2 + \\sigma_{\\mathrm{ext}}^2 = \\sigma_{\\mathrm{tot}}^2.$$\n\n单位：\n- 所有方差值均以“计数平方”表示。\n\n角度单位：\n- 不涉及角度。\n\n百分比：\n- 不要将任何输出表示为百分比。\n\n测试套件：\n使用以下四个长度为 $n = 10$ 的成对时间序列来测试不同的情况。所有值都是蛋白质计数（非负整数）。对于每种情况，$x$ 表示报告基因1的序列，$y$ 表示报告基因2的序列。\n\n- 情况1（一般情况，内在和外在混合）：\n  $$x = [52,54,53,53,56,57,53,57,53,54], \\quad y = [49,55,54,50,60,55,54,58,50,57].$$\n- 情况2（接近零的协方差，主要为内在）：\n  $$x = [42,38,43,37,41,39,44,36,42,38], \\quad y = [37,43,38,42,39,41,36,44,38,42].$$\n- 情况3（完全共享的外在，无内在；报告基因完全相同）：\n  $$x = [20,22,25,23,21,24,26,22,23,25], \\quad y = [20,22,25,23,21,24,26,22,23,25].$$\n- 情况4（由于反相关导致的负协方差；测试到非负性的投影）：\n  $$x = [10,20,30,40,50,60,70,80,90,100], \\quad y = [100,90,80,70,60,50,40,30,20,10].$$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含四种情况的结果，形式为用方括号括起来的逗号分隔列表。此列表的每个元素本身必须是一个包含三个浮点数 $[\\sigma_{\\mathrm{int}}^2, \\sigma_{\\mathrm{ext}}^2, \\sigma_{\\mathrm{tot}}^2]$ 的列表，四舍五入到六位小数并以“计数平方”表示。例如，输出应如下所示：$$[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3],[a_4,b_4,c_4]].$$",
            "solution": "问题陈述被评估为有效。它提出了一个来自系统生物学领域的适定的、有科学依据的问题，涉及基因表达中方差的分解。其前提具有物理动机，在数学上是合理的，任务是基于概率论的基本原理推导并实现估计量。陈述中没有矛盾、歧义或事实错误。\n\n解决方案首先推导所需方差分量与可观测样本统计量（即协方差）之间的理论关系。然后利用这些关系构建估计量，并在最终程序中实现。\n\n**1. 理论推导**\n\n目标是利用报告基因 $X$ 和 $Y$ 的成对时间序列数据中的可测量量，来寻找内在方差 $\\sigma_{\\mathrm{int}}^2$ 和外在方差 $\\sigma_{\\mathrm{ext}}^2$ 的表达式。此推导的基石是分析 $X$ 和 $Y$ 之间的协方差 $\\mathrm{Cov}(X, Y)$。\n\n我们从全协方差定律开始，该定律对任意随机变量 $X$、$Y$ 和 $Z$ 陈述如下：\n$$\n\\mathrm{Cov}(X, Y) = \\mathbb{E}[\\mathrm{Cov}(X, Y \\mid Z)] + \\mathrm{Cov}(\\mathbb{E}[X \\mid Z], \\mathbb{E}[Y \\mid Z])\n$$\n\n问题提供了关于报告基因 $X$、$Y$ 与潜在外在状态 $Z$ 之间关系的两个关键假设：\n\n1.  **条件独立性**：给定状态 $Z$，报告基因是独立的，即 $X \\perp\\!\\!\\!\\perp Y \\mid Z$。根据定义，两个独立变量的协方差为 $0$。因此，对于 $Z$ 的任何给定状态，条件协方差 $\\mathrm{Cov}(X, Y \\mid Z)$ 均为 $0$。这意味着条件协方差的期望也为零：\n    $$\n    \\mathbb{E}[\\mathrm{Cov}(X, Y \\mid Z)] = \\mathbb{E}[0] = 0\n    $$\n    将此代入全协方差定律，表达式简化为：\n    $$\n    \\mathrm{Cov}(X, Y) = \\mathrm{Cov}(\\mathbb{E}[X \\mid Z], \\mathbb{E}[Y \\mid Z])\n    $$\n\n2.  **可交换性（相同的报告基因）**：报告基因是相同的，并且以相同的方式对外在状态做出响应，意味着它们在给定 $Z$ 的条件下的概率分布是相同的，即 $X \\mid Z \\stackrel{d}{=} Y \\mid Z$。一个直接的推论是它们的条件期望相等：\n    $$\n    \\mathbb{E}[X \\mid Z] = \\mathbb{E}[Y \\mid Z]\n    $$\n    将此代入我们简化的协方差表达式，得到：\n    $$\n    \\mathrm{Cov}(X, Y) = \\mathrm{Cov}(\\mathbb{E}[X \\mid Z], \\mathbb{E}[X \\mid Z])\n    $$\n    一个随机变量与其自身的协方差就是其方差，即 $\\mathrm{Cov}(A, A) = \\mathrm{Var}(A)$。因此，\n    $$\n    \\mathrm{Cov}(X, Y) = \\mathrm{Var}(\\mathbb{E}[X \\mid Z])\n    $$\n\n问题将外在方差分量定义为 $\\sigma_{\\mathrm{ext}}^2 \\equiv \\mathrm{Var}(\\mathbb{E}[X \\mid Z])$。因此，我们推导出了核心结果：外在方差等于两个报告基因信号之间的协方差。\n$$\n\\sigma_{\\mathrm{ext}}^2 = \\mathrm{Cov}(X, Y)\n$$\n\n在确定了外在分量之后，我们可以使用全方差定律找到内在分量，该定律是作为一个基本原理给出的：\n$$\n\\mathrm{Var}(X) = \\mathbb{E}[\\mathrm{Var}(X \\mid Z)] + \\mathrm{Var}(\\mathbb{E}[X \\mid Z])\n$$\n使用问题的定义，这即是：\n$$\n\\sigma_{\\mathrm{tot}}^2 = \\sigma_{\\mathrm{int}}^2 + \\sigma_{\\mathrm{ext}}^2\n$$\n对内在方差进行移项整理，得到：\n$$\n\\sigma_{\\mathrm{int}}^2 = \\sigma_{\\mathrm{tot}}^2 - \\sigma_{\\mathrm{ext}}^2\n$$\n代入我们的发现和定义，即 $\\sigma_{\\mathrm{tot}}^2 = \\mathrm{Var}(X)$ 和 $\\sigma_{\\mathrm{ext}}^2 = \\mathrm{Cov}(X, Y)$，我们得到：\n$$\n\\sigma_{\\mathrm{int}}^2 = \\mathrm{Var}(X) - \\mathrm{Cov}(X, Y)\n$$\n\n**2. 估计量的构建**\n\n上面推导的理论关系指导我们从样本数据（此处用时间序列 $\\{x_t\\}_{t=1}^n$ 和 $\\{y_t\\}_{t=1}^n$ 表示）构建估计量。我们使用样本统计量（用帽子符号 $\\hat{\\cdot}$ 表示）来估计总体参数。\n\n-   **外在方差估计量**：基于 $\\sigma_{\\mathrm{ext}}^2 = \\mathrm{Cov}(X, Y)$，外在方差的无约束估计量是两个时间序列之间的样本协方差：\n    $$\n    \\hat{\\sigma}_{\\mathrm{ext, u}}^2 = \\widehat{\\mathrm{Cov}}(X, Y)\n    $$\n-   **总方差估计量**：总方差是为单个报告基因定义的，即 $\\sigma_{\\mathrm{tot}}^2 = \\mathrm{Var}(X)$。由于可交换性，理论上意味着 $\\mathrm{Var}(X) = \\mathrm{Var}(Y)$，因此一个更稳健的估计量通过平均它们的样本方差来使用来自两个报告基因的数据。这减少了抽样噪声的影响。\n    $$\n    \\hat{\\sigma}_{\\mathrm{tot}}^2 = \\frac{1}{2} \\left( \\widehat{\\mathrm{Var}}(X) + \\widehat{\\mathrm{Var}}(Y) \\right)\n    $$\n-   **内在方差估计量**：根据关系 $\\sigma_{\\mathrm{int}}^2 = \\sigma_{\\mathrm{tot}}^2 - \\sigma_{\\mathrm{ext}}^2$，内在方差的无约束估计量是：\n    $$\n    \\hat{\\sigma}_{\\mathrm{int, u}}^2 = \\hat{\\sigma}_{\\mathrm{tot}}^2 - \\hat{\\sigma}_{\\mathrm{ext, u}}^2\n    $$\n\n所有样本方差和协方差都使用分母为 $n-1$ 的无偏公式计算，其中 $n$ 是时间点的数量。\n\n**3. 到非负象限的投影**\n\n由于方差必须为非负，估计量必须被约束为 $\\hat{\\sigma}_{\\mathrm{int}}^2 \\ge 0$ 和 $\\hat{\\sigma}_{\\mathrm{ext}}^2 \\ge 0$。抽样误差可能导致无约束估计量 $\\hat{\\sigma}_{\\mathrm{int, u}}^2$ 或 $\\hat{\\sigma}_{\\mathrm{ext, u}}^2$ 为负值。我们应用一个投影来强制实现非负性，同时保持总方差恒等式 $\\hat{\\sigma}_{\\mathrm{int}}^2 + \\hat{\\sigma}_{\\mathrm{ext}}^2 = \\hat{\\sigma}_{\\mathrm{tot}}^2$。\n\n步骤如下：\n1.  计算三个无约束估计量：$\\hat{\\sigma}_{\\mathrm{tot}}^2$、$\\hat{\\sigma}_{\\mathrm{ext, u}}^2$ 和 $\\hat{\\sigma}_{\\mathrm{int, u}}^2 = \\hat{\\sigma}_{\\mathrm{tot}}^2 - \\hat{\\sigma}_{\\mathrm{ext, u}}^2$。\n2.  如果 $\\hat{\\sigma}_{\\mathrm{ext, u}}^2  0$：负的样本协方差对于此模型是不符合物理实际的。我们将其投影到最近的有效值，即 $0$。\n    -   $\\hat{\\sigma}_{\\mathrm{ext}}^2 = 0$\n    -   $\\hat{\\sigma}_{\\mathrm{int}}^2 = \\hat{\\sigma}_{\\mathrm{tot}}^2$\n3.  否则，如果 $\\hat{\\sigma}_{\\mathrm{int, u}}^2  0$（这等价于 $\\hat{\\sigma}_{\\mathrm{ext, u}}^2  \\hat{\\sigma}_{\\mathrm{tot}}^2$）：内在分量不能为负。我们将其投影到 $0$。\n    -   $\\hat{\\sigma}_{\\mathrm{int}}^2 = 0$\n    -   $\\hat{\\sigma}_{\\mathrm{ext}}^2 = \\hat{\\sigma}_{\\mathrm{tot}}^2$\n4.  否则（如果 $0 \\le \\hat{\\sigma}_{\\mathrm{ext, u}}^2 \\le \\hat{\\sigma}_{\\mathrm{tot}}^2$）：无约束估计值在物理上是有效的，并予以保留。\n    -   $\\hat{\\sigma}_{\\mathrm{ext}}^2 = \\hat{\\sigma}_{\\mathrm{ext, u}}^2$\n    -   $\\hat{\\sigma}_{\\mathrm{int}}^2 = \\hat{\\sigma}_{\\mathrm{int, u}}^2$\n\n最终算法将根据此逻辑为每个测试用例计算 $\\hat{\\sigma}_{\\mathrm{tot}}^2$、$\\hat{\\sigma}_{\\mathrm{ext}}^2$ 和 $\\hat{\\sigma}_{\\mathrm{int}}^2$。",
            "answer": "[[1.8,5.2,7.0],[6.888889,0.0,6.888889],[0.0,4.1,4.1],[825.0,0.0,825.0]]"
        }
    ]
}