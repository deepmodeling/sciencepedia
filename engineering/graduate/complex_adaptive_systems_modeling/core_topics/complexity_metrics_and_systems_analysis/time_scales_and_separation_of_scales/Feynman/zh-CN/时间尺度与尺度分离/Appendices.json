{
    "hands_on_practices": [
        {
            "introduction": "在分析具有多时间尺度的系统之前，我们首先需要一种严谨的方法来识别和量化这些尺度。量纲分析为此提供了基本工具，它使我们能够从一组物理参数中提取出表征尺度分离的无量纲比率。这项练习将指导您使用白金汉 $\\Pi$ 定理来识别一个复杂适应系统中的关键时间尺度，并构建决定其动态行为的无量纲参数。",
            "id": "4150136",
            "problem": "考虑一个程式化的复杂自适应系统，其中自适应智能体群体为响应收益而持续更新其内部状态，同时一个缓慢的环境变量因智能体群体的聚合行为而协同演化。微观智能体更新以特征学习率 $\\kappa$ 发生，其物理量纲为 $\\mathsf{T}^{-1}$，而宏观环境以特征速率 $\\mu$ 弛豫，其物理量纲为 $\\mathsf{T}^{-1}$。智能体表现出决策惯性，通过记忆时间 $D$（物理量纲为 $\\mathsf{T}$）来建模，并且系统受到角频率为 $\\omega$（物理量纲为 $\\mathsf{T}^{-1}$）的外源季节性强迫。假设这四个量 $\\{\\kappa, \\mu, D, \\omega\\}$ 在时间尺度的层面上完全刻画了耦合动力学的时间相关方面，并且对于本次量纲分析，除了时间 $\\mathsf{T}$ 之外，没有其他相关的独立基本量纲。\n\n仅使用基本量纲分析和白金汉 $\\Pi$ 定理，从变量 $\\{\\kappa, \\mu, D, \\omega\\}$ 和基本量纲 $\\mathsf{T}$ 构建一个完整的独立无量纲群组。将特征微观和宏观时间定义为 $T_{1} = 1/\\kappa$ 和 $T_{2} = 1/\\mu$。将主要的尺度分离参数 $\\epsilon$ 确定为比率 $T_{1}/T_{2}$，并完全用原始速率 $\\kappa$ 和 $\\mu$ 来表示 $\\epsilon$（你可以使用你的无量纲群组来这样做，但最终表达式必须只包含 $\\kappa$ 和 $\\mu$）。\n\n你的最终答案必须是一个单一的闭式解析表达式。不要在最终答案中包含单位。因为没有给出数值，所以无需四舍五入。作为你推理的一部分（不包含在最终答案中），你必须明确列举出白金汉 $\\Pi$ 定理对这组变量和基本量纲所蕴含的独立无量纲群组的数量。",
            "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n变量及其物理量纲如下：\n- 智能体学习率：$\\kappa$，量纲为 $[\\kappa] = \\mathsf{T}^{-1}$。\n- 环境弛豫率：$\\mu$，量纲为 $[\\mu] = \\mathsf{T}^{-1}$。\n- 智能体记忆时间：$D$，量纲为 $[D] = \\mathsf{T}$。\n- 外源强迫角频率：$\\omega$，量纲为 $[\\omega] = \\mathsf{T}^{-1}$。\n因此，相关变量集为 $\\{\\kappa, \\mu, D, \\omega\\}$。\n问题陈述指出，唯一相关的基本量纲是时间 $\\mathsf{T}$。\n提供了以下定义：\n- 特征微观时间：$T_{1} = 1/\\kappa$。\n- 特征宏观时间：$T_{2} = 1/\\mu$。\n- 尺度分离参数：$\\epsilon = T_{1}/T_{2}$。\n\n任务是：\n1.  使用白金汉 $\\Pi$ 定理从 $\\{\\kappa, \\mu, D, \\omega\\}$ 构建一个完整的独立无量纲群组。\n2.  完全用 $\\kappa$ 和 $\\mu$ 来表示 $\\epsilon$。\n\n**步骤2：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估：\n- **科学依据**：该问题使用了复杂自适应系统建模中的标准概念，如智能体学习率、环境反馈和时间尺度分离。所要求的方法，即通过白金汉 $\\Pi$ 定理进行量纲分析，是物理学和工程学中一种基础且严谨的技术。该设定是对耦合动力学的一种程式化但科学上连贯的表示。\n- **适定性**：所有必要的变量及其量纲都已明确提供。变量和基本量纲的数量已清楚说明，使得白金汉 $\\Pi$ 定理的应用明确无误。目标是精确的：找到一组无量纲群组和 $\\epsilon$ 的一个特定表达式。存在唯一且有意义的解。\n- **客观性**：问题以精确、定量和无偏见的语言表述，不含任何主观或非科学的主张。\n\n该问题没有表现出任何指定的无效缺陷。它在科学上是合理的，在指定领域内是可形式化的，是完整的、内部一致的且结构良好的。\n\n**步骤3：结论与行动**\n问题被宣布为**有效**。将提供完整解答。\n\n解答过程通过应用白金汉 $\\Pi$ 定理进行。变量数量为 $n=4$，对应于集合 $\\{\\kappa, \\mu, D, \\omega\\}$。基本量纲的数量为 $k=1$，即时间 ($\\mathsf{T}$)。根据白金汉 $\\Pi$ 定理，独立无量纲群组的数量，记为 $p$，由公式 $p = n - k$ 给出。在这种情况下，$p = 4 - 1 = 3$。因此，我们必须构建一个包含3个独立无量纲群组的集合。\n\n变量的量纲为 $[\\kappa] = \\mathsf{T}^{-1}$，$[\\mu] = \\mathsf{T}^{-1}$，$[\\omega] = \\mathsf{T}^{-1}$，以及 $[D] = \\mathsf{T}$。为了形成量纲为 $\\mathsf{T}^{0}$ 的无量纲量，我们必须将这些变量以 $\\kappa^{a}\\mu^{b}D^{c}\\omega^{d}$ 的乘积形式组合，使得量纲 $\\mathsf{T}$ 的幂次和为零。量纲方程为 $(\\mathsf{T}^{-1})^{a}(\\mathsf{T}^{-1})^{b}(\\mathsf{T}^{1})^{c}(\\mathsf{T}^{-1})^{d} = \\mathsf{T}^{-a-b+c-d} = \\mathsf{T}^{0}$，这意味着线性代数约束为 $-a-b+c-d=0$。\n\n构建一个独立无量纲群组集合的系统方法是，将具有相同量纲的量构成比率，以及将量纲幂次可以抵消的量构成乘积。\n变量 $\\kappa$、$\\mu$ 和 $\\omega$ 都具有量纲 $\\mathsf{T}^{-1}$。我们可以从中形成两个独立的比率。我们选择 $\\mu$ 作为参考速率。\n第一个无量纲群组 $\\Pi_1$ 是智能体学习率与环境弛豫率的比值：\n$$ \\Pi_1 = \\frac{\\kappa}{\\mu} $$\n量纲如预期般抵消：$[\\Pi_1] = \\frac{[\\kappa]}{[\\mu]} = \\frac{\\mathsf{T}^{-1}}{\\mathsf{T}^{-1}} = \\mathsf{T}^{0}$。\n\n第二个无量纲群组 $\\Pi_2$ 可以是外部强迫频率与环境弛豫率的比值：\n$$ \\Pi_2 = \\frac{\\omega}{\\mu} $$\n量纲同样地抵消：$[\\Pi_2] = \\frac{[\\omega]}{[\\mu]} = \\frac{\\mathsf{T}^{-1}}{\\mathsf{T}^{-1}} = \\mathsf{T}^{0}$。\n\n对于第三个独立无量纲群组 $\\Pi_3$，我们必须引入尚未使用的变量 $D$。$D$ 的量纲为 $\\mathsf{T}$。我们可以将其与任何一个速率（量纲为 $\\mathsf{T}^{-1}$）组合以形成一个无量纲乘积。我们使用 $\\mu$：\n$$ \\Pi_3 = \\mu D $$\n量纲抵消：$[\\Pi_3] = [\\mu][D] = \\mathsf{T}^{-1}\\mathsf{T}^{1} = \\mathsf{T}^{0}$。\n\n集合 $\\{\\Pi_1, \\Pi_2, \\Pi_3\\} = \\{\\frac{\\kappa}{\\mu}, \\frac{\\omega}{\\mu}, \\mu D\\}$ 构成了该系统的3个独立无量纲群组的完整集合。\n\n问题的第二部分要求用 $\\kappa$ 和 $\\mu$ 来表示尺度分离参数 $\\epsilon$。参数 $\\epsilon$ 定义为微观特征时间 $T_1$ 与宏观特征时间 $T_2$ 的比值。给出的定义是 $T_1 = 1/\\kappa$ 和 $T_2 = 1/\\mu$。\n将这些定义代入 $\\epsilon$ 的表达式中：\n$$ \\epsilon = \\frac{T_1}{T_2} = \\frac{1/\\kappa}{1/\\mu} $$\n化简这个复合分数得到：\n$$ \\epsilon = \\frac{1}{\\kappa} \\cdot \\frac{\\mu}{1} = \\frac{\\mu}{\\kappa} $$\n这个表达式完全由原始速率 $\\kappa$ 和 $\\mu$ 表示，符合要求。值得注意的是，该参数是我们构建的第一个无量纲群组的倒数，即 $\\epsilon = 1/\\Pi_1$。这与量纲分析的原则是一致的，因为一个代表尺度比率的有物理意义的参数必须是无量纲的。",
            "answer": "$$\n\\boxed{\\frac{\\mu}{\\kappa}}\n$$"
        },
        {
            "introduction": "一旦识别出时间尺度分离，我们如何利用它来简化模型？这项练习将向您介绍慢流形这一强大概念，即状态空间中的一个低维曲面，系统在快速瞬变后会迅速收敛于其上，并在此后沿其演化。通过一个具体的慢-快系统示例，您将亲手计算出作为模型降维基础的临界流形和一阶慢流形近似。",
            "id": "4150166",
            "problem": "考虑一个用于复杂自适应系统（Complex Adaptive Systems, CAS）的双变量快慢模型，其中个体层面的快变量 $x$ 快速适应群体层面的慢变量 $y$。该模型由以下系统控制\n$$\n\\epsilon \\,\\dot{x} \\;=\\; f(x,y), \\qquad \\dot{y} \\;=\\; g(x,y),\n$$\n其中小参数 $0  \\epsilon \\ll 1$ 表示时间尺度的分离。临界流形 $M_0$ 定义为当 $\\epsilon \\to 0$ 时快子系统瞬时达到平衡的点集，即 $M_0 \\equiv \\{(x,y): f(x,y)=0\\}$。在法向双曲性（即在 $M_0$ 上 $\\partial f/\\partial x \\neq 0$）的条件下，Fenichel 理论保证了对于小的 $\\epsilon0$，存在一个邻近的不变慢流形 $M_\\epsilon$，该流形可以局部表示为图像 $x=h(y,\\epsilon)$，并展开为 $x=h_0(y)+\\epsilon h_1(y)+\\mathcal{O}(\\epsilon^2)$。\n\n设 $f(x,y)=-x+y$ 且 $g(x,y)=x$。通过确定图像函数 $h_0(y)$ 和 $h_\\epsilon(y)=h_0(y)+\\epsilon h_1(y)$ 至 $\\epsilon$ 阶，计算临界流形 $M_0$ 和慢流形 $M_\\epsilon$ 的一阶近似。请以闭合形式的图像函数对 $(h_0(y),\\,h_\\epsilon(y))$ 表示您的最终答案。无需四舍五入，且最终表达式中不应包含任何单位。",
            "solution": "该问题是有效的。它是在几何奇异摄动理论标准框架下的一个适定问题，该理论是研究具有多重时间尺度的动力系统的一个核心课题，常应用于复杂自适应系统建模。所有必要的数据和定义均已提供，不存在科学或逻辑上的不一致性。\n\n给定的快慢系统为：\n$$\n\\epsilon \\,\\dot{x} \\;=\\; -x+y\n$$\n$$\n\\dot{y} \\;=\\; x\n$$\n其中 $\\dot{x} = \\frac{dx}{dt}$ 且 $\\dot{y} = \\frac{dy}{dt}$，且 $0  \\epsilon \\ll 1$。这对应于 $f(x,y) = -x+y$ 和 $g(x,y) = x$ 的一般形式。\n\n首先，我们计算临界流形 $M_0$。这是快动力学达到平衡的点集，可以通过在快变量 $x$ 的方程中取奇异极限 $\\epsilon \\to 0$ 来找到。\n$$\n0 = f(x,y) = -x+y\n$$\n解出 $x$ 得到临界流形的方程：\n$$\nx = y\n$$\n问题指出，慢流形 $M_\\epsilon$ 可以表示为一个图像 $x=h(y, \\epsilon)$，其展开式为 $x = h_0(y) + \\epsilon h_1(y) + \\mathcal{O}(\\epsilon^2)$。临界流形 $M_0$ 是慢流形 $M_\\epsilon$ 的零阶近似。因此，临界流形的图像函数为 $h_0(y)$：\n$$\nh_0(y) = y\n$$\n理论要求临界流形是法向双曲的。如果对于 $M_0$ 上的点，$\\frac{\\partial f}{\\partial x} \\neq 0$，则该条件得到满足。我们计算偏导数：\n$$\n\\frac{\\partial f}{\\partial x} = \\frac{\\partial}{\\partial x}(-x+y) = -1\n$$\n由于对所有 $(x,y)$ 都有 $\\frac{\\partial f}{\\partial x} = -1 \\neq 0$，因此临界流形 $M_0$ 处处都是法向双曲的，这验证了 Fenichel 理论的适用性以及慢流形展开式的存在性。\n\n接下来，我们确定一阶修正项 $h_1(y)$。慢流形 $M_\\epsilon$ 是系统的一个不变流形。这意味着任何从该流形上开始的轨迹 $(x(t), y(t))$ 都会一直保持在该流形上。如果一条轨迹位于流形上，其坐标必须在所有时间 $t$ 内都满足 $x(t) = h(y(t), \\epsilon)$。我们可以使用链式法则对该关系式关于时间求导：\n$$\n\\frac{dx}{dt} = \\frac{\\partial h(y,\\epsilon)}{\\partial y} \\frac{dy}{dt}\n$$\n代入原系统中 $\\dot{x}$ 和 $\\dot{y}$ 的表达式，我们得到不变性条件：\n$$\n\\frac{f(x,y)}{\\epsilon} = \\frac{\\partial h(y,\\epsilon)}{\\partial y} g(x,y)\n$$\n由于该方程必须对流形上的任意点都成立，我们代入 $x = h(y, \\epsilon)$：\n$$\nf(h(y,\\epsilon), y) = \\epsilon \\, g(h(y,\\epsilon), y) \\frac{\\partial h(y,\\epsilon)}{\\partial y}\n$$\n现在，我们将渐近展开式 $h(y, \\epsilon) = h_0(y) + \\epsilon h_1(y) + \\mathcal{O}(\\epsilon^2)$ 代入不变性条件。我们还需要 $f$ 和 $g$ 在 $x=h_0(y)$ 附近的泰勒展开：\n$$\nf(h_0 + \\epsilon h_1 + \\dots, y) = f(h_0, y) + \\epsilon h_1 \\frac{\\partial f}{\\partial x}\\bigg|_{(h_0,y)} + \\mathcal{O}(\\epsilon^2)\n$$\n$$\ng(h_0 + \\epsilon h_1 + \\dots, y) = g(h_0, y) + \\epsilon h_1 \\frac{\\partial g}{\\partial x}\\bigg|_{(h_0,y)} + \\mathcal{O}(\\epsilon^2)\n$$\n并且 $h(y,\\epsilon)$ 的导数为：\n$$\n\\frac{\\partial h}{\\partial y} = \\frac{d h_0}{d y} + \\epsilon \\frac{d h_1}{d y} + \\mathcal{O}(\\epsilon^2)\n$$\n将这些代入不变性条件：\n$$\nf(h_0, y) + \\epsilon h_1 \\frac{\\partial f}{\\partial x}\\bigg|_{x=h_0} + \\mathcal{O}(\\epsilon^2) = \\epsilon \\left( g(h_0, y) + \\mathcal{O}(\\epsilon) \\right) \\left( \\frac{d h_0}{d y} + \\mathcal{O}(\\epsilon) \\right)\n$$\n展开右侧并保留至 $\\epsilon$ 阶的项：\n$$\nf(h_0, y) + \\epsilon h_1 \\frac{\\partial f}{\\partial x}\\bigg|_{x=h_0} + \\mathcal{O}(\\epsilon^2) = \\epsilon \\, g(h_0, y) \\frac{d h_0}{d y} + \\mathcal{O}(\\epsilon^2)\n$$\n通过比较 $\\epsilon$ 的同次幂的系数，我们可以解出 $h_0$ 和 $h_1$。\n$\\mathcal{O}(\\epsilon^0)$ 阶项给出：\n$$\nf(h_0(y), y) = 0\n$$\n这就是临界流形的方程，我们已经解出 $h_0(y)=y$。\n\n$\\mathcal{O}(\\epsilon^1)$ 阶项给出：\n$$\nh_1(y) \\frac{\\partial f}{\\partial x}(h_0(y), y) = g(h_0(y), y) \\frac{d h_0(y)}{d y}\n$$\n现在我们利用已知的具体函数和 $h_0(y)$ 的结果来解这个关于 $h_1(y)$ 的方程。我们有：\n- $h_0(y) = y \\implies \\frac{d h_0}{d y} = 1$\n- $\\frac{\\partial f}{\\partial x}(h_0(y), y) = -1$\n- $g(h_0(y), y) = g(y,y) = y$ （因为 $g(x,y)=x$）\n\n将这些代入 $h_1(y)$ 的方程：\n$$\nh_1(y) \\cdot (-1) = y \\cdot 1\n$$\n$$\n-h_1(y) = y\n$$\n因此，一阶修正函数为：\n$$\nh_1(y) = -y\n$$\n问题要求图像函数对 $(h_0(y), h_\\epsilon(y))$。我们有 $h_0(y)=y$。慢流形 $M_\\epsilon$ 的一阶近似由图像函数 $h_\\epsilon(y) = h_0(y) + \\epsilon h_1(y)$ 给出。\n$$\nh_\\epsilon(y) = y + \\epsilon(-y) = y(1-\\epsilon)\n$$\n因此，所求的函数对为 $(y, y(1-\\epsilon))$。",
            "answer": "$$\n\\boxed{(y, y(1-\\epsilon))}\n$$"
        },
        {
            "introduction": "理论的价值最终体现在其应用与验证中。基于尺度分离的简化模型（如适应动力学）虽然强大，但终究是近似，其预测能力必须经过检验。本练习模拟了一个经典的生态-演化场景，要求您从一个简化的适应动力学模型中推导出入侵适应度预测，然后通过对完整系统的数值模拟来验证该预测，从而探索时间尺度分离假设在实践中的有效性与局限性。",
            "id": "4150148",
            "problem": "你必须编写一个完整的程序，用于在有限时间尺度分离的情况下，通过与完整的生态-演化系统的直接模拟进行对比，来验证一个简化的基于入侵的预测。在整个程序中，时间和密度均使用无量纲单位，并产生布尔值输出。该系统是一个捕食者-猎物模型，包含单一的猎物资源和一个捕食者，其性状通过权衡关系控制攻击率和死亡率。\n\n你的实现和推导必须从核心定义出发。使用人均增长率和生态平衡的定义，并将入侵适应度解释为稀有突变体在留居者的生态平衡环境中的初始人均增长率。不要假设任何预先推导出的简化方程；你必须从生态动力学中推导出入侵适应度和留居者平衡。\n\n定义资源（猎物）密度为 $R(t)$，以及两个捕食者亚种群：$N_x(t)$ 代表具有性状 $x$ 的留居者，$N_y(t)$ 代表具有性状 $y$ 的突变体。生态动力学如下：\n$$\n\\frac{dR}{dt} = r\\,R\\left(1-\\frac{R}{K}\\right) - a(x)\\,R\\,N_x - a(y)\\,R\\,N_y,\n$$\n$$\n\\frac{dN_x}{dt} = e\\,a(x)\\,R\\,N_x - m(x)\\,N_x,\n$$\n$$\n\\frac{dN_y}{dt} = e\\,a(y)\\,R\\,N_y - m(y)\\,N_y,\n$$\n其中 $r0$ 是猎物的内禀增长率，$K0$ 是猎物的环境承载力，$e\\in(0,1]$ 是捕食者的转化效率，$a(z)$ 是性状为 $z$ 时的攻击率，$m(z)$ 是性状为 $z$ 时的死亡率。使用以下权衡的具体形式：\n$$\na(z) = a_0 \\exp\\!\\left(-\\frac{(z-z_0)^2}{2\\,\\sigma_a^2}\\right), \\quad m(z) = m_0 + c\\,z^2,\n$$\n其中 $a_00$、$z_0\\in\\mathbb{R}$、$\\sigma_a0$、$m_00$ 和 $c0$ 是给定常数。\n\n根据单一留居者的生态平衡定义（设 $N_y=0$），仅有留居者的平衡必须满足：\n$$\n0 = r\\,R^*\\left(1-\\frac{R^*}{K}\\right) - a(x)\\,R^*\\,N_x^*, \\quad\n0 = e\\,a(x)\\,R^*\\,N_x^* - m(x)\\,N_x^*.\n$$\n假设 $N_x^*0$，使用第二个方程推导出留居者造成的资源平衡 $R^*(x)$，并计算突变体的入侵适应度 $f(y;x)$，其定义为具有性状 $y$ 的稀有突变体在留居者的平衡环境 $(R^*(x), N_x^*)$ 中的初始人均增长率：\n$$\nf(y;x) = e\\,a(y)\\,R^*(x) - m(y).\n$$\n待验证的简化预测是：若 $f(y;x)0$，突变体入侵（True）；若 $f(y;x)\\le 0$，突变体不入侵（False）。\n\n现在，将有限分离验证定义为一个两阶段模拟。阶段 1（留居者松弛）：在时间 $t=0$ 时，以 $R(0)=R_0$、$N_x(0)=N_{x,0}$ 和 $N_y(0)=0$ 进行初始化，并对仅有留居者的系统进行积分，直到 $t = \\tau$：\n$$\n\\frac{dR}{dt} = r\\,R\\left(1-\\frac{R}{K}\\right) - a(x)\\,R\\,N_x,\\quad\n\\frac{dN_x}{dt} = e\\,a(x)\\,R\\,N_x - m(x)\\,N_x.\n$$\n阶段 2（在有限分离下引入突变体）：在时间 $t=\\tau$ 时，引入一个稀有的突变体，其数量为 $N_y(\\tau)=N_{y,0}0$，并继续对完整的三维系统进行积分，直到 $t=\\tau+T_{\\text{end}}$。如果在时间 $t=\\tau+T_{\\text{end}}$ 时，突变体种群严格超过总捕食者密度的一半，则将入侵结果分类为 True，\n$$\n\\frac{N_y(\\tau+T_{\\text{end}})}{N_x(\\tau+T_{\\text{end}})+N_y(\\tau+T_{\\text{end}})}  \\frac{1}{2},\n$$\n否则分类为 False。\n\n你的程序必须为每个测试用例计算：\n1. 使用 $f(y;x)$ 的符号得出的简化预测布尔值，其中 $R^*(x)$ 是从仅有留居者的平衡定义中推导出来的。\n2. 使用上述两阶段积分得到的模拟结果布尔值。\n3. 一个最终的布尔值，表示简化预测与模拟结果之间的一致性。\n\n你必须对所有测试用例使用以下全局参数值：\n- $r=1.0$, $K=1.0$, $e=0.6$, $a_0=1.2$, $z_0=0.2$, $\\sigma_a=0.3$, $m_0=0.2$, $c=0.05$.\n\n使用以下测试套件，其中每个元组为 $(x, y, \\tau, R_0, N_{x,0}, N_{y,0}, T_{\\text{end}})$：\n- 用例 1（理想路径，接近准平衡）：$(0.1, 0.2, 20.0, 1.0, 1.0, 10^{-8}, 60.0)$\n- 用例 2（有害突变体，不应入侵）：$(0.2, 0.6, 10.0, 1.0, 1.0, 10^{-8}, 60.0)$\n- 用例 3（中性突变体，边界情况）：$(0.2, 0.2, 20.0, 1.0, 1.0, 10^{-8}, 60.0)$\n- 用例 4（有限分离压力测试，在资源耗尽情况下提早引入）：$(0.5, 0.2, 0.2, 1.0, 8.0, 10^{-8}, 60.0)$\n\n你的程序必须：\n- 仅使用留居者方程和定义来计算留居者平衡资源水平 $R^*(x)$。\n- 计算每个用例的入侵适应度 $f(y;x)$ 和简化预测布尔值。\n- 使用数值积分确定性地模拟两阶段系统，并计算每个用例的模拟结果布尔值。\n- 输出单行内容，包含一个布尔值列表，按给定顺序指示每个测试用例的简化预测与模拟结果之间的一致性。\n\n最终输出格式：你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如：\"[True,False,True,True]\"）。",
            "solution": "核心任务是通过与在有限时间尺度分离下的生态-演化动力学的直接数值模拟进行对比，来验证一个来自适应性动力学的理论预测。该预测是在无限时间尺度分离（即生态动力学相对于演化动力学无限快）的假设下推导出来的，它指出稀有突变体的命运由其入侵适应度决定。本次验证将测试当这一假设被放宽时，该预测的鲁棒性。\n\n首先，我们基于入侵适应度 $f(y;x)$ 推导简化预测。该系统包含一种资源 $R(t)$ 和两个捕食者种群：一个具有性状 $x$ 的留居者 $N_x(t)$ 和一个具有性状 $y$ 的突变体 $N_y(t)$。其动力学由一组常微分方程控制：\n$$\n\\frac{dR}{dt} = r\\,R\\left(1-\\frac{R}{K}\\right) - a(x)\\,R\\,N_x - a(y)\\,R\\,N_y,\n$$\n$$\n\\frac{dN_x}{dt} = \\left(e\\,a(x)\\,R - m(x)\\right)N_x,\n$$\n$$\n\\frac{dN_y}{dt} = \\left(e\\,a(y)\\,R - m(y)\\right)N_y.\n$$\n函数 $a(z)$ 和 $m(z)$ 分别定义了依赖于性状的攻击率和死亡率：\n$$\na(z) = a_0 \\exp\\!\\left(-\\frac{(z-z_0)^2}{2\\,\\sigma_a^2}\\right), \\quad m(z) = m_0 + c\\,z^2.\n$$\n适应性动力学预测基于仅有留居者的平衡，此时 $N_y=0$。通过将时间导数设为零，可以找到平衡状态 $(R^*, N_x^*)$：\n$$\n0 = r\\,R^*\\left(1-\\frac{R^*}{K}\\right) - a(x)\\,R^*\\,N_x^*,\n$$\n$$\n0 = \\left(e\\,a(x)\\,R^* - m(x)\\right)N_x^*.\n$$\n对于一个持续存在的捕食者种群，我们必须有 $N_x^*  0$。于是，第二个方程要求括号内的项为零，这给出了留居捕食者施加于环境的非平凡平衡资源水平 $R^*$。解出 $R^*$ 得：\n$$\ne\\,a(x)\\,R^* - m(x) = 0 \\implies R^*(x) = \\frac{m(x)}{e\\,a(x)}.\n$$\n这个 $R^*(x)$ 的表达式是基础。它代表了留居者的人均出生率和死亡率精确平衡时的资源水平。为使该平衡具有生物学意义，相应的捕食者密度 $N_x^*$ 必须为正。从第一个平衡方程中，我们发现 $N_x^* = \\frac{r}{a(x)}\\left(1 - \\frac{R^*(x)}{K}\\right)$，其为正当且仅当 $R^*(x)  K$。所提供的参数确保该条件对所有测试用例都成立。\n\n具有性状 $y$ 的稀有突变体的入侵适应度（记作 $f(y;x)$）被定义为它在留居者于其平衡点 $(R^*(x), N_x^*)$ 所设定的环境中的初始人均增长率。根据 $dN_y/dt$ 的方程，这便是：\n$$\nf(y;x) = \\left.\\frac{1}{N_y}\\frac{dN_y}{dt}\\right|_{N_y \\to 0, R=R^*(x)} = e\\,a(y)\\,R^*(x) - m(y).\n$$\n代入推导出的 $R^*(x)$ 表达式，我们得到用性状和权衡函数表示的适应度：\n$$\nf(y;x) = e\\,a(y)\\left(\\frac{m(x)}{e\\,a(x)}\\right) - m(y) = a(y)\\frac{m(x)}{a(x)} - m(y).\n$$\n简化预测是：如果突变体的适应度为正，即 $f(y;x)  0$，则它会入侵。否则，如果 $f(y;x) \\le 0$，则预测它不会入侵。\n\n接下来，我们设计直接模拟，以在有限尺度分离下验证此预测。该模拟分两个阶段进行，使用数值积分法求解控制常微分方程。\n阶段 1，留居者松弛阶段，从时间 $t=0$ 运行到 $t=\\tau$。我们对仅有留居者的系统动力学进行积分：\n$$\n\\frac{dR}{dt} = r\\,R\\left(1-\\frac{R}{K}\\right) - a(x)\\,R\\,N_x,\\quad \\frac{dN_x}{dt} = \\left(e\\,a(x)\\,R - m(x)\\right)N_x,\n$$\n从初始条件 $R(0)=R_0$ 和 $N_x(0)=N_{x,0}$ 开始。时间 $\\tau$ 代表突变发生前生态稳定的有限时期。\n阶段 2，突变体引入阶段，从 $t=\\tau$ 开始，运行到 $t=\\tau+T_{\\text{end}}$。一个小的突变体种群 $N_y(\\tau)=N_{y,0}$ 被引入系统。然后，模拟通过对完整的三维常微分方程系统进行积分来继续，其中 $R$ 和 $N_x$ 的初始条件取自它们在阶段 1 结束时的值，即 $R(\\tau)$ 和 $N_x(\\tau)$。\n模拟的结果在最终时间 $t_f = \\tau+T_{\\text{end}}$ 确定。如果突变体种群严格超过总捕食者密度的一半，则认为入侵成功（True）：\n$$\n\\frac{N_y(t_f)}{N_x(t_f)+N_y(t_f)}  \\frac{1}{2}.\n$$\n否则，结果为 False。\n\n实现将是一个 Python 程序，利用 `scipy.integrate.solve_ivp` 函数对常微分方程进行鲁棒的数值积分。对于每个测试用例，程序将首先通过评估 $f(y;x)$ 的符号来计算解析预测。然后，它将执行所描述的两阶段模拟。最后，它将比较来自预测的布尔结果与来自模拟的布尔结果，以确定它们是否一致。所有测试用例的这些一致性布尔值的列表构成了最终输出。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the problem of validating a reduced invasion-based prediction against\n    a direct simulation of a full eco-evolutionary system.\n    \"\"\"\n    \n    # Global parameter values for all test cases\n    r = 1.0\n    K = 1.0\n    e = 0.6\n    a0 = 1.2\n    z0 = 0.2\n    sigma_a = 0.3\n    m0 = 0.2\n    c = 0.05\n\n    def a(z):\n        \"\"\"Attack rate as a function of trait z.\"\"\"\n        return a0 * np.exp(-(z - z0)**2 / (2 * sigma_a**2))\n\n    def m(z):\n        \"\"\"Mortality rate as a function of trait z.\"\"\"\n        return m0 + c * z**2\n\n    def calculate_reduced_prediction(x, y):\n        \"\"\"\n        Calculates the invasion fitness f(y;x) and returns the reduced prediction.\n        Prediction is True if f(y;x)  0, False otherwise.\n        \"\"\"\n        # Resident equilibrium resource level derived from 0 = e*a(x)*R* - m(x)\n        R_star_x = m(x) / (e * a(x))\n        \n        # Invasion fitness of mutant y in resident x's environment\n        invasion_fitness = e * a(y) * R_star_x - m(y)\n        \n        return invasion_fitness  0\n\n    def run_simulation(x, y, tau, R0, Nx0, Ny0, Tend):\n        \"\"\"\n        Runs the two-stage simulation and determines the invasion outcome.\n        \"\"\"\n        # Stage 1: Resident relaxation (system with R and Nx only)\n        def resident_system(t, state):\n            R, Nx = state\n            a_x = a(x)\n            m_x = m(x)\n            dR_dt = r * R * (1 - R / K) - a_x * R * Nx\n            dNx_dt = e * a_x * R * Nx - m_x * Nx\n            return [dR_dt, dNx_dt]\n        \n        y0_stage1 = [R0, Nx0]\n        sol_stage1 = solve_ivp(\n            resident_system, \n            [0, tau], \n            y0_stage1,\n            method='RK45', \n            dense_output=True,\n            atol=1e-12,\n            rtol=1e-9\n        )\n        \n        R_at_tau, Nx_at_tau = sol_stage1.sol(tau)\n\n        # Stage 2: Mutant introduction and competition (full 3D system)\n        def full_system(t, state):\n            R, Nx, Ny = state\n            a_x, m_x = a(x), m(x)\n            a_y, m_y = a(y), m(y)\n            dR_dt = r * R * (1 - R / K) - a_x * R * Nx - a_y * R * Ny\n            dNx_dt = e * a_x * R * Nx - m_x * Nx\n            dNy_dt = e * a_y * R * Ny - m_y * Ny\n            return [dR_dt, dNx_dt, dNy_dt]\n\n        y0_stage2 = [R_at_tau, Nx_at_tau, Ny0]\n        t_final = tau + Tend\n        \n        sol_stage2 = solve_ivp(\n            full_system,\n            [tau, t_final],\n            y0_stage2,\n            method='RK45',\n            dense_output=True,\n            atol=1e-12,\n            rtol=1e-9\n        )\n        \n        _, Nx_final, Ny_final = sol_stage2.sol(t_final)\n        \n        total_predators = Nx_final + Ny_final\n        \n        if total_predators == 0:\n            return False\n        \n        # Invasion outcome criterion as per problem statement\n        return (Ny_final / total_predators)  0.5\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (x_resident, y_mutant, tau_relaxation, R_initial, Nx_initial, Ny_initial, T_simulation)\n        (0.1, 0.2, 20.0, 1.0, 1.0, 10**-8, 60.0),\n        (0.2, 0.6, 10.0, 1.0, 1.0, 10**-8, 60.0),\n        (0.2, 0.2, 20.0, 1.0, 1.0, 10**-8, 60.0),\n        (0.5, 0.2, 0.2, 1.0, 8.0, 10**-8, 60.0)\n    ]\n\n    agreement_results = []\n    \n    for case in test_cases:\n        x_res, y_mut, tau_relax, R_init, Nx_init, Ny_init, T_sim = case\n        \n        # 1. Compute the reduced prediction boolean\n        prediction = calculate_reduced_prediction(x_res, y_mut)\n        \n        # 2. Compute the simulation outcome boolean\n        simulation_outcome = run_simulation(x_res, y_mut, tau_relax, R_init, Nx_init, Ny_init, T_sim)\n        \n        # 3. Compute and store the agreement boolean\n        agreement_results.append(prediction == simulation_outcome)\n        \n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, agreement_results))}]\")\n\nsolve()\n```"
        }
    ]
}