{
    "hands_on_practices": [
        {
            "introduction": "第一个练习关注流行病学中最基本的问题之一：疫情爆发的引爆点在哪里？通过分析网络中“无病”状态的稳定性，你将推导出著名的“疫情阈值”。这个练习将巩固你对网络结构（特别是节点度）如何直接决定大范围传染可能性的理解 。",
            "id": "4137570",
            "problem": "考虑一个定义在具有$n$个节点和邻接矩阵$A \\in \\mathbb{R}^{n \\times n}$的简单、连通、无向网络上的连续时间易感-感染-易感（SIS）过程。每个节点要么是易感状态，要么是感染状态。一个感染节点以速率 $\\mu  0$ 恢复到易感状态，而一个易感节点因与每个感染邻居接触而以每个感染邻居 $\\beta  0$ 的速率被感染。令 $x_{i}(t) \\in [0,1]$ 表示节点 $i$ 在时间 $t$ 被感染的边缘概率，并采用标准的独立性近似，即联合感染状态可在邻居之间分解。在此近似下，节点级的平均场动力学方程为\n$$\n\\frac{d x_{i}}{d t} \\;=\\; -\\,\\mu\\, x_{i} \\;+\\; \\beta\\,\\big(1 - x_{i}\\big)\\,\\sum_{j=1}^{n} A_{i j}\\,x_{j}\\,,\n$$\n对于 $i = 1, \\dots, n$。定义有效感染参数 $\\tau \\equiv \\beta / \\mu$。\n\n使用动力系统的第一性原理和上述模型规范，根据 $A$ 的谱推导无病平衡点丧失线性稳定性的解析条件，并由此获得在一个每个节点度为 $k$ 的 $k$-正则图上临界值 $\\tau_{c}$ 的闭式表达式。请以 $k$ 的单个闭式表达式给出你的最终答案。\n\n最后，分析当 $n$ 增大时你的表达式的标度效应。用文字讨论当 $n$ 增加时 $k$ 固定不变的情况，以及 $k$ 随 $n$ 变化的情况。无需数值取整，答案不涉及物理单位。最终答案必须是单个符号表达式。",
            "solution": "该问题给出了网络上连续时间易感-感染-易感（SIS）过程的节点级平均场动力学。描述节点 $i$ 在时间 $t$ 被感染的概率 $x_i(t)$（其中 $i \\in \\{1, 2, \\dots, n\\}$）的微分方程组为：\n$$\n\\frac{d x_{i}}{d t} \\;=\\; f_i(\\mathbf{x}) \\;=\\; -\\,\\mu\\, x_{i} \\;+\\; \\beta\\,\\big(1 - x_{i}\\big)\\,\\sum_{j=1}^{n} A_{i j}\\,x_{j}\n$$\n其中 $\\mathbf{x} = (x_1, x_2, \\dots, x_n)^T$ 是感染概率的状态向量。参数包括恢复率 $\\mu  0$、感染率 $\\beta  0$，网络由其邻接矩阵 $A$ 定义。\n\n第一步是确定无病平衡点（DFE）。这是网络中没有感染的状态，因此所有节点都是易感的。在数学上，这对应于对所有 $i=1, \\dots, n$ 都有 $x_i = 0$。我们将此状态表示为向量 $\\mathbf{x}^* = \\mathbf{0}$。我们可以通过将其代入动力学方程来验证它是一个平衡点：\n$$\n\\frac{d x_{i}}{d t}\\bigg|_{\\mathbf{x}=\\mathbf{0}} \\;=\\; -\\,\\mu\\, (0) \\;+\\; \\beta\\,\\big(1 - 0\\big)\\,\\sum_{j=1}^{n} A_{i j}\\,(0) \\;=\\; 0\n$$\n由于对所有 $i$，时间导数都为零，因此 $\\mathbf{x}^* = \\mathbf{0}$ 确实是一个平衡点。\n\n为了确定该平衡点丧失线性稳定性的条件，我们分析系统在 $\\mathbf{x}^* = \\mathbf{0}$ 附近的微扰下的行为。这通过线性化系统来完成，需要计算向量场 $\\mathbf{f}(\\mathbf{x}) = (f_1(\\mathbf{x}), \\dots, f_n(\\mathbf{x}))^T$ 在无病平衡点处评估的雅可比矩阵 $J$。雅可比矩阵的元素由 $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}\\bigg|_{\\mathbf{x}=\\mathbf{x}^*}$ 给出。\n\n我们来计算 $f_i$ 的偏导数：\n$$\n\\frac{\\partial f_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\left( -\\,\\mu\\, x_{i} \\;+\\; \\beta\\,\\sum_{k=1}^{n} A_{i k}\\,x_{k} \\;-\\; \\beta\\,x_i\\,\\sum_{k=1}^{n} A_{i k}\\,x_{k} \\right)\n$$\n使用乘法法则和克罗内克δ函数 $\\delta_{ij}$ 的性质：\n$$\n\\frac{\\partial f_i}{\\partial x_j} = -\\mu \\delta_{ij} + \\beta A_{ij} - \\beta \\left( \\delta_{ij} \\sum_{k=1}^n A_{ik}x_k + x_i A_{ij} \\right)\n$$\n现在，我们在无病平衡点 $\\mathbf{x}^* = \\mathbf{0}$（即对所有 $k$ 都有 $x_k = 0$）处评估这些导数：\n$$\nJ_{ij} = \\frac{\\partial f_i}{\\partial x_j}\\bigg|_{\\mathbf{x}=\\mathbf{0}} = -\\mu \\delta_{ij} + \\beta A_{ij} - \\beta \\left( \\delta_{ij} \\sum_{k=1}^n A_{ik}(0) + (0) A_{ij} \\right) = \\beta A_{ij} - \\mu \\delta_{ij}\n$$\n以矩阵形式，无病平衡点处的雅可比矩阵为：\n$$\nJ = \\beta A - \\mu I\n$$\n其中 $I$ 是 $n \\times n$ 的单位矩阵。\n\n如果 $J$ 的所有特征值的实部都为负，则无病平衡点是线性稳定的。当具有最大实部的特征值变为非负时，它就失去稳定性。失去稳定性的临界条件是 $J$ 的任何特征值的最大实部恰好为零。\n\n$J$ 的特征值与邻接矩阵 $A$ 的特征值直接相关。设 $\\lambda_{A,k}$ 是 $A$ 的第 $k$ 个特征值，其对应的特征向量为 $\\mathbf{v}_k$。那么：\n$$\nJ \\mathbf{v}_k = (\\beta A - \\mu I) \\mathbf{v}_k = \\beta (A \\mathbf{v}_k) - \\mu (I \\mathbf{v}_k) = \\beta (\\lambda_{A,k} \\mathbf{v}_k) - \\mu \\mathbf{v}_k = (\\beta \\lambda_{A,k} - \\mu) \\mathbf{v}_k\n$$\n因此，$J$ 的特征值（记为 $\\lambda_{J,k}$）由 $\\lambda_{J,k} = \\beta \\lambda_{A,k} - \\mu$ 给出。问题中指出网络是简单且无向的，这意味着 $A$ 是一个实对称矩阵。因此，它的所有特征值 $\\lambda_{A,k}$ 都是实数。稳定性条件 $\\text{Re}(\\lambda_{J,k})  0$ 简化为 $\\lambda_{J,k}  0$。\n\n为了使无病平衡点稳定，我们需要对 $A$ 的所有特征值都有 $\\beta \\lambda_{A,k} - \\mu  0$。这等价于 $\\frac{\\beta}{\\mu} \\lambda_{A,k}  1$，或 $\\tau \\lambda_{A,k}  1$。这个条件必须对所有的 $k$ 都成立，因此它必须对 $A$ 的最大特征值（记为 $\\lambda_{A,\\text{max}}$）成立。因此，稳定性条件是 $\\tau \\lambda_{A,\\text{max}}  1$。\n\n当此条件被违反时，无病平衡点失去稳定性。临界阈值 $\\tau_c$ 是稳定性临界丧失时的 $\\tau$ 值，这发生在 $J$ 的最大特征值为零时：\n$$\n\\beta \\lambda_{A,\\text{max}} - \\mu = 0 \\implies \\frac{\\beta}{\\mu} \\lambda_{A,\\text{max}} = 1 \\implies \\tau_c \\lambda_{A,\\text{max}} = 1\n$$\n这给出了临界感染参数的一般解析条件：\n$$\n\\tau_c = \\frac{1}{\\lambda_{A,\\text{max}}}\n$$\n量 $\\lambda_{A,\\text{max}}$ 是邻接矩阵 $A$ 的谱半径。\n\n接下来，我们将此结果应用于一个 $k$-正则图。如果每个节点的度都为 $k$，则该图是 $k$-正则的。对于一个 $k$-正则图，邻接矩阵的每一行之和为 $k$。令 $\\mathbf{1}$ 为全1向量。那么 $(A\\mathbf{1})_i = \\sum_j A_{ij} = \\text{degree}(i) = k$。这意味着 $A\\mathbf{1} = k\\mathbf{1}$，这表明 $k$ 是 $A$ 的一个特征值，其特征向量为 $\\mathbf{1}$。\n\n由于图是连通的（给定条件），且 $A$ 是一个非负矩阵，根据佩龙-弗罗贝尼乌斯定理（Perron-Frobenius theorem），最大特征值是单重的、正的，并且其对应的特征向量所有分量都为正。因为 $k$ 是一个特征值，且其特征向量 $\\mathbf{1}$ 的所有分量都为正，所以它必定是最大特征值。因此，对于一个 $k$-正则图，$\\lambda_{A,\\text{max}} = k$。\n\n将此代入我们关于 $\\tau_c$ 的表达式，我们得到在 $k$-正则图上临界值的闭式表达式：\n$$\n\\tau_c = \\frac{1}{k}\n$$\n\n最后，我们分析当节点数 $n$ 增长时的标度效应。表达式 $\\tau_c = 1/k$ 只依赖于度 $k$，而不依赖于网络的大小 $n$。我们考虑两种情况：\n\n1.  当 $n \\to \\infty$ 时 $k$ 固定的情况：这描述了稀疏网络，例如格点或固定度的随机正则图。在这种情况下，临界阈值 $\\tau_c = 1/k$ 是一个不依赖于系统大小 $n$ 的常数。这意味着对于大型稀疏网络，存在一个有限的流行病阈值。只有当有效感染参数 $\\tau$ 超过常数值 $1/k$ 时，感染才能建立为地方病状态。\n\n2.  $k$ 随 $n$ 变化的情况：这描述了稠密网络。一个显著的例子是连接性随规模增长的网络，例如，$k$ 与 $n$ 成正比，如完全图，其中 $k = n-1$。如果 $k$ 是 $n$ 的一个增函数，那么当 $n \\to \\infty$ 时，$k \\to \\infty$。因此，临界阈值 $\\tau_c = 1/k$ 趋近于 $0$。这意味着对于大型稠密网络，系统对入侵极其脆弱。任何任意小但为正的传染性（即任何 $\\tau  0$）都足以在足够大的系统中引发流行病爆发。这一发现与经典均匀种群的质量作用模型一致，在这些模型中，当种群规模趋于无穷大时，流行病阈值会消失。",
            "answer": "$$\n\\boxed{\\frac{1}{k}}\n$$"
        },
        {
            "introduction": "在疫情阈值概念的基础上，我们的下一个练习将探讨现实世界中的缓解策略挑战。我们将比较两种常见的策略——疫苗接种（移除节点）和降低传播率（削弱连接），这两种策略在初始阶段被设定为具有相同的影响力。这个问题将揭示一个不那么直观的结论：相同的初始效果并不保证相同的最终结果，这展示了网络扩散复杂的非线性动力学特性 。",
            "id": "4137561",
            "problem": "考虑一个由 Erdős–Rényi (ER) 模型生成的大型的、稀疏的、局部树状的网络，其平均度为 $z$。一场流行病以易感-感染-恢复 (SIR) 过程传播，沿着每条边的传播是独立的：一次感染性接触以概率（传播率）$T$ 通过给定边传播感染，感染节点在有限的感染期后恢复并且不再传播。假设初始感染节点的比例极小，使得最终的流行病规模由一个可通过成功传播路径到达的宏观连接节点集的出现所决定。\n\n两种缓解策略分别应用于一个基线情景，其中 $z = 4$ 且 $T_0 = 0.4$：\n\n- 点渗透（疫苗接种）：在流行病发生前，比例为 $v = 0.25$ 的节点被均匀随机地接种疫苗，接种疫苗的节点既不传播也不接收感染。任何两个未接种疫苗节点之间的传播率保持为 $T_0$。\n- 边渗透（传播率降低）：没有节点接种疫苗，但每条边上的传播率降低到 $T_b$。为了对早期传播进行公平比较，选择 $T_b$ 使得在早期分支阶段，一个典型的新感染节点产生的平均成功传播次数与疫苗接种策略下的次数相匹配。\n\n在 ER 网络的标准树状近似和独立传播假设下，从第一性原理推导两种策略下的最终流行病规模。然后，根据您的推导，确定以下选项中对于给定参数值的正确量化比较。\n\nA. 在 $z=4$ 的 ER 网络上，通过边渗透将传播率降至 $T_b=0.3$ 时，最终流行病规模约为 $S_b \\approx 0.312$。在通过点渗透疫苗接种移除 $v=0.25$ 的节点并保持 $T_0=0.4$ 时，原始种群中被感染的总比例约为 $S_{\\text{site}} \\approx 0.234$，而未接种疫苗的子种群中被感染的比例约为 $0.312$。\n\nB. 如果 $z T_b = (1 - v) z T_0$，那么两种干预措施必然在整个种群中产生相同的最终流行病规模；对于给定的参数，两种情况下的最终流行病规模都约为 $0.312$。\n\nC. 在 $z=4$ 的 ER 网络上，通过边渗透将传播率降至 $T_b=0.3$ 时，最终流行病规模约为 $0.234$，而在通过点渗透疫苗接种移除 $v=0.25$ 的节点且 $T_0=0.4$ 时，最终流行病规模约为 $0.312$。\n\nD. 对于给定的参数，两种干预措施都使流行病处于亚临界状态，因此随着网络规模的增长，最终流行病规模趋于 $0$。",
            "solution": "用户需要对一个关于在 Erdős–Rényi (ER) 网络上，在两种不同缓解策略下 SIR 流行病问题进行批判性验证和求解。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   网络模型：大型、稀疏、局部树状的 Erdős–Rényi (ER) 网络。\n-   平均度：$z$。\n-   流行病模型：易感-感染-恢复 (SIR)。\n-   传播概率（传播率）：$T$ 每条边，每次感染性接触。\n-   初始条件：初始感染节点的比例极小。\n-   基线情景参数：平均度 $z = 4$，传播率 $T_0 = 0.4$。\n-   策略 1（点渗透）：比例为 $v = 0.25$ 的节点被随机接种疫苗（移除）。剩余节点间的传播率为 $T_0$。\n-   策略 2（边渗透）：所有边上的传播率降低到 $T_b$。\n-   公平比较条件：在早期阶段，一个典型的新感染节点产生的平均成功传播次数（基本再生数）在两种策略下是相同的。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据**：该问题在复杂自适应系统理论，特别是网络流行病学中有充分的依据。SIR 模型、ER 网络、稀疏随机图的树状近似，以及通过点渗透和边渗透对干预措施进行建模，都是该领域的标准和基本概念。它没有违反任何科学原理。\n2.  **良定性**：该问题在数学上是良定的。最终流行病规模是一个明确定义的量，可以通过从第一性原理推导出的自洽方程计算得出。“公平比较”条件提供了一个明确的约束来确定参数 $T_b$。给定的参数足以找到唯一解。\n3.  **客观性**：该问题使用来自数学和物理学的精确、客观和标准的术语进行陈述。没有主观或模棱两可的陈述。\n\n**步骤 3：结论和行动**\n\n问题陈述是有效的。这是一个网络理论流行病学中的标准、良定问题。可以进行求解过程。\n\n### 推导与求解\n\n网络上 SIR 流行病的最终规模可以使用渗透框架来确定。最终被感染的节点集对应于一个图中的连通分量，该图包含初始种子节点，其中每条边以概率 $T$ “开放”（传播感染）。对于一个大型、稀疏的 ER 网络（近似为一个具有平均度为 $z$ 的泊松度分布的配置模型网络），我们可以推导出最终流行病规模的自洽方程。\n\n令 $S$ 为流行病结束时被感染的人口比例。令 $u$ 为沿着一条随机边到达的节点*未*被其任何其他邻居通过流行病感染的概率。由于其树状结构，我们可以将沿不同分支的感染事件视为独立的。\n\n一个度为 $k$ 的节点避免感染的充要条件是它的 $k$ 个邻居中没有一个将感染传播给它。一个给定邻居成功感染该节点的概率是 $T \\times (1-u)$，其中 $T$ 是传播率，$(1-u)$ 是该邻居最终从其自身其他连接被感染的概率。因此，一个给定邻居*未能*感染该节点的概率是 $1 - T(1-u)$。对于一个度为 $k$ 的节点，保持未被感染的概率是 $(1 - T(1-u))^k$。\n\n一个随机选择的节点保持未被感染的概率 $1-S$，是通过对泊松度分布 $P(k) = e^{-z} z^k / k!$ 进行平均得到的：\n$$1-S = \\sum_{k=0}^{\\infty} P(k) (1 - T(1-u))^k = \\sum_{k=0}^{\\infty} \\frac{e^{-z} z^k}{k!} (1 - T(1-u))^k$$\n$$1-S = e^{-z} \\sum_{k=0}^{\\infty} \\frac{[z(1-T(1-u))]^k}{k!} = e^{-z} e^{z(1-T(1-u))} = e^{-zT(1-u)}$$\n\n现在，我们需要一个关于 $u$ 的方程。一个位于随机边末端的节点，如果其所有其他邻居都未能感染它，那么它就不会从这些邻居（相对于该边）处被感染。对于一个 ER 图，通过遍历一条边找到的节点的“其他”邻居数量也遵循平均值为 $z$ 的泊松分布。因此，$u$ 的自洽方程在结构上与 $1-S$ 的方程相同：\n$$u = \\sum_{k'=0}^{\\infty} P(k') (1 - T(1-u))^{k'} = e^{-zT(1-u)}$$\n其中 $k'$ 是其他邻居的数量。\n\n结合这两个结果，我们发现 $1-S = u$。将此代入 $u$ 的方程，得到众所周知的最终流行病规模 $S$ 的自洽方程：\n$$1 - S = e^{-zTS}$$\n当基本再生数 $R_0 = zT > 1$ 时，会发生最终规模非零的流行病。\n\n**策略 1：点渗透（疫苗接种）**\n\n比例为 $v = 0.25$ 的节点被移除。流行病在由未接种疫苗节点组成的剩余子网络上传播，该子网络占原始种群的比例为 $1-v = 0.75$。\n-   由未接种疫苗节点组成的新网络也是一个 ER 网络。该网络中的一个节点在原始网络中有 $z$ 个潜在邻居，但这些邻居中的每一个都以概率 $1-v$ 留在新网络中。\n-   该子网络的有效平均度为 $z' = z(1-v) = 4(1-0.25) = 3$。\n-   传播率保持为 $T_0 = 0.4$。\n-   *在未接种疫苗的子种群内*传播的基本再生数为 $R'_{0, \\text{site}} = z' T_0 = 3 \\times 0.4 = 1.2$。\n-   由于 $R'_{0, \\text{site}} > 1$，流行病会发生。令 $S'_{\\text{site}}$ 为*未接种疫苗的子种群*中被感染的比例。它满足使用参数 $z'$ 和 $T_0$ 的最终规模方程：\n$$1 - S'_{\\text{site}} = e^{-z' T_0 S'_{\\text{site}}} = e^{-1.2 S'_{\\text{site}}}$$\n我们数值求解此方程以得到 $S'_{\\text{site}}$。令 $f(x) = 1 - x - e^{-1.2x}$。在 $x \\in (0, 1)$ 范围内存在一个非平凡根。使用选项 A 中的 $x = 0.312$：\n$f(0.312) = 1 - 0.312 - e^{-1.2 \\times 0.312} = 0.688 - e^{-0.3744} \\approx 0.688 - 0.6877 = 0.0003$。这个值非常接近于零，所以 $S'_{\\text{site}} \\approx 0.312$。这是未接种疫苗的子种群中被感染的比例。\n\n*原始*种群中被感染的总比例 $S_{\\text{site}}$，是这个比例乘以未接种疫苗节点的比例：\n$$S_{\\text{site}} = (1-v) S'_{\\text{site}} = 0.75 \\times 0.312 = 0.234$$\n\n**策略 2：边渗透（传播率降低）**\n\n在这里，网络结构不变（$z = 4$），但传播率降低到 $T_b$。\n-   “公平比较”条件要求基本再生数与点渗透情况下的相同。\n-   边渗透的基本再生数为 $R_{0, \\text{bond}} = z T_b$。\n-   条件为 $R_{0, \\text{bond}} = R'_{0, \\text{site}}$。\n$$z T_b = z(1-v)T_0$$\n$$4 \\times T_b = 1.2 \\implies T_b = \\frac{1.2}{4} = 0.3$$\n这证实了选项中提供的值。\n\n-   最终流行病规模 $S_b$ 是被感染的总人口比例。它满足使用参数 $z$ 和 $T_b$ 的最终规模方程：\n$$1 - S_b = e^{-z T_b S_b} = e^{-4 \\times 0.3 \\times S_b} = e^{-1.2 S_b}$$\n-   这与 $S'_{\\text{site}}$ 所满足的超越方程完全相同。因此，$S_b = S'_{\\text{site}}$。\n$$S_b \\approx 0.312$$\n\n**结果总结：**\n-   点渗透：未接种疫苗者中感染比例，$S'_{\\text{site}} \\approx 0.312$。总感染比例，$S_{\\text{site}} = (1-v)S'_{\\text{site}} \\approx 0.234$。\n-   边渗透：总感染比例，$S_b \\approx 0.312$。\n\n### 逐项分析选项\n\n**A. 在 $z=4$ 的 ER 网络上，通过边渗透将传播率降至 $T_b=0.3$ 时，最终流行病规模约为 $S_b \\approx 0.312$。在通过点渗透疫苗接种移除 $v=0.25$ 的节点并保持 $T_0=0.4$ 时，原始种群中被感染的总比例约为 $S_{\\text{site}} \\approx 0.234$，而未接种疫苗的子种群中被感染的比例约为 $0.312$。**\n-   该陈述声称 $S_b \\approx 0.312$。我们的计算得出 $S_b \\approx 0.312$。这是正确的。\n-   该陈述声称在点渗透下，总感染比例为 $S_{\\text{site}} \\approx 0.234$。我们的计算得出 $S_{\\text{site}} = 0.234$。这是正确的。\n-   该陈述声称未接种疫苗子种群的感染比例约为 $0.312$。我们的计算得出 $S'_{\\text{site}} \\approx 0.312$。这是正确的。\n-   **结论：正确。**\n\n**B. 如果 $z T_b = (1 - v) z T_0$，那么两种干预措施必然在整个种群中产生相同的最终流行病规模；对于给定的参数，两种情况下的最终流行病规模都约为 $0.312$。**\n-   该选项声称 $S_b = S_{\\text{site}}$。我们的计算显示 $S_b \\approx 0.312$ 而 $S_{\\text{site}} \\approx 0.234$。这两个值不相等。条件 $z T_b = (1 - v) z T_0$ 使再生数相等，这意味着 $S_b$（边渗透下的最终规模）等于 $S'_{\\text{site}}$（点渗透下*未接种疫苗子种群*中的最终规模）。然而，点渗透下的总最终规模是 $S_{\\text{site}} = (1-v)S'_{\\text{site}}$，对于 $v>0$，这个值严格小于 $S_b$。\n-   **结论：不正确。**\n\n**C. 在 $z=4$ 的 ER 网络上，通过边渗透将传播率降至 $T_b=0.3$ 时，最终流行病规模约为 $0.234$，而在通过点渗透疫苗接种移除 $v=0.25$ 的节点且 $T_0=0.4$ 时，最终流行病规模约为 $0.312$。**\n-   与我们的结果相比，该选项交换了两种策略的最终规模。它声称 $S_b \\approx 0.234$ 而 $S_{\\text{site}} \\approx 0.312$。我们的推导显示了相反的结果：$S_b \\approx 0.312$ 而 $S_{\\text{site}} \\approx 0.234$。\n-   **结论：不正确。**\n\n**D. 对于给定的参数，两种干预措施都使流行病处于亚临界状态，因此随着网络规模的增长，最终流行病规模趋于 $0$。**\n-   如果基本再生数 $R_0  1$，则流行病是亚临界的。\n-   对于点渗透，有效再生数是 $R'_{0, \\text{site}} = 1.2$。\n-   对于边渗透，有效再生数是 $R_{0, \\text{bond}} = 1.2$。\n-   由于两个再生数都大于 1，两种情况都是超临界的，导致最终规模 $S > 0$ 的宏观流行病。\n-   **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "我们的最后一个练习将从预测转向推断，这是现代流行病学和数据科学中的一项关键任务。如果只知道最终的感染者集合，我们能否重建出最可能的传染路径？这个编程练习要求你实现一个算法来估算感染树，通过解决疫情溯源问题，在理论模型和实际数据分析之间架起一座桥梁 。",
            "id": "4137589",
            "problem": "给定一个节点标签为非负整数的有限、简单、无向图，以及一个单一传染过程最终观测到的感染节点集。假设传染遵循独立级联模型（IC），其中每个受感染的节点会尝试沿着每条出边传播感染恰好一次，每次尝试以一个共同的传播率 $T \\in (0,1)$（以小数形式表示）独立成功。您无法观测到感染时间或源节点的身份；您只能观测到最终的感染集。目标是仅根据观测到的最终感染集和传播率 $T$，在最大后验（MAP）推断的类置信传播近似下，估计一个最可能的无向感染树。\n\n基本原理：\n- 独立级联（IC）过程：每个受感染的节点会尝试对其每个易感邻居进行恰好一次感染，每次尝试以概率 $T$ 独立成功。一旦一个节点被感染，它将保持感染状态并继续尝试感染其易感邻居。最终的感染集是从源节点通过至少一个成功传播序列可达的所有节点的集合。\n- 边渗流映射：在具有恒定传播率 $T$ 的IC过程中，最终的感染部分可以看作是在一个随机子图中包含源节点的连通分量，该随机子图是通过以概率 $T$ 独立保留每条边而获得的。\n- 置信传播（BP）近似：一种在因子图上的消息传递方法，用于近似边缘分布，并可以特化为最大乘积形式来估计最可能的分配。\n\n您的任务是实现一个类置信传播算法，该算法估计一个恰好连接所有观测到的最终感染节点的无向感染树。在由感染集诱导的子图的多个无向生成树在BP近似下概率相等的情况下，通过选择字典序最小的边集来确定性地决胜。其中，边表示为有序对 $(u,v)$ 且 $u  v$。\n\n如果观测到的感染集在原始图中不是连通的，则不可能存在单个感染树；在这种情况下，您的函数应返回一个空列表。\n\n输入：\n- `graph_edges`: 一个边的列表，每个边是一个元组 `(u, v)`，表示图 $G$ 中的一条无向边。\n- `infected_set_nodes`: 一个整数列表，表示最终被感染的节点集 $S$。\n- `transmissibility`: 浮点数 $T$，表示传播概率。\n\n输出：\n- 一个元组的列表，表示所选感染树的边，按字典序排序。如果无法形成树，则返回空列表。",
            "solution": "该问题要求在给定最终感染节点集 $S$ 的情况下，为一个图上的单一传染过程估计最可能的无向感染树。传染过程由具有统一传播率 $T$ 的独立级联（IC）模型建模。\n\n首先，对问题陈述进行验证。给定条件是：一个无向图 $G=(V,E)$，一个感染集 $S \\subseteq V$，以及一个传播率 $T \\in (0,1)$。目标是找到感染树的最大后验（MAP）估计，该树必须是 $S$ 诱导子图的一棵生成树。问题指出，这应通过一种“类置信传播近似”方法来完成。同时指定了一个确定性的字典序决胜规则。该问题在科学上基于已建立的网络扩散理论（IC模型、边渗流），由于决胜规则的存在，其输入清晰、输出唯一定义，因此问题是良构且客观陈述的。关键短语“类置信传播近似”被解释为对一个关键简化的理由。\n\n具有恒定传播率 $T$ 的IC模型等价于图 $G$ 上的一个边渗流过程，其中每条边都以概率 $T$ 独立实现。感染从一个源节点传播到其在所产生的随机子图中所处连通分量内的所有节点。我们观测到最终的感染集 $S$，并被要求找到连接它们的最可能的树结构。\n\n问题在于找到由 $S$ 诱导的子图（我们称之为 $G_S = (S, E_S)$）的一棵生成树 $H = (S, E_H)$，以最大化后验概率。直接计算特定传染路径的概率是复杂的。问题中的“近似”简化了这一点。$E_S$ 内已实现（激活）和未实现（未激活）边的特定配置的概率是各条边概率的乘积。对于一个边集为 $E' \\subseteq E_S$ 的特定子图作为精确的渗流结果，其概率是 $P(E') = T^{|E'|} (1-T)^{|E_S| - |E'|}$。\n\n我们的任务是找到一棵生成*树* $H = (S,E_H)$。对于任何这样的树，边的数量是固定的，为 $|E_H| = |S|-1$。如果我们用“恰好 $H$ 的边被激活，而 $E_S$ 中所有其他边都未激活”的概率来近似感染路径是特定树 $H$ 的概率，那么这个概率是：\n$$ P(E_H) = T^{|S|-1} (1-T)^{|E_S| - (|S|-1)} $$\n对于诱导子图 $G_S$ 的*所有*可能的生成树，这个值都是恒定的。因此，在这种近似下，$G_S$ 的所有生成树都是等概率的。MAP估计不是唯一的，选择完全依赖于指定的决胜规则。\n\n决胜规则要求选择其边集在字典序上最小的树。边集是一个边元组 $(u,v)$（其中 $u  v$）的集合。这个选择标准直接指向了克鲁斯卡尔算法（Kruskal's algorithm）的一个变体。克鲁斯卡尔算法通过迭代地添加权重最小且不形成环路的边来构建最小生成树。在这里，“权重”就是边的字典序。\n\n算法步骤如下：\n1. 识别由感染集 $S$ 诱导的子图 $G_S$。其边 $E_S$ 是原始图 $G$ 中两个端点都在 $S$ 内的所有边。\n2. 检查 $G_S$ 是否连通。如果不是，则无法形成连接所有节点的生成树，应返回一个空列表。这可以通过在 $G_S$ 上运行广度优先搜索（BFS）或深度优先搜索（DFS）来检查。\n3. 如果 $G_S$ 是连通的，将其所有边 $E_S$ 按字典序排序。\n4. 使用克鲁斯卡尔算法构建树：\n   a. 初始化一个空边集 $E_{tree}$ 用于我们的树。\n   b. 初始化一个并查集（Disjoint Set Union, DSU）数据结构，其中每个节点在 $S$ 中都位于其自己的集合中。\n   c. 遍历排序后的边列表 $E_S$ 中的每条边 $(u,v)$。\n   d. 如果 $u$ 和 $v$ 尚未在同一集合中（通过 DSU 的 `find` 操作检查），则将该边添加到 $E_{tree}$，并在 DSU 中合并 $u$ 和 $v$ 的集合（使用 `union` 操作）。\n   e. 当 $E_{tree}$ 中有 $|S|-1$ 条边时停止。\n5. 返回最终的边集 $E_{tree}$。\n\n这种方法保证了我们选择的是连接 $S$ 中所有节点的无向树，并且由于我们按字典序处理边，我们得到的将是字典序最小的这样一棵树，符合决胜规则。注意，传播率 $T$ 在这种近似下最终不影响树的选择，因为它对所有生成树的概率贡献是相同的。",
            "answer": "```python\nimport numpy as np\n\n# Note: numpy and scipy are specified as available but are not strictly necessary \n# for this particular problem, which can be solved with standard Python data structures.\n# They are included here to adhere to the environment specification.\n\nclass DSU:\n    \"\"\"\n    A Disjoint Set Union (DSU) data structure with path compression.\n    \"\"\"\n    def __init__(self, nodes):\n        \"\"\"\n        Initializes the DSU, with each node in its own set.\n        Args:\n            nodes (iterable): The initial set of nodes.\n        \"\"\"\n        self.parent = {node: node for node in nodes}\n\n    def find(self, i):\n        \"\"\"\n        Finds the representative of the set containing node i, with path compression.\n        \"\"\"\n        if self.parent[i] == i:\n            return i\n        self.parent[i] = self.find(self.parent[i])\n        return self.parent[i]\n\n    def union(self, i, j):\n        \"\"\"\n        Merges the sets containing nodes i and j.\n        Returns:\n            bool: True if the sets were merged, False if they were already the same.\n        \"\"\"\n        root_i = self.find(i)\n        root_j = self.find(j)\n        if root_i != root_j:\n            self.parent[root_j] = root_i\n            return True\n        return False\n\ndef find_map_tree(graph_edges, infected_set_nodes, transmissibility):\n    \"\"\"\n    Estimates the most probable undirected infection tree based on the problem specification.\n\n    Args:\n        graph_edges (list of tuples): The edge list of the graph G.\n        infected_set_nodes (list of int): The list of observed infected nodes S.\n        transmissibility (float): The contagion transmissibility T (not used in final logic).\n\n    Returns:\n        list of tuples: A sorted list of edge tuples for the estimated tree, or an empty list.\n    \"\"\"\n    infected_set = set(infected_set_nodes)\n    \n    # If the infected set has 0 or 1 nodes, the infection tree has no edges.\n    if len(infected_set) = 1:\n        return []\n\n    # 1. Construct the subgraph induced by the infected set S.\n    # Normalize edges to (u,v) with u  v and filter for those within S.\n    induced_subgraph_edges = []\n    for u, v in graph_edges:\n        if u in infected_set and v in infected_set:\n            if u > v:\n                u, v = v, u\n            induced_subgraph_edges.append((u, v))\n    \n    # 2. Sort the edges lexicographically, as required by the tie-breaking rule.\n    induced_subgraph_edges.sort()\n    \n    # 3. Use Kruskal's algorithm to find the Minimum Spanning Tree, which, due to\n    # the sorting, will be the lexicographically smallest one.\n    dsu = DSU(infected_set)\n    map_tree_edges = []\n    num_edges = 0\n    \n    for u, v in induced_subgraph_edges:\n        if dsu.union(u, v):\n            map_tree_edges.append((u, v))\n            num_edges += 1\n            # Stop when we have a spanning tree\n            if num_edges == len(infected_set) - 1:\n                break\n    \n    # 4. Check for connectivity. If we couldn't form a spanning tree, return empty list.\n    if num_edges != len(infected_set) - 1:\n        return []\n    \n    return map_tree_edges\n```"
        }
    ]
}