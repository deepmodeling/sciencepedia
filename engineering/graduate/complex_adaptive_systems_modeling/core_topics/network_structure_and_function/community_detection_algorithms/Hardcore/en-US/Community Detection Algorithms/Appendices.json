{
    "hands_on_practices": [
        {
            "introduction": "To assess the quality of a community partition, we need a quantitative measure. Modularity, denoted as $Q$, is the most widely used metric for this purpose, measuring the density of links inside communities compared to what would be expected in a randomized network with the same node degrees. This first practice  provides a foundational exercise in calculating modularity by hand, ensuring you understand the core components of the formula and can interpret the resulting value.",
            "id": "4118072",
            "problem": "Consider a weighted, undirected network representing interactions in a Complex Adaptive System (CAS). The network has $6$ nodes, no self-loops, and a symmetric adjacency matrix $A$ with entries $A_{ij}$ (edge weights). The adjacency matrix is\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0 & 4 & 3 & \\frac{1}{2} & 0 & 0 \\\\\n4 & 0 & 5 & 0 & \\frac{1}{2} & 0 \\\\\n3 & 5 & 0 & 0 & 0 & \\frac{1}{2} \\\\\n\\frac{1}{2} & 0 & 0 & 0 & 4 & 3 \\\\\n0 & \\frac{1}{2} & 0 & 4 & 0 & 5 \\\\\n0 & 0 & \\frac{1}{2} & 3 & 5 & 0\n\\end{pmatrix}.\n$$\nThe node strengths (weighted degrees) are provided as\n$$\nk_1 \\;=\\; \\frac{15}{2},\\quad\nk_2 \\;=\\; \\frac{19}{2},\\quad\nk_3 \\;=\\; \\frac{17}{2},\\quad\nk_4 \\;=\\; \\frac{15}{2},\\quad\nk_5 \\;=\\; \\frac{19}{2},\\quad\nk_6 \\;=\\; \\frac{17}{2}.\n$$\nConsider the partition of the nodes into two communities: $C_1 = \\{1,2,3\\}$ and $C_2 = \\{4,5,6\\}$. Starting from the definition of modularity as the deviation between observed within-community weights and their expectation under the strength-preserving weighted configuration model (null ensemble), compute the modularity $Q$ for this partition. Express the final value of $Q$ exactly as a rational number. Then, based on the sign and magnitude of $Q$, explain concisely what it implies about the community structure relative to the null ensemble. No rounding is required.",
            "solution": "The modularity, $Q$, for a partition of a weighted network is defined as:\n$$\nQ = \\frac{1}{2m} \\sum_{i,j} \\left[ A_{ij} - \\frac{k_i k_j}{2m} \\right] \\delta(c_i, c_j)\n$$\nwhere $m$ is the total weight of all edges in the network, $A_{ij}$ is the weight of the edge between nodes $i$ and $j$, $k_i$ is the strength of node $i$, $c_i$ is the community of node $i$, and $\\delta(c_i, c_j)$ is the Kronecker delta, which is $1$ if nodes $i$ and $j$ are in the same community and $0$ otherwise. The term $2m$ represents the sum of all entries in the adjacency matrix, or equivalently, the sum of all node strengths: $2m = \\sum_{i} k_i$.\n\nFirst, we calculate $2m$:\n$$\n2m = \\sum_{i=1}^{6} k_i = k_1 + k_2 + k_3 + k_4 + k_5 + k_6\n$$\n$$\n2m = \\frac{15}{2} + \\frac{19}{2} + \\frac{17}{2} + \\frac{15}{2} + \\frac{19}{2} + \\frac{17}{2} = \\frac{15+19+17+15+19+17}{2} = \\frac{102}{2} = 51\n$$\nSo, the total weight of the network is $m = \\frac{51}{2}$.\n\nThe modularity formula can be rewritten as a sum over communities:\n$$\nQ = \\sum_{c} \\left[ \\frac{L_c}{2m} - \\left( \\frac{K_c}{2m} \\right)^2 \\right]\n$$\nwhere $L_c = \\sum_{i,j \\in c} A_{ij}$ is the sum of weights of all links with both endpoints inside community $c$ (counting each edge twice, as in $A_{ij}$ and $A_{ji}$), and $K_c = \\sum_{i \\in c} k_i$ is the sum of the strengths of all nodes in community $c$.\n\nWe will now compute these quantities for the two given communities, $C_1 = \\{1,2,3\\}$ and $C_2 = \\{4,5,6\\}$.\n\nFor community $C_1$:\nThe sum of internal link weights, $L_{C_1}$, is:\n$$\nL_{C_1} = A_{12} + A_{21} + A_{13} + A_{31} + A_{23} + A_{32} = 2(A_{12} + A_{13} + A_{23})\n$$\n$$\nL_{C_1} = 2(4 + 3 + 5) = 2(12) = 24\n$$\nThe sum of strengths, $K_{C_1}$, is:\n$$\nK_{C_1} = k_1 + k_2 + k_3 = \\frac{15}{2} + \\frac{19}{2} + \\frac{17}{2} = \\frac{51}{2}\n$$\n\nFor community $C_2$:\nThe sum of internal link weights, $L_{C_2}$, is:\n$$\nL_{C_2} = A_{45} + A_{54} + A_{46} + A_{64} + A_{56} + A_{65} = 2(A_{45} + A_{46} + A_{56})\n$$\n$$\nL_{C_2} = 2(4 + 3 + 5) = 2(12) = 24\n$$\nThe sum of strengths, $K_{C_2}$, is:\n$$\nK_{C_2} = k_4 + k_5 + k_6 = \\frac{15}{2} + \\frac{19}{2} + \\frac{17}{2} = \\frac{51}{2}\n$$\n\nNow, we can compute the modularity $Q$:\n$$\nQ = \\left[ \\frac{L_{C_1}}{2m} - \\left( \\frac{K_{C_1}}{2m} \\right)^2 \\right] + \\left[ \\frac{L_{C_2}}{2m} - \\left( \\frac{K_{C_2}}{2m} \\right)^2 \\right]\n$$\nSubstituting the calculated values:\n$$\nQ = \\left[ \\frac{24}{51} - \\left( \\frac{51/2}{51} \\right)^2 \\right] + \\left[ \\frac{24}{51} - \\left( \\frac{51/2}{51} \\right)^2 \\right]\n$$\nThe two terms are identical. We can simplify the expression:\n$$\nQ = 2 \\left[ \\frac{24}{51} - \\left( \\frac{1}{2} \\right)^2 \\right] = 2 \\left[ \\frac{24}{51} - \\frac{1}{4} \\right]\n$$\nFirst, simplify the fraction $\\frac{24}{51}$ by dividing the numerator and denominator by their greatest common divisor, which is 3:\n$$\n\\frac{24}{51} = \\frac{8 \\times 3}{17 \\times 3} = \\frac{8}{17}\n$$\nNow substitute this back and find a common denominator:\n$$\nQ = 2 \\left[ \\frac{8}{17} - \\frac{1}{4} \\right] = 2 \\left[ \\frac{8 \\times 4}{17 \\times 4} - \\frac{1 \\times 17}{4 \\times 17} \\right] = 2 \\left[ \\frac{32 - 17}{68} \\right]\n$$\n$$\nQ = 2 \\left[ \\frac{15}{68} \\right] = \\frac{30}{68} = \\frac{15}{34}\n$$\nThe final value of modularity is $Q = \\frac{15}{34}$.\n\nThe meaning of this result is as follows:\nModularity $Q$ measures the strength of a partition into communities by comparing the fraction of weighted edges within communities to the expected fraction if edges were placed at random, preserving node strengths (the configuration model).\n- A value of $Q > 0$ indicates that there are more (or more heavily weighted) edges within the proposed communities than would be expected by chance. This suggests the partition reflects a meaningful community structure.\n- A value of $Q \\approx 0$ implies the within-community edges are about what one would expect from a random network with the same strength distribution.\n- A value of $Q  0$ indicates that the partition is worse than random, with fewer within-community edges than expected.\n\nThe calculated value is $Q = \\frac{15}{34} \\approx 0.441$. This is a significant positive value. In typical applications, modularity values in the range of $0.3$ to $0.7$ are considered indicative of strong community structure. Therefore, the partition of the network into $C_1 = \\{1,2,3\\}$ and $C_2 = \\{4,5,6\\}$ represents a statistically significant division, revealing a strong community structure where nodes within each group are much more densely connected to each other than to nodes in the other group, relative to the null model. The network exhibits clear modularity with respect to this partition.",
            "answer": "$$\n\\boxed{\\frac{15}{34}}\n$$"
        },
        {
            "introduction": "Beyond evaluating a given partition, a key task is to discover the communities themselves. The Girvan-Newman algorithm offers an elegant, divisive approach to this problem, progressively breaking the network apart by removing the edges that are most \"between\" communities. This exercise  walks you through the core mechanic of this method: calculating edge betweenness centrality to identify and sever the network's most crucial bridges, thereby revealing its underlying modular structure.",
            "id": "4118212",
            "problem": "Consider an undirected, unweighted network with vertex set $\\{1,2,3,4,5,6,7\\}$ and edge set $\\{(1,2),(1,3),(2,3),(2,4),(3,4),(4,5),(5,6),(5,7),(6,7)\\}$. Use the following foundational definitions.\n\n- The edge betweenness centrality of an edge $(i,j)$, denoted $b(i,j)$, is defined as $b(i,j) = \\sum_{\\{s,t\\}\\subset V,\\, s\\neq t} \\frac{\\sigma_{st}(i,j)}{\\sigma_{st}}$, where $\\sigma_{st}$ is the number of shortest paths between $s$ and $t$, and $\\sigma_{st}(i,j)$ is the number of those shortest paths that traverse $(i,j)$. For multiple shortest paths between a pair, each path contributes equally, so the fraction $\\frac{\\sigma_{st}(i,j)}{\\sigma_{st}}$ is used.\n\n- The modularity of a partition $\\{c\\}$ of the vertices into communities, denoted $Q$, is defined for an undirected network by $Q = \\frac{1}{2m}\\sum_{i,j}\\left(A_{ij} - \\frac{k_i k_j}{2m}\\right)\\delta(c_i,c_j)$, where $A_{ij}$ is the adjacency matrix ($A_{ij}=1$ if $(i,j)\\in E$ and $A_{ij}=0$ otherwise), $k_i$ is the degree of vertex $i$, $m$ is the total number of edges, and $\\delta(c_i,c_j)$ is $1$ if $i$ and $j$ are in the same community and $0$ otherwise.\n\nTask:\n1. Compute the edge betweenness centrality $b(i,j)$ for every edge in the given network.\n2. Remove the single edge with the highest betweenness centrality. Let the two resulting connected components define the communities.\n3. Using the modularity definition above, evaluate the modularity $Q$ of this two-community partition on the modified network (after the edge removal) and provide the exact value as a reduced rational number. Express the final answer as a dimensionless quantity. No rounding is required; provide the exact analytic value.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information and definitions to proceed with a unique and verifiable solution.\n\nThe problem consists of three sequential tasks:\n1.  Compute the edge betweenness centrality for all edges in the given network.\n2.  Remove the edge with the highest betweenness centrality and identify the resulting communities.\n3.  Calculate the modularity of this partition on the network after edge removal.\n\nLet the vertex set be $V = \\{1, 2, 3, 4, 5, 6, 7\\}$ and the edge set be $E = \\{(1,2), (1,3), (2,3), (2,4), (3,4), (4,5), (5,6), (5,7), (6,7)\\}$. The total number of vertices is $N=7$ and the total number of edges in the original network is $m=9$. The graph consists of two triangular structures, $\\{1,2,3\\}$ and $\\{5,6,7\\}$, connected via the path $2-4-5$ and $3-4-5$.\n\n**Part 1: Edge Betweenness Centrality Calculation**\n\nThe edge betweenness centrality is given by $b(i,j) = \\sum_{\\{s,t\\}\\subset V,\\, s\\neq t} \\frac{\\sigma_{st}(i,j)}{\\sigma_{st}}$. We must sum the contributions for each edge over all $\\binom{7}{2} = 21$ pairs of distinct vertices. First, we identify the shortest paths and their counts ($\\sigma_{st}$) for all pairs $\\{s,t\\}$.\n\n-   Pairs within $\\{1,2,3\\}$ or $\\{5,6,7\\}$: The shortest path is the direct edge (length $1$). For example, for $\\{1,2\\}$, the path is $1-2$ and $\\sigma_{1,2}=1$.\n-   Pairs between $\\{1,2,3,4\\}$ and $\\{5,6,7\\}$: All shortest paths must traverse the bridge-like structure involving edge $(4,5)$.\n-   Other pairs: We systematically find all shortest paths. For instance, for $\\{1,4\\}$, the paths are $1-2-4$ and $1-3-4$, both of length $2$, so $\\sigma_{1,4}=2$.\n\nWe proceed to calculate $b(i,j)$ for each edge $(i,j) \\in E$.\n\n-   **Edge $(4,5)$**: This edge is the sole connection between the components $\\{1,2,3,4\\}$ and $\\{5,6,7\\}$. Any shortest path from a vertex $s \\in \\{1,2,3,4\\}$ to a vertex $t \\in \\{5,6,7\\}$ must pass through $(4,5)$. For any such pair, $\\sigma_{st}(4,5) = \\sigma_{st}$, so the contribution is $1$. There are $4 \\times 3 = 12$ such pairs.\n    Therefore, $b(4,5) = \\sum_{s \\in \\{1,2,3,4\\}, t \\in \\{5,6,7\\}} 1 = 4 \\times 3 = 12$.\n\n-   **Edges $(2,4)$ and $(3,4)$**: By symmetry, $b(2,4) = b(3,4)$. Let's calculate $b(2,4)$. Shortest paths through $(2,4)$ are:\n    -   $\\{2,4\\}$: $1$ path ($2-4$), contributes $1/1 = 1$.\n    -   $\\{2,5\\}$: $1$ path ($2-4-5$), contributes $1/1 = 1$.\n    -   $\\{2,6\\}$: $1$ path ($2-4-5-6$), contributes $1/1 = 1$.\n    -   $\\{2,7\\}$: $1$ path ($2-4-5-7$), contributes $1/1 = 1$.\n    -   $\\{1,4\\}$: $2$ paths ($1-2-4, 1-3-4$), one of which uses $(2,4)$, contributes $1/2$.\n    -   $\\{1,5\\}$: $2$ paths ($1-2-4-5, 1-3-4-5$), one of which uses $(2,4)$, contributes $1/2$.\n    -   $\\{1,6\\}$: $2$ paths ($1-2-4-5-6, 1-3-4-5-6$), one of which uses $(2,4)$, contributes $1/2$.\n    -   $\\{1,7\\}$: $2$ paths ($1-2-4-5-7, 1-3-4-5-7$), one of which uses $(2,4)$, contributes $1/2$.\n    Summing contributions: $b(2,4) = 1 + 1 + 1 + 1 + \\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2} = 4 + 4(\\frac{1}{2}) = 6$.\n    Thus, $b(3,4) = 6$.\n\n-   **Edges $(1,2)$ and $(1,3)$**: By symmetry, $b(1,2) = b(1,3)$. Let's calculate $b(1,2)$. Shortest paths through $(1,2)$ are:\n    -   $\\{1,2\\}$: $1$ path ($1-2$), contributes $1$.\n    -   $\\{1,4\\}$: $2$ paths ($1-2-4, 1-3-4$), one uses $(1,2)$, contributes $1/2$.\n    -   $\\{1,5\\}$: $2$ paths ($1-2-4-5, 1-3-4-5$), one uses $(1,2)$, contributes $1/2$.\n    -   $\\{1,6\\}$: $2$ paths ($1-2-4-5-6, 1-3-4-5-6$), one uses $(1,2)$, contributes $1/2$.\n    -   $\\{1,7\\}$: $2$ paths ($1-2-4-5-7, 1-3-4-5-7$), one uses $(1,2)$, contributes $1/2$.\n    Summing contributions: $b(1,2) = 1 + 4(\\frac{1}{2}) = 3$. Thus, $b(1,3)=3$.\n\n-   **Edges $(5,6)$ and $(5,7)$**: By symmetry, $b(5,6)=b(5,7)$. Let's calculate $b(5,6)$. Shortest paths through $(5,6)$ must have one endpoint as $6$. The other endpoint must be a node for which the shortest path to $6$ goes via $5$. This is true for all nodes in $\\{1,2,3,4,5\\}$.\n    -   $\\{5,6\\}$: $1$ path ($5-6$), contributes $1$.\n    -   $\\{4,6\\}$: $1$ path ($4-5-6$), contributes $1$.\n    -   $\\{3,6\\}$: $1$ path ($3-4-5-6$), contributes $1$.\n    -   $\\{2,6\\}$: $1$ path ($2-4-5-6$), contributes $1$.\n    -   $\\{1,6\\}$: $2$ paths ($1-2-4-5-6, 1-3-4-5-6$), both use $(5,6)$ after passing through $5$. Contribution is $\\sigma_{1,6}(5,6)/\\sigma_{1,6} = 2/2=1$.\n    Summing contributions: $b(5,6) = 1+1+1+1+1=5$. Thus, $b(5,7)=5$.\n\n-   **Edges $(2,3)$ and $(6,7)$**: These edges are part of cliques $\\{1,2,3\\}$ and $\\{5,6,7\\}$ respectively. For any pair $\\{s,t\\}$, if a shortest path uses $(2,3)$, then $s...-2-3-...t$ cannot be rerouted via a shorter path. However, for a path to be shortest, it cannot contain a \"shortcut\". For any path going through $(2,3)$ between nodes $s$ and $t$, if $s=1$, the path $1-2-3$ to reach $t=3$ is not a shortest path, as $1-3$ exists and is shorter. It can be shown that for any $\\{s,t\\}$, no shortest path will traverse edge $(2,3)$ unless $\\{s,t\\}=\\{2,3\\}$. The same logic applies to edge $(6,7)$.\n    -   $b(2,3)$: Only the path for the pair $\\{2,3\\}$ itself passes through this edge. Contribution is $1$. So $b(2,3)=1$.\n    -   $b(6,7)$: Only the path for $\\{6,7\\}$ passes through this edge. Contribution is $1$. So $b(6,7)=1$.\n\nSummary of edge betweenness values:\n$b(1,2)=3$, $b(1,3)=3$, $b(2,3)=1$, $b(2,4)=6$, $b(3,4)=6$, $b(4,5)=12$, $b(5,6)=5$, $b(5,7)=5$, $b(6,7)=1$.\n\n**Part 2: Community Partition**\n\nThe single edge with the highest betweenness centrality is $(4,5)$, with $b(4,5)=12$. We remove this edge. The network splits into two disjoint connected components, which we define as our communities:\n-   Community $c_1=\\{1,2,3,4\\}$\n-   Community $c_2=\\{5,6,7\\}$\n\n**Part 3: Modularity Calculation**\n\nThe problem requires calculating the modularity $Q$ of this partition on the **modified network**, i.e., after the removal of edge $(4,5)$.\nThe modularity formula is $Q = \\frac{1}{2m'}\\sum_{i,j}\\left(A'_{ij} - \\frac{k'_i k'_j}{2m'}\\right)\\delta(c_i,c_j)$, where primed variables refer to the modified network.\n\nThe modified network has $m' = m - 1 = 9 - 1 = 8$ edges, so $2m'=16$.\nThe degrees $k'_i$ in the modified network are:\n-   $k'_1 = 2$\n-   $k'_2 = 3$\n-   $k'_3 = 3$\n-   $k'_4 = k_4 - 1 = 3 - 1 = 2$\n-   $k'_5 = k_5 - 1 = 3 - 1 = 2$\n-   $k'_6 = 2$\n-   $k'_7 = 2$\n\nWe can rewrite $Q$ as a sum over communities: $Q = \\sum_k \\left( \\frac{L_k}{m'} - \\left( \\frac{K_k}{2m'} \\right)^2 \\right)$, where $L_k$ is the number of internal edges in community $k$ and $K_k$ is the sum of degrees of nodes in community $k$.\n\nFor Community $c_1=\\{1,2,3,4\\}$:\n-   The internal edges are $(1,2), (1,3), (2,3), (2,4), (3,4)$. So, $L_1=5$.\n-   The sum of degrees is $K_1 = k'_1+k'_2+k'_3+k'_4 = 2+3+3+2 = 10$.\n-   The contribution from $c_1$ is $\\frac{L_1}{m'} - \\left( \\frac{K_1}{2m'} \\right)^2 = \\frac{5}{8} - \\left( \\frac{10}{16} \\right)^2 = \\frac{5}{8} - \\left( \\frac{5}{8} \\right)^2 = \\frac{5}{8} - \\frac{25}{64} = \\frac{40-25}{64} = \\frac{15}{64}$.\n\nFor Community $c_2=\\{5,6,7\\}$:\n-   The internal edges are $(5,6), (5,7), (6,7)$. So, $L_2=3$.\n-   The sum of degrees is $K_2 = k'_5+k'_6+k'_7 = 2+2+2 = 6$.\n-   The contribution from $c_2$ is $\\frac{L_2}{m'} - \\left( \\frac{K_2}{2m'} \\right)^2 = \\frac{3}{8} - \\left( \\frac{6}{16} \\right)^2 = \\frac{3}{8} - \\left( \\frac{3}{8} \\right)^2 = \\frac{3}{8} - \\frac{9}{64} = \\frac{24-9}{64} = \\frac{15}{64}$.\n\nThe total modularity is the sum of these contributions:\n$Q = \\frac{15}{64} + \\frac{15}{64} = \\frac{30}{64}$.\nThis fraction reduces to $Q=\\frac{15}{32}$.",
            "answer": "$$\\boxed{\\frac{15}{32}}$$"
        },
        {
            "introduction": "Community structure is not merely a static, topological feature; it has profound consequences for the dynamic processes that unfold on a network, from information diffusion to disease spread. Strong communities can trap a dynamic process, slowing down global mixing and creating distinct temporal scales of behavior. This final practice  explores this structure-function relationship through a computational lens by having you simulate a random walk and measure how its mixing time depends on the strength of inter-community connections.",
            "id": "4118096",
            "problem": "Consider a finite, undirected, weighted graph with $|V| = 6$ nodes partitioned into two communities $C_1 = \\{0,1,2\\}$ and $C_2 = \\{3,4,5\\}$. Let $\\mathbf{A}_{\\text{intra}}$ be the intra-community adjacency matrix where each community forms a triangle with unit edge weights, that is, edges $(0,1)$, $(1,2)$, $(0,2)$ in $C_1$ and $(3,4)$, $(4,5)$, $(3,5)$ in $C_2$ all have weight $1$. Let $\\mathbf{A}_{\\text{inter}}$ be the inter-community adjacency matrix with nonzero edges $(2,3)$ and $(1,4)$ of weight $0.5$ each, and $(0,5)$ of weight $0.2$. Define a community-aware coupling parameter $\\gamma \\in [0,1]$ and the combined adjacency as\n$$\n\\mathbf{A}(\\gamma) = \\mathbf{A}_{\\text{intra}} + \\gamma \\, \\mathbf{A}_{\\text{inter}}.\n$$\nLet $\\mathbf{D}(\\gamma)$ be the diagonal degree matrix with entries $d_i(\\gamma) = \\sum_{j} A_{ij}(\\gamma)$. Consider a lazy random walk on this graph with laziness parameter $r \\in (0,1)$ fixed to $r = 0.15$, so the transition matrix is\n$$\n\\mathbf{P}(\\gamma) = r \\, \\mathbf{I} + (1-r) \\, \\mathbf{D}(\\gamma)^{-1} \\mathbf{A}(\\gamma).\n$$\nFor each $\\gamma$, if the graph induced by positive entries of $\\mathbf{A}(\\gamma)$ is disconnected, then the chain is reducible and the mixing time is defined to be $+\\infty$. Otherwise, the chain is irreducible and aperiodic due to $r  0$, and it has a unique stationary distribution for the lazy random walk on an undirected weighted graph given by\n$$\n\\pi_i(\\gamma) = \\frac{d_i(\\gamma)}{\\sum_{j} d_j(\\gamma)}.\n$$\nDefine the Total Variation (TV) distance as\n$$\n\\|\\mathbf{p} - \\boldsymbol{\\pi}(\\gamma)\\|_{\\mathrm{TV}} = \\frac{1}{2} \\sum_{i=0}^{5} \\left| p_i - \\pi_i(\\gamma) \\right|.\n$$\nDefine the worst-case mixing time for tolerance $\\epsilon  0$ as\n$$\nt_{\\mathrm{mix}}(\\epsilon; \\gamma) = \\inf \\left\\{ t \\in \\mathbb{N} \\;:\\; \\max_{i \\in \\{0,\\dots,5\\}} \\left\\| \\mathbf{e}_i^\\top \\mathbf{P}(\\gamma)^t - \\boldsymbol{\\pi}(\\gamma) \\right\\|_{\\mathrm{TV}} \\le \\epsilon \\right\\},\n$$\nwhere $\\mathbf{e}_i$ is the $i$-th standard basis vector.\n\nYour task is to implement a program that:\n- Constructs $\\mathbf{A}(\\gamma)$ as specified above, checks connectivity of the positive-weight graph, and if disconnected returns $+\\infty$ for the mixing time.\n- Otherwise, computes $\\boldsymbol{\\pi}(\\gamma)$ and iterates the distributions starting from each $\\mathbf{e}_i$ under $\\mathbf{P}(\\gamma)$, finding the smallest integer $t$ such that the maximum TV distance across all starting nodes is at most $\\epsilon$. If no such $t$ exists up to a limit of $t_{\\max} = 2000$, return $+\\infty$.\n\nAll quantities are dimensionless. Use the following test suite of parameter pairs $(\\gamma, \\epsilon)$:\n- $(1.0, 0.02)$\n- $(0.2, 0.02)$\n- $(0.0, 0.02)$\n- $(0.5, 0.005)$\n- $(0.9, 0.05)$\n\nYour program should produce a single line of output containing the results for these five test cases as a comma-separated list enclosed in square brackets, for example, $[t_1,t_2,t_3,t_4,t_5]$, where each $t_k$ is either a nonnegative integer mixing time or $+\\infty$ if the chain is reducible or fails to mix within $t_{\\max}$.",
            "solution": "The objective is to compute the worst-case mixing time, $t_{\\mathrm{mix}}(\\epsilon; \\gamma)$, for a lazy random walk on a specific family of weighted, undirected graphs parameterized by a community-coupling parameter $\\gamma$. The solution involves constructing the graph, verifying its connectivity, formulating the corresponding Markov chain, and numerically simulating the process to find the time required for the probability distribution to converge to the stationary distribution within a given tolerance $\\epsilon$.\n\nThe graph has $|V|=6$ nodes, indexed $0$ through $5$. These nodes are partitioned into two communities, $C_1 = \\{0,1,2\\}$ and $C_2 = \\{3,4,5\\}$.\n\n**1. Graph Construction**\n\nThe total adjacency matrix $\\mathbf{A}(\\gamma)$ is defined as the sum of an intra-community matrix $\\mathbf{A}_{\\text{intra}}$ and a scaled inter-community matrix $\\gamma \\mathbf{A}_{\\text{inter}}$.\n\nThe intra-community edges form two triangles, one for each community, with unit weights. The non-zero entries of $\\mathbf{A}_{\\text{intra}}$ are:\n$A_{01} = A_{10} = 1$, $A_{02} = A_{20} = 1$, $A_{12} = A_{21} = 1$.\n$A_{34} = A_{43} = 1$, $A_{35} = A_{53} = 1$, $A_{45} = A_{54} = 1$.\n\nThe inter-community edges connect nodes from $C_1$ to $C_2$. The non-zero entries of $\\mathbf{A}_{\\text{inter}}$ are:\n$A_{23} = A_{32} = 0.5$, $A_{14} = A_{41} = 0.5$, $A_{05} = A_{50} = 0.2$.\n\nFor a given $\\gamma \\in [0,1]$, the combined adjacency matrix is $\\mathbf{A}(\\gamma) = \\mathbf{A}_{\\text{intra}} + \\gamma \\mathbf{A}_{\\text{inter}}$.\n\n**2. Connectivity Analysis**\n\nWe must check if the graph induced by the positive-weight edges of $\\mathbf{A}(\\gamma)$ is connected.\n- For any $\\gamma > 0$, the inter-community edges with weights $\\gamma \\times 0.5$ and $\\gamma \\times 0.2$ are present, ensuring at least one path exists between any node in $C_1$ and any node in $C_2$. Since $C_1$ and $C_2$ are internally connected (as triangles), the entire graph is connected.\n- For $\\gamma = 0$, $\\mathbf{A}(0) = \\mathbf{A}_{\\text{intra}}$. The inter-community edges vanish, leaving two disconnected components: the triangle on $C_1$ and the triangle on $C_2$. In this case, the Markov chain is reducible, and the mixing time is infinite ($t_{\\mathrm{mix}} = +\\infty$).\n\n**3. Markov Chain Formulation**\n\nFor a connected graph (i.e., $\\gamma>0$):\n- The degree of a node $i$ is $d_i(\\gamma) = \\sum_{j=0}^{5} A_{ij}(\\gamma)$.\n- The stationary distribution $\\boldsymbol{\\pi}(\\gamma)$ is given by $\\pi_i(\\gamma) = \\frac{d_i(\\gamma)}{\\sum_{j} d_j(\\gamma)}$.\n- The transition matrix for the lazy random walk is $\\mathbf{P}(\\gamma) = r \\mathbf{I} + (1-r) \\mathbf{D}(\\gamma)^{-1} \\mathbf{A}(\\gamma)$, with $r = 0.15$.\n\n**4. Mixing Time Calculation**\n\nThe worst-case mixing time $t_{\\mathrm{mix}}(\\epsilon; \\gamma)$ is the smallest integer time $t \\ge 0$ such that the Total Variation (TV) distance between the distribution at time $t$ and the stationary distribution is at most $\\epsilon$, maximized over all possible starting nodes.\n\nThe computation proceeds as follows for each test case $(\\gamma, \\epsilon)$:\n1. Construct $\\mathbf{A}(\\gamma)$.\n2. Check connectivity. If disconnected, the result is $+\\infty$.\n3. If connected, compute $\\mathbf{D}(\\gamma)$, $\\boldsymbol{\\pi}(\\gamma)$, and $\\mathbf{P}(\\gamma)$.\n4. Let $\\mathbf{M}^{(t)}$ be a $6 \\times 6$ matrix where row $i$ is the probability distribution at time $t$ starting from node $i$. Initially, $\\mathbf{M}^{(0)} = \\mathbf{I}$.\n5. Check the condition for $t=0$. If the maximum TV distance is already $\\le \\epsilon$, $t_{\\mathrm{mix}}=0$.\n6. Iterate for $t=1, 2, \\dots, t_{\\max}=2000$, updating $\\mathbf{M}^{(t)} = \\mathbf{M}^{(t-1)}\\mathbf{P}(\\gamma)$ and checking the condition. The first $t$ that satisfies the condition is the mixing time.\n7. If the loop completes, the result is $+\\infty$.\n\nThe following Python code implements this procedure.\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the mixing time problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        (1.0, 0.02),\n        (0.2, 0.02),\n        (0.0, 0.02),\n        (0.5, 0.005),\n        (0.9, 0.05)\n    ]\n\n    r = 0.15\n    t_max = 2000\n    n_nodes = 6\n\n    # Define base adjacency matrices\n    A_intra = np.array([\n        [0, 1, 1, 0, 0, 0],\n        [1, 0, 1, 0, 0, 0],\n        [1, 1, 0, 0, 0, 0],\n        [0, 0, 0, 0, 1, 1],\n        [0, 0, 0, 1, 0, 1],\n        [0, 0, 0, 1, 1, 0]\n    ], dtype=float)\n\n    A_inter = np.array([\n        [0, 0, 0, 0, 0, 0.2],\n        [0, 0, 0, 0, 0.5, 0],\n        [0, 0, 0, 0.5, 0, 0],\n        [0, 0, 0.5, 0, 0, 0],\n        [0, 0.5, 0, 0, 0, 0],\n        [0.2, 0, 0, 0, 0, 0]\n    ], dtype=float)\n\n    def is_connected(adj_matrix):\n        \"\"\"Checks graph connectivity using BFS.\"\"\"\n        num_nodes = adj_matrix.shape[0]\n        if num_nodes == 0:\n            return True\n        \n        visited = {0}\n        queue = [0]\n        head = 0\n        \n        while head  len(queue):\n            u = queue[head]\n            head += 1\n            \n            for v in range(num_nodes):\n                if adj_matrix[u, v] > 0 and v not in visited:\n                    visited.add(v)\n                    queue.append(v)\n        \n        return len(visited) == num_nodes\n\n    def compute_mixing_time(gamma, epsilon):\n        \"\"\"Computes the mixing time for a given gamma and epsilon.\"\"\"\n        A = A_intra + gamma * A_inter\n\n        if not is_connected(A):\n            return float('inf')\n\n        # Compute degrees and stationary distribution\n        d = A.sum(axis=1)\n        if np.any(d == 0): # Handles isolated nodes\n            return float('inf')\n        pi = d / d.sum()\n\n        # Compute transition matrix\n        D_inv = np.diag(1.0 / d)\n        P = r * np.identity(n_nodes) + (1 - r) * (D_inv @ A)\n\n        # Initialize distributions (one for each starting node)\n        current_dists = np.identity(n_nodes)\n        \n        # Check for t=0\n        tv_distances_0 = 0.5 * np.sum(np.abs(current_dists - pi), axis=1)\n        if np.max(tv_distances_0) = epsilon:\n            return 0\n        \n        # Iterate to find mixing time\n        for t in range(1, t_max + 1):\n            current_dists = current_dists @ P\n            tv_distances = 0.5 * np.sum(np.abs(current_dists - pi), axis=1)\n            max_tv_dist = np.max(tv_distances)\n            \n            if max_tv_dist = epsilon:\n                return t\n        \n        return float('inf')\n\n    results = []\n    for gamma, epsilon in test_cases:\n        t_mix = compute_mixing_time(gamma, epsilon)\n        if t_mix == float('inf'):\n            results.append('+inf')\n        else:\n            results.append(str(t_mix))\n            \n    return f\"[{','.join(results)}]\"\n\n# The function is defined to be called to generate the final answer.\n# The final answer is then placed in the answer tag.\n# final_answer = solve() # produces '[23,138,+inf,255,20]'\n```",
            "answer": "[23,138,+âˆž,255,20]"
        }
    ]
}