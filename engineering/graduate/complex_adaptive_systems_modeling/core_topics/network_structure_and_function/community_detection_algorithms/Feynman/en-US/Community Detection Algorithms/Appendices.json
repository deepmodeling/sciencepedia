{
    "hands_on_practices": [
        {
            "introduction": "To evaluate the quality of a network partition, we need a quantitative measure. Modularity, denoted by $Q$, is a widely used metric that quantifies the strength of a division by comparing the fraction of edges within communities to the expected fraction in a randomized network with the same node strengths. This practice  provides a direct computational exercise in applying the modularity formula to a given partition, helping to build a concrete understanding of what this crucial objective function represents.",
            "id": "4118072",
            "problem": "Consider a weighted, undirected network representing interactions in a Complex Adaptive System (CAS). The network has $6$ nodes, no self-loops, and a symmetric adjacency matrix $A$ with entries $A_{ij}$ (edge weights). The adjacency matrix is\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0 & 4 & 3 & \\frac{1}{2} & 0 & 0 \\\\\n4 & 0 & 5 & 0 & \\frac{1}{2} & 0 \\\\\n3 & 5 & 0 & 0 & 0 & \\frac{1}{2} \\\\\n\\frac{1}{2} & 0 & 0 & 0 & 4 & 3 \\\\\n0 & \\frac{1}{2} & 0 & 4 & 0 & 5 \\\\\n0 & 0 & \\frac{1}{2} & 3 & 5 & 0\n\\end{pmatrix}.\n$$\nThe node strengths (weighted degrees) are provided as\n$$\nk_1 \\;=\\; \\frac{15}{2},\\quad\nk_2 \\;=\\; \\frac{19}{2},\\quad\nk_3 \\;=\\; \\frac{17}{2},\\quad\nk_4 \\;=\\; \\frac{15}{2},\\quad\nk_5 \\;=\\; \\frac{19}{2},\\quad\nk_6 \\;=\\; \\frac{17}{2}.\n$$\nConsider the partition of the nodes into two communities: $C_1 = \\{1,2,3\\}$ and $C_2 = \\{4,5,6\\}$. Starting from the definition of modularity as the deviation between observed within-community weights and their expectation under the strength-preserving weighted configuration model (null ensemble), compute the modularity $Q$ for this partition. Express the final value of $Q$ exactly as a rational number. Then, based on the sign and magnitude of $Q$, explain concisely what it implies about the community structure relative to the null ensemble. No rounding is required.",
            "solution": "The problem is first subjected to validation.\n\n### Step 1: Extract Givens\n- Network is weighted, undirected, with $N=6$ nodes and no self-loops.\n- Adjacency matrix:\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0 & 4 & 3 & \\frac{1}{2} & 0 & 0 \\\\\n4 & 0 & 5 & 0 & \\frac{1}{2} & 0 \\\\\n3 & 5 & 0 & 0 & 0 & \\frac{1}{2} \\\\\n\\frac{1}{2} & 0 & 0 & 0 & 4 & 3 \\\\\n0 & \\frac{1}{2} & 0 & 4 & 0 & 5 \\\\\n0 & 0 & \\frac{1}{2} & 3 & 5 & 0\n\\end{pmatrix}\n$$\n- Node strengths (weighted degrees):\n$$\nk_1 = \\frac{15}{2}, k_2 = \\frac{19}{2}, k_3 = \\frac{17}{2}, k_4 = \\frac{15}{2}, k_5 = \\frac{19}{2}, k_6 = \\frac{17}{2}\n$$\n- Partition into two communities: $C_1 = \\{1,2,3\\}$ and $C_2 = \\{4,5,6\\}$.\n- Task: Compute the modularity $Q$ for this partition and explain its meaning.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in the theory of complex networks, specifically concerning community detection. The concepts of adjacency matrix, node strength, and modularity are standard in this field.\n- **Well-Posed**: All necessary information is provided to calculate the modularity for the given partition. The objective is clearly stated.\n- **Consistency Check**: A critical validation step is to ensure the provided node strengths $k_i$ are consistent with the adjacency matrix $A$. The strength of a node $i$ is defined as $k_i = \\sum_{j=1}^{N} A_{ij}$.\n- For node $1$: $k_1 = A_{12} + A_{13} + A_{14} + A_{15} + A_{16} = 4 + 3 + \\frac{1}{2} + 0 + 0 = \\frac{15}{2}$. This matches the given value.\n- For node $2$: $k_2 = A_{21} + A_{23} + A_{24} + A_{25} + A_{26} = 4 + 5 + 0 + \\frac{1}{2} + 0 = \\frac{19}{2}$. This matches.\n- For node $3$: $k_3 = A_{31} + A_{32} + A_{34} + A_{35} + A_{36} = 3 + 5 + 0 + 0 + \\frac{1}{2} = \\frac{17}{2}$. This matches.\n- For node $4$: $k_4 = A_{41} + A_{42} + A_{43} + A_{45} + A_{46} = \\frac{1}{2} + 0 + 0 + 4 + 3 = \\frac{15}{2}$. This matches.\n- For node $5$: $k_5 = A_{51} + A_{52} + A_{53} + A_{54} + A_{56} = 0 + \\frac{1}{2} + 0 + 4 + 5 = \\frac{19}{2}$. This matches.\n- For node $6$: $k_6 = A_{61} + A_{62} + A_{63} + A_{64} + A_{65} = 0 + 0 + \\frac{1}{2} + 3 + 5 = \\frac{17}{2}$. This matches.\nThe adjacency matrix is symmetric as stated ($A_{ij} = A_{ji}$), and has zeros on the diagonal ($A_{ii}=0$), consistent with an undirected network with no self-loops. The provided data is self-contained, consistent, and scientifically sound.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be computed.\n\nThe modularity, $Q$, for a partition of a weighted network is defined as:\n$$\nQ = \\frac{1}{2m} \\sum_{i,j} \\left[ A_{ij} - \\frac{k_i k_j}{2m} \\right] \\delta(c_i, c_j)\n$$\nwhere $m$ is the total weight of all edges in the network, $A_{ij}$ is the weight of the edge between nodes $i$ and $j$, $k_i$ is the strength of node $i$, $c_i$ is the community of node $i$, and $\\delta(c_i, c_j)$ is the Kronecker delta, which is $1$ if nodes $i$ and $j$ are in the same community and $0$ otherwise. The term $2m$ represents the sum of all entries in the adjacency matrix, or equivalently, the sum of all node strengths: $2m = \\sum_{i} k_i$.\n\nFirst, we calculate $2m$:\n$$\n2m = \\sum_{i=1}^{6} k_i = k_1 + k_2 + k_3 + k_4 + k_5 + k_6\n$$\n$$\n2m = \\frac{15}{2} + \\frac{19}{2} + \\frac{17}{2} + \\frac{15}{2} + \\frac{19}{2} + \\frac{17}{2} = \\frac{15+19+17+15+19+17}{2} = \\frac{102}{2} = 51\n$$\nSo, the total weight of the network is $m = \\frac{51}{2}$.\n\nThe modularity formula can be rewritten as a sum over communities:\n$$\nQ = \\sum_{c} \\left[ \\frac{L_c}{2m} - \\left( \\frac{K_c}{2m} \\right)^2 \\right]\n$$\nwhere $L_c = \\sum_{i,j \\in c} A_{ij}$ is the sum of weights of all links with both endpoints inside community $c$, and $K_c = \\sum_{i \\in c} k_i$ is the sum of the strengths of all nodes in community $c$.\n\nWe will now compute these quantities for the two given communities, $C_1 = \\{1,2,3\\}$ and $C_2 = \\{4,5,6\\}$.\n\nFor community $C_1$:\nThe sum of internal link weights, $L_{C_1}$, is:\n$$\nL_{C_1} = A_{12} + A_{21} + A_{13} + A_{31} + A_{23} + A_{32} = 2(A_{12} + A_{13} + A_{23})\n$$\n$$\nL_{C_1} = 2(4 + 3 + 5) = 2(12) = 24\n$$\nThe sum of strengths, $K_{C_1}$, is:\n$$\nK_{C_1} = k_1 + k_2 + k_3 = \\frac{15}{2} + \\frac{19}{2} + \\frac{17}{2} = \\frac{51}{2}\n$$\n\nFor community $C_2$:\nThe sum of internal link weights, $L_{C_2}$, is:\n$$\nL_{C_2} = A_{45} + A_{54} + A_{46} + A_{64} + A_{56} + A_{65} = 2(A_{45} + A_{46} + A_{56})\n$$\n$$\nL_{C_2} = 2(4 + 3 + 5) = 2(12) = 24\n$$\nThe sum of strengths, $K_{C_2}$, is:\n$$\nK_{C_2} = k_4 + k_5 + k_6 = \\frac{15}{2} + \\frac{19}{2} + \\frac{17}{2} = \\frac{51}{2}\n$$\n\nNow, we can compute the modularity $Q$:\n$$\nQ = \\left[ \\frac{L_{C_1}}{2m} - \\left( \\frac{K_{C_1}}{2m} \\right)^2 \\right] + \\left[ \\frac{L_{C_2}}{2m} - \\left( \\frac{K_{C_2}}{2m} \\right)^2 \\right]\n$$\nSubstituting the calculated values:\n$$\nQ = \\left[ \\frac{24}{51} - \\left( \\frac{51/2}{51} \\right)^2 \\right] + \\left[ \\frac{24}{51} - \\left( \\frac{51/2}{51} \\right)^2 \\right]\n$$\n$$\nQ = 2 \\left[ \\frac{24}{51} - \\left( \\frac{1}{2} \\right)^2 \\right] = 2 \\left[ \\frac{24}{51} - \\frac{1}{4} \\right]\n$$\nWe simplify the fraction $\\frac{24}{51}$ by dividing the numerator and denominator by their greatest common divisor, $3$:\n$$\n\\frac{24}{51} = \\frac{8 \\times 3}{17 \\times 3} = \\frac{8}{17}\n$$\nWait, $24/3$ is $8$, not $16$. Let me re-calculate $L_{C_1}$ and $L_{C_2}$.\nCorrection: The formula for modularity is frequently written as $Q = \\sum_{c} (e_{cc} - a_c^2)$, where $e_{cc}$ is the fraction of edges within community $c$, and $a_c$ is the fraction of edge ends attached to nodes in community $c$.\n$e_{cc} = \\frac{\\sum_{i,j \\in c} A_{ij}/2}{m} = \\frac{\\text{sum of internal edge weights}}{m}$.\nThe sum of internal edge weights for $C_1$ is $A_{12} + A_{13} + A_{23} = 4+3+5 = 12$. So $e_{11} = 12/m = 12 / (51/2) = 24/51$. My previous $L_c$ was the sum of matrix entries, not the sum of edge weights. The formula $Q = \\frac{1}{2m} \\sum \\dots$ already contains the $1/2m$ factor. Let's restart the final calculation step with the original definition to avoid confusion.\n\n$Q = \\frac{1}{2m} \\sum_{i,j \\in C_1} \\left(A_{ij} - \\frac{k_i k_j}{2m}\\right) + \\frac{1}{2m} \\sum_{i,j \\in C_2} \\left(A_{ij} - \\frac{k_i k_j}{2m}\\right)$\n$Q = \\frac{1}{2m} \\left( \\sum_{i,j \\in C_1} A_{ij} - \\frac{1}{2m} \\sum_{i,j \\in C_1} k_i k_j \\right) + \\frac{1}{2m} \\left( \\sum_{i,j \\in C_2} A_{ij} - \\frac{1}{2m} \\sum_{i,j \\in C_2} k_i k_j \\right)$\n$\\sum_{i,j \\in C_1} A_{ij} = L_{C_1} = 24$.\n$\\sum_{i,j \\in C_2} A_{ij} = L_{C_2} = 24$.\n$\\sum_{i,j \\in C_1} k_i k_j = (\\sum_{i \\in C_1} k_i)(\\sum_{j \\in C_1} k_j) = (K_{C_1})^2 = (51/2)^2 = \\frac{2601}{4}$.\n$\\sum_{i,j \\in C_2} k_i k_j = (K_{C_2})^2 = (51/2)^2 = \\frac{2601}{4}$.\n\nSubstituting into the expression for $Q$:\n$Q = \\frac{1}{51} \\left( 24 - \\frac{1}{51} \\frac{2601}{4} \\right) + \\frac{1}{51} \\left( 24 - \\frac{1}{51} \\frac{2601}{4} \\right)$\n$Q = 2 \\times \\frac{1}{51} \\left( 24 - \\frac{2601}{204} \\right)$\nLet's use the simpler form $Q = \\sum_{c} \\left[ \\frac{L_c}{2m} - \\left( \\frac{K_c}{2m} \\right)^2 \\right]$, where $L_c = \\sum_{i,j \\in c} A_{ij}$. This is correct.\n$Q = \\left[ \\frac{24}{51} - \\left(\\frac{51/2}{51}\\right)^2 \\right] + \\left[ \\frac{24}{51} - \\left(\\frac{51/2}{51}\\right)^2 \\right]$\n$Q = 2 \\times \\left( \\frac{24}{51} - \\left(\\frac{1}{2}\\right)^2 \\right) = 2 \\times \\left( \\frac{24}{51} - \\frac{1}{4} \\right)$\n$Q = \\frac{48}{51} - \\frac{2}{4} = \\frac{48}{51} - \\frac{1}{2}$\nSimplify the fraction $\\frac{48}{51}$ by dividing numerator and denominator by $3$:\n$\\frac{48}{51} = \\frac{16 \\times 3}{17 \\times 3} = \\frac{16}{17}$\nNow, substitute this back into the expression for $Q$:\n$Q = \\frac{16}{17} - \\frac{1}{2}$\nTo subtract the fractions, we find a common denominator, which is $17 \\times 2 = 34$.\n$Q = \\frac{16 \\times 2}{17 \\times 2} - \\frac{1 \\times 17}{2 \\times 17} = \\frac{32}{34} - \\frac{17}{34} = \\frac{32 - 17}{34} = \\frac{15}{34}$\nThe calculation is correct. My mental arithmetic error on $24/3$ was a temporary lapse; the formula structure and subsequent steps were sound.\n\nFinal value of modularity is $Q = \\frac{15}{34}$.\n\nThe meaning of this result is as follows:\nModularity $Q$ measures the strength of a partition into communities by comparing the fraction of weighted edges within communities to the expected fraction if edges were placed at random, preserving node strengths (the configuration model).\n- A value of $Q > 0$ indicates that there are more (or more heavily weighted) edges within the proposed communities than would be expected by chance. This suggests the partition reflects a meaningful community structure.\n- A value of $Q \\approx 0$ implies the within-community edges are about what one would expect from a random network with the same strength distribution.\n- A value of $Q  0$ indicates that the partition is worse than random, with fewer within-community edges than expected.\n\nThe calculated value is $Q = \\frac{15}{34} \\approx 0.441$. This is a significant positive value. In typical applications, modularity values in the range of $0.3$ to $0.7$ are considered indicative of strong community structure. Therefore, the partition of the network into $C_1 = \\{1,2,3\\}$ and $C_2 = \\{4,5,6\\}$ represents a statistically significant division, revealing a strong community structure where nodes within each group are much more densely connected to each other than to nodes in the other group, relative to the null model. The network exhibits clear modularity with respect to this partition.",
            "answer": "$$\n\\boxed{\\frac{15}{34}}\n$$"
        },
        {
            "introduction": "Many modern community detection algorithms aim to find partitions that maximize modularity. The Louvain method is a highly effective and popular heuristic that achieves this through a fast, agglomerative or \"bottom-up\" process. This exercise  requires you to perform the first phase of the algorithm by hand, calculating modularity gains for node moves and experiencing the local, greedy optimization that makes this technique so powerful.",
            "id": "4118184",
            "problem": "Consider an undirected, unweighted network with nodes $1,2,3,4,5,6,7$ and edges given by the set $\\{(1,2),(1,3),(2,3),(3,4),(4,1),(5,6),(6,7),(5,7),(4,5)\\}$. The total number of edges is $m$, and the degree of node $i$ is denoted $k_i$. Starting from the partition in which each node is its own community, perform one pass of the Louvain method for modularity optimization as follows. In the first phase, sweep nodes in the fixed order $1,2,3,4,5,6,7$. For each node $i$, consider moves into the communities of its neighbors and apply the move that strictly increases the modularity $Q$ by the largest amount; if multiple destination communities yield the same strictly positive increase, choose the destination labeled by the smallest node index in that community; if no strictly positive increase is available, do not move the node. After completing one sweep, repeat sweeps in the same fixed order until a full sweep produces no moves. In the second phase, aggregate the communities found at the end of the first phase into supernodes to form the coarsened network, but do not perform any further local movement on the aggregated network.\n\nUsing the standard definition of modularity $Q$ for undirected networks, determine the exact value of the modularity $Q$ of the partition found at the end of the first phase (prior to aggregation). Express your final answer as a single simplified fraction. No rounding is required.",
            "solution": "The user wants to find the modularity of a partition in a network determined by one pass of the Louvain method.\n\n### Step 1: Problem Validation\n\nThe problem is formally defined and self-contained. It provides a complete description of the network, the initial conditions, and the precise, deterministic steps of the community detection algorithm to be applied. The objective is to calculate a well-defined metric, modularity, for the resulting partition. The concepts used—networks, nodes, edges, modularity, and the Louvain method—are standard in network science and complex systems modeling. The problem is scientifically grounded, well-posed, and objective. It contains no contradictions, ambiguities, or missing information. The problem is valid and can be solved as stated.\n\n### Step 2: Preliminaries: Network Properties and Modularity\n\nThe network is defined by a set of nodes $V = \\{1, 2, 3, 4, 5, 6, 7\\}$ and a set of edges $E = \\{(1,2), (1,3), (2,3), (3,4), (4,1), (5,6), (6,7), (5,7), (4,5)\\}$.\nThe total number of edges is $m = 9$. The total weight of all links is $2m=18$.\n\nThe degrees of the nodes are:\n- $k_1 = 3$ (neighbors: $2, 3, 4$)\n- $k_2 = 2$ (neighbors: $1, 3$)\n- $k_3 = 3$ (neighbors: $1, 2, 4$)\n- $k_4 = 3$ (neighbors: $1, 3, 5$)\n- $k_5 = 3$ (neighbors: $4, 6, 7$)\n- $k_6 = 2$ (neighbors: $5, 7$)\n- $k_7 = 2$ (neighbors: $5, 6$)\nThe sum of degrees is $\\sum k_i = 3+2+3+3+3+2+2 = 18 = 2m$, which is consistent.\n\nThe modularity $Q$ of a partition is given by:\n$$Q = \\sum_{c} \\left[ \\frac{L_c}{m} - \\left( \\frac{K_c}{2m} \\right)^2 \\right]$$\nwhere $L_c$ is the number of edges entirely within community $c$, and $K_c$ is the sum of the degrees of the nodes in community $c$.\n\nThe change in modularity, $\\Delta Q$, when moving a node $i$ from a community $D$ to a community $C$ is:\n$$\\Delta Q = \\left[ \\frac{k_{i,C}}{m} - \\frac{k_i K_C}{2m^2} \\right] - \\left[ \\frac{k_{i,D_{rem}}}{m} - \\frac{k_i (K_D-k_i)}{2m^2} \\right] = \\frac{k_{i,C} - k_{i,D_{rem}}}{m} - \\frac{k_i (K_C - K_D + k_i)}{2m^2}$$\nwhere $k_{i,C}$ is the number of edges connecting node $i$ to nodes in $C$, and $k_{i,D_{rem}}$ is the number of edges connecting node $i$ to the remaining nodes in its original community $D$. In the first phase, we start with each node in its own community, so $D = \\{i\\}$ and $k_{i,D_{rem}}=0$, $K_D=k_i$. The formula simplifies to:\n$$\\Delta Q = \\frac{k_{i,C}}{m} - \\frac{k_i K_C}{2m^2}$$\n\n### Step 3: Louvain Method - Phase 1\n\nWe begin with each node in its own community: $\\mathcal{C}_0 = \\{\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}, \\{7\\}\\}$. We perform sweeps over the nodes in the order $1,2,3,4,5,6,7$ until no node moves.\n\n**Sweep 1:**\n- **Node 1 ($k_1=3$):** Neighbors are $2,3,4$.\n    - Move to community of node $2$ ($\\{2\\}$): $C=\\{2\\}$, $K_C=k_2=2$, $k_{1,C}=1$. $\\Delta Q = \\frac{1}{9} - \\frac{3 \\cdot 2}{2 \\cdot 9^2} = \\frac{1}{9} - \\frac{6}{162} = \\frac{18-6}{162} = \\frac{12}{162} = \\frac{2}{27}$.\n    - Move to community of node $3$ ($\\{3\\}$): $C=\\{3\\}$, $K_C=k_3=3$, $k_{1,C}=1$. $\\Delta Q = \\frac{1}{9} - \\frac{3 \\cdot 3}{162} = \\frac{18-9}{162} = \\frac{9}{162} = \\frac{1}{18}$.\n    - Move to community of node $4$ ($\\{4\\}$): $C=\\{4\\}$, $K_C=k_4=3$, $k_{1,C}=1$. $\\Delta Q = \\frac{1}{18}$.\n    - Maximum strictly positive $\\Delta Q$ is $\\frac{2}{27}$. **Move node 1 to community $\\{2\\}$**.\n    - Communities: $\\mathcal{C} = \\{\\{1,2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}, \\{7\\}\\}$.\n\n- **Node 2 ($k_2=2$):** In $\\{1,2\\}$. Neighbors $1,3$. $1$ is in its community $\\{1,2\\}$.\n    - Move to community of node $3$ ($\\{3\\}$): $D=\\{1,2\\}$, $C=\\{3\\}$. $K_D=k_1+k_2=5$, $K_C=k_3=3$. $k_{2,D_{rem}}=1$ (edge to $1$), $k_{2,C}=1$ (edge to $3$).\n    - $\\Delta Q = \\frac{1-1}{9} - \\frac{2(3-5+2)}{162} = 0$. Not a strictly positive increase. **No move**.\n\n- **Node 3 ($k_3=3$):** In $\\{3\\}$. Neighbors $1,2,4$.\n    - Move to community of nodes $1,2$ ($\\{1,2\\}$): $C=\\{1,2\\}$, $K_C=5$, $k_{3,C}=2$ (edges to $1,2$).\n    - $\\Delta Q = \\frac{2}{9} - \\frac{3 \\cdot 5}{162} = \\frac{36-15}{162} = \\frac{21}{162} = \\frac{7}{54}$.\n    - Move to community of node $4$ ($\\{4\\}$): $C=\\{4\\}$, $K_C=3$, $k_{3,C}=1$.\n    - $\\Delta Q = \\frac{1}{9} - \\frac{3 \\cdot 3}{162} = \\frac{9}{162} = \\frac{1}{18}$.\n    - Maximum $\\Delta Q$ is $\\frac{7}{54}$. **Move node 3 to community $\\{1,2\\}$**.\n    - Communities: $\\mathcal{C} = \\{\\{1,2,3\\}, \\{4\\}, \\{5\\}, \\{6\\}, \\{7\\}\\}$.\n\n- **Node 4 ($k_4=3$):** In $\\{4\\}$. Neighbors $1,3,5$.\n    - Move to $\\{1,2,3\\}$: $C=\\{1,2,3\\}$, $K_C=k_1+k_2+k_3=8$, $k_{4,C}=2$ (to $1,3$). $\\Delta Q = \\frac{2}{9} - \\frac{3 \\cdot 8}{162} = \\frac{36-24}{162} = \\frac{12}{162} = \\frac{2}{27}$.\n    - Move to $\\{5\\}$: $C=\\{5\\}$, $K_C=k_5=3$, $k_{4,C}=1$. $\\Delta Q = \\frac{1}{9} - \\frac{3 \\cdot 3}{162} = \\frac{9}{162} = \\frac{1}{18}$.\n    - Maximum $\\Delta Q$ is $\\frac{2}{27}$. **Move node 4 to community $\\{1,2,3\\}$**.\n    - Communities: $\\mathcal{C} = \\{\\{1,2,3,4\\}, \\{5\\}, \\{6\\}, \\{7\\}\\}$.\n\n- **Node 5 ($k_5=3$):** In $\\{5\\}$. Neighbors $4,6,7$.\n    - Move to $\\{1,2,3,4\\}$: $C=\\{1,2,3,4\\}$, $K_C=11$, $k_{5,C}=1$ (to $4$). $\\Delta Q = \\frac{1}{9} - \\frac{3 \\cdot 11}{162} = \\frac{18-33}{162}  0$.\n    - Move to $\\{6\\}$: $C=\\{6\\}$, $K_C=k_6=2$, $k_{5,C}=1$. $\\Delta Q = \\frac{1}{9} - \\frac{3 \\cdot 2}{162} = \\frac{12}{162} = \\frac{2}{27}$.\n    - Move to $\\{7\\}$: $C=\\{7\\}$, $K_C=k_7=2$, $k_{5,C}=1$. $\\Delta Q = \\frac{2}{27}$.\n    - Tie for max $\\Delta Q > 0$. Destinations are $\\{6\\}$ (label $6$) and $\\{7\\}$ (label $7$). Smallest label is $6$. **Move node 5 to community $\\{6\\}$**.\n    - Communities: $\\mathcal{C} = \\{\\{1,2,3,4\\}, \\{5,6\\}, \\{7\\}\\}$.\n\n- **Node 6 ($k_6=2$):** In $\\{5,6\\}$. Neighbors $5,7$. $5$ is in its community.\n    - Move to $\\{7\\}$: $D=\\{5,6\\}$, $C=\\{7\\}$. $K_D=k_5+k_6=5$, $K_C=k_7=2$. $k_{6,D_{rem}}=1$ (to $5$), $k_{6,C}=1$ (to $7$).\n    - $\\Delta Q = \\frac{1-1}{9} - \\frac{2(2-5+2)}{162} = 0 - \\frac{-2}{162} = \\frac{2}{162} = \\frac{1}{81}$.\n    - Strictly positive. **Move node 6 to community $\\{7\\}$**.\n    - Communities: $\\mathcal{C} = \\{\\{1,2,3,4\\}, \\{5\\}, \\{6,7\\}\\}$.\n\n- **Node 7 ($k_7=2$):** In $\\{6,7\\}$. Neighbors $5,6$. $6$ is in its community.\n    - Move to $\\{5\\}$: $D=\\{6,7\\}$, $C=\\{5\\}$. $K_D=k_6+k_7=4$, $K_C=k_5=3$. $k_{7,D_{rem}}=1$ (to $6$), $k_{7,C}=1$ (to $5$).\n    - $\\Delta Q = \\frac{1-1}{9} - \\frac{2(3-4+2)}{162} = 0 - \\frac{2}{162}  0$. **No move**.\n\nEnd of Sweep 1. Moves were made, so a new sweep is required.\n\n**Sweep 2:**\nCurrent communities: $\\mathcal{C} = \\{\\{1,2,3,4\\}, \\{5\\}, \\{6,7\\}\\}$. Let $C_A=\\{1,2,3,4\\}, C_B=\\{5\\}, C_C=\\{6,7\\}$.\n$K_A = 11$, $K_B=3$, $K_C=4$.\n- **Nodes 1, 2, 3:** Neighbors are all in their own community $C_A$. No possible moves.\n- **Node 4 ($k_4=3$):** In $C_A$. Neighbor $5$ is in $C_B$.\n    - Move to $C_B$: $D=C_A, C=C_B$. $k_{4,D_{rem}}=2, k_{4,C}=1$. $K_D=11, K_C=3$.\n    - $\\Delta Q = \\frac{1-2}{9} - \\frac{3(3-11+3)}{162} = -\\frac{1}{9} - \\frac{-15}{162} = -\\frac{18}{162} + \\frac{15}{162}  0$. **No move**.\n- **Node 5 ($k_5=3$):** In $C_B$. Neighbors $4,6,7$.\n    - Move to $C_A=\\{1,2,3,4\\}$: $C=C_A$, $K_C=11$, $k_{5,C}=1$ (to $4$). $\\Delta Q = \\frac{1}{9} - \\frac{3 \\cdot 11}{162}  0$.\n    - Move to $C_C=\\{6,7\\}$: $C=C_C$, $K_C=4$, $k_{5,C}=2$ (to $6,7$). $\\Delta Q = \\frac{2}{9} - \\frac{3 \\cdot 4}{162} = \\frac{36-12}{162} = \\frac{24}{162} = \\frac{4}{27}  0$.\n    - **Move node 5 to community $C_C$**.\n    - Communities: $\\mathcal{C} = \\{\\{1,2,3,4\\}, \\{5,6,7\\}\\}$.\n- **Nodes 6, 7:** Now in community $\\{5,6,7\\}$. All neighbors are internal. No moves.\n\nEnd of Sweep 2. A move was made, so a new sweep is required.\n\n**Sweep 3:**\nCurrent communities: $\\mathcal{C} = \\{\\{1,2,3,4\\}, \\{5,6,7\\}\\}$. Let $C_X=\\{1,2,3,4\\}, C_Y=\\{5,6,7\\}$.\n$K_X = 11$, $K_Y=7$.\n- **Nodes 1, 2, 3, 6, 7:** All neighbors are internal. No moves.\n- **Node 4 ($k_4=3$):** In $C_X$. Neighbor $5$ is in $C_Y$.\n    - Move to $C_Y$: $D=C_X, C=C_Y$. $k_{4,D_{rem}}=2, k_{4,C}=1$. $K_D=11, K_C=7$.\n    - $\\Delta Q = \\frac{1-2}{9} - \\frac{3(7-11+3)}{162} = -\\frac{1}{9} - \\frac{-3}{162} = -\\frac{18}{162} + \\frac{3}{162}  0$. **No move**.\n- **Node 5 ($k_5=3$):** In $C_Y$. Neighbor $4$ is in $C_X$.\n    - Move to $C_X$: $D=C_Y, C=C_X$. $k_{5,D_{rem}}=2, k_{5,C}=1$. $K_D=7, K_C=11$.\n    - $\\Delta Q = \\frac{1-2}{9} - \\frac{3(11-7+3)}{162} = -\\frac{1}{9} - \\frac{21}{162}  0$. **No move**.\n\nNo moves were made in Sweep 3. The first phase of the algorithm terminates.\n\n### Step 4: Final Modularity Calculation\nThe final partition is $\\mathcal{C}_{final} = \\{C_X, C_Y\\}$ where $C_X = \\{1,2,3,4\\}$ and $C_Y = \\{5,6,7\\}$.\nWe calculate the terms for the modularity formula $Q = \\sum_{c} \\left[ \\frac{L_c}{m} - \\left( \\frac{K_c}{2m} \\right)^2 \\right]$.\n\nFor community $C_X = \\{1,2,3,4\\}$:\n- Internal edges: $\\{(1,2), (1,3), (2,3), (3,4), (4,1)\\}$. So, $L_{C_X} = 5$.\n- Sum of degrees: $K_{C_X} = k_1+k_2+k_3+k_4 = 3+2+3+3 = 11$.\n- Contribution to $Q$: $\\frac{5}{9} - \\left(\\frac{11}{18}\\right)^2$.\n\nFor community $C_Y = \\{5,6,7\\}$:\n- Internal edges: $\\{(5,6), (6,7), (5,7)\\}$. So, $L_{C_Y} = 3$.\n- Sum of degrees: $K_{C_Y} = k_5+k_6+k_7 = 3+2+2 = 7$.\n- Contribution to $Q$: $\\frac{3}{9} - \\left(\\frac{7}{18}\\right)^2 = \\frac{1}{3} - \\left(\\frac{7}{18}\\right)^2$.\n\nThe total modularity is:\n$$Q = \\left( \\frac{5}{9} - \\frac{11^2}{18^2} \\right) + \\left( \\frac{1}{3} - \\frac{7^2}{18^2} \\right)$$\n$$Q = \\frac{5}{9} + \\frac{3}{9} - \\left( \\frac{121}{324} + \\frac{49}{324} \\right)$$\n$$Q = \\frac{8}{9} - \\frac{170}{324}$$\nTo subtract, we use the common denominator $324 = 9 \\times 36$:\n$$Q = \\frac{8 \\times 36}{324} - \\frac{170}{324} = \\frac{288 - 170}{324} = \\frac{118}{324}$$\nSimplifying the fraction by dividing the numerator and denominator by $2$:\n$$Q = \\frac{59}{162}$$\nThe numerator, $59$, is a prime number. $162 = 2 \\times 3^4$. Thus, the fraction is in its simplest form.",
            "answer": "$$\\boxed{\\frac{59}{162}}$$"
        },
        {
            "introduction": "In contrast to agglomerative methods that build communities from individual nodes, divisive algorithms work by splitting the network from the top down. The seminal Girvan-Newman algorithm exemplifies this approach, hypothesizing that edges bridging communities have high \"betweenness centrality.\" This practice  walks you through the core mechanism of this algorithm, from calculating edge betweenness—a measure based on shortest paths—to using it to identify and partition the network's natural divisions.",
            "id": "4118212",
            "problem": "Consider an undirected, unweighted network with vertex set $\\{1,2,3,4,5,6,7\\}$ and edge set $\\{(1,2),(1,3),(2,3),(2,4),(3,4),(4,5),(5,6),(5,7),(6,7)\\}$. Use the following foundational definitions.\n\n- The edge betweenness centrality of an edge $(i,j)$, denoted $b(i,j)$, is defined as $b(i,j) = \\sum_{\\{s,t\\}\\subset V,\\, s\\neq t} \\frac{\\sigma_{st}(i,j)}{\\sigma_{st}}$, where $\\sigma_{st}$ is the number of shortest paths between $s$ and $t$, and $\\sigma_{st}(i,j)$ is the number of those shortest paths that traverse $(i,j)$. For multiple shortest paths between a pair, each path contributes equally, so the fraction $\\frac{\\sigma_{st}(i,j)}{\\sigma_{st}}$ is used.\n\n- The modularity of a partition $\\{c\\}$ of the vertices into communities, denoted $Q$, is defined for an undirected network by $Q = \\frac{1}{2m}\\sum_{i,j}\\left(A_{ij} - \\frac{k_i k_j}{2m}\\right)\\delta(c_i,c_j)$, where $A_{ij}$ is the adjacency matrix ($A_{ij}=1$ if $(i,j)\\in E$ and $A_{ij}=0$ otherwise), $k_i$ is the degree of vertex $i$, $m$ is the total number of edges, and $\\delta(c_i,c_j)$ is $1$ if $i$ and $j$ are in the same community and $0$ otherwise.\n\nTask:\n1. Compute the edge betweenness centrality $b(i,j)$ for every edge in the given network.\n2. Remove the single edge with the highest betweenness centrality. Let the two resulting connected components define the communities.\n3. Using the modularity definition above, evaluate the modularity $Q$ of this two-community partition on the modified network (after the edge removal) and provide the exact value as a reduced rational number. Express the final answer as a dimensionless quantity. No rounding is required; provide the exact analytic value.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information and definitions to proceed with a unique and verifiable solution.\n\nThe problem consists of three sequential tasks:\n1.  Compute the edge betweenness centrality for all edges in the given network.\n2.  Remove the edge with the highest betweenness centrality and identify the resulting communities.\n3.  Calculate the modularity of this partition on the network after edge removal.\n\nLet the vertex set be $V = \\{1, 2, 3, 4, 5, 6, 7\\}$ and the edge set be $E = \\{(1,2), (1,3), (2,3), (2,4), (3,4), (4,5), (5,6), (5,7), (6,7)\\}$. The total number of vertices is $N=7$ and the total number of edges in the original network is $m=9$. The graph consists of two triangular structures, $\\{1,2,3\\}$ and $\\{5,6,7\\}$, connected via the path $2-4-5$ and $3-4-5$.\n\n**Part 1: Edge Betweenness Centrality Calculation**\n\nThe edge betweenness centrality is given by $b(i,j) = \\sum_{\\{s,t\\}\\subset V,\\, s\\neq t} \\frac{\\sigma_{st}(i,j)}{\\sigma_{st}}$. We must sum the contributions for each edge over all $\\binom{7}{2} = 21$ pairs of distinct vertices. First, we identify the shortest paths and their counts ($\\sigma_{st}$) for all pairs $\\{s,t\\}$.\n\n-   Pairs within $\\{1,2,3\\}$ or $\\{5,6,7\\}$: The shortest path is the direct edge (length $1$). For example, for $\\{1,2\\}$, the path is $1-2$ and $\\sigma_{1,2}=1$.\n-   Pairs between $\\{1,2,3,4\\}$ and $\\{5,6,7\\}$: All shortest paths must traverse the bridge-like structure involving edge $(4,5)$.\n-   Other pairs: We systematically find all shortest paths. For instance, for $\\{1,4\\}$, the paths are $1-2-4$ and $1-3-4$, both of length $2$, so $\\sigma_{1,4}=2$.\n\nWe proceed to calculate $b(i,j)$ for each edge $(i,j) \\in E$.\n\n-   **Edge $(4,5)$**: This edge is the sole connection between the components $\\{1,2,3,4\\}$ and $\\{5,6,7\\}$. Any shortest path from a vertex $s \\in \\{1,2,3,4\\}$ to a vertex $t \\in \\{5,6,7\\}$ must pass through $(4,5)$. For any such pair, $\\sigma_{st}(4,5) = \\sigma_{st}$, so the contribution is $1$. There are $4 \\times 3 = 12$ such pairs.\n    Therefore, $b(4,5) = \\sum_{s \\in \\{1,2,3,4\\}, t \\in \\{5,6,7\\}} 1 = 4 \\times 3 = 12$.\n\n-   **Edges $(2,4)$ and $(3,4)$**: By symmetry, $b(2,4) = b(3,4)$. Let's calculate $b(2,4)$. Shortest paths through $(2,4)$ are:\n    -   $\\{2,4\\}$: $1$ path ($2-4$), contributes $1/1 = 1$.\n    -   $\\{2,5\\}$: $1$ path ($2-4-5$), contributes $1/1 = 1$.\n    -   $\\{2,6\\}$: $1$ path ($2-4-5-6$), contributes $1/1 = 1$.\n    -   $\\{2,7\\}$: $1$ path ($2-4-5-7$), contributes $1/1 = 1$.\n    -   $\\{1,4\\}$: $2$ paths ($1-2-4, 1-3-4$), one of which uses $(2,4)$, contributes $1/2$.\n    -   $\\{1,5\\}$: $2$ paths ($1-2-4-5, 1-3-4-5$), one of which uses $(2,4)$, contributes $1/2$.\n    -   $\\{1,6\\}$: $2$ paths ($1-2-4-5-6, 1-3-4-5-6$), one of which uses $(2,4)$, contributes $1/2$.\n    -   $\\{1,7\\}$: $2$ paths ($1-2-4-5-7, 1-3-4-5-7$), one of which uses $(2,4)$, contributes $1/2$.\n    Summing contributions: $b(2,4) = 1 + 1 + 1 + 1 + \\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2} = 4 + 4(\\frac{1}{2}) = 6$.\n    Thus, $b(3,4) = 6$.\n\n-   **Edges $(1,2)$ and $(1,3)$**: By symmetry, $b(1,2) = b(1,3)$. Let's calculate $b(1,2)$. Shortest paths through $(1,2)$ are:\n    -   $\\{1,2\\}$: $1$ path ($1-2$), contributes $1$.\n    -   $\\{1,4\\}$: $2$ paths ($1-2-4, 1-3-4$), one uses $(1,2)$, contributes $1/2$.\n    -   $\\{1,5\\}$: $2$ paths ($1-2-4-5, 1-3-4-5$), one uses $(1,2)$, contributes $1/2$.\n    -   $\\{1,6\\}$: $2$ paths ($1-2-4-5-6, 1-3-4-5-6$), one uses $(1,2)$, contributes $1/2$.\n    -   $\\{1,7\\}$: $2$ paths ($1-2-4-5-7, 1-3-4-5-7$), one uses $(1,2)$, contributes $1/2$.\n    Summing contributions: $b(1,2) = 1 + 4(\\frac{1}{2}) = 3$. Thus, $b(1,3)=3$.\n\n-   **Edges $(5,6)$ and $(5,7)$**: By symmetry, $b(5,6)=b(5,7)$. Let's calculate $b(5,6)$. Shortest paths through $(5,6)$ must have one endpoint as $6$. The other endpoint must be a node for which the shortest path to $6$ goes via $5$. This is true for all nodes in $\\{1,2,3,4,5\\}$.\n    -   $\\{5,6\\}$: $1$ path ($5-6$), contributes $1$.\n    -   $\\{4,6\\}$: $1$ path ($4-5-6$), contributes $1$.\n    -   $\\{3,6\\}$: $1$ path ($3-4-5-6$), contributes $1$.\n    -   $\\{2,6\\}$: $1$ path ($2-4-5-6$), contributes $1$.\n    -   $\\{1,6\\}$: $2$ paths ($1-2-4-5-6, 1-3-4-5-6$), both use $(5,6)$ after passing through $5$. Contribution is $\\sigma_{1,6}(5,6)/\\sigma_{1,6} = 2/2=1$.\n    Summing contributions: $b(5,6) = 1+1+1+1+1=5$. Thus, $b(5,7)=5$.\n\n-   **Edges $(2,3)$ and $(6,7)$**: These edges are part of cliques $\\{1,2,3\\}$ and $\\{5,6,7\\}$ respectively. Any shortest path of the form $...-x-2-3-y-...$ can be shortcut if there is an alternative path. For any pair $\\{s,t\\}$, if a shortest path uses $(2,3)$, then $s...-2-3-...t$ cannot be rerouted via $s...-2-1-3-...t$ since that path is longer. However, for a path to be shortest, it cannot contain a \"shortcut\". For any path going through $(2,3)$ between nodes $s$ and $t$, if $s=1$, the path $1-2-3$ to reach $t=3$ is not a shortest path, as $1-3$ exists and is shorter. It can be shown that for any $\\{s,t\\}$, no shortest path will traverse edge $(2,3)$ unless $\\{s,t\\}=\\{2,3\\}$. The same logic applies to edge $(6,7)$.\n    -   $b(2,3)$: Only the path for the pair $\\{2,3\\}$ itself passes through this edge. Contribution is $1$. So $b(2,3)=1$.\n    -   $b(6,7)$: Only the path for $\\{6,7\\}$ passes through this edge. Contribution is $1$. So $b(6,7)=1$.\n\nSummary of edge betweenness values:\n$b(1,2)=3$, $b(1,3)=3$, $b(2,3)=1$, $b(2,4)=6$, $b(3,4)=6$, $b(4,5)=12$, $b(5,6)=5$, $b(5,7)=5$, $b(6,7)=1$.\n\n**Part 2: Community Partition**\n\nThe single edge with the highest betweenness centrality is $(4,5)$, with $b(4,5)=12$. We remove this edge. The network splits into two disjoint connected components, which we define as our communities:\n-   Community $c_1=\\{1,2,3,4\\}$\n-   Community $c_2=\\{5,6,7\\}$\n\n**Part 3: Modularity Calculation**\n\nThe problem requires calculating the modularity $Q$ of this partition on the **modified network**, i.e., after the removal of edge $(4,5)$.\nThe modularity formula is $Q = \\frac{1}{2m'}\\sum_{i,j}\\left(A'_{ij} - \\frac{k'_i k'_j}{2m'}\\right)\\delta(c_i,c_j)$, where primed variables refer to the modified network.\n\nThe modified network has $m' = m - 1 = 9 - 1 = 8$ edges, so $2m'=16$.\nThe degrees $k'_i$ in the modified network are:\n-   $k'_1 = 2$\n-   $k'_2 = 3$\n-   $k'_3 = 3$\n-   $k'_4 = k_4 - 1 = 3 - 1 = 2$\n-   $k'_5 = k_5 - 1 = 3 - 1 = 2$\n-   $k'_6 = 2$\n-   $k'_7 = 2$\n\nWe can rewrite $Q$ as a sum over communities: $Q = \\sum_k \\left( \\frac{L_k}{m'} - \\left( \\frac{K_k}{2m'} \\right)^2 \\right)$, where $L_k$ is the number of internal edges in community $k$ and $K_k$ is the sum of degrees of nodes in community $k$.\n\nFor Community $c_1=\\{1,2,3,4\\}$:\n-   The internal edges are $(1,2), (1,3), (2,3), (2,4), (3,4)$. So, $L_1=5$.\n-   The sum of degrees is $K_1 = k'_1+k'_2+k'_3+k'_4 = 2+3+3+2 = 10$.\n-   The contribution from $c_1$ is $\\frac{L_1}{m'} - \\left( \\frac{K_1}{2m'} \\right)^2 = \\frac{5}{8} - \\left( \\frac{10}{16} \\right)^2 = \\frac{5}{8} - \\left( \\frac{5}{8} \\right)^2 = \\frac{5}{8} - \\frac{25}{64} = \\frac{40-25}{64} = \\frac{15}{64}$.\n\nFor Community $c_2=\\{5,6,7\\}$:\n-   The internal edges are $(5,6), (5,7), (6,7)$. So, $L_2=3$.\n-   The sum of degrees is $K_2 = k'_5+k'_6+k'_7 = 2+2+2 = 6$.\n-   The contribution from $c_2$ is $\\frac{L_2}{m'} - \\left( \\frac{K_2}{2m'} \\right)^2 = \\frac{3}{8} - \\left( \\frac{6}{16} \\right)^2 = \\frac{3}{8} - \\left( \\frac{3}{8} \\right)^2 = \\frac{3}{8} - \\frac{9}{64} = \\frac{24-9}{64} = \\frac{15}{64}$.\n\nThe total modularity is the sum of these contributions:\n$Q = \\frac{15}{64} + \\frac{15}{64} = \\frac{30}{64}$.\nThis fraction reduces to $Q=\\frac{15}{32}$.",
            "answer": "$$\\boxed{\\frac{15}{32}}$$"
        }
    ]
}