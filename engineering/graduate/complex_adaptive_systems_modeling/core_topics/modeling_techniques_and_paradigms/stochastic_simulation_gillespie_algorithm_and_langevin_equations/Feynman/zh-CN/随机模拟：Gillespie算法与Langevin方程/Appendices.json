{
    "hands_on_practices": [
        {
            "introduction": "在随机化学动力学中，系统可以在多个尺度上进行描述。本练习将引导您探索描述微观离散跳变的化学主方程（CME）与描述介观连续轨迹的化学朗之万方程（CLE）之间的基本联系。通过对一个经典的生灭过程进行分析，您将推导出两种框架下的矩方程，并验证在何种条件下朗之万近似能够精确地捕捉系统的均值和涨落 。",
            "id": "4144829",
            "problem": "考虑一个充分混合的单物种反应系统，其分子数 $X(t) \\in \\{0,1,2,\\dots\\}$ 由以下两个反应控制：(i) 移入反应 $\\varnothing \\to X$，化学计量变化为 $+1$，倾向函数为 $a_{1}(X) = \\alpha$；(ii) 线性死亡反应 $X \\to \\varnothing$，化学计量变化为 $-1$，倾向函数为 $a_{2}(X) = \\beta X$，其中 $\\alpha > 0$ 和 $\\beta > 0$ 是常数。设该过程在介观尺度上由化学朗之万方程 (Chemical Langevin Equation, CLE) 建模，在微观尺度上由化学主方程 (Chemical Master Equation, CME) 建模。随机模拟算法 (Stochastic Simulation Algorithm, SSA)，也称为 Gillespie 算法，可以生成 CME 的精确样本路径，但在本问题中无需用于计算。\n\n从第一性原理出发，完成以下任务：\n- 直接从反应的化学计量和倾向函数推导物种 $X(t)$ 的 CLE 漂移项和扩散项，并用它们来获得一阶矩 $m_{1}(t) = \\mathbb{E}[X(t)]$ 和二阶矩 $m_{2}(t) = \\mathbb{E}[X(t)^{2}]$ 的封闭常微分方程组。\n- 利用与跳跃过程相关的无穷小生成元的定义，从 CME 独立地推导 $m_{1}(t)$ 和 $m_{2}(t)$ 的封闭常微分方程组。\n- 从每组矩方程（CLE 和 CME）中，计算稳态均值 $\\mu = \\lim_{t \\to \\infty} \\mathbb{E}[X(t)]$ 和稳态协方差 $\\Sigma = \\lim_{t \\to \\infty} \\mathrm{Cov}(X(t),X(t))$（对于单物种，这即是稳态方差）。比较这两个结果，以评估 CLE 对此线性系统的近似质量。\n\n将你的最终答案以一个包含稳态均值和稳态协方差的双元素行向量形式给出，使用 $\\alpha$ 和 $\\beta$ 的符号形式表示。不需要进行数值计算或四舍五入。不要包含单位。",
            "solution": "该问题被验证为合理、适定且客观。它描述了一个标准的移入-死亡过程，这是随机化学动力学中的一个基本模型。所有必需的定义和常数均已提供。\n\n该系统包含单个物种 $X$ 和两个反应：\n$1$. 移入：$\\varnothing \\xrightarrow{\\alpha} X$，化学计量变化为 $v_1 = +1$，倾向函数为 $a_1(X) = \\alpha$。\n$2$. 线性死亡：$X \\xrightarrow{\\beta X} \\varnothing$，化学计量变化为 $v_2 = -1$，倾向函数为 $a_2(X) = \\beta X$。\n\n首先，我们从化学朗之万方程 (CLE) 推导矩方程。\n对于一个包含 $M$ 个反应和单个物种 $X$ 的系统，CLE 的一般形式为：\n$$ dX(t) = \\sum_{j=1}^{M} v_j a_j(X) dt + \\sum_{j=1}^{M} v_j \\sqrt{a_j(X)} dW_j(t) $$\n其中 $dW_j(t)$ 是独立标准维纳过程的增量。随机项可以合并为具有复合扩散系数的单个维纳过程 $dW(t)$。得到的随机微分方程形式为 $dX(t) = A(X)dt + B(X)dW(t)$，其中漂移项 $A(X)$ 和扩散项的平方 $B(X)^2$ 分别为：\n$$ A(X) = \\sum_{j=1}^{M} v_j a_j(X) $$\n$$ B(X)^2 = \\sum_{j=1}^{M} v_j^2 a_j(X) $$\n对于给定的含 $M=2$ 个反应的系统：\n漂移项为：\n$$ A(X) = v_1 a_1(X) + v_2 a_2(X) = (+1)(\\alpha) + (-1)(\\beta X) = \\alpha - \\beta X $$\n扩散项的平方为：\n$$ B(X)^2 = v_1^2 a_1(X) + v_2^2 a_2(X) = (+1)^2(\\alpha) + (-1)^2(\\beta X) = \\alpha + \\beta X $$\n因此，该系统的具体 CLE 为：\n$$ dX(t) = (\\alpha - \\beta X) dt + \\sqrt{\\alpha + \\beta X} dW(t) $$\n任意函数 $f(X)$ 的期望的时间演化可以通过对其 Itô 微分取期望得到：\n$$ \\frac{d\\mathbb{E}[f(X)]}{dt} = \\mathbb{E}\\left[ A(X) \\frac{df}{dX} + \\frac{1}{2} B(X)^2 \\frac{d^2f}{dX^2} \\right] $$\n为了找到一阶矩 $m_1(t) = \\mathbb{E}[X(t)]$ 的方程，我们设 $f(X) = X$。那么 $\\frac{df}{dX} = 1$ 且 $\\frac{d^2f}{dX^2} = 0$。\n$$ \\frac{dm_1}{dt} = \\mathbb{E}[(\\alpha - \\beta X)(1) + \\frac{1}{2}(\\alpha + \\beta X)(0)] = \\mathbb{E}[\\alpha - \\beta X] = \\alpha - \\beta \\mathbb{E}[X] $$\n$$ \\frac{dm_1}{dt} = \\alpha - \\beta m_1 $$\n为了找到二阶矩 $m_2(t) = \\mathbb{E}[X(t)^2]$ 的方程，我们设 $f(X) = X^2$。那么 $\\frac{df}{dX} = 2X$ 且 $\\frac{d^2f}{dX^2} = 2$。\n$$ \\frac{dm_2}{dt} = \\mathbb{E}\\left[ (\\alpha - \\beta X)(2X) + \\frac{1}{2}(\\alpha + \\beta X)(2) \\right] = \\mathbb{E}[2\\alpha X - 2\\beta X^2 + \\alpha + \\beta X] $$\n$$ \\frac{dm_2}{dt} = \\mathbb{E}[(2\\alpha + \\beta)X - 2\\beta X^2 + \\alpha] = (2\\alpha + \\beta)\\mathbb{E}[X] - 2\\beta\\mathbb{E}[X^2] + \\alpha $$\n$$ \\frac{dm_2}{dt} = (2\\alpha + \\beta)m_1 - 2\\beta m_2 + \\alpha $$\n这得到了一个基于 CLE 的关于前两个矩的封闭常微分方程组。\n\n接下来，我们从化学主方程 (CME) 推导矩方程。\n状态 $X$ 的函数 $f$ 的期望 $\\mathbb{E}[f(X)]$ 的演化由跳跃过程的无穷小生成元 $\\mathcal{L}$ 控制：\n$$ \\frac{d\\mathbb{E}[f(X)]}{dt} = \\mathbb{E}[(\\mathcal{L}f)(X)] $$\n生成元作用于函数 $f(n)$ 的方式如下：\n$$ (\\mathcal{L}f)(n) = \\sum_{j=1}^{M} a_j(n) [f(n+v_j) - f(n)] $$\n对于我们的系统，这变成：\n$$ (\\mathcal{L}f)(n) = a_1(n)[f(n+v_1) - f(n)] + a_2(n)[f(n+v_2) - f(n)] $$\n$$ (\\mathcal{L}f)(n) = \\alpha[f(n+1) - f(n)] + \\beta n[f(n-1) - f(n)] $$\n对于一阶矩 $m_1(t)$，我们设 $f(n)=n$：\n$$ (\\mathcal{L}f)(n) = \\alpha[(n+1) - n] + \\beta n[(n-1) - n] = \\alpha(1) + \\beta n(-1) = \\alpha - \\beta n $$\n取期望：\n$$ \\frac{dm_1}{dt} = \\mathbb{E}[\\alpha - \\beta X] = \\alpha - \\beta \\mathbb{E}[X] = \\alpha - \\beta m_1 $$\n对于二阶矩 $m_2(t)$，我们设 $f(n)=n^2$：\n$$ (\\mathcal{L}f)(n) = \\alpha[(n+1)^2 - n^2] + \\beta n[(n-1)^2 - n^2] $$\n$$ (\\mathcal{L}f)(n) = \\alpha[n^2 + 2n + 1 - n^2] + \\beta n[n^2 - 2n + 1 - n^2] $$\n$$ (\\mathcal{L}f)(n) = \\alpha(2n+1) + \\beta n(-2n+1) = 2\\alpha n + \\alpha - 2\\beta n^2 + \\beta n = (2\\alpha+\\beta)n - 2\\beta n^2 + \\alpha $$\n取期望：\n$$ \\frac{dm_2}{dt} = \\mathbb{E}[(2\\alpha+\\beta)X - 2\\beta X^2 + \\alpha] = (2\\alpha+\\beta)\\mathbb{E}[X] - 2\\beta\\mathbb{E}[X^2] + \\alpha $$\n$$ \\frac{dm_2}{dt} = (2\\alpha+\\beta)m_1 - 2\\beta m_2 + \\alpha $$\n从 CME 推导出的矩方程与从 CLE 推导出的矩方程是相同的。这是倾向函数对状态变量至多是线性的反应系统的一个特殊性质。在这种情况下，CLE 不是近似前两个矩的动力学，而是精确地捕捉它们。\n\n最后，我们计算稳态均值和方差。\n令 $\\mu = \\lim_{t \\to \\infty} m_1(t)$ 且 $\\mu_2 = \\lim_{t \\to \\infty} m_2(t)$。在稳态时，时间导数为零，所以 $\\frac{dm_1}{dt} = 0$ 且 $\\frac{dm_2}{dt} = 0$。\n从一阶矩的方程：\n$$ 0 = \\alpha - \\beta \\mu \\implies \\mu = \\frac{\\alpha}{\\beta} $$\n这是稳态均值 $\\mu = \\mathbb{E}[X(\\infty)]$。\n从二阶矩的方程：\n$$ 0 = (2\\alpha + \\beta)\\mu - 2\\beta \\mu_2 + \\alpha $$\n$$ 2\\beta \\mu_2 = (2\\alpha + \\beta)\\mu + \\alpha $$\n代入 $\\mu$ 的表达式：\n$$ 2\\beta \\mu_2 = (2\\alpha + \\beta)\\frac{\\alpha}{\\beta} + \\alpha = \\frac{2\\alpha^2}{\\beta} + \\frac{\\alpha\\beta}{\\beta} + \\alpha = \\frac{2\\alpha^2}{\\beta} + 2\\alpha $$\n$$ \\mu_2 = \\frac{1}{2\\beta}\\left(\\frac{2\\alpha^2}{\\beta} + 2\\alpha\\right) = \\frac{\\alpha^2}{\\beta^2} + \\frac{\\alpha}{\\beta} $$\n这是稳态二阶矩 $\\mu_2 = \\mathbb{E}[X(\\infty)^2]$。\n稳态协方差，对于单物种即为其方差 $\\Sigma$，计算如下：\n$$ \\Sigma = \\mathrm{Var}(X(\\infty)) = \\mathbb{E}[X(\\infty)^2] - (\\mathbb{E}[X(\\infty)])^2 = \\mu_2 - \\mu^2 $$\n$$ \\Sigma = \\left(\\frac{\\alpha^2}{\\beta^2} + \\frac{\\alpha}{\\beta}\\right) - \\left(\\frac{\\alpha}{\\beta}\\right)^2 = \\frac{\\alpha^2}{\\beta^2} + \\frac{\\alpha}{\\beta} - \\frac{\\alpha^2}{\\beta^2} = \\frac{\\alpha}{\\beta} $$\n由于从 CLE 和 CME 方法推导出的矩方程是相同的，所以得到的稳态矩也是相同的。对于这个线性系统，CLE 为前两个稳态矩提供了精确的结果。稳态均值为 $\\mu = \\frac{\\alpha}{\\beta}$，稳态方差为 $\\Sigma = \\frac{\\alpha}{\\beta}$。\n该结果与参数为 $\\lambda = \\frac{\\alpha}{\\beta}$ 的泊松分布的已知性质相匹配，后者是此过程 CME 的精确稳态分布。\n\n最终答案包含稳态均值 $\\mu$ 和稳态协方差 (方差) $\\Sigma$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\alpha}{\\beta} & \\frac{\\alpha}{\\beta} \\end{pmatrix} } $$"
        },
        {
            "introduction": "在引入朗之万方程后，我们现在深入探讨一个关键的细节：如何解释随机积分。对于具有乘性噪声（即噪声强度依赖于系统状态）的系统，不同的积分解释（Itō 或 Stratonovich）会导致不同的物理预测。本练习将要求您从第一性原理出发，推导两种解释之间的关系，从而揭示“噪声诱导漂移”项的来源 。",
            "id": "4144792",
            "problem": "考虑一个受乘性涨落影响的复杂自适应系统的一维粗粒化状态 $x(t)$。令 $W_t$ 表示一个标准的维纳过程（布朗运动），其独立增量满足 $\\mathbb{E}[W_{t+\\Delta t}-W_t]=0$ 和 $\\mathbb{E}[(W_{t+\\Delta t}-W_t)^2]=\\Delta t$。假设 $a(x)$ 和 $b(x)$ 是充分光滑的函数。\n\n描述同一物理系统的两个随机微分方程（SDE）在不同的随机微积分诠释下写成：\n1. Itō 诠释：$dx_t = f(x_t)\\,dt + g(x_t)\\,dW_t$。\n2. Stratonovich 诠释：$dx_t = a(x_t)\\,dt + b(x_t)\\circ dW_t$。\n\n仅使用随机过程的基本原理和核心定义以及 Kramers–Moyal 展开（导出概率密度 $P(x,t)$ 的 Fokker–Planck 方程（FPE）），完成以下任务：\n- 从 Itō 诠释出发，推导 $P(x,t)$ 的 FPE。\n- 从 Stratonovich 诠释出发，通过仔细处理随机积分的中点诠释，并展示在转换为等效 Itō 形式时产生的诱导修正，来推导 $P(x,t)$ 的 FPE。\n- 将两个 FPE 都表示为标准的漂移-扩散形式后，确定一个单一的解析表达式 $\\Delta(x)$，该表达式描述了当 Itō 和 Stratonovich 两种诠释使用相同的乘性噪声振幅函数 $b(x)$ 时，FPE 中漂移项的差异。也就是说，确定 $\\Delta(x)$ 使得 Itō 漂移等于 Stratonovich 漂移加上 $\\Delta(x)$。\n\n你的最终答案必须是 $\\Delta(x)$ 的单一闭式解析表达式。不需要进行数值近似。",
            "solution": "问题要求推导解析表达式 $\\Delta(x)$，该表达式关联了描述同一物理过程的 Itō 随机微分方程（SDE）和 Stratonovich SDE 的漂移系数。该表达式代表了因随机微积分的选择而产生的“噪声诱导漂移”。推导将基于第一性原理，使用 Kramers–Moyal 展开为每种 SDE 诠释推导 Fokker–Planck 方程（FPE）。\n\n概率密度 $P(x,t)$ 的 Fokker–Planck 方程的一般形式由截断到二阶的 Kramers–Moyal 展开给出：\n$$\n\\frac{\\partial P(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[ D^{(1)}(x) P(x,t) \\right] + \\frac{1}{2} \\frac{\\partial^2}{\\partial x^2} \\left[ D^{(2)}(x) P(x,t) \\right]\n$$\n其中 $D^{(n)}(x)$ 是 Kramers–Moyal 系数，定义为：\n$$\nD^{(n)}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}\\left[ (x(t+\\Delta t) - x(t))^n | x(t)=x \\right] = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}\\left[ (\\Delta x)^n | x_t=x \\right]\n$$\n我们现在将为每种诠释推导 FPE。\n\n**1. 从 Itō 诠释推导 Fokker–Planck 方程**\n\nItō SDE 由下式给出：\n$$\ndx_t = f(x_t)\\,dt + g(x_t)\\,dW_t\n$$\n其中 $W_t$ 是一个标准维纳过程，满足 $\\mathbb{E}[\\Delta W_t] = 0$ 和 $\\mathbb{E}[(\\Delta W_t)^2] = \\Delta t$，其中 $\\Delta W_t = W_{t+\\Delta t} - W_t$。\n\n在时间步长 $\\Delta t$ 内的无穷小增量 $\\Delta x = x_{t+\\Delta t} - x_t$ 可以通过对 SDE 积分来近似：\n$$\n\\Delta x = \\int_t^{t+\\Delta t} f(x_s)\\,ds + \\int_t^{t+\\Delta t} g(x_s)\\,dW_s\n$$\n在 Itō 诠释中，被积函数在区间开始处 $s=t$ 进行求值。对于一个很小的时间步长 $\\Delta t$，这给出：\n$$\n\\Delta x \\approx f(x_t)\\Delta t + g(x_t)\\Delta W_t\n$$\n我们现在计算前两个 Kramers–Moyal 系数。为简洁起见，我们记 $x_t=x$。\n\n第一个系数，$D^{(1)}(x)$:\n$$\n\\mathbb{E}[\\Delta x] = \\mathbb{E}[f(x)\\Delta t + g(x)\\Delta W_t] = f(x)\\Delta t + g(x)\\mathbb{E}[\\Delta W_t] = f(x)\\Delta t\n$$\n$$\nD^{(1)}(x) = \\lim_{\\Delta t \\to 0} \\frac{f(x)\\Delta t}{\\Delta t} = f(x)\n$$\n\n第二个系数，$D^{(2)}(x)$:\n我们计算 $(\\Delta x)^2$ 的期望值：\n$$\n\\mathbb{E}[(\\Delta x)^2] = \\mathbb{E}\\left[ (f(x)\\Delta t + g(x)\\Delta W_t)^2 \\right] = \\mathbb{E}\\left[ f(x)^2(\\Delta t)^2 + 2f(x)g(x)\\Delta t \\Delta W_t + g(x)^2(\\Delta W_t)^2 \\right]\n$$\n利用维纳增量的性质，这变为：\n$$\n\\mathbb{E}[(\\Delta x)^2] = f(x)^2(\\Delta t)^2 + 2f(x)g(x)\\Delta t \\mathbb{E}[\\Delta W_t] + g(x)^2\\mathbb{E}[(\\Delta W_t)^2] = f(x)^2(\\Delta t)^2 + 0 + g(x)^2\\Delta t\n$$\n除以 $\\Delta t$ 并取极限：\n$$\nD^{(2)}(x) = \\lim_{\\Delta t \\to 0} \\left( f(x)^2\\Delta t + g(x)^2 \\right) = g(x)^2\n$$\n对于 $n > 2$ 的高阶系数 $D^{(n)}(x)$ 会消失，因为 $\\mathbb{E}[(\\Delta x)^n] = O((\\Delta t)^{n/2})$，因此对于 $n>2$，$\\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t}\\mathbb{E}[(\\Delta x)^n] = 0$。\n\n将 $D^{(1)}(x)$ 和 $D^{(2)}(x)$ 代入 FPE 形式，得到对应于 Itō SDE 的 FPE：\n$$\n\\frac{\\partial P(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[ f(x) P(x,t) \\right] + \\frac{1}{2} \\frac{\\partial^2}{\\partial x^2} \\left[ g(x)^2 P(x,t) \\right]\n$$\n此 FPE 的漂移项由系数 $A_{\\text{Itō}}(x) = f(x)$ 表征。\n\n**2. 从 Stratonovich 诠释推导 Fokker–Planck 方程**\n\nStratonovich SDE 由下式给出：\n$$\ndx_t = a(x_t)\\,dt + b(x_t)\\circ dW_t\n$$\n符号 $\\circ$ 表示 Stratonovich 随机积分。与 Itō 积分的关键区别在于被积函数的求值点。Stratonovich 积分被定义为一个和的极限，其中被积函数在每个时间间隔的中点求值。对于一个很小的时间间隔 $[t, t+\\Delta t]$，这给出：\n$$\n\\Delta x \\approx a(x_t)\\Delta t + b\\left(\\frac{x_t + x_{t+\\Delta t}}{2}\\right) \\Delta W_t\n$$\n让我们分析随机项。我们可以写出 $x_{t+\\Delta t} = x_t + \\Delta x$。$b$ 的自变量是 $x_t + \\frac{1}{2}\\Delta x$。由于函数 $b(x)$ 假设是光滑的，我们可以在 $x_t$ 附近进行泰勒展开：\n$$\nb\\left(x_t + \\frac{1}{2}\\Delta x\\right) \\approx b(x_t) + \\frac{1}{2}\\Delta x \\, b'(x_t)\n$$\n其中 $b'(x) = \\frac{db}{dx}$。将此代回 $\\Delta x$ 的表达式中：\n$$\n\\Delta x \\approx a(x_t)\\Delta t + \\left[ b(x_t) + \\frac{1}{2}\\Delta x \\, b'(x_t) \\right] \\Delta W_t\n$$\n这个方程对于 $\\Delta x$ 仍然是隐式的。为了获得一个显式表达式，我们可以将 $\\Delta x$ 的一阶近似代入二阶修正项 $\\frac{1}{2}\\Delta x \\, b'(x_t) \\Delta W_t$ 中。随机增量的最低阶近似是 $\\Delta x \\approx b(x_t) \\Delta W_t$，因为 $\\Delta W_t \\sim \\sqrt{\\Delta t}$ 主导 $\\Delta t$。\n$$\n\\Delta x \\approx a(x_t)\\Delta t + b(x_t) \\Delta W_t + \\frac{1}{2} \\left( b(x_t) \\Delta W_t \\right) b'(x_t) \\Delta W_t\n$$\n$$\n\\Delta x \\approx a(x_t)\\Delta t + b(x_t) \\Delta W_t + \\frac{1}{2} b(x_t) b'(x_t) (\\Delta W_t)^2\n$$\n这是对应于 Stratonovich SDE 的等效 Itō 增量。我们现在可以计算这个增量的 Kramers–Moyal 系数。令 $x_t=x$。\n\n第一个系数，$D^{(1)}(x)$:\n$$\n\\mathbb{E}[\\Delta x] = \\mathbb{E}\\left[ a(x)\\Delta t + b(x)\\Delta W_t + \\frac{1}{2}b(x)b'(x)(\\Delta W_t)^2 \\right]\n$$\n使用期望的线性和维纳过程的性质：\n$$\n\\mathbb{E}[\\Delta x] = a(x)\\Delta t + b(x)\\mathbb{E}[\\Delta W_t] + \\frac{1}{2}b(x)b'(x)\\mathbb{E}[(\\Delta W_t)^2] = a(x)\\Delta t + 0 + \\frac{1}{2}b(x)b'(x)\\Delta t\n$$\n$$\nD^{(1)}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\left( a(x)\\Delta t + \\frac{1}{2}b(x)b'(x)\\Delta t \\right) = a(x) + \\frac{1}{2}b(x)b'(x)\n$$\n\n第二个系数，$D^{(2)}(x)$:\n对于 $\\mathbb{E}[(\\Delta x)^2]$，我们只需要考虑阶数为 $\\Delta t$ 的项。项 $b(x)\\Delta W_t$ 的阶数是 $\\sqrt{\\Delta t}$，而 $\\Delta x$ 中的所有其他项的阶数是 $\\Delta t$ 或更高。因此，对 $(\\Delta x)^2$ 的主要贡献是 $(b(x)\\Delta W_t)^2$。\n$$\n\\mathbb{E}[(\\Delta x)^2] = \\mathbb{E}\\left[ \\left( a(x)\\Delta t + \\frac{1}{2}b(x)b'(x)(\\Delta W_t)^2 + b(x)\\Delta W_t \\right)^2 \\right] \\approx \\mathbb{E}\\left[ (b(x)\\Delta W_t)^2 \\right] + O((\\Delta t)^{3/2})\n$$\n$$\n\\mathbb{E}[(\\Delta x)^2] = b(x)^2\\mathbb{E}[(\\Delta W_t)^2] + O((\\Delta t)^{3/2}) = b(x)^2\\Delta t + O((\\Delta t)^{3/2})\n$$\n$$\nD^{(2)}(x) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\left( b(x)^2\\Delta t + O((\\Delta t)^{3/2}) \\right) = b(x)^2\n$$\n和之前一样，高阶系数消失。将这些系数代入 FPE 形式，得到对应于 Stratonovich SDE 的 FPE：\n$$\n\\frac{\\partial P(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[ \\left(a(x) + \\frac{1}{2}b(x)b'(x)\\right) P(x,t) \\right] + \\frac{1}{2} \\frac{\\partial^2}{\\partial x^2} \\left[ b(x)^2 P(x,t) \\right]\n$$\n此 FPE 的漂移项由系数 $A_{\\text{Strat}}(x) = a(x) + \\frac{1}{2}b(x)b'(x)$ 表征。\n\n**3. 确定漂移修正项 $\\Delta(x)$**\n\n问题要求在两种 SDE（Itō SDE 的 $f(x)$ 和 Stratonovich SDE 的 $a(x)$）描述相同物理过程的条件下，它们漂移系数之间的关系。这意味着它们必须导出相同的 Fokker–Planck 方程。问题还指明，乘性噪声振幅函数是相同的，即 $g(x) = b(x)$。\n\n为了使 FPE 相同，它们各自的漂移系数和扩散系数必须相同。\n扩散项是 $\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}[g(x)^2 P]$ 和 $\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}[b(x)^2 P]$。由于 $g(x)=b(x)$，这两项已经相同。\n\n漂移项也必须相同。这意味着令漂移系数相等：\n$$\nA_{\\text{Itō}}(x) = A_{\\text{Strat}}(x)\n$$\n代入我们推导的表达式：\n$$\nf(x) = a(x) + \\frac{1}{2}b(x)b'(x)\n$$\n这个方程是众所周知的等效 Itō 和 Stratonovich SDE 漂移系数之间的转换规则。\n\n问题要求找到表达式 $\\Delta(x)$，使得“Itō 漂移等于 Stratonovich 漂移加上 $\\Delta(x)$”。在我们的记法中，这对应于：\n$$\nf(x) = a(x) + \\Delta(x)\n$$\n通过与推导出的等价条件直接比较，我们可以确定 $\\Delta(x)$：\n$$\n\\Delta(x) = \\frac{1}{2}b(x)b'(x)\n$$\n这是必须加到 Stratonovich 漂移系数 $a(x)$ 上以获得等效 Itō 漂移系数 $f(x)$ 的噪声诱导漂移修正项。",
            "answer": "$$\n\\boxed{\\frac{1}{2} b(x) b'(x)}\n$$"
        },
        {
            "introduction": "理论的优雅必须与计算的可行性相结合。虽然Gillespie直接法（GDM）能够精确模拟随机化学路径，但其计算效率，尤其是在有大量反应通道的系统中，可能成为瓶颈。本练习将焦点从理论转向算法实践，通过分析并比较两种事件选择方法的计算复杂度——简单的线性扫描法和更高效的树形结构法，来揭示数据结构在提升模拟性能中的关键作用 。",
            "id": "4144817",
            "problem": "一个充分混合的化学反应网络使用Gillespie直接法（GDM）进行模拟，在每一步中，根据其倾向（propensity）选择一个反应通道。设有$M$个反应通道，其倾向为$\\{a_{1},a_{2},\\dots,a_{M}\\}$，总倾向为$a_{0}=\\sum_{i=1}^{M} a_{i}$。GDM中的事件选择步骤在$[0,1)$上抽取一个均匀分布的随机变量$u$，并定义一个阈值$r=u\\,a_{0}$，然后选择满足$\\sum_{i=1}^{J} a_{i}\\ge r$的最小索引$J$。\n\n你需要设计并分析两种事件选择例程：\n\n- 例程$\\mathrm{L}$（线性累加和扫描）：预先计算前缀和数组$A_{j}=\\sum_{i=1}^{j} a_{i}$，其中$j\\in\\{1,\\dots,M\\}$，然后线性扫描$A_{1},A_{2},\\dots$，直到首次超过阈值$r$，返回相应的索引。\n\n- 例程$\\mathrm{T}$（使用二叉索引树（BIT）的树状选择法，也称为Fenwick树）：构建一个存储部分和的完全二叉树，使得每个内部节点存储其两个子节点的和，而$M$个叶节点按顺序存储$\\{a_{1},\\dots,a_{M}\\}$。进行选择时，从根节点开始，以查询值$r$反复与左子节点的和进行比较，以决定是向左子节点深入（如果$r$不大于左子节点的和），还是从$r$中减去左子节点的和并向右子节点深入（如果$r$大于左子节点的和），直到到达一个叶节点。\n\n为进行分析，假设$M=2^{k}$（其中$k\\ge 1$为某个整数），并且所有倾向都相等，$a_{i}=\\lambda$对所有$i\\in\\{1,\\dots,M\\}$成立，其中$\\lambda>0$。在选择步骤中，只计算与累加和或部分和的严格比较次数（忽略算术运算和随机数生成成本）。\n\n推导：\n\n- 例程$\\mathrm{L}$在单次选择中执行的严格比较的期望次数。\n- 例程$\\mathrm{T}$在单次选择中执行的严格比较的精确次数。\n\n最后，提供比率\n$$\nR(M)=\\frac{\\mathbb{E}[\\text{例程L的比较次数}]}{\\text{例程T的比较次数}}\n$$\n的闭式表达式，并简化为只含$M$的形式。\n\n你的最终答案必须是这个单一的解析表达式$R(M)$。不要包含任何单位。不要四舍五入或近似；提供一个精确的表达式。",
            "solution": "该问题要求在特定假设下，分析Gillespie直接法（GDM）背景下的两种事件选择例程。我们必须推导线性扫描例程的期望比较次数、树状例程的精确比较次数，以及最后两者的比率。\n\n首先，让我们为选择步骤建立概率基础。在GDM中，如果值$r=u\\,a_{0}$（其中$u \\sim U[0,1)$）落在对应于该反应的区间内，则反应通道$J$被选中。反应$j$的区间是$[\\sum_{i=1}^{j-1} a_{i}, \\sum_{i=1}^{j} a_{i})$。此区间的长度为$a_j$。由于$r$在$[0, a_0)$上均匀分布，选择通道$J$的概率由$P(\\text{select } J) = \\frac{a_J}{a_0}$给出。\n\n问题为分析指定了两个假设：\n1. 反应通道的数量是2的幂，$M=2^{k}$，其中$k \\ge 1$为某个整数。\n2. 所有倾向都相等，$a_{i}=\\lambda$对所有$i \\in \\{1,\\dots,M\\}$成立，其中$\\lambda > 0$。\n\n在这些假设下，总倾向为$a_{0} = \\sum_{i=1}^{M} a_{i} = \\sum_{i=1}^{M} \\lambda = M\\lambda$。\n因此，选择任何特定通道$J$的概率为$P(\\text{select } J) = \\frac{\\lambda}{M\\lambda} = \\frac{1}{M}$。这意味着所选索引$J$是一个在集合$\\{1, 2, \\dots, M\\}$上均匀分布的离散随机变量。\n\n让我们来分析每个例程。\n\n**例程L（线性累加和扫描）的分析**\n\n例程L计算前缀和$A_{j}=\\sum_{i=1}^{j} a_{i}$，然后找到满足$A_{J} \\ge r$的最小索引$J$。搜索过程涉及顺序检查条件$A_{1} \\ge r$，$A_{2} \\ge r$，依此类推，直到在索引$J$处首次满足条件。这个过程需要恰好$J$次比较。设$C_L$为代表例程L比较次数的随机变量。那么$C_L = J$。\n\n我们需要找到期望比较次数$\\mathbb{E}[C_L]$。由于所选索引$J$在$\\{1, 2, \\dots, M\\}$上均匀分布，我们有：\n$$\n\\mathbb{E}[C_L] = \\sum_{J=1}^{M} J \\cdot P(\\text{select } J)\n$$\n代入$P(\\text{select } J) = \\frac{1}{M}$：\n$$\n\\mathbb{E}[C_L] = \\sum_{J=1}^{M} J \\cdot \\frac{1}{M} = \\frac{1}{M} \\sum_{J=1}^{M} J\n$$\n前$M$个整数的和是一个标准的等差数列求和，由$\\frac{M(M+1)}{2}$给出。\n$$\n\\mathbb{E}[C_L] = \\frac{1}{M} \\left( \\frac{M(M+1)}{2} \\right) = \\frac{M+1}{2}\n$$\n所以，例程L的期望比较次数为$\\frac{M+1}{2}$。\n\n**例程T（树状选择法）的分析**\n\n例程T使用一个完全二叉树。树的$M$个叶节点存储各个倾向$\\{a_{1}, a_{2}, \\dots, a_{M}\\}$。每个内部节点存储其子节点值的和。由于$M=2^k$，该树是一个完美二叉树。所有叶节点都在同一深度。设根节点深度为0，叶节点深度为$k$。从根到任一叶节点的路径长度为$k$条边，并经过深度为$0, 1, \\dots, k-1$的节点。\n\n选择算法从根节点开始。在路径上的每个内部节点，它执行一次严格比较：它将当前查询值$r$与该节点左子节点中存储的和进行比较。这个比较决定了是向左子节点还是右子节点深入。这个过程重复进行，直到到达一个叶节点。\n\n在根节点（深度0）进行一次比较，然后在深度1的节点进行一次比较，依此类推，直到深度为$k-1$的节点。算法接着深入到深度为$k$的叶节点，此时搜索终止。因此，对于从根到任一叶节点的任何搜索路径，在$k$个内部节点层级（从0层到$k-1$层）中的每一层都恰好执行一次比较。\n\n设$C_T$为例程T的比较次数。比较次数恰好是$k$，与随机值$r$无关，因此也与最终选择哪个叶节点无关。\n$$\nC_T = k\n$$\n由于$C_T$是一个常数，其期望值也是$k$。问题陈述$M=2^k$。为了用$M$表示$k$，我们取以2为底的对数：\n$$\nk = \\log_{2}(M)\n$$\n因此，例程T的精确比较次数为$\\log_{2}(M)$。\n\n**比率$R(M)$的推导**\n\n问题要求计算比率$R(M) = \\frac{\\mathbb{E}[\\text{例程L的比较次数}]}{\\text{例程T的比较次数}}$。\n我们已经推导出了分子和分母中的两个量：\n$$\n\\mathbb{E}[\\text{例程L的比较次数}] = \\frac{M+1}{2}\n$$\n$$\n\\text{例程T的比较次数} = \\log_{2}(M)\n$$\n将这些代入$R(M)$的表达式中：\n$$\nR(M) = \\frac{\\frac{M+1}{2}}{\\log_{2}(M)}\n$$\n简化表达式，我们得到：\n$$\nR(M) = \\frac{M+1}{2\\log_{2}(M)}\n$$\n这是用$M$表示该比率的最终闭式表达式。",
            "answer": "$$\\boxed{\\frac{M+1}{2\\log_{2}(M)}}$$"
        }
    ]
}