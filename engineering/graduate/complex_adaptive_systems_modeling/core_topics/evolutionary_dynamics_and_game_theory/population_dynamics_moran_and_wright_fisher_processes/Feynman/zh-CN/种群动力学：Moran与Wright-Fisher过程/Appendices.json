{
    "hands_on_practices": [
        {
            "introduction": "分析随机过程的第一步通常是理解其预期的变化方向，即“漂移”（drift）。本练习将指导您直接从莫兰过程的微观规则出发，在弱选择条件下计算漂移项。这个推导是连接微观个体事件与宏观频率动态的关键一步，它揭示了自然选择如何作为一种确定性力量引导等位基因频率的演化。",
            "id": "4137004",
            "problem": "考虑一个大小恒为 $N$ 的均匀混合有限种群，其演化遵循莫兰生灭过程。种群中有 $A$ 和 $B$ 两种类型。在每个微观步骤中，一个个体以与其适应度成正比的概率被选择进行繁殖，同时独立地，另一个个体被均匀随机地选择死亡，并被所选亲本的后代取代。假设适应度分别为 $f_{A} = 1 + s$ 和 $f_{B} = 1$，其中 $|s| \\ll 1$ (弱选择)。设 $i_{t}$表示在离散时间 $t$（以莫兰步长为单位）时 A 类型个体的数量，设 $x_{t} = i_{t}/N$ 表示对应的 A 类型的频率。\n\n仅使用上述过程的定义，推导条件期望 $\\mathbb{E}[x_{t+1} - x_{t} \\mid x_{t}]$，结果保留到 $s$ 的一阶。然后，将按世代重标度的漂移定义为 $b(x_{t}) := N\\,\\mathbb{E}[x_{t+1} - x_{t} \\mid x_{t}]$。证明在弱选择和大 $N$ 极限下，$b(x_{t})$ 存在一个近似表达式，该表达式的精度忽略了当 $N \\to \\infty$ 时会消失的项。提供 $b(x_{t})$ 作为 $s$ 和 $x_t$ 函数的领头阶解析表达式，该表达式对 $s$ 精确到一阶，并在此世代重标度后忽略量级为 $1/N$ 或更小的项。\n\n你的最终答案必须是关于 $s$ 和 $x_{t}$ 的单个闭式解析表达式。无需进行数值舍入。",
            "solution": "该问题提法明确，有科学依据，并包含推导唯一解所需的所有必要信息。我们可以开始推导。\n\n设在时间 $t$ 的种群状态由 A 类型个体的数量 $i_t$ 描述。总种群大小恒为 $N$。因此，B 类型个体的数量为 $N-i_t$。A 类型的频率为 $x_t = i_t/N$。给定的适应度为 $f_A = 1+s$ 和 $f_B = 1$。假设选择系数 $s$ 很小，即 $|s| \\ll 1$。\n\n如上所述，莫兰过程在每个时间步长中包含两个独立事件：繁殖和死亡。\n\n首先，我们确定选择一个个体进行繁殖的概率。这个选择与适应度成正比。种群的总适应度是所有个体适应度的总和：\n$$ W = i_t f_A + (N-i_t) f_B = i_t (1+s) + (N-i_t) (1) = i_t + i_t s + N - i_t = N + i_t s $$\n选择一个 A 类型个体进行繁殖的概率是：\n$$ P(\\text{parent is } A) = \\frac{i_t f_A}{W} = \\frac{i_t(1+s)}{N + i_t s} $$\n选择一个 B 类型个体进行繁殖的概率是：\n$$ P(\\text{parent is } B) = \\frac{(N-i_t) f_B}{W} = \\frac{N-i_t}{N + i_t s} $$\n\n其次，一个个体被均匀随机地选择死亡。一个 A 类型个体被选择死亡的概率是 $i_t/N$，一个 B 类型个体被选择死亡的概率是 $(N-i_t)/N$。\n\nA 类型个体的数量 $i_t$ 可以改变 $+1$、$-1$ 或 $0$。\n如果一个 A 类型个体繁殖且一个 B 类型个体死亡，数量就增加一 ($i_t \\to i_t + 1$)。由于这些事件是独立的，这种转移的概率 $T^+(i_t)$ 是：\n$$ T^+(i_t) = P(\\text{parent is } A) \\times P(\\text{death is } B) = \\frac{i_t(1+s)}{N + i_t s} \\cdot \\frac{N-i_t}{N} $$\n如果一个 B 类型个体繁殖且一个 A 类型个体死亡，数量就减少一 ($i_t \\to i_t - 1$)。这种转移的概率 $T^-(i_t)$ 是：\n$$ T^-(i_t) = P(\\text{parent is } B) \\times P(\\text{death is } A) = \\frac{N-i_t}{N + i_t s} \\cdot \\frac{i_t}{N} $$\n在所有其他情况下，数量保持不变 ($i_t \\to i_t$)。\n\n在一个步骤内，A 个体数量变化 $\\Delta i_t = i_{t+1} - i_t$ 的条件期望是：\n$$ \\mathbb{E}[\\Delta i_t \\mid i_t] = (+1) \\cdot T^+(i_t) + (-1) \\cdot T^-(i_t) + (0) \\cdot (1 - T^+(i_t) - T^-(i_t)) $$\n$$ \\mathbb{E}[\\Delta i_t \\mid i_t] = T^+(i_t) - T^-(i_t) = \\frac{i_t(1+s)(N-i_t)}{N(N + i_t s)} - \\frac{(N-i_t)i_t}{N(N + i_t s)} $$\n$$ \\mathbb{E}[\\Delta i_t \\mid i_t] = \\frac{i_t(N-i_t)}{N(N + i_t s)} \\left[ (1+s) - 1 \\right] = \\frac{s i_t(N-i_t)}{N(N + i_t s)} $$\n现在，我们求频率变化 $x_{t+1} - x_t = \\Delta x_t = \\Delta i_t / N$ 的条件期望。\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] = \\frac{1}{N} \\mathbb{E}[\\Delta i_t \\mid i_t] = \\frac{s i_t(N-i_t)}{N^2(N + i_t s)} $$\n代入 $i_t = N x_t$：\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] = \\frac{s (N x_t)(N - N x_t)}{N^2(N + N x_t s)} = \\frac{s N^2 x_t(1-x_t)}{N^2 \\cdot N(1 + x_t s)} = \\frac{s x_t(1-x_t)}{N(1 + x_t s)} $$\n这是频率条件期望变化的精确表达式。题目要求此表达式精确到 $s$ 的一阶。对于 $|s| \\ll 1$，我们有 $|x_t s| \\ll 1$，因此我们可以对小的 $y$ 使用几何级数展开 $\\frac{1}{1+y} \\approx 1 - y$。\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] \\approx \\frac{s x_t(1-x_t)}{N} (1 - x_t s) = \\frac{s x_t(1-x_t)}{N} - \\frac{s^2 x_t^2(1-x_t)}{N} $$\n精确到 $s$ 的一阶，我们只保留关于 $s$ 的线性项：\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] \\approx \\frac{s x_t(1-x_t)}{N} $$\n接下来，我们将按世代重标度的漂移定义为 $b(x_t) = N\\,\\mathbb{E}[x_{t+1} - x_t \\mid x_t]$。使用频率期望变化的精确表达式，我们得到漂移的精确表达式：\n$$ b(x_t) = N \\left( \\frac{s x_t(1-x_t)}{N(1+x_t s)} \\right) = \\frac{s x_t(1-x_t)}{1+x_t s} $$\n这个表达式是精确的，并且对于这个特定的莫兰过程，它不包含任何量级为 $1/N$ 的项。因此，忽略此类项的条件被自然满足。\n\n最后，题目要求我们提供 $b(x_t)$ 的对 $s$ 精确到一阶的领头阶解析表达式。我们对 $b(x_t)$ 在 $s=0$ 附近进行泰勒展开：\n$$ b(x_t) = s x_t(1-x_t) (1+x_t s)^{-1} $$\n使用展开式 $(1+y)^{-1} = 1 - y + y^2 - \\dots$，其中 $y = x_t s$：\n$$ b(x_t) = s x_t(1-x_t) (1 - x_t s + (x_t s)^2 - \\dots) $$\n$$ b(x_t) = s x_t(1-x_t) - s^2 x_t^2(1-x_t) + O(s^3) $$\n领头阶项是 $s$ 的最低次幂项，即 $s x_t(1-x_t)$。这也是对 $s$ 精确到一阶的表达式，因为它包含了直到并包括 $s^1$ 次幂的所有项。\n因此，漂移系数所需的近似表达式为：\n$$ b(x_t) \\approx s x_t(1-x_t) $$\n这个结果代表了由选择引起的等位基因频率的确定性变化，它构成了种群遗传学中使用的扩散近似的漂移部分。",
            "answer": "$$\n\\boxed{s x_{t}(1 - x_{t})}\n$$"
        },
        {
            "introduction": "计算新突变的最终命运——其固定概率——是群体遗传学的核心目标之一。本练习将引导您完整地实践赖特-费希尔模型的扩散近似方法，从推导漂移和扩散系数，到求解相应的微分方程以获得固定概率。通过这个练习，您将掌握使用连续模型近似离散演化过程并预测其长期结果的强大技术。",
            "id": "4136999",
            "problem": "考虑一个具有两个等位基因的离散世代赖特-费舍尔（WF）模型，其中种群大小为 $N$，等位基因 $A$ 受到基因选择，其相对适应度为 $1+s$，而等位基因 $a$ 的基准适应度为 $1$。设 $x \\in [0,1]$ 表示在给定世代中繁殖前的等位基因 $A$ 的频率，并设 $X'$ 表示下一代中经过繁殖和抽样后等位基因 $A$ 的拷贝数。假设在弱选择和大种群的情况下，扩散近似是有效的，并且时间以世代为单位进行度量。使用以下基本依据：\n- 在一个WF世代中，$X' \\sim \\mathrm{Binomial}(N,p(x))$，其中选择后的抽样概率为 $p(x) = \\frac{x(1+s)}{1+s x}$。\n- 扩散近似从每代频率增量 $\\Delta x = X'/N - x$ 的前两个条件矩中，确定了关于 $s$ 和 $1/N$ 的主导阶的漂移 $m(x)$ 和无穷小方差 $v(x)$。\n- 对于在 $[0,1]$ 上具有漂移 $m(x)$ 和瞬时方差 $v(x)$ 的伊藤扩散，作用于一个二次连续可微的检验函数 $f$ 的向后科尔莫戈罗夫算子形式为 $\\mathcal{L} f(x)$，用 $m(x)$、$v(x)$ 以及 $f$ 关于 $x$ 的导数来表示。\n\n任务：\n1. 从 $p(x) = \\frac{x(1+s)}{1+s x}$ 出发，分别推导赖特-费舍尔扩散的漂移 $m(x)$ 和方差 $v(x)$ 到 $s$ 和 $1/N$ 的主导阶。\n2. 使用一维伊藤扩散的向后科尔莫戈罗夫算子的一般形式以及您在任务1中得到的结果，写出该WF扩散的向后算子 $\\mathcal{L}$。\n3. 设 $u(x)$ 表示从初始频率 $x \\in [0,1]$ 开始，等位基因 $A$ 最终固定（即达到频率1）的概率。使用扩散近似中固定的边值问题，确定 $u(x)$ 关于 $x$、$N$ 和 $s$ 的闭式解析表达式。\n\n您最终报告的答案必须是 $u(x)$ 的单一闭式表达式。无需四舍五入。",
            "solution": "问题要求使用扩散近似，推导赖特-费舍尔种群中一个受选择的等位基因的固定概率。解答过程按照概述的任务分为三个主要阶段：首先，推导扩散过程的漂移和方差系数；其次，构建向后科尔莫戈罗夫算子；第三，求解得到的固定概率的边值问题。\n\n### 任务1：漂移和方差系数的推导\n\n扩散近似将等位基因频率 $x$ 的演化建模为一个连续随机过程。该过程的参数，即漂移系数 $m(x)$ 和无穷小方差（或扩散系数）$v(x)$，是从单代内等位基因频率变化 $\\Delta x = X'/N - x$ 的矩推导出来的。\n\n设 $x$ 为当前世代中等位基因 $A$ 的频率。经过选择后，形成下一代的配子中等位基因 $A$ 的频率为 $p(x) = \\frac{x(1+s)}{1+s x}$。下一代中 $A$ 等位基因的数量 $X'$ 是一个二项随机变量，从 $N$ 次试验中抽取，成功概率为 $p(x)$，即 $X' \\sim \\mathrm{Binomial}(N, p(x))$。\n\n漂移系数 $m(x)$ 是每代等位基因频率的期望变化量。\n$$m(x) = E[\\Delta x | x] = E\\left[\\frac{X'}{N} - x \\bigg| x\\right] = \\frac{E[X'|x]}{N} - x$$\n使用二项分布的期望 $E[X'|x] = Np(x)$，我们有：\n$$m(x) = p(x) - x = \\frac{x(1+s)}{1+s x} - x = \\frac{x(1+s) - x(1+s x)}{1+s x} = \\frac{x+sx-x-sx^2}{1+s x} = \\frac{sx(1-x)}{1+s x}$$\n扩散近似在弱选择 $s \\ll 1$ 时有效。我们将 $m(x)$ 展开到 $s$ 的主导阶。由于 $(1+sx)^{-1} = 1 - sx + O(s^2)$，我们得到：\n$$m(x) = sx(1-x)(1 - sx + \\dots) = sx(1-x) + O(s^2)$$\n因此，对于 $s$ 的主导阶，漂移系数为：\n$$m(x) = sx(1-x)$$\n\n无穷小方差 $v(x)$ 是从等位基因频率变化的二阶矩 $E[(\\Delta x)^2|x]$ 推导出来的。\n$$v(x) = E[(\\Delta x)^2 | x] = E\\left[\\left(\\frac{X'}{N} - x\\right)^2 \\bigg| x\\right]$$\n我们可以将其表示为 $E[(\\Delta x)^2|x] = \\mathrm{Var}(\\Delta x|x) + (E[\\Delta x|x])^2$。\n$\\Delta x$ 的方差是：\n$$\\mathrm{Var}(\\Delta x|x) = \\mathrm{Var}\\left(\\frac{X'}{N} - x \\bigg| x\\right) = \\frac{1}{N^2}\\mathrm{Var}(X'|x)$$\n使用二项分布的方差 $\\mathrm{Var}(X'|x) = Np(x)(1-p(x))$，我们有：\n$$\\mathrm{Var}(\\Delta x|x) = \\frac{Np(x)(1-p(x))}{N^2} = \\frac{p(x)(1-p(x))}{N}$$\n期望的平方项是 $(E[\\Delta x|x])^2 = (m(x))^2 \\approx (sx(1-x))^2 = s^2x^2(1-x)^2$。\n所以，二阶矩为：\n$$v(x) = \\frac{p(x)(1-p(x))}{N} + s^2x^2(1-x)^2$$\n在扩散极限下，我们考虑 $N \\to \\infty$ 和 $s \\to 0$ 且 $Ns$ 为有限值。这意味着 $s$ 的数量级为 $O(1/N)$。因此，项 $s^2x^2(1-x)^2$ 的数量级为 $O(1/N^2)$。第一项 $\\frac{p(x)(1-p(x))}{N}$ 的数量级为 $O(1/N)$，因为 $p(x) \\approx x$。因此，期望的平方项是低阶项，可以忽略。对于 $1/N$ 的主导阶，我们近似 $p(x) \\approx x$：\n$$v(x) \\approx \\frac{x(1-x)}{N}$$\n所以，所需的系数为 $m(x) = sx(1-x)$ 和 $v(x) = \\frac{x(1-x)}{N}$。\n\n### 任务2：向后科尔莫戈罗夫算子\n\n对于由随机微分方程 $dX_t = m(X_t) dt + \\sqrt{v(X_t)} dW_t$ 描述的一维伊藤扩散，其生成元，或称向后科尔莫戈罗夫算子 $\\mathcal{L}$，作用于一个二次连续可微函数 $f(x)$ 的形式为：\n$$\\mathcal{L}f(x) = m(x)\\frac{df}{dx} + \\frac{1}{2}v(x)\\frac{d^2f}{dx^2}$$\n代入在任务1中推导出的 $m(x)$ 和 $v(x)$ 的表达式：\n$$\\mathcal{L}f(x) = sx(1-x)\\frac{df}{dx} + \\frac{1}{2}\\left(\\frac{x(1-x)}{N}\\right)\\frac{d^2f}{dx^2}$$\n这是具有基因选择的赖特-费舍尔扩散的向后算子。\n\n### 任务3：固定概率的推导\n\n从初始频率 $x$ 开始，等位基因 $A$ 最终固定的概率 $u(x)$ 是一个边值问题的解，该问题由以下条件定义：$u(x)$ 是一个使得扩散过程成为鞅的函数，即 $\\mathcal{L}u(x) = 0$，并满足适当的边界条件。\n微分方程为：\n$$sx(1-x)\\frac{du}{dx} + \\frac{x(1-x)}{2N}\\frac{d^2u}{dx^2} = 0$$\n边界条件为 $u(0)=0$（如果等位基因不存在，它不能固定）和 $u(1)=1$（如果等位基因已经固定，其固定概率为1）。\n\n对于 $x \\in (0,1)$，我们可以将方程两边同除以在此区间内非零的 $x(1-x)$：\n$$s\\frac{du}{dx} + \\frac{1}{2N}\\frac{d^2u}{dx^2} = 0$$\n重新整理得到一个二阶线性齐次常微分方程：\n$$\\frac{d^2u}{dx^2} = -2Ns \\frac{du}{dx}$$\n设 $y(x) = \\frac{du}{dx}$。方程变为关于 $y(x)$ 的一阶常微分方程：\n$$\\frac{dy}{dx} = -2Ns y$$\n这是一个可分离方程：$\\frac{1}{y}dy = -2Ns dx$。对两边积分得到：\n$$\\ln|y| = -2Nsx + C_0$$\n$$y(x) = C_1 \\exp(-2Nsx)$$\n其中 $C_1$ 是一个任意常数。由于 $y(x) = \\frac{du}{dx}$，我们再次积分以求得 $u(x)$：\n$$u(x) = \\int C_1 \\exp(-2Nsx) dx = C_1 \\left( \\frac{\\exp(-2Nsx)}{-2Ns} \\right) + C_2$$\n我们可以用两个新的常数 $A$ 和 $B$ 写出通解：\n$$u(x) = A\\exp(-2Nsx) + B$$\n现在我们应用边界条件来确定 $A$ 和 $B$。\n根据 $u(0)=0$：\n$$0 = A\\exp(0) + B \\implies A + B = 0 \\implies B = -A$$\n根据 $u(1)=1$：\n$$1 = A\\exp(-2Ns) + B$$\n代入 $B=-A$：\n$$1 = A\\exp(-2Ns) - A = A(\\exp(-2Ns) - 1)$$\n解出 $A$：\n$$A = \\frac{1}{\\exp(-2Ns) - 1}$$\n那么，$B$ 是：\n$$B = -A = -\\frac{1}{\\exp(-2Ns) - 1} = \\frac{1}{1 - \\exp(-2Ns)}$$\n将 $A$ 和 $B$ 代回 $u(x)$ 的解中：\n$$u(x) = \\frac{1}{\\exp(-2Ns) - 1} \\exp(-2Nsx) + \\frac{1}{1 - \\exp(-2Ns)}$$\n$$u(x) = \\frac{-\\exp(-2Nsx)}{1 - \\exp(-2Ns)} + \\frac{1}{1 - \\exp(-2Ns)}$$\n$$u(x) = \\frac{1 - \\exp(-2Nsx)}{1 - \\exp(-2Ns)}$$\n这就是从频率 $x$ 开始，在大小为 $N$ 的种群中，具有选择系数 $s$ 的等位基因的固定概率 $u(x)$ 的闭式表达式。",
            "answer": "$$\\boxed{\\frac{1 - \\exp(-2Nsx)}{1 - \\exp(-2Ns)}}$$"
        },
        {
            "introduction": "除了关心一个等位基因*是否*会固定，我们还常常想知道，在它确实走向固定的前提下，*需要多长时间*才能完成这一过程。这个更高级的练习旨在计算条件平均固定时间，这需要我们解决一个相关但更复杂的边界值问题。它展示了如何运用相同的扩散理论框架来回答关于演化动力学中更细致的时间尺度问题。",
            "id": "4136932",
            "problem": "考虑一个单一位点等位基因频率过程，在有效种群大小为常数$N$的单倍体种群中，该过程遵循赖特-费舍尔模型的扩散近似，且无突变、无选择（中性漂变）。令$X_{t} \\in [0,1]$表示在时间$t$时等位基因$A$的频率，令$T$为$X_{t}$首次到达吸收集$\\{0,1\\}$的时间。假设标准的赖特-费舍尔扩散算子为\n$$\n\\mathcal{L} f(x) \\;=\\; \\frac{1}{2N}\\, x(1-x)\\, f''(x),\n$$\n作用于在$(0,1)$上二阶连续可微且在$x=0$和$x=1$处有吸收边界的函数$f$。令$h(x)$表示从$X_{0}=x$开始，等位基因$A$在$x=1$处固定的概率，并定义在固定发生的条件下，在$x=1$处固定的条件平均时间为\n$$\n\\tau_{\\text{fix}}(x) \\;=\\; \\mathbb{E}_{x}\\!\\left[T \\,\\big|\\, X_{T}=1\\right], \\quad x \\in (0,1).\n$$\n\n从算子$\\mathcal{L}$、丁金公式以及一维扩散的到达概率和期望到达时间的边值特征出发，推导并求解相应的耦合边值问题，以获得$\\tau_{\\text{fix}}(x)$的闭式解析表达式。或者，您也可以使用杜布h变换，将过程以在$x=1$处固定为条件，然后计算在变换后的动力学下到达$x=1$的平均时间。请用一个包含$x$和$N$的单一解析表达式来表示您的最终答案。无需进行数值舍入，最终表达式中也不应包含任何物理单位。",
            "solution": "问题要求解的是一个有效种群大小为常数$N$的单倍体种群中，从中性等位基因的初始频率$x$开始，其条件平均固定时间$\\tau_{\\text{fix}}(x)$。该量定义为$\\tau_{\\text{fix}}(x) = \\mathbb{E}_{x}[T | X_{T}=1]$，其中$T$是首次到达吸收边界$\\{0,1\\}$的时间。\n\n根据条件期望的定义，我们可以将$\\tau_{\\text{fix}}(x)$写成两个量的比值：\n$$\n\\tau_{\\text{fix}}(x) = \\frac{\\mathbb{E}_{x}[T \\mathbb{I}_{\\{X_{T}=1\\}}]}{\\mathbb{P}_{x}[X_{T}=1]}\n$$\n其中$\\mathbb{I}_{\\{X_{T}=1\\}}$是等位基因在频率为1时固定的事件的指示函数。\n\n我们将分子和分母定义为初始频率$x$的独立函数：\n1. $h(x) = \\mathbb{P}_{x}[X_{T}=1]$：在1处固定的概率。\n2. $k(x) = \\mathbb{E}_{x}[T \\mathbb{I}_{\\{X_{T}=1\\}}]$：吸收时间与在1处固定的指示函数的乘积的期望。\n\n我们将通过求解由给定的赖特-费舍尔扩散算子$\\mathcal{L} f(x) = \\frac{1}{2N} x(1-x) f''(x)$推导出的相应边值问题（BVP）来求出$h(x)$和$k(x)$。\n\n首先，我们确定固定概率$h(x)$。对于一维扩散，先到达一个边界而非另一个边界的概率是向后科尔莫戈罗夫方程$\\mathcal{L}h(x) = 0$的解，其边界条件反映了在边界处的结局。\n$h(x)$的边值问题是：\n$$\n\\mathcal{L}h(x) = \\frac{1}{2N} x(1-x) h''(x) = 0, \\quad \\text{对于 } x \\in (0,1)\n$$\n边界条件为：\n$$\nh(0) = 0 \\quad (\\text{从0开始不可能在1处固定}) \\\\\nh(1) = 1 \\quad (\\text{从1开始必然在1处固定})\n$$\n对于$x \\in (0,1)$，方程简化为$h''(x) = 0$。其通解是一个线性函数$h(x) = C_1 x + C_2$。\n应用边界条件：\n$h(0) = 0 \\implies C_1(0) + C_2 = 0 \\implies C_2 = 0$。\n$h(1) = 1 \\implies C_1(1) + 0 = 1 \\implies C_1 = 1$。\n因此，固定概率为$h(x) = x$。这是中性演化的一个经典结果。\n\n接下来，我们确定$k(x) = \\mathbb{E}_{x}[T \\mathbb{I}_{\\{X_{T}=1\\}}]$。我们可以通过考虑过程在单代内的演化来推导$k(x)$的微分方程。令$X_1$为从$X_0 = x$开始，经过一代后的等位基因频率。量$k(x)$必须满足以下递推关系：\n$$\nk(x) = \\mathbb{E}_{x}[h(X_1) + k(X_1)]\n$$\n其中时间以代为单位。$h(X_1)$项的出现是因为经过了一代（对时间$T$贡献了1），并有$h(X_1)$的概率最终固定。整理并注意到$h(x)$是一个鞅（$\\mathbb{E}_x[h(X_1)]=h(x)$），我们得到$\\mathbb{E}_x[k(X_1) - k(x)] = -h(x)$。\n在扩散极限下，左侧对应于作用在$k(x)$上的算子$\\mathcal{L}$，其中时间单位为一代。因此，$k(x)$是以下泊松型方程的解：\n$$\n\\mathcal{L}k(x) = -h(x)\n$$\n代入$\\mathcal{L}$和$h(x)$的表达式：\n$$\n\\frac{1}{2N} x(1-x) k''(x) = -x, \\quad \\text{对于 } x \\in (0,1)\n$$\n$k(x)$的边界条件由其定义决定。在边界处，吸收时间$T$为0，因此期望必须为0：\n$$\nk(0) = 0 \\\\\nk(1) = 0\n$$\n对于$x \\in (0,1)$，我们可以将微分方程两边同除以$x$：\n$$\n\\frac{1}{2N} (1-x) k''(x) = -1\n$$\n$$\nk''(x) = -\\frac{2N}{1-x}\n$$\n我们将此方程积分两次以求得$k(x)$。第一次积分得到$k'(x)$：\n$$\nk'(x) = \\int -\\frac{2N}{1-t} dt = 2N \\ln(1-x) + C_1\n$$\n第二次积分得到$k(x)$：\n$$\nk(x) = \\int (2N \\ln(1-t) + C_1) dt\n$$\n使用分部积分法计算$\\int \\ln(1-t) dt = -(1-t)\\ln(1-t) + (1-t)$，我们得到：\n$$\nk(x) = 2N \\left( -(1-x)\\ln(1-x) + (1-x) \\right) + C_1 x + C_2\n$$\n$$\nk(x) = -2N(1-x)\\ln(1-x) + 2N(1-x) + C_1 x + C_2\n$$\n现在我们应用边界条件来求解常数$C_1$和$C_2$。\n在$x=0$处：\n$k(0) = 0 \\implies -2N(1-0)\\ln(1-0) + 2N(1-0) + C_1(0) + C_2 = 0$。\n由于$\\ln(1)=0$，这给出$0 + 2N + C_2 = 0 \\implies C_2 = -2N$。\n在$x=1$处：\n$k(1) = 0$。我们必须计算极限$\\lim_{x \\to 1} -2N(1-x)\\ln(1-x)$，其值为0。\n所以，$0 = 0 + 2N(1-1) + C_1(1) + C_2 \\implies 0 = C_1 + C_2$。\n由$C_2=-2N$，我们求得$C_1 = 2N$。\n将常数代回$k(x)$的解中：\n$$\nk(x) = -2N(1-x)\\ln(1-x) + 2N(1-x) + 2Nx - 2N\n$$\n$$\nk(x) = -2N(1-x)\\ln(1-x) + 2N - 2Nx + 2Nx - 2N\n$$\n$$\nk(x) = -2N(1-x)\\ln(1-x)\n$$\n最后，我们计算条件平均固定时间$\\tau_{\\text{fix}}(x)$：\n$$\n\\tau_{\\text{fix}}(x) = \\frac{k(x)}{h(x)} = \\frac{-2N(1-x)\\ln(1-x)}{x}\n$$\n该表达式给出了从初始频率$x$开始，在固定发生的条件下，达到固定所需的平均时间（以代为单位）。",
            "answer": "$$\n\\boxed{-2N \\frac{1-x}{x} \\ln(1-x)}\n$$"
        }
    ]
}