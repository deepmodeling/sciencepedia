## 引言
在[演化生物学](@entry_id:145480)中，理解一个基因或性状如何在群体中随时间变化是核心问题之一。除了自然选择这一确定性力量外，[有限群](@entry_id:139710)体中的随机抽样误差——即[遗传漂变](@entry_id:145594)——也扮演着至关重要的角色。为了精确地量化这些演化力量的相互作用，我们需要强大的数学模型。[莫兰过程](@entry_id:1128160)和赖特-费雪模型正是为此而生的两个基石性框架，它们为我们洞察[等位基因](@entry_id:906209)在群体中的随机命运提供了简洁而深刻的视角。

本文旨在系统性地阐述这两个经典模型及其应用。我们将首先在第一章“原理与机制”中，深入探讨莫兰和赖特-费雪模型的数学构建，推导在[遗传漂变](@entry_id:145594)和选择共同作用下[等位基因](@entry_id:906209)的[固定概率](@entry_id:178551)，并介绍[扩散近似](@entry_id:147930)这一强大的分析工具。接着，在第二章“应用与跨学科联系”中，我们将展示这些看似抽象的模型如何被应用于解决从生态学、微生物学到[癌症演化](@entry_id:155845)和传染病学等多个领域的实际问题。最后，通过第三章“动手实践”，您将有机会通过解决具体问题来巩固和深化对这些核心概念的理解。通过这趟旅程，您将掌握分析群体随机动态的基本工具，并领会其在现代生物科学中的广泛影响力。

## 原理与机制

在[群体遗传学](@entry_id:146344)中，为了理解[等位基因频率](@entry_id:146872)在世代间的动态变化，我们构建了多种[随机过程模型](@entry_id:272197)。这些模型是理解[遗传漂变](@entry_id:145594)、自然选择、突变和迁移等进化力量如何共同塑造群体遗传结构的基础。本章将深入探讨两个奠基性的随机模型——赖特-费雪模型和[莫兰模型](@entry_id:195772)——的数学原理和核心机制。我们将从这些模型的基[本构建模](@entry_id:183370)块出发，推导出关键的量，如等位基因的[固定概率](@entry_id:178551)，并展示它们如何被扩展以包含选择效应，最终通过扩散近似连接到连续的分析框架。

### 基本随机模型：[遗传漂变](@entry_id:145594)的构建模块

群体遗传动态的随机性主要来源于[有限群](@entry_id:139710)体中的[抽样误差](@entry_id:182646)，即**[遗传漂变](@entry_id:145594) (genetic drift)**。为了精确刻画这一过程，我们将群体中的[等位基因](@entry_id:906209)数量变化模拟为一个**[马尔可夫链](@entry_id:150828) (Markov chain)**。假设一个大小恒为 $N$ 的单倍体群体，其中有两种等位基因 $A$ 和 $a$。我们可以用[状态变量](@entry_id:138790) $X_t$ 表示在时间点 $t$ 时 $A$ 等位基因的数量，其取值范围为 $\{0, 1, \dots, N\}$。这个过程的核心是**[马尔可夫性质](@entry_id:139474) (Markov property)**，即系统的未来状态只依赖于当前状态，而与过去的历史无关。这一性质可以通过[一步转移概率](@entry_id:272678) $P_{ij} = \Pr(X_{t+1} = j \mid X_t = i)$ 来精确描述。如果这些概率不随时间 $t$ 变化，该链就是时间齐次的。

#### 赖特-费雪模型

**赖特-费雪 (Wright-Fisher, WF) 模型**是[群体遗传学](@entry_id:146344)中最经典的模型之一。它假设世代不重叠，并且群体的下一代是通过对上一代进行有放回的抽样产生的。具体来说，如果当前（第 $t$ 代）群体中 $A$ [等位基因](@entry_id:906209)的数量为 $i$，那么其频率为 $x_t = i/N$。下一代（第 $t+1$ 代）的 $N$ 个个体是从上一代[基因库](@entry_id:267957)中独立随机抽取的 $N$ 个基因拷贝。

在最简单的**中性 (neutral)** 情况下，即没有选择作用时，每次抽样的基因是 $A$ 的概率等于其在亲代中的频率 $i/N$。因此，下一代中 $A$ [等位基因](@entry_id:906209)的数量 $X_{t+1}$ 就服从一个[二项分布](@entry_id:141181)，其参数为试验次数 $N$ 和成功概率 $p = i/N$。即 $X_{t+1} \mid (X_t=i) \sim \text{Binomial}(N, i/N)$。

由此，我们可以写出WF模型的[一步转移概率](@entry_id:272678) ：
$$
P_{ij} = \Pr(X_{t+1} = j \mid X_t = i) = \binom{N}{j} \left(\frac{i}{N}\right)^j \left(1 - \frac{i}{N}\right)^{N-j}
$$
这个公式构成了中性WF模型的基础。状态 $i=0$（等位基因 $A$ 丢失）和 $i=N$（[等位基因](@entry_id:906209) $A$ 固定）是**[吸收态](@entry_id:161036) (absorbing states)**，一旦进入这些状态，系统将不再改变。

#### [莫兰模型](@entry_id:195772)

与WF模型不同，**莫兰 (Moran) 模型**描述了一个世代重叠的群体。在每个离散的时间步，群体中只发生一次出生和一次死亡事件，从而保持总人口 $N$ 不变。一个经典的版本是**出生-死亡 (Birth-Death)** 过程：首先选择一个个体进行繁殖，然后随机选择另一个个体死亡，并由前者产生的后代取而代之。

在中性情况下，任何个体被选中繁殖或死亡的概率都是均等的，即 $1/N$。我们来计算状态 $i$（$A$ 个体的数量）发生变化的转移概率。
- 状态从 $i$ 增加到 $i+1$：这需要一个 $A$ 类型的个体（被选中的概率为 $i/N$）繁殖，并且一个 $a$ 类型的个体（被选中的概率为 $(N-i)/N$）死亡。由于选择是独立的，该转移概率为 $P_{i \to i+1} = \frac{i}{N} \cdot \frac{N-i}{N} = \frac{i(N-i)}{N^2}$。
- 状态从 $i$ 减少到 $i-1$：这需要一个 $a$ 类型的个体（概率 $(N-i)/N$）繁殖，并且一个 $A$ 类型的个体（概率 $i/N$）死亡。该转移概率为 $P_{i \to i-1} = \frac{N-i}{N} \cdot \frac{i}{N} = \frac{i(N-i)}{N^2}$。
- 状态保持为 $i$：如果繁殖和死亡的个体类型相同（均为 $A$ 或均为 $a$），状态不变。其概率为 $P_{i \to i} = 1 - P_{i \to i+1} - P_{i \to i-1} = 1 - \frac{2i(N-i)}{N^2}$。

[莫兰模型](@entry_id:195772)的时间步长比WF模型小得多。直观上，WF模型的一代相当于[莫兰模型](@entry_id:195772)中的 $N$ 个时间步，因为平均而言，每个个体需要经过 $N$ 次死亡事件才能被替换一次。

### 自然选择的角色

当不同基因型具有不同的生存或繁殖能力时，自然选择便开始发挥作用。我们可以将选择整合到上述两个模型中。

#### 赖特-费雪模型中的选择

在WF模型中，选择通常被建模为对亲代[基因库](@entry_id:267957)的加权贡献。假设 $A$ [等位基因](@entry_id:906209)的[相对适应度](@entry_id:153028)为 $1+s$，$a$ 等位基因的[适应度](@entry_id:154711)为 $1$。在形成下一代之前，我们可以想象一个中间的“选择后”[基因库](@entry_id:267957)。

在当前频率为 $x_t = i/N$ 时，群体中 $A$ 和 $a$ 的相对贡献分别为 $x_t(1+s)$ 和 $(1-x_t) \cdot 1$。群体的平均适应度为 $\bar{w} = x_t(1+s) + (1-x_t) = 1+sx_t$。因此，经过选择后，$A$ 等位基因在有效[基因库](@entry_id:267957)中的频率 $p_t$ 变为 ：
$$
p_t = \frac{x_t(1+s)}{\bar{w}} = \frac{x_t(1+s)}{1+sx_t}
$$
下一代的形成仍然是通过对这个新的有效[基因库](@entry_id:267957)进行 $N$ 次二项抽样，但成功概率现在是 $p_t$。因此，带有选择的WF模型的转移概率为：
$$
\Pr(X_{t+1} = j \mid X_t = i) = \binom{N}{j} (p_i)^j (1-p_i)^{N-j}
$$
其中 $p_i = \frac{i(1+s)/N}{1+s(i/N)} = \frac{i(1+s)}{N+si}$。这个公式精确地描述了选择和漂变如何在WF框架下相互作用 。

#### [莫兰模型](@entry_id:195772)中的选择

在[莫兰模型](@entry_id:195772)中，选择可以通过使繁殖概率与适应度成正比来实现。假设 $A$ 类型的[适应度](@entry_id:154711)为 $f_A$，$a$ 类型的适应度为 $f_a$。在出生-死亡过程中，选择一个个体进行繁殖的概率不再是均等的。

群体总[适应度](@entry_id:154711)为 $F_{total} = i f_A + (N-i)f_a$。选择一个 $A$ 类型个体繁殖的概率是 $\frac{i f_A}{F_{total}}$，选择一个 $a$ 类型个体繁殖的概率是 $\frac{(N-i)f_a}{F_{total}}$。死亡个体的选择仍然是均匀随机的。

因此，转移概率变为 ：
- **状态增加 ($i \to i+1$)**：一个 $A$ 繁殖，一个 $a$ 死亡。
$$
P_{i \to i+1} = \left( \frac{i f_A}{i f_A + (N-i) f_a} \right) \times \left( \frac{N-i}{N} \right)
$$
- **状态减少 ($i \to i-1$)**：一个 $a$ 繁殖，一个 $A$ 死亡。
$$
P_{i \to i-1} = \left( \frac{(N-i) f_a}{i f_A + (N-i) f_a} \right) \times \left( \frac{i}{N} \right)
$$
这些公式是分析[莫兰模型](@entry_id:195772)中选择效应的基础。一个非常重要的量是这两个概率的比值。定义[相对适应度](@entry_id:153028) $r = f_A/f_a$，我们可以惊人地发现 ：
$$
\frac{P_{i \to i+1}}{P_{i \to i-1}} = \frac{\frac{i f_A (N-i)}{N \cdot F_{total}}  }{\frac{(N-i) f_a i}{N \cdot F_{total}}} = \frac{f_A}{f_a} = r
$$
这个比率竟然与当前状态 $i$ 和群体大小 $N$ 无关，仅取决于[相对适应度](@entry_id:153028) $r$。这个简洁的结果对于计算[固定概率](@entry_id:178551)至关重要。

有趣的是，选择机制的微观实现方式会影响模型的动态。例如，除了上面描述的“出生-死亡”（BD）过程，我们还可以定义一个“死亡-出生”（DB）过程：首先根据适应度的倒数选择一个个体死亡，然后从剩余的 $N-1$ 个个体中随机选择一个进行繁殖。可以证明，虽然BD和DB过程的转移概率 $p_i$ 和 $q_i$ 本身不同，但它们的比率 $q_i/p_i$ 却完全相同，都等于 $1/r$。这意味着这两种模型会产生完全相同的[固定概率](@entry_id:178551)，但由于状态转移的总速率 $p_i+q_i$ 不同，它们的平均固定时间通常是不同的 。这揭示了模型构建中的一个深刻观点：不同的微观动力学可以产生相同的宏观长期结果。

### [等位基因](@entry_id:906209)的最终命运：固定与灭绝

由于[遗传漂变](@entry_id:145594)，一个[等位基因](@entry_id:906209)最终的命运只有两种：从群体中完全消失（**灭绝 (extinction)**，状态 $0$）或取代所有其他等位基因（**固定 (fixation)**，状态 $N$）。一个核心问题是，一个初始数量为 $i$ 的[等位基因](@entry_id:906209)，其最终被固定的概率是多少？我们称之为**[固定概率](@entry_id:178551) (fixation probability)**，记为 $\rho_i$。

#### 中性[固定概率](@entry_id:178551)

在中性情况下，我们可以通过一个优雅的类比来求解。考虑中性[莫兰过程](@entry_id:1128160)，我们已经看到，状态增加和减少的概率是相等的：$P_{i \to i+1} = P_{i \to i-1} = \frac{i(N-i)}{N^2}$。如果我们只关注状态发生改变的时刻（即忽略[状态保持](@entry_id:1132308)不变的事件），那么状态向上或向下移动一步的[条件概率](@entry_id:151013)都是 $1/2$。

这完[全等](@entry_id:273198)价于一个经典的**赌徒破产问题 (gambler's ruin problem)**：一个拥有 $i$ 元资本的赌徒，在总资本为 $N$ 元的赌局中，每次等概率地赢或输一元，直到他输光所有钱（破产在 $0$）或赢得所有钱（胜利在 $N$）。这个问题的经典解是，赌徒最终赢得所有钱的概率等于其初始资本占总资本的比例。因此，一个初始数量为 $i$ 的中性[等位基因](@entry_id:906209)的[固定概率](@entry_id:178551)为 ：
$$
\rho_i = \frac{i}{N}
$$
这个结果非常直观：在中性进化中，一个等位基因的最终命运完全取决于它在群体中的初始频率。

#### 选择下的[固定概率](@entry_id:178551)

当存在选择时，情况变得复杂，但我们仍然可以求解。对于[莫兰过程](@entry_id:1128160)，我们已经知道转移概率的比值为 $\gamma_i = q_i/p_i = 1/r$。[固定概率](@entry_id:178551) $\rho_i$ 必须满足一个递归关系：
$$
\rho_i = p_i \rho_{i+1} + q_i \rho_{i-1} + (1-p_i-q_i)\rho_i
$$
整理后得到 $\rho_{i+1} - \rho_i = \frac{q_i}{p_i} (\rho_i - \rho_{i-1}) = \frac{1}{r}(\rho_i - \rho_{i-1})$。这是一个关于差分 $\Delta_i = \rho_i - \rho_{i-1}$ 的[几何级数](@entry_id:158490)关系。通过对这个级数求和，并利用边界条件 $\rho_0 = 0$ 和 $\rho_N = 1$，我们可以解出[固定概率](@entry_id:178551)的精确表达式  ：
$$
\rho_i = \frac{1 - r^{-i}}{1 - r^{-N}}
$$
这个公式是[群体遗传学](@entry_id:146344)的一个基石。我们可以验证，当选择消失时，即 $r \to 1$，通过[洛必达法则](@entry_id:147503)，该公式可以恢复为中性结果 $\rho_i = i/N$。

### [扩散近似](@entry_id:147930)：一种连续的视角

当群体规模 $N$ 很大时，离散的[马尔可夫链模型](@entry_id:269720)在计算上变得非常棘手。此时，我们可以使用**[扩散近似](@entry_id:147930) (diffusion approximation)**，将离散的[等位基因](@entry_id:906209)数量（或频率）视为一个连续的[随机过程](@entry_id:268487)，用[随机微分方程](@entry_id:146618)（SDE）来描述。[等位基因频率](@entry_id:146872) $x$ 的变化由两部分描述：一个确定性的**漂移项 (drift term)** $m(x)$，代表选择等系统性力量的平均效应；以及一个随机的**扩散项 (diffusion term)** $\sqrt{v(x)}dW_t$，代表[遗传漂变](@entry_id:145594)的随机波动。

[固定概率](@entry_id:178551) $u(x)$（连续变量下的 $\rho_i$）满足一个称为**柯尔莫哥洛夫向后方程 (Kolmogorov backward equation)** 的[二阶常微分方程](@entry_id:204212)：
$$
0 = m(x) \frac{du}{dx} + \frac{v(x)}{2} \frac{d^2u}{dx^2}
$$
边界条件为 $u(0)=0$ 和 $u(1)=1$。

#### 中性情况

在中性进化中，没有系统性的力量推动频率朝任何特定方向变化，因此漂移项 $m(x)=0$。扩散项 $v(x)$ 对于WF和[莫兰模型](@entry_id:195772)，在适当的时间尺度下，都近似为 $\frac{x(1-x)}{N}$（对于单倍体模型）。向后方程简化为 ：
$$
\frac{x(1-x)}{2N} \frac{d^2u}{dx^2} = 0
$$
在 $x \in (0,1)$ 的区间内，$x(1-x)>0$，因此必然有 $u''(x)=0$。积分两次得到通解 $u(x) = c_1 x + c_2$。应用边界条件 $u(0)=0$ 和 $u(1)=1$，我们立即解得 $c_1=1, c_2=0$。因此，[固定概率](@entry_id:178551)为：
$$
u(x) = x
$$
这与我们从离散模型得到的结论完全一致，验证了扩散近似的有效性。

#### 弱选择情况

当存在弱选择时（即 $s$ 很小），漂移项 $m(x) \approx s x(1-x)$。向后方程变为 ：
$$
0 = s x(1-x) u'(x) + \frac{x(1-x)}{2N} u''(x)
$$
同样，我们可以消去 $x(1-x)$ 项，得到 $u''(x) + 2Ns u'(x) = 0$。这是一个可以通过降阶求解的线性ODE。其解（在应用边界条件后）是[群体遗传学](@entry_id:146344)中另一个里程碑式的结果，由 [Motoo Kimura](@entry_id:153912) 导出：
$$
u(x) = \frac{1 - \exp(-2Nsx)}{1 - \exp(-2Ns)}
$$
这个公式非常强大，它统一描述了弱选择和[遗传漂变](@entry_id:145594)共同作用下等位基因的命运。例如，对于一个具有选择优势（$s>0$）的单个新突变（在单倍体群体中，$x=1/N$），其[固定概率](@entry_id:178551)约为 $2s$（假设 $Ns \gg 1$）。这表明，即使是有利的突变，其命运在很大程度上也受制于随机漂变，并且绝大多数都会丢失。

### 连接理论与现实：有效群体大小

我们至今所用的模型都假设了一个高度理想化的群体。然而，真实群体的繁殖方式、性别比例和世代大小都可能偏离理想状态。为了将这些理论模型应用于现实世界，[群体遗传学](@entry_id:146344)家引入了**有效群体大小 (effective population size)**，记为 $N_e$ 的概念。

$N_e$ 是一个理想化群体（通常是WF模型）的大小，该群体中[遗传漂变](@entry_id:145594)的强度与我们正在研究的实际群体相同。定义 $N_e$ 的方式有多种，其中一种是**方差有效大小 (variance effective size)**，它要求理想群体的[等位基因频率](@entry_id:146872)变化方差与实际群体相匹配。对于一个[二倍体](@entry_id:268054)群体，定义如下 ：
$$
\mathrm{Var}(p_{t+1} - p_t \mid p_t) = \frac{p_t(1 - p_t)}{2N_e}
$$
例如，如果一个群体的普查大小为 $N$，但个体产生的后代数量（配子贡献）的方差 $V_k$ 不等于理想WF模型中的值（泊松分布时 $V_k \approx \bar{k} = 2$），那么其有效大小会偏离 $N$。可以推导出，此时的 $N_e$ 为：
$$
N_e = \frac{4N-2}{V_k+2}
$$
如果[繁殖成功率](@entry_id:166712)的方差 $V_k$ 很大（即少数个体产生了大部分后代），$N_e$ 将会远小于普查大小 $N$，这意味着[遗传漂变](@entry_id:145594)效应被大大增强了。

此外，如果群体大小随时间波动，长期的有效群体大小并不是各代大小的[算术平均值](@entry_id:165355)，而是**[调和平均](@entry_id:750175)数 (harmonic mean)**。如果一个群体在 $T$ 个世代中的有效大小分别为 $N_{e,1}, N_{e,2}, \dots, N_{e,T}$，那么这段时间内的总有效大小 $N_e$ 由以下关系给出 ：
$$
\frac{1}{N_e} = \frac{1}{T} \sum_{t=1}^{T} \frac{1}{N_{e,t}}
$$
由于调和平均数对较小值非常敏感，这意味着群体经历的“瓶颈期”（即 $N_e$ 暂时变得很小的时期）会对长期的[遗传多样性](@entry_id:201444)产生不成比例的巨大影响。因此，在所有关于[遗传漂变](@entry_id:145594)和选择的讨论中，真正关键的参数是有效群体大小 $N_e$，而非普查大小 $N$。