{
    "hands_on_practices": [
        {
            "introduction": "本练习将带您从第一性原理出发，深入理解莫兰过程。通过直接从个体出生和死亡的微观规则推导等位基因频率的期望变化（即漂移项），您将掌握如何将个体层面的随机事件与群体宏观演化动态联系起来。这项基本功是理解更复杂随机过程的基础。",
            "id": "4137004",
            "problem": "考虑一个大小恒为 $N$ 的充分混合的有限种群，其根据 Moran 生死过程演化。种群中有两种类型，$A$ 和 $B$。在每个微观步骤中，一个个体以与其适应度成正比的概率被选择进行繁殖，同时独立地，另一个个体被均匀随机地选择死亡，并被所选亲本的后代取代。假设适应度分别为 $f_{A} = 1 + s$ 和 $f_{B} = 1$，其中 $|s| \\ll 1$（弱选择）。令 $i_t$ 表示在离散时间 $t$（以 Moran 步骤为单位计量）时 A 型个体的数量，令 $x_t = i_t/N$ 表示对应的 A 型频率。\n\n仅使用上述过程定义，推导条件期望 $\\mathbb{E}[x_{t+1} - x_t \\mid x_t]$，结果精确到 $s$ 的一阶。然后，定义按世代重标度的漂移为 $b(x_t) := N\\,\\mathbb{E}[x_{t+1} - x_t \\mid x_t]$。在弱选择和大 $N$ 的情况下，证明 $b(x_t)$ 存在一个近似，该近似在忽略随 $N \\to \\infty$ 而消失的项之后是准确的。提供 $b(x_t)$ 关于 $s$ 和 $x_t$ 的领头阶解析表达式，该表达式在忽略了经过此世代重标度后 $1/N$ 阶或更小的项之后，对于 $s$ 精确到一阶。\n\n你的最终答案必须是关于 $s$ 和 $x_t$ 的单一闭式解析表达式。无需进行数值舍入。",
            "solution": "该问题是良定的，有科学依据，并包含了推导唯一解所需的所有信息。我们可以开始推导。\n\n令在时间 $t$ 的种群状态由 A 型个体的数量 $i_t$ 来描述。总种群大小恒为 $N$。因此，B 型个体的数量为 $N-i_t$。A 型的频率为 $x_t = i_t/N$。适应度给定为 $f_A = 1+s$ 和 $f_B = 1$。选择系数 $s$ 假定很小，即 $|s| \\ll 1$。\n\n所述的 Moran 过程在每个时间步中包含两个独立事件：繁殖和死亡。\n\n首先，我们确定选择一个个体进行繁殖的概率。这个选择与适应度成正比。种群的总适应度是所有个体适应度的总和：\n$$ W = i_t f_A + (N-i_t) f_B = i_t (1+s) + (N-i_t) (1) = i_t + i_t s + N - i_t = N + i_t s $$\n选择一个 A 型个体进行繁殖的概率是：\n$$ P(\\text{parent is } A) = \\frac{i_t f_A}{W} = \\frac{i_t(1+s)}{N + i_t s} $$\n选择一个 B 型个体进行繁殖的概率是：\n$$ P(\\text{parent is } B) = \\frac{(N-i_t) f_B}{W} = \\frac{N-i_t}{N + i_t s} $$\n\n其次，一个个体被均匀随机地选择死亡。一个 A 型个体被选择死亡的概率是 $i_t/N$，一个 B 型个体被选择死亡的概率是 $(N-i_t)/N$。\n\nA 型个体的数量 $i_t$ 可以变化 $+1$、$-1$ 或 $0$。\n如果一个 A 型个体繁殖并且一个 B 型个体死亡，数量就增加一 ($i_t \\to i_t + 1$)。由于这些事件是独立的，这个转移的概率 $T^+(i_t)$ 是：\n$$ T^+(i_t) = P(\\text{parent is } A) \\times P(\\text{death is } B) = \\frac{i_t(1+s)}{N + i_t s} \\cdot \\frac{N-i_t}{N} $$\n如果一个 B 型个体繁殖并且一个 A 型个体死亡，数量就减少一 ($i_t \\to i_t - 1$)。这个转移的概率 $T^-(i_t)$ 是：\n$$ T^-(i_t) = P(\\text{parent is } B) \\times P(\\text{death is } A) = \\frac{N-i_t}{N + i_t s} \\cdot \\frac{i_t}{N} $$\n在所有其他情况下，数量保持不变 ($i_t \\to i_t$)。\n\n在一个步骤中 A 型个体数量变化的条件期望 $\\Delta i_t = i_{t+1} - i_t$ 是：\n$$ \\mathbb{E}[\\Delta i_t \\mid i_t] = (+1) \\cdot T^+(i_t) + (-1) \\cdot T^-(i_t) + (0) \\cdot (1 - T^+(i_t) - T^-(i_t)) $$\n$$ \\mathbb{E}[\\Delta i_t \\mid i_t] = T^+(i_t) - T^-(i_t) = \\frac{i_t(1+s)(N-i_t)}{N(N + i_t s)} - \\frac{(N-i_t)i_t}{N(N + i_t s)} $$\n$$ \\mathbb{E}[\\Delta i_t \\mid i_t] = \\frac{i_t(N-i_t)}{N(N + i_t s)} \\left[ (1+s) - 1 \\right] = \\frac{s i_t(N-i_t)}{N(N + i_t s)} $$\n现在，我们求频率变化的条件期望，$x_{t+1} - x_t = \\Delta x_t = \\Delta i_t / N$。\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] = \\frac{1}{N} \\mathbb{E}[\\Delta i_t \\mid i_t] = \\frac{s i_t(N-i_t)}{N^2(N + i_t s)} $$\n代入 $i_t = N x_t$：\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] = \\frac{s (N x_t)(N - N x_t)}{N^2(N + N x_t s)} = \\frac{s N^2 x_t(1-x_t)}{N^2 \\cdot N(1 + x_t s)} = \\frac{s x_t(1-x_t)}{N(1 + x_t s)} $$\n这是频率变化的条件期望的精确表达式。题目要求此表达式精确到 $s$ 的一阶。对于 $|s| \\ll 1$，我们有 $|x_t s| \\ll 1$，因此对于小的 $y$，我们可以使用几何级数展开 $\\frac{1}{1+y} \\approx 1 - y$。\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] \\approx \\frac{s x_t(1-x_t)}{N} (1 - x_t s) = \\frac{s x_t(1-x_t)}{N} - \\frac{s^2 x_t^2(1-x_t)}{N} $$\n精确到 $s$ 的一阶，我们只保留 $s$ 的线性项：\n$$ \\mathbb{E}[x_{t+1} - x_t \\mid x_t] \\approx \\frac{s x_t(1-x_t)}{N} $$\n接下来，我们定义按世代重标度的漂移为 $b(x_t) = N\\,\\mathbb{E}[x_{t+1} - x_t \\mid x_t]$。使用频率期望变化的精确表达式，我们得到漂移的精确表达式：\n$$ b(x_t) = N \\left( \\frac{s x_t(1-x_t)}{N(1+x_t s)} \\right) = \\frac{s x_t(1-x_t)}{1+x_t s} $$\n这个表达式是精确的，并且对于这个特定的 Moran 过程，不包含 $1/N$ 阶的项。因此，忽略此类项的条件被自然满足。\n\n最后，题目要求我们提供 $b(x_t)$ 的领头阶解析表达式，且对 $s$ 精确到一阶。我们对 $b(x_t)$ 在 $s=0$ 附近进行泰勒展开：\n$$ b(x_t) = s x_t(1-x_t) (1+x_t s)^{-1} $$\n使用展开式 $(1+y)^{-1} = 1 - y + y^2 - \\dots$，其中 $y = x_t s$：\n$$ b(x_t) = s x_t(1-x_t) (1 - x_t s + (x_t s)^2 - \\dots) $$\n$$ b(x_t) = s x_t(1-x_t) - s^2 x_t^2(1-x_t) + O(s^3) $$\n领头阶项是 $s$ 的最低次幂项，即 $s x_t(1-x_t)$。这也是对 $s$ 精确到一阶的表达式，因为它包含了直到并包括 $s^1$ 次幂的所有项。\n因此，所要求的漂移系数的近似表达式是：\n$$ b(x_t) \\approx s x_t(1-x_t) $$\n这个结果代表了由选择引起的等位基因频率的确定性变化，它构成了种群遗传学中使用的扩散近似的漂移部分。",
            "answer": "$$\n\\boxed{s x_{t}(1 - x_{t})}\n$$"
        },
        {
            "introduction": "这是理论群体遗传学中的一个经典练习，旨在演示如何运用扩散近似这一强大工具。您将从离散的赖特-费雪模型出发，推导出其连续的扩散近似，并最终求解一个关键的演化量——固定概率。这个过程展示了分析复杂随机群体模型的一种核心方法。",
            "id": "4136999",
            "problem": "考虑一个具有两个等位基因的离散世代 Wright-Fisher (WF) 模型，其中种群大小为 $N$，等位基因 $A$ 受到基因选择，其相对适应度为 $1+s$，而等位基因 $a$ 的基准适应度为 $1$。设 $x \\in [0,1]$ 表示在给定世代繁殖前等位基因 $A$ 的频率，并设 $X'$ 表示下一代经过繁殖和抽样后等位基因 $A$ 的拷贝数。假设在弱选择和大种群的情况下，扩散近似有效，且时间以世代为单位进行度量。使用以下基本依据：\n- 在一个 WF 世代中，$X' \\sim \\mathrm{Binomial}(N,p(x))$，其中选择后的抽样概率为 $p(x) = \\frac{x(1+s)}{1+s x}$。\n- 扩散近似从每代频率增量 $\\Delta x = X'/N - x$ 的前两个条件矩中，分别确定了漂移 $m(x)$ 和无穷小方差 $v(x)$ 在 $s$ 和 $1/N$ 的主导阶。\n- 对于在 $[0,1]$ 上，漂移为 $m(x)$、瞬时方差为 $v(x)$ 的 Itô 扩散，作用于一个二次连续可微检验函数 $f$ 的向后 Kolmogorov 算子形式为 $\\mathcal{L} f(x)$，用 $m(x)$、$v(x)$ 以及 $f$ 对 $x$ 的导数来表示。\n\n任务：\n1. 从 $p(x) = \\frac{x(1+s)}{1+s x}$ 出发，分别推导 Wright-Fisher 扩散的漂移 $m(x)$ 和方差 $v(x)$ 在 $s$ 和 $1/N$ 上的主导阶。\n2. 使用一维 Itô 扩散的向后 Kolmogorov 算子的一般形式以及任务 1 的结果，写出此 WF 扩散的向后算子 $\\mathcal{L}$。\n3. 设 $u(x)$ 表示从初始频率 $x \\in [0,1]$ 开始，等位基因 $A$ 最终固定（即达到频率 1）的概率。利用扩散近似中关于固定的边值问题，确定 $u(x)$ 关于 $x$、$N$ 和 $s$ 的闭式解析表达式。\n\n您的最终报告答案必须是 $u(x)$ 的单个闭式表达式。无需四舍五入。",
            "solution": "此问题要求使用扩散近似法，推导在 Wright-Fisher 种群中一个被选择的等位基因的固定概率。根据所列出的任务，解答过程分为三个主要阶段：首先，推导扩散过程的漂移系数和方差系数；其次，构建向后 Kolmogorov 算子；第三，求解由此产生的关于固定概率的边值问题。\n\n### 任务 1：漂移和方差系数的推导\n\n扩散近似将等位基因频率 $x$ 的演化建模为一个连续随机过程。该过程的参数，即漂移系数 $m(x)$ 和无穷小方差（或扩散系数）$v(x)$，是从单个世代内等位基因频率变化 $\\Delta x = X'/N - x$ 的矩推导出来的。\n\n设 $x$ 为当前世代中等位基因 $A$ 的频率。选择之后，形成下一代的配子中等位基因 $A$ 的频率为 $p(x) = \\frac{x(1+s)}{1+s x}$。下一代中 $A$ 等位基因的数量 $X'$ 是一个二项随机变量，从 $N$ 次试验中抽取，成功概率为 $p(x)$，即 $X' \\sim \\mathrm{Binomial}(N, p(x))$。\n\n漂移系数 $m(x)$ 是每代等位基因频率的期望变化。\n$$m(x) = E[\\Delta x | x] = E\\left[\\frac{X'}{N} - x \\bigg| x\\right] = \\frac{E[X'|x]}{N} - x$$\n利用二项分布的期望 $E[X'|x] = Np(x)$，我们有：\n$$m(x) = p(x) - x = \\frac{x(1+s)}{1+s x} - x = \\frac{x(1+s) - x(1+s x)}{1+s x} = \\frac{x+sx-x-sx^2}{1+s x} = \\frac{sx(1-x)}{1+s x}$$\n扩散近似在弱选择（$s \\ll 1$）时有效。我们将 $m(x)$ 展开至 $s$ 的主导阶。由于 $(1+sx)^{-1} = 1 - sx + O(s^2)$，我们得到：\n$$m(x) = sx(1-x)(1 - sx + \\dots) = sx(1-x) + O(s^2)$$\n因此，在 $s$ 的主导阶上，漂移系数为：\n$$m(x) = sx(1-x)$$\n\n无穷小方差 $v(x)$ 是从等位基因频率变化的二阶矩 $E[(\\Delta x)^2|x]$ 推导出来的。在扩散极限中，我们只关心其主导项，它等于频率变化的方差。\n$$v(x) \\approx \\mathrm{Var}(\\Delta x|x) = \\mathrm{Var}\\left(\\frac{X'}{N} - x \\bigg| x\\right) = \\frac{1}{N^2}\\mathrm{Var}(X'|x)$$\n利用二项分布的方差 $\\mathrm{Var}(X'|x) = Np(x)(1-p(x))$，我们有：\n$$\\mathrm{Var}(\\Delta x|x) = \\frac{Np(x)(1-p(x))}{N^2} = \\frac{p(x)(1-p(x))}{N}$$\n在扩散极限中，我们考虑 $N \\to \\infty$ 和 $s \\to 0$。$s$ 的阶小于 $1/N$ 的阶，所以我们可以近似 $p(x) \\approx x$ 来求 $v(x)$ 的主导阶：\n$$v(x) \\approx \\frac{x(1-x)}{N}$$\n所以，所需的系数为 $m(x) = sx(1-x)$ 和 $v(x) = \\frac{x(1-x)}{N}$。\n\n### 任务 2：向后 Kolmogorov 算子\n\n对于由随机微分方程 $dX_t = m(X_t) dt + \\sqrt{v(X_t)} dW_t$ 描述的一维 Itô 扩散，其生成元，或称向后 Kolmogorov 算子 $\\mathcal{L}$，作用于一个二次连续可微函数 $f(x)$ 时，由下式给出：\n$$\\mathcal{L}f(x) = m(x)\\frac{df}{dx} + \\frac{1}{2}v(x)\\frac{d^2f}{dx^2}$$\n代入任务 1 中推导出的 $m(x)$ 和 $v(x)$ 的表达式：\n$$\\mathcal{L}f(x) = sx(1-x)\\frac{df}{dx} + \\frac{1}{2}\\left(\\frac{x(1-x)}{N}\\right)\\frac{d^2f}{dx^2}$$\n这就是具有基因选择的 Wright-Fisher 扩散的向后算子。\n\n### 任务 3：固定概率的推导\n\n从初始频率 $x$ 开始，等位基因 $A$ 最终固定的概率 $u(x)$ 是一个边值问题的解。该问题由以下条件定义：$u(x)$ 是一个使扩散过程成为鞅的函数，即 $\\mathcal{L}u(x) = 0$，并满足适当的边界条件。\n微分方程为：\n$$sx(1-x)\\frac{du}{dx} + \\frac{x(1-x)}{2N}\\frac{d^2u}{dx^2} = 0$$\n边界条件为 $u(0)=0$（如果等位基因不存在，它就不能固定）和 $u(1)=1$（如果等位基因已经固定，其固定概率为 1）。\n\n对于 $x \\in (0,1)$，我们可以将方程两边同除以在此区间内非零的 $x(1-x)$：\n$$s\\frac{du}{dx} + \\frac{1}{2N}\\frac{d^2u}{dx^2} = 0$$\n整理后得到一个二阶线性齐次常微分方程：\n$$\\frac{d^2u}{dx^2} = -2Ns \\frac{du}{dx}$$\n令 $y(x) = \\frac{du}{dx}$。方程变为关于 $y(x)$ 的一阶常微分方程：\n$$\\frac{dy}{dx} = -2Ns y$$\n这是一个可分离变量方程：$\\frac{1}{y}dy = -2Ns dx$。两边积分得到：\n$$\\ln|y| = -2Nsx + C_0$$\n$$y(x) = C_1 \\exp(-2Nsx)$$\n其中 $C_1$ 是一个任意常数。由于 $y(x) = \\frac{du}{dx}$，我们再次积分求 $u(x)$：\n$$u(x) = \\int C_1 \\exp(-2Nsx) dx = C_1 \\left( \\frac{\\exp(-2Nsx)}{-2Ns} \\right) + C_2$$\n我们可以用两个新的常数 $A$ 和 $B$ 来写出通解：\n$$u(x) = A\\exp(-2Nsx) + B$$\n现在我们应用边界条件来确定 $A$ 和 $B$。\n由 $u(0)=0$ 可得：\n$$0 = A\\exp(0) + B \\implies A + B = 0 \\implies B = -A$$\n由 $u(1)=1$ 可得：\n$$1 = A\\exp(-2Ns) + B$$\n代入 $B=-A$：\n$$1 = A\\exp(-2Ns) - A = A(\\exp(-2Ns) - 1)$$\n解出 $A$：\n$$A = \\frac{1}{\\exp(-2Ns) - 1}$$\n则 $B$ 为：\n$$B = -A = -\\frac{1}{\\exp(-2Ns) - 1} = \\frac{1}{1 - \\exp(-2Ns)}$$\n将 $A$ 和 $B$ 代回 $u(x)$ 的解中：\n$$u(x) = \\frac{1}{\\exp(-2Ns) - 1} \\exp(-2Nsx) + \\frac{1}{1 - \\exp(-2Ns)}$$\n$$u(x) = \\frac{-\\exp(-2Nsx)}{1 - \\exp(-2Ns)} + \\frac{1}{1 - \\exp(-2Ns)}$$\n$$u(x) = \\frac{1 - \\exp(-2Nsx)}{1 - \\exp(-2Ns)}$$\n这就是在大小为 $N$ 的种群中，一个选择系数为 $s$ 的等位基因从频率 $x$ 开始的固定概率 $u(x)$ 的闭式表达式。",
            "answer": "$$\\boxed{\\frac{1 - \\exp(-2Nsx)}{1 - \\exp(-2Ns)}}$$"
        },
        {
            "introduction": "本练习旨在综合您对莫兰过程和赖特-费雪模型的理解。通过推导并比较单个突变体在两种模型中的固定概率，您将揭示这两种基本模型之间的细微但重要的差异，特别是在后代数量的方差方面。这种比较分析对于在应用中选择合适的模型至关重要。",
            "id": "4136994",
            "problem": "考虑一个大小恒为 $N$ 的均匀混合单倍体种群，其中包含两种类型：相对适应度为 $1+s$ 的突变体和适应度为 $1$ 的野生型。令 $i$ 表示给定时间的突变体数量。在Moran生死过程中，一个个体以与其适应度成正比的概率被选择进行繁殖，另一个个体被均匀随机地选择死亡；此过程在每一步中将 $i$ 更新 $\\pm 1$，直到在 $i=0$ 或 $i=N$ 处被吸收。在Wright-Fisher (WF) 过程中，世代是不重叠的；在每一代中，下一代的 $N$ 个个体系以与适应度成正比的概率从当前世代中抽样得到，吸收同样发生在 $i=0$ 或 $i=N$ 处。\n\n从这些定义出发，并使用Wright-Fisher过程的扩散近似，推导突变体类型的固定概率 $u_{\\mathrm{WF}}(i)$ 作为初始数量 $i$ 的函数，以及Moran过程的精确固定概率 $u_{\\mathrm{M}}(i)$。将两者都特化到 $i=1$ 的情况，并考虑近中性机制，其中选择系数缩放为 $s=\\alpha/N$，$\\alpha$ 是一个量级为1的常数，即 $N s \\sim 1$。通过将每个固定概率对 $1/N$ 进行主导阶渐近展开，严格证明在此机制下差值 $u_{\\mathrm{WF}}(1)-u_{\\mathrm{M}}(1)$ 的量级为 $O(1/N)$。然后，用 $\\alpha$ 和 $N$ 给出 $u_{\\mathrm{WF}}(1)-u_{\\mathrm{M}}(1)$ 的闭式主导阶表达式。将你的最终答案表示为单一的解析表达式。不需要进行数值四舍五入。",
            "solution": "该问题要求在Wright-Fisher (WF) 和 Moran (M) 种群模型中推导和比较突变体的固定概率。首先，我们将推导每种模型的固定概率。然后，我们将这些结果特化到近中性机制（$s=\\alpha/N$）下单个初始突变体（$i=1$）的情况，并计算它们差值的主导阶项。\n\n### 第1步：问题验证\n\n**1.1. 提取已知条件：**\n- 种群类型：单倍体，均匀混合。\n- 种群大小：恒定，记为 $N$。\n- 等位基因类型：两种，一个突变体和一个野生型。\n- 适应度值：突变体适应度为 $1+s$，野生型适应度为 $1$。\n- 状态变量：$i$ 是突变体的数量，其中 $i \\in \\{0, 1, \\dots, N\\}$。\n- Moran (M) 过程定义：在每一步中，一个个体以与适应度成正比的概率被选择进行繁殖，另一个个体被均匀随机地选择死亡。\n- Wright-Fisher (WF) 过程定义：世代不重叠。下一代的 $N$ 个个体从当前代中有放回地抽样，抽样概率与适应度成正比。\n- 任务1：使用扩散近似推导固定概率 $u_{\\mathrm{WF}}(i)$。\n- 任务2：推导精确固定概率 $u_{\\mathrm{M}}(i)$。\n- 任务3：将两者都特化到 $i=1$。\n- 任务4：分析近中性机制，其中选择系数缩放为 $s=\\alpha/N$，$\\alpha$ 为一个量级为1的常数。\n- 任务5：证明差值 $u_{\\mathrm{WF}}(1) - u_{\\mathrm{M}}(1)$ 的量级为 $O(1/N)$。\n- 任务6：求出 $u_{\\mathrm{WF}}(1) - u_{\\mathrm{M}}(1)$ 的闭式主导阶表达式。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：**该问题基于经典的Wright-Fisher和Moran模型，它们是理论种群遗传学的基石。扩散近似的使用和弱选择机制的分析是该领域中标准的、成熟的方法。\n- **适定性：**问题定义清晰。它要求在精确的模型定义和近似下推导特定量。预期会有一个唯一且有意义的解。\n- **客观性：**问题以精确的技术语言陈述，没有任何主观性或模糊性。\n\n**1.3. 结论：**\n该问题在科学上是合理的、适定的和客观的。它不违反任何无效性标准。因此，该问题是**有效的**。我们继续进行求解。\n\n### 第2步：固定概率的推导\n\n**2.1. 通过扩散近似推导Wright-Fisher固定概率（$u_{\\mathrm{WF}}(i)$）**\n\n令 $x = i/N$ 为突变等位基因的频率。在WF模型中，下一代突变体的数量 $i'$ 是一个二项随机变量 $i' \\sim \\text{Bin}(N, p_i)$，其中 $p_i$ 是选择一个突变体后代的概率。该概率由突变体贡献的总适应度比例给出：\n$$ p_i = \\frac{i(1+s)}{i(1+s) + (N-i)1} = \\frac{xN(1+s)}{xN(1+s) + (1-x)N} = \\frac{x(1+s)}{1+xs} $$\n扩散近似使用一个连续时间随机微分方程来描述频率 $x$ 的演化，该方程由漂移系数 $a(x)$ 和扩散系数 $b(x)$ 表征。对于单倍体WF模型，漂移和扩散系数分别为 $m(x)=sx(1-x)$ 和 $v(x) = x(1-x)/N$。\n\n固定概率 $u(x)$ 满足向后Kolmogorov方程：\n$$ 0 = m(x) u'(x) + \\frac{1}{2}v(x) u''(x) $$\n代入系数：\n$$ 0 = sx(1-x) u'(x) + \\frac{1}{2} \\frac{x(1-x)}{N} u''(x) $$\n对于 $x \\in (0,1)$，我们可以除以 $x(1-x)$：\n$$ u''(x) = -2Ns u'(x) $$\n令 $v(x) = u'(x)$，我们求解 $v'(x) = -2Ns v(x)$ 得到 $v(x) = C_1 \\exp(-2Nsx)$。对 $u'(x) = C_1 \\exp(-2Nsx)$ 积分得到：\n$$ u(x) = \\int C_1 \\exp(-2Nsx) dx = -\\frac{C_1}{2Ns} \\exp(-2Nsx) + C_2 $$\n使用边界条件 $u(0)=0$ 和 $u(1)=1$：\n$u(0)=0 \\implies -\\frac{C_1}{2Ns} + C_2 = 0 \\implies C_2 = \\frac{C_1}{2Ns}$。\n$u(x) = \\frac{C_1}{2Ns}(1 - \\exp(-2Nsx))$。\n$u(1)=1 \\implies 1 = \\frac{C_1}{2Ns}(1 - \\exp(-2Ns))$。这给出 $C_1 = \\frac{2Ns}{1 - \\exp(-2Ns)}$。\n将 $C_1$ 代回，我们得到固定概率作为初始频率 $x=i/N$ 的函数：\n$$ u_{\\mathrm{WF}}(x) = \\frac{1 - \\exp(-2Nsx)}{1 - \\exp(-2Ns)} $$\n以初始突变体数量 $i$ 表示，即为：\n$$ u_{\\mathrm{WF}}(i) = u_{\\mathrm{WF}}(x=i/N) = \\frac{1 - \\exp(-2si)}{1 - \\exp(-2sN)} $$\n\n**2.2. Moran过程的精确固定概率（$u_{\\mathrm{M}}(i)$）**\n\n在Moran模型中，每个时间步发生一次出生和一次死亡事件。突变体的数量 $i$ 最多改变 $\\pm 1$。\n$i$ 增加到 $i+1$ 的概率（一个突变体繁殖，一个野生型死亡）：\n$$ T^+(i) = \\left(\\frac{i(1+s)}{N+is}\\right) \\left(\\frac{N-i}{N}\\right) $$\n$i$ 减少到 $i-1$ 的概率（一个野生型繁殖，一个突变体死亡）：\n$$ T^-(i) = \\left(\\frac{N-i}{N+is}\\right) \\left(\\frac{i}{N}\\right) $$\n对于这个在 $0$ 和 $N$ 处有吸收边界的一维随机游走，其固定概率 $u_{\\mathrm{M}}(i)$ 由以下公式给出：\n$$ u_{\\mathrm{M}}(i) = \\frac{\\sum_{k=0}^{i-1} \\prod_{j=1}^{k} \\gamma_j}{\\sum_{k=0}^{N-1} \\prod_{j=1}^{k} \\gamma_j}, \\quad \\text{其中} \\quad \\gamma_j = \\frac{T^-(j)}{T^+(j)} $$\n我们来计算比率 $\\gamma_j$：\n$$ \\gamma_j = \\frac{\\frac{(N-j)j}{N(N+js)}}{\\frac{j(1+s)(N-j)}{N(N+js)}} = \\frac{1}{1+s} $$\n该比率对所有 $j$ 都是常数。令 $\\gamma = 1/(1+s)$。公式简化为：\n$$ u_{\\mathrm{M}}(i) = \\frac{\\sum_{k=0}^{i-1} \\gamma^k}{\\sum_{k=0}^{N-1} \\gamma^k} $$\n这些是几何级数。对于 $\\gamma \\neq 1$（即 $s \\neq 0$）：\n$$ u_{\\mathrm{M}}(i) = \\frac{(1-\\gamma^i)/(1-\\gamma)}{(1-\\gamma^N)/(1-\\gamma)} = \\frac{1 - \\gamma^i}{1 - \\gamma^N} $$\n代入 $\\gamma = 1/(1+s)$，得到Moran过程的精确固定概率：\n$$ u_{\\mathrm{M}}(i) = \\frac{1 - (1+s)^{-i}}{1 - (1+s)^{-N}} $$\n\n### 第3步：渐近分析与比较\n\n现在我们特化到单个初始突变体（$i=1$）的情况，并分析近中性机制，其中 $s = \\alpha/N$，$\\alpha$ 为一个量级为1的常数。\n\n**3.1. $u_{\\mathrm{WF}}(1)$的渐近展开**\n对于 $i=1$ 和 $s=\\alpha/N$ (因此 $Ns = \\alpha$):\n$$ u_{\\mathrm{WF}}(1) = \\frac{1 - \\exp(-2s)}{1 - \\exp(-2Ns)} = \\frac{1 - \\exp(-2\\alpha/N)}{1 - \\exp(-2\\alpha)} $$\n我们使用 $\\exp(z) = 1+z+z^2/2!+O(z^3)$ 对大 $N$ 的分子进行展开：\n$$ 1 - \\exp(-2\\alpha/N) = 1 - \\left(1 - \\frac{2\\alpha}{N} + \\frac{1}{2}\\left(\\frac{2\\alpha}{N}\\right)^2 - \\dots\\right) = \\frac{2\\alpha}{N} - \\frac{2\\alpha^2}{N^2} + O(N^{-3}) $$\n因此，$u_{\\mathrm{WF}}(1)$ 的渐近展开为：\n$$ u_{\\mathrm{WF}}(1) = \\frac{1}{1 - \\exp(-2\\alpha)} \\left(\\frac{2\\alpha}{N} - \\frac{2\\alpha^2}{N^2} + O(N^{-3})\\right) $$\n\n**3.2. $u_{\\mathrm{M}}(1)$的渐近展开**\n对于 $i=1$：\n$$ u_{\\mathrm{M}}(1) = \\frac{1 - (1+s)^{-1}}{1 - (1+s)^{-N}} = \\frac{s/(1+s)}{1 - (1+s)^{-N}} $$\n代入 $s=\\alpha/N$。首先，分析分子：\n$$ \\frac{s}{1+s} = \\frac{\\alpha/N}{1+\\alpha/N} = \\frac{\\alpha}{N} (1+\\alpha/N)^{-1} = \\frac{\\alpha}{N}\\left(1 - \\frac{\\alpha}{N} + O(N^{-2})\\right) = \\frac{\\alpha}{N} - \\frac{\\alpha^2}{N^2} + O(N^{-3}) $$\n接下来，使用 $\\ln(1+z) = z - z^2/2 + O(z^3)$ 的展开式分析分母：\n$$ (1+s)^{-N} = (1+\\alpha/N)^{-N} = \\exp\\left(-N\\ln(1+\\alpha/N)\\right) $$\n$$ -N\\ln(1+\\alpha/N) = -N\\left(\\frac{\\alpha}{N} - \\frac{\\alpha^2}{2N^2} + O(N^{-3})\\right) = -\\alpha + \\frac{\\alpha^2}{2N} + O(N^{-2}) $$\n$$ (1+\\alpha/N)^{-N} = \\exp\\left(-\\alpha + \\frac{\\alpha^2}{2N} + O(N^{-2})\\right) = \\exp(-\\alpha)\\exp\\left(\\frac{\\alpha^2}{2N}\\right)\\exp(O(N^{-2})) $$\n$$ = \\exp(-\\alpha)\\left(1 + \\frac{\\alpha^2}{2N} + O(N^{-2})\\right) = \\exp(-\\alpha) + \\frac{\\alpha^2}{2N}\\exp(-\\alpha) + O(N^{-2}) $$\n分母是：\n$$ 1 - (1+s)^{-N} = 1 - \\exp(-\\alpha) - \\frac{\\alpha^2}{2N}\\exp(-\\alpha) + O(N^{-2}) $$\n将分子和分母的展开式合并，并保留到 $O(N^{-2})$ 阶，我们发现两者的主导阶项均为 $O(1/N)$。\n\n**3.3. 差值计算**\n差值的主导阶项是 $O(1/N)$ 量级。为了求出其系数，我们可以使用主导阶近似，因为它们的 $O(1/N)$ 系数是不同的：\n$$ u_{\\mathrm{WF}}(1) \\approx \\frac{2\\alpha/N}{1 - \\exp(-2\\alpha)} = \\frac{2\\alpha}{N(1 - e^{-\\alpha})(1 + e^{-\\alpha})} $$\n$$ u_{\\mathrm{M}}(1) \\approx \\frac{\\alpha/N}{1 - \\exp(-\\alpha)} $$\n现在计算差值的主导项：\n$$ u_{\\mathrm{WF}}(1) - u_{\\mathrm{M}}(1) \\approx \\frac{2\\alpha}{N(1 - e^{-\\alpha})(1 + e^{-\\alpha})} - \\frac{\\alpha}{N(1 - e^{-\\alpha})} $$\n$$ = \\frac{\\alpha}{N(1 - e^{-\\alpha})} \\left( \\frac{2}{1 + e^{-\\alpha}} - 1 \\right) $$\n$$ = \\frac{\\alpha}{N(1 - e^{-\\alpha})} \\left( \\frac{2 - (1 + e^{-\\alpha})}{1 + e^{-\\alpha}} \\right) $$\n$$ = \\frac{\\alpha}{N(1 - e^{-\\alpha})} \\left( \\frac{1 - e^{-\\alpha}}{1 + e^{-\\alpha}} \\right) $$\n$$ = \\frac{\\alpha}{N(1 + e^{-\\alpha})} $$\n这证明了差值是 $O(1/N)$ 量级，并给出了主导阶的闭式表达式。\n\n所求的闭式主导阶表达式为 $\\frac{\\alpha}{N(1 + \\exp(-\\alpha))}$。",
            "answer": "$$\\boxed{\\frac{\\alpha}{N(1 + \\exp(-\\alpha))}}$$"
        }
    ]
}