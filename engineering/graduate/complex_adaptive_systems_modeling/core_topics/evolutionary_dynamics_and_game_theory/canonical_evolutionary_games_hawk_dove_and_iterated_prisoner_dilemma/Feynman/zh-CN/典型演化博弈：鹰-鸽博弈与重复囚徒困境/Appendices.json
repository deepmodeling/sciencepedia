{
    "hands_on_practices": [
        {
            "introduction": "鹰鸽博弈是模拟资源冲突的一个基本模型。本练习将重点寻找演化稳定策略（ESS），它代表在一个大种群中，自然选择所青睐的攻击性（鹰）和被动性（鸽）行为的稳定混合比例。掌握这一计算是理解博弈论如何预测自然界中行为多态性的关键第一步。",
            "id": "4115970",
            "problem": "考虑一个对称的双策略演化博弈，该博弈代表了经典的鹰-鸽博弈，其背景是争夺价值为 $V$ 的共享资源，冲突成本为 $C$。策略分别为鹰（$H$）和鸽（$D$）。每次相遇的收益规定如下：当两只鹰相遇时，每只获得 $\\frac{V - C}{2}$；当一只鹰与一只鸽相遇时，鹰获得 $V$，鸽获得 $0$；当两只鸽相遇时，每只获得 $\\frac{V}{2}$。设 $p \\in [0,1]$ 表示在随机匹配的大型、均匀混合种群中鹰策略的比例。\n\n从期望收益和演化稳定策略（ESS）的标准定义出发，推导当 $V = 1$ 和 $C = 2$ 时，鹰策略的混合ESS频率 $p^{\\ast}$，并在复制动态 $\\dot{p} = p(1 - p)(\\pi_{H}(p) - \\pi_{D}(p))$ 下验证其局部稳定性，其中 $\\pi_{H}(p)$ 和 $\\pi_{D}(p)$ 分别是当种群中鹰的频率为 $p$ 时，鹰和鸽的期望收益。计算混合均衡时的平均种群收益。\n\n最后，简要解释您所计算的均衡状态下，带有成本冲突的共享资源分配的生物学意义，重点关注 $V$ 和 $C$ 如何塑造适应性结果和总体效率。\n\n将混合均衡鹰频率和平均种群收益的最终数值结果表示为一个双元素行向量 $\\big[p^{\\ast} \\;\\; \\bar{\\pi}(p^{\\ast})\\big]$，使用精确值。无需四舍五入。",
            "solution": "该问题是有效的。这是一个演化博弈论中的标准、适定问题，基于已建立的科学原理。所有必要信息均已提供，且术语定义明确。\n\n首先，我们通过构建收益矩阵来形式化该问题。设选择行策略的参与者为焦点个体，选择列策略的参与者为对手。策略为鹰（$H$）和鸽（$D$）。收益矩阵 $A$ 如下：\n$$ A = \\begin{pmatrix} \\pi(H,H)  \\pi(H,D) \\\\ \\pi(D,H)  \\pi(D,D) \\end{pmatrix} = \\begin{pmatrix} \\frac{V - C}{2}  V \\\\ 0  \\frac{V}{2} \\end{pmatrix} $$\n这里，$\\pi(i,j)$ 是一个个体采取策略 $i$ 对抗一个采取策略 $j$ 的对手时所获得的收益。资源价值为 $V$，冲突成本为 $C$。\n\n设 $p$ 为种群中鹰策略的频率。那么鸽策略的频率为 $1-p$。在一个随机匹配的大型、均匀混合种群中，鹰的期望收益 $\\pi_{H}(p)$ 和鸽的期望收益 $\\pi_{D}(p)$ 可计算如下：\n$$ \\pi_{H}(p) = p \\cdot \\pi(H,H) + (1-p) \\cdot \\pi(H,D) = p\\left(\\frac{V - C}{2}\\right) + (1-p)V $$\n$$ \\pi_{D}(p) = p \\cdot \\pi(D,H) + (1-p) \\cdot \\pi(D,D) = p(0) + (1-p)\\frac{V}{2} $$\n\n演化稳定策略（ESS）是一种策略，如果一个种群采纳了它，那么任何最初稀有的替代策略都无法入侵。混合ESS，用频率 $p^{\\ast} \\in (0,1)$ 表示，出现在纯策略的期望收益相等时。这种相等意味着在此特定频率下，两种策略都没有选择优势。\n$$ \\pi_{H}(p^{\\ast}) = \\pi_{D}(p^{\\ast}) $$\n代入期望收益的表达式：\n$$ p^{\\ast}\\left(\\frac{V - C}{2}\\right) + (1-p^{\\ast})V = (1-p^{\\ast})\\frac{V}{2} $$\n我们求解 $p^{\\ast}$：\n$$ \\frac{p^{\\ast}V}{2} - \\frac{p^{\\ast}C}{2} + V - p^{\\ast}V = \\frac{V}{2} - \\frac{p^{\\ast}V}{2} $$\n为了分离含 $p^{\\ast}$ 的项，我们将它们移到等式的一边：\n$$ \\frac{p^{\\ast}V}{2} - \\frac{p^{\\ast}C}{2} - p^{\\ast}V + \\frac{p^{\\ast}V}{2} = \\frac{V}{2} - V $$\n$$ p^{\\ast}\\left(\\frac{V}{2} - \\frac{C}{2} - V + \\frac{V}{2}\\right) = -\\frac{V}{2} $$\n$$ p^{\\ast}\\left(-\\frac{C}{2}\\right) = -\\frac{V}{2} $$\n$$ p^{\\ast} = \\frac{V}{C} $$\n这个混合均衡仅当 $0  p^{\\ast}  1$ 时存在，这要求 $V  C$（假设 $V > 0$ 且 $C > 0$）。题目给出的值为 $V=1$ 和 $C=2$。因为 $1  2$，所以存在混合ESS。\n对于 $V=1$ 和 $C=2$，鹰的混合ESS频率为：\n$$ p^{\\ast} = \\frac{1}{2} $$\n\n接下来，我们在复制动态 $\\dot{p} = p(1 - p)(\\pi_{H}(p) - \\pi_{D}(p))$ 下验证该均衡的局部稳定性。令 $f(p) = \\pi_{H}(p) - \\pi_{D}(p)$。内部不动点 $p^{\\ast}$ 的局部稳定性由增长率函数 $\\frac{\\dot{p}}{p}$ 的导数，或者更简单地，由收益差函数 $f(p)$ 的导数决定。如果 $f'(p^{\\ast})  0$，则内部不动点 $p^{\\ast}$ 是稳定的。\n我们来计算 $f(p)$：\n$$ f(p) = \\left[ p\\left(\\frac{V - C}{2}\\right) + (1-p)V \\right] - \\left[ (1-p)\\frac{V}{2} \\right] $$\n$$ f(p) = p\\left(\\frac{V-C}{2} - V + \\frac{V}{2}\\right) + V - \\frac{V}{2} $$\n$$ f(p) = p\\left(-\\frac{C}{2}\\right) + \\frac{V}{2} $$\n$f(p)$ 关于 $p$ 的导数是：\n$$ f'(p) = \\frac{d}{dp}\\left(\\frac{V}{2} - \\frac{C}{2}p\\right) = -\\frac{C}{2} $$\n为了保证稳定性，我们需要 $f'(p^{\\ast})  0$。由于 $f'(p)$ 是常数 $-\\frac{C}{2}$，且冲突成本 $C=2$ 为正，我们有：\n$$ f'(p^{\\ast}) = -\\frac{2}{2} = -1  0 $$\n条件得到满足，因此混合均衡 $p^{\\ast} = \\frac{1}{2}$ 是局部稳定的。\n\n现在，我们计算该均衡下的平均种群收益 $\\bar{\\pi}(p^{\\ast})$。平均收益是鹰和鸽收益的加权平均值：\n$$ \\bar{\\pi}(p) = p \\cdot \\pi_{H}(p) + (1-p) \\cdot \\pi_{D}(p) $$\n根据定义，在混合均衡 $p^{\\ast}$ 处，$\\pi_{H}(p^{\\ast}) = \\pi_{D}(p^{\\ast})$。因此，平均收益简化为此频率下任一策略的收益：\n$$ \\bar{\\pi}(p^{\\ast}) = \\pi_{D}(p^{\\ast}) = (1-p^{\\ast})\\frac{V}{2} $$\n代入 $p^{\\ast} = V/C$：\n$$ \\bar{\\pi}(p^{\\ast}) = \\left(1 - \\frac{V}{C}\\right)\\frac{V}{2} = \\frac{C-V}{C}\\frac{V}{2} = \\frac{V(C-V)}{2C} $$\n使用给定的值 $V=1$ 和 $C=2$：\n$$ \\bar{\\pi}(p^{\\ast}) = \\frac{1(2-1)}{2(2)} = \\frac{1}{4} $$\n所要求的数值输出为 $p^{\\ast} = \\frac{1}{2}$ 和 $\\bar{\\pi}(p^{\\ast}) = \\frac{1}{4}$。\n\n最后，作简要的生物学解释。攻击性个体（鹰）的均衡频率 $p^{\\ast} = V/C$ 由资源价值与冲突成本之比决定。这表明演化选择在攻击性与被动性之间达到一种平衡，其中攻击性行为的比例由环境特定的成本和收益来调节。当资源更有价值（$V$ 增加）或冲突成本更低（$C$ 减少）时，攻击性行为会变得更加普遍。\n在此均衡下的平均种群收益 $\\bar{\\pi}(p^{\\ast}) = \\frac{V(C-V)}{2C}$ 代表了个体的平均适应度。值得注意的是，该收益低于一个全为鸽子的种群所能获得的收益，即 $\\frac{V}{2}$。对于我们给定的值，$\\bar{\\pi}(p^{\\ast}) = \\frac{1}{4}$，而全鸽种群的收益为 $\\frac{1}{2}$。这揭示了一种公地悲剧：个体有利的策略（当鸽子普遍时选择成为鹰）导致了集体次优的结果。纯鸽状态在演化上是不稳定的，因为它易受鹰的入侵。作用于个体层面的选择，将种群推向一个代价高昂的冲突不可避免的状态，与假想的合作理想状态相比，降低了种群的整体“效率”或平均适应度。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{4} \\end{pmatrix}} $$"
        },
        {
            "introduction": "现在我们从一次性互动转向重复博弈，在重复博弈中，记忆和未来的后果至关重要。本练习将探讨迭代囚徒困境（IPD），并引入一种复杂的策略——赢则坚守，输则转换（Win-Stay Lose-Shift, WSLS）。你将推导出像 WSLS 这样的合作策略能够抵抗纯粹剥削策略入侵的条件，从而突显出博弈的持续概率，即“未来的阴影”，在维持合作中的关键作用。",
            "id": "4115977",
            "problem": "考虑在一个均匀混合的种群成员之间进行的迭代囚徒困境 (IPD) 博弈。每一轮以持续概率 $w \\in (0,1)$ 重复，每轮的收益由 $(T,R,P,S)$ 给出，其中 $TRPS$，且行动能被完美观察到。使用归一化贴现收益的定义 $(1-w)\\sum_{t=0}^{\\infty} w^{t} \\pi_{t}$，其中 $\\pi_{t}$ 是第 $t$ 轮的阶段收益。存在两种策略：赢则坚守，输则转换 (Win-Stay Lose-Shift, WSLS) 和始终背叛 (Always Defect, ALLD)。赢则坚守，输则转换 (WSLS) 策略在获得其评估为“赢”的结果（收到 $R$ 或 $T$）后选择合作，在获得其评估为“输”的结果（收到 $P$ 或 $S$）后选择背叛。始终背叛 (ALLD) 策略在每一轮都选择背叛。假设原住种群是单态的 WSLS，并以相互合作开始，在没有偏离的情况下产生收益 $R$。一个稀有的 ALLD 突变体主要与 WSLS 原住者进行互动。\n\n仅使用重复博弈收益的基本原理以及 WSLS 和 ALLD 的行为更新规则，推导出最小持续概率 $w$，使得一个典型的原住 WSLS 博弈者（与 WSLS 原住者互动）的归一化贴现收益严格超过一个稀有的 ALLD 突变体（与 WSLS 原住者互动）的归一化贴现收益。将你的最终答案表示为关于 $T$、$R$ 和 $P$ 的闭式解析表达式。\n\n此外，假设每次行动时，博弈者的意图行动都有一个独立的概率 $\\epsilon \\in (0,1)$ 被翻转（一个执行错误）。请简要解释，在不计算新阈值的情况下，WSLS 的纠错属性如何在小 $\\epsilon$ 范围内，相对于那些不能快速纠错的策略，定性地影响最小 $w$ 阈值。您最终提交的答案必须是最小 $w$ 的单一解析表达式；无需四舍五入。",
            "solution": "该问题陈述已被验证，并被认为是演化博弈论领域内一个良定的、有科学依据的问题。它为推导所要求的量提供了一套完整且一致的定义和条件。\n\n我们的任务是找到最小的持续概率 $w$，使得一个由赢则坚守，输则转换 (WSLS) 博弈者组成的单态种群对于稀有的始终背叛 (ALLD) 突变体的入侵是演化稳定的。稳定性要求典型的原住博弈者的收益严格超过稀有突变体的收益。归一化贴现收益定义为 $U = (1-w)\\sum_{t=0}^{\\infty} w^{t} \\pi_{t}$，其中 $\\pi_t$ 是第 $t$ 轮的收益。\n\n首先，我们计算一个原住 WSLS 博弈者与另一个 WSLS 博弈者互动时的收益，记作 $U_{WSLS, WSLS}$。问题陈述中说明原住种群以相互合作开始。\n在第 $t=0$ 轮，两个 WSLS 博弈者都合作 (C)。结果是 $(C, C)$，两者都获得奖励收益 $R$。\nWSLS 策略是在获得“赢”（收益 $R$ 或 $T$）后合作，在获得“输”（收益 $P$ 或 $S$）后背叛。\n由于两个博弈者在第 $t=0$ 轮都获得了 $R$，这是一个“赢”，他们都会在第 $t=1$ 轮“维持”他们之前的行动 (C)。\n这导致了每一轮都出现永久的相互合作 $(C, C)$ 序列。因此，一个 WSLS 博弈者在此互动中的收益流是 $(R, R, R, \\dots)$。\n归一化贴现收益是：\n$$U_{WSLS, WSLS} = (1-w) \\sum_{t=0}^{\\infty} w^{t} R = (1-w) R \\sum_{t=0}^{\\infty} w^{t}$$\n对于 $w \\in (0,1)$，无穷几何级数的和是 $\\sum_{t=0}^{\\infty} w^t = \\frac{1}{1-w}$。\n$$U_{WSLS, WSLS} = (1-w) R \\left( \\frac{1}{1-w} \\right) = R$$\n\n接下来，我们计算一个稀有的 ALLD 突变体与一个原住 WSLS 博弈者互动时的收益，记作 $U_{ALLD, WSLS}$。设 ALLD 博弈者为博弈者1，WSLS 博弈者为博弈者2。\n在第 $t=0$ 轮：\n-   博弈者1 (ALLD) 根据定义选择背叛 (D)。\n-   博弈者2 (WSLS)，作为来自合作种群的原住者，开始时选择合作 (C)。\n-   双方的行动是 $(D, C)$。收益是 $(T, S)$。ALLD 突变体获得 $T$。\n\n在第 $t=1$ 轮：\n-   博弈者1 (ALLD) 选择背叛 (D)。\n-   博弈者2 (WSLS) 在上一轮获得了收益 $S$。这是一个“输”，所以它遵循“输则转换”的规则。它之前的行动是 C，所以它转换为 D。\n-   双方的行动是 $(D, D)$。收益是 $(P, P)$。ALLD 突变体获得 $P$。\n\n在第 $t=2$ 轮：\n-   博弈者1 (ALLD) 选择背叛 (D)。\n-   博弈者2 (WSLS) 在上一轮获得了收益 $P$。这是一个“输”，所以它再次转换。它之前的行动是 D，所以它转换为 C。\n-   双方的行动是 $(D, C)$。收益是 $(T, S)$。ALLD 突变体获得 $T$。\n\n在第 $t=3$ 轮：\n-   博弈者1 (ALLD) 选择背叛 (D)。\n-   博弈者2 (WSLS) 在上一轮获得了收益 $S$（“输”），所以它从 C 转换为 D。\n-   双方的行动是 $(D, D)$。收益是 $(P, P)$。ALLD 突变体获得 $P$。\n\nALLD 突变体的收益序列是 $(T, P, T, P, \\dots)$。我们现在可以计算其归一化贴现收益：\n$$U_{ALLD, WSLS} = (1-w) \\left( T \\cdot w^0 + P \\cdot w^1 + T \\cdot w^2 + P \\cdot w^3 + \\dots \\right)$$\n$$U_{ALLD, WSLS} = (1-w) \\left( (T + T w^2 + T w^4 + \\dots) + (P w + P w^3 + P w^5 + \\dots) \\right)$$\n$$U_{ALLD, WSLS} = (1-w) \\left( T \\sum_{k=0}^{\\infty} (w^2)^k + wP \\sum_{k=0}^{\\infty} (w^2)^k \\right)$$\n几何级数的和是 $\\sum_{k=0}^{\\infty} (w^2)^k = \\frac{1}{1-w^2}$。\n$$U_{ALLD, WSLS} = (1-w) \\left( \\frac{T}{1-w^2} + \\frac{wP}{1-w^2} \\right) = (1-w) \\frac{T+wP}{1-w^2}$$\n使用恒等式 $1-w^2 = (1-w)(1+w)$，我们简化表达式：\n$$U_{ALLD, WSLS} = \\frac{(1-w)(T+wP)}{(1-w)(1+w)} = \\frac{T+wP}{1+w}$$\n\nWSLS 种群能稳定抵抗 ALLD 入侵的条件是，原住者的收益严格大于突变体的收益：\n$$U_{WSLS, WSLS}  U_{ALLD, WSLS}$$\n代入推导出的表达式：\n$$R  \\frac{T+wP}{1+w}$$\n由于 $w \\in (0,1)$，项 $(1+w)$ 是正的。我们可以在不等式两边同乘以它而不改变不等号的方向：\n$$R(1+w)  T+wP$$\n$$R + wR  T + wP$$\n为了求解 $w$，我们把含有 $w$ 的项归集到一边：\n$$wR - wP  T - R$$\n$$w(R-P)  T-R$$\n问题指定了收益排序 $TRPS$，这意味着 $(R-P)$ 和 $(T-R)$ 都是正量。因此，我们可以用 $(R-P)$ 来除，而不改变不等号的方向：\n$$w  \\frac{T-R}{R-P}$$\n这个不等式定义了 WSLS 策略能够抵抗 ALLD 入侵所需满足的持续概率 $w$ 的条件。满足这个严格不等式的最小 $w$ 值就是阈值本身。因此，最小持续概率就是右侧的表达式。\n\n关于执行错误的定性影响，WSLS 的纠错属性至关重要。当两个 WSLS 博弈者互动时，一个单次错误（例如，意图的 C 变成了 D）只会在两轮内破坏合作，之后相互合作就会恢复。这意味着原住者之间的收益 $U_{WSLS, WSLS}$ 会优雅地降低，并且在小错误率 $\\epsilon$ 的情况下保持在较高水平。相比之下，没有此功能的策略（例如，Grim Trigger）会因单次错误而遭受灾难性崩溃，陷入永久相互背叛，导致其原住者之间的收益骤降。虽然噪声的引入可能会略微增加 WSLS 维持稳定性所需的最小 $w$（因为原住者的收益略有降低），但其内在的鲁棒性确保了该阈值保持在较低水平。对于容错性较差的策略，该阈值会急剧增加，使它们在有噪声的环境中变得不可行。因此，相对于那些不能快速纠错的策略，纠错属性通过保持稳定性所需的最小持续概率较低，使 WSLS 成为一个鲁棒性强得多的策略。",
            "answer": "$$\n\\boxed{\\frac{T-R}{R-P}}\n$$"
        },
        {
            "introduction": "真实的种群是有限的，这为演化过程引入了随机性（遗传漂变）。本练习将从无限种群的确定性模型过渡到随机的莫兰过程（Moran process）。你将推导并计算单个鹰派突变体在鸽派种群中的固定概率，学习种群大小和选择强度如何相互作用，共同决定新策略的最终命运。",
            "id": "4115929",
            "problem": "考虑一个大小为 $N$ 的充分混合有限种群，其中的个体可以在经典的鹰鸽博弈中采取鹰策略或鸽策略。互动在不同个体间成对随机发生，每种类型的平均收益是通过对当前种群状态下对手的分布进行平均计算得出的。设资源的收益为 $V$，冲突的成本为 $C$。鹰鸽博弈的收益矩阵定义如下：当两个鹰互动时，每个获得 $(V-C)/2$；当一个鹰遇到一个鸽时，鹰获得 $V$，鸽获得 $0$；当两个鸽互动时，每个获得 $V/2$。假设收益通过选择强度为 $\\beta$ 的指数映射到适应度，因此在给定的种群状态下，鹰和鸽的适应度分别为 $f_H=\\exp(\\beta \\pi_H)$ 和 $f_D=\\exp(\\beta \\pi_D)$，其中 $\\pi_H$ 和 $\\pi_D$ 分别表示在无自我互动的随机匹配下鹰和鸽的平均收益。种群根据生灭Moran过程演化：在每一步中，一个个体以与其适应度成正比的概率被选中进行繁殖，其后代会均匀随机地替换种群中的一个个体。\n\n从上述基本定义出发——在充分混合随机匹配下的鹰鸽矩阵的期望收益、指数适应度映射，以及在有限马尔可夫链（MC）上具有吸收态 $i=0$（无鹰）和 $i=N$（全是鹰）的生灭Moran过程——请从第一性原理推导单个鹰被引入全为鸽的种群后的固定概率。不要假设任何预先形成的固定公式；相反，应通过求解MC的相应后向方程，为频率依赖的情况推导出相关的转移概率和固定概率表达式。\n\n在一个程序中实现推导出的计算，该程序对于给定的参数 $(N,V,C,\\beta)$，返回单个鹰的固定概率 $\\rho$，并评估选择是增加还是减少了此概率（相对于中性选择）。中性选择定义为 $\\beta=0$ 的情况，此时在有限的充分混合种群中，单个突变体的固定概率为 $1/N$。您的评估必须编码为一个整数 $\\Delta$，定义如下：\n- 如果 $\\rho$ 严格大于 $1/N$，则 $\\Delta=1$，\n- 如果在数值容差范围内 $\\rho$ 等于 $1/N$，则 $\\Delta=0$，\n- 如果 $\\rho$ 严格小于 $1/N$，则 $\\Delta=-1$。\n\n对等性比较使用 $10^{-12}$ 的数值容差。所有计算都是无量纲的，不涉及物理单位。\n\n您的程序必须为以下测试套件计算结果：\n1. $N=50$, $V=1$, $C=2$, $\\beta=0.1$。\n2. $N=50$, $V=1$, $C=2$, $\\beta=0$。\n3. $N=50$, $V=1$, $C=2$, $\\beta=-0.1$。\n4. $N=2$, $V=1$, $C=2$, $\\beta=0.1$。\n5. $N=50$, $V=2$, $C=1$, $\\beta=0.1$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表的结果，每个结果对应一个测试用例，并且本身是 $[\\rho,\\Delta]$ 形式的双元素列表。例如，输出应类似于 $[[\\rho_1,\\Delta_1],[\\rho_2,\\Delta_2],\\dots]$，其中 $\\rho_k$ 以浮点数形式打印，$\\Delta_k$ 以整数形式打印。",
            "solution": "该问题是有效的，因为它在演化博弈论中有科学依据，提法是良定的，并且所有参数和动力学都已明确无误地指定。我现在将从第一性原理推导固定概率。\n\n设大小为 $N$ 的种群状态为鹰个体的数量，记为 $i \\in \\{0, 1, \\dots, N\\}$。相应地，鸽个体的数量为 $N-i$。状态 $i=0$（全是鸽）和 $i=N$（全是鹰）是吸收态。\n\n首先，我们确定在一个有 $i$ 个鹰的种群中，一个鹰的平均收益 $\\pi_H(i)$ 和一个鸽的平均收益 $\\pi_D(i)$。互动是不同个体间的随机配对。一个给定类型的个体与从其余 $N-1$ 个个体中均匀抽取的对手配对。\n\n对于一个鹰策略者，其对手是鹰的概率为 $\\frac{i-1}{N-1}$，是鸽的概率为 $\\frac{N-i}{N-1}$。收益矩阵给出如下：$E(H,H) = (V-C)/2$, $E(H,D) = V$。一个鹰的平均收益是：\n$$ \\pi_H(i) = \\frac{i-1}{N-1} \\left( \\frac{V-C}{2} \\right) + \\frac{N-i}{N-1} V \\quad \\text{for } i \\in \\{1, \\dots, N\\} $$\n\n对于一个鸽策略者，其对手是鹰的概率为 $\\frac{i}{N-1}$，是鸽的概率为 $\\frac{N-i-1}{N-1}$。收益为 $E(D,H) = 0$ 和 $E(D,D) = V/2$。一个鸽的平均收益是：\n$$ \\pi_D(i) = \\frac{i}{N-1} (0) + \\frac{N-i-1}{N-1} \\left( \\frac{V}{2} \\right) = \\frac{V(N-i-1)}{2(N-1)} \\quad \\text{for } i \\in \\{0, \\dots, N-1\\} $$\n\n鹰和鸽的适应度由指数映射 $f = \\exp(\\beta \\pi)$ 给出，其中 $\\beta$ 是选择强度。\n$$ f_H(i) = \\exp(\\beta \\pi_H(i)) $$\n$$ f_D(i) = \\exp(\\beta \\pi_D(i)) $$\n\n种群在生灭Moran过程下演化。在每个时间步，一个个体以与其适应度成正比的概率被选中进行繁殖，其后代会替换一个随机选择的个体。\n种群的总适应度为 $F_{total}(i) = i f_H(i) + (N-i) f_D(i)$。\n\n如果一个鹰繁殖且其后代替换了一个鸽，鹰的数量就增加一个（$i \\to i+1$）。此事件的概率 $T_i^+$ 为：\n$$ T_i^+ = \\left( \\frac{i f_H(i)}{i f_H(i) + (N-i) f_D(i)} \\right) \\left( \\frac{N-i}{N} \\right) $$\n\n如果一个鸽繁殖且其后代替换了一个鹰，鹰的数量就减少一个（$i \\to i-1$）。此事件的概率 $T_i^-$ 为：\n$$ T_i^- = \\left( \\frac{(N-i) f_D(i)}{i f_H(i) + (N-i) f_D(i)} \\right) \\left( \\frac{i}{N} \\right) $$\n这些转移概率对 $i \\in \\{1, \\dots, N-1\\}$ 有效。\n\n设 $\\rho_i$ 是从状态 $i$ 开始时鹰的固定概率。边界条件为 $\\rho_0 = 0$ 和 $\\rho_N = 1$。对于任何瞬时状态 $i$，$\\rho_i$ 必须满足后向Kolmogorov方程：\n$$ \\rho_i = T_i^+ \\rho_{i+1} + T_i^- \\rho_{i-1} + (1-T_i^+-T_i^-) \\rho_i $$\n这可以简化为 $T_i^+(\\rho_{i+1} - \\rho_i) = T_i^-(\\rho_i - \\rho_{i-1})$。\n我们定义比率 $\\gamma_i = T_i^- / T_i^+$，其中 $i \\in \\{1, \\dots, N-1\\}$。\n$$ \\gamma_i = \\frac{\\frac{(N-i) f_D(i)}{F_{total}(i)} \\frac{i}{N}}{\\frac{i f_H(i)}{F_{total}(i)} \\frac{N-i}{N}} = \\frac{f_D(i)}{f_H(i)} = \\exp(\\beta(\\pi_D(i) - \\pi_H(i))) $$\n递推关系变为 $\\rho_{i+1} - \\rho_i = \\gamma_i (\\rho_i - \\rho_{i-1})$。\n这是差分 $\\Delta_i = \\rho_i - \\rho_{i-1}$ 的一个等比数列。我们可以写出 $\\Delta_{k} = \\Delta_1 \\prod_{j=1}^{k-1} \\gamma_j$，对于 $k > 1$。\n由于 $\\rho_0 = 0$，我们有 $\\Delta_1 = \\rho_1 - \\rho_0 = \\rho_1$。因此，$\\rho_k - \\rho_{k-1} = \\rho_1 \\prod_{j=1}^{k-1} \\gamma_j$。\n为了求得 $\\rho_i$，我们将这些差分求和：\n$$ \\rho_i = \\sum_{k=1}^{i} (\\rho_k - \\rho_{k-1}) = \\rho_1 \\sum_{k=1}^{i} \\prod_{j=1}^{k-1} \\gamma_j $$\n按照惯例，空积 $\\prod_{j=1}^0$ 为 $1$。\n为了求得 $\\rho_1$，我们应用边界条件 $\\rho_N=1$：\n$$ 1 = \\rho_N = \\rho_1 \\sum_{k=1}^{N} \\prod_{j=1}^{k-1} \\gamma_j $$\n解出 $\\rho_1$，即单个鹰突变体的固定概率，我们得到：\n$$ \\rho = \\rho_1 = \\frac{1}{\\sum_{k=1}^{N} \\prod_{j=1}^{k-1} \\gamma_j} = \\frac{1}{1 + \\sum_{k=2}^{N} \\prod_{j=1}^{k-1} \\gamma_j} $$\n一个更标准的形式是：\n$$ \\rho = \\frac{1}{1 + \\sum_{k=1}^{N-1} \\prod_{j=1}^{k} \\gamma_j} $$\n为了实现这一点，我们需要 $\\gamma_j$ 的表达式：\n$$ \\pi_D(j) - \\pi_H(j) = \\frac{1}{N-1} \\left[ \\frac{V(N-j-1)}{2} - \\left( \\frac{V-C}{2}(j-1) + V(N-j) \\right) \\right] $$\n$$ = \\frac{1}{2(N-1)} [V(N-j-1) - (V-C)(j-1) - 2V(N-j)] $$\n$$ = \\frac{1}{2(N-1)} [VN-Vj-V - (Vj-V-Cj+C) - 2VN+2Vj] = \\frac{C(j-1) - VN}{2(N-1)} $$\n因此，\n$$ \\gamma_j = \\exp\\left( \\beta \\frac{C(j-1) - VN}{2(N-1)} \\right) $$\n这个 $\\gamma_j$ 的表达式将用于求和计算 $\\rho$。\n\n对于中性情况，$\\beta=0$，这意味着对所有 $j$ 都有 $\\gamma_j = \\exp(0) = 1$。固定概率变为：\n$$ \\rho = \\frac{1}{1 + \\sum_{k=1}^{N-1} \\prod_{j=1}^{k} 1} = \\frac{1}{1 + \\sum_{k=1}^{N-1} 1} = \\frac{1}{1 + (N-1)} = \\frac{1}{N} $$\n这证实了中性漂变的结果。\n\n计算流程是：对每组参数 $(N, V, C, \\beta)$，使用推导出的公式计算 $\\rho$。然后，将计算出的 $\\rho$ 与中性概率 $1/N$ 进行比较，根据指定的 $10^{-12}$ 容差来确定 $\\Delta \\in \\{-1, 0, 1\\}$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Hawk-Dove fixation probability problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (N, V, C, beta)\n        (50, 1, 2, 0.1),\n        (50, 1, 2, 0.0),\n        (50, 1, 2, -0.1),\n        (2, 1, 2, 0.1),\n        (50, 2, 1, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_fixation_and_delta(case)\n        results.append(result)\n\n    # Format the output string as required: [[rho_1,delta_1],[rho_2,delta_2],...]\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef compute_fixation_and_delta(params):\n    \"\"\"\n    Computes the fixation probability rho and the selection direction delta.\n\n    The derivation shows the fixation probability of a single mutant is:\n    rho = 1 / (1 + sum_{k=1}^{N-1} prod_{j=1}^{k} gamma_j)\n    where gamma_j = exp(beta * (pi_D(j) - pi_H(j))).\n    The payoff difference is:\n    pi_D(j) - pi_H(j) = (C*(j-1) - V*N) / (2*(N-1))\n    \"\"\"\n    N, V, C, beta = params\n    N = int(N)\n    V = float(V)\n    C = float(C)\n    beta = float(beta)\n    \n    neutral_rho = 1.0 / N\n\n    # Handle the neutral case beta = 0, where rho = 1/N.\n    if beta == 0.0:\n        return [neutral_rho, 0]\n\n    # Denominator of the fixation probability formula.\n    # It is S = 1 + sum_{k=1}^{N-1} prod_{j=1}^{k} gamma_j\n    S = 1.0\n    current_product = 1.0\n\n    # The loop calculates the sum of products.\n    # k runs from 1 to N-1 for the sum, and in each term,\n    # a running product from j=1 to k is calculated.\n    for k in range(1, N):\n        # Calculate gamma_k\n        exponent = beta * (C * (k - 1) - V * N) / (2.0 * (N - 1))\n        gamma_k = np.exp(exponent)\n        \n        # Update the product term prod_{j=1}^{k} gamma_j\n        current_product *= gamma_k\n        \n        # Add the new product term to the sum S\n        S += current_product\n\n    rho = 1.0 / S\n\n    # Compare rho with neutral_rho to determine delta\n    tolerance = 1e-12\n    if abs(rho - neutral_rho) = tolerance:\n        delta = 0\n    elif rho  neutral_rho:\n        delta = 1\n    else: # rho  neutral_rho\n        delta = -1\n        \n    return [rho, delta]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}