{
    "hands_on_practices": [
        {
            "introduction": "The concept of an Evolutionarily Stable Strategy (ESS) is a cornerstone of evolutionary game theory, defining a state of equilibrium where a population's strategy profile is uninvadeable by any rare alternative strategy. This first practice is a foundational exercise: deriving the mixed ESS for the canonical Hawk-Dove game from first principles. By calculating the equilibrium frequency of aggressive 'Hawks' versus passive 'Doves', you will gain a concrete understanding of how the balance between the value of a resource ($V$) and the cost of conflict ($C$) shapes the adaptive landscape .",
            "id": "4115970",
            "problem": "Consider a symmetric two-strategy evolutionary game representing the canonical Hawk–Dove interaction over a shared resource of value $V$ with a costly conflict of cost $C$. The strategies are Hawk ($H$) and Dove ($D$). The payoffs per encounter are specified as follows: when two Hawks meet, each receives $\\frac{V - C}{2}$; when a Hawk meets a Dove, the Hawk receives $V$ and the Dove receives $0$; when two Doves meet, each receives $\\frac{V}{2}$. Let $p \\in [0,1]$ denote the fraction of Hawks in a large, well-mixed population under random matching.\n\nStarting from the standard definition of expected payoff and the definition of an Evolutionarily Stable Strategy (ESS), derive the mixed ESS frequency $p^{\\ast}$ of Hawks for $V = 1$ and $C = 2$ and verify its local stability under the replicator dynamics $\\dot{p} = p(1 - p)\\big(\\pi_{H}(p) - \\pi_{D}(p)\\big)$, where $\\pi_{H}(p)$ and $\\pi_{D}(p)$ are the expected payoffs to Hawks and Doves when the population has Hawk frequency $p$. Compute the average population payoff at the mixed equilibrium.\n\nFinally, briefly interpret the biological meaning of allocating a shared resource with costly conflicts at the equilibrium you compute, focusing on how $V$ and $C$ shape the adaptive outcome and aggregate efficiency.\n\nExpress your final numerical outputs for the mixed equilibrium Hawk frequency and the average population payoff as a two-entry row vector $\\big[p^{\\ast} \\;\\; \\bar{\\pi}(p^{\\ast})\\big]$ with exact values. No rounding is required.",
            "solution": "The problem is valid. It is a standard, well-posed problem in evolutionary game theory, based on established scientific principles. All necessary information is provided, and the terms are defined unambiguously.\n\nFirst, we formalize the problem by constructing the payoff matrix. Let the player choosing the strategy in the row be the focal individual, and the player choosing the strategy in the column be the opponent. The strategies are Hawk ($H$) and Dove ($D$). The payoff matrix $A$ is given by:\n$$ A = \\begin{pmatrix} \\pi(H,H) & \\pi(H,D) \\\\ \\pi(D,H) & \\pi(D,D) \\end{pmatrix} = \\begin{pmatrix} \\frac{V - C}{2} & V \\\\ 0 & \\frac{V}{2} \\end{pmatrix} $$\nHere, $\\pi(i,j)$ is the payoff to an individual playing strategy $i$ against an opponent playing strategy $j$. The value of the resource is $V$ and the cost of conflict is $C$.\n\nLet $p$ be the frequency of the Hawk strategy in the population. The frequency of the Dove strategy is then $1-p$. In a large, well-mixed population with random matching, the expected payoff for a Hawk, $\\pi_{H}(p)$, and for a Dove, $\\pi_{D}(p)$, can be calculated as follows:\n$$ \\pi_{H}(p) = p \\cdot \\pi(H,H) + (1-p) \\cdot \\pi(H,D) = p\\left(\\frac{V - C}{2}\\right) + (1-p)V $$\n$$ \\pi_{D}(p) = p \\cdot \\pi(D,H) + (1-p) \\cdot \\pi(D,D) = p(0) + (1-p)\\frac{V}{2} $$\n\nAn Evolutionarily Stable Strategy (ESS) is a strategy that, if adopted by a population, cannot be invaded by any alternative strategy that is initially rare. A mixed ESS, denoted by a frequency $p^{\\ast} \\in (0,1)$, occurs when the expected payoffs of the pure strategies are equal. This equality means that there is no selective advantage for either strategy at this specific frequency.\n$$ \\pi_{H}(p^{\\ast}) = \\pi_{D}(p^{\\ast}) $$\nSubstituting the expressions for the expected payoffs:\n$$ p^{\\ast}\\left(\\frac{V - C}{2}\\right) + (1-p^{\\ast})V = (1-p^{\\ast})\\frac{V}{2} $$\nWe solve for $p^{\\ast}$:\n$$ \\frac{p^{\\ast}V}{2} - \\frac{p^{\\ast}C}{2} + V - p^{\\ast}V = \\frac{V}{2} - \\frac{p^{\\ast}V}{2} $$\nTo isolate terms with $p^{\\ast}$, we move them to one side of the equation:\n$$ \\frac{p^{\\ast}V}{2} - \\frac{p^{\\ast}C}{2} - p^{\\ast}V + \\frac{p^{\\ast}V}{2} = \\frac{V}{2} - V $$\n$$ p^{\\ast}\\left(\\frac{V}{2} - \\frac{C}{2} - V + \\frac{V}{2}\\right) = -\\frac{V}{2} $$\n$$ p^{\\ast}\\left(-\\frac{C}{2}\\right) = -\\frac{V}{2} $$\n$$ p^{\\ast} = \\frac{V}{C} $$\nThis mixed equilibrium exists only if $0 < p^{\\ast} < 1$, which requires $V < C$ (assuming $V > 0$ and $C > 0$). The problem provides the values $V=1$ and $C=2$. Since $1 < 2$, a mixed ESS exists.\nFor $V=1$ and $C=2$, the mixed ESS frequency of Hawks is:\n$$ p^{\\ast} = \\frac{1}{2} $$\n\nNext, we verify the local stability of this equilibrium under the replicator dynamics, given by $\\dot{p} = p(1 - p)\\big(\\pi_{H}(p) - \\pi_{D}(p)\\big)$. Let $f(p) = \\pi_{H}(p) - \\pi_{D}(p)$. The local stability of an interior fixed point $p^{\\ast}$ is determined by the derivative of the growth rate function $\\frac{\\dot{p}}{p}$ or more simply, the derivative of the payoff difference function $f(p)$. An interior fixed point $p^{\\ast}$ is stable if $f'(p^{\\ast}) < 0$.\nLet's compute $f(p)$:\n$$ f(p) = \\left[ p\\left(\\frac{V - C}{2}\\right) + (1-p)V \\right] - \\left[ (1-p)\\frac{V}{2} \\right] $$\n$$ f(p) = p\\left(\\frac{V-C}{2} - V + \\frac{V}{2}\\right) + V - \\frac{V}{2} $$\n$$ f(p) = p\\left(-\\frac{C}{2}\\right) + \\frac{V}{2} $$\nThe derivative of $f(p)$ with respect to $p$ is:\n$$ f'(p) = \\frac{d}{dp}\\left(\\frac{V}{2} - \\frac{C}{2}p\\right) = -\\frac{C}{2} $$\nFor stability, we require $f'(p^{\\ast}) < 0$. Since $f'(p)$ is the constant $-\\frac{C}{2}$, and the cost of conflict $C=2$ is positive, we have:\n$$ f'(p^{\\ast}) = -\\frac{2}{2} = -1 < 0 $$\nThe condition is satisfied, so the mixed equilibrium $p^{\\ast} = \\frac{1}{2}$ is locally stable.\n\nNow, we compute the average population payoff, $\\bar{\\pi}(p^{\\ast})$, at this equilibrium. The average payoff is the weighted average of the payoffs of a Hawk and a Dove:\n$$ \\bar{\\pi}(p) = p \\cdot \\pi_{H}(p) + (1-p) \\cdot \\pi_{D}(p) $$\nAt the mixed equilibrium $p^{\\ast}$, by definition, $\\pi_{H}(p^{\\ast}) = \\pi_{D}(p^{\\ast})$. Therefore, the average payoff simplifies to the payoff of either strategy at this frequency:\n$$ \\bar{\\pi}(p^{\\ast}) = \\pi_{D}(p^{\\ast}) = (1-p^{\\ast})\\frac{V}{2} $$\nSubstituting $p^{\\ast} = V/C$:\n$$ \\bar{\\pi}(p^{\\ast}) = \\left(1 - \\frac{V}{C}\\right)\\frac{V}{2} = \\frac{C-V}{C}\\frac{V}{2} = \\frac{V(C-V)}{2C} $$\nUsing the given values $V=1$ and $C=2$:\n$$ \\bar{\\pi}(p^{\\ast}) = \\frac{1(2-1)}{2(2)} = \\frac{1}{4} $$\nThe requested numerical outputs are $p^{\\ast} = \\frac{1}{2}$ and $\\bar{\\pi}(p^{\\ast}) = \\frac{1}{4}$.\n\nFinally, a brief biological interpretation. The equilibrium frequency of aggressive individuals (Hawks), $p^{\\ast} = V/C$, is determined by the ratio of the resource value to the conflict cost. This signifies that evolution selects for a balance between aggression and passivity, where the proportion of aggressive behavior is tuned by the environment's specific costs and benefits. When the resource is more valuable ($V$ increases) or conflict is less costly ($C$ decreases), aggression becomes more prevalent.\nThe average population payoff at this equilibrium, $\\bar{\\pi}(p^{\\ast}) = \\frac{V(C-V)}{2C}$, represents the average fitness of an individual. It is noteworthy that this payoff is less than the payoff a population of all Doves would achieve, which is $\\frac{V}{2}$. For our values, $\\bar{\\pi}(p^{\\ast}) = \\frac{1}{4}$ while the all-Dove payoff would be $\\frac{1}{2}$. This illustrates a tragedy of the commons: individually advantageous strategies (being a Hawk when Doves are common) lead to a collectively suboptimal outcome. The pure-Dove state is not evolutionarily stable because it is vulnerable to invasion by Hawks. Selection, acting at the individual level, drives the population to a state where costly conflicts are unavoidable, reducing the overall \"efficiency\" or average fitness of the population compared to a hypothetical cooperative ideal.",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{4} \\end{pmatrix}} $$"
        },
        {
            "introduction": "While an ESS tells us where a population might end up, it doesn't describe the journey. This practice delves into the dynamics of evolution, exploring how a population's composition changes over time using the discrete-time replicator map. You will analyze the stability of the Hawk-Dove equilibrium and discover how the rate of evolution, represented by the step-size parameter $\\alpha$, critically determines whether the population converges to equilibrium, oscillates around it, or diverges entirely. This exercise provides an essential lesson in the nuances of dynamic modeling and the importance of numerical stability .",
            "id": "4115967",
            "problem": "Consider the Hawk–Dove game in a well-mixed infinite population with fraction $x_t \\in [0,1]$ of Hawks at discrete time $t \\in \\mathbb{N}$. The game is parameterized by a resource value $V>0$ and a conflict cost $C>V$. The payoff matrix is defined as follows: when two Hawks meet, each receives $(V-C)/2$; a Hawk meeting a Dove gets $V$ while the Dove gets $0$; two Doves share the resource and each receives $V/2$. The population evolves according to the discrete-time replicator map\n$$\nx_{t+1} \\;=\\; x_t \\;+\\; \\alpha \\, x_t \\, (1-x_t) \\, \\big(\\pi_H(x_t) - \\pi_D(x_t)\\big),\n$$\nwhere $\\alpha>0$ is a fixed step size, $\\pi_H(x)$ is the expected payoff to a Hawk at population state $x$, and $\\pi_D(x)$ is the expected payoff to a Dove at population state $x$. \n\nTasks:\n1) From first principles of expected payoffs in a well-mixed population, derive the payoff difference $\\Delta \\pi(x) = \\pi_H(x)-\\pi_D(x)$ in terms of $V$, $C$, and $x$. Use only the definition of expectation over random encounters in a well-mixed population and the given payoff matrix.\n2) Show that there is an interior fixed point $x^\\star \\in (0,1)$ for $C>V>0$, and express $x^\\star$ in terms of $V$ and $C$ by solving the fixed-point condition $\\Delta \\pi(x^\\star)=0$.\n3) Define $f(x) = x + \\alpha \\, x(1-x)\\Delta\\pi(x)$. Using the standard one-dimensional discrete-time stability criterion that a fixed point $x^\\star$ is locally asymptotically stable if and only if $|f'(x^\\star)|<1$, derive the explicit constraint on $\\alpha$ (as an inequality in terms of $V$ and $C$) that guarantees local asymptotic stability of the interior fixed point and prevents oscillatory divergence near $x^\\star$.\n4) Additionally, derive the stricter condition on $\\alpha$ under which the local convergence to $x^\\star$ is monotone (i.e., without alternating overshoots near $x^\\star$).\n5) Implement a program that:\n   - Computes the interior fixed point $x^\\star$ and the analytically derived upper bound $\\alpha_{\\max}$ that enforces $|f'(x^\\star)|<1$.\n   - Computes the monotone-convergence threshold $\\alpha_{\\mathrm{mono}}$ derived in task $4)$.\n   - Numerically validates, using a one-step perturbation test from $x^\\star + \\delta$ with a small $\\delta>0$, that:\n     - For $\\alpha_{\\text{low}} = 0.99 \\, \\alpha_{\\max}$, the deviation decreases in magnitude in one step (local stability).\n     - For $\\alpha_{\\text{high}} = 1.01 \\, \\alpha_{\\max}$, the deviation increases in magnitude in one step (local instability via oscillatory divergence).\n     - For $\\alpha_{\\mathrm{mono,low}} = 0.99 \\, \\alpha_{\\mathrm{mono}}$, the deviation decreases in magnitude in one step and does not change sign (local monotone convergence).\n   - Uses $\\delta = 10^{-6}$, and a single-step check as described above for each validation.\n   - Reports, for each test case, a list containing [`$\\alpha_{\\max}$`, `stable_below`, `unstable_above`, `$\\alpha_{\\mathrm{mono}}$`, `monotone_below`], where `$\\alpha_{\\max}$` and `$\\alpha_{\\mathrm{mono}}$` are floats, and the other entries are booleans.\n   \nUse the following test suite of parameters $(V,C)$ with $C>V>0$:\n- Test A: $V = 1$, $C = 5$.\n- Test B: $V = 2$, $C = 10$.\n- Test C: $V = 9$, $C = 10$.\n- Test D: $V = 0.2$, $C = 1$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the test cases, in order A, B, C, D, as a comma-separated list of lists enclosed in square brackets (e.g., $[[\\dots],[\\dots],[\\dots],[\\dots]]$). No additional whitespace or text should be printed.",
            "solution": "We proceed from first principles. In a well-mixed population with Hawk fraction $x \\in [0,1]$, the probability that a randomly encountered opponent is a Hawk is $x$, and Dove is $(1-x)$. The expected payoffs follow from the given matrix.\n\n1) The expected payoff to a Hawk is\n$$\n\\pi_H(x) \\;=\\; x \\cdot \\frac{V-C}{2} \\;+\\; (1-x)\\cdot V.\n$$\nThe expected payoff to a Dove is\n$$\n\\pi_D(x) \\;=\\; x \\cdot 0 \\;+\\; (1-x)\\cdot \\frac{V}{2}.\n$$\nTherefore, the payoff difference is\n$$\n\\Delta \\pi(x) \\;=\\; \\pi_H(x) - \\pi_D(x) \n\\;=\\; x\\cdot \\frac{V-C}{2} + (1-x)\\cdot V \\;-\\; (1-x)\\cdot \\frac{V}{2}.\n$$\nSimplifying,\n$$\n\\Delta \\pi(x) \n= \\frac{1}{2}\\Big[x(V-C) + (1-x)V\\Big]\n= \\frac{1}{2}\\Big[xV - xC + V - xV\\Big]\n= \\frac{1}{2}\\Big[V - Cx\\Big]\n= \\frac{V - Cx}{2}.\n$$\n\n2) An interior fixed point $x^\\star \\in (0,1)$ must satisfy $\\Delta \\pi(x^\\star) = 0$. Using the expression above,\n$$\n\\frac{V - Cx^\\star}{2} = 0 \\;\\;\\Longrightarrow\\;\\; x^\\star = \\frac{V}{C}.\n$$\nSince $C>V>0$, it follows that $x^\\star \\in (0,1)$ as required.\n\n3) Define the one-step map\n$$\nf(x) \\;=\\; x \\;+\\; \\alpha \\, x(1-x)\\Delta\\pi(x)\n\\;=\\; x \\;+\\; \\alpha \\, x(1-x)\\cdot \\frac{V - Cx}{2}.\n$$\nLet $g(x) = x(1-x)\\Delta\\pi(x) = \\dfrac{1}{2}x(1-x)(V-Cx)$. Then $f(x) = x + \\alpha g(x)$, so\n$$\nf'(x) = 1 + \\alpha g'(x).\n$$\nWe compute $g'(x)$:\n$$\ng(x) = \\frac{1}{2}x(1-x)(V-Cx)\n= \\frac{1}{2}\\Big[(1-2x)(V-Cx) + x(1-x)(-C)\\Big] \\quad \\text{by product rule}.\n$$\nEvaluating at $x^\\star$ where $(V-Cx^\\star)=0$ annihilates the first term, hence\n$$\ng'(x^\\star) = \\frac{1}{2}\\, x^\\star(1-x^\\star)(-C) \n= -\\,\\frac{C}{2}\\,\\frac{V}{C}\\Big(1 - \\frac{V}{C}\\Big)\n= -\\,\\frac{V(C-V)}{2C}.\n$$\nTherefore,\n$$\nf'(x^\\star) \\;=\\; 1 + \\alpha g'(x^\\star) \\;=\\; 1 - \\alpha\\,\\frac{V(C-V)}{2C}.\n$$\nThe standard stability criterion for a one-dimensional discrete-time map states that $x^\\star$ is locally asymptotically stable if and only if $|f'(x^\\star)|<1$. Thus,\n$$\n\\big|\\,1 - \\alpha\\,\\frac{V(C-V)}{2C}\\,\\big| \\;<\\; 1.\n$$\nThis inequality is equivalent to\n$$\n-1 \\;<\\; 1 - \\alpha\\,\\frac{V(C-V)}{2C} \\;<\\; 1,\n$$\nwhose left part gives\n$$\n-1 < 1 - \\alpha\\,\\frac{V(C-V)}{2C} \\;\\;\\Longleftrightarrow\\;\\; \\alpha\\,\\frac{V(C-V)}{2C} < 2 \\;\\;\\Longleftrightarrow\\;\\; \\alpha < \\frac{4C}{V(C-V)},\n$$\nand whose right part gives\n$$\n1 - \\alpha\\,\\frac{V(C-V)}{2C} < 1 \\;\\;\\Longleftrightarrow\\;\\; -\\alpha\\,\\frac{V(C-V)}{2C} < 0 \\;\\;\\Longleftrightarrow\\;\\; \\alpha > 0.\n$$\nCombining, the local asymptotic stability condition that also prevents oscillatory divergence (i.e., ensures $|f'(x^\\star)|<1$) is\n$$\n0 \\;<\\; \\alpha \\;<\\; \\frac{4C}{V(C-V)}.\n$$\n\n4) To guarantee monotone local convergence (i.e., without sign-flipping oscillations in the deviations near $x^\\star$), we additionally require $f'(x^\\star)\\ge 0$. Using $f'(x^\\star) = 1 - \\alpha\\,\\dfrac{V(C-V)}{2C}$, monotonicity is ensured by\n$$\n1 - \\alpha\\,\\frac{V(C-V)}{2C} \\;\\ge\\; 0 \\;\\;\\Longleftrightarrow\\;\\; \\alpha \\;\\le\\; \\frac{2C}{V(C-V)}.\n$$\nThus, a sufficient condition for monotone local convergence is\n$$\n0 \\;<\\; \\alpha \\;\\le\\; \\frac{2C}{V(C-V)},\n$$\nwhereas the broader stability region without oscillatory divergence is\n$$\n0 \\;<\\; \\alpha \\;<\\; \\frac{4C}{V(C-V)}.\n$$\n\n5) Algorithmic design for the program:\n- Input: For each test case $(V,C)$, compute $x^\\star = V/C$, $\\kappa = \\dfrac{V(C-V)}{2C}$, $\\alpha_{\\max} = \\dfrac{2}{\\kappa} = \\dfrac{4C}{V(C-V)}$, and $\\alpha_{\\mathrm{mono}} = \\dfrac{1}{\\kappa} = \\dfrac{2C}{V(C-V)}$.\n- Define the map\n$$\nx_{t+1} = x_t + \\alpha \\, x_t (1-x_t)\\,\\frac{V - Cx_t}{2}.\n$$\n- Use a small perturbation $\\delta = 10^{-6}$ and set $x_0 = x^\\star + \\delta$.\n- One-step validation checks:\n  - For $\\alpha_{\\text{low}} = 0.99\\,\\alpha_{\\max}$, compute $x_1$ and check $|x_1 - x^\\star| < |x_0 - x^\\star|$ to return a boolean $\\text{stable\\_below}$.\n  - For $\\alpha_{\\text{high}} = 1.01\\,\\alpha_{\\max}$, compute $x_1$ and check $|x_1 - x^\\star| > |x_0 - x^\\star|$ to return a boolean $\\text{unstable\\_above}$.\n  - For $\\alpha_{\\mathrm{mono,low}} = 0.99\\,\\alpha_{\\mathrm{mono}}$, compute $x_1$ and check two conditions: $|x_1 - x^\\star| < |x_0 - x^\\star|$ and $(x_1 - x^\\star)(x_0 - x^\\star) \\ge 0$ (no sign flip), returning boolean $\\text{monotone\\_below}$.\n- Output for each test $(V,C)$ the list $[\\alpha_{\\max}, \\text{stable\\_below}, \\text{unstable\\_above}, \\alpha_{\\mathrm{mono}}, \\text{monotone\\_below}]$.\n\nAnalytical values for the test suite:\n- Test A: $V=1$, $C=5$:\n  - $\\kappa = \\dfrac{1\\cdot(5-1)}{2\\cdot 5} = \\dfrac{4}{10} = 0.4$,\n  - $\\alpha_{\\max} = \\dfrac{2}{0.4} = 5.0$,\n  - $\\alpha_{\\mathrm{mono}} = \\dfrac{1}{0.4} = 2.5$.\n- Test B: $V=2$, $C=10$:\n  - $\\kappa = \\dfrac{2\\cdot(10-2)}{2\\cdot 10} = \\dfrac{16}{20} = 0.8$,\n  - $\\alpha_{\\max} = \\dfrac{2}{0.8} = 2.5$,\n  - $\\alpha_{\\mathrm{mono}} = \\dfrac{1}{0.8} = 1.25$.\n- Test C: $V=9$, $C=10$:\n  - $\\kappa = \\dfrac{9\\cdot(10-9)}{2\\cdot 10} = \\dfrac{9}{20} = 0.45$,\n  - $\\alpha_{\\max} = \\dfrac{2}{0.45} = \\dfrac{40}{9} \\approx 4.444444444444445$,\n  - $\\alpha_{\\mathrm{mono}} = \\dfrac{1}{0.45} = \\dfrac{20}{9} \\approx 2.2222222222222223$.\n- Test D: $V=0.2$, $C=1$:\n  - $\\kappa = \\dfrac{0.2\\cdot(1-0.2)}{2\\cdot 1} = \\dfrac{0.16}{2} = 0.08$,\n  - $\\alpha_{\\max} = \\dfrac{2}{0.08} = 25.0$,\n  - $\\alpha_{\\mathrm{mono}} = \\dfrac{1}{0.08} = 12.5$.\n\nThe one-step validation matches the analytical derivative test: at $\\alpha_{\\text{low}} = 0.99\\,\\alpha_{\\max}$, $|f'(x^\\star)| = |1 - \\alpha_{\\text{low}}\\kappa| = |1 - 1.98| = 0.98 < 1$ (stable); at $\\alpha_{\\text{high}} = 1.01\\,\\alpha_{\\max}$, $|f'(x^\\star)| = |1 - 2.02| = 1.02 > 1$ (unstable); and at $\\alpha_{\\mathrm{mono,low}} = 0.99\\,\\alpha_{\\mathrm{mono}}$, $f'(x^\\star) = 1 - 0.99 = 0.01 \\ge 0$ with magnitude less than $1$ (monotone stable). Hence the program will report, for each test case, the computed $\\alpha_{\\max}$ and $\\alpha_{\\mathrm{mono}}$ together with boolean validations in agreement with these inequalities.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef replicator_step(x, alpha, V, C):\n    # One-step discrete-time replicator map for Hawk fraction x\n    delta_pi = 0.5 * (V - C * x)\n    return x + alpha * x * (1.0 - x) * delta_pi\n\ndef compute_bounds(V, C):\n    # Compute kappa, alpha stability and monotonicity bounds\n    kappa = (V * (C - V)) / (2.0 * C)\n    alpha_max = 2.0 / kappa  # equivalently 4C/(V(C-V))\n    alpha_mono = 1.0 / kappa # equivalently 2C/(V(C-V))\n    return kappa, alpha_max, alpha_mono\n\ndef validate_one_step(V, C, alpha, delta=1e-6):\n    # Validate by a single step from x* + delta\n    x_star = V / C\n    x0 = x_star + delta\n    x1 = replicator_step(x0, alpha, V, C)\n    dev0 = abs(x0 - x_star)\n    dev1 = abs(x1 - x_star)\n    sign_no_flip = (x1 - x_star) * (x0 - x_star) >= 0.0\n    return dev1, dev0, sign_no_flip\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is (V, C)\n    test_cases = [\n        (1.0, 5.0),     # Test A\n        (2.0, 10.0),    # Test B\n        (9.0, 10.0),    # Test C\n        (0.2, 1.0),     # Test D\n    ]\n\n    results = []\n    for V, C in test_cases:\n        # Compute analytic bounds\n        kappa, alpha_max, alpha_mono = compute_bounds(V, C)\n\n        # Alpha choices for validation\n        alpha_low = 0.99 * alpha_max\n        alpha_high = 1.01 * alpha_max\n        alpha_mono_low = 0.99 * alpha_mono\n\n        # One-step validations\n        dev1_low, dev0_low, _ = validate_one_step(V, C, alpha_low)\n        stable_below = (dev1_low < dev0_low)\n\n        dev1_high, dev0_high, _ = validate_one_step(V, C, alpha_high)\n        unstable_above = (dev1_high > dev0_high)\n\n        dev1_mono, dev0_mono, no_flip = validate_one_step(V, C, alpha_mono_low)\n        monotone_below = (dev1_mono < dev0_mono) and no_flip\n\n        # Append result for this test case:\n        # [alpha_max, stable_below, unstable_above, alpha_mono, monotone_below]\n        results.append([alpha_max, stable_below, unstable_above, alpha_mono, monotone_below])\n\n    # Final print statement in the exact required format.\n    print(str(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "The models of infinite populations provide powerful insights, but real biological and social systems are finite. In such populations, random chance—or genetic drift—plays a significant role alongside natural selection. This final practice moves from deterministic dynamics to a stochastic framework by modeling the Hawk-Dove game in a finite population using the Moran process. You will derive and compute the fixation probability of a single Hawk mutant, allowing you to quantify how the interplay between selection pressure ($\\beta$) and random drift determines the ultimate fate of a new strategy .",
            "id": "4115929",
            "problem": "Consider a well-mixed finite population of size $N$ composed of individuals that can play either the Hawk strategy or the Dove strategy in the canonical Hawk–Dove game. Interactions are pairwise and random among distinct individuals, and the average payoff to each type is computed by averaging over the distribution of opponents in the current population state. Let the benefit of the resource be $V$ and the cost of conflict be $C$. The Hawk–Dove payoff matrix is defined as follows: when two Hawks interact, each receives $(V-C)/2$; when a Hawk meets a Dove, the Hawk receives $V$ and the Dove receives $0$; when two Doves interact, each receives $V/2$. Assume that payoffs map to fitness via an exponential mapping with selection intensity $\\beta$, so that the fitness of Hawks and Doves at a given population state is $f_H=\\exp(\\beta \\pi_H)$ and $f_D=\\exp(\\beta \\pi_D)$, where $\\pi_H$ and $\\pi_D$ denote the average payoffs of Hawk and Dove respectively under random matching without self-interaction. The population evolves according to a birth–death Moran process: at each step, an individual is chosen to reproduce with probability proportional to fitness, and its offspring replaces a randomly chosen individual uniformly from the population.\n\nStarting from the fundamental definitions above—expected payoffs from the Hawk–Dove matrix under well-mixed random matching, the exponential fitness mapping, and the birth–death Moran process on a finite Markov Chain (MC) with absorbing states at $i=0$ (no Hawks) and $i=N$ (all Hawks)—derive from first principles the fixation probability of a single Hawk introduced into an all-Dove population. Do not assume any pre-formed fixation formula; instead, derive the relevant transition probabilities and the fixation probability expression for the frequency-dependent case by solving the appropriate backward equations for the MC.\n\nImplement the derived computation in a program that, for given parameters $(N,V,C,\\beta)$, returns the fixation probability $\\rho$ of a single Hawk and evaluates whether selection increases or decreases this probability relative to neutrality. Neutrality is defined as $\\beta=0$, for which the fixation probability of a single mutant in a finite well-mixed population is $1/N$. Your evaluation must be encoded as an integer $\\Delta$ defined by\n- $\\Delta=1$ if $\\rho$ is strictly greater than $1/N$,\n- $\\Delta=0$ if $\\rho$ equals $1/N$ within a numerical tolerance,\n- $\\Delta=-1$ if $\\rho$ is strictly less than $1/N$.\n\nUse a numerical tolerance of $10^{-12}$ for equality comparison. All computations are dimensionless; no physical units are involved.\n\nYour program must compute results for the following test suite:\n1. $N=50$, $V=1$, $C=2$, $\\beta=0.1$.\n2. $N=50$, $V=1$, $C=2$, $\\beta=0$.\n3. $N=50$, $V=1$, $C=2$, $\\beta=-0.1$.\n4. $N=2$, $V=1$, $C=2$, $\\beta=0.1$.\n5. $N=50$, $V=2$, $C=1$, $\\beta=0.1$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each result corresponds to one test case and is itself a two-element list of the form $[\\rho,\\Delta]$. For example, the output should look like $[[\\rho_1,\\Delta_1],[\\rho_2,\\Delta_2],\\dots]$, with $\\rho_k$ printed as a floating-point number and $\\Delta_k$ as an integer.",
            "solution": "The problem is valid as it is scientifically grounded in evolutionary game theory, well-posed, and all parameters and dynamics are specified unambiguously. I will now derive the fixation probability from first principles.\n\nLet the state of the population of size $N$ be the number of Hawk individuals, denoted by $i \\in \\{0, 1, \\dots, N\\}$. The number of Dove individuals is correspondingly $N-i$. The states $i=0$ (all Doves) and $i=N$ (all Hawks) are absorbing states.\n\nFirst, we determine the average payoffs for a Hawk, $\\pi_H(i)$, and a Dove, $\\pi_D(i)$, in a population with $i$ Hawks. Interactions are random pairings of distinct individuals. An individual of a given type is paired with an opponent drawn uniformly from the other $N-1$ individuals.\n\nFor a Hawk player, the opponent is a Hawk with probability $\\frac{i-1}{N-1}$ and a Dove with probability $\\frac{N-i}{N-1}$. The payoff matrix is given as: $E(H,H) = (V-C)/2$, $E(H,D) = V$. The average payoff to a Hawk is:\n$$ \\pi_H(i) = \\frac{i-1}{N-1} \\left( \\frac{V-C}{2} \\right) + \\frac{N-i}{N-1} V \\quad \\text{for } i \\in \\{1, \\dots, N\\} $$\n\nFor a Dove player, the opponent is a Hawk with probability $\\frac{i}{N-1}$ and a Dove with probability $\\frac{N-i-1}{N-1}$. The payoffs are $E(D,H) = 0$ and $E(D,D) = V/2$. The average payoff to a Dove is:\n$$ \\pi_D(i) = \\frac{i}{N-1} (0) + \\frac{N-i-1}{N-1} \\left( \\frac{V}{2} \\right) = \\frac{V(N-i-1)}{2(N-1)} \\quad \\text{for } i \\in \\{0, \\dots, N-1\\} $$\n\nThe fitness of Hawks and Doves is given by the exponential mapping $f = \\exp(\\beta \\pi)$, where $\\beta$ is the selection intensity.\n$$ f_H(i) = \\exp(\\beta \\pi_H(i)) $$\n$$ f_D(i) = \\exp(\\beta \\pi_D(i)) $$\n\nThe population evolves under a birth-death Moran process. At each time step, an individual is chosen for reproduction with probability proportional to its fitness, and its offspring replaces a randomly chosen individual.\nThe total fitness of the population is $F_{total}(i) = i f_H(i) + (N-i) f_D(i)$.\n\nThe number of Hawks increases by one ($i \\to i+1$) if a Hawk reproduces and its offspring replaces a Dove. The probability for this event, $T_i^+$, is:\n$$ T_i^+ = \\left( \\frac{i f_H(i)}{i f_H(i) + (N-i) f_D(i)} \\right) \\left( \\frac{N-i}{N} \\right) $$\n\nThe number of Hawks decreases by one ($i \\to i-1$) if a Dove reproduces and its offspring replaces a Hawk. The probability for this event, $T_i^-$, is:\n$$ T_i^- = \\left( \\frac{(N-i) f_D(i)}{i f_H(i) + (N-i) f_D(i)} \\right) \\left( \\frac{i}{N} \\right) $$\nThese transition probabilities are valid for $i \\in \\{1, \\dots, N-1\\}$.\n\nLet $\\rho_i$ be the fixation probability of Hawks starting from state $i$. The boundary conditions are $\\rho_0 = 0$ and $\\rho_N = 1$. For any transient state $i$, $\\rho_i$ must satisfy the backward Kolmogorov equation:\n$$ \\rho_i = T_i^+ \\rho_{i+1} + T_i^- \\rho_{i-1} + (1-T_i^+-T_i^-) \\rho_i $$\nThis simplifies to $T_i^+(\\rho_{i+1} - \\rho_i) = T_i^-(\\rho_i - \\rho_{i-1})$.\nLet us define the ratio $\\gamma_i = T_i^- / T_i^+$ for $i \\in \\{1, \\dots, N-1\\}$.\n$$ \\gamma_i = \\frac{\\frac{(N-i) f_D(i)}{F_{total}(i)} \\frac{i}{N}}{\\frac{i f_H(i)}{F_{total}(i)} \\frac{N-i}{N}} = \\frac{f_D(i)}{f_H(i)} = \\exp(\\beta(\\pi_D(i) - \\pi_H(i))) $$\nThe recurrence becomes $\\rho_{i+1} - \\rho_i = \\gamma_i (\\rho_i - \\rho_{i-1})$.\nThis is a geometric progression for the differences $\\Delta_i = \\rho_i - \\rho_{i-1}$. We can write $\\Delta_{k} = \\Delta_1 \\prod_{j=1}^{k-1} \\gamma_j$ for $k > 1$.\nSince $\\rho_0 = 0$, we have $\\Delta_1 = \\rho_1 - \\rho_0 = \\rho_1$. So, $\\rho_k - \\rho_{k-1} = \\rho_1 \\prod_{j=1}^{k-1} \\gamma_j$.\nTo find $\\rho_i$, we sum the differences:\n$$ \\rho_i = \\sum_{k=1}^{i} (\\rho_k - \\rho_{k-1}) = \\rho_1 \\sum_{k=1}^{i} \\prod_{j=1}^{k-1} \\gamma_j $$\nUsing the convention that an empty product $\\prod_{j=1}^0$ is $1$.\nTo find $\\rho_1$, we apply the boundary condition $\\rho_N=1$:\n$$ 1 = \\rho_N = \\rho_1 \\sum_{k=1}^{N} \\prod_{j=1}^{k-1} \\gamma_j $$\nSolving for $\\rho_1$, the fixation probability of a single Hawk mutant, we get:\n$$ \\rho = \\rho_1 = \\frac{1}{\\sum_{k=1}^{N} \\prod_{j=1}^{k-1} \\gamma_j} = \\frac{1}{1 + \\sum_{k=2}^{N} \\prod_{j=1}^{k-1} \\gamma_j} $$\nA more standard form is:\n$$ \\rho = \\frac{1}{1 + \\sum_{k=1}^{N-1} \\prod_{j=1}^{k} \\gamma_j} $$\nTo implement this, we need the expression for $\\gamma_j$:\n$$ \\pi_D(j) - \\pi_H(j) = \\frac{1}{N-1} \\left[ \\frac{V(N-j-1)}{2} - \\left( \\frac{V-C}{2}(j-1) + V(N-j) \\right) \\right] $$\n$$ = \\frac{1}{2(N-1)} [V(N-j-1) - (V-C)(j-1) - 2V(N-j)] $$\n$$ = \\frac{1}{2(N-1)} [VN-Vj-V - (Vj-V-Cj+C) - 2VN+2Vj] = \\frac{C(j-1) - VN + Cj - C}{2(N-1)} $$\n$$ \\gamma_j = \\exp\\left( \\beta \\frac{C(j-1) - VN}{2(N-1)} \\right) $$\nThis expression for $\\gamma_j$ will be used in the summation to calculate $\\rho$.\n\nFor the neutral case, $\\beta=0$, which implies $\\gamma_j = \\exp(0) = 1$ for all $j$. The fixation probability becomes:\n$$ \\rho = \\frac{1}{1 + \\sum_{k=1}^{N-1} \\prod_{j=1}^{k} 1} = \\frac{1}{1 + \\sum_{k=1}^{N-1} 1} = \\frac{1}{1 + (N-1)} = \\frac{1}{N} $$\nThis confirms the result for neutral drift.\n\nThe computational procedure is to calculate $\\rho$ using the derived formula for each set of parameters $(N, V, C, \\beta)$. Then, compare the calculated $\\rho$ with the neutral probability $1/N$ to determine $\\Delta \\in \\{-1, 0, 1\\}$ based on the specified tolerance of $10^{-12}$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Hawk-Dove fixation probability problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (N, V, C, beta)\n        (50, 1, 2, 0.1),\n        (50, 1, 2, 0.0),\n        (50, 1, 2, -0.1),\n        (2, 1, 2, 0.1),\n        (50, 2, 1, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_fixation_and_delta(case)\n        results.append(result)\n\n    # Format the output string as required: [[rho_1,delta_1],[rho_2,delta_2],...]\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef compute_fixation_and_delta(params):\n    \"\"\"\n    Computes the fixation probability rho and the selection direction delta.\n\n    The derivation shows the fixation probability of a single mutant is:\n    rho = 1 / (1 + sum_{k=1}^{N-1} prod_{j=1}^{k} gamma_j)\n    where gamma_j = exp(beta * (pi_D(j) - pi_H(j))).\n    The payoff difference is:\n    pi_D(j) - pi_H(j) = (C*(j-1) - V*N) / (2*(N-1))\n    \"\"\"\n    N, V, C, beta = params\n    N = int(N)\n    V = float(V)\n    C = float(C)\n    beta = float(beta)\n    \n    neutral_rho = 1.0 / N\n\n    # Handle the neutral case beta = 0, where rho = 1/N.\n    if beta == 0.0:\n        return [neutral_rho, 0]\n\n    # Denominator of the fixation probability formula.\n    # It is S = 1 + sum_{k=1}^{N-1} prod_{j=1}^{k} gamma_j\n    S = 1.0\n    current_product = 1.0\n\n    # The loop calculates the sum of products.\n    # k runs from 1 to N-1 for the sum, and in each term,\n    # a running product from j=1 to k is calculated.\n    for k in range(1, N):\n        # Calculate gamma_k\n        payoff_diff = (C * (k - 1) - V * N + Cj - C) / (2.0 * (N - 1))\n        exponent = beta * payoff_diff\n        gamma_k = np.exp(exponent)\n        \n        # Update the product term prod_{j=1}^{k} gamma_j\n        current_product *= gamma_k\n        \n        # Add the new product term to the sum S\n        S += current_product\n\n    rho = 1.0 / S\n\n    # Compare rho with neutral_rho to determine delta\n    tolerance = 1e-12\n    if abs(rho - neutral_rho) <= tolerance:\n        delta = 0\n    elif rho > neutral_rho:\n        delta = 1\n    else: # rho < neutral_rho\n        delta = -1\n        \n    return [rho, delta]\n\nif __name__ == \"__main__\":\n    solve()\n```\n## Correction on the final problem\nI found an error in my own checking process. The payoff difference in `hands_on_practice` problem 3 was `pi_D(j) - pi_H(j) = (C(j-1) - VN) / (2(N-1))`. The Python code was written to implement this, but there was a typo introduced `+ Cj - C` which is incorrect.\nThe correct formula is `(C*(k-1) - V*N) / (2.0 * (N-1))`\nThe Python code had a typo: `(C * (k - 1) - V * N + Cj - C) / (2.0 * (N - 1))`\nI need to fix the Python code. `Cj` and `C` are undefined. This should be removed.\n\nCorrected Python code for `hands_on_practice` 3:\n```python\nimport numpy as np\n\ndef compute_fixation_and_delta(params):\n    #...\n    for k in range(1, N):\n        # Calculate gamma_k\n        payoff_diff = (C * (k - 1) - V * N) / (2.0 * (N - 1))\n        exponent = beta * payoff_diff\n        gamma_k = np.exp(exponent)\n        #...\n```\nI will fix this in the final output. This was a sneaky error.\nLet's check the derivation of `pi_D(j) - pi_H(j)` in the solution text one more time.\nIt says `... = \\frac{C(j-1) - VN}{2(N-1)}`. This is correct.\nThen it has a typo in the line before it: `... = \\frac{C(j-1) - VN + Cj - C}{2(N-1)}`. This is clearly a copy-paste error or something. The `+ Cj - C` part is wrong. $C(j-1)$ is $Cj-C$. So it would be $-VN + Cj - C + Cj - C$. This doesn't make sense.\nI will fix the intermediate derivation step in the solution text as well.\nThe line `$$ = \\frac{1}{2(N-1)} [VN-Vj-V - (Vj-V-Cj+C) - 2VN+2Vj] = \\frac{C(j-1) - VN + Cj - C}{2(N-1)} $$` is flawed.\nCorrect expansion:\n$$ \\pi_D(j) - \\pi_H(j) = \\frac{1}{2(N-1)} \\left[ V(N-j-1) - \\big( (V-C)(j-1) + 2V(N-j) \\big) \\right] $$\n$$ = \\frac{1}{2(N-1)} \\left[ VN-Vj-V - (Vj-V-Cj+C) - (2VN - 2Vj) \\right] $$\n$$ = \\frac{1}{2(N-1)} \\left[ VN-Vj-V - Vj+V+Cj-C - 2VN+2Vj \\right] $$\n$$ = \\frac{1}{2(N-1)} \\left[ (VN-2VN) + (-Vj-Vj+2Vj) + (-V+V) + (Cj-C) \\right] $$\n$$ = \\frac{1}{2(N-1)} \\left[ -VN + C(j-1) \\right] = \\frac{C(j-1)-VN}{2(N-1)} $$\nThe intermediate step in the solution was wrong. I will correct it. And fix the python code.\n\nOkay, I have my final set of corrections. I will now write the full output."
        }
    ]
}