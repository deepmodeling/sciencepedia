{
    "hands_on_practices": [
        {
            "introduction": "鹰鸽博弈是理解冲突与合作演化的基础模型。掌握该模型的首要步骤是确定其平衡状态，即所谓的演化稳定策略（ESS）。此练习将引导你通过计算来确定混合策略下的ESS，并深入探讨其在生物学意义上如何反映资源价值 $V$ 与冲突成本 $C$ 之间的权衡。通过这个基础计算，你将为理解更复杂的动态系统奠定坚实的数学基础 。",
            "id": "4115970",
            "problem": "考虑一个对称的双策略演化博弈，该博弈代表了经典的鹰鸽互动，围绕一个价值为 $V$ 的共享资源进行，其中存在代价为 $C$ 的高昂冲突。两种策略是鹰策略（Hawk, $H$）和鸽策略（Dove, $D$）。每次相遇的收益规定如下：当两只鹰相遇时，每只获得 $\\frac{V - C}{2}$；当一只鹰遇到一只鸽时，鹰获得 $V$，鸽获得 $0$；当两只鸽相遇时，每只获得 $\\frac{V}{2}$。设 $p \\in [0,1]$ 表示在一个大型、充分混合且随机匹配的种群中，鹰策略所占的比例。\n\n从期望收益的标准定义和演化稳定策略（Evolutionarily Stable Strategy, ESS）的定义出发，推导当 $V = 1$ 和 $C = 2$ 时，鹰策略的混合ESS频率 $p^{\\ast}$，并根据复制子动态 $\\dot{p} = p(1 - p)\\big(\\pi_{H}(p) - \\pi_{D}(p)\\big)$ 验证其局部稳定性，其中 $\\pi_{H}(p)$ 和 $\\pi_{D}(p)$ 分别是当种群中鹰策略频率为 $p$ 时，鹰策略和鸽策略的期望收益。计算在混合均衡时的平均种群收益。\n\n最后，简要解释在你计算出的均衡点上，在存在高昂代价冲突的情况下分配共享资源的生物学意义，重点关注 $V$ 和 $C$ 如何塑造适应性结果和总体效率。\n\n将你最终得到的混合均衡中鹰策略频率和平均种群收益的数值输出表示为一个双元素行向量 $\\big[p^{\\ast} \\;\\; \\bar{\\pi}(p^{\\ast})\\big]$，使用精确值。无需四舍五入。",
            "solution": "该问题是有效的。这是一个标准的、适定的演化博弈论问题，基于已确立的科学原理。所有必要信息都已提供，术语定义明确。\n\n首先，我们通过构建收益矩阵来将问题形式化。设选择行策略的博弈方为焦点个体，选择列策略的博弈方为对手。策略为鹰策略（Hawk, $H$）和鸽策略（Dove, $D$）。收益矩阵 $A$ 如下所示：\n$$ A = \\begin{pmatrix} \\pi(H,H)  \\pi(H,D) \\\\ \\pi(D,H)  \\pi(D,D) \\end{pmatrix} = \\begin{pmatrix} \\frac{V - C}{2}  V \\\\ 0  \\frac{V}{2} \\end{pmatrix} $$\n此处，$\\pi(i,j)$ 是一个个体使用策略 $i$ 对抗一个使用策略 $j$ 的对手时获得的收益。资源价值为 $V$，冲突代价为 $C$。\n\n设 $p$ 为种群中鹰策略的频率，则鸽策略的频率为 $1-p$。在一个大型、充分混合且随机匹配的种群中，鹰策略的期望收益 $\\pi_{H}(p)$ 和鸽策略的期望收益 $\\pi_{D}(p)$ 可以计算如下：\n$$ \\pi_{H}(p) = p \\cdot \\pi(H,H) + (1-p) \\cdot \\pi(H,D) = p\\left(\\frac{V - C}{2}\\right) + (1-p)V $$\n$$ \\pi_{D}(p) = p \\cdot \\pi(D,H) + (1-p) \\cdot \\pi(D,D) = p(0) + (1-p)\\frac{V}{2} $$\n\n演化稳定策略（ESS）是一种策略，如果一个种群采纳了这种策略，那么任何初始时稀少的替代策略都无法入侵。当纯策略的期望收益相等时，就会出现一个由频率 $p^{\\ast} \\in (0,1)$ 表示的混合ESS。这种相等意味着在这个特定频率下，两种策略都没有选择优势。\n$$ \\pi_{H}(p^{\\ast}) = \\pi_{D}(p^{\\ast}) $$\n代入期望收益的表达式：\n$$ p^{\\ast}\\left(\\frac{V - C}{2}\\right) + (1-p^{\\ast})V = (1-p^{\\ast})\\frac{V}{2} $$\n我们求解 $p^{\\ast}$：\n$$ \\frac{p^{\\ast}V}{2} - \\frac{p^{\\ast}C}{2} + V - p^{\\ast}V = \\frac{V}{2} - \\frac{p^{\\ast}V}{2} $$\n为了分离含有 $p^{\\ast}$ 的项，我们将它们移到方程的一边：\n$$ \\frac{p^{\\ast}V}{2} - \\frac{p^{\\ast}C}{2} - p^{\\ast}V + \\frac{p^{\\ast}V}{2} = \\frac{V}{2} - V $$\n$$ p^{\\ast}\\left(\\frac{V}{2} - \\frac{C}{2} - V + \\frac{V}{2}\\right) = -\\frac{V}{2} $$\n$$ p^{\\ast}\\left(-\\frac{C}{2}\\right) = -\\frac{V}{2} $$\n$$ p^{\\ast} = \\frac{V}{C} $$\n这个混合均衡仅在 $0  p^{\\ast}  1$ 时存在，这要求 $V  C$（假设 $V > 0$ 和 $C > 0$）。问题给出的值为 $V=1$ 和 $C=2$。由于 $1  2$，存在一个混合ESS。\n对于 $V=1$ 和 $C=2$，鹰策略的混合ESS频率为：\n$$ p^{\\ast} = \\frac{1}{2} $$\n\n接下来，我们在复制子动态 $\\dot{p} = p(1 - p)\\big(\\pi_{H}(p) - \\pi_{D}(p)\\big)$ 下验证该均衡的局部稳定性。令 $f(p) = \\pi_{H}(p) - \\pi_{D}(p)$。内部不动点 $p^{\\ast}$ 的局部稳定性由增长率函数 $\\frac{\\dot{p}}{p}$ 的导数，或者更简单地由收益差函数 $f(p)$ 的导数决定。如果 $f'(p^{\\ast})  0$，则内部不动点 $p^{\\ast}$ 是稳定的。\n我们来计算 $f(p)$：\n$$ f(p) = \\left[ p\\left(\\frac{V - C}{2}\\right) + (1-p)V \\right] - \\left[ (1-p)\\frac{V}{2} \\right] $$\n$$ f(p) = p\\left(\\frac{V-C}{2} - V + \\frac{V}{2}\\right) + V - \\frac{V}{2} $$\n$$ f(p) = p\\left(-\\frac{C}{2}\\right) + \\frac{V}{2} $$\n$f(p)$ 关于 $p$ 的导数是：\n$$ f'(p) = \\frac{d}{dp}\\left(\\frac{V}{2} - \\frac{C}{2}p\\right) = -\\frac{C}{2} $$\n为了保证稳定性，我们需要 $f'(p^{\\ast})  0$。由于 $f'(p)$ 是常数 $-\\frac{C}{2}$，且冲突代价 $C=2$ 为正，我们有：\n$$ f'(p^{\\ast}) = -\\frac{2}{2} = -1  0 $$\n该条件得到满足，因此混合均衡 $p^{\\ast} = \\frac{1}{2}$ 是局部稳定的。\n\n现在，我们计算在此均衡下的平均种群收益 $\\bar{\\pi}(p^{\\ast})$。平均收益是鹰策略和鸽策略收益的加权平均：\n$$ \\bar{\\pi}(p) = p \\cdot \\pi_{H}(p) + (1-p) \\cdot \\pi_{D}(p) $$\n在混合均衡 $p^{\\ast}$ 处，根据定义，$\\pi_{H}(p^{\\ast}) = \\pi_{D}(p^{\\ast})$。因此，平均收益简化为任一策略在此频率下的收益：\n$$ \\bar{\\pi}(p^{\\ast}) = \\pi_{D}(p^{\\ast}) = (1-p^{\\ast})\\frac{V}{2} $$\n代入 $p^{\\ast} = V/C$：\n$$ \\bar{\\pi}(p^{\\ast}) = \\left(1 - \\frac{V}{C}\\right)\\frac{V}{2} = \\frac{C-V}{C}\\frac{V}{2} = \\frac{V(C-V)}{2C} $$\n使用给定值 $V=1$ 和 $C=2$：\n$$ \\bar{\\pi}(p^{\\ast}) = \\frac{1(2-1)}{2(2)} = \\frac{1}{4} $$\n所要求的数值输出为 $p^{\\ast} = \\frac{1}{2}$ 和 $\\bar{\\pi}(p^{\\ast}) = \\frac{1}{4}$。\n\n最后，进行简要的生物学解释。攻击性个体（鹰策略）的均衡频率 $p^{\\ast} = V/C$ 由资源价值与冲突成本的比率决定。这表明演化选择在攻击性和被动性之间取得一种平衡，其中攻击性行为的比例由环境特定的成本和收益来调节。当资源更有价值（$V$ 增加）或冲突代价更小（$C$ 减少）时，攻击性变得更加普遍。\n此均衡下的平均种群收益 $\\bar{\\pi}(p^{\\ast}) = \\frac{V(C-V)}{2C}$ 代表了个体的平均适应度。值得注意的是，该收益低于一个全为鸽策略的种群所能获得的收益 $\\frac{V}{2}$。对于我们给定的数值，$\\bar{\\pi}(p^{\\ast}) = \\frac{1}{4}$，而全鸽策略的收益本应是 $\\frac{1}{2}$。这阐释了一种“公地悲剧”：对个体有利的策略（当鸽策略普遍时成为鹰策略）导致了集体次优的结果。纯鸽策略状态不是演化稳定的，因为它容易受到鹰策略的入侵。作用于个体层面的选择将种群推向一个高昂冲突不可避免的状态，与假设的合作理想状态相比，降低了种群的整体“效率”或平均适应度。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{4} \\end{pmatrix}} $$"
        },
        {
            "introduction": "在确定了静态平衡点之后，一个自然而然的问题是：种群是如何达到这个平衡的？本练习将通过复制子动态（replicator dynamics）这一核心演化模型来回答此问题。通过分析该动态的离散时间版本，我们将不仅能验证平衡点的稳定性，还能揭示在数值模拟中至关重要的实际约束，例如步长 $\\alpha$ 的选择如何影响收敛性和避免振荡 。",
            "id": "4115967",
            "problem": "考虑一个充分混合的无限总体中的鹰鸽博弈（Hawk–Dove game），在离散时间 $t \\in \\mathbb{N}$，鹰派（Hawks）的比例为 $x_t \\in [0,1]$。该博弈由资源价值 $V0$ 和冲突成本 $CV$ 参数化。支付矩阵定义如下：当两只鹰相遇时，各获得 $(V-C)/2$；一只鹰遇到一只鸽子（Dove）时，鹰获得 $V$，鸽子获得 $0$；两只鸽子分享资源，各获得 $V/2$。总体根据离散时间复制子映射（discrete-time replicator map）演化：\n$$\nx_{t+1} \\;=\\; x_t \\;+\\; \\alpha \\, x_t \\, (1-x_t) \\, \\big(\\pi_H(x_t) - \\pi_D(x_t)\\big),\n$$\n其中 $\\alpha0$ 是一个固定的步长，$\\pi_H(x)$ 是在总体状态为 $x$ 时鹰派的期望支付，$\\pi_D(x)$ 是在总体状态为 $x$ 时鸽派的期望支付。\n\n任务：\n1) 根据充分混合总体中期望支付的第一性原理，推导出支付差异 $\\Delta \\pi(x) = \\pi_H(x)-\\pi_D(x)$（用 $V$、$C$ 和 $x$ 表示）。仅使用充分混合总体中随机相遇的期望定义和给定的支付矩阵。\n2) 证明对于 $CV0$，存在一个内部不动点 $x^\\star \\in (0,1)$，并通过求解不动点条件 $\\Delta \\pi(x^\\star)=0$ 将 $x^\\star$ 用 $V$ 和 $C$ 表示。\n3) 定义 $f(x) = x + \\alpha \\, x(1-x)\\Delta\\pi(x)$。使用标准的一维离散时间稳定性判据，即不动点 $x^\\star$ 是局部渐近稳定的当且仅当 $|f'(x^\\star)|1$，推导出对 $\\alpha$ 的显式约束（一个关于 $V$ 和 $C$ 的不等式），该约束保证内部不动点的局部渐近稳定性，并防止在 $x^\\star$ 附近出现振荡发散。\n4) 此外，推导出更严格的关于 $\\alpha$ 的条件，在该条件下，向 $x^\\star$ 的局部收敛是单调的（即，在 $x^\\star$ 附近没有交替的过冲）。\n5) 实现一个程序，该程序：\n   - 计算内部不动点 $x^\\star$ 和根据解析推导出的强制 $|f'(x^\\star)|1$ 的上界 $\\alpha_{\\max}$。\n   - 计算在任务4中推导出的单调收敛阈值 $\\alpha_{\\mathrm{mono}}$。\n   - 使用从 $x^\\star + \\delta$（其中 $\\delta0$ 是一个小量）开始的单步扰动测试，进行数值验证，证明：\n     - 对于 $\\alpha_{\\text{low}} = 0.99 \\, \\alpha_{\\max}$，偏差的绝对值在一步内减小（局部稳定性）。\n     - 对于 $\\alpha_{\\text{high}} = 1.01 \\, \\alpha_{\\max}$，偏差的绝对值在一步内增加（通过振荡发散导致的局部不稳定性）。\n     - 对于 $\\alpha_{\\mathrm{mono,low}} = 0.99 \\, \\alpha_{\\mathrm{mono}}$，偏差的绝对值在一步内减小且符号不变（局部单调收敛）。\n   - 对每次验证使用 $\\delta = 10^{-6}$ 和如上所述的单步检查。\n   - 为每个测试用例报告一个列表，包含 $[\\alpha_{\\max}, \\text{stable\\_below}, \\text{unstable\\_above}, \\alpha_{\\mathrm{mono}}, \\text{monotone\\_below}]$，其中 $\\alpha_{\\max}$ 和 $\\alpha_{\\mathrm{mono}}$ 是浮点数，其他条目是布尔值。\n   \n使用以下参数测试套件 $(V,C)$，其中 $CV0$：\n- 测试 A: $V = 1$, $C = 5$。\n- 测试 B: $V = 2$, $C = 10$。\n- 测试 C: $V = 9$, $C = 10$。\n- 测试 D: $V = 0.2$, $C = 1$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按 A、B、C、D 顺序排列的测试用例结果，格式为由方括号括起来的、逗号分隔的列表的列表（例如，$ [[\\dots],[\\dots],[\\dots],[\\dots]]$）。不应打印额外的空格或文本。",
            "solution": "我们从第一性原理出发。在一个鹰派比例为 $x \\in [0,1]$ 的充分混合总体中，随机遇到的对手是鹰的概率为 $x$，是鸽的概率为 $(1-x)$。期望支付可从给定的矩阵得出。\n\n1) 鹰派的期望支付为\n$$\n\\pi_H(x) \\;=\\; x \\cdot \\frac{V-C}{2} \\;+\\; (1-x)\\cdot V.\n$$\n鸽派的期望支付为\n$$\n\\pi_D(x) \\;=\\; x \\cdot 0 \\;+\\; (1-x)\\cdot \\frac{V}{2}.\n$$\n因此，支付差异为\n$$\n\\Delta \\pi(x) \\;=\\; \\pi_H(x) - \\pi_D(x) \n\\;=\\; x\\cdot \\frac{V-C}{2} + (1-x)\\cdot V \\;-\\; (1-x)\\cdot \\frac{V}{2}.\n$$\n化简得，\n$$\n\\Delta \\pi(x) \n= \\frac{1}{2}\\Big[x(V-C) + (1-x)V\\Big]\n= \\frac{1}{2}\\Big[xV - xC + V - xV\\Big]\n= \\frac{1}{2}\\Big[V - Cx\\Big]\n= \\frac{V - Cx}{2}.\n$$\n\n2) 一个内部不动点 $x^\\star \\in (0,1)$ 必须满足 $\\Delta \\pi(x^\\star) = 0$。使用上面的表达式，\n$$\n\\frac{V - Cx^\\star}{2} = 0 \\;\\;\\Longrightarrow\\;\\; x^\\star = \\frac{V}{C}.\n$$\n因为 $CV0$，所以 $x^\\star \\in (0,1)$，符合要求。\n\n3) 定义单步映射\n$$\nf(x) \\;=\\; x \\;+\\; \\alpha \\, x(1-x)\\Delta\\pi(x)\n\\;=\\; x \\;+\\; \\alpha \\, x(1-x)\\cdot \\frac{V - Cx}{2}.\n$$\n令 $g(x) = x(1-x)\\Delta\\pi(x) = \\dfrac{1}{2}x(1-x)(V-Cx)$。那么 $f(x) = x + \\alpha g(x)$，所以\n$$\nf'(x) = 1 + \\alpha g'(x).\n$$\n我们计算 $g'(x)$：\n$$\ng'(x) = \\frac{1}{2}\\Big[(1-2x)(V-Cx) + x(1-x)(-C)\\Big] \\quad \\text{根据乘法法则}.\n$$\n在 $x^\\star$ 处求值，由于 $(V-Cx^\\star)=0$ 会使第一项为零，因此\n$$\ng'(x^\\star) = \\frac{1}{2}\\, x^\\star(1-x^\\star)(-C) \n= -\\,\\frac{C}{2}\\,\\frac{V}{C}\\Big(1 - \\frac{V}{C}\\Big)\n= -\\,\\frac{V(C-V)}{2C}.\n$$\n因此，\n$$\nf'(x^\\star) \\;=\\; 1 + \\alpha g'(x^\\star) \\;=\\; 1 - \\alpha\\,\\frac{V(C-V)}{2C}.\n$$\n一维离散时间映射的标准稳定性判据指出，$x^\\star$ 是局部渐近稳定的当且仅当 $|f'(x^\\star)|1$。因此，\n$$\n\\big|\\,1 - \\alpha\\,\\frac{V(C-V)}{2C}\\,\\big| \\;\\; 1.\n$$\n这个不等式等价于\n$$\n-1 \\;\\; 1 - \\alpha\\,\\frac{V(C-V)}{2C} \\;\\; 1,\n$$\n其左边部分得出\n$$\n-1  1 - \\alpha\\,\\frac{V(C-V)}{2C} \\;\\;\\Longleftrightarrow\\;\\; \\alpha\\,\\frac{V(C-V)}{2C}  2 \\;\\;\\Longleftrightarrow\\;\\; \\alpha  \\frac{4C}{V(C-V)},\n$$\n其右边部分得出\n$$\n1 - \\alpha\\,\\frac{V(C-V)}{2C}  1 \\;\\;\\Longleftrightarrow\\;\\; -\\alpha\\,\\frac{V(C-V)}{2C}  0 \\;\\;\\Longleftrightarrow\\;\\; \\alpha > 0.\n$$\n结合起来，保证局部渐近稳定且防止振荡发散（即确保 $|f'(x^\\star)|1$）的条件是\n$$\n0 \\;\\; \\alpha \\;\\; \\frac{4C}{V(C-V)}.\n$$\n\n4) 为了保证单调局部收敛（即在 $x^\\star$ 附近的偏差没有符号翻转振荡），我们额外要求 $f'(x^\\star)\\ge 0$。使用 $f'(x^\\star) = 1 - \\alpha\\,\\dfrac{V(C-V)}{2C}$，单调性由以下条件保证\n$$\n1 - \\alpha\\,\\frac{V(C-V)}{2C} \\;\\ge\\; 0 \\;\\;\\Longleftrightarrow\\;\\; \\alpha \\;\\le\\; \\frac{2C}{V(C-V)}.\n$$\n因此，单调局部收敛的一个充分条件是\n$$\n0 \\;\\; \\alpha \\;\\le\\; \\frac{2C}{V(C-V)},\n$$\n而不发生振荡发散的更广泛的稳定区域是\n$$\n0 \\;\\; \\alpha \\;\\; \\frac{4C}{V(C-V)}.\n$$\n\n5) 程序的算法设计：\n- 输入：对于每个测试用例 $(V,C)$，计算 $x^\\star = V/C$，$\\kappa = \\dfrac{V(C-V)}{2C}$，$\\alpha_{\\max} = \\dfrac{2}{\\kappa} = \\dfrac{4C}{V(C-V)}$，以及 $\\alpha_{\\mathrm{mono}} = \\dfrac{1}{\\kappa} = \\dfrac{2C}{V(C-V)}$。\n- 定义映射\n$$\nx_{t+1} = x_t + \\alpha \\, x_t (1-x_t)\\,\\frac{V - Cx_t}{2}.\n$$\n- 使用一个小的扰动 $\\delta = 10^{-6}$ 并设置 $x_0 = x^\\star + \\delta$。\n- 单步验证检查：\n  - 对于 $\\alpha_{\\text{low}} = 0.99\\,\\alpha_{\\max}$，计算 $x_1$ 并检查 $|x_1 - x^\\star|  |x_0 - x^\\star|$ 以返回一个布尔值 $\\text{stable\\_below}$。\n  - 对于 $\\alpha_{\\text{high}} = 1.01\\,\\alpha_{\\max}$，计算 $x_1$ 并检查 $|x_1 - x^\\star| > |x_0 - x^\\star|$ 以返回一个布尔值 $\\text{unstable\\_above}$。\n  - 对于 $\\alpha_{\\mathrm{mono,low}} = 0.99\\,\\alpha_{\\mathrm{mono}}$，计算 $x_1$ 并检查两个条件：$|x_1 - x^\\star|  |x_0 - x^\\star|$ 和 $(x_1 - x^\\star)(x_0 - x^\\star) \\ge 0$（没有符号翻转），返回布尔值 $\\text{monotone\\_below}$。\n- 对于每个测试 $(V,C)$，输出列表 $[\\alpha_{\\max}, \\text{stable\\_below}, \\text{unstable\\_above}, \\alpha_{\\mathrm{mono}}, \\text{monotone\\_below}]$。\n\n测试套件的解析值：\n- 测试 A: $V=1$, $C=5$:\n  - $\\kappa = \\dfrac{1\\cdot(5-1)}{2\\cdot 5} = \\dfrac{4}{10} = 0.4$,\n  - $\\alpha_{\\max} = \\dfrac{2}{0.4} = 5.0$,\n  - $\\alpha_{\\mathrm{mono}} = \\dfrac{1}{0.4} = 2.5$.\n- 测试 B: $V=2$, $C=10$:\n  - $\\kappa = \\dfrac{2\\cdot(10-2)}{2\\cdot 10} = \\dfrac{16}{20} = 0.8$,\n  - $\\alpha_{\\max} = \\dfrac{2}{0.8} = 2.5$,\n  - $\\alpha_{\\mathrm{mono}} = \\dfrac{1}{0.8} = 1.25$.\n- 测试 C: $V=9$, $C=10$:\n  - $\\kappa = \\dfrac{9\\cdot(10-9)}{2\\cdot 10} = \\dfrac{9}{20} = 0.45$,\n  - $\\alpha_{\\max} = \\dfrac{2}{0.45} = \\dfrac{40}{9} \\approx 4.444444444444445$,\n  - $\\alpha_{\\mathrm{mono}} = \\dfrac{1}{0.45} = \\dfrac{20}{9} \\approx 2.2222222222222223$.\n- 测试 D: $V=0.2$, $C=1$:\n  - $\\kappa = \\dfrac{0.2\\cdot(1-0.2)}{2\\cdot 1} = \\dfrac{0.16}{2} = 0.08$,\n  - $\\alpha_{\\max} = \\dfrac{2}{0.08} = 25.0$,\n  - $\\alpha_{\\mathrm{mono}} = \\dfrac{1}{0.08} = 12.5$.\n\n单步验证与解析导数测试相符：在 $\\alpha_{\\text{low}} = 0.99\\,\\alpha_{\\max}$ 时， $|f'(x^\\star)| = |1 - \\alpha_{\\text{low}}\\kappa| = |1 - 1.98| = 0.98  1$（稳定）；在 $\\alpha_{\\text{high}} = 1.01\\,\\alpha_{\\max}$ 时， $|f'(x^\\star)| = |1 - 2.02| = 1.02 > 1$（不稳定）；在 $\\alpha_{\\mathrm{mono,low}} = 0.99\\,\\alpha_{\\mathrm{mono}}$ 时，$f'(x^\\star) = 1 - 0.99 = 0.01 \\ge 0$ 且绝对值小于1（单调稳定）。因此，程序将为每个测试用例报告计算出的 $\\alpha_{\\max}$ 和 $\\alpha_{\\mathrm{mono}}$，以及与这些不等式一致的布尔验证结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef replicator_step(x, alpha, V, C):\n    # One-step discrete-time replicator map for Hawk fraction x\n    delta_pi = 0.5 * (V - C * x)\n    return x + alpha * x * (1.0 - x) * delta_pi\n\ndef compute_bounds(V, C):\n    # Compute kappa, alpha stability and monotonicity bounds\n    kappa = (V * (C - V)) / (2.0 * C)\n    alpha_max = 2.0 / kappa  # equivalently 4C/(V(C-V))\n    alpha_mono = 1.0 / kappa # equivalently 2C/(V(C-V))\n    return kappa, alpha_max, alpha_mono\n\ndef validate_one_step(V, C, alpha, delta=1e-6):\n    # Validate by a single step from x* + delta\n    x_star = V / C\n    x0 = x_star + delta\n    x1 = replicator_step(x0, alpha, V, C)\n    dev0 = abs(x0 - x_star)\n    dev1 = abs(x1 - x_star)\n    sign_no_flip = (x1 - x_star) * (x0 - x_star) >= 0.0\n    return dev1, dev0, sign_no_flip\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is (V, C)\n    test_cases = [\n        (1.0, 5.0),     # Test A\n        (2.0, 10.0),    # Test B\n        (9.0, 10.0),    # Test C\n        (0.2, 1.0),     # Test D\n    ]\n\n    results = []\n    for V, C in test_cases:\n        # Compute analytic bounds\n        kappa, alpha_max, alpha_mono = compute_bounds(V, C)\n\n        # Alpha choices for validation\n        alpha_low = 0.99 * alpha_max\n        alpha_high = 1.01 * alpha_max\n        alpha_mono_low = 0.99 * alpha_mono\n\n        # One-step validations\n        dev1_low, dev0_low, _ = validate_one_step(V, C, alpha_low)\n        stable_below = (dev1_low  dev0_low)\n\n        dev1_high, dev0_high, _ = validate_one_step(V, C, alpha_high)\n        unstable_above = (dev1_high > dev0_high)\n\n        dev1_mono, dev0_mono, no_flip = validate_one_step(V, C, alpha_mono_low)\n        monotone_below = (dev1_mono  dev0_mono) and no_flip\n\n        # Append result for this test case:\n        # [alpha_max, stable_below, unstable_above, alpha_mono, monotone_below]\n        results.append([alpha_max, stable_below, unstable_above, alpha_mono, monotone_below])\n\n    # Final print statement in the exact required format.\n    print(str(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "现实世界中的种群规模是有限的，这使得演化结果具有随机性而非确定性。本练习将超越无限种群的假设，使用莫兰过程（Moran process）来模拟演化。我们的目标是计算一个“鹰”策略突变体在“鸽”策略种群中最终被固定的概率，并理解选择强度 $\\beta$ 如何与随机漂变相互作用，从而决定演化是有利于、中性于还是不利于新策略的传播 。",
            "id": "4115929",
            "problem": "考虑一个规模为$N$的均匀混合有限种群，其中的个体可以在经典的鹰鸽博弈中选择鹰策略或鸽策略。个体间的相互作用是成对且随机的，不同个体间进行博弈。每种策略类型的平均收益是通过在当前种群状态下对对手的分布进行平均来计算的。设资源的收益为$V$，冲突的成本为$C$。鹰鸽博弈的收益矩阵定义如下：当两个鹰策略者相遇时，各自获得$(V-C)/2$；当一个鹰策略者遇到一个鸽策略者时，鹰获得$V$，鸽获得$0$；当两个鸽策略者相遇时，各自获得$V/2$。假设收益通过选择强度为$\\beta$的指数映射转换为适应度，因此在给定的种群状态下，鹰和鸽的适应度分别为$f_H=\\exp(\\beta \\pi_H)$和$f_D=\\exp(\\beta \\pi_D)$，其中$\\pi_H$和$\\pi_D$分别表示在无自我交互的随机匹配下鹰和鸽的平均收益。种群根据出生-死亡Moran过程进行演化：在每一步中，一个个体以与其适应度成正比的概率被选中进行繁殖，其后代会替换从种群中均匀随机选择的一个个体。\n\n从上述基本定义出发——均匀混合随机匹配下的鹰鸽矩阵的期望收益、指数适应度映射，以及在具有吸收态$i=0$（无鹰）和$i=N$（全为鹰）的有限马尔可夫链（MC）上的出生-死亡Moran过程——请从第一性原理推导单个鹰策略者被引入一个全为鸽的种群后的固定概率。不要假设任何已有的固定公式；相反，应通过求解该马尔可夫链的相应向后方程，推导出相关的转移概率和适用于频率依赖情况的固定概率表达式。\n\n在一个程序中实现所推导的计算，该程序对于给定的参数$(N,V,C,\\beta)$，返回单个鹰策略者的固定概率$\\rho$，并评估选择是增加还是减少了此概率（相对于中性情况）。中性情况定义为$\\beta=0$，此时在有限均匀混合种群中，单个突变体的固定概率为$1/N$。您的评估必须编码为一个整数$\\Delta$，定义如下：\n- 如果$\\rho$严格大于$1/N$，则$\\Delta=1$；\n- 如果$\\rho$在数值容差范围内等于$1/N$，则$\\Delta=0$；\n- 如果$\\rho$严格小于$1/N$，则$\\Delta=-1$。\n\n进行相等性比较时，使用$10^{-12}$的数值容差。所有计算都是无量纲的，不涉及物理单位。\n\n您的程序必须为以下测试套件计算结果：\n1. $N=50$, $V=1$, $C=2$, $\\beta=0.1$.\n2. $N=50$, $V=1$, $C=2$, $\\beta=0$.\n3. $N=50$, $V=1$, $C=2$, $\\beta=-0.1$.\n4. $N=2$, $V=1$, $C=2$, $\\beta=0.1$.\n5. $N=50$, $V=2$, $C=1$, $\\beta=0.1$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个结果对应一个测试用例，并且本身是一个形式为$[\\rho,\\Delta]$的双元素列表。例如，输出应类似于$[[\\rho_1,\\Delta_1],[\\rho_2,\\Delta_2],\\dots]$，其中$\\rho_k$以浮点数形式打印，$\\Delta_k$以整数形式打印。",
            "solution": "该问题是有效的，因为它在科学上基于演化博弈论，问题阐述清晰，且所有参数和动力学过程都得到了明确的规定。现在我将从第一性原理推导固定概率。\n\n设规模为$N$的种群状态为鹰策略个体的数量，记为$i \\in \\{0, 1, \\dots, N\\}$。相应地，鸽策略个体的数量为$N-i$。状态$i=0$（全为鸽）和$i=N$（全为鹰）是吸收态。\n\n首先，我们确定在一个包含$i$个鹰策略者的种群中，一个鹰策略者（$\\pi_H(i)$）和一个鸽策略者（$\\pi_D(i)$）的平均收益。相互作用是不同个体之间的随机配对。一个给定类型的个体与从其余$N-1$个个体中均匀抽取的对手配对。\n\n对于一个鹰策略博弈者，其对手是鹰的概率为$\\frac{i-1}{N-1}$，是鸽的概率为$\\frac{N-i}{N-1}$。收益矩阵给出如下：$E(H,H) = (V-C)/2$, $E(H,D) = V$。一个鹰策略者的平均收益是：\n$$ \\pi_H(i) = \\frac{i-1}{N-1} \\left( \\frac{V-C}{2} \\right) + \\frac{N-i}{N-1} V \\quad \\text{for } i \\in \\{1, \\dots, N\\} $$\n\n对于一个鸽策略博弈者，其对手是鹰的概率为$\\frac{i}{N-1}$，是鸽的概率为$\\frac{N-i-1}{N-1}$。收益为$E(D,H) = 0$ 和 $E(D,D) = V/2$。一个鸽策略者的平均收益是：\n$$ \\pi_D(i) = \\frac{i}{N-1} (0) + \\frac{N-i-1}{N-1} \\left( \\frac{V}{2} \\right) = \\frac{V(N-i-1)}{2(N-1)} \\quad \\text{for } i \\in \\{0, \\dots, N-1\\} $$\n\n鹰和鸽的适应度由指数映射$f = \\exp(\\beta \\pi)$给出，其中$\\beta$是选择强度。\n$$ f_H(i) = \\exp(\\beta \\pi_H(i)) $$\n$$ f_D(i) = \\exp(\\beta \\pi_D(i)) $$\n\n种群根据出生-死亡Moran过程进行演化。在每个时间步，一个个体以与其适应度成正比的概率被选中进行繁殖，其后代替换一个随机选择的个体。\n种群的总适应度为 $F_{total}(i) = i f_H(i) + (N-i) f_D(i)$。\n\n如果一个鹰策略者繁殖且其后代替换了一个鸽策略者，鹰的数量增加一（$i \\to i+1$）。此事件的概率，$T_i^+$，为：\n$$ T_i^+ = \\left( \\frac{i f_H(i)}{i f_H(i) + (N-i) f_D(i)} \\right) \\left( \\frac{N-i}{N} \\right) $$\n\n如果一个鸽策略者繁殖且其后代替换了一个鹰策略者，鹰的数量减少一（$i \\to i-1$）。此事件的概率，$T_i^-$，为：\n$$ T_i^- = \\left( \\frac{(N-i) f_D(i)}{i f_H(i) + (N-i) f_D(i)} \\right) \\left( \\frac{i}{N} \\right) $$\n这些转移概率对$i \\in \\{1, \\dots, N-1\\}$有效。\n\n设$\\rho_i$为从状态$i$开始鹰策略者的固定概率。边界条件为$\\rho_0 = 0$和$\\rho_N = 1$。对于任何瞬时状态$i$，$\\rho_i$必须满足后向科尔莫戈罗夫方程：\n$$ \\rho_i = T_i^+ \\rho_{i+1} + T_i^- \\rho_{i-1} + (1-T_i^+-T_i^-) \\rho_i $$\n这可以简化为 $T_i^+(\\rho_{i+1} - \\rho_i) = T_i^-(\\rho_i - \\rho_{i-1})$。\n我们定义比率$\\gamma_i = T_i^- / T_i^+$，其中$i \\in \\{1, \\dots, N-1\\}$。\n$$ \\gamma_i = \\frac{\\frac{(N-i) f_D(i)}{F_{total}(i)} \\frac{i}{N}}{\\frac{i f_H(i)}{F_{total}(i)} \\frac{N-i}{N}} = \\frac{f_D(i)}{f_H(i)} = \\exp(\\beta(\\pi_D(i) - \\pi_H(i))) $$\n递推关系变为$\\rho_{i+1} - \\rho_i = \\gamma_i (\\rho_i - \\rho_{i-1})$。\n这是关于差值$\\Delta_i = \\rho_i - \\rho_{i-1}$的等比数列。对于$k  1$，我们可以写出$\\Delta_{k} = \\Delta_1 \\prod_{j=1}^{k-1} \\gamma_j$。\n因为$\\rho_0 = 0$，我们有$\\Delta_1 = \\rho_1 - \\rho_0 = \\rho_1$。所以，$\\rho_k - \\rho_{k-1} = \\rho_1 \\prod_{j=1}^{k-1} \\gamma_j$。\n为了求$\\rho_i$，我们将差值求和：\n$$ \\rho_i = \\sum_{k=1}^{i} (\\rho_k - \\rho_{k-1}) = \\rho_1 \\sum_{k=1}^{i} \\prod_{j=1}^{k-1} \\gamma_j $$\n根据空积$\\prod_{j=1}^0$为$1$的约定。\n为了求$\\rho_1$，我们应用边界条件$\\rho_N=1$：\n$$ 1 = \\rho_N = \\rho_1 \\sum_{k=1}^{N} \\prod_{j=1}^{k-1} \\gamma_j $$\n求解$\\rho_1$，即单个鹰策略突变体的固定概率，我们得到：\n$$ \\rho = \\rho_1 = \\frac{1}{\\sum_{k=1}^{N} \\prod_{j=1}^{k-1} \\gamma_j} = \\frac{1}{1 + \\sum_{k=2}^{N} \\prod_{j=1}^{k-1} \\gamma_j} $$\n一个更标准的形式是：\n$$ \\rho = \\frac{1}{1 + \\sum_{k=1}^{N-1} \\prod_{j=1}^{k} \\gamma_j} $$\n为了实现这个计算，我们需要$\\gamma_j$的表达式：\n$$ \\pi_D(j) - \\pi_H(j) = \\frac{1}{2(N-1)} [C(j-1) - VN] $$\n因此，\n$$ \\gamma_j = \\exp\\left( \\beta \\frac{C(j-1) - VN}{2(N-1)} \\right) $$\n这个$\\gamma_j$的表达式将用于求和计算$\\rho$。\n\n对于中性情况，$\\beta=0$，这意味着对所有$j$都有$\\gamma_j = \\exp(0) = 1$。固定概率变为：\n$$ \\rho = \\frac{1}{1 + \\sum_{k=1}^{N-1} \\prod_{j=1}^{k} 1} = \\frac{1}{1 + \\sum_{k=1}^{N-1} 1} = \\frac{1}{1 + (N-1)} = \\frac{1}{N} $$\n这证实了中性漂变的结果。\n\n计算过程是：对于每组参数$(N, V, C, \\beta)$，使用推导出的公式计算$\\rho$。然后，将计算出的$\\rho$与中性概率$1/N$进行比较，以根据指定的$10^{-12}$容差确定$\\Delta \\in \\{-1, 0, 1\\}$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Hawk-Dove fixation probability problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (N, V, C, beta)\n        (50, 1, 2, 0.1),\n        (50, 1, 2, 0.0),\n        (50, 1, 2, -0.1),\n        (2, 1, 2, 0.1),\n        (50, 2, 1, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_fixation_and_delta(case)\n        results.append(result)\n\n    # Format the output string as required: [[rho_1,delta_1],[rho_2,delta_2],...]\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef compute_fixation_and_delta(params):\n    \"\"\"\n    Computes the fixation probability rho and the selection direction delta.\n\n    The derivation shows the fixation probability of a single mutant is:\n    rho = 1 / (1 + sum_{k=1}^{N-1} prod_{j=1}^{k} gamma_j)\n    where gamma_j = exp(beta * (pi_D(j) - pi_H(j))).\n    The payoff difference is:\n    pi_D(j) - pi_H(j) = (C*(j-1) - V*N) / (2*(N-1))\n    \"\"\"\n    N, V, C, beta = params\n    N = int(N)\n    V = float(V)\n    C = float(C)\n    beta = float(beta)\n    \n    neutral_rho = 1.0 / N\n\n    # Handle the neutral case beta = 0, where rho = 1/N.\n    if beta == 0.0:\n        return [neutral_rho, 0]\n\n    # Denominator of the fixation probability formula.\n    # It is S = 1 + sum_{k=1}^{N-1} prod_{j=1}^{k} gamma_j\n    S = 1.0\n    current_product = 1.0\n\n    # The loop calculates the sum of products.\n    # k runs from 1 to N-1 for the sum, and in each term,\n    # a running product from j=1 to k is calculated.\n    for k in range(1, N):\n        # Calculate gamma_k\n        exponent = beta * (C * (k - 1) - V * N) / (2.0 * (N - 1))\n        gamma_k = np.exp(exponent)\n        \n        # Update the product term prod_{j=1}^{k} gamma_j\n        current_product *= gamma_k\n        \n        # Add the new product term to the sum S\n        S += current_product\n\n    rho = 1.0 / S\n\n    # Compare rho with neutral_rho to determine delta\n    tolerance = 1e-12\n    if abs(rho - neutral_rho) = tolerance:\n        delta = 0\n    elif rho > neutral_rho:\n        delta = 1\n    else: # rho  neutral_rho\n        delta = -1\n        \n    return [rho, delta]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}