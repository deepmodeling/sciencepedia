{
    "hands_on_practices": [
        {
            "introduction": "许多现实世界中的网络，如引文网络或社交网络，是随时间动态增长的。然而，与经典的优先连接模型不同，节点的吸引力可能会随着时间的推移而“老化”或衰减。本实践将通过一个结合了优先连接和指数老化效应的理论模型，来探索节点度的演化过程。通过推导一个新加入节点在连续时间下的期望度，你将亲身体验处理复杂生成模型时常用的平均场方法和自洽性论证，这些是分析自适应网络动态学的核心解析工具。",
            "id": "4112746",
            "problem": "考虑一个在连续时间中增长的时间网络，其中每单位时间引入一个节点。在其于时刻 $t$ 引入时，新节点与已有的节点建立 $m$ 条无向边。令 $t_i$ 表示节点 $i$ 的引入时间，令 $k_i(t)$ 表示其在时刻 $t$ 的度。该网络通过线性优先连接 (PA) 机制演化，在时刻 $t$ 新建的边连接到节点 $i$ 的瞬时概率与其老化吸引力 $w_i(t)$ 成正比，定义为 $w_i(t) = \\exp(-\\mu (t - t_i))\\,k_i(t)$，其中 $\\mu > 0$ 是老化率。因此，节点 $i$ 的度的期望变化率由每单位时间引入的总边数乘以归一化连接概率给出。\n\n假设在连续时间平均场极限和一个长时间机制下，年龄结构的度分布相对于年龄变量 $a = t - t_0$ (其中 $t_0$ 是一个焦点节点的引入时间) 变得稳态。令 $\\Phi(t) = \\sum_{j} \\exp(-\\mu (t - t_j))\\,k_j(t)$ 表示在时刻 $t$ 的总老化吸引力，并假设在长时间机制下 $\\Phi(t)$ 趋于一个常数 $\\Phi^{\\ast}$。仅从这些核心定义和假设出发，推导在时刻 $t_0$ 引入的节点的期望度 $k(t; t_0)$ 作为 $m$、$\\mu$、$t$ 和 $t_0$ 的函数的显式闭式表达式。\n\n将您的最终答案表示为单个解析表达式。无需四舍五入，也无需单位。",
            "solution": "该问题要求推导在一个带有老化机制的增长时间网络中，在时刻 $t_0$ 引入的节点的期望度 $k(t; t_0)$。推导过程将通过建立并求解一个基于给定动力学的微分方程来进行，并使用自洽性论证来确定一个未知的归一化因子。\n\n令 $k(t; t_0)$ 为在时刻 $t_0$ 引入的节点作为当前时刻 $t$ 的函数的期望度。根据问题陈述，在时刻 $t$ 形成的新边连接到已存在节点 $i$ (在时刻 $t_i  t$ 引入) 的瞬时概率与其老化吸引力 $w_i(t) = \\exp(-\\mu(t - t_i)) k_i(t)$ 成正比。因此，归一化概率由下式给出：\n$$\n\\Pi_i(t) = \\frac{w_i(t)}{\\sum_{j} w_j(t)} = \\frac{\\exp(-\\mu(t - t_i)) k_i(t)}{\\Phi(t)}\n$$\n其中 $\\Phi(t) = \\sum_{j} \\exp(-\\mu(t - t_j)) k_j(t)$ 是在时刻 $t$ 网络中所有节点的总老化吸引力。\n\n问题陈述，在每个时间步，引入一个新节点并形成 $m$ 条边。因此，新边添加到网络中的速率是 $m$。特定节点 $i$ 的度的期望变化率是此速率乘以连接到该节点的概率。对于我们在 $t_0$ 引入的焦点节点，这给出了其期望度 $k(t; t_0)$ 在 $t > t_0$ 时的以下微分方程：\n$$\n\\frac{d k(t; t_0)}{dt} = m \\cdot \\Pi_0(t) = m \\frac{\\exp(-\\mu(t - t_0)) k(t; t_0)}{\\Phi(t)}\n$$\n问题指定，在长时间机制下，我们可以假设 $\\Phi(t)$ 趋于一个常数值，我们将其表示为 $\\Phi^{\\ast}$。这将微分方程简化为：\n$$\n\\frac{d k(t; t_0)}{dt} = \\frac{m}{\\Phi^{\\ast}} \\exp(-\\mu(t - t_0)) k(t; t_0)\n$$\n这是一个一阶线性常微分方程。它是可分离的，可以通过积分求解。\n$$\n\\frac{1}{k(t; t_0)} dk(t; t_0) = \\frac{m}{\\Phi^{\\ast}} \\exp(-\\mu(t - t_0)) dt\n$$\n在时刻 $t_0$ 引入的节点的初始条件是，其在该时刻的度为 $m$，因为它通过形成 $m$ 条边而引入。所以，$k(t_0; t_0) = m$。我们从引入时间 $t_0$ 到之后的某个时间 $t$ 对两边进行积分：\n$$\n\\int_{k(t_0; t_0)}^{k(t; t_0)} \\frac{1}{k'} dk' = \\int_{t_0}^{t} \\frac{m}{\\Phi^{\\ast}} \\exp(-\\mu(\\tau - t_0)) d\\tau\n$$\n$$\n\\left[ \\ln(k') \\right]_{m}^{k(t; t_0)} = \\frac{m}{\\Phi^{\\ast}} \\left[ \\frac{\\exp(-\\mu(\\tau - t_0))}{-\\mu} \\right]_{t_0}^{t}\n$$\n$$\n\\ln(k(t; t_0)) - \\ln(m) = -\\frac{m}{\\mu \\Phi^{\\ast}} \\left( \\exp(-\\mu(t - t_0)) - \\exp(0) \\right)\n$$\n$$\n\\ln\\left(\\frac{k(t; t_0)}{m}\\right) = \\frac{m}{\\mu \\Phi^{\\ast}} \\left( 1 - \\exp(-\\mu(t - t_0)) \\right)\n$$\n对两边取指数，得到以未知常数 $\\Phi^{\\ast}$ 表示的 $k(t; t_0)$ 的解：\n$$\nk(t; t_0) = m \\exp\\left( \\frac{m}{\\mu \\Phi^{\\ast}} \\left( 1 - \\exp(-\\mu(t - t_0)) \\right) \\right)\n$$\n为了求出 $\\Phi^{\\ast}$，我们使用自洽条件。在每单位时间引入一个节点的连续时间极限中 (即节点引入时间的密度为 $\\rho(t')=1$)，$\\Phi(t)$ 的求和变成从网络开始 (我们假设为 $t=0$) 到当前时间 $t$ 对所有引入时间 $t'$ 的积分：\n$$\n\\Phi(t) = \\int_{0}^{t} \\exp(-\\mu(t - t')) k(t; t') dt'\n$$\n在长时间极限下 ($t \\to \\infty$)，$\\Phi(t) \\to \\Phi^{\\ast}$。\n$$\n\\Phi^{\\ast} = \\lim_{t \\to \\infty} \\int_{0}^{t} \\exp(-\\mu(t - t')) k(t; t') dt'\n$$\n让我们将积分变量更改为节点的年龄 $a = t - t'$，这给出 $dt' = -da$。积分限从 $t'=0 \\implies a=t$ 和 $t'=t \\implies a=0$ 改变。\n$$\n\\Phi^{\\ast} = \\lim_{t \\to \\infty} \\int_{t}^{0} \\exp(-\\mu a) k(t; t-a) (-da) = \\lim_{t \\to \\infty} \\int_{0}^{t} \\exp(-\\mu a) k(t; t-a) da\n$$\n问题假设存在一个稳态的年龄结构的度分布，这意味着 $k(t; t-a)$ 仅取决于年龄 $a$。在我们推导的形式中，$k(t; t_0)$ 是 $t - t_0$ 的函数。因此 $k(t; t-a)$ 是 $t-(t-a)=a$ 的函数，这是一致的。我们可以写出 $k(a) = m \\exp\\left( \\frac{m}{\\mu \\Phi^{\\ast}} (1 - \\exp(-\\mu a)) \\right)$。将此代入 $\\Phi^{\\ast}$ 的积分中：\n$$\n\\Phi^{\\ast} = \\int_{0}^{\\infty} \\exp(-\\mu a) m \\exp\\left( \\frac{m}{\\mu \\Phi^{\\ast}} \\left( 1 - \\exp(-\\mu a) \\right) \\right) da\n$$\n令 $C = \\frac{m}{\\mu \\Phi^{\\ast}}$。积分为：\n$$\n\\Phi^{\\ast} = m \\int_{0}^{\\infty} \\exp(-\\mu a) \\exp\\left( C (1 - \\exp(-\\mu a)) \\right) da\n$$\n我们进行换元。令 $x = \\exp(-\\mu a)$。则 $dx = -\\mu \\exp(-\\mu a) da$，所以 $\\exp(-\\mu a) da = -dx/\\mu$。积分限为 $a=0 \\implies x=1$ 和 $a \\to \\infty \\implies x \\to 0$。\n$$\n\\Phi^{\\ast} = m \\int_{1}^{0} \\exp(C(1-x)) \\left(-\\frac{dx}{\\mu}\\right) = \\frac{m}{\\mu} \\int_{0}^{1} \\exp(C) \\exp(-Cx) dx\n$$\n$$\n\\Phi^{\\ast} = \\frac{m}{\\mu} \\exp(C) \\int_{0}^{1} \\exp(-Cx) dx = \\frac{m}{\\mu} \\exp(C) \\left[ \\frac{\\exp(-Cx)}{-C} \\right]_{0}^{1}\n$$\n$$\n\\Phi^{\\ast} = \\frac{m}{\\mu} \\exp(C) \\left( -\\frac{\\exp(-C)}{C} + \\frac{1}{C} \\right) = \\frac{m}{C\\mu} \\exp(C) (1 - \\exp(-C)) = \\frac{m}{C\\mu} (\\exp(C) - 1)\n$$\n现在，代回 $C = \\frac{m}{\\mu \\Phi^{\\ast}}$。\n$$\n\\Phi^{\\ast} = \\frac{m}{(\\frac{m}{\\mu \\Phi^{\\ast}})\\mu} \\left( \\exp\\left(\\frac{m}{\\mu \\Phi^{\\ast}}\\right) - 1 \\right)\n$$\n$$\n\\Phi^{\\ast} = \\Phi^{\\ast} \\left( \\exp\\left(\\frac{m}{\\mu \\Phi^{\\ast}}\\right) - 1 \\right)\n$$\n假设 $\\Phi^{\\ast} \\neq 0$ (对于具有非零度节点的增长网络，这必须为真)，我们可以用 $\\Phi^{\\ast}$ 除：\n$$\n1 = \\exp\\left(\\frac{m}{\\mu \\Phi^{\\ast}}\\right) - 1 \\implies 2 = \\exp\\left(\\frac{m}{\\mu \\Phi^{\\ast}}\\right)\n$$\n对两边取自然对数，得到：\n$$\n\\ln(2) = \\frac{m}{\\mu \\Phi^{\\ast}}\n$$\n这确定了常数组 $m/(\\mu \\Phi^{\\ast})$ 的值。我们现在可以将其代回我们关于 $k(t; t_0)$ 的表达式中：\n$$\nk(t; t_0) = m \\exp\\left( \\ln(2) \\left( 1 - \\exp(-\\mu(t - t_0)) \\right) \\right)\n$$\n使用恒等式 $\\exp(a \\ln b) = b^a$，我们可以将最终表达式写为：\n$$\nk(t; t_0) = m \\left( \\exp(\\ln(2)) \\right)^{1 - \\exp(-\\mu(t-t_0))}\n$$\n$$\nk(t; t_0) = m \\cdot 2^{1 - \\exp(-\\mu(t - t_0))}\n$$\n这是在时刻 $t_0$ 引入的节点的期望度的最终闭式表达式。",
            "answer": "$$\n\\boxed{m \\cdot 2^{1 - \\exp(-\\mu(t - t_0))}}\n$$"
        },
        {
            "introduction": "在分析真实世界的时序网络数据时，一个核心问题是：我们观察到的局部模式（即“网络基序”）是具有统计显著性的结构，还是仅仅是随机事件的产物？本实践将教授一种基本但功能强大的方法来回答这个问题：构建零模型。你将学习如何定义一个在保留节点活动时间序列的同时，将交互伙伴随机化的时序零模型，并在此基础上推导特定基序（时间窗口内的互惠对）的期望数量。这项练习对于从时序数据中辨别有意义的结构模式和随机噪声至关重要。",
            "id": "4112785",
            "problem": "给定一个有限节点集 $\\mathcal{V}$ 和每个节点 $u \\in \\mathcal{V}$ 的一个时间活动序列，该序列包含节点 $u$ 发起交互的时间。一个时间网络的实现是通过以下方式构建的：对于节点 $u$ 在时间 $t$ 的每次发起，都从 $|\\mathcal{V}| - 1$ 个可能的伙伴中根据均匀分布独立地为其分配一个伙伴 $v \\in \\mathcal{V} \\setminus \\{u\\}$。所有伙伴的选择在不同的发起之间都是独立的，并且不允许自环。每个节点发起的活动时间与给定值完全保持一致。\n\n考虑定义为窗口内的互惠对的时间模体：一个模体实例是一个有序的发起对 $(u \\to v, t)$ 和 $(v \\to u, t')$，满足 $u, v \\in \\mathcal{V}$ 且 $u \\neq v$，较早的时间是 $t$，较晚的时间是 $t'$，并且 $0  t' - t \\le \\Delta$，其中 $\\Delta > 0$ 是给定的窗口大小。\n\n任务：\n- 从概率论的基本原理、期望的线性性以及上述零模型定义（保留每个节点的发起时间序列，并均匀且独立地随机化伙伴选择）出发，推导互惠对模体实例期望数量的精确解析表达式，该表达式是活动序列、窗口 $\\Delta$ 和节点数 $|\\mathcal{V}|$ 的函数。\n- 然后，对于特定情况 $\\mathcal{V} = \\{1, 2, 3, 4\\}$，其活动序列如下：\n  - 节点 $1$：发起时间 $\\{1, 5\\}$，\n  - 节点 $2$：发起时间 $\\{2, 6\\}$，\n  - 节点 $3$：发起时间 $\\{3\\}$，\n  - 节点 $4$：发起时间 $\\{4, 7\\}$，\n  且窗口 $\\Delta = 2$，计算此表达式的值。\n  \n将零模型下互惠对模体实例的期望数量报告为单个精确数，无需四舍五入。答案是无单位的。",
            "solution": "问题要求计算在一个由特定零模型生成的时间网络中，互惠对模体实例的期望数量。我们将首先推导这个期望的一个通用解析表达式，然后针对给定的具体情况进行求值。推导将基于基本原理，主要是期望的线性性。\n\n设 $\\mathcal{V}$ 为节点集，并令 $N_{nodes} = |\\mathcal{V}|$ 为节点总数。对于每个节点 $u \\in \\mathcal{V}$，给定一个发起时间集，记为 $A_u$。网络中所有发起的总集合为 $\\mathcal{E} = \\{(u, t) \\mid u \\in \\mathcal{V}, t \\in A_u\\}$。零模型规定，对于节点 $u$ 在时间 $t$ 的任何一次发起，其伙伴 $v$ 是从集合 $\\mathcal{V} \\setminus \\{u\\}$ 中均匀随机选择的。所有这些选择都是独立的。因此，选择任何特定伙伴 $v \\neq u$ 的概率为 $p = \\frac{1}{N_{nodes} - 1}$。\n\n一个互惠对模体实例被定义为一个有序的已实现时间边对 $(u \\to v, t)$ 和 $(v \\to u, t')$，满足 $u \\neq v$ 且时间差满足 $0  t' - t \\le \\Delta$。这意味着在时间 $t$，节点 $u$ 发起了一次交互并选择了 $v$ 作为伙伴；并且在时间 $t'$，节点 $v$ 发起了一次交互并选择了 $u$ 作为伙伴。\n\n令 $N$ 为代表互惠对模体实例总数的随机变量。为了求 $N$ 的期望值，记为 $E[N]$，我们可以使用期望的线性性原理。我们可以将 $N$ 表示为一系列指示随机变量的和，其中每个指示变量对应一个潜在的模体实例。\n\n一个潜在的模体实例由一个有序发起对 $((u, t), (v, t'))$ 定义，其中 $(u, t) \\in \\mathcal{E}$ 且 $(v, t') \\in \\mathcal{E}$，并满足条件 $u \\neq v$ 和 $0  t' - t \\le \\Delta$。令 $\\mathcal{P}$ 为所有此类潜在模体实例的集合。对于 $\\mathcal{P}$ 中的每个元素 $((u, t), (v, t'))$，令 $X_{(u,t),(v,t')}$ 为一个指示随机变量，使得：\n如果节点 $u$ 在时间 $t$ 选择伙伴 $v$ 并且节点 $v$ 在时间 $t'$ 选择伙伴 $u$，则 $X_{(u,t),(v,t')} = 1$；\n否则 $X_{(u,t),(v,t')} = 0$。\n\n实现的模体总数是这些指示变量在所有潜在实例上的和：\n$$N = \\sum_{((u,t),(v,t')) \\in \\mathcal{P}} X_{(u,t),(v,t')}$$\n根据期望的线性性，模体的期望数量为：\n$$E[N] = E\\left[\\sum_{((u,t),(v,t')) \\in \\mathcal{P}} X_{(u,t),(v,t')}\\right] = \\sum_{((u,t),(v,t')) \\in \\mathcal{P}} E[X_{(u,t),(v,t')}]$$\n指示变量的期望是它所指示的事件的概率。\n$$E[X_{(u,t),(v,t')}] = P(\\text{u 在 t 时选择 v 且 v 在 t' 时选择 u})$$\n根据零模型，不同发起的伙伴选择是独立事件。$u$ 在时间 $t$ 的发起与 $v$ 在时间 $t'$ 的发起是不同的。因此：\n$$E[X_{(u,t),(v,t')}] = P(\\text{u 在 t 时选择 v}) \\times P(\\text{v 在 t' 时选择 u})$$\n$u$ 从 $N_{nodes} - 1$ 个可能的伙伴中选择 $v$ (其中 $v \\neq u$) 的概率是 $\\frac{1}{N_{nodes} - 1}$。同样，$v$ 选择 $u$ 的概率是 $\\frac{1}{N_{nodes} - 1}$。\n因此，对于 $\\mathcal{P}$ 中的任何潜在实例，其被实现的概率是：\n$$E[X_{(u,t),(v,t')}] = \\frac{1}{N_{nodes} - 1} \\times \\frac{1}{N_{nodes} - 1} = \\frac{1}{(N_{nodes} - 1)^2}$$\n由于这个概率对于所有潜在实例都是一个常数，所以模体的总期望数量是这个概率乘以潜在实例的总数 $|\\mathcal{P}|$。\n$$E[N] = |\\mathcal{P}| \\times \\frac{1}{(N_{nodes} - 1)^2}$$\n潜在实例的数量 $|\\mathcal{P}|$ 是从给定的活动序列中满足 $u \\neq v$ 和 $0  t' - t \\le \\Delta$ 的有序发起对 $((u, t), (v, t'))$ 的计数。我们可以将此计数表示为一个和：\n$$|\\mathcal{P}| = \\sum_{u \\in \\mathcal{V}} \\sum_{v \\in \\mathcal{V}, v \\neq u} \\sum_{t \\in A_u} \\sum_{t' \\in A_v, 0  t' - t \\le \\Delta} 1$$\n这可以更紧凑地写为：\n$$|\\mathcal{P}| = \\sum_{u \\in \\mathcal{V}} \\sum_{v \\in \\mathcal{V}, v \\neq u} \\sum_{t \\in A_u} |\\{ t' \\in A_v \\mid t  t' \\le t+\\Delta \\}|$$\n综合这些结果，互惠对模体实例期望数量的精确解析表达式为：\n$$E[N] = \\frac{1}{(|\\mathcal{V}| - 1)^2} \\sum_{u \\in \\mathcal{V}} \\sum_{v \\in \\mathcal{V}, v \\neq u} \\sum_{t \\in A_u} |\\{ t' \\in A_v \\mid t  t' \\le t+\\Delta \\}|$$\n\n现在，我们为提供的具体情况计算此表达式的值。\n给定条件如下：\n- 节点集是 $\\mathcal{V} = \\{1, 2, 3, 4\\}$，所以 $|\\mathcal{V}| = 4$。\n- 概率因子是 $\\frac{1}{(4-1)^2} = \\frac{1}{3^2} = \\frac{1}{9}$。\n- 时间窗口是 $\\Delta = 2$。\n- 活动序列是：$A_1 = \\{1, 5\\}$，$A_2 = \\{2, 6\\}$，$A_3 = \\{3\\}$，$A_4 = \\{4, 7\\}$。\n\n我们需要计算 $|\\mathcal{P}|$，即潜在实例的总数。我们通过对每个不同的有序节点对 $(u, v)$ 的计数进行求和来计算这个值。令 $C_{uv} = \\sum_{t \\in A_u} |\\{ t' \\in A_v \\mid t  t' \\le t+2 \\}|$。\n\n- 对于 $(u,v) = (1, 2)$：$t=1 \\in A_1 \\implies t' \\in (1, 3]$。$A_2$ 中有 $\\{2\\}$。计数为 $1$。\n$t=5 \\in A_1 \\implies t' \\in (5, 7]$。$A_2$ 中有 $\\{6\\}$。计数为 $1$。\n$C_{12} = 1 + 1 = 2$。\n- 对于 $(u,v) = (1, 3)$：$t=1 \\in A_1 \\implies t' \\in (1, 3]$。$A_3$ 中有 $\\{3\\}$。计数为 $1$。\n$t=5 \\in A_1 \\implies t' \\in (5, 7]$。$A_3$ 中没有。计数为 $0$。\n$C_{13} = 1 + 0 = 1$。\n- 对于 $(u,v) = (1, 4)$：$t=1 \\in A_1 \\implies t' \\in (1, 3]$。$A_4$ 中没有。计数为 $0$。\n$t=5 \\in A_1 \\implies t' \\in (5, 7]$。$A_4$ 中有 $\\{7\\}$。计数为 $1$。\n$C_{14} = 0 + 1 = 1$。\n\n- 对于 $(u,v) = (2, 1)$：$t=2 \\in A_2 \\implies t' \\in (2, 4]$。$A_1$ 中没有。计数为 $0$。\n$t=6 \\in A_2 \\implies t' \\in (6, 8]$。$A_1$ 中没有。计数为 $0$。\n$C_{21} = 0 + 0 = 0$。\n- 对于 $(u,v) = (2, 3)$：$t=2 \\in A_2 \\implies t' \\in (2, 4]$。$A_3$ 中有 $\\{3\\}$。计数为 $1$。\n$t=6 \\in A_2 \\implies t' \\in (6, 8]$。$A_3$ 中没有。计数为 $0$。\n$C_{23} = 1 + 0 = 1$。\n- 对于 $(u,v) = (2, 4)$：$t=2 \\in A_2 \\implies t' \\in (2, 4]$。$A_4$ 中有 $\\{4\\}$。计数为 $1$。\n$t=6 \\in A_2 \\implies t' \\in (6, 8]$。$A_4$ 中有 $\\{7\\}$。计数为 $1$。\n$C_{24} = 1 + 1 = 2$。\n\n- 对于 $(u,v) = (3, 1)$：$t=3 \\in A_3 \\implies t' \\in (3, 5]$。$A_1$ 中有 $\\{5\\}$。计数为 $1$。\n$C_{31} = 1$。\n- 对于 $(u,v) = (3, 2)$：$t=3 \\in A_3 \\implies t' \\in (3, 5]$。$A_2$ 中没有。计数为 $0$。\n$C_{32} = 0$。\n- 对于 $(u,v) = (3, 4)$：$t=3 \\in A_3 \\implies t' \\in (3, 5]$。$A_4$ 中有 $\\{4\\}$。计数为 $1$。\n$C_{34} = 1$。\n\n- 对于 $(u,v) = (4, 1)$：$t=4 \\in A_4 \\implies t' \\in (4, 6]$。$A_1$ 中有 $\\{5\\}$。计数为 $1$。\n$t=7 \\in A_4 \\implies t' \\in (7, 9]$。$A_1$ 中没有。计数为 $0$。\n$C_{41} = 1 + 0 = 1$。\n- 对于 $(u,v) = (4, 2)$：$t=4 \\in A_4 \\implies t' \\in (4, 6]$。$A_2$ 中有 $\\{6\\}$。计数为 $1$。\n$t=7 \\in A_4 \\implies t' \\in (7, 9]$。$A_2$ 中没有。计数为 $0$。\n$C_{42} = 1 + 0 = 1$。\n- 对于 $(u,v) = (4, 3)$：$t=4 \\in A_4 \\implies t' \\in (4, 6]$。$A_3$ 中没有。计数为 $0$。\n$t=7 \\in A_4 \\implies t' \\in (7, 9]$。$A_3$ 中没有。计数为 $0$。\n$C_{43} = 0 + 0 = 0$。\n\n潜在实例的总数是这些计数的和：\n$|\\mathcal{P}| = C_{12} + C_{13} + C_{14} + C_{21} + C_{23} + C_{24} + C_{31} + C_{32} + C_{34} + C_{41} + C_{42} + C_{43}$\n$|\\mathcal{P}| = 2 + 1 + 1 + 0 + 1 + 2 + 1 + 0 + 1 + 1 + 1 + 0 = 11$。\n\n最后，我们计算模体的期望数量：\n$$E[N] = |\\mathcal{P}| \\times \\frac{1}{(|\\mathcal{V}| - 1)^2} = 11 \\times \\frac{1}{(4 - 1)^2} = 11 \\times \\frac{1}{9} = \\frac{11}{9}$$\n互惠对模体实例的期望数量是 $\\frac{11}{9}$。",
            "answer": "$$\\boxed{\\frac{11}{9}}$$"
        },
        {
            "introduction": "自适应网络的关键特征是网络结构与构成它的节点状态之间的相互作用或“共演化”。本实践将这一概念从抽象描述转化为严谨的、可检验的科学假设。你将运用广义线性模型（GLM）这一强大的统计框架，来检验网络连接的形成是否自适应地响应某个时变协变量（例如节点状态的差异）。通过从第一性原理推导广义似然比检验统计量，你将学会如何对网络自适应耦合的存在性进行正式的假设检验，从而将理论概念与数据驱动的实证分析联系起来。",
            "id": "4112754",
            "problem": "考虑在离散时间 $t \\in \\{1,2,\\dots,T\\}$（其中 $T \\geq 10$）上观测到的单个二元体 $\\{i,j\\}$。令 $A_{ij}(t) \\in \\{0,1\\}$ 表示在时间 $t$ 时该二元体的邻接指示符，令 $x(t) \\in \\mathbb{R}$ 为一个观测到的、时变的、源于节点状态的二元体级协变量（例如，状态差异）。为捕捉不由 $x(t)$ 驱动的外生时间变异和短期边持续性，您将使用一个伯努利广义线性模型（GLM）来对条件性边形成概率进行建模。该模型使用 logit 链接函数、一个具有已知基函数的低维时间基 $\\mathbf{b}(t) \\in \\mathbb{R}^{K}$，以及对滞后边 $A_{ij}(t-1)$ 的一阶马尔可夫依赖。\n\n假设存在以下条件独立性结构：在给定历史 $\\mathcal{H}_{t-1} = \\{A_{ij}(s): s \\leq t-1\\}$ 和协变量 $\\{x(s), \\mathbf{b}(s): s \\leq t\\}$ 的条件下，结果 $\\{A_{ij}(t)\\}_{t=2}^{T}$ 是独立的，且 $A_{ij}(t) \\sim \\mathrm{Bernoulli}(p(t))$。\n\n您希望通过比较以下两个模型来检验是否存在超越外生时间依赖性的、对 $x(t)$ 的自适应耦合：\n- 零假设模型 $\\mathcal{M}_{0}$（仅外生）：$\\mathrm{logit}\\big(p_{0}(t)\\big) = \\boldsymbol{\\gamma}^{\\top} \\mathbf{b}(t) + \\phi \\, A_{ij}(t-1)$。\n- 备择模型 $\\mathcal{M}_{1}$（自适应耦合）：$\\mathrm{logit}\\big(p_{1}(t)\\big) = \\beta \\, x(t) + \\boldsymbol{\\gamma}^{\\top} \\mathbf{b}(t) + \\phi \\, A_{ij}(t-1)$。\n\n此处，$\\beta \\in \\mathbb{R}$，$\\boldsymbol{\\gamma} \\in \\mathbb{R}^{K}$ 和 $\\phi \\in \\mathbb{R}$ 是未知参数。初始条件 $A_{ij}(1)$ 被视为给定。\n\n基于广义似然比，构建一个关于 $H_{0}: \\beta = 0$ 对立于 $H_{1}: \\beta \\neq 0$ 的假设检验。推导广义似然比检验统计量 $T$ 的一个显式表达式，该表达式应使用观测序列 $\\{A_{ij}(t)\\}_{t=2}^{T}$ 以及两个模型下的拟合概率 $\\{\\hat{p}_{0}(t)\\}_{t=2}^{T}$ 和 $\\{\\hat{p}_{1}(t)\\}_{t=2}^{T}$ 来表示，其中 $\\hat{p}_{0}(t)$ 和 $\\hat{p}_{1}(t)$ 分别是 $\\mathcal{M}_{0}$ 和 $\\mathcal{M}_{1}$ 模型下的最大似然拟合概率。您的最终答案应为 $T$ 的单个闭式解析表达式。\n\n如果您引入任何额外的待估量或中间量，请明确定义它们。除上述规定外，不要假设任何特殊的函数形式。不要使用任何预先推导的检验公式；请从伯努利观测值和 logit 链接函数下的似然第一性原理出发推导该统计量。最终结果仅用 $\\{A_{ij}(t)\\}_{t=2}^{T}$ 和 $\\{\\hat{p}_{0}(t), \\hat{p}_{1}(t)\\}_{t=2}^{T}$ 表示。不需要数值，也无需四舍五入。最终答案必须是单个无单位的闭式表达式。",
            "solution": "目标是为假设检验 $H_{0}: \\beta = 0$ 对立于 $H_{1}: \\beta \\neq 0$ 推导广义似然比检验统计量。模型 $\\mathcal{M}_0$ 和 $\\mathcal{M}_1$ 是嵌套的，因为 $\\mathcal{M}_0$ 是 $\\mathcal{M}_1$ 在参数 $\\beta$ 被约束为零时的特例。\n\n广义似然比检验统计量（为避免与时间范围 $T$ 混淆，我们将其表示为 $T_{stat}$）定义为 $T_{stat} = -2 \\ln \\Lambda$，其中 $\\Lambda$ 是零假设下最大化似然与备择假设下最大化似然的比值。\n$$ \\Lambda = \\frac{\\sup_{\\boldsymbol{\\theta} \\in \\Theta_0} L(\\boldsymbol{\\theta})}{\\sup_{\\boldsymbol{\\theta} \\in \\Theta_1} L(\\boldsymbol{\\theta})} $$\n此处，$\\Theta_1$ 是模型 $\\mathcal{M}_1$ 的参数空间，其参数向量为 $\\boldsymbol{\\theta}_1 = (\\beta, \\boldsymbol{\\gamma}, \\phi)$，而 $\\Theta_0$ 是模型 $\\mathcal{M}_0$ 的参数空间，其中 $\\beta=0$。\n\n基于条件独立性假设，观测序列 $\\{A_{ij}(t)\\}_{t=2}^{T}$ 的似然函数是每个观测在给定过去情况下的概率乘积。对于单个观测 $A_{ij}(t) \\sim \\mathrm{Bernoulli}(p(t))$，其概率质量函数为：\n$$ P(A_{ij}(t) | \\mathcal{H}_{t-1}, x(t), \\mathbf{b}(t); p(t)) = p(t)^{A_{ij}(t)} (1 - p(t))^{1 - A_{ij}(t)} $$\n在观测期间 $t=2, \\dots, T$ 上的总条件似然函数 $L(\\boldsymbol{\\theta})$ 是：\n$$ L(\\boldsymbol{\\theta}) = \\prod_{t=2}^{T} p(t)^{A_{ij}(t)} (1 - p(t))^{1 - A_{ij}(t)} $$\n使用对数似然函数 $\\ell(\\boldsymbol{\\theta}) = \\ln L(\\boldsymbol{\\theta})$ 更为方便：\n$$ \\ell(\\boldsymbol{\\theta}) = \\sum_{t=2}^{T} \\left[ A_{ij}(t) \\ln p(t) + (1 - A_{ij}(t)) \\ln(1 - p(t)) \\right] $$\n\n问题提供了两个模型下的最大似然拟合概率。\n- 在 $\\mathcal{M}_1$ 下，最大化对数似然 $\\hat{\\ell}_1$ 是通过在参数的最大似然估计处评估 $\\ell(\\boldsymbol{\\theta})$ 得到的，这产生了拟合概率 $\\{\\hat{p}_1(t)\\}_{t=2}^{T}$。\n$$ \\hat{\\ell}_1 = \\sup_{\\boldsymbol{\\theta} \\in \\Theta_1} \\ell(\\boldsymbol{\\theta}) = \\sum_{t=2}^{T} \\left[ A_{ij}(t) \\ln \\hat{p}_1(t) + (1 - A_{ij}(t)) \\ln(1 - \\hat{p}_1(t)) \\right] $$\n- 类似地，在 $\\mathcal{M}_0$ 下，最大化对数似然 $\\hat{\\ell}_0$ 是使用拟合概率 $\\{\\hat{p}_0(t)\\}_{t=2}^{T}$ 得到的。\n$$ \\hat{\\ell}_0 = \\sup_{\\boldsymbol{\\theta} \\in \\Theta_0} \\ell(\\boldsymbol{\\theta}) = \\sum_{t=2}^{T} \\left[ A_{ij}(t) \\ln \\hat{p}_0(t) + (1 - A_{ij}(t)) \\ln(1 - \\hat{p}_0(t)) \\right] $$\n\n因此，似然比 $\\Lambda$ 是：\n$$ \\Lambda = \\frac{L(\\hat{\\boldsymbol{\\theta}}_0)}{L(\\hat{\\boldsymbol{\\theta}}_1)} = \\frac{\\exp(\\hat{\\ell}_0)}{\\exp(\\hat{\\ell}_1)} = \\exp(\\hat{\\ell}_0 - \\hat{\\ell}_1) $$\n检验统计量（在问题陈述中用 $T$ 表示）推导如下：\n$$ T = -2 \\ln \\Lambda = -2 \\ln(\\exp(\\hat{\\ell}_0 - \\hat{\\ell}_1)) = -2(\\hat{\\ell}_0 - \\hat{\\ell}_1) = 2(\\hat{\\ell}_1 - \\hat{\\ell}_0) $$\n代入 $\\hat{\\ell}_1$ 和 $\\hat{\\ell}_0$ 的表达式：\n$$ T = 2 \\left( \\sum_{t=2}^{T} \\left[ A_{ij}(t) \\ln \\hat{p}_1(t) + (1 - A_{ij}(t)) \\ln(1 - \\hat{p}_1(t)) \\right] - \\sum_{t=2}^{T} \\left[ A_{ij}(t) \\ln \\hat{p}_0(t) + (1 - A_{ij}(t)) \\ln(1 - \\hat{p}_0(t)) \\right] \\right) $$\n我们可以将两个求和合并为一个：\n$$ T = 2 \\sum_{t=2}^{T} \\left( \\left[ A_{ij}(t) \\ln \\hat{p}_1(t) + (1 - A_{ij}(t)) \\ln(1 - \\hat{p}_1(t)) \\right] - \\left[ A_{ij}(t) \\ln \\hat{p}_0(t) + (1 - A_{ij}(t)) \\ln(1 - \\hat{p}_0(t)) \\right] \\right) $$\n现在，我们按观测结果 $A_{ij}(t)$ 对各项进行分组：\n$$ T = 2 \\sum_{t=2}^{T} \\left( A_{ij}(t) \\left[ \\ln \\hat{p}_1(t) - \\ln \\hat{p}_0(t) \\right] + (1 - A_{ij}(t)) \\left[ \\ln(1 - \\hat{p}_1(t)) - \\ln(1 - \\hat{p}_0(t)) \\right] \\right) $$\n使用对数性质 $\\ln a - \\ln b = \\ln(a/b)$，我们可以简化表达式：\n$$ T = 2 \\sum_{t=2}^{T} \\left[ A_{ij}(t) \\ln\\left(\\frac{\\hat{p}_1(t)}{\\hat{p}_0(t)}\\right) + (1 - A_{ij}(t)) \\ln\\left(\\frac{1 - \\hat{p}_1(t)}{1 - \\hat{p}_0(t)}\\right) \\right] $$\n这就是根据要求，用观测数据和拟合概率表示的广义似然比检验统计量 $T$ 的最终表达式。该统计量也称为两个模型之间的偏差差异。在零假设 $H_0$ 下，该统计量渐近服从卡方分布 $\\chi^2_d$，其中 $d$ 是 $\\mathcal{M}_1$ 和 $\\mathcal{M}_0$ 之间自由参数数量的差异。在这种情况下，$d=1$，因为只增加了一个参数 $\\beta$。",
            "answer": "$$\n\\boxed{2 \\sum_{t=2}^{T} \\left[ A_{ij}(t) \\ln\\left(\\frac{\\hat{p}_1(t)}{\\hat{p}_0(t)}\\right) + (1 - A_{ij}(t)) \\ln\\left(\\frac{1 - \\hat{p}_1(t)}{1 - \\hat{p}_0(t)}\\right) \\right]}\n$$"
        }
    ]
}