{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of controllability analysis for linear systems is the Kalman rank condition. This algebraic test provides a definitive answer to whether a system's state can be driven to any desired configuration from any starting point. This first exercise, , offers a direct, hands-on computation of the controllability matrix $\\mathcal{C}$ for a simple two-dimensional system, reinforcing the foundational theory before we move to more abstract network perspectives.",
            "id": "4364519",
            "problem": "A two-gene signaling module in a cellular pathway is linearized around a homeostatic equilibrium to study small-signal regulation by an external control input representing a drug infusion. The linearized state-space model is a Single-Input Linear Time-Invariant (LTI) system given by $\\dot{x}(t)=A x(t)+B u(t)$, where $x(t)\\in\\mathbb{R}^{2}$ are deviations of gene activities from steady state and $u(t)\\in\\mathbb{R}$ is the control input. The matrices are\n$$\nA=\\begin{bmatrix}0 & 1 \\\\ -2 & -3\\end{bmatrix},\\qquad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}.\n$$\nUsing only foundational definitions of controllability for Linear Time-Invariant systems, compute the rank of the controllability matrix associated with $\\left(A,B\\right)$ and conclude whether the linearized gene module is controllable in the small-signal sense about the equilibrium. Report your final answer as the rank of the controllability matrix $\\operatorname{rank}\\mathcal{C}$ as a single integer with no units. No rounding is required.",
            "solution": "The problem asks for an assessment of the controllability of a linearized two-gene signaling module described by a Linear Time-Invariant (LTI) state-space model. The model is given by the equation $\\dot{x}(t)=A x(t)+B u(t)$, where the state dimension is $n=2$. The provided matrices are:\n$$\nA=\\begin{bmatrix}0 & 1 \\\\ -2 & -3\\end{bmatrix},\\qquad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}\n$$\nThe controllability of an LTI system is determined by the rank of its controllability matrix, denoted as $\\mathcal{C}$. For a system of dimension $n$, the controllability matrix is constructed as:\n$$\n\\mathcal{C} = \\begin{bmatrix} B & AB & A^2B & \\cdots & A^{n-1}B \\end{bmatrix}\n$$\nThe system is controllable if and only if the controllability matrix $\\mathcal{C}$ has full rank, which means $\\operatorname{rank}(\\mathcal{C}) = n$. This is known as the Kalman rank condition for controllability.\n\nFor the given system, the state dimension is $n=2$. Therefore, the controllability matrix is given by:\n$$\n\\mathcal{C} = \\begin{bmatrix} B & AB \\end{bmatrix}\n$$\nThe first column of $\\mathcal{C}$ is the input matrix $B$ itself:\n$$\nB = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\nThe second column of $\\mathcal{C}$ is the product of the state matrix $A$ and the input matrix $B$. We compute this product:\n$$\nAB = \\begin{bmatrix}0 & 1 \\\\ -2 & -3\\end{bmatrix} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} = \\begin{bmatrix} (0)(0) + (1)(1) \\\\ (-2)(0) + (-3)(1) \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -3 \\end{bmatrix}\n$$\nNow, we can construct the controllability matrix $\\mathcal{C}$ by concatenating the column vectors $B$ and $AB$:\n$$\n\\mathcal{C} = \\begin{bmatrix} 0 & 1 \\\\ 1 & -3 \\end{bmatrix}\n$$\nTo determine the rank of the $2 \\times 2$ matrix $\\mathcal{C}$, we can compute its determinant. A square matrix has full rank if and only if its determinant is non-zero.\n$$\n\\det(\\mathcal{C}) = (0)(-3) - (1)(1) = 0 - 1 = -1\n$$\nSince $\\det(\\mathcal{C}) = -1 \\neq 0$, the columns of the matrix $\\mathcal{C}$ are linearly independent. For a $2 \\times 2$ matrix, this means it has a rank of $2$.\n$$\n\\operatorname{rank}(\\mathcal{C}) = 2\n$$\nAccording to the Kalman rank condition, the system is controllable if $\\operatorname{rank}(\\mathcal{C})$ is equal to the dimension of the state space, $n$. In this case, we have found that $\\operatorname{rank}(\\mathcal{C}) = 2$, and the state dimension is $n=2$. Since $\\operatorname{rank}(\\mathcal{C}) = n$, the system is completely controllable. This implies that it is possible to steer the state of the linearized gene module from any initial state to any desired final state in finite time using an appropriate control input $u(t)$.\n\nThe problem asks for the rank of the controllability matrix, which we have computed to be $2$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "While the Kalman rank condition is precise, it requires exact knowledge of the system's parameters, which are often uncertain in complex biological or social networks. A more robust approach is structural controllability, which assesses control properties based only on the network's wiring diagram. This practice, , introduces this powerful framework, where you will use graph-theoretic tools—specifically, the concept of a maximum matching—to determine the minimum number of driver nodes, $N_D$, needed to ensure full control.",
            "id": "4364459",
            "problem": "A signaling network in systems biomedicine is linearized around a steady operating point, so that its dynamics can be represented by a linear time-invariant (LTI) system with state matrix sparsity encoded by a directed graph on seven nodes labeled $1$ through $7$. An edge $i \\to j$ denotes that the state of node $i$ directly influences the state of node $j$ in the linearized model. The directed edges are:\n- $1 \\to 2$\n- $1 \\to 3$\n- $2 \\to 3$\n- $3 \\to 4$\n- $3 \\to 5$\n- $4 \\to 6$\n- $5 \\to 6$\n- $6 \\to 7$\n- $7 \\to 5$\n\nUsing only fundamental definitions of structural controllability of directed networks and the graph-theoretic notion of matching on the bipartite representation of a directed graph, construct a maximum matching and deduce the minimal number of driver nodes implied by the unmatched nodes. Report only the minimal number of driver nodes as a single integer with no units.",
            "solution": "The problem asks for the minimal number of driver nodes required to control a given directed network, based on the principles of structural controllability and graph-theoretic matching.\n\nThe fundamental principle connecting structural controllability to graph theory states that the minimum number of driver nodes, denoted as $N_D$, required for full control of a directed network with $N$ nodes is given by the equation:\n$$N_D = N - |M^*|$$\nwhere $|M^*|$ is the size (cardinality) of a maximum matching in the directed graph. The driver nodes themselves are the nodes that are not targeted by any edge in the maximum matching.\n\nFirst, we must formalize the network structure as a directed graph $G = (V, E)$, where $V$ is the set of nodes and $E$ is the set of directed edges.\nFrom the problem statement, the set of nodes is $V = \\{1, 2, 3, 4, 5, 6, 7\\}$, so the total number of nodes is $N=7$.\nThe set of directed edges is $E = \\{(1, 2), (1, 3), (2, 3), (3, 4), (3, 5), (4, 6), (5, 6), (6, 7), (7, 5)\\}$.\n\nTo find a maximum matching in the directed graph $G$, we construct a corresponding bipartite graph, $G_B = (V_A \\cup V_B, E')$. This graph consists of two disjoint sets of vertices, $V_A$ and $V_B$, each being a copy of the original node set $V$. Let $V_A = \\{x_1, x_2, x_3, x_4, x_5, x_6, x_7\\}$ and $V_B = \\{y_1, y_2, y_3, y_4, y_5, y_6, y_7\\}$. For each directed edge $i \\to j$ in the original graph $G$, we add an undirected edge between vertex $x_i$ in $V_A$ and vertex $y_j$ in $V_B$.\n\nThe edges $E'$ in the bipartite graph $G_B$ are therefore:\n\\begin{itemize}\n    \\item $(x_1, y_2)$ from the edge $1 \\to 2$\n    \\item $(x_1, y_3)$ from the edge $1 \\to 3$\n    \\item $(x_2, y_3)$ from the edge $2 \\to 3$\n    \\item $(x_3, y_4)$ from the edge $3 \\to 4$\n    \\item $(x_3, y_5)$ from the edge $3 \\to 5$\n    \\item $(x_4, y_6)$ from the edge $4 \\to 6$\n    \\item $(x_5, y_6)$ from the edge $5 \\to 6$\n    \\item $(x_6, y_7)$ from the edge $6 \\to 7$\n    \\item $(x_7, y_5)$ from the edge $7 \\to 5$\n\\end{itemize}\n\nA matching $M$ in $G_B$ is a subset of $E'$ such that no two edges in $M$ share a common vertex. A maximum matching $M^*$ is a matching with the largest possible number of edges. We need to find the size of such a matching, $|M^*|$.\n\nLet's analyze the structure of $G_B$. The vertex $y_1$ in the set $V_B$ has no incident edges. This is because in the original graph $G$, node $1$ has an in-degree of $0$ (no edges point to it). A vertex with no edges cannot be part of any matching. Therefore, $y_1$ must be an unmatched vertex in any matching $M$. Since a matching consists of pairs of vertices, one from $V_A$ and one from $V_B$, the maximum possible size of any matching is limited by the number of vertices that can be matched. As $y_1$ cannot be matched, the size of the maximum matching $|M^*|$ can be at most $N-1 = 7-1 = 6$.\n\nNow, we need to determine if a matching of size $6$ exists. We can construct such a matching by inspection. Let's select a set of $6$ edges from $E'$ that have no common vertices.\nConsider the following set of edges, which we will call $M_{test}$:\n\\begin{itemize}\n    \\item $(x_1, y_2)$\n    \\item $(x_2, y_3)$\n    \\item $(x_3, y_4)$\n    \\item $(x_7, y_5)$\n    \\item $(x_4, y_6)$\n    \\item $(x_6, y_7)$\n\\end{itemize}\nLet's verify if $M_{test}$ is a valid matching.\nThe vertices from $V_A$ used are $\\{x_1, x_2, x_3, x_4, x_6, x_7\\}$. All are distinct.\nThe vertices from $V_B$ used are $\\{y_2, y_3, y_4, y_5, y_6, y_7\\}$. All are distinct.\nSince no vertex is used more than once, $M_{test}$ is a valid matching. The size of this matching is $|M_{test}| = 6$.\n\nSince we have established that the maximum possible size of a matching is at most $6$, and we have found a valid matching of size $6$, we can conclude that the size of the maximum matching is $|M^*| = 6$.\n\nThe unmatched vertices in this matching are $x_5$ from $V_A$ and $y_1$ from $V_B$. The set of driver nodes corresponds to the set of unmatched vertices in $V_B$. In this case, the only unmatched vertex in $V_B$ is $y_1$, which corresponds to node $1$ in the original network. The number of such nodes is $1$.\n\nFinally, we apply the formula for the minimal number of driver nodes:\n$$N_D = N - |M^*|$$\nSubstituting the values we have found:\n$$N_D = 7 - 6 = 1$$\nThe minimal number of driver nodes required to ensure structural controllability of the network is $1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Controllability is not always an all-or-nothing property; a more nuanced understanding comes from analyzing how control inputs affect a system's fundamental dynamic modes. These modes are captured by the eigenvectors of the system matrix. This advanced exercise, , uses the Popov-Belevitch-Hautus (PBH) test to explore how the inherent symmetry of a network can render certain modes uncontrollable from a given input, demonstrating a profound connection between network structure, its spectral properties, and the limits of external influence.",
            "id": "4132643",
            "problem": "Consider a continuous-time linear time-invariant (LTI) networked system representing a ring of $n$ interacting agents in a complex adaptive system. The interaction topology is an undirected, weighted ring graph with uniform coupling weight $\\alpha>0$. The state $\\mathbf{x}(t)\\in\\mathbb{R}^{n}$ evolves under single-leader actuation according to\n$$\n\\dot{\\mathbf{x}}(t) = -L\\,\\mathbf{x}(t) + \\mathbf{b}\\,u(t),\n$$\nwhere $L\\in\\mathbb{R}^{n\\times n}$ is the graph Laplacian of the ring with entries $L_{ii}=2\\alpha$, $L_{i,i+1}=L_{i+1,i}=-\\alpha$ (indices modulo $n$), and $\\mathbf{b}=\\mathbf{e}_{0}$ applies the scalar input $u(t)\\in\\mathbb{R}$ at node $0$.\n\nStarting only from fundamental definitions of the graph Laplacian, the definition of controllability for LTI systems, and the Popov–Belevitch–Hautus (PBH) test for controllability, derive the dimension of the controllable subspace of this system as a function of $n$. Your derivation should explicitly reason about how the symmetry of the ring and the periodic structure of its eigenvectors determine which modal directions are uncontrollable under the single leader input at node $0$.\n\nProvide your final answer as a single closed-form analytic expression in terms of $n$ for the dimension of the controllable subspace. No numerical approximation or rounding is required.",
            "solution": "The dynamics of the networked system are described by the linear time-invariant (LTI) state-space equation:\n$$\n\\dot{\\mathbf{x}}(t) = A\\,\\mathbf{x}(t) + B\\,u(t)\n$$\nwhere the state matrix is $A = -L$ and the input matrix is $B = \\mathbf{b} = \\mathbf{e}_{0}$. Here, $L$ is the graph Laplacian of an undirected, weighted ring graph of $n$ nodes with uniform coupling weight $\\alpha > 0$, and $\\mathbf{e}_{0} \\in \\mathbb{R}^{n}$ is the standard basis vector with a $1$ in the $0$-th position and zeros elsewhere, signifying that the control input $u(t)$ is applied only to node $0$.\n\nTo determine the dimension of the controllable subspace, we employ the Popov–Belevitch–Hautus (PBH) test for controllability. The PBH test states that the pair $(A, B)$ is controllable if and only if the matrix $[\\lambda I - A, B]$ has full row rank ($n$) for every eigenvalue $\\lambda$ of $A$. An equivalent formulation in terms of eigenvectors states that the system is uncontrollable if and only if there exists a left eigenvector $\\mathbf{v}$ of $A$ such that $\\mathbf{v}^{T} B = \\mathbf{0}$.\n\nThe state matrix $A = -L$ is a real symmetric matrix because the graph is undirected. For a symmetric matrix, the left and right eigenvectors are identical (up to transposition). Thus, a mode associated with an eigenvalue $\\lambda$ of $A$ is uncontrollable if there exists a corresponding eigenvector $\\mathbf{v}$ (which is now both a left and right eigenvector) such that $\\mathbf{v}^{T} B = \\mathbf{0}$. In our case, $B=\\mathbf{e}_0$, so the condition for an uncontrollable mode simplifies to finding an eigenvector $\\mathbf{v}$ of $A$ such that:\n$$\n\\mathbf{v}^{T}\\mathbf{e}_{0} = v_{0} = 0\n$$\nwhere $v_{0}$ is the first component of the vector $\\mathbf{v}$. The dimension of the uncontrollable subspace is equal to the number of linearly independent eigenvectors of $A$ that satisfy this condition.\n\nThe graph Laplacian $L$ for the specified ring graph is a circulant matrix. Its first row is $(2\\alpha, -\\alpha, 0, \\dots, 0, -\\alpha)$. The eigenvectors of any $n \\times n$ circulant matrix are well-known and form the basis of the Discrete Fourier Transform (DFT). The (unnormalized) eigenvectors are given by $\\mathbf{z}_{k} = [1, \\omega^{k}, \\omega^{2k}, \\dots, \\omega^{(n-1)k}]^{T}$ for $k \\in \\{0, 1, \\dots, n-1\\}$, where $\\omega = \\exp(i 2\\pi / n)$ is the $n$-th primitive root of unity. The matrix $L$ is real and symmetric, so its eigenvectors can be chosen to be real.\n\nThe eigenvalues of $L$, denoted $\\lambda_{k}(L)$, are given by the DFT of the first row of $L$:\n$$\n\\lambda_{k}(L) = 2\\alpha - \\alpha \\omega^{k} - \\alpha \\omega^{(n-1)k} = 2\\alpha - \\alpha (\\omega^{k} + \\omega^{-k}) = 2\\alpha \\left(1 - \\cos\\left(\\frac{2\\pi k}{n}\\right)\\right) = 4\\alpha \\sin^{2}\\left(\\frac{\\pi k}{n}\\right)\n$$\nfor $k = 0, 1, \\dots, n-1$. The eigenvalues of $A = -L$ are therefore $\\lambda_{k}(A) = -4\\alpha \\sin^{2}(\\pi k / n)$.\n\nWe must examine the multiplicity of these eigenvalues. Notice that $\\sin^{2}(\\pi k / n) = \\sin^{2}(\\pi (n-k) / n)$, which implies $\\lambda_{k}(L) = \\lambda_{n-k}(L)$.\nThis gives rise to three cases for the eigenspectrum:\n\nCase 1: The eigenvalue $\\lambda_{0}(L) = 0$. This eigenvalue is simple. The corresponding eigenvector is $\\mathbf{z}_{0} = [1, 1, \\dots, 1]^{T}$. This is a real vector. The first component is $v_0=1 \\neq 0$. Thus, this mode is controllable.\n\nCase 2: If $n$ is even, the eigenvalue for $k = n/2$ is $\\lambda_{n/2}(L) = 4\\alpha \\sin^{2}(\\pi (n/2)/n) = 4\\alpha$. This eigenvalue is also simple. The eigenvector is $\\mathbf{z}_{n/2} = [1, -1, 1, \\dots, -1]^{T}$. This vector is real, and its first component is $v_0=1 \\neq 0$. This mode is controllable.\n\nCase 3: For $k \\in \\{1, 2, \\dots, \\lfloor(n-1)/2\\rfloor\\}$, the eigenvalues $\\lambda_{k}(L)$ are degenerate, each with a multiplicity of $2$. The eigenspace for $\\lambda_k(L)$ is spanned by the complex conjugate pair of eigenvectors $\\mathbf{z}_{k}$ and $\\mathbf{z}_{n-k} = \\overline{\\mathbf{z}_{k}}$. From this pair, we can construct a basis of two real eigenvectors for the eigenspace:\n$$\n\\mathbf{v}_{k,c} = \\frac{1}{\\sqrt{2}}(\\mathbf{z}_{k} + \\mathbf{z}_{n-k}) = \\sqrt{2} \\, \\text{Re}(\\mathbf{z}_{k})\n$$\n$$\n\\mathbf{v}_{k,s} = \\frac{i}{\\sqrt{2}}(\\mathbf{z}_{k} - \\mathbf{z}_{n-k}) = -\\sqrt{2} \\, \\text{Im}(\\mathbf{z}_{k})\n$$\nThe $j$-th component of these real eigenvectors (up to a scaling factor) are:\n$$\n(\\mathbf{v}_{k,c})_j \\propto \\cos\\left(\\frac{2\\pi j k}{n}\\right)\n$$\n$$\n(\\mathbf{v}_{k,s})_j \\propto \\sin\\left(\\frac{2\\pi j k}{n}\\right)\n$$\nwhere $j \\in \\{0, 1, \\dots, n-1\\}$.\n\nNow we apply the PBH condition $v_{0}=0$ to these real eigenvectors. The first component corresponds to $j=0$:\n$$\n(\\mathbf{v}_{k,c})_{0} \\propto \\cos(0) = 1 \\neq 0\n$$\n$$\n(\\mathbf{v}_{k,s})_{0} \\propto \\sin(0) = 0\n$$\nThis result is crucial. For each degenerate eigenvalue $\\lambda_{k}(L)$ (where $k \\in \\{1, 2, \\dots, \\lfloor(n-1)/2\\rfloor\\}$), the two-dimensional eigenspace contains exactly one direction (spanned by $\\mathbf{v}_{k,s}$) that is orthogonal to the input vector $\\mathbf{e}_{0}$. This is a direct consequence of the symmetry of the ring graph and the choice of a single leader at node $0$. The \"sine\" modes have a node at position $0$ and are therefore unobservable from and uncontrollable by an actuator at that node.\n\nThe dimension of the uncontrollable subspace is the total count of these uncontrollable eigenvectors. We have one such eigenvector for each value of $k$ from $1$ to $\\lfloor(n-1)/2\\rfloor$. Therefore, the dimension of the uncontrollable subspace is:\n$$\n\\text{dim}(\\mathcal{U}) = \\lfloor \\frac{n-1}{2} \\rfloor\n$$\nThe dimension of the controllable subspace, $\\text{dim}(\\mathcal{C})$, is the total dimension of the state space, $n$, minus the dimension of the uncontrollable subspace:\n$$\n\\text{dim}(\\mathcal{C}) = n - \\text{dim}(\\mathcal{U}) = n - \\left\\lfloor \\frac{n-1}{2} \\right\\rfloor\n$$\nWe can simplify this expression.\nIf $n$ is odd, let $n = 2m+1$ for some integer $m \\ge 0$.\n$$\n\\text{dim}(\\mathcal{C}) = (2m+1) - \\left\\lfloor \\frac{(2m+1)-1}{2} \\right\\rfloor = (2m+1) - m = m+1 = \\frac{n-1}{2} + 1 = \\frac{n+1}{2}\n$$\nIf $n$ is even, let $n = 2m$ for some integer $m \\ge 1$.\n$$\n\\text{dim}(\\mathcal{C}) = 2m - \\left\\lfloor \\frac{2m-1}{2} \\right\\rfloor = 2m - \\left\\lfloor m - \\frac{1}{2} \\right\\rfloor = 2m - (m-1) = m+1 = \\frac{n}{2} + 1\n$$\nBoth cases can be compactly represented by the single expression $\\lfloor n/2 \\rfloor + 1$.\nThus, the dimension of the controllable subspace is $\\lfloor n/2 \\rfloor + 1$.",
            "answer": "$$\\boxed{\\left\\lfloor \\frac{n}{2} \\right\\rfloor + 1}$$"
        }
    ]
}