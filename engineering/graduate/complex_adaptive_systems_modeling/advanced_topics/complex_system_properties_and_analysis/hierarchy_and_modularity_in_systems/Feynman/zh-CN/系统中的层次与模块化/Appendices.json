{
    "hands_on_practices": [
        {
            "introduction": "层次聚类是一种从数据中发现嵌套结构的基本算法。本练习将引导你完成平均链接法，这是一种通过迭代合并最“接近”的聚类来构建层次结构的技术。本实践旨在巩固如何使用相异性的量化度量来构建层次结构这一概念 。",
            "id": "4126046",
            "problem": "考虑一个由五个相互作用的模块 $M_{1}, M_{2}, M_{3}, M_{4}, M_{5}$ 组成的复杂自适应系统。假设模块间的非相似性已通过一个从长期行为差异中推导出来的、经过科学验证的度量进行了量化，得到了如下的对称距离矩阵 $D$（矩阵中的元素是无量纲的，对角线元素为 $0$）：\n$$\nD=\\begin{pmatrix}\n0  & 0.18 & 0.55 & 0.60 & 0.40 \\\\\n0.18 & 0 & 0.58 & 0.59 & 0.42 \\\\\n0.55 & 0.58 & 0 & 0.22 & 0.45 \\\\\n0.60 & 0.59 & 0.22 & 0 & 0.47 \\\\\n0.40 & 0.42 & 0.45 & 0.47 & 0\n\\end{pmatrix}.\n$$\n根据复杂自适应系统中层次组织的基本原理，使用平均链接层次聚类的核心定义：两个簇 $U$ 和 $V$ 之间的距离是所有满足 $i \\in U$ 和 $j \\in V$ 的配对 $(i,j)$ 的 $D(i,j)$ 值的平均值。从将每个模块视为一个单独的簇开始，迭代地合并簇间距离最小的两个簇。执行恰好三次合并，并报告树状图的合并高度，其定义为每次合并时簇与簇之间的距离。将这三个高度表示为一个行矩阵，并提供精确的小数值。不需要四舍五入，这些值是无量纲的。",
            "solution": "任务是使用平均链接方法对给定的模块执行凝聚型层次聚类。我们从基本定义开始：在平均链接聚类中，对于任意两个簇 $U$ 和 $V$，簇间距离为\n$$\nd(U,V) = \\frac{1}{|U|\\,|V|} \\sum_{i \\in U} \\sum_{j \\in V} D(i,j),\n$$\n其中 $|U|$ 和 $|V|$ 分别表示簇 $U$ 和 $V$ 中元素的数量。每个凝聚步骤的树状图合并高度是在该步骤中合并的簇对 $U$ 和 $V$ 的 $d(U,V)$ 值。\n\n我们从五个单元素簇开始：$\\{M_{1}\\}$, $\\{M_{2}\\}$, $\\{M_{3}\\}$, $\\{M_{4}\\}$, $\\{M_{5}\\}$。对于单元素簇，簇间距离等于矩阵 $D$ 中对应的项。\n\n步骤1：找出所有单元素簇对中的最小距离。通过检查矩阵 $D$，我们发现最小值为 $D(1,2) = 0.18$。因此，我们在高度 $0.18$ 处合并 $\\{M_{1}\\}$ 和 $\\{M_{2}\\}$。第一个树状图合并高度是 $0.18$。现在我们有簇 $\\{M_{1},M_{2}\\}$, $\\{M_{3}\\}$, $\\{M_{4}\\}$, $\\{M_{5}\\}$。\n\n步骤2：计算新簇 $\\{M_{1},M_{2}\\}$ 与其他簇的距离，并找到所有当前簇间距离中的最小值。\n- $d(\\{M_{1},M_{2}\\},\\{M_{3}\\}) = \\frac{D(1,3) + D(2,3)}{2} = \\frac{0.55 + 0.58}{2} = 0.565$。\n- $d(\\{M_{1},M_{2}\\},\\{M_{4}\\}) = \\frac{D(1,4) + D(2,4)}{2} = \\frac{0.60 + 0.59}{2} = 0.595$。\n- $d(\\{M_{1},M_{2}\\},\\{M_{5}\\}) = \\frac{D(1,5) + D(2,5)}{2} = \\frac{0.40 + 0.42}{2} = 0.41$。\n- 剩余单元素簇之间的距离为 $D(3,4) = 0.22$, $D(3,5) = 0.45$, $D(4,5) = 0.47$。\n在所有这些距离中，最小值为 $D(3,4) = 0.22$。因此，我们在高度 $0.22$ 处合并 $\\{M_{3}\\}$ 和 $\\{M_{4}\\}$。第二个树状图合并高度是 $0.22$。现在我们有簇 $\\{M_{1},M_{2}\\}$, $\\{M_{3},M_{4}\\}$, $\\{M_{5}\\}$。\n\n步骤3：计算当前三个簇之间的平均链接距离，并找到最小值。\n- $d(\\{M_{1},M_{2}\\},\\{M_{5}\\}) = 0.41$ (已计算)。\n- $d(\\{M_{3},M_{4}\\},\\{M_{5}\\}) = \\frac{D(3,5) + D(4,5)}{2} = \\frac{0.45 + 0.47}{2} = 0.46$。\n- $d(\\{M_{1},M_{2}\\},\\{M_{3},M_{4}\\}) = \\frac{D(1,3) + D(1,4) + D(2,3) + D(2,4)}{4} = \\frac{0.55 + 0.60 + 0.58 + 0.59}{4} = \\frac{2.32}{4} = 0.58$。\n在这些距离 $\\{0.41, 0.46, 0.58\\}$ 中，最小值为 $0.41$，对应于将 $\\{M_{1},M_{2}\\}$ 与 $\\{M_{5}\\}$ 合并。第三个树状图合并高度是 $0.41$。\n\n按发生顺序收集这三个合并高度，我们得到高度的行矩阵：\n$$\n\\begin{pmatrix}\n0.18 & 0.22 & 0.41\n\\end{pmatrix}.\n$$\n不需要四舍五入，且所有值都是无量纲的。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.18 & 0.22 & 0.41\\end{pmatrix}}$$"
        },
        {
            "introduction": "本练习将重点从静态数据转移到动态系统。对于由马尔可夫链描述的复杂系统，我们通常希望通过将状态分组到模块中来简化它。这个练习探讨了“强可集结性”，这是一个严格的条件，确保简化后的模块级动态仍然是马尔可夫式的且定义良好。本实践可以让你深入理解系统动态如何约束有效模块化描述的选择 。",
            "id": "4126065",
            "problem": "考虑一个时间齐次的离散时间马尔可夫链，其有限状态空间为 $\\mathcal{S}=\\{1,2,3,4\\}$，转移矩阵为 $P\\in\\mathbb{R}^{4\\times 4}$，其中第 $(i,j)$ 个元素 $P_{ij}$ 是从状态 $i$ 一步转移到状态 $j$ 的概率。矩阵 $P$ 由下式给出\n$$\nP=\\begin{pmatrix}\n0.2 & 0.3 & 0.3 & 0.2 \\\\\n0.3 & 0.2 & 0.3 & 0.2 \\\\\n0.15 & 0.15 & 0.4 & 0.3 \\\\\n0.15 & 0.15 & 0.3 & 0.4\n\\end{pmatrix}.\n$$\n一个将 $\\mathcal{S}$ 划分为 $2$ 个不相交非空块的划分 $\\mathcal{B}=\\{B_{1},B_{2}\\}$ 被称为是强可集结的 (strongly lumpable)，如果通过根据 $\\mathcal{B}$ 聚合微观状态所诱导的在块上的宏观过程是一个马尔可夫链，并且这个过程不依赖于块内的当前微观状态。基于马尔可夫链和聚合中强可集结性的基本定义，枚举出 $\\{1,2,3,4\\}$ 的所有无序 $2$ 块划分，并对每个划分 $\\mathcal{B}$，检验其对于矩阵 $P$ 是否是强可集结的。\n\n计算对于此矩阵 $P$ 是强可集结的 $2$ 块划分的总数 $N$，并将 $N$ 作为你的最终答案。最终答案必须是一个没有单位的整数。不需要四舍五入。",
            "solution": "强可集结性 (Strong lumpability) 的条件是：对于一个划分 $\\mathcal{B}=\\{B_{1}, B_{2}, \\dots, B_k\\}$，任意两个属于同一块 $B_k$ 的微观状态 $i, j \\in B_k$，它们转移到任何其他块 $B_\\ell$ 的总概率必须相等。形式化地，对于任意 $k, \\ell \\in \\{1, \\dots, K\\}$，以及任意 $i,j \\in B_k$，必须满足：\n$$\n\\sum_{m \\in B_{\\ell}} P_{im} = \\sum_{m \\in B_{\\ell}} P_{jm}\n$$\n由于行和为1，这个条件对于所有块 $B_\\ell$ 成立等价于它对于 $K-1$ 个块成立。对于2块划分 $\\{B_1, B_2\\}$，我们只需检验对于 $B_1$ (或 $B_2$) 是否成立。\n\n我们需要检验状态空间 $\\mathcal{S}=\\{1,2,3,4\\}$ 的所有 $S(4,2)=7$ 个无序2块划分。\n\n1.  **划分 $\\{\\{1,2\\}, \\{3,4\\}\\}$:**\n    - 检验块 $\\{1,2\\}$:\n      - 转移到 $\\{1,2\\}$ 的概率和: $P_{11}+P_{12}=0.2+0.3=0.5$。$P_{21}+P_{22}=0.3+0.2=0.5$。相等。\n    - 检验块 $\\{3,4\\}$:\n      - 转移到 $\\{1,2\\}$ 的概率和: $P_{31}+P_{32}=0.15+0.15=0.3$。$P_{41}+P_{42}=0.15+0.15=0.3$。相等。\n    此划分为强可集结。\n\n2.  **划分 $\\{\\{1,3\\}, \\{2,4\\}\\}$:**\n    - 检验块 $\\{1,3\\}$:\n      - 转移到 $\\{1,3\\}$ 的概率和: $P_{11}+P_{13}=0.2+0.3=0.5$。$P_{31}+P_{33}=0.15+0.4=0.55$。不相等。\n    此划分非强可集结。\n\n3.  **划分 $\\{\\{1,4\\}, \\{2,3\\}\\}$:**\n    - 检验块 $\\{1,4\\}$:\n      - 转移到 $\\{1,4\\}$ 的概率和: $P_{11}+P_{14}=0.2+0.2=0.4$。$P_{41}+P_{44}=0.15+0.4=0.55$。不相等。\n    此划分非强可集结。\n\n4.  **划分 $\\{\\{3\\}, \\{1,2,4\\}\\}$:**\n    - 单元素块 $\\{3\\}$ 天然满足条件。\n    - 检验块 $\\{1,2,4\\}$:\n      - 转移到 $\\{3\\}$ 的概率和: $P_{13}=0.3$。$P_{23}=0.3$。$P_{43}=0.3$。全部相等。\n    此划分为强可集结。\n\n5.  **划分 $\\{\\{1\\}, \\{2,3,4\\}\\}$:**\n    - 检验块 $\\{2,3,4\\}$:\n      - 转移到 $\\{1\\}$ 的概率和: $P_{21}=0.3$。$P_{31}=0.15$。不相等。\n    此划分非强可集结。\n\n6.  **划分 $\\{\\{2\\}, \\{1,3,4\\}\\}$:**\n    - 检验块 $\\{1,3,4\\}$:\n      - 转移到 $\\{2\\}$ 的概率和: $P_{12}=0.3$。$P_{32}=0.15$。不相等。\n    此划分非强可集结。\n\n7.  **划分 $\\{\\{4\\}, \\{1,2,3\\}\\}$:**\n    - 检验块 $\\{1,2,3\\}$:\n      - 转移到 $\\{4\\}$ 的概率和: $P_{14}=0.2$。$P_{24}=0.2$。$P_{34}=0.3$。不相等。\n    此划分非强可集结。\n\n综上所述，共有两个强可集结的划分：$\\{\\{1,2\\}, \\{3,4\\}\\}$ 和 $\\{\\{3\\}, \\{1,2,4\\}\\}$。\n因此，强可集结的 $2$ 块划分的总数 $N$ 为 $2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在网络中，我们常常需要通过寻找一个“好”的划分来识别社区结构，这通常被表述为一个优化问题。模块度 ($Q$) 是衡量网络划分质量的常用指标，而Louvain方法是最大化模块度的强大启发式算法。本练习将让你亲手实践Louvain算法的核心步骤，通过评估移动节点带来的模块度变化 ($\\Delta Q$) 来局部优化划分，从而阐释许多社区发现算法的贪心、自下而上的特性 。",
            "id": "4126110",
            "problem": "考虑一个带权的无向玩具网络，该网络有 $6$ 个标记为 $\\{1,2,3,4,5,6\\}$ 的节点，其邻接矩阵 $\\mathbf{A}$ 为\n$$\n\\mathbf{A} \\;=\\;\n\\begin{pmatrix}\n0  & 1 & 1 & 0 & 0 & 0 \\\\\n1  & 0 & 1 & 0 & 0.1 & 0 \\\\\n1  & 1 & 0 & 0.1 & 0 & 0 \\\\\n0  & 0 & 0.1 & 0 & 1 & 1 \\\\\n0  & 0.1 & 0 & 1 & 0 & 1 \\\\\n0  & 0 & 0 & 1 & 1 & 0 \\\\\n\\end{pmatrix}.\n$$\n所有权重都是对称的，并且初始时没有自环。令 $m$ 表示总边权（所有无向边的权重之和），令 $k_i$ 为节点 $i$ 的加权度。\n\n您将执行一轮 Louvain 启发式算法，从每个节点自成一个社区的初始划分开始。使用带权无向网络的标准模块度定义，分辨率参数 $\\gamma = 1$，并按如下步骤进行。\n\n- 局部移动阶段：按节点索引的递增顺序 $1 \\rightarrow 2 \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow 6$ 访问节点。对于一个节点 $i$，考虑将其移动到与 $i$ 相邻的每个邻居 $j$（基于 $\\mathbf{A}$）所在的社区，并计算在当前划分下每次候选移动的模块度变化 $\\Delta Q$。如果所有候选的 $\\Delta Q \\leq 0$，则将节点 $i$ 保留在其当前社区中。如果有任何候选的 $\\Delta Q > 0$，则将 $i$ 移动到能产生最大 $\\Delta Q$ 的邻居社区中。如果 $\\Delta Q$ 出现平局，选择与 $i$ 通过最大边权相连的邻居（如果仍然平局，则选择索引最小的邻居）。重复扫描，直到完成一次完整的扫描而没有任何节点移动，这表示局部移动阶段收敛。\n- 聚合阶段：将在局部移动阶段结束时找到的社区聚合成超节点。超节点上的自环权重等于该社区内所有内部边的权重之和，两个超节点之间的权重等于原始图中这两个社区之间所有边的权重之和。\n\n从模块度的定义出发，推导出在该网络上执行局部移动阶段所需的适当的 $\\Delta Q$ 表达式，根据上述规则评估候选移动，并确定收敛后的最终社区。然后构建聚合网络，并计算局部移动阶段找到的划分的改进模块度 $Q$（在聚合网络上评估）。将最终模块度表示为一个最简分数。不允许四舍五入。您的最终答案必须是 $Q$ 的一个单一闭式值。",
            "solution": "为执行Louvain算法，我们首先需要推导模块度变化 $\\Delta Q$ 的表达式，并计算网络的基本属性。对于分辨率参数 $\\gamma=1$，将一个节点 $i$ 从其当前社区 $D$ 移动到另一个社区 $C$ 时，模块度的变化量 $\\Delta Q$ 可以高效地计算为：\n$$ \\Delta Q = \\left( \\frac{k_{i,C}}{m} - \\frac{\\Sigma_{tot}^{(C)} k_i}{2m^2} \\right) - \\left( \\frac{k_{i, D \\setminus \\{i\\}}}{m} - \\frac{(\\Sigma_{tot}^{(D)} - k_i)k_i}{2m^2} \\right) $$\n其中 $k_{i,C}$ 是从节点 $i$ 到社区 $C$ 的边权之和，$\\Sigma_{tot}^{(C)}$ 是社区 $C$ 中所有节点的度之和。在初始阶段，每个节点自成社区，$\\Delta Q$ 简化为 $\\Delta Q = \\frac{k_{i,C}}{m} - \\frac{\\Sigma_{tot}^{(C)} k_i}{2m^2}$。\n\n首先，我们计算网络的基本参数：\n节点的加权度为：$k_1=2, k_2=2.1, k_3=2.1, k_4=2.1, k_5=2.1, k_6=2$。\n总边权 $m = \\frac{1}{2}\\sum k_i = \\frac{1}{2}(12.4) = 6.2$。\n我们还需要 $2m^2 = 2 \\times (6.2)^2 = 76.88$。\n\n**局部移动阶段**\n初始划分：$P_0 = \\{\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}\\}$。\n\n**第一轮扫描：**\n1.  **节点 1 (邻居: 2, 3):**\n    - 移至 $\\{2\\}$: $\\Delta Q = \\frac{A_{12}}{m} - \\frac{k_2 k_1}{2m^2} = \\frac{1}{6.2} - \\frac{2.1 \\times 2}{76.88} = \\frac{8.2}{76.88} > 0$。\n    - 移至 $\\{3\\}$: $\\Delta Q = \\frac{A_{13}}{m} - \\frac{k_3 k_1}{2m^2} = \\frac{1}{6.2} - \\frac{2.1 \\times 2}{76.88} = \\frac{8.2}{76.88} > 0$。\n    $\\Delta Q$ 相同，边权 $A_{12}=A_{13}=1$ 也相同，按规则选择索引最小的邻居 $2$。将节点 $1$ 移入 $\\{2\\}$ 的社区。当前划分：$\\{\\{1,2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}\\}$。\n\n2.  **节点 2 (邻居: 1, 3, 5):**\n    节点 2 现处于社区 $D=\\{1,2\\}$。考虑移至邻居社区。\n    - 移至 $\\{3\\}$: 从 $D=\\{1,2\\}$ 移至 $C=\\{3\\}$。$\\Delta Q = (\\frac{A_{23}}{m} - \\frac{k_3 k_2}{2m^2}) - (\\frac{A_{21}}{m} - \\frac{k_1 k_2}{2m^2}) = \\frac{1}{76.88}(-k_3 k_2 + k_1 k_2) = \\frac{2.1}{76.88}(-2.1+2)  0$。不移动。\n    - 移至 $\\{5\\}$: 类似地，$\\Delta Q  0$。不移动。\n\n3.  **节点 3 (邻居: 1, 2, 4):**\n    - 移至 $\\{1,2\\}$: $k_{3,\\{1,2\\}} = A_{31}+A_{32} = 2$。$\\Sigma_{tot}^{\\{1,2\\}} = k_1+k_2=4.1$。$\\Delta Q = \\frac{2}{6.2} - \\frac{4.1 \\times 2.1}{76.88} = \\frac{24.8 - 8.61}{76.88} > 0$。\n    - 移至 $\\{4\\}$: $k_{3,\\{4\\}} = A_{34}=0.1$。$\\Delta Q = \\frac{0.1}{6.2} - \\frac{k_4 k_3}{2m^2}  0$。\n    将节点 $3$ 移入 $\\{1,2\\}$ 的社区。当前划分：$\\{\\{1,2,3\\}, \\{4\\}, \\{5\\}, \\{6\\}\\}$。\n\n4.  **节点 4 (邻居: 3, 5, 6):**\n    - 移至 $\\{1,2,3\\}$: $k_{4,\\{1,2,3\\}} = A_{43}=0.1$。$\\Delta Q  0$。\n    - 移至 $\\{5\\}$: $\\Delta Q = \\frac{A_{45}}{m} - \\frac{k_5 k_4}{2m^2} = \\frac{1}{6.2} - \\frac{2.1 \\times 2.1}{76.88} = \\frac{7.99}{76.88} > 0$。\n    - 移至 $\\{6\\}$: $\\Delta Q = \\frac{A_{46}}{m} - \\frac{k_6 k_4}{2m^2} = \\frac{1}{6.2} - \\frac{2 \\times 2.1}{76.88} = \\frac{8.2}{76.88} > 0$。\n    选择增益最大的移动，即移至 $\\{6\\}$ 的社区。当前划分：$\\{\\{1,2,3\\}, \\{4,6\\}, \\{5\\}\\}$。\n\n5.  **节点 5 (邻居: 2, 4, 6):**\n    - 移至 $\\{1,2,3\\}$: $k_{5,\\{1,2,3\\}} = A_{52}=0.1$。$\\Delta Q  0$。\n    - 移至 $\\{4,6\\}$: $k_{5,\\{4,6\\}} = A_{54}+A_{56}=2$。$\\Sigma_{tot}^{\\{4,6\\}} = k_4+k_6=4.1$。$\\Delta Q = \\frac{2}{6.2} - \\frac{4.1 \\times 2.1}{76.88} > 0$。\n    将节点 $5$ 移入 $\\{4,6\\}$ 的社区。当前划分：$\\{\\{1,2,3\\}, \\{4,5,6\\}\\}$。\n\n6.  **节点 6 (邻居: 4, 5):**\n    所有邻居已在其当前社区 $\\{4,5,6\\}$ 中，无法移动。\n\n**第二轮扫描：**\n我们检查最终划分 $P_{final} = \\{\\{1,2,3\\}, \\{4,5,6\\}\\}$ 是否稳定。令 $C_A=\\{1,2,3\\}, C_B=\\{4,5,6\\}$。对于 $C_A$ 中的任意节点 $i$，考虑移至 $C_B$。例如节点 $3$（邻居 $4$ 在 $C_B$ 中）：$\\Delta Q(\\text{move } 3 \\to C_B)  0$。由于网络的对称性，对所有跨社区边界的节点进行类似的计算，$\\Delta Q$ 均为负。因此，没有节点会移动，局部移动阶段收敛。\n\n**聚合与模块度计算**\n最终划分为 $C_A = \\{1,2,3\\}$ 和 $C_B = \\{4,5,6\\}$。我们计算该划分的模块度 $Q$：\n$$ Q = \\sum_{C \\in P_{final}} \\left[ \\frac{\\Sigma_{in}^{(C)}}{m} - \\left( \\frac{\\Sigma_{tot}^{(C)}}{2m} \\right)^2 \\right] $$\n- 社区 $C_A$: 内部边权和 $\\Sigma_{in}^{(A)} = A_{12}+A_{13}+A_{23} = 1+1+1=3$。度和 $\\Sigma_{tot}^{(A)} = k_1+k_2+k_3 = 6.2$。\n- 社区 $C_B$: 内部边权和 $\\Sigma_{in}^{(B)} = A_{45}+A_{46}+A_{56} = 1+1+1=3$。度和 $\\Sigma_{tot}^{(B)} = k_4+k_5+k_6 = 6.2$。\n\n将这些值代入模块度公式：\n$$ Q = \\left[ \\frac{3}{6.2} - \\left( \\frac{6.2}{2 \\times 6.2} \\right)^2 \\right] + \\left[ \\frac{3}{6.2} - \\left( \\frac{6.2}{2 \\times 6.2} \\right)^2 \\right] $$\n$$ Q = 2 \\times \\left[ \\frac{3}{6.2} - \\left( \\frac{1}{2} \\right)^2 \\right] = 2 \\times \\left( \\frac{3}{6.2} - \\frac{1}{4} \\right) = \\frac{6}{6.2} - \\frac{1}{2} $$\n$$ Q = \\frac{60}{62} - \\frac{1}{2} = \\frac{30}{31} - \\frac{1}{2} = \\frac{60 - 31}{62} = \\frac{29}{62} $$\n该分数为最简形式。",
            "answer": "$$\\boxed{\\frac{29}{62}}$$"
        }
    ]
}