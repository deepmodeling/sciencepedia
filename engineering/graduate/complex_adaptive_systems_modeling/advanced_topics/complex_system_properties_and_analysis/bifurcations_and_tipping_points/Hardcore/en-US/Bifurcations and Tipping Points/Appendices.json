{
    "hands_on_practices": [
        {
            "introduction": "Understanding complex system transitions often begins with studying their simplest mathematical representations, known as normal forms. This practice focuses on the normal form for a supercritical pitchfork bifurcation, a fundamental model for continuous and symmetric state changes, such as the onset of coordinated behavior in a population. By analyzing the model $\\dot{x} = \\mu x - x^3$ from first principles , you will master the core techniques of finding equilibria, assessing their stability via linearization, and understanding how an underlying $\\mathbb{Z}_2$ symmetry ($x \\mapsto -x$) mandates the specific 'pitchfork' structure of the transition.",
            "id": "4115580",
            "problem": "Consider a minimal, one-dimensional, symmetry-preserving coordination model for a collective variable $x$ in Complex Adaptive Systems (CAS), where the time evolution is given by the ordinary differential equation $\\dot{x}=\\mu x - x^{3}$. The parameter $\\mu$ represents a slowly varying control drive (e.g., net gain in alignment), and the state $x$ encodes a global order parameter invariant under sign inversion, i.e., the dynamics is equivariant with respect to the $\\mathbb{Z}_{2}$ group action $x\\mapsto -x$. Starting from first principles, and using only core definitions and well-tested facts (equilibrium points, linearization for stability in one dimension, and the concept of gradient dynamics), do the following:\n\n1. Derive all equilibrium points $x^{\\ast}$ as functions of the control parameter $\\mu$ by solving $\\dot{x}=0$.\n\n2. Classify the linear stability of each equilibrium $x^{\\ast}$ as a function of $\\mu$ using the one-dimensional linearization criterion based on $\\frac{d}{dx}(\\mu x - x^{3})$ evaluated at each equilibrium. Justify the classification from first principles.\n\n3. Explain, using the invariance under $x\\mapsto -x$ and the structure of the lowest-order odd nonlinearity compatible with this symmetry, how the $\\mathbb{Z}_{2}$ symmetry constrains the bifurcation to take the pitchfork form and why the branches emerging at the bifurcation are symmetric.\n\n4. As a succinct quantitative summary of the stability landscape, construct a scalar potential $V(x;\\mu)$ such that the dynamics is a gradient flow $\\dot{x}=-\\frac{\\partial V}{\\partial x}$. Choose the additive constant so that $V(0;\\mu)=0$. Provide your final answer as a single closed-form analytic expression for $V(x;\\mu)$, with no units. No rounding is required.",
            "solution": "The problem statement is a standard and well-posed exercise in elementary bifurcation theory, specifically concerning the analysis of a supercritical pitchfork bifurcation. It is scientifically grounded, internally consistent, and requires the application of fundamental principles of dynamical systems. The problem is therefore deemed valid.\n\nThe dynamical system is described by the one-dimensional ordinary differential equation:\n$$\n\\dot{x} = \\frac{dx}{dt} = f(x; \\mu) = \\mu x - x^{3}\n$$\nwhere $x$ is the state variable and $\\mu$ is a control parameter.\n\n1. Derivation of Equilibrium Points\n\nEquilibrium points, denoted by $x^{\\ast}$, are the states where the system does not change in time, i.e., $\\dot{x} = 0$. To find them, we solve the algebraic equation $f(x^{\\ast}; \\mu) = 0$.\n$$\n\\mu x^{\\ast} - (x^{\\ast})^{3} = 0\n$$\nFactoring out $x^{\\ast}$, we obtain:\n$$\nx^{\\ast} (\\mu - (x^{\\ast})^{2}) = 0\n$$\nThis equation has two possibilities for solutions.\n\nCase 1: $x^{\\ast} = 0$.\nThis gives a trivial equilibrium point, $x^{\\ast}_{0} = 0$. This equilibrium exists for all values of the parameter $\\mu$.\n\nCase 2: $\\mu - (x^{\\ast})^{2} = 0$.\nThis gives $(x^{\\ast})^{2} = \\mu$. For real-valued solutions for $x^{\\ast}$ to exist, we must have $\\mu \\ge 0$. When this condition is met, we find two additional equilibrium points:\n$$\nx^{\\ast}_{\\pm} = \\pm\\sqrt{\\mu}\n$$\nThese two non-trivial equilibrium points emerge at $\\mu=0$ and exist only for $\\mu \\ge 0$.\n\nIn summary, the equilibrium points as a function of $\\mu$ are:\n- For $\\mu  0$: one equilibrium point, $x^{\\ast}_{0} = 0$.\n- For $\\mu \\ge 0$: three equilibrium points, $x^{\\ast}_{0} = 0$ and $x^{\\ast}_{\\pm} = \\pm\\sqrt{\\mu}$.\n\n2. Linear Stability Analysis of Equilibria\n\nThe stability of a one-dimensional equilibrium point $x^{\\ast}$ is determined by the sign of the derivative of the vector field, $f'(x) = \\frac{df}{dx}$, evaluated at $x^{\\ast}$. If $f'(x^{\\ast})  0$, small perturbations decay, and the equilibrium is stable (an attractor). If $f'(x^{\\ast}) > 0$, small perturbations grow, and the equilibrium is unstable (a repeller). If $f'(x^{\\ast}) = 0$, the equilibrium is non-hyperbolic, and linear analysis is inconclusive.\n\nFirst, we compute the derivative of $f(x; \\mu) = \\mu x - x^{3}$:\n$$\nf'(x; \\mu) = \\frac{d}{dx}(\\mu x - x^{3}) = \\mu - 3x^{2}\n$$\nNow, we evaluate this derivative at each equilibrium point.\n\nStability of $x^{\\ast}_{0} = 0$:\n$$\nf'(0; \\mu) = \\mu - 3(0)^{2} = \\mu\n$$\n- If $\\mu  0$, $f'(0; \\mu)  0$, so the equilibrium $x^{\\ast}_{0}=0$ is stable.\n- If $\\mu > 0$, $f'(0; \\mu) > 0$, so the equilibrium $x^{\\ast}_{0}=0$ is unstable.\n- At $\\mu = 0$, $f'(0; 0) = 0$. The stability changes at this point, which is the bifurcation point.\n\nStability of $x^{\\ast}_{\\pm} = \\pm\\sqrt{\\mu}$ (for $\\mu > 0$):\nWe evaluate the derivative at these points:\n$$\nf'(\\pm\\sqrt{\\mu}; \\mu) = \\mu - 3(\\pm\\sqrt{\\mu})^{2} = \\mu - 3\\mu = -2\\mu\n$$\nSince these equilibria only exist for $\\mu > 0$, the derivative $f'(\\pm\\sqrt{\\mu}; \\mu) = -2\\mu$ is always negative for $\\mu > 0$. Therefore, the two non-trivial equilibrium branches $x^{\\ast}_{\\pm} = \\pm\\sqrt{\\mu}$ are stable whenever they exist. At $\\mu=0$, they merge with the trivial branch and their stability is also non-hyperbolic.\n\nThe overall behavior is a transfer of stability from the trivial branch $x^{\\ast}_{0}=0$ to the two new stable branches $x^{\\ast}_{\\pm}=\\pm\\sqrt{\\mu}$ as the parameter $\\mu$ increases through $0$. This is the hallmark of a supercritical pitchfork bifurcation.\n\n3. Role of $\\mathbb{Z}_{2}$ Symmetry\n\nThe dynamics $\\dot{x} = f(x, \\mu)$ is stated to be equivariant with respect to the $\\mathbb{Z}_{2}$ group action $x\\mapsto -x$. This property imposes a constraint on the functional form of $f(x, \\mu)$. Specifically, if $x(t)$ is a solution, then $-x(t)$ must also be a solution. Let $y(t) = -x(t)$, so $\\dot{y} = -\\dot{x} = -f(x, \\mu)$. For $y(t)$ to be a solution, it must satisfy $\\dot{y} = f(y, \\mu)$. Substituting $y=-x$, we get $\\dot{y} = f(-x, \\mu)$. Equating the two expressions for $\\dot{y}$ gives the symmetry condition:\n$$\nf(-x, \\mu) = -f(x, \\mu)\n$$\nThis means that the function $f(x, \\mu)$ must be an odd function of $x$. The given function $f(x, \\mu) = \\mu x - x^{3}$ satisfies this condition, as $f(-x, \\mu) = \\mu(-x) - (-x)^{3} = -\\mu x + x^{3} = -(\\mu x - x^{3}) = -f(x, \\mu)$.\n\nThis symmetry has profound consequences for the bifurcation structure.\nFirst, if $x^{\\ast}$ is an equilibrium point (i.e., $f(x^{\\ast}, \\mu) = 0$), then $f(-x^{\\ast}, \\mu) = -f(x^{\\ast}, \\mu) = -0 = 0$. Thus, $-x^{\\ast}$ must also be an equilibrium point. This guarantees that any non-zero equilibria must appear in symmetric pairs $(\\pm x^{\\ast})$. The trivial equilibrium $x^{\\ast}=0$ is its own symmetric counterpart.\n\nSecond, consider a Taylor series expansion of an arbitrary odd function $f(x)$ around $x=0$:\n$$\nf(x) = c_{1}x + c_{3}x^{3} + c_{5}x^{5} + \\dots\n$$\nThe bifurcation occurs when the linear stability of the $x=0$ solution changes, which happens when the linear coefficient $c_{1}$ passes through zero. The problem's dynamics represents the simplest, or \"normal form\", model of this phenomenon by truncating the series and identifying the linear coefficient with the control parameter, i.e., $c_1 = \\mu$. The term $-x^3$ is the lowest-order odd *nonlinearity*. Its negative sign ensures that for $\\mu>0$, it counteracts the linear growth away from $x=0$, creating new stable equilibria. The fact that the first non-trivial term is of odd power (cubic) is a direct consequence of the $\\mathbb{Z}_{2}$ symmetry. This structure, where a single equilibrium branch loses stability and gives rise to a symmetric pair of new branches, is by definition a pitchfork bifurcation. The symmetric emergence of the branches is a direct consequence of the underlying $\\mathbb{Z}_{2}$ symmetry of the system.\n\n4. Construction of the Potential Function $V(x;\\mu)$\n\nThe problem asks for a scalar potential $V(x; \\mu)$ such that the dynamics can be written as a gradient flow, $\\dot{x} = -\\frac{\\partial V}{\\partial x}$.\nWe are given $\\dot{x} = \\mu x - x^{3}$. Therefore, we must solve:\n$$\n-\\frac{\\partial V}{\\partial x} = \\mu x - x^{3}\n$$\nMultiplying by $-1$, we get:\n$$\n\\frac{\\partial V}{\\partial x} = x^{3} - \\mu x\n$$\nTo find $V(x; \\mu)$, we integrate the expression on the right with respect to $x$, holding $\\mu$ constant:\n$$\nV(x; \\mu) = \\int (x^{3} - \\mu x) \\, dx = \\frac{x^{4}}{4} - \\mu \\frac{x^{2}}{2} + C(\\mu)\n$$\nwhere $C(\\mu)$ is an arbitrary integration \"constant\" that may depend on the parameter $\\mu$ but not on the state variable $x$.\nThe problem provides a condition to fix this constant: $V(0; \\mu) = 0$. We apply this condition to our general solution for $V(x; \\mu)$:\n$$\nV(0; \\mu) = \\frac{(0)^{4}}{4} - \\mu \\frac{(0)^{2}}{2} + C(\\mu) = 0\n$$\nThis implies that $C(\\mu) = 0$.\nSubstituting this back into the expression for the potential, we obtain the unique potential function satisfying the given constraints:\n$$\nV(x;\\mu) = \\frac{1}{4}x^{4} - \\frac{1}{2}\\mu x^{2}\n$$\nThe local minima of this potential correspond to the stable equilibrium points of the system, and the local maxima correspond to the unstable ones. For $\\mu  0$, $V(x)$ has a single minimum at $x=0$. For $\\mu > 0$, the origin $x=0$ becomes a local maximum, and two new symmetric minima appear at $x = \\pm\\sqrt{\\mu}$, which perfectly matches the stability analysis performed in part 2.",
            "answer": "$$\n\\boxed{\\frac{1}{4}x^{4} - \\frac{1}{2}\\mu x^{2}}\n$$"
        },
        {
            "introduction": "While some system transitions are smooth, many are abrupt and irreversible, a hallmark of tipping points. This practice explores the subcritical pitchfork bifurcation, a canonical model for such behavior where a seemingly stable state can suddenly collapse. By analyzing the dynamics of $\\dot{x} = \\mu x + x^3 - x^5$ , you will identify the parameter region where multiple stable states coexist (bistability) and trace the boundaries that create a hysteresis loop. This exercise provides direct, hands-on experience with the mathematical structures that underpin the critical concept of tipping in complex adaptive systems.",
            "id": "4115551",
            "problem": "Consider a symmetry-preserving one-dimensional ordinary differential equation (ODE) model for an aggregate order parameter in a complex adaptive system,\n$$\n\\dot{x} = \\mu x + x^{3} - x^{5},\n$$\nwhere $x$ is a scalar state measuring the net alignment of agents and $\\mu$ is a scalar control parameter representing slow exogenous forcing (e.g., stress or resource level). The system is invariant under the transformation $x \\mapsto -x$, reflecting no preferred direction of alignment.\n\nStarting from first principles appropriate for one-dimensional flows, use the definitions of equilibrium ($\\dot{x}=0$) and linear stability (sign of the derivative of the vector field at an equilibrium) to:\n- derive all equilibrium branches as functions of $\\mu$,\n- determine which branches are linearly stable,\n- identify the parameter interval in $\\mu$ over which the system exhibits coexistence of multiple linearly stable equilibria (bistability), which under slow parameter drift is associated with hysteresis and tipping.\n\nFinally, report the exact length (Lebesgue measure) of the interval in $\\mu$ over which bistability occurs. Express your final answer as an exact value with no units.",
            "solution": "The analysis proceeds by first identifying the equilibrium points of the system, then determining their linear stability.\n\nAn equilibrium point, denoted by $x^*$, is a state where the system does not change, meaning $\\dot{x} = 0$. The equilibrium condition is given by the equation:\n$$\n\\mu x + x^{3} - x^{5} = 0\n$$\nThis equation can be factored as:\n$$\nx(\\mu + x^2 - x^4) = 0\n$$\nOne immediate solution is $x_0 = 0$, which is an equilibrium for all values of the parameter $\\mu$. This branch corresponds to the trivial, unaligned state.\n\nOther equilibria are found by solving the remaining factor for zero:\n$$\nx^4 - x^2 - \\mu = 0\n$$\nThis is a quadratic equation in the variable $x^2$. Let $y = x^2$. The equation becomes:\n$$\ny^2 - y - \\mu = 0\n$$\nUsing the quadratic formula to solve for $y$:\n$$\ny = \\frac{-(-1) \\pm \\sqrt{(-1)^2 - 4(1)(-\\mu)}}{2(1)} = \\frac{1 \\pm \\sqrt{1 + 4\\mu}}{2}\n$$\nSince $y = x^2$, the solutions for $y$ must be real and non-negative for real-valued equilibria $x$ to exist. The term under the square root, $1 + 4\\mu$, must be non-negative, which imposes the constraint $\\mu \\ge -\\frac{1}{4}$.\n\nThis gives two families of solutions for $x^2$:\n1.  $x^2 = \\frac{1 + \\sqrt{1 + 4\\mu}}{2}$. The numerator is $1$ plus a non-negative term, so this expression is always positive for $\\mu \\ge -\\frac{1}{4}$. This yields two symmetric equilibrium branches, which we denote $x_{1,2}(\\mu) = \\pm\\sqrt{\\frac{1 + \\sqrt{1 + 4\\mu}}{2}}$. These branches exist for $\\mu \\ge -\\frac{1}{4}$.\n\n2.  $x^2 = \\frac{1 - \\sqrt{1 + 4\\mu}}{2}$. For $x^2$ to be non-negative, we require $1 - \\sqrt{1 + 4\\mu} \\ge 0$, which means $1 \\ge \\sqrt{1 + 4\\mu}$. Squaring both sides (which is valid as both are non-negative) gives $1 \\ge 1 + 4\\mu$, which simplifies to $4\\mu \\le 0$, or $\\mu \\le 0$. Combined with the constraint $\\mu \\ge -\\frac{1}{4}$, this family of solutions exists only for the interval $-\\frac{1}{4} \\le \\mu \\le 0$. This yields two symmetric equilibrium branches, $x_{3,4}(\\mu) = \\pm\\sqrt{\\frac{1 - \\sqrt{1 + 4\\mu}}{2}}$.\n\nNext, we determine the linear stability of these equilibrium branches. The stability of an equilibrium $x^*$ is determined by the sign of the derivative of the vector field, $f(x) = \\mu x + x^3 - x^5$, evaluated at $x^*$. An equilibrium is linearly stable if $f'(x^*)  0$ and unstable if $f'(x^*) > 0$.\nThe derivative is:\n$$\nf'(x) = \\frac{d}{dx}(\\mu x + x^3 - x^5) = \\mu + 3x^2 - 5x^4\n$$\nStability of the trivial equilibrium $x_0 = 0$:\n$$\nf'(0) = \\mu + 3(0)^2 - 5(0)^4 = \\mu\n$$\nThus, the $x_0 = 0$ equilibrium is stable for $\\mu  0$ and unstable for $\\mu > 0$. At $\\mu=0$, a bifurcation occurs.\n\nStability of the non-trivial equilibria $x^* \\neq 0$:\nFor these equilibria, we know from their definition that $\\mu + (x^*)^2 - (x^*)^4 = 0$, which implies $\\mu = (x^*)^4 - (x^*)^2$. We substitute this expression for $\\mu$ into the derivative $f'(x^*)$:\n$$\nf'(x^*) = \\mu + 3(x^*)^2 - 5(x^*)^4 = \\left((x^*)^4 - (x^*)^2\\right) + 3(x^*)^2 - 5(x^*)^4\n$$\n$$\nf'(x^*) = 2(x^*)^2 - 4(x^*)^4 = 2(x^*)^2 (1 - 2(x^*)^2)\n$$\nSince $x^* \\ne 0$, $(x^*)^2 > 0$, so the sign of $f'(x^*)$ is determined by the sign of the term $(1 - 2(x^*)^2)$.\n-   Stable if $1 - 2(x^*)^2  0 \\iff (x^*)^2 > \\frac{1}{2}$.\n-   Unstable if $1 - 2(x^*)^2 > 0 \\iff (x^*)^2  \\frac{1}{2}$.\n\nNow we apply this stability criterion to the non-trivial branches:\n1.  For branches $x_{1,2}(\\mu)$, we have $(x^*)^2 = \\frac{1 + \\sqrt{1 + 4\\mu}}{2}$. The stability condition $(x^*)^2 > \\frac{1}{2}$ becomes:\n    $$\n    \\frac{1 + \\sqrt{1 + 4\\mu}}{2} > \\frac{1}{2} \\implies 1 + \\sqrt{1 + 4\\mu} > 1 \\implies \\sqrt{1 + 4\\mu} > 0\n    $$\n    This inequality holds for $1 + 4\\mu > 0$, which is $\\mu > -\\frac{1}{4}$. At $\\mu = -\\frac{1}{4}$, $f'(x^*) = 0$, which corresponds to a saddle-node bifurcation. Thus, the branches $x_{1,2}(\\mu)$ are stable for all $\\mu > -\\frac{1}{4}$.\n\n2.  For branches $x_{3,4}(\\mu)$, we have $(x^*)^2 = \\frac{1 - \\sqrt{1 + 4\\mu}}{2}$. The stability condition is checked against $(x^*)^2 = \\frac{1}{2}$:\n    $$\n    \\frac{1 - \\sqrt{1 + 4\\mu}}{2}  \\frac{1}{2} \\implies 1 - \\sqrt{1 + 4\\mu}  1 \\implies -\\sqrt{1 + 4\\mu}  0\n    $$\n    This inequality holds whenever $\\sqrt{1 + 4\\mu}$ is positive, i.e., for $\\mu > -\\frac{1}{4}$. Since this branch exists for $-\\frac{1}{4} \\le \\mu \\le 0$, we have $(x^*)^2  \\frac{1}{2}$ for $\\mu \\in (-\\frac{1}{4}, 0]$. Therefore, the branches $x_{3,4}(\\mu)$ are unstable over their entire domain of existence, except at the bifurcation point $\\mu = -\\frac{1}{4}$.\n\nThe problem seeks the interval in $\\mu$ where bistability, associated with hysteresis, occurs. This phenomenon requires the coexistence of at least two stable equilibria. We have found the following stable equilibria:\n-   The trivial state $x_0 = 0$ is stable for $\\mu  0$.\n-   The non-trivial states $x_{1,2}(\\mu)$ are stable for $\\mu > -\\frac{1}{4}$.\n\nFor the system to exhibit bistability (in this case, tristability involving $x_0$ and the symmetric pair $x_{1,2}$), both of these conditions must be met simultaneously. The range of $\\mu$ where both the trivial state and the non-trivial states are stable is the intersection of the two intervals:\n$$\n\\{\\mu \\mid \\mu  0\\} \\cap \\{\\mu \\mid \\mu > -\\frac{1}{4}\\} = \\{\\mu \\mid -\\frac{1}{4}  \\mu  0\\}\n$$\nThis interval is $(-\\frac{1}{4}, 0)$. Within this range, the system has three stable equilibria: $x_0=0$, and the pair $x_{1,2}(\\mu)$. This multiplicity of stable states is what gives rise to hysteresis. If the parameter $\\mu$ is slowly decreased from a positive value, the system will remain on a stable $x_{1,2}$ branch until $\\mu = -\\frac{1}{4}$, at which point it must jump to the $x_0=0$ state. If $\\mu$ is slowly increased from a value less than $-\\frac{1}{4}$, the system remains at $x_0=0$ until $\\mu=0$, at which point it must jump to one of the $x_{1,2}$ branches. The region of hysteresis is bounded by the saddle-node bifurcation at $\\mu = -\\frac{1}{4}$ and the subcritical pitchfork bifurcation at $\\mu=0$.\n\nThe final task is to calculate the length (Lebesgue measure) of this interval of bistability. The interval is $I = (-\\frac{1}{4}, 0)$. The length of an interval $(a, b)$ is $b - a$.\n$$\n\\text{Length} = 0 - \\left(-\\frac{1}{4}\\right) = \\frac{1}{4}\n$$",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "A key challenge in the study of complex systems is anticipating critical transitions before they occur. This practice moves from theoretical analysis to computational application by exploring the concept of 'early warning signals.' You will work with a model of a system approaching a saddle-node bifurcation—a common tipping point—and investigate how 'critical slowing down' manifests as an increase in the lag-1 autocorrelation of the system's time series . By implementing a full numerical and statistical pipeline, you will gain hands-on experience in generating, processing, and interpreting data to forecast a critical shift, a core skill in modern complex systems science.",
            "id": "4115535",
            "problem": "Consider the stochastic differential equation for a one-dimensional state variable $x(t)$ with a slowly drifting control parameter $\\mu(t)$ and additive Gaussian white noise,\n$$\\dot{x}(t) = \\mu(t) - x(t)^2 + \\sigma \\,\\eta(t),$$\nwhere $\\eta(t)$ is standard Gaussian white noise, $\\sigma \\ge 0$ is the noise amplitude, and $\\mu(t)$ drifts linearly according to\n$$\\mu(t) = \\mu_0 + v\\,t,$$\nwith $\\mu_0 \\in \\mathbb{R}$ and $v \\in \\mathbb{R}$. The deterministic component $\\dot{x}=\\mu - x^2$ has a saddle-node bifurcation at $\\mu=0$. As $\\mu(t)$ approaches $0$ from the positive side, the system exhibits critical slowing down, which in the presence of noise often manifests as an increasing lag-$1$ autocorrelation in the time series $x(t)$. Early warning indicators for tipping points in complex adaptive systems aim to detect such trends.\n\nStarting from first principles and well-tested numerical procedures:\n- Discretize the stochastic differential equation using the Euler–Maruyama scheme. For time step $\\Delta t > 0$ and discrete times $t_n = n\\,\\Delta t$ with $n \\in \\{0,1,\\dots,N-1\\}$ and $N=\\lfloor T/\\Delta t \\rfloor$, approximate\n$$x_{n+1} = x_n + \\left(\\mu_n - x_n^2\\right)\\Delta t + \\sigma \\sqrt{\\Delta t}\\,\\xi_n,$$\nwhere $\\mu_n = \\mu_0 + v\\,t_n$ and $\\xi_n \\sim \\mathcal{N}(0,1)$ are independent and identically distributed standard normal random variables.\n- Estimate the lag-$1$ autocorrelation within moving windows of the simulated discrete-time series, after removing local linear trends. For a windowed segment $\\{x_{k}, x_{k+1},\\dots,x_{k+W-1}\\}$ of length $W$, fit a linear model $x_i \\approx a + b\\,i$ for $i \\in \\{k,\\dots,k+W-1\\}$ and compute residuals $r_i = x_i - (a + b\\,i)$. Define the sample lag-$1$ autocorrelation in that window by\n$$\\rho_1 = \\frac{\\sum_{i=k+1}^{k+W-1} \\left(r_i - \\bar{r}\\right)\\left(r_{i-1} - \\bar{r}\\right)}{\\sum_{i=k}^{k+W-1} \\left(r_i - \\bar{r}\\right)^2},$$\nwhere $\\bar{r} = \\frac{1}{W}\\sum_{i=k}^{k+W-1} r_i$.\n- Test for a statistically significant increasing trend in the sequence of windowed lag-$1$ autocorrelations using a nonparametric rank-based trend test. Specifically, compute Kendall rank correlation (Kendall $\\tau$) between window index and the corresponding $\\rho_1$ values, and declare an increasing trend if $\\tau > 0$ and the associated $p$-value is below a significance level $\\alpha$.\n\nYour task is to implement a complete program that:\n1. Simulates the time series using the Euler–Maruyama method for each parameter set in the test suite below.\n2. Computes the moving-window lag-$1$ autocorrelation of detrended residuals for each simulated time series.\n3. Applies Kendall rank correlation to test for a statistically significant increasing trend with significance level $\\alpha = 0.01$.\n4. Produces a boolean result for each test case indicating whether a significant increasing trend was detected.\n\nUse the following test suite of parameter values to ensure coverage of different scenarios. Each test case is specified as a tuple $(\\mu_0, v, \\sigma, \\Delta t, T, W, S, \\text{seed})$ with the following meanings: initial control parameter $\\mu_0$, drift rate $v$, noise amplitude $\\sigma$, time step $\\Delta t$, total simulation time $T$, window length $W$ (in number of samples), stride $S$ (in number of samples) for window advancement, and random number generator seed for reproducibility.\n\n- Test case $1$ (approaching tipping): $(\\mu_0, v, \\sigma, \\Delta t, T, W, S, \\text{seed}) = (0.5, -0.001, 0.05, 0.01, 400.0, 2000, 1000, 123)$.\n- Test case $2$ (no drift): $(\\mu_0, v, \\sigma, \\Delta t, T, W, S, \\text{seed}) = (0.5, 0.0, 0.05, 0.01, 400.0, 2000, 1000, 456)$.\n- Test case $3$ (drifting away from tipping): $(\\mu_0, v, \\sigma, \\Delta t, T, W, S, \\text{seed}) = (0.1, 0.001, 0.05, 0.01, 400.0, 2000, 1000, 789)$.\n- Test case $4$ (high noise while approaching tipping): $(\\mu_0, v, \\sigma, \\Delta t, T, W, S, \\text{seed}) = (0.5, -0.001, 0.30, 0.01, 400.0, 2000, 1000, 321)$.\n\nAlgorithmic and numerical requirements:\n- Set the initial condition $x_0 = \\sqrt{\\max(\\mu_0, 0)}$.\n- Use the specified random seeds for reproducibility.\n- When computing lag-$1$ autocorrelation in a window, if the denominator is zero, define the autocorrelation as $0$ for that window.\n- Use significance level $\\alpha = 0.01$ for the trend test.\n- Angles do not appear in this problem; no angle unit is required. No physical units are required; treat time and state variables as dimensionless.\n\nFinal output format:\n- Your program should produce a single line of output containing the boolean results for the four test cases as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4]$ where each $r_i$ is either $True$ or $False$). Produce exactly one line of output in this format and no other text.",
            "solution": "The problem requires the implementation of a numerical and statistical procedure to detect an early warning signal for a tipping point in a stochastic dynamical system. The system is described by a one-dimensional stochastic differential equation (SDE) with a slowly drifting parameter, which models a saddle-node bifurcation. The early warning signal is a statistically significant increasing trend in the lag-$1$ autocorrelation of the system's state variable, a phenomenon known as critical slowing down.\n\nThe solution is developed in three principal stages:\n1.  Numerical simulation of the SDE using the Euler–Maruyama method.\n2.  Calculation of lag-$1$ autocorrelation in moving windows on the simulated time series.\n3.  Statistical testing for a monotonic trend in the sequence of autocorrelation values using Kendall's rank correlation.\n\n**1. System Dynamics and Numerical Simulation**\n\nThe evolution of the state variable $x(t)$ is governed by the SDE:\n$$\n\\dot{x}(t) = \\mu(t) - x(t)^2 + \\sigma \\,\\eta(t)\n$$\nThe deterministic part of the dynamics, $f(x, \\mu) = \\mu - x^2$, defines the potential landscape. For a fixed $\\mu > 0$, the system has a stable equilibrium at $x = \\sqrt{\\mu}$ and an unstable equilibrium at $x = -\\sqrt{\\mu}$. As the control parameter $\\mu$ approaches the bifurcation point $\\mu_c = 0$, these equilibria merge and annihilate. For $\\mu  0$, no equilibria exist, and the system state is driven towards $-\\infty$. The parameter $\\mu(t)$ drifts linearly with time as $\\mu(t) = \\mu_0 + v\\,t$. If the drift rate $v$ is negative, the system is driven towards the tipping point. The term $\\sigma \\,\\eta(t)$ represents additive Gaussian white noise with amplitude $\\sigma$.\n\nTo simulate the system's trajectory, we discretize the SDE using the Euler–Maruyama scheme. For a time step $\\Delta t$, the state $x_{n+1}$ at time $t_{n+1} = (n+1)\\Delta t$ is approximated from the state $x_n$ at time $t_n = n\\Delta t$ as:\n$$\nx_{n+1} = x_n + (\\mu_n - x_n^2)\\Delta t + \\sigma \\sqrt{\\Delta t}\\,\\xi_n\n$$\nHere, $\\mu_n = \\mu_0 + v\\,t_n$ is the control parameter at time $t_n$, and $\\xi_n$ are independent random variables drawn from a standard normal distribution, $\\mathcal{N}(0,1)$. The simulation starts from the initial condition $x_0 = \\sqrt{\\max(\\mu_0, 0)}$, which places the system at the stable equilibrium at $t=0$ if one exists. A full time series $\\{x_0, x_1, \\dots, x_{N-1}\\}$ is generated, where $N = \\lfloor T/\\Delta t \\rfloor$.\n\n**2. Moving Window Autocorrelation Analysis**\n\nAs the system approaches the bifurcation point $\\mu=0$ from above, the basin of attraction around the stable equilibrium $x = \\sqrt{\\mu}$ flattens. This leads to a phenomenon called critical slowing down, where the system's return time to equilibrium after a small perturbation diverges. In a stochastic system, this manifests as an increase in temporal correlation, as the influence of past states on the current state persists for longer.\n\nTo detect this change, we analyze the time series $\\{x_n\\}$ using a moving window approach. The series is divided into overlapping segments of length $W$ samples. These windows advance along the time series with a stride of $S$ samples. For each window, we compute the lag-$1$ autocorrelation, $\\rho_1$.\n\nA crucial preliminary step within each window is detrending. The drifting parameter $\\mu(t)$ makes the time series non-stationary, which can itself induce spurious correlations. To isolate the correlation arising from the intrinsic dynamics, we remove a local linear trend from the data in each window. For a segment $\\{x_k, \\dots, x_{k+W-1}\\}$, we perform an ordinary least squares fit to find coefficients $a$ and $b$ for the model $x_i \\approx a + b\\,i$ where $i \\in \\{k, \\dots, k+W-1\\}$. The analysis then proceeds with the residuals, $r_i = x_i - (a + b\\,i)$.\n\nThe sample lag-$1$ autocorrelation $\\rho_1$ for the window is then calculated from these residuals using the specified formula:\n$$\n\\rho_1 = \\frac{\\sum_{i=k+1}^{k+W-1} (r_i - \\bar{r})(r_{i-1} - \\bar{r})}{\\sum_{i=k}^{k+W-1} (r_i - \\bar{r})^2}\n$$\nwhere $\\bar{r}$ is the mean of the residuals in the window, $\\bar{r} = \\frac{1}{W}\\sum_{i=k}^{k+W-1} r_i$. This calculation yields a sequence of $\\rho_1$ values, one for each window.\n\n**3. Statistical Trend Detection**\n\nThe final step is to determine if the sequence of computed $\\rho_1$ values exhibits a statistically significant increasing trend, which would serve as the early warning signal. For this, we use the Kendall rank correlation test, a non-parametric method that assesses the strength of the monotonic relationship between two variables. Here, the variables are the window index (an ordinal representing time) and the corresponding $\\rho_1$ value.\n\nThe test computes the Kendall's $\\tau$ statistic, which ranges from $-1$ (perfectly decreasing trend) to $+1$ (perfectly increasing trend), and an associated $p$-value. The $p$-value represents the probability of observing a trend at least as strong as the one measured, under the null hypothesis of no trend.\n\nAccording to the problem's criteria, an early warning signal is detected if and only if both conditions are met:\n1.  The correlation coefficient $\\tau > 0$, indicating a positive (increasing) trend.\n2.  The $p$-value is less than the specified significance level, $p  \\alpha$, where $\\alpha = 0.01$. This indicates that the observed increasing trend is statistically significant.\n\nThis complete procedure is applied to each test case, yielding a boolean outcome indicating whether a significant trend was detected.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import kendalltau\n\ndef solve():\n    \"\"\"\n    Implements the full pipeline to detect early warning signals for tipping points\n    in a stochastic dynamical system, based on the problem specification.\n    \"\"\"\n    # Test cases: (mu0, v, sigma, dt, T, W, S, seed)\n    test_cases = [\n        (0.5, -0.001, 0.05, 0.01, 400.0, 2000, 1000, 123),\n        (0.5, 0.0, 0.05, 0.01, 400.0, 2000, 1000, 456),\n        (0.1, 0.001, 0.05, 0.01, 400.0, 2000, 1000, 789),\n        (0.5, -0.001, 0.30, 0.01, 400.0, 2000, 1000, 321),\n    ]\n\n    results = []\n    alpha = 0.01\n\n    for case in test_cases:\n        mu0, v, sigma, dt, T, W, S, seed = case\n\n        # --- 1. SDE Simulation (Euler-Maruyama) ---\n        rng = np.random.default_rng(seed)\n        t = np.arange(0, T, dt)\n        N = len(t)\n        mu = mu0 + v * t\n        \n        x = np.zeros(N)\n        x[0] = np.sqrt(max(mu0, 0.0))\n        \n        # Generate all random numbers at once for efficiency\n        xi = rng.standard_normal(N - 1)\n        \n        sqrt_dt = np.sqrt(dt)\n        for n in range(N - 1):\n            drift_term = (mu[n] - x[n]**2) * dt\n            diffusion_term = sigma * sqrt_dt * xi[n]\n            x[n+1] = x[n] + drift_term + diffusion_term\n\n        # --- 2. Moving Window Autocorrelation ---\n        autocorrelations = []\n        window_starts = np.arange(0, N - W + 1, S)\n        window_indices = np.arange(W)\n\n        for k in window_starts:\n            x_window = x[k : k + W]\n            \n            # Detrending: fit a linear model x_i ~ a + b*i\n            # np.polyfit returns [slope, intercept] for degree 1\n            slope, intercept = np.polyfit(window_indices, x_window, 1)\n            trend = slope * window_indices + intercept\n            residuals = x_window - trend\n            \n            # Calculate lag-1 autocorrelation from residuals\n            r_mean = np.mean(residuals)\n            centered_residuals = residuals - r_mean\n            \n            # Sum of squared centered residuals (denominator)\n            denominator = np.sum(centered_residuals**2)\n            \n            rho_1 = 0.0\n            if denominator > 0:\n                # Sum of products of lagged centered residuals (numerator)\n                numerator = np.sum(centered_residuals[1:] * centered_residuals[:-1])\n                rho_1 = numerator / denominator\n            \n            autocorrelations.append(rho_1)\n\n        # --- 3. Trend Detection (Kendall's Tau) ---\n        # Ensure there are enough points for a meaningful trend test\n        if len(autocorrelations)  3:\n             is_significant_trend = False\n        else:\n            tau, p_value = kendalltau(\n                np.arange(len(autocorrelations)), \n                autocorrelations\n            )\n            \n            # A significant increasing trend is detected if tau > 0 and p  alpha\n            is_significant_trend = (tau > 0) and (p_value  alpha)\n        \n        results.append(is_significant_trend)\n\n    # Final output formatting\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}