{
    "hands_on_practices": [
        {
            "introduction": "要理解图灵斑图的形成，第一步是分析在没有扩散的情况下系统的稳定性。这是一个至关重要的前提：均匀定态本身必须是稳定的，这样由扩散驱动的不稳定性才能名副其实地发生。本练习将引导你使用线性稳定性分析，推导这种基准稳定性的条件，这是掌握图灵理论的核心分析技能。",
            "id": "4139227",
            "problem": "考虑一个在有界域上的双物种反应扩散系统，其边界条件为无通量（诺伊曼）边界条件，状态变量为 $u(x,t)$ 和 $v(x,t)$，反应动力学由 $f(u,v) = a - u + u^2 v$ 和 $g(u,v) = b - u^2 v$ 给出，其中 $a>0$ 和 $b>0$ 是表示进料速率的参数。在纯反应极限下（即忽略空间扩散），空间均匀动力学由自治系统 $\\dot{u} = f(u,v)$ 和 $\\dot{v} = g(u,v)$ 描述。\n\n从均匀稳态 $(u^*,v^*)$ 作为 $f(u^*,v^*) = 0$ 和 $g(u^*,v^*) = 0$ 的解的定义出发，并根据二维自治系统的线性化原理——该原理通过在 $(u^*,v^*)$ 处求值的雅可比矩阵 $J = \\begin{pmatrix} f_u & f_v \\\\ g_u & g_v \\end{pmatrix}$ 来评估局部稳定性——推导 $(u^*,v^*)$ 的表达式、在 $(u^*,v^*)$ 处的雅可比矩阵各项 $f_u$、$f_v$、$g_u$、$g_v$，并计算在 $(u^*,v^*)$ 处的迹 $\\operatorname{tr} J$ 和行列式 $\\det J$。使用“二维线性系统在 $\\operatorname{tr} J < 0$ 且 $\\det J > 0$ 时是局部渐近稳定的”这一判据，用 $a$ 和 $b$ 来解释纯反应稳定性条件。\n\n你的最终答案必须是关于 $a$ 和 $b$ 的闭式解析表达式的有序元组 $(u^*, v^*, f_u, f_v, g_u, g_v, \\operatorname{tr} J, \\det J)$。不需要数值计算，也不需要单位。将最终元组表示为单行矩阵。",
            "solution": "我们从由 $\\dot{u} = f(u,v)$ 和 $\\dot{v} = g(u,v)$ 定义的纯反应动力学开始，其中 $f(u,v) = a - u + u^2 v$ 且 $g(u,v) = b - u^2 v$。一个均匀稳态 $(u^*, v^*)$ 满足方程组\n$$\nf(u^*, v^*) = a - u^* + (u^*)^2 v^* = 0, \\quad g(u^*, v^*) = b - (u^*)^2 v^* = 0.\n$$\n从 $g(u^*, v^*) = 0$，我们得到\n$$\n(u^*)^2 v^* = b \\quad \\Rightarrow \\quad v^* = \\frac{b}{(u^*)^2}, \\quad \\text{with } u^* \\neq 0.\n$$\n将 $v^*$ 的这个表达式代入 $f(u^*, v^*) = 0$ 得到\n$$\na - u^* + (u^*)^2 \\left( \\frac{b}{(u^*)^2} \\right) = a - u^* + b = 0 \\quad \\Rightarrow \\quad u^* = a + b.\n$$\n因此，\n$$\nv^* = \\frac{b}{(a+b)^2}.\n$$\n\n接下来，我们计算雅可比矩阵的各项。根据定义，\n$$\nf_u = \\frac{\\partial f}{\\partial u} = -1 + 2 u v, \\quad f_v = \\frac{\\partial f}{\\partial v} = u^2,\n$$\n$$\ng_u = \\frac{\\partial g}{\\partial u} = -2 u v, \\quad g_v = \\frac{\\partial g}{\\partial v} = -u^2.\n$$\n在 $(u^*, v^*) = (a+b, \\frac{b}{(a+b)^2})$ 处计算这些值，得到\n$$\nf_u(u^*, v^*) = -1 + 2 (a+b) \\cdot \\frac{b}{(a+b)^2} = -1 + \\frac{2 b}{a+b} = \\frac{b - a}{a + b},\n$$\n$$\nf_v(u^*, v^*) = (a+b)^2,\n$$\n$$\ng_u(u^*, v^*) = -2 (a+b) \\cdot \\frac{b}{(a+b)^2} = - \\frac{2 b}{a+b},\n$$\n$$\ng_v(u^*, v^*) = - (a+b)^2.\n$$\n\n在稳态处的雅可比矩阵的迹和行列式为\n$$\n\\operatorname{tr} J = f_u + g_v = \\frac{b - a}{a + b} - (a+b)^2,\n$$\n$$\n\\det J = f_u g_v - f_v g_u.\n$$\n显式计算 $\\det J$：\n$$\nf_u g_v = \\left( \\frac{b - a}{a + b} \\right) \\left( - (a+b)^2 \\right) = - (b - a)(a+b),\n$$\n$$\nf_v g_u = (a+b)^2 \\left( - \\frac{2 b}{a + b} \\right) = - 2 b (a+b),\n$$\n所以\n$$\n\\det J = f_u g_v - f_v g_u = \\left[ - (b - a)(a+b) \\right] - \\left[ - 2 b (a+b) \\right] = (a+b) \\left( - (b - a) + 2 b \\right) = (a+b) (a+b) = (a+b)^2.\n$$\n\n对于二维空间中的纯反应线性稳定性，其判据是 $J$ 的特征值的实部为负，当且仅当 $\\operatorname{tr} J < 0$ 且 $\\det J > 0$。对于所有 $a>0$ 和 $b>0$，我们有 $\\det J = (a+b)^2 > 0$。迹为\n$$\n\\operatorname{tr} J = \\frac{b - a}{a + b} - (a+b)^2,\n$$\n它为负的条件恰好是\n$$\n\\frac{b - a}{a + b} < (a+b)^2 \\quad \\Leftrightarrow \\quad b - a < (a+b)^3.\n$$\n因此，只要 $b - a < (a+b)^3$（其中 $a>0$, $b>0$），纯反应稳态就是局部渐近稳定的，否则不稳定。这就建立了必要的表达式并验证了稳定性。\n\n汇总所求的表达式，有序元组为\n$$\n\\left( u^*, v^*, f_u, f_v, g_u, g_v, \\operatorname{tr} J, \\det J \\right) = \\left( a + b, \\frac{b}{(a+b)^2}, \\frac{b - a}{a + b}, (a+b)^2, - \\frac{2 b}{a + b}, - (a+b)^2, \\frac{b - a}{a + b} - (a+b)^2, (a+b)^2 \\right).\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} a + b & \\dfrac{b}{(a+b)^{2}} & \\dfrac{b - a}{a + b} & (a+b)^{2} & - \\dfrac{2 b}{a + b} & - (a+b)^{2} & \\dfrac{b - a}{a + b} - (a+b)^{2} & (a+b)^{2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在局部稳定性分析之后，我们需要将视角扩展到有限系统的全局背景中。即使反应动力学和扩散速率满足不稳定性条件，斑图也只有在系统尺寸足以容纳其特征波长时才能形成。 中我们关注了局部动力学，而本练习  将探讨不同的边界条件（诺伊曼边界条件与周期性边界条件）如何改变形成斑图所需的最小系统尺寸，从而揭示内在尺度与外在约束之间的相互作用。",
            "id": "1508455",
            "problem": "考虑一个定义在长度为 $L$ 的空间域上的一维反应扩散系统，称为 Brusselator。两种化学物质的浓度 $u(x, t)$ 和 $v(x, t)$ 的动力学由以下无量纲偏微分方程描述：\n$$ \\frac{\\partial u}{\\partial t} = A - (B+1)u + u^2 v + D_u \\frac{\\partial^2 u}{\\partial x^2} $$\n$$ \\frac{\\partial v}{\\partial t} = B u - u^2 v + D_v \\frac{\\partial^2 v}{\\partial x^2} $$\n参数 $A$、$B$、$D_u$ 和 $D_v$ 是正常数。这些参数值的选择使得系统的空间均匀稳态对均匀扰动是稳定的，但对某些空间变化的扰动是不稳定的，这种情况被称为图灵不稳定性。只要系统尺寸 $L$ 足够大以支持不稳定的空间模态，这种不稳定性就会导致静态空间模式的自发形成。\n\n您的任务是比较在两种不同边界条件下模式形成的起始：\n1. 零通量（Neumann）边界条件：在区域的两端 $\\frac{\\partial u}{\\partial x} = \\frac{\\partial v}{\\partial x} = 0$。\n2. 周期性边界条件：$u(0, t) = u(L, t)$ 和 $v(0, t) = v(L, t)$，同时它们的空间导数在边界处也相等。\n\n计算在零通量条件下模式形成所需的最小系统长度 $L_{\\min, N}$ 与在周期性条件下所需最小长度 $L_{\\min, P}$ 的比值。请将您的答案表示为一个实数。",
            "solution": "我们从 Brusselator 反应扩散系统开始：\n$$\n\\frac{\\partial u}{\\partial t} = A - (B+1)u + u^{2} v + D_{u} \\frac{\\partial^{2} u}{\\partial x^{2}}, \\quad\n\\frac{\\partial v}{\\partial t} = B u - u^{2} v + D_{v} \\frac{\\partial^{2} v}{\\partial x^{2}}.\n$$\n空间均匀稳态对均匀扰动是稳定的，但对某些空间变化的扰动是不稳定的（图灵不稳定性）。令 $(u_{s}, v_{s})$ 表示均匀稳态；对于 Brusselator，有 $u_{s} = A$ 和 $v_{s} = B/A$，但这些具体值不会影响下面推导出的依赖于边界条件的长度尺度。\n\n通过写出 $u(x,t) = u_{s} + \\delta u(x,t)$ 和 $v(x,t) = v_{s} + \\delta v(x,t)$，在 $(u_{s}, v_{s})$ 附近进行线性化。线性化系统可以写成向量形式：\n$$\n\\frac{\\partial}{\\partial t} \\begin{pmatrix} \\delta u \\\\ \\delta v \\end{pmatrix}\n= J \\begin{pmatrix} \\delta u \\\\ \\delta v \\end{pmatrix} + D \\frac{\\partial^{2}}{\\partial x^{2}} \\begin{pmatrix} \\delta u \\\\ \\delta v \\end{pmatrix},\n$$\n其中 $J$ 是反应项在 $(u_{s}, v_{s})$ 处求值的雅可比矩阵，而 $D = \\operatorname{diag}(D_{u}, D_{v})$。寻找形如下式的简正模：\n$$\n\\begin{pmatrix} \\delta u \\\\ \\delta v \\end{pmatrix} = \\boldsymbol{\\phi}(x) \\exp(\\sigma t),\n$$\n其中 $\\boldsymbol{\\phi}(x)$ 满足相应的边界条件和亥姆霍兹方程 $\\partial_{xx} \\boldsymbol{\\phi} = -k^{2} \\boldsymbol{\\phi}$，因此时间增长率 $\\sigma$ 由矩阵 $J - k^{2} D$ 的特征值给出。图灵不稳定性意味着存在一个波数带 $(k_{-}, k_{+})$（其中 $k_{-} > 0$），对于 $k \\in (k_{-}, k_{+})$，矩阵 $J - k^{2} D$ 特征值的最大实部为正，而均匀模态 $k = 0$ 是稳定的。\n\n在长度为 $L$ 的有限区域上，容许的波数 $k$ 由边界条件进行量子化：\n- 对于零通量（Neumann）边界条件，特征函数是余弦函数，得到\n$$\nk_{n}^{(N)} = \\frac{n \\pi}{L}, \\quad n \\in \\mathbb{N}_{0}.\n$$\n最小的非零波数是 $k_{1}^{(N)} = \\pi/L$。\n- 对于周期性边界条件，特征函数是周期为 $L$ 的指数函数，得到\n$$\nk_{n}^{(P)} = \\frac{2 \\pi n}{L}, \\quad n \\in \\mathbb{Z}.\n$$\n最小的非零波数大小是 $k_{1}^{(P)} = 2\\pi/L$。\n\n模式形成要求至少有一个容许的非零波数位于不稳定的波数带 $(k_{-}, k_{+})$ 内。当最小的非零容许波数等于不稳定带的下边界 $k_{-}$ 时，获得最小区域长度。因此：\n- 在 Neumann 条件下：\n$$\n\\frac{\\pi}{L_{\\min, N}} = k_{-} \\quad \\Rightarrow \\quad L_{\\min, N} = \\frac{\\pi}{k_{-}}.\n$$\n- 在周期性条件下：\n$$\n\\frac{2 \\pi}{L_{\\min, P}} = k_{-} \\quad \\Rightarrow \\quad L_{\\min, P} = \\frac{2 \\pi}{k_{-}}.\n$$\n\n因此，所需的比值为\n$$\n\\frac{L_{\\min, N}}{L_{\\min, P}} = \\frac{\\frac{\\pi}{k_{-}}}{\\frac{2 \\pi}{k_{-}}} = \\frac{1}{2}.\n$$\n这个比值与具体的动力学参数无关，仅取决于边界条件所施加的波数量子化。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "最后的实践将分析条件与计算探索相结合，综合我们之前学到的知识。一套完整的图灵条件在系统的参数空间中定义了一个特定的区域，称为“图灵空间”。这项综合性练习将指导你推导这些条件，并编写一个程序来数值化地描绘出这个空间。这项任务与研究人员在探索新模型中斑图形成潜力的实际工作流程非常相似。",
            "id": "4139254",
            "problem": "您需要设计并实现一个完整的程序，该程序识别一个三参数域的子集，在该子集中，一个双物种反应扩散（RD）系统表现出图灵不稳定性。该反应扩散系统必须使用 Schnakenberg 动力学作为其底层反应机理进行建模。从第一性原理出发，对反应扩散系统应用线性稳定性分析（LSA），推导出定义以下两个条件的精确不等式：(i) 均一不动点的纯反应稳定性，以及 (ii) 对于某个非零空间模式的扩散驱动不稳定性。然后，您的程序必须在参数空间中的一个矩形网格上评估这些不等式，并计算同时满足这两个条件的网格点数量。\n\n使用的基本建模假设：\n- 一维空间域上两种相互作用的物种 $u(x,t)$ 和 $v(x,t)$ 的反应扩散系统由以下偏微分方程（PDE）组给出\n$$\n\\frac{\\partial u}{\\partial t} = f(u,v) + D_u \\frac{\\partial^2 u}{\\partial x^2}, \\quad\n\\frac{\\partial v}{\\partial t} = g(u,v) + D_v \\frac{\\partial^2 v}{\\partial x^2},\n$$\n其中 $f(u,v)$ 和 $g(u,v)$ 是反应动力学项，$D_u$ 和 $D_v$ 是扩散系数。\n- Schnakenberg 反应动力学为\n$$\nf(u,v) = a - u + u^2 v, \\quad g(u,v) = b - u^2 v,\n$$\n其中参数 $a$ 和 $b$ 为正。\n- 取 $D_u = 1$ 和 $D_v = \\delta$，其中 $\\delta > 0$ 是待探索的扩散比参数。\n- 均一不动点 $(u^\\ast, v^\\ast)$ 满足 $f(u^\\ast, v^\\ast) = 0$ 和 $g(u^\\ast, v^\\ast) = 0$。\n\n任务要求：\n1. 从反应扩散偏微分方程和 Schnakenberg 动力学出发，围绕均一不动点进行线性稳定性分析（LSA），推导出在 $(u^\\ast, v^\\ast)$ 处评估的反应部分的雅可比矩阵 $J$，及其迹 $\\operatorname{tr}(J)$ 和行列式 $\\det(J)$（用 $a$ 和 $b$ 表示）。\n2. 推导波数为 $k$ 的扰动的色散关系，将增长率的相应二次方程表示为 $q = k^2$ 的函数，并确定保证以下条件的条件：\n   - 纯反应稳定性：在没有扩散的情况下，均一不动点是线性稳定的。\n   - 扩散驱动不稳定性：存在一个严格为正的 $q$，使得最大增长率为正，而纯反应系统保持稳定。\n3. 将这些条件实现为不等式，以便在 $(a,b,\\delta)$ 参数空间的每个网格点上进行数值检验。\n\n您的程序必须：\n- 为每个测试用例，在指定的范围内为 $a$、$b$ 和 $\\delta$ 构建均匀间隔的网格。\n- 对于每个网格点 $(a,b,\\delta)$，计算 Schnakenberg 不动点处的雅可比矩阵元素，评估纯反应稳定性和扩散驱动不稳定性不等式，并计算同时满足这两组条件的点数。\n- 使用带有小的数值公差 $10^{-12}$ 的严格不等式，以避免在精确相等时出现分类模糊。\n- 最终输出为单行，其中包含一个用方括号括起来的逗号分隔列表，列表内容是每个测试用例的整数计数，按下列顺序列出。\n\n测试套件规范：\n- 在所有情况下，将网格端点视为包含在内，并在每个轴上使用均匀间隔的样本点。\n- 情况 1：$a \\in [0.05, 2.50]$，21个点；$b \\in [0.05, 2.50]$，21个点；$\\delta \\in [5.0, 50.0]$，21个点。\n- 情况 2（小扩散比的边界情况）：$a \\in [0.05, 2.50]$，21个点；$b \\in [0.05, 2.50]$，21个点；$\\delta \\in [1.0, 2.0]$，21个点。\n- 情况 3（接近典型图灵设置的窄范围）：$a \\in [0.05, 0.35]$，21个点；$b \\in [1.00, 1.80]$，21个点；$\\delta \\in [8.0, 25.0]$，21个点。\n- 情况 4（大扩散比）：$a \\in [0.10, 1.00]$，21个点；$b \\in [0.10, 1.00]$，21个点；$\\delta \\in [50.0, 200.0]$，21个点。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[n_1,n_2,n_3,n_4]$，其中 $n_i$ 是在测试用例 $i$ 中同时满足纯反应稳定性和扩散驱动不稳定性的网格点整数计数。\n- 不得打印任何其他文本。\n- 所有参数都是无量纲的；不需要物理单位。",
            "solution": "用户提供了一个科学上合理、定义明确且客观的问题，该问题经证实是可解的。以下解决方案遵循指定的建模假设和任务要求。\n\n### **1. 问题公式化与不动点分析**\n\n该问题涉及一个一维域上的双物种反应扩散（RD）系统，由以下偏微分方程（PDE）描述：\n$$\n\\frac{\\partial u}{\\partial t} = f(u,v) + D_u \\frac{\\partial^2 u}{\\partial x^2}\n$$\n$$\n\\frac{\\partial v}{\\partial t} = g(u,v) + D_v \\frac{\\partial^2 v}{\\partial x^2}\n$$\n其中 $u(x,t)$ 和 $v(x,t)$ 是两种物种的浓度。反应动力学由 Schnakenberg 模型给出：\n$$\nf(u,v) = a - u + u^2 v\n$$\n$$\ng(u,v) = b - u^2 v\n$$\n参数 $a$ 和 $b$ 是正常数。扩散系数为 $D_u = 1$ 和 $D_v = \\delta$。\n\n一个均一不动点，记为 $(u^\\ast, v^\\ast)$，是一个空间均匀的稳态解，其中反应项为零：\n$$\nf(u^\\ast, v^\\ast) = a - u^\\ast + (u^\\ast)^2 v^\\ast = 0\n$$\n$$\ng(u^\\ast, v^\\ast) = b - (u^\\ast)^2 v^\\ast = 0\n$$\n从第二个方程，我们得到 $(u^\\ast)^2 v^\\ast = b$。将其代入第一个方程，得到：\n$$\na - u^\\ast + b = 0 \\implies u^\\ast = a + b\n$$\n将 $u^\\ast$ 代回以求得 $v^\\ast$：\n$$\n(a+b)^2 v^\\ast = b \\implies v^\\ast = \\frac{b}{(a+b)^2}\n$$\n由于问题参数 $a$ 和 $b$ 为正，不动点浓度 $(u^\\ast, v^\\ast)$ 也为正。\n\n### **2. 纯反应系统的线性稳定性分析**\n\n为了分析在没有扩散（$D_u=D_v=0$）情况下不动点的稳定性，我们在 $(u^\\ast, v^\\ast)$ 周围对反应系统进行线性化。稳定性由反应动力学在不动点处评估的雅可比矩阵 $J$ 的特征值决定。\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f}{\\partial u} & \\frac{\\partial f}{\\partial v} \\\\ \\frac{\\partial g}{\\partial u} & \\frac{\\partial g}{\\partial v} \\end{pmatrix}_{(u^\\ast, v^\\ast)}\n$$\n偏导数是：\n$$\n\\frac{\\partial f}{\\partial u} = -1 + 2uv, \\quad \\frac{\\partial f}{\\partial v} = u^2\n$$\n$$\n\\frac{\\partial g}{\\partial u} = -2uv, \\quad \\frac{\\partial g}{\\partial v} = -u^2\n$$\n在不动点处，我们有 $u^\\ast = a+b$ 和 $u^\\ast v^\\ast = \\frac{b}{a+b}$。代入这些值：\n$$\nJ = \\begin{pmatrix}\n-1 + 2\\frac{b}{a+b} & (a+b)^2 \\\\\n-2\\frac{b}{a+b} & -(a+b)^2\n\\end{pmatrix}\n= \\begin{pmatrix}\n\\frac{b-a}{a+b} & (a+b)^2 \\\\\n\\frac{-2b}{a+b} & -(a+b)^2\n\\end{pmatrix}\n$$\n不动点的稳定性取决于 $J$ 的特征值，它们是特征方程 $\\lambda^2 - \\operatorname{tr}(J)\\lambda + \\det(J) = 0$ 的根。对于一个稳定的不动点（在二维系统中），两个特征值的实部都必须为负。这当且仅当 $\\operatorname{tr}(J) < 0$ 和 $\\det(J) > 0$ 时得到保证。\n\n$J$ 的迹为：\n$$\n\\operatorname{tr}(J) = \\left(\\frac{b-a}{a+b}\\right) - (a+b)^2\n$$\n$J$ 的行列式为：\n$$\n\\det(J) = \\left(\\frac{b-a}{a+b}\\right)\\left(-(a+b)^2\\right) - \\left((a+b)^2\\right)\\left(\\frac{-2b}{a+b}\\right) = -(b-a)(a+b) + 2b(a+b) = (a-b+2b)(a+b) = (a+b)^2\n$$\n因此，纯反应稳定性的条件是：\n\\begin{enumerate}\n    \\item $\\operatorname{tr}(J) = \\frac{b-a}{a+b} - (a+b)^2 < 0$\n    \\item $\\det(J) = (a+b)^2 > 0$，对于 $a, b > 0$ 总是满足。\n\\end{enumerate}\n因此，纯反应稳定性由单个不等式 $\\operatorname{tr}(J) < 0$ 决定。\n\n### **3. 完整反应扩散系统的线性稳定性分析**\n\n现在我们考虑包含扩散的完整反应扩散系统。我们分析均一不动点相对于以下形式的微小空间变化扰动的稳定性：\n$$\n\\begin{pmatrix} u(x,t) \\\\ v(x,t) \\end{pmatrix} = \\begin{pmatrix} u^\\ast \\\\ v^\\ast \\end{pmatrix} + \\begin{pmatrix} \\hat{u} \\\\ \\hat{v} \\end{pmatrix} e^{\\lambda_k t + ikx}\n$$\n其中 $k$ 是空间波数，$\\lambda_k$ 是对应的增长率。将此代入线性化的反应扩散系统，得到关于 $\\lambda_k$ 的特征值问题：\n$$\n\\lambda_k \\begin{pmatrix} \\hat{u} \\\\ \\hat{v} \\end{pmatrix} = \\left( J - k^2 D \\right) \\begin{pmatrix} \\hat{u} \\\\ \\hat{v} \\end{pmatrix}\n$$\n其中 $D = \\text{diag}(D_u, D_v) = \\text{diag}(1, \\delta)$。增长率 $\\lambda_k$ 是矩阵 $M_k = J - k^2 D$ 的一个特征值。$M_k$ 的特征值是特征方程 $\\lambda_k^2 - \\operatorname{tr}(M_k)\\lambda_k + \\det(M_k) = 0$ 的根。\n\n如果纯反应系统是稳定的（即，对于 $k=0$，$\\operatorname{Re}(\\lambda_k) < 0$），但对于某个非零波数 $k \\neq 0$，完整的反应扩散系统是不稳定的（即，对于某个 $k \\neq 0$，$\\operatorname{Re}(\\lambda_k) > 0$），则发生图灵不稳定性（或扩散驱动不稳定性）。\n\n$M_k$ 的迹和行列式为：\n$$\n\\operatorname{tr}(M_k) = \\operatorname{tr}(J) - k^2(D_u + D_v) = \\operatorname{tr}(J) - k^2(1+\\delta)\n$$\n$$\n\\det(M_k) = \\det(J - k^2 D) = \\det(J) - k^2(D_u J_{22} + D_v J_{11}) + k^4 D_u D_v\n$$\n由于纯反应稳定性要求 $\\operatorname{tr}(J) < 0$，且对于 $k \\ne 0$ 有 $k^2(1+\\delta) > 0$，因此对于所有的 $k$ 都有 $\\operatorname{tr}(M_k) < 0$。在二维系统中，如果迹为负，那么不稳定性（特征值存在正实部）只可能在行列式为负时发生。\n因此，图灵不稳定性的条件是对于某个 $k \\neq 0$ 有 $\\det(M_k) < 0$。\n\n设 $q=k^2 > 0$。条件变为存在一个 $q > 0$，使得以下函数为负：\n$$\nH(q) = \\det(M_k) = D_u D_v q^2 - (D_u J_{22} + D_v J_{11})q + \\det(J) < 0\n$$\n$H(q)$ 是一个关于 $q$ 的开口向上的抛物线。在 $q=0$ 处，我们有 $H(0) = \\det(J)$。根据纯反应稳定性的要求，$\\det(J) > 0$，所以抛物线从水平轴上方开始。要使抛物线在某个 $q>0$ 处降到轴下方，其最小值必须在正值 $q_{\\min} > 0$ 处取得，并且此最小值 $H(q_{\\min})$ 必须为负。\n\n1.  $H(q)$ 的最小值在 $q_{\\min} = \\frac{D_u J_{22} + D_v J_{11}}{2 D_u D_v}$ 处取得。条件 $q_{\\min} > 0$ 意味着：\n    $$D_u J_{22} + D_v J_{11} > 0$$\n    代入 $D_u=1$, $D_v=\\delta$ 和雅可比矩阵元素：\n    $$(1)(-(a+b)^2) + (\\delta)\\left(\\frac{b-a}{a+b}\\right) > 0 \\implies \\delta\\left(\\frac{b-a}{a+b}\\right) > (a+b)^2$$\n\n2.  最小值 $H(q_{\\min})$ 必须为负。这要求二次函数 $H(q)$ 的判别式为正：\n    $$(D_u J_{22} + D_v J_{11})^2 - 4(D_u D_v)(\\det(J)) > 0$$\n    代入已知项：\n    $$\\left(-(a+b)^2 + \\delta\\left(\\frac{b-a}{a+b}\\right)\\right)^2 - 4(1)(\\delta)((a+b)^2) > 0$$\n    $$\\left(\\delta\\left(\\frac{b-a}{a+b}\\right) - (a+b)^2\\right)^2 > 4 \\delta (a+b)^2$$\n\n### **4. 数值实现条件总结**\n\n为了找到出现图灵不稳定性的参数空间 $(a, b, \\delta)$，我们必须同时满足纯反应稳定性的条件和扩散驱动不稳定性的条件。这导致在参数网格的每个点上需要检查以下不等式组，使用一个小的数值公差 $\\epsilon=10^{-12}$：\n\n1.  **纯反应稳定性**：$\\operatorname{tr}(J) < 0$\n    $$ \\frac{b-a}{a+b} - (a+b)^2 < -\\epsilon $$\n\n2.  **扩散驱动不稳定性**：\n    a) $(D_u J_{22} + D_v J_{11}) > 0$\n    $$ \\delta\\left(\\frac{b-a}{a+b}\\right) - (a+b)^2 > \\epsilon $$\n    b) $(D_u J_{22} + D_v J_{11})^2 > 4 D_u D_v \\det(J)$\n    $$ \\left(\\delta\\left(\\frac{b-a}{a+b}\\right) - (a+b)^2\\right)^2 > 4\\delta(a+b)^2 + \\epsilon $$\n\n程序将遍历 $(a, b, \\delta)$ 值的网格，并计算满足所有这三个严格不等式的点的数量。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Identifies the Turing instability domain for the Schnakenberg reaction-diffusion system.\n\n    This function iterates through a set of test cases, each defining a 3D parameter grid\n    for (a, b, delta). For each point in the grid, it evaluates the conditions for\n    Turing instability derived from Linear Stability Analysis (LSA):\n    1. Reaction-only stability of the homogeneous fixed point.\n    2. Diffusion-driven instability for a non-zero spatial mode.\n\n    The number of grid points satisfying these conditions is counted for each test case.\n    The final output is a comma-separated list of these counts.\n    \"\"\"\n\n    test_cases = [\n        # Case 1\n        {'a_range': (0.05, 2.50), 'b_range': (0.05, 2.50), 'delta_range': (5.0, 50.0), 'points': 21},\n        # Case 2\n        {'a_range': (0.05, 2.50), 'b_range': (0.05, 2.50), 'delta_range': (1.0, 2.0), 'points': 21},\n        # Case 3\n        {'a_range': (0.05, 0.35), 'b_range': (1.00, 1.80), 'delta_range': (8.0, 25.0), 'points': 21},\n        # Case 4\n        {'a_range': (0.10, 1.00), 'b_range': (0.10, 1.00), 'delta_range': (50.0, 200.0), 'points': 21}\n    ]\n\n    results = []\n    tol = 1.0e-12\n\n    for case in test_cases:\n        # Construct evenly spaced grids for parameters a, b, and delta.\n        # The endpoints are inclusive, as is the default for np.linspace.\n        a_vals = np.linspace(case['a_range'][0], case['a_range'][1], case['points'])\n        b_vals = np.linspace(case['b_range'][0], case['b_range'][1], case['points'])\n        delta_vals = np.linspace(case['delta_range'][0], case['delta_range'][1], case['points'])\n\n        # Use np.meshgrid to create 3D arrays for vectorized computation.\n        # 'ij' indexing ensures the array dimensions correspond to the iteration order (a, b, delta).\n        a, b, delta = np.meshgrid(a_vals, b_vals, delta_vals, indexing='ij')\n\n        # --- Evaluate Turing instability conditions ---\n        \n        # Common terms derived from LSA\n        a_plus_b = a + b\n        a_plus_b_sq = a_plus_b**2\n        \n        # This term appears in both tr(J) and the diffusion-driven conditions\n        common_ratio = (b - a) / a_plus_b\n\n        # Condition (i): Reaction-only stability\n        # Requires tr(J)  0. Since det(J) = (a+b)^2 > 0 is always true for positive a,b,\n        # we only need to check the trace.\n        # tr(J) = (b-a)/(a+b) - (a+b)^2\n        trace_J = common_ratio - a_plus_b_sq\n        reaction_stable = trace_J  -tol\n\n        # Condition (ii): Diffusion-driven instability\n        # This requires two sub-conditions to hold simultaneously.\n        # Let d_term = (delta * J11 + D_u * J22), where D_u = 1.\n        d_term = delta * common_ratio - a_plus_b_sq\n\n        # Sub-condition A: d_term > 0\n        diff_instability_cond_A = d_term > tol\n\n        # Sub-condition B: d_term^2 > 4 * D_u * delta * det(J)\n        # where det(J) = (a+b)^2\n        det_J = a_plus_b_sq\n        diff_instability_cond_B = d_term**2 > 4 * delta * det_J + tol\n\n        # A point exhibits Turing instability if it is stable without diffusion\n        # but unstable with diffusion. This requires all three conditions to be met.\n        turing_points = np.sum(reaction_stable  diff_instability_cond_A  diff_instability_cond_B)\n        \n        results.append(turing_points)\n\n    # Format the final output as a single line: [count1,count2,count3,count4]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}