{
    "hands_on_practices": [
        {
            "introduction": "This first practice problem takes you to the heart of why moment closure techniques are necessary. By deriving the exact rate equations for a simple epidemic model, you will see firsthand how the dynamics of lower-order motifs (like infected nodes) depend on higher-order motifs (like susceptible-infected pairs), which in turn depend on even higher-order motifs (triples). This exercise reveals the infinite hierarchy of equations that moment closure aims to solve. ",
            "id": "4130514",
            "problem": "Consider a continuous-time susceptible-infected-susceptible (SIS) contact process on a finite, undirected, simple, $k$-regular graph with $N$ nodes, where every node has exactly $k$ neighbors. Let the infection rate per susceptible-infected edge be $\\lambda > 0$ and the recovery rate per infected node be $\\mu > 0$. Define the following motif densities, all normalized by $N$ and counted as ordered structures:\n- For a node state $X \\in \\{S,I\\}$, let $[X]$ denote the expected number of nodes in state $X$ divided by $N$.\n- For ordered edges, let $[XY]$ denote the expected number of ordered edges $(X \\to Y)$ divided by $N$. Because the graph is undirected, $[SI] = [IS]$ holds at all times, but we will retain ordered notation to organize event contributions.\n- For ordered length-$2$ paths (triples), let $[XYZ]$ denote the expected number of ordered paths $X$–$Y$–$Z$ with distinct endpoints and middle node $Y$, divided by $N$; that is, $[XYZ]$ counts ordered neighbor pairs of the middle node $Y$ leading to endpoints in states $X$ and $Z$.\n\nYou may assume conservation identities implied by regularity and undirectedness, such as $[S] + [I] = 1$, $[SS] + [SI] + [IS] + [II] = k$, and $[XYZ]$ sums to $k(k-1)$ over all states $X,Y,Z \\in \\{S,I\\}$, but do not assume any moment closure approximations a priori.\n\nStarting from first principles—namely, the continuous-time Markov dynamics governed by the infection events occurring independently on each susceptible-infected edge at rate $\\lambda$ and recovery events occurring independently at each infected node at rate $\\mu$, together with exact counting of motif transformations induced by these events—do the following:\n1. Derive the exact time-evolution equations for the node and pair densities, $\\frac{d}{dt}[I]$ and $\\frac{d}{dt}[SI]$, in terms of only $\\lambda$, $\\mu$, $k$, and the motif densities defined above. Your derivation must account for all gains and losses contributed by infection and recovery events, including the changes to neighboring edges resulting from a node state transition, and it must express $\\frac{d}{dt}[SI]$ exactly using triple densities (do not apply any closure approximations).\n2. Extend the derivation to the triple densities by writing down the exact form of $\\frac{d}{dt}[SSI]$ and $\\frac{d}{dt}[ISI]$ symbolically, showing explicitly how these depend on quadruple motif densities of ordered length-$3$ paths (e.g., $[WXYZ]$ with $W,X,Y,Z \\in \\{S,I\\}$), and explain why this dependence prevents closure at the triple level for finite $k$ without additional approximation assumptions. Identify which higher-order terms appear and how they arise from infection and recovery events at the middle and endpoint nodes of the triples.\n3. Provide, as your final answer, the exact analytic expression you obtained for $\\frac{d}{dt}[SI]$ in terms of $\\lambda$, $\\mu$, $[II]$, $[SI]$, $[SSI]$, and $[ISI]$. No numerical evaluation is required.\n\nYour final answer must be a single closed-form symbolic expression. If you introduce any additional notation, it must be clearly defined within the derivation. Do not use any moment closure approximations in parts 1 or 2 of the derivation. No rounding or units are needed, since the final answer is symbolic.",
            "solution": "The problem asks for the derivation of the exact time-evolution equations for several motif densities in a susceptible-infected-susceptible (SIS) model on a $k$-regular graph. The derivation must be based on first principles, without applying any closure approximations.\n\nFirst, I will derive the equation for the density of infected nodes, $[I]$. Then, I will derive the central result: the equation for the density of susceptible-infected edges, $[SI]$. Finally, I will discuss the equations for triple densities to illustrate the problem of closure.\n\nLet $\\sigma_i \\in \\{S, I\\}$ be the state of node $i$. The motif densities are defined as expectations over the stochastic process, normalized by the total number of nodes $N$. For example, $[I] = \\frac{1}{N} E[\\sum_i \\mathbb{I}(\\sigma_i=I)]$, where $\\mathbb{I}(\\cdot)$ is the indicator function. The time evolution of these expected values is governed by the master equation of the underlying continuous-time Markov process.\n\n**1. Derivation of $\\frac{d}{dt}[I]$**\n\nThe density of infected nodes, $[I]$, changes due to two types of events:\n-   **Infection**: A susceptible node ($S$) becomes infected ($I$). This occurs across a susceptible-infected ($S-I$) edge. The problem states the infection rate is $\\lambda$ per $S-I$ edge. The total number of ordered $S-I$ edges in the network is $N[SI]$. Each such edge corresponds to a potential infection event where the $S$ node becomes $I$. The total rate at which infection events occur in the system is the sum of rates over all $S$ nodes, which is $\\sum_{i|\\sigma_i=S} \\lambda \\times (\\text{number of } I \\text{ neighbors of } i)$. This sum is precisely $\\lambda$ times the total number of $S-I$ (and $I-S$) edges, which is $\\lambda N [SI]$. Each infection event increases the number of infected nodes by $1$. Thus, the total rate of increase in $N[I]$ due to infection is $\\lambda N [SI]$.\n-   **Recovery**: An infected node ($I$) becomes susceptible ($S$). This occurs for each infected node at a rate $\\mu$. The total number of infected nodes is $N[I]$. Therefore, the total rate at which recovery events occur is $\\mu N [I]$. Each recovery event decreases the number of infected nodes by $1$. Thus, the total rate of decrease in $N[I]$ due to recovery is $\\mu N [I]$.\n\nCombining these gives the rate of change for the expected number of infected nodes:\n$$ \\frac{d}{dt}(N[I]) = \\lambda N [SI] - \\mu N [I] $$\nDividing by $N$, we obtain the evolution equation for the density $[I]$:\n$$ \\frac{d}{dt}[I] = \\lambda [SI] - \\mu [I] $$\nThis equation is exact and relates the rate of change of a node-level density to a pair-level density, illustrating the characteristic coupling in the moment hierarchy.\n\n**2. Derivation of $\\frac{d}{dt}[SI]$**\n\nWe now derive the time evolution for the density of susceptible-infected ordered edges, $[SI]$. We must account for all events that create or destroy $S-I$ edges. The events are infections ($S \\to I$) and recoveries ($I \\to S$).\n\n**Contribution from Infection Events:**\nInfection events occur at a total rate of $\\lambda N [SI]$. Let's consider a single such event, where a susceptible node $j$ becomes infected due to its connection to an infected neighbor $i$. The state of node $j$ changes from $S$ to $I$. We analyze the change in the number of $S-I$ edges.\n-   **Change involving the edge $(i, j)$:** The edge connecting $i$ and $j$ was an $I-S$ edge. After the event, it becomes an $I-I$ edge. Since the graph is undirected, this means we lose one $S-I$ edge and one $I-S$ edge. The change to the count of $S-I$ edges is $-1$.\n-   **Change involving other neighbors of node $j$:** Node $j$ has $k-1$ other neighbors (since the graph is $k$-regular). Let $m$ be such a neighbor, $m \\neq i$.\n    -   If node $m$ is in state $S$, the edge $(j, m)$ was an $S-S$ edge. After $j$ becomes infected, this edge becomes an $I-S$ edge. This creates one $S-I$ edge. The change is $+1$.\n    -   If node $m$ is in state $I$, the edge $(j, m)$ was an $S-I$ edge. After $j$ becomes infected, this edge becomes an $I-I$ edge. This destroys one $S-I$ edge. The change is $-1$.\nTo find the total expected change, we average over all infection events. An infection event selects an $S-I$ edge at random. The expected number of $S$ and $I$ neighbors of the susceptible node $j$ (given it is connected to an infected node $i$) is determined by the triple densities.\n-   The expected number of $S$ neighbors of $j$ (excluding $i$) is given by the density of $I-S-S$ paths divided by the density of $I-S$ pairs. From the problem definitions, this is $\\frac{[ISS]}{[IS]}$. Since $[IS]=[SI]$ and $[ISS]=[SSI]$ for an undirected graph, this is $\\frac{[SSI]}{[SI]}$.\n-   Similarly, the expected number of $I$ neighbors of $j$ (excluding $i$) is given by the density of $I-S-I$ paths, which is $\\frac{[ISI]}{[SI]}$.\n\nThe total expected change in the number of $S-I$ edges per infection event is the sum of these effects:\n$$ \\Delta N_{SI}^{\\text{inf}} = -1 + \\left( (+1) \\times \\frac{[SSI]}{[SI]} \\right) + \\left( (-1) \\times \\frac{[ISI]}{[SI]} \\right) = -1 + \\frac{[SSI] - [ISI]}{[SI]} $$\nThe total rate of change in $N[SI]$ due to infections is the rate of events multiplied by the expected change per event:\n$$ \\left( \\frac{d(N[SI])}{dt} \\right)_{\\text{inf}} = (\\lambda N [SI]) \\times \\left(-1 + \\frac{[SSI] - [ISI]}{[SI]}\\right) = \\lambda N (-[SI] + [SSI] - [ISI]) $$\n\n**Contribution from Recovery Events:**\nRecovery events ($I \\to S$) occur at a total rate of $\\mu N [I]$. Let's consider a single infected node $j$ recovering. We analyze the change in the number of $S-I$ edges.\n-   Let $m$ be a neighbor of node $j$.\n    -   If node $m$ is in state $S$, the edge $(j, m)$ was an $I-S$ edge. After $j$ recovers, this edge becomes an $S-S$ edge. This destroys one $S-I$ edge. The change is $-1$.\n    -   If node $m$ is in state $I$, the edge $(j, m)$ was an $I-I$ edge. After $j$ recovers, this edge becomes an $S-I$ edge. This creates one $S-I$ edge. The change is $+1$.\nTo find the total expected change, we average over all recovery events. A recovery event selects an infected node at random. The expected number of $S$ and $I$ neighbors of a randomly chosen infected node is given by pair densities.\n-   The total number of edges connected to $I$ nodes is $k N[I]$. This must equal the sum of edges leading to $S$ nodes ($N[SI]$) and $I$ nodes ($N[II]$). Thus, $k[I] = [SI] + [II]$.\n-   The expected number of $S$ neighbors for a random $I$ node is $\\frac{N[SI]}{N[I]} = \\frac{[SI]}{[I]}$.\n-   The expected number of $I$ neighbors for a random $I$ node is $\\frac{N[II]}{N[I]} = \\frac{[II]}{[I]}$.\n\nThe total expected change in the number of $S-I$ edges per recovery event is:\n$$ \\Delta N_{SI}^{\\text{rec}} = \\left( (-1) \\times \\frac{[SI]}{[I]} \\right) + \\left( (+1) \\times \\frac{[II]}{[I]} \\right) = \\frac{[II] - [SI]}{[I]} $$\nThe total rate of change in $N[SI]$ due to recoveries is the rate of events multiplied by the expected change per event:\n$$ \\left( \\frac{d(N[SI])}{dt} \\right)_{\\text{rec}} = (\\mu N [I]) \\times \\left(\\frac{[II] - [SI]}{[I]}\\right) = \\mu N ([II] - [SI]) $$\n\n**Full Equation for $\\frac{d}{dt}[SI]$:**\nCombining the contributions from infection and recovery and dividing by $N$:\n$$ \\frac{d}{dt}[SI] = \\lambda(-[SI] + [SSI] - [ISI]) + \\mu([II] - [SI]) $$\nRearranging the terms, we get the final form:\n$$ \\frac{d}{dt}[SI] = \\lambda([SSI] - [ISI]) - (\\lambda + \\mu)[SI] + \\mu [II] $$\nThis is the exact equation for the evolution of the $[SI]$ pair density, and it depends on the triple densities $[SSI]$ and $[ISI]$.\n\n**3. The Hierarchy and the Problem of Closure**\n\nTo solve the system of equations, we would need to write down the evolution equations for the triple densities, such as $[SSI]$ and $[ISI]$, that appear in the equation for $\\frac{d}{dt}[SI]$. Let's symbolically consider the derivation for $\\frac{d}{dt}[SSI]$, which corresponds to ordered paths $S-S-I$.\nThe number of such triples can change if the state of any of the three nodes in the path changes, or if nodes one step away change state. For example:\n-   **Creation of an $[SSI]$ triple**: This can happen if, for example, we have an $I-S-I$ triple ($I_u-S_v-I_w$) and the endpoint $u$ recovers ($I_u \\to S_u$). This event, occurring at rate $\\mu$, turns an $[ISI]$ triple into an $[SSI]$ triple. This contributes a term $+\\mu[ISI]$ to $\\frac{d}{dt}[SSI]$.\n-   **Destruction of an $[SSI]$ triple**: Consider an $S-S-I$ triple ($S_u-S_v-I_w$). If the right endpoint $I_w$ recovers, the triple becomes $S-S-S$. This event occurs at rate $\\mu$ for each such triple, contributing a term $-\\mu[SSI]$ to the dynamics.\n-   **Dependence on Quadruples**: A crucial type of event is when a node in the triple changes state due to a neighbor *outside* the triple. Consider an $S-S-S$ triple, $S_u-S_v-S_w$. For this to become an $S-S-I$ triple, the node $w$ must become infected. This requires $w$ to have an infected neighbor, say $z$. This involves a path of length 3 (a quadruple), $S_u-S_v-S_w-I_z$. An infection event on the $(w,z)$ link at rate $\\lambda$ transforms the $[SSS]$ triple into an $[SSI]$ triple. The rate of this transformation depends on the density of $[SSSI]$ quadruples.\n\nTherefore, the exact equation for $\\frac{d}{dt}[SSI]$ will depend on quadruple densities such as $[SSSI]$, $[ISSI]$, $[SSII]$, etc. For example, a term proportional to $\\lambda [ISSI]$ will appear in the equation for $\\frac{d}{dt}[ISI]$, as an infection propagating along an $I-S-S-I$ path can convert an $[SSI]$ triple into an $[ISI]$ triple.\nThis demonstrates the general problem: the derivative of the density of motifs of size $n$ depends on the density of motifs of size $n+1$. This creates an infinite hierarchy of coupled differential equations for a large or infinite graph. To obtain a finite, solvable system of equations, one must \"close\" this hierarchy by positing an approximation that expresses higher-order moments (e.g., triples) in terms of lower-order moments (e.g., pairs and singlets). The problem asked for the exact equations *before* any such closure, which we have derived for the pair level and discussed for the triple level.",
            "answer": "$$\\boxed{\\lambda([SSI] - [ISI]) - (\\lambda + \\mu)[SI] + \\mu [II]}$$"
        },
        {
            "introduction": "Having understood the closure problem, we now explore the power of a simple pair approximation on networks where it works best: those that are locally tree-like. This exercise demonstrates a classic and profound result in network epidemiology, showing that the dynamic threshold for an epidemic outbreak is mathematically equivalent to the static threshold for bond percolation. This connection provides deep insight into how network structure governs the potential for large-scale spreading. ",
            "id": "4130522",
            "problem": "Consider an infinite, locally tree-like network generated by the configuration model with degree distribution $\\{p_k\\}_{k\\in\\mathbb{N}}$ and finite first and second moments $\\langle k\\rangle$ and $\\langle k^2\\rangle$. Disease transmission follows a Continuous-Time Markov Chain (CTMC) Susceptible-Infected-Removed (SIR) process: each susceptible neighbor of an infected node is infected at per-edge rate $\\beta>0$, and each infected node recovers at rate $\\gamma\\ge 0$. The Susceptible-Infected (SI) limit corresponds to $\\gamma\\to 0$ (i.e., no recovery). Assume edges act independently and the network is static.\n\nUsing a pairwise moment closure on this locally tree-like network, linearize the dynamics about the disease-free state to obtain the invasion threshold predicted by the pairwise model. Separately, derive the bond percolation threshold on the same network when edges are occupied independently with probability equal to the edge-level transmissibility of the SIR process. Then compare the two thresholds and analyze under what structural and dynamical conditions they coincide, particularly in the SI limit.\n\nWhich statement is correct?\n\nA. On a locally tree-like configuration-model network with independent edges and Markovian SIR dynamics, the pairwise invasion threshold is identical to the bond percolation threshold with edge transmissibility $T=\\beta/(\\beta+\\gamma)$; in the SI limit $\\gamma\\to 0$, both reduce to the giant-component condition $(\\langle k^2\\rangle-\\langle k\\rangle)/\\langle k\\rangle>1$.\n\nB. The thresholds coincide for any network topology provided $\\beta>0$, because the SI limit removes recovery and guarantees invasion independent of structure.\n\nC. The thresholds coincide only for scale-free networks with degree exponent $2<\\alpha<3$ where $\\langle k^2\\rangle$ diverges; for all other degree distributions they differ.\n\nD. Pairwise models always predict a strictly positive invasion threshold $\\beta_c>0$ even in the SI limit $\\gamma=0$, because the closure introduces an effective damping term that mimics recovery.",
            "solution": "The user wants a critical analysis and solution to a problem concerning epidemic thresholds on a network.\n\n### Step 1: Extract Givens\n- **Network Model**: Infinite, locally tree-like network generated by the configuration model.\n- **Degree Distribution**: $\\{p_k\\}_{k\\in\\mathbb{N}}$.\n- **Moments**: The first moment $\\langle k \\rangle = \\sum_k k p_k$ and the second moment $\\langle k^2 \\rangle = \\sum_k k^2 p_k$ are finite.\n- **Dynamical Process**: Continuous-Time Markov Chain (CTMC) Susceptible-Infected-Removed (SIR) model.\n- **Rates**:\n    - Per-edge infection rate: $\\beta > 0$.\n    - Per-node recovery rate: $\\gamma \\ge 0$.\n- **SI Limit**: The special case where $\\gamma \\to 0$.\n- **Assumptions**: Edges act independently in transmission. The network is static.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Groundedness**: The problem is well-grounded in the established fields of network science and mathematical epidemiology. The configuration model, SIR process, pairwise moment closure, and bond percolation are all standard, rigorous concepts.\n- **Well-Posedness**: The problem is well-posed. It requests the derivation and comparison of two well-defined theoretical quantities (invasion threshold and percolation threshold) under specified conditions. The assumptions (locally tree-like, finite moments) ensure that a unique and meaningful solution exists and can be derived.\n- **Objectivity**: The problem statement is formulated using precise, objective, and standard scientific terminology. There are no subjective or ambiguous elements.\n- **Check for Flaws**:\n    1.  **Scientific Unsoundness**: None. The premises are standard in theoretical modeling.\n    2.  **Non-Formalizable**: None. The problem is stated in a way that is directly translatable into mathematical equations.\n    3.  **Incomplete/Contradictory**: None. All necessary information (network model, dynamics, rates, key assumptions like \"locally tree-like\") is provided.\n    4.  **Unrealistic/Infeasible**: None. This is a theoretical model, and its parameters are consistent.\n    5.  **Ill-Posed**: None. The question leads to a unique answer.\n    6.  **Trivial/Tautological**: None. The derivation requires multiple steps of reasoning based on first principles of stochastic processes and network theory.\n    7.  **Outside Verifiability**: None. The derivations are mathematically verifiable.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. I will proceed with deriving the solution.\n\n### Derivation of the Pairwise Invasion Threshold\n\nWe analyze the dynamics near the disease-free equilibrium (DFE), where the density of infected nodes $[I]$ is infinitesimally small, i.e., $[I] \\approx 0$. Let $[SI]$ be the density of edges connecting a susceptible node to an infected node. The dynamics of the densities can be described by a system of ordinary differential equations (ODEs). For an invasion to occur, the number of infected nodes must initially grow.\nThe rate of change of infected nodes is:\n$$ \\frac{d[I]}{dt} = \\beta [SI] - \\gamma [I] $$\nTo analyze the stability of the DFE, we need an equation for $[SI]$.\n$$ \\frac{d[SI]}{dt} = (\\text{rate of creation}) - (\\text{rate of destruction}) $$\nAn $SI$ link is destroyed in two ways:\n1.  The infected node in the pair recovers: Rate is $\\gamma [SI]$.\n2.  The infected node transmits the disease to the susceptible node in the pair: Rate is $\\beta [SI]$.\n\nNew $SI$ links are created when a susceptible node $S'$ gets infected by a node $I$, and $S'$ is also connected to other susceptible nodes. The infection event itself occurs at a rate of $\\beta [SI]$. Consider one such event, where an $I \\to S'$ transmission happens. The newly infected node $S'$ has some degree $k$. Before infection, it was connected to the infecting node $I$ and $k-1$ other neighbors. In the locally tree-like network near the DFE, these $k-1$ neighbors are all susceptible. Thus, this single infection event creates $k-1$ new $SI$ links.\n\nWe need to find the average number of new $SI$ links created per infection event. The node $S'$ that gets infected is a neighbor of an infected node. In a configuration model network, the degree distribution of a node reached by traversing a random edge is not $p_k$, but $\\tilde{p}_k = k p_k / \\langle k \\rangle$. Therefore, the average number of new $SI$ links created is the expectation of $k-1$ over this distribution:\n$$ \\langle k-1 \\rangle_{\\text{neighbor}} = \\sum_k (k-1) \\tilde{p}_k = \\sum_k (k-1) \\frac{k p_k}{\\langle k \\rangle} = \\frac{\\sum_k (k^2 - k) p_k}{\\langle k \\rangle} = \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} $$\nThe total rate of creation of $SI$ links is the rate of infection events, $\\beta [SI]$, multiplied by the average number of new links per event:\n$$ \\text{Rate of creation} = \\beta [SI] \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) $$\nCombining the terms, the linearized ODE for $[SI]$ is:\n$$ \\frac{d[SI]}{dt} = \\beta [SI] \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) - \\gamma [SI] - \\beta [SI] $$\n$$ \\frac{d[SI]}{dt} = \\left[ \\beta \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} - 1 \\right) - \\gamma \\right] [SI] $$\nFor the infection to spread, $[SI]$ must grow from an infinitesimally small perturbation, which requires the coefficient on the right-hand side to be positive:\n$$ \\beta \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} - 1 \\right) - \\gamma > 0 $$\n$$ \\beta \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > \\beta + \\gamma $$\nDividing by $\\beta + \\gamma$ (since $\\beta>0, \\gamma\\ge0$, this sum is positive), we get the invasion condition:\n$$ \\frac{\\beta}{\\beta + \\gamma} \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\n\n### Derivation of the Bond Percolation Threshold\n\nBond percolation on a network involves occupying each edge with probability $p$, independently. A giant connected component (GC) of occupied edges emerges if $p$ is above a critical threshold $p_c$. For a configuration model network, this threshold is found by analyzing the branching process of following occupied edges.\nA GC exists if the expected number of occupied edges leading away from a node reached by traversing an occupied edge is greater than $1$.\nLet's trace a path along an occupied edge. We arrive at a node whose degree $k$ is drawn from the distribution $\\tilde{p}_k = k p_k / \\langle k \\rangle$. This node has $k-1$ other edges. Each of these is independently occupied with probability $p$. The expected number of other occupied edges from this node is $(k-1)p$.\nAveraging over all possible degrees $k$ of such a node:\n$$ \\text{Average onward paths} = \\sum_k (k-1) p \\tilde{p}_k = p \\sum_k (k-1) \\frac{k p_k}{\\langle k \\rangle} = p \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) $$\nThe condition for the existence of a GC is that this quantity is greater than $1$:\n$$ p \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\nThe problem states we should use an occupation probability $p$ equal to the SIR edge-level transmissibility, $T$. For a Markovian SIR process, an infected node is in a race to infect a susceptible neighbor (at rate $\\beta$) or to recover (at rate $\\gamma$). The probability that infection occurs before recovery is:\n$$ T = \\frac{\\beta}{\\beta + \\gamma} $$\nSetting $p=T$, the bond percolation condition for a large-scale outbreak becomes:\n$$ \\frac{\\beta}{\\beta + \\gamma} \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\n\n### Comparison and SI Limit Analysis\n\n1.  **Comparison**: The invasion threshold derived from the linearized pairwise model is identical to the condition for the emergence of a giant component in bond percolation where the edge occupation probability is the transmissibility $T = \\beta/(\\beta+\\gamma)$. This equivalence is a classic result for locally tree-like networks.\n\n2.  **SI Limit**: We consider the case where there is no recovery, $\\gamma \\to 0$.\n    In this limit, the transmissibility becomes $T = \\frac{\\beta}{\\beta + 0} = 1$ (for $\\beta>0$).\n    Substituting $T=1$ into the threshold condition gives:\n    $$ 1 \\cdot \\left( \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} \\right) > 1 $$\n    This is the Molloy-Reed criterion for the existence of a giant component in the original static network. It means that for an SI process, an epidemic can occur if and only if the network has a giant component for the infection to spread through.\n\n### Option-by-Option Analysis\n\n**A. On a locally tree-like configuration-model network with independent edges and Markovian SIR dynamics, the pairwise invasion threshold is identical to the bond percolation threshold with edge transmissibility $T=\\beta/(\\beta+\\gamma)$; in the SI limit $\\gamma\\to 0$, both reduce to the giant-component condition $(\\langle k^2\\rangle-\\langle k\\rangle)/\\langle k\\rangle>1$.**\n- My derivation confirms that the pairwise threshold is $\\frac{\\beta}{\\beta+\\gamma} \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} > 1$.\n- My derivation confirms the bond percolation threshold with $p=T=\\beta/(\\beta+\\gamma)$ is identical.\n- My analysis of the $\\gamma \\to 0$ limit shows that the condition becomes $\\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} > 1$, which is the giant-component condition.\n- **Verdict: Correct.**\n\n**B. The thresholds coincide for any network topology provided $\\beta>0$, because the SI limit removes recovery and guarantees invasion independent of structure.**\n- \"coincide for any network topology\": This is false. The equivalence of the pairwise model, branching process analysis, and percolation mapping relies fundamentally on the locally tree-like structure of the network, which minimizes the impact of short loops. On highly clustered networks (e.g., lattices), these approximations break down and the thresholds diverge.\n- \"guarantees invasion independent of structure\": This is false. The SI limit threshold is $\\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} > 1$, which is a strict condition on the network's degree distribution. If this condition is not met, no large-scale invasion will occur even with $\\gamma=0$.\n- **Verdict: Incorrect.**\n\n**C. The thresholds coincide only for scale-free networks with degree exponent $2<\\alpha<3$ where $\\langle k^2\\rangle$ diverges; for all other degree distributions they differ.**\n- \"only for scale-free networks...\": This is false. The derivation holds for any degree distribution $\\{p_k\\}$ provided the first two moments are finite, as assumed in the problem setup. The coincidence is a general property of configuration model networks. The case where $\\langle k^2 \\rangle$ diverges is a special limit where the invasion threshold is zero, but the formal identity of the threshold conditions still holds.\n- **Verdict: Incorrect.**\n\n**D. Pairwise models always predict a strictly positive invasion threshold $\\beta_c>0$ even in the SI limit $\\gamma=0$, because the closure introduces an effective damping term that mimics recovery.**\n- In the SI limit ($\\gamma=0$), the pairwise model predicts invasion if $\\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle} > 1$. This is a condition on network structure, not on $\\beta$. If the condition is met, any $\\beta > 0$ will lead to an epidemic. The critical threshold is $\\beta_c = 0$. The statement that the model *always* predicts $\\beta_c > 0$ is false.\n- The term in the pairwise equation that could be misinterpreted as \"damping\" is $-\\beta[SI]$, which represents the removal of an $SI$ link via successful transmission. This is a real saturation effect, not an artifact that mimics recovery.\n- **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While powerful, the standard pair approximation's assumption of a tree-like local structure is a major limitation, as real-world networks often feature significant clustering (many triangles). This final exercise challenges you to build a more sophisticated closure scheme that explicitly accounts for this by distinguishing between open wedges and closed triangles. Mastering this technique allows you to create more accurate models for dynamics on realistic, clustered networks. ",
            "id": "4130494",
            "problem": "Consider a large, sparse, undirected network of $N$ nodes with mean degree $\\langle k \\rangle$ and negligible degree-degree correlation. Each node is in one of three states, denoted by $X$, $Y$, and $Z$. Let $[X]$ denote the fraction of nodes in state $X$, and let $[XY]$ denote the number of undirected edges between states $X$ and $Y$ divided by $N$ (so that $[XY] = [YX]$ and $\\sum_{W \\in \\{X,Y,Z\\}} [YW] = \\langle k \\rangle [Y]$). Define the oriented triplet density $[XYZ]$ as the number of ordered pairs of neighbors $(X,Z)$ sharing a common center in state $Y$, divided by $N$, and decompose it into the density of closed triangles $[XYZ]_{\\triangle}$ and open wedges $[XYZ]_{\\wedge}$ (so that $[XYZ] = [XYZ]_{\\triangle} + [XYZ]_{\\wedge}$). The Global Clustering Coefficient (GCC), denoted by $C$, is defined as the probability that two randomly chosen neighbors of the same node are connected by an edge.\n\nUsing a pair approximation (conditional independence of neighbor states given the center state) and a moment closure that corrects for the fact that the two neighbors must be distinct, derive expressions for $[XYZ]_{\\triangle}$ and $[XYZ]_{\\wedge}$ in terms of $[XY]$, $[YZ]$, $[Y]$, $\\langle k \\rangle$, and $C$. Your derivation must start from the following foundational bases: the definitions above, the independence approximation for neighbors conditioned on the center state, and the definition of the Global Clustering Coefficient as the probability of closure of a neighbor pair.\n\nExpress your final answer as a two-entry row matrix, where the first entry is the approximation for $[XYZ]_{\\triangle}$ and the second entry is the approximation for $[XYZ]_{\\wedge}$. No numerical evaluation is required, and no rounding is needed. The expressions should be fully simplified analytic expressions in symbolic form.",
            "solution": "The user wants to derive expressions for the density of closed triangles, $[XYZ]_{\\triangle}$, and open wedges, $[XYZ]_{\\wedge}$, within a network of nodes in three states $\\{X, Y, Z\\}$. The derivation must be based on a pair approximation and moment closure, and the final expressions should be in terms of the pair density $[XY]$, the single-node density $[Y]$, the mean degree $\\langle k \\rangle$, and the Global Clustering Coefficient $C$.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\n-   Network: large, sparse, undirected, $N$ nodes.\n-   Mean degree: $\\langle k \\rangle$.\n-   Correlation: negligible degree-degree correlation.\n-   Node states: $X, Y, Z$.\n-   Single-node density: $[X]$ is the fraction of nodes in state $X$.\n-   Pair density: $[XY]$ is the number of undirected edges between states $X$ and $Y$, divided by $N$.\n-   Pair density properties: $[XY] = [YX]$ and $\\sum_{W \\in \\{X,Y,Z\\}} [YW] = \\langle k \\rangle [Y]$.\n-   Oriented triplet density: $[XYZ]$ is the number of ordered pairs of neighbors $(X,Z)$ sharing a common center in state $Y$, divided by $N$.\n-   Triplet decomposition: $[XYZ] = [XYZ]_{\\triangle} + [XYZ]_{\\wedge}$, where $[XYZ]_{\\triangle}$ is the density of closed triangles and $[XYZ]_{\\wedge}$ is the density of open wedges.\n-   Global Clustering Coefficient (GCC): $C$ is the probability that two randomly chosen neighbors of the same node are connected by an edge.\n-   Required Method: Pair approximation (conditional independence of neighbor states) and a moment closure that corrects for distinct neighbors.\n-   Target Quantities: $[XYZ]_{\\triangle}$ and $[XYZ]_{\\wedge}$.\n-   Allowed variables in the final answer: $[XY]$, $[YZ]$, $[Y]$, $\\langle k \\rangle$, $C$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is set within the standard framework of network science and the modeling of complex systems. Pair approximation and moment closure are established techniques in this field. All definitions are standard. The problem is scientifically sound.\n-   **Well-Posed**: The problem is well-defined. It asks for the derivation of specific quantities using a specified approximation method and a defined set of initial quantities. A unique solution within this framework is expected.\n-   **Objective**: The problem is stated in precise, mathematical language, free from ambiguity or subjective claims.\n-   **Flaw Checklist**: The problem does not violate any of the invalidity criteria. It is scientifically sound, formalizable, self-contained, realistic within a modeling context, and well-posed. The derivation it asks for is non-trivial.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed with the derivation.\n\n### Derivation\nThe goal is to find expressions for $[XYZ]_{\\triangle}$ and $[XYZ]_{\\wedge}$. The derivation proceeds in three main stages: first, an expression for the total triplet density $[XYZ]$ is derived using pair approximation; second, this expression is simplified to use only the allowed variables; third, the Global Clustering Coefficient $C$ is used to partition $[XYZ]$ into its closed and open components.\n\n**1. Derivation of the total triplet density $[XYZ]$**\n\nThe quantity $[XYZ]$ is defined as the number of ordered pairs of neighbors, one in state $X$ and one in state $Z$, of a central node in state $Y$, all divided by the total number of nodes $N$.\nLet $\\mathcal{V}_Y$ be the set of nodes in state $Y$. For a node $j \\in \\mathcal{V}_Y$ with degree $k_j$, let $k_{j,X}$ be the number of its neighbors in state $X$ and $k_{j,Z}$ be the number of its neighbors in state $Z$. The number of ordered $(X,Z)$ neighbor pairs for node $j$ is $k_{j,X} k_{j,Z}$.\nThe total density is then the average of this quantity over all $Y$ nodes, multiplied by the fraction of $Y$ nodes:\n$$[XYZ] = \\frac{1}{N} \\sum_{j \\in \\mathcal{V}_Y} k_{j,X} k_{j,Z} = [Y] \\left( \\frac{1}{|\\mathcal{V}_Y|} \\sum_{j \\in \\mathcal{V}_Y} k_{j,X} k_{j,Z} \\right) = [Y] \\langle k_X k_Z \\rangle_Y$$\nwhere $\\langle \\cdot \\rangle_Y$ denotes an average over nodes in state $Y$.\n\nThe pair approximation assumes that the states of the neighbors of a central node are independent, conditional on the state of the central node. For a node $j \\in \\mathcal V_Y$ of degree $k_j$, the states of its $k_j$ neighbors are drawn from a multinomial distribution. The probability that a random neighbor of a $Y$-node is in state $W$ is denoted $P(W|Y)$. This probability can be calculated from the given densities. The total number of edge \"stubs\" from $Y$-nodes is $N \\sum_W [YW] = N \\langle k \\rangle [Y]$. The number of stubs from $Y$-nodes connecting to $X$-nodes is $N[XY]$. Thus,\n$$P(X|Y) = \\frac{N[XY]}{N\\langle k \\rangle [Y]} = \\frac{[XY]}{\\langle k \\rangle [Y]}$$\nand similarly for $Z$.\n\nFor a node $j \\in \\mathcal V_Y$ with degree $k_j$, the expected value of the product $k_{j,X} k_{j,Z}$ is given by the properties of the multinomial distribution. Since the two neighbors in the pair must be distinct, we are choosing two distinct neighbors and asking for their states. The number of ordered pairs of distinct neighbors is $k_j(k_j-1)$.\n$$E[k_{j,X} k_{j,Z} | k_j] = k_j(k_j-1) P(X|Y)P(Z|Y)$$\nThis is the \"correction for the fact that the two neighbors must be distinct\" mentioned in the problem. Averaging over the degree distribution of $Y$-nodes:\n$$\\langle k_X k_Z \\rangle_Y = \\langle k(k-1) \\rangle_Y P(X|Y)P(Z|Y)$$\nSubstituting this back into the expression for $[XYZ]$:\n$$[XYZ] = [Y] \\langle k(k-1) \\rangle_Y P(X|Y)P(Z|Y)$$\nNow, we substitute the expressions for $P(X|Y)$ and $P(Z|Y)$. The problem assumes \"negligible degree-degree correlation\" and gives $\\sum_W [YW] = \\langle k \\rangle [Y]$, which implies that the average degree of a $Y$-node is the global average degree, $\\langle k \\rangle_Y = \\langle k \\rangle$. We extend this to higher moments, so $\\langle k(k-1) \\rangle_Y \\approx \\langle k(k-1) \\rangle$.\n$$[XYZ] = [Y] \\langle k(k-1) \\rangle \\left( \\frac{[XY]}{\\langle k \\rangle [Y]} \\right) \\left( \\frac{[YZ]}{\\langle k \\rangle [Y]} \\right) = \\frac{\\langle k(k-1) \\rangle}{\\langle k \\rangle^2} \\frac{[XY][YZ]}{[Y]}$$\n\n**2. Simplification\nof the expression**\n\nThe expression for $[XYZ]$ contains $\\langle k(k-1) \\rangle = \\langle k^2 \\rangle - \\langle k \\rangle$, which depends on the second moment of the degree distribution, $\\langle k^2 \\rangle$. The problem requires the final answer to be in terms of $\\langle k \\rangle$, not $\\langle k^2 \\rangle$. This necessitates an approximation for $\\langle k^2 \\rangle$. A standard mean-field approximation is to neglect degree heterogeneity, i.e., to assume the network is regular, where every node has the same degree $k_i = \\langle k \\rangle$.\nUnder this approximation:\n$$\\langle k^2 \\rangle = \\langle k \\rangle^2$$\nTherefore, the term $\\langle k(k-1) \\rangle$ is approximated as:\n$$\\langle k(k-1) \\rangle = \\langle k^2 \\rangle - \\langle k \\rangle \\approx \\langle k \\rangle^2 - \\langle k \\rangle = \\langle k \\rangle (\\langle k \\rangle - 1)$$\nSubstituting this into the expression for $[XYZ]$:\n$$[XYZ] \\approx \\frac{\\langle k \\rangle (\\langle k \\rangle - 1)}{\\langle k \\rangle^2} \\frac{[XY][YZ]}{[Y]} = \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\frac{[XY][YZ]}{[Y]}$$\nThis is the final form for the total density of $X-Y-Z$ triplets under the specified approximations.\n\n**3. Partitioning into closed and open triplets**\n\nThe total triplet density $[XYZ]$ is the sum of the density of closed triangles $[XYZ]_{\\triangle}$ and open wedges $[XYZ]_{\\wedge}$.\n$$[XYZ] = [XYZ]_{\\triangle} + [XYZ]_{\\wedge}$$\nThe Global Clustering Coefficient, $C$, is defined as the probability that two randomly chosen neighbors of a node are connected. This means that any given triplet (or wedge) of the form $X-Y-Z$ has a probability $C$ of being closed (i.e., an edge exists between $X$ and $Z$) and a probability $1-C$ of being open.\nWe apply this global probability to our specific subset of $X-Y-Z$ triplets.\nThe density of closed triangles is the total triplet density multiplied by the probability of closure, $C$:\n$$[XYZ]_{\\triangle} = C \\cdot [XYZ]$$\nThe density of open wedges is the total triplet density multiplied by the probability of not being closed, $1-C$:\n$$[XYZ]_{\\wedge} = (1-C) \\cdot [XYZ]$$\nSubstituting the derived expression for $[XYZ]$:\n$$[XYZ]_{\\triangle} = C \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]}$$\n$$[XYZ]_{\\wedge} = (1-C) \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]}$$\nThese are the final expressions. They are to be presented as a two-entry row matrix.",
            "answer": "$$\\boxed{\\begin{pmatrix} C \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]} & (1-C) \\left( \\frac{\\langle k \\rangle - 1}{\\langle k \\rangle} \\right) \\frac{[XY][YZ]}{[Y]} \\end{pmatrix}}$$"
        }
    ]
}