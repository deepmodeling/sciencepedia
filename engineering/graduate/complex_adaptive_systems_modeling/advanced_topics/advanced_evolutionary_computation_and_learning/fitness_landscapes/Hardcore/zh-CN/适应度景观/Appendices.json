{
    "hands_on_practices": [
        {
            "introduction": "要理解适应度景观的特性，第一步是学会将其可视化。本练习提供了一个代表两种数量性状景观的数学函数，要求你识别全局和局部适应度峰值，这些是决定演化结果的关键特征。这项实践有助于培养从数学形式上解读景观拓扑结构的直觉。",
            "id": "1929454",
            "problem": "在一项关于一种嗜极细菌物种进化适应的研究中，发现个体的适应度（用 $W$ 表示）与两个关键的数量性状密切相关：一种特定代谢酶的活性水平 $z_1$ 和其细胞膜的结构稳定性 $z_2$。一位研究人员提出了一个数学模型来描述控制这些性状选择的适应度景观。适应度 $W$ 作为性状值 $z_1$ 和 $z_2$ 的函数由以下表达式给出：\n\n$$W(z_1, z_2) = 2.1 \\exp\\left(-0.5\\left[(z_1 - 3.2)^2 + (z_2 - 8.1)^2\\right]\\right) + 1.4 \\exp\\left(-0.2\\left[(z_1 - 9.5)^2 + (z_2 - 2.4)^2\\right]\\right)$$\n\n“全局适应度峰值”被定义为性状空间中对应于绝对最大可能适应度值的点 $(z_1, z_2)$。“局部适应度峰值”是一个点，其适应度高于所有紧邻点，但不是绝对最大值。\n\n基于此适应度景观模型，请确定全局适应度峰值和局部适应度峰值的坐标 $(z_1, z_2)$。从以下选项中选择正确的一项。\n\nA. 全局：(3.2, 8.1)，局部：(9.5, 2.4)\n\nB. 全局：(9.5, 2.4)，局部：(3.2, 8.1)\n\nC. 全局：(3.2, 8.1)，无局部峰值\n\nD. 全局：(9.5, 2.4)，无局部峰值\n\nE. 两个全局峰值位于 (3.2, 8.1) 和 (9.5, 2.4)\n\nF. 全局：(8.1, 3.2)，局部：(2.4, 9.5)",
            "solution": "设 $W(z_{1},z_{2})$ 是两个各向同性的高斯型峰的总和：\n$$\nW(z_{1},z_{2})=A_{1}\\exp\\!\\big(-a_{1}\\|(z_{1},z_{2})-\\mu_{1}\\|^{2}\\big)+A_{2}\\exp\\!\\big(-a_{2}\\|(z_{1},z_{2})-\\mu_{2}\\|^{2}\\big),\n$$\n其中 $A_{1}=2.1$, $a_{1}=0.5$, $\\mu_{1}=(3.2,8.1)$ 以及 $A_{2}=1.4$, $a_{2}=0.2$, $\\mu_{2}=(9.5,2.4)$。每一项都在其各自的中心处达到最大值，并随着与该中心距离的平方增加而严格递减。\n\n两个高斯峰的中心相距甚远，因此景观的两个峰值会非常接近各自高斯函数的中心。峰值的高度主要由其对应高斯项的振幅 $A_i$ 决定。第一个峰值的振幅为 $A_1=2.1$，第二个峰值的振幅为 $A_2=1.4$。\n\n由于 $A_1 > A_2$，位于 $\\mu_1=(3.2,8.1)$ 附近的峰值会比位于 $\\mu_2=(9.5,2.4)$ 附近的峰值更高。因此，$\\mu_1=(3.2,8.1)$ 对应全局适应度峰值，而 $\\mu_2=(9.5,2.4)$ 对应局部适应度峰值。\n\n更严谨地，我们可以计算在两个中心点的适应度值。设 $d^{2}=\\|\\mu_{1}-\\mu_{2}\\|^{2}0$。\n$$\nW(\\mu_{1})=A_{1} + A_{2}\\exp(-a_{2}d^{2})\n$$\n$$\nW(\\mu_{2})=A_{2} + A_{1}\\exp(-a_{1}d^{2})\n$$\n由于 $A_{1}=2.1 > A_2=1.4$ 且指数项 $\\exp(-a d^2)$ 总是小于1的正数，因此 $W(\\mu_1)$ 必定大于 $W(\\mu_2)$。所以，全局适应度峰值位于 $(3.2,8.1)$，而局部适应度峰值位于 $(9.5,2.4)$。\n\n因此，正确选项是：全局峰值位于 $(3.2,8.1)$，局部峰值位于 $(9.5,2.4)$。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在识别了静态的峰值之后，下一步是考虑演化动力学。本练习在一个纯粹的加性景观上探讨了“可及路径”的概念，这是一种没有任何基因相互作用（上位效应）的最简单景观类型。通过计算此类路径的数量，可以揭示在平滑、无关联景观上演化的基本属性，并为理解更复杂的场景提供一个重要的基准。",
            "id": "4123166",
            "problem": "考虑一个二元基因型空间 $\\{0,1\\}^{L}$，其中一个基因型由一个长度为 $L$ 的比特串表示，并且 $L$ 维超立方体的顶点即为基因型。在一个加性景观中，基因型 $g = (g_{1},\\dots,g_{L})$ 的适应度由各位点特异性贡献之和给出，\n$$\nF(g) \\;=\\; \\sum_{i=1}^{L} s_{i}\\, g_{i},\n$$\n其中每个 $s_{i} \\in \\mathbb{R}_{0}$ 是一个固定的、不依赖于遗传背景的严格正数，而 $g_{i} \\in \\{0,1\\}$ 表示位点 $i$ 上的等位基因。一条路径是一个基因型序列，起始于 $0^{L} = (0,\\dots,0)$，终止于 $1^{L} = (1,\\dots,1)$，其中每一步都恰好将一个坐标从 $0$ 翻转为 $1$（即没有逆转的单突变步骤）。如果适应度在路径的每一步都严格增加，则定义该路径为可达的。从这些定义和超立方体的组合结构出发，推导从 $0^{L}$ 到 $1^{L}$ 的可达路径总数，作为 $L$ 的函数。将最终答案表示为一个闭式解析表达式。无需四舍五入。",
            "solution": "一条从 $0^L$ 到 $1^L$ 的路径，若无逆向突变，则由 $L$ 个单点突变的序列组成，其中每一步都将一个不同的位点从 $0$ 翻转为 $1$。因此，一条路径由这 $L$ 个突变发生的顺序唯一确定。这相当于对 $L$ 个位点进行排列，因此总共有 $L!$ 条不同的结构路径。\n\n可达性条件要求路径上每一步的适应度都必须严格增加。考虑路径中任意一步，假设它通过将位点 $j$ 从 $0$ 翻转为 $1$ 而将基因型 $g$ 变为 $g'$。适应度的变化 $\\Delta F$ 为：\n$$\n\\Delta F = F(g') - F(g) = \\left(\\sum_{i=1}^{L} s_{i} g'_{i}\\right) - \\left(\\sum_{i=1}^{L} s_{i} g_{i}\\right)\n$$\n由于对于所有 $i \\neq j$，$g'_{i} = g_{i}$，而 $g'_{j}=1$ 且 $g_{j}=0$，因此上式简化为：\n$$\n\\Delta F = s_j g'_j - s_j g_j = s_j(1 - 0) = s_j\n$$\n问题中规定，所有适应度贡献系数 $s_i$ 都是严格正数 ($s_i > 0$)。这意味着，在任何可能的路径上，每一步的适应度变化 $\\Delta F = s_j$ 都必定为正。\n\n因此，所有 $L!$ 条结构上可能的路径都满足适应度严格增加的条件，即所有这些路径都是可达的。\n\n可达路径的总数等于路径的总数，即 $L!$。",
            "answer": "$$\\boxed{L!}$$"
        },
        {
            "introduction": "真实的生物景观很少是完全平滑的；由于上位效应，它们通常是“崎岖的”，具有多个局部峰值。本练习通过提供一个具体的崎岖景观，并要求你为一种特定的演化动力学（贪婪爬山算法）绘制其“吸引盆”，从而模拟一个更真实的情景。这项实践对于理解景观结构如何限制演化、将种群困在次优峰值上以及影响适应性结果的可预测性至关重要。",
            "id": "4123161",
            "problem": "考虑一个有限基因型空间 $\\{0,1\\}^{4}$，其具有标准的汉明图结构，其中两个基因型相邻当且仅当它们只有一个比特位不同。适应度景观是一个函数 $f:\\{0,1\\}^{4}\\to\\mathbb{R}$。定义贪婪爬山动力学如下：从任意状态 $\\mathbf{x}\\in\\{0,1\\}^{4}$ 出发，考虑其汉明距离为1的邻居集合 $N(\\mathbf{x})$。如果存在一个邻居 $\\mathbf{y}\\in N(\\mathbf{x})$ 使得 $f(\\mathbf{y})f(\\mathbf{x})$，则移动到满足 $f(\\mathbf{y})f(\\mathbf{x})$ 的邻居中具有最大适应度的邻居；如果存在多个这样的最大适应度邻居，则选择字典序最小的二进制串（即，将二进制串视为无符号整数进行比较，数值较小的优先）。如果没有邻居具有严格更大的适应度，则停止。局部最大值（峰值）是一个基因型 $\\mathbf{m}$，满足对于其所有邻居 $\\mathbf{y}\\in N(\\mathbf{m})$ 都有 $f(\\mathbf{y}) \\le f(\\mathbf{m})$。\n\n对于一个峰值 $\\mathbf{m}$，其**吸引盆** $B(\\mathbf{m})$ 被定义为所有从其出发的贪婪爬山轨迹最终都会终止于 $\\mathbf{m}$ 的起始基因型的集合。给定以下适应度值，请确定所有峰值的吸引盆大小，并按峰值 $(0110, 1010, 1100, 1111)$ 的字典序排列这些大小。\n\n$f(0000)=7.0$, $f(0001)=7.8$, $f(0010)=10.2$, $f(0011)=9.3$,\n$f(0100)=8.0$, $f(0101)=9.0$, $f(0110)=11.6$, $f(0111)=10.9$,\n$f(1000)=9.5$, $f(1001)=9.2$, $f(1010)=11.8$, $f(1011)=9.7$,\n$f(1100)=12.0$, $f(1101)=10.5$, $f(1110)=11.0$, $f(1111)=12.5$。",
            "solution": "为了确定每个峰值的吸引盆大小，我们首先需要识别所有的局部最大值（峰值）。一个基因型是峰值，如果其所有汉明距离为1的邻居的适应度都比它低。通过检查适应度表，我们发现以下四个峰值：\n- $\\mathbf{m}_1 = 0110$ (适应度 11.6)\n- $\\mathbf{m}_2 = 1010$ (适应度 11.8)\n- $\\mathbf{m}_3 = 1100$ (适应度 12.0)\n- $\\mathbf{m}_4 = 1111$ (适应度 12.5)\n\n接下来，我们为空间中的全部16个基因型模拟贪婪爬山动力学，以确定它们各自终止于哪个峰值。轨迹如下：\n\n1.  **吸引盆 $B(\\mathbf{m}_1 = 0110)$**:\n    - $0110 \\to 0110$ (本身是峰值)\n    - $B(0110) = \\{0110\\}$。大小为 1。\n\n2.  **吸引盆 $B(\\mathbf{m}_2 = 1010)$**:\n    - $1010 \\to 1010$ (本身是峰值)\n    - $0000(7.0) \\to 0010(10.2) \\to 1010(11.8)$\n    - $0010(10.2) \\to 1010(11.8)$\n    - $B(1010) = \\{0000, 0010, 1010\\}$。大小为 3。\n\n3.  **吸引盆 $B(\\mathbf{m}_3 = 1100)$**:\n    - $1100 \\to 1100$ (本身是峰值)\n    - $0100(8.0) \\to 1100(12.0)$\n    - $1000(9.5) \\to 1100(12.0)$\n    - $B(1100) = \\{0100, 1000, 1100\\}$。大小为 3。\n\n4.  **吸引盆 $B(\\mathbf{m}_4 = 1111)$**:\n    - $1111 \\to 1111$ (本身是峰值)\n    - $0001(7.8) \\to 0101(9.0) \\to 1101(10.5) \\to 1111(12.5)$\n    - $0011(9.3) \\to 0111(10.9) \\to 1111(12.5)$\n    - $0101(9.0) \\to 1101(10.5) \\to 1111(12.5)$\n    - $0111(10.9) \\to 1111(12.5)$\n    - $1001(9.2) \\to 1101(10.5) \\to 1111(12.5)$\n    - $1011(9.7) \\to 1111(12.5)$\n    - $1101(10.5) \\to 1111(12.5)$\n    - $1110(11.0) \\to 1111(12.5)$\n    - $B(1111) = \\{0001, 0011, 0101, 0111, 1001, 1011, 1101, 1110, 1111\\}$。大小为 9。\n\n总共有 $1+3+3+9 = 16$ 个基因型，覆盖了整个空间。按照峰值字典序 $(0110, 1010, 1100, 1111)$ 排列，其吸引盆大小分别为 $(1, 3, 3, 9)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  3  3  9\n\\end{pmatrix}\n}\n$$"
        }
    ]
}