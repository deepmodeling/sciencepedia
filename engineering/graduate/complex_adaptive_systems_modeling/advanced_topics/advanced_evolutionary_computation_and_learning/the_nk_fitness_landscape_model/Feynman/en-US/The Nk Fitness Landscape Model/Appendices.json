{
    "hands_on_practices": [
        {
            "introduction": "Before delving into the statistical properties of large, abstract landscapes, it is essential to build a concrete understanding of how genetic interactions, or epistasis, function at a small scale. This practice guides you through the process of constructing a minimal $N=2, K=1$ fitness landscape from its component parts. By explicitly calculating the fitness of all possible genotypes, you will gain a hands-on feel for how interactions between loci can create complex fitness patterns, such as sign and reciprocal sign epistasis, which are fundamental to the ruggedness of evolutionary paths. ",
            "id": "4148370",
            "problem": "Consider the N-K model (NK) of fitness landscapes in complex adaptive systems, where a genotype is represented by a binary string of length $N$, and the fitness contribution of each locus depends on its own state and the states of $K$ interacting loci. For $N=2$ and $K=1$, assume each locus interacts with the other. Let the total fitness be the arithmetic mean of locus-specific contributions. Formally, for genotype $\\mathbf{x}=(x_{1},x_{2})\\in\\{0,1\\}^{2}$, define the fitness as\n$$\nW(\\mathbf{x})=\\frac{1}{2}\\left[w_{1}(x_{1},x_{2})+w_{2}(x_{2},x_{1})\\right],\n$$\nwhere $w_{1}$ is the contribution of locus $1$, and $w_{2}$ is the contribution of locus $2$.\n\nConstruct two explicit NK instances by specifying the contribution tables $w_{1}$ and $w_{2}$ for all allele combinations. For Instance A, use\n$$\nw_{1}(0,0)=2.0,\\quad w_{1}(1,0)=3.2,\\quad w_{1}(0,1)=3.5,\\quad w_{1}(1,1)=2.6,\n$$\n$$\nw_{2}(0,0)=2.0,\\quad w_{2}(0,1)=3.5,\\quad w_{2}(1,0)=2.8,\\quad w_{2}(1,1)=3.4.\n$$\nFor Instance B, use\n$$\nw_{1}(0,0)=3.8,\\quad w_{1}(1,0)=2.7,\\quad w_{1}(0,1)=2.9,\\quad w_{1}(1,1)=4.7,\n$$\n$$\nw_{2}(0,0)=4.2,\\quad w_{2}(0,1)=2.1,\\quad w_{2}(1,0)=2.3,\\quad w_{2}(1,1)=4.3.\n$$\n\nTasks:\n1. Using only the above model definition, compute the fitnesses $W(0,0)$, $W(1,0)$, $W(0,1)$, and $W(1,1)$ for each instance.\n2. Starting from the definition that sign epistasis occurs when the sign of the fitness effect of a single-locus mutation depends on the state at the other locus, and reciprocal sign epistasis occurs when both loci exhibit such sign changes with respect to each other, determine which type of epistasis each instance exhibits.\n3. Quantify non-additivity by the standard epistasis deviation\n$$\n\\varepsilon \\equiv W(0,0)+W(1,1)-W(0,1)-W(1,0).\n$$\nCompute $\\varepsilon$ for each instance.\n\nReport the ordered pair $\\left(\\varepsilon_{\\text{A}},\\varepsilon_{\\text{B}}\\right)$ as a single row matrix in exact form. No rounding is required and no units are involved.",
            "solution": "The problem will first be validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Model**: N-K model (NK)\n- **Genotype**: Binary string of length $N=2$, $\\mathbf{x}=(x_{1},x_{2})\\in\\{0,1\\}^{2}$\n- **Interactions**: $K=1$, each locus interacts with the other.\n- **Fitness function**: $W(\\mathbf{x})=\\frac{1}{2}\\left[w_{1}(x_{1},x_{2})+w_{2}(x_{2},x_{1})\\right]$\n- **Instance A contributions**:\n  $w_{1}(0,0)=2.0$, $w_{1}(1,0)=3.2$, $w_{1}(0,1)=3.5$, $w_{1}(1,1)=2.6$\n  $w_{2}(0,0)=2.0$, $w_{2}(0,1)=3.5$, $w_{2}(1,0)=2.8$, $w_{2}(1,1)=3.4$\n- **Instance B contributions**:\n  $w_{1}(0,0)=3.8$, $w_{1}(1,0)=2.7$, $w_{1}(0,1)=2.9$, $w_{1}(1,1)=4.7$\n  $w_{2}(0,0)=4.2$, $w_{2}(0,1)=2.1$, $w_{2}(1,0)=2.3$, $w_{2}(1,1)=4.3$\n- **Task 1**: Compute $W(0,0)$, $W(1,0)$, $W(0,1)$, $W(1,1)$ for each instance.\n- **Task 2**: Determine the type of epistasis (sign epistasis, reciprocal sign epistasis).\n- **Task 3**: Compute the epistasis deviation $\\varepsilon \\equiv W(0,0)+W(1,1)-W(0,1)-W(1,0)$ for each instance.\n- **Final Output**: Report the ordered pair $\\left(\\varepsilon_{\\text{A}},\\varepsilon_{\\text{B}}\\right)$ as a single row matrix.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it is based on the standard NK model developed by Stuart Kauffman, a cornerstone of complex adaptive systems theory. The definitions of fitness, epistasis, and the mathematical framework are all standard and well-established in the field of theoretical biology and evolutionary computation. The problem is well-posed, providing all necessary numerical data and explicit formulas to perform the required calculations. The language is objective and precise. The problem is self-contained and consistent, with no contradictions or missing information. There are no violations of scientific principles or logic.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A solution will be furnished.\n\n### Solution Derivation\n\nThe solution proceeds by executing the three tasks specified in the problem statement.\n\n#### Task 1: Fitness Computation\n\nThe total fitness for a genotype $\\mathbf{x}=(x_1, x_2)$ is given by $W(\\mathbf{x})=\\frac{1}{2}\\left[w_{1}(x_{1},x_{2})+w_{2}(x_{2},x_{1})\\right]$. We apply this formula to all four possible genotypes for both Instance A and Instance B.\n\n**Instance A:**\nThe fitness values for the four genotypes are:\n$W_A(0,0) = \\frac{1}{2}\\left[w_{1}(0,0) + w_{2}(0,0)\\right] = \\frac{1}{2}(2.0 + 2.0) = \\frac{1}{2}(4.0) = 2.0$\n$W_A(1,0) = \\frac{1}{2}\\left[w_{1}(1,0) + w_{2}(0,1)\\right] = \\frac{1}{2}(3.2 + 3.5) = \\frac{1}{2}(6.7) = 3.35$\n$W_A(0,1) = \\frac{1}{2}\\left[w_{1}(0,1) + w_{2}(1,0)\\right] = \\frac{1}{2}(3.5 + 2.8) = \\frac{1}{2}(6.3) = 3.15$\n$W_A(1,1) = \\frac{1}{2}\\left[w_{1}(1,1) + w_{2}(1,1)\\right] = \\frac{1}{2}(2.6 + 3.4) = \\frac{1}{2}(6.0) = 3.0$\n\n**Instance B:**\nThe fitness values for the four genotypes are:\n$W_B(0,0) = \\frac{1}{2}\\left[w_{1}(0,0) + w_{2}(0,0)\\right] = \\frac{1}{2}(3.8 + 4.2) = \\frac{1}{2}(8.0) = 4.0$\n$W_B(1,0) = \\frac{1}{2}\\left[w_{1}(1,0) + w_{2}(0,1)\\right] = \\frac{1}{2}(2.7 + 2.1) = \\frac{1}{2}(4.8) = 2.4$\n$W_B(0,1) = \\frac{1}{2}\\left[w_{1}(0,1) + w_{2}(1,0)\\right] = \\frac{1}{2}(2.9 + 2.3) = \\frac{1}{2}(5.2) = 2.6$\n$W_B(1,1) = \\frac{1}{2}\\left[w_{1}(1,1) + w_{2}(1,1)\\right] = \\frac{1}{2}(4.7 + 4.3) = \\frac{1}{2}(9.0) = 4.5$\n\n#### Task 2: Epistasis Analysis\n\nSign epistasis is present if the fitness effect of a mutation at one locus changes sign depending on the allele at another locus. Reciprocal sign epistasis occurs when this is true for mutations at both loci.\n\n**Instance A:**\nEffect of mutation at locus $1$ ($0 \\to 1$):\n- On background $x_2=0$: $\\Delta W_{1|0} = W_A(1,0) - W_A(0,0) = 3.35 - 2.0 = 1.35$ (positive)\n- On background $x_2=1$: $\\Delta W_{1|1} = W_A(1,1) - W_A(0,1) = 3.0 - 3.15 = -0.15$ (negative)\nSince the signs differ, sign epistasis is present for locus $1$.\n\nEffect of mutation at locus $2$ ($0 \\to 1$):\n- On background $x_1=0$: $\\Delta W_{2|0} = W_A(0,1) - W_A(0,0) = 3.15 - 2.0 = 1.15$ (positive)\n- On background $x_1=1$: $\\Delta W_{2|1} = W_A(1,1) - W_A(1,0) = 3.0 - 3.35 = -0.35$ (negative)\nSince the signs differ, sign epistasis is present for locus $2$.\nAs both loci exhibit sign epistasis, **Instance A demonstrates reciprocal sign epistasis**.\n\n**Instance B:**\nEffect of mutation at locus $1$ ($0 \\to 1$):\n- On background $x_2=0$: $\\Delta W_{1|0} = W_B(1,0) - W_B(0,0) = 2.4 - 4.0 = -1.6$ (negative)\n- On background $x_2=1$: $\\Delta W_{1|1} = W_B(1,1) - W_B(0,1) = 4.5 - 2.6 = 1.9$ (positive)\nSince the signs differ, sign epistasis is present for locus $1$.\n\nEffect of mutation at locus $2$ ($0 \\to 1$):\n- On background $x_1=0$: $\\Delta W_{2|0} = W_B(0,1) - W_B(0,0) = 2.6 - 4.0 = -1.4$ (negative)\n- On background $x_1=1$: $\\Delta W_{2|1} = W_B(1,1) - W_B(1,0) = 4.5 - 2.4 = 2.1$ (positive)\nSince the signs differ, sign epistasis is present for locus $2$.\nAs both loci exhibit sign epistasis, **Instance B also demonstrates reciprocal sign epistasis**.\n\n#### Task 3: Epistasis Deviation Calculation\n\nThe epistasis deviation $\\varepsilon$ is computed using the formula $\\varepsilon = W(0,0) + W(1,1) - W(0,1) - W(1,0)$.\n\n**Instance A:**\nUsing the fitness values computed in Task 1:\n$\\varepsilon_A = W_A(0,0) + W_A(1,1) - W_A(0,1) - W_A(1,0)$\n$\\varepsilon_A = 2.0 + 3.0 - 3.15 - 3.35 = 5.0 - 6.5 = -1.5$\n\n**Instance B:**\nUsing the fitness values computed in Task 1:\n$\\varepsilon_B = W_B(0,0) + W_B(1,1) - W_B(0,1) - W_B(1,0)$\n$\\varepsilon_B = 4.0 + 4.5 - 2.6 - 2.4 = 8.5 - 5.0 = 3.5$\n\nThe problem requires reporting the ordered pair $(\\varepsilon_A, \\varepsilon_B)$. This is $(-1.5, 3.5)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -1.5 & 3.5 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "To understand the rugged landscapes produced by epistasis, we must first master the baseline case: the purely additive landscape where $K=0$. This exercise involves a foundational derivation of the landscape's global statistical properties—its mean and variance—from the properties of the individual locus contributions. This practice is crucial for developing the probabilistic reasoning required to analyze the NK model and demonstrates how the law of large numbers smooths the overall fitness distribution in the absence of genetic interactions. ",
            "id": "4148453",
            "problem": "Consider the N-K fitness landscape model (NK), specifically the additive case with no epistatic interactions, meaning $K=0$. There are $N$ loci, each with binary alleles in $\\{0,1\\}$. For each locus $i \\in \\{1,\\dots,N\\}$, define a lookup function $f_i:\\{0,1\\}\\to \\mathbb{R}$. Assume the following generative assumptions hold:\n- For each $i$, the two table entries $f_i(0)$ and $f_i(1)$ are independent and identically distributed draws from a common distribution with mean $\\mu$ and variance $\\sigma^{2}$.\n- Across loci $i$, all table entries are mutually independent.\n- A genotype $X=(X_1,\\dots,X_N)\\in\\{0,1\\}^N$ is sampled uniformly at random and independently of all lookup table entries.\n\nDefine the fitness of a genotype $x\\in\\{0,1\\}^N$ in the additive case by\n$$\nF(x) \\equiv \\frac{1}{N}\\sum_{i=1}^{N} f_i(x_i).\n$$\nLet $F \\equiv F(X)$ denote the fitness of the uniformly random genotype $X$ under a randomly generated additive landscape as described above. Using only the core probabilistic definitions of expectation, variance, linearity of expectation, variance of sums of independent random variables, and the law of total expectation and variance, derive closed-form expressions for the mean $\\mathbb{E}[F]$ and variance $\\mathrm{Var}(F)$ taken over the joint randomness of the genotype and the landscape.\n\nProvide your final answer as a single row matrix in the form $\\begin{pmatrix}\\mathbb{E}[F] & \\mathrm{Var}(F)\\end{pmatrix}$. Do not approximate or round; your answer must be an exact symbolic expression in terms of $\\mu$, $\\sigma^{2}$, and $N$.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and internally consistent. It presents a standard theoretical exercise in the statistical analysis of fitness landscapes. We proceed with the solution.\n\nThe random variable of interest is the fitness $F = F(X)$, defined as\n$$\nF \\equiv \\frac{1}{N}\\sum_{i=1}^{N} f_i(X_i)\n$$\nThe randomness in $F$ arises from two independent sources:\n$1.$ The random generation of the landscape, which consists of the set of all lookup table entries $\\{f_i(a) \\mid i \\in \\{1,\\dots,N\\}, a \\in \\{0,1\\}\\}$. We denote the expectation and variance over this randomness with a subscript $\\mathcal{L}$. Each $f_i(a)$ is an independent and identically distributed random variable with mean $\\mathbb{E}_{\\mathcal{L}}[f_i(a)] = \\mu$ and variance $\\mathrm{Var}_{\\mathcal{L}}(f_i(a)) = \\sigma^2$.\n$2.$ The uniform random sampling of a genotype $X=(X_1,\\dots,X_N)$ from the space $\\{0,1\\}^N$. We denote the expectation and variance over this randomness with a subscript $X$. The uniform sampling implies that for each locus $i$, $\\mathbb{P}(X_i = 0) = \\mathbb{P}(X_i = 1) = \\frac{1}{2}$, and the variables $X_1, \\dots, X_N$ are mutually independent.\n\nWe seek the total expectation $\\mathbb{E}[F]$ and total variance $\\mathrm{Var}(F)$ over the joint probability space of landscapes and genotypes.\n\n**Calculation of the Mean $\\mathbb{E}[F]$**\n\nWe shall employ the law of total expectation, also known as the law of iterated expectations: $\\mathbb{E}[Y] = \\mathbb{E}_A[\\mathbb{E}_B[Y|A]]$. We can choose to condition on either the landscape or the genotype first. Conditioning on the genotype $X$ proves to be more direct.\n$$\n\\mathbb{E}[F] = \\mathbb{E}_{X}[\\mathbb{E}_{\\mathcal{L}}[F | X]]\n$$\nFirst, we compute the inner expectation, which is the expected fitness of a fixed genotype $x \\in \\{0,1\\}^N$ over the random ensemble of landscapes.\n$$\n\\mathbb{E}_{\\mathcal{L}}[F | X=x] = \\mathbb{E}_{\\mathcal{L}}\\left[\\frac{1}{N}\\sum_{i=1}^{N} f_i(x_i)\\right]\n$$\nBy the linearity of expectation, we can move the expectation operator inside the sum:\n$$\n\\mathbb{E}_{\\mathcal{L}}[F | X=x] = \\frac{1}{N}\\sum_{i=1}^{N} \\mathbb{E}_{\\mathcal{L}}[f_i(x_i)]\n$$\nAccording to the problem statement, for any locus $i$ and any allele choice $x_i \\in \\{0,1\\}$, the term $f_i(x_i)$ is a random variable drawn from a distribution with mean $\\mu$. Thus, $\\mathbb{E}_{\\mathcal{L}}[f_i(x_i)] = \\mu$.\nSubstituting this into the sum gives:\n$$\n\\mathbb{E}_{\\mathcal{L}}[F | X=x] = \\frac{1}{N}\\sum_{i=1}^{N} \\mu = \\frac{1}{N}(N\\mu) = \\mu\n$$\nThe conditional expectation of $F$ given a specific genotype $x$ is simply $\\mu$, a constant value independent of the genotype itself.\n\nNow, we compute the outer expectation over the random choice of genotype $X$:\n$$\n\\mathbb{E}[F] = \\mathbb{E}_{X}[\\mu] = \\mu\n$$\nThe expectation of a constant is the constant itself. Thus, the mean fitness is $\\mu$.\n\n**Calculation of the Variance $\\mathrm{Var}(F)$**\n\nWe use the law of total variance, which states:\n$$\n\\mathrm{Var}(F) = \\mathbb{E}_{X}[\\mathrm{Var}_{\\mathcal{L}}(F | X)] + \\mathrm{Var}_{X}(\\mathbb{E}_{\\mathcal{L}}[F | X])\n$$\nLet's analyze each of the two terms on the right-hand side.\n\nThe second term, $\\mathrm{Var}_{X}(\\mathbb{E}_{\\mathcal{L}}[F | X])$, is the variance of the conditional expectation we calculated previously. Since we found that $\\mathbb{E}_{\\mathcal{L}}[F | X] = \\mu$, a constant, its variance with respect to $X$ is zero:\n$$\n\\mathrm{Var}_{X}(\\mathbb{E}_{\\mathcal{L}}[F | X]) = \\mathrm{Var}_{X}(\\mu) = 0\n$$\nThis simplifies the law of total variance to:\n$$\n\\mathrm{Var}(F) = \\mathbb{E}_{X}[\\mathrm{Var}_{\\mathcal{L}}(F | X)]\n$$\nNow we must compute the inner term, $\\mathrm{Var}_{\\mathcal{L}}(F | X=x)$, which is the variance of fitness for a fixed genotype $x$, taken over the ensemble of landscapes.\n$$\n\\mathrm{Var}_{\\mathcal{L}}(F | X=x) = \\mathrm{Var}_{\\mathcal{L}}\\left(\\frac{1}{N}\\sum_{i=1}^{N} f_i(x_i)\\right)\n$$\nUsing the variance property $\\mathrm{Var}(cY) = c^2\\mathrm{Var}(Y)$ with $c = \\frac{1}{N}$:\n$$\n\\mathrm{Var}_{\\mathcal{L}}(F | X=x) = \\frac{1}{N^2}\\mathrm{Var}_{\\mathcal{L}}\\left(\\sum_{i=1}^{N} f_i(x_i)\\right)\n$$\nThe terms in the sum, $f_1(x_1), f_2(x_2), \\dots, f_N(x_N)$, are random variables corresponding to fitness contributions from different loci. By the problem's generative assumptions, all table entries are mutually independent. Since each $f_i(x_i)$ is an entry for a distinct locus $i$, these variables are mutually independent. For a sum of independent random variables, the variance of the sum is the sum of the variances:\n$$\n\\mathrm{Var}_{\\mathcal{L}}\\left(\\sum_{i=1}^{N} f_i(x_i)\\right) = \\sum_{i=1}^{N} \\mathrm{Var}_{\\mathcal{L}}(f_i(x_i))\n$$\nFor any locus $i$ and any allele choice $x_i \\in \\{0,1\\}$, the term $f_i(x_i)$ is a random variable drawn from a distribution with variance $\\sigma^2$. Therefore, $\\mathrm{Var}_{\\mathcal{L}}(f_i(x_i)) = \\sigma^2$. Substituting this into the sum:\n$$\n\\sum_{i=1}^{N} \\mathrm{Var}_{\\mathcal{L}}(f_i(x_i)) = \\sum_{i=1}^{N} \\sigma^2 = N\\sigma^2\n$$\nPutting it all together for the conditional variance:\n$$\n\\mathrm{Var}_{\\mathcal{L}}(F | X=x) = \\frac{1}{N^2}(N\\sigma^2) = \\frac{\\sigma^2}{N}\n$$\nThis result is also a constant, independent of the particular genotype $x$.\n\nFinally, we compute the outer expectation over the random genotype $X$:\n$$\n\\mathrm{Var}(F) = \\mathbb{E}_{X}\\left[\\frac{\\sigma^2}{N}\\right] = \\frac{\\sigma^2}{N}\n$$\nThe expectation of a constant is the constant itself. Thus, the total variance of the fitness is $\\frac{\\sigma^2}{N}$.\n\nIn summary, the mean of the fitness distribution is $\\mu$ and the variance is $\\frac{\\sigma^2}{N}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\mu & \\frac{\\sigma^{2}}{N}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Bridging theory and application is a cornerstone of complex systems modeling. This computational exercise challenges you to implement the NK model and numerically verify key theoretical predictions about its structure, specifically concerning the number of local optima. By simulating the two extreme cases—the perfectly smooth additive landscape ($K=0$) and the maximally rugged \"House-of-Cards\" landscape ($K=N-1$)—you will develop an intuitive and quantitative grasp of how the epistasis parameter $K$ directly controls the ruggedness and navigability of the fitness landscape. ",
            "id": "4148406",
            "problem": "Consider the $N$-$K$ fitness landscape model (NK), where a genotype is a binary string of length $N$, and the fitness $F(\\mathbf{x})$ of genotype $\\mathbf{x} \\in \\{0,1\\}^N$ is the average of $N$ local contribution functions, each depending on $K+1$ bits. For each locus $i \\in \\{0,\\dots,N-1\\}$, let $\\mathcal{N}_i$ be its neighborhood of size $K+1$ (we will use adjacent neighborhoods on a ring: $\\mathcal{N}_i = \\{i,i+1,\\dots,i+K\\}$ with indices modulo $N$). Each contribution function $f_i:\\{0,1\\}^{K+1}\\to \\mathbb{R}$ is drawn independently from a continuous distribution. The fitness of $\\mathbf{x}$ is then defined as\n$$\nF(\\mathbf{x}) = \\frac{1}{N}\\sum_{i=0}^{N-1} f_i\\left(\\mathbf{x}_{\\mathcal{N}_i}\\right),\n$$\nwhere $\\mathbf{x}_{\\mathcal{N}_i}$ denotes the substring of $\\mathbf{x}$ restricted to the indices in $\\mathcal{N}_i$ in a fixed order.\n\nA genotype $\\mathbf{x}$ is a local maximum if $F(\\mathbf{x}) > F(\\mathbf{y})$ for all $\\mathbf{y}$ at Hamming distance $1$ from $\\mathbf{x}$ (i.e., all single-bit neighbors).\n\nYour task is to write a program that, for small $N$ and $K$, enumerates all genotypes and local maxima for specific instances and verifies numerically the theoretical predictions derived from first principles. You must implement the following test suite, each case producing a quantified result.\n\nDefinitions and constraints:\n- Genotype enumeration must include all $2^N$ binary strings.\n- Neighborhoods must be adjacent on a ring as described for the $N$-$K$ model.\n- Random values must be drawn from the continuous uniform distribution on $[0,1]$ using a fixed seed per test to ensure reproducibility.\n- In the special House-of-Cards limit where $K=N-1$, treat fitness values $F(\\mathbf{x})$ as independent identically distributed continuous random variables per genotype $\\mathbf{x}$.\n\nTest suite:\n1. Additive landscape case ($K=0$):\n   - Parameters: $N=5$, $K=0$, random seed $s=12345$.\n   - Construction: For each locus $i$, draw $f_i(0)$ and $f_i(1)$ independently and set $F(\\mathbf{x}) = \\frac{1}{N}\\sum_{i=0}^{N-1} f_i(x_i)$.\n   - Output specification: Return a list containing the integer count of local maxima found for the single instance, the integer theoretical prediction for the additive case, and a boolean indicating equality.\n\n2. House-of-Cards limit:\n   - Parameters: $N=8$, $K=7$, number of independent instances $R=3000$, random seed $s=67890$.\n   - Construction: For each instance, assign $F(\\mathbf{x})$ for all $2^N$ genotypes as independent uniform random draws on $[0,1]$, then count local maxima by full enumeration and neighbor comparison.\n   - Output specification: Return a list containing the float average fraction of local maxima across the $R$ instances, the float theoretical fraction, and the float absolute difference between the empirical average and the theoretical value.\n\n3. House-of-Cards limit (small boundary case):\n   - Parameters: $N=2$, $K=1$, number of independent instances $R=50000$, random seed $s=13579$.\n   - Construction: As in the House-of-Cards case, assign $F(\\mathbf{x})$ independently for each genotype and instance, count local maxima, and average the fraction across instances.\n   - Output specification: Return a list containing the float average fraction of local maxima across the $R$ instances, the float theoretical fraction, and the float absolute difference.\n\n4. Additive landscape case (trivial boundary):\n   - Parameters: $N=1$, $K=0$, random seed $s=24680$.\n   - Construction: As in the additive case, draw $f_0(0)$ and $f_0(1)$ and set $F(\\mathbf{x}) = f_0(x_0)$.\n   - Output specification: Return a list containing the integer count of local maxima, the integer theoretical prediction for the additive case, and a boolean indicating equality.\n\nTheoretical predictions to be verified numerically:\n- For the additive landscape ($K=0$), predict the exact number of local maxima.\n- For the House-of-Cards limit ($K=N-1$), predict the expected fraction of local maxima and the expected number as a function of $N$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s output is itself a list in the specified format above. For example: \"[[result_case1],[result_case2],[result_case3],[result_case4]]\".\n- All returned values must be of the following types: boolean, integer, float, or a list of these types. No other output is permitted.",
            "solution": "The user-provided problem has been validated and is determined to be a well-posed, scientifically grounded problem from the field of complex adaptive systems. It requires the numerical verification of theoretical properties of the NK fitness landscape model. The problem statement provides all necessary definitions, parameters, and constraints to proceed with a unique and meaningful solution.\n\nThe solution is presented in two parts: first, a derivation of the theoretical predictions for the number of local maxima in the specified model limits, and second, a description of the computational algorithms used to generate the numerical results for comparison.\n\n**Theoretical Predictions**\n\nThe NK model defines the fitness of a genotype $\\mathbf{x} \\in \\{0,1\\}^N$ as the average of $N$ local contribution functions, $F(\\mathbf{x}) = \\frac{1}{N}\\sum_{i=0}^{N-1} f_i\\left(\\mathbf{x}_{\\mathcal{N}_i}\\right)$. A genotype $\\mathbf{x}$ is a local maximum if its fitness is strictly greater than that of all its $N$ single-bit-flip neighbors. We analyze the two special cases requested.\n\n1.  **Additive Landscape ($K=0$)**\n\n    When the epistasis parameter $K=0$, the neighborhood of each locus $i$ is just the locus itself, $\\mathcal{N}_i = \\{i\\}$. The fitness function simplifies to an additive form:\n    $$F(\\mathbf{x}) = \\frac{1}{N}\\sum_{i=0}^{N-1} f_i(x_i)$$\n    where $f_i(x_i)$ is the fitness contribution from allele $x_i$ at locus $i$.\n\n    Let $\\mathbf{y}^{(j)}$ be the genotype obtained by flipping bit $j$ of $\\mathbf{x}$. The fitness difference is:\n    $$F(\\mathbf{x}) - F(\\mathbf{y}^{(j)}) = \\frac{1}{N}\\left(f_j(x_j) - f_j(1-x_j)\\right)$$\n    For $\\mathbf{x}$ to be a local maximum, it must satisfy $F(\\mathbf{x}) > F(\\mathbf{y}^{(j)})$ for all $j \\in \\{0, \\dots, N-1\\}$. This implies that for each locus $j$, the condition $f_j(x_j) > f_j(1-x_j)$ must hold.\n\n    For each locus $j$, the values $f_j(0)$ and $f_j(1)$ are drawn from a continuous distribution. Thus, with probability $1$, one value is greater than the other.\n    - If $f_j(0) > f_j(1)$, then the condition is satisfied only if $x_j=0$.\n    - If $f_j(1) > f_j(0)$, then the condition is satisfied only if $x_j=1$.\n\n    In either case, for each locus $j$, there is a unique allele value that maximizes the local fitness contribution $f_j$. Since the condition must hold for all $N$ loci independently, there is one and only one genotype that satisfies all $N$ conditions simultaneously. This genotype is constructed by choosing the superior allele at each locus.\n\n    Therefore, for the additive case ($K=0$) with fitness contributions drawn from a continuous distribution, there is exactly $1$ local maximum.\n\n2.  **House-of-Cards Limit ($K=N-1$)**\n\n    In the $K=N-1$ limit, which is known as the House-of-Cards (HoC) model, the fitness values $F(\\mathbf{x})$ for all $2^N$ genotypes are assumed to be independent and identically distributed (i.i.d.) random variables. The problem specifies drawing them from a continuous uniform distribution on $[0,1]$.\n\n    For a given genotype $\\mathbf{x}$ to be a local maximum, its fitness $F(\\mathbf{x})$ must be greater than the fitness values of all its $N$ neighbors. Let the neighbors be $\\mathbf{y}_1, \\dots, \\mathbf{y}_N$. The condition is $F(\\mathbf{x}) > F(\\mathbf{y}_k)$ for all $k \\in \\{1, \\dots, N\\}$.\n\n    The set of fitness values $\\{F(\\mathbf{x}), F(\\mathbf{y}_1), \\dots, F(\\mathbf{y}_N)\\}$ consists of $N+1$ i.i.d. samples from a continuous distribution. Due to the i.i.d. property, any permutation of the ranks of these values is equally likely. The probability that any specific value (in this case, $F(\\mathbf{x})$) is the largest in the set is therefore $\\frac{1}{N+1}$.\n\n    This represents the probability that any single genotype is a local maximum. By the linearity of expectation, the expected number of local maxima over the entire landscape of $2^N$ genotypes is the total number of genotypes multiplied by this probability:\n    $$E[\\text{Number of Local Maxima}] = 2^N \\times \\frac{1}{N+1} = \\frac{2^N}{N+1}$$\n    The expected *fraction* of genotypes that are local maxima is simply this probability:\n    $$E[\\text{Fraction of Local Maxima}] = \\frac{1}{N+1}$$\n    Our numerical simulations for cases $2$ and $3$ will verify this theoretical fraction. For $N=8$, the theoretical fraction is $\\frac{1}{9}$. For $N=2$, it is $\\frac{1}{3}$.\n\n**Algorithmic Design and Implementation**\n\nThe verification is performed by implementing two distinct simulation procedures corresponding to the two model variants.\n\n**Additive Landscape ($K=0$) Simulation (Cases 1 and 4)**\n\n1.  **Initialization**: For a given $N$ and random seed $s$, a random number generator is initialized.\n2.  **Fitness Landscape Construction**: A fitness contribution table of size $N \\times 2$ is created. Each entry $f_{i,b}$ (for locus $i$ and allele $b \\in \\{0, 1\\}$) is an independent draw from $U[0,1]$.\n3.  **Fitness Evaluation**: The total landscape of $2^N$ genotypes is enumerated. For each genotype $\\mathbf{x}=(x_0, \\dots, x_{N-1})$, its fitness is computed as $F(\\mathbf{x}) = \\frac{1}{N}\\sum_{i=0}^{N-1} f_{i, x_i}$. The fitness values for all genotypes are stored.\n4.  **Local Maxima Identification**: Each genotype $\\mathbf{x}$ is tested for local optimality. Its fitness $F(\\mathbf{x})$ is compared to the pre-computed fitness values of its $N$ neighbors. If $F(\\mathbf{x})$ is strictly greater than all neighbor fitnesses, a counter for local maxima is incremented.\n5.  **Output**: The procedure returns a list containing the final integer count of local maxima, the theoretical prediction of $1$, and a boolean indicating whether the empirical count matches the theory.\n\n**House-of-Cards ($K=N-1$) Simulation (Cases 2 and 3)**\n\n1.  **Initialization**: For given $N$, number of repetitions $R$, and seed $s$, a random number generator is initialized. An empty list is prepared to store the fraction of maxima from each instance.\n2.  **Monte Carlo Loop**: The simulation iterates $R$ times. In each iteration:\n    a.  **Fitness Landscape Construction**: An array of $2^N$ fitness values is generated by drawing i.i.d. samples from $U[0,1]$. Each genotype, represented by its integer index from $0$ to $2^N-1$, is assigned one of these random fitness values.\n    b.  **Local Maxima Identification**: The algorithm iterates through each genotype index $i \\in \\{0, \\dots, 2^N-1\\}$. The fitness $F_i$ is compared to the fitness of its $N$ neighbors. A neighbor of genotype $i$ is identified by the index $i \\oplus 2^j$ (bitwise XOR), for $j \\in \\{0, \\dots, N-1\\}$. If $F_i$ is the strict maximum among this set, a counter for the current instance is incremented.\n    c.  **Fraction Calculation**: The fraction of local maxima for the instance is calculated as (count / $2^N$) and stored.\n3.  **Result Aggregation**: After all $R$ instances are completed, the average of the stored fractions is computed.\n4.  **Output**: The procedure returns a list containing the average fraction of local maxima, the theoretical fraction $\\frac{1}{N+1}$, and the absolute difference between these two values.\n\nThe provided Python code implements these algorithms to generate the results for the four test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve_additive_case(N, seed):\n    \"\"\"\n    Solves for the K=0 additive landscape case.\n    - Constructs the landscape based on per-locus contributions.\n    - Enumerates all genotypes and finds local maxima.\n    - Returns the empirical count, theoretical count, and a boolean for equality.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    \n    # f_table[i, b] is the fitness contribution f_i(b) for locus i and bit b.\n    f_table = rng.uniform(size=(N, 2))\n    \n    num_genotypes = 1 << N\n    genotypes = []\n    # Generate all 2^N genotypes as tuples of (0,1)\n    for i in range(num_genotypes):\n        genotype = tuple((i >> (N - 1 - j)) & 1 for j in range(N))\n        genotypes.append(genotype)\n\n    # Calculate and store fitness for all genotypes\n    fitness_map = {}\n    for g in genotypes:\n        fitness = np.sum(f_table[i, g[i]] for i in range(N)) / N\n        fitness_map[g] = fitness\n\n    # Count local maxima\n    local_maxima_count = 0\n    for g in genotypes:\n        current_fitness = fitness_map[g]\n        is_local_max = True\n        for i in range(N):\n            neighbor_list = list(g)\n            neighbor_list[i] = 1 - neighbor_list[i]\n            neighbor = tuple(neighbor_list)\n            if current_fitness <= fitness_map[neighbor]:\n                is_local_max = False\n                break\n        if is_local_max:\n            local_maxima_count += 1\n            \n    theoretical_count = 1\n    return [local_maxima_count, theoretical_count, local_maxima_count == theoretical_count]\n\ndef solve_hoc_case(N, R, seed):\n    \"\"\"\n    Solves for the K=N-1 House-of-Cards limit case.\n    - Runs R independent simulations.\n    - In each simulation, fitness values are i.i.d. draws.\n    - Returns the average fraction of maxima, theoretical fraction, and absolute difference.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    num_genotypes = 1 << N\n    \n    fractions = []\n    for _ in range(R):\n        # For each instance, generate a new random landscape\n        fitness_values = rng.uniform(size=num_genotypes)\n        \n        instance_maxima_count = 0\n        for i in range(num_genotypes):\n            current_fitness = fitness_values[i]\n            is_local_max = True\n            for j in range(N):\n                # Neighbor's index is found by flipping the j-th bit\n                neighbor_idx = i ^ (1 << j)\n                if current_fitness <= fitness_values[neighbor_idx]:\n                    is_local_max = False\n                    break\n            if is_local_max:\n                instance_maxima_count += 1\n        \n        fractions.append(instance_maxima_count / num_genotypes)\n\n    avg_fraction = np.mean(fractions)\n    theoretical_fraction = 1.0 / (N + 1)\n    abs_diff = np.abs(avg_fraction - theoretical_fraction)\n    \n    return [avg_fraction, theoretical_fraction, abs_diff]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_suite = [\n        # 1. Additive landscape case ($K=0$)\n        {'func': solve_additive_case, 'params': {'N': 5, 'seed': 12345}},\n        # 2. House-of-Cards limit\n        {'func': solve_hoc_case, 'params': {'N': 8, 'R': 3000, 'seed': 67890}},\n        # 3. House-of-Cards limit (small boundary case)\n        {'func': solve_hoc_case, 'params': {'N': 2, 'R': 50000, 'seed': 13579}},\n        # 4. Additive landscape case (trivial boundary)\n        {'func': solve_additive_case, 'params': {'N': 1, 'seed': 24680}},\n    ]\n\n    results = []\n    for test in test_suite:\n        result = test['func'](**test['params'])\n        results.append(result)\n\n    # The spec requires a specific print format. The Python default for a list\n    # includes spaces, which we will use as per the provided template code.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}