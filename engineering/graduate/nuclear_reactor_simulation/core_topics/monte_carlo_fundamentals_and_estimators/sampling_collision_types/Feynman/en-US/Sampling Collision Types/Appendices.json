{
    "hands_on_practices": [
        {
            "introduction": "In any Monte Carlo simulation, determining the outcome of a particle interaction is a fundamental step. This exercise establishes the direct link between a material's macroscopic cross sections and the probabilities of different collision events, such as scattering or fission. By working through this problem (), you will practice the core skill of converting physical data, $\\Sigma_i$, into the probabilistic rules that govern the simulation.",
            "id": "4246721",
            "problem": "A neutron is transported in a spatially homogeneous material at fixed energy, so that reaction rates per unit path length are constant. Let the macroscopic scattering cross section be $\\Sigma_{s}$, the macroscopic capture (non-fission absorption) cross section be $\\Sigma_{c}$, and the macroscopic fission cross section be $\\Sigma_{f}$. The total macroscopic cross section is defined by $\\Sigma_{t}=\\Sigma_{s}+\\Sigma_{c}+\\Sigma_{f}$. In the Monte Carlo method for neutron transport, sampling the collision type at the end of a free flight is performed by drawing from the normalized probabilities for scattering, capture, and fission.\n\nStarting from the definition that a macroscopic cross section $\\Sigma$ represents the collision rate per unit path length, and from the well-tested fact that, in a homogeneous medium at fixed energy, the free-flight path length $L$ is exponentially distributed with probability density function $f_{L}(\\ell)=\\Sigma_{t}\\exp(-\\Sigma_{t}\\ell)$ for $\\ell\\ge 0$, derive the normalized probability $p_{i}$ that the next collision is of type $i\\in\\{s,c,f\\}$ in terms of $\\Sigma_{i}$ and $\\Sigma_{t}$. Then, using $\\Sigma_{s}=0.8\\ \\mathrm{cm^{-1}}$, $\\Sigma_{c}=0.1\\ \\mathrm{cm^{-1}}$, and $\\Sigma_{f}=0.1\\ \\mathrm{cm^{-1}}$, compute the triple $(p_{s},p_{c},p_{f})$ and verify that $p_{s}+p_{c}+p_{f}=1$. Express each probability as a decimal fraction and round your final reported values to four significant figures.",
            "solution": "The problem statement is critically validated before attempting a solution.\n\n### Step 1: Extract Givens\n- Macroscopic scattering cross section: $\\Sigma_{s}$\n- Macroscopic capture cross section: $\\Sigma_{c}$\n- Macroscopic fission cross section: $\\Sigma_{f}$\n- Total macroscopic cross section definition: $\\Sigma_{t}=\\Sigma_{s}+\\Sigma_{c}+\\Sigma_{f}$\n- Definition of a macroscopic cross section $\\Sigma$: collision rate per unit path length. This is equivalent to the probability of interaction per unit path length.\n- Distribution of free-flight path length $L$: exponential, with probability density function $f_{L}(\\ell)=\\Sigma_{t}\\exp(-\\Sigma_{t}\\ell)$ for $\\ell\\ge 0$.\n- Numerical values for calculation: $\\Sigma_{s}=0.8\\ \\mathrm{cm^{-1}}$, $\\Sigma_{c}=0.1\\ \\mathrm{cm^{-1}}$, and $\\Sigma_{f}=0.1\\ \\mathrm{cm^{-1}}$.\n- Required tasks:\n    1. Derive the normalized probability $p_{i}$ for a collision of type $i\\in\\{s,c,f\\}$ in terms of $\\Sigma_{i}$ and $\\Sigma_{t}$.\n    2. Compute the triple $(p_{s},p_{c},p_{f})$ using the given numerical values.\n    3. Verify that the sum of probabilities is $1$.\n    4. Express the probabilities as decimal fractions rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is based on fundamental principles of neutron transport theory, a core topic in nuclear engineering and physics. The definitions of macroscopic cross sections, their additivity to form a total cross section, and the resulting exponential distribution for free-flight path lengths in a homogeneous medium are standard and correct assumptions in this field. The problem is self-contained, with all necessary data and definitions provided. There are no contradictions or ambiguities. The numerical values are physically reasonable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Derivation of Collision Probabilities\nThe fundamental premise is that a macroscopic cross section $\\Sigma_{i}$ for a reaction of type $i$ represents the probability per unit path length of a neutron inducing that reaction. This is a rate concept. For an infinitesimally small path length $d\\ell$, the probability $dP_{i}$ of a type-$i$ reaction occurring is given by:\n$$dP_{i} = \\Sigma_{i} \\, d\\ell$$\nThis relationship is valid for any reaction type $i \\in \\{s, c, f\\}$, where $s$ denotes scattering, $c$ denotes capture, and $f$ denotes fission.\n\nThe reactions are assumed to be mutually exclusive events. The total probability per unit path length of *any* interaction occurring is the sum of the individual probabilities per unit path length. This defines the total macroscopic cross section $\\Sigma_t$:\n$$\\Sigma_{t} = \\Sigma_{s} + \\Sigma_{c} + \\Sigma_{f}$$\nConsequently, the probability $dP_{t}$ of *any* interaction occurring within the infinitesimal path length $d\\ell$ is:\n$$dP_{t} = \\Sigma_{t} \\, d\\ell$$\nThe problem asks for the normalized probability $p_i$ that, given a collision has occurred, it is of type $i$. This is a conditional probability. Let $A$ be the event that a collision of type $i$ occurs in $d\\ell$, and let $B$ be the event that *any* collision occurs in $d\\ell$. We seek the probability $p_i = P(A|B)$.\n$$p_{i} = \\frac{P(A \\cap B)}{P(B)}$$\nThe event \"a collision of type $i$ occurs\" ($A$) is a subset of the event \"any collision occurs\" ($B$). Therefore, the intersection $A \\cap B$ is simply the event $A$.\n$$p_{i} = \\frac{P(A)}{P(B)} = \\frac{dP_{i}}{dP_{t}}$$\nSubstituting the expressions in terms of cross sections:\n$$p_{i} = \\frac{\\Sigma_{i} \\, d\\ell}{\\Sigma_{t} \\, d\\ell}$$\nThe differential path length element $d\\ell$ cancels, yielding the general formula for the collision type sampling probability:\n$$p_{i} = \\frac{\\Sigma_{i}}{\\Sigma_{t}}$$\nThis result is independent of the path length $\\ell$. The exponential distribution for the path length, $f_{L}(\\ell)=\\Sigma_{t}\\exp(-\\Sigma_{t}\\ell)$, arises from the constant total interaction probability per unit length, $\\Sigma_{t}$. When a collision event is determined to happen at the end of a sampled path length, the type of that collision is determined by the relative magnitudes of the partial cross sections, as expressed by the derived probabilities $p_i$.\n\n### Numerical Calculation\nThe given numerical values for the macroscopic cross sections are:\n- $\\Sigma_{s} = 0.8\\ \\mathrm{cm^{-1}}$\n- $\\Sigma_{c} = 0.1\\ \\mathrm{cm^{-1}}$\n- $\\Sigma_{f} = 0.1\\ \\mathrm{cm^{-1}}$\n\nFirst, we calculate the total macroscopic cross section $\\Sigma_{t}$:\n$$\\Sigma_{t} = \\Sigma_{s} + \\Sigma_{c} + \\Sigma_{f} = 0.8\\ \\mathrm{cm^{-1}} + 0.1\\ \\mathrm{cm^{-1}} + 0.1\\ \\mathrm{cm^{-1}} = 1.0\\ \\mathrm{cm^{-1}}$$\nNow, we can compute the normalized probabilities for each collision type, $p_{s}$, $p_{c}$, and $p_{f}$.\n\nProbability of scattering:\n$$p_{s} = \\frac{\\Sigma_{s}}{\\Sigma_{t}} = \\frac{0.8}{1.0} = 0.8$$\nProbability of capture:\n$$p_{c} = \\frac{\\Sigma_{c}}{\\Sigma_{t}} = \\frac{0.1}{1.0} = 0.1$$\nProbability of fission:\n$$p_{f} = \\frac{\\Sigma_{f}}{\\Sigma_{t}} = \\frac{0.1}{1.0} = 0.1$$\nThe problem requires these values to be expressed as decimal fractions rounded to four significant figures.\n- $p_{s} = 0.8000$\n- $p_{c} = 0.1000$\n- $p_{f} = 0.1000$\n\n### Verification\nFinally, we verify that the sum of these probabilities equals $1$, as required for a complete probability distribution.\n$$p_{s} + p_{c} + p_{f} = 0.8000 + 0.1000 + 0.1000 = 1.0000$$\nThe sum is indeed $1$, which confirms the correctness of the calculation. The resulting triple of probabilities is $(p_{s}, p_{c}, p_{f}) = (0.8000, 0.1000, 0.1000)$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8000  0.1000  0.1000 \\end{pmatrix}}$$"
        },
        {
            "introduction": "A particle's journey is a sequence of choices, and the most frequent one is whether to collide or to cross a boundary. This practice explores the competition between interaction physics, defined by the total cross section $\\Sigma_{t}$, and the system's geometry, defined by the distance to the nearest boundary $d_{b}$. Completing this exercise () will help you understand how to calculate the probability of a collision occurring within a finite region, a cornerstone of any practical transport code.",
            "id": "4246698",
            "problem": "Consider a monoenergetic neutron traveling in a homogeneous, isotropic medium bounded by planar surfaces. Along any straight path segment, collisions are modeled as a homogeneous Poisson process with constant rate equal to the macroscopic total cross section, denoted by $\\Sigma_{t}$, where $\\Sigma_{t}$ is the sum of reaction-specific macroscopic cross sections $\\Sigma_{s}$ (scattering), $\\Sigma_{a}$ (absorption), and $\\Sigma_{f}$ (fission). The algorithmic decision rule in Monte Carlo (MC) particle transport is as follows: sample a free path length $s$ from the distance-to-collision distribution implied by the Poisson process, compare $s$ to the distance $d_{b}$ to the nearest boundary along the particle direction, and declare a collision if and only if $s$ is smaller than $d_{b}$. If a collision occurs, sample the collision type by drawing from a categorical distribution whose event probabilities are proportional to the respective reaction macroscopic cross sections $\\Sigma_{s}$, $\\Sigma_{a}$, and $\\Sigma_{f}$.\n\nStarting only from the fundamental assumptions of a homogeneous Poisson process for interactions and the definitions of macroscopic cross sections, implement a program that computes, for each test case, the unconditional probability that the next event before boundary crossing is of each reaction type. The required outputs for a single case are the three dimensionless probabilities for the events \"scattering before boundary,\" \"absorption before boundary,\" and \"fission before boundary,\" each expressed as a decimal (not a percentage). All distances must be expressed in centimeters (cm), and all macroscopic cross sections must be expressed in inverse centimeters ($\\mathrm{cm}^{-1}$). The medium is homogeneous, and the neutron direction is fixed so that $d_{b}$ is well-defined.\n\nYour implementation must:\n- Use only the fundamental base described above to reason about the sampling and decision process.\n- Correctly handle edge conditions such as $d_{b} = 0$ and $\\Sigma_{t} = 0$ without numerical instability or undefined operations.\n- Produce results strictly as dimensionless decimals.\n\nTest Suite:\nFor each case below, use the given reaction macroscopic cross sections and boundary distance. The medium is homogeneous with $\\Sigma_{t} = \\Sigma_{s} + \\Sigma_{a} + \\Sigma_{f}$.\n\n- Case $1$: $\\Sigma_{s} = 0.2\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a} = 0.1\\,\\mathrm{cm}^{-1}$, $\\Sigma_{f} = 0.3\\,\\mathrm{cm}^{-1}$, $d_{b} = 10\\,\\mathrm{cm}$.\n- Case $2$: $\\Sigma_{s} = 0.2\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a} = 0.1\\,\\mathrm{cm}^{-1}$, $\\Sigma_{f} = 0.3\\,\\mathrm{cm}^{-1}$, $d_{b} = 0\\,\\mathrm{cm}$.\n- Case $3$: $\\Sigma_{s} = 1\\times 10^{-6}\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a} = 0.0\\,\\mathrm{cm}^{-1}$, $\\Sigma_{f} = 0.0\\,\\mathrm{cm}^{-1}$, $d_{b} = 1\\times 10^{6}\\,\\mathrm{cm}$.\n- Case $4$: $\\Sigma_{s} = 0.0\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a} = 0.0\\,\\mathrm{cm}^{-1}$, $\\Sigma_{f} = 0.0\\,\\mathrm{cm}^{-1}$, $d_{b} = 100.0\\,\\mathrm{cm}$.\n- Case $5$: $\\Sigma_{s} = 7.0\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a} = 3.0\\,\\mathrm{cm}^{-1}$, $\\Sigma_{f} = 0.0\\,\\mathrm{cm}^{-1}$, $d_{b} = 0.05\\,\\mathrm{cm}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of the three unconditional probabilities in the order $[\\text{scatter}, \\text{absorb}, \\text{fission}]$. For example, the output must be of the form $[[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],\\dots]$, with all $x_{i}$, $y_{i}$, and $z_{i}$ provided as decimals.",
            "solution": "The problem requires the calculation of the unconditional probabilities for a neutron to undergo a scattering, absorption, or fission event before crossing a boundary. We must derive these probabilities from the fundamental principles provided: a homogeneous Poisson process for collisions and the definitions of macroscopic cross sections.\n\nLet us define the operative events:\n- $C$: A collision occurs before the neutron reaches the boundary. This corresponds to the sampled path length, $s$, being less than the distance to the boundary, $d_b$.\n- $R_s$: The collision type is scattering.\n- $R_a$: The collision type is absorption.\n- $R_f$: The collision type is fission.\n\nThe objective is to find the unconditional probabilities $P(C \\cap R_s)$, $P(C \\cap R_a)$, and $P(C \\cap R_f)$. Using the definition of conditional probability, for any reaction type $i \\in \\{s, a, f\\}$, this can be expressed as:\n$$P(C \\cap R_i) = P(R_i | C) \\cdot P(C)$$\n\nOur derivation proceeds in two parts: first, we calculate $P(C)$, the probability of any collision occurring before reaching the boundary; second, we determine $P(R_i | C)$, the conditional probability of the collision being of type $i$, given that a collision has occurred.\n\n**1. Probability of Collision Before Boundary, $P(C)$**\n\nThe problem states that collisions are governed by a homogeneous Poisson process with a constant rate equal to the macroscopic total cross section, $\\Sigma_t$. In this context, the rate is spatial, not temporal. The distance a particle travels before an interaction, the free path length $S$, is a random variable. The probability that no collision occurs over a distance $x$ is given by the survival probability $e^{-\\Sigma_t x}$. The cumulative distribution function (CDF) for the distance to the first collision is therefore $F_S(s) = P(S \\le s) = 1 - e^{-\\Sigma_t s}$. The corresponding probability density function (PDF) is $f_S(s) = \\frac{d}{ds}F_S(s) = \\Sigma_t e^{-\\Sigma_t s}$, which is the exponential distribution with rate parameter $\\Sigma_t$.\n\nThe event $C$ occurs if the sampled path length $s$ is less than the distance to the boundary, $d_b$. The probability of this event is:\n$$P(C) = P(S  d_b) = \\int_0^{d_b} f_S(s) \\,ds = \\int_0^{d_b} \\Sigma_t e^{-\\Sigma_t s} \\,ds$$\nEvaluating this integral, we find:\n$$P(C) = \\left[ -e^{-\\Sigma_t s} \\right]_0^{d_b} = (-e^{-\\Sigma_t d_b}) - (-e^0) = 1 - e^{-\\Sigma_t d_b}$$\nThis is the total probability that a neutron interacts with the medium at any point along the path of length $d_b$.\n\n**2. Conditional Probability of Reaction Type, $P(R_i | C)$**\n\nThe problem statement specifies that if a collision occurs, the type of reaction is sampled from a categorical distribution whose event probabilities are proportional to the respective reaction macroscopic cross sections. This means the probability of a reaction being of type $i$, given that a collision has happened, is the ratio of the partial cross section for that reaction to the total cross section. The total macroscopic cross section is defined as $\\Sigma_t = \\Sigma_s + \\Sigma_a + \\Sigma_f$.\n\nThus, the conditional probabilities are:\n- For scattering: $P(R_s | C) = \\frac{\\Sigma_s}{\\Sigma_t}$\n- For absorption: $P(R_a | C) = \\frac{\\Sigma_a}{\\Sigma_t}$\n- For fission: $P(R_f | C) = \\frac{\\Sigma_f}{\\Sigma_t}$\n\nThese expressions are valid only if $\\Sigma_t  0$. The case where $\\Sigma_t = 0$ will be handled separately.\n\n**3. Unconditional Probability of Each Reaction Type**\n\nBy combining the results from the previous two steps, we obtain the final expression for the unconditional probability of a reaction of type $i$ occurring before the boundary crossing:\n$$P(C \\cap R_i) = P(R_i | C) \\cdot P(C) = \\frac{\\Sigma_i}{\\Sigma_t} \\left( 1 - e^{-\\Sigma_t d_b} \\right)$$\nThis formula applies to $i \\in \\{s, a, f\\}$.\n\n**4. Analysis of Edge Conditions**\n\nA rigorous solution must correctly handle the edge conditions specified in the problem.\n\n- **Case 1: $d_b = 0$**\nIf the particle starts at the boundary, $d_b = 0$. The probability of a collision before crossing is intuitively $0$. Our formula confirms this:\n$$P(C) = 1 - e^{-\\Sigma_t \\cdot 0} = 1 - e^0 = 1 - 1 = 0$$\nSince $P(C) = 0$, the unconditional probability for any reaction type $i$, $P(C \\cap R_i)$, is also $0$.\n\n- **Case 2: $\\Sigma_t = 0$**\nIf the total macroscopic cross section $\\Sigma_t = 0$, it implies that $\\Sigma_s = \\Sigma_a = \\Sigma_f = 0$ since cross sections are non-negative. This models a vacuum, where no interactions can occur. The probability of any collision is $0$. Our formula leads to an indeterminate form $\\frac{0}{0}$ for the conditional probability term. To resolve this, we must return to the physics. If $\\Sigma_t=0$, the interaction rate is zero, meaning the path length to the next collision is infinite. Therefore, the probability $P(S  d_b)$ is $0$ for any finite $d_b$. Consequently, the probability of any specific reaction type before boundary crossing is also $0$. In an implementation, if $\\Sigma_t$ is found to be $0$, the final probabilities for all reaction types should be set directly to $0$ to avoid a division-by-zero error and correctly reflect the physical reality.\n\nThe final algorithm is as follows:\n1. For a given set of parameters $\\{\\Sigma_s, \\Sigma_a, \\Sigma_f, d_b\\}$, calculate the total cross section $\\Sigma_t = \\Sigma_s + \\Sigma_a + \\Sigma_f$.\n2. Check for edge conditions:\n   - If $\\Sigma_t = 0$ or $d_b = 0$, the probabilities for all three reaction types are $0$.\n3. If neither edge condition is met, proceed with the general formula:\n   - Calculate the probability of collision before boundary: $P_{\\text{coll}} = 1 - e^{-\\Sigma_t d_b}$.\n   - Calculate the unconditional probabilities for scattering, absorption, and fission, respectively:\n     - $P_s = \\frac{\\Sigma_s}{\\Sigma_t} \\cdot P_{\\text{coll}}$\n     - $P_a = \\frac{\\Sigma_a}{\\Sigma_t} \\cdot P_{\\text{coll}}$\n     - $P_f = \\frac{\\Sigma_f}{\\Sigma_t} \\cdot P_{\\text{coll}}$\n4. The result for one case is the triplet of probabilities $[P_s, P_a, P_f]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the unconditional probability of scattering, absorption, and\n    fission events before a particle crosses a boundary.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Standard case\n        {'sigma_s': 0.2, 'sigma_a': 0.1, 'sigma_f': 0.3, 'd_b': 10.0},\n        # Case 2: Zero distance to boundary\n        {'sigma_s': 0.2, 'sigma_a': 0.1, 'sigma_f': 0.3, 'd_b': 0.0},\n        # Case 3: Very transparent medium, long distance\n        {'sigma_s': 1e-6, 'sigma_a': 0.0, 'sigma_f': 0.0, 'd_b': 1e6},\n        # Case 4: Vacuum (zero total cross section)\n        {'sigma_s': 0.0, 'sigma_a': 0.0, 'sigma_f': 0.0, 'd_b': 100.0},\n        # Case 5: Highly interactive medium, short distance\n        {'sigma_s': 7.0, 'sigma_a': 3.0, 'sigma_f': 0.0, 'd_b': 0.05},\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma_s = case['sigma_s']\n        sigma_a = case['sigma_a']\n        sigma_f = case['sigma_f']\n        d_b = case['d_b']\n\n        # Calculate the total macroscopic cross section\n        sigma_t = sigma_s + sigma_a + sigma_f\n\n        # Handle edge conditions\n        # If sigma_t is 0 (vacuum) or d_b is 0 (at boundary), no collision\n        # can happen before crossing the boundary.\n        if sigma_t == 0.0 or d_b == 0.0:\n            prob_s, prob_a, prob_f = 0.0, 0.0, 0.0\n        else:\n            # Probability of any collision occurring before reaching the boundary\n            # P(collision) = 1 - exp(-sigma_t * d_b)\n            prob_collision = 1.0 - np.exp(-sigma_t * d_b)\n\n            # The unconditional probability for a reaction of type 'i' is:\n            # P(i) = P(i | collision) * P(collision)\n            # where P(i | collision) = sigma_i / sigma_t\n            \n            prob_s = (sigma_s / sigma_t) * prob_collision\n            prob_a = (sigma_a / sigma_t) * prob_collision\n            prob_f = (sigma_f / sigma_t) * prob_collision\n            \n        results.append([prob_s, prob_a, prob_f])\n\n    # Format the final output string exactly as specified.\n    # e.g., [[x1,y1,z1],[x2,y2,z2],...]\n    output_str = '[' + ','.join(f'[{r[0]},{r[1]},{r[2]}]' for r in results) + ']'\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Analog simulations are often computationally expensive, as important particle histories can be prematurely terminated by absorption. This is where variance reduction techniques like survival biasing become essential tools for the computational physicist. This problem () guides you through the logic of survival biasing, demonstrating how particle weights are adjusted to maintain an unbiased result while ensuring that particles explore the problem space more thoroughly.",
            "id": "4246709",
            "problem": "Consider a neutral particle history in an infinite, homogeneous medium at a fixed energy where the macroscopic total cross section is constant, and the probability that a collision is an absorption (capture) is a constant fraction $p_{a} \\in (0,1)$. In an analog Monte Carlo (MC) neutron transport simulation, a collision would be an absorption with probability $p_{a}$ (and the particle would terminate) or a non-absorbing collision with probability $1-p_{a}$ (and the particle would continue with unchanged statistical weight).\n\nInstead, suppose the simulation uses survival biasing (also called implicit capture) for the absorption collision type. Under survival biasing at each collision site:\n- The estimator for the absorption reaction rate is made unbiased by depositing a score equal to the current particle weight multiplied by $p_{a}$ at the collision location.\n- The history always continues as a non-absorbing collision with an outgoing weight $w'$ chosen so that estimators remain unbiased and particle weights remain nonnegative.\n\nLet $w_{0}  0$ be the initial particle weight before any collisions, and let $w_{n}$ denote the particle weight after $n$ such collision sites treated with survival biasing, assuming $p_{a}$ remains constant from site to site and no other variance-reduction technique alters the weight. Using only the definition of unbiased scoring and weight conservation at each collision site, derive a closed-form expression for the expected weight $\\mathbb{E}[w_{n}]$ as a function of $w_{0}$, $p_{a}$, and the integer $n \\geq 1$.\n\nProvide your final answer as a single simplified analytic expression. No numerical rounding is required.",
            "solution": "### **Problem Validation**\n\n**Step 1: Extract Givens**\n- The medium is infinite and homogeneous.\n- The neutral particle is at a fixed energy.\n- The macroscopic total cross section is constant.\n- The probability that a collision is an absorption (capture) is a constant fraction $p_{a} \\in (0,1)$.\n- In the analog Monte Carlo (MC) simulation: an absorption occurs with probability $p_{a}$ (terminating the particle), and a non-absorbing collision occurs with probability $1-p_{a}$ (particle continues with unchanged weight).\n- In the survival biasing simulation:\n    - At each collision, the estimator for absorption is scored with a value equal to the current particle weight multiplied by $p_{a}$.\n    - The history always continues as a non-absorbing collision.\n    - The outgoing weight $w'$ is chosen to keep estimators unbiased and weights non-negative.\n- $w_{0}  0$ is the initial particle weight before any collisions.\n- $w_{n}$ is the particle weight after $n$ such collision sites treated with survival biasing.\n- $p_{a}$ is constant from site to site.\n- No other variance-reduction technique alters the weight.\n- The task is to derive a closed-form expression for the expected weight $\\mathbb{E}[w_{n}]$ for $n \\geq 1$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem is firmly rooted in the theory of Monte Carlo methods for particle transport, a standard and critical subject in nuclear engineering, medical physics, and computer graphics. Survival biasing (or implicit capture) is a well-established variance reduction technique. All concepts used (particle weight, cross sections, unbiased estimators) are rigorously defined in this field. The problem is scientifically sound.\n- **Well-Posed**: The problem is clearly defined and self-contained. It provides all the necessary information and constraints to derive a unique solution. The goal is to find $\\mathbb{E}[w_{n}]$, and the rules governing the evolution of $w_n$ are specified through the principle of unbiased estimation.\n- **Objective**: The language is precise, formal, and free of any subjective or opinion-based content.\n\nThe problem does not exhibit any of the flaws listed in the instructions, such as scientific unsoundness, missing information, or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be provided.\n\n### **Solution Derivation**\n\nLet $w_{k-1}$ denote the weight of the particle immediately before its $k$-th collision, for $k \\geq 1$. The initial weight of the particle, before its first collision, is $w_{0}$.\n\nThe central principle of the survival biasing technique is to ensure that all estimators remain unbiased. This means that the expectation of any tallied quantity in the biased simulation must be equal to its expectation in the corresponding analog (i.e., physically direct) simulation. This principle applies crucially to the particle population itself. The expected weight of particles emerging from a collision event must be the same in both the biased and analog games.\n\nFirst, consider the analog simulation. At the $k$-th collision, a particle with incoming weight $w_{k-1}$ has a probability $p_{a}$ of being absorbed (and thus having its weight become $0$) and a probability $1-p_{a}$ of surviving (scattering) and retaining its weight $w_{k-1}$. The expected weight of the particle after the collision decision, which we can call $\\mathbb{E}[w_{k}^{\\text{analog}}]$, is therefore:\n$$ \\mathbb{E}[w_{k}^{\\text{analog}}] = (w_{k-1}) \\cdot (1 - p_{a}) + (0) \\cdot p_{a} = w_{k-1}(1 - p_{a}) $$\n\nNext, consider the survival biasing simulation as described. At the $k$-th collision, the particle with incoming weight $w_{k-1}$ is forced to survive. Its weight is adjusted to a new value, $w_{k}$. In this biased game, the particle survives with a probability of $1$. The expected weight of the particle after this event, $\\mathbb{E}[w_{k}^{\\text{biased}}]$, is:\n$$ \\mathbb{E}[w_{k}^{\\text{biased}}] = w_{k} \\cdot 1 = w_{k} $$\n\nFor the simulation to be unbiased, the expected weight emerging from the collision must be conserved. Therefore, we must equate the expectation from the analog and biased games:\n$$ \\mathbb{E}[w_{k}^{\\text{biased}}] = \\mathbb{E}[w_{k}^{\\text{analog}}] $$\n$$ w_{k} = w_{k-1}(1 - p_{a}) $$\n\nThis equation provides the deterministic rule for updating the particle's weight at every collision in a simulation using only survival biasing. It is a recurrence relation. We can use this relation to find the weight $w_{n}$ after $n$ collisions, starting from the initial weight $w_{0}$.\n\nFor the first collision ($n=1$):\n$$ w_{1} = w_{0}(1 - p_{a}) $$\nFor the second collision ($n=2$):\n$$ w_{2} = w_{1}(1 - p_{a}) = \\left[w_{0}(1 - p_{a})\\right](1 - p_{a}) = w_{0}(1 - p_{a})^{2} $$\nFor the third collision ($n=3$):\n$$ w_{3} = w_{2}(1 - p_{a}) = \\left[w_{0}(1 - p_{a})^{2}\\right](1 - p_{a}) = w_{0}(1 - p_{a})^{3} $$\n\nBy induction, the weight of the particle after it has undergone exactly $n$ collisions is given by the closed-form expression:\n$$ w_{n} = w_{0}(1 - p_{a})^{n} $$\n\nThe problem asks for the expected weight, $\\mathbb{E}[w_{n}]$. Given the problem's constraints (only survival biasing is used, $p_a$ is constant), the weight $w_n$ of a particle that has completed exactly $n$ collisions is a deterministic quantity, not a random variable. Its value is uniquely determined by $w_{0}$, $p_{a}$, and $n$. The expectation of a constant value is the value itself.\n\nTherefore, the expected weight after $n$ collisions is:\n$$ \\mathbb{E}[w_{n}] = w_{n} = w_{0}(1 - p_{a})^{n} $$\nThis expression is the simplified analytic answer.",
            "answer": "$$\n\\boxed{w_{0}(1 - p_{a})^{n}}\n$$"
        }
    ]
}