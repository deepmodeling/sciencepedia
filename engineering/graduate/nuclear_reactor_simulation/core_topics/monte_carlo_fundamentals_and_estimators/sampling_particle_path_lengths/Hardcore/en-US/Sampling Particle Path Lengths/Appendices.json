{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of any Monte Carlo particle transport simulation is the logic that determines a particle's fate at each step of its journey. The most fundamental decision is whether the particle will first interact with the medium it is traversing or reach a geometric boundary. This exercise provides practice in deriving the probability of a boundary crossing from first principles, a quantity that underpins the core tracking algorithm in virtually all transport codes. ",
            "id": "4247018",
            "problem": "A neutral particle is tracked in a Monte Carlo (MC) neutron transport simulation inside a single, homogeneous material region. The macroscopic total cross section is constant and equal to $\\Sigma_{t}$ (units of inverse length) everywhere in the region. Consider the one-dimensional path coordinate $s \\geq 0$ measured along the particle’s straight-line flight direction. The collision process along $s$ is modeled as a Poisson point process with constant rate $\\Sigma_{t}$ per unit length, so that the number of collisions in any interval of length $s$ is a Poisson random variable with mean $\\Sigma_{t} s$. The particle starts at an interior point and has a known straight-line distance to the nearest material boundary along its flight direction, denoted $d_{\\text{surf}}  0$. The first event encountered along the ray must be either a collision in the material or crossing the boundary.\n\nStarting from the Poisson process model and its implications for the distribution of the free-path length to first collision, derive the conditional probability that the first event is a boundary crossing rather than a collision, expressed as a single closed-form analytic expression in terms of $\\Sigma_{t}$ and $d_{\\text{surf}}$. Provide your final result only in terms of $\\Sigma_{t}$ and $d_{\\text{surf}}$. No numerical approximation is required, and no units should be included in the final expression.",
            "solution": "The problem statement is evaluated to be scientifically sound, well-posed, and contains all necessary information for a unique and meaningful solution. It represents a fundamental concept in the theory of neutral particle transport and Monte Carlo simulation methods.\n\nThe core of the problem lies in determining the probability of one of two mutually exclusive events occurring first: a particle-medium interaction (collision) or the particle crossing a material boundary. The distance a particle travels before a collision is a random variable, while the distance to the boundary along the particle's flight path is a fixed, known value.\n\nLet $S$ be the random variable representing the path length a particle travels from its starting point to its first collision. The problem states that the collision process is a Poisson point process with a constant rate $\\Sigma_{t}$ per unit length. A direct and fundamental consequence of this model is that the distance to the first event (collision), $S$, is an exponentially distributed random variable.\n\nThe probability density function (PDF) for $S$, denoted $f_S(s)$, for a particle traveling in a homogeneous medium with a total macroscopic cross section $\\Sigma_{t}$ is given by:\n$$f_S(s) = \\Sigma_{t} \\exp(-\\Sigma_{t} s), \\quad \\text{for } s \\geq 0$$\nThis function describes the probability density of a collision occurring at a specific path length $s$.\n\nTo find the probability that a particle travels a certain distance *without* colliding, we need the survival function, which is the complement of the cumulative distribution function (CDF). The CDF, $F_S(s) = P(S \\leq s)$, is the probability that a collision occurs at or before a distance $s$. It is calculated by integrating the PDF from $0$ to $s$:\n$$F_S(s) = \\int_{0}^{s} f_S(s') ds' = \\int_{0}^{s} \\Sigma_{t} \\exp(-\\Sigma_{t} s') ds'$$\nEvaluating the integral gives:\n$$F_S(s) = [-\\exp(-\\Sigma_{t} s')]_{0}^{s} = -\\exp(-\\Sigma_{t} s) - (-\\exp(0)) = 1 - \\exp(-\\Sigma_{t} s)$$\n\nThe survival function, $R(s) = P(S  s)$, gives the probability that the particle travels a distance greater than $s$ before its first collision. It is calculated as:\n$$R(s) = P(S  s) = 1 - F_S(s) = 1 - (1 - \\exp(-\\Sigma_{t} s)) = \\exp(-\\Sigma_{t} s)$$\n\nThe problem specifies two possible \"first events\" for the particle:\n1. A collision within the material.\n2. Crossing the boundary of the material region.\n\nThe distance to the nearest boundary along the particle's direction of flight is given as a deterministic value, $d_{\\text{surf}}$.\n\nA boundary crossing will be the first event if and only if the stochastically determined path length to the first collision, $S$, is greater than the fixed distance to the boundary, $d_{\\text{surf}}$. Therefore, the probability that the first event is a boundary crossing is equivalent to the probability that the particle survives without a collision over the distance $d_{\\text{surf}}$.\n\nWe are asked to find $P(\\text{first event is boundary crossing})$. This can be expressed as:\n$$P(\\text{first event is boundary crossing}) = P(S  d_{\\text{surf}})$$\nUsing the survival function $R(s)$ derived above, we can evaluate this probability by setting $s = d_{\\text{surf}}$:\n$$P(S  d_{\\text{surf}}) = R(d_{\\text{surf}}) = \\exp(-\\Sigma_{t} d_{\\text{surf}})$$\n\nThis expression represents the conditional probability that the particle reaches the boundary, given its starting position, direction, and the material properties. It is a cornerstone of particle tracking algorithms in Monte Carlo codes. The algorithm typically samples a path length $s$ from the distribution $f_S(s)$ and compares it with $d_{\\text{surf}}$. If $s  d_{\\text{surf}}$, the particle is moved to the boundary; otherwise, it is moved to the collision site at distance $s$. The probability of the former case is what has been derived.",
            "answer": "$$\\boxed{\\exp(-\\Sigma_{t} d_{\\text{surf}})}$$"
        },
        {
            "introduction": "While the standard method for sampling a particle's free path assumes an infinite medium, practical simulations are often set within finite geometric cells. This exercise explores the important technique of sampling from a truncated exponential distribution, which is necessary when we know a particle will collide *within* a specific region. Mastering this method is crucial for building efficient and accurate tracking routines in complex geometries. ",
            "id": "4247040",
            "problem": "In a homogeneous region of a nuclear reactor model used for Monte Carlo transport, assume the total macroscopic cross section is constant and equal to $\\Sigma_{t}$ (units: $\\mathrm{m}^{-1}$). Consider a particle traveling through a finite cell of thickness $s_{\\max}$ (units: $\\mathrm{m}$) along a straight chord. The fundamental exponential attenuation law states that the survival probability along a distance $s$ without collision is $\\exp(-\\Sigma_{t} s)$, and that the collision process is governed by a constant hazard rate equal to $\\Sigma_{t}$.\n\nStarting from these principles, perform the following:\n\n1. Derive the conditional probability density function $p(s \\mid s  s_{\\max})$ on the interval $s \\in [0, s_{\\max}]$ for the distance to the next collision, given that the collision occurs before exiting the cell.\n2. Using inverse transform sampling, derive a method to sample $s$ from this conditional distribution by expressing $s$ as an explicit function of a uniform variate $u \\sim \\mathcal{U}(0,1)$.\n3. For a homogeneous region with $\\Sigma_{t} = 0.8\\,\\mathrm{m}^{-1}$ and a cell thickness $s_{\\max} = 0.35\\,\\mathrm{m}$, if a uniform random number $u = 0.37$ is drawn, compute the sampled free-path length $s$ using your derived sampling formula. Express your final numerical answer in meters and round to four significant figures.\n\nThe final answer must be a single real number. Do not include units in the final boxed answer.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is based on standard principles of particle transport theory and Monte Carlo methods, specifically the exponential attenuation law and inverse transform sampling for a truncated distribution. The problem is therefore deemed valid.\n\nThe solution is developed in three parts as requested.\n\n### Part 1: Derivation of the Conditional Probability Density Function (PDF)\n\nThe problem states that the probability of a particle surviving without a collision over a distance $s$ is given by the exponential attenuation law, $P(\\text{survival}) = \\exp(-\\Sigma_{t} s)$. This is the complementary cumulative distribution function (CCDF) for the path length random variable $S$.\n$$\nP(S  s) = \\exp(-\\Sigma_{t} s)\n$$\nThe cumulative distribution function (CDF), $F(s)$, which gives the probability of a collision occurring at or before a distance $s$, is:\n$$\nF(s) = P(S \\le s) = 1 - P(S > s) = 1 - \\exp(-\\Sigma_{t} s)\n$$\nThe probability density function (PDF), $f(s)$, is the derivative of the CDF with respect to $s$. This represents the probability distribution for the path length to the next collision in an infinite medium.\n$$\nf(s) = \\frac{dF(s)}{ds} = \\frac{d}{ds} \\left(1 - \\exp(-\\Sigma_{t} s)\\right) = \\Sigma_{t} \\exp(-\\Sigma_{t} s), \\quad \\text{for } s \\ge 0\n$$\nThis is the exponential distribution with a rate parameter $\\Sigma_{t}$.\n\nWe are asked to find the conditional PDF, $p(s \\mid s  s_{\\max})$, for the distance to collision, given that the collision occurs within the cell of thickness $s_{\\max}$. According to the definition of conditional probability, for $s \\in [0, s_{\\max}]$:\n$$\np(s \\mid s  s_{\\max}) = \\frac{f(s)}{P(s  s_{\\max})}\n$$\nThe probability $P(s  s_{\\max})$ is the probability of a collision occurring before or at distance $s_{\\max}$, which is given by the CDF evaluated at $s_{\\max}$:\n$$\nP(s  s_{\\max}) = F(s_{\\max}) = 1 - \\exp(-\\Sigma_{t} s_{\\max})\n$$\nSubstituting $f(s)$ and $P(s  s_{\\max})$ into the expression for the conditional PDF, we obtain:\n$$\np(s \\mid s  s_{\\max}) = \\frac{\\Sigma_{t} \\exp(-\\Sigma_{t} s)}{1 - \\exp(-\\Sigma_{t} s_{\\max})} \\quad \\text{for } s \\in [0, s_{\\max}]\n$$\nThis is the PDF for a truncated exponential distribution on the interval $[0, s_{\\max}]$. We can verify that this function is a valid PDF by ensuring its integral over its domain equals $1$:\n$$\n\\int_{0}^{s_{\\max}} p(s \\mid s  s_{\\max}) ds = \\int_{0}^{s_{\\max}} \\frac{\\Sigma_{t} \\exp(-\\Sigma_{t} s)}{1 - \\exp(-\\Sigma_{t} s_{\\max})} ds\n$$\n$$\n= \\frac{1}{1 - \\exp(-\\Sigma_{t} s_{\\max})} \\left[ -\\exp(-\\Sigma_{t} s) \\right]_{0}^{s_{\\max}}\n$$\n$$\n= \\frac{1}{1 - \\exp(-\\Sigma_{t} s_{\\max})} \\left( -\\exp(-\\Sigma_{t} s_{\\max}) - (-\\exp(0)) \\right)\n$$\n$$\n= \\frac{1 - \\exp(-\\Sigma_{t} s_{\\max})}{1 - \\exp(-\\Sigma_{t} s_{\\max})} = 1\n$$\nThe normalization is correct.\n\n### Part 2: Derivation of the Inverse Transform Sampling Formula\n\nThe inverse transform sampling method requires the conditional cumulative distribution function, let us call it $F_{c}(s)$. This is obtained by integrating the conditional PDF, $p(t \\mid t  s_{\\max})$, from $0$ to $s$, where $s \\in [0, s_{\\max}]$.\n$$\nF_{c}(s) = \\int_{0}^{s} p(t \\mid t  s_{\\max}) dt = \\int_{0}^{s} \\frac{\\Sigma_{t} \\exp(-\\Sigma_{t} t)}{1 - \\exp(-\\Sigma_{t} s_{\\max})} dt\n$$\n$$\nF_{c}(s) = \\frac{1}{1 - \\exp(-\\Sigma_{t} s_{\\max})} \\int_{0}^{s} \\Sigma_{t} \\exp(-\\Sigma_{t} t) dt\n$$\n$$\nF_{c}(s) = \\frac{1}{1 - \\exp(-\\Sigma_{t} s_{\\max})} \\left[ -\\exp(-\\Sigma_{t} t) \\right]_{0}^{s}\n$$\n$$\nF_{c}(s) = \\frac{1 - \\exp(-\\Sigma_{t} s)}{1 - \\exp(-\\Sigma_{t} s_{\\max})}\n$$\nTo sample a path length $s$ from this distribution, we set the conditional CDF equal to a uniform random variate $u \\sim \\mathcal{U}(0,1)$ and solve for $s$:\n$$\nu = F_{c}(s) = \\frac{1 - \\exp(-\\Sigma_{t} s)}{1 - \\exp(-\\Sigma_{t} s_{\\max})}\n$$\nWe now rearrange the equation to isolate $s$:\n$$\nu \\left(1 - \\exp(-\\Sigma_{t} s_{\\max})\\right) = 1 - \\exp(-\\Sigma_{t} s)\n$$\n$$\n\\exp(-\\Sigma_{t} s) = 1 - u \\left(1 - \\exp(-\\Sigma_{t} s_{\\max})\\right)\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\Sigma_{t} s = \\ln\\left(1 - u \\left(1 - \\exp(-\\Sigma_{t} s_{\\max})\\right)\\right)\n$$\nFinally, solving for $s$ yields the sampling formula:\n$$\ns = -\\frac{1}{\\Sigma_{t}} \\ln\\left(1 - u \\left(1 - \\exp(-\\Sigma_{t} s_{\\max})\\right)\\right)\n$$\n\n### Part 3: Numerical Calculation\n\nWe are given the following values:\nTotal macroscopic cross section: $\\Sigma_{t} = 0.8\\,\\mathrm{m}^{-1}$\nCell thickness: $s_{\\max} = 0.35\\,\\mathrm{m}$\nUniform random number: $u = 0.37$\n\nWe substitute these values into the sampling formula derived in Part 2.\nFirst, calculate the argument of the exponential function:\n$$\n\\Sigma_{t} s_{\\max} = (0.8)(0.35) = 0.28\n$$\nNext, compute the term $(1 - \\exp(-\\Sigma_{t} s_{\\max}))$:\n$$\n1 - \\exp(-0.28) \\approx 1 - 0.7557836 = 0.2442164\n$$\nNow, substitute this and $u$ into the argument of the logarithm:\n$$\n1 - u \\left(1 - \\exp(-\\Sigma_{t} s_{\\max})\\right) = 1 - 0.37 \\times (0.2442164)\n$$\n$$\n= 1 - 0.090360068 = 0.909639932\n$$\nTake the natural logarithm of this result:\n$$\n\\ln(0.909639932) \\approx -0.0946955\n$$\nFinally, calculate $s$:\n$$\ns = -\\frac{1}{0.8} \\ln(0.909639932) \\approx -1.25 \\times (-0.0946955)\n$$\n$$\ns \\approx 0.118369375\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\ns \\approx 0.1184\\,\\mathrm{m}\n$$",
            "answer": "$$\n\\boxed{0.1184}\n$$"
        },
        {
            "introduction": "Moving from idealized homogeneous materials to realistic, heterogeneous systems represents a major step in simulation fidelity. When the macroscopic cross section $\\Sigma_t$ varies with position, the simple analytical formula for sampling path lengths is no longer applicable. This advanced problem challenges you to think algorithmically, requiring the design of a robust numerical root-finding scheme to solve for the path length using the concept of optical thickness, a core task in state-of-the-art simulation codes. ",
            "id": "4246978",
            "problem": "In a Monte Carlo (MC) neutron transport simulation within a heterogeneous nuclear reactor core, consider a particle at position $\\boldsymbol{r}_0 \\in \\mathbb{R}^3$ with direction $\\boldsymbol{\\Omega}$, traveling in a medium with total macroscopic cross section $\\Sigma_t(\\boldsymbol{r}) \\ge 0$. The optical thickness along a straight path of length $s \\ge 0$ is defined by the line integral\n$$\n\\tau(s) \\equiv \\int_{0}^{s} \\Sigma_t\\big(\\boldsymbol{r}_0 + s' \\boldsymbol{\\Omega}\\big)\\, \\mathrm{d}s' .\n$$\nThe free-path length is sampled by drawing a uniform random deviate $\\xi \\sim \\mathcal{U}(0,1)$ and solving the equation\n$$\n\\tau(s) \\;=\\; -\\ln \\xi .\n$$\nAssume the geometry is composed of non-overlapping convex polyhedral regions (e.g., axis-aligned boxes or general convex polyhedra), and that within each region the function $\\Sigma_t(\\boldsymbol{r})$ is measurable and locally bounded, with a well-defined line integral along any finite segment of a straight ray. The ray intersects a sequence of regions, yielding a partition of the path into contiguous segments with finite lengths that terminate at material interfaces or at a boundary of the computational domain.\n\nYou are asked to select the algorithmic description that most correctly and robustly prescribes a numerical root-finding scheme to solve $\\tau(s) = -\\ln \\xi$ that:\n- constructs a valid bracketing interval for the unknown $s$ using only geometry-derived segment bounds along $\\boldsymbol{\\Omega}$, and\n- evaluates the required line integrals of $\\Sigma_t$ along the ray segments with sufficient accuracy,\n- and employs a root-finding method whose convergence is guaranteed by the monotonicity properties of $\\tau(s)$.\n\nWhich option below is the most correct and robust?\n\nA. Start from an arbitrary initial guess $s^{(0)}0$ and apply pure Newton iteration to $f(s) \\equiv \\tau(s) + \\ln \\xi = 0$ using the derivative $f'(s)=\\dfrac{\\mathrm{d}\\Sigma_t(\\boldsymbol{r}_0 + s\\boldsymbol{\\Omega})}{\\mathrm{d}s}$. Do not enforce any bracketing. If the Newton step exits the current material region, accept the step and continue; since the derivative uses the gradient of $\\Sigma_t$, convergence is rapid even across discontinuities.\n\nB. Perform deterministic ray tracing from $\\boldsymbol{r}_0$ along $\\boldsymbol{\\Omega}$ to produce consecutive segments indexed by $j$, each of length $\\ell_j0$, bounded by geometry interfaces. For each segment, evaluate the segment optical depth\n$$\nI_j \\;\\equiv\\; \\int_{0}^{\\ell_j} \\Sigma_t\\big(\\boldsymbol{r}_j^{\\text{start}} + s' \\boldsymbol{\\Omega}\\big)\\,\\mathrm{d}s'\n$$\nby a quadrature that is accurate for the local variability of $\\Sigma_t$ (e.g., adaptive Gaussian quadrature if $\\Sigma_t$ varies within the segment, or exact evaluation if $\\Sigma_t$ is constant). Accumulate the partial sums $\\tau_k \\equiv \\sum_{j=1}^{k} I_j$ until finding the first index $k^\\star$ with $\\tau_{k^\\star-1} \\le -\\ln \\xi \\le \\tau_{k^\\star}$ (with the convention $\\tau_0 \\equiv 0$). This brackets the root between the start and end of segment $k^\\star$, i.e., $s_L \\equiv \\sum_{j=1}^{k^\\star-1} \\ell_j$ and $s_U \\equiv \\sum_{j=1}^{k^\\star} \\ell_j$. Then solve for the local residual distance $\\delta \\in [0,\\ell_{k^\\star}]$ from the start of segment $k^\\star$ by finding the root of\n$$\ng(\\delta) \\;\\equiv\\; \\int_{0}^{\\delta} \\Sigma_t\\big(\\boldsymbol{r}_{k^\\star}^{\\text{start}} + s' \\boldsymbol{\\Omega}\\big)\\,\\mathrm{d}s' \\;-\\; \\big((- \\ln \\xi) - \\tau_{k^\\star-1}\\big) \\;=\\; 0 ,\n$$\nusing a safeguarded Newton method: at iteration $n$, compute the Newton proposal\n$$\n\\delta_{\\text{N}}^{(n+1)} \\;=\\; \\delta^{(n)} - \\frac{g(\\delta^{(n)})}{\\Sigma_t\\big(\\boldsymbol{r}_{k^\\star}^{\\text{start}} + \\delta^{(n)} \\boldsymbol{\\Omega}\\big)} ,\n$$\nand accept it only if it lies in $[0,\\ell_{k^\\star}]$ and decreases $|g|$; otherwise, take a bisection step on the current bracket for $\\delta$. Terminate when $|g(\\delta)| \\le \\varepsilon_\\tau$ or when the bracket width is $\\le \\varepsilon_s$, where $\\varepsilon_\\tau0$ and $\\varepsilon_s0$ are user tolerances. The final path length is $s^\\star = s_L + \\delta$.\n\nC. Without using geometry, estimate global bounds $\\Sigma_{\\min}$ and $\\Sigma_{\\max}$ along the ray in advance and bracket by $s_L \\equiv (-\\ln \\xi)/\\Sigma_{\\max}$ and $s_U \\equiv (-\\ln \\xi)/\\Sigma_{\\min}$. On $[s_L,s_U]$, solve $f(s) \\equiv \\tau(s) + \\ln \\xi = 0$ using bisection, where each $f(s)$ evaluation uses a fixed-panel trapezoidal rule with a predetermined number of subintervals, independent of the local variation of $\\Sigma_t$.\n\nD. Replace root-finding entirely by sampling a majorant free path $s' \\equiv (-\\ln \\xi)/\\Sigma_{\\text{maj}}$ with a global majorant $\\Sigma_{\\text{maj}} \\ge \\Sigma_t(\\boldsymbol{r})$ everywhere, then accept the collision at $s'$ with probability $\\Sigma_t(\\boldsymbol{r}_0 + s'\\boldsymbol{\\Omega})/\\Sigma_{\\text{maj}}$, otherwise repeat (delta-tracking). This avoids bracketing and integral evaluation while still drawing the correct path lengths, so it is the most robust way to solve $\\tau(s) = -\\ln \\xi$ in heterogeneous geometries.\n\nSelect the single best option.",
            "solution": "The problem asks for the most correct and robust numerical algorithm to solve for the particle free-path length $s$ from the equation $\\tau(s) = -\\ln \\xi$, where $\\tau(s)$ is the optical thickness, in a Monte Carlo simulation with a heterogeneous medium. The algorithm must satisfy three specific criteria:\n1.  Use geometry-derived segment bounds to construct a bracketing interval for $s$.\n2.  Accurately evaluate the line integrals of the total macroscopic cross section $\\Sigma_t(\\boldsymbol{r})$.\n3.  Use a root-finding method with guaranteed convergence.\n\nThe equation to be solved is $f(s) = \\tau(s) + \\ln \\xi = 0$, where the optical thickness is given by\n$$\n\\tau(s) = \\int_{0}^{s} \\Sigma_t\\big(\\boldsymbol{r}_0 + s' \\boldsymbol{\\Omega}\\big)\\, \\mathrm{d}s'\n$$\nThe random variable $\\xi$ is drawn from a uniform distribution $\\mathcal{U}(0,1)$, so $-\\ln \\xi$ is a positive real number. The function $\\tau(s)$ has a non-negative derivative, $\\tau'(s) = \\Sigma_t(\\boldsymbol{r}_0 + s \\boldsymbol{\\Omega}) \\ge 0$, which means $\\tau(s)$ is a non-decreasing function of $s$. This monotonicity is the key property that ensures a unique root exists (assuming the particle path is not of infinite length in a perfect vacuum) and allows for robust root-finding algorithms.\n\nNow, we evaluate each option against the problem's requirements.\n\nA. **Start from an arbitrary initial guess $s^{(0)}0$ and apply pure Newton iteration to $f(s) \\equiv \\tau(s) + \\ln \\xi = 0$ using the derivative $f'(s)=\\dfrac{\\mathrm{d}\\Sigma_t(\\boldsymbol{r}_0 + s\\boldsymbol{\\Omega})}{\\mathrm{d}s}$. Do not enforce any bracketing. If the Newton step exits the current material region, accept the step and continue; since the derivative uses the gradient of $\\Sigma_t$, convergence is rapid even across discontinuities.**\n\nThis option is fundamentally flawed for several reasons.\n- **Incorrect Derivative**: The derivative of $f(s) = \\tau(s) + \\ln \\xi$ with respect to $s$ is, by the Fundamental Theorem of Calculus, $f'(s) = \\tau'(s) = \\Sigma_t(\\boldsymbol{r}_0 + s \\boldsymbol{\\Omega})$. The option incorrectly states the derivative is $\\dfrac{\\mathrm{d}\\Sigma_t(\\boldsymbol{r}_0 + s\\boldsymbol{\\Omega})}{\\mathrm{d}s}$. This would be the second derivative of $\\tau(s)$.\n- **Lack of Robustness**: Pure Newton's method, without safeguarding or bracketing, is not globally convergent. The macroscopic cross section $\\Sigma_t(\\boldsymbol{r})$ is discontinuous across material interfaces. These discontinuities mean the derivative $f'(s)$ is itself discontinuous. Applying Newton's method across such discontinuities is unstable and can lead to divergence, oscillation, or steps to non-physical (negative) path lengths. The assertion that convergence is rapid across discontinuities is false; this is precisely where the method is most likely to fail.\n- **Failure to Meet Criteria**: This algorithm does not use geometry to form a bracket (criterion 1), and its convergence is not guaranteed (criterion 3). The procedure of blindly accepting steps across material boundaries is a recipe for catastrophic failure.\n\nTherefore, option A is **Incorrect**.\n\nB. **Perform deterministic ray tracing... accumulate partial sums... bracket the root... solve for the local residual distance... using a safeguarded Newton method...**\n\nThis option describes a sophisticated, multi-stage algorithm that directly addresses the complexities of the problem.\n1.  **Ray Tracing and Bracketing**: The algorithm begins by deterministically tracing the particle's path ray $\\boldsymbol{r}_0 + s \\boldsymbol{\\Omega}$ through the geometric model. This identifies a sequence of path segments, indexed by $j$, each with length $\\ell_j$. This is a standard procedure in modern Monte Carlo codes.\n2.  **Bracket Identification**: It then computes the optical depth of each segment, $I_j$, and accumulates them into partial sums $\\tau_k = \\sum_{j=1}^{k} I_j$. By checking the condition $\\tau_{k^\\star-1} \\le -\\ln \\xi \\le \\tau_{k^\\star}$ (with $\\tau_0 \\equiv 0$), it identifies the specific segment $k^\\star$ in which the collision must occur. This robustly establishes a tight bracketing interval for the total path length $s$, namely $s \\in [\\sum_{j=1}^{k^\\star-1} \\ell_j, \\sum_{j=1}^{k^\\star} \\ell_j]$. This perfectly satisfies criterion 1.\n3.  **Local Root-Finding Problem**: The problem is then recast to find the residual distance $\\delta$ within this segment $k^\\star$. The equation becomes solving $g(\\delta) = 0$ for $\\delta \\in [0, \\ell_{k^\\star}]$, where $g(\\delta) = \\int_{0}^{\\delta} \\Sigma_t\\big(\\boldsymbol{r}_{k^\\star}^{\\text{start}} + s' \\boldsymbol{\\Omega}\\big)\\,\\mathrm{d}s' - C$, and $C = (-\\ln \\xi) - \\tau_{k^\\star-1}$ is the residual optical depth to be traversed.\n4.  **Integration Accuracy**: The option correctly specifies that segment integrals $I_j$ should be evaluated by a method appropriate for the local behavior of $\\Sigma_t$, such as adaptive quadrature if it varies or direct analytical evaluation if it is constant. This satisfies criterion 2.\n5.  **Robust Root-Finding**: To solve for $\\delta$, it proposes a safeguarded Newton method. The Newton iteration uses the correct derivative $g'(\\delta) = \\Sigma_t(\\boldsymbol{r}_{k^\\star}^{\\text{start}} + \\delta \\boldsymbol{\\Omega})$. The \"safeguard\" — falling back to a bisection step if the Newton step is non-productive or leaves the known bracket $[0, \\ell_{k^\\star}]$ — combines the fast local convergence of Newton's method with the guaranteed convergence of bisection. Since the function $g(\\delta)$ is monotonic within the bracket, convergence is guaranteed. This satisfies criterion 3.\n\nThis algorithm is a comprehensive, correct, and robust solution that is representative of best practices in the field.\n\nTherefore, option B is **Correct**.\n\nC. **Without using geometry, estimate global bounds $\\Sigma_{\\min}$ and $\\Sigma_{\\max}$ along the ray in advance and bracket by $s_L \\equiv (-\\ln \\xi)/\\Sigma_{\\max}$ and $s_U \\equiv (-\\ln \\xi)/\\Sigma_{\\min}$. On $[s_L,s_U]$, solve $f(s) \\equiv \\tau(s) + \\ln \\xi = 0$ using bisection, where each $f(s)$ evaluation uses a fixed-panel trapezoidal rule...**\n\nThis option is numerically naive and impractical.\n- **Bracketing**: The bracketing interval is derived from the inequality $\\Sigma_{\\min} s \\le \\tau(s) \\le \\Sigma_{\\max} s$. While mathematically sound, finding tight global bounds $\\Sigma_{\\min}$ and $\\Sigma_{\\max}$ for a complex geometry without any form of ray tracing is often impossible or leads to very loose bounds (e.g., $\\Sigma_{\\min} \\approx 0$ if voids are possible), making the upper bound $s_U$ excessively large and the method inefficient. This approach explicitly fails criterion 1, which demands geometry-derived segment bounds.\n- **Integration Method**: Using a \"fixed-panel trapezoidal rule with a predetermined number of subintervals\" is a poor choice for integrating a function $\\Sigma_t(\\boldsymbol{r}(s))$ that is piecewise-defined and potentially has large jumps at material interfaces. Such a method would have very low accuracy unless an extremely large number of subintervals were used, rendering it highly inefficient. This fails criterion 2, which requires sufficient accuracy.\n- **Root-Finding Method**: While bisection guarantees convergence (satisfying criterion 3), its efficiency depends heavily on the quality of the initial bracket and the cost of function evaluations. Both are poor in this proposed scheme.\n\nTherefore, option C is **Incorrect**.\n\nD. **Replace root-finding entirely by sampling a majorant free path $s' \\equiv (-\\ln \\xi)/\\Sigma_{\\text{maj}}$ with a global majorant $\\Sigma_{\\text{maj}} \\ge \\Sigma_t(\\boldsymbol{r})$ everywhere, then accept the collision at $s'$ with probability $\\Sigma_t(\\boldsymbol{r}_0 + s'\\boldsymbol{\\Omega})/\\Sigma_{\\text{maj}}$, otherwise repeat (delta-tracking). This avoids bracketing and integral evaluation while still drawing the correct path lengths, so it is the most robust way to solve $\\tau(s) = -\\ln \\xi$ in heterogeneous geometries.**\n\nThis option describes the delta-tracking (or Woodcock/majorant kernel) method. This is a valid and often highly effective algorithm for sampling path lengths in complex geometries. However, it is an *alternative* to solving the equation $\\tau(s) = -\\ln \\xi$ via root-finding. The question explicitly asks for a \"numerical root-finding scheme to solve $\\tau(s) = -\\ln \\xi$\" which adheres to specific constraints related to bracketing and integration. The delta-tracking method is an acceptance-rejection technique that cleverly bypasses the need to evaluate the integral $\\tau(s)$ and find the root of the resulting equation. It does not construct a bracketing interval, evaluate integrals of $\\Sigma_t$, or employ a root-finder in the sense intended by the problem statement. Thus, while it is a valid transport algorithm, it is not an answer to the specific question being asked about how to implement the direct inversion method via root-finding.\n\nTherefore, option D is **Incorrect** as an answer to the question posed.\n\nIn summary, Option B is the only one that describes a correct, robust, and efficient numerical root-finding scheme that satisfies all the criteria specified in the problem statement.",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}