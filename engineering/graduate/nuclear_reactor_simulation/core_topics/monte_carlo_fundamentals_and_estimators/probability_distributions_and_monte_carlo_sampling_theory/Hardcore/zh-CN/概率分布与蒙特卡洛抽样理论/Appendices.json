{
    "hands_on_practices": [
        {
            "introduction": "蒙特卡洛方法的核心是将物理过程抽象为概率分布。然而，任何用于模拟的概率密度函数（PDF），无论其物理背景多么复杂，都必须严格遵守概率论的基本公理。本练习  将引导您验证一个在输运理论中常用的一阶各向异性散射模型，通过应用非负性和归一化这两个基本约束，您将推导出模型参数的有效范围。这个过程不仅能加深您对散射核物理意义的理解，更重要的是，它训练了您从第一性原理出发验证理论模型的关键能力。",
            "id": "4242635",
            "problem": "在无限、均匀、单能介质中弹性散射的中子输运蒙特卡罗方法中，一个常用的一阶各向异性模型用于描述散射角余弦 $\\mu \\in [-1,1]$，其概率密度形式为 $p(\\mu) = \\frac{1}{2}\\big(1 + \\alpha \\mu\\big)$。该模型代表了微分散射核的勒让德展开的领头阶截断，并用于根据 $\\alpha$ 的符号将抽样偏向于前向 ($\\mu \\approx 1$) 或后向 ($\\mu \\approx -1$)。仅从概率密度必须在其支撑集上非负且积分为一，以及期望值定义为 $E[\\mu] = \\int_{-1}^{1} \\mu\\, p(\\mu)\\, d\\mu$ 这些基本事实出发，完成以下任务：\n\n1. 仅根据非负性和归一化要求，推导参数 $\\alpha$ 的约束条件，以使 $p(\\mu)$ 在区间 $[-1,1]$ 上是一个有效的概率密度。\n2. 计算一阶矩 $E[\\mu]$，以 $\\alpha$ 的函数形式给出闭合解。\n\n将你的最终答案以一个行矩阵的形式给出，按顺序包含：$E[\\mu]$ 作为 $\\alpha$ 的函数的解析表达式，以及保持非负性的 $\\alpha$ 的下端点值和上端点值。无需四舍五入。不包括单位。你的最终答案必须仅包含这三个按指定顺序排列的条目，所有数学实体均使用 LaTeX 格式。",
            "solution": "首先对问题陈述进行验证。\n\n### 第1步：提取已知条件\n-   **系统：** 中子输运蒙特卡罗中的无限、均匀、单能介质，伴有弹性散射。\n-   **变量：** $\\mu$，散射角余弦。\n-   **变量的支撑集：** $\\mu \\in [-1,1]$。\n-   **概率密度函数 (PDF)：** $p(\\mu) = \\frac{1}{2}\\big(1 + \\alpha \\mu\\big)$。\n-   **参数：** $\\alpha$。\n-   **PDF 的基本公理：**\n    1.  非负性：对于其支撑集中的所有 $\\mu$，$p(\\mu) \\ge 0$。\n    2.  归一化：$\\int_{-1}^{1} p(\\mu)\\, d\\mu = 1$。\n-   **一阶矩（期望值）的定义：** $E[\\mu] = \\int_{-1}^{1} \\mu\\, p(\\mu)\\, d\\mu$。\n-   **任务：**\n    1.  推导 $\\alpha$ 的约束条件，以使 $p(\\mu)$ 为有效的 PDF。\n    2.  计算 $E[\\mu]$ 作为 $\\alpha$ 的函数。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学基础性：** 该问题在科学上是合理的。函数 $p(\\mu) = \\frac{1}{2}\\big(1 + \\alpha \\mu\\big)$ 是输运理论中各向异性散射核的标准一阶勒让德多项式 ($P_1$) 近似。参数 $\\alpha$ 对应于平均散射角余弦的 3 倍，这是一个基本量。概率论的公理被正确陈述，并构成了所需推导的基础。\n-   **适定性：** 该问题是适定的。它提供了所有必要的信息和定义，以推导出关于 $\\alpha$ 约束和 $E[\\mu]$ 值的唯一且有意义的解。\n-   **客观性：** 问题以客观、正式的语言陈述，没有歧义或主观性。\n-   **完整性与一致性：** 该问题是自洽的。所提供的 PDF 和定义是充分的。两个公理（非负性和归一化）是一致的，并构成了验证 PDF 的完整基础。\n\n### 第3步：结论与行动\n问题有效。这是输运理论和应用概率领域的一个标准、基本的推导。现在将执行求解过程。\n\n推导过程根据问题陈述分为两个部分。\n\n### 第1部分：参数 $\\alpha$ 的约束条件\n\n为使 $p(\\mu)$ 成为区间 $[-1, 1]$ 上的有效概率密度函数，它必须满足两个条件：归一化和非负性。\n\n首先，我们检查归一化条件：PDF 在其整个定义域上的积分必须等于 $1$。\n$$ \\int_{-1}^{1} p(\\mu)\\, d\\mu = \\int_{-1}^{1} \\frac{1}{2}(1 + \\alpha \\mu)\\, d\\mu $$\n我们计算该积分：\n$$ \\frac{1}{2} \\int_{-1}^{1} (1 + \\alpha \\mu)\\, d\\mu = \\frac{1}{2} \\left[ \\mu + \\frac{\\alpha \\mu^2}{2} \\right]_{-1}^{1} $$\n在积分上下限处求值：\n$$ \\frac{1}{2} \\left( \\left(1 + \\frac{\\alpha (1)^2}{2}\\right) - \\left(-1 + \\frac{\\alpha (-1)^2}{2}\\right) \\right) = \\frac{1}{2} \\left( 1 + \\frac{\\alpha}{2} - (-1 + \\frac{\\alpha}{2}) \\right) = \\frac{1}{2} \\left( 1 + \\frac{\\alpha}{2} + 1 - \\frac{\\alpha}{2} \\right) = \\frac{1}{2}(2) = 1 $$\n归一化条件对任何实数值 $\\alpha$ 都成立。因此，对 $\\alpha$ 的约束完全来自非负性要求。\n\n其次，我们施加非负性条件：对于所有 $\\mu \\in [-1, 1]$，$p(\\mu) \\ge 0$。\n$$ p(\\mu) = \\frac{1}{2}(1 + \\alpha \\mu) \\ge 0 $$\n由于因子 $\\frac{1}{2}$ 是正的，这等价于：\n$$ 1 + \\alpha \\mu \\ge 0 $$\n函数 $f(\\mu) = 1 + \\alpha \\mu$ 是关于 $\\mu$ 的线性函数。对于闭区间上的线性函数，其最小值必然出现在区间的某个端点上。因此，我们必须确保该函数在 $\\mu = -1$ 和 $\\mu = 1$ 处是非负的。\n\n情况1：在 $\\mu = -1$ 处。\n$$ 1 + \\alpha (-1) \\ge 0 \\implies 1 - \\alpha \\ge 0 \\implies \\alpha \\le 1 $$\n\n情况2：在 $\\mu = 1$ 处。\n$$ 1 + \\alpha (1) \\ge 0 \\implies 1 + \\alpha \\ge 0 \\implies \\alpha \\ge -1 $$\n\n结合这两个约束，我们发现 $\\alpha$ 必须位于闭区间 $[-1, 1]$ 内。\n$$ -1 \\le \\alpha \\le 1 $$\n下端点是 $-1$，上端点是 $1$。\n\n### 第2部分：一阶矩 $E[\\mu]$ 的计算\n\n$\\mu$ 的一阶矩（或期望值）由定义 $E[\\mu] = \\int_{-1}^{1} \\mu\\, p(\\mu)\\, d\\mu$ 给出。\n$$ E[\\mu] = \\int_{-1}^{1} \\mu \\left( \\frac{1}{2}(1 + \\alpha \\mu) \\right) d\\mu $$\n我们展开被积函数：\n$$ E[\\mu] = \\frac{1}{2} \\int_{-1}^{1} (\\mu + \\alpha \\mu^2)\\, d\\mu $$\n我们可以将积分分成两部分：\n$$ E[\\mu] = \\frac{1}{2} \\left( \\int_{-1}^{1} \\mu\\, d\\mu + \\int_{-1}^{1} \\alpha \\mu^2\\, d\\mu \\right) $$\n第一个积分 $\\int_{-1}^{1} \\mu\\, d\\mu$ 是一个奇函数 ($\\mu$) 在对称区间 ($[-1, 1]$) 上的积分，其值为 $0$。\n第二个积分是：\n$$ \\int_{-1}^{1} \\alpha \\mu^2\\, d\\mu = \\alpha \\int_{-1}^{1} \\mu^2\\, d\\mu = \\alpha \\left[ \\frac{\\mu^3}{3} \\right]_{-1}^{1} = \\alpha \\left( \\frac{(1)^3}{3} - \\frac{(-1)^3}{3} \\right) = \\alpha \\left( \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) \\right) = \\alpha \\left( \\frac{2}{3} \\right) $$\n将此结果代回到 $E[\\mu]$ 的表达式中：\n$$ E[\\mu] = \\frac{1}{2} \\left( 0 + \\frac{2\\alpha}{3} \\right) = \\frac{\\alpha}{3} $$\n该分布的一阶矩为 $E[\\mu] = \\frac{\\alpha}{3}$。\n\n### 最终答案组合\n问题要求一个行矩阵，按顺序包含：\n1.  $E[\\mu]$ 的表达式：$\\frac{\\alpha}{3}$。\n2.  $\\alpha$ 的下端点值：$-1$。\n3.  $\\alpha$ 的上端点值：$1$。\n最终答案是包含这些值的 $1 \\times 3$ 矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\alpha}{3}  -1  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在确定了有效的概率模型后，下一步是利用它来估计物理量。然而，对于同一个物理量，往往存在多种不同的估计方法（或称“记分”方法），而它们并非生而平等。本练习  聚焦于比较两种基本的中子流估计量：模拟物理过程的“穿面估计量”和利用解析知识的“下一事件估计量”。通过推导并比较它们的方差，您将具体地理解蒙特卡洛效率的概念，并认识到为何估计量的选择是模拟设计中的一个关键决策。",
            "id": "4242639",
            "problem": "考虑在占据 $x0$ 的均匀、纯吸收半空间介质中的单能中子输运，其宏观总截面 $\\Sigma_{t}$ 与位置和方向无关。一个单位面积的平面探测器位于 $x=L$ 处，用于测量沿 $+x$ 方向流动的净流。位于 $x=0$ 的单能源向 $+x$ 半球发射中子，其角分布为半各向同性：相对于 $+x$ 轴的极角余弦（记为 $\\mu$）在 $[0,1]$ 上均匀抽样，且每个源粒子具有单位统计权重。假设中子在两次碰撞之间沿直线运动，且沿径迹的碰撞间距是从率为 $\\Sigma_{t}$ 的指数分布中抽样得到的。使用两种蒙特卡洛（MC）估计量来估计每个源粒子的探测器流 $J$：\n- 表面估计量：对于每个历史，从 $\\mathrm{Uniform}(0,1)$ 中抽样 $\\mu$，并从率为 $\\Sigma_{t}$ 的指数分布中抽样一个自由程长度 $s$。如果粒子未经碰撞到达探测器（这在 $s \\geq L/\\mu$ 时发生），则得分为 $X_{\\mathrm{surf}}=\\mu$，否则得分为 $X_{\\mathrm{surf}}=0$。\n- 源的碰撞（下一事件）估计量：对于每个历史，从 $\\mathrm{Uniform}(0,1)$ 中抽样 $\\mu$，并得分 $X_{\\mathrm{coll}}=\\mu \\exp(-\\Sigma_{t} L/\\mu)$。\n假设两种估计量的每个历史的计算成本相等，并将估计量的MC效率定义为其每个历史方差的倒数。使用第一性原理的概率分布和蒙特卡洛抽样理论，推导每个估计量的每个历史方差，并计算在指定的探测器几何形状和截面 $\\Sigma_{t}=0.5\\ \\mathrm{cm}^{-1}$ 和 $L=2\\ \\mathrm{cm}$ 下的效率比 $R=\\varepsilon_{\\mathrm{surf}}/\\varepsilon_{\\mathrm{coll}}$。将最终比率 $R$ 表示为一个无量纲数，并将您的答案四舍五入到四位有效数字。",
            "solution": "用户希望我解决以下问题：\n考虑在占据 $x0$ 的均匀、纯吸收半空间介质中的单能中子输运，其宏观总截面 $\\Sigma_{t}$ 与位置和方向无关。一个单位面积的平面探测器位于 $x=L$ 处，用于测量沿 $+x$ 方向流动的净流。位于 $x=0$ 的单能源向 $+x$ 半球发射中子，其角分布为半各向同性：相对于 $+x$ 轴的极角余弦（记为 $\\mu$）在 $[0,1]$ 上均匀抽样，且每个源粒子具有单位统计权重。假设中子在两次碰撞之间沿直线运动，且沿径迹的碰撞间距是从率为 $\\Sigma_{t}$ 的指数分布中抽样得到的。使用两种蒙特卡洛（MC）估计量来估计每个源粒子的探测器流 $J$：\n- 表面估计量：对于每个历史，从 $\\mathrm{Uniform}(0,1)$ 中抽样 $\\mu$，并从率为 $\\Sigma_{t}$ 的指数分布中抽样一个自由程长度 $s$。如果粒子未经碰撞到达探测器（这在 $s \\geq L/\\mu$ 时发生），则得分为 $X_{\\mathrm{surf}}=\\mu$，否则得分为 $X_{\\mathrm{surf}}=0$。\n- 源的碰撞（下一事件）估计量：对于每个历史，从 $\\mathrm{Uniform}(0,1)$ 中抽样 $\\mu$，并得分 $X_{\\mathrm{coll}}=\\mu \\exp(-\\Sigma_{t} L/\\mu)$。\n假设两种估计量的每个历史的计算成本相等，并将估计量的MC效率定义为其每个历史方差的倒数。使用第一性原理的概率分布和蒙特卡洛抽样理论，推导每个估计量的每个历史方差，并计算在指定的探测器几何形状和截面 $\\Sigma_{t}=0.5\\ \\mathrm{cm}^{-1}$ 和 $L=2\\ \\mathrm{cm}$ 下的效率比 $R=\\varepsilon_{\\mathrm{surf}}/\\varepsilon_{\\mathrm{coll}}$。将最终比率 $R$ 表示为一个无量纲数，并将您的答案四舍五入到四位有效数字。\n\n### 第一步：提取已知条件\n- 介质：占据 $x0$ 的均匀、纯吸收半空间。\n- 宏观总截面：$\\Sigma_{t}$，常数。\n- 探测器：平面，单位面积，位于 $x=L$，测量 $+x$ 方向的净流。\n- 源：位于 $x=0$，单能，向 $+x$ 半球发射。\n- 源角分布：极角余弦 $\\mu$ 从 $\\mathrm{Uniform}(0,1)$ 中抽样，即其概率密度函数（PDF）为 $p(\\mu) = 1$（对于 $\\mu \\in [0,1]$）。\n- 源粒子权重：$1$。\n- 碰撞间距 $s$：从率为 $\\Sigma_t$ 的指数分布中抽样，即 PDF 为 $f(s) = \\Sigma_t \\exp(-\\Sigma_t s)$（对于 $s \\ge 0$）。\n- 表面估计量得分：若 $s \\ge L/\\mu$，则 $X_{\\mathrm{surf}} = \\mu$，否则 $X_{\\mathrm{surf}} = 0$。\n- 碰撞估计量得分：$X_{\\mathrm{coll}} = \\mu \\exp(-\\Sigma_t L/\\mu)$。\n- MC效率：$\\varepsilon = 1 / \\mathrm{Var}(X)$，其中 $\\mathrm{Var}(X)$ 是估计量 $X$ 的每个历史方差。\n- 目标：计算效率比 $R = \\varepsilon_{\\mathrm{surf}} / \\varepsilon_{\\mathrm{coll}}$。\n- 参数：$\\Sigma_t = 0.5\\ \\mathrm{cm}^{-1}$，$L = 2\\ \\mathrm{cm}$。\n- 最终答案格式：无量纲数，四舍五入到四位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n根据指定标准对问题进行验证。\n- **科学性**：该问题是核反应堆物理学中的一个标准（尽管简化了）练习，特别是在粒子输运的蒙特卡洛方法方面。截面、路径长度抽样、流和定义的估计量（表面穿越和下一事件）等概念都是基本且正确的。源角分布虽然是一个特定的数学选择，但对于一个理论问题来说，其定义明确，没有违反任何物理原理。该问题牢固地建立在已有的概率论和输运理论之上。\n- **适定性**：问题是完全指定的。所有必要的数据（$\\Sigma_t$、$L$）、分布（$p(\\mu)$、$f(s)$）和估计量定义（$X_{\\mathrm{surf}}$、$X_{\\mathrm{coll}}$）都已提供。目标明确。存在唯一、稳定且有意义的解。\n- **客观性**：问题以精确、定量和无偏见的语言陈述。没有主观因素。\n- **结论**：该问题不违反任何无效标准。它科学合理、适定、客观且可形式化。\n\n### 第三步：判定与行动\n问题被判定为**有效**。将提供完整解答。\n\n### 解题推导\n\n目标是计算表面估计量 ($X_{\\mathrm{surf}}$) 和碰撞估计量 ($X_{\\mathrm{coll}}$) 的效率比 $R$。估计量的效率 $\\varepsilon$ 定义为其每个历史方差的倒数。假设每个历史的计算成本相等，效率比由其方差的反比给出：\n$$R = \\frac{\\varepsilon_{\\mathrm{surf}}}{\\varepsilon_{\\mathrm{coll}}} = \\frac{1 / \\mathrm{Var}(X_{\\mathrm{surf}})}{1 / \\mathrm{Var}(X_{\\mathrm{coll}})} = \\frac{\\mathrm{Var}(X_{\\mathrm{coll}})}{\\mathrm{Var}(X_{\\mathrm{surf}})}$$\n随机变量 $X$ 的方差由公式 $\\mathrm{Var}(X) = E[X^2] - (E[X])^2$ 给出。因此，我们必须计算每个估计量的一阶矩和二阶矩。两种估计量都旨在估计同一物理量：每个源粒子在探测器平面 $x=L$ 处的净流 $J$。因此，它们必须是无偏的，即它们的期望值应等于真实流 $J$。\n\n首先，让我们确定流的真实值 $J$。一个源粒子在 $x=0$ 处以角度余弦 $\\mu$ 发射，其中 $\\mu$ 从 $p(\\mu)=1$ on $[0,1]$ 中抽取。要使该粒子到达位于 $x=L$ 的探测器，它必须在不发生碰撞的情况下行进至少 $L/\\mu$ 的距离。发生这种情况的概率是 $\\exp(-\\Sigma_t (L/\\mu))$。如果粒子到达探测器，它对净流的贡献是其权重（为 $1$）乘以 $\\mu$。总期望流 $J$ 是通过对所有可能的源方向积分此贡献而获得的：\n$$J = \\int_{0}^{1} (\\text{current contribution}) \\times (\\text{probability of reaching detector}) \\times p(\\mu) d\\mu$$\n$$J = \\int_{0}^{1} \\mu \\cdot \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) \\cdot 1 \\,d\\mu = \\int_{0}^{1} \\mu \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) d\\mu$$\n这个积分可以用指数积分函数 $E_n(z) = \\int_{1}^{\\infty} t^{-n} \\exp(-zt) dt$ 来表示。通过换元 $u=1/\\mu$，我们得到 $d\\mu = -du/u^2$。积分限从 $\\mu=0 \\to 1$ 变为 $u=\\infty \\to 1$。\n$$J = \\int_{\\infty}^{1} \\frac{1}{u} \\exp(-\\Sigma_t L u) \\left(-\\frac{du}{u^2}\\right) = \\int_{1}^{\\infty} \\frac{\\exp(-\\Sigma_t L u)}{u^3} du = E_3(\\Sigma_t L)$$\n\n接下来，我们验证两种估计量都是无偏的，并计算它们的二阶矩。\n\n**表面估计量 ($X_{\\mathrm{surf}}$) 分析**\n若 $s \\ge L/\\mu$，得分为 $X_{\\mathrm{surf}} = \\mu$；否则为 $0$。期望值通过对 $\\mu$ 和 $s$ 的分布求平均来找到。我们使用全期望定律，$E[X] = E_{\\mu}[E_s[X|\\mu]]$。对于一个固定的 $\\mu$，成功事件（$s \\ge L/\\mu$）的概率是 $P(s \\ge L/\\mu) = \\int_{L/\\mu}^{\\infty} \\Sigma_t \\exp(-\\Sigma_t s) ds = \\exp(-\\Sigma_t L/\\mu)$。\n给定 $\\mu$ 时得分的条件期望是：\n$$E_s[X_{\\mathrm{surf}}|\\mu] = \\mu \\cdot P(s \\ge L/\\mu) + 0 \\cdot P(s  L/\\mu) = \\mu \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right)$$\n然后通过对 $\\mu$ 求平均得到总期望：\n$$E[X_{\\mathrm{surf}}] = \\int_{0}^{1} E_s[X_{\\mathrm{surf}}|\\mu] p(\\mu) d\\mu = \\int_{0}^{1} \\mu \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) d\\mu = J = E_3(\\Sigma_t L)$$\n该估计量是无偏的。二阶矩的计算方法类似：\n$$E_s[X_{\\mathrm{surf}}^2|\\mu] = \\mu^2 \\cdot P(s \\ge L/\\mu) + 0^2 \\cdot P(s  L/\\mu) = \\mu^2 \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right)$$\n$$E[X_{\\mathrm{surf}}^2] = \\int_{0}^{1} \\mu^2 \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) d\\mu$$\n使用相同的换元 $u=1/\\mu$，此积分变为：\n$$E[X_{\\mathrm{surf}}^2] = \\int_{\\infty}^{1} \\frac{1}{u^2} \\exp(-\\Sigma_t L u) \\left(-\\frac{du}{u^2}\\right) = \\int_{1}^{\\infty} \\frac{\\exp(-\\Sigma_t L u)}{u^4} du = E_4(\\Sigma_t L)$$\n表面估计量的方差是：\n$$\\mathrm{Var}(X_{\\mathrm{surf}}) = E[X_{\\mathrm{surf}}^2] - (E[X_{\\mathrm{surf}}])^2 = E_4(\\Sigma_t L) - [E_3(\\Sigma_t L)]^2$$\n\n**碰撞（下一事件）估计量 ($X_{\\mathrm{coll}}$) 分析**\n得分为 $X_{\\mathrm{coll}} = \\mu \\exp(-\\Sigma_t L/\\mu)$，它是随机变量 $\\mu$ 的一个确定性函数。\n期望值为：\n$$E[X_{\\mathrm{coll}}] = \\int_{0}^{1} X_{\\mathrm{coll}}(\\mu) p(\\mu) d\\mu = \\int_{0}^{1} \\mu \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) d\\mu = J = E_3(\\Sigma_t L)$$\n该估计量也是无偏的。二阶矩为：\n$$E[X_{\\mathrm{coll}}^2] = \\int_{0}^{1} [X_{\\mathrm{coll}}(\\mu)]^2 p(\\mu) d\\mu = \\int_{0}^{1} \\left(\\mu \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right)\\right)^2 d\\mu = \\int_{0}^{1} \\mu^2 \\exp\\left(-\\frac{2\\Sigma_t L}{\\mu}\\right) d\\mu$$\n使用换元 $u=1/\\mu$，此积分变为：\n$$E[X_{\\mathrm{coll}}^2] = \\int_{\\infty}^{1} \\frac{1}{u^2} \\exp(-2\\Sigma_t L u) \\left(-\\frac{du}{u^2}\\right) = \\int_{1}^{\\infty} \\frac{\\exp(-2\\Sigma_t L u)}{u^4} du = E_4(2\\Sigma_t L)$$\n碰撞估计量的方差是：\n$$\\mathrm{Var}(X_{\\mathrm{coll}}) = E[X_{\\mathrm{coll}}^2] - (E[X_{\\mathrm{coll}}])^2 = E_4(2\\Sigma_t L) - [E_3(\\Sigma_t L)]^2$$\n\n**效率比**\n现在我们可以写出效率比 $R$ 的表达式：\n$$R = \\frac{\\mathrm{Var}(X_{\\mathrm{coll}})}{\\mathrm{Var}(X_{\\mathrm{surf}})} = \\frac{E_4(2\\Sigma_t L) - [E_3(\\Sigma_t L)]^2}{E_4(\\Sigma_t L) - [E_3(\\Sigma_t L)]^2}$$\n\n**数值计算**\n问题给出的值为 $\\Sigma_t = 0.5\\ \\mathrm{cm}^{-1}$ 和 $L = 2\\ \\mathrm{cm}$。无量纲光学厚度为 $\\tau = \\Sigma_t L = (0.5)(2) = 1$。\n将 $\\tau=1$ 代入 $R$ 的表达式中：\n$$R = \\frac{E_4(2) - [E_3(1)]^2}{E_4(1) - [E_3(1)]^2}$$\n我们使用指数积分函数 $E_n(z)$ 的标准库值：\n- $E_3(1) \\approx 0.10969197$\n- $E_4(1) \\approx 0.08606241$\n- $E_4(2) \\approx 0.02502268$\n\n现在，我们计算方差：\n- 首先，是平均值的平方：\n$$[E_3(1)]^2 \\approx (0.10969197)^2 \\approx 0.01203233$$\n- 碰撞估计量的方差：\n$$\\mathrm{Var}(X_{\\mathrm{coll}}) = E_4(2) - [E_3(1)]^2 \\approx 0.02502268 - 0.01203233 = 0.01299035$$\n- 表面估计量的方差：\n$$\\mathrm{Var}(X_{\\mathrm{surf}}) = E_4(1) - [E_3(1)]^2 \\approx 0.08606241 - 0.01203233 = 0.07403008$$\n最后，我们计算比率 $R$：\n$$R = \\frac{0.01299035}{0.07403008} \\approx 0.17547444$$\n将结果四舍五入到四位有效数字，我们得到 $0.1755$。",
            "answer": "$$\\boxed{0.1755}$$"
        },
        {
            "introduction": "既然我们已经认识到不同估计量的效率存在差异，一个自然的问题是：我们能否主动地设计出更高效的抽样方案来提高模拟精度？这对于像深度穿透这样的稀有事件问题尤其重要。本练习  引入了一种强大的方差缩减技术——重要性抽样。您将具体分析“指数变换”法，即通过人为地“倾斜”原始概率分布来增加我们关心的稀有事件的发生频率，并通过推导方差缩减因子，您将严谨地理解重要性抽样是如何通过“似然比”权重修正偏差，最终以更少的计算量获得更精确估计的。",
            "id": "4242617",
            "problem": "考虑一个厚度为 $T$ 的一维平板，该平板由宏观吸收截面为 $\\Sigma$ 的纯吸收介质构成。一个单能粒子在 $x=0$ 处发射，并沿 $+x$ 方向直线行进，直至被吸收。在反应堆物理学中，均匀介质中到达吸收点的自由程 $S$ 通过吸收的泊松过程建模，这意味着 $S$ 服从指数分布，其概率密度函数为 $f(s) = \\Sigma \\exp(-\\Sigma s)$（$s \\geq 0$）。待求量为透射概率 $p = \\mathbb{P}(S  T)$。\n\n我们希望使用蒙特卡罗（MC）方法来估计 $p$。在简单蒙特卡罗方法下，我们从 $S \\sim \\text{Exp}(\\Sigma)$ 中抽样，并使用无偏指示符估计量 $X = \\mathbf{1}\\{S  T\\}$。在重要性抽样方法下，考虑通过对自由程分布进行指数倾斜，从 $S' \\sim \\text{Exp}(\\Sigma')$ 中抽样，其中倾斜参数 $\\Sigma' \\in (0, 2\\Sigma)$。然后使用无偏加权估计量 $Y = \\mathbf{1}\\{S'  T\\} W$，其中似然比权重为 $W = \\frac{f(S')}{f'(S')}$，倾斜后的密度为 $f'(s) = \\Sigma' \\exp(-\\Sigma' s)$。\n\n从泊松吸收过程产生的指数自由程模型、无偏蒙特卡罗估计量的定义以及重要性抽样的似然比原理出发，推导方差缩减因子\n$$V_{\\mathrm{RF}} = \\frac{\\operatorname{Var}(X)}{\\operatorname{Var}(Y)}$$\n的闭式解析表达式，该表达式是 $\\Sigma$、$T$ 和 $\\Sigma'$ 的函数，且满足 $Y$ 的二阶矩有限性所需的条件 $\\Sigma' \\in (0, 2\\Sigma)$。\n\n将最终答案表示为单个闭式解析表达式。最终答案无需数值舍入或单位。",
            "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 一个厚度为 $T$ 的一维平板。\n- 该介质的宏观吸收截面为 $\\Sigma$。\n- 粒子的吸收自由程 $S$ 服从指数分布，其概率密度函数（PDF）为 $f(s) = \\Sigma \\exp(-\\Sigma s)$（$s \\geq 0$）。\n- 待求量为透射概率 $p = \\mathbb{P}(S  T)$。\n- 简单蒙特卡罗（CMC）估计量为 $X = \\mathbf{1}\\{S  T\\}$，其中 $S \\sim \\text{Exp}(\\Sigma)$。\n- 重要性抽样（IS）估计量使用一个新的随机变量 $S'$ 的倾斜分布，其概率密度函数为 $f'(s) = \\Sigma' \\exp(-\\Sigma' s)$，其中倾斜参数 $\\Sigma' \\in (0, 2\\Sigma)$。\n- 重要性抽样估计量为 $Y = \\mathbf{1}\\{S'  T\\} W$，其中 $S' \\sim \\text{Exp}(\\Sigma')$。\n- 似然比权重为 $W = \\frac{f(S')}{f'(S')}$。\n- 目标是推导方差缩减因子 $V_{\\mathrm{RF}} = \\frac{\\operatorname{Var}(X)}{\\operatorname{Var}(Y)}$，作为 $\\Sigma$、$T$ 和 $\\Sigma'$ 的函数。\n- 已指定条件 $\\Sigma' \\in (0, 2\\Sigma)$ 是 $Y$ 的二阶矩有限性所必需的。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题进行验证：\n- **科学依据**：该问题是蒙特卡罗方法在粒子输运中的经典应用，这是核工程和物理学的核心课题。自由程的指数分布是假设相互作用截面恒定（空间中的泊松过程）的基本结果，而通过指数倾斜进行的重要性抽样是一种标准且易于理解的方差缩减技术。该设置在科学上是合理的。\n- **适定性**：该问题在数学上是适定的。所有估计量、概率分布和参数都已指定。目标是推导一个特定的解析表达式，这是一项清晰明确的任务。所给条件 $\\Sigma' \\in (0, 2\\Sigma)$ 确保了重要性抽样估计量的方差是有限的，从而使问题成为适定的。\n- **客观性**：该问题以精确、客观的数学和物理语言陈述，没有主观或模棱两可的术语。\n\n基于此分析，该问题被认为是有效的，因为它具有科学依据、适定性和客观性，没有可识别的缺陷。我们可以继续进行求解。\n\n### 方差缩减因子的推导\n\n方差缩减因子定义为 $V_{\\mathrm{RF}} = \\frac{\\operatorname{Var}(X)}{\\operatorname{Var}(Y)}$。我们将分别推导 $\\operatorname{Var}(X)$ 和 $\\operatorname{Var}(Y)$ 的表达式。\n\n**1. 简单蒙特卡罗估计量的方差，$\\operatorname{Var}(X)$**\n\n简单蒙特卡罗估计量为 $X = \\mathbf{1}\\{S  T\\}$，其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数，自由程 $S$ 从物理分布 $f(s) = \\Sigma \\exp(-\\Sigma s)$ 中抽样。\n估计量 $X$ 是一个伯努利随机变量，如果粒子透射（事件 $ST$），则取值为1，否则为0。“成功”概率是透射概率 $p$。\n首先，我们计算 $p$：\n$$p = \\mathbb{P}(S  T) = \\int_T^\\infty f(s) ds = \\int_T^\\infty \\Sigma \\exp(-\\Sigma s) ds$$\n$$p = [-\\exp(-\\Sigma s)]_T^\\infty = 0 - (-\\exp(-\\Sigma T)) = \\exp(-\\Sigma T)$$\nX 的期望值为 $\\mathbb{E}[X] = 1 \\cdot \\mathbb{P}(S  T) + 0 \\cdot \\mathbb{P}(S \\le T) = p$，这证实了 $X$ 是 $p$ 的一个无偏估计量。\n对于伯努利随机变量，方差由 $p(1 - p)$ 给出。\n因此，简单蒙特卡罗估计量的方差为：\n$$\\operatorname{Var}(X) = p(1 - p) = \\exp(-\\Sigma T) (1 - \\exp(-\\Sigma T)) = \\exp(-\\Sigma T) - \\exp(-2\\Sigma T)$$\n\n**2. 重要性抽样估计量的方差，$\\operatorname{Var}(Y)$**\n\n重要性抽样估计量为 $Y = \\mathbf{1}\\{S'  T\\} W$，其中自由程 $S'$ 从倾斜分布 $f'(s') = \\Sigma' \\exp(-\\Sigma' s')$ 中抽样。权重 $W$ 用于校正测度变换。\n权重是似然比：\n$$W = \\frac{f(S')}{f'(S')} = \\frac{\\Sigma \\exp(-\\Sigma S')}{\\Sigma' \\exp(-\\Sigma' S')} = \\frac{\\Sigma}{\\Sigma'} \\exp((\\Sigma' - \\Sigma)S')$$\n估计量 $Y$ 被构造成无偏的，即 $\\mathbb{E}[Y] = p$。期望是相对于抽样分布 $f'$ 计算的：\n$$\\mathbb{E}[Y] = \\mathbb{E}_{f'}[\\mathbf{1}\\{S'  T\\} W] = \\int_T^\\infty W(s) f'(s) ds = \\int_T^\\infty \\frac{f(s)}{f'(s)} f'(s) ds = \\int_T^\\infty f(s) ds = p$$\n$Y$ 的方差由 $\\operatorname{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2$ 给出。因为 $\\mathbb{E}[Y] = p$，我们有 $(\\mathbb{E}[Y])^2 = p^2 = \\exp(-2\\Sigma T)$。\n我们现在计算二阶矩，$\\mathbb{E}[Y^2]$：\n$$Y^2 = (\\mathbf{1}\\{S'  T\\} W)^2 = \\mathbf{1}\\{S'  T\\} W^2$$\n$$\\mathbb{E}[Y^2] = \\mathbb{E}_{f'}[\\mathbf{1}\\{S'  T\\} W^2] = \\int_T^\\infty (W(s))^2 f'(s) ds$$\n积分中的项为 $(W(s))^2 f'(s) = \\left(\\frac{f(s)}{f'(s)}\\right)^2 f'(s) = \\frac{(f(s))^2}{f'(s)}$。\n代入概率密度函数的显式形式：\n$$\\frac{(f(s))^2}{f'(s)} = \\frac{(\\Sigma \\exp(-\\Sigma s))^2}{\\Sigma' \\exp(-\\Sigma' s)} = \\frac{\\Sigma^2 \\exp(-2\\Sigma s)}{\\Sigma' \\exp(-\\Sigma' s)} = \\frac{\\Sigma^2}{\\Sigma'} \\exp(-(2\\Sigma - \\Sigma')s)$$\n现在我们将此表达式从 $T$ 积分到 $\\infty$：\n$$\\mathbb{E}[Y^2] = \\int_T^\\infty \\frac{\\Sigma^2}{\\Sigma'} \\exp(-(2\\Sigma - \\Sigma')s) ds$$\n该积分收敛当且仅当 $2\\Sigma - \\Sigma'  0$，即 $\\Sigma'  2\\Sigma$。问题陈述中说明 $\\Sigma' \\in (0, 2\\Sigma)$，因此积分如预期是有限的。\n$$\\mathbb{E}[Y^2] = \\frac{\\Sigma^2}{\\Sigma'} \\left[ \\frac{\\exp(-(2\\Sigma - \\Sigma')s)}{-(2\\Sigma - \\Sigma')} \\right]_T^\\infty = \\frac{\\Sigma^2}{\\Sigma'} \\left( 0 - \\frac{\\exp(-(2\\Sigma - \\Sigma')T)}{-(2\\Sigma - \\Sigma')} \\right)$$\n$$\\mathbb{E}[Y^2] = \\frac{\\Sigma^2}{\\Sigma'(2\\Sigma - \\Sigma')} \\exp(-(2\\Sigma - \\Sigma')T)$$\n现在我们可以写出 $Y$ 的方差：\n$$\\operatorname{Var}(Y) = \\mathbb{E}[Y^2] - p^2 = \\frac{\\Sigma^2}{\\Sigma'(2\\Sigma - \\Sigma')} \\exp(-(2\\Sigma - \\Sigma')T) - \\exp(-2\\Sigma T)$$\n\n**3. 方差缩减因子，$V_{\\mathrm{RF}}$**\n\n我们现在可以构造比值 $V_{\\mathrm{RF}} = \\frac{\\operatorname{Var}(X)}{\\operatorname{Var}(Y)}$：\n$$V_{\\mathrm{RF}} = \\frac{\\exp(-\\Sigma T) - \\exp(-2\\Sigma T)}{\\frac{\\Sigma^2}{\\Sigma'(2\\Sigma - \\Sigma')} \\exp(-(2\\Sigma - \\Sigma')T) - \\exp(-2\\Sigma T)}$$\n为了简化，我们可以从分子和分母中提出因子 $\\exp(-2\\Sigma T)$。\n分子：$\\exp(-\\Sigma T) - \\exp(-2\\Sigma T) = \\exp(-2\\Sigma T)(\\exp(\\Sigma T) - 1)$。\n分母：$\\frac{\\Sigma^2}{\\Sigma'(2\\Sigma - \\Sigma')} \\exp(-2\\Sigma T + \\Sigma'T) - \\exp(-2\\Sigma T) = \\exp(-2\\Sigma T) \\left( \\frac{\\Sigma^2 \\exp(\\Sigma' T)}{\\Sigma'(2\\Sigma - \\Sigma')} - 1 \\right)$。\n$\\exp(-2\\Sigma T)$ 项相互抵消：\n$$V_{\\mathrm{RF}} = \\frac{\\exp(\\Sigma T) - 1}{\\frac{\\Sigma^2 \\exp(\\Sigma' T)}{\\Sigma'(2\\Sigma - \\Sigma')} - 1}$$\n为了消去繁分数，我们为分母项通分：\n$$V_{\\mathrm{RF}} = \\frac{\\exp(\\Sigma T) - 1}{\\frac{\\Sigma^2 \\exp(\\Sigma' T) - \\Sigma'(2\\Sigma - \\Sigma')}{\\Sigma'(2\\Sigma - \\Sigma')}}$$\n整理该表达式得到最终的闭式结果：\n$$V_{\\mathrm{RF}} = \\frac{(\\exp(\\Sigma T) - 1)\\Sigma'(2\\Sigma - \\Sigma')}{\\Sigma^2 \\exp(\\Sigma' T) - \\Sigma'(2\\Sigma - \\Sigma')}$$\n为了更清晰，可以展开分母中的表达式：\n$$V_{\\mathrm{RF}} = \\frac{(\\exp(\\Sigma T) - 1)\\Sigma'(2\\Sigma - \\Sigma')}{\\Sigma^2 \\exp(\\Sigma' T) - 2\\Sigma\\Sigma' + (\\Sigma')^2}$$\n这就是方差缩减因子作为 $\\Sigma$、$T$ 和 $\\Sigma'$ 的函数的最终解析表达式。",
            "answer": "$$\\boxed{\\frac{(\\exp(\\Sigma T) - 1)\\Sigma'(2\\Sigma - \\Sigma')}{\\Sigma^2 \\exp(\\Sigma' T) - 2\\Sigma\\Sigma' + (\\Sigma')^2}}$$"
        }
    ]
}