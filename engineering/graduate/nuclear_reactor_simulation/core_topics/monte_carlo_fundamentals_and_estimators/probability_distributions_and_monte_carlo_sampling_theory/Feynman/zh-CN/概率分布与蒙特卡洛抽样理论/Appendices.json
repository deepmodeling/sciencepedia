{
    "hands_on_practices": [
        {
            "introduction": "在蒙特卡罗方法中，物理定律通常通过概率分布来描述。本练习  将探讨一个简单但至关重要的中子各向异性散射模型。您将运用概率论的基本公理——非负性和归一化——来确定该物理模型的有效参数范围，从而加深对物理现实与其数学表示之间基本联系的理解。",
            "id": "4242635",
            "problem": "在无限、均匀、单能介质中弹性散射的中子输运蒙特卡罗方法中，一个常用的一阶各向异性模型用于描述散射角余弦 $\\mu \\in [-1,1]$，其概率密度形式为 $p(\\mu) = \\frac{1}{2}\\big(1 + \\alpha \\mu\\big)$。该模型代表了微分散射核的勒让德展开式的领头阶截断，并根据 $\\alpha$ 的符号，用于将抽样偏向于前向（$\\mu \\approx 1$）或后向（$\\mu \\approx -1$）散射。仅从概率密度必须非负且在其支撑域上的积分为1，以及期望值定义为 $E[\\mu] = \\int_{-1}^{1} \\mu\\, p(\\mu)\\, d\\mu$ 这些基本事实出发，完成以下任务：\n\n1. 仅基于非负性和归一化要求，推导参数 $\\alpha$ 的约束条件，以使 $p(\\mu)$ 在区间 $[-1,1]$ 上是一个有效的概率密度。\n2. 以 $\\alpha$ 的函数形式，计算一阶矩 $E[\\mu]$ 的闭合表达式。\n\n你的最终答案应为一个行矩阵，按顺序包含：$E[\\mu]$ 作为 $\\alpha$ 函数的解析表达式，以及保持非负性的 $\\alpha$ 的下端点值和上端点值。无需四舍五入。不要包含单位。你的最终答案必须仅包含按指定顺序排列的这三项，所有数学实体均使用 LaTeX 格式。",
            "solution": "首先对问题陈述进行验证。\n\n### 第1步：提取已知条件\n-   **系统：** 无限、均匀、单能介质中的中子输运蒙特卡罗弹性散射。\n-   **变量：** $\\mu$，散射角余弦。\n-   **变量支撑域：** $\\mu \\in [-1,1]$。\n-   **概率密度函数 (PDF)：** $p(\\mu) = \\frac{1}{2}\\big(1 + \\alpha \\mu\\big)$。\n-   **参数：** $\\alpha$。\n-   **PDF的基本公理：**\n    1.  非负性：对于其支撑域中的所有 $\\mu$，有 $p(\\mu) \\ge 0$。\n    2.  归一化：$\\int_{-1}^{1} p(\\mu)\\, d\\mu = 1$。\n-   **一阶矩（期望值）的定义：** $E[\\mu] = \\int_{-1}^{1} \\mu\\, p(\\mu)\\, d\\mu$。\n-   **任务：**\n    1.  推导使 $p(\\mu)$ 成为有效PDF的 $\\alpha$ 的约束条件。\n    2.  计算 $E[\\mu]$ 作为 $\\alpha$ 的函数。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学基础：** 该问题在科学上是合理的。函数 $p(\\mu) = \\frac{1}{2}\\big(1 + \\alpha \\mu\\big)$ 是输运理论中各向异性散射核的标准一阶勒让德多项式 ($P_1$) 近似。参数 $\\alpha$ 对应于平均散射角余弦的3倍，这是一个基本量。概率论的公理被正确陈述，并构成了所需推导的基础。\n-   **适定性：** 该问题是适定的。它提供了推导 $\\alpha$ 的约束条件和 $E[\\mu]$ 值的唯一且有意义的解所需的所有必要信息和定义。\n-   **客观性：** 问题以客观、正式的语言陈述，没有歧义或主观性。\n-   **完备性与一致性：** 问题是自洽的。所提供的PDF和定义是充分的。两条公理（非负性和归一化）是一致的，并构成了验证PDF的完整基础。\n\n### 第3步：结论与行动\n问题是有效的。这是输运理论和应用概率领域的一个标准的基础推导。现在将执行求解过程。\n\n推导过程分两部分进行，正如问题陈述所要求。\n\n### 第1部分：参数 $\\alpha$ 的约束条件\n\n要使 $p(\\mu)$ 成为区间 $[-1, 1]$ 上的有效概率密度函数，它必须满足两个条件：归一化和非负性。\n\n首先，我们检查归一化条件：PDF在其整个定义域上的积分必须等于$1$。\n$$ \\int_{-1}^{1} p(\\mu)\\, d\\mu = \\int_{-1}^{1} \\frac{1}{2}(1 + \\alpha \\mu)\\, d\\mu $$\n我们计算积分：\n$$ \\frac{1}{2} \\int_{-1}^{1} (1 + \\alpha \\mu)\\, d\\mu = \\frac{1}{2} \\left[ \\mu + \\frac{\\alpha \\mu^2}{2} \\right]_{-1}^{1} $$\n在积分上下限处求值：\n$$ \\frac{1}{2} \\left( \\left(1 + \\frac{\\alpha (1)^2}{2}\\right) - \\left(-1 + \\frac{\\alpha (-1)^2}{2}\\right) \\right) = \\frac{1}{2} \\left( 1 + \\frac{\\alpha}{2} - (-1 + \\frac{\\alpha}{2}) \\right) = \\frac{1}{2} \\left( 1 + \\frac{\\alpha}{2} + 1 - \\frac{\\alpha}{2} \\right) = \\frac{1}{2}(2) = 1 $$\n归一化条件对任何实数 $\\alpha$ 都满足。因此，对 $\\alpha$ 的约束完全来自非负性要求。\n\n其次，我们施加非负性条件：对于所有 $\\mu \\in [-1, 1]$，有 $p(\\mu) \\ge 0$。\n$$ p(\\mu) = \\frac{1}{2}(1 + \\alpha \\mu) \\ge 0 $$\n由于因子 $\\frac{1}{2}$ 是正的，这等价于：\n$$ 1 + \\alpha \\mu \\ge 0 $$\n函数 $f(\\mu) = 1 + \\alpha \\mu$ 是关于 $\\mu$ 的线性函数。对于闭区间上的线性函数，其最小值必然出现在区间的某个端点上。因此，我们必须确保函数在 $\\mu = -1$ 和 $\\mu = 1$ 处非负。\n\n情况1：在 $\\mu = -1$ 处。\n$$ 1 + \\alpha (-1) \\ge 0 \\implies 1 - \\alpha \\ge 0 \\implies \\alpha \\le 1 $$\n\n情况2：在 $\\mu = 1$ 处。\n$$ 1 + \\alpha (1) \\ge 0 \\implies 1 + \\alpha \\ge 0 \\implies \\alpha \\ge -1 $$\n\n结合这两个约束条件，我们发现 $\\alpha$ 必须位于闭区间 $[-1, 1]$ 内。\n$$ -1 \\le \\alpha \\le 1 $$\n下端点是 $-1$，上端点是 $1$。\n\n### 第2部分：一阶矩 $E[\\mu]$ 的计算\n\n$\\mu$ 的一阶矩，即期望值，由定义 $E[\\mu] = \\int_{-1}^{1} \\mu\\, p(\\mu)\\, d\\mu$ 给出。\n$$ E[\\mu] = \\int_{-1}^{1} \\mu \\left( \\frac{1}{2}(1 + \\alpha \\mu) \\right) d\\mu $$\n我们展开被积函数：\n$$ E[\\mu] = \\frac{1}{2} \\int_{-1}^{1} (\\mu + \\alpha \\mu^2)\\, d\\mu $$\n我们可以将积分分成两部分：\n$$ E[\\mu] = \\frac{1}{2} \\left( \\int_{-1}^{1} \\mu\\, d\\mu + \\int_{-1}^{1} \\alpha \\mu^2\\, d\\mu \\right) $$\n第一个积分 $\\int_{-1}^{1} \\mu\\, d\\mu$ 是一个奇函数（$\\mu$）在对称区间（$[-1, 1]$）上的积分，其值为 $0$。\n第二个积分是：\n$$ \\int_{-1}^{1} \\alpha \\mu^2\\, d\\mu = \\alpha \\int_{-1}^{1} \\mu^2\\, d\\mu = \\alpha \\left[ \\frac{\\mu^3}{3} \\right]_{-1}^{1} = \\alpha \\left( \\frac{(1)^3}{3} - \\frac{(-1)^3}{3} \\right) = \\alpha \\left( \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) \\right) = \\alpha \\left( \\frac{2}{3} \\right) $$\n将此结果代回 $E[\\mu]$ 的表达式中：\n$$ E[\\mu] = \\frac{1}{2} \\left( 0 + \\frac{2\\alpha}{3} \\right) = \\frac{\\alpha}{3} $$\n该分布的一阶矩是 $E[\\mu] = \\frac{\\alpha}{3}$。\n\n### 最终答案组装\n问题要求一个行矩阵，按顺序包含：\n1.  $E[\\mu]$ 的表达式：$\\frac{\\alpha}{3}$。\n2.  $\\alpha$ 的下端点值：$-1$。\n3.  $\\alpha$ 的上端点值：$1$。\n最终答案是包含这些值的 $1 \\times 3$ 矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\alpha}{3}  -1  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在任何模拟研究中，一个核心问题是“模拟需要运行多久？”。本练习  将通过计算估算一个稀有事件（中子泄漏）所需的最少中子历史数，来直接回答这个问题。通过应用中心极限定理，您将把统计置信度、期望误差和事件稀有度与必要的计算成本联系起来，这是设计高效可靠模拟的一项关键技能。",
            "id": "4242630",
            "problem": "使用蒙特卡洛（MC）粒子输运方法模拟一个压水反应堆堆芯。每个模拟的中子历史都按一个二元泄漏结果进行分类：发生泄漏的概率为 $p$，不发生泄漏的概率为 $1-p$。假设历史是独立同分布的，并且第 $i$ 个历史的泄漏结果由伯努利随机变量 $L_{i} \\in \\{0,1\\}$ 表示，其中 $\\mathbb{P}(L_{i}=1)=p$。基于 $N$ 个历史的泄漏概率估计量是样本比例 $\\,\\hat{p} = \\frac{1}{N}\\sum_{i=1}^{N} L_{i}\\,$。根据中心极限定理（CLT），对于足够大的 $N$，$\\,\\hat{p}\\,$ 的抽样分布可以用正态分布来近似。\n\n你的任务是规划历史的数量 $N$，以便在 $p \\approx 1.0 \\times 10^{-6}$ 时，对 $p$ 的估计达到一个设计精度目标。将设计相对误差定义为基于中心极限定理的双侧置信区间的半宽度与真实概率 $p$ 的比值。要求在双侧 $95\\%$ 置信水平下，该相对半宽度至多为一个指定的容差 $\\epsilon$。\n\n从伯努利变量和中心极限定理的基本定义出发，推导出一个最小 $N$ 值的显式闭式表达式，该表达式能保证 $\\,\\hat{p}\\,$ 的基于中心极限定理的双侧 $95\\%$ 置信区间的相对半宽度不大于 $\\epsilon$。然后，使用双侧 $95\\%$ 水平对应的标准正态临界值 $\\,z = 1.96\\,$，对 $\\,p = 1.0 \\times 10^{-6}\\,$ 和 $\\,\\epsilon = 0.2\\,$ 计算这个最小 $N$ 值。通过对实值下界取上整，报告所需的最小整数历史数。除此上整操作外，无需进行有效数字的舍入。最终答案必须是一个不带任何单位的数字。",
            "solution": "对问题陈述进行评估后，认定其有效。这是一个关于伯努利比例样本量确定的良构统计学问题，其基础是中心极限定理和置信区间构造的既定原则。该问题为其求解提供了明确的目标和所有必要的数据。\n\n我们首先将模拟的统计特性形式化。每个中子历史都是一次伯努利试验，其中泄漏（成功）发生的概率为 $p$。第 $i$ 次历史的结果由随机变量 $L_i$ 表示，如果发生泄漏，则 $L_i=1$，否则 $L_i=0$。其概率质量函数为 $\\mathbb{P}(L_i=1)=p$ 和 $\\mathbb{P}(L_i=0)=1-p$。\n\n这个伯努利随机变量的均值（期望值）是：\n$$ \\mathbb{E}[L_i] = 1 \\cdot \\mathbb{P}(L_i=1) + 0 \\cdot \\mathbb{P}(L_i=0) = p $$\n$L_i$ 的方差由下式给出：\n$$ \\mathbb{V}[L_i] = \\mathbb{E}[L_i^2] - (\\mathbb{E}[L_i])^2 $$\n由于 $L_i$ 只能取 $0$ 或 $1$，因此 $L_i^2 = L_i$。所以，$\\mathbb{E}[L_i^2] = \\mathbb{E}[L_i] = p$。方差为：\n$$ \\mathbb{V}[L_i] = p - p^2 = p(1-p) $$\n泄漏概率 $p$ 的估计量是样本比例 $\\hat{p}$，定义为 $N$ 个独立同分布（i.i.d.）观测值的平均值：\n$$ \\hat{p} = \\frac{1}{N}\\sum_{i=1}^{N} L_{i} $$\n该估计量的期望值为：\n$$ \\mathbb{E}[\\hat{p}] = \\mathbb{E}\\left[\\frac{1}{N}\\sum_{i=1}^{N} L_{i}\\right] = \\frac{1}{N}\\sum_{i=1}^{N} \\mathbb{E}[L_{i}] = \\frac{1}{N}(Np) = p $$\n由于历史是独立的，该估计量的方差为：\n$$ \\mathbb{V}[\\hat{p}] = \\mathbb{V}\\left[\\frac{1}{N}\\sum_{i=1}^{N} L_{i}\\right] = \\frac{1}{N^2}\\sum_{i=1}^{N} \\mathbb{V}[L_{i}] = \\frac{1}{N^2}(N p(1-p)) = \\frac{p(1-p)}{N} $$\n估计量的标准差，即标准误差，为 $\\sigma_{\\hat{p}} = \\sqrt{\\frac{p(1-p)}{N}}$。\n\n根据中心极限定理（CLT），对于足够大的历史数 $N$，$\\hat{p}$ 的抽样分布近似为均值为 $p$、方差为 $\\frac{p(1-p)}{N}$ 的正态分布。即 $\\hat{p} \\approx \\mathcal{N}\\left(p, \\frac{p(1-p)}{N}\\right)$。\n\n$p$ 的一个双侧 $100(1-\\alpha)\\%$ 置信区间构造为 $\\hat{p} \\pm HW$，其中 $HW$ 是区间的半宽度。为了规划目的，在抽样之前，半宽度用真实（或目标）参数 $p$ 来表示：\n$$ HW = z_{\\alpha/2} \\sigma_{\\hat{p}} = z_{\\alpha/2} \\sqrt{\\frac{p(1-p)}{N}} $$\n此处，$z_{\\alpha/2}$ 是与置信水平相对应的标准正态分布的临界值。对于 $95\\%$ 的置信水平，$1-\\alpha = 0.95$，因此 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。问题给出了相应的临界值 $z \\equiv z_{0.025} = 1.96$。\n\n问题将设计相对误差定义为半宽度与真实概率 $p$ 的比值，并要求此量不大于一个容差 $\\epsilon$。\n$$ \\text{相对半宽度} = \\frac{HW}{p} = \\frac{z \\sqrt{\\frac{p(1-p)}{N}}}{p} \\leq \\epsilon $$\n我们的第一个任务是推导最小 $N$ 值的闭式表达式。我们对该不等式求解 $N$：\n$$ \\frac{z}{p} \\sqrt{\\frac{p(1-p)}{N}} \\leq \\epsilon $$\n分离含有 $N$ 的项：\n$$ \\sqrt{\\frac{p(1-p)}{N}} \\leq \\frac{p\\epsilon}{z} $$\n两边平方（所有量均为非负）：\n$$ \\frac{p(1-p)}{N} \\leq \\frac{p^2\\epsilon^2}{z^2} $$\n为了求解 $N$，我们可以对两边取倒数，这会反转不等号的方向：\n$$ \\frac{N}{p(1-p)} \\geq \\frac{z^2}{p^2\\epsilon^2} $$\n最后，乘以 $p(1-p)$ 得到所需最小样本量 $N$ 的表达式：\n$$ N \\geq \\frac{z^2 p(1-p)}{p^2\\epsilon^2} $$\n消去一个因子 $p$ 进行简化：\n$$ N \\geq \\frac{z^2(1-p)}{p\\epsilon^2} $$\n这就是所要求的显式闭式表达式。\n\n第二个任务是根据给定的值计算这个最小 $N$：$p = 1.0 \\times 10^{-6}$，$\\epsilon = 0.2$ 和 $z = 1.96$。\n将这些值代入不等式中：\n$$ N \\geq \\frac{(1.96)^2 (1 - 1.0 \\times 10^{-6})}{(1.0 \\times 10^{-6})(0.2)^2} $$\n我们进行计算：\n$$ N \\geq \\frac{3.8416 \\times 0.999999}{(1.0 \\times 10^{-6}) \\times 0.04} $$\n$$ N \\geq \\frac{3.8415961584}{4.0 \\times 10^{-8}} $$\n$$ N \\geq 96039903.96 $$\n由于历史数 $N$ 必须为整数，我们必须取满足此条件的最小整数。这通过对下界应用上取整函数（天花板函数）来实现。\n$$ N_{\\text{min}} = \\lceil 96039903.96 \\rceil = 96039904 $$\n因此，为了达到指定的精度，必须模拟至少 $96,039,904$ 个中子历史。",
            "answer": "$$\\boxed{96039904}$$"
        },
        {
            "introduction": "并非所有测量同一物理量的方法都同样有效。在蒙特卡罗模拟中，“估计量”的选择可以极大地影响模拟效率。本练习  将比较两种计算中子注量率的估计量：直接的“穿面”估计量和解析的“下一事件”估计量。通过推导和比较它们的方差，您将深入了解估计量效率的概念，并理解为何选择一个巧妙的估计量是一种强大的方差缩减技术。",
            "id": "4242639",
            "problem": "考虑在占据$x>0$的均匀、纯吸收半空间介质中的单能中子输运，其宏观总截面$\\Sigma_{t}$与位置和方向无关。一个单位面积的平面探测器位于$x=L$处，用于测量沿$+x$方向流动的净流。位于$x=0$处的单能源以半各向同性的角分布向$+x$半球发射中子：相对于$+x$轴的极角余弦（记为$\\mu$）在$[0,1]$上均匀抽样，每个源粒子的统计权重为单位1。假设中子在碰撞之间沿直线运动，且沿径迹的碰撞距离从率为$\\Sigma_{t}$的指数分布中抽样。使用两种蒙特卡罗（MC）估计子来估计每个源粒子的探测器电流$J$：\n- 表面估计子：对于每个历史，从$\\mathrm{Uniform}(0,1)$抽样$\\mu$，并从率为$\\Sigma_{t}$的指数分布中抽样自由程长度$s$。如果粒子未经碰撞到达探测器（即$s \\geq L/\\mu$），则得分$X_{\\mathrm{surf}}=\\mu$，否则得分$X_{\\mathrm{surf}}=0$。\n- 来自源的碰撞（下一事件）估计子：对于每个历史，从$\\mathrm{Uniform}(0,1)$抽样$\\mu$，并得分$X_{\\mathrm{coll}}=\\mu \\exp(-\\Sigma_{t} L/\\mu)$。\n假设两种估计子每个历史的计算成本相等，并将MC估计子的效率定义为其每个历史方差的倒数。使用概率分布和蒙特卡罗抽样理论，从第一性原理出发，推导每个估计子的每个历史方差，并计算在指定的探测器几何形状和截面$\\Sigma_{t}=0.5\\ \\mathrm{cm}^{-1}$及$L=2\\ \\mathrm{cm}$下，效率之比$R=\\varepsilon_{\\mathrm{surf}}/\\varepsilon_{\\mathrm{coll}}$。将最终比率$R$表示为一个无量纲数，并将您的答案四舍五入到四位有效数字。",
            "solution": "### 步骤1：提取已知条件\n- 介质：均匀、纯吸收的半空间 $x>0$。\n- 宏观总截面：$\\Sigma_{t}$，常数。\n- 探测器：平面，单位面积，位于 $x=L$，测量 $+x$ 方向的净流。\n- 源：位于 $x=0$，单能，向 $+x$ 半球发射。\n- 源角分布：极角的余弦 $\\mu$ 从 $\\mathrm{Uniform}(0,1)$ 抽样，即其概率密度函数 (PDF) 为 $p(\\mu) = 1$，对于 $\\mu \\in [0,1]$。\n- 源粒子权重：1。\n- 碰撞距离 $s$：从率为 $\\Sigma_t$ 的指数分布中抽样，即 PDF 为 $f(s) = \\Sigma_t \\exp(-\\Sigma_t s)$，对于 $s \\ge 0$。\n- 表面估计子得分：如果 $s \\ge L/\\mu$，则 $X_{\\mathrm{surf}} = \\mu$，否则 $X_{\\mathrm{surf}} = 0$。\n- 碰撞估计子得分：$X_{\\mathrm{coll}} = \\mu \\exp(-\\Sigma_t L/\\mu)$。\n- MC效率：$\\varepsilon = 1 / \\mathrm{Var}(X)$，其中 $\\mathrm{Var}(X)$ 是估计子 $X$ 的每个历史方差。\n- 目标：计算效率比 $R = \\varepsilon_{\\mathrm{surf}} / \\varepsilon_{\\mathrm{coll}}$。\n- 参数：$\\Sigma_t = 0.5\\ \\mathrm{cm}^{-1}$，$L = 2\\ \\mathrm{cm}$。\n- 最终答案格式：无量纲数，四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n根据指定标准对问题进行验证。\n- **科学基础**：该问题是核反应堆物理学中的一个标准但简化的练习，特别是在粒子输运的蒙特卡罗方法方面。截面、路径长度抽样、流和定义的估计子（表面穿越和下一事件）等概念都是基本且正确的。源角分布虽然是一个特定的数学选择，但对于一个理论问题来说，其定义明确，没有违反任何物理原理。该问题牢固地建立在已有的概率论和输运理论之上。\n- **适定性**：问题是完全指定的。所有必要的数据（$\\Sigma_t$，$L$）、分布（$p(\\mu)$，$f(s)$）和估计子定义（$X_{\\mathrm{surf}}$，$X_{\\mathrm{coll}}$）都已提供。目标明确。存在一个唯一、稳定且有意义的解。\n- **客观性**：问题以精确、定量和无偏见的语言陈述。没有主观因素。\n- **结论**：该问题没有违反任何无效标准。它是科学合理、适定、客观且可形式化的。\n\n### 步骤3：裁决与行动\n问题被判定为**有效**。将提供完整解答。\n\n### 解题推导\n\n目标是计算表面估计子 ($X_{\\mathrm{surf}}$) 和碰撞估计子 ($X_{\\mathrm{coll}}$) 的效率比 $R$。估计子的效率 $\\varepsilon$ 定义为其每个历史方差的倒数。假设每个历史的计算成本相等，效率比由其方差的反比给出：\n$$R = \\frac{\\varepsilon_{\\mathrm{surf}}}{\\varepsilon_{\\mathrm{coll}}} = \\frac{1 / \\mathrm{Var}(X_{\\mathrm{surf}})}{1 / \\mathrm{Var}(X_{\\mathrm{coll}})} = \\frac{\\mathrm{Var}(X_{\\mathrm{coll}})}{\\mathrm{Var}(X_{\\mathrm{surf}})}$$\n随机变量 $X$ 的方差由公式 $\\mathrm{Var}(X) = E[X^2] - (E[X])^2$ 给出。因此，我们必须计算每个估计子的一阶矩和二阶矩。两个估计子都旨在估计相同的物理量：在探测器平面 $x=L$ 处每个源粒子的净流 $J$。因此，它们必须是无偏的，即它们的期望值应等于真实流 $J$。\n\n首先，我们确定流的真实值 $J$。一个源粒子以角度余弦为 $\\mu$ 从 $x=0$ 发射，其中 $\\mu$ 从 $p(\\mu)=1$（在 $[0,1]$ 上）抽取。为了使该粒子到达位于 $x=L$ 的探测器，它必须在不发生碰撞的情况下行进至少 $L/\\mu$ 的距离。这种情况发生的概率是 $\\exp(-\\Sigma_t L/\\mu)$。如果粒子到达探测器，它对净流的贡献是其权重（为1）乘以 $\\mu$。总期望流 $J$ 通过将此贡献对所有可能的源方向进行积分获得：\n$$J = \\int_{0}^{1} (\\text{current contribution}) \\times (\\text{probability of reaching detector}) \\times p(\\mu) d\\mu$$\n$$J = \\int_{0}^{1} \\mu \\cdot \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) \\cdot 1 \\,d\\mu = \\int_{0}^{1} \\mu \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) d\\mu$$\n该积分可以用指数积分函数 $E_n(z) = \\int_{1}^{\\infty} t^{-n} \\exp(-zt) dt$ 表示。通过进行替换 $u=1/\\mu$，我们有 $d\\mu = -du/u^2$。积分限从 $\\mu=0 \\to 1$ 变为 $u=\\infty \\to 1$。\n$$J = \\int_{\\infty}^{1} \\frac{1}{u} \\exp(-\\Sigma_t L u) \\left(-\\frac{du}{u^2}\\right) = \\int_{1}^{\\infty} \\frac{\\exp(-\\Sigma_t L u)}{u^3} du = E_3(\\Sigma_t L)$$\n\n接下来，我们验证两个估计子都是无偏的，并计算它们的二阶矩。\n\n**表面估计子 ($X_{\\mathrm{surf}}$) 的分析**\n如果 $s \\ge L/\\mu$，得分为 $X_{\\mathrm{surf}} = \\mu$，否则为 $0$。期望值是通过对 $\\mu$ 和 $s$ 的分布进行平均来找到的。我们使用全期望定律，$E[X] = E_{\\mu}[E_s[X|\\mu]]$。对于一个固定的 $\\mu$，成功事件（$s \\ge L/\\mu$）的概率是 $P(s \\ge L/\\mu) = \\int_{L/\\mu}^{\\infty} \\Sigma_t \\exp(-\\Sigma_t s) ds = \\exp(-\\Sigma_t L/\\mu)$。\n给定 $\\mu$ 时得分的条件期望是：\n$$E_s[X_{\\mathrm{surf}}|\\mu] = \\mu \\cdot P(s \\ge L/\\mu) + 0 \\cdot P(s  L/\\mu) = \\mu \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right)$$\n然后通过对 $\\mu$ 进行平均来找到总期望：\n$$E[X_{\\mathrm{surf}}] = \\int_{0}^{1} E_s[X_{\\mathrm{surf}}|\\mu] p(\\mu) d\\mu = \\int_{0}^{1} \\mu \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) d\\mu = J = E_3(\\Sigma_t L)$$\n该估计子是无偏的。二阶矩的计算方法类似：\n$$E_s[X_{\\mathrm{surf}}^2|\\mu] = \\mu^2 \\cdot P(s \\ge L/\\mu) + 0^2 \\cdot P(s  L/\\mu) = \\mu^2 \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right)$$\n$$E[X_{\\mathrm{surf}}^2] = \\int_{0}^{1} \\mu^2 \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) d\\mu$$\n使用相同的替换 $u=1/\\mu$，该积分变为：\n$$E[X_{\\mathrm{surf}}^2] = \\int_{\\infty}^{1} \\frac{1}{u^2} \\exp(-\\Sigma_t L u) \\left(-\\frac{du}{u^2}\\right) = \\int_{1}^{\\infty} \\frac{\\exp(-\\Sigma_t L u)}{u^4} du = E_4(\\Sigma_t L)$$\n表面估计子的方差是：\n$$\\mathrm{Var}(X_{\\mathrm{surf}}) = E[X_{\\mathrm{surf}}^2] - (E[X_{\\mathrm{surf}}])^2 = E_4(\\Sigma_t L) - [E_3(\\Sigma_t L)]^2$$\n\n**碰撞（下一事件）估计子 ($X_{\\mathrm{coll}}$) 的分析**\n得分为 $X_{\\mathrm{coll}} = \\mu \\exp(-\\Sigma_t L/\\mu)$，它是随机变量 $\\mu$ 的一个确定性函数。\n其期望为：\n$$E[X_{\\mathrm{coll}}] = \\int_{0}^{1} X_{\\mathrm{coll}}(\\mu) p(\\mu) d\\mu = \\int_{0}^{1} \\mu \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) d\\mu = J = E_3(\\Sigma_t L)$$\n该估计子也是无偏的。其二阶矩为：\n$$E[X_{\\mathrm{coll}}^2] = \\int_{0}^{1} [X_{\\mathrm{coll}}(\\mu)]^2 p(\\mu) d\\mu = \\int_{0}^{1} \\left(\\mu \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right)\\right)^2 d\\mu = \\int_{0}^{1} \\mu^2 \\exp\\left(-\\frac{2\\Sigma_t L}{\\mu}\\right) d\\mu$$\n使用替换 $u=1/\\mu$，该积分变为：\n$$E[X_{\\mathrm{coll}}^2] = \\int_{\\infty}^{1} \\frac{1}{u^2} \\exp(-2\\Sigma_t L u) \\left(-\\frac{du}{u^2}\\right) = \\int_{1}^{\\infty} \\frac{\\exp(-2\\Sigma_t L u)}{u^4} du = E_4(2\\Sigma_t L)$$\n碰撞估计子的方差是：\n$$\\mathrm{Var}(X_{\\mathrm{coll}}) = E[X_{\\mathrm{coll}}^2] - (E[X_{\\mathrm{coll}}])^2 = E_4(2\\Sigma_t L) - [E_3(\\Sigma_t L)]^2$$\n\n**效率比**\n现在我们可以写出效率比 $R$ 的表达式：\n$$R = \\frac{\\mathrm{Var}(X_{\\mathrm{coll}})}{\\mathrm{Var}(X_{\\mathrm{surf}})} = \\frac{E_4(2\\Sigma_t L) - [E_3(\\Sigma_t L)]^2}{E_4(\\Sigma_t L) - [E_3(\\Sigma_t L)]^2}$$\n\n**数值计算**\n问题提供了值 $\\Sigma_t = 0.5\\ \\mathrm{cm}^{-1}$ 和 $L = 2\\ \\mathrm{cm}$。无量纲光学厚度是 $\\tau = \\Sigma_t L = (0.5)(2) = 1$。\n将 $\\tau=1$ 代入 $R$ 的表达式：\n$$R = \\frac{E_4(2) - [E_3(1)]^2}{E_4(1) - [E_3(1)]^2}$$\n我们使用指数积分函数 $E_n(z)$ 的标准库值：\n- $E_3(1) \\approx 0.10969197$\n- $E_4(1) \\approx 0.08606241$\n- $E_4(2) \\approx 0.02502268$\n\n现在，我们计算方差：\n- 首先，是平均值的平方：\n$$[E_3(1)]^2 \\approx (0.10969197)^2 \\approx 0.01203233$$\n- 碰撞估计子的方差：\n$$\\mathrm{Var}(X_{\\mathrm{coll}}) = E_4(2) - [E_3(1)]^2 \\approx 0.02502268 - 0.01203233 = 0.01299035$$\n- 表面估计子的方差：\n$$\\mathrm{Var}(X_{\\mathrm{surf}}) = E_4(1) - [E_3(1)]^2 \\approx 0.08606241 - 0.01203233 = 0.07403008$$\n最后，我们计算比率 $R$：\n$$R = \\frac{0.01299035}{0.07403008} \\approx 0.17547444$$\n将结果四舍五入到四位有效数字，我们得到 $0.1755$。",
            "answer": "$$\\boxed{0.1755}$$"
        }
    ]
}