{
    "hands_on_practices": [
        {
            "introduction": "The power of the surface crossing estimator lies in its simple, elegant foundation, where each particle crossing contributes a value to the total current tally. This exercise  deconstructs this fundamental event into its core components: determining the surface's orientation via its normal vector and projecting the particle's direction onto it. Mastering this basic geometric calculation is the first step toward understanding how millions of such events are aggregated to produce a statistically meaningful result.",
            "id": "4253958",
            "problem": "In neutron transport Monte Carlo simulation, the net outward particle current across a smooth surface is defined as the surface and angle integral of the angular flux weighted by the projection of the particle travel direction onto the surface normal. The corresponding surface-crossing estimator assigns, for each particle crossing event, a contribution equal to the particle statistical weight multiplied by the dot product of the particle direction and the local outward unit normal to the surface.\n\nConsider the sphere of radius $R$ centered at the origin in three-dimensional Euclidean space, defined implicitly by the level set $f(\\mathbf{r}) = x^{2} + y^{2} + z^{2} - R^{2} = 0$. A neutron with statistical weight $w$ crosses this spherical surface at the point $\\mathbf{r}_{c} = (0,\\,5,\\,12)$ with direction of flight $\\mathbf{\\Omega} = \\left(-\\frac{3}{5},\\,-\\frac{4}{5},\\,0\\right)$. The sphere radius is $R = 13$. The direction $\\mathbf{\\Omega}$ is unit length and corresponds to an incoming crossing relative to the outward normal.\n\nStarting from the implicit surface representation and first principles for normal vectors, derive the outward unit normal vector $\\mathbf{n}$ at the crossing point $\\mathbf{r}_{c}$, and then compute the contribution $w\\,(\\mathbf{\\Omega}\\cdot\\mathbf{n})$ that this single crossing adds to the net outward current tally. Use $w = \\frac{41}{50}$. Express your final answer as an exact rational number. No units are required because the contribution is dimensionless.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n-   Implicit surface representation of a sphere: $f(\\mathbf{r}) = x^{2} + y^{2} + z^{2} - R^{2} = 0$.\n-   Sphere radius: $R = 13$.\n-   Crossing point on the surface: $\\mathbf{r}_{c} = (0,\\,5,\\,12)$.\n-   Neutron statistical weight: $w = \\frac{41}{50}$.\n-   Neutron direction of flight (unit vector): $\\mathbf{\\Omega} = \\left(-\\frac{3}{5},\\,-\\frac{4}{5},\\,0\\right)$.\n-   Task: Derive the outward unit normal vector $\\mathbf{n}$ at $\\mathbf{r}_{c}$ from the implicit surface representation and compute the contribution to the net outward current tally, given by $w\\,(\\mathbf{\\Omega}\\cdot\\mathbf{n})$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem describes a standard surface-crossing estimator in Monte Carlo particle transport, a well-established method in nuclear reactor physics. The mathematical formulation is based on fundamental principles of vector calculus.\n\nFirst, we verify the consistency of the given data. The crossing point $\\mathbf{r}_{c}$ must lie on the specified surface. We evaluate the magnitude of the position vector $\\mathbf{r}_{c}$:\n$$|\\mathbf{r}_{c}| = \\sqrt{0^{2} + 5^{2} + 12^{2}} = \\sqrt{0 + 25 + 144} = \\sqrt{169} = 13$$\nThe magnitude of the position vector of the crossing point is equal to the given radius $R = 13$. Thus, the point $\\mathbf{r}_{c}$ is indeed on the surface of the sphere.\n\nNext, we verify that the direction vector $\\mathbf{\\Omega}$ is a unit vector:\n$$|\\mathbf{\\Omega}| = \\sqrt{\\left(-\\frac{3}{5}\\right)^{2} + \\left(-\\frac{4}{5}\\right)^{2} + 0^{2}} = \\sqrt{\\frac{9}{25} + \\frac{16}{25}} = \\sqrt{\\frac{25}{25}} = 1$$\nThe direction vector is correctly specified as a unit vector. The problem states this is an incoming crossing, which implies that the dot product $\\mathbf{\\Omega}\\cdot\\mathbf{n}$ should be negative. This will be verified by the calculation. All data are consistent and sufficient for a unique solution.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically grounded, well-posed, and internally consistent. We proceed with the solution.\n\nThe core of the problem is to compute the contribution $C$ to the net outward current tally, defined as:\n$$C = w\\,(\\mathbf{\\Omega}\\cdot\\mathbf{n})$$\nThis requires determining the outward unit normal vector $\\mathbf{n}$ to the spherical surface at the crossing point $\\mathbf{r}_{c}$.\n\nFor a surface defined implicitly by a level set equation $f(\\mathbf{r}) = k$ (where $k$ is a constant), the gradient vector $\\nabla f(\\mathbf{r})$ is everywhere normal to the surface. In our case, the surface is given by $f(x, y, z) = x^{2} + y^{2} + z^{2} - R^{2} = 0$.\n\nThe gradient of $f$ is calculated as:\n$$\\nabla f(x, y, z) = \\left(\\frac{\\partial f}{\\partial x}, \\frac{\\partial f}{\\partial y}, \\frac{\\partial f}{\\partial z}\\right)$$\nThe partial derivatives are:\n$$\\frac{\\partial f}{\\partial x} = 2x$$\n$$\\frac{\\partial f}{\\partial y} = 2y$$\n$$\\frac{\\partial f}{\\partial z} = 2z$$\nThus, the gradient vector is:\n$$\\nabla f(x, y, z) = (2x, 2y, 2z) = 2\\mathbf{r}$$\nwhere $\\mathbf{r} = (x, y, z)$ is the position vector.\n\nWe evaluate this gradient at the crossing point $\\mathbf{r}_{c} = (0,\\,5,\\,12)$:\n$$\\nabla f(\\mathbf{r}_{c}) = 2(0, 5, 12) = (0, 10, 24)$$\nThis vector is normal to the surface at $\\mathbf{r}_{c}$. To determine if it points outward or inward, we observe that the function $f(\\mathbf{r}) = |\\mathbf{r}|^{2} - R^{2}$ increases as the distance from the origin $|\\mathbf{r}|$ increases. The gradient vector points in the direction of the steepest ascent of $f$, which corresponds to moving radially outward from the sphere. Therefore, $\\nabla f(\\mathbf{r}_{c})$ is an outward-pointing normal vector.\n\nTo obtain the outward unit normal vector $\\mathbf{n}$, we normalize $\\nabla f(\\mathbf{r}_{c})$ by dividing it by its magnitude:\n$$\\mathbf{n} = \\frac{\\nabla f(\\mathbf{r}_{c})}{|\\nabla f(\\mathbf{r}_{c})|}$$\nThe magnitude is:\n$$|\\nabla f(\\mathbf{r}_{c})| = |(0, 10, 24)| = \\sqrt{0^{2} + 10^{2} + 24^{2}} = \\sqrt{100 + 576} = \\sqrt{676} = 26$$\nSo, the outward unit normal vector at $\\mathbf{r}_{c}$ is:\n$$\\mathbf{n} = \\frac{1}{26}(0, 10, 24) = \\left(0, \\frac{10}{26}, \\frac{24}{26}\\right) = \\left(0, \\frac{5}{13}, \\frac{12}{13}\\right)$$\n\nNow, we compute the dot product of the particle direction $\\mathbf{\\Omega}$ and the outward normal $\\mathbf{n}$. This term, $\\mathbf{\\Omega}\\cdot\\mathbf{n}$, is the cosine of the angle between the two vectors and represents the projection of the particle's direction onto the normal.\n$$\\mathbf{\\Omega}\\cdot\\mathbf{n} = \\left(-\\frac{3}{5}, -\\frac{4}{5}, 0\\right) \\cdot \\left(0, \\frac{5}{13}, \\frac{12}{13}\\right)$$\n$$\\mathbf{\\Omega}\\cdot\\mathbf{n} = \\left(-\\frac{3}{5}\\right)(0) + \\left(-\\frac{4}{5}\\right)\\left(\\frac{5}{13}\\right) + (0)\\left(\\frac{12}{13}\\right)$$\n$$\\mathbf{\\Omega}\\cdot\\mathbf{n} = 0 - \\frac{4 \\cdot 5}{5 \\cdot 13} + 0 = -\\frac{4}{13}$$\nThe negative result confirms the problem's statement that the crossing is \"incoming\" (i.e., against the outward normal).\n\nFinally, we compute the contribution $C$ by multiplying this dot product by the particle's statistical weight $w = \\frac{41}{50}$:\n$$C = w\\,(\\mathbf{\\Omega}\\cdot\\mathbf{n}) = \\left(\\frac{41}{50}\\right) \\left(-\\frac{4}{13}\\right)$$\n$$C = -\\frac{41 \\cdot 4}{50 \\cdot 13} = -\\frac{164}{650}$$\nWe simplify this fraction by dividing the numerator and denominator by their greatest common divisor, which is $2$:\n$$C = -\\frac{164 \\div 2}{650 \\div 2} = -\\frac{82}{325}$$\nThis is the contribution of the single crossing event to the net outward current tally, expressed as an exact rational number.",
            "answer": "$$\\boxed{-\\frac{82}{325}}$$"
        },
        {
            "introduction": "While Monte Carlo methods simulate individual particles, the quantities they estimate, like current, are defined within the continuous framework of transport theory. This problem  bridges the gap between the discrete simulation and the underlying physics by tasking you with calculating partial and net currents directly from a given angular flux distribution. By performing this analytical integration, you will gain a deeper appreciation for what the surface crossing estimator is actually tallying on a macroscopic scale.",
            "id": "4254023",
            "problem": "Consider a monoenergetic, steady-state neutron field in slab geometry with a planar boundary at position $x=0$ and outward unit normal $\\hat{n}$ pointing in the $+x$-direction. Assume azimuthal symmetry so that the angular flux depends only on the polar cosine $\\mu = \\Omega \\cdot \\hat{n} \\in [-1,1]$, where $\\Omega$ is the unit direction vector. The angular flux at the boundary is anisotropic with the form\n$$\n\\psi(0,\\mu) = \\psi_{0}\\left(1 + a\\,P_{1}(\\mu)\\right),\n$$\nwhere $P_{1}(\\mu)$ is the first-order Legendre polynomial, $P_{1}(\\mu) = \\mu$, and $\\psi_{0}$ is a constant amplitude. Let the amplitude and anisotropy parameter be $\\,\\psi_{0} = 1.0\\,\\text{neutrons}\\cdot\\text{cm}^{-2}\\cdot\\text{s}^{-1}\\cdot\\text{sr}^{-1}\\,$ and $\\,a = 0.6\\,$, which satisfies the non-negativity condition $\\psi(0,\\mu) \\ge 0$ for all $\\mu \\in [-1,1]$.\n\nStarting from the kinetic-theory definition of neutron current through a surface as the rate of particle crossings per unit area, and using the angular flux given above, determine the outgoing partial current $J^{+}$, the incoming partial current $J^{-}$ (defined as a positive magnitude for $\\mu0$), and the net current $J_{\\text{net}}$ across the boundary. Express the final currents in units of neutrons per square centimeter per second. Round your answers to four significant figures.",
            "solution": "The problem statement has been validated and found to be scientifically grounded, well-posed, objective, and self-contained. The given form of the angular flux, $\\psi(0,\\mu)$, is a linear function of $\\mu$. The non-negativity condition, $\\psi(0,\\mu) \\ge 0$ for $\\mu \\in [-1,1]$, is satisfied by the provided constants $\\psi_0 = 1.0$ and $a = 0.6$, as the function's minimum value on the interval occurs at $\\mu = -1$, yielding $\\psi(0,-1) = \\psi_0(1-a) = 1.0(1-0.6) = 0.4$, which is non-negative. All conditions are internally consistent and conform to the principles of neutron transport theory. We may therefore proceed with the solution.\n\nThe neutron current density, or net current, across a surface with outward unit normal $\\hat{n}$ is defined as the integral of the angular flux $\\psi(\\vec{r}, \\Omega)$ weighted by the projection of the particle direction vector $\\Omega$ onto the normal, $\\Omega \\cdot \\hat{n}$, over all solid angles $4\\pi$. In this slab geometry problem, the surface is at $x=0$ and the normal is $\\hat{n} = \\hat{x}$, so the projection is $\\mu = \\Omega \\cdot \\hat{x}$. Given the azimuthal symmetry, the differential solid angle element is $d\\Omega = d\\phi \\, d\\mu$, and the integration over the azimuthal angle $\\phi$ from $0$ to $2\\pi$ yields a factor of $2\\pi$.\n\nThe net current, $J_{\\text{net}}$, at the boundary $x=0$ is given by:\n$$ J_{\\text{net}} = \\int_{4\\pi} (\\Omega \\cdot \\hat{n}) \\psi(0, \\Omega) d\\Omega = \\int_0^{2\\pi} d\\phi \\int_{-1}^{1} \\mu \\, \\psi(0, \\mu) \\, d\\mu = 2\\pi \\int_{-1}^{1} \\mu \\, \\psi(0, \\mu) \\, d\\mu $$\nThe partial currents are defined by integrating over the outgoing and incoming hemispheres.\n\nThe outgoing partial current, $J^{+}$, represents the rate of neutrons crossing the surface in the direction of the normal ($\\mu  0$):\n$$ J^{+} = \\int_0^{2\\pi} d\\phi \\int_{0}^{1} \\mu \\, \\psi(0, \\mu) \\, d\\mu = 2\\pi \\int_{0}^{1} \\mu \\, \\psi(0, \\mu) \\, d\\mu $$\nThe incoming partial current, $J^{-}$, is defined as the positive magnitude of the rate of neutrons crossing in the direction opposite to the normal ($\\mu  0$):\n$$ J^{-} = - \\int_0^{2\\pi} d\\phi \\int_{-1}^{0} \\mu \\, \\psi(0, \\mu) \\, d\\mu = -2\\pi \\int_{-1}^{0} \\mu \\, \\psi(0, \\mu) \\, d\\mu $$\nThe net current is the difference between the outgoing and incoming partial currents: $J_{\\text{net}} = J^{+} - J^{-}$.\n\nWe are given the angular flux at the boundary $x=0$ as $\\psi(0,\\mu) = \\psi_{0}(1 + a P_{1}(\\mu))$, where $P_{1}(\\mu) = \\mu$. Thus, $\\psi(0,\\mu) = \\psi_{0}(1 + a\\mu)$. We can now compute the partial currents.\n\nFirst, we calculate the outgoing partial current, $J^{+}$:\n$$ J^{+} = 2\\pi \\int_{0}^{1} \\mu \\, \\psi_{0}(1 + a\\mu) \\, d\\mu = 2\\pi \\psi_{0} \\int_{0}^{1} (\\mu + a\\mu^2) \\, d\\mu $$\n$$ J^{+} = 2\\pi \\psi_{0} \\left[ \\frac{\\mu^2}{2} + \\frac{a\\mu^3}{3} \\right]_{0}^{1} = 2\\pi \\psi_{0} \\left( \\left(\\frac{1^2}{2} + \\frac{a(1)^3}{3}\\right) - 0 \\right) $$\n$$ J^{+} = 2\\pi \\psi_{0} \\left(\\frac{1}{2} + \\frac{a}{3}\\right) $$\nSubstituting the given values $\\psi_0 = 1.0\\,\\text{neutrons}\\cdot\\text{cm}^{-2}\\cdot\\text{s}^{-1}\\cdot\\text{sr}^{-1}$ and $a=0.6$:\n$$ J^{+} = 2\\pi (1.0) \\left(\\frac{1}{2} + \\frac{0.6}{3}\\right) = 2\\pi (0.5 + 0.2) = 2\\pi(0.7) = 1.4\\pi $$\nNumerically, $J^{+} \\approx 4.398229... \\, \\text{neutrons}\\cdot\\text{cm}^{-2}\\cdot\\text{s}^{-1}$.\n\nNext, we calculate the incoming partial current, $J^{-}$:\n$$ J^{-} = -2\\pi \\int_{-1}^{0} \\mu \\, \\psi_{0}(1 + a\\mu) \\, d\\mu = -2\\pi \\psi_{0} \\int_{-1}^{0} (\\mu + a\\mu^2) \\, d\\mu $$\n$$ J^{-} = -2\\pi \\psi_{0} \\left[ \\frac{\\mu^2}{2} + \\frac{a\\mu^3}{3} \\right]_{-1}^{0} = -2\\pi \\psi_{0} \\left( 0 - \\left(\\frac{(-1)^2}{2} + \\frac{a(-1)^3}{3}\\right) \\right) $$\n$$ J^{-} = -2\\pi \\psi_{0} \\left( - \\left(\\frac{1}{2} - \\frac{a}{3}\\right) \\right) = 2\\pi \\psi_{0} \\left(\\frac{1}{2} - \\frac{a}{3}\\right) $$\nSubstituting the given values:\n$$ J^{-} = 2\\pi (1.0) \\left(\\frac{1}{2} - \\frac{0.6}{3}\\right) = 2\\pi (0.5 - 0.2) = 2\\pi(0.3) = 0.6\\pi $$\nNumerically, $J^{-} \\approx 1.884955... \\, \\text{neutrons}\\cdot\\text{cm}^{-2}\\cdot\\text{s}^{-1}$.\n\nFinally, we calculate the net current, $J_{\\text{net}}$, as the difference between the partial currents:\n$$ J_{\\text{net}} = J^{+} - J^{-} = 2\\pi \\psi_{0} \\left(\\frac{1}{2} + \\frac{a}{3}\\right) - 2\\pi \\psi_{0} \\left(\\frac{1}{2} - \\frac{a}{3}\\right) $$\n$$ J_{\\text{net}} = 2\\pi \\psi_{0} \\left[ \\left(\\frac{1}{2} + \\frac{a}{3}\\right) - \\left(\\frac{1}{2} - \\frac{a}{3}\\right) \\right] = 2\\pi \\psi_{0} \\left( \\frac{2a}{3} \\right) = \\frac{4\\pi a \\psi_{0}}{3} $$\nSubstituting the given values:\n$$ J_{\\text{net}} = \\frac{4\\pi (0.6) (1.0)}{3} = \\frac{2.4\\pi}{3} = 0.8\\pi $$\nNumerically, $J_{\\text{net}} \\approx 2.513274... \\, \\text{neutrons}\\cdot\\text{cm}^{-2}\\cdot\\text{s}^{-1}$.\n\nRounding the numerical results to four significant figures as requested:\n$J^{+} = 4.398 \\, \\text{neutrons}\\cdot\\text{cm}^{-2}\\cdot\\text{s}^{-1}$\n$J^{-} = 1.885 \\, \\text{neutrons}\\cdot\\text{cm}^{-2}\\cdot\\text{s}^{-1}$\n$J_{\\text{net}} = 2.513 \\, \\text{neutrons}\\cdot\\text{cm}^{-2}\\cdot\\text{s}^{-1}$\nThe units of current are $\\text{neutrons}\\cdot\\text{cm}^{-2}\\cdot\\text{s}^{-1}$, as expected.\nThe final answers are to be presented as a row matrix for $J^{+}$, $J^{-}$, and $J_{\\text{net}}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.398  1.885  2.513 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A correctly implemented simulation is the cornerstone of reliable analysis. This hands-on coding practice  guides you through the essential process of verification, where a computational estimator is tested against a known analytical solution. You will first derive the exact currents for a simplified isotropic source problem and then build a Monte Carlo estimator to confirm that your simulation produces results consistent with theory, a critical skill in computational science.",
            "id": "4253987",
            "problem": "You are to design and implement a computational benchmark to verify surface crossing estimators for current in nuclear reactor simulation using a half-space isotropic source problem. The benchmark must be scientifically grounded in the transport-theoretic formulation of current at an interface and must quantify agreement between analytical expressions and Monte Carlo (MC) estimates within statistical uncertainty.\n\nConsider a planar interface at location $x=0$ separating two vacuum half-spaces, the left half-space $x0$ and the right half-space $x0$. Let the outward-pointing unit normal vector at the interface point into the right half-space. Denote the angular flux by $\\psi\\left(x,\\Omega\\right)$, where $\\Omega$ is the direction on the unit sphere and the polar cosine relative to the normal is $\\mu=\\Omega\\cdot\\hat{n}$. The partial current crossing the interface from the left half-space into the right half-space, denoted $J^{+}$, and from the right half-space into the left half-space, denoted $J^{-}$, are defined as integrals of the angular flux weighted by the directional cosine over the appropriate hemispheres. The task requires you to derive the exact analytical expressions for $J^{+}$ and $J^{-}$ under half-space isotropic source boundary conditions and to implement a Monte Carlo estimator for these currents based on a surface crossing formulation.\n\nThe fundamental base you must use includes:\n- The definition of angular flux $\\psi\\left(x,\\Omega\\right)$ and its relation to particle flow.\n- The definition of partial current as the flux of particles across an interface, with appropriate directional weighting by $\\mu$.\n- Half-space isotropic source boundary conditions, in which the angular flux incident on the interface from each half-space is constant over its outward hemisphere.\n- Vacuum boundary conditions (VBC) away from the interface, implying free streaming without collisions.\n\nYou must not assume or use any pre-derived shortcut formulas for the currents. Instead, you must begin from the above principles and derive the needed expressions for $J^{+}$ and $J^{-}$. Subsequently, design a Monte Carlo estimator that samples directions over the hemisphere with a specified proposal and uses unbiased weights to estimate the surface current. The estimator must include a clear treatment of statistical uncertainty, including the standard error of the mean, and a decision rule to determine agreement between analytical and Monte Carlo results.\n\nPhysical units:\n- Let the angular flux be expressed in particles per square meter per steradian per second, i.e., $\\mathrm{particles\\cdot m^{-2}\\cdot sr^{-1}\\cdot s^{-1}}$.\n- The partial currents $J^{+}$ and $J^{-}$ must be expressed in particles per square meter per second, i.e., $\\mathrm{particles\\cdot m^{-2}\\cdot s^{-1}}$.\n\nAngle unit:\n- All angles must be treated in radians.\n\nYour program must:\n1. Derive and implement the analytical expressions for $J^{+}$ and $J^{-}$ from first principles as described.\n2. Implement a Monte Carlo estimator for the partial currents using a hemisphere sampling proposal distribution and appropriate weights that yield an unbiased estimator of the surface current integral.\n3. Use a fixed random seed to ensure deterministic output and compute, for each current, the standardized difference $z = (\\hat{J}-J_{\\text{analytic}})/\\sigma_{\\hat{J}}$, where $\\hat{J}$ is the Monte Carlo estimate and $\\sigma_{\\hat{J}}$ is the estimated standard error of the mean.\n4. Declare agreement if $|z| \\le k$, with $k=2$.\n\nTest suite:\nProvide a test suite of parameter sets $(\\psi_{L},\\psi_{R},N_{L},N_{R})$, where $\\psi_{L}$ is the left half-space outward isotropic angular flux at the interface, $\\psi_{R}$ is the right half-space outward isotropic angular flux at the interface, $N_{L}$ is the number of Monte Carlo samples to estimate $J^{+}$ from the left half-space, and $N_{R}$ is the number of Monte Carlo samples to estimate $J^{-}$ from the right half-space. Use the following test cases:\n- Case $1$: $(\\psi_{L},\\psi_{R},N_{L},N_{R})=\\left(1.0,0.0,200000,0\\right)$.\n- Case $2$: $(\\psi_{L},\\psi_{R},N_{L},N_{R})=\\left(0.0,0.5,0,150000\\right)$.\n- Case $3$: $(\\psi_{L},\\psi_{R},N_{L},N_{R})=\\left(0.8,0.8,100000,100000\\right)$.\n- Case $4$: $(\\psi_{L},\\psi_{R},N_{L},N_{R})=\\left(1.25,0.75,1000,1000\\right)$.\n\nDesign for coverage:\n- Case $1$ exercises a one-sided source with a large sample for $J^{+}$ and a zero source for $J^{-}$.\n- Case $2$ exercises the opposite side with a large sample for $J^{-}$ and a zero source for $J^{+}$.\n- Case $3$ provides symmetric nonzero sources on both sides to verify both currents simultaneously at moderate sample sizes.\n- Case $4$ provides smaller sample sizes to test estimator behavior under larger statistical uncertainty.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes one boolean to the list, indicating agreement only if both $J^{+}$ and $J^{-}$ in that case satisfy $|z| \\le k$. For example, the output should look like $\\left[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}\\right]$, where each $\\text{result}_{i}$ is either $\\text{True}$ or $\\text{False}$.",
            "solution": "The problem requires the design and implementation of a computational benchmark to validate a Monte Carlo (MC) surface crossing estimator for particle current against a known analytical solution. The physical scenario is a planar interface at $x=0$ separating two vacuum half-spaces, with isotropic sources of particles directed into the opposite half-space.\n\nThe first step is to derive the analytical expressions for the partial currents from fundamental principles of transport theory. The partial current $J^{+}$ is the flux of particles crossing the interface at $x=0$ from the left half-space ($x0$) to the right half-space ($x>0$). The partial current $J^{-}$ is the flux of particles crossing from right ($x>0$) to left ($x0$). The interface normal vector $\\hat{n}$ points in the positive $x$ direction. The direction of a particle's flight is given by the unit vector $\\Omega$, and the cosine of the angle between $\\Omega$ and $\\hat{n}$ is the polar cosine, $\\mu = \\Omega \\cdot \\hat{n}$.\n\nThe definitions for the partial currents per unit area are given by integrating the angular flux $\\psi(x,\\Omega)$ over the appropriate hemispheres of solid angle, weighted by the normal component of the particle direction vector:\n$$ J^{+} = \\int_{\\mu>0} \\mu \\, \\psi(0, \\Omega) \\, d\\Omega $$\n$$ J^{-} = \\int_{\\mu0} |\\mu| \\, \\psi(0, \\Omega) \\, d\\Omega = \\int_{\\mu0} (-\\mu) \\, \\psi(0, \\Omega) \\, d\\Omega $$\n\nThe problem specifies half-space isotropic source boundary conditions. The angular flux incident on the interface from the left ($x0$) is a constant $\\psi_L$ for all outgoing directions ($\\mu>0$), and the flux from the right ($x>0$) is a constant $\\psi_R$ for all outgoing directions toward the left ($\\mu0$).\n$$ \\psi(0, \\Omega) = \\psi_L \\quad \\text{for } \\mu>0 $$\n$$ \\psi(0, \\Omega) = \\psi_R \\quad \\text{for } \\mu0 $$\nSince $\\psi_L$ and $\\psi_R$ are constants over their respective hemispheres, they can be moved outside the integrals:\n$$ J^{+} = \\psi_L \\int_{\\mu>0} \\mu \\, d\\Omega $$\n$$ J^{-} = \\psi_R \\int_{\\mu0} (-\\mu) \\, d\\Omega $$\n\nTo evaluate these integrals, we use spherical coordinates where the polar axis is aligned with $\\hat{n}$. The differential solid angle is $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$, where $\\theta$ is the polar angle and $\\phi$ is the azimuthal angle. The polar cosine is $\\mu = \\cos\\theta$.\n\nFor $J^{+}$, the integration is over the forward hemisphere: $\\phi \\in [0, 2\\pi]$ and $\\theta \\in [0, \\pi/2]$ (which corresponds to $\\mu \\in [0, 1]$).\n$$ \\int_{\\mu>0} \\mu \\, d\\Omega = \\int_0^{2\\pi} d\\phi \\int_0^{\\pi/2} \\cos\\theta \\sin\\theta \\, d\\theta $$\nThe azimuthal integral gives a factor of $2\\pi$. The polar integral is:\n$$ \\int_0^{\\pi/2} \\sin\\theta \\cos\\theta \\, d\\theta = \\left[ \\frac{\\sin^2\\theta}{2} \\right]_0^{\\pi/2} = \\frac{1}{2} - 0 = \\frac{1}{2} $$\nTherefore, the integral over the solid angle is $(2\\pi) \\times (1/2) = \\pi$. The analytical expression for $J^{+}$ is:\n$$ J^{+}_{\\text{analytic}} = \\pi \\psi_L $$\n\nFor $J^{-}$, the integration is over the backward hemisphere: $\\phi \\in [0, 2\\pi]$ and $\\theta \\in [\\pi/2, \\pi]$ (which corresponds to $\\mu \\in [-1, 0]$).\n$$ \\int_{\\mu0} (-\\mu) \\, d\\Omega = \\int_0^{2\\pi} d\\phi \\int_{\\pi/2}^{\\pi} (-\\cos\\theta) \\sin\\theta \\, d\\theta $$\nThe azimuthal integral again gives $2\\pi$. The polar integral is:\n$$ \\int_{\\pi/2}^{\\pi} (-\\cos\\theta) \\sin\\theta \\, d\\theta = \\left[ \\frac{\\cos^2\\theta}{2} \\right]_{\\pi/2}^{\\pi} = \\frac{(-1)^2}{2} - \\frac{0^2}{2} = \\frac{1}{2} $$\nThe integral over the solid angle is also $\\pi$. The analytical expression for $J^{-}$ is:\n$$ J^{-}_{\\text{analytic}} = \\pi \\psi_R $$\n\nNext, we design the Monte Carlo estimator. The integral for $J^{+}$ can be written as an expectation:\n$$ J^{+} = \\int_{2\\pi^+} \\left( \\frac{\\mu \\psi_L}{p(\\Omega)} \\right) p(\\Omega) \\, d\\Omega = E_p\\left[ \\frac{\\mu \\psi_L}{p(\\Omega)} \\right] $$\nwhere $p(\\Omega)$ is a probability density function from which we sample directions $\\Omega$.\nA straightforward choice for the proposal distribution $p(\\Omega)$ is a uniform (isotropic) distribution over the hemisphere, where $p(\\Omega) = 1/(2\\pi)$. To sample from this distribution, we can sample the polar cosine $\\mu$ uniformly from $[0,1]$ and the azimuthal angle $\\phi$ uniformly from $[0, 2\\pi]$. The score, or weight, for a single particle $i$ sampled with direction cosine $\\mu_i$ is:\n$$ W_i^{(+)} = \\frac{\\mu_i \\psi_L}{p(\\Omega_i)} = \\frac{\\mu_i \\psi_L}{1/(2\\pi)} = 2\\pi \\mu_i \\psi_L $$\nThe MC estimate for $J^{+}$ based on $N_L$ samples is the sample mean of these scores:\n$$ \\hat{J}^{+} = \\frac{1}{N_L} \\sum_{i=1}^{N_L} W_i^{(+)} $$\nThis estimator is unbiased, as $E[W_i^{(+)}] = 2\\pi \\psi_L E[\\mu_i] = 2\\pi \\psi_L (1/2) = \\pi \\psi_L = J^{+}_{\\text{analytic}}$.\n\nSimilarly, for $J^{-}$, we sample $\\mu$ uniformly from $[-1, 0]$. The score for a particle is:\n$$ W_i^{(-)} = \\frac{|\\mu_i| \\psi_R}{p(\\Omega_i)} = \\frac{|\\mu_i| \\psi_R}{1/(2\\pi)} = 2\\pi |\\mu_i| \\psi_R $$\nThe MC estimate $\\hat{J}^{-}$ is the average of these scores over $N_R$ samples. This estimator is also unbiased.\n\nThe final component is the statistical verification. For a set of $N$ scores $\\{W_i\\}$, the sample mean is $\\hat{J} = \\frac{1}{N} \\sum W_i$. The sample variance of the scores is $S_W^2 = \\frac{1}{N-1} \\sum (W_i - \\hat{J})^2$. The standard error of the mean is then $\\sigma_{\\hat{J}} = S_W / \\sqrt{N}$.\n\nThe agreement between the MC estimate $\\hat{J}$ and the analytical solution $J_{\\text{analytic}}$ is quantified by the standardized difference $z$:\n$$ z = \\frac{\\hat{J} - J_{\\text{analytic}}}{\\sigma_{\\hat{J}}} $$\nUnder the central limit theorem, for large $N$, $z$ follows a standard normal distribution. Agreement is declared if $|z| \\le k$. For this problem, $k=2$, which corresponds to the MC estimate being within approximately two standard errors of the analytical solution.\n\nIf the number of samples for a current (e.g., $N_L$) is zero, the corresponding source ($\\psi_L$) must also be zero as per the test cases. In this situation, $J_{\\text{analytic}}=0$. No MC estimation is performed, so we can consider the estimate to be $\\hat{J}=0$ with $\\sigma_{\\hat{J}}=0$. The statistical test is not applicable, and we define agreement as true by default, as there is no statistical uncertainty to test. For a given test case, agreement requires that this condition holds for both $J^{+}$ and $J^{-}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and implements a computational benchmark to verify surface crossing\n    estimators for current in nuclear reactor simulation using a half-space\n    isotropic source problem.\n    \"\"\"\n    # Use a fixed random seed for deterministic and reproducible output.\n    SEED = 42\n    rng = np.random.default_rng(SEED)\n\n    # Define the test cases from the problem statement.\n    # Format: (psi_L, psi_R, N_L, N_R)\n    # psi_L: left half-space outward isotropic angular flux\n    # psi_R: right half-space outward isotropic angular flux\n    # N_L: number of MC samples for J+ (from left)\n    # N_R: number of MC samples for J- (from right)\n    test_cases = [\n        (1.0, 0.0, 200000, 0),\n        (0.0, 0.5, 0, 150000),\n        (0.8, 0.8, 100000, 100000),\n        (1.25, 0.75, 1000, 1000),\n    ]\n\n    # Threshold for standardized difference z\n    k = 2.0\n    results = []\n\n    for case in test_cases:\n        psi_L, psi_R, N_L, N_R = case\n\n        # --- Analytical Solutions ---\n        # J_plus = pi * psi_L\n        # J_minus = pi * psi_R\n        j_plus_analytic = np.pi * psi_L\n        j_minus_analytic = np.pi * psi_R\n\n        # Default agreement to True. This handles cases with N=0.\n        z_plus_ok = True\n        z_minus_ok = True\n\n        # --- Monte Carlo Estimation for J+ (left to right) ---\n        if N_L  1:\n            # Sample mu uniformly from [0, 1] for the forward hemisphere.\n            mu_samples = rng.random(size=N_L)\n            \n            # The score for each particle is W = (mu * psi_L) / p(Omega)\n            # where p(Omega) = 1 / (2*pi) for uniform hemisphere sampling.\n            scores = 2.0 * np.pi * mu_samples * psi_L\n            \n            # Compute MC estimate and standard error of the mean\n            j_plus_mc = np.mean(scores)\n            \n            # Use ddof=1 for sample standard deviation\n            std_dev_scores = np.std(scores, ddof=1)\n            std_error_mean = std_dev_scores / np.sqrt(N_L)\n            \n            # Calculate the standardized difference z.\n            # Avoid division by zero if variance is zero (highly unlikely for N  1).\n            if std_error_mean  0:\n                z_plus = (j_plus_mc - j_plus_analytic) / std_error_mean\n                z_plus_ok = abs(z_plus) = k\n            else:\n                # If std_error is 0, the MC estimate must perfectly match the\n                # analytic one for agreement.\n                z_plus_ok = np.isclose(j_plus_mc, j_plus_analytic)\n        \n        # --- Monte Carlo Estimation for J- (right to left) ---\n        if N_R  1:\n            # Sample |mu| uniformly from [0, 1] for the backward hemisphere.\n            # This is equivalent to sampling mu from [-1, 0] and taking abs().\n            abs_mu_samples = rng.random(size=N_R)\n            \n            # The score for each particle is W = (|mu| * psi_R) / p(Omega)\n            scores = 2.0 * np.pi * abs_mu_samples * psi_R\n\n            # Compute MC estimate and standard error of the mean\n            j_minus_mc = np.mean(scores)\n            std_dev_scores = np.std(scores, ddof=1)\n            std_error_mean = std_dev_scores / np.sqrt(N_R)\n\n            # Calculate the standardized difference z.\n            if std_error_mean  0:\n                z_minus = (j_minus_mc - j_minus_analytic) / std_error_mean\n                z_minus_ok = abs(z_minus) = k\n            else:\n                z_minus_ok = np.isclose(j_minus_mc, j_minus_analytic)\n        \n        # Agreement for the case requires both currents to pass the test.\n        case_agreement = z_plus_ok and z_minus_ok\n        results.append(case_agreement)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}