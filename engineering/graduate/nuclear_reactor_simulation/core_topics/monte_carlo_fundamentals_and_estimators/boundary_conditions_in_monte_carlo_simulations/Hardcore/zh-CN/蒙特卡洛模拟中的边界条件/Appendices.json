{
    "hands_on_practices": [
        {
            "introduction": "在蒙特卡洛粒子输运模拟中，最基本的操作是确定粒子在两次相互作用之间的直线飞行路径。这条路径的终点要么是与介质发生碰撞，要么是穿过几何边界。本练习将引导你推导粒子飞行到平面边界的距离，并探讨在真实代码中处理掠射（即粒子轨迹几乎与边界平行）这一关键数值挑战。",
            "id": "4216094",
            "problem": "在用于核反应堆模拟的中性粒子输运中，中子在相互作用之间的流动由线性玻尔兹曼输运方程控制。该方程的确定性流项指出，一个位于位置 $\\mathbf{r}$、方向为 $\\hat{\\Omega}$ 的粒子会沿着参数化射线 $\\mathbf{r}(s)=\\mathbf{r}+s\\,\\hat{\\Omega}$ 前进，直到它在介质中发生相互作用或遇到边界。在蒙特卡罗（MC）模拟中，到下一次碰撞的自由飞行距离是从一个由总宏观截面决定的指数分布中抽样得到的，而潜在的边界穿越是通过计算 $\\mathbf{r}(s)$ 与边界表面的几何交点来定位的。考虑一个凸元胞的一个平面，该平面由单位外法线向量 $\\mathbf{n}$ 和平面上的一个已知点 $\\mathbf{r}_{0}$ 描述，因此平面上的任何点 $\\mathbf{x}$ 都满足 $\\mathbf{n}\\cdot(\\mathbf{x}-\\mathbf{r}_{0})=0$。一个中子当前位于元胞内部的位置 $\\mathbf{r}$，其单位方向为 $\\hat{\\Omega}$，且该元胞具有均匀的总宏观截面 $\\Sigma_{t}$。\n\n(a) 从平面方程和射线参数化出发，推导沿方向 $\\hat{\\Omega}$ 到该平面的边界距离 $s_{b}$ 的表达式，并确定该距离在何种条件下是物理上可接受的（即产生前向相交）。从第一性原理出发，解释 $\\hat{\\Omega}\\cdot\\mathbf{n}\\approx 0$ 的近平行边界情况，包括有限精度算术如何促使我们引入一个容差 $\\tau0$ 来决定在模拟中何时将射线视作与平面平行。\n\n(b) 在一次具体模拟中，设单位外法线向量为 $\\mathbf{n}=(0,0,1)$，平面参考点为 $\\mathbf{r}_{0}=\\big(0,0,5.0\\times 10^{-3}\\big)\\,\\mathrm{m}$，中子位置为 $\\mathbf{r}=\\big(1.0\\times 10^{-3},\\,2.0\\times 10^{-3},\\,4.9\\times 10^{-3}\\big)\\,\\mathrm{m}$，中子方向为 $\\hat{\\Omega}=\\dfrac{(1,\\,0,\\,10^{-12})}{\\|(1,\\,0,\\,10^{-12})\\|}$。总宏观截面为 $\\Sigma_{t}=50\\,\\mathrm{m}^{-1}$，用于抽样自由飞行距离的均匀随机数为 $\\xi=0.2$。采用近平行容差 $\\tau=1.0\\times 10^{-10}$。利用你在(a)部分中的推导，计算物理上实现的流动距离 $s$，该距离为可接受的边界距离和抽样得到的碰撞距离中的最小值。将最终距离 $s$ 以米为单位表示，并将结果四舍五入到六位有效数字。",
            "solution": "该问题分为两部分。 (a)部分要求推导到平面边界的距离，并分析物理上可接受的条件，包括对近平行轨迹的数值处理。 (b)部分要求应用这些原理来计算蒙特卡罗模拟中中子的特定流动距离。\n\n(a) 边界相交的推导与分析\n\n中子在两次相互作用之间沿直线路径运动。其在飞行路径上距离当前位置 $\\mathbf{r}$ 为 $s$ 时的位置 $\\mathbf{r}(s)$ 由参数化射线方程给出：\n$$\n\\mathbf{r}(s) = \\mathbf{r} + s\\,\\hat{\\Omega}\n$$\n其中 $\\hat{\\Omega}$ 是表示中子运动方向的单位向量。\n\n几何体的平面由所有满足以下方程的点集 $\\mathbf{x}$ 描述：\n$$\n\\mathbf{n}\\cdot(\\mathbf{x}-\\mathbf{r}_{0})=0\n$$\n其中 $\\mathbf{n}$ 是平面的单位外法线向量，$\\mathbf{r}_{0}$ 是平面上的一个已知点。\n\n为了求得到边界的距离，记为 $s_{b}$，我们必须找到使中子路径与平面相交的参数 $s$ 的值。这发生在 $\\mathbf{r}(s_{b})$ 满足平面方程时。将射线方程代入平面方程，得到：\n$$\n\\mathbf{n}\\cdot((\\mathbf{r} + s_{b}\\,\\hat{\\Omega}) - \\mathbf{r}_{0}) = 0\n$$\n我们可以利用点积的分配律重新整理这个方程：\n$$\n\\mathbf{n}\\cdot(\\mathbf{r} - \\mathbf{r}_{0}) + \\mathbf{n}\\cdot(s_{b}\\,\\hat{\\Omega}) = 0\n$$\n由于 $s_{b}$ 是一个标量，我们可以将其从第二个点积中提取出来：\n$$\n\\mathbf{n}\\cdot(\\mathbf{r} - \\mathbf{r}_{0}) + s_{b}\\,(\\mathbf{n}\\cdot\\hat{\\Omega}) = 0\n$$\n解出到边界的距离 $s_{b}$，可得：\n$$\ns_{b}\\,(\\mathbf{n}\\cdot\\hat{\\Omega}) = -\\mathbf{n}\\cdot(\\mathbf{r} - \\mathbf{r}_{0}) = \\mathbf{n}\\cdot(\\mathbf{r}_{0} - \\mathbf{r})\n$$\n$$\ns_{b} = \\frac{\\mathbf{n}\\cdot(\\mathbf{r}_{0} - \\mathbf{r})}{\\mathbf{n}\\cdot\\hat{\\Omega}}\n$$\n这就是从点 $\\mathbf{r}$ 沿方向 $\\hat{\\Omega}$ 到平面的距离的通用表达式。\n\n接下来，我们确定该距离在何种条件下是物理上可接受的。\n$1$. 中子必须行进正的距离才能到达边界。因此，我们必须有 $s_{b}  0$。\n$2$. 题目说明点 $\\mathbf{r}$ 位于凸元胞*内部*。由于 $\\mathbf{n}$ 是*单位外*法线向量，从平面上一点($\\mathbf{r}_0$)到粒子位置($\\mathbf{r}$)的向量必须有一个与 $\\mathbf{n}$ 方向相反的分量。在数学上，这意味着 $\\mathbf{n}\\cdot(\\mathbf{r} - \\mathbf{r}_{0})  0$。因此，$s_{b}$ 表达式的分子，即 $\\mathbf{n}\\cdot(\\mathbf{r}_{0} - \\mathbf{r})$，必须为正。\n$3$. 对于 $s_{b} = \\frac{\\mathbf{n}\\cdot(\\mathbf{r}_{0} - \\mathbf{r})}{\\mathbf{n}\\cdot\\hat{\\Omega}}$，要在分子为正的情况下使其为正，分母 $\\mathbf{n}\\cdot\\hat{\\Omega}$ 也必须为正。$\\mathbf{n}\\cdot\\hat{\\Omega}  0$ 的值表示中子的方向向量 $\\hat{\\Omega}$ 有一个沿着外法线 $\\mathbf{n}$ 的分量，这意味着中子正在朝向边界移动，这是在前向发生相交的必要条件。如果 $\\mathbf{n}\\cdot\\hat{\\Omega} \\le 0$，中子正平行于边界或远离边界运动，将不会（在正 $s$ 方向）与其相交，因此 $s_b$ 不是一个有效的正距离。\n\n因此，物理上可接受的前向相交的条件是 $\\mathbf{n}\\cdot\\hat{\\Omega}  0$。\n\n现在我们考虑 $\\mathbf{n}\\cdot\\hat{\\Omega} \\approx 0$ 的近平行边界情况。\n从第一性原理出发，如果中子的路径与平面完全平行，则 $\\hat{\\Omega}$ 与 $\\mathbf{n}$ 正交，且 $\\mathbf{n}\\cdot\\hat{\\Omega} = 0$。在这种情况下，$s_b$ 表达式的分母为零，到交点的距离为无穷大，这在物理上是正确的。\n在使用有限精度算术（例如浮点数）的计算机模拟中，由于先前计算 $\\mathbf{r}$ 或 $\\hat{\\Omega}$ 时的舍入误差，一个数学上为零的值可能会被表示为一个非常小的非零数。如果 $\\mathbf{n}\\cdot\\hat{\\Omega}$ 是一个非常小的非零数，直接用它进行除法会导致严重的数值不稳定性：\n- 如果 $\\mathbf{n}\\cdot\\hat{\\Omega}$ 是一个很小的正数（例如 $10^{-15}$），$s_{b}$ 会变成一个巨大的正数，可能导致溢出。\n- 如果由于微小的数值误差，$\\mathbf{n}\\cdot\\hat{\\Omega}$ 变成一个很小的负数，$s_{b}$ 会被计算为一个大绝对值的负距离，错误地暗示在反向发生相交。\n结果对点积中的微小误差极其敏感。为了确保模拟的鲁棒性，引入了一个容差 $\\tau  0$。在计算 $s_{b}$ 之前，会检查分母的绝对值：\n如果 $|\\mathbf{n}\\cdot\\hat{\\Omega}|  \\tau$，则认为射线与平面实际上是平行的。在这种情况下，算法不进行除法计算。相反，它会判定不会发生相交，并且到这个边界的距离被设置为一个代表无穷大的值。这可以防止除以一个接近零的数，并为近平行轨迹提供一个物理上一致的结果，因为这些轨迹在撞击到该特定平面之前会在元胞内行进很长的距离。\n\n(b) 流动距离的计算\n\n首先，我们定义给定的参数：\n- 单位外法线向量: $\\mathbf{n}=(0,0,1)$。\n- 平面上点: $\\mathbf{r}_{0}=\\big(0,0,5.0\\times 10^{-3}\\big)\\,\\mathrm{m}$。\n- 中子位置: $\\mathbf{r}=\\big(1.0\\times 10^{-3},\\,2.0\\times 10^{-3},\\,4.9\\times 10^{-3}\\big)\\,\\mathrm{m}$。\n- 未归一化的中子方向: $\\mathbf{v} = (1,\\,0,\\,10^{-12})$。\n- 总宏观截面: $\\Sigma_{t}=50\\,\\mathrm{m}^{-1}$。\n- 用于抽样的随机数: $\\xi=0.2$。\n- 近平行容差: $\\tau=1.0\\times 10^{-10}$。\n\n实现的流动距离 $s$ 是两个量的最小值：到下一次碰撞的抽样距离 $s_{c}$ 和到边界的可接受距离 $s_{b}$。\n$$\ns = \\min(s_{c}, s_{b})\n$$\n\n1. 计算抽样碰撞距离 $s_{c}$。\n在蒙特卡罗方法中，碰撞距离是通过反转其累积分布函数从概率分布 $p(s) = \\Sigma_{t}\\exp(-\\Sigma_{t}s)$ 中抽样得到的。这导出了以下公式：\n$$\ns_{c} = -\\frac{1}{\\Sigma_{t}}\\ln(\\xi)\n$$\n代入给定值：\n$$\ns_{c} = -\\frac{1}{50\\,\\mathrm{m}^{-1}}\\ln(0.2) = \\frac{\\ln(5)}{50}\\,\\mathrm{m} \\approx 0.032188758\\,\\mathrm{m}\n$$\n\n2. 计算到边界的距离 $s_{b}$。\n首先，我们必须对方向向量 $\\mathbf{v}$ 进行归一化：\n$$\n\\|\\mathbf{v}\\| = \\sqrt{1^{2} + 0^{2} + (10^{-12})^{2}} = \\sqrt{1 + 10^{-24}}\n$$\n单位方向向量是 $\\hat{\\Omega} = \\frac{\\mathbf{v}}{\\|\\mathbf{v}\\|} = \\frac{(1,\\,0,\\,10^{-12})}{\\sqrt{1 + 10^{-24}}}$。\n\n接下来，我们遵循(a)部分的步骤。我们计算 $s_{b}$ 的分母，记为 $\\mu = \\mathbf{n}\\cdot\\hat{\\Omega}$。\n$$\n\\mu = \\mathbf{n}\\cdot\\hat{\\Omega} = (0,0,1)\\cdot\\frac{(1,\\,0,\\,10^{-12})}{\\sqrt{1 + 10^{-24}}} = \\frac{10^{-12}}{\\sqrt{1 + 10^{-24}}}\n$$\n值 $\\sqrt{1+10^{-24}}$ 与1的差异可以忽略不计，所以 $\\mu \\approx 10^{-12}$。\n现在，我们应用近平行容差检查。我们将 $|\\mu|$ 与 $\\tau$ 进行比较：\n$$\n|\\mu| = \\frac{10^{-12}}{\\sqrt{1 + 10^{-24}}} \\approx 10^{-12}\n$$\n由于 $\\tau = 1.0\\times 10^{-10}$，条件 $|\\mu|  \\tau$ 得到满足，因为 $10^{-12}  10^{-10}$。\n\n根据(a)部分建立的规则，该射线被视为与平面平行。因此，我们不通过除法计算 $s_b$。相反，为了确定下一个事件，到该边界的距离被认为是无穷大。所以，我们设定 $s_{b} = \\infty$。\n\n3. 确定最终的流动距离 $s$。\n流动距离是碰撞距离和边界距离的最小值：\n$$\ns = \\min(s_{c}, s_{b}) = \\min\\left(\\frac{\\ln(5)}{50}\\,\\mathrm{m}, \\infty\\right) = \\frac{\\ln(5)}{50}\\,\\mathrm{m}\n$$\n中子将在到达边界之前在元胞内发生碰撞。\n\n最后，我们计算数值并四舍五入到六位有效数字：\n$$\ns = \\frac{\\ln(5)}{50} \\approx 0.03218875824... \\,\\mathrm{m}\n$$\n四舍五入到六位有效数字，得到：\n$$\ns \\approx 0.0321888\\,\\mathrm{m}\n$$",
            "answer": "$$\n\\boxed{0.0321888}\n$$"
        },
        {
            "introduction": "一旦粒子的运动方向确定，蒙特卡洛模拟就必须决定它的“命运”：是在材料内部发生碰撞，还是到达边界并泄漏。本练习通过一个清晰的解析模型，让你探索这种“竞争”关系。你需要结合到达真空边界的确定性距离和粒子自由程的概率特性，来计算预期的泄漏距离。",
            "id": "4216085",
            "problem": "考虑一个一维平板几何结构，其空间坐标为 $x \\in [0,H]$。$x=0$ 和 $x=H$ 处的两个边界都是真空边界，这意味着任何到达边界的粒子都会离开系统。一个中性粒子在位置 $x_0 \\in (0,H)$ 处产生，其相对于 $+x$ 轴的方向余弦为 $\\mu \\in (0,1)$。介质是均匀的，具有恒定的总宏观截面 $\\Sigma_t  0$，并且所有相互作用都是纯吸收性的（即，任何碰撞都会终止粒子的历史）。在这些条件下，蒙特卡罗（MC）输运模拟中，到下一次碰撞的自由程 $S$ 是一个指数分布的随机变量，其生存概率为 $\\mathbb{P}(S  s) = \\exp(-\\Sigma_t s)$（对于 $s \\geq 0$）。定义随机变量 $D_{\\text{leak}}$ 为粒子从其起始位置行进到在 $x=H$ 处发生真空泄漏所经过的距离，约定如果在到达 $x=H$ 之前发生碰撞，则 $D_{\\text{leak}} = 0$。\n\n仅使用指数自由程分布的基本定义和真空边界条件，推导泄漏到真空的期望距离 $\\mathbb{E}[D_{\\text{leak}}]$ 的封闭形式表达式，该表达式用 $\\Sigma_t$、$x_0$、$\\mu$ 和 $H$ 表示。将您的最终答案表示为使用这些符号的封闭形式解析表达式。不需要进行数值计算，也不需要四舍五入。",
            "solution": "目标是计算随机变量 $D_{\\text{leak}}$ 的期望值，记为 $\\mathbb{E}[D_{\\text{leak}}]$。该变量表示粒子在通过 $x=H$ 处的边界泄漏之前行进的距离。\n\n首先，我们描述粒子的轨迹。粒子从位置 $x_0$ 开始，以相对于 $+x$ 轴的方向余弦 $\\mu$ 运动。粒子行进路径长度 $s$ 后的位置由 $x(s) = x_0 + \\mu s$ 给出。由于粒子产生时 $\\mu \\in (0,1)$，它正朝着 $x=H$ 处的边界移动。\n\n粒子必须行进才能到达 $x=H$ 处边界的距离是一个确定量。设此距离为 $s_H$。我们通过设置 $x(s_H) = H$ 来找到 $s_H$：\n$$H = x_0 + \\mu s_H$$\n求解 $s_H$ 得：\n$$s_H = \\frac{H - x_0}{\\mu}$$\n由于 $x_0  H$ 且 $\\mu  0$，我们有 $s_H  0$。\n\n粒子的生命由两个互斥事件之间的竞争决定：\n1. 粒子行进距离 $s_H$ 而不发生碰撞，并在 $x=H$ 处从系统中泄漏。\n2. 粒子在行进距离 $s_H$ 之前发生碰撞。\n\n到第一次碰撞的距离 $S$ 是一个服从指数分布的随机变量。其概率密度函数（PDF）为 $f_S(s) = \\Sigma_t \\exp(-\\Sigma_t s)$（对于 $s \\ge 0$），而生存概率（累积分布函数的补）由 $\\mathbb{P}(S  s) = \\exp(-\\Sigma_t s)$ 给出。\n\n现在我们可以根据自由程 $S$ 和到边界的距离 $s_H$ 更正式地定义随机变量 $D_{\\text{leak}}$：\n- 如果粒子泄漏（事件 L），这意味着抽样的自由程 $S$ 大于到边界的距离 $s_H$。在这种情况下，粒子恰好行进了到边界的距离 $s_H$。根据问题定义，$D_{\\text{leak}} = s_H$。此事件为 $S  s_H$。\n- 如果粒子在泄漏前碰撞（事件 C），这意味着抽样的自由程 $S$ 小于或等于到边界的距离 $s_H$。问题规定，在这种情况下，$D_{\\text{leak}}$ 定义为 $0$。此事件为 $S \\le s_H$。\n\n所以，我们有：\n$$D_{\\text{leak}} = \\begin{cases} s_H  \\text{if } S  s_H \\\\ 0  \\text{if } S \\le s_H \\end{cases}$$\n\n$D_{\\text{leak}}$ 的期望值可以使用全期望定律计算，方法是将每个事件的 $D_{\\text{leak}}$ 值乘以该事件的概率后求和：\n$$\\mathbb{E}[D_{\\text{leak}}] = (s_H) \\cdot \\mathbb{P}(\\text{事件 L}) + (0) \\cdot \\mathbb{P}(\\text{事件 C})$$\n$$\\mathbb{E}[D_{\\text{leak}}] = s_H \\cdot \\mathbb{P}(S  s_H)$$\n\n我们需要计算泄漏概率 $\\mathbb{P}(S  s_H)$。使用给定的生存概率函数 $\\mathbb{P}(S  s) = \\exp(-\\Sigma_t s)$，我们可以代入 $s = s_H$：\n$$\\mathbb{P}(S  s_H) = \\exp(-\\Sigma_t s_H)$$\n\n现在，我们将此概率和 $s_H$ 的表达式代入期望值的公式中：\n$$\\mathbb{E}[D_{\\text{leak}}] = s_H \\cdot \\exp(-\\Sigma_t s_H)$$\n代入 $s_H = \\frac{H - x_0}{\\mu}$：\n$$\\mathbb{E}[D_{\\text{leak}}] = \\left(\\frac{H - x_0}{\\mu}\\right) \\exp\\left(-\\Sigma_t \\frac{H - x_0}{\\mu}\\right)$$\n\n这就是以给定参数 $\\Sigma_t$、$x_0$、$\\mu$ 和 $H$ 表示的真空泄漏期望距离的最终封闭形式表达式。",
            "answer": "$$\\boxed{\\frac{H - x_0}{\\mu} \\exp\\left(-\\Sigma_t \\frac{H - x_0}{\\mu}\\right)}$$"
        },
        {
            "introduction": "当粒子到达一个边界时，它的旅程不一定就此结束。许多类型的边界条件，例如反射，会将粒子重新导向模拟区域。本练习模拟了一种重要的边界情况——反照率边界，将其视为一系列概率事件，让你推导粒子在最终被边界吸收前所经历的期望反射次数。",
            "id": "4216119",
            "problem": "考虑一个核反应堆模型的均匀无源区域，其中粒子历史通过蒙特卡洛（MC）方法进行模拟。该区域的一侧由一个平面界面界定，该界面实施恒定反照率边界条件。具体来说，每次与边界相遇时，一个粒子有概率 $\\alpha$ 被反射，有概率 $1-\\alpha$ 被吸收，其中 $0  \\alpha  1$。假设连续的边界相互作用是统计独立的，并且反射/吸收概率不随角度、能量和历史而变化。\n\n一个粒子从紧邻边界处开始并朝其移动，因此边界相互作用必然会发生。令 $K$ 表示粒子在边界上首次被吸收之前所经历的边界反射总次数。仅使用概率论的第一性原理（试验的独立性和概率守恒），并且不按名称引用任何现成的分布公式，推导 $k\\in\\{0,1,2,\\dots\\}$ 的概率质量函数 $p_{K}(k)$，然后计算期望值 $\\mathbb{E}[K]$，并将其表示为关于 $\\alpha$ 的闭式解析表达式。\n\n将您关于 $\\mathbb{E}[K]$ 的最终答案表示为单个闭式表达式。无需四舍五入，最终表达式中也不包含单位。",
            "solution": "问题要求解随机变量 $K$ 的概率质量函数（PMF），$K$ 代表粒子在被吸收前在边界处经历的总反射次数，及其期望值 $\\mathbb{E}[K]$。粒子与边界进行一系列统计独立的相互作用。在每次相互作用中，粒子以概率 $\\alpha$ 被反射，以概率 $1-\\alpha$ 被吸收，其中 $0  \\alpha  1$。\n\n首先，我们推导 $k \\in \\{0, 1, 2, \\dots\\}$ 的 PMF，记为 $p_K(k) = P(K=k)$。事件 $\\{K=k\\}$ 表示粒子被精确反射 $k$ 次，然后在第 $(k+1)$ 次与边界的相互作用中被吸收。\n\n对于 $k=0$ 的情况，事件 $\\{K=0\\}$ 意味着粒子在其第一次边界相互作用时被吸收。这个单一事件的概率是：\n$$p_K(0) = P(\\text{吸收}) = 1-\\alpha$$\n\n对于 $k=1$ 的情况，事件 $\\{K=1\\}$ 对应于一次反射后紧接着一次吸收。由于相互作用是统计独立的，这两个事件序列的概率是它们各自概率的乘积：\n$$p_K(1) = P(\\text{反射}) \\times P(\\text{吸收}) = \\alpha \\cdot (1-\\alpha)$$\n\n对于 $k=2$ 的情况，事件 $\\{K=2\\}$ 对应于两次连续反射后紧接着一次吸收。这个序列的概率是：\n$$p_K(2) = P(\\text{反射}) \\times P(\\text{反射}) \\times P(\\text{吸收}) = \\alpha \\cdot \\alpha \\cdot (1-\\alpha) = \\alpha^2 (1-\\alpha)$$\n\n将此模式推广到任意非负整数 $k$，事件 $\\{K=k\\}$ 由一个精确包含 $k$ 次独立反射、并紧随其后一次吸收的序列组成。这个特定序列的概率是这 $k+1$ 个事件概率的乘积：\n$$p_K(k) = \\underbrace{P(\\text{反射}) \\times \\dots \\times P(\\text{反射})}_{k \\text{ 次}} \\times P(\\text{吸收}) = \\underbrace{\\alpha \\cdot \\ldots \\cdot \\alpha}_{k \\text{ 次}} \\cdot (1-\\alpha)$$\n因此，$K$ 的概率质量函数是：\n$$p_K(k) = \\alpha^k (1-\\alpha) \\quad \\text{对于 } k \\in \\{0, 1, 2, \\dots\\}$$\n\n为确认这是一个有效的 PMF，我们可以检查其在整个支撑集上的和是否为 $1$。该和是一个几何级数：\n$$\\sum_{k=0}^{\\infty} p_K(k) = \\sum_{k=0}^{\\infty} \\alpha^k (1-\\alpha) = (1-\\alpha) \\sum_{k=0}^{\\infty} \\alpha^k$$\n由于 $0  \\alpha  1$，该几何级数收敛：\n$$\\sum_{k=0}^{\\infty} \\alpha^k = \\frac{1}{1-\\alpha}$$\n将此结果代回，我们发现：\n$$(1-\\alpha) \\left( \\frac{1}{1-\\alpha} \\right) = 1$$\n因此，该 PMF 是正确归一化的。\n\n接下来，我们使用离散随机变量的定义来计算期望值 $\\mathbb{E}[K]$：\n$$\\mathbb{E}[K] = \\sum_{k=0}^{\\infty} k \\cdot p_K(k)$$\n代入我们推导出的 PMF：\n$$\\mathbb{E}[K] = \\sum_{k=0}^{\\infty} k \\cdot \\alpha^k (1-\\alpha)$$\n我们可以将常数 $(1-\\alpha)$ 从求和中提出来：\n$$\\mathbb{E}[K] = (1-\\alpha) \\sum_{k=0}^{\\infty} k \\alpha^k$$\n级数的第一项（对于 $k=0$）是 $0 \\cdot \\alpha^0 = 0$，所以我们可以从 $k=1$ 开始求和：\n$$\\mathbb{E}[K] = (1-\\alpha) \\sum_{k=1}^{\\infty} k \\alpha^k$$\n为计算和 $S = \\sum_{k=1}^{\\infty} k \\alpha^k$，我们使用一种标准技巧，该技巧涉及几何级数公式的导数。考虑几何级数：\n$$G(\\alpha) = \\sum_{k=0}^{\\infty} \\alpha^k = \\frac{1}{1-\\alpha} \\quad \\text{对于 } |\\alpha|  1$$\n对两边关于 $\\alpha$ 求导，得到：\n$$\\frac{dG}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\sum_{k=0}^{\\infty} \\alpha^k \\right) = \\sum_{k=1}^{\\infty} k \\alpha^{k-1}$$\n右侧的导数是：\n$$\\frac{d}{d\\alpha} \\left( (1-\\alpha)^{-1} \\right) = -1 \\cdot (1-\\alpha)^{-2} \\cdot (-1) = \\frac{1}{(1-\\alpha)^2}$$\n令两个结果相等：\n$$\\sum_{k=1}^{\\infty} k \\alpha^{k-1} = \\frac{1}{(1-\\alpha)^2}$$\n为找到我们所需的和 $S = \\sum_{k=1}^{\\infty} k \\alpha^k$，我们将上述表达式乘以 $\\alpha$：\n$$S = \\alpha \\sum_{k=1}^{\\infty} k \\alpha^{k-1} = \\sum_{k=1}^{\\infty} k \\alpha^k = \\alpha \\cdot \\frac{1}{(1-\\alpha)^2} = \\frac{\\alpha}{(1-\\alpha)^2}$$\n最后，我们将此结果代回到我们关于 $\\mathbb{E}[K]$ 的表达式中：\n$$\\mathbb{E}[K] = (1-\\alpha) \\cdot S = (1-\\alpha) \\cdot \\frac{\\alpha}{(1-\\alpha)^2}$$\n简化表达式得到 $K$ 的期望值：\n$$\\mathbb{E}[K] = \\frac{\\alpha}{1-\\alpha}$$\n这就是在被吸收前期望的反射次数的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\alpha}{1-\\alpha}}\n$$"
        }
    ]
}