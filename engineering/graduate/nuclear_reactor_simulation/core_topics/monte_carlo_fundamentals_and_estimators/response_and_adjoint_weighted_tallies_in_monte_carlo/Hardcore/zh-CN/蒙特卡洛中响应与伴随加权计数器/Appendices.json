{
    "hands_on_practices": [
        {
            "introduction": "在蒙特卡洛模拟中，我们如何将粒子源的贡献与特定探测器的响应联系起来？此练习从输运理论的第一性原理出发，探讨了前向输运与伴随（或重要性）输运之间的深刻对偶关系。核心在于推导互易关系，它严格地将伴随通量 $\\psi^{\\dagger}$ 定义为粒子对于探测器响应的“重要性”函数。通过从玻尔兹曼输运方程出发推导这一关系，您将深入理解为何点探测器（或称下一事件）估计法是一种在概念上和数学上都极为严谨的计数方法 。",
            "id": "4246260",
            "problem": "考虑一个无限均匀介质中的稳态单能中子场，该介质无散射，在能量 $E_{0}$ 处具有恒定的宏观总截面 $\\Sigma_{t}$。一个强度为 $S$（单位：中子/秒）的点各向同性中子源位于位置 $\\mathbf{r}_{s}$。一个点探测器位于位置 $\\mathbf{r}_{d}$，其响应泛函定义为探测器位置处能量为 $E_{0}$ 的标量通量（即对所有方向积分后的角通量）。正向输运由玻尔兹曼输运方程（BTE）描述，而相应的伴随输运方程定义了用于伴随权重统计的重要性函数。\n\n从稳态单能玻尔兹曼输运方程和伴随问题的定义出发，根据第一性原理推导连接正向源 $q$ 与探测器响应的互易关系（通过伴随通量 $\\psi^{\\dagger}$），并说明所得的互易关系如何导出蒙特卡罗模拟中下次事件（点探测器）估计子的形式。利用你的推导，求出在这种无散射介质中探测器响应的闭式表达式，并使用以下物理上一致的参数计算其值：\n- $\\Sigma_{t} = 0.18 \\ \\text{cm}^{-1}$，\n- $S = 2.0 \\times 10^{7} \\ \\text{s}^{-1}$，\n- $\\mathbf{r}_{s} = (0,0,0) \\ \\text{cm}$，\n- $\\mathbf{r}_{d} = (25.0,0,0) \\ \\text{cm}$。\n\n将最终的探测器响应表示为在 $\\mathbf{r}_{d}$ 处的标量通量，单位为 $\\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}$，并将答案四舍五入到四位有效数字。最终答案必须是一个实数。",
            "solution": "用户要求我解决一个核输运理论的问题。\n\n### 第1步：提取已知条件\n\n-   **物理系统**: 无限均匀介质中的稳态单能中子场。\n-   **相互作用**: 无散射。\n-   **截面**: 能量为 $E_{0}$ 时的恒定宏观总截面 $\\Sigma_{t}$。\n-   **源**: 位于 $\\mathbf{r}_{s}$ 的点各向同性中子源，强度为 $S$（中子/秒）。源项为 $q(\\mathbf{r}, \\Omega) = \\frac{S}{4\\pi}\\delta(\\mathbf{r}-\\mathbf{r}_s)$。\n-   **探测器**: 位于位置 $\\mathbf{r}_{d}$ 的点探测器。\n-   **探测器响应**: 探测器位置处的标量通量，$R = \\phi(\\mathbf{r}_d) = \\int_{4\\pi} \\psi(\\mathbf{r}_d, \\Omega) d\\Omega$。\n-   **控制方程**: 正向和伴随玻尔兹曼输运方程（BTE）。\n-   **参数**:\n    -   $\\Sigma_{t} = 0.18 \\ \\text{cm}^{-1}$\n    -   $S = 2.0 \\times 10^{7} \\ \\text{s}^{-1}$\n    -   $\\mathbf{r}_{s} = (0,0,0) \\ \\text{cm}$\n    -   $\\mathbf{r}_{d} = (25.0,0,0) \\ \\text{cm}$\n\n### 第2步：使用提取的已知条件进行验证\n\n-   **科学依据**: 该问题基于中子输运理论的基本原理，特别是玻尔兹曼输运方程和伴随函数的概念。物理情景（无限非散射介质中的点源）是教科书中用于推导基本结果（如点核解）的标准理想化案例。该问题在科学上是合理的。\n-   **适定性**: 该问题是适定的。它要求推导一个基本关系（互易性），其与计算方法（下次事件估计子）的联系，以及为一个明确定义的系统计算一个物理量（通量）。所提供的参数足以得到唯一解，且参数之间是一致的。\n-   **客观性**: 该问题以物理学和工程学中常见的精确、客观的语言陈述。它没有歧义、主观性或观点。\n-   **其他检查**: 该问题是完整的，没有缺失或矛盾的信息。参数在物理上是现实的，并且在量纲上是一致的。\n\n### 第3步：结论与行动\n\n该问题是有效的。我将继续进行解答。\n\n### 推导与求解\n\n该问题需要一个三部分的解答：推导互易关系，将其与下次事件估计子联系起来，以及计算探测器响应。\n\n**第1部分：互易关系**\n\n无散射介质中，角中子通量 $\\psi(\\mathbf{r}, \\Omega)$ 的稳态单能BTE为：\n$$\n\\Omega \\cdot \\nabla \\psi(\\mathbf{r}, \\Omega) + \\Sigma_t \\psi(\\mathbf{r}, \\Omega) = q(\\mathbf{r}, \\Omega)\n$$\n我们可以将其写成算子形式 $L\\psi = q$，其中输运算子 $L$ 定义为：\n$$\nL \\equiv \\Omega \\cdot \\nabla + \\Sigma_t\n$$\n位于 $\\mathbf{r}_s$、强度为 $S$ 的点各向同性源的源项 $q$ 为：\n$$\nq(\\mathbf{r}, \\Omega) = \\frac{S}{4\\pi} \\delta(\\mathbf{r} - \\mathbf{r}_s)\n$$\n探测器响应 $R$ 是探测器位置 $\\mathbf{r}_d$ 处的标量通量：\n$$\nR = \\phi(\\mathbf{r}_d) = \\int_{4\\pi} \\psi(\\mathbf{r}_d, \\Omega) d\\Omega\n$$\n为使其形式化，我们在相空间 $(\\mathbf{r}, \\Omega)$ 上引入内积：\n$$\n\\langle f, g \\rangle \\equiv \\int dV \\int_{4\\pi} d\\Omega \\, f(\\mathbf{r}, \\Omega) g(\\mathbf{r}, \\Omega)\n$$\n使用此符号，响应 $R$ 可写作：\n$$\nR = \\int dV \\int_{4\\pi} d\\Omega \\, \\psi(\\mathbf{r}, \\Omega) \\delta(\\mathbf{r} - \\mathbf{r}_d) = \\langle \\psi, q^\\dagger \\rangle\n$$\n其中我们将伴随源（或响应函数）定义为 $q^\\dagger(\\mathbf{r}, \\Omega) = \\delta(\\mathbf{r} - \\mathbf{r}_d)$。这代表一个在角灵敏度上是各向同性的探测器。\n\n伴随输运方程定义为 $L^\\dagger \\psi^\\dagger = q^\\dagger$，其中 $L^\\dagger$ 是 $L$ 的伴随算子，$\\psi^\\dagger$ 是伴随通量或重要性函数。伴随算子由关系式 $\\langle \\psi^\\dagger, L\\psi \\rangle = \\langle L^\\dagger\\psi^\\dagger, \\psi \\rangle$ 定义。我们来求 $L^\\dagger$：\n$$\n\\langle \\psi^\\dagger, L\\psi \\rangle = \\int dV \\int_{4\\pi} d\\Omega \\, \\psi^\\dagger (\\Omega \\cdot \\nabla \\psi + \\Sigma_t \\psi)\n$$\n$$\n\\langle \\psi^\\dagger, L\\psi \\rangle = \\int dV \\int_{4\\pi} d\\Omega \\, (\\psi^\\dagger \\Sigma_t \\psi) + \\int_{4\\pi} d\\Omega \\int dV \\, \\psi^\\dagger (\\Omega \\cdot \\nabla \\psi)\n$$\n使用恒等式 $\\nabla \\cdot (\\psi^\\dagger \\psi \\Omega) = (\\Omega \\cdot \\nabla \\psi^\\dagger)\\psi + \\psi^\\dagger(\\Omega \\cdot \\nabla \\psi)$，空间积分变为：\n$$\n\\int_V dV \\, \\psi^\\dagger (\\Omega \\cdot \\nabla \\psi) = \\int_V dV \\, [\\nabla \\cdot (\\psi^\\dagger \\psi \\Omega) - (\\Omega \\cdot \\nabla \\psi^\\dagger)\\psi]\n$$\n根据高斯定理，$\\int_V dV \\, \\nabla \\cdot (\\mathbf{F}) = \\oint_A d\\mathbf{A} \\cdot \\mathbf{F}$。对于无限介质，通量 $\\psi$ 在无穷远处必须为零，因此面积分为零。于是：\n$$\n\\int_V dV \\, \\psi^\\dagger (\\Omega \\cdot \\nabla \\psi) = \\int_V dV \\, [-(\\Omega \\cdot \\nabla \\psi^\\dagger)\\psi]\n$$\n将此代回内积表达式：\n$$\n\\langle \\psi^\\dagger, L\\psi \\rangle = \\int dV \\int_{4\\pi} d\\Omega \\, [ -(\\Omega \\cdot \\nabla \\psi^\\dagger)\\psi + (\\Sigma_t \\psi^\\dagger)\\psi ] = \\langle (-\\Omega \\cdot \\nabla + \\Sigma_t)\\psi^\\dagger, \\psi \\rangle\n$$\n因此，伴随算子为 $L^\\dagger = -\\Omega \\cdot \\nabla + \\Sigma_t$。伴随BTE为：\n$$\nL^\\dagger \\psi^\\dagger(\\mathbf{r}, \\Omega) = -\\Omega \\cdot \\nabla \\psi^\\dagger(\\mathbf{r}, \\Omega) + \\Sigma_t \\psi^\\dagger(\\mathbf{r}, \\Omega) = q^\\dagger(\\mathbf{r}, \\Omega)\n$$\n现在我们推导互易关系。我们从BTE及其伴随形式开始：\n1. $L\\psi = q \\implies \\langle\\psi^\\dagger, L\\psi\\rangle = \\langle\\psi^\\dagger, q\\rangle$\n2. $L^\\dagger\\psi^\\dagger = q^\\dagger \\implies \\langle L^\\dagger\\psi^\\dagger, \\psi\\rangle = \\langle q^\\dagger, \\psi\\rangle$\n\n由于根据伴随算子的定义 $\\langle\\psi^\\dagger, L\\psi\\rangle = \\langle L^\\dagger\\psi^\\dagger, \\psi\\rangle$，我们必有：\n$$\n\\langle \\psi^\\dagger, q \\rangle = \\langle q^\\dagger, \\psi \\rangle\n$$\n这就是互易关系的一般形式。它表明，由 $q^\\dagger$ 定义的探测器对源 $q$ 的响应，等于由 $q$ 定义的探测器对源 $q^\\dagger$ 的响应。对于我们的具体问题，这变为：\n$$\nR = \\langle q^\\dagger, \\psi \\rangle = \\langle \\psi^\\dagger, q \\rangle = \\int dV \\int_{4\\pi} d\\Omega \\, \\psi^\\dagger(\\mathbf{r}, \\Omega) \\left( \\frac{S}{4\\pi}\\delta(\\mathbf{r} - \\mathbf{r}_s) \\right) = \\frac{S}{4\\pi} \\int_{4\\pi} \\psi^\\dagger(\\mathbf{r}_s, \\Omega) d\\Omega\n$$\n将伴随标量通量定义为 $\\phi^\\dagger(\\mathbf{r}) = \\int_{4\\pi} \\psi^\\dagger(\\mathbf{r}, \\Omega) d\\Omega$，互易关系将探测器响应与源位置处的伴随标量通量联系起来：\n$$\nR = \\phi(\\mathbf{r}_d) = \\frac{S}{4\\pi} \\phi^\\dagger(\\mathbf{r}_s)\n$$\n\n**第2部分：与下次事件估计子的联系**\n\n互易关系 $R = \\langle \\psi^\\dagger, q \\rangle = \\int q(\\mathbf{r}, \\Omega) \\psi^\\dagger(\\mathbf{r}, \\Omega) dV d\\Omega$ 将总探测器响应表示为源密度 $q$ 乘以重要性函数 $\\psi^\\dagger$ 的积分。\n\n在蒙特卡罗模拟中，我们不解析地求解这个积分。相反，我们从源分布 $q(\\mathbf{r}, \\Omega)$ 中抽样粒子。每个抽样得到的源粒子，在 $(\\mathbf{r}_i, \\Omega_i)$ 处以权重 $w_i$ 产生，代表了源密度的一个统计样本。\n\n量 $\\psi^\\dagger(\\mathbf{r}_i, \\Omega_i)$ 代表从相空间点 $(\\mathbf{r}_i, \\Omega_i)$ 出发的一个粒子对探测器响应的期望贡献。对于点探测器，这是粒子从 $\\mathbf{r}_i$ 传播到探测器位置 $\\mathbf{r}_d$ 而不发生碰撞的概率，再乘以一个几何因子以考虑单位面积探测器所张的立体角。这正是未碰撞通量。\n\n下次事件估计子是一种蒙特卡罗技术，它在每次事件（源发射或碰撞）中直接对这一贡献进行评分。对于在 $\\mathbf{r}_s$ 处产生的源粒子，下次事件估计子对位于 $\\mathbf{r}_d$ 的点探测器的贡献评分为：\n$$\n\\text{Score} = w_s \\times P(\\mathbf{r}_s \\to \\mathbf{r}_d) \\times G(\\mathbf{r}_s, \\mathbf{r}_d)\n$$\n其中 $w_s$ 是粒子权重，$P(\\mathbf{r}_s \\to \\mathbf{r}_d) = \\exp(-\\Sigma_t |\\mathbf{r}_d - \\mathbf{r}_s|)$ 是非碰撞概率，$G(\\mathbf{r}_s, \\mathbf{r}_d) = \\frac{1}{4\\pi|\\mathbf{r}_d - \\mathbf{r}_s|^2}$ 是几何衰减因子。整个项是从 $\\mathbf{r}_s$ 到 $\\mathbf{r}_d$ 的未碰撞通量，也就是重要性 $\\phi^\\dagger(\\mathbf{r}_s) / (4\\pi)$。因此，来自源的总响应是 $S \\times \\text{Score} / w_s$。\n\n互易关系为这种方法提供了正式的理论基础：通过对所有源事件的重要性加权贡献求和，我们实际上是在统计地评估积分 $\\langle \\psi^\\dagger, q \\rangle$ 以获得正确的总响应 $R$。因此，下次事件点探测器估计子的形式，是在每次事件中对重要性函数 $\\psi^\\dagger$ 进行评分的直接实现，其合理性由互易定理保证。\n\n**第3部分：闭式表达式与计算**\n\n我们需要求出探测器响应 $R = \\phi(\\mathbf{r}_d)$。我们可以通过考虑正向问题来直接求解。物理情景是一个强度为 $S$ 的点各向同性源位于一个无限的纯吸收介质中。距离此类源 $d$ 处的标量通量由输运方程的点核（或格林函数）解给出：\n$$\n\\phi(d) = \\frac{S \\exp(-\\Sigma_t d)}{4\\pi d^2}\n$$\n源和探测器之间的距离 $d$ 是：\n$$\nd = |\\mathbf{r}_d - \\mathbf{r}_s| = \\sqrt{(25.0 - 0)^2 + (0 - 0)^2 + (0 - 0)^2} = 25.0 \\ \\text{cm}\n$$\n探测器响应是该距离处的标量通量：\n$$\nR = \\phi(\\mathbf{r}_d) = \\frac{S \\exp(-\\Sigma_t |\\mathbf{r}_d - \\mathbf{r}_s|)}{4\\pi |\\mathbf{r}_d - \\mathbf{r}_s|^2}\n$$\n代入给定的数值：\n$$\nR = \\frac{(2.0 \\times 10^7 \\ \\text{s}^{-1}) \\exp(-(0.18 \\ \\text{cm}^{-1})(25.0 \\ \\text{cm}))}{4\\pi (25.0 \\ \\text{cm})^2}\n$$\n首先，计算指数的参数：\n$$\n\\Sigma_t d = (0.18)(25.0) = 4.5\n$$\n现在将此代回 $R$ 的表达式中：\n$$\nR = \\frac{2.0 \\times 10^7}{4\\pi (625)} \\exp(-4.5) \\ \\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}\n$$\n$$\nR = \\frac{2.0 \\times 10^7}{2500\\pi} \\exp(-4.5) \\ \\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}\n$$\n$$\nR = \\frac{8000}{\\pi} \\exp(-4.5) \\ \\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}\n$$\n现在，我们进行数值计算：\n$$\nR \\approx \\frac{8000}{3.14159265...} \\times 0.01110901...\n$$\n$$\nR \\approx (2546.479...) \\times (0.01110901...) \\approx 28.28800 \\ \\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}\n$$\n根据要求四舍五入到四位有效数字，探测器响应为 $28.29 \\ \\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}$。\n（注：使用互易关系 $R = \\frac{S}{4\\pi}\\phi^\\dagger(\\mathbf{r}_s)$ 会得到相同的结果，因为对于 $\\phi^\\dagger(\\mathbf{r})$ 的伴随问题的解是 $\\phi^\\dagger(\\mathbf{r}) = \\frac{\\exp(-\\Sigma_t |\\mathbf{r} - \\mathbf{r}_d|)}{|\\mathbf{r} - \\mathbf{r}_d|^2}$，这会得出 $R = \\frac{S}{4\\pi} \\frac{\\exp(-\\Sigma_t |\\mathbf{r}_s-\\mathbf{r}_d|)}{|\\mathbf{r}_s-\\mathbf{r}_d|^2}$。）",
            "answer": "$$\\boxed{28.29}$$"
        },
        {
            "introduction": "理解了伴随函数作为重要性的概念后，一个自然的问题是：我们能否利用这一信息来设计一个“完美”的模拟，使其以最小的计算成本获得最精确的结果？此练习通过一个简化的离散状态马尔可夫链模型，让您能够在一个清晰的代数框架中探索零方差原理的精髓。该原理指出，如果我们根据粒子的重要性来偏倚其跃迁概率，使得每一步之后的重要性加权贡献保持不变，那么响应估计的方差将降至零。通过为离散状态计算精确的伴随值并推导最优偏倚概率 ，您将为构建高级方差缩减方法打下坚实的直觉基础。",
            "id": "4246245",
            "problem": "考虑一个双能群、空间均匀化的反应堆模型，其中中子历史由一个离散状态马尔可夫链表示。瞬态为快中子群态 $F$ 和热中子群态 $T$。终止态为一个贡献单位响应的探测态 $D$ 和一个贡献零响应的非计数损失态 $X$。设未经修改的模拟转移概率为\n- 从 $F$ 出发：$P(F \\to F) = 0.6$，$P(F \\to T) = 0.3$，$P(F \\to X) = 0.1$，\n- 从 $T$ 出发：$P(T \\to T) = 0.5$，$P(T \\to D) = 0.4$，$P(T \\to X) = 0.1$，\n且没有直接的 $F \\to D$ 转移。\n\n响应定义为每个源中子在 $D$ 中被探测的期望次数，并且在连续输运算符的层面上，它等于正向通量与探测器响应函数的内积。伴随通量求解与此响应对应的伴随输运方程，并衡量相空间点对响应的重要性。在这种离散状态的简化中，伴随值 $\\phi^{\\dagger}(F)$ 和 $\\phi^{\\dagger}(T)$ 代表从中子态 $F$ 和 $T$ 开始对响应的期望贡献。\n\n从伴随解是响应相对于源的泛函导数这一原理出发，并且对于输运的线性马尔可夫链表示，瞬态的伴随值满足通过对第一次转移进行条件化得到的平衡方程，推导出 $\\phi^{\\dagger}(F)$ 和 $\\phi^{\\dagger}(T)$ 满足的耦合方程，不引入任何零方差方法特有的简化公式。求解这些方程以获得给定概率下的 $\\phi^{\\dagger}(F)$ 和 $\\phi^{\\dagger}(T)$。\n\n接下来，使用零方差原理——即，如果转移被偏倚，使得在所有抽样结果中，预期的下游贡献（伴随加权）均等化，那么就可以实现响应的常权重估计——根据模拟转移概率和伴随值，推导从 $F$ 到 $T$ 的最优偏倚转移概率表达式，该表达式强制实现响应估计的零方差。最后，对给定系统数值计算此偏倚概率。将最终答案表示为单个实数。无需四舍五入；以小数形式提供精确值。",
            "solution": "正向中子输运是一个线性过程，给定探测器的响应泛函 $R$ 是正向通量 $\\psi$ 的线性函数。在连续设定下，伴随通量 $\\psi^{\\dagger}$ 求解伴随输运方程，使得双线性形式满足\n$$\n\\langle \\psi^{\\dagger}, Q \\rangle = \\langle q, \\psi \\rangle = R,\n$$\n其中 $Q$ 是源，$q$ 是探测器响应函数，$\\langle \\cdot, \\cdot \\rangle$ 表示相空间上的适当内积。伴随通量 $\\psi^{\\dagger}$ 量化了重要性：$\\psi^{\\dagger}(\\mathbf{r}, E, \\boldsymbol{\\Omega})$ 是一个从 $(\\mathbf{r}, E, \\boldsymbol{\\Omega})$ 出发的粒子对响应的期望贡献。\n\n我们现在考虑一个离散状态马尔可夫链近似，其瞬态为 $F$ 和 $T$，终止态为 $D$（得分 $1$）和 $X$（得分 $0$）。瞬态的伴随值是如果历史从该状态开始的期望未来得分。因此，通过对离开该状态的第一次转移进行条件化，我们得到以下平衡方程：\n- 对于 $T$，下一步要么保持在 $T$，要么去 $D$，要么去 $X$。从 $T$ 开始的期望未来得分为\n$$\n\\phi^{\\dagger}(T) = P(T \\to T)\\,\\phi^{\\dagger}(T) + P(T \\to D)\\,\\phi^{\\dagger}(D) + P(T \\to X)\\,\\phi^{\\dagger}(X).\n$$\n因为 $D$ 是单位贡献的探测态，$X$ 是非计数态，我们有 $\\phi^{\\dagger}(D) = 1$ 和 $\\phi^{\\dagger}(X) = 0$。因此，\n$$\n\\phi^{\\dagger}(T) = P(T \\to T)\\,\\phi^{\\dagger}(T) + P(T \\to D).\n$$\n求解 $\\phi^{\\dagger}(T)$ 可得\n$$\n\\phi^{\\dagger}(T) = \\frac{P(T \\to D)}{1 - P(T \\to T)}.\n$$\n- 对于 $F$，由于没有直接的 $F \\to D$ 转移且 $X$ 是非计数态，平衡方程为\n$$\n\\phi^{\\dagger}(F) = P(F \\to F)\\,\\phi^{\\dagger}(F) + P(F \\to T)\\,\\phi^{\\dagger}(T) + P(F \\to X)\\,\\phi^{\\dagger}(X).\n$$\n使用 $\\phi^{\\dagger}(X) = 0$，我们得到\n$$\n\\phi^{\\dagger}(F) = P(F \\to F)\\,\\phi^{\\dagger}(F) + P(F \\to T)\\,\\phi^{\\dagger}(T),\n$$\n因此\n$$\n\\phi^{\\dagger}(F) = \\frac{P(F \\to T)\\,\\phi^{\\dagger}(T)}{1 - P(F \\to F)}.\n$$\n\n代入给定的概率，\n$$\nP(T \\to T) = 0.5,\\quad P(T \\to D) = 0.4,\\quad P(T \\to X) = 0.1,\n$$\n我们发现\n$$\n\\phi^{\\dagger}(T) = \\frac{0.4}{1 - 0.5} = \\frac{0.4}{0.5} = 0.8.\n$$\n接下来，\n$$\nP(F \\to F) = 0.6,\\quad P(F \\to T) = 0.3,\\quad P(F \\to X) = 0.1,\n$$\n所以\n$$\n\\phi^{\\dagger}(F) = \\frac{0.3 \\times 0.8}{1 - 0.6} = \\frac{0.24}{0.4} = 0.6.\n$$\n\n我们现在根据模拟概率和伴随值推导从 $F$ 到 $T$ 的零方差偏倚转移概率。考虑通过使用偏倚概率 $p^{*}(i \\to j)$ 而不是模拟概率 $P(i \\to j)$ 来偏倚从瞬态 $i$ 到后继态 $j$ 的转移。在使用非模拟抽样的重要性抽样中，粒子在进行转移 $i \\to j$ 后的权重通过模拟分布相对于偏倚分布的 Radon–Nikodym 导数进行更新：\n$$\nw' = w \\,\\frac{P(i \\to j)}{p^{*}(i \\to j)}.\n$$\n零方差原理要求，在任何抽样转移之后，更新后的权重与下游期望贡献的乘积对于从当前状态出发的所有可能结果都是同一个常数。具体来说，对于一个瞬态前驱态 $i$，我们要求\n$$\nw \\,\\frac{P(i \\to j)}{p^{*}(i \\to j)}\\,\\phi^{\\dagger}(j) = \\text{关于 } j \\text{ 的常数},\n$$\n这样，在一步之后，每条路径对估计量的贡献都相同。两边同除以 $w$ 并强制归一化 $\\sum_{j} p^{*}(i \\to j) = 1$ 可得\n$$\np^{*}(i \\to j) \\propto P(i \\to j)\\,\\phi^{\\dagger}(j),\n$$\n或者明确地写为，\n$$\np^{*}(i \\to j) = \\frac{P(i \\to j)\\,\\phi^{\\dagger}(j)}{\\sum_{k} P(i \\to k)\\,\\phi^{\\dagger}(k)}.\n$$\n请注意，$\\phi^{\\dagger}(k) = 0$ 的终止态对分母没有贡献，并且在零方差方案下永远不会被抽样。\n\n将此应用于 $i = F$ 和 $j = T$，其中唯一有贡献的后继态是 $F$ 和 $T$（因为 $P(F \\to D) = 0$ 且 $\\phi^{\\dagger}(X) = 0$），\n$$\np^{*}(F \\to T) = \\frac{P(F \\to T)\\,\\phi^{\\dagger}(T)}{P(F \\to F)\\,\\phi^{\\dagger}(F) + P(F \\to T)\\,\\phi^{\\dagger}(T)}.\n$$\n代入计算出的伴随值，\n$$\np^{*}(F \\to T) = \\frac{0.3 \\times 0.8}{0.6 \\times 0.6 + 0.3 \\times 0.8} = \\frac{0.24}{0.36 + 0.24} = \\frac{0.24}{0.60} = 0.4.\n$$\n\n因此，根据零方差原理，该系统从 $F$ 到 $T$ 的最优偏倚转移概率为 $0.4$。",
            "answer": "$$\\boxed{0.4}$$"
        },
        {
            "introduction": "在掌握了伴随重要性的理论基础和零方差的理想目标之后，我们转向一个在实际屏蔽计算中广泛应用的先进方法：一致性伴随驱动重要性抽样（CADIS）。CADIS方法通过一个确定性计算得到的伴随解来生成一个“重要性图”，并利用此图来偏倚源粒子抽样和粒子输运过程，从而在复杂问题中高效地降低方差。此练习将指导您完成CADIS方法中关键的第一步：源偏倚。通过为一个具体的一维泄漏问题推导伴随重要性函数，并用它来构建偏倚后的源概率密度函数（PDF），您将学习到如何将抽象的伴随理论转化为一种强大而实用的模拟策略。",
            "id": "4246226",
            "problem": "考虑一个厚度为 $a$ 的单能、单向、纯吸收平板，用于进行蒙特卡洛（MC）中子输运计算。中子只沿 $+x$ 方向运动；位于 $x=0$ 的左边界有一个外部体积源，位于 $x=a$ 的右边界是一个真空出口。总宏观截面在空间上是均匀的，等于 $\\Sigma_{t}$。物理源密度为 $S(x)=S_{0}\\exp(-\\beta x)$，其中 $0\\le x\\le a$，$S_{0}>0$ 且 $\\beta\\ge 0$。关注的响应是右边界 $x=a$ 处的泄漏流。在一致性伴随驱动重要性抽样（CADIS）方法中，重要性抽样由伴随输运问题的解驱动，并用于构建一个偏倚源概率密度函数（PDF），以便对起始位置进行抽样。\n\n从正向单能、单向、纯吸收输运算子的定义和伴随恒等式出发，推导适用于 $x=a$ 处泄漏响应的伴随重要性函数 $\\phi^{\\dagger}(x)$。利用此伴随重要性，推导在 $x\\in[0,a]$ 上的 CADIS 偏倚源概率密度函数 $p_{b}(x)$。\n\n然后，对于具体参数值 $a=10\\,\\mathrm{cm}$，$\\Sigma_{t}=0.2\\,\\mathrm{cm}^{-1}$，$\\beta=0.05\\,\\mathrm{cm}^{-1}$ 和 $x_{0}=4\\,\\mathrm{cm}$，计算 $p_{b}(x_{0})$ 的值。将您的答案四舍五入到四位有效数字，并以 $\\mathrm{cm}^{-1}$ 为单位表示您的最终结果。最终答案必须是一个单个实数。",
            "solution": "该问题要求针对一个简化的中子输运问题，推导伴随重要性函数和一致性伴随驱动重要性抽样（CADIS）偏倚源概率密度函数（PDF），然后进行数值计算。\n\n物理系统是一个厚度为 $a$ 的一维平板，其纯吸收介质的特征是总宏观截面为 $\\Sigma_t$。中子是单能的，且只沿 $x$ 正方向运动。在 $x \\in [0, a]$ 范围内存在一个外部体积源 $S(x) = S_0 \\exp(-\\beta x)$。\n\n正向输运问题由关于中子注量率 $\\phi(x)$ 的一阶常微分方程描述：\n$$ \\frac{d\\phi(x)}{dx} + \\Sigma_t \\phi(x) = S(x) $$\n边界条件为左边界无入射注量率，这意味着 $\\phi(0) = 0$。用算子形式表示为 $L\\phi = S$，其中正向算子为 $L = \\frac{d}{dx} + \\Sigma_t$。\n\n关注的响应 $R$ 是右边界 $x=a$ 处的泄漏流。在这种单向情况下，流等于注量率，因此 $R = \\phi(a)$。这是一个表面响应。\n\n为了求得伴随重要性函数 $\\phi^{\\dagger}(x)$，我们首先建立伴随问题。伴随算子 $L^{\\dagger}$ 是从恒等式 $\\langle \\phi^{\\dagger}, L\\phi \\rangle = \\langle L^{\\dagger}\\phi^{\\dagger}, \\phi \\rangle + \\text{边界项}$ 形式上推导出来的。对于算子 $L = \\frac{d}{dx} + \\Sigma_t$，伴随算子是 $L^{\\dagger} = -\\frac{d}{dx} + \\Sigma_t$。\n\n伴随源 $S^{\\dagger}$ 由响应函数确定。对于表面响应 $R = \\phi(a)$，伴随问题由域内的一个齐次微分方程和一个非齐次边界条件组成。伴随方程为：\n$$ L^{\\dagger}\\phi^{\\dagger}(x) = 0 \\implies -\\frac{d\\phi^{\\dagger}(x)}{dx} + \\Sigma_t \\phi^{\\dagger}(x) = 0 \\quad \\text{对于 } x \\in [0, a) $$\n在 $x=a$ 处的伴随边界条件源于 $\\phi(a) = \\int_0^a S(x)\\phi^{\\dagger}(x)dx$ 这一要求。对于 $x=a$ 处的表面响应，一个粒子在该表面的重要性为1。形式上，这给出了边界条件 $\\phi^{\\dagger}(a) = 1$。因此，伴随问题由上述常微分方程和条件 $\\phi^{\\dagger}(a)=1$ 定义。\n\n求解伴随微分方程：\n$$ \\frac{d\\phi^{\\dagger}}{\\phi^{\\dagger}} = \\Sigma_t dx $$\n积分得到 $\\ln(\\phi^{\\dagger}(x)) = \\Sigma_t x + C'$，或 $\\phi^{\\dagger}(x) = C \\exp(\\Sigma_t x)$，其中 $C$ 是某个常数。\n在 $x=a$ 处应用边界条件：\n$$ \\phi^{\\dagger}(a) = C \\exp(\\Sigma_t a) = 1 $$\n这给出常数 $C = \\exp(-\\Sigma_t a)$。\n将 $C$ 代回，得到伴随重要性函数为：\n$$ \\phi^{\\dagger}(x) = \\exp(-\\Sigma_t a) \\exp(\\Sigma_t x) = \\exp(-\\Sigma_t(a-x)) $$\n这个函数表示一个从中子位置 $x$ 出发的中子，在不被吸收的情况下到达边界 $x=a$ 的概率。\n\n接下来，我们推导 CADIS 偏倚源概率密度函数 $p_b(x)$。构建此 PDF 是为了从一个与物理源密度 $S(x)$ 和伴随重要性函数 $\\phi^{\\dagger}(x)$ 的乘积成正比的分布中抽样源粒子。\n$$ p_b(x) = \\frac{S(x) \\phi^{\\dagger}(x)}{\\int_0^a S(x') \\phi^{\\dagger}(x') dx'} $$\n分子中的项是：\n$$ S(x) \\phi^{\\dagger}(x) = \\left(S_0 \\exp(-\\beta x)\\right) \\left(\\exp(-\\Sigma_t(a-x))\\right) = S_0 \\exp(-\\Sigma_t a) \\exp((\\Sigma_t - \\beta)x) $$\n分母是归一化积分 $N$：\n$$ N = \\int_0^a S_0 \\exp(-\\Sigma_t a) \\exp((\\Sigma_t - \\beta)x') dx' = S_0 \\exp(-\\Sigma_t a) \\int_0^a \\exp((\\Sigma_t - \\beta)x') dx' $$\n令 $k = \\Sigma_t - \\beta$。该积分取决于 $k$ 是否为0。问题参数给出 $\\Sigma_t = 0.2\\,\\mathrm{cm}^{-1}$ 和 $\\beta = 0.05\\,\\mathrm{cm}^{-1}$，因此 $k \\neq 0$。\n$$ \\int_0^a \\exp(kx') dx' = \\left[ \\frac{\\exp(kx')}{k} \\right]_0^a = \\frac{\\exp(ka) - \\exp(0)}{k} = \\frac{\\exp(ka) - 1}{k} $$\n因此，归一化常数为 $N = S_0 \\exp(-\\Sigma_t a) \\frac{\\exp(ka) - 1}{k}$。\n偏倚源概率密度函数 $p_b(x)$ 为：\n$$ p_b(x) = \\frac{S_0 \\exp(-\\Sigma_t a) \\exp(kx)}{S_0 \\exp(-\\Sigma_t a) \\frac{\\exp(ka) - 1}{k}} = \\frac{k \\exp(kx)}{\\exp(ka) - 1} $$\n代入 $k = \\Sigma_t - \\beta$，偏倚源概率密度函数的最终解析表达式为：\n$$ p_b(x) = \\frac{(\\Sigma_t - \\beta) \\exp((\\Sigma_t - \\beta)x)}{\\exp((\\Sigma_t - \\beta)a) - 1} $$\n此表达式对于 $x \\in [0, a]$ 有效。\n\n最后，我们使用给定的参数值计算 $p_b(x_0)$：$a=10\\,\\mathrm{cm}$，$\\Sigma_t = 0.2\\,\\mathrm{cm}^{-1}$，$\\beta = 0.05\\,\\mathrm{cm}^{-1}$，以及 $x_0 = 4\\,\\mathrm{cm}$。\n首先，计算常数 $k$：\n$$ k = \\Sigma_t - \\beta = 0.2\\,\\mathrm{cm}^{-1} - 0.05\\,\\mathrm{cm}^{-1} = 0.15\\,\\mathrm{cm}^{-1} $$\n接下来，计算指数函数的无量纲参数：\n$$ kx_0 = (0.15\\,\\mathrm{cm}^{-1})(4\\,\\mathrm{cm}) = 0.6 $$\n$$ ka = (0.15\\,\\mathrm{cm}^{-1})(10\\,\\mathrm{cm}) = 1.5 $$\n现在，将这些值代入 $p_b(x_0)$ 的表达式中：\n$$ p_b(x_0=4) = \\frac{0.15 \\times \\exp(0.6)}{\\exp(1.5) - 1} $$\n使用指数函数的数值：\n$$ \\exp(0.6) \\approx 1.8221188 $$\n$$ \\exp(1.5) \\approx 4.4816891 $$\n$$ p_b(4) = \\frac{0.15 \\times 1.8221188}{4.4816891 - 1} = \\frac{0.27331782}{3.4816891} \\approx 0.0784998\\,\\mathrm{cm}^{-1} $$\n按要求将结果四舍五入到四位有效数字，得到 $0.07850\\,\\mathrm{cm}^{-1}$。",
            "answer": "$$\\boxed{0.07850}$$"
        }
    ]
}