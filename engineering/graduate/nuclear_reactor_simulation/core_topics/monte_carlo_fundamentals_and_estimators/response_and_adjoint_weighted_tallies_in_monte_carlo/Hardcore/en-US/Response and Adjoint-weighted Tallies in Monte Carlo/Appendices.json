{
    "hands_on_practices": [
        {
            "introduction": "To effectively use adjoint functions in Monte Carlo simulations, we must first understand their physical meaning. This practice explores the fundamental reciprocity theorem, which establishes a profound connection between a particle source and a detector's response through the adjoint flux, or \"importance\" function. By deriving this relationship from the Boltzmann Transport Equation for a simplified system, you will see how it provides the theoretical justification for the ubiquitous next-event point detector estimator .",
            "id": "4246260",
            "problem": "Consider a stationary, monoenergetic neutron field in an infinite, homogeneous medium with no scattering and constant macroscopic total cross section $\\Sigma_{t}$ at energy $E_{0}$. A point, isotropic source of neutrons with strength $S$ (in neutrons per second) is located at position $\\mathbf{r}_{s}$. A point detector is located at position $\\mathbf{r}_{d}$ and its response functional is defined as the scalar flux at the detector position integrated over directions at energy $E_{0}$. The forward transport is governed by the Boltzmann Transport Equation (BTE), and the corresponding adjoint transport equation defines the importance function for adjoint-weighted tallies.\n\nStarting from the stationary, monoenergetic Boltzmann Transport Equation and the definition of the adjoint problem, derive from first principles the reciprocity relation that connects the forward source $q$ to the detector response via the adjoint flux $\\psi^{\\dagger}$, and show how the resulting reciprocity implies the form of the next-event (point detector) estimator in a Monte Carlo simulation. Use your derivation to obtain the closed-form expression for the detector response in this scattering-free medium and evaluate it for the following physically consistent parameters:\n- $\\Sigma_{t} = 0.18 \\ \\text{cm}^{-1}$,\n- $S = 2.0 \\times 10^{7} \\ \\text{s}^{-1}$,\n- $\\mathbf{r}_{s} = (0,0,0) \\ \\text{cm}$,\n- $\\mathbf{r}_{d} = (25.0,0,0) \\ \\text{cm}$.\n\nExpress the final detector response as a scalar flux at $\\mathbf{r}_{d}$ in $\\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}$ and round your answer to four significant figures. The final answer must be a single real number.",
            "solution": "The user wants me to solve a problem in nuclear transport theory.\n\n### Step 1: Extract Givens\n\n-   **Physical System**: Stationary, monoenergetic neutron field in an infinite, homogeneous medium.\n-   **Interactions**: No scattering.\n-   **Cross Section**: Constant macroscopic total cross section $\\Sigma_{t}$ at energy $E_{0}$.\n-   **Source**: Point, isotropic neutron source with strength $S$ (neutrons per second) located at $\\mathbf{r}_{s}$. The source term is $q(\\mathbf{r}, \\Omega) = \\frac{S}{4\\pi}\\delta(\\mathbf{r}-\\mathbf{r}_s)$.\n-   **Detector**: Point detector at position $\\mathbf{r}_{d}$.\n-   **Detector Response**: The scalar flux at the detector position, $R = \\phi(\\mathbf{r}_d) = \\int_{4\\pi} \\psi(\\mathbf{r}_d, \\Omega) d\\Omega$.\n-   **Governing Equations**: Forward and adjoint Boltzmann Transport Equations (BTE).\n-   **Parameters**:\n    -   $\\Sigma_{t} = 0.18 \\ \\text{cm}^{-1}$\n    -   $S = 2.0 \\times 10^{7} \\ \\text{s}^{-1}$\n    -   $\\mathbf{r}_{s} = (0,0,0) \\ \\text{cm}$\n    -   $\\mathbf{r}_{d} = (25.0,0,0) \\ \\text{cm}$\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem is based on the fundamental principles of neutron transport theory, specifically the Boltzmann Transport Equation and the concept of adjoint functions. The physical scenario (point source in an infinite, non-scattering medium) is a standard, idealized case used in textbooks to derive fundamental results like point-kernel solutions. The problem is scientifically sound.\n-   **Well-Posed**: The problem is well-posed. It asks for a derivation of a fundamental relationship (reciprocity), its connection to a computational method (next-event estimator), and the calculation of a physical quantity (flux) for a clearly defined system. The provided parameters are sufficient and consistent for a unique solution.\n-   **Objective**: The problem is stated in precise, objective language common to physics and engineering. It is free of ambiguity, subjectivity, or opinion.\n-   **Other Checks**: The problem is complete, with no missing or contradictory information. The parameters are physically realistic and dimensionally consistent.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. I will proceed with the solution.\n\n### Derivation and Solution\n\nThe problem requires a three-part solution: deriving the reciprocity relation, connecting it to the next-event estimator, and calculating the detector response.\n\n**Part 1: The Reciprocity Relation**\n\nThe stationary, monoenergetic BTE for the angular neutron flux $\\psi(\\mathbf{r}, \\Omega)$ in a non-scattering medium is:\n$$\n\\Omega \\cdot \\nabla \\psi(\\mathbf{r}, \\Omega) + \\Sigma_t \\psi(\\mathbf{r}, \\Omega) = q(\\mathbf{r}, \\Omega)\n$$\nWe can write this in operator form as $L\\psi = q$, where the transport operator $L$ is defined as:\n$$\nL \\equiv \\Omega \\cdot \\nabla + \\Sigma_t\n$$\nThe source term $q$ for a point isotropic source of strength $S$ at $\\mathbf{r}_s$ is:\n$$\nq(\\mathbf{r}, \\Omega) = \\frac{S}{4\\pi} \\delta(\\mathbf{r} - \\mathbf{r}_s)\n$$\nThe detector response $R$ is the scalar flux at the detector position $\\mathbf{r}_d$:\n$$\nR = \\phi(\\mathbf{r}_d) = \\int_{4\\pi} \\psi(\\mathbf{r}_d, \\Omega) d\\Omega\n$$\nTo formalize this, we introduce an inner product over the phase space $(\\mathbf{r}, \\Omega)$:\n$$\n\\langle f, g \\rangle \\equiv \\int dV \\int_{4\\pi} d\\Omega \\, f(\\mathbf{r}, \\Omega) g(\\mathbf{r}, \\Omega)\n$$\nUsing this notation, the response $R$ can be written as:\n$$\nR = \\int dV \\int_{4\\pi} d\\Omega \\, \\psi(\\mathbf{r}, \\Omega) \\delta(\\mathbf{r} - \\mathbf{r}_d) = \\langle \\psi, q^\\dagger \\rangle\n$$\nwhere we have defined the adjoint source (or response function) as $q^\\dagger(\\mathbf{r}, \\Omega) = \\delta(\\mathbf{r} - \\mathbf{r}_d)$. This represents a detector that is isotropic in its angular sensitivity.\n\nThe adjoint transport equation is defined as $L^\\dagger \\psi^\\dagger = q^\\dagger$, where $L^\\dagger$ is the adjoint operator to $L$ and $\\psi^\\dagger$ is the adjoint flux or importance function. The adjoint operator is defined by the relation $\\langle \\psi^\\dagger, L\\psi \\rangle = \\langle L^\\dagger\\psi^\\dagger, \\psi \\rangle$. Let's find $L^\\dagger$:\n$$\n\\langle \\psi^\\dagger, L\\psi \\rangle = \\int dV \\int_{4\\pi} d\\Omega \\, \\psi^\\dagger (\\Omega \\cdot \\nabla \\psi + \\Sigma_t \\psi)\n$$\n$$\n\\langle \\psi^\\dagger, L\\psi \\rangle = \\int dV \\int_{4\\pi} d\\Omega \\, (\\psi^\\dagger \\Sigma_t \\psi) + \\int_{4\\pi} d\\Omega \\int dV \\, \\psi^\\dagger (\\Omega \\cdot \\nabla \\psi)\n$$\nUsing the identity $\\nabla \\cdot (\\psi^\\dagger \\psi \\Omega) = (\\Omega \\cdot \\nabla \\psi^\\dagger)\\psi + \\psi^\\dagger(\\Omega \\cdot \\nabla \\psi)$, the spatial integral becomes:\n$$\n\\int_V dV \\, \\psi^\\dagger (\\Omega \\cdot \\nabla \\psi) = \\int_V dV \\, [\\nabla \\cdot (\\psi^\\dagger \\psi \\Omega) - (\\Omega \\cdot \\nabla \\psi^\\dagger)\\psi]\n$$\nBy Gauss's theorem, $\\int_V dV \\, \\nabla \\cdot (\\mathbf{F}) = \\oint_A d\\mathbf{A} \\cdot \\mathbf{F}$. For an infinite medium, the flux $\\psi$ must vanish at infinity, so the surface integral is zero. Thus:\n$$\n\\int_V dV \\, \\psi^\\dagger (\\Omega \\cdot \\nabla \\psi) = \\int_V dV \\, [-(\\Omega \\cdot \\nabla \\psi^\\dagger)\\psi]\n$$\nSubstituting this back into the inner product expression:\n$$\n\\langle \\psi^\\dagger, L\\psi \\rangle = \\int dV \\int_{4\\pi} d\\Omega \\, [ -(\\Omega \\cdot \\nabla \\psi^\\dagger)\\psi + (\\Sigma_t \\psi^\\dagger)\\psi ] = \\langle (-\\Omega \\cdot \\nabla + \\Sigma_t)\\psi^\\dagger, \\psi \\rangle\n$$\nTherefore, the adjoint operator is $L^\\dagger = -\\Omega \\cdot \\nabla + \\Sigma_t$. The adjoint BTE is:\n$$\nL^\\dagger \\psi^\\dagger(\\mathbf{r}, \\Omega) = -\\Omega \\cdot \\nabla \\psi^\\dagger(\\mathbf{r}, \\Omega) + \\Sigma_t \\psi^\\dagger(\\mathbf{r}, \\Omega) = q^\\dagger(\\mathbf{r}, \\Omega)\n$$\nNow we derive the reciprocity relation. We start with the BTE and its adjoint form:\n1. $L\\psi = q \\implies \\langle\\psi^\\dagger, L\\psi\\rangle = \\langle\\psi^\\dagger, q\\rangle$\n2. $L^\\dagger\\psi^\\dagger = q^\\dagger \\implies \\langle L^\\dagger\\psi^\\dagger, \\psi\\rangle = \\langle q^\\dagger, \\psi\\rangle$\n\nSince $\\langle\\psi^\\dagger, L\\psi\\rangle = \\langle L^\\dagger\\psi^\\dagger, \\psi\\rangle$ by definition of the adjoint operator, we must have:\n$$\n\\langle \\psi^\\dagger, q \\rangle = \\langle q^\\dagger, \\psi \\rangle\n$$\nThis is the general form of the reciprocity relation. It states that the response of the detector defined by $q^\\dagger$ to the source $q$ is equal to the response of a detector defined by $q$ to a source $q^\\dagger$. For our specific problem, this becomes:\n$$\nR = \\langle q^\\dagger, \\psi \\rangle = \\langle \\psi^\\dagger, q \\rangle = \\int dV \\int_{4\\pi} d\\Omega \\, \\psi^\\dagger(\\mathbf{r}, \\Omega) \\left( \\frac{S}{4\\pi}\\delta(\\mathbf{r} - \\mathbf{r}_s) \\right) = \\frac{S}{4\\pi} \\int_{4\\pi} \\psi^\\dagger(\\mathbf{r}_s, \\Omega) d\\Omega\n$$\nDefining the adjoint scalar flux as $\\phi^\\dagger(\\mathbf{r}) = \\int_{4\\pi} \\psi^\\dagger(\\mathbf{r}, \\Omega) d\\Omega$, the reciprocity relation connects the detector response to the adjoint scalar flux at the source location:\n$$\nR = \\phi(\\mathbf{r}_d) = \\frac{S}{4\\pi} \\phi^\\dagger(\\mathbf{r}_s)\n$$\n\n**Part 2: Connection to the Next-Event Estimator**\n\nThe reciprocity relation $R = \\langle \\psi^\\dagger, q \\rangle = \\int q(\\mathbf{r}, \\Omega) \\psi^\\dagger(\\mathbf{r}, \\Omega) dV d\\Omega$ expresses the total detector response as an integral of the source density $q$ weighted by the importance function $\\psi^\\dagger$.\n\nIn a Monte Carlo simulation, we do not solve this integral analytically. Instead, we sample particles from the source distribution $q(\\mathbf{r}, \\Omega)$. Each sampled source particle, born at $(\\mathbf{r}_i, \\Omega_i)$ with weight $w_i$, represents a statistical sample of the source density.\n\nThe quantity $\\psi^\\dagger(\\mathbf{r}_i, \\Omega_i)$ represents the expected contribution to the detector response from a single particle starting at phase space point $(\\mathbf{r}_i, \\Omega_i)$. For a point detector, this is the probability that the particle travels from $\\mathbf{r}_i$ to the detector at $\\mathbf{r}_d$ without collision, multiplied by a geometric factor to account for the solid angle subtended by a unit area detector. This is precisely the uncollided flux.\n\nThe next-event estimator is a Monte Carlo technique that directly scores this contribution at each event (source emission or collision). For a source particle born at $\\mathbf{r}_s$, the next-event estimator scores a contribution to the point detector at $\\mathbf{r}_d$ equal to:\n$$\n\\text{Score} = w_s \\times P(\\mathbf{r}_s \\to \\mathbf{r}_d) \\times G(\\mathbf{r}_s, \\mathbf{r}_d)\n$$\nwhere $w_s$ is the particle weight, $P(\\mathbf{r}_s \\to \\mathbf{r}_d) = \\exp(-\\Sigma_t |\\mathbf{r}_d - \\mathbf{r}_s|)$ is the non-collision probability, and $G(\\mathbf{r}_s, \\mathbf{r}_d) = \\frac{1}{4\\pi|\\mathbf{r}_d - \\mathbf{r}_s|^2}$ is the geometric attenuation factor. The total term is the uncollided flux from $\\mathbf{r}_s$ to $\\mathbf{r}_d$, which is the importance $\\phi^\\dagger(\\mathbf{r}_s) / (4\\pi)$. The total response from the source is thus $S \\times \\text{Score} / w_s$.\n\nThe reciprocity relation provides the formal theoretical basis for this method: by summing the importance-weighted contributions from all source events, we are statistically evaluating the integral $\\langle \\psi^\\dagger, q \\rangle$ to obtain the correct total response $R$. The form of the next-event point detector estimator is thus a direct implementation of scoring the importance function $\\psi^\\dagger$ at each event, justified by the reciprocity theorem.\n\n**Part 3: Closed-Form Expression and Calculation**\n\nWe need to find the detector response $R = \\phi(\\mathbf{r}_d)$. We can solve this directly by considering the forward problem. The physical situation is a point isotropic source of strength $S$ in an infinite, purely absorbing medium. The scalar flux at a distance $d$ from such a source is given by the point-kernel (or Green's function) solution to the transport equation:\n$$\n\\phi(d) = \\frac{S \\exp(-\\Sigma_t d)}{4\\pi d^2}\n$$\nThe distance $d$ between the source and detector is:\n$$\nd = |\\mathbf{r}_d - \\mathbf{r}_s| = \\sqrt{(25.0 - 0)^2 + (0 - 0)^2 + (0 - 0)^2} = 25.0 \\ \\text{cm}\n$$\nThe detector response is the scalar flux at this distance:\n$$\nR = \\phi(\\mathbf{r}_d) = \\frac{S \\exp(-\\Sigma_t |\\mathbf{r}_d - \\mathbf{r}_s|)}{4\\pi |\\mathbf{r}_d - \\mathbf{r}_s|^2}\n$$\nSubstituting the given numerical values:\n$$\nR = \\frac{(2.0 \\times 10^7 \\ \\text{s}^{-1}) \\exp(-(0.18 \\ \\text{cm}^{-1})(25.0 \\ \\text{cm}))}{4\\pi (25.0 \\ \\text{cm})^2}\n$$\nFirst, calculate the argument of the exponential:\n$$\n\\Sigma_t d = (0.18)(25.0) = 4.5\n$$\nNow substitute this back into the expression for $R$:\n$$\nR = \\frac{2.0 \\times 10^7}{4\\pi (625)} \\exp(-4.5) \\ \\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}\n$$\n$$\nR = \\frac{2.0 \\times 10^7}{2500\\pi} \\exp(-4.5) \\ \\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}\n$$\n$$\nR = \\frac{8000}{\\pi} \\exp(-4.5) \\ \\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}\n$$\nNow, we evaluate this numerically:\n$$\nR \\approx \\frac{8000}{3.14159265...} \\times 0.01110901...\n$$\n$$\nR \\approx (2546.479...) \\times (0.01110901...) \\approx 28.28800 \\ \\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}\n$$\nRounding to four significant figures as requested, the detector response is $28.29 \\ \\text{n} \\cdot \\text{cm}^{-2} \\cdot \\text{s}^{-1}$.\n(Note: Using the reciprocity relation $R = \\frac{S}{4\\pi}\\phi^\\dagger(\\mathbf{r}_s)$ would yield the identical result, as the solution to the adjoint problem for $\\phi^\\dagger(\\mathbf{r})$ is $\\phi^\\dagger(\\mathbf{r}) = \\frac{\\exp(-\\Sigma_t |\\mathbf{r} - \\mathbf{r}_d|)}{|\\mathbf{r} - \\mathbf{r}_d|^2}$, which gives $R = \\frac{S}{4\\pi} \\frac{\\exp(-\\Sigma_t |\\mathbf{r}_s-\\mathbf{r}_d|)}{|\\mathbf{r}_s-\\mathbf{r}_d|^2}$.)",
            "answer": "$$\\boxed{28.29}$$"
        },
        {
            "introduction": "Once we understand that the adjoint function quantifies importance, the next step is to use it to make simulations more efficient. This exercise guides you through the core logic of the Consistent Adjoint-Driven Importance Sampling (CADIS) method, a powerful variance reduction technique used in shielding applications. You will derive a biased source sampling distribution for a simplified 1D problem, providing a concrete example of how importance maps are used to \"guide\" particles toward a detector and improve calculational efficiency .",
            "id": "4246226",
            "problem": "A one-speed, mono-directional, purely absorbing slab of thickness $a$ is considered for a Monte Carlo (MC) neutron transport calculation. Neutrons travel only in the $+x$ direction; the left boundary at $x=0$ admits an external volumetric source, and the right boundary at $x=a$ is a vacuum exit. The total macroscopic cross section is spatially uniform and equal to $\\Sigma_{t}$. The physical source density is $S(x)=S_{0}\\exp(-\\beta x)$ for $0\\le x\\le a$, with $S_{0}>0$ and $\\beta\\ge 0$. The response of interest is the leakage current at the right boundary $x=a$. In the Consistent Adjoint-Driven Importance Sampling (CADIS) method, importance sampling is driven by the solution of the adjoint transport problem and used to construct a biased source Probability Density Function (PDF) for sampling starting locations.\n\nStarting from the forward one-speed, mono-directional, pure absorption transport operator definition and the adjoint identity, derive the adjoint importance function $\\phi^{\\dagger}(x)$ appropriate for the leakage response at $x=a$. Using this adjoint importance, derive the CADIS biased source PDF $p_{b}(x)$ over $x\\in[0,a]$.\n\nThen, for the specific parameter values $a=10\\,\\mathrm{cm}$, $\\Sigma_{t}=0.2\\,\\mathrm{cm}^{-1}$, $\\beta=0.05\\,\\mathrm{cm}^{-1}$, and $x_{0}=4\\,\\mathrm{cm}$, evaluate $p_{b}(x_{0})$. Round your answer to four significant figures and express your final result in $\\mathrm{cm}^{-1}$. The final answer must be a single real number.",
            "solution": "The problem requires the derivation of the adjoint importance function and the Consistent Adjoint-Driven Importance Sampling (CADIS) biased source Probability Density Function (PDF) for a simplified neutron transport problem, followed by a numerical evaluation.\n\nThe physical system is a one-dimensional slab of thickness $a$ with a purely absorbing medium characterized by a total macroscopic cross section $\\Sigma_t$. Neutrons are mono-energetic and travel only in the positive $x$ direction. An external volumetric source $S(x) = S_0 \\exp(-\\beta x)$ exists for $x \\in [0, a]$.\n\nThe forward transport problem is described by the first-order ordinary differential equation for the neutron flux $\\phi(x)$:\n$$ \\frac{d\\phi(x)}{dx} + \\Sigma_t \\phi(x) = S(x) $$\nThe boundary condition is no incoming flux at the left boundary, which implies $\\phi(0) = 0$. In operator form, this is $L\\phi = S$, where the forward operator is $L = \\frac{d}{dx} + \\Sigma_t$.\n\nThe response of interest, $R$, is the leakage current at the right boundary, $x=a$. In this mono-directional case, the current is equal to the flux, so $R = \\phi(a)$. This is a surface response.\n\nTo find the adjoint importance function $\\phi^{\\dagger}(x)$, we first establish the adjoint problem. The adjoint operator $L^{\\dagger}$ is formally derived from the identity $\\langle \\phi^{\\dagger}, L\\phi \\rangle = \\langle L^{\\dagger}\\phi^{\\dagger}, \\phi \\rangle + \\text{boundary terms}$. For the operator $L = \\frac{d}{dx} + \\Sigma_t$, the adjoint operator is $L^{\\dagger} = -\\frac{d}{dx} + \\Sigma_t$.\n\nThe adjoint source $S^{\\dagger}$ is determined by the response function. For a surface response $R = \\phi(a)$, the adjoint problem consists of a homogeneous differential equation within the domain and an inhomogeneous boundary condition. The adjoint equation is:\n$$ L^{\\dagger}\\phi^{\\dagger}(x) = 0 \\implies -\\frac{d\\phi^{\\dagger}(x)}{dx} + \\Sigma_t \\phi^{\\dagger}(x) = 0 \\quad \\text{for } x \\in [0, a) $$\nThe adjoint boundary condition at $x=a$ is derived from the requirement that $\\phi(a) = \\int_0^a S(x)\\phi^{\\dagger}(x)dx$. For a surface response at $x=a$, the importance of a particle at that surface is unity. Formally, this gives the boundary condition $\\phi^{\\dagger}(a) = 1$. The adjoint problem is thus defined by the ODE above and the condition $\\phi^{\\dagger}(a)=1$.\n\nSolving the adjoint differential equation:\n$$ \\frac{d\\phi^{\\dagger}}{\\phi^{\\dagger}} = \\Sigma_t dx $$\nIntegrating yields $\\ln(\\phi^{\\dagger}(x)) = \\Sigma_t x + C'$, or $\\phi^{\\dagger}(x) = C \\exp(\\Sigma_t x)$ for some constant $C$.\nApplying the boundary condition at $x=a$:\n$$ \\phi^{\\dagger}(a) = C \\exp(\\Sigma_t a) = 1 $$\nThis gives the constant $C = \\exp(-\\Sigma_t a)$.\nSubstituting $C$ back, the adjoint importance function is:\n$$ \\phi^{\\dagger}(x) = \\exp(-\\Sigma_t a) \\exp(\\Sigma_t x) = \\exp(-\\Sigma_t(a-x)) $$\nThis function represents the probability that a neutron starting at position $x$ will travel to the boundary at $x=a$ without being absorbed.\n\nNext, we derive the CADIS biased source PDF, $p_b(x)$. This PDF is constructed to sample source particles from a distribution proportional to the product of the physical source density $S(x)$ and the adjoint importance function $\\phi^{\\dagger}(x)$.\n$$ p_b(x) = \\frac{S(x) \\phi^{\\dagger}(x)}{\\int_0^a S(x') \\phi^{\\dagger}(x') dx'} $$\nThe term in the numerator is:\n$$ S(x) \\phi^{\\dagger}(x) = \\left(S_0 \\exp(-\\beta x)\\right) \\left(\\exp(-\\Sigma_t(a-x))\\right) = S_0 \\exp(-\\Sigma_t a) \\exp((\\Sigma_t - \\beta)x) $$\nThe denominator is the normalization integral, $N$:\n$$ N = \\int_0^a S_0 \\exp(-\\Sigma_t a) \\exp((\\Sigma_t - \\beta)x') dx' = S_0 \\exp(-\\Sigma_t a) \\int_0^a \\exp((\\Sigma_t - \\beta)x') dx' $$\nLet $k = \\Sigma_t - \\beta$. The integral depends on whether $k=0$. The problem parameters give $\\Sigma_t = 0.2\\,\\mathrm{cm}^{-1}$ and $\\beta = 0.05\\,\\mathrm{cm}^{-1}$, so $k \\neq 0$.\n$$ \\int_0^a \\exp(kx') dx' = \\left[ \\frac{\\exp(kx')}{k} \\right]_0^a = \\frac{\\exp(ka) - \\exp(0)}{k} = \\frac{\\exp(ka) - 1}{k} $$\nThus, the normalization constant is $N = S_0 \\exp(-\\Sigma_t a) \\frac{\\exp(ka) - 1}{k}$.\nThe biased source PDF $p_b(x)$ is:\n$$ p_b(x) = \\frac{S_0 \\exp(-\\Sigma_t a) \\exp(kx)}{S_0 \\exp(-\\Sigma_t a) \\frac{\\exp(ka) - 1}{k}} = \\frac{k \\exp(kx)}{\\exp(ka) - 1} $$\nSubstituting $k = \\Sigma_t - \\beta$, the final analytical expression for the biased source PDF is:\n$$ p_b(x) = \\frac{(\\Sigma_t - \\beta) \\exp((\\Sigma_t - \\beta)x)}{\\exp((\\Sigma_t - \\beta)a) - 1} $$\nThis expression is valid for $x \\in [0, a]$.\n\nFinally, we evaluate $p_b(x_0)$ for the given parameter values: $a=10\\,\\mathrm{cm}$, $\\Sigma_t = 0.2\\,\\mathrm{cm}^{-1}$, $\\beta = 0.05\\,\\mathrm{cm}^{-1}$, and $x_0 = 4\\,\\mathrm{cm}$.\nFirst, calculate the constant $k$:\n$$ k = \\Sigma_t - \\beta = 0.2\\,\\mathrm{cm}^{-1} - 0.05\\,\\mathrm{cm}^{-1} = 0.15\\,\\mathrm{cm}^{-1} $$\nNext, evaluate the dimensionless arguments of the exponential functions:\n$$ kx_0 = (0.15\\,\\mathrm{cm}^{-1})(4\\,\\mathrm{cm}) = 0.6 $$\n$$ ka = (0.15\\,\\mathrm{cm}^{-1})(10\\,\\mathrm{cm}) = 1.5 $$\nNow, substitute these values into the expression for $p_b(x_0)$:\n$$ p_b(x_0=4) = \\frac{0.15 \\times \\exp(0.6)}{\\exp(1.5) - 1} $$\nUsing numerical values for the exponential functions:\n$$ \\exp(0.6) \\approx 1.8221188 $$\n$$ \\exp(1.5) \\approx 4.4816891 $$\n$$ p_b(4) = \\frac{0.15 \\times 1.8221188}{4.4816891 - 1} = \\frac{0.27331782}{3.4816891} \\approx 0.0784998\\,\\mathrm{cm}^{-1} $$\nRounding the result to four significant figures as requested gives $0.07850\\,\\mathrm{cm}^{-1}$.",
            "answer": "$$\\boxed{0.07850}$$"
        },
        {
            "introduction": "Applying variance reduction changes the statistical behavior of a Monte Carlo simulation, and it is crucial to be able to quantify this change. This problem provides a simplified model of an adjoint-driven source biasing scheme to explore the statistical consequences of importance sampling. By deriving the variance of the estimator from first principles, you will gain insight into how these techniques reduce statistical uncertainty and lead to more precise results for a given computational effort .",
            "id": "4246189",
            "problem": "Consider a steady, monoenergetic, fixed-source neutron transport problem in a homogeneous slab partitioned into two spatial cells, $\\mathcal{C}_{1}$ and $\\mathcal{C}_{2}$, with a point detector at the right boundary. The detector response functional is the expected count per independent source history, which in transport theory can be written as the bilinear form of the forward flux and a detector response operator. In importance-based variance reduction (VR), one uses the adjoint solution to the transport equation—the adjoint importance function—to sculpt biased probability densities that preferentially sample phase-space points that are more likely to contribute to the response.\n\nAssume the following simplified, physically motivated model for an adjoint-informed source biasing scheme for Monte Carlo (MC) transport:\n- The analog source distribution is uniform over the two cells, so the analog source-stratum probabilities are $p_{1} = \\frac{1}{2}$ and $p_{2} = \\frac{1}{2}$.\n- The detector has an intrinsic efficiency $\\eta$ (the probability that an incident, tally-eligible particle produces a recorded count), with $\\eta = 0.9$.\n- Conditional on starting in $\\mathcal{C}_{i}$, the probability that a history produces a tally-eligible interaction is $s_{i}$, with $s_{1} = 0.01$ and $s_{2} = 0.04$.\n- An adjoint importance map has been computed and is approximately constant in each cell, with values $I_{1} = 0.2$ and $I_{2} = 0.8$. The VR scheme biases the source-stratum probabilities proportionally to these importances: $b_{i} \\propto I_{i}$, normalized so that $b_{1} + b_{2} = 1$. With the given $I_{i}$, this yields $b_{1} = 0.2$ and $b_{2} = 0.8$.\n- Under importance sampling, each history starting in $\\mathcal{C}_{i}$ is assigned a weight factor $w_{i} = p_{i}/b_{i}$ to preserve unbiasedness. The per-history score is defined as $Y = w_{i} \\,\\eta\\, \\delta_{i}$, where $\\delta_{i}$ is a Bernoulli random variable taking value $1$ if the tally-eligible interaction occurs (with probability $s_{i}$) and $0$ otherwise.\n\nAssume histories are independent and identically distributed under this scheme. Starting from the fundamental definitions of expectation and variance for importance sampling with weights, and treating the above as a two-stratum mixture model induced by the biased source selection, perform the following:\n\n1. Derive a closed-form expression for the per-history variance $\\operatorname{Var}(Y)$ in terms of $p_{i}$, $b_{i}$, $s_{i}$, and $\\eta$ (do not introduce any shortcuts or pre-quoted formulas; derive from first principles of conditional expectation and the law of total variance).\n2. Specialize your expression to the given numerical values and compute the theoretical 95% two-sided normal-based confidence half-width $h$ for the sample mean response when $N = 5 \\times 10^{5}$ independent histories are simulated. Use the standard normal quantile $z = 1.959964$ for the 97.5th percentile. Round your final numerical answer for $h$ to four significant figures. The response is dimensionless; report $h$ without units.\n\nYour final answer must be the single value of $h$.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of Monte Carlo particle transport and importance sampling, well-posed with sufficient and consistent data, and expressed in objective, formal language. The model, though simplified, is a standard representation of a source-biasing variance reduction scheme.\n\nThe solution proceeds in two parts as requested: first, the derivation of the per-history variance, and second, the numerical computation of the confidence half-width for the sample mean.\n\n**Part 1: Derivation of the Per-History Variance**\n\nThe problem describes a two-stratum mixture model. A history is initiated by sampling a source cell $\\mathcal{C}_{i}$ from a biased probability distribution $\\{b_{1}, b_{2}\\}$. Let $C$ be a discrete random variable representing the chosen cell, so $P(C=i) = b_{i}$ for $i \\in \\{1, 2\\}$.\n\nThe per-history score, $Y$, is a random variable whose value depends on the chosen cell $C$. The score is given by $Y = w_{C} \\eta \\delta_{C}$, where $w_{i} = p_{i}/b_{i}$ is the importance-sampling weight, $\\eta$ is the detector efficiency, and $\\delta_{i}$ is a Bernoulli random variable with success probability $s_{i}$, i.e., $P(\\delta_{i}=1) = s_{i}$ and $P(\\delta_{i}=0) = 1-s_{i}$.\n\nThe variance of the per-history score, $\\operatorname{Var}(Y)$, is defined by the fundamental formula:\n$$\n\\operatorname{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2\n$$\nWe will compute the first and second moments of $Y$ using the law of total expectation, conditioning on the sampled source cell $C$.\n\nFirst, we compute the expected score, $\\mathbb{E}[Y]$.\n$$\n\\mathbb{E}[Y] = \\sum_{i=1}^{2} \\mathbb{E}[Y | C=i] P(C=i)\n$$\nGiven that the history started in cell $\\mathcal{C}_{i}$ (i.e., $C=i$), the score is $Y_i = w_{i} \\eta \\delta_{i}$. Its conditional expectation is:\n$$\n\\mathbb{E}[Y | C=i] = \\mathbb{E}[w_{i} \\eta \\delta_{i}] = w_{i} \\eta \\mathbb{E}[\\delta_{i}]\n$$\nSince $\\delta_{i}$ is a Bernoulli random variable with parameter $s_{i}$, its expectation is $\\mathbb{E}[\\delta_{i}] = s_{i}$. Therefore:\n$$\n\\mathbb{E}[Y | C=i] = w_{i} \\eta s_{i}\n$$\nSubstituting this into the law of total expectation and using $P(C=i) = b_{i}$:\n$$\n\\mathbb{E}[Y] = \\sum_{i=1}^{2} (w_{i} \\eta s_{i}) b_{i}\n$$\nBy substituting the definition of the weight, $w_{i} = p_{i}/b_{i}$, we confirm that the estimator is unbiased, as it recovers the analog expectation:\n$$\n\\mathbb{E}[Y] = \\sum_{i=1}^{2} \\left(\\frac{p_{i}}{b_{i}} \\eta s_{i}\\right) b_{i} = \\eta \\sum_{i=1}^{2} p_{i} s_{i}\n$$\nNext, we compute the second moment of the score, $\\mathbb{E}[Y^2]$.\n$$\n\\mathbb{E}[Y^2] = \\sum_{i=1}^{2} \\mathbb{E}[Y^2 | C=i] P(C=i)\n$$\nGiven $C=i$, the squared score is $Y_i^2 = (w_{i} \\eta \\delta_{i})^2 = w_{i}^2 \\eta^2 \\delta_{i}^2$. Its conditional expectation is:\n$$\n\\mathbb{E}[Y^2 | C=i] = \\mathbb{E}[w_{i}^2 \\eta^2 \\delta_{i}^2] = w_{i}^2 \\eta^2 \\mathbb{E}[\\delta_{i}^2]\n$$\nFor a Bernoulli variable, $\\delta_{i}^2 = \\delta_{i}$, so $\\mathbb{E}[\\delta_{i}^2] = \\mathbb{E}[\\delta_{i}] = s_{i}$. Thus:\n$$\n\\mathbb{E}[Y^2 | C=i] = w_{i}^2 \\eta^2 s_{i}\n$$\nSubstituting this into the law of total expectation:\n$$\n\\mathbb{E}[Y^2] = \\sum_{i=1}^{2} (w_{i}^2 \\eta^2 s_{i}) b_{i}\n$$\nAgain using $w_{i} = p_{i}/b_{i}$:\n$$\n\\mathbb{E}[Y^2] = \\sum_{i=1}^{2} \\left(\\frac{p_{i}^2}{b_{i}^2} \\eta^2 s_{i}\\right) b_{i} = \\eta^2 \\sum_{i=1}^{2} \\frac{p_{i}^2}{b_{i}} s_{i}\n$$\nFinally, we substitute the expressions for $\\mathbb{E}[Y]$ and $\\mathbb{E}[Y^2]$ into the variance formula:\n$$\n\\operatorname{Var}(Y) = \\left( \\eta^2 \\sum_{i=1}^{2} \\frac{p_{i}^2}{b_{i}} s_{i} \\right) - \\left( \\eta \\sum_{i=1}^{2} p_{i} s_{i} \\right)^2\n$$\nFactoring out $\\eta^2$, we arrive at the desired closed-form expression for the per-history variance:\n$$\n\\operatorname{Var}(Y) = \\eta^2 \\left[ \\left( \\sum_{i=1}^{2} \\frac{p_{i}^2}{b_{i}} s_{i} \\right) - \\left( \\sum_{i=1}^{2} p_{i} s_{i} \\right)^2 \\right]\n$$\n\n**Part 2: Numerical Calculation of the Confidence Half-Width**\n\nThe sample mean score, $\\bar{Y}_N$, from $N$ independent histories is an estimator for $\\mathbb{E}[Y]$. By the Central Limit Theorem, for large $N$, $\\bar{Y}_N$ is approximately normally distributed with a variance of $\\operatorname{Var}(\\bar{Y}_N) = \\frac{\\operatorname{Var}(Y)}{N}$. The $95\\%$ two-sided confidence half-width $h$ is given by:\n$$\nh = z \\sqrt{\\operatorname{Var}(\\bar{Y}_N)} = z \\frac{\\sqrt{\\operatorname{Var}(Y)}}{\\sqrt{N}}\n$$\nwhere $z$ is the $97.5$-th percentile of the standard normal distribution.\n\nWe are given the following numerical values:\n- Analog probabilities: $p_{1} = 0.5$, $p_{2} = 0.5$\n- Biased probabilities: $b_{1} = 0.2$, $b_{2} = 0.8$\n- Conditional tally probabilities: $s_{1} = 0.01$, $s_{2} = 0.04$\n- Detector efficiency: $\\eta = 0.9$\n- Number of histories: $N = 5 \\times 10^{5}$\n- Normal quantile: $z = 1.959964$\n\nFirst, we calculate the components of the variance expression.\nThe sum for the expected value term is:\n$$\n\\sum_{i=1}^{2} p_{i} s_{i} = p_{1}s_{1} + p_{2}s_{2} = (0.5)(0.01) + (0.5)(0.04) = 0.005 + 0.02 = 0.025\n$$\nThe sum for the second moment term is:\n$$\n\\begin{align*}\n\\sum_{i=1}^{2} \\frac{p_{i}^2}{b_{i}} s_{i} &= \\frac{p_{1}^2}{b_{1}} s_{1} + \\frac{p_{2}^2}{b_{2}} s_{2} \\\\\n&= \\frac{(0.5)^2}{0.2} (0.01) + \\frac{(0.5)^2}{0.8} (0.04) \\\\\n&= \\frac{0.25}{0.2} (0.01) + \\frac{0.25}{0.8} (0.04) \\\\\n&= (1.25)(0.01) + (0.3125)(0.04) \\\\\n&= 0.0125 + 0.0125 = 0.025\n\\end{align*}\n$$\nNow, we can compute $\\operatorname{Var}(Y)$:\n$$\n\\operatorname{Var}(Y) = (0.9)^2 \\left[ 0.025 - (0.025)^2 \\right] = 0.81 [0.025 - 0.000625] = 0.81 [0.024375] = 0.01974375\n$$\nFinally, we compute the confidence half-width $h$:\n$$\nh = 1.959964 \\times \\sqrt{\\frac{0.01974375}{5 \\times 10^{5}}} = 1.959964 \\times \\sqrt{3.94875 \\times 10^{-8}}\n$$\n$$\nh \\approx 1.959964 \\times (1.98714797 \\times 10^{-4}) \\approx 3.894751 \\times 10^{-4}\n$$\nRounding this result to four significant figures gives $3.895 \\times 10^{-4}$.",
            "answer": "$$\\boxed{3.895 \\times 10^{-4}}$$"
        }
    ]
}