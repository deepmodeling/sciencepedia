{
    "hands_on_practices": [
        {
            "introduction": "在任何蒙特卡洛模拟中，一项关键任务是量化结果的统计不确定性。本练习将引导您从中心极限定理出发，完成为一个通量计数构建置信区间的基本过程。掌握这个推导过程对于正确解释模拟输出并以统计严谨性报告结果至关重要。",
            "id": "4217544",
            "problem": "考虑一个体积为 $V$ 的均匀反应堆栅元中的蒙特卡罗 (MC) 中子输运模拟，其中总宏观截面 $\\Sigma_{t}$ 在该栅元内空间上是恒定的。对于每个独立粒子历史 $i \\in \\{1,2,\\dots,N\\}$，定义单历史碰撞计数\n$$\nT_{i} \\;=\\; \\sum_{k \\in \\mathcal{C}_{i} \\cap V} \\frac{w_{ik}}{\\Sigma_{t}},\n$$\n其中 $\\mathcal{C}_{i} \\cap V$ 表示第 $i$ 个历史中发生在计数栅元内的碰撞集合，而 $w_{ik}$ 是粒子在第 $k$ 次碰撞时的统计权重。体积平均标量通量估计量为\n$$\n\\hat{\\phi} \\;=\\; \\frac{1}{N V}\\,\\sum_{i=1}^{N} T_{i} \\;=\\; \\frac{\\bar{T}}{V}, \\quad \\text{其中} \\quad \\bar{T} \\;=\\; \\frac{1}{N}\\sum_{i=1}^{N} T_{i}.\n$$\n假设各个历史是独立同分布的，碰撞估计量对于真实体积平均标量通量 $\\phi$ 是无偏的，因此有 $\\mathbb{E}[T_{i}] = V\\,\\phi$，并且单历史计数方差 $\\mathbb{V}[T_{i}]$ 是有限的。仅使用基础概率论结果和中心极限定理 (CLT)，推导样本均值 $\\bar{T}$ 的近似正态分布，然后在方差未知的情况下，求出 $\\phi$ 的 $(1-\\alpha)$ 置信区间。你的推导必须从 $\\{T_{i}\\}$ 的独立同分布性、无偏关系 $\\mathbb{E}[T_{i}] = V\\,\\phi$ 和有限方差假设出发，通过中心极限定理和适当的尺度变换论证，最终得到使用自由度为 $N-1$ 的学生 t 分布分位数的置信区间表达式。\n\n将你的最终答案表示为 $\\phi$ 的 $(1-\\alpha)$ 置信区间的下限和上限的有序对，表达式应完全由 $\\bar{T}$、$s_{T}$、$V$、$N$ 以及自由度为 $N-1$ 的学生 t 分布的上 $(1-\\alpha/2)$ 分位数构成。不要引入任何额外的符号。由于答案是通用的符号表达式而非数值，因此不需要进行舍入，最终表达式中也不应包含任何物理单位。",
            "solution": "该问题要求基于蒙特卡罗模拟，推导真实体积平均标量通量 $\\phi$ 的 $(1-\\alpha)$ 置信区间。推导必须从基本统计原理和给定的单历史碰撞计数的性质出发。\n\n该问题经核实具有科学依据、问题表述清晰、客观，并包含进行严格推导所需的所有信息。这是蒙特卡罗模拟结果统计分析中的一个标准问题。因此，我们可以着手求解。\n\n推导基于以下给定条件：\n1.  单历史计数 $\\{T_i\\}_{i=1}^{N}$ 构成一组 $N$ 个独立同分布 (i.i.d.) 的随机变量。\n2.  每个计数的期望值为 $\\mathbb{E}[T_i] = V\\phi$，其中 $V$ 是栅元体积，$\\phi$ 是真实的体积平均标量通量。这证明了碰撞估计量是无偏的。我们记这个真实均值为 $\\mu_T = V\\phi$。\n3.  每个计数的方差 $\\mathbb{V}[T_i] = \\sigma_T^2$ 是有限的。\n\n我们的目标是推导 $\\phi$ 的置信区间。$\\phi$ 的估计量由 $\\hat{\\phi} = \\frac{\\bar{T}}{V}$ 给出，其中 $\\bar{T}$ 是计数的样本均值：\n$$\n\\bar{T} = \\frac{1}{N} \\sum_{i=1}^{N} T_i\n$$\n\n首先，我们应用中心极限定理 (CLT)。根据随机变量线性组合的期望和方差性质，样本均值 $\\bar{T}$ 的均值和方差为：\n$$\n\\mathbb{E}[\\bar{T}] = \\mathbb{E}\\left[\\frac{1}{N} \\sum_{i=1}^{N} T_i\\right] = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbb{E}[T_i] = \\frac{1}{N} (N \\mu_T) = \\mu_T = V\\phi\n$$\n并且，由于 $T_i$ 的独立性：\n$$\n\\mathbb{V}[\\bar{T}] = \\mathbb{V}\\left[\\frac{1}{N} \\sum_{i=1}^{N} T_i\\right] = \\frac{1}{N^2} \\sum_{i=1}^{N} \\mathbb{V}[T_i] = \\frac{1}{N^2} (N \\sigma_T^2) = \\frac{\\sigma_T^2}{N}\n$$\n中心极限定理指出，对于足够大的样本量 $N$，样本均值 $\\bar{T}$ 的分布近似于均值为 $\\mu_T$、方差为 $\\sigma_T^2/N$ 的正态分布。用符号表示为 $\\bar{T} \\approx \\mathcal{N}(\\mu_T, \\sigma_T^2/N)$。\n\n由此，我们可以构造一个服从标准正态分布 $\\mathcal{N}(0, 1)$ 的标准化随机变量 $Z$：\n$$\nZ = \\frac{\\bar{T} - \\mathbb{E}[\\bar{T}]}{\\sqrt{\\mathbb{V}[\\bar{T}]}} = \\frac{\\bar{T} - \\mu_T}{\\sigma_T / \\sqrt{N}} = \\frac{\\bar{T} - V\\phi}{\\sigma_T / \\sqrt{N}} \\approx \\mathcal{N}(0, 1)\n$$\n如果真实方差 $\\sigma_T^2$ 已知，这个表达式可以用来构造 $\\phi$ 的置信区间。然而，问题指明方差是未知的，这在实际模拟中是典型情况。\n\n当 $\\sigma_T^2$ 未知时，必须从样本数据中估计它。总体方差 $\\sigma_T^2$ 的标准无偏估计量是样本方差 $s_T^2$：\n$$\ns_T^2 = \\frac{1}{N-1} \\sum_{i=1}^{N} (T_i - \\bar{T})^2\n$$\n问题中给出的 $s_T$ 是样本标准差，即样本方差的平方根。\n\n当我们在标准化变量 $Z$ 中用其估计值 $s_T$ 替代真实标准差 $\\sigma_T$ 时，得到的统计量不再服从正态分布，而是服从自由度为 $N-1$ 的学生 t 分布。这个我们称之为 $t$ 的枢轴量由下式给出：\n$$\nt = \\frac{\\bar{T} - \\mu_T}{s_T / \\sqrt{N}} = \\frac{\\bar{T} - V\\phi}{s_T / \\sqrt{N}}\n$$\n该变量服从分布 $t \\sim t_{N-1}$。\n\n为了构造一个 $(1-\\alpha)$ 置信区间，我们从 $t_{N-1}$ 分布中找到临界值，这些临界值界定了一个中心概率区域，其面积等于 $1-\\alpha$。设 $t_{1-\\alpha/2, N-1}$ 表示自由度为 $N-1$ 的学生 t 分布的上 $(1-\\alpha/2)$ 分位数。该值满足累积概率 $P(t \\le t_{1-\\alpha/2, N-1}) = 1-\\alpha/2$。由于 t 分布关于 0 对称，下临界值为 $-t_{1-\\alpha/2, N-1}$。\n\n置信区间的概率陈述为：\n$$\nP\\left( -t_{1-\\alpha/2, N-1}  \\frac{\\bar{T} - V\\phi}{s_T / \\sqrt{N}}  t_{1-\\alpha/2, N-1} \\right) = 1-\\alpha\n$$\n我们的任务是处理此表达式中的不等式，以分离出真实通量 $\\phi$。我们进行代数重排：\n\n1. 将不等式的所有部分乘以均值的标准误差 $s_T / \\sqrt{N}$ (该值为正)：\n$$\n-t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}}  \\bar{T} - V\\phi  t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}}\n$$\n\n2. 从所有部分减去 $\\bar{T}$：\n$$\n-\\bar{T} - t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}}  -V\\phi  -\\bar{T} + t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}}\n$$\n\n3. 乘以 $-1$ 并反转不等号的方向：\n$$\n\\bar{T} + t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}} > V\\phi > \\bar{T} - t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}}\n$$\n按标准顺序重写：\n$$\n\\bar{T} - t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}}  V\\phi  \\bar{T} + t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}}\n$$\n\n4. 最后，将所有部分除以体积 $V$。因为 $V$ 是物理体积，$V > 0$，所以不等号的方向不变：\n$$\n\\frac{1}{V} \\left( \\bar{T} - t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}} \\right)  \\phi  \\frac{1}{V} \\left( \\bar{T} + t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}} \\right)\n$$\n此表达式定义了 $\\phi$ 的 $(1-\\alpha)$ 置信区间的下限和上限。因此，端点的有序对为：\n$$\n\\left( \\frac{1}{V} \\left( \\bar{T} - t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}} \\right) , \\quad \\frac{1}{V} \\left( \\bar{T} + t_{1-\\alpha/2, N-1} \\frac{s_T}{\\sqrt{N}} \\right) \\right)\n$$\n该结果完全由计数的样本均值 $\\bar{T}$、计数的样本标准差 $s_T$、计数体积 $V$、历史数 $N$ 以及指定的学生 t 分布的分位数表示。",
            "answer": "$$\n\\boxed{\\left( \\frac{1}{V} \\left( \\bar{T} - t_{1-\\alpha/2, N-1} \\frac{s_{T}}{\\sqrt{N}} \\right), \\frac{1}{V} \\left( \\bar{T} + t_{1-\\alpha/2, N-1} \\frac{s_{T}}{\\sqrt{N}} \\right) \\right)}\n$$"
        },
        {
            "introduction": "碰撞估计量的方差不仅仅是一个抽象的统计属性，它与所模拟系统的物理特性密切相关。本问题在一个双区域平板模型中探讨了这种联系，揭示了材料界面如何“过滤”粒子并显著影响下游区域计数的效率。通过分析这个简化但富有洞察力的案例，您将对复杂几何形状中方差的来源建立更强的直觉。",
            "id": "4217530",
            "problem": "考虑一个厚度为 $L_{1}+L_{2}$ 的单能一维平板，占据 $0  x  L_1 + L_2$ 的区域，由两个均匀的、非增殖的子区域组成：区域 1 位于 $0  x  L_1$，具有总宏观截面 $\\Sigma_{t,1}$；区域 2 位于 $L_1  x  L_1 + L_2$，具有总宏观截面 $\\Sigma_{t,2}$。一个单位权重 ($w=1$) 的粒子源位于 $x=0$ 处，沿正 $x$ 方向（即运动方向余弦 $\\mu=1$）发射粒子。由于介质是纯吸收性的 ($\\Sigma_s=0$)，任何碰撞都是一个终止事件。\n\n根据第一性原理推导碰撞估计量的表达式，并证明其无偏性。然后，计算区域 2 中体平均标量通量 $\\bar{\\Phi}_2$ 的单个历史碰撞估计量的方差 $Var(\\hat{\\bar{\\Phi}}_2)$ 的闭合形式表达式。最后，定性讨论材料界面的存在如何影响区域 2 中碰撞估计量的方差，特别是比较情况 $\\Sigma_{t,1} > \\Sigma_{t,2}$ 和 $\\Sigma_{t,1}  \\Sigma_{t,2}$。将你的最终答案表示为关于 $L_1, L_2, V_2, \\Sigma_{t,1}$ 和 $\\Sigma_{t,2}$ 的单个闭合形式表达式。无需四舍五入。",
            "solution": "该问题被认为是有效的，因为它在中子输运理论方面有科学依据，是适定且客观的。它为蒙特卡罗方法中的一个标准问题提供了一套完整且一致的给定条件。\n\n解决方案按问题陈述的要求分为四个部分。\n\n**第一部分：碰撞估计量的推导**\n\n目标是为任意区域 $V_{i}$ 内的体平均标量通量 $\\bar{\\Phi}_{i}$ 推导一个无偏估计量。该量定义为时间积分标量通量 $\\Phi(\\vec{r})$ 在体积 $V_{i}$ 上的积分，并由该体积本身进行归一化：\n$$\n\\bar{\\Phi}_{i} = \\frac{1}{V_{i}} \\int_{V_{i}} \\Phi(\\vec{r}) dV\n$$\n在输运理论中，时间积分碰撞率密度 $C_{\\text{int}}(\\vec{r})$ 表示由源引起的在位置 $\\vec{r}$ 处单位体积的总碰撞数，它与时间积分标量通量 $\\Phi(\\vec{r})$ 通过以下基本恒等式相关联：\n$$\nC_{\\text{int}}(\\vec{r}) = \\Sigma_{t}(\\vec{r}) \\Phi(\\vec{r})\n$$\n其中 $\\Sigma_{t}(\\vec{r})$ 是在 $\\vec{r}$ 处的总宏观截面。将此恒等式代入体平均通量的定义中，得到：\n$$\n\\bar{\\Phi}_{i} = \\frac{1}{V_{i}} \\int_{V_{i}} \\frac{C_{\\text{int}}(\\vec{r})}{\\Sigma_{t}(\\vec{r})} dV\n$$\n积分项 $\\int_{V_{i}} \\frac{C_{\\text{int}}(\\vec{r})}{\\Sigma_{t}(\\vec{r})} dV$ 可以在蒙特卡罗模拟的背景下进行解释。量 $C_{\\text{int}}(\\vec{r}) dV$ 是每个源粒子在位置 $\\vec{r}$ 处的微分体积元 $dV$ 内发生碰撞的期望数。因此，该积分表示对所有发生在体积 $V_{i}$ 内的碰撞事件的得分总和的期望。\n\n在蒙特卡罗模拟中，我们追踪单个粒子（历史）。假设一个粒子经历了一系列碰撞。如果一次碰撞 $j$ 发生在体积 $V_{i}$ 内的位置 $\\vec{r}_{j}$ 处，我们可以为这个事件定义一个得分。可以为每个历史构建一个随机变量 $\\xi_{c, i}$，表示该历史在区域 $V_{i}$ 中的总得分。根据被积函数的结构，我们将发生在 $\\vec{r}_{j}$ 处的单次碰撞的得分定义为 $\\frac{w_{j}}{\\Sigma_{t}(\\vec{r}_{j})}$，其中 $w_{j}$ 是粒子在碰撞前的权重。该历史在区域 $V_{i}$ 中的总得分是该区域内发生的所有碰撞的得分之和：\n$$\n\\xi_{c, i} = \\sum_{j \\text{ s.t. } \\vec{r}_{j} \\in V_{i}} \\frac{w_{j}}{\\Sigma_{t}(\\vec{r}_{j})}\n$$\n这个随机变量在许多历史上的期望值由下式给出：\n$$\nE[\\xi_{c, i}] = \\int_{V_{i}} \\frac{1}{\\Sigma_{t}(\\vec{r})} C_{\\text{int}}(\\vec{r}) dV\n$$\n这个等式成立，因为 $C_{\\text{int}}(\\vec{r})$ 是碰撞的概率密度函数（按源强度缩放），而模拟碰撞的蒙特卡罗过程就是一种从此密度中抽样的方法。因此，我们已经确立了 $E[\\xi_{c, i}] = \\int_{V_{i}} \\Phi(\\vec{r}) dV$。\n\n正如问题陈述所建议的，体平均标量通量的估计量 $\\hat{\\bar{\\Phi}}_{i}$ 自然地通过用体积 $V_{i}$ 对单个历史的得分 $\\xi_{c, i}$ 进行归一化来定义：\n$$\n\\hat{\\bar{\\Phi}}_{i} = \\frac{\\xi_{c, i}}{V_{i}} = \\frac{1}{V_{i}} \\sum_{j \\text{ s.t. } \\vec{r}_{j} \\in V_{i}} \\frac{w_{j}}{\\Sigma_{t}(\\vec{r}_{j})}\n$$\n为了验证该估计量是无偏的，我们取其期望：\n$$\nE[\\hat{\\bar{\\Phi}}_{i}] = E\\left[\\frac{\\xi_{c, i}}{V_{i}}\\right] = \\frac{1}{V_{i}} E[\\xi_{c, i}] = \\frac{1}{V_{i}} \\int_{V_{i}} \\Phi(\\vec{r}) dV = \\bar{\\Phi}_{i}\n$$\n由于估计量的期望值等于被估计的量，因此该估计量是无偏的。此推导如要求一样，从标量通量的定义和碰撞率恒等式开始。\n\n**第二部分：针对特定问题的期望值分析**\n\n对于给定的单维纯吸收平板，每个历史由一个从 $x=0$ 出发、方向为 $\\mu=1$、权重为 $w=1$ 的单个粒子组成。由于没有散射，一个粒子最多只能发生一次碰撞，该碰撞是一个吸收事件，会终止该历史。\n\n从 $x=0$ 处的源到位置 $x$ 的光学距离是 $\\tau(x) = \\int_{0}^{x} \\Sigma_{t}(x') dx'$。\n对于 $x \\in (0, L_{1})$，$\\tau(x) = \\Sigma_{t,1} x$。\n对于 $x \\in (L_{1}, L_{1}+L_{2})$，$\\tau(x) = \\Sigma_{t,1} L_{1} + \\Sigma_{t,2} (x-L_{1})$。\n首次碰撞距离的概率密度函数为 $p(x) = \\Sigma_{t}(x) \\exp(-\\tau(x))$。\n\n单次碰撞发生在区域 1 的概率 $P_{1}$ 是：\n$$\nP_{1} = \\int_{0}^{L_{1}} \\Sigma_{t,1} \\exp(-\\Sigma_{t,1} x) dx = [-\\exp(-\\Sigma_{t,1} x)]_{0}^{L_{1}} = 1 - \\exp(-\\Sigma_{t,1} L_{1})\n$$\n在区域 2 发生碰撞的概率 $P_{2}$，要求中子首先穿过区域 1 而存活（概率为 $\\exp(-\\Sigma_{t,1} L_1)$），然后才在区域 2 发生碰撞：\n$$\nP_{2} = \\exp(-\\Sigma_{t,1} L_{1}) \\int_{L_{1}}^{L_{1}+L_{2}} \\Sigma_{t,2} \\exp(-\\Sigma_{t,2}(x-L_{1})) dx = \\exp(-\\Sigma_{t,1} L_{1}) [1 - \\exp(-\\Sigma_{t,2} L_{2})]\n$$\n在 $x=L_{1}+L_{2}$ 处无碰撞逸出平板的概率 $P_{\\text{exit}}$ 是穿过两个区域都存活的概率：\n$$\nP_{\\text{exit}} = \\exp(-\\Sigma_{t,1} L_{1}) \\exp(-\\Sigma_{t,2} L_{2}) = \\exp(-(\\Sigma_{t,1} L_{1} + \\Sigma_{t,2} L_{2}))\n$$\n可以验证 $P_{1} + P_{2} + P_{\\text{exit}} = 1$。\n\n区域 $i$ 的碰撞估计量得分是一个随机变量 $X_{i}$，它仅当在该区域发生碰撞时才非零。由于 $w=1$，得分为 $1/\\Sigma_{t,i}$。\n对于区域 1，$X_1$ 以概率 $P_1$ 取值 $1/\\Sigma_{t,1}$，否则为 0。其期望值为：\n$$\nE[X_{1}] = \\frac{1}{\\Sigma_{t,1}} P_{1} = \\frac{1 - \\exp(-\\Sigma_{t,1} L_{1})}{\\Sigma_{t,1}}\n$$\n对于区域 2，$X_2$ 以概率 $P_2$ 取值 $1/\\Sigma_{t,2}$，否则为 0。其期望值为：\n$$\nE[X_{2}] = \\frac{1}{\\Sigma_{t,2}} P_{2} = \\frac{\\exp(-\\Sigma_{t,1} L_{1}) (1 - \\exp(-\\Sigma_{t,2} L_{2}))}{\\Sigma_{t,2}}\n$$\n区域 $i$ 的体平均通量估计量的期望值为 $E[\\hat{\\bar{\\Phi}}_{i}] = E[X_i] / V_i$。\n\n现在，我们计算每个区域的期望径迹长度 $E[l_{i}]$。径迹长度估计量为 $\\hat{\\bar{\\Phi}}_{i,\\text{track}} = l_{i}/V_{i}$。\n对于区域 1，如果粒子在 $s  L_1$ 处碰撞，则其行进距离为 $s$；如果穿过该区域，则行进距离为 $L_1$。\n$$\nE[l_{1}] = \\int_{0}^{L_{1}} s \\, p(s) ds + L_{1} P(\\text{survive region 1}) = \\int_{0}^{L_{1}} s \\Sigma_{t,1} \\exp(-\\Sigma_{t,1} s) ds + L_{1} \\exp(-\\Sigma_{t,1} L_{1})\n$$\n使用分部积分法，$\\int s e^{-as} ds = -\\frac{s}{a} e^{-as} - \\frac{1}{a^2} e^{-as}$。\n$$\n\\int_{0}^{L_{1}} s \\Sigma_{t,1} \\exp(-\\Sigma_{t,1} s) ds = \\Sigma_{t,1} \\left[-\\frac{s}{\\Sigma_{t,1}}e^{-\\Sigma_{t,1} s} - \\frac{1}{\\Sigma_{t,1}^{2}}e^{-\\Sigma_{t,1} s}\\right]_{0}^{L_{1}} = -L_{1}e^{-\\Sigma_{t,1} L_{1}} - \\frac{1}{\\Sigma_{t,1}}e^{-\\Sigma_{t,1} L_{1}} + \\frac{1}{\\Sigma_{t,1}}\n$$\n加上穿过区域 1 而存活的项：\n$$\nE[l_{1}] = \\left(-L_{1}e^{-\\Sigma_{t,1} L_{1}} + \\frac{1 - e^{-\\Sigma_{t,1} L_{1}}}{\\Sigma_{t,1}}\\right) + L_{1} e^{-\\Sigma_{t,1} L_{1}} = \\frac{1 - \\exp(-\\Sigma_{t,1} L_{1})}{\\Sigma_{t,1}}\n$$\n这与 $E[X_{1}]$ 完全相同。\n对于区域 2，只有当粒子到达 $x=L_{1}$ 时，径迹长度才非零。在到达区域 2 的条件下，其内部的期望径迹长度与一个厚度为 $L_2$、截面为 $\\Sigma_{t,2}$ 的平板中的期望径迹长度相同，即 $\\frac{1 - \\exp(-\\Sigma_{t,2} L_{2})}{\\Sigma_{t,2}}$。\n$$\nE[l_{2}] = P(\\text{reach R2}) \\times E[l | \\text{in R2}] = \\exp(-\\Sigma_{t,1} L_{1}) \\frac{1 - \\exp(-\\Sigma_{t,2} L_{2})}{\\Sigma_{t,2}}\n$$\n这与 $E[X_{2}]$ 完全相同。因此，对于两个区域，碰撞估计量得分的期望值都等于期望径迹长度。因此，$E[\\hat{\\bar{\\Phi}}_{i, \\text{collision}}] = E[\\hat{\\bar{\\Phi}}_{i, \\text{track}}]$。\n\n**第三部分：区域 2 的方差计算**\n\n要求计算区域 2 中体平均标量通量的单个历史估计量的方差 $Var(\\hat{\\bar{\\Phi}}_{2})$。\n$$\nVar(\\hat{\\bar{\\Phi}}_{2}) = Var\\left(\\frac{X_{2}}{V_{2}}\\right) = \\frac{1}{V_{2}^{2}} Var(X_{2})\n$$\n随机变量 $X_{2}$ 的方差由 $Var(X_{2}) = E[X_{2}^{2}] - (E[X_{2}])^{2}$ 给出。\n随机变量 $X_{2}$ 以概率 $P_2$ 取值 $\\frac{1}{\\Sigma_{t,2}}$，否则为 0。随机变量 $X_{2}^{2}$ 以概率 $P_2$ 取值 $\\left(\\frac{1}{\\Sigma_{t,2}}\\right)^{2}$，否则为 0。\n$X_{2}^{2}$ 的期望值为：\n$$\nE[X_{2}^{2}] = \\left(\\frac{1}{\\Sigma_{t,2}}\\right)^{2} P_{2} = \\frac{P_{2}}{\\Sigma_{t,2}^{2}}\n$$\n我们已经计算出 $E[X_{2}] = P_{2}/\\Sigma_{t,2}$。现在我们可以求出 $X_2$ 的方差：\n$$\nVar(X_{2}) = E[X_{2}^{2}] - (E[X_{2}])^{2} = \\frac{P_{2}}{\\Sigma_{t,2}^{2}} - \\left(\\frac{P_{2}}{\\Sigma_{t,2}}\\right)^{2} = \\frac{P_{2}(1 - P_{2})}{\\Sigma_{t,2}^{2}}\n$$\n代入 $P_{2} = \\exp(-\\Sigma_{t,1} L_{1}) (1 - \\exp(-\\Sigma_{t,2} L_{2}))$ 的表达式：\n$$\nVar(X_{2}) = \\frac{1}{\\Sigma_{t,2}^{2}} \\left[\\exp(-\\Sigma_{t,1} L_{1}) (1-\\exp(-\\Sigma_{t,2} L_{2}))\\right] \\left[1 - \\exp(-\\Sigma_{t,1} L_{1})(1 - \\exp(-\\Sigma_{t,2} L_{2}))\\right]\n$$\n最后，区域 2 中体平均通量估计量的单个历史方差为：\n$$\nVar(\\hat{\\bar{\\Phi}}_{2}) = \\frac{Var(X_{2})}{V_{2}^{2}} = \\frac{\\exp(-\\Sigma_{t,1} L_{1}) (1-\\exp(-\\Sigma_{t,2} L_{2})) \\left(1 - \\exp(-\\Sigma_{t,1} L_{1}) + \\exp(-\\Sigma_{t,1} L_{1} - \\Sigma_{t,2} L_{2})\\right)}{V_{2}^{2} \\Sigma_{t,2}^{2}}\n$$\n这就是所要求的闭合形式表达式。\n\n**第四部分：关于方差的定性讨论**\n\n我们分析材料界面的存在如何影响区域 2 中碰撞估计量的方差。我们将推导出的方差与一个总厚度为 $L_{1}+L_{2}$、均匀截面为 $\\Sigma_{t,2}$ 的均匀平板的方差进行比较。\n\n在双区域情况下，区域 2 的碰撞概率为 $P_{2} = \\exp(-\\Sigma_{t,1} L_{1})[1-\\exp(-\\Sigma_{t,2} L_{2})]$。在均匀情况下（处处截面均为 $\\Sigma_{t,2}$），在相同的空间域 $(L_{1}, L_{1}+L_{2})$ 内的碰撞概率将是 $P_{2,\\text{hom}} = \\exp(-\\Sigma_{t,2} L_{1})[1-\\exp(-\\Sigma_{t,2} L_{2})]$。\n\n估计量的方差与 $P_{2}(1-P_{2})$ 成正比。函数 $f(p) = p(1-p)$ 在 $p \\in [0, 1/2]$ 上递增，在 $p \\in [1/2, 1]$ 上递减。在大多数输运问题中，小的、遥远区域的碰撞概率很低（即 $P_{2} \\ll 1/2$），因此方差近似与碰撞概率成正比，$Var \\propto P_2$。\n\n两种情况之间的比较取决于中子穿过第一个区域存活下来以到达统计区域（区域 2）的概率。\n1.  情况 $\\Sigma_{t,1} > \\Sigma_{t,2}$：区域 1 比均匀参考情况更具衰减性（更不透明）。穿过区域 1 的存活概率更低：$\\exp(-\\Sigma_{t,1} L_{1})  \\exp(-\\Sigma_{t,2} L_{1})$。这导致区域 2 的碰撞概率更小：$P_{2}  P_{2,\\text{hom}}$。到达区域 2 进行计分的粒子比例更小。这意味着更多的历史将贡献零分。当一种结果（零分）变得极有可能时，方差会减小（假设 $P_2  1/2$）。因此，拥有一个更不透明的第一个区域会降低区域 2 中碰撞估计量的方差。\n2.  情况 $\\Sigma_{t,1}  \\Sigma_{t,2}$：区域 1 的衰减性较弱（更透明）。存活概率更高：$\\exp(-\\Sigma_{t,1} L_{1}) > \\exp(-\\Sigma_{t,2} L_{1})$。这增加了区域 2 的碰撞概率：$P_{2} > P_{2,\\text{hom}}$。更多的粒子到达区域 2 并有机会计分，使得结果（碰撞或不碰撞）变得不那么确定。这会增加方差（同样，假设 $P_2  1/2$）。\n\n总之，材料界面起着过滤器的作用。上游区域（1）的性质控制着向下游统计区域（2）的粒子“供应”。一个衰减性更强的上游区域通过使计分成为更稀有的事件来降低统计方差。一个衰减性较弱的上游区域通过使计分更频繁，从而使每个历史的结果更具随机性，来增加方差。这凸显了蒙特卡罗模拟的一个基本方面：局部统计的方差不仅取决于局部性质，还取决于全局输运问题。",
            "answer": "$$\n\\boxed{\\frac{\\exp(-\\Sigma_{t,1} L_{1}) (1 - \\exp(-\\Sigma_{t,2} L_{2})) \\left(1 - \\exp(-\\Sigma_{t,1} L_{1}) + \\exp(-\\Sigma_{t,1} L_{1} - \\Sigma_{t,2} L_{2})\\right)}{V_{2}^{2} \\Sigma_{t,2}^{2}}}\n$$"
        },
        {
            "introduction": "对于涉及深度穿透或局部计数的问题，常规的蒙特卡洛模拟可能效率极低。本实践介绍了通过指数变换实现的重要性抽样，这是一种强大的方差缩减技术，它将粒子路径偏向感兴趣的区域。通过解析推导和比较常规估计量与偏倚估计量的方差，您将具体理解此类技术的工作原理及其在解决挑战性输运问题中的关键作用。",
            "id": "4217525",
            "problem": "考虑在一维均匀、纯吸收介质中的单能中性粒子输运，该过程由线性玻尔兹曼方程（LBE）描述。介质具有恒定的宏观总截面 $\\Sigma_{t} > 0$，其中吸收截面 $\\Sigma_{a} = \\Sigma_{t}$，散射截面 $\\Sigma_{s} = 0$。位于位置 $x=0$ 的单向源沿 $+x$ 方向发射粒子。设探测器区域为平板 $R = [L, L + d]$，其中 $L > 0$ 且 $d > 0$。区域 $R$ 内的标量通量由碰撞估计子进行估计：对于每个粒子历史，如果碰撞发生在 $R$ 内，其对计数（tally）的贡献为 $w/\\Sigma_{t}$，否则为 $0$，其中 $w$ 是粒子的统计权重。\n\n在模拟蒙特卡罗（analog Monte Carlo, MC）方法中，碰撞距离 $s$ 从概率密度函数（PDF）$f(s) = \\Sigma_{t} \\exp(-\\Sigma_{t} s)$（其中 $s \\geq 0$）中抽样，权重为 $w=1$。在使用指数变换对飞向探测器的路径进行偏倚的重要性抽样输运中，碰撞距离 $s$ 从偏倚概率密度函数（PDF）$g(s) = \\tau \\exp(-\\tau s)$（其中 $s \\geq 0$）中抽样，偏倚参数为 $\\tau \\in (0, \\Sigma_{t})$，同时通过似然比 $w(s) = f(s)/g(s)$ 选择权重以保持无偏性。\n\n从第一性原理出发——即吸收介质中碰撞距离的指数衰减定律、标量通量碰撞估计子的定义、无偏重要性抽样条件 $w(s) = f(s)/g(s)$ 以及单历史得分的方差定义——推导在模拟抽样和重要性抽样指数变换下，碰撞计数的单历史方差的闭合形式表达式。然后，构建重要性抽样计数方差与模拟计数方差之比。将你的最终答案表示为关于 $\\Sigma_{t}$、$L$、$d$ 和 $\\tau$ 的单个闭合形式解析表达式。该比值为无量纲。无需四舍五入。",
            "solution": "用户希望我验证以下问题，如果问题有效，则提供解答。\n\n### 步骤1：提取已知条件\n-   **系统**：一维均匀、纯吸收介质中的单能中性粒子输运。\n-   **方程**：线性玻尔兹曼方程（LBE）。\n-   **截面**：恒定的宏观总截面 $\\Sigma_t > 0$，吸收截面 $\\Sigma_a = \\Sigma_t$，散射截面 $\\Sigma_s = 0$。\n-   **源**：位于位置 $x=0$ 的单向源，沿 $+x$ 方向发射粒子。\n-   **探测器**：区域 $R = [L, L + d]$，其中 $L > 0$ 且 $d > 0$。\n-   **估计子**：区域 $R$ 内标量通量的碰撞估计子。\n-   **估计子得分**：如果碰撞发生在 $R$ 内，其对计数的贡献为 $w/\\Sigma_t$，否则为 $0$。$w$ 是粒子的统计权重。\n-   **模拟蒙特卡罗（MC）**：\n    -   碰撞距离 $s$ 从概率密度函数（PDF）$f(s) = \\Sigma_t \\exp(-\\Sigma_t s)$（其中 $s \\geq 0$）中抽样。\n    -   粒子权重为 $w=1$。\n-   **重要性抽样蒙特卡罗（指数变换）**：\n    -   碰撞距离 $s$ 从偏倚概率密度函数（PDF）$g(s) = \\tau \\exp(-\\tau s)$（其中 $s \\geq 0$）中抽样。\n    -   偏倚参数为 $\\tau \\in (0, \\Sigma_t)$。\n    -   粒子权重为 $w(s) = f(s)/g(s)$ 以确保无偏性。\n-   **任务**：推导模拟计数和重要性抽样计数的单历史方差。然后，构建重要性抽样方差与模拟方差之比。最终结果应为关于 $\\Sigma_t$、$L$、$d$ 和 $\\tau$ 的单个闭合形式解析表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题牢固地植根于成熟的粒子输运蒙特卡罗方法理论，这是核工程和物理学中的一个标准课题。所有定义（截面、玻尔兹曼方程、碰撞估计子、指数变换）都是标准且正确的。\n2.  **适定性**：问题定义明确。它提供了推导方差及其比值所需的所有必要信息。目标具体，且存在唯一的解析解。\n3.  **客观性**：语言精确、量化，没有任何主观性或模糊性。所使用的符号和术语在该领域具有标准含义。\n4.  **完整性与一致性**：问题是自洽且内部一致的。两种抽样方案和估计子的定义清晰且兼容。\n5.  **未检测到其他缺陷**：该问题不违反任何其他验证标准。这是一个标准的、有一定难度的推导问题。\n\n### 步骤3：结论与行动\n该问题是**有效的**。我将继续进行推导。\n\n### 推导过程\n随机变量（单历史得分 $\\xi$）的方差 $\\sigma^2$ 由以下公式给出：\n$$\n\\sigma^2 = E[\\xi^2] - (E[\\xi])^2\n$$\n其中 $E[\\cdot]$ 表示期望值。我们将分别计算模拟情况（$\\sigma_A^2$）和重要性抽样情况（$\\sigma_I^2$）的方差。\n\n**1. 模拟蒙特卡罗方差（$\\sigma_A^2$）**\n\n在模拟情况下，粒子权重为 $w=1$。得分 $\\xi_A$ 为：\n$$\n\\xi_A(s) =\n\\begin{cases}\n\\frac{1}{\\Sigma_t}  \\text{如果 } s \\in [L, L+d] \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n碰撞距离 $s$ 从概率密度函数（PDF）$f(s) = \\Sigma_t \\exp(-\\Sigma_t s)$ 中抽样。\n\n期望得分 $E[\\xi_A]$ 通过对所有可能的碰撞距离上的得分进行积分计算，并由概率密度函数加权：\n$$\nE[\\xi_A] = \\int_0^\\infty \\xi_A(s) f(s) ds = \\int_L^{L+d} \\frac{1}{\\Sigma_t} (\\Sigma_t \\exp(-\\Sigma_t s)) ds = \\int_L^{L+d} \\exp(-\\Sigma_t s) ds\n$$\n$$\nE[\\xi_A] = \\left[ -\\frac{1}{\\Sigma_t} \\exp(-\\Sigma_t s) \\right]_L^{L+d} = \\frac{1}{\\Sigma_t} (\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d)))\n$$\n这是区域 $R$ 内的真实积分标量通量，证实了该估计子对于此量是无偏的。\n\n期望得分的平方 $E[\\xi_A^2]$ 为：\n$$\nE[\\xi_A^2] = \\int_0^\\infty (\\xi_A(s))^2 f(s) ds = \\int_L^{L+d} \\left(\\frac{1}{\\Sigma_t}\\right)^2 (\\Sigma_t \\exp(-\\Sigma_t s)) ds = \\frac{1}{\\Sigma_t} \\int_L^{L+d} \\exp(-\\Sigma_t s) ds\n$$\n$$\nE[\\xi_A^2] = \\frac{1}{\\Sigma_t} \\left( \\frac{1}{\\Sigma_t} (\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d))) \\right) = \\frac{1}{\\Sigma_t^2} (\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d)))\n$$\n那么方差 $\\sigma_A^2$ 为：\n$$\n\\sigma_A^2 = E[\\xi_A^2] - (E[\\xi_A])^2 = \\frac{1}{\\Sigma_t^2} (\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d))) - \\frac{1}{\\Sigma_t^2} (\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d)))^2\n$$\n\n**2. 重要性抽样蒙特卡罗方差（$\\sigma_I^2$）**\n\n在重要性抽样情况下，碰撞距离 $s$ 从偏倚概率密度函数 $g(s) = \\tau \\exp(-\\tau s)$ 中抽样。调整粒子权重以保持结果无偏：\n$$\nw(s) = \\frac{f(s)}{g(s)} = \\frac{\\Sigma_t \\exp(-\\Sigma_t s)}{\\tau \\exp(-\\tau s)} = \\frac{\\Sigma_t}{\\tau} \\exp(-(\\Sigma_t - \\tau)s)\n$$\n得分 $\\xi_I(s)$ 为：\n$$\n\\xi_I(s) =\n\\begin{cases}\n\\frac{w(s)}{\\Sigma_t} = \\frac{1}{\\tau} \\exp(-(\\Sigma_t - \\tau)s)  \\text{如果 } s \\in [L, L+d] \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n现在期望值是相对于偏倚概率密度函数 $g(s)$ 计算的。期望得分 $E[\\xi_I]$ 为：\n$$\nE[\\xi_I] = \\int_0^\\infty \\xi_I(s) g(s) ds = \\int_L^{L+d} \\left(\\frac{w(s)}{\\Sigma_t}\\right) g(s) ds\n$$\n代入 $w(s) = f(s)/g(s)$，我们得到：\n$$\nE[\\xi_I] = \\int_L^{L+d} \\frac{1}{\\Sigma_t} \\frac{f(s)}{g(s)} g(s) ds = \\int_L^{L+d} \\frac{f(s)}{\\Sigma_t} ds = E[\\xi_A]\n$$\n这证实了估计子保持无偏。因此，$(E[\\xi_I])^2 = (E[\\xi_A])^2$。\n\n期望得分的平方 $E[\\xi_I^2]$ 为：\n$$\nE[\\xi_I^2] = \\int_0^\\infty (\\xi_I(s))^2 g(s) ds = \\int_L^{L+d} \\left(\\frac{1}{\\tau} \\exp(-(\\Sigma_t - \\tau)s)\\right)^2 (\\tau \\exp(-\\tau s)) ds\n$$\n$$\nE[\\xi_I^2] = \\int_L^{L+d} \\frac{1}{\\tau^2} \\exp(-2(\\Sigma_t - \\tau)s) \\cdot \\tau \\exp(-\\tau s) ds = \\frac{1}{\\tau} \\int_L^{L+d} \\exp(-(2\\Sigma_t - 2\\tau + \\tau)s) ds\n$$\n$$\nE[\\xi_I^2] = \\frac{1}{\\tau} \\int_L^{L+d} \\exp(-(2\\Sigma_t - \\tau)s) ds\n$$\n进行积分：\n$$\nE[\\xi_I^2] = \\frac{1}{\\tau} \\left[ -\\frac{1}{2\\Sigma_t - \\tau} \\exp(-(2\\Sigma_t - \\tau)s) \\right]_L^{L+d}\n$$\n$$\nE[\\xi_I^2] = \\frac{1}{\\tau(2\\Sigma_t - \\tau)} (\\exp(-(2\\Sigma_t - \\tau)L) - \\exp(-(2\\Sigma_t - \\tau)(L+d)))\n$$\n那么方差 $\\sigma_I^2$ 为：\n$$\n\\sigma_I^2 = E[\\xi_I^2] - (E[\\xi_I])^2 = \\frac{\\exp(-(2\\Sigma_t - \\tau)L) - \\exp(-(2\\Sigma_t - \\tau)(L+d))}{\\tau(2\\Sigma_t - \\tau)} - \\frac{1}{\\Sigma_t^2}(\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d)))^2\n$$\n\n**3. 方差之比**\n\n最后一步是构建比值 $\\frac{\\sigma_I^2}{\\sigma_A^2}$。\n$$\n\\frac{\\sigma_I^2}{\\sigma_A^2} = \\frac{E[\\xi_I^2] - (E[\\xi_A])^2}{E[\\xi_A^2] - (E[\\xi_A])^2}\n$$\n代入推导出的表达式：\n$$\n\\frac{\\sigma_I^2}{\\sigma_A^2} = \\frac{\\frac{\\exp(-(2\\Sigma_t - \\tau)L) - \\exp(-(2\\Sigma_t - \\tau)(L+d))}{\\tau(2\\Sigma_t - \\tau)} - \\frac{1}{\\Sigma_t^2}(\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d)))^2}{\\frac{1}{\\Sigma_t^2}(\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d))) - \\frac{1}{\\Sigma_t^2}(\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d)))^2}\n$$\n将分子和分母同乘以 $\\Sigma_t^2$ 得到最终的闭合形式表达式：\n$$\n\\frac{\\sigma_I^2}{\\sigma_A^2} = \\frac{\\frac{\\Sigma_t^2}{\\tau(2\\Sigma_t - \\tau)}(\\exp(-(2\\Sigma_t - \\tau)L) - \\exp(-(2\\Sigma_t - \\tau)(L+d))) - (\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d)))^2}{(\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d))) - (\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d)))^2}\n$$\n这个表达式可以更紧凑地写为：\n$$\n\\frac{\\sigma_I^2}{\\sigma_A^2} = \\frac{\\frac{\\Sigma_t^2}{\\tau(2\\Sigma_t - \\tau)} \\left( e^{-(2\\Sigma_t - \\tau)L} - e^{-(2\\Sigma_t - \\tau)(L+d)} \\right) - \\left( e^{-\\Sigma_t L} - e^{-\\Sigma_t(L+d)} \\right)^2}{\\left( e^{-\\Sigma_t L} - e^{-\\Sigma_t(L+d)} \\right) \\left( 1 - \\left( e^{-\\Sigma_t L} - e^{-\\Sigma_t(L+d)} \\right) \\right)}\n$$\n这就是所要求的方差比值的单个闭合形式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\frac{\\Sigma_t^2}{\\tau(2\\Sigma_t - \\tau)}\\left(\\exp\\left(-(2\\Sigma_t - \\tau)L\\right) - \\exp\\left(-(2\\Sigma_t - \\tau)(L+d)\\right)\\right) - \\left(\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d))\\right)^2}{\\left(\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d))\\right) - \\left(\\exp(-\\Sigma_t L) - \\exp(-\\Sigma_t(L+d))\\right)^2}}$$"
        }
    ]
}