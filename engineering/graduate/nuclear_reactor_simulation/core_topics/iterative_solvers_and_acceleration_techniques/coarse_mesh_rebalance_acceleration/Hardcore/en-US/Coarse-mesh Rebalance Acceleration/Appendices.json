{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a direct, hands-on application of the core Coarse-Mesh Rebalance (CMR) principle. Using tallied reaction rates and source data from a hypothetical transport sweep, you will enforce particle conservation over coarse cells to determine the necessary flux correction factors. This practice solidifies the fundamental mechanics of the CMR algorithm by having you calculate rebalance factors and apply them to update a flux distribution .",
            "id": "4217226",
            "problem": "Consider a one-dimensional (1D) homogeneous slab of total thickness $100 \\text{ cm}$, partitioned into two equal coarse cells of widths $50 \\text{ cm}$ each. A one-group, steady-state transport calculation with vacuum boundary conditions at both slab ends has been performed, and a single transport sweep has produced coarse-cell tallies and a fine-mesh flux shape as follows. In each coarse cell $i \\in \\{1,2\\}$, denote by $L_i^{\\text{old}}$ the net leakage rate leaving the cell (outward surface current integrated over its boundary), by $A_i^{\\text{old}}$ the absorption reaction rate integrated over the cell volume, and by $Q_i$ the total fixed source integrated over the cell volume. The tallies are:\n- Cell $1$: $L_1^{\\text{old}} = 1.2 \\times 10^6$, $A_1^{\\text{old}} = 3.8 \\times 10^6$, $Q_1 = 5.4 \\times 10^6$.\n- Cell $2$: $L_2^{\\text{old}} = 1.0 \\times 10^6$, $A_2^{\\text{old}} = 3.0 \\times 10^6$, $Q_2 = 4.6 \\times 10^6$.\n\nAll rates are in units of neutrons per second. Within each coarse cell, the previously computed fine-mesh volume-averaged scalar flux shape $\\phi_{i,j}^{\\text{old}}$ (in neutrons per square centimeter per second) on five equal fine subcells of width $10 \\text{ cm}$ is:\n- Cell $1$ (from left boundary to the interface): $\\phi_{1,1}^{\\text{old}} = 1.2 \\times 10^5$, $\\phi_{1,2}^{\\text{old}} = 1.15 \\times 10^5$, $\\phi_{1,3}^{\\text{old}} = 1.10 \\times 10^5$, $\\phi_{1,4}^{\\text{old}} = 1.05 \\times 10^5$, $\\phi_{1,5}^{\\text{old}} = 1.00 \\times 10^5$.\n- Cell $2$ (from the interface to the right boundary): $\\phi_{2,1}^{\\text{old}} = 9.5 \\times 10^4$, $\\phi_{2,2}^{\\text{old}} = 9.0 \\times 10^4$, $\\phi_{2,3}^{\\text{old}} = 8.5 \\times 10^4$, $\\phi_{2,4}^{\\text{old}} = 8.0 \\times 10^4$, $\\phi_{2,5}^{\\text{old}} = 7.5 \\times 10^4$.\n\nUsing the principle of Coarse-Mesh Rebalance (CMR) acceleration, assume a multiplicative cellwise rebalance factor $R_i$ is applied to the flux in each coarse cell $i$, so that every within-cell reaction rate and net leakage scales linearly with $R_i$, while the fixed source $Q_i$ does not scale. Starting from the steady-state one-group transport balance integrated over each coarse cell (net leakage plus absorption equals the fixed source within the cell), first derive an expression for $R_1$ and $R_2$ in terms of $L_i^{\\text{old}}$, $A_i^{\\text{old}}$, and $Q_i$. Then compute the corrected fine-mesh flux profile $\\phi_{i,j}^{\\text{new}}$ after one rebalance via $\\phi_{i,j}^{\\text{new}} = R_i \\, \\phi_{i,j}^{\\text{old}}$.\n\nExpress all corrected flux values in neutrons per square centimeter per second and round your answer to four significant figures. Provide a single final answer consisting of a row vector containing, in order, $R_1$, $R_2$, followed by the ten corrected fine-mesh fluxes $\\phi_{1,1}^{\\text{new}}, \\phi_{1,2}^{\\text{new}}, \\phi_{1,3}^{\\text{new}}, \\phi_{1,4}^{\\text{new}}, \\phi_{1,5}^{\\text{new}}, \\phi_{2,1}^{\\text{new}}, \\phi_{2,2}^{\\text{new}}, \\phi_{2,3}^{\\text{new}}, \\phi_{2,4}^{\\text{new}}, \\phi_{2,5}^{\\text{new}}$.",
            "solution": "The user wants to solve a coarse-mesh rebalance (CMR) problem.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\n- Geometry: One-dimensional slab of total thickness $100$ cm.\n- Coarse Mesh: $2$ coarse cells of equal width, $50$ cm each.\n- Boundary Conditions: Vacuum at both ends.\n- Physics: One-group, steady-state transport.\n- Tallies from a single transport sweep (denoted with superscript \"old\"):\n  - Cell $1$:\n    - Net leakage rate: $L_1^{\\text{old}} = 1.2 \\times 10^6$ neutrons/second.\n    - Absorption rate: $A_1^{\\text{old}} = 3.8 \\times 10^6$ neutrons/second.\n    - Fixed source: $Q_1 = 5.4 \\times 10^6$ neutrons/second.\n  - Cell $2$:\n    - Net leakage rate: $L_2^{\\text{old}} = 1.0 \\times 10^6$ neutrons/second.\n    - Absorption rate: $A_2^{\\text{old}} = 3.0 \\times 10^6$ neutrons/second.\n    - Fixed source: $Q_2 = 4.6 \\times 10^6$ neutrons/second.\n- Fine-mesh scalar flux shape (old): $5$ fine subcells of width $10$ cm in each coarse cell.\n  - Cell $1$ fluxes ($\\phi_{1,j}^{\\text{old}}$): $1.2 \\times 10^5$, $1.15 \\times 10^5$, $1.10 \\times 10^5$, $1.05 \\times 10^5$, $1.00 \\times 10^5$ neutrons/(cm$^2$ s).\n  - Cell $2$ fluxes ($\\phi_{2,j}^{\\text{old}}$): $9.5 \\times 10^4$, $9.0 \\times 10^4$, $8.5 \\times 10^4$, $8.0 \\times 10^4$, $7.5 \\times 10^4$ neutrons/(cm$^2$ s).\n- CMR Assumption: A cell-wise constant rebalance factor $R_i$ is applied, such that the new flux is $\\phi_i^{\\text{new}} = R_i \\phi_i^{\\text{old}}$. All within-cell reaction rates and net leakage are assumed to scale linearly with $R_i$. The fixed source $Q_i$ is constant.\n- Task: Derive an expression for $R_1$ and $R_2$, compute their values, and compute the new fine-mesh flux profile $\\phi_{i,j}^{\\text{new}} = R_i \\phi_{i,j}^{\\text{old}}$.\n\n**1.2. Validate Using Extracted Givens**\n\n- **Scientific Grounding**: The problem is grounded in the well-established field of numerical methods for nuclear reactor analysis. Coarse-Mesh Rebalance (CMR) is a standard acceleration technique for iterative transport solutions. The particle balance equation is a fundamental principle.\n- **Well-Posedness**: The problem provides all necessary data and a clear procedure to find a unique solution for the rebalance factors and the corrected fluxes.\n- **Objectivity**: The problem is stated using precise, objective, and quantitative language.\n\nThe problem is checked against the invalidity criteria:\n1.  **Scientific or Factual Unsoundness**: The premise is that the \"old\" calculation is not converged, i.e., $L_i^{\\text{old}} + A_i^{\\text{old}} \\neq Q_i$. This is not a flaw; it is the reason why an acceleration step is needed. The problem sets up a simplified model of CMR, where the net leakage term $L_i$ scales only with the local rebalance factor $R_i$. While a more rigorous treatment would model coupling to adjacent cells (requiring partial currents, which are not provided), the problem's explicit instruction to \"derive an expression for $R_1$ and $R_2$ in terms of $L_i^{\\text{old}}$, $A_i^{\\text{old}}$, and $Q_i$\" and the assumption that \"net leakage scales linearly with $R_i$\" legitimizes this simplified model within the context of the problem. It is a pedagogical simplification, not a scientific violation.\n2.  **Non-Formalizable or Irrelevant**: The problem is directly relevant to the stated topic and is fully formalizable.\n3.  **Incomplete or Contradictory Setup**: The problem is self-contained under the simplified model it implicitly defines.\n4.  **Unrealistic or Infeasible**: The orders of magnitude for fluxes and reaction rates are plausible for a reactor physics problem.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-structured and leads to a unique solution.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem requires a correct understanding and application of the CMR principle. The simplification makes it more direct but not trivial.\n7.  **Outside Scientific Verifiability**: The calculations are verifiable.\n\n**1.3. Verdict and Action**\n\nThe problem is **valid**. A solution will be provided.\n\n### Step 2: Solution Derivation and Calculation\n\nThe fundamental principle of Coarse-Mesh Rebalance (CMR) is to enforce particle conservation over large regions (coarse cells) of the problem domain. The steady-state, one-group neutron balance equation, integrated over a coarse cell $i$, states that the total rate of neutron loss (absorption plus net leakage) must equal the total rate of neutron production (source).\n$$ L_i + A_i = Q_i $$\nwhere $L_i$ is the net leakage rate from cell $i$, $A_i$ is the total absorption rate in cell $i$, and $Q_i$ is the total fixed source rate in cell $i$.\n\nThe provided \"old\" tallies from a single transport sweep do not satisfy this balance, indicating the solution is not yet converged.\nFor Cell $1$: $L_1^{\\text{old}} + A_1^{\\text{old}} = 1.2 \\times 10^6 + 3.8 \\times 10^6 = 5.0 \\times 10^6 \\neq Q_1 = 5.4 \\times 10^6$.\nFor Cell $2$: $L_2^{\\text{old}} + A_2^{\\text{old}} = 1.0 \\times 10^6 + 3.0 \\times 10^6 = 4.0 \\times 10^6 \\neq Q_2 = 4.6 \\times 10^6$.\n\nThe CMR method seeks to find a set of multiplicative rebalance factors $R_i$ for each coarse cell $i$ such that the rebalanced flux, $\\phi_i^{\\text{new}} = R_i \\phi_i^{\\text{old}}$, satisfies the balance equation.\n$$ L_i^{\\text{new}} + A_i^{\\text{new}} = Q_i $$\nSince reaction rates like absorption are linear integrals of the scalar flux over the cell volume, the new absorption rate scales directly with the rebalance factor:\n$$ A_i^{\\text{new}} = R_i A_i^{\\text{old}} $$\nThe problem states that the net leakage also scales linearly with $R_i$. This is a simplification; in a rigorous derivation, the leakage from cell $i$ would depend on $R_i$ and the factors of its neighbors, $R_j$. However, adhering to the problem's explicit assumptions and constraints, we model the new net leakage as:\n$$ L_i^{\\text{new}} = R_i L_i^{\\text{old}} $$\nThis simplified model uncouples the rebalance equations for each cell. Substituting the expressions for the new rates into the balance equation gives:\n$$ R_i L_i^{\\text{old}} + R_i A_i^{\\text{old}} = Q_i $$\nFactoring out $R_i$ yields:\n$$ R_i (L_i^{\\text{old}} + A_i^{\\text{old}}) = Q_i $$\nSolving for the rebalance factor $R_i$ gives the desired expression:\n$$ R_i = \\frac{Q_i}{L_i^{\\text{old}} + A_i^{\\text{old}}} $$\nWe now compute the numerical values for $R_1$ and $R_2$ using the given data.\n\nFor Cell $1$:\n$$ R_1 = \\frac{Q_1}{L_1^{\\text{old}} + A_1^{\\text{old}}} = \\frac{5.4 \\times 10^6}{1.2 \\times 10^6 + 3.8 \\times 10^6} = \\frac{5.4 \\times 10^6}{5.0 \\times 10^6} = 1.08 $$\nFor Cell $2$:\n$$ R_2 = \\frac{Q_2}{L_2^{\\text{old}} + A_2^{\\text{old}}} = \\frac{4.6 \\times 10^6}{1.0 \\times 10^6 + 3.0 \\times 10^6} = \\frac{4.6 \\times 10^6}{4.0 \\times 10^6} = 1.15 $$\nThe corrected fine-mesh flux profile $\\phi_{i,j}^{\\text{new}}$ is then found by applying these factors to the old fine-mesh fluxes: $\\phi_{i,j}^{\\text{new}} = R_i \\phi_{i,j}^{\\text{old}}$.\n\nFor Cell $1$ ($R_1 = 1.08$):\n- $\\phi_{1,1}^{\\text{new}} = 1.08 \\times (1.2 \\times 10^5) = 1.296 \\times 10^5$\n- $\\phi_{1,2}^{\\text{new}} = 1.08 \\times (1.15 \\times 10^5) = 1.242 \\times 10^5$\n- $\\phi_{1,3}^{\\text{new}} = 1.08 \\times (1.10 \\times 10^5) = 1.188 \\times 10^5$\n- $\\phi_{1,4}^{\\text{new}} = 1.08 \\times (1.05 \\times 10^5) = 1.134 \\times 10^5$\n- $\\phi_{1,5}^{\\text{new}} = 1.08 \\times (1.00 \\times 10^5) = 1.080 \\times 10^5$\n\nFor Cell $2$ ($R_2 = 1.15$):\n- $\\phi_{2,1}^{\\text{new}} = 1.15 \\times (9.5 \\times 10^4) = 1.0925 \\times 10^5$\n- $\\phi_{2,2}^{\\text{new}} = 1.15 \\times (9.0 \\times 10^4) = 1.035 \\times 10^5$\n- $\\phi_{2,3}^{\\text{new}} = 1.15 \\times (8.5 \\times 10^4) = 9.775 \\times 10^4$\n- $\\phi_{2,4}^{\\text{new}} = 1.15 \\times (8.0 \\times 10^4) = 9.200 \\times 10^4$\n- $\\phi_{2,5}^{\\text{new}} = 1.15 \\times (7.5 \\times 10^4) = 8.625 \\times 10^4$\n\nThe problem requires the answers to be rounded to four significant figures.\n- $R_1 = 1.080$\n- $R_2 = 1.150$\n- $\\phi_{1,1}^{\\text{new}} = 1.296 \\times 10^5$\n- $\\phi_{1,2}^{\\text{new}} = 1.242 \\times 10^5$\n- $\\phi_{1,3}^{\\text{new}} = 1.188 \\times 10^5$\n- $\\phi_{1,4}^{\\text{new}} = 1.134 \\times 10^5$\n- $\\phi_{1,5}^{\\text{new}} = 1.080 \\times 10^5$\n- $\\phi_{2,1}^{\\text{new}} = 1.0925 \\times 10^5 \\approx 1.093 \\times 10^5$\n- $\\phi_{2,2}^{\\text{new}} = 1.035 \\times 10^5$\n- $\\phi_{2,3}^{\\text{new}} = 9.775 \\times 10^4$\n- $\\phi_{2,4}^{\\text{new}} = 9.200 \\times 10^4$\n- $\\phi_{2,5}^{\\text{new}} = 8.625 \\times 10^4$\n\nThe final answer will be presented as a single row vector containing these $12$ values in the specified order.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.080  1.150  1.296 \\times 10^5  1.242 \\times 10^5  1.188 \\times 10^5  1.134 \\times 10^5  1.080 \\times 10^5  1.093 \\times 10^5  1.035 \\times 10^5  9.775 \\times 10^4  9.200 \\times 10^4  8.625 \\times 10^4 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Now that you understand how to apply a CMR step, this practice explores *why* it is such an effective accelerator. Using a simplified diffusion-limit model, you will analytically derive the geometric convergence rates for source iteration both with and without CMR, allowing you to quantify the expected reduction in the number of iterations. This exercise provides critical insight by linking the physical properties of a system and the coarse-mesh structure directly to the performance of the acceleration scheme .",
            "id": "4217242",
            "problem": "Consider a one-group, isotropically scattering, discrete ordinates ($S_N$) transport model in a one-dimensional slab of thickness $L$ with vacuum boundary conditions at $x=0$ and $x=L$. The total macroscopic cross section is $\\Sigma_t$, the macroscopic scattering cross section is $\\Sigma_s$, and the scattering ratio is $c = \\Sigma_s/\\Sigma_t$. Source iteration is used to converge the scattering source, yielding a geometric error reduction per iteration characterized by a spectral radius $g \\in (0,1)$ associated with the dominant spatial error mode.\n\nA Coarse-Mesh Rebalance (CMR) acceleration step is applied on a partition of the slab into $M$ equal coarse meshes (each of length $\\ell_c = L/M$). The CMR step enforces coarse-mesh balance constraints that effectively eliminate the longest-wavelength error components within each coarse mesh and thereby change the dominant error mode controlling the geometric convergence factor.\n\nUsing the diffusion-limit approximation based on the first-order spherical harmonics (P1) closure and Fourier-mode analysis on a uniform mesh, derive the expressions for the geometric convergence factor without rebalance, $g_{\\text{no}}$, and with CMR, $g_{\\text{cmr}}$, in terms of the transport parameters and the wave number $k$ of the dominant surviving mode. Assume the diffusion coefficient is $D \\approx 1/(3\\Sigma_t)$, and that the resolvent of the streaming-plus-collision operator acting on a spatial Fourier mode of wave number $k$ can be approximated by a factor of the form $1/(1 + \\beta k^2)$ with $\\beta = D/\\Sigma_t$. Under vacuum boundary conditions, take the dominant global mode without rebalance to have wave number $k_1 = \\pi/L$, and the dominant surviving mode with CMR to have wave number $k_c = \\pi/\\ell_c$.\n\nGiven the following parameters:\n- $\\Sigma_t = 1.0 \\text{ cm}^{-1}$\n- $c = 0.98$\n- $L = 60 \\text{ cm}$\n- $M = 6$ (so $\\ell_c = 10 \\text{ cm}$)\n\ncompute the iteration count reduction factor, defined as the ratio of iteration counts required to achieve the same error reduction target when using source iteration without rebalance versus with CMR, assuming both processes are governed by geometric convergence with the respective spectral radii. Express this ratio in terms of the logarithms of the geometric convergence factors and evaluate it numerically. Provide your final answer as a unitless decimal, rounded to four significant figures.",
            "solution": "### Step 1: Extract Givens\n-   Model: One-group, isotropically scattering, discrete ordinates ($S_N$) transport.\n-   Geometry: One-dimensional slab of thickness $L$.\n-   Boundary Conditions: Vacuum at $x=0$ and $x=L$.\n-   Total macroscopic cross section: $\\Sigma_t$.\n-   Macroscopic scattering cross section: $\\Sigma_s$.\n-   Scattering ratio: $c = \\Sigma_s/\\Sigma_t$.\n-   Iteration method: Source iteration with a geometric error reduction per iteration characterized by a spectral radius $g \\in (0,1)$.\n-   Acceleration: Coarse-Mesh Rebalance (CMR) on a partition of the slab into $M$ equal coarse meshes.\n-   Coarse-mesh length: $\\ell_c = L/M$.\n-   Approximation: Diffusion-limit approximation (P1 closure) with Fourier-mode analysis.\n-   Diffusion coefficient: $D \\approx 1/(3\\Sigma_t)$.\n-   Resolvent approximation: The resolvent of the streaming-plus-collision operator acting on a Fourier mode of wave number $k$ is approximated by a factor of the form $1/(1 + \\beta k^2)$ with $\\beta = D/\\Sigma_t$.\n-   Dominant mode wave number without rebalance: $k_1 = \\pi/L$.\n-   Dominant surviving mode wave number with CMR: $k_c = \\pi/\\ell_c$.\n-   Given parameters:\n    -   $\\Sigma_t = 1.0 \\text{ cm}^{-1}$\n    -   $c = 0.98$\n    -   $L = 60 \\text{ cm}$\n    -   $M = 6$\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded, well-posed, and objective. It describes a standard problem in the field of numerical methods for neutron transport, specifically investigating the performance of Coarse-Mesh Rebalance (CMR) acceleration. The use of a one-group, one-dimensional model with P1/diffusion and Fourier analysis is a common and valid simplification for deriving analytical expressions for convergence rates. The given parameters are physically reasonable for a simplified reactor physics problem. The assumptions about the dominant error modes are standard for this type of analysis. The problem is self-contained and provides all necessary information and relations to derive the solution. There are no contradictions, ambiguities, or scientifically unsound premises.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe source iteration method for the one-group transport equation can be written abstractly as $\\mathcal{L}\\psi^{(j+1)} = \\mathcal{S}\\psi^{(j)} + Q_{ext}$, where $\\psi^{(j)}$ is the angular flux at iteration $j$, $\\mathcal{L}$ is the streaming-plus-collision operator, $\\mathcal{S}$ is the scattering operator, and $Q_{ext}$ is the external source. The error $\\epsilon^{(j)}$ propagates according to $\\epsilon^{(j+1)} = \\mathcal{L}^{-1}\\mathcal{S}\\epsilon^{(j)}$. The asymptotic convergence rate is governed by the spectral radius of the iteration operator $\\mathcal{L}^{-1}\\mathcal{S}$.\n\nWe use the P1 approximation, which leads to the diffusion equation. For source iteration on the diffusion equation, the corresponding scheme for the scalar flux $\\phi$ is:\n$$ (-\\nabla \\cdot D \\nabla + \\Sigma_t) \\phi^{(j+1)}(x) = \\Sigma_s \\phi^{(j)}(x) + Q_{ext}(x) $$\nIn a one-dimensional slab, this becomes:\n$$ \\left(-D \\frac{d^2}{dx^2} + \\Sigma_t\\right) \\phi^{(j+1)}(x) = \\Sigma_s \\phi^{(j)}(x) + Q_{ext}(x) $$\nThe error $\\epsilon^{(j)}(x) = \\phi(x) - \\phi^{(j)}(x)$ satisfies the homogeneous equation:\n$$ \\left(-D \\frac{d^2}{dx^2} + \\Sigma_t\\right) \\epsilon^{(j+1)}(x) = \\Sigma_s \\epsilon^{(j)}(x) $$\nWe perform a Fourier analysis by considering an error mode of the form $\\epsilon(x) \\propto \\exp(ikx)$, where $k$ is the wave number. Substituting this form into the error equation, the differential operator $\\frac{d^2}{dx^2}$ becomes multiplication by $-k^2$.\n$$ (Dk^2 + \\Sigma_t) \\tilde{\\epsilon}^{(j+1)}(k) = \\Sigma_s \\tilde{\\epsilon}^{(j)}(k) $$\nThe amplification factor for the spatial mode with wave number $k$ is the ratio of the error mode amplitudes in successive iterations:\n$$ g(k) = \\frac{\\tilde{\\epsilon}^{(j+1)}(k)}{\\tilde{\\epsilon}^{(j)}(k)} = \\frac{\\Sigma_s}{Dk^2 + \\Sigma_t} $$\nUsing the given definitions $c = \\Sigma_s/\\Sigma_t$ and the problem statement's guidance to use $\\beta = D/\\Sigma_t$, we can rewrite the amplification factor as:\n$$ g(k) = \\frac{c\\Sigma_t}{\\Sigma_t(1 + Dk^2/\\Sigma_t)} = \\frac{c}{1 + (D/\\Sigma_t)k^2} = \\frac{c}{1 + \\beta k^2} $$\nThis expression for $g(k)$ matches the structure implied by the problem statement. The overall geometric convergence factor is the spectral radius, which is the maximum value of $g(k)$ over all permissible wave numbers $k$ for the given boundary conditions and problem setup.\n\n**Without Rebalance:**\nIn the unaccelerated source iteration, the slowest-converging error mode is the one with the longest wavelength that fits the domain. The problem specifies this dominant mode corresponds to a wave number $k_1 = \\pi/L$. The geometric convergence factor without rebalance, $g_{\\text{no}}$, is thus:\n$$ g_{\\text{no}} = g(k_1) = \\frac{c}{1 + \\beta k_1^2} = \\frac{c}{1 + \\beta (\\pi/L)^2} $$\n\n**With Coarse-Mesh Rebalance (CMR):**\nCMR acceleration is designed to eliminate the low-frequency (long-wavelength) error components. The dominant error mode that survives is no longer the fundamental mode of the whole domain, but rather the fundamental mode within a single coarse mesh. The problem specifies this corresponds to a wave number $k_c = \\pi/\\ell_c$. The geometric convergence factor with CMR, $g_{\\text{cmr}}$, is:\n$$ g_{\\text{cmr}} = g(k_c) = \\frac{c}{1 + \\beta k_c^2} = \\frac{c}{1 + \\beta (\\pi/\\ell_c)^2} $$\n\n**Iteration Count Reduction Factor:**\nThe number of iterations $N$ required to reduce the error by a certain factor is inversely proportional to the natural logarithm of the spectral radius, i.e., $N \\propto 1/|\\ln(g)| = -1/\\ln(g)$. Let $N_{\\text{no}}$ and $N_{\\text{cmr}}$ be the number of iterations without and with rebalance, respectively. To achieve the same error reduction target, we have:\n$$ (g_{\\text{no}})^{N_{\\text{no}}} = (g_{\\text{cmr}})^{N_{\\text{cmr}}} $$\nTaking the natural logarithm of both sides:\n$$ N_{\\text{no}} \\ln(g_{\\text{no}}) = N_{\\text{cmr}} \\ln(g_{\\text{cmr}}) $$\nThe iteration count reduction factor is defined as the ratio $R = N_{\\text{no}}/N_{\\text{cmr}}$:\n$$ R = \\frac{N_{\\text{no}}}{N_{\\text{cmr}}} = \\frac{\\ln(g_{\\text{cmr}})}{\\ln(g_{\\text{no}})} $$\n\n**Numerical Evaluation:**\nWe are given the following parameters:\n- $\\Sigma_t = 1.0 \\text{ cm}^{-1}$\n- $c = 0.98$\n- $L = 60 \\text{ cm}$\n- $M = 6$\n\nFrom these, we calculate the required quantities:\n- Coarse-mesh length: $\\ell_c = L/M = 60 \\text{ cm} / 6 = 10 \\text{ cm}$\n- Diffusion coefficient: $D \\approx 1/(3\\Sigma_t) = 1/(3 \\times 1.0 \\text{ cm}^{-1}) = 1/3 \\text{ cm}$\n- Parameter $\\beta$: $\\beta = D/\\Sigma_t = (1/3 \\text{ cm}) / (1.0 \\text{ cm}^{-1}) = 1/3 \\text{ cm}^2$\n\nNext, we calculate the wave numbers and their squares:\n- $k_1 = \\pi/L = \\pi/60 \\text{ cm}^{-1} \\implies k_1^2 = \\pi^2/3600 \\text{ cm}^{-2}$\n- $k_c = \\pi/\\ell_c = \\pi/10 \\text{ cm}^{-1} \\implies k_c^2 = \\pi^2/100 \\text{ cm}^{-2}$\n\nNow we compute the geometric convergence factors:\n$$ g_{\\text{no}} = \\frac{0.98}{1 + (\\frac{1}{3} \\text{ cm}^2) (\\frac{\\pi^2}{3600} \\text{ cm}^{-2})} = \\frac{0.98}{1 + \\frac{\\pi^2}{10800}} \\approx \\frac{0.98}{1 + 0.00091385} \\approx 0.9791054 $$\n$$ g_{\\text{cmr}} = \\frac{0.98}{1 + (\\frac{1}{3} \\text{ cm}^2) (\\frac{\\pi^2}{100} \\text{ cm}^{-2})} = \\frac{0.98}{1 + \\frac{\\pi^2}{300}} \\approx \\frac{0.98}{1 + 0.0328987} \\approx 0.9487854 $$\n\nFinally, we compute the iteration count reduction factor $R$:\n$$ R = \\frac{\\ln(g_{\\text{cmr}})}{\\ln(g_{\\text{no}})} = \\frac{\\ln(0.9487854)}{\\ln(0.9791054)} \\approx \\frac{-0.0525649}{-0.0211114} \\approx 2.490022 $$\nRounding to four significant figures, the iteration count reduction factor is $2.490$.",
            "answer": "$$\\boxed{2.490}$$"
        },
        {
            "introduction": "While CMR is powerful, its undamped application can lead to numerical instability, particularly in systems with low absorption and strong inter-cell coupling. This exercise explores the conditions that cause such over-correction and oscillatory behavior at the coarse-mesh level. You will analyze various mathematically justified damping strategies, developing an understanding of how to ensure the stability and convergence of the rebalance iteration in practical scenarios .",
            "id": "4217263",
            "problem": "Consider a steady-state neutron transport calculation in a heterogeneous reactor core that is accelerated by Coarse-Mesh Rebalance (CMR). The within-group iterate without rebalancing leaves a coarse-mesh balance residual in each coarse cell, defined as the difference between the total integrated neutron production and the sum of absorption and net leakage out of the coarse cell. The CMR applies a cellwise multiplicative correction factor $R_c$ to the scalar flux in coarse cell $c$ to reduce these residuals on subsequent iterations. Assume that the remaining error after the within-group solve is dominated by low-frequency modes that couple neighboring coarse cells through leakage, and that the coarse-mesh balance residual responds approximately linearly to small multiplicative changes in the flux.\n\nFrom first principles of neutron balance and linearization of the residual with respect to multiplicative flux perturbations, analyze the conditions under which an undamped application of $R_c$ can over-correct the residual and induce oscillatory behavior between iterations at the coarse-mesh level. Then, formulate a mathematically justified damping strategy for $R_c$ that guarantees convergence of the coarse-mesh residual under these conditions, and state the stability condition on the damping parameter in terms of the spectrum of the effective coarse-balance operator that maps multiplicative corrections to residual reduction.\n\nSelect all options that correctly characterize both the circumstances leading to oscillations and a sound damping strategy.\n\nA. In optically thin coarse meshes with strong inter-cell coupling and a scattering ratio close to $1$, the effective coarse-balance operator can have a largest eigenvalue $\\lambda_{\\max}$ exceeding $2$. In such cases, an undamped rebalance step can overshoot and flip the sign of the dominant residual mode, causing iteration-to-iteration oscillations. Damping via linear under-relaxation,\n$R_c^{\\mathrm{new}} = 1 + \\omega \\left(R_c - 1\\right)$ with $0  \\omega  \\frac{2}{\\lambda_{\\max}}$,\nguarantees that the spectral radius of the coarse-level error amplifier is less than $1$ and hence removes oscillations.\n\nB. Oscillations are most likely in highly absorbing, optically thick meshes where inter-cell coupling is weak and the largest eigenvalue of the effective coarse-balance operator satisfies $\\lambda_{\\max}  1$. In that regime, using an over-relaxation factor $\\omega > 1$ in\n$R_c^{\\mathrm{new}} = 1 + \\omega \\left(R_c - 1\\right)$\nboth avoids oscillations and improves convergence.\n\nC. A multiplicative damping of the form $R_c^{\\mathrm{new}} = \\left(R_c\\right)^{\\alpha}$ with $0  \\alpha  1$ is, to first order in the size of the correction, equivalent to linear under-relaxation of the rebalance increment. The stability condition can be expressed as $|1 - \\alpha \\lambda|  1$ for all eigenvalues $\\lambda$ of the effective coarse-balance operator, which can be enforced by choosing $\\alpha$ so that $0  \\alpha  \\frac{2}{\\lambda_{\\max}}$.\n\nD. Oscillations in $R_c$ arise only in time-dependent problems due to time discretization; in steady-state source iteration with CMR they cannot occur. Therefore, no damping strategy is necessary in steady-state CMR.\n\nE. A practical surrogate for explicit under-relaxation is to cap the per-iteration spatial variation of rebalance factors by enforcing a bound $|R_c - 1| \\le \\delta$ for some chosen $\\delta > 0$. Interpreting the cap as an adaptive effective damping, one can select $\\delta$ so that the induced effective relaxation parameter $\\omega_{\\mathrm{eff}} = \\min\\!\\left(1, \\frac{\\delta}{|R_c - 1|}\\right)$ satisfies $0  \\omega_{\\mathrm{eff}}  \\frac{2}{\\lambda_{\\max}}$, which suppresses oscillations of the coarse residual.",
            "solution": "The user has provided a problem statement regarding Coarse-Mesh Rebalance (CMR) acceleration for steady-state neutron transport calculations and asks to identify correct statements about the cause of oscillations and appropriate damping strategies.\n\n### Step 1: Extract Givens\n- **Context**: Steady-state neutron transport calculation in a heterogeneous reactor core.\n- **Method**: Coarse-Mesh Rebalance (CMR) acceleration.\n- **Coarse-Mesh Residual**: Defined for each coarse cell $c$ as the difference between total integrated neutron production and the sum of absorption and net leakage out of the coarse cell.\n- **CMR Correction**: A cellwise multiplicative factor $R_c$ is applied to the scalar flux in coarse cell $c$.\n- **Assumption 1**: The error remaining after the within-group solve is dominated by low-frequency modes that couple neighboring coarse cells through leakage.\n- **Assumption 2**: The coarse-mesh balance residual responds approximately linearly to small multiplicative changes in the flux.\n- **Question**: Analyze conditions for undamped CMR to cause over-correction and oscillations. Formulate a damping strategy with its stability condition in terms of the spectrum of the effective coarse-balance operator.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded in the established field of numerical methods for nuclear reactor analysis. Coarse-Mesh Rebalance is a standard and well-documented acceleration technique. The concepts used—neutron balance, residuals, leakage, spectral analysis of iterative methods, and linearization—are all fundamental to the discipline. The problem is well-posed; it asks for an analysis of a known numerical instability and its resolution, which has a definite theoretical basis. The language is objective and technical. The setup is self-contained and consistent, providing the necessary physical and mathematical assumptions (low-frequency error dominance, linear response) to proceed with a formal analysis. The scenario described (oscillations in optically thin, high-scattering regions) is physically realistic and a known challenge for CMR methods. The problem is not trivial, as it requires applying principles of numerical linear algebra to the physics of neutron transport.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A full derivation and analysis will be performed.\n\n### Principle-Based Derivation\nLet $\\vec{\\rho}$ be the vector of coarse-mesh residuals after a within-group transport sweep. The goal of CMR is to find a vector of multiplicative factors $\\vec{R}$ that, when applied to the flux, will drive the next residual vector to zero. Let $\\vec{f}$ be the vector of fractional corrections, such that $R_c = 1 + f_c$.\n\nBased on the problem's assumption of a linear response, the change in the residual vector $\\Delta\\vec{\\rho}$ resulting from applying the corrections $\\vec{f}$ can be modeled as:\n$$ \\Delta\\vec{\\rho} \\approx -\\mathbf{A}_{\\text{true}} \\vec{f} $$\nwhere $\\mathbf{A}_{\\text{true}}$ is the true coarse-mesh operator that maps the fractional flux corrections to the resulting reduction in the residual. This operator represents the exact response of the underlying transport equation on the coarse mesh.\n\nAn undamped CMR step calculates the correction vector $\\vec{f}$ by solving a simplified, approximate version of the balance equation. This is equivalent to assuming an approximate response operator, $\\mathbf{A}_{\\text{approx}}$, and demanding that the *predicted* new residual becomes zero:\n$$ \\vec{\\rho}_{\\text{predicted new}} = \\vec{\\rho}_{\\text{old}} - \\mathbf{A}_{\\text{approx}} \\vec{f} = \\vec{0} $$\nThis yields the undamped correction:\n$$ \\vec{f} = \\mathbf{A}_{\\text{approx}}^{-1} \\vec{\\rho}_{\\text{old}} $$\nThe operator $\\mathbf{A}_{\\text{approx}}$ is typically derived from a lower-order model, like diffusion theory, which is computationally cheaper to invert than the full transport response operator.\n\nThe *actual* new residual after applying this correction $\\vec{f}$ is determined by the true operator $\\mathbf{A}_{\\text{true}}$:\n$$ \\vec{\\rho}_{\\text{new}} = \\vec{\\rho}_{\\text{old}} - \\mathbf{A}_{\\text{true}} \\vec{f} = \\vec{\\rho}_{\\text{old}} - \\mathbf{A}_{\\text{true}} \\left( \\mathbf{A}_{\\text{approx}}^{-1} \\vec{\\rho}_{\\text{old}} \\right) $$\nThis can be written as a fixed-point iteration on the residual vector:\n$$ \\vec{\\rho}_{\\text{new}} = \\left( \\mathbf{I} - \\mathbf{A}_{\\text{true}} \\mathbf{A}_{\\text{approx}}^{-1} \\right) \\vec{\\rho}_{\\text{old}} $$\nLet $\\mathbf{P} = \\mathbf{A}_{\\text{true}} \\mathbf{A}_{\\text{approx}}^{-1}$. The iteration matrix for the residual is $\\mathbf{E} = \\mathbf{I} - \\mathbf{P}$. The iteration converges if and only if the spectral radius of the iteration matrix $\\mathbf{E}$ is less than $1$, i.e., $\\rho(\\mathbf{E})  1$.\n\nThe eigenvalues of $\\mathbf{E}$, denoted $\\mu_i$, are related to the eigenvalues of $\\mathbf{P}$, denoted $\\lambda_i$, by $\\mu_i = 1 - \\lambda_i$. The condition for convergence is $|\\mu_i| = |1 - \\lambda_i|  1$ for all $i$. The eigenvalues $\\lambda_i$ of $\\mathbf{P}$ are typically real and positive for neutron balance problems. The condition thus simplifies to:\n$$ -1  1 - \\lambda_i  1 \\implies 0  \\lambda_i  2 $$\nIf the largest eigenvalue, $\\lambda_{\\max}$, of the operator $\\mathbf{P} = \\mathbf{A}_{\\text{true}} \\mathbf{A}_{\\text{approx}}^{-1}$ exceeds $2$, then its corresponding eigenvalue $\\mu_{\\max} = 1 - \\lambda_{\\max}$ will be less than $-1$. The corresponding eigenmode of the residual will grow in magnitude and change sign at each iteration, leading to oscillatory divergence.\n\nThis over-correction ($\\lambda_{\\max}  2$) occurs when the approximate operator $\\mathbf{A}_{\\text{approx}}$ significantly underestimates the true response $\\mathbf{A}_{\\text{true}}$. This is characteristic of physical situations where the low-order diffusion model used for $\\mathbf{A}_{\\text{approx}}$ is a poor approximation of the higher-order transport physics. Such conditions include:\n1.  **Optically thin coarse meshes**: The cell dimensions are small compared to the neutron mean free path.\n2.  **High scattering ratio**: The scattering cross section is much larger than the absorption cross section, $\\Sigma_s \\gg \\Sigma_a$, or the scattering ratio $c = \\Sigma_s/\\Sigma_t \\approx 1$.\nIn these cases, neutrons can stream across multiple coarse cells without interaction, leading to strong inter-cell coupling that the local diffusion model cannot capture accurately.\n\nTo stabilize the iteration, a damping or under-relaxation strategy is introduced. Instead of applying the full correction $\\vec{f}$, a scaled correction $\\vec{f}_{\\text{new}} = \\omega \\vec{f}$ is used, where $\\omega$ is a relaxation parameter.\nThis corresponds to updating the rebalance factors as:\n$$ R_{c}^{\\text{new}} - 1 = \\omega (R_{c}^{\\text{undamped}} - 1) \\implies R_{c}^{\\text{new}} = 1 + \\omega(R_{c}^{\\text{undamped}} - 1) $$\nThe residual iteration becomes:\n$$ \\vec{\\rho}_{\\text{new}} = (\\mathbf{I} - \\omega \\mathbf{P}) \\vec{\\rho}_{\\text{old}} $$\nThe new iteration matrix is $\\mathbf{E}_{\\omega} = \\mathbf{I} - \\omega \\mathbf{P}$, with eigenvalues $\\mu_i(\\omega) = 1 - \\omega \\lambda_i$. The stability condition $|1 - \\omega \\lambda_i|  1$ requires:\n$$ 0  \\omega \\lambda_i  2 $$\nTo ensure this for all eigenvalues, the condition must hold for $\\lambda_{\\max}$. This gives the stability criterion for the damping parameter $\\omega$:\n$$ 0  \\omega  \\frac{2}{\\lambda_{\\max}} $$\nIf $\\lambda_{\\max}  2$, this necessitates under-relaxation ($0  \\omega  1$) to guarantee convergence.\n\n### Option-by-Option Analysis\n\n**A. In optically thin coarse meshes with strong inter-cell coupling and a scattering ratio close to $1$, the effective coarse-balance operator can have a largest eigenvalue $\\lambda_{\\max}$ exceeding $2$. In such cases, an undamped rebalance step can overshoot and flip the sign of the dominant residual mode, causing iteration-to-iteration oscillations. Damping via linear under-relaxation, $R_c^{\\mathrm{new}} = 1 + \\omega \\left(R_c - 1\\right)$ with $0  \\omega  \\frac{2}{\\lambda_{\\max}}$, guarantees that the spectral radius of the coarse-level error amplifier is less than $1$ and hence removes oscillations.**\nThis option correctly identifies the physical conditions (optically thin, high scattering) that lead to instability. It correctly states the mathematical condition for oscillatory divergence, $\\lambda_{\\max} > 2$, where $\\lambda_{\\max}$ is the largest eigenvalue of the effective iteration operator $\\mathbf{P} = \\mathbf{A}_{\\text{true}}\\mathbf{A}_{\\text{approx}}^{-1}$. It provides the correct formula for linear under-relaxation and the correct stability condition on the parameter $\\omega$. The conclusion that this strategy guarantees a spectral radius less than $1$ is accurate.\n**Verdict: Correct**\n\n**B. Oscillations are most likely in highly absorbing, optically thick meshes where inter-cell coupling is weak and the largest eigenvalue of the effective coarse-balance operator satisfies $\\lambda_{\\max}  1$. In that regime, using an over-relaxation factor $\\omega > 1$ in $R_c^{\\mathrm{new}} = 1 + \\omega \\left(R_c - 1\\right)$ both avoids oscillations and improves convergence.**\nThis option describes the opposite physical regime. In optically thick, absorbing media, the diffusion approximation is generally accurate, so $\\mathbf{A}_{\\text{approx}} \\approx \\mathbf{A}_{\\text{true}}$, leading to eigenvalues $\\lambda_i$ of $\\mathbf{P}$ clustered around $1$. Oscillatory divergence is not the characteristic problem. If $\\lambda_{\\max}  1$, the undamped iteration is already convergent, and over-relaxation ($\\omega > 1$) could be used to accelerate it, not to \"avoid oscillations\" which are not present in the first place under these conditions. The premise is flawed.\n**Verdict: Incorrect**\n\n**C. A multiplicative damping of the form $R_c^{\\mathrm{new}} = \\left(R_c\\right)^{\\alpha}$ with $0  \\alpha  1$ is, to first order in the size of the correction, equivalent to linear under-relaxation of the rebalance increment. The stability condition can be expressed as $|1 - \\alpha \\lambda|  1$ for all eigenvalues $\\lambda$ of the effective coarse-balance operator, which can be enforced by choosing $\\alpha$ so that $0  \\alpha  \\frac{2}{\\lambda_{\\max}}$.**\nLet $R_c = 1 + f_c$, where the correction $f_c$ is small. A first-order Taylor expansion gives $R_c^{\\mathrm{new}} = (1 + f_c)^{\\alpha} \\approx 1 + \\alpha f_c$. The linearly relaxed correction is $1 + \\omega f_c$. Thus, to first order, this multiplicative damping is equivalent to linear relaxation with $\\omega = \\alpha$. The stability analysis for linear relaxation applies directly, leading to the condition $|1 - \\alpha \\lambda_i|  1$ for the eigenvalues $\\lambda_i$ of $\\mathbf{P}$. This in turn gives the stability bound $0  \\alpha  2/\\lambda_{\\max}$. The statement is a valid and insightful analysis of an alternative damping form.\n**Verdict: Correct**\n\n**D. Oscillations in $R_c$ arise only in time-dependent problems due to time discretization; in steady-state source iteration with CMR they cannot occur. Therefore, no damping strategy is necessary in steady-state CMR.**\nThis statement is fundamentally incorrect. Oscillatory behavior is a classic feature of many steady-state iterative numerical methods (e.g., Jacobi, Gauss-Seidel, SOR) when the iteration matrix has eigenvalues with negative real parts less than $-1$. As derived above, this instability can and does occur in steady-state CMR under specific, well-understood physical and numerical conditions. The need for damping strategies in steady-state CMR is well-established in practice.\n**Verdict: Incorrect**\n\n**E. A practical surrogate for explicit under-relaxation is to cap the per-iteration spatial variation of rebalance factors by enforcing a bound $|R_c - 1| \\le \\delta$ for some chosen $\\delta > 0$. Interpreting the cap as an adaptive effective damping, one can select $\\delta$ so that the induced effective relaxation parameter $\\omega_{\\mathrm{eff}} = \\min\\!\\left(1, \\frac{\\delta}{|R_c - 1|}\\right)$ satisfies $0  \\omega_{\\mathrm{eff}}  \\frac{2}{\\lambda_{\\max}}$, which suppresses oscillations of the coarse residual.**\nCapping the rebalance factors is a common heuristic to prevent non-physically large flux changes and improve robustness. The analysis provided is a sound mathematical interpretation of this heuristic. The undamped correction is $f_c^{\\text{undamped}} = R_c - 1$. The damped correction with the proposed effective relaxation is $f_c^{\\text{damped}} = \\omega_{\\mathrm{eff}} f_c^{\\text{undamped}}$.\n- If $|R_c - 1| \\le \\delta$, then $\\omega_{\\mathrm{eff}} = 1$, and $f_c^{\\text{damped}} = f_c^{\\text{undamped}}$ (no damping).\n- If $|R_c - 1| > \\delta$, then $\\omega_{\\mathrm{eff}} = \\delta / |R_c - 1|  1$, and $|f_c^{\\text{damped}}| = |\\frac{\\delta}{|R_c-1|}(R_c-1)| = \\delta$.\nThis perfectly describes the capping mechanism. This is an adaptive under-relaxation scheme: no damping for small corrections, but increasingly strong damping for large, potentially unstable corrections. By choosing a sufficiently small $\\delta$, one can ensure that the effective relaxation parameter $\\omega_{\\mathrm{eff}}$ is always within the stable range $0  \\omega_{\\mathrm{eff}}  2/\\lambda_{\\max}$, thus suppressing oscillations. The interpretation is correct and provides a formal justification for a practical method.\n**Verdict: Correct**",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}