{
    "hands_on_practices": [
        {
            "introduction": "本练习提供了一个直接的实践机会，让您应用粗网格重整（CMR）方法的核心原理。通过在一个简单的双单元板状几何中，利用给定的中子泄漏和吸收率计算结果，您将亲自推导并计算重整因子 $R_i$。这个过程清晰地展示了如何通过在粗网格上强制中子守恒，来修正一个尚未收敛的通量分布，这是理解CMR加速机制的基础步骤 。",
            "id": "4217226",
            "problem": "考虑一个总厚度为 $100$ $\\text{cm}$ 的一维 (1D) 均匀板，它被划分为两个宽度均为 $50$ $\\text{cm}$ 的等大粗网格单元。已对该板进行了一次单群、稳态输运计算，其两端均为真空边界条件。一次输运扫描已生成如下的粗网格单元统计量和细网格通量形状。在每个粗网格单元 $i \\in \\{1,2\\}$ 中，用 $L_i^{\\text{old}}$ 表示离开该单元的净泄漏率（在其边界上积分的向外表面流），用 $A_i^{\\text{old}}$ 表示在该单元体积上积分的吸收反应率，用 $Q_i$ 表示在该单元体积上积分的总固定源。这些统计量为：\n- 单元 $1$：$L_1^{\\text{old}} = 1.2 \\times 10^6$， $A_1^{\\text{old}} = 3.8 \\times 10^6$， $Q_1 = 5.4 \\times 10^6$。\n- 单元 $2$：$L_2^{\\text{old}} = 1.0 \\times 10^6$， $A_2^{\\text{old}} = 3.0 \\times 10^6$， $Q_2 = 4.6 \\times 10^6$。\n\n所有速率的单位都是中子/秒。在每个粗网格单元内，先前计算得到的、在五个宽度均为 $10$ $\\text{cm}$ 的等大细子单元上的细网格体积平均标量通量形状 $\\phi_{i,j}^{\\text{old}}$（单位为中子/平方厘米·秒）如下：\n- 单元 $1$（从左边界到交界面）：$\\phi_{1,1}^{\\text{old}} = 1.2 \\times 10^5$， $\\phi_{1,2}^{\\text{old}} = 1.15 \\times 10^5$， $\\phi_{1,3}^{\\text{old}} = 1.10 \\times 10^5$， $\\phi_{1,4}^{\\text{old}} = 1.05 \\times 10^5$， $\\phi_{1,5}^{\\text{old}} = 1.00 \\times 10^5$。\n- 单元 $2$（从交界面到右边界）：$\\phi_{2,1}^{\\text{old}} = 9.5 \\times 10^4$， $\\phi_{2,2}^{\\text{old}} = 9.0 \\times 10^4$， $\\phi_{2,3}^{\\text{old}} = 8.5 \\times 10^4$， $\\phi_{2,4}^{\\text{old}} = 8.0 \\times 10^4$， $\\phi_{2,5}^{\\text{old}} = 7.5 \\times 10^4$。\n\n使用粗网格重整 (CMR) 加速原理，假设一个乘性单元重整因子 $R_i$ 被应用于每个粗网格单元 $i$ 内的通量，使得单元内的每个反应率和净泄漏都与 $R_i$ 呈线性关系，而固定源 $Q_i$ 不变。从在每个粗网格单元上积分的稳态单群输运平衡（净泄漏加吸收等于单元内的固定源）出发，首先推导 $R_1$ 和 $R_2$ 关于 $L_i^{\\text{old}}$、$A_i^{\\text{old}}$ 和 $Q_i$ 的表达式。然后通过 $\\phi_{i,j}^{\\text{new}} = R_i \\, \\phi_{i,j}^{\\text{old}}$ 计算一次重整后修正的细网格通量分布 $\\phi_{i,j}^{\\text{new}}$。\n\n将所有修正后的通量值以中子/平方厘米·秒为单位表示，并将你的答案四舍五入到四位有效数字。提供一个单一的最终答案，该答案由一个行向量组成，按顺序包含 $R_1$、$R_2$，以及其后的十个修正后的细网格通量 $\\phi_{1,1}^{\\text{new}}, \\phi_{1,2}^{\\text{new}}, \\phi_{1,3}^{\\text{new}}, \\phi_{1,4}^{\\text{new}}, \\phi_{1,5}^{\\text{new}}, \\phi_{2,1}^{\\text{new}}, \\phi_{2,2}^{\\text{new}}, \\phi_{2,3}^{\\text{new}}, \\phi_{2,4}^{\\text{new}}, \\phi_{2,5}^{\\text{new}}$。",
            "solution": "用户想要解决一个粗网格重整 (CMR) 问题。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n- 几何：总厚度为 100 cm 的一维板。\n- 粗网格：2 个等宽的粗网格单元，每个 50 cm。\n- 边界条件：两端真空。\n- 物理：单群、稳态输运。\n- 单次输运扫描的统计量（用上标“old”表示）：\n  - 单元 $1$：\n    - 净泄漏率：$L_1^{\\text{old}} = 1.2 \\times 10^6$ 中子/秒。\n    - 吸收率：$A_1^{\\text{old}} = 3.8 \\times 10^6$ 中子/秒。\n    - 固定源：$Q_1 = 5.4 \\times 10^6$ 中子/秒。\n  - 单元 $2$：\n    - 净泄漏率：$L_2^{\\text{old}} = 1.0 \\times 10^6$ 中子/秒。\n    - 吸收率：$A_2^{\\text{old}} = 3.0 \\times 10^6$ 中子/秒。\n    - 固定源：$Q_2 = 4.6 \\times 10^6$ 中子/秒。\n- 细网格标量通量形状（旧）：每个粗网格单元内有 5 个宽度为 10 cm 的细子单元。\n  - 单元 1 通量 ($\\phi_{1,j}^{\\text{old}}$)：$1.2 \\times 10^5$, $1.15 \\times 10^5$, $1.10 \\times 10^5$, $1.05 \\times 10^5$, $1.00 \\times 10^5$ 中子/(cm$^2$ s)。\n  - 单元 2 通量 ($\\phi_{2,j}^{\\text{old}}$)：$9.5 \\times 10^4$, $9.0 \\times 10^4$, $8.5 \\times 10^4$, $8.0 \\times 10^4$, $7.5 \\times 10^4$ 中子/(cm$^2$ s)。\n- CMR 假设：施加一个单元常数重整因子 $R_i$，使得新通量为 $\\phi_i^{\\text{new}} = R_i \\phi_i^{\\text{old}}$。所有单元内反应率和净泄漏都假定与 $R_i$ 线性相关。固定源 $Q_i$ 是常数。\n- 任务：推导 $R_1$ 和 $R_2$ 的表达式，计算它们的值，并计算新的细网格通量分布 $\\phi_{i,j}^{\\text{new}} = R_i \\phi_{i,j}^{\\text{old}}$。\n\n**1.2. 使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于核反应堆分析数值方法这一成熟领域。粗网格重整 (CMR) 是迭代输运解的一种标准加速技术。粒子平衡方程是一项基本原理。\n- **适定性**：该问题提供了所有必要的数据和清晰的步骤，以找到重整因子和修正后通量的唯一解。\n- **客观性**：问题陈述使用了精确、客观和定量的语言。\n\n对照无效性标准检查问题：\n1.  **科学或事实不健全**：其前提是“旧”计算未收敛，即 $L_i^{\\text{old}} + A_i^{\\text{old}} \\neq Q_i$。这不是一个缺陷，而是需要加速步骤的原因。该问题建立了一个 CMR 的简化模型，其中净泄漏项 $L_i$ 仅与局部重整因子 $R_i$ 成比例。虽然更严格的处理会模型化与相邻单元的耦合（这需要部分流，而题目未提供），但问题中“推导 $R_1$ 和 $R_2$ 关于 $L_i^{\\text{old}}$、$A_i^{\\text{old}}$ 和 $Q_i$ 的表达式”的明确指令以及“净泄漏与 $R_i$ 线性相关”的假设，在问题背景下使这个简化模型合法化。这是一种教学上的简化，而非科学上的违背。\n2.  **不可形式化或不相关**：问题与所述主题直接相关，并且完全可以形式化。\n3.  **不完整或矛盾的设置**：在其隐含定义的简化模型下，该问题是自洽的。\n4.  **不切实际或不可行**：通量和反应率的数量级对于一个反应堆物理问题是合理的。\n5.  **不适定或结构不良**：问题结构良好，并能导出一个唯一解。\n6.  **伪深刻、琐碎或同义反复**：问题需要对 CMR 原理的正确理解和应用。简化使其更直接，但并非琐碎。\n7.  **超出科学可验证性**：计算是可验证的。\n\n**1.3. 结论和行动**\n\n该问题是**有效**的。将提供一个解答。\n\n### 步骤 2：解的推导与计算\n\n粗网格重整 (CMR) 的基本原理是在问题域的大区域（粗网格单元）上强制执行粒子守恒。在粗网格单元 $i$ 上积分的稳态单群中子平衡方程指出，中子损失总率（吸收加净泄漏）必须等于中子产生总率（源）。\n$$ L_i + A_i = Q_i $$\n其中 $L_i$ 是单元 $i$ 的净泄漏率，$A_i$ 是单元 $i$ 的总吸收率，$Q_i$ 是单元 $i$ 的总固定源率。\n\n单次输运扫描提供的“旧”统计量不满足此平衡，表明解尚未收敛。\n对于单元 1：$L_1^{\\text{old}} + A_1^{\\text{old}} = 1.2 \\times 10^6 + 3.8 \\times 10^6 = 5.0 \\times 10^6 \\neq Q_1 = 5.4 \\times 10^6$。\n对于单元 2：$L_2^{\\text{old}} + A_2^{\\text{old}} = 1.0 \\times 10^6 + 3.0 \\times 10^6 = 4.0 \\times 10^6 \\neq Q_2 = 4.6 \\times 10^6$。\n\nCMR 方法旨在为每个粗网格单元 $i$ 找到一组乘性重整因子 $R_i$，使得重整后的通量 $\\phi_i^{\\text{new}} = R_i \\phi_i^{\\text{old}}$ 满足平衡方程。\n$$ L_i^{\\text{new}} + A_i^{\\text{new}} = Q_i $$\n由于像吸收这样的反应率是标量通量在单元体积上的线性积分，新的吸收率与重整因子直接成比例：\n$$ A_i^{\\text{new}} = R_i A_i^{\\text{old}} $$\n问题指出净泄漏也与 $R_i$ 呈线性关系。这是一种简化；在严格的推导中，单元 $i$ 的泄漏将取决于 $R_i$ 及其相邻单元的因子 $R_j$。然而，遵循问题的明确假设和约束，我们将新的净泄漏模型化为：\n$$ L_i^{\\text{new}} = R_i L_i^{\\text{old}} $$\n这个简化的模型解耦了每个单元的重整方程。将新速率的表达式代入平衡方程得到：\n$$ R_i L_i^{\\text{old}} + R_i A_i^{\\text{old}} = Q_i $$\n提出因子 $R_i$ 得到：\n$$ R_i (L_i^{\\text{old}} + A_i^{\\text{old}}) = Q_i $$\n求解重整因子 $R_i$ 得到所需的表达式：\n$$ R_i = \\frac{Q_i}{L_i^{\\text{old}} + A_i^{\\text{old}}} $$\n现在我们使用给定的数据计算 $R_1$ 和 $R_2$ 的数值。\n\n对于单元 1：\n$$ R_1 = \\frac{Q_1}{L_1^{\\text{old}} + A_1^{\\text{old}}} = \\frac{5.4 \\times 10^6}{1.2 \\times 10^6 + 3.8 \\times 10^6} = \\frac{5.4 \\times 10^6}{5.0 \\times 10^6} = 1.08 $$\n对于单元 2：\n$$ R_2 = \\frac{Q_2}{L_2^{\\text{old}} + A_2^{\\text{old}}} = \\frac{4.6 \\times 10^6}{1.0 \\times 10^6 + 3.0 \\times 10^6} = \\frac{4.6 \\times 10^6}{4.0 \\times 10^6} = 1.15 $$\n然后通过将这些因子应用于旧的细网格通量来找到修正后的细网格通量分布 $\\phi_{i,j}^{\\text{new}}$：$\\phi_{i,j}^{\\text{new}} = R_i \\phi_{i,j}^{\\text{old}}$。\n\n对于单元 1（$R_1 = 1.08$）：\n- $\\phi_{1,1}^{\\text{new}} = 1.08 \\times (1.2 \\times 10^5) = 1.296 \\times 10^5$\n- $\\phi_{1,2}^{\\text{new}} = 1.08 \\times (1.15 \\times 10^5) = 1.242 \\times 10^5$\n- $\\phi_{1,3}^{\\text{new}} = 1.08 \\times (1.10 \\times 10^5) = 1.188 \\times 10^5$\n- $\\phi_{1,4}^{\\text{new}} = 1.08 \\times (1.05 \\times 10^5) = 1.134 \\times 10^5$\n- $\\phi_{1,5}^{\\text{new}} = 1.08 \\times (1.00 \\times 10^5) = 1.080 \\times 10^5$\n\n对于单元 2（$R_2 = 1.15$）：\n- $\\phi_{2,1}^{\\text{new}} = 1.15 \\times (9.5 \\times 10^4) = 1.0925 \\times 10^5$\n- $\\phi_{2,2}^{\\text{new}} = 1.15 \\times (9.0 \\times 10^4) = 1.035 \\times 10^5$\n- $\\phi_{2,3}^{\\text{new}} = 1.15 \\times (8.5 \\times 10^4) = 9.775 \\times 10^4$\n- $\\phi_{2,4}^{\\text{new}} = 1.15 \\times (8.0 \\times 10^4) = 9.200 \\times 10^4$\n- $\\phi_{2,5}^{\\text{new}} = 1.15 \\times (7.5 \\times 10^4) = 8.625 \\times 10^4$\n\n问题要求答案四舍五入到四位有效数字。\n- $R_1 = 1.080$\n- $R_2 = 1.150$\n- $\\phi_{1,1}^{\\text{new}} = 1.296 \\times 10^5$\n- $\\phi_{1,2}^{\\text{new}} = 1.242 \\times 10^5$\n- $\\phi_{1,3}^{\\text{new}} = 1.188 \\times 10^5$\n- $\\phi_{1,4}^{\\text{new}} = 1.134 \\times 10^5$\n- $\\phi_{1,5}^{\\text{new}} = 1.080 \\times 10^5$\n- $\\phi_{2,1}^{\\text{new}} = 1.0925 \\times 10^5 \\approx 1.093 \\times 10^5$\n- $\\phi_{2,2}^{\\text{new}} = 1.035 \\times 10^5$\n- $\\phi_{2,3}^{\\text{new}} = 9.775 \\times 10^4$\n- $\\phi_{2,4}^{\\text{new}} = 9.200 \\times 10^4$\n- $\\phi_{2,5}^{\\text{new}} = 8.625 \\times 10^4$\n\n最终答案将以一个包含这 12 个值的单个行向量的形式按指定顺序呈现。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.080  1.150  1.296 \\times 10^5  1.242 \\times 10^5  1.188 \\times 10^5  1.134 \\times 10^5  1.080 \\times 10^5  1.093 \\times 10^5  1.035 \\times 10^5  9.775 \\times 10^4  9.200 \\times 10^4  8.625 \\times 10^4 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在掌握了如何执行一次CMR修正之后，一个自然而然的问题是：这种方法究竟能带来多大的加速效果？本练习将引导您从理论层面回答这个问题。您将使用扩散近似和傅里叶模式分析，推导并比较有无CMR加速时迭代收敛因子，从而量化其性能增益。这项实践不仅能加深您对CMR为何有效的理解，还揭示了它是如何通过有效抑制长波误差模式来加速收敛的 。",
            "id": "4217242",
            "problem": "考虑一个厚度为 $L$ 的一维平板中的单群、各向同性散射、离散纵标(S_N)输运模型，其在 $x=0$ 和 $x=L$ 处具有真空边界条件。宏观总截面为 $\\Sigma_{t}$，宏观散射截面为 $\\Sigma_{s}$，散射比为 $c = \\Sigma_{s}/\\Sigma_{t}$。使用源迭代法来收敛散射源，每次迭代产生的几何误差衰减由与主导空间误差模式相关的谱半径 $g \\in (0,1)$ 来表征。\n\n在将平板划分为 $M$ 个等大的粗网格（每个长度为 $\\ell_{c} = L/M$）的基础上，应用一个粗网格重整(CMR)加速步骤。CMR步骤强制施加粗网格平衡约束，有效消除了每个粗网格内的最长波长误差分量，从而改变了控制几何收敛因子的主导误差模式。\n\n使用基于一阶球谐函数(P1)闭合的扩散极限近似和在均匀网格上的傅里叶模式分析，推导无重整时的几何收敛因子 $g_{\\text{no}}$ 和使用CMR时的几何收敛因子 $g_{\\text{cmr}}$ 的表达式，用输运参数和主导残余模式的波数 $k$ 表示。假设扩散系数为 $D \\approx 1/(3 \\Sigma_{t})$，并且作用于波数为 $k$ 的空间傅里叶模式的流-加-碰撞算子的预解式可以近似为一个形式为 $1/(1 + \\beta k^{2})$ 的因子，其中 $\\beta = D/\\Sigma_{t}$。在真空边界条件下，设无重整时的主导全局模式的波数量为 $k_{1} = \\pi/L$，使用CMR时的主导残余模式的波数量为 $k_{c} = \\pi/\\ell_{c}$。\n\n给定以下参数：\n- $\\Sigma_{t} = 1.0 \\,\\text{cm}^{-1}$，\n- $c = 0.98$，\n- $L = 60 \\,\\text{cm}$，\n- $M = 6$ (所以 $\\ell_{c} = 10 \\,\\text{cm}$)，\n\n计算迭代次数减少因子，其定义为在使用无重整的源迭代与使用CMR的源迭代时，达到相同误差衰减目标所需的迭代次数之比，假设两个过程都由各自谱半径的几何收敛所控制。用几何收敛因子的对数来表示这个比率，并对其进行数值计算。将最终答案以无单位小数的形式给出，并四舍五入到四位有效数字。",
            "solution": "### 步骤 1：提取已知条件\n-   模型：单群、各向同性散射、离散纵标($S_N$)输运。\n-   几何形状：厚度为 $L$ 的一维平板。\n-   边界条件：在 $x=0$ 和 $x=L$ 处为真空。\n-   宏观总截面：$\\Sigma_{t}$。\n-   宏观散射截面：$\\Sigma_{s}$。\n-   散射比：$c = \\Sigma_{s}/\\Sigma_{t}$。\n-   迭代方法：源迭代，每次迭代的几何误差衰减由谱半径 $g \\in (0,1)$ 表征。\n-   加速方法：在将平板划分为 $M$ 个等大粗网格的基础上进行粗网格重整(CMR)。\n-   粗网格长度：$\\ell_{c} = L/M$。\n-   近似：使用傅里叶模式分析的扩散极限近似(P1闭合)。\n-   扩散系数：$D \\approx 1/(3 \\Sigma_{t})$。\n-   预解式近似：作用于波数为 $k$ 的傅里叶模式的流-加-碰撞算子的预解式可近似为形式为 $1/(1 + \\beta k^{2})$ 的因子，其中 $\\beta = D/\\Sigma_{t}$。\n-   无重整时的主导模式波数：$k_{1} = \\pi/L$。\n-   使用CMR时的主导残余模式波数：$k_{c} = \\pi/\\ell_{c}$。\n-   给定参数：\n    -   $\\Sigma_{t} = 1.0 \\,\\text{cm}^{-1}$\n    -   $c = 0.98$\n    -   $L = 60 \\,\\text{cm}$\n    -   $M = 6$\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述具有科学依据，是适定的和客观的。它描述了中子输运数值方法领域的一个标准问题，特别是研究粗网格重整(CMR)加速的性能。使用单群、一维模型以及P1/扩散和傅里叶分析是推导收敛速率解析表达式的一种常见且有效的简化方法。对于一个简化的反应堆物理问题，给定的参数在物理上是合理的。关于主导误差模式的假设对于这类分析是标准的。问题是自洽的，并提供了推导解所需的所有必要信息和关系。不存在矛盾、歧义或不科学的前提。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供一个完整的、有理有据的解。\n\n### 解题推导\n单群输运方程的源迭代法可以抽象地写为 $\\mathcal{L}\\psi^{(j+1)} = \\mathcal{S}\\psi^{(j)} + Q_{ext}$，其中 $\\psi^{(j)}$ 是第 $j$ 次迭代时的角通量，$\\mathcal{L}$ 是流-加-碰撞算子，$\\mathcal{S}$ 是散射算子，$Q_{ext}$ 是外源。误差 $\\epsilon^{(j)}$ 根据 $\\epsilon^{(j+1)} = \\mathcal{L}^{-1}\\mathcal{S}\\epsilon^{(j)}$ 传播。渐近收敛率由迭代算子 $\\mathcal{L}^{-1}\\mathcal{S}$ 的谱半径决定。\n\n我们使用P1近似，这会导出扩散方程。对于扩散方程的源迭代，标量通量 $\\phi$ 的相应格式是：\n$$ (-\\nabla \\cdot D \\nabla + \\Sigma_t) \\phi^{(j+1)}(x) = \\Sigma_s \\phi^{(j)}(x) + Q_{ext}(x) $$\n在一维平板中，这变为：\n$$ \\left(-D \\frac{d^2}{dx^2} + \\Sigma_t\\right) \\phi^{(j+1)}(x) = \\Sigma_s \\phi^{(j)}(x) + Q_{ext}(x) $$\n误差 $\\epsilon^{(j)}(x) = \\phi(x) - \\phi^{(j)}(x)$ 满足齐次方程：\n$$ \\left(-D \\frac{d^2}{dx^2} + \\Sigma_t\\right) \\epsilon^{(j+1)}(x) = \\Sigma_s \\epsilon^{(j)}(x) $$\n我们通过考虑形式为 $\\epsilon(x) \\propto \\exp(ikx)$ 的误差模式来进行傅里叶分析，其中 $k$ 是波数。将此形式代入误差方程，微分算子 $\\frac{d^2}{dx^2}$ 变为乘以 $-k^2$。\n$$ (Dk^2 + \\Sigma_t) \\tilde{\\epsilon}^{(j+1)}(k) = \\Sigma_s \\tilde{\\epsilon}^{(j)}(k) $$\n波数为 $k$ 的空间模式的放大因子是连续迭代中误差模式振幅的比值：\n$$ g(k) = \\frac{\\tilde{\\epsilon}^{(j+1)}(k)}{\\tilde{\\epsilon}^{(j)}(k)} = \\frac{\\Sigma_s}{Dk^2 + \\Sigma_t} $$\n使用给定的定义 $c = \\Sigma_s/\\Sigma_t$ 和问题陈述中关于使用 $\\beta = D/\\Sigma_t$ 的指导，我们可以将放大因子重写为：\n$$ g(k) = \\frac{c\\Sigma_t}{\\Sigma_t(1 + Dk^2/\\Sigma_t)} = \\frac{c}{1 + (D/\\Sigma_t)k^2} = \\frac{c}{1 + \\beta k^2} $$\n$g(k)$ 的这个表达式与问题陈述所暗示的结构相匹配。总的几何收敛因子是谱半径，即对于给定的边界条件和问题设置，在所有允许的波数 $k$ 上 $g(k)$ 的最大值。\n\n**无重整情况：**\n在未加速的源迭代中，收敛最慢的误差模式是与区域匹配的最长波长的模式。问题指明这个主导模式对应的波数为 $k_1 = \\pi/L$。因此，无重整时的几何收敛因子 $g_{\\text{no}}$ 为：\n$$ g_{\\text{no}} = g(k_1) = \\frac{c}{1 + \\beta k_1^2} = \\frac{c}{1 + \\beta (\\pi/L)^2} $$\n\n**使用粗网格重整(CMR)的情况：**\nCMR加速旨在消除低频（长波长）误差分量。残余的主导误差模式不再是整个区域的基模，而是单个粗网格内的基模。问题指明这对应的波数为 $k_c = \\pi/\\ell_c$。使用CMR时的几何收敛因子 $g_{\\text{cmr}}$ 为：\n$$ g_{\\text{cmr}} = g(k_c) = \\frac{c}{1 + \\beta k_c^2} = \\frac{c}{1 + \\beta (\\pi/\\ell_c)^2} $$\n\n**迭代次数减少因子：**\n将误差减小某个因子所需的迭代次数 $N$ 与谱半径的自然对数成反比，即 $N \\propto 1/|\\ln(g)| = -1/\\ln(g)$。设 $N_{\\text{no}}$ 和 $N_{\\text{cmr}}$ 分别为无重整和有重整时的迭代次数。要达到相同的误差衰减目标，我们有：\n$$ (g_{\\text{no}})^{N_{\\text{no}}} = (g_{\\text{cmr}})^{N_{\\text{cmr}}} $$\n对两边取自然对数：\n$$ N_{\\text{no}} \\ln(g_{\\text{no}}) = N_{\\text{cmr}} \\ln(g_{\\text{cmr}}) $$\n迭代次数减少因子定义为比率 $R = N_{\\text{no}}/N_{\\text{cmr}}$：\n$$ R = \\frac{N_{\\text{no}}}{N_{\\text{cmr}}} = \\frac{\\ln(g_{\\text{cmr}})}{\\ln(g_{\\text{no}})} $$\n\n**数值计算：**\n我们有以下给定参数：\n- $\\Sigma_{t} = 1.0 \\, \\text{cm}^{-1}$\n- $c = 0.98$\n- $L = 60 \\, \\text{cm}$\n- $M = 6$\n\n根据这些，我们计算所需的量：\n- 粗网格长度：$\\ell_{c} = L/M = 60 \\, \\text{cm} / 6 = 10 \\, \\text{cm}$\n- 扩散系数：$D \\approx 1/(3 \\Sigma_{t}) = 1/(3 \\times 1.0 \\, \\text{cm}^{-1}) = 1/3 \\, \\text{cm}$\n- 参数 $\\beta$：$\\beta = D/\\Sigma_{t} = (1/3 \\, \\text{cm}) / (1.0 \\, \\text{cm}^{-1}) = 1/3 \\, \\text{cm}^2$\n\n接下来，我们计算波数及其平方：\n- $k_1 = \\pi/L = \\pi/60 \\, \\text{cm}^{-1} \\implies k_1^2 = \\pi^2/3600 \\, \\text{cm}^{-2}$\n- $k_c = \\pi/\\ell_c = \\pi/10 \\, \\text{cm}^{-1} \\implies k_c^2 = \\pi^2/100 \\, \\text{cm}^{-2}$\n\n现在我们计算几何收敛因子：\n$$ g_{\\text{no}} = \\frac{0.98}{1 + (\\frac{1}{3} \\, \\text{cm}^2) (\\frac{\\pi^2}{3600} \\, \\text{cm}^{-2})} = \\frac{0.98}{1 + \\frac{\\pi^2}{10800}} \\approx \\frac{0.98}{1 + 0.00091385} \\approx 0.9791054 $$\n$$ g_{\\text{cmr}} = \\frac{0.98}{1 + (\\frac{1}{3} \\, \\text{cm}^2) (\\frac{\\pi^2}{100} \\, \\text{cm}^{-2})} = \\frac{0.98}{1 + \\frac{\\pi^2}{300}} \\approx \\frac{0.98}{1 + 0.0328987} \\approx 0.9487854 $$\n\n最后，我们计算迭代次数减少因子 $R$：\n$$ R = \\frac{\\ln(g_{\\text{cmr}})}{\\ln(g_{\\text{no}})} = \\frac{\\ln(0.9487854)}{\\ln(0.9791054)} \\approx \\frac{-0.0525649}{-0.0211114} \\approx 2.490022 $$\n四舍五入到四位有效数字，迭代次数减少因子为 $2.490$。",
            "answer": "$$\\boxed{2.490}$$"
        },
        {
            "introduction": "虽然CMR是一种强大的加速技术，但它并非在所有情况下都完美无缺，不当使用时甚至可能引发数值不稳定性。本练习探讨了CMR在特定条件下（例如光学薄区域）可能导致的过修正和振荡问题。通过分析这些问题的根源并评估不同的阻尼策略，您将学会如何确保CMR方法的鲁棒性，这对于在复杂的实际问题中成功应用该技术至关重要 。",
            "id": "4217263",
            "problem": "考虑一个由粗网格重整（CMR）加速的非均匀反应堆堆芯中的稳态中子输运计算。未经重整的群内迭代会在每个粗网格单元中留下一个粗网格平衡残差，该残差定义为总积分中子产生与吸收和净泄漏出粗网格单元之和的差值。CMR对粗网格单元 $c$ 中的标量通量施加一个单元乘性修正因子 $R_c$，以在后续迭代中减小这些残差。假设群内求解后剩余的误差主要由通过泄漏耦合相邻粗网格单元的低频模式主导，并且粗网格平衡残差对通量的微小乘性变化近似呈线性响应。\n\n从第一性原理的中子平衡和残差对乘性通量微扰的线性化出发，分析无阻尼应用 $R_c$ 在何种条件下会过度修正残差并在粗网格层面引发迭代间的振荡行为。然后，为 $R_c$ 制定一个数学上合理的阻尼策略，以保证在这些条件下粗网格残差的收敛，并根据将乘性修正映射到残差减少的有效粗网格平衡算子的谱，陈述阻尼参数的稳定性条件。\n\n选择所有正确描述导致振荡的情形和合理的阻尼策略的选项。\n\nA. 在具有强网格间耦合和散射比接近 $1$ 的光学薄粗网格中，有效粗网格平衡算子的最大特征值 $\\lambda_{\\max}$ 可能超过 $2$。在这种情况下，无阻尼的重整步会发生超调并翻转主导残差模式的符号，导致迭代间的振荡。通过线性欠松弛进行阻尼，即 $R_c^{\\mathrm{new}} = 1 + \\omega \\left(R_c - 1\\right)$，其中 $0  \\omega  \\frac{2}{\\lambda_{\\max}}$，可以保证粗网格级误差放大器的谱半径小于 $1$，从而消除振荡。\n\nB. 在网格间耦合弱的高吸收、光学厚网格中，振荡最有可能发生，此时有效粗网格平衡算子的最大特征值满足 $\\lambda_{\\max}  1$。在这种情况下，在 $R_c^{\\mathrm{new}} = 1 + \\omega \\left(R_c - 1\\right)$ 中使用超松弛因子 $\\omega  1$ 既能避免振荡又能改善收敛。\n\nC. 形式为 $R_c^{\\mathrm{new}} = \\left(R_c\\right)^{\\alpha}$（其中 $0  \\alpha  1$）的乘性阻尼，在修正量的一阶近似下，等效于对重整增量的线性欠松弛。稳定性条件可以表示为 $|1 - \\alpha \\lambda|  1$，适用于有效粗网格平衡算子的所有特征值 $\\lambda$，这可以通过选择 $\\alpha$ 使得 $0  \\alpha  \\frac{2}{\\lambda_{\\max}}$ 来强制满足。\n\nD. $R_c$ 中的振荡仅在含时问题中因时间离散化而产生；在带CMR的稳态源迭代中不会发生。因此，在稳态CMR中不需要阻尼策略。\n\nE. 显式欠松弛的一个实用替代方案是，通过强制一个界限 $|R_c - 1| \\le \\delta$（对于某个选定的 $\\delta  0$）来限制每次迭代中重整因子的空间变化。将此限制解释为一种自适应有效阻尼，可以选择 $\\delta$，使得所产生的有效松弛参数 $\\omega_{\\mathrm{eff}} = \\min\\!\\left(1, \\frac{\\delta}{|R_c - 1|}\\right)$ 满足 $0  \\omega_{\\mathrm{eff}}  \\frac{2}{\\lambda_{\\max}}$，从而抑制粗网格残差的振荡。",
            "solution": "用户提供了一个关于稳态中子输运计算的粗网格重整（CMR）加速的问题陈述，并要求找出关于振荡原因和适当阻尼策略的正确陈述。\n\n### 步骤1：提取给定信息\n- **背景**：非均匀反应堆堆芯中的稳态中子输运计算。\n- **方法**：粗网格重整（CMR）加速。\n- **粗网格残差**：为每个粗网格单元 $c$ 定义，是总积分中子产生与吸收和净泄漏出该粗网格单元之和的差值。\n- **CMR修正**：对粗网格单元 $c$ 中的标量通量施加一个单元乘性修正因子 $R_c$。\n- **假设1**：群内求解后剩余的误差主要由通过泄漏耦合相邻粗网格单元的低频模式主导。\n- **假设2**：粗网格平衡残差对通量的微小乘性变化近似呈线性响应。\n- **问题**：分析无阻尼CMR导致过度修正和振荡的条件。制定一个阻尼策略，并根据有效粗网格平衡算子的谱陈述其稳定性条件。\n\n### 步骤2：使用提取的给定信息进行验证\n该问题陈述在科学上植根于核反应堆分析数值方法这一成熟领域。粗网格重整是一种标准且有详细文档记录的加速技术。所使用的概念——中子平衡、残差、泄漏、迭代方法的谱分析和线性化——都是该学科的基础。问题提取得很好；它要求分析一个已知的数值不稳定性及其解决方法，这具有明确的理论基础。语言客观、技术性强。设置是自洽和一致的，为进行形式化分析提供了必要的物理和数学假设（低频误差主导，线性响应）。所描述的情景（在光学薄、高散射区域的振荡）在物理上是现实的，并且是CMR方法的一个已知挑战。这个问题并非无足轻重，因为它需要将数值线性代数的原理应用于中子输运物理学。\n\n### 步骤3：结论与行动\n问题陈述是**有效**的。将进行完整的推导和分析。\n\n### 基于原理的推导\n令 $\\vec{\\rho}$ 为一次群内输运扫描后的粗网格残差向量。CMR的目标是找到一个乘性因子向量 $\\vec{R}$，当应用于通量时，将使下一个残差向量趋于零。令 $\\vec{f}$ 为分数修正向量，使得 $R_c = 1 + f_c$。\n\n根据问题中线性响应的假设，应用修正 $\\vec{f}$ 导致的残差向量变化 $\\Delta\\vec{\\rho}$ 可以建模为：\n$$ \\Delta\\vec{\\rho} \\approx -\\mathbf{A}_{\\text{true}} \\vec{f} $$\n其中 $\\mathbf{A}_{\\text{true}}$ 是真实的粗网格算子，它将通量的分数修正映射到残差的相应减少。该算子代表了底层输运方程在粗网格上的精确响应。\n\n一个无阻尼的CMR步骤通过求解一个简化、近似的平衡方程版本来计算修正向量 $\\vec{f}$。这相当于假设一个近似响应算子 $\\mathbf{A}_{\\text{approx}}$，并要求*预测的*新残差变为零：\n$$ \\vec{\\rho}_{\\text{predicted new}} = \\vec{\\rho}_{\\text{old}} - \\mathbf{A}_{\\text{approx}} \\vec{f} = \\vec{0} $$\n这产生了无阻尼修正：\n$$ \\vec{f} = \\mathbf{A}_{\\text{approx}}^{-1} \\vec{\\rho}_{\\text{old}} $$\n算子 $\\mathbf{A}_{\\text{approx}}$ 通常从一个低阶模型（如扩散理论）推导而来，其求逆在计算上比完整的输运响应算子更便宜。\n\n应用此修正 $\\vec{f}$ 后，*实际的*新残差由真实算子 $\\mathbf{A}_{\\text{true}}$ 决定：\n$$ \\vec{\\rho}_{\\text{new}} = \\vec{\\rho}_{\\text{old}} - \\mathbf{A}_{\\text{true}} \\vec{f} = \\vec{\\rho}_{\\text{old}} - \\mathbf{A}_{\\text{true}} \\left( \\mathbf{A}_{\\text{approx}}^{-1} \\vec{\\rho}_{\\text{old}} \\right) $$\n这可以写成关于残差向量的不动点迭代：\n$$ \\vec{\\rho}_{\\text{new}} = \\left( \\mathbf{I} - \\mathbf{A}_{\\text{true}} \\mathbf{A}_{\\text{approx}}^{-1} \\right) \\vec{\\rho}_{\\text{old}} $$\n令 $\\mathbf{P} = \\mathbf{A}_{\\text{true}} \\mathbf{A}_{\\text{approx}}^{-1}$。残差的迭代矩阵是 $\\mathbf{E} = \\mathbf{I} - \\mathbf{P}$。迭代收敛当且仅当迭代矩阵 $\\mathbf{E}$ 的谱半径小于 $1$，即 $\\rho(\\mathbf{E})  1$。\n\n$\\mathbf{E}$ 的特征值（记为 $\\mu_i$）与 $\\mathbf{P}$ 的特征值（记为 $\\lambda_i$）通过 $\\mu_i = 1 - \\lambda_i$ 相关。收敛条件是对于所有 $i$ 都有 $|\\mu_i| = |1 - \\lambda_i|  1$。对于中子平衡问题，$\\mathbf{P}$ 的特征值 $\\lambda_i$ 通常是实数且为正。因此条件简化为：\n$$ -1  1 - \\lambda_i  1 \\implies 0  \\lambda_i  2 $$\n如果算子 $\\mathbf{P} = \\mathbf{A}_{\\text{true}} \\mathbf{A}_{\\text{approx}}^{-1}$ 的最大特征值 $\\lambda_{\\max}$ 超过 $2$，那么其对应的特征值 $\\mu_{\\max} = 1 - \\lambda_{\\max}$ 将小于 $-1$。残差的相应本征模式的幅值将在每次迭代中增长并改变符号，导致振荡发散。\n\n这种过度修正（$\\lambda_{\\max} > 2$）发生在近似算子 $\\mathbf{A}_{\\text{approx}}$ 显著低估了真实响应 $\\mathbf{A}_{\\text{true}}$ 的情况下。这是用于 $\\mathbf{A}_{\\text{approx}}$ 的低阶扩散模型是高阶输运物理的糟糕近似的物理情况的特征。这些情况包括：\n1.  **光学薄粗网格**：单元尺寸相对于中子平均自由程较小。\n2.  **高散射比**：散射截面远大于吸收截面，$\\Sigma_s \\gg \\Sigma_a$，或者散射比 $c = \\Sigma_s/\\Sigma_t \\approx 1$。\n在这些情况下，中子可以在没有相互作用的情况下穿过多个粗网格单元，导致局部扩散模型无法准确捕捉的强网格间耦合。\n\n为了稳定迭代，引入了阻尼或欠松弛策略。不应用完整的修正 $\\vec{f}$，而是使用一个缩放的修正 $\\vec{f}_{\\text{new}} = \\omega \\vec{f}$，其中 $\\omega$ 是一个松弛参数。\n这对应于更新重整因子为：\n$$ R_{c}^{\\text{new}} - 1 = \\omega (R_{c}^{\\text{undamped}} - 1) \\implies R_{c}^{\\text{new}} = 1 + \\omega(R_{c}^{\\text{undamped}} - 1) $$\n残差迭代变为：\n$$ \\vec{\\rho}_{\\text{new}} = (\\mathbf{I} - \\omega \\mathbf{P}) \\vec{\\rho}_{\\text{old}} $$\n新的迭代矩阵是 $\\mathbf{E}_{\\omega} = \\mathbf{I} - \\omega \\mathbf{P}$，其特征值为 $\\mu_i(\\omega) = 1 - \\omega \\lambda_i$。稳定性条件 $|1 - \\omega \\lambda_i|  1$ 要求：\n$$ 0  \\omega \\lambda_i  2 $$\n为确保这对所有特征值都成立，该条件必须对 $\\lambda_{\\max}$ 成立。这给出了阻尼参数 $\\omega$ 的稳定性判据：\n$$ 0  \\omega  \\frac{2}{\\lambda_{\\max}} $$\n如果 $\\lambda_{\\max} > 2$，则需要进行欠松弛（$0  \\omega  1$）以保证收敛。\n\n### 逐项分析\n\n**A. 在具有强网格间耦合和散射比接近 $1$ 的光学薄粗网格中，有效粗网格平衡算子的最大特征值 $\\lambda_{\\max}$ 可能超过 $2$。在这种情况下，无阻尼的重整步会发生超调并翻转主导残差模式的符号，导致迭代间的振荡。通过线性欠松弛进行阻尼，即 $R_c^{\\mathrm{new}} = 1 + \\omega \\left(R_c - 1\\right)$，其中 $0  \\omega  \\frac{2}{\\lambda_{\\max}}$，可以保证粗网格级误差放大器的谱半径小于 $1$，从而消除振荡。**\n这个选项正确地指出了导致不稳定的物理条件（光学薄，高散射）。它正确地陈述了振荡发散的数学条件 $\\lambda_{\\max} > 2$，其中 $\\lambda_{\\max}$ 是有效迭代算子 $\\mathbf{P} = \\mathbf{A}_{\\text{true}}\\mathbf{A}_{\\text{approx}}^{-1}$ 的最大特征值。它提供了线性欠松弛的正确公式和参数 $\\omega$ 的正确稳定性条件。该策略保证谱半径小于 $1$ 的结论是准确的。\n**结论：正确**\n\n**B. 在网格间耦合弱的高吸收、光学厚网格中，振荡最有可能发生，此时有效粗网格平衡算子的最大特征值满足 $\\lambda_{\\max}  1$。在这种情况下，在 $R_c^{\\mathrm{new}} = 1 + \\omega \\left(R_c - 1\\right)$ 中使用超松弛因子 $\\omega  1$ 既能避免振荡又能改善收敛。**\n这个选项描述了相反的物理情况。在光学厚、高吸收的介质中，扩散近似通常是准确的，所以 $\\mathbf{A}_{\\text{approx}} \\approx \\mathbf{A}_{\\text{true}}$，导致 $\\mathbf{P}$ 的特征值 $\\lambda_i$ 聚集在 $1$ 附近。振荡发散不是典型问题。如果 $\\lambda_{\\max}  1$，无阻尼迭代已经收敛，可以使用超松弛（$\\omega > 1$）来加速它，而不是“避免振荡”，因为在这些条件下振荡本来就不存在。这个前提是有缺陷的。\n**结论：不正确**\n\n**C. 形式为 $R_c^{\\mathrm{new}} = \\left(R_c\\right)^{\\alpha}$（其中 $0  \\alpha  1$）的乘性阻尼，在修正量的一阶近似下，等效于对重整增量的线性欠松弛。稳定性条件可以表示为 $|1 - \\alpha \\lambda|  1$，适用于有效粗网格平衡算子的所有特征值 $\\lambda$，这可以通过选择 $\\alpha$ 使得 $0  \\alpha  \\frac{2}{\\lambda_{\\max}}$ 来强制满足。**\n令 $R_c = 1 + f_c$，其中修正量 $f_c$ 很小。一阶泰勒展开给出 $R_c^{\\mathrm{new}} = (1 + f_c)^{\\alpha} \\approx 1 + \\alpha f_c$。线性松弛的修正是 $1 + \\omega f_c$。因此，在一阶近似下，这种乘性阻尼等效于 $\\omega = \\alpha$ 的线性松弛。线性松弛的稳定性分析直接适用，得到条件 $|1 - \\alpha \\lambda_i|  1$ 对 $\\mathbf{P}$ 的特征值 $\\lambda_i$ 成立。这反过来给出了稳定性界限 $0  \\alpha  2/\\lambda_{\\max}$。该陈述是对一种替代阻尼形式的有效且有见地的分析。\n**结论：正确**\n\n**D. $R_c$ 中的振荡仅在含时问题中因时间离散化而产生；在带CMR的稳态源迭代中不会发生。因此，在稳态CMR中不需要阻尼策略。**\n这个陈述根本上是不正确的。当迭代矩阵的特征值具有小于 $-1$ 的负实部时，振荡行为是许多稳态迭代数值方法（例如，雅可比法、高斯-赛德尔法、SOR法）的典型特征。如上所述，这种不稳定性在特定、已充分理解的物理和数值条件下，可能并且确实会在稳态CMR中发生。在实践中，稳态CMR中需要阻尼策略是公认的。\n**结论：不正确**\n\n**E. 显式欠松弛的一个实用替代方案是，通过强制一个界限 $|R_c - 1| \\le \\delta$（对于某个选定的 $\\delta  0$）来限制每次迭代中重整因子的空间变化。将此限制解释为一种自适应有效阻尼，可以选择 $\\delta$，使得所产生的有效松弛参数 $\\omega_{\\mathrm{eff}} = \\min\\!\\left(1, \\frac{\\delta}{|R_c - 1|}\\right)$ 满足 $0  \\omega_{\\mathrm{eff}}  \\frac{2}{\\lambda_{\\max}}$，从而抑制粗网格残差的振荡。**\n限制重整因子是一种常见的启发式方法，用以防止非物理的大通量变化并提高鲁棒性。所提供的分析是对这种启发式方法的合理解释。无阻尼修正是 $f_c^{\\text{undamped}} = R_c - 1$。使用所提出的有效松弛的阻尼修正是 $f_c^{\\text{damped}} = \\omega_{\\mathrm{eff}} f_c^{\\text{undamped}}$。\n- 如果 $|R_c - 1| \\le \\delta$，那么 $\\omega_{\\mathrm{eff}} = 1$，并且 $f_c^{\\text{damped}} = f_c^{\\text{undamped}}$（无阻尼）。\n- 如果 $|R_c - 1|  \\delta$，那么 $\\omega_{\\mathrm{eff}} = \\delta / |R_c - 1|  1$，并且 $|f_c^{\\text{damped}}| = |\\frac{\\delta}{|R_c-1|}(R_c-1)| = \\delta$。\n这完美地描述了限制机制。这是一种自适应欠松弛方案：对小的修正不进行阻尼，但对大的、可能不稳定的修正施加越来越强的阻尼。通过选择足够小的 $\\delta$，可以确保有效松弛参数 $\\omega_{\\mathrm{eff}}$ 始终在稳定范围 $0  \\omega_{\\mathrm{eff}}  2/\\lambda_{\\max}$ 内，从而抑制振荡。这种解释是正确的，并为一种实用方法提供了形式化的论证。\n**结论：正确**",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}