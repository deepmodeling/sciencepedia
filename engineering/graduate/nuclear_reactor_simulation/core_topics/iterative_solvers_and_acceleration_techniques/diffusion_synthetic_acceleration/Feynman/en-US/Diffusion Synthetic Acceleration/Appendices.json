{
    "hands_on_practices": [
        {
            "introduction": "To appreciate why acceleration methods are indispensable, we must first understand the limitations of the basic Source Iteration (SI) scheme. This foundational exercise guides you through an analysis of the convergence of SI, revealing how its efficiency is tied to the physical properties of the medium . By deriving the asymptotic convergence factor, you will see precisely why problems with high scattering ratios, where the scattering ratio $c = \\Sigma_{s}/\\Sigma_{t} \\to 1$, demand a more sophisticated solution than simple iteration.",
            "id": "4221984",
            "problem": "Consider the steady-state, monoenergetic linear Boltzmann transport equation in one-dimensional slab geometry with isotropic scattering for the angular flux $\\,\\psi(x,\\mu)\\,$, where $\\,x\\in\\mathbb{R}\\,$ is the spatial coordinate, $\\,\\mu\\in[-1,1]\\,$ is the direction cosine, $\\,\\Sigma_{t}\\,$ is the total macroscopic cross section, and $\\,\\Sigma_{s}\\,$ is the isotropic scattering macroscopic cross section. Let $\\,q(x)\\,$ denote a fixed, isotropic external source. The scalar flux is defined by the angular integral of the angular flux over all directions. Discretize the angular variable using the method of discrete ordinates, also called the $\\,S_{N}\\,$ method (Discrete Ordinates Method (DOM)), with directions $\\,\\{\\mu_{n}\\}_{n=1}^{N}\\,$ and positive quadrature weights $\\,\\{w_{n}\\}_{n=1}^{N}\\,$ that approximate the integral over $\\,\\mu\\in[-1,1]\\,$.\n\nStarting from fundamental transport theory, perform the following:\n\n- Derive the discrete ordinates $\\,S_{N}\\,$ equations for the directional unknowns $\\,\\psi_{n}(x) = \\psi(x,\\mu_{n})\\,$.\n- Provide the discrete definition of the scalar flux $\\,\\phi(x)\\,$ in terms of the directional fluxes and the quadrature weights.\n- Clearly state the source iteration update for the scalar flux $\\,\\phi(x)\\,$, where the scattering source used on the right-hand side is constructed from the previous iterate of $\\,\\phi(x)\\,$.\n\nThen, consider an infinite, homogeneous medium with $\\,\\Sigma_{t}\\,$ and $\\,\\Sigma_{s}\\,$ constant in space, with $\\,q(x) = 0\\,$, and analyze the asymptotic convergence of source iteration for a spatially uniform error mode. Define the scattering ratio $\\,c = \\Sigma_{s}/\\Sigma_{t}\\,$. Under these assumptions, determine the asymptotic source-iteration convergence factor $\\,\\rho_{\\mathrm{SI}}\\,$ for the scalar flux error in terms of $\\,c\\,$.\n\nYour final answer must be a single, closed-form analytic expression for $\\,\\rho_{\\mathrm{SI}}\\,$. No rounding is required, and no units are to be included.",
            "solution": "The problem begins with the steady-state, monoenergetic linear Boltzmann transport equation in a one-dimensional slab geometry with isotropic scattering and a fixed isotropic external source. This equation for the angular flux $\\psi(x,\\mu)$ is given by:\n$$ \\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t}\\psi(x,\\mu) = \\frac{\\Sigma_{s}}{2}\\phi(x) + \\frac{q(x)}{2} $$\nwhere $x \\in \\mathbb{R}$ is the spatial coordinate, $\\mu \\in [-1,1]$ is the cosine of the angle with respect to the $x$-axis, $\\Sigma_{t}$ is the total macroscopic cross section, $\\Sigma_{s}$ is the isotropic scattering macroscopic cross section, and $q(x)$ is the isotropic external source density. The term $\\phi(x)$ represents the scalar flux, defined as the integral of the angular flux over all directions:\n$$ \\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu') \\, d\\mu' $$\n\nThe first task is to discretize this equation using the method of discrete ordinates ($S_N$). This method replaces the continuous angular variable $\\mu$ with a discrete set of directions $\\{\\mu_{n}\\}_{n=1}^{N}$ and associated positive quadrature weights $\\{w_{n}\\}_{n=1}^{N}$. Evaluating the transport equation at each discrete direction $\\mu_{n}$ yields the system of $N$ coupled ordinary differential equations, known as the $S_N$ equations:\n$$ \\mu_{n} \\frac{d\\psi_{n}(x)}{dx} + \\Sigma_{t}\\psi_{n}(x) = \\frac{\\Sigma_{s}}{2}\\phi(x) + \\frac{q(x)}{2}, \\quad \\text{for } n=1, 2, \\ldots, N $$\nwhere $\\psi_{n}(x)$ is a shorthand for $\\psi(x,\\mu_{n})$.\n\nThe second task is to provide the discrete definition of the scalar flux $\\phi(x)$. In the $S_N$ method, the integral for the scalar flux is approximated by the corresponding quadrature sum:\n$$ \\phi(x) = \\sum_{m=1}^{N} w_{m} \\psi_{m}(x) $$\nSubstituting this discrete definition into the $S_N$ equations gives the fully discretized system:\n$$ \\mu_{n} \\frac{d\\psi_{n}(x)}{dx} + \\Sigma_{t}\\psi_{n}(x) = \\frac{\\Sigma_{s}}{2} \\sum_{m=1}^{N} w_{m} \\psi_{m}(x) + \\frac{q(x)}{2}, \\quad \\text{for } n=1, 2, \\ldots, N $$\n\nThe third task is to state the source iteration update for the scalar flux. Source iteration is a fixed-point iterative method where the scattering source term is computed using the scalar flux from the previous iteration. Let $k$ be the iteration index. The source iteration scheme proceeds as follows:\n1. Given the scalar flux from the previous iteration, $\\phi^{(k)}(x)$, the angular flux for the next iteration, $\\psi_{n}^{(k+1)}(x)$, is found by solving the following equation for each direction $n$:\n$$ \\mu_{n} \\frac{d\\psi_{n}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\psi_{n}^{(k+1)}(x) = \\frac{\\Sigma_{s}}{2}\\phi^{(k)}(x) + \\frac{q(x)}{2} $$\n2. The scalar flux is then updated using the newly computed angular fluxes:\n$$ \\phi^{(k+1)}(x) = \\sum_{n=1}^{N} w_{n} \\psi_{n}^{(k+1)}(x) $$\nThis two-step process defines the iterative map from $\\phi^{(k)}$ to $\\phi^{(k+1)}$.\n\nThe final task is to determine the asymptotic source-iteration convergence factor, $\\rho_{\\mathrm{SI}}$, for a specific scenario: an infinite, homogeneous medium with $\\Sigma_{t}$ and $\\Sigma_{s}$ constant, no external source ($q(x)=0$), and for a spatially uniform error mode.\n\nLet $\\phi(x)$ be the exact solution to the transport problem and let $\\phi^{(k)}(x)$ be the solution at iteration $k$. The error in the scalar flux at iteration $k$ is defined as $\\epsilon_{\\phi}^{(k)}(x) = \\phi^{(k)}(x) - \\phi(x)$. Similarly, the error in the angular flux is $\\epsilon_{\\psi,n}^{(k)}(x) = \\psi_{n}^{(k)}(x) - \\psi_{n}(x)$. Since the transport equation is linear, the error propagation is governed by the same iterative scheme, but with the source term $q(x)$ removed:\n$$ \\mu_{n} \\frac{d\\epsilon_{\\psi,n}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\epsilon_{\\psi,n}^{(k+1)}(x) = \\frac{\\Sigma_{s}}{2}\\epsilon_{\\phi}^{(k)}(x) $$\nThe update for the scalar flux error is:\n$$ \\epsilon_{\\phi}^{(k+1)}(x) = \\sum_{n=1}^{N} w_{n} \\epsilon_{\\psi,n}^{(k+1)}(x) $$\nWe are asked to analyze a \"spatially uniform error mode\". This implies that the error is constant in space, i.e., $\\epsilon_{\\phi}^{(k)}(x) = E_{\\phi}^{(k)}$ and $\\epsilon_{\\psi,n}^{(k+1)}(x) = E_{\\psi,n}^{(k+1)}$, where $E_{\\phi}^{(k)}$ and $E_{\\psi,n}^{(k+1)}$ are constants. With spatially uniform error, the derivative term $\\frac{d}{dx}$ is zero. The equation for the angular flux error simplifies to an algebraic equation:\n$$ \\Sigma_{t} E_{\\psi,n}^{(k+1)} = \\frac{\\Sigma_{s}}{2}E_{\\phi}^{(k)} $$\nSolving for the angular flux error component, we find:\n$$ E_{\\psi,n}^{(k+1)} = \\frac{\\Sigma_{s}}{2\\Sigma_{t}}E_{\\phi}^{(k)} $$\nNotice that the angular flux error $E_{\\psi,n}^{(k+1)}$ is independent of the direction $n$. Now, we update the scalar flux error by substituting this result into its definition:\n$$ E_{\\phi}^{(k+1)} = \\sum_{n=1}^{N} w_{n} E_{\\psi,n}^{(k+1)} = \\sum_{n=1}^{N} w_{n} \\left( \\frac{\\Sigma_{s}}{2\\Sigma_{t}}E_{\\phi}^{(k)} \\right) = \\left( \\frac{\\Sigma_{s}}{2\\Sigma_{t}}E_{\\phi}^{(k)} \\right) \\sum_{n=1}^{N} w_{n} $$\nA standard property of quadrature sets used in the $S_N$ method, such as Gauss-Legendre quadrature, is that they integrate low-order polynomials exactly. For the constant function $f(\\mu)=1$, the quadrature is exact:\n$$ \\sum_{n=1}^{N} w_{n} = \\int_{-1}^{1} 1 \\, d\\mu = 2 $$\nSubstituting this property into the expression for $E_{\\phi}^{(k+1)}$ gives:\n$$ E_{\\phi}^{(k+1)} = \\left( \\frac{\\Sigma_{s}}{2\\Sigma_{t}} \\right) E_{\\phi}^{(k)} \\cdot (2) = \\frac{\\Sigma_{s}}{\\Sigma_{t}} E_{\\phi}^{(k)} $$\nThe problem defines the scattering ratio as $c = \\Sigma_{s}/\\Sigma_{t}$. Therefore, the relationship between successive errors is:\n$$ E_{\\phi}^{(k+1)} = c \\, E_{\\phi}^{(k)} $$\nThe asymptotic source-iteration convergence factor, $\\rho_{\\mathrm{SI}}$, is the factor by which the magnitude of the error is reduced per iteration. For this simple error mode, it is the ratio of consecutive errors:\n$$ \\rho_{\\mathrm{SI}} = \\left| \\frac{E_{\\phi}^{(k+1)}}{E_{\\phi}^{(k)}} \\right| = |c| $$\nSince $\\Sigma_{s}$ and $\\Sigma_{t}$ are cross sections, they are non-negative, which implies $c \\ge 0$. Thus, $|c| = c$. This analysis corresponds to the flattest, or $\\lambda=0$, Fourier mode, which is known to govern the asymptotic convergence rate of source iteration.\nThe asymptotic convergence factor is therefore equal to the scattering ratio.\n$$ \\rho_{\\mathrm{SI}} = c $$",
            "answer": "$$\\boxed{c}$$"
        },
        {
            "introduction": "An effective accelerator must correctly model all slow-to-converge error modes, including those that arise at the problem boundaries. This exercise addresses a critical and often subtle aspect of implementing DSA: the correct formulation of boundary conditions for the low-order diffusion equation . By analyzing the effect of mismatched boundary treatments, you will understand the physics of transport at interfaces and learn how to derive consistent low-order conditions, such as the Marshak boundary condition, to ensure stable and rapid convergence.",
            "id": "4222008",
            "problem": "Consider a one-dimensional slab domain $x \\in [0,L]$ filled with a homogeneous, isotropically scattering medium characterized by total cross section $\\Sigma_t$, scattering cross section $\\Sigma_s$, and absorption cross section $\\Sigma_a = \\Sigma_t - \\Sigma_s$. The stationary linear Boltzmann transport equation in slab geometry for the angular flux $\\psi(x,\\mu)$ is\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = \\frac{\\Sigma_s}{2} \\phi(x) + Q(x),\n$$\nwhere the scalar flux is $\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\, d\\mu$, and $Q(x)$ is a given isotropic source. The vacuum boundary condition for the high-order transport solve is imposed as zero incoming angular flux at both ends:\n$$\n\\psi(0,\\mu) = 0 \\quad \\text{for} \\quad \\mu > 0, \\qquad \\psi(L,\\mu) = 0 \\quad \\text{for} \\quad \\mu < 0.\n$$\n\nA common iterative method is source iteration, in which the scattering source is updated using the previous iterate. Diffusion Synthetic Acceleration (DSA) augments source iteration by solving a low-order diffusion equation for an error-correction field $e(x)$ that approximately removes the slow-to-converge error modes of the high-order iteration. In the diffusion limit, the correction $e(x)$ satisfies a diffusion-like equation of the form\n$$\n- \\frac{d}{dx} \\left( D \\frac{d e}{dx} \\right) + \\Sigma_a e = r(x),\n$$\nwhere $D$ is the diffusion coefficient and $r(x)$ is a residual constructed to represent the transport iteration error in the scattering source. For isotropic media, a standard choice is $D = \\frac{1}{3} \\Sigma_t^{-1}$, consistent with the first-order spherical harmonics closure. The DSA step uses $e(x)$ to update the scalar flux and scatter source in the transport sweep.\n\nSuppose the high-order transport sweep uses the exact vacuum boundary conditions stated above, while the low-order diffusion solve uses homogeneous Neumann boundary conditions,\n$$\n\\frac{de}{dx}(0) = 0, \\qquad \\frac{de}{dx}(L) = 0,\n$$\nwhich do not reflect the half-range vacuum condition of the transport problem. You are asked to analyze, from first principles, the effect of this mismatch between the boundary flux treatments on the convergence of the DSA-accelerated source iteration.\n\nUsing the governing equation and boundary definitions above and a first-order spherical harmonics (P1) representation near the boundary,\n$$\n\\psi(x,\\mu) \\approx a(x) + b(x)\\mu, \\quad \\phi(x) = 2 a(x), \\quad J(x) = \\int_{-1}^{1} \\mu \\psi(x,\\mu)\\, d\\mu = \\frac{2}{3} b(x),\n$$\nand Fick’s law $J(x) = - D \\, \\frac{d \\phi}{dx}(x)$, derive the boundary condition that the diffusion equation must satisfy to be consistent with the high-order vacuum boundary, and infer the consequence of applying a mismatched boundary condition in the diffusion solve on the spectral radius of the preconditioned iteration operator. In particular, argue whether a boundary-layer error mode can persist undamped and lead to non-convergent acceleration.\n\nWhich of the following statements correctly identifies the mechanism by which mismatched boundary flux treatments between the high-order transport sweep and low-order diffusion solve can lead to non-convergent acceleration, and prescribes an appropriate remedy?\n\nA. The mismatch introduces a boundary-layer error mode not represented in the interior diffusion operator. Because homogeneous Neumann conditions force zero normal correction current at the boundary, the incoming partial-current error remains uncorrected, producing a unit-eigenvalue mode in the preconditioned iteration and possible divergence. The remedy is to impose half-range-consistent Robin (Marshak) boundary conditions on the diffusion solve, derived from the vacuum condition on the transport equation, namely $\\frac{1}{2}\\, e + D \\, \\hat{n} \\cdot \\nabla e = 0$ at vacuum boundaries, and $\\hat{n} \\cdot \\nabla e = 0$ at perfectly reflecting boundaries, with boundary residuals computed using the same discrete ordinates quadrature.\n\nB. The mismatch only affects scalar-flux conservation but does not impact convergence because the diffusion operator is elliptic. The remedy is to multiply the diffusion coefficient $D$ by $\\Sigma_t$ at boundary faces to restore conservation.\n\nC. The mismatch arises from using Robin conditions in transport. The remedy is to set Dirichlet boundary conditions $\\phi = 0$ for the diffusion solve at all vacuum boundaries, independent of the transport boundary condition, which guarantees damping of all error modes.\n\nD. The non-convergent behavior is due to time-stepping errors in transient problems. The remedy is to reduce the time step size until the DSA scheme converges, rendering boundary conditions irrelevant to acceleration.\n\nChoose the correct option.",
            "solution": "We begin with the slab-geometry stationary linear Boltzmann transport equation,\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = \\frac{\\Sigma_s}{2} \\phi(x) + Q(x),\n$$\nwith vacuum boundary conditions\n$$\n\\psi(0,\\mu) = 0 \\ \\text{for} \\ \\mu > 0, \\qquad \\psi(L,\\mu) = 0 \\ \\text{for} \\ \\mu < 0.\n$$\nSource iteration updates the scattering source $\\frac{\\Sigma_s}{2} \\phi(x)$ using the previous iterate, and Diffusion Synthetic Acceleration (DSA) aims to remove the slow-to-converge components of the error by solving a diffusion equation for an error correction $e(x)$,\n$$\n- \\frac{d}{dx} \\left( D \\frac{d e}{dx} \\right) + \\Sigma_a e = r(x),\n$$\nwith $D = \\frac{1}{3} \\Sigma_t^{-1}$ for isotropic scattering, consistent with the first-order spherical harmonics (P1) closure, and $r(x)$ a residual that approximates the transport error in the scattering source.\n\nThe crux of the analysis is the treatment of boundary conditions in the diffusion solve. To be consistent with the high-order vacuum boundary, the diffusion equation must reproduce, in an averaged sense, the zero-incoming-flux condition. We formalize this using a P1 representation near the boundary:\n$$\n\\psi(x,\\mu) \\approx a(x) + b(x)\\mu, \\qquad \\phi(x) = \\int_{-1}^{1} \\psi \\, d\\mu = 2 a(x), \\qquad J(x) = \\int_{-1}^{1} \\mu \\psi \\, d\\mu = \\frac{2}{3} b(x),\n$$\nand Fick’s law (a well-tested approximation under the P1 closure),\n$$\nJ(x) = - D \\frac{d \\phi}{dx}(x).\n$$\n\nAt the left boundary ($x = 0$), the incoming partial current into the domain is\n$$\nJ^{\\text{in}}(0) = \\int_{0}^{1} \\mu \\psi(0,\\mu) \\, d\\mu.\n$$\nUnder the vacuum boundary condition, $J^{\\text{in}}(0) = 0$. Using the P1 approximation at $x=0$,\n$$\nJ^{\\text{in}}(0) = \\int_0^1 \\mu \\left[a(0) + b(0)\\mu\\right] \\, d\\mu = \\frac{a(0)}{2} + \\frac{b(0)}{3}.\n$$\nExpress $a$ and $b$ in terms of $\\phi$ and $J$:\n$$\na(0) = \\frac{\\phi(0)}{2}, \\qquad b(0) = \\frac{3}{2} J(0).\n$$\nHence,\n$$\nJ^{\\text{in}}(0) = \\frac{\\phi(0)}{4} + \\frac{J(0)}{2}.\n$$\nImposing $J^{\\text{in}}(0) = 0$ gives\n$$\n\\frac{\\phi(0)}{4} + \\frac{J(0)}{2} = 0 \\quad \\Rightarrow \\quad J(0) = - \\frac{\\phi(0)}{2}.\n$$\nUsing Fick’s law and noting that at the left boundary the outward unit normal $\\hat{n}$ points in the negative $x$-direction, $\\hat{n} \\cdot \\nabla \\phi = - \\frac{d \\phi}{dx}$, we have\n$$\nJ(0) = - D \\frac{d \\phi}{dx}(0) = D \\, \\hat{n} \\cdot \\nabla \\phi(0).\n$$\nCombining with $J(0) = - \\frac{\\phi(0)}{2}$ yields the classical Marshak (half-range-consistent) Robin boundary condition for diffusion at a vacuum boundary:\n$$\n\\frac{1}{2} \\, \\phi(0) + D \\, \\hat{n} \\cdot \\nabla \\phi(0) = 0.\n$$\nAn identical derivation at $x=L$ gives\n$$\n\\frac{1}{2} \\, \\phi(L) + D \\, \\hat{n} \\cdot \\nabla \\phi(L) = 0,\n$$\nwith $\\hat{n}$ pointing in the positive $x$-direction at $x=L$. For a reflecting boundary, the transport condition enforces zero net normal current; under P1/Fick’s law, the consistent diffusion boundary becomes\n$$\n\\hat{n} \\cdot \\nabla \\phi = 0 \\quad \\text{(Neumann)}.\n$$\n\nNow, consider the DSA correction $e(x)$, which obeys the same operator but is driven by the iteration residual $r(x)$. Consistency requires that the diffusion boundary condition for $e$ be derived in the same way from the half-range transport boundary condition on the error’s incoming partial current. If, instead, homogeneous Neumann conditions are imposed at vacuum boundaries,\n$$\n\\frac{de}{dx}(0) = 0, \\qquad \\frac{de}{dx}(L) = 0,\n$$\nthen the normal correction current $J_e = - D \\frac{d e}{dx}$ satisfies $J_e(0) = 0$ and $J_e(L) = 0$. However, the transport iteration error produces a nonzero incoming partial-current error $J_e^{\\text{in}}$ at a vacuum boundary whenever the high-order sweep’s scattering source is imperfect. The Neumann condition prohibits the diffusion solve from generating the necessary normal correction current to cancel this incoming partial-current error. In other words, the diffusion preconditioner does not act on the boundary-layer component of the error.\n\nThis can be made precise by examining the preconditioned iteration operator. Denote the transport source-iteration error by $e^k(x)$, and interpret the DSA correction as applying a preconditioner $P^{-1}$ to the residual operator $M$ associated with scattering-source updates. The preconditioned error propagation takes the form\n$$\ne^{k+1} = \\left( I - P^{-1} M \\right) e^k.\n$$\nIn the interior, $P^{-1}$ is spectrally equivalent to the diffusion operator and effectively damps low-frequency error modes. Near a vacuum boundary, the incoming partial-current component defines a boundary-layer mode characterized by half-range angular structure and steep spatial decay. Under a mismatched Neumann boundary for the diffusion solve, $P^{-1}$ has no action on this mode because it enforces $J_e = 0$ at the boundary, while the transport operator $M$ continues to regenerate the same incoming error. Consequently, the composition $I - P^{-1} M$ leaves the boundary-layer mode unchanged, yielding a unit eigenvalue for that mode:\n$$\n\\rho\\left( I - P^{-1} M \\right) \\ge 1 \\quad \\text{(boundary-layer mode)},\n$$\nand the DSA provides no acceleration for that component; the overall scheme may stagnate or diverge because the undamped mode contaminates the iteration.\n\nBy contrast, if the diffusion boundary is enforced in a half-range-consistent Robin form derived above, the diffusion correction supplies the appropriate normal current at the boundary to cancel the incoming partial-current error, thereby damping the boundary-layer mode. More generally, for an albedo boundary with reflectivity parameter $\\alpha \\in [0,1)$ satisfying $J^{\\text{in}} = \\alpha J^{\\text{out}}$, the P1-based consistent diffusion boundary becomes\n$$\n\\frac{1}{2} (1 - \\alpha) \\, \\phi + D \\, \\hat{n} \\cdot \\nabla \\phi = 0,\n$$\nand the same form should be used for the DSA correction $e$. Matching the low-order boundary condition to the high-order half-range physics ensures that $P^{-1}$ acts on all slow error modes, including boundary layers, and drives the spectral radius below unity.\n\nOption-by-option analysis:\n\nA. This option correctly identifies that the mismatch leaves a boundary-layer error mode unaddressed, resulting in a unit eigenvalue in the preconditioned iteration and possible non-convergence. It prescribes the appropriate remedy: impose half-range-consistent Robin (Marshak) boundary conditions on the diffusion solve at vacuum boundaries,\n$$\n\\frac{1}{2} \\, e + D \\, \\hat{n} \\cdot \\nabla e = 0,\n$$\nand Neumann at reflecting boundaries, with boundary residuals computed consistently with the discrete ordinates quadrature. This matches the derivation above. Verdict: Correct.\n\nB. This option claims ellipticity alone guarantees convergence, which is false in the presence of boundary-layer modes that are not coupled by the preconditioner; ellipticity of the interior operator does not resolve a mismatched boundary. Multiplying $D$ by $\\Sigma_t$ at the boundary is ad hoc and does not restore half-range consistency. Verdict: Incorrect.\n\nC. This option suggests imposing Dirichlet $\\phi = 0$ at vacuum boundaries for diffusion. While an extrapolated boundary condition can sometimes be approximated by Dirichlet at an offset location, imposing $\\phi = 0$ at the physical boundary is not consistent with the half-range transport vacuum and does not guarantee damping of the boundary-layer error; it can over-constrain and distort the correction, potentially harming convergence. Verdict: Incorrect.\n\nD. This option attributes the issue to time-stepping in transient problems, but the scenario is stationary, and even in transients, boundary-condition mismatches can undermine DSA. Reducing the time step does not address the fundamental mismatch between high-order and low-order boundary treatments. Verdict: Incorrect.\n\nTherefore, the correct statement and remedy are given in option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Real-world problems often involve multiple energy groups, where scattering can transfer neutrons between energies. This exercise explores the challenge of upscattering, which can tightly couple energy groups and introduce slow-to-converge error modes that simple acceleration schemes cannot resolve . By numerically comparing the spectral radii of unaccelerated, uncoupled DSA, and coupled DSA schemes, you will quantify the necessity of using a coupled low-order operator to effectively accelerate realistic, energy-dependent problems.",
            "id": "4221991",
            "problem": "Consider a one-dimensional, homogeneous, two-energy-group neutron transport problem with isotropic scattering and periodic boundary conditions, analyzed in the context of Diffusion Synthetic Acceleration (DSA). Let the group flux vector be $\\boldsymbol{\\phi} = [\\phi_1,\\phi_2]^T$ and denote the scattering cross-section matrix by\n$$\n\\mathbf{S} = \\begin{bmatrix}\n\\Sigma_{s,11} & \\Sigma_{s,12} \\\\\n\\Sigma_{s,21} & \\Sigma_{s,22}\n\\end{bmatrix},\n$$\nwhere $\\Sigma_{s,12} > 0$ represents upscattering from group $2$ to group $1$. Let the removal cross sections be $\\Sigma_{r,1} > 0$ and $\\Sigma_{r,2} > 0$. For a spatial Fourier mode of wavenumber $k$ (in $\\mathrm{cm}^{-1}$), model the high-order transport sweep operator’s Fourier symbol for group $g \\in \\{1,2\\}$ by\n$$\nQ^{\\mathrm{HO}}_g(k) = \\frac{1}{\\Sigma_{r,g} + v_g |k|},\n$$\nwhere $v_g > 0$ has units of $\\mathrm{cm}$ and reflects an effective streaming scale for the high-order transport sweep. This yields the source iteration (SI) error-propagation matrix\n$$\n\\mathbf{G}(k) = \\begin{bmatrix}\nQ^{\\mathrm{HO}}_1(k) & 0 \\\\\n0 & Q^{\\mathrm{HO}}_2(k)\n\\end{bmatrix} \\mathbf{S}.\n$$\nDefine the low-order diffusion operator’s Fourier symbol for group $g$ as\n$$\nQ^{\\mathrm{LO}}_g(k) = \\frac{1}{\\Sigma_{r,g} + D_g k^2},\n$$\nwhere $D_g > 0$ is the diffusion coefficient in $\\mathrm{cm}$. The low-order (LO) matrix $\\mathbf{G}_d(k)$ used in DSA is constructed as either:\n- Uncoupled LO: $\\mathbf{S}_d = \\mathrm{diag}(\\Sigma_{s,11},\\Sigma_{s,22})$, so\n$$\n\\mathbf{G}_d^{\\mathrm{unc}}(k) = \\begin{bmatrix}\nQ^{\\mathrm{LO}}_1(k) & 0 \\\\\n0 & Q^{\\mathrm{LO}}_2(k)\n\\end{bmatrix} \\mathrm{diag}(\\Sigma_{s,11},\\Sigma_{s,22}).\n$$\n- Coupled LO: $\\mathbf{S}_d = \\mathbf{S}$, so\n$$\n\\mathbf{G}_d^{\\mathrm{cpl}}(k) = \\begin{bmatrix}\nQ^{\\mathrm{LO}}_1(k) & 0 \\\\\n0 & Q^{\\mathrm{LO}}_2(k)\n\\end{bmatrix} \\mathbf{S}.\n$$\nThe preconditioned Richardson update for DSA uses the LO operator as a preconditioner for the error equation, yielding the error-propagation matrix\n$$\n\\mathbf{M}_{\\mathrm{DSA}}(k) = \\mathbf{I} - \\left(\\mathbf{I} - \\mathbf{G}_d(k)\\right)^{-1} \\left(\\mathbf{I} - \\mathbf{G}(k)\\right),\n$$\nwhere $\\mathbf{I}$ is the $2 \\times 2$ identity matrix and $\\mathbf{G}_d(k)$ is either $\\mathbf{G}_d^{\\mathrm{unc}}(k)$ or $\\mathbf{G}_d^{\\mathrm{cpl}}(k)$, depending on whether the low-order solves are uncoupled or coupled. The spectral radius $\\rho(\\cdot)$ of a matrix is defined as the maximum absolute value of its eigenvalues.\n\nYour task is to compute, for each provided parameter set, the following three quantities:\n1. The spectral radius $\\rho\\left(\\mathbf{G}(k)\\right)$ of source iteration without DSA.\n2. The spectral radius $\\rho\\left(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{unc}}(k)\\right)$ for DSA using uncoupled low-order solves.\n3. The spectral radius $\\rho\\left(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{cpl}}(k)\\right)$ for DSA using coupled low-order solves.\n\nAll inputs are physically plausible and use consistent units, but each spectral radius is dimensionless. Express each returned value as a floating-point number. Your program must compute these quantities for the test suite below and output the results for all cases as a single line containing a comma-separated list of lists, with each inner list ordered as\n$$\n\\left[\\rho\\left(\\mathbf{G}(k)\\right), \\ \\rho\\left(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{unc}}(k)\\right), \\ \\rho\\left(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{cpl}}(k)\\right)\\right].\n$$\nRound each floating-point result to six decimal places.\n\nTest suite (four cases):\n- Case A (moderate upscatter, moderate wavenumber):\n    - $k = 1.0 \\ \\mathrm{cm}^{-1}$,\n    - $\\Sigma_{r,1} = 1.0 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{r,2} = 0.8 \\ \\mathrm{cm}^{-1}$,\n    - $v_1 = 1.0 \\ \\mathrm{cm}$, $v_2 = 0.6 \\ \\mathrm{cm}$,\n    - $D_1 = 1.0 \\ \\mathrm{cm}$, $D_2 = 0.5 \\ \\mathrm{cm}$,\n    - $\\Sigma_{s,11} = 0.7 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,22} = 0.6 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,12} = 0.15 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,21} = 0.10 \\ \\mathrm{cm}^{-1}$.\n- Case B (no upscatter boundary condition, lower wavenumber):\n    - $k = 0.5 \\ \\mathrm{cm}^{-1}$,\n    - $\\Sigma_{r,1} = 1.0 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{r,2} = 0.8 \\ \\mathrm{cm}^{-1}$,\n    - $v_1 = 1.0 \\ \\mathrm{cm}$, $v_2 = 0.6 \\ \\mathrm{cm}$,\n    - $D_1 = 0.8 \\ \\mathrm{cm}$, $D_2 = 0.4 \\ \\mathrm{cm}$,\n    - $\\Sigma_{s,11} = 0.6 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,22} = 0.55 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,12} = 0.00 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,21} = 0.12 \\ \\mathrm{cm}^{-1}$.\n- Case C (strong upscatter, long-wavelength mode):\n    - $k = 0.2 \\ \\mathrm{cm}^{-1}$,\n    - $\\Sigma_{r,1} = 1.0 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{r,2} = 0.8 \\ \\mathrm{cm}^{-1}$,\n    - $v_1 = 1.0 \\ \\mathrm{cm}$, $v_2 = 1.2 \\ \\mathrm{cm}$,\n    - $D_1 = 1.2 \\ \\mathrm{cm}$, $D_2 = 0.7 \\ \\mathrm{cm}$,\n    - $\\Sigma_{s,11} = 0.6 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,22} = 0.5 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,12} = 0.30 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,21} = 0.05 \\ \\mathrm{cm}^{-1}$.\n- Case D (higher wavenumber, stronger removal in group 2):\n    - $k = 3.0 \\ \\mathrm{cm}^{-1}$,\n    - $\\Sigma_{r,1} = 0.9 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{r,2} = 1.1 \\ \\mathrm{cm}^{-1}$,\n    - $v_1 = 1.0 \\ \\mathrm{cm}$, $v_2 = 0.7 \\ \\mathrm{cm}$,\n    - $D_1 = 1.3 \\ \\mathrm{cm}$, $D_2 = 0.6 \\ \\mathrm{cm}$,\n    - $\\Sigma_{s,11} = 0.7 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,22} = 0.6 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,12} = 0.25 \\ \\mathrm{cm}^{-1}$, $\\Sigma_{s,21} = 0.10 \\ \\mathrm{cm}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of the four inner lists, each inner list ordered as described above and rounded to six decimal places. For example, the output should look like\n$$\n[\\text{[}\\rho(G),\\rho(M_{\\mathrm{DSA}}^{\\mathrm{unc}}),\\rho(M_{\\mathrm{DSA}}^{\\mathrm{cpl}})\\text{]},\\dots]\n$$\nwith numeric values filled in for each case.",
            "solution": "The objective is to compute three spectral radii for four distinct parameter sets, characterizing the convergence behavior of Source Iteration (SI) and both uncoupled and coupled DSA methods for a two-group, one-dimensional transport problem. The spectral radius, $\\rho(\\mathbf{A})$, of an iteration matrix $\\mathbf{A}$ governs the asymptotic error reduction rate of an iterative method; a smaller spectral radius implies faster convergence.\n\nThe core of the problem involves the construction and analysis of three $2 \\times 2$ iteration matrices for a given spatial Fourier mode of wavenumber $k$. The methodology is as follows:\n\nFirst, we define the primary matrices based on the provided parameters for each case: $k$, group removal cross-sections $\\Sigma_{r,g}$, effective streaming scales $v_g$, diffusion coefficients $D_g$, and scattering cross-sections $\\Sigma_{s,ij}$ for groups $g, i, j \\in \\{1,2\\}$.\n\nThe scattering matrix $\\mathbf{S}$ is given by:\n$$\n\\mathbf{S} = \\begin{bmatrix}\n\\Sigma_{s,11} & \\Sigma_{s,12} \\\\\n\\Sigma_{s,21} & \\Sigma_{s,22}\n\\end{bmatrix}\n$$\n\nThe Fourier symbols for the high-order (HO) transport sweep operator and the low-order (LO) diffusion operator are diagonal matrices in group space.\nThe HO operator's symbol is $\\mathbf{Q}^{\\mathrm{HO}}(k) = \\mathrm{diag}(Q^{\\mathrm{HO}}_1(k), Q^{\\mathrm{HO}}_2(k))$, where:\n$$\nQ^{\\mathrm{HO}}_g(k) = \\frac{1}{\\Sigma_{r,g} + v_g |k|}\n$$\nThe LO operator's symbol is $\\mathbf{Q}^{\\mathrm{LO}}(k) = \\mathrm{diag}(Q^{\\mathrm{LO}}_1(k), Q^{\\mathrm{LO}}_2(k))$, where:\n$$\nQ^{\\mathrm{LO}}_g(k) = \\frac{1}{\\Sigma_{r,g} + D_g k^2}\n$$\n\nUsing these, we construct the iteration matrices.\n\n1.  **Source Iteration (SI) Matrix:**\n    The SI error-propagation matrix $\\mathbf{G}(k)$ is the product of the HO operator symbol and the scattering matrix:\n    $$\n    \\mathbf{G}(k) = \\mathbf{Q}^{\\mathrm{HO}}(k) \\mathbf{S} = \\begin{bmatrix}\n    Q^{\\mathrm{HO}}_1(k) \\Sigma_{s,11} & Q^{\\mathrm{HO}}_1(k) \\Sigma_{s,12} \\\\\n    Q^{\\mathrm{HO}}_2(k) \\Sigma_{s,21} & Q^{\\mathrm{HO}}_2(k) \\Sigma_{s,22}\n    \\end{bmatrix}\n    $$\n    The spectral radius $\\rho(\\mathbf{G}(k))$ is computed. A value close to $1$ indicates slow convergence, which is typical for SI in optically thick, scattering-dominated regimes.\n\n2.  **Uncoupled DSA Matrix:**\n    For uncoupled DSA, the low-order problem neglects inter-group scattering. The corresponding LO iteration matrix $\\mathbf{G}_d^{\\mathrm{unc}}(k)$ uses a diagonalized scattering matrix $\\mathbf{S}_d = \\mathrm{diag}(\\Sigma_{s,11}, \\Sigma_{s,22})$:\n    $$\n    \\mathbf{G}_d^{\\mathrm{unc}}(k) = \\mathbf{Q}^{\\mathrm{LO}}(k) \\mathbf{S}_d = \\begin{bmatrix}\n    Q^{\\mathrm{LO}}_1(k) \\Sigma_{s,11} & 0 \\\\\n    0 & Q^{\\mathrm{LO}}_2(k) \\Sigma_{s,22}\n    \\end{bmatrix}\n    $$\n    The uncoupled DSA iteration matrix $\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{unc}}(k)$ is then:\n    $$\n    \\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{unc}}(k) = \\mathbf{I} - \\left(\\mathbf{I} - \\mathbf{G}_d^{\\mathrm{unc}}(k)\\right)^{-1} \\left(\\mathbf{I} - \\mathbf{G}(k)\\right)\n    $$\n    Its spectral radius $\\rho(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{unc}}(k))$ is computed.\n\n3.  **Coupled DSA Matrix:**\n    For coupled DSA, the low-order problem retains the full scattering matrix $\\mathbf{S}$. The LO iteration matrix $\\mathbf{G}_d^{\\mathrm{cpl}}(k)$ is:\n    $$\n    \\mathbf{G}_d^{\\mathrm{cpl}}(k) = \\mathbf{Q}^{\\mathrm{LO}}(k) \\mathbf{S} = \\begin{bmatrix}\n    Q^{\\mathrm{LO}}_1(k) \\Sigma_{s,11} & Q^{\\mathrm{LO}}_1(k) \\Sigma_{s,12} \\\\\n    Q^{\\mathrm{LO}}_2(k) \\Sigma_{s,21} & Q^{\\mathrm{LO}}_2(k) \\Sigma_{s,22}\n    \\end{bmatrix}\n    $$\n    The coupled DSA iteration matrix $\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{cpl}}(k)$ is:\n    $$\n    \\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{cpl}}(k) = \\mathbf{I} - \\left(\\mathbf{I} - \\mathbf{G}_d^{\\mathrm{cpl}}(k)\\right)^{-1} \\left(\\mathbf{I} - \\mathbf{G}(k)\\right)\n    $$\n    Its spectral radius $\\rho(\\mathbf{M}_{\\mathrm{DSA}}^{\\mathrm{cpl}}(k))$ is computed.\n\nFor each $2 \\times 2$ matrix $\\mathbf{A}$, the spectral radius is found by first computing its two eigenvalues, $\\lambda_1$ and $\\lambda_2$, by solving the characteristic equation $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$. The spectral radius is then $\\rho(\\mathbf{A}) = \\max(|\\lambda_1|, |\\lambda_2|)$. This procedure will be implemented numerically for each of the four test cases.",
            "answer": "$$[[0.413794,0.370833,0.083333],[0.435775,0.063830,0.063830],[0.749724,0.478954,0.119777],[0.201666,0.160136,0.052865]]$$"
        }
    ]
}