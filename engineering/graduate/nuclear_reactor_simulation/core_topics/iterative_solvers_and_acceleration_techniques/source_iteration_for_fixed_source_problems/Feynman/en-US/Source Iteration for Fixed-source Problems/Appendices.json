{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any numerical transport solver lies in the discretization of the continuous transport equation. This exercise guides you through the derivation of the update rule for the widely used diamond-difference spatial discretization scheme . By integrating the transport equation over a single spatial cell and applying the diamond-difference closure, you will transform a differential equation into a fundamental algebraic relationship, providing a crucial building block for constructing a full transport sweep.",
            "id": "4250937",
            "problem": "Consider a one-dimensional slab of material subdivided into spatial cells indexed by $i$, each of uniform width $h$. A steady-state, monoenergetic fixed-source transport problem is to be solved using the Discrete Ordinates method (Spherical Harmonics in N discrete directions, $S_{N}$). For an ordinate (angular direction) indexed by $m$ with direction cosine $\\mu_{m}0$, the angular flux $\\psi_{m}(x)$ satisfies the one-dimensional linear transport equation\n$$\n\\mu_{m}\\,\\frac{d\\psi_{m}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}(x) = q_{m}(x),\n$$\nwhere $\\Sigma_{t}$ is the total macroscopic cross section, and $q_{m}(x)$ is the total fixed source for direction $m$, which may include external and scattering contributions. In source iteration, the source is lagged: at iteration index $k+1$, the source is taken from the previous iterate $k$, and one sweeps to update $\\psi_{m}(x)$.\n\nDefine the $i$th cell edges as $x_{i-1/2}$ and $x_{i+1/2}$, and denote the inflow and outflow edge angular fluxes for $\\mu_{m}0$ by $\\psi_{m,i-1}^{(k+1)} \\equiv \\psi_{m}(x_{i-1/2})$ and $\\psi_{m,i}^{(k+1)} \\equiv \\psi_{m}(x_{i+1/2})$, respectively. Let the cell-averaged (lagged) source be\n$$\n\\bar{q}_{m,i}^{(k)} \\equiv \\frac{1}{h}\\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x)\\,dx.\n$$\nUnder the diamond-difference spatial closure, the cell-averaged angular flux is approximated by the average of the edge values,\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} \\approx \\frac{1}{2}\\left(\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}\\right).\n$$\n\nStarting from the transport equation and using only the definitions above, derive the discrete source iteration update for the diamond-difference scheme that expresses the outflow edge flux $\\psi_{m,i}^{(k+1)}$ in terms of the inflow edge flux $\\psi_{m,i-1}^{(k+1)}$, the total macroscopic cross section $\\Sigma_{t}$, the cell width $h$, and the cell-averaged source $\\bar{q}_{m,i}^{(k)}$. Provide your final expression in exact symbolic form. No numerical evaluation is required.",
            "solution": "The problem is valid as it is scientifically grounded in the established principles of transport theory, specifically the Discrete Ordinates method with diamond-differencing. It is well-posed, objective, and contains all necessary information for a formal derivation without any contradictions or ambiguities.\n\nThe starting point for the derivation is the one-dimensional, steady-state, monoenergetic transport equation for a discrete direction $m$ with direction cosine $\\mu_m  0$. Under the source iteration method, the equation for iteration $k+1$ is given by:\n$$\n\\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) = q_{m}^{(k)}(x)\n$$\nHere, $\\psi_{m}^{(k+1)}(x)$ is the angular flux at position $x$ and iteration $k+1$, $\\Sigma_t$ is the constant total macroscopic cross section, and $q_{m}^{(k)}(x)$ is the total source, evaluated using quantities from the previous iteration, $k$.\n\nTo discretize this equation over a spatial cell $i$, we integrate it over the cell width $h$, from edge $x_{i-1/2}$ to edge $x_{i+1/2}$:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) \\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x)\\,dx\n$$\nWe evaluate each term of the integrated equation. The first term on the left side is integrated directly using the fundamental theorem of calculus:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} dx = \\mu_{m} \\left[ \\psi_{m}^{(k+1)}(x) \\right]_{x_{i-1/2}}^{x_{i+1/2}} = \\mu_{m} \\left( \\psi_{m}^{(k+1)}(x_{i+1/2}) - \\psi_{m}^{(k+1)}(x_{i-1/2}) \\right)\n$$\nUsing the problem's notation for the inflow and outflow edge fluxes, $\\psi_{m,i-1}^{(k+1)} \\equiv \\psi_{m}^{(k+1)}(x_{i-1/2})$ and $\\psi_{m,i}^{(k+1)} \\equiv \\psi_{m}^{(k+1)}(x_{i+1/2})$, this term becomes:\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right)\n$$\nThe second term on the left side involves the integral of the angular flux over the cell. We can express this using the definition of the cell-averaged angular flux, $\\bar{\\psi}_{m,i}^{(k+1)}$:\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi_{m}^{(k+1)}(x) dx\n$$\nThus, the second term becomes:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) dx = \\Sigma_{t} \\left( h \\bar{\\psi}_{m,i}^{(k+1)} \\right) = h \\Sigma_{t} \\bar{\\psi}_{m,i}^{(k+1)}\n$$\nThe term on the right side is the integral of the source over the cell. Using the problem's definition for the cell-averaged source, $\\bar{q}_{m,i}^{(k)}$:\n$$\n\\bar{q}_{m,i}^{(k)} = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x) dx\n$$\nThe right side of the equation becomes:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x) dx = h \\bar{q}_{m,i}^{(k)}\n$$\nCombining these results, we obtain the spatially discretized \"balance\" equation for cell $i$:\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right) + h \\Sigma_{t} \\bar{\\psi}_{m,i}^{(k+1)} = h \\bar{q}_{m,i}^{(k)}\n$$\nThis equation contains three unknowns: the two edge fluxes $\\psi_{m,i-1}^{(k+1)}$ and $\\psi_{m,i}^{(k+1)}$, and the cell-averaged flux $\\bar{\\psi}_{m,i}^{(k+1)}$. To solve this, we need an additional equation, known as a closure relation. The problem specifies the use of the diamond-difference (DD) closure, which relates the cell-averaged flux to the average of the edge fluxes:\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} = \\frac{1}{2}\\left(\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}\\right)\n$$\nWe substitute this DD closure relation into the balance equation:\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right) + h \\Sigma_{t} \\left( \\frac{\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}}{2} \\right) = h \\bar{q}_{m,i}^{(k)}\n$$\nThe final step is to algebraically solve for the outflow flux, $\\psi_{m,i}^{(k+1)}$, in terms of the known inflow flux, $\\psi_{m,i-1}^{(k+1)}$, and the source term, $\\bar{q}_{m,i}^{(k)}$. We expand and rearrange the equation to group terms involving $\\psi_{m,i}^{(k+1)}$ on the left-hand side and all other terms on the right-hand side.\n$$\n\\mu_{m} \\psi_{m,i}^{(k+1)} - \\mu_{m} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\Sigma_{t}}{2} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\Sigma_{t}}{2} \\psi_{m,i}^{(k+1)} = h \\bar{q}_{m,i}^{(k)}\n$$\n$$\n\\psi_{m,i}^{(k+1)} \\left( \\mu_{m} + \\frac{h \\Sigma_{t}}{2} \\right) - \\psi_{m,i-1}^{(k+1)} \\left( \\mu_{m} - \\frac{h \\Sigma_{t}}{2} \\right) = h \\bar{q}_{m,i}^{(k)}\n$$\n$$\n\\psi_{m,i}^{(k+1)} \\left( \\mu_{m} + \\frac{h \\Sigma_{t}}{2} \\right) = \\psi_{m,i-1}^{(k+1)} \\left( \\mu_{m} - \\frac{h \\Sigma_{t}}{2} \\right) + h \\bar{q}_{m,i}^{(k)}\n$$\nIsolating $\\psi_{m,i}^{(k+1)}$ gives the final update equation:\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{\\mu_{m} - \\frac{h \\Sigma_{t}}{2}}{\\mu_{m} + \\frac{h \\Sigma_{t}}{2}} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\bar{q}_{m,i}^{(k)}}{\\mu_{m} + \\frac{h \\Sigma_{t}}{2}}\n$$\nTo present this expression with a common denominator and remove fractions in the numerator and denominator, we can multiply the numerator and denominator of each term by $2$:\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{2\\left(\\mu_{m} - \\frac{h \\Sigma_{t}}{2}\\right)}{2\\left(\\mu_{m} + \\frac{h \\Sigma_{t}}{2}\\right)} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\left(\\mu_{m} + \\frac{h \\Sigma_{t}}{2}\\right)}\n$$\nThis results in the final form of the diamond-difference source iteration update:\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{2\\mu_{m} - h \\Sigma_{t}}{2\\mu_{m} + h \\Sigma_{t}} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\mu_{m} + h \\Sigma_{t}}\n$$\nThis expression gives the outflow edge flux for cell $i$ explicitly in terms of its inflow edge flux and the cell-averaged source, which was the objective of the problem.",
            "answer": "$$\n\\boxed{\\psi_{m,i}^{(k+1)} = \\frac{2\\mu_{m} - h \\Sigma_{t}}{2\\mu_{m} + h \\Sigma_{t}} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\mu_{m} + h \\Sigma_{t}}}\n$$"
        },
        {
            "introduction": "To make the abstract iterative process concrete, this problem presents a hands-on calculation for a single step of source iteration in a simplified, spatially uniform system . You will apply the core loop of the algorithm: using angular quadrature to compute a scalar flux, updating the scattering source, and then calculating the new flux for the next iteration. This practice helps solidify the mechanics of the discrete ordinates method and the flow of the source iteration procedure.",
            "id": "4250946",
            "problem": "Consider a one-speed, steady-state Boltzmann transport equation in one-dimensional slab geometry for a homogeneous, infinite medium with isotropic external source and isotropic scattering. Let the discrete ordinates ($S_N$) method with order four, denoted $S_4$, be used to approximate angular integrals by a Gauss–Legendre quadrature over the cosine-of-angle variable $ \\mu \\in [-1,1] $. The governing equation along ordinate $m$ is\n$$\n\\mu_m \\frac{\\partial \\psi_m(x)}{\\partial x} + \\Sigma_t \\psi_m(x) = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi(x),\n$$\nwhere $ \\psi_m(x) $ is the angular flux for direction cosine $ \\mu_m $, $ \\Sigma_t $ is the total macroscopic cross section, $ \\Sigma_s $ is the scattering macroscopic cross section, $ q_{\\mathrm{ext}} $ is the isotropic external volumetric source, and $ \\phi(x) $ is the scalar flux defined by the zeroth angular moment of $ \\psi(x,\\mu) $.\n\nUnder the assumption of an infinite, homogeneous medium, spatial uniformity implies $ \\frac{\\partial \\psi_m}{\\partial x} = 0 $ for all directions, so the equation simplifies locally. In source iteration for a fixed-source problem, the angular flux at iteration $k+1$ is obtained by using the scalar flux from iteration $k$ in the scattering source.\n\nUsing $S_4$ quadrature, take the four direction cosines and associated weights as\n$$\n\\mu_1 = -0.8611363116,\\quad w_1 = 0.3478548451;\\qquad\n\\mu_2 = -0.3399810436,\\quad w_2 = 0.6521451549;\n$$\n$$\n\\mu_3 = 0.3399810436,\\quad w_3 = 0.6521451549;\\qquad\n\\mu_4 = 0.8611363116,\\quad w_4 = 0.3478548451.\n$$\nAt a representative point, the initial angular flux iterate is\n$$\n\\psi_1^{(0)} = 4.10 \\times 10^{4},\\quad\n\\psi_2^{(0)} = 4.40 \\times 10^{4},\\quad\n\\psi_3^{(0)} = 5.00 \\times 10^{4},\\quad\n\\psi_4^{(0)} = 5.30 \\times 10^{4},\n$$\nand the material and source parameters are\n$$\n\\Sigma_t = 1.00\\ \\mathrm{cm}^{-1},\\qquad\n\\Sigma_s = 0.80\\ \\mathrm{cm}^{-1},\\qquad\nq_{\\mathrm{ext}} = 1.20 \\times 10^{5}\\ \\mathrm{n\\ cm^{-3}\\ s^{-1}}.\n$$\n\nStarting from first principles for the transport equation and the definition of angular moments, perform the first source iteration update to compute the scalar flux $ \\phi^{(1)} $ at the point using the given $S_4$ quadrature. Then, verify conservation of the zeroth Legendre moment ($P_0$ moment) of the isotropic source terms under the $S_4$ quadrature.\n\nRound your final numerical value for $ \\phi^{(1)} $ to four significant figures. Express your final answer for the scalar flux in neutrons per square-centimeter per second (n cm$^{-2}$ s$^{-1}$).",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, and objective, providing all necessary information to proceed with a solution.\n\nThe problem asks for two tasks: first, to compute the scalar flux $\\phi^{(1)}$ after one source iteration, and second, to verify the conservation of the zeroth moment of the isotropic source under the given quadrature scheme.\n\nThe one-speed, steady-state discrete ordinates transport equation in one-dimensional slab geometry for an ordinate direction $m$ is given as:\n$$\n\\mu_m \\frac{\\partial \\psi_m(x)}{\\partial x} + \\Sigma_t \\psi_m(x) = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi(x)\n$$\nUnder the given assumption of an infinite, homogeneous medium, the system is spatially uniform, which implies that the gradient of the angular flux is zero, $\\frac{\\partial \\psi_m(x)}{\\partial x} = 0$. The equation simplifies to an algebraic relation at any point $x$:\n$$\n\\Sigma_t \\psi_m(x) = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi(x)\n$$\nThe source iteration method updates the angular flux at iteration $k+1$ using the scalar flux from the previous iteration $k$:\n$$\n\\Sigma_t \\psi_m^{(k+1)} = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi^{(k)}\n$$\nFrom this, the angular flux for the next iteration can be explicitly found:\n$$\n\\psi_m^{(k+1)} = \\frac{1}{\\Sigma_t} \\left( \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi^{(k)} \\right)\n$$\nThe scalar flux $\\phi$ is the zeroth angular moment of the angular flux $\\psi(x,\\mu)$, defined as $\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\, d\\mu$. In the discrete ordinates approximation, this integral is replaced by a quadrature sum:\n$$\n\\phi^{(k)} = \\sum_{m=1}^{N} w_m \\psi_m^{(k)}\n$$\nwhere $N$ is the order of the quadrature, which is $N=4$ for the $S_4$ method.\n\n**Part 1: Calculation of the scalar flux $\\phi^{(1)}$**\n\nFirst, we compute the scalar flux at the initial iteration, $\\phi^{(0)}$, using the given initial angular fluxes $\\psi_m^{(0)}$ and the $S_4$ quadrature weights $w_m$.\n$$\n\\phi^{(0)} = \\sum_{m=1}^{4} w_m \\psi_m^{(0)} = w_1 \\psi_1^{(0)} + w_2 \\psi_2^{(0)} + w_3 \\psi_3^{(0)} + w_4 \\psi_4^{(0)}\n$$\nThe quadrature set is symmetric, with $w_1 = w_4$ and $w_2 = w_3$. We can group the terms:\n$$\n\\phi^{(0)} = w_1(\\psi_1^{(0)} + \\psi_4^{(0)}) + w_2(\\psi_2^{(0)} + \\psi_3^{(0)})\n$$\nSubstituting the given values:\n$w_1 = 0.3478548451$\n$w_2 = 0.6521451549$\n$\\psi_1^{(0)} = 4.10 \\times 10^{4}$\n$\\psi_2^{(0)} = 4.40 \\times 10^{4}$\n$\\psi_3^{(0)} = 5.00 \\times 10^{4}$\n$\\psi_4^{(0)} = 5.30 \\times 10^{4}$\n\n$$\n\\phi^{(0)} = 0.3478548451 \\times (4.10 \\times 10^{4} + 5.30 \\times 10^{4}) + 0.6521451549 \\times (4.40 \\times 10^{4} + 5.00 \\times 10^{4})\n$$\n$$\n\\phi^{(0)} = 0.3478548451 \\times (9.40 \\times 10^{4}) + 0.6521451549 \\times (9.40 \\times 10^{4})\n$$\n$$\n\\phi^{(0)} = (0.3478548451 + 0.6521451549) \\times (9.40 \\times 10^{4})\n$$\n$$\n\\phi^{(0)} = (1.0000000000) \\times (9.40 \\times 10^{4}) = 9.40 \\times 10^{4} \\ \\mathrm{n\\ cm^{-2}\\ s^{-1}}\n$$\n\nNext, we use $\\phi^{(0)}$ to compute the source term for the first iteration. The total isotropic source for the update is $S^{(0)} = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi^{(0)}$.\nGiven:\n$\\Sigma_s = 0.80\\ \\mathrm{cm}^{-1}$\n$q_{\\mathrm{ext}} = 1.20 \\times 10^{5}\\ \\mathrm{n\\ cm^{-3}\\ s^{-1}}$\n\n$$\nS^{(0)} = \\frac{1.20 \\times 10^{5}}{2} + \\frac{0.80}{2} \\times (9.40 \\times 10^{4})\n$$\n$$\nS^{(0)} = 6.00 \\times 10^{4} + 0.40 \\times 9.40 \\times 10^{4} = 6.00 \\times 10^{4} + 3.76 \\times 10^{4} = 9.76 \\times 10^{4} \\ \\mathrm{n\\ cm^{-3}\\ s^{-1}}\n$$\nNow, we calculate the updated angular flux $\\psi_m^{(1)}$. Since the source term $S^{(0)}$ is isotropic (independent of angle $\\mu_m$) and due to the infinite medium simplification, the updated angular flux $\\psi_m^{(1)}$ will be the same for all directions $m=1, 2, 3, 4$.\n$$\n\\psi_m^{(1)} = \\frac{S^{(0)}}{\\Sigma_t}\n$$\nGiven $\\Sigma_t = 1.00\\ \\mathrm{cm}^{-1}$:\n$$\n\\psi_m^{(1)} = \\frac{9.76 \\times 10^{4}}{1.00} = 9.76 \\times 10^{4} \\ \\mathrm{n\\ cm^{-2}\\ s^{-1}}\n$$\nFinally, we compute the updated scalar flux $\\phi^{(1)}$ by taking the zeroth moment of $\\psi_m^{(1)}$:\n$$\n\\phi^{(1)} = \\sum_{m=1}^{4} w_m \\psi_m^{(1)}\n$$\nSince $\\psi_m^{(1)}$ is constant for all $m$, we can factor it out of the summation:\n$$\n\\phi^{(1)} = \\psi_m^{(1)} \\sum_{m=1}^{4} w_m\n$$\nThe sum of the weights for a Gauss-Legendre quadrature over the interval $[-1, 1]$ is $\\int_{-1}^{1} 1 \\, d\\mu = 2$. Let's verify:\n$\\sum_{m=1}^{4} w_m = w_1 + w_2 + w_3 + w_4 = 2(w_1+w_2) = 2(0.3478548451 + 0.6521451549) = 2(1.0000000000) = 2$.\nTherefore:\n$$\n\\phi^{(1)} = (9.76 \\times 10^{4}) \\times 2 = 19.52 \\times 10^{4} = 1.952 \\times 10^{5} \\ \\mathrm{n\\ cm^{-2}\\ s^{-1}}\n$$\nThe problem requests the answer to four significant figures, which is $1.952 \\times 10^5$.\n\n**Part 2: Verification of Zeroth Moment Conservation**\n\nThe second task is to verify the conservation of the zeroth Legendre moment ($P_0$ moment) of the isotropic source terms under the $S_4$ quadrature. The isotropic source term on the right-hand side of the transport equation is $S(x) = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi(x)$. This term is a function of position $x$ but is constant with respect to the angular variable $\\mu$.\n\nThe zeroth Legendre moment of a function $f(\\mu)$ is defined as $\\int_{-1}^{1} f(\\mu) P_0(\\mu) \\, d\\mu$, where $P_0(\\mu) = 1$. Thus, the moment is simply the integral of the function over the interval $[-1, 1]$.\n\nFor the isotropic source term $S(x)$, the analytical zeroth moment is:\n$$\n\\int_{-1}^{1} S(x) \\, d\\mu = S(x) \\int_{-1}^{1} d\\mu = S(x) [\\mu]_{-1}^{1} = S(x) (1 - (-1)) = 2S(x)\n$$\nSubstituting the expression for $S(x)$, the exact zeroth moment of the source is:\n$$\n2 \\left( \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi(x) \\right) = q_{\\mathrm{ext}} + \\Sigma_s \\phi(x)\n$$\nThis is the total scalar source strength, as expected.\n\nNow, we evaluate this moment using the $S_4$ discrete ordinates quadrature:\n$$\n\\sum_{m=1}^{4} w_m S(x)\n$$\nSince $S(x)$ does not depend on the angle $\\mu_m$, it can be factored out of the summation:\n$$\nS(x) \\sum_{m=1}^{4} w_m\n$$\nAs established previously, the sum of the $S_4$ Gauss-Legendre quadrature weights is exactly $2$. Therefore, the quadrature approximation of the moment is:\n$$\nS(x) \\times 2 = 2S(x)\n$$\nThe result from the $S_4$ quadrature is identical to the analytical result. This demonstrates that the zeroth moment of the isotropic source is conserved exactly. This is a general property of Gauss-Legendre quadrature: an $N$-point quadrature exactly integrates any polynomial of degree up to $2N-1$. In this case, $N=4$, so polynomials up to degree $7$ are integrated exactly. The isotropic source term is constant in angle, which is a polynomial of degree $0$. Therefore, the $S_4$ quadrature integrates it without any error, and the zeroth moment is perfectly conserved.\n\nThe final answer for the scalar flux is $\\phi^{(1)}$.\n$$\n\\phi^{(1)} = 1.952 \\times 10^{5} \\ \\mathrm{n\\ cm^{-2}\\ s^{-1}}\n$$",
            "answer": "$$\n\\boxed{1.952 \\times 10^5}\n$$"
        },
        {
            "introduction": "Numerical methods often have limitations, and a critical analysis of their properties is essential for robust simulation. This advanced exercise delves into a key potential failure of the diamond-difference scheme: the violation of positivity, which can lead to unphysical negative fluxes . By deriving the conditions that guarantee a positive solution, you will not only understand the limitations of the method but also establish a direct link between the stability of the spatial discretization and the monotonic convergence of the source iteration itself.",
            "id": "4250966",
            "problem": "Consider the one-dimensional, steady-state, monoenergetic linear transport equation in slab geometry for angular flux $\\,\\psi(x,\\mu)\\,$,\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t(x)\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_s(x)}{2}\\,\\phi(x) \\;+\\; \\frac{q(x)}{2}\\,,\n$$\nwith scalar flux $\\,\\phi(x) = \\int_{-1}^{1}\\psi(x,\\mu)\\,d\\mu\\,$, total macroscopic cross section $\\,\\Sigma_t(x)  0\\,$, scattering cross section $\\,\\Sigma_s(x) \\in [0,\\Sigma_t(x))\\,$, and isotropic fixed external source $\\,q(x) \\ge 0\\,$. Discretize angle using the discrete ordinates (SN) method on a set of directions $\\{\\mu_m, w_m\\}_{m=1}^{M}$ with $\\mu_m \\in (-1,1)$ and positive weights $\\{w_m\\}$ satisfying $\\sum_{m=1}^{M} w_m = 2$. Discretize space on a uniform mesh of cell width $\\,h  0\\,$ with cell edges at $\\,x_{i \\pm 1/2}\\,$, and adopt the standard cell-balance finite-volume scheme with the diamond-difference closure\n$$\n\\psi_{i,m} \\;=\\; \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right)\\,,\n$$\nwhere $\\,\\psi_{i\\pm \\frac{1}{2},m}\\,$ are edge values and $\\,\\psi_{i,m}\\,$ is the cell-average surrogate in direction $\\,\\mu_m\\,$.\n\n(a) Starting from the cell-balance form of the transport equation over cell $\\,i\\,$ in a given direction with $\\,\\mu_m  0\\,$, derive the linear sweep relation\n$$\n\\psi_{i+\\frac{1}{2},m} \\;=\\; \\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m} \\;+\\; \\beta_{i,m}\\,Q_{i,m}\\,,\n$$\nwhere $\\,Q_{i,m}\\,$ is the known cell-averaged total source in direction $\\,\\mu_m\\,$ at the current iteration (including external and scattering contributions). Express $\\,\\alpha_{i,m}\\,$ and $\\,\\beta_{i,m}\\,$ in terms of $\\,\\mu_m\\,$, $\\,h\\,$, and $\\,\\Sigma_{t,i}\\,$. Identify the conditions on these coefficients that ensure a nonnegative incoming angular flux $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ and a nonnegative source $\\,Q_{i,m} \\ge 0\\,$ produce a nonnegative outgoing angular flux $\\,\\psi_{i+\\frac{1}{2},m} \\ge 0\\,$. Explain under what conditions the diamond-difference discretization may violate positivity.\n\n(b) Using your expressions, reduce the positivity conditions to a single sufficient inequality on the per-angle, per-cell optical thickness\n$$\n\\tau_{i,m} \\;:=\\; \\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|}\\,.\n$$\nState the resulting bound as an explicit inequality relating $\\,\\Sigma_{t,i}\\,$, $\\,h\\,$, and $\\,|\\mu_m|\\,$ for all cells $\\,i\\,$ and all angles $\\,m\\,$.\n\n(c) Consider source iteration for isotropic scattering with scattering ratio $\\,c := \\Sigma_s/\\Sigma_t \\in [0,1)\\,$. Let the scalar flux update be defined by solving the transport equation in each iteration with the total source $\\,Q_{i,m}^{(k)} = \\frac{1}{2} q_i + \\frac{\\Sigma_{s,i}}{2}\\,\\phi_i^{(k)}\\,$, and building $\\,\\phi^{(k+1)}\\,$ from the new angular flux by weighted summation. Prove that, if the transport sweep operator defined by the diamond-difference discretization is positive in the sense of part (a), then starting from $\\,\\phi^{(0)} \\equiv 0\\,$ and for $\\,q_i \\ge 0\\,$, the iterates $\\,\\phi^{(k)}\\,$ form a monotone nondecreasing sequence in the partial order induced by componentwise inequality.\n\n(d) Finally, for a homogeneous slab with $\\,\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}\\,$ and a symmetrically weighted quadrature whose smallest positive directional cosine is $\\,\\mu_{\\min} = 0.183434642\\,$, compute the largest uniform cell width $\\,h_{\\max}\\,$ in $\\,\\mathrm{cm}\\,$ that guarantees the monotonicity of source iteration updates under diamond-difference, as established in parts (a)–(c). Round your answer to $\\,4\\,$ significant figures and express it in $\\,\\mathrm{cm}\\,$.",
            "solution": "We begin from the one-dimensional, steady-state, monoenergetic linear transport equation discretized in angle and space. For a given cell $\\,i\\,$ of width $\\,h\\,$ spanning $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}}]\\,$ and a direction $\\,\\mu_m  0\\,$, the finite-volume balance over the cell gives\n$$\n\\mu_m\\,\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} \\;+\\; \\Sigma_{t,i}\\,\\psi_{i,m} \\;=\\; Q_{i,m}\\,,\n$$\nwhere $\\,Q_{i,m}\\,$ is the known total source per steradian within the cell for direction $\\,m\\,$ at the current iteration, and $\\,\\psi_{i,m}\\,$ is closed by the diamond-difference relation\n$$\n\\psi_{i,m} \\;=\\; \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right)\\,.\n$$\n\nPart (a). Substituting the diamond-difference closure into the balance yields\n$$\n\\mu_m\\,\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} \\;+\\; \\Sigma_{t,i}\\,\\frac{\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}}{2} \\;=\\; Q_{i,m}\\,.\n$$\nCollect the unknowns at $\\,x_{i+\\frac{1}{2}}\\,$ on the left:\n$$\n\\left(\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i+\\frac{1}{2},m} \\;+\\; \\left(-\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i-\\frac{1}{2},m} \\;=\\; Q_{i,m}\\,.\n$$\nSolving for $\\,\\psi_{i+\\frac{1}{2},m}\\,$ gives the linear sweep relation\n$$\n\\psi_{i+\\frac{1}{2},m} \\;=\\; \\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m} \\;+\\; \\beta_{i,m}\\,Q_{i,m}\\,,\n$$\nwith coefficients\n$$\n\\alpha_{i,m} \\;=\\; \\frac{\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}} \\;=\\; \\frac{2\\,\\frac{\\mu_m}{h} - \\Sigma_{t,i}}{2\\,\\frac{\\mu_m}{h} + \\Sigma_{t,i}}\\,,\n\\qquad\n\\beta_{i,m} \\;=\\; \\frac{1}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}}\\,.\n$$\nThe denominator $\\,\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\,$ is strictly positive for $\\,\\mu_m  0\\,$, $\\,h  0\\,$, and $\\,\\Sigma_{t,i}  0\\,$. Therefore $\\,\\beta_{i,m}  0\\,$ always. The sign of $\\,\\alpha_{i,m}\\,$ is determined by the numerator $\\,\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}\\,$. If $\\,\\alpha_{i,m} \\ge 0\\,$ and $\\,\\beta_{i,m}  0\\,$, then for $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ and $\\,Q_{i,m} \\ge 0\\,$, we have $\\,\\psi_{i+\\frac{1}{2},m} \\ge 0\\,$, establishing positivity of the sweep update in that direction. Conversely, if $\\,\\alpha_{i,m}  0\\,$, then even with $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ and $\\,Q_{i,m} \\ge 0\\,$, the term $\\,\\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m}\\,$ becomes nonpositive; if it dominates $\\,\\beta_{i,m}\\,Q_{i,m}\\,$, it can produce $\\,\\psi_{i+\\frac{1}{2},m}  0\\,$. Hence, the diamond-difference discretization may violate positivity when $\\,\\alpha_{i,m}  0\\,$, which occurs for sufficiently optically thick cells.\n\nPart (b). Introduce the per-angle, per-cell optical thickness\n$$\n\\tau_{i,m} \\;:=\\; \\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|}\\,.\n$$\nFor $\\,\\mu_m  0\\,$, we have\n$$\n\\alpha_{i,m} \\;=\\; \\frac{2 - \\tau_{i,m}}{2 + \\tau_{i,m}}\\,.\n$$\nPositivity of the sweep mapping for nonnegative incoming flux and nonnegative source is ensured if and only if $\\,\\alpha_{i,m} \\ge 0\\,$ and $\\,\\beta_{i,m}  0\\,$. As argued, $\\,\\beta_{i,m}  0\\,$ always. Thus, the sufficient condition reduces to\n$$\n\\alpha_{i,m} \\;\\ge\\; 0 \\quad \\Longleftrightarrow \\quad 2 - \\tau_{i,m} \\;\\ge\\; 0 \\quad \\Longleftrightarrow \\quad \\tau_{i,m} \\;\\le\\; 2\\,.\n$$\nBy symmetry, for $\\,\\mu_m  0\\,$ the same condition with $\\,|\\mu_m|\\,$ applies. Therefore, a sufficient positivity condition for the diamond-difference sweep in every cell and every discrete direction is\n$$\n\\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|} \\;\\le\\; 2 \\quad \\text{for all cells } i \\text{ and all angles } m\\,,\n$$\nequivalently,\n$$\nh \\;\\le\\; \\frac{2\\,|\\mu_m|}{\\Sigma_{t,i}} \\quad \\text{for all } i,m\\,.\n$$\nOn a given mesh and angle set, the most restrictive bound uses the smallest positive directional cosine $\\,\\mu_{\\min} := \\min_{m:\\, \\mu_m  0} \\mu_m\\,$ and the largest cell-wise total cross section $\\,\\Sigma_{t,\\max} := \\max_i \\Sigma_{t,i}\\,$, giving the global sufficient condition\n$$\nh \\;\\le\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_{t,\\max}}\\,.\n$$\n\nPart (c). Let $\\,\\mathcal{L}\\,$ denote the transport operator mapping an angular flux to its streaming-plus-absorption residual, discretized in space and angle with diamond-difference, and let $\\,\\mathcal{L}^{-1}\\,$ denote the corresponding sweep operator that maps a given total source $\\,Q\\,$ to the unique upwinded angular flux $\\,\\psi\\,$. Under the condition from part (b), each cell-angle sweep update has nonnegative coefficients that depend only on local data, so $\\,\\mathcal{L}^{-1}\\,$ is a positive linear operator: for any two total sources $\\,Q,Q'\\,$ with $\\,Q \\ge Q'\\,$ componentwise, one has $\\,\\mathcal{L}^{-1}Q \\ge \\mathcal{L}^{-1}Q'\\,$ componentwise.\n\nFor isotropic scattering with scattering ratio $\\,c = \\Sigma_s/\\Sigma_t \\in [0,1)\\,$, define the positive linear scattering operator $\\,\\mathcal{S}\\,$ that maps a scalar flux $\\,\\phi\\,$ to the isotropic angular source with components $\\,(\\mathcal{S}\\phi)_{i,m} = \\frac{\\Sigma_{s,i}}{2}\\,\\phi_i\\,$. The external source $\\,q\\,$ induces a nonnegative isotropic angular source $\\,\\mathcal{Q}_{\\mathrm{ext}}\\,$ with components $\\,(\\mathcal{Q}_{\\mathrm{ext}})_{i,m} = \\frac{q_i}{2}\\,$. Source iteration is the fixed-point iteration\n$$\n\\psi^{(k+1)} \\;=\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k)}\\right), \\qquad \\phi^{(k+1)} \\;=\\; \\sum_{m=1}^{M} w_m\\,\\psi^{(k+1)}_{(\\cdot),m}\\,,\n$$\nwith initialization $\\,\\phi^{(0)} \\equiv 0\\,$. Let the angular-to-scalar averaging operator $\\,\\mathcal{A}\\,$ be defined by $\\,\\mathcal{A}\\psi = \\sum_{m=1}^{M} w_m\\,\\psi_{(\\cdot),m}\\,$; this operator has nonnegative weights and is therefore positive in the order sense.\n\nWe prove by induction that $\\,\\phi^{(k)}\\,$ is monotone nondecreasing. The base case: $\\,\\phi^{(0)} = 0\\,$. Then $\\,\\psi^{(1)} = \\mathcal{L}^{-1}\\mathcal{Q}_{\\mathrm{ext}} \\ge 0\\,$ because $\\,\\mathcal{Q}_{\\mathrm{ext}} \\ge 0\\,$ and $\\,\\mathcal{L}^{-1}\\,$ is positive. Consequently $\\,\\phi^{(1)} = \\mathcal{A}\\psi^{(1)} \\ge 0 = \\phi^{(0)}\\,$. Assume $\\,\\phi^{(k)} \\ge \\phi^{(k-1)}\\,$. Since $\\,\\mathcal{S}\\,$ is positive, $\\,\\mathcal{S}\\,\\phi^{(k)} \\ge \\mathcal{S}\\,\\phi^{(k-1)}\\,$. Therefore\n$$\n\\psi^{(k+1)} \\;=\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k)}\\right) \\;\\ge\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k-1)}\\right) \\;=\\; \\psi^{(k)}\\,,\n$$\nby the positivity of $\\,\\mathcal{L}^{-1}\\,$. Applying the positive averaging operator $\\,\\mathcal{A}\\,$, we obtain $\\,\\phi^{(k+1)} = \\mathcal{A}\\psi^{(k+1)} \\ge \\mathcal{A}\\psi^{(k)} = \\phi^{(k)}\\,$. Hence, $\\,\\{\\phi^{(k)}\\}\\,$ is a monotone nondecreasing sequence. This conclusion relies on the positivity (order-preserving property) of the sweep mapping, which is ensured by the bound $\\,\\tau_{i,m} \\le 2\\,$ from part (b).\n\nPart (d). In a homogeneous slab with $\\,\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}\\,$ and the smallest positive directional cosine $\\,\\mu_{\\min} = 0.183434642\\,$, the sufficient condition for positivity across all angles reduces to\n$$\nh \\;\\le\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_t}\\,.\n$$\nThus, the largest admissible uniform cell width is\n$$\nh_{\\max} \\;=\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_t} \\;=\\; \\frac{2 \\times 0.183434642}{1.2} \\;=\\; \\frac{0.366869284}{1.2} \\;=\\; 0.305724403\\ldots\\,.\n$$\nRounded to $\\,4\\,$ significant figures and expressed in $\\,\\mathrm{cm}\\,$, this gives\n$$\nh_{\\max} \\;=\\; 0.3057\\,.\n$$\nThis bound guarantees that the diamond-difference sweep operator is positive in every cell and direction, and therefore that source iteration updates are monotone nondecreasing under the stated hypotheses.",
            "answer": "$$\\boxed{0.3057}$$"
        }
    ]
}