{
    "hands_on_practices": [
        {
            "introduction": "为了在计算机上求解中子输运问题，我们首先必须将描述中子行为的连续微分方程转化为离散的代数方程组。本练习将指导您推导菱形差分（diamond-difference）格式，这是离散纵标法中一种经典且基础的空间离散化方法。掌握这一推导过程是理解输运计算程序中空间扫描（sweep）如何实现的关键，它构成了源迭代算法的计算基础。",
            "id": "4250937",
            "problem": "考虑一个一维材料平板，它被细分为索引为 $i$ 的空间网格，每个网格的宽度均为 $h$。一个稳态、单能、有源输运问题将使用离散纵标法（$S_{N}$ 法，即在 $N$ 个离散方向上求解角通量）来求解。对于方向余弦 $\\mu_{m}>0$、索引为 $m$ 的一个纵标（角方向），角通量 $\\psi_{m}(x)$ 满足一维线性输运方程\n$$\n\\mu_{m}\\,\\frac{d\\psi_{m}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}(x) = q_{m}(x),\n$$\n其中 $\\Sigma_{t}$ 是总宏观截面，而 $q_{m}(x)$ 是方向 $m$ 的总固定源，它可能包括外部源和散射贡献。在源迭代中，源项是滞后的：在第 $k+1$ 次迭代时，源项取自上一次迭代 $k$ 的结果，然后进行扫描以更新 $\\psi_{m}(x)$。\n\n将第 $i$ 个网格的边界定义为 $x_{i-1/2}$ 和 $x_{i+1/2}$，并分别用 $\\psi_{m,i-1}^{(k+1)} \\equiv \\psi_{m}(x_{i-1/2})$ 和 $\\psi_{m,i}^{(k+1)} \\equiv \\psi_{m}(x_{i+1/2})$ 表示 $\\mu_{m}>0$ 时的入射和出射边界角通量。令网格平均（滞后）源为\n$$\n\\bar{q}_{m,i}^{(k)} \\equiv \\frac{1}{h}\\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x)\\,dx.\n$$\n在菱形差分空间闭合关系下，网格平均角通量由边界值的平均值近似得到，\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} \\approx \\frac{1}{2}\\left(\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}\\right).\n$$\n\n从输运方程出发，并仅使用上述定义，推导菱形差分格式的离散源迭代更新式，该表达式用入射边界通量 $\\psi_{m,i-1}^{(k+1)}$、总宏观截面 $\\Sigma_{t}$、网格宽度 $h$ 和网格平均源 $\\bar{q}_{m,i}^{(k)}$ 来表示出射边界通量 $\\psi_{m,i}^{(k+1)}$。请以精确的符号形式给出您的最终表达式。不需要进行数值计算。",
            "solution": "该问题是有效的，因为它科学地基于输运理论的既定原则，特别是带有菱形差分的离散纵标法。该问题是适定的、客观的，并包含了进行形式推导所需的所有必要信息，没有任何矛盾或歧义。\n\n推导的起点是针对方向余弦 $\\mu_m > 0$ 的离散方向 $m$ 的一维、稳态、单能输运方程。在源迭代法下，第 $k+1$ 次迭代的方程由下式给出：\n$$\n\\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) = q_{m}^{(k)}(x)\n$$\n此处，$\\psi_{m}^{(k+1)}(x)$ 是位置 $x$ 处第 $k+1$ 次迭代的角通量，$\\Sigma_t$ 是恒定的总宏观截面，而 $q_{m}^{(k)}(x)$ 是总源项，使用前一次迭代 $k$ 的量计算得出。\n\n为了在空间网格 $i$ 上离散化该方程，我们在网格宽度 $h$ 上对其进行积分，从边界 $x_{i-1/2}$ 到边界 $x_{i+1/2}$：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) \\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x)\\,dx\n$$\n我们计算积分后方程的每一项。左边的第一项使用微积分基本定理直接积分：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} dx = \\mu_{m} \\left[ \\psi_{m}^{(k+1)}(x) \\right]_{x_{i-1/2}}^{x_{i+1/2}} = \\mu_{m} \\left( \\psi_{m}^{(k+1)}(x_{i+1/2}) - \\psi_{m}^{(k+1)}(x_{i-1/2}) \\right)\n$$\n使用问题中关于入射和出射边界通量的符号，$\\psi_{m,i-1}^{(k+1)} \\equiv \\psi_{m}^{(k+1)}(x_{i-1/2})$ 和 $\\psi_{m,i}^{(k+1)} \\equiv \\psi_{m}^{(k+1)}(x_{i+1/2})$，该项变为：\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right)\n$$\n左边的第二项涉及角通量在网格上的积分。我们可以使用网格平均角通量 $\\bar{\\psi}_{m,i}^{(k+1)}$ 的定义来表示它：\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi_{m}^{(k+1)}(x) dx\n$$\n因此，第二项变为：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) dx = \\Sigma_{t} \\left( h \\bar{\\psi}_{m,i}^{(k+1)} \\right) = h \\Sigma_{t} \\bar{\\psi}_{m,i}^{(k+1)}\n$$\n右边的项是源项在网格上的积分。使用问题中关于网格平均源 $\\bar{q}_{m,i}^{(k)}$ 的定义：\n$$\n\\bar{q}_{m,i}^{(k)} = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x) dx\n$$\n方程的右边变为：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x) dx = h \\bar{q}_{m,i}^{(k)}\n$$\n结合这些结果，我们得到网格 $i$ 的空间离散“平衡”方程：\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right) + h \\Sigma_{t} \\bar{\\psi}_{m,i}^{(k+1)} = h \\bar{q}_{m,i}^{(k)}\n$$\n这个方程包含三个未知数：两个边界通量 $\\psi_{m,i-1}^{(k+1)}$ 和 $\\psi_{m,i}^{(k+1)}$，以及网格平均通量 $\\bar{\\psi}_{m,i}^{(k+1)}$。为了求解该方程，我们需要一个附加方程，称为闭合关系。问题指定使用菱形差分（DD）闭合关系，它将网格平均通量与边界通量的平均值联系起来：\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} = \\frac{1}{2}\\left(\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}\\right)\n$$\n我们将此 DD 闭合关系代入平衡方程：\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right) + h \\Sigma_{t} \\left( \\frac{\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}}{2} \\right) = h \\bar{q}_{m,i}^{(k)}\n$$\n最后一步是代数求解出射通量 $\\psi_{m,i}^{(k+1)}$，用已知的入射通量 $\\psi_{m,i-1}^{(k+1)}$ 和源项 $\\bar{q}_{m,i}^{(k)}$ 表示。我们展开并重新整理方程，将包含 $\\psi_{m,i}^{(k+1)}$ 的项组合在左侧，所有其他项放在右侧。\n$$\n\\mu_{m} \\psi_{m,i}^{(k+1)} - \\mu_{m} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\Sigma_{t}}{2} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\Sigma_{t}}{2} \\psi_{m,i}^{(k+1)} = h \\bar{q}_{m,i}^{(k)}\n$$\n$$\n\\psi_{m,i}^{(k+1)} \\left( \\mu_{m} + \\frac{h \\Sigma_{t}}{2} \\right) - \\psi_{m,i-1}^{(k+1)} \\left( \\mu_{m} - \\frac{h \\Sigma_{t}}{2} \\right) = h \\bar{q}_{m,i}^{(k)}\n$$\n$$\n\\psi_{m,i}^{(k+1)} \\left( \\mu_{m} + \\frac{h \\Sigma_{t}}{2} \\right) = \\psi_{m,i-1}^{(k+1)} \\left( \\mu_{m} - \\frac{h \\Sigma_{t}}{2} \\right) + h \\bar{q}_{m,i}^{(k)}\n$$\n分离出 $\\psi_{m,i}^{(k+1)}$ 得到最终的更新方程：\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{\\mu_{m} - \\frac{h \\Sigma_{t}}{2}}{\\mu_{m} + \\frac{h \\Sigma_{t}}{2}} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\bar{q}_{m,i}^{(k)}}{\\mu_{m} + \\frac{h \\Sigma_{t}}{2}}\n$$\n为了用公分母表示此表达式并消除分子和分母中的分数，我们可以将每项的分子和分母都乘以 $2$：\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{2\\left(\\mu_{m} - \\frac{h \\Sigma_{t}}{2}\\right)}{2\\left(\\mu_{m} + \\frac{h \\Sigma_{t}}{2}\\right)} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\left(\\mu_{m} + \\frac{h \\Sigma_{t}}{2}\\right)}\n$$\n这得到了菱形差分源迭代更新的最终形式：\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{2\\mu_{m} - h \\Sigma_{t}}{2\\mu_{m} + h \\Sigma_{t}} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\mu_{m} + h \\Sigma_{t}}\n$$\n这个表达式明确地用网格 $i$ 的入射边界通量和网格平均源来表示其出射边界通量，这正是问题的目标。",
            "answer": "$$\n\\boxed{\\psi_{m,i}^{(k+1)} = \\frac{2\\mu_{m} - h \\Sigma_{t}}{2\\mu_{m} + h \\Sigma_{t}} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\mu_{m} + h \\Sigma_{t}}}\n$$"
        },
        {
            "introduction": "在建立了离散方程之后，下一步是理解迭代过程本身。该问题将背景简化为一个无限均匀介质，从而消除了空间耦合的复杂性，使我们能专注于源迭代的核心机制。通过利用上一步的通量计算新的中子源，并以此确定下一步的通量，这个练习为我们提供了关于解如何从一次迭代演进到下一次迭代的具体感受。",
            "id": "4250946",
            "problem": "考虑一个具有各向同性外源和各向同性散射的均匀无限介质中的单能、稳态、一维平板几何下的玻尔兹曼输运方程。设使用四阶离散纵标 (S_N) 方法（记作 $S_4$）通过对角余弦变量$\\mu \\in [-1,1]$的高斯-勒让德求积来近似角积分。沿纵标 $m$ 的控制方程为\n$$\n\\mu_m \\frac{\\partial \\psi_m(x)}{\\partial x} + \\Sigma_t \\psi_m(x) = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi(x),\n$$\n其中$\\psi_m(x)$是方向余弦$\\mu_m$的角通量，$\\Sigma_t$是总宏观截面，$\\Sigma_s$是散射宏观截面，$q_{\\mathrm{ext}}$是各向同性外体积源，$\\phi(x)$是由$\\psi(x,\\mu)$的零阶角矩定义的标量通量。\n\n在无限均匀介质的假设下，空间均匀性意味着对所有方向都有$\\frac{\\partial \\psi_m}{\\partial x} = 0$，因此方程在局部得到简化。在固定源问题的源迭代中，第 $k+1$ 次迭代的角通量是通过在散射源中使用第 $k$ 次迭代的标量通量来获得的。\n\n使用 $S_4$ 求积，四个方向余弦及相关权重如下\n$$\n\\mu_1 = -0.8611363116,\\quad w_1 = 0.3478548451;\\qquad\n\\mu_2 = -0.3399810436,\\quad w_2 = 0.6521451549;\n$$\n$$\n\\mu_3 = 0.3399810436,\\quad w_3 = 0.6521451549;\\qquad\n\\mu_4 = 0.8611363116,\\quad w_4 = 0.3478548451.\n$$\n在一个代表点处，初始角通量迭代值为\n$$\n\\psi_1^{(0)} = 4.10 \\times 10^{4},\\quad\n\\psi_2^{(0)} = 4.40 \\times 10^{4},\\quad\n\\psi_3^{(0)} = 5.00 \\times 10^{4},\\quad\n\\psi_4^{(0)} = 5.30 \\times 10^{4},\n$$\n材料和源参数为\n$$\n\\Sigma_t = 1.00\\ \\mathrm{cm}^{-1},\\qquad\n\\Sigma_s = 0.80\\ \\mathrm{cm}^{-1},\\qquad\nq_{\\mathrm{ext}} = 1.20 \\times 10^{5}\\ \\mathrm{n\\ cm^{-3}\\ s^{-1}}.\n$$\n\n从输运方程的第一性原理和角矩的定义出发，执行第一次源迭代更新，使用给定的 $S_4$ 求积计算该点的标量通量$\\phi^{(1)}$。然后，验证各向同性源项在 $S_4$ 求积下的零阶勒让德矩（$P_0$ 矩）的守恒性。\n\n将$\\phi^{(1)}$的最终数值四舍五入到四位有效数字。以中子/平方厘米·秒（n cm$^{-2}$ s$^{-1}$）为单位表示标量通量的最终答案。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据、是适定的、客观的，并提供了进行求解所需的所有必要信息。\n\n该问题要求完成两项任务：首先，计算一次源迭代后的标量通量 $\\phi^{(1)}$；其次，验证在给定求积方案下各向同性源的零阶矩的守恒性。\n\n一维平板几何中，沿纵标方向 $m$ 的单能、稳态离散纵标输运方程如下所示：\n$$\n\\mu_m \\frac{\\partial \\psi_m(x)}{\\partial x} + \\Sigma_t \\psi_m(x) = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi(x)\n$$\n在给定的无限均匀介质假设下，系统是空间均匀的，这意味着角通量的梯度为零，即 $\\frac{\\partial \\psi_m(x)}{\\partial x} = 0$。方程在任意点 $x$ 简化为一个代数关系式：\n$$\n\\Sigma_t \\psi_m(x) = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi(x)\n$$\n源迭代法使用前一次迭代 $k$ 的标量通量来更新第 $k+1$ 次迭代的角通量：\n$$\n\\Sigma_t \\psi_m^{(k+1)} = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi^{(k)}\n$$\n由此，可以明确求出下一次迭代的角通量：\n$$\n\\psi_m^{(k+1)} = \\frac{1}{\\Sigma_t} \\left( \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi^{(k)} \\right)\n$$\n标量通量 $\\phi$ 是角通量 $\\psi(x,\\mu)$ 的零阶角矩，定义为 $\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\, d\\mu$。在离散纵标近似中，该积分被一个求积和所替代：\n$$\n\\phi^{(k)} = \\sum_{m=1}^{N} w_m \\psi_m^{(k)}\n$$\n其中 $N$ 是求积的阶数，对于 $S_4$ 方法，$N=4$。\n\n**第1部分：标量通量 $\\phi^{(1)}$ 的计算**\n\n首先，我们使用给定的初始角通量 $\\psi_m^{(0)}$ 和 $S_4$ 求积权重 $w_m$ 来计算初始迭代的标量通量 $\\phi^{(0)}$。\n$$\n\\phi^{(0)} = \\sum_{m=1}^{4} w_m \\psi_m^{(0)} = w_1 \\psi_1^{(0)} + w_2 \\psi_2^{(0)} + w_3 \\psi_3^{(0)} + w_4 \\psi_4^{(0)}\n$$\n该求积组是对称的，有 $w_1 = w_4$ 和 $w_2 = w_3$。我们可以将各项分组：\n$$\n\\phi^{(0)} = w_1(\\psi_1^{(0)} + \\psi_4^{(0)}) + w_2(\\psi_2^{(0)} + \\psi_3^{(0)})\n$$\n代入给定值：\n$w_1 = 0.3478548451$\n$w_2 = 0.6521451549$\n$\\psi_1^{(0)} = 4.10 \\times 10^{4}$\n$\\psi_2^{(0)} = 4.40 \\times 10^{4}$\n$\\psi_3^{(0)} = 5.00 \\times 10^{4}$\n$\\psi_4^{(0)} = 5.30 \\times 10^{4}$\n\n$$\n\\phi^{(0)} = 0.3478548451 \\times (4.10 \\times 10^{4} + 5.30 \\times 10^{4}) + 0.6521451549 \\times (4.40 \\times 10^{4} + 5.00 \\times 10^{4})\n$$\n$$\n\\phi^{(0)} = 0.3478548451 \\times (9.40 \\times 10^{4}) + 0.6521451549 \\times (9.40 \\times 10^{4})\n$$\n$$\n\\phi^{(0)} = (w_1+w_2) \\times (9.40 \\times 10^4) = 1.0 \\times (9.40 \\times 10^{4}) = 9.40 \\times 10^{4} \\ \\mathrm{n\\ cm^{-2}\\ s^{-1}}\n$$\n\n接下来，我们使用 $\\phi^{(0)}$ 来计算第一次迭代的源项。用于更新的总各向同性源为 $S^{(0)} = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi^{(0)}$。\n已知：\n$\\Sigma_s = 0.80\\ \\mathrm{cm}^{-1}$\n$q_{\\mathrm{ext}} = 1.20 \\times 10^{5}\\ \\mathrm{n\\ cm^{-3}\\ s^{-1}}$\n\n$$\nS^{(0)} = \\frac{1.20 \\times 10^{5}}{2} + \\frac{0.80}{2} \\times (9.40 \\times 10^{4})\n$$\n$$\nS^{(0)} = 6.00 \\times 10^{4} + 0.40 \\times 9.40 \\times 10^{4} = 6.00 \\times 10^{4} + 3.76 \\times 10^{4} = 9.76 \\times 10^{4} \\ \\mathrm{n\\ cm^{-3}\\ s^{-1}}\n$$\n现在，我们计算更新后的角通量 $\\psi_m^{(1)}$。由于源项 $S^{(0)}$ 是各向同性的（与角度 $\\mu_m$ 无关），并且由于无限介质的简化，更新后的角通量 $\\psi_m^{(1)}$ 对于所有方向 $m=1, 2, 3, 4$ 都是相同的。\n$$\n\\psi_m^{(1)} = \\frac{S^{(0)}}{\\Sigma_t}\n$$\n已知 $\\Sigma_t = 1.00\\ \\mathrm{cm}^{-1}$：\n$$\n\\psi_m^{(1)} = \\frac{9.76 \\times 10^{4}}{1.00} = 9.76 \\times 10^{4} \\ \\mathrm{n\\ cm^{-2}\\ s^{-1}}\n$$\n最后，我们通过计算 $\\psi_m^{(1)}$ 的零阶矩来计算更新后的标量通量 $\\phi^{(1)}$：\n$$\n\\phi^{(1)} = \\sum_{m=1}^{4} w_m \\psi_m^{(1)}\n$$\n由于 $\\psi_m^{(1)}$ 对所有 $m$ 都是常数，我们可以将其从求和中提出来：\n$$\n\\phi^{(1)} = \\psi_m^{(1)} \\sum_{m=1}^{4} w_m\n$$\n在区间 $[-1, 1]$ 上的高斯-勒让德求积的权重之和为 $\\int_{-1}^{1} 1 \\, d\\mu = 2$。我们来验证一下：\n$\\sum_{m=1}^{4} w_m = w_1 + w_2 + w_3 + w_4 = 2(w_1+w_2) = 2(0.3478548451 + 0.6521451549) = 2(1.0000000000) = 2$。\n因此：\n$$\n\\phi^{(1)} = (9.76 \\times 10^{4}) \\times 2 = 19.52 \\times 10^{4} = 1.952 \\times 10^{5} \\ \\mathrm{n\\ cm^{-2}\\ s^{-1}}\n$$\n问题要求答案保留四位有效数字，即 $1.952 \\times 10^5$。\n\n**第2部分：零阶矩守恒的验证**\n\n第二项任务是验证在 $S_4$ 求积下各向同性源项的零阶勒让德矩（$P_0$ 矩）的守恒性。输运方程右侧的各向同性源项是 $S(x) = \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi(x)$。该项是位置 $x$ 的函数，但相对于角变量 $\\mu$ 是一个常数。\n\n函数 $f(\\mu)$ 的零阶勒让德矩定义为 $\\int_{-1}^{1} f(\\mu) P_0(\\mu) \\, d\\mu$，其中 $P_0(\\mu) = 1$。因此，该矩就是函数在区间 $[-1, 1]$ 上的积分。\n\n对于各向同性源项 $S(x)$，其解析零阶矩为：\n$$\n\\int_{-1}^{1} S(x) \\, d\\mu = S(x) \\int_{-1}^{1} d\\mu = S(x) [\\mu]_{-1}^{1} = S(x) (1 - (-1)) = 2S(x)\n$$\n代入 $S(x)$ 的表达式，源的精确零阶矩为：\n$$\n2 \\left( \\frac{q_{\\mathrm{ext}}}{2} + \\frac{\\Sigma_s}{2}\\,\\phi(x) \\right) = q_{\\mathrm{ext}} + \\Sigma_s \\phi(x)\n$$\n这就是总标量源强度，正如所预期的。\n\n现在，我们使用 $S_4$ 离散纵标求积来计算这个矩：\n$$\n\\sum_{m=1}^{4} w_m S(x)\n$$\n由于 $S(x)$ 不依赖于角度 $\\mu_m$，它可以从求和中提出来：\n$$\nS(x) \\sum_{m=1}^{4} w_m\n$$\n如前所述，$S_4$ 高斯-勒让德求积的权重之和恰好为 $2$。因此，该矩的求积近似值为：\n$$\nS(x) \\times 2 = 2S(x)\n$$\n$S_4$ 求积的结果与解析结果完全相同。这表明各向同性源的零阶矩是精确守恒的。这是高斯-勒让德求积的一个普遍性质：一个 $N$ 点求积法可以精确积分次数最高为 $2N-1$ 的任何多项式。在本例中，$N=4$，因此次数最高为 $7$ 的多项式都可以被精确积分。各向同性源项在角度上是常数，即一个 0 次多项式。因此，$S_4$ 求积法对其积分没有任何误差，零阶矩是完全守恒的。\n\n标量通量的最终答案是 $\\phi^{(1)}$。\n$$\n\\phi^{(1)} = 1.952 \\times 10^{5} \\ \\mathrm{n\\ cm^{-2}\\ s^{-1}}\n$$",
            "answer": "$$\n\\boxed{1.952 \\times 10^5}\n$$"
        },
        {
            "introduction": "数值方法并非完美无缺，其局限性可能带来显著的实际影响。这个高级练习探讨了菱形差分格式的一个关键弱点——它可能产生非物理的负通量。通过推导导致此问题出现的条件，您将学会将理论数值分析与网格尺寸等实际仿真参数的限制联系起来，并理解开发更先进、更稳健的数值格式的动机。",
            "id": "4250966",
            "problem": "考虑一维稳态单能线性输运方程，在平板几何下描述角通量 $\\,\\psi(x,\\mu)\\,$，\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t(x)\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_s(x)}{2}\\,\\phi(x) \\;+\\; \\frac{q(x)}{2}\\,,\n$$\n其中标量通量为 $\\,\\phi(x) = \\int_{-1}^{1}\\psi(x,\\mu)\\,d\\mu\\,$，宏观总截面 $\\,\\Sigma_t(x)  0\\,$，散射截面 $\\,\\Sigma_s(x) \\in [0,\\Sigma_t(x))\\,$，以及各向同性固定外源 $\\,q(x) \\ge 0\\,$。使用离散纵标（SN）方法在一组方向 $\\{\\mu_m, w_m\\}_{m=1}^{M}$ 上对角度进行离散，其中 $\\mu_m \\in (-1,1)$ 且正权重 $\\{w_m\\}$ 满足 $\\sum_{m=1}^{M} w_m = 2$。在网格宽度为 $\\,h  0\\,$、网格边界位于 $\\,x_{i \\pm 1/2}\\,$ 的均匀网格上对空间进行离散，并采用标准的网格平衡有限体积格式，其闭合关系为菱形差分\n$$\n\\psi_{i,m} \\;=\\; \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right)\\,,\n$$\n其中 $\\,\\psi_{i\\pm \\frac{1}{2},m}\\,$ 是边界值，$\\,\\psi_{i,m}\\,$ 是方向 $\\,\\mu_m\\,$ 上的网格平均替代值。\n\n(a) 从给定方向 $\\,\\mu_m  0\\,$ 下网格 $\\,i\\,$ 上的输运方程的网格平衡形式出发，推导线性扫描关系\n$$\n\\psi_{i+\\frac{1}{2},m} \\;=\\; \\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m} \\;+\\; \\beta_{i,m}\\,Q_{i,m}\\,,\n$$\n其中 $\\,Q_{i,m}\\,$ 是当前迭代步中方向 $\\,\\mu_m\\,$ 上已知的网格平均总源（包括外源和散射贡献）。用 $\\,\\mu_m\\,$, $\\,h\\,$ 和 $\\,\\Sigma_{t,i}\\,$ 表示 $\\,\\alpha_{i,m}\\,$ 和 $\\,\\beta_{i,m}\\,$。确定这些系数需满足何种条件，以确保非负的入射角通量 $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ 和非负的源 $\\,Q_{i,m} \\ge 0\\,$ 能够产生非负的出射角通量 $\\,\\psi_{i+\\frac{1}{2},m} \\ge 0\\,$。解释在何种条件下，菱形差分离散格式可能违反正定性。\n\n(b) 利用你的表达式，将正定性条件简化为关于每个角度、每个网格的光学厚度的单个充分不等式\n$$\n\\tau_{i,m} \\;:=\\; \\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|}\\,.\n$$\n将得到的界限表述为一个明确的不等式，该不等式关联了所有网格 $\\,i\\,$ 和所有角度 $\\,m\\,$ 的 $\\,\\Sigma_{t,i}\\,$, $\\,h\\,$ 和 $\\,|\\mu_m|\\,$。\n\n(c) 考虑散射比为 $\\,c := \\Sigma_s/\\Sigma_t \\in [0,1)\\,$ 的各向同性散射的源迭代法。设标量通量的更新方式为：在每次迭代中，使用总源 $\\,Q_{i,m}^{(k)} = \\frac{1}{2} q_i + \\frac{\\Sigma_{s,i}}{2}\\,\\phi_i^{(k)}\\,$ 求解输运方程，并通过对新的角通量进行加权求和来构建 $\\,\\phi^{(k+1)}\\,$。证明，如果由菱形差分离散定义的输运扫描算子在(a)部分的意义上是正的，那么从 $\\,\\phi^{(0)} \\equiv 0\\,$ 开始且对于 $\\,q_i \\ge 0\\,$，迭代序列 $\\,\\phi^{(k)}\\,$ 在由逐分量不等式诱导的偏序下构成一个单调不减序列。\n\n(d) 最后，对于一个均匀平板，其 $\\,\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}\\,$，且采用对称加权求积，其最小正方向余弦为 $\\,\\mu_{\\min} = 0.183434642\\,$。计算在菱形差分格式下，能够保证源迭代更新单调性的最大均匀网格宽度 $\\,h_{\\max}\\,$（单位为 $\\,\\mathrm{cm}\\,$），如(a)–(c)部分所建立的那样。将你的答案四舍五入到 $\\,4\\,$ 位有效数字，并以 $\\,\\mathrm{cm}\\,$ 为单位表示。",
            "solution": "我们从角度和空间上都已离散化的一维稳态单能线性输运方程开始。对于一个宽度为 $\\,h\\,$、范围为 $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}}]\\,$ 的给定网格 $\\,i\\,$ 和一个方向 $\\,\\mu_m  0\\,$，该网格上的有限体积平衡方程为\n$$\n\\mu_m\\,\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} \\;+\\; \\Sigma_{t,i}\\,\\psi_{i,m} \\;=\\; Q_{i,m}\\,,\n$$\n其中 $\\,Q_{i,m}\\,$ 是当前迭代中方向 $\\,m\\,$ 上每个立体角内的已知总源，而 $\\,\\psi_{i,m}\\,$ 通过菱形差分关系进行闭合\n$$\n\\psi_{i,m} \\;=\\; \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right)\\,.\n$$\n\n(a)部分。将菱形差分闭合关系代入平衡方程，得到\n$$\n\\mu_m\\,\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} \\;+\\; \\Sigma_{t,i}\\,\\frac{\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}}{2} \\;=\\; Q_{i,m}\\,.\n$$\n将位于 $\\,x_{i+\\frac{1}{2}}\\,$ 的未知数收集到左边：\n$$\n\\left(\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i+\\frac{1}{2},m} \\;+\\; \\left(-\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i-\\frac{1}{2},m} \\;=\\; Q_{i,m}\\,.\n$$\n求解 $\\,\\psi_{i+\\frac{1}{2},m}\\,$，得到线性扫描关系\n$$\n\\psi_{i+\\frac{1}{2},m} \\;=\\; \\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m} \\;+\\; \\beta_{i,m}\\,Q_{i,m}\\,,\n$$\n系数为\n$$\n\\alpha_{i,m} \\;=\\; \\frac{\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}} \\;=\\; \\frac{2\\,\\frac{\\mu_m}{h} - \\Sigma_{t,i}}{2\\,\\frac{\\mu_m}{h} + \\Sigma_{t,i}}\\,,\n\\qquad\n\\beta_{i,m} \\;=\\; \\frac{1}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}}\\,.\n$$\n分母 $\\,\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\,$ 对于 $\\,\\mu_m  0\\,$, $\\,h  0\\,$ 和 $\\,\\Sigma_{t,i}  0\\,$ 是严格为正的。因此，$\\,\\beta_{i,m}  0\\,$ 恒成立。$\\,\\alpha_{i,m}\\,$ 的符号由分子 $\\,\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}\\,$ 决定。如果 $\\,\\alpha_{i,m} \\ge 0\\,$ 且 $\\,\\beta_{i,m}  0\\,$，那么对于 $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ 和 $\\,Q_{i,m} \\ge 0\\,$，我们有 $\\,\\psi_{i+\\frac{1}{2},m} \\ge 0\\,$，从而在该方向上确立了扫描更新的正定性。反之，如果 $\\,\\alpha_{i,m}  0\\,$，那么即使有 $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ 和 $\\,Q_{i,m} \\ge 0\\,$，项 $\\,\\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m}\\,$ 也会变为非正；如果它在数值上超过 $\\,\\beta_{i,m}\\,Q_{i,m}\\,$，就可能产生 $\\,\\psi_{i+\\frac{1}{2},m}  0\\,$。因此，当 $\\,\\alpha_{i,m}  0\\,$ 时，菱形差分离散格式可能违反正定性，这种情况发生在光学厚度足够大的网格中。\n\n(b)部分。引入每个角度、每个网格的光学厚度\n$$\n\\tau_{i,m} \\;:=\\; \\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|}\\,.\n$$\n对于 $\\,\\mu_m  0\\,$，我们有\n$$\n\\alpha_{i,m} \\;=\\; \\frac{2 - \\tau_{i,m}}{2 + \\tau_{i,m}}\\,.\n$$\n对于非负入射通量和非负源，扫描映射的正定性当且仅当 $\\,\\alpha_{i,m} \\ge 0\\,$ 且 $\\,\\beta_{i,m}  0\\,$ 时得到保证。如前所述，$\\,\\beta_{i,m}  0\\,$ 恒成立。因此，充分条件简化为\n$$\n\\alpha_{i,m} \\;\\ge\\; 0 \\quad \\Longleftrightarrow \\quad 2 - \\tau_{i,m} \\;\\ge\\; 0 \\quad \\Longleftrightarrow \\quad \\tau_{i,m} \\;\\le\\; 2\\,.\n$$\n根据对称性，对于 $\\,\\mu_m  0\\,$，使用 $\\,|\\mu_m|\\,$ 的相同条件也适用。因此，在每个网格和每个离散方向上，菱形差分扫描的充分正定性条件是\n$$\n\\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|} \\;\\le\\; 2 \\quad \\text{对所有网格 } i \\text{ 和所有角度 } m\\,,\n$$\n等价地，\n$$\nh \\;\\le\\; \\frac{2\\,|\\mu_m|}{\\Sigma_{t,i}} \\quad \\text{对所有 } i,m\\,.\n$$\n在给定的网格和角度集上，最严格的界限使用最小的正方向余弦 $\\,\\mu_{\\min} := \\min_{m:\\, \\mu_m  0} \\mu_m\\,$ 和最大的网格总截面 $\\,\\Sigma_{t,\\max} := \\max_i \\Sigma_{t,i}\\,$，给出全局充分条件\n$$\nh \\;\\le\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_{t,\\max}}\\,.\n$$\n\n(c)部分。令 $\\,\\mathcal{L}\\,$ 表示输运算子，将角通量映射到其经菱形差分在空间和角度上离散化后的流项加吸收项残差，令 $\\,\\mathcal{L}^{-1}\\,$ 表示相应的扫描算子，它将给定的总源 $\\,Q\\,$ 映射到唯一的顺风格式角通量 $\\,\\psi\\,$。在(b)部分的条件下，每个网格-角度的扫描更新具有仅依赖于局部数据的非负系数，因此 $\\,\\mathcal{L}^{-1}\\,$ 是一个正线性算子：对于任意两个总源 $\\,Q,Q'\\,$，若逐分量满足 $\\,Q \\ge Q'\\,$，则有 $\\,\\mathcal{L}^{-1}Q \\ge \\mathcal{L}^{-1}Q'\\,$（逐分量）。\n\n对于散射比为 $\\,c = \\Sigma_s/\\Sigma_t \\in [0,1)\\,$ 的各向同性散射，定义正线性散射算子 $\\,\\mathcal{S}\\,$，它将标量通量 $\\,\\phi\\,$ 映射到各向同性角源，其分量为 $\\,(\\mathcal{S}\\phi)_{i,m} = \\frac{\\Sigma_{s,i}}{2}\\,\\phi_i\\,$。外源 $\\,q\\,$ 诱导一个非负的各向同性角源 $\\,\\mathcal{Q}_{\\mathrm{ext}}\\,$，其分量为 $\\,(\\mathcal{Q}_{\\mathrm{ext}})_{i,m} = \\frac{q_i}{2}\\,$。源迭代是一种不动点迭代\n$$\n\\psi^{(k+1)} \\;=\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k)}\\right), \\qquad \\phi^{(k+1)} \\;=\\; \\sum_{m=1}^{M} w_m\\,\\psi^{(k+1)}_{(\\cdot),m}\\,,\n$$\n初始条件为 $\\,\\phi^{(0)} \\equiv 0\\,$。令角通量到标量通量的平均算子 $\\,\\mathcal{A}\\,$ 定义为 $\\,\\mathcal{A}\\psi = \\sum_{m=1}^{M} w_m\\,\\psi_{(\\cdot),m}\\,$；该算子具有非负权重，因此在序的意义上是正的。\n\n我们用数学归纳法证明 $\\,\\phi^{(k)}\\,$ 是单调不减的。基础情形：$\\,\\phi^{(0)} = 0\\,$。那么 $\\,\\psi^{(1)} = \\mathcal{L}^{-1}\\mathcal{Q}_{\\mathrm{ext}} \\ge 0\\,$，因为 $\\,\\mathcal{Q}_{\\mathrm{ext}} \\ge 0\\,$ 且 $\\,\\mathcal{L}^{-1}\\,$ 是正的。因此 $\\,\\phi^{(1)} = \\mathcal{A}\\psi^{(1)} \\ge 0 = \\phi^{(0)}\\,$。假设 $\\,\\phi^{(k)} \\ge \\phi^{(k-1)}\\,$。由于 $\\,\\mathcal{S}\\,$ 是正的，所以 $\\,\\mathcal{S}\\,\\phi^{(k)} \\ge \\mathcal{S}\\,\\phi^{(k-1)}\\,$。因此\n$$\n\\psi^{(k+1)} \\;=\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k)}\\right) \\;\\ge\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k-1)}\\right) \\;=\\; \\psi^{(k)}\\,,\n$$\n根据 $\\,\\mathcal{L}^{-1}\\,$ 的正定性。应用正平均算子 $\\,\\mathcal{A}\\,$，我们得到 $\\,\\phi^{(k+1)} = \\mathcal{A}\\psi^{(k+1)} \\ge \\mathcal{A}\\psi^{(k)} = \\phi^{(k)}\\,$。因此，$\\,\\{\\phi^{(k)}\\}\\,$ 是一个单调不减序列。这一结论依赖于扫描映射的正定性（保序性），而该性质由(b)部分中的界 $\\,\\tau_{i,m} \\le 2\\,$ 所保证。\n\n(d)部分。在均匀平板中，$\\,\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}\\,$，最小正方向余弦为 $\\,\\mu_{\\min} = 0.183434642\\,$，跨所有角度的正定性充分条件简化为\n$$\nh \\;\\le\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_t}\\,.\n$$\n因此，允许的最大均匀网格宽度是\n$$\nh_{\\max} \\;=\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_t} \\;=\\; \\frac{2 \\times 0.183434642}{1.2} \\;=\\; \\frac{0.366869284}{1.2} \\;=\\; 0.305724403\\ldots\\,.\n$$\n四舍五入到 $\\,4\\,$ 位有效数字并以 $\\,\\mathrm{cm}\\,$ 为单位表示，得到\n$$\nh_{\\max} \\;=\\; 0.3057\\,.\n$$\n这个界限保证了菱形差分扫描算子在每个网格和每个方向上都是正的，因此在所述假设下，源迭代的更新是单调不减的。",
            "answer": "$$\\boxed{0.3057}$$"
        }
    ]
}