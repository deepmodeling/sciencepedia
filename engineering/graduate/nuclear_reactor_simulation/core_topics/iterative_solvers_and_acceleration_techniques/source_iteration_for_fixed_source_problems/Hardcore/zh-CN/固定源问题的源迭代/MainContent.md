## 引言
求解固定源中子输运问题是[反应堆物理](@entry_id:158170)分析、[辐射屏蔽](@entry_id:1130501)设计以及加速器驱动次临界系统（ADS）模拟中的一项基本任务。该问题的精确解对于理解中子在介质中的行为至关重要。然而，中子输运方程是一个复杂的积分-[微分](@entry_id:158422)方程，其中特定方向的中子行为（角通量密度）依赖于所有方向中子行为的积分结果（标量通量密度），这种内在的耦合关系使得直接求解变得异常困难。

为了应对这一挑战，本文系统地介绍了核心的求解算法——[源迭代](@entry_id:1131994)法。在“原理与机制”一章中，我们将深入其算法流程和收敛性理论，揭示其性能背后的物理本质。接着，在“应用与交叉学科联系”中，我们将探索该方法如何应用于多样的物理系统，如何扩展以处理多群能量，以及如何通过先进的加速技术克服其固有的收敛缓慢问题。最后，“动手实践”部分将提供具体的编程练习，帮助您将理论知识转化为实践能力。本文旨在为您构建一个关于源迭代法的完整知识体系，从理论基础到实际应用，为您深入研究计算中子输运学铺平道路。

## 原理与机制

在上一章中，我们介绍了固定源中子输运问题的背景和重要性。本章将深入探讨解决这类问题的核心迭代方法——[源迭代](@entry_id:1131994)法（Source Iteration）的原理、数学框架和收敛特性。我们将从基本方程出发，逐步建立起对源迭代法工作机制的深刻理解，并分析其在特定物理情境下的性能表现。

### 固定源[输运方程](@entry_id:174281)与迭代思想的引入

为了精确描述中子在介质中的行为，我们使用[稳态](@entry_id:139253)[线性玻尔兹曼输运方程](@entry_id:1127271)。考虑一个一维平板几何模型，其空间坐标为 $x$，中子运动方向由[方向余弦](@entry_id:170591) $\mu$ 表示。对于单能中子，[输运方程](@entry_id:174281)描述了沿特定方向运动的中子在相空间微元中的平衡关系：流出率加上碰撞损失率等于散射产生率加上固定源的贡献率。

假设介质具有各向同性散射和各向同性源，该平衡关系可以精确地写为以下形式 ：

$$
\mu \frac{d\psi(x,\mu)}{dx} + \Sigma_t(x)\psi(x,\mu) = \frac{\Sigma_s(x)}{2}\phi(x) + \frac{Q(x)}{2}
$$

这里，$\psi(x,\mu)$ 是**角通量密度**（angular flux），表示在位置 $x$ 处沿方向 $\mu$ 运动的中子密度。$\Sigma_t(x)$ 是**宏观[总截面](@entry_id:151809)**（total macroscopic cross section），代表中子发生任何类型碰撞的概率。$\Sigma_s(x)$ 是**宏观[散射截面](@entry_id:140322)**（scattering macroscopic cross section）。$Q(x)$ 是单位体积、单位时间内的**外部固定源**（external fixed source）强度。方程右侧的 $1/2$ 因子来自于在一维平板几何中对各向同性源的角度归一化。

方程中的**标量通量密度**（scalar flux）$\phi(x)$ 是角通量密度在所有方向上的积分：

$$
\phi(x) = \int_{-1}^{1}\psi(x,\mu)d\mu
$$

这个定义至关重要，因为它揭示了[输运方程](@entry_id:174281)求解的核心挑战。方程左边描述了特定方向 $\mu$ 的中子行为，而右边的散射源项 $\frac{\Sigma_s(x)}{2}\phi(x)$ 却依赖于所有方向中子行为的积分结果 $\phi(x)$。这种耦合关系使得方程成为一个**积分-[微分](@entry_id:158422)方程**，无法通过对每个 $\mu$ 方向进行简单的直接积分来求解。角通量密度 $\psi$ 的解依赖于自身的积分 $\phi$，形成了一个“先有鸡还是先有蛋”的困境。

为了打破这种耦合，最自然的想法就是采用**迭代法**。如果我们能对标量通量密度 $\phi(x)$ 进行一个初始猜测，那么散射源项就变成了一个已知函数。此时，[输运方程](@entry_id:174281)就[解耦](@entry_id:160890)为一系列关于 $\psi(x,\mu)$ 的[一阶常微分方程](@entry_id:264241)（每个 $\mu$ 对应一个），可以被直接求解。一旦求得了新的角通量密度，我们就可以通[过积分](@entry_id:753033)更新标量通量密度，然后用这个更新后的结果开始下一次迭代。这个简单而强大的思想，就是**源迭代法**（Source Iteration, SI）的基础。

### [源迭代](@entry_id:1131994)法的算法流程

源迭代法将复杂的积分-[微分](@entry_id:158422)方程求解过程分解为两个交替执行的步骤：**输运扫描**和**通量更新**。设 $k$ 为迭代次数，整个算法流程如下：

1.  **初始化**：对标量通量密度分布进行一个初始猜测，记为 $\phi^{(0)}(x)$。一个常见的选择是假设 $\phi^{(0)}(x) = 0$ 或一个基于外部源的简单估计。

2.  **迭代循环** (对于 $k = 0, 1, 2, \dots$ 直至收敛):
    *   **步骤 1: [输运扫描](@entry_id:1133407) (Transport Sweep)**
        将上一步得到的[标量通量](@entry_id:1131249)密度 $\phi^{(k)}(x)$ 代入散射源项，构造一个已知的总源项。然后，针对每个离散的中子运动方向 $\mu_m$，求解以下[一阶微分方程](@entry_id:173139)以获得新的角通量密度 $\psi^{(k+1)}(x, \mu_m)$ ：
        $$
        \mu_m \frac{d\psi^{(k+1)}(x,\mu_m)}{dx} + \Sigma_t(x)\psi^{(k+1)}(x,\mu_m) = \frac{\Sigma_s(x)}{2}\phi^{(k)}(x) + \frac{Q(x)}{2}
        $$
        这个求解过程被称为**输运扫描**。对于给定的边界条件，例如[真空边界条件](@entry_id:1133678)（即没有中子从外界进入系统），该方程可以稳定地求解。[真空边界条件](@entry_id:1133678)具体表现为：在左边界 $x=0$ 处，对于所有指向区域内部的方向（$\mu_m > 0$），入射角通量为零，即 $\psi^{(k+1)}(0, \mu_m) = 0$；在右边界 $x=L$ 处，对于所有指向区域内部的方向（$\mu_m < 0$），[入射角](@entry_id:192705)通量也为零，即 $\psi^{(k+1)}(L, \mu_m) = 0$ 。
        
        在数值实现中，[输运扫描](@entry_id:1133407)的方向至关重要。当中子方向为正（$\mu_m > 0$）时，信息从左向右传播，因此必须从左边界开始，沿 $x$ 增加的方向依次求解每个空间网格的角通量。反之，当 $\mu_m < 0$ 时，必须从右向左扫描。这种依赖于信息来源方向的计算方法被称为**上风（upwind）**格式，是保证数值稳定性的关键 。

    *   **步骤 2: 通量更新 (Flux Update)**
        在[输运扫描](@entry_id:1133407)完成后，我们获得了所有方向上的新角通量密度 $\psi^{(k+1)}(x, \mu_m)$。通过对其进行角度积分（在数值上是加权求和），我们得到更新后的[标量通量](@entry_id:1131249)密度 $\phi^{(k+1)}(x)$：
        $$
        \phi^{(k+1)}(x) = \sum_{m=1}^{M} w_m \psi^{(k+1)}(x, \mu_m)
        $$
        其中 $\{w_m\}$ 是与离散方向 $\{\mu_m\}$ 对应的正交权值，满足 $\sum w_m = 2$。

3.  **收敛判断**：比较 $\phi^{(k+1)}(x)$ 和 $\phi^{(k)}(x)$ 的差异。如果差异小于预设的容差，则认为迭代收敛，$\phi^{(k+1)}(x)$ 即为问题的解。否则，返回迭代循环的开始，进行下一次迭代。

### [算子理论](@entry_id:139990)与[收敛性分析](@entry_id:151547)

为了更深刻地理解源迭代法的数学本质和[收敛条件](@entry_id:166121)，我们引入算[子表示](@entry_id:141094)法。这种抽象的数学框架能让我们剥离具体的几何和离散化细节，聚焦于迭代过程的核心结构 。

让我们定义以下几个[线性算子](@entry_id:149003)：
*   **流-[碰撞算子](@entry_id:1122657) $L$**: $L\psi = \boldsymbol{\Omega} \cdot \nabla \psi + \Sigma_t \psi$，代表中子的流出和碰撞损失。
*   **[输运扫描](@entry_id:1133407)算子 $T$**: $T = L^{-1}$，是 $L$ 的逆算子。它将一个给定的角源分布映射到相应的角通量密度解。
*   **散射源算子 $S$**: $S\phi$ 将标量通量密度 $\phi$ 转换为相应的各向同性[散射角](@entry_id:171822)源，即 $(S\phi)(\boldsymbol{r}, \boldsymbol{\Omega}) = \frac{\Sigma_s(\boldsymbol{r})}{4\pi} \phi(\boldsymbol{r})$。
*   **矩算子 $M$**: $M\psi = \int_{4\pi} \psi d\boldsymbol{\Omega} = \phi$，将角通量密度映射为标量通量密度。

利用这些算子，[稳态](@entry_id:139253)[输运方程](@entry_id:174281) $L\psi = S\phi + q$ 可以被重新整理为一个关于标量通量密度 $\phi$ 的[不动点方程](@entry_id:203270)。首先，对[输运方程](@entry_id:174281)应用 $L$ 的逆算子 $T$：
$$
\psi = T(S\phi + q)
$$
然后，对上式两边应用矩算子 $M$，并利用 $\phi = M\psi$ 的定义：
$$
\phi = M\psi = M(T(S\phi + q))
$$
根据算子的线性性质，可得：
$$
\phi = (MTS)\phi + MTq
$$
这是一个[标准形式](@entry_id:153058)的[不动点方程](@entry_id:203270) $\phi = K\phi + b$，其中**迭代算子** $K = MTS$，源项 $b = MTq$ 。[源迭代](@entry_id:1131994)过程 $\phi^{(k+1)} = K\phi^{(k)} + b$ 正是求解该[不动点方程](@entry_id:203270)的皮卡（Picard）迭代。

在[数值线性代数](@entry_id:144418)的语言中，这个方程等价于[线性系统](@entry_id:147850) $(I-K)\phi = b$。而[源迭代](@entry_id:1131994)法 $\phi^{(k+1)} = \phi^{(k)} + (b - (I-K)\phi^{(k)})$ 正是求解该线性系统的**[理查森迭代](@entry_id:635109)法**（Richardson iteration），其中预条件子被选为单位算子 $P=I$ 。

迭代过程的**误差** $e^{(k)} = \phi - \phi^{(k)}$ 演化规律为：
$$
e^{(k+1)} = \phi - \phi^{(k+1)} = (K\phi + b) - (K\phi^{(k)} + b) = K(\phi - \phi^{(k)}) = K e^{(k)}
$$
这个关系表明，误差在每次迭代中都会被迭代算子 $K$ 作用一次。因此，迭代收敛的充要条件是，当 $k \to \infty$ 时，$K^k \to 0$。这在数学上等价于要求迭代算子 $K$ 的**谱半径**（spectral radius）$\rho(K)$ 必须严格小于 1 ：
$$
\rho(K)  1
$$
[谱半径](@entry_id:138984)是算子所有特征值绝对值的[上确界](@entry_id:140512)。这个条件是源迭代法[收敛性分析](@entry_id:151547)的核心。

### 谱半径的物理意义与收敛速度

谱半径 $\rho(K)$ 不仅是一个抽象的数学量，它还具有深刻的物理意义，直接决定了迭代的[收敛速度](@entry_id:636873)。

#### 散射率：[谱半径](@entry_id:138984)的物理近似

为了理解 $\rho(K)$ 的物理含义，我们考虑一个理想化的无限大均匀介质。在这种情况下，中子不会泄漏，且通量处处相等，因此流算子中的梯度项 $\nabla\psi$ 为零。输运扫描算子 $T=L^{-1}$ 的作用简化为除以 $\Sigma_t$。此时，迭代算子 $K=MTS$ 的作用过程如下 ：
1.  $S\phi$：产生一个各向同性角源 $\frac{\Sigma_s}{4\pi}\phi$。
2.  $T(S\phi)$：通过除以 $\Sigma_t$ 得到角通量 $\frac{\Sigma_s}{4\pi\Sigma_t}\phi$。
3.  $M(T(S\phi))$：对角通量进行全角积分，得到新的[标量通量](@entry_id:1131249) $\int_{4\pi} \frac{\Sigma_s}{4\pi\Sigma_t}\phi d\Omega = \frac{\Sigma_s}{\Sigma_t}\phi$。

因此，在无限均匀介质中，$K\phi = c\phi$，其中 $c$ 是**散射率**（scattering ratio），定义为：
$$
c = \frac{\Sigma_s}{\Sigma_t}
$$
[散射率](@entry_id:143589) $c$ 代表中子在一次碰撞中发生散射的概率，或者说每次碰撞产生的次级（散射）中子数。在这种理想情况下，算子 $K$ 的唯一特征值就是 $c$，因此其谱半径 $\rho(K) = c$。

这个结论非常直观：[源迭代](@entry_id:1131994)的收敛性取决于中子在一次“迭代代”（generation）中的[增殖能力](@entry_id:895715)。如果每次碰撞产生的散射中子数小于1（即 $c  1$，意味着存在吸收，$\Sigma_a = \Sigma_t - \Sigma_s  0$），那么中子数会逐渐减少，误差会衰减，迭代收敛。

对于任何有限尺寸的物理系统，中子除了被吸收外，还会通过边界泄漏出去。泄漏相当于一个额外的中子移除机制，因此，有限系统的[谱半径](@entry_id:138984)总是小于无限系统的谱半径。所以，散射率 $c$ 是[源迭代](@entry_id:1131994)[谱半径](@entry_id:138984)的一个普适**[上界](@entry_id:274738)** ：
$$
\rho(K) \le \sup_{\boldsymbol{r}} c(\boldsymbol{r})
$$
这个不等式是[源迭代](@entry_id:1131994)理论的基石。它保证了只要系统中处处存在吸收（即 $c(\boldsymbol{r})  1$ 对所有 $\boldsymbol{r}$ 成立），[源迭代](@entry_id:1131994)就必定收敛。这个条件被称为**吸收占优**（absorption dominance）。我们可以通过选择一个合适的加权范数，严格证明在吸收占优的条件下，$K$ 是一个[压缩映射](@entry_id:139989)，从而保证了迭代的收敛性 。

#### 误差模式分析与慢收敛问题

[源迭代](@entry_id:1131994)法的一个著名问题是在光学厚（optically thick）、高散射（highly scattering）的介质中收敛极其缓慢。这两种情况分别对应于系统尺寸远大于平均自由程（$L/\ell \gg 1$，其中 $\ell=1/\Sigma_t$）和[散射率](@entry_id:143589)趋近于1（$c \to 1$）。

我们可以通过傅里叶分析来精确地理解这一现象。假设在一个周期性边界的均匀介质中，误差可以表示为一系列傅里叶模式 $e^{(m)}(x) = \hat{e}^{(m)}(k) \exp(ikx)$ 的叠加，其中 $k$ 是波数 。通过对误差传播方程进行傅里叶变换，可以推导出每个误差模式的**放大因子**（amplification factor）$\rho(k)$，它等于该模式的特征值：
$$
\rho(k) = \frac{\Sigma_s}{k} \arctan\left(\frac{k}{\Sigma_t}\right)
$$
分析这个表达式的行为：
*   当 $k \to \infty$（对应波长极短、高度振荡的误差模式）时，$\rho(k) \to 0$。这表明[源迭代](@entry_id:1131994)法能非常高效地消除高频误差。
*   当 $k \to 0$（对应波长极长、近乎平坦的误差模式）时，利用极限 $\arctan(x)/x \to 1$，我们得到 $\rho(k) \to \Sigma_s/\Sigma_t = c$。

这个结果揭示了[源迭代](@entry_id:1131994)法的本质缺陷：它对于长波长的误差模式几乎没有衰减能力，其衰减率直接由散射率 $c$ 决定。

在光学厚、高散射的系统中，中子经历了无数次散射，其行为类似于随机游走，最终形成一个宏观上平滑的、接近各向同性的通量分布。这种状态被称为**[扩散极限](@entry_id:168181)**（diffusion limit）。在这样的系统中，任何初始误差经过几次迭代后，其高频成分都会被迅速抹平，剩下的是与系统尺寸相当的、缓慢变化的**[基本模式](@entry_id:165201)误差**（fundamental mode error）。对于这种误差，源迭代的放大因子 $\rho(k)$ 约等于 $c$。而当[散射率](@entry_id:143589) $c$ 非常接近1时，谱半径 $\rho(K)$ 也将非常接近1。$\rho(K) \approx 1$ 意味着每次迭代只能将误差减小一个微乎其微的比例，导致收敛停滞 。

### [数值离散化](@entry_id:752782)的影响

在实际计算中，我们求解的是离散化的[输运方程](@entry_id:174281)。数值离散格式本身也会影响收敛速度。考虑一个采用**[菱形差分](@entry_id:1123657)**（diamond-difference）格式离散的单空间网格问题，其[光学厚度](@entry_id:150612)为 $\tau = \Sigma_t \Delta x$。可以推导出，该离散系统的谱半径为 ：
$$
\rho(K)_{\text{discrete}} = \frac{c}{2} \sum_{m=1}^{M} \frac{w_{m}}{1 + \frac{2|\mu_{m}|}{\tau}}
$$
这个表达式清晰地显示了谱半径如何依赖于物理参数（$c$）、网格参数（$\tau$）和角度离散格式（$\{\mu_m, w_m\}$）。

分析此式可知：
*   当网格[光学厚度](@entry_id:150612) $\tau \to \infty$ 时（粗网格或高[截面](@entry_id:154995)），分母中的 1 变得可以忽略，$\rho(K)_{\text{discrete}} \to \frac{c}{2} \sum_{m=1}^{M} w_m = c$。这说明在粗网格极限下，离散系统的谱半径收敛到连续介质的谱半径，慢收敛问题依然存在。
*   当 $\tau \to 0$ 时（细网格），分母趋向于 1，$\rho(K)_{\text{discrete}} \to \frac{c}{2} \sum w_m = c$。
*   对于给定的 $c  1$ 和 $\tau > 0$，谱半径总是小于 $c$。这反映了数值离散引入的“数值泄漏”效应，它有助于加速收敛，但无法从根本上解决当 $c \to 1$ 时的慢收敛问题。

### 迭代残差的物理内涵

在监控迭代过程并判断收敛时，**残差**（residual）是一个关键指标。对于[不动点迭代](@entry_id:749443) $\phi^{(k+1)} = K\phi^{(k)} + b$，其对应的[线性系统](@entry_id:147850)是 $(I-K)\phi = b$。在第 $k$ 次迭代，残差被定义为：
$$
r^{(k)} = b - (I - K)\phi^{(k)}
$$
这个数学定义背后有着清晰的物理图像。通过代入算子定义并进行变换，我们可以得到 ：
$$
M r^{(k)} = (Q + S\phi^{(k)}) - M\phi^{(k)}
$$
这个等式的右边，$(Q + S\phi^{(k)}) - M\phi^{(k)}$，恰恰是在当前通量猜测 $\phi^{(k)}$下，每个空间网格中**中子守恒方程的失衡量**。其中，$Q + S\phi^{(k)}$ 是中子的总产生项（外部源+散射源），而 $M\phi^{(k)}$ 是中子的总损失项（吸收+泄漏）。

因此，残差的物理意义可以概括为：**将每个网格中的中子净产生（或净损失）率作为一个新的“残差源”，通过一次输运扫描（即 $M^{-1}$ 的作用）后得到的通量分布，就是数学上的残差 $r^{(k)}$**。

当迭代收敛时，$\phi^{(k)}$ 趋近于真解 $\phi$，此时每个网格中的中子产生与损失达到平衡，守恒方程的失衡量趋于零，从而导致残差 $r^{(k)}$ 也趋于零。因此，监测残差的大小是判断迭代是否达到物理守恒的有效手段 。