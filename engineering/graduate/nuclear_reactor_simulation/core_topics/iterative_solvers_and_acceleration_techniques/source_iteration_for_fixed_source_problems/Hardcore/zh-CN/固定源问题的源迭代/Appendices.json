{
    "hands_on_practices": [
        {
            "introduction": "为了在计算机上求解中子输运方程，我们必须首先将连续的微分方程转化为一组代数方程，这个过程称为离散化。本练习  将引导您推导一种经典的离散格式——菱形差分法（Diamond-Difference）。通过这个推导，您将掌握如何结合控制体积分与闭合关系式，从而对离散方法的核心思想建立起牢固的理解。",
            "id": "4250937",
            "problem": "考虑一个一维板状材料，将其划分为索引为 $i$ 的多个空间网格，每个网格的宽度均为 $h$。需要使用离散纵标法（$S_N$ 法，即N个离散方向上的球谐函数）求解一个稳态、单能的固定源输运问题。对于索引为 $m$、方向余弦为 $\\mu_m  0$ 的一个纵标（角方向），角通量 $\\psi_m(x)$ 满足一维线性输运方程：\n$$\n\\mu_{m}\\,\\frac{d\\psi_{m}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}(x) = q_{m}(x),\n$$\n其中 $\\Sigma_{t}$ 是总宏观截面，$q_{m}(x)$ 是方向 $m$ 上的总固定源，可能包括外部源和散射源的贡献。在源迭代中，源项是滞后的：在迭代步数 $k+1$ 时，源项取自上一次迭代 $k$ 的结果，然后通过扫描来更新 $\\psi_{m}(x)$。\n\n定义第 $i$ 个网格的边界为 $x_{i-1/2}$ 和 $x_{i+1/2}$，并分别用 $\\psi_{m,i-1}^{(k+1)} \\equiv \\psi_{m}(x_{i-1/2})$ 和 $\\psi_{m,i}^{(k+1)} \\equiv \\psi_{m}(x_{i+1/2})$ 表示 $\\mu_m  0$ 时流入和流出边界的角通量。设网格平均（滞后）源项为\n$$\n\\bar{q}_{m,i}^{(k)} \\equiv \\frac{1}{h}\\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x)\\,dx.\n$$\n在菱形差分空间闭合关系下，网格平均角通量近似为边界值的平均值：\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} \\approx \\frac{1}{2}\\left(\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}\\right).\n$$\n\n从输运方程出发，仅使用上述定义，推导菱形差分格式的离散源迭代更新式。该更新式需要将流出边界通量 $\\psi_{m,i}^{(k+1)}$ 表示为流入边界通量 $\\psi_{m,i-1}^{(k+1)}$、总宏观截面 $\\Sigma_t$、网格宽度 $h$ 以及网格平均源 $\\bar{q}_{m,i}^{(k)}$ 的函数。请以精确的符号形式给出最终表达式，无需进行数值计算。",
            "solution": "该问题是有效的，因为其科学依据在于输运理论的既定原理，特别是采用菱形差分的离散纵标法。该问题是适定的、客观的，并包含了进行形式推导所需的所有必要信息，没有任何矛盾或歧义。\n\n推导的起点是方向余弦为 $\\mu_m > 0$ 的离散方向 $m$ 上的一维、稳态、单能输运方程。在源迭代方法下，第 $k+1$ 次迭代的方程为：\n$$\n\\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) = q_{m}^{(k)}(x)\n$$\n此处，$\\psi_{m}^{(k+1)}(x)$ 是位置 $x$ 处第 $k+1$ 次迭代的角通量，$\\Sigma_t$ 是常数总宏观截面，$q_{m}^{(k)}(x)$ 是总源项，使用上一次迭代 $k$ 的量进行计算。\n\n为了在空间网格 $i$ 上离散此方程，我们在网格宽度 $h$ 上对其进行积分，积分范围从边界 $x_{i-1/2}$ 到边界 $x_{i+1/2}$：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) \\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x)\\,dx\n$$\n我们对积分方程的每一项进行计算。左边的第一项可以使用微积分基本定理直接积分：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} dx = \\mu_{m} \\left[ \\psi_{m}^{(k+1)}(x) \\right]_{x_{i-1/2}}^{x_{i+1/2}} = \\mu_{m} \\left( \\psi_{m}^{(k+1)}(x_{i+1/2}) - \\psi_{m}^{(k+1)}(x_{i-1/2}) \\right)\n$$\n使用问题中关于流入和流出边界通量的记法，$\\psi_{m,i-1}^{(k+1)} \\equiv \\psi_{m}^{(k+1)}(x_{i-1/2})$ 和 $\\psi_{m,i}^{(k+1)} \\equiv \\psi_{m}^{(k+1)}(x_{i+1/2})$，该项变为：\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right)\n$$\n左边的第二项涉及角通量在网格上的积分。我们可以使用网格平均角通量 $\\bar{\\psi}_{m,i}^{(k+1)}$ 的定义来表示它：\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi_{m}^{(k+1)}(x) dx\n$$\n因此，第二项变为：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) dx = \\Sigma_{t} \\left( h \\bar{\\psi}_{m,i}^{(k+1)} \\right) = h \\Sigma_{t} \\bar{\\psi}_{m,i}^{(k+1)}\n$$\n右边的项是源项在网格上的积分。使用问题中关于网格平均源 $\\bar{q}_{m,i}^{(k)}$ 的定义：\n$$\n\\bar{q}_{m,i}^{(k)} = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x) dx\n$$\n方程的右边变为：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x) dx = h \\bar{q}_{m,i}^{(k)}\n$$\n综合这些结果，我们得到网格 $i$ 的空间离散“平衡”方程：\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right) + h \\Sigma_{t} \\bar{\\psi}_{m,i}^{(k+1)} = h \\bar{q}_{m,i}^{(k)}\n$$\n该方程包含三个未知数：两个边界通量 $\\psi_{m,i-1}^{(k+1)}$ 和 $\\psi_{m,i}^{(k+1)}$，以及网格平均通量 $\\bar{\\psi}_{m,i}^{(k+1)}$。为了求解，我们需要一个额外的方程，称为闭合关系。问题指定使用菱形差分（DD）闭合关系，它将网格平均通量与边界通量的平均值联系起来：\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} = \\frac{1}{2}\\left(\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}\\right)\n$$\n我们将此DD闭合关系代入平衡方程：\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right) + h \\Sigma_{t} \\left( \\frac{\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}}{2} \\right) = h \\bar{q}_{m,i}^{(k)}\n$$\n最后一步是代数求解流出通量 $\\psi_{m,i}^{(k+1)}$，用已知的流入通量 $\\psi_{m,i-1}^{(k+1)}$ 和源项 $\\bar{q}_{m,i}^{(k)}$ 来表示。我们展开并整理方程，将包含 $\\psi_{m,i}^{(k+1)}$ 的项归到左边，所有其他项归到右边。\n$$\n\\mu_{m} \\psi_{m,i}^{(k+1)} - \\mu_{m} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\Sigma_{t}}{2} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\Sigma_{t}}{2} \\psi_{m,i}^{(k+1)} = h \\bar{q}_{m,i}^{(k)}\n$$\n$$\n\\psi_{m,i}^{(k+1)} \\left( \\mu_{m} + \\frac{h \\Sigma_{t}}{2} \\right) - \\psi_{m,i-1}^{(k+1)} \\left( \\mu_{m} - \\frac{h \\Sigma_{t}}{2} \\right) = h \\bar{q}_{m,i}^{(k)}\n$$\n$$\n\\psi_{m,i}^{(k+1)} \\left( \\mu_{m} + \\frac{h \\Sigma_{t}}{2} \\right) = \\psi_{m,i-1}^{(k+1)} \\left( \\mu_{m} - \\frac{h \\Sigma_{t}}{2} \\right) + h \\bar{q}_{m,i}^{(k)}\n$$\n分离出 $\\psi_{m,i}^{(k+1)}$ 得到最终的更新方程：\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{\\mu_{m} - \\frac{h \\Sigma_{t}}{2}}{\\mu_{m} + \\frac{h \\Sigma_{t}}{2}} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\bar{q}_{m,i}^{(k)}}{\\mu_{m} + \\frac{h \\Sigma_{t}}{2}}\n$$\n为了用公分母表示此表达式并消除分子和分母中的分数，我们可以将每项的分子和分母都乘以 $2$：\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{2\\left(\\mu_{m} - \\frac{h \\Sigma_{t}}{2}\\right)}{2\\left(\\mu_{m} + \\frac{h \\Sigma_{t}}{2}\\right)} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\left(\\mu_{m} + \\frac{h \\Sigma_{t}}{2}\\right)}\n$$\n这就得到了菱形差分源迭代更新的最终形式：\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{2\\mu_{m} - h \\Sigma_{t}}{2\\mu_{m} + h \\Sigma_{t}} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\mu_{m} + h \\Sigma_{t}}\n$$\n该表达式明确地用流入边界通量和网格平均源项表示了网格 $i$ 的流出边界通量，这正是问题的目标。",
            "answer": "$$\n\\boxed{\\psi_{m,i}^{(k+1)} = \\frac{2\\mu_{m} - h \\Sigma_{t}}{2\\mu_{m} + h \\Sigma_{t}} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\mu_{m} + h \\Sigma_{t}}}\n$$"
        },
        {
            "introduction": "一个数值格式的价值远不止于其数学表达式，它的内在属性决定了其在实际应用中的可靠性。本练习  深入剖析了菱形差分格式的一个关键特性：正定性。您将探索在何种条件下该格式可能产生非物理的负通量，并证明当格式保持正定性时，源迭代过程具有理想的单调收敛性。理解这些特性是审慎使用数值方法的关键，也为发展更先进的格式提供了动机。",
            "id": "4250966",
            "problem": "考虑平板几何中的一维稳态单能线性输运方程，其角通量为 $\\psi(x,\\mu)$，\n$$\n\\mu\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t(x)\\psi(x,\\mu) = \\frac{\\Sigma_s(x)}{2}\\phi(x) + \\frac{q(x)}{2},\n$$\n其中标量通量 $\\phi(x) = \\int_{-1}^{1}\\psi(x,\\mu)d\\mu$，宏观总截面 $\\Sigma_t(x)  0$，散射截面 $\\Sigma_s(x) \\in [0,\\Sigma_t(x))$，以及各向同性固定外源 $q(x) \\ge 0$。使用离散纵标（SN）方法对角度进行离散化，方向集为 $\\{\\mu_m, w_m\\}_{m=1}^{M}$，其中 $\\mu_m \\in (-1,1)$，正权重 $\\{w_m\\}$ 满足 $\\sum_{m=1}^{M} w_m = 2$。在网格宽度为 $h  0$、网格边界位于 $x_{i \\pm 1/2}$ 的均匀网格上对空间进行离散化，并采用标准的网格平衡有限体积格式以及菱形差分闭合关系\n$$\n\\psi_{i,m} = \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right),\n$$\n其中 $\\psi_{i\\pm \\frac{1}{2},m}$ 是边界值，$\\psi_{i,m}$ 是方向 $\\mu_m$ 上的网格平均替代值。\n\n(a) 从给定方向 $\\mu_m > 0$ 上网格 $i$ 的输运方程的网格平衡形式出发，推导线性扫描关系\n$$\n\\psi_{i+\\frac{1}{2},m} = \\alpha_{i,m}\\psi_{i-\\frac{1}{2},m} + \\beta_{i,m}Q_{i,m},\n$$\n其中 $Q_{i,m}$ 是当前迭代步中方向 $\\mu_m$ 上已知的网格平均总源（包括外源和散射贡献）。用 $\\mu_m$, $h$ 和 $\\Sigma_{t,i}$ 表示 $\\alpha_{i,m}$ 和 $\\beta_{i,m}$。找出这些系数需满足的条件，以确保非负的入射角通量 $\\psi_{i-\\frac{1}{2},m} \\ge 0$ 和非负的源 $Q_{i,m} \\ge 0$ 能产生非负的出射角通量 $\\psi_{i+\\frac{1}{2},m} \\ge 0$。解释在什么条件下菱形差分离散化可能会违反非负性。\n\n(b) 使用你的表达式，将非负性条件简化为关于每个角度、每个网格的光学厚度的单个充分不等式\n$$\n\\tau_{i,m} := \\frac{\\Sigma_{t,i}h}{|\\mu_m|}.\n$$\n将得出的界限表述为一个显式不等式，该不等式关联了所有网格 $i$ 和所有角度 $m$ 的 $\\Sigma_{t,i}$, $h$ 和 $|\\mu_m|$。\n\n(c) 考虑各向同性散射的源迭代，散射比为 $c := \\Sigma_s/\\Sigma_t \\in [0,1)$。设标量通量的更新定义为：在每次迭代中，使用总源 $Q_{i,m}^{(k)} = \\frac{1}{2} q_i + \\frac{\\Sigma_{s,i}}{2}\\phi_i^{(k)}$ 求解输运方程，并通过对新的角通量进行加权求和来构建 $\\phi^{(k+1)}$。证明如果由菱形差分离散化定义的输运扫描算子在(a)部分的意义上是正的，那么从 $\\phi^{(0)} \\equiv 0$ 开始且对于 $q_i \\ge 0$，迭代序列 $\\phi^{(k)}$ 在由逐分量不等式诱导的偏序下形成一个单调不减序列。\n\n(d) 最后，对于一个均匀平板，其 $\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}$，且一个对称加权求积的最小正方向余弦为 $\\mu_{\\min} = 0.183434642$，计算在菱形差分下保证源迭代更新单调性的最大均匀网格宽度 $h_{\\max}$（单位为 $\\mathrm{cm}$），如(a)–(c)部分所确立。将你的答案四舍五入到 $4$ 位有效数字，并以 $\\mathrm{cm}$ 为单位表示。",
            "solution": "我们从在角度和空间上离散化的一维稳态单能线性输运方程开始。对于一个给定的宽度为 $h$、范围为 $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}}]$ 的网格 $i$ 和一个方向 $\\mu_m > 0$，该网格上的有限体积平衡给出\n$$\n\\mu_m\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} + \\Sigma_{t,i}\\psi_{i,m} = Q_{i,m},\n$$\n其中 $Q_{i,m}$ 是当前迭代中网格内方向 $m$ 上每单位立体角的已知总源，而 $\\psi_{i,m}$ 通过菱形差分关系闭合\n$$\n\\psi_{i,m} = \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right).\n$$\n\n(a)部分。将菱形差分闭合关系代入平衡方程得到\n$$\n\\mu_m\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} + \\Sigma_{t,i}\\frac{\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}}{2} = Q_{i,m}.\n$$\n将位于 $x_{i+\\frac{1}{2}}$ 的未知数收集到左边：\n$$\n\\left(\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i+\\frac{1}{2},m} + \\left(-\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i-\\frac{1}{2},m} = Q_{i,m}.\n$$\n求解 $\\psi_{i+\\frac{1}{2},m}$ 得到线性扫描关系\n$$\n\\psi_{i+\\frac{1}{2},m} = \\alpha_{i,m}\\psi_{i-\\frac{1}{2},m} + \\beta_{i,m}Q_{i,m},\n$$\n系数为\n$$\n\\alpha_{i,m} = \\frac{\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}} = \\frac{2\\frac{\\mu_m}{h} - \\Sigma_{t,i}}{2\\frac{\\mu_m}{h} + \\Sigma_{t,i}},\n\\qquad\n\\beta_{i,m} = \\frac{1}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}}.\n$$\n对于 $\\mu_m > 0$, $h > 0$ 和 $\\Sigma_{t,i} > 0$，分母 $\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}$ 恒为正。因此 $\\beta_{i,m} > 0$ 总是成立。$\\alpha_{i,m}$ 的符号由分子 $\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}$ 决定。如果 $\\alpha_{i,m} \\ge 0$ 且 $\\beta_{i,m} > 0$，那么对于 $\\psi_{i-\\frac{1}{2},m} \\ge 0$ 和 $Q_{i,m} \\ge 0$，我们有 $\\psi_{i+\\frac{1}{2},m} \\ge 0$，从而确立了该方向上扫描更新的非负性。反之，如果 $\\alpha_{i,m}  0$，那么即使 $\\psi_{i-\\frac{1}{2},m} \\ge 0$ 且 $Q_{i,m} \\ge 0$，项 $\\alpha_{i,m}\\psi_{i-\\frac{1}{2},m}$ 也变为非正；如果它的大小超过 $\\beta_{i,m}Q_{i,m}$, 就可能产生 $\\psi_{i+\\frac{1}{2},m}  0$。因此，当 $\\alpha_{i,m}  0$ 时，菱形差分离散化可能违反非负性，这种情况发生在光学足够厚的网格中。\n\n(b)部分。引入每个角度、每个网格的光学厚度\n$$\n\\tau_{i,m} := \\frac{\\Sigma_{t,i}h}{|\\mu_m|}.\n$$\n对于 $\\mu_m > 0$，我们有\n$$\n\\alpha_{i,m} = \\frac{2 - \\tau_{i,m}}{2 + \\tau_{i,m}}.\n$$\n对于非负的入射通量和非负的源，扫描映射的非负性当且仅当 $\\alpha_{i,m} \\ge 0$ 且 $\\beta_{i,m} > 0$ 时得到保证。如前所述，$\\beta_{i,m} > 0$ 总是成立。因此，充分条件简化为\n$$\n\\alpha_{i,m} \\ge 0 \\quad \\Longleftrightarrow \\quad 2 - \\tau_{i,m} \\ge 0 \\quad \\Longleftrightarrow \\quad \\tau_{i,m} \\le 2.\n$$\n根据对称性，对于 $\\mu_m  0$，使用 $|\\mu_m|$ 的相同条件也适用。因此，在每个网格和每个离散方向上，菱形差分扫描的一个充分非负性条件是\n$$\n\\frac{\\Sigma_{t,i}h}{|\\mu_m|} \\le 2 \\quad \\text{对所有网格 } i \\text{ 和所有角度 } m,\n$$\n等价地，\n$$\nh \\le \\frac{2|\\mu_m|}{\\Sigma_{t,i}} \\quad \\text{对所有 } i,m.\n$$\n在给定的网格和角度集上，最严格的界限使用最小的正方向余弦 $\\mu_{\\min} := \\min_{m:\\, \\mu_m > 0} \\mu_m$ 和最大的网格总截面 $\\Sigma_{t,\\max} := \\max_i \\Sigma_{t,i}$，从而给出全局充分条件\n$$\nh \\le \\frac{2\\mu_{\\min}}{\\Sigma_{t,\\max}}.\n$$\n\n(c)部分。令 $\\mathcal{L}$ 表示将角通量映射到其流输-吸收残差的输运算子，该算子在空间和角度上使用菱形差分离散化；并令 $\\mathcal{L}^{-1}$ 表示相应的扫描算子，它将给定的总源 $Q$ 映射到唯一的迎风格式角通量 $\\psi$。在(b)部分的条件下，每个网格-角度的扫描更新都具有仅依赖于局部数据的非负系数，因此 $\\mathcal{L}^{-1}$ 是一个正线性算子：对于任意两个总源 $Q,Q'$，若其逐分量满足 $Q \\ge Q'$，则有 $\\mathcal{L}^{-1}Q \\ge \\mathcal{L}^{-1}Q'$ 逐分量成立。\n\n对于散射比为 $c = \\Sigma_s/\\Sigma_t \\in [0,1)$ 的各向同性散射，定义正线性散射算子 $\\mathcal{S}$，它将标量通量 $\\phi$ 映射到各向同性角源，其分量为 $(\\mathcal{S}\\phi)_{i,m} = \\frac{\\Sigma_{s,i}}{2}\\phi_i$。外源 $q$ 诱导一个非负的各向同性角源 $\\mathcal{Q}_{\\mathrm{ext}}$，其分量为 $(\\mathcal{Q}_{\\mathrm{ext}})_{i,m} = \\frac{q_i}{2}$。源迭代是以下不动点迭代\n$$\n\\psi^{(k+1)} = \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\phi^{(k)}\\right), \\qquad \\phi^{(k+1)} = \\sum_{m=1}^{M} w_m\\psi^{(k+1)}_{(\\cdot),m},\n$$\n初始值为 $\\phi^{(0)} \\equiv 0$。设从角通量到标量通量的平均算子 $\\mathcal{A}$ 定义为 $\\mathcal{A}\\psi = \\sum_{m=1}^{M} w_m\\psi_{(\\cdot),m}$；该算子具有非负权重，因此在序的意义上是正的。\n\n我们用数学归纳法证明 $\\phi^{(k)}$ 是单调不减的。基础步骤：$\\phi^{(0)} = 0$。则 $\\psi^{(1)} = \\mathcal{L}^{-1}\\mathcal{Q}_{\\mathrm{ext}} \\ge 0$，因为 $\\mathcal{Q}_{\\mathrm{ext}} \\ge 0$ 且 $\\mathcal{L}^{-1}$ 是正算子。因此 $\\phi^{(1)} = \\mathcal{A}\\psi^{(1)} \\ge 0 = \\phi^{(0)}$。假设 $\\phi^{(k)} \\ge \\phi^{(k-1)}$。由于 $\\mathcal{S}$ 是正算子，$\\mathcal{S}\\phi^{(k)} \\ge \\mathcal{S}\\phi^{(k-1)}$。因此\n$$\n\\psi^{(k+1)} = \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\phi^{(k)}\\right) \\ge \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\phi^{(k-1)}\\right) = \\psi^{(k)},\n$$\n根据 $\\mathcal{L}^{-1}$ 的正性。应用正的平均算子 $\\mathcal{A}$，我们得到 $\\phi^{(k+1)} = \\mathcal{A}\\psi^{(k+1)} \\ge \\mathcal{A}\\psi^{(k)} = \\phi^{(k)}$。因此，$\\{\\phi^{(k)}\\}$ 是一个单调不减序列。这个结论依赖于扫描映射的正性（保序性），而这一性质由(b)部分中的界 $\\tau_{i,m} \\le 2$ 所保证。\n\n(d)部分。在一个均匀平板中，$\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}$，最小正方向余弦为 $\\mu_{\\min} = 0.183434642$，对所有角度的充分非负性条件简化为\n$$\nh \\le \\frac{2\\mu_{\\min}}{\\Sigma_t}.\n$$\n因此，允许的最大均匀网格宽度为\n$$\nh_{\\max} = \\frac{2\\mu_{\\min}}{\\Sigma_t} = \\frac{2 \\times 0.183434642}{1.2} = \\frac{0.366869284}{1.2} = 0.305724403\\ldots.\n$$\n四舍五入到 $4$ 位有效数字并以 $\\mathrm{cm}$ 为单位表示，得到\n$$\nh_{\\max} = 0.3057.\n$$\n这个界限保证了菱形差分扫描算子在每个网格和每个方向上都是正的，因此在所述假设下，源迭代的更新是单调不减的。",
            "answer": "$$\\boxed{0.3057}$$"
        },
        {
            "introduction": "检验理论学习成果的最终方式是构建一个能够解决实际问题的计算程序。在本项综合实践  中，您将使用更为稳健的步进特征线法（Step Characteristics）来实现一个完整的一维源迭代求解器。通过开展网格细化的数值实验，您将亲眼观察到，随着离散网格趋于精细，问题的数值行为如何从输运主导向扩散主导过渡，以及这种过渡如何深刻影响迭代的收敛速度。",
            "id": "4250944",
            "problem": "考虑一维、稳态、单能中子输运方程，该方程描述了平板几何中各向同性散射以及真空边界条件下的情况。角通量$\\psi(x,\\mu)$的控制方程为\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = Q(x) + \\frac{\\Sigma_s}{2} \\phi(x),\n$$\n其中 $x \\in [0,L]$，$ \\mu \\in [-1,1] $，$ \\Sigma_t $ 是总宏观截面，$ \\Sigma_s $ 是散射宏观截面，$ Q(x) $ 是一个固定的外部各向同性源，标量通量 $ \\phi(x) $ 定义为\n$$\n\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\, d\\mu.\n$$\n使用离散纵标 (S$_N$) 方法和 Gauss-Legendre 角求积来近似角积分，其中有 $ M $ 个离散方向 $ \\{\\mu_m, w_m\\}_{m=1}^{M} $，$ \\mu_m $ 是方向余弦，$ w_m $ 是权重，满足 $ \\sum_{m=1}^{M} w_m = 2 $。将空间域 $ [0,L] $ 离散化为一个包含 $ N $ 个单元的均匀网格，每个单元的宽度为 $ h = L/N $。假设真空边界，即对于 $ \\mu > 0 $ 有 $ \\psi(0,\\mu) = 0 $，对于 $ \\mu  0 $ 有 $ \\psi(L,\\mu) = 0 $。\n\n通过对每个离散方向重复执行输运扫描，为固定源问题实现源迭代。对于空间离散化，使用阶跃特征线法，该方法是输运方程在源为常数的单元内的精确解。对于宽度为 $ h $ 的单个单元、方向余弦为 $ \\mu $（$ |\\mu| > 0 $）、上风向单元面的入射角通量为 $ \\psi_{\\text{in}} $、单元内总源为常数 $ q = Q + \\frac{\\Sigma_s}{2}\\phi $ 的情况，单元的光学厚度为 $ \\tau = \\Sigma_t h / |\\mu| $，下风向面的出射角通量为\n$$\n\\psi_{\\text{out}} = \\psi_{\\text{in}} e^{-\\tau} + \\frac{q}{\\Sigma_t}\\left(1 - e^{-\\tau}\\right).\n$$\n该方向上的单元平均角通量为\n$$\n\\overline{\\psi} = \\psi_{\\text{in}} \\, A(\\tau) + \\frac{q}{\\Sigma_t}\\left(1 - A(\\tau)\\right),\n\\quad \\text{其中} \\quad\nA(\\tau) = \\frac{1 - e^{-\\tau}}{\\tau}.\n$$\n单元内的标量通量通过角求积计算，\n$$\n\\phi = \\sum_{m=1}^{M} w_m \\overline{\\psi}_m.\n$$\n源迭代通过由 $ q^{(k)} = Q + \\frac{\\Sigma_s}{2}\\phi^{(k)} $ 驱动的输运扫描来更新标量通量 $ \\phi^{(k)} $，从而产生新的 $ \\phi^{(k+1)} $，并重复此过程直至收敛。定义散射比 $ c = \\Sigma_s / \\Sigma_t $。为研究收敛性，需要测量标量通量相对变化降至容差以下所需的迭代次数，并通过接近收敛时连续残差范数的比值来估计源迭代的渐近收缩因子。\n\n通过保持物理属性固定并改变网格尺寸 $ h $，分析网格细化的影响。具体来说，通过对长度进行无量纲化来固定无量纲参数，使得 $ \\Sigma_t = 1 $（因此所有长度都以平均自由程为单位，不需要物理单位转换），选择 $ L = 10 $，$ c = 0.95 $，以及常数各向同性源 $ Q(x) = Q_0 = 1 $。使用 $ M = 4 $ 个 Gauss-Legendre 点进行角求积。使用上述阶跃特征线离散化和真空边界条件实现源迭代。\n\n对于每个对应于单元数 $ N \\in \\{2, 20, 80, 320\\} $ 的网格尺寸 $ h $，您的程序必须计算以下内容：\n- 无穷范数相对变化 $ \\|\\phi^{(k+1)} - \\phi^{(k)}\\|_{\\infty} / \\|\\phi^{(k+1)}\\|_{\\infty} $ 降至容差 $ \\varepsilon = 10^{-8} $ 以下所需的源迭代次数（整数）。\n- 源迭代谱半径（渐近收缩因子）$ \\rho $ 的估计值，由最后两次连续残差范数 $ r^{(k)} = \\|\\phi^{(k+1)} - \\phi^{(k)}\\|_2 $ 和 $ r^{(k-1)} = \\|\\phi^{(k)} - \\phi^{(k-1)}\\|_2 $ 的比值给出，即 $ \\rho \\approx r^{(k)} / r^{(k-1)} $，在最后一次迭代时计算。二范数 (L2) 是欧几里得范数。\n\n在您的解答中，从输运方程出发，并使用渐近推理，解释在 $ L $、$ \\Sigma_t $ 和 $ c $ 固定的情况下，当 $ h \\to 0 $ 时，网格细化如何影响源迭代的收敛性，并阐明从输运行为到扩散极限的过渡。\n\n测试套件：\n- 情况 $ 1 $: $ N = 2 $（非常粗的网格），$ h = L/N $。\n- 情况 $ 2 $: $ N = 20 $（粗网格），$ h = L/N $。\n- 情况 $ 3 $: $ N = 80 $（细网格），$ h = L/N $。\n- 情况 $ 4 $: $ N = 320 $（非常细的网格），$ h = L/N $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个含有两个元素的列表：第一个元素是上述测试用例按 $ N = 2, 20, 80, 320 $ 顺序排列的四个迭代次数（整数）的列表，第二个元素是四个相应的谱半径估计值（浮点数）的列表，每个值四舍五入到六位小数。例如，输出必须采用以下形式\n$$\n[[i_1,i_2,i_3,i_4],[\\rho_1,\\rho_2,\\rho_3,\\rho_4]],\n$$\n其中 $ i_j $ 是整数，$ \\rho_j $ 是四舍五入到六位小数的浮点数。",
            "solution": "起点是一维、稳态、单能、各向同性散射的中子输运方程，\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = Q(x) + \\frac{\\Sigma_s}{2} \\phi(x),\n\\quad\n\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\, d\\mu,\n$$\n其真空边界条件为 $ \\mu > 0 $ 时 $ \\psi(0,\\mu) = 0 $，$ \\mu  0 $ 时 $ \\psi(L,\\mu) = 0 $。为了进行数值求解，离散纵标 (S$_N$) 方法通过有限和来近似角积分，\n$$\n\\phi(x) \\approx \\sum_{m=1}^{M} w_m \\psi(x,\\mu_m),\n$$\n其中 $ \\{\\mu_m, w_m\\}_{m=1}^{M} $ 是区间 $ [-1,1] $ 上的 Gauss-Legendre 节点和权重，且 $ \\sum_{m} w_m = 2 $。我们用一个包含 $ N $ 个单元的均匀网格对空间进行离散化，每个单元的宽度为 $ h = L/N $。\n\n源迭代算法使用从当前标量通量迭代值 $ \\phi^{(k)} $ 计算出的散射源来执行输运扫描，并获得更新后的通量 $ \\phi^{(k+1)} $。具体来说，\n$$\nq^{(k)}(x) = Q(x) + \\frac{\\Sigma_s}{2} \\phi^{(k)}(x),\n$$\n并且对每个离散方向 $ \\mu_m $ 的输运扫描求解\n$$\n\\mu_m \\frac{\\partial \\psi^{(k+1)}(x,\\mu_m)}{\\partial x} + \\Sigma_t \\psi^{(k+1)}(x,\\mu_m) = q^{(k)}(x)\n$$\n使用合适的上风向边界条件。然后通过求积形成标量通量迭代值，\n$$\n\\phi^{(k+1)}(x) = \\sum_{m=1}^{M} w_m \\overline{\\psi}^{(k+1)}(x,\\mu_m),\n$$\n其中 $ \\overline{\\psi} $ 表示与空间离散化一致的单元平均角通量。\n\n对于空间离散化，采用阶跃特征线法。在一个宽度为 $ h $、总源为常数 $ q $ 的单元上，具有常系数的输运方程沿特征线有精确解。如果 $ \\psi_{\\text{in}} $ 是上风向面的入射通量，$ \\tau = \\Sigma_t h / |\\mu| $ 是单元对于方向 $ \\mu $ 的光学厚度，那么下风向面的出射通量为\n$$\n\\psi_{\\text{out}} = \\psi_{\\text{in}} e^{-\\tau} + \\frac{q}{\\Sigma_t}\\left(1 - e^{-\\tau}\\right).\n$$\n单元平均角通量是\n$$\n\\overline{\\psi} = \\frac{1}{h} \\int_{0}^{h} \\left( \\psi_{\\text{in}} e^{-\\Sigma_t x / |\\mu|} + \\frac{q}{\\Sigma_t} \\left( 1 - e^{-\\Sigma_t x / |\\mu|} \\right) \\right) dx\n= \\psi_{\\text{in}} \\, A(\\tau) + \\frac{q}{\\Sigma_t}\\left(1 - A(\\tau)\\right),\n$$\n其中\n$$\nA(\\tau) = \\frac{1 - e^{-\\tau}}{\\tau}.\n$$\n该方法保持正性，并在各种光学厚度下都保持一致性，确保了对于任何 $ \\tau $ 的扫描都是稳健的。\n\n为了分析源迭代的收敛性，考虑误差的传播。设 $ \\phi^\\star $ 为标量通量的精确解。定义误差 $ e^{(k)} = \\phi^{(k)} - \\phi^\\star $。源迭代的更新可以在精确解附近进行线性化，以揭示误差大致按以下方式演化\n$$\ne^{(k+1)} \\approx \\mathcal{K} \\left( \\frac{\\Sigma_s}{2} \\right) e^{(k)} = \\mathcal{K} \\Sigma_s' e^{(k)},\n$$\n其中 $ \\mathcal{K} $ 是将源映射到通量的输运扫描算子，$ \\Sigma_s' $ 表示作用于标量的各向同性散射算子。在离散纵标中的各向同性散射情况下，$ \\Sigma_s' $ 将源按 $ c = \\Sigma_s/\\Sigma_t $ 缩放并将其各向同性地重新分布。迭代的谱半径 $ \\rho $ 由 $ \\mathcal{K} \\Sigma_s' $ 的最大放大因子决定。在光学薄、输运主导的区域和真空边界条件下，$ \\mathcal{K} $ 由于流输和吸收而衰减源的高频分量，使 $ \\rho $ 减小到 $ c $ 以下。在扩散区域，散射占主导地位且区域光学厚，长波误差分量被流输弱衰减，$ \\mathcal{K} $ 在慢模上接近单位算子，导致 $ \\rho $ 趋近于 $ c $。\n\n从输运行为到扩散极限的过渡可以通过渐近分析来阐明。引入 $ \\Sigma_t = 1 $ 的无量纲标度，并让 $ L $ 以平均自由程为单位进行测量。定义 $ \\varepsilon = 1/L $ 作为大区域的小参数。对于 $ c $ 接近 1 的强散射介质，角通量允许渐近展开 $ \\psi(x,\\mu) = \\phi_0(x)/2 + \\varepsilon \\psi_1(x,\\mu) + \\varepsilon^2 \\psi_2(x,\\mu) + \\cdots $，其中 $ \\phi_0(x) $ 是主阶标量通量。平衡 $ \\varepsilon $ 的各阶，主阶行为使通量近乎各向同性，而次阶修正则为流密度 $ J(x) = \\int_{-1}^{1} \\mu \\psi(x,\\mu) \\, d\\mu $ 提供了 Fick 定律，从而得到 $ \\phi_0(x) $ 的扩散方程，\n$$\n- D \\frac{d^2 \\phi_0(x)}{dx^2} + \\Sigma_a \\phi_0(x) = Q(x),\n\\quad D = \\frac{1}{3 \\Sigma_t},\n\\quad \\Sigma_a = \\Sigma_t - \\Sigma_s = \\Sigma_t (1 - c),\n$$\n其边界条件由输运问题导出。这表明，随着散射占主导地位且系统变得光学厚，输运问题在主阶上简化为扩散问题。\n\n网格细化会影响离散算子 $ \\mathcal{K} $：当 $ L $、$ \\Sigma_t $ 和 $ c $ 固定时，随着 $ h \\to 0 $，离散扫描能更好地解析流输和散射过程，并更准确地捕捉长波模式。因此，离散误差传播算子越来越像其连续对应物。在类输运的粗网格条件下，由粗糙空间分辨率引入的数值扩散会更剧烈地衰减误差，从而产生较小的 $ \\rho $ 和较少的迭代次数。在类扩散的细网格条件下，长波误差模式以弱衰减持续存在，$ \\rho $ 趋近于 $ c $，导致源迭代收敛变慢。因此，在保持物理属性固定的同时细化 $ h $，会使离散行为从类输运（收敛更快）过渡到扩散极限（收敛更慢），这与渐近理论一致。\n\n算法设计：\n- 选择 $ \\Sigma_t = 1 $，$ L = 10 $，$ c = 0.95 $，$ Q_0 = 1 $，$ M = 4 $ 个 Gauss-Legendre 点。\n- 对于每个 $ N \\in \\{2, 20, 80, 320\\} $，设置 $ h = L/N $。\n- 在所有单元中初始化 $ \\phi^{(0)}(x) = 0 $。设置残差 $ r^{(-1)} = r^{(0)} = +\\infty $。\n- 迭代：\n  - 对每个单元索引 $ i = 1, \\dots, N $，形成 $ q^{(k)}_i = Q_0 + \\frac{\\Sigma_s}{2} \\phi^{(k)}_i $。\n  - 对于每个角度 $ \\mu_m $ 和权重 $ w_m $，使用阶跃特征线法和真空边界条件执行输运扫描，通过带有 $ A(\\tau) $ 的公式累加 $ \\phi^{(k+1)}_i = \\sum_m w_m \\overline{\\psi}^{(k+1)}_{i,m} $。\n  - 计算无穷范数相对变化 $ \\delta^{(k)} = \\|\\phi^{(k+1)} - \\phi^{(k)}\\|_{\\infty} / \\|\\phi^{(k+1)}\\|_{\\infty} $。计算二范数残差 $ r^{(k)} = \\|\\phi^{(k+1)} - \\phi^{(k)}\\|_2 $。\n  - 当 $ \\delta^{(k)}  \\varepsilon = 10^{-8} $ 或达到迭代次数上限时停止。\n- 报告整数迭代次数和在最后一次迭代时估计的谱半径 $ \\rho \\approx r^{(k)} / r^{(k-1)} $。将 $ \\rho $ 四舍五入到六位小数。\n\n预期结果：\n- 随着网格细化（更大的 $ N $ 和更小的 $ h $），迭代次数增加，这是因为离散算子解析了类扩散的慢误差模式，将 $ \\rho $ 推向更接近 $ c $ 的值。\n- 随着 $ h \\to 0 $，谱半径估计值增加并趋向于 $ c $，反映了从粗网格上的类输运衰减到细网格上的类扩散行为的过渡。\n\n该程序仅使用无量纲量实现此算法；因此，不需要物理单位转换。最终输出是包含指定测试套件的迭代次数和谱半径估计值的单行文本，格式如前所述。",
            "answer": "$$[[103, 267, 390, 429], [0.865809, 0.942767, 0.948270, 0.949318]]$$"
        }
    ]
}