{
    "hands_on_practices": [
        {
            "introduction": "Translating the continuous transport equation into a set of algebraic equations for a computer to solve is the foundational step in computational transport theory. This exercise will guide you through the derivation of the classic diamond-difference update rule from first principles, providing a crucial link between the continuous physics and the discrete algorithm executed in a transport sweep . Mastering this derivation solidifies your understanding of how particle balance is enforced on a discrete spatial mesh, forming the basis for many production-level codes.",
            "id": "4250937",
            "problem": "Consider a one-dimensional slab of material subdivided into spatial cells indexed by $i$, each of uniform width $h$. A steady-state, monoenergetic fixed-source transport problem is to be solved using the Discrete Ordinates ($S_N$) method. For an ordinate (angular direction) indexed by $m$ with direction cosine $\\mu_{m}0$, the angular flux $\\psi_{m}(x)$ satisfies the one-dimensional linear transport equation\n$$\n\\mu_{m}\\,\\frac{d\\psi_{m}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}(x) = q_{m}(x),\n$$\nwhere $\\Sigma_{t}$ is the total macroscopic cross section, and $q_{m}(x)$ is the total fixed source for direction $m$, which may include external and scattering contributions. In source iteration, the source is lagged: at iteration index $k+1$, the source is taken from the previous iterate $k$, and one sweeps to update $\\psi_{m}(x)$.\n\nDefine the $i$th cell edges as $x_{i-1/2}$ and $x_{i+1/2}$, and denote the inflow and outflow edge angular fluxes for $\\mu_{m}0$ by $\\psi_{m,i-1}^{(k+1)} \\equiv \\psi_{m}(x_{i-1/2})$ and $\\psi_{m,i}^{(k+1)} \\equiv \\psi_{m}(x_{i+1/2})$, respectively. Let the cell-averaged (lagged) source be\n$$\n\\bar{q}_{m,i}^{(k)} \\equiv \\frac{1}{h}\\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x)\\,dx.\n$$\nUnder the diamond-difference spatial closure, the cell-averaged angular flux is approximated by the average of the edge values,\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} \\approx \\frac{1}{2}\\left(\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}\\right).\n$$\n\nStarting from the transport equation and using only the definitions above, derive the discrete source iteration update for the diamond-difference scheme that expresses the outflow edge flux $\\psi_{m,i}^{(k+1)}$ in terms of the inflow edge flux $\\psi_{m,i-1}^{(k+1)}$, the total macroscopic cross section $\\Sigma_{t}$, the cell width $h$, and the cell-averaged source $\\bar{q}_{m,i}^{(k)}$. Provide your final expression in exact symbolic form. No numerical evaluation is required.",
            "solution": "The problem is valid as it is scientifically grounded in the established principles of transport theory, specifically the Discrete Ordinates method with diamond-differencing. It is well-posed, objective, and contains all necessary information for a formal derivation without any contradictions or ambiguities.\n\nThe starting point for the derivation is the one-dimensional, steady-state, monoenergetic transport equation for a discrete direction $m$ with direction cosine $\\mu_m > 0$. Under the source iteration method, the equation for iteration $k+1$ is given by:\n$$\n\\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) = q_{m}^{(k)}(x)\n$$\nHere, $\\psi_{m}^{(k+1)}(x)$ is the angular flux at position $x$ and iteration $k+1$, $\\Sigma_t$ is the constant total macroscopic cross section, and $q_{m}^{(k)}(x)$ is the total source, evaluated using quantities from the previous iteration, $k$.\n\nTo discretize this equation over a spatial cell $i$, we integrate it over the cell width $h$, from edge $x_{i-1/2}$ to edge $x_{i+1/2}$:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) \\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x)\\,dx\n$$\nWe evaluate each term of the integrated equation. The first term on the left side is integrated directly using the fundamental theorem of calculus:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\mu_{m}\\,\\frac{d\\psi_{m}^{(k+1)}(x)}{dx} dx = \\mu_{m} \\left[ \\psi_{m}^{(k+1)}(x) \\right]_{x_{i-1/2}}^{x_{i+1/2}} = \\mu_{m} \\left( \\psi_{m}^{(k+1)}(x_{i+1/2}) - \\psi_{m}^{(k+1)}(x_{i-1/2}) \\right)\n$$\nUsing the problem's notation for the inflow and outflow edge fluxes, $\\psi_{m,i-1}^{(k+1)} \\equiv \\psi_{m}^{(k+1)}(x_{i-1/2})$ and $\\psi_{m,i}^{(k+1)} \\equiv \\psi_{m}^{(k+1)}(x_{i+1/2})$, this term becomes:\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right)\n$$\nThe second term on the left side involves the integral of the angular flux over the cell. We can express this using the definition of the cell-averaged angular flux, $\\bar{\\psi}_{m,i}^{(k+1)}$:\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi_{m}^{(k+1)}(x) dx\n$$\nThus, the second term becomes:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\Sigma_{t}\\,\\psi_{m}^{(k+1)}(x) dx = \\Sigma_{t} \\left( h \\bar{\\psi}_{m,i}^{(k+1)} \\right) = h \\Sigma_{t} \\bar{\\psi}_{m,i}^{(k+1)}\n$$\nThe term on the right side is the integral of the source over the cell. Using the problem's definition for the cell-averaged source, $\\bar{q}_{m,i}^{(k)}$:\n$$\n\\bar{q}_{m,i}^{(k)} = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x) dx\n$$\nThe right side of the equation becomes:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} q_{m}^{(k)}(x) dx = h \\bar{q}_{m,i}^{(k)}\n$$\nCombining these results, we obtain the spatially discretized \"balance\" equation for cell $i$:\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right) + h \\Sigma_{t} \\bar{\\psi}_{m,i}^{(k+1)} = h \\bar{q}_{m,i}^{(k)}\n$$\nThis equation contains three unknowns: the two edge fluxes $\\psi_{m,i-1}^{(k+1)}$ and $\\psi_{m,i}^{(k+1)}$, and the cell-averaged flux $\\bar{\\psi}_{m,i}^{(k+1)}$. To solve this, we need an additional equation, known as a closure relation. The problem specifies the use of the diamond-difference (DD) closure, which relates the cell-averaged flux to the average of the edge fluxes:\n$$\n\\bar{\\psi}_{m,i}^{(k+1)} = \\frac{1}{2}\\left(\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}\\right)\n$$\nWe substitute this DD closure relation into the balance equation:\n$$\n\\mu_{m} \\left( \\psi_{m,i}^{(k+1)} - \\psi_{m,i-1}^{(k+1)} \\right) + h \\Sigma_{t} \\left( \\frac{\\psi_{m,i-1}^{(k+1)} + \\psi_{m,i}^{(k+1)}}{2} \\right) = h \\bar{q}_{m,i}^{(k)}\n$$\nThe final step is to algebraically solve for the outflow flux, $\\psi_{m,i}^{(k+1)}$, in terms of the known inflow flux, $\\psi_{m,i-1}^{(k+1)}$, and the source term, $\\bar{q}_{m,i}^{(k)}$. We expand and rearrange the equation to group terms involving $\\psi_{m,i}^{(k+1)}$ on the left-hand side and all other terms on the right-hand side.\n$$\n\\mu_{m} \\psi_{m,i}^{(k+1)} - \\mu_{m} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\Sigma_{t}}{2} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\Sigma_{t}}{2} \\psi_{m,i}^{(k+1)} = h \\bar{q}_{m,i}^{(k)}\n$$\n$$\n\\psi_{m,i}^{(k+1)} \\left( \\mu_{m} + \\frac{h \\Sigma_{t}}{2} \\right) - \\psi_{m,i-1}^{(k+1)} \\left( \\mu_{m} - \\frac{h \\Sigma_{t}}{2} \\right) = h \\bar{q}_{m,i}^{(k)}\n$$\n$$\n\\psi_{m,i}^{(k+1)} \\left( \\mu_{m} + \\frac{h \\Sigma_{t}}{2} \\right) = \\psi_{m,i-1}^{(k+1)} \\left( \\mu_{m} - \\frac{h \\Sigma_{t}}{2} \\right) + h \\bar{q}_{m,i}^{(k)}\n$$\nIsolating $\\psi_{m,i}^{(k+1)}$ gives the final update equation:\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{\\mu_{m} - \\frac{h \\Sigma_{t}}{2}}{\\mu_{m} + \\frac{h \\Sigma_{t}}{2}} \\psi_{m,i-1}^{(k+1)} + \\frac{h \\bar{q}_{m,i}^{(k)}}{\\mu_{m} + \\frac{h \\Sigma_{t}}{2}}\n$$\nTo present this expression with a common denominator and remove fractions in the numerator and denominator, we can multiply the numerator and denominator of each term by $2$:\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{2\\left(\\mu_{m} - \\frac{h \\Sigma_{t}}{2}\\right)}{2\\left(\\mu_{m} + \\frac{h \\Sigma_{t}}{2}\\right)} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\left(\\mu_{m} + \\frac{h \\Sigma_{t}}{2}\\right)}\n$$\nThis results in the final form of the diamond-difference source iteration update:\n$$\n\\psi_{m,i}^{(k+1)} = \\frac{2\\mu_{m} - h \\Sigma_{t}}{2\\mu_{m} + h \\Sigma_{t}} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\mu_{m} + h \\Sigma_{t}}\n$$\nThis expression gives the outflow edge flux for cell $i$ explicitly in terms of its inflow edge flux and the cell-averaged source, which was the objective of the problem.",
            "answer": "$$\n\\boxed{\\psi_{m,i}^{(k+1)} = \\frac{2\\mu_{m} - h \\Sigma_{t}}{2\\mu_{m} + h \\Sigma_{t}} \\psi_{m,i-1}^{(k+1)} + \\frac{2h \\bar{q}_{m,i}^{(k)}}{2\\mu_{m} + h \\Sigma_{t}}}\n$$"
        },
        {
            "introduction": "While the diamond-difference scheme is simple and formally second-order accurate, it can produce unphysical negative angular fluxes, a critical flaw for reliable simulations. This practice delves into the positivity of the diamond-difference scheme, connecting the numerical stability of the method to the physical and geometric parameters of the problem, such as the cell's optical thickness, defined as $\\tau_{i,m} := \\frac{\\Sigma_{t,i} h}{|\\mu_m|}$ . By deriving the positivity condition, you will gain deep insight into the limitations of simple discretization schemes and the fundamental trade-offs between accuracy and robustness.",
            "id": "4250966",
            "problem": "Consider the one-dimensional, steady-state, monoenergetic linear transport equation in slab geometry for angular flux $\\,\\psi(x,\\mu)\\,$,\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t(x)\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_s(x)}{2}\\,\\phi(x) \\;+\\; \\frac{q(x)}{2}\\,,\n$$\nwith scalar flux $\\,\\phi(x) = \\int_{-1}^{1}\\psi(x,\\mu)\\,d\\mu\\,$, total macroscopic cross section $\\,\\Sigma_t(x)  0\\,$, scattering cross section $\\,\\Sigma_s(x) \\in [0,\\Sigma_t(x))\\,$, and isotropic fixed external source $\\,q(x) \\ge 0\\,$. Discretize angle using the discrete ordinates (SN) method on a set of directions $\\{\\mu_m, w_m\\}_{m=1}^{M}$ with $\\mu_m \\in (-1,1)$ and positive weights $\\{w_m\\}$ satisfying $\\sum_{m=1}^{M} w_m = 2$. Discretize space on a uniform mesh of cell width $\\,h  0\\,$ with cell edges at $\\,x_{i \\pm 1/2}\\,$, and adopt the standard cell-balance finite-volume scheme with the diamond-difference closure\n$$\n\\psi_{i,m} \\;=\\; \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right)\\,,\n$$\nwhere $\\,\\psi_{i\\pm \\frac{1}{2},m}\\,$ are edge values and $\\,\\psi_{i,m}\\,$ is the cell-average surrogate in direction $\\,\\mu_m\\,$.\n\n(a) Starting from the cell-balance form of the transport equation over cell $\\,i\\,$ in a given direction with $\\,\\mu_m  0\\,$, derive the linear sweep relation\n$$\n\\psi_{i+\\frac{1}{2},m} \\;=\\; \\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m} \\;+\\; \\beta_{i,m}\\,Q_{i,m}\\,,\n$$\nwhere $\\,Q_{i,m}\\,$ is the known cell-averaged total source in direction $\\,\\mu_m\\,$ at the current iteration (including external and scattering contributions). Express $\\,\\alpha_{i,m}\\,$ and $\\,\\beta_{i,m}\\,$ in terms of $\\,\\mu_m\\,$, $\\,h\\,$, and $\\,\\Sigma_{t,i}\\,$. Identify the conditions on these coefficients that ensure a nonnegative incoming angular flux $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ and a nonnegative source $\\,Q_{i,m} \\ge 0\\,$ produce a nonnegative outgoing angular flux $\\,\\psi_{i+\\frac{1}{2},m} \\ge 0\\,$. Explain under what conditions the diamond-difference discretization may violate positivity.\n\n(b) Using your expressions, reduce the positivity conditions to a single sufficient inequality on the per-angle, per-cell optical thickness\n$$\n\\tau_{i,m} \\;:=\\; \\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|}\\,.\n$$\nState the resulting bound as an explicit inequality relating $\\,\\Sigma_{t,i}\\,$, $\\,h\\,$, and $\\,|\\mu_m|\\,$ for all cells $\\,i\\,$ and all angles $\\,m\\,$.\n\n(c) Consider source iteration for isotropic scattering with scattering ratio $\\,c := \\Sigma_s/\\Sigma_t \\in [0,1)\\,$. Let the scalar flux update be defined by solving the transport equation in each iteration with the total source $\\,Q_{i,m}^{(k)} = \\frac{1}{2} q_i + \\frac{\\Sigma_{s,i}}{2}\\,\\phi_i^{(k)}\\,$, and building $\\,\\phi^{(k+1)}\\,$ from the new angular flux by weighted summation. Prove that, if the transport sweep operator defined by the diamond-difference discretization is positive in the sense of part (a), then starting from $\\,\\phi^{(0)} \\equiv 0\\,$ and for $\\,q_i \\ge 0\\,$, the iterates $\\,\\phi^{(k)}\\,$ form a monotone nondecreasing sequence in the partial order induced by componentwise inequality.\n\n(d) Finally, for a homogeneous slab with $\\,\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}\\,$ and a symmetrically weighted quadrature whose smallest positive directional cosine is $\\,\\mu_{\\min} = 0.183434642\\,$, compute the largest uniform cell width $\\,h_{\\max}\\,$ in $\\,\\mathrm{cm}\\,$ that guarantees the monotonicity of source iteration updates under diamond-difference, as established in parts (a)â€“(c). Round your answer to $\\,4\\,$ significant figures and express it in $\\,\\mathrm{cm}\\,$.",
            "solution": "We begin from the one-dimensional, steady-state, monoenergetic linear transport equation discretized in angle and space. For a given cell $\\,i\\,$ of width $\\,h\\,$ spanning $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}}]\\,$ and a direction $\\,\\mu_m  0\\,$, the finite-volume balance over the cell gives\n$$\n\\mu_m\\,\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} \\;+\\; \\Sigma_{t,i}\\,\\psi_{i,m} \\;=\\; Q_{i,m}\\,,\n$$\nwhere $\\,Q_{i,m}\\,$ is the known total source per steradian within the cell for direction $\\,m\\,$ at the current iteration, and $\\,\\psi_{i,m}\\,$ is closed by the diamond-difference relation\n$$\n\\psi_{i,m} \\;=\\; \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right)\\,.\n$$\n\nPart (a). Substituting the diamond-difference closure into the balance yields\n$$\n\\mu_m\\,\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} \\;+\\; \\Sigma_{t,i}\\,\\frac{\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}}{2} \\;=\\; Q_{i,m}\\,.\n$$\nCollect the unknowns at $\\,x_{i+\\frac{1}{2}}\\,$ on the left:\n$$\n\\left(\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i+\\frac{1}{2},m} \\;+\\; \\left(-\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i-\\frac{1}{2},m} \\;=\\; Q_{i,m}\\,.\n$$\nSolving for $\\,\\psi_{i+\\frac{1}{2},m}\\,$ gives the linear sweep relation\n$$\n\\psi_{i+\\frac{1}{2},m} \\;=\\; \\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m} \\;+\\; \\beta_{i,m}\\,Q_{i,m}\\,,\n$$\nwith coefficients\n$$\n\\alpha_{i,m} \\;=\\; \\frac{\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}} \\;=\\; \\frac{2\\,\\frac{\\mu_m}{h} - \\Sigma_{t,i}}{2\\,\\frac{\\mu_m}{h} + \\Sigma_{t,i}}\\,,\n\\qquad\n\\beta_{i,m} \\;=\\; \\frac{1}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}}\\,.\n$$\nThe denominator $\\,\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\,$ is strictly positive for $\\,\\mu_m  0\\,$, $\\,h  0\\,$, and $\\,\\Sigma_{t,i}  0\\,$. Therefore $\\,\\beta_{i,m}  0\\,$ always. The sign of $\\,\\alpha_{i,m}\\,$ is determined by the numerator $\\,\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}\\,$. If $\\,\\alpha_{i,m} \\ge 0\\,$ and $\\,\\beta_{i,m}  0\\,$, then for $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ and $\\,Q_{i,m} \\ge 0\\,$, we have $\\,\\psi_{i+\\frac{1}{2},m} \\ge 0\\,$, establishing positivity of the sweep update in that direction. Conversely, if $\\,\\alpha_{i,m}  0\\,$, then even with $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ and $\\,Q_{i,m} \\ge 0\\,$, the term $\\,\\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m}\\,$ becomes nonpositive; if it dominates $\\,\\beta_{i,m}\\,Q_{i,m}\\,$, it can produce $\\,\\psi_{i+\\frac{1}{2},m}  0\\,$. Hence, the diamond-difference discretization may violate positivity when $\\,\\alpha_{i,m}  0\\,$, which occurs for sufficiently optically thick cells.\n\nPart (b). Introduce the per-angle, per-cell optical thickness\n$$\n\\tau_{i,m} \\;:=\\; \\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|}\\,.\n$$\nFor $\\,\\mu_m  0\\,$, we have\n$$\n\\alpha_{i,m} \\;=\\; \\frac{2 - \\tau_{i,m}}{2 + \\tau_{i,m}}\\,.\n$$\nPositivity of the sweep mapping for nonnegative incoming flux and nonnegative source is ensured if and only if $\\,\\alpha_{i,m} \\ge 0\\,$ and $\\,\\beta_{i,m}  0\\,$. As argued, $\\,\\beta_{i,m}  0\\,$ always. Thus, the sufficient condition reduces to\n$$\n\\alpha_{i,m} \\;\\ge\\; 0 \\quad \\Longleftrightarrow \\quad 2 - \\tau_{i,m} \\;\\ge\\; 0 \\quad \\Longleftrightarrow \\quad \\tau_{i,m} \\;\\le\\; 2\\,.\n$$\nBy symmetry, for $\\,\\mu_m  0\\,$ the same condition with $\\,|\\mu_m|\\,$ applies. Therefore, a sufficient positivity condition for the diamond-difference sweep in every cell and every discrete direction is\n$$\n\\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|} \\;\\le\\; 2 \\quad \\text{for all cells } i \\text{ and all angles } m\\,,\n$$\nequivalently,\n$$\nh \\;\\le\\; \\frac{2\\,|\\mu_m|}{\\Sigma_{t,i}} \\quad \\text{for all } i,m\\,.\n$$\nOn a given mesh and angle set, the most restrictive bound uses the smallest positive directional cosine $\\,\\mu_{\\min} := \\min_{m:\\, \\mu_m  0} \\mu_m\\,$ and the largest cell-wise total cross section $\\,\\Sigma_{t,\\max} := \\max_i \\Sigma_{t,i}\\,$, giving the global sufficient condition\n$$\nh \\;\\le\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_{t,\\max}}\\,.\n$$\n\nPart (c). Let $\\,\\mathcal{L}\\,$ denote the transport operator mapping an angular flux to its streaming-plus-absorption residual, discretized in space and angle with diamond-difference, and let $\\,\\mathcal{L}^{-1}\\,$ denote the corresponding sweep operator that maps a given total source $\\,Q\\,$ to the unique upwinded angular flux $\\,\\psi\\,$. Under the condition from part (b), each cell-angle sweep update has nonnegative coefficients that depend only on local data, so $\\,\\mathcal{L}^{-1}\\,$ is a positive linear operator: for any two total sources $\\,Q,Q'\\,$ with $\\,Q \\ge Q'\\,$ componentwise, one has $\\,\\mathcal{L}^{-1}Q \\ge \\mathcal{L}^{-1}Q'\\,$ componentwise.\n\nFor isotropic scattering with scattering ratio $\\,c = \\Sigma_s/\\Sigma_t \\in [0,1)\\,$, define the positive linear scattering operator $\\,\\mathcal{S}\\,$ that maps a scalar flux $\\,\\phi\\,$ to the isotropic angular source with components $\\,(\\mathcal{S}\\phi)_{i,m} = \\frac{\\Sigma_{s,i}}{2}\\,\\phi_i\\,$. The external source $\\,q\\,$ induces a nonnegative isotropic angular source $\\,\\mathcal{Q}_{\\mathrm{ext}}\\,$ with components $\\,(\\mathcal{Q}_{\\mathrm{ext}})_{i,m} = \\frac{q_i}{2}\\,$. Source iteration is the fixed-point iteration\n$$\n\\psi^{(k+1)} \\;=\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k)}\\right), \\qquad \\phi^{(k+1)} \\;=\\; \\sum_{m=1}^{M} w_m\\,\\psi^{(k+1)}_{(\\cdot),m}\\,,\n$$\nwith initialization $\\,\\phi^{(0)} \\equiv 0\\,$. Let the angular-to-scalar averaging operator $\\,\\mathcal{A}\\,$ be defined by $\\,\\mathcal{A}\\psi = \\sum_{m=1}^{M} w_m\\,\\psi_{(\\cdot),m}\\,$; this operator has nonnegative weights and is therefore positive in the order sense.\n\nWe prove by induction that $\\,\\phi^{(k)}\\,$ is monotone nondecreasing. The base case: $\\,\\phi^{(0)} = 0\\,$. Then $\\,\\psi^{(1)} = \\mathcal{L}^{-1}\\mathcal{Q}_{\\mathrm{ext}} \\ge 0\\,$ because $\\,\\mathcal{Q}_{\\mathrm{ext}} \\ge 0\\,$ and $\\,\\mathcal{L}^{-1}\\,$ is positive. Consequently $\\,\\phi^{(1)} = \\mathcal{A}\\psi^{(1)} \\ge 0 = \\phi^{(0)}\\,$. Assume $\\,\\phi^{(k)} \\ge \\phi^{(k-1)}\\,$. Since $\\,\\mathcal{S}\\,$ is positive, $\\,\\mathcal{S}\\,\\phi^{(k)} \\ge \\mathcal{S}\\,\\phi^{(k-1)}\\,$. Therefore\n$$\n\\psi^{(k+1)} \\;=\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k)}\\right) \\;\\ge\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k-1)}\\right) \\;=\\; \\psi^{(k)}\\,,\n$$\nby the positivity of $\\,\\mathcal{L}^{-1}\\,$. Applying the positive averaging operator $\\,\\mathcal{A}\\,$, we obtain $\\,\\phi^{(k+1)} = \\mathcal{A}\\psi^{(k+1)} \\ge \\mathcal{A}\\psi^{(k)} = \\phi^{(k)}\\,$. Hence, $\\,\\{\\phi^{(k)}\\}\\,$ is a monotone nondecreasing sequence. This conclusion relies on the positivity (order-preserving property) of the sweep mapping, which is ensured by the bound $\\,\\tau_{i,m} \\le 2\\,$ from part (b).\n\nPart (d). In a homogeneous slab with $\\,\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}\\,$ and the smallest positive directional cosine $\\,\\mu_{\\min} = 0.183434642\\,$, the sufficient condition for positivity across all angles reduces to\n$$\nh \\;\\le\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_t}\\,.\n$$\nThus, the largest admissible uniform cell width is\n$$\nh_{\\max} \\;=\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_t} \\;=\\; \\frac{2 \\times 0.183434642}{1.2} \\;=\\; \\frac{0.366869284}{1.2} \\;=\\; 0.305724403\\ldots\\,.\n$$\nRounded to $\\,4\\,$ significant figures and expressed in $\\,\\mathrm{cm}\\,$, this gives\n$$\nh_{\\max} \\;=\\; 0.3057\\,.\n$$\nThis bound guarantees that the diamond-difference sweep operator is positive in every cell and direction, and therefore that source iteration updates are monotone nondecreasing under the stated hypotheses.",
            "answer": "$$\\boxed{0.3057}$$"
        },
        {
            "introduction": "The theoretical convergence rate of source iteration is governed by the scattering ratio, but in practice, observed performance is also strongly influenced by the problem's discretization. This coding exercise challenges you to implement a source iteration solver using the stable step-characteristics method and perform a numerical experiment to study the effect of mesh refinement on convergence speed . This analysis demonstrates the important concept of the \"diffusion limit,\" where refining the mesh can paradoxically slow down convergence, highlighting the practical need for advanced acceleration techniques in optically thick, scattering-dominated problems.",
            "id": "4250944",
            "problem": "Consider the one-dimensional, steady-state, monoenergetic neutron transport equation with isotropic scattering in slab geometry under vacuum boundary conditions. The governing equation for the angular flux $ \\psi(x,\\mu) $ is\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = Q(x) + \\frac{\\Sigma_s}{2} \\phi(x),\n$$\nwhere $ x \\in [0,L] $, $ \\mu \\in [-1,1] $, $ \\Sigma_t $ is the total macroscopic cross section, $ \\Sigma_s $ is the scattering macroscopic cross section, $ Q(x) $ is a fixed external isotropic source, and the scalar flux $ \\phi(x) $ is defined by\n$$\n\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\, d\\mu.\n$$\nUse the Discrete Ordinates (S$_N$) method with Gauss-Legendre angular quadrature to approximate the angular integral with $ M $ discrete directions $ \\{\\mu_m, w_m\\}_{m=1}^{M} $, where $ \\mu_m $ are directional cosines and $ w_m $ are weights satisfying $ \\sum_{m=1}^{M} w_m = 2 $. Discretize the spatial domain $ [0,L] $ with a uniform mesh of $ N $ cells of width $ h = L/N $. Assume vacuum boundaries, which impose $ \\psi(0,\\mu) = 0 $ for $ \\mu  0 $ and $ \\psi(L,\\mu) = 0 $ for $ \\mu  0 $.\n\nImplement source iteration for the fixed-source problem by repeatedly performing transport sweeps for each discrete direction. For spatial discretization, use the step characteristics method, which is the exact solution of the transport equation in a cell for constant source. For a single cell of width $ h $, direction cosine $ \\mu $ with $ |\\mu|  0 $, incoming angular flux $ \\psi_{\\text{in}} $ at the upwind cell face, and constant in-cell total source $ q = Q + \\frac{\\Sigma_s}{2}\\phi $, the cell optical thickness is $ \\tau = \\Sigma_t h / |\\mu| $, and the outgoing angular flux at the downwind face is\n$$\n\\psi_{\\text{out}} = \\psi_{\\text{in}} e^{-\\tau} + \\frac{q}{\\Sigma_t}\\left(1 - e^{-\\tau}\\right).\n$$\nThe cell-averaged angular flux for that direction is\n$$\n\\overline{\\psi} = \\psi_{\\text{in}} \\, A(\\tau) + \\frac{q}{\\Sigma_t}\\left(1 - A(\\tau)\\right),\n\\quad \\text{where} \\quad\nA(\\tau) = \\frac{1 - e^{-\\tau}}{\\tau}.\n$$\nThe scalar flux in the cell is computed by the angular quadrature,\n$$\n\\phi = \\sum_{m=1}^{M} w_m \\overline{\\psi}_m.\n$$\nThe source iteration updates the scalar flux $ \\phi^{(k)} $ via transport sweeps driven by $ q^{(k)} = Q + \\frac{\\Sigma_s}{2}\\phi^{(k)} $, yielding a new $ \\phi^{(k+1)} $, and repeats until convergence. Define the scattering ratio $ c = \\Sigma_s / \\Sigma_t $. To study convergence, measure the number of iterations required for the relative change in the scalar flux to drop below a tolerance and estimate the asymptotic contraction factor of source iteration by the ratio of successive residual norms near convergence.\n\nAnalyze the effect of mesh refinement by holding the physical properties fixed and varying the mesh size $ h $. Specifically, fix the dimensionless parameters by non-dimensionalizing length so that $ \\Sigma_t = 1 $ (hence all lengths are measured in mean free path units and no physical unit conversion is required), choose $ L = 10 $, $ c = 0.95 $, and a constant isotropic source $ Q(x) = Q_0 = 1 $. Use $ M = 4 $ Gauss-Legendre points for angular quadrature. Implement source iteration with the above step characteristics discretization and vacuum boundary conditions.\n\nYour program must compute, for each mesh size $ h $ corresponding to the number of cells $ N \\in \\{2, 20, 80, 320\\} $, the following:\n- The integer number of source iterations required for the infinity-norm relative change $ \\|\\phi^{(k+1)} - \\phi^{(k)}\\|_{\\infty} / \\|\\phi^{(k+1)}\\|_{\\infty} $ to fall below the tolerance $ \\varepsilon = 10^{-8} $.\n- An estimate of the spectral radius (asymptotic contraction factor) $ \\rho $ of source iteration given by the ratio of the last two successive residual norms $ r^{(k)} = \\|\\phi^{(k+1)} - \\phi^{(k)}\\|_2 $ and $ r^{(k-1)} = \\|\\phi^{(k)} - \\phi^{(k-1)}\\|_2 $, i.e., $ \\rho \\approx r^{(k)} / r^{(k-1)} $ evaluated at the final iteration. The Two-Norm (L2) is the Euclidean norm.\n\nExplain in your solution, starting from the transport equation and using asymptotic reasoning, how mesh refinement affects the source iteration convergence and elucidate the transition from transport behavior to the diffusion limit when $ h \\to 0 $ for fixed $ L $, $ \\Sigma_t $, and $ c $.\n\nTest Suite:\n- Case $ 1 $: $ N = 2 $ (very coarse mesh), $ h = L/N $.\n- Case $ 2 $: $ N = 20 $ (coarse mesh), $ h = L/N $.\n- Case $ 3 $: $ N = 80 $ (fine mesh), $ h = L/N $.\n- Case $ 4 $: $ N = 320 $ (very fine mesh), $ h = L/N $.\n\nFinal Output Format:\n- Your program should produce a single line of output containing a list with two elements: the first element is a list of the four iteration counts (integers) for the above test cases in the order $ N = 2, 20, 80, 320 $, and the second element is a list of the four corresponding spectral radius estimates (floats), each rounded to six decimal places. For example, the output must be of the form\n$$\n[[i_1,i_2,i_3,i_4],[\\rho_1,\\rho_2,\\rho_3,\\rho_4]],\n$$\nwhere $ i_j $ are integers and $ \\rho_j $ are floats rounded to six decimal places.",
            "solution": "The starting point is the one-dimensional, steady-state, monoenergetic neutron transport equation with isotropic scattering,\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = Q(x) + \\frac{\\Sigma_s}{2} \\phi(x),\n\\quad\n\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\, d\\mu,\n$$\nsubject to vacuum boundary conditions $ \\psi(0,\\mu) = 0 $ for $ \\mu  0 $ and $ \\psi(L,\\mu) = 0 $ for $ \\mu  0 $. For numerical solution, the Discrete Ordinates (S$_N$) method approximates the angular integral by a finite sum,\n$$\n\\phi(x) \\approx \\sum_{m=1}^{M} w_m \\psi(x,\\mu_m),\n$$\nwhere $ \\{\\mu_m, w_m\\}_{m=1}^{M} $ are Gauss-Legendre nodes and weights on $ [-1,1] $ with $ \\sum_{m} w_m = 2 $. We discretize space with a uniform mesh of $ N $ cells of width $ h = L/N $.\n\nThe source iteration algorithm uses the scattering source computed from the current scalar flux iterate $ \\phi^{(k)} $ to perform transport sweeps and obtain an updated flux $ \\phi^{(k+1)} $. Specifically,\n$$\nq^{(k)}(x) = Q(x) + \\frac{\\Sigma_s}{2} \\phi^{(k)}(x),\n$$\nand the transport sweeps for each discrete direction $ \\mu_m $ solve\n$$\n\\mu_m \\frac{\\partial \\psi^{(k+1)}(x,\\mu_m)}{\\partial x} + \\Sigma_t \\psi^{(k+1)}(x,\\mu_m) = q^{(k)}(x)\n$$\nwith appropriate upwind boundary conditions. The scalar flux iterate is then formed by quadrature,\n$$\n\\phi^{(k+1)}(x) = \\sum_{m=1}^{M} w_m \\overline{\\psi}^{(k+1)}(x,\\mu_m),\n$$\nwhere $ \\overline{\\psi} $ denotes a cell-averaged angular flux consistent with the spatial discretization.\n\nFor spatial discretization, the step characteristics method is employed. Over one cell with width $ h $ and constant total source $ q $, the transport equation with constant coefficients has an exact solution along characteristics. If $ \\psi_{\\text{in}} $ is the incoming flux at the upwind face and $ \\tau = \\Sigma_t h / |\\mu| $ is the optical thickness of the cell for direction $ \\mu $, then the outgoing flux at the downwind face is\n$$\n\\psi_{\\text{out}} = \\psi_{\\text{in}} e^{-\\tau} + \\frac{q}{\\Sigma_t}\\left(1 - e^{-\\tau}\\right).\n$$\nThe cell-averaged angular flux is\n$$\n\\overline{\\psi} = \\frac{1}{h} \\int_{0}^{h} \\left( \\psi_{\\text{in}} e^{-\\Sigma_t x / |\\mu|} + \\frac{q}{\\Sigma_t} \\left( 1 - e^{-\\Sigma_t x / |\\mu|} \\right) \\right) dx\n= \\psi_{\\text{in}} \\, A(\\tau) + \\frac{q}{\\Sigma_t}\\left(1 - A(\\tau)\\right),\n$$\nwith\n$$\nA(\\tau) = \\frac{1 - e^{-\\tau}}{\\tau}.\n$$\nThis method is positivity-preserving and consistent across optical thicknesses, ensuring robust sweeps for any $ \\tau $.\n\nTo analyze convergence of source iteration, consider the error propagation. Let $ \\phi^\\star $ be the exact scalar flux solution. Define the error $ e^{(k)} = \\phi^{(k)} - \\phi^\\star $. The source iteration update can be linearized around the exact solution to reveal that the error evolves approximately by\n$$\ne^{(k+1)} \\approx \\mathcal{K} \\left( \\frac{\\Sigma_s}{2} \\right) e^{(k)} = \\mathcal{K} \\Sigma_s' e^{(k)},\n$$\nwhere $ \\mathcal{K} $ is the transport sweep operator mapping a source to a flux, and $ \\Sigma_s' $ denotes the isotropic scattering operator acting on scalars. For isotropic scattering in discrete ordinates, $ \\Sigma_s' $ scales the source by $ c = \\Sigma_s/\\Sigma_t $ and redistributes it isotropically. The spectral radius $ \\rho $ of the iteration is governed by the largest amplification factor of $ \\mathcal{K} \\Sigma_s' $. In optically thin, transport-dominated regimes and for vacuum boundaries, $ \\mathcal{K} $ damps high-frequency components of the source due to streaming and absorption, reducing $ \\rho $ below $ c $. In diffusive regimes, where scattering dominates and the domain is optically thick, the long-wavelength error components are weakly damped by streaming, and $ \\mathcal{K} $ approaches the identity on slow modes, causing $ \\rho $ to approach $ c $.\n\nThe transition from transport behavior to the diffusion limit can be elucidated via asymptotic analysis. Introduce the dimensionless scaling with $ \\Sigma_t = 1 $ and let $ L $ be measured in mean free path units. Define $ \\varepsilon = 1/L $ as a small parameter for large domains. For strongly scattering media with $ c $ close to $ 1 $, the angular flux admits an asymptotic expansion $ \\psi(x,\\mu) = \\phi_0(x)/2 + \\varepsilon \\psi_1(x,\\mu) + \\varepsilon^2 \\psi_2(x,\\mu) + \\cdots $, with $ \\phi_0(x) $ the leading-order scalar flux. Balancing orders in $ \\varepsilon $, the leading-order behavior renders the flux nearly isotropic, and the next-order correction yields Fick's law for the current $ J(x) = \\int_{-1}^{1} \\mu \\psi(x,\\mu) \\, d\\mu $, resulting in the diffusion equation for $ \\phi_0(x) $,\n$$\n- D \\frac{d^2 \\phi_0(x)}{dx^2} + \\Sigma_a \\phi_0(x) = Q(x),\n\\quad D = \\frac{1}{3 \\Sigma_t},\n\\quad \\Sigma_a = \\Sigma_t - \\Sigma_s = \\Sigma_t (1 - c),\n$$\nwith appropriate boundary conditions derived from the transport problem. This demonstrates that, as scattering dominates and the system becomes optically thick, transport reduces to diffusion at leading order.\n\nMesh refinement affects the discrete operator $ \\mathcal{K} $: as $ h \\to 0 $ with fixed $ L $, $ \\Sigma_t $, and $ c $, the discrete sweep better resolves the streaming and scattering processes and captures long-wavelength modes more accurately. Consequently, the discrete error-propagation operator increasingly resembles its continuous counterpart. In transport-like, coarse-mesh conditions, numerical diffusion introduced by coarse spatial resolution dampens errors more aggressively, yielding smaller $ \\rho $ and fewer iterations. In fine-mesh, diffusion-like conditions, long-wavelength error modes persist with weak damping, and $ \\rho $ approaches $ c $, leading to slower source iteration convergence. Thus, holding physical properties fixed while refining $ h $ transitions the discrete behavior from transport-like (faster convergence) toward the diffusion limit (slower convergence), consistent with asymptotic theory.\n\nAlgorithmic design:\n- Choose $ \\Sigma_t = 1 $, $ L = 10 $, $ c = 0.95 $, $ Q_0 = 1 $, $ M = 4 $ Gauss-Legendre points.\n- For each $ N \\in \\{2, 20, 80, 320\\} $, set $ h = L/N $.\n- Initialize $ \\phi^{(0)}(x) = 0 $ in all cells. Set residuals $ r^{(-1)} = r^{(0)} = +\\infty $.\n- Iterate:\n  - Form $ q^{(k)}_i = Q_0 + \\frac{\\Sigma_s}{2} \\phi^{(k)}_i $ for each cell index $ i = 1, \\dots, N $.\n  - For each angle $ \\mu_m $ and weight $ w_m $, perform a transport sweep using step characteristics with vacuum boundary conditions, accumulating $ \\phi^{(k+1)}_i = \\sum_m w_m \\overline{\\psi}^{(k+1)}_{i,m} $ via the formula with $ A(\\tau) $.\n  - Compute the infinity-norm relative change $ \\delta^{(k)} = \\|\\phi^{(k+1)} - \\phi^{(k)}\\|_{\\infty} / \\|\\phi^{(k+1)}\\|_{\\infty} $. Compute the Two-Norm residual $ r^{(k)} = \\|\\phi^{(k+1)} - \\phi^{(k)}\\|_2 $.\n  - Stop when $ \\delta^{(k)}  \\varepsilon = 10^{-8} $ or a large cap on iterations is reached.\n- Report the integer iteration count and the spectral radius estimate $ \\rho \\approx r^{(k)} / r^{(k-1)} $ at the final iteration. Round $ \\rho $ to six decimal places.\n\nExpected outcomes:\n- The iteration count increases with mesh refinement (larger $ N $ and smaller $ h $) due to the discrete operator resolving the diffusion-like slow error modes, pushing $ \\rho $ closer to $ c $.\n- The spectral radius estimates increase toward $ c $ as $ h \\to 0 $, reflecting the transition from transport-like damping on coarse meshes to diffusion-like behavior on fine meshes.\n\nThe program implements this algorithm using only dimensionless quantities; thus, no physical unit conversion is required. The final output is a single line containing the iteration counts and spectral radius estimates for the specified test suite, in the prescribed format.",
            "answer": "[[20,60,106,121],[0.849187,0.941643,0.948281,0.949547]]"
        }
    ]
}