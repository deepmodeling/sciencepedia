{
    "hands_on_practices": [
        {
            "introduction": "理解中子如何与慢化剂材料进行能量交换是反应堆物理学的核心。第一个动手实践练习  将引导你从第一性原理出发，推导热散射律 $S(\\alpha, \\beta)$ 的一个关键性质——细致平衡原理。通过从经典力学和统计物理学入手，你将揭示连接中子能量增益和能量损失的基本关系，这是所有热散射模型的基石。",
            "id": "4258831",
            "problem": "单原子慢化剂被建模为由独立点散射体组成的经典理想气体（自由气体模型）。中子散射在质心系中是弹性的，散射体的速度在温度 $T$ 下遵循麦克斯韦-玻尔兹曼分布。散射定律 $S(\\alpha,\\beta)$ 通过通常的无量纲运动学变量定义：\n$$\n\\alpha \\equiv \\frac{E + E' - 2 \\mu \\sqrt{E E'}}{A k_{B} T}, \n\\qquad \n\\beta \\equiv \\frac{E' - E}{k_{B} T},\n$$\n其中 $E$ 和 $E'$ 分别是入射和出射中子的能量， $A$ 是散射体质量与中子质量之比，$\\mu$ 是实验室散射角的余弦，$k_{B}$ 是玻尔兹曼常数。\n\n仅从以下三点出发：\n- 牛顿两体弹性散射运动学，\n- 温度 $T$ 下散射体的麦克斯韦-玻尔兹曼速度分布，以及\n- 热平衡下的微观可逆性，\n\n推导自由气体模型的细致平衡关系，该关系连接 $S(\\alpha,\\beta)$ 和 $S(\\alpha,-\\beta)$。然后，使用您推导的关系，计算当能量为 $E=0.040\\ \\text{eV}$ 的中子散射到 $E'=0.020\\ \\text{eV}$ 时，在温度 $T=600\\ \\text{K}$ 下的氢慢化剂（因此 $A=1$）的 $S(\\alpha,\\beta)/S(\\alpha,-\\beta)$ 之比。您可以将余弦 $\\mu$ 视为任意值，并可以假设玻尔兹曼常数为 $k_{B} = 8.617333262 \\times 10^{-5}\\ \\text{eV/K}$。\n\n将该比值报告为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题要求做两件事：首先，为热散射定律 $S(\\alpha, \\beta)$ 推导细致平衡关系；其次，利用此关系计算特定中子散射事件的 $S(\\alpha, \\beta)/S(\\alpha, -\\beta)$ 之比。\n\n推导必须基于三个原理：牛顿运动学、散射体的麦克斯韦-玻尔兹曼速度分布以及热平衡下的微观可逆性原理。\n\n我们从推导细致平衡关系开始。微观可逆性原理应用于热平衡系统时，意味着任何过程的速率都等于其逆过程的速率。考虑中子从初始能量 $E$ 散射到最终能量 $E'$ 的过程，以及从 $E'$ 散射到 $E$ 的逆过程。\n\n从初始态到最终态的跃迁速率与初始态的布居数和跃迁概率成正比。在温度 $T$ 的热平衡状态下，中子通量 $\\phi(E)$ 遵循麦克斯韦分布，对于能量 $E$，其正比于 $E \\exp(-E / (k_B T))$。跃迁概率与双微分散射截面 $\\frac{d^2\\sigma}{dE'd\\Omega}(E \\to E', \\mu)$ 成正比。\n\n因此，通过将从 $E$ 散射到 $E'$ 的速率与从 $E'$ 散射到 $E$ 的速率相等，可以写出细致平衡条件：\n$$\n\\phi(E) \\frac{d^2\\sigma}{dE'd\\Omega}(E \\to E', \\mu) = \\phi(E') \\frac{d^2\\sigma}{dE d\\Omega}(E' \\to E, \\mu)\n$$\n代入麦克斯韦通量的形式，我们得到：\n$$\nC E \\exp\\left(-\\frac{E}{k_B T}\\right) \\frac{d^2\\sigma}{dE'd\\Omega}(E \\to E', \\mu) = C E' \\exp\\left(-\\frac{E'}{k_B T}\\right) \\frac{d^2\\sigma}{dE d\\Omega}(E' \\to E, \\mu)\n$$\n其中 $C$ 是一个比例常数。\n\n散射定律 $S(\\alpha, \\beta)$ 通过其与双微分截面的关系定义：\n$$\n\\frac{d^2\\sigma}{dE'd\\Omega}(E \\to E', \\mu) = \\frac{\\sigma_b}{4\\pi k_B T} \\sqrt{\\frac{E'}{E}} S(\\alpha, \\beta)\n$$\n其中 $\\sigma_b$ 是束缚散射截面。具体的归一化常数不影响最终的关系式。\n\n对于逆过程，即中子从能量 $E'$ 散射到 $E$，初始能量和最终能量的角色互换。逆过程的无量纲变量 $\\alpha$ 和 $\\beta$，记为 $\\alpha_{rev}$ 和 $\\beta_{rev}$，是：\n$$\n\\beta_{rev} = \\frac{E - E'}{k_B T} = -\\beta\n$$\n$$\n\\alpha_{rev} = \\frac{E' + E - 2 \\mu \\sqrt{E' E}}{A k_{B} T} = \\alpha\n$$\n变量 $\\alpha$ 对于 $E$ 和 $E'$ 的交换是对称的，而 $\\beta$ 是反对称的。因此，逆过程由散射定律 $S(\\alpha, -\\beta)$ 描述。逆过程的截面是：\n$$\n\\frac{d^2\\sigma}{dE d\\Omega}(E' \\to E, \\mu) = \\frac{\\sigma_b}{4\\pi k_B T} \\sqrt{\\frac{E}{E'}} S(\\alpha, -\\beta)\n$$\n\n现在，我们将这些截面表达式代入细致平衡方程：\n$$\nE \\exp\\left(-\\frac{E}{k_B T}\\right) \\left[ \\frac{\\sigma_b}{4\\pi k_B T} \\sqrt{\\frac{E'}{E}} S(\\alpha, \\beta) \\right] = E' \\exp\\left(-\\frac{E'}{k_B T}\\right) \\left[ \\frac{\\sigma_b}{4\\pi k_B T} \\sqrt{\\frac{E}{E'}} S(\\alpha, -\\beta) \\right]\n$$\n等式两边的常数项 $\\frac{\\sigma_b}{4\\pi k_B T}$ 可以消去：\n$$\nE \\exp\\left(-\\frac{E}{k_B T}\\right) \\sqrt{\\frac{E'}{E}} S(\\alpha, \\beta) = E' \\exp\\left(-\\frac{E'}{k_B T}\\right) \\sqrt{\\frac{E}{E'}} S(\\alpha, -\\beta)\n$$\n简化能量项：\n$$\n\\sqrt{E} \\sqrt{E'} \\exp\\left(-\\frac{E}{k_B T}\\right) S(\\alpha, \\beta) = \\sqrt{E'} \\sqrt{E} \\exp\\left(-\\frac{E'}{k_B T}\\right) S(\\alpha, -\\beta)\n$$\n等式两边的 $\\sqrt{EE'}$ 项可以消去，剩下：\n$$\n\\exp\\left(-\\frac{E}{k_B T}\\right) S(\\alpha, \\beta) = \\exp\\left(-\\frac{E'}{k_B T}\\right) S(\\alpha, -\\beta)\n$$\n求解 $S(\\alpha, \\beta)$，我们得到细致平衡关系：\n$$\nS(\\alpha, \\beta) = \\frac{\\exp\\left(-\\frac{E'}{k_B T}\\right)}{\\exp\\left(-\\frac{E}{k_B T}\\right)} S(\\alpha, -\\beta) = \\exp\\left(\\frac{E - E'}{k_B T}\\right) S(\\alpha, -\\beta)\n$$\n回想定义 $\\beta = \\frac{E' - E}{k_B T}$，我们有 $\\frac{E - E'}{k_B T} = -\\beta$。因此，该关系式为：\n$$\nS(\\alpha, \\beta) = \\exp(-\\beta) S(\\alpha, -\\beta)\n$$\n这个关系是热平衡的一个基本推论，对任何散射系统都成立，包括自由气体模型。\n\n接下来，我们需要根据给定条件计算 $S(\\alpha,\\beta)/S(\\alpha,-\\beta)$ 的比值。根据推导出的关系，这个比值就是：\n$$\n\\frac{S(\\alpha, \\beta)}{S(\\alpha, -\\beta)} = \\exp(-\\beta)\n$$\n我们需要使用所提供的数据计算 $\\beta$ 的值：\n入射中子能量, $E = 0.040\\ \\text{eV}$。\n出射中子能量, $E' = 0.020\\ \\text{eV}$。\n慢化剂温度, $T = 600\\ \\text{K}$。\n玻尔兹曼常数, $k_B = 8.617333262 \\times 10^{-5}\\ \\text{eV/K}$。\n\n无量纲能量转移 $\\beta$ 为：\n$$\n\\beta = \\frac{E' - E}{k_B T} = \\frac{0.020\\ \\text{eV} - 0.040\\ \\text{eV}}{(8.617333262 \\times 10^{-5}\\ \\text{eV/K}) \\times (600\\ \\text{K})}\n$$\n首先，计算热能 $k_B T$：\n$$\nk_B T = (8.617333262 \\times 10^{-5}\\ \\text{eV/K}) \\times (600\\ \\text{K}) = 0.051703999572\\ \\text{eV}\n$$\n现在，计算 $\\beta$：\n$$\n\\beta = \\frac{-0.020\\ \\text{eV}}{0.051703999572\\ \\text{eV}} \\approx -0.38681026\n$$\n所要求的比值为 $\\exp(-\\beta)$：\n$$\n\\frac{S(\\alpha, \\beta)}{S(\\alpha, -\\beta)} = \\exp(-(-0.38681026)) = \\exp(0.38681026) \\approx 1.472258\n$$\n根据要求四舍五入到四位有效数字，比值为 $1.472$。此计算不需要 $A$ 和 $\\mu$ 的值，因为细致平衡原理关联的是不同能量的状态，而该比值仅取决于能量转移 $\\beta$。",
            "answer": "$$\\boxed{1.472}$$"
        },
        {
            "introduction": "上一个练习侧重于能量交换，而热散射律同样也支配着动量转移。本实践  探讨了在晶体材料中相干弹性散射（$\\beta=0$）的特殊情况。你将利用晶格结构施加的运动学约束，推导出布拉格散射的能量阈值，从而证明抽象的 $S(\\alpha, \\beta)$ 形式如何直接预测中子截面数据中可测量的特征——即布拉格边。",
            "id": "4258835",
            "problem": "在基于散射律 $S(\\alpha,\\beta)$ 的热散射处理中，入射波数为 $k$、散射波数为 $k'$ 的中子的双微分散射截面与 $S(\\alpha,\\beta)$ 成正比，其中 $\\alpha$ 是动量转移的无量纲度量，$\\beta$ 是能量转移的无量纲度量。对于在足够低的温度下（此时德拜-瓦勒因子可以忽略不计）来自完美晶体的相干弹性散射，能量转移实际上为零（即 $\\beta = 0$），并且只有当动量转移 $\\mathbf{Q}=\\mathbf{k}-\\mathbf{k}'$ 等于一个倒格子矢量 $\\mathbf{G}$ 时，才会出现非零强度。\n\n考虑一个多晶体（随机取向的）石墨慢化剂，并关注晶面间距为 $d$ 的晶面族。对 $S(\\alpha,\\beta)$ 的相干弹性贡献仅在 $|\\mathbf{Q}| = |\\mathbf{G}|$ 时非零，其中 $|\\mathbf{G}| = 2\\pi/d$。由于多晶体涵盖了所有取向，弹性散射中可及的最大动量转移为 $|\\mathbf{Q}|_{\\max} = 2k$。每当一组新的晶面在运动学上变得可及时（即当 $|\\mathbf{G}| = 2k$ 时），能量依赖的截面中就会出现一个布拉格边。仅使用非相对论中子的基本运动学和从 $S(\\alpha,\\beta)$ 结构中导出的上述运动学可及性准则，推导对于给定的 $d$，出现第一个布拉格边时的阈值（边）中子动能 $E_{\\text{edge}}$ 的表达式。然后，计算石墨基面（间距 $d = 3.35\\,\\text{\\AA}$）的 $E_{\\text{edge}}$。\n\n使用德布罗意关系和中子的非相对论动能。提供以下常数：普朗克常数 $h = 6.62607015 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$，中子质量 $m_{n} = 1.674927498 \\times 10^{-27}\\,\\text{kg}$，以及 $1\\,\\text{eV} = 1.602176634 \\times 10^{-19}\\,\\text{J}$。取 $1\\,\\text{\\AA} = 10^{-10}\\,\\text{m}$。用毫电子伏特（meV）表示最终数值答案，并四舍五入到四位有效数字。",
            "solution": "**解题步骤**\n\n本问题要求推导并计算多晶石墨中中子的第一个布拉格边能量。\n\n**符号推导**\n\n推导首先将非相对论中子的动能与其波数联系起来。质量为 $m_n$、动量为 $p$ 的中子的动能 $E$ 由下式给出：\n$$\nE = \\frac{p^2}{2m_n}\n$$\n根据德布罗意关系，粒子的动量 $p$ 与其波长 $\\lambda$ 的关系为 $p = h/\\lambda$，其中 $h$ 是普朗克常数。波数 $k$ 定义为 $k = 2\\pi/\\lambda$。我们可以通过引入约化普朗克常数 $\\hbar = h/(2\\pi)$，用波数来表示动量：\n$$\np = \\frac{h}{2\\pi/k} = \\frac{h}{2\\pi} k = \\hbar k\n$$\n将此动量表达式代入能量方程，得到中子动能与其波数之间的关系：\n$$\nE = \\frac{(\\hbar k)^2}{2m_n} = \\frac{\\hbar^2 k^2}{2m_n}\n$$\n问题指出，当首次满足从一个新的晶面族散射的运动学条件时，会出现布拉格边。对于弹性散射（$|\\mathbf{k}| = |\\mathbf{k}'| = k$），动量转移矢量 $\\mathbf{Q}$ 的大小为 $|\\mathbf{Q}| = 2k \\sin(\\theta/2)$，其中 $\\theta$ 是散射角。最大可能动量转移 $|\\mathbf{Q}|_{\\max}$ 发生在最大散射角 $\\theta = \\pi$（背向散射）时，这给出 $|\\mathbf{Q}|_{\\max} = 2k$。\n\n只有当动量转移的大小满足布拉格条件时，才可能发生来自特定晶面族的衍射。在多晶体中，这简化为只有当 $|\\mathbf{Q}| = |\\mathbf{G}|$ 时，才可能发生来自具有倒格子矢量 $\\mathbf{G}$ 的一组晶面的散射。因此，要使任何散射从这组晶面发生，必须在运动学上能够实现大小为 $|\\mathbf{G}|$ 的动量转移。这要求最大可能动量转移至少与 $|\\mathbf{G}|$ 一样大，即 $2k \\ge |\\mathbf{G}|$。阈值（或“边”）条件对应于此条件首次被满足的最低能量（因此是最低的 $k$），即等式成立时：\n$$\n2k_{\\text{edge}} = |\\mathbf{G}|\n$$\n这里，$k_{\\text{edge}}$ 是阈值处的中子波数。问题给出了晶面间距为 $d$ 的晶面族的倒格子矢量的大小为：\n$$\n|\\mathbf{G}| = \\frac{2\\pi}{d}\n$$\n将两个表达式相等，得到：\n$$\n2k_{\\text{edge}} = \\frac{2\\pi}{d} \\implies k_{\\text{edge}} = \\frac{\\pi}{d}\n$$\n阈值能量 $E_{\\text{edge}}$ 是对应于该波数的动能。将 $k_{\\text{edge}}$ 代入能量-波数关系式中：\n$$\nE_{\\text{edge}} = \\frac{\\hbar^2 k_{\\text{edge}}^2}{2m_n} = \\frac{\\hbar^2}{2m_n} \\left(\\frac{\\pi}{d}\\right)^2 = \\frac{\\hbar^2 \\pi^2}{2m_n d^2}\n$$\n为了用普朗克常数 $h$ 表示，我们代入 $\\hbar = h/(2\\pi)$：\n$$\nE_{\\text{edge}} = \\frac{(h/2\\pi)^2 \\pi^2}{2m_n d^2} = \\frac{h^2/(4\\pi^2) \\cdot \\pi^2}{2m_n d^2} = \\frac{h^2}{8m_n d^2}\n$$\n这就是布拉格边能量的最终符号表达式。\n\n**数值计算**\n\n我们被要求计算石墨基面的 $E_{\\text{edge}}$，其中 $d = 3.35\\,\\text{\\AA}$。我们使用提供的常数，并将所有单位转换为国际单位制（SI）基本单位：\n- $h = 6.62607015 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$\n- $m_{n} = 1.674927498 \\times 10^{-27}\\,\\text{kg}$\n- $d = 3.35\\,\\text{\\AA} = 3.35 \\times 10^{-10}\\,\\text{m}$\n\n将这些值代入推导出的 $E_{\\text{edge}}$ 表达式中：\n$$\nE_{\\text{edge}} = \\frac{(6.62607015 \\times 10^{-34})^2}{8 \\times (1.674927498 \\times 10^{-27}) \\times (3.35 \\times 10^{-10})^2} \\,\\text{J}\n$$\n$$\nE_{\\text{edge}} \\approx \\frac{4.3904855 \\times 10^{-67}}{1.50374185 \\times 10^{-45}} \\,\\text{J} \\approx 2.919717 \\times 10^{-22}\\,\\text{J}\n$$\n问题要求答案以毫电子伏特（meV）为单位。我们使用转换因子 $1\\,\\text{eV} = 1.602176634 \\times 10^{-19}\\,\\text{J}$。\n$$\nE_{\\text{edge}} (\\text{eV}) = \\frac{2.919717 \\times 10^{-22}\\,\\text{J}}{1.602176634 \\times 10^{-19}\\,\\text{J/eV}} \\approx 0.00182236\\,\\text{eV}\n$$\n$$\nE_{\\text{edge}} (\\text{meV}) = 0.00182236\\,\\text{eV} \\times 1000\\,\\frac{\\text{meV}}{\\text{eV}} \\approx 1.82236\\,\\text{meV}\n$$\n最后，按要求将结果四舍五入到四位有效数字：\n$$\nE_{\\text{edge}} \\approx 1.822\\,\\text{meV}\n$$",
            "answer": "$$\n\\boxed{1.822}\n$$"
        },
        {
            "introduction": "散射律的理论原理必须转化为可供反应堆模拟程序使用的格式。最后一个实践  模拟了核数据处理的一项核心任务，仿真了像NJOY的THERMR模块这样的程序是如何处理 $S(\\alpha, \\beta)$ 数据的。你将处理一个“原始的”、物理上不一致的数据表，通过对称化操作来强制执行细致平衡原理，然后使用修正后的数据计算双微分截面，从而完成从物理定律到实际计算的全过程。",
            "id": "4258837",
            "problem": "您的任务是实现一个小型、独立的处理器，用于模拟评估核数据文件（ENDF）处理流程中针对热散射定律（TSL）所使用的核心步骤，这些步骤通常由NJOY代码的热散射模块（THERMR）执行。您的程序必须使用以 $S(\\alpha,\\beta)$ 表示的热散射定律，计算中子与束缚态慢化剂原子发生散射事件的双微分束缚散射截面。独立的无量纲变量是动量转移参数 $\\alpha$ 和能量转移参数 $\\beta$。\n\n基本依据如下：\n- 热散射的中子散射运动学，用 $\\alpha$ 和 $\\beta$、靶核与中子质量比 $A$、入射中子能量 $E$、出射能量 $E'$、散射余弦 $\\mu$ 以及温度 $T$ 来表示。\n- 热散射定律的细致平衡关系：$S(\\alpha,\\beta) = \\exp(-\\beta)\\,S(\\alpha,-\\beta)$。\n- 使用热散射定律表示的非相干散射的双微分束缚散射截面公式为：\n$$\n\\frac{\\mathrm{d}^2 \\sigma}{\\mathrm{d} E' \\mathrm{d} \\Omega} \\;=\\; \\frac{\\sigma_b}{4\\pi\\, k_B T}\\,\\sqrt{\\frac{E'}{E}}\\,S(\\alpha,\\beta),\n$$\n其中 $\\sigma_b$ 是束缚散射截面。\n\n您必须实现以下步骤：\n1.  在网格上构建一个人工的 $S(\\alpha,\\beta)$ 数据集，定义网格如下：\n    - $\\alpha$ 网格: $[0.0, 0.5, 1.0, 2.0, 4.0]$\n    - $\\beta$ 网格: $[-4.0, -2.0, -1.0, 0.0, 1.0, 2.0, 4.0]$\n    在此网格上，通过以下公式定义一个原始、非平衡的表格 $S_{\\mathrm{raw}}(\\alpha_i,\\beta_j)$：\n    $$\n    S_{\\mathrm{raw}}(\\alpha,\\beta) \\;=\\; \\exp(-\\alpha)\\,\\exp\\!\\left(-\\frac{\\beta^2}{1+\\alpha}\\right)\\,\\left(1 + 0.05\\,\\beta\\right)\n    $$\n    该公式通过因子 $\\left(1+0.05\\,\\beta\\right)$ 故意违反了细致平衡。\n2.  模拟 THERMR 模块强制执行细致平衡的处理步骤。通过对正负 $\\beta$ 值进行成对对称化，构建一个平衡表格 $S_{\\mathrm{bal}}(\\alpha,\\beta)$，使其精确满足 $S_{\\mathrm{bal}}(\\alpha,\\beta) = \\exp(-\\beta)\\,S_{\\mathrm{bal}}(\\alpha,-\\beta)$。对于每对 $\\pm \\beta$（其中 $\\beta0$），定义：\n    $$\n    S_{\\mathrm{bal}}(\\alpha,+\\beta) \\;=\\; \\frac{1}{2}\\left[S_{\\mathrm{raw}}(\\alpha,+\\beta) \\;+\\; e^{-\\beta} S_{\\mathrm{raw}}(\\alpha,-\\beta)\\right],\n    $$\n    $$\n    S_{\\mathrm{bal}}(\\alpha,-\\beta) \\;=\\; \\frac{1}{2}\\left[S_{\\mathrm{raw}}(\\alpha,-\\beta) \\;+\\; e^{+\\beta} S_{\\mathrm{raw}}(\\alpha,+\\beta)\\right],\n    $$\n    并在 $\\beta=0$ 时，设置 $S_{\\mathrm{bal}}(\\alpha,0)=S_{\\mathrm{raw}}(\\alpha,0)$。\n3.  使用平衡表格 $S_{\\mathrm{bal}}(\\alpha,\\beta)$ 和线性-线性插值，在二维 $(\\alpha,\\beta)$ 空间中实现双线性插值。如果查询点 $(\\alpha,\\beta)$ 位于给定网格的凸包之外，则在插值前将每个坐标独立地钳位到最近的端点（不进行外推）。\n4.  对于每个散射情况，使用以下公式计算 $\\alpha$ 和 $\\beta$：\n    $$\n    \\alpha \\;=\\; \\frac{E' + E \\;-\\; 2\\,\\sqrt{E E'}\\,\\mu}{A\\,k_B T}, \\qquad \\beta \\;=\\; \\frac{E' - E}{k_B T}\n    $$\n5.  使用插值得到的 $S(\\alpha,\\beta)$，计算双微分散射截面，单位为 $\\text{barn}/\\text{eV}/\\text{sr}$。\n\n物理单位和常数：\n- $k_B = 8.617333262\\times 10^{-5}\\,\\text{eV/K}$。\n- $\\sigma_b$ 单位为 barn。\n\n测试用例：\n计算以下四种情况的双微分散射截面：\n- 情况 1：$E = 0.0253$, $E' = 0.0100$, $\\mu = 0.3$, $A = 1.0$, $T = 293.6$, $\\sigma_b = 80.27$。\n- 情况 2：$E = 0.0050$, $E' = 0.0200$, $\\mu = -0.5$, $A = 1.0$, $T = 293.6$, $\\sigma_b = 80.27$。\n- 情况 3：$E = 0.0253$, $E' = 0.0253$, $\\mu = 1.0$, $A = 1.0$, $T = 293.6$, $\\sigma_b = 80.27$。\n- 情况 4：$E = 0.0010$, $E' = 0.5000$, $\\mu = 0.0$, $A = 1.0$, $T = 293.6$, $\\sigma_b = 80.27$。\n\n您的程序必须输出单行内容，其中包含一个 Python 风格的列表，内含四个数值结果，每个结果均四舍五入到恰好 $6$ 位小数。",
            "solution": "**解题思路**\n\n该问题是在核反应堆物理领域定义明确的计算问题，具体涉及热中子散射数据的处理。其主要目标是基于热散射定律 $S(\\alpha, \\beta)$ 计算双微分束缚散射截面 $\\frac{\\mathrm{d}^2 \\sigma}{\\mathrm{d} E' \\mathrm{d} \\Omega}$。该过程模仿了像 NJOY 这样的核数据处理代码所执行的关键步骤。\n\n**步骤 1: 构建原始热散射定律表格 $S_{\\mathrm{raw}}(\\alpha, \\beta)$**\n\n第一步是在指定的离散网格上生成热散射定律的初始非对称化表示，记为 $S_{\\mathrm{raw}}(\\alpha, \\beta)$。$S_{\\mathrm{raw}}(\\alpha, \\beta)$ 在每个网格点 $(\\alpha_i, \\beta_j)$ 的值是使用提供的人工公式计算的：\n$$\nS_{\\mathrm{raw}}(\\alpha,\\beta) = \\exp(-\\alpha)\\,\\exp\\!\\left(-\\frac{\\beta^2}{1+\\alpha}\\right)\\,\\left(1 + 0.05\\,\\beta\\right)\n$$\n项 $(1 + 0.05\\,\\beta)$ 故意引入了一种不对称性，它违反了细致平衡的物理原理，这是数据处理代码必须纠正的一个常见问题。\n\n**步骤 2: 强制执行细致平衡原理**\n\n热散射定律的一个基本物理要求是细致平衡原理，它将上散射（$\\beta > 0$）的概率与下散射（$\\beta  0$）的概率联系起来：\n$$\nS(\\alpha, \\beta) = \\exp(-\\beta) \\, S(\\alpha, -\\beta)\n$$\n为了强制执行该条件，通过对称化过程构建了一个新的平衡表格 $S_{\\mathrm{bal}}(\\alpha, \\beta)$。对于每个 $\\alpha$ 值和每对正负 $\\beta$ 值（$\\pm\\beta$，其中 $\\beta > 0$），新值按加权平均计算：\n$$\nS_{\\mathrm{bal}}(\\alpha, +\\beta) = \\frac{1}{2}\\left[S_{\\mathrm{raw}}(\\alpha, +\\beta) + e^{-\\beta} S_{\\mathrm{raw}}(\\alpha, -\\beta)\\right]\n$$\n$$\nS_{\\mathrm{bal}}(\\alpha, -\\beta) = \\frac{1}{2}\\left[S_{\\mathrm{raw}}(\\alpha, -\\beta) + e^{+\\beta} S_{\\mathrm{raw}}(\\alpha, +\\beta)\\right]\n$$\n此过程保证了最终的 $S_{\\mathrm{bal}}(\\alpha, \\beta)$ 表格能正确满足细致平衡关系。对于 $\\beta=0$ 的特殊情况，其值保持不变：$S_{\\mathrm{bal}}(\\alpha, 0) = S_{\\mathrm{raw}}(\\alpha, 0)$。\n\n**步骤 3: $S_{\\mathrm{bal}}(\\alpha, \\beta)$ 的双线性插值**\n\n平衡表格 $S_{\\mathrm{bal}}(\\alpha, \\beta)$ 仅在离散网格上定义。为了找到任意 $(\\alpha, \\beta)$ 值对应的 $S$ 值，必须进行插值。问题指定在二维 $(\\alpha, \\beta)$ 平面上进行双线性插值。对于位于网格边界之外的查询点，要求进行钳位处理：如果 $\\alpha$ 或 $\\beta$ 的查询值超出其网格范围，则在插值前将其设置为最近的边界值，以防止外推。\n\n**步骤 4: 计算双微分散射截面**\n\n对于每个散射事件，计算相应的无量纲变量 $\\alpha$ 和 $\\beta$。然后将这些计算出的值作为输入，用于上一步的插值方案，以获得相应的 $S(\\alpha, \\beta)$ 值。\n\n最后，使用非相干散射的标准公式计算双微分散射截面，单位为 barn/eV/sr：\n$$\n\\frac{\\mathrm{d}^2 \\sigma}{\\mathrm{d} E' \\mathrm{d} \\Omega} = \\frac{\\sigma_b}{4\\pi\\, k_B T}\\,\\sqrt{\\frac{E'}{E}}\\,S(\\alpha, \\beta)\n$$\n整个算法的流程是：首先建立平衡的 $S_{\\mathrm{bal}}(\\alpha, \\beta)$ 表格及其对应的插值器。然后，对于每个测试用例，计算运动学参数 $(\\alpha, \\beta)$，将其钳位到网格上，通过插值找到 $S(\\alpha, \\beta)$，并计算最终的截面。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import RectBivariateSpline\n\ndef solve():\n    \"\"\"\n    Computes the double-differential thermal neutron scattering cross section\n    by emulating the NJOY/THERMR workflow for S(alpha, beta) data.\n    \"\"\"\n    # 1. Define constants, grids, and test cases as per the problem statement.\n    k_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    alpha_grid = np.array([0.0, 0.5, 1.0, 2.0, 4.0])\n    beta_grid = np.array([-4.0, -2.0, -1.0, 0.0, 1.0, 2.0, 4.0])\n\n    test_cases = [\n        # (E [eV], E' [eV], mu, A, T [K], sigma_b [barn])\n        (0.0253, 0.0100, 0.3, 1.0, 293.6, 80.27),  # Case 1\n        (0.0050, 0.0200, -0.5, 1.0, 293.6, 80.27), # Case 2\n        (0.0253, 0.0253, 1.0, 1.0, 293.6, 80.27),  # Case 3\n        (0.0010, 0.5000, 0.0, 1.0, 293.6, 80.27),  # Case 4\n    ]\n\n    # 2. Construct the raw, unbalanced S(alpha, beta) table.\n    def s_raw_func(alpha, beta):\n        \"\"\"Calculates the value of the raw S(alpha, beta) function.\"\"\"\n        # The term (1 + alpha) is always >= 1.0, so no division by zero.\n        return np.exp(-alpha) * np.exp(-beta**2 / (1.0 + alpha)) * (1.0 + 0.05 * beta)\n\n    # Create meshgrids to evaluate S_raw over the entire grid efficiently.\n    # 'ij' indexing ensures the output array shape is (len(alpha_grid), len(beta_grid)).\n    alpha_mesh, beta_mesh = np.meshgrid(alpha_grid, beta_grid, indexing='ij')\n    S_raw = s_raw_func(alpha_mesh, beta_mesh)\n\n    # 3. Construct the balanced S(alpha, beta) table by enforcing detailed balance.\n    S_bal = np.zeros_like(S_raw)\n    \n    # Find the index corresponding to beta = 0.\n    try:\n        beta_zero_idx = np.where(beta_grid == 0.0)[0][0]\n    except IndexError:\n        raise ValueError(\"Beta grid must contain a 0.0 value.\")\n\n    for i, alpha in enumerate(alpha_grid):\n        # For beta = 0, S_bal = S_raw.\n        S_bal[i, beta_zero_idx] = S_raw[i, beta_zero_idx]\n\n        # For beta > 0, apply the symmetrization formulas.\n        for j in range(beta_zero_idx + 1, len(beta_grid)):\n            beta_pos = beta_grid[j]\n            try:\n                # Find the index of the corresponding negative beta.\n                beta_neg_idx = np.where(beta_grid == -beta_pos)[0][0]\n            except IndexError:\n                raise ValueError(f\"Symmetric beta value for {beta_pos} not found in grid.\")\n\n            s_raw_pos = S_raw[i, j]\n            s_raw_neg = S_raw[i, beta_neg_idx]\n\n            # Symmetrization for +beta\n            S_bal[i, j] = 0.5 * (s_raw_pos + np.exp(-beta_pos) * s_raw_neg)\n            \n            # Symmetrization for -beta\n            # This could also be calculated as np.exp(beta_pos) * S_bal[i, j]\n            # to verify detailed balance, but the direct formula is also provided.\n            S_bal[i, beta_neg_idx] = 0.5 * (s_raw_neg + np.exp(beta_pos) * s_raw_pos)\n\n    # 4. Create a bilinear interpolator for the balanced S(alpha, beta) table.\n    # kx=1 and ky=1 specify linear interpolation in each dimension.\n    s_interpolator = RectBivariateSpline(alpha_grid, beta_grid, S_bal, kx=1, ky=1)\n\n    # 5. Process each test case.\n    results = []\n    for case in test_cases:\n        E, E_prime, mu, A, T, sigma_b = case\n        k_B_T = k_B * T\n\n        # Calculate alpha and beta from scattering kinematics.\n        if E = 0.0 or E_prime  0.0:\n            # Physical constraints, avoid math errors.\n            alpha_val = 0.0\n            beta_val = 0.0\n        else:\n             alpha_val = (E_prime + E - 2.0 * np.sqrt(E * E_prime) * mu) / (A * k_B_T)\n             beta_val = (E_prime - E) / k_B_T\n\n        # Clamp the calculated alpha and beta to the grid boundaries.\n        alpha_clamped = np.clip(alpha_val, alpha_grid[0], alpha_grid[-1])\n        beta_clamped = np.clip(beta_val, beta_grid[0], beta_grid[-1])\n        \n        # Interpolate to find S(alpha, beta). The result is a 1-element array.\n        S_val = s_interpolator(alpha_clamped, beta_clamped, grid=False).item()\n\n        # Calculate the double-differential cross section.\n        if E == 0.0:\n            ds2_dEdO = 0.0  # Avoid division by zero\n        else:\n            ds2_dEdO = (sigma_b / (4.0 * np.pi * k_B_T)) * np.sqrt(E_prime / E) * S_val\n        \n        results.append(ds2_dEdO)\n\n    # 6. Format the results as specified and print to standard output.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}