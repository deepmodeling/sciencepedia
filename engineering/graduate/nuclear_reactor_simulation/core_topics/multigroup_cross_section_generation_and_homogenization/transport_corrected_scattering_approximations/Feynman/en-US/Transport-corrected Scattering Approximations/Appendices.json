{
    "hands_on_practices": [
        {
            "introduction": "The behavior of neutrons in a reactor is fundamentally described by how they scatter off nuclei, a process that is rarely isotropic. To manage this complexity in simulations, we represent the angular dependence of the scattering cross section, $\\Sigma_s(\\mu)$, as a series of Legendre polynomials. This exercise will build your foundational skills by having you calculate the first three Legendre moments, $\\Sigma_{s,l}$, from a given analytical scattering kernel . Understanding this derivation and the physical meaning of the moments is the first step toward mastering anisotropic scattering approximations.",
            "id": "4258404",
            "problem": "Consider monoenergetic neutron transport in an infinite, azimuthally symmetric medium, where scattering depends only on the cosine of the polar scattering angle, denoted by $\\mu \\in [-1,1]$. The scattering kernel is assumed analytic and given by $\\Sigma_{s}(\\mu) = a + b \\mu + c \\mu^{2}$, where $a$, $b$, and $c$ are constants with units of inverse length. In transport-corrected scattering approximations used in nuclear reactor simulation, the angular dependence of $\\Sigma_{s}(\\mu)$ is represented through its projections onto Legendre polynomials, which enter the angular flux moment equations. Let the Legendre polynomials be $P_{0}(\\mu) = 1$, $P_{1}(\\mu) = \\mu$, and $P_{2}(\\mu) = \\frac{1}{2}\\left(3\\mu^{2} - 1\\right)$, and define the scattering moments by the projection integrals\n$$\n\\Sigma_{s,l} = \\int_{-1}^{1} \\Sigma_{s}(\\mu) \\, P_{l}(\\mu) \\, d\\mu,\n$$\nfor $l = 0,1,2$, which is the standard construction ensuring consistency with the orthogonality of Legendre polynomials and the moment hierarchy in the neutron transport equation.\n\nStarting from the stated definitions and core properties of orthogonal polynomials, compute the exact analytic expressions for $\\Sigma_{s,0}$, $\\Sigma_{s,1}$, and $\\Sigma_{s,2}$ in terms of $a$, $b$, and $c$. Then, briefly justify the physical role of each moment within transport-corrected scattering approximations, clarifying how each moment contributes to the isotropic source, anisotropy corrections to the transport cross section, and higher-order angular corrections. Express your final answer as a single row matrix containing $\\Sigma_{s,0}$, $\\Sigma_{s,1}$, and $\\Sigma_{s,2}$ in terms of $a$, $b$, and $c$. No numerical evaluation is required. Do not include units in your final answer; units are implied to be inverse length for each moment.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in neutron transport theory concerning the Legendre expansion of an anisotropic scattering kernel. All required definitions and data are provided, and there are no contradictions.\n\nThe task is to compute the first three Legendre moments, $\\Sigma_{s,0}$, $\\Sigma_{s,1}$, and $\\Sigma_{s,2}$, of the given scattering kernel $\\Sigma_{s}(\\mu) = a + b \\mu + c \\mu^{2}$. The moments are defined by the projection integral:\n$$\n\\Sigma_{s,l} = \\int_{-1}^{1} \\Sigma_{s}(\\mu) \\, P_{l}(\\mu) \\, d\\mu\n$$\nwhere $P_l(\\mu)$ are the Legendre polynomials. The key to an efficient and conceptually clear solution is to first express the scattering kernel $\\Sigma_s(\\mu)$ as a linear combination of the Legendre polynomials $P_0(\\mu)$, $P_1(\\mu)$, and $P_2(\\mu)$, and then leverage their orthogonality property.\n\nThe first three Legendre polynomials are given as:\n$P_{0}(\\mu) = 1$\n$P_{1}(\\mu) = \\mu$\n$P_{2}(\\mu) = \\frac{1}{2}\\left(3\\mu^{2} - 1\\right)$\n\nWe can express the powers of $\\mu$ in terms of these polynomials. From the definitions, we have:\n$1 = P_0(\\mu)$\n$\\mu = P_1(\\mu)$\n\nFrom the definition of $P_2(\\mu)$, we can solve for $\\mu^2$:\n$P_2(\\mu) = \\frac{3}{2}\\mu^2 - \\frac{1}{2}P_0(\\mu)$\n$\\frac{3}{2}\\mu^2 = P_2(\\mu) + \\frac{1}{2}P_0(\\mu)$\n$\\mu^2 = \\frac{2}{3}P_2(\\mu) + \\frac{1}{3}P_0(\\mu)$\n\nNow, we substitute these expressions back into the scattering kernel $\\Sigma_s(\\mu)$:\n$\\Sigma_s(\\mu) = a(P_0(\\mu)) + b(P_1(\\mu)) + c\\left(\\frac{1}{3}P_0(\\mu) + \\frac{2}{3}P_2(\\mu)\\right)$\n\nCombining terms with the same Legendre polynomial, we get the expansion of $\\Sigma_s(\\mu)$ in the Legendre basis:\n$\\Sigma_s(\\mu) = \\left(a + \\frac{c}{3}\\right)P_0(\\mu) + b P_1(\\mu) + \\frac{2c}{3}P_2(\\mu)$\n\nThe orthogonality property of Legendre polynomials over the interval $[-1, 1]$ is given by:\n$$\n\\int_{-1}^{1} P_{l}(\\mu) P_{m}(\\mu) d\\mu = \\frac{2}{2l+1}\\delta_{lm}\n$$\nwhere $\\delta_{lm}$ is the Kronecker delta, which is $1$ if $l=m$ and $0$ otherwise. We can now compute each moment $\\Sigma_{s,l}$ by substituting the Legendre expansion of $\\Sigma_s(\\mu)$ into the defining integral.\n\nFor $l=0$:\n$\\Sigma_{s,0} = \\int_{-1}^{1} \\left[ \\left(a + \\frac{c}{3}\\right)P_0(\\mu) + b P_1(\\mu) + \\frac{2c}{3}P_2(\\mu) \\right] P_0(\\mu) d\\mu$\nDue to orthogonality, the integrals of the $P_1P_0$ and $P_2P_0$ terms are zero.\n$\\Sigma_{s,0} = \\left(a + \\frac{c}{3}\\right) \\int_{-1}^{1} P_0(\\mu)^2 d\\mu = \\left(a + \\frac{c}{3}\\right) \\left(\\frac{2}{2(0)+1}\\right) = \\left(a + \\frac{c}{3}\\right)(2)$\n$\\Sigma_{s,0} = 2a + \\frac{2}{3}c$\n\nFor $l=1$:\n$\\Sigma_{s,1} = \\int_{-1}^{1} \\left[ \\left(a + \\frac{c}{3}\\right)P_0(\\mu) + b P_1(\\mu) + \\frac{2c}{3}P_2(\\mu) \\right] P_1(\\mu) d\\mu$\nDue to orthogonality, only the $P_1P_1$ term survives.\n$\\Sigma_{s,1} = b \\int_{-1}^{1} P_1(\\mu)^2 d\\mu = b \\left(\\frac{2}{2(1)+1}\\right) = b \\left(\\frac{2}{3}\\right)$\n$\\Sigma_{s,1} = \\frac{2}{3}b$\n\nFor $l=2$:\n$\\Sigma_{s,2} = \\int_{-1}^{1} \\left[ \\left(a + \\frac{c}{3}\\right)P_0(\\mu) + b P_1(\\mu) + \\frac{2c}{3}P_2(\\mu) \\right] P_2(\\mu) d\\mu$\nDue to orthogonality, only the $P_2P_2$ term survives.\n$\\Sigma_{s,2} = \\frac{2c}{3} \\int_{-1}^{1} P_2(\\mu)^2 d\\mu = \\frac{2c}{3} \\left(\\frac{2}{2(2)+1}\\right) = \\frac{2c}{3} \\left(\\frac{2}{5}\\right)$\n$\\Sigma_{s,2} = \\frac{4}{15}c$\n\nThe physical roles of these moments within transport-corrected scattering approximations are as follows:\n\n1.  $\\Sigma_{s,0}$: This is the zeroth moment, representing the total macroscopic scattering cross section obtained by integrating the differential cross section over all outgoing solid angles. It quantifies the total probability of a scattering event per unit path length. In the neutron transport equation, it appears in the scattering source term $\\Sigma_{s,0}\\phi_0$, providing the rate at which neutrons are isotropically scattered into any direction from the scalar flux $\\phi_0$.\n\n2.  $\\Sigma_{s,1}$: This is the first moment, directly related to the average cosine of the scattering angle, $\\bar{\\mu}$. It represents the degree of anisotropy in scattering, specifically the forward or backward bias. A positive $\\Sigma_{s,1}$ indicates predominantly forward scattering. In transport-corrected approximations, this moment is used to define the transport cross section, $\\Sigma_{tr} = \\Sigma_t - \\Sigma_{s,1}$ (where $\\Sigma_t$ is the total cross section). This correction effectively accounts for the anisotropic part of scattering by modifying the total removal cross section. This allows a simpler, isotropic scattering source model to be used with greater accuracy, especially in diffusion theory, by correctly modeling the net neutron current.\n\n3.  $\\Sigma_{s,2}$: This is the second moment, which provides a higher-order correction for the angular shape of the scattering distribution. While $\\Sigma_{s,1}$ captures linear anisotropy (forward/backward asymmetry), $\\Sigma_{s,2}$ captures quadratic features. It is essential in higher-order angular flux approximations, such as the $P_N$ method for $N \\ge 2$. In the hierarchy of moment equations for the angular flux, the $l$-th moment of the scattering cross section, $\\Sigma_{s,l}$, couples the various angular moments of the flux. The $\\Sigma_{s,2}$ term thus provides a more refined description of how scattering redistributes neutrons angularly, which is necessary for accurately predicting the flux distribution in problems where simple linear anisotropy is insufficient.\n\nThe computed expressions for the three moments are summarized in the final answer.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2a + \\frac{2}{3}c & \\frac{2}{3}b & \\frac{4}{15}c \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Once we have the Legendre moments, we can use them to simplify the neutron transport equation. The transport correction is a powerful technique that accounts for the most significant part of scattering anisotropy by modifying the total and within-group scattering cross sections. This approximation preserves both the particle balance (zeroth moment) and the correct diffusive behavior (first moment) of the neutron population. In this problem, you will apply this principle to a concrete two-group system, deriving the corrected cross sections and verifying the internal consistency of the method .",
            "id": "4258413",
            "problem": "Consider a homogeneous, source-free, two-neutron-energy-group system in steady state with elastic scattering described by a Legendre expansion truncated at first order. Let the isotropic zeroth-moment scattering matrix elements be denoted by $\\Sigma_{s,0}^{g' \\leftarrow g}$ and the first-moment (linearly anisotropic) elements by $\\Sigma_{s,1}^{g' \\leftarrow g}$, with total cross section $\\Sigma_{t,g}$ and absorption cross section $\\Sigma_{a,g}$ for group $g \\in \\{1,2\\}$. Assume no fission and no external source. The given cross sections (all in $\\mathrm{cm}^{-1}$) are:\n- Group $1$: $\\Sigma_{t,1} = 0.85$, $\\Sigma_{a,1} = 0.05$, $\\Sigma_{s,0}^{1 \\leftarrow 1} = 0.65$, $\\Sigma_{s,0}^{2 \\leftarrow 1} = 0.15$, $\\Sigma_{s,1}^{1 \\leftarrow 1} = 0.25$, $\\Sigma_{s,1}^{2 \\leftarrow 1} = 0.01$.\n- Group $2$: $\\Sigma_{t,2} = 0.60$, $\\Sigma_{a,2} = 0.10$, $\\Sigma_{s,0}^{2 \\leftarrow 2} = 0.45$, $\\Sigma_{s,0}^{1 \\leftarrow 2} = 0.05$, $\\Sigma_{s,1}^{2 \\leftarrow 2} = 0.20$, $\\Sigma_{s,1}^{1 \\leftarrow 2} = 0.02$.\n\nYou are to construct a transport-corrected isotropic-scattering approximation that removes within-group first-moment anisotropy while preserving, for each group, both the zeroth angular moment (balance of particle number) and the first-moment transport-diffusive response implied by first-order spherical harmonics (P1). Concretely, eliminate the within-group $\\Sigma_{s,1}^{g \\leftarrow g}$ contribution by appropriately redistributing it between the total cross section and the isotropic within-group scattering so that the groupwise removal cross section is unchanged.\n\nTasks:\n1. Starting from the definitions of the zeroth- and first-moment neutron balance for P1 transport and the diffusion coefficient $D_g$ as constrained by the transport cross section, derive a moment-preserving within-group transport-correction mapping that yields corrected $\\tilde{\\Sigma}_{t,g}$ and corrected isotropic scattering $\\tilde{\\Sigma}_{s,0}^{g' \\leftarrow g}$.\n2. Apply your mapping to compute the corrected $\\tilde{\\Sigma}_{t,g}$ and $\\tilde{\\Sigma}_{s,0}^{g' \\leftarrow g}$ for both groups using the numerical data above.\n3. Using the definitions $\\Sigma_{r,g} \\equiv \\Sigma_{t,g} - \\Sigma_{s,0}^{g \\leftarrow g}$ and $\\tilde{\\Sigma}_{r,g} \\equiv \\tilde{\\Sigma}_{t,g} - \\tilde{\\Sigma}_{s,0}^{g \\leftarrow g}$, verify analytically and numerically that the groupwise removal cross sections are preserved by your correction.\n4. Let $\\Delta_{\\max}$ denote the maximum absolute discrepancy in removal cross section across the two groups after correction, i.e., $\\Delta_{\\max} \\equiv \\max\\{|\\tilde{\\Sigma}_{r,1} - \\Sigma_{r,1}|,\\;|\\tilde{\\Sigma}_{r,2} - \\Sigma_{r,2}|\\}$. Compute $\\Delta_{\\max}$.\n\nExpress the final answer for $\\Delta_{\\max}$ in $\\mathrm{cm}^{-1}$ and round your answer to four significant figures.",
            "solution": "The problem has been validated and found to be scientifically grounded, well-posed, and objective. The provided data is internally consistent.\n\nThe task is to derive and apply a transport correction to a two-group neutron transport problem described by the $P_1$ approximation. The correction must eliminate within-group anisotropic scattering while preserving the particle balance and the first-moment transport response.\n\nThe steady-state, source-free, two-group $P_1$ equations are given by the zeroth and first angular moments of the Boltzmann transport equation. For a generic energy group $g$, these are:\nZeroth-moment (balance) equation:\n$$ \\nabla \\cdot \\mathbf{J}_g(\\mathbf{r}) + \\Sigma_{t,g} \\phi_g(\\mathbf{r}) = \\sum_{g'} \\Sigma_{s,0}^{g \\leftarrow g'} \\phi_{g'}(\\mathbf{r}) $$\nFirst-moment (current) equation:\n$$ \\frac{1}{3} \\nabla \\phi_g(\\mathbf{r}) + \\Sigma_{t,g} \\mathbf{J}_g(\\mathbf{r}) = \\sum_{g'} \\Sigma_{s,1}^{g \\leftarrow g'} \\mathbf{J}_{g'}(\\mathbf{r}) $$\nHere, $\\phi_g$ is the scalar flux, $\\mathbf{J}_g$ is the current, $\\Sigma_{t,g}$ is the total cross section, $\\Sigma_{s,0}^{g \\leftarrow g'}$ is the isotropic scattering transfer cross section from group $g'$ to $g$, and $\\Sigma_{s,1}^{g \\leftarrow g'}$ is the linearly anisotropic scattering transfer cross section.\n\nWe can rewrite these equations by isolating the within-group terms:\n$$ \\nabla \\cdot \\mathbf{J}_g(\\mathbf{r}) + (\\Sigma_{t,g} - \\Sigma_{s,0}^{g \\leftarrow g}) \\phi_g(\\mathbf{r}) = \\sum_{g' \\neq g} \\Sigma_{s,0}^{g \\leftarrow g'} \\phi_{g'}(\\mathbf{r}) $$\n$$ \\frac{1}{3} \\nabla \\phi_g(\\mathbf{r}) + (\\Sigma_{t,g} - \\Sigma_{s,1}^{g \\leftarrow g}) \\mathbf{J}_g(\\mathbf{r}) = \\sum_{g' \\neq g} \\Sigma_{s,1}^{g \\leftarrow g'} \\mathbf{J}_{g'}(\\mathbf{r}) $$\nThe term $\\Sigma_{r,g} \\equiv \\Sigma_{t,g} - \\Sigma_{s,0}^{g \\leftarrow g}$ is the group removal cross section.\n\nThe goal of the transport-corrected isotropic-scattering approximation is to construct a new set of cross sections (denoted with a tilde, e.g., $\\tilde{\\Sigma}$) such that the scattering is purely isotropic, i.e., $\\tilde{\\Sigma}_{s,1}^{g' \\leftarrow g} = 0$ for all $g, g'$, while preserving key physical properties. The problem specifies that we must eliminate the *within-group* anisotropic scattering term, $\\Sigma_{s,1}^{g \\leftarrow g}$. The corrected equations become:\n$$ \\nabla \\cdot \\tilde{\\mathbf{J}}_g(\\mathbf{r}) + \\tilde{\\Sigma}_{r,g} \\tilde{\\phi}_g(\\mathbf{r}) = \\sum_{g' \\neq g} \\tilde{\\Sigma}_{s,0}^{g \\leftarrow g'} \\tilde{\\phi}_{g'}(\\mathbf{r}) $$\n$$ \\frac{1}{3} \\nabla \\tilde{\\phi}_g(\\mathbf{r}) + \\tilde{\\Sigma}_{t,g} \\tilde{\\mathbf{J}}_g(\\mathbf{r}) = 0 $$\nwhere $\\tilde{\\Sigma}_{r,g} \\equiv \\tilde{\\Sigma}_{t,g} - \\tilde{\\Sigma}_{s,0}^{g \\leftarrow g}$.\n\n**Task 1: Derive the Correction Mapping**\nThe correction is based on two preservation principles:\n1.  **Preservation of the first-moment transport-diffusive response:** The response of the current $\\mathbf{J}_g$ to the flux gradient $\\nabla \\phi_g$ is determined by the coefficient of the $\\mathbf{J}_g$ term. To preserve this response in the simplified model where only within-group anisotropy is considered, we equate the coefficients of $\\mathbf{J}_g$ in the original and corrected first-moment equations. This gives the definition of the transport-corrected total cross section, $\\tilde{\\Sigma}_{t,g}$:\n    $$ \\tilde{\\Sigma}_{t,g} = \\Sigma_{t,g} - \\Sigma_{s,1}^{g \\leftarrow g} $$\n2.  **Preservation of the groupwise removal cross section:** The problem explicitly states this as a constraint. The rate at which neutrons are removed from a group (by absorption or out-scattering) must be the same in both the original and corrected models.\n    $$ \\tilde{\\Sigma}_{r,g} = \\Sigma_{r,g} $$\n    Using the definitions of the removal cross sections, this becomes:\n    $$ \\tilde{\\Sigma}_{t,g} - \\tilde{\\Sigma}_{s,0}^{g \\leftarrow g} = \\Sigma_{t,g} - \\Sigma_{s,0}^{g \\leftarrow g} $$\n\nNow we solve for the corrected within-group isotropic scattering, $\\tilde{\\Sigma}_{s,0}^{g \\leftarrow g}$. We substitute the expression for $\\tilde{\\Sigma}_{t,g}$ from the first principle into the equation from the second principle:\n$$ (\\Sigma_{t,g} - \\Sigma_{s,1}^{g \\leftarrow g}) - \\tilde{\\Sigma}_{s,0}^{g \\leftarrow g} = \\Sigma_{t,g} - \\Sigma_{s,0}^{g \\leftarrow g} $$\nSolving for $\\tilde{\\Sigma}_{s,0}^{g \\leftarrow g}$:\n$$ -\\Sigma_{s,1}^{g \\leftarrow g} - \\tilde{\\Sigma}_{s,0}^{g \\leftarrow g} = -\\Sigma_{s,0}^{g \\leftarrow g} $$\n$$ \\tilde{\\Sigma}_{s,0}^{g \\leftarrow g} = \\Sigma_{s,0}^{g \\leftarrow g} - \\Sigma_{s,1}^{g \\leftarrow g} $$\nThe out-of-group scattering cross sections are unaffected by this correction: $\\tilde{\\Sigma}_{s,0}^{g' \\leftarrow g} = \\Sigma_{s,0}^{g' \\leftarrow g}$ for $g' \\neq g$.\n\n**Task 2: Apply the Mapping**\nWe apply these derived formulas to the given numerical data for each group. All units are in $\\mathrm{cm}^{-1}$.\n\nFor Group $g=1$:\n- Given: $\\Sigma_{t,1} = 0.85$, $\\Sigma_{s,0}^{1 \\leftarrow 1} = 0.65$, $\\Sigma_{s,1}^{1 \\leftarrow 1} = 0.25$, $\\Sigma_{s,0}^{2 \\leftarrow 1} = 0.15$.\n- Corrected total cross section:\n$$ \\tilde{\\Sigma}_{t,1} = \\Sigma_{t,1} - \\Sigma_{s,1}^{1 \\leftarrow 1} = 0.85 - 0.25 = 0.60 $$\n- Corrected within-group isotropic scattering:\n$$ \\tilde{\\Sigma}_{s,0}^{1 \\leftarrow 1} = \\Sigma_{s,0}^{1 \\leftarrow 1} - \\Sigma_{s,1}^{1 \\leftarrow 1} = 0.65 - 0.25 = 0.40 $$\n- Corrected out-of-group scattering:\n$$ \\tilde{\\Sigma}_{s,0}^{2 \\leftarrow 1} = \\Sigma_{s,0}^{2 \\leftarrow 1} = 0.15 $$\n\nFor Group $g=2$:\n- Given: $\\Sigma_{t,2} = 0.60$, $\\Sigma_{s,0}^{2 \\leftarrow 2} = 0.45$, $\\Sigma_{s,1}^{2 \\leftarrow 2} = 0.20$, $\\Sigma_{s,0}^{1 \\leftarrow 2} = 0.05$.\n- Corrected total cross section:\n$$ \\tilde{\\Sigma}_{t,2} = \\Sigma_{t,2} - \\Sigma_{s,1}^{2 \\leftarrow 2} = 0.60 - 0.20 = 0.40 $$\n- Corrected within-group isotropic scattering:\n$$ \\tilde{\\Sigma}_{s,0}^{2 \\leftarrow 2} = \\Sigma_{s,0}^{2 \\leftarrow 2} - \\Sigma_{s,1}^{2 \\leftarrow 2} = 0.45 - 0.20 = 0.25 $$\n- Corrected out-of-group scattering:\n$$ \\tilde{\\Sigma}_{s,0}^{1 \\leftarrow 2} = \\Sigma_{s,0}^{1 \\leftarrow 2} = 0.05 $$\n\n**Task 3: Verify Preservation of Removal Cross Section**\nFirst, we verify analytically that the removal cross section is preserved by the derived mapping.\nThe corrected removal cross section is $\\tilde{\\Sigma}_{r,g} = \\tilde{\\Sigma}_{t,g} - \\tilde{\\Sigma}_{s,0}^{g \\leftarrow g}$.\nSubstituting the expressions for the corrected quantities:\n$$ \\tilde{\\Sigma}_{r,g} = (\\Sigma_{t,g} - \\Sigma_{s,1}^{g \\leftarrow g}) - (\\Sigma_{s,0}^{g \\leftarrow g} - \\Sigma_{s,1}^{g \\leftarrow g}) $$\n$$ \\tilde{\\Sigma}_{r,g} = \\Sigma_{t,g} - \\Sigma_{s,1}^{g \\leftarrow g} - \\Sigma_{s,0}^{g \\leftarrow g} + \\Sigma_{s,1}^{g \\leftarrow g} $$\n$$ \\tilde{\\Sigma}_{r,g} = \\Sigma_{t,g} - \\Sigma_{s,0}^{g \\leftarrow g} $$\nSince $\\Sigma_{r,g} \\equiv \\Sigma_{t,g} - \\Sigma_{s,0}^{g \\leftarrow g}$, we have proven that $\\tilde{\\Sigma}_{r,g} = \\Sigma_{r,g}$.\n\nNext, we verify this numerically.\nFor Group $1$:\n- Original removal cross section:\n$$ \\Sigma_{r,1} = \\Sigma_{t,1} - \\Sigma_{s,0}^{1 \\leftarrow 1} = 0.85 - 0.65 = 0.20 $$\n- Corrected removal cross section:\n$$ \\tilde{\\Sigma}_{r,1} = \\tilde{\\Sigma}_{t,1} - \\tilde{\\Sigma}_{s,0}^{1 \\leftarrow 1} = 0.60 - 0.40 = 0.20 $$\nThe values are identical, so $|\\tilde{\\Sigma}_{r,1} - \\Sigma_{r,1}| = 0.00$.\n\nFor Group $2$:\n- Original removal cross section:\n$$ \\Sigma_{r,2} = \\Sigma_{t,2} - \\Sigma_{s,0}^{2 \\leftarrow 2} = 0.60 - 0.45 = 0.15 $$\n- Corrected removal cross section:\n$$ \\tilde{\\Sigma}_{r,2} = \\tilde{\\Sigma}_{t,2} - \\tilde{\\Sigma}_{s,0}^{2 \\leftarrow 2} = 0.40 - 0.25 = 0.15 $$\nThe values are identical, so $|\\tilde{\\Sigma}_{r,2} - \\Sigma_{r,2}| = 0.00$.\n\n**Task 4: Compute Maximum Discrepancy**\nThe maximum absolute discrepancy in the removal cross section is defined as $\\Delta_{\\max} \\equiv \\max\\{|\\tilde{\\Sigma}_{r,1} - \\Sigma_{r,1}|, |\\tilde{\\Sigma}_{r,2} - \\Sigma_{r,2}|\\}$.\nUsing the results from Task $3$:\n$$ |\\tilde{\\Sigma}_{r,1} - \\Sigma_{r,1}| = |0.20 - 0.20| = 0 $$\n$$ |\\tilde{\\Sigma}_{r,2} - \\Sigma_{r,2}| = |0.15 - 0.15| = 0 $$\nTherefore,\n$$ \\Delta_{\\max} = \\max\\{0, 0\\} = 0 $$\nThe discrepancy is exactly zero, as required by the construction of the transport correction. The problem asks for the answer to be rounded to four significant figures. For a result of zero, this implies a high degree of precision in our finding that there is no discrepancy. It is best represented as $0.0000$.",
            "answer": "$$\\boxed{0.0000}$$"
        },
        {
            "introduction": "In real-world reactor analysis, nuclear cross sections are not constant; they depend strongly on material temperature. A crucial task for reactor physicists is to prepare cross-section libraries that correctly capture these temperature effects for use in simulation codes. This advanced, coding-based exercise challenges you to implement temperature-dependent models, generate transport-corrected cross-section tables, and ensure the resulting data is smooth and physically plausible using numerical interpolation techniques . This practice provides direct experience in a core process of nuclear data preparation for reactor simulation.",
            "id": "4258434",
            "problem": "You are given a temperature-dependent cross-section library for a homogeneous medium to be used in multigroup nuclear reactor simulation with transport-corrected scattering approximations. The objective is to compute the first Legendre moment of in-group scattering $ \\Sigma_{s,1,g \\to g}(T) $ and then construct transport-corrected cross-section tables across temperature with guaranteed smoothness and physical consistency.\n\nUse the following fundamental base to derive your algorithm:\n- The steady-state neutron transport equation with anisotropic scattering is expressed in terms of the scattering source using an expansion in Legendre polynomials of order $ l $, where $ l = 0 $ corresponds to isotropic scattering and $ l = 1 $ captures the first-order anisotropy.\n- The multigroup scattering cross section moments $ \\Sigma_{s,l,g \\to g'}(T) $ are formally defined as angular and energy projections of the microscopic scattering kernel, integrated over angles and energy intervals corresponding to group $ g $ and $ g' $, with Legendre weights $ P_l(\\mu) $, where $ \\mu $ is the cosine of the scattering angle.\n- In the diffusion approximation consistent with first-order transport effects, the transport cross section is defined as $ \\Sigma_{tr,g}(T) = \\Sigma_{t,g}(T) - \\Sigma_{s,1,g \\to g}(T) $, where $ \\Sigma_{t,g}(T) $ is the total macroscopic cross section in group $ g $.\n\nFor this problem, assume the following model for the in-group scattering moments:\n- The zeroth moment (isotropic in-group scattering) is $ \\Sigma_{s,0,g \\to g}(T) = s_{0,g} \\left( 1 + \\eta_g \\ln\\left( \\frac{T}{T_{\\mathrm{ref}}} \\right) \\right) $, where $ s_{0,g} > 0 $, $ \\eta_g $ is a small dimensionless coefficient controlling temperature variation, and $ T_{\\mathrm{ref}} = 600 \\,\\mathrm{K} $.\n- The absorption cross section is $ \\Sigma_{a,g}(T) = a_{g} \\sqrt{ \\frac{T}{T_{\\mathrm{ref}}} } $, with $ a_g > 0 $.\n- The total cross section is $ \\Sigma_{t,g}(T) = \\Sigma_{a,g}(T) + \\Sigma_{s,0,g \\to g}(T) + \\sigma_{g}^{\\mathrm{out}} $, where $ \\sigma_{g}^{\\mathrm{out}} \\ge 0 $ is a constant outscattering term (i.e., net removal to other groups).\n- The first Legendre moment factor (average cosine of the scattering angle within the group) is modeled as $ a_g(T) = \\frac{a_{0,g}}{1 + T / T_{0,g}} $, with $ 0 \\le a_{0,g} < 1 $ and $ T_{0,g} > 0 $. The first moment is then $ \\Sigma_{s,1,g \\to g}(T) = a_g(T) \\, \\Sigma_{s,0,g \\to g}(T) $.\n\nConstruct transport-corrected scattering tables for in-group scattering using the standard P1 transport correction, which preserves the group absorption rate.\n- Define the transport-corrected isotropic scattering cross section $\\tilde{\\Sigma}_{s,0,g \\to g}(T)$ and the transport cross section $\\Sigma_{tr,g}(T)$ as:\n$$\n\\tilde{\\Sigma}_{s,0,g \\to g}(T) = \\Sigma_{s,0,g \\to g}(T) - \\Sigma_{s,1,g \\to g}(T)\n$$\n$$\n\\Sigma_{tr,g}(T) = \\Sigma_{t,g}(T) - \\Sigma_{s,1,g \\to g}(T)\n$$\n- Verify the consistency condition that the absorption cross section is preserved:\n$$\n\\Sigma_{a,g}(T) = \\Sigma_{tr,g}(T) - \\tilde{\\Sigma}_{s,0,g \\to g}(T) - \\sigma_{g}^{\\mathrm{out}}\n$$\n\nAll cross sections must be treated in units of inverse centimeters ($\\mathrm{cm}^{-1}$), temperature in kelvin ($\\mathrm{K}$), and angles are not explicitly needed because the Legendre moments are already modeled.\n\nTo ensure smoothness and physical plausibility across temperature, construct shape-preserving interpolations of $ \\tilde{\\Sigma}_{s,0,g \\to g}(T) $ and $ \\Sigma_{tr,g}(T) $ using a piecewise cubic Hermite method that preserves monotonicity with respect to $ T $.\n\nImplement a program that:\n- Uses the temperature grid $ T \\in \\{ 300, 600, 900, 1200 \\} \\,\\mathrm{K} $.\n- For each test case below, computes $ \\Sigma_{s,1,g \\to g}(T) $, $ \\tilde{\\Sigma}_{s,0,g \\to g}(T) $, and $ \\Sigma_{tr,g}(T) $ on the given grid.\n- Builds shape-preserving smooth interpolants for $ \\tilde{\\Sigma}_{s,0,g \\to g}(T) $ and $ \\Sigma_{tr,g}(T) $, and evaluates monotonicity by checking that discrete first differences of the interpolated values at $ T = 300, 400, 500, \\ldots, 1200 \\,\\mathrm{K} $ do not change sign.\n\nTest suite parameter sets (all in $ \\mathrm{cm}^{-1} $ and $ \\mathrm{K} $):\n1. Group $ g = 1 $ (thermal-like): $ s_{0,1} = 0.17 $, $ \\eta_1 = 0.03 $, $ a_1 = 0.03 $, $ \\sigma_{1}^{\\mathrm{out}} = 0.01 $, $ a_{0,1} = 0.10 $, $ T_{0,1} = 1200 $.\n2. Group $ g = 2 $ (epithermal-like): $ s_{0,2} = 0.26 $, $ \\eta_2 = 0.02 $, $ a_2 = 0.04 $, $ \\sigma_{2}^{\\mathrm{out}} = 0.01 $, $ a_{0,2} = 0.20 $, $ T_{0,2} = 1500 $.\n3. Group $ g = 3 $ (fast-like, stronger anisotropy drop): $ s_{0,3} = 0.42 $, $ \\eta_3 = 0.01 $, $ a_3 = 0.08 $, $ \\sigma_{3}^{\\mathrm{out}} = 0.02 $, $ a_{0,3} = 0.40 $, $ T_{0,3} = 500 $.\n4. Group $ g = 4 $ (edge case, high anisotropy baseline): $ s_{0,4} = 0.30 $, $ \\eta_4 = 0.02 $, $ a_4 = 0.05 $, $ \\sigma_{4}^{\\mathrm{out}} = 0.00 $, $ a_{0,4} = 0.95 $, $ T_{0,4} = 10000 $.\n\nFor each test case, produce the following four results:\n- The value of $ \\Sigma_{s,1,g \\to g}(T) $ at $ T = 600 \\,\\mathrm{K} $ (a float in $ \\mathrm{cm}^{-1} $).\n- The maximum absolute consistency error for the absorption cross section across the temperature grid, defined as the maximum over $ T $ of $ \\left| \\Sigma_{a,g}(T) - \\left( \\Sigma_{tr,g}(T) - \\tilde{\\Sigma}_{s,0,g \\to g}(T) - \\sigma_{g}^{\\mathrm{out}} \\right) \\right| $.\n- A boolean indicating whether $ \\tilde{\\Sigma}_{s,0,g \\to g}(T) $ is monotone across $ T = 300, 400, \\ldots, 1200 \\,\\mathrm{K} $ when evaluated via the shape-preserving interpolant.\n- A boolean indicating whether $ \\Sigma_{tr,g}(T) $ is monotone across $ T = 300, 400, \\ldots, 1200 \\,\\mathrm{K} $ when evaluated via the shape-preserving interpolant.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r11,r12,r13,r14,r21,r22,r23,r24,r31,r32,r33,r34,r41,r42,r43,r44]\"), where $ r_{g1} $ is the value of $ \\Sigma_{s,1,g \\to g}(600 \\,\\mathrm{K}) $, $ r_{g2} $ is the maximum absolute consistency error for group $ g $, $ r_{g3} $ is the monotonicity boolean for $ \\tilde{\\Sigma}_{s,0,g \\to g}(T) $, and $ r_{g4} $ is the monotonicity boolean for $ \\Sigma_{tr,g}(T) $.",
            "solution": "The problem is scientifically grounded in the principles of nuclear reactor physics, specifically the standard P1 transport correction for multigroup cross sections. The problem provides a complete set of models, parameters, and objectives, allowing for a unique and verifiable solution.\n\nThe objective is to compute and analyze transport-corrected cross sections using a specified set of temperature-dependent models. The standard P1 transport correction is used to account for scattering anisotropy within a diffusion or simplified transport framework. This is achieved by modifying the total and isotropic scattering cross sections to preserve the neutron absorption rate and yield the correct P1 leakage rate.\n\nFirst, we formalize the given physical models for a specific energy group $g$ as a function of temperature $T$. The reference temperature is $T_{\\mathrm{ref}} = 600 \\,\\mathrm{K}$.\n\nThe provided cross-section models are:\n- Isotropic scattering: $\\Sigma_{s,0,g \\to g}(T) = s_{0,g} \\left( 1 + \\eta_g \\ln\\left( \\frac{T}{T_{\\mathrm{ref}}} \\right) \\right)$\n- Absorption: $\\Sigma_{a,g}(T) = a_{g} \\sqrt{ \\frac{T}{T_{\\mathrm{ref}}} }$\n- Total: $\\Sigma_{t,g}(T) = \\Sigma_{a,g}(T) + \\Sigma_{s,0,g \\to g}(T) + \\sigma_{g}^{\\mathrm{out}}$\n- Anisotropy factor: $a_g(T) = \\frac{a_{0,g}}{1 + T / T_{0,g}}$\n- Anisotropic scattering: $\\Sigma_{s,1,g \\to g}(T) = a_g(T) \\, \\Sigma_{s,0,g \\to g}(T)$\n\nThe standard P1 transport correction defines a new set of isotropic cross sections that reproduce the essential physics of the anisotropic system. The corrected quantities are the transport-corrected isotropic scattering cross section, $\\tilde{\\Sigma}_{s,0,g \\to g}(T)$, and the transport cross section, $\\Sigma_{tr,g}(T)$:\n$$ \\tilde{\\Sigma}_{s,0,g \\to g}(T) = \\Sigma_{s,0,g \\to g}(T) - \\Sigma_{s,1,g \\to g}(T) $$\n$$ \\Sigma_{tr,g}(T) = \\Sigma_{t,g}(T) - \\Sigma_{s,1,g \\to g}(T) $$\nThe absorption cross section, $\\Sigma_{a,g}(T)$, and any out-scattering cross sections, $\\sigma_{g}^{\\mathrm{out}}$, are unchanged by this correction.\n\nThe consistency of this correction is verified by checking that the absorption rate is preserved. The absorption cross section can be recovered from the new set of corrected cross sections:\n$$ \\Sigma_{a,g}(T) = \\Sigma_{tr,g}(T) - \\tilde{\\Sigma}_{s,0,g \\to g}(T) - \\sigma_{g}^{\\mathrm{out}} $$\nLet's verify this analytically by substituting the definitions of the corrected quantities:\n$$ \\Sigma_{tr,g} - \\tilde{\\Sigma}_{s,0,g \\to g} - \\sigma_{g}^{\\mathrm{out}} = (\\Sigma_{t,g} - \\Sigma_{s,1,g \\to g}) - (\\Sigma_{s,0,g \\to g} - \\Sigma_{s,1,g \\to g}) - \\sigma_{g}^{\\mathrm{out}} $$\n$$ = \\Sigma_{t,g} - \\Sigma_{s,0,g \\to g} - \\sigma_{g}^{\\mathrm{out}} $$\nFrom the definition of the total cross section, this simplifies to $\\Sigma_{a,g}(T)$. The consistency condition holds.\n\nThe solution proceeds algorithmically for each test case:\n1.  Define the parameters for the test case.\n2.  Establish the temperature grid for calculation: $T_{\\mathrm{grid}} = \\{ 300, 600, 900, 1200 \\} \\,\\mathrm{K}$.\n3.  For each $T \\in T_{\\mathrm{grid}}$, calculate the base cross sections $\\Sigma_{s,0,g \\to g}(T)$, $\\Sigma_{a,g}(T)$, and $\\Sigma_{t,g}(T)$.\n4.  From these, compute the first moment $\\Sigma_{s,1,g \\to g}(T)$ and then the transport-corrected quantities $\\tilde{\\Sigma}_{s,0,g \\to g}(T)$ and $\\Sigma_{tr,g}(T)$. The value of $\\Sigma_{s,1,g \\to g}(600\\,\\mathrm{K})$ is stored.\n5.  The consistency error, $\\left| \\Sigma_{a,g}(T) - \\left( \\Sigma_{tr,g}(T) - \\tilde{\\Sigma}_{s,0,g \\to g}(T) - \\sigma_{g}^{\\mathrm{out}} \\right) \\right|$, is calculated at each grid point. The maximum value over the grid is stored. This error should be zero up to floating-point precision.\n6.  To check for physical plausibility (monotonicity), we construct shape-preserving interpolants for $\\tilde{\\Sigma}_{s,0,g \\to g}(T)$ and $\\Sigma_{tr,g}(T)$ using the computed values on $T_{\\mathrm{grid}}$. The Piecewise Cubic Hermite Interpolating Polynomial (PCHIP) is suitable as it preserves the monotonicity of the input data.\n7.  The monotonicity of these functions is evaluated by checking the sign of the first differences of the interpolated values on a finer grid, $T = 300, 400, \\ldots, 1200 \\,\\mathrm{K}$. A function is monotonic if its first differences are all non-negative or all non-positive.\n    - $\\tilde{\\Sigma}_{s,0,g \\to g}(T) = \\Sigma_{s,0,g \\to g}(T) (1 - a_g(T))$. For $\\eta_g > 0$, $\\Sigma_{s,0}$ is increasing. $a_g(T)$ is decreasing, so $(1-a_g(T))$ is increasing. The product of two positive, increasing functions is increasing. So $\\tilde{\\Sigma}_{s,0,g \\to g}(T)$ should be monotonically increasing.\n    - $\\Sigma_{tr,g}(T) = \\Sigma_{a,g}(T) + \\tilde{\\Sigma}_{s,0,g \\to g}(T) + \\sigma_{g}^{\\mathrm{out}}$. Since $\\Sigma_{a,g}(T)$ is increasing (for $a_g>0$) and $\\tilde{\\Sigma}_{s,0,g \\to g}(T)$ is also expected to be increasing, their sum $\\Sigma_{tr,g}(T)$ should be monotonically increasing.\n8.  The four required results—$\\Sigma_{s,1,g \\to g}(600\\,\\mathrm{K})$, max consistency error, and the two monotonicity booleans—are collected for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import PchipInterpolator\n\ndef solve():\n    \"\"\"\n    Computes transport-corrected cross sections and analyzes their properties\n    for several test cases in nuclear reactor simulation, using the standard\n    P1 transport correction.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # (s0_g, eta_g, a_g_param, sigma_g_out, a0_g, T0_g)\n    test_cases = [\n        (0.17, 0.03, 0.03, 0.01, 0.10, 1200),  # Group 1 (thermal-like)\n        (0.26, 0.02, 0.04, 0.01, 0.20, 1500),  # Group 2 (epithermal-like)\n        (0.42, 0.01, 0.08, 0.02, 0.40, 500),   # Group 3 (fast-like)\n        (0.30, 0.02, 0.05, 0.00, 0.95, 10000), # Group 4 (edge case)\n    ]\n\n    T_ref = 600.0  # K\n    T_grid = np.array([300.0, 600.0, 900.0, 1200.0])\n    T_interp_grid = np.arange(300.0, 1201.0, 100.0)\n\n    final_results = []\n\n    for case in test_cases:\n        s0_g, eta_g, a_g_param, sigma_g_out, a0_g, T0_g = case\n\n        # Define the functions for cross sections based on the models\n        def sigma_s0(T):\n            return s0_g * (1 + eta_g * np.log(np.maximum(T, 1e-6) / T_ref))\n\n        def sigma_a(T):\n            return a_g_param * np.sqrt(T / T_ref)\n\n        def sigma_t(T):\n            return sigma_a(T) + sigma_s0(T) + sigma_g_out\n\n        def aniso_factor(T):\n            return a0_g / (1 + T / T0_g)\n\n        def sigma_s1(T):\n            return aniso_factor(T) * sigma_s0(T)\n\n        # Corrected quantities based on standard P1 transport correction\n        def sigma_s0_tilde(T):\n            return sigma_s0(T) - sigma_s1(T)\n        \n        def sigma_tr(T):\n            return sigma_t(T) - sigma_s1(T)\n\n        # 1. Compute quantities on the coarse temperature grid\n        xs_a_vals = sigma_a(T_grid)\n        xs_s0_tilde_vals = sigma_s0_tilde(T_grid)\n        xs_tr_vals = sigma_tr(T_grid)\n\n        # -- Collect results for this case --\n\n        # Result 1: Value of Sigma_s,1,g->g(T) at T = 600 K\n        result_s1_at_600K = sigma_s1(600.0)\n\n        # Result 2: Maximum absolute consistency error for absorption\n        reconstructed_a = xs_tr_vals - xs_s0_tilde_vals - sigma_g_out\n        consistency_error = np.abs(xs_a_vals - reconstructed_a)\n        max_consistency_error = np.max(consistency_error)\n        \n        # Result 3  4: Monotonicity check using shape-preserving interpolation\n        interp_s0_tilde = PchipInterpolator(T_grid, xs_s0_tilde_vals)\n        interp_tr = PchipInterpolator(T_grid, xs_tr_vals)\n        \n        interp_vals_s0_tilde = interp_s0_tilde(T_interp_grid)\n        interp_vals_tr = interp_tr(T_interp_grid)\n        \n        def is_monotonic(arr):\n            diffs = np.diff(arr)\n            return np.all(diffs >= 0) or np.all(diffs = 0)\n\n        is_s0_tilde_monotonic = is_monotonic(interp_vals_s0_tilde)\n        is_tr_monotonic = is_monotonic(interp_vals_tr)\n\n        # Append the four results for the current case\n        final_results.extend([\n            result_s1_at_600K,\n            max_consistency_error,\n            is_s0_tilde_monotonic,\n            is_tr_monotonic\n        ])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        }
    ]
}