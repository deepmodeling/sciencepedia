{
    "hands_on_practices": [
        {
            "introduction": "The core principle of resonance treatment is self-shielding, where the neutron flux is depressed at resonance energies. This practice uses a simplified rectangular resonance model to demonstrate how the choice of flux weighting function—comparing a naive flat flux to the more physical inverse total cross section—dramatically affects the calculated effective group cross section. This exercise provides a clear, quantitative understanding of why accurate flux modeling is essential for resonance calculations .",
            "id": "4253717",
            "problem": "In subgroup (probability table) methods for resonance treatment in nuclear reactor simulation, the effective group absorption cross section is defined by flux weighting over an energy interval. Consider a homogeneous, infinite medium with a constant background macroscopic total cross section $\\Sigma_{b}$ and a single synthetic $s$-wave absorption resonance. The resonance is represented by a rectangular macroscopic absorption cross section $\\Sigma_{a}(E)$ of height $\\Sigma_{r}$ over the interval $[E_{0}-\\Delta,E_{0}+\\Delta]$, and zero elsewhere. Assume the macroscopic total cross section is $\\Sigma_{t}(E)=\\Sigma_{b}+\\Sigma_{a}(E)$.\n\nLet the energy group be $[E_{1},E_{2}]$ with $E_{1}  E_{0}-\\Delta$ and $E_{2} > E_{0}+\\Delta$, so the resonance lies fully within the group. The effective group absorption cross section under a general positive weighting function $w(E)$ is\n$$\n\\sigma_{g}^{\\text{eff}}(w)=\\frac{\\int_{E_{1}}^{E_{2}}\\Sigma_{a}(E)\\,w(E)\\,dE}{\\int_{E_{1}}^{E_{2}}w(E)\\,dE}.\n$$\nTwo choices of $w(E)$ are considered:\n1. A flat weight $w_{\\text{flat}}(E)=1$.\n2. An inverse total cross section weight $w_{\\text{inv}}(E)=\\frac{1}{\\Sigma_{t}(E)}$, motivated by the infinite-medium slowing-down approximation in which the flux is inversely proportional to the total cross section.\n\nUsing the following numerical data:\n- Background macroscopic total cross section $\\Sigma_{b}=1.0\\,\\text{cm}^{-1}$,\n- Resonance height $\\Sigma_{r}=3.0\\,\\text{cm}^{-1}$,\n- Resonance center $E_{0}=1.0\\,\\text{eV}$,\n- Half-width $\\Delta=0.1\\,\\text{eV}$ (so the resonance spans $[0.9,1.1]\\,\\text{eV}$),\n- Group bounds $E_{1}=0.5\\,\\text{eV}$ and $E_{2}=5.0\\,\\text{eV}$,\n\ncompute the relative error\n$$\n\\delta=\\frac{\\sigma_{g}^{\\text{eff}}(w_{\\text{flat}})-\\sigma_{g}^{\\text{eff}}(w_{\\text{inv}})}{\\sigma_{g}^{\\text{eff}}(w_{\\text{inv}})}.\n$$\nReport $\\delta$ as a dimensionless decimal and round your answer to four significant figures. No units are to be included with the final value.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of nuclear reactor physics, specifically resonance absorption theory. It is well-posed with a complete and consistent set of data and definitions, leading to a unique, verifiable solution.\n\nThe objective is to compute the relative error $\\delta$ between two differently weighted effective group absorption cross sections. The definition of the relative error is:\n$$ \\delta=\\frac{\\sigma_{g}^{\\text{eff}}(w_{\\text{flat}})-\\sigma_{g}^{\\text{eff}}(w_{\\text{inv}})}{\\sigma_{g}^{\\text{eff}}(w_{\\text{inv}})} $$\nThis can be expressed as:\n$$ \\delta = \\frac{\\sigma_{g}^{\\text{eff}}(w_{\\text{flat}})}{\\sigma_{g}^{\\text{eff}}(w_{\\text{inv}})} - 1 $$\nTo calculate $\\delta$, we must first determine the two effective cross sections, $\\sigma_{g}^{\\text{eff}}(w_{\\text{flat}})$ and $\\sigma_{g}^{\\text{eff}}(w_{\\text{inv}})$.\n\nThe macroscopic absorption cross section $\\Sigma_{a}(E)$ is given as a rectangular function:\n$$\n\\Sigma_{a}(E) =\n\\begin{cases}\n\\Sigma_{r}  \\text{for } E \\in [E_{0}-\\Delta, E_{0}+\\Delta] \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nThe macroscopic total cross section is $\\Sigma_{t}(E) = \\Sigma_{b} + \\Sigma_{a}(E)$.\n\nFirst, we compute the effective group absorption cross section using a flat weighting function, $w_{\\text{flat}}(E)=1$.\n$$ \\sigma_{g}^{\\text{eff}}(w_{\\text{flat}}) = \\frac{\\int_{E_{1}}^{E_{2}}\\Sigma_{a}(E) \\cdot 1 \\,dE}{\\int_{E_{1}}^{E_{2}} 1 \\,dE} $$\nThe integral in the numerator is non-zero only over the resonance width, $2\\Delta$.\n$$ \\int_{E_{1}}^{E_{2}}\\Sigma_{a}(E)\\,dE = \\int_{E_{0}-\\Delta}^{E_{0}+\\Delta}\\Sigma_{r}\\,dE = \\Sigma_{r} \\cdot ((E_{0}+\\Delta) - (E_{0}-\\Delta)) = 2\\Delta\\Sigma_{r} $$\nThe integral in the denominator is the width of the energy group.\n$$ \\int_{E_{1}}^{E_{2}} 1 \\,dE = E_{2} - E_{1} $$\nThus, the flat-weighted effective cross section is:\n$$ \\sigma_{g}^{\\text{eff}}(w_{\\text{flat}}) = \\frac{2\\Delta\\Sigma_{r}}{E_{2}-E_{1}} $$\nSubstituting the given numerical values: $\\Sigma_{r}=3.0\\,\\text{cm}^{-1}$, $\\Delta=0.1\\,\\text{eV}$, $E_{1}=0.5\\,\\text{eV}$, and $E_{2}=5.0\\,\\text{eV}$.\n$$ \\sigma_{g}^{\\text{eff}}(w_{\\text{flat}}) = \\frac{2 \\cdot (0.1) \\cdot (3.0)}{5.0 - 0.5} = \\frac{0.6}{4.5} = \\frac{6}{45} = \\frac{2}{15}\\,\\text{cm}^{-1} $$\n\nNext, we compute the effective group absorption cross section using the inverse total cross section weighting function, $w_{\\text{inv}}(E) = 1/\\Sigma_{t}(E)$.\n$$ \\sigma_{g}^{\\text{eff}}(w_{\\text{inv}}) = \\frac{\\int_{E_{1}}^{E_{2}}\\Sigma_{a}(E)\\,\\frac{1}{\\Sigma_{t}(E)}\\,dE}{\\int_{E_{1}}^{E_{2}}\\frac{1}{\\Sigma_{t}(E)}\\,dE} = \\frac{\\int_{E_{1}}^{E_{2}}\\frac{\\Sigma_{a}(E)}{\\Sigma_{b}+\\Sigma_{a}(E)}\\,dE}{\\int_{E_{1}}^{E_{2}}\\frac{1}{\\Sigma_{b}+\\Sigma_{a}(E)}\\,dE} $$\nFor the numerator, the integrand is non-zero only within the resonance region $[E_{0}-\\Delta, E_{0}+\\Delta]$, where $\\Sigma_{a}(E) = \\Sigma_{r}$.\n$$ \\int_{E_{1}}^{E_{2}}\\frac{\\Sigma_{a}(E)}{\\Sigma_{b}+\\Sigma_{a}(E)}\\,dE = \\int_{E_{0}-\\Delta}^{E_{0}+\\Delta}\\frac{\\Sigma_{r}}{\\Sigma_{b}+\\Sigma_{r}}\\,dE = \\frac{\\Sigma_{r}}{\\Sigma_{b}+\\Sigma_{r}} \\cdot (2\\Delta) = \\frac{2\\Delta\\Sigma_{r}}{\\Sigma_{b}+\\Sigma_{r}} $$\nFor the denominator, we must split the integral into regions outside and inside the resonance.\n$$ \\int_{E_{1}}^{E_{2}}\\frac{dE}{\\Sigma_{t}(E)} = \\int_{E_{1}}^{E_{0}-\\Delta}\\frac{dE}{\\Sigma_{b}} + \\int_{E_{0}-\\Delta}^{E_{0}+\\Delta}\\frac{dE}{\\Sigma_{b}+\\Sigma_{r}} + \\int_{E_{0}+\\Delta}^{E_{2}}\\frac{dE}{\\Sigma_{b}} $$\n$$ = \\frac{1}{\\Sigma_{b}}((E_{0}-\\Delta)-E_{1}) + \\frac{1}{\\Sigma_{b}+\\Sigma_{r}}(2\\Delta) + \\frac{1}{\\Sigma_{b}}(E_{2}-(E_{0}+\\Delta)) $$\n$$ = \\frac{1}{\\Sigma_{b}}(E_{2}-E_{1}-2\\Delta) + \\frac{2\\Delta}{\\Sigma_{b}+\\Sigma_{r}} $$\nCombining the numerator and denominator gives the expression for $\\sigma_{g}^{\\text{eff}}(w_{\\text{inv}})$:\n$$ \\sigma_{g}^{\\text{eff}}(w_{\\text{inv}}) = \\frac{\\frac{2\\Delta\\Sigma_{r}}{\\Sigma_{b}+\\Sigma_{r}}}{\\frac{E_{2}-E_{1}-2\\Delta}{\\Sigma_{b}} + \\frac{2\\Delta}{\\Sigma_{b}+\\Sigma_{r}}} $$\nSubstituting the numerical values: $\\Sigma_{b}=1.0\\,\\text{cm}^{-1}$ and the values used previously.\nThe numerator is:\n$$ \\frac{2(0.1)(3.0)}{1.0+3.0} = \\frac{0.6}{4.0} = 0.15 $$\nThe denominator is:\n$$ \\frac{5.0-0.5-2(0.1)}{1.0} + \\frac{2(0.1)}{1.0+3.0} = \\frac{4.3}{1.0} + \\frac{0.2}{4.0} = 4.3 + 0.05 = 4.35 $$\nSo, the inverse-weighted effective cross section is:\n$$ \\sigma_{g}^{\\text{eff}}(w_{\\text{inv}}) = \\frac{0.15}{4.35} = \\frac{15}{435} = \\frac{3 \\cdot 5}{3 \\cdot 145} = \\frac{5}{145} = \\frac{1}{29}\\,\\text{cm}^{-1} $$\nThe positive difference between $\\sigma_{g}^{\\text{eff}}(w_{\\text{flat}})$ and $\\sigma_{g}^{\\text{eff}}(w_{\\text{inv}})$ reflects the physical phenomenon of resonance self-shielding, where the flux depression within the resonance region reduces the effective absorption rate compared to a flat-flux assumption.\n\nFinally, we compute the relative error $\\delta$.\n$$ \\delta = \\frac{\\sigma_{g}^{\\text{eff}}(w_{\\text{flat}})}{\\sigma_{g}^{\\text{eff}}(w_{\\text{inv}})} - 1 = \\frac{2/15}{1/29} - 1 = \\frac{2 \\cdot 29}{15} - 1 = \\frac{58}{15} - \\frac{15}{15} = \\frac{43}{15} $$\nTo provide the decimal value rounded to four significant figures:\n$$ \\delta = \\frac{43}{15} \\approx 2.86666... $$\nRounding to four significant figures yields $2.867$.",
            "answer": "$$\\boxed{2.867}$$"
        },
        {
            "introduction": "Subgroup methods approximate the continuous, complex energy dependence of cross sections with a discrete set of representative values. This exercise demonstrates how to construct a simple two-subgroup representation by matching the key statistical moments—the mean and variance—of the inverse total cross section, which are directly related to the flux-weighted average reaction rates. You will then use this subgroup model to determine an equivalent background cross section, a parameter crucial for many reactor physics calculations .",
            "id": "4253714",
            "problem": "Consider a homogeneous mixture in a single resolved-resonance energy group $g$ that contains a single resonant absorber and a smooth nonresonant background. Assume the narrow resonance approximation, so that the within-group flux shape is proportional to the inverse of the total macroscopic cross section, i.e., $\\phi(E) \\propto 1/\\Sigma_{t}(E)$, where $\\Sigma_{t}(E) = B_g + \\sigma_{r}(E)$, $B_g$ is the nonresonant background macroscopic cross section (excluding the resonant nuclide), and $\\sigma_{r}(E)$ is the resonant macroscopic cross section of the absorber. A high-fidelity fine-energy calculation over the group yields the following group statistics for the random variable $X \\equiv 1/\\Sigma_{t}(E)$ under lethargy weighting: mean $\\mu = 1.2\\,\\mathrm{cm}$ and variance $s^2 = 0.09\\,\\mathrm{cm}^2$. \n\n1) Construct a two-subgroup discrete representation for $X$ with two atoms $\\{x_{1}, x_{2}\\}$ and equal probabilities that reproduces the given mean and variance. From these, compute the corresponding subgroup total macroscopic cross sections $\\Sigma_{t,1} = 1/x_{1}$ and $\\Sigma_{t,2} = 1/x_{2}$.\n\n2) Let the nonresonant background be $B_g = 0.4\\,\\mathrm{cm}^{-1}$ and the group-averaged resonant macroscopic cross section be $\\bar{\\sigma}_{r} = 0.5\\,\\mathrm{cm}^{-1}$. Define the equivalent background cross section $B_g^{\\mathrm{eq}}$ as the constant such that replacing the fine-energy flux shape by a single-valued approximation proportional to $1/\\big(B_g^{\\mathrm{eq}} + \\bar{\\sigma}_{r}\\big)$ preserves the group-averaged inverse total cross section (i.e., it yields the same mean free path as the fine-energy or subgroup description). Compute $B_g^{\\mathrm{eq}}$ in $\\mathrm{cm}^{-1}$.\n\nExpress the final numerical value of $B_g^{\\mathrm{eq}}$ in $\\mathrm{cm}^{-1}$ and round your answer to four significant figures.",
            "solution": "The problem is divided into two parts. First, we must construct a two-subgroup discrete representation for the random variable $X \\equiv 1/\\Sigma_{t}(E)$ using its given mean and variance. Second, we must use this information to compute an equivalent background cross section $B_g^{\\mathrm{eq}}$ based on a specified equivalence condition.\n\nPart 1: Two-Subgroup Representation\n\nLet the random variable be $X \\equiv 1/\\Sigma_{t}(E)$. We are given its mean $\\mu$ and variance $s^2$ from a high-fidelity continuous-energy calculation:\n$$ \\mu = 1.2\\,\\mathrm{cm} $$\n$$ s^2 = 0.09\\,\\mathrm{cm}^2 $$\nThe standard deviation $s$ is the square root of the variance:\n$$ s = \\sqrt{s^2} = \\sqrt{0.09\\,\\mathrm{cm}^2} = 0.3\\,\\mathrm{cm} $$\nWe are asked to construct a two-subgroup discrete representation for $X$ with two values $\\{x_1, x_2\\}$ and equal probabilities $p_1 = p_2 = 1/2$. This representation must reproduce the given mean and variance.\n\nThe mean of the discrete distribution is given by:\n$$ \\mu = \\sum_{i=1}^{2} p_i x_i = p_1 x_1 + p_2 x_2 = \\frac{1}{2}x_1 + \\frac{1}{2}x_2 $$\nSubstituting the value of $\\mu$:\n$$ 1.2 = \\frac{1}{2}(x_1 + x_2) \\implies x_1 + x_2 = 2 \\times 1.2 = 2.4 $$\n\nThe variance of the discrete distribution is given by:\n$$ s^2 = \\sum_{i=1}^{2} p_i (x_i - \\mu)^2 = p_1(x_1 - \\mu)^2 + p_2(x_2 - \\mu)^2 = \\frac{1}{2}\\left[(x_1 - \\mu)^2 + (x_2 - \\mu)^2\\right] $$\nSubstituting the value of $s^2$:\n$$ 0.09 = \\frac{1}{2}\\left[(x_1 - 1.2)^2 + (x_2 - 1.2)^2\\right] $$\n$$ 0.18 = (x_1 - 1.2)^2 + (x_2 - 1.2)^2 $$\nWe now have a system of two equations with two unknowns, $x_1$ and $x_2$:\n1) $x_1 + x_2 = 2.4$\n2) $(x_1 - 1.2)^2 + (x_2 - 1.2)^2 = 0.18$\n\nFrom equation (1), we can express $x_2$ in terms of $x_1$: $x_2 = 2.4 - x_1$.\nSubstitute this into equation (2):\n$$ (x_1 - 1.2)^2 + ((2.4 - x_1) - 1.2)^2 = 0.18 $$\n$$ (x_1 - 1.2)^2 + (1.2 - x_1)^2 = 0.18 $$\n$$ (x_1 - 1.2)^2 + (-(x_1 - 1.2))^2 = 0.18 $$\n$$ 2(x_1 - 1.2)^2 = 0.18 $$\n$$ (x_1 - 1.2)^2 = 0.09 $$\nTaking the square root of both sides gives:\n$$ x_1 - 1.2 = \\pm\\sqrt{0.09} = \\pm 0.3 $$\nThis gives two possible values for $x_1$:\n$$ x_1 = 1.2 + 0.3 = 1.5\\,\\mathrm{cm} \\quad \\text{or} \\quad x_1 = 1.2 - 0.3 = 0.9\\,\\mathrm{cm} $$\nIf we choose $x_1 = 1.5\\,\\mathrm{cm}$, then $x_2 = 2.4 - 1.5 = 0.9\\,\\mathrm{cm}$.\nIf we choose $x_1 = 0.9\\,\\mathrm{cm}$, then $x_2 = 2.4 - 0.9 = 1.5\\,\\mathrm{cm}$.\nThe set of values $\\{x_1, x_2\\}$ is $\\{0.9\\,\\mathrm{cm}, 1.5\\,\\mathrm{cm}\\}$. This is a general property for a two-point symmetric distribution: the points are located at $\\mu \\pm s$.\n\nThe corresponding subgroup total macroscopic cross sections are $\\Sigma_{t,1} = 1/x_1$ and $\\Sigma_{t,2} = 1/x_2$. Let's assign $x_1 = 1.5\\,\\mathrm{cm}$ and $x_2 = 0.9\\,\\mathrm{cm}$.\n$$ \\Sigma_{t,1} = \\frac{1}{x_1} = \\frac{1}{1.5\\,\\mathrm{cm}} = \\frac{2}{3}\\,\\mathrm{cm}^{-1} \\approx 0.6667\\,\\mathrm{cm}^{-1} $$\n$$ \\Sigma_{t,2} = \\frac{1}{x_2} = \\frac{1}{0.9\\,\\mathrm{cm}} = \\frac{10}{9}\\,\\mathrm{cm}^{-1} \\approx 1.1111\\,\\mathrm{cm}^{-1} $$\n\nPart 2: Equivalent Background Cross Section\n\nThe problem defines the equivalent background cross section $B_g^{\\mathrm{eq}}$ as the constant value that preserves the group-averaged inverse total cross section. The group-averaged inverse total cross section is precisely the mean of the random variable $X$, which is $\\mu$.\n$$ \\langle X \\rangle = \\left\\langle \\frac{1}{\\Sigma_t(E)} \\right\\rangle = \\mu = 1.2\\,\\mathrm{cm} $$\nThe equivalence condition states that this mean value is reproduced by a simplified model where the inverse total cross section is approximated as a single value, $1/(B_g^{\\mathrm{eq}} + \\bar{\\sigma}_{r})$. Thus, the defining equation for $B_g^{\\mathrm{eq}}$ is:\n$$ \\mu = \\frac{1}{B_g^{\\mathrm{eq}} + \\bar{\\sigma}_{r}} $$\nWe are given the values for $\\mu$ and the group-averaged resonant macroscopic cross section $\\bar{\\sigma}_{r}$:\n$$ \\mu = 1.2\\,\\mathrm{cm} $$\n$$ \\bar{\\sigma}_{r} = 0.5\\,\\mathrm{cm}^{-1} $$\nWe rearrange the equation to solve for $B_g^{\\mathrm{eq}}$:\n$$ B_g^{\\mathrm{eq}} + \\bar{\\sigma}_{r} = \\frac{1}{\\mu} $$\n$$ B_g^{\\mathrm{eq}} = \\frac{1}{\\mu} - \\bar{\\sigma}_{r} $$\nNow, we substitute the numerical values:\n$$ B_g^{\\mathrm{eq}} = \\frac{1}{1.2\\,\\mathrm{cm}} - 0.5\\,\\mathrm{cm}^{-1} $$\nLet's perform the calculation.\n$$ \\frac{1}{1.2} = \\frac{1}{12/10} = \\frac{10}{12} = \\frac{5}{6} $$\nSo,\n$$ B_g^{\\mathrm{eq}} = \\left(\\frac{5}{6} - 0.5\\right) \\,\\mathrm{cm}^{-1} = \\left(\\frac{5}{6} - \\frac{1}{2}\\right) \\,\\mathrm{cm}^{-1} $$\nTo subtract the fractions, we find a common denominator, which is $6$:\n$$ B_g^{\\mathrm{eq}} = \\left(\\frac{5}{6} - \\frac{3}{6}\\right) \\,\\mathrm{cm}^{-1} = \\frac{2}{6}\\,\\mathrm{cm}^{-1} = \\frac{1}{3}\\,\\mathrm{cm}^{-1} $$\nThe exact value of $B_g^{\\mathrm{eq}}$ is $1/3\\,\\mathrm{cm}^{-1}$. The problem requires the final numerical value to be rounded to four significant figures.\n$$ B_g^{\\mathrm{eq}} = \\frac{1}{3} \\approx 0.333333... \\,\\mathrm{cm}^{-1} $$\nRounding to four significant figures, we get:\n$$ B_g^{\\mathrm{eq}} = 0.3333\\,\\mathrm{cm}^{-1} $$\nNote that the value of the nonresonant background $B_g = 0.4\\,\\mathrm{cm}^{-1}$ was not needed for this calculation, as the definition of $B_g^{\\mathrm{eq}}$ provided in the problem statement depends only on $\\mu$ and $\\bar{\\sigma}_{r}$.",
            "answer": "$$\\boxed{0.3333}$$"
        },
        {
            "introduction": "In practice, generating subgroup probability tables involves not just the distribution of individual cross sections, but also their correlations. This hands-on coding problem illustrates the significant errors that can arise when the statistical correlation between absorption and scattering cross sections is ignored. By comparing reaction rates from correlated and uncorrelated models, you will quantify the bias and gain appreciation for the importance of preserving inter-channel dependencies in high-fidelity simulations .",
            "id": "4253649",
            "problem": "Consider a single energy group resonance self-shielding approximation in nuclear reactor simulation where cross sections are represented by Probability Tables (PT). In the subgroup method, reaction channel cross sections are modeled as random variables. Let the absorption cross section be $\\sigma_a$ and the scattering cross section be $\\sigma_s$, with the total cross section $\\sigma_t = \\sigma_a + \\sigma_s$. Assume a homogeneous medium with a fixed external source normalized to unity and a background removal cross section $\\Sigma_b > 0$ that represents leakage and out-scatter effects. Under this approximation, the flux weighting function is taken to be $w(\\sigma_t) = 1 / (\\sigma_t + \\Sigma_b)$, a widely used form in resonance self-shielding to capture the inverse dependence of flux on the attenuation strength.\n\nThe absorption rate per unit atom density and unit source normalization in this single group is defined as the expectation\n$$\nR_a = \\mathbb{E}\\left[ \\sigma_a \\, w(\\sigma_t) \\right] = \\mathbb{E}\\left[ \\frac{\\sigma_a}{\\sigma_a + \\sigma_s + \\Sigma_b} \\right],\n$$\nwhere the expectation is taken over the joint distribution of $\\sigma_a$ and $\\sigma_s$.\n\nYou are asked to demonstrate the effect of neglecting correlations among reaction channels by comparing two models:\n\n- Correlated PT: $(\\sigma_a, \\sigma_s)$ are jointly distributed across two microstates that preserve inter-channel correlations. State $1$ occurs with probability $p$, having parameters $\\sigma_a^{(1)}$ and $\\sigma_s^{(1)}$. State $2$ occurs with probability $1 - p$, having parameters $\\sigma_a^{(2)}$ and $\\sigma_s^{(2)}$. In this model, the joint distribution is supported only on the two correlated pairs $(\\sigma_a^{(1)}, \\sigma_s^{(1)})$ and $(\\sigma_a^{(2)}, \\sigma_s^{(2)})$.\n\n- Uncorrelated PT: $\\sigma_a$ and $\\sigma_s$ are sampled independently from their marginal distributions implied by the correlated PT, i.e., $\\sigma_a \\in \\{ \\sigma_a^{(1)}, \\sigma_a^{(2)} \\}$ with probabilities $p$ and $1 - p$, independently of $\\sigma_s \\in \\{ \\sigma_s^{(1)}, \\sigma_s^{(2)} \\}$ with the same probabilities $p$ and $1 - p$. The joint support then comprises four combinations.\n\nFor each case, define the bias in the absorption rate due to ignoring correlations as\n$$\n\\delta = \\frac{R_a^{\\text{uncorr}} - R_a^{\\text{corr}}}{R_a^{\\text{corr}}},\n$$\nexpressed as a decimal number.\n\nYour task is to write a complete, runnable program that computes $\\delta$ for the following five test cases. All quantities are dimensionless for the purpose of this calculation, and the final results must be provided as decimal numbers.\n\nTest Suite (each case is a tuple of $(p, \\sigma_a^{(1)}, \\sigma_s^{(1)}, \\sigma_a^{(2)}, \\sigma_s^{(2)}, \\Sigma_b)$):\n\n- Case 1 (general contrast): $(0.3, 120.0, 8.0, 6.0, 22.0, 30.0)$\n- Case 2 (near-zero background): $(0.5, 200.0, 15.0, 5.0, 25.0, 0.001)$\n- Case 3 (dominant high-absorption state): $(0.8, 80.0, 12.0, 12.0, 18.0, 10.0)$\n- Case 4 (nearly constant total cross section): $(0.5, 50.0, 50.0, 30.0, 70.0, 40.0)$\n- Case 5 (rare but intense resonance): $(0.1, 300.0, 10.0, 10.0, 30.0, 20.0)$\n\nProgram Requirements:\n\n- Implement the computation of $R_a^{\\text{corr}}$ from the correlated PT model and $R_a^{\\text{uncorr}}$ from the uncorrelated PT model, strictly following the definitions above from first principles.\n- For each test case, compute $\\delta$ as specified.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5]$). Each $\\delta_i$ must be a decimal number.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of nuclear reactor physics, specifically resonance self-shielding theory using subgroup methods. It is well-posed, with all necessary data and definitions provided for a unique, deterministic solution. The problem is objective and uses standard, unambiguous terminology. We may therefore proceed with a solution.\n\nThe objective is to compute the relative bias, $\\delta$, introduced in the single-group absorption rate, $R_a$, by neglecting the statistical correlation between the absorption cross section, $\\sigma_a$, and the scattering cross section, $\\sigma_s$. This bias is defined as:\n$$\n\\delta = \\frac{R_a^{\\text{uncorr}} - R_a^{\\text{corr}}}{R_a^{\\text{corr}}}\n$$\nwhere $R_a^{\\text{corr}}$ and $R_a^{\\text{uncorr}}$ are the absorption rates calculated using correlated and uncorrelated Probability Tables (PTs), respectively. The absorption rate is given by the expectation of the product of the absorption cross section and a flux weighting function, $w(\\sigma_t) = 1/(\\sigma_t + \\Sigma_b)$, where $\\sigma_t = \\sigma_a + \\sigma_s$ is the total cross section and $\\Sigma_b$ is a background cross section.\n$$\nR_a = \\mathbb{E}\\left[ \\frac{\\sigma_a}{\\sigma_a + \\sigma_s + \\Sigma_b} \\right]\n$$\nWe will now derive the expressions for $R_a^{\\text{corr}}$ and $R_a^{\\text{uncorr}}$ based on the provided models.\n\n**1. Correlated Probability Table (PT) Model**\n\nIn this model, the joint distribution of $(\\sigma_a, \\sigma_s)$ is discrete and supported on two specific microstates:\n-   State 1: $(\\sigma_a^{(1)}, \\sigma_s^{(1)})$ with probability $p$.\n-   State 2: $(\\sigma_a^{(2)}, \\sigma_s^{(2)})$ with probability $1 - p$.\n\nThe expectation, $R_a^{\\text{corr}}$, is calculated by summing the value of the function $\\frac{\\sigma_a}{\\sigma_a + \\sigma_s + \\Sigma_b}$ for each state, weighted by the probability of that state.\n$$\nR_a^{\\text{corr}} = p \\cdot \\left( \\frac{\\sigma_a^{(1)}}{\\sigma_a^{(1)} + \\sigma_s^{(1)} + \\Sigma_b} \\right) + (1 - p) \\cdot \\left( \\frac{\\sigma_a^{(2)}}{\\sigma_a^{(2)} + \\sigma_s^{(2)} + \\Sigma_b} \\right)\n$$\nThis formula directly accounts for the correlation, as each $\\sigma_a^{(i)}$ value is uniquely paired with its corresponding $\\sigma_s^{(i)}$ value.\n\n**2. Uncorrelated Probability Table (PT) Model**\n\nThis model assumes that $\\sigma_a$ and $\\sigma_s$ are independent random variables. Their marginal distributions are derived from the correlated model:\n-   $P(\\sigma_a = \\sigma_a^{(1)}) = p$ and $P(\\sigma_a = \\sigma_a^{(2)}) = 1 - p$.\n-   $P(\\sigma_s = \\sigma_s^{(1)}) = p$ and $P(\\sigma_s = \\sigma_s^{(2)}) = 1 - p$.\n\nSince independence is assumed, the joint probability of any pair $(\\sigma_a^{(i)}, \\sigma_s^{(j)})$ is the product of their marginal probabilities, $P(\\sigma_a=\\sigma_a^{(i)}, \\sigma_s=\\sigma_s^{(j)}) = P(\\sigma_a=\\sigma_a^{(i)})P(\\sigma_s=\\sigma_s^{(j)})$. This creates a joint distribution supported on four microstates:\n-   State (1,1): $(\\sigma_a^{(1)}, \\sigma_s^{(1)})$ with probability $p \\cdot p = p^2$.\n-   State (1,2): $(\\sigma_a^{(1)}, \\sigma_s^{(2)})$ with probability $p \\cdot (1 - p)$.\n-   State (2,1): $(\\sigma_a^{(2)}, \\sigma_s^{(1)})$ with probability $(1 - p) \\cdot p$.\n-   State (2,2): $(\\sigma_a^{(2)}, \\sigma_s^{(2)})$ with probability $(1 - p) \\cdot (1 - p) = (1 - p)^2$.\n\nThe expectation, $R_a^{\\text{uncorr}}$, is the sum over these four states, weighted by their respective probabilities:\n$$\nR_a^{\\text{uncorr}} = p^2 \\left( \\frac{\\sigma_a^{(1)}}{\\sigma_a^{(1)} + \\sigma_s^{(1)} + \\Sigma_b} \\right) + p(1-p) \\left( \\frac{\\sigma_a^{(1)}}{\\sigma_a^{(1)} + \\sigma_s^{(2)} + \\Sigma_b} \\right) + (1-p)p \\left( \\frac{\\sigma_a^{(2)}}{\\sigma_a^{(2)} + \\sigma_s^{(1)} + \\Sigma_b} \\right) + (1-p)^2 \\left( \\frac{\\sigma_a^{(2)}}{\\sigma_a^{(2)} + \\sigma_s^{(2)} + \\Sigma_b} \\right)\n$$\nThis calculation mixes all possible pairings of absorption and scattering cross sections, thereby losing the original correlation.\n\n**3. Algorithmic Implementation**\n\nThe computation of $\\delta$ for each test case proceeds as follows:\n1.  For each test case, the parameters $(p, \\sigma_a^{(1)}, \\sigma_s^{(1)}, \\sigma_a^{(2)}, \\sigma_s^{(2)}, \\Sigma_b)$ are provided.\n2.  The value of $R_a^{\\text{corr}}$ is computed using its derived formula.\n3.  The value of $R_a^{\\text{uncorr}}$ is computed using its derived formula, summing over the four possible uncorrelated states.\n4.  The relative bias $\\delta$ is calculated. If $R_a^{\\text{corr}} = 0$, the bias is undefined; however, the given test data with $\\sigma_a^{(i)} > 0$ and weights $p \\in (0,1)$ ensures $R_a^{\\text{corr}} > 0$.\n5.  This process is repeated for all test cases, and the results are collected into a list. The final program will implement these steps.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the bias in absorption rate due to ignoring correlations \n    between absorption and scattering cross sections in a subgroup model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (p, sigma_a^(1), sigma_s^(1), sigma_a^(2), sigma_s^(2), Sigma_b).\n    test_cases = [\n        (0.3, 120.0, 8.0, 6.0, 22.0, 30.0),    # Case 1\n        (0.5, 200.0, 15.0, 5.0, 25.0, 0.001),  # Case 2\n        (0.8, 80.0, 12.0, 12.0, 18.0, 10.0),   # Case 3\n        (0.5, 50.0, 50.0, 30.0, 70.0, 40.0),   # Case 4\n        (0.1, 300.0, 10.0, 10.0, 30.0, 20.0),   # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        p, sa1, ss1, sa2, ss2, Sigma_b = case\n        \n        # 1. Calculate the absorption rate for the Correlated PT model (R_a^corr)\n        # The distribution has two states: (sa1, ss1) with probability p, and (sa2, ss2) with probability (1-p).\n        term1_corr = sa1 / (sa1 + ss1 + Sigma_b)\n        term2_corr = sa2 / (sa2 + ss2 + Sigma_b)\n        \n        Ra_corr = p * term1_corr + (1 - p) * term2_corr\n        \n        # 2. Calculate the absorption rate for the Uncorrelated PT model (R_a^uncorr)\n        # The joint distribution has four states based on independent marginals.\n        # Probabilities: P(sa1, ss1) = p*p, P(sa1, ss2) = p*(1-p), P(sa2, ss1) = (1-p)*p, P(sa2, ss2) = (1-p)*(1-p)\n        \n        # Term for state (sa1, ss1)\n        term_11 = sa1 / (sa1 + ss1 + Sigma_b)\n        # Term for state (sa1, ss2)\n        term_12 = sa1 / (sa1 + ss2 + Sigma_b)\n        # Term for state (sa2, ss1)\n        term_21 = sa2 / (sa2 + ss1 + Sigma_b)\n        # Term for state (sa2, ss2)\n        term_22 = sa2 / (sa2 + ss2 + Sigma_b)\n        \n        Ra_uncorr = (p * p) * term_11 + \\\n                    (p * (1 - p)) * term_12 + \\\n                    ((1 - p) * p) * term_21 + \\\n                    ((1 - p) * (1 - p)) * term_22\n        \n        # 3. Compute the relative bias delta\n        # The case Ra_corr = 0 is not encountered with the given test data.\n        if Ra_corr == 0:\n            delta = float('inf') if Ra_uncorr > 0 else 0.0\n        else:\n            delta = (Ra_uncorr - Ra_corr) / Ra_corr\n            \n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    # Example format: [-0.0123,0.1234,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}