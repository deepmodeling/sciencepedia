{
    "hands_on_practices": [
        {
            "introduction": "To understand how a resonance is shielded, we must first master the fundamental properties of the resonance itself. This exercise takes you back to first principles, using the single-level Breit-Wigner formula which is the cornerstone for describing resonant behavior in nuclear cross sections. By deriving the peak cross section and the total integrated area of an isolated resonance, you will build an analytical foundation for quantifying the intrinsic strength of a resonance, a key factor that determines the magnitude of self-shielding effects. ",
            "id": "4246019",
            "problem": "In a homogenized, infinitely dilute absorber-moderator mixture used to study resonance self-shielding in nuclear reactor simulation, consider an isolated, single resonance associated with an $s$-wave (orbital angular momentum $\\ell = 0$) compound-nucleus level at energy $E_{r}$. The resonance has a total width $\\,\\Gamma\\,$ and spin statistical factor $\\,g\\,$. The total width decomposes into a neutron entrance-channel partial width $\\,\\Gamma_{n}\\,$ and an absorption exit-channel partial width $\\,\\Gamma_{a}\\,$ (absorption here includes all non-elastic channels such as radiative capture and, if present, fission), so that $\\,\\Gamma = \\Gamma_{n} + \\Gamma_{a}\\,$. Define the branching fractions $\\,b_{n} \\equiv \\Gamma_{n}/\\Gamma\\,$ and $\\,b_{a} \\equiv \\Gamma_{a}/\\Gamma\\,$, with $\\,b_{n} + b_{a} = 1\\,$. Let the neutron de Broglie wavelength at $E=E_{r}$ be $\\,\\lambda\\,$, and define the corresponding wave number by $\\,k_{r} = 2\\pi/\\lambda\\,$. Assume the resonance is isolated (no interference or background potential scattering), neglect Doppler broadening and instrumental resolution, and treat $\\,k\\,$ as constant across the narrow resonance (equal to $\\,k_{r}$).\n\nStarting from first principles of resonance scattering in compound-nucleus formation and the single-level resonance picture, derive and compute:\n- the peak absorption cross section $\\,\\sigma_{a}^{\\text{peak}}\\,$ at $\\,E=E_{r}\\,$, and\n- the energy-integrated area $\\,\\int_{-\\infty}^{+\\infty} \\sigma_{a}(E)\\, \\mathrm{d}E\\,$.\n\nExpress both results as closed-form analytic expressions in terms of $\\,\\lambda\\,$, $\\,\\Gamma\\,$, $\\,g\\,$, $\\,b_{n}\\,$, and $\\,b_{a}\\,$. Use square meters for cross sections and electronvolts for energies so that the integrated area has units of square meter–electronvolt. Do not substitute numerical values; no rounding is required. Provide your final answer as two expressions in a single row, in the order stated above.",
            "solution": "The problem is found to be valid as it is scientifically grounded in the principles of nuclear resonance theory, is well-posed with a complete and consistent set of parameters, and is formulated objectively. We can therefore proceed with the derivation.\n\nThe derivation starts from the single-level Breit-Wigner formula for the absorption cross section, $\\sigma_a(E)$. For a reaction induced by an incident particle leading to the formation of a compound nucleus at an isolated resonance, the cross section for a specific exit channel (here, absorption, denoted by the subscript '$a$') from an entrance channel (here, the neutron, denoted by '$n$') is given by quantum scattering theory as:\n$$\n\\sigma_a(E) = g \\frac{\\pi}{k^2} \\frac{\\Gamma_n \\Gamma_a}{(E - E_r)^2 + (\\Gamma/2)^2}\n$$\nwhere:\n- $E$ is the energy of the incident neutron.\n- $k$ is the neutron wave number, related to its kinetic energy.\n- $g$ is the spin statistical factor, which accounts for the spins of the neutron, the target nucleus, and the compound nucleus state.\n- $E_r$ is the resonance energy.\n- $\\Gamma$ is the total width of the resonance level, which is the sum of all partial widths.\n- $\\Gamma_n$ is the partial width for the neutron entrance channel (elastic scattering).\n- $\\Gamma_a$ is the partial width for all absorption exit channels (e.g., radiative capture, fission).\n- We are given $\\Gamma = \\Gamma_n + \\Gamma_a$.\n\nThe problem states several simplifying assumptions. The resonance is for an $s$-wave neutron ($\\ell=0$). The neutron wave number $k$ is to be treated as constant across the narrow resonance, equal to its value at the resonance peak, $k_r$. The neutron de Broglie wavelength at $E=E_r$ is $\\lambda$, and the corresponding wave number is defined as $k_r = 2\\pi/\\lambda$. We use this to replace the $k$-dependent term in the formula:\n$$\n\\frac{\\pi}{k^2} \\approx \\frac{\\pi}{k_r^2} = \\frac{\\pi}{(2\\pi/\\lambda)^2} = \\frac{\\pi \\lambda^2}{4\\pi^2} = \\frac{\\lambda^2}{4\\pi}\n$$\nSubstituting this into the Breit-Wigner formula gives the absorption cross section as a function of energy under the given assumptions:\n$$\n\\sigma_a(E) = g \\frac{\\lambda^2}{4\\pi} \\frac{\\Gamma_n \\Gamma_a}{(E - E_r)^2 + (\\Gamma/2)^2}\n$$\n\nFirst, we will compute the peak absorption cross section, $\\sigma_a^{\\text{peak}}$. This is the value of the cross section at the resonance energy, $E = E_r$. At this energy, the denominator of the Lorentzian term $(E - E_r)^2 + (\\Gamma/2)^2$ is minimized:\n$$\n(E_r - E_r)^2 + (\\Gamma/2)^2 = 0^2 + (\\Gamma/2)^2 = \\frac{\\Gamma^2}{4}\n$$\nSubstituting this into the expression for $\\sigma_a(E)$:\n$$\n\\sigma_a^{\\text{peak}} = \\sigma_a(E=E_r) = g \\frac{\\lambda^2}{4\\pi} \\frac{\\Gamma_n \\Gamma_a}{(\\Gamma/2)^2} = g \\frac{\\lambda^2}{4\\pi} \\frac{4 \\Gamma_n \\Gamma_a}{\\Gamma^2} = \\frac{g \\lambda^2}{\\pi} \\frac{\\Gamma_n \\Gamma_a}{\\Gamma^2}\n$$\nThe problem requires the result to be expressed in terms of the branching fractions $b_n \\equiv \\Gamma_n/\\Gamma$ and $b_a \\equiv \\Gamma_a/\\Gamma$. We can rewrite the width-dependent term as:\n$$\n\\frac{\\Gamma_n \\Gamma_a}{\\Gamma^2} = \\left(\\frac{\\Gamma_n}{\\Gamma}\\right) \\left(\\frac{\\Gamma_a}{\\Gamma}\\right) = b_n b_a\n$$\nTherefore, the peak absorption cross section is:\n$$\n\\sigma_a^{\\text{peak}} = \\frac{g \\lambda^2}{\\pi} b_n b_a\n$$\n\nSecond, we will compute the energy-integrated area of the absorption cross section, $\\int_{-\\infty}^{+\\infty} \\sigma_a(E)\\, \\mathrm{d}E$. The problem states to neglect Doppler broadening, so we integrate the pure Lorentzian form of $\\sigma_a(E)$ derived above. Extending the integration limits to $\\pm\\infty$ is a standard approximation for narrow resonances far from zero energy.\n$$\n\\int_{-\\infty}^{+\\infty} \\sigma_a(E)\\, \\mathrm{d}E = \\int_{-\\infty}^{+\\infty} g \\frac{\\lambda^2}{4\\pi} \\frac{\\Gamma_n \\Gamma_a}{(E - E_r)^2 + (\\Gamma/2)^2} \\, \\mathrm{d}E\n$$\nThe terms that do not depend on the integration variable $E$ can be factored out of the integral:\n$$\n\\int_{-\\infty}^{+\\infty} \\sigma_a(E)\\, \\mathrm{d}E = g \\frac{\\lambda^2 \\Gamma_n \\Gamma_a}{4\\pi} \\int_{-\\infty}^{+\\infty} \\frac{1}{(E - E_r)^2 + (\\Gamma/2)^2} \\, \\mathrm{d}E\n$$\nTo solve the integral, we perform a substitution. Let $x = E - E_r$, so $\\mathrm{d}x = \\mathrm{d}E$. The integration limits remain from $-\\infty$ to $+\\infty$. Let $c = \\Gamma/2$. The integral becomes:\n$$\n\\int_{-\\infty}^{+\\infty} \\frac{1}{x^2 + c^2} \\, \\mathrm{d}x = \\left[ \\frac{1}{c} \\arctan\\left(\\frac{x}{c}\\right) \\right]_{-\\infty}^{+\\infty}\n$$\nEvaluating the expression at the limits:\n$$\n\\frac{1}{c} \\left( \\lim_{x\\to\\infty} \\arctan\\left(\\frac{x}{c}\\right) - \\lim_{x\\to-\\infty} \\arctan\\left(\\frac{x}{c}\\right) \\right) = \\frac{1}{c} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{\\pi}{c}\n$$\nSubstituting back $c = \\Gamma/2$, the value of the integral is $\\frac{\\pi}{\\Gamma/2} = \\frac{2\\pi}{\\Gamma}$.\nNow, we substitute this result back into the expression for the integrated area:\n$$\n\\int_{-\\infty}^{+\\infty} \\sigma_a(E)\\, \\mathrm{d}E = g \\frac{\\lambda^2 \\Gamma_n \\Gamma_a}{4\\pi} \\left( \\frac{2\\pi}{\\Gamma} \\right) = \\frac{g \\lambda^2 \\Gamma_n \\Gamma_a}{2\\Gamma}\n$$\nFinally, we express this result in terms of the required variables $\\lambda$, $\\Gamma$, $g$, $b_n$, and $b_a$. We use the definitions $\\Gamma_n = \\Gamma b_n$ and $\\Gamma_a = \\Gamma b_a$:\n$$\n\\frac{g \\lambda^2 \\Gamma_n \\Gamma_a}{2\\Gamma} = \\frac{g \\lambda^2 (\\Gamma b_n)(\\Gamma b_a)}{2\\Gamma} = \\frac{g \\lambda^2 \\Gamma^2 b_n b_a}{2\\Gamma} = \\frac{g \\lambda^2 \\Gamma}{2} b_n b_a\n$$\nThis is the final expression for the energy-integrated absorption cross section.\n\nThe two requested quantities are:\n1. Peak absorption cross section: $\\sigma_a^{\\text{peak}} = \\frac{g \\lambda^2}{\\pi} b_n b_a$\n2. Energy-integrated area: $\\int_{-\\infty}^{+\\infty} \\sigma_a(E)\\, \\mathrm{d}E = \\frac{g \\lambda^2 \\Gamma}{2} b_n b_a$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{g \\lambda^2}{\\pi} b_n b_a & \\frac{g \\lambda^2 \\Gamma}{2} b_n b_a \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "This practice moves from the idealized natural line shape to a more physically realistic scenario by incorporating temperature effects. You will computationally investigate the interplay between Doppler broadening, which spreads the resonance over a wider energy range, and the flux depression that causes self-shielding. By comparing a precise, Doppler-broadened calculation with the widely-used Narrow Resonance Approximation (NRA), you will gain a quantitative understanding of how temperature changes impact effective cross sections and why this is a critical phenomenon in reactor safety analysis. ",
            "id": "4245987",
            "problem": "You are asked to evaluate the impact of the narrow resonance approximation in the context of resonance self-shielding for a single isolated absorption resonance in a moderator-absorber mixture. Work in the energy domain with electronvolts and use the following physically plausible modeling assumptions and definitions.\n\nStart from the following base, which is widely used in slowing-down theory and single-level resonance modeling:\n\n- The single-level resonance absorption cross section is approximated by a Lorentzian centered at energy $E_0$ with full width at half maximum $\\Gamma$ and central height $\\sigma_{\\text{peak}}$ expressed in barns. Writing $\\gamma = \\Gamma/2$, the unbroadened resonant absorption cross section is\n$$\n\\sigma_{\\text{L}}(E) = \\sigma_{\\text{peak}} \\frac{\\gamma^2}{(E - E_0)^2 + \\gamma^2}.\n$$\n\n- Thermal motion of target nuclei introduces Doppler broadening. Modeling the Doppler kernel as a Gaussian in energy with standard deviation $\\sigma_{\\text{D}}$ leads to the Doppler-broadened resonance as the convolution of the Lorentzian with the Gaussian. The resulting profile is the Voigt function. Let $x = E - E_0$. The area-normalized Voigt function is\n$$\nV(x; \\sigma, \\gamma) = \\frac{\\Re\\!\\left[w\\!\\left(\\frac{x + i \\gamma}{\\sigma \\sqrt{2}}\\right)\\right]}{\\sigma \\sqrt{2\\pi}},\n$$\nwhere $w(z)$ is the Fadeeva function and $\\Re[\\cdot]$ denotes the real part. To preserve the resonance area, define the broadened absorption cross section as\n$$\n\\sigma_{\\text{V}}(E) = A_{\\text{L}}\\, V(E - E_0; \\sigma_{\\text{D}}, \\gamma),\n\\quad\\text{with}\\quad\nA_{\\text{L}} = \\pi \\gamma \\sigma_{\\text{peak}}.\n$$\nBy construction, $\\int_{-\\infty}^{\\infty} \\sigma_{\\text{V}}(E)\\, dE = \\int_{-\\infty}^{\\infty} \\sigma_{\\text{L}}(E)\\, dE$, and in the limiting case $\\sigma_{\\text{D}} \\to 0$ one has $\\sigma_{\\text{V}}(E) \\to \\sigma_{\\text{L}}(E)$.\n\n- In a simplified slowing-down regime with a constant background cross section $\\sigma_{\\text{b}}$ (barns) over a narrow energy window containing the resonance, the local neutron flux is inversely proportional to the total cross section. Approximating the total cross section as $\\sigma_{\\text{b}} + \\sigma(E)$ over the resonance window, the self-shielded, flux-weighted effective resonance absorption cross section over an energy interval $[E_{\\text{low}}, E_{\\text{high}}]$ is defined as\n$$\n\\sigma_{\\text{eff}} = \\frac{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\sigma(E)\\, \\phi(E)\\, dE}{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\phi(E)\\, dE},\n\\quad\\text{with}\\quad\n\\phi(E) \\propto \\frac{1}{\\sigma_{\\text{b}} + \\sigma(E)}.\n$$\nAny proportionality constant cancels in the ratio. This provides a first-principles, physically grounded model of self-shielding in the resonance energy range.\n\nDefine the narrow resonance approximation (NRA) for the purpose of this problem as the approximation that neglects Doppler broadening, i.e., uses $\\sigma(E) = \\sigma_{\\text{L}}(E)$ to compute $\\sigma_{\\text{eff}}$. The reference \"numerically broadened self-shielded\" result uses $\\sigma(E) = \\sigma_{\\text{V}}(E)$ with the given Doppler width $\\sigma_{\\text{D}}$.\n\nFor each test case below, compute the relative error of the narrow resonance approximation with respect to the broadened reference, defined as the dimensionless quantity\n$$\n\\varepsilon = \\frac{\\sigma_{\\text{eff}}^{\\text{NRA}} - \\sigma_{\\text{eff}}^{\\text{broadened}}}{\\sigma_{\\text{eff}}^{\\text{broadened}}}.\n$$\n\nAll energies must be treated in electronvolts ($\\mathrm{eV}$). All cross sections must be treated in barns. Temperatures are given in Kelvin ($\\mathrm{K}$) only for context; the Doppler width $\\sigma_{\\text{D}}$ is provided directly in $\\mathrm{eV}$ for each case and must be used as given. Angles do not appear in this problem. Your program must numerically evaluate the required integrals over energy.\n\nTest suite (each tuple is $(E_0, \\Gamma, \\sigma_{\\text{peak}}, \\sigma_{\\text{b}}, \\sigma_{\\text{D}}, E_{\\text{low}}, E_{\\text{high}}, T)$ with units as specified):\n- Case 1 (moderate self-shielding, resolved resonance): $(6.67, 0.025, 5000.0, 2.0, 0.15, 6.0, 7.5, 900)$.\n- Case 2 (large background cross section, reduced self-shielding): $(6.67, 0.025, 5000.0, 100.0, 0.15, 6.0, 7.5, 900)$.\n- Case 3 (no Doppler broadening, check limiting behavior): $(20.0, 0.2, 800.0, 5.0, 0.0, 18.0, 22.0, 300)$.\n- Case 4 (very narrow thermal resonance, strong self-shielding): $(0.3, 0.001, 12000.0, 0.5, 0.05, 0.1, 0.5, 600)$.\n\nYour program should produce a single line of output containing the relative errors for these four cases as a comma-separated list enclosed in square brackets, with each float rounded to six decimal places (for example, $[0.123456,-0.000001,0.000000,0.987654]$). The final answers are unitless decimal numbers as defined by $\\varepsilon$ above.",
            "solution": "The problem has been validated and is a well-posed, scientifically grounded exercise in computational nuclear reactor physics. It requires the numerical evaluation of the impact of Doppler broadening on resonance self-shielding.\n\n### 1. Theoretical Framework\n\nThe core of the problem lies in comparing two models for the effective resonance absorption cross section, $\\sigma_{\\text{eff}}$. This quantity represents a flux-weighted average cross section over a specified energy range, accounting for the phenomenon of self-shielding.\n\n**a. Resonance Cross Section Profiles**\n\n- **Lorentzian (Natural) Profile:** The intrinsic energy-dependent absorption cross section for a single, isolated resonance is described by the single-level Breit-Wigner formula, which has a Lorentzian shape. It is given as:\n$$\n\\sigma_{\\text{L}}(E) = \\sigma_{\\text{peak}} \\frac{\\gamma^2}{(E - E_0)^2 + \\gamma^2}\n$$\nwhere $E_0$ is the resonance energy, $\\sigma_{\\text{peak}}$ is the peak cross section value, and $\\gamma = \\Gamma/2$ is the half-width at half-maximum.\n\n- **Voigt (Doppler-Broadened) Profile:** In a physical medium at a finite temperature, target nuclei are in thermal motion. This motion induces a Doppler shift in the apparent energy of an incoming neutron as seen by the nucleus. Averaging over the Maxwellian distribution of nuclear velocities convolves the Lorentzian profile with a Gaussian. The resulting shape is a Voigt profile. The problem provides the area-preserving formulation:\n$$\n\\sigma_{\\text{V}}(E) = A_{\\text{L}}\\, V(E - E_0; \\sigma_{\\text{D}}, \\gamma)\n$$\nHere, $A_{\\text{L}} = \\pi \\gamma \\sigma_{\\text{peak}}$ is the area under the Lorentzian curve, which is conserved during broadening. The term $\\sigma_{\\text{D}}$ is the standard deviation of the Gaussian Doppler kernel, and $V(x; \\sigma_{\\text{D}}, \\gamma)$ is the area-normalized Voigt function, defined using the Fadeeva function $w(z)$:\n$$\nV(x; \\sigma, \\gamma) = \\frac{\\Re\\!\\left[w\\!\\left(\\frac{x + i \\gamma}{\\sigma \\sqrt{2}}\\right)\\right]}{\\sigma \\sqrt{2\\pi}}\n$$\nIn the limit where the Doppler width approaches zero ($\\sigma_{\\text{D}} \\to 0$), the Voigt profile $\\sigma_{\\text{V}}(E)$ converges to the Lorentzian profile $\\sigma_{\\text{L}}(E)$.\n\n**b. Self-Shielding and Effective Cross Section**\n\nResonance self-shielding is a consequence of flux depression. At energies where the absorption cross section $\\sigma(E)$ is large, neutrons are preferentially absorbed, leading to a local dip in the neutron flux $\\phi(E)$. A standard model for this effect in a homogeneous mixture is:\n$$\n\\phi(E) \\propto \\frac{1}{\\sigma_{\\text{total}}(E)} \\approx \\frac{1}{\\sigma_{\\text{b}} + \\sigma(E)}\n$$\nwhere $\\sigma_{\\text{b}}$ is the constant background cross section per absorber atom.\n\nThe effective cross section $\\sigma_{\\text{eff}}$ is an average of $\\sigma(E)$ weighted by this depressed flux, ensuring that the total reaction rate is preserved. It is calculated by the ratio of two integrals:\n$$\n\\sigma_{\\text{eff}} = \\frac{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\sigma(E) \\phi(E) dE}{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\phi(E) dE} = \\frac{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{\\sigma(E)}{\\sigma_{\\text{b}} + \\sigma(E)} dE}{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{1}{\\sigma_{\\text{b}} + \\sigma(E)} dE}\n$$\nThese integrals do not generally have closed-form analytical solutions and must be evaluated numerically.\n\n### 2. Computational Procedure\n\nTo find the relative error $\\varepsilon$, we must compute $\\sigma_{\\text{eff}}$ using both the approximate and reference cross section models.\n\n**a. Broadened Effective Cross Section ($\\sigma_{\\text{eff}}^{\\text{broadened}}$)**\nThis is the reference calculation, which uses the physically accurate Doppler-broadened cross section, $\\sigma(E) = \\sigma_{\\text{V}}(E)$. The calculation requires numerically evaluating:\n$$\n\\sigma_{\\text{eff}}^{\\text{broadened}} = \\frac{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{\\sigma_{\\text{V}}(E)}{\\sigma_{\\text{b}} + \\sigma_{\\text{V}}(E)} dE}{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{1}{\\sigma_{\\text{b}} + \\sigma_{\\text{V}}(E)} dE}\n$$\nA special case occurs for $\\sigma_{\\text{D}} = 0$, where we set $\\sigma_{\\text{V}}(E) = \\sigma_{\\text{L}}(E)$.\n\n**b. Narrow Resonance Approximation ($\\sigma_{\\text{eff}}^{\\text{NRA}}$)**\nThis approximation, as defined in the problem, neglects Doppler broadening, so we use the natural line shape, $\\sigma(E) = \\sigma_{\\text{L}}(E)$. The calculation is:\n$$\n\\sigma_{\\text{eff}}^{\\text{NRA}} = \\frac{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{\\sigma_{\\text{L}}(E)}{\\sigma_{\\text{b}} + \\sigma_{\\text{L}}(E)} dE}{\\int_{E_{\\text{low}}}^{E_{\\text{high}}} \\frac{1}{\\sigma_{\\text{b}} + \\sigma_{\\text{L}}(E)} dE}\n$$\n\n**c. Relative Error ($\\varepsilon$)**\nThe final step is to compute the relative error using the definition provided:\n$$\n\\varepsilon = \\frac{\\sigma_{\\text{eff}}^{\\text{NRA}} - \\sigma_{\\text{eff}}^{\\text{broadened}}}{\\sigma_{\\text{eff}}^{\\text{broadened}}}\n$$\nDoppler broadening lowers the peak and widens the base of the resonance. In a self-shielded scenario (low $\\sigma_{\\text{b}}$), absorption at the peak is already saturated. The broadening exposes the wider wings of the resonance to a higher, less-depressed flux, which typically increases the overall effective absorption. Therefore, we expect $\\sigma_{\\text{eff}}^{\\text{broadened}} > \\sigma_{\\text{eff}}^{\\text{NRA}}$, which would result in a negative error $\\varepsilon$.\n\n### 3. Implementation Details\n\nThe solution will be implemented in Python.\n- Numerical integration will be performed using the `quad` function from `scipy.integrate`, which provides robust and accurate quadrature.\n- The Fadeeva function $w(z)$ required for the Voigt profile will be evaluated using `wofz` from `scipy.special`.\n- A generic function will be designed to compute $\\sigma_{\\text{eff}}$ which accepts the appropriate cross section function ($\\sigma_{\\text{L}}$ or $\\sigma_{\\text{V}}$) as an argument.\n- The main program will iterate through each test case, perform the two calculations for $\\sigma_{\\text{eff}}$, compute the relative error, and store the result.\n- The case of $\\sigma_{\\text{D}} = 0$ will be handled explicitly to ensure $\\varepsilon = 0$ and to avoid numerical issues like division by zero.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import wofz\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the resonance self-shielding problem by calculating the relative\n    error of the Narrow Resonance Approximation (NRA) with respect to a\n    Doppler-broadened reference calculation.\n    \"\"\"\n\n    # Test suite from the problem statement.\n    # Format: (E0, Gamma, sigma_peak, sigma_b, sigma_D, E_low, E_high, T)\n    test_cases = [\n        (6.67, 0.025, 5000.0, 2.0, 0.15, 6.0, 7.5, 900),\n        (6.67, 0.025, 5000.0, 100.0, 0.15, 6.0, 7.5, 900),\n        (20.0, 0.2, 800.0, 5.0, 0.0, 18.0, 22.0, 300),\n        (0.3, 0.001, 12000.0, 0.5, 0.05, 0.1, 0.5, 600),\n    ]\n\n    def sigma_lorentzian(E, E0, gamma, sigma_peak):\n        \"\"\"Calculates the Lorentzian (unbroadened) cross section.\"\"\"\n        return sigma_peak * (gamma**2) / ((E - E0)**2 + gamma**2)\n\n    def sigma_voigt(E, E0, gamma, sigma_peak, sigma_D):\n        \"\"\"Calculates the Voigt (Doppler-broadened) cross section.\"\"\"\n        # Calculate the resonance area to preserve it.\n        area_L = np.pi * gamma * sigma_peak\n        \n        # Argument for the Fadeeva function.\n        z = (E - E0 + 1j * gamma) / (sigma_D * np.sqrt(2.0))\n        \n        # Area-normalized Voigt function V(E-E0; sigma_D, gamma).\n        # V = Re[w(z)] / (sigma_D * sqrt(2*pi))\n        voigt_func_val = np.real(wofz(z)) / (sigma_D * np.sqrt(2.0 * np.pi))\n        \n        return area_L * voigt_func_val\n\n    def calculate_effective_xs(xs_func, E_low, E_high, sigma_b, *xs_args):\n        \"\"\"\n        Calculates the self-shielded effective cross section for a given\n        cross section function (xs_func) over an energy interval.\n        \"\"\"\n        # Define the integrand for the numerator of the sigma_eff expression.\n        def numerator_integrand(E):\n            xs_val = xs_func(E, *xs_args)\n            return xs_val / (sigma_b + xs_val)\n\n        # Define the integrand for the denominator of the sigma_eff expression.\n        def denominator_integrand(E):\n            xs_val = xs_func(E, *xs_args)\n            return 1.0 / (sigma_b + xs_val)\n\n        # Use high-precision numerical integration.\n        num_integral, _ = quad(numerator_integrand, E_low, E_high, epsabs=1.49e-12, epsrel=1.49e-12)\n        den_integral, _ = quad(denominator_integrand, E_low, E_high, epsabs=1.49e-12, epsrel=1.49e-12)\n\n        # Avoid division by zero, although physically unlikely for this problem.\n        if abs(den_integral) < 1e-15:\n            return 0.0\n        \n        return num_integral / den_integral\n\n    results = []\n    for case in test_cases:\n        E0, Gamma, sigma_peak, sigma_b, sigma_D, E_low, E_high, _ = case\n        gamma = Gamma / 2.0\n\n        # --- 1. Calculate the NRA effective cross section ---\n        xs_args_lor = (E0, gamma, sigma_peak)\n        sigma_eff_nra = calculate_effective_xs(\n            sigma_lorentzian, E_low, E_high, sigma_b, *xs_args_lor\n        )\n\n        # --- 2. Calculate the Broadened effective cross section ---\n        # Handle the limiting case of zero Doppler broadening.\n        # In this limit, the Voigt profile becomes the Lorentzian profile.\n        if sigma_D < 1e-9:\n            sigma_eff_broadened = sigma_eff_nra\n        else:\n            xs_args_voigt = (E0, gamma, sigma_peak, sigma_D)\n            sigma_eff_broadened = calculate_effective_xs(\n                sigma_voigt, E_low, E_high, sigma_b, *xs_args_voigt\n            )\n\n        # --- 3. Calculate the relative error ---\n        if abs(sigma_eff_broadened) < 1e-12:\n            # If the broadened result is effectively zero, the NRA result\n            # should also be zero, so the error is zero.\n            epsilon = 0.0\n        else:\n            epsilon = (sigma_eff_nra - sigma_eff_broadened) / sigma_eff_broadened\n        \n        results.append(epsilon)\n\n    # Format the final output string as specified.\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice bridges the gap between fundamental theory and the practical methods employed in large-scale reactor simulation codes. You will explore the Bondarenko self-shielding factor method, a standard technique for generating shielded multigroup cross section libraries used in deterministic transport and diffusion solvers. By quantifying how the choice of a reference neutron spectrum—for instance, one typical of a uranium-oxide (UOX) versus a mixed-oxide (MOX) fuel assembly—affects the calculated self-shielding, you will appreciate that self-shielding is not an intrinsic property of a nuclide alone, but is critically dependent on its neutronic environment. ",
            "id": "4246007",
            "problem": "You are tasked with quantifying how the choice of reference neutron spectrum $\\phi_{0}(E)$ affects the Bondarenko self-shielding factor for a single absorber nuclide and with computing the resulting bias in the self-shielded multigroup absorption cross section $\\sigma_{g}$ when the true system spectrum differs from the reference spectrum. The task must be solved from first principles as follows.\n\nStart from the two fundamental bases:\n- The definition of a group-averaged cross section over energy $E$,\n$$\n\\sigma_{g} \\equiv \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,\\sigma(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,dE},\n$$\nwhere $\\phi(E)$ is the neutron flux shape and $\\sigma(E)$ is the microscopic absorption cross section.\n- The background cross-section narrow-resonance flux-shape model (a standard in resonance self-shielding), which takes the energy-dependent flux under a dilution cross section $D$ (in barns) as proportional to\n$$\n\\phi(E;D) \\propto \\frac{\\phi_{0}(E)}{\\sigma(E)+D}.\n$$\n\nFrom these, derive the consistent self-shielded group cross section under a given $D$ and reference spectrum $\\phi_{0}(E)$,\n$$\n\\sigma_{g}^{\\text{ref}}(D) = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\dfrac{\\sigma(E)}{\\sigma(E)+D}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\dfrac{1}{\\sigma(E)+D}\\,dE},\n$$\nand the infinite-dilution group cross section using the same reference spectrum,\n$$\n\\sigma_{g}^{\\infty,\\text{ref}} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\sigma(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,dE}.\n$$\nDefine the Bondarenko self-shielding factor as\n$$\nB_{g}^{\\text{ref}}(D) \\equiv \\frac{\\sigma_{g}^{\\text{ref}}(D)}{\\sigma_{g}^{\\infty,\\text{ref}}}.\n$$\n\nTo quantify spectrum-mismatch bias, define a true system spectrum $\\phi_{\\text{true}}(E)$ and compute the corresponding consistent self-shielded group cross section\n$$\n\\sigma_{g}^{\\text{true}}(D) = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{\\text{true}}(E)\\,\\dfrac{\\sigma(E)}{\\sigma(E)+D}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{\\text{true}}(E)\\,\\dfrac{1}{\\sigma(E)+D}\\,dE}.\n$$\nFor any chosen reference spectrum $\\phi_{0}(E)$, the absolute bias in barns is\n$$\n\\Delta\\sigma_{g}^{\\text{ref}}(D) \\equiv \\sigma_{g}^{\\text{ref}}(D) - \\sigma_{g}^{\\text{true}}(D).\n$$\n\nImplement a program that uses the following scientifically plausible and fully specified inputs to approximate a resolved-resonance energy range for a single absorber:\n\n- Energy grid: logarithmically spaced from $E_{\\min} = 10^{0}\\,\\text{eV}$ to $E_{\\max} = 10^{4}\\,\\text{eV}$ using $N = 20000$ points.\n\n- Absorption cross section model (in barns) as a sum of a $1/v$ tail and several Lorentzian resonances,\n$$\n\\sigma(E) = \\frac{A_{v}}{\\sqrt{E}} + \\sum_{i=1}^{5} A_{i}\\,\\frac{\\left(\\dfrac{\\Gamma_{i}}{2}\\right)^{2}}{(E - E_{i})^{2} + \\left(\\dfrac{\\Gamma_{i}}{2}\\right)^{2}},\n$$\nwith coefficients\n$\nA_{v} = 2.0,\n$\n$\n\\{E_{i}\\}_{i=1}^{5} = \\{6.67,\\,20.9,\\,36.7,\\,66.0,\\,96.7\\}\\,\\text{eV},\n$\n$\n\\{\\Gamma_{i}\\}_{i=1}^{5} = \\{0.30,\\,0.50,\\,1.00,\\,2.00,\\,3.00\\}\\,\\text{eV},\n$\n$\n\\{A_{i}\\}_{i=1}^{5} = \\{2000,\\,800,\\,500,\\,300,\\,200\\}\\,\\text{barns}.\n$\n\n- Reference spectra (unnormalized shapes are acceptable because normalizations cancel in the ratios):\n  - Uranium oxide (UOX)-like epithermal reference: $\\phi_{0}^{\\text{UOX}}(E) \\propto E^{-1.0}$.\n  - Mixed oxide (MOX)-like harder epithermal reference: $\\phi_{0}^{\\text{MOX}}(E) \\propto E^{-0.8}$.\n\n- True system spectrum for bias quantification: $\\phi_{\\text{true}}(E) \\propto E^{-0.9}$.\n\n- Test suite (dilution cross sections in barns) to cover different shielding regimes:\n  - Strong self-shielding: $D_{1} = 1.0$.\n  - Moderate self-shielding: $D_{2} = 100.0$.\n  - Near infinite dilution: $D_{3} = 10^{6}$.\n\nNumerical integration must be done over the specified grid using a consistent quadrature rule. All cross sections must be computed in barns. Angles are not used. The program must compute, for each dilution $D_{k}$ with $k \\in \\{1,2,3\\}$:\n- The difference in Bondarenko factors between MOX and UOX references,\n$\n\\Delta B(D_{k}) \\equiv B_{g}^{\\text{MOX}}(D_{k}) - B_{g}^{\\text{UOX}}(D_{k}),\n$\ndimensionless.\n- The absolute bias in the group absorption cross section in barns when using the UOX reference relative to the true spectrum,\n$\n\\Delta\\sigma_{g}^{\\text{UOX}}(D_{k}),\n$\nin barns.\n- The absolute bias in the group absorption cross section in barns when using the MOX reference relative to the true spectrum,\n$\n\\Delta\\sigma_{g}^{\\text{MOX}}(D_{k}),\n$\nin barns.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n$\n[\\Delta B(D_{1}),\\,\\Delta\\sigma_{g}^{\\text{UOX}}(D_{1}),\\,\\Delta\\sigma_{g}^{\\text{MOX}}(D_{1}),\\,\\Delta B(D_{2}),\\,\\Delta\\sigma_{g}^{\\text{UOX}}(D_{2}),\\,\\Delta\\sigma_{g}^{\\text{MOX}}(D_{2}),\\,\\Delta B(D_{3}),\\,\\Delta\\sigma_{g}^{\\text{UOX}}(D_{3}),\\,\\Delta\\sigma_{g}^{\\text{MOX}}(D_{3})].\n$\n- Express $\\Delta B(D_{k})$ as dimensionless floats rounded to six decimal places, and express $\\Delta\\sigma_{g}^{\\text{UOX}}(D_{k})$ and $\\Delta\\sigma_{g}^{\\text{MOX}}(D_{k})$ in barns rounded to six decimal places.\n- No extra text is allowed in the output.\n\nYour implementation must be self-contained and require no external input. Use only the provided parameters. All physical quantities involving cross sections must be handled in barns, and all energies in electron-volts (eV). The integration must respect the given energy bounds in eV. The program must be written in a general-purpose modern language and can use standard numerical libraries for integration and array operations, provided that the final output format is exactly as specified above.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of nuclear reactor physics, specifically the theory of resonance self-shielding. The problem is well-posed, objective, self-contained, and computationally feasible. All definitions, parameters, and objectives are specified with sufficient clarity and precision to permit a unique and meaningful solution.\n\nThe task is to quantify biases in multigroup cross sections arising from the choice of a reference spectrum in the Bondarenko self-shielding factor method. This will be accomplished by deriving the necessary formulas from first principles and then implementing them numerically for a specified test case.\n\nWe begin from the two fundamental definitions provided. First, the definition of a group-averaged cross section, $\\sigma_g$, over an energy group $[E_{\\min}, E_{\\max}]$ for a material with a microscopic cross section $\\sigma(E)$ exposed to a neutron flux $\\phi(E)$:\n$$\n\\sigma_{g} \\equiv \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,\\sigma(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,dE}\n$$\nThis equation defines the group cross section as the reaction rate per atom, averaged over the energy-dependent neutron flux.\n\nSecond, we use the narrow-resonance (NR) approximation for the flux shape within a fuel lump containing a resonant absorber. This model states that the flux $\\phi(E; D)$ is \"depressed\" at energies where the absorption cross section $\\sigma(E)$ is high. It is given as being proportional to a smooth background flux $\\phi_0(E)$ divided by the total cross section, which is approximated as $\\sigma(E) + D$, where $D$ is an effective dilution cross section representing all other materials mixed with the absorber.\n$$\n\\phi(E;D) \\propto \\frac{\\phi_{0}(E)}{\\sigma(E)+D}\n$$\nLet the proportionality constant be $C$. Substituting this flux shape, $\\phi(E;D) = C \\frac{\\phi_{0}(E)}{\\sigma(E)+D}$, into the definition of $\\sigma_g$ gives the self-shielded group cross section, $\\sigma_g^{\\text{ref}}(D)$, for a given reference spectrum $\\phi_0(E)$:\n$$\n\\sigma_{g}^{\\text{ref}}(D) = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\left( C \\frac{\\phi_{0}(E)}{\\sigma(E)+D} \\right) \\sigma(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\left( C \\frac{\\phi_{0}(E)}{\\sigma(E)+D} \\right) dE}\n$$\nThe constant $C$ cancels, yielding the expression for the self-shielded group cross section consistent with the NR model:\n$$\n\\sigma_{g}^{\\text{ref}}(D) = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\dfrac{\\sigma(E)}{\\sigma(E)+D}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\dfrac{1}{\\sigma(E)+D}\\,dE}\n$$\nThe infinite-dilution group cross section, $\\sigma_{g}^{\\infty,\\text{ref}}$, represents the case where the absorber is so dilute ($D \\to \\infty$) that it does not perturb the background flux. In this limit, the flux shape $\\phi(E; D)$ simply becomes the reference flux $\\phi_0(E)$. Applying this to the fundamental definition of $\\sigma_g$ gives:\n$$\n\\sigma_{g}^{\\infty,\\text{ref}} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,\\sigma(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{0}(E)\\,dE}\n$$\nThe Bondarenko self-shielding factor, $B_{g}^{\\text{ref}}(D)$, is defined as the ratio of the self-shielded cross section to the infinite-dilution cross section. It quantifies the reduction in the effective cross section due to flux depression.\n$$\nB_{g}^{\\text{ref}}(D) \\equiv \\frac{\\sigma_{g}^{\\text{ref}}(D)}{\\sigma_{g}^{\\infty,\\text{ref}}}\n$$\nTo assess the error introduced by an incorrect choice of reference spectrum, we posit a \"true\" system spectrum, $\\phi_{\\text{true}}(E)$, which would yield the true self-shielded cross section, $\\sigma_{g}^{\\text{true}}(D)$:\n$$\n\\sigma_{g}^{\\text{true}}(D) = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{\\text{true}}(E)\\,\\dfrac{\\sigma(E)}{\\sigma(E)+D}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi_{\\text{true}}(E)\\,\\dfrac{1}{\\sigma(E)+D}\\,dE}\n$$\nThe absolute bias when using a reference spectrum $\\phi_0(E)$ instead of the true one is the difference:\n$$\n\\Delta\\sigma_{g}^{\\text{ref}}(D) \\equiv \\sigma_{g}^{\\text{ref}}(D) - \\sigma_{g}^{\\text{true}}(D)\n$$\nThe computational procedure is to evaluate these quantities numerically.\nFirst, we discretize the energy domain from $E_{\\min} = 10^0\\,\\text{eV}$ to $E_{\\max} = 10^4\\,\\text{eV}$ into $N = 20000$ points on a logarithmic grid, which provides higher resolution at lower energies where the specified resonances are located. Let this grid be $\\{E_j\\}$.\n\nNext, we evaluate the absorption cross section $\\sigma(E_j)$ at each grid point using the provided model, which is a sum of a $1/v$ component and five Breit-Wigner (Lorentzian) resonances:\n$$\n\\sigma(E) = \\frac{A_{v}}{\\sqrt{E}} + \\sum_{i=1}^{5} A_{i}\\,\\frac{\\left(\\dfrac{\\Gamma_{i}}{2}\\right)^{2}}{(E - E_{i})^{2} + \\left(\\dfrac{\\Gamma_{i}}{2}\\right)^{2}}\n$$\nwith parameters $A_v = 2.0$, $\\{E_i\\} = \\{6.67, 20.9, 36.7, 66.0, 96.7\\}\\,\\text{eV}$, $\\{\\Gamma_i\\} = \\{0.30, 0.50, 1.00, 2.00, 3.00\\}\\,\\text{eV}$, and $\\{A_i\\} = \\{2000, 800, 500, 300, 200\\}\\,\\text{barns}$.\n\nSimilarly, we evaluate the three flux spectra on the same energy grid:\n-   $\\phi_0^{\\text{UOX}}(E_j) = E_j^{-1.0}$\n-   $\\phi_0^{\\text{MOX}}(E_j) = E_j^{-0.8}$\n-   $\\phi_{\\text{true}}(E_j) = E_j^{-0.9}$\n\nAll integrals are then approximated as discrete sums over the grid $\\{E_j\\}$ using the trapezoidal rule, a consistent and robust quadrature method for a finely spaced grid. For an arbitrary integrand $f(E)$, the integral is $\\int f(E) dE \\approx \\sum_{j=1}^{N-1} \\frac{1}{2}(f(E_{j+1}) + f(E_j))(E_{j+1} - E_j)$.\n\nFor each dilution value $D_k \\in \\{1.0, 100.0, 10^6\\}$ barns, the following are computed:\n1.  The infinite-dilution cross sections $\\sigma_{g}^{\\infty,\\text{UOX}}$ and $\\sigma_{g}^{\\infty,\\text{MOX}}$. These are constant for all $D_k$.\n2.  The self-shielded cross sections $\\sigma_{g}^{\\text{UOX}}(D_k)$, $\\sigma_{g}^{\\text{MOX}}(D_k)$, and $\\sigma_{g}^{\\text{true}}(D_k)$.\n3.  The Bondarenko factors $B_{g}^{\\text{UOX}}(D_k)$ and $B_{g}^{\\text{MOX}}(D_k)$.\n4.  The final quantities of interest: $\\Delta B(D_k) = B_{g}^{\\text{MOX}}(D_k) - B_{g}^{\\text{UOX}}(D_k)$, $\\Delta\\sigma_{g}^{\\text{UOX}}(D_k) = \\sigma_{g}^{\\text{UOX}}(D_k) - \\sigma_{g}^{\\text{true}}(D_k)$, and $\\Delta\\sigma_{g}^{\\text{MOX}}(D_k) = \\sigma_{g}^{\\text{MOX}}(D_k) - \\sigma_{g}^{\\text{true}}(D_k)$.\n\nThis systematic process allows for a direct quantitative comparison of the effects of using different standard reference spectra (UOX and MOX) relative to a known \"true\" spectrum across different self-shielding regimes.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes biases in Bondarenko factors and self-shielded cross sections\n    due to reference spectrum mismatch.\n    \"\"\"\n    \n    # 1. Define physical constants and problem parameters\n    E_min = 1.0  # eV\n    E_max = 1e4  # eV\n    N = 20000    # Number of grid points\n\n    # Cross section parameters\n    A_v = 2.0\n    E_resonances = np.array([6.67, 20.9, 36.7, 66.0, 96.7])      # eV\n    Gamma_widths = np.array([0.30, 0.50, 1.00, 2.00, 3.00])      # eV\n    A_amplitudes = np.array([2000.0, 800.0, 500.0, 300.0, 200.0]) # barns\n\n    # Test cases for dilution cross section D (barns)\n    test_cases = [1.0, 100.0, 1e6]\n\n    # 2. Set up energy grid and evaluate functions on the grid\n    # Logarithmic grid for better resolution at lower energies\n    E_grid = np.logspace(np.log10(E_min), np.log10(E_max), N)\n\n    # Calculate absorption cross section sigma(E) on the grid\n    sigma_E = A_v / np.sqrt(E_grid)\n    for i in range(len(E_resonances)):\n        lorentzian = A_amplitudes[i] * ((Gamma_widths[i] / 2.0)**2) / \\\n                     ((E_grid - E_resonances[i])**2 + (Gamma_widths[i] / 2.0)**2)\n        sigma_E += lorentzian\n\n    # Evaluate flux spectra phi(E) on the grid\n    phi_uox_E = E_grid**(-1.0)\n    phi_mox_E = E_grid**(-0.8)\n    phi_true_E = E_grid**(-0.9)\n\n    # 3. Define helper functions for physical quantities using numerical integration\n    def trapz_integrate(integrand, grid):\n        return np.trapz(integrand, grid)\n\n    def calculate_sigma_g(D, phi_E, sigma_E_grid, E_grid):\n        \"\"\"Calculates the self-shielded group cross section.\"\"\"\n        integrand_num = phi_E * (sigma_E_grid / (sigma_E_grid + D))\n        integrand_den = phi_E * (1.0 / (sigma_E_grid + D))\n        \n        integral_num = trapz_integrate(integrand_num, E_grid)\n        integral_den = trapz_integrate(integrand_den, E_grid)\n        \n        # Denominator will be non-zero for physical inputs\n        return integral_num / integral_den\n\n    def calculate_sigma_g_inf(phi_E, sigma_E_grid, E_grid):\n        \"\"\"Calculates the infinite-dilution group cross section.\"\"\"\n        integral_num = trapz_integrate(phi_E * sigma_E_grid, E_grid)\n        integral_den = trapz_integrate(phi_E, E_grid)\n        \n        return integral_num / integral_den\n\n    # 4. Pre-calculate quantities that do not depend on dilution D\n    sigma_g_inf_uox = calculate_sigma_g_inf(phi_uox_E, sigma_E, E_grid)\n    sigma_g_inf_mox = calculate_sigma_g_inf(phi_mox_E, sigma_E, E_grid)\n\n    # 5. Loop over test cases and compute the required quantities\n    results = []\n    for Dk in test_cases:\n        # Calculate self-shielded cross sections for current Dk\n        sigma_g_uox_Dk = calculate_sigma_g(Dk, phi_uox_E, sigma_E, E_grid)\n        sigma_g_mox_Dk = calculate_sigma_g(Dk, phi_mox_E, sigma_E, E_grid)\n        sigma_g_true_Dk = calculate_sigma_g(Dk, phi_true_E, sigma_E, E_grid)\n\n        # Calculate Bondarenko factors\n        B_g_uox_Dk = sigma_g_uox_Dk / sigma_g_inf_uox\n        B_g_mox_Dk = sigma_g_mox_Dk / sigma_g_inf_mox\n        \n        # Calculate difference in Bondarenko factors\n        delta_B_Dk = B_g_mox_Dk - B_g_uox_Dk\n        \n        # Calculate absolute biases in group cross section\n        delta_sigma_uox_Dk = sigma_g_uox_Dk - sigma_g_true_Dk\n        delta_sigma_mox_Dk = sigma_g_mox_Dk - sigma_g_true_Dk\n        \n        results.extend([delta_B_Dk, delta_sigma_uox_Dk, delta_sigma_mox_Dk])\n        \n    # 6. Format and print the final output as a single line\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}