{
    "hands_on_practices": [
        {
            "introduction": "在着手求解任何问题之前，我们必须首先精确地构建其数学模型。本练习旨在通过将放射性衰变和中子嬗变等物理过程转化为常微分方程(ODEs)系统，来巩固对这些过程的理解。这项实践将经典的贝特曼(Bateman)方程（仅描述纯放射性衰变）推广到包含中子通量相互作用的反应堆环境中，揭示了在燃耗计算中，总移除率是如何取代纯衰变常数的，这是反应堆燃耗分析的理论基石 。",
            "id": "4233533",
            "problem": "考虑一个由三种核素构成的线性嬗变-衰变链，标记为 $1 \\to 2 \\to 3$，该链在均匀介质中，受一个不依赖时间的单能群中子通量 $\\phi$ 影响而演化。每种核素 $i \\in \\{1,2,3\\}$ 都会进行放射性衰变，其衰变常数为 $\\lambda_i$；同时也会被中子诱发移除，其微观截面为 $\\sigma_{i,r}$，因此单核总移除率为 $\\alpha_i \\equiv \\lambda_i + \\phi \\sigma_{i,r}$。链上的生成仅发生在从 $1$ 到 $2$ 以及从 $2$ 到 $3$（没有从 $1$ 到 $3$ 的直接生成），其有效连接率定义为 $p_{12} \\equiv \\beta_{1\\to 2}\\lambda_1 + \\phi \\sigma_{1\\to 2}$ 和 $p_{23} \\equiv \\beta_{2\\to 3}\\lambda_2 + \\phi \\sigma_{2\\to 3}$，其中 $\\beta_{i\\to i+1}$ 是链中的衰变分支比，而 $\\sigma_{i\\to i+1}$ 是使核素 $i$ 嬗变为 $i+1$ 的中子反应的微观截面。假设 $\\phi$、所有的 $\\lambda_i$、所有的 $\\sigma_{i,r}$ 以及所有的 $\\sigma_{i\\to i+1}$ 均为不随时间变化的常数，并假设 $\\alpha_1$、$\\alpha_2$ 和 $\\alpha_3$ 两两不同。在时间 $t=0$ 时的初始核素数量为 $N_1(0)$、$N_2(0)$ 和 $N_3(0)$。\n\n仅从每种核素的基本核数平衡原理出发——即变化率等于该核素的总生成率减去总移除率——推导控制 $N_1(t)$、$N_2(t)$ 和 $N_3(t)$ 的耦合线性常微分方程（ODE）。利用这些ODE，证明中子诱发嬗变的存在会改变经典Bateman系数的结构，具体表现为在所有指数因子和部分分式分母中，用总移除率 $\\alpha_i$ 替代纯放射性衰变常数。然后，明确计算修正后的Bateman系数 $C_1(t)$、$C_2(t)$ 和 $C_3(t)$，它们由以下表示式定义：\n$$\nN_3(t) \\equiv C_1(t)\\,N_1(0) + C_2(t)\\,N_2(0) + C_3(t)\\,N_3(0),\n$$\n并用 $t$、$\\alpha_i$ 和 $p_{ij}$ 表示。你可以假设除了指定的生成和损耗途径外，没有其他途径。请将你的最终结果表示为行向量 $(C_1(t),\\,C_2(t),\\,C_3(t))$ 的闭式解析表达式。无需进行数值舍入，最终表达式也无需报告单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第1步：提取已知条件\n-   **核素链：** 一个由三种核素构成的线性链，$1 \\to 2 \\to 3$。\n-   **中子通量：** $\\phi$，常数且不依赖时间。\n-   **衰变常数：** $\\lambda_i$，对于核素 $i \\in \\{1,2,3\\}$。\n-   **微观移除截面：** $\\sigma_{i,r}$，对于核素 $i$。\n-   **单核总移除率：** $\\alpha_i \\equiv \\lambda_i + \\phi \\sigma_{i,r}$，对于核素 $i$。\n-   **有效连接率：**\n    -   $p_{12} \\equiv \\beta_{1\\to 2}\\lambda_1 + \\phi \\sigma_{1\\to 2}$\n    -   $p_{23} \\equiv \\beta_{2\\to 3}\\lambda_2 + \\phi \\sigma_{2\\to 3}$\n-   **衰变分支比：** $\\beta_{i\\to i+1}$。\n-   **微观嬗变截面：** $\\sigma_{i\\to i+1}$。\n-   **约束条件：** 所有参数（$\\phi$, $\\lambda_i$, $\\sigma_{i,r}$, $\\sigma_{i\\to i+1}$）均为常数。移除率 $\\alpha_1$、$\\alpha_2$ 和 $\\alpha_3$ 两两不同。\n-   **初始条件：** 在时间 $t=0$ 时的核素数量为 $N_1(0)$、$N_2(0)$ 和 $N_3(0)$。\n-   **目标：** 推导控制ODE，并找出表达式 $N_3(t) = C_1(t)N_1(0) + C_2(t)N_2(0) + C_3(t)N_3(0)$ 中的系数 $C_1(t)$、$C_2(t)$ 和 $C_3(t)$。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据：** 该问题使用标准燃耗方程（也称为Bateman方程，已为燃耗计算进行推广）来描述核嬗变和衰变。这是核反应堆物理与工程领域中一个基础且成熟的模型。移除率和生成途径的定义都是标准的。该问题在科学上是合理的。\n-   **适定性：** 该问题要求解一个具有常系数和指定初始条件的耦合线性一阶常微分方程组。这构成了一个适定的初值问题，保证了解的唯一性和稳定性。$\\alpha_1$、$\\alpha_2$ 和 $\\alpha_3$ 两两不同的明确条件确保了标准解形式中的分母不为零，这对所采用的方法至关重要。\n-   **目标明确性：** 问题陈述使用了精确、无歧义的数学和物理术语。所有量都有正式定义。没有主观或基于观点的内容。\n\n### 第3步：结论与行动\n该问题在科学上合理、适定、客观且自洽。这是一个有效的问题。可以开始求解过程。\n\n### 控制ODE的推导\n\n核素浓度 $N_i(t)$ 的演化遵循核数平衡原理：核素数量的时间变化率等于其总生成率减去其总移除率。\n\n对于核素 $1$：\n-   生成率：$0$（因为它是链的起始）。\n-   移除率：通过放射性衰变（速率为 $\\lambda_1 N_1$）和中子诱发反应（速率为 $\\phi \\sigma_{1,r} N_1$）发生。总移除率为 $(\\lambda_1 + \\phi \\sigma_{1,r}) N_1 = \\alpha_1 N_1$。\n-   $N_1(t)$ 的ODE为：\n    $$ \\frac{dN_1}{dt} = - \\alpha_1 N_1(t) $$\n\n对于核素 $2$：\n-   生成率：核素 $2$ 由核素 $1$ 生成。生成率是核素 $1$ 衰变速率（$\\beta_{1\\to 2}\\lambda_1 N_1$）与核素 $1$ 中子嬗变速率（$\\phi \\sigma_{1\\to 2} N_1$）之和。总生成率为 $(\\beta_{1\\to 2}\\lambda_1 + \\phi \\sigma_{1\\to 2}) N_1 = p_{12} N_1$。\n-   移除率：与核素 $1$ 类似，总移除率为 $(\\lambda_2 + \\phi \\sigma_{2,r}) N_2 = \\alpha_2 N_2$。\n-   $N_2(t)$ 的ODE为：\n    $$ \\frac{dN_2}{dt} = p_{12} N_1(t) - \\alpha_2 N_2(t) $$\n\n对于核素 $3$：\n-   生成率：核素 $3$ 由核素 $2$ 生成，总生成率为 $(\\beta_{2\\to 3}\\lambda_2 + \\phi \\sigma_{2\\to 3}) N_2 = p_{23} N_2$。\n-   移除率：总移除率为 $(\\lambda_3 + \\phi \\sigma_{3,r}) N_3 = \\alpha_3 N_3$。\n-   $N_3(t)$ 的ODE为：\n    $$ \\frac{dN_3}{dt} = p_{23} N_2(t) - \\alpha_3 N_3(t) $$\n\n这三个方程构成一个耦合的线性一阶ODE系统。\n\n### ODE的求解与系数的推导\n\n该系统是线性的，因此解可以表示为初始条件的线性组合，$N_3(t) = C_1(t)N_1(0) + C_2(t)N_2(0) + C_3(t)N_3(0)$。我们可以通过求解仅有对应初始条件 $N_i(0)$ 非零的情况下的方程组来找到每个系数 $C_i(t)$，这是叠加原理的直接应用。\n\n**1. $C_3(t)$ 的推导**\n假设初始条件为 $N_1(0)=0$，$N_2(0)=0$ 且 $N_3(0) \\neq 0$。系统显著简化。对于所有 $t \\ge 0$，$N_1(t)=0$ 且 $N_2(t)=0$。$N_3(t)$ 的方程变为：\n$$ \\frac{dN_3}{dt} = - \\alpha_3 N_3(t) $$\n在初始条件 $N_3(0)$ 下，解为：\n$$ N_3(t) = N_3(0) \\exp(-\\alpha_3 t) $$\n根据定义，此解为 $C_3(t)N_3(0)$，所以：\n$$ C_3(t) = \\exp(-\\alpha_3 t) $$\n\n**2. $C_2(t)$ 的推导**\n假设初始条件为 $N_1(0)=0$，$N_2(0) \\neq 0$ 且 $N_3(0)=0$。\n$N_2(t)$ 的方程为 $\\frac{dN_2}{dt} = -\\alpha_2 N_2(t)$，解得 $N_2(t) = N_2(0)\\exp(-\\alpha_2 t)$。\n$N_3(t)$ 的方程变为一个非齐次线性ODE：\n$$ \\frac{dN_3}{dt} + \\alpha_3 N_3(t) = p_{23} N_2(t) = p_{23} N_2(0) \\exp(-\\alpha_2 t) $$\n使用积分因子 $I(t) = \\exp(\\int \\alpha_3 dt) = \\exp(\\alpha_3 t)$，我们得到：\n$$ \\frac{d}{dt}(N_3(t) \\exp(\\alpha_3 t)) = p_{23} N_2(0) \\exp(-\\alpha_2 t) \\exp(\\alpha_3 t) = p_{23} N_2(0) \\exp((\\alpha_3 - \\alpha_2)t) $$\n从 $0$ 到 $t$ 积分，并使用初始条件 $N_3(0)=0$：\n$$ N_3(t) \\exp(\\alpha_3 t) = \\int_0^t p_{23} N_2(0) \\exp((\\alpha_3 - \\alpha_2)\\tau) d\\tau = p_{23} N_2(0) \\left[ \\frac{\\exp((\\alpha_3 - \\alpha_2)\\tau)}{\\alpha_3 - \\alpha_2} \\right]_0^t $$\n此处用到了条件 $\\alpha_2 \\neq \\alpha_3$。\n$$ N_3(t) \\exp(\\alpha_3 t) = p_{23} N_2(0) \\frac{\\exp((\\alpha_3 - \\alpha_2)t) - 1}{\\alpha_3 - \\alpha_2} $$\n乘以 $\\exp(-\\alpha_3 t)$：\n$$ N_3(t) = p_{23} N_2(0) \\frac{\\exp(-\\alpha_2 t) - \\exp(-\\alpha_3 t)}{\\alpha_3 - \\alpha_2} $$\n因此，系数 $C_2(t)$ 为：\n$$ C_2(t) = p_{23} \\frac{\\exp(-\\alpha_2 t) - \\exp(-\\alpha_3 t)}{\\alpha_3 - \\alpha_2} $$\n\n**3. $C_1(t)$ 的推导**\n假设初始条件为 $N_1(0) \\neq 0$，$N_2(0)=0$ 且 $N_3(0)=0$。\n首先，求解 $N_1(t)$：$N_1(t) = N_1(0) \\exp(-\\alpha_1 t)$。\n接下来，求解 $N_2(t)$：\n$$ \\frac{dN_2}{dt} + \\alpha_2 N_2(t) = p_{12} N_1(0) \\exp(-\\alpha_1 t) $$\n使用积分因子 $\\exp(\\alpha_2 t)$ 和初始条件 $N_2(0)=0$，解为：\n$$ N_2(t) = p_{12} N_1(0) \\frac{\\exp(-\\alpha_1 t) - \\exp(-\\alpha_2 t)}{\\alpha_2 - \\alpha_1} $$\n现在，求解 $N_3(t)$：\n$$ \\frac{dN_3}{dt} + \\alpha_3 N_3(t) = p_{23} N_2(t) = p_{23} p_{12} N_1(0) \\frac{\\exp(-\\alpha_1 t) - \\exp(-\\alpha_2 t)}{\\alpha_2 - \\alpha_1} $$\n使用积分因子 $\\exp(\\alpha_3 t)$ 和 $N_3(0)=0$：\n$$ N_3(t)\\exp(\\alpha_3 t) = \\frac{p_{23} p_{12} N_1(0)}{\\alpha_2-\\alpha_1} \\int_0^t \\left( \\exp((\\alpha_3-\\alpha_1)\\tau) - \\exp((\\alpha_3-\\alpha_2)\\tau) \\right) d\\tau $$\n$$ N_3(t)\\exp(\\alpha_3 t) = \\frac{p_{23} p_{12} N_1(0)}{\\alpha_2-\\alpha_1} \\left( \\frac{\\exp((\\alpha_3-\\alpha_1)t)-1}{\\alpha_3-\\alpha_1} - \\frac{\\exp((\\alpha_3-\\alpha_2)t)-1}{\\alpha_3-\\alpha_2} \\right) $$\n乘以 $\\exp(-\\alpha_3 t)$ 并重新整理得到：\n$$ N_3(t) = \\frac{p_{23} p_{12} N_1(0)}{\\alpha_2-\\alpha_1} \\left( \\frac{\\exp(-\\alpha_1 t) - \\exp(-\\alpha_3 t)}{\\alpha_3-\\alpha_1} - \\frac{\\exp(-\\alpha_2 t) - \\exp(-\\alpha_3 t)}{\\alpha_3-\\alpha_2} \\right) $$\n为得到标准的对称Bateman形式，我们将具有相同指数因子的项收集起来：\n$$ C_1(t) = p_{12} p_{23} \\left[ \\frac{\\exp(-\\alpha_1 t)}{(\\alpha_2-\\alpha_1)(\\alpha_3-\\alpha_1)} + \\frac{\\exp(-\\alpha_2 t)}{(\\alpha_1-\\alpha_2)(\\alpha_3-\\alpha_2)} + \\frac{\\exp(-\\alpha_3 t)}{(\\alpha_1-\\alpha_3)(\\alpha_2-\\alpha_3)} \\right] $$\n这个 $C_1(t)$ 的表达式展示了所要求的修正结构。与纯放射性衰变的经典Bateman方程相比，所有指数项和分母中的衰变常数 $\\lambda_i$ 被总移除率 $\\alpha_i = \\lambda_i + \\phi \\sigma_{i,r}$ 所取代。此外，中间生成项（原本是简单的衰变常数或分支比乘以衰变常数）被有效连接率 $p_{ij} = \\beta_{i\\to i+1}\\lambda_i + \\phi \\sigma_{i\\to i+1}$ 所取代，后者同时考虑了由衰变和中子俘获所产生的贡献。\n\n最终结果是这三个系数组成的行向量。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} p_{12} p_{23} \\left( \\sum_{i=1}^{3} \\frac{e^{-\\alpha_i t}}{\\prod_{j=1, j\\neq i}^{3} (\\alpha_j - \\alpha_i)} \\right) & p_{23} \\frac{e^{-\\alpha_2 t} - e^{-\\alpha_3 t}}{\\alpha_3 - \\alpha_2} & e^{-\\alpha_3 t} \\end{pmatrix} } $$"
        },
        {
            "introduction": "将理论模型转化为有效的仿真实践，需要对数值方法有深刻的理解和实现能力。本练习提供了构建一个基础数值求解器的实践经验，但更重要的是，它引导我们完成代码验证这一关键步骤 。通过将数值解与已知的解析解进行对比，我们可以直观地观察和量化数值误差与稳定性等核心概念，这对于计算物理学和工程仿真至关重要。",
            "id": "4233519",
            "problem": "考虑一个代表核反应堆模拟中燃耗的三核素线性嬗变衰变链。设数密度矢量为 $y(t) = \\begin{bmatrix} N_1(t) \\\\ N_2(t) \\\\ N_3(t) \\end{bmatrix}$，其中 $N_i(t)$ 表示核素 $i$ 的原子数密度，单位为原子/立方厘米。其演化由一个具有常系数和针对第一个核素的恒定源项的常微分方程（ODE）控制：\n$$\n\\frac{d}{dt} y(t) = A\\,y(t) + s,\n$$\n其中\n$$\nA = \\begin{bmatrix}\n-\\lambda_1  & 0  & 0 \\\\\nb_1 \\lambda_1  & -\\lambda_2  & 0 \\\\\n0  & b_2 \\lambda_2  & -\\lambda_3\n\\end{bmatrix}, \\quad\ns = \\begin{bmatrix} q \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\n此处，$\\lambda_i$ 是恒定的移除率，单位为 $\\mathrm{s}^{-1}$，可能包括放射性衰变和有效的中子诱发移除（例如，吸收）。$b_1$ 和 $b_2$ 是转移到链中下一个核素的分支产额（无量纲），$q$ 是核素1的恒定外部生成率，单位为原子/立方厘米·秒。时间 $t$ 的单位是秒。假设初始条件 $y(0) = y_0$ 已给定。\n\n任务：\n1. 从线性时不变系统的基本定义和叠加原理出发，推导具有常数矩阵 $A$ 和常数源 $s$ 的系统的解析解 $y(t)$。不要使用预先给出的简化公式；通过考虑齐次解和特解并使用常数变易法将它们组合，从第一性原理出发推导表达式。\n2. 设计一个一阶数值实现，使用线性链法和显式时间推进，在固定时间步长 $\\Delta t$ 内顺序更新链。在每个时间步内，使用其移除和源项更新核素1，然后使用根据步长开始时的值计算出的核素1的流出量更新核素2，最后使用根据步长开始时的值计算出的核素2的流出量更新核素3。这种显式顺序更新必须在每个子步骤中使用母核素更新前的值。\n3. 对于下面的每个测试用例，使用解析解和数值实现计算最终时间 $T$ 时的最终状态 $y(T)$，并计算在 $t=T$ 时三个核素的两个误差范数：相对 $L^2$ 范数和相对 $L^\\infty$ 范数，定义如下：\n$$\nE_2 = \\frac{\\|y_{\\text{num}}(T) - y_{\\text{exact}}(T)\\|_2}{\\|y_{\\text{exact}}(T)\\|_2}, \\quad\nE_\\infty = \\frac{\\|y_{\\text{num}}(T) - y_{\\text{exact}}(T)\\|_\\infty}{\\|y_{\\text{exact}}(T)\\|_\\infty}.\n$$\n$E_2$ 和 $E_\\infty$ 均为无量纲。\n4. 您的程序必须实现此过程，并生成单行输出，其中包含一个逗号分隔的列表形式的结果，并用方括号括起来，形式为 $[E_2^{(1)},E_\\infty^{(1)},E_2^{(2)},E_\\infty^{(2)},\\dots]$，其中上标表示测试用例索引。\n\n物理和数值单位：\n- 时间 $t$ 必须以秒为单位。\n- 移除率 $\\lambda_i$ 必须以 $\\mathrm{s}^{-1}$ 为单位。\n- 源 $q$ 必须以原子/立方厘米·秒为单位。\n- 数密度 $N_i(t)$ 必须以原子/立方厘米为单位。\n- 误差范数必须是无量纲的。\n\n测试套件：\n- 案例1（正常路径，中等时间步长）：$\\lambda_1 = 0.02$, $\\lambda_2 = 0.15$, $\\lambda_3 = 10^{-6}$, $b_1 = 1$, $b_2 = 1$, $q = 10^{19}$, $y_0 = \\begin{bmatrix} 2\\times 10^{20} \\\\ 0 \\\\ 0 \\end{bmatrix}$, $\\Delta t = 0.5$, $T = 10$.\n- 案例2（小时间步长边界）：参数与案例1相同，但 $\\Delta t = 0.01$ 且 $T = 10$。\n- 案例3（大时间步长压力测试）：参数与案例1相同，但 $\\Delta t = 2.0$ 且 $T = 10$。\n- 案例4（刚性链）：$\\lambda_1 = 5.0$, $\\lambda_2 = 0.05$, $\\lambda_3 = 10^{-5}$, $b_1 = 1$, $b_2 = 1$, $q = 10^{19}$, $y_0 = \\begin{bmatrix} 10^{19} \\\\ 2\\times 10^{18} \\\\ 0 \\end{bmatrix}$, $\\Delta t = 0.1$, $T = 10$.\n- 案例5（近简并相等速率）：$\\lambda_1 = 0.1$, $\\lambda_2 = 0.1$, $\\lambda_3 = 0.1$, $b_1 = 1$, $b_2 = 1$, $q = 5\\times 10^{18}$, $y_0 = \\begin{bmatrix} 10^{20} \\\\ 5\\times 10^{19} \\\\ 0 \\end{bmatrix}$, $\\Delta t = 0.5$, $T = 10$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,\\dots]$）。每个 $result_i$ 必须是一个浮点数，对应于每个测试用例指定的误差范数。",
            "solution": "此问题经评估有效，因为它在科学上基于核嬗变和衰变的原理，在数学上是一个适定的线性初值问题，并且客观地表述了所有必要的参数和条件。\n\n### 步骤1：解析解的推导\n\n该问题描述了一个三核素系统的演化，该系统由一个具有常系数的线性、非齐次常微分方程（ODE）控制：\n$$\n\\frac{d}{dt} y(t) = A\\,y(t) + s\n$$\n初始条件为 $y(0) = y_0$。矢量 $y(t)$ 和 $s$，以及矩阵 $A$ 由下式给出：\n$$\ny(t) = \\begin{bmatrix} N_1(t) \\\\ N_2(t) \\\\ N_3(t) \\end{bmatrix}, \\quad\nA = \\begin{bmatrix}\n-\\lambda_1  & 0  & 0 \\\\\nb_1 \\lambda_1  & -\\lambda_2  & 0 \\\\\n0  & b_2 \\lambda_2  & -\\lambda_3\n\\end{bmatrix}, \\quad\ns = \\begin{bmatrix} q \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n线性非齐次ODE的解是对应齐次方程的通解 $y_h(t)$ 和非齐次方程的一个特解 $y_p(t)$ 的和。\n\n**1. 齐次解：**\n齐次方程为 $\\frac{d}{dt} y_h(t) = A y_h(t)$。该系统的解由下式给出：\n$$\ny_h(t) = e^{At} C\n$$\n其中 $C$ 是由初始条件决定的常数矢量，$e^{At}$ 是矩阵指数，由其泰勒级数展开定义：\n$$\ne^{At} = I + At + \\frac{(At)^2}{2!} + \\frac{(At)^3}{3!} + \\dots = \\sum_{k=0}^\\infty \\frac{(At)^k}{k!}\n$$\n其中 $I$ 是单位矩阵。\n\n**2. 特解（常数变易法）：**\n为求特解，我们使用常数变易法，其中常数矢量 $C$ 被提升为一个随时间变化的函数 $c(t)$。我们假设一个形式如下的解：\n$$\ny(t) = e^{At} c(t)\n$$\n将此代入原始的非齐次ODE中：\n$$\n\\frac{d}{dt} [e^{At} c(t)] = A [e^{At} c(t)] + s\n$$\n对左侧应用微分的乘法法则：\n$$\n\\left(\\frac{d}{dt} e^{At}\\right) c(t) + e^{At} \\frac{d}{dt} c(t) = A e^{At} c(t) + s\n$$\n矩阵指数的导数是 $\\frac{d}{dt} e^{At} = A e^{At}$。代入后得到：\n$$\nA e^{At} c(t) + e^{At} \\frac{d}{dt} c(t) = A e^{At} c(t) + s\n$$\n项 $A e^{At} c(t)$ 在两侧抵消，剩下：\n$$\ne^{At} \\frac{d}{dt} c(t) = s\n$$\n乘以 $e^{At}$ 的逆，即 $e^{-At}$：\n$$\n\\frac{d}{dt} c(t) = e^{-At} s\n$$\n对两边从 $\\tau=0$ 到 $\\tau=t$ 进行积分：\n$$\n\\int_0^t \\frac{d}{d\\tau} c(\\tau) \\,d\\tau = \\int_0^t e^{-A\\tau} s \\,d\\tau\n$$\n$$\nc(t) - c(0) = \\int_0^t e^{-A\\tau} s \\,d\\tau\n$$\n\n**3. 组合并应用初始条件：**\n完整解为 $y(t) = e^{At} c(t) = e^{At} \\left(c(0) + \\int_0^t e^{-A\\tau} s \\,d\\tau\\right)$。\n在 $t=0$ 时，我们有 $y(0) = y_0$。将此应用于我们的解的形式：\n$$\ny(0) = e^{A \\cdot 0} c(0) = I c(0) = c(0)\n$$\n因此，积分常数矢量就是初始条件矢量，即 $c(0) = y_0$。\n将其代回，完整的解为：\n$$\ny(t) = e^{At} \\left(y_0 + \\int_0^t e^{-A\\tau} s \\,d\\tau\\right) = e^{At} y_0 + e^{At} \\int_0^t e^{-A\\tau} s \\,d\\tau\n$$\n通过将 $e^{At}$ 移到积分内部（因为它相对于积分变量 $\\tau$ 是常数），可以简化积分项：\n$$\ny(t) = e^{At} y_0 + \\int_0^t e^{A(t-\\tau)} s \\,d\\tau\n$$\n由于 $A$ 和 $s$ 是常数，并且对于给定的测试用例（所有 $\\lambda_i > 0$）$A$ 是可逆的，该积分可以直接求值：\n$$\n\\int_0^t e^{A(t-\\tau)} s \\,d\\tau = \\left[ -A^{-1} e^{A(t-\\tau)} \\right]_{\\tau=0}^{\\tau=t} s = \\left( -A^{-1} e^{A \\cdot 0} - (-A^{-1} e^{At}) \\right) s = A^{-1} (e^{At} - I) s\n$$\n因此，最终的解析解是：\n$$\ny_{\\text{exact}}(t) = e^{At} y_0 + A^{-1}(e^{At} - I)s\n$$\n此形式将用于在 $t=T$ 时的精确计算。\n\n### 步骤2：数值实现\n\n问题指定了一个采用显式时间推进的一阶数值格式。该ODE系统为：\n$$\n\\frac{d N_1}{dt} = -\\lambda_1 N_1 + q \\\\\n\\frac{d N_2}{dt} = b_1 \\lambda_1 N_1 - \\lambda_2 N_2 \\\\\n\\frac{d N_3}{dt} = b_2 \\lambda_2 N_2 - \\lambda_3 N_3\n$$\n数值方法是基于时间步长 $\\Delta t$ 的前向欧拉更新规则。设 $y^n$ 表示在时间 $t_n = n \\Delta t$ 时的核素密度矢量。下一个时间步的矢量 $y^{n+1}$ 通过将导数近似为 $\\frac{dy}{dt} \\approx \\frac{y^{n+1} - y^n}{\\Delta t}$ 并在时间 $t_n$ 处计算右侧项得到。\n$$\n\\frac{y^{n+1} - y^n}{\\Delta t} = A y^n + s\n$$\n这给出了更新规则：\n$$\ny^{n+1} = y^n + \\Delta t (A y^n + s)\n$$\n该公式与问题描述中“在每个顺序更新步骤中对母核素使用‘更新前的值’”的要求一致。实现将从初始条件 $y_{\\text{num}}(0) = y_0$ 开始，并迭代应用此公式总共 $N = T / \\Delta t$ 步，以找到 $y_{\\text{num}}(T)$。\n\n### 步骤3：误差范数计算\n\n在最终时间 $T$，我们将得到解析解 $y_{\\text{exact}}(T)$ 和数值近似解 $y_{\\text{num}}(T)$。相对误差范数的计算如下：\n\n相对 $L^2$（欧几里得）范数误差：\n$$\nE_2 = \\frac{\\|y_{\\text{num}}(T) - y_{\\text{exact}}(T)\\|_2}{\\|y_{\\text{exact}}(T)\\|_2} = \\frac{\\sqrt{\\sum_{i=1}^3 (N_{i, \\text{num}}(T) - N_{i, \\text{exact}}(T))^2}}{\\sqrt{\\sum_{i=1}^3 (N_{i, \\text{exact}}(T))^2}}\n$$\n相对 $L^\\infty$（最大值）范数误差：\n$$\nE_\\infty = \\frac{\\|y_{\\text{num}}(T) - y_{\\text{exact}}(T)\\|_\\infty}{\\|y_{\\text{exact}}(T)\\|_\\infty} = \\frac{\\max_i |N_{i, \\text{num}}(T) - N_{i, \\text{exact}}(T)|}{\\max_i |N_{i, \\text{exact}}(T)|}\n$$\n将为提供的每个测试用例计算这些量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the nuclear depletion problem for a set of test cases.\n    For each case, it computes the exact solution and a numerical approximation,\n    then calculates the relative L2 and L-infinity error norms.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path, moderate time step)\n        {'lambda1': 0.02, 'lambda2': 0.15, 'lambda3': 1e-6, 'b1': 1.0, 'b2': 1.0, 'q': 1e19,\n         'y0': np.array([2e20, 0, 0]), 'dt': 0.5, 'T': 10.0},\n        # Case 2 (small time step boundary)\n        {'lambda1': 0.02, 'lambda2': 0.15, 'lambda3': 1e-6, 'b1': 1.0, 'b2': 1.0, 'q': 1e19,\n         'y0': np.array([2e20, 0, 0]), 'dt': 0.01, 'T': 10.0},\n        # Case 3 (large time step stress)\n        {'lambda1': 0.02, 'lambda2': 0.15, 'lambda3': 1e-6, 'b1': 1.0, 'b2': 1.0, 'q': 1e19,\n         'y0': np.array([2e20, 0, 0]), 'dt': 2.0, 'T': 10.0},\n        # Case 4 (stiff chain)\n        {'lambda1': 5.0, 'lambda2': 0.05, 'lambda3': 1e-5, 'b1': 1.0, 'b2': 1.0, 'q': 1e19,\n         'y0': np.array([1e19, 2e18, 0]), 'dt': 0.1, 'T': 10.0},\n        # Case 5 (near-degenerate equal rates)\n        {'lambda1': 0.1, 'lambda2': 0.1, 'lambda3': 0.1, 'b1': 1.0, 'b2': 1.0, 'q': 5e18,\n         'y0': np.array([1e20, 5e19, 0]), 'dt': 0.5, 'T': 10.0},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        l1, l2, l3 = case['lambda1'], case['lambda2'], case['lambda3']\n        b1, b2 = case['b1'], case['b2']\n        q = case['q']\n        y0 = case['y0'].astype(np.float64).reshape(3, 1)\n        dt = case['dt']\n        T = case['T']\n\n        # Define the system matrix A and source vector s\n        A = np.array([\n            [-l1, 0, 0],\n            [b1 * l1, -l2, 0],\n            [0, b2 * l2, -l3]\n        ], dtype=np.float64)\n        \n        s = np.array([q, 0, 0], dtype=np.float64).reshape(3, 1)\n\n        # 1. Analytic Solution\n        # y_exact(t) = exp(At) * y0 + A_inv * (exp(At) - I) * s\n        I = np.identity(3)\n        A_inv = np.linalg.inv(A)\n        exp_At = expm(A * T)\n        \n        term1 = exp_At @ y0\n        term2 = A_inv @ (exp_At - I) @ s\n        y_exact_T = term1 + term2\n\n        # 2. Numerical Solution (Forward Euler)\n        # y_n+1 = y_n + dt * (A * y_n + s)\n        num_steps = int(round(T / dt))\n        y_num = y0.copy()\n        \n        for _ in range(num_steps):\n            y_num = y_num + dt * (A @ y_num + s)\n        \n        y_num_T = y_num\n\n        # 3. Error Calculation\n        diff_vec = y_num_T - y_exact_T\n        \n        # Calculate norms\n        norm_exact_2 = np.linalg.norm(y_exact_T, ord=2)\n        norm_exact_inf = np.linalg.norm(y_exact_T, ord=np.inf)\n        \n        norm_diff_2 = np.linalg.norm(diff_vec, ord=2)\n        norm_diff_inf = np.linalg.norm(diff_vec, ord=np.inf)\n\n        # Avoid division by zero if the exact solution is zero (unlikely here)\n        E2 = norm_diff_2 / norm_exact_2 if norm_exact_2 > 0 else 0.0\n        Einf = norm_diff_inf / norm_exact_inf if norm_exact_inf > 0 else 0.0\n\n        results.extend([E2, Einf])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "实际的反应堆燃耗计算可能涉及数千种核素，完整求解如此庞大的方程组在计算上是极其昂贵的。本练习聚焦于一个实际的计算效率问题：如何优化求解过程 。它引入了一种常见的优化技术——截断解中贡献可忽略的项，核心任务是为此类截断建立一个数学上稳健的准则。这突显了在大型科学计算中，如何在计算性能和求解精度之间做出权衡，这是工程与科学领域一个永恒的主题。",
            "id": "4233544",
            "problem": "在一次核反应堆模拟中，考虑一个由$L$个核素组成的线性链，在时长为$\\Delta t$的单个时间步内，条件保持恒定。每个核素$i$都由一个一阶常微分方程（ODE）描述，其有效移除率为$r_i$，该移除率汇总了所有衰变和反应损失。该链以核素1开始，生成末端核素$L$。初始数量为$N_1(0) > 0$，且对于$i \\geq 2$有$N_i(0) = 0$。根据常系数常微分方程组解的线性性，在时间步结束时，末端核素的数量可以写成衰减指数的线性组合，\n$$\nN_L(\\Delta t) = N_1(0) \\sum_{i=1}^{L} c_i \\exp(-r_i \\Delta t),\n$$\n其中系数$c_i$取决于链的连接性和$r_i$。假设一个数值实现在上述求和中截断（舍弃）任何指数项$\\exp(-r_i \\Delta t)$小于或等于一个无量纲截断值$\\eta$的项，从而形成一个截断和$N_L^{\\text{trunc}}(\\Delta t)$。\n\n假设存在一个已知界$C$，使得在给定条件下，对于该链有$\\sum_{i=1}^{L} |c_i| \\leq C$。从ODE结构和解的线性性出发，仅使用标准不等式，推导绝对截断误差$\\left|N_L(\\Delta t) - N_L^{\\text{trunc}}(\\Delta t)\\right|$关于$N_1(0)$、$\\eta$和$C$的最坏情况上界。然后，利用此界，为截断值$\\eta$推导一个保守准则，以保证绝对误差满足\n$$\n\\left|N_L(\\Delta t) - N_L^{\\text{trunc}}(\\Delta t)\\right| \\leq \\varepsilon\\, N_1(0),\n$$\n对于给定的无量纲容差$\\varepsilon > 0$。将最终答案表示为安全截断值$\\eta_{\\text{safe}}$关于$\\varepsilon$和$C$的单个闭式解析表达式。最终答案是无量纲的；无需进行舍入。",
            "solution": "首先将对问题陈述进行严格的验证。\n\n### 步骤1：提取已知条件\n以下数据和定义均按原文提供：\n- 一个由$L$个核素组成的线性链。\n- 时长为$\\Delta t$的单个时间步。\n- 时间步内条件恒定。\n- 每个核素$i \\in \\{1, 2, \\dots, L\\}$的有效移除率$r_i$。\n- 初始数量：$N_1(0) > 0$ 且对于$i \\geq 2$有$N_i(0) = 0$。\n- 末端核素数量的解析解由下式给出：$N_L(\\Delta t) = N_1(0) \\sum_{i=1}^{L} c_i \\exp(-r_i \\Delta t)$。\n- 一个数值实现基于无量纲截断值$\\eta$截断项，当一个项的指数因子满足$\\exp(-r_i \\Delta t) \\leq \\eta$时，该项被舍弃。\n- 系数上的一个已知界：$\\sum_{i=1}^{L} |c_i| \\leq C$。\n- 绝对误差的一个给定无量纲容差$\\varepsilon > 0$，使得目标为$\\left|N_L(\\Delta t) - N_L^{\\text{trunc}}(\\Delta t)\\right| \\leq \\varepsilon\\, N_1(0)$。\n\n### 步骤2：使用提取的已知条件进行验证\n依据所需标准对问题进行评估：\n- **具有科学依据**：该问题描述了一个线性核素嬗变链，这是核反应堆物理学中的一个基本模型，通常使用Bateman方程求解。控制方程是具有常系数的一阶线性常微分方程，所提供的解的形式（指数的线性组合）是此类系统的精确解析解。为提高数值效率而截断小项是计算科学中的标准做法。因此，该问题牢固地建立在已确立的科学和数学原理之上。\n- **适定的**：该问题是适定的。它提供了执行所要求推导的所有必要信息。目标——推导误差界和由此产生的截断准则——定义清晰。变量之间的关系是明确的，没有缺失或矛盾的约束。可以从给定信息中推导出安全截断值的唯一且有意义的解析表达式。\n- **客观的**：该问题以精确、正式且无偏见的语言陈述。所有术语都有定义，任务是基于标准不等式的纯数学推导。它不含主观性或非科学性论断。\n\n### 步骤3：结论与行动\n该问题是有效的。它在科学上合理、适定且客观。我现在将开始推导解答。\n\n绝对截断误差（我们记为$E_{\\text{abs}}$）是精确解$N_L(\\Delta t)$与截断解$N_L^{\\text{trunc}}(\\Delta t)$之差的绝对值。\n$$\nE_{\\text{abs}} = \\left|N_L(\\Delta t) - N_L^{\\text{trunc}}(\\Delta t)\\right|\n$$\n令全体索引集为$\\mathcal{I} = \\{1, 2, \\dots, L\\}$。截断规则将此集合划分为两个不相交的子集：保留项的索引集$\\mathcal{K}$和截断项的索引集$\\mathcal{T}$。\n$$\n\\mathcal{K} = \\{i \\in \\mathcal{I} \\mid \\exp(-r_i \\Delta t) > \\eta\\}\n$$\n$$\n\\mathcal{T} = \\{i \\in \\mathcal{I} \\mid \\exp(-r_i \\Delta t) \\leq \\eta\\}\n$$\n精确解和截断解可以写为：\n$$\nN_L(\\Delta t) = N_1(0) \\sum_{i \\in \\mathcal{I}} c_i \\exp(-r_i \\Delta t)\n$$\n$$\nN_L^{\\text{trunc}}(\\Delta t) = N_1(0) \\sum_{i \\in \\mathcal{K}} c_i \\exp(-r_i \\Delta t)\n$$\n误差是被舍弃项的和：\n$$\nE_{\\text{abs}} = \\left| N_1(0) \\sum_{i \\in \\mathcal{I}} c_i \\exp(-r_i \\Delta t) - N_1(0) \\sum_{i \\in \\mathcal{K}} c_i \\exp(-r_i \\Delta t) \\right|\n$$\n$$\nE_{\\text{abs}} = \\left| N_1(0) \\left( \\sum_{i \\in \\mathcal{I}} c_i \\exp(-r_i \\Delta t) - \\sum_{i \\in \\mathcal{K}} c_i \\exp(-r_i \\Delta t) \\right) \\right|\n$$\n由于$\\mathcal{I} = \\mathcal{K} \\cup \\mathcal{T}$，这两个和的差是关于集合$\\mathcal{T}$的求和：\n$$\nE_{\\text{abs}} = \\left| N_1(0) \\sum_{i \\in \\mathcal{T}} c_i \\exp(-r_i \\Delta t) \\right|\n$$\n鉴于$N_1(0) > 0$，我们可以写成$|N_1(0)| = N_1(0)$并将其从绝对值中提出：\n$$\nE_{\\text{abs}} = N_1(0) \\left| \\sum_{i \\in \\mathcal{T}} c_i \\exp(-r_i \\Delta t) \\right|\n$$\n对求和应用三角不等式（即$|\\sum z_i| \\leq \\sum |z_i|$）：\n$$\nE_{\\text{abs}} \\leq N_1(0) \\sum_{i \\in \\mathcal{T}} \\left| c_i \\exp(-r_i \\Delta t) \\right| = N_1(0) \\sum_{i \\in \\mathcal{T}} |c_i| |\\exp(-r_i \\Delta t)|\n$$\n由于实值指数函数总是非负的，因此$|\\exp(-r_i \\Delta t)| = \\exp(-r_i \\Delta t)$。\n$$\nE_{\\text{abs}} \\leq N_1(0) \\sum_{i \\in \\mathcal{T}} |c_i| \\exp(-r_i \\Delta t)\n$$\n根据集合$\\mathcal{T}$的定义，对于每个索引$i \\in \\mathcal{T}$，不等式$\\exp(-r_i \\Delta t) \\leq \\eta$成立。我们可以用这个上界替换求和中的指数项，这会保持或放宽该不等式：\n$$\nE_{\\text{abs}} \\leq N_1(0) \\sum_{i \\in \\mathcal{T}} |c_i| \\eta\n$$\n从求和中提出因子$\\eta$：\n$$\nE_{\\text{abs}} \\leq N_1(0) \\eta \\sum_{i \\in \\mathcal{T}} |c_i|\n$$\n我们已知界$\\sum_{i=1}^{L} |c_i| \\leq C$。由于和$\\sum_{i \\in \\mathcal{T}} |c_i|$是对索引集$\\{1, \\dots, L\\}$的一个子集求和，且每一项$|c_i|$都是非负的，所以这个部分和必须小于或等于总和。\n$$\n\\sum_{i \\in \\mathcal{T}} |c_i| \\leq \\sum_{i=1}^{L} |c_i| \\leq C\n$$\n将此代入我们的误差不等式，得到绝对截断误差的最坏情况上界：\n$$\nE_{\\text{abs}} \\leq N_1(0) C \\eta\n$$\n这就完成了推导的第一部分。\n\n对于第二部分，我们必须为$\\eta$推导一个准则，以保证满足误差容差。要求是：\n$$\nE_{\\text{abs}} \\leq \\varepsilon N_1(0)\n$$\n为确保满足此条件，我们可以强制要求我们推导出的$E_{\\text{abs}}$上界小于或等于所需的容差极限。这是一种保守的方法。\n$$\nN_1(0) C \\eta \\leq \\varepsilon N_1(0)\n$$\n由于$N_1(0) > 0$，我们可以在不等式两边同时除以$N_1(0)$而不影响不等号的方向：\n$$\nC \\eta \\leq \\varepsilon\n$$\n为了解出$\\eta$，我们必须考虑$C$的值。因为$C$是一系列绝对值之和的上界，所以$C \\geq 0$。如果$C=0$，则所有的$c_i$都必须为0，这意味着$N_L(\\Delta t) = 0$，误差恒为0。不等式$0 \\leq \\varepsilon$对任何$\\eta$都成立。然而，一个非平凡的链将有$C > 0$。假设$C > 0$，我们可以除以$C$：\n$$\n\\eta \\leq \\frac{\\varepsilon}{C}\n$$\n这个不等式就是截断值$\\eta$的保守准则。任何满足此条件的$\\eta$的选择都是“安全”的。问题要求一个“安全截断值$\\eta_{\\text{safe}}$”的表达式。这意味着要为$\\eta$选择一个特定的值。为了在保证误差界的同时最大化截断项的数量（从而节省计算量），我们应该选择仍然安全的$\\eta$的最大可能值。这对应于准则中等号成立的情况。\n$$\n\\eta_{\\text{safe}} = \\frac{\\varepsilon}{C}\n$$\n这就是安全截断值关于给定参数$\\varepsilon$和$C$的最终表达式。",
            "answer": "$$\\boxed{\\frac{\\varepsilon}{C}}$$"
        }
    ]
}