{
    "hands_on_practices": [
        {
            "introduction": "理解燃耗相关截面的第一步是掌握其变化的物理根源。这个练习将指导你从第一性原理出发，推导由于特定裂变产物的累积而引起的宏观吸收截面的变化。通过求解核素平衡方程并将其与燃耗联系起来，你将亲手建立微观核数据（如裂变产额和衰变常数）与宏观反应堆参数之间的定量关系。",
            "id": "4216435",
            "problem": "一个均匀无限轻水反应堆 (LWR) 栅格在恒定的体积功率密度 $p_{0}$ 下运行，初始时不含稀土裂变产物。考虑一组指定的稀土裂变产物 $\\{i=1,\\dots,m\\}$，它们由裂变直接产生，每次裂变的独立产额为 $y_{i}$。每种产物 $i$ 都有一个衰变常数 $\\lambda_{i} \\ge 0$ 和在能量群 $g$ 中的分群微观吸收截面 $\\sigma_{a,i,g}$，其中 $g$ 是固定的。假设如下：\n- 重金属质量密度为 $\\rho_{\\mathrm{HM}}$。\n- 每次裂变释放的能量为 $E_{f}$。\n- 稀土裂变产物仅由裂变直接产生，且仅因放射性衰变而损失（没有中子吸收移除或化学移除）。\n- 在所考虑的时间尺度上，反应堆是均匀的，中子场是稳态的，因此产物生成在空间上是均匀的，且与 $p_{0}$ 成正比。\n- 在燃耗 $B=0$ 时，每种稀土产物 $i$ 的初始核素密度为零。\n\n燃耗 $B$ 定义为 $B = \\int_{0}^{t} p(t') \\, dt' / \\rho_{\\mathrm{HM}}$，在恒定功率密度的假设下，这等于 $B = p_{0} t / \\rho_{\\mathrm{HM}}$。利用将裂变率密度与 $p_{0}$ 关联的基本速率定义 $f = p_{0}/E_{f}$、第 $i$ 种产物的核素数量平衡方程，以及宏观吸收截面定义为各核素 $i$ 的核素密度乘以其微观截面之和，推导仅由这些稀土裂变产物的累积引起的、能量群 $g$ 中宏观吸收截面随燃耗变化的精确闭式表达式 $\\Delta \\Sigma_{a,g}(B)$。\n\n将您的最终解析答案表示为 $B$ 和参数 $\\{y_{i}\\}$、$\\{\\lambda_{i}\\}$、$\\{\\sigma_{a,i,g}\\}$、$p_{0}$、$\\rho_{\\mathrm{HM}}$ 和 $E_{f}$ 的函数，通过在适当情况下解释表达式在 $\\lambda_{i} \\to 0$ 极限下的行为，使其适用于所有 $\\lambda_{i} \\ge 0$。不需要进行数值计算。结果以逆米为单位表示。最终答案必须是单个闭式表达式。",
            "solution": "首先根据指定标准对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 系统：一个均匀无限轻水反应堆 (LWR) 栅格。\n- 运行条件：恒定体积功率密度，$p_{0}$。\n- 裂变产物：一组 $m$ 种稀土产物，索引为 $i=1,\\dots,m$。\n- 初始条件：在燃耗 $B=0$（对应时间 $t=0$）时，每种产物 $i$ 的核素密度为零。\n- 生成机制：产物由裂变直接生成，每次裂变的独立产额为 $y_{i}$。\n- 损失机制：产物仅因放射性衰变而损失，衰变常数为 $\\lambda_{i} \\ge 0$。明确排除了中子吸收移除。\n- 材料属性：重金属质量密度为 $\\rho_{\\mathrm{HM}}$。\n- 物理常数：每次裂变释放的能量为 $E_{f}$。\n- 截面：产物 $i$ 在能量群 $g$ 中的微观吸收截面为 $\\sigma_{a,i,g}$，其中 $g$ 是固定的。\n- 反应堆模型：反应堆是均匀的，中子场是稳态的，意味着产物生成速率在空间上均匀且恒定。\n- 定义：\n    - 燃耗：$B = \\int_{0}^{t} p(t') \\, dt' / \\rho_{\\mathrm{HM}}$。对于恒定功率 $p_0$，这简化为 $B = p_{0} t / \\rho_{\\mathrm{HM}}$。\n    - 裂变率密度：$f = p_{0}/E_{f}$。\n    - 宏观吸收截面：各种核素 $i$ 的核素密度 $N_i$ 与微观截面 $\\sigma_{a,i,g}$ 的乘积之和。\n- 目标：推导能量群 $g$ 中宏观吸收截面随燃耗变化的精确闭式表达式 $\\Delta \\Sigma_{a,g}(B)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于核反应堆物理学原理，特别是裂变产物中毒和反应堆动力学理论。所有术语、变量和概念都是该领域的标准用法。\n- **适定性：** 该问题是适定的。它提供了明确的目标、一套完整的初始条件 ($N_i(t=0)=0$)，以及求解每种核素的核素密度并随后计算宏观截面变化所需的所有物理量和关系。恒定功率和仅通过衰变损失等假设使问题易于解析求解，且不会引入歧义。存在唯一解。\n- **客观性：** 问题陈述使用精确、客观和定量的语言，不含任何主观或偏见成分。\n\n该问题没有表现出任何列出的缺陷（例如，科学上不健全、不完整、矛盾等）。这是反应堆物理学中一个标准的、可解的问题。\n\n**步骤 3：结论与行动**\n问题有效。将推导解答。\n\n**推导**\n\n问题的核心是确定每种稀土裂变产物 $i$ 的核素密度 $N_i(t)$ 作为时间 $t$ 的函数，然后将其表示为燃耗 $B$ 的函数，以计算宏观吸收截面的变化。\n\n核素 $i$ 的数量平衡由一个一阶常微分方程描述：\n$$ \\frac{dN_i(t)}{dt} = (\\text{Rate of production of } i) - (\\text{Rate of loss of } i) $$\n\n单位体积的生成速率是裂变率密度 $f$ 和核素 $i$ 的裂变产额 $y_i$ 的乘积。问题陈述，裂变率密度通过 $f = p_0 / E_f$ 与恒定体积功率密度 $p_0$ 和每次裂变能量 $E_f$ 相关联。因此，生成速率是一个常数，$y_i p_0 / E_f$。\n\n单位体积的损失速率仅由放射性衰变引起。这由衰变常数 $\\lambda_i$ 和核素密度 $N_i(t)$ 的乘积给出。\n\n结合这些项，核素 $i$ 的核素密度微分方程为：\n$$ \\frac{dN_i(t)}{dt} = \\frac{y_i p_0}{E_f} - \\lambda_i N_i(t) $$\n这是一个线性一阶微分方程。我们可以将其重排为标准形式：\n$$ \\frac{dN_i(t)}{dt} + \\lambda_i N_i(t) = \\frac{y_i p_0}{E_f} $$\n问题中给出的初始条件是 $N_i(t=0) = 0$。\n\n我们考虑衰变常数 $\\lambda_i$ 的两种情况。\n\n情况 1：$\\lambda_i > 0$。\n该微分方程的通解可以使用积分因子 $I(t) = \\exp(\\int \\lambda_i dt) = \\exp(\\lambda_i t)$ 求得。将方程乘以 $I(t)$ 得到：\n$$ \\exp(\\lambda_i t) \\frac{dN_i(t)}{dt} + \\lambda_i \\exp(\\lambda_i t) N_i(t) = \\frac{y_i p_0}{E_f} \\exp(\\lambda_i t) $$\n左边是乘积的导数：\n$$ \\frac{d}{dt} \\left( N_i(t) \\exp(\\lambda_i t) \\right) = \\frac{y_i p_0}{E_f} \\exp(\\lambda_i t) $$\n对两边关于 $t$ 积分：\n$$ N_i(t) \\exp(\\lambda_i t) = \\int \\frac{y_i p_0}{E_f} \\exp(\\lambda_i t) dt = \\frac{y_i p_0}{E_f \\lambda_i} \\exp(\\lambda_i t) + C $$\n其中 $C$ 是积分常数。求解 $N_i(t)$：\n$$ N_i(t) = \\frac{y_i p_0}{E_f \\lambda_i} + C \\exp(-\\lambda_i t) $$\n使用初始条件 $N_i(0)=0$：\n$$ N_i(0) = 0 = \\frac{y_i p_0}{E_f \\lambda_i} + C \\exp(0) \\implies C = -\\frac{y_i p_0}{E_f \\lambda_i} $$\n将 $C$ 的值代回 $N_i(t)$ 的解中：\n$$ N_i(t) = \\frac{y_i p_0}{E_f \\lambda_i} - \\frac{y_i p_0}{E_f \\lambda_i} \\exp(-\\lambda_i t) = \\frac{y_i p_0}{E_f \\lambda_i} \\left( 1 - \\exp(-\\lambda_i t) \\right) $$\n\n情况 2：$\\lambda_i = 0$ (稳定核素)。\n微分方程简化为：\n$$ \\frac{dN_i(t)}{dt} = \\frac{y_i p_0}{E_f} $$\n关于 $t$ 积分并应用初始条件 $N_i(0)=0$：\n$$ N_i(t) = \\int_{0}^{t} \\frac{y_i p_0}{E_f} dt' = \\frac{y_i p_0}{E_f} t $$\n值得注意的是，$\\lambda_i=0$ 情况的解可以通过对 $\\lambda_i > 0$ 的解取 $\\lambda_i \\to 0$ 的极限得到，使用泰勒展开 $\\exp(-x) \\approx 1-x$ (对于小的 $x$) 或洛必达法则。\n$$ \\lim_{\\lambda_i \\to 0} \\frac{y_i p_0}{E_f} \\frac{1 - \\exp(-\\lambda_i t)}{\\lambda_i} = \\frac{y_i p_0}{E_f} \\lim_{\\lambda_i \\to 0} \\frac{t \\exp(-\\lambda_i t)}{1} = \\frac{y_i p_0}{E_f} t $$\n因此，当对 $\\lambda_i=0$ 取极限时，$\\lambda_i>0$ 的表达式适用于所有 $\\lambda_i \\ge 0$。\n\n接下来，我们将时间变量 $t$ 表示为燃耗 $B$ 的函数。问题定义 $B = p_0 t / \\rho_{\\mathrm{HM}}$。整理可得 $t$：\n$$ t = \\frac{B \\rho_{\\mathrm{HM}}}{p_0} $$\n将此代入 $N_i(t)$ 的通式中，得到 $N_i(B)$：\n$$ N_i(B) = \\frac{y_i p_0}{E_f \\lambda_i} \\left( 1 - \\exp\\left(-\\lambda_i \\frac{B \\rho_{\\mathrm{HM}}}{p_0}\\right) \\right) $$\n\n能量群 $g$ 中宏观吸收截面的变化 $\\Delta \\Sigma_{a,g}(B)$，是燃耗为 $B$ 时与燃耗为 $B=0$ 时的宏观截面之差。\n$$ \\Delta \\Sigma_{a,g}(B) = \\Sigma_{a,g}(B) - \\Sigma_{a,g}(0) $$\n任意燃耗下的宏观截面是所有 $m$ 种裂变产物贡献的总和：\n$$ \\Sigma_{a,g}(B) = \\sum_{i=1}^{m} N_i(B) \\sigma_{a,i,g} $$\n在燃耗 $B=0$ 时，核素密度 $N_i(0)=0$，因此 $\\Sigma_{a,g}(0) = 0$。\n因此，变化量就是 $\\Delta \\Sigma_{a,g}(B) = \\Sigma_{a,g}(B)$。\n$$ \\Delta \\Sigma_{a,g}(B) = \\sum_{i=1}^{m} N_i(B) \\sigma_{a,i,g} $$\n代入 $N_i(B)$ 的表达式：\n$$ \\Delta \\Sigma_{a,g}(B) = \\sum_{i=1}^{m} \\sigma_{a,i,g} \\left[ \\frac{y_i p_0}{E_f \\lambda_i} \\left( 1 - \\exp\\left(-\\lambda_i \\frac{B \\rho_{\\mathrm{HM}}}{p_0}\\right) \\right) \\right] $$\n重新整理各项以组合常数，得到最终的闭式表达式：\n$$ \\Delta \\Sigma_{a,g}(B) = \\frac{p_0}{E_f} \\sum_{i=1}^{m} \\frac{y_i \\sigma_{a,i,g}}{\\lambda_i} \\left( 1 - \\exp\\left(-\\frac{\\lambda_i \\rho_{\\mathrm{HM}}}{p_0} B \\right) \\right) $$\n该表达式对所有 $\\lambda_i \\ge 0$ 均有效，但需要理解，对于任何 $\\lambda_i = 0$ 的项，表达式 $\\frac{1}{\\lambda_i} \\left( 1 - \\exp\\left(-\\frac{\\lambda_i \\rho_{\\mathrm{HM}}}{p_0} B \\right) \\right)$ 应被其极限值 $\\frac{\\rho_{\\mathrm{HM}}}{p_0} B$ 替代。\n这给出了稳定核素的贡献为 $\\frac{p_0}{E_f} y_i \\sigma_{a,i,g} \\frac{\\rho_{\\mathrm{HM}}}{p_0} B = \\frac{y_i \\sigma_{a,i,g} \\rho_{\\mathrm{HM}}}{E_f} B$，这与从 $N_i(B) = \\frac{y_i B \\rho_{\\mathrm{HM}}}{E_f}$ 直接计算的结果相符。\n按要求给出最终的单一表达式，并暗含对任何 $\\lambda_i=0$ 情况的极限解释。",
            "answer": "$$ \\boxed{ \\frac{p_0}{E_f} \\sum_{i=1}^{m} \\frac{y_i \\sigma_{a,i,g}}{\\lambda_i} \\left( 1 - \\exp\\left(-\\frac{\\lambda_i \\rho_{\\mathrm{HM}}}{p_0} B \\right) \\right) } $$"
        },
        {
            "introduction": "既然我们知道了截面随燃耗演化，下一个关键问题是在计算机模拟中如何精确地处理这种变化。简单的数值近似，例如在燃耗步中点进行线性插值，可能会导致违反能量守恒等严重误差。本练习将挑战你分析一种常见的计算捷径的失效模式，并理解更精确、更一致的数值方案（如预测-校正法）背后的原理。",
            "id": "4216382",
            "problem": "反应堆燃耗计算在一个从时间 $t_n$ 到 $t_{n+1}=t_n+\\Delta t$ 的单一燃耗步长内，以目标燃耗增量 $\\Delta BU$ 推进核素数密度 $N_i(t)$ 和中子注量率谱 $\\phi_g(\\mathbf{r},t)$。令 $M_{\\text{fuel}}$ 表示燃料质量，$E_f$ 表示每次裂变释放的平均能量，$\\nu$ 表示每次裂变的平均中子数。瞬时反应堆功率 $P(t)$ 由下式给出\n$$\nP(t) \\;=\\; \\int_V \\sum_{g} \\phi_g(\\mathbf{r},t)\\,\\nu\\,\\Sigma_{f,g}\\!\\left(N(t)\\right)(\\mathbf{r})\\,E_f \\, d\\mathbf{r},\n$$\n燃耗率定义为\n$$\n\\frac{d\\,BU}{dt} \\;=\\; \\frac{P(t)}{M_{\\text{fuel}}}.\n$$\n此处，$\\Sigma_{f,g}\\!\\left(N(t)\\right)$ 是能量群 $g$ 中的宏观裂变截面，是随时间变化的数密度 $N(t)=\\{N_i(t)\\}$ 的泛函。\n\n一种常见的编程捷径是，在一个猜测的步中燃耗点上通过线性插值截面来构建一个步中宏观数据集，并使用这些截面进行单次注量率求解，以代表整个步长。考虑为什么这种捷径会违反能量平衡方程\n$$\nM_{\\text{fuel}}\\,\\Delta BU \\;=\\; \\int_{t_n}^{t_{n+1}} P(t)\\,dt,\n$$\n以及在给定 $\\phi(t)$ 和 $\\Sigma_{f}(N(t))$ 耦合依赖关系的情况下，如何以数值上一致的方式强制实现这种平衡。\n\n哪个选项最好地解释了这种失效模式，并提出了一个能在一个步长内强制实现能量平衡的一致方案？\n\nA) 线性步中插值假设反应率随燃耗线性变化，但注量率 $\\phi(t)$ 和宏观截面 $\\Sigma_f(N(t))$ 都非线性地演变，并通过 $N(t)$ 耦合，因此对于任何固定的 $\\phi^\\star$，都有 $\\int_{t_n}^{t_{n+1}} \\phi(t)\\,\\Sigma_f(N(t))\\,dt \\neq \\Delta t\\,\\phi^\\star\\,\\Sigma_f^{\\text{mid}}$。一个一致的修正方法是，通过对 $N(t)$ 进行预估-校正燃耗来计算端点解 $(\\phi^{n},\\Sigma_f^{n})$ 和 $(\\phi^{n+1},\\Sigma_f^{n+1})$，形成步长平均量 $(\\phi^{\\text{avg}},\\Sigma_f^{\\text{avg}})$，然后确定一个注量率归一化因子 $\\alpha$，使得\n$$\nM_{\\text{fuel}}\\,\\Delta BU \\;=\\; \\Delta t \\int_V \\sum_g \\alpha\\,\\phi^{\\text{avg}}_g(\\mathbf{r})\\,\\nu\\,\\Sigma^{\\text{avg}}_{f,g}(\\mathbf{r})\\,E_f\\,d\\mathbf{r}。\n$$\n在燃耗更新中使用 $\\alpha\\,\\phi^{\\text{avg}}$ 会产生一个保持反应率的步长，该步长通过其构造强制实现了能量平衡。\n\nB) 因为每次裂变的平均能量 $E_f$ 近似恒定，所以在步中燃耗点对截面进行线性插值是能量守恒的。正确的强制方案是仅在步长开始时计算注量率，并在整个步长中重复使用它，这样可以保持功率恒定，从而保持燃耗积分。\n\nC) 这种违背主要源于宏观数据中的未分辨共振自屏效应。修正方法是对步中宏观截面应用共振自屏修正；在自屏效应被修正后，步中插值就变得功率守恒，无需与注量率或燃耗解进行任何额外的耦合。\n\nD) 步中插值破坏能量守恒，仅仅是因为步长 $\\Delta t$ 太大。正确的方法是减小 $\\Delta t$，直到 $\\Sigma_f$ 的变化可以忽略不计；如果使用足够小的步长，则不需要注量率重归一化或步长平均，因为此时中点法则将精确地保持燃耗积分。",
            "solution": "用户需要对反应堆燃耗计算中一种常见的数值捷径进行批判性分析，并评估为解决其缺点而提出的方法。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **状态变量：** 核素数密度 $N_i(t)$，中子注量率谱 $\\phi_g(\\mathbf{r},t)$。\n*   **时间离散化：** 从时间 $t_n$ 到 $t_{n+1}=t_n+\\Delta t$ 的单一燃耗步长。\n*   **目标增量：** 一个特定的目标燃耗增量 $\\Delta BU$。\n*   **常数和参数：** 燃料质量 $M_{\\text{fuel}}$，每次裂变释放的平均能量 $E_f$，每次裂变的平均中子数 $\\nu$。\n*   **控制方程和定义：**\n    *   瞬时反应堆功率：$P(t) \\;=\\; \\int_V \\sum_{g} \\phi_g(\\mathbf{r},t)\\,\\nu\\,\\Sigma_{f,g}\\!\\left(N(t)\\right)(\\mathbf{r})\\,E_f \\, d\\mathbf{r}$。\n    *   宏观裂变截面 $\\Sigma_{f,g}\\!\\left(N(t)\\right)$ 是随时间变化的数密度矢量 $N(t)$ 的泛函。\n    *   燃耗率：$\\frac{d\\,BU}{dt} \\;=\\; \\frac{P(t)}{M_{\\text{fuel}}}$。\n    *   步长上的能量平衡：$M_{\\text{fuel}}\\,\\Delta BU \\;=\\; \\int_{t_n}^{t_{n+1}} P(t)\\,dt$。\n*   **待分析的数值捷径：** 一种步中插值方法，其中宏观截面在一个猜测的步中燃耗点确定，然后与一次注量率求解一起使用，以代表整个步长。\n*   **目标：** 解释为什么这种捷径会违反能量平衡，并确定一个数值上一致的方案来强制实现它。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n*   **科学依据：** 是。该问题描述了计算反应堆物理学中的一个核心挑战：中子输运和核素燃耗方程耦合系统的数值时间积分。所呈现的变量、方程和概念（$P(t)$, $\\Delta BU$, $\\phi_g$, $\\Sigma_{f,g}$, 预估-校正方法）是该领域的标准和基础。\n*   **适定性：** 是。问题定义清晰。它要求分析特定数值近似的失效模式，并从选项列表中确定一个更优、一致的方法。这是反应堆分析数值方法中的一个标准概念性问题。\n*   **客观性：** 是。该问题使用核工程和数值分析的精确、标准术语陈述。它没有歧义和主观性。\n\n**步骤 3：结论和行动**\n\n问题陈述是**有效的**。它在科学上是合理的、适定的、客观的，并准确地反映了核反应堆模拟领域中一个真实而非凡的问题。我将继续进行求解推导和选项分析。\n\n### 推导与求解\n\n问题的核心在于中子注量率 $\\phi$ 和核素浓度 $N$ 之间的耦合。核素浓度根据燃耗方程演变，这是一组形式为 $\\frac{dN_i}{dt} = \\text{生成项}_i - \\text{损耗项}_i$ 的一阶常微分方程组。这些方程中的反应率取决于注量率，例如 $\\sigma_j \\phi N_j$。反过来，中子注量率 $\\phi$ 是中子输运（或扩散）方程的解，其系数（宏观截面 $\\Sigma$）又取决于核素浓度，例如 $\\Sigma_x = \\sum_i N_i \\sigma_{x,i}$。\n\n这就形成了一个刚性的非线性耦合系统。在一个从 $t_n$ 到 $t_{n+1}$ 的时间步长内进行燃耗计算，需要计算此区间上的反应率积分。产生的总能量与该区间内的总裂变数成正比：\n$$\nM_{\\text{fuel}}\\,\\Delta BU = \\int_{t_n}^{t_{n+1}} P(t) dt = E_f \\int_{t_n}^{t_{n+1}} \\left( \\int_V \\sum_g \\phi_g(\\mathbf{r}, t) \\nu \\Sigma_{f,g}(N(t))(\\mathbf{r}) d\\mathbf{r} \\right) dt\n$$\n被积函数 $P(t)$ 的值在整个步长内是变化的，因为 $\\phi(\\mathbf{r},t)$ 和 $\\Sigma_{f,g}(N(t))(\\mathbf{r})$ 都在变化。随着燃料成分（从而截面）的变化，注量率的剖面和大小也会改变。\n\n**分析“捷径”**\n\n所述的捷径将积分近似为：\n$$\n\\int_{t_n}^{t_{n+1}} P(t) dt \\approx P(\\text{mid}) \\cdot \\Delta t = \\left( \\int_V \\sum_{g} \\phi_g^{\\star}(\\mathbf{r})\\,\\nu\\,\\Sigma_{f,g}^{\\text{mid}}(\\mathbf{r})\\,E_f \\, d\\mathbf{r} \\right) \\Delta t\n$$\n其中 $\\Sigma_{f,g}^{\\text{mid}}$ 是基于一个*猜测的*步中燃耗点插值得到的，而 $\\phi_g^{\\star}$ 是使用这些截面计算一次得到的。该方法失败主要有两个原因：\n1.  **非线性：** 积的积分不等于积分的积（或中点值的积）。乘积 $\\phi(t) \\Sigma_f(N(t))$ 是一个高度非线性的时间函数。用在猜测中点处的单次求值来近似其积分是一种低阶近似，会引入显著误差，特别是对于较大的 $\\Delta t$。\n2.  **不一致性：** 该捷径以一种不一致的方式将问题解耦。注量率 $\\phi^{\\star}$ 是为一种在步长开始或结束时都不存在，且可能无法准确代表真实时间平均状态的材料成分 $\\Sigma^{\\text{mid}}$ 计算的。使用 $\\phi^{\\star}$ 计算出的 $N(t)$ 的演变，通常不会导致其平均功率与用于燃耗的功率相匹配的状态。\n\n**一个一致的数值方案**\n\n解决此问题的一种稳健且广泛使用的方法是**预估-校正**方案。这种方法提高了时间积分的准确性。\n1.  **预估步：** 使用步长开始时的注量率 $\\phi^n$ 来“预估”步长结束时的核素浓度 $N^{n+1, p}$。这是一个简单的欧拉前向步。\n2.  **校正步：** 使用预估的步末浓度 $N^{n+1, p}$，计算步末截面 $\\Sigma^{n+1, p}$ 并求解步末注量率 $\\phi^{n+1,p}$。现在，我们得到了区间开始和结束时状态的估计值。可以构造一个更好的步长平均注量率和截面的近似值，例如 $\\phi^{\\text{avg}} = \\frac{1}{2}(\\phi^n + \\phi^{n+1,p})$ 和 $\\Sigma^{\\text{avg}} = \\frac{1}{2}(\\Sigma^n + \\Sigma^{n+1,p})$。然后使用这些平均值执行一个更准确的从 $N^n$ 到 $N^{n+1,c}$ 的“校正”燃耗步。这类似于梯形法则或Crank-Nicolson方法，提供二阶精度。\n3.  **强制实现能量平衡：** 问题陈述了一个目标燃耗增量 $\\Delta BU$。这意味着步长的平均功率由 $P_{\\text{avg}} = M_{\\text{fuel}} \\Delta BU / \\Delta t$ 固定。预估-校正步骤提供了准确的注量率*形状*和截面，但必须调整注量率*大小*以产生正确的总能量。我们可以为步长平均注量率引入一个缩放因子 $\\alpha$，即 $\\alpha \\phi^{\\text{avg}}$。计算该因子是为了明确地强制实现能量平衡：\n$$\nM_{\\text{fuel}}\\,\\Delta BU = \\int_{t_n}^{t_{n+1}} P(t)\\,dt \\approx \\Delta t \\int_V \\sum_g (\\alpha\\,\\phi^{\\text{avg}}_g)\\,\\nu\\,\\Sigma^{\\text{avg}}_{f,g}\\,E_f \\, d\\mathbf{r}\n$$\n求解 $\\alpha$：\n$$\n\\alpha = \\frac{M_{\\text{fuel}}\\,\\Delta BU}{\\Delta t \\int_V \\sum_g \\phi^{\\text{avg}}_g(\\mathbf{r})\\,\\nu\\,\\Sigma^{\\text{avg}}_{f,g}(\\mathbf{r})\\,E_f\\,d\\mathbf{r}}\n$$\n然后，使用从归一化注量率 $\\alpha \\phi^{\\text{avg}}$ 导出的反应率执行最终的一致性燃耗计算。这确保了计算出的总裂变数与目标燃耗增量一致。\n\n### 逐项分析\n\n**A) 线性步中插值假设反应率随燃耗线性变化，但注量率 $\\phi(t)$ 和宏观截面 $\\Sigma_f(N(t))$ 都非线性地演变，并通过 $N(t)$ 耦合，因此对于任何固定的 $\\phi^\\star$，都有 $\\int_{t_n}^{t_{n+1}} \\phi(t)\\,\\Sigma_f(N(t))\\,dt \\neq \\Delta t\\,\\phi^\\star\\,\\Sigma_f^{\\text{mid}}$。一个一致的修正方法是，通过对 $N(t)$ 进行预估-校正燃耗来计算端点解 $(\\phi^{n},\\Sigma_f^{n})$ 和 $(\\phi^{n+1},\\Sigma_f^{n+1})$，形成步长平均量 $(\\phi^{\\text{avg}},\\Sigma_f^{\\text{avg}})$，然后确定一个注量率归一化因子 $\\alpha$，使得...**\n\n该选项正确地指出了失效模式：注量率和截面的非线性、耦合演变，这使得简单的步中近似不准确。然后，它提出了一个标准的、高阶的、一致的数值解法：采用预估-校正方案获得准确的步长平均量，然后通过注量率归一化步骤来明确强制实现能量平衡（即匹配目标燃耗）。这是现代燃耗算法的教科书式描述。\n\n**结论：正确**\n\n**B) 因为每次裂变的平均能量 $E_f$ 近似恒定，所以在步中燃耗点对截面进行线性插值是能量守恒的。正确的强制方案是仅在步长开始时计算注量率，并在整个步长中重复使用它，这样可以保持功率恒定，从而保持燃耗积分。**\n\n这种说法在事实上是错误的。$E_f$ 的近似恒定与问题关系不大。非线性的主要来源是乘积 $\\phi(t) \\Sigma_f(N(t))$，而不是 $E_f$。对截面进行线性插值并不能保证能量守恒。所提出的在整个步长中使用步初注量率的方案是一种简单的一阶欧拉方法。它比步中方法精度低，远不如预估-校正方案准确。它没有以物理上有意义的方式“保持燃耗积分”；它只是对一个随时间变化的功率使用了一个拙劣的、恒定的近似。\n\n**结论：错误**\n\n**C) 这种违背主要源于宏观数据中的未分辨共振自屏效应。修正方法是对步中宏观截面应用共振自屏修正；在自屏效应被修正后，步中插值就变得功率守恒，无需与注量率或燃耗解进行任何额外的耦合。**\n\n这误诊了问题所在。共振自屏效应是在单个时间点/燃耗点*生成*有效群截面过程中的一个关键现象。然而，它并非在有限步长 $\\Delta t$ 上产生*时间积分误差*的来源。步中方法的失败是近似非线性函数时间积分时的算法误差，即使每个瞬间的截面都（通过自屏效应）被完美计算，这个误差依然存在。对步中数据应用自屏修正，并不能解决注量率和截面在整个步长内都在变化这一根本问题。\n\n**结论：错误**\n\n**D) 步中插值破坏能量守恒，仅仅是因为步长 $\\Delta t$ 太大。正确的方法是减小 $\\Delta t$，直到 $\\Sigma_f$ 的变化可以忽略不计；如果使用足够小的步长，则不需要注量率重归一化或步长平均，因为此时中点法则将精确地保持燃耗积分。**\n\n尽管任何一致的数值积分方法在步长 $\\Delta t \\to 0$ 时都会收敛到正确解，但这并不是一个实用或明智的解决方案。先进数值方案的目标是以一个合理大的步长达到期望的精度，以使计算变得可行。简单地说“使用更小的步长”是一种回避实际算法问题的蛮力方法。此外，声称不需要重归一化只在极限情况下成立；对于任何有限的 $\\Delta t$，目标燃耗与计算燃耗之间都会存在差异，而像注量率归一化这样的方案正是为了消除这种差异而设计的。该选项未能提出一种高效、稳健的“一致方案”，而是建议通过增加计算开销来回避问题。\n\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "为了确保我们先进的数值方案能够准确运行，我们必须有效控制每个燃耗步长的大小。如果步长过大，即使是复杂的算法也可能失效，从而累积不可接受的误差。最后一个练习将介绍一种实用且在工业界广泛应用的自适应步长控制技术，你将根据关键截面的变化率来推导最大允许燃耗步长，从而保证计算的稳定性和保真度。",
            "id": "4216393",
            "problem": "考虑一个用于燃耗相关输运计算的双能群、无限均匀反应堆模型。设燃耗为 $B(t)$，定义为每单位重金属质量所产生的能量，其基本定义为 $B(t) = \\int_{0}^{t} P_{\\mathrm{th}}(\\tau)/M_{\\mathrm{HM}} \\, \\mathrm{d}\\tau$，其中 $P_{\\mathrm{th}}$ 是热功率，$M_{\\mathrm{HM}}$ 是重金属（HM）质量。对于能量群 $g$ 中的反应类型 $x$，宏观截面 $\\Sigma_{x,g}(B)$ 是燃耗的函数，因为核素的数密度会根据嬗变和损耗而演化。对于一个小的燃耗增量 $\\Delta B$，假设每个截面的一阶线性化为 $\\Delta \\Sigma_{x,g} \\approx \\left(\\partial \\Sigma_{x,g}/\\partial B\\right) \\Delta B$。\n\n为了在自适应时间步长（燃耗步长）方案中确保数值稳定性和物理保真度，您希望将每个燃耗步长中关键宏观截面的相对变化限制在规定的容差之下。具体来说，对于监测的反应集合 $x \\in \\{a, f, s\\}$（吸收、裂变和散射）和能量群 $g \\in \\{1,2\\}$，施加约束 $|\\Delta \\Sigma_{x,g}|/\\Sigma_{x,g} \\leq \\varepsilon_{x,g}$，容差为 $\\varepsilon_{a,1}=\\varepsilon_{a,2}=\\varepsilon_{f,2}=0.010$ 和 $\\varepsilon_{s,1\\rightarrow 2}=0.005$。\n\n在当前燃耗 $B_{0}$ 时，测量得到以下宏观截面及其燃耗导数（在 $B_{0}$ 处评估）：\n- 快中子群吸收：$\\Sigma_{a,1}(B_{0}) = 0.015 \\ \\mathrm{cm}^{-1}$ 且 $\\partial \\Sigma_{a,1}/\\partial B \\big|_{B_{0}} = 1.2 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$。\n- 热中子群吸收：$\\Sigma_{a,2}(B_{0}) = 0.095 \\ \\mathrm{cm}^{-1}$ 且 $\\partial \\Sigma_{a,2}/\\partial B \\big|_{B_{0}} = 3.5 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$。\n- 热中子群裂变：$\\Sigma_{f,2}(B_{0}) = 0.025 \\ \\mathrm{cm}^{-1}$ 且 $\\partial \\Sigma_{f,2}/\\partial B \\big|_{B_{0}} = -2.0 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$。\n- 从快中子群到热中子群的降能散射：$\\Sigma_{s,1\\rightarrow 2}(B_{0}) = 0.200 \\ \\mathrm{cm}^{-1}$ 且 $\\partial \\Sigma_{s,1\\rightarrow 2}/\\partial B \\big|_{B_{0}} = -1.0 \\times 10^{-5} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$。\n\n从上述基本定义出发，推导一个自适应燃耗步长准则，以保证在单一步长内对所有监测的 $x,g$ 均满足 $|\\Delta \\Sigma_{x,g}|/\\Sigma_{x,g} \\leq \\varepsilon_{x,g}$。使用该准则，根据给定数据计算在 $B_{0}$ 时的最大允许燃耗增量 $\\Delta B_{\\max}$。\n\n将您的最终 $\\Delta B_{\\max}$ 四舍五入到四位有效数字。以 $\\mathrm{MWd}/\\mathrm{kgHM}$ 为单位表示 $\\Delta B_{\\max}$。",
            "solution": "首先验证问题，以确保其是自洽的、有科学依据且适定的。\n\n**步骤1：提取给定条件**\n- 燃耗定义：$B(t) = \\int_{0}^{t} \\frac{P_{\\mathrm{th}}(\\tau)}{M_{\\mathrm{HM}}} \\, \\mathrm{d}\\tau$\n- 截面变化线性化：$\\Delta \\Sigma_{x,g} \\approx \\left(\\frac{\\partial \\Sigma_{x,g}}{\\partial B}\\right) \\Delta B$\n- 约束条件：$\\frac{|\\Delta \\Sigma_{x,g}|}{\\Sigma_{x,g}} \\leq \\varepsilon_{x,g}$，用于监测的反应。\n- 容差：$\\varepsilon_{a,1}=0.010$，$\\varepsilon_{a,2}=0.010$，$\\varepsilon_{f,2}=0.010$，$\\varepsilon_{s,1\\rightarrow 2}=0.005$。\n- 在燃耗 $B_0$ 时的数据：\n  - $\\Sigma_{a,1}(B_{0}) = 0.015 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{a,1}}{\\partial B} \\big|_{B_{0}} = 1.2 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n  - $\\Sigma_{a,2}(B_{0}) = 0.095 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{a,2}}{\\partial B} \\big|_{B_{0}} = 3.5 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n  - $\\Sigma_{f,2}(B_{0}) = 0.025 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{f,2}}{\\partial B} \\big|_{B_{0}} = -2.0 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n  - $\\Sigma_{s,1\\rightarrow 2}(B_{0}) = 0.200 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{s,1\\rightarrow 2}}{\\partial B} \\big|_{B_{0}} = -1.0 \\times 10^{-5} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n\n**步骤2：验证**\n- 该问题具有科学依据，描述了反应堆物理学中用于燃耗计算的一种标准数值技术。\n- 问题是适定的，有明确的目标和足够的信息来确定唯一解。\n- 数据在物理上是合理的，并且量纲一致。\n- 不存在逻辑矛盾、歧义或事实不成立之处。\n\n**步骤3：结论**\n问题有效。将推导解答。\n\n**推导与求解**\n核心要求是在一个燃耗步长 $\\Delta B$ 内，限制每个被监测的宏观截面 $\\Sigma_{x,g}$ 的相对变化。对于能量群 $g$ 中的每种反应类型 $x$，约束条件为：\n$$\n\\frac{|\\Delta \\Sigma_{x,g}|}{\\Sigma_{x,g}(B_0)} \\leq \\varepsilon_{x,g}\n$$\n问题指定使用一阶泰勒展开来近似小燃耗增量 $\\Delta B$ 期间的变化量 $\\Delta \\Sigma_{x,g}$：\n$$\n\\Delta \\Sigma_{x,g} \\approx \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\Delta B\n$$\n将此近似代入约束不等式，得到：\n$$\n\\frac{\\left| \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\Delta B \\right|}{\\Sigma_{x,g}(B_0)} \\leq \\varepsilon_{x,g}\n$$\n由于燃耗增量 $\\Delta B$ 必须为正，我们可以写成 $|\\Delta B| = \\Delta B$。然后可以重新整理该不等式，以求解特定截面的最大允许 $\\Delta B$，我们将其表示为 $\\Delta B_{x,g}$：\n$$\n\\Delta B \\frac{\\left| \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\right|}{\\Sigma_{x,g}(B_0)} \\leq \\varepsilon_{x,g} \\implies \\Delta B \\leq \\frac{\\varepsilon_{x,g} \\Sigma_{x,g}(B_0)}{\\left| \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\right|}\n$$\n因此，对于每个被监测的截面 $(x,g)$，最大允许燃耗步长由下式给出：\n$$\n\\Delta B_{x,g} = \\frac{\\varepsilon_{x,g} \\Sigma_{x,g}(B_0)}{\\left| \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\Big|_{B_0} \\right|}\n$$\n这是单个截面的自适应燃耗步长准则。为确保所有约束同时满足，总的最大允许燃耗增量 $\\Delta B_{\\max}$ 必须是为所有被监测反应计算出的各个步长的最小值。\n$$\n\\Delta B_{\\max} = \\min_{x,g \\in \\text{monitored}} \\left\\{ \\Delta B_{x,g} \\right\\}\n$$\n现在我们使用给定数据为四个指定情况分别计算 $\\Delta B_{x,g}$。$\\Sigma$ 的单位（$\\mathrm{cm}^{-1}$）与导数中分子的单位（$\\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})$）相抵消，使得 $\\Delta B$ 的单位为 $\\mathrm{MWd}/\\mathrm{kgHM}$，符合要求。\n\n1.  快中子群吸收 ($x=a, g=1$)：\n    $$\n    \\Delta B_{a,1} = \\frac{\\varepsilon_{a,1} \\Sigma_{a,1}(B_0)}{\\left| \\frac{\\partial \\Sigma_{a,1}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.010 \\times 0.015 \\ \\mathrm{cm}^{-1}}{|1.2 \\times 10^{-4} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{1.5 \\times 10^{-4}}{1.2 \\times 10^{-4}} \\ \\mathrm{MWd}/\\mathrm{kgHM} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n2.  热中子群吸收 ($x=a, g=2$)：\n    $$\n    \\Delta B_{a,2} = \\frac{\\varepsilon_{a,2} \\Sigma_{a,2}(B_0)}{\\left| \\frac{\\partial \\Sigma_{a,2}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.010 \\times 0.095 \\ \\mathrm{cm}^{-1}}{|3.5 \\times 10^{-4} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{9.5 \\times 10^{-4}}{3.5 \\times 10^{-4}} \\ \\mathrm{MWd}/\\mathrm{kgHM} \\approx 2.7143 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n3.  热中子群裂变 ($x=f, g=2$)：\n    $$\n    \\Delta B_{f,2} = \\frac{\\varepsilon_{f,2} \\Sigma_{f,2}(B_0)}{\\left| \\frac{\\partial \\Sigma_{f,2}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.010 \\times 0.025 \\ \\mathrm{cm}^{-1}}{|-2.0 \\times 10^{-4} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{2.5 \\times 10^{-4}}{2.0 \\times 10^{-4}} \\ \\mathrm{MWd}/\\mathrm{kgHM} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n4.  从快中子群到热中子群的降能散射 ($x=s, g=1\\rightarrow 2$)：\n    $$\n    \\Delta B_{s,1\\rightarrow 2} = \\frac{\\varepsilon_{s,1\\rightarrow 2} \\Sigma_{s,1\\rightarrow 2}(B_0)}{\\left| \\frac{\\partial \\Sigma_{s,1\\rightarrow 2}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.005 \\times 0.200 \\ \\mathrm{cm}^{-1}}{|-1.0 \\times 10^{-5} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{1.0 \\times 10^{-3}}{1.0 \\times 10^{-5}} \\ \\mathrm{MWd}/\\mathrm{kgHM} = 100 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n计算出的步长限制为：\n- $\\Delta B_{a,1} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n- $\\Delta B_{a,2} \\approx 2.7143 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n- $\\Delta B_{f,2} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n- $\\Delta B_{s,1\\rightarrow 2} = 100 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n\n最严格的（最小的）限制将决定下一步的最大允许燃耗增量。\n$$\n\\Delta B_{\\max} = \\min(1.25, 2.7143..., 1.25, 100) = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n$$\n问题要求将最终答案四舍五入到四位有效数字。因此，$\\Delta B_{\\max} = 1.250 \\ \\mathrm{MWd}/\\mathrm{kgHM}$。\n这一结果表明，在当前燃耗 $B_0$ 时，快中子吸收截面和热中子裂变截面相对于其容差变化最快，因此限制了燃耗步长。",
            "answer": "$$\n\\boxed{1.250}\n$$"
        }
    ]
}