{
    "hands_on_practices": [
        {
            "introduction": "Understanding how reactor properties evolve requires modeling the change in material composition, and a core aspect of this process is the accumulation of fission product poisons. This practice guides you through a derivation of the change in the macroscopic absorption cross section, starting from the fundamental differential equations that govern nuclide transmutation. By building this model, you will gain a concrete understanding of one of the key physical mechanisms that drives burnup-dependent effects in a reactor. ",
            "id": "4216435",
            "problem": "A homogeneous infinite Light Water Reactor (LWR) lattice is operating at constant volumetric power density $p_{0}$ and initially contains no rare earth fission products. Consider a designated set $\\{i=1,\\dots,m\\}$ of rare earth fission products that are produced directly by fission with independent yields $y_{i}$ per fission. Each product $i$ has a decay constant $\\lambda_{i} \\ge 0$ and a groupwise microscopic absorption cross section $\\sigma_{a,i,g}$ in energy group $g$, where $g$ is fixed. Assume the following:\n- The heavy metal mass density is $\\rho_{\\mathrm{HM}}$.\n- The energy released per fission is $E_{f}$.\n- The rare earth fission products are only produced directly from fission and are lost solely by radioactive decay (no neutron absorption removal or chemical removal).\n- The reactor is homogeneous and the neutron field is stationary over the timescale considered, so production is spatially uniform and proportional to $p_{0}$.\n- The initial number density of each rare earth product $i$ is zero at burnup $B=0$.\n\nBurnup $B$ is defined by $B = \\int_{0}^{t} p(t') \\, dt' / \\rho_{\\mathrm{HM}}$, which under the assumption of constant power density equals $B = p_{0} t / \\rho_{\\mathrm{HM}}$. Using fundamental rate definitions relating fission rate density to $p_{0}$ via $f = p_{0}/E_{f}$, the number balance for the $i$-th product, and the definition of macroscopic absorption cross section as the sum over species $i$ of number density times microscopic cross section, derive the exact closed-form expression for the burnup-dependent change in the macroscopic absorption in group $g$, $\\Delta \\Sigma_{a,g}(B)$, due solely to the accumulation of these rare earth fission products.\n\nExpress your final analytical answer as a function of $B$ and the parameters $\\{y_{i}\\}$, $\\{\\lambda_{i}\\}$, $\\{\\sigma_{a,i,g}\\}$, $p_{0}$, $\\rho_{\\mathrm{HM}}$, and $E_{f}$, suitable for all $\\lambda_{i} \\ge 0$ by interpreting the expression in the $\\lambda_{i} \\to 0$ limit where appropriate. No numerical evaluation is required. Express the result in inverse meters. The final answer must be a single closed-form expression.",
            "solution": "The problem is first validated against the specified criteria.\n\n**Step 1: Extract Givens**\n- System: A homogeneous infinite Light Water Reactor (LWR) lattice.\n- Operating condition: Constant volumetric power density, $p_{0}$.\n- Fission products: A set of $m$ rare earth products, indexed by $i=1,\\dots,m$.\n- Initial condition: The number density of each product $i$ is zero at burnup $B=0$, which corresponds to time $t=0$.\n- Production mechanism: Products are produced directly from fission with independent yields $y_{i}$ per fission.\n- Loss mechanism: Products are lost solely by radioactive decay, with decay constant $\\lambda_{i} \\ge 0$. Neutron absorption removal is explicitly excluded.\n- Material property: Heavy metal mass density is $\\rho_{\\mathrm{HM}}$.\n- Physical constant: Energy released per fission is $E_{f}$.\n- Cross section: Microscopic absorption cross section for product $i$ in energy group $g$ is $\\sigma_{a,i,g}$, where $g$ is fixed.\n- Reactor model: The reactor is homogeneous and the neutron field is stationary, implying spatially uniform and constant production rate.\n- Definitions:\n    - Burnup: $B = \\int_{0}^{t} p(t') \\, dt' / \\rho_{\\mathrm{HM}}$. For constant power $p_0$, this simplifies to $B = p_{0} t / \\rho_{\\mathrm{HM}}$.\n    - Fission rate density: $f = p_{0}/E_{f}$.\n    - Macroscopic absorption cross section: The sum over species $i$ of the product of number density $N_i$ and microscopic cross section $\\sigma_{a,i,g}$.\n- Objective: Derive the exact closed-form expression for the burnup-dependent change in the macroscopic absorption cross section in group $g$, $\\Delta \\Sigma_{a,g}(B)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly rooted in the principles of nuclear reactor physics, specifically the theory of fission product poisoning and reactor kinetics. All terms, variables, and concepts are standard in the field.\n- **Well-Posed:** The problem is well-posed. It provides a clear objective, a complete set of initial conditions ($N_i(t=0)=0$), and all necessary physical quantities and relationships to solve for the number density of each nuclide and subsequently the change in the macroscopic cross section. The assumptions, such as constant power and loss only by decay, serve to make the problem analytically tractable and do not introduce ambiguity. A unique solution exists.\n- **Objective:** The problem statement is expressed in precise, objective, and quantitative language, free from any subjective or biased elements.\n\nThe problem does not exhibit any of the listed flaws (e.g., scientific unsoundness, incompleteness, contradiction, etc.). It is a standard, solvable problem in reactor physics.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n**Derivation**\n\nThe core of the problem is to determine the number density $N_i(t)$ for each rare earth fission product $i$ as a function of time $t$, and then express this in terms of burnup $B$ to calculate the change in the macroscopic absorption cross section.\n\nThe number balance for the nuclide $i$ is described by a first-order ordinary differential equation:\n$$ \\frac{dN_i(t)}{dt} = (\\text{Rate of production of } i) - (\\text{Rate of loss of } i) $$\n\nThe rate of production per unit volume is the product of the fission rate density, $f$, and the fission yield for nuclide $i$, $y_i$. The problem states that the fission rate density is related to the constant volumetric power density $p_0$ and the energy per fission $E_f$ by $f = p_0 / E_f$. Thus, the production rate is a constant, $y_i p_0 / E_f$.\n\nThe rate of loss per unit volume is due solely to radioactive decay. This is given by the product of the decay constant $\\lambda_i$ and the number density $N_i(t)$.\n\nCombining these terms, the differential equation for the number density of nuclide $i$ is:\n$$ \\frac{dN_i(t)}{dt} = \\frac{y_i p_0}{E_f} - \\lambda_i N_i(t) $$\nThis is a linear first-order differential equation. We can rearrange it into the standard form:\n$$ \\frac{dN_i(t)}{dt} + \\lambda_i N_i(t) = \\frac{y_i p_0}{E_f} $$\nThe initial condition, stated in the problem, is $N_i(t=0) = 0$.\n\nWe consider two cases for the decay constant $\\lambda_i$.\n\nCase 1: $\\lambda_i > 0$.\nThe general solution to this differential equation can be found using an integrating factor, $I(t) = \\exp(\\int \\lambda_i dt) = \\exp(\\lambda_i t)$. Multiplying the equation by $I(t)$ gives:\n$$ \\exp(\\lambda_i t) \\frac{dN_i(t)}{dt} + \\lambda_i \\exp(\\lambda_i t) N_i(t) = \\frac{y_i p_0}{E_f} \\exp(\\lambda_i t) $$\nThe left-hand side is the derivative of a product:\n$$ \\frac{d}{dt} \\left( N_i(t) \\exp(\\lambda_i t) \\right) = \\frac{y_i p_0}{E_f} \\exp(\\lambda_i t) $$\nIntegrating both sides with respect to $t$:\n$$ N_i(t) \\exp(\\lambda_i t) = \\int \\frac{y_i p_0}{E_f} \\exp(\\lambda_i t) dt = \\frac{y_i p_0}{E_f \\lambda_i} \\exp(\\lambda_i t) + C $$\nwhere $C$ is the constant of integration. Solving for $N_i(t)$:\n$$ N_i(t) = \\frac{y_i p_0}{E_f \\lambda_i} + C \\exp(-\\lambda_i t) $$\nUsing the initial condition $N_i(0)=0$:\n$$ N_i(0) = 0 = \\frac{y_i p_0}{E_f \\lambda_i} + C \\exp(0) \\implies C = -\\frac{y_i p_0}{E_f \\lambda_i} $$\nSubstituting the value of $C$ back into the solution for $N_i(t)$:\n$$ N_i(t) = \\frac{y_i p_0}{E_f \\lambda_i} - \\frac{y_i p_0}{E_f \\lambda_i} \\exp(-\\lambda_i t) = \\frac{y_i p_0}{E_f \\lambda_i} \\left( 1 - \\exp(-\\lambda_i t) \\right) $$\n\nCase 2: $\\lambda_i = 0$ (stable nuclide).\nThe differential equation simplifies to:\n$$ \\frac{dN_i(t)}{dt} = \\frac{y_i p_0}{E_f} $$\nIntegrating with respect to $t$ and applying the initial condition $N_i(0)=0$:\n$$ N_i(t) = \\int_{0}^{t} \\frac{y_i p_0}{E_f} dt' = \\frac{y_i p_0}{E_f} t $$\nIt is worth noting that the solution for the $\\lambda_i=0$ case can be obtained by taking the limit of the $\\lambda_i > 0$ solution as $\\lambda_i \\to 0$, using the Taylor expansion $\\exp(-x) \\approx 1-x$ for small $x$, or L'Hôpital's rule.\n$$ \\lim_{\\lambda_i \\to 0} \\frac{y_i p_0}{E_f} \\frac{1 - \\exp(-\\lambda_i t)}{\\lambda_i} = \\frac{y_i p_0}{E_f} \\lim_{\\lambda_i \\to 0} \\frac{t \\exp(-\\lambda_i t)}{1} = \\frac{y_i p_0}{E_f} t $$\nThus, the expression for $\\lambda_i>0$ is suitable for all $\\lambda_i \\ge 0$ when the limit is taken for $\\lambda_i=0$.\n\nNext, we express the time variable $t$ in terms of burnup $B$. The problem defines $B = p_0 t / \\rho_{\\mathrm{HM}}$. Rearranging for $t$ gives:\n$$ t = \\frac{B \\rho_{\\mathrm{HM}}}{p_0} $$\nSubstituting this into the general expression for $N_i(t)$ yields $N_i(B)$:\n$$ N_i(B) = \\frac{y_i p_0}{E_f \\lambda_i} \\left( 1 - \\exp\\left(-\\lambda_i \\frac{B \\rho_{\\mathrm{HM}}}{p_0}\\right) \\right) $$\n\nThe change in the macroscopic absorption cross section in energy group $g$, $\\Delta \\Sigma_{a,g}(B)$, is the difference between the macroscopic cross section at burnup $B$ and at burnup $B=0$.\n$$ \\Delta \\Sigma_{a,g}(B) = \\Sigma_{a,g}(B) - \\Sigma_{a,g}(0) $$\nThe macroscopic cross section at any burnup is the sum of the contributions from all $m$ fission products:\n$$ \\Sigma_{a,g}(B) = \\sum_{i=1}^{m} N_i(B) \\sigma_{a,i,g} $$\nAt burnup $B=0$, the number densities are $N_i(0)=0$, so $\\Sigma_{a,g}(0) = 0$.\nTherefore, the change is simply $\\Delta \\Sigma_{a,g}(B) = \\Sigma_{a,g}(B)$.\n$$ \\Delta \\Sigma_{a,g}(B) = \\sum_{i=1}^{m} N_i(B) \\sigma_{a,i,g} $$\nSubstituting the expression for $N_i(B)$:\n$$ \\Delta \\Sigma_{a,g}(B) = \\sum_{i=1}^{m} \\sigma_{a,i,g} \\left[ \\frac{y_i p_0}{E_f \\lambda_i} \\left( 1 - \\exp\\left(-\\lambda_i \\frac{B \\rho_{\\mathrm{HM}}}{p_0}\\right) \\right) \\right] $$\nRearranging the terms to group the constants gives the final closed-form expression:\n$$ \\Delta \\Sigma_{a,g}(B) = \\frac{p_0}{E_f} \\sum_{i=1}^{m} \\frac{y_i \\sigma_{a,i,g}}{\\lambda_i} \\left( 1 - \\exp\\left(-\\frac{\\lambda_i \\rho_{\\mathrm{HM}}}{p_0} B \\right) \\right) $$\nThis expression is valid for all $\\lambda_i \\ge 0$, with the understanding that for any term where $\\lambda_i = 0$, the expression $\\frac{1}{\\lambda_i} \\left( 1 - \\exp\\left(-\\frac{\\lambda_i \\rho_{\\mathrm{HM}}}{p_0} B \\right) \\right)$ is replaced by its limit, which is $\\frac{\\rho_{\\mathrm{HM}}}{p_0} B$.\nThis gives the contribution for a stable nuclide as $\\frac{p_0}{E_f} y_i \\sigma_{a,i,g} \\frac{\\rho_{\\mathrm{HM}}}{p_0} B = \\frac{y_i \\sigma_{a,i,g} \\rho_{\\mathrm{HM}}}{E_f} B$, which matches the direct calculation from $N_i(B) = \\frac{y_i B \\rho_{\\mathrm{HM}}}{E_f}$.\nThe final single expression is presented as requested, with the limit interpretation implied for any $\\lambda_i=0$.",
            "answer": "$$ \\boxed{ \\frac{p_0}{E_f} \\sum_{i=1}^{m} \\frac{y_i \\sigma_{a,i,g}}{\\lambda_i} \\left( 1 - \\exp\\left(-\\frac{\\lambda_i \\rho_{\\mathrm{HM}}}{p_0} B \\right) \\right) } $$"
        },
        {
            "introduction": "Accurate reactor simulations require that burnup steps be small enough to capture changing material properties but large enough to be computationally efficient. This hands-on problem puts you in the role of a code developer, tasking you with implementing an adaptive stepping criterion. You will use the burnup derivatives of macroscopic cross sections, such as those modeled in the previous exercise, to determine an optimal step size that ensures the simulation remains both accurate and efficient. ",
            "id": "4216393",
            "problem": "Consider a two-energy-group, infinite homogeneous reactor model used for burnup-dependent transport calculations. Let the burnup, defined as energy produced per unit heavy metal mass, be $B(t)$, with the fundamental definition $B(t) = \\int_{0}^{t} P_{\\mathrm{th}}(\\tau)/M_{\\mathrm{HM}} \\, \\mathrm{d}\\tau$, where $P_{\\mathrm{th}}$ is the thermal power and $M_{\\mathrm{HM}}$ is the heavy metal (HM) mass. The macroscopic cross sections $\\Sigma_{x,g}(B)$ for reaction type $x$ in energy group $g$ are functions of burnup because the number densities evolve according to transmutation and depletion. For a small burnup increment $\\Delta B$, assume a first-order linearization of each cross section, $\\Delta \\Sigma_{x,g} \\approx \\left(\\partial \\Sigma_{x,g}/\\partial B\\right) \\Delta B$.\n\nTo ensure numerical stability and physics fidelity in an adaptive time-stepping (burnup-stepping) scheme, you wish to constrain the relative change in each key macroscopic cross section per burnup step to be below prescribed tolerances. Specifically, impose $|\\Delta \\Sigma_{x,g}|/\\Sigma_{x,g} \\leq \\varepsilon_{x,g}$ for the set of monitored reactions $x \\in \\{a, f, s\\}$ (absorption, fission, and scattering) and energy groups $g \\in \\{1,2\\}$, with tolerances $\\varepsilon_{a,1}=\\varepsilon_{a,2}=\\varepsilon_{f,2}=0.010$ and $\\varepsilon_{s,1\\rightarrow 2}=0.005$.\n\nAt the current burnup $B_{0}$, the following macroscopic cross sections and their burnup derivatives (evaluated at $B_{0}$) are measured:\n- Fast-group absorption: $\\Sigma_{a,1}(B_{0}) = 0.015 \\ \\mathrm{cm}^{-1}$ and $\\partial \\Sigma_{a,1}/\\partial B \\big|_{B_{0}} = 1.2 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$.\n- Thermal-group absorption: $\\Sigma_{a,2}(B_{0}) = 0.095 \\ \\mathrm{cm}^{-1}$ and $\\partial \\Sigma_{a,2}/\\partial B \\big|_{B_{0}} = 3.5 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$.\n- Thermal-group fission: $\\Sigma_{f,2}(B_{0}) = 0.025 \\ \\mathrm{cm}^{-1}$ and $\\partial \\Sigma_{f,2}/\\partial B \\big|_{B_{0}} = -2.0 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$.\n- Down-scattering from fast to thermal: $\\Sigma_{s,1\\rightarrow 2}(B_{0}) = 0.200 \\ \\mathrm{cm}^{-1}$ and $\\partial \\Sigma_{s,1\\rightarrow 2}/\\partial B \\big|_{B_{0}} = -1.0 \\times 10^{-5} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$.\n\nStarting from the fundamental definitions above, derive an adaptive burnup-step criterion that guarantees $|\\Delta \\Sigma_{x,g}|/\\Sigma_{x,g} \\leq \\varepsilon_{x,g}$ for all monitored $x,g$ in a single step. Using this criterion, compute the maximum allowable burnup increment $\\Delta B_{\\max}$ at $B_{0}$ for the given data.\n\nRound your final $\\Delta B_{\\max}$ to four significant figures. Express $\\Delta B_{\\max}$ in $\\mathrm{MWd}/\\mathrm{kgHM}$.",
            "solution": "The problem is first validated to ensure it is self-contained, scientifically grounded, and well-posed.\n\n**Step 1: Extracted Givens**\n- Burnup definition: $B(t) = \\int_{0}^{t} \\frac{P_{\\mathrm{th}}(\\tau)}{M_{\\mathrm{HM}}} \\, \\mathrm{d}\\tau$\n- Linearization of cross section change: $\\Delta \\Sigma_{x,g} \\approx \\left(\\frac{\\partial \\Sigma_{x,g}}{\\partial B}\\right) \\Delta B$\n- Constraint: $\\frac{|\\Delta \\Sigma_{x,g}|}{\\Sigma_{x,g}} \\leq \\varepsilon_{x,g}$ for monitored reactions.\n- Tolerances: $\\varepsilon_{a,1}=0.010$, $\\varepsilon_{a,2}=0.010$, $\\varepsilon_{f,2}=0.010$, $\\varepsilon_{s,1\\rightarrow 2}=0.005$.\n- Data at burnup $B_0$:\n  - $\\Sigma_{a,1}(B_{0}) = 0.015 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{a,1}}{\\partial B} \\big|_{B_{0}} = 1.2 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n  - $\\Sigma_{a,2}(B_{0}) = 0.095 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{a,2}}{\\partial B} \\big|_{B_{0}} = 3.5 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n  - $\\Sigma_{f,2}(B_{0}) = 0.025 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{f,2}}{\\partial B} \\big|_{B_{0}} = -2.0 \\times 10^{-4} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n  - $\\Sigma_{s,1\\rightarrow 2}(B_{0}) = 0.200 \\ \\mathrm{cm}^{-1}$\n  - $\\frac{\\partial \\Sigma_{s,1\\rightarrow 2}}{\\partial B} \\big|_{B_{0}} = -1.0 \\times 10^{-5} \\ \\mathrm{cm}^{-1} \\, (\\mathrm{MWd}/\\mathrm{kgHM})^{-1}$\n\n**Step 2: Validation**\n- The problem is scientifically grounded, describing a standard numerical technique in reactor physics for burnup calculations.\n- It is well-posed, with a clear objective and sufficient information to determine a unique solution.\n- The data is physically plausible and dimensionally consistent.\n- No logical contradictions, ambiguities, or factual unsoundness are present.\n\n**Step 3: Verdict**\nThe problem is valid. A solution will be derived.\n\n**Derivation and Solution**\nThe core requirement is to limit the relative change in each monitored macroscopic cross section $\\Sigma_{x,g}$ during a burnup step $\\Delta B$. The constraint for each reaction type $x$ in energy group $g$ is given as:\n$$\n\\frac{|\\Delta \\Sigma_{x,g}|}{\\Sigma_{x,g}(B_0)} \\leq \\varepsilon_{x,g}\n$$\nThe problem specifies using a first-order Taylor expansion to approximate the change $\\Delta \\Sigma_{x,g}$ over a small burnup increment $\\Delta B$:\n$$\n\\Delta \\Sigma_{x,g} \\approx \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\Delta B\n$$\nSubstituting this approximation into the constraint inequality yields:\n$$\n\\frac{\\left| \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\Delta B \\right|}{\\Sigma_{x,g}(B_0)} \\leq \\varepsilon_{x,g}\n$$\nSince the burnup increment $\\Delta B$ must be positive, we can write $|\\Delta B| = \\Delta B$. The inequality can then be rearranged to solve for the maximum allowable $\\Delta B$ for that specific cross section, which we denote as $\\Delta B_{x,g}$:\n$$\n\\Delta B \\frac{\\left| \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\right|}{\\Sigma_{x,g}(B_0)} \\leq \\varepsilon_{x,g} \\implies \\Delta B \\leq \\frac{\\varepsilon_{x,g} \\Sigma_{x,g}(B_0)}{\\left| \\left. \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\right|_{B_0} \\right|}\n$$\nThus, for each monitored cross-section $(x,g)$, the maximum permitted burnup step is given by:\n$$\n\\Delta B_{x,g} = \\frac{\\varepsilon_{x,g} \\Sigma_{x,g}(B_0)}{\\left| \\frac{\\partial \\Sigma_{x,g}}{\\partial B} \\Big|_{B_0} \\right|}\n$$\nThis is the adaptive burnup-step criterion for a single cross section. To ensure that all constraints are met simultaneously, the overall maximum allowable burnup increment, $\\Delta B_{\\max}$, must be the minimum of the individual step sizes calculated for all monitored reactions.\n$$\n\\Delta B_{\\max} = \\min_{x,g \\in \\text{monitored}} \\left\\{ \\Delta B_{x,g} \\right\\}\n$$\nWe now compute $\\Delta B_{x,g}$ for each of the four specified cases using the provided data. The units of $\\Sigma$ ($\\mathrm{cm}^{-1}$) cancel with the units of the numerator in the derivative ($\\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})$), leaving units of $\\mathrm{MWd}/\\mathrm{kgHM}$ for $\\Delta B$, as required.\n\n1.  Fast-group absorption ($x=a, g=1$):\n    $$\n    \\Delta B_{a,1} = \\frac{\\varepsilon_{a,1} \\Sigma_{a,1}(B_0)}{\\left| \\frac{\\partial \\Sigma_{a,1}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.010 \\times 0.015 \\ \\mathrm{cm}^{-1}}{|1.2 \\times 10^{-4} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{1.5 \\times 10^{-4}}{1.2 \\times 10^{-4}} \\ \\mathrm{MWd}/\\mathrm{kgHM} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n2.  Thermal-group absorption ($x=a, g=2$):\n    $$\n    \\Delta B_{a,2} = \\frac{\\varepsilon_{a,2} \\Sigma_{a,2}(B_0)}{\\left| \\frac{\\partial \\Sigma_{a,2}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.010 \\times 0.095 \\ \\mathrm{cm}^{-1}}{|3.5 \\times 10^{-4} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{9.5 \\times 10^{-4}}{3.5 \\times 10^{-4}} \\ \\mathrm{MWd}/\\mathrm{kgHM} \\approx 2.7143 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n3.  Thermal-group fission ($x=f, g=2$):\n    $$\n    \\Delta B_{f,2} = \\frac{\\varepsilon_{f,2} \\Sigma_{f,2}(B_0)}{\\left| \\frac{\\partial \\Sigma_{f,2}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.010 \\times 0.025 \\ \\mathrm{cm}^{-1}}{|-2.0 \\times 10^{-4} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{2.5 \\times 10^{-4}}{2.0 \\times 10^{-4}} \\ \\mathrm{MWd}/\\mathrm{kgHM} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\n4.  Down-scattering from fast to thermal ($x=s, g=1\\rightarrow 2$):\n    $$\n    \\Delta B_{s,1\\rightarrow 2} = \\frac{\\varepsilon_{s,1\\rightarrow 2} \\Sigma_{s,1\\rightarrow 2}(B_0)}{\\left| \\frac{\\partial \\Sigma_{s,1\\rightarrow 2}}{\\partial B} \\big|_{B_0} \\right|} = \\frac{0.005 \\times 0.200 \\ \\mathrm{cm}^{-1}}{|-1.0 \\times 10^{-5} \\ \\mathrm{cm}^{-1} / (\\mathrm{MWd}/\\mathrm{kgHM})|} = \\frac{1.0 \\times 10^{-3}}{1.0 \\times 10^{-5}} \\ \\mathrm{MWd}/\\mathrm{kgHM} = 100 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n    $$\nThe calculated step limits are:\n- $\\Delta B_{a,1} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n- $\\Delta B_{a,2} \\approx 2.7143 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n- $\\Delta B_{f,2} = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n- $\\Delta B_{s,1\\rightarrow 2} = 100 \\ \\mathrm{MWd}/\\mathrm{kgHM}$\n\nThe most restrictive (smallest) limit will determine the maximum allowable burnup increment for the next step.\n$$\n\\Delta B_{\\max} = \\min(1.25, 2.7143..., 1.25, 100) = 1.25 \\ \\mathrm{MWd}/\\mathrm{kgHM}\n$$\nThe problem requires the final answer to be rounded to four significant figures. Therefore, $\\Delta B_{\\max} = 1.250 \\ \\mathrm{MWd}/\\mathrm{kgHM}$.\nThis result indicates that at the current burnup $B_0$, the fast absorption and thermal fission cross sections are the most rapidly changing relative to their tolerance, thus limiting the burnup step size.",
            "answer": "$$\n\\boxed{1.250}\n$$"
        },
        {
            "introduction": "The coupling between the neutron flux and isotopic composition presents a significant numerical challenge in burnup calculations, as reaction rates and material properties are interdependent. This practice examines the common but flawed shortcut of using a single mid-step flux solve and guides you toward understanding a more robust solution. By analyzing why this simple approach fails to conserve power, you will appreciate why modern simulation codes employ predictor-corrector schemes to consistently handle the non-linear feedback between material properties and the neutron field. ",
            "id": "4216382",
            "problem": "A reactor depletion calculation advances the isotopic number densities $N_i(t)$ and the neutron flux spectrum $\\phi_g(\\mathbf{r},t)$ over a single burnup step from time $t_n$ to $t_{n+1}=t_n+\\Delta t$ with a target burnup increment $\\Delta BU$. Let $M_{\\text{fuel}}$ denote the fuel mass, $E_f$ the average energy released per fission, and $\\nu$ the average neutrons per fission. The instantaneous reactor power $P(t)$ is given by\n$$\nP(t) \\;=\\; \\int_V \\sum_{g} \\phi_g(\\mathbf{r},t)\\,\\nu\\,\\Sigma_{f,g}\\!\\left(N(t)\\right)(\\mathbf{r})\\,E_f \\, d\\mathbf{r},\n$$\nand the burnup rate is defined by\n$$\n\\frac{d\\,BU}{dt} \\;=\\; \\frac{P(t)}{M_{\\text{fuel}}}.\n$$\nHere $\\Sigma_{f,g}\\!\\left(N(t)\\right)$ is the macroscopic fission cross section in energy group $g$ as a functional of the time-dependent number densities $N(t)=\\{N_i(t)\\}$.\n\nA common programming shortcut is to construct a mid-step macroscopic data set by linearly interpolating cross sections at a guessed mid-step burnup and to use those cross sections with a single flux solve to represent the entire step. Consider why this shortcut can violate the energy balance\n$$\nM_{\\text{fuel}}\\,\\Delta BU \\;=\\; \\int_{t_n}^{t_{n+1}} P(t)\\,dt,\n$$\nand how to enforce this balance in a numerically consistent way given the coupled dependencies $\\phi(t)$ and $\\Sigma_{f}(N(t))$.\n\nWhich option best explains the failure mode and proposes a consistent scheme that enforces the energy balance over the step?\n\nA) The linear mid-step interpolation assumes that reaction rates vary linearly with burnup, but both the flux $\\phi(t)$ and the macroscopic cross sections $\\Sigma_f(N(t))$ evolve nonlinearly and are coupled through $N(t)$, so $\\int_{t_n}^{t_{n+1}} \\phi(t)\\,\\Sigma_f(N(t))\\,dt \\neq \\Delta t\\,\\phi^\\star\\,\\Sigma_f^{\\text{mid}}$ for any fixed $\\phi^\\star$. A consistent remedy is to compute endpoint solutions $(\\phi^{n},\\Sigma_f^{n})$ and $(\\phi^{n+1},\\Sigma_f^{n+1})$ with a predictor–corrector depletion of $N(t)$, form step-averaged quantities $(\\phi^{\\text{avg}},\\Sigma_f^{\\text{avg}})$, and then determine a flux normalization $\\alpha$ such that\n$$\nM_{\\text{fuel}}\\,\\Delta BU \\;=\\; \\Delta t \\int_V \\sum_g \\alpha\\,\\phi^{\\text{avg}}_g(\\mathbf{r})\\,\\nu\\,\\Sigma^{\\text{avg}}_{f,g}(\\mathbf{r})\\,E_f\\,d\\mathbf{r}.\n$$\nUsing $\\alpha\\,\\phi^{\\text{avg}}$ in the depletion update yields a reaction–rate preserving step that enforces the energy balance by construction.\n\nB) Because the average energy per fission $E_f$ is nearly constant, linear interpolation of cross sections at the mid-step burnup conserves energy. The correct enforcement scheme is to compute the flux only at the beginning of the step and reuse it throughout, which keeps power constant and thus preserves the burnup integral.\n\nC) The violation arises primarily from unresolved resonance self-shielding in the macroscopic data. The fix is to apply resonance self-shielding corrections to the mid-step macroscopic cross sections; with self-shielding corrected, the mid-step interpolation becomes power-conserving without any additional coupling to the flux or depletion solution.\n\nD) The mid-step interpolation breaks energy conservation only because the step size $\\Delta t$ is too large. The correct approach is to reduce $\\Delta t$ until changes in $\\Sigma_f$ are negligible; no flux renormalization or step-averaging is required if sufficiently small steps are used, since the midpoint rule will then exactly preserve the burnup integral.",
            "solution": "The user wants a critical analysis of a common numerical shortcut in reactor depletion calculations and an evaluation of proposed methods to address its shortcomings.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **State Variables:** Isotopic number densities $N_i(t)$, neutron flux spectrum $\\phi_g(\\mathbf{r},t)$.\n*   **Time Discretization:** A single burnup step from time $t_n$ to $t_{n+1}=t_n+\\Delta t$.\n*   **Target Increment:** A specific target burnup increment $\\Delta BU$.\n*   **Constants and Parameters:** Fuel mass $M_{\\text{fuel}}$, average energy released per fission $E_f$, average number of neutrons per fission $\\nu$.\n*   **Governing Equations and Definitions:**\n    *   Instantaneous reactor power: $P(t) \\;=\\; \\int_V \\sum_{g} \\phi_g(\\mathbf{r},t)\\,\\nu\\,\\Sigma_{f,g}\\!\\left(N(t)\\right)(\\mathbf{r})\\,E_f \\, d\\mathbf{r}$.\n    *   Macroscopic fission cross section $\\Sigma_{f,g}\\!\\left(N(t)\\right)$ is a functional of the time-dependent number density vector $N(t)$.\n    *   Burnup rate: $\\frac{d\\,BU}{dt} \\;=\\; \\frac{P(t)}{M_{\\text{fuel}}}$.\n    *   Energy balance over the step: $M_{\\text{fuel}}\\,\\Delta BU \\;=\\; \\int_{t_n}^{t_{n+1}} P(t)\\,dt$.\n*   **Numerical Shortcut to be Analyzed:** A mid-step interpolation method where macroscopic cross sections are determined at a guessed mid-step burnup, and these are used with a single flux solve to represent the entire step.\n*   **Objective:** Explain why this shortcut can violate the energy balance and identify a numerically consistent scheme to enforce it.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded:** Yes. The problem describes a central challenge in computational reactor physics: the numerical time-integration of the coupled system of neutron transport and isotopic depletion equations. The variables, equations, and concepts presented ($P(t)$, $\\Delta BU$, $\\phi_g$, $\\Sigma_{f,g}$, predictor-corrector methods) are standard and fundamental to this field.\n*   **Well-Posed:** Yes. The problem is clearly defined. It asks for an analysis of a specific numerical approximation's failure mode and the identification of a superior, consistent method from a list of options. This is a standard conceptual question in numerical methods for reactor analysis.\n*   **Objective:** Yes. The problem is stated using precise, standard terminology from nuclear engineering and numerical analysis. It is free from ambiguity and subjectivity.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. It is scientifically sound, well-posed, objective, and accurately reflects a genuine and non-trivial problem in the field of nuclear reactor simulation. I will proceed with the solution derivation and option analysis.\n\n### Derivation and Solution\n\nThe core of the problem lies in the coupling between the neutron flux $\\phi$ and the nuclide concentrations $N$. The nuclide concentrations evolve according to the burnup equations, which are a system of first-order ordinary differential equations of the form $\\frac{dN_i}{dt} = \\text{production}_i - \\text{destruction}_i$. The reaction rates in these equations depend on the flux, e.g., $\\sigma_j \\phi N_j$. In turn, the neutron flux $\\phi$ is the solution to the neutron transport (or diffusion) equation, whose coefficients (the macroscopic cross sections, $\\Sigma$) depend on the nuclide concentrations, e.g., $\\Sigma_x = \\sum_i N_i \\sigma_{x,i}$.\n\nThis creates a stiff, non-linear coupled system. A depletion calculation over a time step from $t_n$ to $t_{n+1}$ requires computing the integral of reaction rates over this interval. The total energy produced is directly proportional to the total number of fissions over that interval:\n$$\nM_{\\text{fuel}}\\,\\Delta BU = \\int_{t_n}^{t_{n+1}} P(t) dt = E_f \\int_{t_n}^{t_{n+1}} \\left( \\int_V \\sum_g \\phi_g(\\mathbf{r}, t) \\nu \\Sigma_{f,g}(N(t))(\\mathbf{r}) d\\mathbf{r} \\right) dt\n$$\nThe value of the integrand, $P(t)$, changes throughout the step because both $\\phi(\\mathbf{r},t)$ and $\\Sigma_{f,g}(N(t))(\\mathbf{r})$ change. The flux profile and magnitude change as the fuel composition (and thus cross sections) change.\n\n**Analyzing the \"Shortcut\"**\n\nThe described shortcut approximates the integral as:\n$$\n\\int_{t_n}^{t_{n+1}} P(t) dt \\approx P(\\text{mid}) \\cdot \\Delta t = \\left( \\int_V \\sum_{g} \\phi_g^{\\star}(\\mathbf{r})\\,\\nu\\,\\Sigma_{f,g}^{\\text{mid}}(\\mathbf{r})\\,E_f \\, d\\mathbf{r} \\right) \\Delta t\n$$\nwhere $\\Sigma_{f,g}^{\\text{mid}}$ is interpolated based on a *guessed* mid-step burnup and $\\phi_g^{\\star}$ is calculated once using these cross sections. This method fails for two primary reasons:\n1.  **Non-linearity:** The integral of a product is not the product of the integrals (or mid-point values). The product $\\phi(t) \\Sigma_f(N(t))$ is a highly non-linear function of time. Approximating its integral with a single evaluation at a guessed midpoint is a low-order approximation that can introduce significant error, especially for large $\\Delta t$.\n2.  **Inconsistency:** The shortcut decouples the problem in an inconsistent way. The flux $\\phi^{\\star}$ is calculated for a material composition $\\Sigma^{\\text{mid}}$ that does not exist at the beginning or end of the step and may not accurately represent the true time-averaged state. The evolution of $N(t)$ calculated using $\\phi^{\\star}$ will not, in general, lead to a state whose average power matches the power that was used for the depletion.\n\n**A Consistent Numerical Scheme**\n\nA robust and widely-used method to resolve this is a **predictor-corrector** scheme. This approach improves the accuracy of the time integration.\n1.  **Predictor:** Use the flux at the beginning of the step, $\\phi^n$, to \"predict\" the nuclide concentrations at the end of the step, $N^{n+1, p}$. This is a simple Euler forward step.\n2.  **Corrector:** Using the predicted end-of-step concentrations $N^{n+1, p}$, compute the end-of-step cross sections $\\Sigma^{n+1, p}$ and solve for the end-of-step flux $\\phi^{n+1,p}$. Now, one has estimates for the state at both the beginning and end of the interval. A better approximation for the average flux and cross sections over the step can be formed, e.g., $\\phi^{\\text{avg}} = \\frac{1}{2}(\\phi^n + \\phi^{n+1,p})$ and $\\Sigma^{\\text{avg}} = \\frac{1}{2}(\\Sigma^n + \\Sigma^{n+1,p})$. These averaged values are then used to perform a more accurate \"corrector\" depletion step from $N^n$ to $N^{n+1,c}$. This is analogous to a trapezoidal rule or Crank-Nicolson method, offering second-order accuracy.\n3.  **Enforcing the Energy Balance:** The problem states a target burnup increment $\\Delta BU$. This implies that the average power over the step is fixed by $P_{\\text{avg}} = M_{\\text{fuel}} \\Delta BU / \\Delta t$. The predictor-corrector steps provide an accurate flux *shape* and cross sections, but the flux *magnitude* must be adjusted to produce the correct total energy. We can introduce a scaling factor $\\alpha$ for the step-averaged flux, $\\alpha \\phi^{\\text{avg}}$. This factor is calculated to explicitly enforce the energy balance:\n$$\nM_{\\text{fuel}}\\,\\Delta BU = \\int_{t_n}^{t_{n+1}} P(t)\\,dt \\approx \\Delta t \\int_V \\sum_g (\\alpha\\,\\phi^{\\text{avg}}_g)\\,\\nu\\,\\Sigma^{\\text{avg}}_{f,g}\\,E_f \\, d\\mathbf{r}\n$$\nSolving for $\\alpha$:\n$$\n\\alpha = \\frac{M_{\\text{fuel}}\\,\\Delta BU}{\\Delta t \\int_V \\sum_g \\phi^{\\text{avg}}_g(\\mathbf{r})\\,\\nu\\,\\Sigma^{\\text{avg}}_{f,g}(\\mathbf{r})\\,E_f\\,d\\mathbf{r}}\n$$\nThe final, consistent depletion is then performed using the reaction rates derived from the normalized flux $\\alpha \\phi^{\\text{avg}}$. This ensures that the total number of fissions calculated is consistent with the target burnup increment.\n\n### Option-by-Option Analysis\n\n**A) The linear mid-step interpolation assumes that reaction rates vary linearly with burnup, but both the flux $\\phi(t)$ and the macroscopic cross sections $\\Sigma_f(N(t))$ evolve nonlinearly and are coupled through $N(t)$, so $\\int_{t_n}^{t_{n+1}} \\phi(t)\\,\\Sigma_f(N(t))\\,dt \\neq \\Delta t\\,\\phi^\\star\\,\\Sigma_f^{\\text{mid}}$ for any fixed $\\phi^\\star$. A consistent remedy is to compute endpoint solutions $(\\phi^{n},\\Sigma_f^{n})$ and $(\\phi^{n+1},\\Sigma_f^{n+1})$ with a predictor–corrector depletion of $N(t)$, form step-averaged quantities $(\\phi^{\\text{avg}},\\Sigma_f^{\\text{avg}})$, and then determine a flux normalization $\\alpha$ such that...**\n\nThis option correctly identifies the failure mode: the non-linear, coupled evolution of flux and cross sections, which makes the simple mid-step approximation inaccurate. It then proposes a standard, high-order, and consistent numerical solution: a predictor-corrector scheme to obtain accurate step-averaged quantities, followed by a flux normalization step to explicitly enforce the energy balance (i.e., match the target burnup). This is a textbook description of a modern depletion algorithm.\n\n**Verdict: Correct**\n\n**B) Because the average energy per fission $E_f$ is nearly constant, linear interpolation of cross sections at the mid-step burnup conserves energy. The correct enforcement scheme is to compute the flux only at the beginning of the step and reuse it throughout, which keeps power constant and thus preserves the burnup integral.**\n\nThis statement is factually incorrect. The near-constancy of $E_f$ has little bearing on the problem. The primary source of non-linearity is the product $\\phi(t) \\Sigma_f(N(t))$, not $E_f$. Linear interpolation of cross sections does not conserve energy. The proposed scheme of using the beginning-of-step flux throughout is a simple (first-order) Euler method. It is less accurate than the mid-step method and far less accurate than a predictor-corrector scheme. It does not \"preserve the burnup integral\" in a physically meaningful way; it merely uses a poor, constant approximation for a time-varying power.\n\n**Verdict: Incorrect**\n\n**C) The violation arises primarily from unresolved resonance self-shielding in the macroscopic data. The fix is to apply resonance self-shielding corrections to the mid-step macroscopic cross sections; with self-shielding corrected, the mid-step interpolation becomes power-conserving without any additional coupling to the flux or depletion solution.**\n\nThis misdiagnoses the problem. Resonance self-shielding is a crucial phenomenon in the *generation* of effective group cross sections at a single point in time/burnup. It is not, however, the source of the *time integration error* over a finite step $\\Delta t$. The failure of the mid-step method is an algorithmic error in approximating the time integral of a non-linear function, which persists even if the cross sections at every instant are perfectly calculated (with self-shielding). Applying self-shielding corrections to the mid-step data does not fix the fundamental issue that both flux and cross sections are changing throughout the step.\n\n**Verdict: Incorrect**\n\n**D) The mid-step interpolation breaks energy conservation only because the step size $\\Delta t$ is too large. The correct approach is to reduce $\\Delta t$ until changes in $\\Sigma_f$ are negligible; no flux renormalization or step-averaging is required if sufficiently small steps are used, since the midpoint rule will then exactly preserve the burnup integral.**\n\nWhile it is true that any consistent numerical integration method converges to the correct solution as the step size $\\Delta t \\to 0$, this is not a practical or intelligent solution. The goal of advanced numerical schemes is to achieve a desired accuracy with a reasonably large step size to make computations feasible. Simply stating \"use a smaller step\" is a brute-force approach that evades the actual algorithmic problem. Furthermore, the claim that no renormalization is needed is only true in the limit; for any finite $\\Delta t$, there will be a discrepancy between the target burnup and the calculated burnup that schemes like flux normalization are designed to eliminate. This option fails to propose a \"consistent scheme\" in the sense of an efficient and robust algorithm, and instead suggests avoiding the problem through computational expense.\n\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}