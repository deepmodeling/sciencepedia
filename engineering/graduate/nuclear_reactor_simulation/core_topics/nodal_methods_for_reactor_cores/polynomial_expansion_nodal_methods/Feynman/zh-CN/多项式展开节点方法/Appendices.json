{
    "hands_on_practices": [
        {
            "introduction": "多项式展开节块法 (PENM) 的核心在于将连续的微分形式中子扩散方程，转化为每个计算节块内的离散代数系统。本练习将引导您使用伽辽金法 (Galerkin method) 完成这一基本过程，其中勒让德多项式 (Legendre polynomials) 同时作为基函数和检验函数，从而从第一性原理推导出局部系数矩阵。掌握这一过程是理解节块法如何在内部表示中子通量分布的关键。",
            "id": "4241293",
            "problem": "在一个单群、稳态中子扩散模型中，对于一个物理宽度为 $h$、具有恒定扩散系数 $D$ 和恒定宏观移除截面 $\\Sigma_{r}$ 的一维均匀节点，考虑采用多项式展开节点法 (PENM)，这是一种伽辽金节点法，它将标量中子通量 $\\phi(x)$ 在局部展开为多项式基。通过仿射映射 $x(\\xi) = \\frac{h}{2}\\,\\xi + x_{c}$，将节点 $x \\in [x_{L}, x_{R}]$ 映射到参考坐标 $\\xi \\in [-1,1]$，其中 $x_{c}$ 是节点中心。使用 $[-1,1]$ 上的前三个 Legendre 多项式作为局部基函数：\n$$\n\\varphi_{0}(\\xi) = P_{0}(\\xi) = 1,\\quad \\varphi_{1}(\\xi) = P_{1}(\\xi) = \\xi,\\quad \\varphi_{2}(\\xi) = P_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2}.\n$$\n假设在节点界面处为均匀诺伊曼边界条件（净流为零），因此在对称弱形式中边界项消失。使用标准伽辽金方法，并采用相同的多项式作为检验函数，模态振幅 $\\mathbf{a} = [a_{0}, a_{1}, a_{2}]^{\\mathsf{T}}$ 的局部系数矩阵 $\\mathbf{A}$ 具有以下元素：\n$$\nA_{ij} \\equiv \\int_{x_{L}}^{x_{R}} D\\,\\frac{d\\varphi_{i}}{dx}\\,\\frac{d\\varphi_{j}}{dx}\\,dx \\;+\\; \\int_{x_{L}}^{x_{R}} \\Sigma_{r}\\,\\varphi_{i}\\,\\varphi_{j}\\,dx,\\quad i,j\\in\\{0,1,2\\}.\n$$\n通过将这些积分映射到参考域并精确计算多项式内积，推导出 $A_{ij}$ 关于 $D$、$\\Sigma_{r}$ 和 $h$ 的表达式。然后，组装出所得到的 $3\\times 3$ 矩阵 $\\mathbf{A}$。\n\n最后，以闭合形式计算行列式 $\\det(\\mathbf{A})$，表达式仅包含 $D$、$\\Sigma_{r}$ 和 $h$。请以单一闭合形式的解析表达式给出最终答案。不需要数值近似，最终答案中不应包含单位。",
            "solution": "该问题要求推导一维单群中子扩散方程的多项式展开节点法 (PENM) 公式中的系数矩阵 $\\mathbf{A}$，并随后计算其行列式。在求解之前，需对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **模型**：单群、稳态、均匀中子扩散。\n- **节点几何**：一维，物理宽度 $h$。\n- **物理常数**：扩散系数 $D$ (恒定)，宏观移除截面 $\\Sigma_r$ (恒定)。\n- **方法**：伽辽金节点法 (PENM)。\n- **坐标映射**：$x(\\xi) = \\frac{h}{2}\\xi + x_{c}$，对于 $x \\in [x_L, x_R]$ 和 $\\xi \\in [-1, 1]$。\n- **基函数和检验函数**：$\\varphi_{0}(\\xi) = P_{0}(\\xi) = 1$，$\\varphi_{1}(\\xi) = P_{1}(\\xi) = \\xi$，$\\varphi_{2}(\\xi) = P_{2}(\\xi) = \\frac{3\\xi^{2}-1}{2}$。\n- **边界条件**：在节点界面处为均匀诺伊曼条件（净流为零），导致边界项消失。\n- **矩阵元素定义**：$A_{ij} \\equiv \\int_{x_{L}}^{x_{R}} D\\,\\frac{d\\varphi_{i}}{dx}\\,\\frac{d\\varphi_{j}}{dx}\\,dx \\;+\\; \\int_{x_{L}}^{x_{R}} \\Sigma_{r}\\,\\varphi_{i}\\,\\varphi_{j}\\,dx$，对于 $i,j\\in\\{0,1,2\\}$。\n- **目标**：推导 $3\\times3$ 矩阵 $\\mathbf{A}$ 并计算其行列式 $\\det(\\mathbf{A})$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于标准的中子扩散方程和伽辽金有限元法，这些是核工程和计算物理中的基本概念。使用 Legendre 多项式作为基函数是 PENM 的标准选择。\n- **良态性**：问题陈述清晰，提供了所有必要的定义、常数和函数，以唯一确定矩阵 $\\mathbf{A}$ 及其行列式。\n- **客观性**：问题使用精确的数学和物理术语进行表述，没有主观或模糊的语言。\n- **完整性与一致性**：问题是自洽的。$A_{ij}$ 的定义与扩散算子 $-D\\frac{d^2}{dx^2} + \\Sigma_r$ 的弱形式一致，边界项消失的假设与指定的诺伊曼条件一致。\n\n### 步骤 3：结论与行动\n问题是有效的。它在科学上是合理的、良态的且完整的。可以构建一个严谨的解。\n\n### 解答推导\n矩阵元素 $A_{ij}$ 由物理域 $x \\in [x_L, x_R]$ 上的积分定义。为了计算这些积分，我们将其转换到参考域 $\\xi \\in [-1, 1]$ 上。\n\n首先，我们建立微分 $dx$ 与 $d\\xi$ 以及导数 $\\frac{d}{dx}$ 与 $\\frac{d}{d\\xi}$ 之间的关系。\n根据映射 $x(\\xi) = \\frac{h}{2}\\xi + x_c$，我们找到变换的雅可比：\n$$\n\\frac{dx}{d\\xi} = \\frac{h}{2} \\implies dx = \\frac{h}{2} d\\xi\n$$\n使用链式法则求导：\n$$\n\\frac{d}{d\\xi} = \\frac{dx}{d\\xi}\\frac{d}{dx} = \\frac{h}{2}\\frac{d}{dx} \\implies \\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}\n$$\n我们将这些代入 $A_{ij}$ 的定义中：\n$$\nA_{ij} = \\int_{-1}^{1} D\\left(\\frac{2}{h}\\frac{d\\varphi_{i}}{d\\xi}\\right)\\left(\\frac{2}{h}\\frac{d\\varphi_{j}}{d\\xi}\\right)\\left(\\frac{h}{2}d\\xi\\right) + \\int_{-1}^{1} \\Sigma_{r}\\,\\varphi_{i}(\\xi)\\,\\varphi_{j}(\\xi)\\left(\\frac{h}{2}d\\xi\\right)\n$$\n将常数移到积分外并简化，得到：\n$$\nA_{ij} = \\frac{2D}{h} \\int_{-1}^{1} \\frac{d\\varphi_{i}}{d\\xi}\\frac{d\\varphi_{j}}{d\\xi}\\,d\\xi + \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} \\varphi_{i}(\\xi)\\varphi_{j}(\\xi)\\,d\\xi\n$$\n这个表达式可以看作是“刚度”矩阵分量 $\\mathbf{K}$ 和“质量”矩阵分量 $\\mathbf{M}$ 的和，其中 $A_{ij} = K_{ij} + M_{ij}$。\n\n让我们计算每个分量的积分。我们需要基函数关于 $\\xi$ 的导数：\n$$\n\\frac{d\\varphi_{0}}{d\\xi} = \\frac{d}{d\\xi}(1) = 0\n$$\n$$\n\\frac{d\\varphi_{1}}{d\\xi} = \\frac{d}{d\\xi}(\\xi) = 1\n$$\n$$\n\\frac{d\\varphi_{2}}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{3\\xi^2 - 1}{2}\\right) = 3\\xi\n$$\n\n**1. 刚度矩阵 $\\mathbf{K}$ 的计算**\n$$\nK_{ij} = \\frac{2D}{h} \\int_{-1}^{1} \\frac{d\\varphi_{i}}{d\\xi}\\frac{d\\varphi_{j}}{d\\xi}\\,d\\xi\n$$\n- 由于 $\\frac{d\\varphi_0}{d\\xi} = 0$，第一行和第一列的所有元素均为零：$K_{00} = K_{01} = K_{10} = K_{02} = K_{20} = 0$。\n- 对于 $K_{11}$：\n$$\nK_{11} = \\frac{2D}{h} \\int_{-1}^{1} (1)(1)\\,d\\xi = \\frac{2D}{h} [\\xi]_{-1}^{1} = \\frac{2D}{h}(2) = \\frac{4D}{h}\n$$\n- 对于 $K_{22}$：\n$$\nK_{22} = \\frac{2D}{h} \\int_{-1}^{1} (3\\xi)(3\\xi)\\,d\\xi = \\frac{18D}{h} \\int_{-1}^{1} \\xi^2\\,d\\xi = \\frac{18D}{h} \\left[\\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\frac{18D}{h}\\left(\\frac{2}{3}\\right) = \\frac{12D}{h}\n$$\n- 对于非对角项 $K_{12}$ 和 $K_{21}$：\n$$\nK_{12} = K_{21} = \\frac{2D}{h} \\int_{-1}^{1} (1)(3\\xi)\\,d\\xi = \\frac{6D}{h} \\int_{-1}^{1} \\xi\\,d\\xi = \\frac{6D}{h} \\left[\\frac{\\xi^2}{2}\\right]_{-1}^{1} = 0\n$$\n因此，刚度矩阵 $\\mathbf{K}$ 是对角的：\n$$\n\\mathbf{K} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & \\frac{4D}{h} & 0 \\\\ 0 & 0 & \\frac{12D}{h} \\end{pmatrix}\n$$\n\n**2. 质量矩阵 $\\mathbf{M}$ 的计算**\n$$\nM_{ij} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} \\varphi_{i}(\\xi)\\varphi_{j}(\\xi)\\,d\\xi\n$$\n基函数 $\\varphi_i = P_i$ 是 Legendre 多项式，它们在 $[-1, 1]$ 上是正交的。其正交关系为：\n$$\n\\int_{-1}^{1} P_{i}(\\xi)P_{j}(\\xi)\\,d\\xi = \\frac{2}{2i+1}\\delta_{ij}\n$$\n其中 $\\delta_{ij}$ 是克罗内克符号。这意味着质量矩阵 $\\mathbf{M}$ 是对角的。我们计算对角元素：\n- 对于 $M_{00}$：\n$$\nM_{00} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_0(\\xi)P_0(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(0)+1}\\right) = h\\Sigma_r\n$$\n- 对于 $M_{11}$：\n$$\nM_{11} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_1(\\xi)P_1(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(1)+1}\\right) = \\frac{h\\Sigma_r}{3}\n$$\n- 对于 $M_{22}$：\n$$\nM_{22} = \\frac{h\\Sigma_{r}}{2} \\int_{-1}^{1} P_2(\\xi)P_2(\\xi)\\,d\\xi = \\frac{h\\Sigma_{r}}{2} \\left(\\frac{2}{2(2)+1}\\right) = \\frac{h\\Sigma_r}{5}\n$$\n因此，质量矩阵 $\\mathbf{M}$ 为：\n$$\n\\mathbf{M} = \\begin{pmatrix} h\\Sigma_r & 0 & 0 \\\\ 0 & \\frac{h\\Sigma_r}{3} & 0 \\\\ 0 & 0 & \\frac{h\\Sigma_r}{5} \\end{pmatrix}\n$$\n\n**3. 组装矩阵 $\\mathbf{A}$ 并计算其行列式**\n最终矩阵 $\\mathbf{A}$ 是 $\\mathbf{K}$ 和 $\\mathbf{M}$ 的和，即 $\\mathbf{A} = \\mathbf{K} + \\mathbf{M}$。由于 $\\mathbf{K}$ 和 $\\mathbf{M}$ 都是对角矩阵，所以 $\\mathbf{A}$ 也是对角矩阵。\n$$\n\\mathbf{A} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & \\frac{4D}{h} & 0 \\\\ 0 & 0 & \\frac{12D}{h} \\end{pmatrix} + \\begin{pmatrix} h\\Sigma_r & 0 & 0 \\\\ 0 & \\frac{h\\Sigma_r}{3} & 0 \\\\ 0 & 0 & \\frac{h\\Sigma_r}{5} \\end{pmatrix} = \\begin{pmatrix} h\\Sigma_r & 0 & 0 \\\\ 0 & \\frac{4D}{h} + \\frac{h\\Sigma_r}{3} & 0 \\\\ 0 & 0 & \\frac{12D}{h} + \\frac{h\\Sigma_r}{5} \\end{pmatrix}\n$$\n对角矩阵的行列式是其对角元素的乘积：\n$$\n\\det(\\mathbf{A}) = A_{00} \\cdot A_{11} \\cdot A_{22}\n$$\n$$\n\\det(\\mathbf{A}) = (h\\Sigma_r) \\left( \\frac{4D}{h} + \\frac{h\\Sigma_r}{3} \\right) \\left( \\frac{12D}{h} + \\frac{h\\Sigma_r}{5} \\right)\n$$\n为了得到所需的闭合形式表达式，我们简化括号中的项：\n$$\n\\frac{4D}{h} + \\frac{h\\Sigma_r}{3} = \\frac{3 \\cdot 4D + h \\cdot h\\Sigma_r}{3h} = \\frac{12D + h^2\\Sigma_r}{3h}\n$$\n$$\n\\frac{12D}{h} + \\frac{h\\Sigma_r}{5} = \\frac{5 \\cdot 12D + h \\cdot h\\Sigma_r}{5h} = \\frac{60D + h^2\\Sigma_r}{5h}\n$$\n将这些代回行列式的表达式中：\n$$\n\\det(\\mathbf{A}) = (h\\Sigma_r) \\left( \\frac{12D + h^2\\Sigma_r}{3h} \\right) \\left( \\frac{60D + h^2\\Sigma_r}{5h} \\right)\n$$\n$$\n\\det(\\mathbf{A}) = \\frac{h\\Sigma_r}{15h^2} (12D + h^2\\Sigma_r)(60D + h^2\\Sigma_r)\n$$\n$$\n\\det(\\mathbf{A}) = \\frac{\\Sigma_r}{15h} (12D + h^2\\Sigma_r)(60D + h^2\\Sigma_r)\n$$\n这就是矩阵 $\\mathbf{A}$ 行列式的最终闭合形式表达式。",
            "answer": "$$\\boxed{\\frac{\\Sigma_{r}}{15h}(12D + h^{2}\\Sigma_{r})(60D + h^{2}\\Sigma_{r})}$$"
        },
        {
            "introduction": "在实际的反应堆分析中，计算网格很少是均匀的，节块可能具有高纵横比，这对计算精度构成了挑战。本练习深入探讨了 PENM 的误差分析，展示了节块的物理尺寸如何直接影响达到目标精度所需的多项式阶数。理解这种关系对于开发高效和自适应的模拟策略至关重要。",
            "id": "4241251",
            "problem": "考虑一个均匀矩形节点中的单群中子扩散模型，该节点的边与笛卡尔坐标轴对齐。在多项式展开节点法 (PENM) 中，节点内标量通量由各坐标方向上的一维多项式展开的张量积近似，并应用横向积分来获得一维平衡方程，其源项为横向泄漏项。假设节点内精确通量是光滑的，并且在节点内的领导阶上是可分离和模态的，由 $\\phi(x,y)=\\cos(\\kappa x)\\cos(\\kappa y)$ 给出，其中 $\\kappa$ 是一个由材料和全局谱特性决定的实正常数。该节点以原点为中心，范围为 $[-h_x/2,h_x/2]\\times[-h_y/2,h_y/2]$。\n\n您将使用以下与上下文相符的基本原理：\n- 单群扩散算子是线性的，横向泄漏项是横向上的平均二阶导数，因此其相对误差的界（不计一个与方向无关的常数）受相应一维形状 $\\cos(\\kappa s)$ 在 $s\\in[-h_s/2,h_s/2]$ 上的最佳一致逼近误差的限制，其中 $s\\in\\{x,y\\}$。\n- 对于对称区间上的解析函数，围绕区间中心的泰勒余项定理表明，$p$ 阶多项式逼近产生的一致逼近误差的界为第一个被忽略的泰勒项的绝对值。因此，对于 $[-h_s/2,h_s/2]$ 上的 $f(s)=\\cos(\\kappa s)$，存在一个与常数无关的界，其形式为 $\\frac{(\\kappa h_s/2)^{p+1}}{(p+1)!}$，用于 $p$ 阶最佳一致多项式逼近误差。\n\n设纵横比为 $a=h_x/h_y$，并假设有以下数据：\n- $\\kappa=6\\,\\mathrm{m}^{-1}$，\n- $h_y=0.06\\,\\mathrm{m}$，\n- $a=5$（因此 $h_x=a\\,h_y$），\n- 横向泄漏建模的总相对误差目标界限为 $\\varepsilon=10^{-6}$。\n\n采用一种保守的解耦分配方法，其中通过将每个方向的贡献限制在 $\\varepsilon/2$ 以内来强制执行总误差界限。仅使用上述原理，确定 $x$ 和 $y$ 方向上的最小阶数 $p_x$ 和 $p_y$，使得对于 $s\\in\\{x,y\\}$，界限 $\\frac{(\\kappa h_s/2)^{p_s+1}}{(p_s+1)!} \\le \\frac{\\varepsilon}{2}$ 成立，然后以单个整数 $\\Delta p=p_x-p_y$ 的形式报告各向异性阶数要求。",
            "solution": "该问题要求在多项式展开节点法 (PENM) 的背景下，确定 $x$ 和 $y$ 空间方向上的最小多项式展开阶数 $p_x$ 和 $p_y$，以满足指定的误差容限。最终结果是各向异性阶数要求，定义为 $\\Delta p = p_x - p_y$。\n\n问题陈述的验证过程如下。\n逐字提取给定条件：\n- 节点内标量通量由 $\\phi(x,y)=\\cos(\\kappa x)\\cos(\\kappa y)$ 近似。\n- 节点范围为 $[-h_x/2,h_x/2]\\times[-h_y/2,h_y/2]$。\n- $\\cos(\\kappa s)$ 在 $[-h_s/2,h_s/2]$ 上 $p$ 阶一致多项式逼近误差的界为 $\\frac{(\\kappa h_s/2)^{p+1}}{(p+1)!}$。\n- 纵横比为 $a=h_x/h_y$。\n- $\\kappa=6\\,\\mathrm{m}^{-1}$。\n- $h_y=0.06\\,\\mathrm{m}$。\n- $a=5$。\n- 目标总相对误差界限为 $\\varepsilon=10^{-6}$。\n- 总误差界限被分配，使得每个方向的贡献以 $\\varepsilon/2$ 为界。\n- 需要求解的具体约束条件是 $\\frac{(\\kappa h_s/2)^{p_s+1}}{(p_s+1)!}\\le \\frac{\\varepsilon}{2}$，对于 $s\\in\\{x,y\\}$。\n- 需要报告的量是 $\\Delta p=p_x-p_y$。\n\n该问题在科学上植根于核反应堆物理和数值分析领域，特别涉及节点扩散方法。使用泰勒定理来界定解析函数的多项式逼近误差是一种标准的数学技术。该问题是适定的，因为它提供了所有必要的数据和明确的目标，即找到满足一组不等式的最小整数。所有术语都得到了客观和精确的定义。参数在物理上是合理的。因此，该问题被认为是有效的，可以进行求解。\n\n任务是找到满足以下不等式的最小整数 $p_x$ 和 $p_y$：\n$$\n\\frac{(\\frac{\\kappa h_x}{2})^{p_x+1}}{(p_x+1)!} \\le \\frac{\\varepsilon}{2}\n$$\n$$\n\\frac{(\\frac{\\kappa h_y}{2})^{p_y+1}}{(p_y+1)!} \\le \\frac{\\varepsilon}{2}\n$$\n\n首先，我们计算物理尺寸和数值项的参数。\n$y$ 方向上的节点宽度给定为 $h_y = 0.06\\,\\mathrm{m}$。\n纵横比为 $a = 5$，所以 $x$ 方向上的节点宽度为 $h_x = a \\cdot h_y = 5 \\times 0.06\\,\\mathrm{m} = 0.3\\,\\mathrm{m}$。\n材料几何参数 $\\kappa$ 给定为 $6\\,\\mathrm{m}^{-1}$。\n每个方向的目标误差界限为 $\\frac{\\varepsilon}{2} = \\frac{10^{-6}}{2} = 5 \\times 10^{-7}$。\n\n我们定义无量纲参数 $B_x$ 和 $B_y$：\n$$\nB_x = \\frac{\\kappa h_x}{2} = \\frac{(6\\,\\mathrm{m}^{-1}) \\times (0.3\\,\\mathrm{m})}{2} = \\frac{1.8}{2} = 0.9\n$$\n$$\nB_y = \\frac{\\kappa h_y}{2} = \\frac{(6\\,\\mathrm{m}^{-1}) \\times (0.06\\,\\mathrm{m})}{2} = \\frac{0.36}{2} = 0.18\n$$\n\n需要求解的不等式变为：\n$$\n\\frac{(0.9)^{p_x+1}}{(p_x+1)!} \\le 5 \\times 10^{-7}\n$$\n$$\n\\frac{(0.18)^{p_y+1}}{(p_y+1)!} \\le 5 \\times 10^{-7}\n$$\n\n我们将首先找到最小整数 $p_y$。我们对递增的整数 $p_y$ 值计算表达式 $E_y(p_y) = \\frac{(0.18)^{p_y+1}}{(p_y+1)!}$：\n- 对于 $p_y=0$： $E_y(0) = \\frac{0.18^1}{1!} = 0.18$\n- 对于 $p_y=1$： $E_y(1) = \\frac{0.18^2}{2!} = \\frac{0.0324}{2} = 0.0162$\n- 对于 $p_y=2$： $E_y(2) = \\frac{0.18^3}{3!} = \\frac{0.005832}{6} = 9.72 \\times 10^{-4}$\n- 对于 $p_y=3$： $E_y(3) = \\frac{0.18^4}{4!} = \\frac{1.04976 \\times 10^{-3}}{24} \\approx 4.374 \\times 10^{-5}$\n- 对于 $p_y=4$： $E_y(4) = \\frac{0.18^5}{5!} = \\frac{1.889568 \\times 10^{-4}}{120} \\approx 1.575 \\times 10^{-6}$\n- 对于 $p_y=5$： $E_y(5) = \\frac{0.18^6}{6!} = \\frac{3.4012224 \\times 10^{-5}}{720} \\approx 4.724 \\times 10^{-8}$\n\n当 $p_y=4$ 时，误差界为 $1.575 \\times 10^{-6}$，大于要求的 $5 \\times 10^{-7}$。当 $p_y=5$ 时，误差界为 $4.724 \\times 10^{-8}$，小于 $5 \\times 10^{-7}$。因此，在 $y$ 方向上所需的最小多项式阶数为 $p_y=5$。\n\n接下来，我们找到最小整数 $p_x$。我们对递增的整数 $p_x$ 值计算表达式 $E_x(p_x) = \\frac{(0.9)^{p_x+1}}{(p_x+1)!}$：\n- 对于 $p_x=5$： $E_x(5) = \\frac{0.9^6}{6!} = \\frac{0.531441}{720} \\approx 7.381 \\times 10^{-4}$\n- 对于 $p_x=6$： $E_x(6) = \\frac{0.9^7}{7!} = \\frac{0.4782969}{5040} \\approx 9.490 \\times 10^{-5}$\n- 对于 $p_x=7$： $E_x(7) = \\frac{0.9^8}{8!} = \\frac{0.43046721}{40320} \\approx 1.068 \\times 10^{-5}$\n- 对于 $p_x=8$： $E_x(8) = \\frac{0.9^9}{9!} = \\frac{0.387420489}{362880} \\approx 1.068 \\times 10^{-6}$\n- 对于 $p_x=9$： $E_x(9) = \\frac{0.9^{10}}{10!} = \\frac{0.3486784401}{3628800} \\approx 9.609 \\times 10^{-8}$\n\n当 $p_x=8$ 时，误差界约为 $1.068 \\times 10^{-6}$，大于要求的 $5 \\times 10^{-7}$。当 $p_x=9$ 时，误差界约为 $9.609 \\times 10^{-8}$，小于 $5 \\times 10^{-7}$。因此，在 $x$ 方向上所需的最小多项式阶数为 $p_x=9$。\n\n问题要求的是各向异性阶数要求 $\\Delta p$。\n$$\n\\Delta p = p_x - p_y = 9 - 5 = 4\n$$\n所需多项式阶数的差异是节点大纵横比的直接结果，这使得通量形状在较长方向上相对于无量纲坐标变化得更快。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "任何可靠的数值方法都必须经过严格的验证，而一种强有力的验证技术是将其与具有已知精确解的问题进行比较。本练习采用“人造解方法”(method of manufactured solutions)，通过定义一个特定的源项，使得扩散方程存在封闭形式的解析解。请注意，这里的源项是一个为验证目的而构造的数学场景，它提供了一个重要的基准问题，用以量化 PENM 实现的准确性。",
            "id": "4241268",
            "problem": "考虑一个为验证多项式展开节点法（PENM）而设计的一维稳态平板反应堆基准问题。设平板占据区间 $x \\in [0,L]$，并且是均匀的，具有恒定的扩散系数 $D$ 和宏观吸收截面 $\\Sigma_{a}$。驱动项是一个人工制造的正弦体积源 $S(x) = S_{0} \\sin(\\kappa x)$，其中 $\\kappa = \\frac{n \\pi}{L}$，$n$ 为正整数。在两端施加真空边界条件 $ \\phi(0) = 0 $ 和 $ \\phi(L) = 0 $，其中 $ \\phi(x) $ 是标量中子通量。\n\n从一维稳态单群中子扩散方程\n$ -\\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a} \\phi = S(x) $\n出发，推导上述情况下的精确闭式解 $ \\phi(x) $。然后，将区域划分为 $M$ 个宽度为 $h = \\frac{L}{M}$ 的相等节点，并推导节点 $j$ 中的节点平均通量的精确解析表达式，其定义为\n$ \\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\phi(x) \\, dx $。\n最后，根据参数 $ L = 60 \\, \\mathrm{cm} $，$ M = 5 $，$ n = 3 $，$ D = 1.00 \\, \\mathrm{cm} $，$ \\Sigma_{a} = 0.10 \\, \\mathrm{cm}^{-1} $ 和 $ S_{0} = 1.00 \\times 10^{6} \\, \\mathrm{n} \\, \\mathrm{cm}^{-3} \\, \\mathrm{s}^{-1} $ 数值计算 $ \\bar{\\phi}_{3} $。将 $ \\bar{\\phi}_{3} $ 的最终值以 $ \\mathrm{cm}^{-2} \\, \\mathrm{s}^{-1} $ 为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "问题陈述经过严格验证，并被认为是有效的。这是一个适定问题，其基础是核反应堆物理的既定原理，特别是单群中子扩散理论。使用可以取负值的人工制造的正弦源，是为验证数值方法而创建基准问题的一种标准且可接受的做法。尽管负源和由此产生的负通量在裂变驱动的反应堆中无法物理实现，但在扩散方程的框架内它们在数学上是合理的，其中负源代表一个与空间相关的汇项。该问题是自洽的、客观的，并且所有提供的参数都是一致的。\n\n均匀介质的一维、稳态、单群中子扩散方程由下式给出：\n$$-\\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a} \\phi(x) = S(x)$$\n鉴于扩散系数 $D$ 和宏观吸收截面 $\\Sigma_{a}$ 是常数，该方程简化为：\n$$-D \\frac{d^2 \\phi}{dx^2} + \\Sigma_{a} \\phi(x) = S(x)$$\n源项指定为 $S(x) = S_{0} \\sin(\\kappa x)$，其中 $\\kappa = \\frac{n \\pi}{L}$。区域为 $x \\in [0,L]$，施加的真空边界条件为 $\\phi(0) = 0$ 和 $\\phi(L) = 0$。\n\n首先，我们推导精确的闭式解 $\\phi(x)$。\n问题的设置使得源项 $\\sin(\\kappa x)$ 是在具有零边界条件的区域 $[0,L]$ 上扩散算子 $-\\frac{d^2}{dx^2}$ 的一个本征函数。这表明可以寻求形式为 $\\phi(x) = A \\sin(\\kappa x)$ 的解，其中 $A$ 是一个待定常数。\n让我们用这个假定的形式来验证边界条件：\n在 $x=0$ 处：$\\phi(0) = A \\sin(\\kappa \\cdot 0) = A \\sin(0) = 0$。此条件得到满足。\n在 $x=L$ 处：$\\phi(L) = A \\sin(\\kappa L)$。由于 $\\kappa = \\frac{n \\pi}{L}$，我们有 $\\phi(L) = A \\sin\\left(\\frac{n \\pi}{L} \\cdot L\\right) = A \\sin(n \\pi) = 0$ 对任何整数 $n$ 成立。此条件也得到满足。\n\n现在，我们将建议的解代入扩散方程。$\\phi(x)$ 的导数是：\n$$\\frac{d \\phi}{dx} = A \\kappa \\cos(\\kappa x)$$\n$$\\frac{d^2 \\phi}{dx^2} = -A \\kappa^2 \\sin(\\kappa x)$$\n代入扩散方程：\n$$-D (-A \\kappa^2 \\sin(\\kappa x)) + \\Sigma_{a} (A \\sin(\\kappa x)) = S_{0} \\sin(\\kappa x)$$\n$$A (D \\kappa^2 + \\Sigma_{a}) \\sin(\\kappa x) = S_{0} \\sin(\\kappa x)$$\n为使此等式对所有 $x \\in [0,L]$ 成立，系数必须相等：\n$$A (D \\kappa^2 + \\Sigma_{a}) = S_{0}$$\n求解常数 $A$：\n$$A = \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}}$$\n因此，中子通量的精确解析解为：\n$$\\phi(x) = \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}} \\sin(\\kappa x)$$\n\n接下来，我们推导节点 $j$ 的节点平均通量 $\\bar{\\phi}_{j}$ 的表达式。区域 $[0,L]$ 被划分为 $M$ 个相等的节点，每个节点的宽度为 $h = \\frac{L}{M}$。节点 $j$ 跨越区间 $[(j-1)h, jh]$。平均通量定义为：\n$$\\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\phi(x) \\, dx$$\n代入 $\\phi(x)$ 的表达式：\n$$\\bar{\\phi}_{j} = \\frac{1}{h} \\int_{(j-1)h}^{jh} \\frac{S_{0}}{D \\kappa^2 + \\Sigma_{a}} \\sin(\\kappa x) \\, dx$$\n常数项可以移到积分符号外面：\n$$\\bar{\\phi}_{j} = \\frac{S_{0}}{h (D \\kappa^2 + \\Sigma_{a})} \\int_{(j-1)h}^{jh} \\sin(\\kappa x) \\, dx$$\n$\\sin(\\kappa x)$ 的积分是 $-\\frac{1}{\\kappa}\\cos(\\kappa x)$。计算该定积分：\n$$\\int_{(j-1)h}^{jh} \\sin(\\kappa x) \\, dx = \\left[ -\\frac{1}{\\kappa} \\cos(\\kappa x) \\right]_{(j-1)h}^{jh} = -\\frac{1}{\\kappa} (\\cos(\\kappa jh) - \\cos(\\kappa (j-1)h))$$\n$$= \\frac{1}{\\kappa} (\\cos(\\kappa(j-1)h) - \\cos(\\kappa jh))$$\n将此结果代回 $\\bar{\\phi}_{j}$ 的表达式中：\n$$\\bar{\\phi}_{j} = \\frac{S_{0}}{h \\kappa (D \\kappa^2 + \\Sigma_{a})} (\\cos(\\kappa(j-1)h) - \\cos(\\kappa jh))$$\n这就是节点 $j$ 中节点平均通量的精确解析表达式。\n\n最后，我们根据给定的参数计算 $\\bar{\\phi}_{3}$：\n$L = 60 \\, \\mathrm{cm}$\n$M = 5$\n$n = 3$\n$D = 1.00 \\, \\mathrm{cm}$\n$\\Sigma_{a} = 0.10 \\, \\mathrm{cm}^{-1}$\n$S_{0} = 1.00 \\times 10^{6} \\, \\mathrm{n} \\, \\mathrm{cm}^{-3} \\, \\mathrm{s}^{-1}$\n目标节点为 $j=3$。\n\n首先，我们计算导出参数 $h$ 和 $\\kappa$：\n节点宽度：$h = \\frac{L}{M} = \\frac{60}{5} = 12 \\, \\mathrm{cm}$\n波数：$\\kappa = \\frac{n \\pi}{L} = \\frac{3 \\pi}{60} = \\frac{\\pi}{20} \\, \\mathrm{cm}^{-1}$\n\n现在，我们计算 $\\bar{\\phi}_{3}$ 的表达式：\n$$\\bar{\\phi}_{3} = \\frac{S_{0}}{h \\kappa (D \\kappa^2 + \\Sigma_{a})} (\\cos(\\kappa(2h)) - \\cos(\\kappa(3h)))$$\n余弦函数的自变量为：\n$\\kappa (2h) = \\frac{\\pi}{20} \\cdot (2 \\cdot 12) = \\frac{24\\pi}{20} = \\frac{6\\pi}{5}$\n$\\kappa (3h) = \\frac{\\pi}{20} \\cdot (3 \\cdot 12) = \\frac{36\\pi}{20} = \\frac{9\\pi}{5}$\n余弦项为：\n$\\cos\\left(\\frac{6\\pi}{5}\\right) = \\cos\\left(\\pi + \\frac{\\pi}{5}\\right) = -\\cos\\left(\\frac{\\pi}{5}\\right)$\n$\\cos\\left(\\frac{9\\pi}{5}\\right) = \\cos\\left(2\\pi - \\frac{\\pi}{5}\\right) = \\cos\\left(\\frac{\\pi}{5}\\right)$\n差值为：\n$\\cos\\left(\\frac{6\\pi}{5}\\right) - \\cos\\left(\\frac{9\\pi}{5}\\right) = -\\cos\\left(\\frac{\\pi}{5}\\right) - \\cos\\left(\\frac{\\pi}{5}\\right) = -2\\cos\\left(\\frac{\\pi}{5}\\right)$\n$\\cos(\\frac{\\pi}{5})$ 的精确值是 $\\frac{1+\\sqrt{5}}{4}$。所以，差值为 $-2\\left(\\frac{1+\\sqrt{5}}{4}\\right) = -\\frac{1+\\sqrt{5}}{2}$。\n\n现在，让我们用数值组装 $\\bar{\\phi}_{3}$ 的完整表达式：\n分母项 $(D \\kappa^2 + \\Sigma_{a})$ 是：\n$D \\kappa^2 + \\Sigma_{a} = (1.00) \\left(\\frac{\\pi}{20}\\right)^2 + 0.10 = \\frac{\\pi^2}{400} + 0.10 \\, \\mathrm{cm}^{-1}$\n分母 $h \\kappa (D \\kappa^2 + \\Sigma_{a})$ 是：\n$12 \\cdot \\frac{\\pi}{20} \\left(\\frac{\\pi^2}{400} + 0.10\\right) = \\frac{3\\pi}{5} \\left(\\frac{\\pi^2+40}{400}\\right) = \\frac{3\\pi(\\pi^2+40)}{2000}$\n分子 $S_0 (\\cos(\\kappa(2h)) - \\cos(\\kappa(3h)))$ 是：\n$(1.00 \\times 10^6) \\left(-\\frac{1+\\sqrt{5}}{2}\\right)$\n所以，我们有：\n$$\\bar{\\phi}_{3} = \\frac{(1.00 \\times 10^6) \\left(-\\frac{1+\\sqrt{5}}{2}\\right)}{\\frac{3\\pi(\\pi^2+40)}{2000}} = \\frac{-1000 \\cdot (1.00 \\times 10^6) (1+\\sqrt{5})}{3\\pi(\\pi^2+40)}$$\n$$\\bar{\\phi}_{3} = \\frac{-10^9 (1+\\sqrt{5})}{3\\pi(\\pi^2+40)}$$\n现在，我们计算数值：\n$1+\\sqrt{5} \\approx 3.236068$\n$\\pi^2+40 \\approx 9.869604 + 40 = 49.869604$\n$3\\pi \\approx 9.424778$\n$$\\bar{\\phi}_{3} \\approx \\frac{-10^9 \\times 3.236068}{9.424778 \\times 49.869604} \\approx \\frac{-3.236068 \\times 10^9}{470.0035} \\approx -6.88522 \\times 10^6$$\n单位是 $\\mathrm{cm}^{-2} \\, \\mathrm{s}^{-1}$。\n将结果四舍五入到四位有效数字，得到 $-6.885 \\times 10^6$。负值是正确的数学结果，因为源项 $S(x)$ 在对应于节点3的区间，即 $x \\in [24, 36]$ 上是负值。",
            "answer": "$$\\boxed{-6.885 \\times 10^{6}}$$"
        }
    ]
}