{
    "hands_on_practices": [
        {
            "introduction": "At the core of many nodal methods lies the task of solving a one-dimensional diffusion equation that results from transverse integration. This first practice exercise  provides a direct application of the Analytic Nodal Method (ANM) to a single homogeneous slab with a prescribed quadratic transverse leakage. By working through the analytical solution and calculating the node-averaged flux, you will solidify your understanding of how to handle polynomial source terms and apply boundary conditions in a typical nodal problem.",
            "id": "4258625",
            "problem": "Consider a one-group, steady-state neutron diffusion model for a homogeneous slab node of thickness $H$ in the $x$-direction, occupying $x \\in [0,H]$, with reflective boundaries at $x=0$ and $x=H$. Reflective boundaries imply zero net current at the boundaries, i.e., $J(0)=J(H)=0$ with $J(x)=-D\\,\\frac{d\\phi}{dx}(x)$, so equivalently $\\frac{d\\phi}{dx}(0)=\\frac{d\\phi}{dx}(H)=0$. The slab has constant diffusion coefficient $D$ and absorption cross section $\\Sigma_{a}$, and is driven by a spatially uniform external volumetric source $S_{0}$. After transverse integration in the other spatial directions, the transverse leakage into this node is modeled as a known symmetric quadratic function of position,\n$$\nL(x) \\;=\\; L_{2}\\,\\bigl(x-\\tfrac{H}{2}\\bigr)^{2},\n$$\nso that the one-dimensional node equation to be solved by the Analytic Nodal Method (ANM) is\n$$\n-\\,\\frac{d}{dx}\\!\\left(D\\,\\frac{d\\phi}{dx}\\right) \\;+\\; \\Sigma_{a}\\,\\phi(x) \\;=\\; S_{0} \\;+\\; L(x).\n$$\nUse the ANM to solve this boundary-value problem and then compute the node-averaged flux,\n$$\n\\overline{\\phi} \\;=\\; \\frac{1}{H}\\,\\int_{0}^{H}\\phi(x)\\,dx.\n$$\nTake the following values: $D=1.2\\,\\mathrm{cm}$, $\\Sigma_{a}=0.08\\,\\mathrm{cm}^{-1}$, $H=40\\,\\mathrm{cm}$, $S_{0}=5.0\\times 10^{5}\\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$, and $L_{2}=8.0\\times 10^{2}\\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-5}\\,\\mathrm{s}^{-1}$. Round your final numerical result to four significant figures and express it in $\\mathrm{neutrons}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$.",
            "solution": "The problem requires the solution of a one-dimensional, one-group, steady-state neutron diffusion equation for a homogeneous slab node and the subsequent calculation of the node-averaged neutron flux.\n\nThe governing diffusion equation is given as:\n$$\n-\\,\\frac{d}{dx}\\!\\left(D\\,\\frac{d\\phi}{dx}\\right) \\;+\\; \\Sigma_{a}\\,\\phi(x) \\;=\\; S_{0} \\;+\\; L(x)\n$$\nwhere $D$ and $\\Sigma_a$ are constants. The transverse leakage $L(x)$ is given by $L(x) = L_{2}\\,\\bigl(x-\\tfrac{H}{2}\\bigr)^{2}$. Substituting this into the main equation and simplifying (since $D$ is constant) yields:\n$$\n-D\\,\\frac{d^2\\phi}{dx^2} \\;+\\; \\Sigma_{a}\\,\\phi(x) \\;=\\; S_{0} \\;+\\; L_{2}\\,\\left(x-\\frac{H}{2}\\right)^{2}\n$$\nThe boundary conditions are reflective, which means zero net current at the boundaries $x=0$ and $x=H$. The current is defined by Fick's law, $J(x) = -D \\frac{d\\phi}{dx}(x)$. Thus, the boundary conditions are:\n$$\n\\frac{d\\phi}{dx}(0) = 0 \\quad \\text{and} \\quad \\frac{d\\phi}{dx}(H) = 0\n$$\nTo simplify the solution process, we rearrange the differential equation into a standard form. Let us divide by $D$:\n$$\n-\\frac{d^2\\phi}{dx^2} \\;+\\; \\frac{\\Sigma_{a}}{D}\\,\\phi(x) \\;=\\; \\frac{S_{0}}{D} \\;+\\; \\frac{L_{2}}{D}\\,\\left(x-\\frac{H}{2}\\right)^{2}\n$$\nLet $B^2 = \\frac{\\Sigma_{a}}{D}$. The quantity $B$ is the inverse of the neutron diffusion length. The equation becomes:\n$$\n\\frac{d^2\\phi}{dx^2} - B^2 \\phi(x) = -\\frac{1}{D}\\left[S_0 + L_2\\left(x-\\frac{H}{2}\\right)^2\\right]\n$$\nThis is a second-order, linear, inhomogeneous ordinary differential equation. The problem exhibits symmetry. The source term $S_0 + L(x)$ is symmetric about the center of the slab, $x=H/2$. The boundary conditions are also symmetric ($\\phi'(0)=0, \\phi'(H)=0$). Therefore, the solution $\\phi(x)$ must be symmetric about $x=H/2$. It is advantageous to introduce a shifted coordinate $z = x - H/2$, which transforms the domain $x \\in [0, H]$ to $z \\in [-H/2, H/2]$. The equation in terms of $z$ is:\n$$\n\\frac{d^2\\phi}{dz^2} - B^2 \\phi(z) = -\\frac{1}{D}\\left(S_0 + L_2 z^2\\right)\n$$\nThe boundary conditions become $\\frac{d\\phi}{dz}(-H/2) = 0$ and $\\frac{d\\phi}{dz}(H/2) = 0$.\n\nThe general solution is the sum of a homogeneous solution $\\phi_h(z)$ and a particular solution $\\phi_p(z)$.\nThe homogeneous equation is $\\frac{d^2\\phi_h}{dz^2} - B^2 \\phi_h(z) = 0$. Its general solution is $\\phi_h(z) = C_1 \\cosh(Bz) + C_2 \\sinh(Bz)$. Since the solution must be symmetric about $z=0$ (i.e., be an even function), the coefficient of the odd function $\\sinh(Bz)$ must be zero. Thus, $C_2=0$, and the homogeneous solution simplifies to:\n$$\n\\phi_h(z) = C_1 \\cosh(Bz)\n$$\nFor the particular solution, we observe the source term is a quadratic polynomial in $z$. We seek a particular solution of the form $\\phi_p(z) = P_2 z^2 + P_1 z + P_0$. Since the source term has no term linear in $z$, and the differential operator preserves parity, the particular solution must also be an even function, so $P_1=0$. Let $\\phi_p(z) = P_2 z^2 + P_0$. Its derivatives are $\\frac{d\\phi_p}{dz} = 2P_2 z$ and $\\frac{d^2\\phi_p}{dz^2} = 2P_2$. Substituting into the ODE:\n$$\n2P_2 - B^2(P_2 z^2 + P_0) = -\\frac{L_2}{D} z^2 - \\frac{S_0}{D}\n$$\nEquating coefficients of like powers of $z$:\nCoefficient of $z^2$: $-B^2 P_2 = -\\frac{L_2}{D} \\implies P_2 = \\frac{L_2}{B^2 D} = \\frac{L_2}{(\\Sigma_a/D)D} = \\frac{L_2}{\\Sigma_a}$.\nConstant term: $2P_2 - B^2 P_0 = -\\frac{S_0}{D} \\implies B^2 P_0 = 2P_2 + \\frac{S_0}{D} = \\frac{2L_2}{\\Sigma_a} + \\frac{S_0}{D}$.\n$P_0 = \\frac{2L_2}{B^2 \\Sigma_a} + \\frac{S_0}{B^2 D} = \\frac{2L_2 D}{\\Sigma_a^2} + \\frac{S_0}{\\Sigma_a}$.\nThe particular solution is:\n$$\n\\phi_p(z) = \\frac{L_2}{\\Sigma_a} z^2 + \\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\n$$\nThe general solution for $\\phi(z)$ is $\\phi(z) = \\phi_h(z) + \\phi_p(z)$:\n$$\n\\phi(z) = C_1 \\cosh(Bz) + \\frac{L_2}{\\Sigma_a} z^2 + \\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\n$$\nWe apply the boundary condition at $z=H/2$ to find $C_1$. First, we find the derivative:\n$$\n\\frac{d\\phi}{dz} = C_1 B \\sinh(Bz) + \\frac{2L_2}{\\Sigma_a} z\n$$\nApplying $\\frac{d\\phi}{dz}(H/2) = 0$:\n$$\nC_1 B \\sinh\\left(\\frac{BH}{2}\\right) + \\frac{2L_2}{\\Sigma_a} \\frac{H}{2} = 0 \\implies C_1 B \\sinh\\left(\\frac{BH}{2}\\right) = -\\frac{L_2 H}{\\Sigma_a}\n$$\n$$\nC_1 = -\\frac{L_2 H}{B \\Sigma_a \\sinh(BH/2)}\n$$\nThe complete analytical solution for the flux profile $\\phi(x)$ is therefore:\n$$\n\\phi(x) = -\\frac{L_2 H}{B \\Sigma_a \\sinh(BH/2)} \\cosh\\left(B\\left(x-\\frac{H}{2}\\right)\\right) + \\frac{L_2}{\\Sigma_a}\\left(x-\\frac{H}{2}\\right)^2 + \\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\n$$\nThe main task is to compute the node-averaged flux:\n$$\n\\overline{\\phi} = \\frac{1}{H} \\int_0^H \\phi(x) dx = \\frac{1}{H} \\int_{-H/2}^{H/2} \\phi(z) dz\n$$\nWe integrate each term of $\\phi(z)$ over $[-H/2, H/2]$:\n1. Integral of the homogeneous part:\n$$\n\\int_{-H/2}^{H/2} C_1 \\cosh(Bz) dz = C_1 \\left[\\frac{\\sinh(Bz)}{B}\\right]_{-H/2}^{H/2} = \\frac{C_1}{B} \\left(\\sinh\\left(\\frac{BH}{2}\\right) - \\sinh\\left(-\\frac{BH}{2}\\right)\\right) = \\frac{2C_1}{B} \\sinh\\left(\\frac{BH}{2}\\right)\n$$\nSubstituting the expression for $C_1$:\n$$\n\\frac{2}{B} \\left(-\\frac{L_2 H}{B \\Sigma_a \\sinh(BH/2)}\\right) \\sinh\\left(\\frac{BH}{2}\\right) = -\\frac{2L_2 H}{B^2 \\Sigma_a} = -\\frac{2L_2 H D}{\\Sigma_a^2}\n$$\n2. Integral of the particular part:\n$$\n\\int_{-H/2}^{H/2} \\left( \\frac{L_2}{\\Sigma_a} z^2 + \\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2} \\right) dz = \\left[\\frac{L_2}{3\\Sigma_a} z^3 + \\left(\\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\\right)z\\right]_{-H/2}^{H/2}\n$$\n$$\n= \\frac{L_2}{3\\Sigma_a}\\left(\\left(\\frac{H}{2}\\right)^3 - \\left(-\\frac{H}{2}\\right)^3\\right) + \\left(\\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\\right)\\left(\\frac{H}{2} - \\left(-\\frac{H}{2}\\right)\\right)\n$$\n$$\n= \\frac{L_2}{3\\Sigma_a}\\left(\\frac{2H^3}{8}\\right) + \\left(\\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\\right)H = \\frac{L_2 H^3}{12\\Sigma_a} + \\frac{S_0 H}{\\Sigma_a} + \\frac{2L_2 D H}{\\Sigma_a^2}\n$$\nSumming the integrals and dividing by $H$:\n$$\n\\overline{\\phi} = \\frac{1}{H} \\left( -\\frac{2L_2 H D}{\\Sigma_a^2} + \\frac{L_2 H^3}{12\\Sigma_a} + \\frac{S_0 H}{\\Sigma_a} + \\frac{2L_2 D H}{\\Sigma_a^2} \\right)\n$$\n$$\n\\overline{\\phi} = -\\frac{2L_2 D}{\\Sigma_a^2} + \\frac{L_2 H^2}{12\\Sigma_a} + \\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2} = \\frac{S_0}{\\Sigma_a} + \\frac{L_2 H^2}{12\\Sigma_a}\n$$\nThis remarkably simple result could have also been obtained by directly integrating the original ODE over the volume (from $0$ to $H$), which represents a neutron balance over the node.\n$$\n-D \\int_0^H \\frac{d^2\\phi}{dx^2} dx + \\Sigma_a \\int_0^H \\phi(x) dx = \\int_0^H S_0 dx + \\int_0^H L_2 (x-H/2)^2 dx\n$$\n$$\n-D \\left[\\frac{d\\phi}{dx}\\right]_0^H + \\Sigma_a H \\overline{\\phi} = S_0 H + L_2 \\left[\\frac{(x-H/2)^3}{3}\\right]_0^H\n$$\nUsing the boundary conditions $\\frac{d\\phi}{dx}(0)=\\frac{d\\phi}{dx}(H)=0$:\n$$\n0 + \\Sigma_a H \\overline{\\phi} = S_0 H + \\frac{L_2 H^3}{12} \\implies \\overline{\\phi} = \\frac{S_0}{\\Sigma_a} + \\frac{L_2 H^2}{12\\Sigma_a}\n$$\nThis confirms our derived expression. Now, we substitute the given numerical values: $D=1.2\\,\\mathrm{cm}$, $\\Sigma_{a}=0.08\\,\\mathrm{cm}^{-1}$, $H=40\\,\\mathrm{cm}$, $S_{0}=5.0\\times 10^{5}\\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$, and $L_{2}=8.0\\times 10^{2}\\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-5}\\,\\mathrm{s}^{-1}$.\n$$\n\\overline{\\phi} = \\frac{5.0 \\times 10^5}{0.08} + \\frac{(8.0 \\times 10^2) \\times (40)^2}{12 \\times 0.08}\n$$\nCalculate each term:\nFirst term: $\\frac{S_0}{\\Sigma_a} = \\frac{5.0 \\times 10^5}{0.08} = 6.25 \\times 10^6 \\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$.\nSecond term: $\\frac{L_2 H^2}{12 \\Sigma_a} = \\frac{(8.0 \\times 10^2) \\times 1600}{0.96} = \\frac{1.28 \\times 10^6}{0.96} = 1.3333... \\times 10^6 \\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$.\nSumming the terms:\n$$\n\\overline{\\phi} = (6.25 \\times 10^6) + (1.3333... \\times 10^6) = 7.5833... \\times 10^6 \\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}\n$$\nThe problem requires the result to be rounded to four significant figures.\n$$\n\\overline{\\phi} \\approx 7.583 \\times 10^6 \\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}\n$$",
            "answer": "$$\n\\boxed{7.583 \\times 10^{6}}\n$$"
        },
        {
            "introduction": "The accuracy of a nodal calculation is critically dependent on the fidelity of the transverse leakage approximation. This exercise  moves from pure analysis to computational comparison, challenging you to implement and evaluate two different leakage models: a simple flat approximation and a more refined quadratic one. By comparing the calculated eigenvalues from both methods against a known reference, you will gain tangible insight into how the choice of approximation impacts the accuracy of a reactor physics simulation.",
            "id": "4258589",
            "problem": "You are asked to implement and compare two transverse integration nodal formulations for the one-group steady-state neutron diffusion eigenvalue problem in a homogeneous rectangular reactor, focusing on the impact of approximating the transverse leakage as flat versus quadratic within each node. The objective is to quantify how these approximations affect the accuracy of node eigenvalues in a two-node test with symmetric conditions.\n\nThe fundamental base is the one-group, steady-state neutron diffusion equation in two spatial dimensions, written for neutron scalar flux $\\phi(x,y)$:\n$$\n- \\nabla \\cdot \\left( D \\nabla \\phi(x,y) \\right) + \\Sigma_a \\, \\phi(x,y) = \\frac{\\nu \\Sigma_f}{k} \\, \\phi(x,y),\n$$\nfor a homogeneous medium with diffusion coefficient $D$ and macroscopic cross sections $\\Sigma_a$ (absorption) and $\\nu \\Sigma_f$ (production), and eigenvalue $k$ (multiplication factor). The domain is a rectangle of width $L_x$ in the $x$-direction and width $L_y$ in the $y$-direction, with vacuum boundary conditions $\\phi=0$ at $x=0$, $x=L_x$, $y=0$, and $y=L_y$.\n\nUnder transverse integration techniques (TIT) in nodal methods, the two-dimensional equation is reduced to a one-dimensional equation in $x$ for the transverse-averaged flux $\\varphi(x)$ by integrating over the $y$-direction and modeling the transverse leakage $-D \\frac{\\partial^2 \\phi}{\\partial y^2}$ as a source term. For homogeneous conditions, the separation-of-variables solution implies a characteristic transverse curvature with buckling $B_y^2 = \\left( \\frac{\\pi}{L_y} \\right)^2$, yielding an effective removal term $D B_y^2$ added to the absorption.\n\nThe exact fundamental mode eigenvalue in two dimensions for the homogeneous rectangle is\n$$\nk_{\\mathrm{ref}} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D \\left( \\left( \\frac{\\pi}{L_x} \\right)^2 + \\left( \\frac{\\pi}{L_y} \\right)^2 \\right)}.\n$$\n\nIn nodal methods, one partitions the $x$-domain into nodes and solves the one-dimensional transverse-integrated equation in each node with coupling through interface currents. In this problem, you will use two nodes of equal width ($N_x = 2$), enforcing symmetric conditions (identical material properties and node sizes), and use two transverse leakage approximations:\n- Flat leakage approximation: transverse leakage is represented as a constant removal $D B_y^2$ within each node, combined with a two-node finite-volume discretization (piecewise constant basis in each node). The discrete operator is assembled from node volume balances, interface currents using two-point fluxes, and effective removal $\\Sigma_a + D B_y^2$.\n- Quadratic leakage approximation: transverse leakage is represented consistently through a second-order polynomial (quadratic) basis within each node using a standard quadratic finite element discretization in $x$. The stiffness includes the diffusion term and the effective removal $(\\Sigma_a + D B_y^2)$ integrated against quadratic shape functions.\n\nFor each approximation, assemble the generalized eigenvalue problem\n$$\n\\mathbf{K} \\, \\mathbf{c} = \\mu \\, \\mathbf{F} \\, \\mathbf{c}, \\quad \\text{with} \\quad k = \\frac{1}{\\mu},\n$$\nwhere $\\mathbf{K}$ is the discrete operator from diffusion plus removal and $\\mathbf{F}$ is the fission production (mass) matrix. Compute the fundamental eigenvalue $k$ as $k = 1 / \\mu_{\\min}$ using the smallest positive generalized eigenvalue $\\mu_{\\min}$.\n\nImplement the following test suite, each being a homogeneous reactor with symmetric two-node partition in $x$:\n- Test Case $1$ (happy path): $D = 1$ (in $\\mathrm{cm}$), $\\Sigma_a = 0.1$ (in $\\mathrm{cm}^{-1}$), $\\nu \\Sigma_f = 0.2$ (in $\\mathrm{cm}^{-1}$), $L_x = 40$ (in $\\mathrm{cm}$), $L_y = 40$ (in $\\mathrm{cm}$).\n- Test Case $2$ (strong transverse leakage): $D = 1$ (in $\\mathrm{cm}$), $\\Sigma_a = 0.1$ (in $\\mathrm{cm}^{-1}$), $\\nu \\Sigma_f = 0.2$ (in $\\mathrm{cm}^{-1}$), $L_x = 40$ (in $\\mathrm{cm}$), $L_y = 20$ (in $\\mathrm{cm}$).\n- Test Case $3$ (weak axial leakage): $D = 1$ (in $\\mathrm{cm}$), $\\Sigma_a = 0.1$ (in $\\mathrm{cm}^{-1}$), $\\nu \\Sigma_f = 0.2$ (in $\\mathrm{cm}^{-1}$), $L_x = 80$ (in $\\mathrm{cm}$), $L_y = 40$ (in $\\mathrm{cm}$).\n\nFor each test case:\n- Compute the exact reference eigenvalue $k_{\\mathrm{ref}}$ using the above formula.\n- Compute $k_{\\mathrm{flat}}$ using the two-node finite-volume discretization with flat leakage approximation and vacuum boundaries.\n- Compute $k_{\\mathrm{quad}}$ using the two-node quadratic finite element discretization with Dirichlet boundaries.\n- Report the absolute errors $|k_{\\mathrm{flat}} - k_{\\mathrm{ref}}|$ and $|k_{\\mathrm{quad}} - k_{\\mathrm{ref}}|$ as dimensionless floats.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain $6$ floats in the following order: $[|k_{\\mathrm{flat}}^{(1)} - k_{\\mathrm{ref}}^{(1)}|, |k_{\\mathrm{quad}}^{(1)} - k_{\\mathrm{ref}}^{(1)}|, |k_{\\mathrm{flat}}^{(2)} - k_{\\mathrm{ref}}^{(2)}|, |k_{\\mathrm{quad}}^{(2)} - k_{\\mathrm{ref}}^{(2)}|, |k_{\\mathrm{flat}}^{(3)} - k_{\\mathrm{ref}}^{(3)}|, |k_{\\mathrm{quad}}^{(3)} - k_{\\mathrm{ref}}^{(3)}|]$, where superscripts indicate the test case index.\n\nNo user input is required. All quantities must be computed as described. All physical quantities are to be treated with the units specified above, and all outputs are dimensionless floats. Angles are not used. Percentages are not used.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of neutron diffusion theory and numerical methods for solving partial differential equations. The problem is well-posed, with all necessary parameters, equations, and boundary conditions explicitly provided. The language is objective and the tasks are clearly defined.\n\nThe solution proceeds by first establishing the theoretical framework, then deriving the discrete formulations for the two specified approximation methods, and finally applying these formulations to the given test cases.\n\n### Theoretical Framework\n\nThe starting point is the one-group, steady-state neutron diffusion equation in a two-dimensional homogeneous rectangular domain of size $L_x \\times L_y$:\n$$\n- \\nabla \\cdot \\left( D \\nabla \\phi(x,y) \\right) + \\Sigma_a \\, \\phi(x,y) = \\frac{1}{k} \\nu \\Sigma_f \\, \\phi(x,y)\n$$\nHere, $\\phi(x,y)$ is the neutron scalar flux, $D$ is the diffusion coefficient, $\\Sigma_a$ is the macroscopic absorption cross section, $\\nu \\Sigma_f$ is the macroscopic production cross section, and $k$ is the multiplication factor eigenvalue. The problem specifies vacuum boundary conditions, which are modeled as zero-flux conditions: $\\phi(x,y)=0$ on the boundary of the domain.\n\nThe method of transverse integration reduces the dimensionality of the problem. We integrate the equation over the $y$-direction from $y=0$ to $y=L_y$, defining a transverse-averaged flux $\\varphi(x) = \\int_0^{L_y} \\phi(x,y) \\, dy$. The equation becomes:\n$$\n-D \\frac{d^2 \\varphi(x)}{dx^2} + \\Sigma_a \\varphi(x) - D \\int_0^{L_y} \\frac{\\partial^2 \\phi(x,y)}{\\partial y^2} \\, dy = \\frac{\\nu \\Sigma_f}{k} \\varphi(x)\n$$\nThe integral term represents the transverse leakage in the $y$-direction. For a homogeneous medium with zero-flux boundaries, the flux can be approximated by separation of variables, $\\phi(x,y) \\approx \\varphi(x) \\sin(B_y y)$, where $B_y = \\pi/L_y$. This implies $\\frac{\\partial^2 \\phi}{\\partial y^2} \\approx -B_y^2 \\phi(x,y)$. Substituting this approximation, the transverse leakage term becomes $D B_y^2 \\varphi(x)$. This acts as an additional removal mechanism.\n\nThe resulting one-dimensional equation for $\\varphi(x)$ on the domain $x \\in [0, L_x]$ is:\n$$\n-D \\frac{d^2 \\varphi(x)}{dx^2} + (\\Sigma_a + D B_y^2) \\varphi(x) = \\frac{\\nu \\Sigma_f}{k} \\varphi(x)\n$$\nwith boundary conditions $\\varphi(0)=0$ and $\\varphi(L_x)=0$. Let us define an effective removal cross section $\\Sigma_R' = \\Sigma_a + D B_y^2$. The 1D eigenvalue problem is then:\n$$\n-D \\frac{d^2 \\varphi(x)}{dx^2} + \\Sigma_R' \\varphi(x) = \\frac{\\nu \\Sigma_f}{k} \\varphi(x)\n$$\n\n### Reference Eigenvalue Calculation\n\nThe exact analytical solution for the original 2D problem gives the fundamental mode eigenvalue:\n$$\nk_{\\mathrm{ref}} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D (B_x^2 + B_y^2)} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D \\left( \\left( \\frac{\\pi}{L_x} \\right)^2 + \\left( \\frac{\\pi}{L_y} \\right)^2 \\right)}\n$$\nThis value serves as the reference against which the numerical approximations are compared.\n\n### Flat Leakage Approximation (Finite Volume Method)\n\nThis method employs a two-node finite volume discretization. The domain $[0, L_x]$ is divided into two nodes of equal width $h = L_x/2$: node 1 on $[0, h]$ and node 2 on $[h, L_x]$. The unknowns are the cell-average fluxes, $\\varphi_1$ and $\\varphi_2$.\n\nIntegrating the 1D equation over node 1 ($[0, h]$) yields:\n$$\n\\left(-D \\frac{d\\varphi}{dx}\\right)\\Big|_h - \\left(-D \\frac{d\\varphi}{dx}\\right)\\Big|_0 + \\Sigma_R' \\varphi_1 h = \\frac{\\nu \\Sigma_f}{k} \\varphi_1 h\n$$\nThe currents $J(x) = -D \\frac{d\\varphi}{dx}$ are approximated using finite differences:\n- Interface current at $x=h$: $J(h) \\approx -D\\frac{\\varphi_2 - \\varphi_1}{h}$\n- Boundary current at $x=0$: a zero flux boundary condition $\\varphi(0)=0$ implies $J(0) \\approx -D\\frac{\\varphi_1 - 0}{h/2} = -\\frac{2D}{h}\\varphi_1$.\n\nSubstituting these into the balance equation for node 1 gives:\n$$\n-D\\frac{\\varphi_2 - \\varphi_1}{h} - \\left(-\\frac{2D}{h}\\varphi_1\\right) + \\Sigma_R' \\varphi_1 h = \\frac{\\nu \\Sigma_f}{k} \\varphi_1 h \\implies \\left(\\frac{3D}{h} + \\Sigma_R' h\\right)\\varphi_1 - \\frac{D}{h}\\varphi_2 = \\frac{\\nu \\Sigma_f h}{k}\\varphi_1\n$$\nBy symmetry, the balance equation for node 2 is:\n$$\n-\\frac{D}{h}\\varphi_1 + \\left(\\frac{3D}{h} + \\Sigma_R' h\\right)\\varphi_2 = \\frac{\\nu \\Sigma_f h}{k}\\varphi_2\n$$\nThis forms a generalized eigenvalue problem $\\mathbf{K}\\boldsymbol{\\varphi} = \\mu \\mathbf{F} \\boldsymbol{\\varphi}$ where $\\mu = 1/k$:\n$$\n\\begin{pmatrix} \\frac{3D}{h} + \\Sigma_R' h & -\\frac{D}{h} \\\\ -\\frac{D}{h} & \\frac{3D}{h} + \\Sigma_R' h \\end{pmatrix} \\begin{pmatrix} \\varphi_1 \\\\ \\varphi_2 \\end{pmatrix} = \\mu \\begin{pmatrix} \\nu\\Sigma_f h & 0 \\\\ 0 & \\nu\\Sigma_f h \\end{pmatrix} \\begin{pmatrix} \\varphi_1 \\\\ \\varphi_2 \\end{pmatrix}\n$$\nThe fundamental mode corresponds to the symmetric eigenvector $[\\varphi_1, \\varphi_2]^T = [1, 1]^T$. Substituting this into the first row gives:\n$$\n\\left(\\frac{3D}{h} + \\Sigma_R' h\\right) - \\frac{D}{h} = \\mu_{\\min} (\\nu\\Sigma_f h) \\implies \\frac{2D}{h} + \\Sigma_R' h = \\mu_{\\min} \\nu\\Sigma_f h\n$$\nSolving for $\\mu_{\\min}$ and then for $k_{\\mathrm{flat}} = 1/\\mu_{\\min}$:\n$$\nk_{\\mathrm{flat}} = \\frac{\\nu \\Sigma_f h}{\\frac{2D}{h} + \\Sigma_R' h} = \\frac{\\nu \\Sigma_f h^2}{2D + \\Sigma_R' h^2}\n$$\n\n### Quadratic Leakage Approximation (Finite Element Method)\n\nThis method uses a standard quadratic Finite Element Method (FEM) on two elements. The domain $[0, L_x]$ is partitioned into two elements of length $h=L_x/2$. The nodes are located at $x=0, h/2, h, 3h/2, L_x$. Due to the boundary conditions $\\varphi(0)=\\varphi(L_x)=0$, there are three unknown degrees of freedom, $c_1, c_2, c_3$, corresponding to the flux values at $x=h/2$, $x=h$, and $x=3h/2$.\n\nThe Galerkin weak form of the 1D equation is:\n$$\n\\int_0^{L_x} \\left( D \\frac{d\\varphi}{dx}\\frac{dv}{dx} + \\Sigma_R' \\varphi v \\right) dx = \\mu \\int_0^{L_x} (\\nu\\Sigma_f) \\varphi v \\, dx\n$$\nDiscretizing with quadratic basis functions leads to the matrix system $\\mathbf{K}\\mathbf{c} = \\mu \\mathbf{F}\\mathbf{c}$. The stiffness matrix $\\mathbf{K}$ and fission matrix $\\mathbf{F}$ are assembled from element contributions. For a quadratic element of length $h_e$, the element stiffness matrix $\\mathbf{K}^e$ and mass matrix $\\mathbf{M}^e$ are given by:\n$$\n\\mathbf{K}^e = D \\mathbf{S}^e + \\Sigma_R' \\mathbf{M}^e\n$$\nwith\n$$\n\\mathbf{S}^e = \\frac{1}{3h_e} \\begin{pmatrix} 7 & -8 & 1 \\\\ -8 & 16 & -8 \\\\ 1 & -8 & 7 \\end{pmatrix}, \\quad \\mathbf{M}^e = \\frac{h_e}{30} \\begin{pmatrix} 4 & 2 & -1 \\\\ 2 & 16 & 2 \\\\ -1 & 2 & 4 \\end{pmatrix}\n$$\nThese matrices correspond to local nodes at the left, middle, and right of the element. We assemble the $3 \\times 3$ global matrices for the three interior degrees of freedom. The element length is $h_e = h = L_x/2$.\n- DOF 1 (node at $x=h/2$): middle node of element 1.\n- DOF 2 (node at $x=h$): right node of element 1 and left node of element 2.\n- DOF 3 (node at $x=3h/2$): middle node of element 2.\n\nThe assembled global matrices $\\mathbf{K}$ and $\\mathbf{M}$ are:\n$$\n\\mathbf{K} = \\begin{pmatrix} K^e_{11} & K^e_{12} & 0 \\\\ K^e_{21} & K^e_{22}+K^e_{00} & K^e_{01} \\\\ 0 & K^e_{10} & K^e_{11} \\end{pmatrix}, \\quad\n\\mathbf{M} = \\begin{pmatrix} M^e_{11} & M^e_{12} & 0 \\\\ M^e_{21} & M^e_{22}+M^e_{00} & M^e_{01} \\\\ 0 & M^e_{10} & M^e_{11} \\end{pmatrix}\n$$\nwhere the indices $0,1,2$ refer to the left, middle, and right nodes of an element. The global fission matrix is $\\mathbf{F} = \\nu\\Sigma_f \\mathbf{M}$.\n\nThe generalized eigenvalue problem $\\mathbf{K}\\mathbf{c} = \\mu \\mathbf{F}\\mathbf{c}$ is solved for its eigenvalues $\\mu$. The smallest positive eigenvalue, $\\mu_{\\min}$, corresponds to the fundamental mode. The estimated multiplication factor is then $k_{\\mathrm{quad}} = 1/\\mu_{\\min}$.\n\nThe absolute errors are computed as $|k_{\\mathrm{flat}} - k_{\\mathrm{ref}}|$ and $|k_{\\mathrm{quad}} - k_{\\mathrm{ref}}|$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Implements and compares two transverse integration nodal formulations\n    for the one-group steady-state neutron diffusion eigenvalue problem.\n    \"\"\"\n    \n    test_cases = [\n        # (D, Sigma_a, nu*Sigma_f, L_x, L_y)\n        (1.0, 0.1, 0.2, 40.0, 40.0),  # Test Case 1\n        (1.0, 0.1, 0.2, 40.0, 20.0),  # Test Case 2\n        (1.0, 0.1, 0.2, 80.0, 40.0),  # Test Case 3\n    ]\n\n    results = []\n    \n    for D, Sigma_a, nu_Sigma_f, L_x, L_y in test_cases:\n        # --- Common Parameters ---\n        pi_val = np.pi\n        h = L_x / 2.0  # Node/element width\n\n        # Geometric bucklings\n        B_x_sq = (pi_val / L_x)**2\n        B_y_sq = (pi_val / L_y)**2\n        \n        # --- Reference Eigenvalue ---\n        k_ref = nu_Sigma_f / (Sigma_a + D * (B_x_sq + B_y_sq))\n\n        # --- Transverse-Integrated Problem Parameters ---\n        # Effective removal cross section including transverse leakage\n        Sigma_r_eff = Sigma_a + D * B_y_sq\n\n        # --- Method 1: Flat Leakage (Finite Volume) ---\n        # Derived from the fundamental mode of the 2x2 system\n        mu_flat = (2.0 * D + Sigma_r_eff * h**2) / (nu_Sigma_f * h**2)\n        k_flat = 1.0 / mu_flat\n        \n        # --- Method 2: Quadratic Leakage (Finite Element) ---\n        # Element matrices for a generic quadratic element of length he=h\n        # Element mass matrix M^e\n        Me = (h / 30.0) * np.array([\n            [4.0, 2.0, -1.0],\n            [2.0, 16.0, 2.0],\n            [-1.0, 2.0, 4.0]\n        ])\n        \n        # Element diffusion stiffness matrix S^e\n        Se = (1.0 / (3.0 * h)) * np.array([\n            [7.0, -8.0, 1.0],\n            [-8.0, 16.0, -8.0],\n            [1.0, -8.0, 7.0]\n        ])\n\n        # Full element stiffness matrix K^e = D*S^e + Sigma_r_eff*M^e\n        Ke = D * Se + Sigma_r_eff * Me\n        \n        # Assemble global 3x3 matrices for the 3 internal DOFs\n        K_global = np.zeros((3, 3))\n        M_global = np.zeros((3, 3))\n\n        # DOF mapping: [h/2, h, 3h/2]\n        # DOF 1 (mid of elem 1)\n        # DOF 2 (interface)\n        # DOF 3 (mid of elem 2)\n        \n        # Assemble K_global\n        K_global[0, 0] = Ke[1, 1]              # mid-mid of elem 1\n        K_global[0, 1] = Ke[1, 2]              # mid-right of elem 1\n        K_global[1, 0] = Ke[2, 1]              # right-mid of elem 1\n        K_global[1, 1] = Ke[2, 2] + Ke[0, 0]   # right-right of elem 1 + left-left of elem 2\n        K_global[1, 2] = Ke[0, 1]              # left-mid of elem 2\n        K_global[2, 1] = Ke[1, 0]              # mid-left of elem 2\n        K_global[2, 2] = Ke[1, 1]              # mid-mid of elem 2\n        \n        # Assemble M_global\n        M_global[0, 0] = Me[1, 1]\n        M_global[0, 1] = Me[1, 2]\n        M_global[1, 0] = Me[2, 1]\n        M_global[1, 1] = Me[2, 2] + Me[0, 0]\n        M_global[1, 2] = Me[0, 1]\n        M_global[2, 1] = Me[1, 0]\n        M_global[2, 2] = Me[1, 1]\n        \n        # Global fission matrix F = nu*Sigma_f * M\n        F_global = nu_Sigma_f * M_global\n        \n        # Solve the generalized eigenvalue problem: K*c = mu*F*c\n        # eigh is for symmetric/hermitian matrices and returns sorted eigenvalues.\n        mu_eigenvalues, _ = eigh(K_global, F_global)\n        \n        # The fundamental mode corresponds to the smallest eigenvalue mu\n        mu_quad = mu_eigenvalues[0]\n        k_quad = 1.0 / mu_quad\n        \n        # --- Calculate and store errors ---\n        error_flat = abs(k_flat - k_ref)\n        error_quad = abs(k_quad - k_ref)\n        \n        results.append(error_flat)\n        results.append(error_quad)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While analytical solutions provide powerful insights, their direct implementation can sometimes lead to numerical instability in certain physical regimes. This advanced practice  explores a critical issue in nodal codes: the breakdown of the standard hyperbolic function solution in regions with very low neutron absorption. By deriving the limiting form of the flux solution as the removal cross section $\\Sigma_{a}$ approaches zero, you will uncover the mathematical basis for the robust numerical schemes used in production-level simulation tools.",
            "id": "4258648",
            "problem": "Consider a homogeneous rectangular node in a nuclear reactor core modeled under the steady-state, one-group neutron diffusion approximation. The governing equation is derived from Fick's Law and particle balance: the neutron current is $-\\boldsymbol{D} \\nabla \\phi$, and the steady-state balance requires $-\\nabla \\cdot (\\boldsymbol{D} \\nabla \\phi) + \\Sigma_{a} \\phi = q$, where $\\phi$ is the neutron flux, $\\boldsymbol{D}$ is the diffusion tensor, $\\Sigma_{a}$ is the macroscopic absorption cross section, and $q$ is the net within-group volumetric source (including fission and external sources, minus any explicit out-scattering terms included in the removal). In nodal methods such as the Nodal Expansion Method (NEM), the transverse integration technique reduces the three-dimensional equation to a sequence of one-dimensional balance equations by integrating over the transverse directions and approximating the transverse leakage by a low-order polynomial in each coordinate. Along the $x$-direction in a node of width $h$, the transverse-integrated one-dimensional balance can be written in the form\n$$\nD \\frac{d^{2} \\phi(x)}{dx^{2}} - \\Sigma_{a} \\phi(x) = - q - \\mathcal{L}(x),\n$$\nwhere $D$ is the $x$-directed diffusion coefficient (assume isotropy so that $D$ is a scalar), $q$ is the node-averaged source obtained from integrating over the transverse directions, and $\\mathcal{L}(x)$ represents the integrated transverse leakage from the $y$ and $z$ directions approximated within the node by a second-order even polynomial\n$$\n\\mathcal{L}(x) = \\ell_{0} + \\ell_{2} x^{2}.\n$$\nAssume absorbing boundary conditions at the node faces,\n$$\n\\phi\\!\\left(-\\frac{h}{2}\\right) = 0, \\qquad \\phi\\!\\left(\\frac{h}{2}\\right) = 0,\n$$\nconsistent with a local Dirichlet closure used for analytical verification in nodal method development.\n\nStarting from the above fundamental balance and approximation framework, derive the limiting analytic form of the solution $\\phi(x)$ as the absorption cross section tends to zero, $\\Sigma_{a} \\to 0$, while keeping $D$, $q$, $\\ell_{0}$, $\\ell_{2}$, and $h$ fixed and finite. Your derivation must begin from the provided physical laws and definitions and proceed logically to the limiting solution without invoking shortcut formulas. In addition, briefly explain the implications of this limiting form for numerical stability in low-removal regions in nodal methods that employ transverse integration.\n\nProvide your final expression for the limiting flux shape $\\phi_{\\text{lim}}(x)$ in closed analytic form as a function of $x$, $D$, $q$, $\\ell_{0}$, $\\ell_{2}$, and $h$. No numerical evaluation is required.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   The governing one-dimensional transverse-integrated neutron diffusion equation is:\n    $$D \\frac{d^{2} \\phi(x)}{dx^{2}} - \\Sigma_{a} \\phi(x) = - q - \\mathcal{L}(x)$$\n-   The domain is a node of width $h$, defined for $x \\in \\left[-\\frac{h}{2}, \\frac{h}{2}\\right]$.\n-   The diffusion coefficient, $D$, is a scalar.\n-   The macroscopic absorption cross section is $\\Sigma_a$.\n-   The node-averaged source is $q$.\n-   The transverse leakage term, $\\mathcal{L}(x)$, is approximated by a second-order even polynomial:\n    $$\\mathcal{L}(x) = \\ell_{0} + \\ell_{2} x^{2}$$\n-   The boundary conditions are absorbing (Dirichlet):\n    $$\\phi\\!\\left(-\\frac{h}{2}\\right) = 0, \\qquad \\phi\\!\\left(\\frac{h}{2}\\right) = 0$$\n-   The parameters $D$, $q$, $\\ell_{0}$, $\\ell_{2}$, and $h$ are fixed and finite.\n-   The task is to find the limiting analytic form of the solution $\\phi(x)$, denoted $\\phi_{\\text{lim}}(x)$, as the absorption cross section tends to zero, $\\Sigma_{a} \\to 0$.\n-   An additional task is to explain the implications of this limit for numerical stability.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is based on the one-group neutron diffusion equation and the transverse integration technique, which are standard and fundamental concepts in the field of nuclear reactor physics and computational methods, specifically nodal analysis. The formulation is scientifically sound.\n-   **Well-Posed**: The problem is a second-order linear ordinary differential equation (ODE) with two specified Dirichlet boundary conditions. For any $\\Sigma_{a} \\ge 0$, this constitutes a well-posed boundary value problem that admits a unique solution. The task of finding the limit of this solution as a parameter goes to zero is a well-defined mathematical procedure.\n-   **Objective**: The problem is stated using precise, unambiguous technical terminology. There are no subjective or opinion-based elements.\n-   **Completeness**: All necessary information ($D$, $q$, $\\ell_0$, $\\ell_2$, $h$, boundary conditions, and the limiting condition) is provided to derive the solution. The problem is self-contained.\n-   **Consistency**: The givens are internally consistent. There are no contradictory constraints.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-posed, scientifically grounded problem from nuclear engineering that can be solved using standard mathematical techniques. I will proceed with the derivation.\n\n### Solution Derivation\n\nThe starting point is the provided one-dimensional, transverse-integrated neutron balance equation for the flux $\\phi(x)$ within a homogeneous node:\n$$D \\frac{d^{2} \\phi(x)}{dx^{2}} - \\Sigma_{a} \\phi(x) = - q - \\mathcal{L}(x)$$\nSubstituting the given form for the transverse leakage, $\\mathcal{L}(x) = \\ell_{0} + \\ell_{2} x^{2}$, we obtain the full ODE:\n$$D \\frac{d^{2} \\phi(x)}{dx^{2}} - \\Sigma_{a} \\phi(x) = - (q + \\ell_{0}) - \\ell_{2} x^{2}$$\nWe are asked to find the limiting form of the solution $\\phi(x)$ as $\\Sigma_{a} \\to 0$. Let us denote this limiting solution as $\\phi_{\\text{lim}}(x)$.\n\nThe process of taking a limit of a differential equation's solution can be complex. However, in this case, the coefficient of the highest-order derivative, $D \\frac{d^{2} \\phi}{dx^{2}}$, is $D$, which is constant and does not depend on the parameter $\\Sigma_a$. This identifies the problem as a regular perturbation problem, not a singular one. For such problems, the limit of the solution is the solution of the limiting equation. Therefore, we can legitimately take the limit $\\Sigma_{a} \\to 0$ in the differential equation itself before solving.\n\nAs $\\Sigma_{a} \\to 0$, the term $\\Sigma_{a} \\phi(x)$ vanishes, provided $\\phi(x)$ remains finite, which we expect from physical considerations. The governing ODE simplifies to:\n$$D \\frac{d^{2} \\phi_{\\text{lim}}(x)}{dx^{2}} = - (q + \\ell_{0}) - \\ell_{2} x^{2}$$\nThis is a simple second-order ODE for $\\phi_{\\text{lim}}(x)$. We can solve it by direct integration. First, rearrange the equation:\n$$\\frac{d^{2} \\phi_{\\text{lim}}}{dx^{2}} = -\\frac{1}{D} (q + \\ell_{0} + \\ell_{2} x^{2})$$\nIntegrating with respect to $x$ once yields the flux gradient:\n$$\\frac{d \\phi_{\\text{lim}}}{dx} = -\\frac{1}{D} \\left( (q + \\ell_{0})x + \\frac{\\ell_{2}}{3} x^{3} \\right) + C_{1}$$\nwhere $C_1$ is the first constant of integration. Integrating a second time gives the general form of the limiting flux:\n$$\\phi_{\\text{lim}}(x) = -\\frac{1}{D} \\left( \\frac{q + \\ell_{0}}{2} x^{2} + \\frac{\\ell_{2}}{12} x^{4} \\right) + C_{1} x + C_{2}$$\nwhere $C_2$ is the second constant of integration.\n\nThe constants $C_1$ and $C_2$ are determined by applying the boundary conditions $\\phi(-\\frac{h}{2}) = 0$ and $\\phi(\\frac{h}{2}) = 0$.\nThe problem exhibits symmetry: the domain is symmetric about $x=0$, the boundary conditions are symmetric, and the source term $-(q + \\ell_{0} + \\ell_{2} x^{2})$ is an even function of $x$. Consequently, the solution $\\phi_{\\text{lim}}(x)$ must be an even function. For $\\phi_{\\text{lim}}(x)$ to be even, the coefficient of the odd term $x$ must be zero. Thus, $C_{1} = 0$.\n\nThe solution simplifies to:\n$$\\phi_{\\text{lim}}(x) = -\\frac{1}{D} \\left( \\frac{q + \\ell_{0}}{2} x^{2} + \\frac{\\ell_{2}}{12} x^{4} \\right) + C_{2}$$\nNow, we apply the remaining boundary condition, $\\phi_{\\text{lim}}(\\frac{h}{2}) = 0$:\n$$0 = -\\frac{1}{D} \\left( \\frac{q + \\ell_{0}}{2} \\left(\\frac{h}{2}\\right)^{2} + \\frac{\\ell_{2}}{12} \\left(\\frac{h}{2}\\right)^{4} \\right) + C_{2}$$\nSolving for $C_2$:\n$$C_{2} = \\frac{1}{D} \\left( \\frac{(q + \\ell_{0})h^{2}}{8} + \\frac{\\ell_{2}h^{4}}{192} \\right)$$\nSubstituting this expression for $C_2$ back into the solution for $\\phi_{\\text{lim}}(x)$:\n$$\\phi_{\\text{lim}}(x) = \\frac{1}{D} \\left( \\frac{(q + \\ell_{0})h^{2}}{8} + \\frac{\\ell_{2}h^{4}}{192} \\right) - \\frac{1}{D} \\left( \\frac{q + \\ell_{0}}{2} x^{2} + \\frac{\\ell_{2}}{12} x^{4} \\right)$$\nTo obtain a more insightful form, we can group terms with common factors:\n$$\\phi_{\\text{lim}}(x) = \\frac{q + \\ell_{0}}{D} \\left( \\frac{h^{2}}{8} - \\frac{x^{2}}{2} \\right) + \\frac{\\ell_{2}}{D} \\left( \\frac{h^{4}}{192} - \\frac{x^{4}}{12} \\right)$$\nFactoring out common numerical denominators yields:\n$$\\phi_{\\text{lim}}(x) = \\frac{q + \\ell_{0}}{2D} \\left( \\frac{h^{2}}{4} - x^{2} \\right) + \\frac{\\ell_{2}}{12D} \\left( \\frac{h^{4}}{16} - x^{4} \\right)$$\nThe term $(\\frac{h^{4}}{16} - x^{4})$ can be factored as a difference of squares: $(\\frac{h^{2}}{4} - x^{2})(\\frac{h^{2}}{4} + x^{2})$. This allows us to factor out the term $(\\frac{h^{2}}{4} - x^{2})$ from the entire expression:\n$$\\phi_{\\text{lim}}(x) = \\left(\\frac{h^{2}}{4} - x^{2}\\right) \\left[ \\frac{q + \\ell_{0}}{2D} + \\frac{\\ell_{2}}{12D} \\left(\\frac{h^{2}}{4} + x^{2}\\right) \\right]$$\nRearranging slightly gives the final, closed analytic form:\n$$\\phi_{\\text{lim}}(x) = \\frac{1}{D}\\left(\\frac{h^{2}}{4} - x^{2}\\right) \\left[ \\frac{q + \\ell_{0}}{2} + \\frac{\\ell_{2}}{12} \\left(\\frac{h^{2}}{4} + x^{2}\\right) \\right]$$\n\n### Implications for Numerical Stability\n\nThe general solution to the original equation (for $\\Sigma_a > 0$) involves hyperbolic functions, $\\cosh(Bx)$ and $\\sinh(Bx)$, where $B = \\sqrt{\\Sigma_a/D}$. The full solution is a combination of these hyperbolic functions and a particular solution involving inverse powers of $B^2$ and $B^4$. As $\\Sigma_a \\to 0$, $B$ also approaches $0$.\n\nIn a numerical implementation, evaluating expressions based on the hyperbolic solution for very small $B$ leads to severe numerical instability. This arises from two sources:\n1.  **Catastrophic Cancellation**: Expressions like $1 - \\cosh(Bx)$ or $\\cosh(Bx) - \\cosh(By)$ involve the subtraction of two numbers that are very close to $1$, resulting in a significant loss of relative precision.\n2.  **Division by Zero**: The particular solution contains terms proportional to $1/B^2$ and $1/B^4$, which diverge as $B \\to 0$. While the complete analytic expression combines these diverging terms in a way that results in a finite limit, their direct numerical evaluation involves subtracting very large, nearly equal numbers, which again leads to catastrophic cancellation and inaccurate results.\n\nThe derived limiting solution, $\\phi_{\\text{lim}}(x)$, is a simple quartic polynomial. This form is numerically robust and trivial to evaluate. Therefore, practical nodal codes do not use the hyperbolic function-based solution when the argument $Bh$ is small. Instead, they implement a switch: if $Bh$ is below a certain threshold, the code uses a truncated Taylor series expansion of the hyperbolic solution. The limiting flux $\\phi_{\\text{lim}}(x)$ we have derived is precisely the leading-order approximation in this expansion. This strategy avoids the numerical instabilities associated with the hyperbolic form in low-absorption (low-removal) regions, ensuring accurate and stable computations across all physical regimes.",
            "answer": "$$\\boxed{\\frac{1}{D}\\left(\\frac{h^{2}}{4} - x^{2}\\right) \\left[ \\frac{q + \\ell_{0}}{2} + \\frac{\\ell_{2}}{12} \\left(\\frac{h^{2}}{4} + x^{2}\\right) \\right]}$$"
        }
    ]
}