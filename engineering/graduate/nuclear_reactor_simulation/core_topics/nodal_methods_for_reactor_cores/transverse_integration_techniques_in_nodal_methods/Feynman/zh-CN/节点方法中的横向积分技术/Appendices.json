{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你完整地完成一个典型的解析节块法 (ANM) 问题。通过求解一个带有预设二次横向泄漏项和反射边界条件的一维扩散方程，你将在构造齐次解和特解以及应用物理约束方面获得实践经验。该练习旨在巩固进行更高级节块分析所需的基础数学技能。",
            "id": "4258625",
            "problem": "考虑一个单群、稳态中子扩散模型，用于描述一个在 $x$ 方向上厚度为 $H$、占据 $x \\in [0,H]$ 区域的均匀板状节点，其在 $x=0$ 和 $x=H$ 处具有反射边界。反射边界意味着在边界处的净中子流为零，即 $J(0)=J(H)=0$，其中 $J(x)=-D\\,\\frac{d\\phi}{dx}(x)$，因此等价于 $\\frac{d\\phi}{dx}(0)=\\frac{d\\phi}{dx}(H)=0$。该板状节点具有恒定的扩散系数 $D$ 和吸收截面 $\\Sigma_{a}$，并由一个空间均匀的外部体积源 $S_{0}$ 驱动。在其他空间方向上进行横向积分后，进入该节点的横向泄漏被建模为一个已知的关于位置的对称二次函数，\n$$\nL(x) \\;=\\; L_{2}\\,\\bigl(x-\\tfrac{H}{2}\\bigr)^{2},\n$$\n因此，需要用解析节点法 (ANM) 求解的一维节点方程为\n$$\n-\\,\\frac{d}{dx}\\!\\left(D\\,\\frac{d\\phi}{dx}\\right) \\;+\\; \\Sigma_{a}\\,\\phi(x) \\;=\\; S_{0} \\;+\\; L(x).\n$$\n使用 ANM 求解此边值问题，然后计算节点平均通量，\n$$\n\\overline{\\phi} \\;=\\; \\frac{1}{H}\\,\\int_{0}^{H}\\phi(x)\\,dx.\n$$\n取以下数值：$D=1.2\\,\\mathrm{cm}$，$\\Sigma_{a}=0.08\\,\\mathrm{cm}^{-1}$，$H=40\\,\\mathrm{cm}$，$S_{0}=5.0\\times 10^{5}\\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$，以及 $L_{2}=8.0\\times 10^{2}\\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-5}\\,\\mathrm{s}^{-1}$。将最终数值结果四舍五入至四位有效数字，并以 $\\mathrm{neutrons}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$ 为单位表示。",
            "solution": "该问题要求解一个用于均匀板状节点的一维、单群、稳态中子扩散方程，并随后计算节点平均中子通量。\n\n控制扩散方程如下所示：\n$$\n-\\,\\frac{d}{dx}\\!\\left(D\\,\\frac{d\\phi}{dx}\\right) \\;+\\; \\Sigma_{a}\\,\\phi(x) \\;=\\; S_{0} \\;+\\; L(x)\n$$\n其中 $D$ 和 $\\Sigma_a$ 是常数。横向泄漏 $L(x)$ 由 $L(x) = L_{2}\\,\\bigl(x-\\tfrac{H}{2}\\bigr)^{2}$ 给出。将其代入主方程并化简（因为 $D$ 是常数）得到：\n$$\n-D\\,\\frac{d^2\\phi}{dx^2} \\;+\\; \\Sigma_{a}\\,\\phi(x) \\;=\\; S_{0} \\;+\\; L_{2}\\,\\left(x-\\frac{H}{2}\\right)^{2}\n$$\n边界条件是反射性的，这意味着在边界 $x=0$ 和 $x=H$ 处的净中子流为零。中子流由菲克定律定义，$J(x) = -D \\frac{d\\phi}{dx}(x)$。因此，边界条件是：\n$$\n\\frac{d\\phi}{dx}(0) = 0 \\quad \\text{and} \\quad \\frac{d\\phi}{dx}(H) = 0\n$$\n为简化求解过程，我们将微分方程重排为标准形式。让我们两边同除以 $D$：\n$$\n-\\frac{d^2\\phi}{dx^2} \\;+\\; \\frac{\\Sigma_{a}}{D}\\,\\phi(x) \\;=\\; \\frac{S_{0}}{D} \\;+\\; \\frac{L_{2}}{D}\\,\\left(x-\\frac{H}{2}\\right)^{2}\n$$\n令 $B^2 = \\frac{\\Sigma_{a}}{D}$。量 $B$ 是中子扩散长度的倒数。方程变为：\n$$\n\\frac{d^2\\phi}{dx^2} - B^2 \\phi(x) = -\\frac{1}{D}\\left[S_0 + L_2\\left(x-\\frac{H}{2}\\right)^2\\right]\n$$\n这是一个二阶线性非齐次常微分方程。该问题表现出对称性。源项 $S_0 + L(x)$ 关于板的中心 $x=H/2$ 对称。边界条件也是对称的（$\\phi'(0)=0, \\phi'(H)=0$）。因此，解 $\\phi(x)$ 必然关于 $x=H/2$ 对称。引入一个平移坐标 $z = x - H/2$ 会很方便，这将使定义域 $x \\in [0, H]$ 变换为 $z \\in [-H/2, H/2]$。用 $z$ 表示的方程是：\n$$\n\\frac{d^2\\phi}{dz^2} - B^2 \\phi(z) = -\\frac{1}{D}\\left(S_0 + L_2 z^2\\right)\n$$\n边界条件变为 $\\frac{d\\phi}{dz}(-H/2) = 0$ 和 $\\frac{d\\phi}{dz}(H/2) = 0$。\n\n通解是齐次解 $\\phi_h(z)$ 和特解 $\\phi_p(z)$ 的和。\n齐次方程是 $\\frac{d^2\\phi_h}{dz^2} - B^2 \\phi_h(z) = 0$。其通解为 $\\phi_h(z) = C_1 \\cosh(Bz) + C_2 \\sinh(Bz)$。由于解必须关于 $z=0$ 对称（即为偶函数），所以奇函数 $\\sinh(Bz)$ 的系数必须为零。因此，$C_2=0$，齐次解化简为：\n$$\n\\phi_h(z) = C_1 \\cosh(Bz)\n$$\n对于特解，我们观察到源项是关于 $z$ 的二次多项式。我们寻求形式为 $\\phi_p(z) = P_2 z^2 + P_1 z + P_0$ 的特解。由于源项中没有 $z$ 的线性项，且微分算子保持奇偶性，因此特解也必须是偶函数，所以 $P_1=0$。令 $\\phi_p(z) = P_2 z^2 + P_0$。其导数为 $\\frac{d\\phi_p}{dz} = 2P_2 z$ 和 $\\frac{d^2\\phi_p}{dz^2} = 2P_2$。代入常微分方程(ODE)：\n$$\n2P_2 - B^2(P_2 z^2 + P_0) = -\\frac{L_2}{D} z^2 - \\frac{S_0}{D}\n$$\n令 $z$ 的同次幂系数相等：\n$z^2$ 的系数：$-B^2 P_2 = -\\frac{L_2}{D} \\implies P_2 = \\frac{L_2}{B^2 D} = \\frac{L_2}{(\\Sigma_a/D)D} = \\frac{L_2}{\\Sigma_a}$。\n常数项：$2P_2 - B^2 P_0 = -\\frac{S_0}{D} \\implies B^2 P_0 = 2P_2 + \\frac{S_0}{D} = \\frac{2L_2}{\\Sigma_a} + \\frac{S_0}{D}$。\n$P_0 = \\frac{2L_2}{B^2 \\Sigma_a} + \\frac{S_0}{B^2 D} = \\frac{2L_2 D}{\\Sigma_a^2} + \\frac{S_0}{\\Sigma_a}$。\n特解是：\n$$\n\\phi_p(z) = \\frac{L_2}{\\Sigma_a} z^2 + \\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\n$$\n$\\phi(z)$ 的通解为 $\\phi(z) = \\phi_h(z) + \\phi_p(z)$：\n$$\n\\phi(z) = C_1 \\cosh(Bz) + \\frac{L_2}{\\Sigma_a} z^2 + \\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\n$$\n我们应用在 $z=H/2$ 处的边界条件来求 $C_1$。首先，我们求导数：\n$$\n\\frac{d\\phi}{dz} = C_1 B \\sinh(Bz) + \\frac{2L_2}{\\Sigma_a} z\n$$\n应用 $\\frac{d\\phi}{dz}(H/2) = 0$：\n$$\nC_1 B \\sinh\\left(\\frac{BH}{2}\\right) + \\frac{2L_2}{\\Sigma_a} \\frac{H}{2} = 0 \\implies C_1 B \\sinh\\left(\\frac{BH}{2}\\right) = -\\frac{L_2 H}{\\Sigma_a}\n$$\n$$\nC_1 = -\\frac{L_2 H}{B \\Sigma_a \\sinh(BH/2)}\n$$\n因此，通量分布 $\\phi(x)$ 的完整解析解是：\n$$\n\\phi(x) = -\\frac{L_2 H}{B \\Sigma_a \\sinh(BH/2)} \\cosh\\left(B\\left(x-\\frac{H}{2}\\right)\\right) + \\frac{L_2}{\\Sigma_a}\\left(x-\\frac{H}{2}\\right)^2 + \\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\n$$\n主要任务是计算节点平均通量：\n$$\n\\overline{\\phi} = \\frac{1}{H} \\int_0^H \\phi(x) dx = \\frac{1}{H} \\int_{-H/2}^{H/2} \\phi(z) dz\n$$\n我们将 $\\phi(z)$ 的每一项在 $[-H/2, H/2]$ 上积分：\n1. 齐次部分的积分：\n$$\n\\int_{-H/2}^{H/2} C_1 \\cosh(Bz) dz = C_1 \\left[\\frac{\\sinh(Bz)}{B}\\right]_{-H/2}^{H/2} = \\frac{C_1}{B} \\left(\\sinh\\left(\\frac{BH}{2}\\right) - \\sinh\\left(-\\frac{BH}{2}\\right)\\right) = \\frac{2C_1}{B} \\sinh\\left(\\frac{BH}{2}\\right)\n$$\n代入 $C_1$ 的表达式：\n$$\n\\frac{2}{B} \\left(-\\frac{L_2 H}{B \\Sigma_a \\sinh(BH/2)}\\right) \\sinh\\left(\\frac{BH}{2}\\right) = -\\frac{2L_2 H}{B^2 \\Sigma_a} = -\\frac{2L_2 H D}{\\Sigma_a^2}\n$$\n2. 特解部分的积分：\n$$\n\\int_{-H/2}^{H/2} \\left( \\frac{L_2}{\\Sigma_a} z^2 + \\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2} \\right) dz = \\left[\\frac{L_2}{3\\Sigma_a} z^3 + \\left(\\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\\right)z\\right]_{-H/2}^{H/2}\n$$\n$$\n= \\frac{L_2}{3\\Sigma_a}\\left(\\left(\\frac{H}{2}\\right)^3 - \\left(-\\frac{H}{2}\\right)^3\\right) + \\left(\\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\\right)\\left(\\frac{H}{2} - \\left(-\\frac{H}{2}\\right)\\right)\n$$\n$$\n= \\frac{L_2}{3\\Sigma_a}\\left(\\frac{2H^3}{8}\\right) + \\left(\\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2}\\right)H = \\frac{L_2 H^3}{12\\Sigma_a} + \\frac{S_0 H}{\\Sigma_a} + \\frac{2L_2 D H}{\\Sigma_a^2}\n$$\n将积分求和并除以 $H$：\n$$\n\\overline{\\phi} = \\frac{1}{H} \\left( -\\frac{2L_2 H D}{\\Sigma_a^2} + \\frac{L_2 H^3}{12\\Sigma_a} + \\frac{S_0 H}{\\Sigma_a} + \\frac{2L_2 D H}{\\Sigma_a^2} \\right)\n$$\n$$\n\\overline{\\phi} = -\\frac{2L_2 D}{\\Sigma_a^2} + \\frac{L_2 H^2}{12\\Sigma_a} + \\frac{S_0}{\\Sigma_a} + \\frac{2L_2 D}{\\Sigma_a^2} = \\frac{S_0}{\\Sigma_a} + \\frac{L_2 H^2}{12\\Sigma_a}\n$$\n这个非常简洁的结果也可以通过直接对原始常微分方程(ODE)在整个体积上（从 $0$ 到 $H$）积分得到，这代表了整个节点的中子平衡。\n$$\n-D \\int_0^H \\frac{d^2\\phi}{dx^2} dx + \\Sigma_a \\int_0^H \\phi(x) dx = \\int_0^H S_0 dx + \\int_0^H L_2 (x-H/2)^2 dx\n$$\n$$\n-D \\left[\\frac{d\\phi}{dx}\\right]_0^H + \\Sigma_a H \\overline{\\phi} = S_0 H + L_2 \\left[\\frac{(x-H/2)^3}{3}\\right]_0^H\n$$\n使用边界条件 $\\frac{d\\phi}{dx}(0)=\\frac{d\\phi}{dx}(H)=0$：\n$$\n0 + \\Sigma_a H \\overline{\\phi} = S_0 H + \\frac{L_2 H^3}{12} \\implies \\overline{\\phi} = \\frac{S_0}{\\Sigma_a} + \\frac{L_2 H^2}{12\\Sigma_a}\n$$\n这证实了我们推导的表达式。现在，我们代入给定的数值：$D=1.2\\,\\mathrm{cm}$，$\\Sigma_{a}=0.08\\,\\mathrm{cm}^{-1}$，$H=40\\,\\mathrm{cm}$，$S_{0}=5.0\\times 10^{5}\\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$，以及 $L_{2}=8.0\\times 10^{2}\\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-5}\\,\\mathrm{s}^{-1}$。\n$$\n\\overline{\\phi} = \\frac{5.0 \\times 10^5}{0.08} + \\frac{(8.0 \\times 10^2) \\times (40)^2}{12 \\times 0.08}\n$$\n计算每一项：\n第一项：$\\frac{S_0}{\\Sigma_a} = \\frac{5.0 \\times 10^5}{0.08} = 6.25 \\times 10^6 \\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$。\n第二项：$\\frac{L_2 H^2}{12 \\Sigma_a} = \\frac{(8.0 \\times 10^2) \\times 1600}{0.96} = \\frac{1.28 \\times 10^6}{0.96} = 1.3333... \\times 10^6 \\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$。\n各项求和：\n$$\n\\overline{\\phi} = (6.25 \\times 10^6) + (1.3333... \\times 10^6) = 7.5833... \\times 10^6 \\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\n\\overline{\\phi} \\approx 7.583 \\times 10^6 \\,\\mathrm{neutrons}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}\n$$",
            "answer": "$$\n\\boxed{7.583 \\times 10^{6}}\n$$"
        },
        {
            "introduction": "在解析解框架的基础上，本练习探讨了节块程序实际应用中的一个关键问题：数值稳定性。你将推导当中子吸收截面趋于零时通量解的极限形式，从而揭示基于双曲函数的求解器中数值不稳定性的根源。此练习强调了在低移除率区域使用多项式近似以确保计算的稳健性和准确性的重要性。",
            "id": "4258648",
            "problem": "考虑一个核反应堆堆芯中的均匀矩形节块，该节块在稳态、单群中子扩散近似下进行建模。其控制方程由菲克定律和粒子平衡导出：中子流为 $-\\boldsymbol{D} \\nabla \\phi$，稳态平衡要求 $-\\nabla \\cdot (\\boldsymbol{D} \\nabla \\phi) + \\Sigma_{a} \\phi = q$，其中 $\\phi$ 是中子通量，$\\boldsymbol{D}$ 是扩散张量，$\\Sigma_{a}$ 是宏观吸收截面，$q$ 是群内净体积源（包括裂变源和外部源，减去包含在移出项中的任何显式移出散射项）。在诸如节块展开法 (NEM) 的节块方法中，通过对横向方向进行积分，并将横向泄漏在每个坐标方向上用低阶多项式近似，横向积分技术将三维方程简化为一系列一维平衡方程。在一个宽度为 $h$ 的节块内，沿 $x$ 方向，横向积分后的一维平衡方程可写为：\n$$\nD \\frac{d^{2} \\phi(x)}{dx^{2}} - \\Sigma_{a} \\phi(x) = - q - \\mathcal{L}(x),\n$$\n其中 $D$ 是 $x$ 方向的扩散系数（假设各向同性，因此 $D$ 是一个标量），$q$ 是通过对横向方向积分得到的节块平均源，而 $\\mathcal{L}(x)$ 表示从 $y$ 和 $z$ 方向积分得到的横向泄漏，在节块内部用一个二阶偶次多项式近似：\n$$\n\\mathcal{L}(x) = \\ell_{0} + \\ell_{2} x^{2}.\n$$\n假设在节块表面处为吸收边界条件，\n$$\n\\phi\\!\\left(-\\frac{h}{2}\\right) = 0, \\qquad \\phi\\!\\left(\\frac{h}{2}\\right) = 0,\n$$\n这与节块法发展中用于解析验证的局部狄利克雷封闭相一致。\n\n从上述基本平衡和近似框架出发，推导当吸收截面趋于零（$\\Sigma_{a} \\to 0$）时解 $\\phi(x)$ 的极限解析形式，同时保持 $D$、$q$、$\\ell_{0}$、$\\ell_{2}$ 和 $h$ 为固定有限值。你的推导必须从所给的物理定律和定义开始，并逻辑地推导出极限解，不得使用任何快捷公式。此外，简要解释这种极限形式对于采用横向积分的节块法在低移出区域的数值稳定性的影响。\n\n以 $x$、$D$、$q$、$\\ell_{0}$、$\\ell_{2}$ 和 $h$ 的函数形式，给出极限通量形状 $\\phi_{\\text{lim}}(x)$ 的最终闭合解析表达式。无需进行数值计算。",
            "solution": "### 解的推导\n\n该问题的起点是所给定的均匀节块内通量 $\\phi(x)$ 的一维横向积分中子平衡方程：\n$$D \\frac{d^{2} \\phi(x)}{dx^{2}} - \\Sigma_{a} \\phi(x) = - q - \\mathcal{L}(x)$$\n将给定的横向泄漏形式 $\\mathcal{L}(x) = \\ell_{0} + \\ell_{2} x^{2}$ 代入，我们得到完整的常微分方程：\n$$D \\frac{d^{2} \\phi(x)}{dx^{2}} - \\Sigma_{a} \\phi(x) = - (q + \\ell_{0}) - \\ell_{2} x^{2}$$\n我们被要求求解当 $\\Sigma_{a} \\to 0$ 时解 $\\phi(x)$ 的极限形式。让我们将此极限解表示为 $\\phi_{\\text{lim}}(x)$。\n\n求解微分方程解的极限过程可能很复杂。然而，在这种情况下，最高阶导数 $D \\frac{d^{2} \\phi}{dx^{2}}$ 的系数是 $D$，它是一个常数并且不依赖于参数 $\\Sigma_a$。这表明该问题是一个正则摄动问题，而不是一个奇异问题。对于此类问题，解的极限就是极限方程的解。因此，我们可以合理地在求解之前，直接在微分方程中取极限 $\\Sigma_{a} \\to 0$。\n\n当 $\\Sigma_{a} \\to 0$ 时，只要 $\\phi(x)$ 保持有限（我们从物理角度可以预料到这一点），项 $\\Sigma_{a} \\phi(x)$ 就会消失。控制性常微分方程简化为：\n$$D \\frac{d^{2} \\phi_{\\text{lim}}(x)}{dx^{2}} = - (q + \\ell_{0}) - \\ell_{2} x^{2}$$\n这是一个关于 $\\phi_{\\text{lim}}(x)$ 的简单的二阶常微分方程。我们可以通过直接积分来求解。首先，重新排列方程：\n$$\\frac{d^{2} \\phi_{\\text{lim}}}{dx^{2}} = -\\frac{1}{D} (q + \\ell_{0} + \\ell_{2} x^{2})$$\n对 $x$ 积分一次，得到通量梯度：\n$$\\frac{d \\phi_{\\text{lim}}}{dx} = -\\frac{1}{D} \\left( (q + \\ell_{0})x + \\frac{\\ell_{2}}{3} x^{3} \\right) + C_{1}$$\n其中 $C_1$ 是第一个积分常数。再次积分得到极限通量的通解形式：\n$$\\phi_{\\text{lim}}(x) = -\\frac{1}{D} \\left( \\frac{q + \\ell_{0}}{2} x^{2} + \\frac{\\ell_{2}}{12} x^{4} \\right) + C_{1} x + C_{2}$$\n其中 $C_2$ 是第二个积分常数。\n\n常数 $C_1$ 和 $C_2$ 通过应用边界条件 $\\phi(-\\frac{h}{2}) = 0$ 和 $\\phi(\\frac{h}{2}) = 0$ 来确定。\n该问题表现出对称性：定义域关于 $x=0$ 对称，边界条件对称，源项 $-(q + \\ell_{0} + \\ell_{2} x^{2})$ 是 $x$ 的偶函数。因此，解 $\\phi_{\\text{lim}}(x)$ 必须是一个偶函数。为了使 $\\phi_{\\text{lim}}(x)$ 为偶函数，奇次项 $x$ 的系数必须为零。因此，$C_{1} = 0$。\n\n解简化为：\n$$\\phi_{\\text{lim}}(x) = -\\frac{1}{D} \\left( \\frac{q + \\ell_{0}}{2} x^{2} + \\frac{\\ell_{2}}{12} x^{4} \\right) + C_{2}$$\n现在，我们应用剩下的边界条件 $\\phi_{\\text{lim}}(\\frac{h}{2}) = 0$：\n$$0 = -\\frac{1}{D} \\left( \\frac{q + \\ell_{0}}{2} \\left(\\frac{h}{2}\\right)^{2} + \\frac{\\ell_{2}}{12} \\left(\\frac{h}{2}\\right)^{4} \\right) + C_{2}$$\n解出 $C_2$：\n$$C_{2} = \\frac{1}{D} \\left( \\frac{(q + \\ell_{0})h^{2}}{8} + \\frac{\\ell_{2}h^{4}}{192} \\right)$$\n将 $C_2$ 的表达式代回 $\\phi_{\\text{lim}}(x)$ 的解中：\n$$\\phi_{\\text{lim}}(x) = \\frac{1}{D} \\left( \\frac{(q + \\ell_{0})h^{2}}{8} + \\frac{\\ell_{2}h^{4}}{192} \\right) - \\frac{1}{D} \\left( \\frac{q + \\ell_{0}}{2} x^{2} + \\frac{\\ell_{2}}{12} x^{4} \\right)$$\n为了得到一个更有启发性的形式，我们可以将具有公因子的项分组：\n$$\\phi_{\\text{lim}}(x) = \\frac{q + \\ell_{0}}{D} \\left( \\frac{h^{2}}{8} - \\frac{x^{2}}{2} \\right) + \\frac{\\ell_{2}}{D} \\left( \\frac{h^{4}}{192} - \\frac{x^{4}}{12} \\right)$$\n提出公分母得到：\n$$\\phi_{\\text{lim}}(x) = \\frac{q + \\ell_{0}}{2D} \\left( \\frac{h^{2}}{4} - x^{2} \\right) + \\frac{\\ell_{2}}{12D} \\left( \\frac{h^{4}}{16} - x^{4} \\right)$$\n项 $(\\frac{h^{4}}{16} - x^{4})$ 可以被因式分解为平方差：$(\\frac{h^{2}}{4} - x^{2})(\\frac{h^{2}}{4} + x^{2})$。这使得我们可以从整个表达式中提出公因子 $(\\frac{h^{2}}{4} - x^{2})$：\n$$\\phi_{\\text{lim}}(x) = \\left(\\frac{h^{2}}{4} - x^{2}\\right) \\left[ \\frac{q + \\ell_{0}}{2D} + \\frac{\\ell_{2}}{12D} \\left(\\frac{h^{2}}{4} + x^{2}\\right) \\right]$$\n稍作整理，得到最终的闭合解析形式：\n$$\\phi_{\\text{lim}}(x) = \\frac{1}{D}\\left(\\frac{h^{2}}{4} - x^{2}\\right) \\left[ \\frac{q + \\ell_{0}}{2} + \\frac{\\ell_{2}}{12} \\left(\\frac{h^{2}}{4} + x^{2}\\right) \\right]$$\n\n### 对数值稳定性的影响\n\n原始方程（对于 $\\Sigma_a > 0$）的通解涉及双曲函数 $\\cosh(Bx)$ 和 $\\sinh(Bx)$，其中 $B = \\sqrt{\\Sigma_a/D}$。完整解是这些双曲函数和一个包含 $B^2$ 和 $B^4$ 逆幂的特解的组合。当 $\\Sigma_a \\to 0$ 时，$B$ 也趋近于 $0$。\n\n在数值实现中，当 $B$ 非常小时，计算基于双曲解的表达式会导致严重的数值不稳定性。这源于两个方面：\n1.  **灾难性抵消**：像 $1 - \\cosh(Bx)$ 或 $\\cosh(Bx) - \\cosh(By)$ 这样的表达式涉及两个非常接近于 $1$ 的数字相减，导致相对精度的严重损失。\n2.  **除以零**：特解包含与 $1/B^2$ 和 $1/B^4$ 成比例的项，这些项在 $B \\to 0$ 时会发散。虽然完整的解析表达式将这些发散项组合起来，从而得到一个有限的极限，但它们的直接数值计算涉及相减两个非常大且几乎相等的数，这同样会导致灾难性抵消和不准确的结果。\n\n推导出的极限解 $\\phi_{\\text{lim}}(x)$ 是一个简单的四次多项式。这种形式在数值上是鲁棒的，计算起来非常简单。因此，当参数 $Bh$ 很小时，实际的节块程序不使用基于双曲函数的解。取而代之的是，它们实现一个切换机制：如果 $Bh$ 低于某个阈值，程序将使用双曲解的截断泰勒级数展开。我们推导出的极限通量 $\\phi_{\\text{lim}}(x)$ 正是这个展开中的主阶近似。这种策略避免了在低吸收（低移出）区域与双曲形式相关的数值不稳定性，从而确保在所有物理区间内进行准确而稳定的计算。",
            "answer": "$$\\boxed{\\frac{1}{D}\\left(\\frac{h^{2}}{4} - x^{2}\\right) \\left[ \\frac{q + \\ell_{0}}{2} + \\frac{\\ell_{2}}{12} \\left(\\frac{h^{2}}{4} + x^{2}\\right) \\right]}$$"
        },
        {
            "introduction": "最后的这个练习将从解析推导过渡到计算实现，让你能够直接评估不同横向泄漏模型所带来的影响。通过编写程序比较平坦泄漏与二次泄漏近似在一个反应堆特征值问题中的准确性，你将量化模型保真度对关键全局参数 $k$ 的影响。这个编程练习展示了在开发节块方法时所做理论选择的实际效果。",
            "id": "4258589",
            "problem": "要求您实现并比较用于均匀矩形反应堆中单群稳态中子扩散特征值问题的两种横向积分节块公式，重点关注将横向泄漏近似为平坦与二次形式对每个节点的影响。目标是在对称条件的双节点测试中，量化这些近似如何影响节点特征值的准确性。\n\n基本理论基础是二维空间中的单群稳态中子扩散方程，针对中子标量通量 $\\phi(x,y)$ 编写：\n$$\n- \\nabla \\cdot \\left( D \\nabla \\phi(x,y) \\right) + \\Sigma_a \\, \\phi(x,y) = \\frac{\\nu \\Sigma_f}{k} \\, \\phi(x,y),\n$$\n对于一个均匀介质，其扩散系数为 $D$，宏观截面为 $\\Sigma_a$（吸收）和 $\\nu \\Sigma_f$（产生），特征值为 $k$（增殖因子）。求解区域是一个矩形，其在 $x$ 方向的宽度为 $L_x$，在 $y$ 方向的宽度为 $L_y$，边界条件为真空边界条件，即在 $x=0$、$x=L_x$、$y=0$ 和 $y=L_y$ 处 $\\phi=0$。\n\n在节块法中的横向积分技术（TIT）下，通过对 $y$ 方向进行积分，并将横向泄漏 $-D \\frac{\\partial^2 \\phi}{\\partial y^2}$ 建模为源项，可将二维方程简化为关于横向平均通量 $\\varphi(x)$ 的一维方程。对于均匀条件，分离变量解意味着一个特征横向曲率，其曲率值为 $B_y^2 = \\left( \\frac{\\pi}{L_y} \\right)^2$，从而产生一个加到吸收项上的有效移出项 $D B_y^2$。\n\n对于均匀矩形，精确的基波模特征值为\n$$\nk_{\\mathrm{ref}} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D \\left( \\left( \\frac{\\pi}{L_x} \\right)^2 + \\left( \\frac{\\pi}{L_y} \\right)^2 \\right)}。\n$$\n\n在节块法中，我们将 $x$ 域划分为节点，并在每个节点中求解横向积分后的一维方程，通过界面流进行耦合。在本问题中，您将使用两个等宽的节点（$N_x = 2$），并强制执行对称条件（相同的材料属性和节点尺寸），并使用两种横向泄漏近似：\n- 平坦泄漏近似：横向泄漏在每个节点内表示为恒定的移出项 $D B_y^2$，结合双节点有限体积离散（每个节点内采用分片常数基）。离散算子由节点体积平衡、使用两点通量的界面流以及有效移出项 $\\Sigma_a + D B_y^2$ 组装而成。\n- 二次泄漏近似：横向泄漏在每个节点内通过二阶多项式（二次）基函数进行一致性表示，使用标准的x方向二次有限元离散。刚度项包括扩散项和有效移出项 $(\\Sigma_a + D B_y^2)$ 与二次形函数进行积分。\n\n对于每种近似，组装广义特征值问题\n$$\n\\mathbf{K} \\, \\mathbf{c} = \\mu \\, \\mathbf{F} \\, \\mathbf{c}, \\quad \\text{其中} \\quad k = \\frac{1}{\\mu},\n$$\n其中 $\\mathbf{K}$ 是扩散加移出项的离散算子，$\\mathbf{F}$ 是裂变产生（质量）矩阵。使用最小正广义特征值 $\\mu_{\\min}$ 计算基波特征值 $k$，即 $k = 1 / \\mu_{\\min}$。\n\n实现以下测试套件，每个都是在 $x$ 方向具有对称双节点划分的均匀反应堆：\n- 测试案例1（理想情况）：$D = 1$（单位 $\\mathrm{cm}$），$\\Sigma_a = 0.1$（单位 $\\mathrm{cm}^{-1}$），$\\nu \\Sigma_f = 0.2$（单位 $\\mathrm{cm}^{-1}$），$L_x = 40$（单位 $\\mathrm{cm}$），$L_y = 40$（单位 $\\mathrm{cm}$）。\n- 测试案例2（强横向泄漏）：$D = 1$（单位 $\\mathrm{cm}$），$\\Sigma_a = 0.1$（单位 $\\mathrm{cm}^{-1}$），$\\nu \\Sigma_f = 0.2$（单位 $\\mathrm{cm}^{-1}$），$L_x = 40$（单位 $\\mathrm{cm}$），$L_y = 20$（单位 $\\mathrm{cm}$）。\n- 测试案例3（弱轴向泄漏）：$D = 1$（单位 $\\mathrm{cm}$），$\\Sigma_a = 0.1$（单位 $\\mathrm{cm}^{-1}$），$\\nu \\Sigma_f = 0.2$（单位 $\\mathrm{cm}^{-1}$），$L_x = 80$（单位 $\\mathrm{cm}$），$L_y = 40$（单位 $\\mathrm{cm}$）。\n\n对于每个测试案例：\n- 使用上述公式计算精确的参考特征值 $k_{\\mathrm{ref}}$。\n- 使用带有平坦泄漏近似和真空边界的双节点有限体积离散计算 $k_{\\mathrm{flat}}$。\n- 使用带有狄利克雷边界的双节点二次有限元离散计算 $k_{\\mathrm{quad}}$。\n- 以无量纲浮点数的形式报告绝对误差 $|k_{\\mathrm{flat}} - k_{\\mathrm{ref}}|$ 和 $|k_{\\mathrm{quad}} - k_{\\mathrm{ref}}|$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表。该列表必须按以下顺序包含6个浮点数：$[|k_{\\mathrm{flat}}^{(1)} - k_{\\mathrm{ref}}^{(1)}|, |k_{\\mathrm{quad}}^{(1)} - k_{\\mathrm{ref}}^{(1)}|, |k_{\\mathrm{flat}}^{(2)} - k_{\\mathrm{ref}}^{(2)}|, |k_{\\mathrm{quad}}^{(2)} - k_{\\mathrm{ref}}^{(2)}|, |k_{\\mathrm{flat}}^{(3)} - k_{\\mathrm{ref}}^{(3)}|, |k_{\\mathrm{quad}}^{(3)} - k_{\\mathrm{ref}}^{(3)}|]$，其中上标表示测试案例的索引。\n\n不需要用户输入。所有量必须按所述计算。所有物理量均采用上述指定的单位处理，所有输出均为无量纲浮点数。不使用角度。不使用百分比。",
            "solution": "该问题经评估为有效。它基于中子扩散理论和偏微分方程数值解法的原理，具有科学依据。该问题是适定的，所有必要的参数、方程和边界条件都已明确提供。语言客观，任务定义清晰。\n\n求解过程首先建立理论框架，然后推导两种指定近似方法的离散公式，最后将这些公式应用于给定的测试案例。\n\n### 理论框架\n\n起点是在一个尺寸为 $L_x \\times L_y$ 的二维均匀矩形域中的单群稳态中子扩散方程：\n$$\n- \\nabla \\cdot \\left( D \\nabla \\phi(x,y) \\right) + \\Sigma_a \\, \\phi(x,y) = \\frac{1}{k} \\nu \\Sigma_f \\, \\phi(x,y)\n$$\n这里，$\\phi(x,y)$ 是中子标量通量，$D$ 是扩散系数，$\\Sigma_a$ 是宏观吸收截面，$\\nu \\Sigma_f$ 是宏观产生截面，$k$ 是增殖因子特征值。问题指定了真空边界条件，这被建模为零通量条件：在区域边界上 $\\phi(x,y)=0$。\n\n横向积分方法降低了问题的维度。我们对方程在 $y$ 方向上从 $y=0$ 到 $y=L_y$ 进行积分，定义一个横向平均通量 $\\varphi(x) = \\int_0^{L_y} \\phi(x,y) \\, dy$。方程变为：\n$$\n-D \\frac{d^2 \\varphi(x)}{dx^2} + \\Sigma_a \\varphi(x) - D \\int_0^{L_y} \\frac{\\partial^2 \\phi(x,y)}{\\partial y^2} \\, dy = \\frac{\\nu \\Sigma_f}{k} \\varphi(x)\n$$\n积分项表示 $y$ 方向的横向泄漏。对于具有零通量边界的均匀介质，通量可以通过分离变量法近似为 $\\phi(x,y) \\approx \\varphi(x) \\sin(B_y y)$，其中 $B_y = \\pi/L_y$。这意味着 $\\frac{\\partial^2 \\phi}{\\partial y^2} \\approx -B_y^2 \\phi(x,y)$。代入这个近似，横向泄漏项变为 $D B_y^2 \\varphi(x)$。这充当了一个额外的移出机制。\n\n对于在域 $x \\in [0, L_x]$ 上的 $\\varphi(x)$，得到的一维方程为：\n$$\n-D \\frac{d^2 \\varphi(x)}{dx^2} + (\\Sigma_a + D B_y^2) \\varphi(x) = \\frac{\\nu \\Sigma_f}{k} \\varphi(x)\n$$\n边界条件为 $\\varphi(0)=0$ 和 $\\varphi(L_x)=0$。我们定义一个有效移出截面 $\\Sigma_R' = \\Sigma_a + D B_y^2$。那么一维特征值问题是：\n$$\n-D \\frac{d^2 \\varphi(x)}{dx^2} + \\Sigma_R' \\varphi(x) = \\frac{\\nu \\Sigma_f}{k} \\varphi(x)\n$$\n\n### 参考特征值计算\n\n原始二维问题的精确解析解给出了基波模特征值：\n$$\nk_{\\mathrm{ref}} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D (B_x^2 + B_y^2)} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D \\left( \\left( \\frac{\\pi}{L_x} \\right)^2 + \\left( \\frac{\\pi}{L_y} \\right)^2 \\right)}\n$$\n该值作为参考，用于与数值近似结果进行比较。\n\n### 平坦泄漏近似（有限体积法）\n\n该方法采用双节点有限体积离散。域 $[0, L_x]$ 被划分为两个等宽 $h = L_x/2$ 的节点：节点1在 $[0, h]$ 上，节点2在 $[h, L_x]$ 上。未知数是单元平均通量 $\\varphi_1$ 和 $\\varphi_2$。\n\n对一维方程在节点1（$[0, h]$）上积分得到：\n$$\n\\left(-D \\frac{d\\varphi}{dx}\\right)\\Big|_h - \\left(-D \\frac{d\\varphi}{dx}\\right)\\Big|_0 + \\Sigma_R' \\varphi_1 h = \\frac{\\nu \\Sigma_f}{k} \\varphi_1 h\n$$\n流 $J(x) = -D \\frac{d\\varphi}{dx}$ 使用有限差分进行近似：\n- 在 $x=h$ 处的界面流：$J(h) \\approx -D\\frac{\\varphi_2 - \\varphi_1}{h}$\n- 在 $x=0$ 处的边界流：零通量边界条件 $\\varphi(0)=0$ 意味着 $J(0) \\approx -D\\frac{\\varphi_1 - 0}{h/2} = -\\frac{2D}{h}\\varphi_1$。\n\n将这些代入节点1的平衡方程给出：\n$$\n-D\\frac{\\varphi_2 - \\varphi_1}{h} - \\left(-\\frac{2D}{h}\\varphi_1\\right) + \\Sigma_R' \\varphi_1 h = \\frac{\\nu \\Sigma_f h}{k}\\varphi_1 \\implies \\left(\\frac{3D}{h} + \\Sigma_R' h\\right)\\varphi_1 - \\frac{D}{h}\\varphi_2 = \\frac{\\nu \\Sigma_f h}{k}\\varphi_1\n$$\n根据对称性，节点2的平衡方程为：\n$$\n-\\frac{D}{h}\\varphi_1 + \\left(\\frac{3D}{h} + \\Sigma_R' h\\right)\\varphi_2 = \\frac{\\nu \\Sigma_f h}{k}\\varphi_2\n$$\n这构成了一个广义特征值问题 $\\mathbf{K}\\boldsymbol{\\varphi} = \\mu \\mathbf{F} \\boldsymbol{\\varphi}$，其中 $\\mu = 1/k$：\n$$\n\\begin{pmatrix} \\frac{3D}{h} + \\Sigma_R' h  -\\frac{D}{h} \\\\ -\\frac{D}{h}  \\frac{3D}{h} + \\Sigma_R' h \\end{pmatrix} \\begin{pmatrix} \\varphi_1 \\\\ \\varphi_2 \\end{pmatrix} = \\mu \\begin{pmatrix} \\nu\\Sigma_f h  0 \\\\ 0  \\nu\\Sigma_f h \\end{pmatrix} \\begin{pmatrix} \\varphi_1 \\\\ \\varphi_2 \\end{pmatrix}\n$$\n基波模对应于对称特征向量 $[\\varphi_1, \\varphi_2]^T = [1, 1]^T$。将其代入第一行得到：\n$$\n\\left(\\frac{3D}{h} + \\Sigma_R' h\\right) - \\frac{D}{h} = \\mu_{\\min} (\\nu\\Sigma_f h) \\implies \\frac{2D}{h} + \\Sigma_R' h = \\mu_{\\min} \\nu\\Sigma_f h\n$$\n解出 $\\mu_{\\min}$，然后得到 $k_{\\mathrm{flat}} = 1/\\mu_{\\min}$：\n$$\nk_{\\mathrm{flat}} = \\frac{\\nu \\Sigma_f h}{\\frac{2D}{h} + \\Sigma_R' h} = \\frac{\\nu \\Sigma_f h^2}{2D + \\Sigma_R' h^2}\n$$\n\n### 二次泄漏近似（有限元法）\n\n此方法在两个单元上使用标准的二次有限元法（FEM）。域 $[0, L_x]$ 被划分为两个长度为 $h=L_x/2$ 的单元。节点位于 $x=0, h/2, h, 3h/2, L_x$。由于边界条件 $\\varphi(0)=\\varphi(L_x)=0$，存在三个未知的自由度 $c_1, c_2, c_3$，分别对应于 $x=h/2$、$x=h$ 和 $x=3h/2$ 处的通量值。\n\n该一维方程的伽辽金弱形式为：\n$$\n\\int_0^{L_x} \\left( D \\frac{d\\varphi}{dx}\\frac{dv}{dx} + \\Sigma_R' \\varphi v \\right) dx = \\mu \\int_0^{L_x} (\\nu\\Sigma_f) \\varphi v \\, dx\n$$\n用二次基函数进行离散化，得到矩阵系统 $\\mathbf{K}\\mathbf{c} = \\mu \\mathbf{F}\\mathbf{c}$。刚度矩阵 $\\mathbf{K}$ 和裂变矩阵 $\\mathbf{F}$ 由单元贡献组装而成。对于长度为 $h_e$ 的二次单元，其单元刚度矩阵 $\\mathbf{K}^e$ 和质量矩阵 $\\mathbf{M}^e$ 由下式给出：\n$$\n\\mathbf{K}^e = D \\mathbf{S}^e + \\Sigma_R' \\mathbf{M}^e\n$$\n其中\n$$\n\\mathbf{S}^e = \\frac{1}{3h_e} \\begin{pmatrix} 7  -8  1 \\\\ -8  16  -8 \\\\ 1  -8  7 \\end{pmatrix}, \\quad \\mathbf{M}^e = \\frac{h_e}{30} \\begin{pmatrix} 4  2  -1 \\\\ 2  16  2 \\\\ -1  2  4 \\end{pmatrix}\n$$\n这些矩阵对应于单元的左、中、右三个局部节点。我们为三个内部自由度组装3x3的全局矩阵。单元长度为 $h_e = h = L_x/2$。\n- 自由度1（节点在 $x=h/2$）：单元1的中间节点。\n- 自由度2（节点在 $x=h$）：单元1的右节点和单元2的左节点。\n- 自由度3（节点在 $x=3h/2$）：单元2的中间节点。\n\n组装后的全局矩阵 $\\mathbf{K}$ 和 $\\mathbf{M}$ 为：\n$$\n\\mathbf{K} = \\begin{pmatrix} K^e_{11}  K^e_{12}  0 \\\\ K^e_{21}  K^e_{22}+K^e_{00}  K^e_{01} \\\\ 0  K^e_{10}  K^e_{11} \\end{pmatrix}, \\quad\n\\mathbf{M} = \\begin{pmatrix} M^e_{11}  M^e_{12}  0 \\\\ M^e_{21}  M^e_{22}+M^e_{00}  M^e_{01} \\\\ 0  M^e_{10}  M^e_{11} \\end{pmatrix}\n$$\n其中索引 $0,1,2$ 指的是单元的左、中、右节点。全局裂变矩阵为 $\\mathbf{F} = \\nu\\Sigma_f \\mathbf{M}$。\n\n求解广义特征值问题 $\\mathbf{K}\\mathbf{c} = \\mu \\mathbf{F}\\mathbf{c}$ 以得到其特征值 $\\mu$。最小的正特征值 $\\mu_{\\min}$ 对应于基波模。估计的增殖因子则为 $k_{\\mathrm{quad}} = 1/\\mu_{\\min}$。\n\n绝对误差计算为 $|k_{\\mathrm{flat}} - k_{\\mathrm{ref}}|$ 和 $|k_{\\mathrm{quad}} - k_{\\mathrm{ref}}|$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Implements and compares two transverse integration nodal formulations\n    for the one-group steady-state neutron diffusion eigenvalue problem.\n    \"\"\"\n    \n    test_cases = [\n        # (D, Sigma_a, nu*Sigma_f, L_x, L_y)\n        (1.0, 0.1, 0.2, 40.0, 40.0),  # Test Case 1\n        (1.0, 0.1, 0.2, 40.0, 20.0),  # Test Case 2\n        (1.0, 0.1, 0.2, 80.0, 40.0),  # Test Case 3\n    ]\n\n    results = []\n    \n    for D, Sigma_a, nu_Sigma_f, L_x, L_y in test_cases:\n        # --- Common Parameters ---\n        pi_val = np.pi\n        h = L_x / 2.0  # Node/element width\n\n        # Geometric bucklings\n        B_x_sq = (pi_val / L_x)**2\n        B_y_sq = (pi_val / L_y)**2\n        \n        # --- Reference Eigenvalue ---\n        k_ref = nu_Sigma_f / (Sigma_a + D * (B_x_sq + B_y_sq))\n\n        # --- Transverse-Integrated Problem Parameters ---\n        # Effective removal cross section including transverse leakage\n        Sigma_r_eff = Sigma_a + D * B_y_sq\n\n        # --- Method 1: Flat Leakage (Finite Volume) ---\n        # Derived from the fundamental mode of the 2x2 system\n        mu_flat = (2.0 * D + Sigma_r_eff * h**2) / (nu_Sigma_f * h**2)\n        k_flat = 1.0 / mu_flat\n        \n        # --- Method 2: Quadratic Leakage (Finite Element) ---\n        # Element matrices for a generic quadratic element of length he=h\n        # Element mass matrix M^e\n        Me = (h / 30.0) * np.array([\n            [4.0, 2.0, -1.0],\n            [2.0, 16.0, 2.0],\n            [-1.0, 2.0, 4.0]\n        ])\n        \n        # Element diffusion stiffness matrix S^e\n        Se = (1.0 / (3.0 * h)) * np.array([\n            [7.0, -8.0, 1.0],\n            [-8.0, 16.0, -8.0],\n            [1.0, -8.0, 7.0]\n        ])\n\n        # Full element stiffness matrix K^e = D*S^e + Sigma_r_eff*M^e\n        Ke = D * Se + Sigma_r_eff * Me\n        \n        # Assemble global 3x3 matrices for the 3 internal DOFs\n        K_global = np.zeros((3, 3))\n        M_global = np.zeros((3, 3))\n\n        # DOF mapping: [h/2, h, 3h/2]\n        # DOF 1 (mid of elem 1)\n        # DOF 2 (interface)\n        # DOF 3 (mid of elem 2)\n        \n        # Assemble K_global\n        K_global[0, 0] = Ke[1, 1]              # mid-mid of elem 1\n        K_global[0, 1] = Ke[1, 2]              # mid-right of elem 1\n        K_global[1, 0] = Ke[2, 1]              # right-mid of elem 1\n        K_global[1, 1] = Ke[2, 2] + Ke[0, 0]   # right-right of elem 1 + left-left of elem 2\n        K_global[1, 2] = Ke[0, 1]              # left-mid of elem 2\n        K_global[2, 1] = Ke[1, 0]              # mid-left of elem 2\n        K_global[2, 2] = Ke[1, 1]              # mid-mid of elem 2\n        \n        # Assemble M_global\n        M_global[0, 0] = Me[1, 1]\n        M_global[0, 1] = Me[1, 2]\n        M_global[1, 0] = Me[2, 1]\n        M_global[1, 1] = Me[2, 2] + Me[0, 0]\n        M_global[1, 2] = Me[0, 1]\n        M_global[2, 1] = Me[1, 0]\n        M_global[2, 2] = Me[1, 1]\n        \n        # Global fission matrix F = nu*Sigma_f * M\n        F_global = nu_Sigma_f * M_global\n        \n        # Solve the generalized eigenvalue problem: K*c = mu*F*c\n        # eigh is for symmetric/hermitian matrices and returns sorted eigenvalues.\n        mu_eigenvalues, _ = eigh(K_global, F_global)\n        \n        # The fundamental mode corresponds to the smallest eigenvalue mu\n        mu_quad = mu_eigenvalues[0]\n        k_quad = 1.0 / mu_quad\n        \n        # --- Calculate and store errors ---\n        error_flat = abs(k_flat - k_ref)\n        error_quad = abs(k_quad - k_ref)\n        \n        results.append(error_flat)\n        results.append(error_quad)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}