{
    "hands_on_practices": [
        {
            "introduction": "中子输运方程中的各向同性散射源在离散纵标法中需要被精确地处理。这个练习将引导你通过对称性论证，从第一性原理出发，验证一个设计良好的水平对称(Level-Symmetric)求积组如何能够精确地保持各向同性的二阶角动差张量。理解这一基本性质是设计和评估任何角向求积组的第一步。",
            "id": "4248060",
            "problem": "在用于核反应堆模拟的三维中子输运中，离散纵标法在单位球面上选择一组有限的方向，并赋予相关的非负权重，以近似角度积分。为使角度求积能够正确传递各向同性散射，方向余弦的离散二阶矩张量必须重现连续的各向同性二阶矩。考虑一个候选的八阶能级对称求积组 (LS$_8$)，该求积组在每个卦限由十个按对称类型分组的方向构成，在每种对称类型内部以及所有卦限之间，权重均相同：\n\n- A类（每卦限一个）：方向余弦相等的方向 $\\left(p,p,p\\right)$，其中 $p>0$ 且 $3p^{2}=1$。\n\n- B类（每卦限三个）：$\\left(u,u,v\\right)$ 的三个排列，其中 $u>0$，$v>0$ 且 $2u^{2}+v^{2}=1$。为确定起见，取 $u=\\sqrt{\\frac{1}{5}}$ 和 $v=\\sqrt{\\frac{3}{5}}$。\n\n- C类（每卦限六个）：$\\left(a,b,c\\right)$ 的六个排列，其中 $a>0$，$b>0$，$c>0$ 且 $a^{2}+b^{2}+c^{2}=1$。为确定起见，取 $a=\\sqrt{\\frac{1}{10}}$，$b=\\sqrt{\\frac{3}{10}}$ 和 $c=\\sqrt{\\frac{6}{10}}$。\n\n设A类、B类和C类每个方向的非负权重分别为 $w_{A}$、$w_{B}$ 和 $w_{C}$。全球面权重归一化要求满足\n$$\n\\sum_{i} w_{i} \\;=\\; 8\\left(w_{A}+3w_{B}+6w_{C}\\right)\\;=\\;4\\pi,\n$$\n其中因子 $8$ 代表八个卦限。\n\n将离散二阶矩张量定义为\n$$\n\\mathbf{T} \\;=\\; \\sum_{i} w_{i}\\,\\vec{\\Omega}_{i}\\,\\vec{\\Omega}_{i},\n$$\n其中 $\\vec{\\Omega}_{i}$ 是第 $i$ 个求积方向的单位方向矢量，$\\vec{\\Omega}_{i}\\,\\vec{\\Omega}_{i}$ 表示并矢（外）积。仅使用上述约束条件和对称性论证，计算 $\\mathbf{T}$ 并评估各向同性误差张量\n$$\n\\Delta \\;=\\; \\mathbf{T} - \\frac{4\\pi}{3}\\,\\mathbf{I},\n$$\n其中 $\\mathbf{I}$ 是单位张量。将误差的弗罗贝尼乌斯范数，\n$$\n\\|\\Delta\\|_{F} \\;=\\; \\sqrt{\\mathrm{tr}\\!\\left(\\Delta^{\\mathsf{T}}\\Delta\\right)},\n$$\n报告为单个实数。最终答案无需四舍五入。",
            "solution": "用户提供了一个来自核反应堆模拟领域的问题，具体涉及离散纵标角度求积组的性质。任务是为一个给定的八阶能级对称 (LS$_8$) 求积组计算离散二阶矩张量 $\\mathbf{T}$，计算各向同性误差张量 $\\Delta$，并求其弗罗贝尼乌斯范数 $\\|\\Delta\\|_{F}$。\n\n### 步骤 1：问题验证\n\n首先，我将根据所需步骤验证问题陈述。\n\n#### 步骤 1.1：提取已知条件\n- **背景**：三维中子输运，离散纵标法，用于近似角度积分的角度求积组。\n- **各向同性散射条件**：离散二阶矩张量必须重现连续的各向同性二阶矩。\n- **求积组**：候选的八阶能级对称求积组 (LS$_8$)。该组由每个卦限的10种方向类型定义，通过反射创建包含 $8 \\times 10 = 80$ 个方向的全球面组。\n- **方向类型（第一卦限，余弦为正）**：\n    - **A类**：1个方向 $\\vec{\\Omega} = (p, p, p)$，其中 $3p^2=1$。\n    - **B类**：3个方向，是 $(u, u, v)$ 的排列，其中 $2u^2+v^2=1$。给定的具体值为：$u=\\sqrt{\\frac{1}{5}}$，$v=\\sqrt{\\frac{3}{5}}$。\n    - **C类**：6个方向，是 $(a, b, c)$ 的排列，其中 $a^2+b^2+c^2=1$。给定的具体值为：$a=\\sqrt{\\frac{1}{10}}$，$b=\\sqrt{\\frac{3}{10}}$，$c=\\sqrt{\\frac{6}{10}}$。\n- **权重**：A、B、C类中每个方向的非负权重分别关联为 $w_A$、$w_B$、$w_C$。相同类型和所有卦限中所有方向的权重都相同。\n- **权重归一化**：单位球面上所有权重之和为 $\\sum_{i} w_{i} = 8(w_{A}+3w_{B}+6w_{C}) = 4\\pi$。\n- **离散二阶矩张量**：$\\mathbf{T} = \\sum_{i} w_{i}\\,\\vec{\\Omega}_{i}\\,\\vec{\\Omega}_{i}$，其中 $\\vec{\\Omega}_{i}$ 是单位方向矢量，$\\vec{\\Omega}_{i}\\,\\vec{\\Omega}_{i}$ 是外积。\n- **各向同性误差张量**：$\\Delta = \\mathbf{T} - \\frac{4\\pi}{3}\\,\\mathbf{I}$。\n- **要求输出**：误差的弗罗贝尼乌斯范数 $\\|\\Delta\\|_{F} = \\sqrt{\\mathrm{tr}(\\Delta^{\\mathsf{T}}\\Delta)}$。\n- **约束条件**：计算必须“仅使用上述约束条件和对称性论证”。\n\n#### 步骤 1.2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于中子输运理论和反应堆物理中使用的数值方法的既定原理。能级对称求积组是标准工具。定义和概念在事实上是合理的。\n- **适定性**：问题提供了所有必要的定义。虽然单个权重 $w_A, w_B, w_C$ 并不能由单一的归一化方程确定，但问题要求使用对称性论证来计算 $\\mathbf{T}$。如下所示，问题的结构允许唯一地确定 $\\mathbf{T}$，并因此唯一确定 $\\|\\Delta\\|_F$，而无需知道单个权重的值。该问题是自洽的，并且存在唯一解。\n- **客观性**：该问题以精确、客观的数学和物理语言陈述。\n\n#### 步骤 1.3：结论与行动\n该问题有效。它具有科学合理性、适定性和客观性。所提供的数值数据虽然对于最终答案而言部分是冗余的，但是它们是一致的，并定义了一个具体的物理问题。我现在将着手解决该问题。\n\n### 步骤 2：求解\n\n目标是计算各向同性误差张量的弗罗贝尼乌斯范数 $\\|\\Delta\\|_{F}$。这需要首先计算离散二阶矩张量 $\\mathbf{T}$。\n\n离散二阶矩张量 $\\mathbf{T}$ 是一个 $3 \\times 3$ 矩阵，定义如下：\n$$\n\\mathbf{T} = \\sum_{i=1}^{N} w_{i} \\vec{\\Omega}_{i} \\vec{\\Omega}_{i}\n$$\n其中 $N=80$ 是总方向数。矢量 $\\vec{\\Omega}_{i} = (\\mu_{ix}, \\mu_{iy}, \\mu_{iz})$ 是第 $i$ 个方向的单位矢量。张量的分量由下式给出：\n$$\nT_{jk} = \\sum_{i=1}^{N} w_{i} \\mu_{ij} \\mu_{ik}\n$$\n对于 $j, k \\in \\{x, y, z\\}$。\n\n我们将根据问题规定，使用求积组的对称性质。\n\n#### $\\mathbf{T}$ 的非对角分量\n考虑一个非对角分量，例如 $T_{xy}$：\n$$\nT_{xy} = \\sum_{i=1}^{N} w_{i} \\mu_{ix} \\mu_{iy}\n$$\n全球面求积组的构造方法是：对于第一卦限中的任意方向 $(\\mu_x, \\mu_y, \\mu_z)$，都包含 $(\\pm \\mu_x, \\pm \\mu_y, \\pm \\mu_z)$ 形式的所有八个方向。根据构造，这八个对称方向的权重 $w_i$ 是相同的。\n我们考虑来自第一卦限的一个方向 $\\vec{\\Omega} = (\\mu_x, \\mu_y, \\mu_z)$ 及其关于 $yz$-平面的反射方向 $\\vec{\\Omega}' = (-\\mu_x, \\mu_y, \\mu_z)$ 对求和的贡献。它们具有相同的权重 $w$。它们对 $T_{xy}$ 的总贡献是：\n$$\nw (\\mu_x \\mu_y) + w (-\\mu_x \\mu_y) = 0\n$$\n由于整个 $N=80$ 个方向的集合可以被划分为这样的配对，它们的贡献在求和中相互抵消，因此总和为零。如果我们关于 $xz$-平面（其中 $\\mu_y \\to -\\mu_y$）或 $xy$-平面（其中 $\\mu_z \\to -\\mu_z$）进行反射，同样的论证也成立。因此，$\\mathbf{T}$ 的所有非对角分量都为零：\n$$\nT_{xy} = T_{yx} = 0, \\quad T_{xz} = T_{zx} = 0, \\quad T_{yz} = T_{zy} = 0\n$$\n这表明 $\\mathbf{T}$ 是一个对角矩阵。\n\n#### $\\mathbf{T}$ 的对角分量\n现在，我们来研究对角分量 $T_{xx}$、$T_{yy}$ 和 $T_{zz}$。\n$$\nT_{xx} = \\sum_{i=1}^{N} w_{i} \\mu_{ix}^{2}\n$$\n$$\nT_{yy} = \\sum_{i=1}^{N} w_{i} \\mu_{iy}^{2}\n$$\n$$\nT_{zz} = \\sum_{i=1}^{N} w_{i} \\mu_{iz}^{2}\n$$\n第一卦限的方向集由排列构成：一个 $(p,p,p)$ 类型的方向，三个 $(u,u,v)$ 类型的方向，以及六个 $(a,b,c)$ 类型的方向。这个包含10个方向的基础集在任意坐标轴置换下都是不变的。例如，如果 $(\\mu_x, \\mu_y, \\mu_z)$ 是某个类型的方向（例如C类），那么 $(\\mu_y, \\mu_x, \\mu_z)$ 也是同一类型的方向，因此具有相同的权重。第一卦限方向的这种置换对称性，加上用于生成完整集合的反射对称性，意味着这 $N=80$ 个方向的完整集合在坐标置换下是不变的。\n因此，交换 $x$ 和 $y$ 轴后，$T_{xx}$ 的求和必须变换为 $T_{yy}$ 的求和。由于矢量和权重的集合在此变换下是不变的，所以求和的值必须保持不变。因此，$T_{xx} = T_{yy}$。类似地，通过置换其他坐标轴，我们发现：\n$$\nT_{xx} = T_{yy} = T_{zz}\n$$\n我们称这个公共值为 $k$。因此张量 $\\mathbf{T}$ 是各向同性的：\n$$\n\\mathbf{T} = k \\mathbf{I} = \\begin{pmatrix} k  0  0 \\\\ 0  k  0 \\\\ 0  0  k \\end{pmatrix}\n$$\n为了确定 $k$ 的值，我们使用张量 $\\mathbf{T}$ 的迹。$\\mathbf{T} = k\\mathbf{I}$ 的迹是：\n$$\n\\mathrm{tr}(\\mathbf{T}) = k + k + k = 3k\n$$\n或者，我们可以从 $\\mathbf{T}$ 的基本定义计算迹：\n$$\n\\mathrm{tr}(\\mathbf{T}) = \\mathrm{tr}\\left(\\sum_{i=1}^{N} w_{i} \\vec{\\Omega}_{i} \\vec{\\Omega}_{i}\\right) = \\sum_{i=1}^{N} w_{i} \\mathrm{tr}(\\vec{\\Omega}_{i} \\vec{\\Omega}_{i})\n$$\n外积 $\\vec{v}\\vec{v}^{\\mathsf{T}}$ 的迹是点积 $\\vec{v} \\cdot \\vec{v} = |\\vec{v}|^2$。由于每个 $\\vec{\\Omega}_i$ 都是单位矢量，所以 $|\\vec{\\Omega}_i|^2 = 1$。\n$$\n\\mathrm{tr}(\\mathbf{T}) = \\sum_{i=1}^{N} w_{i} (1) = \\sum_{i=1}^{N} w_{i}\n$$\n问题给出了权重之和的归一化约束条件：\n$$\n\\sum_{i=1}^{N} w_{i} = 4\\pi\n$$\n令迹的两个表达式相等，可得：\n$$\n3k = 4\\pi \\implies k = \\frac{4\\pi}{3}\n$$\n因此，离散二阶矩张量是：\n$$\n\\mathbf{T} = \\frac{4\\pi}{3} \\mathbf{I}\n$$\n这个结果是求积组构造对称性的直接推论，并且无论权重 $w_A, w_B, w_C$ 或方向余弦分量 $p, u, v, a, b, c$ 的具体值如何，只要它们遵循指定的对称结构，该结果都成立。为方向余弦提供的具体数值与单位矢量约束是一致的，并用于定义这样一个求积组的具体示例，但在此计算中并不需要这些数值。\n\n#### 各向同性误差和弗罗贝尼乌斯范数\n各向同性误差张量 $\\Delta$ 定义为：\n$$\n\\Delta = \\mathbf{T} - \\frac{4\\pi}{3}\\,\\mathbf{I}\n$$\n代入我们关于 $\\mathbf{T}$ 的结果：\n$$\n\\Delta = \\frac{4\\pi}{3}\\mathbf{I} - \\frac{4\\pi}{3}\\mathbf{I} = \\mathbf{0}\n$$\n其中 $\\mathbf{0}$ 是零张量。\n\n最后，我们计算 $\\Delta$ 的弗罗贝尼乌斯范数：\n$$\n\\|\\Delta\\|_{F} = \\sqrt{\\mathrm{tr}(\\Delta^{\\mathsf{T}}\\Delta)} = \\sqrt{\\mathrm{tr}(\\mathbf{0}^{\\mathsf{T}}\\mathbf{0})} = \\sqrt{\\mathrm{tr}(\\mathbf{0})} = \\sqrt{0} = 0\n$$\n误差的弗罗贝尼乌斯范数为零。这表明所指定的 LS$_8$ 求积组结构固有地且精确地保持了各向同性函数的二阶角矩，这是在中子输运模拟中精确模拟各向同性散射的关键属性。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在证明了求积组能够精确处理二阶矩之后，一个自然的问题是：它的极限在哪里？本练习通过计算一个四阶多项式的积分，让你亲手量化一个简单的水平对称求积组的求积误差。这个过程清晰地揭示了离散纵标法中由于高阶矩被截断而产生的内在误差，这是理解该方法精度限制的关键一环。",
            "id": "4233286",
            "problem": "在用于核反应堆模拟的三维中子输运中，单位球面上的角度积分通过使用水平对称求积的逐点求和来近似。设方向函数定义为 $f(\\vec{\\Omega}) = \\mu^{4} + \\eta^{4} + \\xi^{4}$，其中 $\\mu$、$\\eta$ 和 $\\xi$ 是方向向量 $\\vec{\\Omega}$ 相对于笛卡尔坐标轴的方向余弦。考虑一个单层、水平对称（LS）求积，其构造如下：使用与方向余弦向量 $(\\mu,\\eta,\\xi) = \\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$ 的所有符号组合相对应的八个方向，并为每个方向分配相等的权重 $w$，使得该求积对于常数在全立体角上的积分是精确的。\n\n使用此求积，计算离散求积和\n$$\nQ \\equiv \\sum_{i=1}^{8} w\\, f(\\vec{\\Omega}_{i}),\n$$\n以及解析积分\n$$\nI \\equiv \\int_{4\\pi} f(\\vec{\\Omega})\\, d\\Omega,\n$$\n在整个球面上。然后，计算差值\n$$\nD \\equiv Q - I.\n$$\n您的推导应基于立体角积分的基本定义和方向余弦的定义。以球面度为单位表示 $D$ 的最终值。无需四舍五入；请报告精确值。",
            "solution": "该问题要求计算函数 $f(\\vec{\\Omega}) = \\mu^{4} + \\eta^{4} + \\xi^{4}$ 在单位球面上的离散求积和 $Q$ 与解析积分 $I$ 之间的差值 $D$。向量 $\\vec{\\Omega}$ 的方向余弦由 $\\mu$、$\\eta$ 和 $\\xi$ 给出。\n需要计算的总量是 $D \\equiv Q - I$。我们将分别计算 $Q$ 和 $I$，然后求它们的差。\n\n首先，我们确定求积权重 $w$ 的值。问题陈述中提到，单层、水平对称（LS）求积由8个方向构成，每个方向具有相等的权重 $w$。该求积对于常数函数在 $4\\pi$ 球面度的全立体角上的积分是精确的。我们选择常数函数 $g(\\vec{\\Omega}) = 1$。\n该常数函数的解析积分为：\n$$ \\int_{4\\pi} 1 \\, d\\Omega = 4\\pi $$\n对应的求积和为：\n$$ \\sum_{i=1}^{8} w_{i} g(\\vec{\\Omega}_{i}) = \\sum_{i=1}^{8} w \\cdot 1 = 8w $$\n根据对常数精确的条件，我们令积分与和相等：\n$$ 8w = 4\\pi $$\n解出 $w$，我们得到每个求积点的权重：\n$$ w = \\frac{4\\pi}{8} = \\frac{\\pi}{2} $$\n\n接下来，我们计算离散求积和 $Q$。\n$$ Q \\equiv \\sum_{i=1}^{8} w f(\\vec{\\Omega}_{i}) $$\n求积点 $\\vec{\\Omega}_{i}$ 是与方向余弦向量 $(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$ 的所有符号组合相对应的8个方向。这意味着对于任何方向 $i$，其分量 $(\\mu_i, \\eta_i, \\xi_i)$ 满足 $|\\mu_i| = \\frac{1}{\\sqrt{3}}$，$|\\eta_i| = \\frac{1}{\\sqrt{3}}$ 和 $|\\xi_i| = \\frac{1}{\\sqrt{3}}$。\n让我们计算函数 $f(\\vec{\\Omega})$ 在这8个点中任意一点的值。由于函数定义中的幂是偶数，方向余弦的符号不影响结果。\n$$ f(\\vec{\\Omega}_{i}) = \\mu_{i}^{4} + \\eta_{i}^{4} + \\xi_{i}^{4} = \\left(\\pm\\frac{1}{\\sqrt{3}}\\right)^{4} + \\left(\\pm\\frac{1}{\\sqrt{3}}\\right)^{4} + \\left(\\pm\\frac{1}{\\sqrt{3}}\\right)^{4} $$\n$$ f(\\vec{\\Omega}_{i}) = \\left(\\frac{1}{3}\\right)^{2} + \\left(\\frac{1}{3}\\right)^{2} + \\left(\\frac{1}{3}\\right)^{2} = \\frac{1}{9} + \\frac{1}{9} + \\frac{1}{9} = \\frac{3}{9} = \\frac{1}{3} $$\n对于所有8个求积方向，函数值是恒定的。现在我们可以计算 $Q$：\n$$ Q = \\sum_{i=1}^{8} w f(\\vec{\\Omega}_{i}) = 8 \\cdot w \\cdot f(\\vec{\\Omega}_{i}) = 8 \\cdot \\left(\\frac{\\pi}{2}\\right) \\cdot \\left(\\frac{1}{3}\\right) = \\frac{4\\pi}{3} $$\n\n现在，我们计算解析积分 $I$。\n$$ I \\equiv \\int_{4\\pi} f(\\vec{\\Omega}) \\, d\\Omega = \\int_ {4\\pi} (\\mu^{4} + \\eta^{4} + \\xi^{4}) \\, d\\Omega $$\n由于球的对称性，$\\mu^4$、$\\eta^4$ 和 $\\xi^4$ 在全立体角上的积分是相同的。\n$$ \\int_{4\\pi} \\mu^{4} \\, d\\Omega = \\int_{4\\pi} \\eta^{4} \\, d\\Omega = \\int_{4\\pi} \\xi^{4} \\, d\\Omega $$\n因此，积分 $I$ 可以写成：\n$$ I = 3 \\int_{4\\pi} \\mu^{4} \\, d\\Omega $$\n为了计算这个积分，我们使用球坐标。立体角微元为 $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$，其中 $\\theta \\in [0, \\pi]$ 是极角，$\\phi \\in [0, 2\\pi]$ 是方位角。方向余弦 $\\mu$ 等价于 $\\cos\\theta$。\n$$ \\int_{4\\pi} \\mu^{4} \\, d\\Omega = \\int_{0}^{2\\pi} \\int_{0}^{\\pi} (\\cos\\theta)^{4} \\sin\\theta \\, d\\theta \\, d\\phi $$\n对 $\\phi$ 的积分是简单的：\n$$ \\int_{0}^{2\\pi} d\\phi = 2\\pi $$\n所以我们有：\n$$ \\int_{4\\pi} \\mu^{4} \\, d\\Omega = 2\\pi \\int_{0}^{\\pi} \\cos^{4}\\theta \\sin\\theta \\, d\\theta $$\n我们进行变量替换。令 $u = \\cos\\theta$，这意味着 $du = -\\sin\\theta \\, d\\theta$。积分限从 $\\theta=0$ 变为 $u=1$，从 $\\theta=\\pi$ 变为 $u=-1$。\n$$ 2\\pi \\int_{1}^{-1} u^{4} (-du) = 2\\pi \\int_{-1}^{1} u^{4} \\, du = 2\\pi \\left[ \\frac{u^{5}}{5} \\right]_{-1}^{1} $$\n$$ = 2\\pi \\left( \\frac{1^{5}}{5} - \\frac{(-1)^{5}}{5} \\right) = 2\\pi \\left( \\frac{1}{5} - \\left(-\\frac{1}{5}\\right) \\right) = 2\\pi \\left( \\frac{2}{5} \\right) = \\frac{4\\pi}{5} $$\n现在我们可以计算 $I$：\n$$ I = 3 \\cdot \\left(\\frac{4\\pi}{5}\\right) = \\frac{12\\pi}{5} $$\n\n最后，我们计算差值 $D = Q - I$。\n$$ D = \\frac{4\\pi}{3} - \\frac{12\\pi}{5} $$\n为了对这两个分数进行减法，我们找到公分母，即 $15$。\n$$ D = \\frac{5 \\cdot 4\\pi}{15} - \\frac{3 \\cdot 12\\pi}{15} = \\frac{20\\pi}{15} - \\frac{36\\pi}{15} = \\frac{20\\pi - 36\\pi}{15} = -\\frac{16\\pi}{15} $$\n该结果表示了这种特定的单层求积对于方向余弦四阶矩的误差。$D$ 的单位是球面度，因为积分和求和都是在立体角上进行的，而 $f(\\vec{\\Omega})$ 是无量纲的。",
            "answer": "$$\n\\boxed{-\\frac{16\\pi}{15}}\n$$"
        },
        {
            "introduction": "理论的最终检验在于实践。这个练习要求你将前面讨论的矩匹配理论转化为一个实际的计算验证工具。通过编写代码来测试一个正确的、一个微扰的以及一个设计错误的求积组，你将不仅能加深对求积理论的理解，还能掌握在实践中验证数值算法正确性的关键技能，并直观地看到设计缺陷如何导致数值结果的偏差。",
            "id": "4233267",
            "problem": "考虑在核反应堆模拟中，离散纵标(DO)方法所使用的中子输运三维角度积分。角度域为单位球面，记为 $\\Omega = \\{(\\mu,\\eta,\\xi)\\in\\mathbb{R}^3 \\mid \\mu^2+\\eta^2+\\xi^2=1\\}$，其中 $(\\mu,\\eta,\\xi)$ 是方向余弦。离散纵标 ($S_N$) 方法的能级对称求积组由单位球面 $\\Omega$ 上的有限方向集 $\\{(\\mu_n,\\eta_n,\\xi_n)\\}_{n=1}^M$ 及非负权重 $\\{w_n\\}_{n=1}^M$ 组成，其加权和可近似角度积分：\n$$\n\\int_{\\Omega} f(\\mu,\\eta,\\xi)\\, \\mathrm{d}\\Omega \\approx \\sum_{n=1}^M w_n f(\\mu_n,\\eta_n,\\xi_n).\n$$\n根据单位球面的旋转对称性以及恒等式 $\\mu^2+\\eta^2+\\xi^2=1$，最高二次的典范多项式的精确积分满足：\n- 常数项：$\\int_{\\Omega} 1\\, \\mathrm{d}\\Omega = 4\\pi$。\n- 线性项：$\\int_{\\Omega} \\mu\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\eta\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\xi\\, \\mathrm{d}\\Omega = 0$。\n- 二次项：$\\int_{\\Omega} \\mu^2\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\eta^2\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\xi^2\\, \\mathrm{d}\\Omega = \\frac{4\\pi}{3}$，以及交叉项 $\\int_{\\Omega} \\mu\\eta\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\mu\\xi\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\eta\\xi\\, \\mathrm{d}\\Omega = 0$。\n\n基于这些事实和单位球面的定义，设计并实现一个验证套件。该套件给定一个能级对称求积组 $\\{(\\mu_n,\\eta_n,\\xi_n),w_n\\}$，计算上述典范测试被积函数的离散矩，并将其与解析值进行比较。验证过程应报告矩条件的残差，并断言其在机器精度范围内是精确的。\n\n你的程序必须：\n1. 构建以下三个求积测试用例：\n   - 用例 A (理想路径)：$S_2$ 能级对称求积组，包含 $M=8$ 个方向，位于立方体顶点 $(\\pm a,\\pm a,\\pm a)$ 处，其中 $a = 1/\\sqrt{3}$，每个方向的权重为 $w = \\pi/2$。由于对称性以及对 $a$ 和 $w$ 的选择，已知该求积组能在 $\\Omega$ 上精确积分所有最高二次的多项式。\n   - 用例 B (近精确边界)：几何结构与用例 A 相同，但所有权重均统一乘以一个因子 $1+\\delta$，其中 $\\delta = 10^{-8}$。这会刻意引入一个小的归一化误差。\n   - 用例 C (边缘失效)：八个完全相同的方向，均为 $(a,a,a)$，其中 $a = 1/\\sqrt{3}$，每个权重为 $w=\\pi/2$。这保留了总权重 $\\sum_n w_n = 4\\pi$，但破坏了奇数矩的对称性。\n\n2. 对每个用例，评估十个最高二次的典范被积函数的残差：\n   - $f_0=1$，\n   - $f_1=\\mu$, $f_2=\\eta$, $f_3=\\xi$，\n   - $f_4=\\mu^2$, $f_5=\\eta^2$, $f_6=\\xi^2$，\n   - $f_7=\\mu\\eta$, $f_8=\\mu\\xi$, $f_9=\\eta\\xi$。\n   对于每个被积函数 $f_k$，计算残差 $r_k = \\left|\\sum_{n=1}^M w_n f_k(\\mu_n,\\eta_n,\\xi_n) - I_k\\right|$，其中 $I_k$ 是上文指定的相应精确积分值。\n\n3. 使用容差 $T = 1\\times 10^{-12}$。一个求积组当且仅当 $\\max_k r_k \\leq T$ 时通过测试。\n\n4. 最终输出必须是单行，包含三个用例的结果列表，每个用例的结果是一个数对 $[\\text{pass}, R]$，其中 $\\text{pass}$ 是一个布尔值，而 $R=\\max_k r_k$ 是一个实数。输出格式必须为：\n   $$\n   [[\\text{pass}_A, R_A],[\\text{pass}_B, R_B],[\\text{pass}_C, R_C]]\n   $$\n   以这种逗号分隔、方括号括起的列表格式精确打印为单行。\n\n不涉及物理单位。由于方向余弦是无量纲的，角度也按无量纲方式处理。程序必须自包含，不需要任何输入，并严格按照指定的输出格式生成结果。\n\n该测试套件涵盖：\n- 通用正确性 (用例 A)，\n- 归一化的边界扰动 (用例 B)，\n- 一个显著的对称性破坏边缘用例 (用例 C)。\n\n你的程序应生成单行输出，其中包含一个用方括号括起的逗号分隔列表的结果（例如，$[ [\\text{pass}_A,R_A],[\\text{pass}_B,R_B],[\\text{pass}_C,R_C] ]$）。",
            "solution": "该验证套件基于单位球面的旋转对称性和基本的多项式恒等式。角度域是单位球面 $\\Omega$，其面积微元为 $\\mathrm{d}\\Omega$。目标是根据最高二次的典范多项式的精确积分来测试能级对称求积组。\n\n基本原理：\n1. 旋转不变性：对于任意正交变换 $Q\\in \\mathrm{SO}(3)$，积分 $\\int_{\\Omega} f(\\mathbf{\\omega})\\, \\mathrm{d}\\Omega$ 等于 $\\int_{\\Omega} f(Q\\mathbf{\\omega})\\, \\mathrm{d}\\Omega$。这意味着各向同性量的积分在不同坐标上必须相等。\n2. 单位球面的归一化：$\\Omega$ 的表面积为 $\\int_{\\Omega} 1\\, \\mathrm{d}\\Omega = 4\\pi$。\n3. 单位球面上的恒等式：对于任意 $(\\mu,\\eta,\\xi)\\in\\Omega$，有 $\\mu^2+\\eta^2+\\xi^2=1$。在 $\\Omega$ 上对两边积分可得\n$$\n\\int_{\\Omega} \\mu^2\\, \\mathrm{d}\\Omega + \\int_{\\Omega} \\eta^2\\, \\mathrm{d}\\Omega + \\int_{\\Omega} \\xi^2\\, \\mathrm{d}\\Omega = \\int_{\\Omega} 1\\, \\mathrm{d}\\Omega = 4\\pi.\n$$\n根据对称性，$\\int_{\\Omega} \\mu^2\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\eta^2\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\xi^2\\, \\mathrm{d}\\Omega$，因此每一项均为 $\\frac{4\\pi}{3}$。对于线性项，由于球面在符号变换 $\\mu\\mapsto -\\mu$ 等操作下是对称的，所以 $\\int_{\\Omega} \\mu\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\eta\\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\xi\\, \\mathrm{d}\\Omega = 0$。对于混合二阶项，$\\int_{\\Omega} \\mu\\eta\\, \\mathrm{d}\\Omega = 0$，同理 $\\mu\\xi$ 和 $\\eta\\xi$ 的积分也为零，因为在对称域上，每个被积函数至少在一个坐标上是奇函数。\n\n测试用例设计：\n- 用例 A 构建了 $S_2$ 能级对称求积组，其八个方向位于 $(\\pm a,\\pm a,\\pm a)$，其中 $a=1/\\sqrt{3}$。选择 $a=1/\\sqrt{3}$ 可确保所有方向都位于 $\\Omega$ 上，因为 $a^2+a^2+a^2=3a^2=1$。对 $M=8$ 个方向中的每一个都使用相同的权重 $w=\\pi/2$，得到 $\\sum w_n = 8(\\pi/2)=4\\pi$。所有卦限的全符号对称性与相等权重的组合保证了线性和混合项的总和精确为零，而二阶项也达到正确的值，因为\n$$\n\\sum_{n=1}^8 w \\mu_n^2 = 8w\\, a^2 = 8\\left(\\frac{\\pi}{2}\\right)\\left(\\frac{1}{3}\\right) = \\frac{4\\pi}{3}.\n$$\n因此，用例 A 对于所有最高二次的典范矩，其结果应在机器精度内通过测试。\n\n- 用例 B 通过将所有权重乘以 $1+\\delta$（其中 $\\delta = 10^{-8}$）来扰动归一化。几何结构保持对称，因此奇数矩（线性和混合二阶矩）的总和仍然为零。然而，常数矩和对角线上的二阶矩会获得一个统一的缩放因子。常数项的预期残差为\n$$\nr_0 = \\left| \\sum_{n=1}^8 w(1+\\delta) - 4\\pi \\right| = \\left| 4\\pi(1+\\delta) - 4\\pi \\right| = 4\\pi\\, \\delta,\n$$\n其值约为 $1.2566370614359172\\times 10^{-7}$，超过了严格的容差 $T=1\\times 10^{-12}$。\n\n- 用例 C 通过使用八个相同的方向 $(a,a,a)$（其中 $a=1/\\sqrt{3}$）且每个权重为 $w=\\pi/2$ 来破坏奇对称性。总权重保持为 $4\\pi$，因此常数矩是精确的；然而，线性矩变为\n$$\n\\sum_{n=1}^8 w\\, \\mu_n = 8w\\, a = 8\\left(\\frac{\\pi}{2}\\right)\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{4\\pi}{\\sqrt{3}},\n$$\n相对于精确值 $0$ 产生了显著的非零残差，从而确保测试失败。\n\n算法：\n1. 定义指定的典范被积函数 $f_k(\\mu,\\eta,\\xi)$：常数项、线性项、以及包括混合项在内的二阶项。\n2. 对于每个求积用例，计算离散和 $S_k = \\sum_{n=1}^M w_n f_k(\\mu_n,\\eta_n,\\xi_n)$。\n3. 使用上述基本关系计算精确积分 $I_k$：$I_0=4\\pi$， $I_{1,2,3}=0$， $I_{4,5,6}=4\\pi/3$， $I_{7,8,9}=0$。\n4. 形成残差 $r_k = |S_k - I_k|$ 及最大残差 $R = \\max_k r_k$。\n5. 将 $R$ 与容差 $T=1\\times 10^{-12}$ 进行比较，为每个用例生成布尔型的通过/失败结果。\n\n输出：\n按顺序为用例 A、B 和 C 返回一个单行列表，其中包含条目 $[\\text{pass}, R]$，并严格按照要求格式化。该设计将物理对称性原理和数学恒等式与算法评估相结合，以验证能级对称求积组对于典范多项式矩的精确性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_S2_valid():\n    \"\"\"\n    Build the S2 level-symmetric quadrature:\n    Directions: all sign combinations of (a,a,a) with a=1/sqrt(3).\n    Weights: w = pi/2 for each of the 8 directions.\n    \"\"\"\n    a = 1.0 / np.sqrt(3.0)\n    w = np.pi / 2.0\n    # All 8 sign combinations\n    signs = np.array([\n        [+1, +1, +1],\n        [+1, +1, -1],\n        [+1, -1, +1],\n        [+1, -1, -1],\n        [-1, +1, +1],\n        [-1, +1, -1],\n        [-1, -1, +1],\n        [-1, -1, -1],\n    ], dtype=float)\n    dirs = signs * a\n    weights = np.full((dirs.shape[0],), w, dtype=float)\n    return dirs, weights\n\ndef build_S2_perturbed(delta=1e-8):\n    \"\"\"\n    Same directions as S2 valid, but the weights are uniformly scaled by (1+delta).\n    \"\"\"\n    dirs, weights = build_S2_valid()\n    return dirs, weights * (1.0 + delta)\n\ndef build_edge_failure():\n    \"\"\"\n    Eight identical directions all equal to (a,a,a), weights w = pi/2.\n    This breaks odd symmetry while keeping total weight = 4*pi.\n    \"\"\"\n    a = 1.0 / np.sqrt(3.0)\n    w = np.pi / 2.0\n    dirs = np.tile(np.array([a, a, a], dtype=float), (8, 1))\n    weights = np.full((dirs.shape[0],), w, dtype=float)\n    return dirs, weights\n\ndef canonical_integrands(mu, eta, xi):\n    \"\"\"\n    Evaluate the ten canonical integrands at given direction cosines.\n    Returns a vector [f0, f1, ..., f9].\n    \"\"\"\n    return np.array([\n        1.0,                 # f0 = 1\n        mu,                  # f1 = mu\n        eta,                 # f2 = eta\n        xi,                  # f3 = xi\n        mu*mu,               # f4 = mu^2\n        eta*eta,             # f5 = eta^2\n        xi*xi,               # f6 = xi^2\n        mu*eta,              # f7 = mu*eta\n        mu*xi,               # f8 = mu*xi\n        eta*xi               # f9 = eta*xi\n    ], dtype=float)\n\ndef exact_integrals():\n    \"\"\"\n    Exact integrals for the ten canonical integrands over the unit sphere.\n    [4π, 0, 0, 0, 4π/3, 4π/3, 4π/3, 0, 0, 0]\n    \"\"\"\n    four_pi = 4.0 * np.pi\n    four_pi_over_three = four_pi / 3.0\n    return np.array([\n        four_pi,            # I0\n        0.0,                # I1\n        0.0,                # I2\n        0.0,                # I3\n        four_pi_over_three, # I4\n        four_pi_over_three, # I5\n        four_pi_over_three, # I6\n        0.0,                # I7\n        0.0,                # I8\n        0.0                 # I9\n    ], dtype=float)\n\ndef validate_quadrature(dirs, weights, tol=1e-12):\n    \"\"\"\n    Compute residuals for canonical integrands and return pass flag and max residual.\n    \"\"\"\n    # Accumulate discrete sums for each integrand\n    sums = np.zeros(10, dtype=float)\n    for (mu, eta, xi), w in zip(dirs, weights):\n        f = canonical_integrands(mu, eta, xi)\n        sums += w * f\n\n    I = exact_integrals()\n    residuals = np.abs(sums - I)\n    max_residual = float(np.max(residuals))\n    passed = bool(max_residual = tol)\n    return passed, max_residual\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\"CaseA_S2_valid\", build_S2_valid),\n        (\"CaseB_S2_perturbed\", lambda: build_S2_perturbed(delta=1e-8)),\n        (\"CaseC_edge_failure\", build_edge_failure),\n    ]\n\n    results = []\n    for name, builder in test_cases:\n        dirs, weights = builder()\n        passed, max_residual = validate_quadrature(dirs, weights, tol=1e-12)\n        # Append [boolean, float] for each case\n        results.append([passed, max_residual])\n\n    # Final print statement in the exact required format.\n    # Ensure booleans and floats appear as plain Python literals in the list.\n    # Convert inner lists to strings manually to avoid spaces if desired.\n    def item_to_str(item):\n        # item is [bool, float]\n        return f\"[{str(item[0])},{item[1]}]\"\n    print(f\"[{','.join(item_to_str(item) for item in results)}]\")\n\nsolve()\n```"
        }
    ]
}