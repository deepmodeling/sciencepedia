{
    "hands_on_practices": [
        {
            "introduction": "Before building complex numerical solvers, it is crucial to understand their fundamental behavior. Iterative methods, like the source iteration scheme used to solve the discrete ordinates equations, must be guaranteed to converge to the correct solution. This exercise invites you to use Fourier analysis, a powerful mathematical tool, to investigate the convergence properties of source iteration . By analyzing how errors at different spatial frequencies are amplified or dampened with each iteration, you will derive the spectral radius of the iteration operator, which directly governs the method's convergence rate.",
            "id": "4254596",
            "problem": "A one-dimensional, steady-state neutron transport problem in a homogeneous infinite medium is considered with isotropic scattering and no external source. The angular flux is denoted by $\\psi(x,\\mu)$ and the scalar flux by $\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\,\\mathrm{d}\\mu$. Using the Discrete Ordinates (S$_{n}$) approximation with $n=2$ Gauss–Legendre quadrature points on $[-1,1]$, the directions are $\\mu_{1} = 1/\\sqrt{3}$ and $\\mu_{2} = -1/\\sqrt{3}$ with corresponding weights $w_{1} = 1$ and $w_{2} = 1$. The total macroscopic cross section is $\\sigma_{t} > 0$ and the scattering macroscopic cross section is $\\sigma_{s} \\in (0,\\sigma_{t})$, both spatially constant. The governing continuous transport equation for each discrete direction is\n$$\n\\mu_{m} \\frac{\\mathrm{d}}{\\mathrm{d}x} \\psi_{m}(x) + \\sigma_{t} \\psi_{m}(x) = \\frac{\\sigma_{s}}{2} \\,\\phi(x), \\quad m \\in \\{1,2\\},\n$$\nwith $\\phi(x) = \\sum_{m=1}^{2} w_{m} \\psi_{m}(x)$.\n\nConsider source iteration: given an iterate $\\phi^{(p)}(x)$, the next iterate is obtained by solving the above transport equations for $\\psi_{m}^{(p+1)}(x)$ with the right-hand side $\\frac{\\sigma_{s}}{2}\\,\\phi^{(p)}(x)$, and then forming $\\phi^{(p+1)}(x) = \\sum_{m=1}^{2} w_{m} \\psi_{m}^{(p+1)}(x)$.\n\nPerform a Fourier (von Neumann) error analysis under periodic boundary conditions on a sufficiently large interval: assume the scalar flux error at iteration $p$ has the form $e^{(p)}(x) = \\Phi^{(p)} \\exp(i k x)$ for wavenumber $k \\in \\mathbb{R}$. Starting from the continuous transport equation and the definition of source iteration, derive the Fourier-mode error amplification factor $\\lambda(k)$ such that $\\Phi^{(p+1)} = \\lambda(k) \\,\\Phi^{(p)}$, and then determine the spectral radius $r = \\sup_{k \\in \\mathbb{R}} |\\lambda(k)|$.\n\nFinally, evaluate $r$ numerically for $\\sigma_{t} = 1.25$ and $\\sigma_{s} = 1.00$ (both in $\\mathrm{cm}^{-1}$) and report the result as a dimensionless number. Round your final answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- **Problem setting**: One-dimensional, steady-state neutron transport in a homogeneous infinite medium with isotropic scattering and no external source.\n- **Angular flux**: $\\psi(x,\\mu)$.\n- **Scalar flux**: $\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\,\\mathrm{d}\\mu$.\n- **Approximation**: Discrete Ordinates (S$_{n}$) with $n=2$ and a Gauss-Legendre quadrature set.\n- **Quadrature points**: $\\mu_{1} = 1/\\sqrt{3}$, $\\mu_{2} = -1/\\sqrt{3}$.\n- **Quadrature weights**: $w_{1} = 1$, $w_{2} = 1$.\n- **Macroscopic cross sections**: Total $\\sigma_{t} > 0$ and scattering $\\sigma_{s} \\in (0,\\sigma_{t})$, both spatially constant.\n- **Governing S$_2$ equations**: $\\mu_{m} \\frac{\\mathrm{d}}{\\mathrm{d}x} \\psi_{m}(x) + \\sigma_{t} \\psi_{m}(x) = \\frac{\\sigma_{s}}{2} \\,\\phi(x)$ for $m \\in \\{1,2\\}$.\n- **Discrete scalar flux**: $\\phi(x) = \\sum_{m=1}^{2} w_{m} \\psi_{m}(x)$.\n- **Iteration method**: Source iteration, where $\\mu_{m} \\frac{\\mathrm{d}}{\\mathrm{d}x} \\psi_{m}^{(p+1)}(x) + \\sigma_{t} \\psi_{m}^{(p+1)}(x) = \\frac{\\sigma_{s}}{2} \\,\\phi^{(p)}(x)$ and $\\phi^{(p+1)}(x) = \\sum_{m=1}^{2} w_{m} \\psi_{m}^{(p+1)}(x)$.\n- **Analysis**: Fourier error analysis with error mode $e^{(p)}(x) = \\Phi^{(p)} \\exp(i k x)$.\n- **Objective**: Derive the amplification factor $\\lambda(k)$, find the spectral radius $r = \\sup_{k \\in \\mathbb{R}} |\\lambda(k)|$, and evaluate $r$ for $\\sigma_{t} = 1.25$ and $\\sigma_{s} = 1.00$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard exercise in the analysis of numerical methods for neutron transport, a core topic in nuclear engineering and physics. All concepts (Discrete Ordinates, source iteration, Fourier analysis, cross sections) are well-defined and standard. The physical setup ($1$D infinite medium, isotropic scattering, subcritical medium $\\sigma_{s} < \\sigma_{t}$) is a common idealization used for such analyses. The problem is self-contained, mathematically consistent, and scientifically grounded. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution is warranted.\n\nThe goal is to perform a Fourier analysis of the source iteration method to find its spectral radius. Let $\\psi_m(x)$ and $\\phi(x)$ denote the exact solutions to the S$_{2}$ equations, and $\\psi_m^{(p)}(x)$ and $\\phi^{(p)}(x)$ be the solutions at iteration $p$. The error in the angular and scalar fluxes at iteration $p$ are defined as $e_m^{(p)}(x) = \\psi_m^{(p)}(x) - \\psi_m(x)$ and $e^{(p)}(x) = \\phi^{(p)}(x) - \\phi(x)$, respectively.\n\nThe exact S$_{2}$ equations are:\n$$ \\mu_{m} \\frac{\\mathrm{d}}{\\mathrm{d}x} \\psi_{m}(x) + \\sigma_{t} \\psi_{m}(x) = \\frac{\\sigma_{s}}{2} \\phi(x) $$\nThe source iteration equations are:\n$$ \\mu_{m} \\frac{\\mathrm{d}}{\\mathrm{d}x} \\psi_{m}^{(p+1)}(x) + \\sigma_{t} \\psi_{m}^{(p+1)}(x) = \\frac{\\sigma_{s}}{2} \\phi^{(p)}(x) $$\nSubtracting the exact equation from the iteration equation gives the error propagation equation:\n$$ \\mu_{m} \\frac{\\mathrm{d}}{\\mathrm{d}x} e_{m}^{(p+1)}(x) + \\sigma_{t} e_{m}^{(p+1)}(x) = \\frac{\\sigma_{s}}{2} e^{(p)}(x) $$\nThe relationship between the scalar flux error and angular flux errors is:\n$$ e^{(p+1)}(x) = \\phi^{(p+1)}(x) - \\phi(x) = \\sum_{m=1}^{2} w_m \\psi_m^{(p+1)}(x) - \\sum_{m=1}^{2} w_m \\psi_m(x) = \\sum_{m=1}^{2} w_m e_m^{(p+1)}(x) $$\nWe now assume a Fourier mode form for the errors, consistent with the periodic boundary conditions on a large domain. Let the scalar flux error at iteration $p$ be $e^{(p)}(x) = \\Phi^{(p)} \\exp(i k x)$, where $\\Phi^{(p)}$ is the Fourier amplitude and $k$ is the wavenumber. Similarly, we assume the angular flux error at the next iteration has the form $e_m^{(p+1)}(x) = \\Psi_m^{(p+1)} \\exp(i k x)$.\n\nSubstituting these forms into the error propagation equation:\n$$ \\mu_{m} \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\Psi_m^{(p+1)} \\exp(i k x) \\right) + \\sigma_{t} \\left( \\Psi_m^{(p+1)} \\exp(i k x) \\right) = \\frac{\\sigma_{s}}{2} \\left( \\Phi^{(p)} \\exp(i k x) \\right) $$\nPerforming the differentiation $\\frac{\\mathrm{d}}{\\mathrm{d}x} \\exp(i k x) = i k \\exp(i k x)$ and dividing by the common factor $\\exp(i k x)$:\n$$ \\mu_{m} (i k) \\Psi_m^{(p+1)} + \\sigma_{t} \\Psi_m^{(p+1)} = \\frac{\\sigma_{s}}{2} \\Phi^{(p)} $$\n$$ (i k \\mu_{m} + \\sigma_{t}) \\Psi_m^{(p+1)} = \\frac{\\sigma_{s}}{2} \\Phi^{(p)} $$\nWe can solve for the angular flux error amplitude $\\Psi_m^{(p+1)}$:\n$$ \\Psi_m^{(p+1)} = \\frac{\\sigma_{s}/2}{i k \\mu_{m} + \\sigma_{t}} \\Phi^{(p)} $$\nNow, we relate the scalar flux error amplitude at iteration $p+1$, $\\Phi^{(p+1)}$, to the angular ones. From $e^{(p+1)}(x) = \\sum_{m=1}^{2} w_m e_m^{(p+1)}(x)$, we have:\n$$ \\Phi^{(p+1)} \\exp(i k x) = \\sum_{m=1}^{2} w_m \\Psi_m^{(p+1)} \\exp(i k x) $$\n$$ \\Phi^{(p+1)} = \\sum_{m=1}^{2} w_m \\Psi_m^{(p+1)} $$\nSubstituting the expression for $\\Psi_m^{(p+1)}$:\n$$ \\Phi^{(p+1)} = \\sum_{m=1}^{2} w_m \\left( \\frac{\\sigma_{s}/2}{i k \\mu_{m} + \\sigma_{t}} \\right) \\Phi^{(p)} $$\nThe Fourier-mode error amplification factor, $\\lambda(k)$, is defined by $\\Phi^{(p+1)} = \\lambda(k) \\Phi^{(p)}$. Therefore:\n$$ \\lambda(k) = \\frac{\\sigma_{s}}{2} \\sum_{m=1}^{2} \\frac{w_m}{i k \\mu_{m} + \\sigma_{t}} $$\nNow, we substitute the specific values for the S$_{2}$ Gauss-Legendre quadrature set: $w_1=1$, $\\mu_1=1/\\sqrt{3}$ and $w_2=1$, $\\mu_2=-1/\\sqrt{3}$.\n$$ \\lambda(k) = \\frac{\\sigma_{s}}{2} \\left( \\frac{1}{i k (1/\\sqrt{3}) + \\sigma_{t}} + \\frac{1}{i k (-1/\\sqrt{3}) + \\sigma_{t}} \\right) $$\n$$ \\lambda(k) = \\frac{\\sigma_{s}}{2} \\left( \\frac{1}{\\sigma_{t} + i k/\\sqrt{3}} + \\frac{1}{\\sigma_{t} - i k/\\sqrt{3}} \\right) $$\nTo simplify, we find a common denominator:\n$$ \\lambda(k) = \\frac{\\sigma_{s}}{2} \\left( \\frac{(\\sigma_{t} - i k/\\sqrt{3}) + (\\sigma_{t} + i k/\\sqrt{3})}{(\\sigma_{t} + i k/\\sqrt{3})(\\sigma_{t} - i k/\\sqrt{3})} \\right) $$\nThe numerator simplifies to $2\\sigma_{t}$. The denominator is of the form $(a+b)(a-b) = a^2 - b^2$:\n$$ (\\sigma_{t})^2 - (i k/\\sqrt{3})^2 = \\sigma_{t}^2 - i^2 k^2/3 = \\sigma_{t}^2 + k^2/3 $$\nSubstituting these back into the expression for $\\lambda(k)$:\n$$ \\lambda(k) = \\frac{\\sigma_{s}}{2} \\left( \\frac{2\\sigma_{t}}{\\sigma_{t}^2 + k^2/3} \\right) = \\frac{\\sigma_{s}\\sigma_{t}}{\\sigma_{t}^2 + k^2/3} $$\nThis is the amplification factor for a Fourier mode with wavenumber $k$.\n\nThe spectral radius $r$ of the source iteration operator is the supremum of the magnitude of the amplification factor over all possible wavenumbers $k \\in \\mathbb{R}$:\n$$ r = \\sup_{k \\in \\mathbb{R}} |\\lambda(k)| $$\nGiven that $\\sigma_{s} > 0$ and $\\sigma_{t} > 0$, the numerator $\\sigma_{s}\\sigma_{t}$ is positive. The denominator $\\sigma_{t}^2 + k^2/3$ is also always positive for real $k$. Thus, $\\lambda(k)$ is a real and positive function for all $k$, and $|\\lambda(k)| = \\lambda(k)$.\nWe need to find the maximum value of $\\lambda(k) = \\frac{\\sigma_{s}\\sigma_{t}}{\\sigma_{t}^2 + k^2/3}$. This function is maximized when its denominator is minimized. The denominator is $\\sigma_{t}^2 + k^2/3$. Since $k \\in \\mathbb{R}$, the term $k^2$ is always non-negative, $k^2 \\ge 0$. The minimum value of the denominator occurs when $k^2 = 0$, i.e., at $k=0$.\nThe maximum value of $\\lambda(k)$ is therefore at $k=0$:\n$$ r = \\lambda(0) = \\frac{\\sigma_{s}\\sigma_{t}}{\\sigma_{t}^2 + 0^2/3} = \\frac{\\sigma_{s}\\sigma_{t}}{\\sigma_{t}^2} = \\frac{\\sigma_{s}}{\\sigma_{t}} $$\nThe spectral radius is the scattering ratio, $c = \\sigma_s / \\sigma_t$. This is a well-known result indicating that the convergence rate of source iteration in an infinite medium is limited by the $k=0$ (flat) mode.\n\nFinally, we evaluate $r$ for the given numerical values: $\\sigma_{t} = 1.25 \\, \\mathrm{cm}^{-1}$ and $\\sigma_{s} = 1.00 \\, \\mathrm{cm}^{-1}$.\n$$ r = \\frac{\\sigma_{s}}{\\sigma_{t}} = \\frac{1.00}{1.25} = \\frac{1}{5/4} = \\frac{4}{5} = 0.8 $$\nThe problem asks for the result to be rounded to four significant figures.\n$$ r = 0.8000 $$",
            "answer": "$$\n\\boxed{0.8000}\n$$"
        },
        {
            "introduction": "Moving from theoretical analysis to practical application is a key step in mastering any computational method. This hands-on problem challenges you to build a one-dimensional discrete ordinates solver from the ground up to tackle one of the most important problems in reactor physics: the $k$-eigenvalue problem . By implementing the power iteration method combined with a transport sweep, you will directly translate the discretized transport equation into a working computer program. This exercise will solidify your understanding of how spatial and angular discretizations, boundary conditions, and iterative schemes all come together to simulate the behavior of a nuclear system.",
            "id": "4254594",
            "problem": "Consider the one-dimensional slab-geometry, one-group neutron transport equation used in nuclear reactor simulation, under the discrete ordinates (Sₙ) approximation with isotropic scattering and isotropic fission emission. The goal is to compute the fundamental $k$-eigenvalue (multiplication factor) using power iteration, starting from first principles.\n\nYou are given a homogeneous slab of thickness $L$ with vacuum boundary conditions at both faces $x = 0$ and $x = L$. The medium is characterized by macroscopic total cross section $\\Sigma_t$, macroscopic scattering cross section $\\Sigma_s$, and macroscopic fission production cross section $\\nu \\Sigma_f$. The spatial variable is $x \\in [0, L]$, and the angular variable is parameterized by the direction cosine $\\mu \\in [-1, 1]$. The scalar flux is $\\phi(x) = \\int_{-1}^{1} \\psi(x, \\mu) \\, d\\mu$, and the angular flux is $\\psi(x, \\mu)$. The $k$-eigenvalue formulation of the neutron transport equation is\n$$\n\\mu \\frac{d \\psi(x, \\mu)}{dx} + \\Sigma_t \\, \\psi(x, \\mu) = \\frac{\\Sigma_s}{2} \\, \\phi(x) + \\frac{\\nu \\Sigma_f}{2 k} \\, \\phi(x),\n$$\nwith vacuum boundary conditions specifying zero incoming angular flux at $x = 0$ and $x = L$.\n\nStarting from this equation and the definition of the scalar flux, derive a principled algorithm that:\n- Employs the discrete ordinates (Sₙ) approximation, using $N$ angular directions with Gauss–Legendre quadrature for $\\mu \\in [-1, 1]$ and weights $\\{ w_m \\}_{m=1}^{N}$.\n- Discretizes space into $I$ uniform cells of width $h = L / I$, and assumes a cellwise constant source consistent with isotropic scattering and fission.\n- Implements a transport sweep using a constant-in-cell approximation for the source to obtain the angular flux in each cell for each discrete direction, consistent with vacuum boundary conditions for incoming directions at the slab faces.\n- Aggregates the cell-averaged angular fluxes to form the scalar flux via quadrature, $\\phi_i = \\sum_{m=1}^{N} w_m \\, \\bar{\\psi}_{i,m}$, for each spatial cell index $i \\in \\{ 1, \\dots, I \\}$.\n- Implements power iteration to update $k$ and the scalar flux, with a normalization chosen from neutron balance principles over the slab.\n\nYour program must enforce the following stopping criteria:\n- Relative change in $k$ below a tolerance $\\varepsilon_k = 10^{-7}$, i.e., $\\left| k^{(l+1)} - k^{(l)} \\right| / k^{(l+1)} < \\varepsilon_k$.\n- Relative infinity-norm change in scalar flux below a tolerance $\\varepsilon_\\phi = 10^{-7}$, i.e., $\\| \\phi^{(l+1)} - \\phi^{(l)} \\|_\\infty / \\| \\phi^{(l+1)} \\|_\\infty < \\varepsilon_\\phi$.\nIf these criteria are not met, the iteration should continue up to a maximum of $M$ iterations, where $M$ is set sufficiently large to ensure convergence for realistic parameter values in the test suite.\n\nAll physical units must be explicitly stated:\n- The slab thickness $L$ is in $\\mathrm{cm}$.\n- The cross sections $\\Sigma_t$, $\\Sigma_s$, and $\\nu \\Sigma_f$ are in $\\mathrm{cm}^{-1}$.\n- The multiplication factor $k$ is unitless.\n\nImplement the algorithm as a complete program that, for each of the following test cases, computes $k$ to six decimal places. Use the specified parameters exactly, and produce the final output as a single line containing a comma-separated list enclosed in square brackets (for example, $[0.912345,0.701234,0.998765]$).\n\nTest Suite:\n- Case $1$ (happy path):\n  - $L = 100 \\ \\mathrm{cm}$, $I = 200$, $N = 8$, $\\Sigma_t = 0.2 \\ \\mathrm{cm}^{-1}$, $\\Sigma_s = 0.18 \\ \\mathrm{cm}^{-1}$, $\\nu \\Sigma_f = 0.02 \\ \\mathrm{cm}^{-1}$.\n- Case $2$ (increased leakage boundary condition via small slab):\n  - $L = 20 \\ \\mathrm{cm}$, $I = 100$, $N = 4$, $\\Sigma_t = 0.2 \\ \\mathrm{cm}^{-1}$, $\\Sigma_s = 0.18 \\ \\mathrm{cm}^{-1}$, $\\nu \\Sigma_f = 0.02 \\ \\mathrm{cm}^{-1}$.\n- Case $3$ (reduced scattering and higher fission production):\n  - $L = 50 \\ \\mathrm{cm}$, $I = 200$, $N = 8$, $\\Sigma_t = 0.2 \\ \\mathrm{cm}^{-1}$, $\\Sigma_s = 0.10 \\ \\mathrm{cm}^{-1}$, $\\nu \\Sigma_f = 0.08 \\ \\mathrm{cm}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[k_1,k_2,k_3]$), where each $k_i$ is rounded to six decimal places. No additional text or lines should be printed.",
            "solution": "The user has provided a well-defined problem in computational nuclear reactor physics.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Governing Equation**: The one-dimensional, one-group, steady-state $k$-eigenvalue neutron transport equation is given as:\n    $$\n    \\mu \\frac{d \\psi(x, \\mu)}{dx} + \\Sigma_t \\, \\psi(x, \\mu) = \\frac{\\Sigma_s}{2} \\, \\phi(x) + \\frac{\\nu \\Sigma_f}{2 k} \\, \\phi(x)\n    $$\n-   **Definitions**:\n    -   Scalar flux: $\\phi(x) = \\int_{-1}^{1} \\psi(x, \\mu) \\, d\\mu$\n    -   Angular flux: $\\psi(x, \\mu)$\n-   **Domain**: A homogeneous slab of thickness $L$, with spatial variable $x \\in [0, L]$ and direction cosine $\\mu \\in [-1, 1]$.\n-   **Boundary Conditions**: Vacuum boundary conditions at $x = 0$ and $x = L$. This implies zero incoming angular flux:\n    -   $\\psi(0, \\mu) = 0$ for $\\mu > 0$.\n    -   $\\psi(L, \\mu) = 0$ for $\\mu < 0$.\n-   **Material Properties (Macroscopic Cross Sections)**:\n    -   Total cross section: $\\Sigma_t$ [$\\mathrm{cm}^{-1}$]\n    -   Scattering cross section: $\\Sigma_s$ [$\\mathrm{cm}^{-1}$]\n    -   Fission production cross section: $\\nu \\Sigma_f$ [$\\mathrm{cm}^{-1}$]\n-   **Discretization Parameters**:\n    -   Angular discretization: Discrete ordinates (Sₙ) with $N$ directions using Gauss–Legendre quadrature (ordinates $\\{\\mu_m\\}_{m=1}^{N}$ and weights $\\{w_m\\}_{m=1}^{N}$).\n    -   Spatial discretization: $I$ uniform cells of width $h = L / I$.\n-   **Approximations**:\n    -   Isotropic scattering and fission emission.\n    -   Cellwise constant source within each spatial cell.\n    -   Constant-in-cell approximation for the source during the transport sweep.\n-   **Algorithm**: Power iteration to find the fundamental eigenvalue $k$.\n-   **Stopping Criteria**:\n    -   Relative change in $k$: $| k^{(l+1)} - k^{(l)} | / k^{(l+1)} < \\varepsilon_k = 10^{-7}$.\n    -   Relative infinity-norm change in scalar flux: $\\| \\phi^{(l+1)} - \\phi^{(l)} \\|_\\infty / \\| \\phi^{(l+1)} \\|_\\infty < \\varepsilon_\\phi = 10^{-7}$.\n-   **Test Suite**:\n    -   Case 1: $L = 100 \\ \\mathrm{cm}$, $I = 200$, $N = 8$, $\\Sigma_t = 0.2 \\ \\mathrm{cm}^{-1}$, $\\Sigma_s = 0.18 \\ \\mathrm{cm}^{-1}$, $\\nu \\Sigma_f = 0.02 \\ \\mathrm{cm}^{-1}$.\n    -   Case 2: $L = 20 \\ \\mathrm{cm}$, $I = 100$, $N = 4$, $\\Sigma_t = 0.2 \\ \\mathrm{cm}^{-1}$, $\\Sigma_s = 0.18 \\ \\mathrm{cm}^{-1}$, $\\nu \\Sigma_f = 0.02 \\ \\mathrm{cm}^{-1}$.\n    -   Case 3: $L = 50 \\ \\mathrm{cm}$, $I = 200$, $N = 8$, $\\Sigma_t = 0.2 \\ \\mathrm{cm}^{-1}$, $\\Sigma_s = 0.10 \\ \\mathrm{cm}^{-1}$, $\\nu \\Sigma_f = 0.08 \\ \\mathrm{cm}^{-1}$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the validation criteria.\n\n-   **Scientifically Grounded**: The problem is based on the linear Boltzmann transport equation, a cornerstone of nuclear engineering and radiative transfer. The Sₙ method, power iteration, and the specified discretization schemes are standard, well-established numerical techniques for solving this equation. All concepts are scientifically sound.\n-   **Well-Posed**: The problem of finding the fundamental (largest positive) $k$-eigenvalue and its corresponding non-negative eigenfunction (the scalar flux) for the given equation with specified boundary conditions is a well-posed problem in mathematical physics.\n-   **Objective**: The problem is stated using precise mathematical and physical terminology. The given parameters are quantitative, and the objective is a numerical computation, leaving no room for subjectivity.\n-   **Completeness and Consistency**: The problem is self-contained. It provides all necessary physical data, discretization parameters, boundary conditions, and convergence criteria required to formulate and implement a unique solution algorithm. There are no contradictions in the provided information. The physical units are consistent.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. It is a standard and well-posed numerical problem from the field of nuclear reactor analysis. The solution process may proceed.\n\n### Algorithm Derivation and Design\n\nThe goal is to solve the $k$-eigenvalue transport equation using the power iteration method combined with a discrete ordinates ($S_N$) spatial sweep.\n\n**1. Angular Discretization (Discrete Ordinates)**\nThe continuous angular variable $\\mu$ is replaced by a set of $N$ discrete directions $\\{\\mu_m\\}_{m=1}^N$ with corresponding weights $\\{w_m\\}_{m=1}^N$. These are obtained from a Gauss-Legendre quadrature rule on the interval $[-1, 1]$. The integral for the scalar flux is approximated by a weighted sum:\n$$ \\phi(x) \\approx \\sum_{m=1}^{N} w_m \\psi(x, \\mu_m) = \\sum_{m=1}^{N} w_m \\psi_m(x) $$\nThis transforms the original integro-differential equation into a system of $N$ coupled ordinary differential equations:\n$$ \\mu_m \\frac{d \\psi_m(x)}{dx} + \\Sigma_t \\psi_m(x) = \\frac{1}{2} \\left( \\Sigma_s + \\frac{\\nu \\Sigma_f}{k} \\right) \\phi(x) = S(x) $$\nwhere $S(x)$ is the isotropic source term, and $\\psi_m(x) \\equiv \\psi(x, \\mu_m)$.\n\n**2. Spatial Discretization and Transport Sweep**\nThe slab of thickness $L$ is divided into $I$ uniform cells, indexed by $i = 1, \\dots, I$. Each cell has a width $h = L/I$. The source term $S(x)$ is assumed to be constant within each cell, $S_i$. The ODE for direction $m$ within cell $i$ is:\n$$ \\mu_m \\frac{d \\psi_m(x)}{dx} + \\Sigma_t \\psi_m(x) = S_i, \\quad x \\in [x_{i-1/2}, x_{i+1/2}] $$\nThe analytical solution to this equation relates the angular flux at the incoming face of the cell, $\\psi_{in,m}$, to the flux at the outgoing face, $\\psi_{out,m}$:\n$$ \\psi_{out,m} = \\psi_{in,m} e^{-\\Sigma_t h/|\\mu_m|} + \\frac{S_i}{\\Sigma_t} \\left(1 - e^{-\\Sigma_t h/|\\mu_m|}\\right) $$\nTo update the scalar flux, we need the cell-averaged angular flux, $\\bar{\\psi}_{i,m}$. This can be derived by integrating the analytical solution over the cell width $h$, which yields the \"step characteristics\" relation:\n$$ \\bar{\\psi}_{i,m} = \\psi_{in,m} \\frac{1 - e^{-\\tau_m}}{\\tau_m} + \\frac{S_i}{\\Sigma_t} \\left( 1 - \\frac{1 - e^{-\\tau_m}}{\\tau_m} \\right) = \\psi_{in,m} \\frac{1 - e^{-\\tau_m}}{\\tau_m} + \\frac{S_i}{\\Sigma_t} \\frac{\\tau_m - 1 + e^{-\\tau_m}}{\\tau_m} $$\nwhere $\\tau_m = \\Sigma_t h / |\\mu_m|$ is the optical thickness of the cell for direction $m$. These equations form the basis of the transport sweep.\n-   For $\\mu_m > 0$, the sweep proceeds from left to right ($i=1, \\dots, I$), with the boundary condition $\\psi_{in,m} = \\psi_{1/2, m} = 0$.\n-   For $\\mu_m < 0$, the sweep proceeds from right to left ($i=I, \\dots, 1$), with the boundary condition $\\psi_{in,m} = \\psi_{I+1/2, m} = 0$.\n\n**3. Power Iteration Algorithm**\nPower iteration is an algorithm for finding the dominant eigenvalue and its corresponding eigenvector. In this context, the eigenvalue is $k$ and the eigenvector is the scalar flux distribution $\\phi$. A simple and effective variant uses a fully lagged source (both scattering and fission) from the previous iteration.\n\nLet $l$ be the power iteration index.\n1.  **Initialization ($l=0$)**:\n    -   Set an initial guess for the eigenvalue: $k^{(0)} = 1.0$.\n    -   Set an initial guess for the flux distribution, typically a flat profile: $\\phi_i^{(0)} = 1.0$ for all $i=1, \\dots, I$.\n\n2.  **Iteration Loop (for $l=0, 1, 2, \\dots$)**:\n    a.  **Store Previous State**: Retain the previous iteration's values for convergence checks: $k_{prev} = k^{(l)}$ and $\\phi_{prev} = \\phi^{(l)}$.\n\n    b.  **Calculate Source**: Compute the cell-wise constant source $S_i$ using the flux and eigenvalue from the previous iteration:\n        $$ S_i = \\frac{1}{2} \\left[ \\Sigma_s \\phi_{i, prev} + \\frac{\\nu\\Sigma_f}{k_{prev}} \\phi_{i, prev} \\right] $$\n\n    c.  **Transport Sweep**: With the source $S_i$ fixed, solve for a new un-normalized flux distribution, $\\phi_{new}$.\n        -   Initialize $\\phi_{new, i} = 0$ for all $i$.\n        -   Loop through all discrete directions $m=1, \\dots, N$:\n            -   Perform a spatial sweep using the step characteristics equations derived above, starting with the appropriate vacuum boundary condition.\n            -   In each cell $i$, calculate the cell-averaged angular flux $\\bar{\\psi}_{i, m}$.\n            -   Accumulate the contribution to the scalar flux: $\\phi_{new, i} \\leftarrow \\phi_{new, i} + w_m \\bar{\\psi}_{i, m}$.\n\n    d.  **Update Eigenvalue ($k$)**: The power iteration update rule for the eigenvalue is based on the ratio of a quantity proportional to the eigenvector between successive iterations. We use the total fission production rate. Let $P^{(l)} = \\sum_{i=1}^{I} \\nu\\Sigma_f \\phi_{i, prev}h$ be the production from the previous flux and $P_{new} = \\sum_{i=1}^{I} \\nu\\Sigma_f \\phi_{i, new}h$ be the production from the new flux.\n        $$ k^{(l+1)} = k_{prev} \\frac{P_{new}}{P^{(l)}} = k^{(l)} \\frac{\\sum_{i=1}^{I} \\nu\\Sigma_f \\phi_{i, new}}{\\sum_{i=1}^{I} \\nu\\Sigma_f \\phi_{i, prev}} $$\n\n    e.  **Update and Normalize Flux**: The scalar flux eigenvector's shape converges, but its magnitude does not. To ensure stability and provide a consistent basis for convergence checks, we normalize the flux after each iteration. A common practice is to normalize the total fission production to unity.\n        $$ \\phi_i^{(l+1)} = \\frac{\\phi_{i, new}}{\\sum_{j=1}^{I} \\nu\\Sigma_f \\phi_{j, new}h} $$\n\n    f.  **Check Convergence**:\n        -   Eigenvalue convergence: $\\frac{|k^{(l+1)} - k^{(l)}|}{k^{(l+1)}} < \\varepsilon_k$.\n        -   Flux convergence: $\\frac{\\|\\phi^{(l+1)} - \\phi^{(l)}\\|_{\\infty}}{\\|\\phi^{(l+1)}\\|_{\\infty}} < \\varepsilon_\\phi$. The infinity norm is the maximum absolute value of the vector elements.\n        -   If both criteria are met, the iteration has converged. Otherwise, continue to the next iteration, up to a maximum limit.\n\nThis algorithm provides a complete and principled method for solving the specified problem.",
            "answer": "```python\nimport numpy as np\n\ndef run_solver(L, I, N, sigma_t, sigma_s, nu_sigma_f):\n    \"\"\"\n    Solves the 1D one-group S_n k-eigenvalue problem using power iteration.\n\n    Args:\n        L (float): Slab thickness (cm).\n        I (int): Number of spatial cells.\n        N (int): S_n quadrature order (must be even).\n        sigma_t (float): Macroscopic total cross section (cm^-1).\n        sigma_s (float): Macroscopic scattering cross section (cm^-1).\n        nu_sigma_f (float): Macroscopic fission production cross section (cm^-1).\n\n    Returns:\n        float: The calculated k-eigenvalue.\n    \"\"\"\n    # --- Discretization and Constants ---\n    h = L / I  # Cell width (cm)\n    eps_k = 1e-7  # Tolerance for k-eigenvalue\n    eps_phi = 1e-7  # Tolerance for scalar flux\n    max_iter = 2000  # Maximum number of iterations\n\n    # --- Angular Quadrature (Gauss-Legendre) ---\n    mu, w = np.polynomial.legendre.leggauss(N)\n    # The mu values from numpy are sorted, which is convenient.\n    # Positive mu indices for left-to-right sweep\n    positive_mu_indices = np.where(mu > 0)[0]\n    # Negative mu indices for right-to-left sweep\n    negative_mu_indices = np.where(mu < 0)[0]\n\n    # --- Initialization for Power Iteration ---\n    k = 1.0\n    # Initialize with a flat flux profile.\n    # Normalization will occur inside the loop.\n    phi = np.ones(I)\n\n    # --- Power Iteration Loop ---\n    for l in range(max_iter):\n        k_prev = k\n        phi_prev = phi.copy()\n\n        # 1. Calculate source term using previous iteration's flux and k\n        # The source S is defined as 0.5 * (scattering + fission)\n        fission_source_density = (nu_sigma_f / k_prev) * phi_prev\n        scattering_source_density = sigma_s * phi_prev\n        source = 0.5 * (scattering_source_density + fission_source_density)\n\n        # 2. Transport Sweep to find the new un-normalized flux\n        phi_new = np.zeros(I)\n        \n        for m in range(N):\n            # Optical thickness of a cell for direction m\n            tau = sigma_t * h / abs(mu[m])\n\n            # Calculate coefficients for step characteristics relation.\n            # Using np.expm1 for numerical stability with small tau.\n            # 1 - exp(-tau) = -expm1(-tau)\n            # tau - 1 + exp(-tau) = tau + expm1(-tau)\n            if tau < 1e-6:\n                # Taylor expansion for small tau\n                # (1-exp(-t))/t -> 1 - t/2\n                # (t-1+exp(-t))/t -> t/2 - t^2/6\n                coeff1 = 1.0 - tau / 2.0\n                coeff2 = tau / 2.0\n            else:\n                coeff1 = -np.expm1(-tau) / tau\n                coeff2 = (tau + np.expm1(-tau)) / tau\n\n            # Left-to-right sweep for mu > 0\n            if mu[m] > 0:\n                psi_in = 0.0  # Vacuum boundary condition at x=0\n                for i in range(I):\n                    psi_avg = psi_in * coeff1 + (source[i] / sigma_t) * coeff2\n                    phi_new[i] += w[m] * psi_avg\n                    # Update psi_in for the next cell\n                    psi_out = psi_in * np.exp(-tau) + (source[i] / sigma_t) * (1.0 - np.exp(-tau))\n                    psi_in = psi_out\n            \n            # Right-to-left sweep for mu < 0\n            else: # mu[m] < 0\n                psi_in = 0.0  # Vacuum boundary condition at x=L\n                for i in range(I - 1, -1, -1):\n                    psi_avg = psi_in * coeff1 + (source[i] / sigma_t) * coeff2\n                    phi_new[i] += w[m] * psi_avg\n                    # Update psi_in for the next cell\n                    psi_out = psi_in * np.exp(-tau) + (source[i] / sigma_t) * (1.0 - np.exp(-tau))\n                    psi_in = psi_out\n\n        # 3. Update k-eigenvalue\n        # The sum over phi approximates the integral over the domain.\n        fission_prod_new = np.sum(nu_sigma_f * phi_new)\n        fission_prod_old = np.sum(nu_sigma_f * phi_prev)\n        \n        # Avoid division by zero if the old production is zero (unlikely)\n        if fission_prod_old > 0:\n            k = k_prev * (fission_prod_new / fission_prod_old)\n        else: # Should not happen with a positive flux guess\n            k = 1.0\n\n        # 4. Normalize the new flux shape for the next iteration\n        # We normalize the total fission production to 1.\n        total_fission_prod_new = np.sum(nu_sigma_f * phi_new) * h\n        if total_fission_prod_new > 0:\n            phi = phi_new / total_fission_prod_new\n        else:\n            phi = np.ones(I) # Reset if production collapses\n\n        # 5. Check for convergence\n        rel_k_err = abs(k - k_prev) / k\n        \n        phi_norm_inf = np.linalg.norm(phi, ord=np.inf)\n        if phi_norm_inf > 0:\n            rel_phi_err = np.linalg.norm(phi - phi_prev, ord=np.inf) / phi_norm_inf\n        else:\n            rel_phi_err = 0.0\n\n        if rel_k_err < eps_k and rel_phi_err < eps_phi:\n            break\n    \n    return k\n\ndef solve():\n    \"\"\"\n    Defines and runs the test cases specified in the problem,\n    then prints the results in the required format.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {'L': 100.0, 'I': 200, 'N': 8, 'sigma_t': 0.2, 'sigma_s': 0.18, 'nu_sigma_f': 0.02},\n        # Case 2\n        {'L': 20.0, 'I': 100, 'N': 4, 'sigma_t': 0.2, 'sigma_s': 0.18, 'nu_sigma_f': 0.02},\n        # Case 3\n        {'L': 50.0, 'I': 200, 'N': 8, 'sigma_t': 0.2, 'sigma_s': 0.10, 'nu_sigma_f': 0.08},\n    ]\n\n    results = []\n    for case in test_cases:\n        k_eigenvalue = run_solver(\n            L=case['L'],\n            I=case['I'],\n            N=case['N'],\n            sigma_t=case['sigma_t'],\n            sigma_s=case['sigma_s'],\n            nu_sigma_f=case['nu_sigma_f']\n        )\n        # Format the result to six decimal places\n        results.append(f\"{k_eigenvalue:.6f}\")\n\n    # Print the final output in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While forward calculations determine the particle distribution resulting from a known source, some problems are more efficiently solved using a different perspective. This is the domain of adjoint methods, which are invaluable for calculating quantities like detector responses or the sensitivity of a result to system parameters. In this problem, you will explore the dual nature of the transport operator by deriving and solving the adjoint discrete ordinates equations . You will discover how the solution to the adjoint problem, the \"adjoint flux,\" represents the importance of particles at a given location and direction to the final quantity of interest, providing an elegant and powerful way to compute the detector response.",
            "id": "4254599",
            "problem": "Consider one-dimensional, monoenergetic neutron transport in slab geometry of thickness $X$, with spatial coordinate $x \\in [0,X]$, isotropic, homogeneous total cross section $\\Sigma_{t}$, and vacuum boundaries. The transport is approximated by the discrete ordinates (S$_{n}$) method (Discrete Ordinates (S$_{n}$) Approximation), using $S_{2}$ Gauss-Legendre quadrature with direction cosines $\\mu_{1}=-1/\\sqrt{3}$, $\\mu_{2}=+1/\\sqrt{3}$ and corresponding weights $w_{1}=w_{2}=1$. Define the angular fluxes $\\psi_{m}(x)$, $m \\in \\{1,2\\}$, and the scalar flux $\\phi(x) = \\frac{1}{2}\\sum_{m=1}^{2} w_{m}\\psi_{m}(x)$. Assume isotropic external volumetric source $q(x)$ and neglect scattering ($\\Sigma_{s}=0$). The vacuum boundary conditions are that the forward angular flux is zero for incoming directions: $\\psi_{m}(0)=0$ for $\\mu_{m}>0$ and $\\psi_{m}(X)=0$ for $\\mu_{m}<0$.\n\nA point-like detector of scalar flux is located at $x=x_{d}$ with $0<x_{d}<X$, having sensitivity function $s(x) = s_{0}\\,\\delta(x-x_{d})$, with $s_{0}>0$ constant and $\\delta(\\cdot)$ the Dirac delta. The detector response functional is $R = \\int_{0}^{X} s(x)\\,\\phi(x)\\,dx$. Using the adjoint formulation of the discrete ordinates equations with respect to the inner product $\\langle \\chi,\\psi\\rangle = \\frac{1}{2}\\sum_{m=1}^{2} w_{m}\\int_{0}^{X} \\chi_{m}(x)\\,\\psi_{m}(x)\\,dx$, do the following:\n\n- Starting from the one-dimensional, steady-state Boltzmann transport equation specialized to slab geometry and the $S_{n}$ discretization, write the forward $S_{2}$ equations (with $\\Sigma_{s}=0$) and define the corresponding adjoint $S_{2}$ equations and vacuum adjoint boundary conditions that are complementary to the forward vacuum conditions.\n\n- Derive the exact adjoint angular fluxes $\\psi_{m}^{\\dagger}(x)$ for $m=1,2$ in the pure absorption case ($\\Sigma_{s}=0$), driven by the detector source $s(x)$, and express them piecewise on $[0,X]$.\n\n- Using the adjoint identity for vacuum boundaries, express the detector response $R$ due to a uniform isotropic source $q(x)=q_{0}$ (constant on $[0,X]$) directly in terms of the adjoint angular fluxes and evaluate the integral to obtain a closed-form expression for $R$ as a function of $q_{0}$, $s_{0}$, $\\Sigma_{t}$, $X$, $x_{d}$, and the $S_{2}$ direction cosine magnitude $\\mu_{0}=\\frac{1}{\\sqrt{3}}$.\n\nExpress the final detector response $R$ as a single closed-form analytic expression. No numerical evaluation or rounding is required, and no units should be included in the final expression.",
            "solution": "We begin from the steady-state, one-speed Boltzmann transport equation in one-dimensional slab geometry. Under the discrete ordinates (S$_{n}$) approximation with directions $\\{\\mu_{m}\\}$ and weights $\\{w_{m}\\}$, the angular fluxes $\\{\\psi_{m}(x)\\}$ satisfy, for each ordinate $m$,\n$$\n\\mu_{m}\\,\\frac{d\\psi_{m}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}(x) \\;=\\; \\Sigma_{s}\\,\\phi(x) + \\frac{q(x)}{2},\n$$\nwith the scalar flux defined as\n$$\n\\phi(x) \\;=\\; \\frac{1}{2}\\sum_{n=1}^{N} w_{n}\\,\\psi_{n}(x).\n$$\nIn our case, $N=2$, $w_{1}=w_{2}=1$, $\\mu_{1}=-\\mu_{0}$, $\\mu_{2}=+\\mu_{0}$ with $\\mu_{0}=\\frac{1}{\\sqrt{3}}$, and $\\Sigma_{s}=0$. Hence, the forward $S_{2}$ equations reduce to\n$$\n\\mu_{m}\\,\\frac{d\\psi_{m}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}(x) \\;=\\; \\frac{q(x)}{2}, \\quad m=1,2,\n$$\nsubject to vacuum boundary conditions (no incoming flux):\n$$\n\\psi_{2}(0)=0 \\quad (\\mu_{2}>0), \\qquad \\psi_{1}(X)=0 \\quad (\\mu_{1}<0).\n$$\n\nTo formulate the adjoint, we adopt the inner product\n$$\n\\langle \\chi,\\psi\\rangle \\;=\\; \\frac{1}{2}\\sum_{m=1}^{2} w_{m}\\int_{0}^{X} \\chi_{m}(x)\\,\\psi_{m}(x)\\,dx,\n$$\nwhich renders the isotropic scattering operator self-adjoint and yields the standard streaming adjoint by reversing the streaming sign. With $\\Sigma_{s}=0$, the adjoint $S_{2}$ equations for $\\{\\psi_{m}^{\\dagger}(x)\\}$ driven by the detector source are\n$$\n-\\mu_{m}\\,\\frac{d\\psi_{m}^{\\dagger}(x)}{dx} + \\Sigma_{t}\\,\\psi_{m}^{\\dagger}(x) \\;=\\; s(x), \\quad m=1,2,\n$$\nwhere the detector source entering each angular adjoint equation is the same scalar sensitivity $s(x)=s_{0}\\,\\delta(x-x_{d})$ because the detector responds to the scalar flux $\\phi(x)$ and the inner product weights ensure consistency. The adjoint vacuum boundary conditions are complementary to the forward vacuum conditions:\n$$\n\\psi_{1}^{\\dagger}(0)=0 \\quad (\\mu_{1}<0 \\text{ incoming for adjoint at } x=0), \\qquad \\psi_{2}^{\\dagger}(X)=0 \\quad (\\mu_{2}>0 \\text{ incoming for adjoint at } x=X).\n$$\n\nWe next solve the adjoint equations in the pure absorption case. For each $m$, away from $x=x_{d}$ the adjoint equation is homogeneous:\n$$\n-\\mu_{m}\\,\\frac{d\\psi_{m}^{\\dagger}}{dx} + \\Sigma_{t}\\,\\psi_{m}^{\\dagger} \\;=\\; 0,\n$$\nwhose general solution on an interval where $\\mu_{m}\\neq 0$ is\n$$\n\\psi_{m}^{\\dagger}(x) \\;=\\; C_{m}\\,\\exp\\!\\left(\\frac{\\Sigma_{t}}{\\mu_{m}}\\,x\\right).\n$$\nAcross the point source at $x=x_{d}$, integrate the adjoint equation over an infinitesimal interval to obtain the jump condition\n$$\n-\\mu_{m}\\left(\\psi_{m}^{\\dagger}(x_{d}^{+}) - \\psi_{m}^{\\dagger}(x_{d}^{-})\\right) \\;=\\; \\int_{x_{d}^{-}}^{x_{d}^{+}} s(x)\\,dx \\;=\\; s_{0}.\n$$\nWe treat the two directions separately.\n\n- For $\\mu_{2}=+\\mu_{0}>0$, impose $\\psi_{2}^{\\dagger}(X)=0$. The homogeneous solution on $(x_{d},X]$ must vanish identically to satisfy $\\psi_{2}^{\\dagger}(X)=0$, hence $\\psi_{2}^{\\dagger}(x)=0$ for $x>x_{d}$. Using the jump condition with $\\psi_{2}^{\\dagger}(x_{d}^{+})=0$,\n$$\n-\\mu_{0}\\left(0 - \\psi_{2}^{\\dagger}(x_{d}^{-})\\right) \\;=\\; s_{0} \\quad \\Rightarrow \\quad \\psi_{2}^{\\dagger}(x_{d}^{-}) \\;=\\; \\frac{s_{0}}{\\mu_{0}}.\n$$\nTherefore, on $[0,x_{d})$,\n$$\n\\psi_{2}^{\\dagger}(x) \\;=\\; \\frac{s_{0}}{\\mu_{0}}\\,\\exp\\!\\left(\\frac{\\Sigma_{t}}{\\mu_{0}}\\,x - \\frac{\\Sigma_{t}}{\\mu_{0}}\\,x_{d}\\right) \\;=\\; \\frac{s_{0}}{\\mu_{0}}\\,\\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}(x_{d}-x)\\right),\n$$\nand $\\psi_{2}^{\\dagger}(x)=0$ for $x>x_{d}$.\n\n- For $\\mu_{1}=-\\mu_{0}<0$, impose $\\psi_{1}^{\\dagger}(0)=0$. The homogeneous solution on $[0,x_{d})$ must vanish identically, hence $\\psi_{1}^{\\dagger}(x)=0$ for $x<x_{d}$. Using the jump condition with $\\psi_{1}^{\\dagger}(x_{d}^{-})=0$,\n$$\n-(-\\mu_{0})\\left(\\psi_{1}^{\\dagger}(x_{d}^{+}) - 0\\right) \\;=\\; s_{0} \\quad \\Rightarrow \\quad \\psi_{1}^{\\dagger}(x_{d}^{+}) \\;=\\; \\frac{s_{0}}{\\mu_{0}}.\n$$\nTherefore, on $(x_{d},X]$,\n$$\n\\psi_{1}^{\\dagger}(x) \\;=\\; \\frac{s_{0}}{\\mu_{0}}\\,\\exp\\!\\left(\\frac{\\Sigma_{t}}{-\\mu_{0}}\\,x - \\frac{\\Sigma_{t}}{-\\mu_{0}}\\,x_{d}\\right) \\;=\\; \\frac{s_{0}}{\\mu_{0}}\\,\\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}(x - x_{d})\\right),\n$$\nand $\\psi_{1}^{\\dagger}(x)=0$ for $x<x_{d}$.\n\nCollecting, the adjoint angular fluxes are\n$$\n\\psi_{2}^{\\dagger}(x) \\;=\\; \\begin{cases}\n\\displaystyle \\frac{s_{0}}{\\mu_{0}}\\,\\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}(x_{d}-x)\\right),  0 \\le x \\le x_{d}, \\\\\n0,  x_{d}  x \\le X,\n\\end{cases}\n$$\n$$\n\\psi_{1}^{\\dagger}(x) \\;=\\; \\begin{cases}\n0,  0 \\le x  x_{d}, \\\\\n\\displaystyle \\frac{s_{0}}{\\mu_{0}}\\,\\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}(x - x_{d})\\right),  x_{d} \\le x \\le X.\n\\end{cases}\n$$\n\nWith vacuum boundaries, the adjoint identity states that the detector response equals the inner product of the adjoint flux with the forward source:\n$$\nR \\;=\\; \\int_{0}^{X} s(x)\\,\\phi(x)\\,dx \\;=\\; \\frac{1}{2}\\sum_{m=1}^{2} w_{m}\\int_{0}^{X} \\psi_{m}^{\\dagger}(x)\\,\\frac{q(x)}{2}\\,dx.\n$$\nFor a uniform isotropic source $q(x)=q_{0}$, and $w_{1}=w_{2}=1$, this becomes\n$$\nR \\;=\\; \\frac{q_{0}}{4}\\,\\sum_{m=1}^{2}\\int_{0}^{X} \\psi_{m}^{\\dagger}(x)\\,dx \\;=\\; \\frac{q_{0}}{4}\\left(\\int_{0}^{X} \\psi_{1}^{\\dagger}(x)\\,dx + \\int_{0}^{X} \\psi_{2}^{\\dagger}(x)\\,dx\\right).\n$$\nCompute the two integrals explicitly:\n$$\n\\int_{0}^{X} \\psi_{2}^{\\dagger}(x)\\,dx \\;=\\; \\int_{0}^{x_{d}} \\frac{s_{0}}{\\mu_{0}}\\,\\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}(x_{d}-x)\\right)\\,dx \\;=\\; \\frac{s_{0}}{\\Sigma_{t}}\\left[1 - \\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}\\,x_{d}\\right)\\right],\n$$\nusing the substitution $y=x_{d}-x$. Similarly,\n$$\n\\int_{0}^{X} \\psi_{1}^{\\dagger}(x)\\,dx \\;=\\; \\int_{x_{d}}^{X} \\frac{s_{0}}{\\mu_{0}}\\,\\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}(x - x_{d})\\right)\\,dx \\;=\\; \\frac{s_{0}}{\\Sigma_{t}}\\left[1 - \\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}(X - x_{d})\\right)\\right].\n$$\nTherefore,\n$$\nR \\;=\\; \\frac{q_{0}}{4}\\,\\frac{s_{0}}{\\Sigma_{t}}\\left(\\left[1 - \\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}\\,x_{d}\\right)\\right] + \\left[1 - \\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}(X - x_{d})\\right)\\right]\\right),\n$$\nwhich simplifies to\n$$\nR \\;=\\; \\frac{q_{0}\\,s_{0}}{4\\,\\Sigma_{t}}\\left(2 - \\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}\\,x_{d}\\right) - \\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}(X - x_{d})\\right)\\right),\n$$\nwith $\\mu_{0}=\\frac{1}{\\sqrt{3}}$.\n\nThis is the desired closed-form analytic expression for the detector response in terms of the given parameters under the $S_{2}$ discrete ordinates approximation, pure absorption, and vacuum boundaries.",
            "answer": "$$\\boxed{\\frac{q_{0}\\,s_{0}}{4\\,\\Sigma_{t}}\\left(2 - \\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}\\,x_{d}\\right) - \\exp\\!\\left(-\\frac{\\Sigma_{t}}{\\mu_{0}}(X - x_{d})\\right)\\right)}$$"
        }
    ]
}