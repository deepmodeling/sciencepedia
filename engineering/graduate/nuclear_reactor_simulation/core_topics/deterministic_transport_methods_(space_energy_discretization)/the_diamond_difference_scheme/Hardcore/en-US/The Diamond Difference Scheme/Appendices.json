{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a fundamental application of the diamond difference scheme. You will start from the basic transport equation to derive the scheme's update relation for a source-free cell and use it to compute the outgoing angular fluxes and the net neutron current . This practice solidifies the core mechanics of the method and introduces the critical concept of the positivity constraint, which dictates the conditions under which the scheme produces physically meaningful, non-negative results.",
            "id": "4237955",
            "problem": "Consider one homogeneous spatial cell in one-dimensional slab geometry spanning from $x=0$ to $x=\\Delta x$, with uniform total macroscopic cross section $\\Sigma_{t}$ and no scattering or fixed source inside the cell. The steady-state neutron transport equation for the angular flux $\\psi(x,\\mu)$ in one-dimensional slab geometry is $ \\mu \\, \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t} \\, \\psi(x,\\mu) = Q(x,\\mu)$, and in this cell $Q(x,\\mu)=0$. The discrete ordinates ($S_N$) approximation is employed with the $S_2$ Gaussian-Legendre quadrature; use the two ordinates $\\mu_{1}=+0.5773502692$ with weight $w_{1}=1.0$ and $\\mu_{2}=-0.5773502692$ with weight $w_{2}=1.0$. The boundary conditions are vacuum at $x=\\Delta x$ for $\\mu0$ and prescribed inflow at $x=0$ for $\\mu>0$: $\\psi(0,\\mu_{1})=\\psi_{\\text{in}}$ and $\\psi(\\Delta x,\\mu_{2})=0$, where $\\psi_{\\text{in}}=1.0 \\times 10^{12}$.\n\nUse the diamond-difference discretization in this single cell, in which the streaming term is approximated by $(\\psi_{R} - \\psi_{L})/\\Delta x$ and the cell-centered flux by $(\\psi_{R} + \\psi_{L})/2$, where $\\psi_{L}=\\psi(0,\\mu)$ and $\\psi_{R}=\\psi(\\Delta x,\\mu)$ denote the cell-edge angular fluxes for a given direction $\\mu$. Starting from the steady-state neutron transport equation and these definitions, derive the relations for the cell-edge angular fluxes $\\psi_{R}$ as functions of $\\psi_{L}$ and the parameters $\\mu$, $\\Sigma_{t}$, and $\\Delta x$ for each discrete direction. Then compute the outgoing angular fluxes at $x=\\Delta x$ for $\\mu_{1}>0$ and $\\mu_{2}0$ under the stated boundary conditions, and deduce the net current through the right face at $x=\\Delta x$, defined as $J_{R}=\\sum_{m} w_{m} \\, \\mu_{m} \\, \\psi(\\Delta x,\\mu_{m})$.\n\nFinally, assess the positivity of the diamond-difference update by identifying the constraint on $\\Sigma_{t} \\, \\Delta x$ relative to $|\\mu|$ under which the computed angular fluxes remain nonnegative in a source-free cell. Report the net current $J_{R}$ as your final answer, rounded to four significant figures, and express it in neutrons per square centimeter per second.\nGiven data: $\\Delta x = 1.0 \\ \\text{cm}$, $\\Sigma_{t} = 0.5 \\ \\text{cm}^{-1}$, $\\psi_{\\text{in}} = 1.0 \\times 10^{12}$, $\\mu_{1} = +0.5773502692$, $w_{1}=1.0$, $\\mu_{2}=-0.5773502692$, $w_{2}=1.0$.",
            "solution": "The problem posed is scientifically sound, well-posed, and contains all necessary information for a unique solution. It is based on fundamental principles of neutron transport theory and standard numerical methods. We may therefore proceed with the solution.\n\nThe problem requires an analysis of a single homogeneous cell in one-dimensional slab geometry using the discrete ordinates ($S_N$) method with a diamond-difference (DD) spatial discretization. The governing equation is the steady-state, source-free neutron transport equation:\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = 0\n$$\nwhere $\\psi(x,\\mu)$ is the angular neutron flux at position $x$ in direction $\\mu$, and $\\Sigma_t$ is the total macroscopic cross section. The discrete ordinates method evaluates this equation at a set of discrete directions $\\mu_m$. For this problem, we use the $S_2$ quadrature set: $\\mu_1 = 0.5773502692$ and $\\mu_2 = -0.5773502692$.\n\nFirst, we derive the general diamond-difference relation. The DD scheme approximates the transport equation over the spatial cell from $x=0$ to $x=\\Delta x$ by evaluating the loss term at the cell center and the streaming term using the cell-edge fluxes. The cell-edge fluxes for a given direction $\\mu$ are denoted $\\psi_L = \\psi(0, \\mu)$ and $\\psi_R = \\psi(\\Delta x, \\mu)$. The DD approximations are:\n$$\n\\frac{\\partial \\psi(x,\\mu)}{\\partial x} \\approx \\frac{\\psi_R - \\psi_L}{\\Delta x}\n$$\n$$\n\\psi_{\\text{cell-average}} \\approx \\frac{\\psi_L + \\psi_R}{2}\n$$\nSubstituting these approximations into the transport equation for a discrete direction $\\mu_m$:\n$$\n\\mu_m \\left( \\frac{\\psi_R - \\psi_L}{\\Delta x} \\right) + \\Sigma_t \\left( \\frac{\\psi_L + \\psi_R}{2} \\right) = 0\n$$\nTo derive the relation for the cell-edge fluxes, we rearrange this algebraic equation. Multiplying by $2\\Delta x$ to clear the denominators gives:\n$$\n2\\mu_m (\\psi_R - \\psi_L) + \\Sigma_t \\Delta x (\\psi_L + \\psi_R) = 0\n$$\nWe gather terms associated with $\\psi_R$ and $\\psi_L$:\n$$\n\\psi_R (2\\mu_m + \\Sigma_t \\Delta x) - \\psi_L (2\\mu_m - \\Sigma_t \\Delta x) = 0\n$$\nThis leads to the desired relation for the outgoing flux $\\psi_R$ as a function of the incoming flux $\\psi_L$ (for $\\mu_m > 0$):\n$$\n\\psi_R = \\psi_L \\left( \\frac{2\\mu_m - \\Sigma_t \\Delta x}{2\\mu_m + \\Sigma_t \\Delta x} \\right)\n$$\nThis is the general diamond-difference update formula for a source-free region.\n\nNext, we assess the positivity of this scheme. An incoming flux $\\psi_{\\text{in}} \\ge 0$ must produce an outgoing flux $\\psi_{\\text{out}} \\ge 0$.\nFor $\\mu_m > 0$, neutrons travel from left to right. Thus, $\\psi_L$ is the incoming flux and $\\psi_R$ is the outgoing flux. For $\\psi_R$ to be non-negative, since $\\psi_L \\ge 0$ and the denominator $(2\\mu_m + \\Sigma_t \\Delta x)$ is always positive, the numerator must be non-negative:\n$$\n2\\mu_m - \\Sigma_t \\Delta x \\ge 0 \\implies \\Sigma_t \\Delta x \\le 2\\mu_m\n$$\nFor $\\mu_m  0$, neutrons travel from right to left. Thus, $\\psi_R$ is the incoming flux and $\\psi_L$ is the outgoing flux. We must express $\\psi_L$ in terms of $\\psi_R$:\n$$\n\\psi_L = \\psi_R \\left( \\frac{2\\mu_m + \\Sigma_t \\Delta x}{2\\mu_m - \\Sigma_t \\Delta x} \\right)\n$$\nLet $\\mu_m = -|\\mu_m|$. Substituting this gives:\n$$\n\\psi_L = \\psi_R \\left( \\frac{-2|\\mu_m| + \\Sigma_t \\Delta x}{-2|\\mu_m| - \\Sigma_t \\Delta x} \\right) = \\psi_R \\left( \\frac{-(2|\\mu_m| - \\Sigma_t \\Delta x)}{-(2|\\mu_m| + \\Sigma_t \\Delta x)} \\right) = \\psi_R \\left( \\frac{2|\\mu_m| - \\Sigma_t \\Delta x}{2|\\mu_m| + \\Sigma_t \\Delta x} \\right)\n$$\nFor $\\psi_L$ to be non-negative, since $\\psi_R \\ge 0$, the numerator must be non-negative:\n$$\n2|\\mu_m| - \\Sigma_t \\Delta x \\ge 0 \\implies \\Sigma_t \\Delta x \\le 2|\\mu_m|\n$$\nThus, the general constraint for the diamond-difference scheme to guarantee non-negative fluxes in a source-free region is $\\Sigma_t \\Delta x \\le 2|\\mu_m|$. The product $\\Sigma_t \\Delta x$ represents the optical thickness of the cell.\n\nWe now check this condition with the given data: $\\Delta x = 1.0 \\, \\text{cm}$, $\\Sigma_t = 0.5 \\, \\text{cm}^{-1}$, and $|\\mu_m|=0.5773502692$.\nThe optical thickness is $\\Sigma_t \\Delta x = (0.5 \\, \\text{cm}^{-1})(1.0 \\, \\text{cm}) = 0.5$.\nThe positivity limit is $2|\\mu_m| = 2(0.5773502692) \\approx 1.1547$.\nSince $0.5  1.1547$, the positivity condition is satisfied for this problem.\n\nNow we compute the angular fluxes at the right face of the cell, $x=\\Delta x$.\nFor the direction $\\mu_1 = 0.5773502692 > 0$, neutrons travel from left to right. The incoming flux is specified by the boundary condition at $x=0$: $\\psi_L = \\psi(0, \\mu_1) = \\psi_{\\text{in}} = 1.0 \\times 10^{12}$. The outgoing flux at $x=\\Delta x$ is $\\psi_R = \\psi(\\Delta x, \\mu_1)$. Using the derived relation:\n$$\n\\psi(\\Delta x, \\mu_1) = \\psi_{\\text{in}} \\left( \\frac{2\\mu_1 - \\Sigma_t \\Delta x}{2\\mu_1 + \\Sigma_t \\Delta x} \\right) = (1.0 \\times 10^{12}) \\left( \\frac{2(0.5773502692) - 0.5}{2(0.5773502692) + 0.5} \\right)\n$$\n$$\n\\psi(\\Delta x, \\mu_1) = (1.0 \\times 10^{12}) \\left( \\frac{1.1547005384 - 0.5}{1.1547005384 + 0.5} \\right) = (1.0 \\times 10^{12}) \\left( \\frac{0.6547005384}{1.6547005384} \\right)\n$$\n$$\n\\psi(\\Delta x, \\mu_1) \\approx 0.395662706 \\times 10^{12}\n$$\nFor the direction $\\mu_2 = -0.5773502692  0$, neutrons travel from right to left. The flux at $x=\\Delta x$ is an incoming flux for the cell, which is specified by the vacuum boundary condition at the right boundary of the domain:\n$$\n\\psi(\\Delta x, \\mu_2) = 0\n$$\n\nFinally, we compute the net current through the right face at $x=\\Delta x$. The definition is given as:\n$$\nJ_R = \\sum_{m} w_{m} \\mu_{m} \\psi(\\Delta x, \\mu_m) = w_1 \\mu_1 \\psi(\\Delta x, \\mu_1) + w_2 \\mu_2 \\psi(\\Delta x, \\mu_2)\n$$\nThe given quadrature weights are $w_1 = 1.0$ and $w_2 = 1.0$. Substituting the values we have found:\n$$\nJ_R = (1.0)(0.5773502692)(0.395662706 \\times 10^{12}) + (1.0)(-0.5773502692)(0)\n$$\n$$\nJ_R = (0.5773502692)(0.395662706 \\times 10^{12}) + 0\n$$\n$$\nJ_R \\approx 0.22842450 \\times 10^{12} = 2.2842450 \\times 10^{11}\n$$\nThe problem requests the answer rounded to four significant figures.\n$$\nJ_R \\approx 2.284 \\times 10^{11}\n$$\nThe units are neutrons per square centimeter per second, as is standard for neutron current.",
            "answer": "$$\\boxed{2.284 \\times 10^{11}}$$"
        },
        {
            "introduction": "While the diamond difference scheme is valued for its second-order accuracy, it is not without limitations. This practice directly explores its primary weakness: the potential to generate unphysical negative fluxes in optically thick cells . By comparing the diamond difference method to the unconditionally positive step-characteristics method and calculating the exact optical thickness $\\tau_{\\text{lim}}$ at which negativity appears for a given test case, you will gain a concrete, quantitative understanding of this important limitation.",
            "id": "4237678",
            "problem": "A one-dimensional, steady-state, monoenergetic transport problem in slab geometry is to be solved for a single discrete-ordinate direction in the Discrete Ordinates (S$_N$) method. Consider a single spatial cell of width $\\Delta x$ bounded by $x=x_L$ and $x=x_R$, with constant total macroscopic cross section $\\Sigma_t$, and define the cell optical thickness $\\tau=\\Sigma_t \\Delta x$. For a given direction cosine $\\mu>0$, the angular flux $\\psi(x)$ satisfies the steady linear Boltzmann transport equation\n$$\n\\mu \\frac{d \\psi}{d x} + \\Sigma_t \\psi = q(x),\n$$\nwhere the within-cell fixed source is linearly varying,\n$$\nq(x) = q_L + \\left(q_R - q_L\\right)\\frac{x-x_L}{\\Delta x},\n$$\nwith $q_L=q(x_L)$ and $q_R=q(x_R)$. The incoming edge flux at $x=x_L$ is prescribed as $\\psi_L=\\psi(x_L)>0$.\n\nPart (a): Starting from the transport equation and the cell-integrated balance, derive the diamond-difference cell-edge relation for the outgoing angular flux $\\psi_R=\\psi(x_R)$ using the standard diamond-difference closure that approximates the within-cell angular flux by the arithmetic average of its edge values and the within-cell source by the arithmetic average of its edge values. From first principles and a local truncation error argument, compare the step-characteristics method (which treats the source as cellwise constant equal to the cell average) and the diamond-difference method in terms of spatial order of accuracy for a linearly varying source. Then, analyze positivity preservation: explain under what conditions each method guarantees nonnegative edge flux given nonnegative input data, and identify the mechanism by which diamond-difference can produce negative flux.\n\nPart (b): Using your derived diamond-difference relation, determine the critical upper bound on optical thickness, denoted $\\tau_{\\text{lim}}$, such that the outgoing edge flux $\\psi_R$ remains nonnegative for the specified test configuration. Compute the numerical value of $\\tau_{\\text{lim}}$ for the following test parameters:\n- Direction cosine $\\mu=0.2$,\n- Cell width $\\Delta x=1.0$,\n- Incoming flux $\\psi_L=4.0\\times 10^{-3}$,\n- Source endpoints $q_L=3.0\\times 10^{-3}$ and $q_R=5.0\\times 10^{-3}$.\n\nExpress the final answer for $\\tau_{\\text{lim}}$ as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem is divided into two parts. Part (a) requires the derivation and analysis of the diamond-difference (DD) and step-characteristics (SC) numerical methods for the one-dimensional transport equation. Part (b) requires the calculation of a critical optical thickness for the DD method given a specific set of parameters.\n\nThe governing equation is the steady-state, monoenergetic linear Boltzmann transport equation in slab geometry for a single discrete direction with cosine $\\mu > 0$:\n$$\n\\mu \\frac{d \\psi}{d x} + \\Sigma_t \\psi = q(x)\n$$\nwhere $\\psi(x)$ is the angular flux, $\\Sigma_t$ is the constant total macroscopic cross section, and $q(x)$ is a linearly varying source term within a spatial cell $[x_L, x_R]$ of width $\\Delta x = x_R - x_L$.\n\n### Part (a): Derivation and Analysis of Numerical Methods\n\n#### 1. Derivation of the Diamond-Difference (DD) Relation\n\nWe begin by integrating the transport equation over the spatial cell from $x=x_L$ to $x=x_R$:\n$$\n\\int_{x_L}^{x_R} \\left( \\mu \\frac{d \\psi}{d x} + \\Sigma_t \\psi \\right) dx = \\int_{x_L}^{x_R} q(x) dx\n$$\nIntegrating term by term, we get:\n$$\n\\mu [\\psi(x)]_{x_L}^{x_R} + \\Sigma_t \\int_{x_L}^{x_R} \\psi(x) dx = \\int_{x_L}^{x_R} q(x) dx\n$$\nLet $\\psi_L = \\psi(x_L)$ and $\\psi_R = \\psi(x_R)$. The equation becomes:\n$$\n\\mu (\\psi_R - \\psi_L) + \\Sigma_t \\int_{x_L}^{x_R} \\psi(x) dx = \\int_{x_L}^{x_R} q(x) dx\n$$\nThis is the exact cell-integrated balance equation. To obtain a discrete relation, we introduce approximations for the integral terms. We define the cell-average flux $\\bar{\\psi}$ and cell-average source $\\bar{q}$ as:\n$$\n\\bar{\\psi} = \\frac{1}{\\Delta x} \\int_{x_L}^{x_R} \\psi(x) dx \\quad \\text{and} \\quad \\bar{q} = \\frac{1}{\\Delta x} \\int_{x_L}^{x_R} q(x) dx\n$$\nThe balance equation can be written as:\n$$\n\\mu (\\psi_R - \\psi_L) + \\Sigma_t \\Delta x \\bar{\\psi} = \\Delta x \\bar{q}\n$$\nThe diamond-difference scheme employs the following closure relations, which approximate the cell-average values as the arithmetic mean of the cell-edge values:\n$$\n\\bar{\\psi} \\approx \\frac{\\psi_L + \\psi_R}{2}\n$$\n$$\n\\bar{q} \\approx \\frac{q_L + q_R}{2}\n$$\nFor the given linearly varying source, $q(x) = q_L + (q_R - q_L)\\frac{x-x_L}{\\Delta x}$, this approximation for the source average is exact:\n$$\n\\bar{q} = \\frac{1}{\\Delta x}\\int_{x_L}^{x_R} \\left[q_L + (q_R - q_L)\\frac{x-x_L}{\\Delta x}\\right] dx = \\frac{1}{\\Delta x} \\left[q_L x + \\frac{q_R-q_L}{\\Delta x} \\frac{(x-x_L)^2}{2}\\right]_{x_L}^{x_R} = q_L + \\frac{q_R-q_L}{2} = \\frac{q_L+q_R}{2}\n$$\nSubstituting the DD closures into the balance equation:\n$$\n\\mu (\\psi_R - \\psi_L) + \\Sigma_t \\Delta x \\left(\\frac{\\psi_L + \\psi_R}{2}\\right) = \\Delta x \\left(\\frac{q_L + q_R}{2}\\right)\n$$\nLet the cell optical thickness be $\\tau = \\Sigma_t \\Delta x$. The equation is:\n$$\n\\mu (\\psi_R - \\psi_L) + \\tau \\left(\\frac{\\psi_L + \\psi_R}{2}\\right) = \\frac{\\Delta x (q_L + q_R)}{2}\n$$\nWe now solve for the outgoing flux $\\psi_R$:\n$$\n\\psi_R \\left(\\mu + \\frac{\\tau}{2}\\right) - \\psi_L \\left(\\mu - \\frac{\\tau}{2}\\right) = \\frac{\\Delta x (q_L + q_R)}{2}\n$$\n$$\n\\psi_R \\left(\\mu + \\frac{\\tau}{2}\\right) = \\psi_L \\left(\\mu - \\frac{\\tau}{2}\\right) + \\frac{\\Delta x (q_L + q_R)}{2}\n$$\nFinally, dividing by $(\\mu + \\tau/2)$, we obtain the diamond-difference cell-edge relation:\n$$\n\\psi_R = \\frac{\\mu - \\tau/2}{\\mu + \\tau/2} \\psi_L + \\frac{\\Delta x (q_L + q_R)}{2(\\mu + \\tau/2)}\n$$\n\n#### 2. Comparison of Spatial Order of Accuracy\n\nThe spatial order of accuracy is determined by the local truncation error (LTE), which is the error incurred in a single step of the method.\n**Diamond Difference (DD):** The DD method is based on the closure relation $\\bar{\\psi} \\approx (\\psi_L + \\psi_R)/2$. This is equivalent to applying the trapezoidal rule for integration, which is known to be second-order accurate. More formally, expanding $\\psi(x)$ in a Taylor series about the cell center, the error in this approximation is found to be proportional to $\\psi'' \\Delta x^2$. Since the source term approximation is exact for a linear source, the LTE of the overall scheme is dominated by the error in the flux approximation, making the DD method second-order accurate in space, i.e., the error is $O(\\Delta x^2)$.\n\n**Step Characteristics (SC):** The SC method solves the transport equation exactly under the assumption that the source term is constant within the cell, equal to its average value $\\bar{q}$. For a linear source as given, the true source $q(x)$ varies across the cell. The approximation $q(x) \\approx \\bar{q}$ is piecewise constant. The error in this source approximation is $q(x) - \\bar{q}$, which is a linear function of position and is $O(\\Delta x)$ at the cell edges relative to the cell center. This first-order error in the source representation leads to a first-order local truncation error for the scheme. Therefore, the SC method is first-order accurate in space, i.e., the error is $O(\\Delta x)$.\n\n**Comparison:** For a problem with a linearly varying source, the diamond-difference method ($O(\\Delta x^2)$) is of a higher order of accuracy than the step-characteristics method ($O(\\Delta x)$). This means that as the mesh size $\\Delta x$ is reduced, the error in the DD solution is expected to decrease more rapidly than the error in the SC solution.\n\n#### 3. Analysis of Positivity Preservation\n\nPositivity is the property that a numerical scheme produces a non-negative outgoing flux ($\\psi_R \\ge 0$) given non-negative inputs (incoming flux $\\psi_L \\ge 0$ and source $q(x) \\ge 0$, which implies $\\bar{q} \\ge 0$).\n\n**Step Characteristics (SC):** The SC solution for a constant source $\\bar{q}$ is:\n$$\n\\psi_R = \\psi_L \\exp(-\\tau/\\mu) + \\frac{\\bar{q}}{\\Sigma_t}(1 - \\exp(-\\tau/\\mu))\n$$\nGiven $\\mu > 0$ and $\\tau \\ge 0$, the term $\\exp(-\\tau/\\mu)$ is always between $0$ and $1$. Consequently, $(1 - \\exp(-\\tau/\\mu))$ is also between $0$ and $1$. If $\\psi_L \\ge 0$ and $\\bar{q} \\ge 0$ (and $\\Sigma_t > 0$), both terms on the right-hand side are non-negative. Therefore, their sum, $\\psi_R$, is guaranteed to be non-negative. The SC method is unconditionally positive.\n\n**Diamond Difference (DD):** The DD relation is:\n$$\n\\psi_R = \\left(\\frac{\\mu - \\tau/2}{\\mu + \\tau/2}\\right) \\psi_L + \\frac{\\Delta x \\bar{q}}{\\mu + \\tau/2}\n$$\nWith non-negative inputs $\\psi_L \\ge 0$ and $\\bar{q} \\ge 0$, the denominator $\\mu + \\tau/2$ is always positive. The source term $\\frac{\\Delta x \\bar{q}}{\\mu + \\tau/2}$ is thus non-negative. However, the coefficient of $\\psi_L$, which is $\\frac{\\mu - \\tau/2}{\\mu + \\tau/2}$, can become negative if $\\mu - \\tau/2  0$, or $\\tau > 2\\mu$.\nIf $\\tau > 2\\mu$, and if the positive source term is not large enough to offset the negative contribution from the incoming flux term, the calculated outgoing flux $\\psi_R$ can become negative. This demonstrates that the DD method is only conditionally positive.\n\n**Mechanism of Negative Flux in DD:** The DD method's core assumption is that the flux profile within the cell is linear. For optically thick cells ($\\tau \\gg 1$), the true flux profile, in the absence of a strong source, exhibits strong exponential attenuation, i.e., $\\psi(x) \\propto \\exp(-\\Sigma_t x / \\mu)$. A linear approximation is a poor representation of a rapidly decaying exponential. The DD method essentially extrapolates a line through the known value $\\psi_L$ and the approximated cell-average $\\bar{\\psi}$. If the cell is too optically thick, this linear extrapolation can undershoot the true (small but positive) value of $\\psi_R$ at the outgoing edge, resulting in an unphysical negative value. The condition $\\tau > 2\\mu$ defines the threshold where this linear approximation becomes particularly prone to failure.\n\n### Part (b): Calculation of Critical Optical Thickness\n\nWe are asked to find the critical upper bound on the optical thickness, $\\tau_{\\text{lim}}$, for which the outgoing flux $\\psi_R$ remains non-negative for the given test case. This limit corresponds to the case where $\\psi_R = 0$.\n\nUsing the derived DD relation from Part (a):\n$$\n\\psi_R = \\frac{\\mu - \\tau/2}{\\mu + \\tau/2} \\psi_L + \\frac{\\Delta x \\bar{q}}{\\mu + \\tau/2}\n$$\nWe set $\\psi_R = 0$ and solve for $\\tau = \\tau_{\\text{lim}}$:\n$$\n0 = \\frac{\\mu - \\tau_{\\text{lim}}/2}{\\mu + \\tau_{\\text{lim}}/2} \\psi_L + \\frac{\\Delta x \\bar{q}}{\\mu + \\tau_{\\text{lim}}/2}\n$$\nMultiplying by the denominator $(\\mu + \\tau_{\\text{lim}}/2)$ gives:\n$$\n0 = (\\mu - \\tau_{\\text{lim}}/2) \\psi_L + \\Delta x \\bar{q}\n$$\nNow, we rearrange the equation to solve for $\\tau_{\\text{lim}}$:\n$$\n\\frac{\\tau_{\\text{lim}}}{2} \\psi_L = \\mu \\psi_L + \\Delta x \\bar{q}\n$$\n$$\n\\tau_{\\text{lim}} = 2 \\left( \\mu + \\frac{\\Delta x \\bar{q}}{\\psi_L} \\right)\n$$\nThis is the analytical expression for the critical optical thickness.\n\nNext, we compute its numerical value using the provided parameters:\n- $\\mu = 0.2$\n- $\\Delta x = 1.0$\n- $\\psi_L = 4.0 \\times 10^{-3}$\n- $q_L = 3.0 \\times 10^{-3}$\n- $q_R = 5.0 \\times 10^{-3}$\n\nFirst, we calculate the average source $\\bar{q}$:\n$$\n\\bar{q} = \\frac{q_L + q_R}{2} = \\frac{(3.0 \\times 10^{-3}) + (5.0 \\times 10^{-3})}{2} = \\frac{8.0 \\times 10^{-3}}{2} = 4.0 \\times 10^{-3}\n$$\nNow, substitute the numerical values into the expression for $\\tau_{\\text{lim}}$:\n$$\n\\tau_{\\text{lim}} = 2 \\left( 0.2 + \\frac{(1.0) \\times (4.0 \\times 10^{-3})}{4.0 \\times 10^{-3}} \\right)\n$$\n$$\n\\tau_{\\text{lim}} = 2 \\left( 0.2 + 1.0 \\right)\n$$\n$$\n\\tau_{\\text{lim}} = 2(1.2)\n$$\n$$\n\\tau_{\\text{lim}} = 2.4\n$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value is $2.4$. Expressed with four significant figures, this becomes $2.400$.",
            "answer": "$$\\boxed{2.400}$$"
        },
        {
            "introduction": "Identifying a numerical scheme's flaws is the first step; designing a practical remedy is the next. This advanced exercise challenges you to engineer a solution to the negative flux issue by creating a \"fixup\" that blends the diamond difference scheme with the more robust step-characteristics method . Crucially, you will also quantify the trade-offs of this correction by evaluating the errors in consistency and conservation, illustrating the important principle that practical fixes in numerical methods often involve a compromise between accuracy, stability, and conservation.",
            "id": "4237673",
            "problem": "Consider one-dimensional, steady-state neutron transport in a homogeneous slab, modeled by the angular flux $\\psi(x,\\mu)$ satisfying the transport equation $\\mu \\,\\frac{d \\psi}{d x} + \\Sigma_{t} \\,\\psi = q$, where $\\mu$ is the direction cosine for one discrete direction in the Discrete Ordinates (SN) method, $\\Sigma_{t}$ is the macroscopic total cross section, and $q$ is a constant angular source term. In a uniform spatial cell of width $\\Delta x$, assume $\\mu > 0$ so that information propagates from the left face to the right face. Denote the incoming angular flux at the left face by $\\psi_{L}$ and the outgoing angular flux at the right face by $\\psi_{R}$.\n\nStarting from the transport equation and without invoking any pre-given update formulas, derive:\n- The exact right-face angular flux obtained by the Step Characteristics (SC) method (defined here as the analytical solution along the characteristic),\n- The right-face angular flux predicted by the Diamond Difference (DD) method (defined here by central differencing of the streaming term and arithmetic averaging of the collision term within the cell).\n\nNext, design a positivity-preserving limiter that blends DD and SC when DD predicts a negative outgoing angular flux. Specifically, define a blended outgoing flux $\\psi_{R}^{\\text{blend}} = w \\,\\psi_{R}^{\\text{DD}} + (1-w)\\,\\psi_{R}^{\\text{SC}}$, where the blending coefficient $w$ is chosen minimally to enforce $\\psi_{R}^{\\text{blend}} \\ge 0$ whenever $\\psi_{R}^{\\text{DD}}  0$, and $w = 1$ otherwise. Provide an explicit expression for $w$ in terms of $\\psi_{R}^{\\text{DD}}$ and $\\psi_{R}^{\\text{SC}}$ under the negative prediction case.\n\nNow quantify, for the blended flux, both a consistency error and a conservation error:\n- Define the consistency error as $E_{\\text{cons}} = \\left|\\psi_{R}^{\\text{blend}} - \\psi_{R}^{\\text{SC}}\\right|$.\n- Define the conservation error via the Diamond Difference cell-balance residual $R = \\frac{\\psi_{R}^{\\text{blend}} - \\psi_{L}}{h} + \\Sigma_{t}\\,\\frac{\\psi_{L} + \\psi_{R}^{\\text{blend}}}{2} - q$, where $h = \\Delta x / \\mu$ is the track length across the cell. Express the conservation error in flux units by $E_{\\text{consrv}} = |R|/\\Sigma_{t}$.\n\nUse the following physically plausible data:\n- $\\Sigma_{t} = 1.5\\,\\text{cm}^{-1}$,\n- $\\Delta x = 3.0\\,\\text{cm}$,\n- $\\mu = 0.2$,\n- $q = 3.0 \\times 10^{-3}\\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$,\n- $\\psi_{L} = 6.0 \\times 10^{-3}\\,\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$.\n\nCompute $\\psi_{R}^{\\text{SC}}$, $\\psi_{R}^{\\text{DD}}$, the blending coefficient $w$ under the negative-DD prediction, and the resulting $\\psi_{R}^{\\text{blend}}$. Then compute $E_{\\text{cons}}$ and $E_{\\text{consrv}}$ as defined above. Round both $E_{\\text{cons}}$ and $E_{\\text{consrv}}$ to four significant figures. Express both error values in $\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$.",
            "solution": "The analysis begins by deriving the expressions for the outgoing flux from the Step Characteristics (SC) and Diamond Difference (DD) methods.\n\n**1. Derivation of the Step Characteristics (SC) Flux**\nThe SC method is defined as the exact analytical solution of the transport equation along the characteristic line. The governing equation is a first-order linear ordinary differential equation for $\\psi(x)$:\n$$ \\mu \\frac{d\\psi}{dx} + \\Sigma_t \\psi = q $$\nRearranging gives:\n$$ \\frac{d\\psi}{dx} + \\frac{\\Sigma_t}{\\mu} \\psi = \\frac{q}{\\mu} $$\nWe solve this using an integrating factor, $I(x) = \\exp\\left(\\int \\frac{\\Sigma_t}{\\mu} dx\\right) = \\exp\\left(\\frac{\\Sigma_t x}{\\mu}\\right)$. Let the cell start at $x=0$ and end at $x=\\Delta x$. The solution is given by:\n$$ \\psi(x) = \\psi(0) \\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right) + \\int_{0}^{x} \\frac{q}{\\mu} \\exp\\left(-\\frac{\\Sigma_t(x-x')}{\\mu}\\right) dx' $$\nWith $\\psi(0) = \\psi_L$ and evaluating at $x=\\Delta x$ to find $\\psi_R = \\psi(\\Delta x)$:\n$$ \\psi_R^{\\text{SC}} = \\psi_L \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right) + \\frac{q}{\\mu} \\int_{0}^{\\Delta x} \\exp\\left(-\\frac{\\Sigma_t(\\Delta x-x')}{\\mu}\\right) dx' $$\nThe integral evaluates to:\n$$ \\int_{0}^{\\Delta x} \\exp\\left(-\\frac{\\Sigma_t(\\Delta x-x')}{\\mu}\\right) dx' = \\left[ \\frac{\\mu}{\\Sigma_t} \\exp\\left(-\\frac{\\Sigma_t(\\Delta x-x')}{\\mu}\\right) \\right]_{0}^{\\Delta x} = \\frac{\\mu}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right)\\right) $$\nSubstituting this back gives the final SC relation:\n$$ \\psi_R^{\\text{SC}} = \\psi_L \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right) + \\frac{q}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right)\\right) $$\n\n**2. Derivation of the Diamond Difference (DD) Flux**\nThe DD method is derived from the balance equation over the cell, obtained by integrating the transport equation from $x=0$ to $x=\\Delta x$:\n$$ \\int_{0}^{\\Delta x} \\left(\\mu \\frac{d\\psi}{dx} + \\Sigma_t \\psi\\right) dx = \\int_{0}^{\\Delta x} q dx $$\n$$ \\mu (\\psi(\\Delta x) - \\psi(0)) + \\Sigma_t \\int_{0}^{\\Delta x} \\psi(x) dx = q \\Delta x $$\nUsing the notation $\\psi_L = \\psi(0)$, $\\psi_R = \\psi(\\Delta x)$, and defining the cell-average flux $\\bar{\\psi} = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\psi(x) dx$, we get:\n$$ \\mu (\\psi_R - \\psi_L) + \\Sigma_t \\bar{\\psi} \\Delta x = q \\Delta x $$\nThe DD scheme approximates the cell-average flux with the arithmetic mean of the face fluxes:\n$$ \\bar{\\psi} \\approx \\frac{\\psi_L + \\psi_R}{2} $$\nSubstituting this into the balance equation gives the DD discrete equation:\n$$ \\mu (\\psi_R^{\\text{DD}} - \\psi_L) + \\Sigma_t \\Delta x \\left(\\frac{\\psi_L + \\psi_R^{\\text{DD}}}{2}\\right) = q \\Delta x $$\nWe now solve for the unknown outgoing flux, $\\psi_R^{\\text{DD}}$:\n$$ \\psi_R^{\\text{DD}} \\left(\\mu + \\frac{\\Sigma_t \\Delta x}{2}\\right) - \\psi_L \\left(\\mu - \\frac{\\Sigma_t \\Delta x}{2}\\right) = q \\Delta x $$\n$$ \\psi_R^{\\text{DD}} \\left(2\\mu + \\Sigma_t \\Delta x\\right) = \\psi_L \\left(2\\mu - \\Sigma_t \\Delta x\\right) + 2q \\Delta x $$\n$$ \\psi_R^{\\text{DD}} = \\frac{(2\\mu - \\Sigma_t \\Delta x) \\psi_L + 2q \\Delta x}{2\\mu + \\Sigma_t \\Delta x} $$\n\n**3. Numerical Computations**\nWe substitute the given data: $\\Sigma_{t} = 1.5$, $\\Delta x = 3.0$, $\\mu = 0.2$, $q = 3.0 \\times 10^{-3}$, and $\\psi_{L} = 6.0 \\times 10^{-3}$.\n\nFirst, we compute the optical thickness of the cell along the characteristic:\n$$ \\tau = \\frac{\\Sigma_t \\Delta x}{\\mu} = \\frac{1.5 \\times 3.0}{0.2} = \\frac{4.5}{0.2} = 22.5 $$\nThe exponential term is $\\exp(-\\tau) = \\exp(-22.5) \\approx 1.703 \\times 10^{-10}$.\n\nNow, we compute $\\psi_R^{\\text{SC}}$:\n$$ \\psi_R^{\\text{SC}} = (6.0 \\times 10^{-3}) \\exp(-22.5) + \\frac{3.0 \\times 10^{-3}}{1.5} (1 - \\exp(-22.5)) $$\n$$ \\psi_R^{\\text{SC}} = (6.0 \\times 10^{-3}) \\exp(-22.5) + (2.0 \\times 10^{-3}) (1 - \\exp(-22.5)) $$\n$$ \\psi_R^{\\text{SC}} = 2.0 \\times 10^{-3} + (4.0 \\times 10^{-3}) \\exp(-22.5) $$\n$$ \\psi_R^{\\text{SC}} \\approx 2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})(1.703 \\times 10^{-10}) \\approx 2.0 \\times 10^{-3} $$\nTo high precision, $\\psi_R^{\\text{SC}} \\approx 2.0000... \\times 10^{-3}$.\n\nNext, we compute $\\psi_R^{\\text{DD}}$:\n$$ \\psi_R^{\\text{DD}} = \\frac{(2(0.2) - 1.5 \\times 3.0)(6.0 \\times 10^{-3}) + 2(3.0 \\times 10^{-3})(3.0)}{2(0.2) + 1.5 \\times 3.0} $$\n$$ \\psi_R^{\\text{DD}} = \\frac{(0.4 - 4.5)(6.0 \\times 10^{-3}) + 1.8 \\times 10^{-2}}{0.4 + 4.5} $$\n$$ \\psi_R^{\\text{DD}} = \\frac{(-4.1)(6.0 \\times 10^{-3}) + 1.8 \\times 10^{-2}}{4.9} = \\frac{-2.46 \\times 10^{-2} + 1.8 \\times 10^{-2}}{4.9} $$\n$$ \\psi_R^{\\text{DD}} = \\frac{-0.66 \\times 10^{-2}}{4.9} = \\frac{-6.6 \\times 10^{-3}}{4.9} \\approx -1.346938... \\times 10^{-3} $$\nAs anticipated, the DD method predicts a negative outgoing flux.\n\n**4. Blending Coefficient and Blended Flux**\nSince $\\psi_R^{\\text{DD}}  0$, we must find the minimal blending coefficient $w$ that makes $\\psi_R^{\\text{blend}} \\ge 0$. This is achieved by setting $\\psi_R^{\\text{blend}} = 0$.\n$$ \\psi_{R}^{\\text{blend}} = w \\psi_{R}^{\\text{DD}} + (1-w)\\psi_{R}^{\\text{SC}} = 0 $$\n$$ w \\psi_{R}^{\\text{DD}} + \\psi_{R}^{\\text{SC}} - w \\psi_{R}^{\\text{SC}} = 0 $$\n$$ w (\\psi_{R}^{\\text{SC}} - \\psi_{R}^{\\text{DD}}) = \\psi_{R}^{\\text{SC}} $$\n$$ w = \\frac{\\psi_{R}^{\\text{SC}}}{\\psi_{R}^{\\text{SC}} - \\psi_{R}^{\\text{DD}}} $$\nSubstituting the computed values:\n$$ w = \\frac{2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})\\exp(-22.5)}{ (2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})\\exp(-22.5)) - (-\\frac{6.6 \\times 10^{-3}}{4.9}) } $$\nIgnoring the negligible $\\exp(-22.5)$ term for this calculation:\n$$ w \\approx \\frac{2.0 \\times 10^{-3}}{2.0 \\times 10^{-3} + \\frac{6.6}{4.9} \\times 10^{-3}} = \\frac{2}{2 + \\frac{66}{49}} = \\frac{2}{\\frac{98+66}{49}} = \\frac{2 \\times 49}{164} = \\frac{98}{164} = \\frac{49}{82} $$\n$$ w \\approx 0.59756... $$\nBy design of the limiter, the resulting blended flux is $\\psi_R^{\\text{blend}} = 0$.\n\n**5. Error Quantification**\nWe now compute the two defined error metrics using $\\psi_R^{\\text{blend}} = 0$.\n\n**Consistency Error:**\nThe consistency error measures the deviation from the exact characteristic solution.\n$$ E_{\\text{cons}} = |\\psi_{R}^{\\text{blend}} - \\psi_{R}^{\\text{SC}}| = |0 - \\psi_{R}^{\\text{SC}}| = \\psi_{R}^{\\text{SC}} $$\n$$ E_{\\text{cons}} = 2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})\\exp(-22.5) $$\n$$ E_{\\text{cons}} \\approx 2.0 \\times 10^{-3} + 6.812 \\times 10^{-13} $$\nRounding to four significant figures, $E_{\\text{cons}} = 2.000 \\times 10^{-3} \\, \\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$.\n\n**Conservation Error:**\nThe conservation error is based on the residual of the DD balance equation. First, we compute the track length $h$:\n$$ h = \\frac{\\Delta x}{\\mu} = \\frac{3.0}{0.2} = 15.0 \\, \\text{cm} $$\nNext, we compute the residual $R$ with $\\psi_{R}^{\\text{blend}} = 0$:\n$$ R = \\frac{0 - \\psi_{L}}{h} + \\Sigma_{t}\\frac{\\psi_{L} + 0}{2} - q $$\n$$ R = -\\frac{6.0 \\times 10^{-3}}{15.0} + 1.5 \\times \\frac{6.0 \\times 10^{-3}}{2} - 3.0 \\times 10^{-3} $$\n$$ R = -0.4 \\times 10^{-3} + 1.5 \\times (3.0 \\times 10^{-3}) - 3.0 \\times 10^{-3} $$\n$$ R = -0.4 \\times 10^{-3} + 4.5 \\times 10^{-3} - 3.0 \\times 10^{-3} $$\n$$ R = (4.5 - 0.4 - 3.0) \\times 10^{-3} = 1.1 \\times 10^{-3} \\, \\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1} $$\nThe conservation error in flux units is:\n$$ E_{\\text{consrv}} = \\frac{|R|}{\\Sigma_{t}} = \\frac{1.1 \\times 10^{-3}}{1.5} = \\frac{11}{15} \\times 10^{-3} \\approx 0.733333... \\times 10^{-3} $$\nRounding to four significant figures, $E_{\\text{consrv}} = 7.333 \\times 10^{-4} \\, \\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.000 \\times 10^{-3}  7.333 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}