{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在奠定基础。它将引导您在简化情景下，从中子输运方程出发，推导出核心的菱形差分更新关系式。通过计算净中子流，本练习将数值格式与一个关键物理量直接联系起来，从而加深对角通量物理意义的理解。同时，它还引入了至关重要的正性约束概念，这是分析菱形差分法时一个反复出现的主题。",
            "id": "4237955",
            "problem": "考虑一维平板几何中的一个均匀空间网格，范围从 $x=0$ 到 $x=\\Delta x$，其中总宏观截面 $\\Sigma_{t}$ 均匀，且网格内部无散射或固定源。一维平板几何中角通量 $\\psi(x,\\mu)$ 的稳态中子输运方程为 $ \\mu \\, \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t} \\, \\psi(x,\\mu) = Q(x,\\mu)$，且在该网格中 $Q(x,\\mu)=0$。采用离散纵标（SN）近似，并使用 $S_{2}$ 高斯-勒让德求积；使用两个纵标 $\\mu_{1}=+0.5773502692$（权重 $w_{1}=1.0$）和 $\\mu_{2}=-0.5773502692$（权重 $w_{2}=1.0$）。边界条件为：对于 $\\mu  0$，在 $x=\\Delta x$ 处为真空；对于 $\\mu0$，在 $x=0$ 处为给定流入：$\\psi(0,\\mu_{1})=\\psi_{\\text{in}}$ 和 $\\psi(\\Delta x,\\mu_{2})=0$，其中 $\\psi_{\\text{in}}=1.0 \\times 10^{12}$。\n\n在该单一网格中使用菱形差分格式，其中流项近似为 $(\\psi_{R} - \\psi_{L})/\\Delta x$，网格中心通量近似为 $(\\psi_{R} + \\psi_{L})/2$，其中 $\\psi_{L}=\\psi(0,\\mu)$ 和 $\\psi_{R}=\\psi(\\Delta x,\\mu)$ 表示给定方向 $\\mu$ 的网格边界角通量。从稳态中子输运方程和这些定义出发，推导每个离散方向上网格边界角通量 $\\psi_{R}$ 作为 $\\psi_{L}$ 以及参数 $\\mu$、$\\Sigma_{t}$ 和 $\\Delta x$ 的函数关系。然后，在所述边界条件下，计算在 $x=\\Delta x$ 处 $\\mu_{1}0$ 和 $\\mu_{2}  0$ 的出射角通量，并推导出通过右侧面（$x=\\Delta x$）的净流，其定义为 $J_{R}=\\sum_{m} w_{m} \\, \\mu_{m} \\, \\psi(\\Delta x,\\mu_{m})$。\n\n最后，通过确定在无源网格中计算出的角通量保持非负时，$\\Sigma_{t} \\, \\Delta x$ 相对于 $|\\mu|$ 所需满足的约束条件，来评估菱形差分更新的正性。将净流 $J_{R}$ 作为最终答案，四舍五入到四位有效数字，并以中子数/平方厘米·秒为单位表示。\n给定数据：$\\Delta x = 1.0 \\ \\text{cm}$，$\\Sigma_{t} = 0.5 \\ \\text{cm}^{-1}$，$\\psi_{\\text{in}} = 1.0 \\times 10^{12}$，$\\mu_{1} = +0.5773502692$，$w_{1}=1.0$，$\\mu_{2}=-0.5773502692$，$w_{2}=1.0$。",
            "solution": "所提出的问题在科学上是合理的，提法恰当，并包含了唯一解所需的所有必要信息。它基于中子输运理论的基本原理和标准数值方法。因此，我们可以着手求解。\n\n该问题要求使用离散纵标（$S_N$）方法和菱形差分（DD）空间离散格式，对一维平板几何中的单个均匀网格进行分析。控制方程是稳态、无源的中子输运方程：\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = 0\n$$\n其中 $\\psi(x,\\mu)$ 是位置 $x$ 处方向 $\\mu$ 上的角中子通量，$\\Sigma_t$ 是总宏观截面。离散纵标法在一组离散方向 $\\mu_m$ 上求解此方程。对于本问题，我们使用 $S_2$ 求积组：$\\mu_1 = 0.5773502692$ 和 $\\mu_2 = -0.5773502692$。\n\n首先，我们推导通用的菱形差分关系式。DD格式通过在网格中心评估损失项，并使用网格边界通量评估流项，来近似求解空间网格从 $x=0$ 到 $x=\\Delta x$ 上的输运方程。给定方向 $\\mu$ 的网格边界通量表示为 $\\psi_L = \\psi(0, \\mu)$ 和 $\\psi_R = \\psi(\\Delta x, \\mu)$。DD近似为：\n$$\n\\frac{\\partial \\psi(x,\\mu)}{\\partial x} \\approx \\frac{\\psi_R - \\psi_L}{\\Delta x}\n$$\n$$\n\\psi_{\\text{cell-average}} \\approx \\frac{\\psi_L + \\psi_R}{2}\n$$\n将这些近似代入离散方向 $\\mu_m$ 的输运方程中：\n$$\n\\mu_m \\left( \\frac{\\psi_R - \\psi_L}{\\Delta x} \\right) + \\Sigma_t \\left( \\frac{\\psi_L + \\psi_R}{2} \\right) = 0\n$$\n为了推导网格边界通量的关系式，我们重排这个代数方程。两边乘以 $2\\Delta x$ 以消去分母，得到：\n$$\n2\\mu_m (\\psi_R - \\psi_L) + \\Sigma_t \\Delta x (\\psi_L + \\psi_R) = 0\n$$\n我们合并与 $\\psi_R$ 和 $\\psi_L$ 相关的项：\n$$\n\\psi_R (2\\mu_m + \\Sigma_t \\Delta x) - \\psi_L (2\\mu_m - \\Sigma_t \\Delta x) = 0\n$$\n这就得到了出射通量 $\\psi_R$ 作为入射通量 $\\psi_L$ （对于 $\\mu_m  0$）的函数关系式：\n$$\n\\psi_R = \\psi_L \\left( \\frac{2\\mu_m - \\Sigma_t \\Delta x}{2\\mu_m + \\Sigma_t \\Delta x} \\right)\n$$\n这就是无源区域的通用菱形差分更新公式。\n\n接下来，我们评估该格式的正性。入射通量 $\\psi_{\\text{in}} \\ge 0$ 必须产生出射通量 $\\psi_{\\text{out}} \\ge 0$。\n对于 $\\mu_m  0$，中子从左向右运动。因此，$\\psi_L$ 是入射通量，$\\psi_R$ 是出射通量。为了使 $\\psi_R$ 非负，由于 $\\psi_L \\ge 0$ 且分母 $(2\\mu_m + \\Sigma_t \\Delta x)$ 恒为正，分子必须非负：\n$$\n2\\mu_m - \\Sigma_t \\Delta x \\ge 0 \\implies \\Sigma_t \\Delta x \\le 2\\mu_m\n$$\n对于 $\\mu_m  0$，中子从右向左运动。因此，$\\psi_R$ 是入射通量，$\\psi_L$ 是出射通量。我们必须用 $\\psi_R$ 来表示 $\\psi_L$：\n$$\n\\psi_L = \\psi_R \\left( \\frac{2\\mu_m + \\Sigma_t \\Delta x}{2\\mu_m - \\Sigma_t \\Delta x} \\right)\n$$\n令 $\\mu_m = -|\\mu_m|$。代入后得到：\n$$\n\\psi_L = \\psi_R \\left( \\frac{-2|\\mu_m| + \\Sigma_t \\Delta x}{-2|\\mu_m| - \\Sigma_t \\Delta x} \\right) = \\psi_R \\left( \\frac{-(2|\\mu_m| - \\Sigma_t \\Delta x)}{-(2|\\mu_m| + \\Sigma_t \\Delta x)} \\right) = \\psi_R \\left( \\frac{2|\\mu_m| - \\Sigma_t \\Delta x}{2|\\mu_m| + \\Sigma_t \\Delta x} \\right)\n$$\n为了使 $\\psi_L$ 非负，由于 $\\psi_R \\ge 0$，分子必须非负：\n$$\n2|\\mu_m| - \\Sigma_t \\Delta x \\ge 0 \\implies \\Sigma_t \\Delta x \\le 2|\\mu_m|\n$$\n因此，菱形差分格式在无源区域保证通量非负的通用约束条件是 $\\Sigma_t \\Delta x \\le 2|\\mu_m|$。乘积 $\\Sigma_t \\Delta x$ 代表了网格的光学厚度。\n\n现在我们用给定数据来检验这个条件：$\\Delta x = 1.0 \\, \\text{cm}$，$\\Sigma_t = 0.5 \\, \\text{cm}^{-1}$，以及 $|\\mu_m|=0.5773502692$。\n光学厚度为 $\\Sigma_t \\Delta x = (0.5 \\, \\text{cm}^{-1})(1.0 \\, \\text{cm}) = 0.5$。\n正性极限为 $2|\\mu_m| = 2(0.5773502692) \\approx 1.1547$。\n由于 $0.5  1.1547$，本问题满足正性条件。\n\n现在我们计算网格右侧面 $x=\\Delta x$ 处的角通量。\n对于方向 $\\mu_1 = 0.5773502692  0$，中子从左向右运动。入射通量由 $x=0$ 处的边界条件指定：$\\psi_L = \\psi(0, \\mu_1) = \\psi_{\\text{in}} = 1.0 \\times 10^{12}$。在 $x=\\Delta x$ 处的出射通量为 $\\psi_R = \\psi(\\Delta x, \\mu_1)$。使用推导出的关系式：\n$$\n\\psi(\\Delta x, \\mu_1) = \\psi_{\\text{in}} \\left( \\frac{2\\mu_1 - \\Sigma_t \\Delta x}{2\\mu_1 + \\Sigma_t \\Delta x} \\right) = (1.0 \\times 10^{12}) \\left( \\frac{2(0.5773502692) - 0.5}{2(0.5773502692) + 0.5} \\right)\n$$\n$$\n\\psi(\\Delta x, \\mu_1) = (1.0 \\times 10^{12}) \\left( \\frac{1.1547005384 - 0.5}{1.1547005384 + 0.5} \\right) = (1.0 \\times 10^{12}) \\left( \\frac{0.6547005384}{1.6547005384} \\right)\n$$\n$$\n\\psi(\\Delta x, \\mu_1) \\approx 0.395662706 \\times 10^{12}\n$$\n对于方向 $\\mu_2 = -0.5773502692  0$，中子从右向左运动。在 $x=\\Delta x$ 处的通量是进入该网格的入射通量，由计算区域右边界的真空边界条件指定：\n$$\n\\psi(\\Delta x, \\mu_2) = 0\n$$\n\n最后，我们计算通过右侧面 $x=\\Delta x$ 的净流。其定义为：\n$$\nJ_R = \\sum_{m} w_{m} \\mu_{m} \\psi(\\Delta x, \\mu_m) = w_1 \\mu_1 \\psi(\\Delta x, \\mu_1) + w_2 \\mu_2 \\psi(\\Delta x, \\mu_2)\n$$\n给定的求积权重为 $w_1 = 1.0$ 和 $w_2 = 1.0$。代入我们已求得的值：\n$$\nJ_R = (1.0)(0.5773502692)(0.395662706 \\times 10^{12}) + (1.0)(-0.5773502692)(0)\n$$\n$$\nJ_R = (0.5773502692)(0.395662706 \\times 10^{12}) + 0\n$$\n$$\nJ_R \\approx 0.22842450 \\times 10^{12} = 2.2842450 \\times 10^{11}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nJ_R \\approx 2.284 \\times 10^{11}\n$$\n单位是中子数/平方厘米·秒，这是中子流的标准单位。",
            "answer": "$$\\boxed{2.284 \\times 10^{11}}$$"
        },
        {
            "introduction": "在初步了解正性概念的基础上，本练习将深入探讨其更深层次的含义。它要求您将正性条件形式化为光学厚度的函数，并探索其与源迭代方法稳定性和收敛性之间的联系。理解这种联系对于开发稳健可靠的输运求解器至关重要，因为它揭示了非物理的负通量值会如何破坏整个迭代过程。",
            "id": "4250966",
            "problem": "考虑平板几何中的一维、稳态、单能线性输运方程，其角通量为 $\\,\\psi(x,\\mu)\\,$，\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t(x)\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_s(x)}{2}\\,\\phi(x) \\;+\\; \\frac{q(x)}{2}\\,,\n$$\n其中标量通量 $\\,\\phi(x) = \\int_{-1}^{1}\\psi(x,\\mu)\\,d\\mu\\,$, 总宏观截面 $\\,\\Sigma_t(x)  0\\,$, 散射截面 $\\,\\Sigma_s(x) \\in [0,\\Sigma_t(x))\\,$, 以及各向同性固定外源 $\\,q(x) \\ge 0\\,$. 使用离散纵标 (SN) 方法在一组方向 $\\{\\mu_m, w_m\\}_{m=1}^{M}$ 上对角度进行离散化，其中 $\\mu_m \\in (-1,1)$ 且正权重 $\\{w_m\\}$ 满足 $\\sum_{m=1}^{M} w_m = 2$。在单元宽度为 $\\,h  0\\,$ 的均匀网格上对空间进行离散化，单元边界位于 $\\,x_{i \\pm 1/2}\\,$，并采用标准的单元平衡有限体积格式以及菱形差分封闭关系\n$$\n\\psi_{i,m} \\;=\\; \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right)\\,,\n$$\n其中 $\\,\\psi_{i\\pm \\frac{1}{2},m}\\,$ 是边界值，$\\,\\psi_{i,m}\\,$ 是方向 $\\,\\mu_m\\,$ 上的单元平均替代值。\n\n(a) 从给定方向 $\\,\\mu_m  0\\,$ 上单元 $\\,i\\,$ 的输运方程的单元平衡形式出发，推导线性扫描关系\n$$\n\\psi_{i+\\frac{1}{2},m} \\;=\\; \\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m} \\;+\\; \\beta_{i,m}\\,Q_{i,m}\\,,\n$$\n其中 $\\,Q_{i,m}\\,$ 是当前迭代中方向 $\\,\\mu_m\\,$ 上已知的单元平均总源（包括外源和散射贡献）。用 $\\,\\mu_m\\,$, $\\,h\\,$ 和 $\\,\\Sigma_{t,i}\\,$ 表示 $\\,\\alpha_{i,m}\\,$ 和 $\\,\\beta_{i,m}\\,$。确定这些系数需满足何种条件，以确保非负的入射角通量 $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ 和非负的源 $\\,Q_{i,m} \\ge 0\\,$ 能产生非负的出射角通量 $\\,\\psi_{i+\\frac{1}{2},m} \\ge 0\\,$。解释在什么条件下菱形差分离散格式可能会违反正性。\n\n(b) 使用您的表达式，将正性条件简化为关于每个角度、每个单元的光学厚度的单个充分不等式\n$$\n\\tau_{i,m} \\;:=\\; \\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|}\\,.\n$$\n将得到的界限表述为一个明确的不等式，该不等式关联了所有单元 $\\,i\\,$ 和所有角度 $\\,m\\,$ 的 $\\,\\Sigma_{t,i}\\,$, $\\,h\\,$ 和 $\\,|\\mu_m|\\,$。\n\n(c) 考虑散射比为 $\\,c := \\Sigma_s/\\Sigma_t \\in [0,1)\\,$ 的各向同性散射的源迭代。设标量通量的更新定义为：在每次迭代中，使用总源 $\\,Q_{i,m}^{(k)} = \\frac{1}{2} q_i + \\frac{\\Sigma_{s,i}}{2}\\,\\phi_i^{(k)}\\,$ 求解输运方程，并通过加权求和由新的角通量构建 $\\,\\phi^{(k+1)}\\,$。证明，如果由菱形差分离散定义的输运扫描算子在 (a) 部分的意义上是正的，那么从 $\\,\\phi^{(0)} \\equiv 0\\,$ 开始且对于 $\\,q_i \\ge 0\\,$，迭代序列 $\\,\\phi^{(k)}\\,$ 在由分量不等式诱导的偏序下形成一个单调不减序列。\n\n(d) 最后，对于一个均匀平板，其 $\\,\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}\\,$，且一个对称加权求积的最小正方向余弦为 $\\,\\mu_{\\min} = 0.183434642\\,$，计算以 $\\,\\mathrm{cm}\\,$ 为单位的最大均匀单元宽度 $\\,h_{\\max}\\,$，该宽度保证了在 (a)–(c) 部分建立的菱形差分下源迭代更新的单调性。将您的答案四舍五入到 $\\,4\\,$ 位有效数字，并以 $\\,\\mathrm{cm}\\,$ 表示。",
            "solution": "我们从在角度和空间上离散化的一维、稳态、单能线性输运方程开始。对于一个宽度为 $\\,h\\,$、范围为 $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}}]\\,$ 的给定单元 $\\,i\\,$ 和一个方向 $\\,\\mu_m  0\\,$，该单元上的有限体积平衡给出\n$$\n\\mu_m\\,\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} \\;+\\; \\Sigma_{t,i}\\,\\psi_{i,m} \\;=\\; Q_{i,m}\\,,\n$$\n其中 $\\,Q_{i,m}\\,$ 是当前迭代中方向 $\\,m\\,$ 上单元内每球面度的已知总源，而 $\\,\\psi_{i,m}\\,$ 由菱形差分关系封闭。\n$$\n\\psi_{i,m} \\;=\\; \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right)\\,.\n$$\n\n(a) 部分。将菱形差分封闭关系代入平衡方程，得到\n$$\n\\mu_m\\,\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} \\;+\\; \\Sigma_{t,i}\\,\\frac{\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}}{2} \\;=\\; Q_{i,m}\\,.\n$$\n将位于 $\\,x_{i+\\frac{1}{2}}\\,$ 的未知数收集到左边：\n$$\n\\left(\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i+\\frac{1}{2},m} \\;+\\; \\left(-\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i-\\frac{1}{2},m} \\;=\\; Q_{i,m}\\,.\n$$\n求解 $\\,\\psi_{i+\\frac{1}{2},m}\\,$ 得到线性扫描关系\n$$\n\\psi_{i+\\frac{1}{2},m} \\;=\\; \\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m} \\;+\\; \\beta_{i,m}\\,Q_{i,m}\\,,\n$$\n系数为\n$$\n\\alpha_{i,m} \\;=\\; \\frac{\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}} \\;=\\; \\frac{2\\,\\frac{\\mu_m}{h} - \\Sigma_{t,i}}{2\\,\\frac{\\mu_m}{h} + \\Sigma_{t,i}}\\,,\n\\qquad\n\\beta_{i,m} \\;=\\; \\frac{1}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}}\\,.\n$$\n对于 $\\,\\mu_m  0\\,$, $\\,h  0\\,$ 和 $\\,\\Sigma_{t,i}  0\\,$，分母 $\\,\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\,$ 恒为正。因此 $\\,\\beta_{i,m}  0\\,$ 总是成立。$\\,\\alpha_{i,m}\\,$ 的符号由分子 $\\,\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}\\,$ 决定。如果 $\\,\\alpha_{i,m} \\ge 0\\,$ 且 $\\,\\beta_{i,m}  0\\,$，那么对于 $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ 和 $\\,Q_{i,m} \\ge 0\\,$，我们有 $\\,\\psi_{i+\\frac{1}{2},m} \\ge 0\\,$，从而确立了在该方向上扫描更新的正性。相反，如果 $\\,\\alpha_{i,m}  0\\,$，那么即使 $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ 且 $\\,Q_{i,m} \\ge 0\\,$，项 $\\,\\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m}\\,$ 也变为非正；如果它超过了 $\\,\\beta_{i,m}\\,Q_{i,m}\\,$，就可能产生 $\\,\\psi_{i+\\frac{1}{2},m}  0\\,$。因此，当 $\\,\\alpha_{i,m}  0\\,$ 时，菱形差分离散格式可能违反正性，这种情况发生在光学足够厚的单元中。\n\n(b) 部分。引入每个角度、每个单元的光学厚度\n$$\n\\tau_{i,m} \\;:=\\; \\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|}\\,.\n$$\n对于 $\\,\\mu_m  0\\,$，我们有\n$$\n\\alpha_{i,m} \\;=\\; \\frac{2 - \\tau_{i,m}}{2 + \\tau_{i,m}}\\,.\n$$\n对于非负入射通量和非负源，扫描映射的正性当且仅当 $\\,\\alpha_{i,m} \\ge 0\\,$ 和 $\\,\\beta_{i,m}  0\\,$ 时得到保证。如前所述，$\\,\\beta_{i,m}  0\\,$ 总是成立。因此，充分条件简化为\n$$\n\\alpha_{i,m} \\;\\ge\\; 0 \\quad \\Longleftrightarrow \\quad 2 - \\tau_{i,m} \\;\\ge\\; 0 \\quad \\Longleftrightarrow \\quad \\tau_{i,m} \\;\\le\\; 2\\,.\n$$\n根据对称性，对于 $\\,\\mu_m  0\\,$，使用 $\\,|\\mu_m|\\,$ 的相同条件也适用。因此，菱形差分扫描在每个单元和每个离散方向上保持正性的一个充分条件是\n$$\n\\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|} \\;\\le\\; 2 \\quad \\text{对于所有单元 } i \\text{ 和所有角度 } m\\,,\n$$\n等价地，\n$$\nh \\;\\le\\; \\frac{2\\,|\\mu_m|}{\\Sigma_{t,i}} \\quad \\text{对于所有 } i,m\\,.\n$$\n在给定的网格和角度集上，最严格的界限使用最小的正方向余弦 $\\,\\mu_{\\min} := \\min_{m:\\, \\mu_m  0} \\mu_m\\,$ 和最大的单元总截面 $\\,\\Sigma_{t,\\max} := \\max_i \\Sigma_{t,i}\\,$，从而给出全局充分条件\n$$\nh \\;\\le\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_{t,\\max}}\\,.\n$$\n\n(c) 部分。令 $\\,\\mathcal{L}\\,$ 表示输运算子，它将角通量映射到其流输加吸收的残差，该算子已通过菱形差分在空间和角度上离散化。令 $\\,\\mathcal{L}^{-1}\\,$ 表示相应的扫描算子，它将给定的总源 $\\,Q\\,$ 映射到唯一的迎风格式角通量 $\\,\\psi\\,$。在 (b) 部分的条件下，每个单元-角度的扫描更新都具有仅依赖于局部数据的非负系数，因此 $\\,\\mathcal{L}^{-1}\\,$ 是一个正线性算子：对于任意两个总源 $\\,Q,Q'\\,$，若按分量有 $\\,Q \\ge Q'\\,$，则按分量有 $\\,\\mathcal{L}^{-1}Q \\ge \\mathcal{L}^{-1}Q'\\,$。\n\n对于散射比为 $\\,c = \\Sigma_s/\\Sigma_t \\in [0,1)\\,$ 的各向同性散射，定义正线性散射算子 $\\,\\mathcal{S}\\,$，它将标量通量 $\\,\\phi\\,$ 映射到各向同性角源，其分量为 $\\,(\\mathcal{S}\\phi)_{i,m} = \\frac{\\Sigma_{s,i}}{2}\\,\\phi_i\\,$。外源 $\\,q\\,$ 诱导一个非负的各向同性角源 $\\,\\mathcal{Q}_{\\mathrm{ext}}\\,$，其分量为 $\\,(\\mathcal{Q}_{\\mathrm{ext}})_{i,m} = \\frac{q_i}{2}\\,$。源迭代是定点迭代\n$$\n\\psi^{(k+1)} \\;=\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k)}\\right), \\qquad \\phi^{(k+1)} \\;=\\; \\sum_{m=1}^{M} w_m\\,\\psi^{(k+1)}_{(\\cdot),m}\\,,\n$$\n初始条件为 $\\,\\phi^{(0)} \\equiv 0\\,$。令角通量到标量通量的平均算子 $\\,\\mathcal{A}\\,$ 定义为 $\\,\\mathcal{A}\\psi = \\sum_{m=1}^{M} w_m\\,\\psi_{(\\cdot),m}\\,$；该算子具有非负权重，因此在序的意义上是正的。\n\n我们用归纳法证明 $\\,\\phi^{(k)}\\,$ 是单调不减的。基础情形：$\\,\\phi^{(0)} = 0\\,$。那么 $\\,\\psi^{(1)} = \\mathcal{L}^{-1}\\mathcal{Q}_{\\mathrm{ext}} \\ge 0\\,$，因为 $\\,\\mathcal{Q}_{\\mathrm{ext}} \\ge 0\\,$ 且 $\\,\\mathcal{L}^{-1}\\,$ 是正的。因此 $\\,\\phi^{(1)} = \\mathcal{A}\\psi^{(1)} \\ge 0 = \\phi^{(0)}\\,$。假设 $\\,\\phi^{(k)} \\ge \\phi^{(k-1)}\\,$。由于 $\\,\\mathcal{S}\\,$ 是正的，所以 $\\,\\mathcal{S}\\,\\phi^{(k)} \\ge \\mathcal{S}\\,\\phi^{(k-1)}\\,$。因此\n$$\n\\psi^{(k+1)} \\;=\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k)}\\right) \\;\\ge\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k-1)}\\right) \\;=\\; \\psi^{(k)}\\,,\n$$\n这是根据 $\\,\\mathcal{L}^{-1}\\,$ 的正性得出的。应用正平均算子 $\\,\\mathcal{A}\\,$，我们得到 $\\,\\phi^{(k+1)} = \\mathcal{A}\\psi^{(k+1)} \\ge \\mathcal{A}\\psi^{(k)} = \\phi^{(k)}\\,$。因此，$\\{\\phi^{(k)}\\}\\,$ 是一个单调不减序列。这个结论依赖于扫描映射的正性（保序性），而该性质由 (b) 部分的界限 $\\,\\tau_{i,m} \\le 2\\,$ 保证。\n\n(d) 部分。在一个均匀平板中，$\\,\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}\\,$ 且最小正方向余弦为 $\\,\\mu_{\\min} = 0.183434642\\,$，所有角度的正性充分条件简化为\n$$\nh \\;\\le\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_t}\\,.\n$$\n因此，最大允许的均匀单元宽度是\n$$\nh_{\\max} \\;=\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_t} \\;=\\; \\frac{2 \\times 0.183434642}{1.2} \\;=\\; \\frac{0.366869284}{1.2} \\;=\\; 0.305724403\\ldots\\,.\n$$\n四舍五入到 $\\,4\\,$ 位有效数字并以 $\\,\\mathrm{cm}\\,$ 表示，得到\n$$\nh_{\\max} \\;=\\; 0.3057\\,.\n$$\n这个界限保证了菱形差分扫描算子在每个单元和方向上都是正的，因此在所述假设下，源迭代的更新是单调不减的。",
            "answer": "$$\\boxed{0.3057}$$"
        },
        {
            "introduction": "最后的练习从分析转向综合，旨在解决一个常见的实际挑战：当菱形差分格式产生非物理的负通量时该如何处理。本练习要求您设计一个“通量限制器”，将菱形差分法与无条件正性的阶跃特征线法相融合，以确保得到物理上合理的解。通过量化这种“修正”所引入的误差，您将学到在维持解的正性和保持原始格式的形式精度与守恒性之间的基本权衡。",
            "id": "4237673",
            "problem": "考虑均匀平板中的一维稳态中子输运，其角通量 $\\psi(x,\\mu)$ 满足输运方程 $\\mu \\,\\frac{d \\psi}{d x} + \\Sigma_{t} \\,\\psi = q$，其中 $\\mu$ 是离散纵标 (SN) 方法中一个离散方向的方向余弦，$\\Sigma_{t}$ 是宏观总截面，而 $q$ 是一个常数角源项。在一个宽度为 $\\Delta x$ 的均匀空间单元中，假设 $\\mu  0$，因此信息从左侧面向右侧面传播。将左侧面的入射角通量记为 $\\psi_{L}$，右侧面的出射角通量记为 $\\psi_{R}$。\n\n从输运方程出发，且不使用任何预先给定的更新公式，推导：\n- 通过阶梯特征线 (SC) 方法（此处定义为沿特征线的解析解）得到的精确右侧面角通量，\n- 通过菱形差分 (DD) 方法（此处定义为对流项的中心差分和单元内碰撞项的算术平均）预测的右侧面角通量。\n\n接下来，设计一个保正限制器，在 DD 方法预测出负的出射角通量时，该限制器将 DD 和 SC 方法进行混合。具体来说，定义一个混合出射通量 $\\psi_{R}^{\\text{blend}} = w \\,\\psi_{R}^{\\text{DD}} + (1-w)\\,\\psi_{R}^{\\text{SC}}$，其中混合系数 $w$ 的选择应在 $\\psi_{R}^{\\text{DD}}  0$ 时，以最小的方式保证 $\\psi_{R}^{\\text{blend}} \\ge 0$，而在其他情况下 $w = 1$。在预测值为负的情况下，给出 $w$ 关于 $\\psi_{R}^{\\text{DD}}$ 和 $\\psi_{R}^{\\text{SC}}$ 的显式表达式。\n\n现在，对于混合通量，量化其一致性误差和守恒误差：\n- 将一致性误差定义为 $E_{\\text{cons}} = \\left|\\psi_{R}^{\\text{blend}} - \\psi_{R}^{\\text{SC}}\\right|$。\n- 通过菱形差分单元平衡残差 $R = \\frac{\\psi_{R}^{\\text{blend}} - \\psi_{L}}{h} + \\Sigma_{t}\\,\\frac{\\psi_{L} + \\psi_{R}^{\\text{blend}}}{2} - q$ 来定义守恒误差，其中 $h = \\Delta x / \\mu$ 是穿过单元的径迹长度。用通量单位表示守恒误差为 $E_{\\text{consrv}} = |R|/\\Sigma_{t}$。\n\n使用以下物理上合理的数据：\n- $\\Sigma_{t} = 1.5\\,\\text{cm}^{-1}$，\n- $\\Delta x = 3.0\\,\\text{cm}$，\n- $\\mu = 0.2$，\n- $q = 3.0 \\times 10^{-3}\\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$，\n- $\\psi_{L} = 6.0 \\times 10^{-3}\\,\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$。\n\n计算 $\\psi_{R}^{\\text{SC}}$、$\\psi_{R}^{\\text{DD}}$、负 DD 预测下的混合系数 $w$ 以及最终的 $\\psi_{R}^{\\text{blend}}$。然后计算如上定义的 $E_{\\text{cons}}$ 和 $E_{\\text{consrv}}$。将 $E_{\\text{cons}}$ 和 $E_{\\text{consrv}}$ 的值均四舍五入到四位有效数字。用单位 $\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$ 表示这两个误差值。",
            "solution": "分析首先从推导阶梯特征线 (SC) 和菱形差分 (DD) 方法的出射通量表达式开始。\n\n**1. 阶梯特征线 (SC) 通量的推导**\nSC 方法定义为输运方程沿特征线的精确解析解。控制方程是关于 $\\psi(x)$ 的一阶线性常微分方程：\n$$ \\mu \\frac{d\\psi}{dx} + \\Sigma_t \\psi = q $$\n重新整理可得：\n$$ \\frac{d\\psi}{dx} + \\frac{\\Sigma_t}{\\mu} \\psi = \\frac{q}{\\mu} $$\n我们使用积分因子 $I(x) = \\exp\\left(\\int \\frac{\\Sigma_t}{\\mu} dx\\right) = \\exp\\left(\\frac{\\Sigma_t x}{\\mu}\\right)$ 来求解此方程。设单元从 $x=0$ 开始，到 $x=\\Delta x$ 结束。解由以下公式给出：\n$$ \\psi(x) = \\psi(0) \\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right) + \\int_{0}^{x} \\frac{q}{\\mu} \\exp\\left(-\\frac{\\Sigma_t(x-x')}{\\mu}\\right) dx' $$\n设 $\\psi(0) = \\psi_L$，并在 $x=\\Delta x$ 处求值以得到 $\\psi_R = \\psi(\\Delta x)$：\n$$ \\psi_R^{\\text{SC}} = \\psi_L \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right) + \\frac{q}{\\mu} \\int_{0}^{\\Delta x} \\exp\\left(-\\frac{\\Sigma_t(\\Delta x-x')}{\\mu}\\right) dx' $$\n该积分的计算结果为：\n$$ \\int_{0}^{\\Delta x} \\exp\\left(-\\frac{\\Sigma_t(\\Delta x-x')}{\\mu}\\right) dx' = \\left[ \\frac{\\mu}{\\Sigma_t} \\exp\\left(-\\frac{\\Sigma_t(\\Delta x-x')}{\\mu}\\right) \\right]_{0}^{\\Delta x} = \\frac{\\mu}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right)\\right) $$\n将其代回，得到最终的 SC 关系式：\n$$ \\psi_R^{\\text{SC}} = \\psi_L \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right) + \\frac{q}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right)\\right) $$\n\n**2. 菱形差分 (DD) 通量的推导**\nDD 方法由单元上的守恒方程推导而来，该方程通过将输运方程从 $x=0$ 积分到 $x=\\Delta x$ 得到：\n$$ \\int_{0}^{\\Delta x} \\left(\\mu \\frac{d\\psi}{dx} + \\Sigma_t \\psi\\right) dx = \\int_{0}^{\\Delta x} q dx $$\n$$ \\mu (\\psi(\\Delta x) - \\psi(0)) + \\Sigma_t \\int_{0}^{\\Delta x} \\psi(x) dx = q \\Delta x $$\n使用记号 $\\psi_L = \\psi(0)$、$\\psi_R = \\psi(\\Delta x)$，并定义单元平均通量 $\\bar{\\psi} = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\psi(x) dx$，我们得到：\n$$ \\mu (\\psi_R - \\psi_L) + \\Sigma_t \\bar{\\psi} \\Delta x = q \\Delta x $$\nDD 格式使用面通量的算术平均值来近似单元平均通量：\n$$ \\bar{\\psi} \\approx \\frac{\\psi_L + \\psi_R}{2} $$\n将此代入守恒方程，得到 DD 离散方程：\n$$ \\mu (\\psi_R^{\\text{DD}} - \\psi_L) + \\Sigma_t \\Delta x \\left(\\frac{\\psi_L + \\psi_R^{\\text{DD}}}{2}\\right) = q \\Delta x $$\n我们现在求解未知的出射通量 $\\psi_R^{\\text{DD}}$：\n$$ \\psi_R^{\\text{DD}} \\left(\\mu + \\frac{\\Sigma_t \\Delta x}{2}\\right) - \\psi_L \\left(\\mu - \\frac{\\Sigma_t \\Delta x}{2}\\right) = q \\Delta x $$\n$$ \\psi_R^{\\text{DD}} \\left(2\\mu + \\Sigma_t \\Delta x\\right) = \\psi_L \\left(2\\mu - \\Sigma_t \\Delta x\\right) + 2q \\Delta x $$\n$$ \\psi_R^{\\text{DD}} = \\frac{(2\\mu - \\Sigma_t \\Delta x) \\psi_L + 2q \\Delta x}{2\\mu + \\Sigma_t \\Delta x} $$\n\n**3. 数值计算**\n我们代入给定数据：$\\Sigma_{t} = 1.5$，$\\Delta x = 3.0$，$\\mu = 0.2$，$q = 3.0 \\times 10^{-3}$，以及 $\\psi_{L} = 6.0 \\times 10^{-3}$。\n\n首先，我们计算单元沿特征线的光学厚度：\n$$ \\tau = \\frac{\\Sigma_t \\Delta x}{\\mu} = \\frac{1.5 \\times 3.0}{0.2} = \\frac{4.5}{0.2} = 22.5 $$\n指数项为 $\\exp(-\\tau) = \\exp(-22.5) \\approx 1.703 \\times 10^{-10}$。\n\n现在，我们计算 $\\psi_R^{\\text{SC}}$：\n$$ \\psi_R^{\\text{SC}} = (6.0 \\times 10^{-3}) \\exp(-22.5) + \\frac{3.0 \\times 10^{-3}}{1.5} (1 - \\exp(-22.5)) $$\n$$ \\psi_R^{\\text{SC}} = (6.0 \\times 10^{-3}) \\exp(-22.5) + (2.0 \\times 10^{-3}) (1 - \\exp(-22.5)) $$\n$$ \\psi_R^{\\text{SC}} = 2.0 \\times 10^{-3} + (4.0 \\times 10^{-3}) \\exp(-22.5) $$\n$$ \\psi_R^{\\text{SC}} \\approx 2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})(1.703 \\times 10^{-10}) \\approx 2.0 \\times 10^{-3} $$\n在高精度下，$\\psi_R^{\\text{SC}} \\approx 2.0000... \\times 10^{-3}$。\n\n接下来，我们计算 $\\psi_R^{\\text{DD}}$：\n$$ \\psi_R^{\\text{DD}} = \\frac{(2(0.2) - 1.5 \\times 3.0)(6.0 \\times 10^{-3}) + 2(3.0 \\times 10^{-3})(3.0)}{2(0.2) + 1.5 \\times 3.0} $$\n$$ \\psi_R^{\\text{DD}} = \\frac{(0.4 - 4.5)(6.0 \\times 10^{-3}) + 1.8 \\times 10^{-2}}{0.4 + 4.5} $$\n$$ \\psi_R^{\\text{DD}} = \\frac{(-4.1)(6.0 \\times 10^{-3}) + 1.8 \\times 10^{-2}}{4.9} = \\frac{-2.46 \\times 10^{-2} + 1.8 \\times 10^{-2}}{4.9} $$\n$$ \\psi_R^{\\text{DD}} = \\frac{-0.66 \\times 10^{-2}}{4.9} = \\frac{-6.6 \\times 10^{-3}}{4.9} \\approx -1.346938... \\times 10^{-3} $$\n正如预期的，DD 方法预测出负的出射通量。\n\n**4. 混合系数和混合通量**\n由于 $\\psi_R^{\\text{DD}}  0$，我们必须找到使 $\\psi_R^{\\text{blend}} \\ge 0$ 的最小混合系数 $w$。这通过设置 $\\psi_R^{\\text{blend}} = 0$ 来实现。\n$$ \\psi_{R}^{\\text{blend}} = w \\psi_{R}^{\\text{DD}} + (1-w)\\psi_{R}^{\\text{SC}} = 0 $$\n$$ w \\psi_{R}^{\\text{DD}} + \\psi_{R}^{\\text{SC}} - w \\psi_{R}^{\\text{SC}} = 0 $$\n$$ w (\\psi_{R}^{\\text{SC}} - \\psi_{R}^{\\text{DD}}) = \\psi_{R}^{\\text{SC}} $$\n$$ w = \\frac{\\psi_{R}^{\\text{SC}}}{\\psi_{R}^{\\text{SC}} - \\psi_{R}^{\\text{DD}}} $$\n代入计算出的值：\n$$ w = \\frac{2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})\\exp(-22.5)}{ (2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})\\exp(-22.5)) - (-\\frac{6.6 \\times 10^{-3}}{4.9}) } $$\n在此计算中忽略可忽略的 $\\exp(-22.5)$ 项：\n$$ w \\approx \\frac{2.0 \\times 10^{-3}}{2.0 \\times 10^{-3} + \\frac{6.6}{4.9} \\times 10^{-3}} = \\frac{2}{2 + \\frac{66}{49}} = \\frac{2}{\\frac{98+66}{49}} = \\frac{2 \\times 49}{164} = \\frac{98}{164} = \\frac{49}{82} $$\n$$ w \\approx 0.59756... $$\n根据限制器的设计，最终的混合通量为 $\\psi_R^{\\text{blend}} = 0$。\n\n**5. 误差量化**\n现在我们使用 $\\psi_R^{\\text{blend}} = 0$ 来计算两个定义的误差度量。\n\n**一致性误差：**\n一致性误差衡量了与精确特征线解的偏差。\n$$ E_{\\text{cons}} = |\\psi_{R}^{\\text{blend}} - \\psi_{R}^{\\text{SC}}| = |0 - \\psi_{R}^{\\text{SC}}| = \\psi_{R}^{\\text{SC}} $$\n$$ E_{\\text{cons}} = 2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})\\exp(-22.5) $$\n$$ E_{\\text{cons}} \\approx 2.0 \\times 10^{-3} + 6.812 \\times 10^{-13} $$\n四舍五入到四位有效数字，$E_{\\text{cons}} = 2.000 \\times 10^{-3} \\, \\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$。\n\n**守恒误差：**\n守恒误差基于 DD 守恒方程的残差。首先，我们计算径迹长度 $h$：\n$$ h = \\frac{\\Delta x}{\\mu} = \\frac{3.0}{0.2} = 15.0 \\, \\text{cm} $$\n接下来，我们用 $\\psi_{R}^{\\text{blend}} = 0$ 计算残差 $R$：\n$$ R = \\frac{0 - \\psi_{L}}{h} + \\Sigma_{t}\\frac{\\psi_{L} + 0}{2} - q $$\n$$ R = -\\frac{6.0 \\times 10^{-3}}{15.0} + 1.5 \\times \\frac{6.0 \\times 10^{-3}}{2} - 3.0 \\times 10^{-3} $$\n$$ R = -0.4 \\times 10^{-3} + 1.5 \\times (3.0 \\times 10^{-3}) - 3.0 \\times 10^{-3} $$\n$$ R = -0.4 \\times 10^{-3} + 4.5 \\times 10^{-3} - 3.0 \\times 10^{-3} $$\n$$ R = (4.5 - 0.4 - 3.0) \\times 10^{-3} = 1.1 \\times 10^{-3} \\, \\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1} $$\n以通量单位表示的守恒误差是：\n$$ E_{\\text{consrv}} = \\frac{|R|}{\\Sigma_{t}} = \\frac{1.1 \\times 10^{-3}}{1.5} = \\frac{11}{15} \\times 10^{-3} \\approx 0.733333... \\times 10^{-3} $$\n四舍五入到四位有效数字，$E_{\\text{consrv}} = 7.333 \\times 10^{-4} \\, \\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.000 \\times 10^{-3}  7.333 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}