{
    "hands_on_practices": [
        {
            "introduction": "我们对菱形差分格式的学习始于一个基础但至关重要的练习。本题引导你从最基本的中子输运方程出发，在一个简化的单空间网格、无源场景中推导出菱形差分的核心关系式。通过计算特定离散方向上的出射角通量并最终得到净中子流，你将不仅实践该格式的直接应用，还将首次接触并分析其关键属性——正性条件。",
            "id": "4237955",
            "problem": "考虑一个一维平板几何中的均匀空间单元，其范围从 $x=0$ 到 $x=\\Delta x$，具有均匀的总宏观截面 $\\Sigma_{t}$，并且单元内部没有散射或固定源。在一维平板几何中，角通量 $\\psi(x,\\mu)$ 的稳态中子输运方程为 $ \\mu \\, \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t} \\, \\psi(x,\\mu) = Q(x,\\mu)$, 且在该单元中 $Q(x,\\mu)=0$。采用离散纵标 (SN) 近似，并使用 $S_{2}$ 高斯-勒让德求积；使用两个纵标 $\\mu_{1}=+0.5773502692$（权重 $w_{1}=1.0$）和 $\\mu_{2}=-0.5773502692$（权重 $w_{2}=1.0$）。边界条件为：对于 $\\mu0$，在 $x=\\Delta x$ 处为真空；对于 $\\mu0$，在 $x=0$ 处为给定流入：$\\psi(0,\\mu_{1})=\\psi_{\\text{in}}$ 和 $\\psi(\\Delta x,\\mu_{2})=0$，其中 $\\psi_{\\text{in}}=1.0 \\times 10^{12}$。\n\n在此单元中使用菱形差分格式，其中流项近似为 $(\\psi_{R} - \\psi_{L})/\\Delta x$，单元中心通量近似为 $(\\psi_{R} + \\psi_{L})/2$，其中 $\\psi_{L}=\\psi(0,\\mu)$ 和 $\\psi_{R}=\\psi(\\Delta x,\\mu)$ 表示给定方向 $\\mu$ 的单元边界角通量。从稳态中子输运方程和这些定义出发，对于每个离散方向，推导单元边界角通量 $\\psi_{R}$ 作为 $\\psi_{L}$ 以及参数 $\\mu$、$\\Sigma_{t}$ 和 $\\Delta x$ 的函数关系。然后，在所述边界条件下，计算在 $x=\\Delta x$ 处 $\\mu_{1}0$ 和 $\\mu_{2}0$ 的出射角通量，并推导出通过 $x=\\Delta x$ 处右侧界面的净流，其定义为 $J_{R}=\\sum_{m} w_{m} \\, \\mu_{m} \\, \\psi(\\Delta x,\\mu_{m})$。\n\n最后，通过确定在无源单元中计算出的角通量保持非负时，$\\Sigma_{t} \\, \\Delta x$ 相对于 $|\\mu|$ 的约束条件，来评估菱形差分更新的正性。将净流 $J_{R}$ 作为最终答案，四舍五入到四位有效数字，并以“中子数/平方厘米·秒”为单位表示。\n给定数据：$\\Delta x = 1.0 \\ \\text{cm}$，$\\Sigma_{t} = 0.5 \\ \\text{cm}^{-1}$，$\\psi_{\\text{in}} = 1.0 \\times 10^{12}$，$\\mu_{1} = +0.5773502692$，$w_{1}=1.0$，$\\mu_{2}=-0.5773502692$，$w_{2}=1.0$。",
            "solution": "所提出的问题在科学上是合理的、适定的，并包含了获得唯一解所需的所有信息。它基于中子输运理论的基本原理和标准数值方法。因此，我们可以开始求解。\n\n该问题要求使用带有菱形差分（DD）空间离散格式的离散纵标（$S_N$）方法，来分析一维平板几何中的单个均匀单元。控制方程是稳态、无源的中子输运方程：\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = 0\n$$\n其中 $\\psi(x,\\mu)$ 是位置 $x$ 处、方向 $\\mu$ 上的角中子通量，$\\Sigma_t$ 是总宏观截面。离散纵标法在一组离散方向 $\\mu_m$ 上求解此方程。对于此问题，我们使用 $S_2$ 求积组：$\\mu_1 = 0.5773502692$ 和 $\\mu_2 = -0.5773502692$。\n\n首先，我们推导通用的菱形差分关系。DD 格式通过在单元中心评估损失项，并使用单元边界通量评估流项，来近似从 $x=0$ 到 $x=\\Delta x$ 空间单元上的输运方程。给定方向 $\\mu$ 的单元边界通量表示为 $\\psi_L = \\psi(0, \\mu)$ 和 $\\psi_R = \\psi(\\Delta x, \\mu)$。DD 近似为：\n$$\n\\frac{\\partial \\psi(x,\\mu)}{\\partial x} \\approx \\frac{\\psi_R - \\psi_L}{\\Delta x}\n$$\n$$\n\\psi_{\\text{cell-average}} \\approx \\frac{\\psi_L + \\psi_R}{2}\n$$\n将这些近似代入离散方向 $\\mu_m$ 的输运方程中：\n$$\n\\mu_m \\left( \\frac{\\psi_R - \\psi_L}{\\Delta x} \\right) + \\Sigma_t \\left( \\frac{\\psi_L + \\psi_R}{2} \\right) = 0\n$$\n为了推导单元边界通量的关系式，我们重排这个代数方程。两边乘以 $2\\Delta x$ 以消去分母，得到：\n$$\n2\\mu_m (\\psi_R - \\psi_L) + \\Sigma_t \\Delta x (\\psi_L + \\psi_R) = 0\n$$\n我们合并与 $\\psi_R$ 和 $\\psi_L$ 相关的项：\n$$\n\\psi_R (2\\mu_m + \\Sigma_t \\Delta x) - \\psi_L (2\\mu_m - \\Sigma_t \\Delta x) = 0\n$$\n这导出了所需的（对于 $\\mu_m > 0$）出射通量 $\\psi_R$ 作为入射通量 $\\psi_L$ 的函数关系：\n$$\n\\psi_R = \\psi_L \\left( \\frac{2\\mu_m - \\Sigma_t \\Delta x}{2\\mu_m + \\Sigma_t \\Delta x} \\right)\n$$\n这是无源区域的通用菱形差分更新公式。\n\n接下来，我们评估该格式的正性。一个入射通量 $\\psi_{\\text{in}} \\ge 0$ 必须产生一个出射通量 $\\psi_{\\text{out}} \\ge 0$。\n对于 $\\mu_m > 0$，中子从左向右行进。因此，$\\psi_L$ 是入射通量，$\\psi_R$ 是出射通量。为使 $\\psi_R$ 为非负，由于 $\\psi_L \\ge 0$ 且分母 $(2\\mu_m + \\Sigma_t \\Delta x)$ 恒为正，分子必须为非负：\n$$\n2\\mu_m - \\Sigma_t \\Delta x \\ge 0 \\implies \\Sigma_t \\Delta x \\le 2\\mu_m\n$$\n对于 $\\mu_m  0$，中子从右向左行进。因此，$\\psi_R$ 是入射通量，$\\psi_L$ 是出射通量。我们必须用 $\\psi_R$ 来表示 $\\psi_L$：\n$$\n\\psi_L = \\psi_R \\left( \\frac{2\\mu_m + \\Sigma_t \\Delta x}{2\\mu_m - \\Sigma_t \\Delta x} \\right)\n$$\n令 $\\mu_m = -|\\mu_m|$。代入可得：\n$$\n\\psi_L = \\psi_R \\left( \\frac{-2|\\mu_m| + \\Sigma_t \\Delta x}{-2|\\mu_m| - \\Sigma_t \\Delta x} \\right) = \\psi_R \\left( \\frac{-(2|\\mu_m| - \\Sigma_t \\Delta x)}{-(2|\\mu_m| + \\Sigma_t \\Delta x)} \\right) = \\psi_R \\left( \\frac{2|\\mu_m| - \\Sigma_t \\Delta x}{2|\\mu_m| + \\Sigma_t \\Delta x} \\right)\n$$\n为使 $\\psi_L$ 为非负，由于 $\\psi_R \\ge 0$，分子必须为非负：\n$$\n2|\\mu_m| - \\Sigma_t \\Delta x \\ge 0 \\implies \\Sigma_t \\Delta x \\le 2|\\mu_m|\n$$\n因此，保证菱形差分格式在无源区域中产生非负通量的通用约束条件是 $\\Sigma_t \\Delta x \\le 2|\\mu_m|$。乘积 $\\Sigma_t \\Delta x$ 表示单元的光学厚度。\n\n现在我们用给定数据来检验这个条件：$\\Delta x = 1.0 \\, \\text{cm}$，$\\Sigma_t = 0.5 \\, \\text{cm}^{-1}$，以及 $|\\mu_m|=0.5773502692$。\n光学厚度为 $\\Sigma_t \\Delta x = (0.5 \\, \\text{cm}^{-1})(1.0 \\, \\text{cm}) = 0.5$。\n正性极限为 $2|\\mu_m| = 2(0.5773502692) \\approx 1.1547$。\n由于 $0.5  1.1547$，该问题的正性条件得到满足。\n\n现在我们计算单元右侧界面 $x=\\Delta x$ 处的角通量。\n对于方向 $\\mu_1 = 0.5773502692  0$，中子从左向右行进。入射通量由 $x=0$ 处的边界条件指定：$\\psi_L = \\psi(0, \\mu_1) = \\psi_{\\text{in}} = 1.0 \\times 10^{12}$。在 $x=\\Delta x$ 处的出射通量为 $\\psi_R = \\psi(\\Delta x, \\mu_1)$。使用推导的关系式：\n$$\n\\psi(\\Delta x, \\mu_1) = \\psi_{\\text{in}} \\left( \\frac{2\\mu_1 - \\Sigma_t \\Delta x}{2\\mu_1 + \\Sigma_t \\Delta x} \\right) = (1.0 \\times 10^{12}) \\left( \\frac{2(0.5773502692) - 0.5}{2(0.5773502692) + 0.5} \\right)\n$$\n$$\n\\psi(\\Delta x, \\mu_1) = (1.0 \\times 10^{12}) \\left( \\frac{1.1547005384 - 0.5}{1.1547005384 + 0.5} \\right) = (1.0 \\times 10^{12}) \\left( \\frac{0.6547005384}{1.6547005384} \\right)\n$$\n$$\n\\psi(\\Delta x, \\mu_1) \\approx 0.395662706 \\times 10^{12}\n$$\n对于方向 $\\mu_2 = -0.5773502692  0$，中子从右向左行进。$x=\\Delta x$ 处的通量是进入单元的入射通量，由区域右边界的真空边界条件指定：\n$$\n\\psi(\\Delta x, \\mu_2) = 0\n$$\n\n最后，我们计算通过右侧界面 $x=\\Delta x$ 的净流。其定义为：\n$$\nJ_R = \\sum_{m} w_{m} \\mu_{m} \\psi(\\Delta x, \\mu_m) = w_1 \\mu_1 \\psi(\\Delta x, \\mu_1) + w_2 \\mu_2 \\psi(\\Delta x, \\mu_2)\n$$\n给定的求积权重为 $w_1 = 1.0$ 和 $w_2 = 1.0$。代入我们已求得的值：\n$$\nJ_R = (1.0)(0.5773502692)(0.395662706 \\times 10^{12}) + (1.0)(-0.5773502692)(0)\n$$\n$$\nJ_R = (0.5773502692)(0.395662706 \\times 10^{12}) + 0\n$$\n$$\nJ_R \\approx 0.22842450 \\times 10^{12} = 2.2842450 \\times 10^{11}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nJ_R \\approx 2.284 \\times 10^{11}\n$$\n单位是“中子数/平方厘米·秒”，这是中子流的标准单位。",
            "answer": "$$\\boxed{2.284 \\times 10^{11}}$$"
        },
        {
            "introduction": "在掌握了菱形差分的基本形式后，下一个练习将引导你深入探究其数学性质及其对整个求解过程的影响。本题要求你将前一练习中遇到的正性条件推广，并揭示它与源迭代算法收敛性之间的深刻联系。通过证明一个“正”的输运扫描算子如何保证迭代解的单调性，你将理解为何正性约束不仅是为了避免非物理的负通量，更是保证数值算法稳定性和可靠性的基石。",
            "id": "4250966",
            "problem": "考虑一维稳态单能线性输运方程，在平板几何中角通量为 $\\,\\psi(x,\\mu)\\,$，\n$$\n\\mu\\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t(x)\\,\\psi(x,\\mu) \\;=\\; \\frac{\\Sigma_s(x)}{2}\\,\\phi(x) \\;+\\; \\frac{q(x)}{2}\\,,\n$$\n其中标量通量 $\\,\\phi(x) = \\int_{-1}^{1}\\psi(x,\\mu)\\,d\\mu\\,$，总宏观截面 $\\,\\Sigma_t(x)  0\\,$，散射截面 $\\,\\Sigma_s(x) \\in [0,\\Sigma_t(x))\\,$，以及各向同性固定外源 $\\,q(x) \\ge 0\\,$。使用离散纵标法 (SN法) 在方向集 $\\{\\mu_m, w_m\\}_{m=1}^{M}$ 上对角度进行离散化，其中 $\\mu_m \\in (-1,1)$ 且正权重 $\\{w_m\\}$ 满足 $\\sum_{m=1}^{M} w_m = 2$。在宽度为 $\\,h  0\\,$ 的均匀网格上对空间进行离散化，网格边缘位于 $\\,x_{i \\pm 1/2}\\,$，并采用标准的网格平衡有限体积格式，其菱形差分闭合关系为\n$$\n\\psi_{i,m} \\;=\\; \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right)\\,,\n$$\n其中 $\\,\\psi_{i\\pm \\frac{1}{2},m}\\,$ 是边缘值，$\\,\\psi_{i,m}\\,$ 是方向 $\\,\\mu_m\\,$ 上的网格平均替代值。\n\n(a) 从给定方向（$\\,\\mu_m  0\\,$）上网格 $\\,i\\,$ 的输运方程的网格平衡形式出发，推导线性扫描关系\n$$\n\\psi_{i+\\frac{1}{2},m} \\;=\\; \\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m} \\;+\\; \\beta_{i,m}\\,Q_{i,m}\\,,\n$$\n其中 $\\,Q_{i,m}\\,$ 是当前迭代步中方向 $\\,\\mu_m\\,$ 上的已知网格平均总源（包括外源和散射贡献）。用 $\\,\\mu_m\\,$, $\\,h\\,$ 和 $\\,\\Sigma_{t,i}\\,$ 表示 $\\,\\alpha_{i,m}\\,$ 和 $\\,\\beta_{i,m}\\,$。确定这些系数需要满足什么条件，才能确保非负的入射角通量 $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ 和非负源 $\\,Q_{i,m} \\ge 0\\,$ 能产生非负的出射角通量 $\\,\\psi_{i+\\frac{1}{2},m} \\ge 0\\,$。解释在什么条件下，菱形差分离散格式可能会违反正性。\n\n(b) 使用您的表达式，将正性条件简化为关于每个角度、每个网格的光学厚度的单一充分不等式\n$$\n\\tau_{i,m} \\;:=\\; \\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|}\\,.\n$$\n将得到的界表示为一个关联 $\\,\\Sigma_{t,i}\\,$, $\\,h\\,$ 和 $\\,|\\mu_m|\\,$ 的显式不等式，该不等式对所有网格 $\\,i\\,$ 和所有角度 $\\,m\\,$ 均成立。\n\n(c) 考虑散射比为 $\\,c := \\Sigma_s/\\Sigma_t \\in [0,1)\\,$ 的各向同性散射的源迭代法。设标量通量的更新定义为：在每次迭代中，使用总源 $\\,Q_{i,m}^{(k)} = \\frac{1}{2} q_i + \\frac{\\Sigma_{s,i}}{2}\\,\\phi_i^{(k)}\\,$ 求解输运方程，并通过对新的角通量进行加权求和来构建 $\\,\\phi^{(k+1)}\\,$。证明，如果由菱形差分離散化定义的输运扫描算子在(a)部分的意义下是正的，那么从 $\\,\\phi^{(0)} \\equiv 0\\,$ 开始且对于 $\\,q_i \\ge 0\\,$，迭代序列 $\\,\\phi^{(k)}\\,$ 在由分量不等式诱导的偏序下形成一个单调非减序列。\n\n(d) 最后，对于一个均匀平板，其 $\\,\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}\\,$，以及一个对称加权求积，其最小正方向余弦为 $\\,\\mu_{\\min} = 0.183434642\\,$。计算最大均匀网格宽度 $\\,h_{\\max}\\,$（单位为 $\\,\\mathrm{cm}\\,$），该宽度能保证在菱形差分格式下源迭代更新的单调性，如(a)-(c)部分所确立的。将您的答案四舍五入到4位有效数字，并以 $\\,\\mathrm{cm}\\,$ 为单位表示。",
            "solution": "我们从在角度和空间上离散化的一维、稳态、单能线性输运方程开始。对于宽度为 $\\,h\\,$、横跨 $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}}]\\,$ 的给定网格 $\\,i\\,$ 和方向 $\\,\\mu_m  0\\,$，网格上的有限体积平衡方程为\n$$\n\\mu_m\\,\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} \\;+\\; \\Sigma_{t,i}\\,\\psi_{i,m} \\;=\\; Q_{i,m}\\,,\n$$\n其中 $\\,Q_{i,m}\\,$ 是当前迭代步中网格内方向 $\\,m\\,$ 上每球面度的已知总源，而 $\\,\\psi_{i,m}\\,$ 由菱形差分关系闭合\n$$\n\\psi_{i,m} \\;=\\; \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right)\\,.\n$$\n\n(a)部分。将菱形差分闭合关系代入平衡方程，得到\n$$\n\\mu_m\\,\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} \\;+\\; \\Sigma_{t,i}\\,\\frac{\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}}{2} \\;=\\; Q_{i,m}\\,.\n$$\n将位于 $\\,x_{i+\\frac{1}{2}}\\,$ 的未知数收集到左边：\n$$\n\\left(\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i+\\frac{1}{2},m} \\;+\\; \\left(-\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i-\\frac{1}{2},m} \\;=\\; Q_{i,m}\\,.\n$$\n解出 $\\,\\psi_{i+\\frac{1}{2},m}\\,$ 得到线性扫描关系\n$$\n\\psi_{i+\\frac{1}{2},m} \\;=\\; \\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m} \\;+\\; \\beta_{i,m}\\,Q_{i,m}\\,,\n$$\n其系数为\n$$\n\\alpha_{i,m} \\;=\\; \\frac{\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}} \\;=\\; \\frac{2\\,\\frac{\\mu_m}{h} - \\Sigma_{t,i}}{2\\,\\frac{\\mu_m}{h} + \\Sigma_{t,i}}\\,,\n\\qquad\n\\beta_{i,m} \\;=\\; \\frac{1}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}}\\,.\n$$\n对于 $\\,\\mu_m  0\\,$, $\\,h  0\\,$ 和 $\\,\\Sigma_{t,i}  0\\,$，分母 $\\,\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\,$ 严格为正。因此 $\\,\\beta_{i,m}  0\\,$ 总是成立。$\\,\\alpha_{i,m}\\,$ 的符号由分子 $\\,\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}\\,$ 决定。如果 $\\,\\alpha_{i,m} \\ge 0\\,$ 且 $\\,\\beta_{i,m}  0\\,$，那么对于 $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ 和 $\\,Q_{i,m} \\ge 0\\,$，我们有 $\\,\\psi_{i+\\frac{1}{2},m} \\ge 0\\,$，从而确立了该方向上扫描更新的正性。反之，如果 $\\,\\alpha_{i,m}  0\\,$，那么即使 $\\,\\psi_{i-\\frac{1}{2},m} \\ge 0\\,$ 且 $\\,Q_{i,m} \\ge 0\\,$，项 $\\,\\alpha_{i,m}\\,\\psi_{i-\\frac{1}{2},m}\\,$ 也会变为非正；如果它的绝对值大于 $\\,\\beta_{i,m}\\,Q_{i,m}\\,$，就可能导致 $\\,\\psi_{i+\\frac{1}{2},m}  0\\,$。因此，当 $\\,\\alpha_{i,m}  0\\,$ 时，菱形差分離散格式可能违反正性，这种情况发生在光学厚度足够大的网格中。\n\n(b)部分。引入每个角度、每个网格的光学厚度\n$$\n\\tau_{i,m} \\;:=\\; \\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|}\\,.\n$$\n对于 $\\,\\mu_m  0\\,$，我们有\n$$\n\\alpha_{i,m} \\;=\\; \\frac{2 - \\tau_{i,m}}{2 + \\tau_{i,m}}\\,.\n$$\n对于非负入射通量和非负源，扫描映射的正性得到保证的充要条件是 $\\,\\alpha_{i,m} \\ge 0\\,$ 且 $\\,\\beta_{i,m}  0\\,$。如前所述，$\\,\\beta_{i,m}  0\\,$ 总是成立。因此，充分条件简化为\n$$\n\\alpha_{i,m} \\;\\ge\\; 0 \\quad \\Longleftrightarrow \\quad 2 - \\tau_{i,m} \\;\\ge\\; 0 \\quad \\Longleftrightarrow \\quad \\tau_{i,m} \\;\\le\\; 2\\,.\n$$\n根据对称性，对于 $\\,\\mu_m  0\\,$ 的情况，使用 $\\,|\\mu_m|\\,$ 的相同条件也适用。因此，在每个网格和每个离散方向上，菱形差分扫描的充分正性条件是\n$$\n\\frac{\\Sigma_{t,i}\\,h}{|\\mu_m|} \\;\\le\\; 2 \\quad \\text{对所有网格 } i \\text{ 和所有角度 } m\\,,\n$$\n等价于，\n$$\nh \\;\\le\\; \\frac{2\\,|\\mu_m|}{\\Sigma_{t,i}} \\quad \\text{对所有 } i,m\\,.\n$$\n在给定的网格和角度集上，最严格的界使用了最小正方向余弦 $\\,\\mu_{\\min} := \\min_{m:\\, \\mu_m  0} \\mu_m\\,$ 和最大网格总截面 $\\,\\Sigma_{t,\\max} := \\max_i \\Sigma_{t,i}\\,$，从而给出全局充分条件\n$$\nh \\;\\le\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_{t,\\max}}\\,.\n$$\n\n(c)部分。令 $\\,\\mathcal{L}\\,$ 表示输运算子，它将角通量映射到其迁移加吸收残差，该算子使用菱形差分在空间和角度上进行离散化。令 $\\,\\mathcal{L}^{-1}\\,$ 表示相应的扫描算子，它将给定的总源 $\\,Q\\,$ 映射到唯一的迎风角通量 $\\,\\psi\\,$。在(b)部分的条件下，每个网格-角度的扫描更新都具有非负系数，这些系数仅依赖于局部数据，因此 $\\,\\mathcal{L}^{-1}\\,$ 是一个正线性算子：对于任意两个总源 $\\,Q,Q'\\,$，如果按分量比较有 $\\,Q \\ge Q'\\,$，则按分量比较有 $\\,\\mathcal{L}^{-1}Q \\ge \\mathcal{L}^{-1}Q'\\,$。\n\n对于散射比为 $\\,c = \\Sigma_s/\\Sigma_t \\in [0,1)\\,$ 的各向同性散射，定义正线性散射算子 $\\,\\mathcal{S}\\,$，它将标量通量 $\\,\\phi\\,$ 映射到各向同性角源，其分量为 $\\,(\\mathcal{S}\\phi)_{i,m} = \\frac{\\Sigma_{s,i}}{2}\\,\\phi_i\\,$。外源 $\\,q\\,$ 诱导一个非负的各向同性角源 $\\,\\mathcal{Q}_{\\mathrm{ext}}\\,$，其分量为 $\\,(\\mathcal{Q}_{\\mathrm{ext}})_{i,m} = \\frac{q_i}{2}\\,$。源迭代是不动点迭代\n$$\n\\psi^{(k+1)} \\;=\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k)}\\right), \\qquad \\phi^{(k+1)} \\;=\\; \\sum_{m=1}^{M} w_m\\,\\psi^{(k+1)}_{(\\cdot),m}\\,,\n$$\n初始化为 $\\,\\phi^{(0)} \\equiv 0\\,$。令角到标量平均算子 $\\,\\mathcal{A}\\,$ 定义为 $\\,\\mathcal{A}\\psi = \\sum_{m=1}^{M} w_m\\,\\psi_{(\\cdot),m}\\,$；该算子具有非负权重，因此在序的意义下是正的。\n\n我们用数学归纳法证明 $\\,\\phi^{(k)}\\,$ 是单调非减的。归纳基础：$\\,\\phi^{(0)} = 0\\,$。那么 $\\,\\psi^{(1)} = \\mathcal{L}^{-1}\\mathcal{Q}_{\\mathrm{ext}} \\ge 0\\,$，因为 $\\,\\mathcal{Q}_{\\mathrm{ext}} \\ge 0\\,$ 且 $\\,\\mathcal{L}^{-1}\\,$ 是正的。因此 $\\,\\phi^{(1)} = \\mathcal{A}\\psi^{(1)} \\ge 0 = \\phi^{(0)}\\,$。假设 $\\,\\phi^{(k)} \\ge \\phi^{(k-1)}\\,$。由于 $\\,\\mathcal{S}\\,$ 是正的，所以 $\\,\\mathcal{S}\\,\\phi^{(k)} \\ge \\mathcal{S}\\,\\phi^{(k-1)}\\,$。因此\n$$\n\\psi^{(k+1)} \\;=\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k)}\\right) \\;\\ge\\; \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\,\\phi^{(k-1)}\\right) \\;=\\; \\psi^{(k)}\\,,\n$$\n这是根据 $\\,\\mathcal L^{-1}\\,$ 的正性得出的。应用正平均算子 $\\,\\mathcal{A}\\,$，我们得到 $\\,\\phi^{(k+1)} = \\mathcal{A}\\psi^{(k+1)} \\ge \\mathcal{A}\\psi^{(k)} = \\phi^{(k)}\\,$。因此，$\\{\\phi^{(k)}\\}\\,$ 是一个单调非减序列。这个结论依赖于扫描映射的正性（保序性），而该正性由(b)部分得出的界 $\\,\\tau_{i,m} \\le 2\\,$ 保证。\n\n(d)部分。在一个均匀平板中，$\\,\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}\\,$，最小正方向余弦为 $\\,\\mu_{\\min} = 0.183434642\\,$，对所有角度都保证正性的充分条件简化为\n$$\nh \\;\\le\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_t}\\,.\n$$\n因此，最大容许均匀网格宽度是\n$$\nh_{\\max} \\;=\\; \\frac{2\\,\\mu_{\\min}}{\\Sigma_t} \\;=\\; \\frac{2 \\times 0.183434642}{1.2} \\;=\\; \\frac{0.366869284}{1.2} \\;=\\; 0.305724403\\ldots\\,.\n$$\n四舍五入到4位有效数字并以 $\\,\\mathrm{cm}\\,$ 为单位表示，得到\n$$\nh_{\\max} \\;=\\; 0.3057\\,.\n$$\n这个界保证了菱形差分扫描算子在每个网格和方向上都是正的，因此在所述假设下，源迭代更新是单调非减的。",
            "answer": "$$\\boxed{0.3057}$$"
        },
        {
            "introduction": "理论学习的最终目的是付诸实践，本章的收官练习便是一个综合性的编程项目。你将从零开始，构建一个完整的一维离散纵标输运求解器，其核心正是你已经学习的菱形差分格式。这个练习要求你将前面学到的所有概念——从方程推导、输运扫描到源迭代和收敛性判断——融会贯通，并最终转化为一个可以解决实际问题的计算工具，从而全面巩固你的理论知识和实践技能。",
            "id": "4254547",
            "problem": "您需要推导、实现并分析一个在平板几何中使用菱形差分空间离散的一维单能离散纵标输运求解器，重点关注实现和性能方面的考虑。目标是从第一性原理出发，构建菱形差分格式，然后编写一个带有真空边界条件的源迭代扫描程序来计算标量通量。您还必须量化数值解的正性以及基本的浮点运算次数。\n\n物理模型是针对角通量 $\\psi(x,\\mu)$ 建立的带各向同性散射的一维平板线性 Boltzmann 输运方程，其中 $x$ 是平板中的位置，$\\mu$ 是方向余弦。平板的范围是 $x \\in [0,L]$。未知的标量通量为 $\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\, d\\mu$，输运方程如下\n$$\n\\mu \\, \\frac{d \\psi(x,\\mu)}{dx} + \\sigma_t \\, \\psi(x,\\mu) = \\frac{\\sigma_s}{2} \\, \\phi(x) + \\frac{Q}{2},\n$$\n其中 $\\sigma_t$ 是总宏观截面，$\\sigma_s$ 是散射宏观截面，$Q$ 是均匀的各向同性体积源。使用真空边界条件：两端入射的角通量为零，即 $\\psi(0,\\mu0)=0$ 和 $\\psi(L,\\mu0)=0$。\n\n您将使用离散纵标（SN）方法对角度变量进行离散化。首次出现时，离散纵标（SN）方法的定义如下：离散纵标（SN）方法使用来自 Gauss–Legendre 求积的一组有限方向余弦 $\\mu_m$ 和权重 $w_m$ 来近似角度积分，使得标量通量 $\\phi(x)$ 近似为 $\\sum_m w_m \\psi(x,\\mu_m)$ 且 $\\sum_m w_m = 2$。请将注意力限制在偶数阶 $S_N$ 求积上（$N$为偶数），根据对称性使用 $N/2$ 个正方向和 $N/2$ 个负方向。\n\n您将把空间离散为 $N_{\\text{cells}}$ 个宽度为 $h = L/N_{\\text{cells}}$ 的均匀网格，并应用菱形差分格式：对于每个方向，用进入和离开的界面通量的平均值来近似网格中心的角通量。仅从输运方程和这些定义出发，推导菱形差分界面更新关系，该关系对于给定的网格和方向余弦，将入射界面通量映射到出射界面通量。您的推导必须基于网格上的平衡和对总相互作用项的中点近似，不得使用任何未经证明的简化公式。\n\n实现要求：\n\n- 实现源迭代：将标量通量 $\\phi^{(0)}(x)$ 初始化为零，根据 $\\phi^{(k)}(x)$ 构建各向同性源项，并对所有方向执行输运扫描以获得 $\\phi^{(k+1)}(x)$。重复此过程，直到相对变化 $\\|\\phi^{(k+1)} - \\phi^{(k)}\\|_2 / \\|\\phi^{(k+1)}\\|_2$ 小于容差 $\\epsilon$ 或达到最大迭代次数。使用欧几里得范数（也称为 $\\ell^2$ 范数），记为 $\\|\\cdot\\|_2$。\n- 按上文规定使用真空边界条件。\n- 计算并报告以下量：\n  1. 中心网格的标量通量 $\\phi(x_{i^*})$，其中 $i^* = \\lfloor N_{\\text{cells}}/2 \\rfloor$，以 $1/(\\text{cm}^2 \\cdot \\text{s})$ 为单位表示，并由程序的默认浮点格式进行四舍五入。\n  2. 一个布尔类型的正性标志，指示所有计算出的界面角通量和网格中心角通量是否在 $-10^{-12}$ 的容差内为非负。\n  3. 为满足收敛判据所需的源迭代扫描总次数（一个整数）。\n  4. 所有迭代的总估算浮点运算次数（一个整数）。对于此计数，请使用以下基于您算法设计的原则性模型：\n     - 每次迭代中，对于每个正的离散方向余弦，预计算菱形差分更新所需的量。此预计算计为每个正方向 $4$ 次浮点运算。\n     - 每次迭代中，对于每个网格，根据当前标量通量预计算各向同性源分量。此源预计算计为每个网格 $3$ 次浮点运算。\n     - 每次迭代中，对于每个网格、每个方向（包括正方向和负方向），菱形差分更新和向 $\\phi$ 中累加标量通量计为 $7$ 次浮点运算。\n     - 因此，每次迭代的总运算次数为 $4 \\cdot (N/2) + 3 \\cdot N_{\\text{cells}} + 7 \\cdot N_{\\text{cells}} \\cdot N$，其中 $N$ 是 $S_N$ 中离散方向的总数。将此单次迭代的运算次数乘以总迭代次数，即可得到最终的运算次数。\n\n您的程序必须实现 Gauss–Legendre 求积以获得给定偶数 $N$ 的离散纵标 $S_N$ 集，必须严格按照推导实现菱形差分扫描，并且必须按照下面指定的精确格式输出结果。\n\n测试套件：\n\n提供并运行以下三个科学上真实的参数集。所有参数必须解释为：长度单位为厘米，截面单位为厘米的倒数，源单位为 $1/(\\text{cm}^3 \\cdot \\text{s})$。标量通量必须以 $1/(\\text{cm}^2 \\cdot \\text{s})$ 为单位报告。无需报告角度，因此不需要角度单位。\n\n- 测试用例 1 (每个网格具有中等光学厚度，存在散射；理想情况):\n  - $L = 10$\n  - $N_{\\text{cells}} = 50$\n  - $\\sigma_t = 1$\n  - $\\sigma_s = 0.4$\n  - $Q = 1$\n  - $S_N$ 阶数 $N = 4$\n  - 收敛容差 $\\epsilon = 10^{-10}$ 且最大迭代次数 $10000$。\n\n- 测试用例 2 (粗网格、大总截面、小掠射角，用于探测菱形差分中潜在的负值):\n  - $L = 10$\n  - $N_{\\text{cells}} = 10$\n  - $\\sigma_t = 5$\n  - $\\sigma_s = 0.5$\n  - $Q = 1$\n  - $S_N$ 阶数 $N = 8$\n  - 收敛容差 $\\epsilon = 10^{-10}$ 且最大迭代次数 $10000$。\n\n- 测试用例 3 (纯吸收剂，无散射；检查单次扫描行为和收敛特性):\n  - $L = 10$\n  - $N_{\\text{cells}} = 100$\n  - $\\sigma_t = 1$\n  - $\\sigma_s = 0$\n  - $Q = 1$\n  - $S_N$ 阶数 $N = 2$\n  - 收敛容差 $\\epsilon = 10^{-10}$ 且最大迭代次数 $10000$。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个包含按规定顺序排列的四个量的列表。例如，打印的输出必须是以下形式\n$$\n[\\,[\\text{float},\\ \\text{boolean},\\ \\text{integer},\\ \\text{integer}],\\ [\\text{float},\\ \\text{boolean},\\ \\text{integer},\\ \\text{integer}],\\ [\\text{float},\\ \\text{boolean},\\ \\text{integer},\\ \\text{integer}]\\,]\n$$\n前后不带任何附加文本。",
            "solution": "该问题提法良好，具有科学依据且内部一致。推导和实现采用菱形差分格式的一维离散纵标输运求解器所需的所有必要参数和定义均已提供。测试用例在物理上是真实的，并且经过适当设计以测试该数值方法的属性。因此，我们可以着手求解。\n\n该问题的基础是在平板几何中角通量 $\\psi(x,\\mu)$ 的一维、单能、线性 Boltzmann 输运方程，表示为：\n$$\n\\mu \\frac{\\partial \\psi(x, \\mu)}{\\partial x} + \\sigma_t(x) \\psi(x, \\mu) = \\frac{\\sigma_s(x)}{2} \\int_{-1}^{1} \\psi(x, \\mu') d\\mu' + \\frac{Q(x)}{2}\n$$\n问题指定了常数截面 $\\sigma_t$ 和 $\\sigma_s$，以及均匀源 $Q$。标量通量定义为 $\\phi(x) = \\int_{-1}^{1} \\psi(x, \\mu) d\\mu$。该方程简化为：\n$$\n\\mu \\frac{d\\psi(x, \\mu)}{dx} + \\sigma_t \\psi(x, \\mu) = \\frac{\\sigma_s}{2} \\phi(x) + \\frac{Q}{2}\n$$\n\n### **第 1 部分：离散化与菱形差分格式的推导**\n\n我们的第一步是对连续变量，即位置 $x$ 和方向余弦 $\\mu$ 进行离散化。\n\n**角度离散化：离散纵标（$S_N$）方法**\n\n离散纵标（$S_N$）方法使用数值求积法则来近似散射项中的角度积分。我们将连续变量 $\\mu$ 替换为一组离散的 $N$ 个方向 $\\{\\mu_m\\}_{m=1}^N$ 和相应的权重 $\\{w_m\\}_{m=1}^N$。问题指定了 Gauss-Legendre 求积，其权重满足 $\\sum_{m=1}^N w_m = 2$。标量通量则近似为：\n$$\n\\phi(x) \\approx \\phi_N(x) = \\sum_{m=1}^N w_m \\psi_m(x)\n$$\n其中 $\\psi_m(x) \\equiv \\psi(x, \\mu_m)$。将此式代入输运方程，得到一个包含 $N$ 个耦合常微分方程的方程组，每个方程对应一个离散方向 $\\mu_m$：\n$$\n\\mu_m \\frac{d\\psi_m(x)}{dx} + \\sigma_t \\psi_m(x) = \\frac{\\sigma_s}{2} \\sum_{j=1}^N w_j \\psi_j(x) + \\frac{Q}{2}\n$$\n\n**空间离散化**\n\n我们将空间域 $x \\in [0, L]$ 离散为 $N_{\\text{cells}}$ 个均匀网格。网格 $i$ 覆盖区间 $[x_{i-1/2}, x_{i+1/2}]$，均匀宽度为 $h = L/N_{\\text{cells}}$。网格 $i$ 的中心是 $x_i = (x_{i-1/2} + x_{i+1/2}) / 2$。\n\n为了推导数值格式，我们将方向 $m$ 的离散纵标方程在一个网格 $i$ 上积分：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\mu_m \\frac{d\\psi_m(x)}{dx} + \\sigma_t \\psi_m(x) \\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} S_m(x) dx\n$$\n其中 $S_m(x)$ 是方向 $m$ 的总源项：\n$$\nS_m(x) = \\frac{\\sigma_s}{2} \\phi(x) + \\frac{Q}{2}\n$$\n由于源是各向同性的，$S_m(x)$ 与 $m$无关，因此我们将其记为 $S(x)$。\n\n对第一项应用微积分基本定理，并假设网格内 $\\sigma_t$ 为常数，我们得到：\n$$\n\\mu_m [\\psi_m(x_{i+1/2}) - \\psi_m(x_{i-1/2})] + \\sigma_t \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi_m(x) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} S(x) dx\n$$\n我们将界面通量表示为 $\\psi_{m, i-1/2} = \\psi_m(x_{i-1/2})$ 和 $\\psi_{m, i+1/2} = \\psi_m(x_{i+1/2})$。现在我们引入有限体积法的两个关键近似：\n1. 我们近似网格平均通量 $\\psi_{m,i} = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi_m(x) dx$ 和网格平均源 $S_i = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} S(x) dx$。这将积分方程转化为网格 $i$ 的代数平衡方程：\n$$\n\\frac{\\mu_m}{h} (\\psi_{m, i+1/2} - \\psi_{m, i-1/2}) + \\sigma_t \\psi_{m,i} = S_i\n$$\n2. **菱形差分格式** 提供了一个连接网格平均通量 $\\psi_{m,i}$ 和界面通量的封闭关系。它假设网格平均通量是网格边界上通量的算术平均值：\n$$\n\\psi_{m,i} = \\frac{\\psi_{m, i-1/2} + \\psi_{m, i+1/2}}{2}\n$$\n这个关系等同于假设通量在网格内呈线性变化。\n\n将菱形差分封闭关系代入平衡方程得到：\n$$\n\\frac{\\mu_m}{h} (\\psi_{m, i+1/2} - \\psi_{m, i-1/2}) + \\sigma_t \\left( \\frac{\\psi_{m, i-1/2} + \\psi_{m, i+1/2}}{2} \\right) = S_i\n$$\n两边乘以 $h$ 并重新整理各项：\n$$\n\\mu_m (\\psi_{m, i+1/2} - \\psi_{m, i-1/2}) + \\frac{\\sigma_t h}{2} (\\psi_{m, i-1/2} + \\psi_{m, i+1/2}) = S_i h\n$$\n$$\n\\psi_{m, i+1/2} \\left( \\mu_m + \\frac{\\sigma_t h}{2} \\right) - \\psi_{m, i-1/2} \\left( \\mu_m - \\frac{\\sigma_t h}{2} \\right) = S_i h\n$$\n这个核心方程允许我们通过求解给定入射通量时的出射通量来推导界面更新关系。扫描的方向取决于 $\\mu_m$ 的符号。\n\n**情况 1：正向扫描（$\\mu_m  0$）**\n粒子从左向右行进。对于网格 $i$，入射通量是 $\\psi_{m, i-1/2}$，出射通量是 $\\psi_{m, i+1/2}$。我们求解 $\\psi_{m, i+1/2}$：\n$$\n\\psi_{m, i+1/2} = \\frac{\\mu_m - \\frac{\\sigma_t h}{2}}{\\mu_m + \\frac{\\sigma_t h}{2}} \\psi_{m, i-1/2} + \\frac{S_i h}{\\mu_m + \\frac{\\sigma_t h}{2}}\n$$\n该公式对 $i = 0, 1, \\dots, N_{\\text{cells}}-1$ 顺序应用。真空边界条件提供了起始值：对于所有 $\\mu_m  0$，有 $\\psi_{m, -1/2} \\equiv \\psi_m(0) = 0$。\n\n**情况 2：反向扫描（$\\mu_m  0$）**\n粒子从右向左行进。对于网格 $i$，入射通量是 $\\psi_{m, i+1/2}$，出射通量是 $\\psi_{m, i-1/2}$。我们求解 $\\psi_{m, i-1/2}$。使用 $|\\mu_m| = -\\mu_m$ 会很方便：\n$$\n\\psi_{m, i-1/2} \\left( -\\mu_m + \\frac{\\sigma_t h}{2} \\right) - \\psi_{m, i+1/2} \\left( -\\mu_m - \\frac{\\sigma_t h}{2} \\right) = S_i h\n$$\n$$\n\\psi_{m, i-1/2} \\left( |\\mu_m| + \\frac{\\sigma_t h}{2} \\right) = \\psi_{m, i+1/2} \\left( |\\mu_m| - \\frac{\\sigma_t h}{2} \\right) + S_i h\n$$\n$$\n\\psi_{m, i-1/2} = \\frac{|\\mu_m| - \\frac{\\sigma_t h}{2}}{|\\mu_m| + \\frac{\\sigma_t h}{2}} \\psi_{m, i+1/2} + \\frac{S_i h}{|\\mu_m| + \\frac{\\sigma_t h}{2}}\n$$\n该公式对 $i = N_{\\text{cells}}-1, \\dots, 1, 0$ 顺序应用。真空边界条件提供了起始值：对于所有 $\\mu_m  0$，有 $\\psi_{m, N_{\\text{cells}}-1/2 + 1} \\equiv \\psi_m(L) = 0$。\n\n菱形差分格式的一个已知问题是，如果网格的光学厚度很大（具体来说，如果 $\\sigma_t h  2|\\mu_m|$），出射通量可能会变为负值。该问题正是为了探测这一特性而设计的。\n\n### **第 2 部分：源迭代算法**\n\n源迭代（SI）是一种求解耦合系统的迭代方法。散射源项依赖于标量通量，而标量通量又依赖于所有方向的角通量。SI 通过使用上一次迭代的标量通量 $\\phi^{(k)}$ 来计算当前迭代 $k+1$ 的源，从而解耦该系统。算法流程如下：\n\n1.  **初始化**：\n    - 设置迭代计数器 $k=0$。\n    - 将网格中心标量通量向量初始化为零：对于所有网格 $i=0, \\dots, N_{\\text{cells}}-1$，$\\phi^{(0)}_i = 0$。\n    - 将全局正性标志设置为真。\n    - 将总浮点运算（FLOP）计数初始化为 $0$。\n\n2.  **迭代循环**：对 $k = 0, 1, 2, \\dots$ 重复循环，直到收敛或达到最大迭代次数。\n    a. **源计算**：使用上一次迭代的标量通量 $\\phi^{(k)}$ 计算每个网格 $i_c$ 的源：\n    $$\n    S_i^{(k+1)} = \\frac{\\sigma_s}{2} \\phi^{(k)}_i + \\frac{Q}{2}\n    $$\n    b. **输运扫描**：对每个离散方向 $m=1, \\dots, N$：\n        - 如果 $\\mu_m  0$，则从 $i=0$ 到 $N_{\\text{cells}}-1$ 执行正向扫描，起始条件为 $\\psi_{m,-1/2} = 0$。使用更新关系计算每个网格的 $\\psi_{m, i+1/2}$。\n        - 如果 $\\mu_m  0$，则从 $i=N_{\\text{cells}}-1$ 到 $0$ 执行反向扫描，起始条件为 $\\psi_{m, N_{\\text{cells}}-1/2+1}=0$。使用更新关系计算每个网格的 $\\psi_{m, i-1/2}$。\n        - 在扫描过程的每个网格 $i$ 中，一旦出射界面通量已知，就使用菱形差分关系计算网格平均角通量 $\\psi_{m,i}^{(k+1)}$。\n        - 检查计算出的界面通量和网格平均通量是否为非负（在指定容差内）。如果发现任何负值，则更新全局正性标志。\n    c. **标量通量更新**：在扫描完所有 $N$ 个方向后，通过对所有方向的贡献求和来计算新的标量通量 $\\phi^{(k+1)}$：\n    $$\n    \\phi^{(k+1)}_i = \\sum_{m=1}^N w_m \\psi_{m,i}^{(k+1)}\n    $$\n    这通常是在对网格 $i$ 的每个方向扫描步骤结束时，将乘积 $w_m \\psi_{m,i}^{(k+1)}$ 累加到 $\\phi_i^{(k+1)}$ 中来完成的。\n    d. **FLOP 计数**：将总 FLOP 计数增加一次迭代所指定的数量：$4 \\cdot (N/2) + 3 \\cdot N_{\\text{cells}} + 7 \\cdot N_{\\text{cells}} \\cdot N$。\n    e. **收敛性检查**：计算欧几里得（$\\ell^2$）范数下的相对误差：\n    $$\n    \\text{err} = \\frac{\\|\\phi^{(k+1)} - \\phi^{(k)}\\|_2}{\\|\\phi^{(k+1)}\\|_2}\n    $$\n    如果 $\\text{err}  \\epsilon$，则解已收敛。终止循环。\n\n3.  **完成**：\n    - 记录中心网格的标量通量值 $\\phi(\\lfloor N_{\\text{cells}}/2 \\rfloor)$。\n    - 记录最终的正性标志。\n    - 记录收敛所需的迭代次数。\n    - 记录估算的总 FLOP 计数。\n\n对于纯吸收剂（$\\sigma_s = 0$）的特殊情况，源项 $S_i = Q/2$ 是常数，不依赖于通量。第一次输运扫描（$k=0$）将产生精确解 $\\phi^{(1)}$。第二次迭代（$k=1$）将使用此 $\\phi^{(1)}$ 计算源，但由于 $\\sigma_s=0$，源保持为 $Q/2$。因此，第二次扫描将产生 $\\phi^{(2)} = \\phi^{(1)}$。收敛判据将以零误差满足，并且根据指定的循环结构，算法将在两次迭代后终止。",
            "answer": "[[1.713917711915473, True, 8, 38480], [0.26425713437295775, False, 4, 3088], [0.9998246473138833, True, 2, 14208]]"
        }
    ]
}