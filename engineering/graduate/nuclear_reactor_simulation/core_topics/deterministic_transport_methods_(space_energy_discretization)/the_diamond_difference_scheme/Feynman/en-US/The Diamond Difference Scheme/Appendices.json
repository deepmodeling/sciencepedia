{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a concrete starting point for working with the diamond difference scheme. By analyzing a simple, source-free, single-cell problem, you will apply the core DD formula to compute fundamental quantities like outgoing angular flux and net current, and derive the well-known positivity constraint from first principles. ",
            "id": "4237955",
            "problem": "Consider one homogeneous spatial cell in one-dimensional slab geometry spanning from $x=0$ to $x=\\Delta x$, with uniform total macroscopic cross section $\\Sigma_{t}$ and no scattering or fixed source inside the cell. The steady-state neutron transport equation for the angular flux $\\psi(x,\\mu)$ in one-dimensional slab geometry is $\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_{t} \\psi(x,\\mu) = Q(x,\\mu)$, and in this cell $Q(x,\\mu)=0$. The discrete ordinates (SN) approximation is employed with the $S_{2}$ Gaussian-Legendre quadrature; use the two ordinates $\\mu_{1}=+0.5773502692$ with weight $w_{1}=1.0$ and $\\mu_{2}=-0.5773502692$ with weight $w_{2}=1.0$. The boundary conditions are vacuum at $x=\\Delta x$ for $\\mu<0$ and prescribed inflow at $x=0$ for $\\mu>0$: $\\psi(0,\\mu_{1})=\\psi_{\\text{in}}$ and $\\psi(\\Delta x,\\mu_{2})=0$, where $\\psi_{\\text{in}}=1.0 \\times 10^{12}$.\n\nUse the diamond-difference discretization in this single cell, in which the streaming term is approximated by $\\frac{\\psi_{R} - \\psi_{L}}{\\Delta x}$ and the cell-centered flux by $\\frac{\\psi_{R} + \\psi_{L}}{2}$, where $\\psi_{L}=\\psi(0,\\mu)$ and $\\psi_{R}=\\psi(\\Delta x,\\mu)$ denote the cell-edge angular fluxes for a given direction $\\mu$. Starting from the steady-state neutron transport equation and these definitions, derive the relations for the cell-edge angular fluxes $\\psi_{R}$ as functions of $\\psi_{L}$ and the parameters $\\mu$, $\\Sigma_{t}$, and $\\Delta x$ for each discrete direction. Then compute the outgoing angular fluxes at $x=\\Delta x$ for $\\mu_{1}>0$ and $\\mu_{2}<0$ under the stated boundary conditions, and deduce the net current through the right face at $x=\\Delta x$, defined as $J_{R}=\\sum_{m} w_{m} \\mu_{m} \\psi(\\Delta x,\\mu_{m})$.\n\nFinally, assess the positivity of the diamond-difference update by identifying the constraint on $\\Sigma_{t} \\Delta x$ relative to $|\\mu|$ under which the computed angular fluxes remain nonnegative in a source-free cell. Report the net current $J_{R}$ as your final answer, rounded to four significant figures, and express it in neutrons per square centimeter per second.\nGiven data: $\\Delta x = 1.0 \\ \\text{cm}$, $\\Sigma_{t} = 0.5 \\ \\text{cm}^{-1}$, $\\psi_{\\text{in}} = 1.0 \\times 10^{12}$, $\\mu_{1} = +0.5773502692$, $w_{1}=1.0$, $\\mu_{2}=-0.5773502692$, $w_{2}=1.0$.",
            "solution": "The problem posed is scientifically sound, well-posed, and contains all necessary information for a unique solution. It is based on fundamental principles of neutron transport theory and standard numerical methods. We may therefore proceed with the solution.\n\nThe problem requires an analysis of a single homogeneous cell in one-dimensional slab geometry using the discrete ordinates ($S_N$) method with a diamond-difference (DD) spatial discretization. The governing equation is the steady-state, source-free neutron transport equation:\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = 0\n$$\nwhere $\\psi(x,\\mu)$ is the angular neutron flux at position $x$ in direction $\\mu$, and $\\Sigma_t$ is the total macroscopic cross section. The discrete ordinates method evaluates this equation at a set of discrete directions $\\mu_m$. For this problem, we use the $S_2$ quadrature set: $\\mu_1 = 0.5773502692$ and $\\mu_2 = -0.5773502692$.\n\nFirst, we derive the general diamond-difference relation. The DD scheme approximates the transport equation over the spatial cell from $x=0$ to $x=\\Delta x$ by evaluating the loss term at the cell center and the streaming term using the cell-edge fluxes. The cell-edge fluxes for a given direction $\\mu$ are denoted $\\psi_L = \\psi(0, \\mu)$ and $\\psi_R = \\psi(\\Delta x, \\mu)$. The DD approximations are:\n$$\n\\frac{\\partial \\psi(x,\\mu)}{\\partial x} \\approx \\frac{\\psi_R - \\psi_L}{\\Delta x}\n$$\n$$\n\\psi_{\\text{cell-average}} \\approx \\frac{\\psi_L + \\psi_R}{2}\n$$\nSubstituting these approximations into the transport equation for a discrete direction $\\mu_m$:\n$$\n\\mu_m \\left( \\frac{\\psi_R - \\psi_L}{\\Delta x} \\right) + \\Sigma_t \\left( \\frac{\\psi_L + \\psi_R}{2} \\right) = 0\n$$\nTo derive the relation for the cell-edge fluxes, we rearrange this algebraic equation. Multiplying by $2\\Delta x$ to clear the denominators gives:\n$$\n2\\mu_m (\\psi_R - \\psi_L) + \\Sigma_t \\Delta x (\\psi_L + \\psi_R) = 0\n$$\nWe gather terms associated with $\\psi_R$ and $\\psi_L$:\n$$\n\\psi_R (2\\mu_m + \\Sigma_t \\Delta x) - \\psi_L (2\\mu_m - \\Sigma_t \\Delta x) = 0\n$$\nThis leads to the desired relation for the outgoing flux $\\psi_R$ as a function of the incoming flux $\\psi_L$ (for $\\mu_m > 0$):\n$$\n\\psi_R = \\psi_L \\left( \\frac{2\\mu_m - \\Sigma_t \\Delta x}{2\\mu_m + \\Sigma_t \\Delta x} \\right)\n$$\nThis is the general diamond-difference update formula for a source-free region.\n\nNext, we assess the positivity of this scheme. An incoming flux $\\psi_{\\text{in}} \\ge 0$ must produce an outgoing flux $\\psi_{\\text{out}} \\ge 0$.\nFor $\\mu_m > 0$, neutrons travel from left to right. Thus, $\\psi_L$ is the incoming flux and $\\psi_R$ is the outgoing flux. For $\\psi_R$ to be non-negative, since $\\psi_L \\ge 0$ and the denominator $(2\\mu_m + \\Sigma_t \\Delta x)$ is always positive, the numerator must be non-negative:\n$$\n2\\mu_m - \\Sigma_t \\Delta x \\ge 0 \\implies \\Sigma_t \\Delta x \\le 2\\mu_m\n$$\nFor $\\mu_m < 0$, neutrons travel from right to left. Thus, $\\psi_R$ is the incoming flux and $\\psi_L$ is the outgoing flux. We must express $\\psi_L$ in terms of $\\psi_R$:\n$$\n\\psi_L = \\psi_R \\left( \\frac{2\\mu_m + \\Sigma_t \\Delta x}{2\\mu_m - \\Sigma_t \\Delta x} \\right)\n$$\nLet $\\mu_m = -|\\mu_m|$. Substituting this gives:\n$$\n\\psi_L = \\psi_R \\left( \\frac{-2|\\mu_m| + \\Sigma_t \\Delta x}{-2|\\mu_m| - \\Sigma_t \\Delta x} \\right) = \\psi_R \\left( \\frac{-(2|\\mu_m| - \\Sigma_t \\Delta x)}{-(2|\\mu_m| + \\Sigma_t \\Delta x)} \\right) = \\psi_R \\left( \\frac{2|\\mu_m| - \\Sigma_t \\Delta x}{2|\\mu_m| + \\Sigma_t \\Delta x} \\right)\n$$\nFor $\\psi_L$ to be non-negative, since $\\psi_R \\ge 0$, the numerator must be non-negative:\n$$\n2|\\mu_m| - \\Sigma_t \\Delta x \\ge 0 \\implies \\Sigma_t \\Delta x \\le 2|\\mu_m|\n$$\nThus, the general constraint for the diamond-difference scheme to guarantee non-negative fluxes in a source-free region is $\\Sigma_t \\Delta x \\le 2|\\mu_m|$. The product $\\Sigma_t \\Delta x$ represents the optical thickness of the cell.\n\nWe now check this condition with the given data: $\\Delta x = 1.0 \\, \\text{cm}$, $\\Sigma_t = 0.5 \\, \\text{cm}^{-1}$, and $|\\mu_m|=0.5773502692$.\nThe optical thickness is $\\Sigma_t \\Delta x = (0.5 \\, \\text{cm}^{-1})(1.0 \\, \\text{cm}) = 0.5$.\nThe positivity limit is $2|\\mu_m| = 2(0.5773502692) \\approx 1.1547$.\nSince $0.5 < 1.1547$, the positivity condition is satisfied for this problem.\n\nNow we compute the angular fluxes at the right face of the cell, $x=\\Delta x$.\nFor the direction $\\mu_1 = 0.5773502692 > 0$, neutrons travel from left to right. The incoming flux is specified by the boundary condition at $x=0$: $\\psi_L = \\psi(0, \\mu_1) = \\psi_{\\text{in}} = 1.0 \\times 10^{12}$. The outgoing flux at $x=\\Delta x$ is $\\psi_R = \\psi(\\Delta x, \\mu_1)$. Using the derived relation:\n$$\n\\psi(\\Delta x, \\mu_1) = \\psi_{\\text{in}} \\left( \\frac{2\\mu_1 - \\Sigma_t \\Delta x}{2\\mu_1 + \\Sigma_t \\Delta x} \\right) = (1.0 \\times 10^{12}) \\left( \\frac{2(0.5773502692) - 0.5}{2(0.5773502692) + 0.5} \\right)\n$$\n$$\n\\psi(\\Delta x, \\mu_1) = (1.0 \\times 10^{12}) \\left( \\frac{1.1547005384 - 0.5}{1.1547005384 + 0.5} \\right) = (1.0 \\times 10^{12}) \\left( \\frac{0.6547005384}{1.6547005384} \\right)\n$$\n$$\n\\psi(\\Delta x, \\mu_1) \\approx 0.395662706 \\times 10^{12}\n$$\nFor the direction $\\mu_2 = -0.5773502692 < 0$, neutrons travel from right to left. The flux at $x=\\Delta x$ is an incoming flux for the cell, which is specified by the vacuum boundary condition at the right boundary of the domain:\n$$\n\\psi(\\Delta x, \\mu_2) = 0\n$$\n\nFinally, we compute the net current through the right face at $x=\\Delta x$. The definition is given as:\n$$\nJ_R = \\sum_{m} w_{m} \\mu_{m} \\psi(\\Delta x, \\mu_m) = w_1 \\mu_1 \\psi(\\Delta x, \\mu_1) + w_2 \\mu_2 \\psi(\\Delta x, \\mu_2)\n$$\nThe given quadrature weights are $w_1 = 1.0$ and $w_2 = 1.0$. Substituting the values we have found:\n$$\nJ_R = (1.0)(0.5773502692)(0.395662706 \\times 10^{12}) + (1.0)(-0.5773502692)(0)\n$$\n$$\nJ_R = (0.5773502692)(0.395662706 \\times 10^{12}) + 0\n$$\n$$\nJ_R \\approx 0.22842450 \\times 10^{12} = 2.2842450 \\times 10^{11}\n$$\nThe problem requests the answer rounded to four significant figures.\n$$\nJ_R \\approx 2.284 \\times 10^{11}\n$$\nThe units are neutrons per square centimeter per second, as is standard for neutron current.",
            "answer": "$$\\boxed{2.284 \\times 10^{11}}$$"
        },
        {
            "introduction": "Building on the single-cell analysis, this problem explores the broader implications of the diamond difference scheme's properties for a full transport sweep. You will derive the general positivity condition in terms of a cell's optical thickness, $\\tau$, and prove how satisfying this condition ensures the desirable trait of monotonic convergence for the source iteration algorithm. This practice connects the local discretization choice to the global behavior of the numerical solver. ",
            "id": "4250966",
            "problem": "Consider the one-dimensional, steady-state, monoenergetic linear transport equation in slab geometry for angular flux $\\psi(x,\\mu)$,\n$$\n\\mu\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t(x)\\psi(x,\\mu) = \\frac{\\Sigma_s(x)}{2}\\phi(x) + \\frac{q(x)}{2},\n$$\nwith scalar flux $\\phi(x) = \\int_{-1}^{1}\\psi(x,\\mu)\\,d\\mu$, total macroscopic cross section $\\Sigma_t(x) > 0$, scattering cross section $\\Sigma_s(x) \\in [0,\\Sigma_t(x))$, and isotropic fixed external source $q(x) \\ge 0$. Discretize angle using the discrete ordinates (SN) method on a set of directions $\\{\\mu_m, w_m\\}_{m=1}^{M}$ with $\\mu_m \\in (-1,1)$ and positive weights $\\{w_m\\}$ satisfying $\\sum_{m=1}^{M} w_m = 2$. Discretize space on a uniform mesh of cell width $h > 0$ with cell edges at $x_{i \\pm 1/2}$, and adopt the standard cell-balance finite-volume scheme with the diamond-difference closure\n$$\n\\psi_{i,m} = \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right),\n$$\nwhere $\\psi_{i\\pm \\frac{1}{2},m}$ are edge values and $\\psi_{i,m}$ is the cell-average surrogate in direction $\\mu_m$.\n\n(a) Starting from the cell-balance form of the transport equation over cell $i$ in a given direction with $\\mu_m > 0$, derive the linear sweep relation\n$$\n\\psi_{i+\\frac{1}{2},m} = \\alpha_{i,m}\\psi_{i-\\frac{1}{2},m} + \\beta_{i,m}Q_{i,m},\n$$\nwhere $Q_{i,m}$ is the known cell-averaged total source in direction $\\mu_m$ at the current iteration (including external and scattering contributions). Express $\\alpha_{i,m}$ and $\\beta_{i,m}$ in terms of $\\mu_m$, $h$, and $\\Sigma_{t,i}$. Identify the conditions on these coefficients that ensure a nonnegative incoming angular flux $\\psi_{i-\\frac{1}{2},m} \\ge 0$ and a nonnegative source $Q_{i,m} \\ge 0$ produce a nonnegative outgoing angular flux $\\psi_{i+\\frac{1}{2},m} \\ge 0$. Explain under what conditions the diamond-difference discretization may violate positivity.\n\n(b) Using your expressions, reduce the positivity conditions to a single sufficient inequality on the per-angle, per-cell optical thickness\n$$\n\\tau_{i,m} := \\frac{\\Sigma_{t,i}h}{|\\mu_m|}.\n$$\nState the resulting bound as an explicit inequality relating $\\Sigma_{t,i}$, $h$, and $|\\mu_m|$ for all cells $i$ and all angles $m$.\n\n(c) Consider source iteration for isotropic scattering with scattering ratio $c := \\Sigma_s/\\Sigma_t \\in [0,1)$. Let the scalar flux update be defined by solving the transport equation in each iteration with the total source $Q_{i,m}^{(k)} = \\frac{1}{2} q_i + \\frac{\\Sigma_{s,i}}{2}\\phi_i^{(k)}$, and building $\\phi^{(k+1)}$ from the new angular flux by weighted summation. Prove that, if the transport sweep operator defined by the diamond-difference discretization is positive in the sense of part (a), then starting from $\\phi^{(0)} \\equiv 0$ and for $q_i \\ge 0$, the iterates $\\phi^{(k)}$ form a monotone nondecreasing sequence in the partial order induced by componentwise inequality.\n\n(d) Finally, for a homogeneous slab with $\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}$ and a symmetrically weighted quadrature whose smallest positive directional cosine is $\\mu_{\\min} = 0.183434642$, compute the largest uniform cell width $h_{\\max}$ in $\\mathrm{cm}$ that guarantees the monotonicity of source iteration updates under diamond-difference, as established in parts (a)â€“(c). Round your answer to $4$ significant figures and express it in $\\mathrm{cm}$.",
            "solution": "We begin from the one-dimensional, steady-state, monoenergetic linear transport equation discretized in angle and space. For a given cell $i$ of width $h$ spanning $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}}]$ and a direction $\\mu_m > 0$, the finite-volume balance over the cell gives\n$$\n\\mu_m\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} + \\Sigma_{t,i}\\psi_{i,m} = Q_{i,m},\n$$\nwhere $Q_{i,m}$ is the known total source per steradian within the cell for direction $m$ at the current iteration, and $\\psi_{i,m}$ is closed by the diamond-difference relation\n$$\n\\psi_{i,m} = \\frac{1}{2}\\left(\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}\\right).\n$$\n\nPart (a). Substituting the diamond-difference closure into the balance yields\n$$\n\\mu_m\\frac{\\psi_{i+\\frac{1}{2},m} - \\psi_{i-\\frac{1}{2},m}}{h} + \\Sigma_{t,i}\\frac{\\psi_{i+\\frac{1}{2},m} + \\psi_{i-\\frac{1}{2},m}}{2} = Q_{i,m}.\n$$\nCollect the unknowns at $x_{i+\\frac{1}{2}}$ on the left:\n$$\n\\left(\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i+\\frac{1}{2},m} + \\left(-\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}\\right)\\psi_{i-\\frac{1}{2},m} = Q_{i,m}.\n$$\nSolving for $\\psi_{i+\\frac{1}{2},m}$ gives the linear sweep relation\n$$\n\\psi_{i+\\frac{1}{2},m} = \\alpha_{i,m}\\psi_{i-\\frac{1}{2},m} + \\beta_{i,m}Q_{i,m},\n$$\nwith coefficients\n$$\n\\alpha_{i,m} = \\frac{\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}} = \\frac{2\\frac{\\mu_m}{h} - \\Sigma_{t,i}}{2\\frac{\\mu_m}{h} + \\Sigma_{t,i}},\n\\qquad\n\\beta_{i,m} = \\frac{1}{\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}}.\n$$\nThe denominator $\\frac{\\mu_m}{h} + \\frac{\\Sigma_{t,i}}{2}$ is strictly positive for $\\mu_m > 0$, $h > 0$, and $\\Sigma_{t,i} > 0$. Therefore $\\beta_{i,m} > 0$ always. The sign of $\\alpha_{i,m}$ is determined by the numerator $\\frac{\\mu_m}{h} - \\frac{\\Sigma_{t,i}}{2}$. If $\\alpha_{i,m} \\ge 0$ and $\\beta_{i,m} > 0$, then for $\\psi_{i-\\frac{1}{2},m} \\ge 0$ and $Q_{i,m} \\ge 0$, we have $\\psi_{i+\\frac{1}{2},m} \\ge 0$, establishing positivity of the sweep update in that direction. Conversely, if $\\alpha_{i,m} < 0$, then even with $\\psi_{i-\\frac{1}{2},m} \\ge 0$ and $Q_{i,m} \\ge 0$, the term $\\alpha_{i,m}\\psi_{i-\\frac{1}{2},m}$ becomes nonpositive; if it dominates $\\beta_{i,m}Q_{i,m}$, it can produce $\\psi_{i+\\frac{1}{2},m} < 0$. Hence, the diamond-difference discretization may violate positivity when $\\alpha_{i,m} < 0$, which occurs for sufficiently optically thick cells.\n\nPart (b). Introduce the per-angle, per-cell optical thickness\n$$\n\\tau_{i,m} := \\frac{\\Sigma_{t,i}h}{|\\mu_m|}.\n$$\nFor $\\mu_m > 0$, we have\n$$\n\\alpha_{i,m} = \\frac{2 - \\tau_{i,m}}{2 + \\tau_{i,m}}.\n$$\nPositivity of the sweep mapping for nonnegative incoming flux and nonnegative source is ensured if and only if $\\alpha_{i,m} \\ge 0$ and $\\beta_{i,m} > 0$. As argued, $\\beta_{i,m} > 0$ always. Thus, the sufficient condition reduces to\n$$\n\\alpha_{i,m} \\ge 0 \\quad \\Longleftrightarrow \\quad 2 - \\tau_{i,m} \\ge 0 \\quad \\Longleftrightarrow \\quad \\tau_{i,m} \\le 2.\n$$\nBy symmetry, for $\\mu_m < 0$ the same condition with $|\\mu_m|$ applies. Therefore, a sufficient positivity condition for the diamond-difference sweep in every cell and every discrete direction is\n$$\n\\frac{\\Sigma_{t,i}h}{|\\mu_m|} \\le 2 \\quad \\text{for all cells } i \\text{ and all angles } m,\n$$\nequivalently,\n$$\nh \\le \\frac{2|\\mu_m|}{\\Sigma_{t,i}} \\quad \\text{for all } i,m.\n$$\nOn a given mesh and angle set, the most restrictive bound uses the smallest positive directional cosine $\\mu_{\\min} := \\min_{m:\\, \\mu_m > 0} \\mu_m$ and the largest cell-wise total cross section $\\Sigma_{t,\\max} := \\max_i \\Sigma_{t,i}$, giving the global sufficient condition\n$$\nh \\le \\frac{2\\mu_{\\min}}{\\Sigma_{t,\\max}}.\n$$\n\nPart (c). Let $\\mathcal{L}$ denote the transport operator mapping an angular flux to its streaming-plus-absorption residual, discretized in space and angle with diamond-difference, and let $\\mathcal{L}^{-1}$ denote the corresponding sweep operator that maps a given total source $Q$ to the unique upwinded angular flux $\\psi$. Under the condition from part (b), each cell-angle sweep update has nonnegative coefficients that depend only on local data, so $\\mathcal{L}^{-1}$ is a positive linear operator: for any two total sources $Q,Q'$ with $Q \\ge Q'$ componentwise, one has $\\mathcal{L}^{-1}Q \\ge \\mathcal{L}^{-1}Q'$ componentwise.\n\nFor isotropic scattering with scattering ratio $c = \\Sigma_s/\\Sigma_t \\in [0,1)$, define the positive linear scattering operator $\\mathcal{S}$ that maps a scalar flux $\\phi$ to the isotropic angular source with components $(\\mathcal{S}\\phi)_{i,m} = \\frac{\\Sigma_{s,i}}{2}\\phi_i$. The external source $q$ induces a nonnegative isotropic angular source $\\mathcal{Q}_{\\mathrm{ext}}$ with components $(\\mathcal{Q}_{\\mathrm{ext}})_{i,m} = \\frac{q_i}{2}$. Source iteration is the fixed-point iteration\n$$\n\\psi^{(k+1)} = \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\phi^{(k)}\\right), \\qquad \\phi^{(k+1)} = \\sum_{m=1}^{M} w_m\\psi^{(k+1)}_{(\\cdot),m},\n$$\nwith initialization $\\phi^{(0)} \\equiv 0$. Let the angular-to-scalar averaging operator $\\mathcal{A}$ be defined by $\\mathcal{A}\\psi = \\sum_{m=1}^{M} w_m\\psi_{(\\cdot),m}$; this operator has nonnegative weights and is therefore positive in the order sense.\n\nWe prove by induction that $\\phi^{(k)}$ is monotone nondecreasing. The base case: $\\phi^{(0)} = 0$. Then $\\psi^{(1)} = \\mathcal{L}^{-1}\\mathcal{Q}_{\\mathrm{ext}} \\ge 0$ because $\\mathcal{Q}_{\\mathrm{ext}} \\ge 0$ and $\\mathcal{L}^{-1}$ is positive. Consequently $\\phi^{(1)} = \\mathcal{A}\\psi^{(1)} \\ge 0 = \\phi^{(0)}$. Assume $\\phi^{(k)} \\ge \\phi^{(k-1)}$. Since $\\mathcal{S}$ is positive, $\\mathcal{S}\\phi^{(k)} \\ge \\mathcal{S}\\phi^{(k-1)}$. Therefore\n$$\n\\psi^{(k+1)} = \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\phi^{(k)}\\right) \\ge \\mathcal{L}^{-1}\\!\\left(\\mathcal{Q}_{\\mathrm{ext}} + \\mathcal{S}\\phi^{(k-1)}\\right) = \\psi^{(k)},\n$$\nby the positivity of $\\mathcal{L}^{-1}$. Applying the positive averaging operator $\\mathcal{A}$, we obtain $\\phi^{(k+1)} = \\mathcal{A}\\psi^{(k+1)} \\ge \\mathcal{A}\\psi^{(k)} = \\phi^{(k)}$. Hence, $\\{\\phi^{(k)}\\}$ is a monotone nondecreasing sequence. This conclusion relies on the positivity (order-preserving property) of the sweep mapping, which is ensured by the bound $\\tau_{i,m} \\le 2$ from part (b).\n\nPart (d). In a homogeneous slab with $\\Sigma_t = 1.2\\,\\mathrm{cm}^{-1}$ and the smallest positive directional cosine $\\mu_{\\min} = 0.183434642$, the sufficient condition for positivity across all angles reduces to\n$$\nh \\le \\frac{2\\mu_{\\min}}{\\Sigma_t}.\n$$\nThus, the largest admissible uniform cell width is\n$$\nh_{\\max} = \\frac{2\\mu_{\\min}}{\\Sigma_t} = \\frac{2 \\times 0.183434642}{1.2} = \\frac{0.366869284}{1.2} = 0.305724403\\ldots.\n$$\nRounded to $4$ significant figures and expressed in $\\mathrm{cm}$, this gives\n$$\nh_{\\max} = 0.3057.\n$$\nThis bound guarantees that the diamond-difference sweep operator is positive in every cell and direction, and therefore that source iteration updates are monotone nondecreasing under the stated hypotheses.",
            "answer": "$$\\boxed{0.3057}$$"
        },
        {
            "introduction": "In practical simulations, the diamond difference positivity condition is often violated, leading to unphysical negative fluxes. This final exercise tackles this issue by having you design and analyze a \"flux limiter,\" a common fixup technique that blends the higher-order DD scheme with the more robust (but lower-order) step characteristics method. You will not only implement the fixup but also quantify the resulting errors in consistency and particle conservation, a crucial step in evaluating any numerical correction. ",
            "id": "4237673",
            "problem": "Consider one-dimensional, steady-state neutron transport in a homogeneous slab, modeled by the angular flux $\\psi(x,\\mu)$ satisfying the transport equation $\\mu \\frac{d \\psi}{d x} + \\Sigma_{t} \\psi = q$, where $\\mu$ is the direction cosine for one discrete direction in the Discrete Ordinates (SN) method, $\\Sigma_{t}$ is the macroscopic total cross section, and $q$ is a constant angular source term. In a uniform spatial cell of width $\\Delta x$, assume $\\mu > 0$ so that information propagates from the left face to the right face. Denote the incoming angular flux at the left face by $\\psi_{L}$ and the outgoing angular flux at the right face by $\\psi_{R}$.\n\nStarting from the transport equation and without invoking any pre-given update formulas, derive:\n- The exact right-face angular flux obtained by the Step Characteristics (SC) method (defined here as the analytical solution along the characteristic),\n- The right-face angular flux predicted by the Diamond Difference (DD) method (defined here by central differencing of the streaming term and arithmetic averaging of the collision term within the cell).\n\nNext, design a positivity-preserving limiter that blends DD and SC when DD predicts a negative outgoing angular flux. Specifically, define a blended outgoing flux $\\psi_{R}^{\\text{blend}} = w \\psi_{R}^{\\text{DD}} + (1-w)\\psi_{R}^{\\text{SC}}$, where the blending coefficient $w$ is chosen minimally to enforce $\\psi_{R}^{\\text{blend}} \\ge 0$ whenever $\\psi_{R}^{\\text{DD}} < 0$, and $w = 1$ otherwise. Provide an explicit expression for $w$ in terms of $\\psi_{R}^{\\text{DD}}$ and $\\psi_{R}^{\\text{SC}}$ under the negative prediction case.\n\nNow quantify, for the blended flux, both a consistency error and a conservation error:\n- Define the consistency error as $E_{\\text{cons}} = \\left|\\psi_{R}^{\\text{blend}} - \\psi_{R}^{\\text{SC}}\\right|$.\n- Define the conservation error via the Diamond Difference cell-balance residual $R = \\frac{\\psi_{R}^{\\text{blend}} - \\psi_{L}}{h} + \\Sigma_{t}\\frac{\\psi_{L} + \\psi_{R}^{\\text{blend}}}{2} - q$, where $h = \\Delta x / \\mu$ is the track length across the cell. Express the conservation error in flux units by $E_{\\text{consrv}} = |R|/\\Sigma_{t}$.\n\nUse the following physically plausible data:\n- $\\Sigma_{t} = 1.5\\,\\text{cm}^{-1}$,\n- $\\Delta x = 3.0\\,\\text{cm}$,\n- $\\mu = 0.2$,\n- $q = 3.0 \\times 10^{-3}\\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$,\n- $\\psi_{L} = 6.0 \\times 10^{-3}\\,\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$.\n\nCompute $\\psi_{R}^{\\text{SC}}$, $\\psi_{R}^{\\text{DD}}$, the blending coefficient $w$ under the negative-DD prediction, and the resulting $\\psi_{R}^{\\text{blend}}$. Then compute $E_{\\text{cons}}$ and $E_{\\text{consrv}}$ as defined above. Round both $E_{\\text{cons}}$ and $E_{\\text{consrv}}$ to four significant figures. Express both error values in $\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$.",
            "solution": "The analysis begins by deriving the expressions for the outgoing flux from the Step Characteristics (SC) and Diamond Difference (DD) methods.\n\n**1. Derivation of the Step Characteristics (SC) Flux**\nThe SC method is defined as the exact analytical solution of the transport equation along the characteristic line. The governing equation is a first-order linear ordinary differential equation for $\\psi(x)$:\n$$ \\mu \\frac{d\\psi}{dx} + \\Sigma_t \\psi = q $$\nRearranging gives:\n$$ \\frac{d\\psi}{dx} + \\frac{\\Sigma_t}{\\mu} \\psi = \\frac{q}{\\mu} $$\nWe solve this using an integrating factor, $I(x) = \\exp\\left(\\int \\frac{\\Sigma_t}{\\mu} dx\\right) = \\exp\\left(\\frac{\\Sigma_t x}{\\mu}\\right)$. Let the cell start at $x=0$ and end at $x=\\Delta x$. The solution is given by:\n$$ \\psi(x) = \\psi(0) \\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right) + \\int_{0}^{x} \\frac{q}{\\mu} \\exp\\left(-\\frac{\\Sigma_t(x-x')}{\\mu}\\right) dx' $$\nWith $\\psi(0) = \\psi_L$ and evaluating at $x=\\Delta x$ to find $\\psi_R = \\psi(\\Delta x)$:\n$$ \\psi_R^{\\text{SC}} = \\psi_L \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right) + \\frac{q}{\\mu} \\int_{0}^{\\Delta x} \\exp\\left(-\\frac{\\Sigma_t(\\Delta x-x')}{\\mu}\\right) dx' $$\nThe integral evaluates to:\n$$ \\int_{0}^{\\Delta x} \\exp\\left(-\\frac{\\Sigma_t(\\Delta x-x')}{\\mu}\\right) dx' = \\left[ \\frac{\\mu}{\\Sigma_t} \\exp\\left(-\\frac{\\Sigma_t(\\Delta x-x')}{\\mu}\\right) \\right]_{0}^{\\Delta x} = \\frac{\\mu}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right)\\right) $$\nSubstituting this back gives the final SC relation:\n$$ \\psi_R^{\\text{SC}} = \\psi_L \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right) + \\frac{q}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t \\Delta x}{\\mu}\\right)\\right) $$\n\n**2. Derivation of the Diamond Difference (DD) Flux**\nThe DD method is derived from the balance equation over the cell, obtained by integrating the transport equation from $x=0$ to $x=\\Delta x$:\n$$ \\int_{0}^{\\Delta x} \\left(\\mu \\frac{d\\psi}{dx} + \\Sigma_t \\psi\\right) dx = \\int_{0}^{\\Delta x} q dx $$\n$$ \\mu (\\psi(\\Delta x) - \\psi(0)) + \\Sigma_t \\int_{0}^{\\Delta x} \\psi(x) dx = q \\Delta x $$\nUsing the notation $\\psi_L = \\psi(0)$, $\\psi_R = \\psi(\\Delta x)$, and defining the cell-average flux $\\bar{\\psi} = \\frac{1}{\\Delta x} \\int_{0}^{\\Delta x} \\psi(x) dx$, we get:\n$$ \\mu (\\psi_R - \\psi_L) + \\Sigma_t \\bar{\\psi} \\Delta x = q \\Delta x $$\nThe DD scheme approximates the cell-average flux with the arithmetic mean of the face fluxes:\n$$ \\bar{\\psi} \\approx \\frac{\\psi_L + \\psi_R}{2} $$\nSubstituting this into the balance equation gives the DD discrete equation:\n$$ \\mu (\\psi_R^{\\text{DD}} - \\psi_L) + \\Sigma_t \\Delta x \\left(\\frac{\\psi_L + \\psi_R^{\\text{DD}}}{2}\\right) = q \\Delta x $$\nWe now solve for the unknown outgoing flux, $\\psi_R^{\\text{DD}}$:\n$$ \\psi_R^{\\text{DD}} \\left(\\mu + \\frac{\\Sigma_t \\Delta x}{2}\\right) - \\psi_L \\left(\\mu - \\frac{\\Sigma_t \\Delta x}{2}\\right) = q \\Delta x $$\n$$ \\psi_R^{\\text{DD}} \\left(2\\mu + \\Sigma_t \\Delta x\\right) = \\psi_L \\left(2\\mu - \\Sigma_t \\Delta x\\right) + 2q \\Delta x $$\n$$ \\psi_R^{\\text{DD}} = \\frac{(2\\mu - \\Sigma_t \\Delta x) \\psi_L + 2q \\Delta x}{2\\mu + \\Sigma_t \\Delta x} $$\n\n**3. Numerical Computations**\nWe substitute the given data: $\\Sigma_{t} = 1.5$, $\\Delta x = 3.0$, $\\mu = 0.2$, $q = 3.0 \\times 10^{-3}$, and $\\psi_{L} = 6.0 \\times 10^{-3}$.\n\nFirst, we compute the optical thickness of the cell along the characteristic:\n$$ \\tau = \\frac{\\Sigma_t \\Delta x}{\\mu} = \\frac{1.5 \\times 3.0}{0.2} = \\frac{4.5}{0.2} = 22.5 $$\nThe exponential term is $\\exp(-\\tau) = \\exp(-22.5) \\approx 1.703 \\times 10^{-10}$.\n\nNow, we compute $\\psi_R^{\\text{SC}}$:\n$$ \\psi_R^{\\text{SC}} = (6.0 \\times 10^{-3}) \\exp(-22.5) + \\frac{3.0 \\times 10^{-3}}{1.5} (1 - \\exp(-22.5)) $$\n$$ \\psi_R^{\\text{SC}} = (6.0 \\times 10^{-3}) \\exp(-22.5) + (2.0 \\times 10^{-3}) (1 - \\exp(-22.5)) $$\n$$ \\psi_R^{\\text{SC}} = 2.0 \\times 10^{-3} + (4.0 \\times 10^{-3}) \\exp(-22.5) $$\n$$ \\psi_R^{\\text{SC}} \\approx 2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})(1.703 \\times 10^{-10}) \\approx 2.0 \\times 10^{-3} $$\nTo high precision, $\\psi_R^{\\text{SC}} \\approx 2.0000... \\times 10^{-3}$.\n\nNext, we compute $\\psi_R^{\\text{DD}}$:\n$$ \\psi_R^{\\text{DD}} = \\frac{(2(0.2) - 1.5 \\times 3.0)(6.0 \\times 10^{-3}) + 2(3.0 \\times 10^{-3})(3.0)}{2(0.2) + 1.5 \\times 3.0} $$\n$$ \\psi_R^{\\text{DD}} = \\frac{(0.4 - 4.5)(6.0 \\times 10^{-3}) + 1.8 \\times 10^{-2}}{0.4 + 4.5} $$\n$$ \\psi_R^{\\text{DD}} = \\frac{(-4.1)(6.0 \\times 10^{-3}) + 1.8 \\times 10^{-2}}{4.9} = \\frac{-2.46 \\times 10^{-2} + 1.8 \\times 10^{-2}}{4.9} $$\n$$ \\psi_R^{\\text{DD}} = \\frac{-0.66 \\times 10^{-2}}{4.9} = \\frac{-6.6 \\times 10^{-3}}{4.9} \\approx -1.346938... \\times 10^{-3} $$\nAs anticipated, the DD method predicts a negative outgoing flux.\n\n**4. Blending Coefficient and Blended Flux**\nSince $\\psi_R^{\\text{DD}} < 0$, we must find the minimal blending coefficient $w$ that makes $\\psi_R^{\\text{blend}} \\ge 0$. This is achieved by setting $\\psi_R^{\\text{blend}} = 0$.\n$$ \\psi_{R}^{\\text{blend}} = w \\psi_{R}^{\\text{DD}} + (1-w)\\psi_{R}^{\\text{SC}} = 0 $$\n$$ w \\psi_{R}^{\\text{DD}} + \\psi_{R}^{\\text{SC}} - w \\psi_{R}^{\\text{SC}} = 0 $$\n$$ w (\\psi_{R}^{\\text{SC}} - \\psi_{R}^{\\text{DD}}) = \\psi_{R}^{\\text{SC}} $$\n$$ w = \\frac{\\psi_{R}^{\\text{SC}}}{\\psi_{R}^{\\text{SC}} - \\psi_{R}^{\\text{DD}}} $$\nSubstituting the computed values:\n$$ w = \\frac{2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})\\exp(-22.5)}{ (2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})\\exp(-22.5)) - (-\\frac{6.6 \\times 10^{-3}}{4.9}) } $$\nIgnoring the negligible $\\exp(-22.5)$ term for this calculation:\n$$ w \\approx \\frac{2.0 \\times 10^{-3}}{2.0 \\times 10^{-3} + \\frac{6.6}{4.9} \\times 10^{-3}} = \\frac{2}{2 + \\frac{66}{49}} = \\frac{2}{\\frac{98+66}{49}} = \\frac{2 \\times 49}{164} = \\frac{98}{164} = \\frac{49}{82} $$\n$$ w \\approx 0.59756... $$\nBy design of the limiter, the resulting blended flux is $\\psi_R^{\\text{blend}} = 0$.\n\n**5. Error Quantification**\nWe now compute the two defined error metrics using $\\psi_R^{\\text{blend}} = 0$.\n\n**Consistency Error:**\nThe consistency error measures the deviation from the exact characteristic solution.\n$$ E_{\\text{cons}} = |\\psi_{R}^{\\text{blend}} - \\psi_{R}^{\\text{SC}}| = |0 - \\psi_{R}^{\\text{SC}}| = \\psi_{R}^{\\text{SC}} $$\n$$ E_{\\text{cons}} = 2.0 \\times 10^{-3} + (4.0 \\times 10^{-3})\\exp(-22.5) $$\n$$ E_{\\text{cons}} \\approx 2.0 \\times 10^{-3} + 6.812 \\times 10^{-13} $$\nRounding to four significant figures, $E_{\\text{cons}} = 2.000 \\times 10^{-3} \\, \\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$.\n\n**Conservation Error:**\nThe conservation error is based on the residual of the DD balance equation. First, we compute the track length $h$:\n$$ h = \\frac{\\Delta x}{\\mu} = \\frac{3.0}{0.2} = 15.0 \\, \\text{cm} $$\nNext, we compute the residual $R$ with $\\psi_{R}^{\\text{blend}} = 0$:\n$$ R = \\frac{0 - \\psi_{L}}{h} + \\Sigma_{t}\\frac{\\psi_{L} + 0}{2} - q $$\n$$ R = -\\frac{6.0 \\times 10^{-3}}{15.0} + 1.5 \\times \\frac{6.0 \\times 10^{-3}}{2} - 3.0 \\times 10^{-3} $$\n$$ R = -0.4 \\times 10^{-3} + 1.5 \\times (3.0 \\times 10^{-3}) - 3.0 \\times 10^{-3} $$\n$$ R = -0.4 \\times 10^{-3} + 4.5 \\times 10^{-3} - 3.0 \\times 10^{-3} $$\n$$ R = (4.5 - 0.4 - 3.0) \\times 10^{-3} = 1.1 \\times 10^{-3} \\, \\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1} $$\nThe conservation error in flux units is:\n$$ E_{\\text{consrv}} = \\frac{|R|}{\\Sigma_{t}} = \\frac{1.1 \\times 10^{-3}}{1.5} = \\frac{11}{15} \\times 10^{-3} \\approx 0.733333... \\times 10^{-3} $$\nRounding to four significant figures, $E_{\\text{consrv}} = 7.333 \\times 10^{-4} \\, \\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.000 \\times 10^{-3} & 7.333 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}