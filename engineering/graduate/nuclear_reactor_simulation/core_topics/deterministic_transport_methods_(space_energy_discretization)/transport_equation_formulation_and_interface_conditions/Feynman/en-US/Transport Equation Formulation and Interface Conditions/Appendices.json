{
    "hands_on_practices": [
        {
            "introduction": "Simulating neutron transport in a reactor involves tracking particles as they move through different materials. This practice applies the direct analytical solution of the one-dimensional transport equation for a series of homogeneous material segments, demonstrating how the angular flux, $\\psi$, is attenuated by the material and augmented by internal sources. By implementing this sequential calculation, you will build a foundational algorithm used in the Method of Characteristics (MOC), a cornerstone of modern, high-fidelity reactor analysis codes. ",
            "id": "4258245",
            "problem": "Consider a straight characteristic line-of-flight through a one-dimensional multi-region pin cell in a nuclear reactor simulation. Along a single ray, the steady-state angular neutron flux $ \\psi(s) $ satisfies the first-order ordinary differential equation\n$$\n\\frac{d\\psi(s)}{ds} + \\Sigma_t(s)\\,\\psi(s) = q(s),\n$$\nwhere $ s $ is the path-length coordinate along the ray, $ \\Sigma_t(s) $ is the total macroscopic cross section, and $ q(s) $ is the in-direction source per unit solid angle. Assume a piecewise-constant material model: within each region indexed by $ k $, $ \\Sigma_t(s) = \\Sigma_{t,k} $ and $ q(s) = q_k $ are constant over a segment of length $ L_k $. The interface conditions between regions enforce continuity of the angular flux $ \\psi(s) $ across interfaces. There are no singular interface sources, and the ray direction does not change at interfaces.\n\nStarting from the governing equation and these interface conditions, assemble the piecewise segment contributions to obtain the outgoing angular flux at the boundary after traversing a sequence of regions. The propagation through one segment must be based only on first principles and must be scientifically sound. Then, design and implement an algorithm that computes the outgoing angular flux at the end of the final segment given an incident angular flux at the beginning of the first segment.\n\nPhysical units must be explicitly respected. Let $ \\Sigma_{t,k} $ be specified in $ \\text{cm}^{-1} $, segment lengths $ L_k $ be in $ \\text{cm} $, the source $ q_k $ be in $ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, and the angular flux $ \\psi $ be in $ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $. Express all final answers for the outgoing angular flux in $ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $ as floating-point numbers. No angles are required; all distances $ L_k $ are given directly along the ray in $ \\text{cm} $.\n\nYour program must implement the following scientifically grounded segment mapping: for a single segment with constant $ \\Sigma_t $ and $ q $ over length $ L $, the mapping from incident angular flux $ \\psi_{\\text{in}} $ at the segment entrance to outgoing angular flux $ \\psi_{\\text{out}} $ at the segment exit is\n$$\n\\psi_{\\text{out}} = \\psi_{\\text{in}}\\,e^{-\\Sigma_t L} + \\frac{q}{\\Sigma_t}\\left(1 - e^{-\\Sigma_t L}\\right),\n$$\nand in the special limiting case $ \\Sigma_t \\to 0 $ with finite $ q $, the mapping reduces to\n$$\n\\psi_{\\text{out}} = \\psi_{\\text{in}} + q\\,L,\n$$\nwhich must be used to avoid division by zero and to remain consistent with $ \\frac{d\\psi}{ds} = q $ when $ \\Sigma_t = 0 $.\n\nThe multi-region pin cell along the ray is defined by an ordered list of segments $ \\{(\\Sigma_{t,k}, q_k, L_k)\\}_{k=1}^N $. The algorithm must apply the single-segment mapping sequentially for $ k = 1 $ to $ k = N $, enforcing continuity of $ \\psi $ at each interface by setting the incident flux of segment $ k $ equal to the outgoing flux from segment $ k-1 $.\n\nImplement the algorithm and evaluate it on the following test suite, each case defined by an incident angular flux $ \\psi_{\\text{in}} $ and an ordered list of segments $ (\\Sigma_{t,k}, q_k, L_k) $:\n\nCase $ 1 $ (happy path, three-region pin cell with internal source in fuel, thin gap, and cladding):\n- Incident flux $ \\psi_{\\text{in}} = 0.1\\ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $.\n- Segments:\n  - Fuel: $ \\Sigma_{t,1} = 0.7\\ \\text{cm}^{-1} $, $ q_1 = 0.05\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_1 = 0.2\\ \\text{cm} $.\n  - Gap: $ \\Sigma_{t,2} = 0.001\\ \\text{cm}^{-1} $, $ q_2 = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_2 = 0.05\\ \\text{cm} $.\n  - Cladding: $ \\Sigma_{t,3} = 0.2\\ \\text{cm}^{-1} $, $ q_3 = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_3 = 0.08\\ \\text{cm} $.\n\nCase $ 2 $ (pure attenuation, single region, no source):\n- Incident flux $ \\psi_{\\text{in}} = 1.0\\ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $.\n- Segments:\n  - Region $ 1 $: $ \\Sigma_{t,1} = 1.3\\ \\text{cm}^{-1} $, $ q_1 = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_1 = 0.5\\ \\text{cm} $.\n\nCase $ 3 $ (edge case, zero cross section segment with source followed by attenuation):\n- Incident flux $ \\psi_{\\text{in}} = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $.\n- Segments:\n  - Vacuum-like: $ \\Sigma_{t,1} = 0.0\\ \\text{cm}^{-1} $, $ q_1 = 0.02\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_1 = 1.0\\ \\text{cm} $.\n  - Attenuating: $ \\Sigma_{t,2} = 0.4\\ \\text{cm}^{-1} $, $ q_2 = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_2 = 0.25\\ \\text{cm} $.\n\nCase $ 4 $ (boundary condition, zero-thickness segment followed by attenuation):\n- Incident flux $ \\psi_{\\text{in}} = 0.5\\ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $.\n- Segments:\n  - Degenerate: $ \\Sigma_{t,1} = 0.8\\ \\text{cm}^{-1} $, $ q_1 = 0.1\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_1 = 0.0\\ \\text{cm} $.\n  - Attenuating: $ \\Sigma_{t,2} = 0.3\\ \\text{cm}^{-1} $, $ q_2 = 0.0\\ \\text{neutrons}\\ \\text{cm}^{-3}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $, $ L_2 = 0.1\\ \\text{cm} $.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $ [\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4] $), where each $ \\text{result}_i $ is the outgoing angular flux at the boundary for the corresponding case, expressed in $ \\text{neutrons}\\ \\text{cm}^{-2}\\ \\text{s}^{-1}\\ \\text{sr}^{-1} $ as a floating-point number.",
            "solution": "The problem posed is to compute the outgoing angular neutron flux after traversing a sequence of one-dimensional material regions, starting from a given incident flux. This is a fundamental problem in the method of characteristics, a common technique for solving the neutron transport equation in nuclear reactor analysis.\n\nFirst, a validation of the problem statement is required. The givens are:\n- The governing equation for the steady-state angular flux $\\psi(s)$ along a characteristic line-of-flight with path-length coordinate $s$:\n$$ \\frac{d\\psi(s)}{ds} + \\Sigma_t(s)\\,\\psi(s) = q(s) $$\n- The material properties $\\Sigma_t(s)$ (total macroscopic cross section) and $q(s)$ (in-direction source) are piecewise constant. For a region $k$ of length $L_k$, $\\Sigma_t(s) = \\Sigma_{t,k}$ and $q(s) = q_k$.\n- Interface conditions mandate continuity of $\\psi(s)$.\n- The single-segment mapping from incident flux $\\psi_{\\text{in}}$ to outgoing flux $\\psi_{\\text{out}}$ over a length $L$ is given by:\n$$ \\psi_{\\text{out}} = \\psi_{\\text{in}}\\,e^{-\\Sigma_t L} + \\frac{q}{\\Sigma_t}\\left(1 - e^{-\\Sigma_t L}\\right) \\quad (\\text{for } \\Sigma_t \\neq 0) $$\n$$ \\psi_{\\text{out}} = \\psi_{\\text{in}} + q\\,L \\quad (\\text{for } \\Sigma_t = 0) $$\n- The problem specifies units for all physical quantities, which are internally consistent.\n- Four specific test cases are provided, defining the initial incident flux and the sequence of material segments.\n\nThe problem is scientifically grounded, as it is based on the standard linear Boltzmann transport equation in one spatial dimension. The provided analytical solution for a homogeneous segment is correct and can be derived from first principles. The problem is well-posed, providing a clear initial condition and a well-defined sequence of operations that guarantees a unique solution. The language is objective and precise. All required data are provided, and there are no contradictions. The structure is formal and directly translatable to an algorithm. Therefore, the problem is deemed valid and a solution can be constructed.\n\nThe core principle is the analytical integration of the transport equation over a single, homogeneous spatial segment. Within a segment $k$ extending from a local coordinate $s=0$ to $s=L_k$, the equation becomes a first-order linear ordinary differential equation with constant coefficients:\n$$ \\frac{d\\psi(s)}{ds} + \\Sigma_{t,k}\\,\\psi(s) = q_k $$\nThis equation can be solved using an integrating factor, $I(s) = \\exp(\\int \\Sigma_{t,k} \\, ds) = \\exp(\\Sigma_{t,k} s)$. Multiplying the differential equation by $I(s)$ yields:\n$$ \\exp(\\Sigma_{t,k} s) \\frac{d\\psi(s)}{ds} + \\Sigma_{t,k} \\exp(\\Sigma_{t,k} s) \\psi(s) = q_k \\exp(\\Sigma_{t,k} s) $$\nThe left-hand side is the derivative of a product, by the chain rule:\n$$ \\frac{d}{ds} \\left( \\psi(s) \\exp(\\Sigma_{t,k} s) \\right) = q_k \\exp(\\Sigma_{t,k} s) $$\nIntegrating this expression over the segment length, from $s=0$ to $s=L_k$:\n$$ \\int_{0}^{L_k} \\frac{d}{ds} \\left( \\psi(s) \\exp(\\Sigma_{t,k} s) \\right) ds = \\int_{0}^{L_k} q_k \\exp(\\Sigma_{t,k} s) ds $$\n$$ \\left[ \\psi(s) \\exp(\\Sigma_{t,k} s) \\right]_{0}^{L_k} = \\left[ \\frac{q_k}{\\Sigma_{t,k}} \\exp(\\Sigma_{t,k} s) \\right]_{0}^{L_k} $$\nThis step assumes $\\Sigma_{t,k} \\neq 0$. Evaluating at the limits gives:\n$$ \\psi(L_k) \\exp(\\Sigma_{t,k} L_k) - \\psi(0) \\exp(0) = \\frac{q_k}{\\Sigma_{t,k}} (\\exp(\\Sigma_{t,k} L_k) - \\exp(0)) $$\n$$ \\psi(L_k) \\exp(\\Sigma_{t,k} L_k) - \\psi(0) = \\frac{q_k}{\\Sigma_{t,k}} (\\exp(\\Sigma_{t,k} L_k) - 1) $$\nLetting the incident flux at $s=0$ be $\\psi_{\\text{in},k} = \\psi(0)$ and the outgoing flux at $s=L_k$ be $\\psi_{\\text{out},k} = \\psi(L_k)$, we solve for $\\psi_{\\text{out},k}$:\n$$ \\psi_{\\text{out},k} = \\psi_{\\text{in},k} \\exp(-\\Sigma_{t,k} L_k) + \\frac{q_k}{\\Sigma_{t,k}}(1 - \\exp(-\\Sigma_{t,k} L_k)) $$\nThis derivation validates the formula provided in the problem statement for the case where $\\Sigma_{t,k} \\neq 0$. The first term, $\\psi_{\\text{in},k} \\exp(-\\Sigma_{t,k} L_k)$, represents the attenuation of the incident flux as it traverses the material. The second term represents the contribution from the internal source $q_k$, which is also attenuated. The quantity $\\tau_k = \\Sigma_{t,k} L_k$ is the optical thickness of the segment.\n\nFor the special case where $\\Sigma_{t,k} = 0$, the governing equation simplifies to:\n$$ \\frac{d\\psi(s)}{ds} = q_k $$\nIntegrating this from $s=0$ to $s=L_k$:\n$$ \\int_{0}^{L_k} \\frac{d\\psi(s)}{ds} ds = \\int_{0}^{L_k} q_k ds $$\n$$ \\psi(L_k) - \\psi(0) = q_k L_k $$\n$$ \\psi_{\\text{out},k} = \\psi_{\\text{in},k} + q_k L_k $$\nThis confirms the second formula provided. This case corresponds to particles streaming through a vacuum (or a non-interacting medium), with the flux increasing linearly due to the source.\n\nThe algorithm for a multi-region problem is a sequential application of this single-segment solution. The principle of flux continuity at interfaces means that the outgoing flux from segment $k-1$ becomes the incident flux for segment $k$. Let $\\psi_{k}$ be the outgoing flux from segment $k$. The process is iterative:\n1. Initialize with the incident flux at the start of the first segment: $\\psi_{\\text{in},1} = \\psi_{\\text{incident}}$.\n2. For each segment $k = 1, 2, \\dots, N$:\n   - The incident flux for the current segment is the outgoing flux from the previous one: $\\psi_{\\text{in},k} = \\psi_{k-1}$ (with $\\psi_0 = \\psi_{\\text{incident}}$).\n   - Compute the outgoing flux $\\psi_k$ using the appropriate formula based on whether $\\Sigma_{t,k}$ is zero or non-zero.\n3. The final result is the outgoing flux from the last segment, $\\psi_N$.\n\nThis sequential procedure correctly models the transport of particles along the characteristic ray through the entire heterogeneous medium.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neutron transport problem for the given test cases.\n    \"\"\"\n    \n    # Each case is: (incident_flux, [(sigma_t, q, L), ...])\n    test_cases = [\n        # Case 1 (happy path, three-region pin cell)\n        (0.1, [\n            (0.7, 0.05, 0.2),  # Fuel\n            (0.001, 0.0, 0.05), # Gap\n            (0.2, 0.0, 0.08)   # Cladding\n        ]),\n        \n        # Case 2 (pure attenuation, single region)\n        (1.0, [\n            (1.3, 0.0, 0.5)\n        ]),\n        \n        # Case 3 (edge case, zero cross section)\n        (0.0, [\n            (0.0, 0.02, 1.0),   # Vacuum-like with source\n            (0.4, 0.0, 0.25)   # Attenuating\n        ]),\n        \n        # Case 4 (boundary condition, zero-thickness segment)\n        (0.5, [\n            (0.8, 0.1, 0.0),   # Degenerate segment\n            (0.3, 0.0, 0.1)    # Attenuating\n        ])\n    ]\n\n    results = []\n    for initial_flux, segments in test_cases:\n        current_flux = initial_flux\n        \n        for sigma_t, q, L in segments:\n            # sigma_t is given in cm^-1\n            # q is given in neutrons cm^-3 s^-1 sr^-1\n            # L is given in cm\n            # current_flux is in neutrons cm^-2 s^-1 sr^-1\n            \n            # Use a small tolerance for floating point comparison to zero\n            if abs(sigma_t)  1e-12:\n                # Special case for sigma_t = 0\n                # psi_out = psi_in + q * L\n                current_flux = current_flux + q * L\n            else:\n                # Standard case for sigma_t  0\n                # The optical thickness (tau) is dimensionless\n                tau = sigma_t * L\n                \n                # Attenuation factor is dimensionless\n                attenuation = np.exp(-tau)\n                \n                # psi_out = psi_in * exp(-sigma_t*L) + (q/sigma_t) * (1 - exp(-sigma_t*L))\n                source_contribution = (q / sigma_t) * (1.0 - attenuation)\n                current_flux = current_flux * attenuation + source_contribution\n        \n        results.append(current_flux)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While ray-tracing is precise, many simulation codes discretize space into finite volumes or cells, requiring a robust method to calculate particle flux across shared faces. This exercise explores upwinding, a fundamental principle where the flux at an interface is determined by the state of the particles flowing into it from the \"upwind\" direction. Mastering this concept is crucial for developing stable and physically accurate finite-volume methods, ensuring that particle balance is conserved across the entire computational domain. ",
            "id": "4258233",
            "problem": "Consider the steady-state, monoenergetic linear Boltzmann transport equation for the angular flux $\\psi(\\mathbf{x},\\mathbf{\\Omega})$ in a source-free, isotropic, homogeneous region. The streaming term is $\\mathbf{\\Omega}\\cdot\\nabla \\psi$, where $\\mathbf{\\Omega}$ is the unit direction vector. In a finite-volume discretization over a control volume $V$ with boundary $\\partial V$ composed of planar faces, the streaming term integrates to a sum of face fluxes by the divergence theorem:\n$$\n\\int_{V} \\mathbf{\\Omega}\\cdot\\nabla \\psi \\, dV \\;=\\; \\sum_{f\\in\\partial V} \\int_{S_f} \\mathbf{\\Omega}\\cdot\\mathbf{n}_f \\, \\psi \\, dS,\n$$\nwhere $S_f$ is a face, $\\mathbf{n}_f$ is the outward unit normal of that face, and $dS$ is the surface measure. For interface consistency, the angular flux at an internal face is continuous along characteristics, and for discrete ordinates the upwind value of $\\psi$ must be used at the face. In a first-order linear reconstruction within each cell $i$, the face value is approximated as\n$$\n\\psi(\\mathbf{x}_f,\\mathbf{\\Omega}) \\approx \\psi_i(\\mathbf{\\Omega}) + \\nabla\\psi_i(\\mathbf{\\Omega})\\cdot(\\mathbf{x}_f - \\mathbf{x}_i),\n$$\nwhere $\\mathbf{x}_i$ is the cell centroid, $\\mathbf{x}_f$ is the face centroid, and $\\nabla\\psi_i(\\mathbf{\\Omega})$ is a prescribed gradient for the reconstruction. For an internal face shared by a left cell $L$ and a right cell $R$, with $\\mathbf{n}_f$ pointing from $L$ to $R$, the upwind cell for direction $\\mathbf{\\Omega}$ is $L$ if $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f0$, otherwise it is $R$ if $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f0$. If $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f=0$, the contribution is zero. The face flux is defined by\n$$\nF_f(\\mathbf{\\Omega}) \\equiv \\int_{S_f} \\mathbf{\\Omega}\\cdot\\mathbf{n}_f \\, \\psi(\\mathbf{x}_f,\\mathbf{\\Omega}) \\, dS \\approx \\left(\\mathbf{\\Omega}\\cdot\\mathbf{n}_f\\right) \\, A_f \\, \\psi_\\text{up}(\\mathbf{x}_f,\\mathbf{\\Omega}),\n$$\nwhere $A_f$ is the face area and $\\psi_\\text{up}$ is the reconstructed upwind face value. Conservation across the interface requires that the contributions of this face to the left and right cell balances be equal in magnitude and opposite in sign:\n$$\nF_f^{(L)}(\\mathbf{\\Omega}) = +F_f(\\mathbf{\\Omega}), \\quad F_f^{(R)}(\\mathbf{\\Omega}) = -F_f(\\mathbf{\\Omega}),\n$$\nso that $F_f^{(L)}(\\mathbf{\\Omega}) + F_f^{(R)}(\\mathbf{\\Omega}) = 0$ for each direction $\\mathbf{\\Omega}$.\n\nYour task is to implement this face-flux computation for a simple two-cell geometry and verify interface conservation. The geometry is two adjacent unit square cells in two dimensions that share a vertical internal face:\n- Cell indices: $i=0$ is the left cell and $i=1$ is the right cell.\n- Cell centroids: $\\mathbf{x}_0=(0.5,0.5)$ and $\\mathbf{x}_1=(1.5,0.5)$.\n- Internal face centroid: $\\mathbf{x}_f=(1.0,0.5)$.\n- Internal face normal: $\\mathbf{n}_f=(1,0)$ pointing from left to right.\n- Internal face area: $A_f=1$.\n\nFor each test case below, you are given:\n- A list of discrete directions $\\{\\mathbf{\\Omega}_m\\}_{m=1}^M$ (each is a unit vector).\n- Cell-centered angular flux values $\\psi_i(\\mathbf{\\Omega}_m)$ for $i\\in\\{0,1\\}$ and $m\\in\\{1,\\dots,M\\}$.\n- Cell-centered reconstruction gradients $\\nabla\\psi_i(\\mathbf{\\Omega}_m)$ for $i\\in\\{0,1\\}$ and $m\\in\\{1,\\dots,M\\}$.\n\nImplement the upwind linear reconstruction described above to compute the internal face flux $F_f(\\mathbf{\\Omega}_m)$ for each direction. Use the same $F_f(\\mathbf{\\Omega}_m)$ with opposite signs to form the left and right cell contributions for the shared face. For each test, return a boolean indicating whether the conservation condition across the internal interface holds to within a numerical tolerance of $10^{-12}$, that is, whether $|F_f^{(L)}(\\mathbf{\\Omega}_m) + F_f^{(R)}(\\mathbf{\\Omega}_m)| \\le 10^{-12}$ for all directions in the test. In one test you must also verify aggregated conservation by checking that the sum over directions of left and right contributions cancels to within the tolerance.\n\nNo physical units are required; treat all quantities as dimensionless.\n\nTest Suite:\n- Test 1 (right-going flow, piecewise constant reconstruction):\n  - Directions: $\\mathbf{\\Omega}_1=(1,0)$.\n  - $\\psi_0(\\mathbf{\\Omega}_1)=2.0$, $\\psi_1(\\mathbf{\\Omega}_1)=0.5$.\n  - $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(0.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0,0.0)$.\n- Test 2 (left-going flow, piecewise constant reconstruction):\n  - Directions: $\\mathbf{\\Omega}_1=(-1,0)$.\n  - $\\psi_0(\\mathbf{\\Omega}_1)=1.2$, $\\psi_1(\\mathbf{\\Omega}_1)=3.0$.\n  - $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(0.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0,0.0)$.\n- Test 3 (flow parallel to interface, zero normal component):\n  - Directions: $\\mathbf{\\Omega}_1=(0,1)$.\n  - $\\psi_0(\\mathbf{\\Omega}_1)=5.0$, $\\psi_1(\\mathbf{\\Omega}_1)=7.0$.\n  - $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(0.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0,0.0)$.\n- Test 4 (diagonal flow, linear reconstruction in upwind cell):\n  - Directions: $\\mathbf{\\Omega}_1=\\left(\\frac{\\sqrt{2}}{2},\\frac{\\sqrt{2}}{2}\\right)$.\n  - $\\psi_0(\\mathbf{\\Omega}_1)=1.0$, $\\psi_1(\\mathbf{\\Omega}_1)=4.0$.\n  - $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(1.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0,0.0)$.\n- Test 5 (aggregated conservation over multiple directions):\n  - Directions: $\\mathbf{\\Omega}_1=(1,0)$ and $\\mathbf{\\Omega}_2=\\left(\\frac{\\sqrt{2}}{2},\\frac{\\sqrt{2}}{2}\\right)$.\n  - $\\psi_0(\\mathbf{\\Omega}_1)=2.0$, $\\psi_1(\\mathbf{\\Omega}_1)=0.5$, $\\psi_0(\\mathbf{\\Omega}_2)=1.0$, $\\psi_1(\\mathbf{\\Omega}_2)=4.0$.\n  - $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(0.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0,0.0)$, $\\nabla\\psi_0(\\mathbf{\\Omega}_2)=(1.0,0.0)$, $\\nabla\\psi_1(\\mathbf{\\Omega}_2)=(0.0,0.0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each result must be a boolean indicating conservation for the test as specified.",
            "solution": "The problem requires the implementation and verification of a face flux calculation for a first-order finite-volume discretization of the steady-state, monoenergetic linear Boltzmann transport equation. The central task is to verify that the implemented numerical scheme for the face flux is conservative at the interface between two computational cells.\n\nThe problem describes a specific numerical method known as a linear discontinuous scheme. The flux at a face is determined by selecting the \"upwind\" cell based on the particle direction $\\mathbf{\\Omega}$ relative to the face normal $\\mathbf{n}_f$, and then evaluating a linear reconstruction of the flux from that upwind cell's data at the face's centroid.\n\nThe conservation property is defined by the requirement that the flux contribution from a shared face to the balance equation of the left cell, $F_f^{(L)}(\\mathbf{\\Omega})$, must be equal in magnitude and opposite in sign to the contribution to the right cell, $F_f^{(R)}(\\mathbf{\\Omega})$. The problem defines these contributions as $F_f^{(L)}(\\mathbf{\\Omega}) = +F_f(\\mathbf{\\Omega})$ and $F_f^{(R)}(\\mathbf{\\Omega}) = -F_f(\\mathbf{\\Omega})$, where $F_f(\\mathbf{\\Omega})$ is the net flux across the face. By this construction, the sum $F_f^{(L)}(\\mathbf{\\Omega}) + F_f^{(R)}(\\mathbf{\\Omega})$ is analytically zero. The verification task, therefore, is to implement the calculation of $F_f(\\mathbf{\\Omega})$ correctly and confirm that $|F_f^{(L)}(\\mathbf{\\Omega}) + F_f^{(R)}(\\mathbf{\\Omega})| \\le 10^{-12}$, which will hold true if the implementation correctly computes $F_f(\\mathbf{\\Omega})$ and applies the definitions for $F_f^{(L)}$ and $F_f^{(R)}$.\n\nThe geometric and physical setup is as follows:\n- Left cell ($i=0$): centroid $\\mathbf{x}_0 = (0.5, 0.5)$.\n- Right cell ($i=1$): centroid $\\mathbf{x}_1 = (1.5, 0.5)$.\n- Internal face: centroid $\\mathbf{x}_f = (1.0, 0.5)$, area $A_f=1$, and outward normal from left to right $\\mathbf{n}_f = (1, 0)$.\n\nThe algorithm to compute the face flux $F_f(\\mathbf{\\Omega})$ and check conservation for a single direction $\\mathbf{\\Omega}$ is:\n1.  **Determine the upwind cell.** We calculate the dot product $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f$.\n    - If $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0$, particles flow from left to right. The upwind cell is the left cell, index $u=0$.\n    - If $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0$, particles flow from right to left. The upwind cell is the right cell, index $u=1$.\n    - If $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f = 0$, there is no net flow across the face, so $F_f(\\mathbf{\\Omega})=0$.\n\n2.  **Evaluate the reconstructed upwind flux at the face.** The linear reconstruction formula is used:\n    $$ \\psi_{\\text{up}}(\\mathbf{x}_f, \\mathbf{\\Omega}) = \\psi_u(\\mathbf{\\Omega}) + \\nabla\\psi_u(\\mathbf{\\Omega}) \\cdot (\\mathbf{x}_f - \\mathbf{x}_u) $$\n    where $\\psi_u(\\mathbf{\\Omega})$ and $\\nabla\\psi_u(\\mathbf{\\Omega})$ are the given cell-centered angular flux and its gradient for the upwind cell $u$.\n\n3.  **Compute the net face flux.** The flux is given by:\n    $$ F_f(\\mathbf{\\Omega}) = (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f) A_f \\psi_{\\text{up}}(\\mathbf{x}_f, \\mathbf{\\Omega}) $$\n\n4.  **Verify conservation.** We check if $|F_f(\\mathbf{\\Omega}) + (-F_f(\\mathbf{\\Omega}))| \\le 10^{-12}$. This simplifies to $|0| \\le 10^{-12}$, which is always true. The test thus validates the correct computation of $F_f(\\mathbf{\\Omega})$ as the cornerstone of the conservation property.\n\nWe now apply this procedure to each test case.\n\n**Test 1: Right-going flow, piecewise constant reconstruction**\n- Direction: $\\mathbf{\\Omega}_1 = (1, 0)$.\n- Data: $\\psi_0(\\mathbf{\\Omega}_1)=2.0$, $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(0.0, 0.0)$.\n- Upwind check: $\\mathbf{\\Omega}_1 \\cdot \\mathbf{n}_f = (1, 0) \\cdot (1, 0) = 1  0$. The upwind cell is $u=0$ (left).\n- Reconstruction: The gradient is zero, so this is a piecewise constant or \"step\" scheme. $\\psi_{\\text{up}}(\\mathbf{x}_f, \\mathbf{\\Omega}_1) = \\psi_0(\\mathbf{\\Omega}_1) = 2.0$.\n- Face flux: $F_f(\\mathbf{\\Omega}_1) = (1)(1)(2.0) = 2.0$.\n- Conservation: $F_f^{(L)} = 2.0$, $F_f^{(R)} = -2.0$. $|2.0 + (-2.0)| = 0 \\le 10^{-12}$. The condition holds.\n\n**Test 2: Left-going flow, piecewise constant reconstruction**\n- Direction: $\\mathbf{\\Omega}_1 = (-1, 0)$.\n- Data: $\\psi_1(\\mathbf{\\Omega}_1)=3.0$, $\\nabla\\psi_1(\\mathbf{\\Omega}_1)=(0.0, 0.0)$.\n- Upwind check: $\\mathbf{\\Omega}_1 \\cdot \\mathbf{n}_f = (-1, 0) \\cdot (1, 0) = -1  0$. The upwind cell is $u=1$ (right).\n- Reconstruction: $\\psi_{\\text{up}}(\\mathbf{x}_f, \\mathbf{\\Omega}_1) = \\psi_1(\\mathbf{\\Omega}_1) = 3.0$.\n- Face flux: $F_f(\\mathbf{\\Omega}_1) = (-1)(1)(3.0) = -3.0$.\n- Conservation: $F_f^{(L)} = -3.0$, $F_f^{(R)} = -(-3.0) = 3.0$. $|-3.0 + 3.0| = 0 \\le 10^{-12}$. The condition holds.\n\n**Test 3: Flow parallel to interface**\n- Direction: $\\mathbf{\\Omega}_1 = (0, 1)$.\n- Data: Not needed for flux calculation, but given as $\\psi_0(\\mathbf{\\Omega}_1)=5.0$, $\\psi_1(\\mathbf{\\Omega}_1)=7.0$.\n- Upwind check: $\\mathbf{\\Omega}_1 \\cdot \\mathbf{n}_f = (0, 1) \\cdot (1, 0) = 0$.\n- Face flux: Since the dot product is zero, $F_f(\\mathbf{\\Omega}_1) = 0$.\n- Conservation: $F_f^{(L)} = 0$, $F_f^{(R)} = 0$. $|0 + 0| = 0 \\le 10^{-12}$. The condition holds.\n\n**Test 4: Diagonal flow, linear reconstruction**\n- Direction: $\\mathbf{\\Omega}_1 = (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2})$.\n- Data: $\\psi_0(\\mathbf{\\Omega}_1)=1.0$, $\\nabla\\psi_0(\\mathbf{\\Omega}_1)=(1.0, 0.0)$.\n- Upwind check: $\\mathbf{\\Omega}_1 \\cdot \\mathbf{n}_f = (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}) \\cdot (1, 0) = \\frac{\\sqrt{2}}{2}  0$. The upwind cell is $u=0$ (left).\n- Reconstruction:\n  - Displacement vector: $\\mathbf{x}_f - \\mathbf{x}_0 = (1.0, 0.5) - (0.5, 0.5) = (0.5, 0.0)$.\n  - Reconstructed value: $\\psi_{\\text{up}}(\\mathbf{x}_f, \\mathbf{\\Omega}_1) = \\psi_0(\\mathbf{\\Omega}_1) + \\nabla\\psi_0(\\mathbf{\\Omega}_1) \\cdot (\\mathbf{x}_f - \\mathbf{x}_0) = 1.0 + (1.0, 0.0) \\cdot (0.5, 0.0) = 1.0 + 0.5 = 1.5$.\n- Face flux: $F_f(\\mathbf{\\Omega}_1) = (\\frac{\\sqrt{2}}{2})(1)(1.5) = \\frac{1.5\\sqrt{2}}{2} = 0.75\\sqrt{2}$.\n- Conservation: $F_f^{(L)} = 0.75\\sqrt{2}$, $F_f^{(R)} = -0.75\\sqrt{2}$. $|0.75\\sqrt{2} - 0.75\\sqrt{2}| = 0 \\le 10^{-12}$. The condition holds.\n\n**Test 5: Aggregated conservation over multiple directions**\nThis test requires checking conservation for each direction individually and then checking the conservation of the sum of fluxes over all directions.\n\n- **Direction 1:** $\\mathbf{\\Omega}_1 = (1, 0)$. This is identical to Test 1.\n  - $F_f(\\mathbf{\\Omega}_1) = 2.0$.\n  - $F_f^{(L)}(\\mathbf{\\Omega}_1) = 2.0$, $F_f^{(R)}(\\mathbf{\\Omega}_1) = -2.0$.\n  - Conservation check 1: $|2.0 - 2.0| = 0 \\le 10^{-12}$. This holds.\n\n- **Direction 2:** $\\mathbf{\\Omega}_2 = (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2})$. This is identical to Test 4.\n  - $F_f(\\mathbf{\\Omega}_2) = 0.75\\sqrt{2}$.\n  - $F_f^{(L)}(\\mathbf{\\Omega}_2) = 0.75\\sqrt{2}$, $F_f^{(R)}(\\mathbf{\\Omega}_2) = -0.75\\sqrt{2}$.\n  - Conservation check 2: $|0.75\\sqrt{2} - 0.75\\sqrt{2}| = 0 \\le 10^{-12}$. This holds.\n\n- **Aggregated Conservation:** We check the sum of contributions to the left and right cells.\n  - Total contribution to left cell: $\\sum_m F_f^{(L)}(\\mathbf{\\Omega}_m) = F_f^{(L)}(\\mathbf{\\Omega}_1) + F_f^{(L)}(\\mathbf{\\Omega}_2) = 2.0 + 0.75\\sqrt{2}$.\n  - Total contribution to right cell: $\\sum_m F_f^{(R)}(\\mathbf{\\Omega}_m) = F_f^{(R)}(\\mathbf{\\Omega}_1) + F_f^{(R)}(\\mathbf{\\Omega}_2) = -2.0 - 0.75\\sqrt{2}$.\n  - Aggregated check: $|\\left( \\sum_m F_f^{(L)}(\\mathbf{\\Omega}_m) \\right) + \\left( \\sum_m F_f^{(R)}(\\mathbf{\\Omega}_m) \\right)| = |(2.0 + 0.75\\sqrt{2}) + (-2.0 - 0.75\\sqrt{2})| = 0 \\le 10^{-12}$. This holds.\n\nSince all individual and aggregated conservation checks pass, the result for Test 5 is true. As demonstrated, the conservation condition is satisfied for all test cases due to the definitional nature of the flux contributions $F_f^{(L)}$ and $F_f^{(R)}$. The implementation simply needs to correctly calculate the underlying face flux $F_f(\\mathbf{\\Omega})$ for this property to be numerically verified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and verifies the face-flux conservation for a finite-volume\n    discretization of the linear transport equation.\n    \"\"\"\n    \n    # Define geometry\n    x0 = np.array([0.5, 0.5])  # Centroid of left cell (i=0)\n    x1 = np.array([1.5, 0.5])  # Centroid of right cell (i=1)\n    xf = np.array([1.0, 0.5])  # Centroid of internal face\n    nf = np.array([1.0, 0.0])  # Normal vector of internal face\n    Af = 1.0                      # Area of internal face\n    \n    # Tolerance for conservation check\n    tolerance = 1e-12\n\n    test_cases = [\n        # Test 1: Right-going flow, piecewise constant\n        {\n            'directions': [np.array([1.0, 0.0])],\n            'psi_vals': {0: [2.0], 1: [0.5]},\n            'grad_psi_vals': {0: [np.array([0.0, 0.0])], 1: [np.array([0.0, 0.0])]}\n        },\n        # Test 2: Left-going flow, piecewise constant\n        {\n            'directions': [np.array([-1.0, 0.0])],\n            'psi_vals': {0: [1.2], 1: [3.0]},\n            'grad_psi_vals': {0: [np.array([0.0, 0.0])], 1: [np.array([0.0, 0.0])]}\n        },\n        # Test 3: Flow parallel to interface\n        {\n            'directions': [np.array([0.0, 1.0])],\n            'psi_vals': {0: [5.0], 1: [7.0]},\n            'grad_psi_vals': {0: [np.array([0.0, 0.0])], 1: [np.array([0.0, 0.0])]}\n        },\n        # Test 4: Diagonal flow, linear reconstruction\n        {\n            'directions': [np.array([np.sqrt(2)/2, np.sqrt(2)/2])],\n            'psi_vals': {0: [1.0], 1: [4.0]},\n            'grad_psi_vals': {0: [np.array([1.0, 0.0])], 1: [np.array([0.0, 0.0])]}\n        },\n        # Test 5: Aggregated conservation\n        {\n            'directions': [np.array([1.0, 0.0]), np.array([np.sqrt(2)/2, np.sqrt(2)/2])],\n            'psi_vals': {0: [2.0, 1.0], 1: [0.5, 4.0]},\n            'grad_psi_vals': {\n                0: [np.array([0.0, 0.0]), np.array([1.0, 0.0])],\n                1: [np.array([0.0, 0.0]), np.array([0.0, 0.0])]\n            }\n        },\n    ]\n\n    results = []\n    \n    for i, case in enumerate(test_cases):\n        all_conserved = True\n        total_F_L = 0.0\n        total_F_R = 0.0\n        \n        for m, omega in enumerate(case['directions']):\n            # 1. Determine upwind cell\n            dot_product = np.dot(omega, nf)\n            \n            if dot_product  0:\n                u = 0  # upwind is left cell\n                psi_u = case['psi_vals'][u][m]\n                grad_psi_u = case['grad_psi_vals'][u][m]\n                xu = x0\n            elif dot_product  0:\n                u = 1  # upwind is right cell\n                psi_u = case['psi_vals'][u][m]\n                grad_psi_u = case['grad_psi_vals'][u][m]\n                xu = x1\n            else: # dot_product is zero\n                psi_up_f = 0.0\n                F_f = 0.0\n\n            if dot_product != 0:\n                # 2. Evaluate reconstructed upwind flux at the face\n                displacement = xf - xu\n                psi_up_f = psi_u + np.dot(grad_psi_u, displacement)\n                \n                # 3. Compute net face flux\n                F_f = dot_product * Af * psi_up_f\n            \n            # 4. Define cell contributions\n            F_f_L = F_f\n            F_f_R = -F_f\n            \n            total_F_L += F_f_L\n            total_F_R += F_f_R\n\n            # 5. Verify conservation for this direction\n            if abs(F_f_L + F_f_R)  tolerance:\n                all_conserved = False\n                break\n        \n        if not all_conserved:\n            results.append(False)\n            continue\n            \n        # For Test 5 (index 4), also check aggregated conservation\n        if i == 4:\n            if abs(total_F_L + total_F_R)  tolerance:\n                all_conserved = False\n\n        results.append(all_conserved)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "An alternative to solving the differential transport equation is to work with its integral form, which frames the problem in terms of probabilities. This practice involves deriving and calculating first-flight collision and escape probabilitiesâ€”the chance that a neutron born within a region will either collide, escape the system, or cross into an adjacent region. This approach forms the basis of the Collision Probability (CP) method, a powerful technique for calculating reaction rates and flux distributions, especially in lattice physics codes. ",
            "id": "4258205",
            "problem": "Consider steady-state one-speed neutrons in a planar slab with two adjacent, spatially uniform, flat-source (FS) regions. Region $1$ occupies $0 \\le x \\le L_{1}$ and Region $2$ occupies $L_{1} \\le x \\le L_{1}+L_{2}$. The slab faces at $x=0$ and $x=L_{1}+L_{2}$ have vacuum boundary conditions. The interface at $x=L_{1}$ is internal, with continuity of angular flux. The medium in Region $i$ has total macroscopic cross section $\\Sigma_{t,i}$ and an isotropic, uniform volumetric source density $S_{i}$ (neutrons per unit volume per unit time). Assume an infinite extent in the transverse directions with unit area $A=1$ so that volumes are $V_{i} = A L_{i} = L_{i}$. Assume first-flight (uncollided) leakage only, and isotropic angular emission.\n\nStarting from the linear Boltzmann transport equation (TE) and the definition of collision probabilities in the Collision Probability (CP) method, derive expressions for:\n- the interface transmission probability from Region $1$ into Region $2$, $T_{1 \\to 2}$, and from Region $2$ into Region $1$, $T_{2 \\to 1}$, defined as the probability that a neutron born uniformly and isotropically in Region $i$ crosses the interface at $x=L_{1}$ without any collision in its birth region, and\n- the escape probabilities to the left vacuum boundary, $E_{1}^{\\mathrm{L}}$ and $E_{2}^{\\mathrm{L}}$, and to the right vacuum boundary, $E_{1}^{\\mathrm{R}}$ and $E_{2}^{\\mathrm{R}}$, defined as the probabilities that a neutron born uniformly and isotropically in Region $i$ exits the corresponding vacuum boundary without any collision in any region along the straight-line path.\n\nUse these derived expressions to compute the total uncollided leakage rate $L_{\\mathrm{tot}}$ (neutrons per second) across both vacuum boundaries for the following scientifically consistent parameters:\n- $L_{1} = 0.01$ $\\mathrm{m}$, $L_{2} = 0.02$ $\\mathrm{m}$,\n- $\\Sigma_{t,1} = 100$ $\\mathrm{m}^{-1}$, $\\Sigma_{t,2} = 50$ $\\mathrm{m}^{-1}$,\n- $S_{1} = 3.2 \\times 10^{7}$ $\\mathrm{s}^{-1}\\mathrm{m}^{-3}$, $S_{2} = 7.5 \\times 10^{7}$ $\\mathrm{s}^{-1}\\mathrm{m}^{-3}$.\n\nExpress the final leakage rate in $\\mathrm{s}^{-1}$. Round your answer to four significant figures. All intermediate derivations must be analytic, invoking only standard special functions where necessary. Define any special functions you introduce.",
            "solution": "The problem statement has been critically validated and is deemed scientifically grounded, well-posed, objective, and complete. It represents a standard, albeit simplified, problem in neutron transport theory. The provided parameters are physically consistent. We may therefore proceed with a formal solution.\n\nThe core of this problem lies in calculating first-flight probabilities for neutrons born uniformly and isotropically within a source region. For a one-dimensional planar slab geometry, such a probability, $P$, is calculated by integrating over all possible starting positions $x'$ within the source region of length $L_i$ and all possible initial directions of flight, characterized by the direction cosine $\\mu = \\cos\\theta$, where $\\theta$ is the angle with the $x$-axis. The source is isotropic, so the probability distribution for $\\mu$ is uniform over $[-1, 1]$, i.e., $p(\\mu) = 1/2$. The source is uniform in space, so the probability distribution for $x'$ is uniform over the region's length, $p(x') = 1/L_i$.\n\nThe general formula for a probability $P$ is:\n$$ P = \\frac{1}{L_i} \\int_{x' \\in \\text{Region } i} dx' \\int_{-1}^{1} \\frac{d\\mu}{2} \\times (\\text{Condition for Event}) \\times \\exp(-\\tau(x', \\mu)) $$\nwhere $\\tau(x', \\mu)$ is the total optical path length from the birth point $x'$ to the destination boundary along the direction $\\mu$. The condition for the event restricts the range of integration for $\\mu$. An optical path is defined as $\\tau = \\int \\Sigma_t(s) ds$ along the neutron's path. For a uniform medium, this simplifies to $\\tau = \\Sigma_t \\times (\\text{distance})$.\n\nWe define the exponential integral function of order $n$, $E_n(x)$, which will appear in our derivations:\n$$ E_n(x) = \\int_{1}^{\\infty} \\frac{\\exp(-xt)}{t^n} dt = \\int_{0}^{1} u^{n-2} \\exp\\left(-\\frac{x}{u}\\right) du $$\nA useful identity derived from this definition is $\\int_{0}^{1} u \\exp(-x/u) du = E_3(x)$.\n\nLet us denote the optical thicknesses of the regions as $\\tau_1 = \\Sigma_{t,1} L_1$ and $\\tau_2 = \\Sigma_{t,2} L_2$.\n\n**1. Derivation of Interface Transmission Probabilities**\n\n**a) Transmission from Region 1 to Region 2, $T_{1 \\to 2}$**\nA neutron born at $x' \\in [0, L_1]$ must travel to the interface at $x = L_1$. This requires a positive direction, $\\mu \\in (0, 1]$. The path length within Region $1$ is $s = (L_1 - x')/\\mu$. The corresponding optical path is $\\Sigma_{t,1} s$.\n$$ T_{1 \\to 2} = \\frac{1}{2 L_1} \\int_{0}^{L_1} dx' \\int_{0}^{1} d\\mu \\exp\\left(-\\frac{\\Sigma_{t,1}(L_1 - x')}{\\mu}\\right) $$\nLet's evaluate the inner integral over $x'$. Let $z = L_1 - x'$, so $dz = -dx'$.\n$$ \\int_{0}^{L_1} \\exp\\left(-\\frac{\\Sigma_{t,1}(L_1 - x')}{\\mu}\\right) dx' = \\int_{L_1}^{0} \\exp\\left(-\\frac{\\Sigma_{t,1}z}{\\mu}\\right) (-dz) = \\int_{0}^{L_1} \\exp\\left(-\\frac{\\Sigma_{t,1}z}{\\mu}\\right) dz $$\n$$ = \\left[-\\frac{\\mu}{\\Sigma_{t,1}} \\exp\\left(-\\frac{\\Sigma_{t,1}z}{\\mu}\\right)\\right]_{0}^{L_1} = \\frac{\\mu}{\\Sigma_{t,1}} \\left(1 - \\exp\\left(-\\frac{\\Sigma_{t,1}L_1}{\\mu}\\right)\\right) $$\nSubstituting this back into the expression for $T_{1 \\to 2}$:\n$$ T_{1 \\to 2} = \\frac{1}{2 L_1} \\int_{0}^{1} \\frac{\\mu}{\\Sigma_{t,1}} \\left(1 - \\exp\\left(-\\frac{\\tau_1}{\\mu}\\right)\\right) d\\mu = \\frac{1}{2 \\tau_1} \\int_{0}^{1} \\left(\\mu - \\mu\\exp\\left(-\\frac{\\tau_1}{\\mu}\\right)\\right) d\\mu $$\n$$ T_{1 \\to 2} = \\frac{1}{2 \\tau_1} \\left( \\left[\\frac{\\mu^2}{2}\\right]_0^1 - E_3(\\tau_1) \\right) = \\frac{1}{2 \\tau_1} \\left(\\frac{1}{2} - E_3(\\tau_1)\\right) $$\n\n**b) Transmission from Region 2 to Region 1, $T_{2 \\to 1}$**\nA neutron born at $x' \\in [L_1, L_1+L_2]$ must travel to the interface at $x = L_1$. This requires a negative direction, $\\mu \\in [-1, 0)$. Let $\\nu = -\\mu \\in (0, 1]$. The path length within Region $2$ is $s = (x' - L_1)/\\nu$. The optical path is $\\Sigma_{t,2} s$.\n$$ T_{2 \\to 1} = \\frac{1}{2 L_2} \\int_{L_1}^{L_1+L_2} dx' \\int_{0}^{1} d\\nu \\exp\\left(-\\frac{\\Sigma_{t,2}(x' - L_1)}{\\nu}\\right) $$\nThe geometry and calculation are perfectly symmetric to the $T_{1 \\to 2}$ case, with $(L_1, \\Sigma_{t,1})$ replaced by $(L_2, \\Sigma_{t,2})$. Thus, by analogy:\n$$ T_{2 \\to 1} = \\frac{1}{2 \\tau_2} \\left(\\frac{1}{2} - E_3(\\tau_2)\\right) $$\n\n**2. Derivation of Escape Probabilities**\n\n**a) Escape from Region 1 to the Left Boundary, $E_{1}^{\\mathrm{L}}$**\nA neutron from $x' \\in [0, L_1]$ escapes at $x=0$. This requires $\\mu \\in [-1, 0)$, so we use $\\nu = -\\mu \\in (0, 1]$. The path length is $s = x'/\\nu$, and it lies entirely in Region $1$.\n$$ E_{1}^{\\mathrm{L}} = \\frac{1}{2 L_1} \\int_{0}^{L_1} dx' \\int_{0}^{1} d\\nu \\exp\\left(-\\frac{\\Sigma_{t,1}x'}{\\nu}\\right) $$\nThis integral is structurally identical to the one for $T_{1 \\to 2}$ (after the change of variable $z=L_1-x'$). Therefore:\n$$ E_{1}^{\\mathrm{L}} = \\frac{1}{2 \\tau_1} \\left(\\frac{1}{2} - E_3(\\tau_1)\\right) $$\n\n**b) Escape from Region 2 to the Right Boundary, $E_{2}^{\\mathrm{R}}$**\nA neutron from $x' \\in [L_1, L_1+L_2]$ escapes at $x=L_1+L_2$. This requires $\\mu \\in (0, 1]$. The path lies entirely in Region $2$. The calculation is symmetric to $E_{1}^{\\mathrm{L}}$ with parameters for Region $2$.\n$$ E_{2}^{\\mathrm{R}} = \\frac{1}{2 \\tau_2} \\left(\\frac{1}{2} - E_3(\\tau_2)\\right) $$\n\n**c) Escape from Region 1 to the Right Boundary, $E_{1}^{\\mathrm{R}}$**\nA neutron from $x' \\in [0, L_1]$ escapes at $x=L_1+L_2$. This requires $\\mu \\in (0, 1]$. The path traverses Region $1$ over a distance $(L_1-x')/\\mu$ and Region $2$ over a distance $L_2/\\mu$. The total optical path is $\\tau = \\frac{\\Sigma_{t,1}(L_1-x')}{\\mu} + \\frac{\\Sigma_{t,2}L_2}{\\mu}$.\n$$ E_{1}^{\\mathrm{R}} = \\frac{1}{2 L_1} \\int_{0}^{L_1} dx' \\int_{0}^{1} d\\mu \\exp\\left(-\\frac{\\Sigma_{t,1}(L_1-x') + \\Sigma_{t,2}L_2}{\\mu} \\right) $$\n$$ E_{1}^{\\mathrm{R}} = \\frac{1}{2 L_1} \\int_{0}^{1} d\\mu \\exp\\left(-\\frac{\\tau_2}{\\mu}\\right) \\int_{0}^{L_1} \\exp\\left(-\\frac{\\Sigma_{t,1}(L_1-x')}{\\mu}\\right) dx' $$\nUsing the previously evaluated inner integral:\n$$ E_{1}^{\\mathrm{R}} = \\frac{1}{2 L_1} \\int_{0}^{1} d\\mu \\exp\\left(-\\frac{\\tau_2}{\\mu}\\right) \\frac{\\mu}{\\Sigma_{t,1}}\\left(1-\\exp\\left(-\\frac{\\tau_1}{\\mu}\\right)\\right) $$\n$$ E_{1}^{\\mathrm{R}} = \\frac{1}{2 \\tau_1} \\int_{0}^{1} \\left(\\mu\\exp\\left(-\\frac{\\tau_2}{\\mu}\\right) - \\mu\\exp\\left(-\\frac{\\tau_1+\\tau_2}{\\mu}\\right)\\right) d\\mu $$\nUsing the $E_3$ integral identity, this becomes:\n$$ E_{1}^{\\mathrm{R}} = \\frac{1}{2 \\tau_1} \\left( E_3(\\tau_2) - E_3(\\tau_1+\\tau_2) \\right) $$\n\n**d) Escape from Region 2 to the Left Boundary, $E_{2}^{\\mathrm{L}}$**\nA neutron from $x' \\in [L_1, L_1+L_2]$ escapes at $x=0$. This requires $\\mu \\in [-1, 0)$, so we use $\\nu=-\\mu \\in (0, 1]$. The path traverses Region $2$ over $(x'-L_1)/\\nu$ and Region $1$ over $L_1/\\nu$. The problem is symmetric to $E_{1}^{\\mathrm{R}}$ by swapping all indices $(1 \\leftrightarrow 2)$.\n$$ E_{2}^{\\mathrm{L}} = \\frac{1}{2 \\tau_2} \\left( E_3(\\tau_1) - E_3(\\tau_1+\\tau_2) \\right) $$\n\n**3. Calculation of Total Leakage Rate $L_{\\mathrm{tot}}$**\nThe total source rate in Region $i$ is $Q_i = S_i V_i = S_i L_i$ (since $A=1$). The total leakage rate is the sum of leakage rates from both source regions to both vacuum boundaries.\n$$ L_{\\mathrm{tot}} = Q_1 E_{1}^{\\mathrm{L}} + Q_1 E_{1}^{\\mathrm{R}} + Q_2 E_{2}^{\\mathrm{L}} + Q_2 E_{2}^{\\mathrm{R}} $$\nSubstituting the expressions and $Q_i=S_i L_i=\\frac{S_i \\tau_i}{\\Sigma_{t,i}}$:\n$$ L_{\\mathrm{tot}} = S_1 L_1 \\left[ \\frac{1}{2 \\tau_1} \\left(\\frac{1}{2} - E_3(\\tau_1)\\right) + \\frac{1}{2 \\tau_1} \\left( E_3(\\tau_2) - E_3(\\tau_1+\\tau_2) \\right) \\right] + S_2 L_2 \\left[ \\frac{1}{2 \\tau_2} \\left( E_3(\\tau_1) - E_3(\\tau_1+\\tau_2) \\right) + \\frac{1}{2 \\tau_2} \\left(\\frac{1}{2} - E_3(\\tau_2)\\right) \\right] $$\n$$ L_{\\mathrm{tot}} = \\frac{S_1 L_1}{2 \\tau_1} \\left(\\frac{1}{2} - E_3(\\tau_1) + E_3(\\tau_2) - E_3(\\tau_1+\\tau_2) \\right) + \\frac{S_2 L_2}{2 \\tau_2} \\left(\\frac{1}{2} - E_3(\\tau_2) + E_3(\\tau_1) - E_3(\\tau_1+\\tau_2) \\right) $$\nReplacing $L_i/\\tau_i = 1/\\Sigma_{t,i}$:\n$$ L_{\\mathrm{tot}} = \\frac{S_1}{2 \\Sigma_{t,1}} \\left(\\frac{1}{2} - E_3(\\tau_1) + E_3(\\tau_2) - E_3(\\tau_1+\\tau_2) \\right) + \\frac{S_2}{2 \\Sigma_{t,2}} \\left(\\frac{1}{2} - E_3(\\tau_2) + E_3(\\tau_1) - E_3(\\tau_1+\\tau_2) \\right) $$\n\n**4. Numerical Evaluation**\nThe given parameters are:\n- $L_{1} = 0.01$ $\\mathrm{m}$, $L_{2} = 0.02$ $\\mathrm{m}$\n- $\\Sigma_{t,1} = 100$ $\\mathrm{m}^{-1}$, $\\Sigma_{t,2} = 50$ $\\mathrm{m}^{-1}$\n- $S_{1} = 3.2 \\times 10^{7}$ $\\mathrm{s}^{-1}\\mathrm{m}^{-3}$, $S_{2} = 7.5 \\times 10^{7}$ $\\mathrm{s}^{-1}\\mathrm{m}^{-3}$\n\nFirst, we compute the optical thicknesses:\n$$ \\tau_1 = \\Sigma_{t,1} L_1 = (100 \\, \\mathrm{m}^{-1})(0.01 \\, \\mathrm{m}) = 1.0 $$\n$$ \\tau_2 = \\Sigma_{t,2} L_2 = (50 \\, \\mathrm{m}^{-1})(0.02 \\, \\mathrm{m}) = 1.0 $$\n$$ \\tau_1 + \\tau_2 = 2.0 $$\nSince $\\tau_1 = \\tau_2 = 1.0$, the expression for $L_{\\mathrm{tot}}$ simplifies significantly:\n$$ L_{\\mathrm{tot}} = \\frac{S_1}{2 \\Sigma_{t,1}} \\left(\\frac{1}{2} - E_3(1.0) + E_3(1.0) - E_3(2.0) \\right) + \\frac{S_2}{2 \\Sigma_{t,2}} \\left(\\frac{1}{2} - E_3(1.0) + E_3(1.0) - E_3(2.0) \\right) $$\n$$ L_{\\mathrm{tot}} = \\left( \\frac{S_1}{2 \\Sigma_{t,1}} + \\frac{S_2}{2 \\Sigma_{t,2}} \\right) \\left(\\frac{1}{2} - E_3(2.0) \\right) $$\nWe require the value of $E_3(2.0)$. Using standard numerical libraries or the relation $E_3(x) = \\frac{1}{2}((1-x)\\exp(-x) + x^2 E_1(x))$, we find:\n$$ E_3(2.0) \\approx 0.03013338 $$\nNow, we substitute the numerical values:\n$$ \\frac{S_1}{2 \\Sigma_{t,1}} = \\frac{3.2 \\times 10^{7} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-3}}{2 \\times 100 \\, \\mathrm{m}^{-1}} = 1.6 \\times 10^{5} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-2} $$\n$$ \\frac{S_2}{2 \\Sigma_{t,2}} = \\frac{7.5 \\times 10^{7} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-3}}{2 \\times 50 \\, \\mathrm{m}^{-1}} = 7.5 \\times 10^{5} \\, \\mathrm{s}^{-1}\\mathrm{m}^{-2} $$\nThe quantity $L_{tot}$ has units of $\\mathrm{s}^{-1}$ as it is a rate per unit transverse area, and we are given $A=1 \\, \\mathrm{m}^2$.\n$$ L_{\\mathrm{tot}} = (1.6 \\times 10^5 + 7.5 \\times 10^5) \\times (0.5 - 0.03013338) $$\n$$ L_{\\mathrm{tot}} = (9.1 \\times 10^5) \\times (0.46986662) $$\n$$ L_{\\mathrm{tot}} \\approx 427578.62 \\, \\mathrm{s}^{-1} $$\nRounding to four significant figures, we get:\n$$ L_{\\mathrm{tot}} \\approx 4.276 \\times 10^5 \\, \\mathrm{s}^{-1} $$",
            "answer": "$$\\boxed{4.276 \\times 10^{5}}$$"
        }
    ]
}