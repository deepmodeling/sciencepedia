{
    "hands_on_practices": [
        {
            "introduction": "Effective modeling is a cornerstone of reactor physics, allowing complex phenomena to be represented by simpler, computationally tractable parameters. This first practice explores how to model a partially transparent boundary not as a complex surface condition, but as an equivalent, spatially-homogeneous \"leakage cross section\" added to the material properties . By applying the principle of competing hazards, you will see how boundary effects can be integrated directly into the transport equation, a technique fundamental to homogenization methods.",
            "id": "4225707",
            "problem": "Consider a homogeneous, isotropically emitting and attenuating medium occupying a convex body of volume $V$ and surface area $S$. Neutrons travel in straight lines between interactions, with free-flight governed by the macroscopic total cross section $\\Sigma_{t}$ (units $\\text{cm}^{-1}$). The boundary is partially transparent: upon each boundary crossing, a neutron leaks (is lost) with probability $P_{\\text{leak}} \\in (0,1)$; with probability $1 - P_{\\text{leak}}$ it is perfectly returned to the medium and immediately re-isotropized (no energy change).\n\nStarting from the free-path exponential law and the well-tested geometric fact that, for isotropic straight-flight inside a convex body, the expected number of boundary crossings per unit path length equals $S/(4V)$, show that the partially transparent boundary can be modeled as an additional, path-length-homogeneous attenuation with an effective attenuation coefficient. Then, using the principle of independent competing hazards, derive the adjusted first-flight collision probability $P^{(1)}$ that the neutron’s first terminating event is a material collision (not leakage), expressed in terms of $\\Sigma_{t}$, $S/V$, and $P_{\\text{leak}}$.\n\nFinally, evaluate $P^{(1)}$ numerically for a plane-parallel slab of thickness $T$ with large lateral extent (so that edge effects are negligible). For such a slab, take $S/V = 2/T$. Use $T = 5\\,\\text{cm}$, $\\Sigma_{t} = 0.8\\,\\text{cm}^{-1}$, and $P_{\\text{leak}} = 0.3$. Express the final numerical value of $P^{(1)}$ as a dimensionless decimal rounded to four significant figures.",
            "solution": "The solution is developed in three parts.\n\nFirst, we model the effect of the partially transparent boundary as an effective attenuation coefficient. A neutron traveling in the medium can be removed by two distinct stochastic processes: a material collision or leakage. The probability per unit path length of a material collision is given by the macroscopic total cross section, $\\Sigma_t$.\n\nThe problem states that for isotropic flight in a convex body, the expected number of boundary crossings per unit path length is $\\frac{S}{4V}$. Each crossing results in leakage with probability $P_{\\text{leak}}$. This leakage can be modeled as an independent Poisson process. The rate of this process, which we define as an effective macroscopic leakage cross section $\\Sigma_{\\text{leak}}$, is the product of the rate of boundary crossings and the probability of leakage per crossing:\n$$\n\\Sigma_{\\text{leak}} = \\left(\\frac{S}{4V}\\right) P_{\\text{leak}}\n$$\nThis $\\Sigma_{\\text{leak}}$ represents a spatially homogeneous probability per unit length of a neutron being removed from the system via leakage.\n\nSecond, we derive the adjusted first-flight collision probability, $P^{(1)}$. In this system, there are two independent, competing terminating events: material collision (rate $\\Sigma_t$) and boundary leakage (rate $\\Sigma_{\\text{leak}}$). According to the principle of competing hazards, the total rate of termination is $\\Sigma_{\\text{total}} = \\Sigma_t + \\Sigma_{\\text{leak}}$.\n\nThe probability that the first terminating event is a material collision is the ratio of the collision rate to the total termination rate:\n$$\nP^{(1)} = \\frac{\\text{Rate of material collision}}{\\text{Total rate of termination}} = \\frac{\\Sigma_t}{\\Sigma_t + \\Sigma_{\\text{leak}}}\n$$\nSubstituting the expression for $\\Sigma_{\\text{leak}}$, we obtain the analytical expression:\n$$\nP^{(1)} = \\frac{\\Sigma_t}{\\Sigma_t + \\frac{S P_{\\text{leak}}}{4V}}\n$$\nThird, we evaluate $P^{(1)}$ numerically for the specified large plane-parallel slab. The given parameters are $T = 5\\,\\text{cm}$, $\\Sigma_t = 0.8\\,\\text{cm}^{-1}$, $P_{\\text{leak}} = 0.3$, and for this geometry, $S/V = 2/T$.\n\nFirst, we calculate the numerical value for the geometric term and the effective leakage cross section:\n$$\n\\frac{S}{V} = \\frac{2}{T} = \\frac{2}{5\\,\\text{cm}} = 0.4\\,\\text{cm}^{-1}\n$$\n$$\n\\Sigma_{\\text{leak}} = \\frac{S P_{\\text{leak}}}{4V} = \\frac{1}{4} \\left(\\frac{S}{V}\\right) P_{\\text{leak}} = \\frac{1}{4} (0.4\\,\\text{cm}^{-1}) (0.3) = 0.03\\,\\text{cm}^{-1}\n$$\nNow, we can calculate the numerical value of $P^{(1)}$:\n$$\nP^{(1)} = \\frac{\\Sigma_t}{\\Sigma_t + \\Sigma_{\\text{leak}}} = \\frac{0.8\\,\\text{cm}^{-1}}{0.8\\,\\text{cm}^{-1} + 0.03\\,\\text{cm}^{-1}} = \\frac{0.8}{0.83}\n$$\nPerforming the division and rounding to four significant figures as required:\n$$\nP^{(1)} = \\frac{0.8}{0.83} \\approx 0.96385542... \\approx 0.9639\n$$",
            "answer": "$$\\boxed{0.9639}$$"
        },
        {
            "introduction": "While models simplify, direct numerical simulation provides a more rigorous solution. This exercise guides you through the process of developing a deterministic solver for the first-flight collision probability between two adjacent regions, a foundational calculation in the Collision Probability (CP) method . You will translate the integral definition of $P_{ij}^{(1)}$ into a practical algorithm using ray tracing and Gauss-Legendre quadrature, providing direct experience with the numerical engine behind many lattice physics codes.",
            "id": "4225749",
            "problem": "Consider two contiguous, infinite, homogeneous planar slabs in three-dimensional space, with a common planar interface aligned with the plane $x = 0$. Region $i$ occupies $x \\in [-d_i, 0]$ and region $j$ occupies $x \\in [0, d_j]$, where $d_i > 0$ and $d_j > 0$ are the slab thicknesses. The materials have macroscopic total cross sections $\\Sigma_{t,i}$ and $\\Sigma_{t,j}$, respectively, both measured in inverse centimeters. Neutrons are born uniformly in space throughout region $i$, with an isotropic angular distribution in the full sphere. A neutron travels along straight-line trajectories and undergoes exponential attenuation in each homogeneous region according to the well-tested law of exponential attenuation: the probability of survival without collision over a path length $s$ in a material with macroscopic total cross section $\\Sigma_t$ is $\\exp(-\\Sigma_t s)$. Assume no scattering between regions before the first collision, and assume that if a neutron exits region $j$ without colliding then it is lost.\n\nDefine the first-flight collision probability $P_{ij}^{(1)}$ as the probability that a neutron born in region $i$ undergoes its first collision in region $j$. Starting from the fundamental definitions above, and using a direction cosine $\\mu = \\cos\\theta$ with respect to the slab normal (aligned with the $+x$ axis), where the polar angle $\\theta$ is measured in radians, derive a mathematically correct expression for $P_{ij}^{(1)}$ in terms of integrals over the birth position $x \\in [-d_i, 0]$ and the angular variable $\\mu \\in [0, 1]$. Use the fact that for isotropic emission in three dimensions, the differential solid angle measure is $\\mathrm{d}\\Omega = 2\\pi\\,\\mathrm{d}\\mu$ and the directional probability density is $1/(4\\pi)$.\n\nImplement a program that computes $P_{ij}^{(1)}$ deterministically by:\n- Using ray tracing to evaluate the path length to the interface in region $i$ and the path length across region $j$ for a given direction cosine $\\mu$, and\n- Approximating the angular integral over $\\mu \\in [0, 1]$ with an $N$-point Gauss–Legendre quadrature on the half-range, where $N$ is a positive integer referred to as the angular order.\n\nAdditionally, estimate the quadrature error as a function of angular order $N$ by comparing the quadrature-based value of $P_{ij}^{(1)}$ to a high-accuracy reference computed via adaptive numerical integration of the same integral over $\\mu \\in [0, 1]$.\n\nPhysical units: slab thicknesses $d_i$ and $d_j$ must be expressed in centimeters, and macroscopic total cross sections $\\Sigma_{t,i}$ and $\\Sigma_{t,j}$ must be expressed in inverse centimeters. The angle $\\theta$ is measured in radians. The final quantity $P_{ij}^{(1)}$ is a dimensionless probability.\n\nYour program must evaluate the following test suite:\n- Test case A (baseline geometry and error study): $d_i = $ $2.0$ cm, $d_j = $ $3.0$ cm, $\\Sigma_{t,i} = $ $0.8$ cm$^{-1}$, $\\Sigma_{t,j} = $ $1.2$ cm$^{-1}$. Compute the absolute quadrature error for $N \\in \\{\\,1,\\,2,\\,4,\\,8,\\,16,\\,32\\,\\}$ relative to a high-accuracy reference.\n- Test case B (vacuum target region): $d_i = $ $2.0$ cm, $d_j = $ $10.0$ cm, $\\Sigma_{t,i} = $ $0.8$ cm$^{-1}$, $\\Sigma_{t,j} = $ $0.0$ cm$^{-1}$. Compute $P_{ij}^{(1)}$ using quadrature with $N = $ $16$.\n- Test case C (very thick and highly absorbing target region): $d_i = $ $2.0$ cm, $d_j = $ $50.0$ cm, $\\Sigma_{t,i} = $ $0.8$ cm$^{-1}$, $\\Sigma_{t,j} = $ $10.0$ cm$^{-1}$. Compute $P_{ij}^{(1)}$ using quadrature with $N = $ $16$.\n- Test case D (extremely thin source region): $d_i = $ $0.01$ cm, $d_j = $ $3.0$ cm, $\\Sigma_{t,i} = $ $0.8$ cm$^{-1}$, $\\Sigma_{t,j} = $ $1.2$ cm$^{-1}$. Compute $P_{ij}^{(1)}$ using quadrature with $N = $ $16$.\n\nError values and computed probabilities must be returned as floating-point numbers.\n\nFinal output format: Your program should produce a single line of output containing a comma-separated list enclosed in square brackets. The list must concatenate the $6$ absolute error values for Test case A in the order of increasing $N$, followed by the three $P_{ij}^{(1)}$ values for Test cases B, C, and D, in that order. For example, the output must have the form \"[error_N1,error_N2,error_N4,error_N8,error_N16,error_N32,P_vacuum,P_thick,P_thin]\".",
            "solution": "The first-flight collision probability, $P_{ij}^{(1)}$, is the probability that a neutron born uniformly and isotropically in region $i$ has its first collision in region $j$. This can be formulated as an integral over the phase space of the neutron source, which is uniform in position over region $i$ and isotropic in direction.\n\nLet a neutron be born at a position $x_0 \\in [-d_i, 0]$ with a direction characterized by the cosine of the polar angle, $\\mu = \\cos\\theta$, with respect to the positive $x$-axis. The source is isotropic, so the probability distribution of emission directions is uniform over the $4\\pi$ solid angle, with a probability density of $1/(4\\pi)$ per steradian. The differential solid angle element for azimuthally symmetric problems is $\\mathrm{d}\\Omega = 2\\pi\\,\\mathrm{d}\\mu$. Thus, the probability of a neutron being emitted with a direction cosine between $\\mu$ and $\\mu + \\mathrm{d}\\mu$ is $\\frac{2\\pi \\mathrm{d}\\mu}{4\\pi} = \\frac{1}{2} \\mathrm{d}\\mu$. The source is uniform in space, so the probability of birth in a differential element $\\mathrm{d}x_0$ is $\\mathrm{d}x_0/d_i$.\n\nA neutron born at $x_0$ with direction $\\mu$ can only reach region $j$ (where $x > 0$) if it is traveling in the positive $x$ direction, i.e., $\\mu > 0$. The probability $P_{ij}^{(1)}$ is therefore an average over all birth positions $x_0 \\in [-d_i, 0]$ and all forward directions $\\mu \\in [0, 1]$:\n$$ P_{ij}^{(1)} = \\int_{-d_i}^{0} \\frac{\\mathrm{d}x_0}{d_i} \\int_{0}^{1} \\frac{1}{2} P(\\text{collision in } j | x_0, \\mu) \\, \\mathrm{d}\\mu $$\nwhere $P(\\text{collision in } j | x_0, \\mu)$ is the conditional probability that a neutron born at $x_0$ with direction $\\mu$ has its first collision in region $j$.\n\nFor this event to occur, the neutron must:\n1.  Travel from its birth position $x_0$ to the interface at $x=0$ without colliding. The path length in region $i$ is $s_i = (0 - x_0)/\\mu = -x_0/\\mu$. The probability of surviving this path is given by the law of exponential attenuation: $P_{\\text{survival}, i} = \\exp(-\\Sigma_{t,i} s_i) = \\exp(\\Sigma_{t,i} x_0 / \\mu)$.\n2.  Enter region $j$ and have its first collision before exiting at $x=d_j$. The path length across region $j$ is $s_j = d_j/\\mu$. The probability of colliding within this path length is $1$ minus the probability of surviving it: $P_{\\text{collision}, j} = 1 - \\exp(-\\Sigma_{t,j} s_j) = 1 - \\exp(-\\Sigma_{t,j} d_j / \\mu)$.\n\nThe conditional probability is the product of these two independent events:\n$$ P(\\text{collision in } j | x_0, \\mu) = \\exp\\left(\\frac{\\Sigma_{t,i} x_0}{\\mu}\\right) \\left[1 - \\exp\\left(-\\frac{\\Sigma_{t,j} d_j}{\\mu}\\right)\\right] $$\nSubstituting this into the integral for $P_{ij}^{(1)}$ and reordering the integration gives:\n$$ P_{ij}^{(1)} = \\int_{0}^{1} \\frac{1}{2 d_i} \\left[1 - \\exp\\left(-\\frac{\\Sigma_{t,j} d_j}{\\mu}\\right)\\right] \\left( \\int_{-d_i}^{0} \\exp\\left(\\frac{\\Sigma_{t,i} x_0}{\\mu}\\right) \\mathrm{d}x_0 \\right) \\mathrm{d}\\mu $$\nThe inner integral over $x_0$ can be solved analytically. Let this integral be $J(\\mu)$:\n$$ J(\\mu) = \\int_{-d_i}^{0} \\exp\\left(\\frac{\\Sigma_{t,i} x_0}{\\mu}\\right) \\mathrm{d}x_0 $$\nTwo cases must be considered for the evaluation of $J(\\mu)$:\n- If $\\Sigma_{t,i} > 0$:\n$$ J(\\mu) = \\left[ \\frac{\\mu}{\\Sigma_{t,i}} \\exp\\left(\\frac{\\Sigma_{t,i} x_0}{\\mu}\\right) \\right]_{-d_i}^0 = \\frac{\\mu}{\\Sigma_{t,i}} \\left(1 - \\exp\\left(-\\frac{\\Sigma_{t,i} d_i}{\\mu}\\right)\\right) $$\n- If $\\Sigma_{t,i} = 0$ (a vacuum in region $i$):\n$$ J(\\mu) = \\int_{-d_i}^{0} 1 \\, \\mathrm{d}x_0 = d_i $$\nThis result can also be obtained by taking the limit of the first case as $\\Sigma_{t,i} \\to 0$.\n\nLet the integrand of the angular integral be $I(\\mu)$. It is given by:\n$$ I(\\mu) = \\frac{1}{2 d_i} \\left[1 - \\exp\\left(-\\frac{\\Sigma_{t,j} d_j}{\\mu}\\right)\\right] J(\\mu) $$\nThus, $P_{ij}^{(1)} = \\int_0^1 I(\\mu) \\, \\mathrm{d}\\mu$. This final integral over $\\mu$ does not have a closed-form solution in terms of elementary functions and must be evaluated numerically. The integrand $I(\\mu)$ is a smooth function for $\\mu \\in (0,1]$ and its limit is $0$ as $\\mu \\to 0^+$, making it well-suited for high-order quadrature methods.\n\nThe problem specifies using an $N$-point Gauss-Legendre quadrature. This method approximates an integral over the interval $[-1, 1]$ as a weighted sum: $\\int_{-1}^1 g(z)\\,\\mathrm{d}z \\approx \\sum_{k=1}^N w_k g(z_k)$, where $z_k$ and $w_k$ are the quadrature points and weights. To apply this to our integral over $[0, 1]$, we perform a change of variables: $\\mu = (z+1)/2$, which gives $\\mathrm{d}\\mu = \\mathrm{d}z/2$. The integral becomes:\n$$ P_{ij}^{(1)} = \\int_{-1}^{1} I\\left(\\frac{z+1}{2}\\right) \\frac{1}{2} \\, \\mathrm{d}z \\approx \\sum_{k=1}^{N} \\frac{w_k}{2} I\\left(\\frac{z_k+1}{2}\\right) $$\nThis deterministic calculation will be implemented for the specified test cases. For the error analysis in Test Case A, a high-accuracy reference value is computed using an adaptive quadrature routine (`scipy.integrate.quad`), which provides a benchmark against which the Gauss-Legendre quadrature results can be compared. The absolute error is then $|P_{ij,\\text{Gauss}}^{(1)} - P_{ij,\\text{ref}}^{(1)}|$.\n\nSpecial cases check the physical limits:\n- If region $j$ is a vacuum ($\\Sigma_{t,j} = 0$), then the term $1 - \\exp(-\\Sigma_{t,j} d_j / \\mu)$ is always zero. Thus, $I(\\mu) = 0$ and $P_{ij}^{(1)} = 0$, which is physically correct as no collisions can occur in a vacuum.\n- If region $j$ is very thick or highly absorbing ($\\Sigma_{t,j} d_j \\to \\infty$), then $1 - \\exp(-\\Sigma_{t,j} d_j / \\mu) \\to 1$ for all $\\mu > 0$. $P_{ij}^{(1)}$ then represents the total probability of a neutron escaping region $i$ into region $j$.\n- If region $i$ is very thin ($d_i \\to 0$), it approximates a planar source at the interface. The probability $P_{ij}^{(1)}$ for a thin source approaches that for a surface source.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Solves the first-flight collision probability problem for the given test cases.\n    \"\"\"\n\n    def get_integrand_function(di, dj, sig_ti, sig_tj):\n        \"\"\"\n        Creates a vectorized function for the integrand of the angular integral.\n\n        The expression for P_ij^(1) is derived as:\n        P_ij = integral from 0 to 1 of I(mu) d(mu), where\n        I(mu) = (1 / (2 * di)) * (integral over x0) * (prob_collide_in_j)\n        \n        Args:\n            di (float): Thickness of region i (cm).\n            dj (float): Thickness of region j (cm).\n            sig_ti (float): Macroscopic total cross section of region i (cm^-1).\n            sig_tj (float): Macroscopic total cross section of region j (cm^-1).\n\n        Returns:\n            A function that computes the integrand I(mu) for a given mu (or array of mu).\n        \"\"\"\n        \n        def integrand(mu):\n            # The integrand is 0 at mu=0. Using a small epsilon to avoid division by zero.\n            mu = np.maximum(mu, 1e-15)\n\n            # Probability of collision in region j, given entry at x=0\n            prob_collide_in_j = 1.0 - np.exp(-sig_tj * dj / mu)\n\n            # Spatially averaged transmission probability through region i\n            # This is the integral over x0 from -di to 0 of exp(sig_ti * x0 / mu).\n            if sig_ti == 0.0:\n                # If region i is a vacuum, the integral evaluates to di\n                integral_x0 = np.full_like(mu, di)\n            else:\n                # Standard case\n                integral_x0 = (mu / sig_ti) * (1.0 - np.exp(-sig_ti * di / mu))\n\n            # The full integrand for the angular integral\n            # I(mu) = (1/2di) * J(mu) * P_coll,j\n            # where J(mu) is the spatial integral\n            integrand_val = (1.0 / (2.0 * di)) * integral_x0 * prob_collide_in_j\n            return integrand_val\n\n        return integrand\n\n    def calculate_p_ij_gauss(integrand_func, N):\n        \"\"\"\n        Calculates the integral using N-point Gauss-Legendre quadrature.\n        \"\"\"\n        # Get standard [-1, 1] points and weights\n        points, weights = leggauss(N)\n\n        # Transform points and weights for [0, 1] interval\n        mu_points = 0.5 * (points + 1.0)\n        mu_weights = 0.5 * weights\n        \n        # Evaluate integrand at quadrature points (vectorized)\n        integrand_values = integrand_func(mu_points)\n        \n        # Compute the weighted sum\n        integral = np.sum(mu_weights * integrand_values)\n        return integral\n\n    def get_reference_p_ij(integrand_func):\n        \"\"\"\n        Calculates a high-accuracy reference value using adaptive quadrature.\n        \"\"\"\n        ref_val, _ = quad(integrand_func, 0, 1, epsabs=1e-15, epsrel=1e-15, limit=200)\n        return ref_val\n\n    results = []\n\n    # Test case A: Baseline geometry and error study\n    di_A, dj_A, sig_ti_A, sig_tj_A = 2.0, 3.0, 0.8, 1.2\n    integrand_A = get_integrand_function(di_A, dj_A, sig_ti_A, sig_tj_A)\n    p_ij_ref_A = get_reference_p_ij(integrand_A)\n    \n    orders_N = [1, 2, 4, 8, 16, 32]\n    for N in orders_N:\n        p_ij_gauss = calculate_p_ij_gauss(integrand_A, N)\n        error = abs(p_ij_gauss - p_ij_ref_A)\n        results.append(error)\n\n    # Test case B: Vacuum target region\n    di_B, dj_B, sig_ti_B, sig_tj_B = 2.0, 10.0, 0.8, 0.0\n    integrand_B = get_integrand_function(di_B, dj_B, sig_ti_B, sig_tj_B)\n    p_ij_B = calculate_p_ij_gauss(integrand_B, N=16)\n    results.append(p_ij_B)\n\n    # Test case C: Very thick and highly absorbing target region\n    di_C, dj_C, sig_ti_C, sig_tj_C = 2.0, 50.0, 0.8, 10.0\n    integrand_C = get_integrand_function(di_C, dj_C, sig_ti_C, sig_tj_C)\n    p_ij_C = calculate_p_ij_gauss(integrand_C, N=16)\n    results.append(p_ij_C)\n    \n    # Test case D: Extremely thin source region\n    di_D, dj_D, sig_ti_D, sig_tj_D = 0.01, 3.0, 0.8, 1.2\n    integrand_D = get_integrand_function(di_D, dj_D, sig_ti_D, sig_tj_D)\n    p_ij_D = calculate_p_ij_gauss(integrand_D, N=16)\n    results.append(p_ij_D)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Contrasting with deterministic methods, Monte Carlo techniques solve transport problems by simulating a large number of individual particle histories. This practice introduces the fundamentals of this stochastic approach by tasking you with designing a simple but powerful \"collision estimator\" for $P_{ij}^{(1)}$ . You will derive the analytical form of the estimator's variance, revealing the intrinsic link between the physical probability and the statistical efficiency of the simulation, a key concept in all Monte Carlo analysis.",
            "id": "4225715",
            "problem": "Consider a one-dimensional, monoenergetic neutron transport scenario consisting of two contiguous, homogeneous planar regions, denoted region $i$ and region $j$, bounded by parallel planes. Region $i$ has thickness $\\ell_{i}$ and macroscopic total cross section $\\Sigma_{t,i}$, and region $j$ has thickness $\\ell_{j}$ and macroscopic total cross section $\\Sigma_{t,j}$. A neutron source at the left external boundary of region $i$ injects neutrons traveling deterministically in the $+x$ direction. Neglect energy change and scattering redirection; model collisions along the flight path as a spatial Poisson process with intensity equal to the local macroscopic total cross section. Define the optical thicknesses $\\tau_{i} = \\Sigma_{t,i} \\,\\ell_{i}$ and $\\tau_{j} = \\Sigma_{t,j} \\,\\ell_{j}$. Let $P_{ij}^{(1)}$ denote the probability that the neutron’s first collision occurs in region $j$.\n\nUsing only foundational definitions for exponential attenuation and the spatial Poisson process of collisions, do the following:\n\n- Derive, from first principles, the event probability $P_{ij}^{(1)}$ in terms of $\\tau_{i}$ and $\\tau_{j}$.\n- Construct a Monte Carlo (MC) collision estimator for $P_{ij}^{(1)}$ that scores $1$ if and only if the first collision occurs in region $j$, and $0$ otherwise. Justify that the estimator is unbiased.\n- Analyze the variance of this estimator as a function of the optical thicknesses $\\tau_{i}$ and $\\tau_{j}$, and provide a single closed-form analytic expression for the variance in terms of $\\tau_{i}$ and $\\tau_{j}$.\n\nYour final answer must be a single closed-form analytic expression. Do not include any units, and do not round; no numerical evaluation is required.",
            "solution": "This problem is solved in three parts: deriving the first-collision probability $P_{ij}^{(1)}$, constructing and justifying an associated Monte Carlo (MC) estimator, and analyzing the estimator's variance. The analysis is based on first principles, modeling collisions as a spatial Poisson process.\n\nFirst, we derive the probability $P_{ij}^{(1)}$. The event \"the first collision occurs in region $j$\" requires two sequential, independent events to occur:\n1. The neutron must travel through all of region $i$ without a collision.\n2. Having entered region $j$, the neutron must then have its first collision within region $j$.\n\nThe probability of a neutron surviving a path with optical thickness $\\tau$ is $\\exp(-\\tau)$. Therefore, the probability of surviving region $i$, which has optical thickness $\\tau_i$, is:\n$$P(\\text{survival through } i) = \\exp(-\\tau_{i})$$\nGiven that the neutron has entered region $j$, the probability that it collides within that region is complementary to the probability that it survives. The probability of surviving region $j$ is $\\exp(-\\tau_j)$. Therefore, the conditional probability of colliding within region $j$ is:\n$$P(\\text{collision in } j | \\text{survival through } i) = 1 - \\exp(-\\tau_{j})$$\nSince the underlying Poisson process is memoryless, the two events are independent. The total probability $P_{ij}^{(1)}$ is the product of their individual probabilities:\n$$P_{ij}^{(1)} = P(\\text{survival through } i) \\times P(\\text{collision in } j | \\text{survival through } i) = \\exp(-\\tau_{i}) (1 - \\exp(-\\tau_{j}))$$\nNext, we construct an MC collision estimator for $P_{ij}^{(1)}$ and justify its unbiasedness. An indicator variable serves as a simple and effective estimator. Let the random variable $I$ be the estimator:\n$$I = \\begin{cases} 1 & \\text{if the first collision is in region } j \\\\ 0 & \\text{otherwise} \\end{cases}$$\nAn estimator $\\hat{\\theta}$ of a quantity $\\theta$ is unbiased if its expected value, $E[\\hat{\\theta}]$, equals $\\theta$. Here, we must show that $E[I] = P_{ij}^{(1)}$. By the definition of expected value for a discrete random variable:\n$$E[I] = \\sum_{k \\in \\{0,1\\}} k \\cdot P(I=k) = (1) \\cdot P(I=1) + (0) \\cdot P(I=0) = P(I=1)$$\nThe event $I=1$ is identical to the event \"the first collision occurs in region $j$,\" the probability of which is $P_{ij}^{(1)}$. Thus, we have:\n$$E[I] = P_{ij}^{(1)}$$\nThis confirms that the estimator $I$ is unbiased.\n\nFinally, we analyze the variance of this estimator. The variance of a random variable $X$ is $\\text{Var}(X) = E[X^2] - (E[X])^2$. For our indicator variable $I$, since its only possible values are $0$ and $1$, we have $I^2 = I$. This simplifies the first term in the variance formula: $E[I^2] = E[I]$.\nThe variance of the estimator is therefore:\n$$\\text{Var}(I) = E[I] - (E[I])^2$$\nThis is the well-known variance of a Bernoulli random variable. Let $p = P_{ij}^{(1)} = E[I]$. The variance is:\n$$\\text{Var}(I) = p(1-p)$$\nTo obtain the final expression in terms of the optical thicknesses, we substitute the derived expression for $p$:\n$$\\text{Var}(I) = \\left[ \\exp(-\\tau_{i})(1 - \\exp(-\\tau_{j})) \\right] \\left[ 1 - \\exp(-\\tau_{i})(1 - \\exp(-\\tau_{j})) \\right]$$\nThis is the required single closed-form analytic expression for the variance of the specified MC estimator.",
            "answer": "$$\\boxed{\\left( \\exp(-\\tau_{i})(1 - \\exp(-\\tau_{j})) \\right) \\left( 1 - \\exp(-\\tau_{i})(1 - \\exp(-\\tau_{j})) \\right)}$$"
        }
    ]
}