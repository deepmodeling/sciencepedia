{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any numerical transport method is the careful discretization of the continuous Boltzmann equation. This first exercise guides you through this fundamental process for a two-dimensional Cartesian cell. By applying a finite volume balance and the classic diamond-difference closure relation, you will derive the algebraic equations that an S₂ code solves, providing a concrete understanding of how particle balance is enforced at the discrete level .",
            "id": "4225370",
            "problem": "Consider steady, monoenergetic transport in a two-dimensional Cartesian cell with isotropic fixed internal source, modeled by the linear Boltzmann transport equation. The fundamental base is the angular flux balance equation for a direction cosine pair, which, in planar geometry, can be written as $ \\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\boldsymbol{r}, \\boldsymbol{\\Omega}) + \\Sigma_{t} \\psi(\\boldsymbol{r}, \\boldsymbol{\\Omega}) = Q(\\boldsymbol{r}, \\boldsymbol{\\Omega}) $, where $ \\psi $ is the angular flux, $ \\boldsymbol{\\Omega} $ is the unit direction vector with components $ \\mu $ and $ \\eta $, $ \\Sigma_{t} $ is the total macroscopic cross section, and $ Q $ is the source term.\n\nUse a Discrete Ordinates ($S_{n}$) angular discretization, specifically an $S_2$ discretization (4 directions), in two-dimensional Cartesian geometry, using the level-symmetric set with direction cosines $ (\\mu_{m}, \\eta_{m}) \\in \\{ (\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}), (\\frac{1}{\\sqrt{2}}, -\\frac{1}{\\sqrt{2}}), (-\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}), (-\\frac{1}{\\sqrt{2}}, -\\frac{1}{\\sqrt{2}}) \\} $ and quadrature weights $ w_{m} = \\frac{\\pi}{2} $ so that $ \\sum_{m=1}^{4} w_{m} = 2 \\pi $. Assume vacuum (black) boundary conditions on all four faces of the cell.\n\nDiscretize the transport equation using a finite volume cell balance over a single square cell of side length $ h = 2 $ (nondimensional length units), with cell-centered total cross section $ \\Sigma_{t} = 1 $ (nondimensional), and angle-independent, isotropic fixed source per discrete direction $ Q^{m} = q = 0.5 $ (nondimensional). Close the discretization using the diamond-difference relation on each face. Perform the directional sweep consistently with upwind ordering implied by the signs of $ \\mu_{m} $ and $ \\eta_{m} $ (for example, for $ \\mu_{m} > 0 $ and $ \\eta_{m} > 0 $, sweep from the southwest face to the northeast face; adjust accordingly for other sign combinations). Because there is only one cell, the sweep ordering must still respect the identification of incoming faces for each direction.\n\nStarting from the continuous angular flux balance, derive the discrete diamond-difference cell equation for the cell-centered angular flux in a given direction and use it to compute the discrete scalar flux $ \\phi $ at the cell center as $ \\phi \\approx \\sum_{m=1}^{4} w_{m} \\psi^{m} $, where $ \\psi^{m} $ is the cell-centered angular flux for direction $ m $. Round your final numeric result for $ \\phi $ to four significant figures. Express your final answer in dimensionless units.",
            "solution": "The user wants to find the cell-centered scalar flux in a single, two-dimensional Cartesian cell using the Discrete Ordinates ($S_n$) method with a diamond-difference spatial closure.\n\nThe starting point is the steady-state, monoenergetic, linear Boltzmann transport equation in two-dimensional Cartesian coordinates $(x, y)$ for a discrete direction $m$:\n$$ \\mu_m \\frac{\\partial \\psi_m(x, y)}{\\partial x} + \\eta_m \\frac{\\partial \\psi_m(x, y)}{\\partial y} + \\Sigma_t \\psi_m(x, y) = Q_m(x, y) $$\nHere, $\\psi_m$ is the angular flux for direction $m$, $(\\mu_m, \\eta_m)$ are the direction cosines, $\\Sigma_t$ is the total macroscopic cross section, and $Q_m$ is the source term for direction $m$.\n\nTo discretize this equation, we integrate it over the area of the square cell, which extends from $x_{i-1/2}$ to $x_{i+1/2}$ in the $x$-direction and from $y_{j-1/2}$ to $y_{j+1/2}$ in the $y$-direction. The cell has a side length of $h$. The cell area is $A = h^2$.\n$$ \\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\mu_m \\frac{\\partial \\psi_m}{\\partial x} + \\eta_m \\frac{\\partial \\psi_m}{\\partial y} \\right) dx dy + \\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\Sigma_t \\psi_m dx dy = \\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} Q_m dx dy $$\nIntegrating the derivative terms yields:\n$$ \\mu_m \\int_{y_{j-1/2}}^{y_{j+1/2}} \\left[ \\psi_m(x_{i+1/2}, y) - \\psi_m(x_{i-1/2}, y) \\right] dy + \\eta_m \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left[ \\psi_m(x, y_{j+1/2}) - \\psi_m(x, y_{j-1/2}) \\right] dx + \\text{(loss term)} = \\text{(source term)} $$\nWe introduce the following finite-difference approximations:\n- Cell-averaged angular flux: $\\psi_m^{i,j} \\approx \\frac{1}{h^2} \\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi_m(x, y) dx dy$\n- Face-averaged angular fluxes:\n  $\\psi_{m, i+1/2} \\approx \\frac{1}{h} \\int_{y_{j-1/2}}^{y_{j+1/2}} \\psi_m(x_{i+1/2}, y) dy$\n  $\\psi_{m, i-1/2} \\approx \\frac{1}{h} \\int_{y_{j-1/2}}^{y_{j+1/2}} \\psi_m(x_{i-1/2}, y) dy$\n  (and similarly for the $y$-faces, $\\psi_{m, j+1/2}$ and $\\psi_{m, j-1/2}$).\n- Cell-averaged source: $Q_m^{i,j} \\approx \\frac{1}{h^2} \\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} Q_m(x, y) dx dy$\n\nWith these approximations, and assuming $\\Sigma_t$ and $Q_m$ are constant within the cell, the integrated equation becomes the discrete cell balance equation. For simplicity, we drop the cell indices $(i,j)$ as there is only one cell.\n$$ \\mu_m h (\\psi_{m, i+1/2} - \\psi_{m, i-1/2}) + \\eta_m h (\\psi_{m, j+1/2} - \\psi_{m, j-1/2}) + \\Sigma_t h^2 \\psi^m = Q^m h^2 $$\nDividing by the cell area $h^2$, we get:\n$$ \\frac{\\mu_m}{h} (\\psi_{m, i+1/2} - \\psi_{m, i-1/2}) + \\frac{\\eta_m}{h} (\\psi_{m, j+1/2} - \\psi_{m, j-1/2}) + \\Sigma_t \\psi^m = Q^m $$\nThis equation must be written to account for the direction of particle flow (upwinding). The terms representing flux differences can be rewritten using incoming and outgoing face fluxes. For a direction $m$, let $\\psi_{m, \\text{in}, x}$ and $\\psi_{m, \\text{out}, x}$ be the incoming and outgoing fluxes on faces perpendicular to the $x$-axis, respectively (and similarly for $y$). The balance equation is:\n$$ \\frac{|\\mu_m|}{h} (\\psi_{m, \\text{out}, x} - \\psi_{m, \\text{in}, x}) + \\frac{|\\eta_m|}{h} (\\psi_{m, \\text{out}, y} - \\psi_{m, \\text{in}, y}) + \\Sigma_t \\psi^m = Q^m $$\nThe diamond-difference (DD) closure relations link the cell-average flux to the face-average fluxes:\n$$ \\psi^m = \\frac{\\psi_{m, \\text{out}, x} + \\psi_{m, \\text{in}, x}}{2} \\implies \\psi_{m, \\text{out}, x} = 2 \\psi^m - \\psi_{m, \\text{in}, x} $$\n$$ \\psi^m = \\frac{\\psi_{m, \\text{out}, y} + \\psi_{m, \\text{in}, y}}{2} \\implies \\psi_{m, \\text{out}, y} = 2 \\psi^m - \\psi_{m, \\text{in}, y} $$\nSubstituting these expressions for the outgoing fluxes into the balance equation:\n$$ \\frac{|\\mu_m|}{h} ((2\\psi^m - \\psi_{m, \\text{in}, x}) - \\psi_{m, \\text{in}, x}) + \\frac{|\\eta_m|}{h} ((2\\psi^m - \\psi_{m, \\text{in}, y}) - \\psi_{m, \\text{in}, y}) + \\Sigma_t \\psi^m = Q^m $$\nSimplifying this equation:\n$$ \\frac{2|\\mu_m|}{h} (\\psi^m - \\psi_{m, \\text{in}, x}) + \\frac{2|\\eta_m|}{h} (\\psi^m - \\psi_{m, \\text{in}, y}) + \\Sigma_t \\psi^m = Q^m $$\nWe can now solve for the unknown cell-average flux $\\psi^m$:\n$$ \\psi^m \\left( \\frac{2|\\mu_m|}{h} + \\frac{2|\\eta_m|}{h} + \\Sigma_t \\right) = Q^m + \\frac{2|\\mu_m|}{h} \\psi_{m, \\text{in}, x} + \\frac{2|\\eta_m|}{h} \\psi_{m, \\text{in}, y} $$\n$$ \\psi^m = \\frac{Q^m + \\frac{2|\\mu_m|}{h} \\psi_{m, \\text{in}, x} + \\frac{2|\\eta_m|}{h} \\psi_{m, \\text{in}, y}}{\\Sigma_t + \\frac{2|\\mu_m|}{h} + \\frac{2|\\eta_m|}{h}} $$\nThe problem specifies vacuum boundary conditions on all four faces of the single cell. This means that for any direction $m$, the incoming angular flux on any boundary face is zero. Therefore, $\\psi_{m, \\text{in}, x} = 0$ and $\\psi_{m, \\text{in}, y} = 0$ for all $m$. The equation for $\\psi^m$ simplifies to:\n$$ \\psi^m = \\frac{Q^m}{\\Sigma_t + \\frac{2|\\mu_m|}{h} + \\frac{2|\\eta_m|}{h}} $$\nNow, we substitute the numerical values provided:\n- Cell side length: $h = 2$\n- Total cross section: $\\Sigma_t = 1$\n- Source per direction: $Q^m = q = 0.5$\n- Direction cosines: For the given $S_2$ level-symmetric set, $|\\mu_m| = |\\eta_m| = \\frac{1}{\\sqrt{2}}$ for all $m = 1, 2, 3, 4$.\n\nSubstituting these into the expression for $\\psi^m$:\n$$ \\psi^m = \\frac{0.5}{1 + \\frac{2(1/\\sqrt{2})}{2} + \\frac{2(1/\\sqrt{2})}{2}} = \\frac{0.5}{1 + \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}}} = \\frac{0.5}{1 + \\frac{2}{\\sqrt{2}}} = \\frac{0.5}{1 + \\sqrt{2}} $$\nSince the source and direction cosine magnitudes are the same for all $m=1, 2, 3, 4$, the cell-average angular flux $\\psi^m$ is the same for all four directions.\n\nThe final step is to compute the cell-centered scalar flux, $\\phi$, which is approximated by a sum over the discrete ordinates:\n$$ \\phi \\approx \\sum_{m=1}^{4} w_m \\psi^m $$\nThe quadrature weights are given as $w_m = \\frac{\\pi}{2}$ for all $m$. Since $\\psi^m$ is constant for all $m$, we can factor it out of the summation:\n$$ \\phi = \\psi^m \\sum_{m=1}^{4} w_m = \\left( \\frac{0.5}{1 + \\sqrt{2}} \\right) \\left( 4 \\times \\frac{\\pi}{2} \\right) = \\left( \\frac{0.5}{1 + \\sqrt{2}} \\right) (2\\pi) $$\nWriting $0.5$ as $\\frac{1}{2}$:\n$$ \\phi = \\left( \\frac{1/2}{1 + \\sqrt{2}} \\right) (2\\pi) = \\frac{1}{2(1 + \\sqrt{2})} (2\\pi) = \\frac{\\pi}{1 + \\sqrt{2}} $$\nTo simplify this expression, we rationalize the denominator:\n$$ \\phi = \\frac{\\pi}{1 + \\sqrt{2}} \\times \\frac{\\sqrt{2} - 1}{\\sqrt{2} - 1} = \\frac{\\pi(\\sqrt{2} - 1)}{(\\sqrt{2})^2 - 1^2} = \\frac{\\pi(\\sqrt{2} - 1)}{2 - 1} = \\pi(\\sqrt{2} - 1) $$\nNow, we compute the numerical value and round to four significant figures:\n$$ \\phi = \\pi(\\sqrt{2} - 1) \\approx (3.14159...)(1.41421... - 1) \\approx (3.14159...)(0.41421...) \\approx 1.3013698... $$\nRounding to four significant figures gives $1.301$.",
            "answer": "$$\n\\boxed{1.301}\n$$"
        },
        {
            "introduction": "While direct solution of the S₂ equations is possible for small problems, realistic applications rely on iterative methods. A crucial component of modern, efficient solvers is an \"acceleration\" scheme, which often involves solving an auxiliary diffusion-type equation. This hands-on coding problem asks you to build and solve the finite difference system for a 1D diffusion operator, numerically calculating its Green's function. This exercise builds the practical skills needed to implement a Diffusion Synthetic Acceleration (DSA) solver, a powerful tool for accelerating the convergence of transport calculations .",
            "id": "3228117",
            "problem": "Consider the one-dimensional, homogeneous Dirichlet boundary value problem (BVP) for the Green's function $G(x,s)$ associated with the differential operator $-\\frac{d^2}{dx^2}$ on the interval $[0,1]$:\n$$\n-\\,\\frac{\\partial^2}{\\partial x^2} G(x,s) \\;=\\; \\delta(x-s), \\quad G(0,s)=0,\\; G(1,s)=0,\n$$\nwhere $\\delta$ denotes the Dirac delta. Your task is to compute a fully discrete analogue using the Finite Difference Method (FDM).\n\nStarting from first principles, construct a uniform grid with $N$ subintervals on $[0,1]$:\n$$\nx_i \\;=\\; i\\,h,\\quad h \\;=\\; \\frac{1}{N},\\quad i=0,1,\\dots,N,\n$$\nand enforce the discrete homogeneous Dirichlet boundary conditions $G_0=G_N=0$, where $G_i$ approximates $G(x_i,s)$. On the interior nodes $i=1,\\dots,N-1$, discretize $-\\,\\frac{d^2}{dx^2}$ by the standard centered second difference, so that the discrete operator $L_h$ applied to the vector $G=(G_1,\\dots,G_{N-1})^\\top$ is given componentwise by\n$$\n(L_h G)_i \\;=\\; -\\,\\frac{G_{i-1}-2G_i+G_{i+1}}{h^2},\\quad i=1,\\dots,N-1,\n$$\nwith the understanding that $G_0=G_N=0$.\n\nDefine the discrete delta $\\delta_h$ so that it preserves unit mass in the Riemann sum sense:\n$$\n\\sum_{i=1}^{N-1} h\\,(\\delta_h)_i \\;=\\; 1.\n$$\nFor the special case when the source location $s$ coincides exactly with a grid point $x_k$ for some $k\\in\\{1,\\dots,N-1\\}$, take\n$$\n(\\delta_h)_i \\;=\\; \\begin{cases}\n\\frac{1}{h}, & i=k \\\\\n0, & i\\neq k\n\\end{cases}\n$$\nThe discrete Green's function values $(G_1,\\dots,G_{N-1})$ are then obtained by solving the linear system\n$$\nL_h G \\;=\\; \\delta_h.\n$$\n\nImplement a program that, for the following test suite, assembles and solves the tri-diagonal linear system induced by $L_h$ and the above $\\delta_h$, and reports selected entries of the discrete Green's function vector. All indices for $G_i$ below refer to interior indices $i\\in\\{1,\\dots,N-1\\}$.\n\nTest suite:\n- Case A: $N=8$, $k=3$, report $G_2$, $G_3$, $G_5$.\n- Case B: $N=8$, $k=1$, report $G_1$, $G_2$, $G_7$.\n- Case C: $N=16$, $k=8$, report $G_4$, $G_8$, $G_{12}$.\n\nRequirements:\n- Construct $L_h$ using the centered second-difference stencil with homogeneous Dirichlet boundary conditions as specified.\n- Construct $\\delta_h$ exactly as specified so that the unit-mass property holds, i.e., $\\sum_{i=1}^{N-1} h\\,(\\delta_h)_i=1$.\n- Solve the resulting linear system exactly for each case using numerically stable linear algebra.\n- No physical units are involved in this problem.\n- Your program should produce a single line of output containing the results, in order, as a comma-separated list enclosed in square brackets with no spaces:\n$$\n[\\,G_2^{(\\text{A})},G_3^{(\\text{A})},G_5^{(\\text{A})},G_1^{(\\text{B})},G_2^{(\\text{B})},G_7^{(\\text{B})},G_4^{(\\text{C})},G_8^{(\\text{C})},G_{12}^{(\\text{C})}\\,].\n$$\nEach entry must be printed as a decimal number (floating-point). The answer types are floats, aggregated into a single list.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded, well-posed, and objective. It presents a standard, self-contained problem in numerical analysis for solving a boundary value problem using the Finite Difference Method. All necessary data and definitions are provided, are free of contradictions, and allow for the computation of a unique, meaningful solution.\n\nThe task is to find a numerical approximation to the Green's function $G(x,s)$ for the operator $L = -\\frac{d^2}{dx^2}$ on the interval $[0,1]$ with homogeneous Dirichlet boundary conditions. The governing equation is\n$$\n-\\frac{\\partial^2}{\\partial x^2} G(x,s) = \\delta(x-s), \\quad G(0,s)=0, G(1,s)=0.\n$$\nWe employ the Finite Difference Method on a uniform grid $x_i = ih$ for $i=0, 1, \\dots, N$, with step size $h = 1/N$. The discrete solution vector, denoted $G = (G_1, G_2, \\dots, G_{N-1})^\\top$, approximates the Green's function at the interior grid points, $G_i \\approx G(x_i, s)$. The boundary conditions are enforced as $G_0 = 0$ and $G_N = 0$.\n\nThe differential operator is approximated by the centered second-difference stencil. The discrete operator $L_h$ acts on the vector $G$ such that its $i$-th component is\n$$\n(L_h G)_i = -\\frac{G_{i-1} - 2G_i + G_{i+1}}{h^2}, \\quad \\text{for } i=1, \\dots, N-1.\n$$\nThe source term, a Dirac delta function $\\delta(x-s)$, is discretized as a vector $\\delta_h$ for the case where the source location $s$ coincides with a grid point $x_k=kh$ for some $k \\in \\{1, \\dots, N-1\\}$. The discrete delta is defined component-wise as\n$$\n(\\delta_h)_i = \\begin{cases} \\frac{1}{h} & i=k \\\\ 0 & i \\neq k \\end{cases}.\n$$\nThis definition correctly preserves the unit mass property, $\\sum_{i=1}^{N-1} h (\\delta_h)_i = h \\cdot (\\frac{1}{h}) = 1$.\n\nThe problem thus reduces to solving the $(N-1) \\times (N-1)$ linear system of equations:\n$$\nL_h G = \\delta_h.\n$$\nIn matrix form, this is $A G = b$, where the matrix $A$ represents the operator $L_h$ and the vector $b$ represents the discrete source $\\delta_h$. The entries of the matrix $A$ are derived from the stencil for $L_h$:\n$$\nA = \\frac{1}{h^2}\n\\begin{pmatrix}\n2 & -1 & 0 & \\cdots & 0 \\\\\n-1 & 2 & -1 & \\ddots & \\vdots \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n\\vdots & \\ddots & -1 & 2 & -1 \\\\\n0 & \\cdots & 0 & -1 & 2\n\\end{pmatrix}.\n$$\nThe vector $b$ has a single non-zero entry at index $k-1$ (using $0$-based indexing for the vector of interior points):\n$$\nb = \\left(0, \\dots, 0, \\frac{1}{h}, 0, \\dots, 0\\right)^\\top,\n$$\nwhere the non-zero element is at the $k$-th position.\n\nFor improved numerical stability and computational convenience, we can multiply the entire system by $h^2$:\n$$\n(h^2 A) G = h^2 b.\n$$\nLet $A' = h^2 A$ and $b' = h^2 b$. The modified matrix $A'$ and vector $b'$ are:\n$$\nA' = \n\\begin{pmatrix}\n2 & -1 & 0 & \\cdots & 0 \\\\\n-1 & 2 & -1 & \\ddots & \\vdots \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n\\vdots & \\ddots & -1 & 2 & -1 \\\\\n0 & \\cdots & 0 & -1 & 2\n\\end{pmatrix},\n\\quad\nb' = \n\\left(0, \\dots, 0, h, 0, \\dots, 0\\right)^\\top.\n$$\nThis system $A'G = b'$ is solved for the unknown vector $G$. The matrix $A'$ is symmetric, positive definite, and tridiagonal, guaranteeing a unique and stable solution that can be found efficiently.\n\nThe specified test cases are solved by following this procedure:\n1.  For each case (A, B, C), the parameters $N$ and $k$ are used to define the problem size $N-1$ and the step size $h=1/N$.\n2.  The $(N-1) \\times (N-1)$ tridiagonal matrix $A'$ is assembled.\n3.  The right-hand side vector $b'$ of size $N-1$ is constructed with the value $h$ at index $k-1$ and zeros elsewhere.\n4.  The linear system $A'G=b'$ is solved to obtain the discrete Green's function values $G = (G_1, \\dots, G_{N-1})^\\top$.\n5.  The specified elements $G_i$ are extracted from the solution vector $G$. Note that the problem uses $1$-based indexing for grid points $i \\in \\{1, \\dots, N-1\\}$, which corresponds to $0$-based indices $i-1$ in the solution vector.\n\n- **Case A**: $N=8$, $k=3$. We solve a $7 \\times 7$ system. We report elements $G_2, G_3, G_5$, corresponding to indices $1, 2, 4$ of the solution vector.\n- **Case B**: $N=8$, $k=1$. We solve a $7 \\times 7$ system. We report elements $G_1, G_2, G_7$, corresponding to indices $0, 1, 6$ of the solution vector.\n- **Case C**: $N=16$, $k=8$. We solve a $15 \\times 15$ system. We report elements $G_4, G_8, G_{12}$, corresponding to indices $3, 7, 11$ of the solution vector.\n\nThe final program implements this exact logic to compute the required values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_discrete_greens_function(N, k):\n    \"\"\"\n    Assembles and solves the finite difference system for the discrete Green's function.\n\n    Args:\n        N (int): The number of subintervals on [0,1].\n        k (int): The 1-based index of the grid point where the source is located.\n\n    Returns:\n        numpy.ndarray: The solution vector G = (G_1, ..., G_{N-1}).\n    \"\"\"\n    # The number of interior grid points, which is the dimension of the linear system.\n    dim = N - 1\n    \n    # Grid spacing\n    h = 1.0 / N\n\n    # Construct the matrix A' = h^2 * L_h = tridiag(-1, 2, -1).\n    # This matrix is of size (N-1) x (N-1).\n    # Main diagonal with 2s.\n    main_diag = 2 * np.ones(dim)\n    # Off-diagonals with -1s.\n    off_diag = -1 * np.ones(dim - 1)\n    \n    A_prime = np.diag(main_diag, 0) + np.diag(off_diag, -1) + np.diag(off_diag, 1)\n\n    # Construct the right-hand side vector b' = h^2 * delta_h.\n    # It's a vector of zeros except for the entry at index (k-1), which is h.\n    # The index is (k-1) because k is 1-based and array indices are 0-based.\n    b_prime = np.zeros(dim)\n    b_prime[k - 1] = h\n\n    # Solve the linear system A' * G = b' for the vector G.\n    G = np.linalg.solve(A_prime, b_prime)\n    \n    return G\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple is (N, k, list_of_indices_to_report).\n    # Indices are 1-based as per the problem.\n    test_cases = [\n        (8, 3, [2, 3, 5]),   # Case A\n        (8, 1, [1, 2, 7]),   # Case B\n        (16, 8, [4, 8, 12]), # Case C\n    ]\n\n    results = []\n    for case in test_cases:\n        N, k, indices_to_report = case\n        \n        # Calculate the full solution vector for the discrete Green's function.\n        G_solution = solve_discrete_greens_function(N, k)\n        \n        # Extract the required values.\n        # Convert 1-based problem indices to 0-based array indices.\n        for idx in indices_to_report:\n            results.append(G_solution[idx - 1])\n\n    # Final print statement in the exact required format.\n    # The format is a comma-separated list of float values enclosed in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "With the fundamentals of discretization and solver construction in hand, we can now analyze *why* acceleration is so critical. The standard Source Iteration (SI) method converges very slowly for problems with high scattering. This advanced problem delves into the theory of iterative acceleration by using Fourier analysis to study the eigenvalues of the iteration operator. You will see precisely how a Diffusion Synthetic Acceleration (DSA) preconditioner, which is based on the diffusion equation you learned to solve in the previous exercise, systematically eliminates the slowest-to-converge error modes, justifying its use in modern Sₙ codes .",
            "id": "4225366",
            "problem": "Consider the steady, one-speed linear Boltzmann transport equation in one spatial dimension, written in a dimensionless form by scaling the spatial coordinate $x$ with the total macroscopic cross section $\\Sigma_{t}$ so that $x \\leftarrow \\Sigma_{t} x$, for a homogeneous slab with periodic boundary conditions. Let the angular flux be $\\psi(x,\\mu)$, the scalar flux be $\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu) \\,\\mathrm{d}\\mu$, and the scattering ratio be $c = \\Sigma_{s}/\\Sigma_{t}$ with $0 < c < 1$. In dimensionless form, the transport equation is\n$$\n\\mu \\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\psi(x,\\mu) = \\frac{c}{2}\\,\\phi(x) + \\frac{q(x)}{2},\n$$\nwhere $q(x)$ is a given fixed source.\n\nDiscretize the angular variable using the discrete ordinates method $S_{n}$ with $n=2$ (two directions), specifically the Gauss–Legendre abscissae $\\mu_{1} = \\frac{1}{\\sqrt{3}}$ and $\\mu_{2} = -\\frac{1}{\\sqrt{3}}$, with weights $w_{1} = w_{2} = 1$. Consider Source Iteration (SI), in which at iteration $k+1$ the scattering source is formed from the scalar flux $\\phi^{(k)}(x)$ and the transport sweeps are performed to obtain $\\psi^{(k+1)}(x,\\mu)$ and hence $\\phi^{(k+1)}(x)$. Introduce the error $e^{(k)}(x) = \\phi^{(k)}(x) - \\phi^{*}(x)$ relative to the exact scalar flux $\\phi^{*}(x)$, and assume $q(x) \\equiv 0$ so that the homogeneous error-propagation analysis applies.\n\nDefine the SI error-propagation operator $\\mathcal{K}$ on the scalar flux error by $e^{(k+1)} = \\mathcal{K}\\,e^{(k)}$. Using the dimensionless diffusion-limit asymptotics for isotropic scattering, construct a Finite Difference (FD) Diffusion Synthetic Acceleration (DSA) preconditioner on the same uniform periodic mesh by discretizing the synthetic diffusion equation\n$$\n-\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(D\\,\\frac{\\mathrm{d}\\,\\delta\\phi(x)}{\\mathrm{d}x}\\right) + (1-c)\\,\\delta\\phi(x) = r(x),\n$$\nwhere $D = \\frac{1}{3}$ is the dimensionless diffusion coefficient and $r(x)$ is a residual. Denote the resulting discrete diffusion operator by $\\mathcal{M}$, acting on scalar flux corrections, so that $\\mathcal{M}\\,\\delta\\phi = r$.\n\nNow consider Krylov acceleration via the Generalized Minimal Residual method (GMRES) with left preconditioning by $\\mathcal{M}^{-1}$ for the linear system $(\\mathcal{I}-\\mathcal{K})\\,\\phi = b$, where $\\mathcal{I}$ is the identity operator and $b$ is the fixed source contribution. Focus on the spatially constant Fourier mode (zero wavenumber) of the error, i.e., $e^{(k)}(x) = \\mathrm{const}$. Starting only from the definitions and equations above, determine the eigenvalue of the preconditioned operator $\\mathcal{M}^{-1}(\\mathcal{I}-\\mathcal{K})$ acting on this spatially constant mode.\n\nExpress the final answer as a real number with no units. No rounding is required.",
            "solution": "We begin with the dimensionless one-speed transport equation in one dimension,\n$$\n\\mu \\,\\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\psi(x,\\mu) = \\frac{c}{2}\\,\\phi(x) + \\frac{q(x)}{2},\n$$\nwith scattering ratio $c \\in (0,1)$, and we discretize the angular integral using the $S_{2}$ discrete ordinates method with abscissae $\\mu_{1} = \\frac{1}{\\sqrt{3}}$ and $\\mu_{2} = -\\frac{1}{\\sqrt{3}}$ and weights $w_{1} = w_{2} = 1$. The scalar flux is approximated as\n$$\n\\phi(x) = \\sum_{m=1}^{2} w_{m}\\,\\psi(x,\\mu_{m}) = \\psi(x,\\mu_{1}) + \\psi(x,\\mu_{2}).\n$$\n\nIn Source Iteration (SI), one forms the scattering source from the current iterate $\\phi^{(k)}(x)$ and solves\n$$\n\\mu_{m}\\,\\frac{\\partial \\psi^{(k+1)}(x,\\mu_{m})}{\\partial x} + \\psi^{(k+1)}(x,\\mu_{m}) = \\frac{c}{2}\\,\\phi^{(k)}(x) + \\frac{q(x)}{2}, \\quad m \\in \\{1,2\\},\n$$\nto obtain $\\psi^{(k+1)}(x,\\mu_{m})$ and hence $\\phi^{(k+1)}(x)$. For error-propagation analysis, we set $q(x) \\equiv 0$ and examine the evolution of the error $e^{(k)}(x) = \\phi^{(k)}(x) - \\phi^{*}(x)$, where $\\phi^{*}(x)$ is the exact scalar flux. The SI error propagation can be expressed as\n$$\ne^{(k+1)}(x) = \\mathcal{K}\\,e^{(k)}(x),\n$$\nfor some operator $\\mathcal{K}$ induced by the transport sweeps and scattering process.\n\nWe focus on the spatially constant Fourier mode (zero wavenumber), i.e., errors of the form $e^{(k)}(x) \\equiv E^{(k)}$ with $E^{(k)}$ independent of $x$. For this mode, all spatial derivatives vanish, and the transport equation for the error simplifies to algebraic relations. Specifically, for $q(x)\\equiv 0$ and $\\frac{\\partial}{\\partial x}=0$, the transport equations for the angular flux errors at iteration $k+1$ read\n$$\n\\psi^{(k+1)}(x,\\mu_{m}) = \\frac{c}{2}\\,\\phi^{(k)}(x), \\quad m \\in \\{1,2\\}.\n$$\nSince the right-hand side is independent of $x$, the left-hand sides are also independent of $x$, and their values are equal for both $\\mu_{1}$ and $\\mu_{2}$. Summing over ordinates to form the scalar flux gives\n$$\n\\phi^{(k+1)}(x) = \\psi^{(k+1)}(x,\\mu_{1}) + \\psi^{(k+1)}(x,\\mu_{2}) = \\frac{c}{2}\\,\\phi^{(k)}(x) + \\frac{c}{2}\\,\\phi^{(k)}(x) = c\\,\\phi^{(k)}(x).\n$$\nTherefore, for the spatially constant mode, the SI error-propagation operator $\\mathcal{K}$ acts as multiplication by $c$:\n$$\ne^{(k+1)}(x) = c\\,e^{(k)}(x).\n$$\nThe corresponding operator $(\\mathcal{I} - \\mathcal{K})$ acting on this mode has eigenvalue\n$$\n\\lambda_{\\mathcal{I}-\\mathcal{K}}^{(0)} = 1 - c.\n$$\n\nWe now construct the Diffusion Synthetic Acceleration (DSA) preconditioner using the dimensionless diffusion-limit equation appropriate for isotropic scattering in one dimension. In the diffusion limit, the synthetic equation for a scalar flux correction $\\delta\\phi(x)$ is\n$$\n-\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(D\\,\\frac{\\mathrm{d}\\,\\delta\\phi(x)}{\\mathrm{d}x}\\right) + (1-c)\\,\\delta\\phi(x) = r(x),\n$$\nwhere $D = \\frac{1}{3}$ is the dimensionless diffusion coefficient. Discretizing this equation on the same uniform periodic mesh via Finite Difference (FD) yields a linear operator $\\mathcal{M}$ such that\n$$\n\\mathcal{M}\\,\\delta\\phi = r.\n$$\nOn the spatially constant Fourier mode, $\\delta\\phi(x) = \\Delta$ is constant, so $\\frac{\\mathrm{d}\\,\\delta\\phi}{\\mathrm{d}x} = 0$ and the diffusion term vanishes. Consequently, the operator $\\mathcal{M}$ acting on the constant mode reduces to simple multiplication by $(1 - c)$:\n$$\n\\mathcal{M}\\,\\Delta = (1 - c)\\,\\Delta,\n$$\nso the eigenvalue of $\\mathcal{M}$ for the constant mode is\n$$\n\\lambda_{\\mathcal{M}}^{(0)} = 1 - c.\n$$\n\nWe are asked to consider Krylov acceleration using the Generalized Minimal Residual method (GMRES) with left preconditioning by $\\mathcal{M}^{-1}$ for the linear system\n$$\n(\\mathcal{I}-\\mathcal{K})\\,\\phi = b,\n$$\nand to determine the eigenvalue of the preconditioned operator $\\mathcal{M}^{-1}(\\mathcal{I}-\\mathcal{K})$ acting on the spatially constant mode. Eigenvalues of a product of commuting operators on a mode are the ratios of their eigenvalues on that mode. For the constant mode,\n$$\n\\lambda_{\\mathcal{M}^{-1}(\\mathcal{I}-\\mathcal{K})}^{(0)} = \\frac{\\lambda_{\\mathcal{I}-\\mathcal{K}}^{(0)}}{\\lambda_{\\mathcal{M}}^{(0)}} = \\frac{1 - c}{1 - c} = 1.\n$$\n\nThus, the eigenvalue of the left-preconditioned operator $\\mathcal{M}^{-1}(\\mathcal{I}-\\mathcal{K})$ acting on the spatially constant Fourier mode is exactly $1$.",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}