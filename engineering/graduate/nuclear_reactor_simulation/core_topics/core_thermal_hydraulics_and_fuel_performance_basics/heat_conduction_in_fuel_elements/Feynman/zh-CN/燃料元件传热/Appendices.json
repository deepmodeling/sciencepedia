{
    "hands_on_practices": [
        {
            "introduction": "在反应堆的运行和安全分析中，根据测量数据反推内部物理量是一项基本技能。这个练习将锻炼你应用稳态热传导理论反演实验数据的能力，这是模型验证和性能分析中的常见任务。通过对比简化模型（恒定热导率 $k$）与更真实模型（热导率 $k(T)$ 依赖于温度）的计算结果，你将深入理解材料属性假设对模拟精度的影响。",
            "id": "4229728",
            "problem": "一个半径为 $R = 4.1 \\,\\mathrm{mm}$ 的固态二氧化铀 ($\\text{UO}_2$) 圆柱形燃料芯块，在具有方位角对称性且轴向梯度可忽略不计的稳态条件下运行。由于裂变，该芯块内部产生空间均匀的体积产热率 $\\;q'''$。仪器测量得到中心线温度 $T_c = 1673 \\,\\mathrm{K}$，以及在芯块半径 $r = R$ 处的外表面温度 $T_s = 1073 \\,\\mathrm{K}$。为了反向计算，假设整个芯块的热导率是恒定的，其值为 $k_* = 4.0 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}}$。\n\n使用圆柱坐标系下的稳态能量守恒和傅里叶 (Fourier) 热传导定律，并施加 $r=0$ 处的对称性条件和 $r=R$ 处的测量边界条件，确定在恒定 $k_*$ 假设下与测量温度一致的有效体积产热率 $\\;q'''$。最终数值答案以 $\\mathrm{W\\, m^{-3}}$ 为单位表示，并四舍五入至四位有效数字。\n\n然后，如果实际热导率依赖于温度，其关系为 $k(T) = A/T$ (其中 $A = 4.0 \\times 10^3 \\,\\mathrm{W\\, m^{-1}}$)，请讨论使用恒定 $k_*$ 进行反向计算所引入的偏差。从相同的基本原理出发，解析地证明与此 $k(T)$ 相符的 $\\;q'''$ 值如何依赖于 $T_c$ 和 $T_s$，并通过推导一个比率来表明给定数据的偏差方向，将其与恒定 $k_*$ 推断的结果进行比较。这一部分无需提供额外的、经过四舍五入的数值答案；重点应放在解析关系及其定性解释上。",
            "solution": "首先验证问题的科学合理性、良定性和客观性。已知条件为：一个半径为 $R = 4.1 \\,\\mathrm{mm}$ 的固态圆柱形燃料芯块；稳态、方位角对称的热传递，轴向梯度可忽略，这意味着温度 $T$ 仅为半径 $r$ 的函数，即 $T(r)$；均匀的体积产热率 $q'''$；测得的中心线温度 $T(0) = T_c = 1673 \\,\\mathrm{K}$；以及测得的表面温度 $T(R) = T_s = 1073 \\,\\mathrm{K}$。在问题的第一部分，假设热导率是恒定的，$k_* = 4.0 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}}$。在第二部分，给定热导率是温度依赖的，$k(T) = A/T$，其中 $A = 4.0 \\times 10^3 \\,\\mathrm{W\\, m^{-1}}$。该问题是一个标准的热传导练习，运用了既定的物理定律，并提供了自洽且物理上合理的数据。因此，该问题被认定是有效的。\n\n我们按要求分两部分进行解答。\n\n第一部分：计算恒定热导率下的 $q'''$\n\n对于具有体积产热率 $q'''$ 和恒定热导率 $k_*$ 的圆柱体内的稳态热传导，其控制方程是热扩散方程，在给定的对称条件下简化为：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) + \\frac{q'''}{k_*} = 0 $$\n这是关于温度分布 $T(r)$ 的一个二阶常微分方程。我们可以重新整理并对半径 $r$ 进行积分：\n$$ \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) = -\\frac{q''' r}{k_*} $$\n第一次积分得到：\n$$ r \\frac{dT}{dr} = -\\frac{q''' r^2}{2k_*} + C_1 $$\n其中 $C_1$ 是一个积分常数。中心线 ($r=0$) 处的物理边界条件是对称性，这意味着温度梯度必须为零，即 $\\frac{dT}{dr}|_{r=0} = 0$。将此条件应用于方程可知，为避免温度梯度出现奇点，$C_1$ 必须为零。因此，温度梯度的方程变为：\n$$ \\frac{dT}{dr} = -\\frac{q''' r}{2k_*} $$\n对 $r$ 进行第二次积分，得到温度分布：\n$$ T(r) = -\\frac{q''' r^2}{4k_*} + C_2 $$\n常数 $C_2$ 可通过测量的中心线温度 $T(0) = T_c$ 来确定。在 $r=0$ 处，方程给出 $T(0) = C_2$，所以 $C_2 = T_c$。因此，温度分布为：\n$$ T(r) = T_c - \\frac{q''' r^2}{4k_*} $$\n这种抛物线形温度分布是具有均匀产热的一维热传导的特征。我们现在使用第二个测量温度，即在芯块外表面的温度 $T(R) = T_s$，来确定未知的体积产热率 $q'''$：\n$$ T_s = T_c - \\frac{q''' R^2}{4k_*} $$\n求解 $q'''$，我们得到在恒定热导率假设下的产热率解析表达式，我们将其记为 $q'''_{const}$：\n$$ q'''_{const} = \\frac{4k_*(T_c - T_s)}{R^2} $$\n现在我们将给定的数值代入此表达式。半径必须转换为国际单位制单位：$R = 4.1 \\,\\mathrm{mm} = 4.1 \\times 10^{-3} \\,\\mathrm{m}$。\n$$ q'''_{const} = \\frac{4 (4.0 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}})(1673 \\,\\mathrm{K} - 1073 \\,\\mathrm{K})}{(4.1 \\times 10^{-3} \\,\\mathrm{m})^2} $$\n$$ q'''_{const} = \\frac{(16.0)(600)}{1.681 \\times 10^{-5}} \\,\\mathrm{W\\, m^{-3}} $$\n$$ q'''_{const} = \\frac{9600}{1.681 \\times 10^{-5}} \\,\\mathrm{W\\, m^{-3}} \\approx 5.710886 \\times 10^8 \\,\\mathrm{W\\, m^{-3}} $$\n按要求四舍五入至四位有效数字，有效体积产热率为 $5.711 \\times 10^8 \\,\\mathrm{W\\, m^{-3}}$。\n\n第二部分：温度依赖性热导率的偏差分析\n\n在这一部分，热导率 $k(T)$ 是温度的函数。稳态热扩散方程必须将热导率项写在导数内部：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r k(T) \\frac{dT}{dr} \\right) + q''' = 0 $$\n对 $r$ 积分一次得到：\n$$ r k(T) \\frac{dT}{dr} = -\\frac{q''' r^2}{2} + C_1 $$\n在 $r=0$ 处的对称性条件要求热通量 $-k(T(0))\\frac{dT}{dr}|_{r=0}$ 为零。由于 $k(T_c)$ 是有限且非零的，这再次要求 $\\frac{dT}{dr}|_{r=0}=0$，从而使得积分常数 $C_1=0$。方程变为：\n$$ k(T) \\frac{dT}{dr} = -\\frac{q''' r}{2} $$\n这是一个可分离的微分方程。我们重新整理并从中心线 ($r=0$, $T=T_c$) 积分到芯块表面 ($r=R$, $T=T_s$)：\n$$ \\int_{T_c}^{T_s} k(T) dT = \\int_0^R -\\frac{q''' r}{2} dr $$\n$$ \\int_{T_c}^{T_s} k(T) dT = -\\frac{q''' R^2}{4} $$\n求解 $q'''$，我们现在将其记为 $q'''_{var}$，以区别于恒定热导率的情况：\n$$ q'''_{var} = \\frac{4}{R^2} \\int_{T_s}^{T_c} k(T) dT $$\n代入给定的形式 $k(T) = A/T$：\n$$ q'''_{var} = \\frac{4}{R^2} \\int_{T_s}^{T_c} \\frac{A}{T} dT = \\frac{4A}{R^2} [\\ln(T)]_{T_s}^{T_c} $$\n$$ q'''_{var} = \\frac{4A}{R^2} (\\ln(T_c) - \\ln(T_s)) = \\frac{4A}{R^2} \\ln\\left(\\frac{T_c}{T_s}\\right) $$\n这是与温度依赖性热导率 $k(T)$ 相一致的产热率的解析表达式。\n\n为了评估恒定 $k_*$ 假设的偏差，我们推导更真实的 $q'''_{var}$ 与简化的 $q'''_{const}$ 之间的比率：\n$$ \\frac{q'''_{var}}{q'''_{const}} = \\frac{\\frac{4A}{R^2} \\ln\\left(\\frac{T_c}{T_s}\\right)}{\\frac{4k_*(T_c - T_s)}{R^2}} = \\frac{A \\ln(T_c/T_s)}{k_*(T_c - T_s)} $$\n该比率决定了偏差的方向和大小。通过将假设的恒定热导率 $k_*$ 与在温度范围内的真实有效平均热导率 $\\bar{k}$ 进行比较，可以理解这种偏差。总传导热量与热导率积分 $\\int k(T) dT$ 成正比。我们有：\n$$ q'''_{var} \\propto \\int_{T_s}^{T_c} k(T) dT \\quad \\text{and} \\quad q'''_{const} \\propto k_*(T_c-T_s) = \\int_{T_s}^{T_c} k_* dT $$\n该比率简化为：\n$$ \\frac{q'''_{var}}{q'''_{const}} = \\frac{\\frac{1}{T_c-T_s}\\int_{T_s}^{T_c} k(T) dT}{k_*} = \\frac{\\bar{k}}{k_*} $$\n其中 $\\bar{k} = \\frac{1}{T_c-T_s}\\int_{T_s}^{T_c} k(T) dT$ 是在区间 $[T_s, T_c]$ 内的平均热导率。\n当 $k(T) = A/T$ 时，热导率是温度的单调递减函数。实际热导率在最冷点 ($r=R$) 最高，在最热点 ($r=0$) 最低。让我们使用 $A = 4.0 \\times 10^3 \\,\\mathrm{W\\, m^{-1}}$ 来计算边界处的热导率：\n$$ k(T_s) = k(1073\\,\\mathrm{K}) = \\frac{4.0 \\times 10^3}{1073} \\approx 3.73 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}} $$\n$$ k(T_c) = k(1673\\,\\mathrm{K}) = \\frac{4.0 \\times 10^3}{1673} \\approx 2.39 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}} $$\n平均热导率 $\\bar{k}$ 必须介于这两个值之间：$2.39 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}}  \\bar{k}  3.73 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}}$。\n用于反向计算的恒定热导率为 $k_* = 4.0 \\,\\mathrm{W\\, m^{-1}\\, K^{-1}}$。该值高于燃料芯块内任何一点的实际热导率，因为对于所有 $T \\in [T_s, T_c]$，$k_* > k(T_s) > k(T)$。因此，假设的恒定热导率 $k_*$ 大于真实的平均热导率 $\\bar{k}$。\n由于 $k_* > \\bar{k}$，比率 $\\frac{\\bar{k}}{k_*}$ 小于1。这意味着：\n$$ \\frac{q'''_{var}}{q'''_{const}}  1 \\implies q'''_{const} > q'''_{var} $$\n因此，使用一个高于实际平均热导率的恒定热导率 $k_*$ 进行反向计算，会导致对真实体积产热率的 **高估**。该模型为了弥补所假设的、高于实际的导热能力，会推断出一个更大的热源 $q'''$，以解释所观察到的巨大温差 ($T_c - T_s$)。",
            "answer": "$$\\boxed{5.711 \\times 10^{8}}$$"
        },
        {
            "introduction": "在复杂的多物理场模拟中，识别并忽略次要的物理过程对于提高计算效率至关重要。本练习将指导你进行时间尺度分析，以判断在快速功率突增期间，燃料内的轴向热传导相对于冷却剂的平流输运是否可以忽略。这种分析方法是许多简化反应堆堆芯模型（如忽略燃料轴向导热的二维$r-z$模型）的关键理论依据。",
            "id": "4229762",
            "problem": "轻水反应堆 (LWR) 中的一根燃料棒经历一次快速的功率爬升。为了判断在此爬升过程中燃料内部的轴向温度瞬变是否可以忽略，需要比较二氧化铀燃料中轴向热传导的特征时间尺度与冷却剂通过受热堆芯长度的平流主导的整体热响应的特征时间尺度。将爬升条件下的物性视为常数，并使用物理上合理的数据。\n\n从燃料的能量守恒和傅里叶热传导定律出发，使用沿轴向坐标 $z$ 的一维热方程来模拟燃料中的轴向热传输：\n$$\n\\rho_{f} c_{p,f} \\frac{\\partial T_{f}}{\\partial t} = k_{f} \\frac{\\partial^{2} T_{f}}{\\partial z^{2}} + \\dot{q}'''(z,t),\n$$\n其中，$T_{f}$ 是燃料温度，$\\rho_{f}$ 是燃料密度，$c_{p,f}$ 是燃料比热容，$k_{f}$ 是燃料热导率，$\\dot{q}'''$ 是体积产热率。通过引入特征轴向长度尺度 $L_{z}$ 和温度尺度 $\\Delta T$，进行时间尺度（数量级）分析，以获得燃料中的轴向传导弛豫时间。对于冷却剂，从受热段内流动流体的控制体的能量守恒出发，并使用平流主导的近似方法，以获得冷却剂通过受热堆芯长度的整体热响应时间。\n\n使用以下数据，这些数据代表了压水堆燃料在爬升工况下的典型值：\n- 燃料（二氧化铀）热导率: $k_{f} = 2.5\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$。\n- 燃料密度: $\\rho_{f} = 1.05 \\times 10^{4}\\ \\mathrm{kg\\,m^{-3}}$。\n- 燃料比热容: $c_{p,f} = 3.00 \\times 10^{2}\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 功率形状发生显著变化的轴向特征长度: $L_{z} = 0.30\\ \\mathrm{m}$。\n- 受热堆芯长度: $L_{\\text{core}} = 3.60\\ \\mathrm{m}$。\n- 通道内冷却剂平均整体速度: $u_{c} = 4.50\\ \\mathrm{m\\,s^{-1}}$。\n\n假设轴向热传导仅发生在燃料基体内部，忽略包壳和芯块界面上的轴向传导。同时假设冷却剂的热响应由轴向平流主导，忽略流体中的轴向热扩散。\n\n计算轴向燃料传导时间尺度与冷却剂热响应时间尺度的无量纲比值 $R$。根据 $R$ 的量级，可以判断在快速功率爬升过程中轴向燃料瞬变是否可以忽略，但本题仅需报告该比值。将您的答案四舍五入到三位有效数字，并以无量纲数的形式表示。",
            "solution": "该问题要求计算核燃料棒中轴向热传导的特征时间与冷却剂平流通过反应堆堆芯的特征时间之比。该比值是在瞬变过程中评估燃料内部轴向热传输重要性的一个关键无量纲参数。\n\n首先，我们确定燃料中轴向热传导的特征时间尺度，我们将其表示为 $\\tau_{\\text{cond}}$。问题提供了沿轴向坐标 $z$ 的燃料温度 $T_{f}(z,t)$ 的一维热方程：\n$$\n\\rho_{f} c_{p,f} \\frac{\\partial T_{f}}{\\partial t} = k_{f} \\frac{\\partial^{2} T_{f}}{\\partial z^{2}} + \\dot{q}'''(z,t)\n$$\n其中，$\\rho_{f}$ 是燃料密度，$c_{p,f}$ 是燃料比热容，$k_{f}$ 是燃料热导率，$\\dot{q}'''$ 是体积产热率。\n\n为了找到传导弛豫的特征时间，我们对控制热扩散的各项进行数量级分析。我们关心的是热量通过传导在特征长度上抹平温度变化所需的时间。该过程由瞬态项（能量储存）和传导项（能量扩散）之间的平衡来描述。源项 $\\dot{q}'''$ 建立了温度分布，但并不决定其通过传导弛豫的速率。\n\n让我们为变量引入特征尺度：\n-   时间: $t \\sim \\tau_{\\text{cond}}$\n-   轴向长度: $z \\sim L_{z}$\n-   温度: $T_{f} \\sim \\Delta T$ (一个特征温差)\n\n热方程中的各项可以用其数量级来近似：\n-   瞬态项: $\\rho_{f} c_{p,f} \\frac{\\partial T_{f}}{\\partial t} \\sim \\rho_{f} c_{p,f} \\frac{\\Delta T}{\\tau_{\\text{cond}}}$\n-   传导项: $k_{f} \\frac{\\partial^{2} T_{f}}{\\partial z^{2}} \\sim k_{f} \\frac{\\Delta T}{L_{z}^{2}}$\n\n传导弛豫时间 $\\tau_{\\text{cond}}$ 是这两个项处于相同数量级的时间尺度。令它们相等，得到：\n$$\n\\rho_{f} c_{p,f} \\frac{\\Delta T}{\\tau_{\\text{cond}}} \\sim k_{f} \\frac{\\Delta T}{L_{z}^{2}}\n$$\n求解 $\\tau_{\\text{cond}}$，得到轴向传导时间尺度的表达式：\n$$\n\\tau_{\\text{cond}} = \\frac{\\rho_{f} c_{p,f} L_{z}^{2}}{k_{f}}\n$$\n这个表达式是扩散过程的特征，通常用热扩散率 $\\alpha_{f} = k_{f} / (\\rho_{f} c_{p,f})$ 来表示，因此 $\\tau_{\\text{cond}} = L_{z}^{2} / \\alpha_{f}$。\n\n接下来，我们确定冷却剂整体热响应的特征时间尺度 $\\tau_{\\text{adv}}$。问题指出该响应由平流主导。平流是通过流体整体运动来输运物质或物理量（在此情况下是热能）的过程。特征时间是流体微团行进系统相关长度所需的时间。对于流经堆芯的冷却剂的整体热响应，相关长度是受热堆芯长度 $L_{\\text{core}}$，特征速度是冷却剂的平均整体速度 $u_{c}$。\n因此，平流时间尺度由简单的运动学关系给出：\n$$\n\\tau_{\\text{adv}} = \\frac{L_{\\text{core}}}{u_{c}}\n$$\n\n最后，我们计算所要求的无量纲比值 $R$，即轴向燃料传导时间尺度与冷却剂热响应时间尺度之比：\n$$\nR = \\frac{\\tau_{\\text{cond}}}{\\tau_{\\text{adv}}}\n$$\n代入 $\\tau_{\\text{cond}}$ 和 $\\tau_{\\text{adv}}$ 的表达式：\n$$\nR = \\frac{\\left(\\frac{\\rho_{f} c_{p,f} L_{z}^{2}}{k_{f}}\\right)}{\\left(\\frac{L_{\\text{core}}}{u_{c}}\\right)} = \\frac{\\rho_{f} c_{p,f} u_{c} L_{z}^{2}}{k_{f} L_{\\text{core}}}\n$$\n\n现在，我们将给定的数值代入 $R$ 的表达式中：\n-   $\\rho_{f} = 1.05 \\times 10^{4}\\ \\mathrm{kg\\,m^{-3}}$\n-   $c_{p,f} = 3.00 \\times 10^{2}\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n-   $u_{c} = 4.50\\ \\mathrm{m\\,s^{-1}}$\n-   $L_{z} = 0.30\\ \\mathrm{m}$\n-   $k_{f} = 2.5\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n-   $L_{\\text{core}} = 3.60\\ \\mathrm{m}$\n\n$$\nR = \\frac{(1.05 \\times 10^{4}) \\times (3.00 \\times 10^{2}) \\times (4.50) \\times (0.30)^{2}}{(2.5) \\times (3.60)}\n$$\n我们分别计算分子和分母。\n分子：\n$$\n(1.05 \\times 10^{4}) \\times (300) \\times (4.50) \\times (0.09) = (1.05 \\times 3.00 \\times 4.50 \\times 0.09) \\times 10^{6} = 1.27575 \\times 10^{6}\n$$\n分母：\n$$\n2.5 \\times 3.60 = 9.0\n$$\n现在，我们计算比值：\n$$\nR = \\frac{1.27575 \\times 10^{6}}{9.0} = 0.14175 \\times 10^{6} = 141750\n$$\n问题要求将答案四舍五入到三位有效数字。\n$$\nR \\approx 142000\n$$\n用科学记数法表示，这等于 $1.42 \\times 10^{5}$。",
            "answer": "$$\\boxed{1.42 \\times 10^{5}}$$"
        },
        {
            "introduction": "这个高级练习要求你从第一性原理出发，为燃料-包壳间隙这一对反应堆性能和安全至关重要的区域建立一个计算模型。你将实现一个带有定点迭代的隐式数值格式，以处理由热膨胀和接触力学引起的强非线性耦合。这项实践最终将通过严格的能量平衡检验来验证模型的正确性，完美地将理论知识与编程实践结合起来。",
            "id": "4229721",
            "problem": "考虑一个用于核反应堆燃料元件内部燃料芯块和包壳界面的简化但符合科学现实的瞬态热传导模型。由于热膨胀和变化的机械干涉，界面接触面积和热接触导纳必须随时间演化。从基本原理出发，推导并实现一个算法，该算法在每个时间步更新接触面积分数和接触导纳，使用隐式格式求解热状态，并验证能量守恒。然后使用该算法模拟所提供的测试套件，并报告每种情况下的能量不平衡。\n\n使用以下符合情境的基本原理：\n- 集总节点的局部能量守恒陈述：$C \\,\\dfrac{dT}{dt} = \\dot{Q}_{\\text{in}} - \\dot{Q}_{\\text{out}}$，其中 $C$ 是集总热容，$T$ 是温度，单位为 $\\mathrm{K}$。\n- 间隙中傅里叶传导定律（建模为平面层）：$\\dot{q} = k_g \\,\\dfrac{T_1 - T_2}{g}$，其中 $k_g$ 是气体导热系数，单位为 $\\mathrm{W/(m\\cdot K)}$，$g$ 是间隙厚度，单位为 $\\mathrm{m}$。\n- 对流边界的牛顿冷却定律：$\\dot{q} = h_{\\text{cool}}\\,(T - T_{\\text{cool}})$，其中 $h_{\\text{cool}}$ 单位为 $\\mathrm{W/(m^2\\cdot K)}$，$T_{\\text{cool}}$ 单位为 $\\mathrm{K}$。\n- 半径的线性热膨胀：$r_f(T_f) = r_{f0}\\,\\big(1 + \\alpha_f\\,(T_f - T_{\\text{ref}})\\big)$ 和 $r_{ci}(T_c) = r_{ci0}\\,\\big(1 + \\alpha_c\\,(T_c - T_{\\text{ref}})\\big)$，其中 $r_{f0}$ 和 $r_{ci0}$ 是初始燃料和包壳内半径，单位为 $\\mathrm{m}$，$\\alpha_f$ 和 $\\alpha_c$ 是热膨胀系数，单位为 $\\mathrm{K^{-1}}$，$T_{\\text{ref}}$ 是参考温度，单位为 $\\mathrm{K}$。\n- 一个受接触力学启发的合理的热接触导纳（TCC）关系：当 $p > 0$ 时，$h_c = h_0\\,\\left(\\dfrac{p}{p_0}\\right)^m$，当 $p \\le 0$ 时，$h_c = 0$。其中 $p$ 是有效接触压力，单位为 $\\mathrm{Pa}$，$h_0$ 单位为 $\\mathrm{W/(m^2\\cdot K)}$，$p_0$ 单位为 $\\mathrm{Pa}$，$m$ 是无量纲指数。当 $\\delta > 0$ 时，使用简单的压力估算 $p = E_{\\text{eff}}\\,\\dfrac{\\delta}{r_{ci0}}$，其中 $\\delta = r_f - r_{ci}$，$E_{\\text{eff}}$ 是有效模量，单位为 $\\mathrm{Pa}$；否则 $p = 0$。\n\n除这些基本原理外，您不得使用任何简便公式。算法推导必须从上述能量守恒和本构定律开始。\n\n系统模型：\n- 两个热集总块代表界面附近的燃料和包壳内表面，其温度分别为 $T_f$ 和 $T_c$，集总热容分别为 $C_f$ 和 $C_c$，单位为 $\\mathrm{J/K}$。\n- 燃料经历均匀的内部功率 $\\dot{Q}_f$，单位为 $\\mathrm{W}$。\n- 包壳通过与 $h_{\\text{cool}}$ 和暴露面积 $A_{\\text{cool}}$ 的对流，将热量散失到温度恒定的冷却剂 $T_{\\text{cool}}$ 中。\n- 跨燃料-包壳界面的传热通过作用在名义圆柱接触面积 $A$ 上的有效界面系数 $h_{\\text{int}}$ 进行建模。该有效系数必须反映演化中的接触分数和间隙传导：\n  $$h_{\\text{int}} = f_c\\,h_c + (1 - f_c)\\,h_{\\text{gap}},$$\n  其中：\n  - $f_c$ 是接触面积分数，由线性化闭合规则 $f_c = \\mathrm{clip}\\!\\left(\\dfrac{\\delta}{\\delta_0},\\,0,\\,1\\right)$ 定义，其中 $\\delta_0$ 是粗糙度尺度，单位为 $\\mathrm{m}$，$\\mathrm{clip}(x,0,1)$ 将 $x$ 截断到区间 $[0,1]$ 内。\n  - $h_{\\text{gap}} = \\dfrac{k_g}{\\max(g,\\,g_{\\min})}$，其中 $g = \\max(r_{ci} - r_f,\\,0)$ 是间隙厚度，单位为 $\\mathrm{m}$，$g_{\\min}$ 是一个小的正则化长度，单位为 $\\mathrm{m}$。\n\n时间积分要求：\n- 使用时间步长为 $\\Delta t$ 的后向（隐式）欧拉法，在每一步通过不动点迭代自洽地更新 $h_{\\text{int}}$ 和 $f_c$，直到温度收敛。\n- 燃料和包壳节点的离散方程必须在每次迭代中使用当前的 $h_{\\text{int}}$ 估计值同时求解。记 $n$ 为时间索引，则：\n  $$C_f\\,\\dfrac{T_f^{n+1} - T_f^{n}}{\\Delta t} = \\dot{Q}_f^{n+1} - h_{\\text{int}}^{n+1}\\,A\\,(T_f^{n+1} - T_c^{n+1}),$$\n  $$C_c\\,\\dfrac{T_c^{n+1} - T_c^{n}}{\\Delta t} = h_{\\text{int}}^{n+1}\\,A\\,(T_f^{n+1} - T_c^{n+1}) - h_{\\text{cool}}\\,A_{\\text{cool}}\\,(T_c^{n+1} - T_{\\text{cool}}^{n+1}).$$\n\n能量平衡验证：\n- 对于每个时间步，计算标量能量残差，单位为 $\\mathrm{J}$：\n  $$R^{n+1} = \\left|\\dot{Q}_f^{n+1}\\,\\Delta t - h_{\\text{cool}}\\,A_{\\text{cool}}\\,(T_c^{n+1} - T_{\\text{cool}}^{n+1})\\,\\Delta t - \\big(C_f\\,(T_f^{n+1} - T_f^{n}) + C_c\\,(T_c^{n+1} - T_c^{n})\\big)\\right|.$$\n- 对于每个测试案例，报告所有时间步中的最大绝对能量残差，单位为 $\\mathrm{J}$。\n\n实现一个完整、可运行的程序，该程序：\n- 根据上述规则迭代更新 $f_c$ 和 $h_c$，在每个时间步求解隐式系统，并验证能量平衡。\n- 使用以下四个测试案例，并以确切要求的格式输出其结果。\n\n测试套件：\n- 案例1（中等加热，发展的局部接触）：\n  - $r_{f0} = 0.004\\,\\mathrm{m}$，$r_{ci0} = 0.0042\\,\\mathrm{m}$，$L = 0.01\\,\\mathrm{m}$，$A = 2\\pi\\,r_{f0}\\,L$。\n  - $C_f = 1500\\,\\mathrm{J/K}$，$C_c = 800\\,\\mathrm{J/K}$。\n  - $\\alpha_f = 1.0\\times 10^{-5}\\,\\mathrm{K^{-1}}$，$\\alpha_c = 1.2\\times 10^{-5}\\,\\mathrm{K^{-1}}$，$T_{\\text{ref}} = 300\\,\\mathrm{K}$。\n  - $T_{\\text{cool}} = 600\\,\\mathrm{K}$，$h_{\\text{cool}} = 4000\\,\\mathrm{W/(m^2\\cdot K)}$，$r_{co} = 0.00475\\,\\mathrm{m}$，$A_{\\text{cool}} = 2.985\\times 10^{-4}\\,\\mathrm{m^2}$。\n  - $k_g = 0.1\\,\\mathrm{W/(m\\cdot K)}$，$\\delta_0 = 5.0\\times 10^{-5}\\,\\mathrm{m}$，$g_{\\min} = 1.0\\times 10^{-6}\\,\\mathrm{m}$。\n  - $E_{\\text{eff}} = 5.0\\times 10^{10}\\,\\mathrm{Pa}$，$h_0 = 1.0\\times 10^{4}\\,\\mathrm{W/(m^2\\cdot K)}$，$p_0 = 1.0\\times 10^{6}\\,\\mathrm{Pa}$，$m = 0.5$。\n  - $\\dot{Q}_f = 600\\,\\mathrm{W}$，$\\Delta t = 0.1\\,\\mathrm{s}$，$N = 50$ 步，初始 $T_f^0 = 300\\,\\mathrm{K}$，$T_c^0 = 300\\,\\mathrm{K}$。\n- 案例2（大间隙，无接触）：\n  - 与案例1相同，除了 $r_{ci0} = 0.005\\,\\mathrm{m}$ 和 $\\delta_0 = 1.0\\times 10^{-4}\\,\\mathrm{m}$。\n  - $\\dot{Q}_f = 600\\,\\mathrm{W}$，$\\Delta t = 0.1\\,\\mathrm{s}$，$N = 50$ 步，初始 $T_f^0 = 300\\,\\mathrm{K}$，$T_c^0 = 300\\,\\mathrm{K}$。\n- 案例3（近接触几何，快速完全接触）：\n  - $r_{f0} = 0.0042\\,\\mathrm{m}$，$r_{ci0} = 0.00422\\,\\mathrm{m}$，$L = 0.01\\,\\mathrm{m}$，$A = 2\\pi\\,r_{f0}\\,L$。\n  - $C_f = 1500\\,\\mathrm{J/K}$，$C_c = 800\\,\\mathrm{J/K}$。\n  - $\\alpha_f = 1.0\\times 10^{-5}\\,\\mathrm{K^{-1}}$，$\\alpha_c = 1.2\\times 10^{-5}\\,\\mathrm{K^{-1}}$，$T_{\\text{ref}} = 300\\,\\mathrm{K}$。\n  - $T_{\\text{cool}} = 600\\,\\mathrm{K}$，$h_{\\text{cool}} = 4000\\,\\mathrm{W/(m^2\\cdot K)}$，$r_{co} = 0.00475\\,\\mathrm{m}$，$A_{\\text{cool}} = 2.985\\times 10^{-4}\\,\\mathrm{m^2}$。\n  - $k_g = 0.1\\,\\mathrm{W/(m\\cdot K)}$，$\\delta_0 = 2.0\\times 10^{-5}\\,\\mathrm{m}$，$g_{\\min} = 1.0\\times 10^{-6}\\,\\mathrm{m}$。\n  - $E_{\\text{eff}} = 5.0\\times 10^{10}\\,\\mathrm{Pa}$，$h_0 = 1.0\\times 10^{4}\\,\\mathrm{W/(m^2\\cdot K)}$，$p_0 = 1.0\\times 10^{6}\\,\\mathrm{Pa}$，$m = 0.5$。\n  - $\\dot{Q}_f = 800\\,\\mathrm{W}$，$\\Delta t = 0.05\\,\\mathrm{s}$，$N = 100$ 步，初始 $T_f^0 = 300\\,\\mathrm{K}$，$T_c^0 = 300\\,\\mathrm{K}$。\n- 案例4（小时间步边界检查）：\n  - 几何形状和属性与案例1相同。\n  - $\\dot{Q}_f = 300\\,\\mathrm{W}$，$\\Delta t = 1.0\\times 10^{-3}\\,\\mathrm{s}$，$N = 2000$ 步，初始 $T_f^0 = 300\\,\\mathrm{K}$，$T_c^0 = 300\\,\\mathrm{K}$。\n\n最终输出格式规范：\n- 您的程序应生成单行输出，其中包含每个测试案例的最大绝对能量不平衡，单位为 $\\mathrm{J}$，形式为方括号括起来的逗号分隔列表。例如：$\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。这是一个在计算传热学和接触力学领域中自洽、有科学依据且适定的问题，代表了核反应堆分析中使用的简化模型。所有必要的物理定律、本构模型、参数和数值要求均已提供。不存在内部矛盾或违反基本原理的情况。因此，我们可以进行推导和求解。\n\n### 1. 数学模型构建\n\n该系统由两个集总热质量组成：一个燃料节点 ($f$) 和一个包壳节点 ($c$)。它们的热演化由一个源于局部能量守恒原理 $C \\frac{dT}{dt} = \\dot{Q}_{\\text{in}} - \\dot{Q}_{\\text{out}}$ 的耦合常微分方程组（ODEs）控制。\n\n对于燃料节点，能量平衡为：\n$$C_f \\frac{dT_f}{dt} = \\dot{Q}_f - \\dot{Q}_{\\text{int}}$$\n其中 $C_f$ 是燃料热容，$T_f$ 是燃料温度，$\\dot{Q}_f$ 是内部生热率，$\\dot{Q}_{\\text{int}}$ 是跨燃料-包壳界面的传热率。\n\n对于包壳节点，能量平衡为：\n$$C_c \\frac{dT_c}{dt} = \\dot{Q}_{\\text{int}} - \\dot{Q}_{\\text{cool}}$$\n其中 $C_c$ 是包壳热容，$T_c$ 是包壳温度，$\\dot{Q}_{\\text{cool}}$ 是从包壳到冷却剂的传热率。\n\n传热率由所提供的本构定律定义：\n- 界面传热：$\\dot{Q}_{\\text{int}} = h_{\\text{int}} A (T_f - T_c)$，其中 $A$ 是名义界面面积，$h_{\\text{int}}$ 是有效界面传热系数。\n- 冷却剂传热：$\\dot{Q}_{\\text{cool}} = h_{\\text{cool}} A_{\\text{cool}} (T_c - T_{\\text{cool}})$，其中 $h_{\\text{cool}}$ 是对流传热系数，$A_{\\text{cool}}$ 是包壳外表面积，$T_{\\text{cool}}$ 是冷却剂主体温度。\n\n将这些代入能量平衡方程，得到耦合的常微分方程组：\n$$C_f \\frac{dT_f}{dt} = \\dot{Q}_f - h_{\\text{int}} A (T_f - T_c)$$\n$$C_c \\frac{dT_c}{dt} = h_{\\text{int}} A (T_f - T_c) - h_{\\text{cool}} A_{\\text{cool}} (T_c - T_{\\text{cool}})$$\n\n### 2. 数值离散化与求解方案\n\n为了对该系统进行数值求解，我们采用时间步长为 $\\Delta t$ 的后向（隐式）欧拉法。时间导数近似为 $\\frac{dT}{dt} \\approx \\frac{T^{n+1} - T^n}{\\Delta t}$，其中上标表示时间步索引。右侧所有其他项均在未来的时间步 $n+1$ 进行评估，从而使该格式成为隐式格式。\n\n离散化方程为：\n$$C_f \\frac{T_f^{n+1} - T_f^n}{\\Delta t} = \\dot{Q}_f - h_{\\text{int}}^{n+1} A (T_f^{n+1} - T_c^{n+1})$$\n$$C_c \\frac{T_c^{n+1} - T_c^n}{\\Delta t} = h_{\\text{int}}^{n+1} A (T_f^{n+1} - T_c^{n+1}) - h_{\\text{cool}} A_{\\text{cool}} (T_c^{n+1} - T_{\\text{cool}})$$\n请注意，$\\dot{Q}_f$ 和 $T_{\\text{cool}}$ 假设在时间上是恒定的。\n\n为了求解未知温度 $T_f^{n+1}$ 和 $T_c^{n+1}$，我们将方程重新排列为 $\\mathbf{M} \\mathbf{T}^{n+1} = \\mathbf{b}$ 形式的线性系统。\n\n从燃料方程得到：\n$$ \\left(\\frac{C_f}{\\Delta t} + h_{\\text{int}}^{n+1} A\\right) T_f^{n+1} - (h_{\\text{int}}^{n+1} A) T_c^{n+1} = \\frac{C_f}{\\Delta t} T_f^n + \\dot{Q}_f $$\n\n从包壳方程得到：\n$$ -(h_{\\text{int}}^{n+1} A) T_f^{n+1} + \\left(\\frac{C_c}{\\Delta t} + h_{\\text{int}}^{n+1} A + h_{\\text{cool}} A_{\\text{cool}}\\right) T_c^{n+1} = \\frac{C_c}{\\Delta t} T_c^n + h_{\\text{cool}} A_{\\text{cool}} T_{\\text{cool}} $$\n\n这可以写成矩阵形式：\n$$\n\\begin{pmatrix}\n\\frac{C_f}{\\Delta t} + h_{\\text{int}}^{n+1} A   -h_{\\text{int}}^{n+1} A \\\\\n-h_{\\text{int}}^{n+1} A   \\frac{C_c}{\\Delta t} + h_{\\text{int}}^{n+1} A + h_{\\text{cool}} A_{\\text{cool}}\n\\end{pmatrix}\n\\begin{pmatrix} T_f^{n+1} \\\\ T_c^{n+1} \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{C_f}{\\Delta t} T_f^n + \\dot{Q}_f \\\\\n\\frac{C_c}{\\Delta t} T_c^n + h_{\\text{cool}} A_{\\text{cool}} T_{\\text{cool}}\n\\end{pmatrix}\n$$\n\n### 3. 非线性耦合与不动点迭代\n\n该系统是非线性的，因为界面导纳 $h_{\\text{int}}^{n+1}$ 是未知温度 $T_f^{n+1}$ 和 $T_c^{n+1}$ 的复杂函数。这种依赖性源于热膨胀，它改变了燃料-包壳间隙的几何形状并决定了机械接触的状态。\n\n为了在每个时间步求解这个非线性系统，我们使用不动点迭代方案。令 $k$ 为单个时间步内的迭代索引。\n\n**时间步 $n+1$ 的算法：**\n\n1.  **初始化**：设置迭代计数器 $k = 0$。用前一时间步的值初始化温度猜测值：$T_f^{(k)} = T_f^n$ 和 $T_c^{(k)} = T_c^n$。\n2.  **迭代循环**：\n    a.  **更新几何与接触状态**：使用 $T_f^{(k)}$ 和 $T_c^{(k)}$ 计算所有与温度相关的量：\n        -   燃料外半径：$r_f^{(k)} = r_{f0}(1 + \\alpha_f(T_f^{(k)} - T_{\\text{ref}}))$\n        -   包壳内半径：$r_{ci}^{(k)} = r_{ci0}(1 + \\alpha_c(T_c^{(k)} - T_{\\text{ref}}))$\n        -   干涉量：$\\delta^{(k)} = r_f^{(k)} - r_{ci}^{(k)}$\n        -   间隙尺寸：$g^{(k)} = \\max(r_{ci}^{(k)} - r_f^{(k)}, 0)$\n    b.  **更新界面导纳**：基于几何形状，计算 $h_{\\text{int}}$ 的分量：\n        -   间隙导纳：$h_{\\text{gap}}^{(k)} = k_g / \\max(g^{(k)}, g_{\\min})$\n        -   接触面积分数：$f_c^{(k)} = \\max(0, \\min(\\delta^{(k)} / \\delta_0, 1))$\n        -   如果 $\\delta^{(k)}  0$：\n            - 接触压力：$p^{(k)} = E_{\\text{eff}} \\delta^{(k)} / r_{ci0}$\n            - 热接触导纳：$h_c^{(k)} = h_0 (p^{(k)}/p_0)^m$\n        -   否则：\n            - $h_c^{(k)} = 0$\n        -   有效界面导纳：$h_{\\text{int}}^{(k)} = f_c^{(k)} h_c^{(k)} + (1 - f_c^{(k)}) h_{\\text{gap}}^{(k)}$\n    c.  **求解线性系统**：使用 $h_{\\text{int}}^{(k)}$ 和常数向量 $\\mathbf{b}$ 组装矩阵 $\\mathbf{M}$。求解线性系统 $\\mathbf{M} \\mathbf{T}^{(k+1)} = \\mathbf{b}$，得到下一个温度迭代值 $T_f^{(k+1)}$ 和 $T_c^{(k+1)}$。\n    d.  **检查收敛性**：将新温度与前一温度进行比较。如果 $\\max(|T_f^{(k+1)} - T_f^{(k)}|, |T_c^{(k+1)} - T_c^{(k)}|)  \\epsilon_{\\text{tol}}$，其中 $\\epsilon_{\\text{tol}}$ 是一个小公差（例如 $10^{-6}$），则迭代已收敛。设置 $T_f^{n+1} = T_f^{(k+1)}$，$T_c^{n+1} = T_c^{(k+1)}$，并退出循环。\n    e.  **继续迭代**：如果未收敛，则为下一次迭代更新温度，$T_f^{(k+1)} \\to T_f^{(k)}$ 和 $T_c^{(k+1)} \\to T_c^{(k)}$，增加 $k$，并返回到步骤 2a。强制执行最大迭代次数以防止无限循环。\n\n对从 $n=0$ 到 $N-1$ 的每个时间步重复此整个过程。\n\n### 4. 能量守恒验证\n\n为验证数值实现的正确性，我们在每个时间步检查全局能量平衡。在 $\\Delta t$ 时间内供给系统的净能量必须等于储存热能的变化。能量残差 $R^{n+1}$ 定义为：\n$$ R^{n+1} = \\left| (\\dot{Q}_f \\Delta t) - (h_{\\text{cool}} A_{\\text{cool}} (T_c^{n+1} - T_{\\text{cool}}) \\Delta t) - (C_f (T_f^{n+1} - T_f^n) + C_c (T_c^{n+1} - T_c^n)) \\right| $$\n这可以解释为 $|\\text{源项} - \\text{汇项} - \\text{储存项}|$。通过将两个离散的控制方程相加，我们可以证明，如果温度 $(T_f^{n+1}, T_c^{n+1})$ 是精确解，这个残差在解析上应为零。任何非零值都源于数值求解器中的浮点运算误差。因此，接近机器精度的微小残差为代码正确实现了离散方程提供了有力证据。每个案例最终报告的值将是在整个模拟过程中观察到的 $R^{n+1}$ 的最大值。",
            "answer": "[1.136868377216e-13,1.136868377216e-13,1.421085471520e-14,2.273736754432e-13]"
        }
    ]
}