{
    "hands_on_practices": [
        {
            "introduction": "本练习为核工程中的热分析奠定了基础。通过推导具有均匀热量生成的理想化燃料几何形状中的温度分布的解析解，您将对内部热源与稳态传导之间的关系建立起基础性的理解，这是任何反应堆模拟任务的关键技能。",
            "id": "4230060",
            "problem": "一个正在发生裂变的核燃料元件可以理想化为一个具有均匀体积生热的一维 (1D) 物体。在稳态下，热量通过与冷却剂的对流或通过维持恒定的表面温度从表面移除。从能量守恒和傅里叶热传导定律的本构关系出发，推导三种典型几何形状（平板（平面）、实心圆柱（径向）和实心球体（径向））在均匀体积生热情况下的稳态温度分布的解析表达式。使用中心线对称性和外表面上物理一致的边界条件。然后设计一个程序，用于根据给定的参数集评估中心线温度和表面热通量。\n\n需采用的基本原理和假设：\n- 稳态条件下微元控制体内的能量守恒，热导率恒定且体积生热均匀。\n- 傅里叶热传导定律，将热通量与温度梯度关联起来。\n- 中心对称性（在 $x=0$ 或 $r=0$ 处，$dT/dx = 0$ 或 $dT/dr = 0$）。\n- 在表面，采用与温度为 $T_\\infty$、对流系数为 $h$ 的流体进行对流的边界条件，或采用恒定的表面温度 $T_s$。\n\n您必须：\n1. 对每种几何形状，推导能够根据几何尺寸、热导率、体积生热和边界参数计算中心线温度 $T(0)$ 和表面热通量 $q''$ 的解析表达式。\n2. 实现一个程序，该程序对下面指定的每个测试用例计算：\n   - 中心线温度，单位为 $\\mathrm{K}$。\n   - 向外的表面热通量，单位为 $\\mathrm{W/m^2}$。\n3. 将最终输出表示为单行，包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含每个测试用例的中心线温度（单位为 $\\mathrm{K}$）和表面热通量（单位为 $\\mathrm{W/m^2}$）。将每个浮点数结果四舍五入到六位小数。\n\n几何约定：\n- 平板：模型为半厚度域 $0 \\le x \\le L$，在 $x=0$ 处对称，边界在 $x=L$ 处。\n- 圆柱：模型为径向域 $0 \\le r \\le R$，在 $r=0$ 处对称，边界在 $r=R$ 处。\n- 球体：模型为径向域 $0 \\le r \\le R$，在 $r=0$ 处对称，边界在 $r=R$ 处。\n\n单位：\n- 热导率 $k$ 的单位为 $\\mathrm{W/(m\\cdot K)}$。\n- 体积生热 $q'''$ 的单位为 $\\mathrm{W/m^3}$。\n- 对流系数 $h$ 的单位为 $\\mathrm{W/(m^2\\cdot K)}$。\n- 长度 $L$ 或 $R$ 的单位为 $\\mathrm{m}$。\n- 温度 $T_\\infty$ 和 $T_s$ 的单位为 $\\mathrm{K}$。\n- 热通量 $q''$ 的单位为 $\\mathrm{W/m^2}$。\n\n测试套件：\n- 用例 $1$（平板，对流边界）：$L = 0.005\\,\\mathrm{m}$，$k = 20\\,\\mathrm{W/(m\\cdot K)}$，$q''' = 1.5\\times 10^8\\,\\mathrm{W/m^3}$，$h = 12000\\,\\mathrm{W/(m^2\\cdot K)}$，$T_\\infty = 570\\,\\mathrm{K}$。\n- 用例 $2$（圆柱，恒定表面温度）：$R = 0.004\\,\\mathrm{m}$，$k = 3\\,\\mathrm{W/(m\\cdot K)}$，$q''' = 5.0\\times 10^8\\,\\mathrm{W/m^3}$，$T_s = 620\\,\\mathrm{K}$。\n- 用例 $3$（球体，对流边界）：$R = 0.010\\,\\mathrm{m}$，$k = 15\\,\\mathrm{W/(m\\cdot K)}$，$q''' = 2.0\\times 10^7\\,\\mathrm{W/m^3}$，$h = 8000\\,\\mathrm{W/(m^2\\cdot K)}$，$T_\\infty = 350\\,\\mathrm{K}$。\n- 用例 $4$（平板，对流边界，零生热边缘情况）：$L = 0.003\\,\\mathrm{m}$，$k = 12\\,\\mathrm{W/(m\\cdot K)}$，$q''' = 0\\,\\mathrm{W/m^3}$，$h = 10000\\,\\mathrm{W/(m^2\\cdot K)}$，$T_\\infty = 300\\,\\mathrm{K}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，顺序如下：\n  $[T_{\\text{center,case1}}, q''_{\\text{surface,case1}}, T_{\\text{center,case2}}, q''_{\\text{surface,case2}}, T_{\\text{center,case3}}, q''_{\\text{surface,case3}}, T_{\\text{center,case4}}, q''_{\\text{surface,case4}}]$,\n  每个值都四舍五入到六位小数，单位如上所述。",
            "solution": "该问题要求推导具有均匀体积生热的典型一维几何形状（平板、圆柱、球体）中稳态温度分布和热通量的解析表达式，然后进行计算实现。分析从能量守恒的第一性原理开始。\n\n具有均匀体积热源 $q'''$ 和恒定热导率 $k$ 的稳态热传导控制方程由微元控制体上的能量平衡推导得出。它是泊松方程的一种特定形式：\n$$ \\nabla^2 T = -\\frac{q'''}{k} $$\n这里，$T$ 是温度，$\\nabla^2$ 是拉普拉斯算子。我们将针对每种几何形状，在指定的边界条件下求解该方程。\n\n### 一般推导过程\n对于每种几何形状，过程如下：\n1.  在适当的坐标系中表示热方程。\n2.  对该方程积分两次，以获得温度分布 $T(y)$ 的通解，其中 $y$ 是空间坐标（平板为 $x$，圆柱/球体为 $r$）。这将引入两个积分常数 $C_1$ 和 $C_2$。\n3.  应用第一个边界条件，即中心对称性（$x=0$ 或 $r=0$）。该条件表明温度梯度为零，$\\frac{dT}{dy}|_{y=0}=0$，从而确定第一个常数 $C_1$。\n4.  第二个常数 $C_2$ 由外表面的边界条件确定。中心线温度 $T(0)$ 与 $C_2$ 直接相关。\n5.  考虑两种外边界条件：\n    a. 表面温度恒定为 $T_s$。\n    b. 与温度为 $T_\\infty$、传热系数为 $h$ 的流体进行对流。该条件通过牛顿冷却定律表示，即表面上的传导热通量等于对流热通量：$q''_s = -k \\frac{dT}{dy}|_{surface} = h(T_{surface} - T_\\infty)$。\n6.  表面热通量 $q''_s$ 可以通过傅里叶定律 $q''_s = -k \\frac{dT}{dy}|_{surface}$ 确定，也可以通过全局能量平衡确定：在稳态下，体积内产生的总热量必须在表面被移除。单位面积的热通量为 $q''_s = (q''' \\times \\text{体积}) / (\\text{表面积})$。\n\n### 1. 平板几何形状\n对于半厚度为 $L$ 的平板，我们考虑区域 $0 \\le x \\le L$。一维笛卡尔坐标系中的热方程为：\n$$ \\frac{d^2T}{dx^2} = -\\frac{q'''}{k} $$\n对 $x$ 积分一次：\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k}x + C_1 $$\n在中心线应用对称边界条件 $\\frac{dT}{dx}|_{x=0} = 0$，得到 $C_1 = 0$。温度梯度为：\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k}x $$\n第二次积分：\n$$ T(x) = -\\frac{q'''}{2k}x^2 + C_2 $$\n中心线温度为 $T(0) = C_2$。\n\n**表面热通量 $q''_s$**：对半平板（单位面积的体积为 $L$）进行全局能量平衡，表明单位面积内产生的热量 $q'''L$ 必须从表面 $x=L$ 逸出。因此，\n$$ q''_s = q'''L $$\n此结果与边界条件类型无关。一旦 $T(x)$ 已知，可以使用傅里叶定律进行验证：$q''_s = -k \\frac{dT}{dx}|_{x=L} = -k(-\\frac{q'''}{k}L) = q'''L$。\n\n**中心线温度 $T(0)$**：\na) **恒定表面温度**：在 $x=L$ 处，$T(L) = T_s$。\n$$ T(L) = T_s = -\\frac{q'''L^2}{2k} + C_2 $$\n求解 $C_2$ 得到中心线温度：\n$$ T(0) = C_2 = T_s + \\frac{q'''L^2}{2k} $$\nb) **对流边界**：在 $x=L$ 处，$-k\\frac{dT}{dx}|_{x=L} = h(T(L) - T_\\infty)$。我们知道 $q''_s = -k\\frac{dT}{dx}|_{x=L} = q'''L$。因此，$q'''L = h(T(L) - T_\\infty)$，这给出了表面温度 $T(L) = T_\\infty + \\frac{q'''L}{h}$。\n将 $T(L)$ 代入 $x=L$ 处的通用温度分布表达式中：\n$$ T(L) = T_\\infty + \\frac{q'''L}{h} = -\\frac{q'''L^2}{2k} + C_2 $$\n求解 $C_2$ 得到中心线温度：\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k} = T_\\infty + q'''L\\left(\\frac{1}{h} + \\frac{L}{2k}\\right) $$\n\n### 2. 实心圆柱几何形状\n对于半径为 $R$ 的实心圆柱，我们考虑区域 $0 \\le r \\le R$。一维圆柱坐标系中的热方程为：\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{dT}{dr}\\right) = -\\frac{q'''}{k} $$\n积分一次得到：\n$$ r\\frac{dT}{dr} = -\\frac{q'''}{2k}r^2 + C_1 $$\n应用对称条件 $\\frac{dT}{dr}|_{r=0} = 0$（或等效地，要求温度在 $r=0$ 处为有限值），我们必须有 $C_1=0$。\n$$ \\frac{dT}{dr} = -\\frac{q'''}{2k}r $$\n第二次积分：\n$$ T(r) = -\\frac{q'''}{4k}r^2 + C_2 $$\n中心线温度为 $T(0) = C_2$。\n\n**表面热通量 $q''_s$**：对长度为 $H$ 的圆柱进行能量平衡得到：体积 $V = \\pi R^2 H$，表面积 $A = 2\\pi R H$。产生的总热量为 $q'''V$。表面通量为 $q''_s = (q'''V)/A = (q'''\\pi R^2 H) / (2\\pi R H)$。因此，\n$$ q''_s = \\frac{q'''R}{2} $$\n这可以通过傅里叶定律得到证实：$q''_s = -k \\frac{dT}{dr}|_{r=R} = -k(-\\frac{q'''}{2k}R) = \\frac{q'''R}{2}$。\n\n**中心线温度 $T(0)$**：\na) **恒定表面温度**：在 $r=R$ 处，$T(R)=T_s$。\n$$ T(R) = T_s = -\\frac{q'''R^2}{4k} + C_2 $$\n$$ T(0) = C_2 = T_s + \\frac{q'''R^2}{4k} $$\nb) **对流边界**：在 $r=R$ 处，$q''_s = h(T(R) - T_\\infty)$。所以，$\\frac{q'''R}{2} = h(T(R) - T_\\infty)$，这给出了 $T(R) = T_\\infty + \\frac{q'''R}{2h}$。\n将此代入 $r=R$ 处的分布中：\n$$ T(R) = T_\\infty + \\frac{q'''R}{2h} = -\\frac{q'''R^2}{4k} + C_2 $$\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''R}{2h} + \\frac{q'''R^2}{4k} = T_\\infty + \\frac{q'''R}{2}\\left(\\frac{1}{h} + \\frac{R}{2k}\\right) $$\n\n### 3. 实心球体几何形状\n对于半径为 $R$ 的实心球体，我们考虑区域 $0 \\le r \\le R$。一维球坐标系中的热方程为：\n$$ \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2\\frac{dT}{dr}\\right) = -\\frac{q'''}{k} $$\n积分一次：\n$$ r^2\\frac{dT}{dr} = -\\frac{q'''}{3k}r^3 + C_1 $$\n对称条件 $\\frac{dT}{dr}|_{r=0} = 0$ 要求 $C_1=0$。\n$$ \\frac{dT}{dr} = -\\frac{q'''}{3k}r $$\n第二次积分：\n$$ T(r) = -\\frac{q'''}{6k}r^2 + C_2 $$\n中心线温度为 $T(0) = C_2$。\n\n**表面热通量 $q''_s$**：能量平衡给出：体积 $V = \\frac{4}{3}\\pi R^3$，表面积 $A = 4\\pi R^2$。表面通量为 $q''_s = (q'''V)/A = (q'''\\frac{4}{3}\\pi R^3) / (4\\pi R^2)$。\n$$ q''_s = \\frac{q'''R}{3} $$\n这可以通过傅里叶定律得到证实：$q''_s = -k \\frac{dT}{dr}|_{r=R} = -k(-\\frac{q'''}{3k}R) = \\frac{q'''R}{3}$。\n\n**中心线温度 $T(0)$**：\na) **恒定表面温度**：在 $r=R$ 处，$T(R)=T_s$。\n$$ T(R) = T_s = -\\frac{q'''R^2}{6k} + C_2 $$\n$$ T(0) = C_2 = T_s + \\frac{q'''R^2}{6k} $$\nb) **对流边界**：在 $r=R$ 处，$q''_s = h(T(R) - T_\\infty)$。所以，$\\frac{q'''R}{3} = h(T(R) - T_\\infty)$，这给出了 $T(R) = T_\\infty + \\frac{q'''R}{3h}$。\n将此代入 $r=R$ 处的分布中：\n$$ T(R) = T_\\infty + \\frac{q'''R}{3h} = -\\frac{q'''R^2}{6k} + C_2 $$\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''R}{3h} + \\frac{q'''R^2}{6k} = T_\\infty + \\frac{q'''R}{3}\\left(\\frac{1}{h} + \\frac{R}{2k}\\right) $$\n\n现在，我们将应用这些推导出的公式来解决所提供的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes centerline temperature and surface heat flux for various\n    geometries and boundary conditions in steady-state heat conduction.\n    \"\"\"\n    \n    # Test cases are structured as dictionaries for clarity.\n    # 'geom': 'slab', 'cylinder', 'sphere'\n    # 'bc_type': 'conv', 'fixed_T'\n    # 'params': dictionary of physical and geometrical parameters\n    test_cases_data = [\n        {\n            \"geom\": \"slab\", \"bc_type\": \"conv\", \n            \"params\": {\"L\": 0.005, \"k\": 20.0, \"q_gen\": 1.5e8, \"h\": 12000.0, \"T_inf\": 570.0}\n        },\n        {\n            \"geom\": \"cylinder\", \"bc_type\": \"fixed_T\", \n            \"params\": {\"R\": 0.004, \"k\": 3.0, \"q_gen\": 5.0e8, \"T_s\": 620.0}\n        },\n        {\n            \"geom\": \"sphere\", \"bc_type\": \"conv\", \n            \"params\": {\"R\": 0.010, \"k\": 15.0, \"q_gen\": 2.0e7, \"h\": 8000.0, \"T_inf\": 350.0}\n        },\n        {\n            \"geom\": \"slab\", \"bc_type\": \"conv\", \n            \"params\": {\"L\": 0.003, \"k\": 12.0, \"q_gen\": 0.0, \"h\": 10000.0, \"T_inf\": 300.0}\n        }\n    ]\n\n    results = []\n\n    for case in test_cases_data:\n        geom = case[\"geom\"]\n        bc_type = case[\"bc_type\"]\n        p = case[\"params\"]\n        \n        T_center = 0.0\n        q_surface = 0.0\n\n        if geom == \"slab\":\n            # Surface heat flux from energy balance: q_s = q''' * L\n            q_surface = p[\"q_gen\"] * p[\"L\"]\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q'''*L/h + q'''*L^2/(2*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"L\"]**2 / (2 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*L^2/(2*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"L\"]**2 / (2 * p[\"k\"])\n\n        elif geom == \"cylinder\":\n            # Surface heat flux from energy balance: q_s = q''' * R / 2\n            q_surface = p[\"q_gen\"] * p[\"R\"] / 2\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q_s/h + q'''*R^2/(4*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"R\"]**2 / (4 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*R^2/(4*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"R\"]**2 / (4 * p[\"k\"])\n\n        elif geom == \"sphere\":\n            # Surface heat flux from energy balance: q_s = q''' * R / 3\n            q_surface = p[\"q_gen\"] * p[\"R\"] / 3\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q_s/h + q'''*R^2/(6*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"R\"]**2 / (6 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*R^2/(6*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"R\"]**2 / (6 * p[\"k\"])\n                \n        results.append(T_center)\n        results.append(q_surface)\n\n    # Format the final output string exactly as required, with rounding to six decimal places.\n    # Using format specifier f\"{x:.6f}\" ensures trailing zeros.\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在真实的反应堆中，由于复杂的中子物理现象，燃料芯块内的热量生成并非均匀分布。本练习旨在挑战您超越均匀热源的假设，通过模拟一个更真实、随空间变化的体积热源，从而更深入地洞察中子自屏蔽等因素如何影响燃料的温度分布。",
            "id": "4230065",
            "problem": "一个半径为 $R$ 的二氧化铀燃料直立圆柱体在稳态条件下被建模为一个具有恒定热导率 $k$ 的均匀、各向同性的固体。在运行的轻水反应堆中，由于共振自屏蔽和边缘富集效应，裂变功率以体积形式产生，其源密度 $q^{\\prime\\prime\\prime}(r)$ 随径向变化。体积源近似为形式 $q^{\\prime\\prime\\prime}(r) = S_{0}\\left(1 + \\beta \\frac{r^{2}}{R^{2}}\\right)$，其中 $S_{0}$ 是一个未知的归一化常数，$\\beta$ 是一个给定的无量纲参数。燃料棒单位长度产生的总热量，称为线热率 $q^{\\prime}$，必须等于 $q^{\\prime\\prime\\prime}(r)$ 的横截面积分。燃料表面的散热由 $r=R$ 处的有效对流边界条件表示，即 $-k\\,\\frac{dT}{dr}\\big|_{r=R} = h\\left(T(R) - T_{\\mathrm{c}}\\right)$，其中 $h$ 是一个有效传热系数，考虑了固体间隙和包壳到冷却剂的传热，而 $T_{\\mathrm{c}}$ 是冷却剂的主流温度。对称性要求在 $r=0$ 处的温度梯度保持有限。\n\n从柱坐标系中包含体积生热的稳态能量守恒和傅里叶热传导定律出发，推导温度分布并计算中心线温度 $T(0)$。\n\n使用数值 $R = 4.0\\ \\mathrm{mm}$，$k = 3.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$，$h = 1.0\\times 10^{4}\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$，$T_{\\mathrm{c}} = 570\\ \\mathrm{K}$，$q^{\\prime} = 1.8\\times 10^{4}\\ \\mathrm{W\\,m^{-1}}$，以及 $\\beta = 2$。\n\n将最终答案四舍五入到四位有效数字。以开尔文表示最终温度。",
            "solution": "用户希望我解决一个核反应堆模拟领域的问题，具体是关于热量产生和体积源建模。\n\n### **问题验证**\n\n#### **第一步：提取已知条件**\n-   **几何**：燃料直立圆柱体。\n-   **半径**：$R$。\n-   **热导率**：$k$（恒定）。\n-   **状态**：稳态。\n-   **体积热源**：$q^{\\prime\\prime\\prime}(r) = S_{0}\\left(1 + \\beta \\frac{r^{2}}{R^{2}}\\right)$。\n-   **归一化常数**：$S_{0}$（未知）。\n-   **无量纲参数**：$\\beta$。\n-   **线热率**：$q^{\\prime}$，定义为 $q^{\\prime} = \\int_{A} q^{\\prime\\prime\\prime}(r) dA$。\n-   **边界条件1（中心线）**：对称性要求在 $r=0$ 处的温度梯度保持有限。这意味着 $\\frac{dT}{dr}\\big|_{r=0} = 0$。\n-   **边界条件2（表面）**：在 $r=R$ 处的对流边界条件，由 $-k\\,\\frac{dT}{dr}\\big|_{r=R} = h\\left(T(R) - T_{\\mathrm{c}}\\right)$ 给出。\n-   **传热系数**：$h$。\n-   **冷却剂温度**：$T_{\\mathrm{c}}$。\n-   **数值**：\n    -   $R = 4.0\\ \\mathrm{mm} = 4.0 \\times 10^{-3}\\ \\mathrm{m}$\n    -   $k = 3.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n    -   $h = 1.0\\times 10^{4}\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    -   $T_{\\mathrm{c}} = 570\\ \\mathrm{K}$\n    -   $q^{\\prime} = 1.8\\times 10^{4}\\ \\mathrm{W\\,m^{-1}}$\n    -   $\\beta = 2$\n\n#### **第二步：使用提取的已知条件进行验证**\n针对验证标准对问题进行分析：\n-   **科学依据**：该问题基于传热的基本原理，特别是稳态热扩散方程（能量守恒定律的一种形式）和傅里叶传导定律。体积热源模型 $q^{\\prime\\prime\\prime}(r) = S_0(1+\\beta r^2/R^2)$ 是核工程中一个成熟的二阶多项式近似，用于模拟燃料棒中的径向功率分布，考虑了中子通量凹陷和芯块边缘钚累积（边缘效应）等效应。所有参数和条件对于轻水堆燃料棒都是物理上现实的。不存在科学缺陷。\n-   **问题适定**：该问题提供了一个二阶常微分方程和两个边界条件（一个在 $r=0$，一个在 $r=R$），确保了温度剖面 $T(r)$ 的唯一解。所有必要的数据（$R, k, h, T_c, q', \\beta$）都已提供。问题是自洽且一致的。\n-   **客观性**：问题以精确的定量语言陈述，没有主观性或歧义。\n\n该问题没有任何无效性缺陷。这是一个工程传热学中的标准可解问题。\n\n#### **第三步：结论与行动**\n问题是**有效的**。将提供完整解答。\n\n### **解题推导**\n\n在具有体积热源 $q^{\\prime\\prime\\prime}(r)$ 的一维圆柱系统中，稳态热传导的控制方程是热扩散方程：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r k \\frac{dT}{dr} \\right) + q^{\\prime\\prime\\prime}(r) = 0 $$\n由于热导率 $k$ 是常数，方程简化为：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) = -\\frac{q^{\\prime\\prime\\prime}(r)}{k} $$\n\n首先，我们必须使用给定的线热率 $q^{\\prime}$ 来确定归一化常数 $S_0$。线热率是体积热源在横截面积 $A = \\pi R^2$ 上的积分。\n$$ q^{\\prime} = \\int_{0}^{R} q^{\\prime\\prime\\prime}(r) (2\\pi r) dr $$\n代入 $q^{\\prime\\prime\\prime}(r)$ 的表达式：\n$$ q^{\\prime} = \\int_{0}^{R} S_{0}\\left(1 + \\beta \\frac{r^{2}}{R^{2}}\\right) (2\\pi r) dr = 2\\pi S_0 \\int_{0}^{R} \\left(r + \\frac{\\beta r^3}{R^2}\\right) dr $$\n$$ q^{\\prime} = 2\\pi S_0 \\left[ \\frac{r^2}{2} + \\frac{\\beta r^4}{4R^2} \\right]_{0}^{R} = 2\\pi S_0 \\left( \\frac{R^2}{2} + \\frac{\\beta R^4}{4R^2} \\right) = 2\\pi S_0 \\left( \\frac{R^2}{2} + \\frac{\\beta R^2}{4} \\right) $$\n$$ q^{\\prime} = \\pi S_0 R^2 \\left(1 + \\frac{\\beta}{2}\\right) $$\n求解 $S_0$：\n$$ S_0 = \\frac{q^{\\prime}}{\\pi R^2 (1 + \\beta/2)} $$\n\n现在，将 $q^{\\prime\\prime\\prime}(r)$ 代入热扩散方程并积分。\n$$ \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) = -\\frac{r}{k} S_0 \\left(1 + \\frac{\\beta r^2}{R^2}\\right) = -\\frac{S_0}{k} \\left(r + \\frac{\\beta r^3}{R^2}\\right) $$\n对 $r$ 积分：\n$$ r \\frac{dT}{dr} = -\\frac{S_0}{k} \\int \\left(r + \\frac{\\beta r^3}{R^2}\\right) dr = -\\frac{S_0}{k} \\left( \\frac{r^2}{2} + \\frac{\\beta r^4}{4R^2} \\right) + C_1 $$\n第一个边界条件是中心线的对称性，$\\frac{dT}{dr}\\big|_{r=0} = 0$。从上面的方程：\n$$ \\frac{dT}{dr} = -\\frac{S_0}{k} \\left( \\frac{r}{2} + \\frac{\\beta r^3}{4R^2} \\right) + \\frac{C_1}{r} $$\n为了使梯度在 $r=0$ 处为有限（且为零），项 $\\frac{C_1}{r}$ 必须为零，这要求积分常数 $C_1=0$。\n因此，温度梯度为：\n$$ \\frac{dT}{dr} = -\\frac{S_0}{k} \\left( \\frac{r}{2} + \\frac{\\beta r^3}{4R^2} \\right) $$\n再次积分以求得温度分布 $T(r)$：\n$$ T(r) = \\int \\left( -\\frac{S_0}{k} \\left( \\frac{r}{2} + \\frac{\\beta r^3}{4R^2} \\right) \\right) dr = -\\frac{S_0}{k} \\left( \\frac{r^2}{4} + \\frac{\\beta r^4}{16R^2} \\right) + C_2 $$\n为了求第二个积分常数 $C_2$，我们应用在表面 $r=R$ 处的对流边界条件：\n$$ -k\\,\\frac{dT}{dr}\\big|_{r=R} = h\\left(T(R) - T_{\\mathrm{c}}\\right) $$\n左边的项是表面的热通量 $q^{\\prime\\prime}(R)$。单位长度流出的总热量必须等于线热率 $q^{\\prime}$，所以 $q^{\\prime} = q^{\\prime\\prime}(R) \\times (2\\pi R)$。因此，$q^{\\prime\\prime}(R) = -k\\frac{dT}{dr}\\big|_{r=R} = \\frac{q^{\\prime}}{2\\pi R}$。\n将此代入边界条件得到：\n$$ \\frac{q^{\\prime}}{2\\pi R} = h(T(R) - T_c) $$\n这使我们能够解出表面温度 $T(R)$：\n$$ T(R) = T_c + \\frac{q^{\\prime}}{2\\pi R h} $$\n现在我们在 $r=R$ 处计算我们的通用温度剖面，并使其等于 $T(R)$ 的表达式：\n$$ T(R) = -\\frac{S_0}{k} \\left( \\frac{R^2}{4} + \\frac{\\beta R^4}{16R^2} \\right) + C_2 = -\\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) + C_2 $$\n因此，常数 $C_2$ 是：\n$$ C_2 = T(R) + \\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) $$\n中心线温度 $T(0)$ 可通过在温度剖面 $T(r)$ 中令 $r=0$ 得到：\n$$ T(0) = -\\frac{S_0}{k} (0) + C_2 = C_2 $$\n所以，中心线温度是：\n$$ T(0) = T(R) + \\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) $$\n代入 $T(R)$ 和 $S_0$ 的表达式：\n$$ T(0) = \\left( T_c + \\frac{q^{\\prime}}{2\\pi R h} \\right) + \\frac{1}{k} \\left( \\frac{q^{\\prime}}{\\pi R^2 (1 + \\beta/2)} \\right) R^2 \\left( \\frac{4+\\beta}{16} \\right) $$\n$$ T(0) = T_c + \\frac{q^{\\prime}}{2\\pi R h} + \\frac{q^{\\prime}}{16 \\pi k} \\frac{4+\\beta}{1+\\beta/2} $$\n这就是中心线温度的最终符号表达式。\n\n### **数值计算**\n\n我们被给予以下数值：\n$T_c = 570\\ \\mathrm{K}$\n$q^{\\prime} = 1.8\\times 10^{4}\\ \\mathrm{W\\,m^{-1}}$\n$R = 4.0 \\times 10^{-3}\\ \\mathrm{m}$\n$h = 1.0\\times 10^{4}\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n$k = 3.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n$\\beta = 2$\n\n温升包括两部分：从冷却剂到燃料表面的温升（$\\Delta T_{\\text{film}}$）和从燃料表面到中心线的温升（$\\Delta T_{\\text{fuel}}$）。\n\n1.  计算通过有效间隙/包壳膜的温升：\n    $$ \\Delta T_{\\text{film}} = T(R) - T_c = \\frac{q^{\\prime}}{2\\pi R h} = \\frac{1.8 \\times 10^4}{2\\pi (4.0 \\times 10^{-3}) (1.0 \\times 10^4)} = \\frac{1.8 \\times 10^4}{80\\pi} = \\frac{225}{\\pi}\\ \\mathrm{K} $$\n    $$ \\Delta T_{\\text{film}} \\approx 71.6197\\ \\mathrm{K} $$\n\n2.  计算燃料芯块内的温升：\n    $$ \\Delta T_{\\text{fuel}} = T(0) - T(R) = \\frac{q^{\\prime}}{16 \\pi k} \\frac{4+\\beta}{1+\\beta/2} = \\frac{1.8 \\times 10^4}{16\\pi (3.0)} \\frac{4+2}{1+2/2} = \\frac{1.8 \\times 10^4}{48\\pi} \\frac{6}{2} $$\n    $$ \\Delta T_{\\text{fuel}} = \\frac{1.8 \\times 10^4 \\times 3}{48\\pi} = \\frac{5.4 \\times 10^4}{48\\pi} = \\frac{1125}{\\pi}\\ \\mathrm{K} $$\n    $$ \\Delta T_{\\text{fuel}} \\approx 358.0986\\ \\mathrm{K} $$\n\n3.  计算总中心线温度 $T(0)$：\n    $$ T(0) = T_c + \\Delta T_{\\text{film}} + \\Delta T_{\\text{fuel}} = 570\\ \\mathrm{K} + \\frac{225}{\\pi}\\ \\mathrm{K} + \\frac{1125}{\\pi}\\ \\mathrm{K} $$\n    $$ T(0) = 570 + \\frac{1350}{\\pi} \\approx 570 + 429.7183 = 999.7183\\ \\mathrm{K} $$\n\n将最终答案四舍五入到四位有效数字，得到 $999.7\\ \\mathrm{K}$。",
            "answer": "$$\\boxed{999.7}$$"
        },
        {
            "introduction": "反应堆的产热在停堆后不会立即停止；放射性衰变产生的余热是一个关键的安全考量。本动手实践将引导您从裂变产物累积和衰变的第一性原理出发，对这种随时间变化的衰变热进行建模，为您开发一个用于反应堆安全和瞬态分析的基本工具。",
            "id": "4230072",
            "problem": "考虑一个核反应堆中的均匀燃料区，该区域在经过一段时间的恒定运行后，于时间 $t=0$ 停堆。由衰变热引起的体积产热率，记为 $q'''(t)$，单位为 $\\mathrm{W/m^3}$，源于运行期间产生的裂变产物群存量的放射性衰变。建模必须基于第一性原理。具体而言，每个有效裂变产物群 $i$ 的数密度 $N_i(t)$ 在运行期间遵循放射性衰变定律和一个产生项。$N_i(t)$ 的动力学由产生和衰变的平衡所控制，其根源在于粒子数守恒和指数衰变定律。每个群贡献的功率密度与其衰变率乘以每次衰变释放的平均能量成正比。你的任务是，基于这些原理，推导停堆后 $t \\ge 0$ 时 $q'''(t)$ 的显式表达式，假设反应堆在 $-T_{\\mathrm{hist}} \\le t  0$ 期间以恒定的裂变率密度运行，此后无裂变发生。\n\n使用以下物理上一致且科学上合理的参数。所有数值必须严格按照规定使用，并附带所示单位：\n\n- 每次裂变的有效能量 $E_{\\mathrm{fission}} = 200\\,\\mathrm{MeV}$。使用 $1\\,\\mathrm{MeV} = 1.60218\\times 10^{-13}\\,\\mathrm{J}$ 将兆电子伏特转换为焦耳。\n- 存在 $5$ 个有效裂变产物群，每个群的特征在于每次裂变的产额 $y_i$（无量纲，每次裂变最终可归因于群 $i$ 的衰变次数）、半衰期 $t_{1/2,i}$（秒）和每次衰变的平均能量 $E_i$（兆电子伏特）：\n  - 群 $1$：$y_1 = 1.0$， $t_{1/2,1} = 2\\,\\mathrm{s}$， $E_1 = 2.5\\,\\mathrm{MeV}$。\n  - 群 $2$：$y_2 = 1.0$， $t_{1/2,2} = 30\\,\\mathrm{s}$， $E_2 = 3.0\\,\\mathrm{MeV}$。\n  - 群 $3$：$y_3 = 1.0$， $t_{1/2,3} = 300\\,\\mathrm{s}$， $E_3 = 2.5\\,\\mathrm{MeV}$。\n  - 群 $4$：$y_4 = 1.0$， $t_{1/2,4} = 3000\\,\\mathrm{s}$， $E_4 = 3.0\\,\\mathrm{MeV}$。\n  - 群 $5$：$y_5 = 1.0$， $t_{1/2,5} = 30000\\,\\mathrm{s}$， $E_5 = 2.0\\,\\mathrm{MeV}$。\n- 群 $i$ 的衰变常数为 $\\lambda_i = \\ln(2)/t_{1/2,i}$，单位为 $\\mathrm{s^{-1}}$。\n- 在运行期间，裂变率密度为 $f_0$，单位为 $\\mathrm{fissions/(s\\cdot m^3)}$，通过每次裂变的能量关系 $P_{\\mathrm{f}} = f_0 E_{\\mathrm{fission}}$ 与裂变功率密度 $P_{\\mathrm{f}}$ 相关；因此 $f_0 = P_{\\mathrm{f}}/E_{\\mathrm{fission}}$。\n\n假设与要求：\n- 该区域空间上是均匀的，因此体积热源 $q'''(t)$ 仅依赖于时间。\n- 停堆后唯一的热源是指定群的存量放射性衰变。\n- 运行期间每个群的产生率为 $y_i f_0$，单位为 $\\mathrm{(disintegrations/s)/m^3}$，停堆后（$t \\ge 0$）没有产生。\n- 在以 $\\mathrm{W/m^3}$ 为单位计算功率前，所有能量必须转换为焦耳。\n- 所有最终答案以 $\\mathrm{W/m^3}$ 为单位，表示为实数（浮点数）。\n\n从粒子数守恒和指数衰变定律出发，仅用 $y_i$、$\\lambda_i$、$E_i$、$f_0$ 和 $T_{\\mathrm{hist}}$ 推导 $t \\ge 0$ 时 $q'''(t)$ 的表达式。然后实现该表达式，为以下测试套件计算 $q'''(t)$。对每种情况，使用指定的 $P_{\\mathrm{f}}$ 来确定 $f_0$。\n\n测试套件（每种情况提供 $P_{\\mathrm{f}}$（单位 $\\mathrm{W/m^3}$）、$T_{\\mathrm{hist}}$（单位 $\\mathrm{s}$）以及一个查询时间 $t$（单位 $\\mathrm{s}$）的列表）：\n\n- 情况1（一般正常路径，中等功率密度下长时间辐照）：$P_{\\mathrm{f}} = 100\\times 10^6\\,\\mathrm{W/m^3}$， $T_{\\mathrm{hist}} = 86400\\,\\mathrm{s}$，$t \\in \\{0, 10, 100, 1000\\}\\,\\mathrm{s}$。\n- 情况2（停堆边界，低功率密度，单次查询）：$P_{\\mathrm{f}} = 10\\times 10^6\\,\\mathrm{W/m^3}$， $T_{\\mathrm{hist}} = 10^6\\,\\mathrm{s}$，$t \\in \\{0\\}\\,\\mathrm{s}$。\n- 情况3（短时间辐照；存量未完全饱和）：$P_{\\mathrm{f}} = 200\\times 10^6\\,\\mathrm{W/m^3}$， $T_{\\mathrm{hist}} = 60\\,\\mathrm{s}$，$t \\in \\{0, 100, 5000\\}\\,\\mathrm{s}$。\n- 情况4（零运行；健全性检查）：$P_{\\mathrm{f}} = 0\\,\\mathrm{W/m^3}$， $T_{\\mathrm{hist}} = 1000\\,\\mathrm{s}$，$t \\in \\{0, 10\\}\\,\\mathrm{s}$。\n- 情况5（停堆后很长时间；长寿命群占主导）：$P_{\\mathrm{f}} = 50\\times 10^6\\,\\mathrm{W/m^3}$， $T_{\\mathrm{hist}} = 10^6\\,\\mathrm{s}$，$t \\in \\{100000, 500000\\}\\,\\mathrm{s}$。\n\n你的程序应产生单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素对应一个测试用例，并且本身是按给定顺序列出的、在指定查询时间计算出的 $q'''(t)$ 值（单位 $\\mathrm{W/m^3}$）的列表。例如，输出格式必须类似于 $[[q_{1,1},q_{1,2},\\dots],[q_{2,1},\\dots],\\dots]$，行内任何地方都没有空格。所有数值结果必须是单位为 $\\mathrm{W/m^3}$ 的浮点数。",
            "solution": "所述问题在科学上是合理的、自洽的且提法得当的。所有必需的物理参数和数学关系都已提供，以推导反应堆停堆后衰变热产热率的唯一且有意义的解。该问题是反应堆物理学中的一个标准的、可形式化的问题，其基础是放射性衰变和粒子守恒的基本原理。因此，我们可以进行推导和求解。\n\n目标是推导反应堆停堆后时间 $t \\ge 0$ 的体积产热率 $q'''(t)$ 的表达式。这种热量是由先前运行期间积累的裂变产物的放射性衰变产生的。\n\n设 $N_i(t)$ 为时间 $t$ 时第 $i$ 个有效裂变产物群的数密度（单位为 $\\mathrm{atoms/m^3}$）。$N_i(t)$ 的动力学由一个表示产生和损失（衰变）之间平衡的一阶线性常微分方程控制。\n\n**第1步：运行期间的动力学 ($-T_{\\mathrm{hist}} \\le t  0$)**\n\n在运行期间，假定反应堆具有恒定的裂变率密度 $f_0$。每次裂变平均产生 $y_i$ 个第 $i$ 群的原子（或其前体）。因此，群 $i$ 的产生率密度是恒定的，等于 $y_i f_0$。损失机制是放射性衰变，其速率与当前数密度成正比，即 $\\lambda_i N_i(t)$，其中 $\\lambda_i$ 是群 $i$ 的衰变常数。\n\n平衡方程为：\n$$\n\\frac{dN_i(t)}{dt} = \\text{产生率} - \\text{衰变率} = y_i f_0 - \\lambda_i N_i(t)\n$$\n这是一个一阶线性非齐次常微分方程。我们可以通过找到一个特解并将其与齐次方程的解相加来求解。齐次方程 $\\frac{dN_i}{dt} = -\\lambda_i N_i(t)$ 的解为 $C e^{-\\lambda_i t}$。对于常数源项的一个特解是 $N_{i,p} = y_i f_0 / \\lambda_i$。\n因此，通解为：\n$$\nN_i(t) = \\frac{y_i f_0}{\\lambda_i} + C e^{-\\lambda_i t}\n$$\n为了求出积分常数 $C$，我们应用初始条件，即在运行开始时，$t = -T_{\\mathrm{hist}}$，裂变产物的数密度为零：$N_i(-T_{\\mathrm{hist}}) = 0$。\n$$\n0 = \\frac{y_i f_0}{\\lambda_i} + C e^{-\\lambda_i (-T_{\\mathrm{hist}})} \\implies C = -\\frac{y_i f_0}{\\lambda_i} e^{-\\lambda_i T_{\\mathrm{hist}}}\n$$\n将 $C$ 代回通解，得到运行期间（$-T_{\\mathrm{hist}} \\le t  0$）任意时刻 $t$ 的群 $i$ 的数密度：\n$$\nN_i(t) = \\frac{y_i f_0}{\\lambda_i} - \\left(\\frac{y_i f_0}{\\lambda_i} e^{-\\lambda_i T_{\\mathrm{hist}}}\\right) e^{-\\lambda_i t} = \\frac{y_i f_0}{\\lambda_i} \\left(1 - e^{-\\lambda_i (t + T_{\\mathrm{hist}})}\\right)\n$$\n\n**第2步：停堆时的存量 ($t=0$)**\n\n运行期在 $t=0$ 结束。此刻每个裂变产物群的数密度 $N_i(0)$，作为后续衰变阶段的初始条件。我们在第1步推导的表达式中令 $t=0$，求得 $N_i(0)$：\n$$\nN_i(0) = \\frac{y_i f_0}{\\lambda_i} \\left(1 - e^{-\\lambda_i T_{\\mathrm{hist}}}\\right)\n$$\n这个表达式正确地显示了停堆时的存量取决于运行持续时间 $T_{\\mathrm{hist}}$。对于非常长的运行时间（$T_{\\mathrm{hist}} \\to \\infty$），项 $e^{-\\lambda_i T_{\\mathrm{hist}}} \\to 0$，存量接近饱和值 $N_{i,\\text{sat}} = y_i f_0 / \\lambda_i$，此时产生率和衰变率达到平衡。\n\n**第3步：停堆后的动力学 ($t \\ge 0$)**\n\n对于 $t \\ge 0$，裂变过程已经停止，因此产生项 $y_i f_0$ 变为零。控制方程简化为标准的放射性衰变定律：\n$$\n\\frac{dN_i(t)}{dt} = -\\lambda_i N_i(t)\n$$\n该方程在初始条件为第2步的 $N_i(0)$ 下的解为：\n$$\nN_i(t) = N_i(0) e^{-\\lambda_i t}\n$$\n代入 $N_i(0)$ 的表达式：\n$$\nN_i(t) = \\left[ \\frac{y_i f_0}{\\lambda_i} \\left(1 - e^{-\\lambda_i T_{\\mathrm{hist}}}\\right) \\right] e^{-\\lambda_i t}\n$$\n这是停堆后任意时刻 $t$ 的群 $i$ 的数密度。\n\n**第4步：体积产热率 ($q'''(t)$)**\n\n体积产热率，或功率密度，是所有裂变产物群衰变时单位时间单位体积释放的能量总和。对于群 $i$，其活度密度（单位：衰变/秒·立方米）为 $A_i(t) = \\lambda_i N_i(t)$。每次衰变释放平均能量 $E_i$。来自群 $i$ 的功率密度为 $q'''_i(t) = A_i(t) E_i = \\lambda_i N_i(t) E_i$。\n\n总体积产热率是所有群的总和：\n$$\nq'''(t) = \\sum_{i} q'''_i(t) = \\sum_{i} \\lambda_i N_i(t) E_i\n$$\n代入第3步中 $N_i(t)$ 的表达式：\n$$\nq'''(t) = \\sum_{i} \\lambda_i \\left[ \\frac{y_i f_0}{\\lambda_i} \\left(1 - e^{-\\lambda_i T_{\\mathrm{hist}}}\\right) e^{-\\lambda_i t} \\right] E_i\n$$\n衰变常数 $\\lambda_i$ 恰好从表达式中消去：\n$$\nq'''(t) = \\sum_{i} y_i f_0 E_i \\left(1 - e^{-\\lambda_i T_{\\mathrm{hist}}}\\right) e^{-\\lambda_i t}\n$$\n最后，我们代入指定的裂变功率密度 $P_{\\mathrm{f}}$ 和裂变率密度 $f_0$ 之间的关系，即 $f_0 = P_{\\mathrm{f}} / E_{\\mathrm{fission}}$。\n$$\nq'''(t) = \\sum_{i} y_i \\left(\\frac{P_{\\mathrm{f}}}{E_{\\mathrm{fission}}}\\right) E_i \\left(1 - e^{-\\lambda_i T_{\\mathrm{hist}}}\\right) e^{-\\lambda_i t}\n$$\n这就是需要实现的最终表达式。在计算中，所有能量值（$E_i$，$E_{\\mathrm{fission}}$）必须从 $\\mathrm{MeV}$ 转换为焦耳，并且衰变常数由半衰期计算得出，即 $\\lambda_i = \\ln(2)/t_{1/2,i}$。计算将通过为每个指定的测试用例评估此总和来进行。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the decay heat generation rate in a nuclear reactor fuel region\n    after shutdown based on a first-principles derivation.\n    \"\"\"\n    # Define physical constants.\n    E_FISSION_MEV = 200.0  # MeV per fission\n    MEV_TO_J = 1.60218e-13  # Joules per MeV\n    E_FISSION_J = E_FISSION_MEV * MEV_TO_J  # J per fission\n\n    # Define the 5 effective fission product groups.\n    # Data format: (yield y_i, half-life t_1/2,i (s), energy E_i (MeV))\n    groups_data = [\n        (1.0, 2.0, 2.5),\n        (1.0, 30.0, 3.0),\n        (1.0, 300.0, 2.5),\n        (1.0, 3000.0, 3.0),\n        (1.0, 30000.0, 2.0),\n    ]\n\n    # Convert group data to NumPy arrays for vectorized calculations.\n    num_groups = len(groups_data)\n    y = np.array([g[0] for g in groups_data])\n    t_half = np.array([g[1] for g in groups_data])\n    E_i_MeV = np.array([g[2] for g in groups_data])\n\n    # Pre-calculate derived constants in SI units.\n    E_i_J = E_i_MeV * MEV_TO_J  # Energy per disintegration in Joules\n    lambda_i = np.log(2) / t_half  # Decay constants in s^-1\n\n    # Define the test cases from the problem statement.\n    # Format: (fission power density P_f (W/m^3), history time T_hist (s), query times t (s))\n    test_cases = [\n        (100e6, 86400.0, [0.0, 10.0, 100.0, 1000.0]),\n        (10e6, 1e6, [0.0]),\n        (200e6, 60.0, [0.0, 100.0, 5000.0]),\n        (0.0, 1000.0, [0.0, 10.0]),\n        (50e6, 1e6, [100000.0, 500000.0]),\n    ]\n\n    overall_results = []\n    for P_f, T_hist, t_queries in test_cases:\n        case_results = []\n\n        # Calculate fission rate density f0. If P_f is 0, f0 is 0.\n        if P_f == 0.0:\n            f0 = 0.0\n        else:\n            f0 = P_f / E_FISSION_J  # fissions / (s * m^3)\n\n        # Pre-calculate the saturation factor, which is constant for a given case.\n        # This factor represents the fraction of saturation inventory achieved.\n        saturation_factor = 1.0 - np.exp(-lambda_i * T_hist)\n        \n        # Calculate the constant part of the q''' term for each group.\n        # q'''(t) = SUM_i [ C_i * exp(-lambda_i * t) ]\n        # where C_i = y_i * f0 * E_i_J * saturation_factor_i\n        C_i_terms = y * f0 * E_i_J * saturation_factor\n\n        for t in t_queries:\n            # Calculate the decay factor for the current query time t.\n            decay_factor = np.exp(-lambda_i * t)\n            \n            # Calculate the heat generation rate from each group at time t.\n            q_per_group = C_i_terms * decay_factor\n            \n            # Sum the contributions from all groups to get the total heat rate.\n            q_total = np.sum(q_per_group)\n            \n            case_results.append(q_total)\n            \n        overall_results.append(case_results)\n\n    # Format the final output string exactly as specified: [[r1,r2],[r3],...]\n    formatted_cases = []\n    for res_list in overall_results:\n        formatted_list = f\"[{','.join(map(str, res_list))}]\"\n        formatted_cases.append(formatted_list)\n    \n    final_output_string = f\"[{','.join(formatted_cases)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}