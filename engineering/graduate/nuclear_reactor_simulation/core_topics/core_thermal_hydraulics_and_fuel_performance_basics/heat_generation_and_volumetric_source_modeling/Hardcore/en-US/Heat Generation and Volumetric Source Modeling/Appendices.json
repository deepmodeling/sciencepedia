{
    "hands_on_practices": [
        {
            "introduction": "To understand the thermal performance of a nuclear reactor, we begin with the most fundamental building block: the temperature profile within a fuel element under idealized conditions. This exercise explores steady-state heat conduction in simple geometries assuming a uniform volumetric heat source, which is a common first approximation for fission power. By deriving and applying analytical solutions for these canonical cases, you will gain crucial physical insight into how factors like fuel geometry, thermal conductivity, and cooling conditions govern the peak temperature, a primary constraint in reactor design and safety analysis .",
            "id": "4230060",
            "problem": "A nuclear fuel element undergoing fission can be idealized as a one-dimensional (1D) body with uniform volumetric heat generation. In steady state, heat is removed at the surface either by convection to a coolant or by maintaining a fixed surface temperature. Starting from conservation of energy and the constitutive relation of Fourier’s law for heat conduction, derive analytical expressions for the steady-state temperature distribution in three canonical geometries: a slab (planar), a solid cylinder (radial), and a solid sphere (radial), each with uniform volumetric heat generation. Use symmetry at the centerline and physically consistent boundary conditions at the outer surface. Then design a program to evaluate, for given parameter sets, the centerline temperature and the surface heat flux.\n\nFundamental basis and assumptions to employ:\n- Energy conservation in a differential control volume under steady conditions, with constant thermal conductivity and uniform volumetric heat generation.\n- Fourier’s law of heat conduction relating heat flux to temperature gradient.\n- Symmetry at the center ($dT/dx = 0$ or $dT/dr = 0$ at $x=0$ or $r=0$).\n- At the surface, either a convective boundary condition with fluid at temperature $T_\\infty$ and convection coefficient $h$, or a fixed surface temperature $T_s$.\n\nYou must:\n1. Derive for each geometry the analytical expressions that permit computation of the centerline temperature $T(0)$ and the surface heat flux $q''$ in terms of the geometry size, thermal conductivity, volumetric heat generation, and boundary parameters.\n2. Implement a program that, for each test case specified below, computes:\n   - The centerline temperature in $\\mathrm{K}$.\n   - The outward surface heat flux in $\\mathrm{W/m^2}$.\n3. Express the final output as a single line containing a comma-separated list enclosed in square brackets. The list must contain, for each test case in order, first the centerline temperature in $\\mathrm{K}$, then the surface heat flux in $\\mathrm{W/m^2}$. Round each floating-point result to six decimal places.\n\nGeometry conventions:\n- Slab: model half-thickness domain $0 \\le x \\le L$ with symmetry at $x=0$ and boundary at $x=L$.\n- Cylinder: model radial domain $0 \\le r \\le R$ with symmetry at $r=0$ and boundary at $r=R$.\n- Sphere: model radial domain $0 \\le r \\le R$ with symmetry at $r=0$ and boundary at $r=R$.\n\nUnits:\n- Thermal conductivity $k$ in $\\mathrm{W/(m\\cdot K)}$.\n- Volumetric heat generation $q'''$ in $\\mathrm{W/m^3}$.\n- Convection coefficient $h$ in $\\mathrm{W/(m^2\\cdot K)}$.\n- Lengths $L$ or $R$ in $\\mathrm{m}$.\n- Temperatures $T_\\infty$ and $T_s$ in $\\mathrm{K}$.\n- Heat flux $q''$ in $\\mathrm{W/m^2}$.\n\nTest suite:\n- Case $1$ (slab, convective boundary): $L = 0.005\\,\\mathrm{m}$, $k = 20\\,\\mathrm{W/(m\\cdot K)}$, $q''' = 1.5\\times 10^8\\,\\mathrm{W/m^3}$, $h = 12000\\,\\mathrm{W/(m^2\\cdot K)}$, $T_\\infty = 570\\,\\mathrm{K}$.\n- Case $2$ (cylinder, fixed surface temperature): $R = 0.004\\,\\mathrm{m}$, $k = 3\\,\\mathrm{W/(m\\cdot K)}$, $q''' = 5.0\\times 10^8\\,\\mathrm{W/m^3}$, $T_s = 620\\,\\mathrm{K}$.\n- Case $3$ (sphere, convective boundary): $R = 0.010\\,\\mathrm{m}$, $k = 15\\,\\mathrm{W/(m\\cdot K)}$, $q''' = 2.0\\times 10^7\\,\\mathrm{W/m^3}$, $h = 8000\\,\\mathrm{W/(m^2\\cdot K)}$, $T_\\infty = 350\\,\\mathrm{K}$.\n- Case $4$ (slab, convective boundary, zero generation edge case): $L = 0.003\\,\\mathrm{m}$, $k = 12\\,\\mathrm{W/(m\\cdot K)}$, $q''' = 0\\,\\mathrm{W/m^3}$, $h = 10000\\,\\mathrm{W/(m^2\\cdot K)}$, $T_\\infty = 300\\,\\mathrm{K}$.\n\nFinal output format:\n- Your program should produce a single line containing the results as a comma-separated list enclosed in square brackets, ordered as:\n  $[T_{\\text{center,case1}}, q''_{\\text{surface,case1}}, T_{\\text{center,case2}}, q''_{\\text{surface,case2}}, T_{\\text{center,case3}}, q''_{\\text{surface,case3}}, T_{\\text{center,case4}}, q''_{\\text{surface,case4}}]$,\n  with each value rounded to six decimal places and units as specified above.",
            "solution": "The problem requires the derivation of analytical expressions for steady-state temperature distribution and heat flux in canonical one-dimensional geometries (planar slab, cylinder, sphere) with uniform volumetric heat generation, followed by a computational implementation. The analysis begins from the first principles of energy conservation.\n\nThe governing equation for steady-state heat conduction with a uniform volumetric heat source $q'''$ and constant thermal conductivity $k$ is derived from an energy balance on a differential control volume. It is a specific form of the Poisson equation:\n$$ \\nabla^2 T = -\\frac{q'''}{k} $$\nHere, $T$ is the temperature and $\\nabla^2$ is the Laplacian operator. We will solve this equation for each geometry subject to the specified boundary conditions.\n\n### General Derivation Procedure\nFor each geometry, the procedure is as follows:\n1.  Express the heat equation in the appropriate coordinate system.\n2.  Integrate the equation twice to obtain the general solution for the temperature profile $T(y)$, where $y$ is the spatial coordinate ($x$ for slab, $r$ for cylinder/sphere). This introduces two integration constants, $C_1$ and $C_2$.\n3.  Apply the first boundary condition, which is symmetry at the center ($x=0$ or $r=0$). This states that the temperature gradient is zero, $\\frac{dT}{dy}|_{y=0}=0$, which determines the first constant $C_1$.\n4.  The second constant, $C_2$, is determined by the boundary condition at the outer surface. The centerline temperature $T(0)$ is directly related to $C_2$.\n5.  Two types of outer boundary conditions are considered:\n    a. Fixed temperature $T_s$ at the surface.\n    b. Convection to a fluid at temperature $T_\\infty$ with a heat transfer coefficient $h$. This condition is expressed by Newton's law of cooling, which equates the conductive heat flux at the surface to the convective heat flux: $q''_s = -k \\frac{dT}{dy}|_{surface} = h(T_{surface} - T_\\infty)$.\n6.  The surface heat flux, $q''_s$, can be determined either from Fourier's law, $q''_s = -k \\frac{dT}{dy}|_{surface}$, or by a global energy balance: in steady state, the total heat generated within the volume must be removed at the surface. Per unit area, this gives $q''_s = (q''' \\times \\text{Volume}) / (\\text{Surface Area})$.\n\n### 1. Planar Slab Geometry\nFor a slab of half-thickness $L$, we consider the domain $0 \\le x \\le L$. The heat equation in one-dimensional Cartesian coordinates is:\n$$ \\frac{d^2T}{dx^2} = -\\frac{q'''}{k} $$\nIntegrating once with respect to $x$:\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k}x + C_1 $$\nApplying the symmetry boundary condition at the centerline, $\\frac{dT}{dx}|_{x=0} = 0$, gives $C_1 = 0$. The temperature gradient is:\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k}x $$\nIntegrating a second time:\n$$ T(x) = -\\frac{q'''}{2k}x^2 + C_2 $$\nThe centerline temperature is $T(0) = C_2$.\n\n**Surface Heat Flux $q''_s$**: A global energy balance on the half-slab (volume per unit area is $L$) dictates that the heat generated per unit area, $q'''L$, must exit at the surface $x=L$. Thus,\n$$ q''_s = q'''L $$\nThis result is independent of the boundary condition type. It can be verified using Fourier's law once $T(x)$ is known: $q''_s = -k \\frac{dT}{dx}|_{x=L} = -k(-\\frac{q'''}{k}L) = q'''L$.\n\n**Centerline Temperature $T(0)$**:\na) **Fixed Surface Temperature**: At $x=L$, $T(L) = T_s$.\n$$ T(L) = T_s = -\\frac{q'''L^2}{2k} + C_2 $$\nSolving for $C_2$ gives the centerline temperature:\n$$ T(0) = C_2 = T_s + \\frac{q'''L^2}{2k} $$\nb) **Convective Boundary**: At $x=L$, $-k\\frac{dT}{dx}|_{x=L} = h(T(L) - T_\\infty)$. We know $q''_s = -k\\frac{dT}{dx}|_{x=L} = q'''L$. Thus, $q'''L = h(T(L) - T_\\infty)$, which gives the surface temperature $T(L) = T_\\infty + \\frac{q'''L}{h}$.\nSubstituting $T(L)$ into the general temperature profile expression at $x=L$:\n$$ T(L) = T_\\infty + \\frac{q'''L}{h} = -\\frac{q'''L^2}{2k} + C_2 $$\nSolving for $C_2$ gives the centerline temperature:\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k} = T_\\infty + q'''L\\left(\\frac{1}{h} + \\frac{L}{2k}\\right) $$\n\n### 2. Solid Cylinder Geometry\nFor a solid cylinder of radius $R$, we consider the domain $0 \\le r \\le R$. The heat equation in one-dimensional cylindrical coordinates is:\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{dT}{dr}\\right) = -\\frac{q'''}{k} $$\nIntegrating once yields:\n$$ r\\frac{dT}{dr} = -\\frac{q'''}{2k}r^2 + C_1 $$\nApplying the symmetry condition $\\frac{dT}{dr}|_{r=0} = 0$ (or, equivalently, requiring the temperature to be finite at $r=0$), we must have $C_1=0$.\n$$ \\frac{dT}{dr} = -\\frac{q'''}{2k}r $$\nIntegrating a second time:\n$$ T(r) = -\\frac{q'''}{4k}r^2 + C_2 $$\nThe centerline temperature is $T(0) = C_2$.\n\n**Surface Heat Flux $q''_s$**: An energy balance on a cylinder of length $H$ gives: Volume $V = \\pi R^2 H$, Surface Area $A = 2\\pi R H$. The total heat generated is $q'''V$. The surface flux is $q''_s = (q'''V)/A = (q'''\\pi R^2 H) / (2\\pi R H)$. Thus,\n$$ q''_s = \\frac{q'''R}{2} $$\nThis is confirmed by Fourier's law: $q''_s = -k \\frac{dT}{dr}|_{r=R} = -k(-\\frac{q'''}{2k}R) = \\frac{q'''R}{2}$.\n\n**Centerline Temperature $T(0)$**:\na) **Fixed Surface Temperature**: At $r=R$, $T(R)=T_s$.\n$$ T(R) = T_s = -\\frac{q'''R^2}{4k} + C_2 $$\n$$ T(0) = C_2 = T_s + \\frac{q'''R^2}{4k} $$\nb) **Convective Boundary**: At $r=R$, $q''_s = h(T(R) - T_\\infty)$. So, $\\frac{q'''R}{2} = h(T(R) - T_\\infty)$, which gives $T(R) = T_\\infty + \\frac{q'''R}{2h}$.\nSubstituting this into the profile at $r=R$:\n$$ T(R) = T_\\infty + \\frac{q'''R}{2h} = -\\frac{q'''R^2}{4k} + C_2 $$\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''R}{2h} + \\frac{q'''R^2}{4k} = T_\\infty + \\frac{q'''R}{2}\\left(\\frac{1}{h} + \\frac{R}{2k}\\right) $$\n\n### 3. Solid Sphere Geometry\nFor a solid sphere of radius $R$, we consider the domain $0 \\le r \\le R$. The heat equation in one-dimensional spherical coordinates is:\n$$ \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2\\frac{dT}{dr}\\right) = -\\frac{q'''}{k} $$\nIntegrating once:\n$$ r^2\\frac{dT}{dr} = -\\frac{q'''}{3k}r^3 + C_1 $$\nThe symmetry condition $\\frac{dT}{dr}|_{r=0} = 0$ requires $C_1=0$.\n$$ \\frac{dT}{dr} = -\\frac{q'''}{3k}r $$\nIntegrating a second time:\n$$ T(r) = -\\frac{q'''}{6k}r^2 + C_2 $$\nThe centerline temperature is $T(0) = C_2$.\n\n**Surface Heat Flux $q''_s$**: An energy balance gives: Volume $V = \\frac{4}{3}\\pi R^3$, Surface Area $A = 4\\pi R^2$. The surface flux is $q''_s = (q'''V)/A = (q'''\\frac{4}{3}\\pi R^3) / (4\\pi R^2)$.\n$$ q''_s = \\frac{q'''R}{3} $$\nThis is confirmed by Fourier's law: $q''_s = -k \\frac{dT}{dr}|_{r=R} = -k(-\\frac{q'''}{3k}R) = \\frac{q'''R}{3}$.\n\n**Centerline Temperature $T(0)$**:\na) **Fixed Surface Temperature**: At $r=R$, $T(R)=T_s$.\n$$ T(R) = T_s = -\\frac{q'''R^2}{6k} + C_2 $$\n$$ T(0) = C_2 = T_s + \\frac{q'''R^2}{6k} $$\nb) **Convective Boundary**: At $r=R$, $q''_s = h(T(R) - T_\\infty)$. So, $\\frac{q'''R}{3} = h(T(R) - T_\\infty)$, which gives $T(R) = T_\\infty + \\frac{q'''R}{3h}$.\nSubstituting this into the profile at $r=R$:\n$$ T(R) = T_\\infty + \\frac{q'''R}{3h} = -\\frac{q'''R^2}{6k} + C_2 $$\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''R}{3h} + \\frac{q'''R^2}{6k} = T_\\infty + \\frac{q'''R}{3}\\left(\\frac{1}{h} + \\frac{R}{2k}\\right) $$\n\nThese derived formulae are now implemented to solve the provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes centerline temperature and surface heat flux for various\n    geometries and boundary conditions in steady-state heat conduction.\n    \"\"\"\n    \n    # Test cases are structured as dictionaries for clarity.\n    # 'geom': 'slab', 'cylinder', 'sphere'\n    # 'bc_type': 'conv', 'fixed_T'\n    # 'params': dictionary of physical and geometrical parameters\n    test_cases_data = [\n        {\n            \"geom\": \"slab\", \"bc_type\": \"conv\", \n            \"params\": {\"L\": 0.005, \"k\": 20.0, \"q_gen\": 1.5e8, \"h\": 12000.0, \"T_inf\": 570.0}\n        },\n        {\n            \"geom\": \"cylinder\", \"bc_type\": \"fixed_T\", \n            \"params\": {\"R\": 0.004, \"k\": 3.0, \"q_gen\": 5.0e8, \"T_s\": 620.0}\n        },\n        {\n            \"geom\": \"sphere\", \"bc_type\": \"conv\", \n            \"params\": {\"R\": 0.010, \"k\": 15.0, \"q_gen\": 2.0e7, \"h\": 8000.0, \"T_inf\": 350.0}\n        },\n        {\n            \"geom\": \"slab\", \"bc_type\": \"conv\", \n            \"params\": {\"L\": 0.003, \"k\": 12.0, \"q_gen\": 0.0, \"h\": 10000.0, \"T_inf\": 300.0}\n        }\n    ]\n\n    results = []\n\n    for case in test_cases_data:\n        geom = case[\"geom\"]\n        bc_type = case[\"bc_type\"]\n        p = case[\"params\"]\n        \n        T_center = 0.0\n        q_surface = 0.0\n\n        if geom == \"slab\":\n            # Surface heat flux from energy balance: q_s = q''' * L\n            q_surface = p[\"q_gen\"] * p[\"L\"]\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q'''*L/h + q'''*L^2/(2*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"L\"]**2 / (2 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*L^2/(2*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"L\"]**2 / (2 * p[\"k\"])\n\n        elif geom == \"cylinder\":\n            # Surface heat flux from energy balance: q_s = q''' * R / 2\n            q_surface = p[\"q_gen\"] * p[\"R\"] / 2\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q_s/h + q'''*R^2/(4*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"R\"]**2 / (4 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*R^2/(4*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"R\"]**2 / (4 * p[\"k\"])\n\n        elif geom == \"sphere\":\n            # Surface heat flux from energy balance: q_s = q''' * R / 3\n            q_surface = p[\"q_gen\"] * p[\"R\"] / 3\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q_s/h + q'''*R^2/(6*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"R\"]**2 / (6 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*R^2/(6*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"R\"]**2 / (6 * p[\"k\"])\n                \n        results.append(T_center)\n        results.append(q_surface)\n\n    # Format the final output string exactly as required, with rounding to six decimal places.\n    # Using format specifier f\"{x:.6f}\" ensures trailing zeros.\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Building upon the uniform source model, this practice introduces a critical layer of physical realism. In an operating reactor, the fission rate is not uniform across a fuel pellet due to phenomena like neutron flux depression, leading to a radially dependent power profile. This exercise challenges you to model such a non-uniform volumetric heat source, $q'''(r)$, and derive the resulting temperature distribution . Solving the heat diffusion equation with this more complex source term is essential for accurately predicting peak fuel temperatures, which are highly sensitive to the power distribution.",
            "id": "4230065",
            "problem": "A right circular cylinder of uranium dioxide fuel (radius $R$) is modeled as a homogeneous, isotropic solid with constant thermal conductivity $k$ under steady-state conditions. Fission power is generated volumetrically with a radially varying source density $q^{\\prime\\prime\\prime}(r)$ due to resonance self-shielding and rim peaking in an operating light water reactor. The volumetric source is approximated by the form $q^{\\prime\\prime\\prime}(r) = S_{0}\\left(1 + \\beta \\frac{r^{2}}{R^{2}}\\right)$, where $S_{0}$ is an unknown normalization constant and $\\beta$ is a given dimensionless parameter. The total heat generated per unit length of the fuel rod, known as the linear heat rate $q^{\\prime}$, must equal the cross-sectional integral of $q^{\\prime\\prime\\prime}(r)$. Heat removal at the fuel surface is represented by an effective convective boundary condition at $r=R$, $-k\\,\\frac{dT}{dr}\\big|_{r=R} = h\\left(T(R) - T_{\\mathrm{c}}\\right)$, where $h$ is an effective heat transfer coefficient accounting for the solid gap and cladding heat transfer to the coolant, and $T_{\\mathrm{c}}$ is the coolant bulk temperature. Symmetry requires the temperature gradient to remain finite at $r=0$.\n\nStarting from the steady-state energy conservation in cylindrical coordinates with volumetric heat generation and Fourier’s law of heat conduction, derive the temperature distribution and compute the centerline temperature $T(0)$.\n\nUse the values $R = 4.0\\ \\mathrm{mm}$, $k = 3.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$, $h = 1.0\\times 10^{4}\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$, $T_{\\mathrm{c}} = 570\\ \\mathrm{K}$, $q^{\\prime} = 1.8\\times 10^{4}\\ \\mathrm{W\\,m^{-1}}$, and $\\beta = 2$.\n\nRound your final answer to four significant figures. Express the final temperature in kelvin.",
            "solution": "The problem requires solving the steady-state heat diffusion equation in a cylindrical fuel rod with a radially non-uniform volumetric heat source. The goal is to find the centerline temperature $T(0)$.\n\nThe governing equation for steady-state heat conduction in cylindrical coordinates with constant thermal conductivity $k$ is:\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) = -\\frac{q^{\\prime\\prime\\prime}(r)}{k} $$\nThe volumetric heat source is given as $q^{\\prime\\prime\\prime}(r) = S_{0}\\left(1 + \\beta \\frac{r^{2}}{R^{2}}\\right)$.\n\n**Step 1: Determine the normalization constant $S_0$.**\nThe linear heat rate $q^{\\prime}$ is the integral of the volumetric source over the cross-sectional area. This relationship is used to find $S_0$.\n$$ q^{\\prime} = \\int_{0}^{R} q^{\\prime\\prime\\prime}(r) (2\\pi r) dr = 2\\pi S_0 \\int_{0}^{R} \\left(r + \\frac{\\beta r^3}{R^2}\\right) dr $$\n$$ q^{\\prime} = 2\\pi S_0 \\left[ \\frac{r^2}{2} + \\frac{\\beta r^4}{4R^2} \\right]_{0}^{R} = 2\\pi S_0 \\left( \\frac{R^2}{2} + \\frac{\\beta R^2}{4} \\right) = \\pi S_0 R^2 \\left(1 + \\frac{\\beta}{2}\\right) $$\nSolving for $S_0$:\n$$ S_0 = \\frac{q^{\\prime}}{\\pi R^2 (1 + \\beta/2)} $$\n\n**Step 2: Solve the heat equation for the temperature profile $T(r)$.**\nSubstitute the expression for $q^{\\prime\\prime\\prime}(r)$ into the heat equation and integrate once with respect to $r$:\n$$ \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) = -\\frac{r}{k} S_0 \\left(1 + \\frac{\\beta r^2}{R^2}\\right) = -\\frac{S_0}{k} \\left(r + \\frac{\\beta r^3}{R^2}\\right) $$\n$$ r \\frac{dT}{dr} = -\\frac{S_0}{k} \\left( \\frac{r^2}{2} + \\frac{\\beta r^4}{4R^2} \\right) + C_1 $$\nThe symmetry boundary condition at the centerline, $\\frac{dT}{dr}\\big|_{r=0} = 0$, requires the integration constant $C_1=0$.\n$$ \\frac{dT}{dr} = -\\frac{S_0}{k} \\left( \\frac{r}{2} + \\frac{\\beta r^3}{4R^2} \\right) $$\nIntegrate again to find the temperature distribution $T(r)$:\n$$ T(r) = -\\frac{S_0}{k} \\left( \\frac{r^2}{4} + \\frac{\\beta r^4}{16R^2} \\right) + C_2 $$\nThe centerline temperature is $T(0) = C_2$.\n\n**Step 3: Apply the surface boundary condition to find $C_2$.**\nThe convective boundary condition at $r=R$ is $-k\\,\\frac{dT}{dr}\\big|_{r=R} = h\\left(T(R) - T_{\\mathrm{c}}\\right)$. The left-hand side is the surface heat flux, $q^{\\prime\\prime}(R)$. By energy conservation, the total heat generated per unit length, $q'$, must equal the heat flux integrated over the surface area per unit length, $q^{\\prime} = q^{\\prime\\prime}(R) \\times 2\\pi R$. Therefore, $q^{\\prime\\prime}(R) = \\frac{q^{\\prime}}{2\\pi R}$. The boundary condition becomes:\n$$ \\frac{q^{\\prime}}{2\\pi R} = h(T(R) - T_c) $$\nThis allows us to find the surface temperature, $T(R)$:\n$$ T(R) = T_c + \\frac{q^{\\prime}}{2\\pi R h} $$\nNow, evaluate the general temperature profile at $r=R$ and equate it to this result:\n$$ T(R) = -\\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) + C_2 $$\nSolving for the integration constant $C_2$, which is the centerline temperature $T(0)$:\n$$ T(0) = C_2 = T(R) + \\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) $$\nSubstituting the expressions for $T(R)$ and $S_0$ gives the final analytical expression:\n$$ T(0) = \\left( T_c + \\frac{q^{\\prime}}{2\\pi R h} \\right) + \\frac{1}{k} \\left( \\frac{q^{\\prime}}{\\pi R^2 (1 + \\beta/2)} \\right) R^2 \\left( \\frac{4+\\beta}{16} \\right) $$\n$$ T(0) = T_c + \\frac{q^{\\prime}}{2\\pi R h} + \\frac{q^{\\prime}}{16 \\pi k} \\frac{4+\\beta}{1+\\beta/2} $$\n\n**Step 4: Numerical Calculation.**\nUsing the given values: $T_c = 570\\ \\mathrm{K}$, $q^{\\prime} = 1.8\\times 10^{4}\\ \\mathrm{W\\,m^{-1}}$, $R = 4.0 \\times 10^{-3}\\ \\mathrm{m}$, $h = 1.0\\times 10^{4}\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$, $k = 3.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\beta = 2$.\n\nThe temperature rise across the convective boundary is:\n$$ \\Delta T_{\\text{film}} = T(R) - T_c = \\frac{q^{\\prime}}{2\\pi R h} = \\frac{1.8 \\times 10^4}{2\\pi (4.0 \\times 10^{-3}) (1.0 \\times 10^4)} \\approx 71.6197\\ \\mathrm{K} $$\nThe temperature rise within the fuel pellet is:\n$$ \\Delta T_{\\text{fuel}} = T(0) - T(R) = \\frac{q^{\\prime}}{16 \\pi k} \\frac{4+\\beta}{1+\\beta/2} = \\frac{1.8 \\times 10^4}{16\\pi (3.0)} \\frac{4+2}{1+2/2} = \\frac{1.8 \\times 10^4}{48\\pi} \\frac{6}{2} \\approx 358.0986\\ \\mathrm{K} $$\nThe total centerline temperature is the sum of the coolant temperature and these two temperature rises:\n$$ T(0) = T_c + \\Delta T_{\\text{film}} + \\Delta T_{\\text{fuel}} = 570 + 71.6197 + 358.0986 = 999.7183\\ \\mathrm{K} $$\nRounding to four significant figures gives $999.7\\ \\mathrm{K}$.",
            "answer": "$$\\boxed{999.7}$$"
        },
        {
            "introduction": "Our final practice moves from static models to the dynamic, long-term evolution of the heat source itself. The composition of nuclear fuel, and therefore its heat generation rate, changes significantly over its lifetime in a process known as burnup. This advanced simulation requires you to couple reactor physics with heat transfer by modeling the transmutation of key isotopes—the consumption of $^{235}$U and the breeding of $^{239}$Pu—using the Bateman equations . This practice provides a capstone experience, demonstrating how to model the time-dependent heat source driven by the fuel's irradiation history, a cornerstone of comprehensive fuel performance analysis.",
            "id": "4230052",
            "problem": "A single-region fuel model is considered in which isotopic number densities evolve under a time-independent neutron flux and produce a volumetric heat source through fission energy deposition. The objective is to compute, for several parameter sets, the burnup-dependent volumetric heat source and the isotopic inventory evolution, and to report specific scalar outputs. All computations must be based on first principles of reaction-rate theory and radioactive decay, without invoking empirical shortcut formulas.\n\nFundamental base:\n- The reaction rate density definition: for isotope $i$, the reaction rate density due to process $p$ is $R_{i,p}(t)=\\phi\\,\\sigma_{i,p}\\,N_i(t)$, where $\\phi$ is the scalar neutron flux in $\\mathrm{m^{-2}\\,s^{-1}}$, $\\sigma_{i,p}$ is the microscopic cross section in $\\mathrm{m^2}$, and $N_i(t)$ is the number density in $\\mathrm{m^{-3}}$.\n- The ordinary differential equations (Bateman-type) governing number density changes: each isotope’s time derivative is the sum of source terms minus sink terms, according to reaction rates and radioactive decay.\n- The volumetric heat source is the fission energy deposited per unit volume and time: if $E_{\\mathrm{f}}$ is the energy released per fission in $\\mathrm{J}$ and $\\eta_{\\mathrm{dep}}$ is the deposited energy fraction (dimensionless), then $q'''(t)=\\eta_{\\mathrm{dep}}\\,E_{\\mathrm{f}}\\sum_{i}R_{i,\\mathrm{f}}(t)$, where the sum is over fissile isotopes.\n- Burnup is the time integral of volumetric energy generation per unit mass: $B(t)=\\dfrac{1}{\\rho_{\\mathrm{fuel}}}\\int_{0}^{t}q'''(\\tau)\\,d\\tau$, with $\\rho_{\\mathrm{fuel}}$ the fuel mass density in $\\mathrm{kg\\,m^{-3}}$.\n\nModel and isotopes:\n- Isotopes tracked are $^{235}$U, $^{238}$U, $^{239}$Np, and $^{239}$Pu.\n- Processes included:\n  - For $^{235}$U: fission and capture.\n  - For $^{238}$U: capture to $^{239}$Np.\n  - For $^{239}$Np: radioactive $\\beta^{-}$ decay to $^{239}$Pu.\n  - For $^{239}$Pu: fission and capture.\n- The neutron flux $\\phi$ is constant in time, and one-group (energy-averaged) microscopic cross sections are constant.\n\nGoverning equations to be constructed from first principles:\n- Let $N_{235}(t)$, $N_{238}(t)$, $N_{\\mathrm{Np}}(t)$, and $N_{\\mathrm{Pu}}(t)$ denote number densities. Using the reaction-rate definition and radioactive decay law, derive and integrate the coupled system\n  - $\\dfrac{dN_{235}}{dt}=\\text{(loss by fission)}+\\text{(loss by capture)}$,\n  - $\\dfrac{dN_{238}}{dt}=\\text{(loss by capture)}$,\n  - $\\dfrac{dN_{\\mathrm{Np}}}{dt}=\\text{(production by $^{238}$U capture)}-\\text{(loss by decay)}$,\n  - $\\dfrac{dN_{\\mathrm{Pu}}}{dt}=\\text{(production by $^{239}$Np decay)}-\\text{(loss by fission)}-\\text{(loss by capture)}$.\n- Express $q'''(t)$ from the definition of energy deposition and the fission rate density contributions of $^{235}$U and $^{239}$Pu.\n- Express $B(t)$ from its defining integral of $q'''(t)$ over time divided by mass density.\n\nConstants to be used (all values are fixed and must be used exactly as given):\n- Fission energy per fission: $E_{\\mathrm{f}}=3.204\\times 10^{-11}\\ \\mathrm{J}$.\n- Deposited energy fraction: $\\eta_{\\mathrm{dep}}=0.95$.\n- Fuel mass density: $\\rho_{\\mathrm{fuel}}=10970\\ \\mathrm{kg\\,m^{-3}}$.\n- Microscopic cross sections (one-group, thermal):\n  - $\\sigma_{235,\\mathrm{f}}=5.80\\times 10^{-26}\\ \\mathrm{m^2}$,\n  - $\\sigma_{235,\\mathrm{c}}=1.00\\times 10^{-26}\\ \\mathrm{m^2}$,\n  - $\\sigma_{238,\\mathrm{c}}=2.70\\times 10^{-28}\\ \\mathrm{m^2}$,\n  - $\\sigma_{\\mathrm{Pu},\\mathrm{f}}=7.42\\times 10^{-26}\\ \\mathrm{m^2}$,\n  - $\\sigma_{\\mathrm{Pu},\\mathrm{c}}=2.70\\times 10^{-26}\\ \\mathrm{m^2}$.\n- $^{239}$Np half-life: $T_{1/2,\\mathrm{Np}}=2.356\\ \\mathrm{days}$, with decay constant $\\lambda_{\\mathrm{Np}}=\\dfrac{\\ln 2}{T_{1/2,\\mathrm{Np}}}$, where time is in $\\mathrm{s}$.\n- Total uranium atom number density: $N_{\\mathrm{U,tot}}=2.45\\times 10^{28}\\ \\mathrm{m^{-3}}$.\n\nInitialization rules:\n- Initially, $N_{\\mathrm{Np}}(0)=0$ and $N_{\\mathrm{Pu}}(0)=0$.\n- Given an enrichment atom fraction $x_{235}$, set $N_{235}(0)=x_{235}\\,N_{\\mathrm{U,tot}}$ and $N_{238}(0)=\\left(1-x_{235}\\right)\\,N_{\\mathrm{U,tot}}$.\n\nRequired outputs for each parameter set:\n- The volumetric heat source at final time $q'''(t_{\\mathrm{end}})$ in $\\mathrm{W\\,m^{-3}}$, expressed as a float rounded to three significant figures.\n- The burnup $B(t_{\\mathrm{end}})$ in $\\mathrm{MWd\\,kg^{-1}}$, expressed as a float rounded to three significant figures, where $\\mathrm{MWd}$ means megawatt-day and $1\\ \\mathrm{MWd}=10^{6}\\ \\mathrm{W}\\times 86400\\ \\mathrm{s}$.\n- The end-of-interval fissile sharing fraction of $^{239}$Pu in the total fission rate density, defined as $f_{\\mathrm{Pu}}(t_{\\mathrm{end}})=\\dfrac{R_{\\mathrm{Pu},\\mathrm{f}}(t_{\\mathrm{end}})}{R_{235,\\mathrm{f}}(t_{\\mathrm{end}})+R_{\\mathrm{Pu},\\mathrm{f}}(t_{\\mathrm{end}})}$ (dimensionless), expressed as a float rounded to three significant figures; if the denominator is zero, define the fraction to be zero.\n\nAngle units are not applicable. All physical results must be in the specified units.\n\nTest suite (three parameter sets):\n- Case $1$ (happy path, enriched fuel under typical thermal flux over moderate time):\n  - Flux: $\\phi=1.00\\times 10^{18}\\ \\mathrm{m^{-2}\\,s^{-1}}$.\n  - Enrichment: $x_{235}=0.045$.\n  - Final time: $t_{\\mathrm{end}}=100\\ \\mathrm{days}$.\n- Case $2$ (boundary case, zero flux):\n  - Flux: $\\phi=0.0\\ \\mathrm{m^{-2}\\,s^{-1}}$.\n  - Enrichment: $x_{235}=0.045$.\n  - Final time: $t_{\\mathrm{end}}=100\\ \\mathrm{days}$.\n- Case $3$ (edge case, initially no $^{235}$U and sufficient time for breeding):\n  - Flux: $\\phi=1.00\\times 10^{18}\\ \\mathrm{m^{-2}\\,s^{-1}}$.\n  - Enrichment: $x_{235}=0.0$.\n  - Final time: $t_{\\mathrm{end}}=600\\ \\mathrm{days}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element of the list corresponds to one test case and must itself be a three-element list $[q'''(t_{\\mathrm{end}}),B(t_{\\mathrm{end}}),f_{\\mathrm{Pu}}(t_{\\mathrm{end}})]$. For example, the output should look like $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]$, where each $a_i$, $b_i$, and $c_i$ are floats with the specified units and rounding.",
            "solution": "The problem requires calculating the time-dependent isotopic concentrations, volumetric heat generation, and fuel burnup in a simplified nuclear fuel model. The solution is based on the formulation and numerical integration of a system of coupled first-order ordinary differential equations (ODEs), commonly known as the Bateman equations, which describe the rates of change of isotopic number densities.\n\n**1. Formulation of the Governing Equations**\n\nThe time evolution of the number density $N_i(t)$ for each isotope is governed by a balance of production and loss terms. The fundamental rate laws are:\n- Reaction rate density: $R_{i,p}(t) = \\phi \\sigma_{i,p} N_i(t)$\n- Radioactive decay rate density: $D_i(t) = \\lambda_i N_i(t)$\n\nFrom these principles, we construct the ODEs for the four isotopes in the model: $^{235}$U, $^{238}$U, $^{239}$Np, and $^{239}$Pu.\n\n- **$^{235}\\mathrm{U}$:** Lost through fission and neutron capture.\n$$ \\frac{dN_{235}}{dt} = -(\\sigma_{235,\\mathrm{f}} + \\sigma_{235,\\mathrm{c}})\\phi N_{235}(t) $$\n- **$^{238}\\mathrm{U}$:** Lost through neutron capture, which produces $^{239}$Np.\n$$ \\frac{dN_{238}}{dt} = -\\sigma_{238,\\mathrm{c}}\\phi N_{238}(t) $$\n- **$^{239}\\mathrm{Np}$:** Produced by $^{238}$U capture and lost through $\\beta^-$ decay to $^{239}$Pu.\n$$ \\frac{dN_{\\mathrm{Np}}}{dt} = \\sigma_{238,\\mathrm{c}}\\phi N_{238}(t) - \\lambda_{\\mathrm{Np}}N_{\\mathrm{Np}}(t) $$\n- **$^{239}\\mathrm{Pu}$:** Produced by $^{239}$Np decay and lost through fission and neutron capture.\n$$ \\frac{dN_{\\mathrm{Pu}}}{dt} = \\lambda_{\\mathrm{Np}}N_{\\mathrm{Np}}(t) - (\\sigma_{\\mathrm{Pu},\\mathrm{f}} + \\sigma_{\\mathrm{Pu},\\mathrm{c}})\\phi N_{\\mathrm{Pu}}(t) $$\nThis is a system of linear, first-order, constant-coefficient ODEs with initial conditions derived from the fuel enrichment.\n\n**2. Calculation of Output Quantities**\n\nThe required outputs are derived from the time-dependent number densities, $N_i(t)$, obtained by solving the ODE system.\n\n- **Volumetric Heat Source ($q'''$)**: The heat source is the sum of energies deposited from fission events of all fissile isotopes.\n$$ q'''(t) = \\eta_{\\mathrm{dep}}E_{\\mathrm{f}} \\left( R_{235,\\mathrm{f}}(t) + R_{\\mathrm{Pu},\\mathrm{f}}(t) \\right) = \\eta_{\\mathrm{dep}}E_{\\mathrm{f}}\\phi \\left( \\sigma_{235,\\mathrm{f}}N_{235}(t) + \\sigma_{\\mathrm{Pu},\\mathrm{f}}N_{\\mathrm{Pu}}(t) \\right) $$\n\n- **Burnup ($B$)**: Burnup is the total energy released per unit mass of fuel over time.\n$$ B(t) = \\frac{1}{\\rho_{\\mathrm{fuel}}} \\int_0^t q'''(\\tau)d\\tau $$\n\n- **$^{239}\\mathrm{Pu}$ Fissile Sharing Fraction ($f_{\\mathrm{Pu}}$)**: This is the ratio of the $^{239}$Pu fission rate to the total fission rate.\n$$ f_{\\mathrm{Pu}}(t) = \\frac{R_{\\mathrm{Pu},\\mathrm{f}}(t)}{R_{235,\\mathrm{f}}(t) + R_{\\mathrm{Pu},\\mathrm{f}}(t)} = \\frac{\\sigma_{\\mathrm{Pu},\\mathrm{f}}N_{\\mathrm{Pu}}(t)}{\\sigma_{235,\\mathrm{f}}N_{235}(t) + \\sigma_{\\mathrm{Pu},\\mathrm{f}}N_{\\mathrm{Pu}}(t)} $$\n\n**3. Numerical Solution Strategy**\n\nThe system of ODEs is solved numerically. To compute the burnup, which involves an integral, the system is augmented with additional ODEs. Let $I_{235}(t) = \\int_0^t N_{235}(\\tau)d\\tau$ and $I_{\\mathrm{Pu}}(t) = \\int_0^t N_{\\mathrm{Pu}}(\\tau)d\\tau$. Their time derivatives are simply $\\frac{dI_{235}}{dt} = N_{235}(t)$ and $\\frac{dI_{\\mathrm{Pu}}}{dt} = N_{\\mathrm{Pu}}(t)$.\nThe full system of six coupled ODEs (for $N_{235}$, $N_{238}$, $N_{\\mathrm{Np}}$, $N_{\\mathrm{Pu}}$, $I_{235}$, and $I_{\\mathrm{Pu}}$) is integrated from $t=0$ to $t=t_{\\mathrm{end}}$ using a standard numerical solver. The solution at $t=t_{\\mathrm{end}}$ provides all quantities needed to compute the final outputs. The burnup is then calculated from the integrated values:\n$$ B(t_{\\mathrm{end}}) = \\frac{\\eta_{\\mathrm{dep}}E_{\\mathrm{f}}\\phi}{\\rho_{\\mathrm{fuel}}} \\left( \\sigma_{235,\\mathrm{f}}I_{235}(t_{\\mathrm{end}}) + \\sigma_{\\mathrm{Pu},\\mathrm{f}}I_{\\mathrm{Pu}}(t_{\\mathrm{end}}) \\right) $$\nAll results are then converted to the specified units and rounded as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves a set of burnup problems for a simplified nuclear fuel model.\n    \"\"\"\n\n    # --- Constants ---\n    E_F = 3.204e-11  # J per fission\n    ETA_DEP = 0.95  # Dimensionless deposited energy fraction\n    RHO_FUEL = 10970.0  # kg/m^3\n    N_U_TOT = 2.45e28  # m^-3, total U atom density\n    T_HALF_NP = 2.356  # days\n    \n    # Microscopic cross sections (m^2)\n    SIG_235_F = 5.80e-26\n    SIG_235_C = 1.00e-26\n    SIG_238_C = 2.70e-28\n    SIG_PU_F = 7.42e-26\n    SIG_PU_C = 2.70e-26\n\n    # Derived constants\n    S_PER_DAY = 86400.0\n    J_PER_MWD = 8.64e10  # 1e6 W * 86400 s\n    T_HALF_NP_S = T_HALF_NP * S_PER_DAY\n    LAMBDA_NP = np.log(2) / T_HALF_NP_S  # s^-1\n    \n    SIG_235_A = SIG_235_F + SIG_235_C\n    SIG_PU_A = SIG_PU_F + SIG_PU_C\n\n    # Test cases from the problem statement.\n    test_cases = [\n        # (flux [m^-2 s^-1], U-235 enrichment, end time [days])\n        (1.00e18, 0.045, 100.0),\n        (0.0, 0.045, 100.0),\n        (1.00e18, 0.0, 600.0),\n    ]\n\n    results = []\n\n    def round_sig(val, sig_figs=3):\n        \"\"\"Rounds a float to a specified number of significant figures.\"\"\"\n        if val == 0:\n            return 0.0\n        return float(f\"{val:.{sig_figs}g}\")\n\n    for case in test_cases:\n        phi, x_235, t_end_days = case\n        t_end_s = t_end_days * S_PER_DAY\n\n        # Effective reaction constants (s^-1)\n        # These are phi*sigma, which act as effective decay/transmutation constants\n        lambda_235_a_eff = SIG_235_A * phi\n        lambda_238_c_eff = SIG_238_C * phi\n        lambda_pu_a_eff = SIG_PU_A * phi\n\n        # Initial number densities (m^-3)\n        N235_0 = x_235 * N_U_TOT\n        N238_0 = (1.0 - x_235) * N_U_TOT\n        NNp_0 = 0.0\n        NPu_0 = 0.0\n        \n        # Augmented state vector Y = [N235, N238, NNp, NPu, int(N235), int(NPu)]\n        Y0 = np.array([N235_0, N238_0, NNp_0, NPu_0, 0.0, 0.0])\n\n        # Define the system of ODEs: dY/dt = f(t, Y)\n        def dydt(t, Y):\n            N235, N238, NNp, NPu, _, _ = Y\n            \n            dN235_dt = -lambda_235_a_eff * N235\n            dN238_dt = -lambda_238_c_eff * N238\n            dNNp_dt = lambda_238_c_eff * N238 - LAMBDA_NP * NNp\n            dNPu_dt = LAMBDA_NP * NNp - lambda_pu_a_eff * NPu\n            \n            # Derivatives for the integral components\n            dIntN235_dt = N235\n            dIntNPu_dt = NPu\n            \n            return np.array([dN235_dt, dN238_dt, dNNp_dt, dNPu_dt, dIntN235_dt, dIntNPu_dt])\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            dydt,\n            t_span=[0, t_end_s],\n            y0=Y0,\n            t_eval=[t_end_s],\n            method='RK45',\n            rtol=1e-9,\n            atol=1e-12\n        )\n        \n        Y_end = sol.y[:, -1]\n        N235_end, N238_end, NNp_end, NPu_end, IntN235_end, IntNPu_end = Y_end\n\n        # --- Calculate outputs ---\n\n        # 1. Volumetric heat source q'''(t_end) in W/m^3\n        total_fission_rate_end = phi * (SIG_235_F * N235_end + SIG_PU_F * NPu_end)\n        q_ppp_end = ETA_DEP * E_F * total_fission_rate_end\n\n        # 2. Burnup B(t_end) in MWd/kg\n        # Integral part for burnup calculation\n        integral_term = SIG_235_F * IntN235_end + SIG_PU_F * IntNPu_end\n        burnup_j_per_kg = (ETA_DEP * E_F * phi / RHO_FUEL) * integral_term\n        burnup_mwd_per_kg = burnup_j_per_kg / J_PER_MWD\n        \n        # 3. Pu fissile sharing fraction f_Pu(t_end)\n        # Note: phi cancels in the fraction for phi > 0\n        fission_rate_pu_end = SIG_PU_F * NPu_end\n        fission_rate_235_end = SIG_235_F * N235_end\n        total_fission_cross_section_eff = fission_rate_235_end + fission_rate_pu_end\n        \n        if total_fission_cross_section_eff == 0.0:\n            f_pu_end = 0.0\n        else:\n            f_pu_end = fission_rate_pu_end / total_fission_cross_section_eff\n\n        # Round all results to 3 significant figures\n        q_ppp_out = round_sig(q_ppp_end, 3)\n        B_out = round_sig(burnup_mwd_per_kg, 3)\n        f_pu_out = round_sig(f_pu_end, 3)\n        \n        results.append([q_ppp_out, B_out, f_pu_out])\n        \n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}