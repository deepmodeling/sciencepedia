{
    "hands_on_practices": [
        {
            "introduction": "本实践是热源建模的基石。我们从最基本的情景入手：在理想化的一维几何体——平板、实心圆柱和实心球体——中存在均匀的体积热源。通过从第一性原理出发，推导这些典型情况下的稳态温度分布，您将为理解热生成率、导热系数、几何形状和边界条件之间的相互作用建立坚实的直觉，这对于解决更复杂的问题至关重要。",
            "id": "4230060",
            "problem": "一个正在发生裂变的核燃料元件可以被理想化为一个具有均匀体积热生成的一维 (1D) 物体。在稳态下，热量通过与冷却剂的对流或通过维持固定的表面温度从表面移除。从能量守恒和傅里叶 (Fourier) 热传导定律的本构关系出发，推导在三种具有均匀体积热生成的典型几何形状——平板 (平面)、实心圆柱 (径向) 和实心球 (径向)——中的稳态温度分布的解析表达式。在中心线处使用对称性，并在外表面使用物理上一致的边界条件。然后设计一个程序，对给定的参数集，评估中心线温度和表面热通量。\n\n需采用的基本依据和假设：\n- 在稳态条件下，微分控制体中的能量守恒，热导率恒定，体积热生成均匀。\n- 将热通量与温度梯度关联的傅里叶 (Fourier) 热传导定律。\n- 中心的对称性 ($x=0$ 或 $r=0$ 时，$dT/dx = 0$ 或 $dT/dr = 0$)。\n- 在表面，边界条件为与温度为 $T_\\infty$、对流系数为 $h$ 的流体进行对流，或为固定的表面温度 $T_s$。\n\n您必须：\n1. 针对每种几何形状，推导能够根据几何尺寸、热导率、体积热生成和边界参数计算中心线温度 $T(0)$ 和表面热通量 $q''$ 的解析表达式。\n2. 实现一个程序，为下面指定的每个测试用例计算：\n   - 中心线温度 (单位为 $\\mathrm{K}$)。\n   - 向外的表面热通量 (单位为 $\\mathrm{W/m^2}$)。\n3. 将最终输出表示为包含在方括号中的单行逗号分隔列表。对于每个测试用例，列表必须按顺序包含中心线温度 (单位 $\\mathrm{K}$)，然后是表面热通量 (单位 $\\mathrm{W/m^2}$)。将每个浮点数结果四舍五入到六位小数。\n\n几何约定：\n- 平板：模拟半厚度域 $0 \\le x \\le L$，在 $x=0$ 处对称，在 $x=L$ 处为边界。\n- 圆柱：模拟径向域 $0 \\le r \\le R$，在 $r=0$ 处对称，在 $r=R$ 处为边界。\n- 球体：模拟径向域 $0 \\le r \\le R$，在 $r=0$ 处对称，在 $r=R$ 处为边界。\n\n单位：\n- 热导率 $k$ 单位为 $\\mathrm{W/(m\\cdot K)}$。\n- 体积热生成 $q'''$ 单位为 $\\mathrm{W/m^3}$。\n- 对流系数 $h$ 单位为 $\\mathrm{W/(m^2\\cdot K)}$。\n- 长度 $L$ 或 $R$ 单位为 $\\mathrm{m}$。\n- 温度 $T_\\infty$ 和 $T_s$ 单位为 $\\mathrm{K}$。\n- 热通量 $q''$ 单位为 $\\mathrm{W/m^2}$。\n\n测试套件：\n- 案例 $1$ (平板，对流边界)：$L = 0.005\\,\\mathrm{m}$，$k = 20\\,\\mathrm{W/(m\\cdot K)}$，$q''' = 1.5\\times 10^8\\,\\mathrm{W/m^3}$，$h = 12000\\,\\mathrm{W/(m^2\\cdot K)}$，$T_\\infty = 570\\,\\mathrm{K}$。\n- 案例 $2$ (圆柱，固定表面温度)：$R = 0.004\\,\\mathrm{m}$，$k = 3\\,\\mathrm{W/(m\\cdot K)}$，$q''' = 5.0\\times 10^8\\,\\mathrm{W/m^3}$，$T_s = 620\\,\\mathrm{K}$。\n- 案例 $3$ (球体，对流边界)：$R = 0.010\\,\\mathrm{m}$，$k = 15\\,\\mathrm{W/(m\\cdot K)}$，$q''' = 2.0\\times 10^7\\,\\mathrm{W/m^3}$，$h = 8000\\,\\mathrm{W/(m^2\\cdot K)}$，$T_\\infty = 350\\,\\mathrm{K}$。\n- 案例 $4$ (平板，对流边界，零生成边缘情况)：$L = 0.003\\,\\mathrm{m}$，$k = 12\\,\\mathrm{W/(m\\cdot K)}$，$q''' = 0\\,\\mathrm{W/m^3}$，$h = 10000\\,\\mathrm{W/(m^2\\cdot K)}$，$T_\\infty = 300\\,\\mathrm{K}$。\n\n最终输出格式：\n- 您的程序应生成单行结果，格式为方括号括起来的逗号分隔列表，顺序如下：\n  $[T_{\\text{center,case1}}, q''_{\\text{surface,case1}}, T_{\\text{center,case2}}, q''_{\\text{surface,case2}}, T_{\\text{center,case3}}, q''_{\\text{surface,case3}}, T_{\\text{center,case4}}, q''_{\\text{surface,case4}}]$,\n  每个值都需四舍五入到六位小数，单位如上所述。",
            "solution": "该问题要求针对具有均匀体积热生成的一维典型几何形状 (平板、圆柱、球体)，推导其稳态温度分布和热通量的解析表达式，然后进行计算实现。分析从能量守恒的第一性原理开始。\n\n具有均匀体积热源 $q'''$ 和恒定热导率 $k$ 的稳态热传导的控制方程源自微分控制体上的能量平衡。它是泊松 (Poisson) 方程的一种特定形式：\n$$ \\nabla^2 T = -\\frac{q'''}{k} $$\n此处，$T$ 是温度，$\\nabla^2$ 是拉普拉斯算子。我们将针对每种几何形状，在指定的边界条件下求解该方程。\n\n### 一般推导步骤\n对于每种几何形状，步骤如下：\n1.  在合适的坐标系中表示热方程。\n2.  对该方程进行两次积分，得到温度分布 $T(y)$ 的通解，其中 $y$ 是空间坐标 ($x$ 用于平板，$r$ 用于圆柱/球体)。这将引入两个积分常数 $C_1$ 和 $C_2$。\n3.  应用第一个边界条件，即中心的对称性 ($x=0$ 或 $r=0$)。该条件表明温度梯度为零，$\\frac{dT}{dy}|_{y=0}=0$，从而确定第一个常数 $C_1$。\n4.  第二个常数 $C_2$ 由外表面的边界条件确定。中心线温度 $T(0)$ 与 $C_2$ 直接相关。\n5.  考虑两种外边界条件：\n    a. 表面温度固定为 $T_s$。\n    b. 与温度为 $T_\\infty$、传热系数为 $h$ 的流体进行对流。该条件通过牛顿 (Newton) 冷却定律表示，它将表面的传导热通量与对流热通量相等：$q''_s = -k \\frac{dT}{dy}|_{surface} = h(T_{surface} - T_\\infty)$。\n6.  表面热通量 $q''_s$ 可通过傅里叶 (Fourier) 定律 $q''_s = -k \\frac{dT}{dy}|_{surface}$ 或通过全局能量平衡确定：在稳态下，体积内生成的总热量必须在表面被移除。按单位面积计算，可得 $q''_s = (q''' \\times \\text{体积}) / (\\text{表面积})$。\n\n### 1. 平板几何\n对于半厚度为 $L$ 的平板，我们考虑区域 $0 \\le x \\le L$。一维笛卡尔坐标系中的热方程为：\n$$ \\frac{d^2T}{dx^2} = -\\frac{q'''}{k} $$\n对 $x$ 积分一次：\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k}x + C_1 $$\n应用中心线的对称边界条件 $\\frac{dT}{dx}|_{x=0} = 0$，得到 $C_1 = 0$。温度梯度为：\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k}x $$\n进行第二次积分：\n$$ T(x) = -\\frac{q'''}{2k}x^2 + C_2 $$\n中心线温度为 $T(0) = C_2$。\n\n**表面热通量 $q''_s$**：对半平板 (单位面积的体积为 $L$) 进行全局能量平衡，规定了单位面积生成的热量 $q'''L$ 必须从表面 $x=L$ 逸出。因此，\n$$ q''_s = q'''L $$\n该结果与边界条件类型无关。一旦知道 $T(x)$，就可以用傅里叶 (Fourier) 定律来验证：$q''_s = -k \\frac{dT}{dx}|_{x=L} = -k(-\\frac{q'''}{k}L) = q'''L$。\n\n**中心线温度 $T(0)$**：\na) **固定表面温度**：在 $x=L$ 处，$T(L) = T_s$。\n$$ T(L) = T_s = -\\frac{q'''L^2}{2k} + C_2 $$\n求解 $C_2$ 得到中心线温度：\n$$ T(0) = C_2 = T_s + \\frac{q'''L^2}{2k} $$\nb) **对流边界**：在 $x=L$ 处，$-k\\frac{dT}{dx}|_{x=L} = h(T(L) - T_\\infty)$。我们知道 $q''_s = -k\\frac{dT}{dx}|_{x=L} = q'''L$。因此，$q'''L = h(T(L) - T_\\infty)$，这给出了表面温度 $T(L) = T_\\infty + \\frac{q'''L}{h}$。\n将 $T(L)$ 代入 $x=L$ 处的一般温度分布表达式中：\n$$ T(L) = T_\\infty + \\frac{q'''L}{h} = -\\frac{q'''L^2}{2k} + C_2 $$\n求解 $C_2$ 得到中心线温度：\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k} = T_\\infty + q'''L\\left(\\frac{1}{h} + \\frac{L}{2k}\\right) $$\n\n### 2. 实心圆柱几何\n对于半径为 $R$ 的实心圆柱，我们考虑区域 $0 \\le r \\le R$。一维圆柱坐标系中的热方程为：\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{dT}{dr}\\right) = -\\frac{q'''}{k} $$\n积分一次得到：\n$$ r\\frac{dT}{dr} = -\\frac{q'''}{2k}r^2 + C_1 $$\n应用对称条件 $\\frac{dT}{dr}|_{r=0} = 0$ (或等效地，要求温度在 $r=0$ 处为有限值)，我们必须有 $C_1=0$。\n$$ \\frac{dT}{dr} = -\\frac{q'''}{2k}r $$\n进行第二次积分：\n$$ T(r) = -\\frac{q'''}{4k}r^2 + C_2 $$\n中心线温度为 $T(0) = C_2$。\n\n**表面热通量 $q''_s$**：对长度为 $H$ 的圆柱进行能量平衡得到：体积 $V = \\pi R^2 H$，表面积 $A = 2\\pi R H$。总生成热量为 $q'''V$。表面通量为 $q''_s = (q'''V)/A = (q'''\\pi R^2 H) / (2\\pi R H)$。因此，\n$$ q''_s = \\frac{q'''R}{2} $$\n这可通过傅里叶 (Fourier) 定律证实：$q''_s = -k \\frac{dT}{dr}|_{r=R} = -k(-\\frac{q'''}{2k}R) = \\frac{q'''R}{2}$。\n\n**中心线温度 $T(0)$**：\na) **固定表面温度**：在 $r=R$ 处，$T(R)=T_s$。\n$$ T(R) = T_s = -\\frac{q'''R^2}{4k} + C_2 $$\n$$ T(0) = C_2 = T_s + \\frac{q'''R^2}{4k} $$\nb) **对流边界**：在 $r=R$ 处，$q''_s = h(T(R) - T_\\infty)$。所以，$\\frac{q'''R}{2} = h(T(R) - T_\\infty)$，这给出了 $T(R) = T_\\infty + \\frac{q'''R}{2h}$。\n将此代入 $r=R$ 处的温度分布中：\n$$ T(R) = T_\\infty + \\frac{q'''R}{2h} = -\\frac{q'''R^2}{4k} + C_2 $$\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''R}{2h} + \\frac{q'''R^2}{4k} = T_\\infty + \\frac{q'''R}{2}\\left(\\frac{1}{h} + \\frac{R}{2k}\\right) $$\n\n### 3. 实心球几何\n对于半径为 $R$ 的实心球，我们考虑区域 $0 \\le r \\le R$。一维球坐标系中的热方程为：\n$$ \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2\\frac{dT}{dr}\\right) = -\\frac{q'''}{k} $$\n积分一次：\n$$ r^2\\frac{dT}{dr} = -\\frac{q'''}{3k}r^3 + C_1 $$\n对称条件 $\\frac{dT}{dr}|_{r=0} = 0$ 要求 $C_1=0$。\n$$ \\frac{dT}{dr} = -\\frac{q'''}{3k}r $$\n进行第二次积分：\n$$ T(r) = -\\frac{q'''}{6k}r^2 + C_2 $$\n中心线温度为 $T(0) = C_2$。\n\n**表面热通量 $q''_s$**：能量平衡给出：体积 $V = \\frac{4}{3}\\pi R^3$，表面积 $A = 4\\pi R^2$。表面通量为 $q''_s = (q'''V)/A = (q'''\\frac{4}{3}\\pi R^3) / (4\\pi R^2)$。\n$$ q''_s = \\frac{q'''R}{3} $$\n这可通过傅里叶 (Fourier) 定律证实：$q''_s = -k \\frac{dT}{dr}|_{r=R} = -k(-\\frac{q'''}{3k}R) = \\frac{q'''R}{3}$。\n\n**中心线温度 $T(0)$**：\na) **固定表面温度**：在 $r=R$ 处，$T(R)=T_s$。\n$$ T(R) = T_s = -\\frac{q'''R^2}{6k} + C_2 $$\n$$ T(0) = C_2 = T_s + \\frac{q'''R^2}{6k} $$\nb) **对流边界**：在 $r=R$ 处，$q''_s = h(T(R) - T_\\infty)$。所以，$\\frac{q'''R}{3} = h(T(R) - T_\\infty)$，这给出了 $T(R) = T_\\infty + \\frac{q'''R}{3h}$。\n将此代入 $r=R$ 处的温度分布中：\n$$ T(R) = T_\\infty + \\frac{q'''R}{3h} = -\\frac{q'''R^2}{6k} + C_2 $$\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''R}{3h} + \\frac{q'''R^2}{6k} = T_\\infty + \\frac{q'''R}{3}\\left(\\frac{1}{h} + \\frac{R}{2k}\\right) $$\n\n现在，使用这些推导出的公式来求解所提供的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes centerline temperature and surface heat flux for various\n    geometries and boundary conditions in steady-state heat conduction.\n    \"\"\"\n    \n    # Test cases are structured as dictionaries for clarity.\n    # 'geom': 'slab', 'cylinder', 'sphere'\n    # 'bc_type': 'conv', 'fixed_T'\n    # 'params': dictionary of physical and geometrical parameters\n    test_cases_data = [\n        {\n            \"geom\": \"slab\", \"bc_type\": \"conv\", \n            \"params\": {\"L\": 0.005, \"k\": 20.0, \"q_gen\": 1.5e8, \"h\": 12000.0, \"T_inf\": 570.0}\n        },\n        {\n            \"geom\": \"cylinder\", \"bc_type\": \"fixed_T\", \n            \"params\": {\"R\": 0.004, \"k\": 3.0, \"q_gen\": 5.0e8, \"T_s\": 620.0}\n        },\n        {\n            \"geom\": \"sphere\", \"bc_type\": \"conv\", \n            \"params\": {\"R\": 0.010, \"k\": 15.0, \"q_gen\": 2.0e7, \"h\": 8000.0, \"T_inf\": 350.0}\n        },\n        {\n            \"geom\": \"slab\", \"bc_type\": \"conv\", \n            \"params\": {\"L\": 0.003, \"k\": 12.0, \"q_gen\": 0.0, \"h\": 10000.0, \"T_inf\": 300.0}\n        }\n    ]\n\n    results = []\n\n    for case in test_cases_data:\n        geom = case[\"geom\"]\n        bc_type = case[\"bc_type\"]\n        p = case[\"params\"]\n        \n        T_center = 0.0\n        q_surface = 0.0\n\n        if geom == \"slab\":\n            # Surface heat flux from energy balance: q_s = q''' * L\n            q_surface = p[\"q_gen\"] * p[\"L\"]\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q'''*L/h + q'''*L^2/(2*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"L\"]**2 / (2 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*L^2/(2*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"L\"]**2 / (2 * p[\"k\"])\n\n        elif geom == \"cylinder\":\n            # Surface heat flux from energy balance: q_s = q''' * R / 2\n            q_surface = p[\"q_gen\"] * p[\"R\"] / 2\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q_s/h + q'''*R^2/(4*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"R\"]**2 / (4 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*R^2/(4*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"R\"]**2 / (4 * p[\"k\"])\n\n        elif geom == \"sphere\":\n            # Surface heat flux from energy balance: q_s = q''' * R / 3\n            q_surface = p[\"q_gen\"] * p[\"R\"] / 3\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q_s/h + q'''*R^2/(6*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"R\"]**2 / (6 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*R^2/(6*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"R\"]**2 / (6 * p[\"k\"])\n                \n        results.append(T_center)\n        results.append(q_surface)\n\n    # Format the final output string exactly as required, with rounding to six decimal places.\n    # Using format specifier f\"{x:.6f}\" ensures trailing zeros.\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在均匀热源模型的基础上，我们现在引入一个更符合实际的空间变化的生热模型。在真实的反应堆燃料芯块中，由于中子自屏效应等现象，裂变率并非均匀分布，通常在表面附近达到峰值。本实践要求您对径向相关的热源进行建模，通过求解带有非恒定源项的热扩散方程，从而获得燃料内部更精确的温度分布。",
            "id": "4230065",
            "problem": "一个由二氧化铀燃料构成的正圆柱体（半径为 $R$）被建模为均匀、各向同性的固体，其导热系数 $k$ 为常数，且处于稳态条件下。在运行的轻水反应堆中，由于共振自屏和边缘富集效应，裂变功率以径向变化的体源密度 $q^{\\prime\\prime\\prime}(r)$ 的形式在体积内产生。该体源密度近似表示为 $q^{\\prime\\prime\\prime}(r) = S_{0}\\left(1 + \\beta \\frac{r^{2}}{R^{2}}\\right)$ 的形式，其中 $S_{0}$ 是一个未知的归一化常数，$\\beta$ 是一个给定的无量纲参数。单位长度燃料棒产生的总热量，即线热功率 $q^{\\prime}$，必须等于 $q^{\\prime\\prime\\prime}(r)$ 的横截面积分。燃料表面的散热由 $r=R$ 处的有效对流边界条件表示：$-k\\,\\frac{dT}{dr}\\big|_{r=R} = h\\left(T(R) - T_{\\mathrm{c}}\\right)$，其中 $h$ 是一个有效传热系数，它考虑了固体间隙和包壳到冷却剂的传热，$T_{\\mathrm{c}}$ 是冷却剂的主体温度。对称性要求温度梯度在 $r=0$ 处保持有限。\n\n从柱坐标系下包含体积生热的稳态能量守恒方程和傅里叶 (Fourier) 热传导定律出发，推导温度分布并计算中心线温度 $T(0)$。\n\n使用以下数值：$R = 4.0\\ \\mathrm{mm}$，$k = 3.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$，$h = 1.0\\times 10^{4}\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$，$T_{\\mathrm{c}} = 570\\ \\mathrm{K}$，$q^{\\prime} = 1.8\\times 10^{4}\\ \\mathrm{W\\,m^{-1}}$，以及 $\\beta = 2$。\n\n将最终答案四舍五入到四位有效数字。最终温度以开尔文表示。",
            "solution": "用户希望我解决一个核反应堆模拟领域的问题，具体是关于热量产生和体积源建模。\n\n### **问题验证**\n\n#### **第 1 步：提取给定信息**\n-   **几何形状**：正圆柱体燃料。\n-   **半径**：$R$。\n-   **导热系数**：$k$（常数）。\n-   **状态**：稳态。\n-   **体积热源**：$q^{\\prime\\prime\\prime}(r) = S_{0}\\left(1 + \\beta \\frac{r^{2}}{R^{2}}\\right)$。\n-   **归一化常数**：$S_{0}$（未知）。\n-   **无量纲参数**：$\\beta$。\n-   **线热功率**：$q^{\\prime}$，定义为 $q^{\\prime} = \\int_{A} q^{\\prime\\prime\\prime}(r) dA$。\n-   **边界条件 1（中心线）**：对称性要求温度梯度在 $r=0$ 处保持有限。这意味着 $\\frac{dT}{dr}\\big|_{r=0} = 0$。\n-   **边界条件 2（表面）**：在 $r=R$ 处的对流边界条件，由 $-k\\,\\frac{dT}{dr}\\big|_{r=R} = h\\left(T(R) - T_{\\mathrm{c}}\\right)$ 给出。\n-   **传热系数**：$h$。\n-   **冷却剂温度**：$T_{\\mathrm{c}}$。\n-   **数值**：\n    -   $R = 4.0\\ \\mathrm{mm} = 4.0 \\times 10^{-3}\\ \\mathrm{m}$\n    -   $k = 3.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n    -   $h = 1.0\\times 10^{4}\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    -   $T_{\\mathrm{c}} = 570\\ \\mathrm{K}$\n    -   $q^{\\prime} = 1.8\\times 10^{4}\\ \\mathrm{W\\,m^{-1}}$\n    -   $\\beta = 2$\n\n#### **第 2 步：使用提取的给定信息进行验证**\n将问题与验证标准进行对照分析：\n-   **科学依据**：该问题基于传热学的基本原理，特别是稳态热扩散方程（能量守恒定律的一种形式）和傅里叶传导定律。体积生热模型 $q^{\\prime\\prime\\prime}(r) = S_0(1+\\beta r^2/R^2)$ 是核工程中用于模拟燃料棒径向功率分布的一个成熟的二阶多项式近似，它考虑了中子通量凹陷和芯块边缘钚积累（边缘效应）等效应。所有参数和条件对于轻水反应堆燃料棒都是物理上现实的。不存在科学缺陷。\n-   **适定性**：该问题提供了一个二阶常微分方程和两个边界条件（一个在 $r=0$ 处，一个在 $r=R$ 处），确保了温度分布 $T(r)$ 存在唯一解。所有必要的数据（$R, k, h, T_c, q', \\beta$）都已提供。问题是自洽且完整的。\n-   **客观性**：问题以精确、定量的语言陈述，没有主观性或模糊性。\n\n该问题没有任何无效缺陷。这是一个工程传热学中标准的、可解的问题。\n\n#### **第 3 步：结论和行动**\n问题是**有效的**。将提供完整解答。\n\n### **求解推导**\n\n在具有体积生热 $q^{\\prime\\prime\\prime}(r)$ 的一维圆柱系统中，稳态热传导的控制方程是热扩散方程：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r k \\frac{dT}{dr} \\right) + q^{\\prime\\prime\\prime}(r) = 0 $$\n由于导热系数 $k$ 是常数，方程简化为：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) = -\\frac{q^{\\prime\\prime\\prime}(r)}{k} $$\n\n首先，我们必须使用给定的线热功率 $q^{\\prime}$ 来确定归一化常数 $S_0$。线热功率是体积热源在横截面积 $A = \\pi R^2$ 上的积分。\n$$ q^{\\prime} = \\int_{0}^{R} q^{\\prime\\prime\\prime}(r) (2\\pi r) dr $$\n代入 $q^{\\prime\\prime\\prime}(r)$ 的表达式：\n$$ q^{\\prime} = \\int_{0}^{R} S_{0}\\left(1 + \\beta \\frac{r^{2}}{R^{2}}\\right) (2\\pi r) dr = 2\\pi S_0 \\int_{0}^{R} \\left(r + \\frac{\\beta r^3}{R^2}\\right) dr $$\n$$ q^{\\prime} = 2\\pi S_0 \\left[ \\frac{r^2}{2} + \\frac{\\beta r^4}{4R^2} \\right]_{0}^{R} = 2\\pi S_0 \\left( \\frac{R^2}{2} + \\frac{\\beta R^4}{4R^2} \\right) = 2\\pi S_0 \\left( \\frac{R^2}{2} + \\frac{\\beta R^2}{4} \\right) $$\n$$ q^{\\prime} = \\pi S_0 R^2 \\left(1 + \\frac{\\beta}{2}\\right) $$\n解出 $S_0$：\n$$ S_0 = \\frac{q^{\\prime}}{\\pi R^2 (1 + \\beta/2)} $$\n\n现在，将 $q^{\\prime\\prime\\prime}(r)$ 代入热扩散方程并积分。\n$$ \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) = -\\frac{r}{k} S_0 \\left(1 + \\frac{\\beta r^2}{R^2}\\right) = -\\frac{S_0}{k} \\left(r + \\frac{\\beta r^3}{R^2}\\right) $$\n对 $r$ 积分：\n$$ r \\frac{dT}{dr} = -\\frac{S_0}{k} \\int \\left(r + \\frac{\\beta r^3}{R^2}\\right) dr = -\\frac{S_0}{k} \\left( \\frac{r^2}{2} + \\frac{\\beta r^4}{4R^2} \\right) + C_1 $$\n第一个边界条件是中心线的对称性，$\\frac{dT}{dr}\\big|_{r=0} = 0$。从上面的方程可知：\n$$ \\frac{dT}{dr} = -\\frac{S_0}{k} \\left( \\frac{r}{2} + \\frac{\\beta r^3}{4R^2} \\right) + \\frac{C_1}{r} $$\n为使梯度在 $r=0$ 处为有限（且为零），$\\frac{C_1}{r}$ 项必须为零，这要求积分常数 $C_1=0$。\n因此，温度梯度为：\n$$ \\frac{dT}{dr} = -\\frac{S_0}{k} \\left( \\frac{r}{2} + \\frac{\\beta r^3}{4R^2} \\right) $$\n再次积分以求得温度分布 $T(r)$：\n$$ T(r) = \\int \\left( -\\frac{S_0}{k} \\left( \\frac{r}{2} + \\frac{\\beta r^3}{4R^2} \\right) \\right) dr = -\\frac{S_0}{k} \\left( \\frac{r^2}{4} + \\frac{\\beta r^4}{16R^2} \\right) + C_2 $$\n为了求第二个积分常数 $C_2$，我们应用在表面 $r=R$ 处的对流边界条件：\n$$ -k\\,\\frac{dT}{dr}\\big|_{r=R} = h\\left(T(R) - T_{\\mathrm{c}}\\right) $$\n左边的项是表面的热通量 $q^{\\prime\\prime}(R)$。单位长度流出的总热量必须等于线热功率 $q^{\\prime}$，所以 $q^{\\prime} = q^{\\prime\\prime}(R) \\times (2\\pi R)$。因此，$q^{\\prime\\prime}(R) = -k\\frac{dT}{dr}\\big|_{r=R} = \\frac{q^{\\prime}}{2\\pi R}$。\n将此代入边界条件，得到：\n$$ \\frac{q^{\\prime}}{2\\pi R} = h(T(R) - T_c) $$\n这使我们能够解出表面温度 $T(R)$：\n$$ T(R) = T_c + \\frac{q^{\\prime}}{2\\pi R h} $$\n现在我们将我们的一般温度分布在 $r=R$ 处求值，并使其等于 $T(R)$ 的这个表达式：\n$$ T(R) = -\\frac{S_0}{k} \\left( \\frac{R^2}{4} + \\frac{\\beta R^4}{16R^2} \\right) + C_2 = -\\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) + C_2 $$\n因此，常数 $C_2$ 是：\n$$ C_2 = T(R) + \\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) $$\n中心线温度 $T(0)$ 是通过在温度分布 $T(r)$ 中令 $r=0$ 得到的：\n$$ T(0) = -\\frac{S_0}{k} (0) + C_2 = C_2 $$\n所以，中心线温度是：\n$$ T(0) = T(R) + \\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) $$\n代入 $T(R)$ 和 $S_0$ 的表达式：\n$$ T(0) = \\left( T_c + \\frac{q^{\\prime}}{2\\pi R h} \\right) + \\frac{1}{k} \\left( \\frac{q^{\\prime}}{\\pi R^2 (1 + \\beta/2)} \\right) R^2 \\left( \\frac{4+\\beta}{16} \\right) $$\n$$ T(0) = T_c + \\frac{q^{\\prime}}{2\\pi R h} + \\frac{q^{\\prime}}{16 \\pi k} \\frac{4+\\beta}{1+\\beta/2} $$\n这是中心线温度的最终符号表达式。\n\n### **数值计算**\n\n给定以下数值：\n$T_c = 570\\ \\mathrm{K}$\n$q^{\\prime} = 1.8\\times 10^{4}\\ \\mathrm{W\\,m^{-1}}$\n$R = 4.0 \\times 10^{-3}\\ \\mathrm{m}$\n$h = 1.0\\times 10^{4}\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n$k = 3.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n$\\beta = 2$\n\n温升包括两部分：从冷却剂到燃料表面的温升（$\\Delta T_{\\text{film}}$）和从燃料表面到中心线的温升（$\\Delta T_{\\text{fuel}}$）。\n\n1.  计算通过有效间隙/包壳膜的温升：\n    $$ \\Delta T_{\\text{film}} = T(R) - T_c = \\frac{q^{\\prime}}{2\\pi R h} = \\frac{1.8 \\times 10^4}{2\\pi (4.0 \\times 10^{-3}) (1.0 \\times 10^4)} = \\frac{1.8 \\times 10^4}{80\\pi} = \\frac{225}{\\pi}\\ \\mathrm{K} $$\n    $$ \\Delta T_{\\text{film}} \\approx 71.6197\\ \\mathrm{K} $$\n\n2.  计算燃料芯块内的温升：\n    $$ \\Delta T_{\\text{fuel}} = T(0) - T(R) = \\frac{q^{\\prime}}{16 \\pi k} \\frac{4+\\beta}{1+\\beta/2} = \\frac{1.8 \\times 10^4}{16\\pi (3.0)} \\frac{4+2}{1+2/2} = \\frac{1.8 \\times 10^4}{48\\pi} \\frac{6}{2} $$\n    $$ \\Delta T_{\\text{fuel}} = \\frac{1.8 \\times 10^4 \\times 3}{48\\pi} = \\frac{5.4 \\times 10^4}{48\\pi} = \\frac{1125}{\\pi}\\ \\mathrm{K} $$\n    $$ \\Delta T_{\\text{fuel}} \\approx 358.0986\\ \\mathrm{K} $$\n\n3.  计算总的中心线温度 $T(0)$：\n    $$ T(0) = T_c + \\Delta T_{\\text{film}} + \\Delta T_{\\text{fuel}} = 570\\ \\mathrm{K} + \\frac{225}{\\pi}\\ \\mathrm{K} + \\frac{1125}{\\pi}\\ \\mathrm{K} $$\n    $$ T(0) = 570 + \\frac{1350}{\\pi} \\approx 570 + 429.7183 = 999.7183\\ \\mathrm{K} $$\n\n将最终答案四舍五入到四位有效数字，得到 $999.7\\ \\mathrm{K}$。",
            "answer": "$$\\boxed{999.7}$$"
        },
        {
            "introduction": "我们最后的实践引入了时间维度，探讨热源如何随燃料燃耗在长时期内演变。随着反应堆的运行，可裂变和增殖性同位素的浓度会发生变化，直接影响局域功率密度。这项高级练习要求您构建并求解一个微分方程组（贝特曼 (Bateman) 方程），以追踪这种同位素的演化，从而将反应堆物理和中子学的原理与体积热源的动态建模直接联系起来。",
            "id": "4230052",
            "problem": "考虑一个单区域燃料模型，其中同位素核素密度在不随时间变化的中子通量下演化，并通过裂变能量沉积产生体积热源。目标是针对几个参数组，计算依赖于燃耗的体积热源和同位素存量演化，并报告特定的标量输出。所有计算必须基于反应率理论和放射性衰变的第一性原理，不得引用经验性简化公式。\n\n基本原理：\n- 反应率密度的定义：对于同位素 $i$，由过程 $p$ 引起的反应率密度为 $R_{i,p}(t)=\\phi\\,\\sigma_{i,p}\\,N_i(t)$，其中 $\\phi$ 是标量中子通量，单位为 $\\mathrm{m^{-2}\\,s^{-1}}$，$\\sigma_{i,p}$ 是微观截面，单位为 $\\mathrm{m^2}$，$N_i(t)$ 是核素密度，单位为 $\\mathrm{m^{-3}}$。\n- 控制核素密度变化的常微分方程（贝特曼 (Bateman) 型）：每个同位素的时间导数是根据反应率和放射性衰变计算的源项之和减去损耗项之和。\n- 体积热源是单位体积和时间内沉积的裂变能：如果 $E_{\\mathrm{f}}$ 是每次裂变释放的能量，单位为 $\\mathrm{J}$，$\\eta_{\\mathrm{dep}}$ 是沉积能量份额（无量纲），则 $q'''(t)=\\eta_{\\mathrm{dep}}\\,E_{\\mathrm{f}}\\sum_{i}R_{i,\\mathrm{f}}(t)$，其中总和是对所有易裂变同位素求和。\n- 燃耗是单位质量体积能量生成的时间积分：$B(t)=\\dfrac{1}{\\rho_{\\mathrm{fuel}}}\\int_{0}^{t}q'''(\\tau)\\,d\\tau$，其中 $\\rho_{\\mathrm{fuel}}$ 是燃料质量密度，单位为 $\\mathrm{kg\\,m^{-3}}$。\n\n模型和同位素：\n- 跟踪的同位素为 $\\mathrm{^{235}U}$、$\\mathrm{^{238}U}$、$\\mathrm{^{239}Np}$ 和 $\\mathrm{^{239}Pu}$。\n- 包含的过程：\n  - 对于 $\\mathrm{^{235}U}$：裂变和俘获。\n  - 对于 $\\mathrm{^{238}U}$：俘获生成 $\\mathrm{^{239}Np}$。\n  - 对于 $\\mathrm{^{239}Np}$：放射性 $\\beta^{-}$ 衰变为 $\\mathrm{^{239}Pu}$。\n  - 对于 $\\mathrm{^{239}Pu}$：裂变和俘获。\n- 中子通量 $\\phi$ 不随时间变化，单群（能量平均）微观截面为常数。\n\n从第一性原理构建的控制方程：\n- 令 $N_{235}(t)$、$N_{238}(t)$、$N_{\\mathrm{Np}}(t)$ 和 $N_{\\mathrm{Pu}}(t)$ 表示核素密度。使用反应率定义和放射性衰变定律，推导并积分以下耦合系统\n  - $\\frac{dN_{235}}{dt}$ = (因裂变造成的损耗) + (因俘获造成的损耗)，\n  - $\\frac{dN_{238}}{dt}$ = (因俘获造成的损耗)，\n  - $\\frac{dN_{\\mathrm{Np}}}{dt}$ = (由 $\\mathrm{^{238}U}$ 俘获产生) - (因衰变造成的损耗)，\n  - $\\frac{dN_{\\mathrm{Pu}}}{dt}$ = (由 $\\mathrm{^{239}Np}$ 衰变产生) - (因裂变造成的损耗) - (因俘获造成的损耗)。\n- 根据能量沉积的定义以及 $\\mathrm{^{235}U}$ 和 $\\mathrm{^{239}Pu}$ 的裂变率密度贡献来表达 $q'''(t)$。\n- 根据 $q'''(t)$ 对时间积分除以质量密度的定义来表达 $B(t)$。\n\n待使用的常数（所有值都是固定的，必须完全按照给定的值使用）：\n- 每次裂变产生的裂变能：$E_{\\mathrm{f}}=3.204\\times 10^{-11}\\ \\mathrm{J}$。\n- 沉积能量份额：$\\eta_{\\mathrm{dep}}=0.95$。\n- 燃料质量密度：$\\rho_{\\mathrm{fuel}}=10970\\ \\mathrm{kg\\,m^{-3}}$。\n- 微观截面（单群，热中子）：\n  - $\\sigma_{235,\\mathrm{f}}=5.80\\times 10^{-26}\\ \\mathrm{m^2}$，\n  - $\\sigma_{235,\\mathrm{c}}=1.00\\times 10^{-26}\\ \\mathrm{m^2}$，\n  - $\\sigma_{238,\\mathrm{c}}=2.70\\times 10^{-28}\\ \\mathrm{m^2}$，\n  - $\\sigma_{\\mathrm{Pu},\\mathrm{f}}=7.42\\times 10^{-26}\\ \\mathrm{m^2}$，\n  - $\\sigma_{\\mathrm{Pu},\\mathrm{c}}=2.70\\times 10^{-26}\\ \\mathrm{m^2}$。\n- $\\mathrm{^{239}Np}$ 半衰期：$T_{1/2,\\mathrm{Np}}=2.356\\ \\mathrm{days}$，衰变常数 $\\lambda_{\\mathrm{Np}}=\\dfrac{\\ln 2}{T_{1/2,\\mathrm{Np}}}$，其中时间单位为 $\\mathrm{s}$。\n- 总铀原子核素密度：$N_{\\mathrm{U,tot}}=2.45\\times 10^{28}\\ \\mathrm{m^{-3}}$。\n\n初始化规则：\n- 初始时，$N_{\\mathrm{Np}}(0)=0$ 且 $N_{\\mathrm{Pu}}(0)=0$。\n- 给定浓缩度原子分数 $x_{235}$，设置 $N_{235}(0)=x_{235}\\,N_{\\mathrm{U,tot}}$ 和 $N_{238}(0)=\\left(1-x_{235}\\right)\\,N_{\\mathrm{U,tot}}$。\n\n每个参数组所需的输出：\n- 最终时刻 $t_{\\mathrm{end}}$ 的体积热源 $q'''(t_{\\mathrm{end}})$，单位为 $\\mathrm{W\\,m^{-3}}$，表示为四舍五入到三位有效数字的浮点数。\n- 燃耗 $B(t_{\\mathrm{end}})$，单位为 $\\mathrm{MWd\\,kg^{-1}}$，表示为四舍五入到三位有效数字的浮点数，其中 $\\mathrm{MWd}$ 表示兆瓦日，且 $1\\ \\mathrm{MWd}=10^{6}\\ \\mathrm{W}\\times 86400\\ \\mathrm{s}$。\n- 区间末尾时 $\\mathrm{^{239}Pu}$ 在总裂变率密度中的易裂变份额，定义为 $f_{\\mathrm{Pu}}(t_{\\mathrm{end}})=\\frac{R_{\\mathrm{Pu},\\mathrm{f}}(t_{\\mathrm{end}})}{R_{235,\\mathrm{f}}(t_{\\mathrm{end}})+R_{\\mathrm{Pu},\\mathrm{f}}(t_{\\mathrm{end}})}$（无量纲），表示为四舍五入到三位有效数字的浮点数；如果分母为零，则该份额定义为零。\n\n角度单位不适用。所有物理结果必须使用指定单位。\n\n测试套件（三个参数组）：\n- 情况 1 (理想情况，浓缩燃料在典型热中子通量下经历中等时间)：\n  - 通量：$\\phi=1.00\\times 10^{18}\\ \\mathrm{m^{-2}\\,s^{-1}}$。\n  - 浓缩度：$x_{235}=0.045$。\n  - 最终时间：$t_{\\mathrm{end}}=100\\ \\mathrm{days}$。\n- 情况 2 (边界情况，零通量)：\n  - 通量：$\\phi=0.0\\ \\mathrm{m^{-2}\\,s^{-1}}$。\n  - 浓缩度：$x_{235}=0.045$。\n  - 最终时间：$t_{\\mathrm{end}}=100\\ \\mathrm{days}$。\n- 情况 3 (极端情况，初始无 $\\mathrm{^{235}U}$ 且有足够时间进行增殖)：\n  - 通量：$\\phi=1.00\\times 10^{18}\\ \\mathrm{m^{-2}\\,s^{-1}}$。\n  - 浓缩度：$x_{235}=0.0$。\n  - 最终时间：$t_{\\mathrm{end}}=600\\ \\mathrm{days}$。\n\n最终输出格式：\n- 你的程序应产生单行输出，包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身必须是一个三元列表 $[q'''(t_{\\mathrm{end}}),B(t_{\\mathrm{end}}),f_{\\mathrm{Pu}}(t_{\\mathrm{end}})]$。例如，输出应类似于 $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]$，其中每个 $a_i$、$b_i$ 和 $c_i$ 都是具有指定单位和舍入要求的浮点数。",
            "solution": "用户提供的问题已经过严格评估，并被确定为 **有效**。它在科学上基于核反应堆物理学原理，在数学上是适定的，并且没有任何事实错误、歧义或矛盾。因此，我们可以着手提供完整的解决方案。\n\n该问题要求在一个简化的单区域核燃料模型中计算随时间变化的同位素浓度、体积热生成和燃料燃耗。解决方法基于构建和积分一个耦合的一阶常微分方程（ODE）组，通常称为 贝特曼 (Bateman) 方程，这些方程描述了同位素核素密度的变化率。\n\n**1. 控制方程的构建**\n\n每个同位素 $i$ 的核素密度 $N_i(t)$ 的时间演化由产生项和损耗项的平衡控制。损耗项源于核反应（裂变和俘获）以及放射性衰变。产生项源于其他同位素的嬗变或衰变。\n\n基本反应率定义如下：\n- 同位素 $i$ 上过程 $p$ 的反应率密度：$R_{i,p}(t) = \\phi \\sigma_{i,p} N_i(t)$，其中 $\\phi$ 是恒定的中子通量，$\\sigma_{i,p}$ 是微观截面，$N_i(t)$ 是核素密度。\n- 同位素 $i$ 的放射性衰变率密度：$D_i(t) = \\lambda_i N_i(t)$，其中 $\\lambda_i$ 是衰变常数。\n\n根据这些原理，我们为模型中的四种同位素构建常微分方程：$\\mathrm{^{235}U}$（表示为 $N_{235}$）、$\\mathrm{^{238}U}$（表示为 $N_{238}$）、$\\mathrm{^{239}Np}$（表示为 $N_{\\mathrm{Np}}$）和 $\\mathrm{^{239}Pu}$（表示为 $N_{\\mathrm{Pu}}$）。\n\n- **$\\mathrm{^{235}U}$:** 通过裂变和中子俘获损耗。\n$$\n\\frac{dN_{235}}{dt} = -R_{235,\\mathrm{f}}(t) - R_{235,\\mathrm{c}}(t) = -(\\sigma_{235,\\mathrm{f}} + \\sigma_{235,\\mathrm{c}})\\phi N_{235}(t) = -\\lambda_{235,a}\\phi N_{235}(t)\n$$\n其中 $\\sigma_{235,a} = \\sigma_{235,\\mathrm{f}} + \\sigma_{235,\\mathrm{c}}$ 是 $\\mathrm{^{235}U}$ 的总吸收截面。\n\n- **$\\mathrm{^{238}U}$:** 通过中子俘获损耗，产生 $\\mathrm{^{239}Np}$。\n$$\n\\frac{dN_{238}}{dt} = -R_{238,\\mathrm{c}}(t) = -\\sigma_{238,\\mathrm{c}}\\phi N_{238}(t)\n$$\n\n- **$\\mathrm{^{239}Np}$:** 由 $\\mathrm{^{238}U}$ 俘获产生，通过 $\\beta^-$ 衰变损耗为 $\\mathrm{^{239}Pu}$。\n$$\n\\frac{dN_{\\mathrm{Np}}}{dt} = R_{238,\\mathrm{c}}(t) - \\lambda_{\\mathrm{Np}}N_{\\mathrm{Np}}(t) = \\sigma_{238,\\mathrm{c}}\\phi N_{238}(t) - \\lambda_{\\mathrm{Np}}N_{\\mathrm{Np}}(t)\n$$\n其中 $\\lambda_{\\mathrm{Np}} = \\frac{\\ln 2}{T_{1/2,\\mathrm{Np}}}$ 是 $\\mathrm{^{239}Np}$ 的衰变常数。\n\n- **$\\mathrm{^{239}Pu}$:** 由 $\\mathrm{^{239}Np}$ 衰变产生，通过裂变和中子俘获损耗。\n$$\n\\frac{dN_{\\mathrm{Pu}}}{dt} = \\lambda_{\\mathrm{Np}}N_{\\mathrm{Np}}(t) - (R_{\\mathrm{Pu},\\mathrm{f}}(t) + R_{\\mathrm{Pu},\\mathrm{c}}(t)) = \\lambda_{\\mathrm{Np}}N_{\\mathrm{Np}}(t) - (\\sigma_{\\mathrm{Pu},\\mathrm{f}} + \\sigma_{\\mathrm{Pu},\\mathrm{c}})\\phi N_{\\mathrm{Pu}}(t) = \\lambda_{\\mathrm{Np}}N_{\\mathrm{Np}}(t) - \\sigma_{\\mathrm{Pu},a}\\phi N_{\\mathrm{Pu}}(t)\n$$\n其中 $\\sigma_{\\mathrm{Pu},a} = \\sigma_{\\mathrm{Pu},\\mathrm{f}} + \\sigma_{\\mathrm{Pu},\\mathrm{c}}$ 是 $\\mathrm{^{239}Pu}$ 的总吸收截面。\n\n这是一个线性、一阶、常系数的常微分方程组。令状态向量为 $\\vec{N}(t) = [N_{235}(t), N_{238}(t), N_{\\mathrm{Np}}(t), N_{\\mathrm{Pu}}(t)]^T$。该系统可以写成矩阵形式 $\\frac{d\\vec{N}}{dt} = \\mathbf{A}\\vec{N}$，其中矩阵 $\\mathbf{A}$ 是：\n$$\n\\mathbf{A} = \\begin{pmatrix}\n-\\sigma_{235,a}\\phi & 0 & 0 & 0 \\\\\n0 & -\\sigma_{238,c}\\phi & 0 & 0 \\\\\n0 & \\sigma_{238,c}\\phi & -\\lambda_{\\mathrm{Np}} & 0 \\\\\n0 & 0 & \\lambda_{\\mathrm{Np}} & -\\sigma_{\\mathrm{Pu},a}\\phi\n\\end{pmatrix}\n$$\n初始条件由 $N_{235}(0) = x_{235}N_{\\mathrm{U,tot}}$、$N_{238}(0) = (1-x_{235})N_{\\mathrm{U,tot}}$ 和 $N_{\\mathrm{Np}}(0) = N_{\\mathrm{Pu}}(0) = 0$ 给出。\n\n**2. 输出量的计算**\n\n所需的输出由解 $\\vec{N}(t)$ 导出。\n\n- **体积热源 ($q'''$)**: 热源是所有易裂变同位素裂变事件沉积的能量总和。\n$$\nq'''(t) = \\eta_{\\mathrm{dep}}E_{\\mathrm{f}} \\left( R_{235,\\mathrm{f}}(t) + R_{\\mathrm{Pu},\\mathrm{f}}(t) \\right) = \\eta_{\\mathrm{dep}}E_{\\mathrm{f}}\\phi \\left( \\sigma_{235,\\mathrm{f}}N_{235}(t) + \\sigma_{\\mathrm{Pu},\\mathrm{f}}N_{\\mathrm{Pu}}(t) \\right)\n$$\n要求在 $t=t_{\\mathrm{end}}$ 时的值，单位为 $\\mathrm{W\\,m^{-3}}$。\n\n- **燃耗 ($B$)**: 燃耗是单位质量燃料随时间释放的总能量。\n$$\nB(t) = \\frac{1}{\\rho_{\\mathrm{fuel}}} \\int_0^t q'''(\\tau)d\\tau = \\frac{\\eta_{\\mathrm{dep}}E_{\\mathrm{f}}\\phi}{\\rho_{\\mathrm{fuel}}} \\int_0^t \\left( \\sigma_{235,\\mathrm{f}}N_{235}(\\tau) + \\sigma_{\\mathrm{Pu},\\mathrm{f}}N_{\\mathrm{Pu}}(\\tau) \\right) d\\tau\n$$\n要求在 $t=t_{\\mathrm{end}}$ 时的值，单位为 $\\mathrm{MWd\\,kg^{-1}}$，这需要从基本单位 $\\mathrm{J\\,kg^{-1}}$ 进行单位转换。转换因子是 $1\\ \\mathrm{MWd} = 10^6\\ \\mathrm{W} \\times 86400\\ \\mathrm{s} = 8.64\\times 10^{10}\\ \\mathrm{J}$。\n\n- **$\\mathrm{^{239}Pu}$ 易裂变份额 ($f_{\\mathrm{Pu}}$)**: 这是 $\\mathrm{^{239}Pu}$ 裂变率与总裂变率之比。\n$$\nf_{\\mathrm{Pu}}(t) = \\frac{R_{\\mathrm{Pu},\\mathrm{f}}(t)}{R_{235,\\mathrm{f}}(t) + R_{\\mathrm{Pu},\\mathrm{f}}(t)} = \\frac{\\sigma_{\\mathrm{Pu},\\mathrm{f}}N_{\\mathrm{Pu}}(t)}{\\sigma_{235,\\mathrm{f}}N_{235}(t) + \\sigma_{\\mathrm{Pu},\\mathrm{f}}N_{\\mathrm{Pu}}(t)}\n$$\n通量项 $\\phi$ 被约去。如果分母为零，则该值定义为 $0$。要求在 $t=t_{\\mathrm{end}}$ 时的值。\n\n**3. 数值解策略**\n\n虽然该系统存在解析解（贝特曼 (Bateman) 解），但其代数形式变得复杂。一种更稳健和通用的方法是数值求解该常微分方程组。为了计算燃耗（涉及核素密度的积分），我们扩充状态向量。\n\n令扩充状态向量为 $\\vec{Y}(t) = [Y_0, Y_1, Y_2, Y_3, Y_4, Y_5]^T$，其中：\n- $Y_0(t) = N_{235}(t)$\n- $Y_1(t) = N_{238}(t)$\n- $Y_2(t) = N_{\\mathrm{Np}}(t)$\n- $Y_3(t) = N_{\\mathrm{Pu}}(t)$\n- $Y_4(t) = \\int_0^t N_{235}(\\tau)d\\tau$\n- $Y_5(t) = \\int_0^t N_{\\mathrm{Pu}}(\\tau)d\\tau$\n\n相应的扩充常微分方程组为：\n$$\n\\frac{d\\vec{Y}}{dt} = \n\\begin{pmatrix}\n-\\sigma_{235,a}\\phi & 0 & 0 & 0 & 0 & 0 \\\\\n0 & -\\sigma_{238,c}\\phi & 0 & 0 & 0 & 0 \\\\\n0 & \\sigma_{238,c}\\phi & -\\lambda_{\\mathrm{Np}} & 0 & 0 & 0 \\\\\n0 & 0 & \\lambda_{\\mathrm{Np}} & -\\sigma_{\\mathrm{Pu},a}\\phi & 0 & 0 \\\\\n1 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\nY_0 \\\\ Y_1 \\\\ Y_2 \\\\ Y_3 \\\\ Y_4 \\\\ Y_5\n\\end{pmatrix}\n+\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n初始条件为 $\\vec{Y}(0) = [N_{235}(0), N_{238}(0), 0, 0, 0, 0]^T$。\n\n使用高质量的数值常微分方程求解器（如 `scipy.integrate.solve_ivp`）对该系统从 $t=0$ 到 $t=t_{\\mathrm{end}}$进行积分。在 $t_{\\mathrm{end}}$ 时的解 $\\vec{Y}(t_{\\mathrm{end}})$ 提供了计算最终输出所需的所有量。燃耗积分项直接计算为 $B(t_{\\mathrm{end}}) = \\frac{\\eta_{\\mathrm{dep}}E_{\\mathrm{f}}\\phi}{\\rho_{\\mathrm{fuel}}} \\left( \\sigma_{235,\\mathrm{f}}Y_4(t_{\\mathrm{end}}) + \\sigma_{\\mathrm{Pu},\\mathrm{f}}Y_5(t_{\\mathrm{end}}) \\right)$。然后将所有结果转换为指定单位，并四舍五入到三位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves a set of burnup problems for a simplified nuclear fuel model.\n    \"\"\"\n\n    # --- Constants ---\n    E_F = 3.204e-11  # J per fission\n    ETA_DEP = 0.95  # Dimensionless deposited energy fraction\n    RHO_FUEL = 10970.0  # kg/m^3\n    N_U_TOT = 2.45e28  # m^-3, total U atom density\n    T_HALF_NP = 2.356  # days\n    \n    # Microscopic cross sections (m^2)\n    SIG_235_F = 5.80e-26\n    SIG_235_C = 1.00e-26\n    SIG_238_C = 2.70e-28\n    SIG_PU_F = 7.42e-26\n    SIG_PU_C = 2.70e-26\n\n    # Derived constants\n    S_PER_DAY = 86400.0\n    J_PER_MWD = 8.64e10  # 1e6 W * 86400 s\n    T_HALF_NP_S = T_HALF_NP * S_PER_DAY\n    LAMBDA_NP = np.log(2) / T_HALF_NP_S  # s^-1\n    \n    SIG_235_A = SIG_235_F + SIG_235_C\n    SIG_PU_A = SIG_PU_F + SIG_PU_C\n\n    # Test cases from the problem statement.\n    test_cases = [\n        # (flux [m^-2 s^-1], U-235 enrichment, end time [days])\n        (1.00e18, 0.045, 100.0),\n        (0.0, 0.045, 100.0),\n        (1.00e18, 0.0, 600.0),\n    ]\n\n    results = []\n\n    def round_sig(val, sig_figs=3):\n        \"\"\"Rounds a float to a specified number of significant figures.\"\"\"\n        if val == 0:\n            return 0.0\n        return float(f\"{val:.{sig_figs}g}\")\n\n    for case in test_cases:\n        phi, x_235, t_end_days = case\n        t_end_s = t_end_days * S_PER_DAY\n\n        # Effective reaction constants (s^-1)\n        # These are phi*sigma, which act as effective decay/transmutation constants\n        lambda_235_a_eff = SIG_235_A * phi\n        lambda_238_c_eff = SIG_238_C * phi\n        lambda_pu_a_eff = SIG_PU_A * phi\n\n        # Initial number densities (m^-3)\n        N235_0 = x_235 * N_U_TOT\n        N238_0 = (1.0 - x_235) * N_U_TOT\n        NNp_0 = 0.0\n        NPu_0 = 0.0\n        \n        # Augmented state vector Y = [N235, N238, NNp, NPu, int(N235), int(NPu)]\n        Y0 = np.array([N235_0, N238_0, NNp_0, NPu_0, 0.0, 0.0])\n\n        # Define the system of ODEs: dY/dt = f(t, Y)\n        def dydt(t, Y):\n            N235, N238, NNp, NPu, _, _ = Y\n            \n            dN235_dt = -lambda_235_a_eff * N235\n            dN238_dt = -lambda_238_c_eff * N238\n            dNNp_dt = lambda_238_c_eff * N238 - LAMBDA_NP * NNp\n            dNPu_dt = LAMBDA_NP * NNp - lambda_pu_a_eff * NPu\n            \n            # Derivatives for the integral components\n            dIntN235_dt = N235\n            dIntNPu_dt = NPu\n            \n            return np.array([dN235_dt, dN238_dt, dNNp_dt, dNPu_dt, dIntN235_dt, dIntNPu_dt])\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            dydt,\n            t_span=[0, t_end_s],\n            y0=Y0,\n            t_eval=[t_end_s],\n            method='RK45',\n            rtol=1e-9,\n            atol=1e-12\n        )\n        \n        Y_end = sol.y[:, -1]\n        N235_end, N238_end, NNp_end, NPu_end, IntN235_end, IntNPu_end = Y_end\n\n        # --- Calculate outputs ---\n\n        # 1. Volumetric heat source q'''(t_end) in W/m^3\n        total_fission_rate_end = phi * (SIG_235_F * N235_end + SIG_PU_F * NPu_end)\n        q_ppp_end = ETA_DEP * E_F * total_fission_rate_end\n\n        # 2. Burnup B(t_end) in MWd/kg\n        # Integral part for burnup calculation\n        integral_term = SIG_235_F * IntN235_end + SIG_PU_F * IntNPu_end\n        burnup_j_per_kg = (ETA_DEP * E_F * phi / RHO_FUEL) * integral_term\n        burnup_mwd_per_kg = burnup_j_per_kg / J_PER_MWD\n        \n        # 3. Pu fissile sharing fraction f_Pu(t_end)\n        # Note: phi cancels in the fraction for phi > 0\n        fission_rate_pu_end = SIG_PU_F * NPu_end\n        fission_rate_235_end = SIG_235_F * N235_end\n        total_fission_cross_section_eff = fission_rate_235_end + fission_rate_pu_end\n        \n        if total_fission_cross_section_eff == 0.0:\n            f_pu_end = 0.0\n        else:\n            f_pu_end = fission_rate_pu_end / total_fission_cross_section_eff\n\n        # Round all results to 3 significant figures\n        q_ppp_out = round_sig(q_ppp_end, 3)\n        B_out = round_sig(burnup_mwd_per_kg, 3)\n        f_pu_out = round_sig(f_pu_end, 3)\n        \n        results.append([q_ppp_out, B_out, f_pu_out])\n        \n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}