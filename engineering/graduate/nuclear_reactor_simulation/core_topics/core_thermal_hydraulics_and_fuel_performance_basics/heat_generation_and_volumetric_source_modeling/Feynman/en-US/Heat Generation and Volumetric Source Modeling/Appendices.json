{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing the thermal performance of a nuclear reactor is to master the relationship between heat generation and temperature. This practice grounds your understanding in the fundamentals by tasking you with solving the steady-state heat conduction equation for simple geometries with a uniform volumetric source. By deriving and implementing these canonical solutions, you will build a foundational toolkit for predicting temperature profiles, which is essential for ensuring materials remain within their safety limits. ",
            "id": "4230060",
            "problem": "A nuclear fuel element undergoing fission can be idealized as a one-dimensional (1D) body with uniform volumetric heat generation. In steady state, heat is removed at the surface either by convection to a coolant or by maintaining a fixed surface temperature. Starting from conservation of energy and the constitutive relation of Fourier’s law for heat conduction, derive analytical expressions for the steady-state temperature distribution in three canonical geometries: a slab (planar), a solid cylinder (radial), and a solid sphere (radial), each with uniform volumetric heat generation. Use symmetry at the centerline and physically consistent boundary conditions at the outer surface. Then design a program to evaluate, for given parameter sets, the centerline temperature and the surface heat flux.\n\nFundamental base and assumptions to employ:\n- Energy conservation in a differential control volume under steady conditions, with constant thermal conductivity and uniform volumetric heat generation.\n- Fourier’s law of heat conduction relating heat flux to temperature gradient.\n- Symmetry at the center ($dT/dx = 0$ or $dT/dr = 0$ at $x=0$ or $r=0$).\n- At the surface, either a convective boundary condition with fluid at temperature $T_\\infty$ and convection coefficient $h$, or a fixed surface temperature $T_s$.\n\nYou must:\n1. Derive for each geometry the analytical expressions that permit computation of the centerline temperature $T(0)$ and the surface heat flux $q''$ in terms of the geometry size, thermal conductivity, volumetric heat generation, and boundary parameters.\n2. Implement a program that, for each test case specified below, computes:\n   - The centerline temperature in $\\mathrm{K}$.\n   - The outward surface heat flux in $\\mathrm{W/m^2}$.\n3. Express the final output as a single line containing a comma-separated list enclosed in square brackets. The list must contain, for each test case in order, first the centerline temperature in $\\mathrm{K}$, then the surface heat flux in $\\mathrm{W/m^2}$. Round each floating-point result to six decimal places.\n\nGeometry conventions:\n- Slab: model half-thickness domain $0 \\le x \\le L$ with symmetry at $x=0$ and boundary at $x=L$.\n- Cylinder: model radial domain $0 \\le r \\le R$ with symmetry at $r=0$ and boundary at $r=R$.\n- Sphere: model radial domain $0 \\le r \\le R$ with symmetry at $r=0$ and boundary at $r=R$.\n\nUnits:\n- Thermal conductivity $k$ in $\\mathrm{W/(m\\cdot K)}$.\n- Volumetric heat generation $q'''$ in $\\mathrm{W/m^3}$.\n- Convection coefficient $h$ in $\\mathrm{W/(m^2\\cdot K)}$.\n- Lengths $L$ or $R$ in $\\mathrm{m}$.\n- Temperatures $T_\\infty$ and $T_s$ in $\\mathrm{K}$.\n- Heat flux $q''$ in $\\mathrm{W/m^2}$.\n\nTest suite:\n- Case $1$ (slab, convective boundary): $L = 0.005\\,\\mathrm{m}$, $k = 20\\,\\mathrm{W/(m\\cdot K)}$, $q''' = 1.5\\times 10^8\\,\\mathrm{W/m^3}$, $h = 12000\\,\\mathrm{W/(m^2\\cdot K)}$, $T_\\infty = 570\\,\\mathrm{K}$.\n- Case $2$ (cylinder, fixed surface temperature): $R = 0.004\\,\\mathrm{m}$, $k = 3\\,\\mathrm{W/(m\\cdot K)}$, $q''' = 5.0\\times 10^8\\,\\mathrm{W/m^3}$, $T_s = 620\\,\\mathrm{K}$.\n- Case $3$ (sphere, convective boundary): $R = 0.010\\,\\mathrm{m}$, $k = 15\\,\\mathrm{W/(m\\cdot K)}$, $q''' = 2.0\\times 10^7\\,\\mathrm{W/m^3}$, $h = 8000\\,\\mathrm{W/(m^2\\cdot K)}$, $T_\\infty = 350\\,\\mathrm{K}$.\n- Case $4$ (slab, convective boundary, zero generation edge case): $L = 0.003\\,\\mathrm{m}$, $k = 12\\,\\mathrm{W/(m\\cdot K)}$, $q''' = 0\\,\\mathrm{W/m^3}$, $h = 10000\\,\\mathrm{W/(m^2\\cdot K)}$, $T_\\infty = 300\\,\\mathrm{K}$.\n\nFinal output format:\n- Your program should produce a single line containing the results as a comma-separated list enclosed in square brackets, ordered as:\n  $[T_{\\text{center,case1}}, q''_{\\text{surface,case1}}, T_{\\text{center,case2}}, q''_{\\text{surface,case2}}, T_{\\text{center,case3}}, q''_{\\text{surface,case3}}, T_{\\text{center,case4}}, q''_{\\text{surface,case4}}]$,\n  with each value rounded to six decimal places and units as specified above.",
            "solution": "The problem requires the derivation of analytical expressions for steady-state temperature distribution and heat flux in canonical one-dimensional geometries (planar slab, cylinder, sphere) with uniform volumetric heat generation, followed by a computational implementation. The analysis begins from the first principles of energy conservation.\n\nThe governing equation for steady-state heat conduction with a uniform volumetric heat source $q'''$ and constant thermal conductivity $k$ is derived from an energy balance on a differential control volume. It is a specific form of the Poisson equation:\n$$ \\nabla^2 T = -\\frac{q'''}{k} $$\nHere, $T$ is the temperature and $\\nabla^2$ is the Laplacian operator. We will solve this equation for each geometry subject to the specified boundary conditions.\n\n### General Derivation Procedure\nFor each geometry, the procedure is as follows:\n1.  Express the heat equation in the appropriate coordinate system.\n2.  Integrate the equation twice to obtain the general solution for the temperature profile $T(y)$, where $y$ is the spatial coordinate ($x$ for slab, $r$ for cylinder/sphere). This introduces two integration constants, $C_1$ and $C_2$.\n3.  Apply the first boundary condition, which is symmetry at the center ($x=0$ or $r=0$). This states that the temperature gradient is zero, $\\frac{dT}{dy}|_{y=0}=0$, which determines the first constant $C_1$.\n4.  The second constant, $C_2$, is determined by the boundary condition at the outer surface. The centerline temperature $T(0)$ is directly related to $C_2$.\n5.  Two types of outer boundary conditions are considered:\n    a. Fixed temperature $T_s$ at the surface.\n    b. Convection to a fluid at temperature $T_\\infty$ with a heat transfer coefficient $h$. This condition is expressed by Newton's law of cooling, which equates the conductive heat flux at the surface to the convective heat flux: $q''_s = -k \\frac{dT}{dy}|_{surface} = h(T_{surface} - T_\\infty)$.\n6.  The surface heat flux, $q''_s$, can be determined either from Fourier's law, $q''_s = -k \\frac{dT}{dy}|_{surface}$, or by a global energy balance: in steady state, the total heat generated within the volume must be removed at the surface. Per unit area, this gives $q''_s = (q''' \\times \\text{Volume}) / (\\text{Surface Area})$.\n\n### 1. Planar Slab Geometry\nFor a slab of half-thickness $L$, we consider the domain $0 \\le x \\le L$. The heat equation in one-dimensional Cartesian coordinates is:\n$$ \\frac{d^2T}{dx^2} = -\\frac{q'''}{k} $$\nIntegrating once with respect to $x$:\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k}x + C_1 $$\nApplying the symmetry boundary condition at the centerline, $\\frac{dT}{dx}|_{x=0} = 0$, gives $C_1 = 0$. The temperature gradient is:\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k}x $$\nIntegrating a second time:\n$$ T(x) = -\\frac{q'''}{2k}x^2 + C_2 $$\nThe centerline temperature is $T(0) = C_2$.\n\n**Surface Heat Flux $q''_s$**: A global energy balance on the half-slab (volume per unit area is $L$) dictates that the heat generated per unit area, $q'''L$, must exit at the surface $x=L$. Thus,\n$$ q''_s = q'''L $$\nThis result is independent of the boundary condition type. It can be verified using Fourier's law once $T(x)$ is known: $q''_s = -k \\frac{dT}{dx}|_{x=L} = -k(-\\frac{q'''}{k}L) = q'''L$.\n\n**Centerline Temperature $T(0)$**:\na) **Fixed Surface Temperature**: At $x=L$, $T(L) = T_s$.\n$$ T(L) = T_s = -\\frac{q'''L^2}{2k} + C_2 $$\nSolving for $C_2$ gives the centerline temperature:\n$$ T(0) = C_2 = T_s + \\frac{q'''L^2}{2k} $$\nb) **Convective Boundary**: At $x=L$, $-k\\frac{dT}{dx}|_{x=L} = h(T(L) - T_\\infty)$. We know $q''_s = -k\\frac{dT}{dx}|_{x=L} = q'''L$. Thus, $q'''L = h(T(L) - T_\\infty)$, which gives the surface temperature $T(L) = T_\\infty + \\frac{q'''L}{h}$.\nSubstituting $T(L)$ into the general temperature profile expression at $x=L$:\n$$ T(L) = T_\\infty + \\frac{q'''L}{h} = -\\frac{q'''L^2}{2k} + C_2 $$\nSolving for $C_2$ gives the centerline temperature:\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k} = T_\\infty + q'''L\\left(\\frac{1}{h} + \\frac{L}{2k}\\right) $$\n\n### 2. Solid Cylinder Geometry\nFor a solid cylinder of radius $R$, we consider the domain $0 \\le r \\le R$. The heat equation in one-dimensional cylindrical coordinates is:\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{dT}{dr}\\right) = -\\frac{q'''}{k} $$\nIntegrating once yields:\n$$ r\\frac{dT}{dr} = -\\frac{q'''}{2k}r^2 + C_1 $$\nApplying the symmetry condition $\\frac{dT}{dr}|_{r=0} = 0$ (or, equivalently, requiring the temperature to be finite at $r=0$), we must have $C_1=0$.\n$$ \\frac{dT}{dr} = -\\frac{q'''}{2k}r $$\nIntegrating a second time:\n$$ T(r) = -\\frac{q'''}{4k}r^2 + C_2 $$\nThe centerline temperature is $T(0) = C_2$.\n\n**Surface Heat Flux $q''_s$**: An energy balance on a cylinder of length $H$ gives: Volume $V = \\pi R^2 H$, Surface Area $A = 2\\pi R H$. The total heat generated is $q'''V$. The surface flux is $q''_s = (q'''V)/A = (q'''\\pi R^2 H) / (2\\pi R H)$. Thus,\n$$ q''_s = \\frac{q'''R}{2} $$\nThis is confirmed by Fourier's law: $q''_s = -k \\frac{dT}{dr}|_{r=R} = -k(-\\frac{q'''}{2k}R) = \\frac{q'''R}{2}$.\n\n**Centerline Temperature $T(0)$**:\na) **Fixed Surface Temperature**: At $r=R$, $T(R)=T_s$.\n$$ T(R) = T_s = -\\frac{q'''R^2}{4k} + C_2 $$\n$$ T(0) = C_2 = T_s + \\frac{q'''R^2}{4k} $$\nb) **Convective Boundary**: At $r=R$, $q''_s = h(T(R) - T_\\infty)$. So, $\\frac{q'''R}{2} = h(T(R) - T_\\infty)$, which gives $T(R) = T_\\infty + \\frac{q'''R}{2h}$.\nSubstituting this into the profile at $r=R$:\n$$ T(R) = T_\\infty + \\frac{q'''R}{2h} = -\\frac{q'''R^2}{4k} + C_2 $$\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''R}{2h} + \\frac{q'''R^2}{4k} = T_\\infty + \\frac{q'''R}{2}\\left(\\frac{1}{h} + \\frac{R}{2k}\\right) $$\n\n### 3. Solid Sphere Geometry\nFor a solid sphere of radius $R$, we consider the domain $0 \\le r \\le R$. The heat equation in one-dimensional spherical coordinates is:\n$$ \\frac{1}{r^2}\\frac{d}{dr}\\left(r^2\\frac{dT}{dr}\\right) = -\\frac{q'''}{k} $$\nIntegrating once:\n$$ r^2\\frac{dT}{dr} = -\\frac{q'''}{3k}r^3 + C_1 $$\nThe symmetry condition $\\frac{dT}{dr}|_{r=0} = 0$ requires $C_1=0$.\n$$ \\frac{dT}{dr} = -\\frac{q'''}{3k}r $$\nIntegrating a second time:\n$$ T(r) = -\\frac{q'''}{6k}r^2 + C_2 $$\nThe centerline temperature is $T(0) = C_2$.\n\n**Surface Heat Flux $q''_s$**: An energy balance gives: Volume $V = \\frac{4}{3}\\pi R^3$, Surface Area $A = 4\\pi R^2$. The surface flux is $q''_s = (q'''V)/A = (q'''\\frac{4}{3}\\pi R^3) / (4\\pi R^2)$.\n$$ q''_s = \\frac{q'''R}{3} $$\nThis is confirmed by Fourier's law: $q''_s = -k \\frac{dT}{dr}|_{r=R} = -k(-\\frac{q'''}{3k}R) = \\frac{q'''R}{3}$.\n\n**Centerline Temperature $T(0)$**:\na) **Fixed Surface Temperature**: At $r=R$, $T(R)=T_s$.\n$$ T(R) = T_s = -\\frac{q'''R^2}{6k} + C_2 $$\n$$ T(0) = C_2 = T_s + \\frac{q'''R^2}{6k} $$\nb) **Convective Boundary**: At $r=R$, $q''_s = h(T(R) - T_\\infty)$. So, $\\frac{q'''R}{3} = h(T(R) - T_\\infty)$, which gives $T(R) = T_\\infty + \\frac{q'''R}{3h}$.\nSubstituting this into the profile at $r=R$:\n$$ T(R) = T_\\infty + \\frac{q'''R}{3h} = -\\frac{q'''R^2}{6k} + C_2 $$\n$$ T(0) = C_2 = T_\\infty + \\frac{q'''R}{3h} + \\frac{q'''R^2}{6k} = T_\\infty + \\frac{q'''R}{3}\\left(\\frac{1}{h} + \\frac{R}{2k}\\right) $$\n\nThese derived formulae are now implemented to solve the provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes centerline temperature and surface heat flux for various\n    geometries and boundary conditions in steady-state heat conduction.\n    \"\"\"\n    \n    # Test cases are structured as dictionaries for clarity.\n    # 'geom': 'slab', 'cylinder', 'sphere'\n    # 'bc_type': 'conv', 'fixed_T'\n    # 'params': dictionary of physical and geometrical parameters\n    test_cases_data = [\n        {\n            \"geom\": \"slab\", \"bc_type\": \"conv\", \n            \"params\": {\"L\": 0.005, \"k\": 20.0, \"q_gen\": 1.5e8, \"h\": 12000.0, \"T_inf\": 570.0}\n        },\n        {\n            \"geom\": \"cylinder\", \"bc_type\": \"fixed_T\", \n            \"params\": {\"R\": 0.004, \"k\": 3.0, \"q_gen\": 5.0e8, \"T_s\": 620.0}\n        },\n        {\n            \"geom\": \"sphere\", \"bc_type\": \"conv\", \n            \"params\": {\"R\": 0.010, \"k\": 15.0, \"q_gen\": 2.0e7, \"h\": 8000.0, \"T_inf\": 350.0}\n        },\n        {\n            \"geom\": \"slab\", \"bc_type\": \"conv\", \n            \"params\": {\"L\": 0.003, \"k\": 12.0, \"q_gen\": 0.0, \"h\": 10000.0, \"T_inf\": 300.0}\n        }\n    ]\n\n    results = []\n\n    for case in test_cases_data:\n        geom = case[\"geom\"]\n        bc_type = case[\"bc_type\"]\n        p = case[\"params\"]\n        \n        T_center = 0.0\n        q_surface = 0.0\n\n        if geom == \"slab\":\n            # Surface heat flux from energy balance: q_s = q''' * L\n            q_surface = p[\"q_gen\"] * p[\"L\"]\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q'''*L/h + q'''*L^2/(2*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"L\"]**2 / (2 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*L^2/(2*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"L\"]**2 / (2 * p[\"k\"])\n\n        elif geom == \"cylinder\":\n            # Surface heat flux from energy balance: q_s = q''' * R / 2\n            q_surface = p[\"q_gen\"] * p[\"R\"] / 2\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q_s/h + q'''*R^2/(4*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"R\"]**2 / (4 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*R^2/(4*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"R\"]**2 / (4 * p[\"k\"])\n\n        elif geom == \"sphere\":\n            # Surface heat flux from energy balance: q_s = q''' * R / 3\n            q_surface = p[\"q_gen\"] * p[\"R\"] / 3\n            \n            if bc_type == \"conv\":\n                # T_center = T_inf + q_s/h + q'''*R^2/(6*k)\n                T_center = p[\"T_inf\"] + q_surface / p[\"h\"] + p[\"q_gen\"] * p[\"R\"]**2 / (6 * p[\"k\"])\n            elif bc_type == \"fixed_T\":\n                # T_center = T_s + q'''*R^2/(6*k)\n                T_center = p[\"T_s\"] + p[\"q_gen\"] * p[\"R\"]**2 / (6 * p[\"k\"])\n                \n        results.append(T_center)\n        results.append(q_surface)\n\n    # Format the final output string exactly as required, with rounding to six decimal places.\n    # Using format specifier f\"{x:.6f}\" ensures trailing zeros.\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "While the uniform source model is instructive, real reactor fuel pellets exhibit a non-uniform power distribution due to phenomena like neutron flux depression and rim effects. This exercise challenges you to advance your model by incorporating a spatially varying heat source, specifically a parabolic profile $q'''(r) = S_{0}(1 + \\beta r^{2}/R^{2})$, common in light water reactors. Solving this problem will demonstrate how a more realistic source term directly impacts the peak fuel centerline temperature, a critical parameter in reactor design and safety analysis. ",
            "id": "4230065",
            "problem": "A right circular cylinder of uranium dioxide fuel (radius $R$) is modeled as a homogeneous, isotropic solid with constant thermal conductivity $k$ under steady-state conditions. Fission power is generated volumetrically with a radially varying source density $q'''(r)$ due to resonance self-shielding and rim peaking in an operating light water reactor. The volumetric source is approximated by the form $q'''(r) = S_{0}\\left(1 + \\beta \\frac{r^{2}}{R^{2}}\\right)$, where $S_{0}$ is an unknown normalization constant and $\\beta$ is a given dimensionless parameter. The total heat generated per unit length of the fuel rod, known as the linear heat rate $q^{\\prime}$, must equal the cross-sectional integral of $q'''(r)$. Heat removal at the fuel surface is represented by an effective convective boundary condition at $r=R$, $-k\\,\\frac{dT}{dr}\\big|_{r=R} = h\\left(T(R) - T_{\\mathrm{c}}\\right)$, where $h$ is an effective heat transfer coefficient accounting for the solid gap and cladding heat transfer to the coolant, and $T_{\\mathrm{c}}$ is the coolant bulk temperature. Symmetry requires the temperature gradient to remain finite at $r=0$.\n\nStarting from the steady-state energy conservation in cylindrical coordinates with volumetric heat generation and Fourier’s law of heat conduction, derive the temperature distribution and compute the centerline temperature $T(0)$.\n\nUse the values $R = 4.0\\ \\mathrm{mm}$, $k = 3.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$, $h = 1.0\\times 10^{4}\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$, $T_{\\mathrm{c}} = 570\\ \\mathrm{K}$, $q^{\\prime} = 1.8\\times 10^{4}\\ \\mathrm{W\\,m^{-1}}$, and $\\beta = 2$.\n\nRound your final answer to four significant figures. Express the final temperature in kelvin.",
            "solution": "### **Solution Derivation**\n\nThe governing equation for steady-state heat conduction in a one-dimensional cylindrical system with volumetric heat generation $q'''(r)$ is the heat diffusion equation:\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r k \\frac{dT}{dr} \\right) + q'''(r) = 0 $$\nSince the thermal conductivity $k$ is constant, this simplifies to:\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) = -\\frac{q'''(r)}{k} $$\n\nFirst, we must determine the normalization constant $S_0$ using the given linear heat rate $q^{\\prime}$. The linear heat rate is the integral of the volumetric heat source over the cross-sectional area $A = \\pi R^2$.\n$$ q^{\\prime} = \\int_{0}^{R} q'''(r) (2\\pi r) dr $$\nSubstituting the expression for $q'''(r)$:\n$$ q^{\\prime} = \\int_{0}^{R} S_{0}\\left(1 + \\beta \\frac{r^{2}}{R^{2}}\\right) (2\\pi r) dr = 2\\pi S_0 \\int_{0}^{R} \\left(r + \\frac{\\beta r^3}{R^2}\\right) dr $$\n$$ q^{\\prime} = 2\\pi S_0 \\left[ \\frac{r^2}{2} + \\frac{\\beta r^4}{4R^2} \\right]_{0}^{R} = 2\\pi S_0 \\left( \\frac{R^2}{2} + \\frac{\\beta R^4}{4R^2} \\right) = 2\\pi S_0 \\left( \\frac{R^2}{2} + \\frac{\\beta R^2}{4} \\right) $$\n$$ q^{\\prime} = \\pi S_0 R^2 \\left(1 + \\frac{\\beta}{2}\\right) $$\nSolving for $S_0$:\n$$ S_0 = \\frac{q^{\\prime}}{\\pi R^2 (1 + \\beta/2)} $$\n\nNow, substitute $q'''(r)$ into the heat diffusion equation and integrate.\n$$ \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right) = -\\frac{r}{k} S_0 \\left(1 + \\frac{\\beta r^2}{R^2}\\right) = -\\frac{S_0}{k} \\left(r + \\frac{\\beta r^3}{R^2}\\right) $$\nIntegrating with respect to $r$:\n$$ r \\frac{dT}{dr} = -\\frac{S_0}{k} \\int \\left(r + \\frac{\\beta r^3}{R^2}\\right) dr = -\\frac{S_0}{k} \\left( \\frac{r^2}{2} + \\frac{\\beta r^4}{4R^2} \\right) + C_1 $$\nThe first boundary condition is symmetry at the centerline, $\\frac{dT}{dr}\\big|_{r=0} = 0$. From the equation above:\n$$ \\frac{dT}{dr} = -\\frac{S_0}{k} \\left( \\frac{r}{2} + \\frac{\\beta r^3}{4R^2} \\right) + \\frac{C_1}{r} $$\nFor the gradient to be finite (and zero) at $r=0$, the term $\\frac{C_1}{r}$ must vanish, which requires the integration constant $C_1=0$.\nThus, the temperature gradient is:\n$$ \\frac{dT}{dr} = -\\frac{S_0}{k} \\left( \\frac{r}{2} + \\frac{\\beta r^3}{4R^2} \\right) $$\nIntegrating again to find the temperature distribution $T(r)$:\n$$ T(r) = \\int \\left( -\\frac{S_0}{k} \\left( \\frac{r}{2} + \\frac{\\beta r^3}{4R^2} \\right) \\right) dr = -\\frac{S_0}{k} \\left( \\frac{r^2}{4} + \\frac{\\beta r^4}{16R^2} \\right) + C_2 $$\nTo find the second integration constant $C_2$, we apply the convective boundary condition at the surface $r=R$:\n$$ -k\\,\\frac{dT}{dr}\\big|_{r=R} = h\\left(T(R) - T_{\\mathrm{c}}\\right) $$\nThe term on the left side is the heat flux at the surface, $q^{\\prime\\prime}(R)$. The total heat flowing out per unit length must equal the linear heat rate $q^{\\prime}$, so $q^{\\prime} = q^{\\prime\\prime}(R) \\times (2\\pi R)$. Therefore, $q^{\\prime\\prime}(R) = -k\\frac{dT}{dr}\\big|_{r=R} = \\frac{q^{\\prime}}{2\\pi R}$.\nSubstituting this into the boundary condition gives:\n$$ \\frac{q^{\\prime}}{2\\pi R} = h(T(R) - T_c) $$\nThis allows us to solve for the surface temperature $T(R)$:\n$$ T(R) = T_c + \\frac{q^{\\prime}}{2\\pi R h} $$\nNow we evaluate our general temperature profile at $r=R$ and set it equal to this expression for $T(R)$:\n$$ T(R) = -\\frac{S_0}{k} \\left( \\frac{R^2}{4} + \\frac{\\beta R^4}{16R^2} \\right) + C_2 = -\\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) + C_2 $$\nThus, the constant $C_2$ is:\n$$ C_2 = T(R) + \\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) $$\nThe temperature at the centerline, $T(0)$, is found by setting $r=0$ in the temperature profile $T(r)$:\n$$ T(0) = -\\frac{S_0}{k} (0) + C_2 = C_2 $$\nSo, the centerline temperature is:\n$$ T(0) = T(R) + \\frac{S_0 R^2}{k} \\left( \\frac{1}{4} + \\frac{\\beta}{16} \\right) $$\nSubstituting the expressions for $T(R)$ and $S_0$:\n$$ T(0) = \\left( T_c + \\frac{q^{\\prime}}{2\\pi R h} \\right) + \\frac{1}{k} \\left( \\frac{q^{\\prime}}{\\pi R^2 (1 + \\beta/2)} \\right) R^2 \\left( \\frac{4+\\beta}{16} \\right) $$\n$$ T(0) = T_c + \\frac{q^{\\prime}}{2\\pi R h} + \\frac{q^{\\prime}}{16 \\pi k} \\frac{4+\\beta}{1+\\beta/2} $$\nThis is the final symbolic expression for the centerline temperature.\n\n### **Numerical Calculation**\n\nWe are given the following values:\n$T_c = 570\\ \\mathrm{K}$\n$q^{\\prime} = 1.8\\times 10^{4}\\ \\mathrm{W\\,m^{-1}}$\n$R = 4.0 \\times 10^{-3}\\ \\mathrm{m}$\n$h = 1.0\\times 10^{4}\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n$k = 3.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n$\\beta = 2$\n\nThe temperature rise consists of two parts: the rise from the coolant to the fuel surface ($\\Delta T_{\\text{film}}$) and the rise from the fuel surface to the centerline ($\\Delta T_{\\text{fuel}}$).\n\n1.  Calculate the temperature rise across the effective gap/cladding film:\n    $$ \\Delta T_{\\text{film}} = T(R) - T_c = \\frac{q^{\\prime}}{2\\pi R h} = \\frac{1.8 \\times 10^4}{2\\pi (4.0 \\times 10^{-3}) (1.0 \\times 10^4)} = \\frac{1.8 \\times 10^4}{80\\pi} = \\frac{225}{\\pi}\\ \\mathrm{K} $$\n    $$ \\Delta T_{\\text{film}} \\approx 71.6197\\ \\mathrm{K} $$\n\n2.  Calculate the temperature rise within the fuel pellet:\n    $$ \\Delta T_{\\text{fuel}} = T(0) - T(R) = \\frac{q^{\\prime}}{16 \\pi k} \\frac{4+\\beta}{1+\\beta/2} = \\frac{1.8 \\times 10^4}{16\\pi (3.0)} \\frac{4+2}{1+2/2} = \\frac{1.8 \\times 10^4}{48\\pi} \\frac{6}{2} $$\n    $$ \\Delta T_{\\text{fuel}} = \\frac{1.8 \\times 10^4 \\times 3}{48\\pi} = \\frac{5.4 \\times 10^4}{48\\pi} = \\frac{1125}{\\pi}\\ \\mathrm{K} $$\n    $$ \\Delta T_{\\text{fuel}} \\approx 358.0986\\ \\mathrm{K} $$\n\n3.  Calculate the total centerline temperature $T(0)$:\n    $$ T(0) = T_c + \\Delta T_{\\text{film}} + \\Delta T_{\\text{fuel}} = 570\\ \\mathrm{K} + \\frac{225}{\\pi}\\ \\mathrm{K} + \\frac{1125}{\\pi}\\ \\mathrm{K} $$\n    $$ T(0) = 570 + \\frac{1350}{\\pi} \\approx 570 + 429.7183 = 999.7183\\ \\mathrm{K} $$\n\nRounding the final answer to four significant figures gives $999.7\\ \\mathrm{K}$.",
            "answer": "$$\\boxed{999.7}$$"
        },
        {
            "introduction": "A complete model of the volumetric heat source must also account for its time-dependent behavior, especially after a reactor shutdown. The lingering heat from the decay of radioactive fission products, known as decay heat, is a paramount safety concern. This practice guides you through a first-principles derivation of the decay heat curve, starting from the conservation of fission product nuclides and their exponential decay, providing a deep insight into one of the most critical transient phenomena in reactor physics. ",
            "id": "4230072",
            "problem": "Consider a homogeneous fuel region in a nuclear reactor that undergoes a shutdown at time $t=0$ after a period of constant operation. The volumetric heat generation rate due to decay heat, denoted $q'''(t)$ in $\\mathrm{W/m^3}$, arises from the radioactive decay of an inventory of fission product groups that were being produced during operation. The modeling must be based on first principles. Specifically, the number density $N_i(t)$ of each effective fission product group $i$ obeys the radioactive decay law and a production term during operation. The dynamics of $N_i(t)$ are governed by the balance of production and decay, rooted in the conservation of particle number and the exponential decay law. The power density contributed by each group is proportional to its decay rate times the average energy released per disintegration. Your task is to derive, from these principles, an explicit expression for $q'''(t)$ for $t \\ge 0$ following shutdown, assuming the reactor operated with a constant fission rate density during $-T_{\\mathrm{hist}} \\le t < 0$ and no fission thereafter.\n\nUse the following physically consistent and scientifically plausible parameters. All values must be used exactly as specified, with the units shown:\n\n- Effective energy per fission $E_{\\mathrm{fission}} = 200\\,\\mathrm{MeV}$ per fission. Convert megaelectronvolts to joules using $1\\,\\mathrm{MeV} = 1.60218\\times 10^{-13}\\,\\mathrm{J}$.\n- There are $5$ effective fission product groups, each characterized by a yield per fission $y_i$ (dimensionless, number of disintegrations eventually attributable to group $i$ per fission), a half-life $t_{1/2,i}$ in seconds, and an average energy per disintegration $E_i$ in megaelectronvolts:\n  - Group $1$: $y_1 = 1.0$, $t_{1/2,1} = 2\\,\\mathrm{s}$, $E_1 = 2.5\\,\\mathrm{MeV}$.\n  - Group $2$: $y_2 = 1.0$, $t_{1/2,2} = 30\\,\\mathrm{s}$, $E_2 = 3.0\\,\\mathrm{MeV}$.\n  - Group $3$: $y_3 = 1.0$, $t_{1/2,3} = 300\\,\\mathrm{s}$, $E_3 = 2.5\\,\\mathrm{MeV}$.\n  - Group $4$: $y_4 = 1.0$, $t_{1/2,4} = 3000\\,\\mathrm{s}$, $E_4 = 3.0\\,\\mathrm{MeV}$.\n  - Group $5$: $y_5 = 1.0$, $t_{1/2,5} = 30000\\,\\mathrm{s}$, $E_5 = 2.0\\,\\mathrm{MeV}$.\n- The decay constant for group $i$ is $\\lambda_i = \\ln(2)/t_{1/2,i}$ in $\\mathrm{s^{-1}}$.\n- During operation, the fission rate density is $f_0$ in $\\mathrm{fissions/(s\\cdot m^3)}$, related to the fission power density $P_{\\mathrm{f}}$ by the energy-per-fission relation $P_{\\mathrm{f}} = f_0 E_{\\mathrm{fission}}$; thus $f_0 = P_{\\mathrm{f}}/E_{\\mathrm{fission}}$.\n\nAssumptions and requirements:\n- The region is spatially uniform, so the volumetric heat source $q'''(t)$ depends only on time.\n- The only source of heat after shutdown is the radioactive decay of the stored inventory of the specified groups.\n- The production rate for each group during operation is $y_i f_0$ in $\\mathrm{(disintegrations/s)/m^3}$, and there is no production after shutdown ($t \\ge 0$).\n- All energies must be converted to joules before computing power in $\\mathrm{W/m^3}$.\n- Express all final answers in $\\mathrm{W/m^3}$ as real numbers (floats).\n\nStarting from the conservation of particle number and the exponential decay law, derive the expression for $q'''(t)$ for $t \\ge 0$ in terms of $y_i$, $\\lambda_i$, $E_i$, $f_0$, and $T_{\\mathrm{hist}}$ only. Then implement this expression to compute $q'''(t)$ for the following test suite. Use the specified $P_{\\mathrm{f}}$ to determine $f_0$ for each case.\n\nTest suite (each case provides $P_{\\mathrm{f}}$ in $\\mathrm{W/m^3}$, $T_{\\mathrm{hist}}$ in $\\mathrm{s}$, and a list of query times $t$ in $\\mathrm{s}$):\n\n- Case $1$ (general happy path, long irradiation at moderate power density): $P_{\\mathrm{f}} = 100\\times 10^6\\,\\mathrm{W/m^3}$, $T_{\\mathrm{hist}} = 86400\\,\\mathrm{s}$, $t \\in \\{0, 10, 100, 1000\\}\\,\\mathrm{s}$.\n- Case $2$ (boundary at shutdown, low power density, single query): $P_{\\mathrm{f}} = 10\\times 10^6\\,\\mathrm{W/m^3}$, $T_{\\mathrm{hist}} = 10^6\\,\\mathrm{s}$, $t \\in \\{0\\}\\,\\mathrm{s}$.\n- Case $3$ (short irradiation; incomplete inventory saturation): $P_{\\mathrm{f}} = 200\\times 10^6\\,\\mathrm{W/m^3}$, $T_{\\mathrm{hist}} = 60\\,\\mathrm{s}$, $t \\in \\{0, 100, 5000\\}\\,\\mathrm{s}$.\n- Case $4$ (zero operation; sanity check): $P_{\\mathrm{f}} = 0\\,\\mathrm{W/m^3}$, $T_{\\mathrm{hist}} = 1000\\,\\mathrm{s}$, $t \\in \\{0, 10\\}\\,\\mathrm{s}$.\n- Case $5$ (long times after shutdown; dominance of long-lived group): $P_{\\mathrm{f}} = 50\\times 10^6\\,\\mathrm{W/m^3}$, $T_{\\mathrm{hist}} = 10^6\\,\\mathrm{s}$, $t \\in \\{100000, 500000\\}\\,\\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of the computed values of $q'''(t)$ (in $\\mathrm{W/m^3}$) at the specified query times, in the order given. For example, the output format must look like $[[q_{1,1},q_{1,2},\\dots],[q_{2,1},\\dots],\\dots]$ with no spaces anywhere in the line. All numerical results must be floats in $\\mathrm{W/m^3}$.",
            "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. All required physical parameters and mathematical relationships are provided to derive a unique, meaningful solution for the decay heat generation rate following reactor shutdown. The problem is a standard, formalizable exercise in reactor physics, grounded in the fundamental principles of radioactive decay and particle conservation. We may therefore proceed with the derivation and solution.\n\nThe objective is to derive an expression for the volumetric heat generation rate, $q'''(t)$, for time $t \\ge 0$ after a reactor shutdown. This heat is generated by the radioactive decay of fission products accumulated during a prior operational period.\n\nLet $N_i(t)$ be the number density (in $\\mathrm{atoms/m^3}$) of the $i$-th effective fission product group at time $t$. The dynamics of $N_i(t)$ are governed by a first-order linear ordinary differential equation representing the balance between production and loss (decay).\n\n**Step 1: Dynamics During Operation ($-T_{\\mathrm{hist}} \\le t < 0$)**\n\nDuring the operational period, the reactor is assumed to have a constant fission rate density, $f_0$. Each fission produces, on average, $y_i$ atoms of the $i$-th group (or its precursors). The production rate density for group $i$ is thus constant and equal to $y_i f_0$. The loss mechanism is radioactive decay, which occurs at a rate proportional to the current number density, $\\lambda_i N_i(t)$, where $\\lambda_i$ is the decay constant for group $i$.\n\nThe balance equation is:\n$$\n\\frac{dN_i(t)}{dt} = \\text{Production Rate} - \\text{Decay Rate} = y_i f_0 - \\lambda_i N_i(t)\n$$\nThis is a first-order linear inhomogeneous ordinary differential equation. We can solve it by finding a particular solution and adding the solution to the homogeneous equation. The homogeneous equation $\\frac{dN_i}{dt} = -\\lambda_i N_i(t)$ has the solution $C e^{-\\lambda_i t}$. A particular solution for the constant source term is $N_{i,p} = y_i f_0 / \\lambda_i$.\nThe general solution is therefore:\n$$\nN_i(t) = \\frac{y_i f_0}{\\lambda_i} + C e^{-\\lambda_i t}\n$$\nTo find the integration constant $C$, we apply the initial condition that at the start of operation, $t = -T_{\\mathrm{hist}}$, the number density of fission products is zero: $N_i(-T_{\\mathrm{hist}}) = 0$.\n$$\n0 = \\frac{y_i f_0}{\\lambda_i} + C e^{-\\lambda_i (-T_{\\mathrm{hist}})} \\implies C = -\\frac{y_i f_0}{\\lambda_i} e^{-\\lambda_i T_{\\mathrm{hist}}}\n$$\nSubstituting $C$ back into the general solution gives the number density of group $i$ at any time $t$ during the operational period ($-T_{\\mathrm{hist}} \\le t < 0$):\n$$\nN_i(t) = \\frac{y_i f_0}{\\lambda_i} - \\left(\\frac{y_i f_0}{\\lambda_i} e^{-\\lambda_i T_{\\mathrm{hist}}}\\right) e^{-\\lambda_i t} = \\frac{y_i f_0}{\\lambda_i} \\left(1 - e^{-\\lambda_i (t + T_{\\mathrm{hist}})}\\right)\n$$\n\n**Step 2: Inventory at Shutdown ($t=0$)**\n\nThe operational period ends at $t=0$. The number density of each fission product group at this instant, $N_i(0)$, serves as the initial condition for the subsequent decay phase. We find $N_i(0)$ by setting $t=0$ in the expression derived in Step 1:\n$$\nN_i(0) = \\frac{y_i f_0}{\\lambda_i} \\left(1 - e^{-\\lambda_i T_{\\mathrm{hist}}}\\right)\n$$\nThis expression correctly shows that the inventory at shutdown depends on the duration of operation, $T_{\\mathrm{hist}}$. For very long operation ($T_{\\mathrm{hist}} \\to \\infty$), the term $e^{-\\lambda_i T_{\\mathrm{hist}}} \\to 0$, and the inventory approaches a saturation value, $N_{i,\\text{sat}} = y_i f_0 / \\lambda_i$, where production and decay rates are in equilibrium.\n\n**Step 3: Dynamics After Shutdown ($t \\ge 0$)**\n\nFor $t \\ge 0$, the fission process has stopped, so the production term $y_i f_0$ becomes zero. The governing equation simplifies to the standard radioactive decay law:\n$$\n\\frac{dN_i(t)}{dt} = -\\lambda_i N_i(t)\n$$\nThe solution to this equation, with the initial condition $N_i(0)$ from Step 2, is:\n$$\nN_i(t) = N_i(0) e^{-\\lambda_i t}\n$$\nSubstituting the expression for $N_i(0)$:\n$$\nN_i(t) = \\left[ \\frac{y_i f_0}{\\lambda_i} \\left(1 - e^{-\\lambda_i T_{\\mathrm{hist}}}\\right) \\right] e^{-\\lambda_i t}\n$$\nThis is the number density of group $i$ at any time $t$ after shutdown.\n\n**Step 4: Volumetric Heat Generation Rate ($q'''(t)$)**\n\nThe volumetric heat generation rate, or power density, is the sum of the energies released per unit time per unit volume from the decay of all fission product groups. For group $i$, the activity density (decays per second per cubic meter) is $A_i(t) = \\lambda_i N_i(t)$. Each decay releases an average energy $E_i$. The power density from group $i$ is $q'''_i(t) = A_i(t) E_i = \\lambda_i N_i(t) E_i$.\n\nThe total volumetric heat generation rate is the sum over all groups:\n$$\nq'''(t) = \\sum_{i} q'''_i(t) = \\sum_{i} \\lambda_i N_i(t) E_i\n$$\nSubstituting the expression for $N_i(t)$ from Step 3:\n$$\nq'''(t) = \\sum_{i} \\lambda_i \\left[ \\frac{y_i f_0}{\\lambda_i} \\left(1 - e^{-\\lambda_i T_{\\mathrm{hist}}}\\right) e^{-\\lambda_i t} \\right] E_i\n$$\nThe decay constant $\\lambda_i$ conveniently cancels from the expression:\n$$\nq'''(t) = \\sum_{i} y_i f_0 E_i \\left(1 - e^{-\\lambda_i T_{\\mathrm{hist}}}\\right) e^{-\\lambda_i t}\n$$\nFinally, we substitute the specified relationship between fission power density $P_{\\mathrm{f}}$ and fission rate density $f_0$, which is $f_0 = P_{\\mathrm{f}} / E_{\\mathrm{fission}}$.\n$$\nq'''(t) = \\sum_{i} y_i \\left(\\frac{P_{\\mathrm{f}}}{E_{\\mathrm{fission}}}\\right) E_i \\left(1 - e^{-\\lambda_i T_{\\mathrm{hist}}}\\right) e^{-\\lambda_i t}\n$$\nThis is the final expression to be implemented. For calculation, all energy values ($E_i$, $E_{\\mathrm{fission}}$) must be converted from $\\mathrm{MeV}$ to Joules, and the decay constants are computed from the half-lives as $\\lambda_i = \\ln(2)/t_{1/2,i}$. The calculation will proceed by evaluating this sum for each specified test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the decay heat generation rate in a nuclear reactor fuel region\n    after shutdown based on a first-principles derivation.\n    \"\"\"\n    # Define physical constants.\n    E_FISSION_MEV = 200.0  # MeV per fission\n    MEV_TO_J = 1.60218e-13  # Joules per MeV\n    E_FISSION_J = E_FISSION_MEV * MEV_TO_J  # J per fission\n\n    # Define the 5 effective fission product groups.\n    # Data format: (yield y_i, half-life t_1/2,i (s), energy E_i (MeV))\n    groups_data = [\n        (1.0, 2.0, 2.5),\n        (1.0, 30.0, 3.0),\n        (1.0, 300.0, 2.5),\n        (1.0, 3000.0, 3.0),\n        (1.0, 30000.0, 2.0),\n    ]\n\n    # Convert group data to NumPy arrays for vectorized calculations.\n    num_groups = len(groups_data)\n    y = np.array([g[0] for g in groups_data])\n    t_half = np.array([g[1] for g in groups_data])\n    E_i_MeV = np.array([g[2] for g in groups_data])\n\n    # Pre-calculate derived constants in SI units.\n    E_i_J = E_i_MeV * MEV_TO_J  # Energy per disintegration in Joules\n    lambda_i = np.log(2) / t_half  # Decay constants in s^-1\n\n    # Define the test cases from the problem statement.\n    # Format: (fission power density P_f (W/m^3), history time T_hist (s), query times t (s))\n    test_cases = [\n        (100e6, 86400.0, [0.0, 10.0, 100.0, 1000.0]),\n        (10e6, 1e6, [0.0]),\n        (200e6, 60.0, [0.0, 100.0, 5000.0]),\n        (0.0, 1000.0, [0.0, 10.0]),\n        (50e6, 1e6, [100000.0, 500000.0]),\n    ]\n\n    overall_results = []\n    for P_f, T_hist, t_queries in test_cases:\n        case_results = []\n\n        # Calculate fission rate density f0. If P_f is 0, f0 is 0.\n        if P_f == 0.0:\n            f0 = 0.0\n        else:\n            f0 = P_f / E_FISSION_J  # fissions / (s * m^3)\n\n        # Pre-calculate the saturation factor, which is constant for a given case.\n        # This factor represents the fraction of saturation inventory achieved.\n        saturation_factor = 1.0 - np.exp(-lambda_i * T_hist)\n        \n        # Calculate the constant part of the q''' term for each group.\n        # q'''(t) = SUM_i [ C_i * exp(-lambda_i * t) ]\n        # where C_i = y_i * f0 * E_i_J * saturation_factor_i\n        C_i_terms = y * f0 * E_i_J * saturation_factor\n\n        for t in t_queries:\n            # Calculate the decay factor for the current query time t.\n            decay_factor = np.exp(-lambda_i * t)\n            \n            # Calculate the heat generation rate from each group at time t.\n            q_per_group = C_i_terms * decay_factor\n            \n            # Sum the contributions from all groups to get the total heat rate.\n            q_total = np.sum(q_per_group)\n            \n            case_results.append(q_total)\n            \n        overall_results.append(case_results)\n\n    # Format the final output string exactly as specified: [[r1,r2],[r3],...]\n    formatted_cases = []\n    for res_list in overall_results:\n        formatted_list = f\"[{','.join(map(str, res_list))}]\"\n        formatted_cases.append(formatted_list)\n    \n    final_output_string = f\"[{','.join(formatted_cases)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}