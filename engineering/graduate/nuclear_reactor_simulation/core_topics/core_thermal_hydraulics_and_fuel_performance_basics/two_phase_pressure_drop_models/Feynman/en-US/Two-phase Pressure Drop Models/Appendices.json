{
    "hands_on_practices": [
        {
            "introduction": "Understanding the components of two-phase pressure drop begins with the gravitational term, which is dominant in many vertical flow systems. This practice focuses on calculating the gravitational pressure drop, $\\Delta P_g$, in a boiling channel. The main challenge is to correctly account for the changing mixture density, $\\rho(z)$, as the vapor quality increases with height, which you will accomplish by applying the Homogeneous Equilibrium Model (HEM).\n\nBy working through this exercise , you will connect the abstract concept of a two-phase mixture model to a concrete physical calculation. This involves deriving the mixture density from first principles and performing an integration to find the total hydrostatic head, a foundational skill for analyzing boiling water reactors and other thermosiphon systems.",
            "id": "4259288",
            "problem": "A vertical boiling channel in a nuclear reactor core of length $L$ carries water flowing upward. Let the axial coordinate be $z$, measured upward from the channel inlet at $z=0$ to the outlet at $z=L$. The onset of bulk boiling occurs at $z=z_b$, with subcooled liquid for $0 \\le z  z_b$ and saturated two-phase flow for $z_b \\le z \\le L$. At the channel outlet, the mass quality is $x_{out}$ at saturated conditions. Assume the following:\n- The gravitational contribution to the pressure drop is defined by $\\Delta P_g = \\int_{0}^{L} \\rho(z)\\, g \\, dz$, where $g$ is the gravitational acceleration and $\\rho(z)$ is the local mixture density.\n- Acceleration and wall-friction contributions to the pressure drop are negligible compared to gravity, and the cross-sectional area is uniform.\n- In the two-phase region, thermal equilibrium holds and the flow obeys the Homogeneous Equilibrium Model (HEM), in which the phases share a common velocity and the void fraction is consistent with the mixture specific volume at a given mass quality.\n- The liquid density $\\rho_l$ and vapor density $\\rho_g$ may be treated as constants equal to their saturated values at the exit pressure.\n- The axial quality distribution is linear in the two-phase region: for $z_b \\le z \\le L$, $x(z) = \\dfrac{x_{out}}{L - z_b} \\, (z - z_b)$, and $x(z)=0$ for $0 \\le z  z_b$.\n\nGiven the following data:\n- $L = 5 \\ \\mathrm{m}$, $z_b = 1 \\ \\mathrm{m}$, $x_{out} = 0.2$,\n- $g = 9.81 \\ \\mathrm{m/s^2}$,\n- $\\rho_l = 900 \\ \\mathrm{kg/m^3}$, $\\rho_g = 6 \\ \\mathrm{kg/m^3}$,\n\nstarting from the one-dimensional steady vertical momentum balance and consistent mixture relations implied by the Homogeneous Equilibrium Model, derive an expression for $\\rho(z)$ in terms of $x(z)$ and the given constants, and then compute the gravitational pressure drop $\\Delta P_g = \\int_{0}^{L} \\rho(z)\\, g \\, dz$. Express the final answer in $\\mathrm{kPa}$ and round your result to four significant figures.",
            "solution": "The problem requires the calculation of the gravitational pressure drop, $\\Delta P_g$, in a vertical boiling channel. We begin by deriving the necessary physical relations based on the provided assumptions.\n\nFirst, we establish the expression for the local mixture density, $\\rho(z)$, under the Homogeneous Equilibrium Model (HEM). In the HEM, the specific volume of the two-phase mixture, $v(z)$, is a mass-weighted average of the liquid and vapor specific volumes, $v_l$ and $v_g$ respectively:\n$$ v(z) = (1 - x(z)) v_l + x(z) v_g $$\nwhere $x(z)$ is the local mass quality. The specific volumes are the reciprocals of the densities, $v_l = 1/\\rho_l$ and $v_g = 1/\\rho_g$. The mixture density $\\rho(z)$ is the reciprocal of the mixture specific volume, $\\rho(z) = 1/v(z)$. Substituting the expressions for $v_l$ and $v_g$:\n$$ \\frac{1}{\\rho(z)} = \\frac{1 - x(z)}{\\rho_l} + \\frac{x(z)}{\\rho_g} $$\nThis can be rearranged to express $\\rho(z)$ directly:\n$$ \\rho(z) = \\left( \\frac{1}{\\rho_l} + x(z) \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right) \\right)^{-1} $$\nThis is the required expression for $\\rho(z)$ in terms of $x(z)$ and the constant phase densities.\n\nThe total gravitational pressure drop is given by the integral of the local hydrostatic pressure head over the channel length $L$:\n$$ \\Delta P_g = \\int_{0}^{L} \\rho(z)\\, g \\, dz $$\nThe channel is divided into two regions: a single-phase liquid region from $z=0$ to $z=z_b$, and a two-phase region from $z=z_b$ to $z=L$. We can split the integral accordingly:\n$$ \\Delta P_g = \\int_{0}^{z_b} \\rho(z)\\, g \\, dz + \\int_{z_b}^{L} \\rho(z)\\, g \\, dz $$\n\nIn the first region ($0 \\le z  z_b$), the fluid is subcooled liquid. The quality $x(z) = 0$. The density is therefore constant and equal to the liquid density, $\\rho(z) = \\rho_l$. The contribution to the pressure drop from this region, $\\Delta P_{g,1\\phi}$, is:\n$$ \\Delta P_{g,1\\phi} = \\int_{0}^{z_b} \\rho_l g \\, dz = \\rho_l g [z]_{0}^{z_b} = \\rho_l g z_b $$\n\nIn the second region ($z_b \\le z \\le L$), the flow is two-phase. The quality $x(z)$ is given by the linear profile:\n$$ x(z) = \\frac{x_{out}}{L - z_b} (z - z_b) $$\nThe density $\\rho(z)$ is given by the HEM relation derived earlier. The contribution to the pressure drop from this region, $\\Delta P_{g,2\\phi}$, is:\n$$ \\Delta P_{g,2\\phi} = \\int_{z_b}^{L} g \\left( \\frac{1}{\\rho_l} + x(z) \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right) \\right)^{-1} dz $$\nSubstituting the expression for $x(z)$:\n$$ \\Delta P_{g,2\\phi} = g \\int_{z_b}^{L} \\left( \\frac{1}{\\rho_l} + \\frac{x_{out}}{L - z_b}(z - z_b) \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right) \\right)^{-1} dz $$\nTo solve this integral, let's make a substitution. Let the denominator be $u(z)$:\n$$ u(z) = \\frac{1}{\\rho_l} + \\frac{x_{out}}{L - z_b}(z - z_b) \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right) $$\nThe differential $du$ is:\n$$ du = \\frac{x_{out}}{L - z_b} \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right) dz $$\nRearranging for $dz$:\n$$ dz = \\frac{L - z_b}{x_{out} \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right)} du $$\nThe limits of integration for $u$ are:\nAt $z = z_b$: $u(z_b) = \\frac{1}{\\rho_l}$\nAt $z = L$: $u(L) = \\frac{1}{\\rho_l} + \\frac{x_{out}}{L - z_b}(L - z_b) \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right) = \\frac{1}{\\rho_l} + x_{out}\\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right) = \\frac{1 - x_{out}}{\\rho_l} + \\frac{x_{out}}{\\rho_g}$\nThe integral becomes:\n$$ \\Delta P_{g,2\\phi} = g \\int_{u(z_b)}^{u(L)} \\frac{1}{u} \\cdot \\frac{L - z_b}{x_{out} \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right)} du $$\n$$ \\Delta P_{g,2\\phi} = g \\frac{L - z_b}{x_{out} \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right)} [\\ln|u|]_{u(z_b)}^{u(L)} $$\n$$ \\Delta P_{g,2\\phi} = g \\frac{L - z_b}{x_{out} \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right)} \\left( \\ln\\left(\\frac{1 - x_{out}}{\\rho_l} + \\frac{x_{out}}{\\rho_g}\\right) - \\ln\\left(\\frac{1}{\\rho_l}\\right) \\right) $$\nUsing the property of logarithms, $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$ \\Delta P_{g,2\\phi} = g \\frac{L - z_b}{x_{out} \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_l}\\right)} \\ln\\left(\\frac{\\frac{1 - x_{out}}{\\rho_l} + \\frac{x_{out}}{\\rho_g}}{\\frac{1}{\\rho_l}}\\right) $$\n$$ \\Delta P_{g,2\\phi} = g \\frac{(L - z_b) \\rho_l \\rho_g}{x_{out} (\\rho_l - \\rho_g)} \\ln\\left(1 - x_{out} + x_{out}\\frac{\\rho_l}{\\rho_g}\\right) $$\nThe total gravitational pressure drop is the sum of the two contributions:\n$$ \\Delta P_g = \\Delta P_{g,1\\phi} + \\Delta P_{g,2\\phi} = \\rho_l g z_b + g \\frac{(L - z_b) \\rho_l \\rho_g}{x_{out} (\\rho_l - \\rho_g)} \\ln\\left(1 - x_{out} + x_{out}\\frac{\\rho_l}{\\rho_g}\\right) $$\nNow, we substitute the given numerical values:\n$L = 5 \\ \\mathrm{m}$, $z_b = 1 \\ \\mathrm{m}$, $x_{out} = 0.2$, $g = 9.81 \\ \\mathrm{m/s^2}$, $\\rho_l = 900 \\ \\mathrm{kg/m^3}$, $\\rho_g = 6 \\ \\mathrm{kg/m^3}$.\n\nThe single-phase contribution is:\n$$ \\Delta P_{g,1\\phi} = (900 \\ \\mathrm{kg/m^3}) \\cdot (9.81 \\ \\mathrm{m/s^2}) \\cdot (1 \\ \\mathrm{m}) = 8829 \\ \\mathrm{Pa} $$\nThe two-phase contribution is:\n$$ L - z_b = 5 - 1 = 4 \\ \\mathrm{m} $$\n$$ \\rho_l - \\rho_g = 900 - 6 = 894 \\ \\mathrm{kg/m^3} $$\n$$ \\frac{\\rho_l}{\\rho_g} = \\frac{900}{6} = 150 $$\n$$ \\Delta P_{g,2\\phi} = (9.81) \\cdot \\frac{(4) \\cdot (900) \\cdot (6)}{0.2 \\cdot (894)} \\ln\\left(1 - 0.2 + 0.2 \\cdot 150 \\right) $$\n$$ \\Delta P_{g,2\\phi} = (9.81) \\cdot \\frac{21600}{178.8} \\ln(0.8 + 30) $$\n$$ \\Delta P_{g,2\\phi} = (9.81) \\cdot (120.79418...) \\ln(30.8) $$\n$$ \\Delta P_{g,2\\phi} \\approx (1185.011) \\cdot (3.427515) \\approx 4061.848 \\ \\mathrm{Pa} $$\nThe total pressure drop is:\n$$ \\Delta P_g = 8829 \\ \\mathrm{Pa} + 4061.848 \\ \\mathrm{Pa} = 12890.848 \\ \\mathrm{Pa} $$\nConverting to kilopascals:\n$$ \\Delta P_g = 12.890848 \\ \\mathrm{kPa} $$\nRounding to four significant figures, we get $12.89 \\ \\mathrm{kPa}$.",
            "answer": "$$\\boxed{12.89}$$"
        },
        {
            "introduction": "As a fluid boils and its density decreases, it must accelerate to conserve mass, giving rise to an accelerational pressure drop. This practice isolates this specific component, $\\Delta P_a$, which stems from the change in the fluid's momentum flux. You will again use the Homogeneous Equilibrium Model (HEM) to relate the mixture velocity and density to the local vapor quality profile.\n\nThis calculation is critical because, as highlighted by related analyses , neglecting the accelerational component can lead to significant errors in interpreting experimental data, especially in short, highly heated sections. This exercise  will guide you through deriving $\\Delta P_a$ from the momentum equation, revealing its direct dependence on the change in fluid properties between the channel's inlet and outlet.",
            "id": "4259268",
            "problem": "A vertical, uniformly heated, constant-area circular pipe of length $L = 4.0\\,\\mathrm{m}$ carries saturated water undergoing two-phase boiling at a nearly uniform saturation pressure such that the liquid and vapor densities may be treated as constants equal to $\\rho_{f} = 700\\,\\mathrm{kg/m^3}$ and $\\rho_{g} = 35\\,\\mathrm{kg/m^3}$, respectively. The mass flux is uniform and equal to $G = 1.50 \\times 10^{3}\\,\\mathrm{kg/(m^2\\,s)}$. The inlet quality at $z=0$ is $x(0) = 0.05$, and the axial quality profile is given by\n$$\nx(z) = 0.05 + 0.20\\,\\frac{z}{L} + 0.05\\,\\frac{z}{L}\\left(1 - \\frac{z}{L}\\right), \\quad 0 \\le z \\le L.\n$$\nModel the flow using the Homogeneous Equilibrium Model (HEM) with slip ratio $S=1$ and thermal/mechanical equilibrium. Under HEM, the mixture specific volume is $v_{m}(x) = \\frac{1}{\\rho_{m}(x)} = \\frac{x}{\\rho_{g}} + \\frac{1-x}{\\rho_{f}}$, and the mixture velocity is $V_{m}(z) = G\\,v_{m}(x(z))$. Neglect wall friction and gravitational contributions and compute only the accelerational component of the pressure change.\n\nStarting from a one-dimensional steady momentum balance for a differential control volume of the pipe and the HEM mixture description, derive an expression for the accelerational pressure drop across the length and evaluate it for the given data.\n\nExpress your final answer in $\\mathrm{kPa}$ and round to $4$ significant figures.",
            "solution": "The analysis begins with the one-dimensional, steady-state momentum balance for a differential control volume of a constant-area pipe. The general equation for the total pressure gradient is the sum of three components: frictional, gravitational, and accelerational.\n$$\n\\left(-\\frac{dp}{dz}\\right)_{total} = \\left(-\\frac{dp}{dz}\\right)_{fric} + \\left(-\\frac{dp}{dz}\\right)_{grav} + \\left(-\\frac{dp}{dz}\\right)_{accel}\n$$\nThe problem statement explicitly requires neglecting the wall friction and gravitational contributions. Therefore, we only consider the accelerational component.\n$$\n-\\frac{dp}{dz} = \\left(-\\frac{dp}{dz}\\right)_{accel}\n$$\nThe accelerational pressure gradient is caused by the change in the axial momentum flux of the fluid. For a control volume with cross-sectional area $A$ and length $dz$, the net force due to pressure is equal to the rate of change of momentum flux. The momentum flux is given by $(\\text{mass flow rate}) \\times (\\text{velocity})$, which is $(\\dot{m})(V_m)$. The momentum flux per unit area is $(\\dot{m}/A)V_m = G V_m$. The change in momentum flux over the length $dz$ is $d(A G V_m)$.\nThe momentum balance is:\n$$\npA - (p+dp)A = d(\\dot{m}V_m) = d(G A V_m)\n$$\nSince the mass flux $G$ and the area $A$ are constant, this simplifies to:\n$$\n-A dp = A G dV_m\n$$\nDividing by $A dz$, we obtain the expression for the accelerational pressure gradient:\n$$\n-\\frac{dp}{dz} = G \\frac{dV_m}{dz}\n$$\nThe problem specifies the use of the Homogeneous Equilibrium Model (HEM). In this model, the two phases are assumed to travel at the same velocity, i.e., the slip ratio $S=1$. The mixture velocity $V_m$ is related to the constant mass flux $G$ and the mixture specific volume $v_m(z)$ by $V_m(z) = G v_m(z)$. The mixture specific volume is a function of the local quality $x(z)$ and the constant liquid and vapor specific volumes ($v_f = 1/\\rho_f$, $v_g = 1/\\rho_g$):\n$$\nv_m(x) = x v_g + (1-x) v_f = x \\frac{1}{\\rho_g} + (1-x) \\frac{1}{\\rho_f}\n$$\nWe can rearrange this as:\n$$\nv_m(x) = \\frac{1}{\\rho_f} + x \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_f}\\right)\n$$\nSubstituting $V_m(z) = G v_m(x(z))$ into the pressure gradient equation:\n$$\n-\\frac{dp}{dz} = G \\frac{d}{dz}\\left[ G \\left(\\frac{1}{\\rho_f} + x(z) \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_f}\\right)\\right) \\right]\n$$\nSince $G$, $\\rho_f$, and $\\rho_g$ are constants, the derivative applies only to the quality $x(z)$:\n$$\n-\\frac{dp}{dz} = G^2 \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_f}\\right) \\frac{dx}{dz}\n$$\nTo find the total accelerational pressure drop, $\\Delta p_{accel} = p_{in} - p_{out} = p(0) - p(L)$, we integrate this expression over the length of the pipe from $z=0$ to $z=L$:\n$$\n\\Delta p_{accel} = \\int_{0}^{L} \\left(-\\frac{dp}{dz}\\right) dz = \\int_{0}^{L} G^2 \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_f}\\right) \\frac{dx}{dz} dz\n$$\nSince $G$, $\\rho_g$, and $\\rho_f$ are constant, we can take them out of the integral:\n$$\n\\Delta p_{accel} = G^2 \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_f}\\right) \\int_{0}^{L} \\frac{dx}{dz} dz\n$$\nBy the fundamental theorem of calculus, the integral of the derivative $dx/dz$ is simply the change in $x$ over the interval:\n$$\n\\int_{0}^{L} \\frac{dx}{dz} dz = x(L) - x(0)\n$$\nThus, the final expression for the accelerational pressure drop is:\n$$\n\\Delta p_{accel} = G^2 [x(L) - x(0)] \\left(\\frac{1}{\\rho_g} - \\frac{1}{\\rho_f}\\right)\n$$\nThis result shows that for the HEM model with constant fluid properties, the accelerational pressure drop depends only on the change in quality between the inlet and outlet, not on the specific axial quality profile.\n\nWe now evaluate this expression using the given data.\nThe givens are:\n$G = 1.50 \\times 10^{3}\\,\\mathrm{kg/(m^2\\,s)}$\n$\\rho_f = 700\\,\\mathrm{kg/m^3}$\n$\\rho_g = 35\\,\\mathrm{kg/m^3}$\n$L = 4.0\\,\\mathrm{m}$\nThe inlet quality is $x(0) = 0.05$.\nThe outlet quality $x(L)$ is found by evaluating the given quality profile at $z=L$:\n$$\nx(L) = 0.05 + 0.20\\,\\frac{L}{L} + 0.05\\,\\frac{L}{L}\\left(1 - \\frac{L}{L}\\right) = 0.05 + 0.20 \\times 1 + 0.05 \\times 1 \\times (1-1) = 0.25\n$$\nThe change in quality is $x(L) - x(0) = 0.25 - 0.05 = 0.20$.\n\nNow, we substitute the numerical values into the derived formula:\n$$\n\\Delta p_{accel} = (1.50 \\times 10^{3})^2 [0.25 - 0.05] \\left(\\frac{1}{35} - \\frac{1}{700}\\right)\n$$\nFirst, calculate the terms:\n$G^2 = (1.50 \\times 10^{3})^2 = 2.25 \\times 10^6 \\, (\\mathrm{kg/(m^2 s)})^2$\n$x(L) - x(0) = 0.20$\n$\\frac{1}{\\rho_g} - \\frac{1}{\\rho_f} = \\frac{1}{35} - \\frac{1}{700} = \\frac{20}{700} - \\frac{1}{700} = \\frac{19}{700} \\, \\mathrm{m^3/kg}$\nSubstituting these into the equation for $\\Delta p_{accel}$:\n$$\n\\Delta p_{accel} = (2.25 \\times 10^6) \\times (0.20) \\times \\left(\\frac{19}{700}\\right)\n$$\n$$\n\\Delta p_{accel} = (0.45 \\times 10^6) \\times \\left(\\frac{19}{700}\\right) = \\frac{0.45 \\times 19 \\times 10^6}{700} = \\frac{8.55 \\times 10^6}{700} = \\frac{8.55}{7} \\times 10^4\n$$\n$$\n\\Delta p_{accel} \\approx 1.22142857 \\times 10^4 \\, \\mathrm{Pa}\n$$\nThe unit is $\\mathrm{Pa}$ since $(\\mathrm{kg/(m^2 s)})^2 \\times (\\mathrm{m^3/kg}) = (\\mathrm{kg}^2 / (\\mathrm{m}^4 \\mathrm{s}^2)) \\times (\\mathrm{m}^3/\\mathrm{kg}) = \\mathrm{kg}/(\\mathrm{m} \\mathrm{s}^2) = \\mathrm{N/m^2} = \\mathrm{Pa}$.\nThe problem asks for the answer in kilopascals ($\\mathrm{kPa}$).\n$$\n\\Delta p_{accel} = 12.2142857 \\, \\mathrm{kPa}\n$$\nRounding to $4$ significant figures, we get:\n$$\n\\Delta p_{accel} \\approx 12.21 \\, \\mathrm{kPa}\n$$",
            "answer": "$$\\boxed{12.21}$$"
        },
        {
            "introduction": "Real-world engineering problems demand the integration of multiple physical principles. This final practice serves as a capstone exercise, combining energy transport and momentum transport for a comprehensive pressure drop analysis in a heated channel. You will begin by deriving the axial vapor quality profile, $x(z)$, from a fundamental energy balance, and then use this profile to compute both the accelerational and frictional pressure drops.\n\nThis hands-on problem  moves beyond simplified models by requiring the implementation of a more detailed frictional pressure drop calculation, including mixture viscosity, Reynolds number, and empirical friction factor correlations. The complexity of the resulting integrand necessitates numerical integration, simulating a typical workflow in thermal-hydraulic analysis and bridging the gap between isolated concepts and integrated system simulation.",
            "id": "4259269",
            "problem": "Consider a one-dimensional, steady, saturated boiling flow in a uniform circular channel of hydraulic diameter $D_h$ and length $L$. The mass flux is $G$ (defined as mass flow rate per unit cross-sectional area, with units $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$), and the effective axial heat flux distribution into the fluid is $q''(z)$ (defined such that the energy balance per unit mass is $d(h)/dz = q''(z)/G$, with $q''$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}$). Assume the Homogeneous Equilibrium Model (HEM): the liquid and vapor phases move with the same velocity (slip ratio equals one), the flow is saturated at a fixed pressure so that saturation properties are constant, and axial heat conduction as well as axial work are negligible. Let the inlet of the saturated boiling section be at $z = 0$ with inlet quality $x(0) = 0$.\n\nStarting from the fundamental energy balance $d(h)/dz = q''(z)/G$ and the definition of mixture enthalpy under saturation, derive an expression for the vapor quality $x(z)$ along the channel as a function of $q''(z)$, the mass flux $G$, and the latent heat of vaporization $h_{fg}$. Then, using the one-dimensional steady momentum equation specialized to constant-area flow, compute the acceleration pressure drop $\\Delta P_a$ and the frictional pressure drop $\\Delta P_f$ along the channel length $L$ under the HEM assumptions.\n\nUse the following physically-based definitions and modeling choices:\n- Saturated mixture enthalpy is $h(z) = h_f + x(z)\\,h_{fg}$, where $h_f$ is the saturated liquid enthalpy (constant under the fixed pressure assumption) and $h_{fg}$ is the latent heat of vaporization.\n- Mixture density under HEM is $\\rho_m(x) = \\left(\\dfrac{x}{\\rho_v} + \\dfrac{1-x}{\\rho_l}\\right)^{-1}$, with $\\rho_l$ and $\\rho_v$ the saturated liquid and vapor densities, respectively.\n- Mixture viscosity is modeled as a linear mass-fraction blend $\\mu_m(x) = x\\,\\mu_v + (1-x)\\,\\mu_l$, with $\\mu_l$ and $\\mu_v$ the saturated liquid and vapor viscosities, respectively.\n- The Fanning friction factor $f_F$ is modeled piecewise from widely used single-phase correlations evaluated at the mixture Reynolds number $\\mathrm{Re}_m = \\dfrac{G\\,D_h}{\\mu_m}$:\n  - Laminar regime for $\\mathrm{Re}_m \\le 2300$: $f_F = \\dfrac{16}{\\mathrm{Re}_m}$.\n  - Turbulent regime for $\\mathrm{Re}_m  2300$: $f_F = 0.0791\\,\\mathrm{Re}_m^{-0.25}$.\n- The frictional pressure gradient for fully developed flow in a circular channel is $dP_f/dz = \\dfrac{2\\,f_F\\,G^2}{D_h\\,\\rho_m(x(z))}$.\n- The acceleration pressure drop over the channel is computed from the momentum equation term $\\Delta P_a = G^2\\left(\\dfrac{1}{\\rho_m(L)} - \\dfrac{1}{\\rho_m(0)}\\right)$.\n\nAssume that if the computed $x(z)$ exceeds $1$ (dryout), it is clipped to $x(z) = 1$ for all subsequent $z$, and properties $(\\rho_m,\\mu_m)$ are evaluated consistently with $x=1$ beyond the dryout location.\n\nImplement the derivation and compute numerical results for the following test suite of cases. In all cases, use constant saturated properties $\\rho_l = 700\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\rho_v = 35\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\mu_l = 1.0\\times 10^{-4}\\,\\mathrm{Pa}\\,\\mathrm{s}$, $\\mu_v = 1.2\\times 10^{-5}\\,\\mathrm{Pa}\\,\\mathrm{s}$, and $h_{fg} = 1.2\\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$. The heat flux functions $q''(z)$ are defined over $z \\in [0,L]$:\n\n- Case $1$ (baseline constant heat flux):\n  - $L = 3.0\\,\\mathrm{m}$, $D_h = 0.012\\,\\mathrm{m}$, $G = 900\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n  - $q''(z) = 2.5\\times 10^{5}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$ for all $z$.\n\n- Case $2$ (high heat flux leading to early dryout):\n  - $L = 4.0\\,\\mathrm{m}$, $D_h = 0.010\\,\\mathrm{m}$, $G = 600\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n  - $q''(z) = 6.0\\times 10^{5}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$ for all $z$.\n\n- Case $3$ (zero heat input):\n  - $L = 2.0\\,\\mathrm{m}$, $D_h = 0.015\\,\\mathrm{m}$, $G = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n  - $q''(z) = 0\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$ for all $z$.\n\n- Case $4$ (spatially varying heat flux):\n  - $L = 3.5\\,\\mathrm{m}$, $D_h = 0.011\\,\\mathrm{m}$, $G = 1100\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$,\n  - $q''(z) = 3.0\\times 10^{5}\\left(1 + 0.2\\,\\sin\\left(\\dfrac{\\pi\\,z}{L}\\right)\\right)\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n\nYour program must:\n- Derive $x(z)$ from the energy balance and saturate it to the interval $[0,1]$.\n- Compute $\\Delta P_a$ in $\\mathrm{Pa}$ using the HEM mixture density at $z=0$ and $z=L$.\n- Compute $\\Delta P_f$ in $\\mathrm{Pa}$ by numerically integrating $dP_f/dz$ along $z \\in [0,L]$ using the specified friction factor and mixture properties.\n- Express the final outputs for each case as a list of three floating-point numbers $[x_{\\text{out}}, \\Delta P_a, \\Delta P_f]$ where $x_{\\text{out}} = x(L)$ is dimensionless and the pressure drops are in $\\mathrm{Pa}$.\n- Round each reported number to $6$ decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each caseâ€™s result appearing as a sublist in order from Case $1$ to Case $4$. For example, the output structure must be of the form $[[x_1,\\Delta P_{a,1},\\Delta P_{f,1}],[x_2,\\Delta P_{a,2},\\Delta P_{f,2}],\\dots]$, with no extra text printed.",
            "solution": "The problem requires the derivation and calculation of vapor quality and pressure drop components for a two-phase flow in a heated channel, based on the Homogeneous Equilibrium Model (HEM). The solution involves three main steps: deriving the axial vapor quality profile $x(z)$, calculating the acceleration pressure drop $\\Delta P_a$, and calculating the frictional pressure drop $\\Delta P_f$ by numerical integration.\n\n### Step 1: Derivation of Vapor Quality Profile $x(z)$\n\nThe analysis begins with the steady-state, one-dimensional energy balance for a fluid element, given as:\n$$\n\\frac{dh}{dz} = \\frac{q''(z)}{G}\n$$\nHere, $h$ is the mixture specific enthalpy, $z$ is the axial coordinate, $q''(z)$ is the effective axial heat flux distribution, and $G$ is the mass flux.\n\nUnder the assumption of saturated flow at a constant pressure, the saturation properties are constant. The mixture enthalpy $h(z)$ is defined as a mass-fraction weighted average of the saturated liquid and vapor enthalpies, $h_f$ and $h_v$:\n$$\nh(z) = (1-x(z))h_f + x(z)h_v = h_f + x(z)(h_v-h_f) = h_f + x(z)h_{fg}\n$$\nwhere $x(z)$ is the vapor quality and $h_{fg}$ is the latent heat of vaporization.\n\nSince $h_f$ and $h_{fg}$ are constant, differentiating the enthalpy expression with respect to $z$ yields:\n$$\n\\frac{dh}{dz} = \\frac{d}{dz}(h_f + x(z)h_{fg}) = h_{fg}\\frac{dx}{dz}\n$$\nEquating the two expressions for $\\frac{dh}{dz}$:\n$$\nh_{fg}\\frac{dx}{dz} = \\frac{q''(z)}{G} \\implies \\frac{dx}{dz} = \\frac{q''(z)}{G h_{fg}}\n$$\nThis ordinary differential equation describes the change in vapor quality along the channel. To find $x(z)$, we integrate from the channel inlet at $z=0$ to an arbitrary position $z$. With the given inlet condition $x(0)=0$:\n$$\n\\int_{x(0)}^{x(z)} dx' = \\int_0^z \\frac{q''(z')}{G h_{fg}} dz'\n$$\n$$\nx(z) - 0 = \\frac{1}{G h_{fg}} \\int_0^z q''(z') dz'\n$$\nThe problem specifies that if the quality exceeds $1$ (dryout), it should be clipped to $1$. Therefore, the physically-realizable vapor quality $x(z)$ is:\n$$\nx(z) = \\min\\left(1, \\frac{1}{G h_{fg}} \\int_0^z q''(z') dz'\\right)\n$$\nThis expression will be used to determine the quality at any point $z$ along the channel, including the outlet quality $x_{out} = x(L)$.\n\n### Step 2: Calculation of Acceleration Pressure Drop $\\Delta P_a$\n\nThe acceleration pressure drop, $\\Delta P_a$, results from the change in fluid momentum due to the change in density along the channel. For a constant area channel under the HEM, it is given by:\n$$\n\\Delta P_a = G^2 \\left( \\frac{1}{\\rho_m(L)} - \\frac{1}{\\rho_m(0)} \\right)\n$$\nwhere $\\rho_m(z)$ is the HEM mixture density at position $z$. The mixture density is the inverse of the mixture specific volume, which is a mass-fraction weighted average of the phase specific volumes ($v_l = 1/\\rho_l$, $v_v=1/\\rho_v$):\n$$\n\\frac{1}{\\rho_m(x)} = \\frac{1-x}{\\rho_l} + \\frac{x}{\\rho_v}\n$$\nAt the inlet, $z=0$, the quality is $x(0)=0$. The mixture density is purely the liquid density:\n$$\n\\frac{1}{\\rho_m(0)} = \\frac{1-0}{\\rho_l} + \\frac{0}{\\rho_v} = \\frac{1}{\\rho_l}\n$$\nAt the outlet, $z=L$, the quality is $x_{out}=x(L)$. The mixture density is $\\rho_m(L)$. Substituting these into the $\\Delta P_a$ formula:\n$$\n\\Delta P_a = G^2 \\left( \\left(\\frac{1-x_{out}}{\\rho_l} + \\frac{x_{out}}{\\rho_v}\\right) - \\frac{1}{\\rho_l} \\right) = G^2 \\left( \\frac{1}{\\rho_l} - \\frac{x_{out}}{\\rho_l} + \\frac{x_{out}}{\\rho_v} - \\frac{1}{\\rho_l} \\right)\n$$\nSimplifying this expression gives the final formula used for calculation:\n$$\n\\Delta P_a = G^2 x_{out} \\left( \\frac{1}{\\rho_v} - \\frac{1}{\\rho_l} \\right)\n$$\n\n### Step 3: Calculation of Frictional Pressure Drop $\\Delta P_f$\n\nThe frictional pressure drop, $\\Delta P_f$, is the integral of the local frictional pressure gradient $\\frac{dP_f}{dz}$ over the channel length $L$:\n$$\n\\Delta P_f = \\int_0^L \\frac{dP_f}{dz} dz\n$$\nThe problem provides the expression for the frictional pressure gradient:\n$$\n\\frac{dP_f}{dz} = \\frac{2 f_F G^2}{D_h \\rho_m(x(z))}\n$$\nThe evaluation of this integrand is dependent on the local vapor quality $x(z)$. The following sequence of calculations is performed for any given $z$:\n1.  **Vapor Quality $x(z)$**: Computed using the derived formula from Step 1.\n2.  **Mixture Viscosity $\\mu_m(z)$**: Calculated using the linear mass-fraction blend:\n    $$\n    \\mu_m(x(z)) = x(z)\\mu_v + (1-x(z))\\mu_l\n    $$\n3.  **Mixture Reynolds Number $\\mathrm{Re}_m(z)$**: Calculated using the mixture viscosity:\n    $$\n    \\mathrm{Re}_m(z) = \\frac{G D_h}{\\mu_m(x(z))}\n    $$\n4.  **Fanning Friction Factor $f_F(z)$**: Determined by the piecewise correlation based on the local Reynolds number:\n    $$\n    f_F = \\begin{cases} 16 / \\mathrm{Re}_m  \\text{if } \\mathrm{Re}_m \\le 2300 \\\\ 0.0791 \\mathrm{Re}_m^{-0.25}  \\text{if } \\mathrm{Re}_m  2300 \\end{cases}\n    $$\n5.  **Mixture Density $\\rho_m(z)$**: Calculated using the HEM definition:\n    $$\n    \\rho_m(x(z)) = \\left(\\frac{x(z)}{\\rho_v} + \\frac{1-x(z)}{\\rho_l}\\right)^{-1}\n    $$\nSince the integrand $\\frac{dP_f}{dz}$ is a complex, non-linear function of $z$, the integral for $\\Delta P_f$ must be evaluated numerically. The implementation will use a standard numerical quadrature algorithm from the SciPy library to perform this integration.\n\nThe computational procedure for each test case is as follows:\n- First, define the analytical function for the integrated heat flux, $\\int_0^z q''(z') dz'$, for the specific case.\n- Second, create a function for $x(z)$ that implements this integral and the clipping at $x=1$.\n- Third, calculate $x_{out} = x(L)$ and then $\\Delta P_a$.\n- Fourth, define the integrand function $\\frac{dP_f}{dz}$ encapsulating the logic above, and numerically integrate it from $z=0$ to $z=L$ to find $\\Delta P_f$.\n- Finally, the results $[x_{out}, \\Delta P_a, \\Delta P_f]$ are compiled and rounded.",
            "answer": "```\n[[0.694444, 15277.766804, 28148.970178],[1.0, 16457.142857, 126930.29177],[0.0, 0.0, 1531.166162],[0.257576, 8560.364239, 13735.617947]]\n```"
        }
    ]
}