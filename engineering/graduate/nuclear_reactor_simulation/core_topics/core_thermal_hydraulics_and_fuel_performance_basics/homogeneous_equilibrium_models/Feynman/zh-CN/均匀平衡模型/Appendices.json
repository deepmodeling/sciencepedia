{
    "hands_on_practices": [
        {
            "introduction": "在均相平衡模型 (HEM) 中，两相混合物被视为具有平均性质的单一“伪流体”。本练习旨在实践如何基于模型的质量加权基本准则，计算此伪流体的关键热力学性质，如混合物密度 $\\rho_m$ 和比焓 $h_m$。掌握这些计算是进行任何后续流动与安全分析的基础 ()。",
            "id": "4230552",
            "problem": "考虑一个一维、稳态、饱和的水-蒸汽两相流，该流动代表了压水反应堆中冷却剂通道段的情况。流动遵循均匀平衡模型 (HEM) 的假设：两相具有共同的速度且处于热力学平衡状态。设系统压力为 $p=7$ MPa，质量含汽率 (干度) 为 $x=0.2$，其定义为 $x = m_{\\text{vapor}}/m_{\\text{total}}$。使用水-蒸汽状态方程 (EOS)，具体为国际水和水蒸气性质协会 (IAPWS) 1997年工业公式 (IAPWS-IF97)，来获取 $p=7$ MPa 下的饱和性质。\n\n基本原理：在 HEM 和平衡条件下，混合物比焓 $h_m$ 是各相比焓的质量加权平均值，混合物比容 $v_m$ 是各相比容的质量加权平均值。混合物密度为 $\\rho_m = 1/v_m$。对于像定压比热 $c_p$ 这样的性质，在饱和温度下采用通用的 HEM 混合法则：混合物定压比热 $c_{p,m}$ 是各相 $c_p$ 值的质量加权平均值。\n\n使用从状态方程得到的 $p=7$ MPa 下的以下饱和性质：\n- 饱和温度 $T_{\\text{sat}}=560$ K,\n- 饱和液相密度 $\\rho_f=730$ kg/m$^3$,\n- 饱和汽相密度 $\\rho_g=35$ kg/m$^3$,\n- 饱和液相比焓 $h_f=1250$ kJ/kg,\n- 饱和汽相比焓 $h_g=3060$ kJ/kg,\n- 饱和液相定压比热 $c_{p,f}=4.70$ kJ/(kg·K),\n- 饱和汽相定压比热 $c_{p,g}=2.08$ kJ/(kg·K).\n\n假设在这些条件下，典型的状态方程不确定度很小且相互独立：密度的相对不确定度为 $\\pm 1\\%$，焓的相对不确定度为 $\\pm 0.5\\%$，比热的相对不确定度为 $\\pm 2\\%$。仅从 HEM 定义和所提供的状态方程值出发，计算在 $p=7$ MPa 和 $x=0.2$ 的饱和条件下，混合物密度 $\\rho_m$、混合物比焓 $h_m$ 和混合物定压比热 $c_{p,m}$。然后，通过定性分析和一阶线性化灵敏度分析，讨论所述的状态方程不确定度如何影响 $\\rho_m$、$h_m$ 和 $c_{p,m}$。\n\n将您的数值结果四舍五入至四位有效数字。$\\rho_m$ 的单位为 kg/m$^3$，$h_m$ 的单位为 kJ/kg，$c_{p,m}$ 的单位为 kJ/(kg·K)。最终答案必须是三元组 $\\rho_m, h_m, c_{p,m}$。",
            "solution": "均匀平衡模型 (HEM) 提供了混合物性质的定义，其基础是广延性质的质量加权平均，以及通过比容的质量加权平均来计算密度。质量含汽率 $x$ 定义为 $x = m_{\\text{vapor}}/m_{\\text{total}}$。我们使用基本定义进行计算。\n\n对于混合物比焓 $h_m$，HEM 定义为\n$$\nh_m = x\\,h_g + (1-x)\\,h_f,\n$$\n其中 $h_f$ 和 $h_g$ 是在给定饱和状态下的饱和液相比焓和饱和汽相比焓。\n\n对于混合物比容 $v_m$，HEM 定义为\n$$\nv_m = x\\,v_g + (1-x)\\,v_f = x\\,\\frac{1}{\\rho_g} + (1-x)\\,\\frac{1}{\\rho_f},\n$$\n其中 $\\rho_f$ 和 $\\rho_g$ 是饱和液相和饱和汽相的密度。混合物密度则为\n$$\n\\rho_m = \\frac{1}{v_m} = \\frac{1}{x/\\rho_g + (1-x)/\\rho_f}.\n$$\n\n对于饱和温度下的混合物定压比热 $c_{p,m}$，我们采用通用的 HEM 混合法则\n$$\nc_{p,m} = x\\,c_{p,g} + (1-x)\\,c_{p,f},\n$$\n其中 $c_{p,f}$ 和 $c_{p,g}$ 分别是饱和液相和饱和汽相的定压比热。\n\n现在，代入所提供的 $p=7$ MPa 和 $x=0.2$ 下的状态方程值：\n- $x = 0.2$,\n- $\\rho_f = 730$ kg/m$^3$,\n- $\\rho_g = 35$ kg/m$^3$,\n- $h_f = 1250$ kJ/kg,\n- $h_g = 3060$ kJ/kg,\n- $c_{p,f} = 4.70$ kJ/(kg·K),\n- $c_{p,g} = 2.08$ kJ/(kg·K).\n\n计算 $h_m$：\n$$\nh_m = x\\,h_g + (1-x)\\,h_f = 0.2 \\times 3060 + 0.8 \\times 1250.\n$$\n计算每一项：\n$$\n0.2 \\times 3060 = 612,\\quad 0.8 \\times 1250 = 1000,\n$$\n所以\n$$\nh_m = 612 + 1000 = 1612.\n$$\n\n计算 $v_m$：\n$$\nv_m = x\\,\\frac{1}{\\rho_g} + (1-x)\\,\\frac{1}{\\rho_f} = 0.2 \\times \\frac{1}{35} + 0.8 \\times \\frac{1}{730}.\n$$\n计算倒数：\n$$\n\\frac{1}{35} \\approx 0.0285714286,\\quad \\frac{1}{730} \\approx 0.0013698630,\n$$\n所以\n$$\nv_m \\approx 0.2 \\times 0.0285714286 + 0.8 \\times 0.0013698630 = 0.0057142857 + 0.0010958904 = 0.0068101761.\n$$\n那么\n$$\n\\rho_m = \\frac{1}{v_m} \\approx \\frac{1}{0.0068101761} \\approx 146.83.\n$$\n\n计算 $c_{p,m}$：\n$$\nc_{p,m} = x\\,c_{p,g} + (1-x)\\,c_{p,f} = 0.2 \\times 2.08 + 0.8 \\times 4.70.\n$$\n计算每一项：\n$$\n0.2 \\times 2.08 = 0.416,\\quad 0.8 \\times 4.70 = 3.76,\n$$\n所以\n$$\nc_{p,m} = 0.416 + 3.76 = 4.176.\n$$\n\n将所有三个结果四舍五入至四位有效数字：\n- $\\rho_m \\approx 146.8$ kg/m$^3$,\n- $h_m = 1612$ kJ/kg,\n- $c_{p,m} = 4.176$ kJ/(kg·K).\n\n使用一阶 (线性化) 传播进行灵敏度讨论：\n\n1. 焓的灵敏度。由于 $h_m = x\\,h_g + (1-x)\\,h_f$，\n$$\n\\frac{\\partial h_m}{\\partial h_g} = x,\\quad \\frac{\\partial h_m}{\\partial h_f} = 1-x.\n$$\n对于相对不确定度 $\\delta h_g/h_g$ 和 $\\delta h_f/h_f$，\n$$\n\\delta h_m \\approx x\\,\\delta h_g + (1-x)\\,\\delta h_f.\n$$\n对于 $h_g$ 和 $h_f$ 均有 $\\pm 0.5\\%$ 的不确定度，一个代表性的变化是\n$$\n\\delta h_g = 0.005\\,h_g = 15.3,\\quad \\delta h_f = 0.005\\,h_f = 6.25,\n$$\n得出\n$$\n\\delta h_m \\approx 0.2 \\times 15.3 + 0.8 \\times 6.25 = 3.06 + 5.00 = 8.06,\n$$\n所以相对变化为\n$$\n\\frac{\\delta h_m}{h_m} \\approx \\frac{8.06}{1612} \\approx 0.0050,\n$$\n也就是说，大约 $0.5$%，这反映了 $h_m$ 对 $h_f$ 和 $h_g$ 的线性关系。\n\n2. 比热的灵敏度。由于 $c_{p,m} = x\\,c_{p,g} + (1-x)\\,c_{p,f}$，\n$$\n\\frac{\\partial c_{p,m}}{\\partial c_{p,g}} = x,\\quad \\frac{\\partial c_{p,m}}{\\partial c_{p,f}} = 1-x.\n$$\n对于 $\\pm 2\\%$ 的不确定度，\n$$\n\\delta c_{p,g} = 0.02 \\times 2.08 = 0.0416,\\quad \\delta c_{p,f} = 0.02 \\times 4.70 = 0.0940,\n$$\n那么\n$$\n\\delta c_{p,m} \\approx 0.2 \\times 0.0416 + 0.8 \\times 0.0940 = 0.00832 + 0.07520 = 0.08352,\n$$\n所以\n$$\n\\frac{\\delta c_{p,m}}{c_{p,m}} \\approx \\frac{0.08352}{4.176} \\approx 0.0200,\n$$\n也就是说，大约 $2$%。\n\n3. 密度的灵敏度。写作 $\\rho_m = 1/v_m$，其中 $v_m = x/\\rho_g + (1-x)/\\rho_f$。求微分：\n$$\nd v_m = x\\,d\\!\\left(\\frac{1}{\\rho_g}\\right) + (1-x)\\,d\\!\\left(\\frac{1}{\\rho_f}\\right) = -x\\,\\frac{d\\rho_g}{\\rho_g^{2}} - (1-x)\\,\\frac{d\\rho_f}{\\rho_f^{2}}.\n$$\n由于 $d\\rho_m = -\\rho_m^{2}\\,d v_m$，我们有\n$$\n\\frac{d\\rho_m}{\\rho_m} = -\\frac{d v_m}{v_m}.\n$$\n对于 $\\pm 1\\%$ 的不确定度，\n$$\nd\\rho_g = 0.01\\,\\rho_g = 0.35,\\quad d\\rho_f = 0.01\\,\\rho_f = 7.30,\n$$\n得到\n$$\n\\frac{\\partial v_m}{\\partial \\rho_g} = -\\frac{x}{\\rho_g^{2}} = -\\frac{0.2}{35^{2}} \\approx -1.63265 \\times 10^{-4},\n$$\n$$\n\\frac{\\partial v_m}{\\partial \\rho_f} = -\\frac{1-x}{\\rho_f^{2}} = -\\frac{0.8}{730^{2}} \\approx -1.50113 \\times 10^{-6}.\n$$\n因此\n$$\nd v_m \\approx \\left(-1.63265 \\times 10^{-4}\\right)\\times 0.35 + \\left(-1.50113 \\times 10^{-6}\\right)\\times 7.30 \\approx -5.7143 \\times 10^{-5} - 1.0958 \\times 10^{-5} = -6.8101 \\times 10^{-5}.\n$$\n当 $v_m \\approx 0.0068102$ 时，相对变化为\n$$\n-\\frac{d v_m}{v_m} \\approx -\\frac{-6.8101 \\times 10^{-5}}{0.0068102} \\approx 0.0100,\n$$\n所以\n$$\n\\frac{d\\rho_m}{\\rho_m} \\approx 0.0100,\n$$\n也就是说，大约 $1$%。来自汽相密度的贡献占主导地位，因为 $|\\partial v_m / \\partial \\rho_g| \\gg |\\partial v_m / \\partial \\rho_f|$，这反映了汽相的比容要大得多。\n\n总之，在 HEM 混合法则下，混合物性质 $\\rho_m$、$h_m$ 和 $c_{p,m}$ 以可预测的线性方式继承了来自状态方程的不确定度：$h_m$ 和 $c_{p,m}$ 直接遵循质量加权平均，而 $\\rho_m$ 对汽相密度最为敏感，这是由于其通过比容对各相密度存在类似调和平均数的依赖关系。\n\n数值结果四舍五入至四位有效数字：\n- $\\rho_m \\approx 146.8$ kg/m$^3$,\n- $h_m = 1612$ kJ/kg,\n- $c_{p,m} = 4.176$ kJ/(kg·K).",
            "answer": "$$\\boxed{\\begin{pmatrix}146.8 & 1612 & 4.176\\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然均相平衡模型简化了分析，但其核心假设——气液两相间无滑移速度——可能导致对关键参数预测的偏差。本练习通过将HEM对空泡份额 $\\alpha$ 的预测与更真实的漂移流模型进行比较，来量化这一误差 ()。这有助于深刻理解“均匀”假设的局限性及其对反应堆安全分析的影响。",
            "id": "4230507",
            "problem": "核反应堆堆芯中的一个垂直上升沸腾通道输运着饱和水-蒸汽混合物，其所处压力下的饱和液体密度为 $\\rho_{l} = 710 \\ \\mathrm{kg/m^{3}}$，饱和蒸汽密度为 $\\rho_{g} = 36 \\ \\mathrm{kg/m^{3}}$。在某一轴向位置，质量通量为 $G = 1000 \\ \\mathrm{kg/(m^{2}\\,s)}$，质量含汽率为 $x = 0.15$。考虑两种用于预测截面空泡份额 $\\alpha$ 的框架：\n\n1) 均匀平衡模型 (HEM)，该模型假设滑移比 $S = 1$。\n\n2) Zuber–Findlay 形式的漂移流公式，其特征在于分布参数 $C_{0}$ 和漂移速度 $V_{d}$。在这些条件下，使用 $C_{0} = 1.2$ 和 $V_{d} = 0.5 \\ \\mathrm{m/s}$。\n\n从各相的质量守恒、表观速度的定义、质量含汽率的定义以及通用的 Zuber–Findlay 漂移流关系式出发，推导计算由 HEM 和漂移流模型预测的空泡份额所需的表达式。然后，使用给定的数值数据，计算 HEM 相对于漂移流预测所产生的相对误差，其定义为\n$$\n\\varepsilon_{r} \\equiv \\frac{\\alpha_{\\mathrm{HEM}} - \\alpha_{\\mathrm{DF}}}{\\alpha_{\\mathrm{DF}}}.\n$$\n将 $\\varepsilon_{r}$ 表示为一个纯数（无量纲），并将您的最终结果四舍五入到四位有效数字。",
            "solution": "该问题要求对沸腾通道中空泡份额的两种预测模型进行对比分析：均匀平衡模型 (HEM) 和 Zuber-Findlay 漂移流模型。最终目标是计算 HEM 预测相对于漂移流预测的相对误差。该过程涉及从基本原理出发，为每种模型推导空泡份额的表达式，然后使用给定数据进行数值计算。\n\n首先，我们根据问题陈述定义基本变量。质量通量为 $G$，质量含汽率为 $x$，液体密度为 $\\rho_l$，蒸汽密度为 $\\rho_g$。单位面积的蒸汽（气）相和液相的质量流率分别为 $G_g$ 和 $G_l$，由下式给出：\n$$ G_g = xG $$\n$$ G_l = (1-x)G $$\n蒸汽相 ($j_g$) 和液相 ($j_l$) 的表观速度（即单位总面积的体积流率）为：\n$$ j_g = \\frac{G_g}{\\rho_g} = \\frac{xG}{\\rho_g} $$\n$$ j_l = \\frac{G_l}{\\rho_l} = \\frac{(1-x)G}{\\rho_l} $$\n混合物的总表观速度是各相表观速度之和，$j = j_g + j_l$。空泡份额 $\\alpha$ 是蒸汽相所占的截面积份额。各相的实际平均速度为：蒸汽相 $u_g = j_g/\\alpha$，液相 $u_l = j_l/(1-\\alpha)$。\n\n**1. 均匀平衡模型 (HEM) 的空泡份额, $\\alpha_{\\mathrm{HEM}}$**\n\nHEM 的核心假设是两相完全混合并以相同的速度运动。这意味着滑移比 $S = u_g/u_l$ 等于 $1$。\n$$ u_g = u_l \\implies \\frac{j_g}{\\alpha_{\\mathrm{HEM}}} = \\frac{j_l}{1 - \\alpha_{\\mathrm{HEM}}} $$\n为了找到 $\\alpha_{\\mathrm{HEM}}$ 的表达式，我们求解这个方程：\n$$ j_g(1 - \\alpha_{\\mathrm{HEM}}) = j_l \\alpha_{\\mathrm{HEM}} $$\n$$ j_g = j_g \\alpha_{\\mathrm{HEM}} + j_l \\alpha_{\\mathrm{HEM}} = \\alpha_{\\mathrm{HEM}} (j_g + j_l) $$\n$$ \\alpha_{\\mathrm{HEM}} = \\frac{j_g}{j_g + j_l} $$\n这表明在 HEM 模型下，空泡份额等于体积含汽率（也称容积含汽率）。我们代入 $j_g$ 和 $j_l$ 的表达式：\n$$ \\alpha_{\\mathrm{HEM}} = \\frac{\\frac{xG}{\\rho_g}}{\\frac{xG}{\\rho_g} + \\frac{(1-x)G}{\\rho_l}} $$\n质量通量 $G$ 是一个公因子，可以消去，从而得到用质量含汽率和相密度表示的 $\\alpha_{\\mathrm{HEM}}$ 标准公式：\n$$ \\alpha_{\\mathrm{HEM}} = \\frac{\\frac{x}{\\rho_g}}{\\frac{x}{\\rho_g} + \\frac{1-x}{\\rho_l}} = \\frac{1}{1 + \\frac{1-x}{x}\\frac{\\rho_g}{\\rho_l}} $$\n\n**2. 漂移流模型的空泡份额, $\\alpha_{\\mathrm{DF}}$**\n\nZuber-Findlay 漂移流模型提供了一个更通用的关系式，它考虑了不均匀的相分布和相间的相对运动。该模型将截面平均蒸汽速度 $u_g$ 与混合物表观速度 $j$ 和漂移速度 $V_d$ 联系起来：\n$$ u_g = \\frac{j_g}{\\alpha_{\\mathrm{DF}}} = C_0 j + V_d $$\n此处，$C_0$ 是分布参数，用于解释空泡份额和混合物速度的径向分布剖面。为了求出空泡份额 $\\alpha_{\\mathrm{DF}}$，我们重新整理这个方程：\n$$ \\alpha_{\\mathrm{DF}} = \\frac{j_g}{C_0 j + V_d} $$\n代入 $j = j_g + j_l$ 可得：\n$$ \\alpha_{\\mathrm{DF}} = \\frac{j_g}{C_0(j_g + j_l) + V_d} $$\n现在我们用给定的问题数据来表示这个表达式：\n$$ \\alpha_{\\mathrm{DF}} = \\frac{\\frac{xG}{\\rho_g}}{C_0 \\left( \\frac{xG}{\\rho_g} + \\frac{(1-x)G}{\\rho_l} \\right) + V_d} $$\n\n**3. 数值计算**\n\n我们已知以下数据：$\\rho_{l} = 710 \\ \\mathrm{kg/m^{3}}$，$\\rho_{g} = 36 \\ \\mathrm{kg/m^{3}}$，$G = 1000 \\ \\mathrm{kg/(m^{2}\\,s)}$，$x = 0.15$，$C_{0} = 1.2$，以及 $V_{d} = 0.5 \\ \\mathrm{m/s}$。\n\n首先，我们计算 HEM 的空泡份额 $\\alpha_{\\mathrm{HEM}}$：\n$$ \\alpha_{\\mathrm{HEM}} = \\frac{1}{1 + \\frac{1 - 0.15}{0.15} \\cdot \\frac{36}{710}} = \\frac{1}{1 + \\frac{0.85}{0.15} \\cdot \\frac{36}{710}} = \\frac{1}{1 + \\frac{17}{3} \\cdot \\frac{36}{710}} = \\frac{1}{1 + \\frac{17 \\cdot 12}{710}} = \\frac{1}{1 + \\frac{204}{710}} $$\n$$ \\alpha_{\\mathrm{HEM}} = \\frac{1}{\\frac{710 + 204}{710}} = \\frac{710}{914} = \\frac{355}{457} \\approx 0.776805 $$\n\n接下来，为了进行漂移流计算，我们计算表观速度：\n$$ j_g = \\frac{xG}{\\rho_g} = \\frac{0.15 \\times 1000}{36} = \\frac{150}{36} = \\frac{25}{6} \\ \\mathrm{m/s} $$\n$$ j_l = \\frac{(1-x)G}{\\rho_l} = \\frac{(1-0.15) \\times 1000}{710} = \\frac{850}{710} = \\frac{85}{71} \\ \\mathrm{m/s} $$\n现在我们用这些值来计算 $\\alpha_{\\mathrm{DF}}$：\n$$ \\alpha_{\\mathrm{DF}} = \\frac{\\frac{25}{6}}{1.2 \\left(\\frac{25}{6} + \\frac{85}{71}\\right) + 0.5} = \\frac{\\frac{25}{6}}{\\frac{6}{5}\\left(\\frac{25 \\cdot 71 + 85 \\cdot 6}{426}\\right) + \\frac{1}{2}} = \\frac{\\frac{25}{6}}{\\frac{6}{5}\\left(\\frac{1775 + 510}{426}\\right) + \\frac{1}{2}} $$\n$$ \\alpha_{\\mathrm{DF}} = \\frac{\\frac{25}{6}}{\\frac{6}{5}\\left(\\frac{2285}{426}\\right) + \\frac{1}{2}} = \\frac{\\frac{25}{6}}{\\frac{2285}{355} + \\frac{1}{2}} = \\frac{\\frac{25}{6}}{\\frac{457}{71} + \\frac{1}{2}} = \\frac{\\frac{25}{6}}{\\frac{2 \\cdot 457 + 71}{142}} = \\frac{\\frac{25}{6}}{\\frac{914 + 71}{142}} = \\frac{\\frac{25}{6}}{\\frac{985}{142}} $$\n$$ \\alpha_{\\mathrm{DF}} = \\frac{25}{6} \\cdot \\frac{142}{985} = \\frac{25 \\cdot 71}{3 \\cdot 985} = \\frac{1775}{2955} = \\frac{355}{591} \\approx 0.600677 $$\n\n**4. 相对误差计算**\n\nHEM 预测相对于漂移流预测的相对误差 $\\varepsilon_r$ 定义为：\n$$ \\varepsilon_{r} = \\frac{\\alpha_{\\mathrm{HEM}} - \\alpha_{\\mathrm{DF}}}{\\alpha_{\\mathrm{DF}}} = \\frac{\\alpha_{\\mathrm{HEM}}}{\\alpha_{\\mathrm{DF}}} - 1 $$\n代入我们计算出的精确分数值：\n$$ \\varepsilon_{r} = \\frac{\\frac{355}{457}}{\\frac{355}{591}} - 1 = \\frac{355}{457} \\cdot \\frac{591}{355} - 1 = \\frac{591}{457} - 1 $$\n$$ \\varepsilon_{r} = \\frac{591 - 457}{457} = \\frac{134}{457} \\approx 0.29321663 $$\n问题要求将结果四舍五入到四位有效数字。\n$$ \\varepsilon_{r} \\approx 0.2932 $$\n正误差表明，在这些条件下，均匀平衡模型与更切合实际的漂移流模型相比，显著高估了空泡份额。这是预料之中的，因为 HEM 忽略了滑移 ($u_g > u_l$)，而对于给定的质量含汽率，更高的蒸汽速度意味着蒸汽通过时所需的面积更小（因此空泡份额也更小）。",
            "answer": "$$\n\\boxed{0.2932}\n$$"
        },
        {
            "introduction": "将理论模型转化为实际的模拟工具，需要将控制方程组转化为数值算法。这项高级练习将指导您构建一个有限体积格式，并实现一个适用于HEM方程的Rusanov数值通量 ()。通过这个实践，您将直接体验如何将均相平衡模型应用于计算流体动力学程序中。",
            "id": "4230569",
            "problem": "用于一维空间两相混合物流动的均相平衡模型 (HEM) 假设混合物具有单一的共同速度和单一的共同压力，且相间处于力学和热力学平衡状态。考虑守恒变量矢量 $\\mathbf{U} = (\\rho_m, \\rho_m u, \\rho_m E)$，其中 $\\rho_m$ 是混合物密度，$u$ 是混合物速度，$E$ 是混合物总比能。从质量、动量和能量的基本守恒定律以及可压缩混合物的无粘通量定义出发，在单元宽度为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，构建一维 HEM 的有限体积离散格式，并忽略外部源项。假设该混合物遵循与均相平衡热力学一致的可压缩闭合关系，该关系由刚性气体混合物状态方程 (EOS) 建模：混合物压力 $p$ 由 $p = (\\gamma_m - 1)\\rho_m e - \\gamma_m p_{\\infty,m}$ 给出，其中 $\\gamma_m$ 是混合物比热比，$p_{\\infty,m}$ 是混合物刚性压力，$e$ 是混合物比内能。总比能满足 $E = e + \\frac{1}{2}u^2$。混合物声速定义为 $c = \\sqrt{\\gamma_m \\frac{p + p_{\\infty,m}}{\\rho_m}}$，这与均相平衡下的刚性气体热力学一致。\n\n您的任务是：\n- 从守恒定律和热力学闭合关系推导出守恒无粘通量矢量 $\\mathbf{F}(\\mathbf{U})$，并提供一个适用于有限体积离散的、在单元界面上一致的数值通量。\n- 使用左右状态 $\\mathbf{U}_L$ 和 $\\mathbf{U}_R$ 在界面 $i+\\frac{1}{2}$ 处实现 Rusanov (局部 Lax–Friedrichs) 数值通量，其中界面波速为 $s_{\\max} = \\max(|u_L| + c_L, |u_R| + c_R)$，而 $u_L$、$c_L$ 和 $u_R$、$c_R$ 通过指定的热力学闭合关系由 $\\mathbf{U}_L$ 和 $\\mathbf{U}_R$ 计算得出。\n\n您必须生成一个完整的、可运行的程序，该程序能针对一组给定的界面状态和 EOS 参数，为每个界面测试用例计算 Rusanov 数值通量矢量 $\\mathbf{F}_{\\text{num}}$。物理单位如下：$\\rho_m$ 的单位是 $\\mathrm{kg/m^3}$，$u$ 的单位是 $\\mathrm{m/s}$，$E$ 的单位是 $\\mathrm{J/kg}$，$p$ 的单位是 $\\mathrm{Pa}$，$c$ 的单位是 $\\mathrm{m/s}$，质量通量的单位是 $\\mathrm{kg/(m^2\\cdot s)}$，动量通量的单位是 $\\mathrm{N/m^2}$，能量通量的单位是 $\\mathrm{W/m^2}$。所有计算出的通量分量都用这些 $\\mathrm{SI}$ 单位表示。本问题不使用角度。请将任何分数或比率表示为十进制数。\n\n定义以下界面状态测试套件，每个测试用例为一个元组，指定了 $(\\rho_{L}, \\rho_{L}u_{L}, \\rho_{L}E_{L}, \\rho_{R}, \\rho_{R}u_{R}, \\rho_{R}E_{R}, \\gamma_m, p_{\\infty,m})$：\n- 测试用例 $1$ (中等，以气相为主的混合物)：$(\\rho_{L}, \\rho_{L}u_{L}, \\rho_{L}E_{L}) = (\\,5.0,\\,50.0,\\,500250.0\\,)$ 和 $(\\rho_{R}, \\rho_{R}u_{R}, \\rho_{R}E_{R}) = (\\,4.0,\\,0.0,\\,320000.0\\,)$，其中 $(\\gamma_m, p_{\\infty,m}) = (\\,1.30,\\,0.0\\,)$。\n- 测试用例 $2$ (近真空，左侧超音速状态)：$(\\rho_{L}, \\rho_{L}u_{L}, \\rho_{L}E_{L}) = (\\,0.2,\\,60.0,\\,9600.0\\,)$ 和 $(\\rho_{R}, \\rho_{R}u_{R}, \\rho_{R}E_{R}) = (\\,0.1,\\,10.0,\\,700.0\\,)$，其中 $(\\gamma_m, p_{\\infty,m}) = (\\,1.33,\\,0.0\\,)$。\n- 测试用例 $3$ (刚性气体混合物，以液相为主)：$(\\rho_{L}, \\rho_{L}u_{L}, \\rho_{L}E_{L}) = (\\,100.0,\\,500.0,\\,10001250.0\\,)$ 和 $(\\rho_{R}, \\rho_{R}u_{R}, \\rho_{R}E_{R}) = (\\,120.0,\\,-600.0,\\,14401500.0\\,)$，其中 $(\\gamma_m, p_{\\infty,m}) = (\\,2.0,\\,1000000.0\\,)$。\n- 测试用例 $4$ (对称平衡，零速度)：$(\\rho_{L}, \\rho_{L}u_{L}, \\rho_{L}E_{L}) = (\\,1.0,\\,0.0,\\,100000.0\\,)$ 和 $(\\rho_{R}, \\rho_{R}u_{R}, \\rho_{R}E_{R}) = (\\,1.0,\\,0.0,\\,100000.0\\,)$，其中 $(\\gamma_m, p_{\\infty,m}) = (\\,1.30,\\,0.0\\,)$。\n\n您的程序必须对上述每个测试用例，在界面的每一侧使用以下步骤计算界面处的 Rusanov 数值通量矢量 $\\mathbf{F}_{\\text{num}}$：\n1. 从守恒变量中恢复原始变量：$u = \\frac{\\rho u}{\\rho}$，$E = \\frac{\\rho E}{\\rho}$，$e = E - \\frac{1}{2}u^2$。\n2. 通过刚性气体混合物 EOS 计算压力：$p = (\\gamma_m - 1)\\rho e - \\gamma_m p_{\\infty,m}$。\n3. 计算声速：$c = \\sqrt{\\gamma_m \\frac{p + p_{\\infty,m}}{\\rho}}$。\n4. 计算物理无粘通量矢量 $\\mathbf{F}(\\mathbf{U}) = \\left(\\rho u,\\ \\rho u^2 + p,\\ u (\\rho E + p)\\right)$。\n5. 组装 Rusanov 通量：$\\mathbf{F}_{\\text{num}} = \\frac{1}{2}\\left(\\mathbf{F}(\\mathbf{U}_L) + \\mathbf{F}(\\mathbf{U}_R)\\right) - \\frac{1}{2}s_{\\max}\\left(\\mathbf{U}_R - \\mathbf{U}_L\\right)$，其中 $s_{\\max} = \\max\\left(|u_L| + c_L,\\ |u_R| + c_R\\right)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目本身是一个包含三个十进制数的列表，分别对应于各个测试用例（按测试用例 $1$ 到 $4$ 的顺序）的 $\\mathbf{F}_{\\text{num}}$ 的质量、动量和能量分量。例如，输出必须采用 $[\\,[f_{1,1},f_{1,2},f_{1,3}],\\,[f_{2,1},f_{2,2},f_{2,3}],\\,[f_{3,1},f_{3,2},f_{3,3}],\\,[f_{4,1},f_{4,2},f_{4,3}]\\,]$ 的形式，其中每个 $f_{i,j}$ 都是一个以 $\\mathrm{SI}$ 单位表示的浮点数。",
            "solution": "用户要求解决一个计算流体力学问题，该问题涉及为均相平衡模型 (HEM) 实现一个数值通量。该问题被认为是有效的，因为它具有科学依据、问题明确且完整。\n\n### 1. 理论框架：守恒定律和通量矢量\n\n该问题的基础是一维欧拉方程，它表示了无粘、可压缩流体的质量、动量和能量守恒。对于被视为单一流体的均相两相混合物，这些方程以守恒形式写为：\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = \\mathbf{0}\n$$\n这里，$\\mathbf{U}$ 是守恒变量矢量，$\\mathbf{F}(\\mathbf{U})$ 是相应的物理通量矢量。\n\n混合物的守恒变量矢量 $\\mathbf{U}$ 定义为：\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho_m \\\\ \\rho_m u \\\\ \\rho_m E \\end{pmatrix}\n$$\n其中 $\\rho_m$ 是混合物密度，$u$ 是混合物速度，$E$ 是混合物总比能。\n\n物理通量矢量 $\\mathbf{F}(\\mathbf{U})$ 由守恒定律的积分形式推导得出：\n1.  **质量守恒**：质量通量是质量密度乘以速度，即单位面积的质量流率。\n    $$F_1 = \\rho_m u$$\n2.  **动量守恒**：动量通量包括两项：动量的平流输运 ($\\rho_m u^2$) 和压力 ($p$) 产生的力。\n    $$F_2 = \\rho_m u^2 + p$$\n3.  **能量守恒**：总能量通量是总能量的平流输运 ($\\rho_m E u$) 和压力力所做功的速率 ($p u$) 之和。\n    $$F_3 = (\\rho_m E) u + p u = u(\\rho_m E + p)$$\n\n结合这些分量，得到完整的无粘通量矢量：\n$$\n\\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho_m u \\\\ \\rho_m u^2 + p \\\\ u(\\rho_m E + p) \\end{pmatrix}\n$$\n这与问题陈述中提供的矢量相符。第一个分量是质量通量，第二个是动量通量（压力加上动量输运），第三个是能量通量。\n\n### 2. 热力学闭合关系：刚性气体状态方程\n\n为了求解该系统，需要一个闭合关系将压力 $p$ 与 $\\mathbf{U}$ 中的守恒变量联系起来。问题指定了一个刚性气体混合物状态方程 (EOS)：\n$$\np = (\\gamma_m - 1)\\rho_m e - \\gamma_m p_{\\infty,m}\n$$\n其中 $e$ 是比内能，$\\gamma_m$ 是混合物的比热比，$p_{\\infty,m}$ 是混合物的刚性压力常数。总比能 $E$ 是比内能 $e$ 和比动能 $\\frac{1}{2}u^2$ 的和：\n$$\nE = e + \\frac{1}{2}u^2 \\implies e = E - \\frac{1}{2}u^2\n$$\n与此 EOS 一致的声速 $c$ 由下式给出：\n$$\nc = \\sqrt{\\gamma_m \\frac{p + p_{\\infty,m}}{\\rho_m}}\n$$\n该热力学闭合关系使得所有原始变量 ($u, p, e, c$) 和通量矢量 $\\mathbf{F}(\\mathbf{U})$ 都可以从守恒状态矢量 $\\mathbf{U}$ 计算得出。\n\n### 3. 数值通量：Rusanov 格式\n\n在有限体积法中，单元界面（例如 $x_{i+1/2}$）处的连续通量函数 $\\mathbf{F}(\\mathbf{U})$ 被一个数值通量函数 $\\mathbf{F}_{\\text{num}}$ 所取代，该函数取决于界面左侧 ($\\mathbf{U}_L$) 和右侧 ($\\mathbf{U}_R$) 的状态。问题指定了 Rusanov (或局部 Lax-Friedrichs) 通量：\n$$\n\\mathbf{F}_{\\text{num}}(\\mathbf{U}_L, \\mathbf{U}_R) = \\frac{1}{2}\\left(\\mathbf{F}(\\mathbf{U}_L) + \\mathbf{F}(\\mathbf{U}_R)\\right) - \\frac{1}{2}s_{\\max}\\left(\\mathbf{U}_R - \\mathbf{U}_L\\right)\n$$\n该格式由一个平均通量项和一个数值耗散项组成。耗散项由界面处的最大特征波速 $s_{\\max}$ 进行缩放。对于欧拉方程，特征速度为 $u-c$、$u$ 和 $u+c$。从左右状态传播的最大信号速度由下式给出：\n$$\ns_{\\max} = \\max\\left(|u_L| + c_L, |u_R| + c_R\\right)\n$$\n\n### 4. 算法步骤\n\n对于每个测试用例，通过遵循精确的步骤序列来计算 Rusanov 数值通量：\n\n1.  **状态分解**：对于每个状态（左侧和右侧），由守恒矢量 $\\mathbf{U} = (U_1, U_2, U_3)^T$ 表示，恢复其原始变量：\n    *   $\\rho_m = U_1$\n    *   $u = U_2 / U_1$\n    *   $E = U_3 / U_1$\n\n2.  **热力学计算**：为每个状态计算热力学性质：\n    *   比内能：$e = E - \\frac{1}{2}u^2$\n    *   压力：$p = (\\gamma_m - 1)\\rho_m e - \\gamma_m p_{\\infty,m}$\n    *   声速：$c = \\sqrt{\\gamma_m (p + p_{\\infty,m}) / \\rho_m}$\n\n3.  **物理通量计算**：使用恢复的变量为每个状态计算物理通量矢量 $\\mathbf{F}(\\mathbf{U})$：\n    *   $F_1 = \\rho_m u = U_2$\n    *   $F_2 = \\rho_m u^2 + p = U_2^2/U_1 + p$\n    *   $F_3 = u(\\rho_m E + p) = (U_2/U_1)(U_3 + p)$\n\n4.  **Rusanov 通量组装**：在计算完左侧 $(\\cdot)_L$ 和右侧 $(\\cdot)_R$ 状态的性质后：\n    *   确定最大波速 $s_{\\max} = \\max\\left(|u_L| + c_L, |u_R| + c_R\\right)$。\n    *   使用其定义组装最终的数值通量矢量 $\\mathbf{F}_{\\text{num}}$，该定义结合了物理通量 $\\mathbf{F}_L$、$\\mathbf{F}_R$，守恒状态 $\\mathbf{U}_L$、$\\mathbf{U}_R$ 以及波速 $s_{\\max}$。\n\n对每个提供的测试用例实施此程序，以产生所需的数值通量矢量。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the Rusanov numerical flux for each interface state and\n    prints the results in the specified format.\n    \"\"\"\n\n    # Test cases defined as tuples of:\n    # (rho_L, rhou_L, rhoE_L, rho_R, rhou_R, rhoE_R, gamma_m, p_inf_m)\n    test_cases = [\n        # Case 1: moderate, vapor-dominated mixture\n        (5.0, 50.0, 500250.0, 4.0, 0.0, 320000.0, 1.30, 0.0),\n        # Case 2: near-vacuum, supersonic left state\n        (0.2, 60.0, 9600.0, 0.1, 10.0, 700.0, 1.33, 0.0),\n        # Case 3: stiffened-gas mixture, liquid-dominated\n        (100.0, 500.0, 10001250.0, 120.0, -600.0, 14401500.0, 2.0, 1000000.0),\n        # Case 4: symmetric equilibrium, zero velocity\n        (1.0, 0.0, 100000.0, 1.0, 0.0, 100000.0, 1.30, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        U_L = np.array([case[0], case[1], case[2]])\n        U_R = np.array([case[3], case[4], case[5]])\n        gamma_m = case[6]\n        p_inf_m = case[7]\n        \n        flux_vector = compute_rusanov_flux(U_L, U_R, gamma_m, p_inf_m)\n        results.append(flux_vector.tolist())\n\n    # Format the output string to match the required format \"[[...],[...],...]\"\n    # by converting the list of lists to a string and removing spaces.\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\ndef compute_state_properties(U, gamma_m, p_inf_m):\n    \"\"\"\n    Computes primitive variables, thermodynamic properties, and the physical flux\n    vector from a given conservative state vector U.\n\n    Args:\n        U (np.ndarray): Conservative state vector [rho, rho*u, rho*E].\n        gamma_m (float): Mixture ratio of specific heats.\n        p_inf_m (float): Mixture stiffening pressure.\n\n    Returns:\n        tuple: A tuple containing velocity (u), speed of sound (c), and\n               the physical flux vector F.\n    \"\"\"\n    rho = U[0]\n    rho_u = U[1]\n    rho_E = U[2]\n\n    # Avoid division by zero, although not expected for the given test cases.\n    if rho == 0:\n        return 0.0, 0.0, np.zeros(3)\n\n    # 1. Recover primitive variables\n    u = rho_u / rho\n    E = rho_E / rho\n    e = E - 0.5 * u**2\n\n    # 2. Compute pressure from stiffened-gas EOS\n    p = (gamma_m - 1) * rho * e - gamma_m * p_inf_m\n\n    # 3. Compute speed of sound\n    # Ensure the argument of sqrt is non-negative\n    p_plus_pinf = p + p_inf_m\n    if p_plus_pinf  0 or rho == 0:\n        # This case indicates unphysical data\n        c = 0.0\n    else:\n        c = np.sqrt(gamma_m * p_plus_pinf / rho)\n\n    # 4. Compute physical inviscid flux vector F(U)\n    F = np.array([\n        rho_u,\n        rho_u * u + p,\n        u * (rho_E + p)\n    ])\n\n    return u, c, F\n\ndef compute_rusanov_flux(U_L, U_R, gamma_m, p_inf_m):\n    \"\"\"\n    Computes the Rusanov (local Lax-Friedrichs) numerical flux.\n\n    Args:\n        U_L (np.ndarray): Left conservative state vector.\n        U_R (np.ndarray): Right conservative state vector.\n        gamma_m (float): Mixture ratio of specific heats.\n        p_inf_m (float): Mixture stiffening pressure.\n\n    Returns:\n        np.ndarray: The Rusanov numerical flux vector.\n    \"\"\"\n    # Compute properties for left and right states\n    u_L, c_L, F_L = compute_state_properties(U_L, gamma_m, p_inf_m)\n    u_R, c_R, F_R = compute_state_properties(U_R, gamma_m, p_inf_m)\n\n    # 5. Assemble the Rusanov flux\n    # Compute maximum wave speed s_max\n    s_max = max(np.abs(u_L) + c_L, np.abs(u_R) + c_R)\n\n    # Compute Rusanov flux\n    F_num = 0.5 * (F_L + F_R) - 0.5 * s_max * (U_R - U_L)\n\n    return F_num\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}