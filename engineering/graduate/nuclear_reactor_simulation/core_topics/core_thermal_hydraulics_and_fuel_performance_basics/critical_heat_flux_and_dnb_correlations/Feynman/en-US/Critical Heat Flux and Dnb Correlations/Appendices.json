{
    "hands_on_practices": [
        {
            "introduction": "Predicting the Critical Heat Flux ($CHF$) is a cornerstone of reactor safety analysis, yet its complex physics necessitates the use of empirical correlations. This first exercise provides a direct, hands-on application of this approach by asking you to implement two classic correlations, W-3 and Tong, to calculate the Departure from Nucleate Boiling (DNB) heat flux for given local conditions . By comparing their predictions, you will gain an appreciation for the empirical nature of CHF modeling and the sensitivity of safety limits to the choice of correlation.",
            "id": "4220471",
            "problem": "Implement a physically consistent computation of the local Critical Heat Flux (CHF) using two widely used Departure from Nucleate Boiling (DNB) correlations under Pressurized Water Reactor conditions: the Westinghouse W-3 correlation and Tong’s correlation. Start from dimensionless hydrodynamic scaling consistent with conservation laws for mass, momentum, and energy in a boiling flow, where CHF depends on mass flux $G$ (kilogram per square meter per second), pressure $p$ (megapascal), hydraulic diameter $D$ (meter), and local thermodynamic quality $x$ (dimensionless). Use a principled regression-based power-law structure consistent with the literature for rod-bundle boiling crisis, in which CHF scales as a function of $G$, $D$, $p$ relative to the critical pressure, and weakly on $x$.\n\nYour task is to implement both correlations with the following model forms and constants for water:\n- The Westinghouse W-3 correlation:\n  $$q''_{\\mathrm{CHF,W3}} = K_{\\mathrm{W3}} \\, G^{m} \\left(\\frac{p}{p_c}\\right)^{n} D^{d} \\left(1 + a_{\\mathrm{W3}} x\\right),$$\n- Tong’s correlation:\n  $$q''_{\\mathrm{CHF,Tong}} = K_{\\mathrm{Tong}} \\, G^{m} \\left(\\frac{p}{p_c}\\right)^{n} D^{d} \\left(1 + a_{\\mathrm{Tong}} x\\right),$$\nwith fixed exponents $m$, $n$, $d$ and constants selected from robust regressions of rod-bundle data, appropriate for the range $p \\in [5,21]$ megapascal, $G \\in [500,6000]$ kilogram per square meter per second, $D \\in [0.008,0.020]$ meter, and $x \\in [-0.6,0.3]$. Use the following numerical values:\n- $p_c = 22.064$ megapascal (critical pressure of water),\n- $m = 0.5$, $n = 0.1$, $d = -0.2$,\n- $K_{\\mathrm{W3}} = 7.5 \\times 10^{4}$ watt per square meter,\n- $K_{\\mathrm{Tong}} = 7.0 \\times 10^{4}$ watt per square meter,\n- $a_{\\mathrm{W3}} = 0.15$, $a_{\\mathrm{Tong}} = 0.10$.\n\nCompute $q''_{\\mathrm{CHF}}$ for the following test suite of cases, all expressed with $p$ in megapascal, $G$ in kilogram per square meter per second, $x$ dimensionless, and $D$ in meter:\n- Case $1$: $p = 16$, $G = 3500$, $x = -0.1$, $D = 0.0123$.\n- Case $2$: $p = 16$, $G = 1500$, $x = -0.5$, $D = 0.0123$.\n- Case $3$: $p = 7$, $G = 5000$, $x = 0.0$, $D = 0.0095$.\n- Case $4$: $p = 21$, $G = 3000$, $x = 0.2$, $D = 0.0170$.\n\nFor each case, compute:\n- $q''_{\\mathrm{CHF,W3}}$ in megawatt per square meter (MW/m$^2$),\n- $q''_{\\mathrm{CHF,Tong}}$ in megawatt per square meter (MW/m$^2$),\n- the relative difference $(q''_{\\mathrm{CHF,Tong}} - q''_{\\mathrm{CHF,W3}})/q''_{\\mathrm{CHF,W3}}$ as a decimal.\n\nRound each CHF value to $3$ decimal places and each relative difference to $4$ decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one case and is itself a list of three floats: $[q''_{\\mathrm{CHF,W3}}, q''_{\\mathrm{CHF,Tong}}, \\text{relative difference}]$. For example, the output format should be like:\n$[[q1\\_W3,q1\\_Tong,rdiff1],[q2\\_W3,q2\\_Tong,rdiff2],[q3\\_W3,q3\\_Tong,rdiff3],[q4\\_W3,q4\\_Tong,rdiff4]]$,\nexpressed in megawatt per square meter (MW/m$^2$) for the CHF values and unitless decimal for the relative differences.\n\nImplement your solution as a complete, runnable program without any user input, strictly following the specified final output format.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of thermal-hydraulics, well-posed with all necessary information provided, and objective in its formulation. The task is to compute the Critical Heat Flux (CHF) using two established empirical correlations—the Westinghouse W-3 and Tong correlations—for several operating conditions relevant to Pressurized Water Reactors (PWRs).\n\nThe computational approach is designed based on the following principles:\n\n1.  **Physical Foundation of Critical Heat Flux (CHF):** CHF is a thermal limit in two-phase heat transfer systems, representing the heat flux at which a boiling crisis occurs. In the context of PWRs, the relevant phenomenon is the Departure from Nucleate Boiling (DNB), where a stable vapor film forms on the heated surface, drastically degrading heat transfer and leading to a rapid and potentially damaging rise in surface temperature. Due to the complexity of the underlying physics, CHF is typically predicted using empirical correlations derived from extensive experimental data. These correlations relate CHF to key operational parameters.\n\n2.  **Mathematical Model Formulation:** The problem provides two such correlations, which follow a regression-based power-law structure common in the field. This structure is consistent with dimensionless hydrodynamic scaling principles.\n\n    The Westinghouse W-3 correlation is given by:\n    $$q''_{\\mathrm{CHF,W3}} = K_{\\mathrm{W3}} \\, G^{m} \\left(\\frac{p}{p_c}\\right)^{n} D^{d} \\left(1 + a_{\\mathrm{W3}} x\\right)$$\n\n    Tong’s correlation has a similar form:\n    $$q''_{\\mathrm{CHF,Tong}} = K_{\\mathrm{Tong}} \\, G^{m} \\left(\\frac{p}{p_c}\\right)^{n} D^{d} \\left(1 + a_{\\mathrm{Tong}} x\\right)$$\n\n    In these equations:\n    -   $q''_{\\mathrm{CHF}}$ represents the critical heat flux in watts per square meter (W/m$^2$).\n    -   The term $G^{m}$ (with $m = 0.5$) captures the effect of mass flux $G$. A higher mass flux enhances coolant mixing and delays the formation of a stable vapor film, thus increasing CHF.\n    -   The term $\\left(\\frac{p}{p_c}\\right)^{n}$ accounts for the system pressure $p$ relative to the critical pressure $p_c$. Fluid properties (like latent heat of vaporization and surface tension), which strongly influence boiling, are functions of pressure. This dimensionless group captures their aggregate effect.\n    -   The term $D^{d}$ (with $d = -0.2$) represents the influence of the hydraulic diameter $D$. For a smaller diameter, CHF tends to be higher.\n    -   The term $\\left(1 + a x\\right)$ adjusts for the local thermodynamic quality $x$. A negative quality corresponds to subcooled liquid, which can absorb more energy before a boiling crisis, thus increasing CHF. Conversely, a positive quality (net vapor generation) reduces the margin to CHF.\n    -   $K$ and $a$ are empirically fitted constants specific to each correlation.\n\n3.  **Algorithmic Implementation:** The solution is implemented by systematically applying these formulas to a given set of test cases.\n\n    **Step 1: Define Constants**\n    All physical and model constants are defined first. This includes the critical pressure of water, $p_c = 22.064$ MPa, the exponents $m = 0.5$, $n = 0.1$, $d = -0.2$, and the correlation-specific coefficients $K_{\\mathrm{W3}} = 7.5 \\times 10^4$ W/m$^2$, $a_{\\mathrm{W3}} = 0.15$, $K_{\\mathrm{Tong}} = 7.0 \\times 10^4$ W/m$^2$, and $a_{\\mathrm{Tong}} = 0.10$.\n\n    **Step 2: Process Test Cases**\n    The algorithm iterates through each specified test case, where each case provides a set of parameters $(p, G, x, D)$. For each case:\n\n    -   The common power-law term, $G^{m} \\left(\\frac{p}{p_c}\\right)^{n} D^{d}$, is calculated. This term is identical for both correlations.\n    -   The CHF value for the W-3 correlation, $q''_{\\mathrm{CHF,W3}}$, is computed in W/m$^2$ by multiplying the common term by $K_{\\mathrm{W3}}$ and $(1 + a_{\\mathrm{W3}} x)$.\n    -   Similarly, the CHF for Tong's correlation, $q''_{\\mathrm{CHF,Tong}}$, is computed in W/m$^2$ using its respective constants, $K_{\\mathrm{Tong}}$ and $a_{\\mathrm{Tong}}$.\n\n    **Step 3: Unit Conversion and Relative Difference**\n    -   The calculated CHF values, which are in W/m$^2$, are converted to megawatts per square meter (MW/m$^2$) by dividing by $10^6$.\n    -   The relative difference is calculated using the formula $\\frac{q''_{\\mathrm{CHF,Tong}} - q''_{\\mathrm{CHF,W3}}}{q''_{\\mathrm{CHF,W3}}}$. This can be computed more stably as $\\frac{q''_{\\mathrm{CHF,Tong}}}{q''_{\\mathrm{CHF,W3}}} - 1$, which simplifies to $\\frac{K_{\\mathrm{Tong}}(1 + a_{\\mathrm{Tong}}x)}{K_{\\mathrm{W3}}(1 + a_{\\mathrm{W3}}x)} - 1$, thereby minimizing floating-point errors from the subtraction of large numbers.\n\n    **Step 4: Rounding and Aggregation**\n    -   Following the problem specification, the resulting CHF values in MW/m$^2$ are rounded to $3$ decimal places, and the relative difference is rounded to $4$ decimal places.\n    -   The three rounded values, $[q''_{\\mathrm{CHF,W3}}, q''_{\\mathrm{CHF,Tong}}, \\text{relative difference}]$, are collected into a list for the current test case.\n    -   This list is then appended to a main results list that aggregates the outcomes for all test cases.\n\n    **Step 5: Output Formatting**\n    -   Finally, the aggregated list of lists is converted into a string representation that strictly matches the required format `[[...],[...],...]`, with no spaces within the structure. This is accomplished by converting the list to a string and removing all whitespace characters.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Critical Heat Flux (CHF) using W-3 and Tong correlations\n    for a given set of test cases and formats the output as specified.\n    \"\"\"\n    # Define physical and model constants as per the problem statement.\n    # Critical pressure of water in megapascals (MPa).\n    p_c = 22.064\n    \n    # Power-law exponents for the correlations.\n    m = 0.5  # Exponent for mass flux G\n    n = 0.1  # Exponent for pressure ratio p/p_c\n    d = -0.2 # Exponent for hydraulic diameter D\n    \n    # Westinghouse W-3 correlation constants.\n    K_W3 = 7.5e4  # Base coefficient in W/m^2\n    a_W3 = 0.15   # Coefficient for quality x\n    \n    # Tong's correlation constants.\n    K_Tong = 7.0e4 # Base coefficient in W/m^2\n    a_Tong = 0.10  # Coefficient for quality x\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (p [MPa], G [kg/m^2-s], x [dimensionless], D [m])\n    test_cases = [\n        (16.0, 3500.0, -0.1, 0.0123),\n        (16.0, 1500.0, -0.5, 0.0123),\n        (7.0, 5000.0, 0.0, 0.0095),\n        (21.0, 3000.0, 0.2, 0.0170),\n    ]\n\n    results = []\n    for p, G, x, D in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        \n        # Calculate the common power-law term shared by both correlations.\n        # This term captures the combined scaling effect of G, p, and D.\n        common_term = np.power(G, m) * np.power(p / p_c, n) * np.power(D, d)\n        \n        # Calculate CHF using the W-3 correlation in W/m^2.\n        q_chf_w3_w = K_W3 * common_term * (1.0 + a_W3 * x)\n        \n        # Calculate CHF using Tong's correlation in W/m^2.\n        q_chf_tong_w = K_Tong * common_term * (1.0 + a_Tong * x)\n        \n        # Convert the CHF values from W/m^2 to MW/m^2.\n        q_chf_w3_mw = q_chf_w3_w / 1e6\n        q_chf_tong_mw = q_chf_tong_w / 1e6\n        \n        # Calculate the relative difference between the two correlations.\n        # Using the base W/m^2 values for calculation to maintain precision\n        # before the final rounding.\n        rel_diff = (q_chf_tong_w - q_chf_w3_w) / q_chf_w3_w\n        \n        # Round the final values to the specified number of decimal places.\n        q_chf_w3_rounded = round(q_chf_w3_mw, 3)\n        q_chf_tong_rounded = round(q_chf_tong_mw, 3)\n        rel_diff_rounded = round(rel_diff, 4)\n        \n        # Append the list of results for the current case.\n        results.append([q_chf_w3_rounded, q_chf_tong_rounded, rel_diff_rounded])\n\n    # Final print statement in the exact required format.\n    # Convert the list of lists to a string and remove spaces to match the output format.\n    final_output_str = str(results).replace(' ', '')\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from a single point to a full channel, we see that local conditions are not static but evolve as the coolant absorbs heat. This practice links the fundamental principle of energy conservation with the progression of boiling regimes along a heated channel . You will first derive the axial location for the Onset of Nucleate Boiling (ONB) from first principles and then use a provided $CHF$ value to calculate the DNB margin at the channel exit, offering a more complete view of thermal-hydraulic safety within a single fuel assembly.",
            "id": "4220457",
            "problem": "A uniformly heated, vertically oriented circular flow channel representative of a pressurized water reactor (PWR) subchannel is modeled as a single heated tube of hydraulic diameter $D_{h}$ carrying liquid water at high pressure. The mass flux is $G$, the inlet bulk temperature is $T_{in}$, and the imposed heat flux is spatially uniform and equal to $q''$ over a heated length $L$. The system pressure is $P$, for which the saturation temperature is $T_{sat}(P)$ and the latent heat of vaporization is $h_{fg}(P)$. Assume constant properties evaluated at the inlet bulk state: specific heat $c_{p}$, thermal conductivity $k$, and dynamic viscosity $\\mu$. Neglect axial conduction and buoyancy effects on the single-phase forced convection region.\n\nStarting from first principles of axial energy balance and the definition of equilibrium quality, determine the axial location $z_{ONB}$ where the Onset of Nucleate Boiling (ONB) occurs using the Saha–Zuber criterion expressed as a threshold equilibrium quality $x_{ONB}$ appropriate for fully developed turbulent subcooled flow in smooth circular channels. Then, estimate the margin to Departure from Nucleate Boiling (DNB) at the channel exit by choosing a widely used DNB correlation and evaluating the critical heat flux under the computed exit conditions.\n\nUse the following physically consistent data for high-pressure water:\n- Hydraulic diameter: $D_{h} = 8.0 \\times 10^{-3}\\ \\mathrm{m}$.\n- Heated length: $L = 3.5\\ \\mathrm{m}$.\n- Mass flux: $G = 3.0 \\times 10^{3}\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$.\n- Imposed heat flux (uniform): $q'' = 1.20 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$.\n- Inlet bulk temperature: $T_{in} = 300\\ ^\\circ\\mathrm{C}$.\n- System pressure: $P = 15\\ \\mathrm{MPa}$, with saturation temperature $T_{sat}(P) = 342\\ ^\\circ\\mathrm{C}$ and latent heat $h_{fg}(P) = 1.40 \\times 10^{6}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$.\n- Thermophysical properties at the inlet bulk state: $c_{p} = 5.00 \\times 10^{3}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$, $k = 0.60\\ \\mathrm{W}\\ \\mathrm{m}^{-1}\\ \\mathrm{K}^{-1}$, $\\mu = 1.00 \\times 10^{-4}\\ \\mathrm{Pa}\\ \\mathrm{s}$.\n\nFor the Saha–Zuber ONB criterion, use the well-tested representation in terms of an equilibrium-quality threshold at ONB suitable for fully developed turbulent water flow at high pressure and large Reynolds number in smooth circular channels:\n- $x_{ONB} = -0.11$.\n\nDefine the equilibrium quality $x_{eq}(z)$ from the axial energy balance and the thermodynamic properties. ONB is the axial location $z_{ONB}$ where $x_{eq}(z_{ONB}) = x_{ONB}$.\n\nTo estimate the DNB margin at the exit, adopt a widely used critical heat flux correlation represented by the Groeneveld Look-Up Table (LUT) methodology for uniformly heated tubes. For the computed exit condition at the given $P$, $G$, $D_{h}$, and exit equilibrium quality $x_{eq}(L)$, assume the LUT evaluation returns:\n- $q''_{CHF}(L) = 1.80 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$.\n\nDefine the DNB margin at the exit as the dimensionless ratio $\\mathcal{M} \\equiv q''_{CHF}(L) / q''$.\n\nTasks:\n1. Derive $x_{eq}(z)$ from first principles and obtain a closed-form expression for $z_{ONB}$ in terms of the given quantities and $x_{ONB}$.\n2. Evaluate $z_{ONB}$ numerically using the provided data.\n3. Compute $x_{eq}(L)$ and then evaluate the DNB margin $\\mathcal{M}$ using the provided $q''_{CHF}(L)$.\n\nExpress $z_{ONB}$ in meters and $\\mathcal{M}$ as a pure number (dimensionless decimal). Round both to four significant figures.",
            "solution": "The analysis proceeds by addressing the three specified tasks in order: deriving the axial location of the Onset of Nucleate Boiling ($z_{ONB}$), evaluating its numerical value, and finally computing the Departure from Nucleate Boiling (DNB) margin ($\\mathcal{M}$) at the channel exit.\n\n### Step 1: Derivation of Equilibrium Quality and $z_{ONB}$\n\nThe foundation of this analysis is the steady-state energy balance on the fluid flowing through the heated channel. For a control volume from the inlet ($z=0$) to an arbitrary axial location $z$, the balance is:\n$$ \\dot{m} h(z) = \\dot{m} h_{in} + q'' P_h z $$\nwhere $\\dot{m}$ is the mass flow rate, $h(z)$ is the bulk fluid enthalpy at $z$, $h_{in}$ is the inlet enthalpy, $q''$ is the uniform heat flux, and $P_h$ is the heated perimeter.\n\nThe mass flow rate is related to the mass flux $G$ and flow area $A_c$ by $\\dot{m} = G A_c$. The hydraulic diameter $D_h$ is defined as $D_h = \\frac{4 A_c}{P_h}$, which gives $P_h = \\frac{4 A_c}{D_h}$. Substituting these into the energy balance:\n$$ (G A_c) h(z) = (G A_c) h_{in} + q'' \\left(\\frac{4 A_c}{D_h}\\right) z $$\nDividing by the non-zero quantity $G A_c$ yields the axial enthalpy profile:\n$$ h(z) = h_{in} + \\frac{4 q'' z}{G D_h} $$\nThe equilibrium quality, $x_{eq}(z)$, is defined by the relation:\n$$ x_{eq}(z) \\equiv \\frac{h(z) - h_f}{h_{fg}} $$\nwhere $h_f$ is the saturated liquid enthalpy and $h_{fg}$ is the latent heat of vaporization, both at the system pressure $P$.\n\nThe inlet enthalpy $h_{in}$ corresponds to the liquid at temperature $T_{in}$ and pressure $P$. Approximating the liquid as incompressible, its enthalpy can be expressed relative to the saturation condition: $h_{in} \\approx h_f - c_p (T_{sat} - T_{in})$, where $c_p$ is the specific heat and $T_{sat}$ is the saturation temperature.\n\nSubstituting the expressions for $h(z)$ and $h_{in}$ into the definition of $x_{eq}(z)$:\n$$ x_{eq}(z) = \\frac{1}{h_{fg}} \\left( \\left(h_f - c_p(T_{sat} - T_{in})\\right) + \\frac{4 q'' z}{G D_h} - h_f \\right) $$\nThis simplifies to the axial profile of the equilibrium quality:\n$$ x_{eq}(z) = -\\frac{c_p(T_{sat} - T_{in})}{h_{fg}} + \\frac{4 q'' z}{G D_h h_{fg}} $$\nThe Onset of Nucleate Boiling (ONB) is stated to occur at the location $z_{ONB}$ where the equilibrium quality reaches the threshold value $x_{ONB}$.\n$$ x_{ONB} = -\\frac{c_p(T_{sat} - T_{in})}{h_{fg}} + \\frac{4 q'' z_{ONB}}{G D_h h_{fg}} $$\nSolving for $z_{ONB}$:\n$$ x_{ONB} h_{fg} = -c_p(T_{sat} - T_{in}) + \\frac{4 q'' z_{ONB}}{G D_h} $$\n$$ \\frac{4 q'' z_{ONB}}{G D_h} = x_{ONB} h_{fg} + c_p(T_{sat} - T_{in}) $$\nThe closed-form expression for the location of ONB is therefore:\n$$ z_{ONB} = \\frac{G D_h}{4 q''} \\left( x_{ONB} h_{fg} + c_p(T_{sat} - T_{in}) \\right) $$\n\n### Step 2: Numerical Evaluation of $z_{ONB}$\n\nThe next step is to substitute the provided numerical values into the derived expression for $z_{ONB}$.\nThe given data are:\n$G = 3.0 \\times 10^{3}\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$, $D_{h} = 8.0 \\times 10^{-3}\\ \\mathrm{m}$, $q'' = 1.20 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$, $x_{ONB} = -0.11$, $h_{fg} = 1.40 \\times 10^{6}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$, $c_{p} = 5.00 \\times 10^{3}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$, $T_{sat} = 342\\ ^\\circ\\mathrm{C}$, and $T_{in} = 300\\ ^\\circ\\mathrm{C}$.\nThe temperature difference is $T_{sat} - T_{in} = 342 - 300 = 42\\ \\mathrm{K}$.\n\nFirst, we calculate the term in the parenthesis, which represents an enthalpy difference:\n$$ x_{ONB} h_{fg} + c_p(T_{sat} - T_{in}) = (-0.11) \\times (1.40 \\times 10^{6}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}) + (5.00 \\times 10^{3}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}) \\times (42\\ \\mathrm{K}) $$\n$$ = -1.54 \\times 10^{5}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1} + 2.10 \\times 10^{5}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1} = 5.6 \\times 10^{4}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1} $$\nNext, we calculate the pre-factor:\n$$ \\frac{G D_h}{4 q''} = \\frac{(3.0 \\times 10^{3}\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}) \\times (8.0 \\times 10^{-3}\\ \\mathrm{m})}{4 \\times (1.20 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2})} = \\frac{24.0}{4.80 \\times 10^{6}}\\ \\mathrm{kg}\\ \\mathrm{m}\\ \\mathrm{J}^{-1} = 5.0 \\times 10^{-6}\\ \\mathrm{kg}\\ \\mathrm{m}\\ \\mathrm{J}^{-1} $$\nFinally, we compute $z_{ONB}$:\n$$ z_{ONB} = (5.0 \\times 10^{-6}\\ \\mathrm{kg}\\ \\mathrm{m}\\ \\mathrm{J}^{-1}) \\times (5.6 \\times 10^{4}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}) = 0.28\\ \\mathrm{m} $$\nAs per the requirement to round to four significant figures, $z_{ONB} = 0.2800\\ \\mathrm{m}$.\n\n### Step 3: Evaluation of DNB Margin $\\mathcal{M}$\n\nTo find the DNB margin at the channel exit, we first need the equilibrium quality at $z = L = 3.5\\ \\mathrm{m}$. Using the previously derived formula for $x_{eq}(z)$:\n$$ x_{eq}(L) = -\\frac{c_p(T_{sat} - T_{in})}{h_{fg}} + \\frac{4 q'' L}{G D_h h_{fg}} $$\nThe first term is the inlet equilibrium quality, $x_{eq, in}$:\n$$ x_{eq, in} = -\\frac{(5.00 \\times 10^{3}) \\times 42}{1.40 \\times 10^{6}} = -\\frac{2.10 \\times 10^{5}}{1.40 \\times 10^{6}} = -0.15 $$\nThe second term represents the change in quality along the channel length $L$:\n$$ \\Delta x_{eq}(L) = \\frac{4 \\times (1.20 \\times 10^{6}) \\times 3.5}{(3.0 \\times 10^{3}) \\times (8.0 \\times 10^{-3}) \\times (1.40 \\times 10^{6})} = \\frac{1.68 \\times 10^{7}}{3.36 \\times 10^{7}} = 0.50 $$\nThe exit equilibrium quality is a sum of these two terms:\n$$ x_{eq}(L) = x_{eq, in} + \\Delta x_{eq}(L) = -0.15 + 0.50 = 0.35 $$\nThe DNB margin $\\mathcal{M}$ is defined as the ratio of the critical heat flux at the exit, $q''_{CHF}(L)$, to the applied heat flux, $q''$:\n$$ \\mathcal{M} = \\frac{q''_{CHF}(L)}{q''} $$\nUsing the provided values $q''_{CHF}(L) = 1.80 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$ and $q'' = 1.20 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$:\n$$ \\mathcal{M} = \\frac{1.80 \\times 10^{6}}{1.20 \\times 10^{6}} = 1.5 $$\nRounding to four significant figures, the DNB margin is $\\mathcal{M} = 1.500$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.2800  1.500 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Real-world reactor cores feature non-uniform power distributions, meaning the DNB margin varies significantly along the fuel rod. This advanced practice integrates the previous concepts into a realistic simulation where you must find the precise axial location of DNB in a channel with a skewed power profile . This involves numerically computing the local heat flux, $q''(z)$, and the local $CHF$ limit along the entire channel to identify the critical point where they first meet, a core task performed by sophisticated subchannel analysis codes.",
            "id": "4220510",
            "problem": "You are to implement a one-dimensional axial model of a heated subchannel in a pressurized water reactor to predict the axial location of the first occurrence of Departure from Nucleate Boiling (DNB) using a specified, physically grounded Critical Heat Flux (CHF) correlation, and to quantify the sensitivity of that predicted location to the amplitude of an imposed axial heat flux peak. The objective is to derive from conservation of energy and an empirically justified CHF correlation a computational procedure that, given a skewed axial heat flux profile with a hot spot centered at $z = 0.6L$, finds the smallest axial coordinate $z_{\\mathrm{DNB}}$ where the local wall heat flux $q''(z)$ equals the local CHF and to compute the sensitivity $\\partial z_{\\mathrm{DNB}}/\\partial a$ at a given peaking amplitude $a$.\n\nStart from the conservation of energy applied to steady, one-dimensional flow of liquid water in a heated channel of flow area $A_{\\mathrm{flow}}$ and heated perimeter $P_{\\mathrm{h}}$, with mass flux $G$, absolute pressure $P$, heated length $L$, inlet bulk temperature $T_{\\mathrm{in}}$, saturation temperature at pressure $P$ denoted $T_{\\mathrm{sat}}(P)$, constant specific heat at constant pressure $c_p$, and latent heat of vaporization $h_{\\mathrm{fg}}(P)$. Assume thermophysical properties $c_p$ and $h_{\\mathrm{fg}}$ are constants specified below. Define the equilibrium quality $x_e(z)$ by an energy balance as\n$$\nx_e(z) = -\\frac{c_p\\left(T_{\\mathrm{sat}}(P) - T_{\\mathrm{in}}\\right)}{h_{\\mathrm{fg}}} + \\frac{P_{\\mathrm{h}}}{G\\,A_{\\mathrm{flow}}\\,h_{\\mathrm{fg}}} \\int_0^z q''(\\zeta)\\,\\mathrm{d}\\zeta.\n$$\nAssume forced convection boiling and use the following CHF correlation, which reflects a well-tested empirical dependence on mass flux, hydraulic diameter, pressure, and equilibrium quality:\n$$\n\\mathrm{CHF}(z) = C_0\\, G^{m}\\, D_{\\mathrm{h}}^{n}\\, \\left(\\frac{P}{P_0}\\right)^{p} \\, \\max\\left( \\varepsilon,\\, 1 - K_x\\, x_e(z) \\right),\n$$\nwhere $C_0$, $m$, $n$, $p$, $P_0$, $K_x$, and $\\varepsilon$ are positive constants specified below, $D_{\\mathrm{h}}$ is the hydraulic diameter, and $\\max(\\cdot,\\cdot)$ enforces a lower bound to ensure physical positivity. The local wall heat flux $q''(z)$ is prescribed by a baseline value $q_0$ modulated by a skewed axial shape function $f(z)$ with a single peak at $z_0 = 0.6\\,L$:\n$$\nq''(z) = q_0 \\left[ 1 + a\\, f(z) \\right], \\quad f(z) = \\frac{\\left( \\frac{z}{L} \\right)^{\\alpha} \\left( 1 - \\frac{z}{L} \\right)^{\\beta}}{\\left( \\frac{\\alpha}{\\alpha + \\beta} \\right)^{\\alpha} \\left( \\frac{\\beta}{\\alpha + \\beta} \\right)^{\\beta}}, \\quad \\alpha = 3,\\ \\beta = 2.\n$$\nThe shape function $f(z)$ is a normalized Beta-profile with unit peak at $z_0 = \\frac{\\alpha}{\\alpha+\\beta} L = 0.6\\,L$ that produces a skewed axial profile with the hot spot at $z = 0.6 L$. The parameter $a$ is a dimensionless peaking amplitude.\n\nDefine the predicted DNB location $z_{\\mathrm{DNB}}$ as the smallest axial coordinate $z \\in [0, L]$ such that\n$$\nq''(z) \\ge \\mathrm{CHF}(z).\n$$\nIf no such $z$ exists on $[0, L]$, report $z_{\\mathrm{DNB}} = -1.0$. Quantify the sensitivity of the predicted DNB location to the peaking amplitude $a$ at a specified baseline $a$ using a finite-difference approximation to the derivative:\n$$\n\\left.\\frac{\\partial z_{\\mathrm{DNB}}}{\\partial a}\\right|_{a} \\approx \\frac{z_{\\mathrm{DNB}}(a+\\delta a) - z_{\\mathrm{DNB}}(a-\\delta a)}{2\\,\\delta a},\n$$\nwith a small perturbation $\\delta a$ fixed below. If $z_{\\mathrm{DNB}}$ is $-1.0$ for both perturbed amplitudes or for the baseline, report the sensitivity as $0.0$. If $z_{\\mathrm{DNB}}$ exists for only one perturbed amplitude, use a one-sided difference:\n$$\n\\left.\\frac{\\partial z_{\\mathrm{DNB}}}{\\partial a}\\right|_{a} \\approx \\frac{z_{\\mathrm{DNB}}(a+\\delta a) - z_{\\mathrm{DNB}}(a)}{\\delta a} \\quad \\text{or} \\quad \\frac{z_{\\mathrm{DNB}}(a) - z_{\\mathrm{DNB}}(a-\\delta a)}{\\delta a},\n$$\nchoosing the available side.\n\nConstants and units to be used are:\n- $c_p = 5.0 \\times 10^3\\ \\mathrm{J/(kg\\cdot K)}$,\n- $h_{\\mathrm{fg}} = 1.0 \\times 10^6\\ \\mathrm{J/kg}$,\n- $C_0 = 2.0 \\times 10^4\\ \\mathrm{(SI\\ units\\ consistent\\ with\\ CHF\\ in\\ W/m^2)}$,\n- $m = 0.6$,\n- $n = -0.2$,\n- $p = 0.08$,\n- $P_0 = 1.0 \\times 10^7\\ \\mathrm{Pa}$,\n- $K_x = 0.3$,\n- $\\varepsilon = 0.1$,\n- $\\delta a = 0.02$.\n\nAll inputs and outputs must use SI units. Specifically, lengths are in $\\mathrm{m}$, pressures in $\\mathrm{Pa}$, heat fluxes in $\\mathrm{W/m^2}$, mass fluxes in $\\mathrm{kg/(m^2\\cdot s)}$, temperatures in $\\mathrm{K}$, and the final sensitivity is in $\\mathrm{m}$ per unit amplitude $a$. Take the saturation temperature difference as a given inlet subcooling $\\Delta T_{\\mathrm{sub}} = T_{\\mathrm{sat}}(P) - T_{\\mathrm{in}}$ provided as a parameter in $\\mathrm{K}$, so that\n$$\nx_e(0) = -\\frac{c_p \\Delta T_{\\mathrm{sub}}}{h_{\\mathrm{fg}}}.\n$$\nImplement the cumulative integral in $x_e(z)$ using numerical quadrature over a uniform axial mesh to produce a numerically stable solution.\n\nTest Suite. Use the following five parameter sets as test cases, each provided as a tuple\n$$\n\\left( L,\\ D_{\\mathrm{h}},\\ A_{\\mathrm{flow}},\\ P_{\\mathrm{h}},\\ G,\\ P,\\ q_0,\\ a,\\ \\Delta T_{\\mathrm{sub}} \\right),\n$$\nto explore different regimes including typical behavior, no-DNB conditions, and near-inlet DNB:\n1. Case $1$: $\\left( 4.0,\\ 0.010,\\ 1.0\\times 10^{-4},\\ 0.030,\\ 3000,\\ 1.55\\times 10^{7},\\ 3.5\\times 10^{6},\\ 0.40,\\ 40 \\right)$.\n2. Case $2$: $\\left( 4.0,\\ 0.010,\\ 1.0\\times 10^{-4},\\ 0.030,\\ 5000,\\ 1.55\\times 10^{7},\\ 3.5\\times 10^{6},\\ 0.20,\\ 40 \\right)$.\n3. Case $3$: $\\left( 4.0,\\ 0.010,\\ 1.0\\times 10^{-4},\\ 0.030,\\ 3000,\\ 1.55\\times 10^{7},\\ 3.5\\times 10^{6},\\ 0.80,\\ 40 \\right)$.\n4. Case $4$: $\\left( 4.0,\\ 0.010,\\ 1.0\\times 10^{-4},\\ 0.030,\\ 2000,\\ 1.55\\times 10^{7},\\ 3.5\\times 10^{6},\\ 0.30,\\ 40 \\right)$.\n5. Case $5$: $\\left( 2.0,\\ 0.010,\\ 1.0\\times 10^{-4},\\ 0.030,\\ 3000,\\ 1.55\\times 10^{7},\\ 4.0\\times 10^{6},\\ 0.50,\\ 40 \\right)$.\n\nAlgorithmic requirements:\n- Discretize $z \\in [0, L]$ with a uniform mesh of at least $N = 2000$ points.\n- Compute $f(z)$, $q''(z)$, $x_e(z)$, and $\\mathrm{CHF}(z)$ over the mesh.\n- Find $z_{\\mathrm{DNB}}$ as the first $z$ where $q''(z) \\ge \\mathrm{CHF}(z)$; use linear interpolation between the two nearest mesh points to refine $z_{\\mathrm{DNB}}$.\n- Compute sensitivity at the baseline $a$ using $\\delta a$ as specified above.\n\nFinal Output Format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each result corresponding to a test case is itself a two-element list containing the predicted DNB location and its sensitivity with respect to $a$, both expressed in $\\mathrm{m}$:\n$$\n\\left[ [z_1, s_1], [z_2, s_2], [z_3, s_3], [z_4, s_4], [z_5, s_5] \\right].\n$$\nIf no DNB occurs for a case, output $-1.0$ for the location and $0.0$ for the sensitivity. All numerical outputs must be raw floating-point numbers without units in the printed line.",
            "solution": "The user has requested the development and implementation of a one-dimensional axial model to predict the location of the Departure from Nucleate Boiling (DNB) in a heated reactor subchannel and to quantify the sensitivity of this location to the axial heat flux peaking factor.\n\n### Step 1: Extract Givens\n\n**Governing Equations and Definitions:**\n1.  Equilibrium quality $x_e(z)$:\n    $$\n    x_e(z) = -\\frac{c_p\\left(T_{\\mathrm{sat}}(P) - T_{\\mathrm{in}}\\right)}{h_{\\mathrm{fg}}} + \\frac{P_{\\mathrm{h}}}{G\\,A_{\\mathrm{flow}}\\,h_{\\mathrm{fg}}} \\int_0^z q''(\\zeta)\\,\\mathrm{d}\\zeta\n    $$\n2.  Critical Heat Flux (CHF) correlation:\n    $$\n    \\mathrm{CHF}(z) = C_0\\, G^{m}\\, D_{\\mathrm{h}}^{n}\\, \\left(\\frac{P}{P_0}\\right)^{p} \\, \\max\\left( \\varepsilon,\\, 1 - K_x\\, x_e(z) \\right)\n    $$\n3.  Axial heat flux profile $q''(z)$:\n    $$\n    q''(z) = q_0 \\left[ 1 + a\\, f(z) \\right]\n    $$\n4.  Normalized axial shape function $f(z)$:\n    $$\n    f(z) = \\frac{\\left( \\frac{z}{L} \\right)^{\\alpha} \\left( 1 - \\frac{z}{L} \\right)^{\\beta}}{\\left( \\frac{\\alpha}{\\alpha + \\beta} \\right)^{\\alpha} \\left( \\frac{\\beta}{\\alpha + \\beta} \\right)^{\\beta}}, \\quad \\alpha = 3,\\ \\beta = 2\n    $$\n5.  DNB condition: Smallest axial coordinate $z \\in [0, L]$ such that $q''(z) \\ge \\mathrm{CHF}(z)$. If no such $z$ exists, $z_{\\mathrm{DNB}} = -1.0$.\n6.  Sensitivity of $z_{\\mathrm{DNB}}$ to $a$:\n    $$\n    \\left.\\frac{\\partial z_{\\mathrm{DNB}}}{\\partial a}\\right|_{a} \\approx \\frac{z_{\\mathrm{DNB}}(a+\\delta a) - z_{\\mathrm{DNB}}(a-\\delta a)}{2\\,\\delta a} \\quad \\text{(centered difference)}\n    $$\n    $$\n    \\left.\\frac{\\partial z_{\\mathrm{DNB}}}{\\partial a}\\right|_{a} \\approx \\frac{z_{\\mathrm{DNB}}(a+\\delta a) - z_{\\mathrm{DNB}}(a)}{\\delta a} \\quad \\text{or} \\quad \\frac{z_{\\mathrm{DNB}}(a) - z_{\\mathrm{DNB}}(a-\\delta a)}{\\delta a} \\quad \\text{(one-sided difference)}\n    $$\n7.  Inlet subcooling: The term $T_{\\mathrm{sat}}(P) - T_{\\mathrm{in}}$ is given as $\\Delta T_{\\mathrm{sub}}$.\n\n**Physical and Model Constants:**\n- $c_p = 5.0 \\times 10^3\\ \\mathrm{J/(kg\\cdot K)}$\n- $h_{\\mathrm{fg}} = 1.0 \\times 10^6\\ \\mathrm{J/kg}$\n- $C_0 = 2.0 \\times 10^4\\ \\mathrm{(SI\\ units)}$\n- $m = 0.6$\n- $n = -0.2$\n- $p = 0.08$\n- $P_0 = 1.0 \\times 10^7\\ \\mathrm{Pa}$\n- $K_x = 0.3$\n- $\\varepsilon = 0.1$\n- $\\delta a = 0.02$\n- $\\alpha = 3$\n- $\\beta = 2$\n\n**Algorithmic Requirements:**\n- Axial discretization: Uniform mesh with $N \\ge 2000$ points.\n- Numerical integration for $x_e(z)$.\n- Linear interpolation for refining $z_{\\mathrm{DNB}}$.\n- Specific logic for sensitivity calculation: Use centered difference if possible, fall back to one-sided if one perturbed case has no DNB, and report $0.0$ if the baseline case has no DNB or both perturbed cases have no DNB.\n\n**Test Cases (Parameters):**\nThe five test cases are given as tuples of $\\left( L,\\ D_{\\mathrm{h}},\\ A_{\\mathrm{flow}},\\ P_{\\mathrm{h}},\\ G,\\ P,\\ q_0,\\ a,\\ \\Delta T_{\\mathrm{sub}} \\right)$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is reviewed against the validation criteria.\n- **Scientifically Grounded:** The problem is based on fundamental principles of thermal-hydraulics, specifically the conservation of energy in single-phase and two-phase flow, and the concept of Critical Heat Flux (CHF) marking the onset of Departure from Nucleate Boiling (DNB). The CHF correlation provided is empirical, which is standard practice in the field, and its functional form (depending on mass flux, geometry, pressure, and quality) is physically plausible and consistent with well-known correlations (e.g., W-3). The axial heat flux profile is a smooth, single-peaked function representative of profiles in nuclear reactor cores. The problem is firmly grounded in established nuclear engineering science.\n- **Well-Posed:** The problem statement is well-posed for a numerical solution. It clearly defines all variables, equations, and constants. The objective is to find the smallest root of the equation $g(z) = \\mathrm{CHF}(z) - q''(z) = 0$. The provision of a numerical method (discretization, numerical integration, and interpolation) and clear rules for edge cases (no DNB, sensitivity calculation logic) ensures that a unique and stable solution can be computed.\n- **Objective:** The problem is stated in precise, objective, and quantitative language. There are no subjective elements or opinions.\n\nThe problem exhibits none of the invalidity flaws. It is scientifically sound, formalizable, complete, and computationally verifiable.\n\n### Step 3: Verdict and Action\n\nThe problem is deemed **valid**. A solution will be provided.\n\n### Principle-Based Design of the Solution\n\nThe solution proceeds by numerically modeling the thermal-hydraulic phenomena along the heated channel. The core principle is that as the coolant flows along the channel, its enthalpy increases due to the applied heat flux, which in turn reduces the local DNB margin. DNB occurs at the first axial location where the applied heat flux exceeds the local CHF limit.\n\nThe computational procedure is designed as follows:\n\n1.  **Axial Discretization:** The channel of length $L$ is discretized into a fine, uniform mesh of $N=2000$ points, $z_i$ for $i=0, 1, \\dots, N-1$. This spatial grid forms the basis for all subsequent calculations.\n\n2.  **Axial Heat Flux Profile Calculation:** For a given set of parameters including the peaking amplitude $a$, the axial heat flux $q''(z_i)$ is computed at each grid point. This involves first calculating the normalized Beta-profile shape function $f(z_i)$ and then applying the definition $q''(z_i) = q_0 [1 + a f(z_i)]$.\n\n3.  **Equilibrium Quality Profile Calculation:** The equilibrium quality $x_e(z_i)$ is determined by an energy balance.\n    -   The inlet quality at $z=0$ is calculated from the specified inlet subcooling: $x_e(0) = -c_p \\Delta T_{\\mathrm{sub}} / h_{\\mathrm{fg}}$.\n    -   The integral term $\\int_0^{z_i} q''(\\zeta) \\mathrm{d}\\zeta$ is computed numerically for each grid point $z_i$ using the cumulative trapezoidal rule on the previously calculated $q''(z_i)$ array. This provides the cumulative energy added to the fluid up to each point.\n    -   These components are combined according to the given equation for $x_e(z_i)$.\n\n4.  **Critical Heat Flux Profile Calculation:** With the local equilibrium quality $x_e(z_i)$ known, the local Critical Heat Flux $\\mathrm{CHF}(z_i)$ is calculated at each grid point using the provided empirical correlation. This involves computing a pre-factor that depends on system parameters ($G, D_h, P$) and a quality-dependent term.\n\n5.  **DNB Location Identification:** The DNB condition is $q''(z) \\ge \\mathrm{CHF}(z)$, which is equivalent to the DNB margin, defined as $M(z) = \\mathrm{CHF}(z) - q''(z)$, being less than or equal to zero.\n    -   The margin $M(z_i)$ is calculated at each grid point.\n    -   The algorithm searches for the first grid index $i$ (starting from the inlet) where $M(z_i) \\le 0$.\n    -   If no such index is found, it is concluded that DNB does not occur, and $z_{\\mathrm{DNB}} = -1.0$.\n    -   If an index $i_{\\mathrm{DNB}}$ is found, the DNB location is between $z_{i_{\\mathrm{DNB}}-1}$ and $z_{i_{\\mathrm{DNB}}}$. The precise location, $z_{\\mathrm{DNB}}$, is found by performing linear interpolation on the margin function $M(z)$ to find the root where $M(z_{\\mathrm{DNB}})=0$.\n\n6.  **Sensitivity Analysis:** To compute the sensitivity $\\partial z_{\\mathrm{DNB}}/\\partial a$, the entire procedure for finding $z_{\\mathrm{DNB}}$ is encapsulated in a function that accepts the peaking amplitude $a$ as an argument.\n    -   This function is called for the baseline amplitude $a$, and for two perturbed amplitudes, $a+\\delta a$ and $a-\\delta a$.\n    -   Based on whether DNB occurs in these three cases, the sensitivity is calculated using the appropriate finite difference formula (centered, forward one-sided, or backward one-sided) as specified in the problem statement. If the baseline case has no DNB, or if both perturbed cases have no DNB, the sensitivity is reported as $0.0$.\n\nThis step-by-step process is implemented for each of the five test cases provided. The final results, each comprising the pair $[z_{\\mathrm{DNB}}, \\text{sensitivity}]$, are collected and formatted into the required output string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Main function to solve the DNB prediction problem for all test cases.\n    \"\"\"\n    # Define problem constants as specified in the problem statement\n    C_P = 5.0e3  # Specific heat capacity in J/(kg.K)\n    H_FG = 1.0e6  # Latent heat of vaporization in J/kg\n    C0 = 2.0e4  # CHF correlation constant in SI units\n    M = 0.6  # Mass flux exponent\n    N_EXP = -0.2  # Hydraulic diameter exponent\n    P_EXP = 0.08  # Pressure exponent\n    P0 = 1.0e7  # Reference pressure in Pa\n    KX = 0.3  # Equilibrium quality coefficient\n    EPSILON = 0.1  # Minimum value for the quality-dependent part of CHF\n    DELTA_A = 0.02  # Perturbation for sensitivity calculation\n    ALPHA = 3.0  # Shape function exponent\n    BETA = 2.0  # Shape function exponent\n    NUM_POINTS = 2000  # Number of points for axial discretization\n\n    # Pre-calculate the normalization factor for the axial shape function f(z)\n    norm_factor = (ALPHA / (ALPHA + BETA))**ALPHA * (BETA / (ALPHA + BETA))**BETA\n\n    def find_z_dnb(params, a_val):\n        \"\"\"\n        Calculates the axial location of DNB for a given set of parameters and a specific\n        peaking amplitude 'a_val'.\n        Returns the DNB location in meters, or -1.0 if no DNB occurs.\n        \"\"\"\n        L, D_h, A_flow, P_h, G, P, q0, _, delta_T_sub = params\n        a = a_val\n\n        # 1. Create the uniform axial mesh\n        z = np.linspace(0, L, NUM_POINTS)\n\n        # 2. Calculate the axial heat flux profile q''(z)\n        z_norm = z / L\n        # Use errstate to prevent warnings for 0^x at endpoints, though not needed for alpha, beta  1\n        with np.errstate(divide='ignore', invalid='ignore'):\n            f_z = (z_norm**ALPHA * (1 - z_norm)**BETA) / norm_factor\n        f_z = np.nan_to_num(f_z)  # Clean up potential NaN results (e.g., 0/0) at endpoints\n        \n        q_double_prime = q0 * (1.0 + a * f_z)\n\n        # 3. Calculate the equilibrium quality profile x_e(z)\n        xe_in = -C_P * delta_T_sub / H_FG\n        integral_q = cumulative_trapezoid(q_double_prime, z, initial=0)\n        xe = xe_in + (P_h / (G * A_flow * H_FG)) * integral_q\n\n        # 4. Calculate the Critical Heat Flux (CHF) profile CHF(z)\n        chf_prefactor = C0 * G**M * D_h**N_EXP * (P / P0)**P_EXP\n        chf = chf_prefactor * np.maximum(EPSILON, 1.0 - KX * xe)\n\n        # 5. Find the first location where DNB occurs (q'' = CHF)\n        margin = chf - q_double_prime\n        dnb_indices = np.where(margin = 0.0)[0]\n\n        if dnb_indices.size == 0:\n            return -1.0  # No DNB occurs in the channel\n\n        idx_dnb = dnb_indices[0]\n        \n        if idx_dnb == 0:\n            # DNB occurs at the inlet (z=0)\n            return 0.0\n\n        # 6. Use linear interpolation to find a more precise z_DNB\n        # The DNB condition is met between grid points idx_dnb-1 and idx_dnb\n        z1, g1 = z[idx_dnb - 1], margin[idx_dnb - 1]\n        z2, g2 = z[idx_dnb], margin[idx_dnb]\n\n        # Find the root of the line connecting (z1, g1) and (z2, g2)\n        # z_dnb = z1 + g1 * (z2 - z1) / (g1 - g2)\n        z_dnb = z1 - g1 * (z2 - z1) / (g2 - g1)\n        \n        return z_dnb\n\n    def compute_dnb_and_sensitivity(case):\n        \"\"\"\n        Computes the baseline z_DNB and its sensitivity to the peaking amplitude 'a'\n        for a given test case.\n        \"\"\"\n        _, _, _, _, _, _, _, a_base, _ = case\n\n        z_base = find_z_dnb(case, a_base)\n\n        # Apply the specified logic for sensitivity calculation\n        if z_base == -1.0:\n            sensitivity = 0.0\n        else:\n            z_plus = find_z_dnb(case, a_base + DELTA_A)\n            z_minus = find_z_dnb(case, a_base - DELTA_A)\n\n            if z_plus != -1.0 and z_minus != -1.0:\n                # Use centered difference if both perturbed points exist\n                sensitivity = (z_plus - z_minus) / (2.0 * DELTA_A)\n            elif z_plus != -1.0 and z_minus == -1.0:\n                # Use one-sided forward difference\n                sensitivity = (z_plus - z_base) / DELTA_A\n            elif z_plus == -1.0 and z_minus != -1.0:\n                # Use one-sided backward difference\n                sensitivity = (z_base - z_minus) / DELTA_A\n            else:  # Both perturbed cases result in no DNB\n                sensitivity = 0.0\n        \n        return [z_base, sensitivity]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, Dh, A_flow, P_h, G, P, q0, a, T_sub) in SI units\n        (4.0, 0.010, 1.0e-4, 0.030, 3000, 1.55e7, 3.5e6, 0.40, 40),\n        (4.0, 0.010, 1.0e-4, 0.030, 5000, 1.55e7, 3.5e6, 0.20, 40),\n        (4.0, 0.010, 1.0e-4, 0.030, 3000, 1.55e7, 3.5e6, 0.80, 40),\n        (4.0, 0.010, 1.0e-4, 0.030, 2000, 1.55e7, 3.5e6, 0.30, 40),\n        (2.0, 0.010, 1.0e-4, 0.030, 3000, 1.55e7, 4.0e6, 0.50, 40),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_dnb_and_sensitivity(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    result_str = '[' + ','.join([f'[{r[0]},{r[1]}]' for r in results]) + ']'\n    print(result_str)\n\nsolve()\n```"
        }
    ]
}