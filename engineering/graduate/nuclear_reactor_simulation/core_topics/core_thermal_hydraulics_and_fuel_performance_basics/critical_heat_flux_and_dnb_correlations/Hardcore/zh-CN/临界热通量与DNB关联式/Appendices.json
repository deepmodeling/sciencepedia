{
    "hands_on_practices": [
        {
            "introduction": "本章的动手实践部分旨在将理论知识应用于实际的工程计算中。我们首先从一个基础问题开始，该问题将能量守恒第一性原理与反应堆热工水力学中的关键现象联系起来。通过这个练习，您将亲手推导并计算沿加热通道的冷却剂焓升、确定泡核沸腾起始点（ONB）的位置，并量化临界热通量（CHF）安全裕度，从而为更复杂的安全分析奠定坚实的基础。",
            "id": "4220457",
            "problem": "一个代表压水堆 (PWR) 子通道的均匀加热、竖直圆形流动通道，被建模为一根水力直径为 $D_{h}$ 的单根加热管，管内在高压下输送液态水。质量通量为 $G$，入口主流温度为 $T_{in}$，在长度为 $L$ 的加热段上施加的热通量在空间上是均匀的，其值为 $q''$。系统压力为 $P$，对应的饱和温度为 $T_{sat}(P)$，汽化潜热为 $h_{fg}(P)$。假设在入口主流状态下物性恒定：比热 $c_{p}$，导热系数 $k$ 和动力粘度 $\\mu$。忽略单相强迫对流区的轴向导热和浮力效应。\n\n从轴向能量平衡的基本原理和平衡干度的定义出发，使用 Saha–Zuber 判据确定核态沸腾起始 (ONB) 发生的轴向位置 $z_{ONB}$，该判据表示为适用于光滑圆形通道内充分发展的湍流过冷流动的阈值平衡干度 $x_{ONB}$。然后，通过选择一个广泛使用的 DNB 关系式，并在计算出的出口工况下评估临界热通量，来估算通道出口处的偏离核态沸腾 (DNB) 裕度。\n\n使用以下物理上一致的高压水数据：\n- 水力直径：$D_{h} = 8.0 \\times 10^{-3}\\ \\mathrm{m}$。\n- 加热长度：$L = 3.5\\ \\mathrm{m}$。\n- 质量通量：$G = 3.0 \\times 10^{3}\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$。\n- 施加的热通量（均匀）：$q'' = 1.20 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$。\n- 入口主流温度：$T_{in} = 300\\,^{\\circ}\\mathrm{C}$。\n- 系统压力：$P = 15\\ \\mathrm{MPa}$，饱和温度 $T_{sat}(P) = 342\\,^{\\circ}\\mathrm{C}$，汽化潜热 $h_{fg}(P) = 1.40 \\times 10^{6}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$。\n- 入口主流状态下的热物理性质：$c_{p} = 5.00 \\times 10^{3}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$，$k = 0.60\\ \\mathrm{W}\\ \\mathrm{m}^{-1}\\ \\mathrm{K}^{-1}$，$\\mu = 1.00 \\times 10^{-4}\\ \\mathrm{Pa}\\ \\mathrm{s}$。\n\n对于 Saha–Zuber ONB 判据，使用经过充分检验的、适用于高压、大雷诺数下光滑圆形通道内充分发展湍流的、以 ONB 处的平衡干度阈值表示的表达式：\n- $x_{ONB} = -0.11$。\n\n从轴向能量平衡和热力学性质定义平衡干度 $x_{eq}(z)$。ONB 是满足 $x_{eq}(z_{ONB}) = x_{ONB}$ 的轴向位置 $z_{ONB}$。\n\n为了估算出水口的 DNB 裕度，采用一种广泛使用的临界热通量关系式，即适用于均匀加热管的 Groeneveld 查表法 (LUT)。对于给定的 $P$、$G$、$D_{h}$ 和出口平衡干度 $x_{eq}(L)$ 的计算出口工况，假设 LUT 评估返回：\n- $q''_{CHF}(L) = 1.80 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$。\n\n将出口处的 DNB 裕度定义为无量纲比值 $\\mathcal{M} \\equiv q''_{CHF}(L) / q''$。\n\n任务：\n1. 从基本原理推导 $x_{eq}(z)$，并得到 $z_{ONB}$ 关于给定物理量和 $x_{ONB}$ 的闭式表达式。\n2. 使用所提供的数据对 $z_{ONB}$ 进行数值计算。\n3. 计算 $x_{eq}(L)$，然后使用所提供的 $q''_{CHF}(L)$ 评估 DNB 裕度 $\\mathcal{M}$。\n\n将 $z_{ONB}$ 以米为单位表示，将 $\\mathcal{M}$ 表示为纯数（无量纲小数）。两者均四舍五入至四位有效数字。",
            "solution": "分析按顺序处理三个指定的任务：推导核态沸腾起始 ($z_{ONB}$) 的轴向位置，计算其数值，最后计算通道出口处的偏离核态沸腾 (DNB) 裕度 ($\\mathcal{M}$)。\n\n### 步骤1：平衡干度和 $z_{ONB}$ 的推导\n\n此分析的基础是对流经加热通道的流体进行稳态能量平衡。对于从入口 ($z=0$) 到任意轴向位置 $z$ 的控制体，能量平衡为：\n$$ \\dot{m} h(z) = \\dot{m} h_{in} + q'' P_h z $$\n其中 $\\dot{m}$ 是质量流量，$h(z)$ 是在 $z$ 处的主流流体焓，$h_{in}$ 是入口焓，$q''$ 是均匀热通量，$P_h$ 是加热周长。\n\n质量流量通过 $\\dot{m} = G A_c$ 与质量通量 $G$ 和流通面积 $A_c$ 相关。水力直径 $D_h$ 定义为 $D_h = \\frac{4 A_c}{P_h}$，这给出 $P_h = \\frac{4 A_c}{D_h}$。将这些代入能量平衡方程：\n$$ (G A_c) h(z) = (G A_c) h_{in} + q'' \\left(\\frac{4 A_c}{D_h}\\right) z $$\n除以非零量 $G A_c$ 得到轴向焓分布：\n$$ h(z) = h_{in} + \\frac{4 q'' z}{G D_h} $$\n平衡干度 $x_{eq}(z)$ 由以下关系定义：\n$$ x_{eq}(z) \\equiv \\frac{h(z) - h_f}{h_{fg}} $$\n其中 $h_f$ 是饱和液相焓，$h_{fg}$ 是汽化潜热，两者均在系统压力 $P$ 下。\n\n入口焓 $h_{in}$ 对应于温度为 $T_{in}$ 和压力为 $P$ 的液体。将液体近似为不可压缩的，其焓可以相对于饱和条件表示为：$h_{in} \\approx h_f - c_p (T_{sat} - T_{in})$，其中 $c_p$ 是比热，$T_{sat}$ 是饱和温度。\n\n将 $h(z)$ 和 $h_{in}$ 的表达式代入 $x_{eq}(z)$ 的定义中：\n$$ x_{eq}(z) = \\frac{1}{h_{fg}} \\left( \\left(h_f - c_p(T_{sat} - T_{in})\\right) + \\frac{4 q'' z}{G D_h} - h_f \\right) $$\n这简化为平衡干度的轴向分布：\n$$ x_{eq}(z) = -\\frac{c_p(T_{sat} - T_{in})}{h_{fg}} + \\frac{4 q'' z}{G D_h h_{fg}} $$\n核态沸腾起始 (ONB) 据称发生在平衡干度达到阈值 $x_{ONB}$ 的位置 $z_{ONB}$。\n$$ x_{ONB} = -\\frac{c_p(T_{sat} - T_{in})}{h_{fg}} + \\frac{4 q'' z_{ONB}}{G D_h h_{fg}} $$\n解出 $z_{ONB}$：\n$$ x_{ONB} h_{fg} = -c_p(T_{sat} - T_{in}) + \\frac{4 q'' z_{ONB}}{G D_h} $$\n$$ \\frac{4 q'' z_{ONB}}{G D_h} = x_{ONB} h_{fg} + c_p(T_{sat} - T_{in}) $$\n因此，ONB 位置的闭式表达式为：\n$$ z_{ONB} = \\frac{G D_h}{4 q''} \\left( x_{ONB} h_{fg} + c_p(T_{sat} - T_{in}) \\right) $$\n\n### 步骤2：$z_{ONB}$ 的数值计算\n\n下一步是将提供的数值代入推导出的 $z_{ONB}$ 表达式中。\n给定的数据是：\n$G = 3.0 \\times 10^{3}\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$，$D_{h} = 8.0 \\times 10^{-3}\\ \\mathrm{m}$，$q'' = 1.20 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$，$x_{ONB} = -0.11$，$h_{fg} = 1.40 \\times 10^{6}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$，$c_{p} = 5.00 \\times 10^{3}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$，$T_{sat} = 342\\,^{\\circ}\\mathrm{C}$，以及 $T_{in} = 300\\,^{\\circ}\\mathrm{C}$。\n温差为 $T_{sat} - T_{in} = 342 - 300 = 42\\ \\mathrm{K}$。\n\n首先，我们计算括号中的项，它代表一个焓差：\n$$ x_{ONB} h_{fg} + c_p(T_{sat} - T_{in}) = (-0.11) \\times (1.40 \\times 10^{6}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}) + (5.00 \\times 10^{3}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}) \\times (42\\ \\mathrm{K}) $$\n$$ = -1.54 \\times 10^{5}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1} + 2.10 \\times 10^{5}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1} = 5.6 \\times 10^{4}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1} $$\n接下来，我们计算前置因子：\n$$ \\frac{G D_h}{4 q''} = \\frac{(3.0 \\times 10^{3}\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}) \\times (8.0 \\times 10^{-3}\\ \\mathrm{m})}{4 \\times (1.20 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2})} = \\frac{24.0}{4.80 \\times 10^{6}}\\ \\mathrm{kg}\\ \\mathrm{m}\\ \\mathrm{J}^{-1} = 5.0 \\times 10^{-6}\\ \\mathrm{kg}\\ \\mathrm{m}\\ \\mathrm{J}^{-1} $$\n最后，我们计算 $z_{ONB}$：\n$$ z_{ONB} = (5.0 \\times 10^{-6}\\ \\mathrm{kg}\\ \\mathrm{m}\\ \\mathrm{J}^{-1}) \\times (5.6 \\times 10^{4}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}) = 0.28\\ \\mathrm{m} $$\n根据四舍五入到四位有效数字的要求，$z_{ONB} = 0.2800\\ \\mathrm{m}$。\n\n### 步骤3：DNB 裕度 $\\mathcal{M}$ 的评估\n\n为了找到通道出口处的 DNB 裕度，我们首先需要 $z = L = 3.5\\ \\mathrm{m}$ 处的平衡干度。使用先前推导的 $x_{eq}(z)$ 公式：\n$$ x_{eq}(L) = -\\frac{c_p(T_{sat} - T_{in})}{h_{fg}} + \\frac{4 q'' L}{G D_h h_{fg}} $$\n第一项是入口平衡干度，$x_{eq, in}$：\n$$ x_{eq, in} = -\\frac{(5.00 \\times 10^{3}) \\times 42}{1.40 \\times 10^{6}} = -\\frac{2.10 \\times 10^{5}}{1.40 \\times 10^{6}} = -0.15 $$\n第二项表示沿通道长度 $L$ 的干度变化：\n$$ \\Delta x_{eq}(L) = \\frac{4 \\times (1.20 \\times 10^{6}) \\times 3.5}{(3.0 \\times 10^{3}) \\times (8.0 \\times 10^{-3}) \\times (1.40 \\times 10^{6})} = \\frac{1.68 \\times 10^{7}}{3.36 \\times 10^{7}} = 0.50 $$\n出口平衡干度是这两项的和：\n$$ x_{eq}(L) = x_{eq, in} + \\Delta x_{eq}(L) = -0.15 + 0.50 = 0.35 $$\nDNB 裕度 $\\mathcal{M}$ 定义为出口处的临界热通量 $q''_{CHF}(L)$ 与施加的热通量 $q''$ 之比：\n$$ \\mathcal{M} = \\frac{q''_{CHF}(L)}{q''} $$\n使用提供的值 $q''_{CHF}(L) = 1.80 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$ 和 $q'' = 1.20 \\times 10^{6}\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$：\n$$ \\mathcal{M} = \\frac{1.80 \\times 10^{6}}{1.20 \\times 10^{6}} = 1.5 $$\n四舍五入到四位有效数字，DNB 裕度为 $\\mathcal{M} = 1.500$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.2800  1.500 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在理解了偏离泡核沸腾（DNB）裕度的概念后，接下来的关键步骤是学习如何预测临界热通量（CHF）。本练习将指导您通过编程实现并比较两种在压水堆（PWR）热工设计中极具历史意义的经验关系式：W-3关系式和Tong氏关系式。这项实践不仅能锻炼您的计算能力，更重要的是，它将揭示CHF预测的经验主义本质以及不同模型在预测结果上存在的差异，这对于理解和正确应用这些工程工具至关重要。",
            "id": "4220471",
            "problem": "在压水反应堆工况下，使用两种广泛应用的偏离泡核沸腾 (DNB) 关系式——Westinghouse W-3 关系式和 Tong 关系式，实现局部临界热通量 (CHF) 的物理一致性计算。从与沸腾流中质量、动量和能量守恒定律一致的无量纲流体动力学标度出发，其中 CHF 取决于质量通量 $G$（单位：千克/平方米·秒）、压力 $p$（单位：兆帕）、水力直径 $D$（单位：米）和局部热力学干度 $x$（无量纲）。使用一种与棒束沸腾危机文献一致的、基于原则的回归幂律结构，其中 CHF 是 $G$、$D$、相对于临界压力的 $p$ 的函数，并弱依赖于 $x$。\n\n您的任务是使用以下模型形式和水常量来实现这两种关系式：\n- Westinghouse W-3 关系式：\n  $$q''_{\\mathrm{CHF,W3}} = K_{\\mathrm{W3}} \\, G^{m} \\left(\\frac{p}{p_c}\\right)^{n} D^{d} \\left(1 + a_{\\mathrm{W3}} x\\right),$$\n- Tong 关系式：\n  $$q''_{\\mathrm{CHF,Tong}} = K_{\\mathrm{Tong}} \\, G^{m} \\left(\\frac{p}{p_c}\\right)^{n} D^{d} \\left(1 + a_{\\mathrm{Tong}} x\\right),$$\n其中指数 $m$、$n$、$d$ 为固定值，常数选自棒束数据的稳健回归，适用于 $p \\in [5,21]$ 兆帕、$G \\in [500,6000]$ 千克/平方米·秒、$D \\in [0.008,0.020]$ 米以及 $x \\in [-0.6,0.3]$ 的范围。使用以下数值：\n- $p_c = 22.064$ 兆帕（水的临界压力），\n- $m = 0.5$, $n = 0.1$, $d = -0.2$,\n- $K_{\\mathrm{W3}} = 7.5 \\times 10^{4}$ 瓦特/平方米，\n- $K_{\\mathrm{Tong}} = 7.0 \\times 10^{4}$ 瓦特/平方米，\n- $a_{\\mathrm{W3}} = 0.15$, $a_{\\mathrm{Tong}} = 0.10$.\n\n针对以下测试用例组计算 $q''_{\\mathrm{CHF}}$，所有用例中 $p$ 的单位为兆帕，$G$ 的单位为千克/平方米·秒，$x$ 无量纲，$D$ 的单位为米：\n- 用例 1：$p = 16$, $G = 3500$, $x = -0.1$, $D = 0.0123$。\n- 用例 2：$p = 16$, $G = 1500$, $x = -0.5$, $D = 0.0123$。\n- 用例 3：$p = 7$, $G = 5000$, $x = 0.0$, $D = 0.0095$。\n- 用例 4：$p = 21$, $G = 3000$, $x = 0.2$, $D = 0.0170$。\n\n对每个用例，计算：\n- $q''_{\\mathrm{CHF,W3}}$，单位为兆瓦/平方米 (MW/m$^2$)，\n- $q''_{\\mathrm{CHF,Tong}}$，单位为兆瓦/平方米 (MW/m$^2$)，\n- 相对差异 $(q''_{\\mathrm{CHF,Tong}} - q''_{\\mathrm{CHF,W3}})/q''_{\\mathrm{CHF,W3}}$，以小数形式表示。\n\n将每个 CHF 值四舍五入到 3 位小数，每个相对差异四舍五入到 4 位小数。您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。其中每个元素对应一个用例，其本身是一个包含三个浮点数的列表：$[q''_{\\mathrm{CHF,W3}}, q''_{\\mathrm{CHF,Tong}}, \\text{相对差异}]$。例如，输出格式应如下所示：\n$[[q1\\_W3,q1\\_Tong,rdiff1],[q2\\_W3,q2\\_Tong,rdiff2],[q3\\_W3,q3\\_Tong,rdiff3],[q4\\_W3,q4\\_Tong,rdiff4]]$，\n其中 CHF 值的单位为兆瓦/平方米 (MW/m$^2$)，相对差异为无单位小数。\n\n将您的解决方案实现为一个完整的、可运行的程序，无需任何用户输入，并严格遵循指定的最终输出格式。",
            "solution": "问题陈述已经过验证并被认为是有效的。它在科学上基于热工水力学原理，提法得当，提供了所有必要的信息，并且表述客观。任务是使用两种成熟的经验关系式——Westinghouse W-3 和 Tong 关系式——为几个与压水反应堆 (PWR) 相关的运行工况计算临界热通量 (CHF)。\n\n计算方法基于以下原则设计：\n\n1.  **临界热通量 (CHF) 的物理基础：** CHF 是两相传热系统中的一个热极限，代表发生沸腾危机时的热通量。在压水反应堆的背景下，相关现象是偏离泡核沸腾 (DNB)，即在加热表面形成一层稳定的蒸汽膜，导致传热急剧恶化，并引起表面温度快速且可能具有破坏性的升高。由于其潜在物理机制的复杂性，CHF 通常使用从大量实验数据中得出的经验关系式来预测。这些关系式将 CHF 与关键运行参数联系起来。\n\n2.  **数学模型构建：** 问题提供了两种这样的关系式，它们遵循该领域常见的基于回归的幂律结构。这种结构与无量纲流体动力学标度原理一致。\n\n    Westinghouse W-3 关系式由下式给出：\n    $$q''_{\\mathrm{CHF,W3}} = K_{\\mathrm{W3}} \\, G^{m} \\left(\\frac{p}{p_c}\\right)^{n} D^{d} \\left(1 + a_{\\mathrm{W3}} x\\right)$$\n\n    Tong 关系式具有相似的形式：\n    $$q''_{\\mathrm{CHF,Tong}} = K_{\\mathrm{Tong}} \\, G^{m} \\left(\\frac{p}{p_c}\\right)^{n} D^{d} \\left(1 + a_{\\mathrm{Tong}} x\\right)$$\n\n    在这些方程中：\n    -   $q''_{\\mathrm{CHF}}$ 代表临界热通量，单位为瓦特/平方米 (W/m$^2$)。\n    -   项 $G^{m}$ (其中 $m = 0.5$) 捕捉了质量通量 $G$ 的影响。更高的质量通量会增强冷却剂混合，延迟稳定蒸汽膜的形成，从而增加 CHF。\n    -   项 $\\left(\\frac{p}{p_c}\\right)^{n}$ 考虑了系统压力 $p$ 相对于临界压力 $p_c$ 的影响。强烈影响沸腾的流体性质（如汽化潜热和表面张力）是压力的函数。这个无量纲群捕捉了它们的综合效应。\n    -   项 $D^{d}$ (其中 $d = -0.2$) 代表了水力直径 $D$ 的影响。对于较小的直径，CHF 往往更高。\n    -   项 $\\left(1 + a x\\right)$ 用于调整局部热力学干度 $x$。负干度对应于过冷液体，它可以在沸腾危机前吸收更多能量，从而增加 CHF。相反，正干度（净蒸汽生成）会减小 CHF 裕度。\n    -   $K$ 和 $a$ 是针对每个关系式的经验拟合常数。\n\n3.  **算法实现：** 通过将这些公式系统地应用于一组给定的测试用例来实现解决方案。\n\n    **第 1 步：定义常数**\n    首先定义所有物理和模型常数。这包括水的临界压力 $p_c = 22.064$ MPa，指数 $m = 0.5$, $n = 0.1$, $d = -0.2$，以及特定于关系式的系数 $K_{\\mathrm{W3}} = 7.5 \\times 10^4$ W/m$^2$, $a_{\\mathrm{W3}} = 0.15$, $K_{\\mathrm{Tong}} = 7.0 \\times 10^4$ W/m$^2$ 和 $a_{\\mathrm{Tong}} = 0.10$。\n\n    **第 2 步：处理测试用例**\n    算法遍历每个指定的测试用例，每个用例提供一组参数 $(p, G, x, D)$。对每个用例：\n\n    -   计算公共幂律项 $G^{m} \\left(\\frac{p}{p_c}\\right)^{n} D^{d}$。该项对两种关系式是相同的。\n    -   通过将公共项乘以 $K_{\\mathrm{W3}}$ 和 $(1 + a_{\\mathrm{W3}} x)$，计算 W-3 关系式的 CHF 值 $q''_{\\mathrm{CHF,W3}}$，单位为 W/m$^2$。\n    -   类似地，使用其各自的常数 $K_{\\mathrm{Tong}}$ 和 $a_{\\mathrm{Tong}}$，计算 Tong 关系式的 CHF 值 $q''_{\\mathrm{CHF,Tong}}$，单位为 W/m$^2$。\n\n    **第 3 步：单位转换与相对差异计算**\n    -   将计算出的 CHF 值（单位为 W/m$^2$）通过除以 $10^6$ 转换为兆瓦/平方米 (MW/m$^2$)。\n    -   使用公式 $\\frac{q''_{\\mathrm{CHF,Tong}} - q''_{\\mathrm{CHF,W3}}}{q''_{\\mathrm{CHF,W3}}}$ 计算相对差异。为了更稳定地计算，可以使用 $\\frac{q''_{\\mathrm{CHF,Tong}}}{q''_{\\mathrm{CHF,W3}}} - 1$，这可以简化为 $\\frac{K_{\\mathrm{Tong}}(1 + a_{\\mathrm{Tong}}x)}{K_{\\mathrm{W3}}(1 + a_{\\mathrm{W3}}x)} - 1$，从而最大限度地减少大数相减带来的浮点误差。\n\n    **第 4 步：四舍五入与聚合**\n    -   根据问题说明，将得到的 MW/m$^2$ 单位的 CHF 值四舍五入到 3 位小数，相对差异四舍五入到 4 位小数。\n    -   将三个四舍五入后的值 $[q''_{\\mathrm{CHF,W3}}, q''_{\\mathrm{CHF,Tong}}, \\text{相对差异}]$ 收集到当前测试用例的列表中。\n    -   然后将此列表追加到主结果列表中，该列表汇总了所有测试用例的结果。\n\n    **第 5 步：输出格式化**\n    -   最后，将聚合的列表的列表转换为严格匹配所需格式 `[[...],[...],...]` 的字符串表示。这通过将列表转换为字符串并删除所有空白字符来完成。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Critical Heat Flux (CHF) using W-3 and Tong correlations\n    for a given set of test cases and formats the output as specified.\n    \"\"\"\n    # Define physical and model constants as per the problem statement.\n    # Critical pressure of water in megapascals (MPa).\n    p_c = 22.064\n    \n    # Power-law exponents for the correlations.\n    m = 0.5  # Exponent for mass flux G\n    n = 0.1  # Exponent for pressure ratio p/p_c\n    d = -0.2 # Exponent for hydraulic diameter D\n    \n    # Westinghouse W-3 correlation constants.\n    K_W3 = 7.5e4  # Base coefficient in W/m^2\n    a_W3 = 0.15   # Coefficient for quality x\n    \n    # Tong's correlation constants.\n    K_Tong = 7.0e4 # Base coefficient in W/m^2\n    a_Tong = 0.10  # Coefficient for quality x\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (p [MPa], G [kg/m^2-s], x [dimensionless], D [m])\n    test_cases = [\n        (16.0, 3500.0, -0.1, 0.0123),\n        (16.0, 1500.0, -0.5, 0.0123),\n        (7.0, 5000.0, 0.0, 0.0095),\n        (21.0, 3000.0, 0.2, 0.0170),\n    ]\n\n    results = []\n    for p, G, x, D in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        \n        # Calculate the common power-law term shared by both correlations.\n        # This term captures the combined scaling effect of G, p, and D.\n        common_term = np.power(G, m) * np.power(p / p_c, n) * np.power(D, d)\n        \n        # Calculate CHF using the W-3 correlation in W/m^2.\n        q_chf_w3_w = K_W3 * common_term * (1.0 + a_W3 * x)\n        \n        # Calculate CHF using Tong's correlation in W/m^2.\n        q_chf_tong_w = K_Tong * common_term * (1.0 + a_Tong * x)\n        \n        # Convert the CHF values from W/m^2 to MW/m^2.\n        q_chf_w3_mw = q_chf_w3_w / 1e6\n        q_chf_tong_mw = q_chf_tong_w / 1e6\n        \n        # Calculate the relative difference between the two correlations.\n        # Using the base W/m^2 values for calculation to maintain precision\n        # before the final rounding.\n        rel_diff = (q_chf_tong_w - q_chf_w3_w) / q_chf_w3_w\n        \n        # Round the final values to the specified number of decimal places.\n        q_chf_w3_rounded = round(q_chf_w3_mw, 3)\n        q_chf_tong_rounded = round(q_chf_tong_mw, 3)\n        rel_diff_rounded = round(rel_diff, 4)\n        \n        # Append the list of results for the current case.\n        results.append([q_chf_w3_rounded, q_chf_tong_rounded, rel_diff_rounded])\n\n    # Final print statement in the exact required format.\n    # Convert the list of lists to a string and remove spaces to match the output format.\n    final_output_str = str(results).replace(' ', '')\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "最后，我们将挑战一项综合性的高级实践，它将前面练习中的概念融合成一个更接近真实反应堆安全分析的场景。在实际的反应堆中，功率分布通常是不均匀的，这意味着DNB最可能发生的位置（即最小DNB比（MDNBR）点）不一定在通道出口。本问题要求您构建一个一维轴向模型，以定位非均匀热流下的DNB发生点，并进一步探索该位置对功率峰值因子的敏感性，这是反应堆设计和安全评估中一项极为关键的高级技能。",
            "id": "4220510",
            "problem": "您需要实现一个一维轴向模型，用于预测压水反应堆中加热子通道内首次发生偏离泡核沸腾 (Departure from Nucleate Boiling, DNB) 的轴向位置，并使用一个指定的、有物理基础的临界热通量 (Critical Heat Flux, CHF) 关系式，来量化该预测位置对施加的轴向热通量峰值幅度的灵敏度。目标是根据能量守恒和一个经验上合理的 CHF 关系式，推导出一个计算程序。该程序在给定一个热点位于 $z = 0.6L$ 的偏斜轴向热通量分布的情况下，找出局部壁面热通量 $q''(z)$ 等于局部 CHF 的最小轴向坐标 $z_{\\mathrm{DNB}}$，并在给定的峰化幅度 $a$ 下计算灵敏度 $\\partial z_{\\mathrm{DNB}}/\\partial a$。\n\n从应用于液态水在流动面积为 $A_{\\mathrm{flow}}$、加热周长为 $P_{\\mathrm{h}}$ 的加热通道中稳态一维流动的能量守恒定律出发。已知质量通量为 $G$，绝对压力为 $P$，加热长度为 $L$，入口平均温度为 $T_{\\mathrm{in}}$，在压力 $P$ 下的饱和温度记为 $T_{\\mathrm{sat}}(P)$，定压比热 $c_p$ 为常数，汽化潜热为 $h_{\\mathrm{fg}}(P)$。假设热物理性质 $c_p$ 和 $h_{\\mathrm{fg}}$ 为下面指定的常数。通过能量平衡定义平衡干度 $x_e(z)$ 如下：\n$$\nx_e(z) = -\\frac{c_p\\left(T_{\\mathrm{sat}}(P) - T_{\\mathrm{in}}\\right)}{h_{\\mathrm{fg}}} + \\frac{P_{\\mathrm{h}}}{G\\,A_{\\mathrm{flow}}\\,h_{\\mathrm{fg}}} \\int_0^z q''(\\zeta)\\,\\mathrm{d}\\zeta.\n$$\n假设为强迫对流沸腾，并使用以下 CHF 关系式，该关系式反映了经过充分检验的、对质量通量、水力直径、压力和平衡干度的经验依赖性：\n$$\n\\mathrm{CHF}(z) = C_0\\, G^{m}\\, D_{\\mathrm{h}}^{n}\\, \\left(\\frac{P}{P_0}\\right)^{p} \\, \\max\\left( \\varepsilon,\\, 1 - K_x\\, x_e(z) \\right),\n$$\n其中 $C_0$、$m$、$n$、$p$、$P_0$、$K_x$ 和 $\\varepsilon$ 是下面指定的正常数，$D_{\\mathrm{h}}$ 是水力直径，$\\max(\\cdot,\\cdot)$ 强制施加一个下界以确保物理上的正值。局部壁面热通量 $q''(z)$ 由一个基准值 $q_0$ 规定，并由一个在 $z_0 = 0.6\\,L$ 处有单峰的偏斜轴向形状函数 $f(z)$ 进行调制：\n$$\nq''(z) = q_0 \\left[ 1 + a\\, f(z) \\right], \\quad f(z) = \\frac{\\left( \\frac{z}{L} \\right)^{\\alpha} \\left( 1 - \\frac{z}{L} \\right)^{\\beta}}{\\left( \\frac{\\alpha}{\\alpha + \\beta} \\right)^{\\alpha} \\left( \\frac{\\beta}{\\alpha + \\beta} \\right)^{\\beta}}, \\quad \\alpha = 3,\\ \\beta = 2.\n$$\n形状函数 $f(z)$ 是一个归一化的 Beta 分布，其在 $z_0 = \\frac{\\alpha}{\\alpha+\\beta} L = 0.6\\,L$ 处具有单位峰值，从而产生一个热点位于 $z = 0.6 L$ 的偏斜轴向分布。参数 $a$ 是一个无量纲的峰化因子。\n\n将预测的 DNB 位置 $z_{\\mathrm{DNB}}$ 定义为满足以下条件的最小轴向坐标 $z \\in [0, L]$：\n$$\nq''(z) \\ge \\mathrm{CHF}(z).\n$$\n如果在 $[0, L]$ 上不存在这样的 $z$，则报告 $z_{\\mathrm{DNB}} = -1.0$。使用有限差分近似法计算导数，以量化在指定的基准 $a$ 值下，预测的 DNB 位置对峰化因子 $a$ 的灵敏度：\n$$\n\\left.\\frac{\\partial z_{\\mathrm{DNB}}}{\\partial a}\\right|_{a} \\approx \\frac{z_{\\mathrm{DNB}}(a+\\delta a) - z_{\\mathrm{DNB}}(a-\\delta a)}{2\\,\\delta a},\n$$\n其中小扰动 $\\delta a$ 的值在下面指定。如果对于两个扰动幅值或对于基准幅值，$z_{\\mathrm{DNB}}$ 均为 $-1.0$，则报告灵敏度为 $0.0$。如果仅对一个扰动幅值存在 $z_{\\mathrm{DNB}}$，则使用单边差分：\n$$\n\\left.\\frac{\\partial z_{\\mathrm{DNB}}}{\\partial a}\\right|_{a} \\approx \\frac{z_{\\mathrm{DNB}}(a+\\delta a) - z_{\\mathrm{DNB}}(a)}{\\delta a} \\quad \\text{或} \\quad \\frac{z_{\\mathrm{DNB}}(a) - z_{\\mathrm{DNB}}(a-\\delta a)}{\\delta a},\n$$\n选择可用的一侧。\n\n使用的常数和单位如下：\n- $c_p = 5.0 \\times 10^3\\ \\mathrm{J/(kg\\cdot K)}$,\n- $h_{\\mathrm{fg}} = 1.0 \\times 10^6\\ \\mathrm{J/kg}$,\n- $C_0 = 2.0 \\times 10^4\\ \\mathrm{(国际单位制，与以\\ W/m^2\\ 为单位的\\ CHF\\ 一致)}$,\n- $m = 0.6$,\n- $n = -0.2$,\n- $p = 0.08$,\n- $P_0 = 1.0 \\times 10^7\\ \\mathrm{Pa}$,\n- $K_x = 0.3$,\n- $\\varepsilon = 0.1$,\n- $\\delta a = 0.02$.\n\n所有输入和输出必须使用国际单位制 (SI units)。具体来说，长度单位为 $\\mathrm{m}$，压力单位为 $\\mathrm{Pa}$，热通量单位为 $\\mathrm{W/m^2}$，质量通量单位为 $\\mathrm{kg/(m^2\\cdot s)}$，温度单位为 $\\mathrm{K}$，最终的灵敏度单位为 $\\mathrm{m}$ 每单位幅值 $a$。将饱和温差视为给定的入口过冷度 $\\Delta T_{\\mathrm{sub}} = T_{\\mathrm{sat}}(P) - T_{\\mathrm{in}}$，作为一个以 $\\mathrm{K}$ 为单位的参数提供，因此：\n$$\nx_e(0) = -\\frac{c_p \\Delta T_{\\mathrm{sub}}}{h_{\\mathrm{fg}}}.\n$$\n在均匀的轴向网格上使用数值积分来实现 $x_e(z)$ 中的累积积分，以产生数值稳定的解。\n\n测试套件。使用以下五个参数集作为测试用例，每个用例以元组形式提供：\n$$\n\\left( L,\\ D_{\\mathrm{h}},\\ A_{\\mathrm{flow}},\\ P_{\\mathrm{h}},\\ G,\\ P,\\ q_0,\\ a,\\ \\Delta T_{\\mathrm{sub}} \\right),\n$$\n以探索不同的工况，包括典型行为、无 DNB 条件和近入口 DNB：\n1. 用例 $1$：$\\left( 4.0,\\ 0.010,\\ 1.0\\times 10^{-4},\\ 0.030,\\ 3000,\\ 1.55\\times 10^{7},\\ 3.5\\times 10^{6},\\ 0.40,\\ 40 \\right)$。\n2. 用例 $2$：$\\left( 4.0,\\ 0.010,\\ 1.0\\times 10^{-4},\\ 0.030,\\ 5000,\\ 1.55\\times 10^{7},\\ 3.5\\times 10^{6},\\ 0.20,\\ 40 \\right)$。\n3. 用例 $3$：$\\left( 4.0,\\ 0.010,\\ 1.0\\times 10^{-4},\\ 0.030,\\ 3000,\\ 1.55\\times 10^{7},\\ 3.5\\times 10^{6},\\ 0.80,\\ 40 \\right)$。\n4. 用例 $4$：$\\left( 4.0,\\ 0.010,\\ 1.0\\times 10^{-4},\\ 0.030,\\ 2000,\\ 1.55\\times 10^{7},\\ 3.5\\times 10^{6},\\ 0.30,\\ 40 \\right)$。\n5. 用例 $5$：$\\left( 2.0,\\ 0.010,\\ 1.0\\times 10^{-4},\\ 0.030,\\ 3000,\\ 1.55\\times 10^{7},\\ 4.0\\times 10^{6},\\ 0.50,\\ 40 \\right)$。\n\n算法要求：\n- 用至少 $N = 2000$ 个点的均匀网格离散化 $z \\in [0, L]$。\n- 在网格上计算 $f(z)$、$q''(z)$、$x_e(z)$ 和 $\\mathrm{CHF}(z)$。\n- 找出第一个满足 $q''(z) \\ge \\mathrm{CHF}(z)$ 的 $z$ 作为 $z_{\\mathrm{DNB}}$；使用最近的两个网格点之间的线性插值来精确化 $z_{\\mathrm{DNB}}$。\n- 使用上面指定的 $\\delta a$ 计算在基准 $a$ 处的灵敏度。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个对应一个测试用例的结果本身是一个双元素列表，包含预测的 DNB 位置及其对 $a$ 的灵敏度，两者都以 $\\mathrm{m}$ 为单位表示：\n$$\n\\left[ [z_1, s_1], [z_2, s_2], [z_3, s_3], [z_4, s_4], [z_5, s_5] \\right].\n$$\n如果某个用例没有发生 DNB，则位置输出 $-1.0$，灵敏度输出 $0.0$。所有数值输出必须是原始浮点数，在打印行中不带单位。",
            "solution": "用户要求开发并实现一个一维轴向模型，用以预测反应堆加热子通道中偏离泡核沸腾 (DNB) 的位置，并量化该位置对轴向热通量峰化因子的灵敏度。\n\n### 步骤 1：提取已知条件\n\n**控制方程和定义：**\n1.  平衡干度 $x_e(z)$:\n    $$\n    x_e(z) = -\\frac{c_p\\left(T_{\\mathrm{sat}}(P) - T_{\\mathrm{in}}\\right)}{h_{\\mathrm{fg}}} + \\frac{P_{\\mathrm{h}}}{G\\,A_{\\mathrm{flow}}\\,h_{\\mathrm{fg}}} \\int_0^z q''(\\zeta)\\,\\mathrm{d}\\zeta\n    $$\n2.  临界热通量 (CHF) 关系式:\n    $$\n    \\mathrm{CHF}(z) = C_0\\, G^{m}\\, D_{\\mathrm{h}}^{n}\\, \\left(\\frac{P}{P_0}\\right)^{p} \\, \\max\\left( \\varepsilon,\\, 1 - K_x\\, x_e(z) \\right)\n    $$\n3.  轴向热通量分布 $q''(z)$:\n    $$\n    q''(z) = q_0 \\left[ 1 + a\\, f(z) \\right]\n    $$\n4.  归一化轴向形状函数 $f(z)$:\n    $$\n    f(z) = \\frac{\\left( \\frac{z}{L} \\right)^{\\alpha} \\left( 1 - \\frac{z}{L} \\right)^{\\beta}}{\\left( \\frac{\\alpha}{\\alpha + \\beta} \\right)^{\\alpha} \\left( \\frac{\\beta}{\\alpha + \\beta} \\right)^{\\beta}}, \\quad \\alpha = 3,\\ \\beta = 2\n    $$\n5.  DNB 条件：满足 $q''(z) \\ge \\mathrm{CHF}(z)$ 的最小轴向坐标 $z \\in [0, L]$。如果不存在这样的 $z$，则 $z_{\\mathrm{DNB}} = -1.0$。\n6.  $z_{\\mathrm{DNB}}$ 对 $a$ 的灵敏度：\n    $$\n    \\left.\\frac{\\partial z_{\\mathrm{DNB}}}{\\partial a}\\right|_{a} \\approx \\frac{z_{\\mathrm{DNB}}(a+\\delta a) - z_{\\mathrm{DNB}}(a-\\delta a)}{2\\,\\delta a} \\quad \\text{(中心差分)}\n    $$\n    $$\n    \\left.\\frac{\\partial z_{\\mathrm{DNB}}}{\\partial a}\\right|_{a} \\approx \\frac{z_{\\mathrm{DNB}}(a+\\delta a) - z_{\\mathrm{DNB}}(a)}{\\delta a} \\quad \\text{或} \\quad \\frac{z_{\\mathrm{DNB}}(a) - z_{\\mathrm{DNB}}(a-\\delta a)}{\\delta a} \\quad \\text{(单边差分)}\n    $$\n7.  入口过冷度：$T_{\\mathrm{sat}}(P) - T_{\\mathrm{in}}$ 项作为 $\\Delta T_{\\mathrm{sub}}$ 给出。\n\n**物理和模型常数：**\n- $c_p = 5.0 \\times 10^3\\ \\mathrm{J/(kg\\cdot K)}$\n- $h_{\\mathrm{fg}} = 1.0 \\times 10^6\\ \\mathrm{J/kg}$\n- $C_0 = 2.0 \\times 10^4\\ \\mathrm{(SI\\ units)}$\n- $m = 0.6$\n- $n = -0.2$\n- $p = 0.08$\n- $P_0 = 1.0 \\times 10^7\\ \\mathrm{Pa}$\n- $K_x = 0.3$\n- $\\varepsilon = 0.1$\n- $\\delta a = 0.02$\n- $\\alpha = 3$\n- $\\beta = 2$\n\n**算法要求：**\n- 轴向离散化：使用 $N \\ge 2000$ 个点的均匀网格。\n- 对 $x_e(z)$ 进行数值积分。\n- 使用线性插值精确化 $z_{\\mathrm{DNB}}$。\n- 灵敏度计算的具体逻辑：如可能，使用中心差分；如果一个扰动情况无 DNB，则退回至单边差分；如果基准情况无 DNB 或两个扰动情况都无 DNB，则报告 $0.0$。\n\n**测试用例 (参数)：**\n五个测试用例以 $\\left( L,\\ D_{\\mathrm{h}},\\ A_{\\mathrm{flow}},\\ P_{\\mathrm{h}},\\ G,\\ P,\\ q_0,\\ a,\\ \\Delta T_{\\mathrm{sub}} \\right)$ 元组的形式给出。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n根据验证标准对问题进行审查。\n- **科学基础：** 该问题基于热工水力学的基本原理，特别是单相和两相流中的能量守恒，以及标志着偏离泡核沸腾 (DNB) 开始的临界热通量 (CHF) 概念。所提供的 CHF 关系式是经验性的，这是该领域的标准做法，其函数形式（依赖于质量通量、几何形状、压力和干度）在物理上是合理的，并与著名的关系式（例如 W-3）一致。轴向热通量分布是一个平滑的单峰函数，代表了核反应堆堆芯中的分布情况。该问题牢固地植根于成熟的核工程科学。\n- **适定性：** 对于数值求解而言，该问题陈述是适定的。它清晰地定义了所有变量、方程和常数。目标是找到方程 $g(z) = \\mathrm{CHF}(z) - q''(z) = 0$ 的最小根。提供了数值方法（离散化、数值积分和插值）以及针对边界情况（无 DNB、灵敏度计算逻辑）的明确规则，确保可以计算出唯一且稳定的解。\n- **客观性：** 问题以精确、客观和定量的语言陈述。没有主观成分或观点。\n\n该问题没有任何无效性缺陷。它在科学上是合理的，可形式化的，完整的，并且是可通过计算验证的。\n\n### 步骤 3：结论和行动\n\n问题被判定为 **有效**。将提供一个解决方案。\n\n### 基于原理的解决方案设计\n\n该解决方案通过对沿加热通道的热工水力现象进行数值建模来展开。核心原理是，随着冷却剂沿通道流动，其焓值由于施加的热通量而增加，这反过来又降低了局部的 DNB 裕度。DNB 发生在施加的热通量超过局部 CHF 极限的第一个轴向位置。\n\n计算程序设计如下：\n\n1.  **轴向离散化：** 将长度为 $L$ 的通道离散化为一个由 $N=2000$ 个点组成的精细、均匀的网格，$z_i$（其中 $i=0, 1, \\dots, N-1$）。这个空间网格构成了所有后续计算的基础。\n\n2.  **轴向热通量分布计算：** 对于给定的一组参数（包括峰化因子 $a$），在每个网格点计算轴向热通量 $q''(z_i)$。这包括首先计算归一化的 Beta 分布形状函数 $f(z_i)$，然后应用定义式 $q''(z_i) = q_0 [1 + a f(z_i)]$。\n\n3.  **平衡干度分布计算：** 平衡干度 $x_e(z_i)$ 由能量平衡确定。\n    -   根据指定的入口过冷度计算入口 $z=0$ 处的干度：$x_e(0) = -c_p \\Delta T_{\\mathrm{sub}} / h_{\\mathrm{fg}}$。\n    -   使用先前计算的 $q''(z_i)$ 数组，通过累积梯形法则为每个网格点 $z_i$ 数值计算积分项 $\\int_0^{z_i} q''(\\zeta) \\mathrm{d}\\zeta$。这提供了截至每个点的流体累积能量增量。\n    -   根据给定的 $x_e(z_i)$ 方程组合这些分量。\n\n4.  **临界热通量分布计算：** 在已知局部平衡干度 $x_e(z_i)$ 的情况下，使用所提供的经验关系式在每个网格点计算局部临界热通量 $\\mathrm{CHF}(z_i)$。这涉及到计算一个依赖于系统参数（$G, D_h, P$）的预因子和一个依赖于干度的项。\n\n5.  **DNB 位置识别：** DNB 条件是 $q''(z) \\ge \\mathrm{CHF}(z)$，这等效于定义为 $M(z) = \\mathrm{CHF}(z) - q''(z)$ 的 DNB 裕度小于或等于零。\n    -   在每个网格点计算裕度 $M(z_i)$。\n    -   算法从入口开始搜索第一个裕度 $M(z_i) \\le 0$ 的网格索引 $i$。\n    -   如果未找到这样的索引，则结论为不发生 DNB，且 $z_{\\mathrm{DNB}} = -1.0$。\n    -   如果找到了索引 $i_{\\mathrm{DNB}}$，则 DNB 位置在 $z_{i_{\\mathrm{DNB}}-1}$ 和 $z_{i_{\\mathrm{DNB}}}$ 之间。通过对裕度函数 $M(z)$ 进行线性插值以找到 $M(z_{\\mathrm{DNB}})=0$ 的根，从而求得精确位置 $z_{\\mathrm{DNB}}$。\n\n6.  **灵敏度分析：** 为了计算灵敏度 $\\partial z_{\\mathrm{DNB}}/\\partial a$，将寻找 $z_{\\mathrm{DNB}}$ 的整个过程封装在一个函数中，该函数接受峰化因子 $a$ 作为参数。\n    -   对基准幅值 $a$ 和两个扰动幅值 $a+\\delta a$ 和 $a-\\delta a$ 调用此函数。\n    -   根据这三种情况下是否发生 DNB，按照问题陈述中指定的有限差分公式（中心、前向单边或后向单边）计算灵敏度。如果基准情况无 DNB，或者两个扰动情况均无 DNB，则灵敏度报告为 $0.0$。\n\n对所提供的五个测试用例中的每一个都执行此分步过程。最终结果，每个结果包含一对 $[z_{\\mathrm{DNB}}, \\text{灵敏度}]$，被收集并格式化为所需的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Main function to solve the DNB prediction problem for all test cases.\n    \"\"\"\n    # Define problem constants as specified in the problem statement\n    C_P = 5.0e3  # Specific heat capacity in J/(kg.K)\n    H_FG = 1.0e6  # Latent heat of vaporization in J/kg\n    C0 = 2.0e4  # CHF correlation constant in SI units\n    M = 0.6  # Mass flux exponent\n    N_EXP = -0.2  # Hydraulic diameter exponent\n    P_EXP = 0.08  # Pressure exponent\n    P0 = 1.0e7  # Reference pressure in Pa\n    KX = 0.3  # Equilibrium quality coefficient\n    EPSILON = 0.1  # Minimum value for the quality-dependent part of CHF\n    DELTA_A = 0.02  # Perturbation for sensitivity calculation\n    ALPHA = 3.0  # Shape function exponent\n    BETA = 2.0  # Shape function exponent\n    NUM_POINTS = 2000  # Number of points for axial discretization\n\n    # Pre-calculate the normalization factor for the axial shape function f(z)\n    norm_factor = (ALPHA / (ALPHA + BETA))**ALPHA * (BETA / (ALPHA + BETA))**BETA\n\n    def find_z_dnb(params, a_val):\n        \"\"\"\n        Calculates the axial location of DNB for a given set of parameters and a specific\n        peaking amplitude 'a_val'.\n        Returns the DNB location in meters, or -1.0 if no DNB occurs.\n        \"\"\"\n        L, D_h, A_flow, P_h, G, P, q0, _, delta_T_sub = params\n        a = a_val\n\n        # 1. Create the uniform axial mesh\n        z = np.linspace(0, L, NUM_POINTS)\n\n        # 2. Calculate the axial heat flux profile q''(z)\n        z_norm = z / L\n        # Use errstate to prevent warnings for 0^x at endpoints, though not needed for alpha, beta  1\n        with np.errstate(divide='ignore', invalid='ignore'):\n            f_z = (z_norm**ALPHA * (1 - z_norm)**BETA) / norm_factor\n        f_z = np.nan_to_num(f_z)  # Clean up potential NaN results (e.g., 0/0) at endpoints\n        \n        q_double_prime = q0 * (1.0 + a * f_z)\n\n        # 3. Calculate the equilibrium quality profile x_e(z)\n        xe_in = -C_P * delta_T_sub / H_FG\n        integral_q = cumulative_trapezoid(q_double_prime, z, initial=0)\n        xe = xe_in + (P_h / (G * A_flow * H_FG)) * integral_q\n\n        # 4. Calculate the Critical Heat Flux (CHF) profile CHF(z)\n        chf_prefactor = C0 * G**M * D_h**N_EXP * (P / P0)**P_EXP\n        chf = chf_prefactor * np.maximum(EPSILON, 1.0 - KX * xe)\n\n        # 5. Find the first location where DNB occurs (q'' = CHF)\n        margin = chf - q_double_prime\n        dnb_indices = np.where(margin = 0.0)[0]\n\n        if dnb_indices.size == 0:\n            return -1.0  # No DNB occurs in the channel\n\n        idx_dnb = dnb_indices[0]\n        \n        if idx_dnb == 0:\n            # DNB occurs at the inlet (z=0)\n            return 0.0\n\n        # 6. Use linear interpolation to find a more precise z_DNB\n        # The DNB condition is met between grid points idx_dnb-1 and idx_dnb\n        z1, g1 = z[idx_dnb - 1], margin[idx_dnb - 1]\n        z2, g2 = z[idx_dnb], margin[idx_dnb]\n\n        # Find the root of the line connecting (z1, g1) and (z2, g2)\n        # z_dnb = z1 + g1 * (z2 - z1) / (g1 - g2)\n        z_dnb = z1 - g1 * (z2 - z1) / (g2 - g1)\n        \n        return z_dnb\n\n    def compute_dnb_and_sensitivity(case):\n        \"\"\"\n        Computes the baseline z_DNB and its sensitivity to the peaking amplitude 'a'\n        for a given test case.\n        \"\"\"\n        _, _, _, _, _, _, _, a_base, _ = case\n\n        z_base = find_z_dnb(case, a_base)\n\n        # Apply the specified logic for sensitivity calculation\n        if z_base == -1.0:\n            sensitivity = 0.0\n        else:\n            z_plus = find_z_dnb(case, a_base + DELTA_A)\n            z_minus = find_z_dnb(case, a_base - DELTA_A)\n\n            if z_plus != -1.0 and z_minus != -1.0:\n                # Use centered difference if both perturbed points exist\n                sensitivity = (z_plus - z_minus) / (2.0 * DELTA_A)\n            elif z_plus != -1.0 and z_minus == -1.0:\n                # Use one-sided forward difference\n                sensitivity = (z_plus - z_base) / DELTA_A\n            elif z_plus == -1.0 and z_minus != -1.0:\n                # Use one-sided backward difference\n                sensitivity = (z_base - z_minus) / DELTA_A\n            else:  # Both perturbed cases result in no DNB\n                sensitivity = 0.0\n        \n        return [z_base, sensitivity]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, Dh, A_flow, P_h, G, P, q0, a, T_sub) in SI units\n        (4.0, 0.010, 1.0e-4, 0.030, 3000, 1.55e7, 3.5e6, 0.40, 40),\n        (4.0, 0.010, 1.0e-4, 0.030, 5000, 1.55e7, 3.5e6, 0.20, 40),\n        (4.0, 0.010, 1.0e-4, 0.030, 3000, 1.55e7, 3.5e6, 0.80, 40),\n        (4.0, 0.010, 1.0e-4, 0.030, 2000, 1.55e7, 3.5e6, 0.30, 40),\n        (2.0, 0.010, 1.0e-4, 0.030, 3000, 1.55e7, 4.0e6, 0.50, 40),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_dnb_and_sensitivity(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    result_str = '[' + ','.join([f'[{r[0]},{r[1]}]' for r in results]) + ']'\n    print(result_str)\n\nsolve()\n```"
        }
    ]
}