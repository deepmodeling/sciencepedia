{
    "hands_on_practices": [
        {
            "introduction": "The stability of explicit time integration schemes is often the primary factor limiting computational efficiency in reactor simulations. This practice connects theory to application by having you derive the stability limit for the Forward Euler method when applied to a spatially discretized diffusion equation—a model central to heat transfer in reactor components. By analyzing the spectral properties of the system matrices from a Finite Element discretization, you will establish a direct, quantitative relationship between the spatial mesh size and the maximum permissible time step, a foundational skill in numerical analysis for PDEs .",
            "id": "4231362",
            "problem": "Consider one-dimensional heat diffusion in a homogeneous slab representative of a radial line in a nuclear fuel pellet, governed by the partial differential equation $\\frac{\\partial \\phi}{\\partial t} = D \\frac{\\partial^{2} \\phi}{\\partial x^{2}}$, where $\\phi(x,t)$ is the temperature-like scalar field and $D$ is the thermal diffusivity. Discretize the spatial domain with a uniform mesh of spacing $h$ using linear basis functions in the Finite Element (FE) method, and assume homogeneous Dirichlet boundary conditions at the ends of a large slab. The semi-discrete system takes the canonical form $M \\dot{\\boldsymbol{\\phi}} + K \\boldsymbol{\\phi} = \\boldsymbol{0}$, where $M$ is the consistent mass matrix and $K$ is the stiffness matrix arising from the bilinear forms associated with the diffusion operator. \n\nStarting from the standard weak form and assembly rules for linear elements on a uniform mesh, derive the spectral radius $\\rho(M^{-1}K)$ by analyzing the generalized eigenvalue problem $K \\boldsymbol{v} = \\lambda M \\boldsymbol{v}$ for mode shapes corresponding to discrete sines on a uniform grid. Use this to obtain a conservative closed-form estimate for the Forward Euler time step $\\Delta t_{\\text{FE}}$ required for absolute stability when integrating $\\dot{\\boldsymbol{\\phi}} = - M^{-1} K \\boldsymbol{\\phi}$ with the Forward Euler method. \n\nTake the thermal diffusivity to be $D = 1$ $\\text{cm}^{2}\\,\\text{s}^{-1}$ and the mesh size to be $h = 0.5$ $\\text{cm}$. Round your final time step to four significant figures and express your answer in seconds.",
            "solution": "...",
            "answer": "$$\n\\boxed{0.04167}\n$$"
        },
        {
            "introduction": "While explicit methods are constrained by stability, implicit methods like the Crank-Nicolson scheme offer a path to unconditional stability, making them indispensable for stiff systems with widely varying timescales. This exercise explores the behavior of the Crank-Nicolson scheme on a model representing both stiff and non-stiff dynamics characteristic of reactor transients . You will derive the method's amplification factor to understand not only why it remains stable for large time steps but also how it can introduce non-physical oscillations when resolving stiff phenomena coarsely—a critical insight for interpreting simulation results.",
            "id": "4231279",
            "problem": "In coupled neutron-thermal-hydraulic transients of a nuclear reactor, linearization and modal decomposition about a steady state often yield independent scalar modes that each satisfy a linear ordinary differential equation (ODE) of the form $y'(t) = \\lambda y(t)$, where $\\lambda \\in \\mathbb{C}$ is a modal eigenvalue. Consider a representative two-timescale situation in which one mode is stiff with eigenvalue $\\lambda_{1} = -10^{5}\\,\\text{s}^{-1}$ and another mode is slow with eigenvalue $\\lambda_{2} = -10\\,\\text{s}^{-1}$. You will analyze the time discretization of such modes using the Crank–Nicolson (CN) scheme.\n\nStarting from the defining update of the Crank–Nicolson (CN) method applied to the scalar linear ODE $y'(t) = \\lambda y(t)$ over a uniform time step $\\Delta t$, derive the scalar stability (amplification) function $R(z)$ in terms of the dimensionless quantity $z = \\lambda \\Delta t$. Then, for a time step $\\Delta t = 10^{-3}\\,\\text{s}$, evaluate $R(z)$ for both $z_{1} = \\lambda_{1}\\Delta t$ and $z_{2} = \\lambda_{2}\\Delta t$, and use the sign and magnitude of each amplification factor to infer whether the discrete-time response of each mode is oscillatory between steps.\n\nReport only the numerical value of the amplification factor for the stiff mode, that is $R(z_{1})$, as your final answer. Express the result as a pure number (dimensionless) and round your answer to $8$ significant figures.",
            "solution": "The problem requires deriving and evaluating the stability function for the Crank-Nicolson (CN) scheme applied to the scalar linear ODE:\n$$\ny'(t) = \\lambda y(t)\n$$\nThe CN scheme discretizes this equation over a time step $\\Delta t$ by applying a centered-difference approximation for the derivative and an average for the right-hand side term:\n$$\n\\frac{y_{n+1} - y_n}{\\Delta t} = \\frac{1}{2} \\left( \\lambda y_n + \\lambda y_{n+1} \\right)\n$$\nThe stability (or amplification) function, $R(z)$, is defined by the relation $y_{n+1} = R(z) y_n$, where $z = \\lambda \\Delta t$. To derive $R(z)$, we rearrange the discretized CN equation to solve for $y_{n+1}$.\n\nFirst, multiply by $\\Delta t$ and substitute $z = \\lambda \\Delta t$:\n$$\ny_{n+1} - y_n = \\frac{z}{2} (y_n + y_{n+1})\n$$\nNext, gather all terms containing $y_{n+1}$ on the left-hand side and all terms containing $y_n$ on the right-hand side:\n$$\ny_{n+1} - \\frac{z}{2} y_{n+1} = y_n + \\frac{z}{2} y_n\n$$\nFactor out $y_{n+1}$ and $y_n$:\n$$\ny_{n+1} \\left( 1 - \\frac{z}{2} \\right) = y_n \\left( 1 + \\frac{z}{2} \\right)\n$$\nDividing by the factor on the left yields the expression for $y_{n+1}$ and allows us to identify the stability function $R(z)$:\n$$\ny_{n+1} = \\frac{1 + \\frac{z}{2}}{1 - \\frac{z}{2}} y_n \\quad \\implies \\quad R(z) = \\frac{1 + \\frac{z}{2}}{1 - \\frac{z}{2}}\n$$\nNow, we evaluate $R(z)$ for the two specified modes using the time step $\\Delta t = 10^{-3}\\,\\text{s}$.\n\nFor the stiff mode, the eigenvalue is $\\lambda_1 = -10^5\\,\\text{s}^{-1}$. The corresponding value of $z$ is:\n$$\nz_1 = \\lambda_1 \\Delta t = (-10^5\\,\\text{s}^{-1}) (10^{-3}\\,\\text{s}) = -100\n$$\nThe amplification factor for the stiff mode is:\n$$\nR(z_1) = R(-100) = \\frac{1 + \\frac{-100}{2}}{1 - \\frac{-100}{2}} = \\frac{1 - 50}{1 + 50} = \\frac{-49}{51}\n$$\nA negative amplification factor indicates that the numerical solution for this mode will be oscillatory, flipping sign at each time step. Since its magnitude $|R(z_1)| = 49/51  1$, the oscillations are stable (non-growing) but are poorly damped.\n\nFor the slow mode, the eigenvalue is $\\lambda_2 = -10\\,\\text{s}^{-1}$. The corresponding value of $z$ is:\n$$\nz_2 = \\lambda_2 \\Delta t = (-10\\,\\text{s}^{-1}) (10^{-3}\\,\\text{s}) = -0.01\n$$\nThe amplification factor for the slow mode is:\n$$\nR(z_2) = R(-0.01) = \\frac{1 + \\frac{-0.01}{2}}{1 - \\frac{-0.01}{2}} = \\frac{1 - 0.005}{1 + 0.005} = \\frac{0.995}{1.005} \\approx 0.99\n$$\nA positive amplification factor indicates a non-oscillatory and stable response, accurately capturing the monotonic decay of the physical mode.\n\nThe final task is to report the numerical value of the amplification factor for the stiff mode, $R(z_1)$, rounded to $8$ significant figures.\n$$\nR(z_1) = -\\frac{49}{51} \\approx -0.960784313725...\n$$\nRounding to $8$ significant figures gives $-0.96078431$.",
            "answer": "$$\n\\boxed{-0.96078431}\n$$"
        },
        {
            "introduction": "In complex multiphysics simulations, combining implicit and explicit methods (IMEX) is a powerful strategy, but it requires careful implementation to uphold physical laws. This problem examines a common pitfall in simulating nuclide transmutation, where a naive IMEX splitting can violate the fundamental principle of mass conservation . You will be challenged to think like a code developer, devising a corrective limiter for the explicit part of the scheme and analyzing the crucial trade-off between enforcing physical consistency and maintaining the formal order of accuracy of the numerical method.",
            "id": "4231352",
            "problem": "In depletion-coupled nuclear reactor simulation, consider a single reaction channel that transfers nuclide inventory from a donor species $A$ to a receiver species $B$ under a constant neutron flux over one macro time step. The governing inventory balance for species $A$ and $B$ can be written as\n$$\n\\frac{d C_A}{dt} \\;=\\; - \\lambda C_A, \n\\qquad\n\\frac{d C_B}{dt} \\;=\\; + \\lambda C_A,\n$$\nwhere $C_A \\ge 0$, $C_B \\ge 0$, and $\\lambda \\ge 0$ is an effective removal/production rate that may represent a combination of neutron-induced transmutation and radioactive decay. The continuous model conserves the total inventory $C_A + C_B$ and preserves non-negativity.\n\nA common Implicit-Explicit (IMEX) time integration splits the stiff loss of $A$ implicitly and the source of $B$ explicitly. Over one step of size $\\Delta t$, suppose a donor-first update is performed (so that $C_A^{n+1}$ is available when updating $C_B^{n+1}$). In a baseline first-order IMEX-Euler variant, one obtains\n$$\nC_A^{n+1} \\;=\\; \\frac{C_A^{n}}{1 + \\lambda \\Delta t},\n\\qquad\nC_B^{n+1} \\;=\\; C_B^{n} + \\Delta t \\,\\lambda\\, C_A^{n}.\n$$\nFor large $\\Delta t$, the explicit source update for $B$ can overshoot the amount actually removed from $A$ during the same step, destroying discrete conservation and, in more general reaction networks, potentially violating non-negativity through coupling.\n\nYou are tasked to propose a positivity-preserving and conservation-consistent modification to the IMEX source update for a general receiver component $C_i$ when its explicit source is of the form $S_i^{\\mathrm{exp}} = \\lambda C_{\\mathrm{donor}}$ owing to a single donor $C_{\\mathrm{donor}}$ that is updated implicitly in loss form, and to reason from first principles about the formal order of accuracy consequences when this modification activates in an otherwise higher-order ($p \\ge 2$) IMEX Runge–Kutta method. Your modification must be defined in terms of computable step-end donor change.\n\nWhich option correctly specifies such a modification and its accuracy implications?\n\nA. Replace $S_i^{\\mathrm{exp}}$ by a clipped source $\\theta\\, S_i^{\\mathrm{exp}}$ with\n$$\n\\theta \\;=\\; \\min\\!\\left\\{\\,1,\\; \\frac{C_{\\mathrm{donor}}^{n} - C_{\\mathrm{donor}}^{n+1}}{\\Delta t \\,\\lambda\\, C_{\\mathrm{donor}}^{n} + \\varepsilon}\\,\\right\\},\n$$\nwhere $\\varepsilon  0$ is a machine-safe regularization. This enforces that the produced amount in receivers over the step equals the actually removed donor inventory, thereby preserving non-negativity and discrete conservation across the donor–receiver pair. When $\\theta  1$ (the limiter is active), the local modification is a nonsmooth projection that introduces an $\\mathcal{O}(\\Delta t)$ perturbation, reducing the effective order to $1$ on those steps even if the underlying IMEX scheme has order $p \\ge 2$.\n\nB. Clip the implicit loss term instead, i.e., replace the implicit update for $C_{\\mathrm{donor}}$ by $C_{\\mathrm{donor}}^{n+1} = C_{\\mathrm{donor}}^{n} - \\theta \\Delta t \\,\\lambda\\, C_{\\mathrm{donor}}^{n+1}$ with the same $\\theta$ as in Option A. This preserves $A$-stability, maintains order $p$, and guarantees non-negativity and conservation without affecting receivers.\n\nC. Use an amplifying factor $\\theta = \\max\\!\\left\\{\\,1,\\; \\frac{C_{\\mathrm{donor}}^{n} - C_{\\mathrm{donor}}^{n+1}}{\\Delta t \\,\\lambda\\, C_{\\mathrm{donor}}^{n}}\\,\\right\\}$ on $S_i^{\\mathrm{exp}}$ so that small steps are unchanged but large steps increase production to compensate for implicit damping; because $\\theta \\ge 1$, this keeps positivity and improves accuracy without order loss.\n\nD. Rely on Strong Stability Preserving (SSP) IMEX Runge–Kutta coefficients of order $p \\ge 2$; such schemes guarantee positivity and exact discrete conservation for any $\\Delta t$, so no clipping is necessary and there is no order reduction in any regime.",
            "solution": "The core of the problem is to enforce the conservation of total inventory, $C_A + C_B$, at the discrete level, a property inherent to the continuous model. The continuous system conserves mass because $\\frac{d}{dt}(C_A + C_B) = -\\lambda C_A + \\lambda C_A = 0$.\n\nLet's analyze the given IMEX scheme. The amount of nuclide $A$ removed during the step is:\n$$\n\\Delta C_{A, \\text{removed}} = C_A^n - C_A^{n+1} = C_A^n - \\frac{C_A^n}{1 + \\lambda \\Delta t} = \\frac{\\lambda \\Delta t}{1 + \\lambda \\Delta t} C_A^n\n$$\nThe amount of nuclide $B$ produced according to the explicit Euler source term is:\n$$\n\\Delta C_{B, \\text{produced}} = C_B^{n+1} - C_B^n = \\Delta t \\,\\lambda\\, C_A^{n}\n$$\nThe scheme is not conservative because $\\Delta C_{A, \\text{removed}} \\neq \\Delta C_{B, \\text{produced}}$. The explicit source term overestimates production relative to the implicitly damped removal term.\n\nTo enforce conservation, the amount produced in $B$ must exactly equal the amount removed from $A$. The modified update for the receiver species $B$ should be:\n$$\nC_B^{n+1} = C_B^n + \\Delta C_{A, \\text{removed}} = C_B^n + (C_A^n - C_A^{n+1})\n$$\nWith this change, the total inventory is perfectly conserved: $C_A^{n+1} + C_B^{n+1} = C_A^{n+1} + (C_B^n + C_A^n - C_A^{n+1}) = C_A^n + C_B^n$. This also preserves non-negativity since $C_A^n - C_A^{n+1} \\geq 0$.\n\nThe problem asks to express this modification as a clipping factor $\\theta$ on the original explicit source, $S_i^{\\mathrm{exp}} = \\lambda C_{\\mathrm{donor}}^n$. The modified source term is $\\theta S_i^{\\mathrm{exp}}$.\nEquating the change in $B$ gives:\n$$\n\\Delta t \\, \\theta (\\lambda C_A^n) = C_A^n - C_A^{n+1} \\implies \\theta = \\frac{C_A^n - C_A^{n+1}}{\\Delta t \\lambda C_A^n}\n$$\nThis defines the required scaling factor. Note that $\\frac{C_A^n - C_A^{n+1}}{\\Delta t \\lambda C_A^n} = \\frac{\\frac{\\lambda \\Delta t}{1+\\lambda \\Delta t}C_A^n}{\\Delta t \\lambda C_A^n} = \\frac{1}{1+\\lambda \\Delta t}$. For $\\lambda \\ge 0$ and $\\Delta t \\ge 0$, this factor is always $\\le 1$.\n\nNow, let's analyze the options:\n*   **A:** Proposes a clipping factor $\\theta = \\min\\left\\{1, \\frac{C_{\\mathrm{donor}}^{n} - C_{\\mathrm{donor}}^{n+1}}{\\Delta t \\,\\lambda\\, C_{\\mathrm{donor}}^{n} + \\varepsilon}\\right\\}$. This matches our derived correction. The `min` function and regularization term $\\varepsilon$ make it a robust implementation. When this limiter is active ($\\theta  1$), it modifies the update. This modification, being non-smooth and introducing a perturbation proportional to $\\Delta t$, reduces the local truncation error of the affected stage to $\\mathcal{O}(\\Delta t^2)$, which in turn reduces the global order of accuracy to first order for that step. This analysis is correct.\n\n*   **B:** Suggests modifying the donor species update. This is incorrect as the inconsistency lies in the receiver's explicit source term. This approach does not fix the conservation error.\n\n*   **C:** Proposes an amplifying factor with $\\max\\{1, ...\\}$. This is fundamentally wrong. The correction factor must be $\\le 1$ to *dampen* the over-enthusiastic explicit source, not amplify it. This option would do nothing as the expression inside the max is always $\\le 1$.\n\n*   **D:** Claims that Strong Stability Preserving (SSP) schemes solve this issue automatically. SSP methods are designed to preserve monotonicity under a time step restriction related to the explicit Euler method; they do not inherently enforce conservation across stiff/non-stiff splits in an IMEX context. The conservation error is a structural issue with the IMEX splitting itself, not something an SSP coefficient set can fix without a specific formulation like the one in Option A.\n\nTherefore, Option A is the only choice that correctly identifies the necessary modification and accurately describes its impact on the method's order of accuracy.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}