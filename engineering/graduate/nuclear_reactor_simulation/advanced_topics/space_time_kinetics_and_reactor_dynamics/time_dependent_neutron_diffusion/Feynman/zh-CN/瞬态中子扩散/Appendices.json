{
    "hands_on_practices": [
        {
            "introduction": "在深入研究求解瞬态扩散方程的数值方法之前，我们首先必须理解该方程本身的适用范围。中子扩散方程是更为基础的中子输运方程在特定条件下的近似。本练习将引导你从第一性原理出发，推导出一个定量准则，以判断在给定的物理情景（特别是快速瞬态过程）中，扩散近似是否依然有效，从而为你建立坚实的物理模型基础。",
            "id": "4257458",
            "problem": "考虑在无限均匀介质中的单能含时中子输运。其基本方程是线性玻尔兹曼输运方程，对于单能中子，该方程可以用角通量表示为\n$$\\frac{1}{v}\\frac{\\partial \\psi(\\mathbf{r},\\mathbf{\\Omega},t)}{\\partial t} + \\mathbf{\\Omega}\\cdot \\nabla \\psi(\\mathbf{r},\\mathbf{\\Omega},t) + \\Sigma_t \\psi(\\mathbf{r},\\mathbf{\\Omega},t) = \\frac{\\Sigma_s}{4\\pi}\\phi(\\mathbf{r},t) + S(\\mathbf{r},\\mathbf{\\Omega},t),$$\n其中 $v$ 是中子速度，单位为 $\\mathrm{m/s}$，$\\Sigma_t$ 是宏观总截面，单位为 $\\mathrm{m}^{-1}$，$\\Sigma_s$ 是宏观散射截面，单位为 $\\mathrm{m}^{-1}$，$\\phi(\\mathbf{r},t) = \\int_{4\\pi} \\psi(\\mathbf{r},\\mathbf{\\Omega},t)\\, d\\mathbf{\\Omega}$ 是标量通量，$S$ 是源项。取零阶和一阶角矩可得到标量通量连续性方程和中子流方程。在一阶球谐函数 (P1) 闭合下，使用平均散射余弦 $\\bar{\\mu}$ 进行输运修正，得到输运截面\n$$\\Sigma_{\\mathrm{tr}} = \\Sigma_t - \\bar{\\mu}\\,\\Sigma_s,$$\n中子流方程包含一个与 $\\frac{1}{v}\\frac{\\partial \\mathbf{J}}{\\partial t}$ 成正比的惯性项，其中 $\\mathbf{J}$ 是中子流。标准扩散近似忽略此惯性项，并假设菲克定律 (Fick's law) $\\mathbf{J} \\approx -D\\nabla \\phi$，其中 $D = \\frac{1}{3\\Sigma_{\\mathrm{tr}}}$。当梯度足够弱且瞬态变化足够慢时，此近似有效。\n\n你的任务是，从第一性原理出发，通过构建一个涉及特征长度尺度与平均自由程之比的定量判据，来论证在快速瞬态下扩散近似失效的条件。从输运方程及其 P1 矩开始，定义通量变化的特征空间尺度 $L$（单位为 $\\mathrm{m}$）和时间变化的特征瞬态时间尺度 $\\tau$（单位为 $\\mathrm{s}$），并推导用于衡量被忽略项相对大小的无量纲小参数。具体来说，使用以下参数推导判据：\n- 输运平均自由程 $\\lambda_{\\mathrm{tr}} = \\frac{1}{\\Sigma_{\\mathrm{tr}}}$（单位为 $\\mathrm{m}$），\n- 空间克努森数 (Knudsen number) $K = \\frac{\\lambda_{\\mathrm{tr}}}{L}$，\n- 瞬态尺度比 $T = \\frac{v\\,\\tau}{\\lambda_{\\mathrm{tr}}}$，它比较了中子在瞬态时间尺度内行进的距离与平均自由程。\n\n利用这些参数，提出了一个单一的标量指标 $\\mathrm{DBI}$（扩散失效指数），该指标聚合了空间和时间上的小量条件，并指定一个定量阈值 $\\epsilon$，当 $\\mathrm{DBI}$ 超过 $\\epsilon$ 时，认为扩散近似失效。通过与 P1 闭合误差的数量级一致性来证明你对 $\\epsilon$ 的选择是合理的。\n\n然后，实现一个程序，针对一组指定的物理上合理的测试案例，根据你推导的判据，为每个案例计算一个布尔值，以指示扩散近似是否失效（True）或仍然有效（False）。程序必须使用以下测试套件，其参数以一致的物理单位给出，并且必须为每个案例计算 $\\Sigma_{\\mathrm{tr}}$、$\\lambda_{\\mathrm{tr}}$、$K$、$T$ 和你的 $\\mathrm{DBI}$：\n\n- 案例 A（热中子区，大系统，慢瞬态）：\n  - $v = 2200\\,\\mathrm{m/s}$，\n  - $\\Sigma_t = 66\\,\\mathrm{m}^{-1}$，\n  - $\\Sigma_s = 65\\,\\mathrm{m}^{-1}$，\n  - $\\bar{\\mu} = 0.0$，\n  - $L = 0.5\\,\\mathrm{m}$，\n  - $\\tau = 0.1\\,\\mathrm{s}$。\n\n- 案例 B（快中子区，小系统，快瞬态，中度前向散射）：\n  - $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$，\n  - $\\Sigma_t = 2.0\\,\\mathrm{m}^{-1}$，\n  - $\\Sigma_s = 1.5\\,\\mathrm{m}^{-1}$，\n  - $\\bar{\\mu} = 0.5$，\n  - $L = 0.05\\,\\mathrm{m}$，\n  - $\\tau = 1.0\\times 10^{-7}\\,\\mathrm{s}$。\n\n- 案例 C（近阈值案例，弱梯度和中等瞬态）：\n  - $v = 2200\\,\\mathrm{m/s}$，\n  - $\\Sigma_t = 50\\,\\mathrm{m}^{-1}$，\n  - $\\Sigma_s = 49\\,\\mathrm{m}^{-1}$，\n  - $\\bar{\\mu} = 0.0$，\n  - $L = 0.25\\,\\mathrm{m}$，\n  - $\\tau = 1.090909\\!\\times\\! 10^{-4}\\,\\mathrm{s}$。\n\n- 案例 D（热中子区，强各向异性导致大输运平均自由程，小系统，慢瞬态）：\n  - $v = 2200\\,\\mathrm{m/s}$，\n  - $\\Sigma_t = 50\\,\\mathrm{m}^{-1}$，\n  - $\\Sigma_s = 48\\,\\mathrm{m}^{-1}$，\n  - $\\bar{\\mu} = 0.9$，\n  - $L = 0.1\\,\\mathrm{m}$，\n  - $\\tau = 0.2\\,\\mathrm{s}$。\n\n- 案例 E（边界等式案例）：\n  - $v = 2200\\,\\mathrm{m/s}$，\n  - $\\Sigma_t = 100\\,\\mathrm{m}^{-1}$，\n  - $\\Sigma_s = 99\\,\\mathrm{m}^{-1}$，\n  - $\\bar{\\mu} = 0.0$，\n  - $L = 0.1\\,\\mathrm{m}$，\n  - $\\tau = 4.5454545\\!\\times\\! 10^{-5}\\,\\mathrm{s}$。\n\n最终输出必须是单行，包含一个布尔值列表，每个案例一个，按 A、B、C、D、E 的顺序排列，使用 Python 的原生布尔字面量，并用方括号括起来，例如 $[{\\tt True},{\\tt False}]$。你的程序必须精确地产生这样的单行输出，不带任何附加文本。所有数值计算都必须使用国际单位制 (SI)，所有角度（如有）都必须以弧度表示，尽管本问题不需要角度输入。必须明确说明决策规则：如果 $\\mathrm{DBI} > \\epsilon$，则输出 ${\\tt True}$，否则输出 ${\\tt False}$，并给出你从推导中证明其合理性的 $\\epsilon$ 的具体数值。",
            "solution": "所述问题具有科学依据，是适定的、客观的，并包含唯一解所需的所有必要信息。它要求从基于玻尔兹曼输运方程 P1 近似的第一性原理出发，推导中子扩散近似失效的定量判据。这是反应堆物理学中一个标准且有效的练习。所有提供的数据在物理上都是合理的，并且在量纲上是一致的。\n\n### 步骤 1：提取已知条件\n单能含时中子输运方程如下：\n$$\\frac{1}{v}\\frac{\\partial \\psi(\\mathbf{r},\\mathbf{\\Omega},t)}{\\partial t} + \\mathbf{\\Omega}\\cdot \\nabla \\psi(\\mathbf{r},\\mathbf{\\Omega},t) + \\Sigma_t \\psi(\\mathbf{r},\\mathbf{\\Omega},t) = \\frac{\\Sigma_s}{4\\pi}\\phi(\\mathbf{r},t) + S(\\mathbf{r},\\mathbf{\\Omega},t)$$\n定义：\n- $v$: 中子速度，单位为 $\\mathrm{m/s}$\n- $\\Sigma_t$: 宏观总截面，单位为 $\\mathrm{m}^{-1}$\n- $\\Sigma_s$: 宏观散射截面，单位为 $\\mathrm{m}^{-1}$\n- $\\phi(\\mathbf{r},t) = \\int_{4\\pi} \\psi(\\mathbf{r},\\mathbf{\\Omega},t)\\, d\\mathbf{\\Omega}$: 标量通量\n- $S(\\mathbf{r},\\mathbf{\\Omega},t)$: 源项\n- $\\bar{\\mu}$: 平均散射余弦\n- $\\Sigma_{\\mathrm{tr}} = \\Sigma_t - \\bar{\\mu}\\,\\Sigma_s$: 输运截面\n- $\\lambda_{\\mathrm{tr}} = \\frac{1}{\\Sigma_{\\mathrm{tr}}}$: 输运平均自由程\n- $L$: 通量变化的特征空间尺度，单位为 $\\mathrm{m}$\n- $\\tau$: 特征瞬态时间尺度，单位为 $\\mathrm{s}$\n- $K = \\frac{\\lambda_{\\mathrm{tr}}}{L}$: 空间克努森数\n- $T = \\frac{v\\,\\tau}{\\lambda_{\\mathrm{tr}}}$: 瞬态尺度比\n\n测试案例：\n- 案例 A: $v = 2200\\,\\mathrm{m/s}$, $\\Sigma_t = 66\\,\\mathrm{m}^{-1}$, $\\Sigma_s = 65\\,\\mathrm{m}^{-1}$, $\\bar{\\mu} = 0.0$, $L = 0.5\\,\\mathrm{m}$, $\\tau = 0.1\\,\\mathrm{s}$.\n- 案例 B: $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$, $\\Sigma_t = 2.0\\,\\mathrm{m}^{-1}$, $\\Sigma_s = 1.5\\,\\mathrm{m}^{-1}$, $\\bar{\\mu} = 0.5$, $L = 0.05\\,\\mathrm{m}$, $\\tau = 1.0\\times 10^{-7}\\,\\mathrm{s}$.\n- 案例 C: $v = 2200\\,\\mathrm{m/s}$, $\\Sigma_t = 50\\,\\mathrm{m}^{-1}$, $\\Sigma_s = 49\\,\\mathrm{m}^{-1}$, $\\bar{\\mu} = 0.0$, $L = 0.25\\,\\mathrm{m}$, $\\tau = 1.090909\\times 10^{-4}\\,\\mathrm{s}$.\n- 案例 D: $v = 2200\\,\\mathrm{m/s}$, $\\Sigma_t = 50\\,\\mathrm{m}^{-1}$, $\\Sigma_s = 48\\,\\mathrm{m}^{-1}$, $\\bar{\\mu} = 0.9$, $L = 0.1\\,\\mathrm{m}$, $\\tau = 0.2\\,\\mathrm{s}$.\n- 案例 E: $v = 2200\\,\\mathrm{m/s}$, $\\Sigma_t = 100\\,\\mathrm{m}^{-1}$, $\\Sigma_s = 99\\,\\mathrm{m}^{-1}$, $\\bar{\\mu} = 0.0$, $L = 0.1\\,\\mathrm{m}$, $\\tau = 4.5454545\\times 10^{-5}\\,\\mathrm{s}$.\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是有效的。这是一个适定的物理问题，根植于中子输运理论的既定原则。任务是推导并应用一个用于判断扩散近似有效性的判据，这是核工程中的一个基本概念。该问题是自洽的，没有矛盾或科学错误。\n\n### 步骤 3：结论与行动\n该问题是有效的。下面将提供解决方案。\n\n### 扩散失效判据的推导\n\n扩散近似是从更基本的输运方程 P1 近似推导出来的。我们首先陈述 P1 方程，该方程是通过对输运方程取零阶和一阶角矩，并假设角通量呈线性各向异性：$\\psi(\\mathbf{r}, \\mathbf{\\Omega}, t) \\approx \\frac{1}{4\\pi}\\phi(\\mathbf{r}, t) + \\frac{3}{4\\pi}\\mathbf{\\Omega} \\cdot \\mathbf{J}(\\mathbf{r}, t)$ 而得到的。为简单起见，我们假设外部源 $S$ 是各向同性的，因此其一阶角矩为零。\n\n零阶矩（将输运方程对所有角度 $\\mathbf{\\Omega}$ 积分）给出了中子平衡或连续性方程：\n$$ \\frac{1}{v}\\frac{\\partial \\phi}{\\partial t} + \\nabla \\cdot \\mathbf{J} + \\Sigma_a \\phi = S_0 $$\n其中 $\\Sigma_a = \\Sigma_t - \\Sigma_s$ 是宏观吸收截面，$S_0$ 是各向同性源强度。\n\n一阶矩（将输运方程乘以 $\\mathbf{\\Omega}$ 并积分）得到中子流方程。在此方程中，引入对各向异性散射的输运修正，即用输运截面 $\\Sigma_{\\mathrm{tr}} = \\Sigma_t - \\bar{\\mu}\\Sigma_s$ 替换总截面，我们得到：\n$$ \\frac{1}{v}\\frac{\\partial \\mathbf{J}}{\\partial t} + \\frac{1}{3}\\nabla \\phi + \\Sigma_{\\mathrm{tr}}\\mathbf{J} = \\mathbf{0} $$\n该方程将中子流 $\\mathbf{J}$ 的时间演化与标量通量 $\\phi$ 的空间梯度联系起来。对中子流 $\\mathbf{J}$ 进行整理，我们得到：\n$$ \\mathbf{J} = -\\frac{1}{3\\Sigma_{\\mathrm{tr}}}\\nabla \\phi - \\frac{1}{v\\Sigma_{\\mathrm{tr}}}\\frac{\\partial \\mathbf{J}}{\\partial t} $$\n\n标准扩散近似做了两个关键简化：\n1.  **空间条件**：P1 近似本身有效。这要求中子布居接近各向同性，这在空间梯度较弱时成立。\n2.  **时间条件**：瞬态变化足够慢，以至于“惯性”项 $\\frac{1}{v}\\frac{\\partial \\mathbf{J}}{\\partial t}$ 与中子流方程中的其他项相比可以忽略不计。\n\n忽略惯性项即可得到我们熟悉的菲克扩散定律 (Fick's Law)：\n$$ \\mathbf{J}_{\\mathrm{diff}} \\approx -\\frac{1}{3\\Sigma_{\\mathrm{tr}}}\\nabla \\phi = -D\\nabla\\phi $$\n其中 $D = \\frac{1}{3\\Sigma_{\\mathrm{tr}}}$ 是扩散系数。当这两个基本条件中的一个或两个被违反时，扩散近似就会失效。\n\n**时间失效条件**\n忽略惯性项的合理性在于其量级远小于摩擦阻力项 $\\Sigma_{\\mathrm{tr}}\\mathbf{J}$：\n$$ \\left| \\frac{1}{v}\\frac{\\partial \\mathbf{J}}{\\partial t} \\right| \\ll |\\Sigma_{\\mathrm{tr}}\\mathbf{J}| $$\n为了评估这一点，我们使用空间特征尺度 $L$ 和时间特征尺度 $\\tau$。时间导数可以估计为 $|\\frac{\\partial \\mathbf{J}}{\\partial t}| \\sim \\frac{|\\mathbf{J}|}{\\tau}$。将其代入不等式得到：\n$$ \\frac{|\\mathbf{J}|}{v\\tau} \\ll \\Sigma_{\\mathrm{tr}}|\\mathbf{J}| \\implies \\frac{1}{v\\tau\\Sigma_{\\mathrm{tr}}} \\ll 1 $$\n使用已给出的定义 $\\lambda_{\\mathrm{tr}} = 1/\\Sigma_{\\mathrm{tr}}$ 和 $T = v\\tau/\\lambda_{\\mathrm{tr}}$，此条件变为：\n$$ \\frac{\\lambda_{\\mathrm{tr}}}{v\\tau} = \\frac{1}{T} \\ll 1 $$\n量 $1/T$ 是一个无量纲小参数，代表了时间近似误差的量级。\n\n**空间失效条件**\nP1 近似在线性项之后截断了通量的球谐函数展开。这种截断的准确性取决于各向异性的程度。相对于输运平均自由程的强空间梯度会驱动高各向异性。输运理论的一个标准结果是，P1 近似在标量通量等量中引入的相对误差约为 $(\\lambda_{\\mathrm{tr}}/L)^2$ 量级。为了使近似有效，这个误差必须很小：\n$$ \\left(\\frac{\\lambda_{\\mathrm{tr}}}{L}\\right)^2 = K^2 \\ll 1 $$\n量 $K^2$ 是一个无量纲小参数，代表了空间近似误差的量级。\n\n**扩散失效指数 (DBI) 和阈值 ($\\epsilon$)**\n扩散近似的总误差是 P1 闭合的空间误差和忽略惯性项的时间误差的集合。我们通过将这两个主要的、独立的误差参数相加，提出了一个扩散失效指数 ($\\mathrm{DBI}$) :\n$$ \\mathrm{DBI} = K^2 + \\frac{1}{T} = \\left(\\frac{\\lambda_{\\mathrm{tr}}}{L}\\right)^2 + \\frac{\\lambda_{\\mathrm{tr}}}{v\\tau} $$\n当该指数超过某个阈值时，认为扩散近似失效。在物理学和工程学中，如果一个近似的相对误差超过大约 $10\\%$ 或 $0.1$，通常认为它是无效的。采用这个惯例，我们设定失效阈值为 $\\epsilon = 0.1$。如果 $\\mathrm{DBI} > 0.1$，则认为扩散模型无效。\n\n**最终判据：** 扩散近似失效的定量判据是：\n$$ \\left(\\frac{1/\\Sigma_{\\mathrm{tr}}}{L}\\right)^2 + \\frac{1/\\Sigma_{\\mathrm{tr}}}{v\\tau} > 0.1 $$\n程序实现将为每个测试案例计算左侧的值，并将其与此阈值进行比较。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neutron diffusion breakdown problem for a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Thermal regime, large system, slow transient\n        {'name': 'A', 'v': 2200.0, 'Sigma_t': 66.0, 'Sigma_s': 65.0, 'mu_bar': 0.0, 'L': 0.5, 'tau': 0.1},\n        # Case B: Fast regime, small system, rapid transient, moderately forward scattering\n        {'name': 'B', 'v': 2.0e7, 'Sigma_t': 2.0, 'Sigma_s': 1.5, 'mu_bar': 0.5, 'L': 0.05, 'tau': 1.0e-7},\n        # Case C: Near-threshold case, weak gradients and modest transients\n        {'name': 'C', 'v': 2200.0, 'Sigma_t': 50.0, 'Sigma_s': 49.0, 'mu_bar': 0.0, 'L': 0.25, 'tau': 1.090909e-4},\n        # Case D: Thermal regime, strong anisotropy, small system, slow transient\n        {'name': 'D', 'v': 2200.0, 'Sigma_t': 50.0, 'Sigma_s': 48.0, 'mu_bar': 0.9, 'L': 0.1, 'tau': 0.2},\n        # Case E: Boundary-equality case\n        {'name': 'E', 'v': 2200.0, 'Sigma_t': 100.0, 'Sigma_s': 99.0, 'mu_bar': 0.0, 'L': 0.1, 'tau': 4.5454545e-5},\n    ]\n\n    # The breakdown threshold epsilon, justified in the derivation.\n    epsilon = 0.1\n\n    results = []\n    for case in test_cases:\n        # Extract parameters for the current case\n        v = case['v']\n        Sigma_t = case['Sigma_t']\n        Sigma_s = case['Sigma_s']\n        mu_bar = case['mu_bar']\n        L = case['L']\n        tau = case['tau']\n        \n        # Step 1: Calculate the transport cross section\n        Sigma_tr = Sigma_t - mu_bar * Sigma_s\n        \n        # Step 2: Calculate the transport mean free path\n        lambda_tr = 1.0 / Sigma_tr\n        \n        # Step 3: Calculate the spatial Knudsen number, K\n        K = lambda_tr / L\n        \n        # Step 4: Calculate the transient scale ratio, T\n        # T = v * tau / lambda_tr\n        # We need 1/T for the DBI calculation\n        one_over_T = lambda_tr / (v * tau)\n        \n        # Step 5: Calculate the Diffusion-Breakdown Index (DBI)\n        # DBI = K^2 + 1/T\n        dbi = K**2 + one_over_T\n        \n        # Step 6: Apply the breakdown criterion\n        is_breakdown = dbi > epsilon\n        results.append(is_breakdown)\n\n    # Final print statement in the exact required format.\n    # The output should be a list of Python boolean literals.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "确定了扩散模型的适用性之后，下一步是将连续的偏微分方程（PDE）转化为计算机可以求解的离散代数系统。本练习将通过应用强大的伽辽金有限元法（FEM），让你亲手构建一个实际的多群瞬态问题的核心矩阵：质量矩阵、刚度矩阵和裂变矩阵。掌握这一过程对于理解和开发先进的反应堆模拟程序至关重要。",
            "id": "4257505",
            "problem": "考虑一个有界反应堆区域 $\\Omega \\subset \\mathbb{R}^{3}$，其边界 $\\partial \\Omega$ 上的外单位法向量为 $\\mathbf{n}$。该边界被划分为三个不相交的部分：真空边界 $\\Gamma_{v}$、反照率边界 $\\Gamma_{a}$ 和反射边界 $\\Gamma_{r}$，因此 $\\partial \\Omega = \\Gamma_{v} \\cup \\Gamma_{a} \\cup \\Gamma_{r}$ 且 $\\Gamma_{v} \\cap \\Gamma_{a} \\cap \\Gamma_{r} = \\emptyset$。设有两个能群，标记为 $g=1$ (快中子群) 和 $g=2$ (热中子群)。每个群 $g$ 内的瞬态多群中子扩散方程由以下守恒律给出\n$$\n\\frac{1}{v_{g}(\\mathbf{x})}\\,\\frac{\\partial \\phi_{g}(\\mathbf{x},t)}{\\partial t}\n- \\nabla \\cdot \\big(D_{g}(\\mathbf{x})\\,\\nabla \\phi_{g}(\\mathbf{x},t)\\big)\n+ \\Sigma_{r,g}(\\mathbf{x})\\,\\phi_{g}(\\mathbf{x},t)\n- \\sum_{\\substack{h=1 \\\\ h \\neq g}}^{2}\\Sigma_{s,h \\to g}(\\mathbf{x})\\,\\phi_{h}(\\mathbf{x},t)\n= \\chi_{g}(\\mathbf{x}) \\sum_{h=1}^{2} \\nu(\\mathbf{x})\\,\\Sigma_{f,h}(\\mathbf{x})\\,\\phi_{h}(\\mathbf{x},t) + s_{g}(\\mathbf{x},t),\n$$\n对于 $(\\mathbf{x},t) \\in \\Omega \\times (0,T)$，其中 $v_{g}$ 是群 $g$ 中的中子速度，$D_{g}$ 是扩散系数，$\\Sigma_{r,g}$ 是移出截面（定义为 $\\Sigma_{r,g} = \\Sigma_{a,g} + \\sum_{h \\neq g}\\Sigma_{s,g \\to h}$，其中 $\\Sigma_{a,g}$ 是吸收截面），$\\Sigma_{s,h \\to g}$ 是从群 $h$ 到群 $g$ 的散射截面，$\\nu \\Sigma_{f,h}$ 是群 $h$ 中的裂变产生截面，$\\chi_{g}$ 是产生群 $g$ 中子的裂变谱份额，$s_{g}$ 是一个外部源。\n\n真空边界和反照率边界的边界条件为 Robin 型，反射边界的边界条件为 Neumann 型：\n$$\n- D_{g}(\\mathbf{x})\\,\\nabla \\phi_{g}(\\mathbf{x},t) \\cdot \\mathbf{n} = \\frac{1}{2}\\,\\phi_{g}(\\mathbf{x},t) \\quad \\text{on } \\Gamma_{v}, \\qquad\n- D_{g}(\\mathbf{x})\\,\\nabla \\phi_{g}(\\mathbf{x},t) \\cdot \\mathbf{n} = \\alpha_{g}(\\mathbf{x})\\,\\phi_{g}(\\mathbf{x},t) \\quad \\text{on } \\Gamma_{a},\n$$\n$$\n- D_{g}(\\mathbf{x})\\,\\nabla \\phi_{g}(\\mathbf{x},t) \\cdot \\mathbf{n} = 0 \\quad \\text{on } \\Gamma_{r},\n$$\n对于 $g=1,2$，其中 $\\alpha_{g}(\\mathbf{x})$ 是群 $g$ 中的反照率系数。\n\n使用 Galerkin 有限元法 (FEM)，令 $\\{N_{i}(\\mathbf{x})\\}_{i=1}^{N}$ 为 $H^{1}(\\Omega)$ 试探和检验空间的协调基。通过 $\\phi_{g}(\\mathbf{x},t) \\approx \\sum_{j=1}^{N} \\Phi_{g,j}(t)\\,N_{j}(\\mathbf{x})$ 近似每个群通量，并使用相同的基作为检验函数。将半离散弱形式组合成块矩阵瞬态系统\n$$\nM\\,\\partial_{t}\\Phi + K\\,\\Phi = F\\,\\Phi + S,\n$$\n其中 $\\Phi = \\big(\\Phi_{1,1},\\dots,\\Phi_{1,N},\\Phi_{2,1},\\dots,\\Phi_{2,N}\\big)^{\\top}$ 是自由度向量，$S$ 是对应于 $s_{g}$ 的组合源向量。构建 $M$、$K$ 和 $F$ 的显式 $2 \\times 2$ 块矩阵形式，将每个块元素写成在 $\\Omega$ 和 $\\partial \\Omega$ 上的积分形式，这些积分依赖于 $D_{g}$、$v_{g}$、$\\Sigma_{r,g}$、$\\Sigma_{s,h \\to g}$、$\\nu \\Sigma_{f,h}$、$\\chi_{g}$ 和 $\\alpha_{g}$，以及基函数 $N_{i}$。您的表达式必须包含给定的真空和反照率边界条件。将最终答案表示为三个块矩阵 $M$、$K$ 和 $F$。\n\n最终答案必须是单一的闭式解析表达式。不需要进行数值计算，最终答案中也不应包含单位。",
            "solution": "用户提供了计算核反应堆物理领域的一个有效问题陈述。任务是推导瞬态双群中子扩散方程的半离散有限元公式。\n\n起点是能群 $g$（其中 $g=1,2$）中子通量 $\\phi_g(\\mathbf{x},t)$ 的偏微分方程组：\n$$\n\\frac{1}{v_{g}(\\mathbf{x})}\\,\\frac{\\partial \\phi_{g}(\\mathbf{x},t)}{\\partial t}\n- \\nabla \\cdot \\big(D_{g}(\\mathbf{x})\\,\\nabla \\phi_{g}(\\mathbf{x},t)\\big)\n+ \\Sigma_{r,g}(\\mathbf{x})\\,\\phi_{g}(\\mathbf{x},t)\n- \\sum_{\\substack{h=1 \\\\ h \\neq g}}^{2}\\Sigma_{s,h \\to g}(\\mathbf{x})\\,\\phi_{h}(\\mathbf{x},t)\n= \\chi_{g}(\\mathbf{x}) \\sum_{h=1}^{2} \\nu(\\mathbf{x})\\,\\Sigma_{f,h}(\\mathbf{x})\\,\\phi_{h}(\\mathbf{x},t) + s_{g}(\\mathbf{x},t)\n$$\n为了推导弱形式，我们将每个群 $g$ 的方程乘以所选函数空间中的一个检验函数 $N_i(\\mathbf{x})$，并在反应堆区域 $\\Omega$ 上积分。索引 $i$ 从 1 到 $N$，其中 $N$ 是有限元离散中基函数（和节点）的数量。\n\n对于给定的群 $g$ 和检验函数 $N_i(\\mathbf{x})$：\n$$\n\\int_{\\Omega} N_i(\\mathbf{x}) \\frac{1}{v_{g}(\\mathbf{x})}\\frac{\\partial \\phi_{g}}{\\partial t} dV\n- \\int_{\\Omega} N_i(\\mathbf{x}) \\nabla \\cdot (D_{g}(\\mathbf{x})\\nabla \\phi_{g}) dV\n+ \\int_{\\Omega} N_i(\\mathbf{x}) \\Sigma_{r,g}(\\mathbf{x}) \\phi_{g} dV\n- \\int_{\\Omega} N_i(\\mathbf{x}) \\sum_{h \\neq g}\\Sigma_{s,h \\to g}(\\mathbf{x})\\phi_{h} dV\n= \\int_{\\Omega} N_i(\\mathbf{x}) \\chi_{g}(\\mathbf{x}) \\sum_{h=1}^{2} \\nu(\\mathbf{x})\\Sigma_{f,h}(\\mathbf{x})\\phi_{h} dV + \\int_{\\Omega} N_i(\\mathbf{x}) s_{g}(\\mathbf{x},t) dV\n$$\n扩散项（左边第二项）使用分部积分（Green 第一恒等式）处理：\n$$\n- \\int_{\\Omega} N_i(\\mathbf{x}) \\nabla \\cdot (D_{g}(\\mathbf{x})\\nabla \\phi_{g}) dV = \\int_{\\Omega} \\nabla N_i(\\mathbf{x}) \\cdot (D_{g}(\\mathbf{x})\\nabla \\phi_{g}) dV - \\int_{\\partial \\Omega} N_i(\\mathbf{x}) (D_{g}(\\mathbf{x})\\nabla \\phi_{g} \\cdot \\mathbf{n}) dS\n$$\n$\\partial\\Omega$ 上的边界积分被分解为三种指定的边界类型：$\\partial\\Omega = \\Gamma_v \\cup \\Gamma_a \\cup \\Gamma_r$。我们代入给定的边界条件：\n\\begin{itemize}\n    \\item 在 $\\Gamma_v$ 上：$-D_g \\nabla \\phi_g \\cdot \\mathbf{n} = \\frac{1}{2} \\phi_g$\n    \\item 在 $\\Gamma_a$ 上：$-D_g \\nabla \\phi_g \\cdot \\mathbf{n} = \\alpha_g \\phi_g$\n    \\item 在 $\\Gamma_r$ 上：$-D_g \\nabla \\phi_g \\cdot \\mathbf{n} = 0$\n\\end{itemize}\n边界积分项变为：\n$$\n- \\int_{\\partial \\Omega} N_i (D_{g}\\nabla \\phi_{g} \\cdot \\mathbf{n}) dS = \\int_{\\partial \\Omega} N_i (-D_{g}\\nabla \\phi_{g} \\cdot \\mathbf{n}) dS = \\int_{\\Gamma_v} N_i \\left(\\frac{1}{2}\\phi_g\\right) dS + \\int_{\\Gamma_a} N_i (\\alpha_g \\phi_g) dS + \\int_{\\Gamma_r} N_i (0) dS\n$$\n将此代回扩散项的弱形式，得到：\n$$\n- \\int_{\\Omega} N_i \\nabla \\cdot (D_{g}\\nabla \\phi_{g}) dV = \\int_{\\Omega} D_g \\nabla N_i \\cdot \\nabla \\phi_g dV + \\int_{\\Gamma_v} \\frac{1}{2} N_i \\phi_g dS + \\int_{\\Gamma_a} \\alpha_g N_i \\phi_g dS\n$$\n群 $g$ 的完整弱形式为：\n$$\n\\int_{\\Omega} \\frac{1}{v_g} N_i \\frac{\\partial \\phi_g}{\\partial t} dV + \\int_{\\Omega} D_g \\nabla N_i \\cdot \\nabla \\phi_g dV + \\int_{\\Omega} \\Sigma_{r,g} N_i \\phi_g dV + \\int_{\\Gamma_v} \\frac{1}{2} N_i \\phi_g dS + \\int_{\\Gamma_a} \\alpha_g N_i \\phi_g dS - \\sum_{h \\neq g} \\int_{\\Omega} \\Sigma_{s, h \\to g} N_i \\phi_h dV = \\sum_{h=1}^2 \\int_{\\Omega} \\chi_g \\nu \\Sigma_{f,h} N_i \\phi_h dV + \\int_{\\Omega} N_i s_g dV\n$$\n接下来，我们引入每个群中子通量的 Galerkin 有限元近似：\n$$\n\\phi_g(\\mathbf{x}, t) \\approx \\sum_{j=1}^{N} \\Phi_{g,j}(t) N_j(\\mathbf{x})\n$$\n其中 $\\Phi_{g,j}(t)$ 是群 $g$ 在节点 $j$ 处随时间变化的未知系数（自由度）。将此展开式代入每个群 $g \\in \\{1,2\\}$ 和每个检验函数索引 $i \\in \\{1,...,N\\}$ 的弱形式中，我们得到半离散系统。随时间变化的系数 $\\Phi_{g,j}(t)$ 被移到空间积分之外。\n\n对于 $g=1$：\n$$\n\\sum_{j=1}^{N} \\left(\\int_{\\Omega} \\frac{1}{v_1} N_i N_j dV\\right) \\frac{d\\Phi_{1,j}}{dt} + \\sum_{j=1}^{N} \\left(\\int_{\\Omega} (D_1 \\nabla N_i \\cdot \\nabla N_j + \\Sigma_{r,1} N_i N_j) dV + \\int_{\\Gamma_v} \\frac{1}{2} N_i N_j dS + \\int_{\\Gamma_a} \\alpha_1 N_i N_j dS\\right) \\Phi_{1,j} - \\sum_{j=1}^{N} \\left(\\int_{\\Omega} \\Sigma_{s,2 \\to 1} N_i N_j dV\\right) \\Phi_{2,j} = \\sum_{j=1}^{N} \\left(\\int_{\\Omega} \\chi_1 \\nu \\Sigma_{f,1} N_i N_j dV\\right) \\Phi_{1,j} + \\sum_{j=1}^{N} \\left(\\int_{\\Omega} \\chi_1 \\nu \\Sigma_{f,2} N_i N_j dV\\right) \\Phi_{2,j} + S_{1,i}\n$$\n对于 $g=2$：\n$$\n\\sum_{j=1}^{N} \\left(\\int_{\\Omega} \\frac{1}{v_2} N_i N_j dV\\right) \\frac{d\\Phi_{2,j}}{dt} + \\sum_{j=1}^{N} \\left(\\int_{\\Omega} (D_2 \\nabla N_i \\cdot \\nabla N_j + \\Sigma_{r,2} N_i N_j) dV + \\int_{\\Gamma_v} \\frac{1}{2} N_i N_j dS + \\int_{\\Gamma_a} \\alpha_2 N_i N_j dS\\right) \\Phi_{2,j} - \\sum_{j=1}^{N} \\left(\\int_{\\Omega} \\Sigma_{s,1 \\to 2} N_i N_j dV\\right) \\Phi_{1,j} = \\sum_{j=1}^{N} \\left(\\int_{\\Omega} \\chi_2 \\nu \\Sigma_{f,1} N_i N_j dV\\right) \\Phi_{1,j} + \\sum_{j=1}^{N} \\left(\\int_{\\Omega} \\chi_2 \\nu \\Sigma_{f,2} N_i N_j dV\\right) \\Phi_{2,j} + S_{2,i}\n$$\n其中 $S_{g,i}(t) = \\int_{\\Omega} N_i(\\mathbf{x}) s_g(\\mathbf{x},t) dV$。\n\n这些方程可以组合成块矩阵形式 $M\\,\\partial_{t}\\Phi + K\\,\\Phi = F\\,\\Phi + S$。未知数向量为 $\\Phi = [\\Phi_1^\\top, \\Phi_2^\\top]^\\top$，其中 $\\Phi_g = [\\Phi_{g,1}, ..., \\Phi_{g,N}]^\\top$。矩阵 $M$、$K$ 和 $F$ 是 $2 \\times 2$ 的块矩阵，其中每个块都是一个 $N \\times N$ 的矩阵。一个块的 $(i,j)$ 元素对应于基函数 $N_i$ 和 $N_j$ 之间的相互作用。\n\n块矩阵的元素通过匹配上述方程中 $\\partial_t \\Phi_{g,j}$ 和 $\\Phi_{g,j}$ 的系数来确定。为清晰起见，我们将子块矩阵 $X_{gh}$ 的第 $(i,j)$ 个元素表示为 $(X_{gh})_{ij}$。\n\n**质量矩阵 $M$**：来自时间导数项。\n$(M_{11})_{ij} = \\int_{\\Omega} \\frac{1}{v_1(\\mathbf{x})} N_i(\\mathbf{x}) N_j(\\mathbf{x}) dV$\n$(M_{22})_{ij} = \\int_{\\Omega} \\frac{1}{v_2(\\mathbf{x})} N_i(\\mathbf{x}) N_j(\\mathbf{x}) dV$\n群 $g$ 的时间导数仅依赖于 $\\phi_g$，因此 $M$ 是块对角矩阵：$(M_{12})_{ij} = (M_{21})_{ij} = 0$。\n\n**刚度/散射矩阵 $K$**：来自左侧的扩散、移出、边界和群内散射项。\n$(K_{11})_{ij} = \\int_{\\Omega} D_1(\\mathbf{x}) \\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) dV + \\int_{\\Omega} \\Sigma_{r,1}(\\mathbf{x}) N_i(\\mathbf{x}) N_j(\\mathbf{x}) dV + \\int_{\\Gamma_v} \\frac{1}{2} N_i(\\mathbf{x}) N_j(\\mathbf{x}) dS + \\int_{\\Gamma_a} \\alpha_1(\\mathbf{x}) N_i(\\mathbf{x}) N_j(\\mathbf{x}) dS$\n$(K_{12})_{ij} = - \\int_{\\Omega} \\Sigma_{s,2\\to 1}(\\mathbf{x}) N_i(\\mathbf{x}) N_j(\\mathbf{x}) dV$\n$(K_{21})_{ij} = - \\int_{\\Omega} \\Sigma_{s,1\\to 2}(\\mathbf{x}) N_i(\\mathbf{x}) N_j(\\mathbf{x}) dV$\n$(K_{22})_{ij} = \\int_{\\Omega} D_2(\\mathbf{x}) \\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) dV + \\int_{\\Omega} \\Sigma_{r,2}(\\mathbf{x}) N_i(\\mathbf{x}) N_j(\\mathbf{x}) dV + \\int_{\\Gamma_v} \\frac{1}{2} N_i(\\mathbf{x}) N_j(\\mathbf{x}) dS + \\int_{\\Gamma_a} \\alpha_2(\\mathbf{x}) N_i(\\mathbf{x}) N_j(\\mathbf{x}) dS$\n\n**裂变矩阵 $F$**：来自右侧的裂变产生项。\n$(F_{11})_{ij} = \\int_{\\Omega} \\chi_1(\\mathbf{x}) \\nu(\\mathbf{x}) \\Sigma_{f,1}(\\mathbf{x}) N_i(\\mathbf{x}) N_j(\\mathbf{x}) dV$\n$(F_{12})_{ij} = \\int_{\\Omega} \\chi_1(\\mathbf{x}) \\nu(\\mathbf{x}) \\Sigma_{f,2}(\\mathbf{x}) N_i(\\mathbf{x}) N_j(\\mathbf{x}) dV$\n$(F_{21})_{ij} = \\int_{\\Omega} \\chi_2(\\mathbf{x}) \\nu(\\mathbf{x}) \\Sigma_{f,1}(\\mathbf{x}) N_i(\\mathbf{x}) N_j(\\mathbf{x}) dV$\n$(F_{22})_{ij} = \\int_{\\Omega} \\chi_2(\\mathbf{x}) \\nu(\\mathbf{x}) \\Sigma_{f,2}(\\mathbf{x}) N_i(\\mathbf{x}) N_j(\\mathbf{x}) dV$\n\n这些表达式定义了块矩阵 $M$、$K$ 和 $F$ 的元素。每个积分代表一个 $N \\times N$ 矩阵，其 $(i,j)$ 元素由该积分给出。",
            "answer": "$$\n\\boxed{\n\\begin{gathered}\nM = \\begin{pmatrix}\n\\left[\\int\\limits_{\\Omega} \\frac{1}{v_1} N_i N_j dV\\right] & 0 \\\\\n0 & \\left[\\int\\limits_{\\Omega} \\frac{1}{v_2} N_i N_j dV\\right]\n\\end{pmatrix}\n\\\\[2em]\nK = \\begin{pmatrix}\n\\left[\\int\\limits_{\\Omega} \\left( D_1 \\nabla N_i \\cdot \\nabla N_j + \\Sigma_{r,1} N_i N_j \\right) dV + \\int\\limits_{\\Gamma_v} \\frac{1}{2} N_i N_j dS + \\int\\limits_{\\Gamma_a} \\alpha_1 N_i N_j dS\\right] & \\left[-\\int\\limits_{\\Omega} \\Sigma_{s,2 \\to 1} N_i N_j dV\\right] \\\\\n\\left[-\\int\\limits_{\\Omega} \\Sigma_{s,1 \\to 2} N_i N_j dV\\right] & \\left[\\int\\limits_{\\Omega} \\left( D_2 \\nabla N_i \\cdot \\nabla N_j + \\Sigma_{r,2} N_i N_j \\right) dV + \\int\\limits_{\\Gamma_v} \\frac{1}{2} N_i N_j dS + \\int\\limits_{\\Gamma_a} \\alpha_2 N_i N_j dS\\right]\n\\end{pmatrix}\n\\\\[2em]\nF = \\begin{pmatrix}\n\\left[\\int\\limits_{\\Omega} \\chi_1 \\nu \\Sigma_{f,1} N_i N_j dV\\right] & \\left[\\int\\limits_{\\Omega} \\chi_1 \\nu \\Sigma_{f,2} N_i N_j dV\\right] \\\\\n\\left[\\int\\limits_{\\Omega} \\chi_2 \\nu \\Sigma_{f,1} N_i N_j dV\\right] & \\left[\\int\\limits_{\\Omega} \\chi_2 \\nu \\Sigma_{f,2} N_i N_j dV\\right]\n\\end{pmatrix}\n\\end{gathered}\n}\n$$"
        },
        {
            "introduction": "空间离散化之后，我们得到一个大型常微分方程（ODE）组。解决瞬态问题的最后一步是随时间推进求解该方程组。本练习聚焦于数值积分的稳定性——这是确保模拟结果可靠性的一个关键概念。你将分析和比较几种常见的时间步进格式（如前向欧拉、后向欧拉和Crank-Nicolson方法），理解显式和隐式方法在稳定性和计算成本之间的权衡。",
            "id": "4257469",
            "problem": "考虑一个长度为 $L$ 的一维板状区域中的单群瞬态中子扩散方程，该区域具有均匀的材料性质，其真空边界被模拟为齐次狄利克雷条件。设中子通量为 $\\phi(x,t)$，扩散系数为 $D>0$，宏观吸收截面为 $\\Sigma_a \\ge 0$，中子速度为 $v>0$，外部源为 $S(x,t)$。控制方程和边界条件如下：\n$$\n\\frac{1}{v}\\,\\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial x}\\!\\left(D\\,\\frac{\\partial \\phi}{\\partial x}\\right) - \\Sigma_a\\,\\phi + S(x,t), \\quad x\\in(0,L),\\ t>0,\n$$\n$$\n\\phi(0,t)=0,\\quad \\phi(L,t)=0.\n$$\n将空间区域离散为 $N$ 个宽度为 $h=L/N$ 的等大、网格中心的有限体积，并用二阶中心通量近似扩散项。用 $\\phi_i(t)$ 表示在网格 $i$ 的中心 $x_i$ 处对 $\\phi(x,t)$ 的近似，其中 $i\\in\\{1,2,\\dots,N\\}$，并将这些近似值收集成向量 $\\boldsymbol{\\phi}(t)\\in\\mathbb{R}^N$。仅使用中子守恒定律、菲克定律和一致的有限体积通量平衡，构建以下形式的半离散系统：\n$$\n\\frac{1}{v}\\,\\frac{d\\boldsymbol{\\phi}}{dt} = A\\,\\boldsymbol{\\phi} + \\boldsymbol{s}(t),\n$$\n其中 $A\\in\\mathbb{R}^{N\\times N}$ 代表离散的扩散-移出算子，$\\boldsymbol{s}(t)$ 代表离散化的源。然后，通过对齐次系统进行模态分解并分析标量测试方程 $y'(t)=\\lambda\\,y(t)$，比较显式前向欧拉、隐式后向欧拉和 Crank-Nicolson (CN) 时间步进格式在复平面上的绝对稳定域，并为半离散扩散算子推导出相应的时间步长约束（如果存在）。\n\n在给定假设下，哪个选项正确地描述了矩阵 $A$ 的结构以及三种时间步进格式对半离散瞬态扩散系统的稳定性？\n\nA. 在齐次狄利克雷边界条件下，$A$ 是对称负定的，其谱为严格位于负半轴的实数。前向欧拉格式仅在 $\\Delta t \\le \\dfrac{2}{v\\,\\rho(A)}$ 时稳定，其中 $\\rho(A)=\\max_i|\\lambda_i(A)|$。后向欧拉格式是 A-稳定的，其绝对稳定域包含整个左半复平面。Crank-Nicolson 格式是 A-稳定的，但不是 L-稳定的，当 $|\\lambda|\\Delta t\\to\\infty$ 时，其放大因子的模长趋近于 1。\n\nB. 离散算子 $A$ 是正定的，因此对于任何 $\\Delta t>0$，前向欧拉、后向欧拉和 Crank-Nicolson 格式都是无条件稳定的。\n\nC. 前向欧拉格式当且仅当 $\\Delta t \\le \\dfrac{2}{v\\,|\\lambda_{\\min}(A)|}$ 时稳定，其中 $\\lambda_{\\min}(A)$ 是 $A$ 的模最小的特征值。Crank-Nicolson 格式是 L-稳定的，并且当 $\\Delta t\\to\\infty$ 时，会将所有刚性模式衰减至零。\n\nD. 后向欧拉格式是条件稳定的，其约束为 $\\Delta t \\le \\dfrac{1}{\\rho(A)}$，Crank-Nicolson 格式也具有相同的约束。后向欧拉和 Crank-Nicolson 格式的稳定域都不包含整个左半复平面。",
            "solution": "该问题要求分析一个半离散化的瞬态中子扩散方程，包括系统矩阵的性质以及常用时间步进格式的稳定性。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件：**\n-   **控制方程：** $\\frac{1}{v}\\,\\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial x}\\!\\left(D\\,\\frac{\\partial \\phi}{\\partial x}\\right) - \\Sigma_a\\,\\phi + S(x,t)$，对于 $x\\in(0,L)$ 和 $t>0$。\n-   **参数：** 扩散系数 $D>0$，宏观吸收截面 $\\Sigma_a \\ge 0$，中子速度 $v>0$。材料性质是均匀的。\n-   **区域：** 长度为 $L$ 的一维板状区域。\n-   **边界条件：** 齐次狄利克雷条件，$\\phi(0,t)=0$ 和 $\\phi(L,t)=0$。\n-   **离散化：** 采用 $N$ 个宽度为 $h=L/N$ 的等大网格的网格中心有限体积法。变量 $\\phi_i(t)$ 代表网格 $i$ 中的通量。\n-   **数值方法：** 采用二阶中心通量计算扩散项。\n-   **目标系统：** 半离散形式 $\\frac{1}{v}\\,\\frac{d\\boldsymbol{\\phi}}{dt} = A\\,\\boldsymbol{\\phi} + \\boldsymbol{s}(t)$。\n-   **任务：** 刻画矩阵 $A$ 的性质，并分析显式前向欧拉、隐式后向欧拉和 Crank-Nicolson 格式对系统齐次部分的稳定性。\n\n**1.2. 使用提取的已知条件进行验证：**\n-   **科学依据：** 单群瞬态中子扩散方程是核反应堆物理学中一个标准且基础的模型。有限体积法是求解此类守恒律的标准、稳健的数值技术。通过标量测试方程对时间积分格式进行稳定性分析是常微分方程（ODE）数值分析的基石。该问题在科学上是合理的。\n-   **适定性：** 问题陈述清晰地定义了物理模型、边界条件和离散化方法。推导半离散系统并分析其稳定性属性的任务是定义明确的数学练习。\n-   **客观性：** 该问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n-   **完整性与一致性：** 该问题提供了执行所要求分析的所有必要信息。参数（$D$, $\\Sigma_a$, $v$）得到了适当的约束。离散化方法已指定。没有内部矛盾。\n-   **真实性与可行性：** 该模型是一个在该领域内标准的、受物理驱动的简化模型。所要求的分析是在开发和研究用于反应堆模拟的数值方法中的一个常见任务。\n-   **结构及其他标准：** 该问题结构良好，非平凡，其结论可通过标准数学推导进行验证。\n\n**1.3. 结论与行动：**\n问题陈述有效。我将继续进行推导和分析。\n\n### 步骤2：推导与分析\n\n**2.1. 半离散系统矩阵 $A$ 的构建**\n\n我们应用有限体积法。对于一个以 $x_i$ 为中心、边界在 $x_{i-1/2}$ 和 $x_{i+1/2}$ 的通用网格 $i$，我们在该网格体积（在一维情况下，即宽度为 $h$ 的区间）上对控制方程进行积分：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{1}{v}\\,\\frac{\\partial \\phi}{\\partial t}\\,dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial}{\\partial x}\\!\\left(D\\,\\frac{\\partial \\phi}{\\partial x}\\right)\\,dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} \\Sigma_a\\,\\phi\\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} S(x,t)\\,dx\n$$\n对积分进行近似，并对扩散项使用微积分基本定理：\n$$\n\\frac{h}{v}\\frac{d\\phi_i}{dt} \\approx \\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{i+1/2}} - \\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{i-1/2}} - \\Sigma_a h \\phi_i + h S(x_i, t)\n$$\n问题指定了二阶中心通量。在网格交界面上的扩散通量使用中心差分进行近似：\n$$\n\\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{i+1/2}} \\approx D \\frac{\\phi_{i+1} - \\phi_i}{h}\n$$\n$$\n\\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{i-1/2}} \\approx D \\frac{\\phi_i - \\phi_{i-1}}{h}\n$$\n将这些代入内部网格（$i \\in \\{2, \\dots, N-1\\}$）的平衡方程，并除以 $h$ 可得：\n$$\n\\frac{1}{v}\\frac{d\\phi_i}{dt} = \\frac{D}{h^2}(\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}) - \\Sigma_a \\phi_i + S(x_i, t)\n$$\n对于边界网格，我们使用齐次狄利克雷条件 $\\phi(0,t)=0$ 和 $\\phi(L,t)=0$。设区域为 $x \\in [0,L]$。网格中心位于 $x_i = (i-1/2)h$，其中 $i=1,\\dots,N$。边界 $x=0$ 位于网格 1 的左侧面（$x_{1/2}$），边界 $x=L$ 位于网格 N 的右侧面（$x_{N+1/2}$）。\n\n对于网格 $i=1$：\n左边界 $x_{1/2}=0$ 处的通量使用边界条件 $\\phi(0)=0$ 和网格中心值 $\\phi_1$ 进行近似。从边界到网格中心 $x_1$ 的距离是 $h/2$。二阶近似为：\n$$\n\\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{1/2}=0} \\approx D \\frac{\\phi_1 - \\phi(0)}{h/2} = D \\frac{\\phi_1 - 0}{h/2} = \\frac{2D}{h}\\phi_1\n$$\n网格 1 的方程变为：\n$$\n\\frac{1}{v}\\frac{d\\phi_1}{dt} = \\frac{1}{h}\\left(D \\frac{\\phi_2 - \\phi_1}{h} - \\frac{2D}{h}\\phi_1\\right) - \\Sigma_a \\phi_1 + S(x_1, t) = \\frac{D}{h^2}(-3\\phi_1 + \\phi_2) - \\Sigma_a \\phi_1 + S(x_1, t)\n$$\n对于网格 $i=N$：\n根据对称性，使用 $\\phi(L)=0$：\n$$\n\\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{N+1/2}=L} \\approx D \\frac{\\phi(L) - \\phi_N}{h/2} = D \\frac{0 - \\phi_N}{h/2} = -\\frac{2D}{h}\\phi_N\n$$\n网格 N 的方程变为：\n$$\n\\frac{1}{v}\\frac{d\\phi_N}{dt} = \\frac{1}{h}\\left(-\\frac{2D}{h}\\phi_N - D \\frac{\\phi_N - \\phi_{N-1}}{h}\\right) - \\Sigma_a \\phi_N + S(x_N,t) = \\frac{D}{h^2}(\\phi_{N-1} - 3\\phi_N) - \\Sigma_a \\phi_N + S(x_N,t)\n$$\n将这些方程整理成矩阵形式 $\\frac{1}{v}\\,\\frac{d\\boldsymbol{\\phi}}{dt} = A\\,\\boldsymbol{\\phi} + \\boldsymbol{s}(t)$，矩阵 $A$ 为：\n$$\nA = \\frac{D}{h^2} \\begin{pmatrix}\n-3 & 1 &  &  & \\\\\n1 & -2 & 1 &  & \\\\\n & \\ddots & \\ddots & \\ddots & \\\\\n &  & 1 & -2 & 1 \\\\\n &  &  & 1 & -3\n\\end{pmatrix} - \\Sigma_a I\n$$\n矩阵 $A$ 显然是对称的。为了检查它是否为负定矩阵，我们对任意非零向量 $\\boldsymbol{x} \\in \\mathbb{R}^N$ 分析其二次型 $\\boldsymbol{x}^T A \\boldsymbol{x}$。令 $A_{diff}$ 为三对角矩阵部分。\n$$\n\\boldsymbol{x}^T A_{diff} \\boldsymbol{x} = \\boldsymbol{x}^T \\frac{D}{h^2} \\left( \\begin{pmatrix}\n-2 & 1 &  &  & \\\\\n1 & -2 & 1 &  & \\\\\n & \\ddots & \\ddots & \\ddots & \\\\\n &  & 1 & -2 & 1 \\\\\n &  &  & 1 & -2\n\\end{pmatrix} - \\begin{pmatrix} 1 & & \\\\ & 0 & \\\\ & & \\ddots \\\\ & & & 0 & \\\\ & & & & 1 \\end{pmatrix} \\right) \\boldsymbol{x}\n$$\n这可以改写为：\n$$\n\\boldsymbol{x}^T \\frac{h^2}{D} A_{diff} \\boldsymbol{x} = -x_1^2 - \\sum_{i=1}^{N-1}(x_i - x_{i+1})^2 - x_N^2 - x_1^2 - x_N^2 = -2x_1^2 - \\sum_{i=1}^{N-1}(x_i - x_{i+1})^2 - 2x_N^2\n$$\n这个形式是非正项之和。它仅在所有 $x_i$ 都为零时等于零，这意味着 $\\boldsymbol{x}=\\boldsymbol{0}$。因此，对于任何 $\\boldsymbol{x} \\neq \\boldsymbol{0}$，都有 $\\boldsymbol{x}^T A_{diff} \\boldsymbol{x} < 0$，使得 $A_{diff}$ 是负定的。\n矩阵 $A = A_{diff} - \\Sigma_a I$。由于 $D>0$ 且 $h^2>0$，$A_{diff}$ 是对称负定的。由于 $\\Sigma_a \\ge 0$，减去 $\\Sigma_a I$（一个半负定矩阵）会保持负定性。因此，$A$ 是一个对称负定矩阵。\n对称矩阵的一个性质是其特征值为实数。负定矩阵的一个性质是其所有特征值都严格为负。因此，$A$ 的谱 $\\sigma(A)$ 由严格为负的实数组成：$\\sigma(A) \\subset (-\\infty, 0)$。\n\n**2.2. 时间步进格式的稳定性分析**\n\n我们通过将格式应用于标量测试方程 $y'(t) = \\Lambda y(t)$ 来分析齐次系统 $\\frac{d\\boldsymbol{\\phi}}{dt} = vA\\boldsymbol{\\phi}$，其中 $\\Lambda$ 是矩阵 $vA$ 的一个特征值。由于 $\\lambda \\in \\sigma(A)$ 是实数且为负，并且 $v>0$，所以特征值 $\\Lambda = v\\lambda$ 也都是实数且为负。我们定义 $z = \\Lambda \\Delta t = v \\lambda \\Delta t < 0$。稳定性要求放大因子 $g(z)$ 的模 $|g(z)|$ 小于或等于 1。\n\n-   **前向欧拉 (FE):** 格式为 $\\boldsymbol{\\phi}^{n+1} = \\boldsymbol{\\phi}^n + \\Delta t (vA \\boldsymbol{\\phi}^n)$。\n    放大因子为 $g_{FE}(z) = 1+z$。\n    稳定性要求 $|1+z| \\le 1$。由于 $z$ 是负实数，这变为 $-1 \\le 1+z \\le 1$，简化为 $-2 \\le z \\le 0$。\n    因为 $z = v\\lambda\\Delta t$，这意味着 $\\Delta t \\le -2/(v\\lambda) = 2/(v|\\lambda|)$。\n    这个约束必须对 $A$ 的所有特征值 $\\lambda$ 都成立。最严格的条件来自于模最大的特征值，即谱半径 $\\rho(A) = \\max_i |\\lambda_i|$。\n    稳定性条件是 $\\Delta t \\le \\frac{2}{v\\,\\rho(A)}$。FE 是条件稳定的。\n\n-   **后向欧拉 (BE):** 格式为 $\\boldsymbol{\\phi}^{n+1} = \\boldsymbol{\\phi}^n + \\Delta t (vA \\boldsymbol{\\phi}^{n+1})$。\n    放大因子为 $g_{BE}(z) = \\frac{1}{1-z}$。\n    稳定性要求 $|1-z| \\ge 1$。对于左半复平面中的任何 $z$（即 $\\text{Re}(z) \\le 0$），令 $z=x+iy$ 且 $x\\le0$。则 $|1-z|^2 = (1-x)^2 + y^2 \\ge 1^2 + 0 = 1$。稳定域包含整个左半复平面。此性质称为 A-稳定性。对于我们的问题，由于所有特征值 $\\Lambda$ 都在负实轴上，因此对于任何 $\\Delta t > 0$，BE 都是无条件稳定的。\n    此外，我们检查 L-稳定性，它要求当 $\\text{Re}(z) \\to -\\infty$ 时 $|g(z)| \\to 0$。对于 BE，$\\lim_{z \\to -\\infty} |g_{BE}(z)| = \\lim_{z \\to -\\infty} |\\frac{1}{1-z}| = 0$。所以，BE 也是 L-稳定的，这意味着它能有效地衰减非常刚性（大的负特征值）的分量。\n\n-   **Crank-Nicolson (CN):** 格式为 $\\boldsymbol{\\phi}^{n+1} = \\boldsymbol{\\phi}^n + \\frac{\\Delta t}{2} (vA \\boldsymbol{\\phi}^n + vA \\boldsymbol{\\phi}^{n+1})$。\n    放大因子为 $g_{CN}(z) = \\frac{1+z/2}{1-z/2}$。\n    稳定性要求 $|1+z/2| \\le |1-z/2|$。令 $z=x+iy$。这等价于 $(1+x/2)^2+(y/2)^2 \\le (1-x/2)^2+(y/2)^2$，简化为 $x \\le 0$。稳定域是整个左半复平面，因此对于此问题，CN 是 A-稳定的和无条件稳定的。\n    为了检查 L-稳定性，我们取极限：$\\lim_{z \\to -\\infty} |g_{CN}(z)| = \\lim_{z \\to -\\infty} \\left|\\frac{1+z/2}{1-z/2}\\right| = \\left|\\frac{z/2}{-z/2}\\right| = 1$。由于极限不为 $0$，CN 不是 L-稳定的。对于刚性分量（$z=v\\lambda\\Delta t$ 是大的负数），放大因子接近 $-1$，这意味着这些分量不会被衰减，而是在步与步之间以振荡的形式持续存在。\n\n### 步骤3：逐项分析选项\n\n-   **选项 A:**\n    -   “在齐次狄利克雷边界条件下，$A$ 是对称负定的，其谱为严格位于负半轴的实数。”\n        -   这是 **正确的**，如 2.1 节所示。\n    -   “前向欧拉格式仅在 $\\Delta t \\le \\dfrac{2}{v\\,\\rho(A)}$ 时稳定，其中 $\\rho(A)=\\max_i|\\lambda_i(A)|$。”\n        -   这是 **正确的**，如 2.2 节中为 FE 格式推导的那样。该限制是由模最大的特征值施加的。\n    -   “后向欧拉格式是 $A$-稳定的，其绝对稳定域包含整个左半复平面。”\n        -   这是 **正确的**。BE 的稳定域是 $\\{z \\in \\mathbb{C} : |1-z| \\ge 1\\}$，它包含左半复平面。\n    -   “Crank–Nicolson 是 $A$-稳定的但不是 $L$-稳定的，当 $|\\lambda|\\Delta t\\to\\infty$ 时，其放大因子的模长趋近于 1。”\n        -   这是 **正确的**。CN 的稳定域是左半复平面（A-稳定），但对于大的负实部，其放大因子的模趋近于 1，所以它不是 L-稳定的。这对应于极限 $|\\lambda|\\Delta t\\to\\infty$。\n    -   选项 A 的总体结论：**正确**。\n\n-   **选项 B:**\n    -   “离散算子 $A$ 是正定的...”\n        -   这是 **不正确的**。该算子表示扩散和吸收，这些过程会移出中子。正定矩阵将具有正特征值，对应于一个不符合物理的、发散的系统。我们证明了 $A$ 是负定的。\n    -   选项 B 的总体结论：**不正确**。\n\n-   **选项 C:**\n    -   “前向欧拉格式当且仅当 $\\Delta t \\le \\dfrac{2}{v\\,|\\lambda_{\\min}(A)|}$ 时稳定，其中 $\\lambda_{\\min}(A)$ 是 $A$ 的模最小的特征值。”\n        -   这是 **不正确的**。显式方法的稳定性极限由模*最大*的特征值（谱半径 $\\rho(A)$）决定，该特征值对应于系统中最快的动力学行为。使用模最小的特征值将导致一个大得多的、不正确的时间步长限制。\n    -   “Crank–Nicolson 是 $L$-稳定的，并且当 $\\Delta t\\to\\infty$ 时，会将所有刚性模式衰减至零。”\n        -   这是 **不正确的**。CN 是众所周知的非 L-稳定格式。对于刚性模式，其放大因子趋近于 -1，导致持续的振荡而不是衰减。\n    -   选项 C 的总体结论：**不正确**。\n\n-   **选项 D:**\n    -   “后向欧拉格式是条件稳定的，其约束为 $\\Delta t \\le \\dfrac{1}{\\rho(A)}$...”。\n        -   这是 **不正确的**。后向欧拉是 A-稳定的，因此对于此问题是无条件稳定的。\n    -   “...Crank–Nicolson 也有相同的界限。”\n        -   这是 **不正确的**。Crank-Nicolson 也是 A-稳定的和无条件稳定的。\n    -   “后向欧拉和 Crank–Nicolson 的稳定域都不包含整个左半复平面。”\n        -   这是 **不正确的**。两者都是 A-稳定的，根据定义，这意味着它们的稳定域包含整个左半复平面。\n    -   选项 D 的总体结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}