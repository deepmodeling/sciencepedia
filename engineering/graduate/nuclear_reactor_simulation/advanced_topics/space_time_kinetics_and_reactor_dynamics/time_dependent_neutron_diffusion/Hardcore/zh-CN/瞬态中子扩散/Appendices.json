{
    "hands_on_practices": [
        {
            "introduction": "在深入研究中子扩散方程的复杂数值解法之前，物理学家或工程师首先必须理解模型本身的适用边界。本练习将引导你回归到更基本的中子输运方程，建立一个定量准则来评估扩散近似在不同物理情景（例如，快速瞬态或小尺寸系统）下的有效性。通过推导和应用扩散失效指数（DBI），你将学会如何判断何时可以信赖扩散理论，何时必须采用更高保真度的模型，从而培养严谨的物理直觉和负责任的建模习惯。",
            "id": "4257458",
            "problem": "考虑在无限均匀介质中的单能含时中子输运。其基本方程是线性 Boltzmann 输运方程，对于单能中子，该方程可以角通量密度形式写为\n$$\\frac{1}{v}\\frac{\\partial \\psi(\\mathbf{r},\\mathbf{\\Omega},t)}{\\partial t} + \\mathbf{\\Omega}\\cdot \\nabla \\psi(\\mathbf{r},\\mathbf{\\Omega},t) + \\Sigma_t \\psi(\\mathbf{r},\\mathbf{\\Omega},t) = \\frac{\\Sigma_s}{4\\pi}\\phi(\\mathbf{r},t) + S(\\mathbf{r},\\mathbf{\\Omega},t),$$\n其中 $v$ 是中子速度（单位：$\\mathrm{m/s}$），$\\Sigma_t$ 是宏观总截面（单位：$\\mathrm{m}^{-1}$），$\\Sigma_s$ 是宏观散射截面（单位：$\\mathrm{m}^{-1}$），$\\phi(\\mathbf{r},t) = \\int_{4\\pi} \\psi(\\mathbf{r},\\mathbf{\\Omega},t)\\, d\\mathbf{\\Omega}$ 是标量通量密度，而 $S$ 是源项。取零阶和一阶角矩可得到标量通量密度连续性方程和中子流方程。在一阶球谐函数 (P1) 闭合近似下，并引入平均散射余弦 $\\bar{\\mu}$，通过输运修正可得到输运截面\n$$\\Sigma_{\\mathrm{tr}} = \\Sigma_t - \\bar{\\mu}\\,\\Sigma_s,$$\n且流方程包含一个与 $\\frac{1}{v}\\frac{\\partial \\mathbf{J}}{\\partial t}$ 成正比的惯性项，其中 $\\mathbf{J}$ 是中子流。标准的扩散近似忽略了此惯性项，并假设 Fick 定律成立，即 $\\mathbf{J} \\approx -D\\nabla \\phi$，其中 $D = \\frac{1}{3\\Sigma_{\\mathrm{tr}}}$。该近似在梯度足够弱且瞬变足够慢时有效。\n\n您的任务是，从第一性原理出发，通过构建一个涉及特征长度尺度与平均自由程之比的定量判据，来论证在快速瞬变条件下扩散近似失效的条件。从输运方程及其 P1 矩开始，定义用于描述通量密度变化的特征空间尺度 $L$（单位：$\\mathrm{m}$）和用于描述时间变化的特征瞬变时间尺度 $\\tau$（单位：$\\mathrm{s}$），并推导衡量被忽略项相对大小的无量纲小参数。具体来说，使用以下参数推导判据：\n- 输运平均自由程 $\\lambda_{\\mathrm{tr}} = \\frac{1}{\\Sigma_{\\mathrm{tr}}}$（单位：$\\mathrm{m}$），\n- 空间 Knudsen 数 $K = \\frac{\\lambda_{\\mathrm{tr}}}{L}$，\n- 瞬变尺度比 $T = \\frac{v\\,\\tau}{\\lambda_{\\mathrm{tr}}}$，它比较了中子在瞬变时间尺度内行进的距离与平均自由程。\n\n利用这些参数，提出了一个综合空间和时间小量条件的单一标量指标 $\\mathrm{DBI}$（扩散失效指数），并指定一个定量阈值 $\\epsilon$，当 $\\mathrm{DBI}$ 超过 $\\epsilon$ 时，认为扩散近似失效。通过与 P1 闭合误差的数量级一致性来证明您选择 $\\epsilon$ 的合理性。\n\n然后，实现一个程序，针对一组指定的物理上合理的测试案例，根据您推导的判据，为每个案例计算一个布尔值，以指示扩散近似是否失效（True）或仍然有效（False）。程序必须使用以下测试组，其参数以一致的物理单位给出，并且必须为每个案例计算 $\\Sigma_{\\mathrm{tr}}$、$\\lambda_{\\mathrm{tr}}$、$K$、$T$ 以及您定义的 $\\mathrm{DBI}$：\n\n- 案例 A（热中子区，大系统，慢瞬变）：\n  - $v = 2200\\,\\mathrm{m/s}$，\n  - $\\Sigma_t = 66\\,\\mathrm{m}^{-1}$，\n  - $\\Sigma_s = 65\\,\\mathrm{m}^{-1}$，\n  - $\\bar{\\mu} = 0.0$，\n  - $L = 0.5\\,\\mathrm{m}$，\n  - $\\tau = 0.1\\,\\mathrm{s}$。\n\n- 案例 B（快中子区，小系统，快瞬变，中度前向散射）：\n  - $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$，\n  - $\\Sigma_t = 2.0\\,\\mathrm{m}^{-1}$，\n  - $\\Sigma_s = 1.5\\,\\mathrm{m}^{-1}$，\n  - $\\bar{\\mu} = 0.5$，\n  - $L = 0.05\\,\\mathrm{m}$，\n  - $\\tau = 1.0\\times 10^{-7}\\,\\mathrm{s}$。\n\n- 案例 C（近阈值案例，弱梯度和中等瞬变）：\n  - $v = 2200\\,\\mathrm{m/s}$，\n  - $\\Sigma_t = 50\\,\\mathrm{m}^{-1}$，\n  - $\\Sigma_s = 49\\,\\mathrm{m}^{-1}$，\n  - $\\bar{\\mu} = 0.0$，\n  - $L = 0.25\\,\\mathrm{m}$，\n  - $\\tau = 1.090909 \\times 10^{-4}\\,\\mathrm{s}$。\n\n- 案例 D（热中子区，导致大输运平均自由程的强各向异性，小系统，慢瞬变）：\n  - $v = 2200\\,\\mathrm{m/s}$，\n  - $\\Sigma_t = 50\\,\\mathrm{m}^{-1}$，\n  - $\\Sigma_s = 48\\,\\mathrm{m}^{-1}$，\n  - $\\bar{\\mu} = 0.9$，\n  - $L = 0.1\\,\\mathrm{m}$，\n  - $\\tau = 0.2\\,\\mathrm{s}$。\n\n- 案例 E（边界等式案例）：\n  - $v = 2200\\,\\mathrm{m/s}$，\n  - $\\Sigma_t = 100\\,\\mathrm{m}^{-1}$，\n  - $\\Sigma_s = 99\\,\\mathrm{m}^{-1}$，\n  - $\\bar{\\mu} = 0.0$，\n  - $L = 0.1\\,\\mathrm{m}$，\n  - $\\tau = 4.5454545 \\times 10^{-5}\\,\\mathrm{s}$。\n\n最终输出必须是单行内容，包含一个布尔值列表，每个案例一个，按 A、B、C、D、E 的顺序排列，使用 Python 的原生布尔字面量，并用方括号括起来，例如 $[{\\tt True},{\\tt False}]$。您的程序必须准确生成这样的单行输出，不含任何额外文本。所有数值计算都必须使用国际单位制 (SI)，所有角度（如有）都必须以弧度表示，尽管此问题不需要角度输入。决策规则必须明确说明：如果 $\\mathrm{DBI} > \\epsilon$，则输出 ${\\tt True}$，否则输出 ${\\tt False}$，并为您从推导中证明的 $\\epsilon$ 提供具体的数值。",
            "solution": "所述问题具有科学依据，定义明确，客观，并包含唯一解所需的所有必要信息。它要求从基于 Boltzmann 输运方程 P1 近似的第一性原理出发，推导中子扩散近似失效的定量判据。这是反应堆物理学中一个标准且有效练习。所有提供的数据在物理上都是合理的，并且量纲一致。\n\n### 步骤 1：提取已知条件\n单能含时中子输运方程如下：\n$$\\frac{1}{v}\\frac{\\partial \\psi(\\mathbf{r},\\mathbf{\\Omega},t)}{\\partial t} + \\mathbf{\\Omega}\\cdot \\nabla \\psi(\\mathbf{r},\\mathbf{\\Omega},t) + \\Sigma_t \\psi(\\mathbf{r},\\mathbf{\\Omega},t) = \\frac{\\Sigma_s}{4\\pi}\\phi(\\mathbf{r},t) + S(\\mathbf{r},\\mathbf{\\Omega},t)$$\n定义：\n- $v$：中子速度（单位：$\\mathrm{m/s}$）\n- $\\Sigma_t$：宏观总截面（单位：$\\mathrm{m}^{-1}$）\n- $\\Sigma_s$：宏观散射截面（单位：$\\mathrm{m}^{-1}$）\n- $\\phi(\\mathbf{r},t) = \\int_{4\\pi} \\psi(\\mathbf{r},\\mathbf{\\Omega},t)\\, d\\mathbf{\\Omega}$：标量通量密度\n- $S(\\mathbf{r},\\mathbf{\\Omega},t)$：源项\n- $\\bar{\\mu}$：平均散射余弦\n- $\\Sigma_{\\mathrm{tr}} = \\Sigma_t - \\bar{\\mu}\\,\\Sigma_s$：输运截面\n- $\\lambda_{\\mathrm{tr}} = \\frac{1}{\\Sigma_{\\mathrm{tr}}}$：输运平均自由程\n- $L$：通量密度变化的特征空间尺度（单位：$\\mathrm{m}$）\n- $\\tau$：特征瞬变时间尺度（单位：$\\mathrm{s}$）\n- $K = \\frac{\\lambda_{\\mathrm{tr}}}{L}$：空间 Knudsen 数\n- $T = \\frac{v\\,\\tau}{\\lambda_{\\mathrm{tr}}}$：瞬变尺度比\n\n测试案例：\n- 案例 A：$v = 2200\\,\\mathrm{m/s}$, $\\Sigma_t = 66\\,\\mathrm{m}^{-1}$, $\\Sigma_s = 65\\,\\mathrm{m}^{-1}$, $\\bar{\\mu} = 0.0$, $L = 0.5\\,\\mathrm{m}$, $\\tau = 0.1\\,\\mathrm{s}$。\n- 案例 B：$v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$, $\\Sigma_t = 2.0\\,\\mathrm{m}^{-1}$, $\\Sigma_s = 1.5\\,\\mathrm{m}^{-1}$, $\\bar{\\mu} = 0.5$, $L = 0.05\\,\\mathrm{m}$, $\\tau = 1.0\\times 10^{-7}\\,\\mathrm{s}$。\n- 案例 C：$v = 2200\\,\\mathrm{m/s}$, $\\Sigma_t = 50\\,\\mathrm{m}^{-1}$, $\\Sigma_s = 49\\,\\mathrm{m}^{-1}$, $\\bar{\\mu} = 0.0$, $L = 0.25\\,\\mathrm{m}$, $\\tau = 1.090909\\times 10^{-4}\\,\\mathrm{s}$。\n- 案例 D：$v = 2200\\,\\mathrm{m/s}$, $\\Sigma_t = 50\\,\\mathrm{m}^{-1}$, $\\Sigma_s = 48\\,\\mathrm{m}^{-1}$, $\\bar{\\mu} = 0.9$, $L = 0.1\\,\\mathrm{m}$, $\\tau = 0.2\\,\\mathrm{s}$。\n- 案例 E：$v = 2200\\,\\mathrm{m/s}$, $\\Sigma_t = 100\\,\\mathrm{m}^{-1}$, $\\Sigma_s = 99\\,\\mathrm{m}^{-1}$, $\\bar{\\mu} = 0.0$, $L = 0.1\\,\\mathrm{m}$, $\\tau = 4.5454545\\times 10^{-5}\\,\\mathrm{s}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题是有效的。这是一个定义明确的物理问题，植根于中子输运理论的既定原则。任务是推导并应用一个扩散近似有效性的判据，这是核工程中的一个基本概念。该问题是自洽的，没有矛盾或科学错误。\n\n### 步骤 3：结论与行动\n问题是有效的。下面将提供解答。\n\n### 扩散失效判据的推导\n\n扩散近似是从更基本的输运方程 P1 近似推导出来的。我们首先陈述 P1 方程，该方程是通过对输运方程取零阶和一阶角矩，并假设角通量密度为线性各向异性而得到的：$\\psi(\\mathbf{r}, \\mathbf{\\Omega}, t) \\approx \\frac{1}{4\\pi}\\phi(\\mathbf{r}, t) + \\frac{3}{4\\pi}\\mathbf{\\Omega} \\cdot \\mathbf{J}(\\mathbf{r}, t)$。为简单起见，我们假设外部源 $S$ 是各向同性的，因此其一阶角矩为零。\n\n零阶矩（将输运方程对所有角度 $\\mathbf{\\Omega}$ 积分）给出了中子平衡或连续性方程：\n$$ \\frac{1}{v}\\frac{\\partial \\phi}{\\partial t} + \\nabla \\cdot \\mathbf{J} + \\Sigma_a \\phi = S_0 $$\n其中 $\\Sigma_a = \\Sigma_t - \\Sigma_s$ 是宏观吸收截面，$S_0$ 是各向同性源强度。\n\n一阶矩（将输运方程乘以 $\\mathbf{\\Omega}$ 并积分）得到了流方程。在此方程中，引入对各向异性散射的输运修正，即用输运截面 $\\Sigma_{\\mathrm{tr}} = \\Sigma_t - \\bar{\\mu}\\Sigma_s$ 替代总截面，我们得到：\n$$ \\frac{1}{v}\\frac{\\partial \\mathbf{J}}{\\partial t} + \\frac{1}{3}\\nabla \\phi + \\Sigma_{\\mathrm{tr}}\\mathbf{J} = \\mathbf{0} $$\n该方程将流 $\\mathbf{J}$ 的时间演化与标量通量密度 $\\phi$ 的空间梯度联系起来。对中子流 $\\mathbf{J}$ 进行整理，我们得到：\n$$ \\mathbf{J} = -\\frac{1}{3\\Sigma_{\\mathrm{tr}}}\\nabla \\phi - \\frac{1}{v\\Sigma_{\\mathrm{tr}}}\\frac{\\partial \\mathbf{J}}{\\partial t} $$\n\n标准的扩散近似做了两个关键简化：\n1.  **空间条件**：P1 近似本身是有效的。这要求中子群是近各向同性的，当空间梯度较弱时此条件成立。\n2.  **时间条件**：瞬变足够慢，以至于“惯性”项 $\\frac{1}{v}\\frac{\\partial \\mathbf{J}}{\\partial t}$ 与流方程中的其他项相比可以忽略不计。\n\n忽略惯性项可得到我们熟悉的 Fick 扩散定律：\n$$ \\mathbf{J}_{\\mathrm{diff}} \\approx -\\frac{1}{3\\Sigma_{\\mathrm{tr}}}\\nabla \\phi = -D\\nabla\\phi $$\n其中 $D = \\frac{1}{3\\Sigma_{\\mathrm{tr}}}$ 是扩散系数。当这两个基本条件中的一个或两个被违反时，扩散近似就会失效。\n\n**时间失效条件**\n当惯性项的量级远小于摩擦阻力项 $\\Sigma_{\\mathrm{tr}}\\mathbf{J}$ 时，忽略惯性项是合理的：\n$$ \\left| \\frac{1}{v}\\frac{\\partial \\mathbf{J}}{\\partial t} \\right| \\ll |\\Sigma_{\\mathrm{tr}}\\mathbf{J}| $$\n为评估此条件，我们使用空间特征尺度 $L$ 和时间特征尺度 $\\tau$。时间导数可估计为 $|\\frac{\\partial \\mathbf{J}}{\\partial t}| \\sim \\frac{|\\mathbf{J}|}{\\tau}$。将此代入不等式得到：\n$$ \\frac{|\\mathbf{J}|}{v\\tau} \\ll \\Sigma_{\\mathrm{tr}}|\\mathbf{J}| \\implies \\frac{1}{v\\tau\\Sigma_{\\mathrm{tr}}} \\ll 1 $$\n使用已给出的定义 $\\lambda_{\\mathrm{tr}} = 1/\\Sigma_{\\mathrm{tr}}$ 和 $T = v\\tau/\\lambda_{\\mathrm{tr}}$，该条件变为：\n$$ \\frac{\\lambda_{\\mathrm{tr}}}{v\\tau} = \\frac{1}{T} \\ll 1 $$\n量 $1/T$ 是一个无量纲小参数，代表时间近似误差的量级。\n\n**空间失效条件**\nP1 近似在展开通量密度的球谐函数时，截断了线性项之后的部分。这种截断的准确性取决于各向异性的程度。相对于输运平均自由程的强空间梯度会驱动高各向异性。输运理论中的一个标准结果是，P1 近似在标量通量密度等量上引入的相对误差是 $(\\lambda_{\\mathrm{tr}}/L)^2$ 的量级。为使近似有效，此误差必须很小：\n$$ \\left(\\frac{\\lambda_{\\mathrm{tr}}}{L}\\right)^2 = K^2 \\ll 1 $$\n量 $K^2$ 是一个无量纲小参数，代表空间近似误差的量级。\n\n**扩散失效指数 (DBI) 和阈值 ($\\epsilon$)**\n扩散近似的总误差是来自 P1 闭合的空间误差和来自忽略惯性项的时间误差的集合。我们通过将这两个主要的、独立的误差参数相加，提出了一个扩散失效指数 ($\\mathrm{DBI}$) :\n$$ \\mathrm{DBI} = K^2 + \\frac{1}{T} = \\left(\\frac{\\lambda_{\\mathrm{tr}}}{L}\\right)^2 + \\frac{\\lambda_{\\mathrm{tr}}}{v\\tau} $$\n当该指数超过某一阈值时，认为扩散近似失效。在物理学和工程学中，如果一个近似的相对误差超过约 $10\\%$ 或 $0.1$，通常认为该近似无效。采用这一惯例，我们设定失效阈值为 $\\epsilon = 0.1$。如果 $\\mathrm{DBI} > 0.1$，则认为扩散模型无效。\n\n**最终判据：**扩散近似失效的定量判据是：\n$$ \\left(\\frac{1/\\Sigma_{\\mathrm{tr}}}{L}\\right)^2 + \\frac{1/\\Sigma_{\\mathrm{tr}}}{v\\tau} > 0.1 $$\n实现将为每个测试案例计算左侧的值，并将其与此阈值进行比较。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neutron diffusion breakdown problem for a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Thermal regime, large system, slow transient\n        {'name': 'A', 'v': 2200.0, 'Sigma_t': 66.0, 'Sigma_s': 65.0, 'mu_bar': 0.0, 'L': 0.5, 'tau': 0.1},\n        # Case B: Fast regime, small system, rapid transient, moderately forward scattering\n        {'name': 'B', 'v': 2.0e7, 'Sigma_t': 2.0, 'Sigma_s': 1.5, 'mu_bar': 0.5, 'L': 0.05, 'tau': 1.0e-7},\n        # Case C: Near-threshold case, weak gradients and modest transients\n        {'name': 'C', 'v': 2200.0, 'Sigma_t': 50.0, 'Sigma_s': 49.0, 'mu_bar': 0.0, 'L': 0.25, 'tau': 1.090909e-4},\n        # Case D: Thermal regime, strong anisotropy, small system, slow transient\n        {'name': 'D', 'v': 2200.0, 'Sigma_t': 50.0, 'Sigma_s': 48.0, 'mu_bar': 0.9, 'L': 0.1, 'tau': 0.2},\n        # Case E: Boundary-equality case\n        {'name': 'E', 'v': 2200.0, 'Sigma_t': 100.0, 'Sigma_s': 99.0, 'mu_bar': 0.0, 'L': 0.1, 'tau': 4.5454545e-5},\n    ]\n\n    # The breakdown threshold epsilon, justified in the derivation.\n    epsilon = 0.1\n\n    results = []\n    for case in test_cases:\n        # Extract parameters for the current case\n        v = case['v']\n        Sigma_t = case['Sigma_t']\n        Sigma_s = case['Sigma_s']\n        mu_bar = case['mu_bar']\n        L = case['L']\n        tau = case['tau']\n        \n        # Step 1: Calculate the transport cross section\n        Sigma_tr = Sigma_t - mu_bar * Sigma_s\n        \n        # Step 2: Calculate the transport mean free path\n        lambda_tr = 1.0 / Sigma_tr\n        \n        # Step 3: Calculate the spatial Knudsen number, K\n        K = lambda_tr / L\n        \n        # Step 4: Calculate the transient scale ratio, T\n        # T = v * tau / lambda_tr\n        # We need 1/T for the DBI calculation\n        one_over_T = lambda_tr / (v * tau)\n        \n        # Step 5: Calculate the Diffusion-Breakdown Index (DBI)\n        # DBI = K^2 + 1/T\n        dbi = K**2 + one_over_T\n        \n        # Step 6: Apply the breakdown criterion\n        is_breakdown = dbi > epsilon\n        results.append(is_breakdown)\n\n    # Final print statement in the exact required format.\n    # The output should be a list of Python boolean literals.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "确立了扩散模型的适用范围后，下一步便是对其进行数值求解。本实践聚焦于数值求解的两个核心步骤：首先通过空间离散化将偏微分方程（PDE）转化为常微分方程组（ODE），即半离散化；然后选择合适的时间积分方案求解该方程组。通过分析几种常用时间积分格式（如前向欧拉、后向欧拉和Crank-Nicolson方法）的稳定性，你将深刻理解为何时间步长的选择以及积分格式的内在属性对于获得稳定且有物理意义的解至关重要，特别是对于反应堆物理中常见的刚性问题。",
            "id": "4257469",
            "problem": "考虑一个长度为 $L$ 的一维平板中的单群瞬态中子扩散方程，该平板具有均匀的材料性质，其真空边界被建模为齐次狄利克雷条件。令中子通量为 $\\phi(x,t)$，扩散系数为 $D>0$，宏观吸收截面为 $\\Sigma_a \\ge 0$，中子速度为 $v>0$，外部源为 $S(x,t)$。控制方程和边界条件如下：\n$$\n\\frac{1}{v}\\,\\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial x}\\!\\left(D\\,\\frac{\\partial \\phi}{\\partial x}\\right) - \\Sigma_a\\,\\phi + S(x,t), \\quad x\\in(0,L),\\ t>0,\n$$\n$$\n\\phi(0,t)=0,\\quad \\phi(L,t)=0.\n$$\n将空间区域离散为 $N$ 个等宽（宽度 $h=L/N$）的、以单元为中心的有限体积，并用二阶中心通量近似扩散项。用 $\\phi_i(t)$ 表示在单元 $i$（$i\\in\\{1,2,\\dots,N\\}$）的中心 $x_i$ 处 $\\phi(x,t)$ 的近似值，并将这些值汇集到向量 $\\boldsymbol{\\phi}(t)\\in\\mathbb{R}^N$ 中。仅使用中子守恒定律、Fick 定律和一致的有限体积通量平衡，建立如下形式的半离散系统：\n$$\n\\frac{1}{v}\\,\\frac{d\\boldsymbol{\\phi}}{dt} = A\\,\\boldsymbol{\\phi} + \\boldsymbol{s}(t),\n$$\n其中 $A\\in\\mathbb{R}^{N\\times N}$ 是离散的扩散-移出算子，$\\boldsymbol{s}(t)$ 是离散化的源项。然后，通过对齐次系统进行模态分解并分析标量测试方程 $y'(t)=\\lambda\\,y(t)$，比较显式前向欧拉、隐式后向欧拉和 Crank–Nicolson (CN) 时间步进格式在复平面上的绝对稳定区域，并为半离散扩散算子推导出相应的时间步长约束（如果存在）。\n\n在所述假设下，哪个选项正确地刻画了矩阵 $A$ 的结构以及三种时间步进格式对于半离散瞬态扩散系统的稳定性？\n\nA. 在齐次狄利克雷边界条件下，$A$ 是对称负定的，其谱为严格位于负实轴上的实数。仅当 $\\Delta t \\le \\dfrac{2}{v\\,\\rho(A)}$（其中 $\\rho(A)=\\max_i|\\lambda_i(A)|$）时，前向欧拉格式是稳定的。后向欧拉格式是 A-稳定的，其绝对稳定域包含整个左半复平面。Crank-Nicolson 格式是 A-稳定的但不是 L-稳定的，当 $|\\lambda|\\Delta t\\to\\infty$ 时，其放大因子的幅值趋近于 1。\n\nB. 离散算子 $A$ 是正定的，因此对于任何 $\\Delta t>0$，前向欧拉、后向欧拉和 Crank-Nicolson 格式都是无条件稳定的。\n\nC. 仅当 $\\Delta t \\le \\dfrac{2}{v\\,|\\lambda_{\\min}(A)|}$（其中 $\\lambda_{\\min}(A)$ 是 $A$ 的模最小的特征值）时，前向欧拉格式是稳定的。Crank-Nicolson 格式是 L-稳定的，并且当 $\\Delta t\\to\\infty$ 时，将所有刚性模式衰减至零。\n\nD. 后向欧拉格式是条件稳定的，其约束为 $\\Delta t \\le \\dfrac{1}{\\rho(A)}$，Crank-Nicolson 格式也有相同的约束。后向欧拉和 Crank-Nicolson 格式的稳定域都不包含整个左半复平面。",
            "solution": "该问题要求分析一个半离散化的瞬态中子扩散方程，包括系统矩阵的性质和常用时间步进格式的稳定性。\n\n### 第 1 步：问题验证\n\n**1.1. 提取已知条件：**\n-   **控制方程：** $\\frac{1}{v}\\,\\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial x}\\!\\left(D\\,\\frac{\\partial \\phi}{\\partial x}\\right) - \\Sigma_a\\,\\phi + S(x,t)$，对于 $x\\in(0,L)$ 和 $t0$。\n-   **参数：** 扩散系数 $D0$，宏观吸收截面 $\\Sigma_a \\ge 0$，中子速度 $v0$。材料性质是均匀的。\n-   **区域：** 长度为 $L$ 的一维平板。\n-   **边界条件：** 齐次狄利克雷条件，$\\phi(0,t)=0$ 和 $\\phi(L,t)=0$。\n-   **离散化：** 采用 $N$ 个等宽（宽度 $h=L/N$）的、以单元为中心的有限体积法。变量 $\\phi_i(t)$ 代表单元 $i$ 中的通量。\n-   **数值方法：** 使用二阶中心通量近似扩散项。\n-   **目标系统：** 半离散形式 $\\frac{1}{v}\\,\\frac{d\\boldsymbol{\\phi}}{dt} = A\\,\\boldsymbol{\\phi} + \\boldsymbol{s}(t)$。\n-   **任务：** 刻画矩阵 $A$ 的性质，并分析显式前向欧拉、隐式后向欧拉和 Crank-Nicolson 格式对该系统齐次部分的稳定性。\n\n**1.2. 使用提取的已知条件进行验证：**\n-   **科学依据：** 单群、瞬态中子扩散方程是核反应堆物理学中的一个标准且基本的模型。有限体积法是求解此类守恒律的标准、稳健的数值技术。通过标量测试方程对时间积分格式进行稳定性分析是常微分方程（ODE）数值分析的基石。该问题具有科学合理性。\n-   **适定性：** 问题陈述清晰地定义了物理模型、边界条件和离散化方法。推导半离散系统并分析其稳定性属性这些任务是明确定义的数学练习。\n-   **客观性：** 问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n-   **完整性与一致性：** 问题提供了执行所要求分析的所有必要信息。参数（$D$, $\\Sigma_a$, $v$）被恰当约束。离散化方法已指定。没有内部矛盾。\n-   **现实性与可行性：** 该模型是一个具有物理动机的简化模型，是该领域的标准模型。所要求的分析是在开发和研究用于反应堆模拟的数值方法中的一项常见任务。\n-   **结构与其他标准：** 该问题结构良好、并非无足轻重，并且其结论可通过标准的数学推导进行验证。\n\n**1.3. 结论与行动：**\n问题陈述有效。我将继续进行推导和分析。\n\n### 第 2 步：推导与分析\n\n**2.1. 构建半离散系统矩阵 $A$**\n\n我们应用有限体积法。对于一个以 $x_i$ 为中心、边界在 $x_{i-1/2}$ 和 $x_{i+1/2}$ 的通用单元 $i$，我们在单元体积（在一维情况下，即宽度为 $h$ 的区间）上对控制方程进行积分：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{1}{v}\\,\\frac{\\partial \\phi}{\\partial t}\\,dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial}{\\partial x}\\!\\left(D\\,\\frac{\\partial \\phi}{\\partial x}\\right)\\,dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} \\Sigma_a\\,\\phi\\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} S(x,t)\\,dx\n$$\n近似这些积分，并对扩散项使用微积分基本定理：\n$$\n\\frac{h}{v}\\frac{d\\phi_i}{dt} \\approx \\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{i+1/2}} - \\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{i-1/2}} - \\Sigma_a h \\phi_i + h S(x_i, t)\n$$\n问题指定了二阶中心通量。在单元交界面处的扩散通量使用中心差分进行近似：\n$$\n\\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{i+1/2}} \\approx D \\frac{\\phi_{i+1} - \\phi_i}{h}\n$$\n$$\n\\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{i-1/2}} \\approx D \\frac{\\phi_i - \\phi_{i-1}}{h}\n$$\n将这些代入内部单元（$i \\in \\{2, \\dots, N-1\\}$）的平衡方程，并除以 $h$ 得：\n$$\n\\frac{1}{v}\\frac{d\\phi_i}{dt} = \\frac{D}{h^2}(\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}) - \\Sigma_a \\phi_i + S(x_i, t)\n$$\n对于边界单元，我们使用齐次狄利克雷条件 $\\phi(0,t)=0$ 和 $\\phi(L,t)=0$。设区域为 $x \\in [0,L]$。单元中心位于 $x_i = (i-1/2)h$，其中 $i=1,\\dots,N$。边界 $x=0$ 位于单元 1 的左侧面（$x_{1/2}$），边界 $x=L$ 位于单元 $N$ 的右侧面（$x_{N+1/2}$）。\n\n对于单元 $i=1$：\n左边界 $x_{1/2}=0$ 处的通量使用边界条件 $\\phi(0)=0$ 和单元中心值 $\\phi_1$ 进行近似。从边界到单元中心 $x_1$ 的距离是 $h/2$。二阶近似为：\n$$\n\\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{1/2}=0} \\approx D \\frac{\\phi_1 - \\phi(0)}{h/2} = D \\frac{\\phi_1 - 0}{h/2} = \\frac{2D}{h}\\phi_1\n$$\n单元 1 的方程变为：\n$$\n\\frac{1}{v}\\frac{d\\phi_1}{dt} = \\frac{1}{h}\\left(D \\frac{\\phi_2 - \\phi_1}{h} - \\frac{2D}{h}\\phi_1\\right) - \\Sigma_a \\phi_1 + S(x_1, t) = \\frac{D}{h^2}(-3\\phi_1 + \\phi_2) - \\Sigma_a \\phi_1 + S(x_1, t)\n$$\n对于单元 $i=N$：\n根据对称性，使用 $\\phi(L)=0$：\n$$\n\\left[D\\,\\frac{\\partial \\phi}{\\partial x}\\right]_{x_{N+1/2}=L} \\approx D \\frac{\\phi(L) - \\phi_N}{h/2} = D \\frac{0 - \\phi_N}{h/2} = -\\frac{2D}{h}\\phi_N\n$$\n单元 $N$ 的方程变为：\n$$\n\\frac{1}{v}\\frac{d\\phi_N}{dt} = \\frac{1}{h}\\left(-\\frac{2D}{h}\\phi_N - D \\frac{\\phi_N - \\phi_{N-1}}{h}\\right) - \\Sigma_a \\phi_N + S(x_N,t) = \\frac{D}{h^2}(\\phi_{N-1} - 3\\phi_N) - \\Sigma_a \\phi_N + S(x_N,t)\n$$\n将这些方程汇集为矩阵形式 $\\frac{1}{v}\\,\\frac{d\\boldsymbol{\\phi}}{dt} = A\\,\\boldsymbol{\\phi} + \\boldsymbol{s}(t)$，矩阵 $A$ 为：\n$$\nA = \\frac{D}{h^2} \\begin{pmatrix}\n-3   1         \\\\\n1   -2  1      \\\\\n    \\ddots  \\ddots  \\ddots   \\\\\n       1  -2  1 \\\\\n          1  -3\n\\end{pmatrix} - \\Sigma_a I\n$$\n矩阵 $A$ 显然是对称的。为了检查它是否为负定，我们分析对于任意非零向量 $\\boldsymbol{x} \\in \\mathbb{R}^N$ 的二次型 $\\boldsymbol{x}^T A \\boldsymbol{x}$。令 $A_{diff}$ 为三对角矩阵部分。\n$$\n\\boldsymbol{x}^T A_{diff} \\boldsymbol{x} = -3x_1^2 - 2\\sum_{i=2}^{N-1}x_i^2 - 3x_N^2 + 2\\sum_{i=1}^{N-1}x_i x_{i+1}\n$$\n这可以重写为：\n$$\n\\boldsymbol{x}^T A_{diff} \\boldsymbol{x} = -2x_1^2 - 2x_N^2 - \\sum_{i=1}^{N-1}(x_i - x_{i+1})^2\n$$\n这种形式是非正项之和。它仅在 $x_1=0$，$x_N=0$ 且对所有 $i$ 都有 $x_i=x_{i+1}$ 时等于零，这意味着 $\\boldsymbol{x}=\\boldsymbol{0}$。因此，对于任意 $\\boldsymbol{x} \\neq \\boldsymbol{0}$，都有 $\\boldsymbol{x}^T A_{diff} \\boldsymbol{x}  0$，使得 $A_{diff}$ 是负定的。\n矩阵 $A = (D/h^2)A_{diff} - \\Sigma_a I$。由于 $D>0$ 且 $h^2>0$，$(D/h^2)A_{diff}$ 也是对称负定的。由于 $\\Sigma_a \\ge 0$，减去 $\\Sigma_a I$（一个负半定矩阵）保持了负定性。因此，$A$ 是一个对称负定矩阵。\n对称矩阵的一个性质是其特征值都是实数。负定矩阵的一个性质是其所有特征值都严格为负。所以，$A$ 的谱 $\\sigma(A)$ 由严格为负的实数组成：$\\sigma(A) \\subset (-\\infty, 0)$。\n\n**2.2. 时间步进格式的稳定性分析**\n\n我们通过将格式应用于标量测试方程 $y'(t) = \\Lambda y(t)$ 来分析齐次系统 $\\frac{d\\boldsymbol{\\phi}}{dt} = vA\\boldsymbol{\\phi}$，其中 $\\Lambda$ 是矩阵 $vA$ 的一个特征值。由于 $\\lambda \\in \\sigma(A)$ 是实数且为负，并且 $v>0$，特征值 $\\Lambda = v\\lambda$ 也都是实数且为负。我们定义 $z = \\Lambda \\Delta t = v \\lambda \\Delta t  0$。稳定性要求放大因子 $g(z)$ 的模 $|g(z)|$ 小于或等于 1。\n\n-   **前向欧拉 (FE):** 格式为 $\\boldsymbol{\\phi}^{n+1} = \\boldsymbol{\\phi}^n + \\Delta t (vA \\boldsymbol{\\phi}^n)$。\n    放大因子为 $g_{FE}(z) = 1+z$。\n    稳定性要求 $|1+z| \\le 1$。由于 $z$ 是实数且为负，这变成 $-1 \\le 1+z \\le 1$，可简化为 $-2 \\le z \\le 0$。\n    由于 $z = v\\lambda\\Delta t$，这意味着 $\\Delta t \\le -2/(v\\lambda) = 2/(v|\\lambda|)$。\n    这个约束必须对 $A$ 的所有特征值 $\\lambda$ 都成立。最严格的条件来自模最大的特征值，即谱半径 $\\rho(A) = \\max_i |\\lambda_i|$。\n    稳定性条件是 $\\Delta t \\le \\frac{2}{v\\,\\rho(A)}$。FE 是条件稳定的。\n\n-   **后向欧拉 (BE):** 格式为 $\\boldsymbol{\\phi}^{n+1} = \\boldsymbol{\\phi}^n + \\Delta t (vA \\boldsymbol{\\phi}^{n+1})$。\n    放大因子为 $g_{BE}(z) = \\frac{1}{1-z}$。\n    稳定性要求 $|1-z| \\ge 1$。对于左半平面中的任何 $z$（即 $\\text{Re}(z) \\le 0$），令 $z=x+iy$ 且 $x\\le0$。那么 $|1-z|^2 = (1-x)^2 + y^2 \\ge 1^2 + 0 = 1$。稳定域包含整个左半平面。这个性质被称为 A-稳定性。对于我们的问题，由于所有特征值 $\\Lambda$ 都在负实轴上，BE 对于任何 $\\Delta t > 0$ 都是无条件稳定的。\n    此外，我们检查 L-稳定性，它要求当 $\\text{Re}(z) \\to -\\infty$ 时 $|g(z)| \\to 0$。对于 BE，$\\lim_{z \\to -\\infty} |g_{BE}(z)| = \\lim_{z \\to -\\infty} |\\frac{1}{1-z}| = 0$。所以，BE 也是 L-稳定的，这意味着它能有效地衰减非常刚性（大的负特征值）的分量。\n\n-   **Crank-Nicolson (CN):** 格式为 $\\boldsymbol{\\phi}^{n+1} = \\boldsymbol{\\phi}^n + \\frac{\\Delta t}{2} (vA \\boldsymbol{\\phi}^n + vA \\boldsymbol{\\phi}^{n+1})$。\n    放大因子为 $g_{CN}(z) = \\frac{1+z/2}{1-z/2}$。\n    稳定性要求 $|1+z/2| \\le |1-z/2|$。令 $z=x+iy$。这等价于 $(1+x/2)^2+(y/2)^2 \\le (1-x/2)^2+(y/2)^2$，简化为 $x \\le 0$。稳定域是整个左半平面，所以 CN 是 A-稳定的，并且对于这个问题是无条件稳定的。\n    为了检查 L-稳定性，我们取极限：$\\lim_{z \\to -\\infty} |g_{CN}(z)| = \\lim_{z \\to -\\infty} \\left|\\frac{1+z/2}{1-z/2}\\right| = \\left|\\frac{z/2}{-z/2}\\right| = 1$。由于极限不为 0，CN 不是 L-稳定的。对于刚性分量（$z=v\\lambda\\Delta t$ 是大的负数），放大因子接近 -1，这意味着这些分量不会被衰减，而是在步与步之间持续振荡。\n\n### 第 3 步：逐项分析\n\n-   **选项 A:**\n    -   “在齐次狄利克雷边界条件下，$A$ 是对称负定的，其谱为严格位于负实轴上的实数。”\n        -   这是**正确**的，如 2.1 节所示。\n    -   “仅当 $\\Delta t \\le \\dfrac{2}{v\\,\\rho(A)}$（其中 $\\rho(A)=\\max_i|\\lambda_i(A)|$）时，前向欧拉格式是稳定的。”\n        -   这是**正确**的，如 2.2 节为 FE 格式推导的那样。该限制由模最大的特征值决定。\n    -   “后向欧拉格式是 A-稳定的，其绝对稳定域包含整个左半复平面。”\n        -   这是**正确**的。BE 的稳定域是 $\\{z \\in \\mathbb{C} : |1-z| \\ge 1\\}$，它包含左半平面。\n    -   “Crank–Nicolson 是 A-稳定的但不是 L-稳定的，当 $|\\lambda|\\Delta t\\to\\infty$ 时，其放大因子的幅值趋近于 1。”\n        -   这是**正确**的。CN 的稳定域是左半平面（A-稳定），但对于大的负实部，其放大因子模值趋近于 1，因此它不是 L-稳定的。这对应于极限 $|\\lambda|\\Delta t\\to\\infty$。\n    -   选项 A 的总体结论：**正确**。\n\n-   **选项 B:**\n    -   “离散算子 $A$ 是正定的……”\n        -   这是**不正确**的。该算子代表扩散和吸收，会移出中子。一个正定矩阵会有正特征值，对应于一个不符合物理的、发散的系统。我们证明了 A 是负定的。\n    -   选项 B 的总体结论：**不正确**。\n\n-   **选项 C:**\n    -   “仅当 $\\Delta t \\le \\dfrac{2}{v\\,|\\lambda_{\\min}(A)|}$（其中 $\\lambda_{\\min}(A)$ 是 $A$ 的模最小的特征值）时，前向欧拉格式是稳定的。”\n        -   这是**不正确**的。显式方法的稳定性极限由模*最大*的特征值（谱半径 $\\rho(A)$）决定，它对应于系统中最快的动力学行为。使用模最小的特征值将导致一个大得多的、不正确的时间步长限制。\n    -   “Crank–Nicolson 是 L-稳定的，并且当 $\\Delta t\\to\\infty$ 时，将所有刚性模式衰减至零。”\n        -   这是**不正确**的。CN 是众所周知地非 L-稳定。对于刚性模式，其放大因子趋近于 -1，导致持续振荡而非衰减。\n    -   选项 C 的总体结论：**不正确**。\n\n-   **选项 D:**\n    -   “后向欧拉是条件稳定的，其约束为 $\\Delta t \\le \\dfrac{1}{\\rho(A)}$……”。\n        -   这是**不正确**的。后向欧拉是 A-稳定的，因此对于此问题是无条件稳定的。\n    -   “……Crank–Nicolson 格式也有相同的约束。”\n        -   这是**不正确**的。Crank-Nicolson 也是 A-稳定的并且是无条件稳定的。\n    -   “后向欧拉和 Crank–Nicolson 格式的稳定域都不包含整个左半复平面。”\n        -   这是**不正确**的。两者都是 A-稳定的，根据定义，这意味着它们的稳定域包含整个左半平面。\n    -   选项 D 的总体结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "掌握了离散化和稳定性的基本概念后，我们现在可以在一个实际问题中对不同的数值技术进行评估。本练习将两种主流的数值方法——有限差分法（FDM）和有限元法（FEM）——进行正面比较，共同用于计算一个关键的物理量：反应堆的基模衰变率。通过将数值结果与精确的解析解进行对比，你将洞察这两种方法的相对精度差异，并理解它们各自的数学构造如何影响其在求解本征值问题时的表现。",
            "id": "4257523",
            "problem": "您的任务是实现并比较两种空间离散化方案——有限差分法和有限元法——用于求解具有真空边界条件的均匀板中的单群瞬态中子扩散方程，并定量评估它们在估算基波模态衰减率方面的误差。该物理系统遵循由单群扩散方程表示的基本中子平衡：\n$$(\\frac{1}{v})\\frac{\\partial \\phi(x,t)}{\\partial t} = D\\,\\frac{\\partial^2 \\phi(x,t)}{\\partial x^2} - \\Sigma_a\\,\\phi(x,t) + \\nu\\Sigma_f\\,\\phi(x,t),$$\n其中 $x \\in (0,L)$ 是外推边界长度 $L$ 上的空间坐标，$t$ 是时间，$v$ 是中子速度，$D$ 是扩散系数，$\\Sigma_a$ 是吸收宏观截面，$\\nu\\Sigma_f$ 是产生宏观截面。真空边界条件以狄利克雷零通量形式施加于外推边界上，即对所有 $t$ 都有 $\\phi(0,t)=0$ 和 $\\phi(L,t)=0$。您必须从第一性原理出发，推导一种计算方法来估算主导模态的基波衰减率，并将有限差分和有限元离散化方法的精度与通过分离变量法和施加的边界条件所得到的精确解析值进行比较。\n\n您的实现必须基于以下步骤，并严格遵循上述基本定律：\n- 使用两种独立的空间离散化方法构建用于时间演化的半离散算子：\n  1. 有限差分法：在 $N_{\\mathrm{FD}}$ 个内部点上使用步长为 $h = L/(N_{\\mathrm{FD}}+1)$ 的中心二阶差分，得到一个离散拉普拉斯矩阵 $\\mathbf{L}_{\\mathrm{FD}}$（在端点处为狄利克雷条件）。半离散算子为\n  $$\\mathbf{A}_{\\mathrm{FD}} = v\\,(D\\,\\mathbf{L}_{\\mathrm{FD}} + (\\nu\\Sigma_f - \\Sigma_a)\\mathbf{I}),$$\n  其中 $\\mathbf{I}$ 是单位矩阵。\n  2. 有限元法：在 $N_{\\mathrm{FE}}$ 个均匀单元上使用线性（分段仿射）元，生成一个刚度矩阵 $\\mathbf{K}$ 和一个一致质量矩阵 $\\mathbf{M}$（通过移除边界自由度来强制执行狄利克雷边界条件）。半离散弱形式给出\n  $$\\mathbf{M}\\,\\frac{d\\boldsymbol{\\phi}}{dt} = v\\,(-D\\,\\mathbf{K} + (\\nu\\Sigma_f - \\Sigma_a)\\mathbf{M})\\,\\boldsymbol{\\phi},$$\n  等价于\n  $$\\frac{d\\boldsymbol{\\phi}}{dt} = v\\,(-D\\,\\mathbf{M}^{-1}\\mathbf{K} + (\\nu\\Sigma_f - \\Sigma_a)\\mathbf{I})\\boldsymbol{\\phi}.$$\n- 基波模态衰减率对应于算子 $\\mathbf{A}$ 的主导（最大实部）特征值 $\\alpha_1$。对于有限元法，这等价于计算问题 $\\mathbf{K}\\mathbf{u} = \\mu\\,\\mathbf{M}\\mathbf{u}$ 的最小广义特征值 $\\mu_1$，并设定\n$$\\alpha_1 = v\\,(\\nu\\Sigma_f - \\Sigma_a - D\\,\\mu_1).$$\n- 在外推长度 $L$ 上施加狄利克雷边界条件下的精确解析基波衰减率，可通过分离变量法和 Sturm–Liouville 理论确定。使用它为每种方法定义一个定量误差度量。\n\n您必须实现一个独立的程序，对于每个测试用例，计算：\n- 由有限差分法估算的基波衰减率，单位为 $\\mathrm{s}^{-1}$。\n- 由有限元法估算的基波衰减率，单位为 $\\mathrm{s}^{-1}$。\n- 精确的解析基波衰减率，单位为 $\\mathrm{s}^{-1}$。\n- 有限差分和有限元估算值与精确值相比的绝对误差（单位为 $\\mathrm{s}^{-1}$）。\n\n为了科学上的真实性，使用板的外推边界长度 $L$ 来施加狄利克雷条件，并假定所有参数均为正且物理上合理。您的程序不得执行时间步进；相反，应按规定通过半离散算子谱推导衰减率。\n\n物理单位必须遵守如下规定：\n- 长度 $L$ 的单位为米 ($\\mathrm{m}$)。\n- 扩散系数 $D$ 的单位为米 ($\\mathrm{m}$)。\n- 截面 $\\Sigma_a$ 和 $\\nu\\Sigma_f$ 的单位为米-1 ($\\mathrm{m}^{-1}$)。\n- 中子速度 $v$ 的单位为米/秒 ($\\mathrm{m/s}$)。\n- 衰减率和误差的单位为秒-1 ($\\mathrm{s}^{-1}$)，以十进制浮点数形式打印。\n\n测试套件：\n使用以下参数集来测试实现的不同方面。对于每种情况，计算并返回两种方法估算的基波衰减率的绝对误差。\n\n- 情况 1（一般次临界板，中等分辨率）：\n  - $L = 1.2\\,\\mathrm{m}$, $D = 0.01\\,\\mathrm{m}$, $\\Sigma_a = 0.15\\,\\mathrm{m}^{-1}$, $\\nu\\Sigma_f = 0.13\\,\\mathrm{m}^{-1}$, $v = 2.2\\times 10^5\\,\\mathrm{m/s}$, $N_{\\mathrm{FD}} = 80$, $N_{\\mathrm{FE}} = 80$。\n- 情况 2（近临界边界，高分辨率）：\n  - $L = 1.2\\,\\mathrm{m}$, $D = 0.01\\,\\mathrm{m}$, $\\Sigma_a = 0.14\\,\\mathrm{m}^{-1}$, $\\nu\\Sigma_f = 0.208545\\,\\mathrm{m}^{-1}$, $v = 2.2\\times 10^5\\,\\mathrm{m/s}$, $N_{\\mathrm{FD}} = 120$, $N_{\\mathrm{FE}} = 120$。\n- 情况 3（粗网格的边缘情况）：\n  - $L = 0.8\\,\\mathrm{m}$, $D = 0.005\\,\\mathrm{m}$, $\\Sigma_a = 0.12\\,\\mathrm{m}^{-1}$, $\\nu\\Sigma_f = 0.05\\,\\mathrm{m}^{-1}$, $v = 2.0\\times 10^5\\,\\mathrm{m/s}$, $N_{\\mathrm{FD}} = 5$, $N_{\\mathrm{FE}} = 4$。\n\n最终输出格式：\n您的程序应产生单行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序为 $[\\text{情况1 FD误差}, \\text{情况1 FE误差}, \\text{情况2 FD误差}, \\text{情况2 FE误差}, \\text{情况3 FD误差}, \\text{情况3 FE误差}]$，每个条目都是一个单位为 $\\mathrm{s}^{-1}$ 的十进制浮点数。",
            "solution": "该问题是有效的，因为它在科学上基于中子扩散理论的原理，数学上是适定的，并且给出了充分、一致和客观的细节。可以构建一个完整的解决方案。\n\n问题的核心是求解一维板中单群瞬态中子扩散方程的基波模态衰减率，该方程由下式给出：\n$$ \\frac{1}{v}\\frac{\\partial \\phi(x,t)}{\\partial t} = D\\,\\frac{\\partial^2 \\phi(x,t)}{\\partial x^2} - \\Sigma_a\\,\\phi(x,t) + \\nu\\Sigma_f\\,\\phi(x,t) $$\n边界条件为真空边界条件 $\\phi(0,t)=0$ 和 $\\phi(L,t)=0$。形式为 $\\phi(x,t) = \\psi(x)e^{\\alpha t}$ 的解将此偏微分方程（PDE）简化为一个空间特征值问题。时间行为由衰减率 $\\alpha$ 的值决定。基波模态对应于代数上最大的特征值 $\\alpha_1$，它代表了中子通量的渐近主导行为。我们将解析地确定该值，并将其与两种数值离散化方案——有限差分法（FDM）和有限元法（FEM）——的估算值进行比较。\n\n### 1. 解析解\n\n我们寻求形式为 $\\phi(x,t) = \\psi(x)e^{\\alpha t}$ 的解。将其代入扩散方程可得：\n$$ \\frac{\\alpha}{v}\\psi(x)e^{\\alpha t} = \\left( D\\frac{d^2\\psi(x)}{dx^2} - \\Sigma_a\\psi(x) + \\nu\\Sigma_f\\psi(x) \\right) e^{\\alpha t} $$\n两边除以 $e^{\\alpha t}$ 并整理，得到一个关于空间函数 $\\psi(x)$ 的标准 Sturm-Liouville 特征值问题：\n$$ D\\frac{d^2\\psi}{dx^2} + (\\nu\\Sigma_f - \\Sigma_a)\\psi = \\frac{\\alpha}{v}\\psi $$\n这可以写成：\n$$ \\frac{d^2\\psi}{dx^2} + B_m^2 \\psi = 0, \\quad \\text{其中 } B_m^2 = \\frac{(\\nu\\Sigma_f - \\Sigma_a) - \\alpha/v}{D} $$\n$B_m^2$ 项被称为材料曲率。这个二阶常微分方程的通解是 $\\psi(x) = C_1\\sin(B_m x) + C_2\\cos(B_m x)$。应用边界条件：\n- $\\psi(0) = 0 \\implies C_2 = 0$。\n- $\\psi(L) = 0 \\implies C_1\\sin(B_m L) = 0$。对于非平凡解（$C_1 \\neq 0$），必须有 $B_m L = n\\pi$，其中整数 $n \\geq 1$。\n这给出了一组离散的 $B_m^2$ 可能值，称为几何曲率 $B_g^2$：\n$$ B_{g,n}^2 = \\left(\\frac{n\\pi}{L}\\right)^2 $$\n将每个模态 $n$ 的材料曲率和几何曲率相等，我们可以解出相应的衰减率 $\\alpha_n$：\n$$ \\frac{(\\nu\\Sigma_f - \\Sigma_a) - \\alpha_n/v}{D} = \\left(\\frac{n\\pi}{L}\\right)^2 $$\n$$ \\alpha_n = v \\left[ (\\nu\\Sigma_f - \\Sigma_a) - D\\left(\\frac{n\\pi}{L}\\right)^2 \\right] $$\n基波模态是几何曲率最小的模态，对应于 $n=1$。因此，代数上最大（主导）的特征值是 $\\alpha_1$。精确的解析基波衰减率为：\n$$ \\alpha_{1, \\text{exact}} = v \\left[ (\\nu\\Sigma_f - \\Sigma_a) - D\\left(\\frac{\\pi}{L}\\right)^2 \\right] $$\n\n### 2. 有限差分法 (FDM) 解\n\nFDM 在离散网格上逼近连续空间算子。我们使用 $N_{\\mathrm{FD}}$ 个内部点 $x_i = i h$，其中 $i=1, \\dots, N_{\\mathrm{FD}}$，网格间距为 $h = L/(N_{\\mathrm{FD}}+1)$。连续二阶导数由二阶中心差分逼近：\n$$ \\frac{\\partial^2 \\phi}{\\partial x^2}\\bigg|_{x_i} \\approx \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} $$\n其中 $\\phi_i(t) = \\phi(x_i, t)$。将此代入原始偏微分方程，得到一个关于每个网格点通量的常微分方程组（ODEs），以矩阵形式表示为 $d\\boldsymbol{\\phi}/dt = \\mathbf{A}_{\\mathrm{FD}}\\boldsymbol{\\phi}$。算子矩阵 $\\mathbf{A}_{\\mathrm{FD}}$ 定义为：\n$$ \\mathbf{A}_{\\mathrm{FD}} = v\\,\\left( D\\,\\mathbf{L}_{\\mathrm{FD}} + (\\nu\\Sigma_f - \\Sigma_a)\\mathbf{I} \\right) $$\n这里，$\\mathbf{I}$ 是单位矩阵，$\\mathbf{L}_{\\mathrm{FD}}$ 是用于狄利克雷边界条件的 $N_{\\mathrm{FD}} \\times N_{\\mathrm{FD}}$ 离散拉普拉斯矩阵：\n$$ \\mathbf{L}_{\\mathrm{FD}} = \\frac{1}{h^2} \\begin{pmatrix}\n-2   1  0  \\dots  0 \\\\\n1   -2  1  \\dots  0 \\\\\n0   \\ddots  \\ddots  \\ddots  0 \\\\\n\\dots  1  -2  1 \\\\\n0   \\dots  0  1  -2\n\\end{pmatrix} $$\n基波衰减率 $\\alpha_{1, \\mathrm{FD}}$ 是矩阵 $\\mathbf{A}_{\\mathrm{FD}}$ 的最大实部特征值。这将通过构建矩阵并求解其特征值来数值计算。\n\n### 3. 有限元法 (FEM) 解\n\nFEM 基于偏微分方程的弱形式。区域 $[0, L]$ 被划分为 $N_{\\mathrm{FE}}$ 个长度均匀的单元，单元长度为 $h = L/N_{\\mathrm{FE}}$，使用线性基函数 $\\psi_j(x)$（“帽函数”）。将偏微分方程投影到这个基上，得到半离散系统：\n$$ \\mathbf{M}\\,\\frac{d\\boldsymbol{\\phi}}{dt} = v\\,\\left( -D\\,\\mathbf{K} + (\\nu\\Sigma_f - \\Sigma_a)\\mathbf{M} \\right)\\,\\boldsymbol{\\phi} $$\n其中 $\\boldsymbol{\\phi}$ 是 $N_{\\mathrm{FE}}-1$ 个内部节点上的节点通量值向量。$\\mathbf{K}$ 是刚度矩阵，$\\mathbf{M}$ 是一致质量矩阵。对于均匀线性单元，这些是 $(N_{\\mathrm{FE}}-1) \\times (N_{\\mathrm{FE}}-1)$ 的三对角矩阵：\n$$ \\mathbf{K} = \\frac{1}{h} \\begin{pmatrix}\n2   -1        \\\\\n-1  2   -1     \\\\\n   \\ddots  \\ddots  \\ddots  \\\\\n     -1  2  -1 \\\\\n       -1  2\n\\end{pmatrix}, \\quad \\mathbf{M} = \\frac{h}{6} \\begin{pmatrix}\n4  1       \\\\\n1  4  1     \\\\\n   \\ddots  \\ddots  \\ddots  \\\\\n     1  4  1 \\\\\n       1  4\n\\end{pmatrix} $$\n寻求形式为 $\\boldsymbol{\\phi}(t) = \\mathbf{u}e^{\\alpha t}$ 的解将常微分方程组转化为一个代数特征值问题。从弱形式推导，这导致广义特征值问题 $\\mathbf{K}\\mathbf{u} = \\mu\\mathbf{M}\\mathbf{u}$，其中特征值 $\\mu$ 与衰减率 $\\alpha$ 的关系为：\n$$ \\alpha = v \\left[ (\\nu\\Sigma_f - \\Sigma_a) - D\\mu \\right] $$\n为了找到基波（主导）衰减率 $\\alpha_{1, \\mathrm{FE}}$，我们需要最大的 $\\alpha$。由于 $D>0$，这需要找到广义问题 $\\mathbf{K}\\mathbf{u} = \\mu\\mathbf{M}\\mathbf{u}$ 的最小特征值 $\\mu_1$。这将进行数值求解。\n\n### 4. 实现与误差计算\n\n对于每个测试用例，算法按以下步骤进行：\n1.  使用解析公式计算精确衰减率 $\\alpha_{1, \\text{exact}}$。\n2.  构建 FDM 矩阵 $\\mathbf{A}_{\\mathrm{FD}}$ 并计算其特征值。最大实部特征值即为 $\\alpha_{1, \\mathrm{FD}}$。\n3.  构建 FEM 矩阵 $\\mathbf{K}$ 和 $\\mathbf{M}$。求解广义特征值问题 $\\mathbf{K}\\mathbf{u} = \\mu\\mathbf{M}\\mathbf{u}$ 以获得最小特征值 $\\mu_1$。使用推导出的关系计算 $\\alpha_{1, \\mathrm{FE}}$。\n4.  计算两种方法的绝对误差：$E_{\\mathrm{FD}} = |\\alpha_{1, \\mathrm{FD}} - \\alpha_{1, \\text{exact}}|$ 和 $E_{\\mathrm{FE}} = |\\alpha_{1, \\mathrm{FE}} - \\alpha_{1, \\text{exact}}|$。\n\n此过程在以下 Python 代码中实现，该代码遍历提供的测试用例并报告误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main function to solve for the decay rate errors in the specified test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general subcritical slab, moderate resolution)\n        {'L': 1.2, 'D': 0.01, 'Sa': 0.15, 'nSf': 0.13, 'v': 2.2e5, 'N_fd': 80, 'N_fe': 80},\n        # Case 2 (near-critical boundary, fine resolution)\n        {'L': 1.2, 'D': 0.01, 'Sa': 0.14, 'nSf': 0.208545, 'v': 2.2e5, 'N_fd': 120, 'N_fe': 120},\n        # Case 3 (edge case with coarse meshes)\n        {'L': 0.8, 'D': 0.005, 'Sa': 0.12, 'nSf': 0.05, 'v': 2.0e5, 'N_fd': 5, 'N_fe': 4}\n    ]\n\n    results = []\n    for params in test_cases:\n        err_fd, err_fe = calculate_errors(**params)\n        results.extend([err_fd, err_fe])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_errors(L, D, Sa, nSf, v, N_fd, N_fe):\n    \"\"\"\n    Calculates the absolute errors for FDM and FEM estimates of the fundamental\n    decay rate for a given set of physical and discretization parameters.\n\n    Args:\n        L (float): Extrapolated slab length (m).\n        D (float): Diffusion coefficient (m).\n        Sa (float): Absorption cross section (m^-1).\n        nSf (float): Production cross section (m^-1).\n        v (float): Neutron speed (m/s).\n        N_fd (int): Number of interior points for FDM.\n        N_fe (int): Number of elements for FEM.\n\n    Returns:\n        tuple: A tuple containing the absolute error of the FDM estimate and\n               the absolute error of the FEM estimate (err_fd, err_fe).\n    \"\"\"\n    # 1. Exact Analytical Solution\n    alpha_exact = v * (nSf - Sa - D * (np.pi / L)**2)\n\n    # 2. Finite Difference Method (FDM)\n    h_fd = L / (N_fd + 1)\n    \n    # Construct the operator matrix A_fd\n    diag_val = v * (-2.0 * D / h_fd**2 + (nSf - Sa))\n    off_diag_val = v * (D / h_fd**2)\n\n    diag = np.full(N_fd, diag_val)\n    off_diag = np.full(N_fd - 1, off_diag_val)\n    \n    A_fd = np.diag(diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n    \n    # Find the dominant (largest real) eigenvalue\n    eigvals_fd = np.linalg.eigvals(A_fd)\n    alpha_fd = np.max(np.real(eigvals_fd))\n\n    # 3. Finite Element Method (FEM)\n    if N_fe == 1:\n        # FEM requires at least 2 elements for 1 internal DoF\n        # This case is not hit by the problem spec but is good practice.\n        alpha_fe = np.nan \n    else:\n        h_fe = L / N_fe\n        N_dof = N_fe - 1 # Number of interior nodes (degrees of freedom)\n\n        # Construct stiffness matrix K\n        diag_k = np.full(N_dof, 2.0 / h_fe)\n        off_diag_k = np.full(N_dof - 1, -1.0 / h_fe)\n        K = np.diag(diag_k) + np.diag(off_diag_k, k=1) + np.diag(off_diag_k, k=-1)\n\n        # Construct consistent mass matrix M\n        diag_m = np.full(N_dof, 4.0 * h_fe / 6.0)\n        off_diag_m = np.full(N_dof - 1, 1.0 * h_fe / 6.0)\n        M = np.diag(diag_m) + np.diag(off_diag_m, k=1) + np.diag(off_diag_m, k=-1)\n        \n        # Solve the generalized eigenvalue problem K*u = mu*M*u\n        # eigh returns eigenvalues in ascending order. We need the smallest one.\n        mu_vals = eigh(K, M, eigvals_only=True)\n        mu_1 = mu_vals[0]\n        \n        # Calculate the fundamental decay rate from the smallest mu\n        alpha_fe = v * (nSf - Sa - D * mu_1)\n\n    # 4. Calculate Absolute Errors\n    err_fd = abs(alpha_fd - alpha_exact)\n    err_fe = abs(alpha_fe - alpha_exact)\n    \n    return err_fd, err_fe\n\nsolve()\n```"
        }
    ]
}