{
    "hands_on_practices": [
        {
            "introduction": "在分析任何物理系统时，无量纲化是至关重要的第一步。通过将方程转化为无量纲形式，我们不仅可以简化其结构，还能揭示出控制系统动态行为的关键参数组合。这个练习  将让你亲手实践这一技巧，将其应用于一个基础的点堆动力学-燃料热工耦合模型。",
            "id": "4215705",
            "problem": "考虑一个空间均匀的反应堆，其模型由带单组缓发中子和集总燃料热平衡的点式反应堆动力学方程（PRKE）描述。令中子布居为 $n(t)$，缓发中子先驱核浓度为 $c(t)$，燃料温度为 $T(t)$。假设反应性具有线性温度反馈。控制方程为\n$$\\frac{dn}{dt}=\\frac{\\rho(T)-\\beta}{\\Lambda}\\,n+\\lambda\\,c,$$\n$$\\frac{dc}{dt}=\\frac{\\beta}{\\Lambda}\\,n-\\lambda\\,c,$$\n$$C_f\\frac{dT}{dt}=\\eta\\,n-h\\left(T-T_{\\mathrm{ref}}\\right),$$\n其中 $\\rho(T)=\\rho_0+\\alpha\\left(T-T_{\\mathrm{ref}}\\right)$，$\\beta$ 是有效缓发中子份额，$\\Lambda$ 是瞬发中子代时间，$\\lambda$ 是先驱核衰变常数，$C_f$ 是有效集总燃料热容，$\\eta$ 是将中子布居转换为燃料中热功率沉积的常数，$h$ 是线性散热系数，$T_{\\mathrm{ref}}$ 是一个恒定的参考温度（例如，冷却剂入口温度）。所有参数均为实常数，对于负温度反馈，$\\alpha  0$。\n\n针对中子布居、温度和时间，分别引入任意正的标度常数 $n_s$、 $T_s$ 和 $t_s$。定义无量纲变量 $x=n/n_s$、$y=c/n_s$、$\\theta=\\left(T-T_{\\mathrm{ref}}\\right)/T_s$ 和 $\\tau=t/t_s$。从上述方程和给定的定义出发，构建耦合的PRKE-燃料热平衡方程的无量纲形式，并找出以物理参数和所选标度表示的、控制动力学行为的独立无量纲参数。\n\n你的最终答案必须是这些独立无量纲参数的行矩阵，表示为包含 $n_s$、$T_s$、$t_s$、$\\rho_0$、$\\alpha$、$\\beta$、$\\Lambda$、$\\lambda$、$C_f$、$h$ 和 $\\eta$ 的闭式解析表达式。最终答案以无单位形式表示。无需进行数值计算。",
            "solution": "用户希望对一个点式反应堆模型的三个耦合常微分方程组进行无量纲化，并找出由此产生的无量纲参数。\n\n### 步骤 1：提取已知条件\n系统的控制方程为：\n$$\n\\frac{dn}{dt}=\\frac{\\rho(T)-\\beta}{\\Lambda}\\,n+\\lambda\\,c \\\\\n\\frac{dc}{dt}=\\frac{\\beta}{\\Lambda}\\,n-\\lambda\\,c \\\\\nC_f\\frac{dT}{dt}=\\eta\\,n-h\\left(T-T_{\\mathrm{ref}}\\right)\n$$\n反应性由线性温度反馈模型给出：\n$$\n\\rho(T)=\\rho_0+\\alpha\\left(T-T_{\\mathrm{ref}}\\right)\n$$\n无量纲变量的定义为：\n$$\nx = \\frac{n}{n_s}, \\quad y = \\frac{c}{n_s}, \\quad \\theta = \\frac{T-T_{\\mathrm{ref}}}{T_s}, \\quad \\tau = \\frac{t}{t_s}\n$$\n参数为：\n- $n(t)$: 中子布居\n- $c(t)$: 缓发中子先驱核浓度\n- $T(t)$: 燃料温度\n- $\\rho_0$: 初始反应性\n- $\\alpha$: 反应性温度系数，$\\alpha  0$\n- $\\beta$: 有效缓发中子份额\n- $\\Lambda$: 瞬发中子代时间\n- $\\lambda$: 先驱核衰变常数\n- $C_f$: 有效集总燃料热容\n- $\\eta$: 功率转换常数\n- $h$: 散热系数\n- $T_{\\mathrm{ref}}$: 参考温度\n- $n_s, T_s, t_s$: 分别用于布居、温度和时间的任意正标度常数。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题进行验证。\n- **科学依据：**该问题使用了带单组缓发中子和热反馈集总参数模型的标准点式反应堆动力学方程（PRKE）。这是核反应堆动力学中一个成熟且基础的模型。带有负系数（$\\alpha  0$）的线性反应性反馈也是一个标准且物理上现实的假设。该模型在科学上是合理的。\n- **适定性：**任务是给一个给定的常微分方程组进行无量纲化。这是一个标准的数学过程（量纲分析），根据所提供的定义会得到唯一的结果。该问题是适定的。\n- **客观性：**该问题使用精确的数学和物理术语陈述，没有任何主观或模糊的语言。\n\n该问题是完整的、一致的且科学上有效的。未检测到任何缺陷。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解题推导\n目标是用无量纲变量 $x$、$y$、$\\theta$ 和无量纲时间 $\\tau$ 来重写该微分方程组。\n\n首先，我们将原始变量及其时间导数用无量纲量表示。根据定义，我们有：\n$$\nn = n_s x \\\\\nc = n_s y \\\\\nT - T_{\\mathrm{ref}} = T_s \\theta \\implies T = T_s \\theta + T_{\\mathrm{ref}} \\\\\nt = t_s \\tau\n$$\n使用链式法则，我们求出关于 $t$ 的导数：\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt}\\frac{d}{d\\tau} = \\frac{1}{t_s}\\frac{d}{d\\tau}\n$$\n将此应用于我们的变量：\n$$\n\\frac{dn}{dt} = \\frac{d(n_s x)}{dt} = n_s \\frac{dx}{dt} = \\frac{n_s}{t_s}\\frac{dx}{d\\tau} \\\\\n\\frac{dc}{dt} = \\frac{d(n_s y)}{dt} = n_s \\frac{dy}{dt} = \\frac{n_s}{t_s}\\frac{dy}{d\\tau} \\\\\n\\frac{dT}{dt} = \\frac{d(T_s \\theta + T_{\\mathrm{ref}})}{dt} = T_s \\frac{d\\theta}{dt} = \\frac{T_s}{t_s}\\frac{d\\theta}{d\\tau}\n$$\n接下来，我们用无量纲温度 $\\theta$ 来表示反应性 $\\rho(T)$：\n$$\n\\rho(T) = \\rho_0 + \\alpha(T - T_{\\mathrm{ref}}) = \\rho_0 + \\alpha T_s \\theta\n$$\n现在我们将这些表达式代回最初的三个微分方程。\n\n**方程 1：中子布居**\n第一个方程是 $\\frac{dn}{dt}=\\frac{\\rho(T)-\\beta}{\\Lambda}\\,n+\\lambda\\,c$。\n代入表达式：\n$$\n\\frac{n_s}{t_s}\\frac{dx}{d\\tau} = \\frac{(\\rho_0 + \\alpha T_s \\theta) - \\beta}{\\Lambda}(n_s x) + \\lambda(n_s y)\n$$\n我们将整个方程除以 $n_s$（因为 $n_s  0$）：\n$$\n\\frac{1}{t_s}\\frac{dx}{d\\tau} = \\frac{\\rho_0 - \\beta + \\alpha T_s \\theta}{\\Lambda}x + \\lambda y\n$$\n最后，乘以 $t_s$ 以分离出 $\\frac{dx}{d\\tau}$：\n$$\n\\frac{dx}{d\\tau} = \\frac{t_s(\\rho_0 - \\beta)}{\\Lambda}x + \\frac{t_s \\alpha T_s}{\\Lambda}x\\theta + (t_s \\lambda)y\n$$\n作为系数出现在此方程中的无量纲参数是：\n$\\frac{(\\rho_0 - \\beta)t_s}{\\Lambda}$、$\\frac{\\alpha T_s t_s}{\\Lambda}$ 和 $\\lambda t_s$。\n\n**方程 2：先驱核浓度**\n第二个方程是 $\\frac{dc}{dt}=\\frac{\\beta}{\\Lambda}\\,n-\\lambda\\,c$。\n代入：\n$$\n\\frac{n_s}{t_s}\\frac{dy}{d\\tau} = \\frac{\\beta}{\\Lambda}(n_s x) - \\lambda(n_s y)\n$$\n除以 $n_s$：\n$$\n\\frac{1}{t_s}\\frac{dy}{d\\tau} = \\frac{\\beta}{\\Lambda}x - \\lambda y\n$$\n乘以 $t_s$：\n$$\n\\frac{dy}{d\\tau} = \\frac{t_s \\beta}{\\Lambda}x - (t_s \\lambda)y\n$$\n这里出现的无量纲参数是 $\\frac{\\beta t_s}{\\Lambda}$ 和 $\\lambda t_s$。第二个已经被识别出来了。\n\n**方程 3：燃料温度**\n第三个方程是 $C_f\\frac{dT}{dt}=\\eta\\,n-h\\left(T-T_{\\mathrm{ref}}\\right)$。\n代入：\n$$\nC_f \\left(\\frac{T_s}{t_s}\\frac{d\\theta}{d\\tau}\\right) = \\eta (n_s x) - h (T_s \\theta)\n$$\n为了分离出 $\\frac{d\\theta}{d\\tau}$，我们乘以 $\\frac{t_s}{C_f T_s}$：\n$$\n\\frac{d\\theta}{d\\tau} = \\frac{t_s}{C_f T_s} \\left( \\eta n_s x - h T_s \\theta \\right)\n$$\n$$\n\\frac{d\\theta}{d\\tau} = \\left(\\frac{\\eta n_s t_s}{C_f T_s}\\right)x - \\left(\\frac{h t_s}{C_f}\\right)\\theta\n$$\n出现的新无量纲参数是 $\\frac{\\eta n_s t_s}{C_f T_s}$ 和 $\\frac{h t_s}{C_f}$。\n\n**独立无量纲参数总结**\n完整的无量纲方程组是：\n$$\n\\frac{dx}{d\\tau} = \\left(\\frac{(\\rho_0 - \\beta)t_s}{\\Lambda}\\right)x + \\left(\\frac{\\alpha T_s t_s}{\\Lambda}\\right)x\\theta + (\\lambda t_s)y \\\\\n\\frac{dy}{d\\tau} = \\left(\\frac{\\beta t_s}{\\Lambda}\\right)x - (\\lambda t_s)y \\\\\n\\frac{d\\theta}{d\\tau} = \\left(\\frac{\\eta n_s t_s}{C_f T_s}\\right)x - \\left(\\frac{h t_s}{C_f}\\right)\\theta\n$$\n控制该系统动力学的不同无量纲参数是出现在这些方程中的六个系数。按照要求，它们用物理参数和所选标度表示。列举如下：\n1.  来自第一个方程中的 $x$ 项：$\\frac{(\\rho_0 - \\beta) t_s}{\\Lambda}$\n2.  来自第一个方程中的 $x\\theta$ 项：$\\frac{\\alpha T_s t_s}{\\Lambda}$\n3.  来自第一个和第二个方程中的 $y$ 项：$\\lambda t_s$\n4.  来自第二个方程中的 $x$ 项：$\\frac{\\beta t_s}{\\Lambda}$\n5.  来自第三个方程中的 $x$ 项：$\\frac{\\eta n_s t_s}{C_f T_s}$\n6.  来自第三个方程中的 $\\theta$ 项：$\\frac{h t_s}{C_f}$\n\n这六个表达式构成了问题陈述所要求的独立无量纲参数集。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{(\\rho_0 - \\beta) t_s}{\\Lambda}  \\frac{\\alpha T_s t_s}{\\Lambda}  \\lambda t_s  \\frac{\\beta t_s}{\\Lambda}  \\frac{\\eta n_s t_s}{C_f T_s}  \\frac{h t_s}{C_f} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从通用模型转向大型反应堆中一个具体且关键的稳定性问题：氙引发的功率振荡。这个实践练习  演示了如何利用线性化系统的雅可比矩阵来确定稳定性阈值。这是分岔分析的核心技术，它让你能够预测系统何时会从稳定运行状态转变为不稳定振荡。",
            "id": "4215693",
            "problem": "压水反应堆堆芯采用单群中子扩散方程在轴向坐标上进行建模，并考虑了氙-135的反馈效应。轴向中子通量通过双模展开进行近似，其中模态振幅为 $n_{1}(t)$ 和 $n_{2}(t)$，轴向本征函数为 $\\phi_{1}(z)$ 和 $\\phi_{2}(z)$，且在堆芯高度上选择为标准正交。氙-135的核素数密度同样投影到相同的轴向基上，其模态分量为 $x_{1}(t)$ 和 $x_{2}(t)$。控制平衡定律如下：\n\n- 中子平衡：净瞬发模态增长率由裂变增益以及吸收和泄漏损失决定；氙-135对反应性产生负反馈，其大小与其模态投影成正比。\n- 氙-135平衡：氙-135由碘-135产生（此处假设为准稳态关系，因此其产生与中子振幅成正比），并通过放射性衰变和中子吸收而消耗。\n\n在投影到两个轴向模态并对模态变量进行无量纲化后，围绕一个非平凡稳态的线性化得到以下形式的常微分方程（ODE）系统\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\n\\delta n_{1} \\\\\n\\delta x_{1} \\\\\n\\delta n_{2} \\\\\n\\delta x_{2}\n\\end{pmatrix}\n=\nJ\n\\begin{pmatrix}\n\\delta n_{1} \\\\\n\\delta x_{1} \\\\\n\\delta n_{2} \\\\\n\\delta x_{2}\n\\end{pmatrix},\n\\quad\nJ=\n\\begin{pmatrix}\n\\alpha_{1}  -\\beta_{1}  0  0 \\\\\n\\sigma_{1}  -\\lambda_{X}  0  0 \\\\\n0  0  \\alpha_{2}  -\\beta_{2} \\\\\n0  0  \\sigma_{2}  -\\lambda_{X}\n\\end{pmatrix},\n$$\n其中 $\\delta n_{m}$ 和 $\\delta x_{m}$ 表示与稳态模态值的微小偏差（$m=1,2$）。各系数定义如下：$\\alpha_{m}$ 是无氙时的有效瞬发模态增长率；$\\beta_{m}$ 是第 $m$ 阶模态的线性化氙价值系数；$\\sigma_{m}$ 是与第 $m$ 阶中子模态振幅成正比的有效氙产生系数；$\\lambda_{X}$ 是氙-135的移出率（运行状态下的放射性衰变和吸收之和）。假设在线性水平上模态间的耦合可以忽略不计，因此 $J$ 如所示为块对角矩阵。\n\n使用以下具有科学合理性的参数值，这些值代表了轻微扰动下的稳态：\n\n- $\\alpha_{1} = 1.80 \\times 10^{-5}\\ \\mathrm{s}^{-1}$,\n- $\\alpha_{2} = -3.00 \\times 10^{-5}\\ \\mathrm{s}^{-1}$,\n- $\\sigma_{1} = 6.50 \\times 10^{-6}\\ \\mathrm{s}^{-1}$,\n- $\\sigma_{2} = 5.50 \\times 10^{-6}\\ \\mathrm{s}^{-1}$,\n- $\\lambda_{X} = 2.10 \\times 10^{-5}\\ \\mathrm{s}^{-1}$,\n- $\\beta_{1} = 4.00 \\times 10^{-5}\\ \\mathrm{s}^{-1}$,\n- $\\beta_{2} = 6.00 \\times 10^{-5}\\ \\mathrm{s}^{-1}$.\n\n任务：\n\n1. 组装雅可比矩阵 $J$ 并计算其所有特征值。每个特征值以 $\\mathrm{s}^{-1}$ 为单位表示，并四舍五入到三位有效数字。\n\n2. 将 $\\beta_{1}$ 视为一个可调的氙反馈强度参数，确定第一个轴向模态失去线性稳定性（一个雅可比矩阵特征值穿过虚轴）的解析阈值 $\\beta_{1}^{\\mathrm{crit}}$。使用给定参数对此阈值进行数值计算。该阈值以 $\\mathrm{s}^{-1}$ 为单位表示，并将最终数值四舍五入到四位有效数字。\n\n你最终报告的答案必须是对应于阈值 $\\beta_{1}^{\\mathrm{crit}}$ 的单个实数值，单位指定为 $\\mathrm{s}^{-1}$（不要在最终答案框中包含单位）。",
            "solution": "首先根据所需标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n描述稳态微小偏差的常微分方程（ODE）控制系统由下式给出：\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\n\\delta n_{1} \\\\\n\\delta x_{1} \\\\\n\\delta n_{2} \\\\\n\\delta x_{2}\n\\end{pmatrix}\n=\nJ\n\\begin{pmatrix}\n\\delta n_{1} \\\\\n\\delta x_{1} \\\\\n\\delta n_{2} \\\\\n\\delta x_{2}\n\\end{pmatrix}\n$$\n雅可比矩阵 $J$ 为：\n$$\nJ=\n\\begin{pmatrix}\n\\alpha_{1}  -\\beta_{1}  0  0 \\\\\n\\sigma_{1}  -\\lambda_{X}  0  0 \\\\\n0  0  \\alpha_{2}  -\\beta_{2} \\\\\n0  0  \\sigma_{2}  -\\lambda_{X}\n\\end{pmatrix}\n$$\n提供的参数值为：\n- $\\alpha_{1} = 1.80 \\times 10^{-5}\\ \\mathrm{s}^{-1}$\n- $\\alpha_{2} = -3.00 \\times 10^{-5}\\ \\mathrm{s}^{-1}$\n- $\\sigma_{1} = 6.50 \\times 10^{-6}\\ \\mathrm{s}^{-1}$\n- $\\sigma_{2} = 5.50 \\times 10^{-6}\\ \\mathrm{s}^{-1}$\n- $\\lambda_{X} = 2.10 \\times 10^{-5}\\ \\mathrm{s}^{-1}$\n- $\\beta_{1} = 4.00 \\times 10^{-5}\\ \\mathrm{s}^{-1}$\n- $\\beta_{2} = 6.00 \\times 10^{-5}\\ \\mathrm{s}^{-1}$\n\n**步骤2：使用提取的给定信息进行验证**\n- **科学依据：** 该问题描述了氙-135振荡的线性化模型，这是核反应堆物理学中的一个典型稳定性问题。使用双模展开以及建立中子和氙浓度的平衡方程是标准技术。参数的解释及其数量级对于大型压水反应堆是物理上现实的。该模型牢固地建立在反应堆动力学的既定原则之上。\n- **适定性：** 该问题提供了一套完整的线性方程和参数值。任务是计算特征值和分岔阈值，这些都是具有唯一解的明确定义的数学运算。\n- **客观性：** 问题使用精确、客观的数学语言陈述，没有歧义或主观性陈述。\n\n**步骤3：结论与行动**\n问题有效。这是一个在核反应堆稳定性分析中适定的、有科学依据的问题。开始求解。\n\n### 解题过程\n\n线性系统的稳定性由雅可比矩阵 $J$ 的特征值决定。由于 $J$ 是块对角矩阵，其特征值是两个 $2 \\times 2$ 对角块的特征值，我们将其表示为 $J_1$ 和 $J_2$。\n$$\nJ_1 = \\begin{pmatrix} \\alpha_{1}  -\\beta_{1} \\\\ \\sigma_{1}  -\\lambda_{X} \\end{pmatrix}, \\quad J_2 = \\begin{pmatrix} \\alpha_{2}  -\\beta_{2} \\\\ \\sigma_{2}  -\\lambda_{X} \\end{pmatrix}\n$$\n对于一个通用的 $2 \\times 2$ 矩阵 $A$，其特征值 $\\lambda$ 是特征方程 $\\lambda^2 - \\mathrm{tr}(A)\\lambda + \\det(A) = 0$ 的解。\n\n**任务1：计算特征值**\n\n首先，我们使用提供的参数值，计算由 $J_1$ 控制的、对应于第一个轴向模态的子系统的特征值。\n$J_1$ 的迹为：\n$$\n\\mathrm{tr}(J_1) = \\alpha_{1} - \\lambda_{X} = (1.80 \\times 10^{-5}) - (2.10 \\times 10^{-5}) = -3.00 \\times 10^{-6}\\ \\mathrm{s}^{-1}\n$$\n$J_1$ 的行列式为：\n$$\n\\det(J_1) = -\\alpha_{1}\\lambda_{X} - (-\\beta_{1}\\sigma_{1}) = \\beta_{1}\\sigma_{1} - \\alpha_{1}\\lambda_{X}\n$$\n$$\n\\det(J_1) = (4.00 \\times 10^{-5})(6.50 \\times 10^{-6}) - (1.80 \\times 10^{-5})(2.10 \\times 10^{-5}) = 2.60 \\times 10^{-10} - 3.78 \\times 10^{-10} = -1.18 \\times 10^{-10}\\ \\mathrm{s}^{-2}\n$$\n特征值 $\\lambda_{1,2}$ 由二次公式给出：\n$$\n\\lambda_{1,2} = \\frac{\\mathrm{tr}(J_1) \\pm \\sqrt{\\mathrm{tr}(J_1)^2 - 4\\det(J_1)}}{2} = \\frac{-3.00 \\times 10^{-6} \\pm \\sqrt{(-3.00 \\times 10^{-6})^2 - 4(-1.18 \\times 10^{-10})}}{2}\n$$\n$$\n\\lambda_{1,2} = \\frac{-3.00 \\times 10^{-6} \\pm \\sqrt{9.00 \\times 10^{-12} + 4.72 \\times 10^{-10}}}{2} = \\frac{-3.00 \\times 10^{-6} \\pm \\sqrt{4.81 \\times 10^{-10}}}{2}\n$$\n$$\n\\lambda_{1,2} = \\frac{-3.00 \\times 10^{-6} \\pm 2.19317... \\times 10^{-5}}{2}\n$$\n这为第一个模态产生两个实数特征值：\n$$\n\\lambda_1 = \\frac{1.89317... \\times 10^{-5}}{2} = 9.4658... \\times 10^{-6}\\ \\mathrm{s}^{-1} \\approx 9.47 \\times 10^{-6}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\lambda_2 = \\frac{-2.49317... \\times 10^{-5}}{2} = -1.2465... \\times 10^{-5}\\ \\mathrm{s}^{-1} \\approx -1.25 \\times 10^{-5}\\ \\mathrm{s}^{-1}\n$$\n\n接下来，我们计算由 $J_2$ 控制的第二个轴向模态的特征值。\n$J_2$ 的迹为：\n$$\n\\mathrm{tr}(J_2) = \\alpha_{2} - \\lambda_{X} = (-3.00 \\times 10^{-5}) - (2.10 \\times 10^{-5}) = -5.10 \\times 10^{-5}\\ \\mathrm{s}^{-1}\n$$\n$J_2$ 的行列式为：\n$$\n\\det(J_2) = \\beta_{2}\\sigma_{2} - \\alpha_{2}\\lambda_{X}\n$$\n$$\n\\det(J_2) = (6.00 \\times 10^{-5})(5.50 \\times 10^{-6}) - (-3.00 \\times 10^{-5})(2.10 \\times 10^{-5}) = 3.30 \\times 10^{-10} + 6.30 \\times 10^{-10} = 9.60 \\times 10^{-10}\\ \\mathrm{s}^{-2}\n$$\n特征值 $\\lambda_{3,4}$ 为：\n$$\n\\lambda_{3,4} = \\frac{\\mathrm{tr}(J_2) \\pm \\sqrt{\\mathrm{tr}(J_2)^2 - 4\\det(J_2)}}{2} = \\frac{-5.10 \\times 10^{-5} \\pm \\sqrt{(-5.10 \\times 10^{-5})^2 - 4(9.60 \\times 10^{-10})}}{2}\n$$\n$$\n\\lambda_{3,4} = \\frac{-5.10 \\times 10^{-5} \\pm \\sqrt{2.601 \\times 10^{-9} - 3.84 \\times 10^{-9}}}{2} = \\frac{-5.10 \\times 10^{-5} \\pm \\sqrt{-1.239 \\times 10^{-9}}}{2}\n$$\n$$\n\\lambda_{3,4} = \\frac{-5.10 \\times 10^{-5} \\pm i \\sqrt{1.239 \\times 10^{-9}}}{2} = \\frac{-5.10 \\times 10^{-5} \\pm i \\times 3.5199... \\times 10^{-5}}{2}\n$$\n这为第二个模态产生一对共轭复数特征值：\n$$\n\\lambda_{3,4} = -2.55 \\times 10^{-5} \\pm i \\times 1.7599... \\times 10^{-5}\\ \\mathrm{s}^{-1} \\approx -2.55 \\times 10^{-5} \\pm i \\times 1.76 \\times 10^{-5}\\ \\mathrm{s}^{-1}\n$$\n矩阵 $J$ 的完整特征值集合为 $\\{9.47 \\times 10^{-6}, -1.25 \\times 10^{-5}, -2.55 \\times 10^{-5} \\pm i \\, 1.76 \\times 10^{-5}\\}$，单位均为 $\\mathrm{s}^{-1}$。\n\n**任务2：确定临界阈值 $\\beta_{1}^{\\mathrm{crit}}$**\n\n我们通过考察 $J_1$ 的特征值作为参数 $\\beta_1$ 的函数来分析第一个模态的稳定性。根据 Routh-Hurwitz 稳定性判据，对于特征方程为 $\\lambda^2 + a_1\\lambda + a_0 = 0$ 的二阶系统，其稳定的充要条件是 $a_1  0$ 和 $a_0  0$。此处，$a_1 = -\\mathrm{tr}(J_1)$ 且 $a_0 = \\det(J_1)$。\n\n第一个条件是：\n$$\na_1 = -\\mathrm{tr}(J_1) = -(\\alpha_1 - \\lambda_X) = \\lambda_X - \\alpha_1 = (2.10 \\times 10^{-5}) - (1.80 \\times 10^{-5}) = 3.00 \\times 10^{-6}\\ \\mathrm{s}^{-1}\n$$\n由于 $a_1  0$，对于给定的参数，迹条件总是满足的。这意味着通过改变 $\\beta_1$ 不会发生霍普夫(Hopf)分岔（其中 $a_1=0$，导致纯虚数特征值）。\n\n因此，稳定性完全由第二个条件决定：\n$$\na_0 = \\det(J_1)  0\n$$\n当一个实数特征值穿过零时，系统失去稳定性，这对应于一个静态（或鞍结）分岔。该分岔的阈值通过将行列式设为零来求得。\n$$\n\\det(J_1) = \\beta_1 \\sigma_1 - \\alpha_1 \\lambda_X = 0\n$$\n求解 $\\beta_1$ 的临界值，记为 $\\beta_1^{\\mathrm{crit}}$：\n$$\n\\beta_1^{\\mathrm{crit}} \\sigma_1 = \\alpha_1 \\lambda_X\n$$\n$$\n\\beta_1^{\\mathrm{crit}} = \\frac{\\alpha_1 \\lambda_X}{\\sigma_1}\n$$\n这是稳定性阈值的解析表达式。如果 $\\beta_1  \\beta_1^{\\mathrm{crit}}$，第一个模态是稳定的；如果 $\\beta_1  \\beta_1^{\\mathrm{crit}}$，则是不稳定的。\n\n现在，我们使用给定的参数值对该阈值进行数值计算：\n$$\n\\beta_1^{\\mathrm{crit}} = \\frac{(1.80 \\times 10^{-5}\\ \\mathrm{s}^{-1})(2.10 \\times 10^{-5}\\ \\mathrm{s}^{-1})}{6.50 \\times 10^{-6}\\ \\mathrm{s}^{-1}}\n$$\n$$\n\\beta_1^{\\mathrm{crit}} = \\frac{3.78 \\times 10^{-10}\\ \\mathrm{s}^{-2}}{6.50 \\times 10^{-6}\\ \\mathrm{s}^{-1}} = 0.58153846... \\times 10^{-4}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\beta_1^{\\mathrm{crit}} = 5.8153846... \\times 10^{-5}\\ \\mathrm{s}^{-1}\n$$\n根据题目要求，将最终数值答案四舍五入到四位有效数字：\n$$\n\\beta_1^{\\mathrm{crit}} = 5.815 \\times 10^{-5}\\ \\mathrm{s}^{-1}\n$$\n这就是第一个模态中氙反馈强度的阈值。\n\n最终要求的答案是 $\\beta_1^{\\mathrm{crit}}$ 的数值。",
            "answer": "$$\\boxed{5.815 \\times 10^{-5}}$$"
        },
        {
            "introduction": "理论分析与实际计算模拟之间需要一座桥梁。本练习旨在通过探索数值方法如何影响稳定性预测来构建这座桥梁。在这个编码实践  中，你将研究一个计算出的分岔点如何随着空间网格的细化而收敛，这是确保复杂反应堆模拟准确性的一个至关重要的考量。",
            "id": "4215729",
            "problem": "考虑一个一维单相冷却剂通道的空间离散化线性模型，该模型与带有一个缓发中子群的点中子动力学模型进行热耦合。目标是计算估算的分岔位置（定义为谱横坐标穿过零时的无量纲外部反应性值）如何依赖于热工水力离散化中使用的轴向网格单元数量，并量化该估计值在网格细化下的收敛性。\n\n从以下基本且经过充分检验的建模事实出发：\n\n- 带有一个缓发中子群的中子点动力学模型：归一化功率分数偏差 $p(t)$ 和缓发中子先驱核浓度偏差 $c(t)$ 满足\n$$\n\\frac{dp}{dt} = \\frac{\\rho_{\\text{ext}} - \\beta}{\\Lambda}\\,p + \\lambda_d\\,c + \\frac{\\alpha_T}{\\Lambda}\\,\\overline{\\theta}, \\quad\n\\frac{dc}{dt} = \\frac{\\beta}{\\Lambda}\\,p - \\lambda_d\\,c,\n$$\n其中 $\\rho_{\\text{ext}}$ 是无量纲外部反应性，$\\beta$ 是总缓发中子份额，$\\Lambda$ 是瞬发中子代长时间（单位为秒），$\\lambda_d$ 是缓发中子先驱核衰变常数（单位为秒的倒数），$\\alpha_T$ 是单位平均冷却剂温度扰动的（负）反应性系数，$\\overline{\\theta}$ 是沿通道的冷却剂温度扰动的算术平均值。\n\n- 具有轴向平流和线性热量移除的单相冷却剂能量平衡，在零扰动的稳态点附近线性化：对于冷却剂温度扰动 $\\theta(z,t)$，连续介质模型为\n$$\n\\frac{\\partial \\theta}{\\partial t} + u\\,\\frac{\\partial \\theta}{\\partial z} = -\\frac{1}{\\tau_c}\\,\\theta + k_{th}\\, p,\n$$\n其中 $u$ 是平均冷却剂速度（单位为米/秒），$\\tau_c$ 是冷却剂特征热量移除时间（单位为秒），$k_{th}$ 是一个有效耦合系数（单位为秒的倒数）。\n\n- 空间半离散化：将长度为 $L$ 的通道离散化为 $N$ 个大小为 $\\Delta z = L/N$ 的均匀网格单元，索引为 $i=1,\\dots,N$。对平流算子使用一阶迎风有限体积格式，并采用入口狄利克雷边界扰动 $\\theta_0(t) = 0$。用 $\\theta_i(t)$ 表示网格单元平均温度扰动。半离散冷却剂系统为\n$$\n\\frac{d\\theta_i}{dt} = -\\frac{u}{\\Delta z}\\,\\left(\\theta_i - \\theta_{i-1}\\right) - \\frac{1}{\\tau_c}\\,\\theta_i + k_{th}\\,p, \\quad i=1,\\dots,N,\n$$\n其中 $\\theta_0 \\equiv 0$。平均冷却剂温度扰动近似为\n$$\n\\overline{\\theta} = \\frac{1}{N}\\sum_{i=1}^N \\theta_i.\n$$\n\n构建状态向量 $x = [p, c, \\theta_1, \\dots, \\theta_N]^T$ 的线性时不变系统：\n$$\n\\frac{dx}{dt} = A(\\rho_{\\text{ext}}; N)\\,x,\n$$\n其中 $A(\\rho_{\\text{ext}}; N)$ 是一个依赖于 $\\rho_{\\text{ext}}$ 和 $N$ 的 $(N+2)\\times (N+2)$ 雅可比矩阵。\n\n对于固定的 $N$，将分岔位置定义为值 $\\rho_{\\text{crit}}(N)$，使得谱横坐标 $s_{\\max}(\\rho_{\\text{ext}}; N) = \\max \\{\\Re(\\lambda): \\lambda \\in \\sigma(A(\\rho_{\\text{ext}}; N))\\}$ 满足 $s_{\\max}(\\rho_{\\text{crit}}(N); N) = 0$。在实践中，通过对 $s_{\\max}(\\rho_{\\text{ext}}; N)$ 使用区间法进行寻根来计算 $\\rho_{\\text{crit}}(N)$，直到 $\\rho_{\\text{ext}}$ 的区间宽度小于 $10^{-10}$。\n\n您的程序必须实现以下参数值的矩阵构建和特征值计算（所有未明确说明的变量均为无量纲）：\n\n- 所有测试的通用常数：\n  - 瞬发中子代长时间 $\\Lambda = 1\\times 10^{-4}\\,\\text{s}$。\n  - 总缓发中子份额 $\\beta = 6.5\\times 10^{-3}$。\n  - 缓发中子衰变常数 $\\lambda_d = 8.0\\times 10^{-2}\\,\\text{s}^{-1}$。\n  - 反应性-温度系数 $\\alpha_T = -2.0\\times 10^{-3}$。\n  - 冷却剂移除时间 $\\tau_c = 2.0\\,\\text{s}$。\n  - 热耦合系数 $k_{th} = 5.0\\times 10^{-1}\\,\\text{s}^{-1}$。\n  - 通道长度 $L = 1.0$。\n  - 使用初始寻根区间 $\\rho_{\\text{ext}}\\in[-2\\times 10^{-2},\\,2\\times 10^{-2}]$，并根据需要对称地扩展该区间，最多迭代10次，若总宽度超过 $5\\times 10^{-1}$ 则停止。如果没有找到谱横坐标的符号变化，则对该估计值返回一个非数值（IEEE 浮点数 NaN）。\n\n实现以下测试套件以评估网格细化下的敏感性和收敛性：\n\n- 测试1（正常路径，存在平流）：使用冷却剂速度 $u = 5\\times 10^{-1}$ 和网格 $N\\in\\{16, 32, 64\\}$。计算这三个 $N$ 值的 $\\rho_{\\text{crit}}(N)$，并报告通过 Richardson 型公式估算的观测收敛阶 $p$\n$$\np = \\frac{\\log\\left(\\left|\\rho_{\\text{crit}}(16) - \\rho_{\\text{crit}}(32)\\right|\\right) - \\log\\left(\\left|\\rho_{\\text{crit}}(32) - \\rho_{\\text{crit}}(64)\\right|\\right)}{\\log(2)}.\n$$\n如果任何差值为零或非数值，则为 $p$ 返回一个非数值。\n\n- 测试2（零平流边界条件，预期空间敏感性最小）：使用冷却剂速度 $u = 0$ 和网格 $N\\in\\{8, 16, 32, 64\\}$。计算敏感性度量\n$$\nS = \\max_{N\\in\\{8, 16, 32, 64\\}} \\rho_{\\text{crit}}(N) - \\min_{N\\in\\{8, 16, 32, 64\\}} \\rho_{\\text{crit}}(N).\n$$\n\n- 测试3（强平流和粗网格的边缘情况）：使用冷却剂速度 $u = 2.0$ 和网格 $N\\in\\{4, 8\\}$。计算绝对差\n$$\nD = \\left|\\rho_{\\text{crit}}(4) - \\rho_{\\text{crit}}(8)\\right|.\n$$\n\n所有输出均为无量纲实数。您的程序必须按 $[p, S, D]$ 的顺序计算这三个标量结果，并打印一行包含这三个浮点数的列表。输出格式必须严格为方括号内由逗号分隔的列表，例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$。不应打印任何额外文本。问题不涉及角度，不需要角度单位。由于所有量都是无量纲的，输出中不应出现物理单位符号。",
            "solution": "用户要求对一个线性化反应堆动力学模型进行分析，以研究分岔点估计值相对于空间离散化的收敛性。该模型将点中子动力学与一维单相冷却剂通道耦合。问题是计算临界外部反应性 $\\rho_{\\text{crit}}(N)$，即系统变得不稳定时的反应性值，这针对不同的空间网格单元数 $N$ 和不同的冷却剂速度 $u$ 进行。这是一个经典的稳定性分析问题，通过寻找系统雅可比矩阵的谱横坐标穿过零的点来解决。\n\n求解方法包括三个主要部分：\n1.  **系统矩阵构建**：对于给定的外部反应性 $\\rho_{\\text{ext}}$ 和网格单元数 $N$，构建 $(N+2) \\times (N+2)$ 的系统矩阵 $A(\\rho_{\\text{ext}}; N)$。\n2.  **谱横坐标计算**：计算 $A$ 的特征值并找出谱横坐标 $s_{\\max} = \\max_j \\Re(\\lambda_j)$，即复平面中最右侧特征值的实部。\n3.  **寻根**：通过求解非线性方程 $s_{\\max}(\\rho_{\\text{ext}}; N) = 0$ 来确定临界反应性 $\\rho_{\\text{crit}}(N)$。这通过指定的数值寻根算法完成。\n\n令状态向量为 $x = [p, c, \\theta_1, \\dots, \\theta_N]^T$。常微分方程组为 $\\frac{dx}{dt} = A x$。我们基于所给方程逐行构建矩阵 $A$。\n\n前两行对应于归一化功率偏差 $p(t)$ 和先驱核浓度偏差 $c(t)$ 的点动力学方程：\n$$\n\\frac{dp}{dt} = \\frac{\\rho_{\\text{ext}} - \\beta}{\\Lambda}\\,p + \\lambda_d\\,c + \\frac{\\alpha_T}{\\Lambda N}\\sum_{i=1}^N \\theta_i\n$$\n$$\n\\frac{dc}{dt} = \\frac{\\beta}{\\Lambda}\\,p - \\lambda_d\\,c\n$$\n这给出了矩阵 $A$ 的前两行：\n-   $A_{0,0} = \\frac{\\rho_{\\text{ext}} - \\beta}{\\Lambda}$\n-   $A_{0,1} = \\lambda_d$\n-   $A_{0, j} = \\frac{\\alpha_T}{\\Lambda N}$ 对于 $j=2, \\dots, N+1$\n-   $A_{1,0} = \\frac{\\beta}{\\Lambda}$\n-   $A_{1,1} = -\\lambda_d$\n-   $A_{1, j} = 0$ 对于 $j=2, \\dots, N+1$\n\n剩下的 $N$ 行描述了 $i=1, \\dots, N$ 的网格单元平均温度扰动 $\\theta_i(t)$。半离散化方程为：\n$$\n\\frac{d\\theta_i}{dt} = -\\frac{u}{\\Delta z}\\,\\theta_i + \\frac{u}{\\Delta z}\\,\\theta_{i-1} - \\frac{1}{\\tau_c}\\,\\theta_i + k_{th}\\,p\n$$\n其中 $\\Delta z = L/N$，边界条件为 $\\theta_0=0$。按状态变量对各项进行分组：\n$$\n\\frac{d\\theta_i}{dt} = k_{th}\\,p + \\left(\\frac{u N}{L}\\right)\\theta_{i-1} - \\left(\\frac{u N}{L} + \\frac{1}{\\tau_c}\\right)\\theta_i\n$$\n这定义了矩阵 $A$ 的第 $k=2, \\dots, N+1$ 行（其中第 $k$ 行对应于 $i=k-1$ 的 $\\theta_{i}$）：\n-   $A_{k, 0} = k_{th}$\n-   对于 $i=1$（第 $k=2$ 行），$\\theta_{i-1}$ 项为零：\n    -   $A_{2, 2} = -\\left(\\frac{u N}{L} + \\frac{1}{\\tau_c}\\right)$\n-   对于 $i=2, \\dots, N$（第 $k=3, \\dots, N+1$ 行），该方程填充了热工水力子矩阵中的两个条目：\n    -   $A_{k, k-1} = \\frac{u N}{L}$（来自 $\\theta_{i-1}$ 的次对角线项）\n    -   $A_{k, k} = -\\left(\\frac{u N}{L} + \\frac{1}{\\tau_c}\\right)$（来自 $\\theta_i$ 的对角线项）\n\n在建立了构建 $A(\\rho_{\\text{ext}}; N)$ 的函数后，可以实现一个 `get_spectral_abscissa` 函数，使用 `numpy.linalg.eigvals` 来计算特征值并找到其最大实部。\n\n要找到 $\\rho_{\\text{crit}}(N)$，我们需要找到 $f(\\rho_{\\text{ext}}) = s_{\\max}(\\rho_{\\text{ext}}; N) = 0$ 的根。一个稳健的区间法，如二分法，是合适的。搜索从指定的区间 $[-0.02, 0.02]$ 开始。如果端点处的谱横坐标符号不同，则对称地扩展区间，每步宽度加倍，最多扩展10次或直到宽度超过 $0.5$。如果未找到包含根的有效区间，函数返回一个非数值（`NaN`）。一旦找到一个区间 $[a, b]$ 使得 $f(a) \\cdot f(b) \\le 0$，二分法将迭代地将区间减半，直到其宽度小于所需的 $10^{-10}$ 容差。\n\n当 $u=0$ 时出现一个特殊情况。平流项消失，使得温度方程相互解耦。所有的 $\\theta_i$ 方程都变得相同：$\\frac{d\\theta_i}{dt} = k_{th}p - \\frac{1}{\\tau_c}\\theta_i$。这意味着所有 $\\theta_i(t)$ 的演化都相同，因此对于任何 $i$，都有 $\\overline{\\theta}(t) = \\theta_i(t)$。这个 $(N+2)$ 维的系统会塌缩为一个与 $N$ 无关的 $3 \\times 3$ 系统。因此，对于 $u=0$，$\\rho_{\\text{crit}}(N)$ 对所有 $N$ 都必须是常数，并且测试2中的敏感性度量 $S$ 预期为零（或由于浮点精度而接近零）。\n\n最终的程序实现了此逻辑以执行三个指定的测试：\n1.  **测试1**：计算当 $u=0.5$ 和网格 $N \\in \\{16, 32, 64\\}$ 时的收敛阶 $p$。\n2.  **测试2**：计算当 $u=0$ 和网格 $N \\in \\{8, 16, 32, 64\\}$ 时的敏感性 $S$。\n3.  **测试3**：计算当 $u=2.0$ 和粗网格 $N \\in \\{4, 8\\}$ 时的绝对差 $D$。\n\n然后按要求格式化并打印结果 $[p, S, D]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to perform bifurcation analysis for a linearized\n    reactor model and compute the specified test case results.\n    \"\"\"\n\n    # Common physical parameters\n    params = {\n        'Lambda': 1e-4,     # s\n        'beta': 6.5e-3,     # dimensionless\n        'lambda_d': 8.0e-2, # s^-1\n        'alpha_T': -2.0e-3, # per K or dimensionless temp\n        'tau_c': 2.0,       # s\n        'k_th': 5.0e-1,     # s^-1\n        'L': 1.0,           # dimensionless (or m)\n    }\n\n    def get_spectral_abscissa(rho_ext, N, u, p):\n        \"\"\"\n        Constructs the system matrix A(rho_ext; N) and returns its spectral abscissa.\n        \"\"\"\n        M = N + 2\n        A = np.zeros((M, M), dtype=np.float64)\n\n        # Unpack parameters for convenience\n        Lambda, beta, lambda_d = p['Lambda'], p['beta'], p['lambda_d']\n        alpha_T, tau_c, k_th, L = p['alpha_T'], p['tau_c'], p['k_th'], p['L']\n\n        # Row 0: dp/dt\n        A[0, 0] = (rho_ext - beta) / Lambda\n        A[0, 1] = lambda_d\n        A[0, 2:] = alpha_T / (Lambda * N)\n\n        # Row 1: dc/dt\n        A[1, 0] = beta / Lambda\n        A[1, 1] = -lambda_d\n\n        # Rows 2 to N+1: d(theta_i)/dt\n        delta_z = L / N\n        if u > 0:\n            term_adv = u / delta_z\n        else: # Handles u=0 case cleanly\n            term_adv = 0.0\n\n        term_diag = -(term_adv + 1.0 / tau_c)\n\n        for i in range(1, N + 1):\n            row_idx = i + 1\n            A[row_idx, 0] = k_th\n            A[row_idx, row_idx] = term_diag\n            if i > 1:\n                A[row_idx, row_idx - 1] = term_adv\n        \n        eigenvalues = np.linalg.eigvals(A)\n        return np.max(eigenvalues.real)\n\n    def find_rho_crit(N, u, p):\n        \"\"\"\n        Finds the critical reactivity rho_crit(N) using a bracketing root-finder.\n        \"\"\"\n        # Initial bracket and search parameters\n        rho_min, rho_max = -2e-2, 2e-2\n        max_bracket_width = 5e-1\n        max_expansions = 10\n        tolerance = 1e-10\n\n        s_min = get_spectral_abscissa(rho_min, N, u, p)\n        s_max_val = get_spectral_abscissa(rho_max, N, u, p)\n        \n        # Bracket expansion loop\n        found_bracket = False\n        if s_min * s_max_val = 0:\n            found_bracket = True\n        else:\n            for _ in range(max_expansions):\n                width = rho_max - rho_min\n                # Stop if next expansion exceeds width limit\n                if width * 2 > max_bracket_width:\n                    break\n                \n                # Symmetrically expand the bracket\n                rho_min -= width / 2\n                rho_max += width / 2\n                \n                s_min = get_spectral_abscissa(rho_min, N, u, p)\n                s_max_val = get_spectral_abscissa(rho_max, N, u, p)\n                \n                if s_min * s_max_val = 0:\n                    found_bracket = True\n                    break\n\n        if not found_bracket:\n            return np.nan\n\n        # Bisection method for root-finding\n        # Ensure s_min is negative and s_max_val is positive\n        if s_min > 0:\n            s_min, s_max_val = s_max_val, s_min\n            rho_min, rho_max = rho_max, rho_min\n\n        while rho_max - rho_min > tolerance:\n            rho_mid = rho_min + (rho_max - rho_min) / 2\n            s_mid = get_spectral_abscissa(rho_mid, N, u, p)\n            if s_mid  0:\n                rho_min = rho_mid\n            else:\n                rho_max = rho_mid\n        \n        return (rho_min + rho_max) / 2\n\n    # --- Test Case 1: Convergence Order ---\n    u1 = 5e-1\n    N_vals1 = [16, 32, 64]\n    rho_crit_vals1 = [find_rho_crit(N, u1, params) for N in N_vals1]\n    \n    p = np.nan\n    r16, r32, r64 = rho_crit_vals1\n    if not any(np.isnan(v) for v in rho_crit_vals1):\n        diff1 = r16 - r32\n        diff2 = r32 - r64\n        if diff1 != 0 and diff2 != 0:\n            p = np.log(np.abs(diff1 / diff2)) / np.log(2)\n\n    # --- Test Case 2: Zero Advection Sensitivity ---\n    u2 = 0.0\n    N_vals2 = [8, 16, 32, 64]\n    rho_crit_vals2 = [find_rho_crit(N, u2, params) for N in N_vals2]\n\n    S = np.nan\n    if not any(np.isnan(v) for v in rho_crit_vals2):\n        S = np.max(rho_crit_vals2) - np.min(rho_crit_vals2)\n\n    # --- Test Case 3: Coarse Mesh Difference ---\n    u3 = 2.0\n    N_vals3 = [4, 8]\n    rho_crit_vals3 = [find_rho_crit(N, u3, params) for N in N_vals3]\n\n    D = np.nan\n    r4, r8 = rho_crit_vals3\n    if not any(np.isnan(v) for v in rho_crit_vals3):\n        D = np.abs(r4 - r8)\n\n    results = [p, S, D]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}