{
    "hands_on_practices": [
        {
            "introduction": "在我们信任一个复杂模拟的结果之前，我们必须首先验证我们的代码是否正确地求解了它所设计的方程。人造解法（Method of Manufactured Solutions, MMS）是用于此验证过程的一个强大且标准的技术。本练习  将引导您完成应用MMS的实际步骤：您将从一个选定的人造解出发，反向推导出必须提供给输运方程的相应源项和边界条件，从而为代码验证奠定坚实基础。",
            "id": "4257834",
            "problem": "考虑在有界凸区域 $\\mathcal{D} \\subset \\mathbb{R}^{3}$ 中的单一群 $g$ 瞬态线性玻尔兹曼输运方程，其边界 $\\partial \\mathcal{D}$ 上的单位外法向量为 $\\mathbf{n}(\\mathbf{r})$：\n$$\n\\frac{1}{v_{g}}\\,\\frac{\\partial \\psi_{g}(\\mathbf{r},\\Omega,t)}{\\partial t} + \\Omega \\cdot \\nabla \\psi_{g}(\\mathbf{r},\\Omega,t) + \\Sigma_{t,g}\\,\\psi_{g}(\\mathbf{r},\\Omega,t) = \\frac{\\Sigma_{s,g}}{4\\pi}\\,\\phi_{g}(\\mathbf{r},t) + S_{g}(\\mathbf{r},\\Omega,t),\n$$\n其中 $\\psi_{g}(\\mathbf{r},\\Omega,t)$ 是角通量，$v_{g}$ 是粒子速度，$\\Omega \\in \\mathbb{S}^{2}$ 是方向单位矢量，$\\Sigma_{t,g}$ 是宏观总截面，$\\Sigma_{s,g}$ 是宏观各向同性（群内）散射截面，$\\phi_{g}(\\mathbf{r},t) = \\int_{4\\pi} \\psi_{g}(\\mathbf{r},\\Omega,t)\\,d\\Omega$ 是标量通量。假设除了待确定的伪造源 $S_{g}(\\mathbf{r},\\Omega,t)$ 之外，没有裂变，也没有其他固定源。所有材料性质均为空间均匀且不随时间变化。\n\n使用伪造解方法（MMS），通过取如下形式来构造一个伪造角通量，该角通量沿每个方向 $\\Omega$ 以恒定速度 $v_{g}$ 传播：\n$$\n\\psi_{g}(\\mathbf{r},\\Omega,t) = A_{g} + B_{g}\\,\\left(\\Omega \\cdot \\mathbf{r} - v_{g}\\,t\\right),\n$$\n其中 $A_{g}$ 和 $B_{g}$ 是实常数。从第一性原理出发，推导精确的伪造源 $S_{g}(\\mathbf{r},\\Omega,t)$ 以及相应的边界和初始条件，使得 $\\psi_{g}$ 成为上述输运方程的精确解。\n\n以 $A_{g}$、$B_{g}$、$\\mathbf{r}$、$\\Omega$、$t$、$v_{g}$、$\\Sigma_{t,g}$ 和 $\\Sigma_{s,g}$ 的形式，给出 $S_{g}(\\mathbf{r},\\Omega,t)$ 的最终答案，该答案应为一个单一的闭式解析表达式。无需进行数值评估。在推导过程中，用文字和公式表述边界条件和初始条件，但最终答案应仅为源项表达式。答案不应包含单位。如果由于角度积分而产生任何简化，请在推导中予以说明。伪造解必须与沿方向 $\\Omega$ 以速度 $v_{g}$ 传播的具有物理意义的输运过程相一致。\n\n你的最终方框答案必须是单一的解析表达式，而非方程、不等式或一组多个表达式。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **控制方程**：在有界凸区域 $\\mathcal{D} \\subset \\mathbb{R}^{3}$ 中的单一群 $g$ 瞬态线性玻尔兹曼输运方程：\n$$\n\\frac{1}{v_{g}}\\,\\frac{\\partial \\psi_{g}(\\mathbf{r},\\Omega,t)}{\\partial t} + \\Omega \\cdot \\nabla \\psi_{g}(\\mathbf{r},\\Omega,t) + \\Sigma_{t,g}\\,\\psi_{g}(\\mathbf{r},\\Omega,t) = \\frac{\\Sigma_{s,g}}{4\\pi}\\,\\phi_{g}(\\mathbf{r},t) + S_{g}(\\mathbf{r},\\Omega,t)\n$$\n- **伪造解**：建议的角通量形式为：\n$$\n\\psi_{g}(\\mathbf{r},\\Omega,t) = A_{g} + B_{g}\\,\\left(\\Omega \\cdot \\mathbf{r} - v_{g}\\,t\\right)\n$$\n- **定义**：\n    - $\\psi_{g}(\\mathbf{r},\\Omega,t)$: 角中子通量。\n    - $v_{g}$: 粒子速度（常数）。\n    - $\\Omega \\in \\mathbb{S}^{2}$: 方向单位矢量。\n    - $\\mathbf{r} \\in \\mathcal{D}$: 位置矢量。\n    - $t$: 时间。\n    - $\\Sigma_{t,g}$: 宏观总截面（常数）。\n    - $\\Sigma_{s,g}$: 宏观各向同性散射截面（常数）。\n    - $\\phi_{g}(\\mathbf{r},t) = \\int_{4\\pi} \\psi_{g}(\\mathbf{r},\\Omega,t)\\,d\\Omega$: 标量通量。\n    - $S_{g}(\\mathbf{r},\\Omega,t)$: 待确定的伪造源项。\n    - $A_{g}, B_{g}$: 实常数。\n- **假设**：材料性质空间均匀且不随时间变化。无裂变。除伪造源外，无外部固定源。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于线性玻尔兹曼输运方程，这是反应堆物理学和输运理论的基石。伪造解方法（MMS）是用于程序验证的一种标准的、严谨的技术。该问题在科学和数学上都是合理的。\n- **适定性**：在 MMS 的背景下，该问题是适定的。它要求推导一个源项和相应的边界/初始条件，使得一个给定的解析函数成为控制偏微分方程的精确解。这就是 MMS 过程的定义。\n- **客观性**：该问题使用精确的数学语言和公认的物理术语进行陈述，不含主观性。\n- **完整性与一致性**：该问题提供了推导所要求的源项和条件所需的所有必要信息（偏微分方程、解的形式、所有变量定义）。已知条件是自洽的。\n\n### 步骤 3：结论与行动\n问题有效。将提供解答。\n\n伪造解方法（MMS）要求将建议的伪造解代入控制偏微分方程，并求解使等式成立的源项。控制方程可以重排以表达源项 $S_{g}(\\mathbf{r},\\Omega,t)$：\n$$\nS_{g}(\\mathbf{r},\\Omega,t) = \\frac{1}{v_{g}}\\,\\frac{\\partial \\psi_{g}}{\\partial t} + \\Omega \\cdot \\nabla \\psi_{g} + \\Sigma_{t,g}\\,\\psi_{g} - \\frac{\\Sigma_{s,g}}{4\\pi}\\,\\phi_{g}\n$$\n我们将使用伪造解 $\\psi_{g}(\\mathbf{r},\\Omega,t) = A_{g} + B_{g}\\,\\left(\\Omega \\cdot \\mathbf{r} - v_{g}\\,t\\right)$ 来计算右侧的每一项。\n\n首先，我们计算 $\\psi_{g}$ 的时间导数：\n$$\n\\frac{\\partial \\psi_{g}}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ A_{g} + B_{g}\\,\\left(\\Omega \\cdot \\mathbf{r} - v_{g}\\,t\\right) \\right] = B_{g} (-v_{g}) = -B_{g}v_{g}\n$$\n因此，源方程的第一项是：\n$$\n\\frac{1}{v_{g}}\\,\\frac{\\partial \\psi_{g}}{\\partial t} = \\frac{1}{v_{g}}(-B_{g}v_{g}) = -B_{g}\n$$\n接下来，我们计算 $\\psi_{g}$ 关于空间变量 $\\mathbf{r}$ 的梯度：\n$$\n\\nabla \\psi_{g} = \\nabla \\left[ A_{g} + B_{g}\\,\\left(\\Omega \\cdot \\mathbf{r} - v_{g}\\,t\\right) \\right] = B_{g} \\nabla(\\Omega \\cdot \\mathbf{r})\n$$\n标量场 $\\Omega \\cdot \\mathbf{r}$ 的梯度是矢量 $\\Omega$。因此，\n$$\n\\nabla \\psi_{g} = B_{g} \\Omega\n$$\n迁移项 $\\Omega \\cdot \\nabla \\psi_{g}$ 变为：\n$$\n\\Omega \\cdot \\nabla \\psi_{g} = \\Omega \\cdot (B_{g}\\Omega) = B_{g}(\\Omega \\cdot \\Omega)\n$$\n由于 $\\Omega$ 是单位矢量，$\\Omega \\cdot \\Omega = |\\Omega|^2 = 1$。迁移项简化为：\n$$\n\\Omega \\cdot \\nabla \\psi_{g} = B_{g}\n$$\n前两项的和揭示了伪造解的一个关键性质：\n$$\n\\frac{1}{v_{g}}\\,\\frac{\\partial \\psi_{g}}{\\partial t} + \\Omega \\cdot \\nabla \\psi_{g} = -B_{g} + B_{g} = 0\n$$\n这意味着伪造解是无源、无碰撞输运方程的一个解，代表一个在方向 $\\Omega$ 上以速度 $v_g$ 传播的波。源项的表达式简化为：\n$$\nS_{g}(\\mathbf{r},\\Omega,t) = \\Sigma_{t,g}\\,\\psi_{g} - \\frac{\\Sigma_{s,g}}{4\\pi}\\,\\phi_{g}\n$$\n现在，我们必须通过对角通量在所有方向上积分来求得标量通量 $\\phi_{g}(\\mathbf{r},t)$：\n$$\n\\phi_{g}(\\mathbf{r},t) = \\int_{4\\pi} \\psi_{g}(\\mathbf{r},\\Omega,t) \\,d\\Omega = \\int_{4\\pi} \\left[ A_{g} + B_{g}\\left(\\Omega \\cdot \\mathbf{r} - v_{g}\\,t\\right) \\right] d\\Omega\n$$\n我们可以将积分拆分：\n$$\n\\phi_{g}(\\mathbf{r},t) = \\int_{4\\pi} A_{g}\\,d\\Omega + \\int_{4\\pi} B_{g}(\\Omega \\cdot \\mathbf{r})\\,d\\Omega - \\int_{4\\pi} B_{g}v_{g}t\\,d\\Omega\n$$\n逐项计算每个积分：\n1.  常数项的积分为 $\\int_{4\\pi} A_{g}\\,d\\Omega = A_{g} \\int_{4\\pi} d\\Omega = 4\\pi A_{g}$。\n2.  第二个积分为 $\\int_{4\\pi} B_{g}(\\Omega \\cdot \\mathbf{r})\\,d\\Omega = B_{g} \\mathbf{r} \\cdot \\int_{4\\pi} \\Omega \\,d\\Omega$。矢量 $\\Omega$ 在单位球面 $\\mathbb{S}^2$ 上的积分得到一个零矢量，即 $\\int_{4\\pi} \\Omega \\,d\\Omega = \\mathbf{0}$。这是由于对称性，因为对于每个方向 $\\Omega$，都存在一个相反的方向 $-\\Omega$。因此，该项为零。\n3.  第三个积分为 $\\int_{4\\pi} B_{g}v_{g}t\\,d\\Omega = B_{g}v_{g}t \\int_{4\\pi}d\\Omega = 4\\pi B_{g}v_{g}t$。\n\n结合这些结果得到标量通量：\n$$\n\\phi_{g}(\\mathbf{r},t) = 4\\pi A_{g} + 0 - 4\\pi B_{g}v_{g}t = 4\\pi (A_{g} - B_{g}v_{g}t)\n$$\n将 $\\psi_{g}$ 和 $\\phi_{g}$ 代入 $S_{g}$ 的简化表达式中：\n$$\nS_{g}(\\mathbf{r},\\Omega,t) = \\Sigma_{t,g} \\left[ A_{g} + B_{g}\\left(\\Omega \\cdot \\mathbf{r} - v_{g}\\,t\\right) \\right] - \\frac{\\Sigma_{s,g}}{4\\pi} \\left[ 4\\pi(A_{g} - B_{g}v_{g}t) \\right]\n$$\n$$\nS_{g}(\\mathbf{r},\\Omega,t) = \\Sigma_{t,g} \\left[ A_{g} + B_{g}(\\Omega \\cdot \\mathbf{r}) - B_{g}v_{g}t \\right] - \\Sigma_{s,g} \\left( A_{g} - B_{g}v_{g}t \\right)\n$$\n展开并合并同类项：\n$$\nS_{g}(\\mathbf{r},\\Omega,t) = \\Sigma_{t,g}A_{g} + \\Sigma_{t,g}B_{g}(\\Omega \\cdot \\mathbf{r}) - \\Sigma_{t,g}B_{g}v_{g}t - \\Sigma_{s,g}A_{g} + \\Sigma_{s,g}B_{g}v_{g}t\n$$\n对项进行分组并重新整理：\n$$\nS_{g}(\\mathbf{r},\\Omega,t) = (\\Sigma_{t,g} - \\Sigma_{s,g})A_{g} + \\Sigma_{t,g}B_{g}(\\Omega \\cdot \\mathbf{r}) - (\\Sigma_{t,g} - \\Sigma_{s,g})B_{g}v_{g}t\n$$\n提取公因式得到伪造源的最终表达式：\n$$\nS_{g}(\\mathbf{r},\\Omega,t) = (\\Sigma_{t,g} - \\Sigma_{s,g})\\left(A_{g} - B_{g}v_{g}t\\right) + \\Sigma_{t,g}B_{g}(\\Omega \\cdot \\mathbf{r})\n$$\n为完成 MMS 问题的设置，还必须指定初始条件和边界条件。\n初始条件通过计算 $t=0$ 时的伪造解得到：\n$$\n\\psi_{g}(\\mathbf{r},\\Omega,0) = A_{g} + B_{g}(\\Omega \\cdot \\mathbf{r}), \\quad \\forall \\mathbf{r} \\in \\mathcal{D}, \\forall \\Omega \\in \\mathbb{S}^{2}\n$$\n边界条件是在边界 $\\partial\\mathcal{D}$ 上给定的入射通量（狄利克雷类型）。对于边界上任意一点 $\\mathbf{r}_{b} \\in \\partial\\mathcal{D}$，其单位外法向量为 $\\mathbf{n}(\\mathbf{r}_{b})$，该条件是为所有满足 $\\Omega \\cdot \\mathbf{n}(\\mathbf{r}_{b})  0$ 的入射方向 $\\Omega$ 指定的：\n$$\n\\psi_{g}(\\mathbf{r}_{b},\\Omega,t) = A_{g} + B_{g}(\\Omega \\cdot \\mathbf{r}_{b} - v_{g}t), \\quad \\forall t \\ge 0, \\forall \\mathbf{r}_{b} \\in \\partial\\mathcal{D} \\mid \\Omega \\cdot \\mathbf{n}(\\mathbf{r}_{b})  0\n$$\n问题要求将源表达式作为最终答案。",
            "answer": "$$\n\\boxed{(\\Sigma_{t,g} - \\Sigma_{s,g})(A_{g} - B_{g}v_{g}t) + \\Sigma_{t,g}B_{g}(\\Omega \\cdot \\mathbf{r})}\n$$"
        },
        {
            "introduction": "显式时间积分方法，如龙格-库塔（Runge-Kutta）系列方法，通常易于实现，但受到稳定性要求的限制。时间步长必须足够小，以防止数值误差无限增长，这一原则体现在著名的Courant-Friedrichs-Lewy（CFL）条件中。本练习  提供了一个动手实践的机会，推导经典的四阶龙格-库塔方法在应用于半离散输运方程时的最大稳定时间步长，从而将算子的谱性质与这一关键的模拟参数联系起来。",
            "id": "4257840",
            "problem": "考虑一个在空间均匀介质中具有周期性边界条件的单能群中子输运方程，该方程在角度上使用离散纵标 (SN) 方法离散，在空间上使用守恒中心格式离散。在这些假设下，流项的半离散线方法 (MOL) 公式可以写成\n$$\n\\frac{d\\boldsymbol{\\psi}(t)}{dt} = A \\boldsymbol{\\psi}(t),\n$$\n其中 $\\boldsymbol{\\psi}(t)$ 是角通量未知量的向量，$A$ 是流算子矩阵。对于所述的周期性能量守恒离散格式，$A$ 是斜厄米矩阵，因此其谱位于虚轴上。设谱半径为 $\\rho(A) \\equiv \\max_{j} |\\lambda_{j}|$，其中 $\\lambda_{j}$ 是 $A$ 的特征值。\n\n您使用经典的显式四阶四级 Runge–Kutta 方法对该系统进行时间推进，该方法由其 Butcher tableau 定义\n$$\n\\begin{array}{c|cccc}\n0  0  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0  0 \\\\\n\\frac{1}{2}  0  \\frac{1}{2}  0  0 \\\\\n1  0  0  1  0 \\\\\n\\hline\n  \\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}  \\frac{1}{6}\n\\end{array}\n$$\n并应用于线性系统 $\\frac{d\\boldsymbol{\\psi}}{dt}=A\\boldsymbol{\\psi}$。\n\n从应用于标量测试方程 $\\frac{dy}{dt}=\\lambda y$ 的 Runge–Kutta 方法的线性稳定性要求，以及根据方法的放大因子定义的稳定域出发，推导当 $A$ 的特征值为纯虚数时该方法的最大稳定时间步长 $\\Delta t_{\\max}$，并用 $\\rho(A)$ 的符号形式表示您的最终答案。在含时输运模拟的背景下对结果进行物理解释。时间步长以秒为单位表示。无需进行数值取整；请提供一个闭式解析表达式作为您的最终答案。",
            "solution": "该问题是有效的，因为它在科学上基于偏微分方程数值分析的原理，特别是线方法和常微分方程 (ODE) 的线性稳定性理论。该问题是适定的、客观的，并包含推导唯一且有意义的解所需的所有必要信息。\n\n问题要求使用经典的四阶 Runge-Kutta (RK$4$) 方法对半离散系统 $\\frac{d\\boldsymbol{\\psi}(t)}{dt} = A \\boldsymbol{\\psi}(t)$ 进行时间积分时的最大稳定时间步长 $\\Delta t_{\\max}$。线性系统的数值方法的稳定性取决于其在标量测试方程 $\\frac{dy}{dt} = \\lambda y$ 上的表现，其中 $\\lambda$ 是矩阵 $A$ 的任意一个特征值。\n\n对于单步数值方法，时间步 $n+1$ 的解与时间步 $n$ 的解通过一个放大因子 $R(z)$ 相关联，即 $y_{n+1} = R(z) y_n$，其中 $z = \\lambda \\Delta t$。当且仅当对于 $A$ 的所有特征值 $\\lambda$，都有 $|R(z)| \\le 1$ 时，该方法是稳定的。满足此条件的复数 $z$ 的集合是绝对稳定域。\n\n首先，我们必须确定给定 RK$4$ 方法的稳定函数 $R(z)$。该方法由 Butcher tableau 定义：\n$$\n\\begin{array}{c|cccc}\n0  0  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0  0 \\\\\n\\frac{1}{2}  0  \\frac{1}{2}  0  0 \\\\\n1  0  0  1  0 \\\\\n\\hline\n  \\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}  \\frac{1}{6}\n\\end{array}\n$$\n将此方法应用于测试方程 $\\frac{dy}{dt} = \\lambda y$ 得到以下几个阶段：\n$k_1 = f(y_n) = \\lambda y_n$\n$k_2 = f(y_n + \\Delta t (\\frac{1}{2} k_1)) = \\lambda(y_n + \\frac{\\Delta t}{2} (\\lambda y_n)) = \\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2})$\n$k_3 = f(y_n + \\Delta t (\\frac{1}{2} k_2)) = \\lambda(y_n + \\frac{\\Delta t}{2} (\\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2}))) = \\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2} + \\frac{(\\lambda \\Delta t)^2}{4})$\n$k_4 = f(y_n + \\Delta t (1 \\cdot k_3)) = \\lambda(y_n + \\Delta t (\\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2} + \\frac{(\\lambda \\Delta t)^2}{4}))) = \\lambda y_n (1 + \\lambda \\Delta t + \\frac{(\\lambda \\Delta t)^2}{2} + \\frac{(\\lambda \\Delta t)^3}{4})$\n\n解的更新由 $y_{n+1} = y_n + \\Delta t \\sum_{i=1}^{4} b_i k_i$ 给出。令 $z = \\lambda \\Delta t$。\n$y_{n+1} = y_n + \\Delta t \\left[ \\frac{1}{6}(\\lambda y_n) + \\frac{1}{3}(\\lambda y_n(1+\\frac{z}{2})) + \\frac{1}{3}(\\lambda y_n(1+\\frac{z}{2}+\\frac{z^2}{4})) + \\frac{1}{6}(\\lambda y_n(1+z+\\frac{z^2}{2}+\\frac{z^3}{4})) \\right]$\n$\\frac{y_{n+1}}{y_n} = 1 + z \\left[ \\frac{1}{6} + \\frac{1}{3}(1+\\frac{z}{2}) + \\frac{1}{3}(1+\\frac{z}{2}+\\frac{z^2}{4}) + \\frac{1}{6}(1+z+\\frac{z^2}{2}+\\frac{z^3}{4}) \\right]$\n$R(z) = 1 + z \\left[ \\frac{1}{6} + \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{6} \\right] + z^2 \\left[ \\frac{1}{6} + \\frac{1}{6} + \\frac{1}{6} \\right] + z^3 \\left[ \\frac{1}{12} + \\frac{1}{12} \\right] + z^4 \\left[ \\frac{1}{24} \\right]$\n$R(z) = 1 + z (1) + z^2 (\\frac{3}{6}) + z^3 (\\frac{2}{12}) + z^4 (\\frac{1}{24})$\n$R(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} = \\sum_{k=0}^{4} \\frac{z^k}{k!}$\n这是 $\\exp(z)$ 的4阶截断泰勒级数展开。\n\n问题陈述矩阵 $A$ 是斜厄米矩阵，这意味着其特征值 $\\lambda_j$ 是纯虚数。我们可以将任何这样的特征值写为 $\\lambda = i\\omega$，其中 $\\omega$ 是代表频率的实数。\n因此，$z = \\lambda \\Delta t = i \\omega \\Delta t$。我们定义一个实变量 $y = \\omega \\Delta t$，所以 $z=iy$。稳定性条件 $|R(z)| \\le 1$ 变为 $|R(iy)| \\le 1$。\n将 $z=iy$ 代入稳定函数：\n$R(iy) = 1 + (iy) + \\frac{(iy)^2}{2} + \\frac{(iy)^3}{6} + \\frac{(iy)^4}{24}$\n$R(iy) = 1 + iy - \\frac{y^2}{2} - i\\frac{y^3}{6} + \\frac{y^4}{24}$\n我们将实部和虚部分组：\n$R(iy) = \\left(1 - \\frac{y^2}{2} + \\frac{y^4}{24}\\right) + i\\left(y - \\frac{y^3}{6}\\right)$\n\n现在我们计算模的平方，$|R(iy)|^2$：\n$|R(iy)|^2 = \\left(1 - \\frac{y^2}{2} + \\frac{y^4}{24}\\right)^2 + \\left(y - \\frac{y^3}{6}\\right)^2$\n展开各项：\n$|R(iy)|^2 = \\left(1 - y^2 + \\frac{y^4}{4} + \\frac{y^4}{12} - \\frac{y^6}{24} + \\frac{y^8}{576}\\right) + \\left(y^2 - \\frac{y^4}{3} + \\frac{y^6}{36}\\right)$\n合并 $y$ 的同次幂项：\n$|R(iy)|^2 = 1 + y^4 \\left(\\frac{1}{4} + \\frac{1}{12} - \\frac{1}{3}\\right) + y^6 \\left(-\\frac{1}{24} + \\frac{1}{36}\\right) + \\frac{y^8}{576}$\n$y^4$ 项的系数是 $\\frac{3+1-4}{12} = 0$，这对于一个4阶方法是预期的。\n$|R(iy)|^2 = 1 + y^6 \\left(\\frac{-3+2}{72}\\right) + \\frac{y^8}{576} = 1 - \\frac{y^6}{72} + \\frac{y^8}{576}$\n\n稳定域的边界通过设置 $|R(iy)|=1$ 或 $|R(iy)|^2=1$ 来找到。\n$1 - \\frac{y^6}{72} + \\frac{y^8}{576} = 1$\n对于 $y \\neq 0$ 的非平凡解，我们可以除以 $y^6$：\n$\\frac{y^2}{576} - \\frac{1}{72} = 0$\n$\\frac{y^2}{576} = \\frac{1}{72}$\n$y^2 = \\frac{576}{72} = 8$\n$|y| = \\sqrt{8} = 2\\sqrt{2}$\n\n这个结果意味着，为了保证稳定性，我们需要 $|y| = |\\omega \\Delta t| \\le 2\\sqrt{2}$。这个条件必须对矩阵 $A$ 的所有特征值 $\\lambda_j = i\\omega_j$ 都成立。\n$|\\omega_j \\Delta t| \\le 2\\sqrt{2} \\quad \\forall j$\n这等价于：\n$\\Delta t \\cdot \\max_j |\\omega_j| \\le 2\\sqrt{2}$\n$A$ 的谱半径定义为 $\\rho(A) = \\max_j |\\lambda_j|$。因为 $\\lambda_j = i\\omega_j$，我们有 $|\\lambda_j| = |i\\omega_j| = |\\omega_j|$。因此，$\\rho(A) = \\max_j |\\omega_j|$。\n稳定性条件变为：\n$\\Delta t \\cdot \\rho(A) \\le 2\\sqrt{2}$\n最大稳定时间步长 $\\Delta t_{\\max}$ 对应于等式成立的情况：\n$\\Delta t_{\\max} = \\frac{2\\sqrt{2}}{\\rho(A)}$\n\n问题要求物理解释。这个结果是 Courant-Friedrichs-Lewy (CFL) 条件的一种形式。半离散流算子的谱半径 $\\rho(A)$ 由网格能支持的最高频率空间模式和粒子速度决定。对于空间网格间距为 $\\Delta x$、最大特征速度为 $v_{\\max}$ 的情况，$\\rho(A)$ 与 $\\frac{v_{\\max}}{\\Delta x}$ 成正比。因此，$\\Delta t_{\\max} \\propto \\frac{\\Delta x}{v_{\\max}}$。这意味着时间步长必须足够小，以至于以最大速度运动的粒子在一个时间步长内不会穿过超过一定数量的空间单元。比例常数 $2\\sqrt{2}$ 特定于 RK$4$ 方法对于纯振荡系统（由斜厄米算子描述）的稳定性属性。不同的数值格式会产生不同的常数。该表达式以秒为单位给出答案，因为根据控制方程 $\\frac{d\\boldsymbol{\\psi}}{dt} = A\\boldsymbol{\\psi}$，$\\rho(A)$ 的单位是秒的倒数 ($s^{-1}$)。",
            "answer": "$$\n\\boxed{\\frac{2\\sqrt{2}}{\\rho(A)}}\n$$"
        },
        {
            "introduction": "为了克服显式方法的严格时间步长限制，我们可以转向通常无条件稳定的隐式格式。然而，这种稳定性是以计算成本为代价的：在每一步，我们都必须求解一个大型线性方程组。本练习  探讨了这一权衡，要求您分析隐式后向欧拉离散化所产生的矩阵系统。通过计算该矩阵的谱和条件数，您将揭示时间步长 $\\Delta t$ 和网格尺寸 $h$ 等参数如何直接影响求解该系统的难度，这是高级模拟效率的关键考量。",
            "id": "4257829",
            "problem": "考虑无碰撞、一维、时间相关的线性输运方程，该方程以平板几何中的角通量 $\\psi(x,\\mu,t)$ 写出，\n$$\n\\frac{1}{v}\\,\\frac{\\partial \\psi}{\\partial t} + \\mu \\frac{\\partial \\psi}{\\partial x} = 0,\n$$\n其中 $x \\in [0,L)$，具有周期性边界条件，$t \\ge 0$，$\\mu$ 是方向余弦，$v$ 是恒定的粒子速度。使用双角度离散纵标 (SN) 方法 (S2) 对角度进行离散化，横坐标为 $\\mu_1 = +1/\\sqrt{3}$ 和 $\\mu_2 = -1/\\sqrt{3}$，权重相等。在一个包含 $N$ 个宽度为 $h=L/N$ 的单元的均匀网格上对空间进行离散化，并使用与周期性边界一致的一阶迎风有限体积离散格式。将给定纵标 $\\mu$ 的单元平均角通量向量表示为 $\\boldsymbol{\\psi}_{\\mu}$。\n\n将半离散系统定义为向量形式\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\psi} + A\\,\\boldsymbol{\\psi} = 0,\\quad \\boldsymbol{\\psi} = \\begin{bmatrix}\\boldsymbol{\\psi}_{\\mu_1} \\\\ \\boldsymbol{\\psi}_{\\mu_2}\\end{bmatrix},\n$$\n其中 $A$ 是按速度 $v$ 缩放的分块对角离散迁移算子，\n$$\nA = \\mathrm{diag}\\left( v\\,D(\\mu_1),\\, v\\,D(\\mu_2) \\right).\n$$\n此处，$D(\\mu)$ 是具有周期性环绕的 $N \\times N$ 迎风离散导数矩阵：\n- 对于 $\\mu  0$，$D(\\mu) = \\frac{\\mu}{h}\\left(I - S^{-1}\\right)$，其中 $S^{-1}$ 将向量向下移动一个索引并环绕。\n- 对于 $\\mu  0$，$D(\\mu) = \\frac{\\mu}{h}\\left(S - I\\right)$，其中 $S$ 将向量向上移动一个索引并环绕。\n\n考虑应用于齐次系统的单个大小为 $\\Delta t$ 的隐式后向欧拉时间步，\n$$\n\\left(I + \\Delta t\\,A\\right)\\,\\boldsymbol{\\psi}^{n+1} = \\boldsymbol{\\psi}^{n}.\n$$\n对于给定的参数集 $(L, v, N, \\Delta t)$，执行以下操作：\n1. 利用周期性边界引起的已知循环结构，精确计算 $A$ 的全谱（$2N$ 个特征值的多重集）。您不能通过时间步进来近似谱；相反，应使用离散傅里叶模式来构建它。\n2. 根据此谱，计算以下三个定量诊断指标：\n   - $A$ 的谱半径，记为 $\\rho_A$，定义为 $\\rho_A = \\max_{\\lambda \\in \\sigma(A)} |\\lambda|$。以 $\\mathrm{s}^{-1}$ 为单位报告 $\\rho_A$。\n   - 后向欧拉系统矩阵 $M = I + \\Delta t\\,A$ 的 2-范数条件数，记为 $\\kappa(M)$，对于正规矩阵，其等于 $\\kappa(M) = \\dfrac{\\max_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|}{\\min_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|}$。以无量纲数报告 $\\kappa(M)$。\n   - 后向欧拉的每时间步最小模态放大因子，记为 $g_{\\min}$，定义为 $g_{\\min} = \\min_{\\lambda \\in \\sigma(A)} \\left| \\dfrac{1}{1 + \\Delta t\\,\\lambda} \\right|$。以无量纲数报告 $g_{\\min}$。\n3. 基于离散化的第一性原理和计算出的谱，解释特征值分布和 $\\kappa(M)$ 如何约束在每个时间步应用的迭代隐式求解器的收敛行为，重点关注其随 $\\Delta t$、$v$ 和 $h$ 的缩放关系。\n\n使用以下参数集测试套件，它们共同探测了一系列空间和时间分辨率，包括一个边界情况：\n- 测试 1：$L = 1.0\\,\\mathrm{m}$, $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$, $N = 8$, $\\Delta t = 1.0\\times 10^{-9}\\,\\mathrm{s}$。\n- 测试 2：$L = 1.0\\,\\mathrm{m}$, $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$, $N = 32$, $\\Delta t = 1.0\\times 10^{-8}\\,\\mathrm{s}$。\n- 测试 3：$L = 1.0\\,\\mathrm{m}$, $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$, $N = 64$, $\\Delta t = 1.0\\times 10^{-7}\\,\\mathrm{s}$。\n- 测试 4（边界情况）：$L = 1.0\\,\\mathrm{m}$, $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$, $N = 16$, $\\Delta t = 0.0\\,\\mathrm{s}$。\n\n您的程序必须：\n- 使用离散傅里叶模式角 $\\theta_k = 2\\pi k/N$（其中 $k = 0,1,\\dots,N-1$）和 S2 纵标 $\\mu = \\pm 1/\\sqrt{3}$，从循环结构解析地构建谱，无需进行数值时间积分。\n- 对每个测试，计算 $(\\rho_A, \\kappa(M), g_{\\min})$ 并将每个值四舍五入到小数点后六位。\n- 生成单行输出，其中包含结果，格式为逗号分隔的列表的列表，精确格式为\n$[\\,[\\rho_{A,1},\\kappa(M)_1,g_{\\min,1}],\\,[\\rho_{A,2},\\kappa(M)_2,g_{\\min,2}],\\,[\\rho_{A,3},\\kappa(M)_3,g_{\\min,3}],\\,[\\rho_{A,4},\\kappa(M)_4,g_{\\min,4}]\\,]$，不含任何附加文本。\n\n所有物理量必须以指定的单位处理：$L$ 单位为 $\\mathrm{m}$，$v$ 单位为 $\\mathrm{m/s}$，$\\Delta t$ 单位为 $\\mathrm{s}$，$\\rho_A$ 单位为 $\\mathrm{s}^{-1}$。离散傅里叶模式中出现的角度必须以弧度处理。最终的数值输出 $\\kappa(M)$ 和 $g_{\\min}$ 是无量纲的，并且必须以纯小数形式报告，不带单位符号。",
            "solution": "用户提供的问题已经过分析，并被认为是有效的。它具有科学依据、问题明确且客观。它代表了输运方程数值分析中的一个标准问题。\n\n该问题要求使用线方法分析半离散化的一维输运方程。任务是计算离散算子的精确谱，从此谱中计算几个诊断量，并解释其对迭代求解器的影响。\n\n控制偏微分方程是平板几何中的无碰撞输运方程：\n$$\n\\frac{1}{v}\\,\\frac{\\partial \\psi}{\\partial t} + \\mu \\frac{\\partial \\psi}{\\partial x} = 0,\n$$\n对于 $x \\in [0,L)$，具有周期性边界条件。角度使用 S2 近似进行离散化，纵标为 $\\mu_1 = 1/\\sqrt{3}$ 和 $\\mu_2 = -1/\\sqrt{3}$。空间被离散化为 $N$ 个宽度为 $h=L/N$ 的均匀单元，使用一阶迎风有限体积格式。\n\n得到的半离散系统由下式给出：\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\psi} + A\\,\\boldsymbol{\\psi} = 0, \\quad \\text{where} \\quad \\boldsymbol{\\psi} = \\begin{bmatrix}\\boldsymbol{\\psi}_{\\mu_1} \\\\ \\boldsymbol{\\psi}_{\\mu_2}\\end{bmatrix}.\n$$\n矩阵 $A$ 是分块对角的，$A = \\mathrm{diag}\\left( v\\,D(\\mu_1),\\, v\\,D(\\mu_2) \\right)$，其中 $D(\\mu)$ 是周期性网格上的离散迎风平流算子。\n\n**1. $A$ 的谱的推导**\n\n分块对角矩阵 $A$ 的谱是其对角块谱的并集，$\\sigma(A) = \\sigma(v\\,D(\\mu_1)) \\cup \\sigma(v\\,D(\\mu_2))$。由于均匀的周期性网格，$D(\\mu)$ 矩阵是 $N \\times N$ 的循环矩阵。一个第一行为 $(c_0, c_1, \\dots, c_{N-1})$ 的 $N \\times N$ 循环矩阵的特征值由 $\\lambda_k = \\sum_{j=0}^{N-1} c_j \\omega_k^j$ 给出，其中 $k=0, 1, \\dots, N-1$，$\\omega_k = e^{i \\theta_k}$ 是单位的 $N$ 次根，$\\theta_k = 2\\pi k/N$。\n\n情况 $\\mu  0$（对于 $\\mu_1 = 1/\\sqrt{3}$）：\n算子为 $D(\\mu_1) = \\frac{\\mu_1}{h}(I - S^{-1})$，其中 $S^{-1}$ 是用于向下移位的循环置换矩阵。$(I - S^{-1})$ 的第一行为 $(1, 0, \\dots, 0, -1)$。因此，$c_0 = 1$ 且 $c_{N-1}=-1$。$(I - S^{-1})$ 的特征值为：\n$$\n\\lambda_k(I-S^{-1}) = c_0 + c_{N-1}\\omega_k^{N-1} = 1 - \\omega_k^{-1} = 1 - e^{-i\\theta_k}.\n$$\n因此，$v\\,D(\\mu_1)$ 的特征值为：\n$$\n\\lambda_k^{(1)} = v \\frac{\\mu_1}{h} (1 - e^{-i\\theta_k}), \\quad k = 0, 1, \\dots, N-1.\n$$\n\n情况 $\\mu  0$（对于 $\\mu_2 = -1/\\sqrt{3}$）：\n算子为 $D(\\mu_2) = \\frac{\\mu_2}{h}(S - I)$，其中 $S$ 是用于向上移位的循环置换矩阵。$(S - I)$ 的第一行为 $(-1, 1, 0, \\dots, 0)$。因此，$c_0 = -1$ 且 $c_1=1$。$(S - I)$ 的特征值为：\n$$\n\\lambda_k(S-I) = c_0 + c_1\\omega_k^1 = -1 + \\omega_k = -1 + e^{i\\theta_k}.\n$$\n$v\\,D(\\mu_2)$ 的特征值为：\n$$\n\\lambda_k^{(2)} = v \\frac{\\mu_2}{h} (-1 + e^{i\\theta_k}), \\quad k = 0, 1, \\dots, N-1.\n$$\n由于 $\\mu_2 = -\\mu_1$，我们可以将其重写为：\n$$\n\\lambda_k^{(2)} = v \\frac{-\\mu_1}{h} (-1 + e^{i\\theta_k}) = v \\frac{\\mu_1}{h} (1 - e^{i\\theta_k}).\n$$\n全谱 $\\sigma(A)$ 由 $2N$ 个特征值组成，即 $\\{\\lambda_k^{(1)}\\}_{k=0}^{N-1} \\cup \\{\\lambda_k^{(2)}\\}_{k=0}^{N-1}$。注意，$\\lambda_k^{(2)}$ 是 $\\lambda_k^{(1)}$ 的复共轭，这是预期的，因为算子 $A$ 是实数。\n\n**2. 诊断量的计算**\n\n根据推导出的 $A$ 的谱，我们计算所要求的三个诊断指标。\n\n**谱半径 $\\rho_A$**：\n谱半径为 $\\rho_A = \\max_{\\lambda \\in \\sigma(A)} |\\lambda|$。我们计算特征值的模：\n$$\n|\\lambda_k^{(1)}| = \\left| v \\frac{\\mu_1}{h} (1 - e^{-i\\theta_k}) \\right| = v \\frac{\\mu_1}{h} \\sqrt{(1-\\cos\\theta_k)^2 + \\sin^2\\theta_k} = v \\frac{\\mu_1}{h} \\sqrt{2 - 2\\cos\\theta_k} = 2v \\frac{\\mu_1}{h} \\left|\\sin\\left(\\frac{\\theta_k}{2}\\right)\\right|.\n$$\n代入 $\\theta_k = 2\\pi k/N$，我们得到 $|\\lambda_k^{(1)}| = 2v \\frac{\\mu_1}{h} |\\sin(\\pi k/N)|$。对于 $\\lambda_k^{(2)}$，其模是相同的。当 $k \\in \\{0, \\dots, N-1\\}$ 时，$|\\sin(\\pi k/N)|$ 的最大值为 $1$，在 $N$ 为偶数时于 $k=N/2$ 处达到。所有测试用例都使用偶数 $N$。因此，\n$$\n\\rho_A = \\frac{2v\\mu_1}{h} = \\frac{2vN}{L\\sqrt{3}}.\n$$\n\n**条件数 $\\kappa(M)$**：\n后向欧拉系统矩阵为 $M = I + \\Delta t\\, A$。由于 $A$ 是一个正规矩阵（其块是循环矩阵，因此是正规的），$M$ 也是正规的。其条件数是其特征值模的最大值与最小值之比。$M$ 的特征值为 $\\zeta_k = 1 + \\Delta t\\,\\lambda_k$，其中 $\\lambda_k \\in \\sigma(A)$。令 $C = \\frac{\\Delta t\\, v\\, \\mu_1}{h}$ 为正纵标的库朗数。$M$ 的特征值为 $1 + C(1-e^{\\mp i\\theta_k})$。模的平方为：\n$$\n|1 + C(1 - e^{\\mp i\\theta_k})|^2 = |(1+C) - C(\\cos\\theta_k \\mp i\\sin\\theta_k)|^2 = ((1+C) - C\\cos\\theta_k)^2 + (C\\sin\\theta_k)^2\n$$\n$$\n= (1+C)^2 - 2C(1+C)\\cos\\theta_k + C^2\\cos^2\\theta_k + C^2\\sin^2\\theta_k = 1 + 2C(1+C)(1-\\cos\\theta_k) = 1 + 4C(1+C)\\sin^2(\\pi k/N).\n$$\n当 $k=0$ 时，$\\sin(0)=0$，此时模达到最小值。最小模为 $\\min|\\zeta_k| = \\sqrt{1} = 1$。这对应于 $A$ 的特征值 $\\lambda_0 = 0$。\n当 $k=N/2$ 时，$\\sin(\\pi/2)=1$，此时模达到最大值。模的平方最大值为 $1 + 4C(1+C) = (1+2C)^2$。最大模为 $\\max|\\zeta_k| = 1+2C$。\n条件数为：\n$$\n\\kappa(M) = \\frac{\\max_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|}{\\min_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|} = \\frac{1+2C}{1} = 1 + 2C = 1 + \\frac{2\\Delta t\\,vN}{L\\sqrt{3}}.\n$$\n\n**最小放大因子 $g_{\\min}$**：\n后向欧拉的模态放大因子为 $g(\\lambda) = 1/(1+\\Delta t\\,\\lambda)$。最小放大因子为：\n$$\ng_{\\min} = \\min_{\\lambda \\in \\sigma(A)} \\left| \\frac{1}{1 + \\Delta t\\,\\lambda} \\right| = \\frac{1}{\\max_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|} = \\frac{1}{\\kappa(M)\\,\\min_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|}.\n$$\n由于 $\\min |1 + \\Delta t\\,\\lambda| = 1$，我们有：\n$$\ng_{\\min} = \\frac{1}{\\kappa(M)} = \\frac{1}{1 + 2C} = \\frac{1}{1 + \\frac{2\\Delta t\\,vN}{L\\sqrt{3}}}.\n$$\n\n**3. 对迭代求解器的约束**\n\n在每个隐式时间步，必须求解线性系统 $M\\boldsymbol{\\psi}^{n+1} = \\boldsymbol{\\psi}^{n}$，其中 $M = I + \\Delta t\\,A$。对于大规模问题，该系统通过迭代求解。许多常用迭代求解器（例如，GMRES，法方程上的共轭梯度法）的收敛速度会受到大条件数 $\\kappa(M)$ 的不利影响。\n\n我们的分析表明 $\\kappa(M) = 1 + 2C$，其中 $C = \\frac{\\Delta t\\, v\\, \\mu_1}{h}$ 是库朗数。这揭示了问题参数如何控制线性求解的难度：\n- **随 $\\Delta t$ 的缩放**：$\\kappa(M)$ 随时间步长 $\\Delta t$ 线性缩放。这是隐式方法的一个经典挑战：虽然它们对于这个问题是无条件稳定的，允许使用大的 $\\Delta t$，但这样做会使线性系统变得越来越病态，从而更难求解。\n- **随 $v$ 的缩放**：$\\kappa(M)$ 随粒子速度 $v$ 线性缩放。更快的粒子导致更病态的系统。\n- **随 $h$ 的缩放**：$\\kappa(M)$ 与单元宽度 $h = L/N$ 成反比。因此，随着空间网格的细化（$h \\to 0$），条件数会增大。\n\n量 $C = v\\Delta t/(\\sqrt{3} h)$ 表示速度为 $v$、方向为 $\\mu_1$ 的粒子在一个时间步 $\\Delta t$ 内穿过的单元数。大的库朗数 $C$ 意味着信息在单一步骤中传播了许多单元。这在矩阵 $M$ 中产生了强的远程耦合，从而降低了通常依赖于局部信息传播（如 Jacobi 法或 Gauss-Siedel 法）或多项式近似（如 Krylov 方法）的迭代求解器的性能。$M$ 的特征值从 $1$ 到 $1+2C$ 的分布直接反映了这种耦合。大的分布范围会减慢收敛速度。在实践中，这需要使用强大的预条件子来聚集特征值并降低有效条件数，尤其是在具有大 $\\Delta t$ 或细网格的情况下。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes spectral diagnostics for the S2 transport discretization.\n    \"\"\"\n    # S2 ordinate\n    mu1 = 1.0 / np.sqrt(3.0)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, v, N, dt)\n        (1.0, 2.0e7, 8, 1.0e-9),\n        (1.0, 2.0e7, 32, 1.0e-8),\n        (1.0, 2.0e7, 64, 1.0e-7),\n        (1.0, 2.0e7, 16, 0.0),\n    ]\n\n    results = []\n    for L, v, N, dt in test_cases:\n        # Calculate cell width\n        h = L / N\n\n        # 1. Spectral radius of A\n        # rho_A = (2 * v * mu1) / h\n        rho_A = (2.0 * v * N) / (L * np.sqrt(3.0))\n\n        # 2. Condition number of M = I + dt*A\n        # The Courant number C = dt * v * mu1 / h\n        C = (dt * v * mu1) / h\n        # kappa(M) = 1 + 2*C\n        kappa_M = 1.0 + 2.0 * C\n\n        # 3. Minimal modal amplification factor g_min\n        # g_min = 1 / (1 + 2*C) = 1 / kappa_M\n        # Handle the case where kappa_M is zero, although not possible here.\n        if kappa_M == 0:\n            g_min = float('inf')\n        else:\n            g_min = 1.0 / kappa_M\n\n        results.append([rho_A, kappa_M, g_min])\n\n    # Format the output string as a list of lists with numbers formatted to 6 decimal places.\n    case_strings = []\n    for case_result in results:\n        num_strings = [f\"{x:.6f}\" for x in case_result]\n        case_strings.append(f\"[{','.join(num_strings)}]\")\n    \n    final_output_str = f\"[{','.join(case_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}