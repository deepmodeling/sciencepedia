{
    "hands_on_practices": [
        {
            "introduction": "Explicit time integration schemes, such as the Runge-Kutta methods, are popular for their simplicity as they do not require solving a linear system at each time step. However, their use is constrained by a stability requirement known as the Courant-Friedrichs-Lewy (CFL) condition, which limits the maximum allowable time step size, $\\Delta t$. This practice () guides you through the process of deriving this stability limit for a fourth-order Runge-Kutta method by connecting the method's stability region to the spectral properties of the discretized transport streaming operator.",
            "id": "4257840",
            "problem": "Consider a one-energy-group neutron transport equation in a spatially homogeneous medium with periodic boundary conditions, discretized in angle using the Discrete Ordinates (SN) method and in space using a conservative centered scheme. Under these assumptions, the semi-discrete Method of Lines (MOL) formulation of the streaming term can be written as\n$$\n\\frac{d\\boldsymbol{\\psi}(t)}{dt} = A \\boldsymbol{\\psi}(t),\n$$\nwhere $\\boldsymbol{\\psi}(t)$ is the vector of angular flux unknowns and $A$ is the streaming operator matrix. For the periodic, energy-conserving discretization described, $A$ is skew-Hermitian so that its spectrum lies on the imaginary axis. Let the spectral radius be $\\rho(A) \\equiv \\max_{j} |\\lambda_{j}|$, where $\\lambda_{j}$ are the eigenvalues of $A$.\n\nYou time-advance this system using the classical explicit four-stage, fourth-order Runge–Kutta method defined by its Butcher tableau\n```\n$$\n\\begin{array}{c|cccc}\n0  0  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0  0 \\\\\n\\frac{1}{2}  0  \\frac{1}{2}  0  0 \\\\\n1  0  0  1  0 \\\\\n\\hline\n  \\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}  \\frac{1}{6}\n\\end{array}\n$$\n```\napplied to the linear system $\\frac{d\\boldsymbol{\\psi}}{dt}=A\\boldsymbol{\\psi}$.\n\nStarting from the linear stability requirement for a Runge–Kutta method applied to the scalar test equation $\\frac{dy}{dt}=\\lambda y$ and the definition of the stability region in terms of the method’s amplification factor, derive the maximal stable timestep $\\Delta t_{\\max}$ for this method when the eigenvalues of $A$ are purely imaginary, and express your final answer symbolically in terms of $\\rho(A)$. Interpret the result physically in the context of time-dependent transport simulations. Express the timestep in seconds. No numerical rounding is required; provide a closed-form analytic expression as your final answer.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of numerical analysis for partial differential equations, specifically the Method of Lines and linear stability theory for Ordinary Differential Equations (ODEs). It is well-posed, objective, and contains all necessary information to derive a unique, meaningful solution.\n\nThe problem asks for the maximal stable timestep $\\Delta t_{\\max}$ for the time integration of the semi-discrete system $\\frac{d\\boldsymbol{\\psi}(t)}{dt} = A \\boldsymbol{\\psi}(t)$ using the classical fourth-order Runge-Kutta (RK$4$) method. The stability of a numerical method for a linear system is determined by its performance on the scalar test equation $\\frac{dy}{dt} = \\lambda y$, where $\\lambda$ is any eigenvalue of the matrix $A$.\n\nFor a one-step numerical method, the solution at time step $n+1$ is related to the solution at time step $n$ by an amplification factor $R(z)$, such that $y_{n+1} = R(z) y_n$, where $z = \\lambda \\Delta t$. The method is stable if and only if $|R(z)| \\le 1$ for all eigenvalues $\\lambda$ of $A$. The set of complex numbers $z$ for which this condition holds is the region of absolute stability.\n\nFirst, we must determine the stability function $R(z)$ for the given RK$4$ method. The method is defined by the Butcher tableau:\n$$\n\\begin{array}{c|cccc}\n0  0  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0  0 \\\\\n\\frac{1}{2}  0  \\frac{1}{2}  0  0 \\\\\n1  0  0  1  0 \\\\\n\\hline\n  \\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}  \\frac{1}{6}\n\\end{array}\n$$\nApplying this method to the test equation $\\frac{dy}{dt} = \\lambda y$ gives the following stages:\n$k_1 = f(y_n) = \\lambda y_n$\n$k_2 = f(y_n + \\Delta t (\\frac{1}{2} k_1)) = \\lambda(y_n + \\frac{\\Delta t}{2} (\\lambda y_n)) = \\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2})$\n$k_3 = f(y_n + \\Delta t (\\frac{1}{2} k_2)) = \\lambda(y_n + \\frac{\\Delta t}{2} (\\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2}))) = \\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2} + \\frac{(\\lambda \\Delta t)^2}{4})$\n$k_4 = f(y_n + \\Delta t (1 \\cdot k_3)) = \\lambda(y_n + \\Delta t (\\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2} + \\frac{(\\lambda \\Delta t)^2}{4}))) = \\lambda y_n (1 + \\lambda \\Delta t + \\frac{(\\lambda \\Delta t)^2}{2} + \\frac{(\\lambda \\Delta t)^3}{4})$\n\nThe solution update is given by $y_{n+1} = y_n + \\Delta t \\sum_{i=1}^{4} b_i k_i$. Let $z = \\lambda \\Delta t$.\n$y_{n+1} = y_n + \\Delta t \\left[ \\frac{1}{6}(\\lambda y_n) + \\frac{1}{3}(\\lambda y_n(1+\\frac{z}{2})) + \\frac{1}{3}(\\lambda y_n(1+\\frac{z}{2}+\\frac{z^2}{4})) + \\frac{1}{6}(\\lambda y_n(1+z+\\frac{z^2}{2}+\\frac{z^3}{4})) \\right]$\n$\\frac{y_{n+1}}{y_n} = 1 + z \\left[ \\frac{1}{6} + \\frac{1}{3}(1+\\frac{z}{2}) + \\frac{1}{3}(1+\\frac{z}{2}+\\frac{z^2}{4}) + \\frac{1}{6}(1+z+\\frac{z^2}{2}+\\frac{z^3}{4}) \\right]$\n$R(z) = 1 + z \\left[ \\frac{1}{6} + \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{6} \\right] + z^2 \\left[ \\frac{1}{6} + \\frac{1}{6} + \\frac{1}{6} \\right] + z^3 \\left[ \\frac{1}{12} + \\frac{1}{12} \\right] + z^4 \\left[ \\frac{1}{24} \\right]$\n$R(z) = 1 + z (1) + z^2 (\\frac{3}{6}) + z^3 (\\frac{2}{12}) + z^4 (\\frac{1}{24})$\n$R(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} = \\sum_{k=0}^{4} \\frac{z^k}{k!}$\nThis is the truncated Taylor series expansion of $\\exp(z)$ of order $4$.\n\nThe problem states that the matrix $A$ is skew-Hermitian, which implies its eigenvalues $\\lambda_j$ are purely imaginary. We can write any such eigenvalue as $\\lambda = i\\omega$, where $\\omega$ is a real number representing a frequency.\nConsequently, $z = \\lambda \\Delta t = i \\omega \\Delta t$. We define a real variable $y = \\omega \\Delta t$, so $z=iy$. The stability condition $|R(z)| \\le 1$ becomes $|R(iy)| \\le 1$.\nSubstituting $z=iy$ into the stability function:\n$R(iy) = 1 + (iy) + \\frac{(iy)^2}{2} + \\frac{(iy)^3}{6} + \\frac{(iy)^4}{24}$\n$R(iy) = 1 + iy - \\frac{y^2}{2} - i\\frac{y^3}{6} + \\frac{y^4}{24}$\nWe group the real and imaginary parts:\n$R(iy) = \\left(1 - \\frac{y^2}{2} + \\frac{y^4}{24}\\right) + i\\left(y - \\frac{y^3}{6}\\right)$\n\nNow we evaluate the squared magnitude, $|R(iy)|^2$:\n$|R(iy)|^2 = \\left(1 - \\frac{y^2}{2} + \\frac{y^4}{24}\\right)^2 + \\left(y - \\frac{y^3}{6}\\right)^2$\nExpanding the terms:\n$|R(iy)|^2 = \\left(1 - y^2 + \\frac{y^4}{4} + \\frac{y^4}{12} - \\frac{y^6}{24} + \\frac{y^8}{576}\\right) + \\left(y^2 - \\frac{y^4}{3} + \\frac{y^6}{36}\\right)$\nCombining like powers of $y$:\n$|R(iy)|^2 = 1 + y^4 \\left(\\frac{1}{4} + \\frac{1}{12} - \\frac{1}{3}\\right) + y^6 \\left(-\\frac{1}{24} + \\frac{1}{36}\\right) + \\frac{y^8}{576}$\nThe coefficient of the $y^4$ term is $\\frac{3+1-4}{12} = 0$, which is expected for a $4$-th order method.\n$|R(iy)|^2 = 1 + y^6 \\left(\\frac{-3+2}{72}\\right) + \\frac{y^8}{576} = 1 - \\frac{y^6}{72} + \\frac{y^8}{576}$\n\nThe boundary of the stability region is found by setting $|R(iy)|=1$, or $|R(iy)|^2=1$.\n$1 - \\frac{y^6}{72} + \\frac{y^8}{576} = 1$\nFor non-trivial solutions where $y \\neq 0$, we can divide by $y^6$:\n$\\frac{y^2}{576} - \\frac{1}{72} = 0$\n$\\frac{y^2}{576} = \\frac{1}{72}$\n$y^2 = \\frac{576}{72} = 8$\n$|y| = \\sqrt{8} = 2\\sqrt{2}$\n\nThis result means that for stability, we require $|y| = |\\omega \\Delta t| \\le 2\\sqrt{2}$. This condition must hold for all eigenvalues $\\lambda_j = i\\omega_j$ of the matrix $A$.\n$|\\omega_j \\Delta t| \\le 2\\sqrt{2} \\quad \\forall j$\nThis is equivalent to:\n$\\Delta t \\cdot \\max_j |\\omega_j| \\le 2\\sqrt{2}$\nThe spectral radius of $A$ is defined as $\\rho(A) = \\max_j |\\lambda_j|$. Since $\\lambda_j = i\\omega_j$, we have $|\\lambda_j| = |i\\omega_j| = |\\omega_j|$. Thus, $\\rho(A) = \\max_j |\\omega_j|$.\nThe stability condition becomes:\n$\\Delta t \\cdot \\rho(A) \\le 2\\sqrt{2}$\nThe maximal stable timestep, $\\Delta t_{\\max}$, corresponds to the equality:\n$\\Delta t_{\\max} = \\frac{2\\sqrt{2}}{\\rho(A)}$\n\nThe problem asks for a physical interpretation. This result is a form of the Courant-Friedrichs-Lewy (CFL) condition. The spectral radius $\\rho(A)$ of the semi-discrete streaming operator is determined by the highest frequency spatial mode supportable by the grid and the particle speed. For a spatial grid with spacing $\\Delta x$ and maximum characteristic speed $v_{\\max}$, $\\rho(A)$ is proportional to $\\frac{v_{\\max}}{\\Delta x}$. Therefore, $\\Delta t_{\\max} \\propto \\frac{\\Delta x}{v_{\\max}}$. This means the timestep must be small enough such that a particle traveling at the maximum speed does not cross more than a certain number of spatial cells in one timestep. The constant of proportionality, $2\\sqrt{2}$, is specific to the stability properties of the RK$4$ method for purely oscillatory systems (as described by skew-Hermitian operators). A different numerical scheme would yield a different constant. The expression provides the answer in seconds, as the units of $\\rho(A)$ are inverse seconds ($s^{-1}$) from the governing equation $\\frac{d\\boldsymbol{\\psi}}{dt} = A\\boldsymbol{\\psi}$.",
            "answer": "$$\n\\boxed{\\frac{2\\sqrt{2}}{\\rho(A)}}\n$$"
        },
        {
            "introduction": "To overcome the restrictive time step limits of explicit methods, we often turn to implicit schemes like the backward Euler method, which are unconditionally stable for many transport problems. This stability, however, is not free; it requires the solution of a large, sparse linear system at every time step. In this exercise (), you will analyze the discrete streaming operator for a simple 1D problem to understand how the condition number of the implicit system matrix behaves, revealing the computational challenge that arises when using large time steps.",
            "id": "4257829",
            "problem": "Consider the time-dependent, one-dimensional linear transport equation without collisions, written for the angular flux $\\psi(x,\\mu,t)$ in slab geometry,\n$$\n\\frac{1}{v}\\,\\frac{\\partial \\psi}{\\partial t} + \\mu \\frac{\\partial \\psi}{\\partial x} = 0,\n$$\nwhere $x \\in [0,L)$ with periodic boundary conditions, $t \\ge 0$, $\\mu$ is the direction cosine, and $v$ is the constant particle speed. Discretize the angle using the two-angle Discrete Ordinates (SN) method (S2), with abscissae $\\mu_1 = +1/\\sqrt{3}$ and $\\mu_2 = -1/\\sqrt{3}$ and equal weights. Discretize space on a uniform mesh of $N$ cells of width $h=L/N$, and use a first-order upwind finite-volume discretization consistent with periodic boundaries. Denote by $\\boldsymbol{\\psi}_{\\mu}$ the vector of cell-averaged angular fluxes for a given ordinate $\\mu$.\n\nDefine the semi-discrete system in vector form as\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\psi} + A\\,\\boldsymbol{\\psi} = 0,\\quad \\boldsymbol{\\psi} = \\begin{bmatrix}\\boldsymbol{\\psi}_{\\mu_1} \\\\ \\boldsymbol{\\psi}_{\\mu_2}\\end{bmatrix},\n$$\nwhere $A$ is the block-diagonal discrete streaming operator scaled by the speed $v$,\n$$\nA = \\mathrm{diag}\\left( v\\,D(\\mu_1),\\, v\\,D(\\mu_2) \\right).\n$$\nHere $D(\\mu)$ is the $N \\times N$ upwind discrete derivative matrix with periodic wrap:\n- For $\\mu  0$, $D(\\mu) = \\frac{\\mu}{h}\\left(I - S^{-1}\\right)$, where $S^{-1}$ shifts a vector down by one index with wrap-around.\n- For $\\mu  0$, $D(\\mu) = \\frac{\\mu}{h}\\left(S - I\\right)$, where $S$ shifts a vector up by one index with wrap-around.\n\nConsider a single implicit backward Euler timestep of size $\\Delta t$ applied to the homogeneous system,\n$$\n\\left(I + \\Delta t\\,A\\right)\\,\\boldsymbol{\\psi}^{n+1} = \\boldsymbol{\\psi}^{n}.\n$$\nFor a given parameter set $(L, v, N, \\Delta t)$, do the following:\n1. Compute the full spectrum (the multiset of $2N$ eigenvalues) of $A$ exactly by using the known circulant structure induced by periodic boundaries. You must not approximate the spectrum via time-stepping; instead, use the discrete Fourier modes to construct it.\n2. From this spectrum, compute the following three quantitative diagnostics:\n   - The spectral radius of $A$, denoted $\\rho_A$, defined as $\\rho_A = \\max_{\\lambda \\in \\sigma(A)} |\\lambda|$. Report $\\rho_A$ in $\\mathrm{s}^{-1}$.\n   - The $2$-norm condition number of the backward Euler system matrix $M = I + \\Delta t\\,A$, denoted $\\kappa(M)$, which for normal matrices equals $\\kappa(M) = \\dfrac{\\max_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|}{\\min_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|}$. Report $\\kappa(M)$ as a dimensionless number.\n   - The minimal per-timestep modal amplification factor for backward Euler, denoted $g_{\\min}$, defined as $g_{\\min} = \\min_{\\lambda \\in \\sigma(A)} \\left| \\dfrac{1}{1 + \\Delta t\\,\\lambda} \\right|$. Report $g_{\\min}$ as a dimensionless number.\n3. Explain, based on first principles of the discretization and the computed spectra, how the eigenvalue distribution and $\\kappa(M)$ constrain the convergence behavior of iterative implicit solvers applied at each timestep, focusing on the scaling with $\\Delta t$, $v$, and $h$.\n\nUse the following test suite of parameter sets, which together probe a range of spatial and temporal resolutions, including an edge case:\n- Test $1$: $L = 1.0\\,\\mathrm{m}$, $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$, $N = 8$, $\\Delta t = 1.0\\times 10^{-9}\\,\\mathrm{s}$.\n- Test $2$: $L = 1.0\\,\\mathrm{m}$, $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$, $N = 32$, $\\Delta t = 1.0\\times 10^{-8}\\,\\mathrm{s}$.\n- Test $3$: $L = 1.0\\,\\mathrm{m}$, $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$, $N = 64$, $\\Delta t = 1.0\\times 10^{-7}\\,\\mathrm{s}$.\n- Test $4$ (edge case): $L = 1.0\\,\\mathrm{m}$, $v = 2.0\\times 10^{7}\\,\\mathrm{m/s}$, $N = 16$, $\\Delta t = 0.0\\,\\mathrm{s}$.\n\nYour program must:\n- Construct the spectra analytically from the circulant structure using the discrete Fourier mode angles $\\theta_k = 2\\pi k/N$ for $k = 0,1,\\dots,N-1$ and the S2 ordinates $\\mu = \\pm 1/\\sqrt{3}$, without numerical time integration.\n- For each test, compute $(\\rho_A, \\kappa(M), g_{\\min})$ and round each to six digits after the decimal point.\n- Produce a single line of output containing the results as a comma-separated list of lists in the exact format\n$[\\,[\\rho_{A,1},\\kappa(M)_1,g_{\\min,1}],\\,[\\rho_{A,2},\\kappa(M)_2,g_{\\min,2}],\\,[\\rho_{A,3},\\kappa(M)_3,g_{\\min,3}],\\,[\\rho_{A,4},\\kappa(M)_4,g_{\\min,4}]\\,]$,\nwith no additional text.\n\nAll physical quantities must be handled in the specified units: $L$ in $\\mathrm{m}$, $v$ in $\\mathrm{m/s}$, $\\Delta t$ in $\\mathrm{s}$, and $\\rho_A$ in $\\mathrm{s}^{-1}$. Angles arising in the discrete Fourier modes must be treated in radians. The final numerical outputs are dimensionless for $\\kappa(M)$ and $g_{\\min}$ and must be reported as pure decimals without unit symbols.",
            "solution": "The user-provided problem has been analyzed and is deemed valid. It is scientifically grounded, well-posed, and objective. It represents a standard problem in the numerical analysis of transport equations.\n\nThe problem asks for the analysis of a semi-discretized one-dimensional transport equation using the method of lines. The tasks are to compute the exact spectrum of the discrete operator, calculate several diagnostic quantities from this spectrum, and explain the implications for iterative solvers.\n\nThe governing partial differential equation is the collisionless transport equation in slab geometry:\n$$\n\\frac{1}{v}\\,\\frac{\\partial \\psi}{\\partial t} + \\mu \\frac{\\partial \\psi}{\\partial x} = 0,\n$$\nfor $x \\in [0,L)$, with periodic boundary conditions. The angle is discretized using the S2 approximation, with ordinates $\\mu_1 = 1/\\sqrt{3}$ and $\\mu_2 = -1/\\sqrt{3}$. Space is discretized into $N$ uniform cells of width $h=L/N$ using a first-order upwind finite-volume scheme.\n\nThe resulting semi-discrete system is given by:\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\psi} + A\\,\\boldsymbol{\\psi} = 0, \\quad \\text{where} \\quad \\boldsymbol{\\psi} = \\begin{bmatrix}\\boldsymbol{\\psi}_{\\mu_1} \\\\ \\boldsymbol{\\psi}_{\\mu_2}\\end{bmatrix}.\n$$\nThe matrix $A$ is block-diagonal, $A = \\mathrm{diag}\\left( v\\,D(\\mu_1),\\, v\\,D(\\mu_2) \\right)$, where $D(\\mu)$ is the discrete upwind advection operator on the periodic mesh.\n\n**1. Derivation of the Spectrum of $A$**\n\nThe spectrum of the block-diagonal matrix $A$ is the union of the spectra of its diagonal blocks, $\\sigma(A) = \\sigma(v\\,D(\\mu_1)) \\cup \\sigma(v\\,D(\\mu_2))$. The matrices $D(\\mu)$ are $N \\times N$ circulant matrices due to the uniform periodic grid. The eigenvalues of an $N \\times N$ circulant matrix with first row $(c_0, c_1, \\dots, c_{N-1})$ are given by $\\lambda_k = \\sum_{j=0}^{N-1} c_j \\omega_k^j$ for $k=0, 1, \\dots, N-1$, where $\\omega_k = e^{i \\theta_k}$ are the $N$-th roots of unity, with $\\theta_k = 2\\pi k/N$.\n\nCase $\\mu  0$ (for $\\mu_1 = 1/\\sqrt{3}$):\nThe operator is $D(\\mu_1) = \\frac{\\mu_1}{h}(I - S^{-1})$, where $S^{-1}$ is the circulant permutation matrix for a downward shift. The first row of $(I - S^{-1})$ is $(1, 0, \\dots, 0, -1)$. Thus, $c_0 = 1$ and $c_{N-1}=-1$. The eigenvalues of $(I - S^{-1})$ are:\n$$\n\\lambda_k(I-S^{-1}) = c_0 + c_{N-1}\\omega_k^{N-1} = 1 - \\omega_k^{-1} = 1 - e^{-i\\theta_k}.\n$$\nThe eigenvalues of $v\\,D(\\mu_1)$ are therefore:\n$$\n\\lambda_k^{(1)} = v \\frac{\\mu_1}{h} (1 - e^{-i\\theta_k}), \\quad k = 0, 1, \\dots, N-1.\n$$\n\nCase $\\mu  0$ (for $\\mu_2 = -1/\\sqrt{3}$):\nThe operator is $D(\\mu_2) = \\frac{\\mu_2}{h}(S - I)$, where $S$ is the circulant permutation matrix for an upward shift. The first row of $(S - I)$ is $(-1, 1, 0, \\dots, 0)$. Thus, $c_0 = -1$ and $c_1=1$. The eigenvalues of $(S - I)$ are:\n$$\n\\lambda_k(S-I) = c_0 + c_1\\omega_k^1 = -1 + \\omega_k = -1 + e^{i\\theta_k}.\n$$\nThe eigenvalues of $v\\,D(\\mu_2)$ are:\n$$\n\\lambda_k^{(2)} = v \\frac{\\mu_2}{h} (-1 + e^{i\\theta_k}), \\quad k = 0, 1, \\dots, N-1.\n$$\nSince $\\mu_2 = -\\mu_1$, we can rewrite this as:\n$$\n\\lambda_k^{(2)} = v \\frac{-\\mu_1}{h} (-1 + e^{i\\theta_k}) = v \\frac{\\mu_1}{h} (1 - e^{i\\theta_k}).\n$$\nThe full spectrum $\\sigma(A)$ consists of $2N$ eigenvalues, $\\{\\lambda_k^{(1)}\\}_{k=0}^{N-1} \\cup \\{\\lambda_k^{(2)}\\}_{k=0}^{N-1}$. Note that $\\lambda_k^{(2)}$ is the complex conjugate of $\\lambda_k^{(1)}$, which is expected as the operator $A$ is real.\n\n**2. Computation of Diagnostic Quantities**\n\nFrom the derived spectrum of $A$, we compute the three requested diagnostics.\n\n**Spectral Radius $\\rho_A$**:\nThe spectral radius is $\\rho_A = \\max_{\\lambda \\in \\sigma(A)} |\\lambda|$. We calculate the magnitude of the eigenvalues:\n$$\n|\\lambda_k^{(1)}| = \\left| v \\frac{\\mu_1}{h} (1 - e^{-i\\theta_k}) \\right| = v \\frac{\\mu_1}{h} \\sqrt{(1-\\cos\\theta_k)^2 + \\sin^2\\theta_k} = v \\frac{\\mu_1}{h} \\sqrt{2 - 2\\cos\\theta_k} = 2v \\frac{\\mu_1}{h} \\left|\\sin\\left(\\frac{\\theta_k}{2}\\right)\\right|.\n$$\nSubstituting $\\theta_k = 2\\pi k/N$, we get $|\\lambda_k^{(1)}| = 2v \\frac{\\mu_1}{h} |\\sin(\\pi k/N)|$. The magnitude is identical for $\\lambda_k^{(2)}$. The maximum value of $|\\sin(\\pi k/N)|$ for $k \\in \\{0, \\dots, N-1\\}$ is $1$, achieved when $N$ is even at $k=N/2$. All test cases use even $N$. Therefore,\n$$\n\\rho_A = \\frac{2v\\mu_1}{h} = \\frac{2vN}{L\\sqrt{3}}.\n$$\n\n**Condition Number $\\kappa(M)$**:\nThe backward Euler system matrix is $M = I + \\Delta t\\, A$. Since $A$ is a normal matrix (its blocks are circulant, hence normal), $M$ is also normal. Its condition number is the ratio of the maximum to minimum magnitude of its eigenvalues. The eigenvalues of $M$ are $\\zeta_k = 1 + \\Delta t\\,\\lambda_k$ for $\\lambda_k \\in \\sigma(A)$. Let $C = \\frac{\\Delta t\\, v\\, \\mu_1}{h}$ be the Courant number for the positive ordinate. The eigenvalues of $M$ are $1 + C(1-e^{\\mp i\\theta_k})$. The squared magnitude is:\n$$\n|1 + C(1 - e^{\\mp i\\theta_k})|^2 = |(1+C) - C(\\cos\\theta_k \\mp i\\sin\\theta_k)|^2 = ((1+C) - C\\cos\\theta_k)^2 + (C\\sin\\theta_k)^2\n$$\n$$\n= (1+C)^2 - 2C(1+C)\\cos\\theta_k + C^2\\cos^2\\theta_k + C^2\\sin^2\\theta_k = 1 + 2C(1+C)(1-\\cos\\theta_k) = 1 + 4C(1+C)\\sin^2(\\pi k/N).\n$$\nThis magnitude is minimized for $k=0$, where $\\sin(0)=0$. The minimum magnitude is $\\min|\\zeta_k| = \\sqrt{1} = 1$. This corresponds to the eigenvalue $\\lambda_0 = 0$ of $A$.\nThe magnitude is maximized for $k=N/2$, where $\\sin(\\pi/2)=1$. The maximum squared magnitude is $1 + 4C(1+C) = (1+2C)^2$. The maximum magnitude is $\\max|\\zeta_k| = 1+2C$.\nThe condition number is:\n$$\n\\kappa(M) = \\frac{\\max_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|}{\\min_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|} = \\frac{1+2C}{1} = 1 + 2C = 1 + \\frac{2\\Delta t\\,vN}{L\\sqrt{3}}.\n$$\n\n**Minimal Amplification Factor $g_{\\min}$**:\nThe modal amplification factor for backward Euler is $g(\\lambda) = 1/(1+\\Delta t\\,\\lambda)$. The minimal amplification factor is:\n$$\ng_{\\min} = \\min_{\\lambda \\in \\sigma(A)} \\left| \\frac{1}{1 + \\Delta t\\,\\lambda} \\right| = \\frac{1}{\\max_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|} = \\frac{1}{\\kappa(M)\\,\\min_{\\lambda \\in \\sigma(A)} |1 + \\Delta t\\,\\lambda|}.\n$$\nSince $\\min |1 + \\Delta t\\,\\lambda| = 1$, we have:\n$$\ng_{\\min} = \\frac{1}{\\kappa(M)} = \\frac{1}{1 + 2C} = \\frac{1}{1 + \\frac{2\\Delta t\\,vN}{L\\sqrt{3}}}.\n$$\n\n**3. Constraints on Iterative Solvers**\n\nAt each implicit time step, one must solve the linear system $M\\boldsymbol{\\psi}^{n+1} = \\boldsymbol{\\psi}^{n}$, where $M = I + \\Delta t\\,A$. For large-scale problems, this system is solved iteratively. The convergence rate of many common iterative solvers (e.g., GMRES, Conjugate Gradient on the normal equations) is adversely affected by a large condition number, $\\kappa(M)$.\n\nOur analysis shows that $\\kappa(M) = 1 + 2C$, where $C = \\frac{\\Delta t\\, v\\, \\mu_1}{h}$ is the Courant number. This reveals how problem parameters control the difficulty of the linear solve:\n- **Scaling with $\\Delta t$**: $\\kappa(M)$ scales linearly with the timestep size $\\Delta t$. This is a classic challenge for implicit methods: while they are unconditionally stable for this problem, allowing for large $\\Delta t$, doing so makes the linear system increasingly ill-conditioned and thus harder to solve.\n- **Scaling with $v$**: $\\kappa(M)$ scales linearly with the particle speed $v$. Faster particles lead to more ill-conditioned systems.\n- **Scaling with $h$**: $\\kappa(M)$ scales inversely with the cell width $h = L/N$. Thus, as the spatial mesh is refined ($h \\to 0$), the condition number grows.\n\nThe quantity $C = v\\Delta t/(\\sqrt{3} h)$ represents the number of cells a particle with speed $v$ and direction $\\mu_1$ would traverse in one timestep $\\Delta t$. A large Courant number $C$ implies that information propagates over many cells in a single step. This creates strong long-range coupling in the matrix $M$, which degrades the performance of iterative solvers that typically rely on local information propagation (like Jacobi or Gauss-Siedel) or polynomial approximants (like Krylov methods). The spread of the eigenvalues of $M$ from $1$ to $1+2C$ directly reflects this coupling. A large spread slows convergence. In practice, this necessitates the use of powerful preconditioners to cluster the eigenvalues and reduce the effective condition number.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes spectral diagnostics for the S2 transport discretization.\n    \"\"\"\n    # S2 ordinate\n    mu1 = 1.0 / np.sqrt(3.0)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, v, N, dt)\n        (1.0, 2.0e7, 8, 1.0e-9),\n        (1.0, 2.0e7, 32, 1.0e-8),\n        (1.0, 2.0e7, 64, 1.0e-7),\n        (1.0, 2.0e7, 16, 0.0),\n    ]\n\n    results = []\n    for L, v, N, dt in test_cases:\n        # Calculate cell width\n        h = L / N\n\n        # 1. Spectral radius of A\n        # rho_A = (2 * v * mu1) / h\n        rho_A = (2.0 * v * N) / (L * np.sqrt(3.0))\n\n        # 2. Condition number of M = I + dt*A\n        # The Courant number C = dt * v * mu1 / h\n        C = (dt * v * mu1) / h\n        # kappa(M) = 1 + 2*C\n        kappa_M = 1.0 + 2.0 * C\n\n        # 3. Minimal modal amplification factor g_min\n        # g_min = 1 / (1 + 2*C) = 1 / kappa_M\n        # Handle the case where kappa_M is zero, although not possible here.\n        if kappa_M == 0:\n            g_min = float('inf')\n        else:\n            g_min = 1.0 / kappa_M\n\n        results.append([rho_A, kappa_M, g_min])\n\n    # Format the output string as a list of lists with numbers formatted to 6 decimal places.\n    case_strings = []\n    for case_result in results:\n        num_strings = [f\"{x:.6f}\" for x in case_result]\n        case_strings.append(f\"[{','.join(num_strings)}]\")\n    \n    final_output_str = f\"[{','.join(case_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond the choice of time integration, the fundamental discretization of angle and space introduces its own set of numerical artifacts. One of the most famous in transport theory is the \"ray effect\" in Discrete Ordinates ($S_N$) methods, which causes unphysical streaming patterns along the chosen discrete directions. This problem () challenges you to model this phenomenon in a transient scenario, developing a quantitative metric to measure the error and understand how it evolves over time, a critical skill for correctly interpreting simulation results.",
            "id": "4257835",
            "problem": "Consider time-dependent neutron transport in an infinite, homogeneous, non-multiplying medium with purely absorbing total macroscopic cross section $\\Sigma_a$ (no scattering), and constant neutron speed $v$. Let the source be an isotropic point pulse of strength $Q_0$ at the origin at time $t=0$, so the angular source term is $q(\\mathbf{r}, \\boldsymbol{\\Omega}, t) = \\dfrac{Q_0}{4\\pi}\\,\\delta(t)\\,\\delta(\\mathbf{r})$. The governing equation is the time-dependent linear Boltzmann Transport Equation (LBTE),\n$$\n\\frac{1}{v}\\,\\frac{\\partial \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, t)}{\\partial t} + \\boldsymbol{\\Omega}\\cdot\\nabla \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, t) + \\Sigma_a\\,\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, t) = q(\\mathbf{r}, \\boldsymbol{\\Omega}, t),\n$$\nwith initial condition $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, t0)=0$. The exact solution yields a scalar flux $\\phi(\\mathbf{r}, t) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, t)\\,d\\boldsymbol{\\Omega}$ that is supported on the spherical shell $r = \\|\\mathbf{r}\\| = v t$ and is spherically symmetric on that shell.\n\nIn a Discrete Ordinates ($S_N$) discretization of angle using $M$ directions $\\{\\boldsymbol{\\Omega}_m, w_m\\}_{m=1}^M$, on a uniform spatial grid of characteristic cell size $h$, the free-streaming solution of the pulsed source exhibits pronounced ray effects: energy propagates preferentially along the discrete directions. In practice, finite-volume or finite-difference spatial discretizations introduce lateral numerical diffusion that yields a finite angular footprint for each discrete ray when observed on the spherical shell at radius $r=v t$. Using geometric arguments, assume that the effective solid-angle footprint per discrete direction scales as $\\Delta\\Omega(t) \\approx \\kappa\\,h/r$ for some scheme-dependent $\\kappa=\\mathcal{O}(1)$, so the union of all footprints covers a fraction $f(t)$ of the unit sphere given approximately by $f(t) \\approx \\dfrac{M\\,\\Delta\\Omega(t)}{4\\pi}$.\n\nDefine an angular discretization error metric $E(t)$ that quantifies the ray-effect-induced nonuniformity of the scalar flux over the spherical shell of radius $r=v t$ by the coefficient of variation (CV), i.e., the ratio of the angular root-mean-square deviation of $\\phi(\\mathbf{r}, t)$ around its angular mean to that mean, evaluated over the shell. Which of the following expressions for $E(t)$, as a function of time $t$ and the discretization parameters, is most consistent with the LBTE solution, the $S_N$ streaming behavior, and the stated geometric scaling assumptions?\n\nA. $E(t) = \\sqrt{\\dfrac{1 - f(t)}{f(t)}}$ with $f(t) = \\dfrac{M\\,\\kappa\\,h}{4\\pi\\,v\\,t}$.\n\nB. $E(t) = \\dfrac{4\\pi\\,v\\,t}{M\\,\\kappa\\,h}$.\n\nC. $E(t) = e^{-\\Sigma_a\\,v\\,t}$.\n\nD. $E(t) = \\sqrt{\\dfrac{1 - f(t)}{f(t)}}$ with $f(t) = \\dfrac{M\\,\\kappa\\,h}{4\\pi}$.\n\nE. $E(t) = \\sqrt{\\dfrac{1 - f(t)}{f(t)}}$ with $f(t) = \\dfrac{M\\,\\kappa\\,h\\,e^{-\\Sigma_a\\,v\\,t}}{4\\pi\\,v\\,t}$.",
            "solution": "The user wants me to validate the problem statement, and if valid, derive a solution and evaluate the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Physical System:** Infinite, homogeneous, non-multiplying medium.\n-   **Interaction:** Purely absorbing total macroscopic cross section $\\Sigma_a$. No scattering.\n-   **Neutron Property:** Constant speed $v$.\n-   **Source Term:** $q(\\mathbf{r}, \\boldsymbol{\\Omega}, t) = \\dfrac{Q_0}{4\\pi}\\,\\delta(t)\\,\\delta(\\mathbf{r})$, representing an isotropic point pulse of strength $Q_0$ at the origin at time $t=0$.\n-   **Governing Equation:** The time-dependent linear Boltzmann Transport Equation (LBTE) is given as:\n    $$\n    \\frac{1}{v}\\,\\frac{\\partial \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, t)}{\\partial t} + \\boldsymbol{\\Omega}\\cdot\\nabla \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, t) + \\Sigma_a\\,\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, t) = q(\\mathbf{r}, \\boldsymbol{\\Omega}, t)\n    $$\n-   **Initial Condition:** $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, t0)=0$.\n-   **Exact Solution Property:** The scalar flux, $\\phi(\\mathbf{r}, t) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, t)\\,d\\boldsymbol{\\Omega}$, is supported on the spherical shell $r = \\|\\mathbf{r}\\| = v t$ and is spherically symmetric on that shell.\n-   **Numerical Discretization:** Discrete Ordinates ($S_N$) method with $M$ directions $\\{\\boldsymbol{\\Omega}_m, w_m\\}_{m=1}^M$ on a uniform spatial grid with characteristic cell size $h$.\n-   **Numerical Behavior Model (Ray Effects):** Energy propagates preferentially along discrete directions, but finite differencing introduces lateral numerical diffusion.\n-   **Geometric Scaling Assumption 1:** The effective solid-angle footprint per discrete direction scales as $\\Delta\\Omega(t) \\approx \\kappa\\,h/r$, where $\\kappa=\\mathcal{O}(1)$ is a scheme-dependent constant.\n-   **Geometric Scaling Assumption 2:** The fraction of the unit sphere covered by the union of all $M$ footprints is $f(t) \\approx \\dfrac{M\\,\\Delta\\Omega(t)}{4\\pi}$.\n-   **Error Metric Definition:** $E(t)$ is the coefficient of variation (CV) of the scalar flux $\\phi(\\mathbf{r}, t)$ over the spherical shell of radius $r=v t$.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded:** The problem describes a canonical benchmark in neutron transport theory, known as the infinite medium pulsed source problem. The LBTE is the correct governing equation. Ray effects are a well-documented artifact of the $S_N$ method. The modeling of numerical diffusion via a footprint scaling, while a simplification, is a physically plausible phenomenological approach to quantify the effect.\n-   **Well-Posed:** The problem provides a clear physical and numerical context, a set of modeling assumptions, and a precisely defined quantity to derive, $E(t)$. It is structured to test the ability to synthesize these pieces into a coherent model.\n-   **Objective:** The problem is stated in precise, technical language devoid of subjectivity.\n-   **Flaw Analysis:**\n    -   The problem is scientifically and mathematically sound. The provided assumptions, such as $\\Delta\\Omega(t) \\propto h/r$, are stipulated for the purpose of the problem and do not violate fundamental principles within this modeling context.\n    -   The problem is fully formalizable and relevant to the topic of numerical transport theory.\n    -   The setup is self-contained and internally consistent.\n    -   The idealizations (infinite medium, constant speed) are standard in theoretical physics and do not render the problem invalid.\n    -   The problem is well-posed and expected to have a unique solution based on the given assumptions.\n    -   The problem is not trivial; it requires connecting concepts from statistics (CV), numerical analysis ($S_N$ artifacts), and transport physics.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The setup is a consistent and well-posed theoretical exercise in modeling numerical artifacts in transport simulations. I will proceed to derive the solution.\n\n### Solution Derivation\n\nThe goal is to derive the expression for the angular discretization error metric $E(t)$, defined as the coefficient of variation (CV) of the scalar flux $\\phi(\\mathbf{r}, t)$ on the spherical shell of radius $r=vt$.\n\nThe coefficient of variation is the ratio of the standard deviation to the mean:\n$$\nE(t) = \\text{CV}[\\phi] = \\frac{\\sigma_{\\phi}}{\\mu_{\\phi}}\n$$\nwhere the statistics are computed over the surface of the sphere $S$ with radius $r=vt$.\n\nBased on the problem description, the numerical solution for the scalar flux on the sphere $S$ is highly non-uniform. It consists of high-flux regions (the footprints of the $M$ discrete ordinates) and zero-flux regions (the gaps in between). We can model this as a binary distribution.\n\nLet $f(t)$ be the fraction of the total surface area of the sphere that is covered by the flux footprints. The problem states this is equivalent to the fraction of the solid angle covered, $f(t)$.\n-   The area of the \"hot\" regions is $A_{hot} = f(t) \\cdot (4\\pi r^2)$.\n-   The area of the \"cold\" regions is $A_{cold} = (1-f(t)) \\cdot (4\\pi r^2)$.\n\nLet the flux have a constant value $\\phi_{hot}$ in the hot regions and be $\\phi_{cold} = 0$ in the cold regions. The total flux integrated over the sphere at time $t$ is conserved up to physical absorption. The total number of neutrons at time $t$ is $Q_0 e^{-\\Sigma_a vt}$. The total integrated scalar flux over the sphere is $\\Phi_{total}(t) = \\int_S \\phi(\\mathbf{r}, t) dA = v \\cdot (\\text{total neutrons}) = v Q_0 e^{-\\Sigma_a v t}$.\n\nWe can also express $\\Phi_{total}(t)$ in terms of our binary flux model:\n$$\n\\Phi_{total}(t) = \\phi_{hot} A_{hot} + \\phi_{cold} A_{cold} = \\phi_{hot} \\cdot f(t) \\cdot (4\\pi r^2)\n$$\nThe mean flux $\\mu_{\\phi}$ over the spherical surface is the total integrated flux divided by the total area $A = 4\\pi r^2$:\n$$\n\\mu_{\\phi} = \\frac{\\Phi_{total}(t)}{A} = \\frac{\\phi_{hot} \\cdot f(t) \\cdot (4\\pi r^2)}{4\\pi r^2} = \\phi_{hot} f(t)\n$$\nNext, we find the variance, $\\sigma_{\\phi}^2$. The variance is the mean of the squared deviations from the mean, $\\sigma_\\phi^2 = \\langle (\\phi - \\mu_\\phi)^2 \\rangle$. An easier formula is $\\sigma_{\\phi}^2 = \\langle \\phi^2 \\rangle - \\mu_{\\phi}^2$.\n\nThe mean-square flux $\\langle \\phi^2 \\rangle$ is:\n$$\n\\langle \\phi^2 \\rangle = \\frac{\\int_S \\phi^2(\\mathbf{r}, t) dA}{A} = \\frac{\\phi_{hot}^2 A_{hot} + \\phi_{cold}^2 A_{cold}}{A} = \\frac{\\phi_{hot}^2 \\cdot f(t) \\cdot (4\\pi r^2)}{4\\pi r^2} = \\phi_{hot}^2 f(t)\n$$\nNow, we compute the variance:\n$$\n\\sigma_{\\phi}^2 = \\langle \\phi^2 \\rangle - \\mu_{\\phi}^2 = \\phi_{hot}^2 f(t) - (\\phi_{hot} f(t))^2 = \\phi_{hot}^2 (f(t) - f(t)^2) = \\phi_{hot}^2 f(t) (1 - f(t))\n$$\nThe standard deviation $\\sigma_{\\phi}$ is the square root of the variance:\n$$\n\\sigma_{\\phi} = \\sqrt{\\phi_{hot}^2 f(t) (1 - f(t))} = |\\phi_{hot}| \\sqrt{f(t) (1-f(t))}\n$$\nSince flux is non-negative, $\\phi_{hot} \\ge 0$.\nNow we can compute the coefficient of variation, $E(t)$:\n$$\nE(t) = \\frac{\\sigma_{\\phi}}{\\mu_{\\phi}} = \\frac{\\phi_{hot} \\sqrt{f(t) (1 - f(t))}}{\\phi_{hot} f(t)} = \\frac{\\sqrt{f(t) (1 - f(t))}}{f(t)}\n$$\nSimplifying this expression:\n$$\nE(t) = \\sqrt{\\frac{f(t)(1 - f(t))}{f(t)^2}} = \\sqrt{\\frac{1 - f(t)}{f(t)}}\n$$\nThis derivation establishes the relationship between the error metric $E(t)$ and the covered fraction $f(t)$. The absolute value of the flux $\\phi_{hot}$ cancels out, demonstrating that the CV is a relative measure, independent of overall flux magnitude (and thus independent of the physical absorption $\\Sigma_a$).\n\nFinally, we must find the expression for $f(t)$ using the problem's assumptions.\n1.  $\\Delta\\Omega(t) \\approx \\kappa\\,h/r$\n2.  $f(t) \\approx \\dfrac{M\\,\\Delta\\Omega(t)}{4\\pi}$\n3.  $r=vt$\n\nSubstituting (1) into (2):\n$$\nf(t) \\approx \\frac{M (\\kappa h/r)}{4\\pi} = \\frac{M \\kappa h}{4\\pi r}\n$$\nNow, substituting (3) into this expression:\n$$\nf(t) = \\frac{M \\kappa h}{4\\pi v t}\n$$\nCombining our results yields the final expression for the error metric:\n$$\nE(t) = \\sqrt{\\frac{1 - f(t)}{f(t)}} \\quad \\text{with} \\quad f(t) = \\frac{M\\,\\kappa\\,h}{4\\pi\\,v\\,t}\n$$\n\n### Option-by-Option Analysis\n\n**A. $E(t) = \\sqrt{\\dfrac{1 - f(t)}{f(t)}}$ with $f(t) = \\dfrac{M\\,\\kappa\\,h}{4\\pi\\,v\\,t}$.**\nThis expression matches our derivation precisely. The functional form for $E(t)$ in terms of $f(t)$ is correctly derived from the definition of the coefficient of variation for the assumed binary flux distribution. The expression for $f(t)$ is correctly derived by combining the geometric scaling assumptions provided in the problem statement.\n**Verdict: Correct.**\n\n**B. $E(t) = \\dfrac{4\\pi\\,v\\,t}{M\\,\\kappa\\,h}$.**\nThis expression is equivalent to $1/f(t)$. Our derivation yielded $E(t) = \\sqrt{1/f(t) - 1}$. For ray effects to be significant, $f(t)$ must be small (i.e., for large $t$), in which case $E(t) \\approx \\sqrt{1/f(t)}$. Option B is missing the square root, making it functionally incorrect.\n**Verdict: Incorrect.**\n\n**C. $E(t) = e^{-\\Sigma_a\\,v\\,t}$.**\nThis term describes the physical attenuation of the neutron population due to absorption. The error metric $E(t)$ is the coefficient of variation, a statistical measure of relative spatial non-uniformity. As shown in the derivation, any factors that scale the overall magnitude of the flux, such as $e^{-\\Sigma_a\\,v\\,t}$, cancel out when computing the ratio of standard deviation to the mean. Therefore, this expression confuses physical attenuation with numerical discretization error.\n**Verdict: Incorrect.**\n\n**D. $E(t) = \\sqrt{\\dfrac{1 - f(t)}{f(t)}}$ with $f(t) = \\dfrac{M\\,\\kappa\\,h}{4\\pi}$.**\nThe form of $E(t)$ in terms of $f(t)$ is correct. However, the expression for $f(t)$ is given as a constant, independent of time $t$. This contradicts the geometric setup where the spherical shell expands with radius $r=vt$. As the shell expands, a footprint of a given size covers a smaller fraction of the total area/solid angle. The coverage fraction $f(t)$ must depend on time. The correct dependency is $f(t) \\propto 1/r \\propto 1/t$, which is missing here.\n**Verdict: Incorrect.**\n\n**E. $E(t) = \\sqrt{\\dfrac{1 - f(t)}{f(t)}}$ with $f(t) = \\dfrac{M\\,\\kappa\\,h\\,e^{-\\Sigma_a\\,v\\,t}}{4\\pi\\,v\\,t}$.**\nThis option correctly has the form $E(t)=\\sqrt{(1-f)/f}$ and the $1/t$ dependence in $f(t)$. However, it incorrectly includes the physical attenuation factor $e^{-\\Sigma_a v t}$ in the expression for $f(t)$. The fraction of area $f(t)$ covered by the numerical rays is a purely geometric and numerical-method-dependent property. It depends on the number of directions $M$, the spatial grid size $h$, and the time $t$ (through $r=vt$), but not on the physical absorption cross section $\\Sigma_a$ of the medium.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}