## Introduction
Unstructured mesh transport methods represent a cornerstone of modern high-fidelity simulation, enabling the accurate prediction of particle behavior in systems with complex geometries. In fields such as nuclear reactor physics, [medical physics](@entry_id:158232), and astrophysics, the ability to solve the fundamental Boltzmann transport equation without geometric compromise is critical for design, analysis, and safety. These methods are designed to overcome the well-known limitations of simpler approximations, such as [diffusion theory](@entry_id:1123718), which fail in scenarios with strong directional effects, material heterogeneities, or significant void regions. By conforming to intricate designs, unstructured meshes eliminate the geometric errors and modeling compromises inherent in traditional [structured grid](@entry_id:755573) approaches.

This article addresses the key challenge of numerically solving the transport equation on these flexible but complex meshes. It provides a comprehensive guide to the principles, algorithms, and applications that define the state of the art. The reader will gain a deep understanding of not only the theoretical underpinnings but also the practical considerations required to build robust and efficient transport solvers.

The discussion is structured across three distinct chapters. The first chapter, **Principles and Mechanisms**, lays the groundwork by introducing the linear Boltzmann transport equation and exploring the core discretization strategies for both angle (Discrete Ordinates and Spherical Harmonics) and space (Finite Volume and Discontinuous Galerkin methods). It establishes the crucial concepts of conservation, causality, and stability. Building on this foundation, the second chapter, **Applications and Interdisciplinary Connections**, shifts to advanced topics in implementation and use. It delves into iterative solution schemes and acceleration methods like DSA, [parallel computing](@entry_id:139241) paradigms for modern hardware, and the critical role of transport solvers within [coupled multiphysics](@entry_id:747969) frameworks. Finally, the **Hands-On Practices** section provides targeted problems to solidify understanding by translating theoretical concepts into algorithmic logic, guiding the reader through the derivation of balance equations and the implementation of a [transport sweep](@entry_id:1133407).

## Principles and Mechanisms

This chapter delves into the fundamental principles governing [particle transport](@entry_id:1129401) and the primary numerical mechanisms employed to simulate these phenomena on unstructured meshes. We will begin by examining the foundational transport equation, contrasting it with simpler approximations to establish the necessity of high-fidelity methods. Subsequently, we will explore the core discretization strategies for both the angular and spatial domains, which form the basis of modern transport solvers. Finally, we will address the critical concepts of causality, stability, and accuracy, including the advanced techniques required to ensure physically meaningful and precise solutions in complex scenarios.

### The Linear Boltzmann Transport Equation: The Governing Principle

The behavior of neutral particles, such as neutrons or photons, as they travel through a medium is statistically described by the **linear Boltzmann transport equation**. This equation represents a detailed [particle balance](@entry_id:753197) within an infinitesimal volume of a seven-dimensional phase space, comprising three spatial coordinates ($\mathbf{r}$), two angular coordinates ($\boldsymbol{\Omega}$), one energy coordinate ($E$), and time. For many applications in reactor physics, we are interested in the [steady-state distribution](@entry_id:152877) of particles, for which the time-dependent term is omitted.

The steady-state linear Boltzmann transport equation is given by:
$$
\boldsymbol{\Omega}\cdot\nabla \psi(\mathbf{r},\boldsymbol{\Omega},E) + \Sigma_t(\mathbf{r},E)\psi(\mathbf{r},\boldsymbol{\Omega},E) = \int_{0}^{\infty} \int_{4\pi} \Sigma_s(\mathbf{r},E' \to E, \boldsymbol{\Omega}' \to \boldsymbol{\Omega}) \psi(\mathbf{r},\boldsymbol{\Omega}',E') \,d\boldsymbol{\Omega}' \,dE' + q(\mathbf{r},\boldsymbol{\Omega},E)
$$
Here, the central quantity is the **angular flux**, $\psi(\mathbf{r},\boldsymbol{\Omega},E)$, which represents the number of particles at position $\mathbf{r}$, traveling in the direction of the unit vector $\boldsymbol{\Omega}$, with energy $E$. Each term in the equation corresponds to a physical process affecting the particle population in a differential phase-space volume :

1.  **Streaming Term**: $\boldsymbol{\Omega}\cdot\nabla \psi$ represents the net rate at which particles stream out of a differential spatial volume. This is a directional advection term that describes the free flight of particles between collisions.

2.  **Collision Term**: $\Sigma_t(\mathbf{r},E)\psi$ represents the rate of particle removal from the phase-space point $(\mathbf{r},\boldsymbol{\Omega},E)$ due to collisions of any type. The quantity $\Sigma_t$ is the **macroscopic total cross section**, representing the probability of interaction per unit path length.

3.  **Scattering Source Term**: The integral term describes the rate at which particles are gained at $(\mathbf{r},\boldsymbol{\Omega},E)$ due to scattering events at the same location. Particles with initial direction $\boldsymbol{\Omega}'$ and energy $E'$ are scattered into the direction $\boldsymbol{\Omega}$ and energy $E$. This process is governed by the **macroscopic [differential scattering cross section](@entry_id:1123684)**, $\Sigma_s(\mathbf{r},E' \to E, \boldsymbol{\Omega}' \to \boldsymbol{\Omega})$.

4.  **External Source Term**: $q(\mathbf{r},\boldsymbol{\Omega},E)$ represents the rate at which particles are introduced into the system from external sources, such as [spontaneous fission](@entry_id:153685) or manufactured sources. In reactor physics, this term is often generalized to include particles born from induced fission, which introduces a nonlinearity and an eigenvalue problem.

For many years, the computational cost of solving the full transport equation was prohibitive. A common simplification is **diffusion theory**, which can be derived as a low-order approximation of the transport equation. This approximation is made by taking the first two angular moments of the transport equation and invoking a closure known as the P1 approximation, which assumes the angular flux is only linearly anisotropic. This procedure eliminates the explicit angular dependence, resulting in a single equation for the **[scalar flux](@entry_id:1131249)**, $\phi(\mathbf{r},E) = \int_{4\pi} \psi(\mathbf{r},\boldsymbol{\Omega},E) \,d\boldsymbol{\Omega}$.

The contrast between transport and diffusion theory is stark . In diffusion theory, the directional streaming term is replaced by a leakage term, $-\nabla \cdot \mathbf{J}(\mathbf{r},E)$, where the current $\mathbf{J}$ is related to the gradient of the scalar flux via **Fick's Law**, $\mathbf{J} = -D\nabla\phi$. The diffusion coefficient $D$ is defined in terms of material properties. This transforms the first-order hyperbolic transport equation into a second-order elliptic diffusion equation. While computationally much simpler to solve, especially on unstructured meshes, this simplification comes at a cost. Diffusion theory cannot resolve strong angular dependencies in the flux, which occur near localized sources, at material interfaces with high contrast, or in regions with significant voids. Furthermore, the standard diffusion equation is driven by an isotropic representation of the scattering source, with scattering anisotropy being indirectly incorporated into a **[transport cross section](@entry_id:1133392)**, $\Sigma_{tr}$, which modifies the diffusion coefficient. The full transport equation, by contrast, retains all angular information and can accommodate highly anisotropic sources and scattering events. Unstructured mesh transport methods are designed to solve this more fundamental equation, providing high-fidelity solutions where [diffusion theory](@entry_id:1123718) fails.

### Discretization of the Phase Space

To solve the transport equation numerically, the continuous independent variables—space, angle, and energy—must be discretized. While energy is typically handled with a [multigroup approximation](@entry_id:1128301), this chapter focuses on the angular and spatial variables.

#### Angular Discretization Methods

Two dominant families of methods exist for discretizing the angular variable $\boldsymbol{\Omega}$.

The **Discrete Ordinates ($S_N$) method** is a form of angular collocation. It replaces the continuous angular domain with a finite set of $M$ discrete directions, $\{\boldsymbol{\Omega}_m\}_{m=1}^M$, and associated [quadrature weights](@entry_id:753910), $\{w_m\}_{m=1}^M$. The [quadrature set](@entry_id:156430) is chosen such that it accurately integrates the first several spherical harmonic polynomials. This process transforms the single integro-differential transport equation into a large system of coupled partial differential equations, one for each discrete direction $\boldsymbol{\Omega}_m$:
$$
\boldsymbol{\Omega}_m \cdot\nabla \psi_m(\mathbf{r}) + \Sigma_t(\mathbf{r}) \psi_m(\mathbf{r}) = \sum_{m'=1}^M w_{m'} \Sigma_{s,m' \to m}(\mathbf{r}) \psi_{m'}(\mathbf{r}) + q_m(\mathbf{r})
$$
where $\psi_m(\mathbf{r})$ is the angular flux along the discrete direction $\boldsymbol{\Omega}_m$. These equations are typically solved using a sweep-based algorithm across the spatial mesh for each direction. A well-known artifact of the $S_N$ method is the **ray effect**, where unphysical spatial variations in the flux can appear in low-scattering regions due to the finite number of discrete directions .

The **Spherical Harmonics ($P_N$) method** takes a spectral approach. The angular flux is expanded in a truncated series of [spherical harmonics](@entry_id:156424), $Y_{lk}(\boldsymbol{\Omega})$, which form an [orthonormal basis](@entry_id:147779) on the unit sphere:
$$
\psi(\mathbf{r}, \boldsymbol{\Omega}) \approx \sum_{l=0}^{N} \sum_{k=-l}^{l} \psi_{lk}(\mathbf{r}) Y_{lk}(\boldsymbol{\Omega})
$$
The unknowns are the spatially dependent expansion coefficients, or moments, $\psi_{lk}(\mathbf{r})$. Substituting this expansion into the transport equation and taking moments yields a system of coupled PDEs for the moments $\psi_{lk}$. Because the [spherical harmonics](@entry_id:156424) basis is continuous and rotationally invariant, the $P_N$ method is free from [ray effects](@entry_id:1130607). However, its primary drawback is the **Gibbs phenomenon**. Representing a sharp angular discontinuity (e.g., a beam source or a shadow) with a truncated series of smooth global functions leads to persistent oscillations in the reconstructed angular flux. In transport-dominated problems, these oscillations can cause the scalar flux to become non-physically negative .

$S_N$ and $P_N$ are fundamentally different approaches—collocation versus spectral—and they do not become equivalent. $S_N$ methods are generally preferred for problems with strong directional effects, while $P_N$ methods can be efficient in systems where the flux is smoothly varying in angle.

#### Spatial Discretization on Unstructured Meshes

Once the angular dependence is discretized (typically via the $S_N$ method), we are left with a system of spatial PDEs to solve on an unstructured mesh. The use of unstructured polyhedral meshes provides immense geometric flexibility for modeling complex reactor components. Solving the transport equation on such a mesh requires a robust [spatial discretization](@entry_id:172158) scheme.

First, a consistent representation of the mesh geometry is essential. For any conservative, face-based method, a minimal set of geometric data for each polyhedral cell $c$ includes :
*   **Cell Volume ($|V_c|$)**: Used for integrating volume-dependent terms like collisions and sources.
*   **Face Areas ($|A_f|$)**: Used to compute the magnitude of particle current through each face $f$ of the cell.
*   **Outward Face Unit Normals ($\mathbf{n}_f$)**: The orientation of the normal is critical. It must be defined consistently (e.g., pointing outward from the cell) to distinguish between inflow faces (where $\boldsymbol{\Omega}_m \cdot \mathbf{n}_f  0$) and outflow faces (where $\boldsymbol{\Omega}_m \cdot \mathbf{n}_f > 0$).
*   **Face-to-Cell Connectivity**: A mapping that identifies the neighboring cell on the other side of each face. This is essential for applying upwinding and coupling the solution between cells.
*   **Vertex Connectivity**: A list of vertex coordinates defining each polygonal face. This fundamental data is required to robustly compute the face properties (area, normal, centroid) and to perform accurate numerical integration (quadrature) over the face, which is especially important for high-order methods.

With this geometric framework, several families of [spatial discretization](@entry_id:172158) methods can be employed. The most prominent for transport applications are the Finite Volume Method (FVM), the Discontinuous Galerkin (DG) method, and the Continuous Finite Element Method (CFEM) .

The **Finite Volume Method (FVM)** is derived by integrating the transport equation over each cell and applying the [divergence theorem](@entry_id:145271). This directly yields an equation stating that the net leakage across the cell boundary plus the total collisions within the cell must equal the total source in the cell. This makes FVM **locally conservative** by construction—a highly desirable property for [particle transport](@entry_id:1129401). The solution within each cell is typically represented by a single average value, making the overall solution field discontinuous across cell faces.

The **Continuous Finite Element Method (CFEM)** uses a global [weak formulation](@entry_id:142897) where the solution is represented by a basis of functions that are continuous across cell boundaries (e.g., piecewise linear functions in a $C^0$ space). While this enforces a smooth solution, standard CFEM is **not locally conservative** and is notoriously unstable for [advection-dominated problems](@entry_id:746320) like transport, producing severe, non-physical oscillations in the solution.

The **Discontinuous Galerkin (DG) Method** combines the strengths of FVM and FEM. Like FEM, it uses a weak formulation with polynomial basis functions, allowing for systematic high-order accuracy. However, like FVM, it uses a basis of functions that are discontinuous across cell boundaries. Coupling between cells is achieved via a numerical flux on the faces. A key feature of DG is that because piecewise constant functions are valid [test functions](@entry_id:166589), the method is **locally conservative**, just like FVM. This combination of [high-order accuracy](@entry_id:163460) and [local conservation](@entry_id:751393) makes DG a premier choice for modern unstructured mesh transport codes.

A cornerstone of both FVM and DG methods is the concept of **particle conservation**. A numerical scheme is locally conservative if the discrete equations for each cell represent an exact balance of particles entering, leaving, being removed, and being created within that cell. Global conservation over the entire domain is then automatically guaranteed by summing the local balances, as the fluxes across all interior faces cancel out perfectly. A numerical check for local conservation involves computing the residual of the discrete balance equation for each cell after a solution has been obtained; for a converged, [conservative scheme](@entry_id:747714), this residual should be close to zero for every cell in the mesh .

### Causality, Upwinding, and Transport Sweeps

The streaming term $\boldsymbol{\Omega} \cdot \nabla \psi$ makes the transport equation a first-order hyperbolic PDE. This mathematical structure reflects a deep physical principle: **causality**. Particles travel along characteristics defined by the [direction vector](@entry_id:169562) $\boldsymbol{\Omega}$, and the flux at any point is determined solely by information from "upwind" along its characteristic path. A stable numerical scheme must respect this one-way flow of information .

In FVM and DG methods, causality is enforced through the choice of the **[numerical flux](@entry_id:145174)** at cell interfaces. The **[upwind flux](@entry_id:143931)** dictates that for a given face, the flux value used in the calculation is taken from the trace of the solution in the cell from which particles are flowing (the upwind cell). For a face $f$ with normal $\mathbf{n}_f$ pointing from cell $K^-$ to cell $K^+$, the upwind choice is:
$$
\widehat{\psi}_f = \begin{cases} \psi^-  \text{if } \boldsymbol{\Omega} \cdot \mathbf{n}_f > 0 \text{ (flow from } K^- \text{ to } K^+ \text{)} \\ \psi^+  \text{if } \boldsymbol{\Omega} \cdot \mathbf{n}_f  0 \text{ (flow from } K^+ \text{ to } K^- \text{)} \end{cases}
$$
This choice ensures that the discrete equations for any cell depend only on its upwind neighbors. Other choices, such as a central flux ($\frac{1}{2}(\psi^- + \psi^+)$) or a downwind flux, violate causality by introducing dependencies on downstream information and lead to unstable schemes.

This upwind dependency structure enables a highly efficient solution strategy known as a **[transport sweep](@entry_id:1133407)**. For a fixed direction $\boldsymbol{\Omega}_m$, the dependencies between cells form a directed graph. In many cases, this graph is a Directed Acyclic Graph (DAG). A DAG can be topologically sorted to produce a "sweep order," allowing the cells to be processed one by one, with the solution for each cell being computed using the already-known solutions from its upwind neighbors. This avoids the need to solve a large, coupled global system of equations for the streaming operator.

The sweep begins at inflow boundaries of the domain, where the incoming flux is prescribed by a boundary condition . Common boundary conditions include:
*   **Vacuum**: No particles enter the domain. The incoming flux is zero for all inflow directions.
*   **Specular Reflection**: The boundary acts as a mirror. The incoming flux in a direction $\boldsymbol{\Omega}_m$ is equal to the outgoing flux in the corresponding reflected direction $\boldsymbol{\Omega}_{\mathcal{R}(m)}$.
*   **Periodic**: The boundary is identified with an opposite boundary. The incoming flux at one periodic face is equal to the outgoing flux at its paired face in the same direction.

While the sweep algorithm is elegant and efficient, it is not always possible. On complex unstructured meshes or with certain boundary conditions (notably periodic), the [dependency graph](@entry_id:275217) can contain cycles. This means a simple [topological sort](@entry_id:269002) is not possible. In such cases, the cells within a cycle form a [strongly connected component](@entry_id:261581) and must be solved as a small, coupled system, typically with an iterative method. Identifying and resolving these cycles is a key challenge in developing robust unstructured mesh transport solvers  .

### Accuracy, Stability, and Advanced Topics

While a [first-order upwind scheme](@entry_id:749417) (as in standard FVM) is robust and positivity-preserving, its accuracy is limited. The leading error term behaves like an artificial numerical diffusion, which can excessively smear sharp features in the solution. The magnitude of this artificial diffusion is proportional to the local **Peclet number**, $Pe_K$, which is the ratio of advective transport to physical diffusion (or a diffusive-like effect from strong scattering). On highly distorted or skewed unstructured meshes, the error is further exacerbated by spurious **crosswind diffusion**. Consequently, the numerical error of an upwind scheme depends strongly on the Peclet number and [mesh quality metrics](@entry_id:273880) like **aspect ratio** and **skewness** .

To achieve higher accuracy, one can either move to [high-order methods](@entry_id:165413) like DG or attempt to improve lower-order methods like CFEM.

As noted, standard CFEM is unstable for transport problems. The **Streamline-Upwind/Petrov-Galerkin (SUPG)** method is a powerful stabilization technique that remedies this. It modifies the [test space](@entry_id:755876) in the Galerkin formulation by adding a perturbation aligned with the streamline direction $\boldsymbol{\Omega}$. This introduces a consistent numerical diffusion term that acts *only* along the [streamline](@entry_id:272773), damping spurious oscillations without adding the excessive crosswind diffusion characteristic of isotropic artificial diffusion. This targeted stabilization makes SUPG highly effective on general unstructured meshes .

High-order DG methods, while formally very accurate, present their own challenge. A fundamental result in numerical analysis, **Godunov's theorem**, implies that any linear, high-order scheme cannot guarantee that the solution remains positive in the presence of sharp gradients or discontinuities. Indeed, high-order DG solutions often exhibit non-physical negative undershoots near material interfaces or boundary layers . Since negative [particle flux](@entry_id:753207) is unphysical, this must be corrected.

The solution lies in nonlinear or adaptive **[positivity-preserving limiters](@entry_id:753610)**. These techniques modify the high-order solution locally and nonlinearly only in cells where positivity is violated. Two prominent, successful strategies are:
1.  **Bound-Preserving Limiters**: These methods, such as the Zhang-Shu limiter, rescale the high-order polynomial solution within a cell around its cell average. The scaling is chosen to be just enough to lift any negative values to zero, thereby enforcing the positivity bound. This process is designed to be conservative (it preserves the cell average) and is only active when needed, thus retaining the formal high-order accuracy of the scheme in smooth regions of the flow.
2.  **Flux-Corrected Transport (FCT)**: This is a sophisticated blending algorithm. It starts with a robust, positivity-preserving low-order solution. It then calculates "antidiffusive" fluxes that would be needed to restore the high-order solution. These fluxes are then nonlinearly limited to ensure that their application does not create any new maxima or minima, thus preserving positivity. Like bound-preserving limiters, FCT is conservative and retains high-order accuracy for smooth solutions.

These advanced techniques are essential for making high-order unstructured mesh transport methods practical and reliable for real-world applications, ensuring that the computed solutions are not only accurate but also physically meaningful.