{
    "hands_on_practices": [
        {
            "introduction": "有限体积法的核心思想是在每个计算单元上强制执行粒子守恒。本练习将引导您从连续形式的玻尔兹曼输运方程出发，推导出离散的单元平衡方程，从而具体理解泄漏、吸收和源项是如何在数值格式中被量化的。通过这个实践，您将掌握构建非结构网格输运方法中基本守恒关系的核心技能。",
            "id": "4259421",
            "problem": "考虑在用于核反应堆模拟的离散纵标法 (S$_N$) 公式中，一个稳态单能输运方向。设一个具有轴对齐面的凸六面体单元，其边长分别为 $L_x$、$L_y$ 和 $L_z$，因此单元体积为 $V = L_x L_y L_z$，六个面的面积分别为 $A_{\\pm x} = L_y L_z$、$A_{\\pm y} = L_x L_z$ 和 $A_{\\pm z} = L_x L_y$。对于角通量 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$，在具有恒定总截面 $\\Sigma_t$ 和单位立体角上恒定各向同性体积源 $q$ 的情况下，稳态线性玻尔兹曼输运方程为\n$$\n\\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) + \\Sigma_t \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) = q.\n$$\n从此方程出发，在单元体积上积分并应用散度定理，推导出一个离散单元平衡方程，该方程将在分片常数近似下，把单元内的常数角通量与给定方向 $\\boldsymbol{\\Omega}$ 上每个面的流入和流出角通量联系起来。假设采用以下物理上一致的建模选择：\n- 分片常数近似将单元内部的 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$ 设为单一常数 $\\psi_c(\\boldsymbol{\\Omega})$。\n- 在流出面（即 $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f > 0$ 的面，其中 $\\mathbf{n}_f$ 是面 $f$ 的外法向单位矢量），面角通量等于单元值，即 $\\psi_f(\\boldsymbol{\\Omega}) = \\psi_c(\\boldsymbol{\\Omega})$。\n- 在流入面（即 $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f  0$ 的面），面角通量被指定为入射边界值 $\\psi_{f,\\text{in}}(\\boldsymbol{\\Omega})$。\n\n然后，对于一个具体的六面体单元，其 $L_x = 2\\,\\text{cm}$，$L_y = 3\\,\\text{cm}$，$L_z = 5\\,\\text{cm}$，方向 $\\boldsymbol{\\Omega} = \\left(\\frac{3}{5}, -\\frac{4}{5}, 0\\right)$，总截面 $\\Sigma_t = \\frac{1}{3}\\,\\text{cm}^{-1}$，各向同性源 $q = \\frac{1}{2}\\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$，取入射（流入）角通量为\n$$\n\\psi_{-x,\\text{in}}(\\boldsymbol{\\Omega}) = 2\\,\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}, \\quad\n\\psi_{+y,\\text{in}}(\\boldsymbol{\\Omega}) = 3\\,\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1},\n$$\n在此方向上，其余各面没有其他流入。使用推导出的离散平衡方程，计算该单元和方向的流出角通量，注意分片常数近似使得所有流出面上的流出角通量相等。以 中子/平方厘米·秒·球面度 为单位表示您的最终答案。无需四舍五入；请提供精确值。",
            "solution": "该问题是有效的，因为它科学地基于中性粒子输运的原理，是适定的（提供了足够的信息以获得唯一解），并且是客观陈述的。\n\n出发点是在具有恒定总截面 $\\Sigma_t$ 和单位立体角上恒定各向同性体积源 $q$ 的介质中，角通量 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$ 的稳态、单能、线性玻尔兹曼输运方程：\n$$\n\\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) + \\Sigma_t \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) = q\n$$\n这里，$\\mathbf{r}$ 是位置矢量，$\\boldsymbol{\\Omega}$ 是粒子行进的方向。\n\n为推导离散单元平衡方程，我们在单个凸六面体单元的体积 $V$ 上对此方程进行积分：\n$$\n\\int_V (\\boldsymbol{\\Omega} \\cdot \\nabla \\psi) dV + \\int_V \\Sigma_t \\psi dV = \\int_V q dV\n$$\n由于对于给定的离散纵标方向，$\\boldsymbol{\\Omega}$ 是恒定的，第一项可以使用散度的乘积法则重写，$\\nabla \\cdot (\\boldsymbol{\\Omega} \\psi) = (\\nabla \\cdot \\boldsymbol{\\Omega}) \\psi + \\boldsymbol{\\Omega} \\cdot \\nabla \\psi$。因为 $\\boldsymbol{\\Omega}$ 是一个常矢量，所以 $\\nabla \\cdot \\boldsymbol{\\Omega} = 0$，故 $\\boldsymbol{\\Omega} \\cdot \\nabla \\psi = \\nabla \\cdot (\\boldsymbol{\\Omega} \\psi)$。对此项应用散度定理可得：\n$$\n\\int_V \\nabla \\cdot (\\boldsymbol{\\Omega} \\psi) dV = \\oint_{\\partial V} (\\boldsymbol{\\Omega} \\psi) \\cdot \\mathbf{n} dS = \\sum_{f=1}^{6} \\int_{A_f} \\psi_f (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) dA\n$$\n其中 $\\partial V$ 是单元的边界，由 6 个面组成。对于每个面 $f$，$A_f$ 是其面积，$\\mathbf{n}_f$ 是其外法向单位矢量，$\\psi_f$ 是该面上的角通量。\n\n现在我们应用分片常数近似。在单元内部，角通量被假定为常数值，$\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) = \\psi_c(\\boldsymbol{\\Omega})$。源 $q$ 和截面 $\\Sigma_t$ 也是常数。因此，体积积分为：\n$$\n\\int_V \\Sigma_t \\psi dV = \\Sigma_t \\psi_c V\n$$\n$$\n\\int_V q dV = q V\n$$\n在每个面 $f$ 上，通量 $\\psi_f$ 也被假定在整个面面积上是恒定的。于是面积分简化为：\n$$\n\\sum_{f=1}^{6} \\int_{A_f} \\psi_f (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) dA = \\sum_{f=1}^{6} \\psi_f (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) A_f\n$$\n将这些表达式代回积分后的输运方程，得到平衡方程：\n$$\n\\sum_{f=1}^{6} \\psi_f (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) A_f + \\Sigma_t \\psi_c V = q V\n$$\n接下来，我们利用流入和流出条件。面的集合被划分为流出面（$\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f > 0$）、流入面（$\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f  0$）以及可能的掠射面（$\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f = 0$）。对于掠射面，其对总和的贡献为零。\n- 对于流出面，通量被设为单元平均值：$\\psi_f = \\psi_c$。\n- 对于流入面，通量是一个指定的边界条件：$\\psi_f = \\psi_{f,\\text{in}}$。\n\n对所有面的求和可以相应地拆分：\n$$\n\\sum_{\\text{outflow}} \\psi_c (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) A_f + \\sum_{\\text{inflow}} \\psi_{f,\\text{in}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) A_f + \\Sigma_t \\psi_c V = q V\n$$\n我们现在可以解出未知的单元平均通量 $\\psi_c$：\n$$\n\\psi_c \\left( \\sum_{\\text{outflow}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) A_f + \\Sigma_t V \\right) = q V - \\sum_{\\text{inflow}} \\psi_{f,\\text{in}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) A_f\n$$\n$$\n\\psi_c = \\frac{q V - \\sum_{\\text{inflow}} \\psi_{f,\\text{in}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) A_f}{\\sum_{\\text{outflow}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) A_f + \\Sigma_t V}\n$$\n问题要求的是流出角通量，在给定的近似下，它等于 $\\psi_c$。\n\n现在我们将此公式应用于具体情况。单元尺寸为 $L_x = 2\\,\\text{cm}$，$L_y = 3\\,\\text{cm}$，$L_z = 5\\,\\text{cm}$。\n单元体积为 $V = L_x L_y L_z = (2)(3)(5) = 30\\,\\text{cm}^3$。\n面面积为 $A_x = L_y L_z = (3)(5) = 15\\,\\text{cm}^2$，$A_y = L_x L_z = (2)(5) = 10\\,\\text{cm}^2$，$A_z = L_x L_y = (2)(3) = 6\\,\\text{cm}^2$。\n方向为 $\\boldsymbol{\\Omega} = (\\Omega_x, \\Omega_y, \\Omega_z) = \\left(\\frac{3}{5}, -\\frac{4}{5}, 0\\right)$。\n物理常数为 $\\Sigma_t = \\frac{1}{3}\\,\\text{cm}^{-1}$ 和 $q = \\frac{1}{2}\\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$。\n\n我们必须通过检查 $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f$ 的符号来确定流入和流出面：\n- 位于 $x = -L_x/2$ 的面（面 $-x$）：$\\mathbf{n}_{-x} = (-1, 0, 0)$。$\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{-x} = -\\frac{3}{5}  0$。这是一个流入面。\n- 位于 $x = +L_x/2$ 的面（面 $+x$）：$\\mathbf{n}_{+x} = (1, 0, 0)$。$\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{+x} = +\\frac{3}{5} > 0$。这是一个流出面。\n- 位于 $y = -L_y/2$ 的面（面 $-y$）：$\\mathbf{n}_{-y} = (0, -1, 0)$。$\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{-y} = +\\frac{4}{5} > 0$。这是一个流出面。\n- 位于 $y = +L_y/2$ 的面（面 $+y$）：$\\mathbf{n}_{+y} = (0, 1, 0)$。$\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{+y} = -\\frac{4}{5}  0$。这是一个流入面。\n- 位于 $z = \\pm L_z/2$ 的面（面 $\\pm z$）：$\\mathbf{n}_{\\pm z} = (0, 0, \\pm 1)$。$\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{\\pm z} = 0$。这些是掠射面，对泄漏项总和没有贡献。\n\n给定的流入角通量为 $\\psi_{-x,\\text{in}} = 2$ 和 $\\psi_{+y,\\text{in}} = 3$，单位为 $\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$。\n\n我们现在可以计算 $\\psi_c$ 表达式中的各项：\n分子中的源项是 $qV = (\\frac{1}{2})(30) = 15$。\n流入泄漏项是 $\\sum_{\\text{inflow}} \\psi_{f,\\text{in}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) A_f$：\n$$\n\\psi_{-x,\\text{in}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{-x}) A_{-x} + \\psi_{+y,\\text{in}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{+y}) A_{+y} = (2)\\left(-\\frac{3}{5}\\right)(15) + (3)\\left(-\\frac{4}{5}\\right)(10)\n$$\n$$\n= (2)(-9) + (3)(-8) = -18 - 24 = -42\n$$\n分子是 $qV - (-42) = 15 + 42 = 57$。\n\n分母中的流出泄漏项是 $\\sum_{\\text{outflow}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_f) A_f$：\n$$\n(\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{+x}) A_{+x} + (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{-y}) A_{-y} = \\left(\\frac{3}{5}\\right)(15) + \\left(\\frac{4}{5}\\right)(10)\n$$\n$$\n= 9 + 8 = 17\n$$\n分母中的移出项是 $\\Sigma_t V = (\\frac{1}{3})(30) = 10$。\n分母是 $17 + 10 = 27$。\n\n最后，单元平均通量，也就是流出通量，为：\n$$\n\\psi_c = \\frac{57}{27}\n$$\n这个分数可以通过分子分母同时除以 $3$ 来化简：\n$$\n\\psi_c = \\frac{19}{9}\n$$\n流出角通量是 $\\frac{19}{9}\\,\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}\\,\\text{sr}^{-1}$。",
            "answer": "$$\n\\boxed{\\frac{19}{9}}\n$$"
        },
        {
            "introduction": "在反应堆模拟中，对边界条件的精确建模是确保计算结果准确性的关键一环。本练习聚焦于一种常见且物理意义重要的边界——镜面反射边界，它常用于表示模型的对称面。您将从矢量几何的第一性原理出发，推导镜面反射定律，这是正确实现输运扫描算法所必需的关键一步。",
            "id": "4259471",
            "problem": "考虑在代表反应堆堆芯的三维非结构多面体网格中的稳态单能中子输运。令 $\\,\\psi(\\mathbf{r},\\boldsymbol{\\Omega})\\,$ 表示在位置 $\\,\\mathbf{r}\\,$、方向为 $\\,\\boldsymbol{\\Omega}\\,$ 的角通量，其中 $\\,\\boldsymbol{\\Omega}\\,$ 是一个单位向量。该输运过程采用离散纵标(SN)方法进行离散，其方向集 $\\{\\boldsymbol{\\Omega}_m\\}$ 具有反射对称性。堆芯的一个对称平面被模拟为理想镜面反射边界。在此类边界上，微观物理相互作用意味着对于每次无碰撞反射，中子流的法向分量反向，而切向分量保持不变。\n\n设 $\\,\\mathbf{r}_b\\,$ 位于一个边界表面上，其单位法向量 $\\,\\mathbf{n}_b\\,$ 指向计算域内部。你需要从第一性原理出发，推导由镜面反射引起的方向映射，并说明该映射如何应用于非结构网格上基于面的迎风扫描中。\n\n从将 $\\,\\boldsymbol{\\Omega}\\,$ 分解为相对于 $\\,\\mathbf{n}_b\\,$ 的法向和切向分量的几何分解出发，并利用光滑边界上镜面反射的物理特性，推导用于边界扫描的反射方向的闭式表达式，该表达式适用于任何满足 $\\,\\mathbf{n}_b\\cdot\\boldsymbol{\\Omega}0\\,$ 的入射方向 $\\,\\boldsymbol{\\Omega}\\,$。然后，用在反射方向上求值的 $\\,\\psi\\,$ 来表述角通量 $\\,\\psi(\\mathbf{r}_b,\\boldsymbol{\\Omega})\\,$ 的相应反射边界映射。\n\n你的最终答案必须是关于 $\\,\\boldsymbol{\\Omega}\\,$ 和 $\\,\\mathbf{n}_b\\,$ 的函数，表示反射方向向量的单个闭式解析表达式。最终答案中不应包含任何等号或单位。无需四舍五入。",
            "solution": "该问题是有效的。它在科学上基于中子输运理论的原理，问题陈述清晰且信息充分，足以进行唯一的推导，并以客观、正式的语言表述。我们可以开始求解。\n\n问题要求从第一性原理出发，推导在边界上发生镜面反射后产生的方向向量。镜面反射（或称镜像反射）在物理上定义为：入射粒子的动量（也就是方向）的切向分量守恒，而其法向分量反向。给定一个入射中子方向，由单位向量 $\\boldsymbol{\\Omega}$ 表示，以及一个边界表面，其指向内部的单位法向量为 $\\mathbf{n}_b$。\n\n第一步是将入射方向向量 $\\boldsymbol{\\Omega}$ 分解为其平行于和垂直于法向量 $\\mathbf{n}_b$ 的分量。令 $\\boldsymbol{\\Omega}_n$ 为 $\\boldsymbol{\\Omega}$ 垂直于边界的分量（即平行于 $\\mathbf{n}_b$），$\\boldsymbol{\\Omega}_t$ 为切向于边界的分量（即垂直于 $\\mathbf{n}_b$）。分解如下：\n$$\n\\boldsymbol{\\Omega} = \\boldsymbol{\\Omega}_n + \\boldsymbol{\\Omega}_t\n$$\n法向分量 $\\boldsymbol{\\Omega}_n$ 通过将 $\\boldsymbol{\\Omega}$ 投影到单位向量 $\\mathbf{n}_b$ 的方向上得到。向量投影的公式为：\n$$\n\\boldsymbol{\\Omega}_n = (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b) \\mathbf{n}_b\n$$\n切向分量 $\\boldsymbol{\\Omega}_t$ 是向量 $\\boldsymbol{\\Omega}$ 减去法向分量后的剩余部分：\n$$\n\\boldsymbol{\\Omega}_t = \\boldsymbol{\\Omega} - \\boldsymbol{\\Omega}_n = \\boldsymbol{\\Omega} - (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b) \\mathbf{n}_b\n$$\n我们可以通过计算它们的点积来验证 $\\boldsymbol{\\Omega}_t$ 确实垂直于 $\\mathbf{n}_b$：\n$$\n\\boldsymbol{\\Omega}_t \\cdot \\mathbf{n}_b = \\left(\\boldsymbol{\\Omega} - (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b)\\mathbf{n}_b\\right) \\cdot \\mathbf{n}_b = (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b) - (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b)(\\mathbf{n}_b \\cdot \\mathbf{n}_b)\n$$\n由于 $\\mathbf{n}_b$ 是单位向量，所以 $\\mathbf{n}_b \\cdot \\mathbf{n}_b = |\\mathbf{n}_b|^2 = 1$。表达式简化为：\n$$\n\\boldsymbol{\\Omega}_t \\cdot \\mathbf{n}_b = (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b) - (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b) = 0\n$$\n这证实了分解是正确的，其中 $\\boldsymbol{\\Omega}_n$ 平行于 $\\mathbf{n}_b$，而 $\\boldsymbol{\\Omega}_t$ 垂直于 $\\mathbf{n}_b$。\n\n现在，令 $\\boldsymbol{\\Omega}'$ 为反射后的方向向量。它也可以被分解为一个新的法向分量 $\\boldsymbol{\\Omega}'_n$ 和一个新的切向分量 $\\boldsymbol{\\Omega}'_t$。根据镜面反射的物理特性：\n1.  法向分量反向：$\\boldsymbol{\\Omega}'_n = -\\boldsymbol{\\Omega}_n$。\n2.  切向分量保持不变：$\\boldsymbol{\\Omega}'_t = \\boldsymbol{\\Omega}_t$。\n\n我们现在可以构造反射向量 $\\boldsymbol{\\Omega}'$：\n$$\n\\boldsymbol{\\Omega}' = \\boldsymbol{\\Omega}'_n + \\boldsymbol{\\Omega}'_t = -\\boldsymbol{\\Omega}_n + \\boldsymbol{\\Omega}_t\n$$\n将 $\\boldsymbol{\\Omega}_n$ 和 $\\boldsymbol{\\Omega}_t$ 用 $\\boldsymbol{\\Omega}$ 和 $\\mathbf{n}_b$ 表示的表达式代入：\n$$\n\\boldsymbol{\\Omega}' = - \\left((\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b) \\mathbf{n}_b\\right) + \\left(\\boldsymbol{\\Omega} - (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b) \\mathbf{n}_b\\right)\n$$\n合并各项，我们得到反射方向的闭式表达式：\n$$\n\\boldsymbol{\\Omega}' = \\boldsymbol{\\Omega} - 2(\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b)\\mathbf{n}_b\n$$\n这就是所要求的公式。问题指明这适用于入射方向 $\\boldsymbol{\\Omega}$ 满足 $\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b  0$ 的情况，这正确定性了一个朝向边界移动的中子，因为 $\\mathbf{n}_b$ 指向计算域内部。对于这样一个入射方向 $\\boldsymbol{\\Omega}$，反射方向的法向分量为 $\\boldsymbol{\\Omega}' \\cdot \\mathbf{n}_b = -(\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b) > 0$，这证实了反射后的中子离开边界，返回到计算域中。\n\n接下来，我们讨论角通量 $\\psi(\\mathbf{r}_b, \\boldsymbol{\\Omega})$ 的反射边界映射。镜面反射的物理意义是，以方向 $\\boldsymbol{\\Omega}$ 入射到边界的中子被散射到反射方向 $\\boldsymbol{\\Omega}'$，其数量没有改变。这意味着角通量的大小是守恒的。因此，在边界点 $\\mathbf{r}_b$ 处，出射方向 $\\boldsymbol{\\Omega}'$ 的角通量等于同一点上相应入射方向 $\\boldsymbol{\\Omega}$ 的角通量。该关系表示为：\n$$\n\\psi(\\mathbf{r}_b, \\boldsymbol{\\Omega}') = \\psi(\\mathbf{r}_b, \\boldsymbol{\\Omega}) \\quad \\text{for } \\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b  0\n$$\n其中 $\\boldsymbol{\\Omega}' = \\boldsymbol{\\Omega} - 2(\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b)\\mathbf{n}_b$。\n\n在非结构网格上基于面的迎风扫描的背景下，此边界条件为边界上所有出射方向提供了通量值。对于一个满足 $\\boldsymbol{\\Omega}_m \\cdot \\mathbf{n}_b > 0$ 的离散方向 $\\boldsymbol{\\Omega}_m$（一个出射方向），通量 $\\psi(\\mathbf{r}_b, \\boldsymbol{\\Omega}_m)$ 作为相邻单元的迎风边界条件。该值通过寻找相应的入射方向 $\\boldsymbol{\\Omega}_{m'}$ 来确定，使得 $\\boldsymbol{\\Omega}_m$ 是 $\\boldsymbol{\\Omega}_{m'}$ 的反射方向。离散纵标集 $\\{\\boldsymbol{\\Omega}_m\\}$ 的反射对称性条件保证了如果 $\\boldsymbol{\\Omega}_{m'}$ 在该集合中，则其反射方向 $\\boldsymbol{\\Omega}_m$ 也在该集合中。然后，迎风边界值被设定为 $\\psi(\\mathbf{r}_b, \\boldsymbol{\\Omega}_m) = \\psi(\\mathbf{r}_b, \\boldsymbol{\\Omega}_{m'})$。随着扫描的进行，$\\psi(\\mathbf{r}_b, \\boldsymbol{\\Omega}_{m'})$ 的值会变为已知，因为它代表了离开一个单元并撞击边界的通量。",
            "answer": "$$\\boxed{\\boldsymbol{\\Omega} - 2(\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_b)\\mathbf{n}_b}$$"
        },
        {
            "introduction": "在非结构网格上，中子沿特定方向的输运路径可能形成“环路”，这使得简单的单次扫描求解变得不可能，必须采用迭代方法。本练习模拟了一个由反射边界条件产生的典型双节点环路，并分析了如何通过松弛迭代法来保证数值解的收敛。这项实践深入探讨了输运算法的稳定性和收敛性分析，这是处理复杂几何问题的核心挑战之一。",
            "id": "4259440",
            "problem": "考虑一个二维非结构网格上的稳态、单能离散纵标 (S$_N$) 输运问题，该问题针对方向余弦大小 $|\\mu| \\in (0,1]$ 的单个离散方向。我们关注一个由两个边界面（标记为 $f_{1}$ 和 $f_{2}$）组成的模型子图，这两个边界面在镜面反射下形成一个双节点循环。设未知量为该离散方向上 $f_{1}$ 和 $f_{2}$ 处的入射角通量 $\\psi_{\\text{in},1}$ 和 $\\psi_{\\text{in},2}$。假设存在以下符合物理现实的设定：\n\n- 在 $f_{1}$ 和 $f_{2}$ 之间的特征线上，总宏观截面为 $\\Sigma_{t} > 0$，弦长为 $\\ell > 0$，因此该离散方向的流输运衰减因子为 $\\exp\\!\\big(-\\Sigma_{t}\\ell/|\\mu|\\big) \\in (0,1)$。\n- 在每个面上，镜面反射的反照率为 $r \\in (0,1)$，因此反射的出射角通量乘以 $r$ 并指向另一个伙伴面。\n- 每个单元中存在一个空间均匀的固定源，在一次完整的特征线穿行后，该源贡献一个可加的特解，此特解可在入射映射中归入源向量 $\\mathbf{b} \\in \\mathbb{R}^{2}$。可以假设 $\\mathbf{b}$ 是有界的且与迭代无关。\n\n在这些假设下，一次镜面反射和特征线穿行将一个面上的入射通量映射到另一个面上的入射通量，其单次穿行衰减反射因子为\n$$\na \\equiv r \\exp\\!\\Big(-\\frac{\\Sigma_{t}\\ell}{|\\mu|}\\Big) \\in (0,1).\n$$\n设 $\\mathbf{x} \\equiv \\begin{pmatrix}\\psi_{\\text{in},1} \\\\ \\psi_{\\text{in},2}\\end{pmatrix}$。带反射的输运扫描导出一个形式为 $\\mathbf{x} = T\\mathbf{x} + \\mathbf{b}$ 的线性不动点问题，其中 $T \\in \\mathbb{R}^{2\\times 2}$ 具有由 $a$ 驱动的非对角耦合。为打破该循环，采用松弛因子为 $\\omega \\in (0,1)$ 的欠松弛块雅可比方法：\n$$\n\\mathbf{x}^{k+1} \\;=\\; (1-\\omega)\\,\\mathbf{x}^{k} \\;+\\; \\omega\\,(T\\mathbf{x}^{k} + \\mathbf{b}).\n$$\n\n任务：\n- 从沿特征线的线性玻尔兹曼输运和镜面反射条件出发，推导用 $a$ 表示的导出二乘二映射 $T$。\n- 写出欠松弛块迭代对应的误差传播矩阵 $M(\\omega)$，并显式计算其特征值。\n- 证明对于所有 $\\omega \\in (0,1)$ 和 $a \\in (0,1)$，双节点循环中的误差是一个压缩映射。\n- 提供 $M(\\omega)$ 的谱半径 $\\rho(\\omega)$ 的一个用 $\\omega$ 和 $a$ 表示的单个闭式解析表达式。这个最终表达式是作为答案报告的量。不包含单位。如果你选择使用 $r$、$\\Sigma_{t}$、$\\ell$ 和 $|\\mu|$ 来表示的 $a$ 的定义进行进一步简化，请将结果保持为标准数学函数的闭式形式。",
            "solution": "该问题陈述已经过严格验证，被认为是具有科学依据、适定、客观和自洽的。它提出了一个用于计算输运理论中分析迭代方法收敛性的简化但标准的模型。所有参数和条件都符合物理现实且数学上一致。因此，将提供完整解答。\n\n第一个任务是推导输运扫描矩阵 $T$。问题描述了边界面 $f_1$ 和 $f_2$ 之间的一个双节点循环。未知量是这些面上的入射角通量 $\\psi_{\\text{in},1}$ 和 $\\psi_{\\text{in},2}$，由向量 $\\mathbf{x} = \\begin{pmatrix}\\psi_{\\text{in},1} \\\\ \\psi_{\\text{in},2}\\end{pmatrix}$ 表示。输运扫描是一个不动点迭代 $\\mathbf{x} = T\\mathbf{x} + \\mathbf{b}$。这意味着第 $k+1$ 次迭代的值是根据第 $k$ 次迭代的值计算的。矩阵 $T$ 描述了此映射的齐次部分。\n\n由于循环耦合，下一个迭代步中面 $f_1$ 上的入射通量由当前迭代中面 $f_2$ 上的入射通量决定。具体来说，$f_2$ 处的通量 $\\psi_{\\text{in},2}$ 流向 $f_1$，被因子 $\\exp(-\\Sigma_t \\ell / |\\mu|)$ 衰减，并以反照率 $r$ 反射。问题方便地将这些效应组合成单个因子 $a = r \\exp(-\\Sigma_t \\ell / |\\mu|)$。因此，$\\psi_{\\text{in},2}$ 对下一次迭代的 $\\psi_{\\text{in},1}$ 的贡献是 $a \\psi_{\\text{in},2}$。对称地，$\\psi_{\\text{in},1}$ 对下一次迭代的 $\\psi_{\\text{in},2}$ 的贡献是 $a \\psi_{\\text{in},1}$。源贡献由向量 $\\mathbf{b}$ 给出。\n\n因此，雅可比扫描迭代可描述为：\n$$\n\\begin{cases}\n\\psi_{\\text{in},1}^{k+1} = a \\psi_{\\text{in},2}^{k} + b_1 \\\\\n\\psi_{\\text{in},2}^{k+1} = a \\psi_{\\text{in},1}^{k} + b_2\n\\end{cases}\n$$\n以矩阵形式表示，即为 $\\mathbf{x}^{k+1} = T\\mathbf{x}^{k} + \\mathbf{b}$，其中矩阵 $T$ 为：\n$$\nT = \\begin{pmatrix} 0  a \\\\ a  0 \\end{pmatrix}\n$$\n\n第二个任务是求出欠松弛块雅可比迭代的误差传播矩阵 $M(\\omega)$ 及其特征值。该迭代由下式给出：\n$$\n\\mathbf{x}^{k+1} = (1-\\omega)\\mathbf{x}^{k} + \\omega(T\\mathbf{x}^{k} + \\mathbf{b})\n$$\n设 $\\mathbf{x}^{*}$ 为精确解，满足 $\\mathbf{x}^{*} = T\\mathbf{x}^{*} + \\mathbf{b}$。第 $k$ 次迭代的误差为 $\\mathbf{e}^k = \\mathbf{x}^k - \\mathbf{x}^{*}$。从迭代方程中减去精确解方程，得到：\n$$\n\\mathbf{x}^{k+1} - \\mathbf{x}^{*} = (1-\\omega)\\mathbf{x}^{k} + \\omega T\\mathbf{x}^{k} + \\omega\\mathbf{b} - (T\\mathbf{x}^{*} + \\mathbf{b})\n$$\n$$\n\\mathbf{e}^{k+1} = (1-\\omega)\\mathbf{x}^{k} + \\omega T\\mathbf{x}^{k} + \\omega\\mathbf{b} - T\\mathbf{x}^{*} - \\mathbf{b}\n$$\n使用 $\\mathbf{b} = \\mathbf{x}^{*} - T\\mathbf{x}^{*}$，我们得到：\n$$\n\\mathbf{e}^{k+1} = (1-\\omega)\\mathbf{x}^{k} + \\omega T\\mathbf{x}^{k} + \\omega(\\mathbf{x}^{*} - T\\mathbf{x}^{*}) - T\\mathbf{x}^{*} - (\\mathbf{x}^{*} - T\\mathbf{x}^{*}) = (1-\\omega)\\mathbf{x}^{k} + \\omega T\\mathbf{x}^{k} - (1-\\omega)\\mathbf{x}^{*} - \\omega T\\mathbf{x}^{*}\n$$\n$$\n\\mathbf{e}^{k+1} = ((1-\\omega)I + \\omega T)(\\mathbf{x}^{k} - \\mathbf{x}^{*}) = ((1-\\omega)I + \\omega T)\\mathbf{e}^{k}\n$$\n误差传播矩阵为 $M(\\omega) = (1-\\omega)I + \\omega T$。代入 $I$ 和 $T$ 的表达式：\n$$\nM(\\omega) = (1-\\omega)\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\omega\\begin{pmatrix} 0  a \\\\ a  0 \\end{pmatrix} = \\begin{pmatrix} 1-\\omega  a\\omega \\\\ a\\omega  1-\\omega \\end{pmatrix}\n$$\n$M(\\omega)$ 的特征值 $\\lambda$ 通过求解特征方程 $\\det(M(\\omega) - \\lambda I) = 0$ 得到：\n$$\n\\det\\begin{pmatrix} 1-\\omega-\\lambda  a\\omega \\\\ a\\omega  1-\\omega-\\lambda \\end{pmatrix} = (1-\\omega-\\lambda)^2 - (a\\omega)^2 = 0\n$$\n这得到 $1-\\omega-\\lambda = \\pm a\\omega$，因此 $\\lambda = 1-\\omega \\mp a\\omega$。两个特征值为：\n$$\n\\lambda_1 = 1 - \\omega(1+a)\n$$\n$$\n\\lambda_2 = 1 - \\omega(1-a)\n$$\n\n第三个任务是证明当 $\\omega \\in (0,1)$ 和 $a \\in (0,1)$ 时，误差是一个压缩映射。这需要证明谱半径 $\\rho(M(\\omega)) = \\max(|\\lambda_1|, |\\lambda_2|)$ 严格小于 1。\n对于 $\\lambda_1$：因为 $\\omega \\in (0,1)$ 且 $a \\in (0,1)$，我们有 $1  1+a  2$。因此，$0  \\omega(1+a)  2$。这意味着 $1 - \\omega(1+a) \\in (-1, 1)$。所以，$|\\lambda_1| = |1 - \\omega(1+a)|  1$。\n对于 $\\lambda_2$：我们有 $0  1-a  1$。因此，$0  \\omega(1-a)  1$。这意味着 $1 - \\omega(1-a) \\in (0, 1)$。所以，$|\\lambda_2| = |1 - \\omega(1-a)|  1$。\n由于 $|\\lambda_1|$ 和 $|\\lambda_2|$ 都严格小于 1，它们的最大值，即谱半径 $\\rho(M(\\omega))$，也必定严格小于 1。这证明了在给定的参数范围内，该迭代是一个压缩映射。\n\n最后一个任务是找到谱半径 $\\rho(\\omega)$ 的单个闭式表达式。\n$$\n\\rho(\\omega) = \\max\\left(|1 - \\omega(1+a)|, |1 - \\omega(1-a)|\\right)\n$$\n正如对 $\\lambda_2$ 所证明的那样，项 $1 - \\omega(1-a)$ 始终在区间 $(0,1)$ 内，所以 $|1 - \\omega(1-a)| = 1 - \\omega(1-a)$。\n我们现在比较 $\\omega \\in [0,1]$ 上的两个函数：$f(\\omega) = |1 - \\omega(1+a)|$ 和 $g(\\omega) = 1 - \\omega(1-a)$。\n函数 $f(\\omega)$ 表示一个关于 $\\omega$ 的线性函数的绝对值。因此，它在区间 $[0,1]$ 上是一个凸函数。函数 $g(\\omega)$ 是一个关于 $\\omega$ 的线性函数。\n我们来计算两个函数在区间 $\\omega \\in [0,1]$ 端点处的值。\n在 $\\omega=0$ 处：$f(0)=|1-0|=1$ 且 $g(0)=1-0=1$。\n在 $\\omega=1$ 处：$f(1)=|1-(1+a)|=|-a|=a$（因为 $a>0$）且 $g(1)=1-(1-a)=a$。\n函数 $g(\\omega)$ 是连接点 $(0,1)$ 和 $(1,a)$ 的直线段。由于 $f(\\omega)$ 是一个凸函数，且其在端点处的值与线段 $g(\\omega)$ 的值相匹配，因此对于整个区间，它必定位于该线段上或其下方。也就是说，对于所有 $\\omega \\in [0,1]$，$f(\\omega) \\leq g(\\omega)$。\n这可以通过代数方法验证：\n如果 $1-\\omega(1+a) \\ge 0$，我们比较 $1-\\omega(1+a)$ 和 $1-\\omega(1-a)$。因为 $a>0$，所以 $\\omega(1+a) > \\omega(1-a)$，因此 $1-\\omega(1+a)  1-\\omega(1-a)$。\n如果 $1-\\omega(1+a)  0$，我们比较 $-(1-\\omega(1+a)) = \\omega(1+a)-1$ 和 $1-\\omega(1-a)$。它们的差是 $(\\omega(1+a)-1) - (1-\\omega(1-a)) = 2\\omega - 2 = 2(\\omega-1)$。因为 $\\omega1$，这个差是负的，所以 $\\omega(1+a)-1  1-\\omega(1-a)$。\n在所有情况下，都有 $|1 - \\omega(1+a)| \\leq 1 - \\omega(1-a)$。\n因此，两者的最大值总是 $1 - \\omega(1-a)$。\n谱半径为：\n$$\n\\rho(\\omega) = 1 - \\omega(1-a)\n$$",
            "answer": "$$\n\\boxed{1 - \\omega(1-a)}\n$$"
        }
    ]
}