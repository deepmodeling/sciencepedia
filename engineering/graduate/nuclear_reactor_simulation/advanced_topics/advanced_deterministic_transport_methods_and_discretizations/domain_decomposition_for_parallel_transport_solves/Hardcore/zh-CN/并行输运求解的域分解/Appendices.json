{
    "hands_on_practices": [
        {
            "introduction": "区域分解方法的核心在于子区域边界上信息的迭代交换。为了具体地理解这一过程，本练习提供了一个理想化的一维平板输运模型。通过这个模型，你将分析加性Schwarz方法——一种经典的区域分解算法——的单步迭代过程。亲手推导这个问题的解析解，将帮助你从数学上精确掌握子区域如何独立求解，以及它们的边界信息如何被更新，这构成了并行迭代算法的基础。",
            "id": "4222595",
            "problem": "考虑一个长度为 $L$ 的一维平板，其空间坐标为 $x \\in [0,L]$。该系统是单能纯吸收的，具有恒定的宏观总截面 $\\Sigma_{t}  0$ 和均匀的外部各向同性源，其单位角度强度为 $s  0$（即，角输运方程中的源项对于每个离散方向均为 $s$）。角通量 $\\psi(x,\\mu)$ 满足稳态线性输运方程\n$$\n\\mu \\frac{d \\psi(x,\\mu)}{dx} + \\Sigma_{t} \\psi(x,\\mu) = s,\n$$\n对于两个离散方向 $\\mu$ 和 $-\\mu$，其中固定的 $0  \\mu \\leq 1$。在外部边界上施加真空边界条件：对于左边界，入射角通量为零，$\\psi(0,\\mu) = 0$；对于右边界，入射角通量为零，$\\psi(L,-\\mu) = 0$。\n\n全局空间域被分解为两个非重叠子域 $\\Omega_{L} = [0,a]$ 和 $\\Omega_{R} = [a,L]$，其中 $0  a  L$。在 $x=a$ 处定义界面。采用加性 Schwarz 方法进行区域分解，并将以下界面迹作为子域流入数据：在 $x=a$ 处，流入 $\\Omega_{L}$ 的 $-\\mu$ 方向的数据为界面迹 $\\gamma^{-}$，流入 $\\Omega_{R}$ 的 $\\mu$ 方向的数据为界面迹 $\\gamma^{+}$。在加性 Schwarz 迭代的一步中，给定初始界面猜测值 $\\gamma^{+(0)}$ 和 $\\gamma^{-(0)}$，执行独立的子域求解：\n\n- 在 $\\Omega_{L}$上，求解满足 $\\psi_{L}(0,\\mu)=0$ 和 $\\psi_{L}(a,-\\mu)=\\gamma^{-(0)}$ 的 $\\psi_{L}(x,\\mu)$，并计算出射界面值 $\\psi_{L}(a,\\mu)$。\n- 在 $\\Omega_{R}$上，求解满足 $\\psi_{R}(L,-\\mu)=0$ 和 $\\psi_{R}(a,\\mu)=\\gamma^{+(0)}$ 的 $\\psi_{R}(x,-\\mu)$，并计算出射界面值 $\\psi_{R}(a,-\\mu)$。\n\n将加性 Schwarz 界面更新定义为邻域出射到流入的一对替换\n$$\n\\gamma^{+(1)} = \\psi_{L}(a,\\mu), \\qquad \\gamma^{-(1)} = \\psi_{R}(a,-\\mu).\n$$\n\n从上述基本输运方程出发，并强制执行所述的真空边界条件，推导 $\\psi_{L}(a,\\mu)$ 和 $\\psi_{R}(a,-\\mu)$ 的解析表达式，从而获得在一次 Schwarz 步骤中更新后的界面迹 $\\gamma^{+(1)}$ 和 $\\gamma^{-(1)}$。为避免单位，请报告由 $s/\\Sigma_{t}$ 归一化的结果，即，提供无量纲行向量\n$$\n\\left( \\frac{\\gamma^{+(1)}}{s/\\Sigma_{t}} \\ \\ \\frac{\\gamma^{-(1)}}{s/\\Sigma_{t}} \\right).\n$$\n不需要进行数值舍入。将最终答案表示为单个无单位的精确解析表达式。",
            "solution": "用户希望找到一维输运问题在一次加性 Schwarz 区域分解迭代后更新的界面迹 $\\gamma^{+(1)}$ 和 $\\gamma^{-(1)}$。最终答案应为一个归一化的行向量。\n\n首先验证问题。\n\n**第1步：提取已知条件**\n- 控制方程：$\\mu \\frac{d \\psi(x,\\mu')}{dx} + \\Sigma_{t} \\psi(x,\\mu') = s$，对于 $\\mu' \\in \\{\\mu, -\\mu\\}$。\n- 系统参数：平板长度 $L$，恒定总截面 $\\Sigma_{t}  0$，恒定源强度 $s  0$，离散方向余弦 $0  \\mu \\leq 1$。\n- 全局边界条件：$\\psi(0,\\mu) = 0$ 和 $\\psi(L,-\\mu) = 0$。\n- 区域分解：子域 $\\Omega_{L} = [0,a]$ 和 $\\Omega_{R} = [a,L]$，其中 $0  a  L$。\n- 加性 Schwarz 迭代步骤：\n  - 在 $\\Omega_{L}$ 上求解：使用边界条件 $\\psi_{L}(0,\\mu)=0$ 和界面流入 $\\psi_{L}(a,-\\mu)=\\gamma^{-(0)}$。计算出射流 $\\psi_{L}(a,\\mu)$。\n  - 在 $\\Omega_{R}$ 上求解：使用边界条件 $\\psi_{R}(L,-\\mu)=0$ 和界面流入 $\\psi_{R}(a,\\mu)=\\gamma^{+(0)}$。计算出射流 $\\psi_{R}(a,-\\mu)$。\n  - 更新：$\\gamma^{+(1)} = \\psi_{L}(a,\\mu)$ 和 $\\gamma^{-(1)} = \\psi_{R}(a,-\\mu)$。\n- 要求输出：归一化行向量 $\\left( \\frac{\\gamma^{+(1)}}{s/\\Sigma_{t}} \\ \\ \\frac{\\gamma^{-(1)}}{s/\\Sigma_{t}} \\right)$。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于线性玻尔兹曼输运方程，这是核工程和物理学中的一个基本模型。加性 Schwarz 方法是求解偏微分方程的一种标准的、被广泛理解的数值技术。该设置在科学上是合理的。\n- **适定性**：该问题包括在两个独立的区域上求解具有明确边界条件的一阶常微分方程（ODE）。每个子域问题都存在唯一解，使得单步迭代是适定的。\n- **客观性**：问题以精确的数学术语陈述，没有任何歧义或主观内容。\n\n该问题没有任何指定的缺陷（例如，科学上不合理、信息缺失、不适定）。\n\n**第3步：结论与行动**\n问题有效。我们继续求解。\n\n对于一般方向 $\\mu'$ 的稳态输运方程是一个一阶线性常微分方程：\n$$\n\\mu' \\frac{d\\psi}{dx} + \\Sigma_t \\psi = s\n$$\n可以改写为：\n$$\n\\frac{d\\psi}{dx} + \\frac{\\Sigma_t}{\\mu'} \\psi = \\frac{s}{\\mu'}\n$$\n该常微分方程的通解可以通过积分因子法求得。解的形式为：\n$$\n\\psi(x, \\mu') = \\frac{s}{\\Sigma_t} + C \\exp\\left(-\\frac{\\Sigma_t x}{\\mu'}\\right)\n$$\n其中 $C$ 是由边界条件决定的积分常数。\n\n**在子域 $\\Omega_L = [0, a]$ 上计算 $\\gamma^{+(1)}$**\n\n为了求得 $\\gamma^{+(1)} = \\psi_L(a, \\mu)$，我们必须在子域 $\\Omega_L = [0,a]$ 上求解正方向 $\\mu' = \\mu$ 的输运方程。特征线方向是从左到右，因此相关的边界条件位于子域的左边界 $x=0$ 处。\n$\\psi_L(x, \\mu)$ 的通解为：\n$$\n\\psi_L(x, \\mu) = \\frac{s}{\\Sigma_t} + C_L \\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right)\n$$\n此子域求解的边界条件为 $\\psi_L(0, \\mu) = 0$。在 $x=0$ 处应用此条件：\n$$\n\\psi_L(0, \\mu) = 0 = \\frac{s}{\\Sigma_t} + C_L \\exp(0) = \\frac{s}{\\Sigma_t} + C_L\n$$\n由此得到积分常数 $C_L = -\\frac{s}{\\Sigma_t}$。将其代回通解，得到在 $\\Omega_L$ 上 $\\mu$ 方向的角通量的特解：\n$$\n\\psi_L(x, \\mu) = \\frac{s}{\\Sigma_t} - \\frac{s}{\\Sigma_t} \\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right) = \\frac{s}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t x}{\\mu}\\right)\\right)\n$$\n问题将更新后的界面迹 $\\gamma^{+(1)}$ 定义为在界面 $x=a$ 处从 $\\Omega_L$ 出射的通量。我们在 $x=a$ 处计算 $\\psi_L(x, \\mu)$ 的值：\n$$\n\\gamma^{+(1)} = \\psi_L(a, \\mu) = \\frac{s}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t a}{\\mu}\\right)\\right)\n$$\n注意，界面条件 $\\psi_L(a, -\\mu) = \\gamma^{-(0)}$ 应用于另一方向，不影响 $\\psi_L(a, \\mu)$ 的计算。\n\n**在子域 $\\Omega_R = [a, L]$ 上计算 $\\gamma^{-(1)}$**\n\n为了求得 $\\gamma^{-(1)} = \\psi_R(a, -\\mu)$，我们在子域 $\\Omega_R = [a,L]$ 上求解负方向 $\\mu' = -\\mu$ 的输运方程。特征线方向是从右到左，因此相关的边界条件位于子域的右边界 $x=L$ 处。\n$\\psi_R(x, -\\mu)$ 的通解为：\n$$\n\\psi_R(x, -\\mu) = \\frac{s}{\\Sigma_t} + C_R \\exp\\left(-\\frac{\\Sigma_t x}{-\\mu}\\right) = \\frac{s}{\\Sigma_t} + C_R \\exp\\left(\\frac{\\Sigma_t x}{\\mu}\\right)\n$$\n此子域求解的边界条件为 $\\psi_R(L, -\\mu) = 0$。在 $x=L$ 处应用此条件：\n$$\n\\psi_R(L, -\\mu) = 0 = \\frac{s}{\\Sigma_t} + C_R \\exp\\left(\\frac{\\Sigma_t L}{\\mu}\\right)\n$$\n由此得到积分常数 $C_R = -\\frac{s}{\\Sigma_t} \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right)$。将其代回通解：\n$$\n\\psi_R(x, -\\mu) = \\frac{s}{\\Sigma_t} - \\frac{s}{\\Sigma_t} \\exp\\left(-\\frac{\\Sigma_t L}{\\mu}\\right) \\exp\\left(\\frac{\\Sigma_t x}{\\mu}\\right) = \\frac{s}{\\Sigma_t} \\left(1 - \\exp\\left(\\frac{\\Sigma_t (x-L)}{\\mu}\\right)\\right)\n$$\n更新后的界面迹 $\\gamma^{-(1)}$ 是在界面 $x=a$ 处从 $\\Omega_R$ 出射的通量。我们在 $x=a$ 处计算 $\\psi_R(x, -\\mu)$ 的值：\n$$\n\\gamma^{-(1)} = \\psi_R(a, -\\mu) = \\frac{s}{\\Sigma_t} \\left(1 - \\exp\\left(\\frac{\\Sigma_t (a-L)}{\\mu}\\right)\\right) = \\frac{s}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t (L-a)}{\\mu}\\right)\\right)\n$$\n注意，界面条件 $\\psi_R(a, \\mu) = \\gamma^{+(0)}$ 不影响此计算。\n\n**最终的归一化向量**\n\n问题要求结果由特征通量 $s/\\Sigma_t$ 归一化，并以行向量形式呈现。\n\n第一个分量是：\n$$\n\\frac{\\gamma^{+(1)}}{s/\\Sigma_t} = \\frac{\\frac{s}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t a}{\\mu}\\right)\\right)}{s/\\Sigma_t} = 1 - \\exp\\left(-\\frac{\\Sigma_t a}{\\mu}\\right)\n$$\n\n第二个分量是：\n$$\n\\frac{\\gamma^{-(1)}}{s/\\Sigma_t} = \\frac{\\frac{s}{\\Sigma_t} \\left(1 - \\exp\\left(-\\frac{\\Sigma_t (L-a)}{\\mu}\\right)\\right)}{s/\\Sigma_t} = 1 - \\exp\\left(-\\frac{\\Sigma_t (L-a)}{\\mu}\\right)\n$$\n\n将这些分量组合成所要求的行向量，即可得到最终答案。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 - \\exp\\left(-\\frac{\\Sigma_{t} a}{\\mu}\\right)  1 - \\exp\\left(-\\frac{\\Sigma_{t} (L-a)}{\\mu}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了数据交换的基本机制后，一个关键的实践步骤是量化其成本。在并行计算中，处理器之间的通信是限制可扩展性的主要开销来源。本练习要求你进行一次“信封背面”式的估算，以确定在一次完整的多群$S_N$并行输运扫描过程中，必须通信的总数据量。掌握这项技能对于性能建模至关重要，它能帮助你预测并行求解器在大型计算机上的行为，并识别潜在的通信瓶颈。",
            "id": "4222603",
            "problem": "考虑一个核反应堆堆芯的三维稳态输运模型，其中线性玻尔兹曼输运方程控制角通量$\\,\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, E)\\,$。该方程使用离散纵标法（离散纵标（$S_N$））在角度上进行离散，产生$\\,N_{\\Omega}\\,$个离散方向$\\,\\{\\boldsymbol{\\Omega}_{\\ell}\\}_{\\ell=1}^{N_{\\Omega}}\\,$，并使用多群能量离散化为$\\,G\\,$个能量群。空间离散采用一阶不连续方法，因此迎风扫描所需的界面（面）数据是每个面、每个方向、每个能量群的单个标量角通量值。为实现并行求解，计算域被划分为多个子域，在扫描过程中，数据必须在$\\,N_f\\,$个跨域界面上传输。\n\n一次输运扫描在每个跨域界面上强制执行迎风边界条件：对于给定的离散方向$\\,\\boldsymbol{\\Omega}_{\\ell}\\,$和能量群$\\,g\\,$，顺风侧需要来自迎风侧的出射角通量。假设：\n- 每个所需的界面数据是一个双精度浮点数（双精度），占用$\\,8\\,$字节。\n- 每个时间步执行一次完整的多群$S_N$扫描，遍历所有$\\,N_{\\Omega}\\,$个方向和所有$\\,G\\,$个能量群各一次。\n- 与有效载荷相比，消息头和其他协议开销可以忽略不计。\n\n计算在这次多群$S_N$扫描中，每个时间步内所有子域聚合的总跨域通信数据量。请用$\\,N_f\\,$, $\\,N_{\\Omega}\\,$和$\\,G\\,$表示你的最终答案，形式为一个闭式解析表达式，单位为字节。无需取整。",
            "solution": "该问题要求计算一次并行多群离散纵标（$S_N$）输运扫描中，每个时间步内在所有子域上聚合的总跨域通信数据量。这种通信是区域分解方法所必需的，在该方法中，数据必须在相邻子域的界面之间交换，以强制执行输运扫描的边界条件。\n\n输运模型中的基本变量是角通量$\\psi(\\mathbf{r}, \\boldsymbol{\\Omega}, E)$，它是位置$\\mathbf{r}$、粒子行进方向$\\boldsymbol{\\Omega}$和粒子能量$E$的函数。问题指明，控制性的线性玻尔兹曼输运方程按以下方式离散化：\n1. 连续的能量变量$E$被离散为$G$个离散的能量群。\n2. 连续的角度变量$\\boldsymbol{\\Omega}$使用离散纵标法进行离散，得到一组$N_{\\Omega}$个求积方向，即$\\{\\boldsymbol{\\Omega}_{\\ell}\\}_{\\ell=1}^{N_{\\Omega}}$。\n3. 空间域$\\mathbf{r}$被划分为多个子域以进行并行处理。这种划分在子域之间产生了$N_f$个内部界面，数据必须在这些界面上传输。\n\n一次输运扫描通过以迎风顺序遍历空间单元，求解单个离散方向$\\boldsymbol{\\Omega}_{\\ell}$和单个能量群$g$的离散化输运方程。为了使扫描从一个子域进行到相邻的顺风子域，共享界面上的角通量必须由迎风子域提供。\n\n问题指出，由于采用一阶空间离散，所需数据是每个面、每个方向、每个能量群的单个标量角通量值。总通信数据量是这些标量值的总数与每个标量内存大小的乘积。\n\n我们首先确定在一次完整的多群$S_N$扫描中通信的标量值总数$N_{scalars}$。一次完整扫描需要为每个离散方向和每个能量群执行一次扫描。数据传输按面、方向和群进行索引。\n- 发生通信的空间界面数量为$N_f$。\n- 一次完整的$S_N$扫描中考虑的离散方向数量为$N_{\\Omega}$。\n- 一次多群扫描中考虑的能量群数量为$G$。\n\n由于对于每个面、方向和能量群的组合，都传输一个标量值，因此标量总数是这些独立索引计数的乘积：\n$$N_{scalars} = N_f \\times N_{\\Omega} \\times G$$\n\n接下来，我们必须确定每个标量数据的大小。问题指明，每个所需的界面数据都是一个双精度浮点数。一个标准的双精度数在内存中占用$8$字节。设$S_{datum}$为这样一个数据的大小。\n$$S_{datum} = 8 \\, \\text{字节}$$\n\n总跨域通信数据量$V_{comm}$是标量总数与每个标量大小的乘积。问题指明协议开销可以忽略不计，因此我们只考虑数据有效载荷。\n$$V_{comm} = N_{scalars} \\times S_{datum}$$\n代入上面推导出的表达式：\n$$V_{comm} = (N_f N_{\\Omega} G) \\times 8$$\n\n按照惯例，将数值系数放在表达式的前面。总通信数据量（以字节为单位）的最终解析表达式为：\n$$V_{comm} = 8 N_f N_{\\Omega} G$$\n该表达式表示在一次完整的多群$S_N$扫描中，跨越所有$N_f$个跨域界面的所有通信事件所聚合的总数据有效载荷。",
            "answer": "$$\n\\boxed{8 N_f N_{\\Omega} G}\n$$"
        },
        {
            "introduction": "输运扫描在子区域之间引入了数据依赖性，这意味着并非所有计算任务都可以同时进行。高效的并行执行需要一个精心设计的调度方案来管理这些依赖关系。这个问题将一个强大的计算机科学概念——图着色——引入到输运求解的调度问题中。它展示了如何将任务间的依赖关系抽象为一个“冲突图”，其中图的着色方案对应于一个无冲突的并行调度。通过解决这个问题，你将学会如何确定并行扫描所需的最少顺序阶段数，这是优化高级输运求解器性能的一项关键技术。",
            "id": "4222597",
            "problem": "考虑一个反应堆堆芯中的稳态中子输运问题，该问题被分解为空间子域，以便使用离散纵标法（也称为球谐离散纵标近似，S$_N$）进行并行求解。角通量的控制方程是线性玻尔兹曼输运方程，$$\\boldsymbol{\\Omega}\\cdot \\nabla \\psi(\\mathbf{r},\\boldsymbol{\\Omega},E) + \\Sigma_t(\\mathbf{r},E)\\,\\psi(\\mathbf{r},\\boldsymbol{\\Omega},E) = \\int_{4\\pi}\\int_0^{\\infty} \\Sigma_s(\\mathbf{r},E'\\to E,\\boldsymbol{\\Omega}'\\cdot \\boldsymbol{\\Omega})\\,\\psi(\\mathbf{r},\\boldsymbol{\\Omega}',E')\\,\\mathrm{d}E'\\,\\mathrm{d}\\Omega' + S(\\mathbf{r},\\boldsymbol{\\Omega},E),$$ 其中 $\\psi$ 是角通量，$\\boldsymbol{\\Omega}$ 是方向，$E$ 是能量，$\\Sigma_t$ 是总宏观截面，$\\Sigma_s$ 是散射截面，$S$ 是外部源或裂变源。在采用区域分解的并行扫描中，角集和能块在各个子域上进行调度。当两个任务在扫描的同一阶段需要同时、互斥地访问相同的域间界面未知量或缓冲区时，就会出现竞争。一种防止竞争的方法是构建一个冲突图，其顶点表示任务（角集和能块的组合），其边表示成对的界面竞争。该图的正常顶点着色为每个任务分配一种颜色，使得相邻顶点（冲突任务）具有不同的颜色；颜色相同的任务可以无竞争地并发执行。所需的最小颜色数是色数，它决定了无竞争地执行所有任务所需的最少顺序阶段数。\n\n给定一个用于特定并行输运求解的冲突图 $G=(V,E)$，其中包含 $|V|=9$ 个任务。顶点集为 $$V=\\{v_1,v_2,v_3,v_4,v_5,v_6,v_7,v_8,v_9\\}.$$ 边集 $E$ 由以下邻接关系指定：\n- $\\{v_1,v_2,v_3,v_4\\}$ 上的子图是完全图：边为 $\\{(v_1,v_2),(v_1,v_3),(v_1,v_4),(v_2,v_3),(v_2,v_4),(v_3,v_4)\\}$。\n- 额外的边：$(v_5,v_1)$、$(v_5,v_2)$、$(v_5,v_3)$、$(v_6,v_2)$、$(v_6,v_3)$、$(v_6,v_4)$、$(v_7,v_1)$、$(v_7,v_4)$、$(v_8,v_5)$、$(v_8,v_6)$、$(v_8,v_7)$、$(v_9,v_3)$、$(v_9,v_7)$、$(v_9,v_8)$。\n\n请解释在该区域分解的输运背景下，图着色如何为角集和能块制定无竞争的调度方案，从输运方程和由上风向数据需求引起的界面依赖性概念开始。然后，计算为图 $G$ 着色所需的最小颜色数。以单个整数值的形式提供最终答案。无需四舍五入，也无需单位。",
            "solution": "问题要求做两件事：首先，解释在并行输运求解的背景下，图着色如何帮助制定无竞争的调度方案；其次，计算给定冲突图的色数。\n\n首先，我们来解释概念部分。控制方程是稳态线性玻尔兹曼输运方程：\n$$ \\boldsymbol{\\Omega}\\cdot \\nabla \\psi(\\mathbf{r},\\boldsymbol{\\Omega},E) + \\Sigma_t(\\mathbf{r},E)\\,\\psi(\\mathbf{r},\\boldsymbol{\\Omega},E) = \\int_{4\\pi}\\int_0^{\\infty} \\Sigma_s(\\mathbf{r},E'\\to E,\\boldsymbol{\\Omega}'\\cdot \\boldsymbol{\\Omega})\\,\\psi(\\mathbf{r},\\boldsymbol{\\Omega}',E')\\,\\mathrm{d}E'\\,\\mathrm{d}\\Omega' + S(\\mathbf{r},\\boldsymbol{\\Omega},E) $$\n项 $\\boldsymbol{\\Omega}\\cdot \\nabla \\psi$ 表示粒子（在此情况下为中子）在方向 $\\boldsymbol{\\Omega}$ 上的流。这使得方程沿任何给定方向都具有双曲特性。诸如离散纵标（$S_N$）法等数值解法利用了这一特性，将角变量离散化为一组有限的方向 $\\{\\boldsymbol{\\Omega}_m\\}$，并在一次“输运扫描”中求解每个方向的方程。在对方向 $\\boldsymbol{\\Omega}_m$ 进行扫描时，空间点 $\\mathbf{r}$ 处角通量 $\\psi_m(\\mathbf{r},E)$ 的解取决于上风向位置的通量值。\n\n在并行计算环境中，空间域被划分为多个子域 $\\{D_i\\}$，每个子域分配给一个处理单元。为了在子域 $D_i$ 上对给定方向执行输运扫描，处理器需要该子域上风向边界上的入射角通量。这些边界通量值正是相邻上风向子域的出射通量。这就产生了一种数据依赖：子域 $D_i$ 上的计算必须等到其上风向邻域的计算完成并提供了必要的边界数据后才能开始。\n\n一个“任务”被定义为一个计算工作单元，例如在特定子域上对一组特定的角和能群执行扫描。当两个或多个计划并发运行的任务需要以冲突的方式同时访问共享资源时，就会出现竞争。在这种情况下，共享资源是存储子域间界面上角通量数据的内存缓冲区。例如，如果任务A需要将其出射通量写入一个接口缓冲区，而任务B同时需要从该缓冲区读取其入射通量，那么如果没有确保正确数据传递的机制，这些任务就无法并行运行。\n\n为了管理这些依赖关系并防止竞争，我们构建了一个冲突图 $G=(V,E)$。\n1.  每个顶点 $v \\in V$ 代表一个需要调度的任务。\n2.  如果两个对应的任务 $v_i$ 和 $v_j$ 存在冲突，则在它们的顶点之间添加一条边 $(v_i, v_j) \\in E$。冲突意味着它们对同一界面数据存在依赖，从而妨碍了并发执行。\n\n冲突图的正常顶点着色为每个顶点分配一个“颜色”（通常是一个整数），使得没有两个相邻顶点共享相同的颜色。在调度背景下，每种颜色代表一个独立的计算阶段或时间步。\n- 所有被赋予相同颜色的任务（顶点）都是相互不冲突的。因此，它们可以在一个单一的并行阶段中并发执行。\n- 如果任务之间由边连接，那么颜色不同的任务必须在不同的阶段执行。\n\n总体目标是在最少的顺序阶段内完成所有任务。这等同于使用最少数量的颜色为冲突图 $G$ 找到一个正常顶点着色。这个最小数量是图的一个基本不变量，称为其色数，记为 $\\chi(G)$。因此，计算 $\\chi(G)$ 就能确定无竞争并行调度所需的最小阶段数。\n\n接下来，我们计算所提供特定图的色数 $\\chi(G)$。图 $G$ 的顶点集为 $V=\\{v_1,v_2,v_3,v_4,v_5,v_6,v_7,v_8,v_9\\}$。\n\n色数的一个下界是图 $G$ 中最大团（一个全连接子图）的大小，记为 $\\omega(G)$。我们知道 $\\chi(G) \\ge \\omega(G)$。问题陈述，在 $\\{v_1, v_2, v_3, v_4\\}$ 上的子图是完全图。这个子图是一个大小为4的团，称为 $K_4$。因此，我们有 $\\omega(G) \\ge 4$，这意味着 $\\chi(G) \\ge 4$。仅为这个团的顶点着色就需要至少4种不同的颜色。\n\n现在我们必须确定是否可能对整个图进行4-着色。如果我们能找到一个只使用4种颜色的有效着色方案，就将证明 $\\chi(G) \\le 4$。结合下界，这将证明 $\\chi(G)=4$。\n\n设颜色集为 $\\{C_1, C_2, C_3, C_4\\}$。\n1.  我们首先为 $K_4$ 团的顶点着色，这需要4种独特的颜色：\n    - 着色$(v_1) = C_1$\n    - 着色$(v_2) = C_2$\n    - 着色$(v_3) = C_3$\n    - 着色$(v_4) = C_4$\n\n2.  我们继续使用贪心算法为其余顶点着色。\n    - **顶点 $v_5$**：邻接点为 $(v_5,v_1)$、$(v_5,v_2)$、$(v_5,v_3)$。其邻居的颜色为 $\\{C_1, C_2, C_3\\}$。颜色 $C_4$ 可用。\n      - 着色$(v_5) = C_4$\n    - **顶点 $v_6$**：邻接点为 $(v_6,v_2)$、$(v_6,v_3)$、$(v_6,v_4)$。其邻居的颜色为 $\\{C_2, C_3, C_4\\}$。颜色 $C_1$ 可用。\n      - 着色$(v_6) = C_1$\n    - **顶点 $v_7$**：邻接点为 $(v_7,v_1)$、$(v_7,v_4)$。其邻居的颜色为 $\\{C_1, C_4\\}$。颜色 $C_2$ 和 $C_3$ 可用。我们可以任选其一；我们指定为 $C_2$。\n      - 着色$(v_7) = C_2$\n    - **顶点 $v_8$**：邻接点为 $(v_8,v_5)$、$(v_8,v_6)$、$(v_8,v_7)$。根据我们之前的分配，其邻居的颜色为 $\\{$着色$(v_5)=C_4$, 着色$(v_6)=C_1$, 着色$(v_7)=C_2\\}$。颜色 $C_3$ 可用。\n      - 着色$(v_8) = C_3$\n    - **顶点 $v_9$**：邻接点为 $(v_9,v_3)$、$(v_9,v_7)$、$(v_9,v_8)$。其邻居的颜色为 $\\{$着色$(v_3)=C_3$, 着色$(v_7)=C_2$, 着色$(v_8)=C_3\\}$。禁用的颜色集为 $\\{C_2, C_3\\}$。颜色 $C_1$ 和 $C_4$ 可用。我们指定为 $C_1$。\n      - 着色$(v_9) = C_1$\n\n我们已经成功地为所有顶点构建了一个有效的4-着色方案：\n- **颜色 $C_1$ (阶段 1):** 任务 $\\{v_1, v_6, v_9\\}$ 可以并发运行。\n- **颜色 $C_2$ (阶段 2):** 任务 $\\{v_2, v_7\\}$ 可以并发运行。\n- **颜色 $C_3$ (阶段 3):** 任务 $\\{v_3, v_8\\}$ 可以并发运行。\n- **颜色 $C_4$ (阶段 4):** 任务 $\\{v_4, v_5\\}$ 可以并发运行。\n\n由于存在一个4-着色方案，我们证明了 $\\chi(G) \\le 4$。\n结合我们的发现，我们有 $4 \\le \\chi(G) \\le 4$。因此，图 $G$ 的色数恰好为 $4$。这是所需的最小颜色数，并对应于并行输运求解所需的最少顺序阶段数。",
            "answer": "$$\n\\boxed{4}\n$$"
        }
    ]
}