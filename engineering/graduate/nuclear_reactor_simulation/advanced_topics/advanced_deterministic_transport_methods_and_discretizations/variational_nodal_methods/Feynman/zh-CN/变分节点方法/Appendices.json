{
    "hands_on_practices": [
        {
            "introduction": "在变分节点法中，计算节点内部详细的中子通量分布是通过多项式展开来近似的。本练习将通过一个具体计算，帮助您掌握如何确定这种展开式的系数。通过将抽象的多项式系数与诸如平均通量和横向泄漏等物理量联系起来，您将对单个节点的状态是如何通过数学方式构建的获得基础性理解。",
            "id": "4260107",
            "problem": "考虑在二维(2D)单能群(1G)中子扩散模型中的一个均匀矩形节点，该模型用于变分节点法(VNM)。令局部（无量纲）空间坐标为 $x \\in [-1,1]$ 和 $y \\in [-1,1]$。在该节点内，将标量通量 $\\phi(x,y)$ 通过二次 Legendre 多项式展开近似为以下不含交叉项的可分离基：\n$$\n\\phi(x,y) = a_{00} P_{0}(x)P_{0}(y) + a_{10} P_{1}(x)P_{0}(y) + a_{01} P_{0}(x)P_{1}(y) + a_{20} P_{2}(x)P_{0}(y) + a_{02} P_{0}(x)P_{2}(y),\n$$\n其中 $P_{0}(z) = 1$、$P_{1}(z) = z$ 和 $P_{2}(z) = \\frac{3z^{2} - 1}{2}$ 是在 $[-1,1]$ 上的前三个 Legendre 多项式，而 $a_{00}$、$a_{10}$、$a_{01}$、$a_{20}$、$a_{02}$ 是待确定的常数系数。\n\n将网格平均通量定义为\n$$\n\\bar{\\phi} = \\frac{1}{4} \\int_{-1}^{1}\\int_{-1}^{1} \\phi(x,y)\\,dx\\,dy,\n$$\n将面平均通量定义为\n$$\n\\bar{\\phi}_{x\\pm} = \\frac{1}{2} \\int_{-1}^{1} \\phi(\\pm 1, y)\\,dy, \\qquad \\bar{\\phi}_{y\\pm} = \\frac{1}{2} \\int_{-1}^{1} \\phi(x, \\pm 1)\\,dx.\n$$\n\n在 VNM 横向积分一维方程中，横向泄漏函数定义为\n$$\nL_{x}(y) = -D \\,\\frac{1}{2}\\int_{-1}^{1} \\frac{\\partial^{2}\\phi(x,y)}{\\partial y^{2}}\\,dx, \\qquad\nL_{y}(x) = -D \\,\\frac{1}{2}\\int_{-1}^{1} \\frac{\\partial^{2}\\phi(x,y)}{\\partial x^{2}}\\,dy,\n$$\n其中 $D$ 是扩散系数。在该节点中，令 $D = 1$，并假设横向泄漏函数被指定为空间常数，且等于\n$$\nL_{x}(y) = -0.9, \\qquad L_{y}(x) = -0.6.\n$$\n\n给定以下通量矩数据：\n- 网格平均通量：$\\bar{\\phi} = 1.10$。\n- 面平均通量：$\\bar{\\phi}_{x+} = 1.45$，$\\bar{\\phi}_{x-} = 1.15$，$\\bar{\\phi}_{y+} = 1.45$，$\\bar{\\phi}_{y-} = 1.35$。\n\n从上述定义和 Legendre 多项式的性质出发，计算系数 $a_{00}$、$a_{10}$、$a_{01}$、$a_{20}$ 和 $a_{02}$，使得二次 Legendre 展开能够精确地再现给定的网格平均通量、面平均通量和指定的横向泄漏函数。将最终答案表示为包含五个系数的单行矩阵，顺序为 $(a_{00}, a_{10}, a_{01}, a_{20}, a_{02})$。请使用精确值，无需四舍五入。",
            "solution": "用户希望在二维节点法的背景下，求解中子通量的二次 Legendre 多项式展开的系数。该问题被认为是有效的，因为它在核反应堆物理学方面有科学依据，问题设定良好，数据一致且完整，并使用了客观、正式的语言。所提供的数据能够为所求系数得出唯一解。\n\n给定单个均匀节点内的通量展开式：\n$$\n\\phi(x,y) = a_{00} P_{0}(x)P_{0}(y) + a_{10} P_{1}(x)P_{0}(y) + a_{01} P_{0}(x)P_{1}(y) + a_{20} P_{2}(x)P_{0}(y) + a_{02} P_{0}(x)P_{2}(y)\n$$\n其中 Legendre 多项式为 $P_{0}(z) = 1$、$P_{1}(z) = z$ 和 $P_{2}(z) = \\frac{3z^{2} - 1}{2}$。我们的目标是利用所提供的数据来确定系数 $a_{00}$、$a_{10}$、$a_{01}$、$a_{20}$ 和 $a_{02}$。\n\n首先，我们在给定的物理量（网格平均通量、面平均通量和横向泄漏）与未知系数之间建立关系。我们将利用 Legendre 多项式的正交性，特别是积分 $\\int_{-1}^{1} P_n(z) dz = \\int_{-1}^{1} P_n(z) P_0(z) dz = 2 \\delta_{n0}$，其中 $\\delta_{n0}$ 是 Kronecker delta 符号。\n\n1.  **网格平均通量 $\\bar{\\phi}$**\n    网格平均通量定义为：\n    $$\n    \\bar{\\phi} = \\frac{1}{4} \\int_{-1}^{1}\\int_{-1}^{1} \\phi(x,y)\\,dx\\,dy\n    $$\n    代入 $\\phi(x,y)$ 的展开式并逐项积分：\n    $$\n    \\bar{\\phi} = \\frac{1}{4} \\sum_{i,j} a_{ij} \\int_{-1}^{1} P_i(x) dx \\int_{-1}^{1} P_j(y) dy\n    $$\n    其中求和遍及数对 $(i,j) \\in \\{(0,0), (1,0), (0,1), (2,0), (0,2)\\}$。仅当 $i=0$ 和 $j=0$ 时积分不为零。因此，只有 $a_{00}$ 项被保留。\n    $$\n    \\bar{\\phi} = \\frac{1}{4} a_{00} \\left(\\int_{-1}^{1} P_0(x)dx\\right) \\left(\\int_{-1}^{1} P_0(y)dy\\right) = \\frac{1}{4} a_{00} (2)(2) = a_{00}\n    $$\n    已知 $\\bar{\\phi} = 1.10$，我们得到第一个系数：\n    $$\n    a_{00} = 1.10\n    $$\n\n2.  **面平均通量 $\\bar{\\phi}_{x\\pm}$**\n    在 $x = \\pm 1$ 面上的面平均通量为：\n    $$\n    \\bar{\\phi}_{x\\pm} = \\frac{1}{2} \\int_{-1}^{1} \\phi(\\pm 1, y)\\,dy\n    $$\n    我们使用 $P_0(\\pm 1)=1$、$P_1(\\pm 1)=\\pm 1$ 和 $P_2(\\pm 1)=1$ 来计算 $\\phi(\\pm 1, y)$：\n    $$\n    \\phi(\\pm 1, y) = a_{00}P_0(y) \\pm a_{10}P_0(y) + a_{01}P_1(y) + a_{20}P_0(y) + a_{02}P_2(y)\n    $$\n    $$\n    \\phi(\\pm 1, y) = (a_{00} \\pm a_{10} + a_{20})P_0(y) + a_{01}P_1(y) + a_{02}P_2(y)\n    $$\n    在 $y \\in [-1,1]$ 上积分会使含有 $P_1(y)$ 和 $P_2(y)$ 的项消失：\n    $$\n    \\bar{\\phi}_{x\\pm} = \\frac{1}{2} (a_{00} \\pm a_{10} + a_{20}) \\int_{-1}^{1} P_0(y) dy = \\frac{1}{2} (a_{00} \\pm a_{10} + a_{20}) (2) = a_{00} \\pm a_{10} + a_{20}\n    $$\n    这得到一个包含两个方程的方程组：\n    $$\n    \\bar{\\phi}_{x+} = a_{00} + a_{10} + a_{20} = 1.45\n    $$\n    $$\n    \\bar{\\phi}_{x-} = a_{00} - a_{10} + a_{20} = 1.15\n    $$\n\n3.  **面平均通量 $\\bar{\\phi}_{y\\pm}$**\n    根据对称性，对于 $y = \\pm 1$ 处的面：\n    $$\n    \\bar{\\phi}_{y\\pm} = a_{00} \\pm a_{01} + a_{02}\n    $$\n    这得到另一个包含两个方程的方程组：\n    $$\n    \\bar{\\phi}_{y+} = a_{00} + a_{01} + a_{02} = 1.45\n    $$\n    $$\n    \\bar{\\phi}_{y-} = a_{00} - a_{01} + a_{02} = 1.35\n    $$\n\n4.  **横向泄漏 $L_x(y)$ 和 $L_y(x)$**\n    $y$ 方向的横向泄漏为：\n    $$\n    L_y(x) = -D \\frac{1}{2} \\int_{-1}^{1} \\frac{\\partial^2\\phi(x,y)}{\\partial x^2} dy\n    $$\n    首先，我们求 $\\phi$ 关于 $x$ 的二阶导数。注意到 $P_0''(x) = 0$，$P_1''(x)=0$，以及 $P_2''(x) = \\frac{d^2}{dx^2}(\\frac{3x^2-1}{2}) = 3$。\n    $$\n    \\frac{\\partial^2\\phi}{\\partial x^2} = a_{20} P_2''(x) P_0(y) = 3 a_{20} P_0(y)\n    $$\n    将此代入泄漏的定义中：\n    $$\n    L_y(x) = -D \\frac{1}{2} \\int_{-1}^{1} 3 a_{20} P_0(y) dy = -D \\frac{3 a_{20}}{2} (2) = -3 D a_{20}\n    $$\n    已知 $D=1$ 且 $L_y(x) = -0.6$，我们可以求出 $a_{20}$：\n    $$\n    -0.6 = -3(1)a_{20} \\implies a_{20} = \\frac{0.6}{3} = 0.2\n    $$\n    根据对称性，$x$ 方向的横向泄漏为：\n    $$\n    L_x(y) = -3 D a_{02}\n    $$\n    已知 $L_x(y) = -0.9$，我们求出 $a_{02}$：\n    $$\n    -0.9 = -3(1)a_{02} \\implies a_{02} = \\frac{0.9}{3} = 0.3\n    $$\n\n现在我们已经确定了 $a_{00} = 1.10$、$a_{20} = 0.2$ 和 $a_{02} = 0.3$。我们可以用这些值来求 $a_{10}$ 和 $a_{01}$。\n\n从 $\\bar{\\phi}_{x\\pm}$ 的方程组中，将第二个方程从第一个方程中减去，得到：\n$$\n\\bar{\\phi}_{x+} - \\bar{\\phi}_{x-} = (a_{00} + a_{10} + a_{20}) - (a_{00} - a_{10} + a_{20}) = 2 a_{10}\n$$\n$$\na_{10} = \\frac{\\bar{\\phi}_{x+} - \\bar{\\phi}_{x-}}{2} = \\frac{1.45 - 1.15}{2} = \\frac{0.30}{2} = 0.15\n$$\n\n从 $\\bar{\\phi}_{y\\pm}$ 的方程组中，类似的相减操作得到：\n$$\n\\bar{\\phi}_{y+} - \\bar{\\phi}_{y-} = (a_{00} + a_{01} + a_{02}) - (a_{00} - a_{01} + a_{02}) = 2 a_{01}\n$$\n$$\na_{01} = \\frac{\\bar{\\phi}_{y+} - \\bar{\\phi}_{y-}}{2} = \\frac{1.45 - 1.35}{2} = \\frac{0.10}{2} = 0.05\n$$\n\n因此，这五个系数是：\n$a_{00} = 1.10$\n$a_{10} = 0.15$\n$a_{01} = 0.05$\n$a_{20} = 0.2$\n$a_{02} = 0.3$\n\n最终答案是按规定排列成行矩阵的这些系数的集合。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.1 & 0.15 & 0.05 & 0.2 & 0.3 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在描述了单个节点内的通量之后，下一个关键步骤是如何将相邻节点一致地耦合起来，以模拟整个反应堆堆芯。本练习通过分流（partial currents）的概念来探索节点间的耦合，分流描述了中子在节点界面上的流入和流出。通过计算一个节点的净泄漏并验证共享界面上的中子守恒原理，您将巩固对局部平衡方程如何连接形成全局物理守恒解的理解。",
            "id": "4260120",
            "problem": "考虑一个用于核反应堆模拟中变分节点法 (Variational Nodal Method, VNM) 的笛卡尔离散化的单能群、稳态中子输运模型。设一个节点是一个单位厚度的长方体，其四个侧面的面积相等。对于每个面，定义向外的单位法向量 $\\mathbf{n}_f$ 指向节点外部，并定义面平均半程（部分）流\n$$\nj^{+}_{f} \\equiv \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f > 0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A, \\quad\nj^{-}_{f} \\equiv \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} |\\mathbf{\\Omega}\\cdot\\mathbf{n}_f|\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A,\n$$\n其中 $\\psi(\\mathbf{r},\\mathbf{\\Omega})$ 是角中子通量，$A_f$ 是面面积，$\\mathbf{\\Omega}$ 是方向单位向量。\n\n给定两个相邻节点 $\\mathcal{N}_1$ 和 $\\mathcal{N}_2$，它们共享一个垂直面。每个侧面的面积为 $A_f = 100$（平方厘米），节点厚度为 $1$（厘米），因此穿过节点 $\\mathcal{N}_i$ 的面 $f$ 的面积分净流为 $A_f\\left(j^{+}_{i,f} - j^{-}_{i,f}\\right)$，单位为中子/秒。对于节点 $\\mathcal{N}_1$，面平均部分流（单位为中子/平方厘米·秒）指定如下：\n$$\nj^{+}_{1,W} = 1.80, \\quad j^{-}_{1,W} = 2.10, \\quad\nj^{+}_{1,E} = 4.20, \\quad j^{-}_{1,E} = 5.00,\n$$\n$$\nj^{+}_{1,N} = 3.50, \\quad j^{-}_{1,N} = 3.40, \\quad\nj^{+}_{1,S} = 2.75, \\quad j^{-}_{1,S} = 2.55.\n$$\n共享面是 $\\mathcal{N}_1$ 的东面和 $\\mathcal{N}_2$ 的西面。根据界面耦合和一致的方向性，从 $\\mathcal{N}_1$ 穿过共享面的出射部分流等于进入 $\\mathcal{N}_2$ 的入射部分流，反之亦然：\n$$\nj^{+}_{1,E} = j^{-}_{2,W}, \\qquad j^{-}_{1,E} = j^{+}_{2,W}.\n$$\n\n从稳态中子平衡和散度定理出发，推导节点 $\\mathcal{N}_1$ 的净泄漏 $L_1$ 关于其面平均部分流和面积的表达式，然后使用给定数据计算 $L_1$。接下来，通过计算界面守恒残差\n$$\nR \\equiv A_f\\Big[\\big(j^{+}_{1,E} - j^{-}_{1,E}\\big) + \\big(j^{+}_{2,W} - j^{-}_{2,W}\\big)\\Big]\n$$\n来验证共享界面上的全局守恒，其中使用上述耦合等式。\n\n将 $L_1$ 和 $R$ 均以中子/秒为单位表示。最终答案必须是写成单行矩阵形式的有序对 $\\big(L_1,\\,R\\big)$。无需四舍五入。",
            "solution": "该问题经验证是自洽的、有科学依据且定义明确的。为单能群、稳态中子输运模型提供了所有必要的数据和定义。部分流、净泄漏和界面耦合的概念是核反应堆分析中节点法的标准概念。\n\n首先，我们推导节点 $\\mathcal{N}_1$ 的净泄漏 $L_1$ 的表达式。净泄漏定义为单位时间内流出节点体积的中子总数。这由净流矢量 $\\mathbf{J}(\\mathbf{r})$ 在节点整个表面 $\\partial V_1$ 上的积分给出。\n$$\nL_1 = \\oint_{\\partial V_1} \\mathbf{J}(\\mathbf{r}) \\cdot \\mathbf{n} \\, \\mathrm{d}A\n$$\n其中 $\\mathbf{n}$ 是表面元 $\\mathrm{d}A$ 上的向外单位法向量。净流矢量定义为方向矢量 $\\mathbf{\\Omega}$ 由角通量 $\\psi(\\mathbf{r}, \\mathbf{\\Omega})$ 加权的角积分：\n$$\n\\mathbf{J}(\\mathbf{r}) = \\int_{4\\pi} \\mathbf{\\Omega} \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\, \\mathrm{d}\\Omega\n$$\n表面积分可以表示为节点各面上的总和。对于单能群、二维笛卡尔模型，我们考虑四个侧面：东 (E)、西 (W)、北 (N) 和南 (S)。\n$$\nL_1 = \\sum_{f \\in \\{E,W,N,S\\}} \\int_{A_f} \\mathbf{J}(\\mathbf{r}) \\cdot \\mathbf{n}_f \\, \\mathrm{d}A\n$$\n其中 $\\mathbf{n}_f$ 是面 $f$ 的向外法向量。项 $\\int_{A_f} \\mathbf{J}(\\mathbf{r}) \\cdot \\mathbf{n}_f \\, \\mathrm{d}A$ 是穿过面 $f$ 的面积分净流。让我们将其与给定的面平均部分流 $j^{+}_{f}$ 和 $j^{-}_{f}$ 联系起来。\n\n面 $f$ 的面平均净流由下式给出：\n$$\n\\bar{J}_f = \\frac{1}{A_f} \\int_{A_f} \\left( \\int_{4\\pi} \\mathbf{\\Omega} \\cdot \\mathbf{n}_f \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\, \\mathrm{d}\\Omega \\right) \\mathrm{d}A\n$$\n我们可以将角积分分解到两个半球上：一个是中子向外运动 ($\\mathbf{\\Omega} \\cdot \\mathbf{n}_f  0$)，另一个是中子向内运动 ($\\mathbf{\\Omega} \\cdot \\mathbf{n}_f  0$)。\n$$\n\\bar{J}_f = \\frac{1}{A_f} \\int_{A_f} \\left( \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega + \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega \\right) \\mathrm{d}A\n$$\n根据定义，第一项是面平均出射部分流 $j^{+}_{f}$：\n$$\nj^{+}_{f} = \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A\n$$\n第二项可以与面平均入射部分流 $j^{-}_{f}$ 相关联。给定的定义是：\n$$\nj^{-}_{f} = \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} |\\mathbf{\\Omega}\\cdot\\mathbf{n}_f|\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A\n$$\n对于内向半球，其中 $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0$，我们有 $|\\mathbf{\\Omega}\\cdot\\mathbf{n}_f| = -(\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)$。因此：\n$$\nj^{-}_{f} = \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} -(\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega\\,\\mathrm{d}A = -\\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega\\,\\mathrm{d}A\n$$\n因此，$\\bar{J}_f$ 表达式中的第二项等于 $-j^{-}_{f}$。面平均净流为：\n$$\n\\bar{J}_f = j^{+}_{f} - j^{-}_{f}\n$$\n穿过面 $f$ 的面积分净流是 $A_f \\bar{J}_f = A_f(j^{+}_{f} - j^{-}_{f})$。总净泄漏 $L_1$ 是这些量在节点 $\\mathcal{N}_1$ 所有四个面上的总和：\n$$\nL_1 = A_f(j^{+}_{1,E} - j^{-}_{1,E}) + A_f(j^{+}_{1,W} - j^{-}_{1,W}) + A_f(j^{+}_{1,N} - j^{-}_{1,N}) + A_f(j^{+}_{1,S} - j^{-}_{1,S})\n$$\n这就是所要求的表达式。现在我们使用节点 $\\mathcal{N}_1$ 的给定数据计算其值：$A_f = 100$ cm$^2$，部分流的单位是 中子/(cm$^2 \\cdot$s)。\n\n每个面的贡献：\n- 东面：$j^{+}_{1,E} - j^{-}_{1,E} = 4.20 - 5.00 = -0.80$\n- 西面：$j^{+}_{1,W} - j^{-}_{1,W} = 1.80 - 2.10 = -0.30$\n- 北面：$j^{+}_{1,N} - j^{-}_{1,N} = 3.50 - 3.40 = 0.10$\n- 南面：$j^{+}_{1,S} - j^{-}_{1,S} = 2.75 - 2.55 = 0.20$\n\n将面平均净流求和：\n$$\n\\sum_f (j^{+}_{1,f} - j^{-}_{1,f}) = (-0.80) + (-0.30) + (0.10) + (0.20) = -0.80\n$$\n现在，我们计算总净泄漏 $L_1$：\n$$\nL_1 = A_f \\sum_f (j^{+}_{1,f} - j^{-}_{1,f}) = 100 \\times (-0.80) = -80\n$$\n单位是 (cm$^2$) $\\times$ (中子/(cm$^2 \\cdot$s)) = 中子/s。负值表示中子净流入该节点。\n\n接下来，我们计算界面守恒残差 $R$。定义是：\n$$\nR \\equiv A_f\\Big[\\big(j^{+}_{1,E} - j^{-}_{1,E}\\big) + \\big(j^{+}_{2,W} - j^{-}_{2,W}\\big)\\Big]\n$$\n这个量表示共享界面两侧的面积分净流之和。项 $(j^{+}_{1,E} - j^{-}_{1,E})$ 是流出节点 $\\mathcal{N}_1$ 东面的净流。项 $(j^{+}_{2,W} - j^{-}_{2,W})$ 是流出节点 $\\mathcal{N}_2$ 西面的净流。根据守恒定律，穿过界面的净流必须是连续的，意味着流出 $\\mathcal{N}_1$ 的流量应等于流入 $\\mathcal{N}_2$ 的流量。由于向外的法向量相反 ($\\mathbf{n}_{1,E} = -\\mathbf{n}_{2,W}$)，两侧向外流动的净流之和应为零。\n\n问题提供了强制这种连续性的界面耦合等式：\n$$\nj^{+}_{1,E} = j^{-}_{2,W}\n$$\n$$\nj^{-}_{1,E} = j^{+}_{2,W}\n$$\n我们将这些代入 R 的表达式中：\n$$\nR = A_f\\Big[\\big(j^{+}_{1,E} - j^{-}_{1,E}\\big) + \\big(j^{-}_{1,E} - j^{+}_{1,E}\\big)\\Big]\n$$\n重新排列括号内的项：\n$$\nR = A_f\\Big[(j^{+}_{1,E} - j^{+}_{1,E}) + (-j^{-}_{1,E} + j^{-}_{1,E})\\Big] = A_f\\Big[0 + 0\\Big] = 0\n$$\n残差恒等于零，这证实了问题的表述确保了节点界面上的全局中子守恒。由于耦合条件的结构决定了 R 为零，因此计算 R 不需要 $\\mathcal{N}_1$ 东面流的数值。\n\n最终答案是有序对 $(L_1, R)$。\n$$\nL_1 = -80 \\text{ 中子/s}\n$$\n$$\nR = 0 \\text{ 中子/s}\n$$\n有序对是 $(-80, 0)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-80  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "变分节点法的一个核心优势在于其能够通过横向积分（transverse integration）过程，将复杂的多维问题简化为一组耦合的一维方程。该过程引入了一个关键的“横向泄漏”项，用以解释中子在其他维度上的流动。这个编程练习将指导您通过对边界上的中子流数据进行多项式拟合，从而以一种实用的计算方法来近似这个泄漏项，阐明了在VNM框架下不同空间维度之间是如何相互关联的。",
            "id": "4260085",
            "problem": "在变分节点法 (VNM) 框架下，考虑一个二维中子扩散问题中的单个均匀化矩形节点。设该节点沿 $x$ 轴的宽度为 $H_x$ ($\\mathrm{cm}$)，沿 $y$ 轴的高度为 $H_y$ ($\\mathrm{cm}$)。当分离变量以形成沿 $x$ 轴的一维节点平衡方程时，横向泄漏项（对横向坐标 $y$ 平均后）在节点上被建模为关于 $x$ 的二次多项式：\n$$\n\\bar{L}(x) \\approx c_0 + c_1 x + c_2 x^2.\n$$\n此处，$\\bar{L}(x)$ 表示在节点内轴向位置 $x$ 处，沿 $y$ 方向的横向流散度的 $y$ 平均值。假设在稳态下，中子流满足菲克定律 (Fick’s Law) 且质量守恒，因此散度定理以其标准形式适用。对于任意固定的 $x$， $y$ 平均的横向泄漏可以完全用底部和顶部界面上已知的横向面法向流 $J_{\\text{bottom}}(x)$ 和 $J_{\\text{top}}(x)$（单位为 $\\mathrm{n}/(\\mathrm{cm}^2\\cdot \\mathrm{s})$）来表示，即\n$$\n\\bar{L}(x) = \\frac{J_{\\text{bottom}}(x) - J_{\\text{top}}(x)}{H_y}.\n$$\n给定节点内多个 $x$ 位置的离散样本 $\\{(x_i, J_{\\text{top}}(x_i), J_{\\text{bottom}}(x_i))\\}_{i=1}^N$。您的任务是计算二次多项式系数 $\\{c_0,c_1,c_2\\}$ 的最小二乘拟合，使得在给定的样本点上，$\\bar{L}(x_i)$ 与 $c_0 + c_1 x_i + c_2 x_i^2$ 之间的残差平方和最小。\n\n仅从质量守恒和散度定理出发，结合以横向面法向流定义的 $y$ 平均横向泄漏的定义，推导最小二乘拟合公式并编写一个程序，该程序能：\n- 为每个给定样本计算 $\\bar{L}(x_i) = \\big(J_{\\text{bottom}}(x_i) - J_{\\text{top}}(x_i)\\big)/H_y$。\n- 构建并求解二次最小二乘拟合的正规方程，或使用等效的数值稳定方法，以确定 $\\{c_0,c_1,c_2\\}$。\n- 输出四舍五入到六位小数的系数。\n\n单位：\n- $H_x$ 和 $H_y$ 的单位是 $\\mathrm{cm}$。\n- $J_{\\text{top}}(x)$ 和 $J_{\\text{bottom}}(x)$ 的单位是 $\\mathrm{n}/(\\mathrm{cm}^2\\cdot \\mathrm{s})$。\n- $\\bar{L}(x)$ 和 $c_0$ 的单位是 $\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s})$。\n- $c_1$ 的单位是 $\\mathrm{n}/(\\mathrm{cm}^4\\cdot \\mathrm{s})$，$c_2$ 的单位是 $\\mathrm{n}/(\\mathrm{cm}^5\\cdot \\mathrm{s})$。\n- 此处不涉及任何角度。\n\n测试套件：\n编写程序以解决以下三个独立的测试用例。每个用例都提供了 $H_x$、$H_y$、样本位置 $\\{x_i\\}$ (单位 $\\mathrm{cm}$)，以及顶部和底部界面对应的面法向流 (单位 $\\mathrm{n}/(\\mathrm{cm}^2\\cdot \\mathrm{s})$)。\n\n- 测试用例 1（一般二次“理想路径”）：\n  - $H_x = 100.0$, $H_y = 50.0$.\n  - $x$-样本： $[\\,0.0,\\,25.0,\\,50.0,\\,75.0,\\,100.0\\,]$.\n  - 在这些 $x$ 值处的 $J_{\\text{top}}(x)$： $[\\,10.0,\\,22.5,\\,35.0,\\,47.5,\\,60.0\\,]$.\n  - 在这些 $x$ 值处的 $J_{\\text{bottom}}(x)$： $[\\,110.0,\\,113.125,\\,122.5,\\,138.125,\\,160.0\\,]$.\n\n- 测试用例 2（作为二次特例的线性泄漏）：\n  - $H_x = 60.0$, $H_y = 30.0$.\n  - $x$-样本： $[\\,0.0,\\,20.0,\\,40.0,\\,60.0\\,]$.\n  - 在这些 $x$ 值处的 $J_{\\text{top}}(x)$： $[\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$.\n  - 在这些 $x$ 值处的 $J_{\\text{bottom}}(x)$： $[\\,45.0,\\,57.0,\\,69.0,\\,81.0\\,]$.\n\n- 测试用例 3（作为边界情况的常数泄漏）：\n  - $H_x = 40.0$, $H_y = 20.0$.\n  - $x$-样本： $[\\,0.0,\\,10.0,\\,20.0,\\,30.0,\\,40.0\\,]$.\n  - 在这些 $x$ 值处的 $J_{\\text{top}}(x)$： $[\\,5.0,\\,2.0,\\,-1.0,\\,-4.0,\\,-7.0\\,]$.\n  - 在这些 $x$ 值处的 $J_{\\text{bottom}}(x)$： $[\\,-11.0,\\,-14.0,\\,-17.0,\\,-20.0,\\,-23.0\\,]$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每一项是针对一个测试用例的三个拟合系数列表。例如：\n$$\n[\\,[c_{0,1},c_{1,1},c_{2,1}],\\,[c_{0,2},c_{1,2},c_{2,2}],\\,[c_{0,3},c_{1,3},c_{2,3}]\\,]\n$$\n所有系数必须四舍五入到六位小数，并隐式地带有上述指定的单位。不要打印任何额外文本。",
            "solution": "该问题被认为是有效的。它在科学上基于中子输运和扩散理论在核反应堆分析中的应用原理，特别是在变分节点法的背景下。该任务是一个使用最小二乘法将多项式拟合到数据的适定数学问题。所有必要的数据和定义都已提供，并且没有内部矛盾。\n\n### 最小二乘公式的推导\n\n目标是找到二次多项式 $P(x) = c_0 + c_1 x + c_2 x^2$ 的系数 $\\{c_0, c_1, c_2\\}$，使其能够最佳逼近 $y$ 平均横向泄漏的离散值 $\\bar{L}(x_i)$。最小二乘原理要求最小化模型预测与观测数据之间的残差平方和 $S$。\n\n我们记为 $\\bar{L}_i$ 的横向泄漏观测数据，是在每个样本点 $x_i$ 处使用问题陈述中提供的公式计算得出的：\n$$\n\\bar{L}_i = \\bar{L}(x_i) = \\frac{J_{\\text{bottom}}(x_i) - J_{\\text{top}}(x_i)}{H_y}\n$$\n对于一组 $N$ 个样本点 $i = 1, 2, \\dots, N$。\n\n残差平方和由下式给出：\n$$\nS(c_0, c_1, c_2) = \\sum_{i=1}^{N} \\left( \\bar{L}_i - P(x_i) \\right)^2 = \\sum_{i=1}^{N} \\left( \\bar{L}_i - (c_0 + c_1 x_i + c_2 x_i^2) \\right)^2\n$$\n为了使 $S$ 相对于这些系数最小化，我们必须将 $S$ 对每个系数的偏导数设为零：\n$$\n\\frac{\\partial S}{\\partial c_0} = 0, \\quad \\frac{\\partial S}{\\partial c_1} = 0, \\quad \\frac{\\partial S}{\\partial c_2} = 0\n$$\n计算这些导数可得：\n$$\n\\frac{\\partial S}{\\partial c_0} = \\sum_{i=1}^{N} 2 (\\bar{L}_i - c_0 - c_1 x_i - c_2 x_i^2)(-1) = 0 \\implies \\sum_{i=1}^{N} (\\bar{L}_i) = \\sum_{i=1}^{N} (c_0 + c_1 x_i + c_2 x_i^2)\n$$\n$$\n\\frac{\\partial S}{\\partial c_1} = \\sum_{i=1}^{N} 2 (\\bar{L}_i - c_0 - c_1 x_i - c_2 x_i^2)(-x_i) = 0 \\implies \\sum_{i=1}^{N} (x_i \\bar{L}_i) = \\sum_{i=1}^{N} (c_0 x_i + c_1 x_i^2 + c_2 x_i^3)\n$$\n$$\n\\frac{\\partial S}{\\partial c_2} = \\sum_{i=1}^{N} 2 (\\bar{L}_i - c_0 - c_1 x_i - c_2 x_i^2)(-x_i^2) = 0 \\implies \\sum_{i=1}^{N} (x_i^2 \\bar{L}_i) = \\sum_{i=1}^{N} (c_0 x_i^2 + c_1 x_i^3 + c_2 x_i^4)\n$$\n重新整理这些和式，可以得到一个关于三个未知系数 $c_0, c_1, c_2$ 的三元线性方程组。该方程组被称为正规方程：\n$$\n\\begin{cases}\n    (\\sum_{i=1}^{N} 1) c_0 + (\\sum_{i=1}^{N} x_i) c_1 + (\\sum_{i=1}^{N} x_i^2) c_2 = \\sum_{i=1}^{N} \\bar{L}_i \\\\\n    (\\sum_{i=1}^{N} x_i) c_0 + (\\sum_{i=1}^{N} x_i^2) c_1 + (\\sum_{i=1}^{N} x_i^3) c_2 = \\sum_{i=1}^{N} x_i \\bar{L}_i \\\\\n    (\\sum_{i=1}^{N} x_i^2) c_0 + (\\sum_{i=1}^{N} x_i^3) c_1 + (\\sum_{i=1}^{N} x_i^4) c_2 = \\sum_{i=1}^{N} x_i^2 \\bar{L}_i\n\\end{cases}\n$$\n该系统可以写成矩阵形式 $A^T A \\mathbf{c} = A^T \\mathbf{b}$，其中：\n- 未知系数向量为 $\\mathbf{c} = \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\end{pmatrix}$。\n- 观测泄漏值向量为 $\\mathbf{b} = \\begin{pmatrix} \\bar{L}_1 \\\\ \\bar{L}_2 \\\\ \\vdots \\\\ \\bar{L}_N \\end{pmatrix}$。\n- 设计矩阵 $A$ 由 $A_{ij} = x_i^{j-1}$ 给出，其中 $i=1,\\dots,N$ 且 $j=1,2,3$：\n$$\nA = \\begin{pmatrix}\n1  x_1  x_1^2 \\\\\n1  x_2  x_2^2 \\\\\n\\vdots  \\vdots  \\vdots \\\\\n1  x_N  x_N^2\n\\end{pmatrix}\n$$\n矩阵 $A^T A$ 是：\n$$\nA^T A = \\begin{pmatrix}\nN  \\sum x_i  \\sum x_i^2 \\\\\n\\sum x_i  \\sum x_i^2  \\sum x_i^3 \\\\\n\\sum x_i^2  \\sum x_i^3  \\sum x_i^4\n\\end{pmatrix}\n$$\n向量 $A^T \\mathbf{b}$ 是：\n$$\nA^T \\mathbf{b} = \\begin{pmatrix}\n\\sum \\bar{L}_i \\\\\n\\sum x_i \\bar{L}_i \\\\\n\\sum x_i^2 \\bar{L}_i\n\\end{pmatrix}\n$$\n求解这个 $3 \\times 3$ 线性系统即可得到所需的系数 $\\mathbf{c}$。\n\n### 算法实现\n\n虽然可以直接构建并求解正规方程，但如果矩阵 $A^T A$ 是病态的，这种方法可能在数值上不稳定。一种更鲁棒的方法是使用最小二乘求解器直接求解原始的超定系统 $A\\mathbf{c} \\approx \\mathbf{b}$，这种求解器通常采用 QR 分解等方法。这样可以避免显式构造 $A^T A$。\n\n所提供代码中实现的算法遵循以下步骤：\n1.  对每个测试用例，定义输入数据（$H_y$, $\\{x_i\\}$, $\\{J_{\\text{top},i}\\}$, $\\{J_{\\text{bottom},i}\\}$）。\n2.  使用提供的公式 $\\bar{L}_i = (J_{\\text{bottom},i} - J_{\\text{top},i}) / H_y$ 按元素计算横向泄漏值向量 $\\mathbf{b} = [\\bar{L}_1, \\dots, \\bar{L}_N]^T$。\n3.  构建设计矩阵 $A$，其中第 $i$ 行为 $[1, x_i, x_i^2]$。这等价于一个 2 次的范德蒙矩阵 (Vandermonde matrix)。\n4.  使用一个标准的数值库函数进行线性最小二乘计算，即 `numpy.linalg.lstsq`，来找到最小化欧几里得范数 (Euclidean norm) $\\|A\\mathbf{c} - \\mathbf{b}\\|_2$ 的系数向量 $\\mathbf{c}$。\n5.  将得到的系数 $\\{c_0, c_1, c_2\\}$ 按要求四舍五入到六位小数。\n6.  收集所有测试用例的结果，并将其格式化为指定的字符串格式以供最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the quadratic least-squares fit coefficients for the transverse\n    leakage term in a variational nodal method context for three test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"Hx\": 100.0,\n            \"Hy\": 50.0,\n            \"x\": [0.0, 25.0, 50.0, 75.0, 100.0],\n            \"Jtop\": [10.0, 22.5, 35.0, 47.5, 60.0],\n            \"Jbottom\": [110.0, 113.125, 122.5, 138.125, 160.0],\n        },\n        {\n            \"Hx\": 60.0,\n            \"Hy\": 30.0,\n            \"x\": [0.0, 20.0, 40.0, 60.0],\n            \"Jtop\": [0.0, 0.0, 0.0, 0.0],\n            \"Jbottom\": [45.0, 57.0, 69.0, 81.0],\n        },\n        {\n            \"Hx\": 40.0,\n            \"Hy\": 20.0,\n            \"x\": [0.0, 10.0, 20.0, 30.0, 40.0],\n            \"Jtop\": [5.0, 2.0, -1.0, -4.0, -7.0],\n            \"Jbottom\": [-11.0, -14.0, -17.0, -20.0, -23.0],\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        # Extract data for the current case\n        Hy = case[\"Hy\"]\n        x_samples = np.array(case[\"x\"])\n        J_top_samples = np.array(case[\"Jtop\"])\n        J_bottom_samples = np.array(case[\"Jbottom\"])\n\n        # Step 1: Compute the y-averaged transverse leakage L_bar for each sample point\n        L_bar_samples = (J_bottom_samples - J_top_samples) / Hy\n        \n        # Step 2: Construct the design matrix A for the quadratic fit (c0 + c1*x + c2*x^2)\n        # The columns are for x^0, x^1, x^2\n        A = np.polynomial.polynomial.polyvander(x_samples, 2)\n        \n        # Step 3: Solve the least-squares problem A*c = b for the coefficients c\n        # b is the vector of L_bar_samples\n        # This is a numerically stable way to solve the normal equations.\n        coeffs, _, _, _ = np.linalg.lstsq(A, L_bar_samples, rcond=None)\n        \n        # The coefficients are returned in the order [c0, c1, c2]\n        all_results.append(coeffs)\n\n    # Step 4: Format the output as specified\n    # Rounded to six decimal places, in a list of lists format.\n    result_strings = []\n    for coeffs in all_results:\n        # Round each coefficient to 6 decimal places\n        rounded_coeffs = np.round(coeffs, 6)\n        # Format each coefficient to a string with 6 decimal places\n        coeff_strs = [f\"{c:.6f}\" for c in rounded_coeffs]\n        # Join into the list format '[c0,c1,c2]'\n        result_strings.append(f\"[{','.join(coeff_strs)}]\")\n        \n    # Join all case results into the final format '[[...],[...],...]'\n    final_output = f\"[[{','.join(result_strings)}]]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}