{
    "hands_on_practices": [
        {
            "introduction": "变分节点法的核心思想之一是在每个计算“节点”内，使用多项式展开来近似中子通量密度。本练习旨在建立这种数学表示与物理量之间的直接联系。通过求解此问题，您将学习如何利用节点平均通量、表面平均通量和横向泄漏等物理矩，来确定中子通量密度勒让德多项式展开式中的待定系数。",
            "id": "4260107",
            "problem": "考虑在变分节点法(VNM)中使用的二维(2D)单能群(1G)中子扩散模型中的单个均匀矩形节点。设局部（无量纲）空间坐标为 $x \\in [-1,1]$ 和 $y \\in [-1,1]$。在该节点内，通过对二次勒让德多项式展开进行截断，使用以下无交叉项的可分离基来近似标量通量 $\\phi(x,y)$：\n$$\n\\phi(x,y) = a_{00} P_{0}(x)P_{0}(y) + a_{10} P_{1}(x)P_{0}(y) + a_{01} P_{0}(x)P_{1}(y) + a_{20} P_{2}(x)P_{0}(y) + a_{02} P_{0}(x)P_{2}(y),\n$$\n其中 $P_{0}(z) = 1$、$P_{1}(z) = z$ 和 $P_{2}(z) = \\frac{3z^{2} - 1}{2}$ 是在 $[-1,1]$ 上的前三个勒让德多项式，而 $a_{00}$、$a_{10}$、$a_{01}$、$a_{20}$、$a_{02}$ 是待确定的常系数。\n\n将单元平均通量定义为\n$$\n\\bar{\\phi} = \\frac{1}{4} \\int_{-1}^{1}\\int_{-1}^{1} \\phi(x,y)\\,dx\\,dy,\n$$\n将界面平均通量定义为\n$$\n\\bar{\\phi}_{x\\pm} = \\frac{1}{2} \\int_{-1}^{1} \\phi(\\pm 1, y)\\,dy, \\qquad \\bar{\\phi}_{y\\pm} = \\frac{1}{2} \\int_{-1}^{1} \\phi(x, \\pm 1)\\,dx.\n$$\n\n在VNM的横向积分一维方程中，横向泄漏函数定义为\n$$\nL_{x}(y) = -D \\,\\frac{1}{2}\\int_{-1}^{1} \\frac{\\partial^{2}\\phi(x,y)}{\\partial y^{2}}\\,dx, \\qquad\nL_{y}(x) = -D \\,\\frac{1}{2}\\int_{-1}^{1} \\frac{\\partial^{2}\\phi(x,y)}{\\partial x^{2}}\\,dy,\n$$\n其中 $D$ 是扩散系数。在此节点中，设 $D = 1$，并假设横向泄漏函数被指定为空间常数，且等于\n$$\nL_{x}(y) = -0.9, \\qquad L_{y}(x) = -0.6.\n$$\n\n给定以下关于通量矩的数据：\n- 单元平均通量：$\\bar{\\phi} = 1.10$。\n- 界面平均通量：$\\bar{\\phi}_{x+} = 1.45$，$\\bar{\\phi}_{x-} = 1.15$，$\\bar{\\phi}_{y+} = 1.45$，$\\bar{\\phi}_{y-} = 1.35$。\n\n从上述定义和勒让德多项式的性质出发，计算系数 $a_{00}$、$a_{10}$、$a_{01}$、$a_{20}$ 和 $a_{02}$，使得二次勒让德展开式能精确地再现给定的单元平均通量、界面平均通量和指定的横向泄漏函数。将最终答案表示为一个单行矩阵，其中按顺序 $(a_{00}, a_{10}, a_{01}, a_{20}, a_{02})$ 包含五个系数。请使用精确值，无需四舍五入。",
            "solution": "用户希望在二维节点法的背景下，求解中子通量的二次勒让德多项式展开的系数。该问题被认为是有效的，因为它在核反应堆物理学方面有科学依据，是适定的，具有一致且完备的数据集，并使用客观、正式的语言。所提供的数据可以为所求系数得出唯一解。\n\n给定单个均匀节点内的通量展开式：\n$$\n\\phi(x,y) = a_{00} P_{0}(x)P_{0}(y) + a_{10} P_{1}(x)P_{0}(y) + a_{01} P_{0}(x)P_{1}(y) + a_{20} P_{2}(x)P_{0}(y) + a_{02} P_{0}(x)P_{2}(y)\n$$\n其中勒让德多项式为 $P_{0}(z) = 1$、$P_{1}(z) = z$ 和 $P_{2}(z) = \\frac{3z^{2} - 1}{2}$。我们的目标是利用所提供的数据确定系数 $a_{00}$、$a_{10}$、$a_{01}$、$a_{20}$ 和 $a_{02}$。\n\n首先，我们在给定的量（单元平均通量、界面平均通量和横向泄漏）与未知系数之间建立关系。我们将使用勒让德多项式的正交性，特别是积分 $\\int_{-1}^{1} P_n(z) dz = \\int_{-1}^{1} P_n(z) P_0(z) dz = 2 \\delta_{n0}$，其中 $\\delta_{n0}$ 是克罗内克δ函数。\n\n1.  **单元平均通量 $\\bar{\\phi}$**\n    单元平均通量定义为：\n    $$\n    \\bar{\\phi} = \\frac{1}{4} \\int_{-1}^{1}\\int_{-1}^{1} \\phi(x,y)\\,dx\\,dy\n    $$\n    将 $\\phi(x,y)$ 的展开式代入并逐项积分：\n    $$\n    \\bar{\\phi} = \\frac{1}{4} \\sum_{i,j} a_{ij} \\int_{-1}^{1} P_i(x) dx \\int_{-1}^{1} P_j(y) dy\n    $$\n    其中求和遍及数对 $(i,j) \\in \\{(0,0), (1,0), (0,1), (2,0), (0,2)\\}$。仅当 $i=0$ 和 $j=0$ 时积分才非零。因此，只有 $a_{00}$ 项保留下来。\n    $$\n    \\bar{\\phi} = \\frac{1}{4} a_{00} \\left(\\int_{-1}^{1} P_0(x)dx\\right) \\left(\\int_{-1}^{1} P_0(y)dy\\right) = \\frac{1}{4} a_{00} (2)(2) = a_{00}\n    $$\n    给定 $\\bar{\\phi} = 1.10$，我们得到第一个系数：\n    $$\n    a_{00} = 1.10\n    $$\n\n2.  **界面平均通量 $\\bar{\\phi}_{x\\pm}$**\n    在 $x = \\pm 1$ 界面上的平均通量为：\n    $$\n    \\bar{\\phi}_{x\\pm} = \\frac{1}{2} \\int_{-1}^{1} \\phi(\\pm 1, y)\\,dy\n    $$\n    我们使用 $P_0(\\pm 1)=1$、$P_1(\\pm 1)=\\pm 1$ 和 $P_2(\\pm 1)=1$ 计算 $\\phi(\\pm 1, y)$：\n    $$\n    \\phi(\\pm 1, y) = a_{00}P_0(y) \\pm a_{10}P_0(y) + a_{01}P_1(y) + a_{20}P_0(y) + a_{02}P_2(y)\n    $$\n    $$\n    \\phi(\\pm 1, y) = (a_{00} \\pm a_{10} + a_{20})P_0(y) + a_{01}P_1(y) + a_{02}P_2(y)\n    $$\n    对 $y \\in [-1,1]$ 积分会导致含有 $P_1(y)$ 和 $P_2(y)$ 的项消失：\n    $$\n    \\bar{\\phi}_{x\\pm} = \\frac{1}{2} (a_{00} \\pm a_{10} + a_{20}) \\int_{-1}^{1} P_0(y) dy = \\frac{1}{2} (a_{00} \\pm a_{10} + a_{20}) (2) = a_{00} \\pm a_{10} + a_{20}\n    $$\n    这会得到一个由两个方程组成的方程组：\n    $$\n    \\bar{\\phi}_{x+} = a_{00} + a_{10} + a_{20} = 1.45\n    $$\n    $$\n    \\bar{\\phi}_{x-} = a_{00} - a_{10} + a_{20} = 1.15\n    $$\n\n3.  **界面平均通量 $\\bar{\\phi}_{y\\pm}$**\n    根据对称性，对于 $y = \\pm 1$ 处的界面：\n    $$\n    \\bar{\\phi}_{y\\pm} = a_{00} \\pm a_{01} + a_{02}\n    $$\n    这会得到另一个由两个方程组成的方程组：\n    $$\n    \\bar{\\phi}_{y+} = a_{00} + a_{01} + a_{02} = 1.45\n    $$\n    $$\n    \\bar{\\phi}_{y-} = a_{00} - a_{01} + a_{02} = 1.35\n    $$\n\n4.  **横向泄漏 $L_x(y)$ 和 $L_y(x)$**\n    $y$方向的横向泄漏为：\n    $$\n    L_y(x) = -D \\frac{1}{2} \\int_{-1}^{1} \\frac{\\partial^2\\phi(x,y)}{\\partial x^2} dy\n    $$\n    首先，我们求 $\\phi$ 关于 $x$ 的二阶导数。注意，$P_0''(x) = 0$、$P_1''(x)=0$ 且 $P_2''(x) = \\frac{d^2}{dx^2}(\\frac{3x^2-1}{2}) = 3$。\n    $$\n    \\frac{\\partial^2\\phi}{\\partial x^2} = a_{20} P_2''(x) P_0(y) = 3 a_{20} P_0(y)\n    $$\n    将此代入泄漏的定义中：\n    $$\n    L_y(x) = -D \\frac{3 a_{20}}{2} \\int_{-1}^{1} P_0(y) dy = -D \\frac{3 a_{20}}{2} (2) = -3 D a_{20}\n    $$\n    给定 $D=1$ 且 $L_y(x) = -0.6$，我们可以求出 $a_{20}$：\n    $$\n    -0.6 = -3(1)a_{20} \\implies a_{20} = \\frac{0.6}{3} = 0.2\n    $$\n    根据对称性，$x$方向的横向泄漏为：\n    $$\n    L_x(y) = -3 D a_{02}\n    $$\n    给定 $L_x(y) = -0.9$，我们求出 $a_{02}$：\n    $$\n    -0.9 = -3(1)a_{02} \\implies a_{02} = \\frac{0.9}{3} = 0.3\n    $$\n\n现在我们已经确定了 $a_{00} = 1.10$、$a_{20} = 0.2$ 和 $a_{02} = 0.3$。我们可以使用这些值来求解 $a_{10}$ 和 $a_{01}$。\n\n从 $\\bar{\\phi}_{x\\pm}$ 的方程组中，用第一个方程减去第二个方程得到：\n$$\n\\bar{\\phi}_{x+} - \\bar{\\phi}_{x-} = (a_{00} + a_{10} + a_{20}) - (a_{00} - a_{10} + a_{20}) = 2 a_{10}\n$$\n$$\na_{10} = \\frac{\\bar{\\phi}_{x+} - \\bar{\\phi}_{x-}}{2} = \\frac{1.45 - 1.15}{2} = \\frac{0.30}{2} = 0.15\n$$\n\n从 $\\bar{\\phi}_{y\\pm}$ 的方程组中，进行类似的减法运算得到：\n$$\n\\bar{\\phi}_{y+} - \\bar{\\phi}_{y-} = (a_{00} + a_{01} + a_{02}) - (a_{00} - a_{01} + a_{02}) = 2 a_{01}\n$$\n$$\na_{01} = \\frac{\\bar{\\phi}_{y+} - \\bar{\\phi}_{y-}}{2} = \\frac{1.45 - 1.35}{2} = \\frac{0.10}{2} = 0.05\n$$\n\n因此，这五个系数为：\n$a_{00} = 1.10$\n$a_{10} = 0.15$\n$a_{01} = 0.05$\n$a_{20} = 0.2$\n$a_{02} = 0.3$\n\n最终答案是按要求将这些系数排列成一个行矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.1  0.15  0.05  0.2  0.3 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了单个节点内的通量表示方法后，下一个关键步骤是理解节点之间如何相互“通信”。本练习引入了分方向流（partial currents）的概念，这是描述中子穿过节点界面的关键工具。您将运用分方向流来计算节点的净泄漏，并验证相邻节点界面处中子流的守恒性，这是构建整个反应堆堆芯模型的物理基础。",
            "id": "4260120",
            "problem": "考虑一个用于核反应堆模拟中变分节点法 (VNM) 的笛卡尔离散化的单能群、稳态中子输运模型。设一个节点是单位厚度的长方体，其四个侧面面积相等。对每个面，定义向外单位法向量 $\\mathbf{n}_f$ 指向节点外部，并定义面平均半程（部分）流\n$$\nj^{+}_{f} \\equiv \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f > 0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A, \\quad\nj^{-}_{f} \\equiv \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} |\\mathbf{\\Omega}\\cdot\\mathbf{n}_f|\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A,\n$$\n其中 $\\psi(\\mathbf{r},\\mathbf{\\Omega})$ 是角中子通量，$A_f$ 是面面积，$\\mathbf{\\Omega}$ 是方向单位向量。\n\n给定两个相邻节点 $\\mathcal{N}_1$ 和 $\\mathcal{N}_2$，它们共享一个垂直面。每个侧面的面积为 $A_f = 100$ (平方厘米)，节点厚度为 $1$ (厘米)，因此节点 $\\mathcal{N}_i$ 的面 $f$ 上的面积分净流为 $A_f\\left(j^{+}_{i,f} - j^{-}_{i,f}\\right)$，单位为中子/秒。对于节点 $\\mathcal{N}_1$，面平均部分流（单位为中子/平方厘米·秒）指定如下：\n$$\nj^{+}_{1,W} = 1.80, \\quad j^{-}_{1,W} = 2.10, \\quad\nj^{+}_{1,E} = 4.20, \\quad j^{-}_{1,E} = 5.00,\n$$\n$$\nj^{+}_{1,N} = 3.50, \\quad j^{-}_{1,N} = 3.40, \\quad\nj^{+}_{1,S} = 2.75, \\quad j^{-}_{1,S} = 2.55.\n$$\n共享面是 $\\mathcal{N}_1$ 的东面和 $\\mathcal{N}_2$ 的西面。通过界面耦合和一致的方向定义，从 $\\mathcal{N}_1$ 穿过共享面的出射部分流等于进入 $\\mathcal{N}_2$ 的入射部分流，反之亦然：\n$$\nj^{+}_{1,E} = j^{-}_{2,W}, \\qquad j^{-}_{1,E} = j^{+}_{2,W}.\n$$\n\n从稳态中子平衡和散度定理出发，推导节点 $\\mathcal{N}_1$ 的净泄漏 $L_1$ 关于其面平均部分流和面积的表达式，然后使用给定数据计算 $L_1$。接下来，通过计算界面守恒残差\n$$\nR \\equiv A_f\\Big[\\big(j^{+}_{1,E} - j^{-}_{1,E}\\big) + \\big(j^{+}_{2,W} - j^{-}_{2,W}\\big)\\Big]\n$$\n并使用上述耦合等式来验证共享界面上的全局守恒。\n\n将 $L_1$ 和 $R$ 都以中子/秒为单位表示。最终答案必须是写成单行矩阵形式的有序对 $\\big(L_1,\\,R\\big)$。无需四舍五入。",
            "solution": "该问题被验证为自洽的、有科学依据且适定的。提供了单能群、稳态中子输运模型所需的所有数据和定义。部分流、净泄漏和界面耦合的概念是用于核反应堆分析的节点法中的标准概念。\n\n首先，我们推导节点 $\\mathcal{N}_1$ 的净泄漏 $L_1$ 的表达式。净泄漏定义为单位时间内流出节点体积的中子总数。这由净流矢量 $\\mathbf{J}(\\mathbf{r})$ 在节点整个表面 $\\partial V_1$ 上的积分给出。\n$$\nL_1 = \\oint_{\\partial V_1} \\mathbf{J}(\\mathbf{r}) \\cdot \\mathbf{n} \\, \\mathrm{d}A\n$$\n其中 $\\mathbf{n}$ 是面元 $\\mathrm{d}A$ 上的向外单位法向量。净流矢量定义为方向矢量 $\\mathbf{\\Omega}$ 由角通量 $\\psi(\\mathbf{r}, \\mathbf{\\Omega})$ 加权后的角积分：\n$$\n\\mathbf{J}(\\mathbf{r}) = \\int_{4\\pi} \\mathbf{\\Omega} \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\, \\mathrm{d}\\Omega\n$$\n面积分可以表示为对节点所有面的求和。对于单能群二维笛卡尔模型，我们考虑四个侧面：东 ($E$)、西 ($W$)、北 ($N$) 和南 ($S$)。\n$$\nL_1 = \\sum_{f \\in \\{E,W,N,S\\}} \\int_{A_f} \\mathbf{J}(\\mathbf{r}) \\cdot \\mathbf{n}_f \\, \\mathrm{d}A\n$$\n其中 $\\mathbf{n}_f$ 是面 $f$ 的向外法线。项 $\\int_{A_f} \\mathbf{J}(\\mathbf{r}) \\cdot \\mathbf{n}_f \\, \\mathrm{d}A$ 是穿过面 $f$ 的面积分净流。我们将其与给定的面平均部分流 $j^{+}_{f}$ 和 $j^{-}_{f}$ 联系起来。\n\n面 $f$ 的面平均净流由下式给出：\n$$\n\\bar{J}_f = \\frac{1}{A_f} \\int_{A_f} \\left( \\int_{4\\pi} \\mathbf{\\Omega} \\cdot \\mathbf{n}_f \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\, \\mathrm{d}\\Omega \\right) \\mathrm{d}A\n$$\n我们可以将角积分分裂到两个半球上：一个中子向外运动（$\\mathbf{\\Omega} \\cdot \\mathbf{n}_f > 0$），另一个中子向内运动（$\\mathbf{\\Omega} \\cdot \\mathbf{n}_f  0$）。\n$$\n\\bar{J}_f = \\frac{1}{A_f} \\int_{A_f} \\left( \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f > 0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega + \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega \\right) \\mathrm{d}A\n$$\n根据定义，第一项是面平均出射部分流 $j^{+}_{f}$：\n$$\nj^{+}_{f} = \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f > 0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A\n$$\n第二项可以与面平均入射部分流 $j^{-}_{f}$ 相关联。给出的定义是：\n$$\nj^{-}_{f} = \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} |\\mathbf{\\Omega}\\cdot\\mathbf{n}_f|\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A\n$$\n对于入射半球，其中 $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0$，我们有 $|\\mathbf{\\Omega}\\cdot\\mathbf{n}_f| = -(\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)$。因此：\n$$\nj^{-}_{f} = \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} -(\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega\\,\\mathrm{d}A = -\\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f  0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega\\,\\mathrm{d}A\n$$\n因此，$\\bar{J}_f$ 表达式中的第二项等于 $-j^{-}_{f}$。面平均净流为：\n$$\n\\bar{J}_f = j^{+}_{f} - j^{-}_{f}\n$$\n穿过面 $f$ 的面积分净流是 $A_f \\bar{J}_f = A_f(j^{+}_{f} - j^{-}_{f})$。总净泄漏 $L_1$ 是这些量在节点 $\\mathcal{N}_1$ 的所有四个面上的总和：\n$$\nL_1 = A_f(j^{+}_{1,E} - j^{-}_{1,E}) + A_f(j^{+}_{1,W} - j^{-}_{1,W}) + A_f(j^{+}_{1,N} - j^{-}_{1,N}) + A_f(j^{+}_{1,S} - j^{-}_{1,S})\n$$\n这就是所求的表达式。现在我们使用节点 $\\mathcal{N}_1$ 的给定数据计算其值：$A_f = 100$ cm$^2$，部分流的单位是 中子/(cm$^2 \\cdot$s)。\n\n每个面的贡献：\n- 东面：$j^{+}_{1,E} - j^{-}_{1,E} = 4.20 - 5.00 = -0.80$\n- 西面：$j^{+}_{1,W} - j^{-}_{1,W} = 1.80 - 2.10 = -0.30$\n- 北面：$j^{+}_{1,N} - j^{-}_{1,N} = 3.50 - 3.40 = 0.10$\n- 南面：$j^{+}_{1,S} - j^{-}_{1,S} = 2.75 - 2.55 = 0.20$\n\n对面平均净流求和：\n$$\n\\sum_f (j^{+}_{1,f} - j^{-}_{1,f}) = (-0.80) + (-0.30) + (0.10) + (0.20) = -0.80\n$$\n现在，我们计算总净泄漏 $L_1$：\n$$\nL_1 = A_f \\sum_f (j^{+}_{1,f} - j^{-}_{1,f}) = 100 \\times (-0.80) = -80\n$$\n单位是 (cm$^2$) $\\times$ (中子/(cm$^2 \\cdot$s)) = 中子/秒。负值表示有中子净流入该节点。\n\n接下来，我们计算界面守恒残差 $R$。定义如下：\n$$\nR \\equiv A_f\\Big[\\big(j^{+}_{1,E} - j^{-}_{1,E}\\big) + \\big(j^{+}_{2,W} - j^{-}_{2,W}\\big)\\Big]\n$$\n这个量表示来自共享界面两侧的面积分净流之和。项 $(j^{+}_{1,E} - j^{-}_{1,E})$ 是从节点 $\\mathcal{N}_1$ 通过其东面流出的净流。项 $(j^{+}_{2,W} - j^{-}_{2,W})$ 是从节点 $\\mathcal{N}_2$ 通过其西面流出的净流。根据守恒定律，穿过界面的净流必须是连续的，这意味着从 $\\mathcal{N}_1$ 流出的流量应等于流入 $\\mathcal{N}_2$ 的流量。由于向外法线方向相反（$\\mathbf{n}_{1,E} = -\\mathbf{n}_{2,W}$），两侧向外流动的净流之和应为零。\n\n问题提供了强制实现这种连续性的界面耦合等式：\n$$\nj^{+}_{1,E} = j^{-}_{2,W}\n$$\n$$\nj^{-}_{1,E} = j^{+}_{2,W}\n$$\n我们将这些代入 $R$ 的表达式中：\n$$\nR = A_f\\Big[\\big(j^{+}_{1,E} - j^{-}_{1,E}\\big) + \\big(j^{-}_{1,E} - j^{+}_{1,E}\\big)\\Big]\n$$\n重新排列括号内的项：\n$$\nR = A_f\\Big[(j^{+}_{1,E} - j^{+}_{1,E}) + (-j^{-}_{1,E} + j^{-}_{1,E})\\Big] = A_f\\Big[0 + 0\\Big] = 0\n$$\n残差恒等于零，这证实了问题的表述确保了节点界面上的全局中子守恒。由于根据耦合条件的结构 $R$ 为零，因此计算 $R$ 不需要 $\\mathcal{N}_1$ 东面的部分流数值。\n\n最终答案是有序对 $(L_1, R)$。\n$$\nL_1 = -80 \\text{ 中子/秒}\n$$\n$$\nR = 0 \\text{ 中子/秒}\n$$\n有序对是 $(-80, 0)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-80  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "提高多项式阶数 $p$ 是提升变分节点法计算精度的有效手段，但这也会带来数值计算上的挑战。本练习深入探讨了高阶方法的一个高级主题：数值稳定性。您将分析随着多项式阶数的增加，离散系统矩阵的条件数如何恶化，并探索如何通过有效的缩放（或预处理）策略来缓解这一问题，从而揭示物理建模与稳健数值计算之间的深刻联系。",
            "id": "4260080",
            "problem": "考虑反应堆堆芯中一个宽度为 $h$ 的一维节点，其中使用变分节点法（Variational Nodal Method, VNM）求解单能群稳态中子扩散方程。假设节点内的材料属性是恒定的：扩散系数 $D  0$ 和吸收截面 $\\Sigma_a  0$。节点内的局部试探空间是由次数至多为 $p$ 的多项式张成的空间，这些多项式通过 $x = x_c + \\tfrac{h}{2}\\,\\xi$ 从参考区间 $[-1,1]$ 映射到物理节点，其中 $\\xi \\in [-1,1]$ 且 $x_c$ 是节点中心。节点上函数 $u$ 和 $v$ 的局部双线性形式为\n$$\na(u,v) = \\int_{x_c - h/2}^{x_c + h/2} D\\,\\frac{du}{dx}\\,\\frac{dv}{dx}\\,dx \\;+\\; \\int_{x_c - h/2}^{x_c + h/2} \\Sigma_a\\,u\\,v\\,dx.\n$$\n设局部刚度矩阵 $\\mathbf{K}$ 是 $a(\\cdot,\\cdot)$ 在节点上某个选定的次数至多为 $p$ 的多项式基中的矩阵表示。你可以假设标准的导数映射恒等式，即 $\\tfrac{d}{dx} = \\tfrac{2}{h}\\tfrac{d}{d\\xi}$，并且物理节点上的 $L^2$ 内积相对于参考区间按雅可比因子 $\\tfrac{h}{2}$ 进行缩放。仅使用这些基本原理，推断增加多项式阶数 $p$ 如何影响 $\\mathbf{K}$ 的条件数，并提出一种在不改变其潜在物理原理的情况下缓解病态性的、具有物理意义的缩放方法。\n\n选择最准确地描述条件数 $\\kappa(\\mathbf{K})$ 对 $p$ 和 $h$ 的渐近依赖关系，并提供合理解释的缩放策略的选项。\n\nA. $\\kappa(\\mathbf{K})$ 按 $\\mathcal{O}\\left(\\frac{p^2}{h^2}\\right)$ 增长，其主导行为近似为\n$$\n\\kappa(\\mathbf{K}) \\approx 1 + \\frac{4D}{\\Sigma_a h^2}\\,p(p+1),\n$$\n一种稳健的缓解方法是在模态多项式基中进行能量范数对角缩放：将阶数为 $n$ 的模态按 $s_n = \\left[\\Sigma_a\\,\\tfrac{h}{2} + D\\,\\tfrac{2}{h}\\,n(n+1)\\right]^{-1/2}$ 进行缩放，从而使各阶的导数和吸收贡献得到平衡。\n\nB. $\\kappa(\\mathbf{K})$ 随 $p$ 线性增长，为 $\\mathcal{O}\\left(\\frac{p}{h}\\right)$，仅通过质量集中（用对角矩阵 $\\mathbf{M}$ 替换一致质量矩阵）即可消除与阶数相关的病态性，无需任何与阶数相关的缩放。\n\nC. $\\kappa(\\mathbf{K})$ 按 $\\mathcal{O}\\left(p^4\\right)$ 四次增长且与 $h$ 无关，唯一实用的补救措施是通过网格加密来强制 $h \\sim p^{-2}$；任何对角或模态缩放都无法实质性地减小条件数。\n\nD. 当在参考区间上使用勒让德多项式基时，$\\kappa(\\mathbf{K})$ 与 $p$ 无关，因此除了通过 $h$ 进行映射外，不需要进行任何缩放。",
            "solution": "用户需要对局部刚度矩阵的条件数进行分析，并找到一个合适的缓解策略。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件：**\n-   **方程：** 单能群稳态中子扩散方程。\n-   **方法：** 一维节点上的变分节点法（VNM）。\n-   **节点几何形状：** 宽度 $h$。\n-   **材料属性：** 恒定的扩散系数 $D  0$，恒定的吸收截面 $\\Sigma_a  0$。\n-   **试探空间：** 节点上次数至多为 $p$ 的多项式。\n-   **坐标映射：** 从参考区间 $\\xi \\in [-1,1]$ 到物理节点 `x`，由 $x = x_c + \\tfrac{h}{2}\\,\\xi$ 给出。\n-   **映射恒等式：** $\\tfrac{d}{dx} = \\tfrac{2}{h}\\tfrac{d}{d\\xi}$，积分测度变换为 $dx = \\tfrac{h}{2}d\\xi$。\n-   **双线性形式：** \n    $$\n    a(u,v) = \\int_{x_c - h/2}^{x_c + h/2} D\\,\\frac{du}{dx}\\,\\frac{dv}{dx}\\,dx \\;+\\; \\int_{x_c - h/2}^{x_c + h/2} \\Sigma_a\\,u\\,v\\,dx.\n    $$\n-   **矩阵定义：** $\\mathbf{K}$ 是 $a(\\cdot,\\cdot)$ 在次数至多为 $p$ 的多项式基中的局部刚度矩阵。\n\n**1.2. 使用提取的已知条件进行验证：**\n1.  **科学依据：** 该问题牢固地植根于偏微分方程（特别是中子扩散方程）使用高阶有限元方法的数值解法中。双线性形式 $a(u,v)$ 正确地表示了算子 $(-D\\frac{d^2}{dx^2} + \\Sigma_a)$ 的弱形式。这是反应堆物理和数值分析中的标准提法。\n2.  **适定性：** 问题要求分析一个由定义明确的正定双线性形式导出的矩阵的条件数的渐近行为。这是 `p`-型有限元方法中一个标准的、可解的数值分析问题。\n3.  **客观性：** 语言技术性强、精确，且不含主观内容。\n\n**1.3. 结论：**\n问题陈述是有效的。这是一个在与核工程相关的偏微分方程数值分析领域中，适定的、具有科学依据的问题。\n\n### 步骤2：解题推导\n\n该分析通过将双线性形式变换到参考区间，选择合适的基来分析矩阵属性，然后确定矩阵特征值的渐近行为来进行。\n\n**2.1. 变换到参考区间：**\n设 $u(\\xi)$ 和 $v(\\xi)$ 是参考区间 $[-1,1]$ 上的多项式函数。使用给定的映射规则，我们变换双线性形式 $a(u,v)$：\n$$\na(u,v) = \\int_{-1}^{1} D \\left(\\frac{2}{h}\\frac{du}{d\\xi}\\right) \\left(\\frac{2}{h}\\frac{dv}{d\\xi}\\right) \\left(\\frac{h}{2}d\\xi\\right) + \\int_{-1}^{1} \\Sigma_a u v \\left(\\frac{h}{2}d\\xi\\right)\n$$\n$$\na(u,v) = \\frac{2D}{h} \\int_{-1}^{1} \\frac{du}{d\\xi}\\frac{dv}{d\\xi} d\\xi + \\frac{\\Sigma_a h}{2} \\int_{-1}^{1} u v d\\xi\n$$\n该双线性形式是两个分量的和：一个刚度项（涉及导数）和一个质量项（涉及函数本身）。局部刚度矩阵 $\\mathbf{K}$ 是相应的刚度矩阵 $\\mathbf{S}$ 和质量矩阵 $\\mathbf{M}$ 的和。\n$$\n\\mathbf{K} = \\mathbf{S} + \\mathbf{M}\n$$\n其中 `S` 来自按 $2D/h$ 缩放的项，`M` 来自按 $\\Sigma_a h/2$ 缩放的项。\n\n**2.2. 特征值分析：**\n为了分析条件数 $\\kappa(\\mathbf{K}) = \\lambda_{\\max}(\\mathbf{K})/\\lambda_{\\min}(\\mathbf{K})$，我们分析其特征值。对于此分析，最方便的基是 $[-1,1]$ 上的正交多项式基，例如勒让德多项式 $P_n(\\xi)$。我们选择一个基 $\\{\\phi_n\\}_{n=0}^p$，它关于 $[-1,1]$ 上的 $L^2$ 内积是标准正交的，即 $\\int_{-1}^1 \\phi_n \\phi_m d\\xi = \\delta_{nm}$。例如，$\\phi_n(\\xi) = \\sqrt{\\frac{2n+1}{2}}P_n(\\xi)$。\n\n在此基中，质量矩阵 $\\mathbf{M}$ 变为对角矩阵：\n$$\nM_{nm} = \\frac{\\Sigma_a h}{2} \\int_{-1}^{1} \\phi_n \\phi_m d\\xi = \\frac{\\Sigma_a h}{2} \\delta_{nm}\n$$\n所以，质量矩阵为 $\\mathbf{M} = \\frac{\\Sigma_a h}{2}\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。\n\n刚度矩阵 $\\mathbf{S}$ 的元素为：\n$$\nS_{nm} = \\frac{2D}{h} \\int_{-1}^{1} \\frac{d\\phi_n}{d\\xi}\\frac{d\\phi_m}{d\\xi} d\\xi\n$$\n这个矩阵 $\\mathbf{S}$ 不是对角矩阵。然而，在这样一个分层、模态基中，众所周知参考刚度矩阵部分的特征值（我们称之为 $\\mathbf{S}'$，其元素为 $\\int \\phi_n'\\phi_m' d\\xi$）是可以很好地近似的，并且随多项式阶数而变化。具体来说，$\\mathbf{S}'$ 的特征值，我们记为 $\\lambda_n(\\mathbf{S'})$，其行为类似于 $\\lambda_n(\\mathbf{S'}) \\approx n(n+1)$，对于 $n=0, 1, ..., p$。注意，对于常数基函数 $\\phi_0$，其导数为零，所以 $\\lambda_0(\\mathbf{S'}) = 0$。\n\n矩阵 $\\mathbf{S}$ 和 $\\mathbf{M}$ 不能同时对角化，但它们的和 $\\mathbf{K}$ 的特征值可以由它们各自特征值的和来近似，这对于此分析是一个合理的近似。\n$$\n\\lambda_n(\\mathbf{K}) \\approx \\lambda_n(\\mathbf{S}) + \\lambda_n(\\mathbf{M})\n$$\n$$\n\\lambda_n(\\mathbf{K}) \\approx \\frac{2D}{h} \\lambda_n(\\mathbf{S}') + \\frac{\\Sigma_a h}{2}\n$$\n使用近似 $\\lambda_n(\\mathbf{S}') \\approx n(n+1)$，我们有：\n$$\n\\lambda_n(\\mathbf{K}) \\approx \\frac{2D}{h} n(n+1) + \\frac{\\Sigma_a h}{2}\n$$\n最小的特征值对应于最低阶模态，$n=0$：\n$$\n\\lambda_{\\min}(\\mathbf{K}) = \\lambda_0(\\mathbf{K}) \\approx \\frac{2D}{h} (0) + \\frac{\\Sigma_a h}{2} = \\frac{\\Sigma_a h}{2}\n$$\n最大的特征值对应于最高阶模态，$n=p$：\n$$\n\\lambda_{\\max}(\\mathbf{K}) = \\lambda_p(\\mathbf{K}) \\approx \\frac{2D}{h} p(p+1) + \\frac{\\Sigma_a h}{2}\n$$\n\n**2.3. 条件数与渐近行为：**\n条件数 $\\kappa(\\mathbf{K})$ 是最大特征值与最小特征值的比值：\n$$\n\\kappa(\\mathbf{K}) = \\frac{\\lambda_{\\max}(\\mathbf{K})}{\\lambda_{\\min}(\\mathbf{K})} \\approx \\frac{\\frac{2D}{h} p(p+1) + \\frac{\\Sigma_a h}{2}}{\\frac{\\Sigma_a h}{2}}\n$$\n$$\n\\kappa(\\mathbf{K}) \\approx \\frac{2D p(p+1)}{h(\\Sigma_a h/2)} + 1 = 1 + \\frac{4D}{\\Sigma_a h^2} p(p+1)\n$$\n对于大的 $p$，条件数的渐近行为是 $\\mathcal{O}\\left(\\frac{p^2}{h^2}\\right)$。\n\n**2.4. 缓解策略：**\n病态性的产生是因为特征值 $\\lambda_n(\\mathbf{K})$ 分布在一个很宽的范围内，并随 $n$ 呈二次增长。一个稳健的缓解策略是预处理矩阵 $\\mathbf{K}$。一种简单有效的方法是对角缩放，也称为雅可比预处理。这等效于缩放基函数。\n设新基为 $\\{\\hat{\\phi}_n\\}$，其中 $\\hat{\\phi}_n = s_n \\phi_n$。目标是选择缩放因子 $s_n$，使得新刚度矩阵的对角元素 $\\hat{K}_{nn} = a(\\hat{\\phi}_n, \\hat{\\phi}_n)$ 都约等于 1。\n$$\n\\hat{K}_{nn} = s_n^2 a(\\phi_n, \\phi_n) = s_n^2 K_{nn} \\approx s_n^2 \\lambda_n(\\mathbf{K})\n$$\n为了使 $\\hat{K}_{nn} \\approx 1$，我们必须选择 $s_n \\approx 1/\\sqrt{\\lambda_n(\\mathbf{K})}$。\n使用我们对 $\\lambda_n(\\mathbf{K})$ 的表达式：\n$$\ns_n = \\left[\\frac{\\Sigma_a h}{2} + \\frac{2D}{h} n(n+1)\\right]^{-1/2}\n$$\n这种缩放对应于在由双线性形式 $a(\\cdot,\\cdot)$ 定义的“能量范数”中对每个基模态进行归一化。它平衡了由吸收（$\\Sigma_a$）主导的低阶模态和由扩散（$D$ 和 $n(n+1)$ 导数项）主导的高阶模态。这不会改变底层的物理，因为它是一个预处理步骤，它修改了待数值求解的线性系统，而不改变其最终解。\n\n### 步骤3：逐项分析\n\n**A. $\\kappa(\\mathbf{K})$ 按 $\\mathcal{O}\\left(\\frac{p^2}{h^2}\\right)$ 增长，其主导行为近似为 $\\kappa(\\mathbf{K}) \\approx 1 + \\frac{4D}{\\Sigma_a h^2}\\,p(p+1)$，一种稳健的缓解方法是在模态多项式基中进行能量范数对角缩放：将阶数为 $n$ 的模态按 $s_n = \\left[\\Sigma_a\\,\\tfrac{h}{2} + D\\,\\tfrac{2}{h}\\,n(n+1)\\right]^{-1/2}$ 进行缩放，从而使各阶的导数和吸收贡献得到平衡。**\n-   推导出的 $\\kappa(\\mathbf{K})$ 公式及其渐近增长 $\\mathcal{O}(p^2/h^2)$ 与此选项完全匹配。\n-   所提出的缩放因子 $s_n$ 正是近似第 $n$ 个特征值的平方根的倒数，这代表了能量范数缩放。\n-   关于平衡吸收和导数贡献的物理解释是正确的。\n-   **结论：正确。**\n\n**B. $\\kappa(\\mathbf{K})$ 随 $p$ 线性增长，为 $\\mathcal{O}\\left(\\frac{p}{h}\\right)$，仅通过质量集中（用对角矩阵 $\\mathbf{M}$ 替换一致质量矩阵）即可消除与阶数相关的病态性，无需任何与阶数相关的缩放。**\n-   增长不是 $p$ 的线性关系；它是二次的（`\\mathcal{O}(p^2)`）。对 $h$ 的依赖是 `\\mathcal{O}(h^{-2})`，而不是 `\\mathcal{O}(h^{-1})`。\n-   质量集中不能解决来自刚度矩阵部分的病态性，而这正是大 `p` 值时病态性的主要来源。对于勒让德基，质量矩阵已经是-对角的，所以质量集中没有意义。\n-   **结论：不正确。**\n\n**C. $\\kappa(\\mathbf{K})$ 按 $\\mathcal{O}\\left(p^4\\right)$ 四次增长且与 $h$ 无关，唯一实用的补救措施是通过网格加密来强制 $h \\sim p^{-2}$；任何对角或模态缩放都无法实质性地减小条件数。**\n-   增长是 `\\mathcal{O}(p^2)`，不是 `\\mathcal{O}(p^4)`。`\\mathcal{O}(p^4)` 的缩放适用于在某些条件下*仅*刚度矩阵的条件数，而不是完整的矩阵 `\\mathbf{K}`，其中质量项正则化了最小的特征值。\n-   关于与 $h$ 无关的说法是错误的；条件数有很强的 `\\mathcal{O}(h^{-2})` 依赖性。\n-   关于任何缩放都无济于事的说法是错误的；对角缩放（雅可比预处理）是一种已知且有效的补救措施。\n-   **结论：不正确。**\n\n**D. 当在参考区间上使用勒让德多项式基时，$\\kappa(\\mathbf{K})$ 与 $p$ 无关，因此除了通过 $h$ 进行映射外，不需要进行任何缩放。**\n-   这是错误的。刚度部分的特征值近似以 `n^2` 增长，导致条件数具有强烈的 `p`-依赖性（`\\mathcal{O}(p^2)`）。使用勒让德基有助于分析，但不能消除病态性的根本数学原因。\n-   **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}