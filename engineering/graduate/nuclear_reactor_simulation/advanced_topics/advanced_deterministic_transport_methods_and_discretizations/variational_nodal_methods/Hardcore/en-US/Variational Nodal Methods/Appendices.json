{
    "hands_on_practices": [
        {
            "introduction": "The core of the Variational Nodal Method (VNM) lies in approximating the continuous neutron flux within each computational node using a set of basis functions, typically orthogonal polynomials. This practice demonstrates how to determine the coefficients of this polynomial expansion by ensuring the approximation reproduces key integral moments, such as the average flux within the node and across its faces. Mastering this fundamental procedure is the first step toward building the complete nodal system, as these coefficients are the primary unknowns in the discretized problem .",
            "id": "4260107",
            "problem": "Consider a single homogeneous rectangular node in a two-dimensional (2D) one-energy-group (1G) neutron diffusion model, as used in the Variational Nodal Method (VNM). Let the local (dimensionless) spatial coordinates be $x \\in [-1,1]$ and $y \\in [-1,1]$. Within the node, approximate the scalar flux $\\phi(x,y)$ by a quadratic Legendre polynomial expansion truncated to the following separable basis without cross terms:\n$$\n\\phi(x,y) = a_{00} P_{0}(x)P_{0}(y) + a_{10} P_{1}(x)P_{0}(y) + a_{01} P_{0}(x)P_{1}(y) + a_{20} P_{2}(x)P_{0}(y) + a_{02} P_{0}(x)P_{2}(y),\n$$\nwhere $P_{0}(z) = 1$, $P_{1}(z) = z$, and $P_{2}(z) = \\frac{3z^{2} - 1}{2}$ are the first three Legendre polynomials on $[-1,1]$, and $a_{00}$, $a_{10}$, $a_{01}$, $a_{20}$, $a_{02}$ are constant coefficients to be determined.\n\nDefine the cell-average flux by\n$$\n\\bar{\\phi} = \\frac{1}{4} \\int_{-1}^{1}\\int_{-1}^{1} \\phi(x,y)\\,dx\\,dy,\n$$\nand face-averaged fluxes by\n$$\n\\bar{\\phi}_{x\\pm} = \\frac{1}{2} \\int_{-1}^{1} \\phi(\\pm 1, y)\\,dy, \\qquad \\bar{\\phi}_{y\\pm} = \\frac{1}{2} \\int_{-1}^{1} \\phi(x, \\pm 1)\\,dx.\n$$\n\nIn the VNM transverse-integrated 1D equations, the transverse leakage functions are defined by\n$$\nL_{x}(y) = -D \\,\\frac{1}{2}\\int_{-1}^{1} \\frac{\\partial^{2}\\phi(x,y)}{\\partial y^{2}}\\,dx, \\qquad\nL_{y}(x) = -D \\,\\frac{1}{2}\\int_{-1}^{1} \\frac{\\partial^{2}\\phi(x,y)}{\\partial x^{2}}\\,dy,\n$$\nwhere $D$ is the diffusion coefficient. In this node, let $D = 1$ and suppose the transverse leakage functions are specified to be spatially constant and equal to\n$$\nL_{x}(y) = -0.9, \\qquad L_{y}(x) = -0.6.\n$$\n\nYou are given the following data for the flux moments:\n- Cell-average flux: $\\bar{\\phi} = 1.10$.\n- Face-average fluxes: $\\bar{\\phi}_{x+} = 1.45$, $\\bar{\\phi}_{x-} = 1.15$, $\\bar{\\phi}_{y+} = 1.45$, $\\bar{\\phi}_{y-} = 1.35$.\n\nStarting from the definitions above and properties of Legendre polynomials, compute the coefficients $a_{00}$, $a_{10}$, $a_{01}$, $a_{20}$, and $a_{02}$ such that the quadratic Legendre expansion reproduces the given cell-average, face-averages, and the specified transverse leakage functions exactly. Express your final answer as a single row matrix containing the five coefficients in the order $(a_{00}, a_{10}, a_{01}, a_{20}, a_{02})$. Use exact values; no rounding is required.",
            "solution": "The user wants to find the coefficients of a quadratic Legendre polynomial expansion for the neutron flux in a 2D nodal method context. The problem is deemed valid as it is scientifically grounded in nuclear reactor physics, well-posed with a consistent and complete set of data, and uses objective, formal language. The provided data yields a unique solution for the requested coefficients.\n\nWe are given the flux expansion within a single homogeneous node:\n$$\n\\phi(x,y) = a_{00} P_{0}(x)P_{0}(y) + a_{10} P_{1}(x)P_{0}(y) + a_{01} P_{0}(x)P_{1}(y) + a_{20} P_{2}(x)P_{0}(y) + a_{02} P_{0}(x)P_{2}(y)\n$$\nwith Legendre polynomials $P_{0}(z) = 1$, $P_{1}(z) = z$, and $P_{2}(z) = \\frac{3z^{2} - 1}{2}$. Our goal is to determine the coefficients $a_{00}$, $a_{10}$, $a_{01}$, $a_{20}$, and $a_{02}$ using the provided data.\n\nFirst, we establish relationships between the given quantities (cell-average flux, face-average fluxes, and transverse leakages) and the unknown coefficients. We will use the orthogonality property of Legendre polynomials, specifically the integral $\\int_{-1}^{1} P_n(z) dz = \\int_{-1}^{1} P_n(z) P_0(z) dz = 2 \\delta_{n0}$, where $\\delta_{n0}$ is the Kronecker delta.\n\n1.  **Cell-Average Flux $\\bar{\\phi}$**\n    The cell-average flux is defined as:\n    $$\n    \\bar{\\phi} = \\frac{1}{4} \\int_{-1}^{1}\\int_{-1}^{1} \\phi(x,y)\\,dx\\,dy\n    $$\n    Substituting the expansion for $\\phi(x,y)$ and integrating term by term:\n    $$\n    \\bar{\\phi} = \\frac{1}{4} \\sum_{i,j} a_{ij} \\int_{-1}^{1} P_i(x) dx \\int_{-1}^{1} P_j(y) dy\n    $$\n    where the sum is over the pairs $(i,j) \\in \\{(0,0), (1,0), (0,1), (2,0), (0,2)\\}$. The integrals are non-zero only for $i=0$ and $j=0$. Thus, only the $a_{00}$ term survives.\n    $$\n    \\bar{\\phi} = \\frac{1}{4} a_{00} \\left(\\int_{-1}^{1} P_0(x)dx\\right) \\left(\\int_{-1}^{1} P_0(y)dy\\right) = \\frac{1}{4} a_{00} (2)(2) = a_{00}\n    $$\n    Given $\\bar{\\phi} = 1.10$, we have our first coefficient:\n    $$\n    a_{00} = 1.10\n    $$\n\n2.  **Face-Averaged Fluxes $\\bar{\\phi}_{x\\pm}$**\n    The face-averaged fluxes on the faces at $x = \\pm 1$ are:\n    $$\n    \\bar{\\phi}_{x\\pm} = \\frac{1}{2} \\int_{-1}^{1} \\phi(\\pm 1, y)\\,dy\n    $$\n    We evaluate $\\phi(\\pm 1, y)$ using $P_0(\\pm 1)=1$, $P_1(\\pm 1)=\\pm 1$, and $P_2(\\pm 1)=1$:\n    $$\n    \\phi(\\pm 1, y) = a_{00}P_0(y) \\pm a_{10}P_0(y) + a_{01}P_1(y) + a_{20}P_0(y) + a_{02}P_2(y)\n    $$\n    $$\n    \\phi(\\pm 1, y) = (a_{00} \\pm a_{10} + a_{20})P_0(y) + a_{01}P_1(y) + a_{02}P_2(y)\n    $$\n    Integrating over $y \\in [-1,1]$ causes terms with $P_1(y)$ and $P_2(y)$ to vanish:\n    $$\n    \\bar{\\phi}_{x\\pm} = \\frac{1}{2} (a_{00} \\pm a_{10} + a_{20}) \\int_{-1}^{1} P_0(y) dy = \\frac{1}{2} (a_{00} \\pm a_{10} + a_{20}) (2) = a_{00} \\pm a_{10} + a_{20}\n    $$\n    This yields a system of two equations:\n    $$\n    \\bar{\\phi}_{x+} = a_{00} + a_{10} + a_{20} = 1.45\n    $$\n    $$\n    \\bar{\\phi}_{x-} = a_{00} - a_{10} + a_{20} = 1.15\n    $$\n\n3.  **Face-Averaged Fluxes $\\bar{\\phi}_{y\\pm}$**\n    By symmetry, for the faces at $y = \\pm 1$:\n    $$\n    \\bar{\\phi}_{y\\pm} = a_{00} \\pm a_{01} + a_{02}\n    $$\n    This yields another system of two equations:\n    $$\n    \\bar{\\phi}_{y+} = a_{00} + a_{01} + a_{02} = 1.45\n    $$\n    $$\n    \\bar{\\phi}_{y-} = a_{00} - a_{01} + a_{02} = 1.35\n    $$\n\n4.  **Transverse Leakages $L_x(y)$ and $L_y(x)$**\n    The transverse leakage in the $y$-direction is:\n    $$\n    L_y(x) = -D \\frac{1}{2} \\int_{-1}^{1} \\frac{\\partial^2\\phi(x,y)}{\\partial x^2} dy\n    $$\n    First, we find the second derivative of $\\phi$ with respect to $x$. Note that $P_0''(x) = 0$, $P_1''(x)=0$, and $P_2''(x) = \\frac{d^2}{dx^2}(\\frac{3x^2-1}{2}) = 3$.\n    $$\n    \\frac{\\partial^2\\phi}{\\partial x^2} = a_{20} P_2''(x) P_0(y) = 3 a_{20} P_0(y)\n    $$\n    Substituting this into the leakage definition:\n    $$\n    L_y(x) = -D \\frac{1}{2} \\int_{-1}^{1} 3 a_{20} P_0(y) dy = -D \\frac{3 a_{20}}{2} (2) = -3 D a_{20}\n    $$\n    Given $D=1$ and $L_y(x) = -0.6$, we can find $a_{20}$:\n    $$\n    -0.6 = -3(1)a_{20} \\implies a_{20} = \\frac{0.6}{3} = 0.2\n    $$\n    By symmetry, the transverse leakage in the $x$-direction is:\n    $$\n    L_x(y) = -3 D a_{02}\n    $$\n    Given $L_x(y) = -0.9$, we find $a_{02}$:\n    $$\n    -0.9 = -3(1)a_{02} \\implies a_{02} = \\frac{0.9}{3} = 0.3\n    $$\n\nNow we have determined $a_{00} = 1.10$, $a_{20} = 0.2$, and $a_{02} = 0.3$. We can use these values to find $a_{10}$ and $a_{01}$.\n\nFrom the $\\bar{\\phi}_{x\\pm}$ equations, subtracting the second from the first gives:\n$$\n\\bar{\\phi}_{x+} - \\bar{\\phi}_{x-} = (a_{00} + a_{10} + a_{20}) - (a_{00} - a_{10} + a_{20}) = 2 a_{10}\n$$\n$$\na_{10} = \\frac{\\bar{\\phi}_{x+} - \\bar{\\phi}_{x-}}{2} = \\frac{1.45 - 1.15}{2} = \\frac{0.30}{2} = 0.15\n$$\n\nFrom the $\\bar{\\phi}_{y\\pm}$ equations, a similar subtraction gives:\n$$\n\\bar{\\phi}_{y+} - \\bar{\\phi}_{y-} = (a_{00} + a_{01} + a_{02}) - (a_{00} - a_{01} + a_{02}) = 2 a_{01}\n$$\n$$\na_{01} = \\frac{\\bar{\\phi}_{y+} - \\bar{\\phi}_{y-}}{2} = \\frac{1.45 - 1.35}{2} = \\frac{0.10}{2} = 0.05\n$$\n\nThe five coefficients are therefore:\n$a_{00} = 1.10$\n$a_{10} = 0.15$\n$a_{01} = 0.05$\n$a_{20} = 0.2$\n$a_{02} = 0.3$\n\nThe final answer is the set of these coefficients arranged in a row matrix as specified.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.1 & 0.15 & 0.05 & 0.2 & 0.3 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "After defining the flux representation inside each node, the next critical step is to connect adjacent nodes to model the entire system. This coupling is achieved by enforcing the continuity of neutron current across shared nodal interfaces. This exercise introduces the concept of partial currents, which elegantly describe the flow of neutrons into and out of a node, and guides you to apply the principle of neutron conservation to ensure that no particles are artificially lost or gained at these interfaces .",
            "id": "4260120",
            "problem": "Consider a one-energy-group, steady-state neutron transport model for a Cartesian discretization used in the Variational Nodal Method (VNM) in nuclear reactor simulation. Let a node be a rectangular prism of unit thickness whose four lateral faces have equal area. For each face, define the outward unit normal as $\\mathbf{n}_f$ pointing out of the node, and define the face-averaged half-range (partial) currents\n$$\nj^{+}_{f} \\equiv \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f > 0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A, \\quad\nj^{-}_{f} \\equiv \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f < 0} |\\mathbf{\\Omega}\\cdot\\mathbf{n}_f|\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A,\n$$\nwhere $\\psi(\\mathbf{r},\\mathbf{\\Omega})$ is the angular neutron flux, $A_f$ is the face area, and $\\mathbf{\\Omega}$ is the direction unit vector.\n\nYou are given two adjacent nodes, $\\mathcal{N}_1$ and $\\mathcal{N}_2$, that share a vertical face. Each lateral face has area $A_f = 100$ (square centimeters), and the node thickness is $1$ (centimeter), so the face-integrated net current across face $f$ of node $\\mathcal{N}_i$ is $A_f\\left(j^{+}_{i,f} - j^{-}_{i,f}\\right)$ in neutrons per second. For node $\\mathcal{N}_1$, the face-averaged partial currents (in neutrons per square centimeter per second) are specified as:\n$$\nj^{+}_{1,W} = 1.80, \\quad j^{-}_{1,W} = 2.10, \\quad\nj^{+}_{1,E} = 4.20, \\quad j^{-}_{1,E} = 5.00,\n$$\n$$\nj^{+}_{1,N} = 3.50, \\quad j^{-}_{1,N} = 3.40, \\quad\nj^{+}_{1,S} = 2.75, \\quad j^{-}_{1,S} = 2.55.\n$$\nThe shared face is the east face of $\\mathcal{N}_1$ and the west face of $\\mathcal{N}_2$. By interface coupling and consistent orientation, the outgoing partial current from $\\mathcal{N}_1$ across the shared face equals the incoming partial current to $\\mathcal{N}_2$ across that face, and vice versa:\n$$\nj^{+}_{1,E} = j^{-}_{2,W}, \\qquad j^{-}_{1,E} = j^{+}_{2,W}.\n$$\n\nStarting from the steady-state neutron balance and the divergence theorem, derive the expression for the net leakage $L_1$ from node $\\mathcal{N}_1$ in terms of its face-averaged partial currents and areas, then compute $L_1$ using the given data. Next, verify global conservation across the shared interface by computing the interface conservation residual\n$$\nR \\equiv A_f\\Big[\\big(j^{+}_{1,E} - j^{-}_{1,E}\\big) + \\big(j^{+}_{2,W} - j^{-}_{2,W}\\big)\\Big]\n$$\nusing the coupling equalities above.\n\nExpress both $L_1$ and $R$ in neutrons per second. The final answer must be the ordered pair $\\big(L_1,\\,R\\big)$ written as a single row matrix. No rounding is required.",
            "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. All necessary data and definitions for the one-group, steady-state neutron transport model are provided. The concepts of partial currents, net leakage, and interface coupling are standard in nodal methods for nuclear reactor analysis.\n\nFirst, we derive the expression for the net leakage $L_1$ from node $\\mathcal{N}_1$. The net leakage is defined as the total number of neutrons flowing out of the node's volume per unit time. This is given by the integral of the net current vector $\\mathbf{J}(\\mathbf{r})$ over the entire surface $\\partial V_1$ of the node.\n$$\nL_1 = \\oint_{\\partial V_1} \\mathbf{J}(\\mathbf{r}) \\cdot \\mathbf{n} \\, \\mathrm{d}A\n$$\nwhere $\\mathbf{n}$ is the outward unit normal vector on the surface element $\\mathrm{d}A$. The net current vector is defined as the angular integral of the direction vector $\\mathbf{\\Omega}$ weighted by the angular flux $\\psi(\\mathbf{r}, \\mathbf{\\Omega})$:\n$$\n\\mathbf{J}(\\mathbf{r}) = \\int_{4\\pi} \\mathbf{\\Omega} \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\, \\mathrm{d}\\Omega\n$$\nThe surface integral can be expressed as a sum over the faces of the node. For a one-group, 2D Cartesian model, we consider the four lateral faces: East ($E$), West ($W$), North ($N$), and South ($S$).\n$$\nL_1 = \\sum_{f \\in \\{E,W,N,S\\}} \\int_{A_f} \\mathbf{J}(\\mathbf{r}) \\cdot \\mathbf{n}_f \\, \\mathrm{d}A\n$$\nwhere $\\mathbf{n}_f$ is the outward normal for face $f$. The term $\\int_{A_f} \\mathbf{J}(\\mathbf{r}) \\cdot \\mathbf{n}_f \\, \\mathrm{d}A$ is the face-integrated net current across face $f$. Let's relate this to the given face-averaged partial currents, $j^{+}_{f}$ and $j^{-}_{f}$.\n\nThe face-averaged net current for face $f$ is given by:\n$$\n\\bar{J}_f = \\frac{1}{A_f} \\int_{A_f} \\left( \\int_{4\\pi} \\mathbf{\\Omega} \\cdot \\mathbf{n}_f \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\, \\mathrm{d}\\Omega \\right) \\mathrm{d}A\n$$\nWe can split the angular integral over two hemispheres: one where neutrons move outward ($\\mathbf{\\Omega} \\cdot \\mathbf{n}_f > 0$) and one where they move inward ($\\mathbf{\\Omega} \\cdot \\mathbf{n}_f < 0$).\n$$\n\\bar{J}_f = \\frac{1}{A_f} \\int_{A_f} \\left( \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f > 0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega + \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f < 0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega \\right) \\mathrm{d}A\n$$\nThe first term is, by definition, the face-averaged outgoing partial current, $j^{+}_{f}$:\n$$\nj^{+}_{f} = \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f > 0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A\n$$\nThe second term can be related to the face-averaged incoming partial current, $j^{-}_{f}$. The definition given is:\n$$\nj^{-}_{f} = \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f < 0} |\\mathbf{\\Omega}\\cdot\\mathbf{n}_f|\\,\\psi(\\mathbf{r},\\mathbf{\\Omega}) \\,\\mathrm{d}\\Omega\\,\\mathrm{d}A\n$$\nFor the inward hemisphere where $\\mathbf{\\Omega}\\cdot\\mathbf{n}_f < 0$, we have $|\\mathbf{\\Omega}\\cdot\\mathbf{n}_f| = -(\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)$. Therefore:\n$$\nj^{-}_{f} = \\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f < 0} -(\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega\\,\\mathrm{d}A = -\\frac{1}{A_f} \\int_{A_f} \\int_{\\mathbf{\\Omega}\\cdot\\mathbf{n}_f < 0} (\\mathbf{\\Omega}\\cdot\\mathbf{n}_f)\\,\\psi\\,\\mathrm{d}\\Omega\\,\\mathrm{d}A\n$$\nThus, the second term in the expression for $\\bar{J}_f$ is equal to $-j^{-}_{f}$. The face-averaged net current is:\n$$\n\\bar{J}_f = j^{+}_{f} - j^{-}_{f}\n$$\nThe face-integrated net current across face $f$ is $A_f \\bar{J}_f = A_f(j^{+}_{f} - j^{-}_{f})$. The total net leakage $L_1$ is the sum of these quantities over all four faces of node $\\mathcal{N}_1$:\n$$\nL_1 = A_f(j^{+}_{1,E} - j^{-}_{1,E}) + A_f(j^{+}_{1,W} - j^{-}_{1,W}) + A_f(j^{+}_{1,N} - j^{-}_{1,N}) + A_f(j^{+}_{1,S} - j^{-}_{1,S})\n$$\nThis is the required expression. Now we compute its value using the given data for node $\\mathcal{N}_1$: $A_f = 100$ cm$^2$, and the partial currents are in neutrons/(cm$^2 \\cdot$s).\n\nContribution from each face:\n- East face: $j^{+}_{1,E} - j^{-}_{1,E} = 4.20 - 5.00 = -0.80$\n- West face: $j^{+}_{1,W} - j^{-}_{1,W} = 1.80 - 2.10 = -0.30$\n- North face: $j^{+}_{1,N} - j^{-}_{1,N} = 3.50 - 3.40 = 0.10$\n- South face: $j^{+}_{1,S} - j^{-}_{1,S} = 2.75 - 2.55 = 0.20$\n\nSumming the face-averaged net currents:\n$$\n\\sum_f (j^{+}_{1,f} - j^{-}_{1,f}) = (-0.80) + (-0.30) + (0.10) + (0.20) = -0.80\n$$\nNow, we calculate the total net leakage $L_1$:\n$$\nL_1 = A_f \\sum_f (j^{+}_{1,f} - j^{-}_{1,f}) = 100 \\times (-0.80) = -80\n$$\nThe unit is (cm$^2$) $\\times$ (neutrons/(cm$^2 \\cdot$s)) = neutrons/s. A negative value indicates a net influx of neutrons into the node.\n\nNext, we compute the interface conservation residual $R$. The definition is:\n$$\nR \\equiv A_f\\Big[\\big(j^{+}_{1,E} - j^{-}_{1,E}\\big) + \\big(j^{+}_{2,W} - j^{-}_{2,W}\\big)\\Big]\n$$\nThis quantity represents the sum of the face-integrated net currents from both sides of the shared interface. The term $(j^{+}_{1,E} - j^{-}_{1,E})$ is the net current out of node $\\mathcal{N}_1$ through its east face. The term $(j^{+}_{2,W} - j^{-}_{2,W})$ is the net current out of node $\\mathcal{N}_2$ through its west face. By conservation, the net flow across the interface must be continuous, meaning the flow out of $\\mathcal{N}_1$ should equal the flow into $\\mathcal{N}_2$. Since the outward normals are opposite ($\\mathbf{n}_{1,E} = -\\mathbf{n}_{2,W}$), the sum of outward-flowing net currents from both sides should be zero.\n\nThe problem provides the interface coupling equalities, which enforce this continuity:\n$$\nj^{+}_{1,E} = j^{-}_{2,W}\n$$\n$$\nj^{-}_{1,E} = j^{+}_{2,W}\n$$\nWe substitute these into the expression for $R$:\n$$\nR = A_f\\Big[\\big(j^{+}_{1,E} - j^{-}_{1,E}\\big) + \\big(j^{-}_{1,E} - j^{+}_{1,E}\\big)\\Big]\n$$\nRearranging the terms inside the bracket:\n$$\nR = A_f\\Big[(j^{+}_{1,E} - j^{+}_{1,E}) + (-j^{-}_{1,E} + j^{-}_{1,E})\\Big] = A_f\\Big[0 + 0\\Big] = 0\n$$\nThe residual is identically zero, which confirms that the problem is formulated to ensure global neutron conservation across the nodal interface. The numerical values for the east face currents of $\\mathcal{N}_1$ are not needed to find $R$, as it is zero by the structure of the coupling conditions.\n\nThe final answer is the ordered pair $(L_1, R)$.\n$$\nL_1 = -80 \\text{ neutrons/s}\n$$\n$$\nR = 0 \\text{ neutrons/s}\n$$\nThe ordered pair is $(-80, 0)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-80 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A key advantage of VNM is the ability to achieve high accuracy by increasing the polynomial degree ($p$) of the flux expansion, a technique known as $p$-refinement. However, this power comes with a numerical cost: the potential for the system matrix to become ill-conditioned, making it difficult to solve accurately. This problem explores the mathematical origins of this behavior and introduces a physically-motivated scaling strategy to mitigate it, providing critical insight into the numerical stability of high-order methods .",
            "id": "4260080",
            "problem": "Consider a one-dimensional node of width $h$ in a reactor core where a single energy group steady-state neutron diffusion equation is solved using the Variational Nodal Method (VNM). Assume constant material properties within the node: diffusion coefficient $D > 0$ and absorption cross section $\\Sigma_a > 0$. The local trial space within the node is the span of polynomials of degree at most $p$ mapped from the reference interval $[-1,1]$ to the physical node via $x = x_c + \\tfrac{h}{2}\\,\\xi$, where $\\xi \\in [-1,1]$ and $x_c$ is the node center. The local bilinear form for functions $u$ and $v$ over the node is\n$$\na(u,v) = \\int_{x_c - h/2}^{x_c + h/2} D\\,\\frac{du}{dx}\\,\\frac{dv}{dx}\\,dx \\;+\\; \\int_{x_c - h/2}^{x_c + h/2} \\Sigma_a\\,u\\,v\\,dx.\n$$\nLet the local stiffness matrix $\\mathbf{K}$ be the matrix representation of $a(\\cdot,\\cdot)$ in a chosen polynomial basis of degree at most $p$ on the node. You may assume standard mapping identities for derivatives, namely $\\tfrac{d}{dx} = \\tfrac{2}{h}\\tfrac{d}{d\\xi}$, and that the $L^2$ inner product over the physical node scales with the Jacobian factor $\\tfrac{h}{2}$ from the reference interval. Using these fundamentals only, reason about how increasing the polynomial order $p$ affects the conditioning of $\\mathbf{K}$, and propose a physically meaningful scaling that mitigates the ill-conditioning without altering the underlying physics.\n\nSelect the option that most accurately characterizes the asymptotic dependence of the condition number $\\kappa(\\mathbf{K})$ on $p$ and $h$, and provides a justified scaling strategy.\n\nA. $\\kappa(\\mathbf{K})$ grows like $\\mathcal{O}\\!\\left(\\dfrac{p^2}{h^2}\\right)$, with leading behavior approximately\n$$\n\\kappa(\\mathbf{K}) \\approx 1 + \\frac{4D}{\\Sigma_a h^2}\\,p(p+1),\n$$\nand a robust mitigation is energy-norm diagonal scaling in a modal polynomial basis: scale the mode of order $n$ by $s_n = \\left[\\Sigma_a\\,\\tfrac{h}{2} + D\\,\\tfrac{2}{h}\\,n(n+1)\\right]^{-1/2}$ so that derivative and absorption contributions are balanced across orders.\n\nB. $\\kappa(\\mathbf{K})$ grows linearly in $p$ as $\\mathcal{O}\\!\\left(\\dfrac{p}{h}\\right)$, and mass-lumping alone (replacing the consistent mass by a diagonal $\\mathbf{M}$) eliminates order-dependent ill-conditioning without any order-dependent scaling.\n\nC. $\\kappa(\\mathbf{K})$ grows quartically as $\\mathcal{O}\\!\\left(p^4\\right)$ independent of $h$, and the only practical remedy is mesh refinement to enforce $h \\sim p^{-2}$; no diagonal or modal scaling can materially reduce the condition number.\n\nD. $\\kappa(\\mathbf{K})$ is independent of $p$ when using Legendre polynomial bases on the reference interval, so no scaling is necessary beyond mapping by $h$.",
            "solution": "The user wants an analysis of the conditioning of the local stiffness matrix in the Variational Nodal Method (VNM) and a suitable mitigation strategy.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens:**\n-   **Equation:** Single energy group, steady-state neutron diffusion equation.\n-   **Methodology:** Variational Nodal Method (VNM) on a one-dimensional node.\n-   **Node Geometry:** Width $h$.\n-   **Material Properties:** Constant diffusion coefficient $D > 0$, constant absorption cross section $\\Sigma_a > 0$.\n-   **Trial Space:** Polynomials of degree at most $p$ on the node.\n-   **Coordinate Mapping:** From reference interval $\\xi \\in [-1,1]$ to physical node `x`, given by $x = x_c + \\tfrac{h}{2}\\,\\xi$.\n-   **Mapping Identities:** $\\tfrac{d}{dx} = \\tfrac{2}{h}\\tfrac{d}{d\\xi}$, and the integral measure transforms as $dx = \\tfrac{h}{2}d\\xi$.\n-   **Bilinear Form:** \n    $$\n    a(u,v) = \\int_{x_c - h/2}^{x_c + h/2} D\\,\\frac{du}{dx}\\,\\frac{dv}{dx}\\,dx \\;+\\; \\int_{x_c - h/2}^{x_c + h/2} \\Sigma_a\\,u\\,v\\,dx.\n    $$\n-   **Matrix Definition:** $\\mathbf{K}$ is the local stiffness matrix, representing $a(\\cdot,\\cdot)$ in a polynomial basis of degree at most $p$.\n\n**1.2. Validate Using Extracted Givens:**\n1.  **Scientifically Grounded:** The problem is firmly rooted in the numerical solution of partial differential equations (specifically, the neutron diffusion equation) using high-order finite element methods. The bilinear form $a(u,v)$ correctly represents the weak form of the operator $(-D\\frac{d^2}{dx^2} + \\Sigma_a)$. This is a standard formulation in reactor physics and numerical analysis.\n2.  **Well-Posed:** The question asks for the asymptotic behavior of the condition number of a matrix derived from a well-defined, positive-definite bilinear form. This is a standard and solvable problem in numerical analysis for `p`-version finite element methods.\n3.  **Objective:** The language is technical, precise, and free of subjective content.\n\n**1.3. Verdict:**\nThe problem statement is valid. It is a well-posed, scientifically sound problem in the numerical analysis of PDEs relevant to nuclear engineering.\n\n### Step 2: Solution Derivation\n\nThe analysis proceeds by transforming the bilinear form to the reference interval, selecting a suitable basis to analyze the matrix properties, and then determining the asymptotic behavior of the matrix eigenvalues.\n\n**2.1. Transformation to Reference Interval:**\nLet $u(\\xi)$ and $v(\\xi)$ be polynomial functions on the reference interval $[-1,1]$. Using the given mapping rules, we transform the bilinear form $a(u,v)$:\n$$\na(u,v) = \\int_{-1}^{1} D \\left(\\frac{2}{h}\\frac{du}{d\\xi}\\right) \\left(\\frac{2}{h}\\frac{dv}{d\\xi}\\right) \\left(\\frac{h}{2}d\\xi\\right) + \\int_{-1}^{1} \\Sigma_a u v \\left(\\frac{h}{2}d\\xi\\right)\n$$\n$$\na(u,v) = \\frac{2D}{h} \\int_{-1}^{1} \\frac{du}{d\\xi}\\frac{dv}{d\\xi} d\\xi + \\frac{\\Sigma_a h}{2} \\int_{-1}^{1} u v d\\xi\n$$\nThe bilinear form is a sum of two components: a stiffness term (involving derivatives) and a mass term (involving the functions themselves). The local stiffness matrix $\\mathbf{K}$ is the sum of the corresponding stiffness matrix $\\mathbf{S}$ and mass matrix $\\mathbf{M}$.\n$$\n\\mathbf{K} = \\mathbf{S} + \\mathbf{M}\n$$\nwhere `S` arises from the term scaled by $2D/h$ and `M` from the term scaled by $\\Sigma_a h/2$.\n\n**2.2. Eigenvalue Analysis:**\nTo analyze the condition number $\\kappa(\\mathbf{K}) = \\lambda_{\\max}(\\mathbf{K})/\\lambda_{\\min}(\\mathbf{K})$, we analyze the eigenvalues. The most convenient basis for this analysis is a basis of orthogonal polynomials on $[-1,1]$, such as the Legendre polynomials, $P_n(\\xi)$. Let us choose a basis $\\{\\phi_n\\}_{n=0}^p$ that is orthonormal with respect to the $L^2$ inner product on $[-1,1]$, i.e., $\\int_{-1}^1 \\phi_n \\phi_m d\\xi = \\delta_{nm}$. For example, $\\phi_n(\\xi) = \\sqrt{\\frac{2n+1}{2}}P_n(\\xi)$.\n\nIn this basis, the mass matrix $\\mathbf{M}$ becomes diagonal:\n$$\nM_{nm} = \\frac{\\Sigma_a h}{2} \\int_{-1}^{1} \\phi_n \\phi_m d\\xi = \\frac{\\Sigma_a h}{2} \\delta_{nm}\n$$\nSo, the mass matrix is $\\mathbf{M} = \\frac{\\Sigma_a h}{2}\\mathbf{I}$, where $\\mathbf{I}$ is the identity matrix.\n\nThe stiffness matrix $\\mathbf{S}$ has entries:\n$$\nS_{nm} = \\frac{2D}{h} \\int_{-1}^{1} \\frac{d\\phi_n}{d\\xi}\\frac{d\\phi_m}{d\\xi} d\\xi\n$$\nThis matrix, $\\mathbf{S}$, is not diagonal. However, in such a hierarchical, modal basis, it is known that the eigenvalues of the reference stiffness matrix part, let's call it $\\mathbf{S}'$ with entries $\\int \\phi_n'\\phi_m' d\\xi$, are well-approximated and scale with the polynomial order. Specifically, the eigenvalues of $\\mathbf{S}'$, which we denote $\\lambda_n(\\mathbf{S}')$, behave as $\\lambda_n(\\mathbf{S'}) \\approx n(n+1)$ for $n=0, 1, ..., p$. Note that for the constant basis function $\\phi_0$, the derivative is zero, so $\\lambda_0(\\mathbf{S'}) = 0$.\n\nThe matrices $\\mathbf{S}$ and $\\mathbf{M}$ are not simultaneously diagonalizable, but their sum $\\mathbf{K}$ has eigenvalues that can be approximated by the sum of their individual eigenvalues, which is a reasonable approximation for this analysis.\n$$\n\\lambda_n(\\mathbf{K}) \\approx \\lambda_n(\\mathbf{S}) + \\lambda_n(\\mathbf{M})\n$$\n$$\n\\lambda_n(\\mathbf{K}) \\approx \\frac{2D}{h} \\lambda_n(\\mathbf{S}') + \\frac{\\Sigma_a h}{2}\n$$\nUsing the approximation $\\lambda_n(\\mathbf{S}') \\approx n(n+1)$, we have:\n$$\n\\lambda_n(\\mathbf{K}) \\approx \\frac{2D}{h} n(n+1) + \\frac{\\Sigma_a h}{2}\n$$\nThe smallest eigenvalue corresponds to the lowest order mode, $n=0$:\n$$\n\\lambda_{\\min}(\\mathbf{K}) = \\lambda_0(\\mathbf{K}) \\approx \\frac{2D}{h} (0) + \\frac{\\Sigma_a h}{2} = \\frac{\\Sigma_a h}{2}\n$$\nThe largest eigenvalue corresponds to the highest order mode, $n=p$:\n$$\n\\lambda_{\\max}(\\mathbf{K}) = \\lambda_p(\\mathbf{K}) \\approx \\frac{2D}{h} p(p+1) + \\frac{\\Sigma_a h}{2}\n$$\n\n**2.3. Condition Number and Asymptotic Behavior:**\nThe condition number $\\kappa(\\mathbf{K})$ is the ratio of the maximum to minimum eigenvalue:\n$$\n\\kappa(\\mathbf{K}) = \\frac{\\lambda_{\\max}(\\mathbf{K})}{\\lambda_{\\min}(\\mathbf{K})} \\approx \\frac{\\frac{2D}{h} p(p+1) + \\frac{\\Sigma_a h}{2}}{\\frac{\\Sigma_a h}{2}}\n$$\n$$\n\\kappa(\\mathbf{K}) \\approx \\frac{2D p(p+1)}{h(\\Sigma_a h/2)} + 1 = 1 + \\frac{4D}{\\Sigma_a h^2} p(p+1)\n$$\nFor large $p$, the asymptotic behavior of the condition number is $\\mathcal{O}\\!\\left(\\frac{p^2}{h^2}\\right)$.\n\n**2.4. Mitigation Strategy:**\nThe ill-conditioning arises because the eigenvalues $\\lambda_n(\\mathbf{K})$ are spread over a wide range, growing quadratically with $n$. A robust mitigation strategy is to precondition the matrix $\\mathbf{K}$. A simple and effective method is diagonal scaling, also known as Jacobi preconditioning. This is equivalent to scaling the basis functions.\nLet the new basis be $\\{\\hat{\\phi}_n\\}$, where $\\hat{\\phi}_n = s_n \\phi_n$. The goal is to choose the scaling factors $s_n$ such that the diagonal entries of the new stiffness matrix, $\\hat{K}_{nn} = a(\\hat{\\phi}_n, \\hat{\\phi}_n)$, are all approximately equal to $1$.\n$$\n\\hat{K}_{nn} = s_n^2 a(\\phi_n, \\phi_n) = s_n^2 K_{nn} \\approx s_n^2 \\lambda_n(\\mathbf{K})\n$$\nTo make $\\hat{K}_{nn} \\approx 1$, we must choose $s_n \\approx 1/\\sqrt{\\lambda_n(\\mathbf{K})}$.\nUsing our expression for $\\lambda_n(\\mathbf{K})$:\n$$\ns_n = \\left[\\frac{\\Sigma_a h}{2} + \\frac{2D}{h} n(n+1)\\right]^{-1/2}\n$$\nThis scaling corresponds to normalizing each basis mode in the \"energy norm\" defined by the bilinear form $a(\\cdot,\\cdot)$. It balances the low-order modes, dominated by absorption ($\\Sigma_a$), with the high-order modes, dominated by diffusion ($D$ and the $n(n+1)$ derivative term). This does not change the underlying physics, as it is a preconditioning step that modifies the linear system to be solved numerically without changing its ultimate solution.\n\n### Step 3: Option-by-Option Analysis\n\n**A. $\\kappa(\\mathbf{K})$ grows like $\\mathcal{O}\\!\\left(\\dfrac{p^2}{h^2}\\right)$, with leading behavior approximately $\\kappa(\\mathbf{K}) \\approx 1 + \\frac{4D}{\\Sigma_a h^2}\\,p(p+1)$, and a robust mitigation is energy-norm diagonal scaling in a modal polynomial basis: scale the mode of order $n$ by $s_n = \\left[\\Sigma_a\\,\\tfrac{h}{2} + D\\,\\tfrac{2}{h}\\,n(n+1)\\right]^{-1/2}$ so that derivative and absorption contributions are balanced across orders.**\n-   The derived formula for $\\kappa(\\mathbf{K})$ and its asymptotic growth $\\mathcal{O}(p^2/h^2)$ match this option perfectly.\n-   The proposed scaling factor $s_n$ is precisely the inverse square root of the approximate $n$-th eigenvalue, which represents energy-norm scaling.\n-   The physical interpretation of balancing absorption and derivative contributions is correct.\n-   **Verdict: Correct.**\n\n**B. $\\kappa(\\mathbf{K})$ grows linearly in $p$ as $\\mathcal{O}\\!\\left(\\dfrac{p}{h}\\right)$, and mass-lumping alone (replacing the consistent mass by a diagonal $\\mathbf{M}$) eliminates order-dependent ill-conditioning without any order-dependent scaling.**\n-   The growth is not linear in $p$; it is quadratic (`\\mathcal{O}(p^2)`). The dependence on $h$ is `\\mathcal{O}(h^{-2})`, not `\\mathcal{O}(h^{-1})`.\n-   Mass lumping does not address the ill-conditioning from the stiffness matrix part, which is the dominant source of ill-conditioning for large `p`. For a Legendre basis, the mass matrix is already diagonal, so lumping is a moot point.\n-   **Verdict: Incorrect.**\n\n**C. $\\kappa(\\mathbf{K})$ grows quartically as $\\mathcal{O}\\!\\left(p^4\\right)$ independent of $h$, and the only practical remedy is mesh refinement to enforce $h \\sim p^{-2}$; no diagonal or modal scaling can materially reduce the condition number.**\n-   The growth is `\\mathcal{O}(p^2)`, not `\\mathcal{O}(p^4)`. The `\\mathcal{O}(p^4)` scaling applies to the condition number of the stiffness matrix *alone* under certain conditions, but not the full matrix `\\mathbf{K}` where the mass term regularizes the smallest eigenvalue.\n-   The claim of independence from $h$ is false; the condition number has a strong `\\mathcal{O}(h^{-2})` dependence.\n-   The claim that no scaling can help is false; diagonal scaling (Jacobi preconditioning) is a known and effective remedy.\n-   **Verdict: Incorrect.**\n\n**D. $\\kappa(\\mathbf{K})$ is independent of $p$ when using Legendre polynomial bases on the reference interval, so no scaling is necessary beyond mapping by $h$.**\n-   This is false. The eigenvalues of the stiffness part grow approximately as `n^2`, leading to a strong `p`-dependence (`\\mathcal{O}(p^2)`) in the condition number. Using a Legendre basis facilitates the analysis but does not eliminate the underlying mathematical source of the ill-conditioning.\n-   **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}