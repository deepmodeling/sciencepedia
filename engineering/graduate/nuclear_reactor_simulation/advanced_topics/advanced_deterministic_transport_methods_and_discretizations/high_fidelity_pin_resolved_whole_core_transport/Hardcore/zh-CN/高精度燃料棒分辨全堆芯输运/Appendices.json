{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的输运求解器之前，理解其与扩散理论等更简单模型之间的关系至关重要。本练习通过让您根据基本截面数据计算扩散系数 $D$，探索了连接输运与扩散的 $P_1$ 近似。通过分析该近似失效的物理条件，您将更深刻地体会到高保真输运模型在燃料棒级别分辨模拟中的必要性。",
            "id": "4230231",
            "problem": "在对压水堆（PWR）组件进行高保真棒级全堆芯输运计算时，考虑在燃料棒尺度下两个均匀化子区域（燃料芯块和慢化剂）内的单能群描述。控制定律是包含各向异性散射的、针对角通量 $ \\psi(\\mathbf{r}, \\mathbf{\\Omega}) $ 的稳态中子输运方程。作为一个经过充分检验的模型，微分散射截面被展开为Legendre多项式 $ P_\\ell(\\mu) $，得到前两个矩 $ \\Sigma_s^0 $ 和 $ \\Sigma_s^1 $，它们分别代表角积分散射及其一阶各向异性修正。在一阶球谐函数（P$_1$）近似下，输运截面定义为 $ \\Sigma_{tr} = \\Sigma_t - \\Sigma_s^1 $，并为中子流 $ \\mathbf{J}(\\mathbf{r}) $ 导出了Fick定律，其扩散系数为 $ D $，使得 $ \\mathbf{J}(\\mathbf{r}) \\approx - D \\nabla \\phi(\\mathbf{r}) $，其中 $ \\phi(\\mathbf{r}) $ 是标量通量 $ \\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\,\\mathrm{d}\\mathbf{\\Omega} $，$ \\mathbf{J}(\\mathbf{r}) = \\int_{4\\pi} \\mathbf{\\Omega} \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\,\\mathrm{d}\\mathbf{\\Omega} $。假设在块体区域，空间梯度足够平缓，使得P$_1$闭合在原理上是合理的，但界面和强非均匀性可能会挑战其有效性。\n\n给定燃料芯块和慢化剂的单群宏观截面，它们与 $ \\Sigma_t = \\Sigma_s^0 + \\Sigma_a $ 一致，其中 $ \\Sigma_t $ 是总宏观截面，$ \\Sigma_s^0 $ 是散射截面的零阶Legendre矩，$ \\Sigma_s^1 $ 是一阶Legendre矩，$ \\Sigma_a $ 是吸收宏观截面：\n- 燃料芯块：$ \\Sigma_t = 1.2\\,\\mathrm{cm}^{-1} $，$ \\Sigma_s^0 = 0.8\\,\\mathrm{cm}^{-1} $，$ \\Sigma_s^1 = 0.24\\,\\mathrm{cm}^{-1} $，$ \\Sigma_a = 0.4\\,\\mathrm{cm}^{-1} $。\n- 慢化剂：$ \\Sigma_t = 0.6\\,\\mathrm{cm}^{-1} $，$ \\Sigma_s^0 = 0.58\\,\\mathrm{cm}^{-1} $，$ \\Sigma_s^1 = 0.10\\,\\mathrm{cm}^{-1} $，$ \\Sigma_a = 0.02\\,\\mathrm{cm}^{-1} $。\n\n从中子输运方程和散射核的Legendre展开式出发，应用P$_1$近似，用输运截面表示扩散系数 $ D $，然后使用 $ D = 1/(3 \\Sigma_{tr}) $ 计算每个区域的 $ D $。基于关于P$_1$扩散近似何时有效的​​第一性原理推断，确定一个现实的棒级解析条件，在该条件下，$ D = 1/(3 \\Sigma_{tr}) $ 近似会因燃料棒尺度的吸收或各向异性效应而失效。\n\n在棒级解析的全堆芯背景下，哪个选项正确报告了两个区域的扩散系数，并指出了一个物理上合理的近似失效条件？\n\nA. 燃料 $ D \\approx 0.35\\,\\mathrm{cm} $，慢化剂 $ D \\approx 0.67\\,\\mathrm{cm} $；最可能在燃料-慢化剂界面和强吸收体（例如，控制棒通道）附近失效，因为燃料中的显著吸收以及由各向异性和流效应引起的显著角通量梯度违反了近各向同性假设。\n\nB. 燃料 $ D \\approx 0.42\\,\\mathrm{cm} $，慢化剂 $ D \\approx 0.50\\,\\mathrm{cm} $；在远离界面的慢化剂块体区域失效，因为那里的散射几乎是各向同性的，所以扩散无效。\n\nC. 燃料 $ D \\approx 0.35\\,\\mathrm{cm} $，慢化剂 $ D \\approx 0.67\\,\\mathrm{cm} $；仅在真空边界处失效，而内部燃料棒的非均匀性不会对P$_1$扩散闭合构成挑战。\n\nD. 燃料 $ D \\approx 0.83\\,\\mathrm{cm} $，慢化剂 $ D \\approx 0.40\\,\\mathrm{cm} $；只要 $ \\Sigma_s^1  0 $（背向散射），近似就会失效，即使吸收可忽略且梯度平滑。\n\nE. 燃料 $ D \\approx 0.35\\,\\mathrm{cm} $，慢化剂 $ D \\approx 0.67\\,\\mathrm{cm} $；只要系统反照率高，该近似在堆芯中处处有效，而与燃料棒尺度上的局部各向异性或吸收无关。",
            "solution": "起点是角通量 $ \\psi(\\mathbf{r}, \\mathbf{\\Omega}) $ 的稳态中子输运方程，\n$$\n\\mathbf{\\Omega} \\cdot \\nabla \\psi(\\mathbf{r}, \\mathbf{\\Omega}) + \\Sigma_t(\\mathbf{r}) \\psi(\\mathbf{r}, \\mathbf{\\Omega})\n= \\int_{4\\pi} \\sum_{\\ell=0}^{\\infty} \\frac{2\\ell+1}{4\\pi} \\Sigma_s^\\ell(\\mathbf{r}) P_\\ell(\\mathbf{\\Omega} \\cdot \\mathbf{\\Omega}') \\psi(\\mathbf{r}, \\mathbf{\\Omega}') \\,\\mathrm{d}\\mathbf{\\Omega}' + S(\\mathbf{r}, \\mathbf{\\Omega}) ,\n$$\n其中 $ \\Sigma_s^\\ell $ 是微分散射截面的Legendre矩，$ S $ 是源项。对角度进行积分得到零阶矩方程，乘以 $ \\mathbf{\\Omega} $ 并积分得到一阶矩方程。在一阶球谐函数（P$_1$）近似下，角通量展开在一阶处被截断。该闭合引入了Fick定律，它将中子流 $ \\mathbf{J}(\\mathbf{r}) = \\int_{4\\pi} \\mathbf{\\Omega}\\,\\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\,\\mathrm{d}\\mathbf{\\Omega} $ 与标量通量 $ \\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\,\\mathrm{d}\\mathbf{\\Omega} $ 的梯度通过以下方式联系起来\n$$\n\\mathbf{J}(\\mathbf{r}) \\approx - D(\\mathbf{r}) \\nabla \\phi(\\mathbf{r}) ,\n$$\n扩散系数由输运截面 $ \\Sigma_{tr}(\\mathbf{r}) $ 决定，\n$$\n\\Sigma_{tr}(\\mathbf{r}) \\equiv \\Sigma_t(\\mathbf{r}) - \\Sigma_s^1(\\mathbf{r}) ,\n\\qquad\nD(\\mathbf{r}) = \\frac{1}{3 \\Sigma_{tr}(\\mathbf{r})} .\n$$\n这个结果由矩方程和各向异性散射的Legendre表示得出，其中一阶矩 $ \\Sigma_s^1 $ 将总碰撞率修正为输运碰撞率，后者控制着中子的角向重定向和空间扩散。\n\n我们现在为每个区域数值计算 $ \\Sigma_{tr} $ 和 $ D $。\n\n燃料芯块：\n- 给定 $ \\Sigma_t = 1.2\\,\\mathrm{cm}^{-1} $ 和 $ \\Sigma_s^1 = 0.24\\,\\mathrm{cm}^{-1} $，输运截面为\n$$\n\\Sigma_{tr}^{(f)} = \\Sigma_t - \\Sigma_s^1 = 1.2 - 0.24 = 0.96\\,\\mathrm{cm}^{-1} .\n$$\n- 扩散系数为\n$$\nD^{(f)} = \\frac{1}{3 \\Sigma_{tr}^{(f)}} = \\frac{1}{3 \\times 0.96} = \\frac{1}{2.88} \\approx 0.3472\\,\\mathrm{cm} .\n$$\n因此，$ D^{(f)} \\approx 0.35\\,\\mathrm{cm} $。\n\n慢化剂：\n- 给定 $ \\Sigma_t = 0.6\\,\\mathrm{cm}^{-1} $ 和 $ \\Sigma_s^1 = 0.10\\,\\mathrm{cm}^{-1} $，输运截面为\n$$\n\\Sigma_{tr}^{(m)} = \\Sigma_t - \\Sigma_s^1 = 0.6 - 0.10 = 0.50\\,\\mathrm{cm}^{-1} .\n$$\n- 扩散系数为\n$$\nD^{(m)} = \\frac{1}{3 \\Sigma_{tr}^{(m)}} = \\frac{1}{3 \\times 0.50} = \\frac{1}{1.50} \\approx 0.6667\\,\\mathrm{cm} .\n$$\n因此，$ D^{(m)} \\approx 0.67\\,\\mathrm{cm} $。\n\n推导并计算出 $ D $ 后，我们评估P$_1$扩散近似在燃料棒尺度上的有效性条件。扩散近似假定：\n- 角通量近各向同性，意味着一阶各向异性矩的贡献 $ \\Sigma_s^1 $ 不会大到产生强烈的角向流效应，从而使 $ \\mathbf{J} \\approx -D \\nabla \\phi $ 失效。\n- 散射占优，即 $ \\Sigma_s^0 \\gg \\Sigma_a $，这样吸收就不会严重衰减和扭曲角通量。\n- 空间梯度 $ \\nabla \\phi $ 在一个远大于平均自由程 $ \\ell \\approx 1/\\Sigma_{tr} $ 的长度尺度 $ L $ 上变化，以便多次散射事件能在材料界面或几何特征之间使通量各向同性化。\n\n在此处的燃料区域中，吸收截面为 $ \\Sigma_a = 0.4\\,\\mathrm{cm}^{-1} $，散射截面为 $ \\Sigma_s^0 = 0.8\\,\\mathrm{cm}^{-1} $，因此 $ \\Sigma_a / \\Sigma_t = 0.4/1.2 \\approx 0.33 $ 且 $ \\Sigma_a / \\Sigma_s^0 = 0.4/0.8 = 0.5 $。如此强的吸收足以扭曲角通量并降低近各向同性假设的有效性。此外，$ \\Sigma_s^1 = 0.24\\,\\mathrm{cm}^{-1} $ 是一个不可忽略的各向异性修正，表明存在增强流效应的前向散射，尤其是在窄包壳和燃料-慢化剂界面处。燃料中的平均自由程为 $ \\ell^{(f)} \\approx 1/\\Sigma_{tr}^{(f)} \\approx 1/0.96 \\approx 1.04\\,\\mathrm{cm} $，这与界面附近的特征棒长尺度（例如，亚厘米级梯度）处于同一数量级或更大，局部违反了 $ L \\gg \\ell $ 的要求。\n\n在慢化剂中，$ \\Sigma_a $ ($ 0.02\\,\\mathrm{cm}^{-1} $) 相对于 $ \\Sigma_s^0 $ ($ 0.58\\,\\mathrm{cm}^{-1} $) 较小，且 $ \\Sigma_s^1 = 0.10\\,\\mathrm{cm}^{-1} $ 适中；扩散在块体区域更为合理。然而，在强吸收体（例如，控制棒）或大非均匀区（例如，导向管或空腔）附近，角通量梯度变得陡峭，近各向同性假设失效，即使在邻近这些特征的慢化剂中也是如此。因此，在棒级解析的设置中，近似最可能在燃料-慢化剂界面以及强吸收体或流效应通道附近失效。\n\n逐项分析：\n\nA. 报告 $ D^{(f)} \\approx 0.35\\,\\mathrm{cm} $ 和 $ D^{(m)} \\approx 0.67\\,\\mathrm{cm} $，与计算值相符。所述的失效条件指出了燃料-慢化剂界面和强吸收体或流效应特征附近的区域，其理由是燃料中的显著吸收和各向异性散射导致角通量梯度，从而在燃料棒尺度上使近各向同性假设失效。这与第一性原理的有效性判据一致。结论：正确。\n\nB. 报告 $ D^{(f)} \\approx 0.42\\,\\mathrm{cm} $ 和 $ D^{(m)} \\approx 0.50\\,\\mathrm{cm} $，与计算值不符。它还错误地断言，由于近各向同性散射，近似在远离界面的慢化剂块体区域失效；事实上，近各向同性散射支持扩散在块体区域的有效性。结论：不正确。\n\nC. 报告了正确的 $ D $ 值，但断言失效仅发生在真空边界，并否认了内部燃料棒非均匀性带来的挑战。这与分析相矛盾：由非均匀性引起的陡峭梯度以及在燃料-慢化剂界面和吸收体附近的局部各向异性，即使远离真空边界，也可以使扩散近似失效。结论：不正确。\n\nD. 报告 $ D^{(f)} \\approx 0.83\\,\\mathrm{cm} $ 和 $ D^{(m)} \\approx 0.40\\,\\mathrm{cm} $，这对应于在燃料中误用 $ \\Sigma_{tr} = \\Sigma_t - \\Sigma_s^0 $ 以及在慢化剂中存在其他不一致之处；这些不是正确的 $ D $ 值。其声称的失效标准“只要 $ \\Sigma_s^1  0 $”不是一个普遍的失效条件；如果吸收很小且梯度平滑，中等程度的背向散射本身并不会使扩散近似失效。结论：不正确。\n\nE. 报告了正确的 $ D $ 值，但声称只要系统反照率高，近似就普遍有效，而无需考虑局部各向异性或吸收。这忽略了基本的局部有效性判据（$ \\ell \\ll L $、近各向同性、散射占优）以及众所周知的扩散在强非均匀区和强吸收体附近的失效情况。结论：不正确。\n\n因此，正确选项是A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "模拟的“保真度”直接关系到其解析重要物理现象的能力，例如材料界面处的陡峭通量梯度。本练习提供了一种确定所需空间网格尺寸 $h$ 的实践方法。通过运用误差分析，将通量衰减的数值近似与期望的容差 $\\varepsilon$ 联系起来，您将学到确保燃料棒级别分辨输运计算准确性的一条基本原则。",
            "id": "4230234",
            "problem": "考虑一个压水反应堆（PWR）中燃料与慢化剂交界处的一根燃料棒。将该界面局部处理为一维平板，坐标 $x$ 垂直于界面，且 $x=0$ 位于材料边界处。假设输运过程是稳态、单能的，且界面两侧的材料是均匀的，因此沿直线特征线，角通量 $\\psi(x)$ 满足从玻尔兹曼输运方程推导出的线性一阶常微分方程。在具有恒定宏观总截面 $\\Sigma_{t}$ 的区域中，该方程的齐次解与 $\\exp(-\\Sigma_{t} x)$ 成正比。令平均自由程为 $\\ell = 1/\\Sigma_{t}$，单元光学厚度为 $\\tau = \\Sigma_{t} h = h/\\ell$，其中 $h$ 是垂直于界面的单元尺寸。\n\n你将在每种材料中使用 $p$ 次多项式基来表示单元内的通量，并要求对指数衰减的单元多项式近似具有足够的精度，以解析界面处从慢化剂到燃料的通量梯度。具体来说，通过将 $\\exp(-\\Sigma_{t} x)$ 在 $x \\in [0,h]$ 上的 $p$ 次泰勒近似的余项限制在容差 $\\varepsilon$ 内，来对每个单元中的绝对插值误差施加一个保守的界限。利用基于齐次解的指数衰减和泰勒余项界限的物理上合理的推理，估计允许的单元光学厚度 $\\tau$ 的上限，用 $p$ 和 $\\varepsilon$ 表示。然后，确定一个单一的均匀单元尺寸 $h$，该尺寸在界面附近的燃料和慢化剂中都满足此界限，并取两者中更严格的要求。\n\n使用以下数据：\n- 燃料宏观总截面：$\\Sigma_{t}^{\\text{fuel}} = 1.20~\\text{cm}^{-1}$。\n- 慢化剂宏观总截面：$\\Sigma_{t}^{\\text{mod}} = 0.30~\\text{cm}^{-1}$。\n- 多项式次数：$p = 3$。\n- 误差容限：$\\varepsilon = 1.0 \\times 10^{-3}$。\n\n将最终的单元尺寸四舍五入到四位有效数字。最终答案以厘米为单位表示。",
            "solution": "首先将验证问题的科学合理性、一致性和完整性。\n\n**第1步：提取已知条件**\n- 角通量 $\\psi(x)$ 满足从稳态、单能玻尔兹曼输运方程推导出的线性一阶常微分方程。\n- 在具有恒定宏观总截面 $\\Sigma_t$ 的区域中，齐次解与 $\\exp(-\\Sigma_t x)$ 成正比。\n- 界面位于 $x=0$。\n- 平均自由程：$\\ell = 1/\\Sigma_t$。\n- 单元光学厚度：$\\tau = \\Sigma_t h$，其中 $h$ 是单元尺寸。\n- 单元内的通量由 $p$ 次多项式基表示。\n- 多项式近似的误差通过将 $\\exp(-\\Sigma_t x)$ 在 $x \\in [0,h]$ 上的 $p$ 次泰勒近似的余项限制在容差 $\\varepsilon$ 内来控制。\n- 燃料宏观总截面：$\\Sigma_{t}^{\\text{fuel}} = 1.20~\\text{cm}^{-1}$。\n- 慢化剂宏观总截面：$\\Sigma_{t}^{\\text{mod}} = 0.30~\\text{cm}^{-1}$。\n- 多项式次数：$p = 3$。\n- 误差容限：$\\varepsilon = 1.0 \\times 10^{-3}$。\n- 必须确定一个单一的均匀单元尺寸 $h$，取燃料和慢化剂中更严格的要求。\n- 最终答案必须四舍五入到四位有效数字，并以厘米为单位表示。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于反应堆物理学中子输运方程的一个标准简化，具体是一维、单能、稳态情况。用多项式近似通量的指数衰减是求解输运方程的数值方法（如非连续有限元法）中的一项基本技术。所提供的截面值对于热中子反应堆是物理上现实的。该问题牢固地建立在核工程和数值分析的既定原则之上。\n- **适定性：** 该问题是适定的。它提供了所有必要的数据（$\\Sigma_t^{\\text{fuel}}$、$\\Sigma_t^{\\text{mod}}$、$p$、$\\varepsilon$）和一个明确的目标：根据指定的误差标准推导单元尺寸 $h$ 的界限。指令清晰明确，可以得出一个唯一、稳定且有意义的解。\n- **客观性：** 问题以精确、客观的语言陈述。它使用了反应堆物理学和数值分析的标准术语。没有主观或基于观点的陈述。\n\n该问题没有显示说明中列出的任何无效性缺陷。它是科学合理的、形式上明确的、完整的和客观的。\n\n**第3步：结论与行动**\n问题有效。将提供解答。\n\n问题的核心是确定最大单元尺寸 $h$，使得函数 $f(x) = \\exp(-\\Sigma_t x)$ 的 $p$ 次多项式近似在区间 $x \\in [0, h]$ 上的误差小于给定的容差 $\\varepsilon$。\n\n指定的方法是限制泰勒级数近似的余项。函数 $f(x)$ 在 $x=0$ 附近的泰勒展开式由下式给出：\n$$ f(x) = \\sum_{n=0}^{p} \\frac{f^{(n)}(0)}{n!} x^n + R_p(x) $$\n其中 $R_p(x)$ 是拉格朗日余项：\n$$ R_p(x) = \\frac{f^{(p+1)}(\\xi)}{(p+1)!} x^{p+1} $$\n对于某个 $\\xi \\in (0, x)$。\n\n我们的函数是 $f(x) = \\exp(-\\Sigma_t x)$。我们需要它的导数。其 $n$ 阶导数为：\n$$ f^{(n)}(x) = (-\\Sigma_t)^n \\exp(-\\Sigma_t x) $$\n因此，$(p+1)$ 阶导数为：\n$$ f^{(p+1)}(x) = (-\\Sigma_t)^{p+1} \\exp(-\\Sigma_t x) $$\n余项为：\n$$ R_p(x) = \\frac{(-\\Sigma_t)^{p+1} \\exp(-\\Sigma_t \\xi)}{(p+1)!} x^{p+1} $$\n我们必须找到该余项绝对值 $|R_p(x)|$ 在 $x \\in [0, h]$ 上的一个上界。\n$$ |R_p(x)| = \\left| \\frac{(-\\Sigma_t)^{p+1} \\exp(-\\Sigma_t \\xi)}{(p+1)!} x^{p+1} \\right| = \\frac{(\\Sigma_t)^{p+1}}{(p+1)!} \\exp(-\\Sigma_t \\xi) x^{p+1} $$\n为了在 $x \\in [0, h]$ 和 $\\xi \\in (0, x)$ 的范围内最大化此表达式，我们考虑 $\\exp(-\\Sigma_t \\xi)$ 和 $x^{p+1}$ 这两项。\n由于 $\\Sigma_t  0$ 且 $\\xi  0$，项 $\\exp(-\\Sigma_t \\xi)$ 是一个衰减指数函数。其在区间 $\\xi \\in (0,x)$ 上的最大值受 $1$ 的限制（当 $\\xi \\to 0$ 时）。\n项 $x^{p+1}$ 对于 $x  0$ 是单调递增的。其在区间 $x \\in [0, h]$ 上的最大值出现在 $x=h$ 处。\n因此，单元上误差的一个保守上界是：\n$$ \\max_{x \\in [0, h]} |R_p(x)| \\le \\frac{(\\Sigma_t)^{p+1}}{(p+1)!} (1) (h)^{p+1} = \\frac{(\\Sigma_t h)^{p+1}}{(p+1)!} $$\n问题将单元光学厚度定义为 $\\tau = \\Sigma_t h$。将此代入不等式，我们得到：\n$$ \\max_{x \\in [0, h]} |R_p(x)| \\le \\frac{\\tau^{p+1}}{(p+1)!} $$\n我们被要求强制这个最大误差小于或等于容差 $\\varepsilon$：\n$$ \\frac{\\tau^{p+1}}{(p+1)!} \\le \\varepsilon $$\n我们现在可以求解允许的最大光学厚度 $\\tau_{\\text{max}}$：\n$$ \\tau^{p+1} \\le \\varepsilon (p+1)! $$\n$$ \\tau \\le [\\varepsilon (p+1)!]^{\\frac{1}{p+1}} $$\n所以，$\\tau_{\\text{max}} = [\\varepsilon (p+1)!]^{\\frac{1}{p+1}}$。\n\n现在，我们代入给定的数值：$p=3$ 和 $\\varepsilon = 1.0 \\times 10^{-3}$。\n$$ p+1 = 4 $$\n$$ (p+1)! = 4! = 24 $$\n$$ \\tau_{\\text{max}} = [(1.0 \\times 10^{-3}) (24)]^{\\frac{1}{4}} = (0.024)^{\\frac{1}{4}} $$\n计算数值：\n$$ \\tau_{\\text{max}} \\approx 0.3935605 $$\n这是为满足3次多项式近似的精度要求，一个单元所允许的最大光学厚度。\n\n单元尺寸 $h$ 和光学厚度 $\\tau$ 之间的关系是 $h = \\tau / \\Sigma_t$。因此，允许的最大单元尺寸 $h_{\\text{max}}$ 是：\n$$ h_{\\text{max}} = \\frac{\\tau_{\\text{max}}}{\\Sigma_t} $$\n我们必须为燃料和慢化剂区域分别计算这个极限。\n\n对于燃料：\n$$ \\Sigma_{t}^{\\text{fuel}} = 1.20~\\text{cm}^{-1} $$\n$$ h_{\\text{max}}^{\\text{fuel}} = \\frac{\\tau_{\\text{max}}}{\\Sigma_{t}^{\\text{fuel}}} = \\frac{0.3935605}{1.20~\\text{cm}^{-1}} \\approx 0.3279671~\\text{cm} $$\n\n对于慢化剂：\n$$ \\Sigma_{t}^{\\text{mod}} = 0.30~\\text{cm}^{-1} $$\n$$ h_{\\text{max}}^{\\text{mod}} = \\frac{\\tau_{\\text{max}}}{\\Sigma_{t}^{\\text{mod}}} = \\frac{0.3935605}{0.30~\\text{cm}^{-1}} \\approx 1.311868~\\text{cm} $$\n\n问题要求一个单一的均匀单元尺寸 $h$ 在两个区域都满足界限。这意味着尺寸 $h$ 必须小于或等于 $h_{\\text{max}}^{\\text{fuel}}$ 和 $h_{\\text{max}}^{\\text{mod}}$。为了同时满足这两个条件，我们必须取两个上界中更严格（更小）的那个：\n$$ h \\le \\min(h_{\\text{max}}^{\\text{fuel}}, h_{\\text{max}}^{\\text{mod}}) $$\n$$ h \\le \\min(0.3279671~\\text{cm}, 1.311868~\\text{cm}) $$\n$$ h \\le 0.3279671~\\text{cm} $$\n因此，允许的最大均匀单元尺寸约为 $0.3279671~\\text{cm}$。总截面较高的材料（燃料）是限制因素，这在物理上是符合预期的，因为该区域的通量梯度最陡。\n\n最后，我们按照要求将结果四舍五入到四位有效数字。\n$$ h \\approx 0.3280~\\text{cm} $$",
            "answer": "$$\n\\boxed{0.3280}\n$$"
        },
        {
            "introduction": "执行燃料棒级别分辨的全堆芯输运计算不仅是一项物理挑战，也是一项重要的高性能计算（HPC）任务。本练习将引导您完成为输运求解器建立和验证并行性能模型的过程。通过将模型与扩展性数据进行拟合并预测运行时间，您将接触到使这些大规模模拟变得可行的实际HPC挑战。",
            "id": "4230245",
            "problem": "考虑使用特征线法 (MOC) 进行高保真燃料棒精细解析的全堆芯输运计算。该求解器针对每个方位角和能量群追踪直线光线，并将光线分成段，用以计算每个燃料棒区域内的相互作用。堆芯被分解为由 $P$ 个并行进程组成的二维笛卡尔子区域网格，进程排列为 $\\sqrt{P} \\times \\sqrt{P}$。为满足输运过程中的逆流依赖关系，采用了与 Koch–Baker–Alcouffe (KBA) 算法一致的波前扫描方案。假设除了波前的启动和排空阶段外，不同进程上的计算是并发进行的，并且扫描过程中的进程间通信会引入延迟和带宽成本，这些成本分别与波前阶段的数量和区域间界面的长度成比例。\n\n您将为一个覆盖所有方位角和能量群的输运扫描构建并使用一个性能模型，该模型用于计算挂钟运行时间 $T(P)$。您的推导应基于以下基本原则：\n- 总计算功与线段操作次数成正比，每线段每群的计算成本为常数。\n- 在 $\\sqrt{P} \\times \\sqrt{P}$ 分解中，启动和排空阶段的波前阶段数量与 $2\\sqrt{P} - 2$ 成比例。\n- 延迟按每个阶段累加，带宽成本与总界面长度成比例，对于固定的全局域尺寸，该长度与 $\\sqrt{P}$ 成正比。\n\n对于一个基准配置，$N_{a} = 8$，$N_{g} = 7$，$N_{r} = 2000$。每条光线平均包含 $s_{\\text{avg}} = 3000$ 个材料线段。因此，总线段数为 $S_{\\text{tot}} = N_{a} N_{r} s_{\\text{avg}}$。将每线段每群的计算成本记为 $c_{\\text{seg}}$（单位：秒），每阶段延迟记为 $\\alpha$（单位：秒），与带宽相关的每 $\\sqrt{P}$ 成本记为 $\\delta$（单位：秒）。对于基准配置，测得的强扩展挂钟时间为：\n- $T(16) = 2.5264$ 秒，\n- $T(64) = 0.6436$ 秒，\n- $T(256) = 0.1855$ 秒。\n\n假设计算功随 $S_{\\text{tot}}$ 和 $N_{g}$ 线性扩展，计算在 $P$ 个进程上理想并行化，并且通信参数 $\\alpha$ 和 $\\delta$ 不依赖于 $S_{\\text{tot}}$ 或 $N_{g}$。\n\n任务：\n1. 根据上述原则推导一个关于 $c_{\\text{seg}}$、$\\alpha$ 和 $\\delta$ 的线性性能模型 $T(P)$。\n2. 使用测量的时间，求解 $c_{\\text{seg}}$、$\\alpha$ 和 $\\delta$。\n3. 预测新配置下的运行时间 $T(P')$，其中 $P' = 512$，$N_{a}' = 16$，$N_{r}' = 2500$，$s_{\\text{avg}}' = 3000$，$N_{g}' = 7$。使用您确定的 $\\alpha$ 和 $\\delta$，并假设适用相同的 $c_{\\text{seg}}$。以秒为单位表示最终预测的运行时间。\n\n将您的最终数值答案四舍五入到四位有效数字。以秒为单位表示最终运行时间。",
            "solution": "在尝试解答之前，需对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n\n- **并行方案**：堆芯被分解为由 $P$ 个并行进程组成的二维笛卡尔网格，进程排列为 $\\sqrt{P} \\times \\sqrt{P}$。\n- **扫描算法**：使用 Koch–Baker–Alcouffe (KBA) 波前扫描。\n- **性能模型原则**：\n    1.  总计算功与线段操作次数成正比，每线段每群的计算成本为常数。\n    2.  启动和排空阶段的波前阶段数量与 $2\\sqrt{P} - 2$ 成比例。\n    3.  延迟按每个阶段累加。\n    4.  带宽成本与总界面长度成比例，该长度与 $\\sqrt{P}$ 成正比。\n- **符号**：\n    - $T(P)$：在 $P$ 个进程上进行一次输运扫描的挂钟运行时间。\n    - $N_a$：方位角数量。\n    - $N_g$：能量群数量。\n    - $N_r$：每个方位角的光线数。\n    - $s_{\\text{avg}}$：每条光线的平均材料线段数。\n    - $S_{\\text{tot}} = N_{a} N_{r} s_{\\text{avg}}$：总线段数。\n    - $c_{\\text{seg}}$：每线段每群的计算成本（秒）。\n    - $\\alpha$：每阶段延迟（秒）。\n    - $\\delta$：与带宽相关的每-$\\sqrt{P}$成本（秒）。\n- **假设**：\n    1.  计算在 $P$ 个进程上理想并行化。\n    2.  通信参数 $\\alpha$ 和 $\\delta$ 不依赖于 $S_{\\text{tot}}$ 或 $N_{g}$。\n    3.  计算成本 $c_{\\text{seg}}$ 在不同配置中保持不变。\n- **基准配置数据**：\n    - $N_a = 8$\n    - $N_g = 7$\n    - $N_r = 2000$\n    - $s_{\\text{avg}} = 3000$\n- **基准配置的实测运行时间**：\n    - $T(16) = 2.5264$ 秒\n    - $T(64) = 0.6436$ 秒\n    - $T(256) = 0.1855$ 秒\n- **新配置参数**：\n    - $P' = 512$\n    - $N_a' = 16$\n    - $N_r' = 2500$\n    - $s_{\\text{avg}}' = 3000$\n    - $N_g' = 7$\n- **任务**：\n    1.  推导一个关于 $c_{\\text{seg}}$、$\\alpha$ 和 $\\delta$ 的线性性能模型 $T(P)$。\n    2.  使用测量数据求解 $c_{\\text{seg}}$、$\\alpha$ 和 $\\delta$。\n    3.  预测新配置的运行时间 $T(P')$。\n- **输出要求**：将最终数值答案四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n\n根据指定标准对问题进行评估：\n- **科学性**：该问题描述了一个简化的但标准的并行输运扫描性能模型，用于核反应堆模拟（特别是二维笛卡尔网格上的KBA算法）。模型组件——可并行化功、随阶段数扩展的延迟以及随界面长度扩展的带宽——是高性能计算（HPC）性能建模中的标准概念，尤其适用于域分解的类模板计算。这些原则在HPC的背景下是有效的。\n- **适定性**：问题提供了一套清晰的原则来构建模型，足够数量的数据点（3个）来求解模型的未知参数（3个），以及一个明确的目标。该线性方程组存在唯一解。\n- **客观性**：语言精确且定量。所有术语都有定义，目标明确。\n\n该问题没有任何无效性缺陷。它在其领域内科学合理、可形式化、内容完整且结构良好。\n\n### 步骤3：结论与行动\n\n此问题是 **有效的**。将提供完整解答。\n\n### 任务1：性能模型的推导\n\n总挂钟时间 $T(P)$ 是并行计算时间 $T_{\\text{comp}}(P)$ 和通信开销 $T_{\\text{comm}}(P)$ 之和。\n\n$T(P) = T_{\\text{comp}}(P) + T_{\\text{comm}}(P)$\n\n总计算功 $W_{\\text{comp}}$ 是总线段操作次数乘以每次操作的成本。线段操作次数是总线段数 $S_{\\text{tot}}$ 与能量群数 $N_g$ 的乘积。\n$W_{\\text{comp}} = S_{\\text{tot}} \\cdot N_g \\cdot c_{\\text{seg}} = (N_a N_r s_{\\text{avg}}) N_g c_{\\text{seg}}$\n\n问题陈述指出，这项工作在 $P$ 个进程上理想并行化。因此，并行计算时间为：\n$T_{\\text{comp}}(P) = \\frac{W_{\\text{comp}}}{P} = \\frac{N_a N_r s_{\\text{avg}} N_g c_{\\text{seg}}}{P}$\n\n通信开销 $T_{\\text{comm}}(P)$ 由两部分组成：延迟和带宽。\n延迟成本与波前阶段的数量成正比，数量为 $2\\sqrt{P} - 2$，每阶段成本为 $\\alpha$。\n$T_{\\text{latency}}(P) = (2\\sqrt{P} - 2)\\alpha$\n\n带宽成本随界面长度扩展，该长度与 $\\sqrt{P}$ 成正比，比例常数为 $\\delta$。\n$T_{\\text{bandwidth}}(P) = \\sqrt{P}\\delta$\n\n总通信开销是两者之和：\n$T_{\\text{comm}}(P) = T_{\\text{latency}}(P) + T_{\\text{bandwidth}}(P) = (2\\sqrt{P} - 2)\\alpha + \\sqrt{P}\\delta$\n\n结合计算项和通信项，得到最终的性能模型，该模型对参数 $c_{\\text{seg}}$、$\\alpha$ 和 $\\delta$ 是线性的：\n$T(P) = \\frac{N_a N_r s_{\\text{avg}} N_g}{P} c_{\\text{seg}} + (2\\sqrt{P} - 2)\\alpha + \\sqrt{P}\\delta$\n\n### 任务2：求解模型参数\n\n对于基准配置，计算功系数计算如下：\n$W_{\\text{coeff}} = N_a N_r s_{\\text{avg}} N_g = (8)(2000)(3000)(7) = 336,000,000 = 3.36 \\times 10^8$。\n\n模型为 $T(P) = \\frac{3.36 \\times 10^8}{P} c_{\\text{seg}} + (2\\sqrt{P} - 2)\\alpha + \\sqrt{P}\\delta$。\n我们有三个数据点：$T(16) = 2.5264$，$T(64) = 0.6436$ 和 $T(256) = 0.1855$。这产生了一个包含三个未知数 $c_{\\text{seg}}$、$\\alpha$ 和 $\\delta$ 的三个线性方程组。\n\n对于 $P = 16$：$\\sqrt{16} = 4$。\n$T(16) = \\frac{3.36 \\times 10^8}{16} c_{\\text{seg}} + (2(4) - 2)\\alpha + 4\\delta = 2.5264$\n$(2.1 \\times 10^7) c_{\\text{seg}} + 6\\alpha + 4\\delta = 2.5264$ (1)\n\n对于 $P = 64$：$\\sqrt{64} = 8$。\n$T(64) = \\frac{3.36 \\times 10^8}{64} c_{\\text{seg}} + (2(8) - 2)\\alpha + 8\\delta = 0.6436$\n$(5.25 \\times 10^6) c_{\\text{seg}} + 14\\alpha + 8\\delta = 0.6436$ (2)\n\n对于 $P = 256$：$\\sqrt{256} = 16$。\n$T(256) = \\frac{3.36 \\times 10^8}{256} c_{\\text{seg}} + (2(16) - 2)\\alpha + 16\\delta = 0.1855$\n$(1.3125 \\times 10^6) c_{\\text{seg}} + 30\\alpha + 16\\delta = 0.1855$ (3)\n\n为求解该方程组，我们可以使用消元法。\n首先，消去 $\\delta$。将方程 (2) 乘以 2：\n$(1.05 \\times 10^7) c_{\\text{seg}} + 28\\alpha + 16\\delta = 1.2872$ (4)\n从方程 (4) 中减去方程 (3)：\n$(1.05 \\times 10^7 - 1.3125 \\times 10^6) c_{\\text{seg}} + (28-30)\\alpha = 1.2872 - 0.1855$\n$(9.1875 \\times 10^6) c_{\\text{seg}} - 2\\alpha = 1.1017$ (5)\n\n接下来，将方程 (1) 乘以 2：\n$(4.2 \\times 10^7) c_{\\text{seg}} + 12\\alpha + 8\\delta = 5.0528$ (6)\n从方程 (6) 中减去方程 (2)：\n$(4.2 \\times 10^7 - 5.25 \\times 10^6) c_{\\text{seg}} + (12-14)\\alpha = 5.0528 - 0.6436$\n$(3.675 \\times 10^7) c_{\\text{seg}} - 2\\alpha = 4.4092$ (7)\n\n现在我们得到了一个包含两个变量（$c_{\\text{seg}}$ 和 $\\alpha$）的两个方程（5 和 7）的方程组。\n从方程 (7) 中减去方程 (5)：\n$(3.675 \\times 10^7 - 9.1875 \\times 10^6) c_{\\text{seg}} = 4.4092 - 1.1017$\n$(2.75625 \\times 10^7) c_{\\text{seg}} = 3.3075$\n$c_{\\text{seg}} = \\frac{3.3075}{2.75625 \\times 10^7} = 1.2 \\times 10^{-7}$\n\n将 $c_{\\text{seg}}$ 代回方程 (7) 以求得 $\\alpha$：\n$(3.675 \\times 10^7) (1.2 \\times 10^{-7}) - 2\\alpha = 4.4092$\n$4.41 - 2\\alpha = 4.4092$\n$2\\alpha = 4.41 - 4.4092 = 0.0008$\n$\\alpha = 0.0004$\n\n最后，将 $c_{\\text{seg}}$ 和 $\\alpha$ 代入方程 (1) 以求得 $\\delta$：\n$(2.1 \\times 10^7) (1.2 \\times 10^{-7}) + 6(0.0004) + 4\\delta = 2.5264$\n$2.52 + 0.0024 + 4\\delta = 2.5264$\n$2.5224 + 4\\delta = 2.5264$\n$4\\delta = 2.5264 - 2.5224 = 0.004$\n$\\delta = 0.001$\n\n解得的参数为：\n$c_{\\text{seg}} = 1.2 \\times 10^{-7}$ s\n$\\alpha = 4 \\times 10^{-4}$ s\n$\\delta = 1 \\times 10^{-3}$ s\n\n### 任务3：预测新配置的运行时间\n\n对于新配置，参数为：\n$P' = 512$\n$N_a' = 16$\n$N_g' = 7$\n$N_r' = 2500$\n$s_{\\text{avg}}' = 3000$\n\n新的计算功系数为：\n$W'_{\\text{coeff}} = N_a' N_r' s_{\\text{avg}}' N_g' = (16)(2500)(3000)(7) = 840,000,000 = 8.4 \\times 10^8$。\n\n我们使用推导出的性能模型以及新的功系数和已解出的参数 $c_{\\text{seg}}$、$\\alpha$ 和 $\\delta$。\n$T(P') = \\frac{W'_{\\text{coeff}}}{P'} c_{\\text{seg}} + (2\\sqrt{P'} - 2)\\alpha + \\sqrt{P'}\\delta$\n$T(512) = \\frac{8.4 \\times 10^8}{512} (1.2 \\times 10^{-7}) + (2\\sqrt{512} - 2)(4 \\times 10^{-4}) + \\sqrt{512}(1 \\times 10^{-3})$\n\n注意 $\\sqrt{512} = \\sqrt{256 \\times 2} = 16\\sqrt{2}$。\n\n让我们计算每一项：\n$T_{\\text{comp}}(512) = \\frac{8.4 \\times 1.2 \\times 10^1}{512} = \\frac{100.8}{512} = 0.196875$\n\n$T_{\\text{comm}}(512) = (2(16\\sqrt{2}) - 2)(4 \\times 10^{-4}) + (16\\sqrt{2})(1 \\times 10^{-3})$\n$= (32\\sqrt{2} - 2)(4 \\times 10^{-4}) + 16\\sqrt{2} \\times 10^{-3}$\n$= 128\\sqrt{2} \\times 10^{-4} - 8 \\times 10^{-4} + 16\\sqrt{2} \\times 10^{-3}$\n$= 0.0128\\sqrt{2} - 0.0008 + 0.016\\sqrt{2}$\n$= (0.0128 + 0.016)\\sqrt{2} - 0.0008$\n$= 0.0288\\sqrt{2} - 0.0008$\n\n使用近似值 $\\sqrt{2} \\approx 1.41421356$：\n$T_{\\text{comm}}(512) \\approx 0.0288 \\times 1.41421356 - 0.0008 \\approx 0.04072887 - 0.0008 = 0.03992887$\n\n总运行时间是两部分之和：\n$T(512) = T_{\\text{comp}}(512) + T_{\\text{comm}}(512) \\approx 0.196875 + 0.03992887 = 0.23680387$\n\n将最终答案四舍五入到四位有效数字，得到 $0.2368$。单位是秒。",
            "answer": "$$\n\\boxed{0.2368}\n$$"
        }
    ]
}