{
    "hands_on_practices": [
        {
            "introduction": "在有限元方法中，为了简化计算，通常会在一个简单的“参考”单元上执行所有基本计算，然后将结果映射到网格中的实际物理单元。本练习聚焦于转换基函数的梯度这一关键步骤，这是组装输运方程中流项矩阵的核心操作。通过这个实践，你将巩固对仿射映射和链式法则在有限元实际应用中的理解。",
            "id": "4225515",
            "problem": "考虑三维空间中的稳态单群中子输运方程，其中流算符表示为 $\\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\boldsymbol{x})$。在四面体网格上的连续有限元 (CFE) 离散中，为了在求积点处计算方向导数 $\\boldsymbol{\\Omega} \\cdot \\nabla \\varphi$ 以组装流项，需要将基函数从参考四面体映射到物理四面体单元的梯度。设参考四面体 $\\hat{T}$ 的顶点为 $\\hat{\\boldsymbol{v}}_{1}=(0,0,0)$、$\\hat{\\boldsymbol{v}}_{2}=(1,0,0)$、$\\hat{\\boldsymbol{v}}_{3}=(0,1,0)$ 和 $\\hat{\\boldsymbol{v}}_{4}=(0,0,1)$，并且在 $\\hat{T}$ 上的标准线性拉格朗日基函数为 $\\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}})=1-\\hat{\\xi}-\\hat{\\eta}-\\hat{\\zeta}$、$\\hat{\\varphi}_{2}(\\hat{\\boldsymbol{x}})=\\hat{\\xi}$、$\\hat{\\varphi}_{3}(\\hat{\\boldsymbol{x}})=\\hat{\\eta}$ 和 $\\hat{\\varphi}_{4}(\\hat{\\boldsymbol{x}})=\\hat{\\zeta}$，其中 $\\hat{\\boldsymbol{x}}=(\\hat{\\xi},\\hat{\\eta},\\hat{\\zeta})$。反应堆堆芯子区域中的一个物理四面体单元 $T$ 由顶点 $\\boldsymbol{v}_{1}=(1.2,-0.3,0.5)$、$\\boldsymbol{v}_{2}=(3.3,0.1,0.6)$、$\\boldsymbol{v}_{3}=(1.4,2.2,0.8)$ 和 $\\boldsymbol{v}_{4}=(0.7,-0.2,3.5)$ 定义，所有坐标单位均为厘米。仿射映射 $\\boldsymbol{x}(\\hat{\\boldsymbol{x}})=\\boldsymbol{v}_{1}+\\mathbf{A}\\hat{\\boldsymbol{x}}$ 由雅可比矩阵 $\\mathbf{A}=[\\boldsymbol{v}_{2}-\\boldsymbol{v}_{1}\\ \\ \\boldsymbol{v}_{3}-\\boldsymbol{v}_{1}\\ \\ \\boldsymbol{v}_{4}-\\boldsymbol{v}_{1}]$ 定义，其中各列是从顶点 $\\boldsymbol{v}_{1}$ 指向其他顶点的边向量。假设粒子流方向为单位向量 $\\boldsymbol{\\Omega}=\\frac{1}{\\sqrt{3}}(1,-1,1)$，这是一个典型的离散纵标 (SN) 角方向。使用仿射映射的链式法则和参考单元上梯度的定义，计算与顶点 $\\boldsymbol{v}_{1}$ 相关联的基函数的映射物理梯度 $\\nabla \\varphi_{1}(\\boldsymbol{x})$，并在以下四个权重相等的参考空间求积点处计算方向导数 $\\boldsymbol{\\Omega}\\cdot\\nabla\\varphi_{1}$：$\\hat{\\boldsymbol{x}}_{1}=(0,0,0)$、$\\hat{\\boldsymbol{x}}_{2}=(1,0,0)$、$\\hat{\\boldsymbol{x}}_{3}=(0,1,0)$ 和 $\\hat{\\boldsymbol{x}}_{4}=(0,0,1)$，每个点的权重为 $w_{q}=1/24$。最后，报告在映射后的物理求积点上计算的四个 $\\boldsymbol{\\Omega}\\cdot\\nabla\\varphi_{1}$ 值的算术平均值。最终的平均值以厘米的倒数表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算在物理四面体单元内一个基函数的方向导数。由于基函数是线性的，并且从参考单元到物理单元的映射是仿射的，因此梯度在整个单元内是恒定的。因此，方向导数 $\\boldsymbol{\\Omega}\\cdot\\nabla\\varphi_{1}$ 在单元内也是一个常数。在所有求积点上计算得到的值将是相同的，其算术平均值就等于这个常数值。\n\n计算过程的核心是使用链式法则，将物理单元上的梯度 $\\nabla \\varphi_{1}(\\boldsymbol{x})$ 与参考单元上的梯度 $\\hat{\\nabla} \\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}})$ 联系起来。该关系由下式给出：\n$$ \\nabla \\varphi_{1}(\\boldsymbol{x}) = (\\mathbf{A}^{-1})^{T} \\hat{\\nabla} \\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}}) $$\n其中 $\\mathbf{A}$ 是从参考单元到物理单元的仿射映射的雅可比矩阵。\n\n**步骤 1: 计算参考梯度**\n\n首先，我们计算参考单元 $\\hat{T}$ 上基函数 $\\hat{\\varphi}_{1}$ 的梯度。给定的基函数为 $\\hat{\\varphi}_{1}(\\hat{\\boldsymbol{x}}) = 1 - \\hat{\\xi} - \\hat{\\eta} - \\hat{\\zeta}$，其中 $\\hat{\\boldsymbol{x}}=(\\hat{\\xi},\\hat{\\eta},\\hat{\\zeta})$。其梯度为：\n$$ \\hat{\\nabla} \\hat{\\varphi}_{1} = \\begin{pmatrix} \\frac{\\partial \\hat{\\varphi}_{1}}{\\partial \\hat{\\xi}} \\\\ \\frac{\\partial \\hat{\\varphi}_{1}}{\\partial \\hat{\\eta}} \\\\ \\frac{\\partial \\hat{\\varphi}_{1}}{\\partial \\hat{\\zeta}} \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} $$\n\n**步骤 2: 构建雅可比矩阵 A**\n\n接下来，我们根据物理单元 $T$ 的顶点构建雅可比矩阵 $\\mathbf{A}$。顶点为 $\\boldsymbol{v}_{1}=(1.2, -0.3, 0.5)$、$\\boldsymbol{v}_{2}=(3.3, 0.1, 0.6)$、$\\boldsymbol{v}_{3}=(1.4, 2.2, 0.8)$ 和 $\\boldsymbol{v}_{4}=(0.7, -0.2, 3.5)$。$\\mathbf{A}$ 的列向量是从 $\\boldsymbol{v}_{1}$ 出发的边向量：\n$$ \\boldsymbol{v}_{2}-\\boldsymbol{v}_{1} = \\begin{pmatrix} 3.3-1.2 \\\\ 0.1-(-0.3) \\\\ 0.6-0.5 \\end{pmatrix} = \\begin{pmatrix} 2.1 \\\\ 0.4 \\\\ 0.1 \\end{pmatrix} $$\n$$ \\boldsymbol{v}_{3}-\\boldsymbol{v}_{1} = \\begin{pmatrix} 1.4-1.2 \\\\ 2.2-(-0.3) \\\\ 0.8-0.5 \\end{pmatrix} = \\begin{pmatrix} 0.2 \\\\ 2.5 \\\\ 0.3 \\end{pmatrix} $$\n$$ \\boldsymbol{v}_{4}-\\boldsymbol{v}_{1} = \\begin{pmatrix} 0.7-1.2 \\\\ -0.2-(-0.3) \\\\ 3.5-0.5 \\end{pmatrix} = \\begin{pmatrix} -0.5 \\\\ 0.1 \\\\ 3.0 \\end{pmatrix} $$\n因此，雅可比矩阵为：\n$$ \\mathbf{A} = \\begin{pmatrix} 2.1  0.2  -0.5 \\\\ 0.4  2.5  0.1 \\\\ 0.1  0.3  3.0 \\end{pmatrix} $$\n\n**步骤 3: 计算物理梯度**\n\n为了求得物理梯度，我们需要计算 $(\\mathbf{A}^{-1})^{T}$。我们首先计算 $\\mathbf{A}$ 的行列式：\n$$ \\det(\\mathbf{A}) = 2.1(2.5 \\cdot 3.0 - 0.1 \\cdot 0.3) - 0.2(0.4 \\cdot 3.0 - 0.1 \\cdot 0.1) - 0.5(0.4 \\cdot 0.3 - 2.5 \\cdot 0.1) $$\n$$ \\det(\\mathbf{A}) = 2.1(7.47) - 0.2(1.19) - 0.5(-0.13) = 15.687 - 0.238 + 0.065 = 15.514 $$\n现在我们应用链式法则。使用伴随矩阵法，$(\\mathbf{A}^{-1})^{T} = \\frac{1}{\\det(\\mathbf{A})}\\mathbf{C}$，其中 $\\mathbf{C}$ 是 $\\mathbf{A}$ 的代数余子式矩阵。\n$$ \\nabla \\varphi_{1} = (\\mathbf{A}^{-1})^{T} \\hat{\\nabla}\\hat{\\varphi}_{1} = \\frac{1}{\\det(\\mathbf{A})} \\mathbf{C} \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} $$\n代数余子式为：\n$C_{11} = 7.47$, $C_{12} = -1.19$, $C_{13} = -0.13$\n$C_{21} = -0.75$, $C_{22} = 6.35$, $C_{23} = -0.61$\n$C_{31} = 1.27$, $C_{32} = -0.41$, $C_{33} = 5.17$\n\n将代数余子式矩阵与参考梯度向量相乘：\n$$ \\mathbf{C} \\hat{\\nabla}\\hat{\\varphi}_{1} = \\begin{pmatrix} 7.47  -1.19  -0.13 \\\\ -0.75  6.35  -0.61 \\\\ 1.27  -0.41  5.17 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -7.47 + 1.19 + 0.13 \\\\ 0.75 - 6.35 + 0.61 \\\\ -1.27 + 0.41 - 5.17 \\end{pmatrix} = \\begin{pmatrix} -6.15 \\\\ -4.99 \\\\ -6.03 \\end{pmatrix} $$\n因此，物理梯度为：\n$$ \\nabla \\varphi_{1} = \\frac{1}{15.514} \\begin{pmatrix} -6.15 \\\\ -4.99 \\\\ -6.03 \\end{pmatrix} \\text{ cm}^{-1} $$\n\n**步骤 4: 计算方向导数**\n\n最后一步是计算方向导数 $\\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1}$。流方向为 $\\boldsymbol{\\Omega} = \\frac{1}{\\sqrt{3}}(1, -1, 1)$。\n$$ \\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix} \\cdot \\left( \\frac{1}{15.514} \\begin{pmatrix} -6.15 \\\\ -4.99 \\\\ -6.03 \\end{pmatrix} \\right) $$\n$$ \\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1} = \\frac{1}{\\sqrt{3} \\cdot 15.514} [1(-6.15) + (-1)(-4.99) + 1(-6.03)] $$\n$$ \\boldsymbol{\\Omega} \\cdot \\nabla \\varphi_{1} = \\frac{1}{\\sqrt{3} \\cdot 15.514} [-6.15 + 4.99 - 6.03] = \\frac{-7.19}{\\sqrt{3} \\cdot 15.514} $$\n由于该值在整个单元内是恒定的，因此其算术平均值就是这个值。\n\n**步骤 5: 计算最终数值**\n$$ \\text{平均值} = \\frac{-7.19}{15.514 \\sqrt{3}} \\approx \\frac{-7.19}{26.87083} \\approx -0.267573 \\text{ cm}^{-1} $$\n四舍五入到四位有效数字，我们得到 $-0.2676$。",
            "answer": "$$ \\boxed{-0.2676} $$"
        },
        {
            "introduction": "中子输运方程的右侧包含了描述中子来源的项，其中散射源是至关重要的一部分。本练习演示了如何在一个有限元单元内，使用离散纵标($S_N$)求积组来近似计算连续的散射积分。通过这个计算，你将把角通量、标量通量、截面和求积格式等概念联系起来，为一个具体的源项计算出数值。",
            "id": "4225526",
            "problem": "考虑三维空间中的稳态多群中子输运，其由具有各向同性散射的群 $g$ 的中子输运方程建模，该方程建立在由均匀材料构成的单个六面体有限元网格 $K$ 上。在离散纵标（DO）方法中，对单位球面上的角积分采用 $4\\pi$ 球面度上的 $S_4$ 求积进行近似，并且在网格常数有限元离散中，每个求积方向 $m$ 和能群 $g'$ 的网格平均角通量由网格 $K$ 内的常数值 $\\psi_{m}^{g'}$ 表示。假设各向同性散射由零阶勒让德矩截面 $\\Sigma_{s,0}^{g' \\to g}$ 表征，该截面与角度无关。\n\n设此网格中使用的 $S_4$ 求积是能级对称的，具有在对称方向上重复的两个不同立体角权重：有 $12$ 个方向的权重为 $w_a$，另有 $12$ 个方向的权重为 $w_b$，其选择方式使得权重总和为 $4\\pi$。在此网格中，程序使用 $w_a = 0.5$ 球面度和 $w_b = \\dfrac{4\\pi - 12 w_a}{12}$ 球面度。\n\n计算得到的两个能群的 DO 网格平均角通量（单位：中子 $\\text{cm}^{-2} \\text{s}^{-1} \\text{sr}^{-1}$）在每个权重类别上是恒定的：\n- 对于群 $g' = 1$：权重为 $w_a$ 的 $12$ 个方向，$\\psi_{m}^{1} = 2.20 \\times 10^{12}$；权重为 $w_b$ 的 $12$ 个方向，$\\psi_{m}^{1} = 1.80 \\times 10^{12}$。\n- 对于群 $g' = 2$：权重为 $w_a$ 的 $12$ 个方向，$\\psi_{m}^{2} = 1.60 \\times 10^{12}$；权重为 $w_b$ 的 $12$ 个方向，$\\psi_{m}^{2} = 1.30 \\times 10^{12}$。\n\n各向同性散射截面（单位：$\\text{cm}^{-1}$）如下：\n- $\\Sigma_{s,0}^{1 \\to 2} = 0.08$,\n- $\\Sigma_{s,0}^{2 \\to 2} = 0.15$.\n\n从稳态多群中子输运方程和各向同性入射散射源的定义出发，推导在网格 $K$ 中进入群 $g=2$ 的各向同性入射散射源的表达式（用 DO 求积权重和网格平均角通量表示），然后使用所提供的数据计算其数值。将最终答案以中子 $\\text{cm}^{-3} \\text{s}^{-1} \\text{sr}^{-1}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "本问题要求推导并计算在单个有限元网格 $K$ 内进入能群 $g=2$ 的各向同性入射散射源。推导始于稳态中子输运方程中散射源的基本定义。\n\n散射源项 $S_g(\\vec{r}, \\vec{\\Omega})$ 表示由于散射事件，在位置 $\\vec{r}$、沿方向 $\\vec{\\Omega}$、在能群 $g$ 内出现中子的速率。它被定义为对所有初始能量和方向的积分。在多群框架下，这变为对所有源能群 $g'$ 的求和：\n$$\nS_g(\\vec{r}, \\vec{\\Omega}) = \\sum_{g'=1}^{G} \\int_{4\\pi} \\Sigma_s^{g' \\to g}(\\vec{r}, \\vec{\\Omega}' \\to \\vec{\\Omega}) \\psi_{g'}(\\vec{r}, \\vec{\\Omega}') d\\Omega'\n$$\n其中 $G$ 是能群总数，$\\psi_{g'}(\\vec{r}, \\vec{\\Omega}')$ 是在位置 $\\vec{r}$、方向 $\\vec{\\Omega}'$ 的群 $g'$ 的角中子通量，而 $\\Sigma_s^{g' \\to g}(\\vec{r}, \\vec{\\Omega}' \\to \\vec{\\Omega})$ 是从中子从群 $g'$ 和方向 $\\vec{\\Omega}'$ 散射到群 $g$ 和方向 $\\vec{\\Omega}$ 的微分散射截面。\n\n问题指出散射是各向同性的。这意味着散射到新方向的概率在整个 $4\\pi$ 球面度上是均匀的，微分截面仅是能量转移的函数。它通过以下方式与散射截面的零阶勒让德矩 $\\Sigma_{s,0}^{g' \\to g}$ 相关：\n$$\n\\Sigma_s^{g' \\to g}(\\vec{r}, \\vec{\\Omega}' \\to \\vec{\\Omega}) = \\frac{1}{4\\pi} \\Sigma_{s,0}^{g' \\to g}(\\vec{r})\n$$\n将此代入散射源方程，我们得到：\n$$\nS_g(\\vec{r}, \\vec{\\Omega}) = \\sum_{g'=1}^{G} \\int_{4\\pi} \\frac{1}{4\\pi} \\Sigma_{s,0}^{g' \\to g}(\\vec{r}) \\psi_{g'}(\\vec{r}, \\vec{\\Omega}') d\\Omega'\n$$\n由于 $\\Sigma_{s,0}^{g' \\to g}(\\vec{r})$ 和因子 $\\frac{1}{4\\pi}$ 与积分变量 $\\vec{\\Omega}'$ 无关，它们可以移到积分符号外：\n$$\nS_g(\\vec{r}, \\vec{\\Omega}) = \\frac{1}{4\\pi} \\sum_{g'=1}^{G} \\Sigma_{s,0}^{g' \\to g}(\\vec{r}) \\left( \\int_{4\\pi} \\psi_{g'}(\\vec{r}, \\vec{\\Omega}') d\\Omega' \\right)\n$$\n该积分项是标量通量 $\\phi_{g'}(\\vec{r})$ 的定义：\n$$\n\\phi_{g'}(\\vec{r}) = \\int_{4\\pi} \\psi_{g'}(\\vec{r}, \\vec{\\Omega}') d\\Omega'\n$$\n因此，散射源是各向同性的（与 $\\vec{\\Omega}$ 无关），由下式给出：\n$$\nS_{s,g}^{iso}(\\vec{r}) = \\frac{1}{4\\pi} \\sum_{g'=1}^{G} \\Sigma_{s,0}^{g' \\to g}(\\vec{r}) \\phi_{g'}(\\vec{r})\n$$\n该表达式给出的源单位为中子 $\\text{cm}^{-3} \\text{s}^{-1} \\text{sr}^{-1}$，符合题目要求。\n\n接下来，我们应用问题中指定的数值近似。\n在离散纵标（DO）方法中，角积分通过对一组离散方向 $\\vec{\\Omega}_m$ 及其相应权重 $w_m$ 的求积和来近似：\n$$\n\\phi_{g'}(\\vec{r}) \\approx \\sum_{m} w_m \\psi_{g'}(\\vec{r}, \\vec{\\Omega}_m)\n$$\n问题指定了网格常数有限元离散。在六面体网格 $K$ 内，所有量都假定为均匀的。与位置相关的角通量 $\\psi_{g'}(\\vec{r}, \\vec{\\Omega}_m)$ 被其恒定的网格平均值 $\\psi_m^{g'}$ 替代，截面 $\\Sigma_{s,0}^{g' \\to g}(\\vec{r})$ 变为常数 $\\Sigma_{s,0}^{g' \\to g}$。\n\n因此，群 $g'$ 的网格平均标量通量（表示为 $\\phi_{g'}^K$）为：\n$$\n\\phi_{g'}^K = \\sum_m w_m \\psi_m^{g'}\n$$\n进入群 $g=2$ 的网格平均各向同性入射散射源则为：\n$$\nS_{s,g=2}^{iso, K} = \\frac{1}{4\\pi} \\sum_{g'=1}^{2} \\Sigma_{s,0}^{g' \\to 2} \\phi_{g'}^K = \\frac{1}{4\\pi} \\left( \\Sigma_{s,0}^{1 \\to 2} \\phi_1^K + \\Sigma_{s,0}^{2 \\to 2} \\phi_2^K \\right)\n$$\n为计算此值，我们首先计算标量通量 $\\phi_1^K$ 和 $\\phi_2^K$。$S_4$ 求积有 $24$ 个方向，分为两组：$12$ 个方向的权重为 $w_a = 0.5$ sr，另 $12$ 个方向的权重为 $w_b$。权重总和必须为 $4\\pi$，所以 $12w_a + 12w_b = 4\\pi$。我们可以求出 $w_b$：\n$$\nw_b = \\frac{4\\pi - 12 w_a}{12} = \\frac{4\\pi - 12(0.5)}{12} = \\frac{4\\pi - 6}{12} = \\frac{\\pi}{3} - \\frac{1}{2} \\text{ sr}\n$$\n在每个权重类别内，所有方向的角通量都是恒定的。设权重为 $w_a$ 的方向集为 A，权重为 $w_b$ 的方向集为 B。网格平均角通量为 $\\psi_A^{g'}$ 和 $\\psi_B^{g'}$。\n群 $g'=1$ 的标量通量为：\n$$\n\\phi_1^K = \\sum_{m \\in A} w_a \\psi_A^1 + \\sum_{m \\in B} w_b \\psi_B^1 = 12 w_a \\psi_A^1 + 12 w_b \\psi_B^1\n$$\n使用给定值 $\\psi_A^1 = 2.20 \\times 10^{12}$ 和 $\\psi_B^1 = 1.80 \\times 10^{12}$：\n$$\n\\phi_1^K = 12(0.5)(2.20 \\times 10^{12}) + 12\\left(\\frac{\\pi}{3} - \\frac{1}{2}\\right)(1.80 \\times 10^{12})\n$$\n$$\n\\phi_1^K = 6(2.20 \\times 10^{12}) + (4\\pi - 6)(1.80 \\times 10^{12})\n$$\n$$\n\\phi_1^K = 1.32 \\times 10^{13} + (4\\pi - 6)(1.80 \\times 10^{12}) \\approx 1.32 \\times 10^{13} + (6.56637)(1.80 \\times 10^{12})\n$$\n$$\n\\phi_1^K \\approx 1.32 \\times 10^{13} + 1.18195 \\times 10^{13} = 2.50195 \\times 10^{13} \\text{ neutrons cm}^{-2}\\text{s}^{-1}\n$$\n同理，使用 $\\psi_A^2 = 1.60 \\times 10^{12}$ 和 $\\psi_B^2 = 1.30 \\times 10^{12}$ 计算群 $g'=2$ 的标量通量：\n$$\n\\phi_2^K = 12 w_a \\psi_A^2 + 12 w_b \\psi_B^2 = 6(1.60 \\times 10^{12}) + (4\\pi - 6)(1.30 \\times 10^{12})\n$$\n$$\n\\phi_2^K = 9.6 \\times 10^{12} + (4\\pi - 6)(1.30 \\times 10^{12}) \\approx 9.6 \\times 10^{12} + (6.56637)(1.30 \\times 10^{12})\n$$\n$$\n\\phi_2^K \\approx 9.6 \\times 10^{12} + 8.53628 \\times 10^{12} = 1.81363 \\times 10^{13} \\text{ neutrons cm}^{-2}\\text{s}^{-1}\n$$\n现在，我们将这些标量通量代入散射源方程。给定的截面为 $\\Sigma_{s,0}^{1 \\to 2} = 0.08 \\text{ cm}^{-1}$ 和 $\\Sigma_{s,0}^{2 \\to 2} = 0.15 \\text{ cm}^{-1}$。\n$$\nS_{s,g=2}^{iso, K} = \\frac{1}{4\\pi} \\left[ (0.08)(\\phi_1^K) + (0.15)(\\phi_2^K) \\right]\n$$\n$$\nS_{s,g=2}^{iso, K} = \\frac{1}{4\\pi} \\left[ (0.08)(2.50195 \\times 10^{13}) + (0.15)(1.81363 \\times 10^{13}) \\right]\n$$\n$$\nS_{s,g=2}^{iso, K} = \\frac{1}{4\\pi} \\left[ 2.00156 \\times 10^{12} + 2.72044 \\times 10^{12} \\right] \\text{ neutrons cm}^{-3}\\text{s}^{-1}\n$$\n$$\nS_{s,g=2}^{iso, K} = \\frac{4.72200 \\times 10^{12}}{4\\pi} \\text{ neutrons cm}^{-3}\\text{s}^{-1}\\text{sr}^{-1}\n$$\n$$\nS_{s,g=2}^{iso, K} \\approx \\frac{4.72200 \\times 10^{12}}{12.56637} \\approx 3.75775 \\times 10^{11} \\text{ neutrons cm}^{-3}\\text{s}^{-1}\\text{sr}^{-1}\n$$\n按要求四舍五入到四位有效数字，我们得到 $3.758 \\times 10^{11}$。",
            "answer": "$$\n\\boxed{3.758 \\times 10^{11}}\n$$"
        },
        {
            "introduction": "数值方法，特别是高阶间断伽辽金(DG)方法，有时会产生非物理的结果，例如负的粒子通量。本练习介绍“限制器”的概念，它是一种后处理步骤，通过调整解来恢复其正性，同时保持如单元平均通量等重要的物理量守恒。这对于开发稳健的输运计算程序至关重要。",
            "id": "4225471",
            "problem": "考虑一维、稳态、单能的中子输运方程在平板几何中的形式，\n$$\\mu \\,\\frac{d \\psi(x,\\mu)}{dx} + \\sigma_{t}(x)\\,\\psi(x,\\mu) = q(x,\\mu),$$\n其中 $\\psi(x,\\mu)$ 是角通量，$\\mu \\in [-1,1]$ 是粒子飞行方向的余弦，$\\sigma_{t}(x)$ 是总宏观截面，而 $q(x,\\mu)$ 是一个已知源项。在一个非连续伽辽金 (DG) 有限元近似（使用非连续试探空间的有限元法 (FEM)）中，考虑一个单个单元 $K$，它通过仿射映射到参考区间 $\\xi \\in [-1,1]$。在单元 $K$上，对于一个固定方向 $\\mu = \\mu_{0}  0$，角通量的 DG 模态表示是线性的：\n$$\\psi_{h}(\\xi;\\mu_{0}) = a_{0} + a_{1}\\,\\xi,$$\n其中 $a_{0}$ 等于单元平均值，$a_{1}$ 是模态斜率系数。假设当前的 DG 解在左侧面 $\\xi=-1$ 处出现一个小的负值下冲，且\n$$a_{0} = 1.0 \\times 10^{-2}, \\quad a_{1} = 1.5 \\times 10^{-2}, \\quad \\mu_{0} = 8.0 \\times 10^{-1}。$$\n为强制施加物理非负性，应用一个保正限制器，该限制器将与单元平均值的偏差乘以一个因子 $\\theta \\in [0,1]$ 进行缩放，同时保持单元平均值不变。正值容差为\n$$\\epsilon = 1.0 \\times 10^{-6}。$$\n假设在施加限制器之前，左侧面值是单元内的最小值，并确定一个限制因子，使得限制后的左侧面值恰好为 $\\epsilon$，同时保持平均值不变。然后计算调整后的系数 $(a_{0}^{\\text{lim}}, a_{1}^{\\text{lim}})$ 以及在右侧面 $\\xi=+1$ 处由对流项产生的迎风数值面通量，对于 $\\mu_{0}  0$ 其定义为\n$$F_{K,+} = \\mu_{0}\\,\\psi_{h}^{-}(+1;\\mu_{0}),$$\n其中 $\\psi_{h}^{-}$ 表示来自单元 $K$ 的内部迹。将最终答案的各项四舍五入至六位有效数字，并将通量以“中子数/平方厘米/秒”为单位表示。将最终答案以包含 $a_{0}^{\\text{lim}}$、$a_{1}^{\\text{lim}}$ 和 $F_{K,+}$ 的单行矩阵形式给出，各项按此顺序排列。",
            "solution": "首先验证该问题，以确保其在科学上是合理的、适定的和完整的。所有给定的数据、定义和条件都已明确陈述，并且在中子输运数值方法的背景下，它们看起来是一致且物理上合理的。该问题是保正限制器在非连续伽辽金 (DG) 有限元法中的一个标准应用，这是计算物理学中一种成熟的技术。因此，该问题被认为是有效的，并提供了一个完整的解。\n\n在单个单元中，映射到参考区间 $\\xi \\in [-1,1]$ 的角通量 $\\psi_{h}$，对于一个固定方向 $\\mu_{0}$，由一个线性模态表示给出：\n$$ \\psi_{h}(\\xi;\\mu_{0}) = a_{0} + a_{1}\\,\\xi $$\n系数 $a_{0}$ 代表单元平均通量，这可以通过在参考单元上积分来验证：\n$$ \\bar{\\psi}_{h} = \\frac{1}{1 - (-1)} \\int_{-1}^{1} (a_{0} + a_{1}\\,\\xi) \\,d\\xi = \\frac{1}{2} \\left[ a_{0}\\xi + \\frac{a_{1}\\xi^{2}}{2} \\right]_{-1}^{1} = \\frac{1}{2} \\left( (a_{0} + \\frac{a_{1}}{2}) - (-a_{0} + \\frac{a_{1}}{2}) \\right) = a_{0} $$\n给定的初始系数为 $a_{0} = 1.0 \\times 10^{-2}$ 和 $a_{1} = 1.5 \\times 10^{-2}$。\n由于斜率系数 $a_{1}$ 为正，线性函数 $\\psi_{h}(\\xi)$ 在区间 $\\xi \\in [-1,1]$ 上是单调递增的。因此，其最小值出现在左侧面 $\\xi=-1$ 处。\n在左侧面处的通量值为：\n$$ \\psi_{h}(-1) = a_{0} + a_{1}(-1) = a_{0} - a_{1} = 1.0 \\times 10^{-2} - 1.5 \\times 10^{-2} = -0.005 $$\n这个值是负的，对于粒子通量来说是非物理的，因此有必要应用保正限制器。\n\n该限制器旨在将与单元平均值 $a_{0}$ 的偏差按因子 $\\theta \\in [0,1]$ 进行缩放，同时保持单元平均值本身不变。与平均值的偏差为 $\\psi_{h}(\\xi) - a_{0} = a_{1}\\xi$。限制后的通量 $\\psi_{h}^{\\text{lim}}(\\xi)$ 则为：\n$$ \\psi_{h}^{\\text{lim}}(\\xi) = a_{0} + \\theta (\\psi_{h}(\\xi) - a_{0}) = a_{0} + \\theta(a_{1}\\xi) $$\n这可以写成与原始通量相同的模态形式：\n$$ \\psi_{h}^{\\text{lim}}(\\xi) = a_{0}^{\\text{lim}} + a_{1}^{\\text{lim}}\\xi $$\n通过比较 $\\psi_{h}^{\\text{lim}}(\\xi)$ 的两个表达式，我们得到调整后的系数：\n$$ a_{0}^{\\text{lim}} = a_{0} $$\n$$ a_{1}^{\\text{lim}} = \\theta a_{1} $$\n该限制器保持了单元平均值不变，符合要求。\n\n问题要求确定限制因子 $\\theta$，使得在左侧面限制后的值 $\\psi_{h}^{\\text{lim}}(-1)$ 恰好等于正值容差 $\\epsilon = 1.0 \\times 10^{-6}$。\n在 $\\xi=-1$ 处限制后的通量值为：\n$$ \\psi_{h}^{\\text{lim}}(-1) = a_{0}^{\\text{lim}} + a_{1}^{\\text{lim}}(-1) = a_{0} - \\theta a_{1} $$\n我们令此值等于 $\\epsilon$：\n$$ a_{0} - \\theta a_{1} = \\epsilon $$\n求解 $\\theta$：\n$$ \\theta a_{1} = a_{0} - \\epsilon $$\n$$ \\theta = \\frac{a_{0} - \\epsilon}{a_{1}} $$\n代入给定值：\n$$ \\theta = \\frac{1.0 \\times 10^{-2} - 1.0 \\times 10^{-6}}{1.5 \\times 10^{-2}} = \\frac{0.009999}{0.015} = 0.6666 $$\n由于 $0 \\leq 0.6666 \\leq 1$，这是一个有效的限制因子。\n\n现在我们计算调整后的系数 $(a_{0}^{\\text{lim}}, a_{1}^{\\text{lim}})$。\n单元平均值保持不变：\n$$ a_{0}^{\\text{lim}} = a_{0} = 1.0 \\times 10^{-2} $$\n调整后的斜率系数为：\n$$ a_{1}^{\\text{lim}} = \\theta a_{1} = \\left(\\frac{a_{0} - \\epsilon}{a_{1}}\\right) a_{1} = a_{0} - \\epsilon $$\n$$ a_{1}^{\\text{lim}} = 1.0 \\times 10^{-2} - 1.0 \\times 10^{-6} = 0.009999 $$\n\n最后，我们计算单元右侧面 $\\xi=+1$ 处的迎风数值面通量。对于 $\\mu_0  0$，迎风通量由来自单元 $K$ 的内部迹确定，即限制后的解在右侧面边界处的值。\n$$ F_{K,+} = \\mu_{0}\\,\\psi_{h}^{-}(+1;\\mu_{0}) = \\mu_{0}\\,\\psi_{h}^{\\text{lim}}(+1) $$\n在 $\\xi=+1$ 处限制后的通量值为：\n$$ \\psi_{h}^{\\text{lim}}(+1) = a_{0}^{\\text{lim}} + a_{1}^{\\text{lim}}(+1) = a_{0} + (a_{0} - \\epsilon) = 2a_{0} - \\epsilon $$\n代入数值：\n$$ \\psi_{h}^{\\text{lim}}(+1) = 2(1.0 \\times 10^{-2}) - 1.0 \\times 10^{-6} = 0.02 - 0.000001 = 0.019999 $$\n现在，我们使用 $\\mu_0 = 8.0 \\times 10^{-1} = 0.8$ 计算通量 $F_{K,+}$：\n$$ F_{K,+} = (0.8) \\times (0.019999) = 0.0159992 $$\n\n问题要求将最终答案四舍五入至六位有效数字。\n1. $a_{0}^{\\text{lim}} = 1.0 \\times 10^{-2}$。四舍五入至六位有效数字，为 $1.00000 \\times 10^{-2}$。\n2. $a_{1}^{\\text{lim}} = 0.009999$。四舍五入至六位有效数字，为 $9.99900 \\times 10^{-3}$。\n3. $F_{K,+} = 0.0159992$。这个数已经有六位有效数字，即 $1.59992 \\times 10^{-2}$。\n\n最终答案是行矩阵 $(a_{0}^{\\text{lim}}, a_{1}^{\\text{lim}}, F_{K,+})$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.00000 \\times 10^{-2}  9.99900 \\times 10^{-3}  1.59992 \\times 10^{-2} \\end{pmatrix} } $$"
        }
    ]
}