{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的数值模拟之前，理解简化且可解模型中的基本物理原理至关重要。本练习将指导您使用中子扩散理论，推导出一个简单一维反应堆的 $k$ 本征值的解析解。这项实践不仅能加深您对物理概念（如“曲率”）的直观理解，而且其结果将作为验证数值代码的“标准答案” 。",
            "id": "4232366",
            "problem": "考虑一个由稳态中子扩散近似描述的裸堆、均匀、单能反应堆。未知的标量中子通量为 $\\phi(\\mathbf{r})$，扩散系数为 $D$，宏观吸收截面为 $\\Sigma_{a}$，每次裂变产生的平均中子数乘以宏观裂变截面为 $\\nu \\Sigma_{f}$。在 k-特征值形式中，基波模式的平衡方程可以写作\n$$\n- D \\nabla^{2} \\phi(\\mathbf{r}) + \\Sigma_{a} \\phi(\\mathbf{r}) = \\frac{\\nu \\Sigma_{f}}{k} \\, \\phi(\\mathbf{r}) \\, ,\n$$\n其中真空边界条件通过 $\\phi$ 为零的外推边界施加。该反应堆是一个中心位于 $x=0$、物理厚度为 $L$ 的一维平板，其外推边界位于 $x=\\pm L_{e}/2$，其中 $L_{e} = L + 2 z_{\\mathrm{ex}}$，外推距离为 $z_{\\mathrm{ex}} = 2.131 \\, D$。\n\n从扩散近似和空间曲率的概念出发，通过将材料曲率与平板的几何曲率联系起来，推导出 k-特征值条件，并将其与裂变源迭代法（FSI）的不动点特性联系起来。裂变源迭代法定义为重复的固定源求解，其中第 n 次迭代的裂变源 $S^{(n)}(\\mathbf{r})$ 为 $S^{(n)}(\\mathbf{r}) = \\left(\\nu \\Sigma_{f} / k^{(n)}\\right) \\phi^{(n)}(\\mathbf{r})$。假设基波几何模式满足真空边界条件，并使用此模式来评估隐含的特征值。\n\n对于具有以下性质的均匀裸平板：\n- $L = 100\\,\\mathrm{cm}$，\n- $D = 1.2\\,\\mathrm{cm}$，\n- $\\Sigma_{a} = 0.010\\,\\mathrm{cm}^{-1}$，\n- $\\nu \\Sigma_{f} = 0.011\\,\\mathrm{cm}^{-1}$，\n\n计算最终的有效增殖因子 $k_{\\mathrm{eff}}$（将 $k_{\\mathrm{eff}}$ 定义为扩散 k-特征值问题的主特征值）。将最终答案表示为无量纲标量，并四舍五入到四位有效数字。",
            "solution": "该问题是有效的。这是一个基于单群中子扩散模型的核反应堆物理导论中的标准、适定问题。所有必要的参数和条件都已提供，问题在科学上是合理的。因此，我们可以进行求解。\n\n起点是稳态、单能中子扩散方程的 k-特征值形式：\n$$\n- D \\nabla^{2} \\phi(\\mathbf{r}) + \\Sigma_{a} \\phi(\\mathbf{r}) = \\frac{1}{k} \\nu \\Sigma_{f} \\phi(\\mathbf{r})\n$$\n其中 $\\phi(\\mathbf{r})$ 是中子通量，$D$ 是扩散系数，$\\Sigma_{a}$ 是宏观吸收截面，$\\nu \\Sigma_{f}$ 是中子产生截面项。参数 $k$ 是特征值，对于基波模式，它就是有效增殖因子 $k_{\\mathrm{eff}}$。\n\n我们可以重新整理该方程，使其类似于亥姆霍兹方程。对于均匀介质，材料性质 $D$、$\\Sigma_{a}$ 和 $\\nu\\Sigma_f$ 是常数。\n$$\n- D \\nabla^{2} \\phi(\\mathbf{r}) = \\left(\\frac{\\nu \\Sigma_{f}}{k} - \\Sigma_{a}\\right) \\phi(\\mathbf{r})\n$$\n两边除以 $D$ 得：\n$$\n\\nabla^{2} \\phi(\\mathbf{r}) + \\frac{1}{D}\\left(\\frac{\\nu \\Sigma_{f}}{k} - \\Sigma_{a}\\right) \\phi(\\mathbf{r}) = 0\n$$\n该方程的形式为 $\\nabla^{2} \\phi(\\mathbf{r}) + B^2 \\phi(\\mathbf{r}) = 0$，其中 $B^2$ 是系统的总曲率。要使解存在，曲率必须满足两个独立的定义。\n\n首先，**材料曲率** $B_m^2$ 是材料成分的一种属性。它描述了无限介质中中子产生和吸收的内在平衡。对于一个增殖因子为 $k$ 的系统，曲率由通量前的系数给出：\n$$\nB^2 = \\frac{\\nu \\Sigma_{f}/k - \\Sigma_{a}}{D}\n$$\n其次，**几何曲率** $B_g^2$ 由反应堆的几何形状和边界条件决定。它表示为满足边界条件所需的通量剖面的曲率，并且是方程 $\\nabla^{2} \\phi + B_g^2 \\phi = 0$ 的一个特征值。\n\n对于给定的中心在 $x=0$ 的一维平板，算子 $\\nabla^2$ 变为 $\\frac{d^2}{dx^2}$。几何曲率的方程为：\n$$\n\\frac{d^2\\phi(x)}{dx^2} + B_g^2 \\phi(x) = 0\n$$\n通解为 $\\phi(x) = C_1 \\cos(B_g x) + C_2 \\sin(B_g x)$。对于对称域中的基波模式，解必须是对称的，因此我们要求 $C_2 = 0$。这样剩下 $\\phi(x) = C_1 \\cos(B_g x)$。真空边界条件通过在外推边界 $x = \\pm L_e/2$ 处将通量设置为零来施加。应用此条件：\n$$\n\\phi(\\pm L_e/2) = C_1 \\cos(B_g L_e/2) = 0\n$$\n为了得到非平凡解（$C_1 \\neq 0$），余弦函数的自变量必须是 $\\pi/2$ 的奇数倍。基波模式对应于 $B_g$ 的最小正值，因此我们取：\n$$\nB_g \\frac{L_e}{2} = \\frac{\\pi}{2} \\implies B_g = \\frac{\\pi}{L_e}\n$$\n因此，基波模式的几何曲率为：\n$$\nB_g^2 = \\left(\\frac{\\pi}{L_e}\\right)^2\n$$\n对于稳态临界反应堆，材料性质必须能维持由几何形状决定的通量形状。这要求将两种曲率相等，从而得到临界条件。我们令 $B^2 = B_g^2$ 并求解特征值 $k$，记作 $k_{\\mathrm{eff}}$：\n$$\n\\frac{\\nu \\Sigma_{f}/k_{\\mathrm{eff}} - \\Sigma_{a}}{D} = B_g^2\n$$\n求解 $k_{\\mathrm{eff}}$：\n$$\n\\frac{\\nu \\Sigma_{f}}{k_{\\mathrm{eff}}} = \\Sigma_{a} + D B_g^2\n$$\n$$\nk_{\\mathrm{eff}} = \\frac{\\nu \\Sigma_{f}}{\\Sigma_{a} + D B_g^2}\n$$\n这个结果在物理上是直观的：$k_{\\mathrm{eff}}$ 是中子产生率（$\\nu \\Sigma_f \\phi$）与中子损失率之比。分母中的损失项包括吸收（$\\Sigma_a \\phi$）和由项 $D B_g^2 \\phi$ 表示的泄漏。\n\n裂变源迭代法（FSI）是一种数值幂迭代法，用于寻找主特征值 $k_{\\mathrm{eff}}$ 及其对应的特征函数（基波通量模式）。迭代过程为 $L\\phi^{(n+1)} = \\frac{1}{k^{(n)}} S^{(n)}$，其中 $L$ 是扩散-吸收算子，$S^{(n)} = \\nu \\Sigma_f \\phi^{(n)}$ 是裂变源。当收敛时，通量形状是稳定的（$\\phi^{(n+1)} \\propto \\phi^{(n)}$），这是迭代算子的一个不动点。基波模式通量 $\\phi(x) = C_1 \\cos(B_g x)$ 是扩散算子的一个特征函数。当裂变源与此模式成比例时，固定源求解得到的通量将具有相同的空间形状。特征值 $k_{\\mathrm{eff}}$ 正是确保这种自洽性的因子，它平衡了该特定空间模式的产生和损失。我们推导的 $k_{\\mathrm{eff}}$ 解析公式是此问题中 FSI 方法收敛到的精确值。\n\n现在，我们使用所提供的数据计算 $k_{\\mathrm{eff}}$ 的数值：\n- 物理厚度：$L = 100\\,\\mathrm{cm}$\n- 扩散系数：$D = 1.2\\,\\mathrm{cm}$\n- 宏观吸收截面：$\\Sigma_{a} = 0.010\\,\\mathrm{cm}^{-1}$\n- 中子产生项：$\\nu \\Sigma_{f} = 0.011\\,\\mathrm{cm}^{-1}$\n\n首先，我们计算外推距离 $z_{\\mathrm{ex}}$：\n$$\nz_{\\mathrm{ex}} = 2.131 \\, D = 2.131 \\times 1.2\\,\\mathrm{cm} = 2.5572\\,\\mathrm{cm}\n$$\n接着，我们计算外推厚度 $L_e$：\n$$\nL_e = L + 2 z_{\\mathrm{ex}} = 100\\,\\mathrm{cm} + 2 \\times 2.5572\\,\\mathrm{cm} = 105.1144\\,\\mathrm{cm}\n$$\n有了 $L_e$，我们可以计算几何曲率 $B_g^2$：\n$$\nB_g^2 = \\left(\\frac{\\pi}{L_e}\\right)^2 = \\left(\\frac{\\pi}{105.1144\\,\\mathrm{cm}}\\right)^2 \\approx 0.000893316\\,\\mathrm{cm}^{-2}\n$$\n现在，我们可以计算 $k_{\\mathrm{eff}}$ 表达式分母中的总损失项：\n$$\n\\Sigma_{a} + D B_g^2 = 0.010\\,\\mathrm{cm}^{-1} + (1.2\\,\\mathrm{cm}) \\times (0.000893316\\,\\mathrm{cm}^{-2})\n$$\n$$\n\\Sigma_{a} + D B_g^2 = 0.010\\,\\mathrm{cm}^{-1} + 0.001071979\\,\\mathrm{cm}^{-1} = 0.011071979\\,\\mathrm{cm}^{-1}\n$$\n最后，我们计算 $k_{\\mathrm{eff}}$：\n$$\nk_{\\mathrm{eff}} = \\frac{\\nu \\Sigma_{f}}{\\Sigma_{a} + D B_g^2} = \\frac{0.011\\,\\mathrm{cm}^{-1}}{0.011071979\\,\\mathrm{cm}^{-1}} \\approx 0.99350005\n$$\n按要求将结果四舍五入到四位有效数字，得到 $0.9935$。",
            "answer": "$$\n\\boxed{0.9935}\n$$"
        },
        {
            "introduction": "从连续的物理模型过渡到离散的数值表示后，我们将注意力集中在求解算法本身。本练习将裂变源迭代法抽象为对一个给定矩阵的幂法迭代，让您能够专注于实现迭代步骤、处理归一化、估算本征值，并观察在不同初始猜测和正定性策略下算法的收敛行为 。这有助于您掌握该迭代方法的核心数值机制。",
            "id": "4232373",
            "problem": "考虑一个均匀反应堆中的稳态中子平衡问题，该问题已被离散化为一个从非负裂变源到其下一代裂变源的有限维线性映射。从增殖形式的线性玻尔兹曼输运方程出发，离散化产生一个非负线性算子，该算子将一个裂变源映射到下一代裂变源。将组合的单代映射定义为一个具有非负元的方阵 $\\mathbf{H} \\in \\mathbb{R}^{n \\times n}$，它表示在一个离散的多区域、多能群状态向量中，中子输运、散射和裂变发射过程的组合。$k$-本征值问题旨在求解主本征对 $(k, \\mathbf{s})$，其中 $k > 0$ 且 $\\mathbf{s} \\ge 0$，满足 $\\mathbf{H} \\mathbf{s} = k \\mathbf{s}$，$\\mathbf{s}$ 是一个非负裂变源向量。假定该组合算子是不可约的，根据 Perron–Frobenius 定理，这保证了唯一主本征值和严格正的本征向量的存在。\n\n实现一种裂变源迭代算法，在给定 $\\mathbf{H}$、初始猜测 $\\mathbf{s}^{(0)}$ 和正性强制策略 $\\mathcal{P}$ 的情况下，更新裂变源和估计的增殖因子。核心迭代过程如下：应用映射得到原始传播向量，可选择使用 $\\mathcal{P}$ 强制正性，基于诱导向量范数形成更新的本征值估计，并将裂变源重新归一化至一个固定范数以防止数值上溢或下溢。持续迭代直至本征值估计收敛。\n\n您必须构建一个完整的程序，该程序：\n- 使用给定的算子 $\\mathbf{H}$，其中 $n = 4$，其各项为\n  $\\mathbf{H} = \\begin{bmatrix}\n  0.35  0.20  0.30  0.10 \\\\\n  0.20  0.40  0.10  0.15 \\\\\n  0.25  0.15  0.45  0.20 \\\\\n  0.10  0.15  0.15  0.50\n  \\end{bmatrix}$。\n- 对每个测试用例，接受一个初始裂变源向量 $\\mathbf{s}^{(0)} \\in \\mathbb{R}^4$ 和一个来自以下集合的正性强制策略 $\\mathcal{P}$：\n  1. $\\mathcal{P} = \\text{none}$：不强制正性；原始传播向量按原样使用。\n  2. $\\mathcal{P} = \\text{clip\\_zero}$：将负分量替换为 $0$。\n  3. $\\mathcal{P} = \\text{abs}$：将传播向量替换为其逐分量的绝对值。\n- 使用 $\\ell_1$-范数来估计第 $m$ 次迭代的本征值，公式为 $k^{(m+1)} = \\|\\mathbf{y}^{(m)}\\|_1 / \\|\\mathbf{s}^{(m)}\\|_1$，其中 $\\mathbf{y}^{(m)}$ 是归一化前的传播向量，并重新归一化 $\\mathbf{s}^{(m+1)} = \\mathbf{y}^{(m)} / \\|\\mathbf{y}^{(m)}\\|_1$。\n- 在应用 $\\mathcal{P}$ 之前，检测在任何迭代中原始传播向量 $\\mathbf{y}^{(m)}$ 是否出现任何负项。\n- 当 $k$ 的相对变化满足 $|k^{(m+1)} - k^{(m)}| / \\max(k^{(m)}, 1)  10^{-10}$ 或达到最大迭代次数 $5000$ 次时停止。\n- 仅在需要时使用一个小的严格正微扰 $\\varepsilon = 10^{-14}$ 以避免在归一化过程中出现零向量。\n- 对每个测试用例，生成结果为一个数对 $[k, \\text{flag}]$，其中 $k$ 是收敛的增殖因子，四舍五入到 $8$ 位小数，$\\text{flag}$ 是一个布尔值，指示在任何迭代中（强制正性之前）原始传播向量中是否出现任何负项。程序必须在单行中输出所有测试用例的结果列表，格式为用方括号括起来的逗号分隔列表，其中每个数对也用方括号括起来。\n\n您的程序必须实现上述迭代，并对以下测试套件运行：\n- 测试用例 1 (正常路径)：$\\mathbf{s}^{(0)} = [0.25, 0.25, 0.25, 0.25]$ 且 $\\mathcal{P} = \\text{none}$。\n- 测试用例 2 (符号不足的初始猜测)：$\\mathbf{s}^{(0)} = [1.0, -0.5, 0.3, -0.8]$ 且 $\\mathcal{P} = \\text{none}$。\n- 测试用例 3 (通过裁剪强制正性)：$\\mathbf{s}^{(0)} = [1.0, -0.5, 0.3, -0.8]$ 且 $\\mathcal{P} = \\text{clip\\_zero}$。\n- 测试用例 4 (零初始向量的边界情况)：$\\mathbf{s}^{(0)} = [0.0, 0.0, 0.0, 0.0]$ 且 $\\mathcal{P} = \\text{clip\\_zero}$。\n\n此计算不涉及物理单位。不使用角度。不使用百分比。您的程序应生成单行输出，包含所有结果，格式为用方括号括起来的逗号分隔列表，其中每个测试用例的结果是按规定获得的数对 $[k,\\text{flag}]$（例如，$[[1.01234567,True],[\\dots]]$）。",
            "solution": "所提出的问题是有效的。这是一个适定的数值问题，基于核反应堆物理和数值线性代数的既定原理。它自成体系、客观，并提供了所有必要的数据和约束，以便通过算法确定唯一的解。\n\n该问题要求实现裂变源迭代法（在数学上等同于幂迭代算法），以找到给定矩阵 $\\mathbf{H}$ 的主本征值。这个主本征值用 $k$ 表示，在一个简化的、离散化的核反应堆模型中代表有效中子增殖因子。\n\n控制方程是稳态 $k$-本征值问题：\n$$\n\\mathbf{H} \\mathbf{s} = k \\mathbf{s}\n$$\n这里，$\\mathbf{s}$ 是代表裂变源空间和能量分布的本征向量，$k$ 是相应的本征值。在反应堆物理学中，临界系统的特征是 $k=1$。矩阵 $\\mathbf{H} \\in \\mathbb{R}^{n \\times n}$ 是一个线性算子，它将一代的裂变源分布映射到下一代。其形式如下：\n$$\n\\mathbf{H} = \\begin{bmatrix}\n0.35  0.20  0.30  0.10 \\\\\n0.20  0.40  0.10  0.15 \\\\\n0.25  0.15  0.45  0.20 \\\\\n0.10  0.15  0.15  0.50\n\\end{bmatrix}\n$$\n问题指出 $\\mathbf{H}$ 是非负且不可约的。实际上，给定 $\\mathbf{H}$ 的所有项都是严格正的，$H_{ij}  0$，这是一个更强的条件，称为本原性。对于本原矩阵的 Perron-Frobenius 定理保证存在一个唯一的本征值 $k$，它是实的、正的，并且其模严格大于所有其他本征值的模。这就是主本征值，或称 $k$-本征值。相应的本征向量 $\\mathbf{s}$ 可以被选择为所有分量都严格为正，即 $\\mathbf{s}  0$。\n\n裂变源迭代算法是求解这个主本征对 $(k, \\mathbf{s})$ 的一种数值方法。这是一个迭代过程，从初始猜测 $\\mathbf{s}^{(0)}$ 和初始本征值估计 $k^{(0)}$ 开始，定义如下。对于迭代 $m = 0, 1, 2, \\dots$：\n\n1.  **源传播**：通过将算子 $\\mathbf{H}$ 应用于当前源向量 $\\mathbf{s}^{(m)}$，计算出原始的下一代源向量，我将其表示为 $\\mathbf{y'}^{(m)}$：\n    $$\n    \\mathbf{y'}^{(m)} = \\mathbf{H} \\mathbf{s}^{(m)}\n    $$\n\n2.  **正性强制**：一个可选的正性策略 $\\mathcal{P}$ 应用于原始向量 $\\mathbf{y'}^{(m)}$ 以生成处理后的向量 $\\mathbf{y}^{(m)}$。这些策略是：\n    -   $\\mathcal{P} = \\text{none}$：$\\mathbf{y}^{(m)} = \\mathbf{y'}^{(m)}$。\n    -   $\\mathcal{P} = \\text{clip\\_zero}$：$y_i^{(m)} = \\max(0, y'_i^{(m)})$。\n    -   $\\mathcal{P} = \\text{abs}$：$y_i^{(m)} = |y'_i^{(m)}|$。\n\n3.  **本征值估计**：下一步的本征值 $k^{(m+1)}$ 通过所得源 $\\mathbf{y}^{(m)}$ 和前一步源 $\\mathbf{s}^{(m)}$ 的 $\\ell_1$-范数之比来估计：\n    $$\n    k^{(m+1)} = \\frac{\\|\\mathbf{y}^{(m)}\\|_1}{\\|\\mathbf{s}^{(m)}\\|_1}\n    $$\n    其中 $\\|\\mathbf{v}\\|_1 = \\sum_i |v_i|$。如果 $\\|\\mathbf{s}^{(m)}\\|_1 = 0$，则需要特殊处理，在这种情况下，使用默认值 $k^{(m+1)}=1.0$ 是一个合理的选择，因为这种情况仅在初始向量为零时发生。\n\n4.  **源归一化**：为下一次迭代，将源向量重新归一化，使其具有单位 $\\ell_1$-范数。此步骤对数值稳定性至关重要。\n    $$\n    \\mathbf{s}^{(m+1)} = \\frac{\\mathbf{y}^{(m)}}{\\|\\mathbf{y}^{(m)}\\|_1}\n    $$\n    如果 $\\mathbf{y}^{(m)}$ 是零向量, 其范数为 $0$，会导致除零错误。在这种特定情况下，根据问题要求，在归一化之前必须用一个小的微扰向量替换向量 $\\mathbf{y}^{(m)}$。使用一个所有分量都等于 $\\varepsilon = 10^{-14}$ 的向量。\n\n迭代持续进行，直到本征值估计的相对变化低于指定的容差 $10^{-10}$，即 $|k^{(m+1)} - k^{(m)}| / \\max(k^{(m)}, 1)  10^{-10}$，或直到达到最大迭代次数 $5000$ 次。\n\n在整个过程中，必须用一个布尔标志来跟踪任何原始传播向量 $\\mathbf{y'}^{(m)}$ 是否在任何时候包含负项。这一点很重要，因为虽然物理裂变源必须是非负的，但中间的数值估计，特别是对于带有混合符号的初始猜测 $\\mathbf{s}^{(0)}$，可能会包含负值。\n\n实现将对四个指定的测试用例分别遵循此算法，将矩阵运算与正性策略、收敛性检查和零向量的边界情况处理逻辑相结合。最终收敛的本征值 $k$ 将四舍五入到 8 位小数。",
            "answer": "[[0.94165576,False],[0.94165576,True],[0.94165576,True],[0.94165576,False]]"
        },
        {
            "introduction": "这项综合性练习将前两个实践的知识融为一体。您将构建一个完整的程序，首先对一维扩散方程进行空间离散化（将其转化为矩阵本征值问题），然后应用您已掌握的裂变源迭代算法来求解 $k$ 本征值。此练习的关键环节是将数值结果与解析解进行比较，这是被称为验证与确认（Verification and Validation, VV）的过程。",
            "id": "4232377",
            "problem": "您的任务是构建一个完整且可运行的程序，通过裂变源迭代法使用k-特征值公式估算有效中子增殖因数，并根据解析基准验证数值结果。研究对象是一个长度为 $L$ 的单能、一维均匀平板，两端均为真空边界条件。您的程序必须从第一性原理出发构建离散算子，迭代以收敛到基态k-特征值，并报告在一小组测试集上的验证指标。\n\n从扩散理论中的稳态中子平衡及其本构关系开始：粒子平衡将泄漏和吸收等同于按有效增殖因数缩放的感生裂变产生，而中子流与标量通量梯度成正比。在一个均匀介质中，扩散系数为 $D$，宏观吸收截面为 $\\Sigma_a$（单位 $\\mathrm{cm}^{-1}$），宏观产生截面为 $\\nu\\Sigma_f$（单位 $\\mathrm{cm}^{-1}$），平板几何中的单能控制方程为\n$$\n-\\frac{d}{dx}\\left(D\\frac{d\\phi(x)}{dx}\\right)+\\Sigma_a\\,\\phi(x)=\\frac{1}{k}\\,\\nu\\Sigma_f\\,\\phi(x),\n$$\n其中 $x\\in(0,L)$，真空边界条件为 $\\,\\phi(0)=0\\,$ 和 $\\,\\phi(L)=0\\,$。此处，$\\,\\phi(x)\\,$ 是中子标量通量，单位为 $\\mathrm{n}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$，$\\,k\\,$ 是无量纲的。\n\n使用一个具有 $N$ 个内部未知数、网格间距 $h=L/(N+1)$ 的均匀网格来离散化空间域，并使用二阶中心差分来近似二阶导数。为均匀介质构建离散损失算子 $L$ 和离散裂变算子 $F$。将位于 $x=0$ 和 $x=L$ 的真空边界作为嵌入在差分格式中的 Dirichlet 条件处理。实现经典的裂变源迭代法，以近似算子 $L^{-1}F$ 的最大特征值及其关联的特征函数。该迭代在概念上交替进行两个步骤：用归一化的裂变源求解线性系统以获得新的通量，然后相应地更新全局增殖因数并重新归一化裂变源。使用裂变产生率在整个区域上的积分来定义归一化和更新增殖因数。使用与网格间距 $h$ 一致的均匀求积法来估算积分。\n\n为了验证，具有真空边界的均匀平板的解析模型具有可分离的特征函数，并为基态模式（最小曲率）提供了一个闭式基准。基态模式（$n=1$）的解析有效增殖因数为\n$$\nk_{\\text{anal}}=\\frac{\\nu\\Sigma_f}{\\Sigma_a+D\\left(\\frac{\\pi}{L}\\right)^2},\n$$\n您必须使用此公式来计算您的数值估计 $k_{\\text{num}}$ 的相对验证误差 $\\varepsilon$：\n$$\n\\varepsilon=\\frac{\\left|k_{\\text{num}}-k_{\\text{anal}}\\right|}{k_{\\text{anal}}}.\n$$\n\n实现您的程序以运行以下参数集的测试套件。所有截面单位为 $\\mathrm{cm}^{-1}$，扩散系数单位为 $\\mathrm{cm}$，长度单位为 $\\mathrm{cm}$。有效增殖因数 $k$ 是无量纲的。使用所述的真空边界条件，并将所有相对误差表示为无量纲浮点数。\n\n- 测试用例 1 (一般超临界情况，细网格):\n  - $D=1.0\\,\\mathrm{cm}$, $\\Sigma_a=0.1\\,\\mathrm{cm}^{-1}$, $\\nu\\Sigma_f=0.25\\,\\mathrm{cm}^{-1}$, $L=100.0\\,\\mathrm{cm}$, $N=200$。\n- 测试用例 2 (构造的精确临界情况，中等网格):\n  - $D=1.0\\,\\mathrm{cm}$, $\\Sigma_a=0.1\\,\\mathrm{cm}^{-1}$, $L=50.0\\,\\mathrm{cm}$, $\\nu\\Sigma_f=\\Sigma_a+D\\left(\\frac{\\pi}{L}\\right)^2$ (在您的代码中以浮点数精确计算此值), $N=100$。\n- 测试用例 3 (强次临界情况，粗网格):\n  - $D=1.2\\,\\mathrm{cm}$, $\\Sigma_a=0.2\\,\\mathrm{cm}^{-1}$, $\\nu\\Sigma_f=0.05\\,\\mathrm{cm}^{-1}$, $L=100.0\\,\\mathrm{cm}$, $N=30$。\n\n算法要求：\n- 将标量通量 $\\,\\phi\\,$ 初始化为一个正值场，并定义一个初始裂变源，该源经过归一化，使其在整个区域上的积分等于 $1$。\n- 迭代求解与损失算子和当前归一化裂变源相关的线性系统，以获得下一个通量场。\n- 使用由更新后的通量计算出的感生裂变产额的积分来更新有效增殖因数。\n- 重新归一化裂变源，使其积分等于 $1$，并重复此过程，直到连续迭代之间增殖因数的变化小于指定的容差，或达到指定的最大迭代次数。对于所有测试用例，使用 $|k_{\\text{new}}-k_{\\text{old}}|$ 的收敛容差为 $10^{-12}$，最大迭代次数为 $10000$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，输出相对误差 $\\,\\varepsilon\\,$，四舍五入到八位小数。因此，最后一行必须是以下形式：\n$$\n[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3],\n$$\n其中每个 $\\,\\varepsilon_i\\,$ 都是一个四舍五入到八位小数的无量纲浮点数。最终输出行中不允许有除逗号分隔符和方括号之外的任何额外文本或空格。",
            "solution": "用户要求构建一个数值程序，以求解单能、一维中子扩散方程的基态k-特征值，并根据解析基准验证结果。该解决方案从第一性原理推导而来，始于控制微分方程，然后推导其离散矩阵形式，最后解释迭代求解算法。\n\n长度为 $L$ 的均匀平板的稳态、单能中子扩散控制方程为：\n$$\n-D\\frac{d^2\\phi(x)}{dx^2}+\\Sigma_a\\,\\phi(x)=\\frac{1}{k}\\,\\nu\\Sigma_f\\,\\phi(x), \\quad x \\in (0, L)\n$$\n其中 $D$ 是扩散系数，$\\Sigma_a$ 是宏观吸收截面，$\\nu\\Sigma_f$ 是宏观裂变产生截面，$\\phi(x)$ 是中子标量通量，而 $k$ 是有效中子增殖因数。真空边界条件为 $\\phi(0) = 0$ 和 $\\phi(L) = 0$。\n\n该方程可以表示为算子形式 $\\mathcal{L}\\phi(x) = \\frac{1}{k}\\mathcal{F}\\phi(x)$，其中 $\\mathcal{L} = -D\\frac{d^2}{dx^2} + \\Sigma_a$ 是损失算子（泄漏加吸收），$\\mathcal{F} = \\nu\\Sigma_f$ 是裂变产生算子。\n\n为了对该方程进行数值求解，将空间域 $(0, L)$ 离散化为一个均匀网格，该网格有 $N$ 个内部点 $x_i = i \\cdot h$，其中 $i = 1, 2, \\dots, N$。网格间距为 $h = L/(N+1)$。边界点位于 $x_0=0$ 和 $x_{N+1}=L$，在这些点上通量已知为零。内部点的通量表示为 $\\phi_i = \\phi(x_i)$。\n\n二阶导数项使用二阶中心差分格式进行近似：\n$$\n\\frac{d^2\\phi}{dx^2}\\bigg|_{x_i} \\approx \\frac{\\phi(x_i-h) - 2\\phi(x_i) + \\phi(x_i+h)}{h^2} = \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2}\n$$\n\n将此近似代入每个内部网格点 $i$ 的控制方程，得到一个包含 $N$ 个线性代数方程的方程组：\n$$\n-D\\left(\\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2}\\right) + \\Sigma_a \\phi_i = \\frac{1}{k} \\nu\\Sigma_f \\phi_i\n$$\n这可以重新排列为：\n$$\n-\\frac{D}{h^2}\\phi_{i-1} + \\left(\\frac{2D}{h^2} + \\Sigma_a\\right)\\phi_i - \\frac{D}{h^2}\\phi_{i+1} = \\frac{1}{k} \\nu\\Sigma_f \\phi_i\n$$\n边界条件 $\\phi_0=0$ 和 $\\phi_{N+1}=0$ 分别被并入 $i=1$ 和 $i=N$ 的方程中。\n\n该方程组可以写成矩阵形式：\n$$\n\\mathbf{L}\\vec{\\phi} = \\frac{1}{k}\\mathbf{F}\\vec{\\phi}\n$$\n其中 $\\vec{\\phi} = [\\phi_1, \\phi_2, \\dots, \\phi_N]^T$ 是未知通量值的向量。矩阵 $\\mathbf{L}$ 是离散损失算子，一个 $N \\times N$ 的实对称三对角矩阵，其元素为：\n$$\nL_{ij} =\n\\begin{cases}\n\\frac{2D}{h^2} + \\Sigma_a,  \\text{if } i=j \\\\\n-\\frac{D}{h^2},  \\text{if } |i-j|=1 \\\\\n0,  \\text{otherwise}\n\\end{cases}\n$$\n矩阵 $\\mathbf{F}$ 是离散裂变算子，一个 $N \\times N$ 的对角矩阵，其元素为 $F_{ij} = \\nu\\Sigma_f \\delta_{ij}$。\n\n现在问题变成了一个广义特征值问题。最大的特征值 $k$ 对应于基态模式，它在物理上是最持久的通量形状。我们使用裂变源迭代法来解决这个问题，这是幂迭代算法的一种特定实现。\n\n迭代过程如下：\n设迭代索引为 $m$。我们定义一个裂变源向量 $\\vec{S} = \\nu\\Sigma_f \\vec{\\phi}$。\n该算法在确定由给定源分布产生的通量分布，然后更新源分布和总源强度（与 $k$ 相关）之间进行迭代。\n\n1.  **初始化 ($m=0$)：**\n    - 对通量特征向量 $\\vec{\\phi}^{(0)}$ 作出初始猜测。一个空间均匀的正值向量（例如，一个全为1的向量）是合适的选择，因为可以保证其在基态模式上有非零投影。\n    - 计算初始裂变源：$\\vec{S}^{(0)} = \\nu\\Sigma_f \\vec{\\phi}^{(0)}$。\n    - 通过在区域上对裂变源进行积分来计算特征值的初始估计 $k^{(0)}$。使用简单的矩形求积法，即为 $k^{(0)} = h \\sum_{i=1}^N S_i^{(0)}$。\n    - 为第一次迭代定义一个归一化的裂变源分布：$\\vec{\\psi}^{(0)} = \\vec{S}^{(0)} / k^{(0)}$。根据构造，$h \\sum_{i=1}^N \\psi_i^{(0)} = 1$。\n\n2.  **迭代 ($m = 0, 1, 2, \\dots$)：**\n    a. **求解通量：** 使用前一次迭代的归一化源求解线性系统，以获得下一个通量向量 $\\vec{\\phi}^{(m+1)}$：\n       $$\n       \\mathbf{L}\\vec{\\phi}^{(m+1)} = \\vec{\\psi}^{(m)}\n       $$\n       这对应于找到由一个根据 $\\vec{\\psi}^{(m)}$ 分布的源中子所产生的稳态通量分布。\n    b. **更新源和特征值：**\n       - 计算由更新后的通量产生的新的、未归一化的裂变源：$\\vec{S}^{(m+1)} = \\nu\\Sigma_f \\vec{\\phi}^{(m+1)}$。\n       - 通过对这个新源进行积分来计算新的特征值估计 $k^{(m+1)}$。该值表示在第 $m+1$ 代中，每有一个第 $m$ 代的源中子所产生的裂变中子总数。\n         $$\n         k^{(m+1)} = h \\sum_{i=1}^N S_i^{(m+1)}\n         $$\n    c. **检查收敛性：** 将新的特征值估计与前一个进行比较。如果 $|k^{(m+1)} - k^{(m)}|  \\epsilon_{\\text{tol}}$，其中 $\\epsilon_{\\text{tol}}$ 是一个小的容差，则迭代收敛。\n    d. **归一化源：** 为下一次迭代准备归一化的源：$\\vec{\\psi}^{(m+1)} = \\vec{S}^{(m+1)} / k^{(m+1)}$。\n    e. 如果未收敛，则继续下一次迭代。\n\n收敛后，最终值 $k^{(m+1)}$ 就是我们的数值估计 $k_{\\text{num}}$。将其与解析解进行比较以进行验证。对于宽度为 $L$ 的裸均匀平板，基态模式（$n=1$）的解析特征值为：\n$$\nk_{\\text{anal}}=\\frac{\\nu\\Sigma_f}{\\Sigma_a+D B_g^2} = \\frac{\\nu\\Sigma_f}{\\Sigma_a+D\\left(\\frac{\\pi}{L}\\right)^2}\n$$\n相对误差计算为 $\\varepsilon = |k_{\\text{num}} - k_{\\text{anal}}|/k_{\\text{anal}}$。实现将针对指定的测试用例遵循此过程。",
            "answer": "[0.00016421,0.00000822,0.00287515]"
        }
    ]
}