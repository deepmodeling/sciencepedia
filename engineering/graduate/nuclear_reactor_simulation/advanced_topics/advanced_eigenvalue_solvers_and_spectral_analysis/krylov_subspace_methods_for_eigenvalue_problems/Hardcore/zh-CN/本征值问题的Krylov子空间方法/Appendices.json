{
    "hands_on_practices": [
        {
            "introduction": "幂法是克里洛夫子空间方法中最基础的一种，其收敛速度由主导比（即模最大与次大特征值之比）直接决定。理解这种关系是评估和比较所有迭代特征值求解器效率的基础。本练习通过一个具体的计算，将主导比与达到所需精度所需的迭代次数直接联系起来，让你亲手实践这一核心收敛理论。",
            "id": "4232451",
            "problem": "考虑一个稳态中子平衡问题，该问题导出了一个非均匀热中子反应堆堆芯中的多群裂变源本征值公式。令 $A$ 表示损失算符（包括吸收、迁出散射和泄漏），$F$ 表示裂变产生算符。增殖算符定义为 $K = A^{-1} F$，因此基态本征对满足 $K \\phi_1 = \\lambda_1 \\phi_1$，其中 $\\lambda_1 = k_{\\text{eff}}$ 是有效中子增殖因子（在临界附近 $k_{\\text{eff}} \\approx 1$）。假设 $K$ 是可对角化的，具有一组完备的右本征向量 $\\{\\phi_i\\}_{i=1}^{N}$，这些向量按本征值大小排序 $|\\lambda_1| > |\\lambda_2| \\ge \\cdots \\ge 0$。优势比定义为 $r = |\\lambda_2/\\lambda_1|$，它描述了 Krylov 子空间迭代中非基波模的渐近衰减率。\n\n通过不带正交化或降阶法的简单幂迭代法应用一种 Krylov 子空间方法：从初始猜测 $\\phi^{(0)}$ 开始，后续的迭代解为 $\\phi^{(n)} = K^{n} \\phi^{(0)}$，并且每次迭代解都经过缩放以使其范数保持不变（假设存在一个由内积导出的一致范数，在该内积下本征向量是标准正交的）。\n\n假设：\n- 优势比为 $r = 0.92$。\n- 初始猜测是一个归一化的双模混合，$\\phi^{(0)} = c_1 \\phi_1 + c_2 \\phi_2$，其中 $c_1 = 0.8$，$c_2 = 0.6$，且更高阶模的分量可以忽略不计。\n- 误差因子 $E(n)$ 定义为经过 $n$ 次 Krylov 步数后，归一化迭代解中次模分量的大小与基波模分量大小之比。\n\n仅使用上述物理设置和定义，确定所需的最小整数 Krylov 迭代次数 $n$，使得误差因子满足 $E(n) \\le \\epsilon$，其中 $\\epsilon = 1.0 \\times 10^{-7}$。请将最终答案表示为一个不带单位的整数。",
            "solution": "问题要求计算使误差因子 $E(n)$ 小于或等于指定容差 $\\epsilon$ 所需的最小 Krylov 迭代次数 $n$。所使用的 Krylov 方法是用于寻找增殖算符 $K$ 的主本征对的幂迭代法。\n\n设本征向量的初始猜测为 $\\phi^{(0)}$。问题指定了一个双模混合：\n$$\n\\phi^{(0)} = c_1 \\phi_1 + c_2 \\phi_2\n$$\n其中 $\\phi_1$ 和 $\\phi_2$ 分别是对应于基波模和第一高阶模的本征向量。给定的系数为 $c_1 = 0.8$ 和 $c_2 = 0.6$。本征向量集 $\\{\\phi_i\\}$ 在一个一致的内积下被认为是标准正交的。\n\n幂迭代法生成一个向量序列。经过 $n$ 次迭代后的未归一化向量（我们记作 $\\psi^{(n)}$）是通过将算符 $K$ 应用于初始猜测 $\\phi^{(0)}$ 共 $n$ 次得到的：\n$$\n\\psi^{(n)} = K^n \\phi^{(0)}\n$$\n代入 $\\phi^{(0)}$ 的表达式，并利用算符 $K^n$ 的线性性质：\n$$\n\\psi^{(n)} = K^n (c_1 \\phi_1 + c_2 \\phi_2) = c_1 K^n \\phi_1 + c_2 K^n \\phi_2\n$$\n根据定义，$\\phi_i$ 是 $K$ 的一个本征向量，其本征值为 $\\lambda_i$，因此 $K \\phi_i = \\lambda_i \\phi_i$。这意味着 $K^n \\phi_i = \\lambda_i^n \\phi_i$。应用此性质，我们得到：\n$$\n\\psi^{(n)} = c_1 \\lambda_1^n \\phi_1 + c_2 \\lambda_2^n \\phi_2\n$$\n这个向量 $\\psi^{(n)}$ 表示经过 $n$ 次迭代后、归一化之前的解的状态。基波模分量是 $c_1 \\lambda_1^n \\phi_1$，次模分量是 $c_2 \\lambda_2^n \\phi_2$。\n\n问题将误差因子 $E(n)$ 定义为*归一化*迭代解 $\\phi^{(n)}$ 中次模分量的大小与基波模分量大小之比。归一化迭代解为 $\\phi^{(n)} = \\psi^{(n)}/\\|\\psi^{(n)}\\|$。由于本征向量是标准正交的，归一化迭代解的系数为 $d_1 = \\frac{c_1 \\lambda_1^n}{\\|\\psi^{(n)}\\|}$ 和 $d_2 = \\frac{c_2 \\lambda_2^n}{\\|\\psi^{(n)}\\|}$。在归一化本征向量展开式中，每个分量的大小是其系数的绝对值。因此，误差因子为：\n$$\nE(n) = \\frac{|d_2|}{|d_1|} = \\frac{\\left| \\frac{c_2 \\lambda_2^n}{\\|\\psi^{(n)}\\|} \\right|}{\\left| \\frac{c_1 \\lambda_1^n}{\\|\\psi^{(n)}\\|} \\right|} = \\frac{|c_2| |\\lambda_2|^n}{|c_1| |\\lambda_1|^n}\n$$\n归一化常数 $\\|\\psi^{(n)}\\|$ 被消掉了。误差因子的表达式简化为：\n$$\nE(n) = \\frac{|c_2|}{|c_1|} \\left( \\frac{|\\lambda_2|}{|\\lambda_1|} \\right)^n\n$$\n问题将优势比定义为 $r = |\\lambda_2/\\lambda_1|$。代入这个定义以及给定的系数值 $|c_1| = 0.8$ 和 $|c_2| = 0.6$：\n$$\nE(n) = \\frac{0.6}{0.8} r^n = 0.75 \\ r^n\n$$\n我们已知优势比为 $r = 0.92$。要求的条件是误差因子 $E(n)$ 必须小于或等于容差 $\\epsilon = 1.0 \\times 10^{-7}$。现在我们可以建立不等式来求解 $n$：\n$$\n0.75 \\times (0.92)^n \\le 1.0 \\times 10^{-7}\n$$\n为了求解 $n$，我们首先分离出带指数的项：\n$$\n(0.92)^n \\le \\frac{1.0 \\times 10^{-7}}{0.75} = \\frac{4}{3} \\times 10^{-7}\n$$\n接下来，我们对不等式两边取自然对数：\n$$\n\\ln((0.92)^n) \\le \\ln\\left(\\frac{4}{3} \\times 10^{-7}\\right)\n$$\n$$\nn \\ln(0.92) \\le \\ln\\left(\\frac{4}{3}\\right) + \\ln(10^{-7})\n$$\n由于 $0.92  1$，其自然对数 $\\ln(0.92)$ 是一个负数。因此，当我们除以 $\\ln(0.92)$ 来求解 $n$ 时，必须反转不等号的方向：\n$$\nn \\ge \\frac{\\ln\\left(\\frac{4}{3} \\times 10^{-7}\\right)}{\\ln(0.92)}\n$$\n现在，我们可以计算数值：\n$$\nn \\ge \\frac{\\ln(1.333... \\times 10^{-7})}{\\ln(0.92)}\n$$\n对数的近似值为：\n$$\n\\ln(1.333... \\times 10^{-7}) \\approx -15.83041\n$$\n$$\n\\ln(0.92) \\approx -0.08338\n$$\n代入这些值：\n$$\nn \\ge \\frac{-15.83041}{-0.08338} \\approx 189.856\n$$\n因为 $n$ 必须是表示迭代次数的整数，所以我们必须取满足此条件的最小整数值。这可以通过对结果向上取整得到：\n$$\nn = \\lceil 189.856 \\rceil = 190\n$$\n因此，至少需要 $190$ 次迭代才能将误差因子降低到所要求的容差。",
            "answer": "$$\\boxed{190}$$"
        },
        {
            "introduction": "克里洛夫子空间方法（如Arnoldi方法）的有效性依赖于其生成的里兹值能否快速逼近真实特征值。然而，在反应堆物理中，许多算子是非正常的，这会导致迭代初期的里兹值严重偏离真实谱。本练习通过一个源自离散化方案的简洁但极具代表性的非正常矩阵，让你计算其早期迭代的里兹值，亲眼见证它如何落在远离真实特征值的值域边界上，从而深刻理解非正常性对求解过程带来的挑战。",
            "id": "4232489",
            "problem": "考虑一个简化的单能、单向的中子输运板模型，该模型通过在核反应堆模拟中广泛使用的粗网格迎风有限体积格式进行离散化。对于$k$-本征值模型，所得到的迭代算子可以抽象为一个作用于三单元粗网格通量向量的非正规矩阵$A \\in \\mathbb{C}^{3 \\times 3}$。在这个简化设置中，裂变与损失的迭代由以下公式描述\n$$\nA \\;=\\; I \\;+\\; N, \\quad\nN \\;=\\; \\begin{pmatrix}\n0  L  0 \\\\\n0  0  L \\\\\n0  0  0\n\\end{pmatrix},\n$$\n其中 $L$ 是一个由迎风离散化产生的无量纲流耦合参数。假设$L = 2\\sqrt{2}$。这个矩阵$A$是非正规的，但其所有本征值都等于 $1$，这反映了底层物理目标（主导$k$-本征值）接近于 1，而由离散化引起的非正规性可能会扭曲瞬态瑞利商的行为。\n\n令值域（也称为数值范围）定义为\n$$\nW(A) \\;=\\; \\left\\{ \\frac{x^{*} A x}{x^{*} x} \\;:\\; x \\in \\mathbb{C}^{3} \\setminus \\{0\\} \\right\\},\n$$\n并令其厄米部为\n$$\nH \\;=\\; \\frac{A + A^{*}}{2}.\n$$\n在用于反应堆临界和$\\alpha$-本征值计算的克雷洛夫子空间方法（例如 Arnoldi 方法）中，低迭代次数下的里兹值可能会瞬时地反映值域而非谱，这使得为加速和目标选择谱位移变得复杂。\n\n从上述定义以及$W(A)$的实部极值是厄米部$H$的本征值极值（此性质源于厄米矩阵瑞利商的变分特征）这一基本性质出发，考虑以单位向量$v_{1}$初始化的单步 Arnoldi 过程，其中$v_{1}$取为$H$对应于其最小本征值的归一化本征向量。单步里兹值等于$h_{11} = v_{1}^{*} A v_{1}$。\n\n任务：显式推导$H$，确定其最小本征值及对应的归一化本征向量$v_{1}$，然后对于给定的$A$和$L=2\\sqrt{2}$计算单步里兹值$h_{11} = v_{1}^{*} A v_{1}$。解释为什么这个$h_{11}$量化了里兹值暂时偏离$A$的真实本征值的程度，并因此说明当值域远离谱簇时，位移选择如何会被早期迭代所误导。将您的$h_{11}$最终答案表示为一个实数。无需四舍五入。",
            "solution": "分析过程首先构造矩阵$A$，然后是其厄米部$H$，随后确定寻找起始向量$v_{1}$所需的$H$的谱特性。最后，计算单步里兹值$h_{11}$。\n\n给定参数$L = 2\\sqrt{2}$，矩阵$N$为：\n$$\nN = \\begin{pmatrix}\n0   2\\sqrt{2}  0 \\\\\n0   0  2\\sqrt{2} \\\\\n0   0  0\n\\end{pmatrix}\n$$\n矩阵$A$定义为$A = I + N$，其中$I$是$3 \\times 3$单位矩阵。\n$$\nA = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix} + \\begin{pmatrix}\n0  2\\sqrt{2}  0 \\\\\n0  0  2\\sqrt{2} \\\\\n0  0  0\n\\end{pmatrix} = \\begin{pmatrix}\n1  2\\sqrt{2}  0 \\\\\n0  1  2\\sqrt{2} \\\\\n0  0  1\n\\end{pmatrix}\n$$\n接下来，我们计算$A$的共轭转置，记为$A^{*}$。由于$A$的所有元素都是实数，这等价于转置$A^{T}$。\n$$\nA^{*} = \\begin{pmatrix}\n1  0  0 \\\\\n2\\sqrt{2}  1  0 \\\\\n0  2\\sqrt{2}  1\n\\end{pmatrix}\n$$\n$A$的厄米部为$H = \\frac{A + A^{*}}{2}$。\n$$\nH = \\frac{1}{2} \\left( \\begin{pmatrix}\n1  2\\sqrt{2}  0 \\\\\n0  1  2\\sqrt{2} \\\\\n0  0  1\n\\end{pmatrix} + \\begin{pmatrix}\n1  0  0 \\\\\n2\\sqrt{2}  1  0 \\\\\n0  2\\sqrt{2}  1\n\\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix}\n2  2\\sqrt{2}  0 \\\\\n2\\sqrt{2}  2  2\\sqrt{2} \\\\\n0  2\\sqrt{2}  2\n\\end{pmatrix} = \\begin{pmatrix}\n1  \\sqrt{2}  0 \\\\\n\\sqrt{2}  1  \\sqrt{2} \\\\\n0  \\sqrt{2}  1\n\\end{pmatrix}\n$$\n为求$H$的本征值，我们求解特征方程$\\det(H - \\lambda I) = 0$。\n$$\n\\det \\begin{pmatrix}\n1-\\lambda  \\sqrt{2}  0 \\\\\n\\sqrt{2}  1-\\lambda  \\sqrt{2} \\\\\n0  \\sqrt{2}  1-\\lambda\n\\end{pmatrix} = 0\n$$\n沿第一行展开行列式：\n$$\n(1-\\lambda) \\left[(1-\\lambda)^2 - (\\sqrt{2})^2\\right] - \\sqrt{2} \\left[\\sqrt{2}(1-\\lambda) - 0\\right] = 0\n$$\n$$\n(1-\\lambda) \\left((1-\\lambda)^2 - 2\\right) - 2(1-\\lambda) = 0\n$$\n提出公因子$(1-\\lambda)$：\n$$\n(1-\\lambda) \\left[ (1-\\lambda)^2 - 2 - 2 \\right] = 0\n$$\n$$\n(1-\\lambda) \\left[ (1-\\lambda)^2 - 4 \\right] = 0\n$$\n这给出了$\\lambda$的三个可能解：\n$1 - \\lambda = 0 \\implies \\lambda_1 = 1$\n$(1 - \\lambda)^2 = 4 \\implies 1 - \\lambda = \\pm 2$\n$1 - \\lambda = 2 \\implies \\lambda_2 = -1$\n$1 - \\lambda = -2 \\implies \\lambda_3 = 3$\n$H$的本征值为$\\{-1, 1, 3\\}$。最小本征值为$\\lambda_{\\min} = -1$。\n\n现在我们通过求解$(H - \\lambda_{\\min} I)v = 0$（即$(H+I)v=0$）来找到对应于$\\lambda_{\\min} = -1$的本征向量$v$。\n$$\n\\begin{pmatrix}\n1+1  \\sqrt{2}  0 \\\\\n\\sqrt{2}  1+1  \\sqrt{2} \\\\\n0  \\sqrt{2}  1+1\n\\end{pmatrix} \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{pmatrix}\n2  \\sqrt{2}  0 \\\\\n\\sqrt{2}  2  \\sqrt{2} \\\\\n0  \\sqrt{2}  2\n\\end{pmatrix} \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n由第一行：$2x + \\sqrt{2}y = 0 \\implies y = -\\frac{2}{\\sqrt{2}}x = -\\sqrt{2}x$。\n由第三行：$\\sqrt{2}y + 2z = 0 \\implies z = -\\frac{\\sqrt{2}}{2}y = -\\frac{\\sqrt{2}}{2}(-\\sqrt{2}x) = x$。\n第二行$\\sqrt{2}x + 2y + \\sqrt{2}z = \\sqrt{2}x + 2(-\\sqrt{2}x) + \\sqrt{2}x = 2\\sqrt{2}x - 2\\sqrt{2}x = 0$是一致的。\n因此，任何本征向量的形式均为$c \\begin{pmatrix} 1 \\\\ -\\sqrt{2} \\\\ 1 \\end{pmatrix}$，其中$c$为非零常数。我们选择$c=1$。\n问题陈述起始向量$v_1$必须是归一化的。我们计算其欧几里得范数：\n$$\n\\|v\\|_2 = \\sqrt{1^2 + (-\\sqrt{2})^2 + 1^2} = \\sqrt{1 + 2 + 1} = \\sqrt{4} = 2\n$$\n归一化本征向量$v_1$是：\n$$\nv_1 = \\frac{v}{\\|v\\|_2} = \\frac{1}{2}\\begin{pmatrix} 1 \\\\ -\\sqrt{2} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ -\\sqrt{2}/2 \\\\ 1/2 \\end{pmatrix}\n$$\n最后，我们计算单步里兹值$h_{11} = v_{1}^{*} A v_{1}$。\n首先，我们计算乘积$A v_{1}$：\n$$\nA v_1 = \\begin{pmatrix}\n1  2\\sqrt{2}  0 \\\\\n0  1  2\\sqrt{2} \\\\\n0  0  1\n\\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ -\\sqrt{2}/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix}\n1(1/2) + 2\\sqrt{2}(-\\sqrt{2}/2) + 0 \\\\\n0 + 1(-\\sqrt{2}/2) + 2\\sqrt{2}(1/2) \\\\\n0 + 0 + 1(1/2)\n\\end{pmatrix} = \\begin{pmatrix}\n1/2 - 2 \\\\\n-\\sqrt{2}/2 + \\sqrt{2} \\\\\n1/2\n\\end{pmatrix} = \\begin{pmatrix}\n-3/2 \\\\\n\\sqrt{2}/2 \\\\\n1/2\n\\end{pmatrix}\n$$\n现在，我们计算内积$v_1^{*} (A v_1)$。由于$v_1$是实向量，$v_1^{*} = v_1^{T}$。\n$$\nh_{11} = \\begin{pmatrix} 1/2  -\\sqrt{2}/2  1/2 \\end{pmatrix} \\begin{pmatrix} -3/2 \\\\ \\sqrt{2}/2 \\\\ 1/2 \\end{pmatrix}\n$$\n$$\nh_{11} = \\left(\\frac{1}{2}\\right)\\left(-\\frac{3}{2}\\right) + \\left(-\\frac{\\sqrt{2}}{2}\\right)\\left(\\frac{\\sqrt{2}}{2}\\right) + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = -\\frac{3}{4} - \\frac{2}{4} + \\frac{1}{4} = \\frac{-3-2+1}{4} = \\frac{-4}{4} = -1\n$$\n计算出的单步里兹值为$h_{11} = -1$。\n\n### 意义解释\n矩阵$A$是上三角矩阵，因此其本征值是其对角线元素。所以，$A$的谱为$\\sigma(A) = \\{1\\}$。应用于$A$的本征值算法的目标是找到这个本征值。\n\nArnoldi 方法生成里兹值，它们是$A$的本征值的近似。一个关键性质是所有里兹值必须位于值域$W(A)$内。$W(A)$中任意点$z$的实部由$\\Re(z) = \\frac{x^{*}Hx}{x^{*}x}$给出。一个基本定理指出，$W(A)$上$\\Re(z)$的最小值和最大值分别是$H$的最小和最大本征值。我们已求得$\\lambda_{\\min}(H) = -1$和$\\lambda_{\\max}(H) = 3$。这意味着值域$W(A)$在实轴方向上从$-1$延伸到$3$，这远大于谱的凸包（仅为单点$\\{1\\}$）。这种差异是非正规矩阵的一个标志。\n\n问题指定了一个起始向量$v_1$，它是$H$对应于$\\lambda_{\\min}(H) = -1$的本征向量。这个向量特意探测了值域的极值边界。得到的单步里兹值$h_{11} = v_1^{*} A v_1$为$-1$。这个值与$\\lambda_{\\min}(H)$相同，而后者是$W(A)$中任意点实部的最小可能值。\n\n这个结果说明了在反应堆物理学中遇到的非正规本征值问题中使用克雷洛夫方法的一个关键挑战。本征值的第一个近似值$(h_{11} = -1)$与真实本征值$(\\lambda = 1)$相差甚远。在一个旨在寻找主导$k$-本征值（物理上接近$1$）的实际模拟中，$-1$这个初始估计值具有高度误导性。如果使用这个早期的里兹值来选择加速收敛的位移参数（例如，在位移反演 Arnoldi 方法中），所选的位移将会非常差，可能导致收敛极其缓慢或收敛到非物理模式。早期里兹值探索值域边界而非聚集在本征值周围的现象，是矩阵非正规性的直接后果，在本模型中由迎风离散化参数$L$驱动。",
            "answer": "$$\n\\boxed{-1}\n$$"
        },
        {
            "introduction": "在掌握了基本原理和潜在挑战之后，我们将目光投向实际应用中的高级求解器——重启动分块Arnoldi方法。这种方法功能强大，但其性能并非唾手可得，而是依赖于对算法参数（如重启动长度和块大小）的精心选择。本练习提供了一个贴近实际的性能模型，要求你在收敛速度、计算成本（输运扫描与正交化）和硬件资源（内存）之间进行权衡，以找到最优参数组合，这正是高性能科学计算中性能工程的精髓所在。",
            "id": "4232472",
            "problem": "在一个三维压水反应堆$k$-特征值模拟中，考虑由无矩阵的裂变-输运算子应用所近似的多群中子输运算子的主特征对。迭代求解器使用重启动分块 Arnoldi 方法构建 Krylov 子空间以进行 Rayleigh–Ritz 提取。假设存在以下基本建模要素：\n\n- 基模的中子输运特征值问题被建模为谱问题$A x = \\lambda x$，其中$A$是线性化的固定源算子，它封装了输运扫描、散射和裂变源的应用。输运扫描在不显式组装$A$的情况下执行，而$A$对向量的作用通过先施加源项再进行输运扫描来实现。\n- 块大小为$b$、重启动长度为$m$的重启动分块 Arnoldi 方法在每个周期内构建一个维度为$mb$的子空间，将每个新的$b$向量块与现有基向量进行正交化，并在每个周期结束时执行 Rayleigh–Ritz 提取。\n\n给定以下针对此反应堆问题的、具有物理和计算动机的参数和约束：\n\n1. 基模的谱分离度：令$q = |\\lambda_{2} / \\lambda_{1}| = 0.92$，其中$\\lambda_{1}$是主特征值，$\\lambda_{2}$是幅值第二大的特征值。假设采用重启动 Arnoldi 方法的多项式滤波模型，其中每个周期的残差缩减量约为$q^{m}$，因此要实现残差从$1$缩减到$10^{-6}$，需要的总有效多项式阶数至少为$d^{\\star}$，满足$q^{d^{\\star}} \\leq 10^{-6}$。\n2. 内存约束：存储基向量占用主要内存。每个向量需要$40$兆字节，总可用内存为$3.2$千兆字节。这要求$m b \\leq 80$。\n3. 稳健提取约束：为确保稳定的 Ritz 值和 Ritz 向量提取并降低停滞风险，要求$m \\geq 6$。\n4. 周期内每步的成本模型：\n   - 在一个 Arnoldi 步骤中，对大小为$b$的块进行源应用和输运扫描的时间建模为$T_{\\mathrm{src}}(b) = \\theta_{0} + \\theta_{1} b$，其中$\\theta_{0} = 0.06$秒，表示分摊到块上的设置和边界条件处理时间，$\\theta_{1} = 0.08$秒/右端项，反映了扫描工作量随$b$线性扩展。\n   - 在步骤$j$（周期内$j = 1, 2, \\dots, m$），将输入的$b$向量块与现有的$jb$个基向量进行分块经典 Gram–Schmidt（两遍）正交化的时间建模为\n     $$T_{\\mathrm{orth,step}}(j, b) = 2 \\big( t_{\\mathrm{dot}} + t_{\\mathrm{axpy}} \\big) \\, j b^{2},$$\n     其中$t_{\\mathrm{dot}} = 0.002$秒/等效块内积，$t_{\\mathrm{axpy}} = 0.003$秒/等效块更新，得出$T_{\\mathrm{orth,step}}(j, b) = 0.01 \\, j b^{2}$秒。\n   - 每周期的 Rayleigh–Ritz 和小型稠密特征问题时间近似为常数$T_{\\mathrm{rr}} = 0.02$秒。\n\n5. 对于给定的$b$和$m$，每周期的总时间是周期内$m$次源应用、整个周期的累积正交化以及 Rayleigh–Ritz 时间的总和：\n   $$T_{\\mathrm{cycle}}(b, m) = m \\, T_{\\mathrm{src}}(b) + \\sum_{j=1}^{m} T_{\\mathrm{orth,step}}(j, b) + T_{\\mathrm{rr}}.$$\n\n6. 达到目标残差缩减所需的周期数$L$是满足$q^{L m} \\leq 10^{-6}$的最小整数。\n\n使用这些定义和约束：\n\n- 推导$d^{\\star}$以及用$m$表示的$L$的表达式。\n- 推导$T_{\\mathrm{cycle}}(b, m)$的闭式表达式。\n- 在给定模型下，构建求解总预测时间$T_{\\mathrm{total}}(b, m) = L \\, T_{\\mathrm{cycle}}(b, m)$。\n- 在满足$b \\geq 1$、$m \\geq 6$和$m b \\leq 80$的可行整数对$(b, m)$中，确定使$T_{\\mathrm{total}}(b, m)$最小化的对$(b^{\\star}, m^{\\star})$。\n\n将选定的块大小和重启动长度以单行矩阵$\\begin{pmatrix} b^{\\star}  m^{\\star} \\end{pmatrix}$的形式报告。最终答案无需四舍五入。如果进行任何中间数值计算，请精确执行，不要对最终选择值进行四舍五入。",
            "solution": "### 推导与优化\n\n首先，我们推导所需的总多项式阶数 $d^{\\star}$ 和周期数 $L$。\n条件是 $q^{L m} \\leq 10^{-6}$。问题将 $d^{\\star}$ 定义为所需的最小总阶数。总阶数是 $L m$。\n所以，我们必须有 $L m \\geq d^{\\star}$，其中 $d^{\\star}$ 满足 $q^{d^{\\star}} = 10^{-6}$。\n$$\nd^{\\star} \\ln(q) = \\ln(10^{-6}) = -6 \\ln(10)\n$$\n$$\nd^{\\star} = \\frac{-6 \\ln(10)}{\\ln(q)} = \\frac{-6 \\ln(10)}{\\ln(0.92)}\n$$\n我们定义一个常数 $C = d^{\\star} = \\frac{-6 \\ln(10)}{\\ln(0.92)}$。\n周期数 $L$ 是满足 $L m \\geq C$ 的最小整数。这可以写成：\n$$\nL = \\left\\lceil \\frac{C}{m} \\right\\rceil\n$$\n接下来，我们推导每周期的闭式时间表达式 $T_{\\mathrm{cycle}}(b, m)$。\n$$\nT_{\\mathrm{cycle}}(b, m) = m \\, T_{\\mathrm{src}}(b) + \\sum_{j=1}^{m} T_{\\mathrm{orth,step}}(j, b) + T_{\\mathrm{rr}}\n$$\n代入给定的模型：\n$$\nT_{\\mathrm{cycle}}(b, m) = m (\\theta_{0} + \\theta_{1} b) + \\sum_{j=1}^{m} (0.01 \\, j b^{2}) + T_{\\mathrm{rr}}\n$$\n求和项是一个等差数列：\n$$\n\\sum_{j=1}^{m} (0.01 \\, j b^{2}) = 0.01 \\, b^{2} \\sum_{j=1}^{m} j = 0.01 \\, b^{2} \\frac{m(m+1)}{2} = 0.005 \\, m (m+1) b^{2}\n$$\n所以，周期时间为：\n$$\nT_{\\mathrm{cycle}}(b, m) = m (\\theta_{0} + \\theta_{1} b) + 0.005 \\, m (m+1) b^{2} + T_{\\mathrm{rr}}\n$$\n代入数值 $\\theta_{0}=0.06$、$\\theta_{1}=0.08$ 和 $T_{\\mathrm{rr}}=0.02$：\n$$\nT_{\\mathrm{cycle}}(b, m) = m(0.06 + 0.08 b) + 0.005 \\, m (m+1) b^{2} + 0.02\n$$\n求解总时间为：\n$$\nT_{\\mathrm{total}}(b, m) = L \\cdot T_{\\mathrm{cycle}}(b, m) = \\left\\lceil \\frac{C}{m} \\right\\rceil \\left( 0.06 m + 0.08 m b + 0.005 m(m+1) b^2 + 0.02 \\right)\n$$\n我们需要在满足以下条件的可行整数对 $(b, m)$ 集合上最小化此函数：\n$b \\geq 1$，$m \\geq 6$，$m b \\leq 80$。\n\n我们来分析对于一个固定的 $m$，$T_{\\mathrm{total}}(b, m)$ 对 $b$ 的依赖关系。周期数 $L = \\lceil C/m \\rceil$ 不依赖于 $b$。我们只需分析 $T_{\\mathrm{cycle}}(b, m)$。\n$$\nT_{\\mathrm{cycle}}(b, m) = (0.06 m + 0.02) + (0.08 m) b + (0.005 m(m+1)) b^2\n$$\n对于一个固定的 $m \\geq 6$，这是关于 $b$ 的二次函数。$b$ 和 $b^2$ 项的系数 $0.08 m$ 和 $0.005 m(m+1)$ 均为正。因此，$T_{\\mathrm{cycle}}(b, m)$ 是关于 $b$ 在 $b \\geq 1$ 上的严格增函数。因此，对于任何固定的 $m$，$T_{\\mathrm{total}}(b, m)$ 也是关于 $b$ 严格递增的。\n这意味着对于任何给定的重启动长度 $m$，最小时间在最小可能的块大小处取得，即 $b=1$。\n因此，最优块大小为 $b^{\\star}=1$。\n\n问题现在简化为一个一维优化问题：在可行范围 $m \\geq 6$ 和 $1 \\cdot m \\leq 80$ 内找到最小化 $T_{\\mathrm{total}}(1, m)$ 的整数 $m$。所以我们在整数区间 $[6, 80]$ 中搜索 $m^{\\star}$。\n我们定义要最小化的函数：\n$$\nf(m) = T_{\\mathrm{total}}(1, m) = \\left\\lceil \\frac{C}{m} \\right\\rceil \\left( 0.06 m + 0.08 m (1) + 0.005 m(m+1) (1)^2 + 0.02 \\right)\n$$\n$$\nf(m) = \\left\\lceil \\frac{C}{m} \\right\\rceil \\left( 0.14 m + 0.005 m^2 + 0.005 m + 0.02 \\right)\n$$\n$$\nf(m) = \\left\\lceil \\frac{C}{m} \\right\\rceil \\left( 0.005 m^2 + 0.145 m + 0.02 \\right)\n$$\n我们需要 C 的数值：\n$C = \\frac{-6 \\ln(10)}{\\ln(0.92)} \\approx \\frac{-6 \\times 2.302585}{-0.0833816} \\approx 165.69055$。\n\n函数 $f(m)$ 是一个非增阶梯函数 $L(m) = \\lceil C/m \\rceil$ 与一个严格递增的二次函数 $T(m) = 0.005 m^2 + 0.145 m + 0.02$ 的乘积。结果函数不一定是单调的。我们必须从 $m=6$ 开始计算 $m$ 为整数时的 $f(m)$ 值。\n\n对于 $m=6$：\n$L(6) = \\lceil 165.69055 / 6 \\rceil = \\lceil 27.615 \\rceil = 28$。\n$T(6) = 0.005(6^2) + 0.145(6) + 0.02 = 0.005(36) + 0.87 + 0.02 = 0.18 + 0.87 + 0.02 = 1.07$。\n$f(6) = 28 \\times 1.07 = 29.96$。\n\n对于 $m=7$：\n$L(7) = \\lceil 165.69055 / 7 \\rceil = \\lceil 23.67 \\rceil = 24$。\n$T(7) = 0.005(7^2) + 0.145(7) + 0.02 = 0.005(49) + 1.015 + 0.02 = 0.245 + 1.015 + 0.02 = 1.28$。\n$f(7) = 24 \\times 1.28 = 30.72$。\n\n函数 $f(m)$ 的值在增加。一个连续近似 $f_{approx}(m) \\approx \\frac{C}{m} T(m) = C(0.005m + 0.145 + 0.02/m)$ 的最小值在 $m = \\sqrt{0.02/0.005} = \\sqrt{4} = 2$ 处取得。对于 $m \\geq 6$，连续近似是严格递增的，这表明离散函数的最小值也将在 $m=6$ 处。尽管向上取整函数可能导致局部下降，但由于 $T(m)$ 的强二次增长超过了 $L(m)$ 的 $1/m$ 下降， $f(m)$ 在 $m \\geq 6$ 上的总体趋势是增加的。通过计算一些点可以验证，局部下降不足以低于 $m=6$ 处的值。\n\n因此，最小值出现在 $m$ 的允许最小值处。\n在可行集合中 $m$ 的最小值为 $m=6$。\n因此，最优重启动长度为 $m^{\\star}=6$。\n\n最优对是 $(b^{\\star}, m^{\\star}) = (1, 6)$。该对满足所有约束条件：$b=1 \\geq 1$，$m=6 \\geq 6$，$mb = 1 \\times 6 = 6 \\leq 80$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  6\n\\end{pmatrix}\n}\n$$"
        }
    ]
}