{
    "hands_on_practices": [
        {
            "introduction": "The power of the Wielandt shift lies in its ability to directly manipulate the eigenvalues of the iteration operator to accelerate convergence. This first exercise provides a hands-on derivation of the fundamental relationship between the shift parameter, $w$, the system's original dominance ratio, and the resulting accelerated contraction factor. By working through this calculation, you will gain a core understanding of how to select a shift to achieve a targeted convergence speed, a key skill in optimizing iterative solvers. ",
            "id": "4261247",
            "problem": "In steady-state neutron transport for a critical reactor, the fundamental-mode eigenproblem can be written abstractly as an operator fixed point for the fission source, where a bounded linear operator $\\mathcal{T}$ maps a normalized flux iterate to the next generation. Under standard normalization of the iterate, the dominant eigenvalue of $\\mathcal{T}$ is $1$, and the subdominant eigenvalue has magnitude equal to the dominance ratio $\\hat{d}$, with $0 < \\hat{d} < 1$. Consider an acceleration scheme inspired by the classic Wielandt shift: each outer iteration applies the resolvent-based map defined implicitly by\n$$(\\mathcal{I} - w\\,\\mathcal{T})\\,\\phi^{(m+1)} = \\mathcal{T}\\,\\phi^{(m)},$$\nwith a scalar parameter $w$ chosen to reduce the asymptotic error contraction of the subdominant mode per outer iteration. Assume that the iteration is stable, that is, $0 < w < 1/\\hat{d}$ so that $(\\mathcal{I} - w\\,\\mathcal{T})$ is invertible on the relevant invariant subspace.\n\nStarting from the spectral properties of $\\mathcal{T}$ and the definition of the resolvent map above, determine the value of $w$ that makes the asymptotic error contraction factor equal to a prescribed target $r^{\\ast}$, where $0 < r^{\\ast} < 1$. Use the following data: $\\hat{d} = 0.9$ and $r^{\\ast} = 0.3$.\n\nExpress your answer as a dimensionless scalar, and round your result to four significant figures.",
            "solution": "The problem asks for the value of a parameter $w$ in a Wielandt-style acceleration scheme for a neutron transport eigenproblem, such that the asymptotic error contraction factor is a specified value $r^{\\ast}$.\n\nFirst, we must formalize the iteration process and determine the operator that governs the propagation of the error. The given iteration scheme is defined by the implicit relation:\n$$(\\mathcal{I} - w\\,\\mathcal{T})\\,\\phi^{(m+1)} = \\mathcal{T}\\,\\phi^{(m)}$$\nwhere $\\mathcal{I}$ is the identity operator, $\\mathcal{T}$ is the fission source operator for a critical system, $\\phi^{(m)}$ is the flux iterate at step $m$, and $w$ is the real-valued shift parameter.\n\nBy formally inverting the operator on the left-hand side, we can define the explicit iteration operator $\\mathcal{M}$ which maps $\\phi^{(m)}$ to $\\phi^{(m+1)}$:\n$$\\phi^{(m+1)} = (\\mathcal{I} - w\\,\\mathcal{T})^{-1}\\mathcal{T}\\,\\phi^{(m)} \\equiv \\mathcal{M}\\,\\phi^{(m)}$$\nThe existence of the inverse $(\\mathcal{I} - w\\,\\mathcal{T})^{-1}$ is guaranteed by the problem's stability condition, $0 < w < 1/\\hat{d}$, which ensures that $1$ is not an eigenvalue of $w\\mathcal{T}$.\n\nLet $\\lambda_k$ be the eigenvalues of the operator $\\mathcal{T}$, and let $\\psi_k$ be the corresponding eigenvectors, such that $\\mathcal{T}\\psi_k = \\lambda_k \\psi_k$. The eigenvectors of $\\mathcal{T}$ are also the eigenvectors of any operator that is a function of $\\mathcal{T}$, such as $\\mathcal{M}$. The eigenvalues of $\\mathcal{M}$, which we denote by $\\mu_k$, can be found by applying $\\mathcal{M}$ to an eigenvector $\\psi_k$:\n$$\\mathcal{M}\\psi_k = (\\mathcal{I} - w\\,\\mathcal{T})^{-1}\\mathcal{T}\\psi_k = (\\mathcal{I} - w\\,\\mathcal{T})^{-1}(\\lambda_k \\psi_k) = \\frac{1}{1-w\\lambda_k}(\\lambda_k \\psi_k) = \\frac{\\lambda_k}{1-w\\lambda_k}\\psi_k$$\nThus, the eigenvalues of the iteration operator $\\mathcal{M}$ are given by the mapping $\\mu_k = \\frac{\\lambda_k}{1-w\\lambda_k}$.\n\nThe problem states that for the original operator $\\mathcal{T}$, the dominant eigenvalue is $\\lambda_1 = 1$, corresponding to the fundamental mode solution $\\psi_1$. The subdominant eigenvalues $\\lambda_k$ for $k > 1$ have magnitudes bounded by the dominance ratio $\\hat{d}$, i.e., $|\\lambda_k| \\le \\hat{d}$ for all $k > 1$.\n\nThe iteration is a power-like method, where convergence to the fundamental mode is determined by how quickly the other eigenmodes (the error) decay relative to the fundamental mode. Let the iterate be decomposed as $\\phi^{(m)} = c_1^{(m)}\\psi_1 + \\sum_{k=2}^N c_k^{(m)}\\psi_k$. Applying the operator $\\mathcal{M}$ yields:\n$$\\phi^{(m+1)} = c_1^{(m)}\\mu_1 \\psi_1 + \\sum_{k=2}^N c_k^{(m)}\\mu_k \\psi_k$$\nThe eigenvector $\\psi_1$ corresponds to the eigenvalue $\\mu_1 = \\frac{\\lambda_1}{1-w\\lambda_1} = \\frac{1}{1-w}$. The error components, associated with $\\psi_k$ for $k>1$, are amplified by factors of $\\mu_k$. After each iteration, the solution is typically re-normalized. In the context of the power method, this means the error propagation is governed by the ratio of the subdominant eigenvalues of $\\mathcal{M}$ to the dominant eigenvalue of $\\mathcal{M}$.\n\nTherefore, the asymptotic error contraction factor, $r$, is the spectral radius of the error propagation operator, which is given by:\n$$r = \\sup_{k>1} \\left| \\frac{\\mu_k}{\\mu_1} \\right| = \\sup_{k>1} \\left| \\frac{\\lambda_k / (1 - w\\lambda_k)}{1 / (1-w)} \\right| = \\sup_{k>1} \\left| \\frac{\\lambda_k(1-w)}{1-w\\lambda_k} \\right|$$\nThe problem specifies $0 < w < 1/\\hat{d}$. For the scheme to be an acceleration, we expect $r < \\hat{d}$, which, as will be shown, implies $0 < w < 1$. Assuming this, $|1-w| = 1-w$. The expression for $r$ becomes:\n$$r = (1-w) \\sup_{k>1} \\left| \\frac{\\lambda_k}{1-w\\lambda_k} \\right|$$\nThe problem gives the spectral bound for the subdominant eigenvalues as $\\sup_{k>1}|\\lambda_k| = \\hat{d}$. By the maximum modulus principle for analytic functions, the maximum of $|\\lambda / (1-w\\lambda)|$ over the disk $|\\lambda| \\le \\hat{d}$ must occur on its boundary, $|\\lambda|=\\hat{d}$. So we need to find:\n$$r = (1-w) \\max_{|\\lambda|=\\hat{d}} \\left| \\frac{\\lambda}{1-w\\lambda} \\right| = (1-w) \\frac{\\hat{d}}{\\min_{|\\lambda|=\\hat{d}}|1-w\\lambda|}$$\nLet $\\lambda = \\hat{d} e^{i\\theta}$. The term to minimize is $|1-w\\hat{d}e^{i\\theta}|^2$:\n$$|1-w\\hat{d}e^{i\\theta}|^2 = |(1-w\\hat{d}\\cos\\theta) - i(w\\hat{d}\\sin\\theta)|^2 = (1-w\\hat{d}\\cos\\theta)^2 + (w\\hat{d}\\sin\\theta)^2 = 1 - 2w\\hat{d}\\cos\\theta + w^2\\hat{d}^2$$\nSince $w > 0$ and $\\hat{d} > 0$, this expression is minimized when $\\cos\\theta$ is maximized, i.e., $\\cos\\theta=1$. This corresponds to a real eigenvalue $\\lambda = \\hat{d}$. The minimum value of $|1-w\\lambda|$ is thus $|1-w\\hat{d}|$. The given stability condition $w < 1/\\hat{d}$ ensures $w\\hat{d}<1$, so $1-w\\hat{d} > 0$.\nThe asymptotic error contraction factor is therefore:\n$$r = (1-w) \\frac{\\hat{d}}{1-w\\hat{d}}$$\nWe are given that this factor should be equal to a target value $r^{\\ast}$. We can now solve for $w$:\n$$r^{\\ast} = \\frac{(1-w)\\hat{d}}{1-w\\hat{d}}$$\n$$r^{\\ast}(1-w\\hat{d}) = \\hat{d}(1-w)$$\n$$r^{\\ast} - r^{\\ast}w\\hat{d} = \\hat{d} - w\\hat{d}$$\n$$w\\hat{d} - r^{\\ast}w\\hat{d} = \\hat{d} - r^{\\ast}$$\n$$w\\hat{d}(1 - r^{\\ast}) = \\hat{d} - r^{\\ast}$$\n$$w = \\frac{\\hat{d} - r^{\\ast}}{\\hat{d}(1 - r^{\\ast})}$$\nThe problem provides the numerical values $\\hat{d} = 0.9$ and $r^{\\ast} = 0.3$. Substituting these into the expression for $w$:\n$$w = \\frac{0.9 - 0.3}{0.9(1 - 0.3)} = \\frac{0.6}{0.9 \\times 0.7} = \\frac{0.6}{0.63}$$\n$$w = \\frac{60}{63} = \\frac{20}{21}$$\nTo provide the answer as a decimal rounded to four significant figures:\n$$w \\approx 0.95238095...$$\nRounding to four significant figures gives $0.9524$.\n\nWe verify this result is consistent with our assumptions. Since $0 < r^{\\ast} < \\hat{d} < 1$, both the numerator $(\\hat{d}-r^{\\ast})$ and the denominator $\\hat{d}(1-r^{\\ast})$ are positive, so $w>0$. Also, $w = \\frac{1-r^{\\ast}/\\hat{d}}{1-r^{\\ast}} < 1$ because $\\hat{d}<1$ implies $r^{\\ast}/\\hat{d} > r^{\\ast}$. Thus, the assumption $0 < w < 1$ is correct. The stability condition $w < 1/\\hat{d} = 1/0.9 \\approx 1.111$ is also satisfied, as $0.9524 < 1.111$.\nThe final result is the numerical value for $w$.",
            "answer": "$$\\boxed{0.9524}$$"
        },
        {
            "introduction": "Theoretical understanding is a powerful tool for verification and validation. In this practice problem, you will step into the role of a developer testing a new solver, tasked with diagnosing why an observed convergence rate does not match the theoretical expectation. By comparing the expected behavior of a correctly implemented Wielandt shift with the observed data, you will learn to identify common implementation errors and develop a critical eye for debugging numerical codes. ",
            "id": "4261207",
            "problem": "Consider a two-dimensional neutron diffusion $k$-eigenvalue problem for a pressurized water reactor core, written in operator form as $A \\phi = \\frac{1}{k} F \\phi$, where $A$ is the loss operator and $F$ is the fission production operator. Define the propagation operator $T = A^{-1} F$, so that the right-eigenpairs $(k_i, v_i)$ satisfy $T v_i = k_i v_i$ with $k_1 > k_2 > \\dots > 0$. A Wielandt-shifted power iteration is implemented through the operator $S = (T - \\omega I)^{-1} T$ with a scalar shift $\\omega$.\n\nTo verify the implementation, you measure the per-iteration decay of the projection of the iterates onto the first two right eigenmodes. Let the biorthogonal adjoint (left) eigenvectors $(w_i)$ satisfy $w_i^{\\top} v_j = \\delta_{ij}$, and define the modal content $a_i^{(m)} = w_i^{\\top} \\phi^{(m)}$ for the $m$-th iterate $\\phi^{(m)}$. The observed per-iteration relative decay factor of the second mode with respect to the first is computed as\n$$r_{\\mathrm{obs}} \\approx \\frac{a_2^{(m+1)}/a_1^{(m+1)}}{a_2^{(m)}/a_1^{(m)}}.$$\nIn a test problem, the dominant and subdominant multiplication factors are known (from an independent high-accuracy solver) to be $k_1 = 1.000$ and $k_2 = 0.90$, and the Wielandt shift used in the code is $\\omega = 0.99$. The verification measurements report $r_{\\mathrm{obs}} \\approx +0.90$ with no sign alternation across iterations.\n\nUsing first principles from linear operator theory and the definition of the Wielandt-shifted iteration, derive the theoretically expected relative decay factor $r_w$ for the second mode under correct Wielandt shifting and compare it with the observed value. Then, select the most consistent diagnosis for the discrepancy. Which option best explains the observations?\n\nA. The Wielandt shift is not being applied to the effective iteration operator; the code is effectively performing standard power iteration on $T$, yielding $r_{\\mathrm{obs}} \\approx k_2/k_1$ with no sign alternation.\n\nB. The inner linear solver tolerance is too loose, making the overall error contraction effectively unity per iteration; the observed $r_{\\mathrm{obs}} \\approx 0.90$ indicates near-stagnation.\n\nC. The shift is mistakenly implemented as applying $(T - \\omega I)^{-1}$ without the post-multiplication by $T$, which would yield $r_{\\mathrm{obs}} \\approx \\left|\\frac{k_1 - \\omega}{k_2 - \\omega}\\right|$.\n\nD. The modal projection diagnostic uses a non-biorthogonal inner product that contaminates the measured $a_i^{(m)}$, creating large systematic bias even when the Wielandt shift is correctly implemented.",
            "solution": "The user has provided a problem statement regarding the verification of a Wielandt-shifted power iteration for a nuclear reactor eigenvalue problem. The task is to validate the problem, derive the theoretically expected convergence behavior, compare it to the observed behavior, and diagnose the discrepancy.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- The eigenvalue problem is $A \\phi = \\frac{1}{k} F \\phi$, where $A$ is the loss operator and $F$ is the fission production operator.\n- The propagation operator is $T = A^{-1} F$.\n- The right-eigenpairs are $(k_i, v_i)$ satisfying $T v_i = k_i v_i$, with eigenvalues ordered as $k_1 > k_2 > \\dots > 0$.\n- The Wielandt-shifted iteration operator is $S = (T - \\omega I)^{-1} T$, with a scalar shift $\\omega$.\n- Adjoint (left) eigenvectors $w_i$ are biorthogonal to the right eigenvectors $v_j$, i.e., $w_i^{\\top} v_j = \\delta_{ij}$.\n- The modal content of the $m$-th iterate $\\phi^{(m)}$ is defined as $a_i^{(m)} = w_i^{\\top} \\phi^{(m)}$.\n- The observed per-iteration relative decay factor is $r_{\\mathrm{obs}} \\approx \\frac{a_2^{(m+1)}/a_1^{(m+1)}}{a_2^{(m)}/a_1^{(m)}}$.\n- Known eigenvalues from a reference calculation: $k_1 = 1.000$ and $k_2 = 0.90$.\n- The Wielandt shift used in the implementation is $\\omega = 0.99$.\n- The measured result is $r_{\\mathrm{obs}} \\approx +0.90$, with no sign alternation observed between iterations.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is evaluated against the validation criteria.\n- **Scientifically Grounded:** The problem is set within the standard mathematical framework of numerical linear algebra applied to neutron diffusion theory, a core topic in nuclear engineering. The operators and methods described (power iteration, Wielandt shifting) are well-established. This criterion is met.\n- **Well-Posed:** The problem provides all necessary data ($k_1$, $k_2$, $\\omega$, $r_{\\mathrm{obs}}$) to perform a quantitative analysis. The question is specific and allows for a unique, derivable answer. This criterion is met.\n- **Objective:** The problem uses precise, technical language and is free of subjective or ambiguous statements. All terms are either standard in the field or explicitly defined. This criterion is met.\n- **Flaw Checklist:**\n    1.  **Scientific/Factual Unsoundness:** None.\n    2.  **Non-Formalizable/Irrelevant:** The problem is directly relevant to the specified topic and is fully formalizable.\n    3.  **Incomplete/Contradictory Setup:** The setup is complete and self-consistent.\n    4.  **Unrealistic/Infeasible:** The given numerical values are physically and mathematically plausible for a reactor core simulation.\n    5.  **Ill-Posed/Poorly Structured:** The problem structure leads to a unique analytical conclusion.\n    6.  **Pseudo-Profound/Trivial:** The problem requires a correct understanding of the operator theory behind Wielandt shifting, which is a non-trivial concept.\n    7.  **Outside Scientific Verifiability:** The derivation is based on verifiable principles of linear algebra.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. The solution process will now proceed.\n\n### Derivation and Analysis\n\nThe core of the task is to derive the theoretical relative decay factor, $r_w$, for a correctly implemented Wielandt shift and compare it with the observed value, $r_{\\mathrm{obs}}$.\n\n**1. Eigenvalues of the Wielandt-Shifted Operator**\n\nThe Wielandt-shifted iteration proceeds as $\\phi^{(m+1)} \\propto S \\phi^{(m)}$, where the iteration operator is $S = (T - \\omega I)^{-1} T$. To understand the convergence, we must find the eigenvalues of $S$. Let $v_i$ be an eigenvector of $T$ with eigenvalue $k_i$, such that $T v_i = k_i v_i$.\n\nApplying the operator $S$ to an eigenvector $v_i$:\n$$ S v_i = (T - \\omega I)^{-1} T v_i = (T - \\omega I)^{-1} (k_i v_i) $$\nSince $k_i$ is a scalar, it commutes with the operator:\n$$ S v_i = k_i (T - \\omega I)^{-1} v_i $$\nThe operator $(T - \\omega I)$ acts on $v_i$ as $(T - \\omega I) v_i = T v_i - \\omega v_i = k_i v_i - \\omega v_i = (k_i - \\omega)v_i$. Thus, $v_i$ is also an eigenvector of $(T - \\omega I)$ with eigenvalue $(k_i - \\omega)$. Consequently, $v_i$ is an eigenvector of the inverse operator $(T - \\omega I)^{-1}$ with eigenvalue $(k_i - \\omega)^{-1}$.\n$$ (T - \\omega I)^{-1} v_i = \\frac{1}{k_i - \\omega} v_i $$\nSubstituting this back into the expression for $S v_i$:\n$$ S v_i = k_i \\left( \\frac{1}{k_i - \\omega} v_i \\right) = \\left( \\frac{k_i}{k_i - \\omega} \\right) v_i $$\nTherefore, the operator $S$ has the same eigenvectors $v_i$ as $T$, and its eigenvalues, let's call them $\\lambda_i$, are given by:\n$$ \\lambda_i = \\frac{k_i}{k_i - \\omega} $$\n\n**2. Asymptotic Behavior of the Iteration**\n\nAn initial vector $\\phi^{(0)}$ can be expanded in the basis of eigenvectors: $\\phi^{(0)} = \\sum_i a_i^{(0)} v_i$. After $m$ iterations, ignoring normalization, the vector becomes:\n$$ \\phi^{(m)} \\propto S^m \\phi^{(0)} = \\sum_i a_i^{(0)} S^m v_i = \\sum_i a_i^{(0)} \\lambda_i^m v_i $$\nThe modal content of the $j$-th mode is $a_j^{(m)} = w_j^{\\top} \\phi^{(m)}$. Due to biorthogonality, this projects out the $j$-th component:\n$$ a_j^{(m)} \\propto w_j^{\\top} \\left( \\sum_i a_i^{(0)} \\lambda_i^m v_i \\right) = a_j^{(0)} \\lambda_j^m $$\nThe relative decay factor of the second mode with respect to the first is the per-iteration change in the ratio of their modal contents:\n$$ r_w = \\frac{a_2^{(m+1)}/a_1^{(m+1)}}{a_2^{(m)}/a_1^{(m)}} = \\frac{(a_2^{(0)}\\lambda_2^{m+1})/(a_1^{(0)}\\lambda_1^{m+1})}{(a_2^{(0)}\\lambda_2^{m})/(a_1^{(0)}\\lambda_1^{m})} = \\frac{\\lambda_2}{\\lambda_1} $$\nThis ratio of the subdominant to dominant eigenvalues of the iteration operator $S$ is the theoretical decay factor.\n\n**3. Calculation of the Theoretical Decay Factor**\n\nUsing the given data: $k_1 = 1.000$, $k_2 = 0.90$, and $\\omega = 0.99$.\nFirst, we calculate the dominant and subdominant eigenvalues of $S$:\n$$ \\lambda_1 = \\frac{k_1}{k_1 - \\omega} = \\frac{1.000}{1.000 - 0.99} = \\frac{1.0}{0.01} = 100 $$\n$$ \\lambda_2 = \\frac{k_2}{k_2 - \\omega} = \\frac{0.90}{0.90 - 0.99} = \\frac{0.90}{-0.09} = -10 $$\nThe theoretical relative decay factor $r_w$ is their ratio:\n$$ r_w = \\frac{\\lambda_2}{\\lambda_1} = \\frac{-10}{100} = -0.10 $$\nA correct Wielandt-shifted iteration should therefore exhibit a decay factor of $-0.10$. The negative sign implies that the sign of the ratio $a_2^{(m)}/a_1^{(m)}$ should alternate with each iteration.\n\n**4. Comparison with Observation and Evaluation of Options**\n\nThe observed decay factor is $r_{\\mathrm{obs}} \\approx +0.90$ with no sign alternation. This is a clear and significant discrepancy from the theoretical value $r_w = -0.10$. We now analyze each option to find the most plausible explanation.\n\n**A. The Wielandt shift is not being applied to the effective iteration operator; the code is effectively performing standard power iteration on $T$, yielding $r_{\\mathrm{obs}} \\approx k_2/k_1$ with no sign alternation.**\n- If the code performs a standard power iteration, the iteration operator is simply $T$.\n- The eigenvalues of $T$ are $k_i$.\n- The decay factor for standard power iteration is the ratio of the subdominant to the dominant eigenvalue of $T$, which is $r_{\\mathrm{PI}} = k_2/k_1$.\n- Using the given values: $r_{\\mathrm{PI}} = 0.90 / 1.000 = 0.90$.\n- Since $k_1$ and $k_2$ are both positive, this decay factor is positive, predicting no sign alternation.\n- The calculated $r_{\\mathrm{PI}} = +0.90$ perfectly matches the observed value $r_{\\mathrm{obs}} \\approx +0.90$. This suggests a coding error where the Wielandt shift machinery is bypassed, and the iteration defaults to the unaccelerated power method.\n- **Verdict: Correct.** This option provides a diagnosis that is quantitatively and qualitatively consistent with all available information.\n\n**B. The inner linear solver tolerance is too loose, making the overall error contraction effectively unity per iteration; the observed $r_{\\mathrm{obs}} \\approx 0.90$ indicates near-stagnation.**\n- The Wielandt iteration requires solving a linear system $(F - \\omega A) \\phi^{(m+1)} = F \\phi^{(m)}$ at each step. A loose tolerance in the inner solver for this system can impede the convergence of the outer power iteration.\n- If the inner solve is very poor, the outer iteration can stall, meaning $\\phi^{(m+1)} \\approx \\phi^{(m)}$. In this case, the modal contents would not change significantly, so $a_i^{(m+1)} \\approx a_i^{(m)}$.\n- The relative decay factor would then be $r_{\\mathrm{obs}} \\approx \\frac{a_2^{(m)}/a_1^{(m)}}{a_2^{(m)}/a_1^{(m)}} = 1$.\n- The option claims the contraction is \"effectively unity\" but then equates this to an observed decay of $r_{\\mathrm{obs}} \\approx 0.90$. This is a contradiction. A decay factor of $0.90$ represents consistent, albeit slow, convergence, not stagnation (which implies a decay factor of $1$).\n- **Verdict: Incorrect.** The reasoning within the option is self-contradictory and does not align with the observed numerical value.\n\n**C. The shift is mistakenly implemented as applying $(T - \\omega I)^{-1}$ without the post-multiplication by $T$, which would yield $r_{\\mathrm{obs}} \\approx \\left|\\frac{k_1 - \\omega}{k_2 - \\omega}\\right|$.**\n- This scenario describes a standard \"shift-and-invert\" power iteration, where the operator is $S' = (T - \\omega I)^{-1}$. This method converges to the eigenvector of $T$ whose eigenvalue is closest to the shift $\\omega$.\n- As shown previously, the eigenvalues of $S'$ are $\\mu_i = (k_i - \\omega)^{-1}$.\n- The decay factor for this mistaken iteration would be the ratio of its subdominant to dominant eigenvalues, $r' = \\mu_2 / \\mu_1$. Note that the dominant eigenvalue of $S'$ corresponds to the $k_i$ closest to $\\omega$. Here, $|k_1 - \\omega| = |1.000-0.99| = 0.01$ and $|k_2 - \\omega| = |0.90-0.99|=0.09$. So $k_1$ is closest, and $\\mu_1 = (k_1-\\omega)^{-1}$ is the dominant eigenvalue of $S'$.\n- The decay factor is $r' = \\frac{\\mu_2}{\\mu_1} = \\frac{(k_2-\\omega)^{-1}}{(k_1-\\omega)^{-1}} = \\frac{k_1-\\omega}{k_2-\\omega} = \\frac{1.000-0.99}{0.90-0.99} = \\frac{0.01}{-0.09} = -\\frac{1}{9} \\approx -0.111$.\n- This predicted decay factor is negative and has a magnitude of $\\approx 0.111$. This is grossly inconsistent with the observed $r_{\\mathrm{obs}} \\approx +0.90$. The formula presented in the option, $\\left|\\frac{k_1 - \\omega}{k_2 - \\omega}\\right|$, gives the magnitude but is also inconsistent with the observation.\n- **Verdict: Incorrect.**\n\n**D. The modal projection diagnostic uses a non-biorthogonal inner product that contaminates the measured $a_i^{(m)}$, creating large systematic bias even when the Wielandt shift is correctly implemented.**\n- Let's assume the Wielandt shift is working correctly, so the true decay rate is $r_w = -0.10$. This means the $v_2$ component is decaying very rapidly.\n- After a few iterations, the iterate vector is strongly dominated by the fundamental mode: $\\phi^{(m)} \\approx C v_1$.\n- If the projection vectors used in the diagnostic are not truly biorthogonal to the eigenvectors, the measured second-mode content $a_{2, \\text{meas}}^{(m)}$ would have a spurious contribution from the dominant first mode. This is called modal cross-talk.\n- As $m$ increases, $\\phi^{(m)}$ approaches $v_1$, and both measured modal contents $a_{1, \\text{meas}}^{(m)}$ and $a_{2, \\text{meas}}^{(m)}$ would become proportional to the same dominant component, causing their ratio to approach a constant.\n- If $a_2^{(m)}/a_1^{(m)} \\to \\text{constant}$, then the per-iteration decay factor $r_{\\mathrm{obs}}$ would approach $1$.\n- It is highly improbable that such a measurement error would systematically produce a value of precisely $0.90$, which happens to be the decay factor of an entirely different algorithm (standard power iteration). According to Occam's razor, the simpler explanation—that the other algorithm is actually running—is far more likely.\n- **Verdict: Incorrect.** This is a far less plausible explanation than Option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The ultimate test of a numerical method is its performance on a concrete problem where theory and experiment can be compared. This final exercise guides you through the full workflow of computational science, starting from a simplified physical model of a two-region reactor and culminating in a numerical experiment to validate the theory of Wielandt acceleration. By deriving the system's analytical properties and then implementing the solver to measure its performance against theoretical predictions, you will gain a deep, practical understanding of the method's behavior. ",
            "id": "4261221",
            "problem": "Consider a one-speed steady-state neutron diffusion model in slab geometry with two homogeneous regions. The slab is divided into two adjacent regions indexed by $i \\in \\{1,2\\}$ of widths $h_1$ and $h_2$, diffusion coefficients $D_1$ and $D_2$, absorption cross sections $\\Sigma_{a,1}$ and $\\Sigma_{a,2}$, and neutron production cross sections $\\nu \\Sigma_{f,1}$ and $\\nu \\Sigma_{f,2}$. Vacuum boundary conditions are imposed at the external faces of the slab. Using a coarse finite-volume discretization that lumps each region into a single node, the generalized eigenvalue problem for the neutron multiplication factor $k$ can be approximated by\n$$\nL \\, \\phi \\;=\\; \\frac{1}{k} \\, F \\, \\phi,\n$$\nwhere $\\phi \\in \\mathbb{R}^2$ is the vector of region-averaged scalar fluxes, $L \\in \\mathbb{R}^{2\\times 2}$ collects absorption and leakage, and $F \\in \\mathbb{R}^{2\\times 2}$ is diagonal with fission production. A standard physically consistent choice is\n$$\nL \\;=\\; \\begin{bmatrix}\n\\Sigma_{a,1} + b_1 + c & -c \\\\\n-c & \\Sigma_{a,2} + b_2 + c\n\\end{bmatrix},\n\\quad\nF \\;=\\; \\begin{bmatrix}\n\\nu \\Sigma_{f,1} & 0 \\\\\n0 & \\nu \\Sigma_{f,2}\n\\end{bmatrix},\n$$\nwith interface coupling coefficient\n$$\nc \\;=\\; \\frac{2}{\\frac{h_1}{D_1} + \\frac{h_2}{D_2}},\n$$\nand vacuum boundary leakage coefficients\n$$\nb_1 \\;=\\; \\frac{2 D_1}{h_1}, \\qquad b_2 \\;=\\; \\frac{2 D_2}{h_2}.\n$$\nDefine the operator $M = L^{-1} F$. Its largest eigenvalue is $\\lambda_1$, which gives an analytic reference multiplication factor $k_{\\text{ref}} = 1/\\lambda_1$. The dominance ratio $d$ is defined as $d = |\\lambda_2 / \\lambda_1|$, where $\\lambda_2$ is the subdominant eigenvalue of $M$ by magnitude.\n\nIn power iteration and its accelerated forms for $k$-eigenvalue problems, a Wielandt shift with parameter $w \\in [0,1)$ modifies the iteration operator. Let $\\widehat{M} = M / \\lambda_1$ denote the normalized operator with dominant eigenvalue equal to $1$. Consider the normalized Wielandt-shifted operator\n$$\nS_w \\;=\\; (1 - w) \\, \\left(I - w \\widehat{M}\\right)^{-1} \\, \\widehat{M}.\n$$\nWhen initialized with a non-eigenvector $\\phi_0$, the error component along the subdominant invariant subspace decays linearly with a contraction factor $r_w$ that depends on $w$ and the dominance ratio $d$. Theoretical analysis of the spectral mapping for rational functions of matrices implies a specific rational form for $r_w$ in terms of $d$ and $w$.\n\nYour tasks:\n1. Starting from the diffusion model and the matrix definitions above, derive the analytic expressions for the two eigenvalues of $M$ and hence obtain the analytic reference multiplication factor $k_{\\text{ref}}$. Express your final $k_{\\text{ref}}$ in terms of the entries of $L^{-1}F$ without using numerical approximation in the derivation.\n2. Show, by spectral mapping of rational functions, that the eigenvectors of $S_w$ coincide with those of $\\widehat{M}$, and derive the functional dependence $r_w(w,d)$ for the subdominant contraction factor in terms of the dominance ratio $d$.\n3. Design and implement a numerical experiment for the two-region slab described above to measure the iteration count required to reduce the subdominant component of the flux by a prescribed tolerance for various values of $w$. Use the following physically plausible parameters:\n   - Region widths: $h_1 = 30\\,\\text{cm}$, $h_2 = 30\\,\\text{cm}$.\n   - Diffusion coefficients: $D_1 = 1.2\\,\\text{cm}$, $D_2 = 1.0\\,\\text{cm}$.\n   - Absorption cross sections: $\\Sigma_{a,1} = 0.08\\,\\text{cm}^{-1}$, $\\Sigma_{a,2} = 0.12\\,\\text{cm}^{-1}$.\n   - Neutron production cross sections: $\\nu \\Sigma_{f,1} = 0.20\\,\\text{cm}^{-1}$, $\\nu \\Sigma_{f,2} = 0.18\\,\\text{cm}^{-1}$.\n   - Initial flux: $\\phi_0 = [1.0,\\,0.3]^T$ (dimensionless).\n   - Tolerance for subdominant component reduction: reduce the magnitude of the subdominant component to less than $10^{-10}$ relative to its initial magnitude (dimensionless).\n4. For the test suite of shift parameters $w$ given by the list $[0.0,\\,0.2,\\,0.5,\\,0.9,\\,0.99]$, perform the normalized Wielandt-shifted iteration using $S_w$ and:\n   - Estimate the measured contraction factor $r_w$ by tracking the coefficient of the subdominant component in the eigenbasis of $\\widehat{M}$.\n   - Record the measured iteration count (an integer) needed to achieve the tolerance.\n   - Using your derived theoretical expression for $r_w$, compute the predicted contraction factor and the predicted iteration count for the same tolerance.\n   - Quantify the fit by reporting the root-mean-square difference between the measured and predicted contraction factors across the test suite (dimensionless float).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The output must be of the form\n$$\n[\\;d,\\;k_{\\text{ref}},\\;\\text{rmse},\\;[n_0, n_{0.2}, n_{0.5}, n_{0.9}, n_{0.99}],\\;[n^{\\ast}_0, n^{\\ast}_{0.2}, n^{\\ast}_{0.5}, n^{\\ast}_{0.9}, n^{\\ast}_{0.99}]\\;],\n$$\nwhere $d$ and $k_{\\text{ref}}$ are floats, $\\text{rmse}$ is the root-mean-square error between measured and predicted contraction factors over the test suite, $[n_{\\cdot}]$ is the list of measured iteration counts for the shift parameters in the specified order, and $[n^{\\ast}_{\\cdot}]$ is the list of predicted iteration counts computed from the theoretical contraction factor. No physical units are required in the output since all reported quantities are dimensionless floats or integers.",
            "solution": "The problem requires an analytical and numerical investigation of Wielandt's eigenvalue shifting technique applied to a simplified two-region neutron diffusion problem. The solution is structured in three parts:\n$1$. Derivation of the analytic expressions for the eigenvalues of the iteration matrix $M=L^{-1}F$, leading to the reference multiplication factor $k_{\\text{ref}}$ and the dominance ratio $d$.\n$2$. Analysis of the spectral properties of the Wielandt-shifted operator $S_w$ to derive the theoretical contraction factor $r_w$.\n$3$. Design and implementation of a numerical experiment to validate the theoretical findings by measuring iteration counts and contraction factors for a given set of parameters.\n\n**1. Analytic Eigenvalue Analysis**\n\nThe system is described by the generalized eigenvalue problem $L\\phi = \\frac{1}{k} F\\phi$. The problem statement defines the iteration matrix $M = L^{-1}F$ and the corresponding standard eigenvalue problem $M\\phi = \\lambda \\phi$, where the eigenvalue $\\lambda$ is related to the multiplication factor by $k=1/\\lambda$. We will follow this convention. The largest eigenvalue of $M$, denoted $\\lambda_1$, corresponds to the fundamental mode, and the effective multiplication factor is $k_{\\text{ref}} = 1/\\lambda_1$.\n\nThe matrix $M \\in \\mathbb{R}^{2\\times 2}$ is the product of the inverse leakage-absorption operator $L^{-1}$ and the fission operator $F$. The eigenvalues $\\lambda$ of $M$ are the roots of its characteristic polynomial:\n$$\n\\det(M - \\lambda I) \\;=\\; \\lambda^2 - \\text{tr}(M)\\lambda + \\det(M) \\;=\\; 0\n$$\nThe two eigenvalues are given by the quadratic formula:\n$$\n\\lambda_{1,2} \\;=\\; \\frac{\\text{tr}(M) \\pm \\sqrt{\\text{tr}(M)^2 - 4\\det(M)}}{2}\n$$\nThe operator $L$ is a non-singular M-matrix, meaning its off-diagonal elements are non-positive, and its inverse $L^{-1}$ is a matrix with all non-negative entries. The fission matrix $F$ is a diagonal matrix with non-negative entries. Given the physically plausible parameters where $\\nu\\Sigma_{f,i} > 0$, the matrix $M=L^{-1}F$ has all strictly positive entries. By the Perron-Frobenius theorem for positive matrices, there exists a unique eigenvalue $\\lambda_1$ (the Perron root) that has the largest magnitude. This eigenvalue is real and positive, and its corresponding eigenvector can be chosen to have all positive components. The other eigenvalue, $\\lambda_2$, is also real. Furthermore, because both $\\text{tr}(M)$ and $\\det(M)$ are positive, both eigenvalues $\\lambda_1$ and $\\lambda_2$ must be positive. Therefore, the dominant eigenvalue is:\n$$\n\\lambda_1 \\;=\\; \\frac{\\text{tr}(M) + \\sqrt{\\text{tr}(M)^2 - 4\\det(M)}}{2}\n$$\nThe reference multiplication factor is then $k_{\\text{ref}} = 1/\\lambda_1$. The subdominant eigenvalue is:\n$$\n\\lambda_2 \\;=\\; \\frac{\\text{tr}(M) - \\sqrt{\\text{tr}(M)^2 - 4\\det(M)}}{2}\n$$\nThe dominance ratio $d$ is defined as the ratio of the magnitudes of the subdominant to the dominant eigenvalue. Since both are positive, this is simply:\n$$\nd \\;=\\; \\frac{\\lambda_2}{\\lambda_1}\n$$\n\n**2. Spectral Analysis of the Wielandt-Shifted Operator**\n\nThe Wielandt-shifted iteration is based on the operator $S_w$:\n$$\nS_w \\;=\\; (1 - w) \\, \\left(I - w \\widehat{M}\\right)^{-1} \\, \\widehat{M}\n$$\nwhere $\\widehat{M} = M/\\lambda_1$ is the normalized operator and $w \\in [0,1)$ is the shift parameter. The operator $S_w$ can be expressed as a rational function of $\\widehat{M}$, i.e., $S_w = f(\\widehat{M})$ where the function is $f(x) = \\frac{(1-w)x}{1-wx}$.\n\nThe spectral mapping theorem states that if an operator $A$ has eigenvalues $\\mu_i$ with corresponding eigenvectors $v_i$, then the operator $g(A)$ for a function $g$ has eigenvalues $g(\\mu_i)$ with the same eigenvectors $v_i$. The eigenvalues of $\\widehat{M}$ are $\\mu_1 = \\lambda_1/\\lambda_1 = 1$ and $\\mu_2 = \\lambda_2/\\lambda_1 = d$. The eigenvectors of $\\widehat{M}$ are the same as those of $M$. Applying the spectral mapping theorem to $S_w = f(\\widehat{M})$:\n- The eigenvectors of $S_w$ are identical to the eigenvectors of $\\widehat{M}$ (and $M$).\n- The eigenvalues of $S_w$, denoted $s_i$, are given by $s_i = f(\\mu_i)$.\n\nFor the dominant eigenvalue $\\mu_1=1$:\n$$\ns_1 \\;=\\; f(1) \\;=\\; \\frac{(1-w)(1)}{1-w(1)} \\;=\\; 1\n$$\nFor the subdominant eigenvalue $\\mu_2=d$:\n$$\ns_2 \\;=\\; f(d) \\;=\\; \\frac{(1-w)d}{1-wd}\n$$\nThe convergence rate of the power method applied to $S_w$ is determined by the magnitude of its subdominant eigenvalue, as the dominant eigenvalue is $1$. This magnitude is the contraction factor $r_w$. Since $d = \\lambda_2/\\lambda_1 < 1$ and $w \\in [0,1)$, both the numerator $(1-w)d$ and the denominator $1-wd$ are positive. Thus, the contraction factor is:\n$$\nr_w(w,d) \\;=\\; |s_2| \\;=\\; \\frac{(1-w)d}{1-wd}\n$$\nThis expression provides the theoretical contraction factor as a function of the shift $w$ and the dominance ratio $d$.\n\n**3. Numerical Experiment and Implementation**\n\nThe numerical experiment is designed to compute the reference quantities ($k_{\\text{ref}}, d$) and then, for a suite of shift parameters $w$, compare the theoretically predicted iteration performance with measured results.\n\nFirst, the numerical values for the problem parameters are used to construct the matrices $L$ and $F$:\n- $h_1 = 30$, $h_2 = 30$\n- $D_1 = 1.2$, $D_2 = 1.0$\n- $\\Sigma_{a,1} = 0.08$, $\\Sigma_{a,2} = 0.12$\n- $\\nu\\Sigma_{f,1} = 0.20$, $\\nu\\Sigma_{f,2} = 0.18$\nFrom these, we compute the coupling and leakage coefficients:\n- $c = 2 / (h_1/D_1 + h_2/D_2) = 2/55$\n- $b_1 = 2D_1/h_1 = 0.08$\n- $b_2 = 2D_2/h_2 = 2/30$\nThese values are used to assemble the $2 \\times 2$ matrices $L$ and $F$, and subsequently the iteration matrix $M=L^{-1}F$.\n\nThe algorithm proceeds as follows:\n$1$.  Compute the eigenvalues $\\lambda_1, \\lambda_2$ and eigenvectors $v_1, v_2$ of the matrix $M$.\n$2$.  Calculate the reference multiplication factor $k_{\\text{ref}} = 1/\\lambda_1$ and the dominance ratio $d = \\lambda_2/\\lambda_1$.\n$3$.  Define the initial flux vector $\\phi_0 = [1.0, 0.3]^T$.\n$4$.  Decompose $\\phi_0$ in the eigenbasis of $M$: $\\phi_0 = c_1v_1 + c_2v_2$. This is achieved by solving the linear system $V \\mathbf{c} = \\phi_0$, where $V=[v_1 | v_2]$ is the matrix of eigenvectors and $\\mathbf{c}=[c_1, c_2]^T$. The initial magnitude of the subdominant component is proportional to $|c_2|$.\n$5$.  For each shift parameter $w$ in the test suite $[0.0, 0.2, 0.5, 0.9, 0.99]$:\n    a. **Prediction**: Compute the theoretical contraction factor $r_w^{\\text{pred}} = r_w(w,d)$ and the predicted number of iterations $n^* = \\lceil \\ln(\\text{tol}) / \\ln(r_w^{\\text{pred}}) \\rceil$, where the tolerance is $\\text{tol}=10^{-10}$.\n    b. **Measurement**:\n        i.  Construct the shifted operator $S_w$.\n        ii. To measure the contraction factor, iterate once: $\\phi_1 = S_w \\phi_0$. Decompose $\\phi_1 = c'_1v_1 + c'_2v_2$. The measured contraction factor is $r_w^{\\text{meas}} = |c'_2/c_2|$.\n        iii. To measure the iteration count, initialize $\\phi_k = \\phi_0$ and $n=0$. Repeatedly apply the iteration $\\phi_{k+1} = S_w \\phi_k$, incrementing $n$ at each step. After each step, decompose the current flux vector $\\phi_n = c_{1,n}v_1 + c_{2,n}v_2$. The loop terminates when $|c_{2,n}/c_2| < 10^{-10}$, and the final value of $n$ is recorded.\n$6$.  Finally, compute the root-mean-square error (RMSE) between the measured and predicted contraction factors over the entire test suite of $w$ values.\n\nThe final results, comprising $d$, $k_{\\text{ref}}$, the RMSE, the list of measured iteration counts, and the list of predicted iteration counts, are formatted into the required output string. This entire procedure is implemented in the provided Python code.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Wielandt shift problem by performing analytical derivations\n    and a numerical experiment.\n    \"\"\"\n    \n    # 1. Define physical parameters and construct matrices.\n    h1, h2 = 30.0, 30.0\n    D1, D2 = 1.2, 1.0\n    Sigma_a1, Sigma_a2 = 0.08, 0.12\n    nuSigma_f1, nuSigma_f2 = 0.20, 0.18\n    w_values = [0.0, 0.2, 0.5, 0.9, 0.99]\n    initial_flux = np.array([1.0, 0.3])\n    tolerance = 1e-10\n\n    # Calculate coupling and boundary coefficients\n    c = 2.0 / (h1 / D1 + h2 / D2)\n    b1 = 2.0 * D1 / h1\n    b2 = 2.0 * D2 / h2\n\n    # Construct L and F matrices\n    L = np.array([\n        [Sigma_a1 + b1 + c, -c],\n        [-c, Sigma_a2 + b2 + c]\n    ])\n    F = np.diag([nuSigma_f1, nuSigma_f2])\n    \n    # Construct iteration matrix M\n    L_inv = np.linalg.inv(L)\n    M = L_inv @ F\n\n    # 2. Compute eigenvalues, eigenvectors, k_ref, and dominance ratio\n    eigenvalues, eigenvectors = np.linalg.eig(M)\n\n    # Sort eigenvalues and corresponding eigenvectors by magnitude\n    # np.linalg.eig does not guarantee order, so we must sort.\n    sorted_indices = np.argsort(np.abs(eigenvalues))[::-1]\n    lambdas = eigenvalues[sorted_indices]\n    V = eigenvectors[:, sorted_indices]\n    \n    lambda1 = lambdas[0]\n    lambda2 = lambdas[1]\n\n    # Ensure eigenvalues are real (as expected from theory for positive matrix)\n    # and take the real part to handle potential small imaginary numerical noise.\n    lambda1 = np.real(lambda1)\n    lambda2 = np.real(lambda2)\n\n    k_ref = 1.0 / lambda1\n    d = np.abs(lambda2 / lambda1)\n    \n    # The dominant eigenvector v1 and subdominant v2\n    # Normalizing eigenvectors is good practice, though not strictly necessary here\n    # as the linear system solution for coefficients c is invariant to scaling of V columns.\n    v1 = V[:, 0]\n    v2 = V[:, 1]\n    \n    # 3. Perform numerical experiment for each w\n    measured_iterations = []\n    predicted_iterations = []\n    measured_contractions = []\n    predicted_contractions = []\n    \n    # Decompose initial flux to find initial subdominant coefficient\n    # phi_0 = c1*v1 + c2*v2 -> V * c = phi_0 -> c = V_inv * phi_0\n    V_inv = np.linalg.inv(V)\n    c_initial = V_inv @ initial_flux\n    c2_initial = c_initial[1]\n\n    normalized_M = M / lambda1\n\n    for w in w_values:\n        # Theoretical predictions\n        r_pred = (1.0 - w) * d / (1.0 - w * d)\n        predicted_contractions.append(r_pred)\n        \n        # Predicted iterations: n > log(tol) / log(r_pred)\n        # Using np.ceil gives the smallest integer n satisfying the inequality\n        if r_pred > 1e-15: # Avoid log(0)\n            n_pred = int(np.ceil(np.log(tolerance) / np.log(r_pred)))\n        else: # if r_pred is effectively zero, converges in one step\n             n_pred = 1\n        predicted_iterations.append(n_pred)\n\n        # Numerical simulation\n        # Construct shifted operator S_w\n        Id = np.identity(2)\n        S_w = (1.0 - w) * np.linalg.inv(Id - w * normalized_M) @ normalized_M\n        \n        # Measure contraction factor\n        phi_1 = S_w @ initial_flux\n        c_one_step = V_inv @ phi_1\n        c2_one_step = c_one_step[1]\n        r_meas = np.abs(c2_one_step / c2_initial)\n        measured_contractions.append(r_meas)\n\n        # Measure iteration count\n        phi_k = initial_flux.copy()\n        n_meas = 0\n        # A safety break for very large iteration counts is good practice\n        max_iters = max(10000, n_pred * 2) \n        while n_meas <= max_iters:\n            if np.abs((V_inv @ phi_k)[1] / c2_initial) < tolerance:\n                break\n            phi_k = S_w @ phi_k\n            n_meas += 1\n        \n        measured_iterations.append(n_meas)\n\n    # 4. Calculate RMSE and format output\n    meas_c = np.array(measured_contractions)\n    pred_c = np.array(predicted_contractions)\n    rmse = np.sqrt(np.mean((meas_c - pred_c)**2))\n\n    # Format output as specified\n    n_meas_str = f\"[{','.join(map(str, measured_iterations))}]\"\n    n_pred_str = f\"[{','.join(map(str, predicted_iterations))}]\"\n    \n    result_str = f\"[{d:.12f},{k_ref:.12f},{rmse:.12e},{n_meas_str},{n_pred_str}]\"\n    print(result_str)\n\nsolve()\n```"
        }
    ]
}