{
    "hands_on_practices": [
        {
            "introduction": "幂迭代法是求解反应堆物理中 $k$-特征值问题的核心算法。然而，理论上的简洁有时会掩盖实践中的复杂性。本练习采用一个简化的 $2 \\times 2$ 矩阵模型，旨在揭示一个看似无害的选择——归一化策略——如何极大地影响收敛行为。通过对比“朴素”的分量归一化与数学上更稳健的瑞利商归一化，您将亲身体验不当方法如何导致振荡，并理解为何严谨的数值技术对于确保稳定收敛至关重要。",
            "id": "4219128",
            "problem": "考虑一个处于稳态的热核反应堆的均匀双区粗网格模型。设未知量为维度为 $2$ 的裂变源分布向量 $\\boldsymbol{q}$，并设产生和损失由线性算子表示。其基本近似是稳态平衡的广义特征问题，\n$$\n\\boldsymbol{F}\\,\\boldsymbol{q} \\;=\\; k\\,\\boldsymbol{L}\\,\\boldsymbol{q},\n$$\n其中 $\\boldsymbol{F}$ 是非负产生算子，$\\boldsymbol{L}$ 是正损失算子，$k$ 是有效增殖因子。在离散设置中，取 $\\boldsymbol{L} = \\boldsymbol{I}$（单位矩阵）且\n$$\n\\boldsymbol{F} \\;=\\; \\begin{pmatrix} 1  2 \\\\ 2  1 \\end{pmatrix}.\n$$\n因此 $k$-特征问题简化为 $\\boldsymbol{F}\\,\\boldsymbol{q} = k\\,\\boldsymbol{q}$，一个朴素的幂迭代法使用 $\\boldsymbol{q}_{n+1} = \\boldsymbol{F}\\,\\boldsymbol{q}_n$，并在每一步进行归一化。\n\n定义两种归一化策略：\n- 朴素分量归一化：在形成 $\\boldsymbol{q}_{n+1} = \\boldsymbol{F}\\,\\boldsymbol{q}_n$ 后，重新缩放 $\\boldsymbol{q}_{n+1}$，使其第一个分量等于 $1$，即 $(\\boldsymbol{q}_{n+1})_1 = 1$。每一步通过分量比 $k_n = \\frac{(\\boldsymbol{q}_{n+1})_1}{(\\boldsymbol{q}_n)_1}$ 来估计 $k_n$。使用 $\\boldsymbol{q}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 进行初始化。\n- 针对广义问题 $\\boldsymbol{F}\\,\\boldsymbol{q} = k\\,\\boldsymbol{L}\\,\\boldsymbol{q}$ 的瑞利商归一化：定义\n$$\nk(\\boldsymbol{q}) \\;=\\; \\frac{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{F}\\,\\boldsymbol{q}}{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{L}\\,\\boldsymbol{q}},\n$$\n并在每一步设置 $k_{n+1} = k(\\boldsymbol{q}_n)$，然后更新 $\\boldsymbol{q}_{n+1} = \\frac{1}{k_{n+1}}\\boldsymbol{L}^{-1}\\boldsymbol{F}\\,\\boldsymbol{q}_n$，接着根据 $\\boldsymbol{L}$-内积进行归一化，$\\|\\boldsymbol{q}\\|_{\\boldsymbol{L}}^2 = \\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{L}\\,\\boldsymbol{q}$，使得 $\\|\\boldsymbol{q}_{n+1}\\|_{\\boldsymbol{L}} = 1$。在这个特定情况下，$\\boldsymbol{L} = \\boldsymbol{I}$，所以 $\\|\\boldsymbol{q}\\|_{\\boldsymbol{L}} = \\|\\boldsymbol{q}\\|_{2}$ 是欧几里得范数。\n\n任务：\n1. 通过显式计算前几次迭代，证明朴素分量归一化会引起 $k_n$ 和第二个分量 $(\\boldsymbol{q}_n)_2$ 的振荡。给出在朴素归一化下 $(\\boldsymbol{q}_n)_2$ 的闭式标量递推关系，并确定其不动点是吸引的还是排斥的。\n2. 使用瑞利商归一化，从第一性原理出发解释为什么 $k_n$ 和 $\\boldsymbol{q}_n$ 收敛到基模，并计算该离散反应堆模型的 $k$ 的精确稳定值。将您对 $k$ 的最终答案表示为无单位的单个闭式解析表达式。\n\n您的最终答案必须是单个解析表达式。无需四舍五入。",
            "solution": "该问题要求分析两种幂迭代方案，以寻找简化核反应堆模型的基特征模态。其控制方程是特征值问题 $\\boldsymbol{F}\\,\\boldsymbol{q} = k\\,\\boldsymbol{q}$，其中 $\\boldsymbol{F} = \\begin{pmatrix} 1  2 \\\\ 2  1 \\end{pmatrix}$。\n\n首先，我们根据第一个任务的要求分析朴素分量归一化方法。\n令向量序列表示为 $\\boldsymbol{q}_n$。起始向量为 $\\boldsymbol{q}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。迭代过程为：应用矩阵 $\\boldsymbol{F}$，然后重新缩放所得向量，使其第一个分量为 $1$。在第 $n$ 步，特征值 $k$ 的估计值由矩阵乘法前后第一个分量的比值给出。\n\n我们来计算前几次迭代：\n\n第 $n=0$ 步：\n我们从 $\\boldsymbol{q}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 开始。\n未归一化的下一个向量是 $\\boldsymbol{q}_{1}' = \\boldsymbol{F}\\,\\boldsymbol{q}_0 = \\begin{pmatrix} 1  2 \\\\ 2  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n$k$ 的估计值为 $k_0 = \\frac{(\\boldsymbol{q}_{1}')_1}{(\\boldsymbol{q}_0)_1} = \\frac{1}{1} = 1$。\n新的归一化向量 $\\boldsymbol{q}_1$ 是通过确保其第一个分量为 $1$ 得到的。由于 $(\\boldsymbol{q}_{1}')_1$ 已经是 $1$，我们有 $\\boldsymbol{q}_1 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n\n第 $n=1$ 步：\n我们从 $\\boldsymbol{q}_1 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 开始。\n未归一化的下一个向量是 $\\boldsymbol{q}_{2}' = \\boldsymbol{F}\\,\\boldsymbol{q}_1 = \\begin{pmatrix} 1  2 \\\\ 2  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1 + 2(2) \\\\ 2(1) + 1(2) \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}$。\n$k$ 的估计值为 $k_1 = \\frac{(\\boldsymbol{q}_{2}')_1}{(\\boldsymbol{q}_1)_1} = \\frac{5}{1} = 5$。\n新的归一化向量是 $\\boldsymbol{q}_2 = \\frac{1}{5}\\boldsymbol{q}_{2}' = \\frac{1}{5}\\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{4}{5} \\end{pmatrix}$。\n\n第 $n=2$ 步：\n我们从 $\\boldsymbol{q}_2 = \\begin{pmatrix} 1 \\\\ \\frac{4}{5} \\end{pmatrix}$ 开始。\n未归一化的下一个向量是 $\\boldsymbol{q}_{3}' = \\boldsymbol{F}\\,\\boldsymbol{q}_2 = \\begin{pmatrix} 1  2 \\\\ 2  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} 1 + 2(\\frac{4}{5}) \\\\ 2(1) + \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{13}{5} \\\\ \\frac{14}{5} \\end{pmatrix}$。\n$k$ 的估计值为 $k_2 = \\frac{(\\boldsymbol{q}_{3}')_1}{(\\boldsymbol{q}_2)_1} = \\frac{13/5}{1} = \\frac{13}{5} = 2.6$。\n新的归一化向量是 $\\boldsymbol{q}_3 = \\frac{1}{13/5}\\boldsymbol{q}_{3}' = \\frac{5}{13}\\begin{pmatrix} \\frac{13}{5} \\\\ \\frac{14}{5} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{14}{13} \\end{pmatrix}$。\n\n第 $n=3$ 步：\n我们从 $\\boldsymbol{q}_3 = \\begin{pmatrix} 1 \\\\ \\frac{14}{13} \\end{pmatrix}$ 开始。\n未归一化的下一个向量是 $\\boldsymbol{q}_{4}' = \\boldsymbol{F}\\,\\boldsymbol{q}_3 = \\begin{pmatrix} 1  2 \\\\ 2  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\frac{14}{13} \\end{pmatrix} = \\begin{pmatrix} 1 + 2(\\frac{14}{13}) \\\\ 2 + \\frac{14}{13} \\end{pmatrix} = \\begin{pmatrix} \\frac{41}{13} \\\\ \\frac{40}{13} \\end{pmatrix}$。\n$k$ 的估计值为 $k_3 = \\frac{(\\boldsymbol{q}_{4}')_1}{(\\boldsymbol{q}_3)_1} = \\frac{41/13}{1} = \\frac{41}{13} \\approx 3.1538$。\n\n特征值估计序列为 $k_n: 1, 5, 2.6, 41/13 \\approx 3.1538, \\dots$。该序列不是单调收敛的，它在振荡。\n向量 $\\boldsymbol{q}_n$ 的第二个分量的序列是 $(\\boldsymbol{q}_n)_2: 0, 2, 4/5=0.8, 14/13 \\approx 1.077, \\dots$。该序列也表现出振荡行为。\n\n为了找到 $(\\boldsymbol{q}_n)_2$ 的闭式标量递推关系，我们记 $y_n = (\\boldsymbol{q}_n)_2$。根据归一化规则，对于 $n \\ge 1$，向量的形式为 $\\boldsymbol{q}_n = \\begin{pmatrix} 1 \\\\ y_n \\end{pmatrix}$。迭代为 $\\boldsymbol{q}_{n+1}' = \\boldsymbol{F}\\,\\boldsymbol{q}_n$。\n$$ \\boldsymbol{q}_{n+1}' = \\begin{pmatrix} 1  2 \\\\ 2  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ y_n \\end{pmatrix} = \\begin{pmatrix} 1 + 2y_n \\\\ 2 + y_n \\end{pmatrix} $$\n为得到 $\\boldsymbol{q}_{n+1}$，我们通过除以第一个分量来进行归一化：\n$$ \\boldsymbol{q}_{n+1} = \\frac{1}{1+2y_n} \\begin{pmatrix} 1+2y_n \\\\ 2+y_n \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{2+y_n}{1+2y_n} \\end{pmatrix} $$\n因此，$y_{n+1} = (\\boldsymbol{q}_{n+1})_2$ 的递推关系为：\n$$ y_{n+1} = f(y_n) = \\frac{2+y_n}{1+2y_n} $$\n该递推关系的不动点 $y^*$ 满足 $y^* = f(y^*)$：\n$$ y^* = \\frac{2+y^*}{1+2y^*} \\implies y^*(1+2y^*) = 2+y^* \\implies y^* + 2(y^*)^2 = 2+y^* \\implies 2(y^*)^2 = 2 $$\n这得到 $(y^*)^2=1$，所以不动点是 $y^*=1$ 和 $y^*=-1$。它们对应于特征向量 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 在被缩放以使第一个分量为 $1$ 之后的形式。\n\n为了确定不动点是吸引的还是排斥的，我们分析递推函数 $f(y) = \\frac{2+y}{1+2y}$ 在不动点处的导数。\n$$ f'(y) = \\frac{d}{dy}\\left(\\frac{2+y}{1+2y}\\right) = \\frac{(1)(1+2y) - (2+y)(2)}{(1+2y)^2} = \\frac{1+2y-4-2y}{(1+2y)^2} = \\frac{-3}{(1+2y)^2} $$\n在 $y^*=1$ 处：\n$$ f'(1) = \\frac{-3}{(1+2(1))^2} = \\frac{-3}{3^2} = -\\frac{1}{3} $$\n由于 $|f'(1)| = \\frac{1}{3}  1$，不动点 $y^*=1$ 是吸引的。导数的负号表明迭代值在收敛时围绕不动点振荡，这与我们最初的计算结果一致。\n在 $y^*=-1$ 处：\n$$ f'(-1) = \\frac{-3}{(1+2(-1))^2} = \\frac{-3}{(-1)^2} = -3 $$\n由于 $|f'(-1)| = 3  1$，不动点 $y^*=-1$ 是排斥的。\n\n现在进行第二个任务，我们分析瑞利商归一化。幂迭代法，其一般形式为 $\\boldsymbol{q}_{n+1} = C_n \\boldsymbol{F} \\boldsymbol{q}_n$，其中 $C_n$ 是一个归一化常数，它会收敛到与模最大的特征值相关联的特征向量。设 $\\boldsymbol{F}$ 的特征值为 $k_1, k_2, \\dots$，按模排序为 $|k_1|  |k_2| \\ge \\dots$，对应的特征向量为 $\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\dots$。任意初始向量 $\\boldsymbol{q}_0$ 都可以表示为这些特征向量的线性组合：$\\boldsymbol{q}_0 = \\sum_i a_i \\boldsymbol{v}_i$。重复应用 $\\boldsymbol{F}$ 可得 $\\boldsymbol{F}^n \\boldsymbol{q}_0 = \\sum_i a_i k_i^n \\boldsymbol{v}_i$。提出主特征值项 $k_1^n$：\n$$ \\boldsymbol{F}^n \\boldsymbol{q}_0 = k_1^n \\left( a_1 \\boldsymbol{v}_1 + \\sum_{i1} a_i \\left(\\frac{k_i}{k_1}\\right)^n \\boldsymbol{v}_i \\right) $$\n由于对于 $i1$ 有 $|k_i/k_1|  1$，当 $n\\to\\infty$ 时，求和中的项会消失。只要 $a_1 \\neq 0$，向量 $\\boldsymbol{F}^n \\boldsymbol{q}_0$ 会变得越来越平行于主特征向量 $\\boldsymbol{v}_1$。因此，归一化向量序列 $\\boldsymbol{q}_n$ 会收敛到 $\\boldsymbol{v}_1$ 的一个归一化倍数。\n\n瑞利商定义为 $k(\\boldsymbol{q}) = \\frac{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{F}\\,\\boldsymbol{q}}{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{L}\\,\\boldsymbol{q}}$。当 $\\boldsymbol{L}=\\boldsymbol{I}$ 时，这是 $k(\\boldsymbol{q}) = \\frac{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{F}\\,\\boldsymbol{q}}{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{q}}$。当 $\\boldsymbol{q}_n$ 收敛到 $\\boldsymbol{v}_1$ 的方向时，比如 $\\boldsymbol{q}_n \\to \\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}$，瑞利商收敛到主特征值：\n$$ \\lim_{n\\to\\infty} k(\\boldsymbol{q}_n) = \\frac{\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)^{\\mathsf{T}}\\boldsymbol{F}\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)}{\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)^{\\mathsf{T}}\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)} = \\frac{\\frac{1}{\\|\\boldsymbol{v}_1\\|^2} \\boldsymbol{v}_1^{\\mathsf{T}}(k_1 \\boldsymbol{v}_1)}{1} = k_1 \\frac{\\boldsymbol{v}_1^{\\mathsf{T}}\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|^2} = k_1 $$\n因此，瑞利商估计序列 $k_n$ 将收敛到主特征值 $k_1$。对于对称矩阵 $\\boldsymbol{F}$，这种收敛是稳健的，并且通常比其他 $k$ 的估计方法更快。\n\n为了计算该反应堆模型的 $k$ 的精确稳定值，我们必须找到矩阵 $\\boldsymbol{F}$ 的最大特征值。特征值是特征方程 $\\det(\\boldsymbol{F} - k\\boldsymbol{I}) = 0$ 的根。\n$$ \\det\\begin{pmatrix} 1-k  2 \\\\ 2  1-k \\end{pmatrix} = 0 $$\n$$ (1-k)^2 - (2)(2) = 0 $$\n$$ (1-k)^2 = 4 $$\n对两边取平方根得到：\n$$ 1-k = \\pm 2 $$\n这产生两个特征值：\n1. $1-k = 2 \\implies k = -1$\n2. $1-k = -2 \\implies k = 3$\n\n特征值为 $k_1 = 3$ 和 $k_2 = -1$。幂迭代法收敛到对应于绝对值最大特征值的特征向量，即 $|k_1|=3  |k_2|=1$。在反应堆物理学中，基模与最大正实特征值（Perron-Frobenius 特征值）相关联，这在物理上对应于稳态的、自我维持的链式反应。两个标准都指向 $k=3$。因此，$k$ 的稳定值为 $3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在掌握了迭代法的基础之后，我们将进一步探究反应堆的物理模型如何影响收敛性。本练习转向一个更具体的物理情景：一个双能群扩散系统。您将发现一个深刻的特性，即当裂变中子能谱是可分离的时，裂变源的空间分布形状仅需一次迭代即可收敛。这项实践将矩阵的“秩”这一抽象代数概念与控制收敛速度的“优势比”直接联系起来，为您提供了一个强大的分析工具。",
            "id": "4219116",
            "problem": "考虑一个均匀双能群反应堆区域，该区域由包含中子增殖的稳態多群扩散平衡方程建模。假设空间通量形状是可分离的，并固定为由几何曲率 $B^{2}$ 表征的基本空间模态，因此每个能群 $g \\in \\{1,2\\}$ 中的泄漏项表示为 $D_{g} B^{2}$。能量耦合包括从群1到群2的向下散射和从群2到群1的向上散射。裂变中子以固定的、按群的份额产生，该份额由裂变谱分量 $(\\chi_{1}, \\chi_{2})$ 给出。材料参数如下：\n\n- 扩散系数: $D_{1} = 1.5 \\ \\text{cm}$, $D_{2} = 0.5 \\ \\text{cm}$。\n- 几何曲率: $B^{2} = 2.5 \\times 10^{-3} \\ \\text{cm}^{-2}$。\n- 吸收截面: $\\Sigma_{a,1} = 0.01 \\ \\text{cm}^{-1}$, $\\Sigma_{a,2} = 0.09 \\ \\text{cm}^{-1}$。\n- 散射截面 (移出群和群间): $\\Sigma_{s,1 \\to 2} = 0.12 \\ \\text{cm}^{-1}$, $\\Sigma_{s,2 \\to 1} = 0.015 \\ \\text{cm}^{-1}$。\n- 裂变产生的中子: $\\nu \\Sigma_{f,1} = 0.02 \\ \\text{cm}^{-1}$, $\\nu \\Sigma_{f,2} = 0.16 \\ \\text{cm}^{-1}$。\n- 裂变谱份额: $\\chi_{1} = 0.98$, $\\chi_{2} = 0.02$。\n\n从基于粒子平衡和移出截面定义 $\\Sigma_{r,g} = \\Sigma_{a,g} + \\sum_{h \\neq g} \\Sigma_{s,g \\to h}$ 的双群扩散 $k$-特征值公式出发。利用这些基本表述和固定基本空间形状的假设（通过 $B^{2}$），推导在求解 $k$-特征值问题的外源迭代中，将一个裂变源向量映射到下一个裂变源向量的块算子。然后，对于给定的数值参数，计算该块算子的特征值，以及相应的优势比，定义为 $r = |\\lambda_{2}| / |\\lambda_{1}|$，其中 $|\\lambda_{1}| \\geq |\\lambda_{2}|$ 是其两个特征值的模。将最终的优势比表示为一个无量纲数。最终答案无需进行四舍五入。",
            "solution": "该问题要求推导一个双群、稳态 $k$-特征值问题的源迭代算子，并随后计算其特征值的优势比。\n\n首先，我们根据所提供的物理描述来构建问题。对于均匀介质，假设其基本空间模态形状固定，由几何曲率 $B^2$ 表征，其稳态中子平衡可以写成一组代数方程。扩散方程中的项 $-\\nabla \\cdot D_g \\nabla \\phi_g$ 变为 $D_g B^2 \\phi_g$。每个能群 $g$ 的平衡方程为：\n$$\n\\text{泄漏} + \\text{吸收} + \\text{移出散射} = \\text{移入散射} + \\text{裂变源}\n$$\n对于双能群系统 ($g \\in \\{1,2\\}$)，这得出：\n群 1:\n$$\nD_1 B^2 \\phi_1 + \\Sigma_{a,1} \\phi_1 + \\Sigma_{s,1 \\to 2} \\phi_1 = \\Sigma_{s,2 \\to 1} \\phi_2 + \\frac{1}{k} \\chi_1 (\\nu\\Sigma_{f,1} \\phi_1 + \\nu\\Sigma_{f,2} \\phi_2)\n$$\n群 2:\n$$\nD_2 B^2 \\phi_2 + \\Sigma_{a,2} \\phi_2 + \\Sigma_{s,2 \\to 1} \\phi_2 = \\Sigma_{s,1 \\to 2} \\phi_1 + \\frac{1}{k} \\chi_2 (\\nu\\Sigma_{f,1} \\phi_1 + \\nu\\Sigma_{f,2} \\phi_2)\n$$\n其中 $\\phi_g$ 是群 $g$ 中的标量通量，$k$ 是有效增殖因子。\n\n这些方程可以被重排并写成矩阵形式。我们将除裂变源外的所有项移到左边：\n$$\n(D_1 B^2 + \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}) \\phi_1 - \\Sigma_{s,2 \\to 1} \\phi_2 = \\frac{1}{k} ( \\chi_1 \\nu\\Sigma_{f,1} \\phi_1 + \\chi_1 \\nu\\Sigma_{f,2} \\phi_2 )\n$$\n$$\n(D_2 B^2 + \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1}) \\phi_2 - \\Sigma_{s,1 \\to 2} \\phi_1 = \\frac{1}{k} ( \\chi_2 \\nu\\Sigma_{f,1} \\phi_1 + \\chi_2 \\nu\\Sigma_{f,2} \\phi_2 )\n$$\n这可以表示为矩阵特征值方程 $\\mathbf{A}\\vec{\\phi} = \\frac{1}{k} \\mathbf{F}\\vec{\\phi}$，其中 $\\vec{\\phi} = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix}$。\n\n矩阵 $\\mathbf{A}$ 代表中子的净移出（泄漏、吸收和从一个群中的净散射移出）：\n$$\n\\mathbf{A} = \\begin{pmatrix} D_1 B^2 + \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}  -\\Sigma_{s,2 \\to 1} \\\\ -\\Sigma_{s,1 \\to 2}  D_2 B^2 + \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} \\end{pmatrix}\n$$\n问题将移出截面定义为 $\\Sigma_{r,g} = \\Sigma_{a,g} + \\sum_{h \\neq g} \\Sigma_{s,g \\to h}$。因此，$\\Sigma_{r,1} = \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}$ 且 $\\Sigma_{r,2} = \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1}$。矩阵 $\\mathbf{A}$ 的对角元素为 $A_{gg} = D_g B^2 + \\Sigma_{r,g}$。\n\n矩阵 $\\mathbf{F}$ 代表裂变中子的产生：\n$$\n\\mathbf{F} = \\begin{pmatrix} \\chi_1 \\nu\\Sigma_{f,1}  \\chi_1 \\nu\\Sigma_{f,2} \\\\ \\chi_2 \\nu\\Sigma_{f,1}  \\chi_2 \\nu\\Sigma_{f,2} \\end{pmatrix} = \\begin{pmatrix} \\chi_1 \\\\ \\chi_2 \\end{pmatrix} \\begin{pmatrix} \\nu\\Sigma_{f,1}  \\nu\\Sigma_{f,2} \\end{pmatrix}^T = \\vec{\\chi}(\\boldsymbol{\\nu\\Sigma_f})^T\n$$\n源迭代法（或幂迭代法）被用来求解此特征值问题。在此背景下，“裂变源向量”是表示按群产生裂变中子的向量，即 $\\vec{f} = \\mathbf{F}\\vec{\\phi}$。迭代过程如下：给定来自上一次迭代的源向量 $\\vec{f}_i$，首先求解通量：\n$$\n\\mathbf{A}\\vec{\\phi}_{i+1} = \\frac{1}{k_i}\\vec{f}_i \\implies \\vec{\\phi}_{i+1} = \\frac{1}{k_i} \\mathbf{A}^{-1}\\vec{f}_i\n$$\n然后，使用这个通量计算一个新的源向量：\n$$\n\\vec{f}_{i+1} = \\mathbf{F}\\vec{\\phi}_{i+1} = \\mathbf{F} \\left( \\frac{1}{k_i} \\mathbf{A}^{-1}\\vec{f}_i \\right) = \\frac{1}{k_i} (\\mathbf{F}\\mathbf{A}^{-1})\\vec{f}_i\n$$\n“将一个裂变源向量映射到下一个的块算子”是矩阵 $\\mathbf{H} = \\mathbf{F}\\mathbf{A}^{-1}$。幂迭代法收敛到 $\\mathbf{H}$ 矩阵对应最大模特征值的特征向量。$\\mathbf{H}$ 的特征值是 $k$ 的可能值。主特征值 $\\lambda_1$ 就是有效增殖因子 $k_{eff}$。\n\n问题要求的是优势比 $r = |\\lambda_2|/|\\lambda_1|$，其中 $|\\lambda_1| \\ge |\\lambda_2|$ 是 $\\mathbf{H}$ 特征值的模。\n\n必须对裂变矩阵 $\\mathbf{F}$ 的结构进行一个关键的观察。如上所示，$\\mathbf{F}$ 是裂变谱向量 $\\vec{\\chi}$ 和裂变产生向量 $(\\boldsymbol{\\nu\\Sigma_f})^T$ 的外积。两个向量的外积得到一个秩为1的矩阵。\n算子 $\\mathbf{H}$ 是 $\\mathbf{F}$（一个秩为1的矩阵）和 $\\mathbf{A}^{-1}$ 的乘积。我们必须首先验证 $\\mathbf{A}$ 是可逆的。\n让我们使用给定的参数计算 $\\mathbf{A}$ 的元素：\n$D_1 = 1.5 \\ \\text{cm}$, $D_2 = 0.5 \\ \\text{cm}$, $B^2 = 2.5 \\times 10^{-3} \\ \\text{cm}^{-2}$。\n$\\Sigma_{a,1} = 0.01 \\ \\text{cm}^{-1}$, $\\Sigma_{a,2} = 0.09 \\ \\text{cm}^{-1}$。\n$\\Sigma_{s,1 \\to 2} = 0.12 \\ \\text{cm}^{-1}$, $\\Sigma_{s,2 \\to 1} = 0.015 \\ \\text{cm}^{-1}$。\n$D_1 B^2 = 1.5 \\times 2.5 \\times 10^{-3} = 0.00375 \\ \\text{cm}^{-1}$。\n$D_2 B^2 = 0.5 \\times 2.5 \\times 10^{-3} = 0.00125 \\ \\text{cm}^{-1}$。\n$$\nA_{11} = 0.00375 + 0.01 + 0.12 = 0.13375 \\ \\text{cm}^{-1}\n$$\n$$\nA_{12} = -0.015 \\ \\text{cm}^{-1}\n$$\n$$\nA_{21} = -0.12 \\ \\text{cm}^{-1}\n$$\n$$\nA_{22} = 0.00125 + 0.09 + 0.015 = 0.10625 \\ \\text{cm}^{-1}\n$$\n$\\mathbf{A}$ 的行列式为：\n$$\n\\det(\\mathbf{A}) = (0.13375)(0.10625) - (-0.015)(-0.12) = 0.0142109375 - 0.0018 = 0.0124109375\n$$\n由于 $\\det(\\mathbf{A}) \\neq 0$，矩阵 $\\mathbf{A}$ 是可逆的，且 $\\mathbf{A}^{-1}$ 存在，是一个满秩矩阵（秩为2）。\n\n矩阵乘积的秩最多是各个矩阵秩的最小值。因此，$\\text{rank}(\\mathbf{H}) = \\text{rank}(\\mathbf{F}\\mathbf{A}^{-1}) \\le \\min(\\text{rank}(\\mathbf{F}), \\text{rank}(\\mathbf{A}^{-1})) = \\min(1, 2) = 1$。\n因此，迭代算子 $\\mathbf{H}$ 是一个秩为1的矩阵。\n\n一个 $n \\times n$ 的秩为1的矩阵的一个基本性质是它最多有一个非零特征值。对于我们的 $2 \\times 2$ 矩阵 $\\mathbf{H}$，这意味着它有一个非零特征值 $\\lambda_1$ 和一个零特征值 $\\lambda_2=0$。\n非零特征值在物理上是有效增殖因子 $k_{eff}$，对于一个增殖系统，它必须是非零的。另一个特征值必须恰好为零。\n因此，$\\mathbf{H}$ 的两个特征值是 $\\lambda_1 = k_{eff}$ 和 $\\lambda_2 = 0$。\n\n问题陈述了 $|\\lambda_1| \\ge |\\lambda_2|$，只要反应堆不是恰好处于 $k_{eff}=0$ 的临界状态，这个条件就成立。我们可以确定 $k_{eff} \\neq 0$，因为裂变截面是非零的。\n优势比定义为 $r = |\\lambda_2| / |\\lambda_1|$。代入特征值：\n$$\nr = \\frac{|0|}{|\\lambda_1|} = \\frac{0}{|\\lambda_1|}\n$$\n只要 $\\lambda_1 \\neq 0$，优势比就是 $0$。问题中指定了产裂变材料这一事实保证了 $\\lambda_1 = k_{eff}  0$。\n优势比为零的结果是，裂变源向量的形状在源迭代法的一次迭代中就收敛到基本模态形状。\n\n因此，无需计算完整的矩阵 $\\mathbf{H}$ 或其非零特征值，我们就可以根据算子的秩得出结论，即第二个特征值为零。\n\n为了完全确定，我们可以检查 $\\mathbf{F}$ 的行列式。\n$\\nu \\Sigma_{f,1} = 0.02$, $\\nu \\Sigma_{f,2} = 0.16$, $\\chi_1 = 0.98$, $\\chi_2 = 0.02$。\n$$\n\\mathbf{F} = \\begin{pmatrix} 0.98 \\times 0.02  0.98 \\times 0.16 \\\\ 0.02 \\times 0.02  0.02 \\times 0.16 \\end{pmatrix} = \\begin{pmatrix} 0.0196  0.1568 \\\\ 0.0004  0.0032 \\end{pmatrix}\n$$\n$$\n\\det(\\mathbf{F}) = (0.0196)(0.0032) - (0.1568)(0.0004) = 0.00006272 - 0.00006272 = 0\n$$\n由于 $\\det(\\mathbf{F})=0$，$\\mathbf{F}$ 是奇异的且秩为1。那么 $\\det(\\mathbf{H}) = \\det(\\mathbf{F}\\mathbf{A}^{-1}) = \\det(\\mathbf{F})\\det(\\mathbf{A}^{-1}) = 0 \\times (1/\\det(\\mathbf{A})) = 0$。\n矩阵的行列式是其特征值的乘積：$\\det(\\mathbf{H}) = \\lambda_1 \\lambda_2$。\n由于 $\\det(\\mathbf{H})=0$，至少有一个特征值必须为零。因为系统在物理上是增殖的，它必须有一个非零特征值 $k_{eff}$，所以另一个特征值必须是零。因此，$\\lambda_2=0$。\n优势比为 $r = |0|/|\\lambda_1| = 0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "真实世界的反应堆系统远比均匀模型复杂，其内部包含控制棒、不同富集度的燃料以及反射层等。本练习是一个综合性的数值实验，旨在让您模拟这种空间异质性，并研究其对迭代收敛的实际影响。通过模拟一个部分插入的控制棒，您将观察到这种物理布局如何导致“近简并”的本征模态，从而显著减慢收敛速度。这个练习将理论（迭代算子的谱特性）与实践（数值模拟的性能）紧密结合，揭示了大规模反应堆分析中的一个核心挑战。",
            "id": "4219172",
            "problem": "考虑一个长度为 $L$ 的一维平板中的单能中子扩散 $k$ 本征值问题，其在 $x=0$ 和 $x=L$ 处具有零流（诺伊曼）边界条件。设 $D$ 表示扩散系数，$\\Sigma_a(x)$ 表示吸收截面，$\\nu\\Sigma_f(x)$ 表示由裂变引起的中子产生截面。稳态平衡（扩散本征问题）是一个广义本征值问题，其中子通量 $\\phi(x)$ 满足算子方程 $A \\phi = \\frac{1}{k} F \\phi$，其中 $A$ 是代表扩散和吸收的线性算子，而 $F$ 是代表裂变产生的线性算子。考虑裂变源分布 $q(x) \\equiv \\nu\\Sigma_f(x)\\,\\phi(x)$ 及其通过重复应用输运到裂变源的映射（每一步都进行归一化）而产生的演化序列 $\\{q_n(x)\\}$。$q_n$ 向基模源分布的收敛由输运到裂变源算子的谱性质控制，并可能受到引入近简并模的空间非均匀性的影响。\n\n设计一个数值实验，其中部分插入的控制棒被建模为一个位于中心的吸收势垒，该势垒在平板的左右两半部分创建了两个空间局域化的低泄漏区域。使用一个包含 $N$ 个空间点的均匀网格，间距为 $h = L/(N-1)$，并构建一个带有诺伊曼边界的扩散算子的有限差分方法离散化。离散算子 $A$ 代表 $-D \\frac{d^2}{dx^2} + \\Sigma_a(x)$，算子 $F$ 是一个对角矩阵，其元素为 $\\nu\\Sigma_f(x)$。所有量和输入都是无量纲的；数值没有单位。\n\n实现以下内容：\n\n- 在整个平板上使用 $L = 1$， $N = 120$， $D = 1$，基准吸收 $\\Sigma_{a,0} = 0.2$，以及均匀的裂变产生 $\\nu\\Sigma_f(x) = 0.6$。\n- 将控制棒建模为施加在中心区间 $[x_c - w/2, x_c + w/2]$ 上的额外吸收 $\\Sigma_r$，其中 $x_c = L/2$。总吸收则为 $\\Sigma_a(x) = \\Sigma_{a,0} + \\Sigma_r \\cdot \\chi_{[x_c - w/2,\\,x_c + w/2]}(x)$，其中 $\\chi$ 是指定中心区间的指示函数。\n- 使用二阶中心差分和通过镜像虚点实现的零流边界条件（诺伊曼条件）来构造离散算子 $A$ 和 $F$。\n- 通过求解 $A \\phi = q$ 然后计算 $q^+ = F \\phi$，构造将一个裂变源 $q$ 映射到下一个源 $q^+$ 的线性算子。每次应用后使用 $\\ell^1$ 范数对源进行归一化，使得每次迭代中 $\\|q\\|_1 = 1$。从一个在 $\\ell^1$ 中归一化的均匀正向量 $q_0$ 开始。\n\n对由配对 $(\\Sigma_r, w)$ 定义的三种配置（测试套件），量化并比较源迭代的渐近收敛行为：\n\n- 案例 1：$(\\Sigma_r, w) = (0.0, 0.0)$，表示一个均匀平板（无控制棒势垒）。\n- 案例 2：$(\\Sigma_r, w) = (2.0, 0.2)$，一个在宽度 $w$ 上的中等强度的中心吸收，弱耦合两侧。\n- 案例 3：$(\\Sigma_r, w) = (20.0, 0.3)$，一个在宽度 $w$ 上的强中心吸收，强解耦两侧并产生近简并的局域模。\n\n对于每种情况：\n\n- 通过从离散算子显式地构造 $T$ 并进行本征分析，计算算子 $T = A^{-1} F$ 的主导和次主导本征值。最大本征值与基模相关联。使用第二大本征值的模来表征次主导模。\n- 使用 $T$ 的谱性质预测源迭代的渐近收缩因子。\n- 使用上述映射对 $q_n$ 执行源迭代，并通过在最后 $m$ 次迭代中对连续 $\\ell^2$ 范数误差的比值 $\\|q_{n+1} - q_\\star\\|_2 / \\|q_n - q_\\star\\|_2$ 取平均来估算测量的渐近收缩因子，其中 $q_\\star$ 是从 $T$ 的主导本征向量计算出的基模裂变源分布，而 $m$ 是为稳定估算值而选择的一个小的正整数。\n\n您的程序必须为上述三种情况生成测量的收缩因子和预测的收缩因子。将每个因子表示为保留小数点后六位的小数。您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表，顺序为：$[\\text{测量的}_1,\\text{预测的}_1,\\text{测量的}_2,\\text{预测的}_2,\\text{测量的}_3,\\text{预测的}_3]$。\n\n测试套件详情：\n\n- 这三种情况涵盖了一般情况（$\\Sigma_r=0$）、中等势垒和强力势垒以诱发近简并模。\n- 使用 $N=120$、$L=1$、$D=1$、$\\Sigma_{a,0}=0.2$、$\\nu\\Sigma_f=0.6$、初始源 $q_0$ 为均匀并在 $\\ell^1$ 中归一化、迭代次数 $n_{\\max}=80$，以及用于计算测量收缩因子的平均窗口 $m=10$。所有数字都是无量纲的，必须纯粹作为数学量来处理。\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3]$）。",
            "solution": "用户提供的问题被评估为有效，并将予以解决。\n\n### 第一步：提取已知条件\n- **问题类型**：一维、单能中子扩散 $k$ 本征值问题。\n- **区域**：从 $x=0$ 到 $x=L$、长度为 $L$ 的平板。\n- **边界条件**：在 $x=0$ 和 $x=L$ 处为零流（诺伊曼）边界条件。\n- **控制方程**：$A \\phi = \\frac{1}{k} F \\phi$，其中 $A$ 是扩散和吸收算子， $F$ 是裂变产生算子， $k$ 是本征值。\n- **算子定义**：$A = -D \\frac{d^2}{dx^2} + \\Sigma_a(x)$， $F$ 表示乘以 $\\nu\\Sigma_f(x)$。\n- **源迭代**：序列 $\\{q_n(x)\\}$ 通过求解 $A \\phi_n = q_n$，然后计算 $q_{n+1}' = F \\phi_n$ 生成，其中 $q_n$ 在每一步使用 $\\ell^1$ 范数进行归一化。初始源 $q_0$ 是一个归一化的均匀正向量。\n- **数值离散化**：\n  - 网格：包含 $N$ 个空间点的均匀网格。\n  - 间距：$h = L/(N-1)$。\n  - 方法：对扩散算子使用二阶中心差分。\n  - 边界条件：通过“镜像虚点”实现。\n- **物理和数值参数**：\n  - $L = 1$\n  - $N = 120$\n  - $D = 1$ (扩散系数)\n  - $\\Sigma_{a,0} = 0.2$ (基准吸收截面)\n  - $\\nu\\Sigma_f(x) = 0.6$ (均匀中子产生截面)\n  - $n_{\\max} = 80$ (源迭代次数)\n  - $m = 10$ (用于计算测量收缩因子的平均窗口)\n- **控制棒模型**：\n  - 位置：中心在 $x_c = L/2$。\n  - 吸收：$\\Sigma_a(x) = \\Sigma_{a,0} + \\Sigma_r \\cdot \\chi_{[x_c - w/2,\\,x_c + w/2]}(x)$，其中 $\\chi$ 是指示函数。\n- **测试案例** $(\\Sigma_r, w)$:\n  - 案例1：$(0.0, 0.0)$ (均匀)\n  - 案例2：$(2.0, 0.2)$ (中等势垒)\n  - 案例3：$(20.0, 0.3)$ (强力势垒)\n- **待计算量**：\n  - 预测的渐近收缩因子：根据迭代算子 $T = A^{-1} F$ 的本征值得出。\n  - 测量的渐近收缩因子：根据连续 $\\ell^2$ 范数误差的比值 $\\|q_{n+1} - q_\\star\\|_2 / \\|q_n - q_\\star\\|_2$ 在最后 $m$ 次迭代中取平均值。\n- **输出格式**：包含逗号分隔列表的单行文本：$[\\text{测量的}_1,\\text{预测的}_1,\\text{测量的}_2,\\text{预测的}_2,\\text{测量的}_3,\\text{预测的}_3]$，每个数字保留六位小数。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题是反应堆物理学中的一个标准数值练习，基于公认的中子扩散方程和求解本征值问题的幂迭代法。基模、优势比和收敛性等概念是该领域的核心。该模型在科学上是合理的。\n- **适定性**：该问题对于数值解是适定的。所有必需的参数、边界条件、离散化方法和分析步骤都已明确定义。任务清晰明确。\n- **客观性**：问题以精确、客观和技术性的语言陈述。它不含任何主观或非科学的主张。\n\n### 第三步：结论与行动\n该问题有效。将提供完整的解决方案。\n\n### 基于原理的设计与求解\n该问题要求分析用于求解中子扩散 $k$ 本征值问题的源迭代法的收敛性。该方法是幂迭代算法的一种形式，应用于寻找迭代算子的最大本征值和相应的本征向量。\n\n连续本征值问题由下式给出：\n$$\n\\left(-D \\frac{d^2}{dx^2} + \\Sigma_a(x)\\right) \\phi(x) = \\frac{1}{k} \\nu\\Sigma_f(x) \\phi(x)\n$$\n这可以写成 $A\\phi = \\frac{1}{k} F\\phi$。重新排列这个方程得到 $A^{-1}F\\phi = k\\phi$。这表明增殖因子 $k$ 是算子 $T = A^{-1}F$ 的一个本征值，而中子通量 $\\phi$ 是相应的本征函数。反应堆的基模对应于最大的正本征值 $k_{eff} = \\lambda_1$ 及其相关的非负本征函数 $\\phi_1(x)$。\n\n源迭代法生成一系列裂变源分布 $q_n(x)$。从一个初始猜测 $q_0(x)$ 开始，迭代过程如下：\n1. 求解中子通量：$A\\phi_n = q_n \\implies \\phi_n = A^{-1}q_n$。\n2. 计算下一个未归一化的裂变源：$q_{n+1}' = F\\phi_n = F A^{-1} q_n$。\n3. 对源进行归一化：$q_{n+1} = \\frac{q_{n+1}'}{\\|q_{n+1}'\\|_1}$。\n\n这等效于对算子 $T' = FA^{-1}$ 应用幂方法。$T'$ 的本征值与 $T = A^{-1}F$ 的本征值相同。幂迭代法的渐近收敛率由优势比 $\\rho = |\\lambda_2| / |\\lambda_1|$ 决定，其中 $\\lambda_1$ 和 $\\lambda_2$ 是迭代算子模最大和第二大的本征值。这个 $\\rho$ 就是**预测的渐近收缩因子**。\n\n为了在数值上实现这一点，我们首先对算子进行离散化。在区域 $[0, L]$ 上建立一个包含 $N=120$ 个点的均匀网格，间距为 $h=L/(N-1)$。算子 $A = -D \\frac{d^2}{dx^2} + \\Sigma_a(x)$ 使用二阶中心差分对拉普拉斯算子进行离散化，并对吸收项进行逐点求值。如指定的那样，零流诺伊曼边界条件 $\\phi'(0)=0$ 和 $\\phi'(L)=0$ 使用镜像虚点处理。对于节点 $i=0$，虚点 $\\phi_{-1}$ 被设置为 $\\phi_1$。离散化后的拉普拉斯算子变为：\n$$\n-D \\frac{d^2\\phi}{dx^2}\\bigg|_{x_0} \\approx -D\\frac{\\phi_1 - 2\\phi_0 + \\phi_{-1}}{h^2} = -D\\frac{2\\phi_1 - 2\\phi_0}{h^2}\n$$\n一个类似的表达式适用于节点 $i=N-1$。对于内部节点 $i \\in [1, N-2]$，使用标准的中心差分：\n$$\n-D \\frac{d^2\\phi}{dx^2}\\bigg|_{x_i} \\approx -D\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2}\n$$\n这些表达式与对角吸收项 $\\Sigma_{a,i}\\phi_i$ 相结合，定义了离散矩阵算子 $\\mathbf{A}$ 的元素。裂变算子 $\\mathbf{F}$ 成为一个对角矩阵，其元素为 $\\nu\\Sigma_{f,i}$。\n\n有了离散算子 $\\mathbf{A}$ 和 $\\mathbf{F}$，迭代矩阵 $\\mathbf{T} = \\mathbf{A}^{-1}\\mathbf{F}$ 被显式地构造出来。其本征值通过数值计算得出。预测的收缩因子为 $\\rho_{pred} = |\\lambda_2|/|\\lambda_1|$。$\\mathbf{T}$ 对应于 $\\lambda_1$ 的本征向量是基模裂变源分布 $q_\\star$。为与迭代保持一致，此向量使用 $\\ell^1$ 范数进行归一化。\n\n然后对源迭代进行 $n_{max}$ 步的模拟。记录每一步的误差 $\\epsilon_n = \\|q_n - q_\\star\\|_2$。**测量的渐近收缩因子**通过在模拟的最后 $m$ 次迭代中对连续误差的比值 $\\epsilon_n/\\epsilon_{n-1}$ 取平均来估算。这个数值实验通过比较测量因子和预测因子来验证理论预测。\n\n三个测试案例探讨了空间非均匀性如何影响收敛。均匀情况（案例1）预计会有较小的优势比和快速的收敛。引入中心吸收棒（案例2和3）会产生两个弱耦合区域。这导致前两个本征值变得近简并，从而导致优势比接近1和显著减慢的收敛速度，这种现象被称为谱毒化。\n\n该实验按以下步骤实现：\n1. 对每个案例 $(\\Sigma_r, w)$，定义材料属性向量 $\\Sigma_a$。\n2. 构造矩阵 $\\mathbf{A}$ 和 $\\mathbf{F}$。\n3. 计算 $\\mathbf{T} = \\mathbf{A}^{-1}\\mathbf{F}$。\n4. 寻找 $\\mathbf{T}$ 的本征值和本征向量。按模大小对它们进行排序，以找到 $\\lambda_1$、$\\lambda_2$ 和基模本征向量 $q_\\star$。对 $q_\\star$ 进行归一化。\n5. 计算预测因子 $\\rho_{pred} = |\\lambda_2|/|\\lambda_1|$。\n6. 执行源迭代 $n_{max}$ 步，计算并存储每一步相对于 $q_\\star$ 的 $\\ell^2$ 误差。\n7. 通过在最后 $m$ 步中对误差比率取平均，计算测量因子 $\\rho_{meas}$。\n8. 将所有三个案例的结果整理成指定的输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not used as per the problem, numpy is sufficient.\n\ndef _calculate_factors_for_case(Sigma_r, w, L, N, D, Sigma_a0, nuSigma_f, n_max, m):\n    \"\"\"\n    Performs the full analysis for a single problem configuration.\n    \n    This function constructs the discrete operators, computes the predicted\n    convergence factor from the eigenspectrum of the iteration matrix,\n    and runs a source iteration simulation to find the measured convergence factor.\n    \"\"\"\n    h = L / (N - 1)\n    x = np.linspace(0, L, N)\n\n    # 1. Construct material properties\n    Sigma_a = np.full(N, Sigma_a0)\n    if w > 0:\n        x_c = L / 2\n        rod_start_x = x_c - w / 2\n        rod_end_x = x_c + w / 2\n        # Apply rod absorption to all grid points within the interval\n        rod_indices = np.where((x >= rod_start_x)  (x = rod_end_x))\n        Sigma_a[rod_indices] += Sigma_r\n\n    # 2. Construct discrete operators A and F\n    A = np.zeros((N, N))\n    F = nuSigma_f * np.eye(N)\n    \n    # Fill matrix A based on finite difference scheme with mirrored ghost points\n    # Interior points\n    for i in range(1, N - 1):\n        A[i, i-1] = -D / h**2\n        A[i, i]   = 2*D / h**2 + Sigma_a[i]\n        A[i, i+1] = -D / h**2\n        \n    # Boundary points (Neumann BCs)\n    # At x = 0 (i=0)\n    A[0, 0] = 2*D / h**2 + Sigma_a[0]\n    A[0, 1] = -2*D / h**2\n    # At x = L (i=N-1)\n    A[N-1, N-1] = 2*D / h**2 + Sigma_a[N-1]\n    A[N-1, N-2] = -2*D / h**2\n\n    # 3. Compute predicted contraction factor\n    # Form the iteration matrix T = A_inv * F\n    T = np.linalg.inv(A) @ F\n    \n    # Get eigenvalues and eigenvectors\n    eigvals, eigvecs = np.linalg.eig(T)\n    \n    # Sort eigenvalues by magnitude in descending order\n    abs_eigvals = np.abs(eigvals)\n    sorted_indices = np.argsort(abs_eigvals)[::-1]\n    \n    sorted_eigvals = eigvals[sorted_indices]\n    sorted_eigvecs = eigvecs[:, sorted_indices]\n    \n    lambda1 = np.abs(sorted_eigvals[0])\n    lambda2 = np.abs(sorted_eigvals[1])\n    \n    predicted_factor = lambda2 / lambda1\n\n    # 4. Perform source iteration to get measured factor\n    # Get the fundamental mode source distribution q_star\n    q_star = np.real(sorted_eigvecs[:, 0])\n    # Normalize q_star with L1 norm, ensuring it's positive\n    if np.sum(q_star)  0:\n        q_star = -q_star\n    q_star /= np.sum(q_star)\n\n    # Initialize source iteration\n    q = np.ones(N) / N  # Uniform source normalized in L1\n    errors = []\n    \n    for _ in range(n_max):\n        # Solve A * phi = q\n        phi = np.linalg.solve(A, q)\n        # Compute next source q_next = F * phi\n        q_next = F @ phi\n        # Normalize with L1 norm\n        q_next /= np.sum(q_next)\n        q = q_next\n        \n        # Calculate and store the L2 error norm\n        err = np.linalg.norm(q - q_star, ord=2)\n        errors.append(err)\n        \n    # 5. Calculate measured contraction factor from error ratios\n    # Ratios are err_n / err_{n-1}\n    ratios = [errors[i] / errors[i-1] for i in range(n_max - m, n_max)]\n    measured_factor = np.mean(ratios)\n    \n    return measured_factor, predicted_factor\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment for all test cases.\n    \"\"\"\n    # Define the global parameters from the problem statement.\n    L = 1.0\n    N = 120\n    D = 1.0\n    Sigma_a0 = 0.2\n    nuSigma_f = 0.6\n    n_max = 80\n    m = 10\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.0),  # Case 1: Homogeneous\n        (2.0, 0.2),  # Case 2: Moderate barrier\n        (20.0, 0.3)  # Case 3: Strong barrier\n    ]\n\n    results = []\n    for case in test_cases:\n        Sigma_r, w = case\n        measured, predicted = _calculate_factors_for_case(\n            Sigma_r, w, L, N, D, Sigma_a0, nuSigma_f, n_max, m\n        )\n        results.append(measured)\n        results.append(predicted)\n\n    # Final print statement in the exact required format.\n    # Format each result to six decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}