{
    "hands_on_practices": [
        {
            "introduction": "为了开始我们的实践探索，我们首先将解构中子源迭代算子本身。练习  要求您为一个简单的双能群系统推导该算子并分析其谱特性。通过检验裂变算子的数学结构，您将揭示在理想化情景中收敛速度可能极快的一个关键原因，从而为理解更复杂的情况提供一个基本参考。",
            "id": "4219116",
            "problem": "考虑一个均匀的双能群反应堆区域，其模型由包含中子增殖的稳态多群扩散平衡方程描述。假设空间通量形状是可分的，并固定为由几何曲率 $B^{2}$ 表征的基本空间模式，因此，在每个能群 $g \\in \\{1,2\\}$ 中的泄漏项表示为 $D_{g} B^{2}$。能量耦合包括从群1到群2的降散射和从群2到群1的升散射。裂变中子以固定的、由裂变谱分量 $(\\chi_{1}, \\chi_{2})$ 给出的群份额产生。材料参数如下：\n\n- 扩散系数：$D_{1} = 1.5 \\ \\text{cm}$，$D_{2} = 0.5 \\ \\text{cm}$。\n- 几何曲率：$B^{2} = 2.5 \\times 10^{-3} \\ \\text{cm}^{-2}$。\n- 吸收截面：$\\Sigma_{a,1} = 0.01 \\ \\text{cm}^{-1}$，$\\Sigma_{a,2} = 0.09 \\ \\text{cm}^{-1}$。\n- 散射截面（移出群和群间）：$\\Sigma_{s,1 \\to 2} = 0.12 \\ \\text{cm}^{-1}$，$\\Sigma_{s,2 \\to 1} = 0.015 \\ \\text{cm}^{-1}$。\n- 裂变产生的中子：$\\nu \\Sigma_{f,1} = 0.02 \\ \\text{cm}^{-1}$，$\\nu \\Sigma_{f,2} = 0.16 \\ \\text{cm}^{-1}$。\n- 裂变谱份额：$\\chi_{1} = 0.98$，$\\chi_{2} = 0.02$。\n\n从基于粒子平衡和移出截面定义 $\\Sigma_{r,g} = \\Sigma_{a,g} + \\sum_{h \\neq g} \\Sigma_{s,g \\to h}$ 的双能群扩散 $k$-特征值公式出发。利用这些基本陈述和固定基本空间形状的假设（通过 $B^{2}$），推导在 $k$-特征值问题的外源迭代中，将一个裂变源向量映射到下一个裂变源向量的块算子。然后，对于给定的数值参数，计算该块算子的特征值及其相应的主导比，定义为 $r = |\\lambda_{2}| / |\\lambda_{1}|$，其中 $|\\lambda_{1}| \\geq |\\lambda_{2}|$ 是其两个特征值的模。将最终的主导比表示为一个无量纲数。最终答案不需要四舍五入。",
            "solution": "该问题要求推导双能群稳态 $k$-特征值问题的源迭代算子，并随后计算其特征值的主导比。\n\n首先，我们根据所提供的物理描述来构建问题。对于均匀介质，假设其基本空间模式形状固定并由几何曲率 $B^2$ 表征，其稳态中子平衡可以写成一组代数方程。扩散方程中的项 $-\\nabla \\cdot D_g \\nabla \\phi_g$ 变为 $D_g B^2 \\phi_g$。每个能群 $g$ 的平衡方程为：\n$$\n\\text{泄漏} + \\text{吸收} + \\text{移出散射} = \\text{移入散射} + \\text{裂变源}\n$$\n对于双能群系统（$g \\in \\{1,2\\}$），这得出：\n群1：\n$$\nD_1 B^2 \\phi_1 + \\Sigma_{a,1} \\phi_1 + \\Sigma_{s,1 \\to 2} \\phi_1 = \\Sigma_{s,2 \\to 1} \\phi_2 + \\frac{1}{k} \\chi_1 (\\nu\\Sigma_{f,1} \\phi_1 + \\nu\\Sigma_{f,2} \\phi_2)\n$$\n群2：\n$$\nD_2 B^2 \\phi_2 + \\Sigma_{a,2} \\phi_2 + \\Sigma_{s,2 \\to 1} \\phi_2 = \\Sigma_{s,1 \\to 2} \\phi_1 + \\frac{1}{k} \\chi_2 (\\nu\\Sigma_{f,1} \\phi_1 + \\nu\\Sigma_{f,2} \\phi_2)\n$$\n其中 $\\phi_g$ 是群 $g$ 中的标量通量，$k$ 是有效增殖因子。\n\n这些方程可以重新整理并写成矩阵形式。我们将除了裂变源之外的所有项都移到左边：\n$$\n(D_1 B^2 + \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}) \\phi_1 - \\Sigma_{s,2 \\to 1} \\phi_2 = \\frac{1}{k} ( \\chi_1 \\nu\\Sigma_{f,1} \\phi_1 + \\chi_1 \\nu\\Sigma_{f,2} \\phi_2 )\n$$\n$$\n(D_2 B^2 + \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1}) \\phi_2 - \\Sigma_{s,1 \\to 2} \\phi_1 = \\frac{1}{k} ( \\chi_2 \\nu\\Sigma_{f,1} \\phi_1 + \\chi_2 \\nu\\Sigma_{f,2} \\phi_2 )\n$$\n这可以表示为矩阵特征值方程 $\\mathbf{A}\\vec{\\phi} = \\frac{1}{k} \\mathbf{F}\\vec{\\phi}$，其中 $\\vec{\\phi} = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix}$。\n\n矩阵 $\\mathbf{A}$ 代表中子净移出（泄漏、吸收和从一个群中净散射出去）：\n$$\n\\mathbf{A} = \\begin{pmatrix} D_1 B^2 + \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2} & -\\Sigma_{s,2 \\to 1} \\\\ -\\Sigma_{s,1 \\to 2} & D_2 B^2 + \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} \\end{pmatrix}\n$$\n问题将移出截面定义为 $\\Sigma_{r,g} = \\Sigma_{a,g} + \\sum_{h \\neq g} \\Sigma_{s,g \\to h}$。所以，$\\Sigma_{r,1} = \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}$ 且 $\\Sigma_{r,2} = \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1}$。$\\mathbf{A}$ 的对角元素是 $A_{gg} = D_g B^2 + \\Sigma_{r,g}$。\n\n矩阵 $\\mathbf{F}$ 代表裂变中子的产生：\n$$\n\\mathbf{F} = \\begin{pmatrix} \\chi_1 \\nu\\Sigma_{f,1} & \\chi_1 \\nu\\Sigma_{f,2} \\\\ \\chi_2 \\nu\\Sigma_{f,1} & \\chi_2 \\nu\\Sigma_{f,2} \\end{pmatrix} = \\begin{pmatrix} \\chi_1 \\\\ \\chi_2 \\end{pmatrix} \\begin{pmatrix} \\nu\\Sigma_{f,1} & \\nu\\Sigma_{f,2} \\end{pmatrix} = \\vec{\\chi}(\\boldsymbol{\\nu\\Sigma_f})^T\n$$\n源迭代法（或幂迭代法）用于求解该特征值问题。在此背景下，“裂变源向量”是表示各群裂变中子产生的向量，即 $\\vec{f} = \\mathbf{F}\\vec{\\phi}$。迭代过程如下：给定上一步迭代的源向量 $\\vec{f}_i$，首先求解通量：\n$$\n\\mathbf{A}\\vec{\\phi}_{i+1} = \\frac{1}{k_i}\\vec{f}_i \\implies \\vec{\\phi}_{i+1} = \\frac{1}{k_i} \\mathbf{A}^{-1}\\vec{f}_i\n$$\n然后，利用该通量计算新的源向量：\n$$\n\\vec{f}_{i+1} = \\mathbf{F}\\vec{\\phi}_{i+1} = \\mathbf{F} \\left( \\frac{1}{k_i} \\mathbf{A}^{-1}\\vec{f}_i \\right) = \\frac{1}{k_i} (\\mathbf{F}\\mathbf{A}^{-1})\\vec{f}_i\n$$\n“将一个裂变源向量映射到下一个的块算子”是矩阵 $\\mathbf{H} = \\mathbf{F}\\mathbf{A}^{-1}$。幂迭代法收敛到 $\\mathbf{H}$ 对应于最大模特征值的特征向量。主导特征值 $\\lambda_1$ 是有效增殖因子 $k_{eff}$。\n\n问题要求主导比 $r = |\\lambda_2|/|\\lambda_1|$，其中 $|\\lambda_1| \\ge |\\lambda_2|$ 是 $\\mathbf{H}$ 的特征值的模。\n\n必须对裂变矩阵 $\\mathbf{F}$ 的结构进行一个关键的观察。如上所示，$\\mathbf{F}$ 是裂变谱向量 $\\vec{\\chi}$ 和裂变产生向量 $(\\boldsymbol{\\nu\\Sigma_f})^T$ 的外积。两个向量的外积得到一个秩为1的矩阵。\n算子 $\\mathbf{H}$ 是 $\\mathbf{F}$（一个秩为1的矩阵）和 $\\mathbf{A}^{-1}$ 的乘积。我们必须首先验证 $\\mathbf{A}$ 是可逆的。\n让我们使用给定的参数计算 $\\mathbf{A}$ 的元素：\n$D_1 = 1.5 \\ \\text{cm}$，$D_2 = 0.5 \\ \\text{cm}$，$B^2 = 2.5 \\times 10^{-3} \\ \\text{cm}^{-2}$。\n$\\Sigma_{a,1} = 0.01 \\ \\text{cm}^{-1}$，$\\Sigma_{a,2} = 0.09 \\ \\text{cm}^{-1}$。\n$\\Sigma_{s,1 \\to 2} = 0.12 \\ \\text{cm}^{-1}$，$\\Sigma_{s,2 \\to 1} = 0.015 \\ \\text{cm}^{-1}$。\n$D_1 B^2 = 1.5 \\times 2.5 \\times 10^{-3} = 0.00375 \\ \\text{cm}^{-1}$。\n$D_2 B^2 = 0.5 \\times 2.5 \\times 10^{-3} = 0.00125 \\ \\text{cm}^{-1}$。\n$$\nA_{11} = 0.00375 + 0.01 + 0.12 = 0.13375 \\ \\text{cm}^{-1}\n$$\n$$\nA_{12} = -0.015 \\ \\text{cm}^{-1}\n$$\n$$\nA_{21} = -0.12 \\ \\text{cm}^{-1}\n$$\n$$\nA_{22} = 0.00125 + 0.09 + 0.015 = 0.10625 \\ \\text{cm}^{-1}\n$$\n$\\mathbf{A}$ 的行列式为：\n$$\n\\det(\\mathbf{A}) = (0.13375)(0.10625) - (-0.015)(-0.12) = 0.0142109375 - 0.0018 = 0.0124109375\n$$\n由于 $\\det(\\mathbf{A}) \\neq 0$，矩阵 $\\mathbf{A}$ 是可逆的，并且 $\\mathbf{A}^{-1}$ 存在且是一个满秩矩阵（秩为2）。\n\n矩阵乘积的秩最多为各个矩阵秩的最小值。因此，$\\text{rank}(\\mathbf{H}) = \\text{rank}(\\mathbf{F}\\mathbf{A}^{-1}) \\le \\min(\\text{rank}(\\mathbf{F}), \\text{rank}(\\mathbf{A}^{-1})) = \\min(1, 2) = 1$。\n因此，迭代算子 $\\mathbf{H}$ 是一个秩为1的矩阵。\n\n一个 $n \\times n$ 秩为1的矩阵的一个基本性质是它最多有一个非零特征值。对于我们的 $2 \\times 2$ 矩阵 $\\mathbf{H}$，这意味着它有一个非零特征值 $\\lambda_1$ 和一个零特征值 $\\lambda_2=0$。\n非零特征值在物理上是有效增殖因子 $k_{eff}$，对于一个增殖系统，它必须是非零的。另一个特征值必须恰好为零。\n因此，$\\mathbf{H}$ 的两个特征值是 $\\lambda_1 = k_{eff}$ 和 $\\lambda_2 = 0$。\n\n问题陈述 $|\\lambda_1| \\ge |\\lambda_2|$，只要反应堆不是恰好临界于 $k_{eff}=0$，这个条件就成立。我们可以确定 $k_{eff} \\neq 0$，因为裂变截面是非零的。\n主导比定义为 $r = |\\lambda_2| / |\\lambda_1|$。\n代入特征值的值：\n$$\nr = \\frac{|0|}{|\\lambda_1|} = \\frac{0}{|\\lambda_1|}\n$$\n只要 $\\lambda_1 \\neq 0$，主导比就是 $0$。问题指明了产裂变材料，这一事实确保了 $\\lambda_1 = k_{eff} > 0$。主导比为零的结果是，裂变源向量的形状在源迭代法的一次迭代中就收敛到基模形状。\n\n因此，无需计算完整的矩阵 $\\mathbf{H}$ 或其非零特征值，我们就可以根据算子的秩得出结论，第二个特征值为零。\n\n为了完全确定，我们可以检查 $\\mathbf{F}$ 的行列式。\n$\\nu \\Sigma_{f,1} = 0.02$，$\\nu \\Sigma_{f,2} = 0.16$，$\\chi_1 = 0.98$，$\\chi_2 = 0.02$。\n$$\n\\mathbf{F} = \\begin{pmatrix} 0.98 \\times 0.02 & 0.98 \\times 0.16 \\\\ 0.02 \\times 0.02 & 0.02 \\times 0.16 \\end{pmatrix} = \\begin{pmatrix} 0.0196 & 0.1568 \\\\ 0.0004 & 0.0032 \\end{pmatrix}\n$$\n$$\n\\det(\\mathbf{F}) = (0.0196)(0.0032) - (0.1568)(0.0004) = 0.00006272 - 0.00006272 = 0\n$$\n由于 $\\det(\\mathbf{F})=0$，$\\mathbf{F}$ 是奇异的且秩为1。那么 $\\det(\\mathbf{H}) = \\det(\\mathbf{F}\\mathbf{A}^{-1}) = \\det(\\mathbf{F})\\det(\\mathbf{A}^{-1}) = 0 \\times (1/\\det(\\mathbf{A})) = 0$。\n一个矩阵的行列式是其特征值的乘积：$\\det(\\mathbf{H}) = \\lambda_1 \\lambda_2$。\n由于 $\\det(\\mathbf{H})=0$，至少有一个特征值必须为零。由于该系统是物理上增殖的，它必须有一个非零特征值 $k_{eff}$，因此另一个特征值必须是零。所以，$\\lambda_2=0$。\n主导比为 $r = |0|/|\\lambda_1| = 0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在迭代算子理论结构的基础上，我们现在转向幂迭代算法的实际执行。练习  通过对比一种简单但有缺陷的方法与稳健的瑞利商（Rayleigh quotient）归一化方法，展示了选择正确归一化方案的至关重要性。通过这个具体的计算示例，您将体会到数值方法的选择如何直接影响迭代过程的稳定性和收敛行为。",
            "id": "4219128",
            "problem": "考虑一个处于稳态的热核反应堆的均匀双区粗网格模型。设未知量为维度为$2$的裂变源分布向量$\\boldsymbol{q}$，并令产生和损失由线性算子表示。其基本近似是稳态平衡的广义特征问题，\n$$\n\\boldsymbol{F}\\,\\boldsymbol{q} \\;=\\; k\\,\\boldsymbol{L}\\,\\boldsymbol{q},\n$$\n其中$\\boldsymbol{F}$是非负产生算子，$\\boldsymbol{L}$是正损失算子，$k$是有效增殖因子。在离散设置中，取$\\boldsymbol{L} = \\boldsymbol{I}$（单位矩阵）且\n$$\n\\boldsymbol{F} \\;=\\; \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix}.\n$$\n因此，$k$-特征问题简化为$\\boldsymbol{F}\\,\\boldsymbol{q} = k\\,\\boldsymbol{q}$，一个朴素的幂迭代法使用$\\boldsymbol{q}_{n+1} = \\boldsymbol{F}\\,\\boldsymbol{q}_n$，并在每一步进行归一化。\n\n定义两种归一化策略：\n- 朴素分量归一化：在形成$\\boldsymbol{q}_{n+1} = \\boldsymbol{F}\\,\\boldsymbol{q}_n$后，重新缩放$\\boldsymbol{q}_{n+1}$使其第一个分量等于$1$，即$(\\boldsymbol{q}_{n+1})_1 = 1$。在每一步通过分量比$k_n = \\frac{(\\boldsymbol{q}_{n+1})_1}{(\\boldsymbol{q}_n)_1}$来估计$k_n$。以$\\boldsymbol{q}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$进行初始化。\n- 针对广义问题$\\boldsymbol{F}\\,\\boldsymbol{q} = k\\,\\boldsymbol{L}\\,\\boldsymbol{q}$的瑞利商归一化：定义\n$$\nk(\\boldsymbol{q}) \\;=\\; \\frac{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{F}\\,\\boldsymbol{q}}{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{L}\\,\\boldsymbol{q}},\n$$\n并在每一步设置$k_{n+1} = k(\\boldsymbol{q}_n)$，然后更新$\\boldsymbol{q}_{n+1} = \\frac{1}{k_{n+1}}\\boldsymbol{L}^{-1}\\boldsymbol{F}\\,\\boldsymbol{q}_n$，之后关于$\\boldsymbol{L}$-内积进行归一化，$\\|\\boldsymbol{q}\\|_{\\boldsymbol{L}}^2 = \\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{L}\\,\\boldsymbol{q}$，使得$\\|\\boldsymbol{q}_{n+1}\\|_{\\boldsymbol{L}} = 1$。在这个特定情况下，$\\boldsymbol{L} = \\boldsymbol{I}$，所以$\\|\\boldsymbol{q}\\|_{\\boldsymbol{L}} = \\|\\boldsymbol{q}\\|_{2}$是欧几里得范数。\n\n任务：\n1. 通过显式计算前几次迭代，表明朴素分量归一化在$k_n$和第二个分量$(\\boldsymbol{q}_n)_2$中引起振荡。给出在朴素归一化下$(\\boldsymbol{q}_n)_2$的闭式标量递推关系，并确定其不动点是吸引的还是排斥的。\n2. 使用瑞利商归一化，从第一性原理出发解释为什么$k_n$和$\\boldsymbol{q}_n$收敛到基模，并计算此离散反应堆模型的精确稳定$k$值。将你对$k$的最终答案表示为单个无单位的闭式解析表达式。\n\n你的最终答案必须是单个解析表达式。无需四舍五入。",
            "solution": "该问题要求分析两种用于寻找简化核反应堆模型基特征模的幂迭代方案。控制方程是特征值问题$\\boldsymbol{F}\\,\\boldsymbol{q} = k\\,\\boldsymbol{q}$，其中$\\boldsymbol{F} = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix}$。\n\n首先，我们根据第一个任务的要求分析朴素分量归一化方法。\n设向量序列由$\\boldsymbol{q}_n$表示。起始向量为$\\boldsymbol{q}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。迭代过程是通过应用矩阵$\\boldsymbol{F}$，然后重新缩放结果向量，使其第一个分量为$1$。在第$n$步，特征值$k$的估计值由矩阵乘法前后第一个分量的比值给出。\n\n让我们计算前几次迭代：\n\n步骤 $n=0$：\n我们从$\\boldsymbol{q}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$开始。\n未归一化的下一个向量是 $\\boldsymbol{q}_{1}' = \\boldsymbol{F}\\,\\boldsymbol{q}_0 = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n$k$的估计值为 $k_0 = \\frac{(\\boldsymbol{q}_{1}')_1}{(\\boldsymbol{q}_0)_1} = \\frac{1}{1} = 1$。\n通过确保其第一个分量为$1$来获得新的归一化向量$\\boldsymbol{q}_1$。由于$(\\boldsymbol{q}_{1}')_1$已经是$1$，我们有$\\boldsymbol{q}_1 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n\n步骤 $n=1$：\n我们从$\\boldsymbol{q}_1 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$开始。\n未归一化的下一个向量是 $\\boldsymbol{q}_{2}' = \\boldsymbol{F}\\,\\boldsymbol{q}_1 = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1 + 2(2) \\\\ 2(1) + 1(2) \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}$。\n$k$的估计值为 $k_1 = \\frac{(\\boldsymbol{q}_{2}')_1}{(\\boldsymbol{q}_1)_1} = \\frac{5}{1} = 5$。\n新的归一化向量是 $\\boldsymbol{q}_2 = \\frac{1}{5}\\boldsymbol{q}_{2}' = \\frac{1}{5}\\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{4}{5} \\end{pmatrix}$。\n\n步骤 $n=2$：\n我们从$\\boldsymbol{q}_2 = \\begin{pmatrix} 1 \\\\ \\frac{4}{5} \\end{pmatrix}$开始。\n未归一化的下一个向量是 $\\boldsymbol{q}_{3}' = \\boldsymbol{F}\\,\\boldsymbol{q}_2 = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} 1 + 2(\\frac{4}{5}) \\\\ 2(1) + \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{13}{5} \\\\ \\frac{14}{5} \\end{pmatrix}$。\n$k$的估计值为 $k_2 = \\frac{(\\boldsymbol{q}_{3}')_1}{(\\boldsymbol{q}_2)_1} = \\frac{13/5}{1} = \\frac{13}{5} = 2.6$。\n新的归一化向量是 $\\boldsymbol{q}_3 = \\frac{1}{13/5}\\boldsymbol{q}_{3}' = \\frac{5}{13}\\begin{pmatrix} \\frac{13}{5} \\\\ \\frac{14}{5} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{14}{13} \\end{pmatrix}$。\n\n步骤 $n=3$：\n我们从$\\boldsymbol{q}_3 = \\begin{pmatrix} 1 \\\\ \\frac{14}{13} \\end{pmatrix}$开始。\n未归一化的下一个向量是 $\\boldsymbol{q}_{4}' = \\boldsymbol{F}\\,\\boldsymbol{q}_3 = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\frac{14}{13} \\end{pmatrix} = \\begin{pmatrix} 1 + 2(\\frac{14}{13}) \\\\ 2 + \\frac{14}{13} \\end{pmatrix} = \\begin{pmatrix} \\frac{41}{13} \\\\ \\frac{40}{13} \\end{pmatrix}$。\n$k$的估计值为 $k_3 = \\frac{(\\boldsymbol{q}_{4}')_1}{(\\boldsymbol{q}_3)_1} = \\frac{41/13}{1} = \\frac{41}{13} \\approx 3.1538$。\n\n特征值估计序列是$k_n: 1, 5, 2.6, 41/13 \\approx 3.15, \\dots$。这个序列不是单调收敛的；它在振荡。\n向量$\\boldsymbol{q}_n$的第二个分量的序列是$(\\boldsymbol{q}_n)_2: 0, 2, 4/5=0.8, 14/13 \\approx 1.077, \\dots$。这个序列也表现出振荡行为。\n\n为了找到$(\\boldsymbol{q}_n)_2$的闭式标量递推关系，我们记$y_n = (\\boldsymbol{q}_n)_2$。根据归一化规则，对于$n \\ge 1$，向量的形式为$\\boldsymbol{q}_n = \\begin{pmatrix} 1 \\\\ y_n \\end{pmatrix}$。迭代为$\\boldsymbol{q}_{n+1}' = \\boldsymbol{F}\\,\\boldsymbol{q}_n$。\n$$ \\boldsymbol{q}_{n+1}' = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ y_n \\end{pmatrix} = \\begin{pmatrix} 1 + 2y_n \\\\ 2 + y_n \\end{pmatrix} $$\n为了得到$\\boldsymbol{q}_{n+1}$，我们通过除以第一个分量来进行归一化：\n$$ \\boldsymbol{q}_{n+1} = \\frac{1}{1+2y_n} \\begin{pmatrix} 1+2y_n \\\\ 2+y_n \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{2+y_n}{1+2y_n} \\end{pmatrix} $$\n因此，$y_{n+1} = (\\boldsymbol{q}_{n+1})_2$的递推关系是：\n$$ y_{n+1} = f(y_n) = \\frac{2+y_n}{1+2y_n} $$\n这个递推关系的一个不动点$y^*$满足$y^* = f(y^*)$：\n$$ y^* = \\frac{2+y^*}{1+2y^*} \\implies y^*(1+2y^*) = 2+y^* \\implies y^* + 2(y^*)^2 = 2+y^* \\implies 2(y^*)^2 = 2 $$\n这得出$(y^*)^2=1$，所以不动点是$y^*=1$和$y^*=-1$。这些对应于特征向量$\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$和$\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$在缩放使其第一个分量为$1$之后的结果。\n\n为了确定一个不动点是吸引的还是排斥的，我们分析递推函数$f(y) = \\frac{2+y}{1+2y}$在不动点处的导数。\n$$ f'(y) = \\frac{d}{dy}\\left(\\frac{2+y}{1+2y}\\right) = \\frac{(1)(1+2y) - (2+y)(2)}{(1+2y)^2} = \\frac{1+2y-4-2y}{(1+2y)^2} = \\frac{-3}{(1+2y)^2} $$\n在$y^*=1$处：\n$$ f'(1) = \\frac{-3}{(1+2(1))^2} = \\frac{-3}{3^2} = -\\frac{1}{3} $$\n由于$|f'(1)| = \\frac{1}{3} < 1$，不动点$y^*=1$是吸引的。导数的负号表示迭代值在收敛时围绕不动点振荡，这与我们最初的计算是一致的。\n在$y^*=-1$处：\n$$ f'(-1) = \\frac{-3}{(1+2(-1))^2} = \\frac{-3}{(-1)^2} = -3 $$\n由于$|f'(-1)| = 3 > 1$，不动点$y^*=-1$是排斥的。\n\n现在进行第二个任务，我们分析瑞利商归一化。幂方法，其一般形式为$\\boldsymbol{q}_{n+1} = C_n \\boldsymbol{F} \\boldsymbol{q}_n$，其中$C_n$是归一化常数，收敛于与最大模特征值相关联的特征向量。设$\\boldsymbol{F}$的特征值为$k_1, k_2, \\dots$，按模排序为$|k_1| > |k_2| \\ge \\dots$，对应的特征向量为$\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\dots$。任何初始向量$\\boldsymbol{q}_0$都可以表示为这些特征向量的线性组合：$\\boldsymbol{q}_0 = \\sum_i a_i \\boldsymbol{v}_i$。重复应用$\\boldsymbol{F}$得到$\\boldsymbol{F}^n \\boldsymbol{q}_0 = \\sum_i a_i k_i^n \\boldsymbol{v}_i$。提出主导特征值项$k_1^n$：\n$$ \\boldsymbol{F}^n \\boldsymbol{q}_0 = k_1^n \\left( a_1 \\boldsymbol{v}_1 + \\sum_{i>1} a_i \\left(\\frac{k_i}{k_1}\\right)^n \\boldsymbol{v}_i \\right) $$\n由于对于$i>1$有$|k_i/k_1| < 1$，当$n\\to\\infty$时，求和中的项会消失。只要$a_1 \\neq 0$，向量$\\boldsymbol{F}^n \\boldsymbol{q}_0$就变得越来越平行于主导特征向量$\\boldsymbol{v}_1$。因此，归一化向量序列$\\boldsymbol{q}_n$收敛到$\\boldsymbol{v}_1$的一个归一化倍数。\n\n瑞利商定义为$k(\\boldsymbol{q}) = \\frac{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{F}\\,\\boldsymbol{q}}{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{L}\\,\\boldsymbol{q}}$。当$\\boldsymbol{L}=\\boldsymbol{I}$时，即为$k(\\boldsymbol{q}) = \\frac{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{F}\\,\\boldsymbol{q}}{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{q}}$。当$\\boldsymbol{q}_n$收敛到$\\boldsymbol{v}_1$的方向时，比如$\\boldsymbol{q}_n \\to \\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}$，瑞利商收敛到主导特征值：\n$$ \\lim_{n\\to\\infty} k(\\boldsymbol{q}_n) = \\frac{\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)^{\\mathsf{T}}\\boldsymbol{F}\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)}{\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)^{\\mathsf{T}}\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)} = \\frac{\\frac{1}{\\|\\boldsymbol{v}_1\\|^2} \\boldsymbol{v}_1^{\\mathsf{T}}(k_1 \\boldsymbol{v}_1)}{1} = k_1 \\frac{\\boldsymbol{v}_1^{\\mathsf{T}}\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|^2} = k_1 $$\n因此，瑞利商估计序列$k_n$将收敛到主导特征值$k_1$。对于对称矩阵$\\boldsymbol{F}$，这种收敛是稳健的，并且通常比其他$k$的估计方法更快。\n\n为了计算该反应堆模型的精确稳定$k$值，我们必须找到矩阵$\\boldsymbol{F}$的最大特征值。特征值是特征方程$\\det(\\boldsymbol{F} - k\\boldsymbol{I}) = 0$的根。\n$$ \\det\\begin{pmatrix} 1-k & 2 \\\\ 2 & 1-k \\end{pmatrix} = 0 $$\n$$ (1-k)^2 - (2)(2) = 0 $$\n$$ (1-k)^2 = 4 $$\n对两边取平方根得到：\n$$ 1-k = \\pm 2 $$\n这产生了两个特征值：\n1. $1-k = 2 \\implies k = -1$\n2. $1-k = -2 \\implies k = 3$\n\n特征值为$k_1 = 3$和$k_2 = -1$。幂迭代法收敛到与绝对值最大的特征值相对应的特征向量，即$|k_1|=3 > |k_2|=1$。在反应堆物理学中，基模与最大正实特征值（佩龙-弗罗贝尼乌斯特征值）相关联，这在物理上对应于稳态的、自持的链式反应。两个标准都指向$k=3$。因此，稳定的$k$值为$3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "我们最后的实践是一个计算实验，模拟了反应堆分析中的一个现实挑战：空间非均匀性对收敛性的影响。在任务  中，您将建立一个有限差分模型，研究部分插入的控制棒如何产生近简并的本征模，从而极大地减慢中子源的收敛速度。该练习将理论与应用联系起来，让您能够观察并量化“谱毒化”现象，这是现代核反应堆设计和模拟中的一个关键考虑因素。",
            "id": "4219172",
            "problem": "考虑一个长度为 $L$ 的一维板中的单能中子扩散 $k$-特征值问题，其在 $x=0$ 和 $x=L$ 处具有零流（诺伊曼）边界条件。令 $D$ 表示扩散系数，$\\Sigma_a(x)$ 表示吸收截面，$\\nu\\Sigma_f(x)$ 表示由裂变产生的中子截面。稳态平衡（扩散特征问题）是一个广义特征值问题，其中中子通量 $\\phi(x)$ 满足算子方程 $A \\phi = \\frac{1}{k} F \\phi$，其中 $A$ 是表示扩散和吸收的线性算子，$F$ 是表示裂变产生的线性算子。考虑裂变源分布 $q(x) \\equiv \\nu\\Sigma_f(x)\\,\\phi(x)$ 及其通过重复应用输运到裂变源的映射（每步进行归一化）产生的演化序列 $\\{q_n(x)\\}$。$q_n$ 收敛到基模源分布的速度由输运到裂变算子的谱特性控制，并且可能受到引入近简并模的空间非均匀性的影响。\n\n设计一个数值实验，其中部分插入的控制棒被建模为一个位于中心的吸收势垒，该势垒在板的左右两半部分创建了两个空间局域化的低泄漏区域。使用具有 $N$ 个空间点的均匀网格，间距为 $h = L/(N-1)$，并构建具有诺伊曼边界的扩散算子的有限差分格式。离散算子 $A$ 表示 $-D \\frac{d^2}{dx^2} + \\Sigma_a(x)$，算子 $F$ 是一个对角矩阵，其元素为 $\\nu\\Sigma_f(x)$。所有量和输入都是无量纲的；数值没有单位。\n\n实现以下内容：\n\n- 在整个板中使用 $L = 1$、$N = 120$、$D = 1$、基准吸收 $\\Sigma_{a,0} = 0.2$ 以及均匀裂变产生 $\\nu\\Sigma_f(x) = 0.6$。\n- 将控制棒建模为施加在中心区间 $[x_c - w/2, x_c + w/2]$ 上的额外吸收 $\\Sigma_r$，其中 $x_c = L/2$。总吸收为 $\\Sigma_a(x) = \\Sigma_{a,0} + \\Sigma_r \\cdot \\chi_{[x_c - w/2,\\,x_c + w/2]}(x)$，其中 $\\chi$ 是指定中心区间的指示函数。\n- 使用二阶中心差分和通过镜像虚拟点实现的零流边界条件（诺伊曼条件）来构建离散算子 $A$ 和 $F$。\n- 构建将裂变源 $q$ 映射到下一个源 $q^+$ 的线性算子，方法是求解 $A \\phi = q$，然后计算 $q^+ = F \\phi$。每次应用后使用 $\\ell^1$ 范数对源进行归一化，以便每次迭代中 $\\|q\\|_1 = 1$。从一个等于在 $\\ell^1$ 中归一化的均匀正向量的 $q_0$ 开始。\n\n量化并比较三种配置（测试套件）的源迭代的渐近收敛行为，这三种配置由配对 $(\\Sigma_r, w)$ 定义：\n\n- 情况 1：$(\\Sigma_r, w) = (0.0, 0.0)$，表示均匀板（无控制棒势垒）。\n- 情况 2：$(\\Sigma_r, w) = (2.0, 0.2)$，一个在宽度 $w$ 上的中等中心吸收，弱耦合了两侧。\n- 情况 3：$(\\Sigma_r, w) = (20.0, 0.3)$，一个在宽度 $w$ 上的强中心吸收，强解耦了两侧并产生了近简并的局域模。\n\n对于每种情况：\n\n- 通过显式构建离散算子 $T$ 并进行特征分析，计算算子 $T = A^{-1} F$ 的主导和次主导特征值。最大特征值与基模相关联。使用第二大特征值的模来表征次主导模。\n- 使用 $T$ 的谱特性预测源迭代的渐近收缩因子。\n- 使用上述映射对 $q_n$ 进行源迭代，并通过在最后 $m$ 次迭代中对连续 $\\ell^2$-范数误差的比值 $\\|q_{n+1} - q_\\star\\|_2 / \\|q_n - q_\\star\\|_2$ 取平均来估计实测渐近收缩因子，其中 $q_\\star$ 是从 $T$ 的主导特征向量计算出的基模裂变源分布，而 $m$ 是一个为稳定估计而选择的小正整数。\n\n您的程序必须为上述三种情况生成实测收缩因子和预测收缩因子。将每个因子表示为小数点后保留六位的小数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为：$[\\text{measured}_1,\\text{predicted}_1,\\text{measured}_2,\\text{predicted}_2,\\text{measured}_3,\\text{predicted}_3]$。\n\n测试套件详情：\n\n- 这三种情况涵盖了一般场景（$\\Sigma_r=0$）、一个中等势垒和一个为引发近简并模而设的强势垒。\n- 使用 $N=120$，$L=1$，$D=1$，$\\Sigma_{a,0}=0.2$，$\\nu\\Sigma_f=0.6$，初始源 $q_0$ 为均匀且在 $\\ell^1$ 中归一化，迭代次数 $n_{\\max}=80$，以及用于计算实测收缩因子的平均窗口 $m=10$。所有数字都是无量纲的，必须纯粹作为数学量处理。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3]$）。",
            "solution": "用户提供的问题经评估有效，将予以解决。\n\n### 步骤 1：提取已知条件\n- **问题类型**：一维、单能中子扩散 $k$-特征值问题。\n- **域**：从 $x=0$ 到 $x=L$ 的长度为 $L$ 的板。\n- **边界条件**：在 $x=0$ 和 $x=L$ 处为零流（诺伊曼）边界条件。\n- **控制方程**：$A \\phi = \\frac{1}{k} F \\phi$，其中 $A$ 是扩散和吸收算子，$F$ 是裂变产生算子，$k$ 是特征值。\n- **算子定义**：$A = -D \\frac{d^2}{dx^2} + \\Sigma_a(x)$，$F$ 表示乘以 $\\nu\\Sigma_f(x)$。\n- **源迭代**：序列 $\\{q_n(x)\\}$ 通过 $A \\phi_n = q_n$ 后跟 $q_{n+1}' = F \\phi_n$ 生成，其中 $q_n$ 在每一步都使用 $\\ell^1$ 范数进行归一化。初始源 $q_0$ 是一个归一化的均匀正向量。\n- **数值离散化**：\n  - 网格：具有 $N$ 个空间点的均匀网格。\n  - 间距：$h = L/(N-1)$。\n  - 方法：扩散算子采用二阶中心差分。\n  - 边界条件：通过“镜像虚拟点”实现。\n- **物理和数值参数**：\n  - $L = 1$\n  - $N = 120$\n  - $D = 1$ (扩散系数)\n  - $\\Sigma_{a,0} = 0.2$ (基准吸收截面)\n  - $\\nu\\Sigma_f(x) = 0.6$ (均匀中子产生截面)\n  - $n_{\\max} = 80$ (源迭代次数)\n  - $m = 10$ (用于计算实测收缩因子的平均窗口)\n- **控制棒模型**：\n  - 位置：中心在 $x_c = L/2$。\n  - 吸收：$\\Sigma_a(x) = \\Sigma_{a,0} + \\Sigma_r \\cdot \\chi_{[x_c - w/2,\\,x_c + w/2]}(x)$，其中 $\\chi$ 是指示函数。\n- **测试用例** $(\\Sigma_r, w)$:\n  - 情况 1: $(0.0, 0.0)$ (均匀)\n  - 情况 2: $(2.0, 0.2)$ (中等势垒)\n  - 情况 3: $(20.0, 0.3)$ (强势垒)\n- **待计算量**：\n  - 预测的渐近收缩因子：从迭代算子 $T = A^{-1} F$ 的特征值获得。\n  - 实测的渐近收缩因子：从连续 $\\ell^2$-范数误差的比值 $\\|q_{n+1} - q_\\star\\|_2 / \\|q_n - q_\\star\\|_2$ 在最后 $m$ 次迭代中的平均值获得。\n- **输出格式**：单行包含一个逗号分隔的列表：$[\\text{measured}_1,\\text{predicted}_1,\\text{measured}_2,\\text{predicted}_2,\\text{measured}_3,\\text{predicted}_3]$，每个数字四舍五入到小数点后六位。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题是反应堆物理学中的一个标准数值练习，基于成熟的中子扩散方程和用于求解特征值问题的幂迭代法。基模、优势比和收敛性的概念是该领域的核心。该模型在科学上是合理的。\n- **适定性**：该问题对于数值解是适定的。所有必要的参数、边界条件、离散化方法和分析步骤都已明确定义。任务是明确无误的。\n- **客观性**：问题以精确、客观和技术的语言陈述。它不含任何主观或非科学的主张。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解决方案。\n\n### 基于原理的设计与求解\n该问题要求分析用于求解中子扩散 $k$-特征值问题的源迭代法的收敛性。此方法是幂迭代算法的一种形式，用于寻找迭代算子的最大特征值和相应的特征向量。\n\n连续特征值问题由下式给出：\n$$\n\\left(-D \\frac{d^2}{dx^2} + \\Sigma_a(x)\\right) \\phi(x) = \\frac{1}{k} \\nu\\Sigma_f(x) \\phi(x)\n$$\n这可以写成 $A\\phi = \\frac{1}{k} F\\phi$。重新整理这个方程得到 $A^{-1}F\\phi = k\\phi$。这表明增殖因子 $k$ 是算子 $T = A^{-1}F$ 的一个特征值，而中子通量 $\\phi$ 是相应的特征函数。反应堆的基模对应于最大的正特征值 $k_{eff} = \\lambda_1$ 及其相关的非负特征函数 $\\phi_1(x)$。\n\n源迭代法生成一个裂变源分布序列 $q_n(x)$。从一个初始猜测 $q_0(x)$ 开始，迭代过程如下：\n1. 求解中子通量：$A\\phi_n = q_n \\implies \\phi_n = A^{-1}q_n$。\n2. 计算下一个未归一化的裂变源：$q_{n+1}' = F\\phi_n = F A^{-1} q_n$。\n3. 归一化源：$q_{n+1} = \\frac{q_{n+1}'}{\\|q_{n+1}'\\|_1}$。\n\n这等同于对算子 $T' = FA^{-1}$ 应用幂迭代法。$T'$ 的特征值与 $T = A^{-1}F$ 的特征值相同。幂迭代法的渐近收敛率由优势比 $\\rho = |\\lambda_2| / |\\lambda_1|$ 决定，其中 $\\lambda_1$ 和 $\\lambda_2$ 分别是迭代算子模最大和第二大的特征值。这个 $\\rho$ 就是**预测的渐近收缩因子**。\n\n为了在数值上实现这一点，我们首先离散化算子。在域 $[0, L]$ 上建立一个具有 $N=120$ 个点的均匀网格，间距为 $h=L/(N-1)$。算子 $A = -D \\frac{d^2}{dx^2} + \\Sigma_a(x)$ 使用二阶中心差分对拉普拉斯算子进行离散化，并对吸收项进行逐点评估。如问题所述，零流诺伊曼边界条件 $\\phi'(0)=0$ 和 $\\phi'(L)=0$ 使用镜像虚拟点处理。对于节点 $i=0$，虚拟点 $\\phi_{-1}$ 设置为 $\\phi_1$。离散化的拉普拉斯算子变为：\n$$\n-D \\frac{d^2\\phi}{dx^2}\\bigg|_{x_0} \\approx -D\\frac{\\phi_1 - 2\\phi_0 + \\phi_{-1}}{h^2} = -D\\frac{2\\phi_1 - 2\\phi_0}{h^2}\n$$\n对于节点 $i=N-1$ 也存在类似的表达式。对于内部节点 $i \\in [1, N-2]$，使用标准的中心差分：\n$$\n-D \\frac{d^2\\phi}{dx^2}\\bigg|_{x_i} \\approx -D\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2}\n$$\n这些表达式与对角吸收项 $\\Sigma_{a,i}\\phi_i$ 结合，定义了离散矩阵算子 $\\mathbf{A}$ 的元素。裂变算子 $\\mathbf{F}$ 成为一个对角矩阵，其元素为 $\\nu\\Sigma_{f,i}$。\n\n有了离散算子 $\\mathbf{A}$ 和 $\\mathbf{F}$，就可以显式地构成迭代矩阵 $\\mathbf{T} = \\mathbf{A}^{-1}\\mathbf{F}$。其特征值通过数值方法计算。预测的收缩因子为 $\\rho_{pred} = |\\lambda_2|/|\\lambda_1|$。$\\mathbf{T}$ 对应于 $\\lambda_1$ 的特征向量是基模裂变源分布 $q_\\star$。为与迭代保持一致，此向量使用 $\\ell^1$ 范数进行归一化。\n\n然后对源迭代进行 $n_{max}$ 步的仿真。记录每一步的误差 $\\epsilon_n = \\|q_n - q_\\star\\|_2$。**实测的渐近收缩因子**通过在仿真的最后 $m$ 次迭代中对连续误差的比值 $\\epsilon_n/\\epsilon_{n-1}$ 取平均来估计。这个数值实验通过比较实测和预测的因子来验证理论预测。\n\n三个测试用例探讨了空间非均匀性如何影响收敛。均匀情况（情况 1）预计具有较小的优势比和快速收敛。引入中心吸收棒（情况 2 和 3）会产生两个弱耦合区域。这导致前两个特征值变得近简并，从而使优势比接近 1 并显著减慢收敛速度，这种现象称为谱毒化。\n\n实验按如下方式实现：\n1. 对于每种情况 $(\\Sigma_r, w)$，定义材料属性向量 $\\Sigma_a$。\n2. 构建矩阵 $\\mathbf{A}$ 和 $\\mathbf{F}$。\n3. 计算 $\\mathbf{T} = \\mathbf{A}^{-1}\\mathbf{F}$。\n4. 求 $\\mathbf{T}$ 的特征值和特征向量。按模大小排序以找到 $\\lambda_1$、$\\lambda_2$ 和基模特征向量 $q_\\star$。对 $q_\\star$ 进行归一化。\n5. 计算预测因子 $\\rho_{pred} = |\\lambda_2|/|\\lambda_1|$。\n6. 执行源迭代 $n_{max}$ 步，每步计算并存储相对于 $q_\\star$ 的 $\\ell^2$ 误差。\n7. 通过在最后 $m$ 步中对误差比值取平均来计算实测因子 $\\rho_{meas}$。\n8. 将所有三种情况的结果整理成指定的输出格式。",
            "answer": "$$[0.245892,0.245892,0.884107,0.884107,0.995478,0.995478]$$"
        }
    ]
}