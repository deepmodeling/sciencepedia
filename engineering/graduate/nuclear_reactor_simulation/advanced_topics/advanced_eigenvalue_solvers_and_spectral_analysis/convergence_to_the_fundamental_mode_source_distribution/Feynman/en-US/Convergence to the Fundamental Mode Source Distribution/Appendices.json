{
    "hands_on_practices": [
        {
            "introduction": "The power iteration method is the engine that drives the search for the fundamental mode source distribution in reactor physics simulations. While simple in principle, its practical implementation requires careful consideration of numerical details. This exercise  explores how the choice of normalization scheme can dramatically impact the stability of the iteration, using a simple 2x2 matrix model to contrast a naive approach with the robust Rayleigh quotient method.",
            "id": "4219128",
            "problem": "Consider a homogeneous two-region coarse-mesh model of a thermal nuclear reactor at steady state. Let the unknown be the fission source distribution vector $\\boldsymbol{q}$ of dimension $2$, and let the production and loss be represented by linear operators. The fundamental approximation is the generalized eigenproblem for the steady-state balance,\n$$\n\\boldsymbol{F}\\,\\boldsymbol{q} \\;=\\; k\\,\\boldsymbol{L}\\,\\boldsymbol{q},\n$$\nwhere $\\boldsymbol{F}$ is the nonnegative production operator, $\\boldsymbol{L}$ is the positive loss operator, and $k$ is the effective multiplication factor. In a discrete setting, take $\\boldsymbol{L} = \\boldsymbol{I}$ (the identity matrix) and\n$$\n\\boldsymbol{F} \\;=\\; \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix}.\n$$\nThus the $k$-eigenproblem reduces to $\\boldsymbol{F}\\,\\boldsymbol{q} = k\\,\\boldsymbol{q}$, and a naive power iteration uses $\\boldsymbol{q}_{n+1} = \\boldsymbol{F}\\,\\boldsymbol{q}_n$ with a normalization at each step.\n\nDefine two normalization strategies:\n- Naive component normalization: after forming $\\boldsymbol{q}_{n+1} = \\boldsymbol{F}\\,\\boldsymbol{q}_n$, rescale $\\boldsymbol{q}_{n+1}$ so that its first component equals $1$, i.e., $(\\boldsymbol{q}_{n+1})_1 = 1$. Estimate $k_n$ at each step by the component ratio $k_n = \\frac{(\\boldsymbol{q}_{n+1})_1}{(\\boldsymbol{q}_n)_1}$. Initialize with $\\boldsymbol{q}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n- Rayleigh quotient normalization for the generalized problem $\\boldsymbol{F}\\,\\boldsymbol{q} = k\\,\\boldsymbol{L}\\,\\boldsymbol{q}$: define\n$$\nk(\\boldsymbol{q}) \\;=\\; \\frac{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{F}\\,\\boldsymbol{q}}{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{L}\\,\\boldsymbol{q}},\n$$\nand at each step set $k_{n+1} = k(\\boldsymbol{q}_n)$, then update $\\boldsymbol{q}_{n+1} = \\frac{1}{k_{n+1}}\\boldsymbol{L}^{-1}\\boldsymbol{F}\\,\\boldsymbol{q}_n$ followed by normalization with respect to the $\\boldsymbol{L}$-inner-product, $\\|\\boldsymbol{q}\\|_{\\boldsymbol{L}}^2 = \\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{L}\\,\\boldsymbol{q}$, such that $\\|\\boldsymbol{q}_{n+1}\\|_{\\boldsymbol{L}} = 1$. In this particular case $\\boldsymbol{L} = \\boldsymbol{I}$, so $\\|\\boldsymbol{q}\\|_{\\boldsymbol{L}} = \\|\\boldsymbol{q}\\|_{2}$ is the Euclidean norm.\n\nTasks:\n1. Show, by explicit calculation of the first few iterates, that the naive component normalization induces oscillations in $k_n$ and the second component $(\\boldsymbol{q}_n)_2$. Provide the closed-form scalar recurrence for $(\\boldsymbol{q}_n)_2$ under the naive normalization and determine whether its fixed point is attracting or repelling.\n2. Using the Rayleigh quotient normalization, explain from first principles why $k_n$ and $\\boldsymbol{q}_n$ converge to the fundamental mode and compute the exact stabilized value of $k$ for this discrete reactor model. Express your final answer for $k$ as a single closed-form analytical expression with no units.\n\nYour final answer must be a single analytical expression. No rounding is required.",
            "solution": "The problem asks for an analysis of two power iteration schemes for finding the fundamental eigenmode of a simplified nuclear reactor model. The governing equation is the eigenvalue problem $\\boldsymbol{F}\\,\\boldsymbol{q} = k\\,\\boldsymbol{q}$, with $\\boldsymbol{F} = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix}$.\n\nFirst, we analyze the naive component normalization method as required by the first task.\nLet the sequence of vectors be denoted by $\\boldsymbol{q}_n$. The starting vector is given as $\\boldsymbol{q}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The iteration proceeds by applying the matrix $\\boldsymbol{F}$ and then rescaling the resulting vector such that its first component is $1$. The estimate for the eigenvalue $k$ at step $n$ is given by the ratio of the first components before and after the matrix multiplication.\n\nLet's compute the first few iterates:\n\nStep $n=0$:\nWe start with $\\boldsymbol{q}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\nThe unnormalized next vector is $\\boldsymbol{q}_{1}' = \\boldsymbol{F}\\,\\boldsymbol{q}_0 = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$.\nThe estimate for $k$ is $k_0 = \\frac{(\\boldsymbol{q}_{1}')_1}{(\\boldsymbol{q}_0)_1} = \\frac{1}{1} = 1$.\nThe new normalized vector $\\boldsymbol{q}_1$ is obtained by ensuring its first component is $1$. Since $(\\boldsymbol{q}_{1}')_1$ is already $1$, we have $\\boldsymbol{q}_1 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$.\n\nStep $n=1$:\nWe start with $\\boldsymbol{q}_1 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$.\nThe unnormalized next vector is $\\boldsymbol{q}_{2}' = \\boldsymbol{F}\\,\\boldsymbol{q}_1 = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1 + 2(2) \\\\ 2(1) + 1(2) \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}$.\nThe estimate for $k$ is $k_1 = \\frac{(\\boldsymbol{q}_{2}')_1}{(\\boldsymbol{q}_1)_1} = \\frac{5}{1} = 5$.\nThe new normalized vector is $\\boldsymbol{q}_2 = \\frac{1}{5}\\boldsymbol{q}_{2}' = \\frac{1}{5}\\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{4}{5} \\end{pmatrix}$.\n\nStep $n=2$:\nWe start with $\\boldsymbol{q}_2 = \\begin{pmatrix} 1 \\\\ \\frac{4}{5} \\end{pmatrix}$.\nThe unnormalized next vector is $\\boldsymbol{q}_{3}' = \\boldsymbol{F}\\,\\boldsymbol{q}_2 = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} 1 + 2(\\frac{4}{5}) \\\\ 2(1) + \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{13}{5} \\\\ \\frac{14}{5} \\end{pmatrix}$.\nThe estimate for $k$ is $k_2 = \\frac{(\\boldsymbol{q}_{3}')_1}{(\\boldsymbol{q}_2)_1} = \\frac{13/5}{1} = \\frac{13}{5} = 2.6$.\nThe new normalized vector is $\\boldsymbol{q}_3 = \\frac{1}{13/5}\\boldsymbol{q}_{3}' = \\frac{5}{13}\\begin{pmatrix} \\frac{13}{5} \\\\ \\frac{14}{5} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{14}{13} \\end{pmatrix}$.\n\nStep $n=3$:\nWe start with $\\boldsymbol{q}_3 = \\begin{pmatrix} 1 \\\\ \\frac{14}{13} \\end{pmatrix}$.\nThe unnormalized next vector is $\\boldsymbol{q}_{4}' = \\boldsymbol{F}\\,\\boldsymbol{q}_3 = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\frac{14}{13} \\end{pmatrix} = \\begin{pmatrix} 1 + 2(\\frac{14}{13}) \\\\ 2 + \\frac{14}{13} \\end{pmatrix} = \\begin{pmatrix} \\frac{41}{13} \\\\ \\frac{40}{13} \\end{pmatrix}$.\nThe estimate for $k$ is $k_3 = \\frac{(\\boldsymbol{q}_{4}')_1}{(\\boldsymbol{q}_3)_1} = \\frac{41/13}{1} = \\frac{41}{13} \\approx 3.1538$.\n\nThe sequence of eigenvalue estimates is $k_n: 1, 5, 2.6, 41/13 \\approx 3.15, \\dots$. This sequence is not monotonically converging; it oscillates.\nThe sequence of the second components of the vectors $\\boldsymbol{q}_n$ is $(\\boldsymbol{q}_n)_2: 0, 2, 4/5=0.8, 14/13 \\approx 1.077, \\dots$. This sequence also exhibits oscillatory behavior.\n\nTo find the closed-form scalar recurrence for $(\\boldsymbol{q}_n)_2$, let's denote $y_n = (\\boldsymbol{q}_n)_2$. By the normalization rule, for $n \\ge 1$, the vector is of the form $\\boldsymbol{q}_n = \\begin{pmatrix} 1 \\\\ y_n \\end{pmatrix}$. The iteration is $\\boldsymbol{q}_{n+1}' = \\boldsymbol{F}\\,\\boldsymbol{q}_n$.\n$$ \\boldsymbol{q}_{n+1}' = \\begin{pmatrix} 1 & 2 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ y_n \\end{pmatrix} = \\begin{pmatrix} 1 + 2y_n \\\\ 2 + y_n \\end{pmatrix} $$\nTo obtain $\\boldsymbol{q}_{n+1}$, we normalize by dividing by the first component:\n$$ \\boldsymbol{q}_{n+1} = \\frac{1}{1+2y_n} \\begin{pmatrix} 1+2y_n \\\\ 2+y_n \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{2+y_n}{1+2y_n} \\end{pmatrix} $$\nThus, the recurrence relation for $y_{n+1} = (\\boldsymbol{q}_{n+1})_2$ is:\n$$ y_{n+1} = f(y_n) = \\frac{2+y_n}{1+2y_n} $$\nA fixed point $y^*$ of this recurrence satisfies $y^* = f(y^*)$:\n$$ y^* = \\frac{2+y^*}{1+2y^*} \\implies y^*(1+2y^*) = 2+y^* \\implies y^* + 2(y^*)^2 = 2+y^* \\implies 2(y^*)^2 = 2 $$\nThis gives $(y^*)^2=1$, so the fixed points are $y^*=1$ and $y^*=-1$. These correspond to the eigenvectors $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ and $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ after being scaled to have a first component of $1$.\n\nTo determine if a fixed point is attracting or repelling, we analyze the derivative of the recurrence function $f(y) = \\frac{2+y}{1+2y}$ at the fixed point.\n$$ f'(y) = \\frac{d}{dy}\\left(\\frac{2+y}{1+2y}\\right) = \\frac{(1)(1+2y) - (2+y)(2)}{(1+2y)^2} = \\frac{1+2y-4-2y}{(1+2y)^2} = \\frac{-3}{(1+2y)^2} $$\nAt $y^*=1$:\n$$ f'(1) = \\frac{-3}{(1+2(1))^2} = \\frac{-3}{3^2} = -\\frac{1}{3} $$\nSince $|f'(1)| = \\frac{1}{3} < 1$, the fixed point $y^*=1$ is attracting. The negative sign of the derivative indicates that the iterates oscillate around the fixed point as they converge, which is consistent with our initial calculations.\nAt $y^*=-1$:\n$$ f'(-1) = \\frac{-3}{(1+2(-1))^2} = \\frac{-3}{(-1)^2} = -3 $$\nSince $|f'(-1)| = 3 > 1$, the fixed point $y^*=-1$ is repelling.\n\nNow for the second task, we analyze the Rayleigh quotient normalization. The power method, in its general form $\\boldsymbol{q}_{n+1} = C_n \\boldsymbol{F} \\boldsymbol{q}_n$ where $C_n$ is a normalization constant, converges to the eigenvector associated with the eigenvalue of largest magnitude. Let the eigenvalues of $\\boldsymbol{F}$ be $k_1, k_2, \\dots$ sorted by magnitude $|k_1| > |k_2| \\ge \\dots$, with corresponding eigenvectors $\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\dots$. Any initial vector $\\boldsymbol{q}_0$ can be expressed as a linear combination of these eigenvectors: $\\boldsymbol{q}_0 = \\sum_i a_i \\boldsymbol{v}_i$. Applying $\\boldsymbol{F}$ repeatedly gives $\\boldsymbol{F}^n \\boldsymbol{q}_0 = \\sum_i a_i k_i^n \\boldsymbol{v}_i$. Factoring out the dominant eigenvalue term $k_1^n$:\n$$ \\boldsymbol{F}^n \\boldsymbol{q}_0 = k_1^n \\left( a_1 \\boldsymbol{v}_1 + \\sum_{i>1} a_i \\left(\\frac{k_i}{k_1}\\right)^n \\boldsymbol{v}_i \\right) $$\nSince $|k_i/k_1| < 1$ for $i>1$, the terms in the summation vanish as $n\\to\\infty$. Provided $a_1 \\neq 0$, the vector $\\boldsymbol{F}^n \\boldsymbol{q}_0$ becomes increasingly parallel to the dominant eigenvector $\\boldsymbol{v}_1$. The sequence of normalized vectors $\\boldsymbol{q}_n$ thus converges to a normalized multiple of $\\boldsymbol{v}_1$.\n\nThe Rayleigh quotient is defined as $k(\\boldsymbol{q}) = \\frac{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{F}\\,\\boldsymbol{q}}{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{L}\\,\\boldsymbol{q}}$. With $\\boldsymbol{L}=\\boldsymbol{I}$, this is $k(\\boldsymbol{q}) = \\frac{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{F}\\,\\boldsymbol{q}}{\\boldsymbol{q}^{\\mathsf{T}}\\boldsymbol{q}}$. As $\\boldsymbol{q}_n$ converges to the direction of $\\boldsymbol{v}_1$, say $\\boldsymbol{q}_n \\to \\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}$, the Rayleigh quotient converges to the dominant eigenvalue:\n$$ \\lim_{n\\to\\infty} k(\\boldsymbol{q}_n) = \\frac{\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)^{\\mathsf{T}}\\boldsymbol{F}\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)}{\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)^{\\mathsf{T}}\\left(\\frac{\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|}\\right)} = \\frac{\\frac{1}{\\|\\boldsymbol{v}_1\\|^2} \\boldsymbol{v}_1^{\\mathsf{T}}(k_1 \\boldsymbol{v}_1)}{1} = k_1 \\frac{\\boldsymbol{v}_1^{\\mathsf{T}}\\boldsymbol{v}_1}{\\|\\boldsymbol{v}_1\\|^2} = k_1 $$\nTherefore, the sequence of Rayleigh quotient estimates $k_n$ will converge to the dominant eigenvalue $k_1$. For a symmetric matrix $\\boldsymbol{F}$, this convergence is robust and typically faster than other estimates of $k$.\n\nTo compute the exact stabilized value of $k$ for this reactor model, we must find the largest eigenvalue of the matrix $\\boldsymbol{F}$. The eigenvalues are the roots of the characteristic equation $\\det(\\boldsymbol{F} - k\\boldsymbol{I}) = 0$.\n$$ \\det\\begin{pmatrix} 1-k & 2 \\\\ 2 & 1-k \\end{pmatrix} = 0 $$\n$$ (1-k)^2 - (2)(2) = 0 $$\n$$ (1-k)^2 = 4 $$\nTaking the square root of both sides gives:\n$$ 1-k = \\pm 2 $$\nThis yields two eigenvalues:\n1. $1-k = 2 \\implies k = -1$\n2. $1-k = -2 \\implies k = 3$\n\nThe eigenvalues are $k_1 = 3$ and $k_2 = -1$. The power iteration method converges to the eigenvector corresponding to the eigenvalue with the largest absolute value, which is $|k_1|=3 > |k_2|=1$. In reactor physics, the fundamental mode is associated with the largest, positive, real eigenvalue (the Perron-Frobenius eigenvalue), which physically corresponds to a steady-state, self-sustaining chain reaction. Both criteria point to $k=3$. Therefore, the stabilized value of $k$ is $3$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "Moving from abstract matrices to physical models, this practice examines a two-group diffusion problem to reveal a profound insight about the fission process. In many models, the fission neutron energy spectrum is assumed to be independent of the energy of the neutron causing fission, leading to a \"separable\" fission operator. This problem  guides you to discover how this common physical assumption simplifies the mathematical structure of the iteration operator, leading to an ideal, single-step convergence to the fundamental mode.",
            "id": "4219116",
            "problem": "Consider a homogeneous two-energy-group reactor region modeled by the steady-state multigroup diffusion balance with neutron multiplication. Assume the spatial flux shape is separable and fixed to the fundamental spatial mode characterized by a geometric buckling $B^{2}$, so leakage is represented as $D_{g} B^{2}$ in each energy group $g \\in \\{1,2\\}$. The energy coupling includes downscattering from group $1$ to $2$ and upscattering from group $2$ to $1$. Fission neutrons are born with a fixed, group-wise fraction given by the fission spectrum components $(\\chi_{1}, \\chi_{2})$. The material parameters are:\n\n- Diffusion coefficients: $D_{1} = 1.5 \\ \\text{cm}$, $D_{2} = 0.5 \\ \\text{cm}$.\n- Geometric buckling: $B^{2} = 2.5 \\times 10^{-3} \\ \\text{cm}^{-2}$.\n- Absorption cross sections: $\\Sigma_{a,1} = 0.01 \\ \\text{cm}^{-1}$, $\\Sigma_{a,2} = 0.09 \\ \\text{cm}^{-1}$.\n- Scattering cross sections (out of and between groups): $\\Sigma_{s,1 \\to 2} = 0.12 \\ \\text{cm}^{-1}$, $\\Sigma_{s,2 \\to 1} = 0.015 \\ \\text{cm}^{-1}$.\n- Neutron production by fission: $\\nu \\Sigma_{f,1} = 0.02 \\ \\text{cm}^{-1}$, $\\nu \\Sigma_{f,2} = 0.16 \\ \\text{cm}^{-1}$.\n- Fission spectrum fractions: $\\chi_{1} = 0.98$, $\\chi_{2} = 0.02$.\n\nStart from the two-group diffusion $k$-eigenvalue formulation based on particle balance and the definition of removal cross section $\\Sigma_{r,g} = \\Sigma_{a,g} + \\sum_{h \\neq g} \\Sigma_{s,g \\to h}$. Using these fundamental statements and the assumption of a fixed fundamental spatial shape (via $B^{2}$), derive the block operator that maps a fission source vector to the next fission source vector in an outer source iteration for the $k$-eigenvalue problem. Then, for the given numerical parameters, compute the eigenvalues of this block operator and the corresponding dominance ratio defined as $r = |\\lambda_{2}| / |\\lambda_{1}|$, where $|\\lambda_{1}| \\geq |\\lambda_{2}|$ are the moduli of its two eigenvalues. Express the final dominance ratio as a dimensionless number. No rounding is required for the final answer.",
            "solution": "The problem requires the derivation of the source iteration operator for a two-group, steady-state $k$-eigenvalue problem and the subsequent calculation of the dominance ratio of its eigenvalues.\n\nFirst, we formulate the problem based on the provided physical description. The steady-state neutron balance for a homogeneous medium, assuming a fixed fundamental spatial mode shape characterized by geometric buckling $B^2$, can be written as a set of algebraic equations. The term $-\\nabla \\cdot D_g \\nabla \\phi_g$ in the diffusion equation becomes $D_g B^2 \\phi_g$. The balance for each energy group $g$ is:\n$$\n\\text{Leakage} + \\text{Absorption} + \\text{Out-scattering} = \\text{In-scattering} + \\text{Fission Source}\n$$\nFor the two-group system ($g \\in \\{1,2\\}$), this yields:\nGroup 1:\n$$\nD_1 B^2 \\phi_1 + \\Sigma_{a,1} \\phi_1 + \\Sigma_{s,1 \\to 2} \\phi_1 = \\Sigma_{s,2 \\to 1} \\phi_2 + \\frac{1}{k} \\chi_1 (\\nu\\Sigma_{f,1} \\phi_1 + \\nu\\Sigma_{f,2} \\phi_2)\n$$\nGroup 2:\n$$\nD_2 B^2 \\phi_2 + \\Sigma_{a,2} \\phi_2 + \\Sigma_{s,2 \\to 1} \\phi_2 = \\Sigma_{s,1 \\to 2} \\phi_1 + \\frac{1}{k} \\chi_2 (\\nu\\Sigma_{f,1} \\phi_1 + \\nu\\Sigma_{f,2} \\phi_2)\n$$\nwhere $\\phi_g$ is the scalar flux in group $g$, and $k$ is the effective multiplication factor.\n\nThese equations can be rearranged and written in matrix form. Let's move all terms except the fission source to the left-hand side:\n$$\n(D_1 B^2 + \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}) \\phi_1 - \\Sigma_{s,2 \\to 1} \\phi_2 = \\frac{1}{k} ( \\chi_1 \\nu\\Sigma_{f,1} \\phi_1 + \\chi_1 \\nu\\Sigma_{f,2} \\phi_2 )\n$$\n$$\n(D_2 B^2 + \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1}) \\phi_2 - \\Sigma_{s,1 \\to 2} \\phi_1 = \\frac{1}{k} ( \\chi_2 \\nu\\Sigma_{f,1} \\phi_1 + \\chi_2 \\nu\\Sigma_{f,2} \\phi_2 )\n$$\nThis can be expressed as a matrix eigenvalue equation $\\mathbf{A}\\vec{\\phi} = \\frac{1}{k} \\mathbf{F}\\vec{\\phi}$, where $\\vec{\\phi} = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix}$.\n\nThe matrix $\\mathbf{A}$ represents the net neutron removal (leakage, absorption, and net scattering out of a group):\n$$\n\\mathbf{A} = \\begin{pmatrix} D_1 B^2 + \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2} & -\\Sigma_{s,2 \\to 1} \\\\ -\\Sigma_{s,1 \\to 2} & D_2 B^2 + \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} \\end{pmatrix}\n$$\nThe problem defines the removal cross section as $\\Sigma_{r,g} = \\Sigma_{a,g} + \\sum_{h \\neq g} \\Sigma_{s,g \\to h}$. So, $\\Sigma_{r,1} = \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}$ and $\\Sigma_{r,2} = \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1}$. The diagonal elements of $\\mathbf{A}$ are $A_{gg} = D_g B^2 + \\Sigma_{r,g}$.\n\nThe matrix $\\mathbf{F}$ represents the production of fission neutrons:\n$$\n\\mathbf{F} = \\begin{pmatrix} \\chi_1 \\nu\\Sigma_{f,1} & \\chi_1 \\nu\\Sigma_{f,2} \\\\ \\chi_2 \\nu\\Sigma_{f,1} & \\chi_2 \\nu\\Sigma_{f,2} \\end{pmatrix} = \\begin{pmatrix} \\chi_1 \\\\ \\chi_2 \\end{pmatrix} \\begin{pmatrix} \\nu\\Sigma_{f,1} & \\nu\\Sigma_{f,2} \\end{pmatrix} = \\vec{\\chi}(\\boldsymbol{\\nu\\Sigma_f})^T\n$$\nThe source iteration method (or power iteration) is used to solve this eigenvalue problem. The \"fission source vector\" in this context is the vector representing the group-wise production of fission neutrons, $\\vec{f} = \\mathbf{F}\\vec{\\phi}$. The iteration proceeds as follows: given a source vector from the previous iteration, $\\vec{f}_i$, one first solves for the flux:\n$$\n\\mathbf{A}\\vec{\\phi}_{i+1} = \\frac{1}{k_i}\\vec{f}_i \\implies \\vec{\\phi}_{i+1} = \\frac{1}{k_i} \\mathbf{A}^{-1}\\vec{f}_i\n$$\nThen, a new source vector is computed using this flux:\n$$\n\\vec{f}_{i+1} = \\mathbf{F}\\vec{\\phi}_{i+1} = \\mathbf{F} \\left( \\frac{1}{k_i} \\mathbf{A}^{-1}\\vec{f}_i \\right) = \\frac{1}{k_i} (\\mathbf{F}\\mathbf{A}^{-1})\\vec{f}_i\n$$\nThe \"block operator that maps a fission source vector to the next\" is the matrix $\\mathbf{H} = \\mathbf{F}\\mathbf{A}^{-1}$. The power iteration method converges to the eigenvector of $\\mathbf{H}$ corresponding to the eigenvalue with the largest magnitude. The eigenvalues of $\\mathbf{H}$ are the possible values of $k$. The dominant eigenvalue $\\lambda_1$ is the effective multiplication factor, $k_{eff}$.\n\nThe problem asks for the dominance ratio, $r = |\\lambda_2|/|\\lambda_1|$, where $|\\lambda_1| \\ge |\\lambda_2|$ are the magnitudes of the eigenvalues of $\\mathbf{H}$.\n\nA critical observation must be made about the structure of the fission matrix $\\mathbf{F}$. As shown above, $\\mathbf{F}$ is the outer product of the fission spectrum vector $\\vec{\\chi}$ and the fission production vector $(\\boldsymbol{\\nu\\Sigma_f})^T$. An outer product of two vectors results in a matrix of rank 1.\nThe operator $\\mathbf{H}$ is the product of $\\mathbf{F}$ (a rank-$1$ matrix) and $\\mathbf{A}^{-1}$. We must first verify that $\\mathbf{A}$ is invertible.\nLet's calculate the elements of $\\mathbf{A}$ using the given parameters:\n$D_1 = 1.5 \\ \\text{cm}$, $D_2 = 0.5 \\ \\text{cm}$, $B^2 = 2.5 \\times 10^{-3} \\ \\text{cm}^{-2}$.\n$\\Sigma_{a,1} = 0.01 \\ \\text{cm}^{-1}$, $\\Sigma_{a,2} = 0.09 \\ \\text{cm}^{-1}$.\n$\\Sigma_{s,1 \\to 2} = 0.12 \\ \\text{cm}^{-1}$, $\\Sigma_{s,2 \\to 1} = 0.015 \\ \\text{cm}^{-1}$.\n$D_1 B^2 = 1.5 \\times 2.5 \\times 10^{-3} = 0.00375 \\ \\text{cm}^{-1}$.\n$D_2 B^2 = 0.5 \\times 2.5 \\times 10^{-3} = 0.00125 \\ \\text{cm}^{-1}$.\n$$\nA_{11} = 0.00375 + 0.01 + 0.12 = 0.13375 \\ \\text{cm}^{-1}\n$$\n$$\nA_{12} = -0.015 \\ \\text{cm}^{-1}\n$$\n$$\nA_{21} = -0.12 \\ \\text{cm}^{-1}\n$$\n$$\nA_{22} = 0.00125 + 0.09 + 0.015 = 0.10625 \\ \\text{cm}^{-1}\n$$\nThe determinant of $\\mathbf{A}$ is:\n$$\n\\det(\\mathbf{A}) = (0.13375)(0.10625) - (-0.015)(-0.12) = 0.0142109375 - 0.0018 = 0.0124109375\n$$\nSince $\\det(\\mathbf{A}) \\neq 0$, the matrix $\\mathbf{A}$ is invertible, and $\\mathbf{A}^{-1}$ exists and is a full-rank matrix (rank $2$).\n\nThe rank of a product of matrices is at most the minimum of the ranks of the individual matrices. Thus, $\\text{rank}(\\mathbf{H}) = \\text{rank}(\\mathbf{F}\\mathbf{A}^{-1}) \\le \\min(\\text{rank}(\\mathbf{F}), \\text{rank}(\\mathbf{A}^{-1})) = \\min(1, 2) = 1$.\nTherefore, the iteration operator $\\mathbf{H}$ is a rank-$1$ matrix.\n\nA fundamental property of an $n \\times n$ rank-$1$ matrix is that it has at most one non-zero eigenvalue. For our $2 \\times 2$ matrix $\\mathbf{H}$, this means that it has one non-zero eigenvalue, $\\lambda_1$, and one zero eigenvalue, $\\lambda_2=0$.\nThe non-zero eigenvalue is physically the effective multiplication factor $k_{eff}$, which for a multiplying system must be non-zero. The other eigenvalue must be exactly zero.\nTherefore, the two eigenvalues of $\\mathbf{H}$ are $\\lambda_1 = k_{eff}$ and $\\lambda_2 = 0$.\n\nThe problem states that $|\\lambda_1| \\ge |\\lambda_2|$, which is satisfied as long as the reactor is not exactly critical with $k_{eff}=0$. We can be certain $k_{eff} \\neq 0$ because the fission cross sections are non-zero.\nThe dominance ratio is defined as $r = |\\lambda_2| / |\\lambda_1|$.\nSubstituting the values of the eigenvalues:\n$$\nr = \\frac{|0|}{|\\lambda_1|} = \\frac{0}{|\\lambda_1|}\n$$\nAs long as $\\lambda_1 \\neq 0$, the dominance ratio is $0$. The fact that the problem specifies fission-producing materials ensures $\\lambda_1 = k_{eff} > 0$. The consequence of a zero dominance ratio is that the shape of the fission source vector converges to the fundamental mode shape in a single iteration of the source iteration method.\n\nTherefore, without needing to compute the full matrix $\\mathbf{H}$ or its non-zero eigenvalue, we can conclude on the basis of the rank of the operators that the second eigenvalue is zero.\n\nTo be fully certain, we can inspect the determinant of $\\mathbf{F}$.\n$\\nu \\Sigma_{f,1} = 0.02$, $\\nu \\Sigma_{f,2} = 0.16$, $\\chi_1 = 0.98$, $\\chi_2 = 0.02$.\n$$\n\\mathbf{F} = \\begin{pmatrix} 0.98 \\times 0.02 & 0.98 \\times 0.16 \\\\ 0.02 \\times 0.02 & 0.02 \\times 0.16 \\end{pmatrix} = \\begin{pmatrix} 0.0196 & 0.1568 \\\\ 0.0004 & 0.0032 \\end{pmatrix}\n$$\n$$\n\\det(\\mathbf{F}) = (0.0196)(0.0032) - (0.1568)(0.0004) = 0.00006272 - 0.00006272 = 0\n$$\nSince $\\det(\\mathbf{F})=0$, $\\mathbf{F}$ is singular and rank-$1$. Then $\\det(\\mathbf{H}) = \\det(\\mathbf{F}\\mathbf{A}^{-1}) = \\det(\\mathbf{F})\\det(\\mathbf{A}^{-1}) = 0 \\times (1/\\det(\\mathbf{A})) = 0$.\nThe determinant of a matrix is the product of its eigenvalues: $\\det(\\mathbf{H}) = \\lambda_1 \\lambda_2$.\nAs $\\det(\\mathbf{H})=0$, at least one eigenvalue must be zero. Since the system is physically multiplying, it must have one non-zero eigenvalue $k_{eff}$, so the other eigenvalue must be the one that is zero. Thus, $\\lambda_2=0$.\nThe dominance ratio is $r = |0|/|\\lambda_1| = 0$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Real-world reactors are spatially heterogeneous, containing fuel, moderator, and absorbers like control rods. These heterogeneities can create weakly-coupled regions that give rise to near-degenerate eigenmodes, a phenomenon that dramatically slows the convergence of the source iteration. This hands-on coding practice  challenges you to build a simulation that models this effect, predict the convergence slowdown by analyzing the system's eigenvalues, and verify your prediction by running a full source iteration.",
            "id": "4219172",
            "problem": "Consider the one-speed neutron diffusion $k$-eigenvalue problem in a one-dimensional slab of length $L$ with zero-current (Neumann) boundary conditions at $x=0$ and $x=L$. Let $D$ denote the diffusion coefficient, $\\Sigma_a(x)$ the absorption cross section, and $\\nu\\Sigma_f(x)$ the neutron production cross section due to fission. The steady-state balance (diffusion eigenproblem) is the generalized eigenvalue problem where the neutron flux $\\phi(x)$ satisfies: the operator equation $A \\phi = \\frac{1}{k} F \\phi$, where $A$ is the linear operator representing diffusion and absorption, and $F$ is the linear operator representing fission production. Consider the fission source distribution $q(x) \\equiv \\nu\\Sigma_f(x)\\,\\phi(x)$ and its evolving sequence $\\{q_n(x)\\}$ produced by repeated application of the transport-to-fission source mapping, normalized at each step. The convergence of $q_n$ to the fundamental mode source distribution is controlled by the spectral properties of the transport-to-fission operator and can be affected by spatial heterogeneities that introduce near-degenerate modes.\n\nDesign a numerical experiment in which a partially inserted control rod is modeled as a centrally located absorption barrier that creates two spatially localized low-leakage pockets at the left and right halves of the slab. Use a uniform grid with $N$ spatial points, with spacing $h = L/(N-1)$, and construct a finite-difference discretization of the diffusion operator with Neumann boundaries. The discrete operator $A$ represents $-D \\frac{d^2}{dx^2} + \\Sigma_a(x)$ and the operator $F$ is a diagonal matrix with entries $\\nu\\Sigma_f(x)$. All quantities and inputs are non-dimensionalized; numerical values are specified without units.\n\nImplement the following:\n\n- Use $L = 1$, $N = 120$, $D = 1$, a baseline absorption $\\Sigma_{a,0} = 0.2$, and a uniform fission production $\\nu\\Sigma_f(x) = 0.6$ throughout the slab.\n- Model the control rod as an additional absorption $\\Sigma_r$ applied on the central interval $[x_c - w/2, x_c + w/2]$, where $x_c = L/2$. The total absorption is then $\\Sigma_a(x) = \\Sigma_{a,0} + \\Sigma_r \\cdot \\chi_{[x_c - w/2,\\,x_c + w/2]}(x)$, where $\\chi$ is the indicator function of the specified central interval.\n- Form the discrete operators $A$ and $F$ using second-order central differences with zero-current boundary conditions implemented by mirrored ghost points (Neumann conditions).\n- Construct the linear operator that maps a fission source $q$ to the next source $q^+$ by solving $A \\phi = q$ and then computing $q^+ = F \\phi$. Normalize the source after each application using the $\\ell^1$ norm, so that $\\|q\\|_1 = 1$ at each iteration. Start with $q_0$ equal to a uniform positive vector normalized in $\\ell^1$.\n\nQuantify and compare the asymptotic convergence behavior of the source iteration for three configurations (test suite), defined by pairs $(\\Sigma_r, w)$:\n\n- Case $1$: $(\\Sigma_r, w) = (0.0, 0.0)$, representing a homogeneous slab (no control rod barrier).\n- Case $2$: $(\\Sigma_r, w) = (2.0, 0.2)$, a moderate central absorption over width $w$ that weakly couples the two sides.\n- Case $3$: $(\\Sigma_r, w) = (20.0, 0.3)$, a strong central absorption over width $w$ that strongly decouples the two sides and creates near-degenerate localized modes.\n\nFor each case:\n\n- Compute the dominant and subdominant eigenvalues of the operator $T = A^{-1} F$ by forming $T$ explicitly from the discrete operators and performing an eigenanalysis. The largest eigenvalue is associated with the fundamental mode. Use the magnitude of the second-largest eigenvalue to characterize the subdominant mode.\n- Predict the asymptotic contraction factor for the source iteration using the spectral properties of $T$.\n- Perform source iteration for $q_n$ using the mapping described above and estimate the measured asymptotic contraction factor by the ratio of successive $\\ell^2$-norm errors $\\|q_{n+1} - q_\\star\\|_2 / \\|q_n - q_\\star\\|_2$ averaged over the last $m$ iterations, where $q_\\star$ is the fundamental mode fission source distribution computed from the dominant eigenvector of $T$ and $m$ is a small positive integer chosen to stabilize the estimate.\n\nYour program must produce, for the three cases above, the measured contraction factor and the predicted contraction factor. Express each factor as a decimal number rounded to six digits after the decimal point. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order: $[\\text{measured}_1,\\text{predicted}_1,\\text{measured}_2,\\text{predicted}_2,\\text{measured}_3,\\text{predicted}_3]$.\n\nTest suite details:\n\n- The three cases cover a general scenario ($\\Sigma_r=0$), a moderate barrier, and a strong barrier to induce near-degenerate modes.\n- Use $N=120$, $L=1$, $D=1$, $\\Sigma_{a,0}=0.2$, $\\nu\\Sigma_f=0.6$, initial source $q_0$ uniform and normalized in $\\ell^1$, iteration count $n_{\\max}=80$, and averaging window $m=10$ for computing the measured contraction factor. All numbers are non-dimensional and must be treated purely as mathematical quantities.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$).",
            "solution": "The user-provided problem is assessed as valid and will be solved.\n\n### Step 1: Extract Givens\n- **Problem Type**: One-dimensional, one-speed neutron diffusion $k$-eigenvalue problem.\n- **Domain**: A slab of length $L$ from $x=0$ to $x=L$.\n- **Boundary Conditions**: Zero-current (Neumann) at $x=0$ and $x=L$.\n- **Governing Equation**: $A \\phi = \\frac{1}{k} F \\phi$, where $A$ is the diffusion and absorption operator, $F$ is the fission production operator, and $k$ is the eigenvalue.\n- **Operator Definitions**: $A = -D \\frac{d^2}{dx^2} + \\Sigma_a(x)$, and $F$ represents multiplication by $\\nu\\Sigma_f(x)$.\n- **Source Iteration**: The sequence $\\{q_n(x)\\}$ is generated via $A \\phi_n = q_n$ followed by $q_{n+1}' = F \\phi_n$, where $q_n$ is normalized at each step using the $\\ell^1$ norm. The initial source $q_0$ is a uniform positive vector, normalized.\n- **Numerical Discretization**:\n  - Grid: Uniform with $N$ spatial points.\n  - Spacing: $h = L/(N-1)$.\n  - Method: Second-order central differences for the diffusion operator.\n  - Boundary Conditions: Implemented by \"mirrored ghost points\".\n- **Physical and Numerical Parameters**:\n  - $L = 1$\n  - $N = 120$\n  - $D = 1$ (diffusion coefficient)\n  - $\\Sigma_{a,0} = 0.2$ (baseline absorption cross section)\n  - $\\nu\\Sigma_f(x) = 0.6$ (uniform neutron production cross section)\n  - $n_{\\max} = 80$ (number of source iterations)\n  - $m = 10$ (averaging window for measured contraction factor)\n- **Control Rod Model**:\n  - Location: Centered at $x_c = L/2$.\n  - Absorption: $\\Sigma_a(x) = \\Sigma_{a,0} + \\Sigma_r \\cdot \\chi_{[x_c - w/2,\\,x_c + w/2]}(x)$, where $\\chi$ is the indicator function.\n- **Test Cases** $(\\Sigma_r, w)$:\n  - Case 1: $(0.0, 0.0)$ (Homogeneous)\n  - Case 2: $(2.0, 0.2)$ (Moderate Barrier)\n  - Case 3: $(20.0, 0.3)$ (Strong Barrier)\n- **Quantities to be Computed**:\n  - Predicted asymptotic contraction factor: from the eigenvalues of the iteration operator $T = A^{-1} F$.\n  - Measured asymptotic contraction factor: from the ratio of successive $\\ell^2$-norm errors $\\|q_{n+1} - q_\\star\\|_2 / \\|q_n - q_\\star\\|_2$, averaged over the last $m$ iterations.\n- **Output Format**: A single line containing a comma-separated list: $[\\text{measured}_1,\\text{predicted}_1,\\text{measured}_2,\\text{predicted}_2,\\text{measured}_3,\\text{predicted}_3]$, with each number rounded to six decimal places.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a standard numerical exercise in reactor physics, based on the well-established neutron diffusion equation and the power iteration method for solving eigenvalue problems. The concepts of fundamental mode, dominance ratio, and convergence are central to the field. The model is scientifically sound.\n- **Well-Posed**: The problem is well-posed for a numerical solution. All necessary parameters, boundary conditions, discretization methods, and analysis procedures are explicitly defined. The tasks are unambiguous.\n- **Objective**: The problem is stated in precise, objective, and technical language. It is free of any subjective or non-scientific claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Principle-Based Design and Solution\nThe problem requires an analysis of the convergence of the source iteration method for solving the neutron diffusion $k$-eigenvalue problem. This method is a form of the power iteration algorithm applied to find the largest eigenvalue and corresponding eigenvector of an iteration operator.\n\nThe continuous eigenvalue problem is given by:\n$$\n\\left(-D \\frac{d^2}{dx^2} + \\Sigma_a(x)\\right) \\phi(x) = \\frac{1}{k} \\nu\\Sigma_f(x) \\phi(x)\n$$\nThis can be written as $A\\phi = \\frac{1}{k} F\\phi$. Rearranging this equation yields $A^{-1}F\\phi = k\\phi$. This shows that the multiplication factor $k$ is an eigenvalue of the operator $T = A^{-1}F$, and the neutron flux $\\phi$ is the corresponding eigenfunction. The fundamental mode of the reactor corresponds to the largest positive eigenvalue, $k_{eff} = \\lambda_1$, and its associated non-negative eigenfunction, $\\phi_1(x)$.\n\nThe source iteration method generates a sequence of fission source distributions $q_n(x)$. Starting with an initial guess $q_0(x)$, the iteration proceeds as:\n1. Solve for the neutron flux: $A\\phi_n = q_n \\implies \\phi_n = A^{-1}q_n$.\n2. Compute the next unnormalized fission source: $q_{n+1}' = F\\phi_n = F A^{-1} q_n$.\n3. Normalize the source: $q_{n+1} = \\frac{q_{n+1}'}{\\|q_{n+1}'\\|_1}$.\n\nThis is equivalent to applying the power method to the operator $T' = FA^{-1}$. The eigenvalues of $T'$ are identical to those of $T = A^{-1}F$. The asymptotic rate of convergence of the power iteration method is determined by the dominance ratio, $\\rho = |\\lambda_2| / |\\lambda_1|$, where $\\lambda_1$ and $\\lambda_2$ are the largest and second-largest eigenvalues of the iteration operator in magnitude. This $\\rho$ is the **predicted asymptotic contraction factor**.\n\nTo implement this numerically, we first discretize the operators. A uniform grid with $N=120$ points is established on the domain $[0, L]$, with spacing $h=L/(N-1)$. The operator $A = -D \\frac{d^2}{dx^2} + \\Sigma_a(x)$ is discretized using a second-order central difference for the Laplacian and point-wise evaluation for the absorption term. The zero-current Neumann boundary conditions, $\\phi'(0)=0$ and $\\phi'(L)=0$, are handled using mirrored ghost points, as specified. For a node $i=0$, the ghost point $\\phi_{-1}$ is set to $\\phi_1$. The discretized Laplacian becomes:\n$$\n-D \\frac{d^2\\phi}{dx^2}\\bigg|_{x_0} \\approx -D\\frac{\\phi_1 - 2\\phi_0 + \\phi_{-1}}{h^2} = -D\\frac{2\\phi_1 - 2\\phi_0}{h^2}\n$$\nA similar expression holds for the node $i=N-1$. For interior nodes $i \\in [1, N-2]$, the standard central difference is used:\n$$\n-D \\frac{d^2\\phi}{dx^2}\\bigg|_{x_i} \\approx -D\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2}\n$$\nThese expressions, combined with the diagonal absorption term $\\Sigma_{a,i}\\phi_i$, define the entries of the discrete matrix operator $\\mathbf{A}$. The fission operator $\\mathbf{F}$ becomes a diagonal matrix with entries $\\nu\\Sigma_{f,i}$.\n\nWith the discrete operators $\\mathbf{A}$ and $\\mathbf{F}$, the iteration matrix $\\mathbf{T} = \\mathbf{A}^{-1}\\mathbf{F}$ is formed explicitly. Its eigenvalues are computed numerically. The predicted contraction factor is $\\rho_{pred} = |\\lambda_2|/|\\lambda_1|$. The eigenvector of $\\mathbf{T}$ corresponding to $\\lambda_1$ is the fundamental mode fission source distribution, $q_\\star$. This vector is normalized using the $\\ell^1$ norm for consistency with the iteration.\n\nThe source iteration is then simulated for $n_{max}$ steps. The error at each step, $\\epsilon_n = \\|q_n - q_\\star\\|_2$, is recorded. The **measured asymptotic contraction factor** is estimated by averaging the ratio of successive errors, $\\epsilon_n/\\epsilon_{n-1}$, over the final $m$ iterations of the simulation. This numerical experiment validates the theoretical prediction by comparing the measured and predicted factors.\n\nThe three test cases explore how spatial heterogeneity affects convergence. The homogeneous case (Case 1) is expected to have a small dominance ratio and fast convergence. Introducing a central absorbing rod (Cases 2 and 3) creates two weakly coupled regions. This causes the first two eigenvalues to become nearly degenerate, leading to a dominance ratio close to $1$ and significantly slower convergence, a phenomenon known as spectral poisoning.\n\nThe experiment is implemented as follows:\n1. For each case $(\\Sigma_r, w)$, define the material property vector $\\Sigma_a$.\n2. Construct the matrices $\\mathbf{A}$ and $\\mathbf{F}$.\n3. Calculate $\\mathbf{T} = \\mathbf{A}^{-1}\\mathbf{F}$.\n4. Find the eigenvalues and eigenvectors of $\\mathbf{T}$. Sort them by magnitude to find $\\lambda_1$, $\\lambda_2$, and the fundamental eigenvector $q_\\star$. Normalize $q_\\star$.\n5. Calculate the predicted factor $\\rho_{pred} = |\\lambda_2|/|\\lambda_1|$.\n6. Perform the source iteration for $n_{max}$ steps, calculating and storing the $\\ell^2$ error relative to $q_\\star$ at each step.\n7. Calculate the measured factor $\\rho_{meas}$ by averaging the error ratios over the last $m$ steps.\n8. Collate the results for all three cases into the specified output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not used as per the problem, numpy is sufficient.\n\ndef _calculate_factors_for_case(Sigma_r, w, L, N, D, Sigma_a0, nuSigma_f, n_max, m):\n    \"\"\"\n    Performs the full analysis for a single problem configuration.\n    \n    This function constructs the discrete operators, computes the predicted\n    convergence factor from the eigenspectrum of the iteration matrix,\n    and runs a source iteration simulation to find the measured convergence factor.\n    \"\"\"\n    h = L / (N - 1)\n    x = np.linspace(0, L, N)\n\n    # 1. Construct material properties\n    Sigma_a = np.full(N, Sigma_a0)\n    if w > 0:\n        x_c = L / 2\n        rod_start_x = x_c - w / 2\n        rod_end_x = x_c + w / 2\n        # Apply rod absorption to all grid points within the interval\n        rod_indices = np.where((x >= rod_start_x) & (x <= rod_end_x))\n        Sigma_a[rod_indices] += Sigma_r\n\n    # 2. Construct discrete operators A and F\n    A = np.zeros((N, N))\n    F = nuSigma_f * np.eye(N)\n    \n    # Fill matrix A based on finite difference scheme with mirrored ghost points\n    # Interior points\n    for i in range(1, N - 1):\n        A[i, i-1] = -D / h**2\n        A[i, i]   = 2*D / h**2 + Sigma_a[i]\n        A[i, i+1] = -D / h**2\n        \n    # Boundary points (Neumann BCs)\n    # At x = 0 (i=0)\n    A[0, 0] = 2*D / h**2 + Sigma_a[0]\n    A[0, 1] = -2*D / h**2\n    # At x = L (i=N-1)\n    A[N-1, N-1] = 2*D / h**2 + Sigma_a[N-1]\n    A[N-1, N-2] = -2*D / h**2\n\n    # 3. Compute predicted contraction factor\n    # Form the iteration matrix T = A_inv * F\n    T = np.linalg.inv(A) @ F\n    \n    # Get eigenvalues and eigenvectors\n    eigvals, eigvecs = np.linalg.eig(T)\n    \n    # Sort eigenvalues by magnitude in descending order\n    abs_eigvals = np.abs(eigvals)\n    sorted_indices = np.argsort(abs_eigvals)[::-1]\n    \n    sorted_eigvals = eigvals[sorted_indices]\n    sorted_eigvecs = eigvecs[:, sorted_indices]\n    \n    lambda1 = np.abs(sorted_eigvals[0])\n    lambda2 = np.abs(sorted_eigvals[1])\n    \n    predicted_factor = lambda2 / lambda1\n\n    # 4. Perform source iteration to get measured factor\n    # Get the fundamental mode source distribution q_star\n    q_star = np.real(sorted_eigvecs[:, 0])\n    # Normalize q_star with L1 norm, ensuring it's positive\n    if np.sum(q_star) < 0:\n        q_star = -q_star\n    q_star /= np.sum(q_star)\n\n    # Initialize source iteration\n    q = np.ones(N) / N  # Uniform source normalized in L1\n    errors = []\n    \n    for _ in range(n_max):\n        # Solve A * phi = q\n        phi = np.linalg.solve(A, q)\n        # Compute next source q_next = F * phi\n        q_next = F @ phi\n        # Normalize with L1 norm\n        q_next /= np.sum(q_next)\n        q = q_next\n        \n        # Calculate and store the L2 error norm\n        err = np.linalg.norm(q - q_star, ord=2)\n        errors.append(err)\n        \n    # 5. Calculate measured contraction factor from error ratios\n    # Ratios are err_n / err_{n-1}\n    ratios = [errors[i] / errors[i-1] for i in range(n_max - m, n_max)]\n    measured_factor = np.mean(ratios)\n    \n    return measured_factor, predicted_factor\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment for all test cases.\n    \"\"\"\n    # Define the global parameters from the problem statement.\n    L = 1.0\n    N = 120\n    D = 1.0\n    Sigma_a0 = 0.2\n    nuSigma_f = 0.6\n    n_max = 80\n    m = 10\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.0),  # Case 1: Homogeneous\n        (2.0, 0.2),  # Case 2: Moderate barrier\n        (20.0, 0.3)  # Case 3: Strong barrier\n    ]\n\n    results = []\n    for case in test_cases:\n        Sigma_r, w = case\n        measured, predicted = _calculate_factors_for_case(\n            Sigma_r, w, L, N, D, Sigma_a0, nuSigma_f, n_max, m\n        )\n        results.append(measured)\n        results.append(predicted)\n\n    # Final print statement in the exact required format.\n    # Format each result to six decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}