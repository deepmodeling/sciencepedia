{
    "hands_on_practices": [
        {
            "introduction": "在我们能够数值求解k-本征值问题之前，我们必须首先将中子平衡的物理原理转化为矩阵方程。这个练习  将引导您完成这关键的第一步，使用一个双能群无限介质模型，从基本截面数据构建损失矩阵 $A$ 和裂变产生矩阵 $B$，从而建立广义本征值问题 $A \\phi = \\frac{1}{k} B \\phi$。",
            "id": "4241549",
            "problem": "考虑一个用于核反应堆模拟中稳态中子输运的双能群、均匀无限介质模型。在无限介质中，空间泄漏被忽略，群 $g \\in \\{1,2\\}$ 的多群中子平衡方程将由吸收和移出散射导致的中子损失率与由移入散射和裂变产生（后者按有效增殖因子 $k$ 进行缩放）导致的中子产生率相等。从该平衡方程出发，该系统可以被构造成一个形式为 $A \\phi = \\frac{1}{k} B \\phi$ 的 $k$ 本征值问题，其中 $A$ 是损失算子，$B$ 是裂变产生算子，$\\phi$ 是双能群通量矢量。\n\n使用以下物理上合理的宏观截面（单位为厘米的倒数，写作 $\\text{cm}^{-1}$）、按群的裂变参数和裂变谱：\n- 第1群吸收 $\\,\\Sigma_{a,1} = 0.07\\,\\text{cm}^{-1}$，向下散射 $\\,\\Sigma_{s,1 \\to 2} = 0.21\\,\\text{cm}^{-1}$，以及按群的每次裂变平均中子数乘以裂变截面 $\\,\\nu \\Sigma_{f,1} = 0.042\\,\\text{cm}^{-1}$。\n- 第2群吸收 $\\,\\Sigma_{a,2} = 0.09\\,\\text{cm}^{-1}$，向上散射 $\\,\\Sigma_{s,2 \\to 1} = 0.015\\,\\text{cm}^{-1}$，以及按群的 $\\,\\nu \\Sigma_{f,2} = 0.175\\,\\text{cm}^{-1}$。\n- 裂变谱份额（裂变中子在各群中产生的概率）：$\\,\\chi_1 = 0.92\\,$ 和 $\\,\\chi_2 = 0.08\\,$。\n\n设双能群通量矢量为\n$$\n\\phi = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix} = \\begin{pmatrix} 1.37 \\times 10^{13} \\\\ 2.62 \\times 10^{13} \\end{pmatrix} \\ \\text{cm}^{-2}\\,\\text{s}^{-1}.\n$$\n\n任务：\n1. 从无限介质中的稳态多群平衡方程出发，构建与上述 $k$ 本征值公式一致的 $2 \\times 2$ 损失矩阵 $A$ 和 $2 \\times 2$ 裂变产生矩阵 $B$。\n2. 说明 $A$ 和 $B$ 的维度和稀疏模式。\n3. 计算裂变源矢量 $q = B \\phi$，然后计算标量总裂变源\n$$\nS_f = q_1 + q_2,\n$$\n其中 $q_g$ 是 $q$ 的第 $g$ 个分量。将 $S_f$ 的最终数值以中子数/立方厘米·秒（写作 $\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}$）为单位表示，并将答案四舍五入到五位有效数字。",
            "solution": "用户提供的问题已经过分析，并被确定为**有效**。它在科学上基于核反应堆物理学的原理，问题提法明确，数据充分且一致，陈述客观。这些任务涉及多群中子平衡方程的标准应用。\n\n问题要求执行与双能群、稳态、无限介质中子平衡方程相关的三个任务。我们将按顺序处理每个任务。\n\n首先，我们建立理论框架。在无限介质中，能量群 $g$ 的稳态中子平衡方程将中子损失（吸收和移出散射）与中子增益（移入散射和裂变）相等。\n\n对于一个双能群模型（$g=1$ 代表快中子群，$g=2$ 代表热中子群），平衡方程为：\n\n对于第1群：\n$$\n\\text{Losses}_1 = \\text{Gains}_1\n$$\n$$\n\\Sigma_{a,1}\\phi_1 + \\Sigma_{s,1 \\to 2}\\phi_1 = \\Sigma_{s,2 \\to 1}\\phi_2 + \\frac{1}{k} \\chi_1 \\left( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 \\right)\n$$\n\n对于第2群：\n$$\n\\text{Losses}_2 = \\text{Gains}_2\n$$\n$$\n\\Sigma_{a,2}\\phi_2 + \\Sigma_{s,2 \\to 1}\\phi_2 = \\Sigma_{s,1 \\to 2}\\phi_1 + \\frac{1}{k} \\chi_2 \\left( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 \\right)\n$$\n\n此处，$\\phi_g$ 是第 $g$ 群的中子通量，$\\Sigma_{a,g}$ 是宏观吸收截面，$\\Sigma_{s,g \\to g'}$ 是从 $g$ 群到 $g'$ 群的宏观散射截面，$\\nu\\Sigma_{f,g}$ 是每次裂变产生的平均中子数乘以宏观裂变截面，$\\chi_g$ 是在第 $g$ 群中产生的裂变中子的份额，$k$ 是有效增殖因子。\n\n问题要求将此系统转换成 $A \\phi = \\frac{1}{k} B \\phi$ 的形式。为此，我们将所有非裂变项归到方程左侧，将所有与裂变相关的产生项归到右侧。\n\n整理方程：\n$$\n(\\Sigma_{a,1} + \\Sigma_{s,1 \\to 2})\\phi_1 - \\Sigma_{s,2 \\to 1}\\phi_2 = \\frac{1}{k} \\left[ \\chi_1 ( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 ) \\right]\n$$\n$$\n-\\Sigma_{s,1 \\to 2}\\phi_1 + (\\Sigma_{a,2} + \\Sigma_{s,2 \\to 1})\\phi_2 = \\frac{1}{k} \\left[ \\chi_2 ( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 ) \\right]\n$$\n\n该系统可以写成矩阵形式：\n$$\n\\begin{pmatrix} \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}  -\\Sigma_{s,2 \\to 1} \\\\ -\\Sigma_{s,1 \\to 2}  \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} \\end{pmatrix} \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix} = \\frac{1}{k} \\begin{pmatrix} \\chi_1 \\nu\\Sigma_{f,1}  \\chi_1 \\nu\\Sigma_{f,2} \\\\ \\chi_2 \\nu\\Sigma_{f,1}  \\chi_2 \\nu\\Sigma_{f,2} \\end{pmatrix} \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix}\n$$\n\n**任务1：构建损失矩阵 $A$ 和裂变产生矩阵 $B$。**\n\n从上面的矩阵方程中，我们可以识别出损失算子 $A$（更准确地说是净损失和散射算子）和裂变产生算子 $B$。\n\n损失矩阵 $A$ 是：\n$$\nA = \\begin{pmatrix} \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}  -\\Sigma_{s,2 \\to 1} \\\\ -\\Sigma_{s,1 \\to 2}  \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} \\end{pmatrix}\n$$\n裂变产生矩阵 $B$ 是：\n$$\nB = \\begin{pmatrix} \\chi_1 \\nu\\Sigma_{f,1}  \\chi_1 \\nu\\Sigma_{f,2} \\\\ \\chi_2 \\nu\\Sigma_{f,1}  \\chi_2 \\nu\\Sigma_{f,2} \\end{pmatrix}\n$$\n这也可以表示为裂变谱矢量 $\\chi_g$ 和产生矢量 $\\nu\\Sigma_{f,g}$ 的外积，即 $B = \\chi (\\nu\\Sigma_f)^T$。\n\n现在，我们代入给定的数值：\n$\\Sigma_{a,1} = 0.07\\,\\text{cm}^{-1}$, $\\Sigma_{s,1 \\to 2} = 0.21\\,\\text{cm}^{-1}$, $\\nu \\Sigma_{f,1} = 0.042\\,\\text{cm}^{-1}$.\n$\\Sigma_{a,2} = 0.09\\,\\text{cm}^{-1}$, $\\Sigma_{s,2 \\to 1} = 0.015\\,\\text{cm}^{-1}$, $\\nu \\Sigma_{f,2} = 0.175\\,\\text{cm}^{-1}$.\n$\\chi_1 = 0.92$, $\\chi_2 = 0.08$.\n\n对于矩阵 $A$：\n$A_{11} = \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2} = 0.07 + 0.21 = 0.28\\,\\text{cm}^{-1}$\n$A_{12} = -\\Sigma_{s,2 \\to 1} = -0.015\\,\\text{cm}^{-1}$\n$A_{21} = -\\Sigma_{s,1 \\to 2} = -0.21\\,\\text{cm}^{-1}$\n$A_{22} = \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} = 0.09 + 0.015 = 0.105\\,\\text{cm}^{-1}$\n$$\nA = \\begin{pmatrix} 0.28  -0.015 \\\\ -0.21  0.105 \\end{pmatrix}\\,\\text{cm}^{-1}\n$$\n\n对于矩阵 $B$：\n$B_{11} = \\chi_1 \\nu\\Sigma_{f,1} = 0.92 \\times 0.042 = 0.03864\\,\\text{cm}^{-1}$\n$B_{12} = \\chi_1 \\nu\\Sigma_{f,2} = 0.92 \\times 0.175 = 0.161\\,\\text{cm}^{-1}$\n$B_{21} = \\chi_2 \\nu\\Sigma_{f,1} = 0.08 \\times 0.042 = 0.00336\\,\\text{cm}^{-1}$\n$B_{22} = \\chi_2 \\nu\\Sigma_{f,2} = 0.08 \\times 0.175 = 0.014\\,\\text{cm}^{-1}$\n$$\nB = \\begin{pmatrix} 0.03864  0.161 \\\\ 0.00336  0.014 \\end{pmatrix}\\,\\text{cm}^{-1}\n$$\n\n**任务2：说明 $A$ 和 $B$ 的维度和稀疏模式。**\n\n矩阵 $A$ 和矩阵 $B$ 的维度均为 $2 \\times 2$，对应于两个能量群。\n关于稀疏性，如果一个矩阵的许多元素为零，则该矩阵是稀疏的。在这种情况下，$A$ 和 $B$ 的所有元素都是非零的。因此，矩阵 $A$ 和 $B$ 都是稠密矩阵。\n\n**任务3：计算裂变源矢量 $q = B\\phi$ 和标量总裂变源 $S_f = q_1 + q_2$。**\n\n裂变源矢量 $q$ 代表每个能量群中单位体积内裂变中子的产生率。它通过 $q = B\\phi$ 计算得出。总裂变源 $S_f$ 是 $q$ 的各分量之和。\n给定通量矢量：\n$$\n\\phi = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix} = \\begin{pmatrix} 1.37 \\times 10^{13} \\\\ 2.62 \\times 10^{13} \\end{pmatrix} \\ \\text{cm}^{-2}\\,\\text{s}^{-1}\n$$\n总裂变源 $S_f$ 是单位时间单位体积内由裂变产生的总中子数。这由各群的裂变率乘以每次裂变的中子数再对所有群求和得到。\n$$\nS_f = \\sum_{g=1}^{2} \\nu\\Sigma_{f,g} \\phi_g = \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2\n$$\n注意到 $S_f = q_1 + q_2 = (\\chi_1 + \\chi_2)(\\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2)$。由于裂变谱份额之和必须为1，即 $\\chi_1 + \\chi_2 = 0.92 + 0.08 = 1$，我们得到 $S_f = q_1 + q_2$。\n我们直接计算 $S_f$：\n$$\nS_f = (0.042\\,\\text{cm}^{-1}) \\times (1.37 \\times 10^{13}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}) + (0.175\\,\\text{cm}^{-1}) \\times (2.62 \\times 10^{13}\\,\\text{cm}^{-2}\\,\\text{s}^{-1})\n$$\n$$\nS_f = (0.05754 \\times 10^{13}) + (0.4585 \\times 10^{13}) \\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\n$$\n$$\nS_f = 0.51604 \\times 10^{13} \\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\n$$\n$$\nS_f = 5.1604 \\times 10^{12} \\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\n$$\n问题要求最终答案四舍五入到五位有效数字。计算出的值 $5.1604 \\times 10^{12}$ 已经有五位有效数字。",
            "answer": "$$\n\\boxed{5.1604 \\times 10^{12}}\n$$"
        },
        {
            "introduction": "建立了矩阵方程之后，我们现在关注功率迭代法的核心引擎：单次迭代步骤。本练习  提供了一个离散化的一维扩散问题，要求您执行一次完整的迭代。这包括求解一个固定源线性系统，然后利用结果更新本征值 $k$，从而揭示了该算法核心的“求解-更新”两阶段过程。",
            "id": "4241508",
            "problem": "考虑一维（1D）情况下的稳态、单群中子扩散$k$-特征值问题，\n$$- \\frac{d}{dx}\\left(D(x)\\frac{d \\phi(x)}{dx}\\right) + \\Sigma_{a}(x)\\,\\phi(x) \\;=\\; \\frac{1}{k}\\,\\nu \\Sigma_{f}(x)\\,\\phi(x),$$\n其中 $D(x)$ 是扩散系数，$\\Sigma_{a}(x)$ 是吸收宏观截面，$\\nu\\Sigma_{f}(x)$ 是中子产生宏观截面，$\\phi(x)$ 是中子通量，$k$ 是有效增殖因子。在等宽度的三单元网格上，采用具有反射边界条件的均匀网格有限差分方法离散化后，空间算子和裂变产生算子可组合成矩阵\n$$A \\;=\\; \\begin{pmatrix}\n1.1  -1  0 \\\\\n-1  2.1  -1 \\\\\n0  -1  1.1\n\\end{pmatrix}, \\qquad\nB \\;=\\; \\mathrm{diag}\\!\\big(0.1,\\;0.125,\\;0.1\\big).$$\n设当前迭代的通量向量为\n$$\\phi^{(m)} \\;=\\; \\begin{pmatrix} 4 \\\\ 4 \\\\ 1 \\end{pmatrix},$$\n该向量已使用由 $B$ 导出的权重归一化为单位总裂变源。定义裂变源归一化泛函 $S(\\psi)$ 为\n$$S(\\psi) \\;=\\; \\sum_{i=1}^{3} \\big[B\\big]_{ii}\\,\\psi_i \\;=\\; 0.1\\,\\psi_1 + 0.125\\,\\psi_2 + 0.1\\,\\psi_3.$$\n执行一步幂迭代（PI），通过求解线性系统\n$$A\\,x \\;=\\; B\\,\\phi^{(m)},$$\n形成更新后的通量\n$$\\phi^{(m+1)} \\;=\\; \\frac{x}{S(x)}$$\n使得 $S\\!\\big(\\phi^{(m+1)}\\big) = 1$，并使用基于裂变的估计量估计更新后的增殖因子 $k^{(m+1)}$。将最终的 $k^{(m+1)}$ 表示为无量纲实数，并将您的答案四舍五入到六位有效数字。",
            "solution": "单群中子扩散 $k$-特征值问题可以写成算子形式\n$$A\\,\\phi \\;=\\; \\frac{1}{k}\\,B\\,\\phi,$$\n其中 $A$ 代表泄漏和吸收，$B$ 代表裂变产生。整理可得\n$$A^{-1} B\\,\\phi \\;=\\; k\\,\\phi,$$\n因此 $A^{-1} B$ 的主特征值是 $k$。幂迭代（PI）步骤构造\n$$y \\;=\\; A^{-1} B\\,\\phi^{(m)}$$\n通过求解 $A\\,x = B\\,\\phi^{(m)}$ 并令 $x = y$。如果通量通过裂变源泛函 $S(\\cdot)$ 归一化，使得 $S\\!\\big(\\phi^{(m)}\\big)=1$，那么对于精确的特征对，有 $y = k\\,\\phi$ 成立，因此\n$$S(y) \\;=\\; S(k\\,\\phi) \\;=\\; k\\,S(\\phi) \\;=\\; k.$$\n因此，在裂变源归一化下，更新后的增殖因子的基于裂变的估计量为\n$$k^{(m+1)} \\;=\\; S(x),$$\n并且更新后的通量通过 $\\phi^{(m+1)} = x/S(x)$ 进行缩放以维持 $S\\!\\big(\\phi^{(m+1)}\\big) = 1$。\n\n我们现在使用给定的数据进行计算。首先计算右侧项 $r = B\\,\\phi^{(m)}$：\n$$r \\;=\\; \\begin{pmatrix}\n0.1  0  0 \\\\\n0  0.125  0 \\\\\n0  0  0.1\n\\end{pmatrix}\n\\begin{pmatrix} 4 \\\\ 4 \\\\ 1 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} 0.4 \\\\ 0.5 \\\\ 0.1 \\end{pmatrix}.$$\n求解线性系统 $A\\,x = r$，其中\n$$A \\;=\\; \\begin{pmatrix}\n1.1  -1  0 \\\\\n-1  2.1  -1 \\\\\n0  -1  1.1\n\\end{pmatrix}, \\qquad r \\;=\\; \\begin{pmatrix} 0.4 \\\\ 0.5 \\\\ 0.1 \\end{pmatrix}.$$\n将方程按分量写出：\n\\begin{align*}\n1.1\\,x_1 - x_2 = 0.4, \\\\\n-\\,x_1 + 2.1\\,x_2 - x_3 = 0.5, \\\\\n-\\,x_2 + 1.1\\,x_3 = 0.1.\n\\end{align*}\n根据第一个方程，用 $x_1$ 表示 $x_2$：\n$$x_2 \\;=\\; 1.1\\,x_1 - 0.4.$$\n根据第三个方程，用 $x_2$ 表示 $x_3$：\n$$1.1\\,x_3 \\;=\\; 0.1 + x_2 \\;\\;\\Rightarrow\\;\\; x_3 \\;=\\; \\frac{0.1 + x_2}{1.1}.$$\n将这些代入第二个方程：\n\\begin{align*}\n-\\,x_1 + 2.1\\,(1.1\\,x_1 - 0.4) - \\frac{1.1\\,x_1 - 0.4 + 0.1}{1.1} = 0.5, \\\\\n-\\,x_1 + 2.31\\,x_1 - 0.84 - \\frac{1.1\\,x_1 - 0.3}{1.1} = 0.5, \\\\\n1.31\\,x_1 - 0.84 - (x_1 - \\frac{0.3}{1.1}) = 0.5, \\\\\n0.31\\,x_1 - 0.84 + \\frac{3}{11} = 0.5, \\\\\n0.31\\,x_1 = 1.34 - \\frac{3}{11} = \\frac{14.74 - 3}{11} = \\frac{11.74}{11}, \\\\\nx_1 = \\frac{11.74}{11 \\times 0.31} = \\frac{11.74}{3.41} = \\frac{1174}{341}.\n\\end{align*}\n然后\n\\begin{align*}\nx_2 = 1.1 \\times \\frac{1174}{341} - 0.4 = \\frac{11}{10} \\times \\frac{1174}{341} - \\frac{4}{10} = \\frac{12914 - 1364}{3410} = \\frac{11550}{3410} = \\frac{1155}{341}, \\\\\nx_3 = \\frac{x_2 + 0.1}{1.1} = \\frac{\\frac{1155}{341} + \\frac{1}{10}}{\\frac{11}{10}} = \\frac{11550 + 341}{3410} \\times \\frac{10}{11} = \\frac{11891}{3751} = \\frac{1081}{341}.\n\\end{align*}\n因此，\n$$x \\;=\\; \\begin{pmatrix} \\frac{1174}{341} \\\\ \\frac{1155}{341} \\\\ \\frac{1081}{341} \\end{pmatrix}.$$\n使用 $B$ 的对角线元素计算裂变源泛函 $S(x)$：\n\\begin{align*}\nS(x) =\\; 0.1\\,x_1 + 0.125\\,x_2 + 0.1\\,x_3 \\\\\n=\\; \\frac{1}{10}\\cdot\\frac{1174}{341} \\;+\\; \\frac{1}{8}\\cdot\\frac{1155}{341} \\;+\\; \\frac{1}{10}\\cdot\\frac{1081}{341} \\\\\n=\\; \\frac{1}{341} \\left( \\frac{1174}{10} + \\frac{1155}{8} + \\frac{1081}{10} \\right) \\\\\n=\\; \\frac{1}{341} \\left( \\frac{2255}{10} + \\frac{1155}{8} \\right) \\\\\n=\\; \\frac{1}{341} \\left( \\frac{9020 + 5775}{40} \\right) \\\\\n=\\; \\frac{14795}{13640} = \\frac{2959}{2728}.\n\\end{align*}\n因此，基于裂变的估计量给出\n$$k^{(m+1)} \\;=\\; S(x) \\;=\\; \\frac{2959}{2728} \\;\\approx\\; 1.084677419\\ldots.$$\n四舍五入到六位有效数字可得\n$$k^{(m+1)} \\;\\approx\\; 1.08468.$$",
            "answer": "$$\\boxed{1.08468}$$"
        },
        {
            "introduction": "成功执行迭代只是成功的一半；知道何时停止是一个在实践中至关重要的、更为微妙的挑战。最后一个练习  探讨了“伪收敛”这一重要现象，即本征值 $k$ 看起来已经稳定，而通量形状仍在缓慢演变。通过评估各种诊断指标，本练习强调了同时监测本征向量（通量）和本征值以确保获得真正收敛解的必要性。",
            "id": "4241546",
            "problem": "在临界反应堆堆芯的中子输运计算中，$k$-本征值问题被描述为 $\\mathcal{L}\\,\\phi = \\dfrac{1}{k}\\,\\mathcal{F}\\,\\phi$，其中 $\\mathcal{L}$ 是流-碰撞算符，$\\mathcal{F}$ 是裂变产生算符，$\\phi$ 是中子通量，$k$ 是有效中子增殖因子。一种常见的求解器是幂迭代法，它通过重复求解一个固定源问题来构建序列 $\\{\\phi^{(n)},k^{(n)}\\}$，其中的裂变源由前一次迭代值导出并进行重归一化。在实践中，通常仅通过监测 $k^{(n)}$ 的稳定情况来评估收敛性。\n\n考虑一个带有反射边界条件和多群输运的三维压水堆（PWR）堆芯模拟。观测到的 $k^{(n)}$ 在大约 $50$ 次迭代后稳定在 $\\pm 10^{-5}$ 的范围内。然而，其底层线性化裂变算符的谱隙很小，优势比（定义为幂迭代算符的第二大本征值的模与最大本征值的模之比）接近 $0.98$。假设算符和离散化产生了一个具有单一主本征对的适定 $k$-本征值问题，并且幂迭代法使用对 $\\phi^{(n)}$ 的标准归一化来保持总裂变源有界。你需要分析在仅监测 $k^{(n)}$ 的情况下可能出现的假收敛，并推荐额外的诊断方法来检测停滞的通量形状演化。\n\n在监测 $k^{(n)}$ 的基础上，下列哪些诊断方法在理论上是合理且适合用于检测通量形状的停滞或缓慢演化，从而避免假收敛的？（选择所有适用项）\n\nA. 监测非线性残差 $r^{(n)} = \\mathcal{L}\\,\\phi^{(n)} - \\dfrac{1}{k^{(n)}}\\,\\mathcal{F}\\,\\phi^{(n)}$ 的范数，并且仅当 $\\|r^{(n)}\\|$ 在一个物理相关的范数下低于预设容差时才宣布收敛。\n\nB. 使用基于内积的余弦度量（例如 $1 - \\dfrac{|\\langle \\phi^{(n)}, \\phi^{(n-1)} \\rangle|}{\\|\\phi^{(n)}\\|\\,\\|\\phi^{(n-1)}\\|}$）来比较连续的归一化通量形状，并要求该值足够小。\n\nC. 完全依赖增殖因子 $k^{(n)}$ 在一个严格容差内的稳定，因为 $k^{(n)}$ 必然只在通量形状收敛后才会稳定。\n\nD. 估计优势比和次主模的污染幅度（例如，通过 $\\phi^{(n)}$ 中连续差分之比），并在宣布收敛前要求估计的污染低于一个阈值。\n\nE. 仅监测反应堆总功率 $P^{(n)} = \\int \\nu\\,\\Sigma_f(\\mathbf{r},E)\\,\\phi^{(n)}(\\mathbf{r},E)\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}E$，因为 $P^{(n)}$ 与 $k^{(n)}$ 成正比，足以指示收敛。\n\nF. 使用来自 Anderson 加速或其他外推方案的系数作为收敛的主要指标；小的系数意味着通量形状已经收敛。",
            "solution": "问题陈述描述了在求解反应堆临界中子输运方程的数值解时的一个常见挑战，特别是在使用幂迭代法时出现的“假收敛”现象。问题的核心在于本征值（$k_{\\text{eff}}$）和相应本征函数（中子通量形状，$\\phi$）收敛速率之间的差异。我们将首先验证问题陈述，然后对所提出的收敛诊断方法进行详细分析。\n\n### 问题验证\n\n- **第1步：提取已知条件**\n    - 控制方程是 $k$-本征值问题：$\\mathcal{L}\\,\\phi = \\dfrac{1}{k}\\,\\mathcal{F}\\,\\phi$。\n    - $\\mathcal{L}$ 是流-碰撞算符。\n    - $\\mathcal{F}$ 是裂变产生算符。\n    - $\\phi$ 是中子通量本征函数。\n    - $k$ 是有效中子增殖因子本征值。\n    - 数值方法是幂迭代法，生成序列 $\\{\\phi^{(n)}, k^{(n)}\\}$。\n    - 物理系统是一个带有反射边界条件和多群输运的三维压水堆（PWR）堆芯。\n    - 观测：$k^{(n)}$ 在大约 $50$ 次迭代后稳定在 $\\pm 10^{-5}$ 的范围内。\n    - 谱特性：优势比接近 $0.98$。\n    - 假设：问题是适定的，具有单一的主本征对。\n    - 假设：使用标准归一化来保持总裂变源有界。\n    - 任务是，在监测 $k^{(n)}$ 的基础上，找出适合且理论上合理的诊断方法，以检测通量形状的停滞或缓慢演化。\n\n- **第2步：使用提取的已知条件进行验证**\n    - **科学依据：** 该问题牢固地植根于标准的核反应堆理论和数值分析。k-本征值方程、幂迭代法和优势比的概念是该领域的基础。所述的 $0.98$ 的优势比对于大型、松耦合反应堆是一个实际的数值，并正确地指出了数值困难的来源。\n    - **适定性：** 问题明确假设这是一个具有单一主本征对的适定k-本征值问题，这对此类分析是标准的。问题本身也是适定的，要求评估诊断技术。\n    - **客观性：** 语言技术性强、精确，且无主观内容。\n\n- **第3步：结论与行动**\n    问题陈述在科学上是合理的、适定的和客观的。它在真实的科学背景下提出了一个经典且非平凡的数值分析挑战。该问题是 **有效的**。我们继续进行求解。\n\n### 理论基础：幂迭代法的收敛性\n\n对于本征值问题 $M\\phi = k\\phi$，其中迭代算符为 $M = \\mathcal{L}^{-1}\\mathcal{F}$，幂迭代法生成一个通量迭代序列。一个任意的初始通量猜测值 $\\phi^{(0)}$ 可以在算符 $M$ 的真实本征函数 $\\phi_i$ 的基上展开：\n$$ \\phi^{(0)} = \\sum_{i=1}^{\\infty} c_i \\phi_i $$\n经过 $n$ 次迭代后，未归一化的通量 $\\tilde{\\phi}^{(n)}$ 由下式给出：\n$$ \\tilde{\\phi}^{(n)} = M^n \\phi^{(0)} = \\sum_{i=1}^{\\infty} c_i M^n \\phi_i = \\sum_{i=1}^{\\infty} c_i k_i^n \\phi_i $$\n其中 $k_i$ 是 $M$ 的本征值，按 $k_1 > |k_2| \\geq |k_3| \\geq \\dots$ 排序。提出主本征值项 $k_1^n$：\n$$ \\tilde{\\phi}^{(n)} = k_1^n \\left( c_1 \\phi_1 + c_2 \\left(\\frac{k_2}{k_1}\\right)^n \\phi_2 + \\sum_{i=3}^{\\infty} c_i \\left(\\frac{k_i}{k_1}\\right)^n \\phi_i \\right) $$\n归一化的通量迭代值是 $\\phi^{(n)}$。通量形状的误差，即与基波模 $\\phi_1$ 的偏差，主要由第二模 $\\phi_2$ 的贡献决定。此误差的大小与 $(\\frac{k_2}{k_1})^n$ 项成正比。优势比定义为 $\\rho = |k_2|/k_1$。给定值为 $\\rho \\approx 0.98$。\n因此，本征向量（通量形状）的误差收敛速度为：\n$$ \\|\\phi^{(n)} - \\phi_1\\| \\sim \\mathcal{O}(\\rho^n) = \\mathcal{O}(0.98^n) $$\n本征值估计值 $k^{(n)}$ 是一个全局量，通常使用类似于瑞利商的方法计算。对于像 $M$ 这样的非自伴算符，这类估计通常表现出比本征向量收敛快得多的收敛速度。理论上，本征值的误差收敛速度为：\n$$ |k^{(n)} - k_1| \\sim \\mathcal{O}(\\rho^{2n}) = \\mathcal{O}(0.98^{2n}) $$\n当 $\\rho = 0.98$ 时，通量形状误差衰减得非常慢。经过 $n=50$ 次迭代后，误差估计为其初始值的 $(0.98)^{50} \\approx 0.364$ 倍。相比之下，本征值误差已经衰减了 $(0.98)^{100} \\approx 0.133$ 倍。每次迭代 $k^{(n)}$ 的变化量 $|\\Delta k^{(n)}|$ 会更小，从而给人以收敛的假象。任务是找到能够追踪通量形状的缓慢 $\\mathcal{O}(\\rho^n)$ 收敛的诊断方法。\n\n### 逐项分析\n\n**A. 监测非线性残差 $r^{(n)} = \\mathcal{L}\\,\\phi^{(n)} - \\dfrac{1}{k^{(n)}}\\,\\mathcal{F}\\,\\phi^{(n)}$ 的范数，并且仅当 $\\|r^{(n)}\\|$ 在一个物理相关的范数下低于预设容差时才宣布收敛。**\n残差 $r^{(n)}$ 衡量了当前迭代对 $(\\phi^{(n)}, k^{(n)})$ 满足底层本征值方程的程度。一个真实的本征对 $(\\phi_1, k_1)$ 会产生零残差。在迭代过程中，我们可以使用更新步骤来表示残差，其形式通常为 $\\mathcal{L}\\phi^{(n)} = \\frac{1}{k_{src}} \\mathcal{F}\\phi^{(n-1)}$（其中 $k_{src}$ 可能为 $k^{(n-1)}$）。\n$$ r^{(n)} = \\frac{1}{k_{src}} \\mathcal{F}\\phi^{(n-1)} - \\frac{1}{k^{(n)}} \\mathcal{F}\\phi^{(n)} $$\n这个表达式表明，残差是连续裂变源（$\\mathcal{F}\\phi$）之间差异的函数。当迭代收敛时，$\\phi^{(n)} \\rightarrow \\phi^{(n-1)}$ 且 $k^{(n)} \\rightarrow k^{(n-1)}$。$\\|r^{(n)}\\|$ 趋于零的速率由 $\\phi^{(n)}$ 收敛到 $\\phi_1$ 的速率决定，即 $\\mathcal{O}(\\rho^n)$。因此，监测该残差的范数是追踪通量形状收敛的一种直接且理论上合理的方法。\n**结论：正确**\n\n**B. 使用基于内积的余弦度量（例如 $1 - \\dfrac{|\\langle \\phi^{(n)}, \\phi^{(n-1)} \\rangle|}{\\|\\phi^{(n)}\\|\\,\\|\\phi^{(n-1)}\\|}$）来比较连续的归一化通量形状，并要求该值足够小。**\n该度量衡量了两次连续迭代的通量向量之间的夹角。如果通量形状不再改变，向量将是平行的，该度量将为零。连续迭代值之间的变化 $\\phi^{(n)} - \\phi^{(n-1)}$ 由下式给出：\n$$ \\phi^{(n)} - \\phi^{(n-1)} \\approx C \\left( \\rho^n - \\rho^{n-1} \\right) \\phi_2 = C \\rho^{n-1}(\\rho - 1) \\phi_2 $$\n对于某个归一化常数 $C$。这个差的范数 $\\|\\phi^{(n)} - \\phi^{(n-1)}\\|$ 以 $\\mathcal{O}(\\rho^n)$ 的速率减小。所提出的余弦度量与此范数直接相关（对于小角度， $1-\\cos\\theta \\approx \\theta^2/2$，而 $\\theta$ 与 $\\|\\phi^{(n)} - \\phi^{(n-1)}\\|$ 相关）。因此，该度量收敛到零的速度由通量形状的缓慢收敛速率决定。这是对通量形状本身“停滞或缓慢演化”的直接度量。\n**结论：正确**\n\n**C. 完全依赖增殖因子 $k^{(n)}$ 在一个严格容差内的稳定，因为 $k^{(n)}$ 必然只在通量形状收敛后才会稳定。**\n这种说法存在根本性缺陷，恰恰代表了本问题旨在解决的误解。如理论基础部分所述，本征值的误差 $|k^{(n)} - k_1|$ 以 $\\mathcal{O}(\\rho^{2n})$ 的速率收敛，而本征函数的误差 $\\|\\phi^{(n)} - \\phi_1\\|$ 以 $\\mathcal{O}(\\rho^n)$ 的速率收敛。由于 $\\rho  1$，本征值总是比本征函数收敛得更快（对于 $\\rho=0.98$，在指数项上快两倍）。因此，$k^{(n)}$ 可能并且将会在通量形状收敛到所需容差之前很久就表现出稳定。该选项的前提在事实上是不正确的。\n**结论：不正确**\n\n**D. 估计优势比和次主模的污染幅度（例如，通过 $\\phi^{(n)}$ 中连续差分之比），并在宣布收敛前要求估计的污染低于一个阈值。**\n这描述了一种先进且强大的诊断技术。通过分析迭代序列，可以估计控制收敛的关键参数。通量向量连续差分范数之比提供了对优势比的估计：\n$$ \\frac{\\|\\phi^{(n)} - \\phi^{(n-1)}\\|}{\\|\\phi^{(n-1)} - \\phi^{(n-2)}\\|} \\approx \\frac{\\|\\rho^{n-1}(\\rho - 1) c_2 \\phi_2\\|}{\\|\\rho^{n-2}(\\rho - 1) c_2 \\phi_2\\|} = \\rho $$\n一旦 $\\rho$ 已知或被估计出来，就可以估计当前迭代值的误差大小。误差为 $e^{(n-1)} = \\phi^{(n-1)} - \\phi_1 \\approx c_2 \\rho^{n-1}\\phi_2$。差值为 $\\delta^{(n)} = \\phi^{(n)} - \\phi^{(n-1)} \\approx e^{(n-1)}(\\rho-1)$。因此，误差范数的估计值为 $\\|e^{(n-1)}\\| \\approx \\frac{\\|\\delta^{(n)}\\|}{|1-\\rho|}$。要求这个估计误差低于一个阈值，是对通量本征函数实际收敛情况的直接、定量的评估。该方法在理论上是严谨的。\n**结论：正确**\n\n**E. 仅监测反应堆总功率 $P^{(n)} = \\int \\nu\\,\\Sigma_f(\\mathbf{r},E)\\,\\phi^{(n)}(\\mathbf{r},E)\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}E$，因为 $P^{(n)}$ 与 $k^{(n)}$ 成正比，足以指示收敛。**\n这个选项的理由中存在一个关键缺陷。在幂迭代法中，通量 $\\phi^{(n)}$ 的绝对大小是无关紧要的，并且在每次迭代时都通过归一化条件（例如，归一化总裂变源）进行重置。本征值 $k$ 关联了中子产生率与损失率，并且在临界反应堆中与绝对功率水平无关。功率 $P^{(n)}$ 是通量 $\\phi^{(n)}$ 的一个积分性质。虽然通量的归一化是任意的，但一个一致的归一化方案将导致一个特定的 $P^{(n)}$ 值。$P^{(n)}$ 的误差将是 $\\phi^{(n)}$ 误差的线性泛函，因此将以同样缓慢的速率 $\\mathcal{O}(\\rho^n)$ 收敛。所以，监测 $P^{(n)}$ 确实会比监测 $k^{(n)}$ 更能指示通量收敛。然而，其给出的理由“因为 $P^{(n)}$ 与 $k^{(n)}$ 成正比”是根本错误的。在模拟中，$k^{(n)}$ 趋近于一个常数（$k_1$），而计算出的功率 $P^{(n)}$ 取决于为 $\\phi^{(n)}$ 选择的任意归一化方式。它们之间没有普遍的比例关系。考虑到科学正确性的严格标准，一个理由错误的选项是不可接受的。\n**结论：不正确**\n\n**F. 使用来自 Anderson 加速或其他外推方案的系数作为收敛的主要指标；小的系数意味着通量形状已经收敛。**\n这个选项误解了像 Anderson 加速这样的外推方案中系数的作用。Anderson 加速（或混合）结合了迭代值和残差的历史记录来构造一个更好的下一个迭代值。它通过求解一个小型最小二乘问题来找到最优的混合系数 $\\alpha_i$。其目标是最小化新残差的范数。在这种方案中，收敛的指标是这个最小化残差的范数，而不是系数 $\\alpha_i$ 本身的值。最优系数取决于整个近期的迭代历史，并且与解的接近程度没有简单、直接的关系。一个小的残差范数表示收敛；这些系数仅仅是用于实现那个小残差的权重，并不是一个可靠的主要诊断指标。\n**结论：不正确**",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}