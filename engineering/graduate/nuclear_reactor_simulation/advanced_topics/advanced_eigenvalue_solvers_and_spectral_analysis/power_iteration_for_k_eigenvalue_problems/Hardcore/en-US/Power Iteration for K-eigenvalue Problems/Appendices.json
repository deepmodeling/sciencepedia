{
    "hands_on_practices": [
        {
            "introduction": "Before we can solve the k-eigenvalue problem numerically, we must first translate the underlying physics into the language of linear algebra. This practice involves formulating the multigroup neutron balance equations for a simple, homogeneous system and assembling the corresponding loss and fission production matrices. By constructing these matrices from physical cross-section data, you will gain a concrete understanding of how the abstract operators in the equation $A \\phi = \\frac{1}{k} B \\phi$ directly represent physical processes like absorption, scattering, and fission, bridging the gap between reactor physics theory and its numerical representation .",
            "id": "4241549",
            "problem": "Consider a two-energy-group, homogeneous infinite-medium model for steady-state neutron transport in a nuclear reactor simulation. In an infinite medium, spatial leakage is neglected, and the multigroup neutron balance for group $g \\in \\{1,2\\}$ equates the rate of neutron loss due to absorption and out-scattering to the rate of gain due to in-scattering and fission production, with the latter scaled by the effective multiplication factor $k$. Starting from this balance, the system can be cast into a $k$-eigenvalue problem of the form $A \\phi = \\frac{1}{k} B \\phi$, where $A$ is the loss operator and $B$ is the fission production operator, and $\\phi$ is the two-group flux vector.\n\nUse the following physically plausible macroscopic cross-sections (units are centimeters inverse, written $\\text{cm}^{-1}$), group-wise fission parameters, and fission spectrum:\n- Group $1$ absorption $\\,\\Sigma_{a,1} = 0.07\\,\\text{cm}^{-1}$, down-scatter $\\,\\Sigma_{s,1 \\to 2} = 0.21\\,\\text{cm}^{-1}$, and group-wise average neutrons per fission times fission cross-section $\\,\\nu \\Sigma_{f,1} = 0.042\\,\\text{cm}^{-1}$.\n- Group $2$ absorption $\\,\\Sigma_{a,2} = 0.09\\,\\text{cm}^{-1}$, up-scatter $\\,\\Sigma_{s,2 \\to 1} = 0.015\\,\\text{cm}^{-1}$, and group-wise $\\,\\nu \\Sigma_{f,2} = 0.175\\,\\text{cm}^{-1}$.\n- Fission spectrum fractions (probability a fission neutron is born in each group): $\\,\\chi_1 = 0.92\\,$ and $\\,\\chi_2 = 0.08\\,$.\n\nLet the two-group flux vector be\n$$\n\\phi = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix} = \\begin{pmatrix} 1.37 \\times 10^{13} \\\\ 2.62 \\times 10^{13} \\end{pmatrix} \\ \\text{cm}^{-2}\\,\\text{s}^{-1}.\n$$\n\nTasks:\n1. Starting from the steady-state multigroup balance in an infinite medium, assemble the $2 \\times 2$ loss matrix $A$ and the $2 \\times 2$ fission production matrix $B$ consistent with the $k$-eigenvalue formulation described above.\n2. State the dimensions and sparsity patterns of $A$ and $B$.\n3. Compute the fission source vector $q = B \\phi$, and then compute the scalar total fission source\n$$\nS_f = q_1 + q_2,\n$$\nwhere $q_g$ is the $g$-th component of $q$. Express the final numerical value of $S_f$ in neutrons per cubic centimeter per second, written as $\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}$, and round your answer to five significant figures.",
            "solution": "The user-provided problem has been analyzed and is determined to be **valid**. It is scientifically grounded in the principles of nuclear reactor physics, well-posed with sufficient and consistent data, and objectively stated. The tasks involve a standard application of the multigroup neutron balance equations.\n\nThe problem asks to perform three tasks related to the two-group, steady-state, infinite-medium neutron balance equations. We will address each task in sequence.\n\nFirst, we establish the theoretical framework. The steady-state neutron balance for energy group $g$ in an infinite medium equates neutron losses (absorption and out-scattering) to neutron gains (in-scattering and fission).\n\nFor a two-group model ($g=1$ for the fast group, $g=2$ for the thermal group), the balance equations are:\n\nFor group $1$:\n$$\n\\text{Losses}_1 = \\text{Gains}_1\n$$\n$$\n\\Sigma_{a,1}\\phi_1 + \\Sigma_{s,1 \\to 2}\\phi_1 = \\Sigma_{s,2 \\to 1}\\phi_2 + \\frac{1}{k} \\chi_1 \\left( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 \\right)\n$$\n\nFor group $2$:\n$$\n\\text{Losses}_2 = \\text{Gains}_2\n$$\n$$\n\\Sigma_{a,2}\\phi_2 + \\Sigma_{s,2 \\to 1}\\phi_2 = \\Sigma_{s,1 \\to 2}\\phi_1 + \\frac{1}{k} \\chi_2 \\left( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 \\right)\n$$\n\nHere, $\\phi_g$ is the neutron flux in group $g$, $\\Sigma_{a,g}$ is the macroscopic absorption cross-section, $\\Sigma_{s,g \\to g'}$ is the macroscopic scattering cross-section from group $g$ to $g'$, $\\nu\\Sigma_{f,g}$ is the average number of neutrons produced per fission times the macroscopic fission cross-section, $\\chi_g$ is the fraction of fission neutrons born in group $g$, and $k$ is the effective multiplication factor.\n\nThe problem requires casting this system into the form $A \\phi = \\frac{1}{k} B \\phi$. To do this, we group all non-fission terms on the left-hand side and all fission-related production terms on the right-hand side.\n\nRearranging the equations:\n$$\n(\\Sigma_{a,1} + \\Sigma_{s,1 \\to 2})\\phi_1 - \\Sigma_{s,2 \\to 1}\\phi_2 = \\frac{1}{k} \\left[ \\chi_1 ( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 ) \\right]\n$$\n$$\n-\\Sigma_{s,1 \\to 2}\\phi_1 + (\\Sigma_{a,2} + \\Sigma_{s,2 \\to 1})\\phi_2 = \\frac{1}{k} \\left[ \\chi_2 ( \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2 ) \\right]\n$$\n\nThis system can be written in matrix form as:\n$$\n\\begin{pmatrix} \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}  -\\Sigma_{s,2 \\to 1} \\\\ -\\Sigma_{s,1 \\to 2}  \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} \\end{pmatrix} \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix} = \\frac{1}{k} \\begin{pmatrix} \\chi_1 \\nu\\Sigma_{f,1}  \\chi_1 \\nu\\Sigma_{f,2} \\\\ \\chi_2 \\nu\\Sigma_{f,1}  \\chi_2 \\nu\\Sigma_{f,2} \\end{pmatrix} \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix}\n$$\n\n**Task 1: Assemble the loss matrix $A$ and the fission production matrix $B$.**\n\nFrom the matrix equation above, we can identify a loss operator $A$ (more precisely, a net loss and scattering operator) and a fission production operator $B$.\n\nThe loss matrix $A$ is:\n$$\nA = \\begin{pmatrix} \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2}  -\\Sigma_{s,2 \\to 1} \\\\ -\\Sigma_{s,1 \\to 2}  \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} \\end{pmatrix}\n$$\nThe fission production matrix $B$ is:\n$$\nB = \\begin{pmatrix} \\chi_1 \\nu\\Sigma_{f,1}  \\chi_1 \\nu\\Sigma_{f,2} \\\\ \\chi_2 \\nu\\Sigma_{f,1}  \\chi_2 \\nu\\Sigma_{f,2} \\end{pmatrix}\n$$\nThis can also be expressed as the outer product of the fission spectrum vector $\\chi_g$ and the production vector $\\nu\\Sigma_{f,g}$, i.e., $B = \\chi (\\nu\\Sigma_f)^T$.\n\nNow, we substitute the given numerical values:\n$\\Sigma_{a,1} = 0.07\\,\\text{cm}^{-1}$, $\\Sigma_{s,1 \\to 2} = 0.21\\,\\text{cm}^{-1}$, $\\nu \\Sigma_{f,1} = 0.042\\,\\text{cm}^{-1}$.\n$\\Sigma_{a,2} = 0.09\\,\\text{cm}^{-1}$, $\\Sigma_{s,2 \\to 1} = 0.015\\,\\text{cm}^{-1}$, $\\nu \\Sigma_{f,2} = 0.175\\,\\text{cm}^{-1}$.\n$\\chi_1 = 0.92$, $\\chi_2 = 0.08$.\n\nFor matrix $A$:\n$A_{11} = \\Sigma_{a,1} + \\Sigma_{s,1 \\to 2} = 0.07 + 0.21 = 0.28\\,\\text{cm}^{-1}$\n$A_{12} = -\\Sigma_{s,2 \\to 1} = -0.015\\,\\text{cm}^{-1}$\n$A_{21} = -\\Sigma_{s,1 \\to 2} = -0.21\\,\\text{cm}^{-1}$\n$A_{22} = \\Sigma_{a,2} + \\Sigma_{s,2 \\to 1} = 0.09 + 0.015 = 0.105\\,\\text{cm}^{-1}$\n$$\nA = \\begin{pmatrix} 0.28  -0.015 \\\\ -0.21  0.105 \\end{pmatrix}\\,\\text{cm}^{-1}\n$$\n\nFor matrix $B$:\n$B_{11} = \\chi_1 \\nu\\Sigma_{f,1} = 0.92 \\times 0.042 = 0.03864\\,\\text{cm}^{-1}$\n$B_{12} = \\chi_1 \\nu\\Sigma_{f,2} = 0.92 \\times 0.175 = 0.161\\,\\text{cm}^{-1}$\n$B_{21} = \\chi_2 \\nu\\Sigma_{f,1} = 0.08 \\times 0.042 = 0.00336\\,\\text{cm}^{-1}$\n$B_{22} = \\chi_2 \\nu\\Sigma_{f,2} = 0.08 \\times 0.175 = 0.014\\,\\text{cm}^{-1}$\n$$\nB = \\begin{pmatrix} 0.03864  0.161 \\\\ 0.00336  0.014 \\end{pmatrix}\\,\\text{cm}^{-1}\n$$\n\n**Task 2: State the dimensions and sparsity patterns of $A$ and $B$.**\n\nThe dimensions of both matrix $A$ and matrix $B$ are $2 \\times 2$, corresponding to the two energy groups.\nRegarding sparsity, a matrix is sparse if many of its elements are zero. In this case, all elements of both $A$ and $B$ are non-zero. Therefore, both matrices $A$ and $B$ are dense.\n\n**Task 3: Compute the fission source vector $q = B\\phi$ and the scalar total fission source $S_f = q_1 + q_2$.**\n\nThe fission source vector $q$ represents the rate of production of fission neutrons per unit volume in each energy group. It is calculated as $q = B\\phi$. The total fission source $S_f$ is the sum of the components of $q$.\nGiven the flux vector:\n$$\n\\phi = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\end{pmatrix} = \\begin{pmatrix} 1.37 \\times 10^{13} \\\\ 2.62 \\times 10^{13} \\end{pmatrix} \\ \\text{cm}^{-2}\\,\\text{s}^{-1}\n$$\nThe total fission source $S_f$ is the total number of neutrons produced by fission per unit volume per unit time. This is given by the sum over all groups of the fission rate in each group multiplied by the neutrons per fission.\n$$\nS_f = \\sum_{g=1}^{2} \\nu\\Sigma_{f,g} \\phi_g = \\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2\n$$\nNote that $S_f = q_1 + q_2 = (\\chi_1 + \\chi_2)(\\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2)$. Since the fission spectrum fractions must sum to unity, $\\chi_1 + \\chi_2 = 0.92 + 0.08 = 1$, we have $S_f = q_1 + q_2$.\nWe calculate $S_f$ directly:\n$$\nS_f = (0.042\\,\\text{cm}^{-1}) \\times (1.37 \\times 10^{13}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}) + (0.175\\,\\text{cm}^{-1}) \\times (2.62 \\times 10^{13}\\,\\text{cm}^{-2}\\,\\text{s}^{-1})\n$$\n$$\nS_f = (0.05754 \\times 10^{13}) + (0.4585 \\times 10^{13}) \\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\n$$\n$$\nS_f = 0.51604 \\times 10^{13} \\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\n$$\n$$\nS_f = 5.1604 \\times 10^{12} \\,\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}\n$$\nThe problem requires the final answer to be rounded to five significant figures. The calculated value $5.1604 \\times 10^{12}$ already has five significant figures.",
            "answer": "$$\n\\boxed{5.1604 \\times 10^{12}}\n$$"
        },
        {
            "introduction": "With the eigenvalue problem cast into matrix form, we can apply the power iteration method to find the solution. This exercise guides you through a single, complete step of the power iteration algorithm for a discretized one-dimensional reactor. By manually performing the fixed-source solve ($A x = B \\phi^{(m)}$), updating the eigenvalue estimate $k^{(m+1)}$, and renormalizing the flux, you will solidify your understanding of the core mechanics of the power iteration process . This step-by-step calculation is fundamental to appreciating how the iterative scheme converges towards the dominant eigenpair.",
            "id": "4241508",
            "problem": "Consider the steady-state, one-group neutron diffusion $k$-eigenvalue problem in One Dimension (1D),\n$$- \\frac{d}{dx}\\left(D(x)\\frac{d \\phi(x)}{dx}\\right) + \\Sigma_{a}(x)\\,\\phi(x) \\;=\\; \\frac{1}{k}\\,\\nu \\Sigma_{f}(x)\\,\\phi(x),$$\nwhere $D(x)$ is the diffusion coefficient, $\\Sigma_{a}(x)$ is the absorption macroscopic cross section, $\\nu\\Sigma_{f}(x)$ is the neutron production macroscopic cross section, $\\phi(x)$ is the neutron flux, and $k$ is the effective multiplication factor. Under a uniform mesh finite-difference discretization with reflecting boundary conditions on a three-cell mesh of equal widths, the spatial operator and the fission production operator assemble into the matrices\n$$A \\;=\\; \\begin{pmatrix}\n1.1  -1  0 \\\\\n-1  2.1  -1 \\\\\n0  -1  1.1\n\\end{pmatrix}, \\qquad\nB \\;=\\; \\mathrm{diag}\\!\\big(0.1,\\;0.125,\\;0.1\\big).$$\nLet the current iterate flux vector be\n$$\\phi^{(m)} \\;=\\; \\begin{pmatrix} 4 \\\\[4pt] 4 \\\\[4pt] 1 \\end{pmatrix},$$\nwhich has been normalized to unit total fission source using the weighting induced by $B$. Define the fission-source normalization functional $S(\\psi)$ by\n$$S(\\psi) \\;=\\; \\sum_{i=1}^{3} \\big[B\\big]_{ii}\\,\\psi_i \\;=\\; 0.1\\,\\psi_1 + 0.125\\,\\psi_2 + 0.1\\,\\psi_3.$$\nImplement one step of Power Iteration (PI) by solving the linear system\n$$A\\,x \\;=\\; B\\,\\phi^{(m)},$$\nforming the updated flux\n$$\\phi^{(m+1)} \\;=\\; \\frac{x}{S(x)}$$\nso that $S\\!\\big(\\phi^{(m+1)}\\big) = 1$, and estimating the updated multiplication factor $k^{(m+1)}$ using the fission-based estimator. Express the final $k^{(m+1)}$ as a dimensionless real number and round your answer to six significant figures.",
            "solution": "The one-group neutron diffusion $k$-eigenvalue problem can be written in operator form as\n$$A\\,\\phi \\;=\\; \\frac{1}{k}\\,B\\,\\phi,$$\nwhere $A$ represents leakage and absorption and $B$ represents fission production. Rearranging yields\n$$A^{-1} B\\,\\phi \\;=\\; k\\,\\phi,$$\nso the dominant eigenvalue of $A^{-1} B$ is $k$. The Power Iteration (PI) step constructs\n$$y \\;=\\; A^{-1} B\\,\\phi^{(m)}$$\nby solving $A\\,x = B\\,\\phi^{(m)}$ and taking $x = y$. If the flux is normalized by the fission-source functional $S(\\cdot)$ so that $S\\!\\big(\\phi^{(m)}\\big)=1$, then for the exact eigenpair it holds $y = k\\,\\phi$ and therefore\n$$S(y) \\;=\\; S(k\\,\\phi) \\;=\\; k\\,S(\\phi) \\;=\\; k.$$\nThus, under fission-source normalization, the fission-based estimator of the updated multiplication factor is\n$$k^{(m+1)} \\;=\\; S(x),$$\nand the updated flux is scaled to maintain $S\\!\\big(\\phi^{(m+1)}\\big) = 1$ via $\\phi^{(m+1)} = x/S(x)$.\n\nWe now carry out the calculation with the given data. First compute the right-hand side $r = B\\,\\phi^{(m)}$:\n$$r \\;=\\; \\begin{pmatrix}\n0.1  0  0 \\\\\n0  0.125  0 \\\\\n0  0  0.1\n\\end{pmatrix}\n\\begin{pmatrix} 4 \\\\ 4 \\\\ 1 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} 0.4 \\\\ 0.5 \\\\ 0.1 \\end{pmatrix}.$$\nSolve the linear system $A\\,x = r$ with\n$$A \\;=\\; \\begin{pmatrix}\n1.1  -1  0 \\\\\n-1  2.1  -1 \\\\\n0  -1  1.1\n\\end{pmatrix}, \\qquad r \\;=\\; \\begin{pmatrix} 0.4 \\\\ 0.5 \\\\ 0.1 \\end{pmatrix}.$$\nWrite the equations componentwise:\n\\begin{align*}\n1.1\\,x_1 - x_2 = 0.4, \\\\\n-\\,x_1 + 2.1\\,x_2 - x_3 = 0.5, \\\\\n-\\,x_2 + 1.1\\,x_3 = 0.1.\n\\end{align*}\nFrom the first equation, express $x_2$ in terms of $x_1$:\n$$x_2 \\;=\\; 1.1\\,x_1 - 0.4.$$\nFrom the third equation, express $x_3$ in terms of $x_2$:\n$$1.1\\,x_3 \\;=\\; 0.1 + x_2 \\;\\;\\Rightarrow\\;\\; x_3 \\;=\\; \\frac{0.1 + x_2}{1.1} \\;=\\; x_1 - \\frac{3}{11}.$$\nInsert these into the second equation:\n\\begin{align*}\n-\\,x_1 + 2.1\\,x_2 - x_3 = 0.5, \\\\\n-\\,x_1 + 2.1\\,(1.1\\,x_1 - 0.4) - \\big(x_1 - \\tfrac{3}{11}\\big) = 0.5, \\\\\n\\left(-1 + 2.31 - 1\\right) x_1 + \\left(-0.84 + \\tfrac{3}{11}\\right) = 0.5, \\\\\n0.31\\,x_1 = 0.5 + 0.84 - \\frac{3}{11} = 1.34 - \\frac{3}{11} = \\frac{1174}{1100} = \\frac{587}{550}.\n\\end{align*}\nSolve for $x_1$:\n\\begin{align*}\nx_1 = \\frac{587}{550}\\cdot\\frac{1}{0.31} \\;=\\; \\frac{587}{550}\\cdot\\frac{100}{31} \\;=\\; \\frac{1174}{341}.\n\\end{align*}\nThen\n\\begin{align*}\nx_2 = 1.1\\,x_1 - 0.4 \\;=\\; \\frac{11}{10}\\cdot\\frac{1174}{341} - \\frac{2}{5} \\;=\\; \\frac{1155}{341}, \\\\\nx_3 = x_1 - \\frac{3}{11} \\;=\\; \\frac{1174}{341} - \\frac{93}{341} \\;=\\; \\frac{1081}{341}.\n\\end{align*}\nThus,\n$$x \\;=\\; \\begin{pmatrix} \\dfrac{1174}{341} \\\\[6pt] \\dfrac{1155}{341} \\\\[6pt] \\dfrac{1081}{341} \\end{pmatrix}.$$\nCompute the fission-source functional $S(x)$ using the diagonal entries of $B$:\n\\begin{align*}\nS(x) \\;=\\; 0.1\\,x_1 + 0.125\\,x_2 + 0.1\\,x_3 \\\\\n=\\; \\frac{1}{10}\\cdot\\frac{1174}{341} \\;+\\; \\frac{1}{8}\\cdot\\frac{1155}{341} \\;+\\; \\frac{1}{10}\\cdot\\frac{1081}{341} \\\\\n=\\; \\frac{1174}{3410} \\;+\\; \\frac{1155}{2728} \\;+\\; \\frac{1081}{3410}.\n\\end{align*}\nTo sum these fractions, we find a common denominator, which is $13640 = 4 \\cdot 3410 = 5 \\cdot 2728$.\n\\begin{align*}\nS(x) = \\frac{1174 \\cdot 4}{13640} + \\frac{1155 \\cdot 5}{13640} + \\frac{1081 \\cdot 4}{13640} \\\\\n= \\frac{4696 + 5775 + 4324}{13640} = \\frac{14795}{13640}.\n\\end{align*}\nThis fraction simplifies, as $14795 = 5 \\cdot 11 \\cdot 269$ and $13640 = 40 \\cdot 11 \\cdot 31$, giving:\n$$ S(x) = \\frac{5 \\cdot 11 \\cdot 269}{40 \\cdot 11 \\cdot 31} = \\frac{269}{8 \\cdot 31} = \\frac{269}{248}. $$\nTherefore, the fission-based estimator gives\n$$k^{(m+1)} \\;=\\; S(x) \\;=\\; \\frac{269}{248} \\;\\approx\\; 1.084677419\\ldots.$$\nRounding to six significant figures yields\n$$k^{(m+1)} \\;\\approx\\; 1.08468.$$",
            "answer": "$$\\boxed{1.08468}$$"
        },
        {
            "introduction": "A numerical algorithm is only as reliable as its convergence criteria. In power iteration for large reactor systems, a slowly converging flux shape can lead to premature, or \"false,\" convergence if we are not careful. This practice challenges you to analyze the limitations of monitoring only the eigenvalue $k$ and to identify more robust diagnostics for convergence, exploring the consequences of a small spectral gapâ€”a common feature in realistic reactor problems. Understanding these pitfalls is a critical skill, and this exercise  will equip you to design and justify robust stopping criteria that ensure both the eigenvalue and the flux distribution have converged accurately.",
            "id": "4241546",
            "problem": "In neutron transport calculations for critical reactor cores, the $k$-eigenvalue problem is posed as $\\mathcal{L}\\,\\phi = \\dfrac{1}{k}\\,\\mathcal{F}\\,\\phi$, where $\\mathcal{L}$ is the streaming-collision operator, $\\mathcal{F}$ is the fission production operator, $\\phi$ is the neutron flux, and $k$ is the effective neutron multiplication factor. A common solver is power iteration, which constructs a sequence $\\{\\phi^{(n)},k^{(n)}\\}$ by repeatedly solving a fixed-source problem with a fission source derived from the previous iterate and rescaling. In practice, convergence is often assessed by monitoring only the stabilization of $k^{(n)}$.\n\nConsider a three-dimensional core simulation of a Pressurized Water Reactor (PWR) with reflective boundary conditions and multigroup transport. The observed $k^{(n)}$ stabilizes to within $\\pm 10^{-5}$ over approximately $50$ iterations. However, the spectral gap of the underlying linearized fission operator is small, with a dominance ratio (defined as the ratio of the magnitude of the second largest eigenvalue to the largest eigenvalue of the power-iteration operator) near $0.98$. Assume the operators and discretization produce a well-posed $k$-eigenvalue problem with a simple dominant eigenpair, and that the power iteration uses a standard normalization of $\\phi^{(n)}$ to keep the total fission source bounded. You are asked to analyze potential false convergence if only $k^{(n)}$ is monitored and recommend additional diagnostics to detect stalled flux shape evolution.\n\nWhich of the following diagnostics, when used in addition to monitoring $k^{(n)}$, are appropriate and theoretically justified to detect stalled or slow evolution in the flux shape and thereby avoid false convergence? Select all that apply.\n\nA. Monitor the norm of the nonlinear residual $r^{(n)} = \\mathcal{L}\\,\\phi^{(n)} - \\dfrac{1}{k^{(n)}}\\,\\mathcal{F}\\,\\phi^{(n)}$ and declare convergence only when $\\|r^{(n)}\\|$ falls below a prescribed tolerance in a physically relevant norm.\n\nB. Compare successive normalized flux shapes using an inner-product-based cosine metric, for example $1 - \\dfrac{|\\langle \\phi^{(n)}, \\phi^{(n-1)} \\rangle|}{\\|\\phi^{(n)}\\|\\,\\|\\phi^{(n-1)}\\|}$, and require this quantity to be small.\n\nC. Rely solely on the stabilization of the multiplication factor $k^{(n)}$ within a tight tolerance, because $k^{(n)}$ necessarily stabilizes only after the flux shape has converged.\n\nD. Estimate the dominance ratio and the contamination amplitude of the subdominant mode (e.g., via ratios of successive differences in $\\phi^{(n)}$), and require the estimated contamination to be below a threshold before declaring convergence.\n\nE. Monitor only the total reactor power $P^{(n)} = \\int \\nu\\,\\Sigma_f(\\mathbf{r},E)\\,\\phi^{(n)}(\\mathbf{r},E)\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}E$, because $P^{(n)}$ is proportional to $k^{(n)}$ and suffices to indicate convergence.\n\nF. Use coefficients from Anderson acceleration or other extrapolation schemes as the primary indicator of convergence; small coefficients imply the flux shape has converged.",
            "solution": "The problem statement describes a common challenge in the numerical solution of the neutron transport equation for reactor criticality, specifically the phenomenon of \"false convergence\" when using the power iteration method. The core of the issue lies in the disparity between the convergence rates of the eigenvalue ($k_{\\text{eff}}$) and the corresponding eigenfunction (the neutron flux shape, $\\phi$). We will first validate the problem statement and then proceed to a detailed analysis of the proposed convergence diagnostics.\n\n### Problem Validation\n\n- **Step 1: Extract Givens**\n    - The governing equation is the $k$-eigenvalue problem: $\\mathcal{L}\\,\\phi = \\dfrac{1}{k}\\,\\mathcal{F}\\,\\phi$.\n    - $\\mathcal{L}$ is the streaming-collision operator.\n    - $\\mathcal{F}$ is the fission production operator.\n    - $\\phi$ is the neutron flux eigenfunction.\n    - $k$ is the effective neutron multiplication factor eigenvalue.\n    - The numerical method is power iteration, generating a sequence $\\{\\phi^{(n)}, k^{(n)}\\}$.\n    - The physical system is a three-dimensional Pressurized Water Reactor (PWR) core with reflective boundary conditions and multigroup transport.\n    - Observation: $k^{(n)}$ stabilizes to within $\\pm 10^{-5}$ in approximately $50$ iterations.\n    - Spectral property: The dominance ratio is near $0.98$.\n    - Assumption: The problem is well-posed with a simple dominant eigenpair.\n    - Assumption: Standard normalization is used to keep the total fission source bounded.\n    - The task is to identify appropriate and theoretically justified diagnostics, in addition to monitoring $k^{(n)}$, to detect stalled or slow evolution in the flux shape.\n\n- **Step 2: Validate Using Extracted Givens**\n    - **Scientifically Grounded:** The problem is firmly rooted in standard nuclear reactor theory and numerical analysis. The k-eigenvalue equation, the power iteration method, and the concept of a dominance ratio are fundamental to this field. The stated dominance ratio of $0.98$ is a realistic value for large, loosely coupled reactors and correctly identifies the source of the numerical difficulty.\n    - **Well-Posed:** The problem explicitly assumes a well-posed k-eigenvalue problem with a simple dominant eigenpair, which is standard for such analyses. The question itself is well-posed, asking for an evaluation of diagnostic techniques.\n    - **Objective:** The language is technical, precise, and free of subjective content.\n\n- **Step 3: Verdict and Action**\n    The problem statement is scientifically sound, well-posed, and objective. It presents a classic and non-trivial numerical analysis challenge within a real-world scientific context. The problem is **valid**. We proceed to the solution.\n\n### Theoretical Foundation: Convergence of Power Iteration\n\nThe power iteration for the eigenvalue problem $M\\phi = k\\phi$, where the iteration operator is $M = \\mathcal{L}^{-1}\\mathcal{F}$, generates a sequence of flux iterates. An arbitrary initial flux guess, $\\phi^{(0)}$, can be expanded in the basis of the true eigenfunctions $\\phi_i$ of the operator $M$:\n$$ \\phi^{(0)} = \\sum_{i=1}^{\\infty} c_i \\phi_i $$\nAfter $n$ iterations, the unnormalized flux $\\tilde{\\phi}^{(n)}$ is given by:\n$$ \\tilde{\\phi}^{(n)} = M^n \\phi^{(0)} = \\sum_{i=1}^{\\infty} c_i M^n \\phi_i = \\sum_{i=1}^{\\infty} c_i k_i^n \\phi_i $$\nwhere $k_i$ are the eigenvalues of $M$, ordered such that $k_1  |k_2| \\geq |k_3| \\geq \\dots$. Factoring out the dominant eigenvalue term $k_1^n$:\n$$ \\tilde{\\phi}^{(n)} = k_1^n \\left( c_1 \\phi_1 + c_2 \\left(\\frac{k_2}{k_1}\\right)^n \\phi_2 + \\sum_{i=3}^{\\infty} c_i \\left(\\frac{k_i}{k_1}\\right)^n \\phi_i \\right) $$\nThe normalized flux iterate is $\\phi^{(n)}$. The error in the flux shape, which is the deviation from the fundamental mode $\\phi_1$, is primarily determined by the contribution of the second mode $\\phi_2$. The magnitude of this error is proportional to the term $(\\frac{k_2}{k_1})^n$. The dominance ratio is defined as $\\rho = |k_2|/k_1$. The given value is $\\rho \\approx 0.98$.\nThe error in the eigenvector (flux shape) thus converges as:\n$$ \\|\\phi^{(n)} - \\phi_1\\| \\sim \\mathcal{O}(\\rho^n) = \\mathcal{O}(0.98^n) $$\nThe eigenvalue estimate $k^{(n)}$ is a global quantity, typically calculated using a method analogous to a Rayleigh quotient. For non-self-adjoint operators like $M$, such estimates generally exhibit convergence that is significantly faster than the eigenvector convergence. The error in the eigenvalue is theoretically shown to converge as:\n$$ |k^{(n)} - k_1| \\sim \\mathcal{O}(\\rho^{2n}) = \\mathcal{O}(0.98^{2n}) $$\nWith $\\rho = 0.98$, the flux shape error decays very slowly. After $n=50$ iterations, the error is an estimated factor of $(0.98)^{50} \\approx 0.364$ of its initial value. In contrast, the eigenvalue error has decayed by a factor of $(0.98)^{100} \\approx 0.133$. The change in $k^{(n)}$ per iteration, $|\\Delta k^{(n)}|$, will be even smaller, giving the false impression of convergence. The task is to find diagnostics that track the slow $\\mathcal{O}(\\rho^n)$ convergence of the flux shape.\n\n### Option-by-Option Analysis\n\n**A. Monitor the norm of the nonlinear residual $r^{(n)} = \\mathcal{L}\\,\\phi^{(n)} - \\dfrac{1}{k^{(n)}}\\,\\mathcal{F}\\,\\phi^{(n)}$ and declare convergence only when $\\|r^{(n)}\\|$ falls below a prescribed tolerance in a physically relevant norm.**\nThe residual $r^{(n)}$ measures how well the current iterate pair $(\\phi^{(n)}, k^{(n)})$ satisfies the underlying eigenvalue equation. A true eigenpair $(\\phi_1, k_1)$ would yield a zero residual. During the iteration, we can express the residual using the update step, which is typically of the form $\\mathcal{L}\\phi^{(n)} = \\frac{1}{k_{src}} \\mathcal{F}\\phi^{(n-1)}$ (where $k_{src}$ might be $k^{(n-1)}$).\n$$ r^{(n)} = \\frac{1}{k_{src}} \\mathcal{F}\\phi^{(n-1)} - \\frac{1}{k^{(n)}} \\mathcal{F}\\phi^{(n)} $$\nThis expression shows that the residual is a function of the difference between successive fission sources ($\\mathcal{F}\\phi$). As the iteration converges, $\\phi^{(n)} \\rightarrow \\phi^{(n-1)}$ and $k^{(n)} \\rightarrow k^{(n-1)}$. The rate at which $\\|r^{(n)}\\|$ approaches zero is governed by the rate at which $\\phi^{(n)}$ converges to $\\phi_1$, which is $\\mathcal{O}(\\rho^n)$. Therefore, monitoring the norm of this residual is a direct and theoretically sound method to track the convergence of the flux shape.\n**Verdict: Correct**\n\n**B. Compare successive normalized flux shapes using an inner-product-based cosine metric, for example $1 - \\dfrac{|\\langle \\phi^{(n)}, \\phi^{(n-1)} \\rangle|}{\\|\\phi^{(n)}\\|\\,\\|\\phi^{(n-1)}\\|}$, and require this quantity to be small.**\nThis metric measures the angle between the flux vectors of two consecutive iterations. If the flux shape is no longer changing, the vectors will be parallel, and the metric will be zero. The change between successive iterates, $\\phi^{(n)} - \\phi^{(n-1)}$, is given by:\n$$ \\phi^{(n)} - \\phi^{(n-1)} \\approx C \\left( \\rho^n - \\rho^{n-1} \\right) \\phi_2 = C \\rho^{n-1}(\\rho - 1) \\phi_2 $$\nfor some normalization constant $C$. The norm of this difference, $\\|\\phi^{(n)} - \\phi^{(n-1)}\\|$, decreases at a rate of $\\mathcal{O}(\\rho^n)$. The proposed cosine metric is directly related to this norm (for small angles, $1-\\cos\\theta \\approx \\theta^2/2$, and $\\theta$ is related to $\\|\\phi^{(n)} - \\phi^{(n-1)}\\|$). Consequently, this metric's convergence to zero is governed by the slow convergence rate of the flux shape. This is a direct measure of the \"stalled or slow evolution\" of the flux shape itself.\n**Verdict: Correct**\n\n**C. Rely solely on the stabilization of the multiplication factor $k^{(n)}$ within a tight tolerance, because $k^{(n)}$ necessarily stabilizes only after the flux shape has converged.**\nThis statement is fundamentally flawed and represents the very misconception the problem seeks to address. As established in the theoretical foundation, the error in the eigenvalue $|k^{(n)} - k_1|$ converges as $\\mathcal{O}(\\rho^{2n})$, while the error in the eigenfunction $\\|\\phi^{(n)} - \\phi_1\\|$ converges as $\\mathcal{O}(\\rho^n)$. Since $\\rho  1$, the eigenvalue always converges faster than the eigenfunction (for $\\rho=0.98$, twice as fast in terms of the exponent). Therefore, $k^{(n)}$ can and will appear to have stabilized long before the flux shape has converged to the desired tolerance. The premise of the option is factually incorrect.\n**Verdict: Incorrect**\n\n**D. Estimate the dominance ratio and the contamination amplitude of the subdominant mode (e.g., via ratios of successive differences in $\\phi^{(n)}$), and require the estimated contamination to be below a threshold before declaring convergence.**\nThis describes an advanced and powerful diagnostic technique. By analyzing the sequence of iterates, one can estimate the key parameters governing convergence. The ratio of the norms of successive differences in the flux vector provides an estimate of the dominance ratio:\n$$ \\frac{\\|\\phi^{(n)} - \\phi^{(n-1)}\\|}{\\|\\phi^{(n-1)} - \\phi^{(n-2)}\\|} \\approx \\frac{\\|\\rho^{n-1}(\\rho - 1) c_2 \\phi_2\\|}{\\|\\rho^{n-2}(\\rho - 1) c_2 \\phi_2\\|} = \\rho $$\nOnce $\\rho$ is known or estimated, the magnitude of the error in the current iterate can be estimated. The error is $e^{(n-1)} = \\phi^{(n-1)} - \\phi_1 \\approx c_2 \\rho^{n-1}\\phi_2$. The difference is $\\delta^{(n)} = \\phi^{(n)} - \\phi^{(n-1)} \\approx e^{(n-1)}(\\rho-1)$. Therefore, an estimate for the error norm is $\\|e^{(n-1)}\\| \\approx \\frac{\\|\\delta^{(n)}\\|}{|1-\\rho|}$. Requiring this estimated error to be below a threshold is a direct, quantitative assessment of the actual convergence of the flux eigenfunction. This method is theoretically rigorous.\n**Verdict: Correct**\n\n**E. Monitor only the total reactor power $P^{(n)} = \\int \\nu\\,\\Sigma_f(\\mathbf{r},E)\\,\\phi^{(n)}(\\mathbf{r},E)\\,\\mathrm{d}\\mathbf{r}\\,\\mathrm{d}E$, because $P^{(n)}$ is proportional to $k^{(n)}$ and suffices to indicate convergence.**\nThis option contains a critical flaw in its justification. In the power iteration, the absolute magnitude of the flux $\\phi^{(n)}$ is immaterial and is reset at each iteration by a normalization condition (e.g., normalizing the total fission source). The eigenvalue $k$ relates the neutron production rate to the loss rate and is independent of the absolute power level in a critical reactor. The power $P^{(n)}$ is an integral property of the flux $\\phi^{(n)}$. While the flux normalization is arbitrary, a consistent normalization scheme will lead to a specific value for $P^{(n)}$. The error in $P^{(n)}$ will be a linear functional of the error in $\\phi^{(n)}$, and thus will converge at the same slow rate, $\\mathcal{O}(\\rho^n)$. So, monitoring $P^{(n)}$ would indeed be a better indicator of flux convergence than monitoring $k^{(n)}$. However, the provided justification, \"because $P^{(n)}$ is proportional to $k^{(n)}$\", is fundamentally false. In a simulation, $k^{(n)}$ approaches a constant ($k_1$), while the computed power $P^{(n)}$ depends on the arbitrary normalization chosen for $\\phi^{(n)}$. There is no general proportionality. Given the exacting standards of scientific correctness, an option with a false justification is unacceptable.\n**Verdict: Incorrect**\n\n**F. Use coefficients from Anderson acceleration or other extrapolation schemes as the primary indicator of convergence; small coefficients imply the flux shape has converged.**\nThis option misinterprets the role of coefficients in an extrapolation scheme like Anderson acceleration. Anderson acceleration (or mixing) combines a history of iterates and residuals to form a better next iterate. It does so by solving a small least-squares problem to find optimal mixing coefficients, $\\alpha_i$. The goal is to minimize the norm of a new residual. The indicator of convergence in such a scheme is the norm of this minimized residual, not the values of the coefficients $\\alpha_i$ themselves. The optimal coefficients depend on the entire recent history of the iteration and do not have a simple, direct relationship to proximity to the solution. A small residual norm indicates convergence; the coefficients are simply the weights used to achieve that small residual and are not a reliable primary diagnostic.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}