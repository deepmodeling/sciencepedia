{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握无限质量近似，我们必须从单个中子-原子核碰撞的基础物理学入手。本练习将引导你通过第一性原理推导，展示能量转移如何依赖于质量比 $A$。通过计算，你将证明在原子核无限重的极限情况下（$A \\to \\infty$），平均能量损失趋于零，从而为该近似的核心概念提供严格的数学基础。",
            "id": "4254917",
            "problem": "在核反应堆模拟的中子慢化背景下，考虑一个质量为 $m$ 的中子与一个质量为 $M$ 的静止靶核发生弹性碰撞，其质量比为 $A=M/m$。设实验室参考系中中子的初始动能为 $E$，碰撞后中子的能量为 $E'$。假设在质心 (CM) 参考系中散射是弹性的且各向同性，这意味着在质心系中散射在立体角上是均匀的，因此在 $\\cos\\theta_{\\mathrm{CM}} \\in [-1,1]$上是均匀的，其中 $\\theta_{\\mathrm{CM}}$ 是质心系中的散射角。\n\n从动能和动量守恒出发，并利用实验室参考系与质心 (CM) 参考系之间的伽利略变换，推导实验室参考系中的能量比 $E'/E$ 对质心系散射余弦 $\\mu=\\cos\\theta_{\\mathrm{CM}}$ 的函数依赖关系。然后，对于有限的质量比 $A$，通过在质心系中对各向同性散射进行平均，计算每次碰撞的平均能量损失分数，\n$$\\left\\langle 1 - \\frac{E'}{E} \\right\\rangle，$$\n将您的最终结果表示为以 $A$ 为变量的闭式解析表达式。最后，使用您推导的表达式，从第一性原理证明，在无限大质量近似 $A \\to \\infty$下，该平均能量损失分数为零。\n\n请以单个以 $A$ 为变量的闭式表达式提供您的最终答案。不需要数值近似或四舍五入。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题明确、客观且自洽。解题过程如下。\n\n该问题要求推导中子与静止原子核发生弹性碰撞时的平均能量损失分数。设中子质量为 $m$，在实验室（lab）参考系中的初始速度为 $\\vec{v}_n$。靶核质量为 $M$，初始时处于静止状态，$\\vec{v}_N = \\vec{0}$。质量比定义为 $A = M/m$。中子的初始动能为 $E = \\frac{1}{2}m|\\vec{v}_n|^2$。\n\n首先，我们变换到质心（CM）参考系。质心的速度由下式给出：\n$$ \\vec{v}_{\\mathrm{CM}} = \\frac{m\\vec{v}_n + M\\vec{v}_N}{m+M} = \\frac{m\\vec{v}_n}{m+M} = \\frac{1}{1+A}\\vec{v}_n $$\n中子和原子核在质心系中的初始速度为：\n$$ \\vec{u}_n = \\vec{v}_n - \\vec{v}_{\\mathrm{CM}} = \\vec{v}_n - \\frac{1}{1+A}\\vec{v}_n = \\left(1 - \\frac{1}{1+A}\\right)\\vec{v}_n = \\frac{A}{1+A}\\vec{v}_n $$\n$$ \\vec{u}_N = \\vec{v}_N - \\vec{v}_{\\mathrm{CM}} = \\vec{0} - \\frac{1}{1+A}\\vec{v}_n = -\\frac{1}{1+A}\\vec{v}_n $$\n在质心系中，总动量为零，可以验证如下：$m\\vec{u}_n + M\\vec{u}_N = m\\left(\\frac{A}{1+A}\\vec{v}_n\\right) + M\\left(-\\frac{1}{1+A}\\vec{v}_n\\right) = \\frac{mA - M}{1+A}\\vec{v}_n = \\frac{M-M}{1+A}\\vec{v}_n = \\vec{0}$。\n\n对于弹性碰撞，动能在任何惯性参考系中都是守恒的。在质心系中，这意味着粒子的速率在碰撞中保持不变，尽管它们的方向会改变。设质心系中碰撞后的速度为 $\\vec{u}_n'$ 和 $\\vec{u}_N'$。那么，我们有：\n$$ |\\vec{u}_n'| = |\\vec{u}_n| = \\frac{A}{1+A}v_n $$\n其中 $v_n = |\\vec{v}_n|$。质心系中的散射角 $\\theta_{\\mathrm{CM}}$ 是该参考系中初始和最终中子速度之间的夹角，即 $\\vec{u}_n$ 和 $\\vec{u}_n'$ 之间的夹角。\n\n为了求得实验室参考系中的最终中子能量 $E'$，我们将最终中子速度从质心系变换回实验室系：\n$$ \\vec{v}_n' = \\vec{u}_n' + \\vec{v}_{\\mathrm{CM}} $$\n实验室参考系中的最终动能为 $E' = \\frac{1}{2}m|\\vec{v}_n'|^2$。我们计算最终速率的平方：\n$$ |\\vec{v}_n'|^2 = \\vec{v}_n' \\cdot \\vec{v}_n' = (\\vec{u}_n' + \\vec{v}_{\\mathrm{CM}}) \\cdot (\\vec{u}_n' + \\vec{v}_{\\mathrm{CM}}) = |\\vec{u}_n'|^2 + |\\vec{v}_{\\mathrm{CM}}|^2 + 2\\vec{u}_n' \\cdot \\vec{v}_{\\mathrm{CM}} $$\n我们来计算每一项。\n- $|\\vec{u}_n'|^2 = |\\vec{u}_n|^2 = \\left(\\frac{A}{1+A}v_n\\right)^2 = \\frac{A^2}{(A+1)^2}v_n^2$。\n- $|\\vec{v}_{\\mathrm{CM}}|^2 = \\left(\\frac{1}{1+A}v_n\\right)^2 = \\frac{1}{(A+1)^2}v_n^2$。\n- 点积项取决于散射角 $\\theta_{\\mathrm{CM}}$。向量 $\\vec{v}_{\\mathrm{CM}}$ 与初始中子速度 $\\vec{v}_n$ 平行，因此也与 $\\vec{u}_n$ 平行。因此，$\\vec{u}_n'$ 与 $\\vec{v}_{\\mathrm{CM}}$ 之间的夹角为 $\\theta_{\\mathrm{CM}}$。令 $\\mu = \\cos\\theta_{\\mathrm{CM}}$。\n$$ \\vec{u}_n' \\cdot \\vec{v}_{\\mathrm{CM}} = |\\vec{u}_n'||\\vec{v}_{\\mathrm{CM}}|\\cos\\theta_{\\mathrm{CM}} = \\left(\\frac{A}{1+A}v_n\\right)\\left(\\frac{1}{1+A}v_n\\right)\\mu = \\frac{A}{(A+1)^2}v_n^2\\mu $$\n将这些代入 $|\\vec{v}_n'|^2$ 的表达式中：\n$$ |\\vec{v}_n'|^2 = \\frac{A^2}{(A+1)^2}v_n^2 + \\frac{1}{(A+1)^2}v_n^2 + 2\\frac{A}{(A+1)^2}v_n^2\\mu = \\frac{A^2+1+2A\\mu}{(A+1)^2}v_n^2 $$\n最终能量与初始能量之比为：\n$$ \\frac{E'}{E} = \\frac{\\frac{1}{2}m|\\vec{v}_n'|^2}{\\frac{1}{2}m|\\vec{v}_n|^2} = \\frac{|\\vec{v}_n'|^2}{v_n^2} = \\frac{A^2+2A\\mu+1}{(A+1)^2} $$\n这就是能量比对质心系散射余弦 $\\mu$ 的函数依赖关系。\n\n接下来，我们计算平均能量损失分数 $\\left\\langle 1 - \\frac{E'}{E} \\right\\rangle$。这需要对所有可能的散射结果进行平均。问题陈述散射在质心系中是各向同性的，这意味着散射到给定立体角内的概率是均匀的。这表明 $\\mu = \\cos\\theta_{\\mathrm{CM}}$ 的概率分布函数在区间 $[-1, 1]$ 上是均匀的。归一化概率密度函数为 $p(\\mu) = 1/2$（对于 $\\mu \\in [-1, 1]$）。\n\n能量比的平均值 $\\langle E'/E \\rangle$ 为：\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\int_{-1}^{1} \\frac{E'}{E}(\\mu) p(\\mu) d\\mu = \\int_{-1}^{1} \\left( \\frac{A^2+2A\\mu+1}{(A+1)^2} \\right) \\frac{1}{2} d\\mu $$\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\frac{1}{2(A+1)^2} \\int_{-1}^{1} (A^2+1+2A\\mu) d\\mu $$\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\frac{1}{2(A+1)^2} \\left[ (A^2+1)\\mu + A\\mu^2 \\right]_{-1}^{1} $$\n计算定积分在上下限的值：\n$$ \\left[ (A^2+1)(1) + A(1)^2 \\right] - \\left[ (A^2+1)(-1) + A(-1)^2 \\right] = (A^2+A+1) - (-A^2-1+A) = 2A^2+2 = 2(A^2+1) $$\n将此结果代回：\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\frac{1}{2(A+1)^2} \\cdot 2(A^2+1) = \\frac{A^2+1}{(A+1)^2} $$\n那么，平均能量损失分数为：\n$$ \\left\\langle 1 - \\frac{E'}{E} \\right\\rangle = 1 - \\left\\langle \\frac{E'}{E} \\right\\rangle = 1 - \\frac{A^2+1}{(A+1)^2} $$\n$$ \\left\\langle 1 - \\frac{E'}{E} \\right\\rangle = \\frac{(A+1)^2 - (A^2+1)}{(A+1)^2} = \\frac{(A^2+2A+1) - (A^2+1)}{(A+1)^2} = \\frac{2A}{(A+1)^2} $$\n这就是所求的以质量比 $A$ 表示的平均能量损失分数的闭式解析表达式。\n\n最后，我们证明在无限大质量近似（$A \\to \\infty$）下，该损失为零。这对应于中子与无限大质量的原子核发生散射。我们取结果在 $A \\to \\infty$ 时的极限：\n$$ \\lim_{A \\to \\infty} \\left\\langle 1 - \\frac{E'}{E} \\right\\rangle = \\lim_{A \\to \\infty} \\frac{2A}{(A+1)^2} $$\n这是一个有理函数的极限，其中分母的次数（$2$）大于分子的次数（$1$）。为了正式计算它，我们将分子和分母同除以分母中 $A$ 的最高次幂，即 $A^2$：\n$$ \\lim_{A \\to \\infty} \\frac{2A/A^2}{(A+1)^2/A^2} = \\lim_{A \\to \\infty} \\frac{2/A}{(1+1/A)^2} $$\n当 $A \\to \\infty$ 时，项 $1/A \\to 0$。因此，极限为：\n$$ \\frac{0}{(1+0)^2} = 0 $$\n因此，中子与无限大质量的原子核散射时的平均能量损失分数为零，这在物理上是直观的。这种碰撞等效于一个粒子从一个固定的、不可移动的墙壁上反射，没有能量转移。",
            "answer": "$$\n\\boxed{\\frac{2A}{(A+1)^{2}}}\n$$"
        },
        {
            "introduction": "从单次碰撞的微观图像转向完整的反应堆系统，本练习探讨了无限质量近似在中子扩散理论框架下的宏观影响。通过比较单能群模型（在无限质量近似下有效）与考虑了能量降低的双能群模型，我们可以清晰地看到该近似如何通过解耦能群来简化问题。此实践有助于理解在更真实的场景中，不同能群通量之间的内在联系。",
            "id": "4254856",
            "problem": "考虑一个物理厚度为 $L$ 的均匀裸平板反应堆，其空间域为 $x \\in [-L/2,\\,L/2]$。其材料是均匀、各向同性的，并且不随时间变化，反应堆被真空包围。在扩散理论中，平板中的真空边界条件通过外推边界 $x=\\pm\\left(L/2+d\\right)$ 上的外推边界条件来实施，其中 $d$ 是外推距离。在整个问题中，假设材料性质在空间上是恒定的。\n\nA部分（无限质量近似）：在无限质量近似（IMA）中，散射中心具有有效无限的质量，因此中子散射不改变中子能量。因此，能群之间不发生耦合，我们可以处理一个单一能群，其扩散系数为 $D$，宏观吸收截面为 $\\Sigma_{a}$，宏观裂变产生由 $\\nu\\Sigma_{f}$ 表征。从中子平衡和 Fick 定律出发，写出标量通量 $\\phi(x)$ 的一维稳态单能 $k$-特征值扩散方程，并施加外推真空边界条件。推导在 IMA 极限下裸平板的归一化基本空间模态形状 $f(x)$，该函数定义至一个乘法常数。\n\nB部分（有限质量散射体与双能群耦合）：现在放宽 IMA，假设存在有限质量的散射体，使得中子能够从快中子群向下散射到热中子群。使用双能群扩散模型，其中快中子群为 $g=1$，热中子群为 $g=2$，扩散系数分别为 $D_{1}$ 和 $D_{2}$，吸收截面分别为 $\\Sigma_{a1}$ 和 $\\Sigma_{a2}$，以及单向下散射截面 $\\Sigma_{s,1\\to 2}$（无上散射）。假设裂变谱将所有裂变中子置于快中子群中，因此 $\\chi_{1}=1$ 和 $\\chi_{2}=0$。假设两群的材料性质在空间上均匀，且具有相同的真空外推边界条件 $x=\\pm\\left(L/2+d\\right)$。从耦合的双能群中子平衡和 Fick 定律出发，证明在基模下两群共享一个共同的空间本征函数 $f(x)$，并根据 $D_{2}$、$\\Sigma_{a2}$、$\\Sigma_{s,1\\to 2}$、$L$ 和 $d$ 推导热中子群与快中子群振幅比 $R \\equiv A_{2}/A_{1}$ 的闭式解析表达式，其中 $\\phi_{g}(x)=A_{g} f(x)$ 定义了群振幅 $A_{g}$。\n\n答案规范：你的最终答案必须是 $R$ 作为 $D_{2}$、$\\Sigma_{a2}$、$\\Sigma_{s,1\\to 2}$、$L$ 和 $d$ 的函数的单一闭式解析表达式。在最终的方框表达式中不要包含单位。无需四舍五入。作为推导的一部分，清晰地展示每种情况下与外推边界一致的基本模态形状 $f(x)$ 和相应的几何曲率参数。",
            "solution": "此问题经核实具有科学依据、问题明确且客观。它基于反应堆物理学中的标准中子扩散理论。所有必需信息均已提供，问题可通过严格推导得出答案。\n\n**A部分：无限质量近似（IMA）**\n\n对于临界或近临界系统，稳态单能中子平衡方程是使用 $k$-特征值来建立的，该特征值用于缩放裂变源项。平衡关系在于泄漏、吸收和裂变产生之间：\n$$\n\\text{泄漏} + \\text{吸收} = \\frac{1}{k} \\times \\text{产生}\n$$\n在一维空间 $x$ 中，对于中子通量 $\\phi(x)$，这表示为：\n$$\n-\\frac{dJ(x)}{dx} + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu\\Sigma_f \\phi(x)\n$$\n其中 $J(x)$ 是中子流密度，$\\Sigma_a$ 是宏观吸收截面，$\\nu\\Sigma_f$ 代表每次裂变产生的中子数乘以宏观裂变截面。\n\nFick 定律将流密度与通量的梯度联系起来：\n$$\nJ(x) = -D \\frac{d\\phi(x)}{dx}\n$$\n其中 $D$ 是扩散系数。由于材料性质在空间上是恒定的，将 Fick 定律代入平衡方程可得：\n$$\n-\\frac{d}{dx}\\left(-D \\frac{d\\phi(x)}{dx}\\right) + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu\\Sigma_f \\phi(x)\n$$\n$$\nD \\frac{d^2\\phi(x)}{dx^2} + \\left(\\frac{1}{k}\\nu\\Sigma_f - \\Sigma_a\\right) \\phi(x) = 0\n$$\n这是一个齐次二阶常微分方程。它可以被重写为标准的 Helmholtz 形式：\n$$\n\\frac{d^2\\phi(x)}{dx^2} + B^2 \\phi(x) = 0\n$$\n其中 $B^2$ 是材料曲率，定义为：\n$$\nB^2 = B_m^2 = \\frac{\\frac{1}{k}\\nu\\Sigma_f - \\Sigma_a}{D}\n$$\n该方程的通解为 $\\phi(x) = C_1 \\sin(Bx) + C_2 \\cos(Bx)$。对于以 $x=0$ 为中心的对称平板反应堆，基模（最低能量模态）应为 $x$ 的偶函数。这要求奇函数正弦项的系数为零，即 $C_1=0$。因此解的形式为 $\\phi(x) = C_2 \\cos(Bx)$。\n\n真空边界条件施加在外推边界 $x = \\pm(L/2 + d)$ 上，在此处假定通量为零。在 $x = L/2 + d$ 处应用此条件：\n$$\n\\phi\\left(\\frac{L}{2} + d\\right) = C_2 \\cos\\left(B\\left(\\frac{L}{2} + d\\right)\\right) = 0\n$$\n为了得到非平凡解（$C_2 \\neq 0$），余弦函数的宗量必须是 $\\pi/2$ 的奇数倍。对于基模（反应堆内最平滑的非负解），我们取最小的正值：\n$$\nB\\left(\\frac{L}{2} + d\\right) = \\frac{\\pi}{2}\n$$\n该方程确定了满足边界条件所需的 $B$ 的特定值，该值被称为几何曲率 $B_g$。\n$$\nB_g = \\frac{\\pi}{L + 2d}\n$$\n相应的特征值是几何曲率的平方，$B_g^2 = \\left(\\frac{\\pi}{L+2d}\\right)^2$。对于临界反应堆，材料曲率必须等于几何曲率，$B_m^2 = B_g^2$。因此，基本空间模态形状 $f(x)$ 由具有此特定曲率的余弦函数给出：\n$$\nf(x) = \\cos(B_g x) = \\cos\\left(\\frac{\\pi x}{L+2d}\\right)\n$$\n如题目要求，此函数定义至一个乘法常数。\n\n**B部分：有限质量散射体与双能群耦合**\n\n我们现在考虑一个双能群模型，包括快中子群（$g=1$）和热中子群（$g=2$）。耦合的稳态扩散方程是通过为每个能群写出中子平衡方程来建立的。\n\n对于快中子群（$g=1$）：\n$$\n\\text{泄漏}_1 + \\text{吸收}_1 + \\text{移出散射}_1 = \\text{裂变源}_1\n$$\n$$\n-D_1 \\frac{d^2\\phi_1}{dx^2} + \\Sigma_{a1}\\phi_1 + \\Sigma_{s,1\\to 2}\\phi_1 = \\frac{\\chi_1}{k} \\sum_{g'=1}^{2} \\nu\\Sigma_{fg'} \\phi_{g'}\n$$\n鉴于所有裂变中子都以快中子形式产生，$\\chi_1=1$。我们定义群1的移出截面为 $\\Sigma_{R1} = \\Sigma_{a1} + \\Sigma_{s,1\\to 2}$。方程变为：\n$$\n-D_1 \\frac{d^2\\phi_1}{dx^2} + \\Sigma_{R1}\\phi_1 = \\frac{1}{k} (\\nu\\Sigma_{f1}\\phi_1 + \\nu\\Sigma_{f2}\\phi_2)\n$$\n\n对于热中子群（$g=2$）：\n$$\n\\text{泄漏}_2 + \\text{吸收}_2 = \\text{移入散射}_2 + \\text{裂变源}_2\n$$\n$$\n-D_2 \\frac{d^2\\phi_2}{dx^2} + \\Sigma_{a2}\\phi_2 = \\Sigma_{s,1\\to 2}\\phi_1 + \\frac{\\chi_2}{k} \\sum_{g'=1}^{2} \\nu\\Sigma_{fg'} \\phi_{g'}\n$$\n鉴于没有裂变中子以热中子形式产生，$\\chi_2=0$。方程简化为：\n$$\n-D_2 \\frac{d^2\\phi_2}{dx^2} + \\Sigma_{a2}\\phi_2 = \\Sigma_{s,1\\to 2}\\phi_1\n$$\n在均匀反应堆中，空间算子 $\\frac{d^2}{dx^2}$ 对两群是相同的。因此，对于基模解，所有能群的通量共享相同的空间形状（本征函数），仅在常数振幅因子上有所不同。因此我们寻求以下形式的解：\n$$\n\\phi_g(x) = A_g f(x)\n$$\n其中 $f(x)$ 是算子 $\\frac{d^2}{dx^2}$ 在边界条件 $\\phi_g(\\pm(L/2+d)) = 0$ 下的基模本征函数。如A部分所建立，该本征函数为 $f(x) = \\cos(B_g x)$，特征值为 $-B_g^2$，其中 $B_g^2 = \\left(\\frac{\\pi}{L+2d}\\right)^2$。因此，我们有：\n$$\n\\frac{d^2\\phi_g(x)}{dx^2} = A_g \\frac{d^2f(x)}{dx^2} = -A_g B_g^2 f(x)\n$$\n将 $\\phi_1(x) = A_1f(x)$ 和 $\\phi_2(x) = A_2f(x)$ 代入热中子群扩散方程：\n$$\n-D_2 \\frac{d^2}{dx^2}(A_2 f(x)) + \\Sigma_{a2}(A_2 f(x)) = \\Sigma_{s,1\\to 2}(A_1 f(x))\n$$\n$$\n-D_2 A_2 (-B_g^2 f(x)) + \\Sigma_{a2} A_2 f(x) = \\Sigma_{s,1\\to 2} A_1 f(x)\n$$\n空间本征函数 $f(x)$ 不恒为零，因此可以从方程两边消去：\n$$\nD_2 A_2 B_g^2 + \\Sigma_{a2} A_2 = \\Sigma_{s,1\\to 2} A_1\n$$\n$$\nA_2 (D_2 B_g^2 + \\Sigma_{a2}) = A_1 \\Sigma_{s,1\\to 2}\n$$\n现在可以直接从此代数关系中解出热中子群与快中子群振幅比 $R \\equiv A_2/A_1$：\n$$\nR = \\frac{A_2}{A_1} = \\frac{\\Sigma_{s,1\\to 2}}{D_2 B_g^2 + \\Sigma_{a2}}\n$$\n最后，代入几何曲率 $B_g^2$ 的表达式，可得到 $R$ 关于指定参数的闭式表达式：\n$$\nR = \\frac{\\Sigma_{s,1\\to 2}}{D_2 \\left(\\frac{\\pi}{L+2d}\\right)^2 + \\Sigma_{a2}}\n$$\n此结果表明，热中子通量与快中子通量之比取决于热中子的来源（从快中子群向下散射）与热中子的损失（泄漏和吸收）之间的平衡。快中子群参数和裂变性质未出现在此表达式中，因为仅从热中子群的平衡就足以确定通量比，无需这些参数。",
            "answer": "$$\n\\boxed{\\frac{\\Sigma_{s,1\\to 2}}{D_2 \\left(\\frac{\\pi}{L+2d}\\right)^2 + \\Sigma_{a2}}}\n$$"
        },
        {
            "introduction": "本练习旨在连接理论与现代计算实践，探讨了在精度至关重要的蒙特卡罗模拟中使用无限质量近似的实际后果。你将推导此近似对统计量（tally）引入的精确误差（偏差）以及一个一阶修正项。这项实践不仅揭示了近似的局限性，还提供了一种在实际模拟程序中评估甚至修正其影响的工具。",
            "id": "4254862",
            "problem": "考虑在核反应堆模拟中的一次碰撞中子能谱计数，其中使用无限质量近似（IMA）代替有限质量弹性散射。在 IMA 中，靶核被视为具有无限质量，因此中子能量在散射过程中保持不变。在与静止的有限质量靶核的实际弹性碰撞中，出射中子的能量取决于靶核与中子的质量比以及质心坐标系中的散射角。令靶核与中子的质量比表示为 $A$，入射中子能量（单位为 $\\mathrm{eV}$）表示为 $E$，质心散射余弦表示为 $\\mu \\in [-1,1]$。所研究的计数为 $g(E) = E^p$，其中 $p$ 为给定的实数指数。\n\n使用基本原理：\n- 从双体弹性碰撞的线动量守恒和动能守恒，以及质心坐标系的定义出发。\n- 对于静止靶，使用从质心坐标系到实验室坐标系的变换，将出射中子的实验室能量 $E'$ 与入射能量 $E$、质量比 $A$ 和质心散射余弦 $\\mu$ 联系起来。\n- 假设在质心坐标系中散射是各向同性的，因此 $\\mu$ 在 $[-1,1]$ 上均匀分布。\n\n任务：\n1. 从上述基本原理出发，推导弹性散射中 $E'/E$ 关于 $A$ 和 $\\mu$ 的精确表达式，并证明 $E'/E$ 的最终分布是在区间 $[\\alpha, 1]$ 上的均匀分布，其中 $\\alpha = \\left(\\frac{A-1}{A+1}\\right)^2$。\n2. 使用此分布，计算对于通用实数 $p \\neq -1$ 的精确期望值 $\\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle$，然后计算 IMA 能谱计数中的精确偏差，其定义为\n$$\n\\text{Bias}_{\\text{exact}}(E,A,p) = g(E) - \\mathbb{E}[g(E')] = E^p \\left(1 - \\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle \\right),\n$$\n其中 $E$ 以 $\\mathrm{eV}$ 为单位，偏差以 $\\mathrm{eV}^p$ 为单位。\n3. 从精确的 $E'/E$ 公式出发，对 $1/A$进行一阶展开，以获得形式为\n$$\n\\frac{E'}{E} \\approx 1 + \\frac{1}{A} \\, \\delta(\\mu),\n$$\n的近似，其中 $\\delta(\\mu)$ 是一个待通过推导确定的关于 $\\mu$ 的函数。使用 $g(E')$ 在 $E$ 附近的一阶泰勒展开\n$$\ng(E') \\approx g(E) + g'(E) \\, (E' - E),\n$$\n构建一个依赖于 $A$、$\\mu$ 和 $E$ 的计数贡献的一阶修正估计量，并针对 $g(E) = E^p$ 的情况进行显式简化。在质心各向同性散射下，计算预期的一阶偏差估计\n$$\n\\text{Bias}_{\\text{fo}}(E,A,p) \\quad \\text{in} \\quad \\mathrm{eV}^p.\n$$\n\n实现要求：\n- 您的程序必须实现您推导出的公式，以计算每个测试用例 $(E,A,p)$ 的三个量：$\\text{Bias}_{\\text{exact}}(E,A,p)$、$\\text{Bias}_{\\text{fo}}(E,A,p)$ 和绝对误差 $|\\text{Bias}_{\\text{fo}}(E,A,p) - \\text{Bias}_{\\text{exact}}(E,A,p)|$。所有偏差都必须以 $\\mathrm{eV}^p$ 为单位表示。\n- 角度单位：散射余弦 $\\mu$ 是无量纲的；没有需要用度或弧度表示的角度。\n- 测试套件：使用以下特定参数集，其中 $E$ 的单位为 $\\mathrm{eV}$。\n    - 案例1（重靶，典型快能）：$(E,A,p) = (10^6, 238, 1)$。\n    - 案例2（中等质量靶，典型快能）：$(E,A,p) = (10^6, 12, 1)$。\n    - 案例3（轻靶，极端能量损失情况）：$(E,A,p) = (10^6, 1, 1)$。\n    - 案例4（重靶，非线性计数，热能）：$(E,A,p) = (2.53 \\times 10^{-2}, 56, 2)$。\n    - 案例5（中等质量靶，分数计数指数）：$(E,A,p) = (10^3, 16, 0.5)$。\n    - 案例6（轻-中等质量靶，边界计数指数）：$(E,A,p) = (10^4, 2, 0)$。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，按顺序输出三个浮点数：$\\text{Bias}_{\\text{exact}}$、$\\text{Bias}_{\\text{fo}}$、 $|\\text{Bias}_{\\text{fo}} - \\text{Bias}_{\\text{exact}}|$，并将所有六个案例的结果平铺展开。即，打印\n$$\n[\\text{b}_{1,\\text{exact}},\\text{b}_{1,\\text{fo}},|\\text{b}_{1,\\text{fo}}-\\text{b}_{1,\\text{exact}}|,\\ldots,\\text{b}_{6,\\text{exact}},\\text{b}_{6,\\text{fo}},|\\text{b}_{6,\\text{fo}}-\\text{b}_{6,\\text{exact}}|],\n$$\n其中每个 $\\text{b}$ 是一个以 $\\mathrm{eV}^p$ 为单位的浮点数。",
            "solution": "该问题要求推导和计算在一次中子散射计数中，由无限质量近似（IMA）引入的偏差。这涉及三个任务：推导精确的能量关系及其分布，计算精确偏差，以及推导偏差的一阶近似。\n\n### 任务1：散射后能量比 $E'/E$ 的推导\n\n我们考虑一个质量为 $m$、初始速度为 $\\vec{v}$（在实验室坐标系，即 LAB 坐标系中）的中子与一个初始静止（$\\vec{V}=0$）的质量为 $M=Am$ 的靶核之间的非相对论性弹性碰撞。入射中子能量为 $E=\\frac{1}{2}mv^2$。\n\n质心（COM）的速度在整个碰撞过程中是恒定的：\n$$\n\\vec{v}_{cm} = \\frac{m\\vec{v} + M\\vec{V}}{m+M} = \\frac{m\\vec{v}}{m+Am} = \\frac{1}{A+1}\\vec{v}\n$$\n在质心坐标系中的初始速度是：\n$$\n\\vec{u}_n = \\vec{v} - \\vec{v}_{cm} = \\vec{v} - \\frac{1}{A+1}\\vec{v} = \\frac{A}{A+1}\\vec{v}\n$$\n$$\n\\vec{u}_T = \\vec{V} - \\vec{v}_{cm} = -\\frac{1}{A+1}\\vec{v}\n$$\n在弹性碰撞中，动能在质心坐标系中是守恒的，这意味着粒子在该坐标系中碰撞前后的速度大小相等。中子速度的方向发生改变。设中子在质心坐标系中的末速度为 $\\vec{u}'_n$。我们有 $|\\vec{u}'_n| = |\\vec{u}_n| = \\frac{A}{A+1}v$。$\\vec{u}'_n$ 与初始运动方向 $\\vec{u}_n$ 之间的夹角是质心散射角 $\\theta_{cm}$。其余弦为 $\\mu = \\cos(\\theta_{cm})$。\n\n中子在实验室坐标系中的末速度 $\\vec{v}'$ 可通过从质心坐标系变换回来得到：\n$$\n\\vec{v}' = \\vec{u}'_n + \\vec{v}_{cm}\n$$\n在实验室坐标系中的末动能为 $E' = \\frac{1}{2}m|\\vec{v}'|^2$。我们计算末速率的平方：\n$$\n|\\vec{v}'|^2 = \\vec{v}' \\cdot \\vec{v}' = (\\vec{u}'_n + \\vec{v}_{cm}) \\cdot (\\vec{u}'_n + \\vec{v}_{cm}) = |\\vec{u}'_n|^2 + |\\vec{v}_{cm}|^2 + 2\\vec{u}'_n \\cdot \\vec{v}_{cm}\n$$\n代入大小和点积 $\\vec{u}'_n \\cdot \\vec{v}_{cm} = |\\vec{u}'_n||\\vec{v}_{cm}|\\cos(\\theta_{cm}) = |\\vec{u}'_n||\\vec{v}_{cm}|\\mu$：\n$$\n|\\vec{v}'|^2 = \\left(\\frac{A}{A+1}v\\right)^2 + \\left(\\frac{1}{A+1}v\\right)^2 + 2\\left(\\frac{A}{A+1}v\\right)\\left(\\frac{1}{A+1}v\\right)\\mu\n$$\n$$\n|\\vec{v}'|^2 = \\frac{v^2}{(A+1)^2}(A^2 + 1 + 2A\\mu)\n$$\n出射能量与入射能量之比 $E'/E$ 为：\n$$\n\\frac{E'}{E} = \\frac{\\frac{1}{2}m|\\vec{v}'|^2}{\\frac{1}{2}mv^2} = \\frac{|\\vec{v}'|^2}{v^2} = \\frac{A^2+1+2A\\mu}{(A+1)^2}\n$$\n这就是所要求的表达式。假设在质心坐标系中散射是各向同性的，$\\mu$ 在 $[-1,1]$ 上均匀分布。由于 $E'/E$ 是 $\\mu$ 的线性函数，所以 $E'/E$ 的分布也是均匀的。$E'/E$ 的取值范围可以通过计算 $\\mu$ 区间端点的值得到：\n-   最大值（在 $\\mu=1$ 时）：$\\frac{E'}{E}\\Big|_{\\mu=1} = \\frac{A^2+1+2A}{(A+1)^2} = \\frac{(A+1)^2}{(A+1)^2} = 1$。\n-   最小值（在 $\\mu=-1$ 时）：$\\frac{E'}{E}\\Big|_{\\mu=-1} = \\frac{A^2+1-2A}{(A+1)^2} = \\frac{(A-1)^2}{(A+1)^2} = \\left(\\frac{A-1}{A+1}\\right)^2$。\n\n令 $\\alpha = \\left(\\frac{A-1}{A+1}\\right)^2$。能量比 $E'/E$ 服从区间 $[\\alpha, 1]$ 上的均匀分布。对于 $x=E'/E$，其概率密度函数为 $f(x) = \\frac{1}{1-\\alpha}$，其中 $x \\in [\\alpha, 1]$。\n\n### 任务2：精确偏差计算\n\n计数为 $g(E) = E^p$。IMA 假设 $E'=E$，因此 IMA 的计数贡献为 $g(E)$。精确的期望计数贡献为 $\\mathbb{E}[g(E')]$。\n$$\n\\mathbb{E}[g(E')] = \\mathbb{E}[(E')^p] = \\mathbb{E}[(E \\cdot E'/E)^p] = E^p \\mathbb{E}[(E'/E)^p] = E^p \\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle\n$$\n我们使用其均匀分布来计算 $(E'/E)^p$ 的期望值。对于通用实数指数 $p \\neq -1$：\n$$\n\\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle = \\int_\\alpha^1 x^p f(x) dx = \\int_\\alpha^1 x^p \\frac{1}{1-\\alpha} dx = \\frac{1}{1-\\alpha} \\left[ \\frac{x^{p+1}}{p+1} \\right]_\\alpha^1 = \\frac{1-\\alpha^{p+1}}{(p+1)(1-\\alpha)}\n$$\n精确偏差定义为 $\\text{Bias}_{\\text{exact}}(E,A,p) = g(E) - \\mathbb{E}[g(E')]$。\n$$\n\\text{Bias}_{\\text{exact}}(E,A,p) = E^p - E^p \\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle = E^p \\left( 1 - \\frac{1-\\alpha^{p+1}}{(p+1)(1-\\alpha)} \\right)\n$$\n其中 $\\alpha = \\left(\\frac{A-1}{A+1}\\right)^2$。这就是精确偏差的最终表达式。\n\n### 任务3：一阶偏差近似\n\n我们从 $E'/E$ 的精确表达式开始，并将其对 $1/A$ 做一阶展开。\n$$\n\\frac{E'}{E} = \\frac{A^2+1+2A\\mu}{(A+1)^2} = \\frac{1+1/A^2+2\\mu/A}{(1+1/A)^2} = (1+2\\mu A^{-1} + A^{-2})(1+A^{-1})^{-2}\n$$\n对于小的 $x$，使用泰勒展开 $(1+x)^n \\approx 1+nx$，我们有 $(1+A^{-1})^{-2} \\approx 1-2A^{-1}$。\n$$\n\\frac{E'}{E} \\approx (1+2\\mu A^{-1})(1-2A^{-1}) = 1 - 2A^{-1} + 2\\mu A^{-1} - 4\\mu A^{-2} \\approx 1 + \\frac{2(\\mu-1)}{A}\n$$\n这具有 $1 + \\frac{1}{A}\\delta(\\mu)$ 的形式，其中 $\\delta(\\mu) = 2(\\mu-1)$。\n\n接下来，我们使用 $g(E')$ 在 $E$ 附近的一阶泰勒展开：\n$$\ng(E') \\approx g(E) + g'(E)(E'-E)\n$$\n一阶偏差 $\\text{Bias}_{\\text{fo}}$ 是 $g(E) - g(E')$ 的期望值，使用此展开式进行近似。\n$$\n\\text{Bias}_{\\text{fo}} = \\mathbb{E}[g(E) - g(E')] \\approx \\mathbb{E}[g(E) - (g(E) + g'(E)(E'-E))] = -\\mathbb{E}[g'(E)(E'-E)]\n$$\n使用一阶近似 $E'-E = E(E'/E - 1) \\approx E \\frac{2(\\mu-1)}{A}$：\n$$\n\\text{Bias}_{\\text{fo}} \\approx -\\mathbb{E}\\left[g'(E) \\cdot E \\frac{2(\\mu-1)}{A}\\right]\n$$\n由于 $E$、$A$ 和 $g'(E)$ 相对于随机变量 $\\mu$ 是常数，我们可以将它们从期望中提出：\n$$\n\\text{Bias}_{\\text{fo}} = -g'(E) \\frac{2E}{A} \\mathbb{E}[\\mu-1] = -g'(E) \\frac{2E}{A} (\\mathbb{E}[\\mu]-1)\n$$\n对于各向同性散射，$\\mu$ 在 $[-1,1]$ 上均匀分布，因此其期望为 $\\mathbb{E}[\\mu] = \\int_{-1}^1 \\mu (1/2) d\\mu = 0$。\n$$\n\\text{Bias}_{\\text{fo}} = -g'(E) \\frac{2E}{A} (0-1) = g'(E) \\frac{2E}{A}\n$$\n对于特定的计数 $g(E) = E^p$，其导数为 $g'(E) = pE^{p-1}$。\n$$\n\\text{Bias}_{\\text{fo}}(E,A,p) = (pE^{p-1}) \\frac{2E}{A} = \\frac{2pE^p}{A}\n$$\n这是一阶偏差的最终表达式。\n\n### 用于实现的公式摘要\n1.  **精确偏差：**\n    $$\n    \\text{Bias}_{\\text{exact}}(E,A,p) = E^p \\left( 1 - \\frac{1-\\alpha^{p+1}}{(p+1)(1-\\alpha)} \\right) \\quad \\text{with} \\quad \\alpha = \\left(\\frac{A-1}{A+1}\\right)^2\n    $$\n2.  **一阶偏差：**\n    $$\n    \\text{Bias}_{\\text{fo}}(E,A,p) = \\frac{2pE^p}{A}\n    $$\n对于 $p=0$ 的特殊情况，$g(E)=E^0=1$ 是一个常数计数。IMA 的分值为 $1$，真实的期望分值为 $\\mathbb{E}[(E')^0] = \\mathbb{E}[1]=1$。因此，两种偏差都精确为 $0$。推导出的公式在 $p=0$ 时也得到 $0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the exact and first-order bias for the Infinite Mass Approximation\n    in neutron scattering for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (E, A, p)\n        # Case 1 (heavy target, typical fast energy)\n        (1.0e6, 238.0, 1.0),\n        # Case 2 (moderate target, typical fast energy)\n        (1.0e6, 12.0, 1.0),\n        # Case 3 (light target, extreme energy loss case)\n        (1.0e6, 1.0, 1.0),\n        # Case 4 (heavy target, nonlinear tally, thermal energy)\n        (2.53e-2, 56.0, 2.0),\n        # Case 5 (moderate target, fractional tally exponent)\n        (1.0e3, 16.0, 0.5),\n        # Case 6 (light-moderate target, boundary tally exponent)\n        (1.0e4, 2.0, 0.0),\n    ]\n\n    results = []\n    for E, A, p in test_cases:\n        # For p=0, g(E) = E^0 = 1 is constant.\n        # The IMA score is 1, and the true expected score is E[(E')^0] = E[1] = 1.\n        # Thus, bias is zero for both exact and first-order models.\n        if p == 0.0:\n            bias_exact = 0.0\n            bias_fo = 0.0\n            abs_error = 0.0\n            results.extend([bias_exact, bias_fo, abs_error])\n            continue\n\n        # Calculate exact bias using the derived formula:\n        # Bias_exact = E^p * (1 - (1 - alpha^(p+1)) / ((p+1)*(1-alpha)))\n        # where alpha = ((A-1)/(A+1))^2\n        alpha = ((A - 1.0) / (A + 1.0))**2\n        \n        # A numerically stable way to compute 1-alpha is 4A/(A+1)^2.\n        # This avoids catastrophic cancellation when A is large (alpha is near 1).\n        if A > 1.0:\n            one_minus_alpha = 4.0 * A / (A + 1.0)**2\n        else: # A == 1.0, so alpha is 0\n            one_minus_alpha = 1.0\n\n        # The term with (p+1) in the denominator is valid since p != -1 is given.\n        expectation_term = (1.0 - alpha**(p + 1.0)) / ((p + 1.0) * one_minus_alpha)\n        \n        bias_exact = E**p * (1.0 - expectation_term)\n\n        # Calculate first-order bias using the derived formula:\n        # Bias_fo = 2*p*E^p / A\n        bias_fo = (2.0 * p * (E**p)) / A\n\n        # Calculate the absolute error between the two bias estimates\n        abs_error = abs(bias_fo - bias_exact)\n\n        results.extend([bias_exact, bias_fo, abs_error])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}