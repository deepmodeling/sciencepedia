{
    "hands_on_practices": [
        {
            "introduction": "任何物理近似的背后都有其深刻的物理基础。该练习将引导您回归到弹性碰撞的基本物理学原理，即动量和动能守恒。通过从第一性原理推导中子与原子核碰撞后的平均能量损失，并证明当靶核质量趋于无穷大时能量损失为零，您将深刻理解无限质量近似在物理上等同于假设散射过程中没有能量转移的本质。",
            "id": "4254917",
            "problem": "在核反应堆模拟的中子慢化背景下，考虑一个质量为 $m$ 的中子与一个质量为 $M$ 的静止靶核发生弹性碰撞，其质量比为 $A=M/m$。设实验室坐标系中中子的初始动能为 $E$，碰撞后中子的能量为 $E'$。假设在质心（CM）坐标系中散射是弹性的且是各向同性的，这意味着在质心坐标系中，散射在立体角上是均匀的，因此在 $\\cos\\theta_{\\mathrm{CM}} \\in [-1,1]$上是均匀的，其中 $\\theta_{\\mathrm{CM}}$ 是质心坐标系中的散射角。\n\n从动能和动量守恒出发，并使用实验室坐标系和质心（CM）坐标系之间的伽利略变换，推导实验室坐标系能量比 $E'/E$ 对质心坐标系散射余弦 $\\mu=\\cos\\theta_{\\mathrm{CM}}$ 的函数依赖关系。然后，计算每次碰撞的平均能量损失分数，\n$$\\left\\langle 1 - \\frac{E'}{E} \\right\\rangle,$$\n通过对有限质量比 $A$ 在质心坐标系中的各向同性散射进行平均。将你的最终结果表示为以 $A$ 为变量的封闭形式解析表达式。最后，使用你推导出的表达式，从第一性原理证明，在无限大质量近似 $A \\to \\infty$ 下，该平均能量损失分数为零。\n\n以 $A$ 为变量的单个封闭形式表达式提供你的最终答案。不需要数值近似或四舍五入。",
            "solution": "该问题被评估为有效，因为它具有科学依据、提法明确、客观且自成体系。解题过程如下。\n\n问题要求推导中子与静止原子核发生弹性碰撞时的平均能量损失分数。设中子质量为 $m$，在实验室（lab）坐标系中的初始速度为 $\\vec{v}_n$。靶核质量为 $M$，初始时静止，$\\vec{v}_N = \\vec{0}$。质量比定义为 $A = M/m$。中子的初始动能为 $E = \\frac{1}{2}m|\\vec{v}_n|^2$。\n\n首先，我们转换到质心（CM）坐标系。质心的速度由下式给出：\n$$ \\vec{v}_{\\mathrm{CM}} = \\frac{m\\vec{v}_n + M\\vec{v}_N}{m+M} = \\frac{m\\vec{v}_n}{m+M} = \\frac{1}{1+A}\\vec{v}_n $$\n中子和原子核在质心坐标系中的初始速度为：\n$$ \\vec{u}_n = \\vec{v}_n - \\vec{v}_{\\mathrm{CM}} = \\vec{v}_n - \\frac{1}{1+A}\\vec{v}_n = \\left(1 - \\frac{1}{1+A}\\right)\\vec{v}_n = \\frac{A}{1+A}\\vec{v}_n $$\n$$ \\vec{u}_N = \\vec{v}_N - \\vec{v}_{\\mathrm{CM}} = \\vec{0} - \\frac{1}{1+A}\\vec{v}_n = -\\frac{1}{1+A}\\vec{v}_n $$\n在质心坐标系中，总动量为零，可以验证：$m\\vec{u}_n + M\\vec{u}_N = m\\left(\\frac{A}{1+A}\\vec{v}_n\\right) + M\\left(-\\frac{1}{1+A}\\vec{v}_n\\right) = \\frac{mA - M}{1+A}\\vec{v}_n = \\frac{M-M}{1+A}\\vec{v}_n = \\vec{0}$。\n\n对于弹性碰撞，动能在任何惯性系中都是守恒的。在质心坐标系中，这意味着粒子的速率在碰撞中不变，尽管它们的方向会改变。设碰撞后在质心坐标系中的速度为 $\\vec{u}_n'$ 和 $\\vec{u}_N'$。那么，我们有：\n$$ |\\vec{u}_n'| = |\\vec{u}_n| = \\frac{A}{1+A}v_n $$\n其中 $v_n = |\\vec{v}_n|$。质心坐标系中的散射角 $\\theta_{\\mathrm{CM}}$ 是该坐标系中初始和最终中子速度之间的夹角，即 $\\vec{u}_n$ 和 $\\vec{u}_n'$ 之间的夹角。\n\n为了求出实验室坐标系中的最终中子能量 $E'$，我们将最终中子速度从质心坐标系转换回实验室坐标系：\n$$ \\vec{v}_n' = \\vec{u}_n' + \\vec{v}_{\\mathrm{CM}} $$\n实验室坐标系中的最终动能为 $E' = \\frac{1}{2}m|\\vec{v}_n'|^2$。我们计算最终速率的平方：\n$$ |\\vec{v}_n'|^2 = \\vec{v}_n' \\cdot \\vec{v}_n' = (\\vec{u}_n' + \\vec{v}_{\\mathrm{CM}}) \\cdot (\\vec{u}_n' + \\vec{v}_{\\mathrm{CM}}) = |\\vec{u}_n'|^2 + |\\vec{v}_{\\mathrm{CM}}|^2 + 2\\vec{u}_n' \\cdot \\vec{v}_{\\mathrm{CM}} $$\n让我们计算每一项。\n- $|\\vec{u}_n'|^2 = |\\vec{u}_n|^2 = \\left(\\frac{A}{1+A}v_n\\right)^2 = \\frac{A^2}{(A+1)^2}v_n^2$。\n- $|\\vec{v}_{\\mathrm{CM}}|^2 = \\left(\\frac{1}{1+A}v_n\\right)^2 = \\frac{1}{(A+1)^2}v_n^2$。\n- 点积项取决于散射角 $\\theta_{\\mathrm{CM}}$。向量 $\\vec{v}_{\\mathrm{CM}}$ 与初始中子速度 $\\vec{v}_n$ 平行，因此也与 $\\vec{u}_n$ 平行。因此，$\\vec{u}_n'$ 和 $\\vec{v}_{\\mathrm{CM}}$ 之间的夹角是 $\\theta_{\\mathrm{CM}}$。设 $\\mu = \\cos\\theta_{\\mathrm{CM}}$。\n$$ \\vec{u}_n' \\cdot \\vec{v}_{\\mathrm{CM}} = |\\vec{u}_n'||\\vec{v}_{\\mathrm{CM}}|\\cos\\theta_{\\mathrm{CM}} = \\left(\\frac{A}{1+A}v_n\\right)\\left(\\frac{1}{1+A}v_n\\right)\\mu = \\frac{A}{(A+1)^2}v_n^2\\mu $$\n将这些代入 $|\\vec{v}_n'|^2$ 的表达式中：\n$$ |\\vec{v}_n'|^2 = \\frac{A^2}{(A+1)^2}v_n^2 + \\frac{1}{(A+1)^2}v_n^2 + 2\\frac{A}{(A+1)^2}v_n^2\\mu = \\frac{A^2+1+2A\\mu}{(A+1)^2}v_n^2 $$\n最终能量与初始能量之比为：\n$$ \\frac{E'}{E} = \\frac{\\frac{1}{2}m|\\vec{v}_n'|^2}{\\frac{1}{2}m|\\vec{v}_n|^2} = \\frac{|\\vec{v}_n'|^2}{v_n^2} = \\frac{A^2+2A\\mu+1}{(A+1)^2} $$\n这就是能量比对质心坐标系散射余弦 $\\mu$ 的函数依赖关系。\n\n接下来，我们计算平均能量损失分数 $\\left\\langle 1 - \\frac{E'}{E} \\right\\rangle$。这需要对所有可能的散射结果进行平均。问题指出，在质心坐标系中散射是各向同性的，这意味着散射到给定立体角内的概率是均匀的。这表明 $\\mu = \\cos\\theta_{\\mathrm{CM}}$ 的概率分布函数在区间 $[-1, 1]$ 上是均匀的。归一化的概率密度函数为 $p(\\mu) = 1/2$ (对于 $\\mu \\in [-1, 1]$)。\n\n能量比的平均值 $\\langle E'/E \\rangle$ 为：\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\int_{-1}^{1} \\frac{E'}{E}(\\mu) p(\\mu) d\\mu = \\int_{-1}^{1} \\left( \\frac{A^2+2A\\mu+1}{(A+1)^2} \\right) \\frac{1}{2} d\\mu $$\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\frac{1}{2(A+1)^2} \\int_{-1}^{1} (A^2+1+2A\\mu) d\\mu $$\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\frac{1}{2(A+1)^2} \\left[ (A^2+1)\\mu + A\\mu^2 \\right]_{-1}^{1} $$\n计算定积分在上下限处的值：\n$$ \\left[ (A^2+1)(1) + A(1)^2 \\right] - \\left[ (A^2+1)(-1) + A(-1)^2 \\right] = (A^2+A+1) - (-A^2-1+A) = 2A^2+2 = 2(A^2+1) $$\n将此结果代回：\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\frac{1}{2(A+1)^2} \\cdot 2(A^2+1) = \\frac{A^2+1}{(A+1)^2} $$\n那么，平均能量损失分数为：\n$$ \\left\\langle 1 - \\frac{E'}{E} \\right\\rangle = 1 - \\left\\langle \\frac{E'}{E} \\right\\rangle = 1 - \\frac{A^2+1}{(A+1)^2} $$\n$$ \\left\\langle 1 - \\frac{E'}{E} \\right\\rangle = \\frac{(A+1)^2 - (A^2+1)}{(A+1)^2} = \\frac{(A^2+2A+1) - (A^2+1)}{(A+1)^2} = \\frac{2A}{(A+1)^2} $$\n这就是所要求的以质量比 $A$ 表示的平均能量损失分数的封闭形式解析表达式。\n\n最后，我们证明在无限大质量近似（$A \\to \\infty$）下，该损失为零。这对应于一个中子与一个无限大质量的原子核发生散射。我们取结果在 $A \\to \\infty$ 时的极限：\n$$ \\lim_{A \\to \\infty} \\left\\langle 1 - \\frac{E'}{E} \\right\\rangle = \\lim_{A \\to \\infty} \\frac{2A}{(A+1)^2} $$\n这是一个有理函数的极限，其中分母的次数（2）大于分子的次数（1）。为了形式上计算它，我们将分子和分母同除以分母中 $A$ 的最高次幂，即 $A^2$：\n$$ \\lim_{A \\to \\infty} \\frac{2A/A^2}{(A+1)^2/A^2} = \\lim_{A \\to \\infty} \\frac{2/A}{(1+1/A)^2} $$\n当 $A \\to \\infty$ 时，项 $1/A \\to 0$。因此，极限为：\n$$ \\frac{0}{(1+0)^2} = 0 $$\n因此，中子与无限大质量原子核散射的平均能量损失分数为零，这在物理上是直观的。该碰撞等效于一个粒子从一个固定的、不可移动的墙壁上反射，没有能量传递。",
            "answer": "$$\n\\boxed{\\frac{2A}{(A+1)^{2}}}\n$$"
        },
        {
            "introduction": "在反应堆物理学中，近似的主要价值在于它能将复杂的问题简化，从而让我们能够抓住核心的物理图像。该练习将展示无限质量近似在反应堆分析中的一个关键简化作用：它使得中子扩散方程中的能量群解耦。通过求解一个裸平板反应堆中的中子通量密度分布，您将对比使用无限质量近似的单群模型和更真实的两群模型，从而直观地看到该近似对反应堆行为预测（如热中子通量峰的形成）的影响。",
            "id": "4254856",
            "problem": "考虑一个均匀的裸板反应堆，其物理厚度为 $L$，占据空间域 $x \\in [-L/2,\\,L/2]$。该反应堆的材料是均匀、各向同性且不随时间变化的，并被真空包围。在扩散理论中，板状反应堆的真空边界条件通过在外推边界 $x=\\pm\\left(L/2+d\\right)$ 处施加外推边界条件来实现，其中 $d$ 是外推距离。在整个问题中，假设材料性质在空间上是恒定的。\n\nA部分（无限质量近似）：在无限质量近似（IMA）中，散射中心的质量可视为无限大，因此中子散射不改变中子能量。因此，能群之间不发生耦合，我们可以处理一个单一能群，其扩散系数为 $D$，宏观吸收截面为 $\\Sigma_{a}$，宏观裂变产生由 $\\nu\\Sigma_{f}$ 表征。从中子平衡和菲克定律出发，为标量通量 $\\phi(x)$ 写出一维空间中的稳态单速 $k$-本征值扩散方程，并施加外推真空边界条件。推导在 IMA 极限下裸板反应堆的归一化基波空间模态形状 $f(x)$，该函数定义可相差一个乘法常数。\n\nB部分（有限质量散射体与双群耦合）：现在放宽 IMA，假设存在有限质量的散射体，使得中子能够从快中子群慢化散射到热中子群。使用双能群扩散模型，其中快中子群为 $g=1$，热中子群为 $g=2$，扩散系数分别为 $D_{1}$ 和 $D_{2}$，吸收截面分别为 $\\Sigma_{a1}$ 和 $\\Sigma_{a2}$，以及一个单向散射截面 $\\Sigma_{s,1\\to 2}$（无上散射）。设裂变谱将所有裂变中子置于快中子群中，因此 $\\chi_{1}=1$ 且 $\\chi_{2}=0$。假设材料性质在空间上均匀，并且两个群采用相同的真空外推边界条件 $x=\\pm\\left(L/2+d\\right)$。从耦合的双群中子平衡和菲克定律出发，证明在基波模态下，两个群共享一个共同的空间本征函数 $f(x)$，并推导热中子群与快中子群振幅比 $R \\equiv A_{2}/A_{1}$ 的闭式解析表达式，该表达式用 $D_{2}$、$\\Sigma_{a2}$、$\\Sigma_{s,1\\to 2}$、$L$ 和 $d$ 表示，其中 $\\phi_{g}(x)=A_{g} f(x)$ 定义了群振幅 $A_{g}$。\n\n答案要求：您的最终答案必须是 $R$ 作为 $D_{2}$、$\\Sigma_{a2}$、$\\Sigma_{s,1\\to 2}$、$L$ 和 $d$ 的函数的单一闭式解析表达式。最终方框内的表达式不应包含单位。无需四舍五入。作为推导的一部分，请清楚地展示每种情况下基波模态的形状 $f(x)$ 以及与外推边界一致的相应几何曲率参数。",
            "solution": "该问题经核实具有科学依据，提法得当且客观。它基于反应堆物理学中的标准中子扩散理论。所有必需的信息均已提供，问题可通过严格推导来解答。\n\n**A部分：无限质量近似 (IMA)**\n\n对于临界或近临界系统，稳态单速中子平衡方程是使用 $k$-本征值来构建的，该本征值用于缩放裂变源项。平衡关系存在于泄漏、吸收和裂变产生之间：\n$$\n\\text{泄漏} + \\text{吸收} = \\frac{1}{k} \\times \\text{产生}\n$$\n在一维空间 $x$ 中，这对于中子通量 $\\phi(x)$ 表示为：\n$$\n-\\frac{dJ(x)}{dx} + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu\\Sigma_f \\phi(x)\n$$\n其中 $J(x)$ 是中子流，$\\Sigma_a$ 是宏观吸收截面，$\\nu\\Sigma_f$ 代表每次裂变产生的中子数乘以宏观裂变截面。\n\n菲克定律将中子流与通量的梯度关联起来：\n$$\nJ(x) = -D \\frac{d\\phi(x)}{dx}\n$$\n其中 $D$ 是扩散系数。由于材料性质在空间上是恒定的，将菲克定律代入平衡方程得到：\n$$\n-\\frac{d}{dx}\\left(-D \\frac{d\\phi(x)}{dx}\\right) + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu\\Sigma_f \\phi(x)\n$$\n$$\nD \\frac{d^2\\phi(x)}{dx^2} + \\left(\\frac{1}{k}\\nu\\Sigma_f - \\Sigma_a\\right) \\phi(x) = 0\n$$\n这是一个齐次二阶常微分方程。它可以被重写为标准的亥姆霍兹形式：\n$$\n\\frac{d^2\\phi(x)}{dx^2} + B^2 \\phi(x) = 0\n$$\n其中 $B^2$ 是材料曲率，定义为：\n$$\nB^2 = B_m^2 = \\frac{\\frac{1}{k}\\nu\\Sigma_f - \\Sigma_a}{D}\n$$\n该方程的通解是 $\\phi(x) = C_1 \\sin(Bx) + C_2 \\cos(Bx)$。对于一个以 $x=0$ 为中心的对称板状反应堆，基波（最低能量）模态应为 $x$ 的偶函数。这要求奇函数正弦项的系数为零，即 $C_1=0$。因此解的形式为 $\\phi(x) = C_2 \\cos(Bx)$。\n\n真空边界条件施加在外推边界 $x = \\pm(L/2 + d)$ 上，此处假定通量为零。在 $x = L/2 + d$ 处应用此条件：\n$$\n\\phi\\left(\\frac{L}{2} + d\\right) = C_2 \\cos\\left(B\\left(\\frac{L}{2} + d\\right)\\right) = 0\n$$\n为了得到非平凡解（$C_2 \\neq 0$），余弦函数的自变量必须是 $\\pi/2$ 的奇数倍。对于基波模态（反应堆内最平滑的非负解），我们取最小的正值：\n$$\nB\\left(\\frac{L}{2} + d\\right) = \\frac{\\pi}{2}\n$$\n该方程确定了满足边界条件所需的 $B$ 的特定值，该值被称为几何曲率 $B_g$。\n$$\nB_g = \\frac{\\pi}{L + 2d}\n$$\n相应的本征值是几何曲率的平方，$B_g^2 = \\left(\\frac{\\pi}{L+2d}\\right)^2$。对于临界反应堆，材料曲率必须等于几何曲率，即 $B_m^2 = B_g^2$。因此，基波空间模态形状 $f(x)$ 由具有此特定曲率的余弦函数给出：\n$$\nf(x) = \\cos(B_g x) = \\cos\\left(\\frac{\\pi x}{L+2d}\\right)\n$$\n如题目要求，该函数可相差一个乘法常数。\n\n**B部分：有限质量散射体与双群耦合**\n\n我们现在考虑一个双群模型，包含一个快中子群（$g=1$）和一个热中子群（$g=2$）。通过为每个群写出中子平衡，可以构建耦合的稳态扩散方程。\n\n对于快中子群（$g=1$）：\n$$\n\\text{泄漏}_1 + \\text{吸收}_1 + \\text{移出散射}_1 = \\text{裂变源}_1\n$$\n$$\n-D_1 \\frac{d^2\\phi_1}{dx^2} + \\Sigma_{a1}\\phi_1 + \\Sigma_{s,1\\to 2}\\phi_1 = \\frac{\\chi_1}{k} \\sum_{g'=1}^{2} \\nu\\Sigma_{fg'} \\phi_{g'}\n$$\n鉴于所有裂变中子都以快中子形式产生，$\\chi_1=1$。我们将第1群的移出截面定义为 $\\Sigma_{R1} = \\Sigma_{a1} + \\Sigma_{s,1\\to 2}$。方程变为：\n$$\n-D_1 \\frac{d^2\\phi_1}{dx^2} + \\Sigma_{R1}\\phi_1 = \\frac{1}{k} (\\nu\\Sigma_{f1}\\phi_1 + \\nu\\Sigma_{f2}\\phi_2)\n$$\n\n对于热中子群（$g=2$）：\n$$\n\\text{泄漏}_2 + \\text{吸收}_2 = \\text{移入散射}_2 + \\text{裂变源}_2\n$$\n$$\n-D_2 \\frac{d^2\\phi_2}{dx^2} + \\Sigma_{a2}\\phi_2 = \\Sigma_{s,1\\to 2}\\phi_1 + \\frac{\\chi_2}{k} \\sum_{g'=1}^{2} \\nu\\Sigma_{fg'} \\phi_{g'}\n$$\n鉴于没有裂变中子以热中子形式产生，$\\chi_2=0$。方程简化为：\n$$\n-D_2 \\frac{d^2\\phi_2}{dx^2} + \\Sigma_{a2}\\phi_2 = \\Sigma_{s,1\\to 2}\\phi_1\n$$\n在均匀反应堆中，空间算符 $\\frac{d^2}{dx^2}$ 对两个群是相同的。因此，对于基波模态解，所有群的通量共享相同的空间形状（本征函数），仅相差一个常数振幅因子。因此我们寻求以下形式的解：\n$$\n\\phi_g(x) = A_g f(x)\n$$\n其中 $f(x)$ 是算符 $\\frac{d^2}{dx^2}$ 在边界条件 $\\phi_g(\\pm(L/2+d)) = 0$ 下的基波本征函数。如 A 部分所述，该本征函数为 $f(x) = \\cos(B_g x)$，其本征值为 $-B_g^2$，其中 $B_g^2 = \\left(\\frac{\\pi}{L+2d}\\right)^2$。因此，我们有：\n$$\n\\frac{d^2\\phi_g(x)}{dx^2} = A_g \\frac{d^2f(x)}{dx^2} = -A_g B_g^2 f(x)\n$$\n将 $\\phi_1(x) = A_1f(x)$ 和 $\\phi_2(x) = A_2f(x)$ 代入热中子群扩散方程：\n$$\n-D_2 \\frac{d^2}{dx^2}(A_2 f(x)) + \\Sigma_{a2}(A_2 f(x)) = \\Sigma_{s,1\\to 2}(A_1 f(x))\n$$\n$$\n-D_2 A_2 (-B_g^2 f(x)) + \\Sigma_{a2} A_2 f(x) = \\Sigma_{s,1\\to 2} A_1 f(x)\n$$\n空间本征函数 $f(x)$ 不恒为零，因此可以从方程两边消去：\n$$\nD_2 A_2 B_g^2 + \\Sigma_{a2} A_2 = \\Sigma_{s,1\\to 2} A_1\n$$\n$$\nA_2 (D_2 B_g^2 + \\Sigma_{a2}) = A_1 \\Sigma_{s,1\\to 2}\n$$\n热中子群与快中子群的振幅比 $R \\equiv A_2/A_1$ 现在可以直接从此代数关系中解出：\n$$\nR = \\frac{A_2}{A_1} = \\frac{\\Sigma_{s,1\\to 2}}{D_2 B_g^2 + \\Sigma_{a2}}\n$$\n最后，代入几何曲率 $B_g^2$ 的表达式，得到以指定参数表示的 $R$ 的闭式表达式：\n$$\nR = \\frac{\\Sigma_{s,1\\to 2}}{D_2 \\left(\\frac{\\pi}{L+2d}\\right)^2 + \\Sigma_{a2}}\n$$\n此结果表明，热中子通量与快中子通量之比取决于热中子的源项（从快中子群的慢化散射）与热中子的损失项（泄漏和吸收）之间的平衡。快中子群的参数和裂变性质未出现在此表达式中，因为仅从热中子群的平衡就足以确定通量比，而无需这些参数。",
            "answer": "$$\n\\boxed{\\frac{\\Sigma_{s,1\\to 2}}{D_2 \\left(\\frac{\\pi}{L+2d}\\right)^2 + \\Sigma_{a2}}}\n$$"
        },
        {
            "introduction": "理论分析与计算实践之间需要一座桥梁，而对近似误差的量化分析正是这座桥梁的关键部分。本练习将探讨一个对模拟专家至关重要的问题：在计算中引入一个近似会带来多大的误差？您将分析在蒙特卡洛模拟中，使用无限质量近似对一个统计量（tally）所造成的偏差，并推导一个一阶校正项，这是现代反应堆物理计算中的一项核心技能。",
            "id": "4254862",
            "problem": "考虑在核反应堆模拟中的一次碰撞中子能谱计数，其中使用无限质量近似（IMA）代替有限质量弹性散射。在IMA中，靶核被视为具有无限质量，因此中子能量在散射过程中保持不变。在与有限质量的静止靶核进行的实际弹性碰撞中，出射中子的能量取决于靶核与中子的质量比以及质心系中的散射角。设靶核与中子的质量比为$A$，入射中子能量（单位为$\\mathrm{eV}$）为$E$，质心系散射余弦为$\\mu \\in [-1,1]$。本研究中的计数为 $g(E) = E^p$，其中 $p$ 为给定的实数指数。\n\n基于基本原理：\n- 从两体弹性碰撞的线动量守恒和动能守恒，以及质心系的定义出发。\n- 对于静止靶，使用从质心系到实验室系的变换，将出射中子在实验室系中的能量 $E'$ 与入射能量 $E$、质量比 $A$ 和质心系余弦 $\\mu$ 联系起来。\n- 假设在质心系中散射是各向同性的，因此 $\\mu$ 在 $[-1,1]$上均匀分布。\n\n任务：\n1. 从上述基本原理出发，推导弹性散射中能量比 $E'/E$ 关于 $A$ 和 $\\mu$ 的精确表达式，并证明 $E'/E$ 的最终分布是在区间 $[\\alpha, 1]$ 上的均匀分布，其中 $\\alpha = \\left(\\frac{A-1}{A+1}\\right)^2$。\n2. 使用此分布，计算对于通用实数 $p \\neq -1$ 的精确期望值 $\\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle$，然后计算IMA能谱计数中的精确偏差，其定义为\n$$\n\\text{Bias}_{\\text{exact}}(E,A,p) = g(E) - \\mathbb{E}[g(E')] = E^p \\left(1 - \\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle \\right),\n$$\n其中 $E$ 的单位为 $\\mathrm{eV}$，偏差的单位为 $\\mathrm{eV}^p$。\n3. 从精确的 $E'/E$ 公式出发，对 $1/A$ 进行一阶展开，得到形式为\n$$\n\\frac{E'}{E} \\approx 1 + \\frac{1}{A} \\, \\delta(\\mu),\n$$\n的近似式，其中 $\\delta(\\mu)$ 是一个待通过推导确定的关于 $\\mu$ 的函数。使用 $g(E')$ 在 $E$ 附近的一阶泰勒展开式，\n$$\ng(E') \\approx g(E) + g'(E) \\, (E' - E),\n$$\n构建一个依赖于 $A$、$\\mu$ 和 $E$ 的计数贡献的一阶修正估计量，并针对 $g(E) = E^p$ 的情况进行显式简化。在质心系各向同性散射的条件下，计算期望的一阶偏差估计\n$$\n\\text{Bias}_{\\text{fo}}(E,A,p) \\quad \\text{单位为} \\quad \\mathrm{eV}^p.\n$$\n\n实现要求：\n- 你的程序必须实现你推导出的公式，为每个测试用例 $(E,A,p)$ 计算三个量：$\\text{Bias}_{\\text{exact}}(E,A,p)$、$\\text{Bias}_{\\text{fo}}(E,A,p)$ 和绝对误差 $|\\text{Bias}_{\\text{fo}}(E,A,p) - \\text{Bias}_{\\text{exact}}(E,A,p)|$。所有偏差的单位必须为 $\\mathrm{eV}^p$。\n- 角度单位：散射余弦 $\\mu$ 是无量纲的；没有需要用度或弧度表示的角度。\n- 测试套件：使用以下特定参数集，其中 $E$ 的单位为 $\\mathrm{eV}$。\n    - 案例1（重靶，典型快中子能量）：$(E,A,p) = (10^6, 238, 1)$。\n    - 案例2（中等质量靶，典型快中子能量）：$(E,A,p) = (10^6, 12, 1)$。\n    - 案例3（轻靶，极端能量损失情况）：$(E,A,p) = (10^6, 1, 1)$。\n    - 案例4（重靶，非线性计数，热中子能量）：$(E,A,p) = (2.53 \\times 10^{-2}, 56, 2)$。\n    - 案例5（中等质量靶，分数计数指数）：$(E,A,p) = (10^3, 16, 0.5)$。\n    - 案例6（轻中等质量靶，边界计数指数）：$(E,A,p) = (10^4, 2, 0)$。\n- 最终输出格式：你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表。对于每个测试用例，按 $\\text{Bias}_{\\text{exact}}$、$\\text{Bias}_{\\text{fo}}$、 $|\\text{Bias}_{\\text{fo}} - \\text{Bias}_{\\text{exact}}|$ 的顺序输出三个浮点数，并将所有六个案例的结果展平。也就是说，打印\n$$\n[\\text{b}_{1,\\text{exact}},\\text{b}_{1,\\text{fo}},|\\text{b}_{1,\\text{fo}}-\\text{b}_{1,\\text{exact}}|,\\ldots,\\text{b}_{6,\\text{exact}},\\text{b}_{6,\\text{fo}},|\\text{b}_{6,\\text{fo}}-\\text{b}_{6,\\text{exact}}|],\n$$\n其中每个 $\\text{b}$ 是一个单位为 $\\mathrm{eV}^p$ 的浮点数。",
            "solution": "该问题要求推导和计算在一次中子散射计数中，由无限质量近似（IMA）引入的偏差。这涉及三个任务：推导精确的能量关系及其分布，计算精确偏差，以及推导偏差的一阶近似。\n\n### 任务1：散射后能量比 $E'/E$ 的推导\n\n我们考虑一个非相对论性弹性碰撞，碰撞双方为一个质量为 $m$、初始速度为 $\\vec{v}$（在实验室系，或称LAB系）的中子，和一个初始静止（$\\vec{V}=0$）的质量为 $M=Am$ 的靶核。入射中子能量为 $E=\\frac{1}{2}mv^2$。\n\n质心（COM）的速度在整个碰撞过程中是恒定的：\n$$\n\\vec{v}_{\\text{cm}} = \\frac{m\\vec{v} + M\\vec{V}}{m+M} = \\frac{m\\vec{v}}{m+Am} = \\frac{1}{A+1}\\vec{v}\n$$\n在质心系（COM系）中的初始速度是：\n$$\n\\vec{u}_n = \\vec{v} - \\vec{v}_{\\text{cm}} = \\vec{v} - \\frac{1}{A+1}\\vec{v} = \\frac{A}{A+1}\\vec{v}\n$$\n$$\n\\vec{u}_T = \\vec{V} - \\vec{v}_{\\text{cm}} = -\\frac{1}{A+1}\\vec{v}\n$$\n在弹性碰撞中，动能在质心系中是守恒的，这意味着在该坐标系中，一个粒子碰撞前后的速度大小相等。中子的速度方向发生改变。设中子在质心系中的末速度为 $\\vec{u}'_n$。我们有 $|\\vec{u}'_n| = |\\vec{u}_n| = \\frac{A}{A+1}v$。$\\vec{u}'_n$ 与初始运动方向 $\\vec{u}_n$ 之间的夹角是质心系散射角 $\\theta_{\\mathrm{CM}}$。其**余弦**值为 $\\mu = \\cos(\\theta_{\\mathrm{CM}})$。\n\n中子在实验室系（LAB系）中的末速度 $\\vec{v}'$ 可通过从质心系（COM系）变换回来得到：\n$$\n\\vec{v}' = \\vec{u}'_n + \\vec{v}_{\\text{cm}}\n$$\n在实验室系中的末动能为 $E' = \\frac{1}{2}m|\\vec{v}'|^2$。我们计算末速率的平方：\n$$\n|\\vec{v}'|^2 = \\vec{v}' \\cdot \\vec{v}' = (\\vec{u}'_n + \\vec{v}_{\\text{cm}}) \\cdot (\\vec{u}'_n + \\vec{v}_{\\text{cm}}) = |\\vec{u}'_n|^2 + |\\vec{v}_{\\text{cm}}|^2 + 2\\vec{u}'_n \\cdot \\vec{v}_{\\text{cm}}\n$$\n代入大小和点积 $\\vec{u}'_n \\cdot \\vec{v}_{\\text{cm}} = |\\vec{u}'_n||\\vec{v}_{\\text{cm}}|\\cos(\\theta_{\\mathrm{CM}}) = |\\vec{u}'_n||\\vec{v}_{\\text{cm}}|\\mu$：\n$$\n|\\vec{v}'|^2 = \\left(\\frac{A}{A+1}v\\right)^2 + \\left(\\frac{1}{A+1}v\\right)^2 + 2\\left(\\frac{A}{A+1}v\\right)\\left(\\frac{1}{A+1}v\\right)\\mu\n$$\n$$\n|\\vec{v}'|^2 = \\frac{v^2}{(A+1)^2}(A^2 + 1 + 2A\\mu)\n$$\n出射能量与入射能量之比 $E'/E$ 为：\n$$\n\\frac{E'}{E} = \\frac{\\frac{1}{2}m|\\vec{v}'|^2}{\\frac{1}{2}mv^2} = \\frac{|\\vec{v}'|^2}{v^2} = \\frac{A^2+1+2A\\mu}{(A+1)^2}\n$$\n这就是所要求的表达式。假设在质心系中散射是各向同性的，则 $\\mu$ 在 $[-1,1]$ 上均匀分布。由于 $E'/E$ 是 $\\mu$ 的线性函数，因此 $E'/E$ 的分布也是均匀的。$E'/E$ 的范围可通过在 $\\mu$ 区间的端点处求值得到：\n-   最大值（在 $\\mu=1$ 时）：$\\frac{E'}{E}\\Big|_{\\mu=1} = \\frac{A^2+1+2A}{(A+1)^2} = \\frac{(A+1)^2}{(A+1)^2} = 1$。\n-   最小值（在 $\\mu=-1$ 时）：$\\frac{E'}{E}\\Big|_{\\mu=-1} = \\frac{A^2+1-2A}{(A+1)^2} = \\frac{(A-1)^2}{(A+1)^2} = \\left(\\frac{A-1}{A+1}\\right)^2$。\n\n设 $\\alpha = \\left(\\frac{A-1}{A+1}\\right)^2$。能量比 $E'/E$ 服从区间 $[\\alpha, 1]$ 上的均匀分布。对于 $x=E'/E$，其概率密度函数 $f(x)$ 为 $f(x) = \\frac{1}{1-\\alpha}$，其中 $x \\in [\\alpha, 1]$。\n\n### 任务2：精确偏差计算\n\n计数为 $g(E) = E^p$。IMA假设 $E'=E$，所以IMA的计数贡献为 $g(E)$。精确的期望计数贡献是 $\\mathbb{E}[g(E')]$。\n$$\n\\mathbb{E}[g(E')] = \\mathbb{E}[(E')^p] = \\mathbb{E}[(E \\cdot E'/E)^p] = E^p \\mathbb{E}[(E'/E)^p] = E^p \\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle\n$$\n我们使用其均匀分布来计算 $(E'/E)^p$ 的期望值。对于通用实数指数 $p \\neq -1$：\n$$\n\\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle = \\int_\\alpha^1 x^p f(x) dx = \\int_\\alpha^1 x^p \\frac{1}{1-\\alpha} dx = \\frac{1}{1-\\alpha} \\left[ \\frac{x^{p+1}}{p+1} \\right]_\\alpha^1 = \\frac{1-\\alpha^{p+1}}{(p+1)(1-\\alpha)}\n$$\n精确偏差定义为 $\\text{Bias}_{\\text{exact}}(E,A,p) = g(E) - \\mathbb{E}[g(E')]$。\n$$\n\\text{Bias}_{\\text{exact}}(E,A,p) = E^p - E^p \\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle = E^p \\left( 1 - \\frac{1-\\alpha^{p+1}}{(p+1)(1-\\alpha)} \\right)\n$$\n其中 $\\alpha = \\left(\\frac{A-1}{A+1}\\right)^2$。这就是精确偏差的最终表达式。\n\n### 任务3：一阶偏差近似\n\n我们从 $E'/E$ 的精确表达式开始，并将其对 $1/A$ 作一阶展开。\n$$\n\\frac{E'}{E} = \\frac{A^2+1+2A\\mu}{(A+1)^2} = \\frac{1+1/A^2+2\\mu/A}{(1+1/A)^2} = (1+2\\mu A^{-1} + A^{-2})(1+A^{-1})^{-2}\n$$\n对小量 $x$ 使用泰勒展开式 $(1+x)^n \\approx 1+nx$，我们有 $(1+A^{-1})^{-2} \\approx 1-2A^{-1}$。\n$$\n\\frac{E'}{E} \\approx (1+2\\mu A^{-1})(1-2A^{-1}) = 1 - 2A^{-1} + 2\\mu A^{-1} - 4\\mu A^{-2} \\approx 1 + \\frac{2(\\mu-1)}{A}\n$$\n其形式为 $1 + \\frac{1}{A}\\delta(\\mu)$，其中 $\\delta(\\mu) = 2(\\mu-1)$。\n\n接下来，我们使用 $g(E')$ 在 $E$ 附近的一阶泰勒展开式：\n$$\ng(E') \\approx g(E) + g'(E)(E'-E)\n$$\n一阶偏差 $\\text{Bias}_{\\text{fo}}$ 是 $g(E) - g(E')$ 的期望值，使用此展开式进行近似。\n$$\n\\text{Bias}_{\\text{fo}} = \\mathbb{E}[g(E) - g(E')] \\approx \\mathbb{E}[g(E) - (g(E) + g'(E)(E'-E))] = -\\mathbb{E}[g'(E)(E'-E)]\n$$\n使用 $E'-E = E(E'/E - 1) \\approx E \\frac{2(\\mu-1)}{A}$ 的一阶近似：\n$$\n\\text{Bias}_{\\text{fo}} \\approx -\\mathbb{E}\\left[g'(E) \\cdot E \\frac{2(\\mu-1)}{A}\\right]\n$$\n由于 $E$、$A$ 和 $g'(E)$ 相对于随机变量 $\\mu$ 是常数，我们可以将它们从期望中提出：\n$$\n\\text{Bias}_{\\text{fo}} = -g'(E) \\frac{2E}{A} \\mathbb{E}[\\mu-1] = -g'(E) \\frac{2E}{A} (\\mathbb{E}[\\mu]-1)\n$$\n对于各向同性散射，$\\mu$ 在 $[-1,1]$ 上均匀分布，因此其期望值为 $\\mathbb{E}[\\mu] = \\int_{-1}^1 \\mu (1/2) d\\mu = 0$。\n$$\n\\text{Bias}_{\\text{fo}} = -g'(E) \\frac{2E}{A} (0-1) = g'(E) \\frac{2E}{A}\n$$\n对于特定的计数 $g(E) = E^p$，其导数为 $g'(E) = pE^{p-1}$。\n$$\n\\text{Bias}_{\\text{fo}}(E,A,p) = (pE^{p-1}) \\frac{2E}{A} = \\frac{2pE^p}{A}\n$$\n这是一阶偏差的最终表达式。\n\n### 用于实现的公式摘要\n1.  **精确偏差：**\n    $$\n    \\text{Bias}_{\\text{exact}}(E,A,p) = E^p \\left( 1 - \\frac{1-\\alpha^{p+1}}{(p+1)(1-\\alpha)} \\right) \\quad \\text{其中} \\quad \\alpha = \\left(\\frac{A-1}{A+1}\\right)^2\n    $$\n2.  **一阶偏差：**\n    $$\n    \\text{Bias}_{\\text{fo}}(E,A,p) = \\frac{2pE^p}{A}\n    $$\n对于 $p=0$ 的特殊情况，$g(E)=E^0=1$ 是一个常数计数。IMA的得分为 $1$，而真实的期望得分为 $\\mathbb{E}[(E')^0] = \\mathbb{E}[1]=1$。因此，两种偏差都精确为 $0$。推导出的公式在 $p=0$ 时也得到 $0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the exact and first-order bias for the Infinite Mass Approximation\n    in neutron scattering for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (E, A, p)\n        # Case 1 (heavy target, typical fast energy)\n        (1.0e6, 238.0, 1.0),\n        # Case 2 (moderate target, typical fast energy)\n        (1.0e6, 12.0, 1.0),\n        # Case 3 (light target, extreme energy loss case)\n        (1.0e6, 1.0, 1.0),\n        # Case 4 (heavy target, nonlinear tally, thermal energy)\n        (2.53e-2, 56.0, 2.0),\n        # Case 5 (moderate target, fractional tally exponent)\n        (1.0e3, 16.0, 0.5),\n        # Case 6 (light-moderate target, boundary tally exponent)\n        (1.0e4, 2.0, 0.0),\n    ]\n\n    results = []\n    for E, A, p in test_cases:\n        # For p=0, g(E) = E^0 = 1 is constant.\n        # The IMA score is 1, and the true expected score is E[(E')^0] = E[1] = 1.\n        # Thus, bias is zero for both exact and first-order models.\n        if p == 0.0:\n            bias_exact = 0.0\n            bias_fo = 0.0\n            abs_error = 0.0\n            results.extend([bias_exact, bias_fo, abs_error])\n            continue\n\n        # Calculate exact bias using the derived formula:\n        # Bias_exact = E^p * (1 - (1 - alpha^(p+1)) / ((p+1)*(1-alpha)))\n        # where alpha = ((A-1)/(A+1))^2\n        alpha = ((A - 1.0) / (A + 1.0))**2\n        \n        # A numerically stable way to compute 1-alpha is 4A/(A+1)^2.\n        # This avoids catastrophic cancellation when A is large (alpha is near 1).\n        if A > 1.0:\n            one_minus_alpha = 4.0 * A / (A + 1.0)**2\n        else: # A == 1.0, so alpha is 0\n            one_minus_alpha = 1.0\n\n        # The term with (p+1) in the denominator is valid since p != -1 is given.\n        expectation_term = (1.0 - alpha**(p + 1.0)) / ((p + 1.0) * one_minus_alpha)\n        \n        bias_exact = E**p * (1.0 - expectation_term)\n\n        # Calculate first-order bias using the derived formula:\n        # Bias_fo = 2*p*E^p / A\n        bias_fo = (2.0 * p * (E**p)) / A\n\n        # Calculate the absolute error between the two bias estimates\n        abs_error = abs(bias_fo - bias_exact)\n\n        results.extend([bias_exact, bias_fo, abs_error])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}