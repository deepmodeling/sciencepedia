{
    "hands_on_practices": [
        {
            "introduction": "This first exercise goes back to the basics of collision physics to build a solid foundation for the Infinite Mass Approximation (IMA). By applying the conservation of momentum and energy to an elastic collision, you will derive the relationship between a neutron's energy loss and the scattering angle. This practice is crucial for understanding precisely how, and under what assumptions, the average energy transferred to a target nucleus vanishes as its mass becomes infinitely large, justifying the core principle of the IMA .",
            "id": "4254917",
            "problem": "In the context of neutron moderation in nuclear reactor simulation, consider an elastic collision between a neutron of mass $m$ and a stationary target nucleus of mass $M$ with mass ratio $A=M/m$. Let the initial neutron kinetic energy in the laboratory frame be $E$, and let the post-collision neutron energy be $E'$. Assume elastic scattering and isotropy in the Center-of-Mass (CM) frame, meaning the scattering is uniform over solid angle in the CM frame and thus uniform in $\\cos\\theta_{\\mathrm{CM}} \\in [-1,1]$, where $\\theta_{\\mathrm{CM}}$ is the scattering angle in the CM frame.\n\nStarting from conservation of kinetic energy and momentum and using Galilean transformations between the laboratory and Center-of-Mass (CM) frames, derive the functional dependence of the laboratory-frame energy ratio $E'/E$ on the CM-frame scattering cosine $\\mu=\\cos\\theta_{\\mathrm{CM}}$. Then, compute the mean fractional energy loss per collision,\n$$\\left\\langle 1 - \\frac{E'}{E} \\right\\rangle,$$\nby averaging over isotropic scattering in the CM frame for a finite mass ratio $A$. Express your final result as a closed-form analytic expression in terms of $A$. Finally, using your derived expression, demonstrate from first principles that this mean fractional energy loss vanishes in the infinite mass approximation $A \\to \\infty$.\n\nProvide your final answer as a single closed-form expression in terms of $A$. No numerical approximation or rounding is required.",
            "solution": "The problem is evaluated as valid, being scientifically grounded, well-posed, objective, and self-contained. The solution proceeds as follows.\n\nThe problem asks for the derivation of the mean fractional energy loss of a neutron in an elastic collision with a stationary nucleus. Let the neutron have mass $m$ and initial velocity $\\vec{v}_n$ in the laboratory (lab) frame. The target nucleus has mass $M$ and is initially at rest, $\\vec{v}_N = \\vec{0}$. The mass ratio is defined as $A = M/m$. The initial kinetic energy of the neutron is $E = \\frac{1}{2}m|\\vec{v}_n|^2$.\n\nFirst, we transform to the Center-of-Mass (CM) frame. The velocity of the CM is given by:\n$$ \\vec{v}_{\\mathrm{CM}} = \\frac{m\\vec{v}_n + M\\vec{v}_N}{m+M} = \\frac{m\\vec{v}_n}{m+M} = \\frac{1}{1+A}\\vec{v}_n $$\nThe initial velocities of the neutron and nucleus in the CM frame are:\n$$ \\vec{u}_n = \\vec{v}_n - \\vec{v}_{\\mathrm{CM}} = \\vec{v}_n - \\frac{1}{1+A}\\vec{v}_n = \\left(1 - \\frac{1}{1+A}\\right)\\vec{v}_n = \\frac{A}{1+A}\\vec{v}_n $$\n$$ \\vec{u}_N = \\vec{v}_N - \\vec{v}_{\\mathrm{CM}} = \\vec{0} - \\frac{1}{1+A}\\vec{v}_n = -\\frac{1}{1+A}\\vec{v}_n $$\nIn the CM frame, the total momentum is zero, as can be verified: $m\\vec{u}_n + M\\vec{u}_N = m\\left(\\frac{A}{1+A}\\vec{v}_n\\right) + M\\left(-\\frac{1}{1+A}\\vec{v}_n\\right) = \\frac{mA - M}{1+A}\\vec{v}_n = \\frac{M-M}{1+A}\\vec{v}_n = \\vec{0}$.\n\nFor an elastic collision, kinetic energy is conserved in any inertial frame. In the CM frame, this implies that the speeds of the particles are unchanged by the collision, although their directions change. Let the post-collision velocities in the CM frame be $\\vec{u}_n'$ and $\\vec{u}_N'$. Then, we have:\n$$ |\\vec{u}_n'| = |\\vec{u}_n| = \\frac{A}{1+A}v_n $$\nwhere $v_n = |\\vec{v}_n|$. The scattering angle in the CM frame, $\\theta_{\\mathrm{CM}}$, is the angle between the initial and final neutron velocities in this frame, i.e., between $\\vec{u}_n$ and $\\vec{u}_n'$.\n\nTo find the final neutron energy $E'$ in the lab frame, we transform the final neutron velocity from the CM frame back to the lab frame:\n$$ \\vec{v}_n' = \\vec{u}_n' + \\vec{v}_{\\mathrm{CM}} $$\nThe final kinetic energy in the lab frame is $E' = \\frac{1}{2}m|\\vec{v}_n'|^2$. We compute the square of the final speed:\n$$ |\\vec{v}_n'|^2 = \\vec{v}_n' \\cdot \\vec{v}_n' = (\\vec{u}_n' + \\vec{v}_{\\mathrm{CM}}) \\cdot (\\vec{u}_n' + \\vec{v}_{\\mathrm{CM}}) = |\\vec{u}_n'|^2 + |\\vec{v}_{\\mathrm{CM}}|^2 + 2\\vec{u}_n' \\cdot \\vec{v}_{\\mathrm{CM}} $$\nLet's evaluate each term.\n- $|\\vec{u}_n'|^2 = |\\vec{u}_n|^2 = \\left(\\frac{A}{1+A}v_n\\right)^2 = \\frac{A^2}{(A+1)^2}v_n^2$.\n- $|\\vec{v}_{\\mathrm{CM}}|^2 = \\left(\\frac{1}{1+A}v_n\\right)^2 = \\frac{1}{(A+1)^2}v_n^2$.\n- The dot product term depends on the scattering angle $\\theta_{\\mathrm{CM}}$. The vector $\\vec{v}_{\\mathrm{CM}}$ is parallel to the initial neutron velocity $\\vec{v}_n$ and thus parallel to $\\vec{u}_n$. The angle between $\\vec{u}_n'$ and $\\vec{v}_{\\mathrm{CM}}$ is therefore $\\theta_{\\mathrm{CM}}$. Let $\\mu = \\cos\\theta_{\\mathrm{CM}}$.\n$$ \\vec{u}_n' \\cdot \\vec{v}_{\\mathrm{CM}} = |\\vec{u}_n'||\\vec{v}_{\\mathrm{CM}}|\\cos\\theta_{\\mathrm{CM}} = \\left(\\frac{A}{1+A}v_n\\right)\\left(\\frac{1}{1+A}v_n\\right)\\mu = \\frac{A}{(A+1)^2}v_n^2\\mu $$\nSubstituting these into the expression for $|\\vec{v}_n'|^2$:\n$$ |\\vec{v}_n'|^2 = \\frac{A^2}{(A+1)^2}v_n^2 + \\frac{1}{(A+1)^2}v_n^2 + 2\\frac{A}{(A+1)^2}v_n^2\\mu = \\frac{A^2+1+2A\\mu}{(A+1)^2}v_n^2 $$\nThe ratio of final to initial energy is:\n$$ \\frac{E'}{E} = \\frac{\\frac{1}{2}m|\\vec{v}_n'|^2}{\\frac{1}{2}m|\\vec{v}_n|^2} = \\frac{|\\vec{v}_n'|^2}{v_n^2} = \\frac{A^2+2A\\mu+1}{(A+1)^2} $$\nThis is the functional dependence of the energy ratio on the CM-frame scattering cosine $\\mu$.\n\nNext, we compute the mean fractional energy loss, $\\left\\langle 1 - \\frac{E'}{E} \\right\\rangle$. This requires averaging over all possible scattering outcomes. The problem states that scattering is isotropic in the CM frame, meaning the probability of scattering into a given solid angle is uniform. This implies that the probability distribution function for $\\mu = \\cos\\theta_{\\mathrm{CM}}$ is uniform over the interval $[-1, 1]$. The normalized probability density function is $p(\\mu) = 1/2$ for $\\mu \\in [-1, 1]$.\n\nThe mean value of the energy ratio $\\langle E'/E \\rangle$ is:\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\int_{-1}^{1} \\frac{E'}{E}(\\mu) p(\\mu) d\\mu = \\int_{-1}^{1} \\left( \\frac{A^2+2A\\mu+1}{(A+1)^2} \\right) \\frac{1}{2} d\\mu $$\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\frac{1}{2(A+1)^2} \\int_{-1}^{1} (A^2+1+2A\\mu) d\\mu $$\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\frac{1}{2(A+1)^2} \\left[ (A^2+1)\\mu + A\\mu^2 \\right]_{-1}^{1} $$\nEvaluating the definite integral at the limits:\n$$ \\left[ (A^2+1)(1) + A(1)^2 \\right] - \\left[ (A^2+1)(-1) + A(-1)^2 \\right] = (A^2+A+1) - (-A^2-1+A) = 2A^2+2 = 2(A^2+1) $$\nSubstituting this back:\n$$ \\left\\langle \\frac{E'}{E} \\right\\rangle = \\frac{1}{2(A+1)^2} \\cdot 2(A^2+1) = \\frac{A^2+1}{(A+1)^2} $$\nThe mean fractional energy loss is then:\n$$ \\left\\langle 1 - \\frac{E'}{E} \\right\\rangle = 1 - \\left\\langle \\frac{E'}{E} \\right\\rangle = 1 - \\frac{A^2+1}{(A+1)^2} $$\n$$ \\left\\langle 1 - \\frac{E'}{E} \\right\\rangle = \\frac{(A+1)^2 - (A^2+1)}{(A+1)^2} = \\frac{(A^2+2A+1) - (A^2+1)}{(A+1)^2} = \\frac{2A}{(A+1)^2} $$\nThis is the required closed-form analytic expression for the mean fractional energy loss in terms of the mass ratio $A$.\n\nFinally, we demonstrate that this loss vanishes in the infinite mass approximation ($A \\to \\infty$). This corresponds to a neutron scattering off a nucleus of infinite mass. We take the limit of our result as $A \\to \\infty$:\n$$ \\lim_{A \\to \\infty} \\left\\langle 1 - \\frac{E'}{E} \\right\\rangle = \\lim_{A \\to \\infty} \\frac{2A}{(A+1)^2} $$\nThis is a limit of a rational function where the degree of the denominator ($2$) is greater than the degree of the numerator ($1$). To evaluate it formally, we divide the numerator and denominator by the highest power of $A$ in the denominator, which is $A^2$:\n$$ \\lim_{A \\to \\infty} \\frac{2A/A^2}{(A+1)^2/A^2} = \\lim_{A \\to \\infty} \\frac{2/A}{(1+1/A)^2} $$\nAs $A \\to \\infty$, the term $1/A \\to 0$. Therefore, the limit is:\n$$ \\frac{0}{(1+0)^2} = 0 $$\nThus, the mean fractional energy loss for a neutron scattering off an infinitely massive nucleus is zero, which is physically intuitive. The collision becomes equivalent to a particle reflecting from a fixed, immovable wall, where no energy is transferred.",
            "answer": "$$\n\\boxed{\\frac{2A}{(A+1)^{2}}}\n$$"
        },
        {
            "introduction": "Moving from fundamental kinematics to practical application, this problem explores the role of the IMA within the framework of neutron diffusion theory. You will first solve the diffusion equation for a simple slab reactor using the one-speed model, which is a direct consequence of the IMA's \"no energy change\" assumption. You will then relax this assumption in a two-group model to see how finite-mass scattering introduces energy coupling between neutron groups, a critical effect that the IMA neglects .",
            "id": "4254856",
            "problem": "Consider a homogeneous bare slab reactor of physical thickness $L$, occupying the spatial domain $x \\in [-L/2,\\,L/2]$. The material is uniform, isotropic, and time-independent, and the reactor is surrounded by vacuum. In diffusion theory, vacuum boundary conditions in a slab are enforced via the extrapolated boundary condition at the extrapolated boundaries $x=\\pm\\left(L/2+d\\right)$, where $d$ is the extrapolation distance. Throughout, assume spatially constant material properties. \n\nPart A (Infinite Mass Approximation): In the infinite mass approximation (IMA), the scattering centers have effectively infinite mass, so neutron scattering does not change neutron energy. As a consequence, energy groups do not couple and one may treat a single energy group with diffusion coefficient $D$, macroscopic absorption cross section $\\Sigma_{a}$, and macroscopic fission production characterized by $\\nu\\Sigma_{f}$. Starting from the neutron balance and Fick’s law, write the steady-state one-speed $k$-eigenvalue diffusion equation in one spatial dimension for the scalar flux $\\phi(x)$ and impose the extrapolated vacuum boundary conditions. Derive the normalized fundamental spatial mode shape $f(x)$, defined up to a multiplicative constant, for the bare slab in the IMA limit.\n\nPart B (Finite-Mass Scatterers with Two-Group Coupling): Now relax the IMA and assume finite-mass scatterers that enable down-scatter from a fast group to a thermal group. Use a two-energy-group diffusion description with fast group $g=1$ and thermal group $g=2$, diffusion coefficients $D_{1}$ and $D_{2}$, absorption cross sections $\\Sigma_{a1}$ and $\\Sigma_{a2}$, and a one-way scattering cross section $\\Sigma_{s,1\\to 2}$ (no up-scatter). Let the fission spectrum place all fission neutrons in the fast group, so $\\chi_{1}=1$ and $\\chi_{2}=0$. Assume spatially uniform properties and the same vacuum extrapolated boundary condition $x=\\pm\\left(L/2+d\\right)$ for both groups. Starting from the coupled two-group neutron balance and Fick’s law, show that in the fundamental mode both groups share a common spatial eigenfunction $f(x)$, and derive a closed-form analytic expression for the thermal-to-fast amplitude ratio $R \\equiv A_{2}/A_{1}$ in terms of $D_{2}$, $\\Sigma_{a2}$, $\\Sigma_{s,1\\to 2}$, $L$, and $d$, where $\\phi_{g}(x)=A_{g} f(x)$ defines the group amplitudes $A_{g}$.\n\nAnswer specification: Your final answer must be the single closed-form analytic expression for $R$ as a function of $D_{2}$, $\\Sigma_{a2}$, $\\Sigma_{s,1\\to 2}$, $L$, and $d$. Do not include units in the final boxed expression. No rounding is required. As part of your derivation, clearly exhibit the fundamental mode shape $f(x)$ in each case and the corresponding geometric buckling parameter consistent with the extrapolated boundaries.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is based on standard neutron diffusion theory in reactor physics. All required information is provided, and the questions are answerable through rigorous derivation.\n\n**Part A: Infinite Mass Approximation (IMA)**\n\nThe steady-state one-speed neutron balance equation for a critical or near-critical system is formulated using the $k$-eigenvalue, which scales the fission source term. The balance is between leakage, absorption, and fission production:\n$$\n\\text{Leakage} + \\text{Absorption} = \\frac{1}{k} \\times \\text{Production}\n$$\nIn one spatial dimension $x$, this is expressed for the neutron flux $\\phi(x)$ as:\n$$\n-\\frac{dJ(x)}{dx} + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu\\Sigma_f \\phi(x)\n$$\nwhere $J(x)$ is the neutron current, $\\Sigma_a$ is the macroscopic absorption cross section, and $\\nu\\Sigma_f$ represents the number of neutrons produced per fission times the macroscopic fission cross section.\n\nFick's law relates the current to the gradient of the flux:\n$$\nJ(x) = -D \\frac{d\\phi(x)}{dx}\n$$\nwhere $D$ is the diffusion coefficient. Since the material properties are spatially constant, substituting Fick's law into the balance equation yields:\n$$\n-\\frac{d}{dx}\\left(-D \\frac{d\\phi(x)}{dx}\\right) + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu\\Sigma_f \\phi(x)\n$$\n$$\nD \\frac{d^2\\phi(x)}{dx^2} + \\left(\\frac{1}{k}\\nu\\Sigma_f - \\Sigma_a\\right) \\phi(x) = 0\n$$\nThis is a homogeneous second-order ordinary differential equation. It can be rewritten in the standard Helmholtz form:\n$$\n\\frac{d^2\\phi(x)}{dx^2} + B^2 \\phi(x) = 0\n$$\nwhere $B^2$ is the material buckling, defined as:\n$$\nB^2 = B_m^2 = \\frac{\\frac{1}{k}\\nu\\Sigma_f - \\Sigma_a}{D}\n$$\nThe general solution to this equation is $\\phi(x) = C_1 \\sin(Bx) + C_2 \\cos(Bx)$. For a symmetric slab reactor centered at $x=0$, the fundamental (lowest energy) mode is expected to be an even function of $x$. This requires the coefficient of the odd sine term to be zero, so $C_1=0$. The solution is of the form $\\phi(x) = C_2 \\cos(Bx)$.\n\nThe vacuum boundary conditions are imposed at the extrapolated boundaries $x = \\pm(L/2 + d)$, where the flux is assumed to vanish. Applying this condition at $x = L/2 + d$:\n$$\n\\phi\\left(\\frac{L}{2} + d\\right) = C_2 \\cos\\left(B\\left(\\frac{L}{2} + d\\right)\\right) = 0\n$$\nFor a non-trivial solution ($C_2 \\neq 0$), the argument of the cosine must be an odd multiple of $\\pi/2$. For the fundamental mode (the smoothest, non-negative solution within the reactor), we take the smallest positive value:\n$$\nB\\left(\\frac{L}{2} + d\\right) = \\frac{\\pi}{2}\n$$\nThis equation determines the specific value of $B$ required to satisfy the boundary conditions, which is termed the geometric buckling, $B_g$.\n$$\nB_g = \\frac{\\pi}{L + 2d}\n$$\nThe corresponding eigenvalue is the geometric buckling squared, $B_g^2 = \\left(\\frac{\\pi}{L+2d}\\right)^2$. For a critical reactor, the material buckling must equal the geometric buckling, $B_m^2 = B_g^2$. The fundamental spatial mode shape $f(x)$ is therefore given by the cosine function with this specific buckling:\n$$\nf(x) = \\cos(B_g x) = \\cos\\left(\\frac{\\pi x}{L+2d}\\right)\n$$\nThis function is defined up to a multiplicative constant, as specified.\n\n**Part B: Finite-Mass Scatterers with Two-Group Coupling**\n\nWe now consider a two-group model with a fast group ($g=1$) and a thermal group ($g=2$). The coupled steady-state diffusion equations are formed by writing a neutron balance for each group.\n\nFor the fast group ($g=1$):\n$$\n\\text{Leakage}_1 + \\text{Absorption}_1 + \\text{Out-scatter}_1 = \\text{Fission Source}_1\n$$\n$$\n-D_1 \\frac{d^2\\phi_1}{dx^2} + \\Sigma_{a1}\\phi_1 + \\Sigma_{s,1\\to 2}\\phi_1 = \\frac{\\chi_1}{k} \\sum_{g'=1}^{2} \\nu\\Sigma_{fg'} \\phi_{g'}\n$$\nGiven that all fission neutrons are born fast, $\\chi_1=1$. We define the removal cross section for group $1$ as $\\Sigma_{R1} = \\Sigma_{a1} + \\Sigma_{s,1\\to 2}$. The equation becomes:\n$$\n-D_1 \\frac{d^2\\phi_1}{dx^2} + \\Sigma_{R1}\\phi_1 = \\frac{1}{k} (\\nu\\Sigma_{f1}\\phi_1 + \\nu\\Sigma_{f2}\\phi_2)\n$$\n\nFor the thermal group ($g=2$):\n$$\n\\text{Leakage}_2 + \\text{Absorption}_2 = \\text{In-scatter}_2 + \\text{Fission Source}_2\n$$\n$$\n-D_2 \\frac{d^2\\phi_2}{dx^2} + \\Sigma_{a2}\\phi_2 = \\Sigma_{s,1\\to 2}\\phi_1 + \\frac{\\chi_2}{k} \\sum_{g'=1}^{2} \\nu\\Sigma_{fg'} \\phi_{g'}\n$$\nGiven that no fission neutrons are born thermal, $\\chi_2=0$. The equation simplifies to:\n$$\n-D_2 \\frac{d^2\\phi_2}{dx^2} + \\Sigma_{a2}\\phi_2 = \\Sigma_{s,1\\to 2}\\phi_1\n$$\nIn a homogeneous reactor, the spatial operator $\\frac{d^2}{dx^2}$ is the same for both groups. Therefore, for the fundamental mode solution, the fluxes in all groups share the same spatial shape (eigenfunction), differing only by constant amplitude factors. We thus seek a solution of the form:\n$$\n\\phi_g(x) = A_g f(x)\n$$\nwhere $f(x)$ is the fundamental eigenfunction of the operator $\\frac{d^2}{dx^2}$ subject to the boundary conditions $\\phi_g(\\pm(L/2+d)) = 0$. As established in Part A, this eigenfunction is $f(x) = \\cos(B_g x)$ with eigenvalue $-B_g^2$, where $B_g^2 = \\left(\\frac{\\pi}{L+2d}\\right)^2$. Thus, we have:\n$$\n\\frac{d^2\\phi_g(x)}{dx^2} = A_g \\frac{d^2f(x)}{dx^2} = -A_g B_g^2 f(x)\n$$\nSubstituting $\\phi_1(x) = A_1f(x)$ and $\\phi_2(x) = A_2f(x)$ into the thermal group diffusion equation:\n$$\n-D_2 \\frac{d^2}{dx^2}(A_2 f(x)) + \\Sigma_{a2}(A_2 f(x)) = \\Sigma_{s,1\\to 2}(A_1 f(x))\n$$\n$$\n-D_2 A_2 (-B_g^2 f(x)) + \\Sigma_{a2} A_2 f(x) = \\Sigma_{s,1\\to 2} A_1 f(x)\n$$\nThe spatial eigenfunction $f(x)$ is not identically zero, so it can be canceled from both sides of the equation:\n$$\nD_2 A_2 B_g^2 + \\Sigma_{a2} A_2 = \\Sigma_{s,1\\to 2} A_1\n$$\n$$\nA_2 (D_2 B_g^2 + \\Sigma_{a2}) = A_1 \\Sigma_{s,1\\to 2}\n$$\nThe thermal-to-fast amplitude ratio $R \\equiv A_2/A_1$ can now be solved for directly from this algebraic relation:\n$$\nR = \\frac{A_2}{A_1} = \\frac{\\Sigma_{s,1\\to 2}}{D_2 B_g^2 + \\Sigma_{a2}}\n$$\nFinally, substituting the expression for the geometric buckling $B_g^2$ gives the closed-form expression for $R$ in terms of the specified parameters:\n$$\nR = \\frac{\\Sigma_{s,1\\to 2}}{D_2 \\left(\\frac{\\pi}{L+2d}\\right)^2 + \\Sigma_{a2}}\n$$\nThis result shows that the ratio of thermal to fast flux depends on the balance between the source of thermal neutrons (down-scatter from the fast group) and the losses of thermal neutrons (leakage and absorption). The fast group parameters and fission properties do not appear in this expression, as they are not needed to determine the flux ratio from the thermal group balance alone.",
            "answer": "$$\n\\boxed{\\frac{\\Sigma_{s,1\\to 2}}{D_2 \\left(\\frac{\\pi}{L+2d}\\right)^2 + \\Sigma_{a2}}}\n$$"
        },
        {
            "introduction": "This final practice bridges theoretical approximations with the realities of computational simulation, specifically Monte Carlo methods. The IMA is often used to simplify calculations, but it introduces a systematic error, or bias. This exercise tasks you with quantifying this bias for a common simulation observable (a tally) and developing a first-order correction based on an expansion in the inverse mass ratio $1/A$, a powerful technique in advanced code development and verification .",
            "id": "4254862",
            "problem": "Consider a one-collision neutron spectrum tally in a nuclear reactor simulation where the Infinite Mass Approximation (IMA) is used in place of finite-mass elastic scattering. In the IMA, the target nucleus is taken to have infinite mass so that the neutron energy is unchanged through scattering. In an actual elastic collision with a stationary target nucleus of finite mass, the outgoing neutron energy depends on the target-to-neutron mass ratio and the scattering angle in the center-of-mass frame. Let the target-to-neutron mass ratio be denoted by $A$, the incident neutron energy by $E$ in $\\mathrm{eV}$, and the center-of-mass scattering cosine by $\\mu \\in [-1,1]$. The tally being studied is $g(E) = E^p$ for a given real exponent $p$.\n\nUsing Fundamentals:\n- Begin from conservation of linear momentum and kinetic energy for two-body elastic collisions, and the definition of the center-of-mass frame.\n- Use the transformation from center-of-mass to laboratory frame for a stationary target to relate outgoing neutron laboratory energy $E'$ to the incident energy $E$, the mass ratio $A$, and the center-of-mass cosine $\\mu$.\n- Assume isotropic scattering in the center-of-mass frame so that $\\mu$ is uniformly distributed on $[-1,1]$.\n\nTasks:\n1. Derive, from the above fundamentals, the exact expression for the ratio $E'/E$ in terms of $A$ and $\\mu$ for elastic scattering, and show that the resulting distribution of $E'/E$ is uniform on the interval $[\\alpha, 1]$ with $\\alpha = \\left(\\frac{A-1}{A+1}\\right)^2$.\n2. Using this distribution, compute the exact expectation $\\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle$ for general real $p \\neq -1$, and then compute the exact bias in the IMA spectrum tally defined as\n$$\n\\text{Bias}_{\\text{exact}}(E,A,p) = g(E) - \\mathbb{E}[g(E')] = E^p \\left(1 - \\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle \\right),\n$$\nwith $E$ expressed in $\\mathrm{eV}$ and the bias expressed in $\\mathrm{eV}^p$.\n3. Starting from the exact $E'/E$ formula, perform a first-order expansion in $1/A$ to obtain an approximation of the form\n$$\n\\frac{E'}{E} \\approx 1 + \\frac{1}{A} \\, \\delta(\\mu),\n$$\nwhere $\\delta(\\mu)$ is a function of $\\mu$ to be determined from the derivation. Using the first-order Taylor expansion of $g(E')$ around $E$,\n$$\ng(E') \\approx g(E) + g'(E) \\, (E' - E),\n$$\nconstruct a first-order correction estimator for the tally contribution that depends on $A$, $\\mu$, and $E$, and simplify it explicitly for $g(E) = E^p$. Under isotropic center-of-mass scattering, compute the expected first-order bias estimate\n$$\n\\text{Bias}_{\\text{fo}}(E,A,p) \\quad \\text{in} \\quad \\mathrm{eV}^p.\n$$\n\nImplementation Requirements:\n- Your program must implement the formulas you derive to compute, for each test case $(E,A,p)$, three quantities: $\\text{Bias}_{\\text{exact}}(E,A,p)$, $\\text{Bias}_{\\text{fo}}(E,A,p)$, and the absolute error $|\\text{Bias}_{\\text{fo}}(E,A,p) - \\text{Bias}_{\\text{exact}}(E,A,p)|$. All biases must be expressed in $\\mathrm{eV}^p$.\n- Angle units: The scattering cosine $\\mu$ is dimensionless; there is no angle to express in degrees or radians.\n- Test Suite: Use the following specific parameter sets, with $E$ in $\\mathrm{eV}$.\n    - Case 1 (heavy target, typical fast energy): $(E,A,p) = (10^6, 238, 1)$.\n    - Case 2 (moderate target, typical fast energy): $(E,A,p) = (10^6, 12, 1)$.\n    - Case 3 (light target, extreme energy loss case): $(E,A,p) = (10^6, 1, 1)$.\n    - Case 4 (heavy target, nonlinear tally, thermal energy): $(E,A,p) = (2.53 \\times 10^{-2}, 56, 2)$.\n    - Case 5 (moderate target, fractional tally exponent): $(E,A,p) = (10^3, 16, 0.5)$.\n    - Case 6 (light-moderate target, boundary tally exponent): $(E,A,p) = (10^4, 2, 0)$.\n- Final Output Format: Your program should produce a single line of output containing a comma-separated list enclosed in square brackets. For each test case, output the three floats in the order $\\text{Bias}_{\\text{exact}}$, $\\text{Bias}_{\\text{fo}}$, $|\\text{Bias}_{\\text{fo}} - \\text{Bias}_{\\text{exact}}|$, flattened across all six cases. That is, print\n$$\n[\\text{b}_{1,\\text{exact}},\\text{b}_{1,\\text{fo}},|\\text{b}_{1,\\text{fo}}-\\text{b}_{1,\\text{exact}}|,\\ldots,\\text{b}_{6,\\text{exact}},\\text{b}_{6,\\text{fo}},|\\text{b}_{6,\\text{fo}}-\\text{b}_{6,\\text{exact}}|],\n$$\nwhere each $\\text{b}$ is a float in $\\mathrm{eV}^p$.",
            "solution": "The problem requires the derivation and calculation of the bias introduced by the Infinite Mass Approximation (IMA) in a neutron scattering tally. This involves three tasks: deriving the exact energy relationship and its distribution, calculating the exact bias, and deriving a first-order approximation for the bias.\n\n### Task 1: Derivation of the Post-Scattering Energy Ratio $E'/E$\n\nWe consider a non-relativistic elastic collision between a neutron of mass $m$ and initial velocity $\\vec{v}$ (in the laboratory, or LAB, frame) and a target nucleus of mass $M=Am$ initially at rest ($\\vec{V}=0$). The incident neutron energy is $E=\\frac{1}{2}mv^2$.\n\nThe velocity of the center-of-mass (COM) is constant throughout the collision:\n$$\n\\vec{v}_{cm} = \\frac{m\\vec{v} + M\\vec{V}}{m+M} = \\frac{m\\vec{v}}{m+Am} = \\frac{1}{A+1}\\vec{v}\n$$\nThe initial velocities in the COM frame are:\n$$\n\\vec{u}_n = \\vec{v} - \\vec{v}_{cm} = \\vec{v} - \\frac{1}{A+1}\\vec{v} = \\frac{A}{A+1}\\vec{v}\n$$\n$$\n\\vec{u}_T = \\vec{V} - \\vec{v}_{cm} = -\\frac{1}{A+1}\\vec{v}\n$$\nIn an elastic collision, kinetic energy is conserved in the COM frame, which implies the magnitudes of a particle's pre- and post-collision velocities are equal in this frame. The direction of the neutron's velocity changes. Let the final neutron velocity in the COM frame be $\\vec{u}'_n$. We have $|\\vec{u}'_n| = |\\vec{u}_n| = \\frac{A}{A+1}v$. The angle between $\\vec{u}'_n$ and the initial direction of motion $\\vec{u}_n$ is the COM scattering angle $\\theta_{cm}$. Its cosine is $\\mu = \\cos(\\theta_{cm})$.\n\nThe final velocity of the neutron in the LAB frame, $\\vec{v}'$, is obtained by transforming back from the COM frame:\n$$\n\\vec{v}' = \\vec{u}'_n + \\vec{v}_{cm}\n$$\nThe final kinetic energy in the LAB frame is $E' = \\frac{1}{2}m|\\vec{v}'|^2$. We compute the square of the final speed:\n$$\n|\\vec{v}'|^2 = \\vec{v}' \\cdot \\vec{v}' = (\\vec{u}'_n + \\vec{v}_{cm}) \\cdot (\\vec{u}'_n + \\vec{v}_{cm}) = |\\vec{u}'_n|^2 + |\\vec{v}_{cm}|^2 + 2\\vec{u}'_n \\cdot \\vec{v}_{cm}\n$$\nSubstituting the magnitudes and the dot product $\\vec{u}'_n \\cdot \\vec{v}_{cm} = |\\vec{u}'_n||\\vec{v}_{cm}|\\cos(\\theta_{cm}) = |\\vec{u}'_n||\\vec{v}_{cm}|\\mu$:\n$$\n|\\vec{v}'|^2 = \\left(\\frac{A}{A+1}v\\right)^2 + \\left(\\frac{1}{A+1}v\\right)^2 + 2\\left(\\frac{A}{A+1}v\\right)\\left(\\frac{1}{A+1}v\\right)\\mu\n$$\n$$\n|\\vec{v}'|^2 = \\frac{v^2}{(A+1)^2}(A^2 + 1 + 2A\\mu)\n$$\nThe ratio of outgoing to incoming energy $E'/E$ is:\n$$\n\\frac{E'}{E} = \\frac{\\frac{1}{2}m|\\vec{v}'|^2}{\\frac{1}{2}mv^2} = \\frac{|\\vec{v}'|^2}{v^2} = \\frac{A^2+1+2A\\mu}{(A+1)^2}\n$$\nThis is the required expression. Assuming isotropic scattering in the COM frame, $\\mu$ is uniformly distributed on $[-1,1]$. Since $E'/E$ is a linear function of $\\mu$, the distribution of $E'/E$ is also uniform. The range of $E'/E$ is found by evaluating at the endpoints of the $\\mu$ interval:\n-   Maximum value (at $\\mu=1$): $\\frac{E'}{E}\\Big|_{\\mu=1} = \\frac{A^2+1+2A}{(A+1)^2} = \\frac{(A+1)^2}{(A+1)^2} = 1$.\n-   Minimum value (at $\\mu=-1$): $\\frac{E'}{E}\\Big|_{\\mu=-1} = \\frac{A^2+1-2A}{(A+1)^2} = \\frac{(A-1)^2}{(A+1)^2} = \\left(\\frac{A-1}{A+1}\\right)^2$.\n\nLet $\\alpha = \\left(\\frac{A-1}{A+1}\\right)^2$. The ratio $E'/E$ follows a uniform distribution on the interval $[\\alpha, 1]$. The probability density function $f(x)$ for $x=E'/E$ is $f(x) = \\frac{1}{1-\\alpha}$ for $x \\in [\\alpha, 1]$.\n\n### Task 2: Exact Bias Calculation\n\nThe tally is $g(E) = E^p$. The IMA assumes $E'=E$, so the IMA tally contribution is $g(E)$. The exact expected tally contribution is $\\mathbb{E}[g(E')]$.\n$$\n\\mathbb{E}[g(E')] = \\mathbb{E}[(E')^p] = \\mathbb{E}[(E \\cdot E'/E)^p] = E^p \\mathbb{E}[(E'/E)^p] = E^p \\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle\n$$\nWe compute the expectation of $(E'/E)^p$ using its uniform distribution. For a general real exponent $p \\neq -1$:\n$$\n\\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle = \\int_\\alpha^1 x^p f(x) dx = \\int_\\alpha^1 x^p \\frac{1}{1-\\alpha} dx = \\frac{1}{1-\\alpha} \\left[ \\frac{x^{p+1}}{p+1} \\right]_\\alpha^1 = \\frac{1-\\alpha^{p+1}}{(p+1)(1-\\alpha)}\n$$\nThe exact bias is defined as $\\text{Bias}_{\\text{exact}}(E,A,p) = g(E) - \\mathbb{E}[g(E')]$.\n$$\n\\text{Bias}_{\\text{exact}}(E,A,p) = E^p - E^p \\left\\langle \\left(\\frac{E'}{E}\\right)^p \\right\\rangle = E^p \\left( 1 - \\frac{1-\\alpha^{p+1}}{(p+1)(1-\\alpha)} \\right)\n$$\nwhere $\\alpha = \\left(\\frac{A-1}{A+1}\\right)^2$. This is the final expression for the exact bias.\n\n### Task 3: First-Order Bias Approximation\n\nWe start with the exact expression for $E'/E$ and expand it to first order in $1/A$.\n$$\n\\frac{E'}{E} = \\frac{A^2+1+2A\\mu}{(A+1)^2} = \\frac{1+1/A^2+2\\mu/A}{(1+1/A)^2} = (1+2\\mu A^{-1} + A^{-2})(1+A^{-1})^{-2}\n$$\nUsing the Taylor expansion $(1+x)^n \\approx 1+nx$ for small $x$, we have $(1+A^{-1})^{-2} \\approx 1-2A^{-1}$.\n$$\n\\frac{E'}{E} \\approx (1+2\\mu A^{-1})(1-2A^{-1}) = 1 - 2A^{-1} + 2\\mu A^{-1} - 4\\mu A^{-2} \\approx 1 + \\frac{2(\\mu-1)}{A}\n$$\nThis is of the form $1 + \\frac{1}{A}\\delta(\\mu)$ with $\\delta(\\mu) = 2(\\mu-1)$.\n\nNext, we use a first-order Taylor expansion of $g(E')$ around $E$:\n$$\ng(E') \\approx g(E) + g'(E)(E'-E)\n$$\nThe first-order bias, $\\text{Bias}_{\\text{fo}}$, is the expectation value of $g(E) - g(E')$, approximated using this expansion.\n$$\n\\text{Bias}_{\\text{fo}} = \\mathbb{E}[g(E) - g(E')] \\approx \\mathbb{E}[g(E) - (g(E) + g'(E)(E'-E))] = -\\mathbb{E}[g'(E)(E'-E)]\n$$\nUsing the first-order approximation for $E'-E = E(E'/E - 1) \\approx E \\frac{2(\\mu-1)}{A}$:\n$$\n\\text{Bias}_{\\text{fo}} \\approx -\\mathbb{E}\\left[g'(E) \\cdot E \\frac{2(\\mu-1)}{A}\\right]\n$$\nSince $E$, $A$, and $g'(E)$ are constant with respect to the random variable $\\mu$, we can pull them out of the expectation:\n$$\n\\text{Bias}_{\\text{fo}} = -g'(E) \\frac{2E}{A} \\mathbb{E}[\\mu-1] = -g'(E) \\frac{2E}{A} (\\mathbb{E}[\\mu]-1)\n$$\nFor isotropic scattering, $\\mu$ is uniform on $[-1,1]$, so its expectation is $\\mathbb{E}[\\mu] = \\int_{-1}^1 \\mu (1/2) d\\mu = 0$.\n$$\n\\text{Bias}_{\\text{fo}} = -g'(E) \\frac{2E}{A} (0-1) = g'(E) \\frac{2E}{A}\n$$\nFor the specific tally $g(E) = E^p$, the derivative is $g'(E) = pE^{p-1}$.\n$$\n\\text{Bias}_{\\text{fo}}(E,A,p) = (pE^{p-1}) \\frac{2E}{A} = \\frac{2pE^p}{A}\n$$\nThis is the final expression for the first-order bias.\n\n### Summary of Formulas for Implementation\n1.  **Exact Bias:**\n    $$\n    \\text{Bias}_{\\text{exact}}(E,A,p) = E^p \\left( 1 - \\frac{1-\\alpha^{p+1}}{(p+1)(1-\\alpha)} \\right) \\quad \\text{with} \\quad \\alpha = \\left(\\frac{A-1}{A+1}\\right)^2\n    $$\n2.  **First-Order Bias:**\n    $$\n    \\text{Bias}_{\\text{fo}}(E,A,p) = \\frac{2pE^p}{A}\n    $$\nFor the special case $p=0$, $g(E)=E^0=1$ is a constant tally. The IMA score is $1$, and the true expected score is $\\mathbb{E}[(E')^0] = \\mathbb{E}[1]=1$. Both biases are therefore exactly $0$. The derived formulas also yield $0$ for $p=0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the exact and first-order bias for the Infinite Mass Approximation\n    in neutron scattering for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (E, A, p)\n        # Case 1 (heavy target, typical fast energy)\n        (1.0e6, 238.0, 1.0),\n        # Case 2 (moderate target, typical fast energy)\n        (1.0e6, 12.0, 1.0),\n        # Case 3 (light target, extreme energy loss case)\n        (1.0e6, 1.0, 1.0),\n        # Case 4 (heavy target, nonlinear tally, thermal energy)\n        (2.53e-2, 56.0, 2.0),\n        # Case 5 (moderate target, fractional tally exponent)\n        (1.0e3, 16.0, 0.5),\n        # Case 6 (light-moderate target, boundary tally exponent)\n        (1.0e4, 2.0, 0.0),\n    ]\n\n    results = []\n    for E, A, p in test_cases:\n        # For p=0, g(E) = E^0 = 1 is constant.\n        # The IMA score is 1, and the true expected score is E[(E')^0] = E[1] = 1.\n        # Thus, bias is zero for both exact and first-order models.\n        if p == 0.0:\n            bias_exact = 0.0\n            bias_fo = 0.0\n            abs_error = 0.0\n            results.extend([bias_exact, bias_fo, abs_error])\n            continue\n\n        # Calculate exact bias using the derived formula:\n        # Bias_exact = E^p * (1 - (1 - alpha^(p+1)) / ((p+1)*(1-alpha)))\n        # where alpha = ((A-1)/(A+1))^2\n        alpha = ((A - 1.0) / (A + 1.0))**2\n        \n        # A numerically stable way to compute 1-alpha is 4A/(A+1)^2.\n        # This avoids catastrophic cancellation when A is large (alpha is near 1).\n        if A > 1.0:\n            one_minus_alpha = 4.0 * A / (A + 1.0)**2\n        else: # A == 1.0, so alpha is 0\n            one_minus_alpha = 1.0\n\n        # The term with (p+1) in the denominator is valid since p != -1 is given.\n        expectation_term = (1.0 - alpha**(p + 1.0)) / ((p + 1.0) * one_minus_alpha)\n        \n        bias_exact = E**p * (1.0 - expectation_term)\n\n        # Calculate first-order bias using the derived formula:\n        # Bias_fo = 2*p*E^p / A\n        bias_fo = (2.0 * p * (E**p)) / A\n\n        # Calculate the absolute error between the two bias estimates\n        abs_error = abs(bias_fo - bias_exact)\n\n        results.extend([bias_exact, bias_fo, abs_error])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}