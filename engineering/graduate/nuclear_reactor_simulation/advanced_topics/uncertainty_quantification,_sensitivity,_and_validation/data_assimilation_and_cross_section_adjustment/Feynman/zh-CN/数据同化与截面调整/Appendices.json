{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个实践是基础性的。它将引导您走过数据同化的核心数学过程：利用一次观测来更新我们对系统参数的先验知识。我们将推导在线性化模型下后验均值和协方差的经典公式，然后将它们应用于一个具体的核截面调整问题。这个练习旨在构建执行任何数据同化任务所需的基本计算技能。",
            "id": "4221177",
            "problem": "在双群无限介质核反应堆模拟中，一位反应堆物理学家试图同化单个标量堆芯探测器读数，以调整宏观吸收截面。设状态向量为 $x = [\\Sigma_{a,1}, \\Sigma_{a,2}]^{T}$，其中 $\\Sigma_{a,1}$ 和 $\\Sigma_{a,2}$ 是以靶恩（barns）为单位的分群宏观吸收截面。模型预测的标量可观测量为 $y = h(x)$，其中 $h$ 代表探测器响应模型。$x$ 的背景（先验）分布为高斯分布，其均值为 $x_{b}$，协方差矩阵为 $B$；测量误差为高斯分布，其均值为零，方差为 $R$。\n\n观测算子通常是非线性的，但为了在背景态附近进行分析，考虑 $h(x)$ 在 $x_{b}$ 附近的一阶泰勒近似：\n$$\ny \\approx h(x_{b}) + g^{T}(x - x_{b}),\n$$\n其中 $g$ 是 $h$ 相对于 $x$ 在 $x_{b}$ 处求得的梯度。\n\n使用贝叶斯定理并将线性化视为局部有效，完成以下任务：\n\n1) 从 $x$ 的高斯先验和在线性化模型下标量观测值 $y_{o}$ 的高斯似然出发，推导近似后验密度 $p(x \\mid y_{o})$。您的推导必须以 $x_{b}$、$B$、$g$、$R$、$h(x_{b})$ 和 $y_{o}$ 的闭合形式确定后验均值和后验协方差。\n\n2) 解释为什么对于严格线性的标量观测模型 $y = h(x_{b}) + g^{T}(x - x_{b}) + \\varepsilon$（其中 $\\varepsilon \\sim \\mathcal{N}(0,R)$），在第1部分中得到的后验实际上是精确后验，并陈述后验均值和后验协方差的相同闭合形式表达式。\n\n3) 现在，使用以下数值，为截面调整实例化一个物理上合理的数据同化：\n- 背景均值 $x_{b} = \\begin{pmatrix} 0.25 \\\\ 0.10 \\end{pmatrix}$ 靶恩，\n- 背景协方差 $B = \\begin{pmatrix} (0.04)^{2}  0.5 \\times 0.04 \\times 0.02 \\\\ 0.5 \\times 0.04 \\times 0.02  (0.02)^{2} \\end{pmatrix}$ 靶恩$^{2}$，\n- 梯度 $g = \\begin{pmatrix} -1.8 \\\\ -0.6 \\end{pmatrix}$，单位为可观测量单位/靶恩，\n- 测量误差方差 $R = (0.01)^{2}$，\n- 在背景处的模型评估值 $h(x_{b}) = 1.000$，\n- 测量值 $y_{o} = 1.015$。\n\n使用您推导出的公式，计算线性化模型下 $x$ 的后验均值向量。将您的最终数值答案表示为后验均值的两个分量，单位为靶恩。将您的答案四舍五入到四位有效数字。",
            "solution": "用户提供了一个关于用于核反应堆截面调整的贝叶斯数据同化的问题。在解决该问题之前，需要对其进行验证。\n\n### 步骤1：提取给定信息\n- 状态向量：$x = [\\Sigma_{a,1}, \\Sigma_{a,2}]^{T}$，表示分群宏观吸收截面。\n- $x$ 的先验分布：高斯分布，均值为 $x_{b}$，协方差矩阵为 $B$，记为 $x \\sim \\mathcal{N}(x_{b}, B)$。\n- 测量误差：高斯分布，均值为零，方差为 $R$，记为 $\\varepsilon \\sim \\mathcal{N}(0, R)$。\n- 观测算子：$y = h(x)$。\n- 线性化观测算子：$y \\approx h(x_{b}) + g^{T}(x - x_{b})$，其中 $g = \\nabla_x h(x)|_{x=x_b}$。\n- 标量测量观测值：$y_o$。\n- 第3部分的数值：\n    - 背景均值：$x_{b} = \\begin{pmatrix} 0.25 \\\\ 0.10 \\end{pmatrix}$ 靶恩\n    - 背景协方差：$B = \\begin{pmatrix} (0.04)^{2}  0.5 \\times 0.04 \\times 0.02 \\\\ 0.5 \\times 0.04 \\times 0.02  (0.02)^{2} \\end{pmatrix}$ 靶恩$^{2}$\n    - 梯度：$g = \\begin{pmatrix} -1.8 \\\\ -0.6 \\end{pmatrix}$\n    - 测量误差方差：$R = (0.01)^{2}$\n    - 在背景处的模型评估值：$h(x_{b}) = 1.000$\n    - 测量值：$y_{o} = 1.015$\n\n### 步骤2：使用提取的给定信息进行验证\n- **科学依据：** 该问题是贝叶斯推断（特别是三维变分法或卡尔曼更新方法）在核反应堆物理领域的标准应用。使用积分实验数据（如探测器读数）来调整截面是反应堆分析中的一项基本技术。该框架是合理的。\n- **适定性：** 问题陈述清晰。第1部分要求进行贝叶斯统计中的标准推导。第2部分要求对结果进行正确解释。第3部分提供了计算唯一解所需的所有数值数据。问题是适定的。\n- **客观性：** 语言正式且量化，没有主观或含糊的陈述。\n- **完整性和一致性：** 问题提供了所有必要的定义、变量和数值。没有矛盾之处。单位在物理上是一致的。\n- **真实性：** 宏观截面的数值（$0.25$ 和 $0.10$ 靶恩，如果我们假设单位“靶恩”是cm$^{-1}$的通俗用法，则为 $0.25$ cm$^{-1}$ 和 $0.10$ cm$^{-1}$）及其不确定性对于热中子反应堆系统是合理的。探测器测量值及其不确定性也是现实的。\n\n### 步骤3：结论与行动\n该问题是有效的。它在科学上是合理的，提法是明确的，并且提供了所有必要的信息。我现在将开始解答。\n\n### 第1部分：后验密度的推导\n\n后验概率密度函数（PDF）$p(x \\mid y_{o})$由贝叶斯定理给出：\n$$\np(x \\mid y_{o}) \\propto p(y_{o} \\mid x) p(x)\n$$\n其中 $p(y_o \\mid x)$ 是似然函数，$p(x)$ 是先验PDF。\n\n$x$ 的先验分布被给定为多元高斯分布：\n$$\np(x) = \\frac{1}{\\sqrt{(2\\pi)^{k} \\det(B)}} \\exp\\left(-\\frac{1}{2}(x - x_{b})^T B^{-1} (x - x_{b})\\right)\n$$\n其中 $k=2$ 是 $x$ 的维度。\n\n似然函数 $p(y_{o} \\mid x)$ 从观测模型和测量误差中导出。在线性化模型下，测量值 $y_o$ 与状态 $x$ 的关系为：\n$$\ny_o = h(x_b) + g^T(x - x_b) + \\varepsilon\n$$\n其中 $\\varepsilon \\sim \\mathcal{N}(0, R)$。这意味着对于给定的 $x$，$y_o$ 是一个随机变量，其高斯分布的中心位于 $h(x_b) + g^T(x - x_b)$，方差为 $R$。\n$$\np(y_{o} \\mid x) = \\frac{1}{\\sqrt{2\\pi R}} \\exp\\left(-\\frac{1}{2R} (y_{o} - (h(x_{b}) + g^{T}(x - x_{b})))^2\\right)\n$$\n\n后验PDF是先验和似然的乘积。由于归一化常数不依赖于 $x$，我们可以写成：\n$$\np(x \\mid y_{o}) \\propto \\exp\\left(-\\frac{1}{2}(x - x_{b})^T B^{-1} (x - x_{b})\\right) \\exp\\left(-\\frac{1}{2R}(y_o - h(x_b) - g^T(x - x_b))^2\\right)\n$$\n$$\np(x \\mid y_{o}) \\propto \\exp\\left(-\\frac{1}{2}\\left[(x - x_{b})^T B^{-1} (x - x_{b}) + R^{-1}(y_o - h(x_b) - g^T(x - x_b))^2\\right]\\right)\n$$\n指数中的表达式是 $x$ 的二次函数。这意味着后验分布 $p(x \\mid y_{o})$ 也是一个多元高斯分布。设后验均值为 $x_a$（分析状态），后验协方差为 $A$。后验PDF的形式为 $p(x \\mid y_{o}) \\propto \\exp(-\\frac{1}{2}(x - x_a)^T A^{-1}(x - x_a))$。\n\n后验均值 $x_a$ 是使后验PDF最大化的 $x$ 值，这等同于最小化指数中的代价函数 $J(x)$：\n$$\nJ(x) = (x - x_b)^T B^{-1} (x - x_b) + R^{-1}(y_o - h(x_b) - g^T(x - x_b))^2\n$$\n为了找到最小值，我们对 $J(x)$ 关于 $x$ 求梯度并令其为零：\n$$\n\\nabla_x J(x) = 2B^{-1}(x - x_b) + 2R^{-1}(y_o - h(x_b) - g^T(x - x_b))(-g) = 0\n$$\n在最小值处令 $x=x_a$：\n$$\nB^{-1}(x_a - x_b) - R^{-1}g(y_o - h(x_b) - g^T(x_a - x_b)) = 0\n$$\n$$\nB^{-1}(x_a - x_b) + R^{-1}gg^T(x_a - x_b) = R^{-1}g(y_o - h(x_b))\n$$\n$$\n(B^{-1} + R^{-1}gg^T)(x_a - x_b) = R^{-1}g(y_o - h(x_b))\n$$\n后验协方差矩阵 $A$ 是 $J(x)/2$ 的海森矩阵的逆。海森矩阵为 $\\nabla_x^2 (J(x)/2) = B^{-1} + R^{-1}gg^T$。因此，后验协方差为：\n$$\nA = (B^{-1} + R^{-1}gg^T)^{-1}\n$$\n后验均值 $x_a$ 可以通过求解 $(x_a - x_b)$ 得到：\n$$\nx_a - x_b = (B^{-1} + R^{-1}gg^T)^{-1} R^{-1}g(y_o - h(x_b))\n$$\n使用Woodbury矩阵恒等式，即 $(B^{-1} + UV)^{-1}U = B(I+VBU)^{-1}V$，或者更具体地对于此形式，$(B^{-1} + gR^{-1}g^T)^{-1}gR^{-1} = Bg(R+g^T B g)^{-1}$，我们可以简化表达式。\n令 $K = Bg(g^T B g + R)^{-1}$，即卡尔曼增益。\n均值的更新变为：\n$$\nx_a - x_b = K(y_o - h(x_b))\n$$\n所以，后验均值为：\n$$\nx_a = x_b + Bg(g^T B g + R)^{-1}(y_o - h(x_b))\n$$\n后验PDF为 $p(x \\mid y_{o}) \\sim \\mathcal{N}(x_a, A)$，其后验均值 $x_a$ 和后验协方差 $A$ 由上述闭合形式表达式给出。\n\n### 第2部分：对于严格线性模型的精确性\n\n如果观测模型是严格线性的，$y = h(x_b) + g^T(x-x_b) + \\varepsilon$，那么测量值 $y_o$ 与状态 $x$ 之间的关系由 $x$ 的一个线性函数加上一个高斯噪声项 $\\varepsilon$ 给出。\n先验分布 $p(x)$ 是严格高斯的：$x \\sim \\mathcal{N}(x_b, B)$。\n似然函数 $p(y_o \\mid x)$ 也是严格高斯的，因为它描述了给定 $x$ 时观测到 $y_o$ 的概率，即 $\\mathcal{N}(h(x_b) + g^T(x-x_b), R)$。\n后验PDF $p(x \\mid y_o)$ 正比于这两个高斯函数的乘积。两个高斯函数的乘积是另一个（未归一化的）高斯函数。第1部分的推导处理了这些高斯函数的指数。后验的负对数正比于代价函数 $J(x)$。由于先验和似然都是严格高斯的，$J(x)$ 是 $x$ 的一个严格二次函数。\n一个二次函数的最小化有唯一解，该解精确地对应于所得高斯后验分布的均值。该二次函数的海森矩阵是常数，其逆精确地给出了后验协方差。\n因此，第1部分中的推导（涉及找到 $J(x)$ 的最小值）在线性模型的假设下没有做任何近似。所导出的后验均值 $x_a$ 和后验协方差 $A$ 的表达式对于线性情况是精确的，而不是近似的。\n\n闭合形式表达式与第1部分推导出的相同：\n后验均值：$x_a = x_b + Bg(g^T B g + R)^{-1}(y_o - h(x_b))$\n后验协方差：$A = (B^{-1} + R^{-1}gg^T)^{-1} = B - Bg(g^T B g + R)^{-1}g^T B$\n\n### 第3部分：数值计算\n\n给定以下数值：\n- $x_{b} = \\begin{pmatrix} 0.25 \\\\ 0.10 \\end{pmatrix}$\n- $B = \\begin{pmatrix} (0.04)^{2}  0.5 \\times 0.04 \\times 0.02 \\\\ 0.5 \\times 0.04 \\times 0.02  (0.02)^{2} \\end{pmatrix} = \\begin{pmatrix} 0.0016  0.0004 \\\\ 0.0004  0.0004 \\end{pmatrix}$\n- $g = \\begin{pmatrix} -1.8 \\\\ -0.6 \\end{pmatrix}$\n- $R = (0.01)^{2} = 0.0001$\n- $h(x_{b}) = 1.000$\n- $y_{o} = 1.015$\n\n目标是计算后验均值 $x_a = x_b + Bg(g^T B g + R)^{-1}(y_o - h(x_b))$。\n\n1.  计算新息（测量残差）：\n    $$\n    d = y_o - h(x_b) = 1.015 - 1.000 = 0.015\n    $$\n2.  计算项 $Bg$：\n    $$\n    Bg = \\begin{pmatrix} 0.0016  0.0004 \\\\ 0.0004  0.0004 \\end{pmatrix} \\begin{pmatrix} -1.8 \\\\ -0.6 \\end{pmatrix} = \\begin{pmatrix} 0.0016(-1.8) + 0.0004(-0.6) \\\\ 0.0004(-1.8) + 0.0004(-0.6) \\end{pmatrix} = \\begin{pmatrix} -0.00288 - 0.00024 \\\\ -0.00072 - 0.00024 \\end{pmatrix} = \\begin{pmatrix} -0.00312 \\\\ -0.00096 \\end{pmatrix}\n    $$\n3.  计算投影的背景协方差 $g^T B g$：\n    $$\n    g^T B g = g^T(Bg) = \\begin{pmatrix} -1.8  -0.6 \\end{pmatrix} \\begin{pmatrix} -0.00312 \\\\ -0.00096 \\end{pmatrix} = (-1.8)(-0.00312) + (-0.6)(-0.00096) = 0.005616 + 0.000576 = 0.006192\n    $$\n4.  计算新息方差，这是一个标量：\n    $$\n    g^T B g + R = 0.006192 + 0.0001 = 0.006292\n    $$\n5.  计算卡尔曼增益向量 $K = Bg(g^T B g + R)^{-1}$：\n    $$\n    K = \\begin{pmatrix} -0.00312 \\\\ -0.00096 \\end{pmatrix} (0.006292)^{-1} = \\frac{1}{0.006292} \\begin{pmatrix} -0.00312 \\\\ -0.00096 \\end{pmatrix}\n    $$\n6.  计算更新项 $Kd$：\n    $$\n    Kd = \\frac{1}{0.006292} \\begin{pmatrix} -0.00312 \\\\ -0.00096 \\end{pmatrix} (0.015) = \\frac{0.015}{0.006292} \\begin{pmatrix} -0.00312 \\\\ -0.00096 \\end{pmatrix} \\approx 2.3840 \\begin{pmatrix} -0.00312 \\\\ -0.00096 \\end{pmatrix} \\approx \\begin{pmatrix} -0.007438 \\\\ -0.002289 \\end{pmatrix}\n    $$\n7.  计算后验均值 $x_a = x_b + Kd$：\n    $$\n    x_a = \\begin{pmatrix} 0.25 \\\\ 0.10 \\end{pmatrix} + \\begin{pmatrix} -0.007438 \\\\ -0.002289 \\end{pmatrix} = \\begin{pmatrix} 0.25 - 0.007438 \\\\ 0.10 - 0.002289 \\end{pmatrix} = \\begin{pmatrix} 0.242562 \\\\ 0.097711 \\end{pmatrix}\n    $$\n将后验均值的分量四舍五入到四位有效数字：\n- $x_{a,1} \\approx 0.2426$\n- $x_{a,2} \\approx 0.09771$\n\n后验均值向量为 $\\begin{pmatrix} 0.2426 \\\\ 0.09771 \\end{pmatrix}$ 靶恩。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.2426 \\\\ 0.09771 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一次成功的同化在很大程度上取决于我们对先验不确定性的准确描述。本实践探讨背景误差协方差矩阵 ($B$) 的关键作用，特别是其代表不同参数之间相关性的非对角线项。通过比较包含与忽略这些相关性时不确定性的减少情况，我们将量化忽略物理上合理的关系如何导致对实验价值得出误导性结论。",
            "id": "4221186",
            "problem": "考虑一个源于核反应堆模拟的双参数截面调整问题，其中一阶微扰理论指出，一个小的积分响应（如类反应性度量）与输入宏观截面的微小相对变化呈线性关系。具体而言，设无量纲相对偏差的未知参数矢量为 $x = \\begin{pmatrix}\\delta \\sigma_{a,1} \\\\ \\delta \\sigma_{f,1}\\end{pmatrix}$，其中 $\\delta \\sigma_{a,1}$ 和 $\\delta \\sigma_{f,1}$ 是单个能群的吸收和裂变宏观截面的群平均相对变化。观测到的标量响应 $y$ 建模为 $y = H x + \\epsilon$，其中 $H = \\begin{pmatrix} -0.8  1.1 \\end{pmatrix}$ 包含一阶灵敏度系数，$\\epsilon$ 是均值为零、方差为 $R = \\sigma_{y}^{2}$ 的测量噪声。\n\n假设 $x$ 服从零均值的高斯先验分布，其背景误差协方差矩阵为 $B$，该矩阵编码了截面不确定度之间具有物理动机的相关性（例如，由于共享的核数据和模型近似）。取\n$$\nB = \\begin{pmatrix}\n0.0036  0.00324 \\\\\n0.00324  0.0081\n\\end{pmatrix},\n$$\n这对应于先验标准差 $\\sigma_{\\delta \\sigma_{a,1}} = 0.06$ 和 $\\sigma_{\\delta \\sigma_{f,1}} = 0.09$，相关系数为 $\\rho = 0.6$。观测误差方差为 $R = 0.0025$。\n\n使用线性高斯数据同化框架，并从高斯先验和似然的贝叶斯推断第一性原理出发，推导 $x$ 的后验协方差，并为第一个参数 $\\delta \\sigma_{a,1}$ 计算方差缩减因子，其定义为\n$$\n\\mathrm{VRF} = \\frac{\\sigma_{\\delta \\sigma_{a,1}}^{2} - \\mathrm{Var}_{\\text{post}}(\\delta \\sigma_{a,1})}{\\sigma_{\\delta \\sigma_{a,1}}^{2}}。\n$$\n然后，通过在先验协方差被其对角化形式替代时重新计算方差缩减因子，来量化忽略 $B$ 中非对角项的影响\n$$\nB_{\\text{diag}} = \\begin{pmatrix}\n0.0036  0 \\\\\n0  0.0081\n\\end{pmatrix}。\n$$\n\n报告方差缩减因子的差异\n$$\n\\Delta \\mathrm{VRF} = \\mathrm{VRF}\\big|_{B_{\\text{diag}}} - \\mathrm{VRF}\\big|_{B}，\n$$\n结果以小数形式表示，并四舍五入到四位有效数字。最终答案无需单位。",
            "solution": "用户希望解决一个基于线性高斯模型的数据同化问题。\n\n### 步骤1：问题验证\n\n第一步是验证问题陈述。\n\n#### 提取已知条件\n-   相对偏差的参数矢量：$x = \\begin{pmatrix}\\delta \\sigma_{a,1} \\\\ \\delta \\sigma_{f,1}\\end{pmatrix}$\n-   线性观测模型：$y = H x + \\epsilon$\n-   灵敏度矩阵：$H = \\begin{pmatrix} -0.8  1.1 \\end{pmatrix}$\n-   测量噪声 $\\epsilon$：零均值，$\\mathbb{E}[\\epsilon]=0$，方差 $R = \\sigma_{y}^{2} = 0.0025$\n-   $x$ 的先验分布：零均值高斯分布，$\\mathbb{E}[x]=0$，先验协方差矩阵为\n    $$\n    B = \\begin{pmatrix}\n    0.0036  0.00324 \\\\\n    0.00324  0.0081\n    \\end{pmatrix}\n    $$\n-   先验标准差和相关性（用于验证）：$\\sigma_{\\delta \\sigma_{a,1}} = 0.06$，$\\sigma_{\\delta \\sigma_{f,1}} = 0.09$，$\\rho = 0.6$。我们来核对一下：$\\sigma_{\\delta \\sigma_{a,1}}^{2} = (0.06)^2 = 0.0036 = B_{11}$。$\\sigma_{\\delta \\sigma_{f,1}}^{2} = (0.09)^2 = 0.0081 = B_{22}$。$\\rho \\sigma_{\\delta \\sigma_{a,1}} \\sigma_{\\delta \\sigma_{f,1}} = 0.6 \\times 0.06 \\times 0.09 = 0.00324 = B_{12}$。这些数值是一致的。\n-   问题的第二部分所用的对角化先验协方差矩阵：\n    $$\n    B_{\\text{diag}} = \\begin{pmatrix}\n    0.0036  0 \\\\\n    0  0.0081\n    \\end{pmatrix}\n    $$\n-   $\\delta \\sigma_{a,1}$ 的方差缩减因子定义：\n    $$\n    \\mathrm{VRF} = \\frac{\\sigma_{\\delta \\sigma_{a,1}}^{2} - \\mathrm{Var}_{\\text{post}}(\\delta \\sigma_{a,1})}{\\sigma_{\\delta \\sigma_{a,1}}^{2}}\n    $$\n-   待计算量：$\\Delta \\mathrm{VRF} = \\mathrm{VRF}\\big|_{B_{\\text{diag}}} - \\mathrm{VRF}\\big|_{B}$，四舍五入到四位有效数字。\n\n#### 依据标准进行验证\n1.  **科学基础**：该问题是贝叶斯推断（特别是最佳线性无偏估计量，或BLUE）在核数据同化和截面调整背景下的一个标准应用。所有概念——灵敏度分析、协方差矩阵、贝叶斯更新——都是该领域的基础。该问题在科学上是合理的。\n2.  **适定性**：该问题在线性高斯框架内定义明确。先验协方差矩阵 $B$ 是对称正定的（$\\det(B) = (0.0036)(0.0081) - (0.00324)^2 = 2.916 \\times 10^{-5} - 1.04976 \\times 10^{-5} = 1.86624 \\times 10^{-5} > 0$，且迹为正）。观测误差方差 $R$ 是一个正标量。这保证了唯一的后验分布的存在，因此也保证了唯一解的存在。\n3.  **客观性**：该问题用精确的数学术语表述，没有歧义或主观论断。\n\n#### 结论\n问题有效。我们可以继续进行求解。\n\n### 步骤2：推导与求解\n\n该问题要求从贝叶斯推断的第一性原理进行推导。给定先验分布 $p(x)$ 和似然函数 $p(y|x)$，后验分布 $p(x|y)$ 由贝叶斯定理给出：\n$$\np(x|y) \\propto p(y|x) p(x)\n$$\n$x$ 的先验是一个协方差为 $B$ 的零均值高斯分布：\n$$\np(x) \\propto \\exp\\left(-\\frac{1}{2} x^T B^{-1} x\\right)\n$$\n观测模型为 $y = Hx + \\epsilon$，其中噪声 $\\epsilon \\sim N(0, R)$。这意味着在给定 $x$ 的条件下观测到 $y$ 的似然是一个均值为 $Hx$、协方差为 $R$ 的高斯分布：\n$$\np(y|x) \\propto \\exp\\left(-\\frac{1}{2} (y - Hx)^T R^{-1} (y - Hx)\\right)\n$$\n结合以上两点，后验分布为：\n$$\np(x|y) \\propto \\exp\\left(-\\frac{1}{2} \\left[ (y - Hx)^T R^{-1} (y - Hx) + x^T B^{-1} x \\right]\\right)\n$$\n指数的自变量是 $x$ 的一个二次函数。这意味着后验分布也是高斯分布，$p(x|y) \\sim N(\\hat{x}, A)$，其中 $\\hat{x}$ 是后验均值，$A$ 是后验协方差矩阵。后验协方差 $A$ 是该二次型（除以2）的Hessian矩阵的逆。方括号中的表达式是代价函数 $J(x)$。\n$$\nJ(x) = (y-Hx)^T R^{-1} (y-Hx) + x^T B^{-1} x\n$$\n$$\nJ(x) = y^T R^{-1} y - 2y^T R^{-1} Hx + x^T H^T R^{-1} Hx + x^T B^{-1} x\n$$\n$$\nJ(x) = x^T (H^T R^{-1} H + B^{-1}) x - 2y^T R^{-1} Hx + \\text{const}\n$$\n$\\frac{1}{2}J(x)$ 关于 $x$ 的 Hessian 矩阵是 $H^T R^{-1} H + B^{-1}$。后验协方差 $A$ 是这个 Hessian 矩阵的逆：\n$$\nA = (B^{-1} + H^T R^{-1} H)^{-1}\n$$\n出于计算目的，特别是当观测 $y$ 的维数小于状态 $x$ 的维数时（如此处情况，$1  2$），使用 Woodbury 矩阵恒等式会很方便：\n$$\nA = B - B H^T (H B H^T + R)^{-1} H B\n$$\n第一个参数 $\\delta \\sigma_{a,1}$ 的先验方差是 $\\sigma_{\\delta \\sigma_{a,1}}^{2} = B_{11} = 0.0036$。后验方差是 $\\mathrm{Var}_{\\text{post}}(\\delta \\sigma_{a,1}) = A_{11}$。\n方差缩减量是 VRF 的分子：$\\sigma_{\\delta \\sigma_{a,1}}^{2} - \\mathrm{Var}_{\\text{post}}(\\delta \\sigma_{a,1}) = B_{11} - A_{11}$。\n从 Woodbury 公式中，我们可以确定 $A_{11}$：\n$$\nA_{11} = B_{11} - \\left( B H^T (H B H^T + R)^{-1} H B \\right)_{11}\n$$\n我们定义新息协方差 $S = H B H^T + R$ 和状态矢量与可观测量之间的先验协方差 $v = B H^T$。由于 $S$ 是一个标量，其逆为 $1/S$。矩阵 $B H^T (H B)^T / S = v v^T / S$ 是一个外积。该矩阵的 $(1,1)$ 分量是 $v_1^2 / S$。\n所以，$A_{11} = B_{11} - \\frac{v_1^2}{S}$。\n方差缩减量是 $B_{11} - A_{11} = \\frac{v_1^2}{S}$。\n那么方差缩减因子是：\n$$\n\\mathrm{VRF} = \\frac{B_{11} - A_{11}}{B_{11}} = \\frac{v_1^2}{S \\cdot B_{11}} = \\frac{( (B H^T)_1 )^2}{(H B H^T + R) B_{11}}\n$$\n\n#### 第1部分：使用完整协方差矩阵 $B$ 进行计算\n\n首先，我们计算 $\\mathrm{VRF}\\big|_{B}$ 所需的各项。\n灵敏度矩阵为 $H = \\begin{pmatrix} -0.8  1.1 \\end{pmatrix}$。\n先验协方差为 $B = \\begin{pmatrix} 0.0036  0.00324 \\\\ 0.00324  0.0081 \\end{pmatrix}$。\n矢量 $v = B H^T$ 为：\n$$\nv = \\begin{pmatrix} 0.0036  0.00324 \\\\ 0.00324  0.0081 \\end{pmatrix} \\begin{pmatrix} -0.8 \\\\ 1.1 \\end{pmatrix} = \\begin{pmatrix} 0.0036(-0.8) + 0.00324(1.1) \\\\ 0.00324(-0.8) + 0.0081(1.1) \\end{pmatrix} = \\begin{pmatrix} -0.00288 + 0.003564 \\\\ -0.002592 + 0.00891 \\end{pmatrix} = \\begin{pmatrix} 0.000684 \\\\ 0.006318 \\end{pmatrix}\n$$\n第一个元素是 $v_1 = 0.000684$。\n新息协方差项 $H B H^T$ 为：\n$$\nH B H^T = H v = \\begin{pmatrix} -0.8  1.1 \\end{pmatrix} \\begin{pmatrix} 0.000684 \\\\ 0.006318 \\end{pmatrix} = (-0.8)(0.000684) + (1.1)(0.006318) = -0.0005472 + 0.0069498 = 0.0064026\n$$\n完整的新息协方差 $S = H B H^T + R$，其中 $R = 0.0025$：\n$$\nS = 0.0064026 + 0.0025 = 0.0089026\n$$\n第一个参数的先验方差是 $B_{11} = 0.0036$。\n现在，我们计算 $\\mathrm{VRF}\\big|_{B}$：\n$$\n\\mathrm{VRF}\\big|_{B} = \\frac{v_1^2}{S \\cdot B_{11}} = \\frac{(0.000684)^2}{(0.0089026)(0.0036)} = \\frac{4.67856 \\times 10^{-7}}{3.204936 \\times 10^{-5}} \\approx 0.0145979\n$$\n\n#### 第2部分：使用对角协方差矩阵 $B_{\\text{diag}}$ 进行计算\n\n接下来，我们使用 $B_{\\text{diag}} = \\begin{pmatrix} 0.0036  0 \\\\ 0  0.0081 \\end{pmatrix}$ 重复计算。\n矢量 $v_{\\text{diag}} = B_{\\text{diag}} H^T$ 为：\n$$\nv_{\\text{diag}} = \\begin{pmatrix} 0.0036  0 \\\\ 0  0.0081 \\end{pmatrix} \\begin{pmatrix} -0.8 \\\\ 1.1 \\end{pmatrix} = \\begin{pmatrix} 0.0036(-0.8) + 0(1.1) \\\\ 0(-0.8) + 0.0081(1.1) \\end{pmatrix} = \\begin{pmatrix} -0.00288 \\\\ 0.00891 \\end{pmatrix}\n$$\n第一个元素是 $(v_{\\text{diag}})_1 = -0.00288$。\n新息协方差项 $H B_{\\text{diag}} H^T$ 为：\n$$\nH B_{\\text{diag}} H^T = H v_{\\text{diag}} = \\begin{pmatrix} -0.8  1.1 \\end{pmatrix} \\begin{pmatrix} -0.00288 \\\\ 0.00891 \\end{pmatrix} = (-0.8)(-0.00288) + (1.1)(0.00891) = 0.002304 + 0.009801 = 0.012105\n$$\n完整的新息协方差 $S_{\\text{diag}} = H B_{\\text{diag}} H^T + R$：\n$$\nS_{\\text{diag}} = 0.012105 + 0.0025 = 0.014605\n$$\n第一个参数的先验方差是 $(B_{\\text{diag}})_{11} = 0.0036$。\n现在，我们计算 $\\mathrm{VRF}\\big|_{B_{\\text{diag}}}$：\n$$\n\\mathrm{VRF}\\big|_{B_{\\text{diag}}} = \\frac{((v_{\\text{diag}})_1)^2}{S_{\\text{diag}} \\cdot (B_{\\text{diag}})_{11}} = \\frac{(-0.00288)^2}{(0.014605)(0.0036)} = \\frac{8.2944 \\times 10^{-6}}{5.2578 \\times 10^{-5}} \\approx 0.157754\n$$\n\n#### 第3部分：方差缩减因子的差异\n\n最后，我们计算差异 $\\Delta \\mathrm{VRF} = \\mathrm{VRF}\\big|_{B_{\\text{diag}}} - \\mathrm{VRF}\\big|_{B}$。\n$$\n\\Delta \\mathrm{VRF} \\approx 0.157754 - 0.0145979 = 0.1431561\n$$\n四舍五入到四位有效数字，我们得到 $0.1432$。\n忽略吸收截面和裂变截面不确定度之间具有物理动机的正相关，会导致对从给定积分测量中可实现的吸收截面方差缩减的显著高估。这凸显了精确的先验协方差模型在数据同化中的关键重要性。",
            "answer": "$$\n\\boxed{0.1432}\n$$"
        },
        {
            "introduction": "在执行数据同化后，我们如何对结果建立信心？本实践介绍一个关键的诊断工具——$\\chi^2$（卡方）失配统计量。我们将计算该值并探讨其理论期望，这为我们的观测、模型和假设的误差协方差之间的一致性提供了强有力的统计检验。",
            "id": "4221109",
            "problem": "在稳态核反应堆堆芯模拟中，考虑三个堆芯探测器响应对于应用于双群扩散模型中微观吸收截面的两个未知乘法调整因子的线性化灵敏度。设观测算子为矩阵 $H \\in \\mathbb{R}^{m \\times n}$，其中 $m = 3$ 且 $n = 2$，测量误差协方差为 $R \\in \\mathbb{R}^{3 \\times 3}$，截面调整因子的分析（同化）状态为 $\\hat{x} \\in \\mathbb{R}^{2}$。测得的探测器响应向量为 $d \\in \\mathbb{R}^{3}$。相对于假定的测量误差协方差，卡方失配统计量定义为\n$$\n\\chi^{2} = (d - H \\hat{x})^{T} R^{-1} (d - H \\hat{x}).\n$$\n假设数值如下：\n$$\nH = \\begin{pmatrix}\n1  0 \\\\\n0  2 \\\\\n0  0\n\\end{pmatrix}, \\quad\nR = \\operatorname{diag}\\!\\left(\\tfrac{1}{4}, 1, 4\\right), \\quad\n\\hat{x} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}, \\quad\nd = \\begin{pmatrix} 0 \\\\ -2 \\\\ 1 \\end{pmatrix}.\n$$\n此外，为了评估同化后的有效自由度，设调整因子的背景误差协方差为\n$$\nB = \\operatorname{diag}\\!\\left(1, \\tfrac{1}{2}\\right).\n$$\n任务：\n- 使用给定的 $H$、$R$、$\\hat{x}$ 和 $d$ 计算 $\\chi^{2}$ 的数值。将数值答案表示为一个纯数（无量纲），并四舍五入到四位有效数字。\n- 然后，仅用 $H$、卡尔曼增益 $K$ 和测量次数 $m$ 推导期望值 $\\mathbb{E}[\\chi^{2}]$ 的闭式解析表达式。您的表达式必须明确阐明与同化后有效自由度的联系。\n\n陈述推导中使用的所有中间步骤和假设。将最终的 $\\chi^{2}$ 数值表示为一个无单位的纯数，并提供 $\\mathbb{E}[\\chi^{2}]$ 的闭式解析表达式。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第1步：提取已知条件\n- 测量次数为 $m=3$。\n- 状态变量（调整因子）的数量为 $n=2$。\n- 观测算子为 $H = \\begin{pmatrix} 1  0 \\\\ 0  2 \\\\ 0  0 \\end{pmatrix}$。\n- 测量误差协方差矩阵为 $R = \\operatorname{diag}\\!\\left(\\frac{1}{4}, 1, 4\\right)$。\n- 分析状态向量为 $\\hat{x} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n- 测量向量为 $d = \\begin{pmatrix} 0 \\\\ -2 \\\\ 1 \\end{pmatrix}$。\n- 背景误差协方差矩阵为 $B = \\operatorname{diag}\\!\\left(1, \\frac{1}{2}\\right)$。\n- 卡方失配统计量定义为 $\\chi^{2} = (d - H \\hat{x})^{T} R^{-1} (d - H \\hat{x})$。\n- 任务是：\n    1. 计算 $\\chi^{2}$ 的数值并四舍五入到四位有效数字。\n    2. 用 $H$、卡尔曼增益 $K$ 和测量次数 $m$ 推导期望值 $\\mathbb{E}[\\chi^{2}]$ 的解析表达式。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据充分：** 该问题使用了统计数据同化和逆问题理论中的标准、公认的概念和定义，特别是在核反应堆物理（截面调整）的背景下。其表述在科学上是合理的。\n- **适定的：** 为进行数值计算，所有必需的矩阵和向量均已提供。第二个任务需要基于标准数据同化框架的理论推导，该框架通过使用“卡尔曼增益”和“背景误差协方差”等术语被隐式引用。该问题是自洽的，并为两部分提供了通往唯一解的清晰路径。\n- **客观性：** 该问题使用精确的数学和科学语言陈述，没有主观性或歧义。\n- **一致性和完整性：** 所有矩阵和向量的维度都是一致的：$H \\in \\mathbb{R}^{3 \\times 2}$，$R \\in \\mathbb{R}^{3 \\times 3}$，$\\hat{x} \\in \\mathbb{R}^{2 \\times 1}$，$d \\in \\mathbb{R}^{3 \\times 1}$。第一个任务是直接计算。第二个任务是一般性的理论推导，其中给定的数值（包括 $B$）是作为背景信息，而不是最终符号形式的必要输入。不存在矛盾。\n\n### 第3步：结论与行动\n该问题被认定为有效。将提供完整解答。\n\n### 第1部分：$\\chi^2$ 的数值计算\n卡方统计量由以下公式给出：\n$$\n\\chi^{2} = (d - H \\hat{x})^{T} R^{-1} (d - H \\hat{x})\n$$\n首先，我们计算乘积 $H \\hat{x}$：\n$$\nH \\hat{x} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} (1)(1) + (0)(-1) \\\\ (0)(1) + (2)(-1) \\\\ (0)(1) + (0)(-1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -2 \\\\ 0 \\end{pmatrix}\n$$\n接下来，我们计算残差向量，记为 $v$：\n$$\nv = d - H \\hat{x} = \\begin{pmatrix} 0 \\\\ -2 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 - 1 \\\\ -2 - (-2) \\\\ 1 - 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n测量误差协方差矩阵是一个对角矩阵：\n$$\nR = \\begin{pmatrix} \\frac{1}{4}  0  0 \\\\ 0  1  0 \\\\ 0  0  4 \\end{pmatrix}\n$$\n其逆矩阵 $R^{-1}$ 是一个对角矩阵，其对角线元素是 $R$ 对角线元素的倒数：\n$$\nR^{-1} = \\begin{pmatrix} 4  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{4} \\end{pmatrix}\n$$\n现在，我们可以将 $\\chi^2$ 计算为二次型 $v^T R^{-1} v$：\n$$\n\\chi^{2} = \\begin{pmatrix} -1  0  1 \\end{pmatrix} \\begin{pmatrix} 4  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\chi^{2} = \\begin{pmatrix} -1  0  1 \\end{pmatrix} \\begin{pmatrix} (4)(-1) + (0)(0) + (0)(1) \\\\ (0)(-1) + (1)(0) + (0)(1) \\\\ (0)(-1) + (0)(0) + (\\frac{1}{4})(1) \\end{pmatrix} = \\begin{pmatrix} -1  0  1 \\end{pmatrix} \\begin{pmatrix} -4 \\\\ 0 \\\\ \\frac{1}{4} \\end{pmatrix}\n$$\n$$\n\\chi^{2} = (-1)(-4) + (0)(0) + (1)\\left(\\frac{1}{4}\\right) = 4 + \\frac{1}{4} = 4.25\n$$\n四舍五入到四位有效数字，数值为 $4.250$。\n\n### 第2部分：$\\mathbb{E}[\\chi^2]$ 的解析推导\n我们旨在推导 $\\mathbb{E}[\\chi^{2}] = \\mathbb{E}[(d - H \\hat{x})^{T} R^{-1} (d - H \\hat{x})]$ 的表达式。此推导依赖于线性数据同化的统计框架。\n\n令 $x_t$ 为真实状态向量。测量向量 $d$ 可建模为：\n$$\nd = H x_t + \\epsilon_d\n$$\n其中 $\\epsilon_d$ 是测量误差，假设为一个随机变量，其均值为 $\\mathbb{E}[\\epsilon_d] = 0$，协方差为 $\\mathbb{E}[\\epsilon_d \\epsilon_d^T] = R$。\n\n分析状态 $\\hat{x}$ 是最佳线性无偏估计 (BLUE)，由下式给出：\n$$\n\\hat{x} = x_b + K(d - Hx_b)\n$$\n其中 $x_b$ 是背景（先验）状态估计，其误差 $\\epsilon_b = x_b - x_t$ 满足 $\\mathbb{E}[\\epsilon_b] = 0$ 和 $\\mathbb{E}[\\epsilon_b \\epsilon_b^T] = B$。假设背景误差和测量误差不相关，因此 $\\mathbb{E}[\\epsilon_b \\epsilon_d^T] = 0$。矩阵 $K$ 是卡尔曼增益，由 $K = B H^T (H B H^T + R)^{-1}$ 给出。\n\n我们分析分析残差向量 $d - H\\hat{x}$：\n$$\nd - H\\hat{x} = d - H(x_b + K(d - Hx_b)) = (I - HK)(d - Hx_b)\n$$\n其中 $I$ 是大小为 $m \\times m$ 的单位矩阵。\n我们可以用基本误差表示新息向量 $d - Hx_b$：\n$$\nd - Hx_b = (H x_t + \\epsilon_d) - Hx_b = \\epsilon_d - H(x_b - x_t) = \\epsilon_d - H\\epsilon_b\n$$\n因此，分析残差为：\n$$\nd - H\\hat{x} = (I - HK)(\\epsilon_d - H\\epsilon_b)\n$$\n为了计算 $\\mathbb{E}[\\chi^2]$，我们使用二次型期望的迹性质：$\\mathbb{E}[y^T A y] = \\operatorname{tr}(A \\mathbb{E}[yy^T])$。这里，$A=R^{-1}$ 且 $y = d - H\\hat{x}$。\n$$\n\\mathbb{E}[\\chi^2] = \\operatorname{tr}\\left(R^{-1} \\mathbb{E}\\left[(d - H\\hat{x})(d - H\\hat{x})^T\\right]\\right)\n$$\n分析残差的协方差为：\n$$\n\\mathbb{E}\\left[(d - H\\hat{x})(d - H\\hat{x})^T\\right] = (I-HK) \\mathbb{E}\\left[(\\epsilon_d - H\\epsilon_b)(\\epsilon_d - H\\epsilon_b)^T\\right] (I-HK)^T\n$$\n新息 $(\\epsilon_d - H\\epsilon_b)$ 的协方差为：\n$$\n\\mathbb{E}\\left[(\\epsilon_d - H\\epsilon_b)(\\epsilon_d - H\\epsilon_b)^T\\right] = \\mathbb{E}[\\epsilon_d \\epsilon_d^T] - \\mathbb{E}[\\epsilon_d \\epsilon_b^T]H^T - H\\mathbb{E}[\\epsilon_b \\epsilon_d^T] + H\\mathbb{E}[\\epsilon_b \\epsilon_b^T]H^T = R + HBH^T\n$$\n令 $S = HBH^T + R$。分析残差的协方差变为：\n$$\n\\mathbb{E}\\left[(d - H\\hat{x})(d - H\\hat{x})^T\\right] = (I-HK) S (I-HK)^T\n$$\n数据同化中的一个关键恒等式是 $I-HK = R S^{-1}$。将其代入表达式中：\n$$\n(I-HK) S (I-HK)^T = (R S^{-1}) S (R S^{-1})^T = R S^{-1} S (S^{-T} R^T) = R S^{-T} R^T\n$$\n由于 $R$ 和 $B$ 是对称的，所以 $S=HBH^T+R$ 也是对称的 ($S=S^T$)，因此 $S^{-T} = S^{-1}$。所以，分析残差的协方差是 $R S^{-1} R$。\n\n将此结果代回 $\\mathbb{E}[\\chi^2]$ 的表达式中：\n$$\n\\mathbb{E}[\\chi^2] = \\operatorname{tr}\\left(R^{-1} (R S^{-1} R)\\right) = \\operatorname{tr}(S^{-1} R) = \\operatorname{tr}(R S^{-1})\n$$\n使用恒等式 $I-HK = R S^{-1}$，我们得到：\n$$\n\\mathbb{E}[\\chi^2] = \\operatorname{tr}(I - HK)\n$$\n使用迹算子的线性和循环性质：\n$$\n\\mathbb{E}[\\chi^2] = \\operatorname{tr}(I) - \\operatorname{tr}(HK) = m - \\operatorname{tr}(HK)\n$$\n这个表达式给出了卡方失配的期望值。项 $\\operatorname{tr}(HK)$ 是观测空间中影响矩阵（或帽子矩阵）的迹。它表示被拟合的有效参数数量，或由于同化过程导致的自由度减少量。可从测量中获得的总自由度为 $m$。模型拟合后，残差的有效自由度减少了 $\\operatorname{tr}(HK)$。因此，$\\mathbb{E}[\\chi^2] = m - \\operatorname{tr}(HK)$ 表示同化后系统的有效自由度。",
            "answer": "$$\n\\boxed{\\begin{aligned} \\chi^2 = 4.250 \\\\ \\mathbb{E}[\\chi^2] = m - \\operatorname{tr}(HK) \\end{aligned}}\n$$"
        }
    ]
}