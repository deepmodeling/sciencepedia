{
    "hands_on_practices": [
        {
            "introduction": "算子分裂法功能强大，但它们是近似方法，会引入误差。第一个练习将深入探讨 Lie-Trotter 方法中这种误差的核心。通过分析一个代表输运-燃耗耦合的简化 $2 \\times 2$ 线性系统，你将分析推导出算子的非对易性如何导致一个与时间步长 $\\Delta t$ 的平方成正比的误差项，从而对分裂误差的根本来源建立具体理解。",
            "id": "4240100",
            "problem": "在短时间间隔内，核反应堆中的单个均匀空间区域通过一个耦合了中子输运和核素燃耗的线性化双态系统进行建模。设状态向量为 $\\mathbf{y}(t) = \\begin{pmatrix} \\psi(t) \\\\ N(t) \\end{pmatrix}$，其中 $\\psi(t)$ 是标量中子通量幅度，$N(t)$ 是单个代表性核素的数密度。在一个小的时间步长 $\\Delta t$ 内，假设其演化由一个具有常算子的线性系统 $\\dot{\\mathbf{y}}(t) = (\\mathbf{T} + \\mathbf{D}) \\mathbf{y}(t)$ 控制\n$$\n\\mathbf{T} = \\begin{pmatrix} s  r \\\\ 0  0 \\end{pmatrix}, \\qquad\n\\mathbf{D} = \\begin{pmatrix} 0  0 \\\\ p  -\\lambda \\end{pmatrix},\n$$\n其中 $s$、$r$、$p$ 和 $\\lambda$ 是在该步长内不变的实常数，分别代表线性化中子输运增长率、中子幅度对核素密度的灵敏度、从中子到核素的产生耦合以及核素移除率。在 $\\Delta t$ 上的精确传播子是 $\\exp((\\mathbf{T}+\\mathbf{D}) \\Delta t)$。\n\n在 Lie-Trotter 算子分裂近似中，通常使用两种一阶分解：先应用燃耗后应用输运得到 $\\mathbf{U}_{D \\to T} = \\exp(\\mathbf{D}\\,\\Delta t)\\,\\exp(\\mathbf{T}\\,\\Delta t)$，而先应用输运后应用燃耗得到 $\\mathbf{U}_{T \\to D} = \\exp(\\mathbf{T}\\,\\Delta t)\\,\\exp(\\mathbf{D}\\,\\Delta t)$。\n\n仅从矩阵指数的幂级数定义和对易子 $[\\mathbf{A},\\mathbf{B}] \\equiv \\mathbf{A}\\mathbf{B} - \\mathbf{B}\\mathbf{A}$ 的定义出发，推导其差值，并保留截至 $(\\Delta t)^{2}$ 阶的项\n$$\n\\Delta \\mathbf{U} \\equiv \\mathbf{U}_{D \\to T} - \\mathbf{U}_{T \\to D},\n$$\n并用两种等效方式表示：首先，用 $\\mathbf{D}$ 和 $\\mathbf{T}$ 的对易子表示；其次，用参数 $s$、$r$、$p$、$\\lambda$ 和 $\\Delta t$ 表示为一个显式的 $2 \\times 2$ 矩阵。忽略所有 $\\mathcal{O}((\\Delta t)^{3})$ 阶及更高阶的项。将您的最终答案表示为 $\\Delta \\mathbf{U}$ 的截至 $(\\Delta t)^{2}$ 阶的显式 $2 \\times 2$ 矩阵表达式。不需要数值，也不需要单位。最终答案必须是单个解析表达式。",
            "solution": "该问题要求对于一个给定的线性系统，推导两种一阶 Lie-Trotter 算子分裂近似之间的差值。该差值 $\\Delta \\mathbf{U} \\equiv \\mathbf{U}_{D \\to T} - \\mathbf{U}_{T \\to D}$ 需要确定到包括 $(\\Delta t)^{2}$ 阶的项。根据题目要求，我们从矩阵指数的幂级数定义开始。\n\n方阵 $\\mathbf{X}$ 的指数的幂级数定义为：\n$$\n\\exp(\\mathbf{X}) = \\sum_{k=0}^{\\infty} \\frac{\\mathbf{X}^k}{k!} = \\mathbf{I} + \\mathbf{X} + \\frac{1}{2!}\\mathbf{X}^2 + \\frac{1}{3!}\\mathbf{X}^3 + \\dots\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。为解决此问题，我们需要将指数项展开到时间步长 $\\Delta t$ 的二阶。我们忽略所有 $\\mathcal{O}((\\Delta t)^{3})$ 阶及更高阶的项。\n\n所讨论的两个算子是 $\\mathbf{T}$ 和 $\\mathbf{D}$。我们需要展开的指数项是 $\\exp(\\mathbf{T}\\,\\Delta t)$ 和 $\\exp(\\mathbf{D}\\,\\Delta t)$：\n$$\n\\exp(\\mathbf{T}\\,\\Delta t) = \\mathbf{I} + (\\mathbf{T}\\,\\Delta t) + \\frac{1}{2}(\\mathbf{T}\\,\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3) = \\mathbf{I} + \\mathbf{T}\\Delta t + \\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\n\\exp(\\mathbf{D}\\,\\Delta t) = \\mathbf{I} + (\\mathbf{D}\\,\\Delta t) + \\frac{1}{2}(\\mathbf{D}\\,\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3) = \\mathbf{I} + \\mathbf{D}\\Delta t + \\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n\n现在，我们可以通过将这些级数展开式相乘来写出两种分裂近似。\n\n首先，对于“先燃耗后输运”近似 $\\mathbf{U}_{D \\to T} = \\exp(\\mathbf{D}\\,\\Delta t)\\,\\exp(\\mathbf{T}\\,\\Delta t)$：\n$$\n\\mathbf{U}_{D \\to T} = \\left( \\mathbf{I} + \\mathbf{D}\\Delta t + \\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2 \\right) \\left( \\mathbf{I} + \\mathbf{T}\\Delta t + \\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2 \\right) + \\mathcal{O}((\\Delta t)^3)\n$$\n我们进行矩阵乘法，仅保留截至 $(\\Delta t)^2$ 阶的项：\n$$\n\\mathbf{U}_{D \\to T} = \\mathbf{I}(\\mathbf{I} + \\mathbf{T}\\Delta t + \\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2) + \\mathbf{D}\\Delta t(\\mathbf{I} + \\mathbf{T}\\Delta t) + \\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2(\\mathbf{I}) + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\n\\mathbf{U}_{D \\to T} = \\mathbf{I} + \\mathbf{T}\\Delta t + \\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2 + \\mathbf{D}\\Delta t + \\mathbf{D}\\mathbf{T}(\\Delta t)^2 + \\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n按 $\\Delta t$ 的幂次收集项：\n$$\n\\mathbf{U}_{D \\to T} = \\mathbf{I} + (\\mathbf{D} + \\mathbf{T})\\Delta t + \\left(\\mathbf{D}\\mathbf{T} + \\frac{1}{2}\\mathbf{D}^2 + \\frac{1}{2}\\mathbf{T}^2\\right)(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n\n其次，对于“先输运后燃耗”近似 $\\mathbf{U}_{T \\to D} = \\exp(\\mathbf{T}\\,\\Delta t)\\,\\exp(\\mathbf{D}\\,\\Delta t)$，我们只需在上述展开式中交换 $\\mathbf{T}$ 和 $\\mathbf{D}$ 的角色：\n$$\n\\mathbf{U}_{T \\to D} = \\left( \\mathbf{I} + \\mathbf{T}\\Delta t + \\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2 \\right) \\left( \\mathbf{I} + \\mathbf{D}\\Delta t + \\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2 \\right) + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\n\\mathbf{U}_{T \\to D} = \\mathbf{I} + (\\mathbf{T} + \\mathbf{D})\\Delta t + \\left(\\mathbf{T}\\mathbf{D} + \\frac{1}{2}\\mathbf{T}^2 + \\frac{1}{2}\\mathbf{D}^2\\right)(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n\n现在我们求差值 $\\Delta \\mathbf{U} = \\mathbf{U}_{D \\to T} - \\mathbf{U}_{T \\to D}$。单位矩阵项和 $\\Delta t$ 的一阶项相消。$\\frac{1}{2}\\mathbf{D}^2(\\Delta t)^2$ 和 $\\frac{1}{2}\\mathbf{T}^2(\\Delta t)^2$ 项也相消。\n$$\n\\Delta \\mathbf{U} = \\left[ \\left(\\mathbf{D}\\mathbf{T} + \\frac{1}{2}\\mathbf{D}^2 + \\frac{1}{2}\\mathbf{T}^2\\right)(\\Delta t)^2 \\right] - \\left[ \\left(\\mathbf{T}\\mathbf{D} + \\frac{1}{2}\\mathbf{T}^2 + \\frac{1}{2}\\mathbf{D}^2\\right)(\\Delta t)^2 \\right] + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\n\\Delta \\mathbf{U} = (\\mathbf{D}\\mathbf{T} - \\mathbf{T}\\mathbf{D})(\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n使用对易子的定义 $[\\mathbf{A},\\mathbf{B}] \\equiv \\mathbf{A}\\mathbf{B} - \\mathbf{B}\\mathbf{A}$，我们得到第一个所要求的表达式：\n$$\n\\Delta \\mathbf{U} = [\\mathbf{D}, \\mathbf{T}](\\Delta t)^2 + \\mathcal{O}((\\Delta t)^3)\n$$\n此结果表明，两种分裂方案之间的差异（这是分裂误差的一种度量）与算子的对易子成正比，并且是时间步长的二阶项。\n\n对于问题的第二部分，我们使用给定的矩阵显式地计算这个对易子：\n$$\n\\mathbf{T} = \\begin{pmatrix} s  r \\\\ 0  0 \\end{pmatrix}, \\qquad \\mathbf{D} = \\begin{pmatrix} 0  0 \\\\ p  -\\lambda \\end{pmatrix}\n$$\n我们计算矩阵乘积 $\\mathbf{D}\\mathbf{T}$ 和 $\\mathbf{T}\\mathbf{D}$：\n$$\n\\mathbf{D}\\mathbf{T} = \\begin{pmatrix} 0  0 \\\\ p  -\\lambda \\end{pmatrix} \\begin{pmatrix} s  r \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} (0)(s) + (0)(0)  (0)(r) + (0)(0) \\\\ (p)(s) + (-\\lambda)(0)  (p)(r) + (-\\lambda)(0) \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ ps  pr \\end{pmatrix}\n$$\n$$\n\\mathbf{T}\\mathbf{D} = \\begin{pmatrix} s  r \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ p  -\\lambda \\end{pmatrix} = \\begin{pmatrix} (s)(0) + (r)(p)  (s)(0) + (r)(-\\lambda) \\\\ (0)(0) + (0)(p)  (0)(0) + (0)(-\\lambda) \\end{pmatrix} = \\begin{pmatrix} pr  -r\\lambda \\\\ 0  0 \\end{pmatrix}\n$$\n对易子矩阵是这两个乘积的差：\n$$\n[\\mathbf{D}, \\mathbf{T}] = \\mathbf{D}\\mathbf{T} - \\mathbf{T}\\mathbf{D} = \\begin{pmatrix} 0  0 \\\\ ps  pr \\end{pmatrix} - \\begin{pmatrix} pr  -r\\lambda \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0-pr  0-(-r\\lambda) \\\\ ps-0  pr-0 \\end{pmatrix} = \\begin{pmatrix} -pr  r\\lambda \\\\ ps  pr \\end{pmatrix}\n$$\n最后，我们将此矩阵代入 $\\Delta \\mathbf{U}$ 的表达式，并忽略更高阶的项，按要求提供显式的 $2 \\times 2$ 矩阵：\n$$\n\\Delta \\mathbf{U} = [\\mathbf{D}, \\mathbf{T}](\\Delta t)^2 = \\begin{pmatrix} -pr  r\\lambda \\\\ ps  pr \\end{pmatrix} (\\Delta t)^2 = \\begin{pmatrix} -pr (\\Delta t)^2  r\\lambda (\\Delta t)^2 \\\\ ps (\\Delta t)^2  pr (\\Delta t)^2 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -pr(\\Delta t)^{2}  r\\lambda(\\Delta t)^{2} \\\\ ps(\\Delta t)^{2}  pr(\\Delta t)^{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理解了分裂误差源于算子的非对易性之后，下一步便是量化并控制它。本练习将比较一阶 Lie-Trotter 方法与更高阶的 Strang 分裂法。你将使用 Baker-Campbell-Hausdorff (BCH) 公式推导误差界，并将其应用于一个实际决策：是否接受一个时间步长，这是自适应时间步长算法中的一个核心概念。",
            "id": "4240076",
            "problem": "考虑一个耦合的中子输运-燃料燃耗系统，其在一个时间步长内的状态是通过算子分裂来推进的。假设组合生成算子可以写为单个步长内两个不依赖时间的算子之和，即输运算子 $\\mathcal{T}$ 和燃耗算子 $\\mathcal{D}$，因此在时长 $\\Delta t$ 内的精确单步传播算子为 $\\exp\\!\\big(\\Delta t(\\mathcal{T}+\\mathcal{D})\\big)$。在实践中，可以使用 Lie-Trotter 分裂 $\\exp(\\Delta t\\,\\mathcal{T})\\,\\exp(\\Delta t\\,\\mathcal{D})$ 或 Strang（对称）分裂 $\\exp\\!\\big(\\frac{\\Delta t}{2}\\mathcal{T}\\big)\\,\\exp(\\Delta t\\,\\mathcal{D})\\,\\exp\\!\\big(\\frac{\\Delta t}{2}\\mathcal{T}\\big)$。\n\n在某一特定的反应堆状态下，假设算子对易子有以下界（所有范数均为诱导$\\infty$-范数）：\n- $\\big\\|[\\mathcal{T},\\mathcal{D}]\\big\\| \\leq 2.0~\\mathrm{s}^{-2}$，\n- $\\big\\|[\\mathcal{T},[\\mathcal{T},\\mathcal{D}]]\\big\\| \\leq 0.6~\\mathrm{s}^{-3}$，\n- $\\big\\|[\\mathcal{D},[\\mathcal{T},\\mathcal{D}]]\\big\\| \\leq 0.4~\\mathrm{s}^{-3}$。\n\n当前时间步长为 $\\Delta t = 0.02~\\mathrm{s}$。基于局部误差容差应用步长拒绝策略，即如果局部误差的严格领导阶界（状态更新的无量纲相对$\\infty$-范数）超过 $\\tau = 5.0 \\times 10^{-4}$，则该步长被拒绝。局部误差界将通过使用贝克-坎贝尔-豪斯多夫（BCH）级数，将分裂传播算子相对于精确传播算子进行展开，并保留每种分裂方法相应的领导阶非零项，从第一性原理推导得出。\n\n从精确传播算子、分裂传播算子和BCH级数的定义出发，推导 Lie-Trotter 分裂和 Strang 分裂的领导阶局部误差界，用 $\\Delta t$ 和给定的对易子范数界表示。然后，对每种方法，计算在 $\\Delta t$ 和 $2\\,\\Delta t$ 处的局部误差界。计算每种方法中当 $\\Delta t$ 加倍时局部误差界变化的乘法因子，并根据所述策略判断是否应拒绝每种方法的加倍步长。\n\n以一个包含四个条目的单行矩阵 $(r_{\\mathrm{Lie}},\\, r_{\\mathrm{Str}},\\, I_{\\mathrm{Lie}},\\, I_{\\mathrm{Str}})$ 的形式提供最终答案，其中 $r_{\\mathrm{Lie}}$ 和 $r_{\\mathrm{Str}}$ 分别是 Lie-Trotter 分裂和 Strang 分裂中当 $\\Delta t$ 加倍时局部误差界增加的乘法因子，$I_{\\mathrm{Lie}}$ 和 $I_{\\mathrm{Str}}$ 是指示值，如果加倍的步长应被拒绝，则等于 $1$，如果应被接受，则等于 $0$。无需四舍五入。指示值是无量纲的；中间分析应按题目所述将容差视为无量纲。",
            "solution": "该问题要求推导和评估耦合输运-燃耗系统中 Lie-Trotter 和 Strang 算子分裂方法的局部误差界。然后基于这些界来决定是接受还是拒绝一个加倍的时间步长。\n\n首先，我们为误差分析建立理论基础。系统状态根据方程 $\\frac{d\\psi}{dt} = (\\mathcal{T}+\\mathcal{D})\\psi$ 演化，其中 $\\mathcal{T}$ 是输运算子，$\\mathcal{D}$ 是燃耗算子。在时长为 $\\Delta t$ 的时间步长内的精确解由传播算子 $E = \\exp(\\Delta t(\\mathcal{T}+\\mathcal{D}))$ 给出。\n\n算子分裂方法近似这个精确传播算子。\nLie-Trotter 分裂的传播算子是 $S_{\\mathrm{Lie}} = \\exp(\\Delta t\\,\\mathcal{T})\\,\\exp(\\Delta t\\,\\mathcal{D})$。\nStrang 分裂的传播算子是 $S_{\\mathrm{Str}} = \\exp(\\frac{\\Delta t}{2}\\mathcal{T})\\,\\exp(\\Delta t\\,\\mathcal{D})\\,\\exp(\\frac{\\Delta t}{2}\\mathcal{T})$。\n\n这些方法的局部误差是通过将它们与精确传播算子进行比较来确定的。这种比较依赖于贝克-坎贝尔-豪斯多夫（BCH）公式，该公式对于两个非对易算子 $X$ 和 $Y$ 表述为：\n$$ \\exp(X)\\exp(Y) = \\exp\\left(X+Y+\\frac{1}{2}[X,Y]+\\frac{1}{12}\\big([X,[X,Y]]-[Y,[X,Y]]\\big) + \\mathcal{O}(\\|X,Y\\|^3)\\right) $$\n其中 $[A,B] = AB-BA$ 是对易子。\n\n**Lie-Trotter 分裂分析**\n\n令 $X = \\Delta t\\,\\mathcal{T}$ 和 $Y = \\Delta t\\,\\mathcal{D}$。将 BCH 公式应用于 $S_{\\mathrm{Lie}}$ 得到：\n$$ S_{\\mathrm{Lie}} = \\exp\\left(\\Delta t\\,\\mathcal{T} + \\Delta t\\,\\mathcal{D} + \\frac{1}{2}[\\Delta t\\,\\mathcal{T}, \\Delta t\\,\\mathcal{D}] + \\mathcal{O}((\\Delta t)^3)\\right) $$\n$$ S_{\\mathrm{Lie}} = \\exp\\left(\\Delta t(\\mathcal{T}+\\mathcal{D}) + \\frac{(\\Delta t)^2}{2}[\\mathcal{T},\\mathcal{D}] + \\mathcal{O}((\\Delta t)^3)\\right) $$\n局部误差算子 $\\mathcal{E}_{\\mathrm{Lie}} = S_{\\mathrm{Lie}} - E$ 可以通过展开指数项得到。令 $A = \\Delta t(\\mathcal{T}+\\mathcal{D})$ 和 $B = \\frac{(\\Delta t)^2}{2}[\\mathcal{T},\\mathcal{D}] + \\mathcal{O}((\\Delta t)^3)$。那么 $\\mathcal{E}_{\\mathrm{Lie}} = \\exp(A+B) - \\exp(A)$。对于小的 $B$，这个差的领导项是 $B$。因此，Lie-Trotter 分裂的领导阶局部误差算子是：\n$$ \\mathcal{E}_{\\mathrm{Lie}} \\approx \\frac{(\\Delta t)^2}{2}[\\mathcal{T},\\mathcal{D}] $$\n这表明 Lie-Trotter 方法是一阶精度的，其局部误差为 $\\mathcal{O}((\\Delta t)^2)$ 阶。问题要求一个严格的局部误差界，我们记为 $B_{\\mathrm{Lie}}$。我们通过取范数并使用给定的对易子界 $\\big\\|[\\mathcal{T},\\mathcal{D}]\\big\\| \\leq 2.0~\\mathrm{s}^{-2}$ 来获得它：\n$$ B_{\\mathrm{Lie}}(\\Delta t) = \\left\\| \\frac{(\\Delta t)^2}{2}[\\mathcal{T},\\mathcal{D}] \\right\\| \\leq \\frac{(\\Delta t)^2}{2}\\big\\|[\\mathcal{T},\\mathcal{D}]\\big\\| = \\frac{(\\Delta t)^2}{2}(2.0~\\mathrm{s}^{-2}) = (\\Delta t)^2 \\cdot (1.0~\\mathrm{s}^{-2}) $$\n\n**Strang 分裂分析**\n\nStrang 分裂传播算子 $S_{\\mathrm{Str}}$ 是对称的。这种对称性导致其 BCH 展开式 $\\log(S_{\\mathrm{Str}}(\\Delta t))$ 只包含 $\\Delta t$ 的奇数次幂。一阶项与精确传播算子 $\\Delta t(\\mathcal{T}+\\mathcal{D})$ 相同。二阶项消失，这使得该方法具有二阶精度。因此，领导误差项为 $\\mathcal{O}((\\Delta t)^3)$ 阶。\nBCH公式的对称形式给出 $\\log(S_{\\mathrm{Str}})$ 的展开式为：\n$$ \\log(S_{\\mathrm{Str}}) = \\Delta t(\\mathcal{T}+\\mathcal{D}) + \\frac{(\\Delta t)^3}{12}[\\mathcal{T}, [\\mathcal{T}, \\mathcal{D}]] + \\frac{(\\Delta t)^3}{24}[\\mathcal{D}, [\\mathcal{D}, \\mathcal{T}]] + \\mathcal{O}((\\Delta t)^5) $$\n使用恒等式 $[\\mathcal{D}, \\mathcal{T}] = -[\\mathcal{T}, \\mathcal{D}]$，领导阶局部误差算子是：\n$$ \\mathcal{E}_{\\mathrm{Str}} \\approx \\frac{(\\Delta t)^3}{24}\\left(2[\\mathcal{T},[\\mathcal{T},\\mathcal{D}]] - [\\mathcal{D},[\\mathcal{T},\\mathcal{D}]]\\right) $$\n为了求得局部误差界 $B_{\\mathrm{Str}}$，我们取范数并使用三角不等式以及给定的界 $\\big\\|[\\mathcal{T},[\\mathcal{T},\\mathcal{D}]]\\big\\| \\leq 0.6~\\mathrm{s}^{-3}$ 和 $\\big\\|[\\mathcal{D},[\\mathcal{T},\\mathcal{D}]]\\big\\| \\leq 0.4~\\mathrm{s}^{-3}$：\n$$ B_{\\mathrm{Str}}(\\Delta t) = \\left\\| \\mathcal{E}_{\\mathrm{Str}} \\right\\| \\leq \\frac{(\\Delta t)^3}{24}\\left(2\\big\\|[\\mathcal{T},[\\mathcal{T},\\mathcal{D}]]\\big\\| + \\big\\|[\\mathcal{D},[\\mathcal{T},\\mathcal{D}]]\\big\\|\\right) $$\n$$ B_{\\mathrm{Str}}(\\Delta t) \\leq \\frac{(\\Delta t)^3}{24}\\left(2(0.6~\\mathrm{s}^{-3}) + 0.4~\\mathrm{s}^{-3}\\right) = \\frac{(\\Delta t)^3}{24}(1.6~\\mathrm{s}^{-3}) = \\frac{(\\Delta t)^3}{15}~\\mathrm{s}^{-3} $$\n\n**数值评估与决策**\n\n当前时间步长为 $\\Delta t = 0.02~\\mathrm{s}$，容差为 $\\tau = 5.0 \\times 10^{-4}$。\n\n对于 Lie-Trotter 分裂：\n误差界为 $B_{\\mathrm{Lie}}(\\Delta t) = (1.0) \\cdot (\\Delta t)^2$。\n在 $\\Delta t = 0.02~\\mathrm{s}$ 时，误差界为 $B_{\\mathrm{Lie}}(0.02) = (1.0) \\cdot (0.02)^2 = 4.0 \\times 10^{-4}$。\n在 $2\\Delta t = 0.04~\\mathrm{s}$ 时，误差界为 $B_{\\mathrm{Lie}}(0.04) = (1.0) \\cdot (0.04)^2 = 1.6 \\times 10^{-3}$。\n当步长加倍时，误差界增加的乘法因子是 $r_{\\mathrm{Lie}} = \\frac{B_{\\mathrm{Lie}}(2\\Delta t)}{B_{\\mathrm{Lie}}(\\Delta t)} = \\frac{(2\\Delta t)^2}{(\\Delta t)^2} = 4$。\n为了对加倍的步长做出决定，我们将其误差界与容差进行比较：$B_{\\mathrm{Lie}}(0.04) = 1.6 \\times 10^{-3}$。由于 $1.6 \\times 10^{-3} > 5.0 \\times 10^{-4}$，该步长必须被拒绝。指示值为 $I_{\\mathrm{Lie}} = 1$。\n\n对于 Strang 分裂：\n误差界为 $B_{\\mathrm{Str}}(\\Delta t) = \\frac{(\\Delta t)^3}{15}$。\n在 $\\Delta t = 0.02~\\mathrm{s}$ 时，误差界为 $B_{\\mathrm{Str}}(0.02) = \\frac{(0.02)^3}{15} = \\frac{8 \\times 10^{-6}}{15} \\approx 5.33 \\times 10^{-7}$。\n在 $2\\Delta t = 0.04~\\mathrm{s}$ 时，误差界为 $B_{\\mathrm{Str}}(0.04) = \\frac{(0.04)^3}{15} = \\frac{64 \\times 10^{-6}}{15} \\approx 4.27 \\times 10^{-6}$。\n乘法因子是 $r_{\\mathrm{Str}} = \\frac{B_{\\mathrm{Str}}(2\\Delta t)}{B_{\\mathrm{Str}}(\\Delta t)} = \\frac{(2\\Delta t)^3}{(\\Delta t)^3} = 8$。\n为了对加倍的步长做出决定，我们将其误差界与容差进行比较：$B_{\\mathrm{Str}}(0.04) \\approx 4.27 \\times 10^{-6}$。由于 $4.27 \\times 10^{-6} \\ll \\tau = 5.0 \\times 10^{-4}$，该步长被接受。指示值为 $I_{\\mathrm{Str}} = 0$。\n\n最终结果是乘法因子 $r_{\\mathrm{Lie}}=4$ 和 $r_{\\mathrm{Str}}=8$，以及拒绝指示值 $I_{\\mathrm{Lie}}=1$ 和 $I_{\\mathrm{Str}}=0$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 4  8  1  0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "理论只有在实践中得到检验才能被最好地理解。最后一个练习将解析误差公式与计算现实联系起来。你将为一个燃耗模型问题进行数值实现，计算不同分裂格式的结果，并利用它们之间的差异作为局部误差的实用估计。这个练习不仅验证了理论预测，还展示了基于换向器的误差代理如何在实际模拟程序中用于监控计算精度。",
            "id": "4240057",
            "problem": "考虑核反应堆模拟中核素数密度的线性化输运-燃耗耦合问题。设状态向量为核素数密度向量 $y(t) \\in \\mathbb{R}^3$，其分量 $y_1(t)$ 代表铀-235 (Uranium-235)，$y_2(t)$ 代表铀-238 (Uranium-238)，$y_3(t)$ 代表氙-135 (Xenon-135)，单位均为 $1/\\mathrm{cm}^3$。该耦合系统被建模为常微分方程 (ODE) $y'(t) = (A + B) y(t)$，其中 $A$ 代表非输运燃耗（例如放射性衰变），$B$ 代表在稳态中子通量周围线性化的有效输运介导的中子诱发反应。在一个时间步长 $\\Delta t$ 上的精确解为 $y(\\Delta t) = \\exp(\\Delta t (A+B)) y(0)$，其中 $\\exp(\\cdot)$ 表示矩阵指数。\n\n对于稳态通量下物理上合理的常系数近似，使用以下矩阵（$A$ 和 $B$ 的单位为 $\\mathrm{s}^{-1}$）：\n$$\nA = \\begin{bmatrix}\n0  0  0\\\\\n0  0  0\\\\\n0  0  -\\lambda_{\\mathrm{Xe}}\n\\end{bmatrix},\\quad\n\\lambda_{\\mathrm{Xe}} = 2.10\\times 10^{-5},\n$$\n$$\nB = \\begin{bmatrix}\n-k_{1}  0  0\\\\\n0  -k_{2}  0\\\\\nf  0  -k_{3}\n\\end{bmatrix},\\quad\nk_1 = 5.85\\times 10^{-8},\\quad k_2 = 2.70\\times 10^{-10},\\quad k_3 = 3.00\\times 10^{-4},\\quad f = 1.755\\times 10^{-9}.\n$$\n这些值对应于从稳态通量和截面数据中获得的合理量级：$k_1$ 近似为每个铀-235核的裂变率，$k_2$ 近似为每个铀-238核的俘获率，$k_3$ 近似为每个氙-135核的中子吸收率，而 $f$ 近似为来自铀-235裂变产额的氙-135产生耦合。\n\n定义在大小为 $\\Delta t$ 的单个时间步长上的两种一阶算子分裂次序：\n1. 先输运后燃耗：$y_{\\mathrm{AB}}(\\Delta t) = \\exp(\\Delta t A)\\exp(\\Delta t B) y(0)$。\n2. 先燃耗后输运：$y_{\\mathrm{BA}}(\\Delta t) = \\exp(\\Delta t B)\\exp(\\Delta t A) y(0)$。\n\n令矩阵对易子定义为 $[A,B] = AB - BA$。目标是通过计算来自两种分裂次序的对易子在 $y(0)$ 上的作用的代理，来估计分裂次序的局部误差，然后将此预测与观测到的同精确解的差异进行比较以验证。具体而言：\n- 针对给定的 $A$、$B$ 和 $y(0)$，计算 $y_{\\mathrm{AB}}(\\Delta t)$ 和 $y_{\\mathrm{BA}}(\\Delta t)$。\n- 使用这两种分裂次序，通过基于 $\\Delta t$ 中领头阶行为的量纲分析进行适当归一化，为 $[A,B]y(0)$ 构建一个代理向量。\n- 使用该代理来预测先输运后燃耗次序相对于精确解的领头阶局部误差，并通过计算相对差异，将其与观测误差 $y_{\\mathrm{AB}}(\\Delta t) - \\exp(\\Delta t (A+B)) y(0)$ 进行比较。相对差异定义为预测误差的欧几里得范数与观测误差的欧几里得范数之比。此处的欧几里得范数是针对密度分量的，因此单位为 $1/\\mathrm{cm}^3$，而相对差异是无量纲的。\n\n初始数密度为\n$$\ny(0) = \\begin{bmatrix}\n2.50\\times 10^{21}\\\\\n4.00\\times 10^{22}\\\\\n1.00\\times 10^{15}\n\\end{bmatrix}\\ \\mathrm{cm}^{-3}.\n$$\n\n测试组（时间步长以秒为单位）：\n- 情况 1：$\\Delta t = 0.01$。\n- 情况 2：$\\Delta t = 10.0$。\n- 情况 3：$\\Delta t = 864000.0$（十天）。\n\n对于每种情况，计算相对差异（无量纲），并使用标准“相对差异 $\\leq 0.2$”来判断基于对易子的预测是否可接受，结果为布尔值。您的程序应生成单行输出，其中包含一个用方括号括起来的、按情况顺序排列的逗号分隔列表，列表中的每个元素是该情况的布尔值结果（例如，“$[{\\tt True},{\\tt False},{\\tt True}]$”）。本问题不涉及角度。所有涉及数密度的物理量必须保持单位为 $1/\\mathrm{cm}^3$，时间单位为 $\\mathrm{s}$，速率单位为 $\\mathrm{s}^{-1}$。百分比（若有）必须表示为小数。",
            "solution": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the transport-depletion coupling problem by analyzing the error\n    of an operator splitting method.\n    \"\"\"\n    \n    # Define the physical constants and parameters.\n    # All rates are in s^-1.\n    lambda_Xe = 2.10e-5\n    k1 = 5.85e-8\n    k2 = 2.70e-10\n    k3 = 3.00e-4\n    f = 1.755e-9\n\n    # Define the depletion matrix A and the transport/reaction matrix B.\n    # A represents radioactive decay.\n    # B represents neutron-induced reactions.\n    A = np.array([\n        [0.0, 0.0, 0.0],\n        [0.0, 0.0, 0.0],\n        [0.0, 0.0, -lambda_Xe]\n    ], dtype=float)\n\n    B = np.array([\n        [-k1, 0.0, 0.0],\n        [0.0, -k2, 0.0],\n        [f,   0.0, -k3]\n    ], dtype=float)\n\n    # The full system matrix is C = A + B.\n    C = A + B\n\n    # Define the initial number density vector y(0) in cm^-3.\n    # y[0]: U-235, y[1]: U-238, y[2]: Xe-135.\n    y0 = np.array([2.50e21, 4.00e22, 1.00e15], dtype=float)\n\n    # Define the test cases for the time step size dt in seconds.\n    test_cases = [0.01, 10.0, 864000.0]\n\n    results = []\n    for dt in test_cases:\n        # Calculate the matrix exponentials for the propagators.\n        exp_dtA = expm(dt * A)\n        exp_dtB = expm(dt * B)\n        # The exact solution propagator\n        exp_dtC = expm(dt * C)\n\n        # Propagate the initial state vector using the different methods.\n        # Transport-then-depletion (AB) ordering\n        y_ab = exp_dtA @ exp_dtB @ y0\n        \n        # Depletion-then-transport (BA) ordering\n        y_ba = exp_dtB @ exp_dtA @ y0\n        \n        # Exact solution\n        y_exact = exp_dtC @ y0\n\n        # The predicted local error vector, v_p, is based on the difference\n        # between the two first-order split orderings.\n        # This approximates (dt^2/2) * [A,B] * y(0).\n        v_p = 0.5 * (y_ab - y_ba)\n\n        # The observed local error vector, v_o, is the true difference\n        # between the AB-split solution and the exact solution.\n        v_o = y_ab - y_exact\n        \n        # The 'prediction error' is the difference between the predicted error\n        # vector and the observed error vector.\n        E_pred_vec = v_p - v_o\n        \n        # Calculate the Euclidean norms of the prediction error and observed error.\n        norm_E_pred = np.linalg.norm(E_pred_vec)\n        norm_v_o = np.linalg.norm(v_o)\n\n        # Calculate the relative discrepancy.\n        # This measures how good the leading-order error prediction is.\n        # Handle division by zero, although not expected here.\n        if norm_v_o == 0.0:\n            relative_discrepancy = 0.0 if norm_E_pred == 0.0 else float('inf')\n        else:\n            relative_discrepancy = norm_E_pred / norm_v_o\n        \n        # Apply the acceptance criterion.\n        is_acceptable = relative_discrepancy = 0.2\n        results.append(is_acceptable)\n\n    # Format the output as a comma-separated list of boolean values.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\n# To generate the answer, one would run the solve() function.\n# solve()\n```",
            "answer": "[True,True,False]"
        }
    ]
}