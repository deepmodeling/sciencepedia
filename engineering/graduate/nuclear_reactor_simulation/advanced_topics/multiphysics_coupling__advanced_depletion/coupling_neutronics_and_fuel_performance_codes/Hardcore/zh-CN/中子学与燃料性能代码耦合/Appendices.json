{
    "hands_on_practices": [
        {
            "introduction": "这项实践聚焦于空间均匀化，这是耦合不同空间尺度代码的一项关键技术。通过从第一性原理推导体积加权的宏观截面，你将理解将非均匀的燃料棒简化为用于大规模计算的均匀材料背后的基本假设，并学会批判性地评估这种常用方法的局限性。",
            "id": "4219939",
            "problem": "一个来自压水反应堆栅格的单根燃料棒栅元，将从中子学求解器传递到燃料性能程序（FPC），再返回，以进行材料状态和截面的耦合更新。考虑一个单群、稳态、无泄漏、轴对称的燃料棒栅元，它由四个同心区域组成：燃料、间隙、包壳和慢化剂，在轴向无限延伸。FPC提供了更新的热力学状态，中子学数据库已经将其映射为区域平均的宏观吸收截面。你需要为该燃料棒栅元定义空间均匀化，从第一性原理出发推导体积加权的均匀化宏观吸收截面，然后用所提供的数据计算其值。\n\n使用以下单位高度的几何规格：燃料半径$r_{f} = 0.41\\,\\mathrm{cm}$，包壳内半径$r_{ci} = 0.415\\,\\mathrm{cm}$，包壳外半径$r_{co} = 0.475\\,\\mathrm{cm}$，燃料棒栅元边界半径$R = 0.63\\,\\mathrm{cm}$。假设每个区域都是具有所述半径的直立圆环（燃料为实心圆盘）。\n\n中子学数据库在接收了FPC预测的此时间步的温度和密度后，提供了以下区域平均的单群宏观吸收截面：燃料$\\Sigma_{a}^{(f)} = 0.13\\,\\mathrm{cm}^{-1}$，间隙$\\Sigma_{a}^{(g)} = 1.0 \\times 10^{-4}\\,\\mathrm{cm}^{-1}$，包壳$\\Sigma_{a}^{(c)} = 0.007\\,\\mathrm{cm}^{-1}$，慢化剂$\\Sigma_{a}^{(m)} = 0.020\\,\\mathrm{cm}^{-1}$。\n\n任务：\n1) 根据在整个栅元内保持一个积分量不变的原则，为此非均匀燃料棒栅元定义空间均匀化。\n2) 仅从宏观吸收截面的定义和吸收反应率作为体积积分的定义出发，并假设标量通量在非均匀区域内是均匀的，推导整个燃料棒栅元的均匀化宏观吸收截面表达式。\n3) 使用你推导的表达式，利用给定数据计算燃料棒栅元的均匀化宏观吸收截面。最终结果以$\\mathrm{cm}^{-1}$为单位，并四舍五入到四位有效数字。\n4) 简要说明当你推导的体积加权均匀化方法在耦合中子学-燃料性能模拟中存在强烈的栅元内通量和温度梯度时，其主要局限性。\n\n最终答案只需报告第3部分的数值。所有其他部分应在你的解题思路中进行阐述。",
            "solution": "该问题被认为是有效的，因为它科学地基于核反应堆物理原理，问题陈述清晰，并包含唯一解所需的所有信息。它构成了一个标准的、尽管简化了的反应堆分析问题。\n\n解答的结构旨在回应问题陈述中提出的四个任务。\n\n任务1) 定义空间均匀化。\n在反应堆物理学中，空间均匀化是将非均匀材料排列（例如燃料棒栅元中的燃料、间隙、包壳和慢化剂）替换为等效均匀介质的过程。“等效性”是核心概念，其定义为保持栅元体积上某个特定积分量不变。对于中子输运和扩散问题，这个量是特定类型（如吸收、裂变、散射）的总反应率。因此，为虚拟均匀材料定义的均匀化截面，应使得使用这些截面和均匀化介质中的通量计算出的总反应率，与实际非均匀介质中的总反应率完全相同。\n\n任务2) 推导体积加权的均匀化宏观吸收截面。\n推导从反应率的基本定义开始。在位置$\\vec{r}$处的吸收反应率密度由宏观吸收截面$\\Sigma_a(\\vec{r})$和标量中子通量$\\phi(\\vec{r})$的乘积给出。在体积$V$内的总吸收率$A$是该密度在整个体积上的积分：\n$$ A = \\int_V \\Sigma_a(\\vec{r}) \\phi(\\vec{r}) dV $$\n对于非均匀燃料棒栅元，总体积$V_{cell}$是其组成区域体积的总和：燃料 ($f$)、间隙 ($g$)、包壳 ($c$) 和慢化剂 ($m$)。非均匀栅元中的总吸收率$A_{het}$是每个区域吸收率的总和。假设在每个区域$i$（体积为$V_i$，截面为$\\Sigma_a^{(i)}$）内宏观截面是恒定的，则总反应率为：\n$$ A_{het} = \\sum_{i \\in \\{f,g,c,m\\}} \\int_{V_i} \\Sigma_a^{(i)} \\phi(\\vec{r}) dV = \\sum_{i} \\Sigma_a^{(i)} \\int_{V_i} \\phi(\\vec{r}) dV $$\n对于等效的均匀栅元，其特征是单一的均匀化吸收截面$\\bar{\\Sigma}_a$，在相同体积$V_{cell}$上的总吸收率$A_{hom}$为：\n$$ A_{hom} = \\int_{V_{cell}} \\bar{\\Sigma}_a \\phi_{hom}(\\vec{r}) dV = \\bar{\\Sigma}_a \\int_{V_{cell}} \\phi_{hom}(\\vec{r}) dV $$\n其中$\\phi_{hom}(\\vec{r})$是均匀介质中的通量。\n\n均匀化原理要求$A_{het} = A_{hom}$：\n$$ \\bar{\\Sigma}_a \\int_{V_{cell}} \\phi_{hom}(\\vec{r}) dV = \\sum_{i} \\Sigma_a^{(i)} \\int_{V_i} \\phi(\\vec{r}) dV $$\n问题明确指出要假设在整个非均匀区域内标量通量是均匀的，即$\\phi_0$。这意味着在非均匀栅元中对所有$\\vec{r}$都有$\\phi(\\vec{r}) = \\phi_0$，因此在等效均匀栅元中也有$\\phi_{hom}(\\vec{r}) = \\phi_0$。将此假设代入方程得到：\n$$ \\bar{\\Sigma}_a \\int_{V_{cell}} \\phi_0 dV = \\sum_{i} \\Sigma_a^{(i)} \\int_{V_i} \\phi_0 dV $$\n由于$\\phi_0$是一个非零常数，它可以从积分中提出并在等式两边消去：\n$$ \\bar{\\Sigma}_a \\int_{V_{cell}} dV = \\sum_{i} \\Sigma_a^{(i)} \\int_{V_i} dV $$\n积分仅代表相应区域的体积：\n$$ \\bar{\\Sigma}_a V_{cell} = \\sum_{i} \\Sigma_a^{(i)} V_i $$\n求解均匀化吸收截面$\\bar{\\Sigma}_a$，我们得到体积加权平均值：\n$$ \\bar{\\Sigma}_a = \\frac{\\sum_{i} \\Sigma_a^{(i)} V_i}{V_{cell}} = \\frac{\\sum_{i} \\Sigma_a^{(i)} V_i}{\\sum_{i} V_i} $$\n这是在空间均匀中子通量假设下推导出的体积加权均匀化宏观吸收截面表达式。\n\n任务3) 计算均匀化宏观吸收截面。\n燃料棒栅元被假设为无限长，因此我们可以使用单位高度的面积进行计算，这些面积与体积成正比。设$A_i$为区域$i$的横截面积。\n各区域面积为：\n- 燃料：$A_f = \\pi r_f^2$\n- 间隙：$A_g = \\pi (r_{ci}^2 - r_f^2)$\n- 包壳：$A_c = \\pi (r_{co}^2 - r_{ci}^2)$\n- 慢化剂：$A_m = \\pi (R^2 - r_{co}^2)$\n- 总栅元：$A_{cell} = \\pi R^2$\n\n$\\bar{\\Sigma}_a$的公式可以写成面积的形式：\n$$ \\bar{\\Sigma}_a = \\frac{\\Sigma_a^{(f)} A_f + \\Sigma_a^{(g)} A_g + \\Sigma_a^{(c)} A_c + \\Sigma_a^{(m)} A_m}{A_{cell}} $$\n因子$\\pi$在分子和分母中可以消去：\n$$ \\bar{\\Sigma}_a = \\frac{\\Sigma_a^{(f)} r_f^2 + \\Sigma_a^{(g)} (r_{ci}^2 - r_f^2) + \\Sigma_a^{(c)} (r_{co}^2 - r_{ci}^2) + \\Sigma_a^{(m)} (R^2 - r_{co}^2)}{R^2} $$\n给定半径为：$r_f = 0.41\\,\\mathrm{cm}$，$r_{ci} = 0.415\\,\\mathrm{cm}$，$r_{co} = 0.475\\,\\mathrm{cm}$和$R = 0.63\\,\\mathrm{cm}$。它们的平方是：\n- $r_f^2 = (0.41)^2 = 0.1681\\,\\mathrm{cm}^2$\n- $r_{ci}^2 = (0.415)^2 = 0.172225\\,\\mathrm{cm}^2$\n- $r_{co}^2 = (0.475)^2 = 0.225625\\,\\mathrm{cm}^2$\n- $R^2 = (0.63)^2 = 0.3969\\,\\mathrm{cm}^2$\n\n面积项（除以$\\pi$）为：\n- $A_f/\\pi = 0.1681\\,\\mathrm{cm}^2$\n- $A_g/\\pi = 0.172225 - 0.1681 = 0.004125\\,\\mathrm{cm}^2$\n- $A_c/\\pi = 0.225625 - 0.172225 = 0.0534\\,\\mathrm{cm}^2$\n- $A_m/\\pi = 0.3969 - 0.225625 = 0.171275\\,\\mathrm{cm}^2$\n\n给定的宏观吸收截面为：$\\Sigma_{a}^{(f)} = 0.13\\,\\mathrm{cm}^{-1}$，$\\Sigma_{a}^{(g)} = 1.0 \\times 10^{-4}\\,\\mathrm{cm}^{-1}$，$\\Sigma_{a}^{(c)} = 0.007\\,\\mathrm{cm}^{-1}$和$\\Sigma_{a}^{(m)} = 0.020\\,\\mathrm{cm}^{-1}$。\n\n现在，我们计算$\\bar{\\Sigma}_a$表达式的分子：\n分子 $= (\\Sigma_a^{(f)} r_f^2 + \\dots) = (0.13)(0.1681) + (1.0 \\times 10^{-4})(0.004125) + (0.007)(0.0534) + (0.020)(0.171275)$\n分子 $= 0.021853 + 0.0000004125 + 0.0003738 + 0.0034255 = 0.0256527125\\,\\mathrm{cm}^{-1} \\cdot \\mathrm{cm}^2$\n\n除以分母$R^2 = 0.3969\\,\\mathrm{cm}^2$：\n$$ \\bar{\\Sigma}_a = \\frac{0.0256527125}{0.3969} \\approx 0.064632685\\,\\mathrm{cm}^{-1} $$\n将结果四舍五入到四位有效数字，我们得到：\n$$ \\bar{\\Sigma}_a \\approx 0.06463\\,\\mathrm{cm}^{-1} $$\n\n任务4) 说明体积加权均匀化的主要局限性。\n体积加权均匀化的推导严重依赖于空间均匀中子通量的假设。这个假设在反应堆燃料棒栅元中是不符合物理实际的，并构成了该方法的主要局限性。\n1.  **通量自屏效应**：燃料的吸收截面（$\\Sigma_a^{(f)} = 0.13\\,\\mathrm{cm}^{-1}$）显著高于周围慢化剂的吸收截面（$\\Sigma_a^{(m)} = 0.020\\,\\mathrm{cm}^{-1}$）。这种巨大的差异导致燃料区域内的中子通量产生强烈凹陷，这种效应被称为自屏效应。实际通量在慢化剂中最高，在燃料中心最低。体积加权法通过假设通量是平坦的，不成比例地加重了高截面燃料区的贡献，导致对真实有效吸收率的高估，从而得到一个不正确的高的均匀化截面值。\n2.  **忽略温度梯度**：在耦合中子学-燃料性能模拟的背景下，燃料表现出非常大的径向温度梯度，在中心线处达到峰值。宏观截面，特别是通过共振效应（多普勒展宽），是高度依赖于温度的。“中子学数据库”提供的整个燃料区的单一区域平均截面，是一种粗略的简化，忽略了由FPC计算出的详细温度分布。这个平均过程本身在进行均匀化步骤之前就已经引入了重大误差。\n\n物理上正确的均匀化必须使用实际的空间变化通量分布$\\phi(\\vec{r})$来保持反应率不变。这引出了通量加权法，其中均匀化截面为$\\bar{\\Sigma}_a = (\\sum_i \\Sigma_a^{(i)} \\bar{\\phi}_i V_i) / (\\sum_j \\bar{\\phi}_j V_j)$，其中$\\bar{\\phi}_i$是区域$i$的平均通量。平通量假设只是一阶近似，对于精确的反应堆分析通常是不够的。",
            "answer": "$$\\boxed{0.06463}$$"
        },
        {
            "introduction": "在平均化概念的基础上，本练习将展示数据映射保真度对模拟准确性的实际影响。你将实现一个热工模型，以量化使用组件平均功率而非棒内精细功率时，在预测燃料峰值温度方面的误差，从而揭示不同耦合策略对安全分析的意义。",
            "id": "4219856",
            "problem": "您的任务是为圆柱形燃料棒构建一个简化但科学上严谨的中子学与燃料性能耦合模型，并比较两种映射策略：棒内功率精细映射与组件均匀化耦合。从第一性原理出发，推导并实现预测稳态条件下峰值中心线温度所需的温度模型，然后量化当使用组件均匀化耦合而非棒内功率精细映射时，峰值温度预测产生的误差。\n\n使用以下基本原理：\n\n- 傅里叶热传导定律：$q_r = -k \\, \\frac{dT}{dr}$。\n- 在半径为$R$的圆柱体中，均匀体积热生成下的稳态能量守恒：$$\\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{dT}{dr}\\right) + \\frac{q''' }{k} = 0.$$\n- 与线热功率相关的均匀体积热生成：$$q''' = \\frac{q'}{\\pi R^2}, \\quad \\text{with} \\quad q' = \\frac{P}{L},$$ 其中$P$是燃料棒功率，$L$是燃料的活性区长度。\n\n在稳态条件下，并假设燃料（$r_f$）、气隙（$r_g$）和包壳（$r_{c,\\text{in}}$至$r_{c,\\text{out}}$）为同心圆柱体，且与温度为$T_{\\infty}$、传热系数为$h$的冷却剂进行外部对流，中心线温度$T(0)$可以通过热阻网络表示：\n- 由体积生热引起的燃料内部温升：$$\\Delta T_{\\text{fuel}} = \\frac{q'}{4 \\pi k_f}.$$\n- 气隙导热线性热阻：$$R_{\\text{gap}} = \\frac{\\ln\\left(\\frac{r_g}{r_f}\\right)}{2 \\pi k_g}.$$\n- 包壳导热线性热阻：$$R_{\\text{clad}} = \\frac{\\ln\\left(\\frac{r_{c,\\text{out}}}{r_{c,\\text{in}}}\\right)}{2 \\pi k_c}.$$\n- 外部对流线性热阻：$$R_{\\text{conv}} = \\frac{1}{2 \\pi r_{c,\\text{out}} h}.$$\n\n对于线热功率为$q'$的给定燃料棒，其中心线温度为：\n$$T(0) = T_{\\infty} + q' \\left( R_{\\text{conv}} + R_{\\text{clad}} + R_{\\text{gap}} \\right) + \\frac{q'}{4 \\pi k_f}.$$\n\n定义两种耦合策略：\n1. 棒内功率精细映射：使用每根燃料棒的实际功率$P_i$计算其线热功率$q'_i = \\frac{P_i}{L}$和中心线温度$T_i(0)$，然后确定峰值温度$T_{\\text{peak,true}} = \\max_i T_i(0)$。\n2. 组件均匀化耦合：计算$N$根燃料棒的组件平均功率$\\bar{P} = \\frac{1}{N}\\sum_{i=1}^{N} P_i$，将$\\bar{P}$分配给每根燃料棒，计算相应的均匀中心线温度$T_{\\text{avg}}(0)$，并取$T_{\\text{peak,homo}} = T_{\\text{avg}}(0)$。\n\n对于下面的每个测试用例，将峰值温度预测的绝对误差量化为：\n$$E = \\left| T_{\\text{peak,homo}} - T_{\\text{peak,true}} \\right|.$$\n\n所有计算都必须使用指定的物理常数和单位进行。最终误差值以开尔文（$\\text{K}$）表示，并四舍五入到三位小数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如$[E_1,E_2,E_3,E_4]$）。\n\n所有情况均使用以下通用几何和材料属性：\n- 燃料半径：$r_f = 4.10 \\times 10^{-3} \\ \\text{m}$。\n- 气隙外半径：$r_g = 4.185 \\times 10^{-3} \\ \\text{m}$。\n- 包壳内半径：$r_{c,\\text{in}} = 4.185 \\times 10^{-3} \\ \\text{m}$。\n- 包壳外半径：$r_{c,\\text{out}} = 4.785 \\times 10^{-3} \\ \\text{m}$。\n- 燃料热导率：$k_f = 3.0 \\ \\text{W} \\, \\text{m}^{-1} \\, \\text{K}^{-1}$。\n- 气隙（氦）热导率：$k_g = 0.3 \\ \\text{W} \\, \\text{m}^{-1} \\, \\text{K}^{-1}$。\n- 包壳（锆合金）热导率：$k_c = 16.0 \\ \\text{W} \\, \\text{m}^{-1} \\, \\text{K}^{-1}$。\n- 燃料活性区长度：$L = 3.7 \\ \\text{m}$。\n- 冷却剂温度：$T_{\\infty} = 580.0 \\ \\text{K}$。\n\n测试套件：\n- 用例$1$（正常路径）：$3 \\times 3$ 燃料棒功率，单位为瓦特，\n$$\\begin{bmatrix}\n12000  10000  9000 \\\\\n8000  15000  8000 \\\\\n7000  10000  9000\n\\end{bmatrix}, \\quad h = 1.20 \\times 10^{4} \\ \\text{W} \\, \\text{m}^{-2} \\, \\text{K}^{-1}.$$\n- 用例$2$（均匀边界情况）：$3 \\times 3$ 燃料棒功率，单位为瓦特，\n$$\\begin{bmatrix}\n10000  10000  10000 \\\\\n10000  10000  10000 \\\\\n10000  10000  10000\n\\end{bmatrix}, \\quad h = 1.20 \\times 10^{4} \\ \\text{W} \\, \\text{m}^{-2} \\, \\text{K}^{-1}.$$\n- 用例$3$（极端峰值边缘情况）：$3 \\times 3$ 燃料棒功率，单位为瓦特，\n$$\\begin{bmatrix}\n5000  5000  5000 \\\\\n5000  25000  5000 \\\\\n5000  5000  5000\n\\end{bmatrix}, \\quad h = 1.20 \\times 10^{4} \\ \\text{W} \\, \\text{m}^{-2} \\, \\text{K}^{-1}.$$\n- 用例$4$（低冷却边缘情况）：燃料棒功率与用例1相同，但\n$$h = 5.00 \\times 10^{3} \\ \\text{W} \\, \\text{m}^{-2} \\, \\text{K}^{-1}.$$\n\n要求最终输出格式：\n- 您的程序必须计算测试套件中每个用例的$E$，并打印一行包含$[E_1,E_2,E_3,E_4]$格式列表的内容，其中每个$E_i$都四舍五入到三位小数，并以开尔文（$\\text{K}$）表示。",
            "solution": "中子学和燃料性能程序耦合问题是高保真核反应堆模拟的核心。本任务要求通过量化一种计算成本较低但精度较差的均匀化方法所引入的误差，来对两种常见的耦合策略进行严格评估。该分析基于热传导的第一性原理。\n\n物理模型是一个处于稳态条件下的圆柱形燃料棒。燃料芯块内部（从半径$r=0$到$r=r_f$）的温度分布$T(r)$的控制方程是带有均匀体积热源$q'''$的热传导方程：\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(r k_f \\frac{dT}{dr}\\right) + q''' = 0\n$$\n假设燃料热导率$k_f$为常数，该方程可写为：\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{dT}{dr}\\right) + \\frac{q'''}{k_f} = 0\n$$\n体积热生成$q'''$与燃料棒的线热功率$q'$（单位长度功率, $P/L$）通过$q''' = \\frac{q'}{\\pi r_f^2}$相关联。在中心线对称（$\\frac{dT}{dr}|_{r=0} = 0$）和燃料表面温度已知$T(r_f)$的边界条件下，对热方程进行两次积分，可得到燃料芯块上的温降：\n$$\n\\Delta T_{\\text{fuel}} = T(0) - T(r_f) = \\frac{q''' r_f^2}{4k_f} = \\frac{(q'/\\pi r_f^2) r_f^2}{4k_f} = \\frac{q'}{4 \\pi k_f}\n$$\n该项表示产热介质内部的温升。\n\n系统的其余部分由被动层组成，热量通过这些层传导和对流散失。这些层通过一个热阻网络进行建模。单位长度的总热率$q'$在气隙、包壳和对流边界层中保持恒定。跨越这些层的温降为：\n1.  **气隙**：建模为从$r_f$到$r_g$的圆柱壳体内的热传导。温降为$\\Delta T_{\\text{gap}} = q' R_{\\text{gap}}$，其中线性热阻为$R_{\\text{gap}} = \\frac{\\ln(r_g/r_f)}{2 \\pi k_g}$。\n2.  **包壳**：建模为从$r_{c,\\text{in}}$到$r_{c,\\text{out}}$的圆柱壳体内的热传导。温降为$\\Delta T_{\\text{clad}} = q' R_{\\text{clad}}$，热阻为$R_{\\text{clad}} = \\frac{\\ln(r_{c,\\text{out}}/r_{c,\\text{in}})}{2 \\pi k_c}$。\n3.  **冷却剂对流**：通过牛顿冷却定律在包壳外表面建模。温降为$\\Delta T_{\\text{conv}} = q' R_{\\text{conv}}$，热阻为$R_{\\text{conv}} = \\frac{1}{2 \\pi r_{c,\\text{out}} h}$。\n\n中心线温度$T(0)$是主冷却剂温度$T_{\\infty}$与所有连续温降之和：\n$$\nT(0) = T_{\\infty} + \\Delta T_{\\text{conv}} + \\Delta T_{\\text{clad}} + \\Delta T_{\\text{gap}} + \\Delta T_{\\text{fuel}}\n$$\n将每一项的表达式代入，得到所给公式：\n$$\nT(0) = T_{\\infty} + q' \\left( R_{\\text{conv}} + R_{\\text{clad}} + R_{\\text{gap}} \\right) + \\frac{q'}{4 \\pi k_f}\n$$\n该方程可以简化为$T(0)$和$q'$之间的线性关系：\n$$\nT(0) = T_{\\infty} + q' \\left( \\frac{1}{2 \\pi r_{c,\\text{out}} h} + \\frac{\\ln(r_{c,\\text{out}}/r_{c,\\text{in}})}{2 \\pi k_c} + \\frac{\\ln(r_g/r_f)}{2 \\pi k_g} + \\frac{1}{4 \\pi k_f} \\right)\n$$\n设括号中的项为总热系数$A(h)$。那么，$T(0) = T_{\\infty} + A(h) \\cdot q'$。由于温度是线热功率$q'$的线性函数，峰值温度将总是对应于具有最大线热功率$q'_{\\text{max}}$的燃料棒。\n\n两种耦合策略的评估如下：\n1.  **棒内功率精细映射**：在该模型的假设范围内，这是一种物理上正确的方法。每根燃料棒$i$的功率$P_i$被用来计算其特定的线热功率$q'_i = P_i/L$。计算所有燃料棒的温度$T_i(0)$，真正的峰值温度是它们中的最大值：$T_{\\text{peak,true}} = \\max_i(T_i(0))$。这对应于具有最大功率$P_{\\text{max}}$，从而具有最大线热功率$q'_{\\text{max}}$的燃料棒。\n    $$ T_{\\text{peak,true}} = T_{\\infty} + A(h) \\cdot q'_{\\text{max}} = T_{\\infty} + A(h) \\cdot \\frac{P_{\\text{max}}}{L} $$\n2.  **组件均匀化耦合**：这是一种忽略了详细棒功率分布的近似方法。计算组件平均功率$\\bar{P} = \\frac{1}{N}\\sum_{i=1}^{N} P_i$，并将其分配给每根燃料棒。这导致了单一、均匀的线热功率$\\bar{q}' = \\bar{P}/L$和单一的温度值$T_{\\text{avg}}(0)$，该值被作为峰值温度：$T_{\\text{peak,homo}} = T_{\\text{avg}}(0)$。\n    $$ T_{\\text{peak,homo}} = T_{\\infty} + A(h) \\cdot \\bar{q}' = T_{\\infty} + A(h) \\cdot \\frac{\\bar{P}}{L} $$\n\n误差$E = \\left| T_{\\text{peak,homo}} - T_{\\text{peak,true}} \\right|$量化了这种差异。代入上述表达式：\n$$\nE = \\left| \\left(T_{\\infty} + A(h) \\cdot \\frac{\\bar{P}}{L}\\right) - \\left(T_{\\infty} + A(h) \\cdot \\frac{P_{\\text{max}}}{L}\\right) \\right| = \\frac{A(h)}{L} | \\bar{P} - P_{\\text{max}} |\n$$\n由于$\\bar{P} \\le P_{\\text{max}}$，误差简化为$E = \\frac{A(h)}{L} (P_{\\text{max}} - \\bar{P})$。这表明当功率存在变化时，均匀化方案总是低估峰值温度，这对于安全分析来说是一个非保守的结果。该误差的大小与峰值和平均燃料棒功率之间的差异成正比。\n\n计算过程是首先为每个测试用例计算系数$A(h)$的分量。然后，对于每个用例的功率分布，确定$P_{\\text{max}}$和$\\bar{P}$，最后使用推导出的公式计算误差$E$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the error in peak fuel centerline temperature prediction\n    when using assembly-homogenized coupling versus pin-resolved mapping.\n    \"\"\"\n\n    # Common physical constants and geometry\n    r_f = 4.10e-3  # Fuel radius, m\n    r_g = 4.185e-3 # Gap outer radius, m\n    r_c_in = 4.185e-3 # Cladding inner radius, m\n    r_c_out = 4.785e-3 # Cladding outer radius, m\n    k_f = 3.0     # Fuel thermal conductivity, W/m-K\n    k_g = 0.3     # Gap thermal conductivity, W/m-K\n    k_c = 16.0    # Cladding thermal conductivity, W/m-K\n    L = 3.7       # Active fuel length, m\n    T_inf = 580.0   # Coolant temperature, K\n\n    # Test cases: (pin_powers in W, h in W/m^2-K)\n    test_cases = [\n        (np.array([\n            [12000, 10000, 9000],\n            [8000, 15000, 8000],\n            [7000, 10000, 9000]\n        ]), 1.20e4),\n        (np.array([\n            [10000, 10000, 10000],\n            [10000, 10000, 10000],\n            [10000, 10000, 10000]\n        ]), 1.20e4),\n        (np.array([\n            [5000, 5000, 5000],\n            [5000, 25000, 5000],\n            [5000, 5000, 5000]\n        ]), 1.20e4),\n        (np.array([\n            [12000, 10000, 9000],\n            [8000, 15000, 8000],\n            [7000, 10000, 9000]\n        ]), 5.00e3)\n    ]\n\n    results = []\n\n    # Pre-calculate constant thermal resistance terms\n    R_gap = np.log(r_g / r_f) / (2 * np.pi * k_g)\n    R_clad = np.log(r_c_out / r_c_in) / (2 * np.pi * k_c)\n    fuel_term = 1 / (4 * np.pi * k_f)\n    \n    def calculate_centerline_temp(q_prime, h):\n        \"\"\"\n        Calculates centerline temperature for a given linear heat rate and h.\n        \n        Args:\n            q_prime (float): Linear heat rate (W/m).\n            h (float): Convective heat transfer coefficient (W/m^2-K).\n\n        Returns:\n            float: Centerline temperature (K).\n        \"\"\"\n        R_conv = 1 / (2 * np.pi * r_c_out * h)\n        # Note: The problem statement has a small error in the formula grouping.\n        # It should be T(0) = T_inf + q'(R_conv + R_clad + R_gap) + q'/(4*pi*k_f)\n        # The provided formula T(0) = T_inf + q'(R_conv + R_clad + R_gap) + q'/(4*pi*k_f) is equivalent to\n        # T(0) = T_inf + q' * (R_conv + R_clad + R_gap + 1/(4*pi*k_f))\n        # The python code will follow this combined form.\n        temp_rise = q_prime * (R_conv + R_clad + R_gap + fuel_term)\n        return T_inf + temp_rise\n\n    for pin_powers, h in test_cases:\n        # 1. Pin-resolved mapping (true peak temperature)\n        P_max = pin_powers.max()\n        q_prime_max = P_max / L\n        T_peak_true = calculate_centerline_temp(q_prime_max, h)\n\n        # 2. Assembly-homogenized coupling\n        P_avg = pin_powers.mean()\n        q_prime_avg = P_avg / L\n        T_peak_homo = calculate_centerline_temp(q_prime_avg, h)\n\n        # 3. Quantify the error\n        error = abs(T_peak_homo - T_peak_true)\n        results.append(error)\n\n    # Format results for final output\n    formatted_results = [f'{res:.3f}' for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "对于任何耦合模拟而言，获得稳定的数值解都至关重要。本题深入探讨了中子学和热工水力反馈之间迭代过程的收敛性，你将推导出一个最佳的欠松弛因子 $\\omega$ 以加速并稳定定点迭代过程，从而深入了解耦合代码系统的数值核心。",
            "id": "4219855",
            "problem": "一个耦合的中子学-燃料性能迭代过程根据与温度相关的反应性反馈更新堆芯平均功率，并根据与功率相关的产热更新温度。考虑一个关于不动点的准静态线性化，其不动点值的偏差 $\\Delta P = P - P^{\\infty}$ 和 $\\Delta T = T - T^{\\infty}$ 之间存在以下关系：\n- 燃料性能代码根据功率计算温度，关系式为 $\\Delta T = c\\,\\Delta P$。其中 $c > 0$ 是单位功率偏差引起的稳态温升，$P^{\\infty}$ 和 $T^{\\infty}$ 分别表示不动点的功率和温度。\n- 中子学代码根据温度计算功率，关系式为 $\\Delta P_{*} = b\\,\\Delta T$。其中 $b < 0$ 是由于负的有效温度反应性系数导致的功率对温度的线性灵敏度。\n\n这两个代码通过对功率使用欠松弛不动点更新进行耦合，\n$$\nP^{k+1} \\;=\\; P^{k} \\;+\\; \\omega\\big(P_{*}^{k+1} - P^{k}\\big),\n$$\n其中 $\\omega \\in (0,1]$ 是欠松弛因子。假设温度更新是根据当前功率显式计算的，$T^{k+1} = T^{\\infty} + c\\,(P^{k} - P^{\\infty})$，而由中子学代码计算的功率为 $P_{*}^{k+1} = P^{\\infty} + b\\,(T^{k+1} - T^{\\infty})$。\n\n从这些假设和不动点迭代的定义出发，推导 $\\Delta P^{k} = P^{k} - P^{\\infty}$ 的标量误差传播，量化作为 $b$、$c$ 和 $\\omega$ 的函数的线性收敛率，然后确定在区间 $(0,1]$ 内，使收敛因子绝对值在物理上现实的符号约束 $b < 0$ 和 $c>0$ 下最小化的 $\\omega$ 值。请将您的最终答案表示为关于 $b$ 和 $c$ 的最优欠松弛因子 $\\omega$ 的单个闭式、无量纲的解析表达式。不需要数值。",
            "solution": "该问题要求推导耦合中子学-燃料性能不动点迭代的最优欠松弛因子。求解过程将首先推导误差放大方程，确定收敛因子，然后针对欠松弛参数 $\\omega$ 最小化该因子的绝对值。\n\n表示与不动点值 $(P^{\\infty}, T^{\\infty})$ 偏差的变量定义如下：\n$$\n\\Delta P^{k} = P^{k} - P^{\\infty}\n$$\n$$\n\\Delta T^{k} = T^{k} - T^{\\infty}\n$$\n功率的迭代更新公式为：\n$$\nP^{k+1} = P^{k} + \\omega(P_{*}^{k+1} - P^{k})\n$$\n其中 $\\omega \\in (0,1]$ 是欠松弛因子。\n\n为了推导误差传播方程，我们在更新方程的两边同时减去不动点功率 $P^{\\infty}$：\n$$\nP^{k+1} - P^{\\infty} = P^{k} - P^{\\infty} + \\omega(P_{*}^{k+1} - P^{k})\n$$\n使用偏差 $\\Delta P$ 的定义，上式变为：\n$$\n\\Delta P^{k+1} = \\Delta P^{k} + \\omega(P_{*}^{k+1} - P^{k})\n$$\n我们可以将括号中的项改写为：\n$$\nP_{*}^{k+1} - P^{k} = (P_{*}^{k+1} - P^{\\infty}) - (P^{k} - P^{\\infty}) = \\Delta P_{*}^{k+1} - \\Delta P^{k}\n$$\n将此代回 $\\Delta P^{k+1}$ 的方程中，得到：\n$$\n\\Delta P^{k+1} = \\Delta P^{k} + \\omega(\\Delta P_{*}^{k+1} - \\Delta P^{k})\n$$\n$$\n\\Delta P^{k+1} = (1 - \\omega)\\Delta P^{k} + \\omega \\Delta P_{*}^{k+1}\n$$\n该方程将第 $k+1$ 次迭代的误差与第 $k$ 次迭代的误差以及中子学计算的功率偏差 $\\Delta P_{*}^{k+1}$ 联系起来。\n\n接下来，我们必须使用给定的耦合关系，将 $\\Delta P_{*}^{k+1}$ 表示为 $\\Delta P^{k}$ 的函数。问题陈述了温度和中子学计算功率的更新方式如下：\n$$\nT^{k+1} = T^{\\infty} + c(P^{k} - P^{\\infty})\n$$\n$$\nP_{*}^{k+1} = P^{\\infty} + b(T^{k+1} - T^{\\infty})\n$$\n由此，我们可以写出偏差：\n$$\n\\Delta T^{k+1} = T^{k+1} - T^{\\infty} = c(P^{k} - P^{\\infty}) = c\\,\\Delta P^{k}\n$$\n$$\n\\Delta P_{*}^{k+1} = P_{*}^{k+1} - P^{\\infty} = b(T^{k+1} - T^{\\infty}) = b\\,\\Delta T^{k+1}\n$$\n将 $\\Delta T^{k+1}$ 的表达式代入 $\\Delta P_{*}^{k+1}$ 的方程中，得到：\n$$\n\\Delta P_{*}^{k+1} = b(c\\,\\Delta P^{k}) = bc\\,\\Delta P^{k}\n$$\n现在，我们将此结果代回 $\\Delta P^{k+1}$ 的误差传播方程中：\n$$\n\\Delta P^{k+1} = (1 - \\omega)\\Delta P^{k} + \\omega(bc\\,\\Delta P^{k})\n$$\n$$\n\\Delta P^{k+1} = (1 - \\omega + \\omega bc)\\Delta P^{k}\n$$\n这就是标量误差传播方程。迭代的收敛性由放大因子（或称收敛因子）$\\lambda$ 决定，它是 $\\Delta P^{k}$ 的系数：\n$$\n\\lambda(\\omega) = 1 - \\omega + \\omega bc = 1 - \\omega(1 - bc)\n$$\n为了使迭代收敛，该因子的绝对值必须小于 1，即 $|\\lambda| < 1$。线性收敛率由 $|\\lambda|$ 给出。为了找到最优收敛，我们需要在区间 $(0, 1]$ 中找到使 $|\\lambda(\\omega)|$ 最小化的 $\\omega$ 值。\n\n设 $K = 1 - bc$。问题指明了物理上现实的约束条件 $b < 0$ 和 $c > 0$。由此可知，乘积 $bc$ 必定为负：\n$$\nbc < 0\n$$\n因此，$-bc > 0$，且项 $K$ 必须大于 1：\n$$\nK = 1 - bc > 1\n$$\n我们需要在 $\\omega \\in (0, 1]$ 和常数 $K > 1$ 的条件下，最小化函数 $f(\\omega) = |\\lambda(\\omega)| = |1 - \\omega K|$。\n\n函数 $g(\\omega) = 1 - \\omega K$ 是一个关于 $\\omega$ 的线性函数，其斜率为负值 $-K$。绝对值函数 $f(\\omega) = |g(\\omega)|$ 是一个 V 形函数，其顶点（最小值）在 $g(\\omega) = 0$ 处。\n$$\n1 - \\omega K = 0 \\implies \\omega = \\frac{1}{K}\n$$\n由于 $K > 1$，使 $|\\lambda(\\omega)|$ 最小化的 $\\omega$ 值为：\n$$\n\\omega_{opt} = \\frac{1}{K} = \\frac{1}{1 - bc}\n$$\n我们必须验证该最优值位于允许的区间 $\\omega \\in (0, 1]$ 内。由于 $K > 1$，可以得出 $0 < 1/K < 1$。因此，$\\omega_{opt} \\in (0, 1)$，这是指定区间 $(0, 1]$ 的一个子集。\n在此最优值下，收敛因子为 $\\lambda(\\omega_{opt}) = 1 - \\omega_{opt}K = 1 - (1/K)K = 0$，这提供了最快的收敛速度（对于这个线性化系统，一步即可收敛）。\n\n因此，最优欠松弛因子由推导出的关于 $b$ 和 $c$ 的表达式给出。",
            "answer": "$$\\boxed{\\frac{1}{1 - bc}}$$"
        }
    ]
}