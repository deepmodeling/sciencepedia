{
    "hands_on_practices": [
        {
            "introduction": "在应用任何基于牛顿的求解器之前，首要任务是将控制物理现象的偏微分方程（PDE）正确地离散化为一个非线性残差方程 $R(u)=0$。对于像有限元法（FEM）这样的方法，数值积分等实施细节不仅关乎精度，更关乎一致性。本练习  探讨了如何为非线性问题选择合适的数值积分方案，以确保残差计算在JFNK方法的有限差分逼近下保持内部一致性，这是保证求解器鲁棒性的关键一步。",
            "id": "4232114",
            "problem": "考虑长度为 $L$ 的一维燃料棒段中的稳态热传导，其温度场为 $T(x)$，由能量守恒和傅里叶定律控制：在开区间 $(0,L)$ 内，$-\\frac{d}{dx}\\!\\left(k(T)\\,\\frac{dT}{dx}\\right)=q(x)$，并带有狄利克雷边界条件 $T(0)=T_{0}$ 和 $T(L)=T_{L}$，从而使得弱形式中的边界项消失。热导率与温度相关，由 $k(T)=k_{0}+\\alpha\\,T$ 给出，其中 $k_{0}0$ 和 $\\alpha\\ge 0$ 为常数。设体积热源 $q(x)=q_{0}$ 为一个常数。\n\n在均匀网格上，对每个单元使用二次拉格朗日插值（$p=2$），并采用从参考区间到每个物理单元的仿射映射，使用标准伽辽金有限元法，构建第 $i$ 个测试函数的单元残差贡献 $R_{i}^{(e)}(T_{h})$，其中 $T_{h}(x)$ 是 $T(x)$ 的二次有限元近似，测试函数是相应的二次形函数。然后，考虑在每个单元上使用 $n_{q}$ 点高斯-勒让德数值积分法计算 $R_{i}^{(e)}(T_{h})$，确定最小整数 $n_{q}^{\\star}$，使得当 $k(T)=k_{0}+\\alpha\\,T_{h}(x)$ 且 $T_{h}(x)$ 为二次多项式时，$R_{i}^{(e)}(T_{h})$ 中的类刚度积分能够被精确积分。\n\n仅回答 $n_{q}^{\\star}$ 的单个值。无需四舍五入。在你的推导中解释，为何这种积分选择与用于多物理场反应堆模拟的无雅可比牛顿-克雷洛夫（JFNK）方法的要求相一致，即在用于近似雅可比-向量积的方向扰动下，残差计算在内部是一致的。",
            "solution": "该问题要求确定高斯-勒让德积分点的最小数量 $n_{q}^{\\star}$，该数量需要能够为一个非线性热传导问题精确地积分有限元残差的类刚度部分。这个值还必须在无雅可比牛顿-克雷洛夫 (JFNK) 方法的背景下得到证明。\n\n稳态热传导的控制偏微分方程为：\n$$-\\frac{d}{dx}\\!\\left(k(T)\\,\\frac{dT}{dx}\\right) = q(x) \\quad \\text{for } x \\in (0,L)$$\n带有狄利克雷边界条件 $T(0)=T_{0}$ 和 $T(L)=T_{L}$。\n\n为了推导弱形式，我们将控制方程乘以一个测试函数 $v(x)$（其中 $v(x)$ 位于一个合适的函数空间，并在狄利克雷边界上为零，即 $v(0)=v(L)=0$），然后在定义域 $[0,L]$ 上积分：\n$$\\int_{0}^{L} -\\frac{d}{dx}\\!\\left(k(T)\\,\\frac{dT}{dx}\\right) v(x) \\,dx = \\int_{0}^{L} q(x) v(x) \\,dx$$\n对左侧应用分部积分法可得：\n$$\\int_{0}^{L} k(T)\\,\\frac{dT}{dx}\\,\\frac{dv}{dx}\\,dx - \\left[k(T)\\,\\frac{dT}{dx}\\,v(x)\\right]_{0}^{L} = \\int_{0}^{L} q(x) v(x) \\,dx$$\n由于内部节点的测试函数 $v(x)$ 被选择为在 $x=0$ 和 $x=L$ 处为零，边界项消失。因此弱形式为：求 $T(x)$，使得对于所有容许的 $v(x)$，\n$$\\int_{0}^{L} k(T)\\,\\frac{dT}{dx}\\,\\frac{dv}{dx}\\,dx = \\int_{0}^{L} q(x) v(x) \\,dx$$\n\n在伽辽金有限元法中，我们用一个离散函数 $T_{h}(x) = \\sum_{j} T_{j} N_{j}(x)$ 来近似温度场 $T(x)$，其中 $T_{j}$ 是节点温度值，$N_{j}(x)$ 是基函数（形函数）。测试函数 $v(x)$ 从同一组基函数中选取，即 $v(x) = N_{i}(x)$。这对于每个自由度 $i$ 产生一个非线性代数方程组 $R_{i}(\\mathbf{T}) = 0$，其中残差向量 $\\mathbf{R}$ 的分量为：\n$$R_{i}(\\mathbf{T}) = \\int_{0}^{L} k(T_{h})\\,\\frac{dT_{h}}{dx}\\,\\frac{dN_{i}}{dx}\\,dx - \\int_{0}^{L} q(x) N_{i}(x) \\,dx$$\n总残差是每个单元 $(e)$ 贡献的总和，$R_{i} = \\sum_{e} R_{i}^{(e)}$。第 $i$ 个局部节点的单元残差为：\n$$R_{i}^{(e)}(\\mathbf{T}^{(e)}) = \\int_{x_{e}}^{x_{e+1}} k(T_{h}^{(e)})\\,\\frac{dT_{h}^{(e)}}{dx}\\,\\frac{dN_{i}^{(e)}}{dx}\\,dx - \\int_{x_{e}}^{x_{e+1}} q(x) N_{i}^{(e)}(x) \\,dx$$\n问题要求找到能够精确积分第一项，即“类刚度”积分的积分法则，我们将其表示为 $K_{i}^{(e)}$。\n$$K_{i}^{(e)} = \\int_{x_{e}}^{x_{e+1}} k(T_{h}^{(e)})\\,\\frac{dT_{h}^{(e)}}{dx}\\,\\frac{dN_{i}^{(e)}}{dx}\\,dx$$\n问题指定使用二次拉格朗日插值（$p=2$），因此在每个单元上，近似解 $T_{h}^{(e)}$ 和基函数 $N_{i}^{(e)}$ 都是局部坐标系下的二次多项式。\n\n为了执行数值积分，我们将长度为 $h_{e} = x_{e+1} - x_{e}$ 的物理单元 $[x_{e}, x_{e+1}]$ 映射到参考单元 $\\xi \\in [-1, 1]$，使用仿射映射：$x(\\xi) = x_{c} + \\frac{h_{e}}{2}\\xi$，其中 $x_{c}$ 是单元中心。微分元变换为 $dx = \\frac{h_{e}}{2}d\\xi$，空间导数变换为 $\\frac{d}{dx} = \\frac{2}{h_{e}}\\frac{d}{d\\xi}$。\n\n在参考单元上，二次拉格朗日基函数 $N_{j}(\\xi)$ 是2次多项式。温度近似为 $T_{h}^{(e)}(\\xi) = \\sum_{j=1}^{3} T_{j}^{(e)} N_{j}(\\xi)$，它是关于 $\\xi$ 的2次多项式。问题陈述热导率为 $k(T) = k_{0} + \\alpha T$。当使用有限元近似计算积分时，这变为 $k(T_{h}^{(e)}) = k_{0} + \\alpha T_{h}^{(e)}(\\xi)$。由于 $T_{h}^{(e)}(\\xi)$ 是一个2次多项式，因此 $k(T_{h}^{(e)}(\\xi))$ 也是一个关于 $\\xi$ 的2次多项式。\n\n基函数的导数 $\\frac{dN_{j}}{d\\xi}$ 是1次多项式。因此，温度近似和测试函数相对于物理坐标 $x$ 的导数为：\n$$\\frac{dT_{h}^{(e)}}{dx} = \\frac{2}{h_{e}}\\frac{d T_{h}^{(e)}}{d\\xi} = \\frac{2}{h_{e}}\\sum_{j=1}^{3} T_{j}^{(e)} \\frac{dN_{j}}{d\\xi}$$\n$$\\frac{dN_{i}^{(e)}}{dx} = \\frac{2}{h_{e}}\\frac{dN_{i}}{d\\xi}$$\n由于 $\\frac{dN_{j}}{d\\xi}$ 是1次多项式，$\\frac{dT_{h}^{(e)}}{dx}$ 和 $\\frac{dN_{i}^{(e)}}{dx}$ 都是关于 $\\xi$ 的1次多项式。\n\n变换到参考坐标 $\\xi$ 后，类刚度积分的被积函数是：\n$$I(\\xi) = \\underbrace{\\left(k_{0} + \\alpha T_{h}^{(e)}(\\xi)\\right)}_{\\text{2次}} \\times \\underbrace{\\left(\\frac{dT_{h}^{(e)}}{dx}\\right)}_{\\text{1次}} \\times \\underbrace{\\left(\\frac{dN_{i}^{(e)}}{dx}\\right)}_{\\text{1次}} \\times \\underbrace{\\left(\\frac{h_{e}}{2}\\right)}_{\\text{0次}}$$\n完整被积函数 $I(\\xi)$ 的多项式次数是其多项式因子次数的总和：$2 + 1 + 1 = 4$。\n\n一个具有 $n_{q}$ 个点的高斯-勒让德积分法则可以精确地积分最高为 $2n_{q} - 1$ 次的多项式。为了精确地积分我们这个4次被积函数，我们需要：\n$$2n_{q} - 1 \\ge 4$$\n$$2n_{q} \\ge 5$$\n$$n_{q} \\ge 2.5$$\n由于积分点数 $n_{q}$ 必须是整数，满足此条件的最小整数是 $n_{q}^{\\star} = 3$。\n\n这个选择与 JFNK 方法的要求是一致的。在 JFNK 中，每个牛顿步中产生的线性系统 $J(\\mathbf{T})\\delta\\mathbf{T} = -R(\\mathbf{T})$ 是用克雷洛夫方法求解的。克雷洛夫求解器不需要显式的雅可比矩阵 $J$，而是需要它对一个向量 $\\mathbf{v}$ 的作用，即乘积 $J\\mathbf{v}$。这可以通过有限差分方向导数来近似：\n$$J(\\mathbf{T})\\mathbf{v} \\approx \\frac{R(\\mathbf{T} + \\epsilon\\mathbf{v}) - R(\\mathbf{T})}{\\epsilon}$$\n其中 $\\epsilon$ 是一个小参数。这需要计算在当前状态 $\\mathbf{T}$ 和一个扰动状态 $\\mathbf{T}+\\epsilon\\mathbf{v}$ 下的残差函数 $R$。令 $v_{h}(x) = \\sum_{j} v_{j} N_{j}(x)$ 为对应于向量 $\\mathbf{v}$ 的有限元函数。扰动后的温度场为 $T'_{h} = T_{h} + \\epsilon v_{h}$。由于 $v_h$ 由与 $T_h$ 相同的二次基函数表示，因此在每个单元上，它也是关于 $\\xi$ 的2次多项式。\n\n扰动残差 $R(\\mathbf{T}+\\epsilon\\mathbf{v})$ 的刚度部分的被积函数包含项 $k(T'_{h}) \\frac{dT'_{h}}{dx}$。\n$k(T'_{h}) = k_{0} + \\alpha (T_{h} + \\epsilon v_{h})$，这是关于 $\\xi$ 的2次多项式。\n$\\frac{dT'_{h}}{dx} = \\frac{d}{dx}(T_{h} + \\epsilon v_{h}) = \\frac{dT_{h}}{dx} + \\epsilon \\frac{dv_{h}}{dx}$，这是关于 $\\xi$ 的1次多项式。\n因此，扰动残差的刚度项的被积函数是 $\\left(k_{0} + \\alpha (T_{h} + \\epsilon v_{h})\\right) \\left(\\frac{dT_{h}}{dx} + \\epsilon \\frac{dv_{h}}{dx}\\right) \\frac{dN_{i}}{dx}$。最高次项是 $\\alpha\\epsilon v_{h} \\cdot \\epsilon \\frac{dv_{h}}{dx} \\cdot \\frac{dN_{i}}{dx}$，但关于 $\\xi$ 的整体多项式次数仍为 $2 + 1 + 1 = 4$。\n\n为了使 $J\\mathbf{v}$ 的 JFNK 近似精确且不引入损害克雷洛夫收敛性的伪误差，数值积分法则必须对 $R(\\mathbf{T})$ 和 $R(\\mathbf{T}+\\epsilon\\mathbf{v})$ 都精确。由于两个残差的被积函数都是4次多项式，选择 $n_{q}=3$ 确保了有限差分 $J\\mathbf{v}$ 是离散残差算子 $R(\\mathbf{T})$ 方向导数的精确表示。如果使用低阶积分（例如，$n_{q}=2$），$R(\\mathbf{T} + \\epsilon\\mathbf{v})$ 和 $R(\\mathbf{T})$ 中的积分误差将无法正确抵消，导致雅可比-向量积被积分误差污染。这将违反雅可比矩阵的“伽辽金条件”，并严重降低 JFNK 方法的收敛性。因此，$n_{q}^{\\star}=3$ 确保了 JFNK 算法正常运行所需的内部一致性。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在实现了残差计算之后，我们必须验证求解器各组件的正确性，这是代码开发中至关重要的一环。本练习  介绍了“泰勒检验”（Taylor test），这是一种验证雅可比-向量积逼近准确性的基本工具，而该逼近正是JFNK方法的核心。通过结合“人造解法”（method of manufactured solutions），我们能够构建一个完整的基准测试案例，以严格评估和确保我们求解器的正确性。",
            "id": "4232172",
            "problem": "考虑一个一维、稳态、无量纲模型，用于描述占据区域 $x \\in [0,\\pi]$ 的核燃料板中的中子学与热传导耦合问题。未知场为 $u(x) = (\\phi(x), T(x))$，其中 $\\phi(x)$ 是中子标量通量，$T(x)$ 是温度。控制方程基于带有裂变加热的中子扩散和热传导：\n$$\n- \\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a}(T) \\, \\phi = \\nu \\, \\Sigma_{f} \\, \\phi + S_{n}(x),\n$$\n$$\n- \\frac{d}{dx} \\left( k_{T} \\frac{d T}{dx} \\right) = Q_{f} \\, \\Sigma_{f} \\, \\phi + S_{T}(x),\n$$\n其中 $D  0$ 是中子扩散系数，$k_{T}  0$ 是热导率，$\\Sigma_{f}  0$ 是裂变截面，$\\nu  0$ 是每次裂变产生的平均中子数，$Q_{f}  0$ 是每次裂变释放的能量（已缩放为无量纲）。吸收截面通过线性多普勒反馈建模，\n$$\n\\Sigma_{a}(T) = \\Sigma_{a0} + \\alpha \\, T,\n$$\n其中 $\\Sigma_{a0}  0$ 和 $\\alpha  0$ 为常数。假设选择的狄利克雷边界条件与下面定义的人工解一致。\n\n使用人工解方法，选择解析场\n$$\n\\phi(x) = \\Phi_{0} \\cos(x) + \\Phi_{1} \\sin(2x), \\qquad T(x) = T_{0} + \\Theta_{0} \\sin(x),\n$$\n其中常数 $\\Phi_{0}$、$\\Phi_{1}$、$T_{0}$、$\\Theta_{0}$ 已指定且为正。反向计算源项 $S_{n}(x)$ 和 $S_{T}(x)$，使得所选的 $(\\phi,T)$ 对于给定的常数 $D$、$k_{T}$、$\\Sigma_{a0}$、$\\alpha$、$\\Sigma_{f}$、$\\nu$ 和 $Q_{f}$ 精确满足上述方程。\n\n将残差算子 $R(u)$ 按分量定义为\n$$\nR_{\\phi}(u) = - D \\, \\phi'' + (\\Sigma_{a0} + \\alpha T) \\, \\phi - \\nu \\, \\Sigma_{f} \\, \\phi - S_{n}(x),\n$$\n$$\nR_{T}(u) = - k_{T} \\, T'' - Q_{f} \\, \\Sigma_{f} \\, \\phi - S_{T}(x),\n$$\n其中 $'$ 表示对 $x$ 的微分。在 $u$ 处计算的残差的雅可比矩阵，记为 $J R(u)$，通过 $R$ 在 $u$ 点沿方向 $v$ 的方向导数作用于微扰 $v = (v_{\\phi}, v_{T})$。在无雅可比矩阵的牛顿-克雷洛夫 (JFNK) 方法中，雅可比-向量积由一阶差商近似：\n$$\nJ_{\\epsilon}(u; v) = \\frac{R(u + \\epsilon v) - R(u)}{\\epsilon},\n$$\n其中 $\\epsilon  0$ 是一个小参数。$L^{2}$ 范数下的泰勒检验误差为\n$$\nE(\\epsilon) = \\left\\| J_{\\epsilon}(u; v) - J R(u) v \\right\\|_{L^{2}(0,\\pi)}.\n$$\n\n对于特定的测试方向\n$$\nv_{\\phi}(x) = V_{\\phi} \\sin(x), \\qquad v_{T}(x) = V_{T} \\cos(x),\n$$\n其中 $V_{\\phi}  0$ 和 $V_{T}  0$ 为常数，推导 $E(\\epsilon)$ 在小 $\\epsilon$ 展开式中 $\\epsilon$ 的精确领阶系数，即\n$$\n\\lim_{\\epsilon \\to 0^{+}} \\frac{E(\\epsilon)}{\\epsilon}.\n$$\n将你的最终答案表示为关于 $\\alpha$、$V_{\\phi}$、$V_{T}$ 和 $\\pi$ 的简化的闭式解析表达式。无需数值取整。全过程使用无量纲量，答案中不要包含单位。",
            "solution": "用户希望找到应用于一个耦合中子学-热学模型的无雅可比矩阵的牛顿-克雷洛夫(JFNK)方法的泰勒检验误差的领阶系数。该问题是有效的，因为它科学地基于反应堆物理和数值分析的既定模型，是适定的、客观的且内部一致的。\n\n待求的量是极限\n$$ L = \\lim_{\\epsilon \\to 0^{+}} \\frac{E(\\epsilon)}{\\epsilon}, $$\n其中泰勒检验误差 $E(\\epsilon)$ 定义为\n$$ E(\\epsilon) = \\left\\| J_{\\epsilon}(u; v) - J R(u) v \\right\\|_{L^{2}(0,\\pi)}. $$\n这里，$J R(u) v$ 是精确的雅可比-向量积（残差算子 $R(u)$ 在方向 $v$ 上的方向导数），$J_{\\epsilon}(u; v)$ 是其有限差分近似：\n$$ J_{\\epsilon}(u; v) = \\frac{R(u + \\epsilon v) - R(u)}{\\epsilon}. $$\n状态向量是 $u(x) = (\\phi(x), T(x))$，微扰向量是 $v(x) = (v_{\\phi}(x), v_{T}(x))$。\n\n为了分析差值 $J_{\\epsilon}(u; v) - J R(u) v$，我们对 $R(u + \\epsilon v)$ 在 $u$ 周围关于小参数 $\\epsilon$ 进行泰勒级数展开。对于一个足够光滑的算子 $R$，展开式为\n$$ R(u + \\epsilon v) = R(u) + \\epsilon J R(u) v + \\frac{\\epsilon^2}{2} H R(u)(v,v) + O(\\epsilon^3), $$\n其中 $H R(u)(v,v)$ 是 $R$ 在 $u$ 点沿方向 $v$ 的二阶方向导数（即 $R$ 的海森矩阵作用于向量对 $(v, v)$）。\n\n将此展开式代入 $J_{\\epsilon}(u; v)$ 的定义中：\n$$ J_{\\epsilon}(u; v) = \\frac{ \\left( R(u) + \\epsilon J R(u) v + \\frac{\\epsilon^2}{2} H R(u)(v,v) + O(\\epsilon^3) \\right) - R(u) }{\\epsilon} $$\n$$ J_{\\epsilon}(u; v) = J R(u) v + \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2). $$\n因此，差值项为\n$$ J_{\\epsilon}(u; v) - J R(u) v = \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2). $$\n这是有限差分近似的截断误差。\n\n现在，我们可以将误差 $E(\\epsilon)$ 表示为\n$$ E(\\epsilon) = \\left\\| \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2) \\right\\|_{L^{2}(0,\\pi)}. $$\n我们需要计算的量是\n$$ L = \\lim_{\\epsilon \\to 0^{+}} \\frac{E(\\epsilon)}{\\epsilon} = \\lim_{\\epsilon \\to 0^{+}} \\frac{1}{\\epsilon} \\left\\| \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2) \\right\\|_{L^{2}(0,\\pi)}. $$\n利用范数的性质 $\\|c f\\| = |c| \\|f\\|$，我们可以提出因子 $\\epsilon$：\n$$ L = \\lim_{\\epsilon \\to 0^{+}} \\left\\| \\frac{1}{2} H R(u)(v,v) + O(\\epsilon) \\right\\|_{L^{2}(0,\\pi)}. $$\n根据范数的连续性，我们可以将极限移到内部：\n$$ L = \\left\\| \\lim_{\\epsilon \\to 0^{+}} \\left( \\frac{1}{2} H R(u)(v,v) + O(\\epsilon) \\right) \\right\\|_{L^{2}(0,\\pi)} = \\left\\| \\frac{1}{2} H R(u)(v,v) \\right\\|_{L^{2}(0,\\pi)}. $$\n我们的任务简化为计算向量 $\\frac{1}{2} H R(u)(v,v)$ 的 $L^2$ 范数。这需要找到残差算子 $R(u)$ 的二阶方向导数。残差的分量是：\n$$ R_{\\phi}(u) = - D \\, \\phi'' + (\\Sigma_{a0} + \\alpha T) \\, \\phi - \\nu \\, \\Sigma_{f} \\, \\phi - S_{n}(x) $$\n$$ R_{T}(u) = - k_{T} \\, T'' - Q_{f} \\, \\Sigma_{f} \\, \\phi - S_{T}(x) $$\n二阶方向导数 $H R(u)(v,v)$ 是向量 $(\\frac{d^2}{d\\delta^2} R_{\\phi}(u+\\delta v)|_{\\delta=0}, \\frac{d^2}{d\\delta^2} R_{T}(u+\\delta v)|_{\\delta=0})$。\n\n让我们检查各分量在 $u=(\\phi, T)$ 中的非线性。\n$R_T(u)$ 项对 $\\phi$ 和 $T$ 是线性的。因此，它关于 $u$ 的二阶导数为零。\n$$ H R_T(u)(v,v) = 0. $$\n$R_{\\phi}(u)$ 项可以重写为\n$$ R_{\\phi}(u) = - D \\, \\phi'' + \\Sigma_{a0}\\phi + \\alpha T \\phi - \\nu \\Sigma_f \\phi - S_n(x). $$\n在 $u$ 的分量中唯一非线性的项是乘积 $\\alpha T \\phi$。所有其他项都是线性的，因此它们的二阶导数为零。因此，海森矩阵的贡献完全来自这一项。\n令 $g(\\phi, T) = \\alpha T \\phi$。$g$ 在方向 $v=(v_{\\phi}, v_T)$ 上的二阶方向导数是\n$$ \\frac{d^2}{d\\delta^2} g(\\phi + \\delta v_{\\phi}, T + \\delta v_T)|_{\\delta=0} = \\frac{d^2}{d\\delta^2} \\left[ \\alpha (T + \\delta v_T)(\\phi + \\delta v_{\\phi}) \\right] |_{\\delta=0}. $$\n展开方括号内的项得到\n$$ \\alpha(T\\phi + \\delta(T v_{\\phi} + \\phi v_T) + \\delta^2(v_{\\phi}v_T)). $$\n关于 $\\delta$ 的二阶导数是 $2\\alpha v_{\\phi} v_T$。所以，\n$$ H R_{\\phi}(u)(v,v) = 2 \\alpha v_{\\phi}(x) v_{T}(x). $$\n注意，这个结果与基态 $u(x)$ 无关，因此计算不需要给定的 $\\phi(x)$ 和 $T(x)$ 的具体形式。\n\n海森向量是\n$$ H R(u)(v,v) = \\begin{pmatrix} 2 \\alpha v_{\\phi}(x) v_{T}(x) \\\\ 0 \\end{pmatrix}. $$\n现在我们可以计算所需的极限 $L$：\n$$ L = \\left\\| \\frac{1}{2} H R(u)(v,v) \\right\\|_{L^{2}(0,\\pi)} = \\left\\| \\frac{1}{2} \\begin{pmatrix} 2 \\alpha v_{\\phi}(x) v_{T}(x) \\\\ 0 \\end{pmatrix} \\right\\|_{L^{2}(0,\\pi)} = \\left\\| \\begin{pmatrix} \\alpha v_{\\phi}(x) v_{T}(x) \\\\ 0 \\end{pmatrix} \\right\\|_{L^{2}(0,\\pi)}. $$\n$L^2$ 范数定义为 $\\left\\| f \\right\\|_{L^2} = \\sqrt{\\int_0^\\pi \\|f(x)\\|_2^2 dx}$。对于我们的向量函数，这变成\n$$ L = \\sqrt{\\int_0^{\\pi} \\left( (\\alpha v_{\\phi}(x) v_{T}(x))^2 + 0^2 \\right) dx} = \\sqrt{\\int_0^{\\pi} \\alpha^2 (v_{\\phi}(x) v_{T}(x))^2 dx}. $$\n问题给出了具体的测试方向函数：\n$$ v_{\\phi}(x) = V_{\\phi} \\sin(x) \\quad \\text{和} \\quad v_{T}(x) = V_{T} \\cos(x). $$\n将它们代入积分中：\n$$ L = \\sqrt{\\int_0^{\\pi} \\alpha^2 (V_{\\phi} \\sin(x) \\cdot V_{T} \\cos(x))^2 dx} = \\sqrt{\\alpha^2 V_{\\phi}^2 V_{T}^2 \\int_0^{\\pi} \\sin^2(x) \\cos^2(x) dx}. $$\n因为 $\\alpha, V_{\\phi}, V_{T}$ 是正常数，我们有\n$$ L = \\alpha V_{\\phi} V_{T} \\sqrt{\\int_0^{\\pi} \\sin^2(x) \\cos^2(x) dx}. $$\n我们使用三角恒等式 $\\sin(x)\\cos(x) = \\frac{1}{2}\\sin(2x)$。\n$$ \\int_0^{\\pi} \\sin^2(x) \\cos^2(x) dx = \\int_0^{\\pi} \\left( \\frac{1}{2}\\sin(2x) \\right)^2 dx = \\frac{1}{4} \\int_0^{\\pi} \\sin^2(2x) dx. $$\n接下来，我们使用恒等式 $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$。令 $\\theta = 2x$，这变成 $\\sin^2(2x) = \\frac{1 - \\cos(4x)}{2}$。\n$$ \\frac{1}{4} \\int_0^{\\pi} \\left( \\frac{1 - \\cos(4x)}{2} \\right) dx = \\frac{1}{8} \\int_0^{\\pi} (1 - \\cos(4x)) dx. $$\n计算定积分：\n$$ \\frac{1}{8} \\left[ x - \\frac{1}{4}\\sin(4x) \\right]_0^{\\pi} = \\frac{1}{8} \\left[ (\\pi - \\frac{1}{4}\\sin(4\\pi)) - (0 - \\frac{1}{4}\\sin(0)) \\right] = \\frac{1}{8} (\\pi - 0 - 0) = \\frac{\\pi}{8}. $$\n将此结果代回 $L$ 的表达式中：\n$$ L = \\alpha V_{\\phi} V_{T} \\sqrt{\\frac{\\pi}{8}}. $$\n简化平方根项：\n$$ \\sqrt{\\frac{\\pi}{8}} = \\frac{\\sqrt{\\pi}}{\\sqrt{8}} = \\frac{\\sqrt{\\pi}}{2\\sqrt{2}} = \\frac{\\sqrt{\\pi}\\sqrt{2}}{2\\sqrt{2}\\sqrt{2}} = \\frac{\\sqrt{2\\pi}}{4}. $$\n因此，极限的最终表达式为\n$$ L = \\alpha V_{\\phi} V_{T} \\frac{\\sqrt{2\\pi}}{4}. $$\n该表达式是关于指定的常数 $\\alpha$、$V_{\\phi}$、$V_{T}$ 和 $\\pi$ 的。",
            "answer": "$$\\boxed{\\frac{\\alpha V_{\\phi} V_{T} \\sqrt{2\\pi}}{4}}$$"
        },
        {
            "introduction": "即便我们拥有精确的残差和雅可比-向量积的实现，JFNK方法的整体性能依然可能不尽人意。本练习  揭示了克雷洛夫子空间求解器（JFNK中的“K”）的性能对线性系统性质的高度敏感性。它通过一个简化的模型清晰地展示了不良缩放（一个在多物理场耦合问题中普遍存在的挑战）如何导致GMRES等迭代求解器停滞不前，从而强调了预条件处理在成功应用JFNK方法中的核心作用。",
            "id": "4232108",
            "problem": "考虑一个用于求解耦合核反应堆多物理场系统（包含中子扩散和热传导）的无雅可比牛顿-克雷洛夫 (JFNK) 方法，其中非线性残差为 $F(U)$，$U = (\\phi, T)$ 表示中子通量和温度场。在某次迭代中，牛顿线性化旨在求解 $\\delta U$，使得 $J \\, \\delta U = -F(U)$，其中 $J$ 是 $F$ 相对于 $U$ 的雅可比矩阵。假设在这次迭代中，预处理后的雅可比矩阵可以被一个线性算子很好地近似，该算子是可对角化的，其特征向量与物理块对齐，并且在这个简化模型中，有效谱可以表示为对角矩阵：\n$$\nJ = \\begin{pmatrix}\n\\lambda_{\\phi}  0 \\\\\n0  \\lambda_{T}\n\\end{pmatrix},\n$$\n其中 $\\lambda_{\\phi} = 1$ 和 $\\lambda_{T} = 10^{-6}$，这反映了由耦合的输运和传导尺度引起的巨大刚度差异。\n\n假设应用了不恰当的残差缩放，使得中子块的量级保持为 $w_{\\phi} = 1$，而温度块的量级被抑制到 $w_{T} = 10^{-6}$，因此在特征基中的初始残差为：\n$$\nr_{0} = \\begin{pmatrix}\nw_{\\phi} \\\\\nw_{T}\n\\end{pmatrix} = \\begin{pmatrix}\n1 \\\\\n10^{-6}\n\\end{pmatrix}.\n$$\n应用广义最小残差 (GMRES) 方法进行单次迭代 ($k = 1$)。GMRES 方法的定义是在克雷洛夫子空间内，通过一个满足 $p(0)=1$ 的 $J$ 的多项式来最小化残差的范数。在这种情况下，一次迭代后的残差可以写为 $r_{1} = (I - \\alpha J) r_{0}$，其中标量 $\\alpha$ 的选择是为了最小化 $\\|r_{1}\\|_{2}^{2}$。\n\n从 GMRES 单步残差最小化的基本定义出发，推导 $\\alpha$ 的表达式，然后计算小块（温度块）的残差缩减因子\n$$\ng_{T} = \\left| 1 - \\alpha \\lambda_{T} \\right|\n$$\n根据给定的数据计算 $g_T$。将 $g_T$ 以纯数形式给出。如果选择近似计算，请将答案四舍五入到六位有效数字，并且不包含任何单位。",
            "solution": "该问题要求对应用于一个简化、刚性且缩放不良的线性系统的广义最小残差 (GMRES) 方法进行单次迭代分析。该线性系统源于求解核反应堆物理问题的无雅可比牛顿-克雷洛夫 (JFNK) 方法。\n\n首先，我们验证问题的陈述。已知条件如下：\n- 一个表示耦合系统的、简化的对角化雅可比矩阵：\n$$\nJ = \\begin{pmatrix}\n\\lambda_{\\phi}  0 \\\\\n0  \\lambda_{T}\n\\end{pmatrix}\n$$\n- 代表不同物理尺度的特征值：$\\lambda_{\\phi} = 1$ 和 $\\lambda_{T} = 10^{-6}$。\n- 在相同特征基下的、缩放不当的初始残差向量：\n$$\nr_{0} = \\begin{pmatrix}\nw_{\\phi} \\\\\nw_{T}\n\\end{pmatrix} = \\begin{pmatrix}\n1 \\\\\n10^{-6}\n\\end{pmatrix}\n$$\n- GMRES 单次迭代后 ($k=1$) 的残差形式：$r_{1} = (I - \\alpha J) r_{0}$。\n- 优化准则：选择标量 $\\alpha$ 以最小化新残差的欧几里得范数 $\\|r_{1}\\|_{2}$。\n- 待计算的量：小块残差缩减因子 $g_{T} = | 1 - \\alpha \\lambda_{T} |$。\n\n这个问题具有科学依据，因为它使用标准数值方法（JFNK, GMRES）模拟了多物理场仿真中的一个常见且关键的问题（刚性和不良缩放）。这是一个适定问题，具有明确的目标和所有寻找唯一解所需的数据。其语言客观而精确。因此，该问题是有效的。\n\n我们开始求解。核心任务是找到使残差 $r_{1}$ 的欧几里得范数平方最小化的 $\\alpha$ 值。设该目标函数为 $f(\\alpha) = \\|r_{1}\\|_{2}^{2}$。\n\n首先，我们用给定量的形式表示 $r_{1}$：\n$$\nr_{1} = \\left( \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\alpha \\begin{pmatrix} \\lambda_{\\phi}  0 \\\\ 0  \\lambda_{T} \\end{pmatrix} \\right) \\begin{pmatrix} w_{\\phi} \\\\ w_{T} \\end{pmatrix} = \\begin{pmatrix} 1 - \\alpha\\lambda_{\\phi}  0 \\\\ 0  1 - \\alpha\\lambda_{T} \\end{pmatrix} \\begin{pmatrix} w_{\\phi} \\\\ w_{T} \\end{pmatrix} = \\begin{pmatrix} (1 - \\alpha\\lambda_{\\phi})w_{\\phi} \\\\ (1 - \\alpha\\lambda_{T})w_{T} \\end{pmatrix}\n$$\n$r_{1}$ 的范数平方为：\n$$\nf(\\alpha) = \\|r_{1}\\|_{2}^{2} = ((1 - \\alpha\\lambda_{\\phi})w_{\\phi})^{2} + ((1 - \\alpha\\lambda_{T})w_{T})^{2}\n$$\n为了找到最小值，我们对 $f(\\alpha)$ 关于 $\\alpha$ 求导，并令结果为零。\n$$\n\\frac{df}{d\\alpha} = \\frac{d}{d\\alpha} \\left[ (1 - 2\\alpha\\lambda_{\\phi} + \\alpha^{2}\\lambda_{\\phi}^{2})w_{\\phi}^{2} + (1 - 2\\alpha\\lambda_{T} + \\alpha^{2}\\lambda_{T}^{2})w_{T}^{2} \\right] = 0\n$$\n$$\n(-2\\lambda_{\\phi} + 2\\alpha\\lambda_{\\phi}^{2})w_{\\phi}^{2} + (-2\\lambda_{T} + 2\\alpha\\lambda_{T}^{2})w_{T}^{2} = 0\n$$\n求解 $\\alpha$：\n$$\n\\alpha(\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}) = \\lambda_{\\phi}w_{\\phi}^{2} + \\lambda_{T}w_{T}^{2}\n$$\n$$\n\\alpha = \\frac{\\lambda_{\\phi}w_{\\phi}^{2} + \\lambda_{T}w_{T}^{2}}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\n这个表达式给出了单步 GMRES 的最优 $\\alpha$。现在，我们计算小块残差缩减因子 $g_{T} = |1 - \\alpha \\lambda_{T}|$。我们代入推导出的 $\\alpha$ 表达式：\n$$\ng_{T} = \\left| 1 - \\left( \\frac{\\lambda_{\\phi}w_{\\phi}^{2} + \\lambda_{T}w_{T}^{2}}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}} \\right) \\lambda_{T} \\right|\n$$\n为了简化，我们通分：\n$$\n1 - \\alpha \\lambda_{T} = \\frac{(\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}) - (\\lambda_{\\phi}w_{\\phi}^{2}\\lambda_{T} + \\lambda_{T}^{2}w_{T}^{2})}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\n$$\n= \\frac{\\lambda_{\\phi}^{2}w_{\\phi}^{2} - \\lambda_{\\phi}w_{\\phi}^{2}\\lambda_{T}}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}} = \\frac{\\lambda_{\\phi}w_{\\phi}^{2}(\\lambda_{\\phi} - \\lambda_{T})}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\n给定值 $\\lambda_{\\phi} = 1$ 和 $\\lambda_{T} = 10^{-6}$，我们有 $\\lambda_{\\phi}  \\lambda_{T}$。表达式中的所有其他项都是非负的（$w_{\\phi}$、$w_{T}$ 是平方项）。因此，该表达式为正，绝对值是多余的。\n$$\ng_{T} = \\frac{\\lambda_{\\phi}w_{\\phi}^{2}(\\lambda_{\\phi} - \\lambda_{T})}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\n现在，我们代入问题中提供的数值：$\\lambda_{\\phi} = 1$，$\\lambda_{T} = 10^{-6}$，$w_{\\phi} = 1$ 以及 $w_{T} = 10^{-6}$。\n分子是：\n$$\n\\lambda_{\\phi}w_{\\phi}^{2}(\\lambda_{\\phi} - \\lambda_{T}) = 1 \\cdot (1)^{2} \\cdot (1 - 10^{-6}) = 1 - 10^{-6}\n$$\n分母是：\n$$\n\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2} = (1)^{2}(1)^{2} + (10^{-6})^{2}(10^{-6})^{2} = 1 + (10^{-12})(10^{-12}) = 1 + 10^{-24}\n$$\n因此，$g_{T}$ 的精确值为：\n$$\ng_{T} = \\frac{1 - 10^{-6}}{1 + 10^{-24}} = \\frac{0.999999}{1.000000000000000000000001}\n$$\n为了得到最终的数值答案，我们进行除法运算并按要求四舍五入到六位有效数字。\n$$\ng_{T} \\approx 0.999998999999999999999999...\n$$\n前六位有效数字是 $9, 9, 9, 9, 9, 8$。第七位有效数字是 $9$。由于 $9 \\geq 5$，我们将第六位数字向上进位。\n$$\ng_{T} \\approx 0.999999\n$$\n这个结果表明，对应于慢物理（温度）的残差分量（该分量本身已经很小）几乎没有被减小（缩减因子接近于 $1$）。GMRES 迭代几乎完全用于最小化对应于刚性物理（中子）的大残差分量，这凸显了不良缩放对求解器收敛性的不利影响。",
            "answer": "$$\\boxed{0.999999}$$"
        }
    ]
}