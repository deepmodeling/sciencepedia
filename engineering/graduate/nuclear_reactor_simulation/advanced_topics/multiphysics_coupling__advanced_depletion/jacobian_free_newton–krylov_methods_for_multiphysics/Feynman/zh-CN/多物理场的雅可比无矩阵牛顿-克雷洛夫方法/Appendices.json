{
    "hands_on_practices": [
        {
            "introduction": "在应用像JFNK这样强大的数值求解器之前，我们必须首先将连续的物理模型转化为一个离散的非线性方程组 $R(u)=0$。本练习将指导您完成这关键的第一步，通过使用有限体积法推导多群中子扩散方程的残差。通过在通用的非结构网格上处理具有不连续材料属性的离散化过程，您将获得构建先进求解器所需解决的核心代数问题的实践经验。",
            "id": "4232179",
            "problem": "考虑一个建立在通用非结构化多面体网格上的核反应堆堆芯的稳态多群中子扩散模型。设 $G$ 表示能群的数量，对于每个群 $g \\in \\{1,\\dots,G\\}$，群通量场为 $\\phi_{g}(\\mathbf{x})$。在扩散近似下的控制方程为\n$$\n-\\nabla \\cdot \\left(D_{g}(\\mathbf{x}) \\nabla \\phi_{g}(\\mathbf{x})\\right) + \\Sigma_{r,g}(\\mathbf{x}) \\phi_{g}(\\mathbf{x})\n= \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g}(\\mathbf{x}) \\phi_{g'}(\\mathbf{x}) \\;+\\; \\chi_{g} \\frac{1}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g'}(\\mathbf{x}) \\phi_{g'}(\\mathbf{x}) \\;+\\; Q_{g}(\\mathbf{x}),\n$$\n其中 $D_{g}(\\mathbf{x})$ 是扩散系数，$\\Sigma_{r,g}(\\mathbf{x})$ 是移出截面，$\\Sigma_{s,g' \\to g}(\\mathbf{x})$ 是从群 $g'$ 到群 $g$ 的散射截面，$\\Sigma_{f,g'}(\\mathbf{x})$ 是宏观裂变截面，$\\nu$ 是每次裂变产生的平均中子数，$\\chi_{g}$ 是裂变谱在群 $g$ 中的份额，$k$ 是有效增殖因子，$Q_{g}(\\mathbf{x})$ 是一个外部源。所有材料系数在材料界面上可能是不连续的，并且可能依赖于热工水力状态变量；然而，为了本问题中离散化的目的，假设它们在每个控制体内是分片常数，这可能是通过对子单元混合物的精确平均得到的。\n\n设网格由控制体 $\\{V_{i}\\}$（其体积为 $V_{i}$）、每个群 $g$ 的单元中心未知量 $\\phi_{g,i}$ 和面 $\\{f\\}$（其面积为 $A_{f}$，相对于 $V_{i}$ 的单位外法向量为 $\\mathbf{n}_{f}$）组成。对于由单元 $i$ 和 $j_{f}$ 共享的内部面 $f$，设 $d_{i,f}$ 和 $d_{j_{f},f}$ 分别是从各自单元中心沿 $\\mathbf{n}_{f}$ 到面 $f$ 所在平面的距离。在 $D_{g}$ 不连续的界面上，强制通量连续和法向流连续穿过该面。在一个包含多个由 $m$ 索引的材料子区域的单元 $i$ 中，其体积分数为 $f_{m,i}$ 且满足 $\\sum_{m} f_{m,i} = 1$，设单元截面通过精确的混合物平均定义为\n$$\n\\Sigma_{x,g,i} \\;=\\; \\sum_{m} f_{m,i} \\, \\Sigma_{x,g}^{(m)},\n$$\n对于任何 $x \\in \\{r, s(g' \\to g), f\\}$，其中 $\\Sigma_{x,g}^{(m)}$ 是子区域 $m$ 中的材料截面。\n\n从控制方程出发，使用有限体积法，对 $V_{i}$ 和 $V_{j_{f}}$ 之间的一般内部面 $f$ 执行以下步骤：\n\n- 在 $V_{i}$ 上对方程进行积分，并应用散度定理以获得面积分形式的扩散流。\n- 在 $f$ 上强制通量和法向流连续，以推导出一个在 $D_{g}$ 不连续情况下保持一致性的扩散项的两点通量格式。\n- 使用单元平均截面和单元中心通量表示散射、移出和裂变源项。\n\n为用于无雅可比牛顿-克雷洛夫（Jacobian-free Newton–Krylov, JFNK）方法，将残差定义为 $R_{g,i}(\\boldsymbol{\\phi},k)$，其中 $\\boldsymbol{\\phi}$ 是所有单元中心群通量的向量，$k$ 是特征值未知数，使得 $R_{g,i}(\\boldsymbol{\\phi},k) = 0$ 强制执行了群 $g$ 在 $V_{i}$ 中的离散平衡。推导 $R_{g,i}(\\boldsymbol{\\phi},k)$ 的一个封闭形式的解析表达式，用量 $A_{f}$、$d_{i,f}$、$d_{j_{f},f}$、$D_{g,i}$、$D_{g,j_{f}}$、$V_{i}$、$\\Sigma_{r,g,i}$、$\\Sigma_{s,g' \\to g,i}$、$\\Sigma_{f,g',i}$、$\\chi_{g}$、$\\nu$、$k$、$Q_{g,i}$ 以及单元中心未知量 $\\phi_{g,i}$ 和 $\\phi_{g,j_{f}}$ 来表示。\n\n你的最终答案必须是由上述推导得到的 $R_{g,i}(\\boldsymbol{\\phi},k)$ 的单一解析表达式。不需要进行数值计算。最终表达式中不需要单位。如果需要任何假设来封闭面项，请在推导中明确说明；然而，最终答案必须是一个单一的、显式的残差公式。",
            "solution": "该问题要求使用单元中心有限体积法，在非结构化多面体网格上，推导稳态多群中子扩散方程的离散残差。残差，记为 $R_{g,i}(\\boldsymbol{\\phi},k)$，表示在控制体 $V_i$ 中能群 $g$ 的离散化平衡方程。推导过程如下。\n\n首先，我们陈述特定能群 $g$ 的控制方程：\n$$\n-\\nabla \\cdot \\left(D_{g}(\\mathbf{x}) \\nabla \\phi_{g}(\\mathbf{x})\\right) + \\Sigma_{r,g}(\\mathbf{x}) \\phi_{g}(\\mathbf{x})\n= \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g}(\\mathbf{x}) \\phi_{g'}(\\mathbf{x}) + \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g'}(\\mathbf{x}) \\phi_{g'}(\\mathbf{x}) + Q_{g}(\\mathbf{x})\n$$\n该方程表示中子反应率的平衡：泄漏 + 移出 = 散射源 + 裂变源 + 外部源。\n\n为离散化此方程，我们在控制体 $V_i$ 上对其进行积分：\n$$\n\\int_{V_i} \\left( -\\nabla \\cdot \\left(D_{g} \\nabla \\phi_{g}\\right) \\right) dV + \\int_{V_i} \\Sigma_{r,g} \\phi_{g} dV = \\int_{V_i} \\left( \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g} \\phi_{g'} \\right) dV + \\int_{V_i} \\left( \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g'} \\phi_{g'} \\right) dV + \\int_{V_i} Q_{g} dV\n$$\n我们逐项进行离散化。\n\n泄漏项通过应用散度定理来处理：\n$$\n\\int_{V_i} \\left( -\\nabla \\cdot \\left(D_{g} \\nabla \\phi_{g}\\right) \\right) dV = -\\oint_{\\partial V_i} \\left(D_{g} \\nabla \\phi_{g}\\right) \\cdot \\mathbf{n} dS = -\\sum_{f \\in \\partial V_i} \\int_{A_f} \\left(D_{g} \\nabla \\phi_{g}\\right) \\cdot \\mathbf{n}_f dS\n$$\n其中 $\\partial V_i$ 是由面 $f$ 组成的控制体 $V_i$ 的边界。向量 $\\mathbf{n}_f$ 是相对于 $V_i$ 的单位外法向量。项 $-D_{g} \\nabla \\phi_{g}$ 是中子流密度，$\\mathbf{J}_g$。我们正在计算离开控制体的净流。积分变为对面上的求和，并假设法向流在每个面上是均匀的，我们得到：\n$$\n-\\sum_{f \\in \\partial V_i} A_f \\left( \\mathbf{J}_{g,f} \\cdot \\mathbf{n}_f \\right) = -\\sum_{f \\in \\partial V_i} A_f J_{g,f,n}\n$$\n其中 $J_{g,f,n}$ 是通过面 $f$ 的平均法向流。\n\n为了找到在单元 $i$ 和 $j_f$ 之间，具有可能不连续的 $D_g$ 的内部面 $f$ 上 $J_{g,f,n}$ 的表达式，我们在该面上强制通量和法向流连续。我们假设沿着连接单元 $i$ 和 $j_f$ 中心的直线上存在一维通量分布。设垂直于该面的、沿此线的坐标为 $\\xi$，面位于 $\\xi=0$。单元 $i$ 的中心在 $\\xi = -d_{i,f}$，单元 $j_f$ 的中心在 $\\xi = +d_{j_f,f}$。\n在单元 $i$ 内，于面上计算的法向流近似为：\n$$\nJ_{g,f,n} = -D_{g,i} \\frac{\\phi_{g,f} - \\phi_{g,i}}{d_{i,f}}\n$$\n类似地，从单元 $j_f$：\n$$\nJ_{g,f,n} = -D_{g,j_f} \\frac{\\phi_{g,j_f} - \\phi_{g,f}}{d_{j_f,f}}\n$$\n其中 $\\phi_{g,f}$ 是面上的未知通量值。我们可以通过消去 $\\phi_{g,f}$ 来求解 $J_{g,f,n}$。从这两个方程，我们有：\n$$\n\\phi_{g,f} = \\phi_{g,i} - J_{g,f,n} \\frac{d_{i,f}}{D_{g,i}} \\quad \\text{和} \\quad \\phi_{g,f} = \\phi_{g,j_f} + J_{g,f,n} \\frac{d_{j_f,f}}{D_{g,j_f}}\n$$\n令这两个 $\\phi_{g,f}$ 的表达式相等：\n$$\n\\phi_{g,i} - J_{g,f,n} \\frac{d_{i,f}}{D_{g,i}} = \\phi_{g,j_f} + J_{g,f,n} \\frac{d_{j_f,f}}{D_{g,j_f}}\n$$\n求解 $J_{g,f,n}$：\n$$\n\\phi_{g,i} - \\phi_{g,j_f} = J_{g,f,n} \\left( \\frac{d_{i,f}}{D_{g,i}} + \\frac{d_{j_f,f}}{D_{g,j_f}} \\right) \\implies J_{g,f,n} = \\frac{\\phi_{g,i} - \\phi_{g,j_f}}{\\frac{d_{i,f}}{D_{g,i}} + \\frac{d_{j_f,f}}{D_{g,j_f}}}\n$$\n从中子单元 $i$ 泄漏出去的总速率是 $\\sum_{f \\in \\partial V_i} A_f J_{g,f,n}$。使用推导出的流的表达式，单元 $i$ 的净泄漏项为：\n$$\n\\text{Leakage} = \\sum_{f \\in \\partial V_i} \\frac{A_f (\\phi_{g,i} - \\phi_{g,j_f})}{\\frac{d_{i,f}}{D_{g,i}} + \\frac{d_{j_f,f}}{D_{g,j_f}}}\n$$\n该表达式对单元 $i$ 的所有内部面均有效。\n\n其余各项（移出和源项）的离散化较为简单，因为材料属性被假定在每个单元 $V_i$ 内是分片常数。我们使用单元中心通量 $\\phi_{g,i}$ 和单元平均截面 $\\Sigma_{x,g,i}$ 来近似积分。\n$$\n\\int_{V_i} \\Sigma_{r,g} \\phi_{g} dV \\approx \\Sigma_{r,g,i} \\phi_{g,i} V_i\n$$\n$$\n\\int_{V_i} \\left( \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g} \\phi_{g'} \\right) dV \\approx V_i \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g, i} \\phi_{g',i}\n$$\n$$\n\\int_{V_i} \\left( \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g'} \\phi_{g'} \\right) dV \\approx V_i \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g',i} \\phi_{g',i}\n$$\n$$\n\\int_{V_i} Q_{g} dV \\approx Q_{g,i} V_i\n$$\n\n残差 $R_{g,i}(\\boldsymbol{\\phi},k)$ 的定义是令所有反应率的净平衡为零。约定为 $(\\text{损失项}) - (\\text{源项}) = 0$。\n损失项是泄漏和移出。源项是移入散射、裂变和外部源。\n$$\nR_{g,i}(\\boldsymbol{\\phi},k) = (\\text{泄漏} + \\text{移出}) - (\\text{散射源} + \\text{裂变源} + \\text{外部源}) = 0\n$$\n代入推导出的离散表达式：\n$$\nR_{g,i}(\\boldsymbol{\\phi},k) = \\sum_{f \\in \\partial V_i} \\frac{A_f (\\phi_{g,i} - \\phi_{g,j_f})}{\\frac{d_{i,f}}{D_{g,i}} + \\frac{d_{j_f,f}}{D_{g,j_f}}} + \\Sigma_{r,g,i} \\phi_{g,i} V_i - V_i \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g, i} \\phi_{g',i} - V_i \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g',i} \\phi_{g',i} - Q_{g,i} V_i\n$$\n此表达式假设单元 $i$ 的所有面 $f$ 都是内部面，每个面都连接到一个相邻单元 $j_f$。我们可以从非泄漏项中提出体积 $V_i$ 以获得最终形式。\n对全局通量向量 $\\boldsymbol{\\phi}$ 的依赖性通过项 $\\phi_{g,i}$、$\\phi_{g,j_f}$（用于空间耦合）和 $\\phi_{g',i}$（用于能群耦合）体现。对特征值 $k$ 的依赖性在裂变源项中是显式的。",
            "answer": "$$\\boxed{R_{g,i}(\\boldsymbol{\\phi},k) = \\sum_{f \\in \\partial V_i} \\frac{A_f (\\phi_{g,i} - \\phi_{g,j_f})}{\\frac{d_{i,f}}{D_{g,i}} + \\frac{d_{j_f,f}}{D_{g,j_f}}} + V_i \\left( \\Sigma_{r,g,i} \\phi_{g,i} - \\sum_{\\substack{g' = 1 \\\\ g' \\neq g}}^{G} \\Sigma_{s,g' \\to g, i} \\phi_{g',i} - \\frac{\\chi_{g}}{k} \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g',i} \\phi_{g',i} - Q_{g,i} \\right)}$$"
        },
        {
            "introduction": "JFNK方法的精妙之处在于它通过近似计算雅可比矩阵与向量的乘积，从而避免了构建完整的雅可比矩阵。本练习介绍了一个严谨的程序，使用“人造解方法”(Method of Manufactured Solutions, MMS)来验证这一核心近似是否被正确实现。通过创建一个具有已知解析解的问题并进行泰勒测试，您将学会如何确认您的数值算子能够收敛到真实的方向导数，这是开发可靠模拟代码的关键验证步骤。",
            "id": "4232172",
            "problem": "考虑一个占据区域 $x \\in [0,\\pi]$ 的核燃料板中，中子学与热传导耦合的一维、稳态、无量纲模型。未知场为 $u(x) = (\\phi(x), T(x))$，其中 $\\phi(x)$ 是中子标量通量，$T(x)$ 是温度。控制方程基于带有裂变加热的中子扩散和热传导：\n$$\n- \\frac{d}{dx} \\left( D \\frac{d \\phi}{dx} \\right) + \\Sigma_{a}(T) \\, \\phi = \\nu \\, \\Sigma_{f} \\, \\phi + S_{n}(x),\n$$\n$$\n- \\frac{d}{dx} \\left( k_{T} \\frac{d T}{dx} \\right) = Q_{f} \\, \\Sigma_{f} \\, \\phi + S_{T}(x),\n$$\n其中，$D > 0$ 是中子扩散系数，$k_{T} > 0$ 是热导率，$\\Sigma_{f} > 0$ 是裂变截面，$\\nu > 0$ 是每次裂变产生的平均中子数，$Q_{f} > 0$ 是每次裂变释放的能量（已进行无量纲化）。吸收截面采用线性多普勒反馈建模，\n$$\n\\Sigma_{a}(T) = \\Sigma_{a0} + \\alpha \\, T,\n$$\n其中 $\\Sigma_{a0} > 0$ 和 $\\alpha > 0$ 为常数。假设选择的狄利克雷边界条件与下面定义的人工解一致。\n\n使用人工解方法，选择解析场\n$$\n\\phi(x) = \\Phi_{0} \\cos(x) + \\Phi_{1} \\sin(2x), \\qquad T(x) = T_{0} + \\Theta_{0} \\sin(x),\n$$\n其中常数 $\\Phi_{0}$、$\\Phi_{1}$、$T_{0}$、$\\Theta_{0}$ 是给定的正数。对于给定的常数 $D$、$k_{T}$、$\\Sigma_{a0}$、$\\alpha$、$\\Sigma_{f}$、$\\nu$ 和 $Q_{f}$，反向计算源项 $S_{n}(x)$ 和 $S_{T}(x)$，使得所选的 $(\\phi,T)$ 精确满足上述方程。\n\n按分量定义残差算子 $R(u)$ 如下\n$$\nR_{\\phi}(u) = - D \\, \\phi'' + (\\Sigma_{a0} + \\alpha T) \\, \\phi - \\nu \\, \\Sigma_{f} \\, \\phi - S_{n}(x),\n$$\n$$\nR_{T}(u) = - k_{T} \\, T'' - Q_{f} \\, \\Sigma_{f} \\, \\phi - S_{T}(x),\n$$\n其中 $'$ 表示对 $x$ 求导。在 $u$ 处计算的残差的雅可比矩阵，记为 $J R(u)$，通过 $R$ 在 $u$ 处沿方向 $v$ 的方向导数作用于一个微扰 $v = (v_{\\phi}, v_{T})$。在无雅可比的牛顿-克雷洛夫 (JFNK) 方法中，雅可比-向量积由一阶差商近似：\n$$\nJ_{\\epsilon}(u; v) = \\frac{R(u + \\epsilon v) - R(u)}{\\epsilon},\n$$\n其中 $\\epsilon > 0$ 是一个小参数。$L^{2}$ 范数下的泰勒检验误差为\n$$\nE(\\epsilon) = \\left\\| J_{\\epsilon}(u; v) - J R(u) v \\right\\|_{L^{2}(0,\\pi)}.\n$$\n\n对于特定的测试方向\n$$\nv_{\\phi}(x) = V_{\\phi} \\sin(x), \\qquad v_{T}(x) = V_{T} \\cos(x),\n$$\n其中 $V_{\\phi} > 0$ 和 $V_{T} > 0$ 为常数，推导 $E(\\epsilon)$ 在小 $\\epsilon$ 展开式中 $\\epsilon$ 的精确领头阶系数，即\n$$\n\\lim_{\\epsilon \\to 0^{+}} \\frac{E(\\epsilon)}{\\epsilon}.\n$$\n将你的最终答案表示为一个以 $\\alpha$、$V_{\\phi}$、$V_{T}$ 和 $\\pi$ 表示的简化的闭式解析表达式。无需数值取整。全过程使用无量纲量，答案中不要包含单位。",
            "solution": "用户希望找到应用于中子-热耦合模型的无雅可比牛顿-克雷洛夫 (JFNK) 方法的泰勒检验误差的领头阶系数。该问题是有效的，因为它在科学上基于反应堆物理和数值分析的既定模型，是适定的、客观的且内部一致的。\n\n需要确定的量是极限\n$$ L = \\lim_{\\epsilon \\to 0^{+}} \\frac{E(\\epsilon)}{\\epsilon}, $$\n其中泰勒检验误差 $E(\\epsilon)$ 定义为\n$$ E(\\epsilon) = \\left\\| J_{\\epsilon}(u; v) - J R(u) v \\right\\|_{L^{2}(0,\\pi)}. $$\n此处，$J R(u) v$ 是精确的雅可比-向量积（残差算子 $R(u)$ 在方向 $v$ 上的方向导数），而 $J_{\\epsilon}(u; v)$ 是其有限差分近似：\n$$ J_{\\epsilon}(u; v) = \\frac{R(u + \\epsilon v) - R(u)}{\\epsilon}. $$\n状态向量为 $u(x) = (\\phi(x), T(x))$，微扰向量为 $v(x) = (v_{\\phi}(x), v_{T}(x))$。\n\n为了分析差值 $J_{\\epsilon}(u; v) - J R(u) v$，我们对 $R(u + \\epsilon v)$ 在 $u$ 附近关于小参数 $\\epsilon$ 进行泰勒级数展开。对于一个足够光滑的算子 $R$，其展开式为\n$$ R(u + \\epsilon v) = R(u) + \\epsilon J R(u) v + \\frac{\\epsilon^2}{2} H R(u)(v,v) + O(\\epsilon^3), $$\n其中 $H R(u)(v,v)$ 是 $R$ 在 $u$ 处沿方向 $v$ 的二阶方向导数（即 $R$ 的黑塞矩阵作用于向量对 $(v, v)$）。\n\n将此展开式代入 $J_{\\epsilon}(u; v)$ 的定义中：\n$$ J_{\\epsilon}(u; v) = \\frac{ \\left( R(u) + \\epsilon J R(u) v + \\frac{\\epsilon^2}{2} H R(u)(v,v) + O(\\epsilon^3) \\right) - R(u) }{\\epsilon} $$\n$$ J_{\\epsilon}(u; v) = J R(u) v + \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2). $$\n因此，差值项为\n$$ J_{\\epsilon}(u; v) - J R(u) v = \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2). $$\n这是有限差分近似的截断误差。\n\n现在，我们可以将误差 $E(\\epsilon)$ 表示为\n$$ E(\\epsilon) = \\left\\| \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2) \\right\\|_{L^{2}(0,\\pi)}. $$\n我们需要计算的量是\n$$ L = \\lim_{\\epsilon \\to 0^{+}} \\frac{E(\\epsilon)}{\\epsilon} = \\lim_{\\epsilon \\to 0^{+}} \\frac{1}{\\epsilon} \\left\\| \\frac{\\epsilon}{2} H R(u)(v,v) + O(\\epsilon^2) \\right\\|_{L^{2}(0,\\pi)}. $$\n利用范数的性质 $\\|c f\\| = |c| \\|f\\|$，我们可以提出 $\\epsilon$：\n$$ L = \\lim_{\\epsilon \\to 0^{+}} \\left\\| \\frac{1}{2} H R(u)(v,v) + O(\\epsilon) \\right\\|_{L^{2}(0,\\pi)}. $$\n根据范数的连续性，我们可以将极限移到内部：\n$$ L = \\left\\| \\lim_{\\epsilon \\to 0^{+}} \\left( \\frac{1}{2} H R(u)(v,v) + O(\\epsilon) \\right) \\right\\|_{L^{2}(0,\\pi)} = \\left\\| \\frac{1}{2} H R(u)(v,v) \\right\\|_{L^{2}(0,\\pi)}. $$\n我们的任务简化为计算向量 $\\frac{1}{2} H R(u)(v,v)$ 的 $L^2$ 范数。这需要求出残差算子 $R(u)$ 的二阶方向导数。残差的分量为：\n$$ R_{\\phi}(u) = - D \\, \\phi'' + (\\Sigma_{a0} + \\alpha T) \\, \\phi - \\nu \\, \\Sigma_{f} \\, \\phi - S_{n}(x) $$\n$$ R_{T}(u) = - k_{T} \\, T'' - Q_{f} \\, \\Sigma_{f} \\, \\phi - S_{T}(x) $$\n二阶方向导数 $H R(u)(v,v)$ 是向量 $(\\frac{d^2}{d\\delta^2} R_{\\phi}(u+\\delta v)|_{\\delta=0}, \\frac{d^2}{d\\delta^2} R_{T}(u+\\delta v)|_{\\delta=0})$。\n\n让我们检查各分量中关于 $u=(\\phi, T)$ 的非线性项。\n项 $R_T(u)$ 关于 $\\phi$ 和 $T$ 是线性的。因此，它关于 $u$ 的二阶导数为零。\n$$ H R_T(u)(v,v) = 0. $$\n项 $R_{\\phi}(u)$ 可以重写为\n$$ R_{\\phi}(u) = - D \\, \\phi'' + \\Sigma_{a0}\\phi + \\alpha T \\phi - \\nu \\Sigma_f \\phi - S_n(x). $$\n在 $u$ 的分量中唯一非线性的项是乘积 $\\alpha T \\phi$。所有其他项都是线性的，因此它们的二阶导数为零。因此，黑塞矩阵的贡献完全来自这一项。\n令 $g(\\phi, T) = \\alpha T \\phi$。$g$ 在方向 $v=(v_{\\phi}, v_T)$ 上的二阶方向导数是\n$$ \\frac{d^2}{d\\delta^2} g(\\phi + \\delta v_{\\phi}, T + \\delta v_T)|_{\\delta=0} = \\frac{d^2}{d\\delta^2} \\left[ \\alpha (T + \\delta v_T)(\\phi + \\delta v_{\\phi}) \\right] |_{\\delta=0}. $$\n展开方括号中的项得到\n$$ \\alpha(T\\phi + \\delta(T v_{\\phi} + \\phi v_T) + \\delta^2(v_{\\phi}v_T)). $$\n关于 $\\delta$ 的二阶导数是 $2\\alpha v_{\\phi} v_T$。所以，\n$$ H R_{\\phi}(u)(v,v) = 2 \\alpha v_{\\phi}(x) v_{T}(x). $$\n注意到这个结果与基态 $u(x)$ 无关，因此计算中不需要题目提供的 $\\phi(x)$ 和 $T(x)$ 的具体形式。\n\n黑塞向量是\n$$ H R(u)(v,v) = \\begin{pmatrix} 2 \\alpha v_{\\phi}(x) v_{T}(x) \\\\ 0 \\end{pmatrix}. $$\n现在我们可以计算所求的极限 $L$：\n$$ L = \\left\\| \\frac{1}{2} H R(u)(v,v) \\right\\|_{L^{2}(0,\\pi)} = \\left\\| \\frac{1}{2} \\begin{pmatrix} 2 \\alpha v_{\\phi}(x) v_{T}(x) \\\\ 0 \\end{pmatrix} \\right\\|_{L^{2}(0,\\pi)} = \\left\\| \\begin{pmatrix} \\alpha v_{\\phi}(x) v_{T}(x) \\\\ 0 \\end{pmatrix} \\right\\|_{L^{2}(0,\\pi)}. $$\n$L^2$ 范数定义为 $\\left\\| f \\right\\|_{L^2} = \\sqrt{\\int_0^\\pi \\|f(x)\\|_2^2 dx}$。对于我们的向量函数，这变成\n$$ L = \\sqrt{\\int_0^{\\pi} \\left( (\\alpha v_{\\phi}(x) v_{T}(x))^2 + 0^2 \\right) dx} = \\sqrt{\\int_0^{\\pi} \\alpha^2 (v_{\\phi}(x) v_{T}(x))^2 dx}. $$\n问题给出了具体的测试方向函数：\n$$ v_{\\phi}(x) = V_{\\phi} \\sin(x) \\quad \\text{和} \\quad v_{T}(x) = V_{T} \\cos(x). $$\n将它们代入积分中：\n$$ L = \\sqrt{\\int_0^{\\pi} \\alpha^2 (V_{\\phi} \\sin(x) \\cdot V_{T} \\cos(x))^2 dx} = \\sqrt{\\alpha^2 V_{\\phi}^2 V_{T}^2 \\int_0^{\\pi} \\sin^2(x) \\cos^2(x) dx}. $$\n由于 $\\alpha, V_{\\phi}, V_{T}$ 是正常数，我们有\n$$ L = \\alpha V_{\\phi} V_{T} \\sqrt{\\int_0^{\\pi} \\sin^2(x) \\cos^2(x) dx}. $$\n我们使用三角恒等式 $\\sin(x)\\cos(x) = \\frac{1}{2}\\sin(2x)$。\n$$ \\int_0^{\\pi} \\sin^2(x) \\cos^2(x) dx = \\int_0^{\\pi} \\left( \\frac{1}{2}\\sin(2x) \\right)^2 dx = \\frac{1}{4} \\int_0^{\\pi} \\sin^2(2x) dx. $$\n接下来，我们使用恒等式 $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$。令 $\\theta = 2x$，则变为 $\\sin^2(2x) = \\frac{1 - \\cos(4x)}{2}$。\n$$ \\frac{1}{4} \\int_0^{\\pi} \\left( \\frac{1 - \\cos(4x)}{2} \\right) dx = \\frac{1}{8} \\int_0^{\\pi} (1 - \\cos(4x)) dx. $$\n计算定积分：\n$$ \\frac{1}{8} \\left[ x - \\frac{1}{4}\\sin(4x) \\right]_0^{\\pi} = \\frac{1}{8} \\left[ (\\pi - \\frac{1}{4}\\sin(4\\pi)) - (0 - \\frac{1}{4}\\sin(0)) \\right] = \\frac{1}{8} (\\pi - 0 - 0) = \\frac{\\pi}{8}. $$\n将此结果代回 $L$ 的表达式中：\n$$ L = \\alpha V_{\\phi} V_{T} \\sqrt{\\frac{\\pi}{8}}. $$\n简化平方根项：\n$$ \\sqrt{\\frac{\\pi}{8}} = \\frac{\\sqrt{\\pi}}{\\sqrt{8}} = \\frac{\\sqrt{\\pi}}{2\\sqrt{2}} = \\frac{\\sqrt{\\pi}\\sqrt{2}}{2\\sqrt{2}\\sqrt{2}} = \\frac{\\sqrt{2\\pi}}{4}. $$\n因此，极限的最终表达式为\n$$ L = \\alpha V_{\\phi} V_{T} \\frac{\\sqrt{2\\pi}}{4}. $$\n该表达式用指定的常数 $\\alpha$、$V_{\\phi}$、$V_{T}$ 和 $\\pi$ 表示。",
            "answer": "$$\\boxed{\\frac{\\alpha V_{\\phi} V_{T} \\sqrt{2\\pi}}{4}}$$"
        },
        {
            "introduction": "即使一个正确实现的JFNK求解器，在处理耦合多物理系统固有的刚度时也可能遇到困难。本练习使用一个简化模型来演示一种常见的失败模式：由于不良缩放导致的克雷洛夫子空间求解器停滞。通过分析GMRES在具有不同尺度的系统上的一次迭代，您将亲眼看到求解器如何将其精力集中在最刚性的物理场上，导致其他耦合场的收敛几乎停滞，从而强调了预条件处理的关键作用。",
            "id": "4232108",
            "problem": "考虑一个用于耦合核反应堆多物理场系统（包含中子扩散和热传导）的雅可比无关牛顿-克雷洛夫 (JFNK) 求解过程，其中非线性残差为 $F(U)$，$U = (\\phi, T)$ 表示中子通量和温度场。在给定迭代点上的牛顿线性化旨在求解 $\\delta U$，使得 $J \\, \\delta U = -F(U)$，其中 $J$ 是 $F$ 相对于 $U$ 的雅可比矩阵。假设在此迭代点，预处理后的雅可比矩阵可以很好地被一个线性算子近似，该算子是可对角化的，其特征向量与物理块对齐，并且在这个简化模型中，有效谱可以由对角矩阵表示\n$$\nJ = \\begin{pmatrix}\n\\lambda_{\\phi}  0 \\\\\n0  \\lambda_{T}\n\\end{pmatrix},\n$$\n其中 $\\lambda_{\\phi} = 1$ 和 $\\lambda_{T} = 10^{-6}$，这反映了由耦合的输运和传导尺度引起的刚度差异。\n\n假设应用了一个不恰当的残差缩放，使得中子块的量级为 $w_{\\phi} = 1$，而温度块则被抑制到 $w_{T} = 10^{-6}$，因此在特征基中的初始残差为\n$$\nr_{0} = \\begin{pmatrix}\nw_{\\phi} \\\\\nw_{T}\n\\end{pmatrix} = \\begin{pmatrix}\n1 \\\\\n10^{-6}\n\\end{pmatrix}.\n$$\n应用广义最小残差 (GMRES) 方法，该方法定义为在克雷洛夫子空间内，对满足 $p(0)=1$ 的 $J$ 的多项式上最小化残差的范数，进行单次迭代 ($k = 1$)。在这种情况下，一次迭代后的残差可以写为 $r_{1} = (I - \\alpha J) r_{0}$，其中标量 $\\alpha$ 的选择是为了最小化 $\\|r_{1}\\|_{2}^{2}$。\n\n从 GMRES 单步残差最小化的基本定义出发，推导出 $\\alpha$ 的表达式，然后计算给定数据下的小块残差缩减因子\n$$\ng_{T} = \\left| 1 - \\alpha \\lambda_{T} \\right|\n$$\n。将 $g_{T}$ 以纯数形式给出。如果选择近似计算，请将答案四舍五入到六位有效数字，并且不包含任何单位。",
            "solution": "该问题要求分析广义最小残差 (GMRES) 方法的单次迭代，该方法应用于一个简化、刚性且缩放不当的线性系统，此系统源于一个核反应堆物理问题的雅可比无关牛顿-克雷洛夫 (JFNK) 方法。\n\n首先，我们验证问题陈述的有效性。\n给定条件如下：\n- 一个代表耦合系统的简化、对角化的雅可比矩阵：\n$$\nJ = \\begin{pmatrix}\n\\lambda_{\\phi}  0 \\\\\n0  \\lambda_{T}\n\\end{pmatrix}\n$$\n- 特征值，代表了不同的物理尺度：$\\lambda_{\\phi} = 1$ 和 $\\lambda_{T} = 10^{-6}$。\n- 在同一特征基中的一个缩放不当的初始残差向量：\n$$\nr_{0} = \\begin{pmatrix}\nw_{\\phi} \\\\\nw_{T}\n\\end{pmatrix} = \\begin{pmatrix}\n1 \\\\\n10^{-6}\n\\end{pmatrix}\n$$\n- 一次 GMRES 迭代 ($k=1$) 后的残差形式：$r_{1} = (I - \\alpha J) r_{0}$。\n- 优化准则：选择标量 $\\alpha$ 以最小化新残差的欧几里得范数 $\\|r_{1}\\|_{2}$。\n- 需要计算的量：小块残差缩减因子 $g_{T} = | 1 - \\alpha \\lambda_{T} |$。\n\n该问题具有科学依据，因为它使用标准数值方法（JFNK, GMRES）模拟了多物理场仿真中的一个常见且关键的问题（刚性和缩放不当）。问题是适定的，有明确的目标和所有必要的数据来找到唯一解。语言客观而精确。因此，该问题是有效的。\n\n我们开始求解。核心任务是找到最小化残差 $r_{1}$ 的欧几里得范数平方的 $\\alpha$ 值。设该目标函数为 $f(\\alpha) = \\|r_{1}\\|_{2}^{2}$。\n\n首先，我们用给定量的形式表示 $r_{1}$：\n$$\nr_{1} = \\left( \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\alpha \\begin{pmatrix} \\lambda_{\\phi}  0 \\\\ 0  \\lambda_{T} \\end{pmatrix} \\right) \\begin{pmatrix} w_{\\phi} \\\\ w_{T} \\end{pmatrix} = \\begin{pmatrix} 1 - \\alpha\\lambda_{\\phi}  0 \\\\ 0  1 - \\alpha\\lambda_{T} \\end{pmatrix} \\begin{pmatrix} w_{\\phi} \\\\ w_{T} \\end{pmatrix} = \\begin{pmatrix} (1 - \\alpha\\lambda_{\\phi})w_{\\phi} \\\\ (1 - \\alpha\\lambda_{T})w_{T} \\end{pmatrix}\n$$\n$r_{1}$ 的范数平方为：\n$$\nf(\\alpha) = \\|r_{1}\\|_{2}^{2} = ((1 - \\alpha\\lambda_{\\phi})w_{\\phi})^{2} + ((1 - \\alpha\\lambda_{T})w_{T})^{2}\n$$\n为了找到最小值，我们将 $f(\\alpha)$ 对 $\\alpha$ 求导，并令结果为零。\n$$\n\\frac{df}{d\\alpha} = \\frac{d}{d\\alpha} \\left[ (1 - 2\\alpha\\lambda_{\\phi} + \\alpha^{2}\\lambda_{\\phi}^{2})w_{\\phi}^{2} + (1 - 2\\alpha\\lambda_{T} + \\alpha^{2}\\lambda_{T}^{2})w_{T}^{2} \\right] = 0\n$$\n$$\n(-2\\lambda_{\\phi} + 2\\alpha\\lambda_{\\phi}^{2})w_{\\phi}^{2} + (-2\\lambda_{T} + 2\\alpha\\lambda_{T}^{2})w_{T}^{2} = 0\n$$\n求解 $\\alpha$：\n$$\n\\alpha(\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}) = \\lambda_{\\phi}w_{\\phi}^{2} + \\lambda_{T}w_{T}^{2}\n$$\n$$\n\\alpha = \\frac{\\lambda_{\\phi}w_{\\phi}^{2} + \\lambda_{T}w_{T}^{2}}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\n这个表达式给出了单步 GMRES 的最优 $\\alpha$。现在，我们计算小块残差缩减因子 $g_{T} = |1 - \\alpha \\lambda_{T}|$。我们将推导出的 $\\alpha$ 表达式代入：\n$$\ng_{T} = \\left| 1 - \\left( \\frac{\\lambda_{\\phi}w_{\\phi}^{2} + \\lambda_{T}w_{T}^{2}}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}} \\right) \\lambda_{T} \\right|\n$$\n为了简化，我们通分：\n$$\n1 - \\alpha \\lambda_{T} = \\frac{(\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}) - (\\lambda_{\\phi}w_{\\phi}^{2}\\lambda_{T} + \\lambda_{T}^{2}w_{T}^{2})}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\n$$\n= \\frac{\\lambda_{\\phi}^{2}w_{\\phi}^{2} - \\lambda_{\\phi}w_{\\phi}^{2}\\lambda_{T}}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}} = \\frac{\\lambda_{\\phi}w_{\\phi}^{2}(\\lambda_{\\phi} - \\lambda_{T})}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\n给定值 $\\lambda_{\\phi} = 1$ 和 $\\lambda_{T} = 10^{-6}$，我们有 $\\lambda_{\\phi} > \\lambda_{T}$。表达式中的所有其他项都是非负的（$w_{\\phi}$、$w_{T}$ 是平方项）。因此，该表达式为正，绝对值是多余的。\n$$\ng_{T} = \\frac{\\lambda_{\\phi}w_{\\phi}^{2}(\\lambda_{\\phi} - \\lambda_{T})}{\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2}}\n$$\n现在，我们代入问题中提供的数值：$\\lambda_{\\phi} = 1$、$\\lambda_{T} = 10^{-6}$、$w_{\\phi} = 1$ 和 $w_{T} = 10^{-6}$。\n分子是：\n$$\n\\lambda_{\\phi}w_{\\phi}^{2}(\\lambda_{\\phi} - \\lambda_{T}) = 1 \\cdot (1)^{2} \\cdot (1 - 10^{-6}) = 1 - 10^{-6}\n$$\n分母是：\n$$\n\\lambda_{\\phi}^{2}w_{\\phi}^{2} + \\lambda_{T}^{2}w_{T}^{2} = (1)^{2}(1)^{2} + (10^{-6})^{2}(10^{-6})^{2} = 1 + (10^{-12})(10^{-12}) = 1 + 10^{-24}\n$$\n因此，$g_{T}$ 的精确值为：\n$$\ng_{T} = \\frac{1 - 10^{-6}}{1 + 10^{-24}} = \\frac{0.999999}{1.000000000000000000000001}\n$$\n为了得到最终的数值答案，我们进行除法运算，并按要求四舍五入到六位有效数字。\n$$\ng_{T} \\approx 0.999998999999999999999999...\n$$\n前六位有效数字是 $9, 9, 9, 9, 9, 8$。第七位有效数字是 $9$。由于 $9 \\geq 5$，我们将第六位数字向上进位。\n$$\ng_{T} \\approx 0.999999\n$$\n这一结果表明，对应于慢物理（温度）的残差分量本已很小，但几乎没有得到缩减（缩减因子接近1）。GMRES 迭代几乎完全用于最小化对应于刚性物理（中子）的大残差分量，这凸显了不良缩放对求解器收敛性的有害影响。",
            "answer": "$$\\boxed{0.999999}$$"
        }
    ]
}