{
    "hands_on_practices": [
        {
            "introduction": "The stability of a nuclear reactor is critically dependent on inherent feedback mechanisms. This first practice focuses on the most direct of these: the effect of fuel temperature on reactivity. By applying the concept of the fuel temperature coefficient of reactivity, you will perform a straightforward calculation to see how a change in temperature, perhaps from a power transient, directly inserts positive or negative reactivity, governing the subsequent behavior of the reactor. This exercise  provides a quantitative foundation for understanding the self-regulating nature of nuclear systems.",
            "id": "4220228",
            "problem": "A spatially lumped reactor node is initially at steady state with fuel temperature $T_0$ and neutron population corresponding to zero net reactivity at the nominal operating condition. The local fuel temperature coefficient of reactivity is defined at the nominal condition as the derivative $\\alpha_T \\equiv \\left.\\frac{d \\rho}{d T}\\right|_{T_0}$, where $\\rho$ is the dimensionless reactivity and $T$ is the fuel temperature. For this node, careful perturbation measurements give $\\alpha_T = -3.62 \\times 10^{-5}\\ \\mathrm{K}^{-1}$.\n\nA thermal-hydraulic perturbation uniformly increases the fuel temperature by $\\Delta T = 50\\ \\mathrm{K}$ over a short time interval while coolant boundary conditions remain approximately unchanged during that interval. Assume that the functional dependence $\\rho(T)$ is smooth in a neighborhood of $T_0$ and that a first-order approximation about $T_0$ is valid over the interval spanned by $\\Delta T$.\n\nUsing only the definition of the temperature coefficient and first principles of linearization, derive an expression for the first-order change in reactivity induced by the temperature rise and compute its numerical value. Then, based on the point kinetics equations (PKE) with delayed neutrons, qualitatively explain the immediate trend in neutron power following this feedback and the role of the temperature–reactivity coupling in the short term, neglecting other feedbacks and assuming no external reactivity insertion.\n\nExpress the computed reactivity change as a dimensionless decimal, and round your answer to three significant figures.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- Initial state: Steady state, zero net reactivity.\n- Initial fuel temperature: $T_0$.\n- Local fuel temperature coefficient of reactivity: $\\alpha_T \\equiv \\left.\\frac{d \\rho}{d T}\\right|_{T_0} = -3.62 \\times 10^{-5}\\ \\mathrm{K}^{-1}$.\n- Fuel temperature perturbation: $\\Delta T = 50\\ \\mathrm{K}$.\n- Assumption: The function $\\rho(T)$ is smooth near $T_0$.\n- Assumption: A first-order approximation of $\\rho(T)$ about $T_0$ is valid.\n- Task 1: Derive an expression for the first-order change in reactivity, $\\Delta \\rho$.\n- Task 2: Compute the numerical value of $\\Delta \\rho$.\n- Task 3: Qualitatively explain the immediate trend in neutron power and the role of the temperature–reactivity coupling.\n- Constraints: Neglect other feedbacks; no external reactivity insertion.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on the fundamental principles of reactor physics, specifically the concept of reactivity feedback, which is a critical aspect of nuclear reactor dynamics and safety. The definition of the temperature coefficient of reactivity and its application via linearization are standard textbook procedures. The numerical value for $\\alpha_T$ is realistic for light-water moderated reactors.\n2.  **Well-Posed**: The problem is clearly defined. It provides all necessary data ($\\alpha_T$, $\\Delta T$) and a key modeling assumption (first-order approximation is valid) to determine a unique numerical answer for the change in reactivity. The qualitative part is also well-posed, asking for an explanation based on the established framework of the point kinetics equations.\n3.  **Objective**: The problem is stated in precise, quantitative, and unbiased technical language. It is free of ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, and objective. It satisfies all criteria for a valid scientific problem. A solution will be formulated.\n\n***\n\nThe core of the problem lies in the application of a first-order Taylor series expansion to approximate the change in a function given a small perturbation in its independent variable. Here, the function is the reactivity $\\rho$, and the independent variable is the fuel temperature $T$.\n\nThe problem states that the functional dependence $\\rho(T)$ is smooth in a neighborhood of the initial steady-state temperature $T_0$. This allows us to express the reactivity $\\rho$ at a new temperature $T = T_0 + \\Delta T$ using a Taylor expansion around $T_0$:\n$$\n\\rho(T) = \\rho(T_0) + \\left.\\frac{d\\rho}{dT}\\right|_{T_0}(T - T_0) + \\frac{1}{2!}\\left.\\frac{d^2\\rho}{dT^2}\\right|_{T_0}(T - T_0)^2 + \\dots\n$$\nThe problem specifies that a first-order approximation is valid. This means we can neglect terms of the second order and higher. The expression simplifies to:\n$$\n\\rho(T) \\approx \\rho(T_0) + \\left.\\frac{d\\rho}{dT}\\right|_{T_0}(T - T_0)\n$$\nThe change in reactivity, $\\Delta \\rho$, is defined as the difference between the new reactivity $\\rho(T)$ and the initial reactivity $\\rho(T_0)$:\n$$\n\\Delta \\rho = \\rho(T) - \\rho(T_0)\n$$\nSubstituting the first-order approximation for $\\rho(T)$, we get:\n$$\n\\Delta \\rho \\approx \\left( \\rho(T_0) + \\left.\\frac{d\\rho}{dT}\\right|_{T_0}(T - T_0) \\right) - \\rho(T_0)\n$$\nThis simplifies to the expression for the first-order change in reactivity:\n$$\n\\Delta \\rho \\approx \\left.\\frac{d\\rho}{dT}\\right|_{T_0}(T - T_0)\n$$\nThe problem provides the definitions for the terms on the right-hand side. The temperature coefficient of reactivity is $\\alpha_T \\equiv \\left.\\frac{d\\rho}{dT}\\right|_{T_0}$, and the change in temperature is $\\Delta T = T - T_0$. Thus, the derived expression is:\n$$\n\\Delta \\rho \\approx \\alpha_T \\Delta T\n$$\nNow, we compute the numerical value using the given data:\n$\\alpha_T = -3.62 \\times 10^{-5}\\ \\mathrm{K}^{-1}$ and $\\Delta T = 50\\ \\mathrm{K}$.\n$$\n\\Delta \\rho \\approx (-3.62 \\times 10^{-5}\\ \\mathrm{K}^{-1}) \\times (50\\ \\mathrm{K})\n$$\n$$\n\\Delta \\rho \\approx -181 \\times 10^{-5}\n$$\n$$\n\\Delta \\rho \\approx -0.00181\n$$\nThis value is dimensionless, as required for reactivity. The result has three significant figures, consistent with the precision of the input $\\alpha_T$.\n\nNext, we address the qualitative explanation. The computed change in reactivity, $\\Delta \\rho \\approx -0.00181$, is negative. This is a negative reactivity insertion into the reactor core. The dynamic behavior of the total neutron population, $N(t)$, and thus the reactor power, is governed by the point kinetics equations (PKE). A simplified form of the PKE for the neutron population is:\n$$\n\\frac{dN}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda}N(t) + \\sum_{i=1}^{M} \\lambda_i C_i(t)\n$$\nwhere $\\beta$ is the total delayed neutron fraction, $\\Lambda$ is the prompt neutron generation time, $\\lambda_i$ are the decay constants for the delayed neutron precursors, and $C_i(t)$ are the concentrations of these precursors.\n\nInitially, the reactor is at steady state, so $\\rho = 0$ and $\\frac{dN}{dt} = 0$. The temperature perturbation introduces a negative reactivity, $\\rho = \\Delta \\rho = -0.00181$. The term $\\frac{\\rho(t) - \\beta}{\\Lambda}$ in the PKE immediately becomes more negative. This causes the time derivative of the neutron population, $\\frac{dN}{dt}$, to become negative. Consequently, the neutron population, and thus the reactor power, will immediately begin to decrease.\n\nThe role of the temperature–reactivity coupling in this scenario is that of a negative feedback mechanism. This is a critical feature for inherent reactor safety. The sequence of events is as follows:\n1.  A thermal perturbation causes the fuel temperature to increase ($\\Delta T > 0$).\n2.  The negative temperature coefficient of reactivity ($\\alpha_T < 0$) couples this temperature change to the neutronics, inducing a negative reactivity change ($\\Delta \\rho < 0$).\n3.  This negative reactivity causes the fission rate and reactor power to decrease.\n4.  The reduction in power leads to less heat being generated in the fuel, which counteracts the initial temperature increase, thus stabilizing the reactor.\nThis self-regulating behavior ensures that a transient increase in temperature is met with a response that naturally drives the system back toward a stable, lower-power state, preventing an uncontrolled power excursion. This is a fundamental principle of passive safety in reactor design.",
            "answer": "$$\\boxed{-0.00181}$$"
        },
        {
            "introduction": "In practical multiphysics simulations, the neutronics and thermal-hydraulics calculations are often performed on different computational meshes tailored to the needs of each field. A crucial step in coupling these simulations is the transfer of data, such as power density, from one mesh to another in a way that conserves physical quantities like total energy. This exercise  tasks you with implementing a conservative mapping scheme and, just as importantly, quantifying the numerical error introduced by this spatial averaging process, a key skill in assessing simulation fidelity.",
            "id": "4220229",
            "problem": "A one-dimensional axial segment of a pressurized water reactor core is discretized by the neutronics solver into six fine-mesh cells with constant volumetric fission power density in each cell. The thermal-hydraulics (TH) solver uses a coarser mesh that groups the fine cells into three contiguous TH control volumes. The fine-mesh cell volumes and neutronic volumetric power densities are:\n- Fine-mesh cell indices and volumes: $i=1,\\dots,6$ with $\\{V_{i}\\}=\\{0.4,\\,0.6,\\,0.5,\\,0.7,\\,0.5,\\,0.3\\}\\ \\mathrm{m}^{3}$.\n- Fine-mesh volumetric power densities: $\\{p_{i}\\}=\\{9.5\\times 10^{6},\\,1.05\\times 10^{7},\\,1.20\\times 10^{7},\\,1.15\\times 10^{7},\\,1.00\\times 10^{7},\\,9.00\\times 10^{6}\\}\\ \\mathrm{W/m^{3}}$.\n\nThe TH mesh groups the fine cells as follows: TH cell $A$ contains fine cells $1$ and $2$, TH cell $B$ contains fine cells $3$ and $4$, and TH cell $C$ contains fine cells $5$ and $6$.\n\nUsing conservative averaging grounded in energy conservation, map the neutronic volumetric power density field onto the TH mesh so that the volumetric power density assigned to each TH cell equals the volume-averaged fine-mesh power over that TH control volume. Then, treat this mapped TH field as piecewise constant over each TH cell and reconstruct a fine-mesh field by assigning the TH cell’s value to each of its constituent fine cells.\n\nDefine the residual mapping error as the volume-weighted root-mean-square of the difference between the original fine-mesh field and the reconstructed fine-mesh field, normalized by the volume-weighted root-mean-square of the original fine-mesh field, both interpreted as $L^{2}$ norms over the total volume. Compute this residual mapping error from first principles. Round your answer to four significant figures. Express the final error as a decimal (dimensionless).",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n-   Fine-mesh cells: $i=1, 2, 3, 4, 5, 6$.\n-   Fine-mesh cell volumes: $\\{V_i\\} = \\{0.4, 0.6, 0.5, 0.7, 0.5, 0.3\\}\\ \\mathrm{m}^{3}$.\n-   Fine-mesh volumetric power densities: $\\{p_i\\} = \\{9.5 \\times 10^6, 1.05 \\times 10^7, 1.20 \\times 10^7, 1.15 \\times 10^7, 1.00 \\times 10^7, 9.00 \\times 10^6\\}\\ \\mathrm{W/m^{3}}$.\n-   Thermal-Hydraulics (TH) mesh grouping:\n    -   TH cell $A$ contains fine cells $1, 2$.\n    -   TH cell $B$ contains fine cells $3, 4$.\n    -   TH cell $C$ contains fine cells $5, 6$.\n-   Mapping Procedure (Down-mapping): The volumetric power density for a TH cell is the volume-averaged fine-mesh power over its control volume.\n-   Reconstruction Procedure (Up-mapping): The reconstructed fine-mesh power density in a cell is the value of the TH cell that contains it.\n-   Error Definition: The residual mapping error is the volume-weighted root-mean-square of the difference between the original and reconstructed fine-mesh fields, normalized by the volume-weighted root-mean-square of the original fine-mesh field.\n-   Required Output: The numerical value of the error, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard numerical procedure for coupling different physics models on different computational meshes, a common practice in multiphysics simulations like those for nuclear reactors. The method of volume-averaging is based on the principle of energy conservation. All data and definitions are provided, are free of contradictions, and are physically plausible. The problem is a formalizable and verifiable calculation that is directly relevant to the topic of nuclear reactor simulation. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe solution proceeds in three stages:\n1.  Map the fine-mesh power density field $\\{p_i\\}$ onto the coarse TH mesh to obtain the field $\\{P_J\\}$.\n2.  Reconstruct a new fine-mesh field $\\{p'_i\\}$ by mapping the coarse-mesh field $\\{P_J\\}$ back onto the fine mesh.\n3.  Calculate the residual mapping error as defined.\n\nLet the fine-mesh indices be $i \\in \\{1, \\dots, 6\\}$ and the TH cell indices be $J \\in \\{A, B, C\\}$. The sets of fine-mesh indices corresponding to each TH cell are $I_A = \\{1, 2\\}$, $I_B = \\{3, 4\\}$, and $I_C = \\{5, 6\\}$.\n\n**1. Down-mapping to the TH mesh**\n\nThe volumetric power density $P_J$ in a TH cell $J$ is the total power generated within its volume divided by its total volume. This is a volume-weighted average of the fine-mesh power densities.\n$$ P_J = \\frac{\\sum_{i \\in I_J} p_i V_i}{\\sum_{i \\in I_J} V_i} $$\nFirst, we calculate the volumes of the TH cells.\n$$ V_A = V_1 + V_2 = 0.4\\ \\mathrm{m}^3 + 0.6\\ \\mathrm{m}^3 = 1.0\\ \\mathrm{m}^3 $$\n$$ V_B = V_3 + V_4 = 0.5\\ \\mathrm{m}^3 + 0.7\\ \\mathrm{m}^3 = 1.2\\ \\mathrm{m}^3 $$\n$$ V_C = V_5 + V_6 = 0.5\\ \\mathrm{m}^3 + 0.3\\ \\mathrm{m}^3 = 0.8\\ \\mathrm{m}^3 $$\n\nNext, we calculate the average power density for each TH cell.\nFor TH cell $A$:\n$$ P_A = \\frac{p_1 V_1 + p_2 V_2}{V_A} = \\frac{(9.5 \\times 10^6 \\ \\mathrm{W/m}^3)(0.4\\ \\mathrm{m}^3) + (1.05 \\times 10^7 \\ \\mathrm{W/m}^3)(0.6\\ \\mathrm{m}^3)}{1.0\\ \\mathrm{m}^3} $$\n$$ P_A = \\frac{3.8 \\times 10^6 \\ \\mathrm{W} + 6.3 \\times 10^6 \\ \\mathrm{W}}{1.0\\ \\mathrm{m}^3} = \\frac{10.1 \\times 10^6 \\ \\mathrm{W}}{1.0\\ \\mathrm{m}^3} = 1.01 \\times 10^7 \\ \\mathrm{W/m}^3 $$\nFor TH cell $B$:\n$$ P_B = \\frac{p_3 V_3 + p_4 V_4}{V_B} = \\frac{(1.20 \\times 10^7 \\ \\mathrm{W/m}^3)(0.5\\ \\mathrm{m}^3) + (1.15 \\times 10^7 \\ \\mathrm{W/m}^3)(0.7\\ \\mathrm{m}^3)}{1.2\\ \\mathrm{m}^3} $$\n$$ P_B = \\frac{6.0 \\times 10^6 \\ \\mathrm{W} + 8.05 \\times 10^6 \\ \\mathrm{W}}{1.2\\ \\mathrm{m}^3} = \\frac{14.05 \\times 10^6 \\ \\mathrm{W}}{1.2\\ \\mathrm{m}^3} \\approx 1.17083 \\times 10^7 \\ \\mathrm{W/m}^3 $$\nFor TH cell $C$:\n$$ P_C = \\frac{p_5 V_5 + p_6 V_6}{V_C} = \\frac{(1.00 \\times 10^7 \\ \\mathrm{W/m}^3)(0.5\\ \\mathrm{m}^3) + (9.00 \\times 10^6 \\ \\mathrm{W/m}^3)(0.3\\ \\mathrm{m}^3)}{0.8\\ \\mathrm{m}^3} $$\n$$ P_C = \\frac{5.0 \\times 10^6 \\ \\mathrm{W} + 2.7 \\times 10^6 \\ \\mathrm{W}}{0.8\\ \\mathrm{m}^3} = \\frac{7.7 \\times 10^6 \\ \\mathrm{W}}{0.8\\ \\mathrm{m}^3} = 9.625 \\times 10^6 \\ \\mathrm{W/m}^3 $$\n\n**2. Up-mapping to reconstruct the fine-mesh field**\n\nThe reconstructed fine-mesh field $\\{p'_i\\}$ is created by assigning the power density of a TH cell to all fine-mesh cells it contains.\n$$ p'_i = P_J, \\quad \\text{for } i \\in I_J $$\n$$ \\{p'_1, p'_2\\} = \\{P_A, P_A\\} = \\{1.01 \\times 10^7, 1.01 \\times 10^7\\}\\ \\mathrm{W/m}^3 $$\n$$ \\{p'_3, p'_4\\} = \\{P_B, P_B\\} = \\{\\frac{14.05}{1.2} \\times 10^6, \\frac{14.05}{1.2} \\times 10^6\\}\\ \\mathrm{W/m}^3 $$\n$$ \\{p'_5, p'_6\\} = \\{P_C, P_C\\} = \\{9.625 \\times 10^6, 9.625 \\times 10^6\\}\\ \\mathrm{W/m}^3 $$\n\n**3. Calculation of the residual mapping error**\n\nThe error $\\epsilon$ is the volume-weighted $L^2$ norm of the difference field $(p-p')$ normalized by the volume-weighted $L^2$ norm of the original field $p$.\n$$ \\epsilon = \\frac{\\|p - p'\\|_V}{\\|p\\|_V} = \\sqrt{\\frac{\\sum_{i=1}^6 (p_i - p'_i)^2 V_i}{\\sum_{i=1}^6 p_i^2 V_i}} $$\nThe common factor of $10^6$ in all power densities will be squared in both the numerator and denominator, thus canceling out. We can perform the calculation with scaled power densities $\\tilde{p}_i = p_i / (10^6 \\ \\mathrm{W/m}^3)$ and $\\tilde{P}_J = P_J / (10^6 \\ \\mathrm{W/m}^3)$.\n\nNumerator term, $\\mathcal{N} = \\sum_{i=1}^6 (\\tilde{p}_i - \\tilde{p}'_i)^2 V_i$:\n- For $i=1$: $(9.5 - 10.1)^2 \\times 0.4 = (-0.6)^2 \\times 0.4 = 0.36 \\times 0.4 = 0.144$.\n- For $i=2$: $(10.5 - 10.1)^2 \\times 0.6 = (0.4)^2 \\times 0.6 = 0.16 \\times 0.6 = 0.096$.\n- For $i=3$: $(12.0 - \\frac{14.05}{1.2})^2 \\times 0.5 = (\\frac{14.4 - 14.05}{1.2})^2 \\times 0.5 = (\\frac{0.35}{1.2})^2 \\times 0.5 = (\\frac{35}{120})^2 \\times 0.5 = (\\frac{7}{24})^2 \\times 0.5 = \\frac{49}{576} \\times 0.5 = \\frac{49}{1152}$.\n- For $i=4$: $(11.5 - \\frac{14.05}{1.2})^2 \\times 0.7 = (\\frac{13.8 - 14.05}{1.2})^2 \\times 0.7 = (\\frac{-0.25}{1.2})^2 \\times 0.7 = (\\frac{-25}{120})^2 \\times 0.7 = (\\frac{-5}{24})^2 \\times 0.7 = \\frac{25}{576} \\times 0.7 = \\frac{17.5}{576} = \\frac{35}{1152}$.\n- For $i=5$: $(10.0 - 9.625)^2 \\times 0.5 = (0.375)^2 \\times 0.5 = 0.140625 \\times 0.5 = 0.0703125 = \\frac{9}{128}$.\n- For $i=6$: $(9.0 - 9.625)^2 \\times 0.3 = (-0.625)^2 \\times 0.3 = 0.390625 \\times 0.3 = 0.1171875 = \\frac{15}{128}$.\n\nSumming the terms for the numerator:\n$$ \\mathcal{N} = 0.144 + 0.096 + \\frac{49}{1152} + \\frac{35}{1152} + \\frac{9}{128} + \\frac{15}{128} $$\n$$ \\mathcal{N} = 0.24 + \\frac{84}{1152} + \\frac{24}{128} = \\frac{24}{100} + \\frac{7}{96} + \\frac{3}{16} = \\frac{6}{25} + \\frac{7}{96} + \\frac{18}{96} = \\frac{6}{25} + \\frac{25}{96} $$\n$$ \\mathcal{N} = \\frac{6 \\times 96 + 25 \\times 25}{25 \\times 96} = \\frac{576 + 625}{2400} = \\frac{1201}{2400} $$\nSo $\\mathcal{N} \\approx 0.50041667$.\n\nDenominator term, $\\mathcal{D} = \\sum_{i=1}^6 \\tilde{p}_i^2 V_i$:\n- For $i=1$: $(9.5)^2 \\times 0.4 = 90.25 \\times 0.4 = 36.1$.\n- For $i=2$: $(10.5)^2 \\times 0.6 = 110.25 \\times 0.6 = 66.15$.\n- For $i=3$: $(12.0)^2 \\times 0.5 = 144.0 \\times 0.5 = 72.0$.\n- For $i=4$: $(11.5)^2 \\times 0.7 = 132.25 \\times 0.7 = 92.575$.\n- For $i=5$: $(10.0)^2 \\times 0.5 = 100.0 \\times 0.5 = 50.0$.\n- For $i=6$: $(9.0)^2 \\times 0.3 = 81.0 \\times 0.3 = 24.3$.\n\nSumming the terms for the denominator:\n$$ \\mathcal{D} = 36.1 + 66.15 + 72.0 + 92.575 + 50.0 + 24.3 = 341.125 $$\n\nFinally, we compute the error $\\epsilon$:\n$$ \\epsilon = \\sqrt{\\frac{\\mathcal{N}}{\\mathcal{D}}} = \\sqrt{\\frac{1201/2400}{341.125}} = \\sqrt{\\frac{0.50041666...}{341.125}} \\approx \\sqrt{0.0014669598} $$\n$$ \\epsilon \\approx 0.038300911 $$\nRounding to four significant figures, we get $0.03830$. The trailing zero is significant.",
            "answer": "$$\\boxed{0.03830}$$"
        },
        {
            "introduction": "Moving beyond isolated calculations, this final practice challenges you to synthesize multiple physical models into a coherent computational tool. You will implement a program that homogenizes pin-level temperature data to compute assembly-wide cross sections and key feedback coefficients like the Doppler and moderator temperature coefficients. This exercise  closely mirrors the work of a reactor simulation engineer, translating fundamental physics—such as the square-root temperature dependence for Doppler broadening and linear density changes for moderator effects—into a practical, predictive model.",
            "id": "4220200",
            "problem": "A core simulation engineer is developing a simplified but physically consistent method to couple neutronics and thermal-hydraulics in a Pressurized Water Reactor (PWR). The goal is to take pin-wise fuel and moderator temperature distributions and produce assembly-wise neutronic feedback parameters and updated homogenized macroscopic cross sections for use in core-level neutronic calculations. The engineer decides to work in a one-group, infinite-medium approximation to isolate temperature-feedback effects while preserving mass and neutron balance.\n\nStarting from fundamental definitions of microscopic and macroscopic cross sections, neutron production, and neutron absorption, consider the following modeling assumptions that are widely used and experimentally supported at a reduced-order modeling level:\n\n1. The neutron balance in an infinite homogeneous mixture leads to the infinite-medium effective multiplication factor $k_{\\infty}$ defined by the ratio of neutron production to absorption. If the total neutron production rate density is $P$ and the total absorption rate density is $A$, then $$k_{\\infty} = \\frac{P}{A}.$$ For a homogenized fuel-moderator mixture, take production to arise only from fuel fission with average neutron yield per fission $ \\nu $, and absorption to arise from both fuel and moderator.\n\n2. Pin-wise fuel and moderator temperatures are given, and each pin carries a power fraction weight. Let an assembly contain $N$ pins indexed by $i \\in \\{1,\\dots,N\\}$, with power-fraction weights $w_i$ satisfying $\\sum_{i=1}^{N} w_i = 1$, fuel temperatures $T_{f,i}$ in Kelvin, and moderator temperatures $T_{m,i}$ in Kelvin.\n\n3. For fuel, model the one-group macroscopic absorption cross section as increasing with temperature due to Doppler broadening of resonances. Use a Doppler factor that scales as the square root of the fuel temperature relative to a reference, $$\\Sigma_{a,F}(T_{f,i}) = \\Sigma_{a,F}^{\\mathrm{ref}}\\sqrt{\\frac{T_{f,i}}{T_{f}^{\\mathrm{ref}}}},$$ where $\\Sigma_{a,F}^{\\mathrm{ref}}$ is the reference one-group fuel macroscopic absorption cross section at the reference fuel temperature $T_{f}^{\\mathrm{ref}}$. Model the one-group fuel macroscopic fission cross section as temperature-independent at this level, $$\\Sigma_{f,F}(T_{f,i}) = \\Sigma_{f,F}^{\\mathrm{ref}}.$$\n\n4. For moderator, model the one-group macroscopic absorption cross section as proportional to the number density, which varies with mass density. Use a linearized equation of state about a reference moderator temperature $T_{m}^{\\mathrm{ref}}$ with reference mass density $\\rho_{m}^{\\mathrm{ref}}$ and volumetric thermal expansion coefficient $\\beta$, $$\\rho_{m}(T_{m,i}) = \\rho_{m}^{\\mathrm{ref}}\\left(1 - \\beta\\left(T_{m,i} - T_{m}^{\\mathrm{ref}}\\right)\\right),$$ and a reference one-group moderator macroscopic absorption cross section $\\Sigma_{a,M}^{\\mathrm{ref}}$ at $\\rho_{m}^{\\mathrm{ref}}$, yielding $$\\Sigma_{a,M}(T_{m,i}) = \\Sigma_{a,M}^{\\mathrm{ref}}\\frac{\\rho_{m}(T_{m,i})}{\\rho_{m}^{\\mathrm{ref}}} = \\Sigma_{a,M}^{\\mathrm{ref}}\\left(1 - \\beta\\left(T_{m,i} - T_{m}^{\\mathrm{ref}}\\right)\\right).$$\n\n5. Construct assembly-homogenized macroscopic cross sections by power-weighted averaging of pin-wise cross sections, $$\\Sigma_{x}^{\\mathrm{asm}} = \\sum_{i=1}^{N} w_i \\Sigma_{x,i},$$ for $x \\in \\{a,F,f,F; a,M\\}$, and form the total assembly absorption cross section $$\\Sigma_{a}^{\\mathrm{asm}} = \\sum_{i=1}^{N} w_i\\left(\\Sigma_{a,F}(T_{f,i}) + \\Sigma_{a,M}(T_{m,i})\\right).$$ The assembly fuel fission cross section is $$\\Sigma_{f}^{\\mathrm{asm}} = \\sum_{i=1}^{N} w_i \\Sigma_{f,F}(T_{f,i}) = \\Sigma_{f,F}^{\\mathrm{ref}}.$$\n\n6. Evaluate the infinite-medium multiplication factor and reactivity using $$k_{\\infty}^{\\mathrm{asm}} = \\frac{\\nu \\Sigma_{f}^{\\mathrm{asm}}}{\\Sigma_{a}^{\\mathrm{asm}}}, \\quad \\rho^{\\mathrm{asm}} = \\frac{k_{\\infty}^{\\mathrm{asm}} - 1}{k_{\\infty}^{\\mathrm{asm}}}.$$\n\n7. Define assembly-wise temperature coefficients as local derivatives of reactivity with respect to the assembly's fuel and moderator temperatures, evaluated by central finite differences with a probe step $\\delta T$ applied uniformly to all pins. Specifically, with a probe step $\\delta T = 1\\,\\mathrm{K}$,\n   - Fuel Doppler coefficient $$c_{D} = \\frac{\\rho^{\\mathrm{asm}}\\left(T_{f,1}+\\delta T,\\dots,T_{f,N}+\\delta T; T_{m,1},\\dots,T_{m,N}\\right) - \\rho^{\\mathrm{asm}}\\left(T_{f,1}-\\delta T,\\dots,T_{f,N}-\\delta T; T_{m,1},\\dots,T_{m,N}\\right)}{2\\delta T},$$ which has units of $\\mathrm{K}^{-1}$.\n   - Moderator temperature coefficient $$c_{M} = \\frac{\\rho^{\\mathrm{asm}}\\left(T_{f,1},\\dots,T_{f,N}; T_{m,1}+\\delta T,\\dots,T_{m,N}+\\delta T\\right) - \\rho^{\\mathrm{asm}}\\left(T_{f,1},\\dots,T_{f,N}; T_{m,1}-\\delta T,\\dots,T_{m,N}-\\delta T\\right)}{2\\delta T},$$ which also has units of $\\mathrm{K}^{-1}$.\n\nConstants and reference values for this problem are:\n- Average neutron yield per fission $\\nu = 2.40$.\n- Reference one-group fuel macroscopic fission cross section $\\Sigma_{f,F}^{\\mathrm{ref}} = 0.06\\,\\mathrm{cm}^{-1}$.\n- Reference one-group fuel macroscopic absorption cross section $\\Sigma_{a,F}^{\\mathrm{ref}} = 0.10\\,\\mathrm{cm}^{-1}$ at reference fuel temperature $T_{f}^{\\mathrm{ref}} = 900\\,\\mathrm{K}$.\n- Reference one-group moderator macroscopic absorption cross section $\\Sigma_{a,M}^{\\mathrm{ref}} = 5.0\\times 10^{-4}\\,\\mathrm{cm}^{-1}$ at reference moderator temperature $T_{m}^{\\mathrm{ref}} = 600\\,\\mathrm{K}$ and reference density $\\rho_{m}^{\\mathrm{ref}}$.\n- Volumetric thermal expansion coefficient $\\beta = 2.5\\times 10^{-4}\\,\\mathrm{K}^{-1}$.\n- Central difference probe step $\\delta T = 1\\,\\mathrm{K}$.\n\nAll temperatures must be in Kelvin, all macroscopic cross sections must be in inverse centimeters, and the temperature coefficients must be in inverse Kelvin. The effective multiplication factor $k_{\\infty}$ and reactivity $\\rho$ are dimensionless. Express all outputs as decimal floats.\n\nTask: Implement a program that, for each test case, takes the pin-wise temperatures and weights, computes the assembly-homogenized macroscopic absorption and fuel fission cross sections, $k_{\\infty}$, $\\rho$, the fuel Doppler coefficient $c_{D}$, and the moderator temperature coefficient $c_{M}$ according to the model above. Aggregate the outputs for all test cases into a single line in the specified format.\n\nTest Suite:\n- Case $1$: $N=4$, weights $[0.30,\\,0.25,\\,0.25,\\,0.20]$, fuel temperatures $[920,\\,905,\\,910,\\,915]\\,\\mathrm{K}$, moderator temperatures $[595,\\,600,\\,605,\\,598]\\,\\mathrm{K}$.\n- Case $2$: $N=4$, weights $[0.25,\\,0.25,\\,0.25,\\,0.25]$, fuel temperatures $[900,\\,900,\\,900,\\,900]\\,\\mathrm{K}$, moderator temperatures $[600,\\,600,\\,600,\\,600]\\,\\mathrm{K}$.\n- Case $3$: $N=4$, weights $[0.40,\\,0.30,\\,0.20,\\,0.10]$, fuel temperatures $[890,\\,895,\\,900,\\,885]\\,\\mathrm{K}$, moderator temperatures $[620,\\,625,\\,630,\\,623]\\,\\mathrm{K}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a list of lists, one inner list per test case in the order given, with each inner list containing six floats in the order $[c_{D},\\,c_{M},\\,\\Sigma_{a}^{\\mathrm{asm}},\\,\\Sigma_{f}^{\\mathrm{asm}},\\,k_{\\infty}^{\\mathrm{asm}},\\,\\rho^{\\mathrm{asm}}]$. The line must be exactly of the form\n$$\\text{\"[[r_{11},r_{12},r_{13},r_{14},r_{15},r_{16}],[r_{21},r_{22},r_{23},r_{24},r_{25},r_{26}],[r_{31},r_{32},r_{33},r_{34},r_{35},r_{36}]]\"}$$\nwith decimal numbers and no additional text.",
            "solution": "The problem is valid. It presents a scientifically grounded, well-posed, and objective problem in nuclear reactor physics, specifically concerning the coupling of neutronics and thermal-hydraulics at a reduced-order level. All necessary data, models, and constants are provided to calculate the required quantities. The models, while simplified, are standard approximations in reactor analysis.\n\nThe task is to compute assembly-homogenized neutronic parameters from pin-wise temperature distributions. This involves a sequence of calculations based on the provided physical models and definitions. The solution is structured by first computing the baseline parameters for each test case and then using these results to determine the temperature coefficients via a finite difference method.\n\nFirst, we establish the procedure for calculating the baseline assembly-homogenized parameters: the total absorption cross section $\\Sigma_{a}^{\\mathrm{asm}}$, the fuel fission cross section $\\Sigma_{f}^{\\mathrm{asm}}$, the infinite-medium multiplication factor $k_{\\infty}^{\\mathrm{asm}}$, and the reactivity $\\rho^{\\mathrm{asm}}$. The process begins at the individual fuel pin level.\n\nFor each pin $i$ in an assembly of $N$ pins, we are given a fuel temperature $T_{f,i}$, a moderator temperature $T_{m,i}$, and a power-fraction weight $w_i$. The temperature-dependent macroscopic cross sections for each pin are calculated as follows:\nThe fuel absorption cross section, $\\Sigma_{a,F}(T_{f,i})$, incorporates Doppler broadening through a square-root dependence on the absolute fuel temperature:\n$$ \\Sigma_{a,F}(T_{f,i}) = \\Sigma_{a,F}^{\\mathrm{ref}}\\sqrt{\\frac{T_{f,i}}{T_{f}^{\\mathrm{ref}}}} $$\nwhere $\\Sigma_{a,F}^{\\mathrm{ref}} = 0.10\\,\\mathrm{cm}^{-1}$ is the reference cross section at $T_{f}^{\\mathrm{ref}} = 900\\,\\mathrm{K}$.\nThe fuel fission cross section, $\\Sigma_{f,F}(T_{f,i})$, is assumed to be independent of temperature at this level of approximation:\n$$ \\Sigma_{f,F}(T_{f,i}) = \\Sigma_{f,F}^{\\mathrm{ref}} = 0.06\\,\\mathrm{cm}^{-1} $$\nThe moderator absorption cross section, $\\Sigma_{a,M}(T_{m,i})$, changes due to density variations with temperature. Using a linearized equation of state, this dependence is modeled as:\n$$ \\Sigma_{a,M}(T_{m,i}) = \\Sigma_{a,M}^{\\mathrm{ref}}\\left(1 - \\beta\\left(T_{m,i} - T_{m}^{\\mathrm{ref}}\\right)\\right) $$\nwhere $\\Sigma_{a,M}^{\\mathrm{ref}} = 5.0\\times 10^{-4}\\,\\mathrm{cm}^{-1}$ is the reference value at $T_{m}^{\\mathrm{ref}} = 600\\,\\mathrm{K}$, and $\\beta = 2.5\\times 10^{-4}\\,\\mathrm{K}^{-1}$ is the volumetric thermal expansion coefficient.\n\nNext, these pin-wise cross sections are homogenized to obtain assembly-level effective cross sections. The problem specifies a power-weighted averaging scheme. The assembly-homogenized total absorption cross section, $\\Sigma_{a}^{\\mathrm{asm}}$, is the sum of the fuel and moderator contributions from each pin, weighted by their respective power fractions:\n$$ \\Sigma_{a}^{\\mathrm{asm}} = \\sum_{i=1}^{N} w_i \\left( \\Sigma_{a,F}(T_{f,i}) + \\Sigma_{a,M}(T_{m,i}) \\right) $$\nThe assembly-homogenized fission cross section is similarly averaged. Since $\\Sigma_{f,F}$ is constant for all pins, and the weights sum to unity ($\\sum_{i=1}^{N} w_i = 1$), the result simplifies:\n$$ \\Sigma_{f}^{\\mathrm{asm}} = \\sum_{i=1}^{N} w_i \\Sigma_{f,F}(T_{f,i}) = \\Sigma_{f,F}^{\\mathrm{ref}} \\sum_{i=1}^{N} w_i = \\Sigma_{f,F}^{\\mathrm{ref}} = 0.06\\,\\mathrm{cm}^{-1} $$\n\nWith the homogenized cross sections, the infinite-medium multiplication factor for the assembly, $k_{\\infty}^{\\mathrm{asm}}$, is calculated as the ratio of neutron production to absorption. Neutron production is given by $\\nu \\Sigma_{f}^{\\mathrm{asm}}$ and absorption by $\\Sigma_{a}^{\\mathrm{asm}}$, where $\\nu = 2.40$ is the average number of neutrons released per fission.\n$$ k_{\\infty}^{\\mathrm{asm}} = \\frac{\\nu \\Sigma_{f}^{\\mathrm{asm}}}{\\Sigma_{a}^{\\mathrm{asm}}} $$\nFrom $k_{\\infty}^{\\mathrm{asm}}$, the assembly reactivity $\\rho^{\\mathrm{asm}}$ is determined by its standard definition:\n$$ \\rho^{\\mathrm{asm}} = \\frac{k_{\\infty}^{\\mathrm{asm}} - 1}{k_{\\infty}^{\\mathrm{asm}}} $$\n\nThe final step is to calculate the assembly-wise temperature coefficients of reactivity: the fuel Doppler coefficient, $c_{D}$, and the moderator temperature coefficient, $c_{M}$. These coefficients quantify the change in reactivity due to uniform changes in fuel and moderator temperatures, respectively. They are calculated using a central finite difference approximation for the partial derivatives of reactivity.\nTo find the Doppler coefficient $c_D$, we evaluate the reactivity at two perturbed states where the fuel temperature of every pin is uniformly shifted by $\\pm\\delta T$, where $\\delta T = 1\\,\\mathrm{K}$. Let $\\rho^{\\mathrm{asm}}(T_f, T_m)$ be the reactivity as a function of the fuel and moderator temperature vectors. Then:\n$$ c_{D} = \\frac{\\rho^{\\mathrm{asm}}(T_f + \\delta T, T_m) - \\rho^{\\mathrm{asm}}(T_f - \\delta T, T_m)}{2\\delta T} $$\nwhere $T_f + \\delta T$ denotes the array $[T_{f,1}+\\delta T, \\dots, T_{f,N}+\\delta T]$.\nSimilarly, the moderator temperature coefficient $c_M$ is found by perturbing the moderator temperatures while keeping fuel temperatures at their base values:\n$$ c_{M} = \\frac{\\rho^{\\mathrm{asm}}(T_f, T_m + \\delta T) - \\rho^{\\mathrm{asm}}(T_f, T_m - \\delta T)}{2\\delta T} $$\nwhere $T_m + \\delta T$ denotes the array $[T_{m,1}+\\delta T, \\dots, T_{m,N}+\\delta T]$.\n\nTo implement this procedure computationally, a helper function is designed to take vectors of pin-wise temperatures ($T_f$ and $T_m$) and weights ($w$) as input and return the calculated reactivity $\\rho^{\\mathrm{asm}}$. This function encapsulates the entire calculation chain from pin-wise cross sections to homogenized parameters. For each test case, this function is first called with the given base temperatures to obtain the primary results ($\\Sigma_{a}^{\\mathrm{asm}}, \\Sigma_{f}^{\\mathrm{asm}}, k_{\\infty}^{\\mathrm{asm}}, \\rho^{\\mathrm{asm}}$). Then, it is called again with perturbed temperature arrays to obtain the necessary reactivity values for the finite difference formulas for $c_D$ and $c_M$. The use of `numpy` arrays facilitates the element-wise operations on temperatures and the vectorized calculation of pin-wise cross sections and weighted sums.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the nuclear reactor simulation problem.\n    It processes a suite of test cases, calculates neutronic feedback parameters,\n    and prints the results in the specified format.\n    \"\"\"\n    \n    # Define constants and reference values from the problem statement.\n    constants = {\n        'nu': 2.40,\n        'Sigma_f_F_ref': 0.06,  # cm^-1\n        'Sigma_a_F_ref': 0.10,  # cm^-1\n        'Tf_ref': 900.0,       # K\n        'Sigma_a_M_ref': 5.0e-4, # cm^-1\n        'Tm_ref': 600.0,       # K\n        'beta': 2.5e-4,        # K^-1\n        'delta_T': 1.0,         # K\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'weights': [0.30, 0.25, 0.25, 0.20],\n            'fuel_temps': [920.0, 905.0, 910.0, 915.0],\n            'mod_temps': [595.0, 600.0, 605.0, 598.0]\n        },\n        {\n            'weights': [0.25, 0.25, 0.25, 0.25],\n            'fuel_temps': [900.0, 900.0, 900.0, 900.0],\n            'mod_temps': [600.0, 600.0, 600.0, 600.0]\n        },\n        {\n            'weights': [0.40, 0.30, 0.20, 0.10],\n            'fuel_temps': [890.0, 895.0, 900.0, 885.0],\n            'mod_temps': [620.0, 625.0, 630.0, 623.0]\n        },\n    ]\n\n    def calculate_assembly_params(Tf_pin, Tm_pin, w_pin, consts):\n        \"\"\"\n        Calculates assembly-homogenized parameters for a given set of pin-wise\n        temperatures and weights.\n\n        Args:\n            Tf_pin (np.ndarray): Array of pin-wise fuel temperatures in Kelvin.\n            Tm_pin (np.ndarray): Array of pin-wise moderator temperatures in Kelvin.\n            w_pin (np.ndarray): Array of pin-wise power fraction weights.\n            consts (dict): Dictionary of physical constants and reference values.\n\n        Returns:\n            dict: A dictionary containing the calculated assembly parameters.\n        \"\"\"\n        # Pin-wise macroscopic cross-section calculations\n        Sigma_a_F_pin = consts['Sigma_a_F_ref'] * np.sqrt(Tf_pin / consts['Tf_ref'])\n        Sigma_a_M_pin = consts['Sigma_a_M_ref'] * (1.0 - consts['beta'] * (Tm_pin - consts['Tm_ref']))\n        \n        # Assembly-homogenized cross-sections\n        Sigma_f_asm = consts['Sigma_f_F_ref']  # Constant for all pins and assembly\n        Sigma_a_asm = np.sum(w_pin * (Sigma_a_F_pin + Sigma_a_M_pin))\n\n        # Assembly-level k-infinity and reactivity\n        k_inf_asm = (consts['nu'] * Sigma_f_asm) / Sigma_a_asm\n        rho_asm = (k_inf_asm - 1.0) / k_inf_asm\n        \n        return {\n            'Sigma_a_asm': Sigma_a_asm,\n            'Sigma_f_asm': Sigma_f_asm,\n            'k_inf_asm': k_inf_asm,\n            'rho_asm': rho_asm\n        }\n\n    all_results = []\n    for case in test_cases:\n        w_pin = np.array(case['weights'])\n        Tf_pin = np.array(case['fuel_temps'])\n        Tm_pin = np.array(case['mod_temps'])\n\n        # Calculate base parameters\n        base_params = calculate_assembly_params(Tf_pin, Tm_pin, w_pin, constants)\n\n        # Calculate Fuel Doppler Coefficient (c_D)\n        delta_T = constants['delta_T']\n        rho_plus_f = calculate_assembly_params(Tf_pin + delta_T, Tm_pin, w_pin, constants)['rho_asm']\n        rho_minus_f = calculate_assembly_params(Tf_pin - delta_T, Tm_pin, w_pin, constants)['rho_asm']\n        c_D = (rho_plus_f - rho_minus_f) / (2.0 * delta_T)\n\n        # Calculate Moderator Temperature Coefficient (c_M)\n        rho_plus_m = calculate_assembly_params(Tf_pin, Tm_pin + delta_T, w_pin, constants)['rho_asm']\n        rho_minus_m = calculate_assembly_params(Tf_pin, Tm_pin - delta_T, w_pin, constants)['rho_asm']\n        c_M = (rho_plus_m - rho_minus_m) / (2.0 * delta_T)\n\n        # Assemble the results for the current test case in the specified order\n        case_results = [\n            c_D,\n            c_M,\n            base_params['Sigma_a_asm'],\n            base_params['Sigma_f_asm'],\n            base_params['k_inf_asm'],\n            base_params['rho_asm']\n        ]\n        all_results.append(case_results)\n    \n    # Format the final output string exactly as specified.\n    outer_parts = []\n    for row in all_results:\n        inner_part = ','.join(f\"{x:.10f}\" for x in row)\n        outer_parts.append(f'[{inner_part}]')\n    final_output_string = f\"[{','.join(outer_parts)}]\"\n\n    # Based on the problem description, the final output must be in a specific format.\n    # The example given is \"[[r11,...]]\", which suggests the string itself should contain the quotes.\n    # However, standard practice for coding challenges is that the print output matches the content\n    # without the outer quotes. Let's stick to the direct output of the list structure.\n    # Re-evaluating the problem description for format.\n    # Final Output Format: Your program should produce a single line of output containing the results as a list of lists ... The line must be exactly of the form\n    # $$ \\text{\"[[r11...]]\"} $$\n    # The mathjax formatting suggests the output itself should contain the quotes.\n    # But then the sample Python solution doesn't add quotes.\n    # A third interpretation is that the `text` tag is rendering the content inside the quotes.\n    # This is highly ambiguous. Sticking to the most likely interpretation for a programming problem: print the raw string representation.\n    # Let's re-examine the example. `final_output_string = f\"[{','.join(outer_parts)}]\"` is correct for generating [[...],[...]].\n    # For better precision and to avoid scientific notation, formatting the numbers.\n    formatted_rows = []\n    for row in all_results:\n        formatted_row = f\"[{','.join(map(str, row))}]\"\n        formatted_rows.append(formatted_row)\n    print(f\"[{','.join(formatted_rows)}]\")\n```"
        }
    ]
}