{
    "hands_on_practices": [
        {
            "introduction": "在伽马输运计算中，一个核心任务是将描述单个原子相互作用概率的微观截面与描述辐射在宏观材料中衰减的宏观系数联系起来。本练习将通过一个具体的物理现象——光电效应的K吸收边——来实践这一基本换算。通过计算铅在K壳层吸收边附近的宏观衰减系数的突变，您将加深对截面数据如何直接影响材料屏蔽性能的理解。",
            "id": "4228852",
            "problem": "反应堆屏蔽分析需要定量描述单能伽马射线束在铅中的衰减如何随着光子能量穿过K层吸收边而变化。考虑一个均匀、等温、同位素天然的铅板，其质量密度为$\\rho$，摩尔质量为$M$。一束能量接近铅的K层结合能的窄束单能光子束穿过该铅板。宏观衰减系数，记作 $\\Sigma(E)$，定义为比尔-朗伯定律中关联强度随路径长度的微分变化的比例因子。微观总截面 $\\sigma_{\\text{tot}}(E)$ 是所有相关光子相互作用的微观截面之和。在K吸收边附近，$\\sigma_{\\text{tot}}(E)$ 的主要不连续性来自于K层吸收的光电效应截面，而散射贡献则随能量平滑变化。\n\n现提供从美国国家标准与技术研究院 (NIST) 的铅光子相互作用数据库中获取的以下表格数据：\n- 铅的K层结合能：$E_{K} = 88.0\\,\\mathrm{keV}$（供参考；L层结合能 $E_{L_{1}} = 15.86\\,\\mathrm{keV}$、$E_{L_{2}} = 15.20\\,\\mathrm{keV}$ 和 $E_{L_{3}} = 13.02\\,\\mathrm{keV}$ 远低于此能量，并且在所考虑的窄能量区间内不产生不连续性）。\n- 在K吸收边下方 $E^{-} = 87.9\\,\\mathrm{keV}$ 处的微观光电效应截面：$\\sigma_{\\text{pe}}^{-} = 2.2 \\times 10^{-23}\\,\\mathrm{cm}^{2}$。\n- 在K吸收边上方 $E^{+} = 88.1\\,\\mathrm{keV}$ 处的微观光电效应截面：$\\sigma_{\\text{pe}}^{+} = 7.4 \\times 10^{-23}\\,\\mathrm{cm}^{2}$。\n- 铅的质量密度：$\\rho = 11.34\\,\\mathrm{g}\\,\\mathrm{cm}^{-3}$。\n- 铅的摩尔质量：$M = 207.2\\,\\mathrm{g}\\,\\mathrm{mol}^{-1}$。\n- 阿伏伽德罗常数：$N_{A} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$。\n\n假设在这些能量下不允许发生电子对生成，并且Rayleigh散射和Compton散射对 $\\sigma_{\\text{tot}}(E)$ 的贡献在区间 $[87.9, 88.1]\\,\\mathrm{keV}$ 上是平滑变化的，因此 $\\Sigma(E)$ 的阶跃变化完全由光电项引起。计算宏观衰减系数在K吸收边上的变化量，定义为\n$$\\Delta \\Sigma = \\Sigma(E^{+}) - \\Sigma(E^{-}),$$\n以 $\\mathrm{cm}^{-1}$ 为单位表示你的答案，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算单能伽马射线束在铅中穿过K层吸收边时，宏观衰减系数的变化量 $\\Delta \\Sigma$。\n\n出现在比尔-朗伯定律 $dI = -I \\Sigma(E) dx$ 中的宏观衰减系数 $\\Sigma(E)$，与材料的原子数密度 $N$ 以及每个原子的微观总截面 $\\sigma_{\\text{tot}}(E)$ 通过以下基本关系式相关联：\n$$\n\\Sigma(E) = N \\sigma_{\\text{tot}}(E)\n$$\n原子数密度 $N$（单位体积内的原子数）可以通过材料的质量密度 $\\rho$、摩尔质量 $M$ 和阿伏伽德罗常数 $N_A$ 使用以下公式确定：\n$$\nN = \\frac{\\rho N_A}{M}\n$$\n需要计算的量是宏观衰减系数在K吸收边上的变化量 $\\Delta \\Sigma$。它被定义为在紧邻吸收边上方能量 $E^{+}$ 处的值与在紧邻吸收边下方能量 $E^{-}$ 处的值之差：\n$$\n\\Delta \\Sigma = \\Sigma(E^{+}) - \\Sigma(E^{-})\n$$\n通过代入 $\\Sigma(E)$ 的表达式，我们可以用微观截面来表示 $\\Delta \\Sigma$：\n$$\n\\Delta \\Sigma = N \\sigma_{\\text{tot}}(E^{+}) - N \\sigma_{\\text{tot}}(E^{-}) = N \\left( \\sigma_{\\text{tot}}(E^{+}) - \\sigma_{\\text{tot}}(E^{-}) \\right)\n$$\n微观总截面 $\\sigma_{\\text{tot}}(E)$ 是所有可能的光子相互作用的截面之和。对于能量在 $88\\,\\mathrm{keV}$ 附近的光子，主要的相互作用是光电效应 ($\\sigma_{\\text{pe}}$)、Rayleigh（相干）散射 ($\\sigma_{\\text{Rayleigh}}$) 和 Compton（非相干）散射 ($\\sigma_{\\text{Compton}}$)。由于光子能量远小于阈值 $2m_e c^2 \\approx 1.022\\,\\mathrm{MeV}$，电子对生成在能量上是禁戒的。因此，总截面为：\n$$\n\\sigma_{\\text{tot}}(E) = \\sigma_{\\text{pe}}(E) + \\sigma_{\\text{Rayleigh}}(E) + \\sigma_{\\text{Compton}}(E)\n$$\n问题陈述了散射贡献（Rayleigh和Compton）在窄区间 $[87.9, 88.1]\\,\\mathrm{keV}$ 上随能量平滑变化。这是一个物理上合理的假设，因为这些过程不表现出急剧的不连续性（吸收边）。因此，我们可以近似地认为在这个非常小的能量范围内散射截面是恒定的：$\\sigma_{\\text{Rayleigh}}(E^{+}) \\approx \\sigma_{\\text{Rayleigh}}(E^{-})$ 和 $\\sigma_{\\text{Compton}}(E^{+}) \\approx \\sigma_{\\text{Compton}}(E^{-})$。\n\n因此，总截面的变化量 $\\Delta \\sigma_{\\text{tot}} = \\sigma_{\\text{tot}}(E^{+}) - \\sigma_{\\text{tot}}(E^{-})$ 可以写为：\n$$\n\\Delta \\sigma_{\\text{tot}} = \\left(\\sigma_{\\text{pe}}(E^{+}) + \\sigma_{\\text{scatter}}(E^{+})\\right) - \\left(\\sigma_{\\text{pe}}(E^{-}) + \\sigma_{\\text{scatter}}(E^{-})\\right)\n$$\n其中 $\\sigma_{\\text{scatter}}(E) = \\sigma_{\\text{Rayleigh}}(E) + \\sigma_{\\text{Compton}}(E)$。考虑到散射截面的平滑性，$\\sigma_{\\text{scatter}}(E^{+}) - \\sigma_{\\text{scatter}}(E^{-}) \\approx 0$。因此，该变化仅仅归因于K吸收边上光电效应截面的急剧跳变：\n$$\n\\Delta \\sigma_{\\text{tot}} \\approx \\sigma_{\\text{pe}}(E^{+}) - \\sigma_{\\text{pe}}(E^{-})\n$$\n问题提供了紧邻K吸收边上方和下方的光电效应截面值，分别为 $\\sigma_{\\text{pe}}^{+} = \\sigma_{\\text{pe}}(E^{+})$ 和 $\\sigma_{\\text{pe}}^{-} = \\sigma_{\\text{pe}}(E^{-})$。结合这些发现，宏观衰减系数的变化量为：\n$$\n\\Delta \\Sigma = N \\left( \\sigma_{\\text{pe}}^{+} - \\sigma_{\\text{pe}}^{-} \\right) = \\frac{\\rho N_A}{M} \\left( \\sigma_{\\text{pe}}^{+} - \\sigma_{\\text{pe}}^{-} \\right)\n$$\n现在我们将给定的数值代入此表达式中。\n提供的数据如下：\n- 铅的质量密度，$\\rho = 11.34\\,\\mathrm{g}\\,\\mathrm{cm}^{-3}$。\n- 铅的摩尔质量， $M = 207.2\\,\\mathrm{g}\\,\\mathrm{mol}^{-1}$。\n- 阿伏伽德罗常数， $N_A = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$。\n- 在 $E_{}^{-} = 87.9\\,\\mathrm{keV}$ 处的微观光电效应截面， $\\sigma_{\\text{pe}}^{-} = 2.2 \\times 10^{-23}\\,\\mathrm{cm}^{2}$。\n- 在 $E_{}^{+} = 88.1\\,\\mathrm{keV}$ 处的微观光电效应截面， $\\sigma_{\\text{pe}}^{+} = 7.4 \\times 10^{-23}\\,\\mathrm{cm}^{2}$。\n\n首先，我们计算微观光电效应截面的变化量 $\\Delta \\sigma_{\\text{pe}}$：\n$$\n\\Delta \\sigma_{\\text{pe}} = \\sigma_{\\text{pe}}^{+} - \\sigma_{\\text{pe}}^{-} = (7.4 \\times 10^{-23}\\,\\mathrm{cm}^{2}) - (2.2 \\times 10^{-23}\\,\\mathrm{cm}^{2}) = 5.2 \\times 10^{-23}\\,\\mathrm{cm}^{2}\n$$\n接下来，我们计算铅的原子数密度 $N$：\n$$\nN = \\frac{\\rho N_A}{M} = \\frac{(11.34\\,\\mathrm{g}\\,\\mathrm{cm}^{-3}) (6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1})}{207.2\\,\\mathrm{g}\\,\\mathrm{mol}^{-1}} \\approx 3.29573 \\times 10^{22}\\,\\mathrm{cm}^{-3}\n$$\n最后，我们通过将原子数密度乘以微观截面的变化量来计算 $\\Delta \\Sigma$。单位为 $(\\mathrm{cm}^{-3}) \\times (\\mathrm{cm}^{2}) = \\mathrm{cm}^{-1}$，符合要求。\n$$\n\\Delta \\Sigma = N \\cdot \\Delta \\sigma_{\\text{pe}} \\approx (3.29573 \\times 10^{22}\\,\\mathrm{cm}^{-3}) \\times (5.2 \\times 10^{-23}\\,\\mathrm{cm}^{2})\n$$\n$$\n\\Delta \\Sigma \\approx 1.71378\\,\\mathrm{cm}^{-1}\n$$\n问题规定最终答案必须四舍五入到四位有效数字。\n$$\n\\Delta \\Sigma \\approx 1.714\\,\\mathrm{cm}^{-1}\n$$",
            "answer": "$$\\boxed{1.714}$$"
        },
        {
            "introduction": "伽马射线本身不直接加热材料；加热效应源于其产生的次级带电粒子（主要是电子）在介质中慢化时沉积的能量。因此，准确计算伽马加热的前提是理解这些次级电子的行为。本练习要求您计算由康普顿散射产生的能量最高的电子在不锈钢中的连续慢化近似（CSDA）射程，并基于此结果，从物理上判断在给定厚度的材料板中“带电粒子平衡”（CPE）这一关键假设是否成立。",
            "id": "4228849",
            "problem": "能量为 $E_{\\gamma} = 1.0\\,\\mathrm{MeV}$ 的单能伽马射线入射到一块不锈钢（304 型合金）平板上，其质量密度为 $\\rho = 7.9\\,\\mathrm{g/cm^3}$，厚度为 $L = 1.0\\,\\mathrm{mm}$。伽马加热主要由康普顿散射产生的带电次级粒子引起。从第一性原理出发，利用康普顿散射的能量-动量守恒，确定由 $1.0\\,\\mathrm{MeV}$ 伽马射线产生的康普顿电子的最大动能 $T_{\\max}$。然后，在连续慢化近似 (CSDA)下，将电子的 CSDA 质量厚度射程表示为质量阻止本领 $S(E)$ 的倒数从 $E=0$ 到 $E=T_{\\max}$ 的路径积分。为了获得定量估计，请使用以下在区间 $E \\in [0.01,\\,0.7966]\\,\\mathrm{MeV}$ 内不锈钢中电子的特定材料质量阻止本领数据：\n$(E_i,\\,S_i)$，其中 $E$ 的单位为 $\\mathrm{MeV}$，$S$ 的单位为 $\\mathrm{MeV\\,cm^2/g}$：\n$(0.01,\\,7.5)$; $(0.02,\\,6.5)$; $(0.05,\\,4.2)$; $(0.10,\\,3.2)$; $(0.20,\\,2.3)$; $(0.40,\\,1.85)$; $(0.60,\\,1.73)$; $(0.7966,\\,1.68)$。\n使用梯形法则，基于这些数据点近似计算最大能量康普顿电子的 CSDA 积分，以计算质量厚度射程 $R_{\\mathrm{mass}}$（单位为 $\\mathrm{g/cm^2}$），并使用密度 $\\rho$ 将其转换为几何射程 $R_{\\ell}$（单位为 $\\mathrm{mm}$）。根据计算出的射程，从物理角度讨论在整个 $1.0\\,\\mathrm{mm}$ 厚的板中，带电粒子平衡 (CPE) 是否预期成立，并阐明在伽马加热计算中边界附近电子逃逸的作用。报告 CSDA 几何射程 $R_{\\ell}$ 的最终值（单位为 $\\mathrm{mm}$），并将您的答案四舍五入到三位有效数字。",
            "solution": "**1. 康普顿电子的最大动能 ($T_{\\max}$)**\n\n在一次康普顿散射事件中，转移给反冲电子的动能 $T_e$ 是入射光子能量 $E_{\\gamma}$ 与散射光子能量 $E'_{\\gamma}$ 之差。根据康普顿散射的运动学，散射光子能量由下式给出：\n$$ E'_{\\gamma} = \\frac{E_{\\gamma}}{1 + \\alpha(1 - \\cos\\theta)} $$\n其中 $\\theta$ 是光子的散射角，$\\alpha$ 是以电子静止质量能为单位的入射光子能量，$\\alpha = E_{\\gamma} / (m_e c^2)$。电子静止质量能为 $m_e c^2 \\approx 0.511\\,\\mathrm{MeV}$。\n\n电子的动能为 $T_e = E_{\\gamma} - E'_{\\gamma}$。为了找到最大可能动能 $T_{\\max}$，我们必须找到最小可能散射光子能量 $E'_{\\gamma, \\min}$。当分母最大化时，$E'_{\\gamma}$ 的表达式最小化。这发生在散射角为 $\\theta = \\pi$（或 $180^\\circ$）时，此时 $\\cos\\theta = -1$。这代表光子被背向散射的正碰。\n\n代入 $\\cos\\theta = -1$ 得：\n$$ E'_{\\gamma, \\min} = \\frac{E_{\\gamma}}{1 + 2\\alpha} = \\frac{E_{\\gamma}}{1 + \\frac{2E_{\\gamma}}{m_e c^2}} $$\n因此，最大电子动能为：\n$$ T_{\\max} = E_{\\gamma} - E'_{\\gamma, \\min} = E_{\\gamma} - \\frac{E_{\\gamma}}{1 + \\frac{2E_{\\gamma}}{m_e c^2}} = E_{\\gamma} \\left( 1 - \\frac{1}{1 + \\frac{2E_{\\gamma}}{m_e c^2}} \\right) $$\n简化表达式得：\n$$ T_{\\max} = E_{\\gamma} \\left( \\frac{1 + \\frac{2E_{\\gamma}}{m_e c^2} - 1}{1 + \\frac{2E_{\\gamma}}{m_e c^2}} \\right) = \\frac{2E_{\\gamma}^2}{m_e c^2 + 2E_{\\gamma}} $$\n代入给定值 $E_{\\gamma} = 1.0\\,\\mathrm{MeV}$ 和 $m_e c^2 \\approx 0.511\\,\\mathrm{MeV}$：\n$$ T_{\\max} = \\frac{2(1.0\\,\\mathrm{MeV})^2}{0.511\\,\\mathrm{MeV} + 2(1.0\\,\\mathrm{MeV})} = \\frac{2.0}{2.511}\\,\\mathrm{MeV} \\approx 0.7965\\,\\mathrm{MeV} $$\n该值与所提供的阻止本领数据的上限 $E_8 = 0.7966\\,\\mathrm{MeV}$ 一致。我们将使用问题中给出的区间端点进行数值积分。\n\n**2. CSDA 质量厚度射程 ($R_{\\mathrm{mass}}$)**\n\n对于初始能量为 $T_{\\max}$ 的电子，其连续慢化近似 (CSDA) 质量厚度射程 $R_{\\mathrm{mass}}$ 由以下积分定义：\n$$ R_{\\mathrm{mass}} = \\int_{0}^{T_{\\max}} \\frac{1}{S(E)} dE $$\n其中 $S(E)$ 是质量阻止本领。问题提供了一组离散数据点 $(E_i, S_i)$，并要求使用梯形法则在给定区间上近似此积分。该积分近似为一系列梯形面积之和：\n$$ R_{\\mathrm{mass}} \\approx \\sum_{i=1}^{n-1} \\frac{1}{2} (E_{i+1} - E_i) \\left( \\frac{1}{S(E_{i+1})} + \\frac{1}{S(E_i)} \\right) $$\n提供的数据为：\n$E_1=0.01$, $S_1=7.5$; $E_2=0.02$, $S_2=6.5$; $E_3=0.05$, $S_3=4.2$; $E_4=0.10$, $S_4=3.2$; $E_5=0.20$, $S_5=2.3$; $E_6=0.40$, $S_6=1.85$; $E_7=0.60$, $S_7=1.73$; $E_8=0.7966$, $S_8=1.68$。\n$E$ 的单位是 $\\mathrm{MeV}$，$S$ 的单位是 $\\mathrm{MeV\\,cm^2/g}$。$R_{\\mathrm{mass}}$ 的所得单位是 $\\mathrm{g/cm^2}$。\n\n计算过程按区间逐一进行：\n\\begin{itemize}\n    \\item 区间 1 ($E_1 \\to E_2$): $\\frac{1}{2}(0.02 - 0.01)(\\frac{1}{7.5} + \\frac{1}{6.5}) \\approx 0.001436\\,\\mathrm{g/cm^2}$\n    \\item 区间 2 ($E_2 \\to E_3$): $\\frac{1}{2}(0.05 - 0.02)(\\frac{1}{6.5} + \\frac{1}{4.2}) \\approx 0.005879\\,\\mathrm{g/cm^2}$\n    \\item 区间 3 ($E_3 \\to E_4$): $\\frac{1}{2}(0.10 - 0.05)(\\frac{1}{4.2} + \\frac{1}{3.2}) \\approx 0.013765\\,\\mathrm{g/cm^2}$\n    \\item 区间 4 ($E_4 \\to E_5$): $\\frac{1}{2}(0.20 - 0.10)(\\frac{1}{3.2} + \\frac{1}{2.3}) \\approx 0.037364\\,\\mathrm{g/cm^2}$\n    \\item 区间 5 ($E_5 \\to E_6$): $\\frac{1}{2}(0.40 - 0.20)(\\frac{1}{2.3} + \\frac{1}{1.85}) \\approx 0.097532\\,\\mathrm{g/cm^2}$\n    \\item 区间 6 ($E_6 \\to E_7$): $\\frac{1}{2}(0.60 - 0.40)(\\frac{1}{1.85} + \\frac{1}{1.73}) \\approx 0.111858\\,\\mathrm{g/cm^2}$\n    \\item 区间 7 ($E_7 \\to E_8$): $\\frac{1}{2}(0.7966 - 0.60)(\\frac{1}{1.73} + \\frac{1}{1.68}) \\approx 0.115322\\,\\mathrm{g/cm^2}$\n\\end{itemize}\n将这些贡献相加，得到总的质量厚度射程：\n$$ R_{\\mathrm{mass}} \\approx 0.001436 + 0.005879 + 0.013765 + 0.037364 + 0.097532 + 0.111858 + 0.115322 $$\n$$ R_{\\mathrm{mass}} \\approx 0.383156\\,\\mathrm{g/cm^2} $$\n\n**3. 几何射程 ($R_{\\ell}$)**\n\n几何射程 $R_{\\ell}$ 通过材料的质量密度 $\\rho$ 与质量厚度射程 $R_{\\mathrm{mass}}$ 相关联：\n$$ R_{\\ell} = \\frac{R_{\\mathrm{mass}}}{\\rho} $$\n使用给定的密度 $\\rho = 7.9\\,\\mathrm{g/cm^3}$：\n$$ R_{\\ell} = \\frac{0.383156\\,\\mathrm{g/cm^2}}{7.9\\,\\mathrm{g/cm^3}} \\approx 0.048501\\,\\mathrm{cm} $$\n问题要求答案以毫米（$\\mathrm{mm}$）为单位。由于 $1\\,\\mathrm{cm} = 10\\,\\mathrm{mm}$：\n$$ R_{\\ell} \\approx 0.048501\\,\\mathrm{cm} \\times \\frac{10\\,\\mathrm{mm}}{1\\,\\mathrm{cm}} \\approx 0.48501\\,\\mathrm{mm} $$\n四舍五入到三位有效数字，几何射程为 $R_{\\ell} \\approx 0.485\\,\\mathrm{mm}$。\n\n**4. 关于带电粒子平衡 (CPE) 的讨论**\n\n带电粒子平衡 (CPE) 是存在于被不带电粒子（如光子）辐照的介质内某一点的一种条件，前提是在围绕该点的整个区域内，次级带电粒子（电子）的通量是均匀的，且该区域的半径至少等于次级粒子的最大射程。在实践中，这意味着对于离开一个小体积的每一个带电粒子，都有另一个相同类型和能量的带电粒子进入它。这个条件允许简化，即吸收剂量等于比释动能。\n\n要建立 CPE，被辐照的介质必须是有效无限的均匀介质。对于厚度为 $L$ 的有限平板，如果板的厚度远大于次级电子的最大射程，即 $L \\gg R_{\\ell}$，则可以认为 CPE 在中心区域近似成立。\n\n在本问题中，板厚为 $L = 1.0\\,\\mathrm{mm}$，计算出的最大电子射程为 $R_{\\ell} \\approx 0.485\\,\\mathrm{mm}$。\n我们必须比较 $L$ 和 $R_{\\ell}$。这里，厚度 $L$ 约等于 $2R_{\\ell}$。这不足以满足条件 $L \\gg R_{\\ell}$。因此，预期 CPE 不会在整个板中成立。\n\n具体来说，CPE 在边界附近失效：\n\\begin{itemize}\n    \\item **入射表面 ($z=0$):** 在伽马射线入射处，距表面约 $R_{\\ell}$ 的深度内，存在一个“剂量建成”区。电子被驱动向前运动，但上游（$z<0$）没有物质产生能够进入该区域以建立平衡的电子。沉积能量随深度增加，直到在与 $R_{\\ell}$ 相当的深度处达到瞬态平衡。\n    \\item **出射表面 ($z=L$):** 在距出射表面约 $R_{\\ell}$ 的距离内，产生的电子可以逃逸出板。下游（$z>L$）没有物质产生能够散射回该区域的电子。这种前向运动电子的损失没有被背向散射的电子补偿，导致随着接近出射表面，沉积能量下降。\n\\end{itemize}\n因为板厚（$1.0\\,\\mathrm{mm}$）仅约为最大电子射程（$0.485\\,\\mathrm{mm}$）的两倍，前端的建成区和后端的衰减区实际上跨越了整个板厚。没有显著的中心区域可以认为 CPE 已经建立。在伽马加热计算中未能考虑边界附近的电子逃逸，将导致对能量沉积剖面的不正确估计，通常会因假设其等于局部比释动能而高估表面的剂量。\n\n需要报告的值是 CSDA 几何射程 $R_{\\ell}$，四舍五入到三位有效数字。\n$R_{\\ell} = 0.485\\,\\mathrm{mm}$。",
            "answer": "$$\n\\boxed{0.485}\n$$"
        },
        {
            "introduction": "当伽马光子能量足够高（$E_{\\gamma} \\gt 1.022\\,\\mathrm{MeV}$）时，对产生效应成为重要的能量沉积机制，其能量沉积过程也更为复杂。与光电效应或康普顿散射不同，对产生不仅将部分能量赋予正负电子对（局部沉积），还会通过正电子湮灭产生两个新的光子，这些次级光子会将能量输运至别处。本练习旨在模拟这一完整的物理图像，您需要计算在考虑了次级湮灭光子输运和泄漏效应后，对产生效应对材料内部体积热率的平均贡献。",
            "id": "4228895",
            "problem": "考虑在一块厚度为 $T$ 米、垂直于入射束的无限大钢板中的一维伽马输运和能量沉积。能量为 $E_{\\gamma} = 10$ MeV 的单能光子通量以每平方米每秒 $\\phi_{0}$ 个光子的未碰撞标量通量，正入射到位于 $x = 0$ 的前表面。令 $x$ 表示射入板内的深度。\n\n假设光子在密度为 $\\rho$、能量为 $E_{\\gamma}$ 时的宏观总截面为 $\\Sigma_{t}$ 的均匀材料中，根据比尔-朗伯定律发生衰减，因此未碰撞通量为 $\\phi(x) = \\phi_{0} e^{-\\Sigma_{t} x}$。令 $\\Sigma_{\\text{pp}}$ 为能量 $E_{\\gamma}$ 时的电子对生成宏观截面，令 $\\Sigma_{511}$ 为同一材料中 511 keV 光子的宏观总截面。电子对生成反应率密度为 $R_{\\text{pp}}(x) = \\Sigma_{\\text{pp}} \\phi(x)$。\n\n对于每个电子对生成事件，将电子和正电子的动能视为在产生点局部沉积。可供带电粒子使用的动能为 $E_{\\text{ch}} = E_{\\gamma} - 2 m_{e} c^{2}$，其中 $m_{e} c^{2} = 0.511$ MeV 是电子的静止能量。正电子最终与一个电子湮灭，在湮灭点产生两个 511 keV 的光子，这些光子各向同性地发射，并假定湮灭点与电子对生成位置重合。向下游传播的湮灭光子以宏观截面 $\\Sigma_{511}$ 进行衰减，并且任何相互作用最终都假定将其能量以热量的形式沉积在板内。忽略带电粒子的逃逸和扩散，并忽略次级韧致辐射。\n\n令 $s$ 为从湮灭点沿给定方向到板边界的直线路径长度。对于一个湮灭光子，其能量沿该方向在板内被吸收的概率是 $1 - e^{-\\Sigma_{511} s}$。使用各向同性的发射角分布，对于深度为 $x$ 的源，一个湮灭光子的能量在板内被吸收的分数是 $1 - e^{-\\Sigma_{511} s}$ 在所有发射方向上的方向平均值。定义方向余弦 $\\mu = \\cos\\theta$，相对于板法线。对于 $\\mu \\in (0,1]$，光子向后表面传播，路径长度为 $s = (T - x)/\\mu$。对于 $\\mu \\in [-1,0)$，光子向前表面传播，路径长度为 $s = x/|\\mu|$。角分布是各向同性的，因此 $\\mu$ 在 $[-1,1]$ 上均匀分布，密度为 $1/2$。\n\n在深度 $x$ 处，由电子对生成（包括湮灭光子输运）引起的体积生热率密度是局部带电粒子能量沉积与来自两个湮灭光子的预期吸收能量之和：\n$$\nq_{\\text{pp}}(x) = R_{\\text{pp}}(x)\\left[E_{\\text{ch}} + 2 E_{a} f_{\\text{abs}}(x)\\right],\n$$\n其中 $E_{a} = 0.511$ MeV 是每个湮灭光子的能量，$f_{\\text{abs}}(x)$ 是对于深度为 $x$ 的源，一个湮灭光子能量在板内被吸收的各向同性方向平均分数。\n\n您必须计算由电子对生成引起的板平均体积生热率，\n$$\n\\overline{q}_{\\text{pp}} = \\frac{1}{T} \\int_{0}^{T} q_{\\text{pp}}(x)\\,dx,\n$$\n以瓦特每立方米为单位表示，四舍五入并以包含六位有效数字的科学记数法格式化。\n\n使用以下对钢的科学上合理的材料属性，将其视为密度为 $\\rho = 7850$ kg/m$^{3}$ 的均匀材料：\n- 在 $E_{\\gamma} = 10$ MeV 时总相互作用的质量衰减系数：$(\\mu/\\rho)_{t,10\\ \\text{MeV}} = 0.055$ cm$^{2}$/g。\n- 在 $E_{\\gamma} = 10$ MeV 时电子对生成的质量衰减系数：$(\\mu/\\rho)_{\\text{pp},10\\ \\text{MeV}} = 0.025$ cm$^{2}$/g。\n- 在 $E_{a} = 0.511$ MeV 时总相互作用的质量衰减系数：$(\\mu/\\rho)_{t,511\\ \\text{keV}} = 0.080$ cm$^{2}$/g。\n\n通过 $\\Sigma = (\\mu/\\rho)\\,\\rho$ 将质量衰减系数转换为宏观截面，其中 $1$ cm$^{2}$/g $= 0.1$ m$^{2}$/kg。使用 $1$ eV $= 1.602176634\\times 10^{-19}$ J 进行能量转换。\n\n从比尔-朗伯定律、宏观截面的定义、各向同性发射和能量守恒出发，通过对方向余弦 $\\mu$ 积分，推导并实现湮灭光子吸收的角平均值 $f_{\\text{abs}}(x)$。您可以明确表示任何所需的特殊函数并对其进行数值计算。\n\n您的程序必须实现上述模型，并为以下测试套件生成数值结果，每个案例由入射通量 $\\phi_{0}$（单位：光子/平方米/秒）和板厚 $T$（单位：米）指定：\n- 案例 1 (典型厚度): $\\phi_{0} = 1.0\\times 10^{16}$, $T = 0.020$。\n- 案例 2 (中等厚度板): $\\phi_{0} = 5.0\\times 10^{15}$, $T = 0.100$。\n- 案例 3 (非常薄的板): $\\phi_{0} = 1.0\\times 10^{16}$, $T = 0.00050$。\n- 案例 4 (厚板，较低通量): $\\phi_{0} = 1.0\\times 10^{14}$, $T = 0.300$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，包含四个案例的板平均体积生热率，以瓦特每立方米为单位，并以六位有效数字的科学记数法格式化，作为一个用方括号括起来的逗号分隔列表（例如，“[1.23456e+08,2.34567e+07,3.45678e+06,4.56789e+05]”）。",
            "solution": "该问题要求计算由入射伽马射线束引起的电子对生成事件所导致的板平均体积生热率。解决方案包括几个步骤：计算材料属性、推导湮灭光子的吸收分数、建立生热率方程以及执行数值积分。\n\n**步骤1：计算宏观截面和能量常数**\n\n问题中提供的材料属性使用了非国际单位制，必须进行转换。宏观截面 $\\Sigma$（单位 m$^{-1}$）与质量衰减系数 $\\mu/\\rho$（单位 m$^2$/kg）和材料密度 $\\rho$（单位 kg/m$^3$）通过公式 $\\Sigma = (\\mu/\\rho) \\rho$ 相关联。\n\n给定的质量衰减系数单位为 cm$^2$/g。转换因子为 $1 \\text{ cm}^2/\\text{g} = 0.1 \\text{ m}^2/\\text{kg}$。钢的密度为 $\\rho = 7850 \\text{ kg/m}^3$。\n\n1.  **在 $E_{\\gamma} = 10$ MeV 时的宏观总截面 ($\\Sigma_t$)**:\n    质量衰减系数为 $(\\mu/\\rho)_{t,10\\ \\text{MeV}} = 0.055 \\text{ cm}^2/\\text{g} = 0.0055 \\text{ m}^2/\\text{kg}$。\n    $$ \\Sigma_t = (0.0055 \\text{ m}^2/\\text{kg}) \\times (7850 \\text{ kg/m}^3) = 43.175 \\text{ m}^{-1} $$\n\n2.  **在 $E_{\\gamma} = 10$ MeV 时的宏观电子对生成截面 ($\\Sigma_{\\text{pp}}$)**:\n    质量衰减系数为 $(\\mu/\\rho)_{\\text{pp},10\\ \\text{MeV}} = 0.025 \\text{ cm}^2/\\text{g} = 0.0025 \\text{ m}^2/\\text{kg}$。\n    $$ \\Sigma_{\\text{pp}} = (0.0025 \\text{ m}^2/\\text{kg}) \\times (7850 \\text{ kg/m}^3) = 19.625 \\text{ m}^{-1} $$\n\n3.  **在 $E_a = 511$ keV 时的宏观总截面 ($\\Sigma_{511}$)**:\n    质量衰减系数为 $(\\mu/\\rho)_{t,511\\ \\text{keV}} = 0.080 \\text{ cm}^2/\\text{g} = 0.0080 \\text{ m}^2/\\text{kg}$。\n    $$ \\Sigma_{511} = (0.0080 \\text{ m}^2/\\text{kg}) \\times (7850 \\text{ kg/m}^3) = 62.8 \\text{ m}^{-1} $$\n\n为了最终计算生热率（单位 W/m$^3$），能量必须从 MeV 转换为焦耳。转换关系为 $1 \\text{ MeV} = 1.602176634 \\times 10^{-13} \\text{ J}$。\n\n*   带电粒子动能 ($E_{\\text{ch}}$):\n    $E_{\\text{ch}} = E_{\\gamma} - 2 m_e c^2 = 10 \\text{ MeV} - 2 \\times 0.511 \\text{ MeV} = 8.978 \\text{ MeV}$。\n    $$ E_{\\text{ch, J}} = 8.978 \\times 1.602176634 \\times 10^{-13} \\text{ J} \\approx 1.4384 \\times 10^{-12} \\text{ J} $$\n*   湮灭光子能量 ($E_a$):\n    $E_a = 0.511 \\text{ MeV}$。\n    $$ E_{\\text{a, J}} = 0.511 \\times 1.602176634 \\times 10^{-13} \\text{ J} \\approx 8.1871 \\times 10^{-14} \\text{ J} $$\n\n**步骤2：推导湮灭光子吸收分数 $f_{\\text{abs}}(x)$**\n\n函数 $f_{\\text{abs}}(x)$ 表示在深度 $x$ 处各向同性发射的单个 511 keV 光子能量在板内被吸收的分数。对于路径长度 $s$，吸收概率为 $1 - e^{-\\Sigma_{511} s}$。我们必须对所有可能的方向求平均。\n方向由与板法线的夹角余弦 $\\mu = \\cos\\theta$ 指定。对于各向同性源，$\\mu$ 的概率分布在 $[-1, 1]$ 上是均匀的，即 $p(\\mu) = 1/2$。\n\n路径长度 $s$ 取决于 $\\mu$：\n*   对于 $\\mu \\in (0, 1]$ (前向)，到 $x=T$ 处后边界的距离是 $T-x$。路径长度是 $s = (T-x)/\\mu$。\n*   对于 $\\mu \\in [-1, 0)$ (后向)，到 $x=0$ 处前边界的距离是 $x$。路径长度是 $s = x/|\\mu| = x/(-\\mu)$。\n\n平均吸收分数为对所有方向的积分：\n$$ f_{\\text{abs}}(x) = \\int_{-1}^{1} \\left(1 - e^{-\\Sigma_{511} s(\\mu)}\\right) p(\\mu) \\,d\\mu = \\frac{1}{2} \\int_{-1}^{1} \\left(1 - e^{-\\Sigma_{511} s(\\mu)}\\right) \\,d\\mu $$\n我们将积分分成两部分：\n$$ f_{\\text{abs}}(x) = \\frac{1}{2} \\left[ \\int_{-1}^{0} \\left(1 - e^{-\\Sigma_{511} x/(-\\mu)}\\right) \\,d\\mu + \\int_{0}^{1} \\left(1 - e^{-\\Sigma_{511} (T-x)/\\mu}\\right) \\,d\\mu \\right] $$\n这可以简化为：\n$$ f_{\\text{abs}}(x) = 1 - \\frac{1}{2} \\left[ \\int_{-1}^{0} e^{\\Sigma_{511} x/\\mu} \\,d\\mu + \\int_{0}^{1} e^{-\\Sigma_{511} (T-x)/\\mu} \\,d\\mu \\right] $$\n让我们分析这两个积分。第二个积分的形式为 $\\int_{0}^{1} e^{-A/\\mu} \\,d\\mu$。通过换元 $t = 1/\\mu$，我们得到 $d\\mu = -1/t^2 \\,dt$。积分限从 $(0, 1)$ 变为 $(\\infty, 1)$。\n$$ \\int_{\\infty}^{1} e^{-At} \\left(-\\frac{1}{t^2}\\right) \\,dt = \\int_{1}^{\\infty} \\frac{e^{-At}}{t^2} \\,dt $$\n这是二阶指数积分函数 $E_2(A)$ 的定义。因此，$\\int_{0}^{1} e^{-A/\\mu} \\,d\\mu = E_2(A)$。\n第一个积分 $\\int_{-1}^{0} e^{\\Sigma_{511} x/\\mu} \\,d\\mu$，可以通过令 $\\mu' = -\\mu$ 进行变换，得到 $\\int_{0}^{1} e^{-\\Sigma_{511} x/\\mu'} \\,d\\mu'$，即 $E_2(\\Sigma_{511}x)$。\n\n因此，吸收分数为：\n$$ f_{\\text{abs}}(x) = 1 - \\frac{1}{2} \\left[ E_2(\\Sigma_{511} x) + E_2(\\Sigma_{511} (T-x)) \\right] $$\n函数 $E_n(z) = \\int_1^\\infty t^{-n} e^{-zt} \\,dt$ 是一个标准的特殊函数，可在 `scipy.special.expn` 等数值库中找到。\n\n**步骤3：建立板平均生热率 $\\overline{q}_{\\text{pp}}$ 的公式**\n\n深度 $x$ 处的体积生热率密度由下式给出：\n$$ q_{\\text{pp}}(x) = R_{\\text{pp}}(x) \\left[ E_{\\text{ch}} + 2 E_{a} f_{\\text{abs}}(x) \\right] $$\n电子对生成反应率密度为 $R_{\\text{pp}}(x) = \\Sigma_{\\text{pp}} \\phi(x)$，其中深度 $x$ 处的未碰撞通量为 $\\phi(x) = \\phi_0 e^{-\\Sigma_t x}$。将这些代入 $q_{\\text{pp}}(x)$ 的表达式中：\n$$ q_{\\text{pp}}(x) = \\Sigma_{\\text{pp}} \\phi_0 e^{-\\Sigma_t x} \\left[ E_{\\text{ch}} + 2 E_{a} \\left(1 - \\frac{1}{2} \\left[ E_2(\\Sigma_{511} x) + E_2(\\Sigma_{511} (T-x)) \\right]\\right) \\right] $$\n所有能量（$E_{\\text{ch}}$, $E_{a}$）必须以焦耳为单位，才能得到以 W/m$^3$ 为单位的生热率。\n\n板平均体积生热率是 $q_{\\text{pp}}(x)$ 在板厚 $T$ 上的积分，再除以 $T$：\n$$ \\overline{q}_{\\text{pp}} = \\frac{1}{T} \\int_{0}^{T} q_{\\text{pp}}(x) \\,dx $$\n由于指数积分函数的存在，该积分没有简单的封闭形式解析解，必须进行数值计算。积分的完整表达式为：\n$$ \\overline{q}_{\\text{pp}} = \\frac{\\Sigma_{\\text{pp}} \\phi_0}{T} \\int_{0}^{T} e^{-\\Sigma_t x} \\left[ E_{\\text{ch, J}} + 2 E_{\\text{a, J}} \\left(1 - \\frac{1}{2} \\left[ E_2(\\Sigma_{511} x) + E_2(\\Sigma_{511} (T-x)) \\right]\\right) \\right] \\,dx $$\n\n**步骤4：数值评估**\n\n每个测试案例的步骤如下：\n1.  定义输入参数 $\\phi_0$ 和 $T$。\n2.  使用预先计算的常数 $\\Sigma_t$、$\\Sigma_{\\text{pp}}$、$\\Sigma_{511}$、$E_{\\text{ch, J}}$ 和 $E_{\\text{a, J}}$。\n3.  定义被积函数 `integrand(x)`，该函数使用上述公式计算 $q_{\\text{pp}}(x)$，并数值计算 $E_2(z)$。\n4.  使用数值求积程序（例如 `scipy.integrate.quad`）计算定积分 $\\int_{0}^{T} \\text{integrand}(x) \\,dx$。\n5.  将积分结果除以板厚 $T$，得到 $\\overline{q}_{\\text{pp}}$。\n6.  以指定的精度将最终结果格式化为科学记数法。\n\n此过程在提供的 Python 代码中实现，该代码遍历四个测试案例并计算相应的平均生热率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import expn\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the slab-averaged volumetric heating rate due to pair production\n    for several test cases.\n    \"\"\"\n    \n    # --- Scientific and Conversion Constants ---\n    # Energy in MeV\n    E_GAMMA_MEV = 10.0\n    E_ANNIHIL_MEV = 0.511\n    MEC2_MEV = 0.511\n    E_CH_MEV = E_GAMMA_MEV - 2.0 * MEC2_MEV\n    \n    # Conversion factors\n    EV_TO_J = 1.602176634e-19\n    MEV_TO_J = 1e6 * EV_TO_J\n    CM2_G_TO_M2_KG = 0.1\n\n    # Energies in Joules\n    E_CH_J = E_CH_MEV * MEV_TO_J\n    E_A_J = E_ANNIHIL_MEV * MEV_TO_J\n    \n    # --- Material Properties for Steel ---\n    RHO_STEEL_KG_M3 = 7850.0  # kg/m^3\n    \n    # Mass attenuation coefficients in cm^2/g\n    MU_RHO_T_10MEV_CM2G = 0.055\n    MU_RHO_PP_10MEV_CM2G = 0.025\n    MU_RHO_T_511KEV_CM2G = 0.080\n    \n    # --- Macroscopic Cross Sections (m^-1) ---\n    # Convert mass atten. coeff. to m^2/kg\n    mu_rho_t_10mev = MU_RHO_T_10MEV_CM2G * CM2_G_TO_M2_KG\n    mu_rho_pp_10mev = MU_RHO_PP_10MEV_CM2G * CM2_G_TO_M2_KG\n    mu_rho_t_511kev = MU_RHO_T_511KEV_CM2G * CM2_G_TO_M2_KG\n    \n    # Calculate macroscopic cross sections\n    SIGMA_T = mu_rho_t_10mev * RHO_STEEL_KG_M3\n    SIGMA_PP = mu_rho_pp_10mev * RHO_STEEL_KG_M3\n    SIGMA_511 = mu_rho_t_511kev * RHO_STEEL_KG_M3\n\n    # Store constants for easy passing\n    constants = {\n        'Sigma_t': SIGMA_T,\n        'Sigma_pp': SIGMA_PP,\n        'Sigma_511': SIGMA_511,\n        'E_ch_J': E_CH_J,\n        'E_a_J': E_A_J\n    }\n\n    # --- Absorption Fraction Function ---\n    def f_abs(x, T, Sigma_511):\n        \"\"\"\n        Calculates the isotropic-direction average fraction of one annihilation \n        photon's energy absorbed within the slab for a source at depth x.\n        f_abs(x) = 1 - 0.5 * [E2(Sigma_511*x) + E2(Sigma_511*(T-x))]\n        \"\"\"\n        arg1 = Sigma_511 * x\n        arg2 = Sigma_511 * (T - x)\n        \n        # Use scipy's generalized exponential integral function E_n(z)\n        e2_1 = expn(2, arg1)\n        e2_2 = expn(2, arg2)\n        \n        return 1.0 - 0.5 * (e2_1 + e2_2)\n\n    # --- Volumetric Heating Rate Density Function ---\n    def heating_rate_density(x, phi_0, T, consts):\n        \"\"\"\n        Calculates the volumetric heating rate density q_pp(x) at depth x.\n        q_pp(x) = R_pp(x) * [E_ch + 2 * E_a * f_abs(x)]\n        \"\"\"\n        # Unpack constants\n        Sigma_t = consts['Sigma_t']\n        Sigma_pp = consts['Sigma_pp']\n        Sigma_511 = consts['Sigma_511']\n        E_ch_J = consts['E_ch_J']\n        E_a_J = consts['E_a_J']\n\n        # Uncollided flux at depth x\n        phi_x = phi_0 * np.exp(-Sigma_t * x)\n        \n        # Pair production reaction rate density\n        R_pp_x = Sigma_pp * phi_x\n        \n        # Annihilation photon absorption fraction\n        f_abs_val = f_abs(x, T, Sigma_511)\n        \n        # Total heating rate density at x in W/m^3\n        q_pp_x = R_pp_x * (E_ch_J + 2.0 * E_a_J * f_abs_val)\n        \n        return q_pp_x\n        \n    # --- Test Cases ---\n    test_cases = [\n        # (phi_0 [photons/m^2/s], T [m])\n        (1.0e16, 0.020),    # Case 1\n        (5.0e15, 0.100),    # Case 2\n        (1.0e16, 0.00050),  # Case 3\n        (1.0e14, 0.300),    # Case 4\n    ]\n\n    results = []\n    for phi_0, T in test_cases:\n        # Define the integrand for the current case\n        integrand = lambda x: heating_rate_density(x, phi_0, T, constants)\n        \n        # Numerically integrate q_pp(x) over [0, T] to get total heating power per unit area (W/m^2)\n        total_heating_power_per_area, _ = quad(integrand, 0, T, epsabs=1.0e-12, epsrel=1.0e-12)\n        \n        # Average over the slab thickness T to get the slab-averaged heating rate (W/m^3)\n        # Handle T=0 case although not in test suite.\n        if T > 0:\n            avg_heating_rate = total_heating_power_per_area / T\n        else:\n            avg_heating_rate = 0.0\n            \n        results.append(avg_heating_rate)\n\n    # Format output as specified: scientific notation with six significant figures (1.ddddd)\n    formatted_results = [f\"{res:.5e}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}