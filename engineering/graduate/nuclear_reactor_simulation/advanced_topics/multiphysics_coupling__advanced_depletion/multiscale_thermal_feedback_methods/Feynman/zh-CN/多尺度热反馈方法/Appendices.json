{
    "hands_on_practices": [
        {
            "introduction": "要理解热反馈，首先需要量化其主要组成部分。在热中子反应堆中，多普勒系数是最重要的瞬发负反馈机制，对反应堆的固有安全性至关重要。本练习提供了一种具体的方法，通过将微观核数据（截面温度敏感性）与宏观安全参数（多普勒系数）联系起来，为更复杂的耦合模型奠定物理基础。通过这个计算，您将亲身体会到温度变化如何通过共振吸收效应直接影响反应堆的增殖能力。",
            "id": "4237400",
            "problem": "一个典型的无限栅格燃料棒单元采用单群、均匀化模型进行描述。假设中子泄漏可以忽略不计。在基准燃料温度 $T_{f,0}$ 下，宏观单群参数如下：\n- 燃料吸收截面 $\\Sigma_{a,f,0} = 0.06 \\ \\mathrm{cm^{-1}}$，\n- 慢化剂吸收截面 $\\Sigma_{a,m,0} = 0.02 \\ \\mathrm{cm^{-1}}$，\n- 中子产生截面 $\\nu \\Sigma_{f,0} = 0.12 \\ \\mathrm{cm^{-1}}$。\n\n在 $T_{f,0}$ 附近的小范围燃料温度变化中，唯一不可忽略的温度依赖性由以下线性灵敏度给出：\n- $\\dfrac{\\partial \\Sigma_{a,f}}{\\partial T_f}\\bigg|_{T_{f,0}} = 6.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}$，\n- $\\dfrac{\\partial (\\nu \\Sigma_f)}{\\partial T_f}\\bigg|_{T_{f,0}} = -2.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}$，\n\n并且您可以忽略慢化剂截面和散射对燃料温度的依赖性。使用无限增殖因子 $k_{\\infty}$ 的单群定义，\n$$\nk_{\\infty} = \\frac{\\nu \\Sigma_f}{\\Sigma_a}, \\quad \\Sigma_a = \\Sigma_{a,f} + \\Sigma_{a,m},\n$$\n以及反应性 $\\rho$ 的定义，\n$$\n\\rho = \\frac{k - 1}{k}.\n$$\n\n首先，计算当燃料温度从 $T_{f,0}$ 增加 $\\Delta T = +100 \\ \\mathrm{K}$ 时无限增殖因子 $\\Delta k_{\\infty}$ 的变化量，将温度响应视为在 $T_{f,0}$ 附近的线性响应。然后，利用这个线性化的结果来确定燃料棒多普勒系数 $\\alpha_D = \\dfrac{d\\rho}{dT_f}\\big|_{T_{f,0}}$。将 $\\alpha_D$ 的最终值以 $1/\\mathrm{K}$ 为单位表示，并将您的答案四舍五入到三位有效数字。仅报告 $\\alpha_D$ 的值作为最终答案。",
            "solution": "该问题已经过验证，被认为是科学上合理的、适定的和客观的。它提出了一个基于既定原理的核反应堆物理学中的标准问题。所有必要的数据和定义都已提供，并且没有内部矛盾。\n\n目标是确定均匀化无限栅格燃料棒单元的多普勒系数 $\\alpha_D$。该分析基于单群中子学模型，其中燃料截面具有指定的线性温度灵敏度。\n\n无限增殖因子 $k_{\\infty}$ 定义为：\n$$\nk_{\\infty} = \\frac{\\nu \\Sigma_f}{\\Sigma_a}\n$$\n其中 $\\nu \\Sigma_f$ 是宏观中子产生截面，$\\Sigma_a$ 是总的宏观吸收截面。总吸收是燃料吸收 $\\Sigma_{a,f}$ 和慢化剂吸收 $\\Sigma_{a,m}$ 的和：\n$$\n\\Sigma_a = \\Sigma_{a,f} + \\Sigma_{a,m}\n$$\n反应性 $\\rho$ 根据增殖因子 $k$ 定义为：\n$$\n\\rho = \\frac{k - 1}{k}\n$$\n对于泄漏可忽略的无限栅格，增殖因子为 $k = k_{\\infty}$。\n\n首先，我们确定在基准燃料温度 $T_{f,0}$ 下的反应堆状态。给定的参数是：\n- 燃料吸收截面：$\\Sigma_{a,f,0} = 0.06 \\ \\mathrm{cm^{-1}}$\n- 慢化剂吸收截面：$\\Sigma_{a,m,0} = 0.02 \\ \\mathrm{cm^{-1}}$\n- 中子产生截面：$\\nu \\Sigma_{f,0} = 0.12 \\ \\mathrm{cm^{-1}}$\n\n在基准温度下的总吸收截面是：\n$$\n\\Sigma_{a,0} = \\Sigma_{a,f,0} + \\Sigma_{a,m,0} = 0.06 \\ \\mathrm{cm^{-1}} + 0.02 \\ \\mathrm{cm^{-1}} = 0.08 \\ \\mathrm{cm^{-1}}\n$$\n在基准温度下的无限增殖因子是：\n$$\nk_{\\infty,0} = \\frac{\\nu \\Sigma_{f,0}}{\\Sigma_{a,0}} = \\frac{0.12 \\ \\mathrm{cm^{-1}}}{0.08 \\ \\mathrm{cm^{-1}}} = 1.5\n$$\n\n第一个任务是计算当燃料温度增加 $\\Delta T_f = +100 \\ \\mathrm{K}$ 时，无限增殖因子 $\\Delta k_{\\infty}$ 的变化量。问题说明将响应视为线性的。温度灵敏度为：\n- $\\dfrac{\\partial \\Sigma_{a,f}}{\\partial T_f}\\bigg|_{T_{f,0}} = 6.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}$\n- $\\dfrac{\\partial (\\nu \\Sigma_f)}{\\partial T_f}\\bigg|_{T_{f,0}} = -2.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}$\n\n使用一阶泰勒展开，截面的变化量为：\n$$\n\\Delta \\Sigma_{a,f} = \\left(\\dfrac{\\partial \\Sigma_{a,f}}{\\partial T_f}\\bigg|_{T_{f,0}}\\right) \\Delta T_f = (6.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}) \\times (100 \\ \\mathrm{K}) = 6.0 \\times 10^{-4} \\ \\mathrm{cm^{-1}}\n$$\n$$\n\\Delta (\\nu \\Sigma_f) = \\left(\\dfrac{\\partial (\\nu \\Sigma_f)}{\\partial T_f}\\bigg|_{T_{f,0}}\\right) \\Delta T_f = (-2.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}) \\times (100 \\ \\mathrm{K}) = -2.0 \\times 10^{-4} \\ \\mathrm{cm^{-1}}\n$$\n在温度 $T_{f,0} + \\Delta T_f$ 下的新截面为：\n$$\n\\Sigma_{a,f,1} = \\Sigma_{a,f,0} + \\Delta \\Sigma_{a,f} = 0.06 + 0.0006 = 0.0606 \\ \\mathrm{cm^{-1}}\n$$\n$$\n(\\nu \\Sigma_f)_1 = \\nu \\Sigma_{f,0} + \\Delta (\\nu \\Sigma_f) = 0.12 - 0.0002 = 0.1198 \\ \\mathrm{cm^{-1}}\n$$\n假设慢化剂截面是恒定的，所以 $\\Sigma_{a,m,1} = \\Sigma_{a,m,0}$。新的总吸收截面是：\n$$\n\\Sigma_{a,1} = \\Sigma_{a,f,1} + \\Sigma_{a,m,0} = 0.0606 + 0.02 = 0.0806 \\ \\mathrm{cm^{-1}}\n$$\n新的无限增殖因子是：\n$$\nk_{\\infty,1} = \\frac{(\\nu \\Sigma_f)_1}{\\Sigma_{a,1}} = \\frac{0.1198 \\ \\mathrm{cm^{-1}}}{0.0806 \\ \\mathrm{cm^{-1}}} \\approx 1.48635\n$$\n增殖因子的变化量是：\n$$\n\\Delta k_{\\infty} = k_{\\infty,1} - k_{\\infty,0} \\approx 1.48635 - 1.5 = -0.01365\n$$\n\n第二个任务是确定燃料棒多普勒系数 $\\alpha_D$，定义为反应性对燃料温度的导数，并在基准温度 $T_{f,0}$ 下求值：\n$$\n\\alpha_D = \\dfrac{d\\rho}{dT_f}\\bigg|_{T_{f,0}}\n$$\n首先，我们用增殖因子 $k_{\\infty}$ 来表示反应性的导数：\n$$\n\\rho = 1 - \\frac{1}{k_{\\infty}} \\quad \\implies \\quad \\frac{d\\rho}{dT_f} = \\frac{d}{dT_f}\\left(1 - \\frac{1}{k_{\\infty}}\\right) = \\frac{1}{k_{\\infty}^2} \\frac{dk_{\\infty}}{dT_f}\n$$\n因此，多普勒系数是：\n$$\n\\alpha_D = \\frac{1}{k_{\\infty,0}^2} \\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}}\n$$\n我们现在必须求出 $k_{\\infty}$ 对 $T_f$ 的解析导数。对 $k_{\\infty}$ 的定义使用商法则：\n$$\n\\frac{dk_{\\infty}}{dT_f} = \\frac{ \\left(\\frac{\\partial(\\nu \\Sigma_f)}{\\partial T_f}\\right) \\Sigma_a - (\\nu \\Sigma_f) \\left(\\frac{\\partial \\Sigma_a}{\\partial T_f}\\right) }{ \\Sigma_a^2 }\n$$\n总吸收的导数是 $\\frac{\\partial \\Sigma_a}{\\partial T_f} = \\frac{\\partial \\Sigma_{a,f}}{\\partial T_f} + \\frac{\\partial \\Sigma_{a,m}}{\\partial T_f}$。由于慢化剂截面对燃料温度的依赖性可以忽略不计，所以 $\\frac{\\partial \\Sigma_{a,m}}{\\partial T_f} = 0$。因此，$\\frac{\\partial \\Sigma_a}{\\partial T_f} = \\frac{\\partial \\Sigma_{a,f}}{\\partial T_f}$。\n\n在 $T_{f,0}$ 处计算导数：\n$$\n\\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}} = \\frac{ \\left(\\frac{\\partial(\\nu \\Sigma_f)}{\\partial T_f}\\bigg|_{T_{f,0}}\\right) \\Sigma_{a,0} - (\\nu \\Sigma_f)_0 \\left(\\frac{\\partial \\Sigma_{a,f}}{\\partial T_f}\\bigg|_{T_{f,0}}\\right) }{ (\\Sigma_{a,0})^2 }\n$$\n代入给定值：\n$$\n\\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}} = \\frac{ (-2.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}) \\times (0.08 \\ \\mathrm{cm^{-1}}) - (0.12 \\ \\mathrm{cm^{-1}}) \\times (6.0 \\times 10^{-6} \\ \\mathrm{cm^{-1} \\ K^{-1}}) }{ (0.08 \\ \\mathrm{cm^{-1}})^2 }\n$$\n$$\n\\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}} = \\frac{ -1.6 \\times 10^{-7} \\ \\mathrm{cm^{-2} \\ K^{-1}} - 7.2 \\times 10^{-7} \\ \\mathrm{cm^{-2} \\ K^{-1}} }{ 0.0064 \\ \\mathrm{cm^2} } = \\frac{-8.8 \\times 10^{-7} \\ \\mathrm{cm^{-2} \\ K^{-1}}}{6.4 \\times 10^{-3} \\ \\mathrm{cm^2}}\n$$\n$$\n\\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}} = -1.375 \\times 10^{-4} \\ \\mathrm{K^{-1}}\n$$\n现在我们可以计算多普勒系数：\n$$\n\\alpha_D = \\frac{1}{k_{\\infty,0}^2} \\left( \\frac{dk_{\\infty}}{dT_f}\\bigg|_{T_{f,0}} \\right) = \\frac{1}{(1.5)^2} (-1.375 \\times 10^{-4} \\ \\mathrm{K^{-1}}) = \\frac{1}{2.25} (-1.375 \\times 10^{-4} \\ \\mathrm{K^{-1}})\n$$\n$$\n\\alpha_D = -0.61111... \\times 10^{-4} \\ \\mathrm{K^{-1}} = -6.1111... \\times 10^{-5} \\ \\mathrm{K^{-1}}\n$$\n按照要求将结果四舍五入到三位有效数字：\n$$\n\\alpha_D \\approx -6.11 \\times 10^{-5} \\ \\mathrm{K^{-1}}\n$$",
            "answer": "$$\\boxed{-6.11 \\times 10^{-5}}$$"
        },
        {
            "introduction": "在静态反馈系数的基础上，我们进一步探讨反馈的动态特性。真实的反应堆反馈过程是动态的，并且常常涉及发生在不同时间尺度上的物理现象。本练习引入了一个沸水堆中空泡份额的多尺度模型，演示了如何表示并结合快速（如微小气泡成核）和慢速（如宏观流动模式变化）的物理过程，以预测反应堆的瞬态响应。这个实践将帮助您理解多时间尺度建模在捕捉复杂系统动态行为中的核心作用。",
            "id": "4237444",
            "problem": "考虑一个单通道沸水反应堆 (BWR)，在时间 $t=0$ 时经历热功率的阶跃增长。反应堆功率在 $t  0$ 时为 $P(t)=P_{0}$，在 $t \\ge 0$ 时为 $P(t)=P_{1}$，其中 $P_{1}/P_{0}=1.15$。两相空泡份额（记为 $\\alpha(t)$）采用多尺度热反馈模型进行建模，其中微观尺度的气泡动力学和宏观尺度的通道水动力学作为并行的一阶过程共同作用。令 $\\alpha_{f}(t)$ 和 $\\alpha_{s}(t)$ 分别表示快、慢分量。控制关系式为\n$$\\frac{d\\alpha_{f}}{dt}=\\frac{\\alpha_{\\mathrm{eq}}(P(t))-\\alpha_{f}}{\\tau_{f}},\\qquad \\frac{d\\alpha_{s}}{dt}=\\frac{\\alpha_{\\mathrm{eq}}(P(t))-\\alpha_{s}}{\\tau_{s}},\\qquad \\alpha(t)=w\\,\\alpha_{f}(t)+(1-w)\\,\\alpha_{s}(t),$$\n其中 $w$、$\\tau_{f}$ 和 $\\tau_{s}$ 为常数。运行点附近的平衡空泡份额线性化为\n$$\\alpha_{\\mathrm{eq}}(P)=\\alpha_{0}+s\\left(\\frac{P}{P_{0}}-1\\right),$$\n其中 $\\alpha_{0}=\\alpha_{\\mathrm{eq}}(P_{0})$。所有参数给定如下：$w=0.35$，$\\tau_{f}=0.40\\,\\mathrm{s}$，$\\tau_{s}=4.0\\,\\mathrm{s}$，$\\alpha_{0}=0.35$ 和 $s=0.40$。\n\n由空泡引起的反应性反馈由 $\\rho(\\alpha)$（反应性作为空泡份额的函数）的列表值给出，在目标范围内有效：\n- 当 $\\alpha=0.30$ 时，$\\rho=-0.00020$。\n- 当 $\\alpha=0.35$ 时，$\\rho=-0.00035$。\n- 当 $\\alpha=0.40$ 时，$\\rho=-0.00055$。\n- 当 $\\alpha=0.45$ 时，$\\rho=-0.00080$。\n\n假设 $\\rho(\\alpha)$ 在列表点之间呈线性变化。忽略所有其他反馈（例如，多普勒效应、无沸腾时的慢化剂温度反馈）以及由动力学引起的 $P(t)$ 对给定阶跃的任何偏离。\n\n使用适用于多尺度热反馈的第一性原理，计算功率增加后 $t=2.0\\,\\mathrm{s}$ 时的瞬态空泡份额 $\\alpha(t)$，以及仅由空泡增加引起的反应性变化 $\\Delta \\rho=\\rho(\\alpha(t))-\\rho(\\alpha_{0})$。将 $\\alpha(2.0\\,\\mathrm{s})$ 和 $\\Delta\\rho$ 均表示为无量纲小数，并将您的答案四舍五入至五位有效数字。以一个二元行矩阵 $\\begin{pmatrix}\\alpha(2.0\\,\\mathrm{s})  \\Delta\\rho\\end{pmatrix}$ 的形式提供您的最终答案。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、提法恰当且客观。\n\n### 步骤 1：提取已知条件\n-   反应堆功率阶跃函数：$t  0$ 时 $P(t)=P_{0}$，$t \\ge 0$ 时 $P(t)=P_{1}$。\n-   功率比：$\\frac{P_{1}}{P_{0}}=1.15$。\n-   多尺度空泡份额模型方程：\n    $$\n    \\frac{d\\alpha_{f}}{dt}=\\frac{\\alpha_{\\mathrm{eq}}(P(t))-\\alpha_{f}}{\\tau_{f}}\n    $$\n    $$\n    \\frac{d\\alpha_{s}}{dt}=\\frac{\\alpha_{\\mathrm{eq}}(P(t))-\\alpha_{s}}{\\tau_{s}}\n    $$\n    $$\n    \\alpha(t)=w\\,\\alpha_{f}(t)+(1-w)\\,\\alpha_{s}(t)\n    $$\n-   模型参数：$w=0.35$，$\\tau_{f}=0.40\\,\\mathrm{s}$，$\\tau_{s}=4.0\\,\\mathrm{s}$。\n-   平衡空泡份额线性化：$\\alpha_{\\mathrm{eq}}(P)=\\alpha_{0}+s\\left(\\frac{P}{P_{0}}-1\\right)$，其中 $\\alpha_{0}=\\alpha_{\\mathrm{eq}}(P_{0})$。\n-   线性化参数：$\\alpha_{0}=0.35$，$s=0.40$。\n-   列表形式的反应性数据 $\\rho(\\alpha)$：\n    -   $\\rho(0.30) = -0.00020$\n    -   $\\rho(0.35) = -0.00035$\n    -   $\\rho(0.40) = -0.00055$\n    -   $\\rho(0.45) = -0.00080$\n-   插值：$\\rho(\\alpha)$ 在列表点之间呈线性关系。\n-   任务：计算 $\\alpha(t=2.0\\,\\mathrm{s})$ 和 $\\Delta\\rho = \\rho(\\alpha(2.0\\,\\mathrm{s})) - \\rho(\\alpha_0)$。\n-   输出：四舍五入至五位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题描述了反应堆热工水力学中的一个标准瞬态分析，使用了一个简化的、但有物理动机的、用于空泡反馈的双时间常数模型。控制方程是一阶线性常微分方程，是适定的。所提供的参数对于沸水反应堆是物理上现实的。该问题是自洽的、数学上一致且客观的。它没有违反任何科学原理，是一个有效、可解的问题。\n\n### 解题过程\n解题过程首先确定初始和最终的平衡条件，然后求解空泡份额分量的瞬态微分方程，计算指定时间的总空泡份额，最后通过插值确定相应的反应性变化。\n\n**1. 确定平衡空泡份额**\n对于 $t  0$，反应堆处于功率为 $P_0$ 的稳态。平衡空泡份额 $\\alpha_{eq,0}$ 由问题陈述给出为：\n$$\n\\alpha_{eq,0} = \\alpha_{\\mathrm{eq}}(P_{0}) = \\alpha_{0} = 0.35\n$$\n对于 $t \\ge 0$，功率阶跃至 $P_1$。新的平衡空泡份额 $\\alpha_{eq,1}$ 使用所提供的线性模型计算：\n$$\n\\alpha_{eq,1} = \\alpha_{\\mathrm{eq}}(P_{1}) = \\alpha_{0} + s\\left(\\frac{P_{1}}{P_{0}} - 1\\right)\n$$\n代入给定值 $s=0.40$ 和 $\\frac{P_{1}}{P_{0}}=1.15$：\n$$\n\\alpha_{eq,1} = 0.35 + 0.40(1.15 - 1) = 0.35 + 0.40(0.15) = 0.35 + 0.06 = 0.41\n$$\n\n**2. 求解瞬态空泡份额方程**\n快、慢空泡分量 $\\alpha_f(t)$ 和 $\\alpha_s(t)$ 的控制方程是一阶线性常微分方程。对于 $t \\ge 0$，方程为：\n$$\n\\frac{d\\alpha_{f}}{dt} + \\frac{1}{\\tau_{f}}\\alpha_{f} = \\frac{\\alpha_{eq,1}}{\\tau_{f}}\n$$\n$$\n\\frac{d\\alpha_{s}}{dt} + \\frac{1}{\\tau_{s}}\\alpha_{s} = \\frac{\\alpha_{eq,1}}{\\tau_{s}}\n$$\n$t=0$ 时的初始条件由 $t0$ 时的稳态决定。在该状态下，$\\frac{d\\alpha_f}{dt}=0$ 且 $\\frac{d\\alpha_s}{dt}=0$，这意味着 $\\alpha_f(0) = \\alpha_{eq}(P_0) = \\alpha_0$ 且 $\\alpha_s(0) = \\alpha_{eq}(P_0) = \\alpha_0$。\n\n形式为 $\\frac{dy}{dt} + ay = b$ 的方程通解为 $y(t) = \\frac{b}{a} + C\\exp(-at)$。对于快分量：\n$$\n\\alpha_f(t) = \\alpha_{eq,1} + (\\alpha_f(0) - \\alpha_{eq,1})\\exp(-t/\\tau_f) = \\alpha_{eq,1} + (\\alpha_0 - \\alpha_{eq,1})\\exp(-t/\\tau_f)\n$$\n同理，对于慢分量：\n$$\n\\alpha_s(t) = \\alpha_{eq,1} + (\\alpha_s(0) - \\alpha_{eq,1})\\exp(-t/\\tau_s) = \\alpha_{eq,1} + (\\alpha_0 - \\alpha_{eq,1})\\exp(-t/\\tau_s)\n$$\n\n**3. 计算 $t=2.0\\,\\mathrm{s}$ 时的总空泡份额**\n总空泡份额 $\\alpha(t)$ 是各分量的加权和：\n$$\n\\alpha(t) = w\\,\\alpha_f(t) + (1-w)\\,\\alpha_s(t)\n$$\n代入 $\\alpha_f(t)$ 和 $\\alpha_s(t)$ 的表达式：\n$$\n\\alpha(t) = w[\\alpha_{eq,1} + (\\alpha_0 - \\alpha_{eq,1})\\exp(-t/\\tau_f)] + (1-w)[\\alpha_{eq,1} + (\\alpha_0 - \\alpha_{eq,1})\\exp(-t/\\tau_s)]\n$$\n$$\n\\alpha(t) = \\alpha_{eq,1} + (\\alpha_0 - \\alpha_{eq,1})[w\\exp(-t/\\tau_f) + (1-w)\\exp(-t/\\tau_s)]\n$$\n现在，我们代入数值：$t=2.0\\,\\mathrm{s}$，$\\alpha_{eq,1}=0.41$，$\\alpha_0=0.35$，$w=0.35$，$\\tau_f=0.40\\,\\mathrm{s}$，以及 $\\tau_s=4.0\\,\\mathrm{s}$。\n$$\n\\alpha(2.0) = 0.41 + (0.35 - 0.41)[0.35\\exp(-2.0/0.40) + (1-0.35)\\exp(-2.0/4.0)]\n$$\n$$\n\\alpha(2.0) = 0.41 - 0.06[0.35\\exp(-5) + 0.65\\exp(-0.5)]\n$$\n数值计算该表达式：\n$$\n\\exp(-5) \\approx 0.0067379\n$$\n$$\n\\exp(-0.5) \\approx 0.606531\n$$\n$$\n\\alpha(2.0) \\approx 0.41 - 0.06[0.35(0.0067379) + 0.65(0.606531)]\n$$\n$$\n\\alpha(2.0) \\approx 0.41 - 0.06[0.0023583 + 0.394245]\n$$\n$$\n\\alpha(2.0) \\approx 0.41 - 0.06[0.396603]\n$$\n$$\n\\alpha(2.0) \\approx 0.41 - 0.02379618 = 0.38620382\n$$\n四舍五入至五位有效数字，$t=2.0\\,\\mathrm{s}$ 时的空泡份额为：\n$$\n\\alpha(2.0\\,\\mathrm{s}) = 0.38620\n$$\n\n**4. 计算反应性变化**\n反应性变化为 $\\Delta\\rho = \\rho(\\alpha(2.0\\,\\mathrm{s})) - \\rho(\\alpha_0)$。\n在 $\\alpha_0 = 0.35$ 时的初始反应性由表中给出：\n$$\n\\rho(\\alpha_0) = \\rho(0.35) = -0.00035\n$$\n为求得 $\\rho(\\alpha(2.0\\,\\mathrm{s})) = \\rho(0.38620382)$，我们必须使用列表数据进行线性插值。值 $\\alpha = 0.38620382$ 位于 $\\alpha_a=0.35$ 和 $\\alpha_b=0.40$ 之间。对应的反应性值为 $\\rho_a=-0.00035$ 和 $\\rho_b=-0.00055$。\n线性插值公式为 $\\rho(\\alpha) = \\rho_a + (\\alpha - \\alpha_a)\\frac{\\rho_b-\\rho_a}{\\alpha_b-\\alpha_a}$。\n反应性变化可以直接计算为 $\\Delta\\rho = (\\alpha(2.0) - \\alpha_0) \\times (\\text{斜率})$。\n该区间的斜率（空泡反应性系数）为：\n$$\n\\frac{\\Delta\\rho}{\\Delta\\alpha} = \\frac{\\rho_b - \\rho_a}{\\alpha_b - \\alpha_a} = \\frac{-0.00055 - (-0.00035)}{0.40 - 0.35} = \\frac{-0.00020}{0.05} = -0.004\n$$\n现在，我们计算反应性变化 $\\Delta\\rho$。使用未四舍五入的 $\\alpha(2.0\\,\\mathrm{s})$ 值会更精确。\n$$\n\\Delta\\rho = \\rho(\\alpha(2.0\\,\\mathrm{s})) - \\rho(\\alpha_0) = (\\alpha(2.0\\,\\mathrm{s}) - \\alpha_0) \\times \\left( \\frac{\\Delta\\rho}{\\Delta\\alpha} \\right)\n$$\n$$\n\\Delta\\rho = (0.38620382 - 0.35) \\times (-0.004)\n$$\n$$\n\\Delta\\rho = (0.03620382) \\times (-0.004) = -0.00014481528\n$$\n四舍五入至五位有效数字：\n$$\n\\Delta\\rho = -0.00014482\n$$\n所要求的两个值是 $\\alpha(2.0\\,\\mathrm{s}) = 0.38620$ 和 $\\Delta\\rho = -0.00014482$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.38620  -0.00014482 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从解析和半解析问题过渡到完整的数值模拟，我们面临着如何在计算机上准确求解中子学和热工水力学耦合方程组的挑战。显式和隐式耦合是解决这类问题的两种基本策略，它们在计算成本、稳定性和准确性之间存在重要的权衡。本编码练习将指导您实现并比较这两种耦合方案，通过模拟反应堆对反应性阶跃插入的响应，让您直接洞察多尺度反应堆模拟中固有的数值挑战和解决方案。",
            "id": "4237386",
            "problem": "要求您对均匀热中子反应堆在带有负多普勒反馈的情况下，对阶跃反应性引入的瞬态响应进行建模，并比较中子动力学与热工反馈之间显式耦合和隐式耦合两种方案下的结果。该反应堆采用点堆动力学模型，包含一组缓发中子和集总参数的燃料热能平衡。您必须从基本平衡方程推导离散时间更新律，实现两种耦合方案，并在一组测试场景下计算指定的指标。所有计算和输出必须严格遵守所提供的物理单位和数值规范。\n\n从以下基本方程组出发：\n\n- 中子布居与缓发中子先驱核平衡（单组），其中 $P(t)$ 是以瓦特为单位的反应堆功率，$C(t)$ 是以等效功率归一化单位表示的缓发中子先驱核浓度：\n  - $$\\frac{dP}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} P(t) + \\lambda C(t)$$\n  - $$\\frac{dC}{dt} = \\frac{\\beta}{\\Lambda} P(t) - \\lambda C(t)$$\n  此处，$\\rho(t)$ 是反应性（无量纲），$\\beta$ 是总缓发中子份额（无量纲），$\\Lambda$ 是以秒为单位的中子代时间，$\\lambda$ 是以秒的倒数为单位的缓发中子衰变常数。\n\n- 集总参数的燃料热能平衡：\n  - $$H_f \\frac{dT_f}{dt} = \\eta P(t) - K_f\\left(T_f(t) - T_c\\right)$$\n  此处，$T_f(t)$ 是以开尔文为单位的平均燃料温度，$T_c$ 是以开尔文为单位的冷却剂温度（假定为常数），$H_f$ 是以焦耳每开尔文为单位的等效燃料热容，$K_f$ 是以瓦特每开尔文为单位的等效燃料至冷却剂传热系数，$\\eta$ 是沉积在燃料中的反应堆功率份额（无量纲）。\n\n- 通过多普勒效应（负多普勒系数）的反应性反馈：\n  - $$\\rho(t) = \\rho_{\\text{ext}} + \\alpha_D \\left(T_f(t) - T_{f,0}\\right)$$\n  其中，$\\rho_{\\text{ext}}$ 是在 $t \\ge 0$ 时外部引入的阶跃反应性，$\\alpha_D$ 是以开尔文的倒数为单位的多普勒系数（为负值），$T_{f,0}$ 是以开尔文为单位的初始燃料温度。\n\n假设在 $t  0$ 时，反应堆处于稳态，且 $\\rho_{\\text{ext}} = 0$。在 $t = 0$ 时，引入一个阶跃反应性 $\\rho_{\\text{ext}}$ 并在此后保持不变。对于稳态，使用通过在 $t = 0^{-}$ 处强制时间导数为零而获得的物理上一致的初始条件：\n- $$C(0) = \\frac{\\beta}{\\lambda \\Lambda} P(0)$$\n- $$T_f(0) = T_c + \\frac{\\eta}{K_f} P(0)$$\n\n您的任务：\n\n- 使用均匀的时间步长 $\\Delta t$ 对时间进行离散化，并实现中子动力学与热工反馈之间的两种耦合方案：\n  1. 显式耦合：在每个时间步内，使用前一时间层级的 $T_f$ 来评估 $\\rho$，并使用数值稳定的方法推进中子动力学和先驱核浓度，然后使用新计算出的功率更新 $T_f$。\n  2. 隐式耦合：在每个时间步内，使用新时间层级的 $T_f$ 来评估 $\\rho$，并使用数值稳定的方法同时推进中子动力学、先驱核浓度和燃料温度，确保负多普勒反馈作用于同一时间层级内。\n\n- 在两种方案中，均对微分方程使用后向欧拉（全隐式）时间离散化方法，但在如何根据 $T_f$ 评估 $\\rho$ 这一点上，严格遵守显式或隐式的选择。\n\n- 为每个测试场景和耦合方案计算：\n  - 最终时间 $t_{\\text{end}}$ 时的反应堆功率，以兆瓦（MW）表示。\n  - 在整个瞬态区间 $[0, t_{\\text{end}}]$ 内观测到的最大反应堆功率，以兆瓦（MW）表示。\n\n- 将每个功率值以兆瓦（MW）为单位表示为一个四舍五入到六位小数的浮点数。\n\n测试套件：\n\n使用以下参数集定义四个场景。对于每个场景，都给定了 $\\beta$、$\\Lambda$、$\\lambda$、$\\eta$、$H_f$、$K_f$、$T_c$、$P(0)$、$\\rho_{\\text{ext}}$、$\\Delta t$ 和 $t_{\\text{end}}$ 的值。单位如各符号旁所指定。\n\n- 场景 A（一般情况，次瞬发临界引入）：\n  - $\\beta = 0.0065$ (无量纲)\n  - $\\Lambda = 1 \\times 10^{-4}$ (秒)\n  - $\\lambda = 0.08$ (秒的倒数)\n  - $\\eta = 0.95$ (无量纲)\n  - $H_f = 5 \\times 10^{7}$ (焦耳每开尔文)\n  - $K_f = 3.1666667 \\times 10^{5}$ (瓦特每开尔文)\n  - $T_c = 600$ (开尔文)\n  - $P(0) = 1.0 \\times 10^{8}$ (瓦特)\n  - $\\alpha_D = -3.0 \\times 10^{-5}$ (开尔文的倒数)\n  - $\\rho_{\\text{ext}} = 0.002$ (无量纲)\n  - $\\Delta t = 1.0 \\times 10^{-3}$ (秒)\n  - $t_{\\text{end}} = 3.0$ (秒)\n\n- 场景 B（近瞬发临界引入）：\n  - 与场景 A 相同，除了 $\\rho_{\\text{ext}} = 0.006$ (无量纲)\n\n- 场景 C（边界情况，零引入）：\n  - 与场景 A 相同，除了 $\\rho_{\\text{ext}} = 0.0$ (无量纲)\n\n- 场景 D（由反馈调节的超瞬发临界引入）：\n  - 与场景 A 相同，除了 $\\rho_{\\text{ext}} = 0.010$ (无量纲)\n\n最终输出规范：\n\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个场景，按顺序输出四个值：显式耦合下的最终功率（MW）、隐式耦合下的最终功率（MW）、显式耦合下的最大功率（MW）、隐式耦合下的最大功率（MW）。将四个场景 A、B、C、D 的结果按此顺序连接起来，得到一个包含 $16$ 个浮点数的列表。例如，输出格式必须与此完全一样：\n  - $$\\left[\\text{A\\_final\\_explicit}, \\text{A\\_final\\_implicit}, \\text{A\\_max\\_explicit}, \\text{A\\_max\\_implicit}, \\text{B\\_final\\_explicit}, \\ldots, \\text{D\\_max\\_implicit}\\right]$$\n所有输出必须以兆瓦（MW）为单位，四舍五入到六位小数，并表示为不带任何百分号的小数。",
            "solution": "用户提供了一个定义明确的核反应堆物理问题，要求实现并比较一个带热工反馈的点堆动力学模型的两种数值耦合方案。该问题具有科学依据，内容自成体系，且算法具体。因此，有必要提供一个完整的解决方案。\n\n反应堆动态由一个包含三个耦合常微分方程（ODE）的系统描述。设 $P(t)$、$C(t)$ 和 $T_f(t)$ 分别表示反应堆功率、先驱核浓度和燃料温度。离散解的时间索引将用下标 $n$ 表示，其中 $t_n = n \\Delta t$。在时间 $t_n$ 的状态变量为 $P_n$、$C_n$ 和 $T_{f,n}$。我们的目标是求解在 $t_{n+1}$ 时的状态。\n\n所提供的基本方程如下：\n1.  中子布居平衡：\n    $$\\frac{dP}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} P(t) + \\lambda C(t)$$\n2.  先驱核浓度平衡：\n    $$\\frac{dC}{dt} = \\frac{\\beta}{\\Lambda} P(t) - \\lambda C(t)$$\n3.  燃料热能平衡：\n    $$H_f \\frac{dT_f}{dt} = \\eta P(t) - K_f\\left(T_f(t) - T_c\\right)$$\n4.  反应性反馈：\n    $$\\rho(t) = \\rho_{\\text{ext}} + \\alpha_D \\left(T_f(t) - T_{f,0}\\right)$$\n\n问题指定使用后向欧拉法进行时间离散化。将此方法应用于常微分方程组，我们将 $\\frac{dy}{dt}$ 替换为 $\\frac{y_{n+1} - y_n}{\\Delta t}$，并在时间步 $n+1$ 处计算右侧的所有项。\n\n由先驱核平衡方程 (2) 可得：\n$\\frac{C_{n+1} - C_n}{\\Delta t} = \\frac{\\beta}{\\Lambda} P_{n+1} - \\lambda C_{n+1}$\n求解 $C_{n+1}$ 得：\n$$C_{n+1} = \\frac{C_n + \\frac{\\beta \\Delta t}{\\Lambda} P_{n+1}}{1 + \\lambda \\Delta t}$$\n\n由热能平衡方程 (3) 可得：\n$\\frac{T_{f,n+1} - T_{f,n}}{\\Delta t} = \\frac{1}{H_f} \\left[ \\eta P_{n+1} - K_f(T_{f,n+1} - T_c) \\right]$\n求解 $T_{f,n+1}$ 得：\n$$T_{f,n+1} = \\frac{T_{f,n} + \\frac{K_f \\Delta t}{H_f} T_c + \\frac{\\eta \\Delta t}{H_f} P_{n+1}}{1 + \\frac{K_f \\Delta t}{H_f}}$$\n\n由中子布居平衡方程 (1) 可得：\n$\\frac{P_{n+1} - P_n}{\\Delta t} = \\frac{\\rho_{n+1} - \\beta}{\\Lambda} P_{n+1} + \\lambda C_{n+1}$\n代入 $C_{n+1}$ 的表达式并重新整理以求解 $P_{n+1}$，可得到新功率水平的通用表达式。经过代数运算，我们得到：\n$$P_{n+1} = \\frac{\\Lambda \\left[ P_n(1 + \\lambda \\Delta t) + \\lambda \\Delta t C_n \\right]}{\\Lambda(1 + \\lambda \\Delta t) + \\beta \\Delta t - \\rho_{n+1} \\Delta t(1 + \\lambda \\Delta t)}$$\n项 $\\rho_{n+1}$ 是显式和隐式耦合方案的区别所在。\n\n$t=0$ 时的初始条件由稳态假设（$\\frac{d}{dt} = 0$）和 $\\rho_{\\text{ext}}=0$ 导出。这得出：\n-   初始燃料温度：$T_{f,0} = T_c + \\frac{\\eta P(0)}{K_f}$\n-   初始先驱核浓度：$C(0) = \\frac{\\beta P(0)}{\\lambda \\Lambda}$\n\n我们现在将详细说明两种耦合方案的实现。\n\n**1. 显式耦合方案**\n\n在显式耦合方案中，新时间步的反应性 $\\rho_{n+1}$ 是使用前一时间步的燃料温度 $T_{f,n}$ 计算的。\n$$\\rho_{n+1} = \\rho_{\\text{ext}} + \\alpha_D \\left(T_{f,n} - T_{f,0}\\right)$$\n由于 $T_{f,n}$ 是已知的，$\\rho_{n+1}$ 在求解新状态向量 $[P_{n+1}, C_{n+1}, T_{f,n+1}]^T$ 之前就已确定。更新过程是顺序的：\n1.  计算反应性：$\\rho_{n+1, \\text{exp}} = \\rho_{\\text{ext}} + \\alpha_D (T_{f,n} - T_{f,0})$。\n2.  计算功率：将 $\\rho_{n+1, \\text{exp}}$ 代入 $P_{n+1}$ 的方程中并求解。由于分母中的所有项都是已知的，这是一个直接计算。\n3.  计算先驱核与温度：使用新计算的 $P_{n+1}$，通过它们各自的更新方程来求解 $C_{n+1}$ 和 $T_{f,n+1}$。\n\n该方案计算简单，但在热工反馈中引入了时间延迟，这可能导致不准确或数值不稳定，尤其是在时间步长大或瞬态变化迅速的情况下。\n\n**2. 隐式耦合方案**\n\n在隐式耦合方案中，反应性 $\\rho_{n+1}$ 是使用新时间步的燃料温度 $T_{f,n+1}$ 进行评估的。\n$$\\rho_{n+1} = \\rho_{\\text{ext}} + \\alpha_D \\left(T_{f,n+1} - T_{f,0}\\right)$$\n这创建了一个完全耦合的非线性系统，因为 $P_{n+1}$ 依赖于 $\\rho_{n+1}$，而 $\\rho_{n+1}$ 依赖于 $T_{f,n+1}$，后者又依赖于 $P_{n+1}$。我们可以通过将 $T_{f,n+1}$ 和 $\\rho_{n+1}$ 的表达式代入 $P_{n+1}$ 的方程中来求解该系统。\n\n我们来组合这些表达式：\n-   $P_{n+1} = f(\\rho_{n+1})$\n-   $\\rho_{n+1} = g(T_{f,n+1})$\n-   $T_{f,n+1} = h(P_{n+1})$\n\n将 $T_{f,n+1}$ 代入 $\\rho_{n+1}$ 的表达式中，得到 $\\rho_{n+1}$ 和 $P_{n+1}$ 之间的线性关系。将此关系代入 $P_{n+1}$ 的方程中，会得到一个关于 $P_{n+1}$ 的形如 $a P_{n+1}^2 + b P_{n+1} + c = 0$ 的二次方程。\n\n该二次方程的系数推导如下。设：\n-   $A_n = \\Lambda(P_n(1+\\lambda\\Delta t) + \\lambda\\Delta t C_n)$\n-   $B = \\Lambda(1+\\lambda\\Delta t) + \\beta\\Delta t$\n-   $D = \\Delta t(1+\\lambda\\Delta t)$\n-   $E_n = \\frac{H_f T_{f,n} + K_f\\Delta t T_c}{H_f + K_f\\Delta t}$\n-   $F = \\frac{\\eta\\Delta t}{H_f + K_f\\Delta t}$\n-   $G_n = \\rho_{\\text{ext}} + \\alpha_D(E_n - T_{f,0})$\n-   $H = \\alpha_D F$\n\n关于未知数 $P_{n+1}$ 和 $\\rho_{n+1}$ 的方程组是：\n$$P_{n+1} (B - D \\rho_{n+1}) = A_n$$\n$$\\rho_{n+1} = G_n + H P_{n+1}$$\n将第二个方程代入第一个方程得到：\n$$P_{n+1} (B - D(G_n + H P_{n+1})) = A_n$$\n$$P_{n+1} (B - D G_n) - D H P_{n+1}^2 = A_n$$\n整理成标准二次型 $a x^2 + b x + c = 0$，其中 $x=P_{n+1}$：\n$$(DH)P_{n+1}^2 + (DG_n - B)P_{n+1} + A_n = 0$$\n系数为：\n-   $a = DH$\n-   $b = DG_n - B$\n-   $c = A_n$\n\n由于 $\\alpha_D  0$，我们有 $H  0$，因此 $a  0$。对于正功率的反应堆状态，$A_n$ 总是正的，所以 $c>0$。判别式 $b^2-4ac$ 总是正的，保证了两个实根。根的乘积 $c/a$ 是负的，这意味着一个根是正的（物理根），另一个是负的（非物理根）。物理上的功率 $P_{n+1}$ 必须是正的。标准二次求根公式是 $P_{n+1} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$。由于分母 $2a$ 是负的，要使 $P_{n+1}$ 为正，分子也必须是负的。项 $-b - \\sqrt{b^2 - 4ac}$ 总是负的，而 $-b + \\sqrt{b^2 - 4ac}$ 总是正的。因此，我们必须在分子中选择减号以获得物理根：\n$$P_{n+1} = \\frac{-b - \\sqrt{b^2 - 4ac}}{2a} = \\frac{-(DG_n - B) - \\sqrt{(DG_n - B)^2 - 4(DH)A_n}}{2DH}$$\n\n隐式更新过程如下：\n1.  基于时间 $t_n$ 的状态，计算二次方程的系数 a、b、c。\n2.  使用物理根求解二次方程，得到 $P_{n+1}$。\n3.  使用新的 $P_{n+1}$ 计算 $C_{n+1}$ 和 $T_{f,n+1}$。\n\n该方案正确地模拟了多普勒反馈的瞬时性，并且通常比显式方案更准确、更稳定，尤其是在处理超瞬发临界瞬态时。\n\n该解决方案将通过创建一个函数来实现，该函数为给定的参数集和耦合选择执行时间步长循环，计算最终功率并跟踪整个瞬态过程中的最大功率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the reactor transient simulations for all scenarios\n    and print the results in the specified format.\n    \"\"\"\n\n    scenarios = {\n        'A': {'rho_ext': 0.002},\n        'B': {'rho_ext': 0.006},\n        'C': {'rho_ext': 0.0},\n        'D': {'rho_ext': 0.010},\n    }\n\n    base_params = {\n        'BETA': 0.0065,        # dimensionless\n        'LAMBDA_N': 1.0e-4,    # seconds\n        'LAMBDA_C': 0.08,      # inverse seconds\n        'ETA': 0.95,           # dimensionless\n        'H_F': 5.0e7,          # joules per kelvin\n        'K_F': 3.1666667e5,    # watts per kelvin\n        'T_C': 600.0,          # kelvin\n        'P0_W': 1.0e8,         # watts\n        'ALPHA_D': -3.0e-5,    # inverse kelvin\n        'DT': 1.0e-3,          # seconds\n        'T_END': 3.0,          # seconds\n    }\n\n    results = []\n\n    for key in sorted(scenarios.keys()):\n        params = base_params.copy()\n        params.update(scenarios[key])\n\n        # Run explicit coupling simulation\n        p_final_exp, p_max_exp = run_simulation(params, 'explicit')\n        results.extend([p_final_exp, 0.0, p_max_exp, 0.0])\n\n        # Run implicit coupling simulation\n        p_final_imp, p_max_imp = run_simulation(params, 'implicit')\n        results[-3] = p_final_imp\n        results[-1] = p_max_imp\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\ndef run_simulation(params, coupling_type):\n    \"\"\"\n    Runs a single reactor transient simulation.\n    \n    Args:\n        params (dict): A dictionary of physical and numerical parameters.\n        coupling_type (str): 'explicit' or 'implicit'.\n\n    Returns:\n        tuple: A tuple containing (final_power_MW, max_power_MW).\n    \"\"\"\n    # Unpack parameters\n    BETA = params['BETA']\n    LAMBDA_N = params['LAMBDA_N']\n    LAMBDA_C = params['LAMBDA_C']\n    ETA = params['ETA']\n    H_F = params['H_F']\n    K_F = params['K_F']\n    T_C = params['T_C']\n    P0_W = params['P0_W']\n    ALPHA_D = params['ALPHA_D']\n    DT = params['DT']\n    T_END = params['T_END']\n    RHO_EXT = params['rho_ext']\n\n    # Initial conditions\n    T_F0 = T_C + ETA * P0_W / K_F\n    C0 = BETA * P0_W / (LAMBDA_C * LAMBDA_N)\n\n    # State variables\n    p_n = P0_W\n    c_n = C0\n    t_f_n = T_F0\n\n    # Simulation setup\n    n_steps = int(T_END / DT)\n    max_power = P0_W\n\n    # Time-stepping loop\n    for _ in range(n_steps):\n        if coupling_type == 'explicit':\n            # 1. Calculate reactivity using previous temperature\n            rho_n1 = RHO_EXT + ALPHA_D * (t_f_n - T_F0)\n\n            # 2. Calculate power P_{n+1}\n            numerator_p = LAMBDA_N * (p_n * (1 + LAMBDA_C * DT) + LAMBDA_C * DT * c_n)\n            denominator_p = LAMBDA_N * (1 + LAMBDA_C * DT) + BETA * DT - rho_n1 * DT * (1 + LAMBDA_C * DT)\n            p_n1 = numerator_p / denominator_p\n            \n        elif coupling_type == 'implicit':\n            # 1. Calculate coefficients for the quadratic equation a*x^2 + b*x + c = 0\n            # where x = P_{n+1}\n            An = LAMBDA_N * (p_n * (1 + LAMBDA_C * DT) + LAMBDA_C * DT * c_n)\n            B_const = LAMBDA_N * (1 + LAMBDA_C * DT) + BETA * DT\n            D_const = DT * (1 + LAMBDA_C * DT)\n            \n            En = (H_F * t_f_n + K_F * DT * T_C) / (H_F + K_F * DT)\n            F_const = (ETA * DT) / (H_F + K_F * DT)\n            \n            Gn = RHO_EXT + ALPHA_D * (En - T_F0)\n            H_const = ALPHA_D * F_const\n\n            a_quad = D_const * H_const\n            b_quad = D_const * Gn - B_const\n            c_quad = An\n            \n            # 2. Solve the quadratic equation for the physical (positive) root\n            discriminant = np.sqrt(b_quad**2 - 4 * a_quad * c_quad)\n            p_n1 = (-b_quad - discriminant) / (2 * a_quad)\n\n        else:\n            raise ValueError(\"Invalid coupling type specified.\")\n\n        # 3. Update precursor concentration C_{n+1}\n        c_n1 = (c_n + (BETA * DT / LAMBDA_N) * p_n1) / (1 + LAMBDA_C * DT)\n\n        # 4. Update fuel temperature T_{f,n+1}\n        t_f_n1 = (t_f_n + (K_F * DT / H_F) * T_C + (ETA * DT / H_F) * p_n1) / (1 + K_F * DT / H_F)\n\n        # Update state for next step\n        p_n, c_n, t_f_n = p_n1, c_n1, t_f_n1\n\n        # Track maximum power\n        if p_n > max_power:\n            max_power = p_n\n\n    # Convert final and max power from Watts to Megawatts\n    final_power_mw = p_n / 1e6\n    max_power_mw = max_power / 1e6\n\n    return final_power_mw, max_power_mw\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}