{
    "hands_on_practices": [
        {
            "introduction": "Multiscale models in reactor physics often result in large systems of coupled equations governing phenomena like neutron transport and heat transfer. A tempting simplification is to solve these equations separately in a decoupled manner, a method known as operator splitting or loose coupling. This exercise demonstrates the potential dangers of such an approach by analyzing a simplified, linearized model of thermal-neutronic feedback, showing how neglecting the coupling terms can lead to a divergent numerical solution and highlighting the importance of robust coupling strategies from the outset. ",
            "id": "4237385",
            "problem": "A pressurized water reactor core is modeled with a two-scale, single-channel thermal feedback closure that couples a coarse-scale neutronic power variable and a fine-scale fuel temperature variable. Let $p$ denote the dimensionless, core-averaged power increment relative to a nominal operating point, and let $\\theta$ denote the dimensionless, fuel temperature increment at the microstructural scale (for example, grain-level). Linearizing the residual equations about the nominal operating point yields the coupled system\n$$\nF_1(p,\\theta) = p - 1 - s\\,\\theta = 0, \\quad F_2(p,\\theta) = \\theta - c\\,p = 0,\n$$\nwhere $s > 0$ is the magnitude of the micro-scale Doppler feedback sensitivity and $c > 0$ is the macro-scale thermal response sensitivity. The off-diagonal entries of the Jacobian matrix\n$$\nJ = \\begin{pmatrix}\n\\frac{\\partial F_1}{\\partial p} & \\frac{\\partial F_1}{\\partial \\theta} \\\\\n\\frac{\\partial F_2}{\\partial p} & \\frac{\\partial F_2}{\\partial \\theta}\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 & -s \\\\\n-c & 1\n\\end{pmatrix}\n$$\nrepresent the multiscale thermal-neutronic couplings. Consider a Newton iteration that approximates the Jacobian by neglecting these off-diagonal terms, i.e., uses $J_{\\mathrm{d}} = \\mathrm{diag}(1,1)$, so that the iteration reduces to a preconditioned fixed-point scheme $x_{k+1} = x_k - J_{\\mathrm{d}}^{-1} F(x_k)$, where $x = (p,\\theta)^{\\mathsf{T}}$.\n\nStarting from fundamental iteration theory, derive the iteration matrix for the linearized error propagation and its spectral radius in terms of the dimensionless coupling strength $g = c\\,s$. Show that there exists a critical threshold $g_{\\mathrm{crit}}$ such that the iteration converges locally if and only if $g < g_{\\mathrm{crit}}$. As a concrete, scientifically plausible example, take $s = 3.0$ and $c = 0.5$ (both dimensionless, obtained from appropriate normalization of reactivity and thermal conductance scales), and determine whether the iteration with $J_{\\mathrm{d}}$ converges or diverges for these parameters.\n\nExpress the final answer as the closed-form expression for the critical threshold $g_{\\mathrm{crit}}$ (dimensionless). No rounding is required. Report only $g_{\\mathrm{crit}}$ as your final answer.",
            "solution": "The problem asks for the derivation of the convergence condition for a simplified Newton iteration applied to a coupled thermal-neutronic system. We begin by formalizing the iteration and then analyzing its convergence properties based on linear iteration theory.\n\nThe system of equations can be written in vector form as $F(x) = 0$, where $x = (p, \\theta)^{\\mathsf{T}}$ and $F(x)$ is the vector function\n$$\nF(x) = \\begin{pmatrix} p - 1 - s\\,\\theta \\\\ \\theta - c\\,p \\end{pmatrix}.\n$$\nThe Jacobian of this system is constant, as the equations are linear:\n$$\nJ = \\frac{\\partial F}{\\partial x} = \\begin{pmatrix}\n\\frac{\\partial F_1}{\\partial p} & \\frac{\\partial F_1}{\\partial \\theta} \\\\\n\\frac{\\partial F_2}{\\partial p} & \\frac{\\partial F_2}{\\partial \\theta}\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 & -s \\\\\n-c & 1\n\\end{pmatrix}.\n$$\nThe problem describes a Newton-like iteration where the exact Jacobian $J$ is replaced by an approximate Jacobian $J_{\\mathrm{d}} = \\mathrm{diag}(1,1)$, which is the identity matrix $I$. The iteration is given by:\n$$\nx_{k+1} = x_k - J_{\\mathrm{d}}^{-1} F(x_k).\n$$\nThis is a fixed-point iteration of the form $x_{k+1} = G(x_k)$, where the iteration function is $G(x) = x - J_{\\mathrm{d}}^{-1} F(x)$. Since $J_{\\mathrm{d}} = I$, its inverse $J_{\\mathrm{d}}^{-1}$ is also $I$. Thus, the iteration function simplifies to $G(x) = x - F(x)$.\n\nThe local convergence of a fixed-point iteration is determined by the spectral radius of the Jacobian of the iteration function $G(x)$, evaluated at the exact solution $x^*$. This Jacobian, often called the iteration matrix $M$, is given by:\n$$\nM = \\frac{\\partial G}{\\partial x} \\bigg|_{x=x^*}.\n$$\nLet's compute this derivative:\n$$\nM = \\frac{\\partial}{\\partial x} \\left( x - J_{\\mathrm{d}}^{-1} F(x) \\right) = I - J_{\\mathrm{d}}^{-1} \\frac{\\partial F}{\\partial x} = I - J_{\\mathrm{d}}^{-1} J.\n$$\nSince the system Jacobian $J$ is constant, the iteration matrix $M$ is also constant and does not depend on the point of evaluation. Substituting $J_{\\mathrm{d}} = I$ and the expression for $J$, we obtain the iteration matrix:\n$$\nM = I - J = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1 & -s \\\\ -c & 1 \\end{pmatrix} = \\begin{pmatrix} 1-1 & 0-(-s) \\\\ 0-(-c) & 1-1 \\end{pmatrix} = \\begin{pmatrix} 0 & s \\\\ c & 0 \\end{pmatrix}.\n$$\nThe iteration converges locally if and only if the spectral radius of the iteration matrix, $\\rho(M)$, is strictly less than $1$. The spectral radius is the maximum of the absolute values of the eigenvalues of $M$. To find the eigenvalues $\\lambda$, we solve the characteristic equation $\\det(M - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} 0 - \\lambda & s \\\\ c & 0 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\lambda)(-\\lambda) - (s)(c) = 0\n$$\n$$\n\\lambda^2 - sc = 0.\n$$\nThe problem defines the dimensionless coupling strength as $g = c\\,s$. Given that $s>0$ and $c>0$, we have $g>0$. The characteristic equation becomes $\\lambda^2 = g$. The eigenvalues are:\n$$\n\\lambda_1 = \\sqrt{g}, \\quad \\lambda_2 = -\\sqrt{g}.\n$$\nThe spectral radius $\\rho(M)$ is then:\n$$\n\\rho(M) = \\max(|\\lambda_1|, |\\lambda_2|) = \\max(|\\sqrt{g}|, |-\\sqrt{g}|) = \\sqrt{g}.\n$$\nThe condition for convergence is $\\rho(M) < 1$, which translates to:\n$$\n\\sqrt{g} < 1.\n$$\nSince $g > 0$, we can square both sides of the inequality to find the condition on $g$:\n$$\ng < 1.\n$$\nThis establishes that there is a critical threshold $g_{\\mathrm{crit}}$ for the coupling strength. The iteration converges if and only if $g < g_{\\mathrm{crit}}$. From our derivation, this threshold is:\n$$\ng_{\\mathrm{crit}} = 1.\n$$\nNow, we consider the concrete example with $s = 3.0$ and $c = 0.5$. The coupling strength for this case is:\n$$\ng = c\\,s = (0.5)(3.0) = 1.5.\n$$\nComparing this value to the critical threshold, we have $g = 1.5 > g_{\\mathrm{crit}} = 1$. Since the coupling strength exceeds the critical threshold, the spectral radius of the iteration matrix is $\\rho(M) = \\sqrt{1.5} \\approx 1.22 > 1$. Therefore, for these specific parameters, the simplified Newton iteration will diverge.\n\nThe problem asks for the closed-form expression for the critical threshold $g_{\\mathrm{crit}}$. As derived, this value is $1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Beyond the risk of outright divergence, loosely coupled schemes in transient simulations can introduce subtle, non-physical artifacts. This practice explores one such issue: spurious oscillations arising from operator-splitting methods, a common technique for handling coupled time-dependent problems. By linearizing the discrete numerical scheme and analyzing its amplification matrix, you will determine the stability limits of the method and understand how the artificial time lag in the feedback loop can compromise the simulation's physical fidelity. ",
            "id": "4237433",
            "problem": "Consider a lumped (zero-dimensional) multiscale model of neutron kinetics coupled to thermal feedback in a homogeneous reactor region, where the neutron population $n(t)$ and the fuel temperature $T(t)$ evolve according to the following ordinary differential equations derived from point kinetics and an energy balance:\n$$\n\\frac{dn}{dt} \\;=\\; \\frac{\\rho(T)}{\\Lambda}\\,n, \n\\qquad \n\\frac{dT}{dt} \\;=\\; \\alpha\\,n \\;-\\; \\beta\\,(T - T_{\\mathrm{s}}).\n$$\nHere, $\\rho(T)$ is the temperature-dependent reactivity, $\\Lambda$ is the prompt neutron generation time, $\\alpha$ is a lumped heating coefficient, $\\beta$ is the effective heat removal coefficient, and $T_{\\mathrm{s}}$ is the coolant sink temperature. Assume strong nonlinear temperature dependence representative of Doppler feedback by prescribing\n$$\n\\rho(T) \\;=\\; \\rho_{0} \\;-\\; a\\,\\sqrt{T},\n$$\nwith constants $\\rho_{0} > 0$ and $a > 0$. For the purposes of this problem, take the parameters\n$$\n\\Lambda = 1.0 \\times 10^{-4}\\ \\mathrm{s}, \\quad \\alpha = 2.0\\ \\mathrm{K}\\,\\mathrm{s}^{-1}, \\quad \\beta = 5.0 \\times 10^{-1}\\ \\mathrm{s}^{-1}, \\quad T_{\\mathrm{s}} = 6.00 \\times 10^{2}\\ \\mathrm{K}, \\quad \\rho_{0} = 5.00 \\times 10^{-3}, \\quad a = 2.00 \\times 10^{-4}\\ \\mathrm{K}^{-1/2}.\n$$\nA first-order Lieâ€“Trotter operator splitting (OS) scheme updates the coupled system over a single time step $\\Delta t$ by first advancing the neutron population with the temperature frozen, then advancing the temperature with the newly updated neutron population frozen:\n$$\n\\text{Step A:}\\quad n^{m+\\frac{1}{2}} \\;=\\; n^{m} \\;+\\; \\Delta t\\;\\frac{\\rho(T^{m})}{\\Lambda}\\,n^{m}, \n$$\n$$\n\\text{Step B:}\\quad T^{m+1} \\;=\\; T^{m} \\;+\\; \\Delta t\\;\\big(\\alpha\\,n^{m+\\frac{1}{2}} \\;-\\; \\beta\\,(T^{m} - T_{\\mathrm{s}})\\big), \n\\qquad \nn^{m+1} \\;=\\; n^{m+\\frac{1}{2}}.\n$$\nStarting from the fundamental laws and definitions given above, and without invoking any pre-derived discrete stability criteria, do the following:\n- Determine the nontrivial steady state $(n^{\\ast}, T^{\\ast})$ for the continuous system and linearize the OS map around $(n^{\\ast}, T^{\\ast})$ to obtain the $2 \\times 2$ amplification matrix $M(\\Delta t)$ governing the evolution of small perturbations $(\\delta n^{m}, \\delta T^{m}) \\mapsto (\\delta n^{m+1}, \\delta T^{m+1})$.\n- Using this linearized OS map, analytically characterize the onset of spurious discrete-time oscillations introduced by operator splitting, and compute the largest time step $\\Delta t_{\\max}$ for which the spectral radius of $M(\\Delta t)$ is less than or equal to $1$. Express $\\Delta t_{\\max}$ in milliseconds and round your answer to three significant figures.\n\nAs part of your derivation, explain why the chosen nonlinear dependence $\\rho(T) = \\rho_{0} - a \\sqrt{T}$ can induce splitting-driven oscillations in the discrete-time scheme even when the continuous-time linearized dynamics are asymptotically stable, and briefly discuss principled remedies grounded in multiscale thermal feedback methods (for example, higher-order splitting, implicit coupling, or stabilized coarse-to-fine coupling) without changing the required final numeric answer format.",
            "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, internally consistent, and free of defects. It presents a standard problem in the numerical analysis of reactor physics models. We may therefore proceed with the solution.\n\nThe evolution of the system is governed by the coupled ordinary differential equations (ODEs):\n$$\n\\frac{dn}{dt} = \\frac{\\rho(T)}{\\Lambda} n\n$$\n$$\n\\frac{dT}{dt} = \\alpha n - \\beta(T - T_s)\n$$\nwith the reactivity given by $\\rho(T) = \\rho_0 - a\\sqrt{T}$.\n\nFirst, we determine the nontrivial steady state $(n^*, T^*)$ of the continuous system by setting the time derivatives to zero.\n$$\n\\frac{dn}{dt} = 0 \\implies \\frac{\\rho(T^*)}{\\Lambda} n^* = 0\n$$\nSince we seek a nontrivial solution with $n^* \\neq 0$, this requires the reactivity to be zero at equilibrium:\n$$\n\\rho(T^*) = \\rho_0 - a\\sqrt{T^*} = 0\n$$\nSolving for the steady-state temperature $T^*$ yields:\n$$\n\\sqrt{T^*} = \\frac{\\rho_0}{a} \\implies T^* = \\left(\\frac{\\rho_0}{a}\\right)^2\n$$\nNext, we set the time derivative of the temperature to zero:\n$$\n\\frac{dT}{dt} = 0 \\implies \\alpha n^* - \\beta(T^* - T_s) = 0\n$$\nSolving for the steady-state neutron population $n^*$ gives:\n$$\nn^* = \\frac{\\beta}{\\alpha}(T^* - T_s)\n$$\nSubstituting the given parameter values:\n$\\Lambda = 1.0 \\times 10^{-4}\\ \\mathrm{s}$, $\\alpha = 2.0\\ \\mathrm{K}\\,\\mathrm{s}^{-1}$, $\\beta = 0.5\\ \\mathrm{s}^{-1}$, $T_s = 600\\ \\mathrm{K}$, $\\rho_0 = 5.00 \\times 10^{-3}$, $a = 2.00 \\times 10^{-4}\\ \\mathrm{K}^{-1/2}$.\n$$\nT^* = \\left(\\frac{5.00 \\times 10^{-3}}{2.00 \\times 10^{-4}}\\right)^2 = (25.0)^2 = 625\\ \\mathrm{K}\n$$\n$$\nn^* = \\frac{0.5}{2.0}(625 - 600) = 0.25 \\times 25 = 6.25\n$$\nThe units of $n$ are consistent with the equation for $dT/dt$, implying a scaling factor absorbed into $\\alpha$.\n\nNext, we linearize the discrete Lie-Trotter operator splitting (OS) map. The map advances the state from $(n^m, T^m)$ to $(n^{m+1}, T^{m+1})$ over a time step $\\Delta t$:\n$$\nn^{m+1} = F_n(n^m, T^m) = n^m \\left( 1 + \\frac{\\Delta t}{\\Lambda} \\rho(T^m) \\right)\n$$\n$$\nT^{m+1} = F_T(n^m, T^m) = T^m + \\Delta t \\left[ \\alpha \\left( n^m \\left( 1 + \\frac{\\Delta t}{\\Lambda} \\rho(T^m) \\right) \\right) - \\beta (T^m - T_s) \\right]\n$$\nThe amplification matrix $M(\\Delta t)$ is the Jacobian of the map $(n^{m+1}, T^{m+1}) = \\mathbf{F}(n^m, T^m)$ evaluated at the steady state $(n^*, T^*)$:\n$$\nM(\\Delta t) = \\begin{pmatrix} \\frac{\\partial F_n}{\\partial n} & \\frac{\\partial F_n}{\\partial T} \\\\ \\frac{\\partial F_T}{\\partial n} & \\frac{\\partial F_T}{\\partial T} \\end{pmatrix} \\Bigg|_{(n^*, T^*)}\n$$\nWe compute the partial derivatives:\n$$\n\\frac{\\partial F_n}{\\partial n} = 1 + \\frac{\\Delta t}{\\Lambda} \\rho(T^m)\n$$\n$$\n\\frac{\\partial F_n}{\\partial T} = n^m \\frac{\\Delta t}{\\Lambda} \\rho'(T^m), \\quad \\text{where } \\rho'(T) = -\\frac{a}{2\\sqrt{T}}\n$$\n$$\n\\frac{\\partial F_T}{\\partial n} = \\Delta t \\left[ \\alpha \\left( 1 + \\frac{\\Delta t}{\\Lambda} \\rho(T^m) \\right) \\right]\n$$\n$$\n\\frac{\\partial F_T}{\\partial T} = 1 + \\Delta t \\left[ \\alpha n^m \\frac{\\Delta t}{\\Lambda} \\rho'(T^m) - \\beta \\right]\n$$\nEvaluating these at the steady state $(n^*, T^*)$, where $\\rho(T^*) = 0$ and $\\rho'(T^*) = -a / (2\\sqrt{T^*}) = -a^2 / (2\\rho_0)$:\n$$\n\\frac{\\partial F_n}{\\partial n}\\bigg|_{*} = 1\n$$\n$$\n\\frac{\\partial F_n}{\\partial T}\\bigg|_{*} = n^* \\frac{\\Delta t}{\\Lambda} \\rho'(T^*) = -\\frac{n^* a \\Delta t}{2\\Lambda\\sqrt{T^*}} = -\\frac{n^* a^2 \\Delta t}{2\\Lambda\\rho_0}\n$$\n$$\n\\frac{\\partial F_T}{\\partial n}\\bigg|_{*} = \\alpha \\Delta t\n$$\n$$\n\\frac{\\partial F_T}{\\partial T}\\bigg|_{*} = 1 - \\beta \\Delta t + \\alpha n^* \\frac{(\\Delta t)^2}{\\Lambda} \\rho'(T^*) = 1 - \\beta \\Delta t - \\frac{\\alpha n^* a^2 (\\Delta t)^2}{2\\Lambda\\rho_0}\n$$\nLet's define the constant $C_1 = \\frac{\\alpha n^* a^2}{2\\Lambda\\rho_0}$. The amplification matrix is:\n$$\nM(\\Delta t) = \\begin{pmatrix} 1 & -C_1 \\frac{\\Delta t}{\\alpha} \\\\ \\alpha \\Delta t & 1 - \\beta \\Delta t - C_1 (\\Delta t)^2 \\end{pmatrix}\n$$\nThe stability of the scheme is governed by the eigenvalues $\\lambda$ of $M$, which are the roots of the characteristic equation $\\det(M - \\lambda I) = 0$, or $\\lambda^2 - \\mathrm{Tr}(M)\\lambda + \\det(M) = 0$.\nThe trace and determinant of $M$ are:\n$$\n\\mathrm{Tr}(M) = 1 + (1 - \\beta \\Delta t - C_1 (\\Delta t)^2) = 2 - \\beta \\Delta t - C_1 (\\Delta t)^2\n$$\n$$\n\\det(M) = 1 \\cdot (1 - \\beta \\Delta t - C_1 (\\Delta t)^2) - (-C_1 \\frac{\\Delta t}{\\alpha})(\\alpha \\Delta t) = 1 - \\beta \\Delta t - C_1 (\\Delta t)^2 + C_1 (\\Delta t)^2 = 1 - \\beta \\Delta t\n$$\nFor the spectral radius $\\rho(M) \\le 1$, the eigenvalues must lie within or on the unit circle in the complex plane. For a $2 \\times 2$ real matrix, this is guaranteed if the Jury stability criteria are met:\n1. $1 - \\mathrm{Tr}(M) + \\det(M) \\ge 0$\n2. $1 + \\mathrm{Tr}(M) + \\det(M) \\ge 0$\n3. $|\\det(M)| \\le 1$\n\nLet's check these conditions:\n1. $1 - (2 - \\beta \\Delta t - C_1 (\\Delta t)^2) + (1 - \\beta \\Delta t) = C_1 (\\Delta t)^2 \\ge 0$. Since $C_1 > 0$, this is always satisfied for $\\Delta t > 0$.\n2. $1 + (2 - \\beta \\Delta t - C_1 (\\Delta t)^2) + (1 - \\beta \\Delta t) = 4 - 2\\beta \\Delta t - C_1 (\\Delta t)^2 \\ge 0$.\n3. $|1 - \\beta \\Delta t| \\le 1$. Since $\\beta > 0$ and $\\Delta t \\ge 0$, this simplifies to $1 - \\beta \\Delta t \\ge -1$, which gives $\\beta \\Delta t \\le 2$, or $\\Delta t \\le \\frac{2}{\\beta}$.\n\nThe onset of spurious oscillations occurs when a pair of complex conjugate eigenvalues reaches the unit circle, which corresponds to the second Jury criterion becoming an equality at the stability boundary: $4 - 2\\beta \\Delta t - C_1 (\\Delta t)^2 = 0$, or $C_1 (\\Delta t)^2 + 2\\beta \\Delta t - 4 = 0$. This is a quadratic equation for $\\Delta t$. Solving for $\\Delta t > 0$:\n$$\n\\Delta t = \\frac{-2\\beta + \\sqrt{(2\\beta)^2 - 4(C_1)(-4)}}{2C_1} = \\frac{-\\beta + \\sqrt{\\beta^2 + 4C_1}}{C_1}\n$$\nThe maximum stable time step, $\\Delta t_{\\max}$, is the smaller of the two limits derived from conditions 2 and 3:\n$$\n\\Delta t_{\\max} = \\min \\left( \\frac{-\\beta + \\sqrt{\\beta^2 + 4C_1}}{C_1}, \\frac{2}{\\beta} \\right)\n$$\nNow, we compute the numerical value of $C_1$:\n$$\nC_1 = \\frac{\\alpha n^* a^2}{2\\Lambda\\rho_0} = \\frac{(2.0)(6.25)(2.00 \\times 10^{-4})^2}{2(1.0 \\times 10^{-4})(5.00 \\times 10^{-3})} = \\frac{(12.5)(4.00 \\times 10^{-8})}{1.0 \\times 10^{-6}} = \\frac{50.0 \\times 10^{-8}}{1.0 \\times 10^{-6}} = 0.5\\ \\mathrm{s}^{-2}\n$$\nThe limit from the oscillation condition is:\n$$\n\\Delta t_{\\text{osc}} = \\frac{-0.5 + \\sqrt{(0.5)^2 + 4(0.5)}}{0.5} = \\frac{-0.5 + \\sqrt{0.25 + 2.0}}{0.5} = \\frac{-0.5 + \\sqrt{2.25}}{0.5} = \\frac{-0.5 + 1.5}{0.5} = 2.0\\ \\mathrm{s}\n$$\nThe limit from the determinant condition is:\n$$\n\\Delta t_{\\text{det}} = \\frac{2}{\\beta} = \\frac{2}{0.5} = 4.0\\ \\mathrm{s}\n$$\nThe overall stability limit is the minimum of these two values:\n$$\n\\Delta t_{\\max} = \\min(2.0, 4.0) = 2.0\\ \\mathrm{s}\n$$\nExpressed in milliseconds, this is $2000\\ \\mathrm{ms}$. Rounding to three significant figures gives $2.00 \\times 10^3\\ \\mathrm{ms}$.\n\nThe existence of these spurious oscillations is an artifact of the operator splitting scheme. The continuous system, when linearized around $(n^*, T^*)$, has a Jacobian matrix $J$ with eigenvalues that have strictly negative real parts, indicating that the steady state is asymptotically stable. The splitting scheme, however, introduces a numerical error, which is formally of order $\\mathcal{O}(\\Delta t)$. This error arises because the neutronics and thermal hydraulics are advanced sequentially rather than simultaneously. In the A-B splitting used here (neutronics first), the temperature feedback on the neutron population is delayed by one full time step: $n^{m+1}$ is computed using $\\rho(T^m)$. This artificial delay can cause the numerical solution to \"overshoot\" the true solution, leading to oscillations that grow in amplitude if $\\Delta t$ is too large. The nonlinear dependence $\\rho(T) = \\rho_0 - a\\sqrt{T}$ is crucial because it creates the coupling term $\\frac{\\partial F_n}{\\partial T}$ and the destabilizing $(\\Delta t)^2$ term in $\\frac{\\partial F_T}{\\partial T}$ via the chain rule during linearization. These terms, which depend on $\\rho'(T^*) \\neq 0$, are responsible for the complex interaction that leads to the numerical instability.\n\nPrincipled remedies to mitigate such splitting errors, common in multiscale thermal feedback methods, include:\n1.  **Higher-Order Splitting:** Schemes like Strang splitting ($B_{err}/2 \\to A_{err} \\to B_{err}/2$) reduce the splitting error to $\\mathcal{O}((\\Delta t)^2)$, often significantly increasing the stable time step limit.\n2.  **Implicit Coupling:** Treating the entire system implicitly (e.g., with Backward Euler or Crank-Nicolson) solves for $(n^{m+1}, T^{m+1})$ simultaneously. This eliminates the artificial delay and typically results in an unconditionally stable method, though it requires solving a nonlinear system of algebraic equations at each time step.\n3.  **Stabilized or Iterative Coupling:** Instead of full implicit coupling, one can use a few iterations (e.g., Picard or Jacobi) between the neutronics and thermal-hydraulics solves within a single time step to better converge the coupling terms. This offers a compromise between the stability of implicit methods and the simplicity of explicit splitting.",
            "answer": "$$\n\\boxed{2.00 \\times 10^3}\n$$"
        },
        {
            "introduction": "Having explored the theoretical pitfalls of simplified coupling, this final practice moves from analysis to implementation. You are tasked with building a transient reactor simulation that incorporates Doppler feedback, comparing the results of an explicit (loosely coupled) and an implicit (tightly coupled) numerical scheme. This hands-on coding exercise will provide a tangible demonstration of how implicit methods correctly capture rapid feedback and ensure numerical stability, a crucial insight for developing high-fidelity reactor simulation tools. ",
            "id": "4237386",
            "problem": "You are asked to model the transient response of a homogeneous thermal nuclear reactor to a step reactivity insertion with negative Doppler feedback, and to compare the results under explicit and implicit coupling between neutron kinetics and thermal feedback. The reactor is modeled using point kinetics with one delayed neutron group and a lumped-parameter fuel thermal energy balance. You must derive the discrete-time update laws from fundamental balances, implement both coupling schemes, and compute specified metrics over a set of test scenarios. All calculations and outputs must strictly conform to the physical units and numerical specifications provided.\n\nStart from the following fundamental bases:\n\n- Neutron population and delayed neutron precursor balance (one group), where $P(t)$ is reactor power in watts and $C(t)$ is the delayed neutron precursor concentration in an equivalent power-normalized unit:\n  - $$\\frac{dP}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} P(t) + \\lambda C(t)$$\n  - $$\\frac{dC}{dt} = \\frac{\\beta}{\\Lambda} P(t) - \\lambda C(t)$$\n  Here, $\\rho(t)$ is the reactivity (dimensionless), $\\beta$ is the total delayed neutron fraction (dimensionless), $\\Lambda$ is the neutron generation time in seconds, and $\\lambda$ is the delayed neutron decay constant in inverse seconds.\n\n- Lumped-parameter fuel thermal energy balance:\n  - $$H_f \\frac{dT_f}{dt} = \\eta P(t) - K_f\\left(T_f(t) - T_c\\right)$$\n  Here, $T_f(t)$ is the average fuel temperature in kelvin, $T_c$ is the coolant temperature in kelvin (assumed constant), $H_f$ is the effective fuel thermal capacitance in joules per kelvin, $K_f$ is the effective fuel-to-coolant heat transfer coefficient in watts per kelvin, and $\\eta$ is the fraction of reactor power deposited in the fuel (dimensionless).\n\n- Reactivity feedback through the Doppler effect (negative Doppler coefficient):\n  - $$\\rho(t) = \\rho_{\\text{ext}} + \\alpha_D \\left(T_f(t) - T_{f,0}\\right)$$\n  where $\\rho_{\\text{ext}}$ is the externally imposed step reactivity at $t \\ge 0$, $\\alpha_D$ is the Doppler coefficient in inverse kelvin (negative), and $T_{f,0}$ is the initial fuel temperature in kelvin.\n\nAssume the reactor is at steady state for $t < 0$ with $\\rho_{\\text{ext}} = 0$, and at $t = 0$ a step reactivity $\\rho_{\\text{ext}}$ is applied and held constant thereafter. For the steady state, use the physically consistent initial conditions obtained by enforcing time derivatives equal to zero at $t = 0^{-}$:\n- $$C(0) = \\frac{\\beta}{\\lambda \\Lambda} P(0)$$\n- $$T_f(0) = T_c + \\frac{\\eta}{K_f} P(0)$$\n\nYour task:\n\n- Discretize time with a uniform time step $\\Delta t$ and implement two coupling schemes between neutron kinetics and thermal feedback:\n  1. Explicit coupling: within each time step, evaluate $\\rho$ using $T_f$ from the previous time level, and advance neutron kinetics and precursors using a numerically stable method, then update $T_f$ using the newly computed power.\n  2. Implicit coupling: within each time step, evaluate $\\rho$ using $T_f$ at the new time level, and simultaneously advance neutron kinetics, precursors, and fuel temperature using a numerically stable method that ensures the negative Doppler feedback acts within the same time level.\n\n- In both schemes, use backward Euler (fully implicit) time discretization for the differential equations, while adhering to the explicit or implicit choice only in how $\\rho$ is evaluated with respect to $T_f$.\n\n- Compute, for each test scenario and coupling scheme:\n  - The reactor power at the final time $t_{\\text{end}}$, expressed in megawatts.\n  - The maximum reactor power observed over the entire transient interval $[0, t_{\\text{end}}]$, expressed in megawatts.\n\n- Express every power value in megawatts (MW) as a floating-point number rounded to six decimal places.\n\nTest suite:\n\nUse the following parameter sets to define four scenarios. For each scenario, the values of $\\beta$, $\\Lambda$, $\\lambda$, $\\eta$, $H_f$, $K_f$, $T_c$, $P(0)$, $\\rho_{\\text{ext}}$, $\\Delta t$, and $t_{\\text{end}}$ are given. Units are as specified next to each symbol.\n\n- Scenario A (general case, subprompt insertion):\n  - $\\beta = 0.0065$ (dimensionless)\n  - $\\Lambda = 1 \\times 10^{-4}$ (seconds)\n  - $\\lambda = 0.08$ (inverse seconds)\n  - $\\eta = 0.95$ (dimensionless)\n  - $H_f = 5 \\times 10^{7}$ (joules per kelvin)\n  - $K_f = 3.1666667 \\times 10^{5}$ (watts per kelvin)\n  - $T_c = 600$ (kelvin)\n  - $P(0) = 1.0 \\times 10^{8}$ (watts)\n  - $\\alpha_D = -3.0 \\times 10^{-5}$ (inverse kelvin)\n  - $\\rho_{\\text{ext}} = 0.002$ (dimensionless)\n  - $\\Delta t = 1.0 \\times 10^{-3}$ (seconds)\n  - $t_{\\text{end}} = 3.0$ (seconds)\n\n- Scenario B (near prompt-critical insertion):\n  - Same as Scenario A, except $\\rho_{\\text{ext}} = 0.006$ (dimensionless)\n\n- Scenario C (edge case, zero insertion):\n  - Same as Scenario A, except $\\rho_{\\text{ext}} = 0.0$ (dimensionless)\n\n- Scenario D (superprompt insertion moderated by feedback):\n  - Same as Scenario A, except $\\rho_{\\text{ext}} = 0.010$ (dimensionless)\n\nFinal output specification:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each scenario, output four values in order: final power under explicit coupling (MW), final power under implicit coupling (MW), maximum power under explicit coupling (MW), maximum power under implicit coupling (MW). Concatenate the results of the four scenarios in the order A, B, C, D, yielding a list of $16$ floating-point numbers. For example, the output format must be exactly like:\n  - $$\\left[\\text{A\\_final\\_explicit}, \\text{A\\_final\\_implicit}, \\text{A\\_max\\_explicit}, \\text{A\\_max\\_implicit}, \\text{B\\_final\\_explicit}, \\ldots, \\text{D\\_max\\_implicit}\\right]$$\nAll outputs must be in megawatts (MW), rounded to six decimal places, and expressed as decimal numbers without any percentage sign.",
            "solution": "The user has provided a well-posed problem in nuclear reactor physics, asking for the implementation and comparison of two numerical coupling schemes for a point kinetics model with thermal feedback. The problem is scientifically grounded, self-contained, and algorithmically specific. Therefore, a full solution is warranted.\n\nThe reactor dynamics are described by a system of three coupled ordinary differential equations (ODEs). Let $P(t)$, $C(t)$, and $T_f(t)$ denote the reactor power, precursor concentration, and fuel temperature, respectively. The time index for the discrete solution will be denoted by a subscript $n$, where $t_n = n \\Delta t$. The state variables at time $t_n$ are $P_n$, $C_n$, and $T_{f,n}$. We aim to find the state at $t_{n+1}$.\n\nThe fundamental equations provided are:\n1.  Neutron population balance:\n    $$\\frac{dP}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} P(t) + \\lambda C(t)$$\n2.  Precursor concentration balance:\n    $$\\frac{dC}{dt} = \\frac{\\beta}{\\Lambda} P(t) - \\lambda C(t)$$\n3.  Fuel thermal energy balance:\n    $$H_f \\frac{dT_f}{dt} = \\eta P(t) - K_f\\left(T_f(t) - T_c\\right)$$\n4.  Reactivity feedback:\n    $$\\rho(t) = \\rho_{\\text{ext}} + \\alpha_D \\left(T_f(t) - T_{f,0}\\right)$$\n\nThe problem specifies the use of the backward Euler method for time discretization. Applying this method to the system of ODEs, we replace $\\frac{dy}{dt}$ with $\\frac{y_{n+1} - y_n}{\\Delta t}$ and evaluate all terms on the right-hand side at time step $n+1$.\n\nFrom the precursor balance (2):\n$\\frac{C_{n+1} - C_n}{\\Delta t} = \\frac{\\beta}{\\Lambda} P_{n+1} - \\lambda C_{n+1}$\nSolving for $C_{n+1}$ yields:\n$$C_{n+1} = \\frac{C_n + \\frac{\\beta \\Delta t}{\\Lambda} P_{n+1}}{1 + \\lambda \\Delta t}$$\n\nFrom the thermal energy balance (3):\n$\\frac{T_{f,n+1} - T_{f,n}}{\\Delta t} = \\frac{1}{H_f} \\left[ \\eta P_{n+1} - K_f(T_{f,n+1} - T_c) \\right]$\nSolving for $T_{f,n+1}$ yields:\n$$T_{f,n+1} = \\frac{T_{f,n} + \\frac{K_f \\Delta t}{H_f} T_c + \\frac{\\eta \\Delta t}{H_f} P_{n+1}}{1 + \\frac{K_f \\Delta t}{H_f}}$$\n\nFrom the neutron population balance (1):\n$\\frac{P_{n+1} - P_n}{\\Delta t} = \\frac{\\rho_{n+1} - \\beta}{\\Lambda} P_{n+1} + \\lambda C_{n+1}$\nSubstituting the expression for $C_{n+1}$ and rearranging to solve for $P_{n+1}$ leads to a general expression for the new power level. After algebraic manipulation, we arrive at:\n$$P_{n+1} = \\frac{\\Lambda \\left[ P_n(1 + \\lambda \\Delta t) + \\lambda \\Delta t C_n \\right]}{\\Lambda(1 + \\lambda \\Delta t) + \\beta \\Delta t - \\rho_{n+1} \\Delta t(1 + \\lambda \\Delta t)}$$\nThe term $\\rho_{n+1}$ is where the explicit and implicit coupling schemes differ.\n\nThe initial conditions at $t=0$ are derived from the steady-state assumption ($\\frac{d}{dt} = 0$) with $\\rho_{\\text{ext}}=0$. This yields:\n-   Initial fuel temperature: $T_{f,0} = T_c + \\frac{\\eta P(0)}{K_f}$\n-   Initial precursor concentration: $C(0) = \\frac{\\beta P(0)}{\\lambda \\Lambda}$\n\nWe will now detail the implementation of both coupling schemes.\n\n**1. Explicit Coupling Scheme**\n\nIn the explicit coupling scheme, the reactivity at the new time step, $\\rho_{n+1}$, is calculated using the fuel temperature from the previous time step, $T_{f,n}$.\n$$\\rho_{n+1} = \\rho_{\\text{ext}} + \\alpha_D \\left(T_{f,n} - T_{f,0}\\right)$$\nSince $T_{f,n}$ is known, $\\rho_{n+1}$ is determined before solving for the new state vector $[P_{n+1}, C_{n+1}, T_{f,n+1}]^T$. The update procedure is sequential:\n1.  Compute reactivity: $\\rho_{n+1, \\text{exp}} = \\rho_{\\text{ext}} + \\alpha_D (T_{f,n} - T_{f,0})$.\n2.  Compute power: Substitute $\\rho_{n+1, \\text{exp}}$ into the equation for $P_{n+1}$ and solve. Since all terms in the denominator are known, this is a direct calculation.\n3.  Compute precursors and temperature: Use the newly computed $P_{n+1}$ to find $C_{n+1}$ and $T_{f,n+1}$ using their respective update equations.\n\nThis scheme is computationally simple but introduces a time lag in the thermal feedback, which can lead to inaccuracies or numerical instability, especially for large time steps or rapid transients.\n\n**2. Implicit Coupling Scheme**\n\nIn the implicit coupling scheme, the reactivity $\\rho_{n+1}$ is evaluated using the fuel temperature at the new time step, $T_{f,n+1}$.\n$$\\rho_{n+1} = \\rho_{\\text{ext}} + \\alpha_D \\left(T_{f,n+1} - T_{f,0}\\right)$$\nThis creates a fully coupled non-linear system, as $P_{n+1}$ depends on $\\rho_{n+1}$, which depends on $T_{f,n+1}$, which in turn depends on $P_{n+1}$. We can solve this system by substituting the expressions for $T_{f,n+1}$ and $\\rho_{n+1}$ into the equation for $P_{n+1}$.\n\nLet's combine the expressions:\n-   $P_{n+1} = f(\\rho_{n+1})$\n-   $\\rho_{n+1} = g(T_{f,n+1})$\n-   $T_{f,n+1} = h(P_{n+1})$\n\nSubstituting $T_{f,n+1}$ into the expression for $\\rho_{n+1}$ gives a linear relationship between $\\rho_{n+1}$ and $P_{n+1}$. Substituting this into the equation for $P_{n+1}$ results in a quadratic equation for $P_{n+1}$ of the form $a P_{n+1}^2 + b P_{n+1} + c = 0$.\n\nThe coefficients of this quadratic equation are derived as follows. Let:\n-   $A_n = \\Lambda(P_n(1+\\lambda\\Delta t) + \\lambda\\Delta t C_n)$\n-   $B = \\Lambda(1+\\lambda\\Delta t) + \\beta\\Delta t$\n-   $D = \\Delta t(1+\\lambda\\Delta t)$\n-   $E_n = \\frac{H_f T_{f,n} + K_f\\Delta t T_c}{H_f + K_f\\Delta t}$\n-   $F = \\frac{\\eta\\Delta t}{H_f + K_f\\Delta t}$\n-   $G_n = \\rho_{\\text{ext}} + \\alpha_D(E_n - T_{f,0})$\n-   $H = \\alpha_D F$\n\nThe system of equations for the unknowns $P_{n+1}$ and $\\rho_{n+1}$ is:\n$$P_{n+1} (B - D \\rho_{n+1}) = A_n$$\n$$\\rho_{n+1} = G_n + H P_{n+1}$$\nSubstituting the second equation into the first gives:\n$$P_{n+1} (B - D(G_n + H P_{n+1})) = A_n$$\n$$P_{n+1} (B - D G_n) - D H P_{n+1}^2 = A_n$$\nRearranging into standard quadratic form $a x^2 + b x + c = 0$ with $x=P_{n+1}$:\n$$(DH)P_{n+1}^2 + (DG_n - B)P_{n+1} + A_n = 0$$\nThe coefficients are:\n-   $a = DH$\n-   $b = DG_n - B$\n-   $c = A_n$\n\nSince $\\alpha_D < 0$, we have $H < 0$ and consequently $a < 0$. $A_n$ is always positive for a positive power reactor state, so $c>0$. The discriminant $b^2-4ac$ is always positive, guaranteeing two real roots. The product of the roots, $c/a$, is negative, meaning one root is positive (physical) and one is negative (non-physical). The physical power $P_{n+1}$ must be positive. The standard quadratic formula is $P_{n+1} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$. Since the denominator $2a$ is negative, to get a positive result for $P_{n+1}$, the numerator must also be negative. The term $-b - \\sqrt{b^2 - 4ac}$ is always negative, whereas $-b + \\sqrt{b^2 - 4ac}$ is always positive. Thus, we must choose the minus sign in the numerator to obtain the physical root:\n$$P_{n+1} = \\frac{-b - \\sqrt{b^2 - 4ac}}{2a} = \\frac{-(DG_n - B) - \\sqrt{(DG_n - B)^2 - 4(DH)A_n}}{2DH}$$\n\nThe implicit update procedure is:\n1.  Calculate the coefficients $a, b, c$ for the quadratic equation based on the state at time $t_n$.\n2.  Solve the quadratic equation for $P_{n+1}$ using the physical root.\n3.  Compute $C_{n+1}$ and $T_{f,n+1}$ using the new $P_{n+1}$.\n\nThis scheme correctly models the instantaneous nature of Doppler feedback and is generally more accurate and stable than the explicit scheme, especially for super-prompt critical transients.\n\nThe solution will be implemented by creating a function that executes the time-stepping loop for a given set of parameters and coupling choice, calculating the final power and tracking the maximum power throughout the transient.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the reactor transient simulations for all scenarios\n    and print the results in the specified format.\n    \"\"\"\n\n    scenarios = {\n        'A': {'rho_ext': 0.002},\n        'B': {'rho_ext': 0.006},\n        'C': {'rho_ext': 0.0},\n        'D': {'rho_ext': 0.010},\n    }\n\n    base_params = {\n        'BETA': 0.0065,        # dimensionless\n        'LAMBDA_N': 1.0e-4,    # seconds\n        'LAMBDA_C': 0.08,      # inverse seconds\n        'ETA': 0.95,           # dimensionless\n        'H_F': 5.0e7,          # joules per kelvin\n        'K_F': 3.1666667e5,    # watts per kelvin\n        'T_C': 600.0,          # kelvin\n        'P0_W': 1.0e8,         # watts\n        'ALPHA_D': -3.0e-5,    # inverse kelvin\n        'DT': 1.0e-3,          # seconds\n        'T_END': 3.0,          # seconds\n    }\n\n    results = []\n\n    for key in sorted(scenarios.keys()):\n        params = base_params.copy()\n        params.update(scenarios[key])\n\n        # Run explicit coupling simulation\n        p_final_exp, p_max_exp = run_simulation(params, 'explicit')\n        results.extend([p_final_exp, 0.0, p_max_exp, 0.0])\n\n        # Run implicit coupling simulation\n        p_final_imp, p_max_imp = run_simulation(params, 'implicit')\n        results[-3] = p_final_imp\n        results[-1] = p_max_imp\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\ndef run_simulation(params, coupling_type):\n    \"\"\"\n    Runs a single reactor transient simulation.\n    \n    Args:\n        params (dict): A dictionary of physical and numerical parameters.\n        coupling_type (str): 'explicit' or 'implicit'.\n\n    Returns:\n        tuple: A tuple containing (final_power_MW, max_power_MW).\n    \"\"\"\n    # Unpack parameters\n    BETA = params['BETA']\n    LAMBDA_N = params['LAMBDA_N']\n    LAMBDA_C = params['LAMBDA_C']\n    ETA = params['ETA']\n    H_F = params['H_F']\n    K_F = params['K_F']\n    T_C = params['T_C']\n    P0_W = params['P0_W']\n    ALPHA_D = params['ALPHA_D']\n    DT = params['DT']\n    T_END = params['T_END']\n    RHO_EXT = params['rho_ext']\n\n    # Initial conditions\n    T_F0 = T_C + ETA * P0_W / K_F\n    C0 = BETA * P0_W / (LAMBDA_C * LAMBDA_N)\n\n    # State variables\n    p_n = P0_W\n    c_n = C0\n    t_f_n = T_F0\n\n    # Simulation setup\n    n_steps = int(T_END / DT)\n    max_power = P0_W\n\n    # Time-stepping loop\n    for _ in range(n_steps):\n        if coupling_type == 'explicit':\n            # 1. Calculate reactivity using previous temperature\n            rho_n1 = RHO_EXT + ALPHA_D * (t_f_n - T_F0)\n\n            # 2. Calculate power P_{n+1}\n            numerator_p = LAMBDA_N * (p_n * (1 + LAMBDA_C * DT) + LAMBDA_C * DT * c_n)\n            denominator_p = LAMBDA_N * (1 + LAMBDA_C * DT) + BETA * DT - rho_n1 * DT * (1 + LAMBDA_C * DT)\n            p_n1 = numerator_p / denominator_p\n            \n        elif coupling_type == 'implicit':\n            # 1. Calculate coefficients for the quadratic equation a*x^2 + b*x + c = 0\n            # where x = P_{n+1}\n            An = LAMBDA_N * (p_n * (1 + LAMBDA_C * DT) + LAMBDA_C * DT * c_n)\n            B_const = LAMBDA_N * (1 + LAMBDA_C * DT) + BETA * DT\n            D_const = DT * (1 + LAMBDA_C * DT)\n            \n            En = (H_F * t_f_n + K_F * DT * T_C) / (H_F + K_F * DT)\n            F_const = (ETA * DT) / (H_F + K_F * DT)\n            \n            Gn = RHO_EXT + ALPHA_D * (En - T_F0)\n            H_const = ALPHA_D * F_const\n\n            a_quad = D_const * H_const\n            b_quad = D_const * Gn - B_const\n            c_quad = An\n            \n            # 2. Solve the quadratic equation for the physical (positive) root\n            discriminant = np.sqrt(b_quad**2 - 4 * a_quad * c_quad)\n            p_n1 = (-b_quad - discriminant) / (2 * a_quad)\n\n        else:\n            raise ValueError(\"Invalid coupling type specified.\")\n\n        # 3. Update precursor concentration C_{n+1}\n        c_n1 = (c_n + (BETA * DT / LAMBDA_N) * p_n1) / (1 + LAMBDA_C * DT)\n\n        # 4. Update fuel temperature T_{f,n+1}\n        t_f_n1 = (t_f_n + (K_F * DT / H_F) * T_C + (ETA * DT / H_F) * p_n1) / (1 + K_F * DT / H_F)\n\n        # Update state for next step\n        p_n, c_n, t_f_n = p_n1, c_n1, t_f_n1\n\n        # Track maximum power\n        if p_n > max_power:\n            max_power = p_n\n\n    # Convert final and max power from Watts to Megawatts\n    final_power_mw = p_n / 1e6\n    max_power_mw = max_power / 1e6\n\n    return final_power_mw, max_power_mw\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}