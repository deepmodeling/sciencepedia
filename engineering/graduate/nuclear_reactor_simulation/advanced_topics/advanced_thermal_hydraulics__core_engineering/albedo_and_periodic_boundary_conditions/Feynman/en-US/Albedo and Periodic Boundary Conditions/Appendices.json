{
    "hands_on_practices": [
        {
            "introduction": "To truly master computational reactor physics, one must be able to translate theoretical equations into working numerical models. This exercise provides a foundational, hands-on opportunity to implement the one-dimensional neutron diffusion equation, a cornerstone of reactor analysis. You will develop solvers using both the Finite Difference and Finite Element Methods, focusing specifically on the practical implementation of albedo (Robin) and periodic boundary conditions, thereby bridging the gap between abstract mathematical definitions and concrete computational practice.",
            "id": "4213703",
            "problem": "Consider one spatial dimension and a homogeneous, isotropic medium in which the scalar neutron flux $ \\phi(x) $ satisfies the steady-state neutron diffusion equation derived from neutron conservation and Fick's law of diffusion: \n$$ -\\frac{d}{dx}\\left(D \\frac{d \\phi}{dx}\\right) + \\Sigma_a \\phi = S, \\quad x \\in (0,L). $$\nHere $ D $ is the diffusion coefficient in units of $\\mathrm{cm}$, $ \\Sigma_a $ is the macroscopic absorption cross section in units of $\\mathrm{cm}^{-1}$, $ S $ is a constant volumetric source in units of $\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s})$, and $ L $ is the slab length in units of $\\mathrm{cm}$. The total neutron current is $ J = -D \\frac{d \\phi}{dx} $. \n\nTwo boundary condition types are considered:\n- Robin (albedo) boundary condition: $ -D \\frac{d \\phi}{dn} = r \\phi $ at a boundary point, where $ \\frac{d}{dn} $ is the outward normal derivative and $ r $ is a dimensionless albedo coefficient. This boundary condition models partial leakage with proportional return characterized by $ r $. On the left boundary at $ x = 0 $ (outward normal pointing in the negative $ x $ direction), this implies $ \\frac{d \\phi}{dx}(0) = \\frac{r_0}{D} \\phi(0) $. On the right boundary at $ x = L $ (outward normal pointing in the positive $ x $ direction), this implies $ \\frac{d \\phi}{dx}(L) = -\\frac{r_L}{D} \\phi(L) $.\n- Periodic boundary conditions: $ \\phi(0) = \\phi(L) $ and $ \\frac{d \\phi}{dx}(0) = \\frac{d \\phi}{dx}(L) $, representing a toroidal topology with translational invariance.\n\nImplement two numerical solvers for $ \\phi(x) $ on a uniform mesh:\n- Finite Difference Method (FDM): Use a second-order centered approximation for the interior and enforce the Robin boundary conditions using ghost points that ensure second-order consistency at the boundaries. For periodic boundaries, connect the first and last nodes in the discrete stencil.\n- Finite Element Method (FEM): Use the Galerkin method with piecewise linear shape functions on the same uniform partition. The weak form is obtained by multiplying the governing equation by a test function $ v $, integrating over the domain, and integrating the diffusion term by parts, yielding a bilinear form consisting of stiffness $\\int_0^L D \\frac{d \\phi}{dx}\\frac{d v}{dx}\\,dx$, absorption $\\int_0^L \\Sigma_a \\phi v \\, dx$, and source $\\int_0^L S v \\, dx$. For Robin conditions, include the boundary contribution $ \\int_{\\partial \\Omega} r \\phi v \\, d\\Gamma $, which, in one dimension, adds $ r_0 \\phi(0)v(0) $ at $ x=0 $ and $ r_L \\phi(L)v(L) $ at $ x=L $ to the global matrix. For periodic conditions, enforce $ \\phi(0) = \\phi(L) $ by merging the corresponding degrees of freedom, and enforce the periodicity of the derivative implicitly by assembling across the merged topology.\n\nYour program must construct both FDM and FEM discrete systems for each test case below, solve them, and then compute the relative discrete $ L^2 $-norm difference between the FDM and FEM flux solutions on the nodal grid:\n$$ \\delta = \\frac{\\left\\| \\phi^{\\mathrm{FDM}} - \\phi^{\\mathrm{FEM}} \\right\\|_2}{\\left\\| \\phi^{\\mathrm{FEM}} \\right\\|_2}, $$\nwhich is dimensionless. Here $ \\| \\cdot \\|_2 $ denotes the Euclidean norm over nodal values. For periodic FEM, reconstruct a nodal vector of length $ N $ by duplicating the merged degree of freedom appropriately so that the comparison with FDM is on the same set of nodal points.\n\nUse the following test suite, each specified by $ (L, N, D, \\Sigma_a, S, \\text{BC type}, r_0, r_L) $:\n- Test $1$: $ (100\\,\\mathrm{cm}, 101, 1.2\\,\\mathrm{cm}, 0.08\\,\\mathrm{cm}^{-1}, 1.0\\,\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s}), \\text{robin}, 0.0, 0.0) $.\n- Test $2$: $ (100\\,\\mathrm{cm}, 101, 1.2\\,\\mathrm{cm}, 0.08\\,\\mathrm{cm}^{-1}, 1.0\\,\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s}), \\text{robin}, 10^6, 10^6) $.\n- Test $3$: $ (100\\,\\mathrm{cm}, 101, 1.2\\,\\mathrm{cm}, 0.08\\,\\mathrm{cm}^{-1}, 1.0\\,\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s}), \\text{robin}, 0.5, 0.1) $.\n- Test $4$: $ (100\\,\\mathrm{cm}, 101, 1.2\\,\\mathrm{cm}, 0.08\\,\\mathrm{cm}^{-1}, 1.0\\,\\mathrm{n}/(\\mathrm{cm}^3\\cdot \\mathrm{s}), \\text{periodic}, -, -) $; for periodic, ignore $ r_0 $ and $ r_L $.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $ [\\delta_1,\\delta_2,\\delta_3,\\delta_4] $), where $ \\delta_i $ is the relative $ L^2 $-norm difference for test $ i $. No units are required for the output since $ \\delta_i $ is dimensionless.",
            "solution": "The problem requires the numerical solution of the one-dimensional, steady-state neutron diffusion equation for a homogeneous medium using two distinct methods: the Finite Difference Method (FDM) and the Finite Element Method (FEM). The results from both methods are to be compared for a suite of test cases involving different boundary conditions.\n\nThe governing equation is:\n$$ -D \\frac{d^2 \\phi}{dx^2} + \\Sigma_a \\phi = S, \\quad x \\in (0,L) $$\nwhere $D$, $\\Sigma_a$, and $S$ are constants. The domain is discretized using a uniform mesh of $N$ points $x_i = i h$ for $i=0, 1, \\dots, N-1$, where the mesh spacing is $h = L/(N-1)$. The unknown is the vector of nodal flux values $\\boldsymbol{\\phi} = [\\phi_0, \\phi_1, \\dots, \\phi_{N-1}]^T$, where $\\phi_i \\approx \\phi(x_i)$.\n\n### Finite Difference Method (FDM) Discretization\n\nThe FDM approximates derivatives at nodal points. For an interior node $x_i$ ($1 \\le i \\le N-2$), a second-order central difference approximation for the second derivative is used:\n$$ \\frac{d^2 \\phi}{dx^2}\\bigg|_{x_i} \\approx \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} $$\nSubstituting this into the governing equation yields the discrete equation for an interior node:\n$$ -D \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{h^2} + \\Sigma_a \\phi_i = S $$\nRearranging gives the stencil for the linear system $A^{\\text{FDM}}\\boldsymbol{\\phi} = b^{\\text{FDM}}$:\n$$ \\left(\\frac{-D}{h^2}\\right)\\phi_{i-1} + \\left(\\frac{2D}{h^2} + \\Sigma_a\\right)\\phi_i + \\left(\\frac{-D}{h^2}\\right)\\phi_{i+1} = S $$\n\n**Robin Boundary Conditions:**\nThe problem specifies Robin boundary conditions at $x=0$ and $x=L$:\n$$ \\frac{d \\phi}{dx}(0) = \\frac{r_0}{D} \\phi(0) \\quad \\text{and} \\quad \\frac{d \\phi}{dx}(L) = -\\frac{r_L}{D} \\phi(L) $$\nTo maintain second-order accuracy, we employ ghost points.\nAt $x_0=0$, we introduce a ghost point at $x_{-1} = -h$. The centered difference approximation of the derivative at $x_0$ is $\\frac{\\phi_1 - \\phi_{-1}}{2h} = \\frac{r_0}{D}\\phi_0$, which gives $\\phi_{-1} = \\phi_1 - \\frac{2hr_0}{D}\\phi_0$. We substitute this into the standard diffusion equation stencil evaluated at $i=0$:\n$$ -D \\frac{\\phi_{-1} - 2\\phi_0 + \\phi_1}{h^2} + \\Sigma_a \\phi_0 = S \\implies -D \\frac{(\\phi_1 - \\frac{2hr_0}{D}\\phi_0) - 2\\phi_0 + \\phi_1}{h^2} + \\Sigma_a \\phi_0 = S $$\nThis simplifies to the first row of the linear system:\n$$ \\left(\\frac{2D}{h^2} + \\frac{2r_0}{h} + \\Sigma_a\\right)\\phi_0 - \\frac{2D}{h^2}\\phi_1 = S $$\nSimilarly, at $x_{N-1}=L$, a ghost point at $x_N=L+h$ yields the last row of the system:\n$$ -\\frac{2D}{h^2}\\phi_{N-2} + \\left(\\frac{2D}{h^2} + \\frac{2r_L}{h} + \\Sigma_a\\right)\\phi_{N-1} = S $$\nThe resulting system is an $N \\times N$ tridiagonal system. The source vector $b^{\\text{FDM}}$ is a vector with all entries equal to $S$.\n\n**Periodic Boundary Conditions:**\nThe conditions are $\\phi(0) = \\phi(L)$ and $\\phi'(0) = \\phi'(L)$. On the discrete grid, this means $\\phi_0 = \\phi_{N-1}$. This reduces the number of independent unknowns to $N-1$. We solve for $\\tilde{\\boldsymbol{\\phi}} = [\\phi_0, \\dots, \\phi_{N-2}]^T$. The periodicity implies that the neighbor to the left of node $0$ is node $N-2$, and the neighbor to the right of node $N-2$ is node $0$. The stencil at $i=0$ becomes:\n$$ \\left(\\frac{-D}{h^2}\\right)\\phi_{N-2} + \\left(\\frac{2D}{h^2} + \\Sigma_a\\right)\\phi_0 + \\left(\\frac{-D}{h^2}\\right)\\phi_1 = S $$\nAnd at $i=N-2$:\n$$ \\left(\\frac{-D}{h^2}\\right)\\phi_{N-3} + \\left(\\frac{2D}{h^2} + \\Sigma_a\\right)\\phi_{N-2} + \\left(\\frac{-D}{h^2}\\right)\\phi_0 = S $$\nThis results in an $(N-1) \\times (N-1)$ circulant tridiagonal system. After solving for $\\tilde{\\boldsymbol{\\phi}}$, the full $N$-point solution vector is reconstructed as $\\boldsymbol{\\phi}^{\\text{FDM}} = [\\phi_0, \\dots, \\phi_{N-2}, \\phi_0]^T$.\n\n### Finite Element Method (FEM) Discretization\n\nThe FEM is applied using the Galerkin method. We multiply the diffusion equation by a test function $v(x)$ and integrate over the domain $[0, L]$. Integrating the diffusion term by parts gives the weak form:\n$$ \\int_0^L D \\frac{d\\phi}{dx} \\frac{dv}{dx} \\,dx + \\int_0^L \\Sigma_a \\phi v \\,dx - \\left[D \\frac{d\\phi}{dx} v\\right]_0^L = \\int_0^L S v \\,dx $$\nSubstituting the Robin boundary conditions, $D\\frac{d\\phi}{dx}(0) = r_0\\phi(0)$ and $-D\\frac{d\\phi}{dx}(L) = r_L\\phi(L)$, yields:\n$$ \\underbrace{\\int_0^L D \\frac{d\\phi}{dx} \\frac{dv}{dx} \\,dx + \\int_0^L \\Sigma_a \\phi v \\,dx + r_L \\phi(L)v(L) + r_0 \\phi(0)v(0)}_{a(\\phi, v)} = \\underbrace{\\int_0^L S v \\,dx}_{l(v)} $$\nThe flux $\\phi(x)$ is approximated by a linear combination of piecewise linear basis functions (\"hat\" functions) $\\psi_j(x)$, such that $\\phi(x) \\approx \\sum_{j=0}^{N-1} \\phi_j \\psi_j(x)$, where $\\psi_j(x_i) = \\delta_{ij}$. Using these basis functions also as test functions ($v = \\psi_i$), we obtain the linear system $A^{\\text{FEM}}\\boldsymbol{\\phi} = b^{\\text{FEM}}$, where $A_{ij} = a(\\psi_j, \\psi_i)$ and $b_i = l(\\psi_i)$.\n\nOn a uniform grid, the element stiffness matrix $K^e$, mass matrix $M^e$, and source vector $F^e$ for an element of length $h$ are:\n$$ K^e = \\frac{D}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}, \\quad M^e = \\frac{\\Sigma_a h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}, \\quad F^e = \\frac{Sh}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\nThe global matrices are assembled by summing these elemental contributions.\n\n**Robin Boundary Conditions:**\nThe system is $N \\times N$. The assembled matrix $A^{\\text{FEM}}$ is tridiagonal and symmetric.\nFor an interior row $i$:\n$$ \\left(-\\frac{D}{h} + \\frac{h\\Sigma_a}{6}\\right)\\phi_{i-1} + \\left(\\frac{2D}{h} + \\frac{2h\\Sigma_a}{3}\\right)\\phi_i + \\left(-\\frac{D}{h} + \\frac{h\\Sigma_a}{6}\\right)\\phi_{i+1} = Sh $$\nThe boundary terms from the weak form, $r_0\\phi(0)v(0)$ and $r_L\\phi(L)v(L)$, contribute only to the diagonal elements for the boundary nodes. Specifically, $r_0$ is added to $A_{00}$ and $r_L$ is added to $A_{N-1,N-1}$. The source vector entries are $b_i = Sh$ for interior nodes and $b_i = Sh/2$ for boundary nodes.\nThe full boundary equations are:\n$$ i=0: \\left(\\frac{D}{h} + \\frac{h\\Sigma_a}{3} + r_0\\right)\\phi_0 + \\left(-\\frac{D}{h} + \\frac{h\\Sigma_a}{6}\\right)\\phi_1 = \\frac{Sh}{2} $$\n$$ i=N-1: \\left(-\\frac{D}{h} + \\frac{h\\Sigma_a}{6}\\right)\\phi_{N-2} + \\left(\\frac{D}{h} + \\frac{h\\Sigma_a}{3} + r_L\\right)\\phi_{N-1} = \\frac{Sh}{2} $$\n\n**Periodic Boundary Conditions:**\nDegrees of freedom for nodes $0$ and $N-1$ are merged, resulting in an $(N-1) \\times (N-1)$ system for $\\tilde{\\boldsymbol{\\phi}} = [\\phi_0, \\dots, \\phi_{N-2}]^T$. The assembly process connects node $N-2$ with node $0$, resulting in a symmetric, circulant tridiagonal matrix. The diagonal entries are $A_{ii} = \\frac{2D}{h} + \\frac{2h\\Sigma_a}{3}$, and the off-diagonal entries are $A_{i, i\\pm 1} = -\\frac{D}{h} + \\frac{h\\Sigma_a}{6}$ (with wrap-around for the corner elements). The source vector entries are all $b_i = Sh$. After solving, the full solution vector is reconstructed as $\\boldsymbol{\\phi}^{\\text{FEM}} = [\\phi_0, \\dots, \\phi_{N-2}, \\phi_0]^T$.\n\n### Solution Comparison\n\nFor each test case, the FDM and FEM systems are constructed and solved. The resulting nodal flux vectors, $\\boldsymbol{\\phi}^{\\text{FDM}}$ and $\\boldsymbol{\\phi}^{\\text{FEM}}$, are then used to compute the relative discrete $L^2$-norm difference:\n$$ \\delta = \\frac{\\left\\| \\boldsymbol{\\phi}^{\\mathrm{FDM}} - \\boldsymbol{\\phi}^{\\mathrm{FEM}} \\right\\|_2}{\\left\\| \\boldsymbol{\\phi}^{\\mathrm{FEM}} \\right\\|_2} = \\frac{\\sqrt{\\sum_{i=0}^{N-1} (\\phi_i^{\\mathrm{FDM}} - \\phi_i^{\\mathrm{FEM}})^2}}{\\sqrt{\\sum_{i=0}^{N-1} (\\phi_i^{\\mathrm{FEM}})^2}} $$\nThis metric quantifies the discrepancy between the two numerical solutions on the nodal grid.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve_fdm(L, N, D, Sigma_a, S, bc_type, r0, rL):\n    \"\"\"\n    Solves the 1D neutron diffusion equation using the Finite Difference Method.\n    \"\"\"\n    h = L / (N - 1)\n    \n    if bc_type == 'robin':\n        A = np.zeros((N, N))\n        b = np.full(N, S)\n        \n        # Interior points\n        c1 = -D / h**2\n        c2 = 2 * D / h**2 + Sigma_a\n        for i in range(1, N - 1):\n            A[i, i-1] = c1\n            A[i, i] = c2\n            A[i, i+1] = c1\n            \n        # Boundary at x=0\n        A[0, 0] = 2 * D / h**2 + 2 * r0 / h + Sigma_a\n        A[0, 1] = -2 * D / h**2\n        \n        # Boundary at x=L\n        A[N-1, N-2] = -2 * D / h**2\n        A[N-1, N-1] = 2 * D / h**2 + 2 * rL / h + Sigma_a\n        \n        phi = np.linalg.solve(A, b)\n        return phi\n\n    elif bc_type == 'periodic':\n        num_unknowns = N - 1\n        A = np.zeros((num_unknowns, num_unknowns))\n        b = np.full(num_unknowns, S)\n        \n        c1 = -D / h**2\n        c2 = 2 * D / h**2 + Sigma_a\n        \n        for i in range(num_unknowns):\n            A[i, i] = c2\n            A[i, (i - 1 + num_unknowns) % num_unknowns] += c1\n            A[i, (i + 1) % num_unknowns] += c1\n\n        phi_tilde = np.linalg.solve(A, b)\n        phi = np.append(phi_tilde, phi_tilde[0])\n        return phi\n\n    return None\n\ndef solve_fem(L, N, D, Sigma_a, S, bc_type, r0, rL):\n    \"\"\"\n    Solves the 1D neutron diffusion equation using the Finite Element Method.\n    \"\"\"\n    h = L / (N - 1)\n    \n    if bc_type == 'robin':\n        A = np.zeros((N, N))\n        b = np.zeros(N)\n        \n        # Interior points\n        diag = 2 * D / h + 2 * h * Sigma_a / 3\n        off_diag = -D / h + h * Sigma_a / 6\n        \n        for i in range(1, N - 1):\n            A[i, i-1] = off_diag\n            A[i, i] = diag\n            A[i, i+1] = off_diag\n            b[i] = S * h\n            \n        # Boundary at x=0\n        A[0, 0] = D / h + h * Sigma_a / 3 + r0\n        A[0, 1] = off_diag\n        b[0] = S * h / 2\n        \n        # Boundary at x=L\n        A[N-1, N-2] = off_diag\n        A[N-1, N-1] = D / h + h * Sigma_a / 3 + rL\n        b[N-1] = S * h / 2\n        \n        phi = np.linalg.solve(A, b)\n        return phi\n\n    elif bc_type == 'periodic':\n        num_unknowns = N - 1\n        A = np.zeros((num_unknowns, num_unknowns))\n        b = np.full(num_unknowns, S * h)\n\n        diag = 2 * D / h + 2 * h * Sigma_a / 3\n        off_diag = -D / h + h * Sigma_a / 6\n\n        for i in range(num_unknowns):\n            A[i, i] = diag\n            A[i, (i - 1 + num_unknowns) % num_unknowns] += off_diag\n            A[i, (i + 1) % num_unknowns] += off_diag\n            \n        phi_tilde = np.linalg.solve(A, b)\n        phi = np.append(phi_tilde, phi_tilde[0])\n        return phi\n\n    return None\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, N, D, Sigma_a, S, bc_type, r0, rL)\n        (100.0, 101, 1.2, 0.08, 1.0, 'robin', 0.0, 0.0),\n        (100.0, 101, 1.2, 0.08, 1.0, 'robin', 1e6, 1e6),\n        (100.0, 101, 1.2, 0.08, 1.0, 'robin', 0.5, 0.1),\n        (100.0, 101, 1.2, 0.08, 1.0, 'periodic', None, None),\n    ]\n\n    results = []\n    for L, N, D, Sigma_a, S, bc_type, r0, rL in test_cases:\n        phi_fdm = solve_fdm(L, N, D, Sigma_a, S, bc_type, r0, rL)\n        phi_fem = solve_fem(L, N, D, Sigma_a, S, bc_type, r0, rL)\n        \n        # Compute relative discrete L2-norm difference\n        diff_norm = np.linalg.norm(phi_fdm - phi_fem)\n        fem_norm = np.linalg.norm(phi_fem)\n        \n        relative_diff = diff_norm / fem_norm\n        results.append(relative_diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building on a numerical foundation, we now turn to the analytical techniques that underpin our understanding of reactor criticality. This practice challenges you to solve the two-dimensional neutron diffusion equation for the geometric buckling, $B^2$, in a domain representing a single repeating lattice cell. The problem uniquely combines periodic and albedo boundary conditions, mirroring the complex environment of a fuel assembly within a larger core, and sharpens essential skills in separation of variables and solving the resulting eigenvalue problem.",
            "id": "4213712",
            "problem": "Consider a homogeneous, steady-state, one-speed neutron field in a two-dimensional rectangular domain representing a repeating lattice cell. Let the spatial coordinates be $x \\in [-L/2, L/2]$ and $y \\in [0, H]$. The medium has constant diffusion coefficient $D$ and one-speed material properties. Starting from neutron balance and Fick's law ($\\mathbf{J} = -D \\nabla \\phi$), the steady one-group diffusion equation for the flux shape $\\phi(x,y)$ under critical conditions ($k = 1$) reduces to a Helmholtz form of the shape equation\n$$\n\\nabla^{2} \\phi + B^{2} \\phi = 0,\n$$\nwhere $B^{2}$ is the (yet unknown) geometric buckling. The boundary conditions are:\n- Along $y = 0$ and $y = H$, enforce a Floquet-type Periodic Boundary Condition (PBC) with phase shift $\\theta$, namely $\\phi(x, y+H) = \\phi(x, y) \\exp(i \\theta)$ and $\\partial \\phi/\\partial y (x, y+H) = \\exp(i \\theta) \\, \\partial \\phi/\\partial y (x, y)$. In this problem, set $\\theta = \\pi$ radians.\n- Along $x = \\pm L/2$, impose an Albedo Boundary Condition (ABC) modeled in diffusion as a Robin boundary condition derived from the generalized albedo concept: $D \\, \\partial \\phi/\\partial n + h \\, \\phi = 0$, where $\\partial/\\partial n$ is the derivative along the outward normal and $h$ is a known, geometry- and material-dependent dimensionless surface parameter obtained from transport-to-diffusion matching.\n\nAssume separation of variables and determine the lowest admissible geometric buckling $B^{2}$ consistent with these boundary conditions. Use the following physically plausible parameters:\n- $L = 0.50~\\mathrm{m}$,\n- $H = 0.30~\\mathrm{m}$,\n- $D = 0.030~\\mathrm{m}$,\n- $h = 0.060$,\n- $\\theta = \\pi$ radians.\n\nProvide the final $B^{2}$ value in $\\mathrm{m}^{-2}$ and round your answer to four significant figures.",
            "solution": "The problem requires the determination of the lowest admissible geometric buckling, $B^2$, for a neutron flux distribution $\\phi(x,y)$ within a two-dimensional rectangular domain. The governing equation is the steady-state, one-group neutron diffusion equation, which for a critical system ($k=1$) assumes the Helmholtz form:\n$$\n\\nabla^{2} \\phi + B^{2} \\phi = 0 \\quad \\implies \\quad \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} + B^2 \\phi = 0\n$$\nThe domain is defined by the spatial coordinates $x \\in [-L/2, L/2]$ and $y \\in [0, H]$. The problem is to be solved using the method of separation of variables, for which we postulate a solution of the form $\\phi(x,y) = X(x)Y(y)$. Substituting this into the Helmholtz equation and subsequently dividing by the product $X(x)Y(y)$ yields:\n$$\n\\frac{1}{X(x)}\\frac{d^2 X}{dx^2} + \\frac{1}{Y(y)}\\frac{d^2 Y}{dy^2} + B^2 = 0\n$$\nSince the first term is a function of $x$ alone and the second term is a function of $y$ alone, their sum can only be a constant ($-B^2$) if each term is itself a constant. We define these separation constants as $-B_x^2$ and $-B_y^2$:\n$$\n\\frac{1}{X(x)}\\frac{d^2 X}{dx^2} = -B_x^2 \\quad \\implies \\quad \\frac{d^2 X}{dx^2} + B_x^2 X = 0\n$$\n$$\n\\frac{1}{Y(y)}\\frac{d^2 Y}{dy^2} = -B_y^2 \\quad \\implies \\quad \\frac{d^2 Y}{dy^2} + B_y^2 Y = 0\n$$\nThe total geometric buckling is the algebraic sum of these component bucklings: $B^2 = B_x^2 + B_y^2$. To find the lowest overall buckling, we must solve these two ordinary differential equations (ODEs), subject to their respective boundary conditions, to find the lowest permissible eigenvalues $B_x^2$ and $B_y^2$. We have shown through analysis that both $B_x^2$ and $B_y^2$ must be positive.\n\nWe first analyze the $y$-dimension. The ODE is $Y''(y) + B_y^2 Y(y) = 0$. The boundary condition is a Floquet-type PBC with a phase shift of $\\theta = \\pi$. This implies $\\phi(x, y+H) = \\phi(x, y) \\exp(i\\pi) = -\\phi(x, y)$, which, for the separated function $Y(y)$, becomes an anti-periodic boundary condition:\n$$\nY(y+H) = -Y(y)\n$$\nThe general solution to the ODE is $Y(y) = A \\exp(iB_y y) + C \\exp(-iB_y y)$. Applying the anti-periodic condition requires that $\\exp(iB_y H) = -1$. This equality implies that $B_y H$ must be an odd integer multiple of $\\pi$:\n$$\nB_y H = (2n+1)\\pi, \\quad n \\in \\{0, 1, 2, \\dots\\}\n$$\nThe buckling component in the $y$-direction is thus $B_y^2 = \\left(\\frac{(2n+1)\\pi}{H}\\right)^2$. The lowest possible positive value for $B_y^2$ is found by taking the fundamental mode, corresponding to $n=0$:\n$$\nB_y^2 = \\left(\\frac{\\pi}{H}\\right)^2\n$$\nSubstituting the given value $H = 0.30~\\mathrm{m}$:\n$$\nB_y^2 = \\left(\\frac{\\pi}{0.30}\\right)^2 \\approx (10.4719755)^2 \\approx 109.66228~\\mathrm{m}^{-2}\n$$\nNext, we analyze the $x$-dimension. The ODE is $X''(x) + B_x^2 X(x) = 0$. The Albedo Boundary Conditions are $D \\, \\partial \\phi/\\partial n + h \\, \\phi = 0$.\nAt $x = L/2$, the outward normal vector is in the $+x$ direction, so $\\partial/\\partial n = \\partial/\\partial x$. The condition on $X(x)$ is $D X'(L/2) + h X(L/2) = 0$.\nAt $x = -L/2$, the outward normal is in the $-x$ direction, so $\\partial/\\partial n = -\\partial/\\partial x$. The condition is $-D X'(-L/2) + h X(-L/2) = 0$, which is equivalent to $D X'(-L/2) - h X(-L/2) = 0$.\nThe general solution to the ODE is $X(x) = C_1 \\cos(B_x x) + C_2 \\sin(B_x x)$. The symmetry of the domain and boundary conditions allows for separate consideration of even and odd solutions.\nFor an even solution, $X(x) = C_1 \\cos(B_x x)$, which has derivative $X'(x) = -C_1 B_x \\sin(B_x x)$. Applying the boundary condition at $x = L/2$ gives $-D C_1 B_x \\sin(B_x L/2) + h C_1 \\cos(B_x L/2) = 0$. For a non-trivial solution ($C_1 \\neq 0$), this simplifies to the transcendental equation:\n$$\nD B_x \\tan\\left(\\frac{B_x L}{2}\\right) = h\n$$\nFor an odd solution, $X(x) = C_2 \\sin(B_x x)$, with derivative $X'(x) = C_2 B_x \\cos(B_x x)$. The boundary condition at $x=L/2$ yields $D C_2 B_x \\cos(B_x L/2) + h C_2 \\sin(B_x L/2) = 0$. For $C_2 \\neq 0$, this gives:\n$$\nD B_x \\cot\\left(\\frac{B_x L}{2}\\right) = -h\n$$\nTo find the lowest eigenvalue $B_x^2$, we must find the smallest positive value of $B_x$ that satisfies either of these two equations. Let $\\eta = B_x L/2$. The equations become:\nEven modes: $\\tan(\\eta) = \\frac{hL}{2D} \\frac{1}{\\eta}$\nOdd modes: $\\tan(\\eta) = -\\frac{2D}{hL} \\eta$\nSince $D$, $h$, and $L$ are all positive, a graphical analysis shows that the smallest positive root $\\eta$ for the even-mode equation lies in the interval $(0, \\pi/2)$, whereas the smallest positive root for the odd-mode equation lies in $(\\pi/2, \\pi)$. Therefore, the fundamental mode, which corresponds to the lowest eigenvalue $B_x^2$, is an even solution.\nWe solve the characteristic equation for the even modes: $D B_x \\tan(B_x L/2) = h$. Let $\\eta = B_x L/2$. The equation can be rearranged by substituting $B_x = 2\\eta/L$:\n$$\n\\tan(\\eta) = \\frac{h}{D B_x} = \\frac{h}{D(2\\eta/L)} = \\left(\\frac{hL}{2D}\\right) \\frac{1}{\\eta}\n$$\nThis yields the transcendental equation $\\eta\\tan(\\eta) = \\frac{hL}{2D}$. We substitute the given parameters ($L=0.50~\\mathrm{m}$, $D=0.030~\\mathrmm$, and $h=0.060$) to find the dimensionless constant:\n$$\n\\frac{hL}{2D} = \\frac{0.060 \\times 0.50}{2 \\times 0.030} = \\frac{0.030}{0.060} = 0.5\n$$\nTherefore, we must solve the equation $\\eta\\tan(\\eta) = 0.5$ numerically. The lowest positive root is found to be:\n$$\n\\eta \\approx 0.653031\n$$\nFrom this, we calculate $B_x$ and $B_x^2$:\n$$\nB_x = \\frac{2\\eta}{L} = \\frac{2 \\times 0.653031}{0.50} = 4 \\times 0.653031 \\approx 2.612124~\\mathrm{m}^{-1}\n$$\n$$\nB_x^2 = (2.612124)^2 \\approx 6.82319~\\mathrm{m}^{-2}\n$$\nThe total geometric buckling $B^2$ is the sum of the components:\n$$\nB^2 = B_x^2 + B_y^2 \\approx 6.82319~\\mathrm{m}^{-2} + 109.66228~\\mathrm{m}^{-2} = 116.48547~\\mathrm{m}^{-2}\n$$\nThe problem requires the result to be rounded to four significant figures.\n$$\nB^2 \\approx 116.5~\\mathrm{m}^{-2}\n$$",
            "answer": "$$\n\\boxed{116.5}\n$$"
        },
        {
            "introduction": "An expert in reactor simulation must not only know how to solve equations but also which equations to solve. This practice moves from calculation to critical evaluation, asking you to determine the physical scenarios where a sophisticated albedo boundary condition provides more accurate results than a simplified buckling model . By analyzing various realistic core environments, you will develop the crucial judgment needed to select the appropriate level of modeling fidelity for complex problems, particularly those involving strong spatial and spectral variations over the fuel cycle.",
            "id": "4232740",
            "problem": "A lattice physics depletion calculation for a single fuel assembly in a Pressurized Water Reactor (PWR) must capture the influence of the surrounding core environment on the intra-assembly neutron spectrum as isotopic compositions evolve with burnup. Consider a multi-group steady-state neutron transport description in an assembly domain $\\Omega$ with outward unit normal $\\mathbf{n}$ on the boundary $\\partial \\Omega$. The angular flux $\\psi(\\mathbf{r}, \\mathbf{\\Omega}, E)$ satisfies the neutron transport equation with streaming, removal, and scattering/fission sources that are standard in reactor physics. To represent the environment, two widely used approaches are:\n\n$1.$ A scalar buckling leakage equivalence, which in diffusion form replaces the leakage operator for group $g$ by $-\\nabla \\cdot D_g \\nabla \\phi_g(\\mathbf{r}) \\mapsto -\\nabla \\cdot D_g \\nabla \\phi_g(\\mathbf{r}) - D_g B^2 \\phi_g(\\mathbf{r})$, where $D_g$ is the group diffusion coefficient, $\\phi_g(\\mathbf{r})$ is the group scalar flux, and $B^2$ is a core-wide curvature parameter assumed spatially and spectrally uniform within the assembly.\n\n$2.$ An albedo coupling to the environment. In transport form, this imposes a returning probability for outgoing angular flux at $\\partial \\Omega$, such as $\\psi^{-}_g(\\mathbf{r}, \\mathbf{\\Omega}, E) = a_g(\\mathbf{r}, \\mathbf{\\Omega}, E) \\, \\psi^{+}_g(\\mathbf{r}, \\mathbf{\\Omega}, E)$ for directions $\\mathbf{\\Omega}$ pointing into $\\Omega$, with $a_g$ potentially dependent on energy, angle, location, and burnup state of the surrounding core. In diffusion form, this reduces to a Robin-type boundary condition $-D_g \\, \\partial \\phi_g / \\partial n = \\alpha_g \\, \\phi_g$ on $\\partial \\Omega$, where $\\partial \\phi_g / \\partial n$ is the normal derivative and $\\alpha_g$ is a group-dependent coupling coefficient.\n\nAssume burnup calculations require accurate prediction of reaction rates $R_g = \\int_{\\Omega} \\Sigma_{x,g}(\\mathbf{r}) \\, \\phi_g(\\mathbf{r}) \\, \\mathrm{d}V$ for a set of reactions with cross sections $\\Sigma_{x,g}(\\mathbf{r})$, and the infinite-medium multiplication factor $k_{\\infty}$ inferred from intra-assembly fluxes. Starting from the neutron balance and boundary coupling definitions above, reason about the spectral and spatial fidelity of each environment model. Under which of the following conditions will an albedo coupling to the core environment generally yield lower error in burnup-dependent reaction rates and $k_{\\infty}$ than a scalar buckling-based leakage correction?\n\nA. The target assembly is adjacent to a strong reflector and water gaps, and neighboring control rods are partially inserted during part of the cycle, producing energy-dependent backscattering and marked angular anisotropy in leakage that evolves with burnup.\n\nB. The core is radially uniform, very large, and exhibits small net leakage; scattering is nearly isotropic, no control materials are present, and moderator conditions are fixed so that curvature can be approximated as spatially and spectrally uniform.\n\nC. Thermal-hydraulic feedback causes the moderator density and temperature to vary with burnup around the assembly boundary, leading to local spectral hardening or softening and group-dependent returning currents that change in time.\n\nD. Mixed Oxide (MOX) and Uranium Dioxide (UO$_2$) assemblies are interleaved, producing persistent inter-assembly spectral gradients and non-separable flux shapes near boundaries over burnup.\n\nE. The assembly is modeled as an infinite lattice with vacuum boundary conditions and no nearby heterogeneities; leakage is treated as zero incoming flux at $\\partial \\Omega$ and curvature is uniform throughout.\n\nSelect all that apply.",
            "solution": "The user wants a critical evaluation of two common models in lattice physics depletion calculations—scalar buckling and albedo coupling—to determine the conditions under which the albedo approach is more accurate.\n\n### Step 1: Extract Givens\n\n-   **Context**: Lattice physics depletion calculation for a single Pressurized Water Reactor (PWR) fuel assembly.\n-   **Objective**: Accurately predict burnup-dependent reaction rates, $R_g$, and the infinite-medium multiplication factor, $k_{\\infty}$, by modeling the influence of the surrounding core environment.\n-   **Model 1 (Scalar Buckling)**: A volumetric leakage model applied to the neutron diffusion equation.\n    -   The leakage operator $-\\nabla \\cdot D_g \\nabla \\phi_g(\\mathbf{r})$ is modified to $-\\nabla \\cdot D_g \\nabla \\phi_g(\\mathbf{r}) - D_g B^2 \\phi_g(\\mathbf{r})$.\n    -   $D_g$ is the group $g$ diffusion coefficient.\n    -   $\\phi_g(\\mathbf{r})$ is the group $g$ scalar flux.\n    -   $B^2$ is the buckling parameter, explicitly defined as a \"core-wide curvature parameter assumed spatially and spectrally uniform within the assembly.\"\n-   **Model 2 (Albedo Coupling)**: A boundary condition model.\n    -   Transport Form: The incoming angular flux $\\psi^{-}$ is related to the outgoing angular flux $\\psi^{+}$ at the boundary $\\partial \\Omega$ by $\\psi^{-}_g = a_g \\, \\psi^{+}_g$. The albedo, $a_g$, can depend on energy ($E$), angle ($\\mathbf{\\Omega}$), location ($\\mathbf{r} \\in \\partial \\Omega$), and burnup state.\n    -   Diffusion Form: A Robin-type boundary condition, $-D_g \\, \\partial \\phi_g / \\partial n = \\alpha_g \\, \\phi_g$ on $\\partial \\Omega$, where $\\alpha_g$ is a group-dependent coupling coefficient.\n-   **Question**: Identify the conditions under which the albedo coupling model (Model 2) provides a more accurate prediction of $R_g$ and $k_{\\infty}$ than the scalar buckling model (Model 1).\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem statement is scientifically sound, well-posed, and objective.\n\n1.  **Scientifically Grounded**: The problem describes two standard, established methods used in nuclear reactor core analysis to approximate the neutronic environment for a single assembly calculation. The underlying physics concepts—neutron transport, diffusion theory, depletion, buckling, albedo, reaction rates, and $k_{\\infty}$—are cornerstones of reactor physics. The descriptions are accurate and free of pseudoscience.\n2.  **Well-Posed**: The question asks for a qualitative comparison of the fidelity of two models under different physical scenarios. This is a standard exercise in engineering and applied physics, where one must understand the assumptions and limitations of different models. A definitive, reasoned answer can be constructed based on these principles.\n3.  **Objective**: The descriptions of the models and physical scenarios are technical and unambiguous. The question seeks an objective assessment of model accuracy based on physical principles, not subjective opinion.\n\nThe problem contains no scientific or factual unsoundness, is formalizable, is directly relevant to the stated topic, is self-contained, is physically realistic, and is well-structured.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be derived by analyzing the fundamental assumptions of each model and evaluating their applicability to the scenarios presented in the options.\n\n### Solution and Option Analysis\n\nThe fundamental difference between the two models lies in how they represent neutron leakage.\n\nThe **scalar buckling model** is a volumetric approach based on strong simplifying assumptions. It presumes that the net leakage from the assembly can be approximated by a spatially uniform removal term proportional to the local flux, $-D_g B^2 \\phi_g(\\mathbf{r})$. The key assumption, as stated, is that the buckling parameter $B^2$ is *spatially and spectrally uniform*. This implies that the environment is homogeneous and that the leakage character does not vary significantly with neutron energy or location within the assembly. This model is most appropriate for an assembly situated deep within a large, uniform core, far from any heterogeneities, where the flux shape can be considered separable and well-described by a global fundamental mode.\n\nThe **albedo coupling model** is a surface-based approach. It explicitly models the reflection of neutrons at the assembly's physical boundary, $\\partial \\Omega$. Its key advantage is flexibility. The albedo, $a_g$ (or the related coefficient $\\alpha_g$), can be specified as a function of energy group, location on the boundary, angle of incidence, and burnup. This allows it to capture complex, non-uniform boundary effects, such as different types of neighboring assemblies, energy-dependent reflection from a reflector, or anisotropic streaming through water gaps.\n\nThe albedo model will generally be more accurate than the scalar buckling model in any situation where the buckling model's core assumptions of spatial and spectral uniformity are significantly violated. This occurs in the presence of strong environmental heterogeneities that impose non-uniform, energy-dependent, or anisotropic conditions at the assembly boundary.\n\nWe now evaluate each option against this principle.\n\n**A. The target assembly is adjacent to a strong reflector and water gaps, and neighboring control rods are partially inserted during part of the cycle, producing energy-dependent backscattering and marked angular anisotropy in leakage that evolves with burnup.**\nThis scenario presents multiple, strong violations of the buckling model's assumptions:\n-   **Strong reflector**: A reflector returns a much softer (more thermal) neutron spectrum than it receives. This makes the returning neutron current highly *energy-dependent*. A spectrally uniform $B^2$ cannot model this. An albedo model with group-dependent $a_g$ is required.\n-   **Water gaps**: These facilitate neutron streaming, a transport effect characterized by strong *angular anisotropy* in the neutron flux. An albedo model in its transport form can capture this, whereas a diffusion-based buckling model cannot.\n-   **Neighboring control rods**: These are strong, localized thermal neutron absorbers, creating severe spatial and spectral gradients at the boundary. The boundary condition changes drastically in the vicinity of the rod.\n-   **Evolves with burnup**: The partial insertion of control rods and the depletion of neighbors mean the boundary conditions are *time-dependent*. An albedo model can use burnup-dependent coefficients to track this evolution. A constant $B^2$ cannot.\nThis is a classic example of a complex environment where the detailed boundary treatment of the albedo model is necessary for accuracy.\n**Verdict: Correct.**\n\n**B. The core is radially uniform, very large, and exhibits small net leakage; scattering is nearly isotropic, no control materials are present, and moderator conditions are fixed so that curvature can be approximated as spatially and spectrally uniform.**\nThis scenario describes the ideal conditions for the applicability of the buckling model. In a large, uniform (asymptotic) medium, the flux is well-approximated by a fundamental mode solution of the diffusion equation, for which a single, constant buckling parameter $B^2$ is the correct representation of leakage. The environment is homogeneous and predictable. The added complexity of an albedo model would offer negligible improvement in accuracy. This is the scenario where the buckling model is expected to perform best, not worse.\n**Verdict: Incorrect.**\n\n**C. Thermal-hydraulic feedback causes the moderator density and temperature to vary with burnup around the assembly boundary, leading to local spectral hardening or softening and group-dependent returning currents that change in time.**\nThis scenario introduces heterogeneity at the boundary that evolves with time (burnup).\n-   **Varying moderator density and temperature**: Changes in moderator properties directly alter its neutron scattering and reflection characteristics. This leads to a boundary condition that is not spatially uniform.\n-   **Local spectral hardening or softening**: This is an explicitly *energy-dependent* effect.\n-   **Group-dependent returning currents that change in time**: This statement perfectly encapsulates a situation requiring an albedo model. The reflective properties of the boundary are both group-dependent ($a_g$) and burnup-dependent ($a_g(t)$). A single, constant $B^2$ is incapable of capturing these localized, evolving spectral effects at the boundary.\n**Verdict: Correct.**\n\n**D. Mixed Oxide (MOX) and Uranium Dioxide (UO$_2$) assemblies are interleaved, producing persistent inter-assembly spectral gradients and non-separable flux shapes near boundaries over burnup.**\nThis scenario involves strong heterogeneity from dissimilar neighboring fuel types.\n-   **MOX and UO$_2$ assemblies**: These fuel types have vastly different neutron spectra. MOX fuel has a harder spectrum with significant plutonium resonances, while UO$_2$ has a softer spectrum.\n-   **Interleaved**: An assembly may be adjacent to a MOX assembly on one face and a UO$_2$ assembly on another. This creates strong, *spatially non-uniform* and *spectrally-dependent* boundary conditions. There will be a net current of fast neutrons from MOX to UO$_2$ and thermal neutrons from UO$_2$ to MOX.\n-   **Non-separable flux shapes**: The assumption of flux separability, which underlies the buckling model, breaks down at the interface between dissimilar materials. The flux shape and spectrum are strongly coupled.\nA single $B^2$ cannot represent this complex, face-dependent spectral exchange. An albedo model, with distinct, group-dependent boundary conditions on each face, is necessary to model the environment accurately.\n**Verdict: Correct.**\n\n**E. The assembly is modeled as an infinite lattice with vacuum boundary conditions and no nearby heterogeneities; leakage is treated as zero incoming flux at $\\partial \\Omega$ and curvature is uniform throughout.**\nThis option is problematic. \"Infinite lattice\" implies periodic or reflective boundary conditions (zero net current), while \"vacuum boundary conditions\" ($\\psi^- = 0$) implies a finite system in a void. Assuming the intent is to model a single assembly with vacuum boundary conditions in an otherwise homogeneous environment (\"no nearby heterogeneities\", \"uniform curvature\"), this is a highly idealized scenario. The vacuum boundary condition itself is a simple albedo model where $a_g = 0$ for all groups. The buckling model would approximate this by finding a $B^2$ that reproduces the total leakage. In such a simplified, homogeneous environment, the buckling approximation is likely to be reasonably accurate, similar to the case in option B. This is not a situation characterized by complex environmental effects that demand the superiority of the albedo model. In fact, the premises of \"no heterogeneities\" and \"uniform curvature\" explicitly point to conditions where the buckling model is designed to work.\n**Verdict: Incorrect.**\n\nIn summary, the albedo model demonstrates its superiority in situations characterized by significant spatial, spectral, angular, or temporal variations in the conditions at the assembly boundary. Options A, C, and D describe such scenarios.",
            "answer": "$$\\boxed{ACD}$$"
        }
    ]
}