{
    "hands_on_practices": [
        {
            "introduction": "We begin by modeling a simplified, yet fundamental, scenario analytically. This exercise treats lateral turbulent mixing as a quasi-steady diffusion process between two adjacent subchannels, a common approximation in thermal-hydraulic codes. By deriving the exact solution for the transient concentration profile from first principles, you will build a solid foundation in the core physics of turbulent transport models .",
            "id": "4220774",
            "problem": "In subchannel-based nuclear reactor thermal-hydraulics, lateral turbulent mixing across the narrow gap separating two adjacent subchannels is often modeled as diffusion across a planar slab. Consider two identical, perfectly mixed subchannel control volumes, each of volume $V$, separated by a rectangular gap of thickness $b$ and interfacial area $A$ (per unit axial length). A passive scalar concentration $c$ is transported laterally across the gap solely by turbulent diffusion, with an effective turbulent diffusivity $D_{t}$ that is spatially uniform and constant in time. Assume that the diffusive time scale across the gap, $t_{d} \\sim b^{2}/D_{t}$, is much shorter than the evolution time scale of the subchannel-averaged concentrations, so that the gap concentration profile is quasi-steady and linear at each instant.\n\nStarting from species conservation and Fick’s law, derive the analytical solution for the transient evolution of the well-mixed subchannel concentrations $C_{1}(t)$ and $C_{2}(t)$ given the initial values $C_{1}(0)=C_{1,0}$ and $C_{2}(0)=C_{2,0}$. Then, using your derived solution, determine the time $t_{\\varepsilon}$ required for the concentrations everywhere in the gap and both subchannels to be within a specified relative tolerance $\\varepsilon$ of the final equilibrium concentration. Take the maximum deviation criterion with respect to the final equilibrium concentration, and use the fact that the gap profile is linear at each time.\n\nUse the following data:\n- Subchannel volumes: $V = 2.0 \\times 10^{-2}\\ \\mathrm{m^{3}}$ (each).\n- Gap thickness: $b = 2.0 \\times 10^{-3}\\ \\mathrm{m}$.\n- Interfacial area: $A = 1.5 \\times 10^{-2}\\ \\mathrm{m^{2}}$.\n- Turbulent diffusivity: $D_{t} = 8.0 \\times 10^{-3}\\ \\mathrm{m^{2}\\,s^{-1}}$.\n- Initial concentrations: $C_{1,0} = 1.2\\ \\mathrm{kg\\,m^{-3}}$, $C_{2,0} = 0.0\\ \\mathrm{kg\\,m^{-3}}$.\n- Relative tolerance: $\\varepsilon = 0.01$.\n\nExpress the time $t_{\\varepsilon}$ in seconds and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of the transient concentration profiles in two coupled subchannels and the subsequent calculation of the time required to reach a specified tolerance from equilibrium. The solution proceeds by first establishing the governing differential equations from first principles, solving them, and then applying the given criterion.\n\nThe foundation of the model rests on two principles: species conservation for a passive scalar and Fick's first law of diffusion.\n\nLet $C_{1}(t)$ and $C_{2}(t)$ be the spatially uniform concentrations in subchannel $1$ and subchannel $2$ at time $t$, respectively. Each subchannel has a volume $V$. The rate of change of mass of the scalar in subchannel $1$ is given by the mass balance equation:\n$$\nV \\frac{dC_{1}}{dt} = \\dot{m}_{2\\rightarrow1}\n$$\nwhere $\\dot{m}_{2\\rightarrow1}$ is the mass flow rate of the scalar from subchannel $2$ into subchannel $1$. By conservation of mass, the rate for subchannel $2$ is:\n$$\nV \\frac{dC_{2}}{dt} = \\dot{m}_{1\\rightarrow2} = -\\dot{m}_{2\\rightarrow1}\n$$\nThe mass flow rate is the product of the mass flux $J_{2\\rightarrow1}$ and the interfacial area $A$. The flux is described by Fick's law:\n$$\nJ_{2\\rightarrow1} = -D_{t} \\frac{dc}{dx}\n$$\nwhere $D_{t}$ is the turbulent diffusivity and $x$ is the spatial coordinate across the gap of thickness $b$, with $x=0$ at the interface with subchannel $1$ and $x=b$ at the interface with subchannel $2$.\n\nThe problem states that the concentration profile $c(x,t)$ in the gap is quasi-steady and linear. At any time $t$, the concentrations at the gap boundaries are the well-mixed subchannel concentrations, i.e., $c(0,t) = C_{1}(t)$ and $c(b,t) = C_{2}(t)$. The concentration gradient across the gap is constant:\n$$\n\\frac{dc}{dx} = \\frac{C_{2}(t) - C_{1}(t)}{b}\n$$\nSubstituting this into Fick's law gives the flux into subchannel $1$:\n$$\nJ_{2\\rightarrow1} = -D_{t} \\left( \\frac{C_{2}(t) - C_{1}(t)}{b} \\right) = \\frac{D_{t}}{b} (C_{1}(t) - C_{2}(t))\n$$\nThe mass flow rate is $\\dot{m}_{2\\rightarrow1} = A J_{2\\rightarrow1} = \\frac{A D_{t}}{b} (C_{1}(t) - C_{2}(t))$.\n\nSubstituting the mass flow rate back into the conservation equations yields a system of coupled first-order ordinary differential equations:\n$$\n\\frac{dC_{1}}{dt} = -\\frac{A D_{t}}{V b} (C_{1}(t) - C_{2}(t))\n$$\n$$\n\\frac{dC_{2}}{dt} = \\frac{A D_{t}}{V b} (C_{1}(t) - C_{2}(t))\n$$\nLet's define a rate constant $\\lambda = \\frac{A D_{t}}{V b}$. To solve this system, we introduce the concentration difference $\\Delta C(t) = C_{1}(t) - C_{2}(t)$. Subtracting the second equation from the first gives:\n$$\n\\frac{d(\\Delta C)}{dt} = -2\\lambda (\\Delta C)\n$$\nThis ODE has the solution $\\Delta C(t) = (C_{1,0} - C_{2,0}) \\exp(-2\\lambda t)$. The total concentration is conserved, so $C_{1}(t) + C_{2}(t) = C_{1,0} + C_{2,0}$. Solving for $C_1(t)$ and $C_2(t)$ gives:\n$$\nC_{1}(t) = \\frac{C_{1,0} + C_{2,0}}{2} + \\frac{C_{1,0} - C_{2,0}}{2} \\exp(-2\\lambda t)\n$$\n$$\nC_{2}(t) = \\frac{C_{1,0} + C_{2,0}}{2} - \\frac{C_{1,0} - C_{2,0}}{2} \\exp(-2\\lambda t)\n$$\nAs $t\\rightarrow\\infty$, the system reaches an equilibrium concentration $C_{eq} = \\frac{C_{1,0} + C_{2,0}}{2}$.\n\nThe time $t_{\\varepsilon}$ is found when the maximum deviation from equilibrium is within a tolerance $\\varepsilon$: $\\max |C(t_{\\varepsilon}) - C_{eq}| \\le \\varepsilon C_{eq}$. The maximum deviation occurs at the subchannel boundaries:\n$$\n\\max_{\\text{domain}} |C(t) - C_{eq}| = \\left|\\frac{C_{1,0} - C_{2,0}}{2} \\exp(-2\\lambda t)\\right|\n$$\nSetting this equal to the tolerance criterion at time $t_{\\varepsilon}$:\n$$\n\\left|\\frac{C_{1,0} - C_{2,0}}{2} \\exp(-2\\lambda t_{\\varepsilon})\\right| = \\varepsilon C_{eq} = \\varepsilon \\frac{C_{1,0} + C_{2,0}}{2}\n$$\nSolving for $t_{\\varepsilon}$:\n$$\nt_{\\varepsilon} = \\frac{1}{2\\lambda} \\ln\\left(\\frac{|C_{1,0} - C_{2,0}|}{\\varepsilon (C_{1,0} + C_{2,0})}\\right) = \\frac{V b}{2 A D_{t}} \\ln\\left(\\frac{|C_{1,0} - C_{2,0}|}{\\varepsilon (C_{1,0} + C_{2,0})}\\right)\n$$\nNow, we insert the provided numerical data:\n$V = 2.0 \\times 10^{-2}\\ \\mathrm{m^{3}}$\n$b = 2.0 \\times 10^{-3}\\ \\mathrm{m}$\n$A = 1.5 \\times 10^{-2}\\ \\mathrm{m^{2}}$\n$D_{t} = 8.0 \\times 10^{-3}\\ \\mathrm{m^{2}\\,s^{-1}}$\n$C_{1,0} = 1.2\\ \\mathrm{kg\\,m^{-3}}$\n$C_{2,0} = 0.0\\ \\mathrm{kg\\,m^{-3}}$\n$\\varepsilon = 0.01$\n\nFirst, calculate the time constant factor:\n$$\n\\frac{V b}{2 A D_{t}} = \\frac{(2.0 \\times 10^{-2}) (2.0 \\times 10^{-3})}{2 (1.5 \\times 10^{-2}) (8.0 \\times 10^{-3})} = \\frac{4.0 \\times 10^{-5}}{2.4 \\times 10^{-4}} = \\frac{1}{6}\\ \\mathrm{s}\n$$\nNext, calculate the argument of the natural logarithm:\n$$\n\\frac{|1.2 - 0.0|}{0.01 (1.2 + 0.0)} = \\frac{1.2}{0.01 \\times 1.2} = 100\n$$\nFinally, calculate $t_{\\varepsilon}$:\n$$\nt_{\\varepsilon} = \\frac{1}{6} \\ln(100) \\ \\mathrm{s} \\approx 0.767528... \\ \\mathrm{s}\n$$\nRounding the result to four significant figures gives $t_{\\varepsilon} = 0.7675\\ \\mathrm{s}$.",
            "answer": "$$\\boxed{0.7675}$$"
        },
        {
            "introduction": "Computational models rely on discretizing the continuous governing equations, and the choice of scheme has profound consequences. This practice investigates the numerical properties of the advection term, a key component of crossflow modeling. By performing a Taylor series analysis, you will uncover the \"numerical diffusion\" inherent in the widely used first-order upwind scheme and contrast it with the behavior of a central difference scheme .",
            "id": "4220737",
            "problem": "Consider lateral advection of specific enthalpy $h(y)$ across the gap between two adjacent fuel-assembly subchannels in a pressurized water reactor. Assume a constant crossflow speed $u_{c}>0$ directed from subchannel $1$ to subchannel $2$, uniform lateral grid spacing $\\Delta y$, and a smooth $h(y)$ that admits a Taylor expansion. The canonical two-subchannel test is represented locally by a uniform one-dimensional grid in the lateral coordinate $y$, with nodal values $h_{i}$ located at $y_{i}$ and spacing $\\Delta y=y_{i}-y_{i-1}$. The continuous lateral advection operator at $y_{i}$ is $u_{c}\\,\\partial h/\\partial y|_{i}$.\n\nIn nuclear reactor subchannel analysis, lateral turbulent mixing is commonly modeled by a Fickian diffusion term of the form $\\partial/\\partial y\\left(D_{t}\\,\\partial h/\\partial y\\right)$, where $D_{t}$ is an effective turbulent mixing coefficient. A discretization of the advection operator can produce artificial diffusion that mimics such mixing. Your task is to compare the upwind and central differencing approximations for the advection operator at $y_{i}$:\n- Upwind differencing: $u_{c}\\,\\left(h_{i}-h_{i-1}\\right)/\\Delta y$ for $u_{c}>0$.\n- Central differencing: $u_{c}\\,\\left(h_{i+1}-h_{i-1}\\right)/(2\\,\\Delta y)$.\n\nStarting only from the smoothness of $h(y)$ and the definitions above:\n1. Derive the leading-order truncation error for each scheme via Taylor series expansions about $y_{i}$. Explain which derivative of $h$ appears in the leading truncation error for each scheme and whether it is diffusive or dispersive in character.\n2. Using a modified-equation interpretation, identify the constant coefficient $D_{\\text{num}}$ of an equivalent Fickian diffusion term $\\partial/\\partial y\\left(D_{\\text{num}}\\,\\partial h/\\partial y\\right)$ that reproduces the leading-order effect of the upwind discretization.\n\nFinally, compute the numerical value of $D_{\\text{num}}$ in $\\mathrm{m^{2}\\,s^{-1}}$ for the canonical two-subchannel test with $u_{c}=0.12\\,\\mathrm{m\\,s^{-1}}$ and $\\Delta y=0.0135\\,\\mathrm{m}$. Round your answer to four significant figures and express the result in $\\mathrm{m^{2}\\,s^{-1}}$.",
            "solution": "This problem involves analyzing the accuracy of finite difference approximations through Taylor series expansions. The discrepancy between the discrete approximation and the exact continuous operator is the truncation error.\n\nLet $h(y)$ be a smooth function. The Taylor series expansions for $h$ at neighboring grid points are:\n$$h_{i-1} = h_i - \\Delta y \\left.\\frac{\\partial h}{\\partial y}\\right|_i + \\frac{(\\Delta y)^2}{2} \\left.\\frac{\\partial^2 h}{\\partial y^2}\\right|_i - \\frac{(\\Delta y)^3}{6} \\left.\\frac{\\partial^3 h}{\\partial y^3}\\right|_i + O((\\Delta y)^4)$$\n$$h_{i+1} = h_i + \\Delta y \\left.\\frac{\\partial h}{\\partial y}\\right|_i + \\frac{(\\Delta y)^2}{2} \\left.\\frac{\\partial^2 h}{\\partial y^2}\\right|_i + \\frac{(\\Delta y)^3}{6} \\left.\\frac{\\partial^3 h}{\\partial y^3}\\right|_i + O((\\Delta y)^4)$$\nThe exact continuous advection operator is $L(h) = u_c \\left.\\frac{\\partial h}{\\partial y}\\right|_i$.\n\n**1. Truncation Error Analysis**\n\n**Upwind Differencing Scheme:**\nThe discrete operator is $L_{\\Delta y}^{\\text{upwind}}(h) = u_c \\frac{h_i - h_{i-1}}{\\Delta y}$. Substituting the Taylor series for $h_{i-1}$:\n$$L_{\\Delta y}^{\\text{upwind}}(h) = \\frac{u_c}{\\Delta y} \\left[ \\Delta y \\left.\\frac{\\partial h}{\\partial y}\\right|_i - \\frac{(\\Delta y)^2}{2} \\left.\\frac{\\partial^2 h}{\\partial y^2}\\right|_i + O((\\Delta y)^3) \\right]$$\n$$L_{\\Delta y}^{\\text{upwind}}(h) = u_c \\left.\\frac{\\partial h}{\\partial y}\\right|_i - \\frac{u_c \\Delta y}{2} \\left.\\frac{\\partial^2 h}{\\partial y^2}\\right|_i + O((\\Delta y)^2)$$\nThe truncation error is $\\tau_{\\text{upwind}} = L_{\\Delta y}^{\\text{upwind}}(h) - L(h)$:\n$$\\tau_{\\text{upwind}} = - \\frac{u_c \\Delta y}{2} \\left.\\frac{\\partial^2 h}{\\partial y^2}\\right|_i + O((\\Delta y)^2)$$\nThe leading-order error is first-order in $\\Delta y$ and contains the second derivative, $\\frac{\\partial^2 h}{\\partial y^2}$. An even-order derivative term corresponds to dissipation or diffusion. Thus, the error is diffusive.\n\n**Central Differencing Scheme:**\nThe discrete operator is $L_{\\Delta y}^{\\text{central}}(h) = u_c \\frac{h_{i+1} - h_{i-1}}{2 \\Delta y}$. Substituting the Taylor series:\n$$L_{\\Delta y}^{\\text{central}}(h) = \\frac{u_c}{2 \\Delta y} \\left[ 2 \\Delta y \\left.\\frac{\\partial h}{\\partial y}\\right|_i + 2 \\frac{(\\Delta y)^3}{6} \\left.\\frac{\\partial^3 h}{\\partial y^3}\\right|_i + O((\\Delta y)^5) \\right]$$\n$$L_{\\Delta y}^{\\text{central}}(h) = u_c \\left.\\frac{\\partial h}{\\partial y}\\right|_i + \\frac{u_c (\\Delta y)^2}{6} \\left.\\frac{\\partial^3 h}{\\partial y^3}\\right|_i + O((\\Delta y)^4)$$\nThe truncation error is $\\tau_{\\text{central}} = L_{\\Delta y}^{\\text{central}}(h) - L(h)$:\n$$\\tau_{\\text{central}} = \\frac{u_c (\\Delta y)^2}{6} \\left.\\frac{\\partial^3 h}{\\partial y^3}\\right|_i + O((\\Delta y)^4)$$\nThe leading-order error is second-order in $\\Delta y$ and contains the third derivative, $\\frac{\\partial^3 h}{\\partial y^3}$. An odd-order derivative term corresponds to dispersion, which can introduce non-physical oscillations.\n\n**2. Equivalent Fickian Diffusion Coefficient**\n\nThe modified equation is the PDE that is more accurately solved by the finite difference scheme. For the upwind scheme, the discretized advection equation $\\frac{\\partial h}{\\partial t} + u_c \\frac{h_i - h_{i-1}}{\\Delta y} = 0$ is equivalent to:\n$$\\frac{\\partial h}{\\partial t} + u_c \\frac{\\partial h}{\\partial y} = \\frac{u_c \\Delta y}{2} \\frac{\\partial^2 h}{\\partial y^2} - O((\\Delta y)^2)$$\nThis has the form of an advection-diffusion equation. The physical turbulent mixing is modeled by a term $D_{t}\\frac{\\partial^2 h}{\\partial y^2}$. By comparing this to the leading-order error term, we identify the numerical diffusion coefficient $D_{\\text{num}}$:\n$$D_{\\text{num}}\\frac{\\partial^2 h}{\\partial y^2} = \\frac{u_c \\Delta y}{2} \\frac{\\partial^2 h}{\\partial y^2}$$\nThus, the equivalent numerical diffusion coefficient is:\n$$D_{\\text{num}} = \\frac{u_c \\Delta y}{2}$$\n\n**Numerical Calculation:**\nGiven $u_c = 0.12\\,\\mathrm{m\\,s^{-1}}$ and $\\Delta y = 0.0135\\,\\mathrm{m}$:\n$$D_{\\text{num}} = \\frac{(0.12\\,\\mathrm{m\\,s^{-1}}) \\times (0.0135\\,\\mathrm{m})}{2} = \\frac{0.00162}{2}\\,\\mathrm{m^2\\,s^{-1}} = 0.00081\\,\\mathrm{m^2\\,s^{-1}}$$\nRounding to four significant figures gives $0.0008100\\,\\mathrm{m^2\\,s^{-1}}$, which is $8.100 \\times 10^{-4}\\,\\mathrm{m^2\\,s^{-1}}$.",
            "answer": "$$\\boxed{8.100 \\times 10^{-4}}$$"
        },
        {
            "introduction": "This final practice synthesizes physical modeling and system analysis to characterize the overall dynamic response of a subchannel network. You will construct a \"lateral mixing operator\" that combines the effects of turbulent diffusion and crossflow exchange for multiple coupled subchannels. By analyzing the eigenvalues of this operator, you will determine the characteristic time scales over which the system reaches thermal equilibrium following a disturbance, a powerful technique used in reactor safety analysis .",
            "id": "4220751",
            "problem": "You are to model lateral turbulent mixing and crossflow exchange between subchannels in a nuclear reactor subchannel network and compute characteristic equilibration time scales for a step change in heat generation in one subchannel. Begin from the conservation of a passive scalar (here, temperature) in a control volume and fundamental transport laws. Specifically, use the scalar conservation in each subchannel control volume, Fickian turbulent diffusion across shared interfaces, and a linear phenomenological crossflow exchange between adjacent subchannels. Do not assume any pre-derived shortcut formulas; construct the governing linear system and characterize its dynamics.\n \nBase assumptions and definitions:\n- The passive scalar varies only laterally across subchannels and is uniform within any single subchannel control volume.\n- Turbulent diffusion follows a Fickian law at each interface, with flux proportional to concentration difference and turbulent diffusivity.\n- Crossflow exchange follows a linear phenomenological law, with flux proportional to concentration difference and a crossflow exchange coefficient.\n- The coolant fluid properties are constant.\n- A step change in heat generation rate is applied in one specified subchannel at $t = 0$, producing a constant volumetric heat source thereafter. All other subchannels have zero volumetric heat source.\n- The axial direction is not explicitly modeled; you will focus on the lateral distribution dynamics. You may treat axial advection and heat removal implicitly via the system’s structure if needed, but your primary aim is to characterize lateral equilibration.\n\nFundamental starting point:\n- Scalar conservation in subchannel $i$: the rate of change of the scalar integrated over volume equals the net inflow due to turbulent diffusion and crossflow across interfaces plus internal volumetric generation. For temperature $T_i(t)$, density $\\rho$, specific heat $c_p$, and volume $V_i$, the control-volume balance is\n$$\n\\rho c_p V_i \\frac{d T_i}{dt} = \\sum_{j \\in \\mathcal{N}(i)} \\left( \\Phi^{\\text{turb}}_{ij} + \\Phi^{\\text{cf}}_{ij} \\right) + q'_i V_i,\n$$\nwhere $\\mathcal{N}(i)$ is the set of subchannels adjacent to $i$, $q'_i$ is the volumetric heat generation rate in $\\text{W}/\\text{m}^3$, $\\Phi^{\\text{turb}}_{ij}$ is the turbulent diffusion exchange across interface $i$-$j$, and $\\Phi^{\\text{cf}}_{ij}$ is the crossflow exchange across interface $i$-$j$.\n- Turbulent diffusion exchange across an interface $i$-$j$ of area $A_{ij}$ and mixing length $L_{ij}$ with turbulent diffusivity $D_t$ obeys\n$$\n\\Phi^{\\text{turb}}_{ij} = \\rho c_p \\, D_t \\, \\frac{A_{ij}}{L_{ij}} \\left( T_j - T_i \\right).\n$$\n- Crossflow exchange across interface $i$-$j$ with crossflow coefficient $K_{cf}$ obeys\n$$\n\\Phi^{\\text{cf}}_{ij} = \\rho c_p \\, V_i \\, K_{cf} \\left( T_j - T_i \\right).\n$$\n\nYour program must construct the linear ordinary differential equation (ODE) system implied by these relations for the specified subchannel configurations, identify the lateral mixing operator, and derive the nonzero eigenvalues that determine the characteristic time scales of equilibration. For a step input applied to one subchannel, the approach to the steady lateral distribution is governed by these eigenvalues; for the special case of two identical subchannels, one can reduce the dynamics to a first-order linear ODE in the subchannel temperature difference. From that reduced model, quantify the time $t_{0.95}$ at which the temperature difference reaches $0.95$ of its steady value (express $0.95$ as a decimal, not a percentage sign).\n\nUnits and outputs:\n- All time quantities must be expressed in seconds.\n- The temperature source rate $q'$ will be converted to an equivalent temperature rate via $\\rho$ and $c_p$, but your required outputs are time quantities, not temperatures.\n\nTest suite:\nCompute the required outputs for the following parameter sets. In all cases, the initial temperature in all subchannels at $t=0^-$ is the same, and the step in power occurs at $t=0$.\n\n- Case $1$ (two identical subchannels, both volumes identical):\n  - Number of subchannels $N = 2$.\n  - Volume per subchannel $V_1 = V_2 = 0.001 \\, \\text{m}^3$ ($0.001$).\n  - Interface area $A_{12} = 0.002 \\, \\text{m}^2$ ($0.002$).\n  - Mixing length $L_{12} = 0.01 \\, \\text{m}$ ($0.01$).\n  - Turbulent diffusivity $D_t = 1\\times 10^{-4} \\, \\text{m}^2/\\text{s}$ ($0.0001$).\n  - Crossflow coefficient $K_{cf} = 0.2 \\, \\text{s}^{-1}$ ($0.2$).\n  - Fluid density $\\rho = 700 \\, \\text{kg}/\\text{m}^3$ ($700$).\n  - Specific heat $c_p = 4500 \\, \\text{J}/(\\text{kg}\\cdot\\text{K})$ ($4500$).\n  - Step volumetric heat source in subchannel $1$: $q'_1 = 1\\times 10^{6} \\, \\text{W}/\\text{m}^3$ ($1000000$).\n  - Subchannel $2$ has $q'_2 = 0 \\, \\text{W}/\\text{m}^3$ ($0$).\n\n- Case $2$ (two subchannels, no crossflow, turbulence only):\n  - $N = 2$.\n  - $V_1 = V_2 = 0.001$.\n  - $A_{12} = 0.002$.\n  - $L_{12} = 0.01$.\n  - $D_t = 3\\times 10^{-4}$ ($0.0003$).\n  - $K_{cf} = 0$.\n  - $\\rho = 700$.\n  - $c_p = 4500$.\n  - $q'_1 = 1\\times 10^{6}$ ($1000000$).\n  - $q'_2 = 0$.\n\n- Case $3$ (two subchannels, no turbulence, crossflow only):\n  - $N = 2$.\n  - $V_1 = V_2 = 0.001$.\n  - $A_{12} = 0.002$.\n  - $L_{12} = 0.01$.\n  - $D_t = 0$.\n  - $K_{cf} = 0.05$ ($0.05$).\n  - $\\rho = 700$.\n  - $c_p = 4500$.\n  - $q'_1 = 1\\times 10^{6}$ ($1000000$).\n  - $q'_2 = 0$.\n\n- Case $4$ (three subchannels in a line: $1$–$2$–$3$, identical volumes, identical interfaces between neighbors, no interface between $1$ and $3$; step source in subchannel $1$):\n  - $N = 3$.\n  - $V_1 = V_2 = V_3 = 0.001$.\n  - Interfaces: $A_{12} = 0.002$, $L_{12} = 0.01$; $A_{23} = 0.002$, $L_{23} = 0.01$.\n  - $D_t = 2\\times 10^{-4}$ ($0.0002$).\n  - $K_{cf} = 0.1$ ($0.1$).\n  - $\\rho = 700$.\n  - $c_p = 4500$.\n  - $q'_1 = 1\\times 10^{6}$ ($1000000$).\n  - $q'_2 = 0$, $q'_3 = 0$.\n\nRequired outputs per case:\n- For each case, produce two floats:\n  1. The dominant lateral equilibration time constant $\\tau_{\\text{dom}}$ in seconds, defined as the reciprocal of the smallest nonzero eigenvalue of the lateral mixing operator of the ODE system.\n  2. The time $t_{0.95}$ in seconds at which the lateral temperature difference between the powered subchannel and its immediate neighbor reaches $0.95$ of its steady value for a step input. For the two-subchannel cases, this is the exact closed-form response time of the temperature difference. For the three-subchannel case, use the reciprocal of the smallest nonzero eigenvalue as the characteristic decay rate for the slowest mode to compute $t_{0.95}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\texttt{result1,result2,result3,result4,...}\\right]$), in the order\n$$\n\\left[\\tau_{\\text{dom},1}, \\, t_{0.95,1}, \\, \\tau_{\\text{dom},2}, \\, t_{0.95,2}, \\, \\tau_{\\text{dom},3}, \\, t_{0.95,3}, \\, \\tau_{\\text{dom},4}, \\, t_{0.95,4}\\right].\n$$\nAll time values must be in seconds.",
            "solution": "The analysis begins by formalizing the governing equations into a matrix system. Substituting the flux expressions into the conservation equation for subchannel $i$ and dividing by $\\rho c_p V_i$ gives the rate of temperature change:\n$$ \\frac{d T_i}{dt} = \\sum_{j \\in \\mathcal{N}(i)} \\left( \\frac{D_t A_{ij}}{V_i L_{ij}} + K_{cf} \\right) (T_j - T_i) + \\frac{q'_i}{\\rho c_p} $$\nLet us define a coupling coefficient $C_{ij} = \\frac{D_t A_{ij}}{V_i L_{ij}} + K_{cf}$. The system of equations can be written in matrix form: $\\frac{d\\mathbf{T}}{dt} = \\mathbf{M}\\mathbf{T} + \\mathbf{S}$, where $\\mathbf{T}(t)$ is the vector of subchannel temperatures, $\\mathbf{S}$ is the vector of source terms, and $\\mathbf{M}$ is the lateral mixing operator matrix. The elements of $\\mathbf{M}$ are $M_{ij} = C_{ij}$ for $i \\neq j$ and $M_{ii} = - \\sum_{j \\in \\mathcal{N}(i)} C_{ij}$.\n\nThe non-zero eigenvalues, $\\lambda_k$, of $\\mathbf{M}$ govern the equilibration of temperature differences. The dominant (slowest) equilibration time constant, $\\tau_{\\text{dom}}$, corresponds to the non-zero eigenvalue with the smallest magnitude: $\\tau_{\\text{dom}} = 1/(\\min_{k | \\lambda_k \\neq 0} |\\lambda_k|)$.\nFor a first-order system with time constant $\\tau$, the time $t_{0.95}$ to reach $95\\%$ of the final value in response to a step input is found by solving $0.95 = 1 - e^{-t_{0.95}/\\tau}$, which yields $t_{0.95} = -\\tau \\ln(0.05)$.\n\n**Case-by-Case Analysis:**\n\n**Case 1: Two identical subchannels**\nThe coupling coefficient is:\n$$ C = \\frac{(1 \\times 10^{-4} \\, \\text{m}^2/\\text{s})(0.002 \\, \\text{m}^2)}{(0.001 \\, \\text{m}^3)(0.01 \\, \\text{m})} + 0.2 \\, \\text{s}^{-1} = 0.02 \\, \\text{s}^{-1} + 0.2 \\, \\text{s}^{-1} = 0.22 \\, \\text{s}^{-1} $$\nThe non-zero eigenvalue of the $2 \\times 2$ system is $\\lambda_2 = -2C = -0.44 \\, \\text{s}^{-1}$.\n$\\tau_{\\text{dom}} = 1/|\\lambda_2| = 1/0.44 \\approx 2.2727 \\, \\text{s}$.\n$t_{0.95} = -2.2727 \\ln(0.05) \\approx 6.8085 \\, \\text{s}$.\n\n**Case 2: Two subchannels, no crossflow**\nThe coupling coefficient is:\n$$ C = \\frac{(3 \\times 10^{-4} \\, \\text{m}^2/\\text{s})(0.002 \\, \\text{m}^2)}{(0.001 \\, \\text{m}^3)(0.01 \\, \\text{m})} + 0 \\, \\text{s}^{-1} = 0.06 \\, \\text{s}^{-1} $$\nThe non-zero eigenvalue is $\\lambda_2 = -2C = -0.12 \\, \\text{s}^{-1}$.\n$\\tau_{\\text{dom}} = 1/0.12 \\approx 8.3333 \\, \\text{s}$.\n$t_{0.95} = -8.3333 \\ln(0.05) \\approx 24.9644 \\, \\text{s}$.\n\n**Case 3: Two subchannels, no turbulence**\nThe coupling coefficient is $C = 0.05 \\, \\text{s}^{-1}$.\nThe non-zero eigenvalue is $\\lambda_2 = -2C = -0.10 \\, \\text{s}^{-1}$.\n$\\tau_{\\text{dom}} = 1/0.10 = 10 \\, \\text{s}$.\n$t_{0.95} = -10 \\ln(0.05) \\approx 29.9573 \\, \\text{s}$.\n\n**Case 4: Three subchannels in a line**\nThe coupling coefficient for adjacent channels is:\n$$ C = \\frac{(2 \\times 10^{-4} \\, \\text{m}^2/\\text{s})(0.002 \\, \\text{m}^2)}{(0.001 \\, \\text{m}^3)(0.01 \\, \\text{m})} + 0.1 \\, \\text{s}^{-1} = 0.04 \\, \\text{s}^{-1} + 0.1 \\, \\text{s}^{-1} = 0.14 \\, \\text{s}^{-1} $$\nThe non-zero eigenvalues of the $3 \\times 3$ matrix for this arrangement are $\\lambda_2 = -C = -0.14 \\, \\text{s}^{-1}$ and $\\lambda_3 = -3C = -0.42 \\, \\text{s}^{-1}$. The one with the smallest magnitude is $-0.14 \\, \\text{s}^{-1}$.\n$\\tau_{\\text{dom}} = 1/0.14 \\approx 7.1429 \\, \\text{s}$.\n$t_{0.95} = -7.1429 \\ln(0.05) \\approx 21.3981 \\, \\text{s}$.",
            "answer": "[2.272727272727,6.808502124111,8.333333333333,24.964417721519,10.000000000000,29.957322735530,7.142857142857,21.398087668236]"
        }
    ]
}