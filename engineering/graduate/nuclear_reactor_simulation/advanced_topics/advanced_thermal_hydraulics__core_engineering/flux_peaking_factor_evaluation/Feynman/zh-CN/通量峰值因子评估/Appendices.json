{
    "hands_on_practices": [
        {
            "introduction": "理解中子通量峰化现象的物理根源是评估其影响的第一步。在反应堆设计中，反射层能够有效减少中子泄漏，从而提高中子经济性，但它也会导致堆芯-反射层边界附近的中子通量分布发生改变，形成一个峰值。本实践将引导你使用单群中子扩散理论，对一个带有反射层的理想化板式反应堆进行解析求解，从而亲手推导出通量峰化因子。通过这个经典的解析模型，你将深刻理解反射层如何引起中子通量峰化，并掌握其基本分析方法。",
            "id": "4227008",
            "problem": "考虑一个单能中子扩散模型，该模型描述了一个半厚度为 $a$ 的均匀平板反应堆堆芯，占据区间 $-a \\le x \\le a$，其两侧由厚度为 $t$ 的非增殖反射层包围，占据区间 $a \\le |x| \\le a+t$。反应堆关于 $x=0$ 对称。位于 $x=\\pm(a+t)$ 处的外边界为真空边界。每个区域内的材料都是均匀的，其特征是扩散系数 $D$ 和宏观吸收截面 $\\Sigma_{a}$。在反应堆堆芯中，通过一个有效产生项 $\\nu\\Sigma_{f}$ 产生裂变中子；在反射层中，不存在中子源。\n\n在单群扩散理论框架下，对于此临界反应堆 ($k=1$)：\n1.  写出并求解堆芯和反射层中的中子扩散方程，应用对称性和真空边界条件。\n2.  在堆芯-反射层交界面 ($x=a$) 处应用中子通量和中子流连续性条件。\n3.  推导出描述该反应堆临界条件的超越方程。\n4.  推导出堆芯通量峰值因子 $F_{peak} = \\phi_{max}/\\bar{\\phi}_{core}$ 的表达式，用几何参数 ($a$) 和材料屈曲 ($B_c$) 表示。",
            "solution": "我们按照问题要求，分步求解。\n\n**1. 求解扩散方程**\n\n**堆芯区域 ($|x| \\le a$):**\n对于临界反应堆 ($k=1$)，中子扩散方程为：\n$$\n-D_{c}\\,\\frac{d^{2}\\phi_c}{dx^{2}}+\\Sigma_{a,c}\\,\\phi_c=\\nu\\Sigma_{f,c}\\,\\phi_c\n$$\n整理后得到亥姆霍兹方程：\n$$\n\\frac{d^{2}\\phi_c}{dx^{2}} + B_c^2\\,\\phi_c = 0, \\quad \\text{其中 } B_c^2 = \\frac{\\nu\\Sigma_{f,c} - \\Sigma_{a,c}}{D_c}\n$$\n$B_c^2$ 是堆芯的材料屈曲。该方程的通解是 $\\phi_c(x) = A \\sin(B_c x) + C \\cos(B_c x)$。由于反应堆关于 $x=0$ 对称，通量分布必须是偶函数，因此正弦项的系数必须为零 ($A=0$)。所以，堆芯中的通量分布为：\n$$\n\\phi_c(x) = C \\cos(B_c x)\n$$\n\n**反射层区域 ($a \\le |x| \\le a+t$):**\n反射层中没有中子源 ($\\nu\\Sigma_f = 0$)，方程为：\n$$\n-D_{r}\\,\\frac{d^{2}\\phi_r}{dx^{2}}+\\Sigma_{a,r}\\,\\phi_r=0\n$$\n整理后得到：\n$$\n\\frac{d^{2}\\phi_r}{dx^{2}} - \\kappa_r^2\\,\\phi_r = 0, \\quad \\text{其中 } \\kappa_r^2 = \\frac{\\Sigma_{a,r}}{D_r}\n$$\n$\\kappa_r$ 是反射层材料的逆扩散长度。通解是 $\\phi_r(x) = E \\sinh(\\kappa_r x) + F \\cosh(\\kappa_r x)$。由于对称性，我们只需考虑 $x>0$ 的区域，即 $a \\le x \\le a+t$。外边界 $x=a+t$ 是真空边界，近似为 $\\phi_r(a+t)=0$。为方便施加此条件，我们将解写为：\n$$\n\\phi_r(x) = E' \\sinh(\\kappa_r (a+t-x))\n$$\n当 $x=a+t$ 时，此形式自动满足 $\\phi_r(a+t)=0$。\n\n**2. 应用界面连续性条件**\n\n在堆芯和反射层的交界面 $x=a$ 处，中子通量和中子流必须连续。\n-   **通量连续**: $\\phi_c(a) = \\phi_r(a)$\n    $$\n    C \\cos(B_c a) = E' \\sinh(\\kappa_r t)\n    $$\n-   **中子流连续**: $J_c(a) = J_r(a)$, 其中 $J = -D \\frac{d\\phi}{dx}$。\n    $$\n    -D_c \\frac{d}{dx}[C \\cos(B_c x)]_{x=a} = -D_r \\frac{d}{dx}[E' \\sinh(\\kappa_r (a+t-x))]_{x=a}\n    $$\n    $$\n    -D_c [-C B_c \\sin(B_c a)] = -D_r [-E' \\kappa_r \\cosh(\\kappa_r (a+t-a))]\n    $$\n    $$\n    D_c C B_c \\sin(B_c a) = D_r E' \\kappa_r \\cosh(\\kappa_r t)\n    $$\n\n**3. 推导临界条件**\n\n我们现在有两个关于系数 $C$ 和 $E'$ 的方程。为了得到非零解，我们将第二个方程除以第一个方程，消去系数：\n$$\n\\frac{D_c C B_c \\sin(B_c a)}{C \\cos(B_c a)} = \\frac{D_r E' \\kappa_r \\cosh(\\kappa_r t)}{E' \\sinh(\\kappa_r t)}\n$$\n$$\nD_c B_c \\tan(B_c a) = D_r \\kappa_r \\coth(\\kappa_r t)\n$$\n这就是该反应堆的临界条件超越方程。给定材料属性和几何尺寸，此方程确定了临界状态下的材料屈曲 $B_c$（或半厚度 $a$）。\n\n**4. 推导通量峰值因子**\n\n堆芯通量峰值因子定义为最大通量与堆芯平均通量之比。\n-   **最大通量**: 由于通量分布是余弦函数，最大值出现在堆芯中心 $x=0$。\n    $$\n    \\phi_{max} = \\phi_c(0) = C \\cos(0) = C\n    $$\n-   **平均通量**: 堆芯的平均通量 $\\bar{\\phi}_{core}$ 是：\n    $$\n    \\bar{\\phi}_{core} = \\frac{1}{a} \\int_0^a \\phi_c(x) \\,dx = \\frac{1}{a} \\int_0^a C \\cos(B_c x) \\,dx\n    $$\n    $$\n    \\bar{\\phi}_{core} = \\frac{C}{a} \\left[ \\frac{\\sin(B_c x)}{B_c} \\right]_0^a = \\frac{C \\sin(B_c a)}{a B_c}\n    $$\n-   **峰值因子**:\n    $$\n    F_{peak} = \\frac{\\phi_{max}}{\\bar{\\phi}_{core}} = \\frac{C}{\\frac{C \\sin(B_c a)}{a B_c}}\n    $$\n    $$\n    F_{peak} = \\frac{a B_c}{\\sin(B_c a)}\n    $$\n这个表达式给出了堆芯通量峰值因子，它仅取决于堆芯的尺寸和材料屈曲。",
            "answer": "$$\\boxed{F_{peak} = \\frac{a B_c}{\\sin(B_c a)}}$$"
        },
        {
            "introduction": "现代反应堆模拟程序通常采用节块法（nodal methods），将堆芯划分为若干个粗网格“节块”，并计算节块内的平均通量和边界上的通量。然而，安全分析要求我们了解节块内部的详细通量分布，特别是其峰值。本实践将带你探索一种基础但至关重要的技术：利用节块平均通量和边界通量值，通过二次多项式插值来重构一维节块内部的通量分布。通过求解这个问题，你将掌握从离散的节块数据中估算局部峰值的核心算法，这是理解和验证节块法计算结果的关键一步。",
            "id": "4227007",
            "problem": "考虑一个在稳态反应堆模拟的中子扩散节块法中使用的一维(1D)板状节块，其宽度为 $h$。假设节块内中子通量通过局部坐标 $x \\in \\left[-\\frac{h}{2}, \\frac{h}{2}\\right]$ 上的二阶多项式子单元插值来近似，\n$$\n\\phi(x) = a + b x + c x^2,\n$$\n其中 $a$、$b$ 和 $c$ 是未知系数。给定节点上的体积平均中子通量 $\\bar{\\phi}$ 以及节点左右交界面上的中子通量值 $\\phi_L = \\phi\\!\\left(-\\frac{h}{2}\\right)$ 和 $\\phi_R = \\phi\\!\\left(\\frac{h}{2}\\right)$。假设所有给定的中子通量均为严格正值。通量峰值因子 (FPF) 定义为节块内最大中子通量与节点平均中子通量之比，\n$$\n\\mathrm{FPF} \\equiv \\frac{\\displaystyle \\max_{x \\in \\left[-\\frac{h}{2}, \\frac{h}{2}\\right]} \\phi(x)}{\\bar{\\phi}}.\n$$\n从以下基本依据出发：\n- 节点内的中子平衡意味着子单元插值函数的构造应与积分矩和边界约束保持一致。\n- 单元平均约束为\n$$\n\\frac{1}{h} \\int_{-h/2}^{h/2} \\phi(x)\\,dx = \\bar{\\phi}.\n$$\n- 交界面约束为\n$$\n\\phi\\!\\left(-\\frac{h}{2}\\right) = \\phi_L, \\qquad \\phi\\!\\left(\\frac{h}{2}\\right) = \\phi_R.\n$$\n推导一个算法来确定系数 $a$、$b$ 和 $c$，然后确定在闭区间上 $\\max_{x} \\phi(x)$。您的算法必须：\n- 仅使用上述三个约束求解 $a$、$b$ 和 $c$。\n- 检测最大值是出现在内部驻点 $x^\\star$（如果它存在于区间内且对应于局部极大值）还是出现在端点。如果二次函数在区间上是向下凹的，并且驻点 $x^\\star$ 位于 $\\left[-\\frac{h}{2}, \\frac{h}{2}\\right]$ 内，则计算 $\\phi(x^\\star)$。否则，计算 $\\phi$ 在端点的值并选择较大的一个。\n- 计算 FPF，结果为一个无量纲浮点数。\n\n物理单位：$h$ 必须以厘米为单位提供，所有中子通量必须以“中子数/平方厘米·秒”为单位提供。最终的通量峰值因子是无量纲的，必须表示为四舍五入到六位小数的浮点数。\n\n将该算法实现为一个完整的、可运行的程序，对以下每个指定为 $(\\bar{\\phi}, \\phi_L, \\phi_R, h)$ 的测试用例集进行 FPF 评估：\n- 用例 1：$(1.0, 0.8, 0.8, 10.0)$\n- 用例 2：$(1.0, 0.9, 1.2, 10.0)$\n- 用例 3：$(1.0, 0.95, 0.85, 10.0)$\n- 用例 4：$(1.0, 1.0, 1.0, 10.0)$\n- 用例 5：$(1.0, 0.4, 1.4, 5.0)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$），每个结果是相应案例的 FPF，四舍五入到六位小数。输出必须是无量纲的浮点数，四舍五入到六位小数，且不含任何附加文本。",
            "solution": "目标是推导一种计算通量峰值因子 (FPF) 的算法。该算法适用于一维板状节块，其中节块内中子通量 $\\phi(x)$ 在局部域 $x \\in \\left[-\\frac{h}{2}, \\frac{h}{2}\\right]$上由二次多项式 $\\phi(x) = a + b x + c x^2$ 近似。该算法将基于三个基本约束：节点平均中子通量 $\\bar{\\phi}$，以及左右交界面上的中子通量值 $\\phi_L$ 和 $\\phi_R$。\n\n首先，我们通过求解由给定约束导出的三个线性方程组来确定系数 $a$、$b$ 和 $c$。\n\n1.  **左交界面约束**：在 $x = -h/2$ 处的中子通量必须等于 $\\phi_L$。\n    $$\n    \\phi\\left(-\\frac{h}{2}\\right) = a - b\\frac{h}{2} + c\\left(-\\frac{h}{2}\\right)^2 = a - \\frac{bh}{2} + \\frac{ch^2}{4} = \\phi_L\n    $$\n\n2.  **右交界面约束**：在 $x = h/2$ 处的中子通量必须等于 $\\phi_R$。\n    $$\n    \\phi\\left(\\frac{h}{2}\\right) = a + b\\frac{h}{2} + c\\left(\\frac{h}{2}\\right)^2 = a + \\frac{bh}{2} + \\frac{ch^2}{4} = \\phi_R\n    $$\n\n3.  **单元平均约束**：$\\phi(x)$ 在节点宽度 $h$ 上的空间平均值必须等于 $\\bar{\\phi}$。\n    $$\n    \\bar{\\phi} = \\frac{1}{h} \\int_{-h/2}^{h/2} (a + bx + cx^2) \\,dx = \\frac{1}{h} \\left[ ax + \\frac{bx^2}{2} + \\frac{cx^3}{3} \\right]_{-h/2}^{h/2}\n    $$\n    计算定积分：\n    $$\n    \\bar{\\phi} = \\frac{1}{h} \\left\\{ \\left(a\\frac{h}{2} + \\frac{b}{2}\\left(\\frac{h}{2}\\right)^2 + \\frac{c}{3}\\left(\\frac{h}{2}\\right)^3\\right) - \\left(a\\left(-\\frac{h}{2}\\right) + \\frac{b}{2}\\left(-\\frac{h}{2}\\right)^2 + \\frac{c}{3}\\left(-\\frac{h}{2}\\right)^3\\right) \\right\\}\n    $$\n    $$\n    \\bar{\\phi} = \\frac{1}{h} \\left( ah + \\frac{2c}{3}\\frac{h^3}{8} \\right) = a + \\frac{ch^2}{12}\n    $$\n\n现在我们求解这个由三个方程组成的方程组，以求出 $a$、$b$ 和 $c$：\n(I) $a - \\frac{bh}{2} + \\frac{ch^2}{4} = \\phi_L$\n(II) $a + \\frac{bh}{2} + \\frac{ch^2}{4} = \\phi_R$\n(III) $a + \\frac{ch^2}{12} = \\bar{\\phi}$\n\n从 (II) 中减去 (I) 得到 $b$ 的表达式：\n$$\n(\\text{II}) - (\\text{I}): \\quad (a + \\frac{bh}{2} + \\frac{ch^2}{4}) - (a - \\frac{bh}{2} + \\frac{ch^2}{4}) = \\phi_R - \\phi_L\n$$\n$$\nbh = \\phi_R - \\phi_L \\implies b = \\frac{\\phi_R - \\phi_L}{h}\n$$\n\n将 (I) 和 (II) 相加得到 $a$ 和 $c$ 之间的一个关系：\n$$\n(\\text{I}) + (\\text{II}): \\quad (a - \\frac{bh}{2} + \\frac{ch^2}{4}) + (a + \\frac{bh}{2} + \\frac{ch^2}{4}) = \\phi_L + \\phi_R\n$$\n$$\n2a + \\frac{ch^2}{2} = \\phi_L + \\phi_R \\implies a = \\frac{\\phi_L + \\phi_R}{2} - \\frac{ch^2}{4}\n$$\n将这个 $a$ 的表达式代入 (III)：\n$$\n\\left(\\frac{\\phi_L + \\phi_R}{2} - \\frac{ch^2}{4}\\right) + \\frac{ch^2}{12} = \\bar{\\phi}\n$$\n$$\n\\frac{\\phi_L + \\phi_R}{2} - \\bar{\\phi} = \\frac{ch^2}{4} - \\frac{ch^2}{12} = \\frac{3ch^2 - ch^2}{12} = \\frac{2ch^2}{12} = \\frac{ch^2}{6}\n$$\n求解 $c$：\n$$\nc = \\frac{6}{h^2} \\left( \\frac{\\phi_L + \\phi_R}{2} - \\bar{\\phi} \\right) = \\frac{3(\\phi_L + \\phi_R - 2\\bar{\\phi})}{h^2}\n$$\n\n最后，将 $c$ 的表达式代回到由 (III) 得到的 $a$ 的表达式中，$a = \\bar{\\phi} - \\frac{ch^2}{12}$：\n$$\na = \\bar{\\phi} - \\frac{h^2}{12} \\left( \\frac{3(\\phi_L + \\phi_R - 2\\bar{\\phi})}{h^2} \\right) = \\bar{\\phi} - \\frac{\\phi_L + \\phi_R - 2\\bar{\\phi}}{4}\n$$\n$$\na = \\frac{4\\bar{\\phi} - \\phi_L - \\phi_R + 2\\bar{\\phi}}{4} = \\frac{6\\bar{\\phi} - \\phi_L - \\phi_R}{4} = \\frac{3}{2}\\bar{\\phi} - \\frac{\\phi_L + \\phi_R}{4}\n$$\n\n确定系数后，下一步是找到 $\\phi(x)$ 在闭区间 $\\left[-\\frac{h}{2}, \\frac{h}{2}\\right]$ 上的最大值。连续函数在闭区间上的最大值要么出现在端点，要么出现在内部临界点。\n\n二次函数 $\\phi(x)$ 的临界点可以通过将其导数设为零来找到：\n$$\n\\phi'(x) = b + 2cx = 0 \\implies x^\\star = -\\frac{b}{2c}\n$$\n这个驻点的性质取决于二阶导数 $\\phi''(x) = 2c$ 的符号。\n\n寻找 $\\phi_{\\max} = \\displaystyle \\max_{x \\in \\left[-\\frac{h}{2}, \\frac{h}{2}\\right]} \\phi(x)$ 的算法流程如下：\n1.  使用推导出的公式计算系数 $b$ 和 $c$。\n2.  分析 $c$ 的符号：\n    -   如果 $c \\ge 0$，则抛物线是向上凹的或线性的（如果 $c=0$）。在这种情况下，区间上的最大值必定出现在端点之一。因此，$\\phi_{\\max} = \\max\\left(\\phi_L, \\phi_R\\right)$。\n    -   如果 $c < 0$，则抛物线是向下凹的，驻点 $x^\\star = -b/(2c)$ 是一个局部极大值点。\n        -   我们必须检查这个极大值点是否位于区间内：$|x^\\star| \\le h/2$。\n        -   如果是，则区间上的全局最大值就是该点的中子通量值：$\\phi_{\\max} = \\phi(x^\\star) = a + b x^\\star + c (x^\\star)^2$。这可以简化为 $\\phi_{\\max} = a - \\frac{b^2}{4c}$。\n        -   如果 $x^\\star$ 位于区间外（$|x^\\star| > h/2$），则函数在 $\\left[-\\frac{h}{2}, \\frac{h}{2}\\right]$ 上是单调的，所以最大值必定出现在一个端点：$\\phi_{\\max} = \\max\\left(\\phi_L, \\phi_R\\right)$。\n\n最后，通量峰值因子 (FPF) 计算为最大中子通量与平均中子通量之比：\n$$\n\\mathrm{FPF} = \\frac{\\phi_{\\max}}{\\bar{\\phi}}\n$$\n这个量是无量纲的，因为两个中子通量具有相同的单位。最终的算法将针对给定的测试用例实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Flux Peaking Factor (FPF) for a 1D quadratic flux profile\n    based on node-averaged and interface flux values.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (phi_bar, phi_L, phi_R, h)\n    test_cases = [\n        (1.0, 0.8, 0.8, 10.0), # Case 1\n        (1.0, 0.9, 1.2, 10.0), # Case 2\n        (1.0, 0.95, 0.85, 10.0), # Case 3\n        (1.0, 1.0, 1.0, 10.0), # Case 4\n        (1.0, 0.4, 1.4, 5.0), # Case 5\n    ]\n\n    results = []\n    \n    # A small tolerance for floating-point comparisons to zero.\n    TOL = 1e-12\n\n    for case in test_cases:\n        phi_bar, phi_L, phi_R, h = case\n\n        # Derived expressions for the quadratic coefficients of phi(x) = a + bx + cx^2\n        # b = (phi_R - phi_L) / h\n        # c = 3 * (phi_L + phi_R - 2 * phi_bar) / h^2\n        # a = 1.5 * phi_bar - 0.25 * (phi_L + phi_R)\n\n        b = (phi_R - phi_L) / h\n        c = 3.0 * (phi_L + phi_R - 2.0 * phi_bar) / (h**2)\n\n        phi_max = 0.0\n\n        if c >= -TOL:\n            # Parabola is concave up (c > 0) or linear (c ≈ 0).\n            # The maximum flux on the interval must be at one of the endpoints.\n            phi_max = max(phi_L, phi_R)\n        else:\n            # Parabola is concave down (c < 0).\n            # The stationary point is a maximum.\n            x_star = -b / (2.0 * c)\n\n            # Check if the stationary point is within the closed interval [-h/2, h/2].\n            if abs(x_star) <= h / 2.0:\n                # The maximum is at the internal peak.\n                # Calculate 'a' to evaluate phi(x_star).\n                a = 1.5 * phi_bar - 0.25 * (phi_L + phi_R)\n                # phi_max = a + b * x_star + c * x_star**2\n                # A more stable form is used to avoid reliance on x_star directly:\n                phi_max = a - (b**2) / (4.0 * c)\n            else:\n                # The peak is outside the interval. The function is monotonic\n                # on the interval, so the maximum must be at an endpoint.\n                phi_max = max(phi_L, phi_R)\n        \n        # Calculate the Flux Peaking Factor.\n        # Ensure phi_bar is not zero to avoid division by zero error,\n        # which is guaranteed by the problem statement (fluxes are strictly positive).\n        fpf = phi_max / phi_bar\n        \n        # Format the result to six decimal places.\n        results.append(f\"{fpf:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了一维节块内通量重构的基本原理后，我们可以将其应用于更真实的二维情况，并解决一个反应堆安全分析中的核心问题：计算燃料棒功率峰化因子。反应堆的安全限值往往是针对最热的单根燃料棒，而非整个燃料组件的平均功率。本实践将要求你使用可分离的多项式展开，在一个二维正方形燃料节块内重构通量分布，并进一步计算出其中各个燃料棒的平均功率。完成这个练习，你将学会如何将粗网格节块计算的结果与精细的燃料棒功率分布联系起来，这是将理论计算转化为实际安全评估的关键技能。",
            "id": "4226992",
            "problem": "考虑二维反应堆堆芯平面中的一个均质化方形燃料节块，该节块在稳态、单群、带裂变源的中子扩散模型下进行建模。设该节块被映射到参考域 $[-1,1] \\times [-1,1]$，其空间坐标 $(x,y)$ 与节块的局部坐标轴对齐。节块平均标量通量给定为 $\\bar{\\phi} = 1$。一次粗网格节块计算提供了节块边界上的面平均标量通量：左界面平均值 $\\phi_{L} = 0.90$，右界面平均值 $\\phi_{R} = 1.10$，底界面平均值 $\\phi_{B} = 0.94$，顶界面平均值 $\\phi_{T} = 1.06$。假设节块内的宏观截面在空间上是均匀的，因此局部裂变功率密度与局部标量通量成正比。\n\n使用可分离的节块内重构方法，将节块内通量在 $[-1,1] \\times [-1,1]$ 上近似为 $\\phi(x,y) = \\bar{\\phi}\\, f(x)\\, g(y)$，其中 $f(x)$ 和 $g(y)$ 是次数最多为二的多项式。施加以下由节块平衡和与面平均量的一致性产生的约束：\n- $f(x)$ 在 $x \\in [-1,1]$ 上的平均值为 $1$，且 $g(y)$ 在 $y \\in [-1,1]$ 上的平均值为 $1$。\n- 面平均通量满足 $f(-1) = \\phi_{L}/\\bar{\\phi}$，$f(1) = \\phi_{R}/\\bar{\\phi}$，$g(-1) = \\phi_{B}/\\bar{\\phi}$，以及 $g(1) = \\phi_{T}/\\bar{\\phi}$。\n\n将该节块划分为一个均匀的 $4 \\times 4$ 燃料棒（子栅元）阵列，在参考坐标系中每个燃料棒的大小为 $0.5 \\times 0.5$。将燃料棒平均功率定义为 $\\phi(x,y)$ 在每个子栅元上的面积平均值。在上述可分离重构和约束条件下，计算此节块内的燃料棒功率峰值因子，该因子定义为最大燃料棒平均功率与节块平均功率之比。请将您的最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算一个均质化方形燃料节块的燃料棒功率峰值因子。该因子定义为最大燃料棒平均功率与节块平均功率之比。鉴于宏观截面是均匀的，局部功率密度与局部标量通量成正比，即 $P(x,y) \\propto \\phi(x,y)$。因此，燃料棒功率峰值因子等同于燃料棒通量峰值因子，即最大燃料棒平均标量通量与节块平均标量通量之比。节块平均标量通量给定为 $\\bar{\\phi} = 1$。\n\n节块内标量通量通过在域 $[-1,1] \\times [-1,1]$ 上的可分离多项式展开来近似：\n$$\n\\phi(x,y) = \\bar{\\phi}\\, f(x)\\, g(y)\n$$\n由于 $\\bar{\\phi}=1$，我们有 $\\phi(x,y) = f(x)g(y)$。函数 $f(x)$ 和 $g(y)$ 是次数最多为二的多项式。\n\n首先，我们确定多项式 $f(x)$。设 $f(x) = a_2 x^2 + a_1 x + a_0$。提供了三个约束来确定系数 $a_0$、$a_1$ 和 $a_2$。\n1. $f(x)$ 在 $[-1,1]$ 上的平均值为 $1$：\n    $$\n    \\frac{1}{1 - (-1)} \\int_{-1}^{1} f(x) dx = \\frac{1}{2} \\int_{-1}^{1} (a_2 x^2 + a_1 x + a_0) dx = 1\n    $$\n    $$\n    \\frac{1}{2} \\left[ a_2 \\frac{x^3}{3} + a_1 \\frac{x^2}{2} + a_0 x \\right]_{-1}^{1} = \\frac{1}{2} \\left( \\left(\\frac{a_2}{3} + \\frac{a_1}{2} + a_0\\right) - \\left(-\\frac{a_2}{3} + \\frac{a_1}{2} - a_0\\right) \\right) = \\frac{a_2}{3} + a_0 = 1\n    $$\n2. 左侧面（$x=-1$）的面平均通量与给定值 $\\phi_L = 0.90$ 一致：\n    $$\n    f(-1) = a_2(-1)^2 + a_1(-1) + a_0 = a_2 - a_1 + a_0 = \\frac{\\phi_L}{\\bar{\\phi}} = \\frac{0.90}{1} = 0.90\n    $$\n3. 右侧面（$x=1$）的面平均通量与给定值 $\\phi_R = 1.10$ 一致：\n    $$\n    f(1) = a_2(1)^2 + a_1(1) + a_0 = a_2 + a_1 + a_0 = \\frac{\\phi_R}{\\bar{\\phi}} = \\frac{1.10}{1} = 1.10\n    $$\n我们得到一个关于 $a_0, a_1, a_2$ 的三元线性方程组：\n$$\n\\begin{cases}\n\\frac{1}{3}a_2 + a_0 = 1 \\\\\na_2 - a_1 + a_0 = 0.90 \\\\\na_2 + a_1 + a_0 = 1.10\n\\end{cases}\n$$\n将第二个和第三个方程相加得到 $2a_2 + 2a_0 = 2.00$，简化为 $a_2 + a_0 = 1$。从第三个方程减去第二个方程得到 $2a_1 = 0.20$，所以 $a_1 = 0.10$。\n现在我们有两个关于 $a_2$ 和 $a_0$ 的方程：$a_2 + a_0 = 1$ 和 $\\frac{1}{3}a_2 + a_0 = 1$。将这两个方程相减得到 $(\\frac{1}{3} - 1)a_2 = 0$，这意味着 $-\\frac{2}{3}a_2 = 0$，所以 $a_2 = 0$。将 $a_2=0$ 代入 $a_2 + a_0 = 1$ 得到 $a_0 = 1$。\n因此，多项式 $f(x)$ 是 $f(x) = 0.10x + 1$。\n\n接下来，我们确定多项式 $g(y)$。设 $g(y) = b_2 y^2 + b_1 y + b_0$。约束是类似的：\n1. $g(y)$ 在 $[-1,1]$ 上的平均值为 $1$：$\\frac{1}{3}b_2 + b_0 = 1$。\n2. $g(-1) = \\phi_B / \\bar{\\phi} = 0.94 / 1 = 0.94$。\n3. $g(1) = \\phi_T / \\bar{\\phi} = 1.06 / 1 = 1.06$。\n这导出了以下方程组：\n$$\n\\begin{cases}\n\\frac{1}{3}b_2 + b_0 = 1 \\\\\nb_2 - b_1 + b_0 = 0.94 \\\\\nb_2 + b_1 + b_0 = 1.06\n\\end{cases}\n$$\n类似地解这个方程组，我们将第二个和第三个方程相加和相减，得到 $b_2+b_0=1$ 和 $b_1 = 0.06$。从 $b_2+b_0=1$ 和 $\\frac{1}{3}b_2+b_0=1$，我们得到 $b_2=0$ 和 $b_0=1$。\n因此，多项式 $g(y)$ 是 $g(y) = 0.06y + 1$。\n\n节块内通量分布为 $\\phi(x,y) = (0.10x + 1)(0.06y + 1)$。\n\n节块被划分为一个 $4 \\times 4$ 的燃料棒阵列。参考域 $[-1,1] \\times [-1,1]$ 被分为 16 个子栅元，每个大小为 $0.5 \\times 0.5$。设一个燃料棒由 $(i,j)$ 索引，其中 $i,j \\in \\{1,2,3,4\\}$，覆盖域 $[x_{i-1}, x_i] \\times [y_{j-1}, y_j]$，其中 $x_i = -1 + 0.5i$ 和 $y_j = -1 + 0.5j$。每个燃料棒的面积是 $A_{pin} = 0.5 \\times 0.5 = 0.25$。\n燃料棒 $(i,j)$ 的棒平均通量为：\n$$\n\\bar{\\phi}_{ij} = \\frac{1}{A_{pin}} \\int_{y_{j-1}}^{y_j} \\int_{x_{i-1}}^{x_i} \\phi(x,y) \\,dx\\,dy = \\frac{1}{0.25} \\int_{y_{j-1}}^{y_j} \\int_{x_{i-1}}^{x_i} f(x)g(y) \\,dx\\,dy\n$$\n由于通量的可分离形式，这变为：\n$$\n\\bar{\\phi}_{ij} = 4 \\left( \\int_{x_{i-1}}^{x_i} f(x) \\,dx \\right) \\left( \\int_{y_{j-1}}^{y_j} g(y) \\,dy \\right)\n$$\n为了找到最大的棒平均通量，我们需要找到 $\\bar{\\phi}_{ij}$ 的最大值。函数 $f(x)=0.10x+1$ 随 $x$ 单调递增。函数 $g(y)=0.06y+1$ 随 $y$ 单调递增。因此，$f(x)$ 和 $g(y)$ 的积分在函数本身值最大的区间上将是最大的。这对应于节块的右上角。因此，最大的棒平均通量将出现在燃料棒栅元 $(4,4)$ 中，该栅元对应于域 $[0.5, 1] \\times [0.5, 1]$。\n\n我们计算这个燃料棒所需的积分：\n$$\nF_4 = \\int_{0.5}^{1} f(x) \\,dx = \\int_{0.5}^{1} (0.10x + 1) \\,dx = \\left[ 0.10\\frac{x^2}{2} + x \\right]_{0.5}^{1} = [0.05x^2 + x]_{0.5}^{1}\n$$\n$$\nF_4 = (0.05(1)^2 + 1) - (0.05(0.5)^2 + 0.5) = (1.05) - (0.05 \\times 0.25 + 0.5) = 1.05 - (0.0125 + 0.5) = 1.05 - 0.5125 = 0.5375\n$$\n$$\nG_4 = \\int_{0.5}^{1} g(y) \\,dy = \\int_{0.5}^{1} (0.06y + 1) \\,dy = \\left[ 0.06\\frac{y^2}{2} + y \\right]_{0.5}^{1} = [0.03y^2 + y]_{0.5}^{1}\n$$\n$$\nG_4 = (0.03(1)^2 + 1) - (0.03(0.5)^2 + 0.5) = (1.03) - (0.03 \\times 0.25 + 0.5) = 1.03 - (0.0075 + 0.5) = 1.03 - 0.5075 = 0.5225\n$$\n最大的棒平均通量是 $\\bar{\\phi}_{44}$：\n$$\n\\bar{\\phi}_{44} = 4 F_4 G_4 = 4 \\times (0.5375) \\times (0.5225) = 1.123375\n$$\n燃料棒功率峰值因子是\n$$\n\\text{PPPF} = \\frac{\\max_{i,j} \\bar{\\phi}_{ij}}{\\bar{\\phi}} = \\frac{\\bar{\\phi}_{44}}{1} = 1.123375\n$$\n将结果四舍五入到四位有效数字，我们得到 $1.123$。",
            "answer": "$$\\boxed{1.123}$$"
        }
    ]
}