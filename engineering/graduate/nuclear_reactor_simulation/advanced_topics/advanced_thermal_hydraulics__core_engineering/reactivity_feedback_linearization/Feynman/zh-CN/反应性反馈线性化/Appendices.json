{
    "hands_on_practices": [
        {
            "introduction": "在为复杂系统设计控制策略之前，我们必须首先理解其关键参数如何响应扰动。本练习将通过应用一阶泰勒展开，来量化由温度变化引起的反应性变化，这是分析反应堆固有安全性和反馈特性的基本技能。掌握这种线性化方法是理解和应用更高级控制技术（如反馈线性化）的基石。",
            "id": "4244238",
            "problem": "一个均匀的热中子核反应堆在参考燃料和慢化剂温度 $T_{f0}$ 和 $T_{m0}$ 下，以有效增殖因子 $k_{\\mathrm{eff}}=1$ 在稳定临界状态下运行。堆芯的宏观中子物理特性可以由反应性函数 $\\rho(T_f,T_m)$ 概括，其中反应性根据有效增殖因子定义为 $\\rho \\equiv (k_{\\mathrm{eff}}-1)/k_{\\mathrm{eff}}$。假设在参考状态附近，$\\rho(T_f,T_m)$ 是其自变量的光滑函数。燃料温度 $T_f$ 通过多普勒展宽影响共振吸收，慢化剂温度 $T_m$ 影响中子的热化和慢化剂密度；这两种效应都会改变 $k_{\\mathrm{eff}}$，从而改变 $\\rho$。\n\n在参考状态下，将燃料（多普勒）温度反应性系数 $\\alpha_D$ 和慢化剂温度反应性系数 $\\alpha_M$ 定义为\n$$\n\\alpha_D \\equiv \\left.\\frac{\\partial \\rho}{\\partial T_f}\\right|_{(T_{f0},T_{m0})}, \n\\qquad\n\\alpha_M \\equiv \\left.\\frac{\\partial \\rho}{\\partial T_m}\\right|_{(T_{f0},T_{m0})}.\n$$\n\n使用第一性原理和在 $(T_{f0},T_{m0})$ 附近的小扰动下有效的一阶线性化方法，推导由燃料和慢化剂温度同时从参考状态升高 $(\\Delta T_f,\\Delta T_m)$ 引起的反应性变化 $\\Delta \\rho$ 的主阶表达式。将最终结果表示为包含 $\\alpha_D$、$\\alpha_M$、$\\Delta T_f$ 和 $\\Delta T_m$ 的闭式解析表达式。将 $\\Delta \\rho$ 表示为无量纲量。\n\n然后，根据你的推导，论证为确保在以下意义上实现总体负反馈，$\\alpha_D$ 和 $\\alpha_M$ 需要满足的符号条件：\n- 对于所有正的 $(\\Delta T_f,\\Delta T_m)$，$\\Delta \\rho$ 严格为负。\n- 在堆芯等温升温的特殊情况下，即 $\\Delta T_f=\\Delta T_m>0$，反应性变化 $\\Delta \\rho$ 为负。\n\n你的最终答案必须是 $\\Delta \\rho$ 的单个解析表达式。不需要四舍五入，最终方框内的答案不应包含单位。",
            "solution": "所呈现的问题陈述在科学上是合理的、自洽的且提法得当。这是一个核反应堆物理学中的标准练习，应用了多元泰勒展开的数学原理来推导由温度变化引起的一阶反应性反馈模型。所有术语都有明确的定义，其前提建立在公认的反应堆理论之上。因此，可以构建一个解。\n\n目标是推导反应性变化量 $\\Delta \\rho$ 的表达式，该变化是由燃料和慢化剂温度分别从参考稳定临界状态 $(T_{f0}, T_{m0})$ 发生小扰动 $\\Delta T_f$ 和 $\\Delta T_m$ 引起的。\n\n反应性 $\\rho$ 是燃料温度 $T_f$ 和慢化剂温度 $T_m$ 的函数，记为 $\\rho(T_f, T_m)$。问题指出，该函数在参考工作点 $(T_{f0}, T_{m0})$ 附近是光滑的。这个光滑性条件允许我们使用围绕该点的二元一阶泰勒级数展开来近似该函数。对于函数 $f(x,y)$ 在点 $(x_0, y_0)$ 附近的这种展开的一般形式是：\n$$\nf(x, y) \\approx f(x_0, y_0) + \\left.\\frac{\\partial f}{\\partial x}\\right|_{(x_0, y_0)} (x - x_0) + \\left.\\frac{\\partial f}{\\partial y}\\right|_{(x_0, y_0)} (y - y_0)\n$$\n此近似对于小的位移 $(x - x_0)$ 和 $(y - y_0)$ 是有效的。\n\n将此形式应用于参考状态 $(T_{f0}, T_{m0})$ 附近的反应性函数 $\\rho(T_f, T_m)$，我们得到：\n$$\n\\rho(T_f, T_m) \\approx \\rho(T_{f0}, T_{m0}) + \\left.\\frac{\\partial \\rho}{\\partial T_f}\\right|_{(T_{f0}, T_{m0})} (T_f - T_{f0}) + \\left.\\frac{\\partial \\rho}{\\partial T_m}\\right|_{(T_{f0}, T_{m0})} (T_m - T_{m0})\n$$\n反应性的变化量 $\\Delta \\rho$ 是新温度 $(T_f, T_m)$ 下的反应性与参考温度 $(T_{f0}, T_{m0})$ 下的反应性之差：\n$$\n\\Delta \\rho = \\rho(T_f, T_m) - \\rho(T_{f0}, T_{m0})\n$$\n将泰勒展开代入此定义，我们得到 $\\Delta \\rho$ 的一阶近似：\n$$\n\\Delta \\rho \\approx \\left.\\frac{\\partial \\rho}{\\partial T_f}\\right|_{(T_{f0}, T_{m0})} (T_f - T_{f0}) + \\left.\\frac{\\partial \\rho}{\\partial T_m}\\right|_{(T_{f0}, T_{m0})} (T_m - T_{m0})\n$$\n问题给出了温度扰动和反应性系数的定义：\n-   温度变化为 $\\Delta T_f = T_f - T_{f0}$ 和 $\\Delta T_m = T_m - T_{m0}$。\n-   燃料（多普勒）温度反应性系数为 $\\alpha_D \\equiv \\left.\\frac{\\partial \\rho}{\\partial T_f}\\right|_{(T_{f0}, T_{m0})}$。\n-   慢化剂温度反应性系数为 $\\alpha_M \\equiv \\left.\\frac{\\partial \\rho}{\\partial T_m}\\right|_{(T_{f0}, T_{m0})}$。\n\n此外，在参考状态下，反应堆是临界的，意味着有效增殖因子 $k_{\\mathrm{eff}} = 1$。根据其定义 $\\rho = (k_{\\mathrm{eff}}-1)/k_{\\mathrm{eff}}$，参考状态的反应性为 $\\rho(T_{f0}, T_{m0}) = (1-1)/1 = 0$。这证实了新状态下的反应性 $\\rho(T_f, T_m)$ 本身就是反应性的变化量 $\\Delta \\rho$。\n\n将这些定义代入 $\\Delta \\rho$ 的表达式，我们得到所需的主阶表达式：\n$$\n\\Delta \\rho = \\alpha_D \\Delta T_f + \\alpha_M \\Delta T_m\n$$\n该表达式是无量纲的，因为反应性 $\\rho$ 是一个无量纲量。系数 $\\alpha_D$ 和 $\\alpha_M$ 的单位是温度的倒数（例如，$\\text{K}^{-1}$），而温度变化量 $\\Delta T_f$ 和 $\\Delta T_m$ 的单位是温度（例如，$\\text{K}$），因此它们的乘积是无量纲的，这与预期一致。\n\n接下来，我们论证为实现负反馈所需的 $\\alpha_D$ 和 $\\alpha_M$ 的符号条件。负反馈意味着温度升高会导致反应性降低（$\\Delta \\rho  0$），这反过来又会降低反应堆功率，从而抵消最初的温度升高。这是反应堆固有安全性的一个基本原则。\n\n情况1：对于所有正的温度升高 $(\\Delta T_f > 0, \\Delta T_m > 0)$，$\\Delta \\rho$ 必须严格为负。\n条件是对于所有 $\\Delta T_f > 0$ 和 $\\Delta T_m > 0$，都有 $\\alpha_D \\Delta T_f + \\alpha_M \\Delta T_m  0$。\n考虑一个只有燃料温度升高的情景，即 $\\Delta T_f > 0$ 且 $\\Delta T_m \\to 0^+$。不等式变为 $\\alpha_D \\Delta T_f  0$。由于 $\\Delta T_f > 0$，这必然要求 $\\alpha_D  0$。\n类似地，考虑一个只有慢化剂温度升高的情景，即 $\\Delta T_m > 0$ 且 $\\Delta T_f \\to 0^+$。不等式变为 $\\alpha_M \\Delta T_m  0$。由于 $\\Delta T_m > 0$，这必然要求 $\\alpha_M  0$。\n如果 $\\alpha_D  0$ 和 $\\alpha_M  0$ 同时成立，那么对于任何正的 $\\Delta T_f$ 和 $\\Delta T_m$，$\\alpha_D \\Delta T_f$ 和 $\\alpha_M \\Delta T_m$ 这两项都是负的。因此，它们的和 $\\Delta \\rho$ 将严格为负。因此，为确保对任何温度升高都有稳健的负反馈，两个温度反应性系数都必须为负：\n$$\n\\alpha_D  0 \\quad \\text{and} \\quad \\alpha_M  0\n$$\n\n情况2：在堆芯等温升温的特殊情况下，即 $\\Delta T_f = \\Delta T_m = \\Delta T > 0$，反应性变化 $\\Delta \\rho$ 必须为负。\n我们将 $\\Delta T_f = \\Delta T$ 和 $\\Delta T_m = \\Delta T$ 代入我们推导的表达式中：\n$$\n\\Delta \\rho = \\alpha_D \\Delta T + \\alpha_M \\Delta T = (\\alpha_D + \\alpha_M) \\Delta T\n$$\n为了使 $\\Delta \\rho$ 为负，鉴于 $\\Delta T > 0$，系数之和必须为负：\n$$\n\\alpha_D + \\alpha_M  0\n$$\n这个条件确保了对堆芯均匀温升的稳定性。然而，这是一个比情况1要求更宽松的条件。它允许一个系数为正，只要另一个系数足够负以使它们的和为负（例如，如果多普勒系数是强负值，即 $|\\alpha_D| > \\alpha_M$，那么可以容忍一个正的慢化剂系数 $\\alpha_M > 0$）。这种情况为等温扰动提供了稳定性，但可能对非均匀温度变化隐藏着不稳定性。\n\n要求的主要结果是基于一阶线性化的 $\\Delta \\rho$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\alpha_D \\Delta T_f + \\alpha_M \\Delta T_m}\n$$"
        },
        {
            "introduction": "在掌握了单一函数线性化的基础上，本练习将这一概念推广到整个反应堆动力学方程组。您将推导出系统的状态空间表达式，即现代控制理论中的标准形式 $\\dot{x} = Ax + Bu$。这个过程清晰地揭示了反应堆的物理参数如何转化为控制模型中的数学结构，为设计先进的控制器铺平了道路。",
            "id": "4244240",
            "problem": "一个均匀热核反应堆使用带有一个有效缓发中子群的点动力学模型进行建模，该模型与一个集总参数双节点热工水力表示（燃料和冷却剂）相耦合。变量为中子布居、缓发中子先驱核浓度、燃料温度和冷却剂温度。以下经过充分检验的控制方程和本构关系适用于该非线性模型：\n\n- 中子布居动力学：\n$$\\frac{dn}{dt} = \\frac{\\rho - \\beta}{\\Lambda} n + \\lambda C,$$\n$$\\frac{dC}{dt} = \\frac{\\beta}{\\Lambda} n - \\lambda C.$$\n\n- 燃料和冷却剂能量平衡：\n$$M_f c_f \\frac{dT_f}{dt} = \\kappa n - h A \\left(T_f - T_c\\right),$$\n$$M_c c_c \\frac{dT_c}{dt} = h A \\left(T_f - T_c\\right) - \\dot{m} c_p \\left(T_c - T_{\\text{in}}\\right).$$\n\n- 带有外部控制和线性反馈的总反应性：\n$$\\rho = \\rho_{\\text{ext}} + \\alpha_D \\left(T_f - T_{f0}\\right) + \\alpha_c \\left(T_c - T_{c0}\\right),$$\n其中，$n$ 是中子布居，$C$ 是缓发中子先驱核浓度，$T_f$ 是燃料温度，$T_c$ 是冷却剂温度，$\\rho$ 是反应性，$\\rho_{\\text{ext}}$ 是外部引入的反应性，$\\beta$ 是有效缓发中子份额，$\\Lambda$ 是中子代时间，$\\lambda$ 是先驱核衰变常数，$M_f$ 和 $M_c$ 是燃料和冷却剂的有效热质量，$c_f$ 和 $c_c$ 是燃料和冷却剂的比热容，$h$ 是传热系数，$A$ 是传热面积，$\\dot{m}$ 是冷却剂质量流量，$c_p$ 是冷却剂定压比热容，$T_{\\text{in}}$ 是入口冷却剂温度，$\\kappa$ 是将中子布居与沉积在燃料中的热功率联系起来的比例常数，而 $\\alpha_D$（Doppler 系数）和 $\\alpha_c$（冷却剂密度/温度系数）是恒定的反应性反馈系数。\n\n假设一个稳定工作点，其具有恒定值 $n_0$、$C_0$、$T_{f0}$、$T_{c0}$ 和 $\\rho_0$，满足 $\\rho_0 = 0$ 的稳态平衡和一致的热工稳态。通过 $\\Delta n = n - n_0$、$\\Delta C = C - C_0$、$\\Delta T_f = T_f - T_{f0}$、$\\Delta T_c = T_c - T_{c0}$ 和 $\\Delta \\rho_{\\text{ext}} = \\rho_{\\text{ext}} - \\rho_{\\text{ext},0}$ 来定义围绕该工作点的小微扰，其中 $\\rho_{\\text{ext},0}$ 在稳态下维持 $\\rho_0 = 0$。令输入为 $u = \\Delta \\rho_{\\text{ext}}$，输出为 $y = \\Delta n$。考虑状态向量\n$$x = \\begin{pmatrix} \\Delta n \\\\ \\Delta C \\\\ \\Delta T_f \\\\ \\Delta T_c \\end{pmatrix}.$$\n\n任务：\n- 使用一阶微扰，围绕稳态点推导线性化的状态空间模型 $\\dot{x} = A x + B u$ 和 $y = C x + D u$。用给定的物理参数和稳态值 $n_0$、$C_0$、$T_{f0}$ 和 $T_{c0}$ 来符号化地表示所有矩阵元素。\n- 识别矩阵 $A$ 和输入矩阵 $B$ 中的哪些元素代表了中子学子系统 $\\left(\\Delta n, \\Delta C\\right)$ 和热工水力子系统 $\\left(\\Delta T_f, \\Delta T_c\\right)$ 之间的耦合，并解释这些耦合的物理起源。\n\n最后，报告 Doppler 反馈耦合元素 $A_{13}$ 的解析表达式，即线性化 $A$ 矩阵中第一行第三列的元素，它量化了中子布居速率通过 Doppler 反应性反馈对燃料温度微扰的敏感度。将此 $A_{13}$ 表达式作为你的最终答案。不需要进行数值计算，最终报告的表达式中也不应包含任何单位。",
            "solution": "问题陈述构成了一个非线性动力系统线性化的标准练习，具体来说是耦合了双节点热工水力反馈回路的核反应堆点动力学模型。该问题在科学上基于已确立的反应堆物理原理，在数学上是适定的，并包含其求解所需的所有必要信息。因此，它被认为是一个有效的问题。\n\n解决该问题的过程包括三个主要步骤：\n1.  建立稳态（平衡）工作点条件。\n2.  围绕该平衡点线性化四个非线性状态方程，以推导状态空间表示 $\\dot{x} = A x + B u$。\n3.  识别与物理耦合现象相对应的具体矩阵元素，并提取所需的元素 $A_{13}$。\n\n首先，我们通过将所有时间导数设置为零来建立稳态条件，并用下标 $0$ 表示。变量为 $n_0$、$C_0$、$T_{f0}$ 和 $T_{c0}$。稳态时的外部反应性 $\\rho_{\\text{ext},0}$ 满足总反应性 $\\rho_0 = 0$。\n\n从状态方程得出：\n1.  $\\frac{dn}{dt}|_0 = 0 \\implies \\frac{\\rho_0 - \\beta}{\\Lambda} n_0 + \\lambda C_0 = 0$。给定 $\\rho_0 = 0$，此式变为 $\\frac{-\\beta}{\\Lambda} n_0 + \\lambda C_0 = 0$。\n2.  $\\frac{dC}{dt}|_0 = 0 \\implies \\frac{\\beta}{\\Lambda} n_0 - \\lambda C_0 = 0$。这与第一个方程一致，并得出稳态先驱核浓度 $C_0 = \\frac{\\beta}{\\lambda \\Lambda} n_0$。\n3.  $M_f c_f \\frac{dT_f}{dt}|_0 = 0 \\implies \\kappa n_0 - h A (T_{f0} - T_{c0}) = 0$。这将燃料和冷却剂温度与中子布居联系起来。\n4.  $M_c c_c \\frac{dT_c}{dt}|_0 = 0 \\implies h A (T_{f0} - T_{c0}) - \\dot{m} c_p (T_{c0} - T_{\\text{in}}) = 0$。这将冷却剂温度与燃料温度和入口温度联系起来。\n\n稳态下的反应性方程为 $\\rho_0 = \\rho_{\\text{ext},0} + \\alpha_D (T_{f0} - T_{f0}) + \\alpha_c (T_{c0} - T_{c0}) = \\rho_{\\text{ext},0}$。因为 $\\rho_0 = 0$，所以 $\\rho_{\\text{ext},0} = 0$。\n\n接下来，我们对系统进行线性化。状态向量为 $x = (\\Delta n, \\Delta C, \\Delta T_f, \\Delta T_c)^T$。我们使用记号 $x_1 = \\Delta n$、$x_2 = \\Delta C$、$x_3 = \\Delta T_f$、$x_4 = \\Delta T_c$。输入为 $u = \\Delta \\rho_{\\text{ext}}$。线性化是通过对每个状态方程在稳态点周围进行一阶泰勒展开来执行的。对于每个状态方程 $\\dot{z}_i = f_i(z_1, ..., z_4, u)$，其一般形式为 $\\dot{x}_i \\approx \\sum_{j=1}^{4} \\frac{\\partial f_i}{\\partial z_j}|_0 x_j + \\frac{\\partial f_i}{\\partial u}|_0 u$，其中 $z_1=n, z_2=C, z_3=T_f, z_4=T_c$。\n\n1.  **中子布居方程：**\n    令 $f_1(n, C, T_f, T_c, \\rho_{\\text{ext}}) = \\frac{\\rho - \\beta}{\\Lambda} n + \\lambda C$。总反应性为 $\\rho = \\rho_{\\text{ext}} + \\alpha_D (T_f - T_{f0}) + \\alpha_c (T_c - T_{c0})$。\n    我们对 $\\rho n$ 项进行线性化：\n    $\\rho n \\approx \\rho_0 n_0 + \\left. \\frac{\\partial(\\rho n)}{\\partial n} \\right|_0 \\Delta n + \\left. \\frac{\\partial(\\rho n)}{\\partial T_f} \\right|_0 \\Delta T_f + \\left. \\frac{\\partial(\\rho n)}{\\partial T_c} \\right|_0 \\Delta T_c + \\left. \\frac{\\partial(\\rho n)}{\\partial \\rho_{\\text{ext}}} \\right|_0 \\Delta \\rho_{\\text{ext}}$。\n    由于 $\\rho_0 = 0$，偏导数为：$\\frac{\\partial(\\rho n)}{\\partial n}|_0 = \\rho_0 = 0$，$\\frac{\\partial(\\rho n)}{\\partial T_f}|_0 = n_0 \\frac{\\partial \\rho}{\\partial T_f}|_0 = n_0 \\alpha_D$，$\\frac{\\partial(\\rho n)}{\\partial T_c}|_0 = n_0 \\frac{\\partial \\rho}{\\partial T_c}|_0 = n_0 \\alpha_c$，以及 $\\frac{\\partial(\\rho n)}{\\partial \\rho_{\\text{ext}}}|_0 = n_0 \\frac{\\partial \\rho}{\\partial \\rho_{\\text{ext}}}|_0 = n_0$。\n    因此，线性化的速率方程为：\n    $\\frac{d(\\Delta n)}{dt} = \\frac{1}{\\Lambda} \\left( n_0 \\alpha_D \\Delta T_f + n_0 \\alpha_c \\Delta T_c + n_0 \\Delta \\rho_{\\text{ext}} - \\beta \\Delta n \\right) + \\lambda \\Delta C$。\n    在状态空间形式中，这是 $\\dot{x} = Ax+Bu$ 的第一行：\n    $\\dot{x}_1 = -\\frac{\\beta}{\\Lambda} x_1 + \\lambda x_2 + \\frac{n_0 \\alpha_D}{\\Lambda} x_3 + \\frac{n_0 \\alpha_c}{\\Lambda} x_4 + \\frac{n_0}{\\Lambda} u$。\n\n2.  **先驱核浓度方程：**\n    该方程对 $n$ 和 $C$ 已经是线性的：$\\frac{dC}{dt} = \\frac{\\beta}{\\Lambda} n - \\lambda C$。\n    代入 $n = n_0 + \\Delta n$ 和 $C = C_0 + \\Delta C$：\n    $\\frac{d(C_0 + \\Delta C)}{dt} = \\frac{d(\\Delta C)}{dt} = \\frac{\\beta}{\\Lambda} (n_0 + \\Delta n) - \\lambda (C_0 + \\Delta C) = \\left( \\frac{\\beta}{\\Lambda} n_0 - \\lambda C_0 \\right) + \\frac{\\beta}{\\Lambda} \\Delta n - \\lambda \\Delta C$。\n    括号中的项在稳态时为零。\n    $\\dot{x}_2 = \\frac{\\beta}{\\Lambda} x_1 - \\lambda x_2$。\n\n3.  **燃料温度方程：**\n    该方程对 $n$、$T_f$ 和 $T_c$ 已经是线性的：$M_f c_f \\frac{dT_f}{dt} = \\kappa n - h A (T_f - T_c)$。\n    用微扰表示：\n    $M_f c_f \\frac{d(\\Delta T_f)}{dt} = \\kappa (n_0 + \\Delta n) - h A ((T_{f0} + \\Delta T_f) - (T_{c0} + \\Delta T_c))$。\n    $M_f c_f \\dot{x}_3 = (\\kappa n_0 - h A (T_{f0} - T_{c0})) + \\kappa \\Delta n - h A \\Delta T_f + h A \\Delta T_c$。\n    括号中的项在稳态时为零。\n    $\\dot{x}_3 = \\frac{\\kappa}{M_f c_f} x_1 - \\frac{h A}{M_f c_f} x_3 + \\frac{h A}{M_f c_f} x_4$。\n\n4.  **冷却剂温度方程：**\n    该方程对 $T_f$ 和 $T_c$ 是线性的：$M_c c_c \\frac{dT_c}{dt} = h A (T_f - T_c) - \\dot{m} c_p (T_c - T_{\\text{in}})$。\n    用微扰表示（$T_{\\text{in}}$ 是一个常数）：\n    $M_c c_c \\frac{d(\\Delta T_c)}{dt} = h A ((T_{f0}+\\Delta T_f) - (T_{c0}+\\Delta T_c)) - \\dot{m} c_p ((T_{c0}+\\Delta T_c) - T_{\\text{in}})$。\n    $M_c c_c \\dot{x}_4 = (h A (T_{f0}-T_{c0}) - \\dot{m} c_p (T_{c0}-T_{\\text{in}})) + h A \\Delta T_f - h A \\Delta T_c - \\dot{m} c_p \\Delta T_c$。\n    括号中的项在稳态时为零。\n    $\\dot{x}_4 = \\frac{h A}{M_c c_c} x_3 - \\frac{h A + \\dot{m} c_p}{M_c c_c} x_4$。\n\n综合这些结果，得到状态矩阵 $A$ 和输入矩阵 $B$：\n$$A = \\begin{pmatrix}\n-\\frac{\\beta}{\\Lambda}  \\lambda  \\frac{n_0 \\alpha_D}{\\Lambda}  \\frac{n_0 \\alpha_c}{\\Lambda} \\\\\n\\frac{\\beta}{\\Lambda}  -\\lambda  0  0 \\\\\n\\frac{\\kappa}{M_f c_f}  0  -\\frac{h A}{M_f c_f}  \\frac{h A}{M_f c_f} \\\\\n0  0  \\frac{h A}{M_c c_c}  -\\frac{h A + \\dot{m} c_p}{M_c c_c}\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n\\frac{n_0}{\\Lambda} \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}.$$\n输出方程为 $y = \\Delta n = x_1$，因此输出矩阵为 $C = \\begin{pmatrix} 1  0  0  0 \\end{pmatrix}$，前馈矩阵为 $D = 0$。\n\n中子学子系统 $(\\Delta n, \\Delta C)$ 和热工水力子系统 $(\\Delta T_f, \\Delta T_c)$ 之间的耦合由矩阵 $A$ 的非对角块表示。\n- 项 $A_{31} = \\frac{\\kappa}{M_f c_f}$ 表示从中子学到热工水力学的耦合。它显示了中子布居的变化 $\\Delta n$ 如何引起产热的变化，这反过来又影响燃料温度的变化率 $\\frac{dT_f}{dt}$。\n- 项 $A_{13} = \\frac{n_0 \\alpha_D}{\\Lambda}$ 和 $A_{14} = \\frac{n_0 \\alpha_c}{\\Lambda}$ 表示从热工水力学返回到中子学的耦合。它们代表了反应性反馈机制。燃料温度 $\\Delta T_f$ 或冷却剂温度 $\\Delta T_c$ 的变化会引起反应性变化，这接着影响中子布居的变化率 $\\frac{dn}{dt}$。\n\n所要求的特定元素是 Doppler 反馈耦合元素 $A_{13}$。该元素位于状态矩阵 $A$ 的第一行和第三列。它量化了中子布居的变化率 $\\dot{x}_1$ 如何受到燃料温度微扰 $x_3=\\Delta T_f$ 的影响。\n从我们推导出的矩阵 $A$ 中：\n$$A_{13} = \\frac{n_0 \\alpha_D}{\\Lambda}.$$\n这证实了燃料温度的变化 $\\Delta T_f$ 引入了 $\\alpha_D \\Delta T_f$ 的反应性变化。在点动力学方程的背景下，这个反应性变化导致了中子布居速率的一个源/汇项 $(\\frac{\\rho}{\\Lambda}n)$，当在 $n=n_0$ 附近线性化时，该项变为 $\\frac{n_0}{\\Lambda}\\Delta\\rho = \\frac{n_0}{\\Lambda}(\\alpha_D \\Delta T_f)$。$\\Delta T_f$ 的系数就是所求的元素。",
            "answer": "$$\n\\boxed{\\frac{n_0 \\alpha_D}{\\Lambda}}\n$$"
        },
        {
            "introduction": "本练习将理论从连续时间域带入数字控制器工作的离散时间域。您将实现一个依赖于观测器来估计未测量状态（如缓发中子先驱核浓度）的控制律，并分析其跟踪误差。这项实践揭示了观测器精度与控制性能之间的关键联系，这是任何控制工程师在实际应用中都必须面对的核心问题。",
            "id": "4244192",
            "problem": "考虑一个具有 $m$ 个缓发中子先驱核群的集总参数核反应堆模型的点堆动力学方程。令归一化中子密度为 $n(t)$ (无量纲)，缓发中子先驱核浓度为 $C_i(t)$ (无量纲，与数密度成正比)，净反应性为 $\\rho(t)$ (无量纲，以小数形式表示)，总缓发中子份额为 $\\beta = \\sum_{i=1}^m \\beta_i$ (无量纲)，瞬发中子代时间为 $\\Lambda$ (单位：秒)，先驱核衰变常数为 $\\lambda_i$ (单位：$\\text{s}^{-1}$)，各群缓发中子份额为 $\\beta_i$ (无量纲)。假设没有外部中子源。连续时间动力学方程为\n$$\n\\frac{dn}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} \\, n(t) + \\sum_{i=1}^m \\lambda_i \\, C_i(t),\n$$\n$$\n\\frac{dC_i}{dt} = \\frac{\\beta_i}{\\Lambda} \\, n(t) - \\lambda_i \\, C_i(t), \\quad i = 1,\\dots,m.\n$$\n假设采用采样数据实现方式，采样周期 $h$ (单位：秒) 均匀，并且在每个采样时刻 $k$ 都可以获得 $n_k = n(kh)$ 的测量值。使用前向欧拉离散化构建一个用于缓发中子先驱核浓度的离散时间观测器，其演化规律如下\n$$\n\\hat{C}_{i,k+1} = \\hat{C}_{i,k} + h \\left( \\frac{\\beta_i}{\\Lambda} \\, n_k - \\lambda_i \\, \\hat{C}_{i,k} \\right), \\quad i = 1,\\dots,m,\n$$\n其中 $\\hat{C}_{i,k}$ 是估计的先驱核浓度。使用一个指令离散时间导数 $v_k$ (单位：$\\text{s}^{-1}$) 为中子密度变化率定义一个离散抵消律：\n$$\n\\rho_k = \\beta + \\Lambda \\, \\frac{v_k - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k}}{n_k},\n$$\n该定律应用于采样区间 $[kh,(k+1)h)$。在一个采样区间内，使用前向欧拉法传播真实动力学：\n$$\nn_{k+1} = n_k + h \\left( \\frac{\\rho_k - \\beta}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right),\n$$\n$$\nC_{i,k+1} = C_{i,k} + h \\left( \\frac{\\beta_i}{\\Lambda} \\, n_k - \\lambda_i \\, C_{i,k} \\right).\n$$\n将中子密度变化率的单区间跟踪误差定义为\n$$\nE_k = \\frac{n_{k+1} - n_k}{h} - v_k,\n$$\n单位为 $\\text{s}^{-1}$。从点堆动力学方程以及上述指定的观测器和控制律出发，任务是实现观测器和抵消律，模拟一个采样区间，并为以下每个测试用例计算 $E_k$。所有物理量必须使用指定的单位处理（时间单位为秒，衰变常数单位为 $\\text{s}^{-1}$，变化率量单位为 $\\text{s}^{-1}$）。缓发中子份额 $\\beta_i$ 和衰变常数 $\\lambda_i$ 是固定的、广泛使用的针对 $m = 6$ 个先驱核群的值：\n- $m = 6$,\n- $\\Lambda = 1 \\times 10^{-5}$ $\\text{s}$,\n- $\\lambda_i = [0.0124, 0.0305, 0.1110, 0.3010, 1.1400, 3.0100]$ $\\text{s}^{-1}$,\n- $\\beta_i = [0.00022, 0.00128, 0.00127, 0.00255, 0.00074, 0.00044]$ (无量纲),\n- $\\beta = \\sum_{i=1}^6 \\beta_i$ (无量纲)。\n对于给定的 $n_k$，使用对应于 $\\rho = 0$ (临界，稳态) 的平衡初始真实先驱核浓度，即\n$$\nC_{i,k} = \\frac{\\beta_i}{\\Lambda \\lambda_i} \\, n_k, \\quad i = 1,\\dots,6.\n$$\n定义以下五个测试用例，每个用例指定 $(n_k, h, v_k, \\text{观测器初始化})$：\n- 测试用例 1 (理想情况): $n_k = 1.0$, $h = 0.001$ $\\text{s}$, $v_k = 0.010$ $\\text{s}^{-1}$，以及对于所有 $i$，$\\hat{C}_{i,k} = C_{i,k}$。\n- 测试用例 2 (更粗糙的采样): $n_k = 1.0$, $h = 0.100$ $\\text{s}$, $v_k = 0.010$ $\\text{s}^{-1}$，以及对于所有 $i$，$\\hat{C}_{i,k} = C_{i,k}$。\n- 测试用例 3 (一个群组的观测器失配): $n_k = 1.0$, $h = 0.001$ $\\text{s}$, $v_k = 0.010$ $\\text{s}^{-1}$，以及 $\\hat{C}_{6,k} = 1.10 \\, C_{6,k}$，而对于 $i = 1,\\dots,5$，$\\hat{C}_{i,k} = C_{i,k}$。\n- 测试用例 4 (较低的中子密度): $n_k = 0.200$, $h = 0.001$ $\\text{s}$, $v_k = 0.050$ $\\text{s}^{-1}$，以及对于所有 $i$，$\\hat{C}_{i,k} = C_{i,k}$。\n- 测试用例 5 (较大的指令变化率): $n_k = 1.0$, $h = 0.001$ $\\text{s}$, $v_k = 0.100$ $\\text{s}^{-1}$，以及对于所有 $i$，$\\hat{C}_{i,k} = C_{i,k}$。\n您的程序必须按所述实现离散观测器和抵消律，使用前向欧拉法将真实系统传播一个采样区间，并为每个测试用例计算 $E_k$。您的程序应生成单行输出，其中包含按测试用例顺序排列的结果，形式为逗号分隔的列表，并用方括号括起来，例如 $[E_1,E_2,E_3,E_4,E_5]$，其中每个 $E_j$ 是一个单位为 $\\text{s}^{-1}$ 的浮点数。",
            "solution": "问题陈述经评估有效。它在科学上基于核反应堆动力学和控制理论的原理，参数和方程定义明确，问题提出得当，并且其表述是客观的。因此，我们可以着手解决。\n\n核心任务是计算中子密度变化率的单区间跟踪误差 $E_k$。该误差是基于系统动力学在持续时间为 $h$ 的单个采样区间内进行前向欧拉传播来定义的。其定义为：\n$$\nE_k = \\frac{n_{k+1} - n_k}{h} - v_k\n$$\n其中 $n_k$ 和 $n_{k+1}$ 分别是离散时间步 $k$ 和 $k+1$ 的归一化中子密度，$v_k$ 是指令离散时间中子密度导数。\n\n中子密度 $n(t)$ 的前向欧拉传播公式如下：\n$$\nn_{k+1} = n_k + h \\left( \\frac{\\rho_k - \\beta}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right)\n$$\n此处，$\\rho_k$ 是在区间 $[kh, (k+1)h)$ 上施加的反应性，$\\beta$ 是总缓发中子份额，$\\Lambda$ 是瞬发中子代时间，$\\lambda_i$ 是先驱核衰变常数，$C_{i,k}$ 是在时间 $k$ 的真实先驱核浓度。\n\n我们可以重新排列这个传播方程，以找到实际离散导数的表达式：\n$$\n\\frac{n_{k+1} - n_k}{h} = \\frac{\\rho_k - \\beta}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k}\n$$\n将此表达式代入误差 $E_k$ 的定义中，得到：\n$$\nE_k = \\left( \\frac{\\rho_k - \\beta}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right) - v_k\n$$\n这个 $E_k$ 的表达式取决于所施加的反应性 $\\rho_k$。问题指定了一个离散抵消律（一种反馈线性化的形式），旨在使系统的变化率跟踪指令变化率 $v_k$。该定律是：\n$$\n\\rho_k = \\beta + \\Lambda \\, \\frac{v_k - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k}}{n_k}\n$$\n其中 $\\hat{C}_{i,k}$ 是来自离散时间观测器的估计先驱核浓度。这个控制律的核心思想是通过将 $\\rho_k$ 的表达式代入动力学方程来代数上抵消反应堆的非线性动力学。\n\n让我们将这个 $\\rho_k$ 的表达式代入我们的 $E_k$ 方程中：\n$$\nE_k = \\left( \\frac{\\left( \\beta + \\Lambda \\, \\frac{v_k - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k}}{n_k} \\right) - \\beta}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right) - v_k\n$$\n现在我们可以代数地简化这个表达式。分子中的 $\\beta$ 项相互抵消：\n$$\nE_k = \\left( \\frac{\\Lambda \\, \\frac{v_k - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k}}{n_k}}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right) - v_k\n$$\n$\\Lambda$ 项相互抵消，接着是 $n_k$ 项：\n$$\nE_k = \\left( \\left( v_k - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k} \\right) + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right) - v_k\n$$\n指令变化率 $v_k$ 相互抵消，留下一个非常简单的结果：\n$$\nE_k = \\sum_{i=1}^m \\lambda_i \\, C_{i,k} - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k} = \\sum_{i=1}^m \\lambda_i (C_{i,k} - \\hat{C}_{i,k})\n$$\n这个结果展示了此控制策略的一个基本属性。跟踪误差 $E_k$ 不是指令变化率 $v_k$、采样时间 $h$ 或系统状态 $n_k$ 的函数。它完全由真实先驱核浓度 $C_{i,k}$ 与观测器估计浓度 $\\hat{C}_{i,k}$ 之间的加权失配决定。如果观测器是完美的（即 $\\hat{C}_{i,k} = C_{i,k}$），则误差恒为零，中子密度的离散时间导数将完美匹配指令变化率 $v_k$。对于此单步计算，所指定的离散化和误差定义很巧妙地消除了对离散化误差的任何显式依赖。\n\n为了解决这个问题，我们将为每个测试用例实现所述的完整模拟过程，该过程包括以下步骤：\n$1$. 对于给定的测试用例 $(n_k, h, v_k, \\text{观测器初始化})$，计算常数参数，包括 $\\beta = \\sum_{i=1}^m \\beta_i$。\n$2$. 使用提供的稳态平衡公式确定初始真实先驱核浓度 $C_{i,k}$：$C_{i,k} = \\frac{\\beta_i}{\\Lambda \\lambda_i} n_k$。\n$3$. 根据每个测试用例的规则确定初始估计先驱核浓度 $\\hat{C}_{i,k}$。\n$4$. 使用离散抵消律计算反应性 $\\rho_k$。\n$5$. 使用给定的前向欧拉方程将中子密度传播一个时间步长 $h$，以找到 $n_{k+1}$。\n$6$. 使用其定义 $E_k = (n_{k+1} - n_k)/h - v_k$ 计算误差 $E_k$。\n\n将对五个测试用例中的每一个执行此过程，以生成最终结果。解析推导可作为数值实现的有力验证。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nuclear reactor control problem for five test cases.\n\n    This function implements the discrete observer and cancellation law, simulates\n    one sampling interval of the point reactor kinetics equations using forward\n    Euler, and computes the tracking error E_k for each test case as specified.\n    \"\"\"\n\n    # --- Fixed Physical Constants ---\n    # Prompt neutron generation time (s)\n    LAMBDA_ = 1e-5\n    # Number of delayed neutron groups\n    M = 6\n    # Delayed neutron precursor decay constants (s^-1)\n    LAMBDA_I = np.array([0.0124, 0.0305, 0.1110, 0.3010, 1.1400, 3.0100])\n    # Groupwise delayed neutron fractions (dimensionless)\n    BETA_I = np.array([0.00022, 0.00128, 0.00127, 0.00255, 0.00074, 0.00044])\n    # Total delayed neutron fraction (dimensionless)\n    BETA = np.sum(BETA_I)\n\n    # --- Test Cases ---\n    # Each case is a tuple: (n_k, h, v_k, observer_mismatch_factors)\n    # The observer mismatch factors are multiplied by the true C_{i,k} values\n    # to get the initial \\hat{C}_{i,k} values.\n    test_cases = [\n        # Case 1: Happy path, perfect observer\n        (1.0, 0.001, 0.010, np.ones(M)),\n        # Case 2: Coarser sampling, perfect observer\n        (1.0, 0.100, 0.010, np.ones(M)),\n        # Case 3: Observer mismatch in one group\n        (1.0, 0.001, 0.010, np.array([1.0, 1.0, 1.0, 1.0, 1.0, 1.1])),\n        # Case 4: Lower neutron density, perfect observer\n        (0.200, 0.001, 0.050, np.ones(M)),\n        # Case 5: Larger commanded rate, perfect observer\n        (1.0, 0.001, 0.100, np.ones(M)),\n    ]\n\n    results = []\n    \n    for n_k, h, v_k, observer_factors in test_cases:\n        # Step 1: Calculate initial true precursor concentrations C_{i,k}\n        # C_{i,k} = (beta_i / (Lambda * lambda_i)) * n_k\n        C_ik = (BETA_I / (LAMBDA_ * LAMBDA_I)) * n_k\n\n        # Step 2: Calculate initial estimated precursor concentrations \\hat{C}_{i,k}\n        # This is based on the mismatch factors for the specific test case.\n        C_hat_ik = C_ik * observer_factors\n\n        # Step 3: Calculate the reactivity control law, rho_k\n        # rho_k = beta + Lambda * (v_k - sum(lambda_i * \\hat{C}_{i,k})) / n_k\n        sum_lambda_C_hat = np.sum(LAMBDA_I * C_hat_ik)\n        rho_k = BETA + LAMBDA_ * (v_k - sum_lambda_C_hat) / n_k\n\n        # Step 4: Propagate the true system one step to find n_{k+1}\n        # n_{k+1} = n_k + h * ( (rho_k - beta)/Lambda * n_k + sum(lambda_i * C_{i,k}) )\n        sum_lambda_C = np.sum(LAMBDA_I * C_ik)\n        n_derivative_term = ((rho_k - BETA) / LAMBDA_) * n_k + sum_lambda_C\n        n_k_plus_1 = n_k + h * n_derivative_term\n        \n        # Step 5: Compute the one-interval tracking error, E_k\n        # E_k = (n_{k+1} - n_k) / h - v_k\n        E_k = (n_k_plus_1 - n_k) / h - v_k\n        \n        results.append(E_k)\n\n    # Final print statement in the exact required format.\n    # The list comprehension with '{:.10f}'.format ensures consistent formatting\n    # and handles potential floating point representation issues.\n    print(f\"[{','.join('{:.10f}'.format(r).rstrip('0').rstrip('.') for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}