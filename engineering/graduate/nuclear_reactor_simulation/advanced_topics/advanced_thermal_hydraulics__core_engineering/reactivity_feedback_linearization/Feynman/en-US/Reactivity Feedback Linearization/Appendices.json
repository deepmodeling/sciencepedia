{
    "hands_on_practices": [
        {
            "introduction": "Before designing linear controllers or analyzing reactor stability, we must first represent the inherently nonlinear physical feedback effects using a linear model. This exercise guides you through the foundational step of applying a first-order Taylor series expansion to the reactivity function. By doing so, you will derive the linear model for reactivity feedback and define the crucial concepts of the Doppler coefficient, $\\alpha_D$, and the moderator temperature coefficient, $\\alpha_M$ .",
            "id": "4244238",
            "problem": "A homogeneous thermal nuclear reactor is operating at a steady critical state with effective multiplication factor $k_{\\mathrm{eff}}=1$ at reference fuel and moderator temperatures $T_{f0}$ and $T_{m0}$. The macroscopic neutron physics of the core can be summarized by the reactivity function $\\rho(T_f,T_m)$, where reactivity is defined in terms of the effective multiplication factor by $\\rho \\equiv (k_{\\mathrm{eff}}-1)/k_{\\mathrm{eff}}$. Assume that, near the reference state, $\\rho(T_f,T_m)$ is a smooth function of its arguments. The fuel temperature $T_f$ affects resonance absorption through Doppler broadening, and the moderator temperature $T_m$ affects thermalization and moderation density; both effects alter $k_{\\mathrm{eff}}$ and thus $\\rho$.\n\nDefine the fuel (Doppler) temperature reactivity coefficient $\\alpha_D$ and the moderator temperature reactivity coefficient $\\alpha_M$ at the reference state by\n$$\n\\alpha_D \\equiv \\left.\\frac{\\partial \\rho}{\\partial T_f}\\right|_{(T_{f0},T_{m0})}, \n\\qquad\n\\alpha_M \\equiv \\left.\\frac{\\partial \\rho}{\\partial T_m}\\right|_{(T_{f0},T_{m0})}.\n$$\n\nUsing first principles and a first-order linearization valid for small perturbations about $(T_{f0},T_{m0})$, derive the leading-order expression for the change in reactivity $\\Delta \\rho$ caused by simultaneous fuel and moderator temperature rises $(\\Delta T_f,\\Delta T_m)$ from the reference state. Express your final result as a closed-form analytic expression in terms of $\\alpha_D$, $\\alpha_M$, $\\Delta T_f$, and $\\Delta T_m$. Express $\\Delta \\rho$ as a dimensionless quantity.\n\nThen, justify from your derivation the sign conditions on $\\alpha_D$ and $\\alpha_M$ required to ensure overall negative feedback in the following senses:\n- For all positive $(\\Delta T_f,\\Delta T_m)$, $\\Delta \\rho$ is strictly negative.\n- In the special case of an isothermal core temperature rise with $\\Delta T_f=\\Delta T_m>0$, the change $\\Delta \\rho$ is negative.\n\nYour final answer must be the single analytic expression for $\\Delta \\rho$. No rounding is required, and no units should be included in the final boxed answer.",
            "solution": "The problem statement as presented is scientifically sound, self-contained, and well-posed. It constitutes a standard exercise in nuclear reactor physics, applying the mathematical principle of multivariable Taylor expansion to derive the first-order reactivity feedback model from temperature changes. All terms are clearly defined, and the premises are grounded in established reactor theory. Therefore, a solution can be constructed.\n\nThe objective is to derive an expression for the change in reactivity, $\\Delta \\rho$, resulting from small perturbations in fuel and moderator temperatures, $\\Delta T_f$ and $\\Delta T_m$ respectively, away from a reference steady critical state $(T_{f0}, T_{m0})$.\n\nThe reactivity, $\\rho$, is a function of both fuel temperature $T_f$ and moderator temperature $T_m$, denoted as $\\rho(T_f, T_m)$. The problem states that this function is smooth in the vicinity of the reference operating point $(T_{f0}, T_{m0})$. This smoothness condition allows us to approximate the function using a first-order Taylor series expansion for two variables around this point. The general form of such an expansion for a function $f(x,y)$ around a point $(x_0, y_0)$ is:\n$$\nf(x, y) \\approx f(x_0, y_0) + \\left.\\frac{\\partial f}{\\partial x}\\right|_{(x_0, y_0)} (x - x_0) + \\left.\\frac{\\partial f}{\\partial y}\\right|_{(x_0, y_0)} (y - y_0)\n$$\nThis approximation is valid for small displacements $(x - x_0)$ and $(y - y_0)$.\n\nApplying this formalism to the reactivity function $\\rho(T_f, T_m)$ around the reference state $(T_{f0}, T_{m0})$, we have:\n$$\n\\rho(T_f, T_m) \\approx \\rho(T_{f0}, T_{m0}) + \\left.\\frac{\\partial \\rho}{\\partial T_f}\\right|_{(T_{f0}, T_{m0})} (T_f - T_{f0}) + \\left.\\frac{\\partial \\rho}{\\partial T_m}\\right|_{(T_{f0}, T_{m0})} (T_m - T_{m0})\n$$\nThe change in reactivity, $\\Delta \\rho$, is the difference between the new reactivity at temperatures $(T_f, T_m)$ and the reference reactivity at $(T_{f0}, T_{m0})$:\n$$\n\\Delta \\rho = \\rho(T_f, T_m) - \\rho(T_{f0}, T_{m0})\n$$\nSubstituting the Taylor expansion into this definition, we obtain the first-order approximation for $\\Delta \\rho$:\n$$\n\\Delta \\rho \\approx \\left.\\frac{\\partial \\rho}{\\partial T_f}\\right|_{(T_{f0}, T_{m0})} (T_f - T_{f0}) + \\left.\\frac{\\partial \\rho}{\\partial T_m}\\right|_{(T_{f0}, T_{m0})} (T_m - T_{m0})\n$$\nThe problem provides the definitions for the temperature perturbations and the reactivity coefficients:\n-   The temperature changes are $\\Delta T_f = T_f - T_{f0}$ and $\\Delta T_m = T_m - T_{m0}$.\n-   The fuel (Doppler) temperature reactivity coefficient is $\\alpha_D \\equiv \\left.\\frac{\\partial \\rho}{\\partial T_f}\\right|_{(T_{f0}, T_{m0})}$.\n-   The moderator temperature reactivity coefficient is $\\alpha_M \\equiv \\left.\\frac{\\partial \\rho}{\\partial T_m}\\right|_{(T_{f0}, T_{m0})}$.\n\nFurthermore, at the reference state, the reactor is critical, meaning the effective multiplication factor $k_{\\mathrm{eff}} = 1$. By its definition, $\\rho = (k_{\\mathrm{eff}}-1)/k_{\\mathrm{eff}}$, the reference reactivity is $\\rho(T_{f0}, T_{m0}) = (1-1)/1 = 0$. This confirms that the reactivity at the new state, $\\rho(T_f, T_m)$, is itself the change in reactivity, $\\Delta \\rho$.\n\nSubstituting these definitions into the expression for $\\Delta \\rho$, we arrive at the desired leading-order expression:\n$$\n\\Delta \\rho = \\alpha_D \\Delta T_f + \\alpha_M \\Delta T_m\n$$\nThis expression is dimensionless, as reactivity $\\rho$ is a dimensionless quantity. The coefficients $\\alpha_D$ and $\\alpha_M$ have units of inverse temperature (e.g., $\\text{K}^{-1}$), and the temperature changes $\\Delta T_f$ and $\\Delta T_m$ have units of temperature (e.g., $\\text{K}$), so their product is dimensionless, which is consistent.\n\nNext, we justify the sign conditions on $\\alpha_D$ and $\\alpha_M$ required for negative feedback. Negative feedback implies that an increase in temperature leads to a decrease in reactivity ($\\Delta \\rho  0$), which in turn tends to reduce the reactor power and thus counter the initial temperature rise. This is a fundamental principle of inherent reactor safety.\n\nCase 1: For all positive temperature rises $(\\Delta T_f  0, \\Delta T_m  0)$, $\\Delta \\rho$ must be strictly negative.\nThe condition is $\\alpha_D \\Delta T_f + \\alpha_M \\Delta T_m  0$ for all $\\Delta T_f  0$ and $\\Delta T_m  0$.\nConsider a scenario where only the fuel temperature rises, so $\\Delta T_f  0$ and $\\Delta T_m \\to 0^+$. The inequality becomes $\\alpha_D \\Delta T_f  0$. Since $\\Delta T_f  0$, this necessitates $\\alpha_D  0$.\nSimilarly, consider a scenario where only the moderator temperature rises, so $\\Delta T_m  0$ and $\\Delta T_f \\to 0^+$. The inequality becomes $\\alpha_M \\Delta T_m  0$. Since $\\Delta T_m  0$, this necessitates $\\alpha_M  0$.\nIf both $\\alpha_D  0$ and $\\alpha_M  0$, then for any positive $\\Delta T_f$ and $\\Delta T_m$, the terms $\\alpha_D \\Delta T_f$ and $\\alpha_M \\Delta T_m$ are both negative. Their sum, $\\Delta \\rho$, will therefore be strictly negative. Thus, the condition for robust negative feedback against any temperature increase is that both temperature coefficients of reactivity must be negative:\n$$\n\\alpha_D  0 \\quad \\text{and} \\quad \\alpha_M  0\n$$\n\nCase 2: In the special case of an isothermal core temperature rise, $\\Delta T_f = \\Delta T_m = \\Delta T  0$, the change $\\Delta \\rho$ must be negative.\nWe substitute $\\Delta T_f = \\Delta T$ and $\\Delta T_m = \\Delta T$ into our derived expression:\n$$\n\\Delta \\rho = \\alpha_D \\Delta T + \\alpha_M \\Delta T = (\\alpha_D + \\alpha_M) \\Delta T\n$$\nFor $\\Delta \\rho$ to be negative, given that $\\Delta T  0$, the sum of the coefficients must be negative:\n$$\n\\alpha_D + \\alpha_M  0\n$$\nThis condition ensures stability against a uniform temperature rise across the core. However, it is a less stringent condition than Case 1. It allows for one coefficient to be positive, provided the other is sufficiently negative to make the sum negative (e.g., a positive moderator coefficient, $\\alpha_M  0$, can be tolerated if the Doppler coefficient is strongly negative, i.e., $|\\alpha_D|  \\alpha_M$). Such a situation grants stability for isothermal perturbations but may harbor instabilities for non-uniform temperature changes.\n\nThe primary result requested is the closed-form analytic expression for $\\Delta \\rho$ based on the first-order linearization.",
            "answer": "$$\n\\boxed{\\alpha_D \\Delta T_f + \\alpha_M \\Delta T_m}\n$$"
        },
        {
            "introduction": "With an understanding of linear feedback coefficients, the next logical step is to integrate them into a comprehensive dynamic model of the entire reactor system. This practice involves constructing a full state-space representation, $\\dot{x} = Ax + Bu$, that couples the neutron kinetics with the thermal-hydraulic behavior of the core. This is a key exercise in translating physical reactor processes into the mathematical framework required for modern control design and stability analysis .",
            "id": "4244240",
            "problem": "A homogeneous thermal nuclear reactor is modeled using point kinetics with one effective delayed neutron group, coupled to a lumped-parameter two-node thermal-hydraulic representation (fuel and coolant). The variables are neutron population, delayed neutron precursor concentration, fuel temperature, and coolant temperature. The following well-tested governing equations and constitutive relations apply for the nonlinear model:\n\n- Neutron population kinetics:\n$$\\frac{dn}{dt} = \\frac{\\rho - \\beta}{\\Lambda} n + \\lambda C,$$\n$$\\frac{dC}{dt} = \\frac{\\beta}{\\Lambda} n - \\lambda C.$$\n\n- Fuel and coolant energy balances:\n$$M_f c_f \\frac{dT_f}{dt} = \\kappa n - h A \\left(T_f - T_c\\right),$$\n$$M_c c_c \\frac{dT_c}{dt} = h A \\left(T_f - T_c\\right) - \\dot{m} c_p \\left(T_c - T_{\\text{in}}\\right).$$\n\n- Total reactivity with external control and linear feedback:\n$$\\rho = \\rho_{\\text{ext}} + \\alpha_D \\left(T_f - T_{f0}\\right) + \\alpha_c \\left(T_c - T_{c0}\\right),$$\nwhere $n$ is the neutron population, $C$ is the delayed neutron precursor concentration, $T_f$ is the fuel temperature, $T_c$ is the coolant temperature, $\\rho$ is the reactivity, $\\rho_{\\text{ext}}$ is the externally imposed reactivity, $\\beta$ is the effective delayed neutron fraction, $\\Lambda$ is the neutron generation time, $\\lambda$ is the precursor decay constant, $M_f$ and $M_c$ are the effective thermal masses of the fuel and coolant, $c_f$ and $c_c$ are the specific heats of the fuel and coolant, $h$ is the heat transfer coefficient, $A$ is the heat transfer area, $\\dot{m}$ is the coolant mass flow rate, $c_p$ is the coolant specific heat at constant pressure, $T_{\\text{in}}$ is the inlet coolant temperature, $\\kappa$ is the proportionality relating neutron population to thermal power deposited in the fuel, and $\\alpha_D$ (Doppler coefficient) and $\\alpha_c$ (coolant density/temperature coefficient) are constant reactivity feedback coefficients.\n\nAssume a steady operating point with constant values $n_0$, $C_0$, $T_{f0}$, $T_{c0}$, and $\\rho_0$, satisfying steady balance with $\\rho_0 = 0$ and consistent thermal steady-state. Define small perturbations around the operating point by $\\Delta n = n - n_0$, $\\Delta C = C - C_0$, $\\Delta T_f = T_f - T_{f0}$, $\\Delta T_c = T_c - T_{c0}$, and $\\Delta \\rho_{\\text{ext}} = \\rho_{\\text{ext}} - \\rho_{\\text{ext},0}$, where $\\rho_{\\text{ext},0}$ maintains $\\rho_0 = 0$ at steady-state. Let the input be $u = \\Delta \\rho_{\\text{ext}}$ and the output be $y = \\Delta n$. Consider the state vector\n$$x = \\begin{pmatrix} \\Delta n \\\\ \\Delta C \\\\ \\Delta T_f \\\\ \\Delta T_c \\end{pmatrix}.$$\n\nTasks:\n- Derive the linearized state-space model $\\dot{x} = A x + B u$ and $y = C x + D u$ about the steady state using first-order perturbations. Express all entries symbolically in terms of the given physical parameters and steady-state values $n_0$, $C_0$, $T_{f0}$, and $T_{c0}$.\n- Identify which entries of the matrix $A$ and the input matrix $B$ represent coupling between the neutronic subsystem $\\left(\\Delta n, \\Delta C\\right)$ and the thermal-hydraulic subsystem $\\left(\\Delta T_f, \\Delta T_c\\right)$ and explain the physical origin of these couplings.\n\nFinally, report the analytic expression for the Doppler feedback coupling element $A_{13}$, i.e., the element in the first row and third column of the linearized $A$ matrix that quantifies the sensitivity of the neutron population rate to fuel temperature perturbations via Doppler reactivity feedback. Provide this $A_{13}$ expression as your final answer. No numerical evaluation is required, and no units should be included in the final reported expression.",
            "solution": "The problem statement constitutes a standard exercise in the linearization of a nonlinear dynamic system, specifically the point kinetics model for a nuclear reactor coupled with a two-node thermal-hydraulic feedback loop. The problem is scientifically grounded in established reactor physics principles, is mathematically well-posed, and contains all necessary information for its solution. Therefore, it is deemed a valid problem.\n\nThe process to solve the problem involves three main steps:\n1.  Establish the steady-state (equilibrium) operating point conditions.\n2.  Linearize the four nonlinear state equations around this equilibrium point to derive the state-space representation $\\dot{x} = A x + B u$.\n3.  Identify the specific matrix elements corresponding to physical coupling phenomena and extract the required element $A_{13}$.\n\nFirst, we establish the steady-state conditions by setting all time derivatives to zero, denoted by the subscript $0$. The variables are $n_0$, $C_0$, $T_{f0}$, and $T_{c0}$. The external reactivity at steady state, $\\rho_{\\text{ext},0}$, is such that the total reactivity $\\rho_0 = 0$.\n\nFrom the state equations:\n1.  $\\frac{dn}{dt}|_0 = 0 \\implies \\frac{\\rho_0 - \\beta}{\\Lambda} n_0 + \\lambda C_0 = 0$. Given $\\rho_0 = 0$, this becomes $\\frac{-\\beta}{\\Lambda} n_0 + \\lambda C_0 = 0$.\n2.  $\\frac{dC}{dt}|_0 = 0 \\implies \\frac{\\beta}{\\Lambda} n_0 - \\lambda C_0 = 0$. This is consistent with the first equation and yields the steady-state precursor concentration $C_0 = \\frac{\\beta}{\\lambda \\Lambda} n_0$.\n3.  $M_f c_f \\frac{dT_f}{dt}|_0 = 0 \\implies \\kappa n_0 - h A (T_{f0} - T_{c0}) = 0$. This relates fuel and coolant temperatures to the neutron population.\n4.  $M_c c_c \\frac{dT_c}{dt}|_0 = 0 \\implies h A (T_{f0} - T_{c0}) - \\dot{m} c_p (T_{c0} - T_{\\text{in}}) = 0$. This relates the coolant temperature to the fuel temperature and the inlet temperature.\n\nThe reactivity equation at steady state is $\\rho_0 = \\rho_{\\text{ext},0} + \\alpha_D (T_{f0} - T_{f0}) + \\alpha_c (T_{c0} - T_{c0}) = \\rho_{\\text{ext},0}$. Since $\\rho_0 = 0$, it follows that $\\rho_{\\text{ext},0} = 0$.\n\nNext, we linearize the system. The state vector is $x = (\\Delta n, \\Delta C, \\Delta T_f, \\Delta T_c)^T$. We use the notation $x_1 = \\Delta n$, $x_2 = \\Delta C$, $x_3 = \\Delta T_f$, $x_4 = \\Delta T_c$. The input is $u = \\Delta \\rho_{\\text{ext}}$. The linearization is performed by taking the first-order Taylor expansion of each state equation around the steady-state point. The general form for each state equation $\\dot{z}_i = f_i(z_1, ..., z_4, u)$ is $\\dot{x}_i \\approx \\sum_{j=1}^{4} \\frac{\\partial f_i}{\\partial z_j}|_0 x_j + \\frac{\\partial f_i}{\\partial u}|_0 u$, where $z_1=n, z_2=C, z_3=T_f, z_4=T_c$.\n\n1.  **Neutron population equation:**\n    Let $f_1(n, C, T_f, T_c, \\rho_{\\text{ext}}) = \\frac{\\rho - \\beta}{\\Lambda} n + \\lambda C$. The total reactivity is $\\rho = \\rho_{\\text{ext}} + \\alpha_D (T_f - T_{f0}) + \\alpha_c (T_c - T_{c0})$.\n    We linearize the term $\\rho n$:\n    $\\rho n \\approx \\rho_0 n_0 + \\left. \\frac{\\partial(\\rho n)}{\\partial n} \\right|_0 \\Delta n + \\left. \\frac{\\partial(\\rho n)}{\\partial T_f} \\right|_0 \\Delta T_f + \\left. \\frac{\\partial(\\rho n)}{\\partial T_c} \\right|_0 \\Delta T_c + \\left. \\frac{\\partial(\\rho n)}{\\partial \\rho_{\\text{ext}}} \\right|_0 \\Delta \\rho_{\\text{ext}}$.\n    Since $\\rho_0 = 0$, the partial derivatives are: $\\frac{\\partial(\\rho n)}{\\partial n}|_0 = \\rho_0 = 0$, $\\frac{\\partial(\\rho n)}{\\partial T_f}|_0 = n_0 \\frac{\\partial \\rho}{\\partial T_f}|_0 = n_0 \\alpha_D$, $\\frac{\\partial(\\rho n)}{\\partial T_c}|_0 = n_0 \\frac{\\partial \\rho}{\\partial T_c}|_0 = n_0 \\alpha_c$, and $\\frac{\\partial(\\rho n)}{\\partial \\rho_{\\text{ext}}}|_0 = n_0 \\frac{\\partial \\rho}{\\partial \\rho_{\\text{ext}}}|_0 = n_0$.\n    So, the linearized rate equation is:\n    $\\frac{d(\\Delta n)}{dt} = \\frac{1}{\\Lambda} \\left( n_0 \\alpha_D \\Delta T_f + n_0 \\alpha_c \\Delta T_c + n_0 \\Delta \\rho_{\\text{ext}} - \\beta \\Delta n \\right) + \\lambda \\Delta C$.\n    In state-space form, this is the first row of $\\dot{x} = Ax+Bu$:\n    $\\dot{x}_1 = -\\frac{\\beta}{\\Lambda} x_1 + \\lambda x_2 + \\frac{n_0 \\alpha_D}{\\Lambda} x_3 + \\frac{n_0 \\alpha_c}{\\Lambda} x_4 + \\frac{n_0}{\\Lambda} u$.\n\n2.  **Precursor concentration equation:**\n    This equation is already linear in $n$ and $C$: $\\frac{dC}{dt} = \\frac{\\beta}{\\Lambda} n - \\lambda C$.\n    Substituting $n = n_0 + \\Delta n$ and $C = C_0 + \\Delta C$:\n    $\\frac{d(C_0 + \\Delta C)}{dt} = \\frac{d(\\Delta C)}{dt} = \\frac{\\beta}{\\Lambda} (n_0 + \\Delta n) - \\lambda (C_0 + \\Delta C) = \\left( \\frac{\\beta}{\\Lambda} n_0 - \\lambda C_0 \\right) + \\frac{\\beta}{\\Lambda} \\Delta n - \\lambda \\Delta C$.\n    The term in parentheses is zero at steady state.\n    $\\dot{x}_2 = \\frac{\\beta}{\\Lambda} x_1 - \\lambda x_2$.\n\n3.  **Fuel temperature equation:**\n    This equation is already linear in $n$, $T_f$, and $T_c$: $M_f c_f \\frac{dT_f}{dt} = \\kappa n - h A (T_f - T_c)$.\n    In terms of perturbations:\n    $M_f c_f \\frac{d(\\Delta T_f)}{dt} = \\kappa (n_0 + \\Delta n) - h A ((T_{f0} + \\Delta T_f) - (T_{c0} + \\Delta T_c))$.\n    $M_f c_f \\dot{x}_3 = (\\kappa n_0 - h A (T_{f0} - T_{c0})) + \\kappa \\Delta n - h A \\Delta T_f + h A \\Delta T_c$.\n    The term in parentheses is zero at steady state.\n    $\\dot{x}_3 = \\frac{\\kappa}{M_f c_f} x_1 - \\frac{h A}{M_f c_f} x_3 + \\frac{h A}{M_f c_f} x_4$.\n\n4.  **Coolant temperature equation:**\n    This equation is linear in $T_f$ and $T_c$: $M_c c_c \\frac{dT_c}{dt} = h A (T_f - T_c) - \\dot{m} c_p (T_c - T_{\\text{in}})$.\n    In terms of perturbations ($T_{\\text{in}}$ is a constant):\n    $M_c c_c \\frac{d(\\Delta T_c)}{dt} = h A ((T_{f0}+\\Delta T_f) - (T_{c0}+\\Delta T_c)) - \\dot{m} c_p ((T_{c0}+\\Delta T_c) - T_{\\text{in}})$.\n    $M_c c_c \\dot{x}_4 = (h A (T_{f0}-T_{c0}) - \\dot{m} c_p (T_{c0}-T_{\\text{in}})) + h A \\Delta T_f - h A \\Delta T_c - \\dot{m} c_p \\Delta T_c$.\n    The term in parentheses is zero at steady state.\n    $\\dot{x}_4 = \\frac{h A}{M_c c_c} x_3 - \\frac{h A + \\dot{m} c_p}{M_c c_c} x_4$.\n\nAssembling these results yields the state matrix $A$ and input matrix $B$:\n$$A = \\begin{pmatrix}\n-\\frac{\\beta}{\\Lambda}  \\lambda  \\frac{n_0 \\alpha_D}{\\Lambda}  \\frac{n_0 \\alpha_c}{\\Lambda} \\\\\n\\frac{\\beta}{\\Lambda}  -\\lambda  0  0 \\\\\n\\frac{\\kappa}{M_f c_f}  0  -\\frac{h A}{M_f c_f}  \\frac{h A}{M_f c_f} \\\\\n0  0  \\frac{h A}{M_c c_c}  -\\frac{h A + \\dot{m} c_p}{M_c c_c}\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n\\frac{n_0}{\\Lambda} \\\\\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}.$$\nThe output equation is $y = \\Delta n = x_1$, so the output matrix is $C = \\begin{pmatrix} 1  0  0  0 \\end{pmatrix}$ and the feedthrough matrix is $D = 0$.\n\nThe coupling between the neutronic subsystem $(\\Delta n, \\Delta C)$ and the thermal-hydraulic subsystem $(\\Delta T_f, \\Delta T_c)$ is represented by the off-diagonal blocks of the matrix $A$.\n- The term $A_{31} = \\frac{\\kappa}{M_f c_f}$ represents the coupling from neutronics to thermal-hydraulics. It shows how a change in neutron population $\\Delta n$ causes a change in heat generation, which in turn affects the fuel temperature rate of change $\\frac{dT_f}{dt}$.\n- The terms $A_{13} = \\frac{n_0 \\alpha_D}{\\Lambda}$ and $A_{14} = \\frac{n_0 \\alpha_c}{\\Lambda}$ represent the coupling from thermal-hydraulics back to neutronics. They represent the reactivity feedback mechanisms. A change in fuel temperature $\\Delta T_f$ or coolant temperature $\\Delta T_c$ induces a reactivity change, which then affects the neutron population rate of change $\\frac{dn}{dt}$.\n\nThe specific element requested is the Doppler feedback coupling element $A_{13}$. This element is found in the first row and third column of the state matrix $A$. It quantifies how the rate of change of the neutron population, $\\dot{x}_1$, is affected by a perturbation in the fuel temperature, $x_3=\\Delta T_f$.\nFrom our derived matrix $A$:\n$$A_{13} = \\frac{n_0 \\alpha_D}{\\Lambda}.$$\nThis confirms that a change in fuel temperature, $\\Delta T_f$, introduces a reactivity change of $\\alpha_D \\Delta T_f$. This reactivity change, in the context of the point kinetics equation, results in a source/sink term for the neutron population rate of $(\\frac{\\rho}{\\Lambda}n)$, which, when linearized around $n=n_0$, becomes $\\frac{n_0}{\\Lambda}\\Delta\\rho = \\frac{n_0}{\\Lambda}(\\alpha_D \\Delta T_f)$. The coefficient of $\\Delta T_f$ is the desired element.",
            "answer": "$$\n\\boxed{\\frac{n_0 \\alpha_D}{\\Lambda}}\n$$"
        },
        {
            "introduction": "This final practice moves from modeling to direct application, challenging you to implement a feedback linearization control law in a more realistic discrete-time environment. You will use a state observer to estimate unmeasured precursor concentrations and see how the control law uses these estimates to cancel the system's nonlinear dynamics. This exercise demonstrates a critical principle: the performance of a feedback linearization controller is fundamentally limited by the accuracy of the model and state estimates upon which it depends .",
            "id": "4244192",
            "problem": "Consider the point reactor kinetics equations for a lumped-parameter nuclear reactor model with $m$ delayed neutron precursor groups. Let the normalized neutron density be $n(t)$ (dimensionless), the delayed neutron precursor concentrations be $C_i(t)$ (dimensionless, proportional to number density), the net reactivity be $\\rho(t)$ (dimensionless, expressed as a decimal fraction), the total delayed neutron fraction be $\\beta = \\sum_{i=1}^m \\beta_i$ (dimensionless), the prompt neutron generation time be $\\Lambda$ (in seconds), the precursor decay constants be $\\lambda_i$ (in $\\text{s}^{-1}$), and the groupwise delayed fractions be $\\beta_i$ (dimensionless). Assume no external neutron source. The continuous-time dynamics are\n$$\n\\frac{dn}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} \\, n(t) + \\sum_{i=1}^m \\lambda_i \\, C_i(t),\n$$\n$$\n\\frac{dC_i}{dt} = \\frac{\\beta_i}{\\Lambda} \\, n(t) - \\lambda_i \\, C_i(t), \\quad i = 1,\\dots,m.\n$$\nAssume a sampled-data implementation with uniform sampling period $h$ (in seconds), and measurements of $n_k = n(kh)$ available at each sampling instant $k$. Use forward Euler discretization to construct a discrete-time observer for the delayed neutron precursor concentrations that evolves as\n$$\n\\hat{C}_{i,k+1} = \\hat{C}_{i,k} + h \\left( \\frac{\\beta_i}{\\Lambda} \\, n_k - \\lambda_i \\, \\hat{C}_{i,k} \\right), \\quad i = 1,\\dots,m,\n$$\nwhere $\\hat{C}_{i,k}$ are the estimated precursor concentrations. Define a discrete cancellation law for the neutron density rate using a commanded discrete-time derivative $v_k$ (in $\\text{s}^{-1}$):\n$$\n\\rho_k = \\beta + \\Lambda \\, \\frac{v_k - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k}}{n_k},\n$$\nto be applied over the sampling interval $[kh,(k+1)h)$. Over one sampling interval, propagate the true dynamics using forward Euler:\n$$\nn_{k+1} = n_k + h \\left( \\frac{\\rho_k - \\beta}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right),\n$$\n$$\nC_{i,k+1} = C_{i,k} + h \\left( \\frac{\\beta_i}{\\Lambda} \\, n_k - \\lambda_i \\, C_{i,k} \\right).\n$$\nDefine the one-interval tracking error for the neutron density rate as\n$$\nE_k = \\frac{n_{k+1} - n_k}{h} - v_k,\n$$\nin units of $\\text{s}^{-1}$. Starting from the point-reactor kinetics equations and the observer and control laws specified above, the task is to implement the observer and cancellation law, simulate one sampling interval, and compute $E_k$ for each of the test cases below. All physical quantities must be treated with the units specified (time in seconds, decay constants in $\\text{s}^{-1}$, and rate quantities in $\\text{s}^{-1}$). The delayed neutron fractions $\\beta_i$ and decay constants $\\lambda_i$ are fixed, widely used values for $m = 6$ precursor groups:\n- $m = 6$,\n- $\\Lambda = 1 \\times 10^{-5}$ $\\text{s}$,\n- $\\lambda_i = [0.0124, 0.0305, 0.1110, 0.3010, 1.1400, 3.0100]$ $\\text{s}^{-1}$,\n- $\\beta_i = [0.00022, 0.00128, 0.00127, 0.00255, 0.00074, 0.00044]$ (dimensionless),\n- $\\beta = \\sum_{i=1}^6 \\beta_i$ (dimensionless).\nUse the equilibrium initial true precursor concentrations corresponding to $\\rho = 0$ (critical, steady-state) for a given $n_k$, namely\n$$\nC_{i,k} = \\frac{\\beta_i}{\\Lambda \\lambda_i} \\, n_k, \\quad i = 1,\\dots,6.\n$$\nDefine the following five test cases, each specifying $(n_k, h, v_k, \\text{observer initialization})$:\n- Test case $1$ (happy path): $n_k = 1.0$, $h = 0.001$ $\\text{s}$, $v_k = 0.010$ $\\text{s}^{-1}$, and $\\hat{C}_{i,k} = C_{i,k}$ for all $i$.\n- Test case $2$ (coarser sampling): $n_k = 1.0$, $h = 0.100$ $\\text{s}$, $v_k = 0.010$ $\\text{s}^{-1}$, and $\\hat{C}_{i,k} = C_{i,k}$ for all $i$.\n- Test case $3$ (observer mismatch in one group): $n_k = 1.0$, $h = 0.001$ $\\text{s}$, $v_k = 0.010$ $\\text{s}^{-1}$, and $\\hat{C}_{6,k} = 1.10 \\, C_{6,k}$ while $\\hat{C}_{i,k} = C_{i,k}$ for $i = 1,\\dots,5$.\n- Test case $4$ (lower neutron density): $n_k = 0.200$, $h = 0.001$ $\\text{s}$, $v_k = 0.050$ $\\text{s}^{-1}$, and $\\hat{C}_{i,k} = C_{i,k}$ for all $i$.\n- Test case $5$ (larger commanded rate): $n_k = 1.0$, $h = 0.001$ $\\text{s}$, $v_k = 0.100$ $\\text{s}^{-1}$, and $\\hat{C}_{i,k} = C_{i,k}$ for all $i$.\nYour program must implement the discrete observer and cancellation as described, propagate the true system over one sampling interval using forward Euler, and compute $E_k$ for each test case. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the test cases, for example, $[E_1,E_2,E_3,E_4,E_5]$, where each $E_j$ is a floating point number in $\\text{s}^{-1}$.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of nuclear reactor kinetics and control theory, well-posed with all necessary parameters and equations defined, and objective in its formulation. We can therefore proceed with a solution.\n\nThe central task is to compute the one-interval tracking error, $E_k$, for the neutron density rate. The error is defined based on a forward Euler propagation of the system dynamics over a single sampling interval of duration $h$. The definition is:\n$$\nE_k = \\frac{n_{k+1} - n_k}{h} - v_k\n$$\nwhere $n_k$ and $n_{k+1}$ are the normalized neutron densities at discrete time steps $k$ and $k+1$, respectively, and $v_k$ is the commanded discrete-time derivative of the neutron density.\n\nThe forward Euler propagation for the neutron density $n(t)$ is given as:\n$$\nn_{k+1} = n_k + h \\left( \\frac{\\rho_k - \\beta}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right)\n$$\nHere, $\\rho_k$ is the reactivity applied over the interval $[kh, (k+1)h)$, $\\beta$ is the total delayed neutron fraction, $\\Lambda$ is the prompt neutron generation time, $\\lambda_i$ are the precursor decay constants, and $C_{i,k}$ are the true precursor concentrations at time $k$.\n\nWe can rearrange this propagation equation to find an expression for the realized discrete derivative:\n$$\n\\frac{n_{k+1} - n_k}{h} = \\frac{\\rho_k - \\beta}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k}\n$$\nSubstituting this into the definition of the error $E_k$ yields:\n$$\nE_k = \\left( \\frac{\\rho_k - \\beta}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right) - v_k\n$$\nThis expression for $E_k$ depends on the applied reactivity, $\\rho_k$. The problem specifies a discrete cancellation law (a form of feedback linearization) designed to make the system's rate of change track the commanded rate $v_k$. The law is:\n$$\n\\rho_k = \\beta + \\Lambda \\, \\frac{v_k - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k}}{n_k}\n$$\nwhere $\\hat{C}_{i,k}$ are the estimated precursor concentrations from a discrete-time observer. The core idea of this control law is to algebraically cancel the reactor's nonlinear dynamics by inserting an expression for $\\rho_k$ into the dynamics equation.\n\nLet us substitute this expression for $\\rho_k$ into our equation for $E_k$:\n$$\nE_k = \\left( \\frac{\\left( \\beta + \\Lambda \\, \\frac{v_k - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k}}{n_k} \\right) - \\beta}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right) - v_k\n$$\nWe can now simplify this expression algebraically. The $\\beta$ terms in the numerator cancel:\n$$\nE_k = \\left( \\frac{\\Lambda \\, \\frac{v_k - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k}}{n_k}}{\\Lambda} \\, n_k + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right) - v_k\n$$\nThe $\\Lambda$ terms cancel, followed by the $n_k$ terms:\n$$\nE_k = \\left( \\left( v_k - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k} \\right) + \\sum_{i=1}^m \\lambda_i \\, C_{i,k} \\right) - v_k\n$$\nThe commanded rate $v_k$ cancels out, leaving a remarkably simple result:\n$$\nE_k = \\sum_{i=1}^m \\lambda_i \\, C_{i,k} - \\sum_{i=1}^m \\lambda_i \\, \\hat{C}_{i,k} = \\sum_{i=1}^m \\lambda_i (C_{i,k} - \\hat{C}_{i,k})\n$$\nThis result demonstrates a fundamental property of this control strategy. The tracking error $E_k$ is not a function of the commanded rate $v_k$, the sampling time $h$, or the system state $n_k$. It is solely determined by the weighted mismatch between the true precursor concentrations $C_{i,k}$ and the observer's estimated concentrations $\\hat{C}_{i,k}$. If the observer is perfect (i.e., $\\hat{C}_{i,k} = C_{i,k}$), the error is identically zero, and the discrete-time derivative of the neutron density will perfectly match the commanded rate $v_k$. The specified discretization and error definition fortuitously remove any explicit dependence on the discretization error for this one-step calculation.\n\nTo solve the problem, we will implement the full simulation procedure as described for each test case, which consists of the following steps:\n$1$. For a given test case $(n_k, h, v_k, \\text{observer initialization})$, calculate the constant parameters, including $\\beta = \\sum_{i=1}^m \\beta_i$.\n$2$. Determine the initial true precursor concentrations $C_{i,k}$ using the provided steady-state equilibrium formula: $C_{i,k} = \\frac{\\beta_i}{\\Lambda \\lambda_i} n_k$.\n$3$. Determine the initial estimated precursor concentrations $\\hat{C}_{i,k}$ according to the rules for each test case.\n$4$. Calculate the reactivity $\\rho_k$ using the discrete cancellation law.\n$5$. Propagate the neutron density over one time step $h$ using the given forward Euler equation to find $n_{k+1}$.\n$6$. Compute the error $E_k$ using its definition, $E_k = (n_{k+1} - n_k)/h - v_k$.\n\nThis procedure will be executed for each of the five test cases to generate the final results. The analytical derivation serves as a powerful validation of the numerical implementation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nuclear reactor control problem for five test cases.\n\n    This function implements the discrete observer and cancellation law, simulates\n    one sampling interval of the point reactor kinetics equations using forward\n    Euler, and computes the tracking error E_k for each test case as specified.\n    \"\"\"\n\n    # --- Fixed Physical Constants ---\n    # Prompt neutron generation time (s)\n    LAMBDA_ = 1e-5\n    # Number of delayed neutron groups\n    M = 6\n    # Delayed neutron precursor decay constants (s^-1)\n    LAMBDA_I = np.array([0.0124, 0.0305, 0.1110, 0.3010, 1.1400, 3.0100])\n    # Groupwise delayed neutron fractions (dimensionless)\n    BETA_I = np.array([0.00022, 0.00128, 0.00127, 0.00255, 0.00074, 0.00044])\n    # Total delayed neutron fraction (dimensionless)\n    BETA = np.sum(BETA_I)\n\n    # --- Test Cases ---\n    # Each case is a tuple: (n_k, h, v_k, observer_mismatch_factors)\n    # The observer mismatch factors are multiplied by the true C_{i,k} values\n    # to get the initial \\hat{C}_{i,k} values.\n    test_cases = [\n        # Case 1: Happy path, perfect observer\n        (1.0, 0.001, 0.010, np.ones(M)),\n        # Case 2: Coarser sampling, perfect observer\n        (1.0, 0.100, 0.010, np.ones(M)),\n        # Case 3: Observer mismatch in one group\n        (1.0, 0.001, 0.010, np.array([1.0, 1.0, 1.0, 1.0, 1.0, 1.1])),\n        # Case 4: Lower neutron density, perfect observer\n        (0.200, 0.001, 0.050, np.ones(M)),\n        # Case 5: Larger commanded rate, perfect observer\n        (1.0, 0.001, 0.100, np.ones(M)),\n    ]\n\n    results = []\n    \n    for n_k, h, v_k, observer_factors in test_cases:\n        # Step 1: Calculate initial true precursor concentrations C_{i,k}\n        # C_{i,k} = (beta_i / (Lambda * lambda_i)) * n_k\n        C_ik = (BETA_I / (LAMBDA_ * LAMBDA_I)) * n_k\n\n        # Step 2: Calculate initial estimated precursor concentrations \\hat{C}_{i,k}\n        # This is based on the mismatch factors for the specific test case.\n        C_hat_ik = C_ik * observer_factors\n\n        # Step 3: Calculate the reactivity control law, rho_k\n        # rho_k = beta + Lambda * (v_k - sum(lambda_i * \\hat{C}_{i,k})) / n_k\n        sum_lambda_C_hat = np.sum(LAMBDA_I * C_hat_ik)\n        rho_k = BETA + LAMBDA_ * (v_k - sum_lambda_C_hat) / n_k\n\n        # Step 4: Propagate the true system one step to find n_{k+1}\n        # n_{k+1} = n_k + h * ( (rho_k - beta)/Lambda * n_k + sum(lambda_i * C_{i,k}) )\n        sum_lambda_C = np.sum(LAMBDA_I * C_ik)\n        n_derivative_term = ((rho_k - BETA) / LAMBDA_) * n_k + sum_lambda_C\n        n_k_plus_1 = n_k + h * n_derivative_term\n        \n        # Step 5: Compute the one-interval tracking error, E_k\n        # E_k = (n_{k+1} - n_k) / h - v_k\n        E_k = (n_k_plus_1 - n_k) / h - v_k\n        \n        results.append(E_k)\n\n    # Final print statement in the exact required format.\n    # The list comprehension with '{:.10f}'.format ensures consistent formatting\n    # and handles potential floating point representation issues.\n    print(f\"[{','.join('{:.10f}'.format(r).rstrip('0').rstrip('.') for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}