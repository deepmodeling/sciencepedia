{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学(CFD)中，对壁面附近湍流的精确建模是准确预测热量传递和压降的关键。本练习将理论与实践相结合，重点关注无量纲壁面距离 $y^+$，它是确定近壁网格分辨率的决定性参数。通过从基本原理出发推导，您将学习如何为壁面函数方法和低雷诺数方法计算必要的第一个网格单元高度，这是任何反应堆堆芯热工水力高保真模拟的基本技能。",
            "id": "4253215",
            "problem": "使用计算流体动力学 (CFD) 对核反应堆棒束子通道进行建模。必须选择近壁面网格分辨率，以便通过壁面函数法或解析粘性子层的低雷诺数法来正确捕捉壁面束缚湍流。从基本定义和经过充分检验的关联式出发，推导连接第一层网格中心点的壁面法向距离、无量纲壁面坐标和流动特性的普适关系。然后，使用以下压水堆 (PWR) 子通道的物理真实堆芯热工水力条件，计算两种方法所需的第一层网格中心点距离：\n- 冷却剂为高压液态水，建模为牛顿流体，其密度 $\\rho = 700\\,\\mathrm{kg/m^3}$，动力粘度 $\\mu = 1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$。\n- 流动在光滑壁面的子通道内为充分发展的湍流，水力直径为 $D_{h} = 9.0\\times 10^{-3}\\,\\mathrm{m}$。\n- 质量通量为 $G = 3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}$。\n- 使用 Petukhov 关联式计算光滑管内的达西-魏斯巴赫 (Darcy–Weisbach) 摩擦因子：$f = \\left(0.79\\,\\ln(\\mathrm{Re}) - 1.64\\right)^{-2}$，其中雷诺数 $\\mathrm{Re} = \\dfrac{G\\,D_{h}}{\\mu}$。\n\n您必须从第一性原理出发：\n- 使用无量纲壁面坐标 $y^{+}$ 的定义。\n- 使用以壁面剪切应力和达西摩擦因子表示的摩擦速度的定义。\n- 使用充分发展的内部湍流中壁面剪切应力与达西摩擦因子之间的关系。\n\n对于壁面函数法，目标第一层网格中心点位于 $y^{+} = 30$。对于低雷诺数法，目标第一层网格中心点位于 $y^{+} = 1$。将两个所需的第一层网格中心点距离以微米表示，并将您的答案四舍五入到三位有效数字。最终答案必须是一个计算结果，并且只包含所要求的两个值，排列成一个行矩阵。",
            "solution": "问题陈述已经过验证，被认为是科学合理的、提法恰当的、客观的且自洽的。它展示了计算流体动力学 (CFD) 应用于核反应堆热工水力学领域的一项标准工程计算。所有提供的数据对于指定条件都是物理真实的，并且所要求的任务是清晰且可解的。开始求解。\n\n目标是推导第一层网格中心点离壁距离 $y_p$ 作为无量纲壁面坐标 $y^{+}$ 和其他流动特性的函数关系，然后计算两个目标 $y^{+}$ 值对应的 $y_p$。\n\n推导从无量纲壁面坐标 $y^{+}$ 的定义开始：\n$$y^{+} = \\frac{y_p u_{\\tau}}{\\nu}$$\n其中 $y_p$ 是从壁面到第一层网格中心点的有量纲距离，$u_{\\tau}$ 是摩擦速度，$\\nu$ 是流体的运动粘度。\n\n摩擦速度 $u_{\\tau}$ 由壁面剪切应力 $\\tau_w$ 和流体密度 $\\rho$ 定义：\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}$$\n运动粘度 $\\nu$ 是动力粘度 $\\mu$ 与密度 $\\rho$ 的比值：\n$$\\nu = \\frac{\\mu}{\\rho}$$\n对于通道或管道中的充分发展的湍流，壁面剪切应力 $\\tau_w$ 通过以下方程与主流体速度 $u_b$ 和达西-魏斯巴赫摩擦因子 $f$ 相关联：\n$$\\tau_w = \\frac{1}{8} f \\rho u_b^2$$\n问题提供了质量通量 $G$，它通过 $G = \\rho u_b$ 与主流速度和密度相关。因此，主流速度可以表示为 $u_b = G/\\rho$。将此代入 $\\tau_w$ 的表达式中：\n$$\\tau_w = \\frac{1}{8} f \\rho \\left(\\frac{G}{\\rho}\\right)^2 = \\frac{f G^2}{8\\rho}$$\n现在，我们可以根据给定参数推导摩擦速度 $u_{\\tau}$ 的表达式：\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}} = \\sqrt{\\frac{1}{\\rho} \\left(\\frac{f G^2}{8\\rho}\\right)} = \\sqrt{\\frac{f G^2}{8\\rho^2}} = \\frac{G}{\\rho} \\sqrt{\\frac{f}{8}}$$\n接下来，我们将 $u_{\\tau}$ 和 $\\nu$ 的表达式代回 $y^{+}$ 的定义中：\n$$y^{+} = \\frac{y_p u_{\\tau}}{\\nu} = \\frac{y_p \\left(\\frac{G}{\\rho} \\sqrt{\\frac{f}{8}}\\right)}{\\mu/\\rho}$$\n密度 $\\rho$ 被消去，得到：\n$$y^{+} = \\frac{y_p G}{\\mu} \\sqrt{\\frac{f}{8}}$$\n最后，我们重排此方程以求解第一层网格中心点距离 $y_p$。这就提供了所要求的普适关系：\n$$y_p = \\frac{y^{+} \\mu}{G} \\sqrt{\\frac{8}{f}}$$\n利用这个推导出的关系，我们进行数值计算。给定参数如下：\n- 密度: $\\rho = 700\\,\\mathrm{kg/m^3}$\n- 动力粘度: $\\mu = 1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$\n- 水力直径: $D_{h} = 9.0\\times 10^{-3}\\,\\mathrm{m}$\n- 质量通量: $G = 3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}$\n\n首先，我们计算雷诺数 $\\mathrm{Re}$ 以确定摩擦因子 $f$：\n$$\\mathrm{Re} = \\frac{G D_{h}}{\\mu} = \\frac{(3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}) \\times (9.0\\times 10^{-3}\\,\\mathrm{m})}{1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s}} = 270000$$\n由于 $\\mathrm{Re} \\gg 4000$，流动是高度湍流的。\n\n接下来，我们使用所提供的 Petukhov 关联式来计算摩擦因子 $f$：\n$$f = \\left(0.79\\,\\ln(\\mathrm{Re}) - 1.64\\right)^{-2}$$\n代入 $\\mathrm{Re}$ 的值：\n$$f = \\left(0.79\\,\\ln(270000) - 1.64\\right)^{-2}$$\n$$\\ln(270000) \\approx 12.506176$$\n$$f \\approx \\left(0.79 \\times 12.506176 - 1.64\\right)^{-2} = \\left(9.879879 - 1.64\\right)^{-2} = (8.239879)^{-2} \\approx 0.0147285$$\n现在我们可以计算两种指定情况下所需的第一层网格中心点距离 $y_p$。\n\n情况1：壁面函数法，目标 $y^{+} = 30$。\n$$y_{p, wf} = \\frac{30 \\times (1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s})}{3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}} \\sqrt{\\frac{8}{0.0147285}}$$\n$$y_{p, wf} = (1.0\\times 10^{-6}\\,\\mathrm{m}) \\times \\sqrt{543.160} \\approx (1.0\\times 10^{-6}\\,\\mathrm{m}) \\times 23.3058$$\n$$y_{p, wf} \\approx 2.33058\\times 10^{-5}\\,\\mathrm{m}$$\n转换为微米 ($1\\,\\mathrm{m} = 10^6\\,\\mu\\mathrm{m}$):\n$$y_{p, wf} \\approx 23.3058\\,\\mu\\mathrm{m}$$\n四舍五入到三位有效数字，壁面函数法所需的距离为 $23.3\\,\\mu\\mathrm{m}$。\n\n情况2：低雷诺数法，目标 $y^{+} = 1$。\n$$y_{p, \\text{low-Re}} = \\frac{1 \\times (1.0\\times 10^{-4}\\,\\mathrm{Pa\\cdot s})}{3.0\\times 10^{3}\\,\\mathrm{kg/(m^2\\cdot s)}} \\sqrt{\\frac{8}{0.0147285}}$$\n$$y_{p, \\text{low-Re}} = \\frac{1}{30} \\times y_{p, wf} \\approx \\frac{23.3058\\,\\mu\\mathrm{m}}{30} \\approx 0.77686\\,\\mu\\mathrm{m}$$\n四舍五入到三位有效数字，低雷诺数法所需的距离为 $0.777\\,\\mu\\mathrm{m}$。\n\n计算出的两个距离分别是：壁面函数法 ($y^+=30$) 为 $23.3\\,\\mu\\mathrm{m}$，低雷诺数法 ($y^+=1$) 为 $0.777\\,\\mu\\mathrm{m}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n23.3  0.777\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从单个流动现象的设置转向更广阔的堆芯热工水力分析，子通道分析是理解燃料组件内能量分布的核心工具。本练习的核心是求解一个耦合的常微分方程组，该方程组模拟了相邻冷却剂子通道之间通过湍流混合和横流进行的能量交换。通过为该系统编写求解器，您将深入理解能量分布不均是如何产生的，以及混合现象如何使冷却剂温度均匀化，这对于评估安全裕度至关重要。",
            "id": "4253228",
            "problem": "考虑一个简化的核反应堆堆芯子通道热工水力模型，其中多个冷却剂子通道通过湍流混合和横向交混流交换能量。假设每个子通道中为单相不可压缩流，质量流率恒定，轴向热传导可忽略不计，且单位轴向长度上的加热量恒定。对于子通道 $i$，其比焓 $h_i(z)$ 的轴向演化由以下耦合一阶常微分方程建模：\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)\\left(h_j - h_i\\right),\n$$\n其中，$z$ 是轴向坐标，$m_i$ 是子通道 $i$ 中的质量流率，$s_i = \\frac{q''_i P_i}{m_i}$ 是轴向焓源项，其中 $q''_i$ 是壁面热通量，$P_i$ 是湿周；$\\beta_{ij}$ 是子通道 $i$ 和 $j$ 之间的湍流混合系数，$f_{ij}$ 是从子通道 $i$ 到相邻子通道 $j$ 的单位轴向长度上的横向交混流质量交换率，$\\mathcal{N}(i)$ 是子通道 $i$ 的相邻子通道集合。所有量均视为不随 $z$ 变化的常数。堆芯入口处的初始条件在所有子通道中是均匀的，\n$$\nh_i(0) = h_{\\text{in}}, \\quad \\text{for all } i.\n$$\n将子通道 $i$ 中的焓升定义为 $\\Delta h_i = h_i(L) - h_{\\text{in}}$，其中 $L$ 是堆芯长度。出口处的焓不均匀分布由变异系数来量化：\n$$\n\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}},\n$$\n其中，$\\sigma_{\\Delta h}$ 是所有子通道的 $\\{\\Delta h_i\\}$ 集合的标准差，$\\mu_{\\Delta h}$ 是所有子通道的 $\\{\\Delta h_i\\}$ 集合的平均值。\n\n从能量守恒和上述定义出发，推导出向量形式的耦合系统，并使用数学上可靠的方法求解出口焓 $h_i(L)$。然后计算不均匀分布度量 $\\text{CV}$。\n\n单位和常数：\n- $h$ 的单位为 $\\text{J}/\\text{kg}$，$z$ 和 $L$ 的单位为 $\\text{m}$，$m$ 的单位为 $\\text{kg}/\\text{s}$，$q''$ 的单位为 $\\text{W}/\\text{m}^2$，$P$ 的单位为 $\\text{m}$，$\\beta$ 的单位为 $\\text{m}^{-1}$，$f$ 的单位为 $\\text{kg}/(\\text{s}\\cdot\\text{m})$。\n- 使用 $h_{\\text{in}} = 1.0\\times 10^{5}\\ \\text{J}/\\text{kg}$。\n\n要实现和评估的测试套件：\n- 案例1（理想路径，中等混合与交混流，非对称加热）：\n  - 子通道：$N = 4$，排列成一个 $2\\times 2$ 的网格，相邻对为 $(0,1)$, $(0,2)$, $(1,3)$, $(2,3)$。\n  - 长度：$L = 4.0\\ \\text{m}$。\n  - 质量流率：$(m_0,m_1,m_2,m_3) = (0.25, 0.25, 0.25, 0.25)\\ \\text{kg}/\\text{s}$。\n  - 湿周：$(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$。\n  - 热通量：$(q''_0,q''_1,q''_2,q''_3) = (100000,100000,120000,100000)\\ \\text{W}/\\text{m}^2$。\n  - 混合：对每个相邻对，$\\beta_{ij} = 0.8\\ \\text{m}^{-1}$。\n  - 单位长度上的交混流：对每个相邻对，$f_{ij} = 0.02\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$。\n- 案例2（边缘情况，无混合与无交混流）：\n  - $N$、相邻对、$L$、$m_i$、$P_i$、$q''_i$ 与案例1相同。\n  - 混合：对每个相邻对，$\\beta_{ij} = 0.0\\ \\text{m}^{-1}$。\n  - 单位长度上的交混流：对每个相邻对，$f_{ij} = 0.0\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$。\n- 案例3（强混合与强交混流，非均匀质量流率）：\n  - 子通道：$N = 4$，相邻对与之前相同。\n  - 长度：$L = 4.0\\ \\text{m}$。\n  - 质量流率：$(m_0,m_1,m_2,m_3) = (0.22, 0.30, 0.26, 0.27)\\ \\text{kg}/\\text{s}$。\n  - 湿周：$(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$。\n  - 热通量：$(q''_0,q''_1,q''_2,q''_3) = (100000,100000,120000,100000)\\ \\text{W}/\\text{m}^2$。\n  - 混合：对每个相邻对，$\\beta_{ij} = 5.0\\ \\text{m}^{-1}$。\n  - 单位长度上的交混流：对每个相邻对，$f_{ij} = 0.10\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$。\n- 案例4（边界情况，均匀加热）：\n  - 子通道：$N = 4$，相邻对与之前相同。\n  - 长度：$L = 4.0\\ \\text{m}$。\n  - 质量流率：$(m_0,m_1,m_2,m_3) = (0.25, 0.25, 0.25, 0.25)\\ \\text{kg}/\\text{s}$。\n  - 湿周：$(P_0,P_1,P_2,P_3) = (0.10,0.10,0.10,0.10)\\ \\text{m}$。\n  - 热通量：$(q''_0,q''_1,q''_2,q''_3) = (110000,110000,110000,110000)\\ \\text{W}/\\text{m}^2$。\n  - 混合：对每个相邻对，$\\beta_{ij} = 1.5\\ \\text{m}^{-1}$。\n  - 单位长度上的交混流：对每个相邻对，$f_{ij} = 0.05\\ \\text{kg}/(\\text{s}\\cdot\\text{m})$。\n\n你的程序应对每个案例，组合并求解耦合系统以获得 $h_i(L)$，计算 $\\Delta h_i$ 和变异系数 $\\text{CV}$，并返回四个 $\\text{CV}$ 值。将每个 $\\text{CV}$ 表示为小数，四舍五入到六位小数。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，`[0.123456,0.234567,0.345678,0.456789]`）。",
            "solution": "用户提供了一个问题陈述，描述了核反应堆堆芯内一组耦合冷却剂子通道中比焓的轴向演化。任务是求解常微分方程(ODE)的控制系统，计算每个子通道的焓升，然后计算出口焓不均匀分布的一个统计度量，即变异系数(CV)。\n\n### 步骤1：问题陈述的验证\n\n我将首先根据指定标准验证问题陈述。\n\n#### 提取已知条件：\n- **控制方程**：对于每个子通道 $i$，比焓 $h_i(z)$ 的轴向演化由以下公式给出：\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)\\left(h_j - h_i\\right)\n$$\n- **变量与定义**：\n  - $z$: 轴向坐标 (m)。\n  - $h_i(z)$: 子通道 $i$ 在位置 $z$ 处的比焓 (J/kg)。\n  - $m_i$: 子通道 $i$ 中的恒定质量流率 (kg/s)。\n  - $s_i = \\frac{q''_i P_i}{m_i}$: 轴向焓源项，假设为常数。\n  - $q''_i$: 壁面热通量 (W/m$^2$）。\n  - $P_i$: 湿周 (m)。\n  - $\\beta_{ij}$: 子通道 $i$ 和 $j$ 之间的湍流混合系数 (m$^{-1}$)。\n  - $f_{ij}$: 从子通道 $i$ 到 $j$ 的单位长度上的横向交混流质量交换率 (kg/(s·m))。假设 $f_{ij}=f_{ji}$。\n  - $\\mathcal{N}(i)$: 子通道 $i$ 的相邻子通道集合。\n- **初始条件**：堆芯入口处 ($z=0$) 的焓均匀一致：\n$$\nh_i(0) = h_{\\text{in}} = 1.0\\times 10^{5}\\ \\text{J}/\\text{kg} \\quad \\text{for all } i.\n$$\n- **待计算量**：\n  - 焓升：$\\Delta h_i = h_i(L) - h_{\\text{in}}$，其中 $L$ 是堆芯长度 (m)。\n  - 变异系数（不均匀分布度量）：$\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}}$，其中 $\\sigma_{\\Delta h}$ 和 $\\mu_{\\Delta h}$ 是集合 $\\{\\Delta h_i\\}$ 的标准差和平均值。\n- **测试套件**：提供了四个具体案例，包含一个4子通道系统（$N=4$）所需的所有数值参数。其拓扑结构为一个 $2\\times 2$ 网格，相邻对为 (0,1), (0,2), (1,3), (2,3)，这定义了一个对应于方形排列 (0-1-3-2-0) 的循环图 C4。\n\n#### 使用提取的已知条件进行验证：\n1.  **有科学依据**：该控制方程是在核反应堆热工水力学子通道分析（例如，在类COBRA程序中）中使用的标准（尽管是简化的）能量平衡方程。它代表了一个热量和质量交换的线性化模型。该模型基于能量守恒的基本原理。在工程近似的背景下，它是科学上可靠的。\n2.  **适定性**：该问题是一个具有常系数的线性一阶常微分方程组的初值问题 (IVP)。给定一个明确定义的初始条件，对于所有 $z \\geq 0$ 都存在唯一解。求解所需的所有参数均已提供。\n3.  **明确性**：问题以精确的数学和物理术语陈述。各量均被明确无误地定义。\n4.  **完整性与一致性**：为给定测试案例求解问题所需的所有数据均已提供。单位是一致的。问题陈述中没有矛盾之处。\n5.  **可行性/现实性**：测试案例中提供的参数对于简化的反应堆堆芯分析来说在合理范围内。相关运算在计算上是可行的。\n\n#### 结论与行动：\n该问题被认为是**有效的**。这是一个来自核工程领域的适定的、有科学依据的问题。我将继续进行求解。\n\n### 步骤2：求解推导与算法设计\n\n问题的核心是求解一个耦合线性一阶常微分方程组。\n\n#### 向量形式的数学公式\n子通道 $i$ 的控制方程可以通过展开求和项重写为：\n$$\n\\frac{d h_i}{dz} = s_i + \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right)h_j - \\left[ \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right) \\right] h_i\n$$\n这个包含 $N$ 个方程的系统可以表示为矩阵-向量形式。设 $\\mathbf{h}(z)$ 为比焓的列向量 $[h_0(z), h_1(z), \\dots, h_{N-1}(z)]^T$，$\\mathbf{s}$ 为源项的列向量 $[s_0, s_1, \\dots, s_{N-1}]^T$。该系统变为：\n$$\n\\frac{d\\mathbf{h}}{dz} = \\mathbf{A}\\mathbf{h} + \\mathbf{s}\n$$\n其中 $\\mathbf{A}$ 是一个 $N \\times N$ 矩阵，其元素定义如下：\n- 对于非对角线元素 ($i \\neq j$)：\n$$\nA_{ij} = \\begin{cases} \\beta_{ij} + \\frac{f_{ij}}{m_i}  \\text{if } j \\in \\mathcal{N}(i) \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n- 对于对角线元素 ($i = j$)：\n$$\nA_{ii} = - \\sum_{j \\in \\mathcal{N}(i)} \\left(\\beta_{ij} + \\frac{f_{ij}}{m_i}\\right) = - \\sum_{j \\neq i} A_{ij}\n$$\n问题陈述中指出，$\\beta_{ij}$ 和 $f_{ij}$ 是为每个“相邻对”给出的，这意味着对称性：$\\beta_{ij} = \\beta_{ji}$ 和 $f_{ij} = f_{ji}$。然而，如果质量流率 $m_i$ 不同，矩阵 $\\mathbf{A}$ 不一定是对称的。$\\mathbf{A}$ 的一个关键性质是其每行之和为零，即 $\\mathbf{A}\\mathbf{1} = \\mathbf{0}$，其中 $\\mathbf{1}$ 是一个全为1的列向量。这意味着 $\\mathbf{A}$ 是一个奇异矩阵。\n\n初始条件为 $\\mathbf{h}(0) = h_{\\text{in}}\\mathbf{1}$。\n\n#### 求解ODE系统\n为了简化初始条件，我们定义一个新向量来表示相对于入口的焓升，$\\mathbf{y}(z) = \\mathbf{h}(z) - h_{\\text{in}}\\mathbf{1}$。$\\mathbf{y}$ 的初始条件是 $\\mathbf{y}(0) = \\mathbf{0}$。$\\mathbf{y}$ 的微分方程是：\n$$\n\\frac{d\\mathbf{y}}{dz} = \\frac{d\\mathbf{h}}{dz} = \\mathbf{A}(\\mathbf{y} + h_{\\text{in}}\\mathbf{1}) + \\mathbf{s} = \\mathbf{A}\\mathbf{y} + h_{\\text{in}}(\\mathbf{A}\\mathbf{1}) + \\mathbf{s}\n$$\n因为 $\\mathbf{A}\\mathbf{1} = \\mathbf{0}$，方程简化为：\n$$\n\\frac{d\\mathbf{y}}{dz} = \\mathbf{A}\\mathbf{y} + \\mathbf{s}, \\quad \\text{with} \\quad \\mathbf{y}(0) = \\mathbf{0}\n$$\n这是一个具有齐次初始条件的标准非齐次线性ODE系统。其解由下式给出：\n$$\n\\mathbf{y}(z) = \\left( \\int_0^z e^{\\mathbf{A}\\tau} d\\tau \\right) \\mathbf{s}\n$$\n其中 $e^{\\mathbf{A}\\tau}$ 是矩阵指数。由于 $\\mathbf{A}$ 和 $\\mathbf{s}$ 是常数，我们需要在 $z=L$ 处计算此表达式的值，以找到出口焓升 $\\mathbf{\\Delta h} = \\mathbf{y}(L)$。\n\n一个用于寻找 $\\mathbf{y}(L)$ 的稳健数值方法是使用“增广矩阵的矩阵指数”技术。我们定义一个 $(N+1) \\times (N+1)$ 的分块矩阵 $\\mathbf{B}$ 如下：\n$$\n\\mathbf{B} = \\begin{pmatrix} \\mathbf{A}  \\mathbf{s} \\\\ \\mathbf{0}^T  0 \\end{pmatrix}\n$$\n$\\mathbf{B}L$ 的指数可以表示为：\n$$\ne^{\\mathbf{B}L} = \\begin{pmatrix} e^{\\mathbf{A}L}  \\mathbf{y}(L) \\\\ \\mathbf{0}^T  1 \\end{pmatrix}\n$$\n因此，向量 $\\mathbf{y}(L)$，也就是焓升向量 $\\mathbf{\\Delta h}$，可以从计算出的矩阵 $e^{\\mathbf{B}L}$ 的右上角 $N \\times 1$ 分块中提取。该方法避免了 $\\mathbf{A}$ 的奇异性问题，并且在数值上是稳定的。\n\n#### 计算变异系数 (CV) 的算法\n对每个测试案例，应用以下算法：\n1.  **初始化**：提取参数：堆芯长度 $L$、质量流率 $\\mathbf{m}$、湿周 $\\mathbf{P}$、热通量 $\\mathbf{q''}$、混合系数 $\\beta$ 和交混流系数 $f$。定义子通道的相邻对。\n2.  **构造源向量**：对每个子通道 $i=0, \\dots, N-1$，计算源项 $s_i = \\frac{q''_i P_i}{m_i}$，以构成向量 $\\mathbf{s}$。\n3.  **构造A矩阵**：根据相邻拓扑结构以及给定的 $\\beta$、$f$ 和 $\\mathbf{m}$ 值，按照上面推导的 $A_{ij}$ 和 $A_{ii}$ 公式，创建 $N \\times N$ 矩阵 $\\mathbf{A}$。\n4.  **构造增广矩阵**：通过用 $\\mathbf{s}$ 增广 $\\mathbf{A}$ 并用零填充，构成 $(N+1) \\times (N+1)$ 矩阵 $\\mathbf{B}$。\n5.  **求解焓升**：使用可靠的数值库函数（例如，`scipy.linalg.expm`）计算矩阵指数 $e^{\\mathbf{B}L}$。从结果矩阵的最后一列（前 $N$ 行）中提取出口焓升向量 $\\mathbf{\\Delta h}$。\n6.  **计算CV**：\n    a. 计算焓升的平均值：$\\mu_{\\Delta h} = \\frac{1}{N} \\sum_{i=0}^{N-1} \\Delta h_i$。\n    b. 计算总体标准差：$\\sigma_{\\Delta h} = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} (\\Delta h_i - \\mu_{\\Delta h})^2}$。\n    c. 计算变异系数：$\\text{CV} = \\frac{\\sigma_{\\Delta h}}{\\mu_{\\Delta h}}$。处理 $\\mu_{\\Delta h}=0$ 的情况以避免除以零，尽管根据给定的物理问题，这种情况预计不会发生。\n7.  **返回结果**：计算出的 $\\text{CV}$ 值即为该案例的结果。\n\n该程序将被实现并应用于所提供的四个测试案例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to solve the subchannel thermal-hydraulics problem for all test cases.\n    \"\"\"\n\n    # Inlet enthalpy, not required for CV calculation but given in the problem.\n    # h_in = 1.0e5\n\n    # Define the neighbor pairs for the 4-subchannel 2x2 grid.\n    # This corresponds to a C4 graph: 0-1-3-2-0.\n    neighbor_pairs = [(0, 1), (0, 2), (1, 3), (2, 3)]\n\n    # Test cases as defined in the problem description.\n    test_cases = [\n        # Case 1: happy path, moderate mixing and crossflow, asymmetric heating\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([100000, 100000, 120000, 100000]),\n            \"beta_val\": 0.8,\n            \"f_val\": 0.02,\n        },\n        # Case 2: edge case, no mixing and no crossflow\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([100000, 100000, 120000, 100000]),\n            \"beta_val\": 0.0,\n            \"f_val\": 0.0,\n        },\n        # Case 3: strong mixing and crossflow, heterogeneous mass flows\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.22, 0.30, 0.26, 0.27]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([100000, 100000, 120000, 100000]),\n            \"beta_val\": 5.0,\n            \"f_val\": 0.10,\n        },\n        # Case 4: boundary case, equal heating\n        {\n            \"L\": 4.0,\n            \"m\": np.array([0.25, 0.25, 0.25, 0.25]),\n            \"P\": np.array([0.10, 0.10, 0.10, 0.10]),\n            \"q_double_prime\": np.array([110000, 110000, 110000, 110000]),\n            \"beta_val\": 1.5,\n            \"f_val\": 0.05,\n        },\n    ]\n\n    def solve_case(params, neighbors):\n        \"\"\"\n        Solves a single case for the coefficient of variation (CV).\n        \"\"\"\n        N = 4  # Number of subchannels\n        L = params[\"L\"]\n        m = params[\"m\"]\n        P = params[\"P\"]\n        q_pp = params[\"q_double_prime\"]\n        beta_val = params[\"beta_val\"]\n        f_val = params[\"f_val\"]\n\n        # 1. Calculate the source vector s\n        s = (q_pp * P) / m\n\n        # 2. Construct the A matrix\n        A = np.zeros((N, N))\n        \n        # Build adjacency list from pairs\n        adj = [[] for _ in range(N)]\n        for i, j in neighbors:\n            adj[i].append(j)\n            adj[j].append(i)\n\n        for i in range(N):\n            row_sum = 0\n            for j in adj[i]:\n                # Off-diagonal elements\n                val = beta_val + f_val / m[i]\n                A[i, j] = val\n                row_sum += val\n            # Diagonal elements\n            A[i, i] = -row_sum\n\n        # 3. Construct the augmented B matrix\n        B = np.zeros((N + 1, N + 1))\n        B[:N, :N] = A\n        B[:N, N] = s\n        \n        # 4. Compute the matrix exponential\n        exp_BL = expm(B * L)\n\n        # 5. Extract the enthalpy rise vector delta_h\n        delta_h = exp_BL[:N, N]\n\n        # 6. Calculate the coefficient of variation (CV)\n        mu_delta_h = np.mean(delta_h)\n        if mu_delta_h == 0:\n            return 0.0 # Avoid division by zero if all rises are zero\n            \n        sigma_delta_h = np.std(delta_h) # Population std dev (ddof=0)\n        \n        cv = sigma_delta_h / mu_delta_h\n        return cv\n\n    results = []\n    for case in test_cases:\n        cv_result = solve_case(case, neighbor_pairs)\n        results.append(cv_result)\n\n    # Format the final output as specified.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在开发和运行了预测模型之后，最后也是最关键的一步是将其与实验结果进行比较，这一过程称为验证。然而，当实验数据本身存在不确定性时，简单的逐点比较是不够的。本练习介绍了一种严谨的统计方法，即卡方($\\chi^2$)检验，用于量化模拟预测与包含随机和系统误差的测量数据之间的拟合优度。掌握这种方法将使您能够客观地评估模型的预测能力，这是在工程和科学研究中建立模型可信度的基石。",
            "id": "4253163",
            "problem": "在压水反应堆堆芯内，一个棒束组件被安装了仪器，用于测量冷却剂子通道的出口温度。计算流体动力学（Computational Fluid Dynamics, CFD）为 $N$ 个子通道的一个子集提供了预测温度。实验提供了相应的测量温度和量化的不确定度。假设测量误差是联合高斯的，每个子通道具有独立的随机分量，并且有一个共同的校准系统误差同等地影响所有子通道。设 CFD 预测值为 $\\mathbf{T}^{\\mathrm{CFD}} \\in \\mathbb{R}^{N}$，实验测量值为 $\\mathbf{T}^{\\mathrm{exp}} \\in \\mathbb{R}^{N}$，子通道 $i$ 的独立标准不确定度为 $\\sigma_{i}$，共同的系统标准不确定度为 $s_{\\mathrm{sys}}$。测量误差的协方差矩阵为 $\\boldsymbol{\\Sigma} = \\mathbf{D} + s_{\\mathrm{sys}}^{2} \\mathbf{1}\\mathbf{1}^{\\top}$，其中 $\\mathbf{D} = \\mathrm{diag}(\\sigma_{1}^{2}, \\dots, \\sigma_{N}^{2})$，$\\mathbf{1}$ 是全为1的列向量。\n\n从测量误差的多元高斯似然出发，推导一个基于卡方统计量的无量纲拟合优度验证度量，该度量要考虑到由共同系统误差引起的相关不确定度。然后，对以下四个子通道（$N = 4$）评估该度量，其中温度单位为开尔文：\n- $\\mathbf{T}^{\\mathrm{CFD}} = \\left[591.0,\\, 592.6,\\, 599.0,\\, 600.7\\right]$,\n- $\\mathbf{T}^{\\mathrm{exp}} = \\left[590.2,\\, 593.5,\\, 598.1,\\, 601.3\\right]$,\n- $\\boldsymbol{\\sigma} = \\left[0.5,\\, 0.7,\\, 0.6,\\, 0.5\\right]$,\n- $s_{\\mathrm{sys}} = 0.4$.\n\n使用约化卡方，其定义为卡方值除以自由度数。由于在此比较中没有拟合模型参数，因此自由度取为 $N$。报告约化卡方值，并将答案四舍五入到四位有效数字。以无量纲数的形式表达您的最终答案。",
            "solution": "问题陈述被认为是有效的。它在科学上基于模型验证的标准统计方法，问题提法良好，提供了所有必要信息，并且语言客观。任务是为具有相关不确定性的数据推导一个拟合优度统计量，然后将其应用于特定数据集。\n\n首先，我们推导卡方（$\\chi^2$）统计量。问题陈述指出测量误差是联合高斯的。设实验测量值与 CFD 预测值之间的差值向量为 $\\mathbf{d} = \\mathbf{T}^{\\mathrm{exp}} - \\mathbf{T}^{\\mathrm{CFD}}$。在零假设（即 CFD 模型完美代表真实温度）下，向量 $\\mathbf{d}$ 代表测量误差。$\\mathbf{d}$ 的概率密度函数由多元高斯分布给出：\n$$\nP(\\mathbf{d} | \\boldsymbol{\\Sigma}) = \\frac{1}{\\sqrt{(2\\pi)^{N} \\det(\\boldsymbol{\\Sigma})}} \\exp\\left(-\\frac{1}{2} \\mathbf{d}^{\\top} \\boldsymbol{\\Sigma}^{-1} \\mathbf{d}\\right)\n$$\n$\\chi^2$ 统计量定义为指数中的项：\n$$\n\\chi^2 = \\mathbf{d}^{\\top} \\boldsymbol{\\Sigma}^{-1} \\mathbf{d}\n$$\n推导的核心是求协方差矩阵 $\\boldsymbol{\\Sigma}$ 的逆。给定的协方差矩阵为 $\\boldsymbol{\\Sigma} = \\mathbf{D} + s_{\\mathrm{sys}}^{2} \\mathbf{1}\\mathbf{1}^{\\top}$，其中 $\\mathbf{D} = \\mathrm{diag}(\\sigma_{1}^{2}, \\dots, \\sigma_{N}^{2})$，$\\mathbf{1}$ 是全为1的列向量。这种形式，一个对角矩阵加上一个秩一更新，允许应用 Sherman-Morrison 公式：\n$$\n(\\mathbf{A} + \\mathbf{u}\\mathbf{v}^{\\top})^{-1} = \\mathbf{A}^{-1} - \\frac{\\mathbf{A}^{-1}\\mathbf{u}\\mathbf{v}^{\\top}\\mathbf{A}^{-1}}{1 + \\mathbf{v}^{\\top}\\mathbf{A}^{-1}\\mathbf{u}}\n$$\n在我们的例子中，我们识别出 $\\mathbf{A} = \\mathbf{D}$，$\\mathbf{u} = s_{\\mathrm{sys}} \\mathbf{1}$ 和 $\\mathbf{v} = s_{\\mathrm{sys}} \\mathbf{1}$。$\\mathbf{D}$ 的逆矩阵就是 $\\mathbf{D}^{-1} = \\mathrm{diag}(1/\\sigma_{1}^{2}, \\dots, 1/\\sigma_{N}^{2})$。我们将这些代入公式：\n$$\n\\boldsymbol{\\Sigma}^{-1} = \\mathbf{D}^{-1} - \\frac{\\mathbf{D}^{-1}(s_{\\mathrm{sys}}\\mathbf{1})(s_{\\mathrm{sys}}\\mathbf{1}^{\\top})\\mathbf{D}^{-1}}{1 + (s_{\\mathrm{sys}}\\mathbf{1}^{\\top})\\mathbf{D}^{-1}(s_{\\mathrm{sys}}\\mathbf{1})} = \\mathbf{D}^{-1} - \\frac{s_{\\mathrm{sys}}^{2} (\\mathbf{D}^{-1}\\mathbf{1})(\\mathbf{1}^{\\top}\\mathbf{D}^{-1})}{1 + s_{\\mathrm{sys}}^{2} (\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})}\n$$\n现在我们将 $\\boldsymbol{\\Sigma}^{-1}$ 的这个表达式代入 $\\chi^2$ 的公式中：\n$$\n\\chi^2 = \\mathbf{d}^{\\top} \\left( \\mathbf{D}^{-1} - \\frac{s_{\\mathrm{sys}}^{2} (\\mathbf{D}^{-1}\\mathbf{1})(\\mathbf{1}^{\\top}\\mathbf{D}^{-1})}{1 + s_{\\mathrm{sys}}^{2} (\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})} \\right) \\mathbf{d}\n$$\n$$\n\\chi^2 = \\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{d} - \\frac{s_{\\mathrm{sys}}^{2} (\\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})(\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{d})}{1 + s_{\\mathrm{sys}}^{2} (\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1})}\n$$\n让我们用求和的形式表示矩阵乘积。设 $d_i$ 是 $\\mathbf{d}$ 的第 $i$ 个分量。\n- $\\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{d} = \\sum_{i=1}^{N} \\frac{d_i^2}{\\sigma_i^2}$\n- $\\mathbf{d}^{\\top}\\mathbf{D}^{-1}\\mathbf{1} = \\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}$\n- $\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{d} = \\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}$\n- $\\mathbf{1}^{\\top}\\mathbf{D}^{-1}\\mathbf{1} = \\sum_{j=1}^{N} \\frac{1}{\\sigma_j^2}$\n因此，推导出的 $\\chi^2$ 统计量的表达式为：\n$$\n\\chi^2 = \\sum_{i=1}^{N} \\frac{d_i^2}{\\sigma_i^2} - \\frac{s_{\\mathrm{sys}}^2 \\left(\\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}\\right)^2}{1 + s_{\\mathrm{sys}}^2 \\sum_{j=1}^{N} \\frac{1}{\\sigma_j^2}}\n$$\n这就是所要求的无量纲拟合优度验证度量。\n\n接下来，我们对给定数据评估此度量。\n子通道的数量为 $N=4$。数据向量为：\n- $\\mathbf{T}^{\\mathrm{CFD}} = \\left[591.0,\\, 592.6,\\, 599.0,\\, 600.7\\right]$\n- $\\mathbf{T}^{\\mathrm{exp}} = \\left[590.2,\\, 593.5,\\, 598.1,\\, 601.3\\right]$\n- $\\boldsymbol{\\sigma} = \\left[0.5,\\, 0.7,\\, 0.6,\\, 0.5\\right]$\n- $s_{\\mathrm{sys}} = 0.4$\n\n首先，计算差值向量 $\\mathbf{d} = \\mathbf{T}^{\\mathrm{exp}} - \\mathbf{T}^{\\mathrm{CFD}}$：\n- $d_1 = 590.2 - 591.0 = -0.8$\n- $d_2 = 593.5 - 592.6 = 0.9$\n- $d_3 = 598.1 - 599.0 = -0.9$\n- $d_4 = 601.3 - 600.7 = 0.6$\n\n接下来，我们计算所需的总和。方差为 $\\sigma_1^2=0.25$, $\\sigma_2^2=0.49$, $\\sigma_3^2=0.36$, $\\sigma_4^2=0.25$ 和 $s_{\\mathrm{sys}}^2=0.16$。\n\n1.  计算 $\\sum_{i=1}^{N} \\frac{d_i^2}{\\sigma_i^2}$：\n    $$\n    \\sum_{i=1}^{4} \\frac{d_i^2}{\\sigma_i^2} = \\frac{(-0.8)^2}{0.5^2} + \\frac{0.9^2}{0.7^2} + \\frac{(-0.9)^2}{0.6^2} + \\frac{0.6^2}{0.5^2} = \\frac{0.64}{0.25} + \\frac{0.81}{0.49} + \\frac{0.81}{0.36} + \\frac{0.36}{0.25}\n    $$\n    $$\n    = 2.56 + 1.653061... + 2.25 + 1.44 = 7.903061...\n    $$\n\n2.  计算 $\\sum_{i=1}^{N} \\frac{d_i}{\\sigma_i^2}$：\n    $$\n    \\sum_{i=1}^{4} \\frac{d_i}{\\sigma_i^2} = \\frac{-0.8}{0.25} + \\frac{0.9}{0.49} + \\frac{-0.9}{0.36} + \\frac{0.6}{0.25} = -3.2 + 1.836734... - 2.5 + 2.4 = -1.463265...\n    $$\n\n3.  计算 $\\sum_{j=1}^{N} \\frac{1}{\\sigma_j^2}$：\n    $$\n    \\sum_{j=1}^{4} \\frac{1}{\\sigma_j^2} = \\frac{1}{0.25} + \\frac{1}{0.49} + \\frac{1}{0.36} + \\frac{1}{0.25} = 4.0 + 2.040816... + 2.777777... + 4.0 = 12.818594...\n    $$\n\n现在，将这些总和代入 $\\chi^2$ 公式：\n$$\n\\chi^2 = 7.903061... - \\frac{(0.4)^2 \\times (-1.463265...)^2}{1 + (0.4)^2 \\times 12.818594...}\n$$\n$$\n\\chi^2 = 7.903061... - \\frac{0.16 \\times 2.141157...}{1 + 0.16 \\times 12.818594...}\n$$\n$$\n\\chi^2 = 7.903061... - \\frac{0.342585...}{1 + 2.050975...} = 7.903061... - \\frac{0.342585...}{3.050975...}\n$$\n$$\n\\chi^2 = 7.903061... - 0.112287... = 7.790774...\n$$\n问题要求的是约化卡方 $\\chi^2_{\\mathrm{red}}$，自由度数 $\\nu = N = 4$。\n$$\n\\chi^2_{\\mathrm{red}} = \\frac{\\chi^2}{\\nu} = \\frac{7.790774...}{4} = 1.947693...\n$$\n将结果四舍五入到四位有效数字，得到 $1.948$。",
            "answer": "$$\\boxed{1.948}$$"
        }
    ]
}