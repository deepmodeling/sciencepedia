{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握伴随理论，我们必须从其根本的数学推导开始。本练习将引导你推导连续形式下的多群伴随输运方程，这是理解伴随算符结构的基础。通过这个实践，你将亲自探索流项的符号反转以及散射和裂变算符的转置是如何通过内积的定义自然产生的，并最终学会如何为一个具体物理量（点探测器响应）构建其对应的伴随源 。",
            "id": "4213108",
            "problem": "考虑一维平板几何，其空间坐标为 $x \\in [0,L]$，$G$ 个能量群由 $g \\in \\{1,\\dots,G\\}$ 索引，以及一个具有 $M$ 个方向的离散纵标求积组，其方向由 $m \\in \\{1,\\dots,M\\}$ 索引，方向余弦为 $\\mu_{m} \\in (-1,1)$，正权重为 $w_{m}$，满足 $\\sum_{m=1}^{M} w_{m} = 2$。设未知正向角通量为 $\\psi_{g,m}(x)$，并定义各群标量通量为 $\\phi_{g}(x) = \\frac{1}{2} \\sum_{m=1}^{M} w_{m} \\psi_{g,m}(x)$。总截面为 $\\Sigma_{t,g}(x)$，从 $g'$ 群到 $g$ 群的各向同性散射截面为 $\\Sigma_{s,g' \\to g}(x)$，裂变截面为 $\\Sigma_{f,g}(x)$，平均中子产额为 $\\nu$，裂变谱为 $\\chi_{g}(x)$。外固定源为 $q_{g,m}(x)$。\n\n对于各向同性散射和裂变，每个 $g$ 和 $m$ 的正向离散纵标方程为：\n$$\n\\mu_{m} \\frac{d}{dx} \\psi_{g,m}(x) + \\Sigma_{t,g}(x) \\psi_{g,m}(x)\n= q_{g,m}(x)\n+ \\frac{1}{2} \\sum_{g'=1}^{G} \\Sigma_{s,g' \\to g}(x) \\sum_{m'=1}^{M} w_{m'} \\psi_{g',m'}(x)\n+ \\frac{1}{2} \\chi_{g}(x) \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g'}(x) \\sum_{m'=1}^{M} w_{m'} \\psi_{g',m'}(x).\n$$\n假设正向问题为真空边界条件：对于 $\\mu_{m} > 0$，$\\psi_{g,m}(0) = 0$；对于 $\\mu_{m}  0$，$\\psi_{g,m}(L) = 0$。\n\n定义加权内积\n$$\n\\langle u, v \\rangle \\equiv \\sum_{g=1}^{G} \\sum_{m=1}^{M} \\int_{0}^{L} w_{m} \\, u_{g,m}(x) \\, v_{g,m}(x) \\, dx,\n$$\n以及与位置 $x_{d} \\in (0,L)$ 处的点探测器相关的响应泛函，该探测器测量一个由群决定的标量通量加权和，\n$$\nR[\\psi] \\equiv \\sum_{g=1}^{G} \\eta_{g} \\, \\phi_{g}(x_{d}),\n$$\n其中 $\\eta_{g} \\ge 0$ 是 $g$ 群的探测器灵敏度。\n\n使用伴随输运理论和在内积 $\\langle \\cdot, \\cdot \\rangle$ 下的双线性伴随式，推导伴随角通量 $\\psi^{\\dagger}_{g,m}(x)$ 的伴随离散纵标方程，该方程需与给定的正向方程和边界条件一致，并能导出连接 $R[\\psi]$ 与伴随解的标准互易关系。在推导过程中，请指明决定流项符号以及散射和裂变群耦合的算子特征。最后，针对指定的响应泛函 $R[\\psi]$，写出伴随方程右侧出现的伴随源 $r_{g,m}(x)$ 的显式解析表达式。\n\n你的最终答案必须是 $r_{g,m}(x)$ 的单一闭式表达式，其中所有符号均已在上文定义。无需进行数值计算。",
            "solution": "此问题是适定的，且在中子输运理论领域有坚实的科学基础。所有必要信息均已提供且内部一致。我们开始推导。\n\n正向离散纵标输运方程可以写成算子形式 $L\\psi = q$。算子 $L$ 和源 $q$ 定义在一个函数空间上，该空间的元素 $\\psi$ 是角通量 $\\psi_{g,m}(x)$ 的向量。其分量由能量群 $g \\in \\{1, \\dots, G\\}$ 和离散方向 $m \\in \\{1, \\dots, M\\}$ 索引。\n算子 $L$ 可以分解为 $L = S - M_{S} - M_{F}$，其中 $S$ 是流-碰撞算子，$M_{S}$ 是散射算子，$M_{F}$ 是裂变算子。它们对任意角通量函数 $\\psi_{g,m}(x)$ 的作用如下：\n流-碰撞：$(S\\psi)_{g,m}(x) = \\mu_{m} \\frac{d}{dx} \\psi_{g,m}(x) + \\Sigma_{t,g}(x) \\psi_{g,m}(x)$。\n散射：$(M_{S}\\psi)_{g,m}(x) = \\frac{1}{2} \\sum_{g'=1}^{G} \\Sigma_{s,g' \\to g}(x) \\phi_{g'}(x)$。\n裂变：$(M_{F}\\psi)_{g,m}(x) = \\frac{1}{2} \\chi_{g}(x) \\sum_{g'=1}^{G} \\nu \\Sigma_{f,g'}(x) \\phi_{g'}(x)$。\n上式中，标量通量 $\\phi_{g'}(x)$ 定义为 $\\phi_{g'}(x) = \\frac{1}{2} \\sum_{m'=1}^{M} w_{m'} \\psi_{g',m'}(x)$。源项为 $q_{g,m}(x)$。\n\n伴随算子 $L^{\\dagger}$ 是相对于给定的内积 $\\langle u, v \\rangle = \\sum_{g=1}^{G} \\sum_{m=1}^{M} \\int_{0}^{L} w_{m} u_{g,m}(x) v_{g,m}(x) dx$ 定义的。其定义关系为 $\\langle L\\psi, \\psi^{\\dagger} \\rangle = \\langle \\psi, L^{\\dagger}\\psi^{\\dagger} \\rangle$，此关系对所有满足适当齐次边界条件的函数 $\\psi$ 和 $\\psi^{\\dagger}$ 成立。伴随方程为 $L^{\\dagger}\\psi^{\\dagger} = r$，其中 $\\psi^{\\dagger}$ 是伴随角通量，$r$ 是伴随源。我们有 $L^{\\dagger} = S^{\\dagger} - M_{S}^{\\dagger} - M_{F}^{\\dagger}$，其中每个伴随算子都是通过将相应的正向算子移动到内积的第二个位置得到的。\n\n1.  流-碰撞算子 $S$ 的伴随算子 $S^{\\dagger}$：\n    我们考察 $\\langle S\\psi, \\psi^{\\dagger} \\rangle$：\n    $$\n    \\langle S\\psi, \\psi^{\\dagger} \\rangle = \\sum_{g,m} \\int_{0}^{L} w_{m} \\left( \\mu_{m} \\frac{d\\psi_{g,m}}{dx} + \\Sigma_{t,g} \\psi_{g,m} \\right) \\psi^{\\dagger}_{g,m} dx.\n    $$\n    碰撞项是对称的：$\\sum_{g,m} \\int_{0}^{L} w_{m} \\Sigma_{t,g} \\psi_{g,m} \\psi^{\\dagger}_{g,m} dx = \\langle \\Sigma_{t} \\psi, \\psi^{\\dagger} \\rangle = \\langle \\psi, \\Sigma_{t} \\psi^{\\dagger} \\rangle$。\n    流项需要对 $x$ 进行分部积分：\n    $$\n    \\sum_{g,m} \\int_{0}^{L} w_{m} \\mu_{m} \\frac{d\\psi_{g,m}}{dx} \\psi^{\\dagger}_{g,m} dx = \\sum_{g,m} w_{m} \\mu_{m} \\left[ \\psi_{g,m}(x) \\psi^{\\dagger}_{g,m}(x) \\right]_{0}^{L} - \\sum_{g,m} \\int_{0}^{L} w_{m} \\mu_{m} \\psi_{g,m} \\frac{d\\psi^{\\dagger}_{g,m}}{dx} dx.\n    $$\n    合并各项，我们得到：\n    $$\n    \\langle S\\psi, \\psi^{\\dagger} \\rangle = \\sum_{g,m} \\int_{0}^{L} w_{m} \\psi_{g,m} \\left( -\\mu_{m} \\frac{d\\psi^{\\dagger}_{g,m}}{dx} + \\Sigma_{t,g} \\psi^{\\dagger}_{g,m} \\right) dx + J(\\psi, \\psi^{\\dagger}),\n    $$\n    其中 $J(\\psi, \\psi^{\\dagger})$ 是双线性伴随边界面项：\n    $$\n    J(\\psi, \\psi^{\\dagger}) = \\sum_{g,m} w_{m} \\mu_{m} \\left( \\psi_{g,m}(L)\\psi^{\\dagger}_{g,m}(L) - \\psi_{g,m}(0)\\psi^{\\dagger}_{g,m}(0) \\right).\n    $$\n    该积分定义了 $\\langle \\psi, S^{\\dagger}\\psi^{\\dagger} \\rangle$，因此 $(S^{\\dagger}\\psi^{\\dagger})_{g,m} = -\\mu_{m} \\frac{d}{dx} \\psi^{\\dagger}_{g,m} + \\Sigma_{t,g} \\psi^{\\dagger}_{g,m}$。导数项的符号变化，即 $+\\mu_{m} \\frac{d}{dx} \\to -\\mu_{m} \\frac{d}{dx}$，是分部积分的直接结果。\n    为使 $\\langle S\\psi, \\psi^{\\dagger} \\rangle = \\langle \\psi, S^{\\dagger}\\psi^{\\dagger} \\rangle$ 成立，双线性伴随式 $J(\\psi, \\psi^{\\dagger})$ 必须为零。使用正向真空边界条件，即对于 $\\mu_{m}>0$，$\\psi_{g,m}(0)=0$；对于 $\\mu_{m}0$，$\\psi_{g,m}(L)=0$，边界面项变为：\n    $$\n    J(\\psi, \\psi^{\\dagger}) = \\sum_{g} \\sum_{m:\\mu_{m}>0} w_{m} \\mu_{m} \\psi_{g,m}(L)\\psi^{\\dagger}_{g,m}(L) - \\sum_{g} \\sum_{m:\\mu_{m}0} w_{m} \\mu_{m} \\psi_{g,m}(0)\\psi^{\\dagger}_{g,m}(0).\n    $$\n    为使该项对任意出射通量 $\\psi_{g,m}(L)$（对于 $\\mu_m>0$）和 $\\psi_{g,m}(0)$（对于 $\\mu_m0$）为零，我们必须将其系数设为零。这就定义了伴随边界条件：对于 $\\mu_{m}>0$，$\\psi^{\\dagger}_{g,m}(L)=0$；对于 $\\mu_{m}0$，$\\psi^{\\dagger}_{g,m}(0)=0$。这些是伴随粒子进入区域的真空边界条件。\n\n2.  散射算子 $M_{S}$ 的伴随算子 $M_{S}^{\\dagger}$：\n    我们考察 $\\langle M_{S}\\psi, \\psi^{\\dagger} \\rangle$，代入 $\\phi_{g'}$ 的定义，并重排求和顺序：\n    $$\n    \\langle M_{S}\\psi, \\psi^{\\dagger} \\rangle = \\sum_{g,m} \\int_{0}^{L} w_{m} \\left( \\frac{1}{2} \\sum_{g'} \\Sigma_{s,g' \\to g} \\phi_{g'} \\right) \\psi^{\\dagger}_{g,m} dx \\\\\n    = \\int_{0}^{L} \\sum_{g,m} w_{m} \\left( \\frac{1}{2} \\sum_{g'} \\Sigma_{s,g' \\to g} \\frac{1}{2}\\sum_{m'} w_{m'}\\psi_{g',m'} \\right) \\psi^{\\dagger}_{g,m} dx \\\\\n    = \\sum_{g',m'} \\int_{0}^{L} w_{m'} \\psi_{g',m'}(x) \\left( \\frac{1}{2} \\sum_{g} \\Sigma_{s,g' \\to g}(x) \\left( \\frac{1}{2} \\sum_{m} w_{m} \\psi^{\\dagger}_{g,m}(x) \\right) \\right) dx.\n    $$\n    定义伴随标量通量 $\\phi^{\\dagger}_{g}(x) = \\frac{1}{2} \\sum_{m} w_{m} \\psi^{\\dagger}_{g,m}(x)$，我们有：\n    $$\n    \\langle M_{S}\\psi, \\psi^{\\dagger} \\rangle = \\sum_{g',m'} \\int_{0}^{L} w_{m'} \\psi_{g',m'}(x) \\left( \\frac{1}{2} \\sum_{g} \\Sigma_{s,g' \\to g}(x) \\phi^{\\dagger}_{g}(x) \\right) dx.\n    $$\n    通过将其与 $\\langle \\psi, M_{S}^{\\dagger}\\psi^{\\dagger} \\rangle$ 比较，我们确定 $M_{S}^{\\dagger}$ 的作用。将哑指标 $g', m'$ 替换为 $g, m$，我们得到：\n    $$\n    (M_{S}^{\\dagger}\\psi^{\\dagger})_{g,m}(x) = \\frac{1}{2} \\sum_{g'=1}^{G} \\Sigma_{s,g \\to g'}(x) \\phi^{\\dagger}_{g'}(x).\n    $$\n    散射的群耦合由转置的散射矩阵决定：正向算子中的 $\\Sigma_{s,g' \\to g}$ 在伴随算子中变为 $\\Sigma_{s,g \\to g'}$。\n\n3.  裂变算子 $M_{F}$ 的伴随算子 $M_{F}^{\\dagger}$：\n    推导过程与散射算子类似。\n    $$\n    \\langle M_{F}\\psi, \\psi^{\\dagger} \\rangle = \\sum_{g,m} \\int_{0}^{L} w_{m} \\left( \\frac{1}{2} \\chi_{g} \\sum_{g'} \\nu \\Sigma_{f,g'} \\phi_{g'} \\right) \\psi^{\\dagger}_{g,m} dx \\\\\n    = \\sum_{g',m'} \\int_{0}^{L} w_{m'} \\psi_{g',m'}(x) \\left( \\frac{1}{2} \\nu \\Sigma_{f,g'}(x) \\sum_{g} \\chi_{g}(x) \\left( \\frac{1}{2} \\sum_{m} w_{m} \\psi^{\\dagger}_{g,m}(x) \\right) \\right) dx.\n    $$\n    这得到：\n    $$\n    (M_{F}^{\\dagger}\\psi^{\\dagger})_{g,m}(x) = \\frac{1}{2} \\nu \\Sigma_{f,g}(x) \\sum_{g'=1}^{G} \\chi_{g'}(x) \\phi^{\\dagger}_{g'}(x).\n    $$\n    裂变的群耦合涉及裂变谱 $\\chi$ 和裂变截面 $\\Sigma_f$ 之间角色的转置。\n\n组合得到完整的伴随方程 $L^{\\dagger}\\psi^{\\dagger} = (S^{\\dagger} - M_{S}^{\\dagger} - M_{F}^{\\dagger})\\psi^{\\dagger} = r$：\n$$\n-\\mu_{m} \\frac{d}{dx} \\psi^{\\dagger}_{g,m}(x) + \\Sigma_{t,g}(x) \\psi^{\\dagger}_{g,m}(x) - \\frac{1}{2} \\sum_{g'=1}^{G} \\Sigma_{s,g \\to g'}(x) \\phi^{\\dagger}_{g'}(x) - \\frac{1}{2} \\nu \\Sigma_{f,g}(x) \\sum_{g'=1}^{G} \\chi_{g'}(x) \\phi^{\\dagger}_{g'}(x) = r_{g,m}(x).\n$$\n通常会对此进行重排，将伴随源和散射/裂变项置于右侧，以与正向方程类似。\n\n最后，我们推导伴随源 $r_{g,m}(x)$。响应泛函 $R[\\psi]$ 必须能表示为某个函数 $r$ 的内积形式 $\\langle r, \\psi \\rangle$。\n给定的响应为：\n$$\nR[\\psi] = \\sum_{g=1}^{G} \\eta_{g} \\phi_{g}(x_{d}) = \\sum_{g=1}^{G} \\eta_{g} \\left( \\frac{1}{2} \\sum_{m=1}^{M} w_{m} \\psi_{g,m}(x_{d}) \\right).\n$$\n我们希望找到 $r_{g,m}(x)$ 使得 $R[\\psi] = \\langle r, \\psi \\rangle$：\n$$\n\\langle r, \\psi \\rangle = \\sum_{g=1}^{G} \\sum_{m=1}^{M} \\int_{0}^{L} w_{m} r_{g,m}(x) \\psi_{g,m}(x) dx.\n$$\n为使积分能够选出 $\\psi_{g,m}$ 在 $x=x_d$ 处的值，伴随源必须包含一个 Dirac δ函数，即 $\\delta(x-x_d)$。我们假设 $r_{g,m}(x) = f_{g,m} \\delta(x-x_d)$，其中 $f_{g,m}$ 是某些系数。\n$$\n\\langle r, \\psi \\rangle = \\sum_{g,m} \\int_{0}^{L} w_{m} \\left( f_{g,m} \\delta(x-x_d) \\right) \\psi_{g,m}(x) dx = \\sum_{g,m} w_{m} f_{g,m} \\psi_{g,m}(x_d).\n$$\n将其与 $R[\\psi]$ 的表达式相等：\n$$\n\\sum_{g,m} w_{m} f_{g,m} \\psi_{g,m}(x_d) = \\sum_{g,m} \\left( \\frac{1}{2} \\eta_g w_m \\right) \\psi_{g,m}(x_d).\n$$\n通过比较每个 $(g,m)$ 对应的 $\\psi_{g,m}(x_d)$ 的系数，我们发现：\n$$\nw_m f_{g,m} = \\frac{1}{2} \\eta_g w_m \\implies f_{g,m} = \\frac{1}{2} \\eta_g.\n$$\n因此，对应于点探测器响应泛函的伴随源为：\n$$\nr_{g,m}(x) = \\frac{1}{2} \\eta_g \\delta(x - x_d).\n$$\n该源在角度上是各向同性的（与 $m$ 无关），因为探测器响应是通过标量通量定义的，而标量通量是一个角度积分量。\n标准的互易关系通过伴随通量将响应与外源 $q$ 联系起来：$R[\\psi] = \\langle r, \\psi \\rangle = \\langle L^{\\dagger}\\psi^{\\dagger}, \\psi \\rangle = \\langle \\psi^{\\dagger}, L\\psi \\rangle = \\langle \\psi^{\\dagger}, q \\rangle$。",
            "answer": "$$\n\\boxed{r_{g,m}(x) = \\frac{1}{2} \\eta_{g} \\delta(x - x_d)}\n$$"
        },
        {
            "introduction": "伴随理论的优雅互易关系依赖于一个关键条件：必须精心选择伴随边界条件，以消除格林公式中的边界项，即双线性伴随项。本练习聚焦于周期性边界条件这一在反应堆物理中至关重要的情形。通过推导伴随通量必须满足的周期性条件，你将深刻理解如何通过恰当地配对正向与伴随问题，来确保在无限介质模型（如燃料栅格）中伴随方法的严谨性与适用性 。",
            "id": "4213181",
            "problem": "考虑在单个晶格单元体积 $V \\subset \\mathbb{R}^{3}$ 中的稳态单能中子输运。其边界 $\\partial V$ 由匹配的平面面偶 $\\{f_{p}^{-}, f_{p}^{+}\\}$（其中 $p \\in \\{1, 2, \\dots, P\\}$）组成。每一对面偶通过平移 $\\mathbf{r}^{+} = \\mathbf{r}^{-} + \\mathbf{d}_{p}$ 相关联，并且它们的外法向单位矢量满足 $\\mathbf{n}_{p}^{+} = -\\mathbf{n}_{p}^{-}$。令 $\\phi(\\mathbf{r}, \\boldsymbol{\\Omega})$ 表示正向角通量，$\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$ 表示伴随角通量，两者在 $V \\times \\mathbb{S}^{2}$ 上足够光滑，其中 $\\mathbb{S}^{2}$ 是单位方向球面，且 $\\boldsymbol{\\Omega} \\in \\mathbb{S}^{2}$。\n\n从 $V$ 上光滑矢量场的散度定理和流项 $\\boldsymbol{\\Omega} \\cdot \\nabla$ 出发，推导在流算子的正向-伴随恒等式中出现的边界双线性伴随项 $B(\\phi, \\psi)$，并表示为所有匹配面偶上的和：\n$$\nB(\\phi, \\psi) = \\sum_{p=1}^{P}\\left[\\int_{f_{p}^{-}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{-}) \\, \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S + \\int_{f_{p}^{+}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{+}) \\, \\phi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S \\right].\n$$\n假设正向问题具有周期性边界条件（BC），该条件强制角通量在匹配面之间连续，即对于每一对面偶 $p$、映射点 $(\\mathbf{r}^{-}, \\mathbf{r}^{+})$ 和方向 $\\boldsymbol{\\Omega}$，都有 $\\phi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) = \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega})$。陈述对 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$ 相应的伴随周期性要求，以确保双线性伴随项中的边界项被消除。然后，在这些正向和伴随周期性条件下，计算 $B(\\phi, \\psi)$ 的结果值。\n\n你的最终答案必须是单个实值数或单个闭式解析表达式。无需四舍五入。最终答案中不应包含单位。",
            "solution": "该问题要求得到两个结果：首先，在给定正向角通量 $\\phi(\\mathbf{r}, \\boldsymbol{\\Omega})$ 的周期性边界条件的情况下，确定伴随角通量 $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$ 的伴随周期性边界条件，以确保边界双线性伴随项 $B(\\phi, \\psi)$ 为零；其次，在这两种周期性条件下计算 $B(\\phi, \\psi)$ 的值。\n\n流算子的双线性伴随项，在所有匹配的边界面偶 $\\{f_{p}^{-}, f_{p}^{+}\\}$上求和，给出如下：\n$$\nB(\\phi, \\psi) = \\sum_{p=1}^{P}\\left[\\int_{f_{p}^{-}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{-}) \\, \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S + \\int_{f_{p}^{+}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{+}) \\, \\phi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S \\right]\n$$\n此处，$\\mathbf{r}^{-} \\in f_{p}^{-}$ 和 $\\mathbf{r}^{+} \\in f_{p}^{+}$ 是匹配面上的对应点。我们来分析求和中对应于面偶 $p$ 的单项。设此项为 $B_p(\\phi, \\psi)$。\n$$\nB_p(\\phi, \\psi) = \\int_{f_{p}^{-}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{-}) \\, \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S + \\int_{f_{p}^{+}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{+}) \\, \\phi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S\n$$\n我们已知以下关系：\n1.  几何映射：对于点 $\\mathbf{r}^{-} \\in f_{p}^{-}$，匹配面上的对应点是 $\\mathbf{r}^{+} = \\mathbf{r}^{-} + \\mathbf{d}_{p}$。由于这是一个纯平移，微分面元是相同的，$\\mathbf{r}^{+}$ 处的 $\\mathrm{d}S$ 对应于 $\\mathbf{r}^{-}$ 处的 $\\mathrm{d}S$。\n2.  外法线：$\\mathbf{n}_{p}^{+} = -\\mathbf{n}_{p}^{-}$。\n3.  正向周期性边界条件：$\\phi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) = \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega})$。\n\n让我们将 $B_p(\\phi, \\psi)$ 表达式中在面 $f_{p}^{+}$ 上的第二个积分，变换为在面 $f_{p}^{-}$ 上的积分。我们将 $\\mathbf{r}^{+}$ 替换为其关于 $\\mathbf{r}^{-}$ 的表达式，并将积分域从 $f_{p}^{+}$ 更改为 $f_{p}^{-}$。我们还代入法向矢量和正向通量的已知关系。\n\n第二个积分变为：\n$$\n\\int_{f_{p}^{+}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{+}) \\, \\phi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S = \\int_{f_{p}^{-}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot (-\\mathbf{n}_{p}^{-})) \\, \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{-}+\\mathbf{d}_p, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S\n$$\n我们可以将负号从内积中提出：\n$$\n= -\\int_{f_{p}^{-}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{-}) \\, \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S\n$$\n为清晰起见，此处我们将 $\\psi(\\mathbf{r}^{-}+\\mathbf{d}_p, \\boldsymbol{\\Omega})$ 写为 $\\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega})$，其中我们约定 $\\mathbf{r}^{+}$ 对应于 $\\mathbf{r}^{-}$。\n\n现在，将这个变换后的积分代回 $B_p(\\phi, \\psi)$ 的表达式中：\n$$\nB_p(\\phi, \\psi) = \\int_{f_{p}^{-}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{-}) \\, \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S - \\int_{f_{p}^{-}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{-}) \\, \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S\n$$\n由于这两个积分在相同的域上，我们可以将它们合并：\n$$\nB_p(\\phi, \\psi) = \\int_{f_{p}^{-}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{-}) \\, \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\left[ \\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) - \\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\right] \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S\n$$\n总边界项是所有面偶的和：\n$$\nB(\\phi, \\psi) = \\sum_{p=1}^{P} \\int_{f_{p}^{-}} \\int_{\\mathbb{S}^{2}} (\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{-}) \\, \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, \\left[ \\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) - \\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) \\right] \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S\n$$\n为了使正向-伴随恒等式在没有边界项的情况下成立，我们需要 $B(\\phi, \\psi) = 0$。对于任何满足物理问题和正向周期性边界条件的正向通量 $\\phi(\\mathbf{r}, \\boldsymbol{\\Omega})$，这种抵消都必须发生。由于 $\\phi(\\mathbf{r}, \\boldsymbol{\\Omega})$ 是任意的（且不恒为零），保证积分为零的唯一方法是要求积分内乘以它的项恒为零。\n因此，对于每个面偶 $p$、每个点 $\\mathbf{r}^{-} \\in f_{p}^{-}$ 和每个方向 $\\boldsymbol{\\Omega} \\in \\mathbb{S}^{2}$，我们必须施加以下条件：\n$$\n\\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) - \\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) = 0\n$$\n其中 $\\mathbf{r}^{+} = \\mathbf{r}^{-} + \\mathbf{d}_{p}$。这给出了伴随周期性要求：\n$$\n\\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) = \\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega})\n$$\n这是答案的第一部分。伴随边界条件是伴随通量也必须在匹配面之间是周期的，其形式与正向边界条件相同。\n\n问题的第二部分要求在同时强制施加正向和伴随周期性条件时，计算 $B(\\phi, \\psi)$ 的结果值。正向条件已被用于推导 $B(\\phi, \\psi)$ 的简化表达式。现在我们将伴随条件 $\\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) = \\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega})$ 应用于此表达式。\n\n将伴随周期性条件代入方括号中的项：\n$$\n\\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) - \\psi(\\mathbf{r}^{+}, \\boldsymbol{\\Omega}) = \\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) - \\psi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) = 0\n$$\n这使得每一项 $B_p(\\phi, \\psi)$ 的被积函数对于所有的 $(\\mathbf{r}^{-}, \\boldsymbol{\\Omega})$ 都等于零：\n$$\n(\\boldsymbol{\\Omega} \\cdot \\mathbf{n}_{p}^{-}) \\, \\phi(\\mathbf{r}^{-}, \\boldsymbol{\\Omega}) \\, [0] = 0\n$$\n因此，每个积分项 $B_p(\\phi, \\psi)$ 都变为零：\n$$\nB_p(\\phi, \\psi) = \\int_{f_{p}^{-}} \\int_{\\mathbb{S}^{2}} 0 \\, \\mathrm{d}\\boldsymbol{\\Omega} \\, \\mathrm{d}S = 0\n$$\n因为这对每一个面偶 $p = 1, 2, \\dots, P$ 都成立，所以总的双线性伴随项是零之和：\n$$\nB(\\phi, \\psi) = \\sum_{p=1}^{P} 0 = 0\n$$\n因此，在指定的正向和伴随周期性边界条件下，边界双线性伴随项的计算结果为零。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "从连续的理论方程到离散的计算程序是核反应堆模拟的核心步骤。本练习旨在通过一个具体实例，搭建起这座桥梁。你将采用离散纵标法和有限体积法，将一维输运方程转化为一个矩阵系统，并亲手构造出正向算符矩阵 $\\mathbf{L}$。在此基础上，通过定义的离散内积，你将进一步推导出其对应的伴随算符矩阵 $\\mathbf{L}^{\\dagger}$，从而直观地看到抽象的伴随关系在计算机中的具体实现形式 。",
            "id": "4213117",
            "problem": "考虑平板几何中的稳态、单能、一维中性粒子输运方程，对每个离散方向可写作 $\\mu \\,\\frac{d \\psi(x,\\mu)}{dx} + \\Sigma_{t} \\,\\psi(x,\\mu) = q(x,\\mu)$，其中 $\\psi$ 是角通量，$\\mu$ 是方向余弦，$\\Sigma_{t} > 0$ 是总宏观截面，而 $q$ 是一个已知源。假设材料是均匀的，具有恒定的 $\\Sigma_{t}$，且 $q(x,\\mu)$ 在两个空间网格上被分段定义为网格平均值。该平板被划分为两个宽度分别为 $\\Delta x_{1} = h$ 和 $\\Delta x_{2} = 2h$ 的相邻网格，其中 $h > 0$。使用离散纵标 (S$_{N}$) 方法，其中 $N=2$ 个方向由区间 $[-1,1]$ 上的两点高斯-勒让德求积给出，因此离散方向余弦为 $\\mu_{+} = \\frac{1}{\\sqrt{3}}$ 和 $\\mu_{-} = -\\frac{1}{\\sqrt{3}}$，相关权重为 $w_{+} = w_{-} = 1$。施加真空流入边界条件：在 $x=0$ 处对 $\\mu>0$ 施加，在 $x=L$ 处对 $\\mu0$ 施加，其中 $L = \\Delta x_{1} + \\Delta x_{2} = 3h$。 \n\n对每个离散角度，在每个网格中使用一阶迎风有限体积（网格平均）近似来离散化流项 $\\mu\\,\\frac{d\\psi}{dx}$。在有序基中定义未知向量 $\\boldsymbol{\\psi} = \\big(\\psi_{1,+}, \\psi_{2,+}, \\psi_{1,-}, \\psi_{2,-}\\big)^{\\top}$，其中 $\\psi_{i,\\pm}$ 分别表示网格 $i \\in \\{1,2\\}$ 中方向为 $\\mu_{+}$ 和 $\\mu_{-}$ 的网格平均角通量。令 $\\boldsymbol{q} = \\big(q_{1,+}, q_{2,+}, q_{1,-}, q_{2,-}\\big)^{\\top}$ 为对应的网格平均源向量。仅使用基本输运方程、指定的离散化方法和给定的真空边界，推导 $4 \\times 4$ 矩阵 $\\mathbf{L}$，使得离散正向系统 $\\mathbf{L}\\,\\boldsymbol{\\psi} = \\boldsymbol{q}$ 成立。\n\n接下来，将适用于此离散纵标有限体积设置的内积定义为\n$$\n\\langle \\boldsymbol{\\varphi}, \\boldsymbol{\\psi} \\rangle \\;=\\; \\sum_{i=1}^{2} \\sum_{\\alpha \\in \\{+,-\\}} w_{\\alpha}\\,\\Delta x_{i}\\,\\varphi_{i,\\alpha}\\,\\psi_{i,\\alpha},\n$$\n其中 $w_{\\alpha}$ 是求积权重，$\\Delta x_{i}$ 是网格宽度。使用该内积，构建伴随算子矩阵 $\\mathbf{L}^{\\dagger}$，使得对于所有满足一致伴随真空边界配对（该配对使边界双线性伴式为零）的向量 $\\boldsymbol{\\varphi}$ 和 $\\boldsymbol{\\psi}$，离散伴随关系 $\\langle \\boldsymbol{\\varphi}, \\mathbf{L}\\,\\boldsymbol{\\psi} \\rangle = \\langle \\mathbf{L}^{\\dagger}\\,\\boldsymbol{\\varphi}, \\boldsymbol{\\psi} \\rangle$ 成立。用 $\\Sigma_{t}$、$h$ 和 $\\mu_{+} = \\frac{1}{\\sqrt{3}}$ 明确表示 $\\mathbf{L}^{\\dagger}$。\n\n你的最终答案必须是以 $\\Sigma_{t}$、$h$ 和 $\\mu_{+}$ 表示的精确解析表达式的矩阵对 $\\mathbf{L}$ 和 $\\mathbf{L}^{\\dagger}$，不带单位。不要近似数值常数。最终表达式必须是闭合形式，且不包含任何不等式或方程。",
            "solution": "用户希望我按照以下步骤解决问题：\n1.  **验证问题陈述**：我将检查问题是否存在不一致、信息缺失或科学不准确之处。\n2.  如果问题有效，我将通过以下方式解决：\n    a.  通过离散化输运方程推导正向算子矩阵 `L`。\n    b.  使用给定的内积推导伴随算子矩阵 `L†`。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **控制方程**：稳态、单能、一维输运方程：$\\mu \\,\\frac{d \\psi(x,\\mu)}{dx} + \\Sigma_{t} \\,\\psi(x,\\mu) = q(x,\\mu)$。\n-   **参数**：$\\Sigma_t > 0$ 是一个恒定的总宏观截面。\n-   **几何**：长度为 $L=3h$ 的平板，划分为两个网格。\n    -   网格 1：$x \\in [0, h]$，宽度 $\\Delta x_1 = h$。\n    -   网格 2：$x \\in [h, 3h]$，宽度 $\\Delta x_2 = 2h$。\n-   **角度离散化**：离散纵标 (S$_N$) 法，其中 $N=2$。\n    -   方向：$\\mu_{+} = \\frac{1}{\\sqrt{3}}$ 和 $\\mu_{-} = -\\frac{1}{\\sqrt{3}}$。\n    -   权重：$w_{+} = w_{-} = 1$。\n-   **边界条件**：真空流入。\n    -   $\\psi(0, \\mu > 0) = 0$。\n    -   $\\psi(L, \\mu  0) = 0$，其中 $L = 3h$。\n-   **空间离散化**：一阶迎风有限体积（网格平均）近似。\n-   **未知数**：网格平均角通量，排序为 $\\boldsymbol{\\psi} = \\big(\\psi_{1,+}, \\psi_{2,+}, \\psi_{1,-}, \\psi_{2,-}\\big)^{\\top}$。\n-   **源**：网格平均源向量 $\\boldsymbol{q} = \\big(q_{1,+}, q_{2,+}, q_{1,-}, q_{2,-}\\big)^{\\top}$。\n-   **系统**：$\\mathbf{L}\\,\\boldsymbol{\\psi} = \\boldsymbol{q}$。\n-   **内积**：$\\langle \\boldsymbol{\\varphi}, \\boldsymbol{\\psi} \\rangle = \\sum_{i=1}^{2} \\sum_{\\alpha \\in \\{+,-\\}} w_{\\alpha}\\,\\Delta x_{i}\\,\\varphi_{i,\\alpha}\\,\\psi_{i,\\alpha}$。\n-   **伴随关系**：$\\langle \\boldsymbol{\\varphi}, \\mathbf{L}\\,\\boldsymbol{\\psi} \\rangle = \\langle \\mathbf{L}^{\\dagger}\\,\\boldsymbol{\\varphi}, \\boldsymbol{\\psi} \\rangle$，假设伴随边界条件使边界项为零。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学上成立**：该问题基于完善的线性玻尔兹曼输运方程以及核工程和输运物理学中使用的标准数值方法（离散纵标法、有限体积法）。它在科学上是合理的。\n-   **适定的**：该问题的结构旨在为离散算子 $\\mathbf{L}$ 和 $\\mathbf{L}^{\\dagger}$ 产生唯一解。边界条件、离散格式和内积都已明确指定，没有歧义。\n-   **客观的**：该问题以精确的数学和物理术语陈述，不含主观性或个人观点。\n\n该问题不存在科学不健全、不完整、矛盾或含糊不清等缺陷。这是计算输运理论中一个标准的、定义明确的问题。\n\n**步骤 3：结论与行动**\n\n问题有效。我将继续推导解答。\n\n### 第 1 部分：正向算子矩阵 $\\mathbf{L}$ 的推导\n\n我们从离散方向 $\\mu_{\\alpha}$ 的稳态一维输运方程开始：\n$$\n\\mu_{\\alpha} \\frac{d\\psi_{\\alpha}(x)}{dx} + \\Sigma_t \\psi_{\\alpha}(x) = q_{\\alpha}(x)\n$$\n我们应用有限体积法，将此方程在一个从 $x_{i-1/2}$ 到 $x_{i+1/2}$、宽度为 $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ 的空间网格 $i$ 上积分。\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\mu_{\\alpha} \\frac{d\\psi_{\\alpha}}{dx} + \\Sigma_t \\psi_{\\alpha} \\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} q_{\\alpha}(x) dx\n$$\n这得到：\n$$\n\\mu_{\\alpha} \\left[ \\psi_{\\alpha}(x_{i+1/2}) - \\psi_{\\alpha}(x_{i-1/2}) \\right] + \\Sigma_t \\Delta x_i \\psi_{i,\\alpha} = \\Delta x_i q_{i,\\alpha}\n$$\n在这里，$\\psi_{i,\\alpha}$ 和 $q_{i,\\alpha}$ 是网格平均角通量和源，而 $\\psi_{\\alpha}(x_{i\\pm1/2})$ 是网格边缘的角通量。两边除以 $\\Delta x_i$，我们得到半离散方程：\n$$\n\\frac{\\mu_{\\alpha}}{\\Delta x_i} \\left( \\psi_{\\alpha, i+1/2} - \\psi_{\\alpha, i-1/2} \\right) + \\Sigma_t \\psi_{i,\\alpha} = q_{i,\\alpha}\n$$\n一阶迎风格式用当前网格的网格平均通量近似流出边通量，用上游相邻网格的网格平均通量近似流入边通量。\n\n该系统由四个方程定义，对应于 $\\boldsymbol{\\psi} = (\\psi_{1,+}, \\psi_{2,+}, \\psi_{1,-}, \\psi_{2,-})^{\\top}$ 中的四个未知数。\n\n**情况 1：正方向 ($\\mu = \\mu_{+} > 0$)**\n粒子从左向右流动。迎风近似为 $\\psi_{+,i+1/2} \\approx \\psi_{i,+}$ 和 $\\psi_{+,i-1/2} \\approx \\psi_{i-1,+}$。\n\n-   **网格 1**：$i=1$, $\\Delta x_1=h$, $x_{1/2}=0$, $x_{3/2}=h$。\n    $$\n    \\frac{\\mu_{+}}{h} \\left( \\psi_{+, 3/2} - \\psi_{+, 1/2} \\right) + \\Sigma_t \\psi_{1,+} = q_{1,+}\n    $$\n    流入发生在区域边界 $x=0$ 处，因此根据真空边界条件，$\\psi_{+, 1/2} = \\psi(0, \\mu_{+}) = 0$。流出为 $\\psi_{+, 3/2} \\approx \\psi_{1,+}$。\n    $$\n    \\frac{\\mu_{+}}{h} \\left( \\psi_{1,+} - 0 \\right) + \\Sigma_t \\psi_{1,+} = q_{1,+} \\implies \\left(\\frac{\\mu_{+}}{h} + \\Sigma_t\\right) \\psi_{1,+} = q_{1,+}\n    $$\n    这是系统 $\\mathbf{L}\\boldsymbol{\\psi} = \\boldsymbol{q}$ 的第一个方程。\n\n-   **网格 2**：$i=2$, $\\Delta x_2=2h$, $x_{3/2}=h$, $x_{5/2}=3h$。\n    $$\n    \\frac{\\mu_{+}}{2h} \\left( \\psi_{+, 5/2} - \\psi_{+, 3/2} \\right) + \\Sigma_t \\psi_{2,+} = q_{2,+}\n    $$\n    从网格 1 流入的通量为 $\\psi_{+, 3/2} \\approx \\psi_{1,+}$。流出为 $\\psi_{+, 5/2} \\approx \\psi_{2,+}$。\n    $$\n    \\frac{\\mu_{+}}{2h} \\left( \\psi_{2,+} - \\psi_{1,+} \\right) + \\Sigma_t \\psi_{2,+} = q_{2,+} \\implies -\\frac{\\mu_{+}}{2h}\\psi_{1,+} + \\left(\\frac{\\mu_{+}}{2h} + \\Sigma_t\\right)\\psi_{2,+} = q_{2,+}\n    $$\n    这是系统的第二个方程。\n\n**情况 2：负方向 ($\\mu = \\mu_{-}  0$)**\n粒子从右向左流动。迎风近似为 $\\psi_{-,i-1/2} \\approx \\psi_{i,-}$ 和 $\\psi_{-,i+1/2} \\approx \\psi_{i+1,-}$。\n\n-   **网格 2**：$i=2$, $\\Delta x_2=2h$, $x_{3/2}=h$, $x_{5/2}=3h=L$。\n    $$\n    \\frac{\\mu_{-}}{2h} \\left( \\psi_{-, 5/2} - \\psi_{-, 3/2} \\right) + \\Sigma_t \\psi_{2,-} = q_{2,-}\n    $$\n    流入发生在区域边界 $x=L$ 处，因此 $\\psi_{-, 5/2} = \\psi(L, \\mu_{-}) = 0$。流出为 $\\psi_{-, 3/2} \\approx \\psi_{2,-}$。\n    $$\n    \\frac{\\mu_{-}}{2h} \\left( 0 - \\psi_{2,-} \\right) + \\Sigma_t \\psi_{2,-} = q_{2,-} \\implies \\left(-\\frac{\\mu_{-}}{2h} + \\Sigma_t\\right)\\psi_{2,-} = q_{2,-}\n    $$\n    使用 $\\mu_{-} = -\\mu_{+}$，这变为 $\\left(\\frac{\\mu_{+}}{2h} + \\Sigma_t\\right)\\psi_{2,-} = q_{2,-}$。这是系统的第四个方程。\n\n-   **网格 1**：$i=1$, $\\Delta x_1=h$, $x_{1/2}=0$, $x_{3/2}=h$。\n    $$\n    \\frac{\\mu_{-}}{h} \\left( \\psi_{-, 3/2} - \\psi_{-, 1/2} \\right) + \\Sigma_t \\psi_{1,-} = q_{1,-}\n    $$\n    从网格 2 流入的通量为 $\\psi_{-, 3/2} \\approx \\psi_{2,-}$。流出为 $\\psi_{-, 1/2} \\approx \\psi_{1,-}$。\n    $$\n    \\frac{\\mu_{-}}{h} \\left( \\psi_{2,-} - \\psi_{1,-} \\right) + \\Sigma_t \\psi_{1,-} = q_{1,-} \\implies \\left(-\\frac{\\mu_{-}}{h} + \\Sigma_t\\right)\\psi_{1,-} + \\frac{\\mu_{-}}{h}\\psi_{2,-} = q_{1,-}\n    $$\n    使用 $\\mu_{-} = -\\mu_{+}$，这变为 $\\left(\\frac{\\mu_{+}}{h} + \\Sigma_t\\right)\\psi_{1,-} - \\frac{\\mu_{+}}{h}\\psi_{2,-} = q_{1,-}$。这是系统的第三个方程。\n\n**组装矩阵 $\\mathbf{L}$**\n根据推导出的方程和指定的排序 $\\boldsymbol{\\psi} = (\\psi_{1,+}, \\psi_{2,+}, \\psi_{1,-}, \\psi_{2,-})^{\\top}$，矩阵 $\\mathbf{L}$ 为：\n$$\n\\mathbf{L} = \\begin{pmatrix}\n\\frac{\\mu_{+}}{h} + \\Sigma_{t}  0  0  0 \\\\\n-\\frac{\\mu_{+}}{2h}  \\frac{\\mu_{+}}{2h} + \\Sigma_{t}  0  0 \\\\\n0  0  \\frac{\\mu_{+}}{h} + \\Sigma_{t}  -\\frac{\\mu_{+}}{h} \\\\\n0  0  0  \\frac{\\mu_{+}}{2h} + \\Sigma_{t}\n\\end{pmatrix}\n$$\n\n### 第 2 部分：伴随算子矩阵 $\\mathbf{L}^{\\dagger}$ 的推导\n\n伴随算子 $\\mathbf{L}^{\\dagger}$ 由关系 $\\langle \\boldsymbol{\\varphi}, \\mathbf{L}\\,\\boldsymbol{\\psi} \\rangle = \\langle \\mathbf{L}^{\\dagger}\\,\\boldsymbol{\\varphi}, \\boldsymbol{\\psi} \\rangle$ 定义。\n给定的内积可以写成矩阵形式 $\\langle \\boldsymbol{\\varphi}, \\boldsymbol{\\psi} \\rangle = \\boldsymbol{\\varphi}^{\\top} \\mathbf{W} \\boldsymbol{\\psi}$，其中 $\\mathbf{W}$ 是权重 $w_{\\alpha}\\Delta x_{i}$ 的对角矩阵。\n向量分量 $(\\psi_{1,+}, \\psi_{2,+}, \\psi_{1,-}, \\psi_{2,-})$ 的权重为：\n-   $w_{+}\\Delta x_1 = (1)(h) = h$\n-   $w_{+}\\Delta x_2 = (1)(2h) = 2h$\n-   $w_{-}\\Delta x_1 = (1)(h) = h$\n-   $w_{-}\\Delta x_2 = (1)(2h) = 2h$\n因此，权重矩阵为 $\\mathbf{W} = \\text{diag}(h, 2h, h, 2h)$。\n\n伴随关系变为：\n$$\n\\boldsymbol{\\varphi}^{\\top} \\mathbf{W} (\\mathbf{L} \\boldsymbol{\\psi}) = (\\mathbf{L}^{\\dagger} \\boldsymbol{\\varphi})^{\\top} \\mathbf{W} \\boldsymbol{\\psi} = \\boldsymbol{\\varphi}^{\\top} (\\mathbf{L}^{\\dagger})^{\\top} \\mathbf{W} \\boldsymbol{\\psi}\n$$\n这必须对所有 $\\boldsymbol{\\varphi}$ 和 $\\boldsymbol{\\psi}$ 成立，这意味着矩阵恒等式 $\\mathbf{W}\\mathbf{L} = (\\mathbf{L}^{\\dagger})^{\\top}\\mathbf{W}$ 成立。\n求解 $\\mathbf{L}^{\\dagger}$ 可得 $\\mathbf{L}^{\\dagger} = \\mathbf{W}^{-1} \\mathbf{L}^{\\top} \\mathbf{W}$。\n\n我们有 $\\mathbf{W} = \\text{diag}(h, 2h, h, 2h)$ 和 $\\mathbf{W}^{-1} = \\text{diag}(\\frac{1}{h}, \\frac{1}{2h}, \\frac{1}{h}, \\frac{1}{2h})$。\n$\\mathbf{L}$ 的转置是：\n$$\n\\mathbf{L}^{\\top} = \\begin{pmatrix}\n\\frac{\\mu_{+}}{h} + \\Sigma_{t}  -\\frac{\\mu_{+}}{2h}  0  0 \\\\\n0  \\frac{\\mu_{+}}{2h} + \\Sigma_{t}  0  0 \\\\\n0  0  \\frac{\\mu_{+}}{h} + \\Sigma_{t}  0 \\\\\n0  0  -\\frac{\\mu_{+}}{h}  \\frac{\\mu_{+}}{2h} + \\Sigma_{t}\n\\end{pmatrix}\n$$\n首先，我们计算 $\\mathbf{L}^{\\top} \\mathbf{W}$：\n$$\n\\mathbf{L}^{\\top} \\mathbf{W} = \\begin{pmatrix}\n\\frac{\\mu_{+}}{h} + \\Sigma_{t}  -\\frac{\\mu_{+}}{2h}  0  0 \\\\\n0  \\frac{\\mu_{+}}{2h} + \\Sigma_{t}  0  0 \\\\\n0  0  \\frac{\\mu_{+}}{h} + \\Sigma_{t}  0 \\\\\n0  0  -\\frac{\\mu_{+}}{h}  \\frac{\\mu_{+}}{2h} + \\Sigma_{t}\n\\end{pmatrix} \\begin{pmatrix}\nh  0  0  0 \\\\\n0  2h  0  0 \\\\\n0  0  h  0 \\\\\n0  0  0  2h\n\\end{pmatrix} = \\begin{pmatrix}\n\\mu_{+} + \\Sigma_{t}h  -\\mu_{+}  0  0 \\\\\n0  \\mu_{+} + 2\\Sigma_{t}h  0  0 \\\\\n0  0  \\mu_{+} + \\Sigma_{t}h  0 \\\\\n0  0  -\\mu_{+}  \\mu_{+} + 2\\Sigma_{t}h\n\\end{pmatrix}\n$$\n最后，我们左乘 $\\mathbf{W}^{-1}$：\n$$\n\\mathbf{L}^{\\dagger} = \\mathbf{W}^{-1}(\\mathbf{L}^{\\top} \\mathbf{W}) = \\begin{pmatrix}\n\\frac{1}{h}  0  0  0 \\\\\n0  \\frac{1}{2h}  0  0 \\\\\n0  0  \\frac{1}{h}  0 \\\\\n0  0  0  \\frac{1}{2h}\n\\end{pmatrix} \\begin{pmatrix}\n\\mu_{+} + \\Sigma_{t}h  -\\mu_{+}  0  0 \\\\\n0  \\mu_{+} + 2\\Sigma_{t}h  0  0 \\\\\n0  0  \\mu_{+} + \\Sigma_{t}h  0 \\\\\n0  0  -\\mu_{+}  \\mu_{+} + 2\\Sigma_{t}h\n\\end{pmatrix}\n$$\n$$\n\\mathbf{L}^{\\dagger} = \\begin{pmatrix}\n\\frac{\\mu_{+}}{h} + \\Sigma_{t}  -\\frac{\\mu_{+}}{h}  0  0 \\\\\n0  \\frac{\\mu_{+}}{2h} + \\Sigma_{t}  0  0 \\\\\n0  0  \\frac{\\mu_{+}}{h} + \\Sigma_{t}  0 \\\\\n0  0  -\\frac{\\mu_{+}}{2h}  \\frac{\\mu_{+}}{2h} + \\Sigma_{t}\n\\end{pmatrix}\n$$\n该矩阵表示离散化的伴随算子。其结构对应于一个输运问题：方向指数为“+”的粒子从右向左流动，方向指数为“-”的粒子从左向右流动，这与连续伴随算子 $L^{\\dagger}\\psi^{\\dagger} = -\\mu \\frac{d\\psi^{\\dagger}}{dx} + \\Sigma_t \\psi^{\\dagger}$ 一致。\n\n最终答案是矩阵对 $\\mathbf{L}$ 和 $\\mathbf{L}^{\\dagger}$。",
            "answer": "$$\n\\boxed{\n\\mathbf{L} = \\begin{pmatrix}\n\\Sigma_{t} + \\frac{\\mu_{+}}{h}  0  0  0 \\\\\n-\\frac{\\mu_{+}}{2h}  \\Sigma_{t} + \\frac{\\mu_{+}}{2h}  0  0 \\\\\n0  0  \\Sigma_{t} + \\frac{\\mu_{+}}{h}  -\\frac{\\mu_{+}}{h} \\\\\n0  0  0  \\Sigma_{t} + \\frac{\\mu_{+}}{2h}\n\\end{pmatrix}, \\quad \\mathbf{L}^\\dagger = \\begin{pmatrix}\n\\Sigma_{t} + \\frac{\\mu_{+}}{h}  -\\frac{\\mu_{+}}{h}  0  0 \\\\\n0  \\Sigma_{t} + \\frac{\\mu_{+}}{2h}  0  0 \\\\\n0  0  \\Sigma_{t} + \\frac{\\mu_{+}}{h}  0 \\\\\n0  0  -\\frac{\\mu_{+}}{2h}  \\Sigma_{t} + \\frac{\\mu_{+}}{2h}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}