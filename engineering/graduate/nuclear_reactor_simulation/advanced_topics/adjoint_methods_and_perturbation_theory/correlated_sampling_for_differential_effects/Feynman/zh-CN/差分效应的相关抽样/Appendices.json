{
    "hands_on_practices": [
        {
            "introduction": "理论是实践的基石。此练习将引导您回归基本原理，通过一个简化的中子输运场景，精确揭示共用随机数（CRN）技术降低方差的核心机制。通过从第一性原理推导方差减少因子（VRF），您将对相关性（$\\rho$）与计算效率之间的定量关系建立深刻的理解，为应用更复杂的关联抽样方法打下坚实的理论基础 ()。",
            "id": "4219745",
            "problem": "考虑厚度为 $L$ 的均匀平板中的单能中子输运，中子进行各向同性、直线飞行。到下一次相互作用的自由程 $s$ 服从指数分布，其概率密度函数为 $f(s) = \\Sigma_{t} \\exp(-\\Sigma_{t} s)$，其中 $\\Sigma_{t}$ 是宏观总截面。一个从中子一个面入射的中子未经相互作用穿出平板的概率（透射率）为 $T = \\exp(-\\Sigma_{t} L)$。假设一个微扰系统的宏观总截面为 $\\Sigma_{t}' = \\Sigma_{t} + \\delta \\Sigma$，其中 $|\\delta \\Sigma| \\ll \\Sigma_{t}$。定义基准系统中单个历史的透射得分为 $X = \\mathbf{1}\\{s > L\\}$，微扰系统中为 $Y = \\mathbf{1}\\{s' > L\\}$，其中 $s$ 和 $s'$ 是通过逆变换采样方法，分别由独立的标准均匀随机数 $U$ 和 $U'$ 通过 $s = -\\ln(U)/\\Sigma_{t}$ 和 $s' = -\\ln(U')/\\Sigma_{t}'$ 抽样得到。关心量是透射率差值 $\\Delta T = T' - T$，通过每个系统 $n$ 个历史的样本均值之差 $\\widehat{\\Delta T} = \\overline{Y} - \\overline{X}$ 来估计。\n\n考虑两种抽样策略：\n1. 独立抽样：独立地抽取 $\\{U_{i}\\}$ 和 $\\{U_{i}'\\}$，从而产生独立的 $\\{X_{i}\\}$ 和 $\\{Y_{i}\\}$。\n2. 公共随机数 (CRN)：使用相同的 $U_{i}$ 来生成 $s_{i}$ 和 $s_{i}'$，从而在 $X_{i}$ 和 $Y_{i}$ 之间引入相关性。\n\n定义方差减少因子 (VRF) 为 $\\mathrm{VRF} = \\mathrm{Var}_{\\text{indep}}(\\widehat{\\Delta T}) / \\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T})$。从方差、协方差和相关性的定义出发，仅使用指数飞行分布和指示函数估计量的性质，推导 VRF 作为在 CRN 下配对得分的单个历史相关系数 $\\rho$ 的函数表达式。此推导应在微小差异效应的情况下进行，此时可认为两个系统中单个历史的得分方差相等。然后，计算当 $\\rho = 0.9$ 时 VRF 的数值。明确陈述你所需的任何假设，并确保推导中的所有步骤都从第一性原理出发得到合理解释。最终的数值答案是无量纲的，且不需要四舍五入。",
            "solution": "首先根据所需准则对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n-   **系统**：厚度为 $L$ 的均匀平板中的单能中子输运。\n-   **中子飞行**：各向同性、直线飞行。\n-   **自由程概率密度函数**：$f(s) = \\Sigma_{t} \\exp(-\\Sigma_{t} s)$，其中 $\\Sigma_{t}$ 是宏观总截面。\n-   **基准透射率**：$T = \\exp(-\\Sigma_{t} L)$。\n-   **微扰系统截面**：$\\Sigma_{t}' = \\Sigma_{t} + \\delta \\Sigma$，其中 $|\\delta \\Sigma| \\ll \\Sigma_{t}$。\n-   **单个历史基准得分**：$X = \\mathbf{1}\\{s > L\\}$，一个指示函数。\n-   **单个历史微扰得分**：$Y = \\mathbf{1}\\{s' > L\\}$，一个指示函数。\n-   **抽样**：从标准均匀随机数 $U$ 和 $U'$ 进行逆变换采样。\n-   **路径长度抽样公式**：$s = -\\ln(U)/\\Sigma_{t}$ 和 $s' = -\\ln(U')/\\Sigma_{t}'$。\n-   **关心量**：$\\Delta T = T' - T$，其中 $T' = \\exp(-\\Sigma_{t}' L)$。\n-   **估计量**：$\\widehat{\\Delta T} = \\overline{Y} - \\overline{X}$，其中 $\\overline{X}$ 和 $\\overline{Y}$ 是 $n$ 个历史的样本均值。\n-   **抽样策略**：1. 独立抽样：$\\{U_{i}\\}$ 和 $\\{U_{i}'\\}$ 是独立的随机数集。 2. 公共随机数 (CRN)：使用相同的随机数 $U_{i}$ 生成配对得分 $X_i$ 和 $Y_i$。\n-   **定义**：方差减少因子, $\\mathrm{VRF} = \\mathrm{Var}_{\\text{indep}}(\\widehat{\\Delta T}) / \\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T})$。\n-   **任务1**：推导 VRF 作为 CRN 下配对得分的单个历史相关系数 $\\rho$ 的函数表达式。\n-   **条件**：推导需在微小差异效应的情况下进行，此时假设两个系统中单个历史的得分方差相等。\n-   **任务2**：计算当 $\\rho = 0.9$ 时 VRF 的数值。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学和数学上是合理的。它描述了蒙特卡罗粒子输运模拟中的一个标准（尽管简化了）的问题。自由程使用指数分布、逆变换采样以及指示函数估计量都是该领域的基本概念。使用相关抽样（特别是公共随机数）研究微分效应是反应堆物理中微扰分析的基石。该问题是自洽的，提供了所有必要的定义和条件。对于小微扰，假设方差相等的做法是一个标准且合理的近似。问题提法得当且客观，会导出一个唯一且有意义的解。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将提供一个完整、合理的解答。\n\n### 推导\n\n需要估计的量是透射概率的差值，$\\Delta T = T' - T$。基于 $n$ 个模拟历史，该量的蒙特卡罗估计量为 $\\widehat{\\Delta T} = \\overline{Y} - \\overline{X}$。这里，$\\overline{X} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ 和 $\\overline{Y} = \\frac{1}{n}\\sum_{i=1}^{n} Y_i$ 分别是基准系统和微扰系统单个历史得分的样本均值。\n\n该估计量的方差由差值方差的一般公式给出：\n$$\n\\mathrm{Var}(\\widehat{\\Delta T}) = \\mathrm{Var}(\\overline{Y} - \\overline{X}) = \\mathrm{Var}(\\overline{Y}) + \\mathrm{Var}(\\overline{X}) - 2\\mathrm{Cov}(\\overline{X}, \\overline{Y})\n$$\n由于单个历史 $(X_i, Y_i)$ 是独立同分布对，样本均值的方差为 $\\mathrm{Var}(\\overline{X}) = \\frac{\\mathrm{Var}(X)}{n}$ 和 $\\mathrm{Var}(\\overline{Y}) = \\frac{\\mathrm{Var}(Y)}{n}$。类似地，样本均值的协方差为 $\\mathrm{Cov}(\\overline{X}, \\overline{Y}) = \\frac{\\mathrm{Cov}(X, Y)}{n}$。令 $\\sigma_X^2 = \\mathrm{Var}(X)$ 和 $\\sigma_Y^2 = \\mathrm{Var}(Y)$ 表示单个历史的方差。估计量的方差变为：\n$$\n\\mathrm{Var}(\\widehat{\\Delta T}) = \\frac{1}{n} \\left( \\sigma_Y^2 + \\sigma_X^2 - 2\\mathrm{Cov}(X, Y) \\right)\n$$\n现在我们针对两种指定的抽样策略分析这个表达式。\n\n**1. 独立抽样**\n在此策略中，基准系统的得分 $X_i$ 和微扰系统的得分 $Y_i$ 是由独立的随机数生成的。因此，得分 $X$ 和 $Y$ 是统计上独立的随机变量。独立变量的一个基本性质是它们的协方差为零。\n$$\n\\mathrm{Cov}(X, Y) = 0\n$$\n将此代入一般方差公式，得到独立抽样情况下的方差：\n$$\n\\mathrm{Var}_{\\text{indep}}(\\widehat{\\Delta T}) = \\frac{1}{n} (\\sigma_X^2 + \\sigma_Y^2)\n$$\n\n**2. 公共随机数 (CRN) 抽样**\n在此策略中，使用相同的随机数 $U_i$ 来生成 $s_i = -\\ln(U_i)/\\Sigma_t$ 和 $s_i' = -\\ln(U_i)/\\Sigma_t'$。这会在得分 $X_i$ 和 $Y_i$ 之间引入统计相关性。因此，它们的协方差 $\\mathrm{Cov}(X, Y)$ 通常不为零。因此，CRN情况下的方差为：\n$$\n\\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T}) = \\frac{1}{n} \\left( \\sigma_X^2 + \\sigma_Y^2 - 2\\mathrm{Cov}(X, Y) \\right)\n$$\n问题将 $\\rho$ 定义为配对得分 $X$ 和 $Y$ 之间的相关系数。根据定义，相关系数与协方差的关系如下：\n$$\n\\rho = \\frac{\\mathrm{Cov}(X, Y)}{\\sqrt{\\sigma_X^2 \\sigma_Y^2}} = \\frac{\\mathrm{Cov}(X, Y)}{\\sigma_X \\sigma_Y}\n$$\n由此，我们可以将协方差表示为 $\\mathrm{Cov}(X, Y) = \\rho \\sigma_X \\sigma_Y$。将此代入CRN的方差表达式，得到：\n$$\n\\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T}) = \\frac{1}{n} \\left( \\sigma_X^2 + \\sigma_Y^2 - 2\\rho \\sigma_X \\sigma_Y \\right)\n$$\n\n**方差减少因子 (VRF) 的推导**\n问题要求在单个历史得分方差相等的假设下进行推导，这对于 $|\\delta\\Sigma| \\ll \\Sigma_t$ 的小微扰是一个常见且合理的近似。我们用 $\\sigma^2$ 表示这个共同的方差：\n$$\n\\sigma_X^2 = \\sigma_Y^2 = \\sigma^2\n$$\n这意味着 $\\sigma_X = \\sigma_Y = \\sigma$。\n\n我们可以证明这个假设是合理的。得分 $X = \\mathbf{1}\\{s > L\\}$ 是一个伯努利随机变量。其期望值为 $E[X] = P(s > L)$。$P(s > L) = P(-\\ln(U)/\\Sigma_t > L) = P(\\ln(U)  -\\Sigma_t L) = P(U  \\exp(-\\Sigma_t L))$。由于 $U$ 在 $(0, 1)$ 上均匀分布，对于 $a \\in [0, 1]$，有 $P(U  a) = a$。因此，$E[X] = \\exp(-\\Sigma_t L) = T$。成功概率为 $p$ 的伯努利变量的方差是 $p(1-p)$。因此，$\\sigma_X^2 = T(1-T)$。类似地，对于微扰系统，$\\sigma_Y^2 = T'(1-T')$。条件 $|\\delta\\Sigma| \\ll \\Sigma_t$ 意味着 $T' = \\exp(-(\\Sigma_t+\\delta\\Sigma)L) \\approx T$。由于方差函数 $v(p) = p(1-p)$ 是连续的，$T' \\approx T$ 意味着 $\\sigma_Y^2 \\approx \\sigma_X^2$。因此，该假设在指定的情况下是物理和数学上合理的。\n\n将假设 $\\sigma_X^2 = \\sigma_Y^2 = \\sigma^2$ 应用于两种抽样方案的方差表达式：\n对于独立抽样：\n$$\n\\mathrm{Var}_{\\text{indep}}(\\widehat{\\Delta T}) = \\frac{1}{n} (\\sigma^2 + \\sigma^2) = \\frac{2\\sigma^2}{n}\n$$\n对于 CRN 抽样：\n$$\n\\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T}) = \\frac{1}{n} (\\sigma^2 + \\sigma^2 - 2\\rho \\sigma \\sigma) = \\frac{1}{n} (2\\sigma^2 - 2\\rho \\sigma^2) = \\frac{2\\sigma^2(1-\\rho)}{n}\n$$\n方差减少因子 (VRF) 定义为这两个方差的比值：\n$$\n\\mathrm{VRF} = \\frac{\\mathrm{Var}_{\\text{indep}}(\\widehat{\\Delta T})}{\\mathrm{Var}_{\\text{CRN}}(\\widehat{\\Delta T})} = \\frac{\\frac{2\\sigma^2}{n}}{\\frac{2\\sigma^2(1-\\rho)}{n}}\n$$\n从分子和分母中消去公因子 $\\frac{2\\sigma^2}{n}$，得到 VRF 作为 $\\rho$ 函数的最终表达式：\n$$\n\\mathrm{VRF} = \\frac{1}{1-\\rho}\n$$\n这个结果表明，对于正相关（$\\rho  0$）（这在使用CRN处理小微扰时是预期的），CRN估计量的方差小于独立估计量的方差，从而导致VRF大于1。当 $\\rho$ 趋近于1时，CRN方法的效率显著增加。\n\n**数值计算**\n问题要求计算当相关系数为 $\\rho = 0.9$ 时 VRF 的数值。\n$$\n\\mathrm{VRF} = \\frac{1}{1 - 0.9} = \\frac{1}{0.1} = 10\n$$\n$\\rho=0.9$ 的相关性导致了10的方差减少因子。这意味着，要在 $\\Delta T$ 的估计上达到相同的统计精度，独立抽样模拟所需的中子历史数是使用CRN技术的模拟的10倍。",
            "answer": "$$\\boxed{10}$$"
        },
        {
            "introduction": "掌握理论后，我们需将其付诸实践。本练习将引导您从纯理论推导过渡到计算实践，模拟估算有效增殖因子变化量（$\\Delta k_{\\text{eff}}$）这一反应堆分析中的核心任务。通过在代码中实施CRN策略，并将模拟结果与理论预测进行对比 ()，您不仅能验证CRN技术在实际问题中的强大降方差能力，还能加深对抽象统计模型与真实工程问题之间联系的理解。",
            "id": "4219754",
            "problem": "您的任务是构建一个基于共用随机数 (CRN) 的估计量，用于计算一个基准核系统和一个轻微微扰的核系统之间的有效增殖因子变化量（表示为 $\\Delta k_{\\text{eff}}$），并分析由共用裂变源库抽样引起的协方差。将每个历史的增殖因子贡献建模为共用裂变源随机变量的线性泛函，以反映在不同系统间复用相同的裂变源样本。将基准系统中每个历史的贡献视为 $X_i = \\mu_0 + \\sigma_0 Z_i$，微扰系统中视为 $Y_i = \\mu_1 + \\sigma_1 Z_i$，其中 $i = 1, \\dots, N$，$Z_i$ 是独立同分布的标准正态随机变量，通过逆累积分布变换从共用的均匀随机数生成，以强制实现 CRN。使用共用的 $Z_i$ 模拟了在两个系统间复用裂变源库。有效增殖因子的变化量通过样本均值差 $\\widehat{\\Delta k}_{\\text{eff}} = \\overline{Y} - \\overline{X}$ 进行估计。\n\n从基本的蒙特卡罗定义和概率性质出发：样本均值是期望的无偏估计量、期望的线性性质，以及协方差的双线性性质（其中独立性假设仅限于驱动随机变量）。假设上述一阶线性响应模型对于核数据中的小微扰是有效的，并且 $Z_i$ 是通过将独立同分布的均匀随机变量 $U_i \\sim \\text{Uniform}(0,1)$ 映射到标准正态累积分布函数的逆函数而构建的标准正态随机变量。\n\n您的程序必须：\n- 使用共用的均匀随机数 $U_i$ 和标准正态累积分布函数的逆函数为两个系统生成共用的 $Z_i$，以确保在每个测试用例中，相同的 $Z_i$ 驱动 $X_i$ 和 $Y_i$。\n- 根据 $N$ 个历史的样本均值计算基于 CRN 的估计量 $\\widehat{\\Delta k}_{\\text{eff}}$。\n- 使用从共用 $Z_i$ 推导出的无偏样本协方差公式计算经验协方差 $\\widehat{\\operatorname{Cov}}(X,Y)$。\n- 计算逐历史差值 $D_i = Y_i - X_i$ 的经验方差，记为 $\\widehat{\\operatorname{Var}}(D)$，并通过将 $\\widehat{\\operatorname{Var}}(D)$ 除以 $N$ 来计算估计量 $\\widehat{\\Delta k}_{\\text{eff}}$ 的经验方差 $\\widehat{\\operatorname{Var}}(\\widehat{\\Delta k}_{\\text{eff}})$。\n- 在线性响应模型和共用 $Z_i$ 的条件下，推导并计算由共用裂变源库抽样引起的理论协方差，以及 $D_i$ 和 $\\widehat{\\Delta k}_{\\text{eff}}$ 的理论方差。\n- 以无量纲小数形式报告所有量，不带百分号。\n\n为确保科学真实性，将 $Z_i$ 解释为在基准系统和微扰系统之间复用的裂变源抽样随机性的潜在表示；$\\mu_0$、$\\mu_1$ 代表对 $k_{\\text{eff}}$ 的平均逐历史贡献，而 $\\sigma_0$、$\\sigma_1$ 反映了在固定源模拟中，由于随机粒子历史而产生的随机变化幅度，这些模拟经过重加权以估计 $k_{\\text{eff}}$。\n\n使用以下测试套件，其中每个元组为 $(\\mu_0, \\mu_1, \\sigma_0, \\sigma_1, N, \\text{seed})$:\n- 测试 $1$: $(0.995, 1.000, 0.050, 0.050, 100000, 314159)$\n- 测试 $2$: $(0.980, 0.983, 0.060, 0.040, 80000, 271828)$\n- 边界测试 $3$: $(0.997, 0.9975, 0.000, 0.005, 60000, 161803)$\n\n对于每个测试用例，按顺序输出一个包含以下七个量的列表：$\\widehat{\\Delta k}_{\\text{eff}}$、$\\widehat{\\operatorname{Cov}}(X,Y)$、$\\operatorname{Cov}_{\\text{theory}}(X,Y)$、$\\widehat{\\operatorname{Var}}(D)$、$\\operatorname{Var}_{\\text{theory}}(D)$、$\\widehat{\\operatorname{Var}}(\\widehat{\\Delta k}_{\\text{eff}})$、$\\operatorname{Var}_{\\text{theory}}(\\widehat{\\Delta k}_{\\text{eff}})$。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个内部列表，例如 $[[r_{1,1}, \\dots, r_{1,7}], [r_{2,1}, \\dots, r_{2,7}], [r_{3,1}, \\dots, r_{3,7}]]$，其中每个 $r_{i,j}$ 是一个实数。\n\n此问题不涉及角度单位。所有报告的量均为无量纲。所有答案均以小数形式表示。最终输出格式必须是严格的一行，包含一个外部列表和三个指定的内部列表。",
            "solution": "问题陈述经评估有效。它在科学上基于蒙特卡罗模拟和方差缩减技术的原理，特别是使用共用随机数 (CRN) 来估计核系统中的差异效应。该问题定义明确，提供了一个清晰的数学模型、所有必要的参数以及一组客观的计算和理论任务。线性响应模型是一种标准且有用的简化，适用于教学目的和分析小微扰。该问题是自洽的、一致的，并且存在唯一可验证的解。\n\n核心任务是分析一个基于 CRN 的估计量，用于计算基准系统和微扰系统之间有效增殖因数的变化量 $\\Delta k_{\\text{eff}}$。对 $k_{\\text{eff}}$ 的逐历史贡献被建模为共用随机变量的线性函数。\n\n设基准系统的逐历史贡献为随机变量 $X$，微扰系统的为 $Y$。对于第 $i$ 次历史，它们的实现由下式给出：\n$$X_i = \\mu_0 + \\sigma_0 Z_i$$\n$$Y_i = \\mu_1 + \\sigma_1 Z_i$$\n其中 $i = 1, \\dots, N$。参数 $\\mu_0$ 和 $\\mu_1$ 代表平均逐历史贡献，而 $\\sigma_0$ 和 $\\sigma_1$ 代表这些贡献的标准差。变量 $Z_i$ 是独立同分布 (i.i.d.) 的标准正态随机变量，$Z_i \\sim \\mathcal{N}(0, 1)$。CRN 技术的关键在于，对于每次历史，都使用相同的随机变量 $Z_i$ 来生成 $X_i$ 和 $Y_i$，从而在两次模拟之间引入相关性。这种共用的随机性模拟了在基准计算和微扰计算之间复用裂变源库。$Z_i$ 是通过将标准正态分布的逆累积分布函数 (CDF)（表示为 $\\Phi^{-1}$）应用于一组独立同分布的均匀随机数 $U_i \\sim \\text{Uniform}(0,1)$ 生成的。\n\n有效增殖因数变化量的估计量 $\\widehat{\\Delta k}_{\\text{eff}}$ 是样本均值的差：\n$$\\widehat{\\Delta k}_{\\text{eff}} = \\overline{Y} - \\overline{X} = \\frac{1}{N}\\sum_{i=1}^{N} Y_i - \\frac{1}{N}\\sum_{i=1}^{N} X_i$$\n\n首先，我们根据期望、方差和协方差的性质推导所需的理论量。\n\n**1. 理论协方差：$\\operatorname{Cov}_{\\text{theory}}(X,Y)$**\n逐历史贡献 $X_i$ 和 $Y_i$ 之间的协方差定义为 $\\operatorname{Cov}(X_i, Y_i) = E[(X_i - E[X_i])(Y_i - E[Y_i])]$。由于 $E[Z_i] = 0$，期望为 $E[X_i] = E[\\mu_0 + \\sigma_0 Z_i] = \\mu_0 + \\sigma_0 E[Z_i] = \\mu_0$，同理 $E[Y_i] = \\mu_1$。中心化变量为 $X_i - E[X_i] = \\sigma_0 Z_i$ 和 $Y_i - E[Y_i] = \\sigma_1 Z_i$。因此，协方差为：\n$$\\operatorname{Cov}(X_i, Y_i) = E[(\\sigma_0 Z_i)(\\sigma_1 Z_i)] = \\sigma_0 \\sigma_1 E[Z_i^2]$$\n对于标准正态变量 $Z_i$，其方差为 $\\operatorname{Var}(Z_i) = E[Z_i^2] - (E[Z_i])^2 = 1$。由于 $E[Z_i]=0$，我们有 $E[Z_i^2] = 1$。因此，理论协方差为：\n$$\\operatorname{Cov}_{\\text{theory}}(X,Y) = \\sigma_0 \\sigma_1$$\n\n**2. 差值的理论方差：$\\operatorname{Var}_{\\text{theory}}(D)$**\n设 $D_i$ 为逐历史差值，$D_i = Y_i - X_i$。\n$$D_i = (\\mu_1 + \\sigma_1 Z_i) - (\\mu_0 + \\sigma_0 Z_i) = (\\mu_1 - \\mu_0) + (\\sigma_1 - \\sigma_0) Z_i$$\n$D_i$ 的方差可以直接计算。由于 $\\mu_1 - \\mu_0$ 是一个常数，它不影响方差。\n$$\\operatorname{Var}(D_i) = \\operatorname{Var}((\\mu_1 - \\mu_0) + (\\sigma_1 - \\sigma_0) Z_i) = (\\sigma_1 - \\sigma_0)^2 \\operatorname{Var}(Z_i) = (\\sigma_1 - \\sigma_0)^2$$\n或者，使用协方差的双线性性质：\n$$\\operatorname{Var}(D_i) = \\operatorname{Var}(Y_i - X_i) = \\operatorname{Var}(Y_i) + \\operatorname{Var}(X_i) - 2\\operatorname{Cov}(Y_i, X_i)$$\n由于 $\\operatorname{Var}(X_i) = \\sigma_0^2 \\operatorname{Var}(Z_i) = \\sigma_0^2$ 且 $\\operatorname{Var}(Y_i) = \\sigma_1^2$，我们得到：\n$$\\operatorname{Var}_{\\text{theory}}(D) = \\sigma_1^2 + \\sigma_0^2 - 2\\sigma_0\\sigma_1 = (\\sigma_1 - \\sigma_0)^2$$\n\n**3. 估计量的理论方差：$\\operatorname{Var}_{\\text{theory}}(\\widehat{\\Delta k}_{\\text{eff}})$**\n该估计量可以用差值 $D_i$ 重写：\n$$\\widehat{\\Delta k}_{\\text{eff}} = \\overline{Y} - \\overline{X} = \\frac{1}{N}\\sum_{i=1}^{N} (Y_i - X_i) = \\frac{1}{N}\\sum_{i=1}^{N} D_i = \\overline{D}$$\n该估计量是独立同分布差值 $D_i$ 的样本均值。$N$ 个独立同分布随机变量的样本均值的方差是单个变量的方差除以 $N$。\n$$\\operatorname{Var}_{\\text{theory}}(\\widehat{\\Delta k}_{\\text{eff}}) = \\operatorname{Var}(\\overline{D}) = \\frac{\\operatorname{Var}(D_i)}{N} = \\frac{(\\sigma_1 - \\sigma_0)^2}{N}$$\n这个结果凸显了 CRN 的威力：如果 $\\sigma_1 \\approx \\sigma_0$，估计量的方差会变得非常小，与独立模拟相比，对差异效应的估计效率会高得多。\n\n接下来，我们定义计算大小为 $N$ 的样本的经验估计值的数值步骤。\n\n**1. 样本生成：**\n对于每个测试用例，我们使用带种子的随机数生成器生成 $N$ 个共用的均匀随机数 $U_1, \\dots, U_N$ 以确保可复现性。这些数被转换为标准正态变量 $Z_i = \\Phi^{-1}(U_i)$。然后使用给定的线性模型计算样本 $X_i$ 和 $Y_i$。\n\n**2. 经验估计量：$\\widehat{\\Delta k}_{\\text{eff}}$**\n这直接通过生成的 $X$ 和 $Y$ 样本的样本均值计算得出：$\\widehat{\\Delta k}_{\\text{eff}} = \\text{mean}(Y) - \\text{mean}(X)$。\n\n**3. 经验协方差：$\\widehat{\\operatorname{Cov}}(X,Y)$**\n这使用无偏样本协方差公式计算：\n$$\\widehat{\\operatorname{Cov}}(X,Y) = \\frac{1}{N-1}\\sum_{i=1}^{N} (X_i - \\overline{X})(Y_i - \\overline{Y})$$\n\n**4. 差值的经验方差：$\\widehat{\\operatorname{Var}}(D)$**\n计算出差值样本 $D_i = Y_i - X_i$ 后，计算无偏样本方差：\n$$\\widehat{\\operatorname{Var}}(D) = \\frac{1}{N-1}\\sum_{i=1}^{N} (D_i - \\overline{D})^2$$\n\n**5. 估计量的经验方差：$\\widehat{\\operatorname{Var}}(\\widehat{\\Delta k}_{\\text{eff}})$**\n根据问题中的规定，这通过将差值的样本方差除以 $N$ 得到：\n$$\\widehat{\\operatorname{Var}}(\\widehat{\\Delta k}_{\\text{eff}}) = \\frac{\\widehat{\\operatorname{Var}}(D)}{N}$$\n\n实现将对提供的每个测试用例执行这些计算，生成所需的七个量：$\\widehat{\\Delta k}_{\\text{eff}}$、$\\widehat{\\operatorname{Cov}}(X,Y)$、$\\operatorname{Cov}_{\\text{theory}}(X,Y)$、$\\widehat{\\operatorname{Var}}(D)$、$\\operatorname{Var}_{\\text{theory}}(D)$、$\\widehat{\\operatorname{Var}}(\\widehat{\\Delta k}_{\\text{eff}})$ 和 $\\operatorname{Var}_{\\text{theory}}(\\widehat{\\Delta k}_{\\text{eff}})$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes theoretical and empirical statistics for a CRN-based estimator\n    of a differential effect in a simplified nuclear reactor simulation model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (mu0, mu1, sigma0, sigma1, N, seed)\n        (0.995, 1.000, 0.050, 0.050, 100000, 314159),\n        (0.980, 0.983, 0.060, 0.040, 80000, 271828),\n        (0.997, 0.9975, 0.000, 0.005, 60000, 161803),\n    ]\n\n    results = []\n    for case in test_cases:\n        mu0, mu1, sigma0, sigma1, N, seed = case\n        \n        # --- Sample Generation using Common Random Numbers ---\n        # Initialize a random number generator with a specific seed for reproducibility.\n        rng = np.random.default_rng(seed)\n        # Generate N uniform random numbers in the interval (0, 1).\n        u_samples = rng.uniform(size=N)\n        # Transform uniform samples to standard normal samples using inverse transform sampling.\n        # This is the shared random variate Z_i.\n        z_samples = norm.ppf(u_samples)\n        \n        # Generate per-history contributions for the base (X) and perturbed (Y) systems.\n        x_samples = mu0 + sigma0 * z_samples\n        y_samples = mu1 + sigma1 * z_samples\n        \n        # --- Theoretical Calculations ---\n        # 3. Theoretical covariance between X and Y.\n        cov_theory_xy = sigma0 * sigma1\n        \n        # 5. Theoretical variance of the per-history difference D = Y - X.\n        var_theory_d = (sigma1 - sigma0)**2\n        \n        # 7. Theoretical variance of the estimator for Delta k_eff.\n        var_theory_delta_k = var_theory_d / N\n\n        # --- Empirical Calculations ---\n        # 1. CRN-based estimator for Delta k_eff (difference of sample means).\n        delta_k_eff_hat = np.mean(y_samples) - np.mean(x_samples)\n        \n        # 2. Unbiased sample covariance between X and Y.\n        # np.cov with ddof=1 computes the unbiased estimator using (N-1) in the denominator.\n        cov_hat_xy = np.cov(x_samples, y_samples, ddof=1)[0, 1]\n        \n        # 4. Unbiased sample variance of the per-history difference D.\n        d_samples = y_samples - x_samples\n        var_hat_d = np.var(d_samples, ddof=1)\n        \n        # 6. Empirical variance of the estimator for Delta k_eff.\n        var_hat_delta_k = var_hat_d / N\n        \n        # Compile results for the current test case in the specified order.\n        case_results = [\n            delta_k_eff_hat,\n            cov_hat_xy,\n            cov_theory_xy,\n            var_hat_d,\n            var_theory_d,\n            var_hat_delta_k,\n            var_theory_delta_k\n        ]\n        results.append(case_results)\n\n    # --- Final Output Formatting ---\n    # Construct the output string to match the required format: [[r1,r2,...],[s1,s2,...]]\n    outer_list_str = []\n    for res_list in results:\n        # Convert each list of floats to a comma-separated string \"[f1,f2,...]\"\n        inner_list_str = f\"[{','.join(map(str, res_list))}]\"\n        outer_list_str.append(inner_list_str)\n    \n    # Join the inner list strings into the final output format \"[[...],[...]]\"\n    final_output = f\"[{','.join(outer_list_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}