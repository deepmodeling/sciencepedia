{
    "hands_on_practices": [
        {
            "introduction": "This first practice serves as a vital bridge between foundational theory and real-world application. By deriving the stress and displacement fields in an idealized rod from first principles, you will solidify your understanding of equilibrium, kinematics, and constitutive laws. More importantly, the critical analysis of the model's underlying assumptions  will reveal why such simple models are insufficient for the harsh environment of a reactor core, motivating the need for the more sophisticated analyses that follow.",
            "id": "4252873",
            "problem": "A slender prismatic metallic rod representative of a nuclear reactor core support member has uniform cross-section area $A$, length $L$, and Young's modulus $E$. The rod axis is aligned with the coordinate $x \\in [0,L]$. The end at $x=0$ is fixed, and a static axial tensile load $P$ is applied at $x=L$. Assume small deformations and that inertia is negligible. Derive, from first principles beginning with balance of linear momentum in the axial direction, small-strain kinematics, and a linear elastic constitutive relation for an isotropic homogeneous material, the axial displacement field $u(x)$ and axial stress distribution $\\sigma(x)$ along the rod. Clearly state the boundary conditions you impose. Then enumerate the modeling assumptions used in your derivation and identify which of these are invalidated in a high-temperature irradiation environment typical of a nuclear reactor core (for example, temperatures on the order of $650\\,\\mathrm{K}$ under sustained neutron flux), with brief justification based on materials behavior under such conditions. If a numerical evaluation were performed, axial displacement should be expressed in meters and stress in pascals; however, here you must report an exact symbolic expression. Provide the closed-form expression for the axial displacement field $u(x)$ as your final answer. No rounding is required for the symbolic expression in the final answer.",
            "solution": "The problem statement is first validated to ensure it is scientifically grounded, well-posed, objective, and complete.\n\n### Step 1: Extract Givens\n- **Geometry and Material Properties**: A slender prismatic metallic rod of uniform cross-section area $A$, length $L$, and Young's modulus $E$.\n- **Coordinate System**: The rod axis is aligned with the coordinate $x \\in [0,L]$.\n- **Boundary and Loading Conditions**:\n    - The end at $x=0$ is fixed.\n    - A static axial tensile load $P$ is applied at $x=L$.\n- **Modeling Assumptions (to be used in derivation)**:\n    - Small deformations.\n    - Inertia is negligible (static problem).\n    - Derivation must start from:\n        1. Balance of linear momentum in the axial direction.\n        2. Small-strain kinematics.\n        3. Linear elastic constitutive relation for an isotropic homogeneous material.\n- **Required Outputs**:\n    1. The axial displacement field $u(x)$.\n    2. The axial stress distribution $\\sigma(x)$.\n    3. Stated boundary conditions.\n    4. Enumeration of modeling assumptions.\n    5. Identification and justification of which assumptions are invalidated in a high-temperature ($650\\,\\mathrm{K}$) irradiation environment.\n- **Final Answer Format**: A closed-form expression for the axial displacement field $u(x)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a classic exercise in one-dimensional solid mechanics.\n- **Scientifically Grounded**: The problem is based on fundamental principles of continuum mechanics (momentum balance, kinematics, constitutive laws). The second part of the question, concerning the validity of assumptions in a nuclear reactor environment, is grounded in established principles of materials science and nuclear engineering.\n- **Well-Posed**: The problem is well-posed. The governing differential equation derived from the given principles, along with the two specified boundary conditions (one for displacement at $x=0$ and one for force/stress at $x=L$), is sufficient to determine a unique solution for the displacement field $u(x)$.\n- **Objective**: The problem is stated using precise, objective, and unambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. The derivation and analysis will now proceed.\n\n### Derivation from First Principles\nThe derivation proceeds by establishing the governing differential equation and solving it with the appropriate boundary conditions.\n\n**1. Balance of Linear Momentum**\nConsider a differential element of the rod of infinitesimal length $dx$, located between coordinates $x$ and $x+dx$. Let $N(x)$ be the internal axial force at position $x$. For the element to be in static equilibrium, the sum of axial forces must be zero. The force exerted on the left face of the element (at $x$) by the material to its left is $N(x)$. The force exerted on the right face of the element (at $x+dx$) by the material to its right is $-N(x+dx)$.\nSince inertia is negligible and there are no body forces specified, the balance of linear momentum requires:\n$$N(x+dx) - N(x) = 0$$\nDividing by $dx$ and taking the limit as $dx \\to 0$ gives the differential equation for equilibrium:\n$$\\frac{dN}{dx} = 0$$\nThis equation states that the internal axial force $N$ is constant along the length of the rod.\n\n**2. Kinematics and Constitutive Relation**\n- **Small-Strain Kinematics**: For small deformations, the axial strain $\\epsilon(x)$ is defined as the gradient of the axial displacement field $u(x)$:\n$$\\epsilon(x) = \\frac{du}{dx}$$\n- **Linear Elastic Constitutive Relation**: The material is assumed to be linear elastic, isotropic, and homogeneous. The axial stress $\\sigma(x)$ is related to the axial strain $\\epsilon(x)$ by Hooke's Law, where $E$ is the Young's modulus:\n$$\\sigma(x) = E \\epsilon(x)$$\nThe internal force $N(x)$ is the integral of the stress over the cross-sectional area $A$. Assuming the stress is uniform across the section (a consequence of the slender rod assumption via Saint-Venant's principle), we have:\n$$N(x) = \\sigma(x) A$$\nCombining these relations, we can express the internal force in terms of the displacement field:\n$$N(x) = A \\sigma(x) = A E \\epsilon(x) = A E \\frac{du}{dx}$$\n\n**3. Governing Equation and Boundary Conditions**\nSubstituting the expression for $N(x)$ into the equilibrium equation $\\frac{dN}{dx}=0$:\n$$\\frac{d}{dx}\\left(A E \\frac{du}{dx}\\right) = 0$$\nSince $A$ and $E$ are given as uniform constants, this simplifies to the governing ordinary differential equation for the displacement $u(x)$:\n$$A E \\frac{d^2u}{dx^2} = 0 \\implies \\frac{d^2u}{dx^2} = 0$$\nThe problem specifies the boundary conditions:\n- **At $x=0$**: The rod is fixed, so there is no displacement.\n$$u(0) = 0$$\n- **At $x=L$**: A tensile load $P$ is applied. This means the internal force $N$ at this location must equal $P$.\n$$N(L) = P$$\nUsing the relation $N(x) = A E \\frac{du}{dx}$, this boundary condition becomes:\n$$A E \\left.\\frac{du}{dx}\\right|_{x=L} = P \\implies \\left.\\frac{du}{dx}\\right|_{x=L} = \\frac{P}{A E}$$\n\n**4. Solution of the Governing Equation**\nWe solve $\\frac{d^2u}{dx^2} = 0$ by integrating twice with respect to $x$:\n$$\\frac{du}{dx} = C_1$$\n$$u(x) = C_1 x + C_2$$\nwhere $C_1$ and $C_2$ are constants of integration.\nApplying the boundary condition at $x=0$:\n$$u(0) = C_1(0) + C_2 = 0 \\implies C_2 = 0$$\nThe solution simplifies to $u(x) = C_1 x$.\nNow, apply the boundary condition at $x=L$. First, we find the derivative of the displacement:\n$$\\frac{du}{dx} = C_1$$\nApplying the condition $\\left.\\frac{du}{dx}\\right|_{x=L} = \\frac{P}{A E}$:\n$$C_1 = \\frac{P}{A E}$$\nSubstituting the constants back into the expressions for $u(x)$ and $\\sigma(x)$:\n- **Axial Displacement Field**:\n$$u(x) = \\frac{P}{A E} x$$\n- **Axial Stress Distribution**:\n$$\\sigma(x) = E \\epsilon(x) = E \\frac{du}{dx} = E \\left(\\frac{P}{A E}\\right) = \\frac{P}{A}$$\nThe stress is constant along the rod, which is consistent with the equilibrium equation $\\frac{dN}{dx}=0$.\n\n### Modeling Assumptions and Critique\nThe derivation relies on several idealizing assumptions.\n**Enumeration of Modeling Assumptions:**\n1.  **Homogeneous Material**: The Young's modulus $E$ is constant throughout the volume of the rod.\n2.  **Isotropic Material**: The mechanical properties are identical in all directions.\n3.  **Linear Elasticity**: The material obeys Hooke's Law ($\\sigma = E \\epsilon$), and deformation is fully recoverable upon load removal. No plastic deformation or time-dependent effects are considered.\n4.  **Small Deformations (or Small Strains)**: The strain is small ($\\epsilon \\ll 1$), allowing the use of the simplified kinematic relation $\\epsilon = du/dx$ and neglecting changes in the rod's geometry during deformation.\n5.  **Prismatic Bar and 1D Stress State**: The rod has a constant cross-section $A$, and the stress state is assumed to be purely one-dimensional and uniform across any given cross-section.\n6.  **Static Loading**: The load $P$ is applied slowly such that dynamic effects (waves, vibrations) are negligible.\n7.  **Isothermal Conditions**: The derivation assumes no temperature change. Thermal expansion and temperature dependence of material properties (like $E$) are ignored.\n\n**Invalidated Assumptions in a High-Temperature Irradiation Environment:**\nA nuclear reactor core environment, characterized by high temperature (e.g., $650\\,\\mathrm{K}$ or $377\\,\\mathrm{^\\circ C}$) and sustained neutron flux, invalidates several key assumptions.\n\n1.  **Linear Elasticity (Strongly Invalidated)**: At elevated temperatures, metallic alloys exhibit time-dependent, non-recoverable deformation under constant stress, a phenomenon known as **thermal creep**. The presence of neutron flux further causes **irradiation creep**. The relationship between stress and strain is no longer a simple constant of proportionality but becomes a complex function of stress, temperature, time, and neutron flux. Thus, deformation is not purely elastic.\n\n2.  **Isothermal Conditions / Temperature-Independent Properties (Strongly Invalidated)**:\n    - **Thermal Expansion**: A temperature change from ambient to $650\\,\\mathrm{K}$ would cause significant thermal expansion ($\\epsilon_{th} = \\alpha \\Delta T$, where $\\alpha$ is the coefficient of thermal expansion). This strain component must be added to the mechanical strain, altering the overall displacement and potentially inducing stress if the expansion is constrained.\n    - **Temperature-Dependent Modulus**: The Young's modulus $E$ of metals is not constant but decreases significantly as temperature increases. For a typical steel, $E$ can decrease by $15-20\\%$ between room temperature and $650\\,\\mathrm{K}$. The use of a constant, room-temperature value for $E$ would lead to a substantial underestimation of the actual strain and displacement.\n\n3.  **Homogeneous Material (Partially Invalidated)**: Sustained neutron irradiation creates defects in the material's crystal lattice (e.g., vacancies, interstitials, dislocation loops, voids). The density of this damage is often dependent on the local neutron flux and temperature, which may not be uniform along the component's length. This leads to spatial variations in mechanical properties like strength and ductility, meaning the material is no longer perfectly homogeneous. This effect is known as irradiation hardening and embrittlement.\n\n4.  **Small Deformations (Potentially Invalidated)**: While the elastic deformation may be small, the accumulated strain due to creep over a long operational lifetime (months or years) can become significant. This cumulative strain can be large enough to violate the small-strain assumption, particularly in components designed with tight tolerances.\n\nIn summary, the simple linear elastic, isothermal model is inadequate for accurately predicting the behavior of a structural member in a nuclear reactor core. A realistic analysis would require advanced viscoplastic constitutive models that account for creep, irradiation effects, thermal expansion, and the temperature dependence of material properties.",
            "answer": "$$\\boxed{\\frac{P x}{A E}}$$"
        },
        {
            "introduction": "Building on the fundamentals, we now incorporate the critical effects of temperature, a dominant factor in reactor structural mechanics. This exercise challenges you to calculate the compressive hoop stress that develops in a constrained fuel cladding segment due to a uniform temperature increase. The problem emphasizes the importance of accounting for temperature-dependent material properties , a realistic feature that significantly influences stress predictions and is crucial for accurate component analysis.",
            "id": "4252827",
            "problem": "A thin ring segment of nuclear fuel cladding made of an isotropic zirconium alloy is modeled under small-strain, linear thermoelasticity. The ring is initially at temperature $T_{0}$ and subjected to a uniform temperature rise $\\Delta T$, reaching $T_{f} = T_{0} + \\Delta T$. The ring is perfectly constrained in the circumferential direction so that the net circumferential (hoop) total strain is zero throughout the heating. The radial stress is negligible due to the thin-wall assumption, and axial constraints are absent; treat the state as plane stress. No plasticity, creep, irradiation growth, or phase changes occur, and inertia is negligible.\n\nMaterial properties vary with temperature according to\n$$\nE(T) = E_{0}\\left[1 - \\beta \\left(T - T_{0}\\right)\\right], \\quad \\alpha(T) = \\alpha_{0} + \\alpha_{1}\\left(T - T_{0}\\right),\n$$\nwhere $E(T)$ is Young’s modulus, $\\alpha(T)$ is the coefficient of linear thermal expansion, and $E_{0}$, $\\beta$, $\\alpha_{0}$, and $\\alpha_{1}$ are constants. Take\n$$\nE_{0} = 1.3 \\times 10^{11} \\ \\text{Pa}, \\quad \\beta = 2.5 \\times 10^{-4} \\ \\text{K}^{-1}, \\quad \\alpha_{0} = 5.0 \\times 10^{-6} \\ \\text{K}^{-1}, \\quad \\alpha_{1} = 1.1 \\times 10^{-8} \\ \\text{K}^{-2},\n$$\nand\n$$\nT_{0} = 560 \\ \\text{K}, \\quad \\Delta T = 140 \\ \\text{K}.\n$$\n\nStarting from the fundamental kinematic compatibility, equilibrium, and constitutive relations for isotropic linear thermoelasticity under plane stress, derive the hoop stress at $T_{f}$ under the circumferential constraint. Use only the provided temperature dependence of $E(T)$ and $\\alpha(T)$ and do not assume temperature-independent properties. Express the final hoop stress in megapascal (MPa) and round your answer to four significant figures.\n\nAdditionally, in your derivation, identify how the temperature dependence of $E(T)$ and $\\alpha(T)$ enters the stress prediction and qualitatively discuss the sensitivity of the hoop stress to these temperature-dependent properties without invoking any empirical shortcut formulas.",
            "solution": "The thin ring segment is subject to a uniform temperature rise $\\Delta T$ with the circumferential direction fully constrained, so the total circumferential strain is zero at all temperatures. Under small-strain linear thermoelasticity for an isotropic solid in plane stress, the circumferential strain $\\epsilon_{\\theta}$ at temperature $T$ is the sum of mechanical and thermal components,\n$$\n\\epsilon_{\\theta}(T) = \\epsilon_{\\theta}^{\\text{mech}}(T) + \\epsilon_{\\theta}^{\\text{th}}(T).\n$$\nThe mechanical strain under plane stress with negligible radial stress (thin wall) and no axial stress is\n$$\n\\epsilon_{\\theta}^{\\text{mech}}(T) = \\frac{\\sigma_{\\theta}(T)}{E(T)},\n$$\nwhere $\\sigma_{\\theta}(T)$ is the hoop stress and $E(T)$ is Young’s modulus at temperature $T$. The free thermal strain accumulated from $T_{0}$ to $T$ is\n$$\n\\epsilon_{\\theta}^{\\text{th}}(T) = \\int_{T_{0}}^{T} \\alpha(\\tau) \\, d\\tau,\n$$\nwhere $\\alpha(T)$ is the temperature-dependent coefficient of linear thermal expansion. The circumferential constraint imposes\n$$\n\\epsilon_{\\theta}(T) = 0 \\quad \\text{for all } T \\in [T_{0}, \\, T_{f}],\n$$\nhence, at the final temperature $T_{f} = T_{0} + \\Delta T$,\n$$\n0 = \\frac{\\sigma_{\\theta}(T_{f})}{E(T_{f})} + \\int_{T_{0}}^{T_{f}} \\alpha(\\tau) \\, d\\tau.\n$$\nSolving for the hoop stress gives the exact closed-form expression under the stated assumptions:\n$$\n\\sigma_{\\theta}(T_{f}) = - E(T_{f}) \\int_{T_{0}}^{T_{f}} \\alpha(\\tau) \\, d\\tau.\n$$\n\nWe now substitute the given temperature dependencies. With\n$$\nE(T) = E_{0}\\left[1 - \\beta \\left(T - T_{0}\\right)\\right], \\quad \\alpha(T) = \\alpha_{0} + \\alpha_{1}\\left(T - T_{0}\\right),\n$$\nwe obtain\n$$\nE(T_{f}) = E_{0}\\left[1 - \\beta \\Delta T\\right],\n$$\nand\n$$\n\\int_{T_{0}}^{T_{f}} \\alpha(\\tau) \\, d\\tau = \\int_{0}^{\\Delta T} \\left(\\alpha_{0} + \\alpha_{1} \\theta \\right) d\\theta = \\alpha_{0} \\Delta T + \\frac{\\alpha_{1}}{2} \\Delta T^{2},\n$$\nafter the change of variable $\\theta = \\tau - T_{0}$.\n\nTherefore,\n$$\n\\sigma_{\\theta}(T_{f}) = - E_{0}\\left[1 - \\beta \\Delta T\\right] \\left( \\alpha_{0} \\Delta T + \\frac{\\alpha_{1}}{2} \\Delta T^{2} \\right).\n$$\n\nWe now compute the numerical value using the provided constants. First, evaluate the modulus at $T_{f}$:\n$$\n\\beta \\Delta T = \\left(2.5 \\times 10^{-4}\\right)\\times 140 = 0.035, \\quad E(T_{f}) = \\left(1.3 \\times 10^{11}\\right)\\times \\left(1 - 0.035\\right) = \\left(1.3 \\times 10^{11}\\right)\\times 0.965 = 1.2545 \\times 10^{11} \\ \\text{Pa}.\n$$\nNext, evaluate the accumulated free thermal strain:\n$$\n\\alpha_{0} \\Delta T = \\left(5.0 \\times 10^{-6}\\right)\\times 140 = 7.0 \\times 10^{-4},\n$$\n$$\n\\frac{\\alpha_{1}}{2} \\Delta T^{2} = \\left(\\frac{1.1 \\times 10^{-8}}{2}\\right)\\times 140^{2} = \\left(5.5 \\times 10^{-9}\\right)\\times 19600 = 1.078 \\times 10^{-4},\n$$\n$$\n\\int_{T_{0}}^{T_{f}} \\alpha(\\tau) \\, d\\tau = 7.0 \\times 10^{-4} + 1.078 \\times 10^{-4} = 8.078 \\times 10^{-4}.\n$$\nThus the hoop stress is\n$$\n\\sigma_{\\theta}(T_{f}) = -\\left(1.2545 \\times 10^{11}\\right)\\times \\left(8.078 \\times 10^{-4}\\right) \\ \\text{Pa} = -1.0133851 \\times 10^{8} \\ \\text{Pa}.\n$$\nConverting to megapascal (since $1 \\ \\text{MPa} = 10^{6} \\ \\text{Pa}$) and rounding to four significant figures,\n$$\n\\sigma_{\\theta}(T_{f}) = -101.3 \\ \\text{MPa}.\n$$\n\nSensitivity discussion: The derived expression\n$$\n\\sigma_{\\theta}(T_{f}) = - E_{0}\\left(1 - \\beta \\Delta T\\right)\\left(\\alpha_{0} \\Delta T + \\frac{\\alpha_{1}}{2} \\Delta T^{2}\\right)\n$$\nshows that the temperature dependence of $E(T)$ enters multiplicatively through $\\left(1 - \\beta \\Delta T\\right)$, reducing the stress magnitude as temperature rises (since $\\beta > 0$ lowers the modulus). The temperature dependence of $\\alpha(T)$ enters through the accumulated thermal strain $\\alpha_{0} \\Delta T + \\left(\\alpha_{1}/2\\right)\\Delta T^{2}$, increasing the stress magnitude with $\\Delta T$; the quadratic term controlled by $\\alpha_{1}$ makes the sensitivity grow with $\\Delta T$. The parametric sensitivities at fixed $\\Delta T$ are\n$$\n\\frac{\\partial \\sigma_{\\theta}}{\\partial \\beta} = E_{0} \\Delta T \\left(\\alpha_{0} \\Delta T + \\frac{\\alpha_{1}}{2} \\Delta T^{2}\\right) > 0,\n$$\nindicating that increasing $\\beta$ (stronger modulus softening with temperature) reduces the compressive stress magnitude (makes $\\sigma_{\\theta}$ less negative), and\n$$\n\\frac{\\partial \\sigma_{\\theta}}{\\partial \\alpha_{1}} = - E_{0}\\left(1 - \\beta \\Delta T\\right)\\frac{\\Delta T^{2}}{2}  0,\n$$\nindicating that increasing $\\alpha_{1}$ increases the compressive stress magnitude (makes $\\sigma_{\\theta}$ more negative). These relations articulate how the temperature-dependent properties govern the constrained thermal stress through their distinct roles in stiffness and free expansion.",
            "answer": "$$\\boxed{-101.3}$$"
        },
        {
            "introduction": "Our final practice moves into the realm of non-linear mechanics, a necessity for capturing the full behavior of metallic components under operational and accident conditions. You will implement the return-mapping algorithm for a $J_2$ plasticity model, a cornerstone of modern computational solid mechanics. Mastering this algorithm  provides a direct, hands-on understanding of how software simulates permanent deformation, a key phenomenon in assessing the structural integrity and safety margins of reactor components.",
            "id": "4252882",
            "problem": "Consider a thin-walled nuclear fuel cladding segment subjected to combined hoop and axial loading under small strains. The cladding material is modeled as an isotropic elastoplastic solid obeying the von Mises (second invariant of deviatoric stress (J2)) yield criterion with linear isotropic hardening. Assume the loading is axisymmetric with principal strain components $\\varepsilon_{\\theta}$ (hoop), $\\varepsilon_{z}$ (axial), and $\\varepsilon_{r}$ (radial), and that shear strains are zero. The objective is to derive and implement a return-mapping algorithm for this J2 plasticity model that updates the stress state and the equivalent plastic strain given a total strain state.\n\nDerive the algorithm starting from the following foundational laws and definitions:\n- Linear isotropic elasticity (Hooke's law) in three dimensions: the stress tensor $\\boldsymbol{\\sigma}$ relates to the strain tensor $\\boldsymbol{\\varepsilon}$ through Lamé parameters $\\lambda$ and $G$,\n$$\n\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\mathbf{I} + 2 G \\, \\boldsymbol{\\varepsilon}^{\\mathrm{dev}},\n$$\nwhere $G = \\dfrac{E}{2(1+\\nu)}$, $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$, $E$ is the Young's modulus, $\\nu$ is the Poisson's ratio, $\\mathbf{I}$ is the identity, and $\\boldsymbol{\\varepsilon}^{\\mathrm{dev}} = \\boldsymbol{\\varepsilon} - \\dfrac{1}{3} \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I}$ is the deviatoric strain.\n- The deviatoric stress $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\dfrac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma}) \\mathbf{I}$ and hydrostatic pressure $p = \\dfrac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma})$.\n- The von Mises equivalent stress,\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{3 J_2} = \\sqrt{\\dfrac{3}{2} \\, \\boldsymbol{s}:\\boldsymbol{s}}.\n$$\n- The yield function with linear isotropic hardening,\n$$\nf(\\boldsymbol{\\sigma}, \\alpha) = \\sigma_{\\mathrm{eq}} - \\sigma_{y0} - H \\alpha,\n$$\nwhere $\\sigma_{y0}$ is the initial yield stress, $H$ is the hardening modulus, and $\\alpha$ is the accumulated equivalent plastic strain.\n- Associative flow rule and isochoric plasticity (no plastic volumetric strain), with plastic strain increment defined by\n$$\n\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} = \\mathrm{d}\\lambda \\, \\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\mathrm{d}\\lambda \\, \\dfrac{3}{2} \\, \\dfrac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|},\n$$\nand equivalent plastic strain increment\n$$\n\\mathrm{d}\\alpha = \\sqrt{\\dfrac{2}{3}} \\, \\mathrm{d}\\lambda.\n$$\n\nUse a strain-driven elastoplastic integration over a single increment where the trial elastic predictor is formed by Hooke's law from the total strain, and if yielding occurs, apply a radial return to the yield surface in stress space. Show that introducing the consistency parameter\n$$\n\\Delta \\gamma = \\sqrt{\\dfrac{3}{2}} \\, \\Delta \\lambda\n$$\nallows radial return to be expressed by\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{corr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3 G \\, \\Delta \\gamma, \\quad \\alpha_{n+1} = \\alpha_n + \\dfrac{2}{3} \\, \\Delta \\gamma,\n$$\nand derive the closed-form expression for the plastic correction\n$$\n\\Delta \\gamma = \\dfrac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0} - H \\alpha_n}{3 G + \\dfrac{2}{3} H},\n$$\nwith the corrected deviatoric stress\n$$\n\\boldsymbol{s}^{\\mathrm{corr}} = \\left(1 - \\dfrac{3 G \\, \\Delta \\gamma}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}}\\right) \\boldsymbol{s}^{\\mathrm{tr}},\n$$\nand corrected Cauchy stress\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{corr}} = \\boldsymbol{s}^{\\mathrm{corr}} + p^{\\mathrm{tr}} \\mathbf{I},\n$$\nnoting that the hydrostatic part remains unchanged because J2 plasticity is isochoric.\n\nYour program must implement this return-mapping algorithm for axisymmetric principal strains $(\\varepsilon_{\\theta}, \\varepsilon_{z}, \\varepsilon_{r})$ with zero shear. For each test case, compute:\n- Updated principal stresses $(\\sigma_{\\theta}, \\sigma_{z}, \\sigma_{r})$ in megapascals (MPa),\n- Updated equivalent plastic strain $\\alpha_{n+1}$ (dimensionless),\n- A boolean flag indicating plastic correction occurrence.\n\nPhysical units and output requirements:\n- Express all stresses in MPa, rounded to three decimal places.\n- Express $\\alpha_{n+1}$ as a float rounded to six decimal places.\n- Angles are not used in this problem.\n- There are no percentages in the output.\n\nTest suite:\nUse the following five test cases, each specified by $(E, \\nu, \\sigma_{y0}, H, \\alpha_n, \\varepsilon_{\\theta}, \\varepsilon_{z}, \\varepsilon_{r})$, with $E$ and $\\sigma_{y0}$ and $H$ in MPa, strains dimensionless:\n1. $(100000, 0.30, 400, 1000, 0.0, 0.0010, 0.0002, 0.0000)$\n2. $(100000, 0.30, 400, 1000, 0.0, 0.0100, 0.0070, 0.0000)$\n3. $(100000, 0.30, 400, 1000, 0.0, 0.0060, 0.0040, 0.0000)$\n4. $(100000, 0.30, 400, 1000, 0.0, 0.0080, -0.0020, 0.0000)$\n5. $(100000, 0.30, 400, 1000, 0.2, 0.0100, 0.0070, 0.0000)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list of the form $[\\sigma_{\\theta}, \\sigma_{z}, \\sigma_{r}, \\alpha_{n+1}, \\mathrm{plastic}]$. For example, the output format must be like\n$[[\\dots],[\\dots],[\\dots],[\\dots],[\\dots]]$\nwith each numerical entry formatted to the specified precision.",
            "solution": "The problem requires the derivation and implementation of a specific strain-driven return-mapping algorithm for a $J_2$ plasticity model with linear isotropic hardening. The derivation proceeds in three main steps: the elastic predictor, the yield check, and the plastic corrector.\n\n### 1. Elastic Predictor (Trial State)\n\nFirst, we assume the entire strain increment is elastic. The state at the end of the increment is denoted by subscript $n+1$, and the state at the beginning by $n$. Given the total strain $\\boldsymbol{\\varepsilon}_{n+1}$, we compute a \"trial\" stress state by assuming no additional plastic strain has occurred ($\\Delta\\boldsymbol{\\varepsilon}^p = \\mathbf{0}$).\n\nThe stress-strain relationship is decomposed into volumetric and deviatoric parts.\n-   The trial hydrostatic pressure $p^{\\text{tr}}$ is related to the volumetric strain:\n    $$p^{\\text{tr}} = K \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}_{n+1})$$\n    where $K = E / (3(1-2\\nu))$ is the bulk modulus.\n-   The trial deviatoric stress $\\boldsymbol{s}^{\\text{tr}}$ is related to the deviatoric strain:\n    $$ \\boldsymbol{s}^{\\text{tr}} = 2 G \\, \\boldsymbol{\\varepsilon}_{n+1}^{\\text{dev}} $$\n    where $G = E / (2(1+\\nu))$ is the shear modulus and $\\boldsymbol{\\varepsilon}_{n+1}^{\\text{dev}} = \\boldsymbol{\\varepsilon}_{n+1} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\varepsilon}_{n+1})\\mathbf{I}$.\n\nThe full trial stress tensor is $\\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{s}^{\\text{tr}} + p^{\\text{tr}}\\mathbf{I}$.\n\n### 2. Yield Check\n\nNext, we check if this trial stress state violates the yield condition. The von Mises equivalent stress for the trial state is calculated:\n$$ \\sigma_{\\text{eq}}^{\\text{tr}} = \\sqrt{\\frac{3}{2} \\boldsymbol{s}^{\\text{tr}} : \\boldsymbol{s}^{\\text{tr}}} $$\nThe current yield strength is a function of the accumulated plastic strain at the beginning of the step, $\\alpha_n$:\n$$ \\sigma_y(\\alpha_n) = \\sigma_{y0} + H \\alpha_n $$\nThe yield function is then evaluated:\n$$ f(\\boldsymbol{\\sigma}^{\\text{tr}}, \\alpha_n) = \\sigma_{\\text{eq}}^{\\text{tr}} - \\sigma_y(\\alpha_n) $$\n-   If $f \\le 0$, the assumption was correct. The step is purely elastic. The final state is the trial state: $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}}$ and $\\alpha_{n+1} = \\alpha_n$.\n-   If $f > 0$, the trial stress is outside the yield surface, which is inadmissible. A plastic correction is necessary.\n\n### 3. Plastic Corrector (Return Mapping)\n\nThe goal is to find the corrected stress $\\boldsymbol{\\sigma}_{n+1}$ that lies on the updated yield surface. The basis is the additive decomposition of strain rate and the flow rule. The integrated stress update is:\n$$ \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}^p $$\nSince J2 plasticity is isochoric ($\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = 0$), the hydrostatic pressure is unaffected: $p_{n+1} = p^{\\text{tr}}$. The correction applies only to the deviatoric stress:\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{tr}} - 2 G \\Delta\\boldsymbol{\\varepsilon}^p $$\nUsing the associative flow rule provided, $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\frac{3}{2} \\frac{\\boldsymbol{s}_{n+1}}{\\|\\boldsymbol{s}_{n+1}\\|}$, we get:\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{tr}} - 3 G \\Delta\\lambda \\frac{\\boldsymbol{s}_{n+1}}{\\|\\boldsymbol{s}_{n+1}\\|} $$\nThis equation shows that $\\boldsymbol{s}_{n+1}$ must be collinear with $\\boldsymbol{s}^{\\text{tr}}$, which is the principle of \"radial return\". Taking the norm and relating it to the equivalent stress ($\\sigma_{\\text{eq}} = \\sqrt{3/2} \\|\\boldsymbol{s}\\|$), we find that the unit vectors are the same. We can write this relationship as:\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{tr}} - 3G \\Delta\\gamma \\frac{\\boldsymbol{s}^{\\text{tr}}}{\\sigma_{\\text{eq}}^{\\text{tr}}} $$\nwhere the consistency parameter $\\Delta\\gamma = \\Delta\\lambda \\sqrt{3/2}$ has been introduced. Taking the equivalent stress of this equation yields:\n$$ \\sigma_{\\text{eq}, n+1} = \\sigma_{\\text{eq}}^{\\text{tr}} - 3 G \\Delta\\gamma $$\nThis is the corrected equivalent stress, $\\sigma_{\\text{eq}}^{\\text{corr}}$. The corrected deviatoric stress is then:\n$$ \\boldsymbol{s}_{n+1} = \\left(1 - \\frac{3 G \\Delta\\gamma}{\\sigma_{\\text{eq}}^{\\text{tr}}}\\right) \\boldsymbol{s}^{\\text{tr}} $$\nThis is the requested expression for $\\boldsymbol{s}^{\\text{corr}}$.\n\nTo find $\\Delta\\gamma$, we enforce the consistency condition: the final state $(\\boldsymbol{\\sigma}_{n+1}, \\alpha_{n+1})$ must be on the yield surface.\n$$ \\sigma_{\\text{eq}, n+1} = \\sigma_{y0} + H \\alpha_{n+1} $$\nThe update for the accumulated plastic strain $\\alpha$ is derived from the problem's definitions: $\\mathrm{d}\\alpha = \\sqrt{2/3} \\mathrm{d}\\lambda$ and $\\Delta\\gamma = \\sqrt{3/2} \\Delta\\lambda$. Combining these gives $\\Delta\\alpha = \\Delta\\lambda \\sqrt{2/3} = (\\Delta\\gamma \\sqrt{2/3}) \\sqrt{2/3} = \\frac{2}{3} \\Delta\\gamma$. So:\n$$ \\alpha_{n+1} = \\alpha_n + \\frac{2}{3} \\Delta\\gamma $$\nSubstituting the expressions for $\\sigma_{\\text{eq}, n+1}$ and $\\alpha_{n+1}$ into the consistency condition:\n$$ \\sigma_{\\text{eq}}^{\\text{tr}} - 3 G \\Delta\\gamma = \\sigma_{y0} + H \\left( \\alpha_n + \\frac{2}{3} \\Delta\\gamma \\right) $$\nSolving for $\\Delta\\gamma$:\n$$ \\sigma_{\\text{eq}}^{\\text{tr}} - (\\sigma_{y0} + H \\alpha_n) = 3 G \\Delta\\gamma + \\frac{2}{3} H \\Delta\\gamma = \\Delta\\gamma \\left( 3G + \\frac{2}{3}H \\right) $$\nThis yields the final closed-form expression for the plastic correction parameter:\n$$ \\Delta\\gamma = \\frac{\\sigma_{\\text{eq}}^{\\text{tr}} - \\sigma_{y0} - H \\alpha_n}{3G + \\frac{2}{3}H} $$\nThe final Cauchy stress is obtained by combining the corrected deviatoric part with the unchanged hydrostatic part:\n$$ \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{s}_{n+1} + p^{\\text{tr}}\\mathbf{I} $$\nThis completes the derivation of the algorithm to be implemented.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the updated stress state and equivalent plastic strain\n    for several test cases using a J2 plasticity return-mapping algorithm.\n    \"\"\"\n\n    # Test cases: (E, nu, sigma_y0, H, alpha_n, eps_theta, eps_z, eps_r)\n    # Stresses are in MPa, strains are dimensionless.\n    test_cases = [\n        (100000, 0.30, 400, 1000, 0.0, 0.0010, 0.0002, 0.0000),\n        (100000, 0.30, 400, 1000, 0.0, 0.0100, 0.0070, 0.0000),\n        (100000, 0.30, 400, 1000, 0.0, 0.0060, 0.0040, 0.0000),\n        (100000, 0.30, 400, 1000, 0.0, 0.0080, -0.0020, 0.0000),\n        (100000, 0.30, 400, 1000, 0.2, 0.0100, 0.0070, 0.0000)\n    ]\n\n    results = []\n    for case in test_cases:\n        result = return_mapping_j2(case)\n        results.append(result)\n\n    # The final print statement must produce the exact specified format.\n    # The str() of a list automatically provides the square brackets.\n    # No spaces after commas for compact representation.\n    output_str = \"[\" + \",\".join(map(str, results)) + \"]\"\n    # Python's default str() for lists includes spaces, so we build it manually.\n    print(output_str.replace(\" \", \"\"))\n\n\ndef return_mapping_j2(case):\n    \"\"\"\n    Implements the return-mapping algorithm for J2 plasticity with linear isotropic hardening.\n    Args:\n        case (tuple): A tuple containing material properties and strain state.\n                      (E, nu, sigma_y0, H, alpha_n, eps_theta, eps_z, eps_r)\n    Returns:\n        list: A list containing [sigma_theta, sigma_z, sigma_r, alpha_n+1, plastic_flag]\n    \"\"\"\n    E, nu, sigma_y0, H, alpha_n, eps_theta, eps_z, eps_r = case\n\n    # 1. Calculate elastic material constants\n    G = E / (2.0 * (1.0 + nu))  # Shear modulus\n    K = E / (3.0 * (1.0 - 2.0 * nu))  # Bulk modulus\n\n    # 2. Elastic Predictor Step\n    # Strain vector in (r, theta, z) order for internal consistency\n    strains = np.array([eps_r, eps_theta, eps_z])\n\n    # Volumetric and deviatoric strain decomposition\n    tr_eps = np.sum(strains)\n    eps_dev = strains - (1.0/3.0) * tr_eps\n\n    # Trial deviatoric stress\n    s_tr = 2.0 * G * eps_dev\n\n    # Trial equivalent stress\n    # sigma_eq^2 = (3/2) * s:s, where s:s = sum(s_i^2) for principal stresses\n    sigma_eq_tr = np.sqrt(1.5 * np.dot(s_tr, s_tr))\n\n    # 3. Yield Check\n    # Current yield stress\n    sigma_y = sigma_y0 + H * alpha_n\n    \n    # Yield function value\n    f = sigma_eq_tr - sigma_y\n\n    plastic_flag = False\n    if f = 1e-9: # Add a small tolerance for floating point comparison\n        # Elastic step\n        alpha_new = alpha_n\n        s_new = s_tr\n    else:\n        # Plastic step: corrector\n        plastic_flag = True\n\n        # Calculate consistency parameter (plastic multiplier) based on derived formula\n        denominator = 3.0 * G + (2.0/3.0) * H\n        \n        delta_gamma = f / denominator\n\n        # Update accumulated plastic strain\n        alpha_new = alpha_n + (2.0/3.0) * delta_gamma\n        \n        # Radial return: correct the deviatoric stress\n        # sigma_eq_tr cannot be zero if f > 0 and sigma_y is positive.\n        correction_factor = 1.0 - (3.0 * G * delta_gamma) / sigma_eq_tr\n        s_new = s_tr * correction_factor\n\n    # 4. Final Stress State\n    # Hydrostatic pressure is unchanged from the trial state\n    p_new = K * tr_eps\n    \n    # Final Cauchy stress tensor components (principal stresses)\n    # The order is (sigma_r, sigma_theta, sigma_z)\n    final_stresses = s_new + p_new\n\n    # 5. Format Output\n    # The required output order is (sigma_theta, sigma_z, sigma_r)\n    sigma_theta_out = round(final_stresses[1], 3)\n    sigma_z_out = round(final_stresses[2], 3)\n    sigma_r_out = round(final_stresses[0], 3)\n    alpha_new_out = round(alpha_new, 6)\n\n    # Python's default str(bool) is 'True' or 'False' with a capital letter.\n    # The example output is not shown, but lowercase is common in JSON-like formats.\n    # Let's stick to the Python default.\n    return [sigma_theta_out, sigma_z_out, sigma_r_out, alpha_new_out, plastic_flag]\n\n# This block is for direct execution, but in the target environment, only solve() is called.\nif __name__ == \"__main__\":\n    import sys\n    from io import StringIO\n    \n    # Capture the output of solve() to post-process it for the required format.\n    old_stdout = sys.stdout\n    sys.stdout = mystdout = StringIO()\n    \n    solve()\n    \n    sys.stdout = old_stdout\n    output = mystdout.getvalue().strip()\n    \n    # Python's default printing for lists includes spaces, e.g., \"[1, 2, 3]\".\n    # The problem description is ambiguous. \"[[\\dots],[\\dots]]\" suggests no spaces.\n    # Let's manually format to be safe.\n    import json\n    parsed_output = json.loads(output)\n    # The python code was already modified to handle this.\n    # Simply print the captured output.\n    print(output)\n```"
        }
    ]
}