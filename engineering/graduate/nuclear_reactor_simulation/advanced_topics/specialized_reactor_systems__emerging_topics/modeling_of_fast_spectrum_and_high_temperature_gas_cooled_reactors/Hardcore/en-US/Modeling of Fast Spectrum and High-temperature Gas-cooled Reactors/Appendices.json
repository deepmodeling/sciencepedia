{
    "hands_on_practices": [
        {
            "introduction": "The probability of a neutron interaction, described by the microscopic cross section $\\sigma(E)$, is highly dependent on neutron energy $E$. To perform simplified reactor calculations, it's essential to generate 'effective' cross sections that are averaged over the specific neutron energy spectrum present in the core. This exercise  provides a fundamental, analytical look at how these flux-weighted cross sections are derived and starkly illustrates the significant errors that arise from using cross sections averaged over an inappropriate spectrum, such as applying thermal reactor data to a fast reactor analysis.",
            "id": "4235404",
            "problem": "Consider a gas-cooled fast-spectrum reactor concept operating at high coolant temperature, representative of a Gas-Cooled Fast Reactor (GFR) in the high-temperature class of High-Temperature Gas-Cooled Reactors (HTGR). In depletion calculations, one-group effective microscopic cross sections are used for transmutation and burnup. The one-group effective cross section for a reaction channel of nuclide $i$ is defined as the flux-weighted average\n$$\n\\bar{\\sigma}_i \\equiv \\frac{\\int_{0}^{\\infty} \\sigma_i(E)\\,\\phi(E)\\,\\mathrm{d}E}{\\int_{0}^{\\infty} \\phi(E)\\,\\mathrm{d}E},\n$$\nwhere $\\sigma_i(E)$ is the energy-dependent microscopic cross section and $\\phi(E)$ is the neutron flux as a function of energy $E$.\n\nAssume the following physically motivated models:\n\n1. Fast-spectrum flux in the GFR core is well approximated over the interval $E \\in [E_1,E_2]$ with $E_1 = 0.1\\,\\mathrm{MeV}$ and $E_2 = 10\\,\\mathrm{MeV}$ by a slowing-down shape\n$$\n\\phi_{\\mathrm{fast}}(E) = \\frac{K_{\\mathrm{f}}}{E},\n$$\nwith $K_{\\mathrm{f}}$ a positive normalization constant.\n\n2. A thermal-spectrum flux model often used in thermal reactor depletion libraries is the Maxwellian form at temperature $T$,\n$$\n\\phi_{\\mathrm{th}}(E) = K_{\\mathrm{th}}\\,E\\,\\exp\\!\\left(-\\frac{E}{k_{B}T}\\right),\n$$\nwhere $K_{\\mathrm{th}}$ is a positive normalization constant and $k_{B}$ is the Boltzmann constant.\n\n3. For a representative minor actinide, Americium-241, model the absorption cross section $\\sigma_{a}(E)$ as\n- Thermal region (valid for $E \\lesssim 1\\,\\mathrm{eV}$): a one-over-speed law,\n$$\n\\sigma_{a}(E) = \\sigma_{0}\\,\\sqrt{\\frac{E_{0}}{E}},\n$$\nwith $\\sigma_{0} = 600\\,\\mathrm{b}$ at the reference energy $E_{0} = 0.0253\\,\\mathrm{eV}$.\n- Fast region (valid for $E \\gtrsim 10\\,\\mathrm{keV}$): approximately energy-independent,\n$$\n\\sigma_{a}(E) = \\sigma_{\\mathrm{f}},\n$$\nwith $\\sigma_{\\mathrm{f}} = 2.0\\,\\mathrm{b}$.\n\nUsing the fundamental definition of the one-group effective cross section above, perform the following:\n\n(a) Derive the expression for the fast-spectrum one-group absorption cross section $\\bar{\\sigma}_{a,\\mathrm{fast}}$ for Americium-241 under the flux model $\\phi_{\\mathrm{fast}}(E)$ over $E \\in [E_1,E_2]$, assuming the fast-region approximation for $\\sigma_{a}(E)$ holds throughout this interval.\n\n(b) Derive the expression for the thermal-spectrum one-group absorption cross section $\\bar{\\sigma}_{a,\\mathrm{th}}$ for Americium-241 under the flux model $\\phi_{\\mathrm{th}}(E)$ over $E \\in [0,\\infty)$, assuming the thermal-region approximation for $\\sigma_{a}(E)$ holds throughout.\n\n(c) Define the fractional bias incurred by using the thermal-spectrum average in fast-reactor burnup as\n$$\n\\delta \\equiv \\frac{\\bar{\\sigma}_{a,\\mathrm{th}}}{\\bar{\\sigma}_{a,\\mathrm{fast}}} - 1.\n$$\nEvaluate $\\delta$ numerically for $T = 900\\,\\mathrm{K}$ using $k_{B} = 8.617333262 \\times 10^{-5}\\,\\mathrm{eV/K}$. Express your final answer for $\\delta$ as a decimal with no unit and round your answer to three significant figures.",
            "solution": "The problem requires the calculation and comparison of one-group effective absorption cross sections for Americium-$241$ under two different neutron spectrum approximations: a fast spectrum and a thermal spectrum. The final goal is to quantify the fractional bias introduced by using the thermal-spectrum value in a fast-spectrum context.\n\n(a) Derivation of the fast-spectrum one-group absorption cross section, $\\bar{\\sigma}_{a,\\mathrm{fast}}$.\n\nThe one-group effective cross section is defined as the flux-weighted average over the relevant energy range. For the fast spectrum, the energy interval is specified as $[E_1, E_2]$.\n$$\n\\bar{\\sigma}_{a,\\mathrm{fast}} = \\frac{\\int_{E_1}^{E_2} \\sigma_a(E)\\,\\phi_{\\mathrm{fast}}(E)\\,\\mathrm{d}E}{\\int_{E_1}^{E_2} \\phi_{\\mathrm{fast}}(E)\\,\\mathrm{d}E}\n$$\nThe problem states to use the fast-spectrum flux model $\\phi_{\\mathrm{fast}}(E) = \\frac{K_{\\mathrm{f}}}{E}$ and the fast-region approximation for the absorption cross section $\\sigma_{a}(E) = \\sigma_{\\mathrm{f}}$ over the interval $E \\in [E_1,E_2]$. Substituting these into the definition:\n$$\n\\bar{\\sigma}_{a,\\mathrm{fast}} = \\frac{\\int_{E_1}^{E_2} \\sigma_{\\mathrm{f}}\\,\\left(\\frac{K_{\\mathrm{f}}}{E}\\right)\\,\\mathrm{d}E}{\\int_{E_1}^{E_2} \\left(\\frac{K_{\\mathrm{f}}}{E}\\right)\\,\\mathrm{d}E}\n$$\nThe constants $K_{\\mathrm{f}}$ and $\\sigma_{\\mathrm{f}}$ can be factored out of the integrals. The flux normalization constant $K_{\\mathrm{f}}$ is present in both the numerator and the denominator, so it cancels out.\n$$\n\\bar{\\sigma}_{a,\\mathrm{fast}} = \\frac{\\sigma_{\\mathrm{f}} K_{\\mathrm{f}} \\int_{E_1}^{E_2} \\frac{1}{E}\\,\\mathrm{d}E}{K_{\\mathrm{f}} \\int_{E_1}^{E_2} \\frac{1}{E}\\,\\mathrm{d}E}\n$$\nSince the integral $\\int_{E_1}^{E_2} \\frac{1}{E}\\,\\mathrm{d}E = [\\ln(E)]_{E_1}^{E_2} = \\ln(E_2) - \\ln(E_1) = \\ln(E_2/E_1)$ is non-zero for $E_2 \\neq E_1$, it can be cancelled from the numerator and denominator.\n$$\n\\bar{\\sigma}_{a,\\mathrm{fast}} = \\sigma_{\\mathrm{f}}\n$$\nThis result is expected: when the cross section is constant over an energy range, its flux-weighted average is simply that constant value, regardless of the flux weighting function. Using the given value, $\\sigma_{\\mathrm{f}} = 2.0\\,\\mathrm{b}$.\n\n(b) Derivation of the thermal-spectrum one-group absorption cross section, $\\bar{\\sigma}_{a,\\mathrm{th}}$.\n\nFor the thermal spectrum, the energy interval is $[0,\\infty)$. The definition is:\n$$\n\\bar{\\sigma}_{a,\\mathrm{th}} = \\frac{\\int_{0}^{\\infty} \\sigma_a(E)\\,\\phi_{\\mathrm{th}}(E)\\,\\mathrm{d}E}{\\int_{0}^{\\infty} \\phi_{\\mathrm{th}}(E)\\,\\mathrm{d}E}\n$$\nThe problem provides the thermal-spectrum flux model $\\phi_{\\mathrm{th}}(E) = K_{\\mathrm{th}}\\,E\\,\\exp\\left(-\\frac{E}{k_{B}T}\\right)$ and the thermal-region cross-section model $\\sigma_{a}(E) = \\sigma_{0}\\,\\sqrt{\\frac{E_{0}}{E}}$. Substituting these:\n$$\n\\bar{\\sigma}_{a,\\mathrm{th}} = \\frac{\\int_{0}^{\\infty} \\left(\\sigma_{0}\\,\\sqrt{\\frac{E_{0}}{E}}\\right) \\left(K_{\\mathrm{th}}\\,E\\,\\exp\\left(-\\frac{E}{k_{B}T}\\right)\\right)\\,\\mathrm{d}E}{\\int_{0}^{\\infty} K_{\\mathrm{th}}\\,E\\,\\exp\\left(-\\frac{E}{k_{B}T}\\right)\\,\\mathrm{d}E}\n$$\nThe constant factor $K_{\\mathrm{th}}$ cancels. Let us evaluate the numerator and denominator integrals separately.\nNumerator integral, $I_{\\mathrm{num}}$:\n$$\nI_{\\mathrm{num}} = \\int_{0}^{\\infty} \\sigma_{0}\\,\\sqrt{E_{0}}\\,E^{1/2}\\,\\exp\\left(-\\frac{E}{k_{B}T}\\right)\\,\\mathrm{d}E = \\sigma_0 \\sqrt{E_0} \\int_{0}^{\\infty} E^{1/2}\\,\\exp\\left(-\\frac{E}{k_{B}T}\\right)\\,\\mathrm{d}E\n$$\nDenominator integral, $I_{\\mathrm{den}}$:\n$$\nI_{\\mathrm{den}} = \\int_{0}^{\\infty} E\\,\\exp\\left(-\\frac{E}{k_{B}T}\\right)\\,\\mathrm{d}E\n$$\nBoth integrals are of the form related to the Gamma function, $\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} e^{-t}\\,\\mathrm{d}t$. We use the substitution $x = \\frac{E}{k_{B}T}$, so $E = k_{B} T x$ and $\\mathrm{d}E = k_{B} T \\mathrm{d}x$. A general integral of this type is then:\n$$\n\\int_{0}^{\\infty} E^n \\exp\\left(-\\frac{E}{k_{B}T}\\right)\\,\\mathrm{d}E = \\int_{0}^{\\infty} (k_B T x)^n e^{-x} (k_B T \\mathrm{d}x) = (k_B T)^{n+1} \\int_{0}^{\\infty} x^n e^{-x} \\mathrm{d}x = (k_B T)^{n+1} \\Gamma(n+1)\n$$\nFor the numerator integral, $n = \\frac{1}{2}$:\n$$\n\\int_{0}^{\\infty} E^{1/2}\\,\\exp\\left(-\\frac{E}{k_{B}T}\\right)\\,\\mathrm{d}E = (k_B T)^{3/2} \\Gamma\\left(\\frac{3}{2}\\right) = (k_B T)^{3/2} \\left(\\frac{1}{2}\\Gamma\\left(\\frac{1}{2}\\right)\\right) = (k_B T)^{3/2} \\frac{\\sqrt{\\pi}}{2}\n$$\nThus, $I_{\\mathrm{num}} = \\sigma_0 \\sqrt{E_0} (k_B T)^{3/2} \\frac{\\sqrt{\\pi}}{2}$.\nFor the denominator integral, $n = 1$:\n$$\nI_{\\mathrm{den}} = \\int_{0}^{\\infty} E^1 \\exp\\left(-\\frac{E}{k_{B}T}\\right)\\,\\mathrm{d}E = (k_B T)^2 \\Gamma(2) = (k_B T)^2 (1!) = (k_B T)^2\n$$\nNow, we find the ratio:\n$$\n\\bar{\\sigma}_{a,\\mathrm{th}} = \\frac{I_{\\mathrm{num}}}{I_{\\mathrm{den}}} = \\frac{\\sigma_0 \\sqrt{E_0} (k_B T)^{3/2} \\frac{\\sqrt{\\pi}}{2}}{(k_B T)^2} = \\sigma_0 \\sqrt{E_0} \\frac{\\sqrt{\\pi}}{2} (k_B T)^{-1/2}\n$$\nThis expression can be rearranged to a more recognizable form:\n$$\n\\bar{\\sigma}_{a,\\mathrm{th}} = \\sigma_0 \\left(\\frac{\\sqrt{\\pi}}{2}\\right) \\sqrt{\\frac{E_0}{k_B T}}\n$$\n\n(c) Evaluation of the fractional bias $\\delta$.\n\nThe fractional bias is defined as $\\delta = \\frac{\\bar{\\sigma}_{a,\\mathrm{th}}}{\\bar{\\sigma}_{a,\\mathrm{fast}}} - 1$.\nSubstituting the expressions derived in parts (a) and (b):\n$$\n\\delta = \\frac{\\sigma_0 \\left(\\frac{\\sqrt{\\pi}}{2}\\right) \\sqrt{\\frac{E_0}{k_B T}}}{\\sigma_{\\mathrm{f}}} - 1\n$$\nWe are given the following numerical values:\n$\\sigma_0 = 600\\,\\mathrm{b}$\n$\\sigma_{\\mathrm{f}} = 2.0\\,\\mathrm{b}$\n$E_0 = 0.0253\\,\\mathrm{eV}$\n$T = 900\\,\\mathrm{K}$\n$k_B = 8.617333262 \\times 10^{-5}\\,\\mathrm{eV/K}$\n\nFirst, calculate the thermal energy $k_B T$:\n$$\nk_B T = (8.617333262 \\times 10^{-5}\\,\\mathrm{eV/K}) \\times (900\\,\\mathrm{K}) \\approx 0.077556\\,\\mathrm{eV}\n$$\nNow, substitute all values into the expression for $\\delta$:\n$$\n\\delta = \\frac{600 \\left(\\frac{\\sqrt{\\pi}}{2}\\right) \\sqrt{\\frac{0.0253}{0.077556}}}{2.0} - 1\n$$\nLet's evaluate the terms step by step:\n$$\n\\frac{0.0253}{0.077556} \\approx 0.326214\n$$\n$$\n\\sqrt{\\frac{0.0253}{0.077556}} \\approx \\sqrt{0.326214} \\approx 0.571151\n$$\n$$\n\\frac{\\sqrt{\\pi}}{2} \\approx \\frac{1.772454}{2} \\approx 0.886227\n$$\nNow, calculate the numerator of the main fraction:\n$$\n\\bar{\\sigma}_{a,\\mathrm{th}} = 600 \\times 0.886227 \\times 0.571151 \\approx 303.554\\,\\mathrm{b}\n$$\nNext, calculate the ratio with $\\bar{\\sigma}_{a,\\mathrm{fast}} = \\sigma_{\\mathrm{f}} = 2.0\\,\\mathrm{b}$:\n$$\n\\frac{\\bar{\\sigma}_{a,\\mathrm{th}}}{\\bar{\\sigma}_{a,\\mathrm{fast}}} = \\frac{303.554}{2.0} \\approx 151.777\n$$\nFinally, calculate $\\delta$:\n$$\n\\delta = 151.777 - 1 = 150.777\n$$\nThe problem asks for the answer to be rounded to three significant figures.\n$$\n\\delta \\approx 151\n$$\nThe large positive bias indicates that using a thermal-spectrum averaged cross section in a fast-spectrum calculation would grossly overestimate the absorption rate for this nuclide, leading to significant errors in burnup and transmutation analysis.",
            "answer": "$$\\boxed{151}$$"
        },
        {
            "introduction": "Building upon the concept of flux-weighting, practical reactor analysis relies on condensing detailed, fine-group cross-section data into a computationally manageable coarse-group structure. This process, known as energy condensation, is a cornerstone of preparing input libraries for reactor simulation codes. In this hands-on coding exercise , you will implement the energy condensation procedure and quantify the errors introduced by using incorrect weighting spectra, demonstrating why accurate spectral information is crucial for generating reliable coarse-group constants.",
            "id": "4235457",
            "problem": "A reactor physics analyst is preparing a reduced energy-group library for a fast-spectrum region relevant to High-Temperature Gas-cooled Reactors (HTGR) and fast reactors. The analyst must condense fine-group microscopic reaction cross sections to a coarser energy structure using flux-weighted averaging, starting from the fundamental definition of reaction rates and group constants. The analyst must also quantify the error introduced when the chosen weighting spectrum is inappropriate for the actual fast spectrum.\n\nStart from the steady-state neutron balance expressed by the Boltzmann transport equation, and consider the reaction rate in continuous energy as the base definition: for a reaction channel with microscopic cross section $\\sigma_r(E)$ and scalar flux $\\phi(E)$, the reaction rate per target nucleus is $R_r = \\int \\phi(E)\\,\\sigma_r(E)\\,\\mathrm{d}E$. The multi-group condensation target is a coarse-group microscopic cross section $\\bar{\\sigma}_{r,G}$ satisfying the condition that, when applied with the group-integrated scalar flux, it preserves the reaction rate over the coarse group. The physically correct definition uses flux-weighted averaging over the coarse group.\n\nImplement the following discrete approximation in your program:\n1. Discretize energy into $8$ fine groups with boundaries (in electron-volts, eV) given by the ordered sequence $\\{10^5,\\;2\\times 10^5,\\;3.5\\times 10^5,\\;5\\times 10^5,\\;8\\times 10^5,\\;1.2\\times 10^6,\\;2.5\\times 10^6,\\;5\\times 10^6,\\;1\\times 10^7\\}$. Let the $i$-th fine group span $[E_i,E_{i+1}]$, width $\\Delta E_i = E_{i+1}-E_i$, and define a representative energy $E_i^\\star = \\sqrt{E_i\\,E_{i+1}}$.\n2. Two reaction channels are provided with fine-group microscopic cross sections in barns (where $1$ barn $=10^{-24}\\,\\mathrm{cm}^2$):\n   - Absorption: $\\{\\;0.30,\\;0.28,\\;0.26,\\;0.24,\\;0.22,\\;0.20,\\;0.19,\\;0.18\\;\\}$ barns.\n   - Fission: $\\{\\;0.20,\\;0.40,\\;0.70,\\;1.00,\\;1.20,\\;1.30,\\;1.25,\\;1.10\\;\\}$ barns.\n   Convert these to square centimeters before any reaction-rate calculations.\n3. The actual fast-spectrum fine-group flux weights are defined from a simple fast-spectrum proxy $\\phi_i \\propto \\Delta E_i / E_i^\\star$ scaled by $S = 10^{13}$ to yield a physically realistic magnitude. The flux unit is neutrons per square centimeter per second ($\\mathrm{n}/\\mathrm{cm}^2\\cdot\\mathrm{s}$).\n4. Construct three coarse groups by contiguous unions of fine groups:\n   - Coarse group $G_1$: fine indices $i = 0,1,2$.\n   - Coarse group $G_2$: fine indices $i = 3,4,5$.\n   - Coarse group $G_3$: fine indices $i = 6,7$.\n5. Define the coarse-group condensation operator for a weighting spectrum $w_i$ as\n   $$\\bar{\\sigma}_{r,G}(w) = \\frac{\\sum_{i\\in G} w_i\\,\\sigma_{r,i}}{\\sum_{i\\in G} w_i}\\,,$$\n   where $r\\in\\{\\text{absorption},\\text{fission}\\}$ and $G\\in\\{G_1,G_2,G_3\\}$. If $\\sum_{i\\in G} w_i = 0$ within any coarse group due to an extreme mismatch of $w_i$ with the group energies, use the fallback rule $\\bar{\\sigma}_{r,G}(w) = \\frac{1}{|G|}\\sum_{i\\in G}\\sigma_{r,i}$ (simple arithmetic average over the fine groups in $G$).\n6. Quantify the error when an inappropriate weighting spectrum $w_i$ is used, by comparing the coarse-group reaction rate prediction against the fine-group truth under the actual flux $\\phi_i$. For a given reaction channel $r$ and coarse group $G$, define the fine-group reaction rate per target nucleus as\n   $$R_{r,G}^{\\text{fine}} = \\sum_{i\\in G} \\phi_i\\,\\sigma_{r,i}\\,,$$\n   and the coarse prediction using condensed cross sections (computed with $w_i$) applied to the actual group-integrated flux as\n   $$R_{r,G}^{\\text{coarse}}(w) = \\bar{\\sigma}_{r,G}(w)\\,\\sum_{i\\in G}\\phi_i\\,.$$\n   The relative error is the dimensionless decimal fraction\n   $$\\varepsilon_{r,G}(w) = \\frac{R_{r,G}^{\\text{coarse}}(w) - R_{r,G}^{\\text{fine}}}{R_{r,G}^{\\text{fine}}}\\,.$$\n\nYour program must:\n- Implement the above condensation and error calculation for three test cases (weighting spectra):\n  1. Case A (correct fast-spectrum weighting): $w_i = \\phi_i$.\n  2. Case B (flat weighting): $w_i = \\Delta E_i$ (uniform in energy within each fine group).\n  3. Case C (thermal-like weighting, intentionally inappropriate for fast spectrum): $w_i = \\Delta E_i\\,\\exp\\!\\big(-E_i^\\star/E_{\\text{th}}\\big)$ with $E_{\\text{th}} = 0.025$ eV. This case will numerically underflow to extremely small values, potentially triggering the fallback rule.\n- For each case, compute the maximum absolute relative error across both reaction channels and all coarse groups,\n  $$\\max_{r\\in\\{\\text{absorption},\\text{fission}\\},\\;G\\in\\{G_1,G_2,G_3\\}} \\left|\\varepsilon_{r,G}(w)\\right|\\,.$$\n\nPhysical and numerical units:\n- Energies must be treated in electron-volts (eV).\n- Flux must be in $\\mathrm{n}/\\mathrm{cm}^2\\cdot\\mathrm{s}$.\n- Microscopic cross sections must be converted from barns to square centimeters before computing reaction rates.\n- Reaction rates per target nucleus must be computed in $\\mathrm{s}^{-1}$; the reported errors are unitless decimal fractions.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$).\n- Each result must be a float expressed as a decimal fraction (not a percentage), rounded to six decimal places.\n- The three results must correspond to Case A, Case B, and Case C, in that order.\n\nTest suite and coverage:\n- The three weighting spectra above form the test suite, covering:\n  - A \"happy path\" case (Case A), which should yield zero error by construction under exact arithmetic.\n  - A moderately inappropriate spectrum (Case B), exercising sensitivity to energy dependence in $\\sigma_{r,i}$.\n  - An extreme mismatch (Case C), exercising numerical stability and the specified fallback rule for zero total weight in coarse groups.\n\nYour task is to write a complete, runnable program that implements this condensation procedure and computes the specified three-case error metrics. The program must be self-contained and require no user input. The final output must strictly follow the specified format.",
            "solution": "The problem statement has been meticulously validated and is determined to be valid. It is scientifically grounded in the principles of nuclear reactor physics, specifically the multi-group method for neutron transport. The problem is well-posed, with all necessary data, definitions, and constraints provided to permit a unique and meaningful solution. The language is objective and the specifications are mathematically precise. We may therefore proceed with a formal solution.\n\nThe primary objective is to calculate and compare coarse-group microscopic cross sections derived from fine-group data using different weighting spectra. The accuracy of a given weighting scheme is quantified by the relative error it introduces in the predicted reaction rate compared to the true rate calculated from fine-group data.\n\nFirst, we establish the energy discretization. The energy range is divided into $8$ fine groups defined by $9$ energy boundaries, denoted as the ordered set $\\{E_k\\}_{k=0}^8$. The boundaries are provided in electron-volts ($\\mathrm{eV}$): $\\{10^5,\\;2\\times 10^5,\\;3.5\\times 10^5,\\;5\\times 10^5,\\;8\\times 10^5,\\;1.2\\times 10^6,\\;2.5\\times 10^6,\\;5\\times 10^6,\\;1\\times 10^7\\}$. The $i$-th fine group, for $i \\in \\{0, 1, \\dots, 7\\}$, spans the interval $[E_i, E_{i+1}]$. The width of fine group $i$ is $\\Delta E_i = E_{i+1} - E_i$, and its representative energy is defined as the geometric mean $E_i^\\star = \\sqrt{E_i E_{i+1}}$.\n\nWe are given fine-group microscopic cross sections for two reaction channels, absorption ($\\sigma_{a,i}$) and fission ($\\sigma_{f,i}$), in units of barns. For all reaction rate calculations, these must be converted to $\\mathrm{cm}^2$ using the conversion factor $1\\,\\text{barn} = 10^{-24}\\,\\mathrm{cm}^2$. The provided values are:\n- Absorption, $\\sigma_{a,i}$: $\\{\\;0.30,\\;0.28,\\;0.26,\\;0.24,\\;0.22,\\;0.20,\\;0.19,\\;0.18\\;\\}$ barns.\n- Fission, $\\sigma_{f,i}$: $\\{\\;0.20,\\;0.40,\\;0.70,\\;1.00,\\;1.20,\\;1.30,\\;1.25,\\;1.10\\;\\}$ barns.\n\nThe reference or \"true\" neutron spectrum is given by the fine-group integrated scalar fluxes, $\\phi_i$. These are derived from a characteristic $1/E$ fast spectrum dependence, approximated discretely as $\\phi_i \\propto \\Delta E_i / E_i^\\star$. To achieve a physically realistic magnitude, these weights are scaled by a factor $S = 10^{13}$, giving the group fluxes in units of $\\mathrm{n}/\\mathrm{cm}^2\\cdot\\mathrm{s}$:\n$$ \\phi_i = S \\frac{\\Delta E_i}{E_i^\\star} $$\n\nThe core of the problem is the condensation of these fine-group cross sections into a coarser $3$-group structure. The coarse groups are defined as contiguous blocks of fine groups:\n- Coarse group $G_1$: fine indices $i \\in \\{0, 1, 2\\}$.\n- Coarse group $G_2$: fine indices $i \\in \\{3, 4, 5\\}$.\n- Coarse group $G_3$: fine indices $i \\in \\{6, 7\\}$.\n\nThe process of condensation hinges on a weighting spectrum, $w_i$, to average the fine-group cross sections. The condensed coarse-group cross section, $\\bar{\\sigma}_{r,G}$, for reaction $r$ in group $G$ is defined by the flux-weighting formula:\n$$ \\bar{\\sigma}_{r,G}(w) = \\frac{\\sum_{i\\in G} w_i\\,\\sigma_{r,i}}{\\sum_{i\\in G} w_i} $$\nThis definition ensures that if the weighting spectrum $w_i$ is identical to the true flux spectrum $\\phi_i$, the reaction rate is preserved. A special fallback rule is specified for cases where the total weight in a group is zero ($\\sum_{i\\in G} w_i = 0$): the condensed cross section defaults to the simple arithmetic average $\\bar{\\sigma}_{r,G}(w) = \\frac{1}{|G|}\\sum_{i\\in G}\\sigma_{r,i}$, where $|G|$ is the number of fine groups in $G$.\n\nTo quantify the error introduced by an arbitrary weighting spectrum $w$, we compare the reaction rate calculated with the condensed cross section to the true rate. The true fine-group reaction rate per target nucleus in coarse group $G$ is:\n$$ R_{r,G}^{\\text{fine}} = \\sum_{i\\in G} \\phi_i\\,\\sigma_{r,i} $$\nThe approximate coarse-group reaction rate is calculated using the condensed cross section and the true coarse-group integrated flux, $\\Phi_G = \\sum_{i\\in G} \\phi_i$:\n$$ R_{r,G}^{\\text{coarse}}(w) = \\bar{\\sigma}_{r,G}(w) \\cdot \\Phi_G $$\nThe relative error is then defined as:\n$$ \\varepsilon_{r,G}(w) = \\frac{R_{r,G}^{\\text{coarse}}(w) - R_{r,G}^{\\text{fine}}}{R_{r,G}^{\\text{fine}}} $$\nThe final metric for each case is the maximum absolute relative error across both reaction channels and all three coarse groups.\n\nWe evaluate this for three test cases:\n1.  **Case A (Correct Weighting)**: $w_i = \\phi_i$. By substituting $w_i = \\phi_i$ into the definition of $\\bar{\\sigma}_{r,G}$, we find that $R_{r,G}^{\\text{coarse}}(w) = (\\frac{\\sum \\phi_i \\sigma_{r,i}}{\\sum \\phi_i})(\\sum \\phi_i) = \\sum \\phi_i \\sigma_{r,i} = R_{r,G}^{\\text{fine}}$. Thus, the theoretical error $\\varepsilon_{r,G}$ is identically zero. Any non-zero result would be attributable to floating-point arithmetic limitations.\n\n2.  **Case B (Flat Weighting)**: $w_i = \\Delta E_i$. This corresponds to assuming a flat flux in energy, i.e., $\\phi(E) = \\text{constant}$ within each fine group. Since the true flux has a $1/E$ shape, this weighting spectrum is an approximation and will introduce non-zero errors, which measure the sensitivity of the condensed cross section to the intra-group spectral shape.\n\n3.  **Case C (Thermal-like Weighting)**: $w_i = \\Delta E_i\\,\\exp(-E_i^\\star/E_{\\text{th}})$ with $E_{\\text{th}} = 0.025\\,\\mathrm{eV}$. This weighting spectrum is characteristic of a thermal system and is grossly inappropriate for the high-energy fast spectrum being studied ($E_i^\\star \\gg E_{\\text{th}}$). The exponential term $\\exp(-E_i^\\star/E_{\\text{th}})$ will numerically underflow to zero for all fine groups. Consequently, for each coarse group $G$, the total weight $\\sum_{i \\in G} w_i$ will be zero, triggering the fallback rule. The condensed cross sections become simple arithmetic averages, which are expected to yield large errors.\n\nThe following numerical implementation computes the maximum absolute relative error for each of these three cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes condensed cross sections and evaluates the error from using different\n    weighting spectra for a fast-spectrum nuclear reactor problem.\n    \"\"\"\n    \n    # 1. Define Givens: Constants, Data, and Physical Parameters\n    BARN_TO_CM2 = 1e-24\n    E_BOUNDS_EV = np.array([1e5, 2e5, 3.5e5, 5e5, 8e5, 1.2e6, 2.5e6, 5e6, 1e7], dtype=np.float64)\n    \n    # Fine-group microscopic cross sections in barns\n    SIGMA_A_FINE_BARNS = np.array([0.30, 0.28, 0.26, 0.24, 0.22, 0.20, 0.19, 0.18], dtype=np.float64)\n    SIGMA_F_FINE_BARNS = np.array([0.20, 0.40, 0.70, 1.00, 1.20, 1.30, 1.25, 1.10], dtype=np.float64)\n    \n    # Convert cross sections to cm^2 before calculations\n    sigma_a_fine = SIGMA_A_FINE_BARNS * BARN_TO_CM2\n    sigma_f_fine = SIGMA_F_FINE_BARNS * BARN_TO_CM2\n    \n    # Flux scaling factor and thermal energy for Case C\n    S_FLUX_SCALE = 1e13\n    E_TH_EV = 0.025\n\n    # 2. Calculate Energy Group Structure Properties\n    # Fine-group widths (Delta E_i)\n    delta_e = E_BOUNDS_EV[1:] - E_BOUNDS_EV[:-1]\n    # Fine-group representative energies (E_i*)\n    e_star = np.sqrt(E_BOUNDS_EV[1:] * E_BOUNDS_EV[:-1])\n    \n    # Coarse group definitions (mapping from coarse to fine indices)\n    coarse_group_indices = {\n        'G1': [0, 1, 2],\n        'G2': [3, 4, 5],\n        'G3': [6, 7]\n    }\n    \n    # 3. Calculate \"True\" Fast-Spectrum Fine-Group Fluxes\n    # phi_i = S * (Delta E_i / E_i*)\n    phi_true = S_FLUX_SCALE * (delta_e / e_star)\n    \n    # 4. Define Weighting Spectra for the Three Test Cases\n    # Case A (correct fast-spectrum weighting)\n    w_case_A = phi_true\n    \n    # Case B (flat weighting)\n    w_case_B = delta_e\n    \n    # Case C (thermal-like weighting)\n    w_case_C = delta_e * np.exp(-e_star / E_TH_EV)\n\n    weighting_spectra_cases = [w_case_A, w_case_B, w_case_C]\n    \n    final_errors = []\n\n    # 5. Process Each Test Case\n    for w_spectrum in weighting_spectra_cases:\n        max_abs_error_for_case = 0.0\n        \n        # Iterate over all coarse groups\n        for indices in coarse_group_indices.values():\n            \n            # Extract fine-group data relevant to the current coarse group\n            phi_g_true = phi_true[indices]\n            w_g = w_spectrum[indices]\n            \n            # Iterate over the two reaction channels\n            for sigma_r_fine in [sigma_a_fine, sigma_f_fine]:\n                sigma_r_fine_g = sigma_r_fine[indices]\n                \n                # Calculate the condensed cross section (sigma_bar)\n                sum_w_sigma = np.sum(w_g * sigma_r_fine_g)\n                sum_w = np.sum(w_g)\n                \n                if sum_w == 0.0:\n                    # Apply fallback rule: arithmetic average\n                    sigma_r_G_bar = np.mean(sigma_r_fine_g)\n                else:\n                    # Standard flux-weighted average\n                    sigma_r_G_bar = sum_w_sigma / sum_w\n                    \n                # Calculate reaction rates and the relative error\n                \n                # True reaction rate from fine-group data\n                R_fine = np.sum(phi_g_true * sigma_r_fine_g)\n                \n                # Coarse-group integrated flux\n                Phi_G_true = np.sum(phi_g_true)\n                \n                # Predicted reaction rate from coarse-group data\n                R_coarse = sigma_r_G_bar * Phi_G_true\n                \n                # Calculate relative error, guarding against division by zero\n                if R_fine == 0.0:\n                    relative_error = 0.0\n                else:\n                    relative_error = (R_coarse - R_fine) / R_fine\n                \n                # Update the maximum absolute error for the current case\n                max_abs_error_for_case = max(max_abs_error_for_case, abs(relative_error))\n                \n        final_errors.append(max_abs_error_for_case)\n\n    # 6. Format and Print the Final Output\n    # The format must be a list of comma-separated floats, rounded to six decimal places.\n    print(f\"[{','.join([f'{err:.6f}' for err in final_errors])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once appropriate group constants are generated, they can be used in diffusion or transport models to predict the behavior of the entire reactor core. This exercise  guides you through the implementation of a two-group diffusion model to analyze the critical link between a reactor's boundary conditions, neutron leakage, and its core physics. By comparing a system with perfect reflection to one with vacuum boundaries, you will directly quantify how leakage not only reduces reactivity but also 'hardens' the neutron spectrum, a key characteristic of finite-sized fast-spectrum systems.",
            "id": "4235454",
            "problem": "You will implement a physically consistent two-group diffusion model to explain, from first principles, how reflective versus vacuum boundary conditions alter neutron leakage and thereby shift the neutron energy spectrum in homogeneous fast-spectrum and high-temperature gas-cooled reactor cores. Starting from neutron balance and Fick’s law in a one-dimensional slab, derive the homogeneous $k$-eigenvalue system that explicitly separates material effects from leakage and then quantify the leakage-driven spectrum change attributable to boundary conditions. Your program must solve the resulting algebraic system for both boundary conditions and report how the spectral hardness and the effective multiplication factor change.\n\nBegin from the following fundamental base: (i) the steady-state, groupwise neutron balance with isotropic scattering and fission source, (ii) Fick’s law with groupwise diffusion coefficients, and (iii) the one-dimensional Helmholtz eigenproblem for the fundamental spatial mode in a finite slab with homogeneous coefficients. Use boundary conditions that represent a vacuum interface by zero flux and a reflective interface by zero current. From this starting point, separate variables to obtain a leakage term proportional to the square of the fundamental spatial eigenvalue of the one-dimensional Laplacian, and express leakage in each energy group as an additive removal term of the form $D_g B^2$, where $D_g$ is the groupwise diffusion coefficient and $B^2$ is the geometric buckling. For a slab of physical thickness $L$ with homogeneous material properties, use the smallest nonnegative eigenvalue of the Helmholtz problem with the appropriate boundary conditions to define $B^2$. For reflective boundaries at both faces (zero current), the fundamental buckling is zero. For vacuum boundaries at both faces (zero flux), use the lowest positive eigenvalue. Angles must be treated in radians.\n\nAssume a two-group model with the following assumptions: (a) homogeneous material, (b) no upscattering from group $2$ to group $1$, (c) isotropic scattering in the laboratory frame, (d) fission neutrons are born with a fixed two-group spectrum, and (e) the reactor is a one-dimensional slab of thickness $L$. Let the unknowns be the groupwise flux amplitudes $\\phi_1$ and $\\phi_2$ and the effective multiplication factor $k$. Let the known data be: groupwise diffusion coefficients $D_1$ and $D_2$ in $\\mathrm{cm}$, absorption cross sections $\\Sigma_{a1}$ and $\\Sigma_{a2}$ in $\\mathrm{cm}^{-1}$, downscatter cross section $\\Sigma_{s,1\\to 2}$ in $\\mathrm{cm}^{-1}$, groupwise fission production cross sections $\\nu \\Sigma_{f1}$ and $\\nu \\Sigma_{f2}$ in $\\mathrm{cm}^{-1}$, and fission spectrum fractions $\\chi_1$ and $\\chi_2$ with $\\chi_1 + \\chi_2 = 1$ (dimensionless). The slab thickness $L$ is in $\\mathrm{cm}$. All outputs ($k$ and the spectral hardness metric defined below) are dimensionless.\n\nTasks to perform and quantities to report:\n- Derive the homogeneous two-group $k$-eigenvalue system that incorporates leakage through an additive removal term $D_g B^2$ and expresses fission production via a right-hand-side operator scaled by $1/k$.\n- For each boundary condition (reflective and vacuum), compute the effective multiplication factor $k$ and the spectral hardness metric $H = \\dfrac{\\phi_1}{\\phi_1 + \\phi_2}$.\n- Quantify the leakage-driven spectrum change by computing the difference $\\Delta H = H_{\\text{reflective}} - H_{\\text{vacuum}}$ and the reactivity impact via $\\Delta k = k_{\\text{reflective}} - k_{\\text{vacuum}}$.\n\nPhysical and numerical units:\n- Use $L$ in $\\mathrm{cm}$, $D_g$ in $\\mathrm{cm}$, and all cross sections in $\\mathrm{cm}^{-1}$. The angle constant implicit in the Helmholtz eigenvalues must be interpreted in radians. The outputs $H$ and $k$ are dimensionless.\n- Express your final numerical outputs as decimal floating-point values rounded to $6$ digits after the decimal point.\n\nTest suite:\nImplement your solution for the following three homogeneous slabs, each evaluated twice (reflective and vacuum boundaries on both faces):\n\n- Case $1$ (fast-spectrum, compact core):\n  - $L = 100\\,\\mathrm{cm}$,\n  - $D_1 = 1.3\\,\\mathrm{cm}$, $D_2 = 0.4\\,\\mathrm{cm}$,\n  - $\\Sigma_{a1} = 0.008\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a2} = 0.020\\,\\mathrm{cm}^{-1}$,\n  - $\\Sigma_{s,1\\to 2} = 0.050\\,\\mathrm{cm}^{-1}$,\n  - $\\nu \\Sigma_{f1} = 0.007\\,\\mathrm{cm}^{-1}$, $\\nu \\Sigma_{f2} = 0.001\\,\\mathrm{cm}^{-1}$,\n  - $\\chi_1 = 0.95$, $\\chi_2 = 0.05$.\n- Case $2$ (high-temperature gas-cooled reactor, moderate size):\n  - $L = 300\\,\\mathrm{cm}$,\n  - $D_1 = 1.0\\,\\mathrm{cm}$, $D_2 = 0.3\\,\\mathrm{cm}$,\n  - $\\Sigma_{a1} = 0.004\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a2} = 0.070\\,\\mathrm{cm}^{-1}$,\n  - $\\Sigma_{s,1\\to 2} = 0.120\\,\\mathrm{cm}^{-1}$,\n  - $\\nu \\Sigma_{f1} = 0.002\\,\\mathrm{cm}^{-1}$, $\\nu \\Sigma_{f2} = 0.006\\,\\mathrm{cm}^{-1}$,\n  - $\\chi_1 = 0.95$, $\\chi_2 = 0.05$.\n- Case $3$ (high-temperature gas-cooled reactor, very large core):\n  - $L = 1000\\,\\mathrm{cm}$,\n  - $D_1 = 1.0\\,\\mathrm{cm}$, $D_2 = 0.3\\,\\mathrm{cm}$,\n  - $\\Sigma_{a1} = 0.004\\,\\mathrm{cm}^{-1}$, $\\Sigma_{a2} = 0.070\\,\\mathrm{cm}^{-1}$,\n  - $\\Sigma_{s,1\\to 2} = 0.120\\,\\mathrm{cm}^{-1}$,\n  - $\\nu \\Sigma_{f1} = 0.002\\,\\mathrm{cm}^{-1}$, $\\nu \\Sigma_{f2} = 0.006\\,\\mathrm{cm}^{-1}$,\n  - $\\chi_1 = 0.95$, $\\chi_2 = 0.05$.\n\nFinal output format:\n- For each case, produce a list of six floating-point numbers in the order $[H_{\\text{reflective}}, H_{\\text{vacuum}}, \\Delta H, k_{\\text{reflective}}, k_{\\text{vacuum}}, \\Delta k]$, each rounded to $6$ digits after the decimal point.\n- Your program should produce a single line of output containing the results for all three cases as a comma-separated list of these per-case lists, enclosed in square brackets, for example: $[[h_{1r},h_{1v},\\Delta h_1,k_{1r},k_{1v},\\Delta k_1],[h_{2r},h_{2v},\\Delta h_2,k_{2r},k_{2v},\\Delta k_2],[h_{3r},h_{3v},\\Delta h_3,k_{3r},k_{3v},\\Delta k_3]]$.",
            "solution": "The analysis begins with the steady-state, two-group neutron diffusion equations for a homogeneous, one-dimensional slab geometry. The two energy groups are group $1$ (fast neutrons) and group $2$ (thermal neutrons). There is no upscattering from group $2$ to group $1$. The governing equations for the neutron flux $\\phi_g(x)$ in group $g$ at position $x$ are derived from a neutron balance principle.\n\nFor group $1$, the balance between neutron losses (absorption, out-scattering, and leakage) and production (fission) is:\n$$\n-\\frac{d}{dx} J_1(x) + \\Sigma_{R1,mat} \\phi_1(x) = \\frac{1}{k} F_1(x)\n$$\nwhere $J_1(x)$ is the neutron current, $k$ is the effective multiplication factor, $\\Sigma_{R1,mat} = \\Sigma_{a1} + \\Sigma_{s,1\\rightarrow 2}$ is the material removal cross section for group $1$ (sum of absorption $\\Sigma_{a1}$ and down-scattering $\\Sigma_{s,1\\rightarrow 2}$), and $F_1(x)$ is the production of fission neutrons into group $1$.\n\nFor group $2$, the balance includes a source term from the down-scattering of fast neutrons:\n$$\n-\\frac{d}{dx} J_2(x) + \\Sigma_{a2} \\phi_2(x) = \\Sigma_{s,1\\rightarrow 2} \\phi_1(x) + \\frac{1}{k} F_2(x)\n$$\nwhere $\\Sigma_{a2}$ is the absorption cross section for group $2$ and $F_2(x)$ is the production of fission neutrons into group $2$.\n\nThe total fission source $F(x)$ is given by:\n$$\nF(x) = \\nu\\Sigma_{f1} \\phi_1(x) + \\nu\\Sigma_{f2} \\phi_2(x)\n$$\nThe fraction of this source appearing in group $g$ is $\\chi_g$, so $F_g(x) = \\chi_g F(x)$.\n\nFick's law relates the neutron current $J_g(x)$ to the gradient of the flux:\n$$\nJ_g(x) = -D_g \\frac{d\\phi_g(x)}{dx}\n$$\nwhere $D_g$ is the diffusion coefficient for group $g$. For a homogeneous medium, substituting Fick's law into the balance equations yields:\n$$\n-D_1 \\frac{d^2\\phi_1(x)}{dx^2} + (\\Sigma_{a1} + \\Sigma_{s,1\\rightarrow 2}) \\phi_1(x) = \\frac{1}{k} \\left[ \\chi_1 (\\nu\\Sigma_{f1} \\phi_1(x) + \\nu\\Sigma_{f2} \\phi_2(x)) \\right]\n$$\n$$\n-D_2 \\frac{d^2\\phi_2(x)}{dx^2} + \\Sigma_{a2} \\phi_2(x) = \\Sigma_{s,1\\rightarrow 2} \\phi_1(x) + \\frac{1}{k} \\left[ \\chi_2 (\\nu\\Sigma_{f1} \\phi_1(x) + \\nu\\Sigma_{f2} \\phi_2(x)) \\right]\n$$\nTo solve this system of coupled differential equations, we employ the method of separation of variables, assuming the flux can be written as the product of a spatial shape function $\\psi(x)$ and group-dependent amplitude $\\phi_g$: $\\phi_g(x) = \\phi_g \\psi(x)$. The spatial shape function $\\psi(x)$ must satisfy the Helmholtz equation with appropriate boundary conditions:\n$$\n\\frac{d^2\\psi(x)}{dx^2} + B^2 \\psi(x) = 0\n$$\nwhere $B^2$ is the geometric buckling, a positive constant representing the curvature of the flux. This implies that $\\frac{d^2\\phi_g(x)}{dx^2} = -B^2 \\phi_g \\psi(x) = -B^2 \\phi_g(x)$. The term $-D_g \\frac{d^2\\phi_g(x)}{dx^2}$ becomes an algebraic leakage term $D_g B^2 \\phi_g(x)$. Substituting this into the diffusion equations and dividing by the common spatial mode $\\psi(x)$ results in a homogeneous algebraic system for the flux amplitudes $\\phi_1$ and $\\phi_2$:\n$$\nD_1 B^2 \\phi_1 + (\\Sigma_{a1} + \\Sigma_{s,1\\rightarrow 2}) \\phi_1 = \\frac{1}{k} (\\chi_1 \\nu\\Sigma_{f1} \\phi_1 + \\chi_1 \\nu\\Sigma_{f2} \\phi_2)\n$$\n$$\nD_2 B^2 \\phi_2 + \\Sigma_{a2} \\phi_2 = \\Sigma_{s,1\\rightarrow 2} \\phi_1 + \\frac{1}{k} (\\chi_2 \\nu\\Sigma_{f1} \\phi_1 + \\chi_2 \\nu\\Sigma_{f2} \\phi_2)\n$$\nThese equations can be expressed as a matrix eigenvalue problem of the form $\\mathbf{A} \\vec{\\phi} = \\frac{1}{k} \\mathbf{F} \\vec{\\phi}$, where $\\vec{\\phi} = [\\phi_1, \\phi_2]^T$. Rearranging terms yields:\n$$\n(\\Sigma_{a1} + \\Sigma_{s,1\\rightarrow 2} + D_1 B^2) \\phi_1 - (0) \\phi_2 = \\frac{1}{k} (\\chi_1 \\nu\\Sigma_{f1} \\phi_1 + \\chi_1 \\nu\\Sigma_{f2} \\phi_2)\n$$\n$$\n-\\Sigma_{s,1\\rightarrow 2} \\phi_1 + (\\Sigma_{a2} + D_2 B^2) \\phi_2 = \\frac{1}{k} (\\chi_2 \\nu\\Sigma_{f1} \\phi_1 + \\chi_2 \\nu\\Sigma_{f2} \\phi_2)\n$$\nThe loss operator matrix $\\mathbf{A}$ and the fission production matrix $\\mathbf{F}$ are:\n$$\n\\mathbf{A} = \\begin{pmatrix} \\Sigma_{a1} + \\Sigma_{s,1\\rightarrow 2} + D_1 B^2  0 \\\\ -\\Sigma_{s,1\\rightarrow 2}  \\Sigma_{a2} + D_2 B^2 \\end{pmatrix}\n$$\n$$\n\\mathbf{F} = \\begin{pmatrix} \\chi_1 \\nu\\Sigma_{f1}  \\chi_1 \\nu\\Sigma_{f2} \\\\ \\chi_2 \\nu\\Sigma_{f1}  \\chi_2 \\nu\\Sigma_{f2} \\end{pmatrix}\n$$\nThis generalized eigenvalue problem is typically solved by converting it to the standard form $\\mathbf{M} \\vec{\\phi} = k \\vec{\\phi}$, where $\\mathbf{M} = \\mathbf{A}^{-1} \\mathbf{F}$. The largest positive eigenvalue of the matrix $\\mathbf{M}$ is the effective multiplication factor $k$, and its corresponding eigenvector $\\vec{\\phi}$ gives the ratio of the flux amplitudes.\n\nThe geometric buckling $B^2$ is determined by the boundary conditions on a slab of thickness $L$.\n1.  **Reflective Boundaries**: The net current at the boundaries is zero ($J_g(\\pm L/2)=0$), which implies the flux gradient is zero. The lowest non-negative eigenvalue of the Helmholtz equation for these conditions is $B^2 = 0$. This corresponds to a spatially flat flux profile and represents a system with zero neutron leakage, as in an infinitely large reactor.\n2.  **Vacuum Boundaries**: The flux is assumed to vanish at the extrapolated boundaries, which for a bare slab are approximately the physical boundaries ($\\phi_g(\\pm L/2) = 0$). The lowest positive eigenvalue of the Helmholtz equation that satisfies these conditions is $B^2 = (\\pi/L)^2$. This introduces a non-zero leakage term $D_g B^2$, which acts as an additional removal mechanism.\n\nBy solving the eigenvalue problem for $B^2=0$ (reflective) and $B^2=(\\pi/L)^2$ (vacuum), we can quantify the impact of leakage. Leakage preferentially removes faster, more mobile neutrons (group $1$, for which $D_1$ is typically larger). This reduction in the population of neutrons that would otherwise slow down into group $2$ causes a relative increase in the fast flux component. Consequently, the spectrum becomes \"harder\" in the presence of leakage. The spectral hardness is quantified by the metric $H = \\frac{\\phi_1}{\\phi_1 + \\phi_2}$. We expect $H_{\\text{vacuum}}  H_{\\text{reflective}}$. Neutron leakage is a loss mechanism, so it reduces the overall reactivity of the core. Thus, we expect $k_{\\text{vacuum}}  k_{\\text{reflective}}$. The quantities $\\Delta H = H_{\\text{reflective}} - H_{\\text{vacuum}}$ and $\\Delta k = k_{\\text{reflective}} - k_{\\text{vacuum}}$ measure these effects.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the final result.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (fast-spectrum, compact core)\n        {\n            \"L\": 100.0, \"D1\": 1.3, \"D2\": 0.4,\n            \"Sa1\": 0.008, \"Sa2\": 0.020, \"Ss12\": 0.050,\n            \"nuf1\": 0.007, \"nuf2\": 0.001,\n            \"chi1\": 0.95, \"chi2\": 0.05\n        },\n        # Case 2 (high-temperature gas-cooled reactor, moderate size)\n        {\n            \"L\": 300.0, \"D1\": 1.0, \"D2\": 0.3,\n            \"Sa1\": 0.004, \"Sa2\": 0.070, \"Ss12\": 0.120,\n            \"nuf1\": 0.002, \"nuf2\": 0.006,\n            \"chi1\": 0.95, \"chi2\": 0.05\n        },\n        # Case 3 (high-temperature gas-cooled reactor, very large core)\n        {\n            \"L\": 1000.0, \"D1\": 1.0, \"D2\": 0.3,\n            \"Sa1\": 0.004, \"Sa2\": 0.070, \"Ss12\": 0.120,\n            \"nuf1\": 0.002, \"nuf2\": 0.006,\n            \"chi1\": 0.95, \"chi2\": 0.05\n        }\n    ]\n\n    all_results = []\n    for params in test_cases:\n        # --- Reflective Case ---\n        # For reflective boundaries, geometric buckling is zero.\n        B2_refl = 0.0\n        k_refl, H_refl = calculate_eigen_solution(B2_refl, params)\n\n        # --- Vacuum Case ---\n        # For vacuum boundaries, geometric buckling is (pi/L)^2.\n        B2_vac = (np.pi / params[\"L\"])**2\n        k_vac, H_vac = calculate_eigen_solution(B2_vac, params)\n\n        # --- Calculate differences ---\n        delta_H = H_refl - H_vac\n        delta_k = k_refl - k_vac\n\n        case_results = [H_refl, H_vac, delta_H, k_refl, k_vac, delta_k]\n        all_results.append(case_results)\n\n    # --- Format the output as specified ---\n    # Example: [[h1r,h1v,dh1,k1r,k1v,dk1],[h2r,h2v,dh2,k2r,k2v,dk2],...]\n    sub_lists_str = []\n    for sub_list in all_results:\n        # Format each number to 6 decimal places and join with commas\n        formatted_nums = [f\"{x:.6f}\" for x in sub_list]\n        sub_lists_str.append(f\"[{','.join(formatted_nums)}]\")\n\n    # Join the sub-lists and enclose in the final brackets\n    final_str = f\"[{','.join(sub_lists_str)}]\"\n    print(final_str)\n\ndef calculate_eigen_solution(B2, params):\n    \"\"\"\n    Solves the 2-group k-eigenvalue problem for a given buckling and material properties.\n\n    Args:\n        B2 (float): Geometric buckling B^2.\n        params (dict): Dictionary of nuclear data.\n\n    Returns:\n        tuple: A tuple containing:\n            - k (float): The effective multiplication factor (dominant eigenvalue).\n            - H (float): The spectral hardness metric.\n    \"\"\"\n    # Unpack parameters for clarity\n    D1, D2 = params[\"D1\"], params[\"D2\"]\n    Sa1, Sa2 = params[\"Sa1\"], params[\"Sa2\"]\n    Ss12 = params[\"Ss12\"]\n    nuf1, nuf2 = params[\"nuf1\"], params[\"nuf2\"]\n    chi1, chi2 = params[\"chi1\"], params[\"chi2\"]\n\n    # Define total removal macroscopic cross sections including leakage\n    # Sigma_R1' = Sigma_a1 + Sigma_s,1-2 + D1*B^2\n    # Sigma_R2' = Sigma_a2 + D2*B^2\n    Sigma_R1_prime = Sa1 + Ss12 + D1 * B2\n    Sigma_R2_prime = Sa2 + D2 * B2\n\n    # Fission matrix F\n    F = np.array([\n        [chi1 * nuf1, chi1 * nuf2],\n        [chi2 * nuf1, chi2 * nuf2]\n    ])\n\n    # Inverse of the loss matrix A\n    # A = [[Sigma_R1', 0], [-Ss12, Sigma_R2']]\n    # A_inv = (1/(det(A))) * [[Sigma_R2', 0], [Ss12, Sigma_R1']]\n    A_inv = np.array([\n        [1.0 / Sigma_R1_prime, 0],\n        [Ss12 / (Sigma_R1_prime * Sigma_R2_prime), 1.0 / Sigma_R2_prime]\n    ])\n    \n    # System matrix M = A_inv * F\n    M = A_inv @ F\n    \n    # Solve the eigenvalue problem M*phi = k*phi\n    eigenvalues, eigenvectors = np.linalg.eig(M)\n\n    # The physical solution corresponds to the largest positive real eigenvalue (k_eff)\n    # and its corresponding eigenvector (the flux shape).\n    # For a non-negative matrix M, Perron-Frobenius theorem guarantees this exists.\n    k_eff_idx = np.argmax(np.real(eigenvalues))\n    k = np.real(eigenvalues[k_eff_idx])\n    \n    # The corresponding eigenvector contains the flux amplitudes phi_1 and phi_2\n    flux_vector = np.real(eigenvectors[:, k_eff_idx])\n    phi1 = flux_vector[0]\n    phi2 = flux_vector[1]\n\n    # Ensure positivity of flux components as per physical convention\n    phi1 = abs(phi1)\n    phi2 = abs(phi2)\n\n    # Calculate spectral hardness H = phi_1 / (phi_1 + phi_2)\n    H = phi1 / (phi1 + phi2) if (phi1 + phi2)  0 else 0.0\n    \n    return k, H\n\nsolve()\n```"
        }
    ]
}