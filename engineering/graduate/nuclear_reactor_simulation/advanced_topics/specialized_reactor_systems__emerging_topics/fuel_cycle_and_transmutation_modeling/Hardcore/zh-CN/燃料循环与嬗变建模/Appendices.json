{
    "hands_on_practices": [
        {
            "introduction": "任何嬗变模型的准确性都取决于其输入数据的质量，尤其是反应截面。由于中子能谱在反应堆的不同位置和时间会发生显著变化，我们必须使用能谱平均的有效截面。本练习将演示通量加权的基本过程，将多群截面数据折叠成单个有效值，这是为燃耗程序准备输入的基石。",
            "id": "4227504",
            "problem": "一个代表性的、采用天然铀燃料的加压重水堆（PHWR）的均匀栅元模型被用于进行双群中子输运计算，以模拟铀同位素的嬗变。目标是确定$^{238}\\mathrm{U}$的能谱平均有效微观俘获截面，该截面适用于燃料循环燃耗计算，其中$^{238}\\mathrm{U}$的中子俘获会产生$^{239}\\mathrm{U}$，并随后生成$^{239}\\mathrm{Pu}$。\n\n假设以下物理上一致的设置：\n\n- 中子通量被划分为两个能群：一个热群，索引为$g=1$；一个超热-快中子群，索引为$g=2$。\n- 总中子通量为 $\\Phi = \\phi_{1} + \\phi_{2}$，通量份额为 $f_{1} = \\phi_{1}/\\Phi$ 和 $f_{2} = \\phi_{2}/\\Phi$。\n- 对于此PHWR能谱，热群的通量份额为 $f_{1} = 0.78$，超热-快中子群的通量份额为 $f_{2} = 0.22$，因此 $f_{1} + f_{2} = 1$。\n- $^{238}\\mathrm{U}$ 的能量相关微观俘获截面，记为 $\\sigma_{\\gamma}(E)$，在双群模型中由自屏的群常数值表示：热群为 $\\sigma_{\\gamma,1} = 2.70 \\ \\mathrm{b}$，超热-快中子群为 $\\sigma_{\\gamma,2} = 8.20 \\ \\mathrm{b}$，其中 $\\mathrm{b}$ 表示靶恩。\n\n从每个靶核的反应率（用能量相关的中子通量和截面表示）的定义出发，并且不使用任何快捷公式，推导出一个有效微观俘获截面 $\\sigma_{\\gamma,\\mathrm{eff}}$ 的表达式，该表达式在双群近似下能保持总俘获反应率不变。然后，使用所提供的数据计算 $\\sigma_{\\gamma,\\mathrm{eff}}$。\n\n最终答案以靶恩为单位，并四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它科学上基于核反应堆物理原理，提法恰当且有唯一解，并用客观、无歧义的语言表达。所有必要数据均已提供且物理上一致。\n\n目标是推导并计算$^{238}\\mathrm{U}$的能谱平均有效微观俘获截面，记为 $\\sigma_{\\gamma,\\mathrm{eff}}$。推导必须从反应率的基本定义开始。\n\n对于一个由能量相关的微观截面 $\\sigma(E)$ 表征、在能量相关的中子通量 $\\phi(E)$ 中发生的过程，其每个靶核的反应率 $R$ 由对所有能量的积分定义：\n$$R = \\int_{0}^{\\infty} \\sigma(E) \\phi(E) dE$$\n在这个问题中，我们关注的反应是$^{238}\\mathrm{U}$的中子俘获，所以 $\\sigma(E)$ 是俘获截面 $\\sigma_{\\gamma}(E)$。\n\n双群近似将能量域划分为两个不相交的区间：热群（$g=1$）和超热-快中子群（$g=2$）。总反应率是各群反应率之和：\n$$R = \\int_{\\text{group 1}} \\sigma_{\\gamma}(E) \\phi(E) dE + \\int_{\\text{group 2}} \\sigma_{\\gamma}(E) \\phi(E) dE$$\n群平均（或群常数）截面被定义为保持各群内部的反应率不变。第 $g$ 群的群平均截面 $\\sigma_{\\gamma,g}$ 定义为该群的反应率除以该群的总通量。第 $g$ 群的总通量为 $\\phi_g = \\int_{\\text{group } g} \\phi(E) dE$。\n因此，群平均截面为：\n$$\\sigma_{\\gamma,g} = \\frac{\\int_{\\text{group } g} \\sigma_{\\gamma}(E) \\phi(E) dE}{\\int_{\\text{group } g} \\phi(E) dE} = \\frac{\\int_{\\text{group } g} \\sigma_{\\gamma}(E) \\phi(E) dE}{\\phi_g}$$\n根据这个定义，每个群的反应率积分可以表示为群平均截面和群通量的乘积：\n$$\\int_{\\text{group } g} \\sigma_{\\gamma}(E) \\phi(E) dE = \\sigma_{\\gamma,g} \\phi_g$$\n将此应用于双群模型，每个核的总反应率可以写为：\n$$R = \\sigma_{\\gamma,1} \\phi_1 + \\sigma_{\\gamma,2} \\phi_2$$\n问题要求找到一个有效单群截面 $\\sigma_{\\gamma,\\mathrm{eff}}$，当它乘以总中子通量 $\\Phi$ 时，能保持总反应率不变。总通量是各群通量之和：$\\Phi = \\phi_1 + \\phi_2$。保持反应率不变的条件是：\n$$R = \\sigma_{\\gamma,\\mathrm{eff}} \\Phi$$\n通过令总反应率 $R$ 的两个表达式相等，我们得到：\n$$\\sigma_{\\gamma,\\mathrm{eff}} \\Phi = \\sigma_{\\gamma,1} \\phi_1 + \\sigma_{\\gamma,2} \\phi_2$$\n解出 $\\sigma_{\\gamma,\\mathrm{eff}}$ 可得：\n$$\\sigma_{\\gamma,\\mathrm{eff}} = \\frac{\\sigma_{\\gamma,1} \\phi_1 + \\sigma_{\\gamma,2} \\phi_2}{\\Phi} = \\sigma_{\\gamma,1} \\left(\\frac{\\phi_1}{\\Phi}\\right) + \\sigma_{\\gamma,2} \\left(\\frac{\\phi_2}{\\Phi}\\right)$$\n括号中的项是每个群的通量份额，$f_g = \\phi_g / \\Phi$。代入这些定义，即可得到有效截面的期望表达式：\n$$\\sigma_{\\gamma,\\mathrm{eff}} = \\sigma_{\\gamma,1} f_1 + \\sigma_{\\gamma,2} f_2$$\n该方程表明，有效微观截面是各群微观截面以各自群通量份额为权重的加权平均值。这就是所要求的推导出的表达式。\n\n现在，我们将给定的数值代入此表达式中。给定的数值如下：\n- 热群通量份额：$f_1 = 0.78$\n- 超热-快中子群通量份额：$f_2 = 0.22$\n- 热群俘获截面：$\\sigma_{\\gamma,1} = 2.70 \\ \\mathrm{b}$\n- 超热-快中子群俘获截面：$\\sigma_{\\gamma,2} = 8.20 \\ \\mathrm{b}$\n\n计算如下：\n$$\\sigma_{\\gamma,\\mathrm{eff}} = (2.70 \\ \\mathrm{b}) \\times 0.78 + (8.20 \\ \\mathrm{b}) \\times 0.22$$\n$$\\sigma_{\\gamma,\\mathrm{eff}} = 2.106 \\ \\mathrm{b} + 1.804 \\ \\mathrm{b}$$\n$$\\sigma_{\\gamma,\\mathrm{eff}} = 3.910 \\ \\mathrm{b}$$\n问题要求最终答案以靶恩为单位，并四舍五入到四位有效数字。计算值 $3.910$ 四舍五入到四位有效数字是 $3.910$。\n因此，$^{238}\\mathrm{U}$ 的有效微观俘获截面为 $3.910 \\ \\mathrm{b}$。",
            "answer": "$$\\boxed{3.910}$$"
        },
        {
            "introduction": "在使用数值求解器处理大型复杂系统之前，理解简单衰变链的解析行为至关重要。本练习要求您从基本的微分方程出发，推导出具有分支衰变的衰变链中子核素的瞬时核素数量。掌握此推导过程能让您深刻理解贝特曼方程的结构以及生成与衰变之间的相互作用。",
            "id": "4227408",
            "problem": "考虑一个核反应堆模拟中的辐照后冷却步骤，其中嬗变模型必须考虑一种具有多种自发衰变通道的放射性核素。请从第一性原理出发，定义分支衰变的概念，然后利用一级动力学构建其中一个子核素随时间变化的存量。具体来说，设母核素 $A$ 经由两个相互排斥的衰变通道衰变为不同的子核素 $B$ 和 $C$，其分衰变常数分别为 $\\lambda_{A \\to B}$ 和 $\\lambda_{A \\to C}$。$A$ 的总衰变常数为 $\\lambda_{A} = \\lambda_{A \\to B} + \\lambda_{A \\to C}$。分支比定义为 $r_{B} = \\lambda_{A \\to B}/\\lambda_{A}$ 和 $r_{C} = \\lambda_{A \\to C}/\\lambda_{A}$，且 $r_{B} + r_{C} = 1$。生成后，$B$ 和 $C$ 各自独立地衰变为其自身的稳定产物，衰变常数分别为 $\\lambda_{B}$ 和 $\\lambda_{C}$，且 $B$ 和 $C$ 均不回馈生成 $A$ 或彼此。假设系统对这些核素是封闭的，并且在冷却步骤中没有 $A$、$B$ 或 $C$ 的外部来源。\n\n从 $N_{A}(0) = N_{0}$ 和 $N_{B}(0) = N_{C}(0) = 0$ 出发，并假设 $\\lambda_{B} \\neq \\lambda_{A}$，请推导子核素 $B$ 的原子数随时间变化的表达式 $N_{B}(t)$，用 $N_{0}$、$\\lambda_{A}$、$\\lambda_{B}$ 和 $r_{B}$ 表示。你的推导必须从作为一阶常微分方程（ODE）的放射性衰变基本定律开始，并通过数学上有效的步骤进行，不得引用任何预先给出的贝特曼（Bateman）结果的闭式解。请将你的最终答案表示为单个闭式解析表达式。最终表达式中不要包含单位。",
            "solution": "该问题是有效的，因为它在科学上基于放射性衰变原理，问题设定良好，信息充分且一致，并且陈述客观。推导过程按要求从第一性原理开始。\n\n分支衰变是一种现象，指单个放射性核素具有多种相互排斥的衰变模式，每种模式都会产生不同的子核素。整个衰变过程遵循一级动力学。母核素原子数 $N_A(t)$ 的变化率与时间 $t$ 时存在的原子数成正比。比例常数是总衰变常数 $\\lambda_A$。该总衰变常数是与每个衰变通道相关的分衰变常数之和。对于给定问题，母核素 $A$ 衰变为子核素 $B$ 或子核素 $C$。$A \\to B$ 通道的分衰变常数是 $\\lambda_{A \\to B}$，而 $A \\to C$ 通道的分衰变常数是 $\\lambda_{A \\to C}$。总衰变常数为 $\\lambda_A = \\lambda_{A \\to B} + \\lambda_{A \\to C}$。\n\n核素 $A$ 的消耗速率由以下一阶常微分方程（ODE）描述：\n$$\n\\frac{dN_A(t)}{dt} = -\\lambda_A N_A(t)\n$$\n这是一个可分离变量的微分方程，可以通过积分求解。\n$$\n\\int_{N_A(0)}^{N_A(t)} \\frac{dN_A}{N_A} = \\int_{0}^{t} -\\lambda_A dt'\n$$\n对两边积分得到：\n$$\n\\ln\\left(\\frac{N_A(t)}{N_A(0)}\\right) = -\\lambda_A t\n$$\n使用初始条件 $N_A(0) = N_0$，我们得到核素 $A$ 的原子数随时间变化的表达式：\n$$\nN_A(t) = N_0 \\exp(-\\lambda_A t)\n$$\n子核素 $B$ 的原子数 $N_B(t)$ 的变化率由其从 $A$ 衰变生成的速率和其自身的衰变速率共同决定。$B$ 的生成速率是 $A$ 特定地衰变为 $B$ 的速率，由 $\\lambda_{A \\to B} N_A(t)$ 给出。$B$ 的衰变速率是 $\\lambda_B N_B(t)$。因此，描述 $N_B(t)$ 的控制性常微分方程是：\n$$\n\\frac{dN_B(t)}{dt} = \\lambda_{A \\to B} N_A(t) - \\lambda_B N_B(t)\n$$\n利用分支比的定义 $r_B = \\lambda_{A \\to B} / \\lambda_A$，我们可以写出 $\\lambda_{A \\to B} = r_B \\lambda_A$。将此式以及 $N_A(t)$ 的表达式代入 $N_B(t)$ 的常微分方程中：\n$$\n\\frac{dN_B(t)}{dt} = r_B \\lambda_A \\left( N_0 \\exp(-\\lambda_A t) \\right) - \\lambda_B N_B(t)\n$$\n这是一个线性一阶常微分方程。我们将其整理为标准形式 $y' + p(t)y = q(t)$：\n$$\n\\frac{dN_B(t)}{dt} + \\lambda_B N_B(t) = r_B \\lambda_A N_0 \\exp(-\\lambda_A t)\n$$\n为了解这个方程，我们使用积分因子法。积分因子 $I(t)$ 由下式给出：\n$$\nI(t) = \\exp\\left(\\int \\lambda_B dt\\right) = \\exp(\\lambda_B t)\n$$\n将整个常微分方程乘以 $I(t)$：\n$$\n\\exp(\\lambda_B t) \\frac{dN_B(t)}{dt} + \\lambda_B \\exp(\\lambda_B t) N_B(t) = \\exp(\\lambda_B t) \\left( r_B \\lambda_A N_0 \\exp(-\\lambda_A t) \\right)\n$$\n左边是乘积 $N_B(t) I(t)$ 的导数：\n$$\n\\frac{d}{dt}\\left[ N_B(t) \\exp(\\lambda_B t) \\right] = r_B \\lambda_A N_0 \\exp((\\lambda_B - \\lambda_A)t)\n$$\n我们对两边从 $0$ 到 $t$ 进行时间积分：\n$$\n\\int_{0}^{t} \\frac{d}{dt'}\\left[ N_B(t') \\exp(\\lambda_B t') \\right] dt' = \\int_{0}^{t} r_B \\lambda_A N_0 \\exp((\\lambda_B - \\lambda_A)t') dt'\n$$\n$$\n\\left[ N_B(t') \\exp(\\lambda_B t') \\right]_{0}^{t} = r_B \\lambda_A N_0 \\left[ \\frac{\\exp((\\lambda_B - \\lambda_A)t')}{\\lambda_B - \\lambda_A} \\right]_{0}^{t}\n$$\n该积分是有效的，因为问题指明了 $\\lambda_B \\neq \\lambda_A$，所以分母 $\\lambda_B - \\lambda_A$ 不为零。计算定积分：\n$$\nN_B(t) \\exp(\\lambda_B t) - N_B(0) \\exp(0) = \\frac{r_B \\lambda_A N_0}{\\lambda_B - \\lambda_A} \\left( \\exp((\\lambda_B - \\lambda_A)t) - \\exp(0) \\right)\n$$\n使用初始条件 $N_B(0) = 0$：\n$$\nN_B(t) \\exp(\\lambda_B t) = \\frac{r_B \\lambda_A N_0}{\\lambda_B - \\lambda_A} \\left( \\exp((\\lambda_B - \\lambda_A)t) - 1 \\right)\n$$\n为了分离出 $N_B(t)$，我们将两边乘以 $\\exp(-\\lambda_B t)$：\n$$\nN_B(t) = \\frac{r_B \\lambda_A N_0}{\\lambda_B - \\lambda_A} \\left( \\exp((\\lambda_B - \\lambda_A)t) - 1 \\right) \\exp(-\\lambda_B t)\n$$\n最后，将 $\\exp(-\\lambda_B t)$ 项分配到括号内，得到核素 $B$ 的原子数随时间变化的闭式解：\n$$\nN_B(t) = \\frac{r_B \\lambda_A N_0}{\\lambda_B - \\lambda_A} \\left( \\exp(-\\lambda_A t) - \\exp(-\\lambda_B t) \\right)\n$$\n此表达式仅依赖于初始母核原子数 $N_0$、衰变常数 $\\lambda_A$ 和 $\\lambda_B$ 以及分支比 $r_B$，符合要求。",
            "answer": "$$\n\\boxed{\\frac{r_{B} \\lambda_{A} N_{0}}{\\lambda_{B} - \\lambda_{A}} \\left( \\exp(-\\lambda_{A} t) - \\exp(-\\lambda_{B} t) \\right)}\n$$"
        },
        {
            "introduction": "现实世界中的核素嬗变网络涉及数十甚至数百种核素，这使得直接解析求解变得不切实际。这项计算练习要求您实现并比较三种求解锕系元素链的方法：精确的矩阵指数法、稳定的隐式欧拉法和近似的嬗变轨迹分析法。通过分析它们的准确性和计算成本，您将获得在为刚性常微分方程系统选择数值求解器时进行权衡取舍的实践经验，这是燃料循环模拟中的一项常见任务。",
            "id": "4227484",
            "problem": "您需要实现并比较三种用于求解锕系元素在辐照下演化的恒定速率嬗变网络的数值策略：矩阵指数法、嬗变轨迹分析（TTA）法和隐式欧拉时间积分法。此比较必须在一个统一、明确定义的成本模型下，评估其准确性和计算成本，而非依赖于运行时测量。\n\n该模型的基础是放射性衰变定律和中子诱发反应率的定义。具体来说，请使用以下基于物理和数值事实的依据：\n- 具有衰变常数 $\\lambda$ 的核素的放射性衰变遵循 $\\dfrac{dN}{dt} = -\\lambda N$，其中 $N$ 是原子数。\n- 在恒定中子通量 $\\phi$ 下，中子誘发反应率 $r$ 为 $r = \\phi \\sigma$，其中 $\\sigma$ 是以 $\\mathrm{cm}^2$ 为单位的微观截面，$\\phi$ 的单位是 $\\mathrm{n}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$。\n- 具有恒定速率的嬗变网络可建模为一个线性时不变系统 $\\dfrac{d\\mathbf{N}}{dt} = A \\mathbf{N}$，其中 $A$ 是由反应速率和衰变速率决定的常系数矩阵。\n\n考虑以下在恒定辐照下的锕系元素链，其核素排序为 $[{}^{238}\\mathrm{U}, {}^{239}\\mathrm{U}, {}^{239}\\mathrm{Np}, {}^{239}\\mathrm{Pu}, {}^{240}\\mathrm{Pu}]$：\n- ${}^{238}\\mathrm{U}$ 经中子俘获转变为 ${}^{239}\\mathrm{U}$，速率为 $\\lambda_1 = \\phi \\sigma_{{}^{238}\\mathrm{U},\\gamma}$。\n- ${}^{239}\\mathrm{U}$ $\\beta$衰变为 ${}^{239}\\mathrm{Np}$，衰变常数为 $\\lambda_2$。\n- ${}^{239}\\mathrm{Np}$ $\\beta$衰变为 ${}^{239}\\mathrm{Pu}$，衰变常数为 $\\lambda_3$。\n- ${}^{239}\\mathrm{Pu}$ 经中子俘获转变为 ${}^{240}\\mathrm{Pu}$，速率为 $\\lambda_4 = \\phi \\sigma_{{}^{239}\\mathrm{Pu},\\gamma}$。\n- ${}^{240}\\mathrm{Pu}$ 在所关注的时间尺度上被认为是稳定的，移除速率为 $\\lambda_5 = 0$。\n\n设中子通量为 $\\phi = 10^{14}\\,\\mathrm{n}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$（稳态），${}^{238}\\mathrm{U}$ 的微观俘获截面为 $\\sigma_{{}^{238}\\mathrm{U},\\gamma} = 2.68\\,\\mathrm{b} = 2.68 \\times 10^{-24}\\,\\mathrm{cm}^2$，${}^{239}\\mathrm{Pu}$ 的为 $\\sigma_{{}^{239}\\mathrm{Pu},\\gamma} = 300\\,\\mathrm{b} = 3.00 \\times 10^{-22}\\,\\mathrm{cm}^2$。使用半衰期 $t_{1/2}({}^{239}\\mathrm{U}) = 23.5\\,\\mathrm{min} = 1410\\,\\mathrm{s}$ 和 $t_{1/2}({}^{239}\\mathrm{Np}) = 2.356\\,\\mathrm{days} = 203{,}558.4\\,\\mathrm{s}$，这些核素的衰变常数 $\\lambda = \\dfrac{\\ln 2}{t_{1/2}}$。因此，速率的数值为：\n- $\\lambda_1 = 10^{14} \\times 2.68 \\times 10^{-24} = 2.68 \\times 10^{-10}\\,\\mathrm{s}^{-1}$，\n- $\\lambda_2 = \\dfrac{\\ln 2}{1410} \\,\\mathrm{s}^{-1}$，\n- $\\lambda_3 = \\dfrac{\\ln 2}{203{,}558.4} \\,\\mathrm{s}^{-1}$，\n- $\\lambda_4 = 10^{14} \\times 3.00 \\times 10^{-22} = 3.00 \\times 10^{-8}\\,\\mathrm{s}^{-1}$，\n- $\\lambda_5 = 0$。\n\n根据该链的质量平衡构建系数矩阵 $A \\in \\mathbb{R}^{5\\times 5}$：\n- $\\dfrac{dN_1}{dt} = -\\lambda_1 N_1$，\n- $\\dfrac{dN_2}{dt} = \\lambda_1 N_1 - \\lambda_2 N_2$，\n- $\\dfrac{dN_3}{dt} = \\lambda_2 N_2 - \\lambda_3 N_3$，\n- $\\dfrac{dN_4}{dt} = \\lambda_3 N_3 - \\lambda_4 N_4$，\n- $\\dfrac{dN_5}{dt} = \\lambda_4 N_4 - \\lambda_5 N_5$，其中 $\\lambda_5 = 0$。\n\n初始库存被归一化为一个无量纲的分数向量 $\\mathbf{N}(0) = [1, 0, 0, 0, 0]^\\top$，表示一个单位的 ${}^{238}\\mathrm{U}$ 和零单位的其他核素。所有输出必须是相对于此初始量的无量纲库存分数，且误差必须是无量纲范数。\n\n您必须实现三种求解方法：\n1. 矩阵指数法：使用可信的数值线性代数程序，计算常数 $A$ 下的精确解 $\\mathbf{N}(t) = \\exp(At)\\,\\mathbf{N}(0)$。\n2. 针对刚性常微分方程（ODEs）的隐式欧拉法：对于时间步长 $\\Delta t$，通过 $\\mathbf{N}_{k+1} = \\left(I - \\Delta t\\, A\\right)^{-1}\\mathbf{N}_k$ 进行演化，其中 $k = 0, 1, \\dots$，直到最终时间 $t$。\n3. 嬗变轨迹分析（TTA）法：通过对从 ${}^{238}\\mathrm{U}$ 开始到每个核素结束的序贯反应/衰变轨迹的贡献求和来近似求解，截断于最大路径长度 $K$。对于此线性链，长度为 $p$ 的路径到达索引为 $p+1$ 的核素。在 $K$ 处截断仅包括对索引最高为 $K+1$ 的核素的贡献，更深层的核素设置为零。将底层速率视为常数且各不相同。\n\n将方法 $M$ 在时间 $t$ 的准确度定义为欧几里得范数 $||\\mathbf{N}_{\\mathrm{exp}}(t) - \\mathbf{N}_M(t)||_2$，其中 $\\mathbf{N}_{\\mathrm{exp}}(t)$ 来自被视为参考的矩阵指数法。\n\n定义一个计算成本代理模型，以抽象的稠密线性代数运算单元度量，如下所示：\n- 对于矩阵指数法，$\\mathrm{cost}_{\\exp} = 10\\, n^3$，其中 $n = 5$。\n- 对于隐式欧拉法，$\\mathrm{cost}_{\\mathrm{IE}} = n^3 + s\\, n^2$，其中 $s = \\left\\lceil \\dfrac{t}{\\Delta t} \\right\\rceil$ 是步数，$n = 5$。\n- 对于截断级别为 $K$ 的TTA法，设 $m = \\min(n, K+1)$ 是包含的核素数量。每个包含的核素需要评估 $m$ 个轨迹项。因此，$\\mathrm{cost}_{\\mathrm{TTA}} = \\sum_{j=1}^{m} j = \\dfrac{m(m+1)}{2}$。\n\n您的程序必须为以下测试套件实现上述内容，涵盖短时辐照、中等时长案例和长时边缘案例。所有时间单位为秒，所有输出必须是无量纲的浮点数或整数：\n- 测试用例 1：$t = 3600$, $\\Delta t = 600$, $K = 2$。\n- 测试用例 2：$t = 10^6$, $\\Delta t = 10^4$, $K = 3$。\n- 测试用例 3：$t = 10^7$, $\\Delta t = 10^5$, $K = 4$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表被方括号包围，每个元素对应一个测试用例，并按指定顺序排列（例如，$[[\\dots], [\\dots], [\\dots]]$）。不允许外部输入，程序必须是自包含的。物理值仅出现在速率常数和时间中；所有输出都是无量纲的。不要对输出进行四舍五入；请使用编程语言的默认数值字符串表示。",
            "solution": "该问题要求实现并比较三种用于求解恒定中子通量下简化锕系元素嬗变链的数值方法。这些方法是矩阵指数法、隐式欧拉积分法和一种称为嬗变轨迹分析（TTA）的截断解析解法。比较基于相对于参考解的准确度和一个预定义的计算成本模型。\n\n该问题首先建立了一个常系数线性一阶常微分方程（ODE）组，这是在反应率不随时间变化的核素库存演化的标准模型。该系统以矩阵形式表示为 $\\dfrac{d\\mathbf{N}}{dt} = A \\mathbf{N}(t)$，其中 $\\mathbf{N}(t)$ 是核素浓度向量，$A$ 是嬗变矩阵。\n\n**系统构建**\n\n嬗变链涉及 $n=5$ 个核素，排序为 $\\mathbf{N} = [N_{^{238}\\mathrm{U}}, N_{^{239}\\mathrm{U}}, N_{^{239}\\mathrm{Np}}, N_{^{239}\\mathrm{Pu}}, N_{^{240}\\mathrm{Pu}}]^\\top$。每个核素浓度 $N_i$ 的演化由一个质量平衡方程控制：\n\n$\\dfrac{dN_1}{dt} = -\\lambda_1 N_1$\n$\\dfrac{dN_2}{dt} = +\\lambda_1 N_1 - \\lambda_2 N_2$\n$\\dfrac{dN_3}{dt} = +\\lambda_2 N_2 - \\lambda_3 N_3$\n$\\dfrac{dN_4}{dt} = +\\lambda_3 N_3 - \\lambda_4 N_4$\n$\\dfrac{dN_5}{dt} = +\\lambda_4 N_4 - \\lambda_5 N_5$\n\n其中速率 $\\lambda_i$ 是给定的常数。这些速率由物理数据计算得出：中子俘获率是恒定通量 $\\phi$ 和微观截面 $\\sigma$ 的乘积，而衰变率则由半衰期 $t_{1/2}$ 使用 $\\lambda = \\dfrac{\\ln 2}{t_{1/2}}$ 推导。提供的值为：\n- $\\lambda_1 = \\phi \\sigma_{{}^{238}\\mathrm{U},\\gamma} = (10^{14}\\,\\mathrm{n}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}) \\times (2.68 \\times 10^{-24}\\,\\mathrm{cm}^2) = 2.68 \\times 10^{-10}\\,\\mathrm{s}^{-1}$\n- $\\lambda_2 = \\dfrac{\\ln 2}{1410\\,\\mathrm{s}} \\approx 4.9159 \\times 10^{-4}\\,\\mathrm{s}^{-1}$\n- $\\lambda_3 = \\dfrac{\\ln 2}{203558.4\\,\\mathrm{s}} \\approx 3.4054 \\times 10^{-6}\\,\\mathrm{s}^{-1}$\n- $\\lambda_4 = \\phi \\sigma_{{}^{239}\\mathrm{Pu},\\gamma} = (10^{14}\\,\\mathrm{n}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}) \\times (3.00 \\times 10^{-22}\\,\\mathrm{cm}^2) = 3.00 \\times 10^{-8}\\,\\mathrm{s}^{-1}$\n- $\\lambda_5 = 0\\,\\mathrm{s}^{-1}$ (对于稳定产物 ${}^{240}\\mathrm{Pu}$)\n\n这些方程映射到嬗变矩阵 $A \\in \\mathbb{R}^{5\\times 5}$ 如下：\n$$\nA = \\begin{pmatrix}\n-\\lambda_1  & 0  & 0  & 0  & 0 \\\\\n\\lambda_1  & -\\lambda_2  & 0  & 0  & 0 \\\\\n0  & \\lambda_2  & -\\lambda_3  & 0  & 0 \\\\\n0  & 0  & \\lambda_3  & -\\lambda_4  & 0 \\\\\n0  & 0  & 0  & \\lambda_4  & -\\lambda_5\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-2.68 \\times 10^{-10}  & 0  & 0  & 0  & 0 \\\\\n2.68 \\times 10^{-10}  & -\\frac{\\ln 2}{1410}  & 0  & 0  & 0 \\\\\n0  & \\frac{\\ln 2}{1410}  & -\\frac{\\ln 2}{203558.4}  & 0  & 0 \\\\\n0  & 0  & \\frac{\\ln 2}{203558.4}  & -3.00 \\times 10^{-8}  & 0 \\\\\n0  & 0  & 0  & 3.00 \\times 10^{-8}  & 0\n\\end{pmatrix}\n$$\n初始条件为纯 ${}^{238}\\mathrm{U}$ 库存，由向量 $\\mathbf{N}(0) = [1, 0, 0, 0, 0]^\\top$ 给出。\n\n**方法论**\n\n实现了三种方法来求解初始值问题 $\\dfrac{d\\mathbf{N}}{dt} = A\\mathbf{N}$ 与 $\\mathbf{N}(0)$。\n\n1.  **矩阵指数法（参考解）**\n    对于线性时不变系统，精确解由矩阵指数给出：\n    $$\n    \\mathbf{N}(t) = e^{At} \\mathbf{N}(0)\n    $$\n    此方法提供了基准或参考解，用于与其他方法进行比较。矩阵指数 $e^{At}$ 使用高保真数值库例程（`scipy.linalg.expm`）计算，该例程通常采用如Padé近似等方法。\n\n2.  **隐式欧拉法**\n    对于以速率 $\\lambda_i$ 的时间尺度差异巨大为特征的刚性常微分方程组，隐式方法因其数值稳定性而更受青睐。隐式欧拉法将时间域离散为大小为 $\\Delta t$ 的步长。时间步 $k+1$ 的解通过求解以下方程找到：\n    $$\n    \\frac{\\mathbf{N}_{k+1} - \\mathbf{N}_k}{\\Delta t} = A \\mathbf{N}_{k+1}\n    $$\n    整理方程以求解 $\\mathbf{N}_{k+1}$ 得到时间步进公式：\n    $$\n    (I - \\Delta t A) \\mathbf{N}_{k+1} = \\mathbf{N}_k \\implies \\mathbf{N}_{k+1} = (I - \\Delta t A)^{-1} \\mathbf{N}_k\n    $$\n    其中 $I$ 是单位矩阵。从 $\\mathbf{N}_0 = \\mathbf{N}(0)$ 开始，此公式被迭代应用 $s = t/\\Delta t$ 步，以求得最终时间 $t$ 的解。矩阵 $(I - \\Delta t A)^{-1}$ 只计算一次，并在每个步骤中重复使用。\n\n3.  **嬗变轨迹分析法（TTA）**\n    TTA是一种基于线性衰变链解析解（即Bateman方程）的近似方法。对于仅从第一个核素开始的链（$N_1(0)=1$），第 $i$ 个核素在时间 $t$ 的浓度为：\n    $$\n    N_i(t) = \\left(\\prod_{j=1}^{i-1} \\lambda'_j\\right) \\sum_{k=1}^{i} \\frac{e^{-\\lambda''_k t}}{\\prod_{j=1, j \\ne k}^{i} (\\lambda''_j - \\lambda''_k)}\n    $$\n    此处，$\\lambda'_j$ 是从核素 $j$ 转移到 $j+1$ 的速率，而 $\\lambda''_k$ 是核素 $k$ 的总移除速率常数。对于指定的问题，对于 $k=1, \\dots, 4$，两者都对应于 $\\lambda_k$，且 $\\lambda''_5 = \\lambda_5 = 0$。\n    TTA方法通过在最大路径长度 $K$ 处截断链条来近似完整解。长度为 $p$ 的路径到达核素 $p+1$。因此，对于给定的 $K$，仅使用Bateman公式计算前 $m = \\min(n, K+1)$ 个核素的浓度。所有后续核素（从 $m+1$ 到 $n=5$）的浓度均设置为零。\n\n**准确度与成本评估**\n隐式欧拉法和TTA法的准确性通过它们的解向量与参考矩阵指数解在时间 $t$ 的差的欧几里得范数（$L_2$范数）来衡量：\n$E_M = ||\\mathbf{N}_{\\mathrm{exp}}(t) - \\mathbf{N}_M(t)||_2$。\n\n计算成本代理模型以抽象的浮点运算来定义：\n-   矩阵指数法：$\\mathrm{cost}_{\\exp} = 10 n^3$。对于 $n=5$，即 $10 \\times 5^3 = 1250$。\n-   隐式欧拉法：$\\mathrm{cost}_{\\mathrm{IE}} = n^3 + s \\cdot n^2$，其中 $s$ 是时间步数。这包括一次矩阵求逆（$O(n^3)$）和 $s$ 次矩阵-向量乘法（$O(n^2)$）。\n-   TTA法：$\\mathrm{cost}_{\\mathrm{TTA}} = \\sum_{j=1}^{m} j = \\frac{m(m+1)}{2}$。这反映了对于达到截断极限 $m$ 的每个连续核素，Bateman求和中的项数不断增加。\n\n**实现**\n程序为每个提供的测试用例实现了这三种方法。它首先计算速率常数并构建矩阵 $A$。然后，对于给定的测试用例 $(t, \\Delta t, K)$，它计算三个解向量 $\\mathbf{N}_{\\mathrm{exp}}(t)$、$\\mathbf{N}_{\\mathrm{IE}}(t)$ 和 $\\mathbf{N}_{\\mathrm{TTA}}(t)$。最后，根据定义的模型计算误差 $E_{\\mathrm{IE}}$ 和 $E_{\\mathrm{TTA}}$ 以及成本 $C_{\\mathrm{exp}}$、$C_{\\mathrm{IE}}$ 和 $C_{\\mathrm{TTA}}$。所有测试用例的结果被收集并格式化为指定的输出结构。对于测试用例3（$K=4$），TTA方法计算所有5个核素，使其等同于完整的解析解，因此其相对于矩阵指数解的误差预计接近机器精度。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Implements and compares matrix exponential, implicit Euler, and TTA methods\n    for a simplified actinide transmutation chain.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (t, dt, K)\n        (3600.0, 600.0, 2),\n        (1_000_000.0, 10_000.0, 3),\n        (10_000_000.0, 100_000.0, 4),\n    ]\n\n    # Physical constants\n    ln2 = np.log(2)\n    t_half_U239 = 1410.0  # s\n    t_half_Np239 = 203558.4  # s\n\n    # Rate constants (lambda) in s^-1\n    lambda_1 = 2.68e-10  # U238(n,g) -> U239\n    lambda_2 = ln2 / t_half_U239  # U239 -> Np239 (beta decay)\n    lambda_3 = ln2 / t_half_Np239  # Np239 -> Pu239 (beta decay)\n    lambda_4 = 3.00e-8    # Pu239(n,g) -> Pu240\n    lambda_5 = 0.0       # Pu240 removal rate\n\n    # The effective decay rates for the Bateman equation are the total removal rates\n    # for each nuclide, which are the magnitudes of the diagonal elements of A.\n    L_decay = np.array([lambda_1, lambda_2, lambda_3, lambda_4, lambda_5])\n    # The transfer rates for the Bateman equation are the off-diagonal production terms.\n    L_transfer = np.array([lambda_1, lambda_2, lambda_3, lambda_4])\n\n    n = 5  # Number of species\n\n    # Transmutation matrix A\n    A = np.zeros((n, n))\n    A[0, 0] = -lambda_1\n    A[1, 0] = lambda_1\n    A[1, 1] = -lambda_2\n    A[2, 1] = lambda_2\n    A[2, 2] = -lambda_3\n    A[3, 2] = lambda_3\n    A[3, 3] = -lambda_4\n    A[4, 3] = lambda_4\n    A[4, 4] = -lambda_5\n    \n    # Initial conditions: pure U238\n    N0 = np.zeros(n)\n    N0[0] = 1.0\n\n    def bateman_solver(i, t, decay_rates, transfer_rates, N_initial=1.0):\n        \"\"\"\n        Calculates N_i(t) for a linear chain using the Bateman equation.\n        i: species index (1-based)\n        t: time\n        decay_rates: list of total removal rates for species 1 through i\n        transfer_rates: list of transfer rates lambda_{j->j+1} for j=1 to i-1\n        N_initial: initial amount of species 1\n        \"\"\"\n        if i == 1:\n            return N_initial * np.exp(-decay_rates[0] * t)\n        \n        prod_transfer = np.prod(transfer_rates[:i-1])\n        \n        sum_val = 0.0\n        for j in range(i):  # 0 to i-1\n            lj = decay_rates[j]\n            denom_prod = 1.0\n            for k in range(i):\n                if k != j:\n                    lk = decay_rates[k]\n                    denom_prod *= (lk - lj)\n            sum_val += np.exp(-lj * t) / denom_prod\n            \n        return N_initial * prod_transfer * sum_val\n\n    results = []\n    \n    for t, dt, K in test_cases:\n        # 1. Matrix Exponential (Reference)\n        At = A * t\n        N_exp = expm(At) @ N0\n\n        # 2. Implicit Euler\n        s = int(t / dt)\n        I = np.identity(n)\n        inv_matrix = np.linalg.inv(I - dt * A)\n        N_ie = N0.copy()\n        for _ in range(s):\n            N_ie = inv_matrix @ N_ie\n        \n        # 3. Transmutation Trajectory Analysis (TTA)\n        N_tta = np.zeros(n)\n        m = min(n, K + 1)\n        for i in range(1, m + 1):\n             N_tta[i - 1] = bateman_solver(i, t, L_decay[:i], L_transfer[:i-1], N_initial=N0[0])\n\n        # Accuracy calculations\n        E_ie = np.linalg.norm(N_exp - N_ie)\n        E_tta = np.linalg.norm(N_exp - N_tta)\n\n        # Cost calculations\n        C_exp = 10 * (n**3)\n        s_cost = np.ceil(t / dt)\n        C_ie = n**3 + s_cost * (n**2)\n        m_cost = min(n, K + 1)\n        C_tta = m_cost * (m_cost + 1) / 2\n\n        results.append([E_ie, E_tta, int(C_ie), int(C_tta), int(C_exp)])\n\n    # Format the final output string without extra spaces.\n    formatted_rows = []\n    for row in results:\n        # str(e) uses standard float-to-string conversion\n        formatted_row = f\"[{','.join(str(e) for e in row)}]\"\n        formatted_rows.append(formatted_row)\n    final_output = f\"[{','.join(formatted_rows)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}