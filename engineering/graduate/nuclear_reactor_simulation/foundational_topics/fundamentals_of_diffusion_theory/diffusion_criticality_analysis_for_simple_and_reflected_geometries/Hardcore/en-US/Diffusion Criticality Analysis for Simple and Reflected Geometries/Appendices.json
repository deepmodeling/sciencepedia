{
    "hands_on_practices": [
        {
            "introduction": "The neutron diffusion equation provides a powerful macroscopic model for reactor analysis, but its parameters are rooted in microscopic physics. This exercise connects these two scales by tasking you with calculating the diffusion coefficient, $D$, and the transport cross-section, $\\Sigma_{tr}$, from fundamental microscopic cross-section data for an anisotropically scattering medium. By performing this calculation , you will reinforce your understanding of how the $P_1$ approximation of the transport equation gives rise to the familiar form of Fick's law and its essential coefficients.",
            "id": "4221762",
            "problem": "A homogeneous, source-free, steady-state neutron field in a single energy group is modeled by the diffusion approximation derived from the first two angular moments of the steady-state linear Boltzmann transport equation. The material exhibits anisotropic scattering described by a Legendre polynomial expansion of the microscopic differential scattering cross section. The microscopic Legendre moments $\\sigma_{s,\\ell}$ are defined as the coefficients in the expansion with the conventional normalization used in neutron transport theory. A single material occupies the region, and its microscopic total cross section and microscopic scattering Legendre moments for this group are given by\n$$\\sigma_{t} = 6.0\\ \\mathrm{b}, \\quad \\sigma_{s,0} = 5.0\\ \\mathrm{b}, \\quad \\sigma_{s,1} = 0.90\\ \\mathrm{b}, \\quad \\sigma_{s,2} = 0.30\\ \\mathrm{b}, \\quad \\sigma_{s,3} = 0.050\\ \\mathrm{b},$$\nwhere $\\mathrm{b}$ denotes barns and $1\\ \\mathrm{b} = 10^{-24}\\ \\mathrm{cm}^{2}$. The atomic number density is\n$$N = 8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}.$$\nFrom first principles of the diffusion approximation constructed via the $P_{1}$ truncation of the angular flux and the associated moment equations, determine the macroscopic transport cross section $\\Sigma_{tr}$ and the diffusion coefficient $D$ for this energy group. Express $\\Sigma_{tr}$ in $\\mathrm{cm}^{-1}$ and $D$ in $\\mathrm{cm}$. Round your answers to $4$ significant figures.",
            "solution": "The problem requires the determination of the macroscopic transport cross section, $\\Sigma_{tr}$, and the diffusion coefficient, $D$, for a homogeneous, source-free medium based on the steady-state, one-group $P_1$ approximation of the neutron transport equation.\n\nThe $P_1$ approximation truncates the Legendre polynomial expansion of the angular neutron flux, $\\psi(\\mathbf{r}, \\mathbf{\\Omega})$, after the linear term:\n$$ \\psi(\\mathbf{r}, \\mathbf{\\Omega}) \\approx \\frac{1}{4\\pi} \\left[ \\phi(\\mathbf{r}) + 3 \\mathbf{\\Omega} \\cdot \\mathbf{J}(\\mathbf{r}) \\right] $$\nwhere $\\phi(\\mathbf{r})$ is the scalar flux (zeroth angular moment) and $\\mathbf{J}(\\mathbf{r})$ is the neutron current (first angular moment).\n\nThe derivation begins with the steady-state, one-group, source-free linear Boltzmann transport equation:\n$$ \\mathbf{\\Omega} \\cdot \\nabla \\psi(\\mathbf{r}, \\mathbf{\\Omega}) + \\Sigma_t \\psi(\\mathbf{r}, \\mathbf{\\Omega}) = \\int_{4\\pi} \\Sigma_s(\\mathbf{\\Omega}' \\to \\mathbf{\\Omega}) \\psi(\\mathbf{r}, \\mathbf{\\Omega}') d\\mathbf{\\Omega}' $$\nHere, $\\Sigma_t$ is the macroscopic total cross section, and $\\Sigma_s(\\mathbf{\\Omega}' \\to \\mathbf{\\Omega})$ is the differential scattering cross section.\n\nTo derive the diffusion approximation, we take the first two angular moments of this equation. The first moment (multiplying by $\\mathbf{\\Omega}$ and integrating over all solid angles $d\\mathbf{\\Omega}$) is the equation from which the diffusion coefficient is defined. The first moment of the transport term, $\\mathbf{\\Omega} \\cdot \\nabla \\psi$, is:\n$$ \\int_{4\\pi} \\mathbf{\\Omega} (\\mathbf{\\Omega} \\cdot \\nabla \\psi) d\\mathbf{\\Omega} = \\frac{1}{3} \\nabla \\phi(\\mathbf{r}) $$\nThe first moment of the total collision term, $\\Sigma_t \\psi$, is:\n$$ \\int_{4\\pi} \\mathbf{\\Omega} (\\Sigma_t \\psi) d\\mathbf{\\Omega} = \\Sigma_t \\mathbf{J}(\\mathbf{r}) $$\nThe first moment of the scattering source term is:\n$$ \\int_{4\\pi} \\mathbf{\\Omega} \\left[ \\int_{4\\pi} \\Sigma_s(\\mathbf{\\Omega}' \\to \\mathbf{\\Omega}) \\psi(\\mathbf{r}, \\mathbf{\\Omega}') d\\mathbf{\\Omega}' \\right] d\\mathbf{\\Omega} $$\nFor anisotropic scattering, the differential cross section is expanded in Legendre polynomials:\n$$ \\Sigma_s(\\mathbf{\\Omega}' \\to \\mathbf{\\Omega}) = \\sum_{\\ell=0}^{\\infty} \\frac{2\\ell+1}{4\\pi} \\Sigma_{s,\\ell} P_\\ell(\\mathbf{\\Omega} \\cdot \\mathbf{\\Omega}') $$\nwhere $\\Sigma_{s,\\ell}$ are the macroscopic Legendre moments of the scattering cross section. Substituting the $P_1$ expansion for $\\psi$ and the Legendre expansion for $\\Sigma_s$, and using the orthogonality properties of the Legendre and spherical harmonic polynomials, the first moment of the scattering source simplifies to:\n$$ \\int_{4\\pi} \\mathbf{\\Omega} \\left[ \\text{Scattering Source} \\right] d\\mathbf{\\Omega} = \\Sigma_{s,1} \\mathbf{J}(\\mathbf{r}) $$\nIt is critical to note that in the $P_1$ approximation, only the $\\ell=1$ moment of the scattering cross section, $\\Sigma_{s,1}$, contributes to the first moment equation. All higher-order moments ($\\ell \\ge 2$) have no effect.\n\nAssembling the terms for the first moment equation yields:\n$$ \\frac{1}{3} \\nabla \\phi(\\mathbf{r}) + \\Sigma_t \\mathbf{J}(\\mathbf{r}) = \\Sigma_{s,1} \\mathbf{J}(\\mathbf{r}) $$\nRearranging this equation to solve for the neutron current $\\mathbf{J}(\\mathbf{r})$ gives:\n$$ (\\Sigma_t - \\Sigma_{s,1}) \\mathbf{J}(\\mathbf{r}) = - \\frac{1}{3} \\nabla \\phi(\\mathbf{r}) $$\n$$ \\mathbf{J}(\\mathbf{r}) = - \\frac{1}{3(\\Sigma_t - \\Sigma_{s,1})} \\nabla \\phi(\\mathbf{r}) $$\nThis equation is Fick's Law of diffusion, $\\mathbf{J}(\\mathbf{r}) = -D \\nabla \\phi(\\mathbf{r})$. By comparison, we identify the diffusion coefficient $D$ and the macroscopic transport cross section $\\Sigma_{tr}$.\n\nThe macroscopic transport cross section, $\\Sigma_{tr}$, is defined as:\n$$ \\Sigma_{tr} = \\Sigma_t - \\Sigma_{s,1} $$\nThe diffusion coefficient, $D$, is then defined as:\n$$ D = \\frac{1}{3 \\Sigma_{tr}} = \\frac{1}{3(\\Sigma_t - \\Sigma_{s,1})} $$\n\nThe problem provides microscopic cross sections ($\\sigma$) and the atomic number density ($N$). Macroscopic cross sections ($\\Sigma$) are calculated via the relation $\\Sigma_x = N \\sigma_x$. The required values are:\nAtomic number density: $N = 8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}$\nMicroscopic total cross section: $\\sigma_t = 6.0\\ \\mathrm{b} = 6.0 \\times 10^{-24}\\ \\mathrm{cm}^2$\nMicroscopic first Legendre moment of scattering: $\\sigma_{s,1} = 0.90\\ \\mathrm{b} = 0.90 \\times 10^{-24}\\ \\mathrm{cm}^2$\n\nThe other given values, $\\sigma_{s,0}$, $\\sigma_{s,2}$, and $\\sigma_{s,3}$, are not required for the calculation of $\\Sigma_{tr}$ and $D$ within the standard $P_1$ framework.\n\nFirst, we calculate the macroscopic cross sections:\n$$ \\Sigma_t = N \\sigma_t = (8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}) \\times (6.0 \\times 10^{-24}\\ \\mathrm{cm}^2) = 0.48\\ \\mathrm{cm}^{-1} $$\n$$ \\Sigma_{s,1} = N \\sigma_{s,1} = (8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}) \\times (0.90 \\times 10^{-24}\\ \\mathrm{cm}^2) = 0.072\\ \\mathrm{cm}^{-1} $$\n\nNow, we can compute $\\Sigma_{tr}$:\n$$ \\Sigma_{tr} = \\Sigma_t - \\Sigma_{s,1} = 0.48\\ \\mathrm{cm}^{-1} - 0.072\\ \\mathrm{cm}^{-1} = 0.408\\ \\mathrm{cm}^{-1} $$\n\nFinally, we compute $D$:\n$$ D = \\frac{1}{3 \\Sigma_{tr}} = \\frac{1}{3 \\times 0.408\\ \\mathrm{cm}^{-1}} = \\frac{1}{1.224}\\ \\mathrm{cm} \\approx 0.81699346... \\ \\mathrm{cm} $$\n\nThe problem requires rounding the answers to $4$ significant figures.\n$\\Sigma_{tr} = 0.4080\\ \\mathrm{cm}^{-1}$\n$D = 0.8170\\ \\mathrm{cm}$\n\nTherefore, the macroscopic transport cross section is $0.4080\\ \\mathrm{cm}^{-1}$ and the diffusion coefficient is $0.8170\\ \\mathrm{cm}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4080  0.8170\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The criticality of a nuclear reactor is a balance between neutron production and loss, with leakage from the core's boundaries being a primary loss mechanism. This exercise explores the profound impact of boundary conditions on neutron leakage by analyzing a cylindrical reactor core. You will apply separation of variables to the diffusion equation to determine the geometric buckling, $B_g^2$, which quantifies leakage, and then calculate how this crucial parameter changes when the physical boundaries are switched from vacuum to perfectly reflecting . This practice directly links abstract mathematical boundary conditions to tangible physical effects on reactor behavior.",
            "id": "4221764",
            "problem": "A homogeneous, one-speed, bare right circular cylinder of radius $R$ and height $H$ is modeled with the steady-state neutron diffusion equation at criticality in the form of a homogeneous Helmholtz equation posed for the scalar neutron flux $\\phi(\\mathbf{r})$ in cylindrical coordinates $(r,\\theta,z)$ with azimuthal symmetry. The material is uniform, with transport mean free path $\\lambda_{tr}$, and all surfaces are either vacuum or perfectly reflecting. Adopt the standard diffusion-theory representation of a vacuum boundary as a zero-flux plane at an extrapolated distance $\\delta$ beyond the physical surface, with $\\delta=0.7104\\lambda_{tr}$. A perfectly reflecting surface is modeled as a zero-normal-current (Neumann) boundary at the physical surface.\n\nConsider two cases:\n- Case V: all physical surfaces are vacuum boundaries.\n- Case R: the curved lateral surface is vacuum, while the two planar end faces at $z=\\pm H/2$ are perfectly reflecting.\n\nUsing separation of variables and appropriate boundary conditions, determine how making the axial dimension reflective modifies the fundamental eigenvalue of the Laplacian operator, that is, the fundamental geometric buckling $B_{g}^{2}$, when transitioning from Case V to Case R. Specifically, compute the change $\\Delta B_{g}^{2} \\equiv B_{g,\\mathrm{R}}^{2} - B_{g,\\mathrm{V}}^{2}$ for a cylinder with $R = 0.40\\,\\mathrm{m}$, $H = 1.00\\,\\mathrm{m}$, and $\\lambda_{tr} = 0.030\\,\\mathrm{m}$. Express your final result in $\\mathrm{m}^{-2}$, and round your answer to four significant figures.",
            "solution": "The steady-state neutron diffusion equation for a critical, homogeneous system is the Helmholtz equation:\n$$\n\\nabla^2 \\phi(\\mathbf{r}) + B_g^2 \\phi(\\mathbf{r}) = 0\n$$\nwhere $\\phi$ is the neutron flux and $B_g^2$ is the geometric buckling. Given the azimuthal symmetry, the Laplacian operator in cylindrical coordinates $(r, z)$ is:\n$$\n\\nabla^2 = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial}{\\partial r}\\right) + \\frac{\\partial^2}{\\partial z^2}\n$$\nWe use separation of variables, assuming a solution of the form $\\phi(r,z) = \\mathcal{R}(r) \\mathcal{Z}(z)$. Substituting this into the Helmholtz equation and rearranging gives:\n$$\n\\frac{1}{r\\mathcal{R}(r)}\\frac{d}{dr}\\left(r\\frac{d\\mathcal{R}}{dr}\\right) + \\frac{1}{\\mathcal{Z}(z)}\\frac{d^2\\mathcal{Z}}{dz^2} + B_g^2 = 0\n$$\nThis separates into two ordinary differential equations, introducing separation constants $B_r^2$ (radial buckling) and $B_z^2$ (axial buckling):\n$$\n\\frac{1}{r\\mathcal{R}(r)}\\frac{d}{dr}\\left(r\\frac{d\\mathcal{R}}{dr}\\right) = -B_r^2 \\quad \\implies \\quad r^2\\frac{d^2\\mathcal{R}}{dr^2} + r\\frac{d\\mathcal{R}}{dr} + (B_r r)^2 \\mathcal{R} = 0\n$$\n$$\n\\frac{1}{\\mathcal{Z}(z)}\\frac{d^2\\mathcal{Z}}{dz^2} = -B_z^2 \\quad \\implies \\quad \\frac{d^2\\mathcal{Z}}{dz^2} + B_z^2 \\mathcal{Z} = 0\n$$\nThe geometric buckling is the sum of these components: $B_g^2 = B_r^2 + B_z^2$.\n\nThe solution to the radial equation that is finite at the origin ($r=0$) is the Bessel function of the first kind of order zero, $\\mathcal{R}(r) = A J_0(B_r r)$. The solution to the axial equation for the fundamental (spatially symmetric) mode is $\\mathcal{Z}(z) = C \\cos(B_z z)$.\n\n### Case V: All Surfaces are Vacuum Boundaries\nIn this case, zero-flux boundary conditions apply at the extrapolated surfaces.\nThe extrapolated radius is $\\tilde{R} = R + \\delta$. The boundary condition is $\\mathcal{R}(\\tilde{R}) = 0$.\n$$\nA J_0(B_r \\tilde{R}) = 0\n$$\nFor the fundamental mode, we take the first zero of the $J_0$ function, denoted by $j_{0,1} \\approx 2.4048$. Thus, $B_r \\tilde{R} = j_{0,1}$. The radial buckling for Case V is:\n$$\nB_{r,\\mathrm{V}}^2 = \\left(\\frac{j_{0,1}}{\\tilde{R}}\\right)^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2\n$$\nThe cylinder is centered at $z=0$, so its physical ends are at $z = \\pm H/2$. The extrapolated height is $\\tilde{H} = H + 2\\delta$. The zero-flux boundary condition applies at $z=\\pm\\tilde{H}/2$, so $\\mathcal{Z}(\\pm\\tilde{H}/2) = 0$.\n$$\nC \\cos(B_z \\tilde{H}/2) = 0\n$$\nFor the fundamental mode, the argument of the cosine must be $\\pi/2$. Thus, $B_z \\tilde{H}/2 = \\pi/2$. The axial buckling for Case V is:\n$$\nB_{z,\\mathrm{V}}^2 = \\left(\\frac{\\pi}{\\tilde{H}}\\right)^2 = \\left(\\frac{\\pi}{H+2\\delta}\\right)^2\n$$\nThe total geometric buckling for Case V is:\n$$\nB_{g,\\mathrm{V}}^2 = B_{r,\\mathrm{V}}^2 + B_{z,\\mathrm{V}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 + \\left(\\frac{\\pi}{H+2\\delta}\\right)^2\n$$\n\n### Case R: Reflecting End Faces\nIn this case, the lateral surface is a vacuum boundary, but the end faces at $z=\\pm H/2$ are perfectly reflecting.\nThe radial boundary condition is unchanged from Case V, so the radial buckling is the same:\n$$\nB_{r,\\mathrm{R}}^2 = B_{r,\\mathrm{V}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2\n$$\nThe axial boundary condition is zero normal current at the physical surfaces $z=\\pm H/2$. The axial current is $J_z = -D \\frac{\\partial\\phi}{\\partial z}$, where $D$ is the diffusion coefficient. The condition $\\frac{\\partial\\phi}{\\partial z}|_{z=\\pm H/2} = 0$ implies $\\frac{d\\mathcal{Z}}{dz}|_{z=\\pm H/2} = 0$.\nUsing $\\mathcal{Z}(z) = C \\cos(B_z z)$, the derivative is $\\frac{d\\mathcal{Z}}{dz} = -C B_z \\sin(B_z z)$. Applying the boundary condition at $z=H/2$:\n$$\n-C B_z \\sin\\left(B_z \\frac{H}{2}\\right) = 0\n$$\nFor a non-trivial solution ($C \\ne 0$), we require either $B_z=0$ or $\\sin(B_z H/2)=0$. The latter gives $B_z H/2 = n\\pi$ for integer $n \\ge 1$. The fundamental mode corresponds to the lowest possible non-negative eigenvalue for $B_z^2$. The case $B_z=0$ is a valid solution, corresponding to $\\mathcal{Z}(z)$ being a constant, which satisfies the derivative boundary condition. This gives the minimum possible value for $B_z^2$. Therefore, for the fundamental mode with reflecting boundaries:\n$$\nB_{z,\\mathrm{R}}^2 = 0\n$$\nThis physically represents no net neutron leakage in the axial direction. The total geometric buckling for Case R is:\n$$\nB_{g,\\mathrm{R}}^2 = B_{r,\\mathrm{R}}^2 + B_{z,\\mathrm{R}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 + 0 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2\n$$\n\n### Calculation of the Change $\\Delta B_g^2$\nThe change in geometric buckling is $\\Delta B_{g}^{2} = B_{g,\\mathrm{R}}^{2} - B_{g,\\mathrm{V}}^{2}$.\n$$\n\\Delta B_{g}^{2} = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 - \\left[ \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 + \\left(\\frac{\\pi}{H+2\\delta}\\right)^2 \\right]\n$$\n$$\n\\Delta B_{g}^{2} = -\\left(\\frac{\\pi}{H+2\\delta}\\right)^2\n$$\nThe change is simply the negative of the axial buckling component of the all-vacuum case, representing the removal of axial leakage by the reflecting boundaries.\n\nNow we substitute the given numerical values:\n$R = 0.40\\,\\mathrm{m}$\n$H = 1.00\\,\\mathrm{m}$\n$\\lambda_{tr} = 0.030\\,\\mathrm{m}$\nFirst, calculate the extrapolation distance $\\delta$:\n$$\n\\delta = 0.7104 \\lambda_{tr} = 0.7104 \\times 0.030\\,\\mathrm{m} = 0.021312\\,\\mathrm{m}\n$$\nNext, calculate the value of $\\Delta B_g^2$:\n$$\n\\Delta B_{g}^{2} = -\\left(\\frac{\\pi}{H+2\\delta}\\right)^2 = -\\left(\\frac{\\pi}{1.00\\,\\mathrm{m} + 2 \\times 0.021312\\,\\mathrm{m}}\\right)^2\n$$\n$$\n\\Delta B_{g}^{2} = -\\left(\\frac{\\pi}{1.00 + 0.042624}\\right)^2 \\mathrm{m}^{-2} = -\\left(\\frac{\\pi}{1.042624}\\right)^2 \\mathrm{m}^{-2}\n$$\n$$\n\\Delta B_{g}^{2} \\approx -(3.0131484)^2 \\mathrm{m}^{-2} \\approx -9.079061 \\mathrm{m}^{-2}\n$$\nRounding the result to four significant figures gives:\n$$\n\\Delta B_g^2 \\approx -9.079\\,\\mathrm{m}^{-2}\n$$\nThis negative value indicates that making the end faces reflective reduces the overall geometric buckling (i.e., reduces neutron leakage), which is physically correct.",
            "answer": "$$\\boxed{-9.079}$$"
        },
        {
            "introduction": "While simple, single-region problems can often be solved analytically, realistic reactor designs involving different materials—like a core and a reflector—typically lead to transcendental equations that require numerical solution. This computational exercise challenges you to model a spherical core surrounded by an infinite reflector, a common design to improve neutron economy. You will derive the criticality condition at the core-reflector interface and implement a numerical root-finding algorithm to determine the critical core radius, ultimately calculating the 'reflector savings' , a key metric quantifying the reflector's efficiency.",
            "id": "4221755",
            "problem": "A spherically symmetric, two-region nuclear system comprises a homogeneous, multiplying core of radius $R$ that is surrounded by an infinite, non-multiplying reflector. The objective is to determine the critical core radius $R$ numerically from the transcendental condition implied by the steady-state, one-group neutron diffusion equation and to report the reflector savings $\\Delta = R_{\\text{bare}} - R_{\\text{ref}}$. The analysis must start from the one-group diffusion equation and standard interface conditions without assuming any pre-derived geometric relations.\n\nThe fundamental base for this problem is the steady-state one-group neutron diffusion equation in each region, together with continuity of neutron flux and current at the core-reflector interface, and the vacuum (zero flux) boundary condition implemented via extrapolation length in the bare core reference problem. The one-group diffusion equation in a region with material properties is\n$$\nD \\nabla^2 \\phi(\\mathbf{x}) - \\Sigma_a \\phi(\\mathbf{x}) + S(\\mathbf{x}) = 0,\n$$\nwhere $D$ is the diffusion coefficient, $\\Sigma_a$ is the macroscopic absorption cross section, and $S(\\mathbf{x})$ is the neutron source due to fission. For the multiplying core at critical steady state, model the source as $S(\\mathbf{x}) = \\nu \\Sigma_f \\phi(\\mathbf{x})$, where $\\nu \\Sigma_f$ is the macroscopic production cross section. For the non-multiplying reflector, use $S(\\mathbf{x}) = 0$. Define the material buckling of the core by\n$$\nB_m^2 = \\frac{\\nu \\Sigma_f - \\Sigma_a}{D},\n$$\nand the diffusion length of the reflector by\n$$\nL_r = \\sqrt{\\frac{D_r}{\\Sigma_{a,r}}}.\n$$\nThe macroscopic cross sections and diffusion coefficients are positive constants in each region. In the bare core reference problem with a vacuum boundary, impose the zero-flux condition at the extrapolated boundary with extrapolation distance $\\delta \\approx 0.7104 \\lambda_{\\text{tr}}$ where $\\lambda_{\\text{tr}} = 1/\\Sigma_{\\text{tr}}$ is the transport mean free path and $\\Sigma_{\\text{tr}}$ is the transport macroscopic cross section of the core. The simple spherical bare-core criticality relation in terms of geometric buckling should be obtained from first principles.\n\nYour program must implement numerical solution of the spherical reflected-core transcendental condition that arises from the above base and boundary/interface conditions, and must compute the corresponding critical core radius $R_{\\text{ref}}$ for the reflected system, together with the bare critical radius $R_{\\text{bare}}$ for the reference system. Then compute the reflector savings\n$$\n\\Delta = R_{\\text{bare}} - R_{\\text{ref}}.\n$$\n\nAll physical inputs and outputs in this problem use centimeter units. Express all lengths (including $R_{\\text{bare}}$, $R_{\\text{ref}}$, and $\\Delta$) in $\\mathrm{cm}$. The final program output must be a single line containing the list of computed reflector savings for the provided test suite, as a comma-separated list enclosed in square brackets, with each entry a floating-point number in $\\mathrm{cm}$.\n\nImplement your solution for the following test suite of parameter sets. Each test case provides core parameters $(D_c, \\Sigma_{a,c}, \\nu \\Sigma_{f,c}, \\Sigma_{\\text{tr},c})$ and reflector parameters $(D_r, \\Sigma_{a,r})$:\n\n- Test case $1$ (moderate core, water-like reflector): core $(D_c = 1.2\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.015\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.045\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c} = 0.8\\,\\mathrm{cm}^{-1})$, reflector $(D_r = 1.6\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.006\\,\\mathrm{cm}^{-1})$.\n- Test case $2$ (same core, poor reflector): core $(D_c = 1.0\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.020\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.050\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c} = 0.9\\,\\mathrm{cm}^{-1})$, reflector $(D_r = 0.5\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.200\\,\\mathrm{cm}^{-1})$.\n- Test case $3$ (same core as test case $2$, strong reflector): core $(D_c = 1.0\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.020\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.050\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c} = 0.9\\,\\mathrm{cm}^{-1})$, reflector $(D_r = 2.0\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.002\\,\\mathrm{cm}^{-1})$.\n- Test case $4$ (weakly supercritical core, good reflector): core $(D_c = 1.3\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.019\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.021\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c} = 0.7\\,\\mathrm{cm}^{-1})$, reflector $(D_r = 1.8\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.004\\,\\mathrm{cm}^{-1})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3,x_4]$), where each $x_i$ is the computed $\\Delta$ in $\\mathrm{cm}$ for the corresponding test case.\n\nThe numerical method must robustly locate the smallest positive root for the reflected-core transcendental condition, corresponding to the fundamental mode, and must verify that the core material buckling is positive. If a test case yields a non-positive material buckling, the program should handle it gracefully in a mathematically consistent way by returning a non-number floating-point result for that case in the final list (for example, not-a-number).",
            "solution": "### Derivation and Solution Methodology\n\nThe solution requires deriving and solving the criticality conditions for both the bare and reflected spherical core configurations.\n\n**1. General Solution of the Diffusion Equation in Spherical Geometry**\n\nThe diffusion equation in a source-free, homogeneous region is $D \\nabla^2 \\phi - \\Sigma_a \\phi + S = 0$. With spherical symmetry, $\\phi(\\mathbf{x}) = \\phi(r)$, the Laplacian is $\\nabla^2 \\phi = \\frac{1}{r} \\frac{d^2}{dr^2}(r\\phi)$.\nSubstituting this into the diffusion equation and letting $u(r) = r\\phi(r)$:\n$$\n\\frac{D}{r}\\frac{d^2u}{dr^2} - \\frac{\\Sigma_a}{r}u + \\frac{S}{r}u = 0 \\implies \\frac{d^2u}{dr^2} + \\left(\\frac{S - \\Sigma_a}{D}\\right)u = 0\n$$\n\nIn the **multiplying core**, $S = \\nu \\Sigma_{f,c} \\phi_c$. The equation for $u_c(r) = r\\phi_c(r)$ becomes:\n$$\n\\frac{d^2u_c}{dr^2} + \\left(\\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c}\\right)u_c = 0 \\implies \\frac{d^2u_c}{dr^2} + B_{m,c}^2 u_c = 0\n$$\nwhere $B_{m,c}^2$ is the material buckling of the core. For a critical system, we must have $B_{m,c}^2 > 0$. The general solution is $u_c(r) = A \\sin(B_{m,c} r) + C \\cos(B_{m,c} r)$. The corresponding flux is $\\phi_c(r) = A \\frac{\\sin(B_{m,c} r)}{r} + C \\frac{\\cos(B_{m,c} r)}{r}$. Since the flux must be finite at $r=0$, and $\\frac{\\cos(B_{m,c} r)}{r} \\to \\infty$ as $r \\to 0$, we must set $C=0$. Thus, the core flux is:\n$$\n\\phi_c(r) = A \\frac{\\sin(B_{m,c} r)}{r}\n$$\n\nIn the **non-multiplying reflector**, $S=0$. The equation for $u_r(r) = r\\phi_r(r)$ becomes:\n$$\n\\frac{d^2u_r}{dr^2} - \\frac{\\Sigma_{a,r}}{D_r} u_r = 0 \\implies \\frac{d^2u_r}{dr^2} - \\frac{1}{L_r^2} u_r = 0\n$$\nwhere $L_r^2 = D_r/\\Sigma_{a,r}$ is the squared diffusion length in the reflector. The general solution is $u_r(r) = F e^{-r/L_r} + G e^{r/L_r}$. The corresponding flux is $\\phi_r(r) = F \\frac{e^{-r/L_r}}{r} + G \\frac{e^{r/L_r}}{r}$. Since the reflector is infinite, the flux must remain finite as $r \\to \\infty$. The term $\\frac{e^{r/L_r}}{r}$ diverges, so we must set $G=0$. Thus, the reflector flux is:\n$$\n\\phi_r(r) = F \\frac{e^{-r/L_r}}{r}\n$$\n\n**2. Bare Core Criticality**\n\nFor a bare core of radius $R_{\\text{bare}}$, the boundary condition is that the flux vanishes at the extrapolated radius $\\tilde{R} = R_{\\text{bare}} + \\delta$, where $\\delta = 0.7104 / \\Sigma_{\\text{tr},c}$.\n$$\n\\phi_c(\\tilde{R}) = A \\frac{\\sin(B_{m,c} \\tilde{R})}{\\tilde{R}} = 0\n$$\nFor a non-trivial solution ($A \\neq 0$), we require $\\sin(B_{m,c} \\tilde{R}) = 0$. The fundamental (non-negative flux) solution corresponds to $B_{m,c} \\tilde{R} = \\pi$.\nThis yields the criticality condition $B_{m,c} (R_{\\text{bare}} + \\delta) = \\pi$. Solving for the bare critical radius gives:\n$$\nR_{\\text{bare}} = \\frac{\\pi}{B_{m,c}} - \\delta\n$$\n\n**3. Reflected Core Criticality**\n\nFor a core of radius $R_{\\text{ref}}$ surrounded by an infinite reflector, we apply interface conditions at $r=R_{\\text{ref}}$.\n1.  **Continuity of Flux:** $\\phi_c(R_{\\text{ref}}) = \\phi_r(R_{\\text{ref}})$.\n    $$\n    A \\frac{\\sin(B_{m,c} R_{\\text{ref}})}{R_{\\text{ref}}} = F \\frac{e^{-R_{\\text{ref}}/L_r}}{R_{\\text{ref}}} \\implies A \\sin(B_{m,c} R_{\\text{ref}}) = F e^{-R_{\\text{ref}}/L_r}\n    $$\n2.  **Continuity of Current:** The radial neutron current is $J(r) = -D \\frac{d\\phi}{dr}$. Thus, at the interface, $-D_c \\frac{d\\phi_c}{dr}|_{R_{\\text{ref}}} = -D_r \\frac{d\\phi_r}{dr}|_{R_{\\text{ref}}}$.\n    The derivatives are:\n    $$\n    \\frac{d\\phi_c}{dr} = A \\frac{B_{m,c} r \\cos(B_{m,c} r) - \\sin(B_{m,c} r)}{r^2}\n    $$\n    $$\n    \\frac{d\\phi_r}{dr} = F \\frac{-r/L_r \\cdot e^{-r/L_r} - e^{-r/L_r}}{r^2} = - F \\frac{e^{-r/L_r}}{r^2} \\left(1 + \\frac{r}{L_r}\\right)\n    $$\n    Equating the currents at $r=R_{\\text{ref}}$:\n    $$\n    -D_c A \\frac{B_{m,c} R_{\\text{ref}} \\cos(B_{m,c} R_{\\text{ref}}) - \\sin(B_{m,c} R_{\\text{ref}})}{R_{\\text{ref}}^2} = -D_r \\left(-F \\frac{e^{-R_{\\text{ref}}/L_r}}{R_{\\text{ref}}^2} \\left(1 + \\frac{R_{\\text{ref}}}{L_r}\\right)\\right)\n    $$\n    $$\n    -D_c A (B_{m,c} R_{\\text{ref}} \\cos(B_{m,c} R_{\\text{ref}}) - \\sin(B_{m,c} R_{\\text{ref}})) = D_r F e^{-R_{\\text{ref}}/L_r} \\left(1 + \\frac{R_{\\text{ref}}}{L_r}\\right)\n    $$\n    Substitute $F e^{-R_{\\text{ref}}/L_r} = A \\sin(B_{m,c} R_{\\text{ref}})$ from the flux continuity condition and cancel the amplitude $A$:\n    $$\n    -D_c (B_{m,c} R_{\\text{ref}} \\cos(B_{m,c} R_{\\text{ref}}) - \\sin(B_{m,c} R_{\\text{ref}})) = D_r \\sin(B_{m,c} R_{\\text{ref}}) \\left(1 + \\frac{R_{\\text{ref}}}{L_r}\\right)\n    $$\n    Divide by $\\sin(B_{m,c} R_{\\text{ref}})$ (assuming it's non-zero):\n    $$\n    -D_c (B_{m,c} R_{\\text{ref}} \\cot(B_{m,c} R_{\\text{ref}}) - 1) = D_r \\left(1 + \\frac{R_{\\text{ref}}}{L_r}\\right)\n    $$\n    Rearranging gives the transcendental equation for the reflected critical radius $R_{\\text{ref}}$:\n    $$\n    D_c B_{m,c} R_{\\text{ref}} \\cot(B_{m,c} R_{\\text{ref}}) + D_r \\left(1 + \\frac{R_{\\text{ref}}}{L_r}\\right) - D_c = 0\n    $$\n    An equivalent, common form is:\n    $$\n    D_c B_{m,c} \\cot(B_{m,c} R_{\\text{ref}}) - \\frac{D_c - D_r}{R_{\\text{ref}}} + \\frac{D_r}{L_r} = 0\n    $$\n    This equation must be solved numerically for $R_{\\text{ref}}$. The fundamental mode corresponds to the smallest positive root $R_{\\text{ref}}$, for which $B_{m,c}R_{\\text{ref}}$ lies in the interval $(0, \\pi)$.\n\n**4. Numerical Implementation**\n\nThe overall algorithm for each test case is as follows:\n1.  Calculate $B_{m,c}^2 = (\\nu \\Sigma_{f,c} - \\Sigma_{a,c}) / D_c$. If $B_{m,c}^2 \\le 0$, the system cannot be made critical. The result for this case is not-a-number (`NaN`).\n2.  If $B_{m,c}^2 > 0$, calculate $B_{m,c} = \\sqrt{B_{m,c}^2}$.\n3.  Calculate the extrapolation distance $\\delta = 0.7104 / \\Sigma_{\\text{tr},c}$.\n4.  Calculate the bare critical radius $R_{\\text{bare}} = \\pi/B_{m,c} - \\delta$.\n5.  Calculate the reflector diffusion length $L_r = \\sqrt{D_r / \\Sigma_{a,r}}$.\n6.  Numerically find the smallest positive root $R_{\\text{ref}}$ of the transcendental equation $f(R) = D_c B_{m,c} \\cot(B_{m,c} R) - \\frac{D_c - D_r}{R} + \\frac{D_r}{L_r} = 0$. This can be done using a robust root-finding algorithm like Brent's method, searching in the interval $(0, \\pi/B_{m,c})$.\n7.  Finally, compute the reflector savings $\\Delta = R_{\\text{bare}} - R_{\\text{ref}}$.\nThe final program implements this logic for each provided test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves for the reflector savings in a spherical, one-group diffusion model.\n\n    The program calculates the critical radius for a bare core and a reflected core,\n    then computes the difference (reflector savings). The transcendental equation\n    for the reflected core is solved numerically.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: (core_params, reflector_params)\n    # core_params: (D_c, Sigma_a_c, nu_Sigma_f_c, Sigma_tr_c)\n    # reflector_params: (D_r, Sigma_a_r)\n    test_cases = [\n        ((1.2, 0.015, 0.045, 0.8), (1.6, 0.006)),  # Test case 1\n        ((1.0, 0.020, 0.050, 0.9), (0.5, 0.200)),  # Test case 2\n        ((1.0, 0.020, 0.050, 0.9), (2.0, 0.002)),  # Test case 3\n        ((1.3, 0.019, 0.021, 0.7), (1.8, 0.004)),  # Test case 4\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        core_params, reflector_params = case\n        D_c, Sigma_a_c, nu_Sigma_f_c, Sigma_tr_c = core_params\n        D_r, Sigma_a_r = reflector_params\n\n        # Step 1: Calculate core material properties\n        # Material buckling squared\n        B_m_sq = (nu_Sigma_f_c - Sigma_a_c) / D_c\n\n        # If buckling is non-positive, core cannot be critical.\n        if B_m_sq = 0:\n            results.append(np.nan)\n            continue\n        \n        B_m = np.sqrt(B_m_sq)\n        \n        # Extrapolation distance for bare core\n        delta = 0.7104 / Sigma_tr_c\n\n        # Step 2: Calculate bare critical radius (R_bare)\n        R_bare = np.pi / B_m - delta\n\n        # Step 3: Calculate reflector properties\n        L_r_sq = D_r / Sigma_a_r\n        L_r = np.sqrt(L_r_sq)\n\n        # Step 4: Numerically solve for reflected critical radius (R_ref)\n        # The transcendental equation is:\n        # f(R) = D_c*B_m*cot(B_m*R) - (D_c - D_r)/R + D_r/L_r = 0\n        def transcendental_eq(R):\n            if R == 0:\n                # Based on limit analysis f(R) - +inf as R-0+\n                # Return a large positive number to guide the solver\n                return np.inf \n            term1 = D_c * B_m / np.tan(B_m * R)\n            term2 = -(D_c - D_r) / R\n            term3 = D_r / L_r\n            return term1 + term2 + term3\n\n        # The fundamental mode root R_ref satisfies 0  B_m * R_ref  pi.\n        # We bracket the root for the solver.\n        bracket_low = 1e-9\n        bracket_high = np.pi / B_m - 1e-9\n\n        # Use a robust root-finding algorithm\n        try:\n            sol = root_scalar(transcendental_eq, bracket=[bracket_low, bracket_high], method='brentq')\n            R_ref = sol.root\n        except ValueError:\n            # This may happen if function does not have opposite signs at bracket ends,\n            # indicating an issue with problem parameters or the model's applicability.\n            R_ref = np.nan\n        \n        # Step 5: Calculate reflector savings\n        if np.isnan(R_ref):\n            delta_savings = np.nan\n        else:\n            delta_savings = R_bare - R_ref\n        \n        results.append(delta_savings)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}