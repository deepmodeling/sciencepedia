{
    "hands_on_practices": [
        {
            "introduction": "Before we can analyze a reactor's critical state, we must first characterize how neutrons move through its materials. The diffusion equation relies on macroscopic parameters like the diffusion coefficient, $D$, and the transport cross section, $\\Sigma_{tr}$. This exercise provides fundamental practice in deriving these macroscopic quantities from the more basic microscopic cross-section data provided by nuclear data libraries . By working through this problem, you will solidify your understanding of how the $P_1$ approximation of the transport equation accounts for anisotropic scattering to produce the essential inputs for diffusion theory.",
            "id": "4221762",
            "problem": "A homogeneous, source-free, steady-state neutron field in a single energy group is modeled by the diffusion approximation derived from the first two angular moments of the steady-state linear Boltzmann transport equation. The material exhibits anisotropic scattering described by a Legendre polynomial expansion of the microscopic differential scattering cross section. The microscopic Legendre moments $\\sigma_{s,\\ell}$ are defined as the coefficients in the expansion with the conventional normalization used in neutron transport theory. A single material occupies the region, and its microscopic total cross section and microscopic scattering Legendre moments for this group are given by\n$$\\sigma_{t} = 6.0\\ \\mathrm{b}, \\quad \\sigma_{s,0} = 5.0\\ \\mathrm{b}, \\quad \\sigma_{s,1} = 0.90\\ \\mathrm{b}, \\quad \\sigma_{s,2} = 0.30\\ \\mathrm{b}, \\quad \\sigma_{s,3} = 0.050\\ \\mathrm{b},$$\nwhere $\\mathrm{b}$ denotes barns and $1\\ \\mathrm{b} = 10^{-24}\\ \\mathrm{cm}^{2}$. The atomic number density is\n$$N = 8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}.$$\nFrom first principles of the diffusion approximation constructed via the $P_{1}$ truncation of the angular flux and the associated moment equations, determine the macroscopic transport cross section $\\Sigma_{tr}$ and the diffusion coefficient $D$ for this energy group. Express $\\Sigma_{tr}$ in $\\mathrm{cm}^{-1}$ and $D$ in $\\mathrm{cm}$. Round your answers to 4 significant figures.",
            "solution": "The problem requires the determination of the macroscopic transport cross section, $\\Sigma_{tr}$, and the diffusion coefficient, $D$, for a homogeneous medium using the one-group $P_1$ approximation.\n\nThe diffusion approximation is derived from the first two angular moments of the Boltzmann transport equation. The key relationship emerging from this derivation that connects neutron current $\\mathbf{J}$ to the scalar flux $\\phi$ is Fick's Law: $\\mathbf{J}(\\mathbf{r}) = -D \\nabla \\phi(\\mathbf{r})$. Within the $P_1$ framework, the diffusion coefficient $D$ and the transport cross section $\\Sigma_{tr}$ are defined as:\n$$ \\Sigma_{tr} = \\Sigma_t - \\Sigma_{s,1} $$\n$$ D = \\frac{1}{3 \\Sigma_{tr}} $$\nHere, $\\Sigma_t$ is the macroscopic total cross section, and $\\Sigma_{s,1}$ is the first Legendre moment of the macroscopic scattering cross section, which accounts for linear anisotropy in scattering. Higher-order scattering moments ($\\Sigma_{s,2}, \\Sigma_{s,3}, \\ldots$) do not contribute to the diffusion coefficient in the standard $P_1$ approximation.\n\nThe problem provides microscopic cross sections ($\\sigma$) and the atomic number density ($N$). Macroscopic cross sections ($\\Sigma$) are calculated via the relation $\\Sigma_x = N \\sigma_x$.\n\nGiven values:\n- Atomic number density: $N = 8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}$\n- Microscopic total cross section: $\\sigma_t = 6.0\\ \\mathrm{b} = 6.0 \\times 10^{-24}\\ \\mathrm{cm}^2$\n- Microscopic first Legendre moment of scattering: $\\sigma_{s,1} = 0.90\\ \\mathrm{b} = 0.90 \\times 10^{-24}\\ \\mathrm{cm}^2$\nThe values for $\\sigma_{s,0}$, $\\sigma_{s,2}$, and $\\sigma_{s,3}$ are not needed.\n\nFirst, we calculate the required macroscopic cross sections:\n$$ \\Sigma_t = N \\sigma_t = (8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}) \\times (6.0 \\times 10^{-24}\\ \\mathrm{cm}^2) = 0.48\\ \\mathrm{cm}^{-1} $$\n$$ \\Sigma_{s,1} = N \\sigma_{s,1} = (8.0 \\times 10^{22}\\ \\mathrm{cm}^{-3}) \\times (0.90 \\times 10^{-24}\\ \\mathrm{cm}^2) = 0.072\\ \\mathrm{cm}^{-1} $$\n\nNow, we can compute $\\Sigma_{tr}$:\n$$ \\Sigma_{tr} = \\Sigma_t - \\Sigma_{s,1} = 0.48\\ \\mathrm{cm}^{-1} - 0.072\\ \\mathrm{cm}^{-1} = 0.408\\ \\mathrm{cm}^{-1} $$\n\nFinally, we compute $D$:\n$$ D = \\frac{1}{3 \\Sigma_{tr}} = \\frac{1}{3 \\times 0.408\\ \\mathrm{cm}^{-1}} = \\frac{1}{1.224}\\ \\mathrm{cm} \\approx 0.81699346... \\ \\mathrm{cm} $$\n\nThe problem requires rounding the answers to 4 significant figures.\n- $\\Sigma_{tr} = 0.4080\\ \\mathrm{cm}^{-1}$\n- $D = 0.8170\\ \\mathrm{cm}$\n\nTherefore, the macroscopic transport cross section is $0.4080\\ \\mathrm{cm}^{-1}$ and the diffusion coefficient is $0.8170\\ \\mathrm{cm}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4080 & 0.8170\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The critical condition in a nuclear reactor is fundamentally an eigenvalue problem, where the material properties must balance the neutron leakage determined by the system's size, shape, and boundary conditions. This balance is captured by the geometric buckling, $B_g^2$, which is the fundamental eigenvalue of the Helmholtz equation. This practice  offers a concrete exercise in calculating $B_g^2$ for a cylindrical geometry, requiring the application of separation of variables. Crucially, it highlights the quantitative impact of boundary conditions by contrasting a leaky vacuum boundary with a perfectly reflecting one, demonstrating how boundary conditions directly control neutron leakage and thus criticality.",
            "id": "4221764",
            "problem": "A homogeneous, one-speed, bare right circular cylinder of radius $R$ and height $H$ is modeled with the steady-state neutron diffusion equation at criticality in the form of a homogeneous Helmholtz equation posed for the scalar neutron flux $\\phi(\\mathbf{r})$ in cylindrical coordinates $(r,\\theta,z)$ with azimuthal symmetry. The material is uniform, with diffusion length $L$, and all surfaces are either vacuum or perfectly reflecting. Adopt the standard diffusion-theory representation of a vacuum boundary as a zero-flux plane at an extrapolated distance $\\delta$ beyond the physical surface, with $\\delta=\\beta L$ and $\\beta=0.7104$. A perfectly reflecting surface is modeled as a zero-normal-current (Neumann) boundary at the physical surface.\n\nConsider two cases:\n- Case V: all physical surfaces are vacuum boundaries.\n- Case R: the curved lateral surface is vacuum, while the two planar end faces at $z=\\pm H/2$ are perfectly reflecting.\n\nUsing separation of variables and appropriate boundary conditions, determine how making the axial dimension reflective modifies the fundamental eigenvalue of the Laplacian operator, that is, the fundamental geometric buckling $B_{g}^{2}$, when transitioning from Case V to Case R. Specifically, compute the change $\\Delta B_{g}^{2} \\equiv B_{g,\\mathrm{R}}^{2} - B_{g,\\mathrm{V}}^{2}$ for a cylinder with $R = 0.40\\,\\mathrm{m}$, $H = 1.00\\,\\mathrm{m}$, and $L = 0.030\\,\\mathrm{m}$. Express your final result in $\\mathrm{m}^{-2}$, and round your answer to four significant figures.",
            "solution": "The steady-state neutron diffusion equation for a critical, homogeneous system is the Helmholtz equation:\n$$ \\nabla^2 \\phi(\\mathbf{r}) + B_g^2 \\phi(\\mathbf{r}) = 0 $$\nwhere $\\phi$ is the neutron flux and $B_g^2$ is the geometric buckling. Given azimuthal symmetry, we use separation of variables in cylindrical coordinates, $\\phi(r,z) = \\mathcal{R}(r) \\mathcal{Z}(z)$. This decomposes the geometric buckling into radial and axial components: $B_g^2 = B_r^2 + B_z^2$. The solutions for the fundamental mode that are finite at the center are $\\mathcal{R}(r) = A J_0(B_r r)$ and $\\mathcal{Z}(z) = C \\cos(B_z z)$, where $J_0$ is the Bessel function of the first kind of order zero.\n\nFirst, calculate the extrapolation distance:\n$$ \\delta = \\beta L = 0.7104 \\times 0.030\\,\\mathrm{m} = 0.021312\\,\\mathrm{m} $$\n\n**Case V: All Surfaces are Vacuum Boundaries**\nZero-flux boundary conditions are applied at the extrapolated surfaces.\n- **Radial:** The extrapolated radius is $\\tilde{R} = R + \\delta$. The boundary condition $\\mathcal{R}(\\tilde{R}) = 0$ implies $B_r \\tilde{R} = j_{0,1}$, where $j_{0,1} \\approx 2.4048$ is the first zero of $J_0$. The radial buckling is:\n  $$ B_{r,\\mathrm{V}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 $$\n- **Axial:** The extrapolated height is $\\tilde{H} = H + 2\\delta$. The boundary condition $\\mathcal{Z}(\\pm\\tilde{H}/2) = 0$ implies $B_z \\tilde{H}/2 = \\pi/2$. The axial buckling is:\n  $$ B_{z,\\mathrm{V}}^2 = \\left(\\frac{\\pi}{H+2\\delta}\\right)^2 $$\nThe total geometric buckling for Case V is:\n$$ B_{g,\\mathrm{V}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 + \\left(\\frac{\\pi}{H+2\\delta}\\right)^2 $$\n\n**Case R: Reflecting End Faces**\nThe lateral surface has a vacuum boundary, but the end faces at $z=\\pm H/2$ are perfectly reflecting.\n- **Radial:** The boundary condition is unchanged from Case V.\n  $$ B_{r,\\mathrm{R}}^2 = B_{r,\\mathrm{V}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 $$\n- **Axial:** The zero-current boundary condition is $\\frac{d\\mathcal{Z}}{dz}|_{z=\\pm H/2} = 0$. For the fundamental (lowest buckling) mode, this condition is satisfied by a constant flux shape in the z-direction, which corresponds to an axial buckling of zero.\n  $$ B_{z,\\mathrm{R}}^2 = 0 $$\nThe total geometric buckling for Case R is:\n$$ B_{g,\\mathrm{R}}^2 = B_{r,\\mathrm{R}}^2 + B_{z,\\mathrm{R}}^2 = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 $$\n\n**Calculation of the Change $\\Delta B_g^2$**\nThe change in geometric buckling is the difference between the two cases:\n$$ \\Delta B_{g}^{2} = B_{g,\\mathrm{R}}^{2} - B_{g,\\mathrm{V}}^{2} = \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 - \\left[ \\left(\\frac{j_{0,1}}{R+\\delta}\\right)^2 + \\left(\\frac{\\pi}{H+2\\delta}\\right)^2 \\right] $$\n$$ \\Delta B_{g}^{2} = -\\left(\\frac{\\pi}{H+2\\delta}\\right)^2 $$\nThis physically represents the removal of the axial leakage term. Substituting the numerical values:\n$$ \\Delta B_{g}^{2} = -\\left(\\frac{\\pi}{1.00\\,\\mathrm{m} + 2 \\times 0.021312\\,\\mathrm{m}}\\right)^2 = -\\left(\\frac{\\pi}{1.042624\\,\\mathrm{m}}\\right)^2 $$\n$$ \\Delta B_{g}^{2} \\approx -(3.013148)^2 \\mathrm{m}^{-2} \\approx -9.079061 \\mathrm{m}^{-2} $$\nRounding to four significant figures, the change is $-9.079\\,\\mathrm{m}^{-2}$.",
            "answer": "$$\\boxed{-9.079}$$"
        },
        {
            "introduction": "While bare reactors are a useful starting point, practical reactor designs almost always include a reflector to improve neutron economy and reduce the required core size. The analysis of such reflected systems introduces new complexities, leading to transcendental equations that must be solved numerically. This computational exercise  bridges theory and practice by tasking you with setting up and solving the criticality condition for a reflected sphere. You will implement a numerical root-finding algorithm to determine the critical core radius and calculate the \"reflector savings,\" a key performance metric in reactor design that quantifies the benefit of adding a reflector.",
            "id": "4221755",
            "problem": "A spherically symmetric, two-region nuclear system comprises a homogeneous, multiplying core of radius $R$ that is surrounded by an infinite, non-multiplying reflector. The objective is to determine the critical core radius $R$ numerically from the transcendental condition implied by the steady-state, one-group neutron diffusion equation and to report the reflector savings $\\Delta = R_{\\text{bare}} - R_{\\text{ref}}$. The analysis must start from the one-group diffusion equation and standard interface conditions without assuming any pre-derived geometric relations.\n\nThe fundamental base for this problem is the steady-state one-group neutron diffusion equation in each region, together with continuity of neutron flux and current at the core-reflector interface, and the vacuum (zero flux) boundary condition implemented via extrapolation length in the bare core reference problem. The one-group diffusion equation in a region with material properties is\n$$\nD \\nabla^2 \\phi(\\mathbf{x}) - \\Sigma_a \\phi(\\mathbf{x}) + S(\\mathbf{x}) = 0,\n$$\nwhere $D$ is the diffusion coefficient, $\\Sigma_a$ is the macroscopic absorption cross section, and $S(\\mathbf{x})$ is the neutron source due to fission. For the multiplying core at critical steady state, model the source as $S(\\mathbf{x}) = \\nu \\Sigma_f \\phi(\\mathbf{x})$, where $\\nu \\Sigma_f$ is the macroscopic production cross section. For the non-multiplying reflector, use $S(\\mathbf{x}) = 0$. Define the material buckling of the core by\n$$\nB_m^2 = \\frac{\\nu \\Sigma_f - \\Sigma_a}{D},\n$$\nand the diffusion length of the reflector by\n$$\nL_r = \\sqrt{\\frac{D_r}{\\Sigma_{a,r}}}.\n$$\nThe macroscopic cross sections and diffusion coefficients are positive constants in each region. In the bare core reference problem with a vacuum boundary, impose the zero-flux condition at the extrapolated boundary with extrapolation distance $\\delta \\approx 0.7104 \\lambda_{\\text{tr}}$ where $\\lambda_{\\text{tr}} = 1/\\Sigma_{\\text{tr}}$ is the transport mean free path and $\\Sigma_{\\text{tr}}$ is the transport macroscopic cross section of the core. The simple spherical bare-core criticality relation in terms of geometric buckling should be obtained from first principles.\n\nYour program must implement numerical solution of the spherical reflected-core transcendental condition that arises from the above base and boundary/interface conditions, and must compute the corresponding critical core radius $R_{\\text{ref}}$ for the reflected system, together with the bare critical radius $R_{\\text{bare}}$ for the reference system. Then compute the reflector savings\n$$\n\\Delta = R_{\\text{bare}} - R_{\\text{ref}}.\n$$\n\nAll physical inputs and outputs in this problem use centimeter units. Express all lengths (including $R_{\\text{bare}}$, $R_{\\text{ref}}$, and $\\Delta$) in $\\mathrm{cm}$. The final program output must be a single line containing the list of computed reflector savings for the provided test suite, as a comma-separated list enclosed in square brackets, with each entry a floating-point number in $\\mathrm{cm}$.\n\nImplement your solution for the following test suite of parameter sets. Each test case provides core parameters $(D_c, \\Sigma_{a,c}, \\nu \\Sigma_{f,c}, \\Sigma_{\\text{tr},c})$ and reflector parameters $(D_r, \\Sigma_{a,r})$:\n\n- Test case $1$ (moderate core, water-like reflector): core $(D_c = 1.2\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.015\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.045\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c} = 0.8\\,\\mathrm{cm}^{-1})$, reflector $(D_r = 1.6\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.006\\,\\mathrm{cm}^{-1})$.\n- Test case $2$ (same core, poor reflector): core $(D_c = 1.0\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.020\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.050\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c = 0.9\\,\\mathrm{cm}^{-1})$, reflector $(D_r = 0.5\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.200\\,\\mathrm{cm}^{-1})$.\n- Test case $3$ (same core as test case $2$, strong reflector): core $(D_c = 1.0\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.020\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.050\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c = 0.9\\,\\mathrm{cm}^{-1})$, reflector $(D_r = 2.0\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.002\\,\\mathrm{cm}^{-1})$.\n- Test case $4$ (weakly supercritical core, good reflector): core $(D_c = 1.3\\,\\mathrm{cm}, \\Sigma_{a,c} = 0.019\\,\\mathrm{cm}^{-1}, \\nu \\Sigma_{f,c} = 0.021\\,\\mathrm{cm}^{-1}, \\Sigma_{\\text{tr},c = 0.7\\,\\mathrm{cm}^{-1})$, reflector $(D_r = 1.8\\,\\mathrm{cm}, \\Sigma_{a,r} = 0.004\\,\\mathrm{cm}^{-1})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3,x_4]$), where each $x_i$ is the computed $\\Delta$ in $\\mathrm{cm}$ for the corresponding test case.\n\nThe numerical method must robustly locate the smallest positive root for the reflected-core transcendental condition, corresponding to the fundamental mode, and must verify that the core material buckling is positive. If a test case yields a non-positive material buckling, the program should handle it gracefully in a mathematically consistent way by returning a non-number floating-point result for that case in the final list (for example, not-a-number).",
            "solution": "The solution requires deriving and solving the criticality conditions for both the bare and reflected spherical core configurations. The methodology is implemented in the provided Python code.\n\n**1. General Solution of the Diffusion Equation in Spherical Geometry**\n\nFor a homogeneous region with spherical symmetry, the one-group diffusion equation $D \\nabla^2 \\phi - \\Sigma_a \\phi + S = 0$ simplifies. Letting $u(r) = r\\phi(r)$, the equation becomes:\n$$ \\frac{d^2u}{dr^2} + \\left(\\frac{S/\\phi - \\Sigma_a}{D}\\right)u = 0 $$\n\n- In the **multiplying core**, $S = \\nu \\Sigma_{f,c} \\phi_c$. The equation for $u_c(r) = r\\phi_c(r)$ is $\\frac{d^2u_c}{dr^2} + B_{m,c}^2 u_c = 0$, where $B_{m,c}^2 = (\\nu \\Sigma_{f,c} - \\Sigma_{a,c})/D_c$ is the core's material buckling. The physical solution, finite at the origin, is $\\phi_c(r) = A \\frac{\\sin(B_{m,c} r)}{r}$. A critical system requires $B_{m,c}^2 > 0$.\n\n- In the **non-multiplying reflector**, $S=0$. The equation for $u_r(r) = r\\phi_r(r)$ is $\\frac{d^2u_r}{dr^2} - \\frac{1}{L_r^2} u_r = 0$, where $L_r^2 = D_r/\\Sigma_{a,r}$ is the reflector's squared diffusion length. The physical solution for an infinite reflector, which must remain finite as $r \\to \\infty$, is $\\phi_r(r) = F \\frac{e^{-r/L_r}}{r}$.\n\n**2. Bare Core Criticality**\n\nFor a bare core of radius $R_{\\text{bare}}$, the flux must vanish at the extrapolated radius $\\tilde{R} = R_{\\text{bare}} + \\delta$, where $\\delta = 0.7104 / \\Sigma_{\\text{tr},c}$. The condition $\\phi_c(\\tilde{R})=0$ requires $\\sin(B_{m,c} \\tilde{R}) = 0$. For the fundamental mode, this gives $B_{m,c} \\tilde{R} = \\pi$. The bare critical radius is therefore:\n$$ R_{\\text{bare}} = \\frac{\\pi}{B_{m,c}} - \\delta $$\n\n**3. Reflected Core Criticality**\n\nFor a core of radius $R_{\\text{ref}}$ surrounded by an infinite reflector, we apply interface conditions at $r=R_{\\text{ref}}$:\n1.  **Continuity of Flux:** $\\phi_c(R_{\\text{ref}}) = \\phi_r(R_{\\text{ref}})$.\n2.  **Continuity of Current:** $J_c(R_{\\text{ref}}) = J_r(R_{\\text{ref}})$, or $-D_c \\frac{d\\phi_c}{dr}|_{R_{\\text{ref}}} = -D_r \\frac{d\\phi_r}{dr}|_{R_{\\text{ref}}}$.\n\nApplying these two conditions and simplifying leads to the following transcendental equation for the reflected critical radius $R_{\\text{ref}}$:\n$$ D_c B_{m,c} \\cot(B_{m,c} R_{\\text{ref}}) - \\frac{D_c - D_r}{R_{\\text{ref}}} + \\frac{D_r}{L_r} = 0 $$\nThis equation must be solved numerically for $R_{\\text{ref}}$. The fundamental mode corresponds to the smallest positive root, where $B_{m,c}R_{\\text{ref}} \\in (0, \\pi)$.\n\n**4. Numerical Implementation**\n\nThe provided Python code implements this methodology. For each test case, it:\n1.  Calculates the core's material buckling, $B_{m,c}$, and checks if it's positive.\n2.  Calculates the bare critical radius, $R_{\\text{bare}}$.\n3.  Calculates the reflector's diffusion length, $L_r$.\n4.  Uses a numerical root-finding algorithm to solve the transcendental equation for the reflected critical radius, $R_{\\text{ref}}$.\n5.  Computes the reflector savings as $\\Delta = R_{\\text{bare}} - R_{\\text{ref}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves for the reflector savings in a spherical, one-group diffusion model.\n\n    The program calculates the critical radius for a bare core and a reflected core,\n    then computes the difference (reflector savings). The transcendental equation\n    for the reflected core is solved numerically.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case: (core_params, reflector_params)\n    # core_params: (D_c, Sigma_a_c, nu_Sigma_f_c, Sigma_tr_c)\n    # reflector_params: (D_r, Sigma_a_r)\n    test_cases = [\n        ((1.2, 0.015, 0.045, 0.8), (1.6, 0.006)),  # Test case 1\n        ((1.0, 0.020, 0.050, 0.9), (0.5, 0.200)),  # Test case 2\n        ((1.0, 0.020, 0.050, 0.9), (2.0, 0.002)),  # Test case 3\n        ((1.3, 0.019, 0.021, 0.7), (1.8, 0.004)),  # Test case 4\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        core_params, reflector_params = case\n        D_c, Sigma_a_c, nu_Sigma_f_c, Sigma_tr_c = core_params\n        D_r, Sigma_a_r = reflector_params\n\n        # Step 1: Calculate core material properties\n        # Material buckling squared\n        B_m_sq = (nu_Sigma_f_c - Sigma_a_c) / D_c\n\n        # If buckling is non-positive, core cannot be critical.\n        if B_m_sq = 0:\n            results.append(np.nan)\n            continue\n        \n        B_m = np.sqrt(B_m_sq)\n        \n        # Extrapolation distance for bare core\n        delta = 0.7104 / Sigma_tr_c\n\n        # Step 2: Calculate bare critical radius (R_bare)\n        R_bare = np.pi / B_m - delta\n\n        # Step 3: Calculate reflector properties\n        L_r_sq = D_r / Sigma_a_r\n        L_r = np.sqrt(L_r_sq)\n\n        # Step 4: Numerically solve for reflected critical radius (R_ref)\n        # The transcendental equation is:\n        # f(R) = D_c*B_m*cot(B_m*R) - (D_c - D_r)/R + D_r/L_r = 0\n        def transcendental_eq(R):\n            if R = 1e-12:\n                # Based on limit analysis f(R) -> +inf as R->0+\n                # Return a large positive number to guide the solver\n                return np.inf \n            term1 = D_c * B_m / np.tan(B_m * R)\n            term2 = -(D_c - D_r) / R\n            term3 = D_r / L_r\n            return term1 + term2 + term3\n\n        # The fundamental mode root R_ref satisfies 0  B_m * R_ref  pi.\n        # We bracket the root for the solver.\n        bracket_low = 1e-9\n        bracket_high = np.pi / B_m - 1e-9\n\n        # Use a robust root-finding algorithm\n        try:\n            sol = root_scalar(transcendental_eq, bracket=[bracket_low, bracket_high], method='brentq')\n            R_ref = sol.root\n        except ValueError:\n            # This may happen if function does not have opposite signs at bracket ends,\n            # indicating an issue with problem parameters or the model's applicability.\n            R_ref = np.nan\n        \n        # Step 5: Calculate reflector savings\n        if np.isnan(R_ref):\n            delta_savings = np.nan\n        else:\n            delta_savings = R_bare - R_ref\n        \n        results.append(delta_savings)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}