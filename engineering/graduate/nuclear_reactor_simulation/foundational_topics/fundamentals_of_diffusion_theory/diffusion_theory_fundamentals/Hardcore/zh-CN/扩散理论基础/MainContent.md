## 引言
[中子扩散理论](@entry_id:160104)是[核反应堆物理学](@entry_id:1128942)乃至更广泛的输运现象研究中的基石，是连接微观粒子随机运动与宏观系统行为预测的核心桥梁。深入掌握扩散理论，不仅是理解反应堆等复杂系统行为的基础，更是进行精确数值计算和安全评估的一项必备技能。该理论通过一系列合理的物理近似，将描述单个中子随机运动的[玻尔兹曼输运方程](@entry_id:140472)，转化为一个关于宏观中子通量密度分布的[偏微分](@entry_id:194612)方程，极大地简化了求解过程，同时保留了问题的核心物理内涵。本文旨在系统性地构建[中子扩散理论](@entry_id:160104)的知识体系，从其第一性原理出发，直至其在现代工程和跨学科研究中的前沿应用。

在接下来的内容中，我们将分三步深入探索扩散理论的世界。首先，在“原理与机制”一章，我们将从中子守恒定律和菲克定律出发，严谨地推导出[扩散方程](@entry_id:170713)，并详细阐释临界理论、多群模型和[点动力学](@entry_id:1129859)等核心概念。随后，“应用与跨学科联系”一章将展示该理论的强大实践价值，探讨其如何用于解决反应堆临界尺寸计算、燃料循环分析等实际问题，并揭示其与材料科学、[医学物理学](@entry_id:158232)等多个领域的深刻联系。最后，通过“动手实践”部分，您将有机会运用所学知识解决具体的计算问题，将抽象的理论转化为可触摸的工程实践，从而真正巩固和内化这些基本原理。

## 原理与机制

在“引言”章节中，我们概述了[中子扩散理论](@entry_id:160104)在核[反应堆物理](@entry_id:158170)中的核心地位。本章将深入探讨该理论的根本原理与核心机制。我们将从最基本的中子守恒定律出发，逐步建立起描述中子在介质中行为的数学模型。随后，我们将探讨[稳态](@entry_id:139253)与瞬态条件下的关键物理概念，并最终介绍求解扩散方程的现代数值方法。

### 中子[平衡方程](@entry_id:172166)

所有[中子扩散理论](@entry_id:160104)都建立在一个基本物理原理之上：**中子守恒**。该原理指出，在任意给定的空间体积内，中子数量随时间的变化率等于中子的产生率减去中子的损失率。为了将此物理原理转化为数学形式，我们首先需要定义描述中子场的几个关键物理量。

**中子密度、通量和流**

*   **中子[数密度](@entry_id:895657)** $n(\mathbf{r}, t)$ 是指在位置 $\mathbf{r}$ 和时间 $t$ 处，单位体积内的中子数量。
*   对于一群平均速度为 $\bar{v}$ 的中子，**中子标量通量密度**（简称**通量**） $\phi(\mathbf{r}, t)$ 被定义为中子数密度与平均速度的乘积：$\phi = n \bar{v}$。从物理上看，通量代表了单位体积内所有中子在单位时间内走过的总路程。它之所以是一个核心量，是因为单位体积内的核反应率正比于通量。
*   **中子净流密度**（简称**流**） $\mathbf{J}(\mathbf{r}, t)$ 是一个矢量，描述了在位置 $\mathbf{r}$ 和时间 $t$ 处，单位时间内穿过垂直于该矢量方向的单位面积的中子净数量。

有了这些定义，我们可以在一个固定的控制体积 $V$ 内构建中子平衡方程。中子总数的[瞬时变化率](@entry_id:141382)等于体积内的总产生率减去总损失率。损失包括两种机制：被介质吸收和泄漏出该体积。

$$
\frac{d}{dt} \int_V n(\mathbf{r}, t) \, dV = \text{产生率} - \text{吸收率} - \text{泄漏率}
$$

这些项可以进一步用通量和流来表示 ：

*   **泄漏率**：中子通过体积 $V$ 的边界 $\partial V$ 净流出的速率，由中子流的法向分量在整个边界上的面积分给出：$\int_{\partial V} \mathbf{J} \cdot \hat{\mathbf{n}} \, dA$，其中 $\hat{\mathbf{n}}$ 是指向边界外的[单位法向量](@entry_id:178851)。
*   **[吸收率](@entry_id:144520)**：体积内中子被原子核吸收的总速率。单位体积的吸收率为 $\Sigma_a \phi$，其中 $\Sigma_a$ 是**宏观[吸收截面](@entry_id:172609)**。因此，体积 $V$ 内的总[吸收率](@entry_id:144520)为 $\int_V \Sigma_a \phi \, dV$。
*   **产生率**：中子的产生主要来自[核裂变](@entry_id:145236)和外部中子源。单位体积的裂变产生率为 $\nu \Sigma_f \phi$，其中 $\Sigma_f$ 是**宏观裂变[截面](@entry_id:154995)**，$\nu$ 是每次裂变释放的平均中子数。外部源的产生率记为 $S_{\mathrm{ext}}$。总体积内的总产生率为 $\int_V (\nu \Sigma_f \phi + S_{\mathrm{ext}}) \, dV$。

在[稳态](@entry_id:139253)条件下（$\frac{d}{dt} = 0$），产生率必须精确地平衡损失率，即：

$$
\text{产生率} = \text{吸收率} + \text{泄漏率}
$$

将各项代入，我们得到[稳态](@entry_id:139253)积分形式的中子平衡方程：

$$
\int_{V} \left(\nu \Sigma_f \phi + S_{\mathrm{ext}}\right) \, dV = \int_{V} \Sigma_a \phi \, dV + \int_{\partial V} \mathbf{J} \cdot \hat{\mathbf{n}} \, dA
$$

这个方程清晰地阐述了中子经济学的基本原理：在一个[稳态](@entry_id:139253)系统中，所有来源（裂变和外部源）产生的中子必须等于所有去处（吸收和泄漏）消失的中子 。

**[扩散近似](@entry_id:147930)：菲克定律**

上述积分平衡方程包含两个未知场：通量 $\phi$ 和流 $\mathbf{J}$。为了使问题可解，我们需要一个连接这两个量的**[本构关系](@entry_id:186508)**。在散射远比吸收频繁的介质中，中子的运动可以近似看作一种[扩散过程](@entry_id:268015)。**菲克定律 (Fick's Law)** 正是描述这种过程的[本构关系](@entry_id:186508)，它假设中子净流与通量的负梯度成正比：

$$
\mathbf{J}(\mathbf{r}, t) = -D \nabla \phi(\mathbf{r}, t)
$$

这里的比例常数 $D$ 被称为**扩散系数**。负号具有深刻的物理意义：它表示中子的净流动方向是从高通量区域流向低通量区域，即顺着浓度[梯度下降](@entry_id:145942)的方向，这与[热力学](@entry_id:172368)第二定律相符。扩散系数 $D$ 表征了介质对中子迁移的阻碍程度。

**[扩散方程](@entry_id:170713)的[微分形式](@entry_id:146747)**

将[菲克定律](@entry_id:155177)代入积分平衡方程，并应用[高斯散度定理](@entry_id:188065)（$\int_{\partial V} \mathbf{J} \cdot \hat{\mathbf{n}} \, dA = \int_V \nabla \cdot \mathbf{J} \, dV$），我们可以将面积分转化为体积分。由于控制体积 $V$ 的任意性，被积函数必须处处相等，从而得到中子扩散方程的[微分形式](@entry_id:146747)。对于一个单能群模型，时间相关的[扩散方程](@entry_id:170713)为：

$$
\frac{1}{\bar{v}} \frac{\partial \phi}{\partial t} = - \nabla \cdot \mathbf{J} - \Sigma_a \phi + \nu \Sigma_f \phi + S_{\mathrm{ext}}
$$

将菲克定律代入，得到最终形式：

$$
\frac{1}{\bar{v}} \frac{\partial \phi(\mathbf{r}, t)}{\partial t} = \nabla \cdot [D \nabla \phi(\mathbf{r}, t)] - \Sigma_a \phi(\mathbf{r}, t) + \nu \Sigma_f \phi(\mathbf{r}, t) + S_{\mathrm{ext}}(\mathbf{r}, t)
$$

这个[偏微分](@entry_id:194612)方程是[中子扩散理论](@entry_id:160104)的基石，它为我们提供了一个强大的工具来预测中子通量在空间和时间上的分布。

### [稳态扩散](@entry_id:154663)与临界理论

在许多反应堆分析应用中，我们关心的是反应堆在稳定功率下运行的情形，即[稳态](@entry_id:139253)。在[稳态](@entry_id:139253)下，通量不随时间变化（$\frac{\partial \phi}{\partial t} = 0$）。对于一个没有外部源（$S_{\mathrm{ext}}=0$）的系统，例如一个独立运行的反应堆，[稳态扩散](@entry_id:154663)方程描述了维持链式反应的条件。

为了描述系统的自持能力，我们引入**有效中子增殖因子** $k_{\mathrm{eff}}$（或简称 $k$）。它被定义为系统中一代中子产生的总数与上一代中子损失的总数之比。在数学上，我们将裂变源项除以 $k$ 来表示这种平衡关系：

$$
-\nabla \cdot (D \nabla \phi) + \Sigma_a \phi = \frac{1}{k} \nu \Sigma_f \phi
$$

这是一个本征值问题，其中 $k$ 是本征值，$\phi$ 是对应的[本征函数](@entry_id:154705)（即通量分布）。物理上，这意味着：
*   $k > 1$：**超临界**状态，中子数量和功率随时间增长。
*   $k = 1$：**临界**状态，链式反应自持，中子数量和功率恒定。
*   $k  1$：**次临界**状态，如果没有外部源，链式反应将逐渐熄灭。

**[几何曲率](@entry_id:1125603)和材料曲率**

对于一个均匀（即 $D, \Sigma_a, \Sigma_f$ 均为常数）的裸堆（无反射层），临界方程可以重写为[亥姆霍兹方程](@entry_id:149977)的形式：

$$
\nabla^2 \phi + B^2 \phi = 0, \quad \text{其中} \quad B^2 = \frac{\frac{1}{k}\nu\Sigma_f - \Sigma_a}{D}
$$

这里的 $B^2$ 称为**曲率 (Buckling)**，因为它决定了通量分布的[空间曲率](@entry_id:755140)。这个概念可以进一步分为两类：

1.  **材料曲率** ($B_m^2$)：它仅由介质的材料性质决定，描述了材料产生和吸收中子的固有能力。对于一个临界系统（$k=1$），材料曲率为：
    $$
    B_m^2 = \frac{\nu\Sigma_f - \Sigma_a}{D}
    $$
    只有当 $\nu\Sigma_f > \Sigma_a$ 时，$B_m^2$ 才为正，系统才有可能达到临界。

2.  **[几何曲率](@entry_id:1125603)** ($B_g^2$)：它由反应堆的几何形状和边界条件决定，是[亥姆霍兹方程](@entry_id:149977)在给定几何区域上的最低（基模）本征值。例如，对于一个厚度为 $L$、边界通量为零的一维板堆，其[几何曲率](@entry_id:1125603)为 $B_g^2 = (\pi/L)^2$。

一个裸堆达到临界的条件是其材料曲率必须恰好等于其[几何曲率](@entry_id:1125603)，即 $B_m^2 = B_g^2$  。这个条件直观地解释了临界尺寸的概念：对于给定的材料，必须有足够大的尺寸（即足够小的[几何曲率](@entry_id:1125603)或泄漏）才能使[中子产生](@entry_id:1128705)率补偿[吸收率](@entry_id:144520)和泄漏率，从而实现临界。

### 扩散理论中的关键参数

从[扩散方程](@entry_id:170713)的解中，我们可以定义一系列具有明确物理意义的参数，它们是理解中子迁移行为的基石。

**扩散长度 (Diffusion Length)**

**扩散长度** $L$ 是衡量中子在被吸收前能够扩散多远的特征距离。为了理解它，我们可以考虑一个在无限大、非增殖介质中的点中子源问题。[稳态扩散](@entry_id:154663)方程为 $D \nabla^2 \phi - \Sigma_a \phi = 0$（在源点之外）。该方程可以写成 $\nabla^2 \phi - \frac{1}{L^2}\phi = 0$，其中我们定义了**扩散面积** $L^2 = D/\Sigma_a$。在球[对称坐标](@entry_id:182618)下，其解的形式为 $\phi(r) \propto \frac{\exp(-r/L)}{r}$。指数衰减项表明，通量随着距离的增加而迅速减小，其[特征衰减长度](@entry_id:183295)正是 $L$。因此，扩散长度代表了热中子从产生到被吸收所行进的“直线”距离的量度  。

**[各向异性散射](@entry_id:148372)与[输运截面](@entry_id:1133392)**

[菲克定律](@entry_id:155177)实际上是基于[中子散射](@entry_id:142835)是各向同性的假设。然而，在实际情况中，尤其是在高能区，[中子散射](@entry_id:142835)往往是前向的（即散射后的运动方向与入射方向夹角较小）。[前向散射](@entry_id:191808)在改变中子运动方向上效率较低，相当于增加了中子的“有效”平均自由程。为了修正这一点，我们引入了**[输运截面](@entry_id:1133392)** $\Sigma_{\mathrm{tr}}$。在[P1近似](@entry_id:152048)（扩散理论的一种更严格的推导）下，[输运截面](@entry_id:1133392)定义为 ：

$$
\Sigma_{\mathrm{tr}} = \Sigma_t - \Sigma_{s1} = \Sigma_a + \Sigma_s - \bar{\mu}\Sigma_s = \Sigma_a + (1-\bar{\mu})\Sigma_s
$$

其中 $\Sigma_t$ 是[总截面](@entry_id:151809)，$\Sigma_s$ 是[散射截面](@entry_id:140322)，而 $\bar{\mu}$ 是[实验室坐标系](@entry_id:166991)下[散射角](@entry_id:171822)余弦的平均值。对于各向同性散射，$\bar{\mu}=0$，[输运截面](@entry_id:1133392)退化为[总截面](@entry_id:151809) $\Sigma_t$。考虑了[各向异性散射](@entry_id:148372)后，扩散系数更准确的定义为：

$$
D = \frac{1}{3\Sigma_{\mathrm{tr}}}
$$

**反射层与[反射层节省](@entry_id:1130781) (Reflector Savings)**

为了减少中子从堆芯的泄漏并提高中子利用经济性，反应堆堆芯通常被非增殖的**反射层**材料（如水、石墨或铍）包围。从反射层散射回堆芯的中子可以继续参与链式反应。

反射层的效应可以通过一个称为**[反射层节省](@entry_id:1130781)** ($s$) 的参数来量化 。考虑一个半厚度为 $a$ 的板式堆芯，两侧是半无限厚的反射层。我们可以分别在堆芯区和反射区求解[稳态扩散](@entry_id:154663)方程：

*   堆芯区 ($|x|  a$): $\frac{d^2\phi_c}{dx^2} + B_c^2 \phi_c = 0 \implies \phi_c(x) = A \cos(B_c x)$
*   反射区 ($x > a$): $\frac{d^2\phi_r}{dx^2} - \kappa_r^2 \phi_r = 0 \implies \phi_r(x) = F e^{-\kappa_r x}$ (其中 $\kappa_r = 1/L_r$ 是反射层材料扩散长度的倒数)

在堆芯-反射层界面 $x=a$ 处，中子通量和中子流必须连续。通过这两个边界条件，我们可以消去待定系数，得到该系统的[临界条件](@entry_id:201918)：$D_c B_c \tan(B_c a) = D_r \kappa_r$。

[反射层节省](@entry_id:1130781) $s$ 定义为：有反射层时的临界半厚度 $a$ 与一个等效的、为达到临界所需要的裸堆的**外推半厚度** $\tilde{a}$ 之差，即 $s = \tilde{a} - a$。裸堆的外推半厚度满足 $B_c \tilde{a} = \pi/2$。将 $a = \tilde{a} - s$ 代入[临界条件](@entry_id:201918)，并利用[三角函数](@entry_id:178918)关系，可以推导出[反射层节省](@entry_id:1130781)的表达式：

$$
s = \frac{1}{B_c} \arctan\left(\frac{D_c B_c}{D_r \kappa_r}\right)
$$

[反射层节省](@entry_id:1130781)的物理意义是，由于反射层的存在，要达到相同的临界状态，堆芯的物理尺寸可以减小 $s$ 的厚度。这对于设计紧凑型反应堆至关重要。

### [多群扩散](@entry_id:1128303)理论

单能群模型假设所有中子的行为都由一组平均[截面](@entry_id:154995)来描述，这是一个巨大的简化。实际上，核截面强烈依赖于中子能量。为了更精确地模拟反应堆，**[多群扩散](@entry_id:1128303)理论**将能量范围划分为多个离散的能量群。

在多群模型中，我们为每个能量群 $g$ 建立一个扩散方程。这些方程通过散射项和裂变源项相互耦合。对于一个[稳态](@entry_id:139253)系统，第 $g$ 群的扩散方程的一般形式为：

$$
-\nabla \cdot (D_g \nabla \phi_g) + \Sigma_{R,g} \phi_g = \sum_{g' \neq g} \Sigma_{s,g' \to g} \phi_{g'} + \frac{\chi_g}{k} \sum_{g'} \nu\Sigma_{f,g'} \phi_{g'}
$$

这里：
*   $\Sigma_{R,g} = \Sigma_{a,g} + \sum_{g' \neq g} \Sigma_{s,g \to g'}$ 是**移出[截面](@entry_id:154995)**，描述了中子因吸收或散射到其他能量群而从第 $g$ 群中移出的总概率。
*   $\Sigma_{s,g' \to g}$ 是从中子群 $g'$ 散射到中子群 $g$ 的**群间转移[截面](@entry_id:154995)**。
*   $\chi_g$ 是裂变产生的中子出现在第 $g$ 群的份额，即**裂变谱**。

作为一个具体的例子，我们考虑一个简化的双群模型（快中子群1和[热中子](@entry_id:270226)群2），并假设没有上散射（即热中子不能散射成快中子），且所有裂变中子都出生在快中子群  。此时，[稳态](@entry_id:139253)方程组变为：

*   快中子群 (g=1): $-\nabla \cdot (D_1 \nabla \phi_1) + (\Sigma_{a,1} + \Sigma_{s,1 \to 2})\phi_1 = \frac{1}{k}(\nu\Sigma_{f,1}\phi_1 + \nu\Sigma_{f,2}\phi_2)$
*   热中子群 (g=2): $-\nabla \cdot (D_2 \nabla \phi_2) + \Sigma_{a,2}\phi_2 = \Sigma_{s,1 \to 2}\phi_1$

对于一个均匀系统，我们可以再次使用曲率概念，令 $\nabla^2 \phi_g = -B^2 \phi_g$，将[偏微分方程组](@entry_id:172573)转化为[代数方程](@entry_id:272665)组。从热中子群的[平衡方程](@entry_id:172166)可以直接解出快、热通量之比：

$$
r = \frac{\phi_1}{\phi_2} = \frac{D_2 B^2 + \Sigma_{a,2}}{\Sigma_{s,1 \to 2}}
$$

这个比值反映了反应堆内**中子能谱的硬度**。比值越大，意味着快中子相对越多，能谱越“硬” 。

在多群理论框架下，中子的总迁移过程可以被更精细地描述。**慢化长度** $L_f$ 和**迁移长度** $M$ 就是这样的概念。慢化长度与中子从裂变能量慢化到热能的过程中的迁移距离有关，其平方（**慢化面积**）定义为 $L_f^2 = D_f / \Sigma_{R,f}$。迁移长度 $M$ 则描述了中子从作为快中子诞生到作为热中子被吸收所经过的总[均方根](@entry_id:263605)距离。由于慢化和热扩散是两个连续且独立的[随机过程](@entry_id:268487)，总的均方距离是各个阶段均方距离之和。因此，**迁移面积** $M^2$ 等于慢化面积与热扩散面[积之和](@entry_id:266697) ：

$$
M^2 = L_f^2 + L_t^2
$$

### 反应堆动力学与[点动力学模型](@entry_id:1129861)

现在我们回到时间相关的过程，特别是引入**缓发中子**的影响。大部分（约99.35%）裂变中子是瞬时产生的（称为**瞬发中子**），但一小部分（约0.65%）是由[裂变产物](@entry_id:1125033)（称为**缓发中子先驱核**）经过 $\beta$ 衰变后发射的，存在一定的延迟。尽管数量很少，但这部分缓发中子极大地延长了链式反应的有效中子代际时间，使得反应堆可以被安全地控制。

为了在扩散方程中包含缓发中子，我们引入先驱核浓度 $C(\mathbf{r}, t)$、缓发中子份额 $\beta$ 和先驱核[衰变常数](@entry_id:149530) $\lambda$。一个简化的含有一组缓发中子先驱核的[扩散方程](@entry_id:170713)组如下 ：

$$
\frac{1}{\bar{v}}\frac{\partial \phi}{\partial t} = \nabla \cdot (D \nabla \phi) - \Sigma_a \phi + (1-\beta)\nu\Sigma_f \phi + \lambda C
$$
$$
\frac{\partial C}{\partial t} = \beta \nu\Sigma_f \phi - \lambda C
$$

对于复杂的几何和材料分布，直接求解这个方程组非常困难。一个极其有用的简化是**[点动力学模型](@entry_id:1129861)**。该模型假设通量的空间形状不随时间改变，即 $\phi(\mathbf{r}, t) = F(t)\Psi(\mathbf{r})$，其中 $F(t)$ 是时间依赖的振幅，$\Psi(\mathbf{r})$ 是基波空间形状。通过在整个反应堆体积上对空间变量进行积分，我们可以得到一组描述总中子数变化的常微分方程，即[点动力学方程](@entry_id:1129860)：

$$
\frac{dF(t)}{dt} = \frac{\rho - \beta}{\Lambda} F(t) + \lambda C(t)
$$
$$
\frac{dC(t)}{dt} = \frac{\beta}{\Lambda} F(t) - \lambda C(t)
$$

其中，**反应性** $\rho = (k_{\mathrm{eff}} - 1)/k_{\mathrm{eff}}$ 是衡量系统偏离临界程度的无量纲量，而**瞬发[中子[代时](@entry_id:1128698)](@entry_id:173412)间** $\Lambda$ 是[瞬发中子](@entry_id:161367)从产生到被吸收的平均时间。

**瞬发跳变 (Prompt Jump)**

[点动力学方程](@entry_id:1129860)揭示了一个重要的现象：**瞬发跳变**。当向反应堆中瞬间引入一步阶的反应性 $\rho$ 时（例如，通过快速抽出一根控制棒），中子通量会在极短的时间内（在 $\Lambda$ 的时间尺度上，通常是微秒级）发生一次“跳变”。先驱核浓度由于其衰变过程的“惯性”而不能瞬时改变。通过分析 $t=0^+$ 时刻的[点动力学方程](@entry_id:1129860)，并利用先驱核浓度连续的条件 $C(0^+) = C(0^-)$，可以推导出通量在跳变前后的关系 ：

$$
F(0^+) = \frac{\beta}{\beta - \rho} F(0^-)
$$

这个公式表明，对于一个正的[反应性插入](@entry_id:1130664)（$\rho > 0$），通量会瞬间上升。特别地，当 $\rho = \beta$ 时，分母为零，通量理论上会瞬时变为无穷大。这个状态被称为**[瞬发临界](@entry_id:159881)**，是[反应堆设计](@entry_id:190145)中必须极力避免的危险工况。

### [扩散方程](@entry_id:170713)的数值方法

解析解只有在极少数高度简化的理想情况下才能得到。对于真实的、具有复杂几何形状和非均匀材料的反应堆，必须依赖数值方法求解扩散方程。

**节块法 (Nodal Methods)**

**节块法**是一种高效的数值方法，特别适用于反应堆物理计算。它将反应堆划分为一系列相对较大的、[材料性质](@entry_id:146723)均匀的区域，称为**节块 (node)**。该方法不是直接离散[微分](@entry_id:158422)方程，而是从每个节块的积分中子[平衡方程](@entry_id:172166)出发 ：

$$
(\text{流出节块的净泄漏}) + (\text{节块内的吸收}) = (\text{节块内的源})
$$
$$
(J_{i+1/2} - J_{i-1/2}) + \Sigma_{a,i} h_i \bar{\phi}_i = Q_i h_i
$$

这里的核心挑战在于如何建立节块间的耦合关系，即如何用节块平均通量 $\bar{\phi}_i$ 来表示界面[中子流](@entry_id:1128689) $J_{i\pm1/2}$。一种常见且有效的方法是**粗网[有限差分法](@entry_id:1124968) (CMFD)**，它引入**界面电阻**的概念，将界面中子流近似表示为相邻节块平均通量之差除以一个总电阻 ：

$$
J_{i+1/2} \approx -\frac{\bar{\phi}_{i+1} - \bar{\phi}_i}{R_{i+1/2}}
$$

这样，我们最终得到一个关于所有节块平均通量 $\bar{\phi}_i$ 的线性代数方程组，求解该方程组即可得到全堆的宏观通量分布。

**有限元法 (Finite Element Method, FEM)**

**有限元法**是[求解偏微分方程](@entry_id:138485)的另一种功能强大且应用广泛的数值技术。与直接在网格点上近似[微分算子](@entry_id:140145)不同，FEM从方程的**[弱形式](@entry_id:142897) (weak form)** 出发 。

首先，将原始[微分](@entry_id:158422)方程乘以一个任意的**测试函数** $v$，然后在整个求解域上积分。通过分部积分，可以将一个微分算子从待求的通量 $\phi$ “转移”到[测试函数](@entry_id:166589) $v$ 上。对于扩散方程，这个过程会得到如下的弱形式：

$$
\int \left( D \frac{d\phi}{dx} \frac{dv}{dx} + \Sigma_a \phi v \right) dx = \int S v \, dx
$$

这个方程对于所有满足边界条件的合格测试函数 $v$ 都必须成立。[弱形式](@entry_id:142897)的优点是它降低了对解的光滑性要求。同时，可以证明，满足弱形式的解也正是使某个**能量泛函** $\mathcal{J}(\phi)$ 达到最小值的解，这为方法提供了坚实的变分原理基础 。

在**伽辽金 (Galerkin)**[有限元法](@entry_id:749389)中，我们将求解域划分为许多小的“单元”，并在每个单元内用简单的**基函数**（如线性“帽子”函数）的[线性组合](@entry_id:154743)来近似真实的解 $\phi$。关键思想是选择与基函数相同的函数作为测试函数。将这个近似解代入弱形式，并要求它对每个基函数都成立，最终会导出一个关于待定系数（即各节点的通量值）的线性[代数方程](@entry_id:272665)组。通过求解这个方程组，我们便可以得到整个求解域上的数值解。

节块法和有限元法代表了求解[扩散方程](@entry_id:170713)的两种主流思想，它们在现代[反应堆设计](@entry_id:190145)和安全分析程序中都扮演着不可或缺的角色。