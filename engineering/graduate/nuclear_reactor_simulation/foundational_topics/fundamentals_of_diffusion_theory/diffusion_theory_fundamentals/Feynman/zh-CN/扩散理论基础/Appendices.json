{
    "hands_on_practices": [
        {
            "introduction": "理解中子能量分布（即能谱）是反应堆分析的基础。本练习将演示中子在各能群间的产生、吸收、泄漏和能量转移的平衡关系如何决定此能谱。通过引入几何曲率的概念来简化空间维度，使我们能专注于能群间的耦合关系，并计算出关键的通量比。",
            "id": "4222182",
            "problem": "考虑一个均匀、各向同性的反应堆区域，采用双能群模型进行描述，标记为第$1$群（快中子群）和第$2$群（热中子群）。假设从热中子群到快中子群的升散射可以忽略不计，因此 $\\Sigma_{s,2 \\rightarrow 1} = 0$，并且所有裂变中子都产生在快中子群中，因此裂变发射谱满足 $\\chi_{1} = 1$ 和 $\\chi_{2} = 0$。该系统处于稳态，并维持一个基波中子模式，该模式具有对两个群都相同的可分离空间形状，仅幅度常数不同。测得该基波模式的几何曲率为 $B^{2} = 0.0050 \\ \\mathrm{cm}^{-2}$。其控制物理学必须从第一性原理出发，使用多群中子平衡方程和菲克扩散定律推导，即流密度 $\\mathbf{J}_{g} = - D_{g} \\nabla \\phi_{g}$ 和每个群 $g$ 的稳态中子平衡方程 $- \\nabla \\cdot \\mathbf{J}_{g} + \\Sigma_{r,g} \\phi_{g} = \\text{源项}$，其中在给定假设下 $\\Sigma_{r,1} = \\Sigma_{a,1} + \\Sigma_{s,1 \\rightarrow 2}$ 且 $\\Sigma_{r,2} = \\Sigma_{a,2}$。产生截面为 $\\nu \\Sigma_{f,g}$，其中 $\\nu$ 是每次裂变的平均中子数，$\\Sigma_{f,g}$ 是群 $g$ 的宏观裂变截面。有效中子增殖因子（k），记为 $k$，将裂变源分配为 $(1/k)\\sum_{g} \\chi_{g} \\nu \\Sigma_{f,g} \\phi_{g}$。\n\n从这些定律和定义出发，通过模式曲率消除空间依赖性，推导出基波模式的耦合双能群扩散平衡方程。然后，使用给定的数据：\n- $D_{1} = 1.2 \\ \\mathrm{cm}$，$D_{2} = 0.40 \\ \\mathrm{cm}$，\n- $\\Sigma_{a,1} = 0.012 \\ \\mathrm{cm}^{-1}$，$\\Sigma_{s,1 \\rightarrow 2} = 0.080 \\ \\mathrm{cm}^{-1}$，\n- $\\Sigma_{a,2} = 0.100 \\ \\mathrm{cm}^{-1}$，\n- $\\nu \\Sigma_{f,1} = 0.020 \\ \\mathrm{cm}^{-1}$，$\\nu \\Sigma_{f,2} = 0.180 \\ \\mathrm{cm}^{-1}$，\n- $B^{2} = 0.0050 \\ \\mathrm{cm}^{-2}$，\n\n计算快中子群基波模式幅度与热中子群基波模式幅度的比值 $r$，定义为 $r = \\phi_{1}/\\phi_{2}$，其中 $\\phi_{g}$ 表示基波模式中群 $g$ 的中子通量幅度。\n\n将你的答案表示为一个纯数（无量纲），并四舍五入到四位有效数字。",
            "solution": "首先根据指定标准对用户提供的问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n-   **模型：** 均匀、各向同性反应堆，双能群（第$1$群：快中子，第$2$群：热中子）。\n-   **假设：**\n    -   无升散射：$\\Sigma_{s,2 \\rightarrow 1} = 0$。\n    -   裂变谱：$\\chi_{1} = 1$，$\\chi_{2} = 0$。\n    -   稳态：中子通量的时间导数为零。\n    -   基波模式：通量在空间上是可分离的，$\\phi_{g}(\\mathbf{r}) = \\phi_{g} \\Psi(\\mathbf{r})$，其中 $\\Psi(\\mathbf{r})$ 对两个群都相同。\n-   **控制定律：**\n    -   菲克定律 (Fick's Law)：$\\mathbf{J}_{g} = - D_{g} \\nabla \\phi_{g}$。\n    -   中子平衡：$- \\nabla \\cdot \\mathbf{J}_{g} + \\Sigma_{r,g} \\phi_{g} = \\text{源项}$。\n    -   移出截面：$\\Sigma_{r,1} = \\Sigma_{a,1} + \\Sigma_{s,1 \\rightarrow 2}$，$\\Sigma_{r,2} = \\Sigma_{a,2}$。\n    -   裂变源：通过 $(1/k)$ 分配为 $\\frac{1}{k}\\sum_{g} \\chi_{g} \\nu \\Sigma_{f,g} \\phi_{g}$。\n-   **数据：**\n    -   几何曲率：$B^{2} = 0.0050 \\ \\mathrm{cm}^{-2}$。\n    -   扩散系数：$D_{1} = 1.2 \\ \\mathrm{cm}$，$D_{2} = 0.40 \\ \\mathrm{cm}$。\n    -   宏观截面：\n        -   $\\Sigma_{a,1} = 0.012 \\ \\mathrm{cm}^{-1}$。\n        -   $\\Sigma_{s,1 \\rightarrow 2} = 0.080 \\ \\mathrm{cm}^{-1}$。\n        -   $\\Sigma_{a,2} = 0.100 \\ \\mathrm{cm}^{-1}$。\n        -   $\\nu \\Sigma_{f,1} = 0.020 \\ \\mathrm{cm}^{-1}$。\n        -   $\\nu \\Sigma_{f,2} = 0.180 \\ \\mathrm{cm}^{-1}$。\n-   **目标：** 计算比值 $r = \\phi_{1}/\\phi_{2}$，其中 $\\phi_{g}$ 是基波模式幅度。\n\n**步骤2：使用提取的已知条件进行验证**\n\n-   **科学依据：** 该问题是双能群中子扩散理论的一个标准应用，这是核反应堆物理学中一个基础且成熟的模型。\n-   **适定性：** 该问题提供了一套完整的方程和数据，足以唯一确定所求的通量比。\n-   **客观性：** 该问题以精确、正式的语言陈述，没有主观或含糊的术语。\n-   **完整性与一致性：** 指定模型所需的所有参数均已提供。单位在全文中保持一致。没有内部矛盾。\n-   **真实性：** 所提供的中子学参数的数值对于一个核反应堆系统来说在物理上是合理的。\n\n**步骤3：结论与行动**\n\n该问题在科学上是合理的、适定的和自洽的。因此，它被判定为**有效**。我们开始进行求解。\n\n### 解题推导\n\n每个能量群 $g$ 的稳态中子平衡方程为：\n$$-\\nabla \\cdot \\mathbf{J}_{g}(\\mathbf{r}) + \\Sigma_{r,g} \\phi_{g}(\\mathbf{r}) = \\sum_{g' \\ne g} \\Sigma_{s,g' \\rightarrow g} \\phi_{g'}(\\mathbf{r}) + \\frac{\\chi_{g}}{k} \\sum_{g'} \\nu\\Sigma_{f,g'} \\phi_{g'}(\\mathbf{r})$$\n代入菲克定律 $\\mathbf{J}_{g} = -D_{g} \\nabla\\phi_{g}$，并假设在均匀介质中 $D_g$ 为常数，我们得到：\n$$D_{g} \\nabla^2 \\phi_{g}(\\mathbf{r}) - \\Sigma_{r,g} \\phi_{g}(\\mathbf{r}) + \\sum_{g' \\ne g} \\Sigma_{s,g' \\rightarrow g} \\phi_{g'}(\\mathbf{r}) + \\frac{\\chi_{g}}{k} \\sum_{g'} \\nu\\Sigma_{f,g'} \\phi_{g'}(\\mathbf{r}) = 0$$\n\n将给定条件应用于双能群模型：\n\n**第1群（快中子群）：**\n对于群 $g=1$，散射源来自第2群，为 $\\Sigma_{s,2 \\rightarrow 1}\\phi_2$。裂变源为 $\\frac{\\chi_{1}}{k} (\\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2)$。\n根据问题的设定，$\\Sigma_{s,2 \\rightarrow 1} = 0$ 且 $\\chi_{1} = 1$。移出截面为 $\\Sigma_{r,1} = \\Sigma_{a,1} + \\Sigma_{s,1 \\rightarrow 2}$。\n快中子群的平衡方程是：\n$$D_{1} \\nabla^2 \\phi_{1}(\\mathbf{r}) - (\\Sigma_{a,1} + \\Sigma_{s,1 \\rightarrow 2}) \\phi_{1}(\\mathbf{r}) + \\frac{1}{k} (\\nu\\Sigma_{f,1} \\phi_{1}(\\mathbf{r}) + \\nu\\Sigma_{f,2} \\phi_{2}(\\mathbf{r})) = 0$$\n\n**第2群（热中子群）：**\n对于群 $g=2$，散射源来自第1群，为 $\\Sigma_{s,1 \\rightarrow 2}\\phi_1$。裂变源为 $\\frac{\\chi_{2}}{k} (\\nu\\Sigma_{f,1}\\phi_1 + \\nu\\Sigma_{f,2}\\phi_2)$。\n根据问题设定 $\\chi_{2} = 0$，该群的裂变源项为零。由于 $\\Sigma_{s,2 \\rightarrow 1}=0$，移出截面为 $\\Sigma_{r,2} = \\Sigma_{a,2}$。\n热中子群的平衡方程是：\n$$D_{2} \\nabla^2 \\phi_{2}(\\mathbf{r}) - \\Sigma_{a,2} \\phi_{2}(\\mathbf{r}) + \\Sigma_{s,1 \\rightarrow 2} \\phi_{1}(\\mathbf{r}) = 0$$\n\n问题陈述该系统维持一个基波模式，该模式具有对两个群都相同的可分离空间形状 $\\Psi(\\mathbf{r})$，使得 $\\phi_{g}(\\mathbf{r}) = \\phi_{g} \\Psi(\\mathbf{r})$，其中 $\\phi_g$ 是常数幅度。该空间模式是拉普拉斯算子的本征函数，满足 $\\nabla^2 \\Psi(\\mathbf{r}) = -B^2 \\Psi(\\mathbf{r})$，其中 $B^2$ 是几何曲率。\n将 $\\nabla^2 \\phi_g = -B^2 \\phi_g$ 代入平衡方程，并除以共同的模式形状 $\\Psi(\\mathbf{r})$，得到关于幅度 $\\phi_1$ 和 $\\phi_2$ 的一组代数方程：\n\n1.  快中子群：$-D_{1} B^2 \\phi_{1} - (\\Sigma_{a,1} + \\Sigma_{s,1 \\rightarrow 2}) \\phi_{1} + \\frac{1}{k} (\\nu\\Sigma_{f,1} \\phi_{1} + \\nu\\Sigma_{f,2} \\phi_{2}) = 0$\n2.  热中子群：$-D_{2} B^2 \\phi_{2} - \\Sigma_{a,2} \\phi_{2} + \\Sigma_{s,1 \\rightarrow 2} \\phi_{1} = 0$\n\n目标是求出比值 $r = \\phi_{1}/\\phi_{2}$。这个比值可以直接从热中子群的代数方程中确定。热中子群的平衡方程表明，由降散射产生的中子率必须等于因吸收和泄漏导致的损失率。\n重新整理热中子群方程：\n$$\\Sigma_{s,1 \\rightarrow 2} \\phi_{1} = D_{2} B^2 \\phi_{2} + \\Sigma_{a,2} \\phi_{2}$$\n在等式右边提取公因式 $\\phi_2$：\n$$\\Sigma_{s,1 \\rightarrow 2} \\phi_{1} = (D_{2} B^2 + \\Sigma_{a,2}) \\phi_{2}$$\n求解比值 $r = \\phi_{1}/\\phi_{2}$：\n$$r = \\frac{\\phi_{1}}{\\phi_{2}} = \\frac{D_{2} B^2 + \\Sigma_{a,2}}{\\Sigma_{s,1 \\rightarrow 2}}$$\n注意，一些给定的数据（$D_1$, $\\Sigma_{a,1}$, $\\nu\\Sigma_{f,1}$, $\\nu\\Sigma_{f,2}$）在计算此比值时是不需要的，因为它们仅出现在快中子群方程中，而该方程决定的是整个系统的增殖因子 $k$。\n\n现在，我们将给定的数值代入 $r$ 的表达式中：\n-   $D_{2} = 0.40 \\ \\mathrm{cm}$\n-   $B^{2} = 0.0050 \\ \\mathrm{cm}^{-2}$\n-   $\\Sigma_{a,2} = 0.100 \\ \\mathrm{cm}^{-1}$\n-   $\\Sigma_{s,1 \\rightarrow 2} = 0.080 \\ \\mathrm{cm}^{-1}$\n\n$$r = \\frac{(0.40) \\cdot (0.0050) + 0.100}{0.080}$$\n首先，计算分子中的泄漏项：\n$$D_{2} B^2 = (0.40 \\ \\mathrm{cm}) \\cdot (0.0050 \\ \\mathrm{cm}^{-2}) = 0.0020 \\ \\mathrm{cm}^{-1}$$\n现在，对分子中的各项求和：\n$$D_{2} B^2 + \\Sigma_{a,2} = 0.0020 \\ \\mathrm{cm}^{-1} + 0.100 \\ \\mathrm{cm}^{-1} = 0.1020 \\ \\mathrm{cm}^{-1}$$\n最后，执行除法运算：\n$$r = \\frac{0.1020 \\ \\mathrm{cm}^{-1}}{0.080 \\ \\mathrm{cm}^{-1}} = 1.275$$\n结果是一个无量纲的量。问题要求答案四舍五入到四位有效数字。计算出的值 $1.275$ 已经恰好是四位有效数字。",
            "answer": "$$\\boxed{1.275}$$"
        },
        {
            "introduction": "真实反应堆通常是包含不同材料区域的非均匀系统。本练习探讨了裂变堆芯与非裂变反射层之间的关键相互作用。通过在界面处应用中子通量和中子流的连续性条件，我们将推导出“反射层节省”这一重要概念，它量化了反射层对提高中子经济性的贡献，是反应堆物理设计中的一个核心参数。",
            "id": "4222186",
            "problem": "一个一维、对称、带反射层的平板在一能群模型下进行建模。可裂变堆芯占据区域 $|x| < a$，并被一个无限厚的非增殖反射层所包围。堆芯和反射层的材料属性（扩散系数 $D$，宏观吸收截面 $\\Sigma_a$，以及仅用于堆芯的宏观产生截面 $\\nu\\Sigma_f$）被认为是已知的分区常数，并分别用下标 'c' 和 'r' 表示。假设系统处于临界状态 ($k=1$)，并且中子通量遵循基波模态。\n\n首先，推导出在堆芯-反射层交界面 $x=a$ 处，堆芯通量 $\\phi_c(x)$ 必须满足的边界条件。该条件应将通量及其导数与反射层属性 ($D_r, \\Sigma_{a,r}$) 联系起来。然后，推导出反射层节省 $s$ 的表达式，其中 $s$ 是反应堆的外推半厚度与物理半厚度之差，即 $s = \\tilde{a} - a$。最后，使用以下给定的数值数据计算反射层节省 $s$ 的值，单位为厘米 $(\\mathrm{cm})$：\n-   $D_c = 1.2\\,\\mathrm{cm}$\n-   $\\Sigma_{a,c} = 8.0 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n-   $\\nu \\Sigma_{f,c} = 2.0 \\times 10^{-2}\\,\\mathrm{cm}^{-1}$\n-   $D_r = 1.6\\,\\mathrm{cm}$\n-   $\\Sigma_{a,r} = 2.5 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n\n将你的最终数值答案四舍五入到四位有效数字。",
            "solution": "用户提供的问题是单能群中子扩散理论中的一个标准练习，被认为是有效的。我们将进行完整的推导和求解。\n\n在无源区域中，稳态单能群中子扩散方程由下式给出：\n$$\n-D \\frac{d^2 \\phi(x)}{dx^2} + \\Sigma_a \\phi(x) = \\frac{1}{k} \\nu \\Sigma_f \\phi(x)\n$$\n其中 $D$ 是扩散系数，$\\phi(x)$ 是中子标量通量，$\\Sigma_a$ 是宏观吸收截面，$\\nu \\Sigma_f$ 是宏观产生截面，$k$ 是增殖因子。在临界状态下，$k=1$。该方程可以重排为：\n$$\n\\frac{d^2 \\phi(x)}{dx^2} + \\left( \\frac{\\nu \\Sigma_f - \\Sigma_a}{D} \\right) \\phi(x) = 0\n$$\n\n**1. 堆芯区域（$|x|  a$）的解**\n\n在可裂变堆芯中，方程为：\n$$\n\\frac{d^2 \\phi_c(x)}{dx^2} + \\left( \\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c} \\right) \\phi_c(x) = 0\n$$\n我们将堆芯的材料曲率 $B_c^2$ 定义为：\n$$\nB_c^2 = \\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c}\n$$\n问题给出的数据意味着 $\\nu \\Sigma_{f,c}  \\Sigma_{a,c}$，因此 $B_c^2  0$。扩散方程简化为：\n$$\n\\frac{d^2 \\phi_c(x)}{dx^2} + B_c^2 \\phi_c(x) = 0\n$$\n通解为 $\\phi_c(x) = A_1 \\cos(B_c x) + A_2 \\sin(B_c x)$。问题指定了对称平板和基波模，该模必须是 $x$ 的偶函数，即 $\\phi_c(x) = \\phi_c(-x)$。这要求奇函数正弦项的系数为零（$A_2=0$）。因此，堆芯通量为：\n$$\n\\phi_c(x) = A \\cos(B_c x)\n$$\n其中 $A$ 是一个任意振幅。\n\n**2. 反射层区域（$|x|  a$）的解**\n\n在非增殖反射层中，$\\nu \\Sigma_{f,r} = 0$。扩散方程变为：\n$$\n\\frac{d^2 \\phi_r(x)}{dx^2} - \\frac{\\Sigma_{a,r}}{D_r} \\phi_r(x) = 0\n$$\n我们将反射层扩散长度平方的倒数 $\\kappa_r^2$ 定义为：\n$$\n\\kappa_r^2 = \\frac{\\Sigma_{a,r}}{D_r}\n$$\n其中 $\\kappa_r = 1/L_r$，而 $L_r = \\sqrt{D_r/\\Sigma_{a,r}}$ 是扩散长度。在反射层中的方程是：\n$$\n\\frac{d^2 \\phi_r(x)}{dx^2} - \\kappa_r^2 \\phi_r(x) = 0\n$$\n考虑区域 $x  a$，通解为 $\\phi_r(x) = F_1 e^{-\\kappa_r x} + F_2 e^{\\kappa_r x}$。边界条件规定当 $x \\to \\infty$ 时通量必须保持有限。这要求增长的指数项的系数为零（$F_2=0$）。因此，对于 $xa$ 的反射层通量是：\n$$\n\\phi_r(x) = F e^{-\\kappa_r x}\n$$\n\n**3. 交界面条件和反射层边界条件**\n\n在堆芯-反射层交界面（$x=a$）处，我们施加标量通量和中子流的连续性条件。\n中子流由 Fick 定律给出：$J(x) = -D \\frac{d\\phi(x)}{dx}$。\n\n条件 1：通量连续，$\\phi_c(a) = \\phi_r(a)$。\n$$\nA \\cos(B_c a) = F e^{-\\kappa_r a} \\quad (1)\n$$\n\n条件 2：中子流连续，$J_c(a) = J_r(a)$。\n$$\n-D_c \\frac{d\\phi_c}{dx}\\bigg|_{x=a} = -D_r \\frac{d\\phi_r}{dx}\\bigg|_{x=a}\n$$\n导数分别为 $\\frac{d\\phi_c}{dx} = -A B_c \\sin(B_c x)$ 和 $\\frac{d\\phi_r}{dx} = -F \\kappa_r e^{-\\kappa_r x}$。将它们代入 $x=a$ 处：\n$$\n-D_c (-A B_c \\sin(B_c a)) = -D_r (-F \\kappa_r e^{-\\kappa_r a})\n$$\n$$\nD_c A B_c \\sin(B_c a) = D_r F \\kappa_r e^{-\\kappa_r a} \\quad (2)\n$$\n\n为了推导概括了反射层效应的堆芯区边界条件，我们将方程（2）除以方程（1）。未知振幅 $A$ 和 $F$ 被消去：\n$$\n\\frac{D_c A B_c \\sin(B_c a)}{A \\cos(B_c a)} = \\frac{D_r F \\kappa_r e^{-\\kappa_r a}}{F e^{-\\kappa_r a}}\n$$\n$$\nD_c B_c \\tan(B_c a) = D_r \\kappa_r\n$$\n此方程是带反射层平板的临界条件。我们可以将其表示为在 $x=a$ 处对堆芯通量 $\\phi_c(x)$ 的边界条件。在交界面处堆芯通量的对数导数为：\n$$\n\\frac{1}{\\phi_c(a)} \\frac{d\\phi_c}{dx}\\bigg|_{x=a} = \\frac{-A B_c \\sin(B_c a)}{A \\cos(B_c a)} = -B_c \\tan(B_c a)\n$$\n代入临界条件的结果 $B_c \\tan(B_c a) = \\frac{D_r \\kappa_r}{D_c}$：\n$$\n\\frac{1}{\\phi_c(a)} \\frac{d\\phi_c}{dx}\\bigg|_{x=a} = -\\frac{D_r \\kappa_r}{D_c}\n$$\n这就是所要求的边界条件。它可以写成 Robin 型条件：\n$$\nD_c \\frac{d\\phi_c}{dx}\\bigg|_{x=a} + D_r \\kappa_r \\phi_c(a) = 0\n$$\n\n**4. 反射层节省 $s$ 的推导**\n\n反射层节省 $s$ 定义为 $s = \\tilde{a} - a$，其中 $\\tilde{a}$ 是外推半厚度。这是如果堆芯被真空包围，来自堆芯的余弦通量形状将变为零的点。真空边界条件是 $\\phi_c(\\tilde{a})=0$。\n对于堆芯通量 $\\phi_c(x) = A \\cos(B_c x)$，这意味着 $\\cos(B_c \\tilde{a}) = 0$。对于基波（第一个非负）零点，这给出：\n$$\nB_c \\tilde{a} = \\frac{\\pi}{2} \\implies \\tilde{a} = \\frac{\\pi}{2 B_c}\n$$\n根据定义 $s = \\tilde{a} - a$，我们有 $a = \\tilde{a} - s = \\frac{\\pi}{2B_c} - s$。因此，$B_c a = \\frac{\\pi}{2} - B_c s$。\n\n我们将 $B_c a$ 的这个表达式代入前面推导的临界条件：\n$$\nD_c B_c \\tan\\left(\\frac{\\pi}{2} - B_c s\\right) = D_r \\kappa_r\n$$\n使用三角恒等式 $\\tan(\\frac{\\pi}{2} - \\theta) = \\cot(\\theta) = \\frac{1}{\\tan(\\theta)}$，我们得到：\n$$\nD_c B_c \\frac{1}{\\tan(B_c s)} = D_r \\kappa_r\n$$\n重新整理以求解 $\\tan(B_c s)$：\n$$\n\\tan(B_c s) = \\frac{D_c B_c}{D_r \\kappa_r}\n$$\n这给出了反射层节省 $s$ 的一个显式表达式：\n$$\ns = \\frac{1}{B_c} \\arctan\\left(\\frac{D_c B_c}{D_r \\kappa_r}\\right)\n$$\n其中 $B_c = \\sqrt{(\\nu \\Sigma_{f,c} - \\Sigma_{a,c})/D_c}$ 且 $\\kappa_r = \\sqrt{\\Sigma_{a,r}/D_r}$。\n\n**5. $s$ 的数值计算**\n\n问题提供了以下数据：\n$D_c = 1.2\\,\\mathrm{cm}$\n$\\Sigma_{a,c} = 8.0 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n$\\nu \\Sigma_{f,c} = 2.0 \\times 10^{-2}\\,\\mathrm{cm}^{-1}$\n$D_r = 1.6\\,\\mathrm{cm}$\n$\\Sigma_{a,r} = 2.5 \\times 10^{-3}\\,\\mathrm{cm}^{-1}$\n\n首先，我们计算堆芯的材料曲率 $B_c$：\n$$\nB_c^2 = \\frac{\\nu \\Sigma_{f,c} - \\Sigma_{a,c}}{D_c} = \\frac{(2.0 \\times 10^{-2} - 8.0 \\times 10^{-3}) \\, \\mathrm{cm}^{-1}}{1.2 \\, \\mathrm{cm}} = \\frac{1.2 \\times 10^{-2} \\, \\mathrm{cm}^{-1}}{1.2 \\, \\mathrm{cm}} = 1.0 \\times 10^{-2} \\, \\mathrm{cm}^{-2}\n$$\n$$\nB_c = \\sqrt{1.0 \\times 10^{-2} \\, \\mathrm{cm}^{-2}} = 0.1 \\, \\mathrm{cm}^{-1}\n$$\n\n接下来，我们计算反射层的逆扩散长度 $\\kappa_r$：\n$$\n\\kappa_r^2 = \\frac{\\Sigma_{a,r}}{D_r} = \\frac{2.5 \\times 10^{-3} \\, \\mathrm{cm}^{-1}}{1.6 \\, \\mathrm{cm}} = 1.5625 \\times 10^{-3} \\, \\mathrm{cm}^{-2}\n$$\n$$\n\\kappa_r = \\sqrt{1.5625 \\times 10^{-3} \\, \\mathrm{cm}^{-2}} \\approx 0.03952847 \\, \\mathrm{cm}^{-1}\n$$\n\n现在，我们计算反正切函数的参数：\n$$\n\\frac{D_c B_c}{D_r \\kappa_r} = \\frac{(1.2 \\, \\mathrm{cm})(0.1 \\, \\mathrm{cm}^{-1})}{(1.6 \\, \\mathrm{cm})(0.03952847 \\, \\mathrm{cm}^{-1})} = \\frac{0.12}{0.06324555} \\approx 1.8973666\n$$\n\n最后，我们计算反射层节省 $s$。注意反正切函数的输出必须是弧度。\n$$\ns = \\frac{1}{0.1 \\, \\mathrm{cm}^{-1}} \\arctan(1.8973666) \\approx (10 \\, \\mathrm{cm}) \\times (1.08588 \\, \\mathrm{rad})\n$$\n$$\ns \\approx 10.8588 \\, \\mathrm{cm}\n$$\n按照要求将结果四舍五入到四位有效数字：\n$$\ns \\approx 10.86 \\, \\mathrm{cm}\n$$",
            "answer": "$$\\boxed{10.86}$$"
        },
        {
            "introduction": "对于复杂几何形状和材料分布的反应堆，解析解不再适用，必须依赖数值方法。这个动手编程练习将向您介绍节点扩散法，这是现代反应堆模拟程序的核心算法之一。通过将连续的扩散方程离散化为代数方程组并编写求解器，您将获得关于大型反应堆分析代码如何工作的宝贵实践经验。",
            "id": "4222190",
            "problem": "考虑一个一维、稳态、单能群中子扩散方程，该方程描述于一个平板中，该平板由具有分区常数材料属性的非重叠节点构成。其控制方程是由基本输运理论和菲克定律（Fick's law）推导出的守恒形式：\n$$-D(x)\\frac{d^2\\phi(x)}{dx^2} + \\Sigma_a(x)\\,\\phi(x) = Q(x),$$\n其中 $D(x)$ 是扩散系数，$\\Sigma_a(x)$ 是宏观吸收截面，$\\phi(x)$ 是标量中子通量，而 $Q(x)$ 是一个固定体积源。边界条件是平板两端均为反射边界，这要求边界上的净流为零。在一维情况下，中子流 $J(x)$ 满足菲克定律 $J(x) = -D(x)\\,d\\phi(x)/dx$，因此反射边界条件意味着 $J(x_{\\text{left}}) = 0$ 和 $J(x_{\\text{right}}) = 0$。\n\n使用节点扩散法，对每个宽度为 $h_i$ 的节点 $i$ 上的控制方程进行积分，以获得节点平衡方程：\n$$\\Sigma_{a,i}\\,h_i\\,\\bar{\\phi}_i + \\left(J_{i+\\frac{1}{2}} - J_{i-\\frac{1}{2}}\\right) = Q_i\\,h_i,$$\n其中 $\\bar{\\phi}_i$ 是节点平均标量通量，$\\Sigma_{a,i}$、$D_i$ 和 $Q_i$ 是节点 $i$ 中的常数，而 $J_{i\\pm\\frac{1}{2}}$ 表示节点 $i$ 右侧（$i+\\frac{1}{2}$）和左侧（$i-\\frac{1}{2}$）界面上的中子流，符号约定为向右为正。对于反射边界，在一个有 $N$ 个节点的平板中，设置 $J_{\\frac{1}{2}} = 0$ 和 $J_{N+\\frac{1}{2}} = 0$。\n\n采用与节点平衡一致的粗网格近似，通过使用两点电阻模型（粗网格有限差分法（Coarse Mesh Finite Difference, CMFD）中的一个标准结果）来模拟界面流，该模型源自菲克定律和跨界面的流连续性。将节点 $i$ 和节点 $i+1$ 之间界面处的半节点电阻定义为 $r_i = \\frac{h_i}{2\\,D_i}$ 和 $r_{i+1} = \\frac{h_{i+1}}{2\\,D_{i+1}}$，总界面电阻为\n$$R_{i+\\frac{1}{2}} = r_i + r_{i+1} = \\frac{h_i}{2\\,D_i} + \\frac{h_{i+1}}{2\\,D_{i+1}}.$$\n那么界面流可近似为\n$$J_{i+\\frac{1}{2}} = -\\frac{\\bar{\\phi}_{i+1} - \\bar{\\phi}_i}{R_{i+\\frac{1}{2}}}.$$\n这就为未知的节点平均通量 $\\bar{\\phi}_i$ 得到了以下线性系统：\n$$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i,$$\n并约定 $\\frac{1}{R_{\\frac{1}{2}}} = 0$ 和 $\\frac{1}{R_{N+\\frac{1}{2}}} = 0$ 以施加反射边界条件。求解此系统以获得每个节点的 $\\bar{\\phi}_i$。\n\n你的任务是编写一个完整的程序，为一组测试用例构建并求解上述粗网格节点系统。对于每个测试用例，程序必须生成节点平均标量通量 $\\bar{\\phi}_i$ 的列表，单位为“中子/平方厘米·秒”（写作 $n/\\left(\\text{cm}^2\\cdot\\text{s}\\right)$），每个值都四舍五入到 $6$ 位小数。所有输入参数都以科学上合理的单位给出：$h_i$ 的单位是 $\\text{cm}$，$D_i$ 的单位是 $\\text{cm}$，$\\Sigma_{a,i}$ 的单位是 $\\text{cm}^{-1}$，而 $Q_i$ 的单位是 $n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n\n为以下测试套件实现解决方案：\n- 测试用例 $1$ (均匀平板，均匀源)：$N=3$, $h=[10,10,10]\\,\\text{cm}$, $D=[1.0,1.0,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,0.1,0.1]\\,\\text{cm}^{-1}$, $Q=[0.5,0.5,0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n- 测试用例 $2$ (非均匀吸收，均匀源)：$N=3$, $h=[10,10,10]\\,\\text{cm}$, $D=[1.0,1.0,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,1.0,0.1]\\,\\text{cm}^{-1}$, $Q=[0.5,0.5,0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n- 测试用例 $3$ (不同宽度和扩散系数，局部源)：$N=4$, $h=[5,20,5,20]\\,\\text{cm}$, $D=[1.0,0.5,1.5,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,0.2,0.05,0.15]\\,\\text{cm}^{-1}$, $Q=[0.0,2.0,0.0,0.0]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n- 测试用例 $4$ (单节点健全性检查)：$N=1$, $h=[10]\\,\\text{cm}$, $D=[1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1]\\,\\text{cm}^{-1}$, $Q=[0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的每一项是对应一个测试用例的节点平均通量列表，每个值都四舍五入到 $6$ 位小数，单位为 $n/\\left(\\text{cm}^2\\cdot\\text{s}\\right)$。例如，输出格式必须为以下形式\n$$[\\,[\\bar{\\phi}_1^{(1)},\\ldots],\\,[\\bar{\\phi}_1^{(2)},\\ldots],\\,[\\bar{\\phi}_1^{(3)},\\ldots],\\,[\\bar{\\phi}_1^{(4)},\\ldots]\\,],$$\n不含任何额外文本。",
            "solution": "用户希望我使用粗网格节点法来解决一个一维、稳态、单能群的中子扩散问题。\n\n这是我的计划：\n1.  **验证问题陈述。**\n    -   提取所有给定信息。\n    -   检查科学合理性、完整性、一致性以及其他有效性标准。\n2.  **如果有效，制定解决方案策略。**\n    -   问题明确给出了需要求解的线性方程组：\n        $$A\\bar{\\phi} = b$$\n        其中 $\\bar{\\phi}$ 是未知节点平均通量向量 $[\\bar{\\phi}_1, \\bar{\\phi}_2, \\ldots, \\bar{\\phi}_N]^T$。\n    -   我需要为具有 $N$ 个节点的通用情况构建矩阵 $A$ 和向量 $b$。\n    -   向量 $b$（右侧项）很简单：$b_i = Q_i h_i$。\n    -   矩阵 $A$ 是三对角的。节点 $i$ 的方程是：\n        $$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i$$\n    -   所以，矩阵元素是：\n        -   对角项 $A_{i,i} = \\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}$。\n        -   上对角项 $A_{i, i+1} = -\\frac{1}{R_{i+\\frac{1}{2}}}$。\n        -   下对角项 $A_{i, i-1} = -\\frac{1}{R_{i-\\frac{1}{2}}}$。\n    -   边界条件（反射）通过设置 $J_{1/2} = 0$ 和 $J_{N+1/2} = 0$ 来处理。这等同于将相应的耦合系数设置为零。问题陈述给出了约定：$\\frac{1}{R_{1/2}} = 0$ 和 $\\frac{1}{R_{N+1/2}} = 0$。\n    -   我们来检查第一个和最后一个节点的方程。\n        -   对于节点 $i=1$：\n            $$(\\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}} + \\frac{1}{R_{1/2}})\\bar{\\phi}_1 - \\frac{1}{R_{3/2}}\\bar{\\phi}_2 - \\frac{1}{R_{1/2}}\\bar{\\phi}_0 = Q_1 h_1$$\n            使用约定 $\\frac{1}{R_{1/2}}=0$，这简化为：\n            $$(\\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}})\\bar{\\phi}_1 - \\frac{1}{R_{3/2}}\\bar{\\phi}_2 = Q_1 h_1$$\n            这是正确的。\n            $A_{1,1} = \\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}}$\n            $A_{1,2} = -\\frac{1}{R_{3/2}}$\n        -   对于节点 $i=N$：\n            $$(\\Sigma_{a,N} h_N + \\frac{1}{R_{N+1/2}} + \\frac{1}{R_{N-1/2}})\\bar{\\phi}_N - \\frac{1}{R_{N+1/2}}\\bar{\\phi}_{N+1} - \\frac{1}{R_{N-1/2}}\\bar{\\phi}_{N-1} = Q_N h_N$$\n            使用约定 $\\frac{1}{R_{N+1/2}}=0$，这简化为：\n            $$(\\Sigma_{a,N} h_N + \\frac{1}{R_{N-1/2}})\\bar{\\phi}_N - \\frac{1}{R_{N-1/2}}\\bar{\\phi}_{N-1} = Q_N h_N$$\n            这也是正确的。\n            $A_{N,N} = \\Sigma_{a,N} h_N + \\frac{1}{R_{N-1/2}}$\n            $A_{N, N-1} = -\\frac{1}{R_{N-1/2}}$\n    -   界面电阻 $R_{i+1/2}$ 定义为：\n        $$R_{i+\\frac{1}{2}} = \\frac{h_i}{2\\,D_i} + \\frac{h_{i+1}}{2\\,D_{i+1}}$$\n        对于 $i = 1, \\dots, N-1$。\n3.  **在 Python 中实现解决方案。**\n    -   计划是遍历每个测试用例。\n    -   在循环内部，对于给定的具有 $N$ 个节点和参数 $h, D, \\Sigma_a, Q$ 的测试用例：\n        a.  初始化一个 $N \\times N$ 的零矩阵 `A` 和一个 $N \\times 1$ 的零向量 `b`。\n        b.  构建右侧向量 `b`：`b[i] = Q[i] * h[i]`。\n        c.  构建矩阵 `A`。这是核心部分。我需要从 `i = 0` 迭代到 `N-1`（在 Python 中使用从 0 开始的索引）。\n            -   对于从 `0` 到 `N-1` 的 `i`：\n                -   计算损失项：`A[i, i] += Sigma_a[i] * h[i]`。\n            -   对于从 `0` 到 `N-2` 的界面 `i`（对应于界面 $1+1/2$ 到 $N-1+1/2$）：\n                -   计算 `R_interface = h[i]/(2*D[i]) + h[i+1]/(2*D[i+1])`。\n                -   计算耦合系数 `C = 1 / R_interface`。\n                -   加到对角项上：`A[i, i] += C` 和 `A[i+1, i+1] += C`。\n                -   设置非对角项：`A[i, i+1] = -C` 和 `A[i+1, i] = -C`。\n        d.  求解线性系统 `A @ phi_bar = b` 以得到 `phi_bar`。`numpy.linalg.solve(A, b)` 是完成此任务的完美工具。\n        e.  将结果四舍五入到 6 位小数。\n        f.  存储得到的通量列表。\n    -   循环结束后，将收集到的结果格式化为所需的字符串格式。\n\n4.  **仔细检查测试用例。**\n\n    -   **测试用例 1：** $N=3$，均匀。\n        -   $h = [10, 10, 10]$, $D=[1.0, 1.0, 1.0]$, $\\Sigma_a=[0.1, 0.1, 0.1]$, $Q=[0.5, 0.5, 0.5]$。\n        -   $b_1 = 0.5 \\times 10 = 5$。$b_2 = 5$。$b_3 = 5$。所以 $b = [5, 5, 5]^T$。\n        -   界面电阻：\n            -   $R_{1+1/2} = R_{3/2} = \\frac{10}{2 \\times 1} + \\frac{10}{2 \\times 1} = 5 + 5 = 10$。\n            -   $R_{2+1/2} = R_{5/2} = \\frac{10}{2 \\times 1} + \\frac{10}{2 \\times 1} = 5 + 5 = 10$。\n        -   耦合系数：\n            -   $C_{3/2} = 1/10 = 0.1$。\n            -   $C_{5/2} = 1/10 = 0.1$。\n        -   方程组：\n            -   节点 1：$(\\Sigma_{a,1}h_1 + C_{3/2})\\bar{\\phi}_1 - C_{3/2}\\bar{\\phi}_2 = Q_1 h_1$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies 1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5$。\n            -   节点 2：$(\\Sigma_{a,2}h_2 + C_{3/2} + C_{5/2})\\bar{\\phi}_2 - C_{3/2}\\bar{\\phi}_1 - C_{5/2}\\bar{\\phi}_3 = Q_2 h_2$\n                $(0.1 \\times 10 + 0.1 + 0.1)\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_3 = 5 \\implies -0.1\\bar{\\phi}_1 + 1.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_3 = 5$。\n            -   节点 3：$(\\Sigma_{a,3}h_3 + C_{5/2})\\bar{\\phi}_3 - C_{5/2}\\bar{\\phi}_2 = Q_3 h_3$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_3 - 0.1\\bar{\\phi}_2 = 5 \\implies -0.1\\bar{\\phi}_2 + 1.1\\bar{\\phi}_3 = 5$。\n        -   矩阵 `A`：\n            $$\n            \\begin{pmatrix}\n            1.1  -0.1  0 \\\\\n            -0.1  1.2  -0.1 \\\\\n            0  -0.1  1.1\n            \\end{pmatrix}\n            $$\n        -   该系统是对称的，这在预料之中。\n        -   我们来解这个方程组。根据对称性，$\\bar{\\phi}_1 = \\bar{\\phi}_3$。\n            -   $1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies \\bar{\\phi}_2 = 11\\bar{\\phi}_1 - 50$。\n            -   $-0.1\\bar{\\phi}_1 + 1.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 = 5 \\implies -0.2\\bar{\\phi}_1 + 1.2\\bar{\\phi}_2 = 5$。\n            -   代入 $\\bar{\\phi}_2$：$-0.2\\bar{\\phi}_1 + 1.2(11\\bar{\\phi}_1 - 50) = 5$。\n            -   $-0.2\\bar{\\phi}_1 + 13.2\\bar{\\phi}_1 - 60 = 5$。\n            -   $13.0\\bar{\\phi}_1 = 65 \\implies \\bar{\\phi}_1 = 5$。\n            -   那么 $\\bar{\\phi}_3 = 5$。\n            -   $\\bar{\\phi}_2 = 11(5) - 50 = 55 - 50 = 5$。\n        -   所以，用例 1 的解是 $[\\bar{\\phi}_1, \\bar{\\phi}_2, \\bar{\\phi}_3] = [5.0, 5.0, 5.0]$。这很合理：一个具有均匀源和反射边界的均匀系统应该有平坦的通量分布。\n\n    -   **测试用例 4：** $N=1$，单节点健全性检查。\n        -   $h=[10]$, $D=[1.0]$, $\\Sigma_a=[0.1]$, $Q=[0.5]$。\n        -   系统是 $1 \\times 1$ 的。\n        -   节点 1 的方程是：\n            $(\\Sigma_{a,1} h_1 + \\frac{1}{R_{3/2}} + \\frac{1}{R_{1/2}})\\bar{\\phi}_1 - \\dots = Q_1 h_1$。\n        -   由于 $N=1$，约定 $\\frac{1}{R_{1/2}}=0$ 和 $\\frac{1}{R_{N+1/2}} = \\frac{1}{R_{3/2}}=0$ 适用。\n        -   方程简化为 $\\Sigma_{a,1} h_1 \\bar{\\phi}_1 = Q_1 h_1$。\n        -   $(0.1 \\times 10) \\bar{\\phi}_1 = 0.5 \\times 10$。\n        -   $1.0 \\bar{\\phi}_1 = 5.0 \\implies \\bar{\\phi}_1 = 5.0$。\n        -   所以，用例 4 的解是 $[5.0]$。这也完全合理。在一个无限介质中（单节点上的反射边界所隐含的），通量就是 $Q/\\Sigma_a$。这里，$\\bar{\\phi} = 0.5 / 0.1 = 5.0$。节点平衡方程正确地再现了这一点。\n\n    - **测试用例 2：** $N=3$，非均匀吸收。\n        - $h = [10, 10, 10]$, $D=[1.0, 1.0, 1.0]$, $\\Sigma_a=[0.1, 1.0, 0.1]$, $Q=[0.5, 0.5, 0.5]$。\n        - $b = [5, 5, 5]^T$。\n        - 界面电阻与用例 1 相同：$R_{3/2} = 10, R_{5/2} = 10$。\n        - 耦合系数相同：$C_{3/2} = 0.1, C_{5/2} = 0.1$。\n        - 方程组：\n            - 节点 1：$(\\Sigma_{a,1}h_1 + C_{3/2})\\bar{\\phi}_1 - C_{3/2}\\bar{\\phi}_2 = Q_1 h_1$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies 1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5$。\n            - 节点 2：$(\\Sigma_{a,2}h_2 + C_{3/2} + C_{5/2})\\bar{\\phi}_2 - C_{3/2}\\bar{\\phi}_1 - C_{5/2}\\bar{\\phi}_3 = Q_2 h_2$\n                $(1.0 \\times 10 + 0.1 + 0.1)\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_3 = 5 \\implies -0.1\\bar{\\phi}_1 + 10.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_3 = 5$。\n            - 节点 3：$(\\Sigma_{a,3}h_3 + C_{5/2})\\bar{\\phi}_3 - C_{5/2}\\bar{\\phi}_2 = Q_3 h_3$\n                $(0.1 \\times 10 + 0.1)\\bar{\\phi}_3 - 0.1\\bar{\\phi}_2 = 5 \\implies -0.1\\bar{\\phi}_2 + 1.1\\bar{\\phi}_3 = 5$。\n        - 矩阵 A：\n            $$\n            \\begin{pmatrix}\n            1.1  -0.1  0 \\\\\n            -0.1  10.2  -0.1 \\\\\n            0  -0.1  1.1\n            \\end{pmatrix}\n            $$\n        - 根据对称性，$\\bar{\\phi}_1 = \\bar{\\phi}_3$。\n            - $1.1\\bar{\\phi}_1 - 0.1\\bar{\\phi}_2 = 5 \\implies \\bar{\\phi}_2 = 11\\bar{\\phi}_1 - 50$。\n            - $-0.1\\bar{\\phi}_1 + 10.2\\bar{\\phi}_2 - 0.1\\bar{\\phi}_1 = 5 \\implies -0.2\\bar{\\phi}_1 + 10.2\\bar{\\phi}_2 = 5$。\n            - 代入 $\\bar{\\phi}_2$：$-0.2\\bar{\\phi}_1 + 10.2(11\\bar{\\phi}_1 - 50) = 5$。\n            - $-0.2\\bar{\\phi}_1 + 112.2\\bar{\\phi}_1 - 510 = 5$。\n            - $112.0\\bar{\\phi}_1 = 515$。\n            - $\\bar{\\phi}_1 = 515 / 112 \\approx 4.598214...$\n            - $\\bar{\\phi}_3 = \\bar{\\phi}_1 \\approx 4.598214...$\n            - $\\bar{\\phi}_2 = 11(515/112) - 50 = (5665 - 5600)/112 = 65/112 \\approx 0.580357...$\n        - 这在物理上是合理的。中心节点的高吸收率急剧压低了该处的通量，而外部节点的通量较高。\n\n    - **测试用例 3：** $N=4$，非均匀，局部源。\n        - $h=[5, 20, 5, 20]$, $D=[1.0, 0.5, 1.5, 1.0]$, $\\Sigma_a=[0.1, 0.2, 0.05, 0.15]$, $Q=[0.0, 2.0, 0.0, 0.0]$。\n        - 右侧向量 $b$：\n            - $b_1 = Q_1 h_1 = 0.0 \\times 5 = 0$。\n            - $b_2 = Q_2 h_2 = 2.0 \\times 20 = 40$。\n            - $b_3 = Q_3 h_3 = 0.0 \\times 5 = 0$。\n            - $b_4 = Q_4 h_4 = 0.0 \\times 20 = 0$。\n            - $b = [0, 40, 0, 0]^T$。\n        - 界面电阻：\n            - $R_{3/2} = \\frac{h_1}{2D_1} + \\frac{h_2}{2D_2} = \\frac{5}{2(1.0)} + \\frac{20}{2(0.5)} = 2.5 + 20 = 22.5$。\n            - $R_{5/2} = \\frac{h_2}{2D_2} + \\frac{h_3}{2D_3} = \\frac{20}{2(0.5)} + \\frac{5}{2(1.5)} = 20 + 5/3 \\approx 20 + 1.6666... = 21.6666... = 65/3$。\n            - $R_{7/2} = \\frac{h_3}{2D_3} + \\frac{h_4}{2D_4} = \\frac{5}{2(1.5)} + \\frac{20}{2(1.0)} = 5/3 + 10 \\approx 1.6666... + 10 = 11.6666... = 35/3$。\n        - 耦合系数：\n            - $C_{3/2} = 1 / 22.5 = 1 / (45/2) = 2/45 \\approx 0.0444...$\n            - $C_{5/2} = 1 / (65/3) = 3/65 \\approx 0.04615...$\n            - $C_{7/2} = 1 / (35/3) = 3/35 \\approx 0.08571...$\n        - 矩阵 A 对角线元素：\n            - $A_{1,1} = \\Sigma_{a,1}h_1 + C_{3/2} = 0.1 \\times 5 + 2/45 = 0.5 + 2/45 = 45/90 + 4/90 = 49/90 \\approx 0.5444...$\n            - $A_{2,2} = \\Sigma_{a,2}h_2 + C_{3/2} + C_{5/2} = 0.2 \\times 20 + 2/45 + 3/65 = 4 + 2/45 + 3/65 = 4 + (26+27)/585 = 4 + 53/585 \\approx 4.0906...$\n            - $A_{3,3} = \\Sigma_{a,3}h_3 + C_{5/2} + C_{7/2} = 0.05 \\times 5 + 3/65 + 3/35 = 0.25 + 3/65 + 3/35 = 1/4 + 3((35+65)/(65 \\times 35)) = 1/4 + 3(100/2275) = 1/4 + 12/91 = (91+48)/364 = 139/364 \\approx 0.3818...$\n            - $A_{4,4} = \\Sigma_{a,4}h_4 + C_{7/2} = 0.15 \\times 20 + 3/35 = 3 + 3/35 = (105+3)/35 = 108/35 \\approx 3.0857...$\n        - 矩阵 A：\n            $$\n            \\begin{pmatrix}\n            A_{1,1}  -C_{3/2}  0  0 \\\\\n            -C_{3/2}  A_{2,2}  -C_{5/2}  0 \\\\\n            0  -C_{5/2}  A_{3,3}  -C_{7/2} \\\\\n            0  0  -C_{7/2}  A_{4,4}\n            \\end{pmatrix}\n            $$\n            $$\n            \\begin{pmatrix}\n            0.5444...  -0.0444...  0  0 \\\\\n            -0.0444...  4.0906...  -0.04615...  0 \\\\\n            0  -0.04615...  0.3818...  -0.08571... \\\\\n            0  0  -0.08571...  3.0857...\n            \\end{pmatrix}\n            $$\n        - 这将由 `numpy.linalg.solve` 进行数值求解。手工计算看起来很复杂，但设置是合理的。\n\n逻辑似乎是正确的。我将继续进行实现。\n最终的输出格式是一个列表的列表。\n`[[...], [...], [...], [...]]`\n我的代码结构应该是：\n```python\ndef solve():\n    test_cases = [ (params1), (params2), ... ]\n    all_results = []\n    for case in test_cases:\n        N, h, D, Sigma_a, Q = case\n        # ... construct A and b as numpy arrays\n        # ... phi_bar = np.linalg.solve(A, b)\n        # ... round results\n        # ... all_results.append(rounded_phi_bar_list)\n    # print final formatted string\n```\n\n等等，`scipy` 被列为可用库。对于三对角系统，`scipy.linalg.solve_banded` 会更高效，但 `numpy.linalg.solve` 完全可以胜任，而且对于这个问题规模可能更容易稳健地实现。鉴于 `N` 非常小（3 或 4），性能差异可以忽略不计。我将坚持使用 `numpy.linalg.solve`。\n\n问题陈述要求**每个数学实体**都使用 LaTeX。我应该小心遵循这一点。\n\n---\n## 开始正式流程。\n\n### 问题验证\n\n#### 步骤 1：提取已知条件\n\n-   控制方程：$-D(x)\\frac{d^2\\phi(x)}{dx^2} + \\Sigma_a(x)\\,\\phi(x) = Q(x)$\n-   变量：\n    -   $D(x)$：扩散系数 ($\\text{cm}$)\n    -   $\\Sigma_a(x)$：宏观吸收截面 ($\\text{cm}^{-1}$)\n    -   $\\phi(x)$：标量中子通量 ($n/\\left(\\text{cm}^2\\cdot\\text{s}\\right)$)\n    -   $Q(x)$：固定体积源 ($n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$)\n-   边界条件：两端反射，$J(x_{\\text{left}}) = 0$ 和 $J(x_{\\text{right}}) = 0$。\n-   菲克定律（Fick's Law）：$J(x) = -D(x)\\,d\\phi(x)/dx$。\n-   节点 $i$ 的节点平衡方程：$\\Sigma_{a,i}\\,h_i\\,\\bar{\\phi}_i + \\left(J_{i+\\frac{1}{2}} - J_{i-\\frac{1}{2}}\\right) = Q_i\\,h_i$。\n    -   $h_i$：节点 $i$ 的宽度 ($\\text{cm}$)\n    -   $\\bar{\\phi}_i$：节点 $i$ 的节点平均标量通量\n    -   $\\Sigma_{a,i}, D_i, Q_i$：节点 $i$ 中的常数材料属性\n    -   $J_{i\\pm\\frac{1}{2}}$：界面流\n-   边界流：对于 $N$ 个节点，$J_{\\frac{1}{2}} = 0$ 和 $J_{N+\\frac{1}{2}} = 0$。\n-   界面电阻模型（CMFD）：\n    -   总界面电阻：$R_{i+\\frac{1}{2}} = \\frac{h_i}{2\\,D_i} + \\frac{h_{i+1}}{2\\,D_{i+1}}$。\n    -   界面流近似：$J_{i+\\frac{1}{2}} = -\\frac{\\bar{\\phi}_{i+1} - \\bar{\\phi}_i}{R_{i+\\frac{1}{2}}}$。\n-   节点平均通量 $\\bar{\\phi}_i$ 的最终线性系统：\n    $$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i$$\n-   线性系统的边界约定：$\\frac{1}{R_{\\frac{1}{2}}} = 0$ 和 $\\frac{1}{R_{N+\\frac{1}{2}}} = 0$。\n-   测试用例：\n    1.  $N=3$, $h=[10,10,10]\\,\\text{cm}$, $D=[1.0,1.0,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,0.1,0.1]\\,\\text{cm}^{-1}$, $Q=[0.5,0.5,0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n    2.  $N=3$, $h=[10,10,10]\\,\\text{cm}$, $D=[1.0,1.0,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,1.0,0.1]\\,\\text{cm}^{-1}$, $Q=[0.5,0.5,0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n    3.  $N=4$, $h=[5,20,5,20]\\,\\text{cm}$, $D=[1.0,0.5,1.5,1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1,0.2,0.05,0.15]\\,\\text{cm}^{-1}$, $Q=[0.0,2.0,0.0,0.0]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n    4.  $N=1$, $h=[10]\\,\\text{cm}$, $D=[1.0]\\,\\text{cm}$, $\\Sigma_a=[0.1]\\,\\text{cm}^{-1}$, $Q=[0.5]\\,n/\\left(\\text{cm}^3\\cdot\\text{s}\\right)$。\n-   输出要求：单行字符串 `[ [flux_list_1], [flux_list_2], ... ]`，通量值四舍五入到 6 位小数。\n\n#### 步骤 2：使用提取的已知条件进行验证\n\n1.  **科学基础**：该问题基于单群中子扩散方程，这是核反应堆物理学的基石。通过对微分形式积分推导节点平衡方程是标准程序。使用类似 CMFD 的近似来处理界面流是反应堆分析中节点扩散法中一种公认且广泛使用的技术。物理是合理的。所有参数及其单位在物理上都是正确且一致的。该问题牢固地植根于反应堆物理学和数值方法。\n2.  **适定性**：问题要求解一个形式为 $A\\bar{\\phi} = b$ 的线性方程组。所得矩阵 $A$ 是一个对称正定矩阵（具体来说，它是一个对角占优的 Stieltjes 矩阵），这保证了唯一且稳定的解。该问题是适定的。\n3.  **客观性**：问题以精确的数学和物理术语陈述。任务是实现一个特定的数值方法，并将其应用于明确定义的测试用例。没有主观性或歧义。\n4.  **科学或事实不健全**：没有缺陷。物理和数学是标准和正确的。\n5.  **非形式化或不相关**：没有缺陷。该问题是一个形式化的数值任务，直接关系到核反应堆模拟中的扩散理论主题。\n6.  **不完整或矛盾的设置**：没有缺陷。提供了所有必要的方程、参数、边界条件和测试数据。公式是自洽的。处理边界条件的约定已明确说明。\n7.  **不切实际或不可行**：没有缺陷。参数值对于反应堆材料是物理上可信的。计算是可行的。\n8.  **不适定或结构不良**：没有缺陷。如前所述，所得的线性系统是良态的，并有唯一解。\n9.  **伪深刻、琐碎或同义反复**：没有缺陷。该问题需要对一个特定的数值方案进行非琐碎的组装和求解。虽然测试用例很小，但它们具有代表性，足以测试核心逻辑的实现。单节点情况可作为有用的健全性检查。\n10. **超出科学可验证性**：没有缺陷。结果可以通过重新实现算法或使用其他软件手动求解线性系统来独立验证。\n\n#### 步骤 3：结论和行动\n\n问题是**有效的**。我将继续进行求解。\n\n---\n### 解决方案开发\n\n任务是求解线性方程组 $A\\bar{\\phi} = b$，以获得节点平均通量向量 $\\bar{\\phi} = [\\bar{\\phi}_1, \\ldots, \\bar{\\phi}_N]^T$。问题陈述提供了第 $i$ 个方程的模板：\n$$\\left(\\Sigma_{a,i}\\,h_i + \\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i - \\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} - \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1} = Q_i\\,h_i$$\n\n这里，$\\bar{\\phi}$ 的索引是基于 1 的，从 $1$ 到 $N$。矩阵 $A$ 是一个 $N \\times N$ 的三对角矩阵，而 $b$ 是一个长度为 $N$ 的向量。\n\n让我们使用基于 0 的索引来定义矩阵元素 $A_{ij}$ 和向量元素 $b_i$ 以便实现，其中 $i, j \\in \\{0, 1, \\dots, N-1\\}$。系统的第 $i$ 行对应于节点 $i+1$ 的平衡方程。\n\n1.  **右侧 (RHS) 向量, $b$**：\n    对于每个节点 $i \\in \\{0, \\dots, N-1\\}$，RHS 是积分源项。\n    $$b_i = Q_{i+1}\\,h_{i+1}$$\n    在数组表示法中，这只是 $b_i = Q_i h_i$。\n\n2.  **系统矩阵, $A$**：\n    矩阵 $A$ 由两部分组成：一部分是由于每个节点内的中子移除（吸收）而产生的对角部分，另一部分是由于相邻节点之间的中子泄漏（流）而产生的三对角部分。\n\n    -   **移除/损失项 (对角)**：项 $\\Sigma_{a,i}\\,h_i\\,\\bar{\\phi}_i$ 贡献于矩阵的对角线。对于节点 $i+1$（0-索引 $i$），这是 $\\Sigma_{a,i+1}\\,h_{i+1}$。\n        $$A_{ii}^{\\text{loss}} = \\Sigma_{a,i+1}\\,h_{i+1}$$\n\n    -   **泄漏/耦合项 (三对角)**：与界面流 $J_{i\\pm\\frac{1}{2}}$ 相关的项构成了节点之间的耦合。节点 $i$ 和节点 $i+1$ 之间的流是 $J_{i+\\frac{1}{2}} = -\\frac{\\bar{\\phi}_{i+1} - \\bar{\\phi}_i}{R_{i+\\frac{1}{2}}} = C_{i+\\frac{1}{2}}(\\bar{\\phi}_i - \\bar{\\phi}_{i+1})$，其中 $C_{i+\\frac{1}{2}} = 1 / R_{i+\\frac{1}{2}}$ 是耦合系数。\n        节点 $i$（1-索引）的净泄漏是 $J_{i+\\frac{1}{2}} - J_{i-\\frac{1}{2}}$。\n        该项变为 $C_{i-\\frac{1}{2}}(\\bar{\\phi}_{i-1} - \\bar{\\phi}_i) - C_{i+\\frac{1}{2}}(\\bar{\\phi}_{i} - \\bar{\\phi}_{i+1}) = C_{i-\\frac{1}{2}}\\bar{\\phi}_{i-1} + C_{i+\\frac{1}{2}}\\bar{\\phi}_{i+1} - (C_{i-\\frac{1}{2}} + C_{i+\\frac{1}{2}})\\bar{\\phi}_i$。\n        问题将其重新排列为：\n        $-\\left(\\frac{1}{R_{i+\\frac{1}{2}}}\\bar{\\phi}_{i+1} + \\frac{1}{R_{i-\\frac{1}{2}}}\\bar{\\phi}_{i-1}\\right) + \\left(\\frac{1}{R_{i+\\frac{1}{2}}} + \\frac{1}{R_{i-\\frac{1}{2}}}\\right)\\bar{\\phi}_i$。\n\n    让我们使用基于 0 的索引（$i, j \\in \\{0, \\dots, N-1\\}$）来组装矩阵元素。\n\n    -   **对角项 $A_{ii}$**：\n        对于一个内部节点 $i$（即，不在边界上），其平衡方程受泄漏到节点 $i-1$ 和节点 $i+1$ 的影响。\n        节点 $i$ 和 $i+1$ 之间的耦合系数是 $C_{i_L, i_R} = \\frac{1}{R_{i_L, i_R}}$，其中 $R_{i_L, i_R} = \\frac{h_i}{2D_i} + \\frac{h_{i+1}}{2D_{i+1}}$。\n        节点 $i$ 的对角元素是：\n        $$A_{ii} = \\Sigma_{a,i}\\,h_i + C_{i-1, i} + C_{i, i+1}$$\n        边界条件通过将域外邻居的耦合系数设置为零来处理。使用问题的约定，$1/R_{1/2} = 0\n        $ 和 $1/R_{N+1/2} = 0$。这意味着与节点 0“左侧”（$C_{-1, 0}$）的耦合为零，与节点 $N-1$“右侧”（$C_{N-1, N}$）的耦合为零。\n        所以，对角元素的一般形式是：\n        -   $A_{00} = \\Sigma_{a,0}\\,h_0 + C_{0,1}$\n        -   $A_{ii} = \\Sigma_{a,i}\\,h_i + C_{i-1, i} + C_{i, i+1}$ 对于 $i \\in \\{1, \\dots, N-2\\}$\n        -   $A_{N-1, N-1} = \\Sigma_{a,N-1}\\,h_{N-1} + C_{N-2, N-1}$\n\n    -   **非对角项 $A_{i, i+1}$ 和 $A_{i+1, i}$**：\n        节点 $i$ 和 $i+1$ 之间的耦合贡献于非对角元素。\n        $$A_{i, i+1} = A_{i+1, i} = -C_{i, i+1} = -\\frac{1}{R_{i, i+1}} = -\\frac{1}{\\frac{h_i}{2D_i} + \\frac{h_{i+1}}{2D_{i+1}}}$$\n\n3.  **算法**：\n    对于每个测试用例，将按如下方式实现算法：\n    a.  给定 $N$ 和列表 $h, D, \\Sigma_a, Q$。\n    b.  如果 $N=1$，解就是 $\\bar{\\phi}_0 = Q_0/\\Sigma_{a,0}$。节点平衡方程给出 $\\Sigma_{a,0}h_0 \\bar{\\phi}_0 = Q_0h_0$，简化后即为此。\n    c.  如果 $N1$：\n        i.   创建一个 $N \\times N$ 的 NumPy 数组 `A`，初始化为零。\n        ii.  创建一个 $N \\times 1$ 的 NumPy 数组 `b`。\n        iii. 填充 `b`，使得 $b_i = Q_i h_i$。\n        iv.  用移除项填充 `A` 的对角线：$A_{ii} = \\Sigma_{a,i} h_i$。\n        v.   从 $i = 0$ 到 $N-2$ 迭代，计算每个界面的耦合项：\n             -   计算界面电阻 $R = \\frac{h_i}{2D_i} + \\frac{h_{i+1}}{2D_{i+1}}$。\n             -   计算耦合系数 $C = 1/R$。\n             -   将 $C$ 加到对角元素上：$A_{ii} \\leftarrow A_{ii} + C$ 和 $A_{i+1, i+1} \\leftarrow A_{i+1, i+1} + C$。\n             -   设置非对角元素：$A_{i, i+1} = -C$ 和 $A_{i+1, i} = -C$。\n        vi.  使用 `numpy.linalg.solve` 求解线性系统 $A \\bar{\\phi} = b$。\n    d.  将所得通量向量 $\\bar{\\phi}$ 的元素四舍五入到 6 位小数。\n    e.  收集当前测试用例的舍入通量列表。\n\n4.  **最终输出**：\n    处理完所有测试用例后，收集到的列表的列表将被格式化为所需的字符串 `[[...],[...],...]` 并打印。Python 表达式 `f\"[{','.join(map(str, all_results))}]\"` 将正确格式化列表的列表，因为对列表应用 `str()` 会产生其标准字符串表示形式。\n\n这种系统化的方法正确地实现了所描述的物理和数值方法，确保了给定测试用例的准确结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_diffusion_system(N, h, D, Sigma_a, Q):\n    \"\"\"\n    Constructs and solves the coarse-mesh nodal diffusion system.\n\n    Args:\n        N (int): Number of nodes.\n        h (list): List of node widths in cm.\n        D (list): List of diffusion coefficients in cm.\n        Sigma_a (list): List of macroscopic absorption cross sections in cm^-1.\n        Q (list): List of volumetric source strengths in n/(cm^3*s).\n\n    Returns:\n        list: A list of node-average scalar fluxes, rounded to 6 decimal places.\n    \"\"\"\n    # For N=1, the reflective boundary conditions mean no leakage.\n    # The balance equation Sigma_a,1 * h_1 * phi_bar_1 = Q_1 * h_1\n    # simplifies to phi_bar_1 = Q_1 / Sigma_a,1.\n    if N == 1:\n        if Sigma_a[0] == 0:\n            # Physically, this implies infinite flux if Q > 0, or any flux if Q = 0.\n            # Mathematically, the matrix would be singular.\n            # For this problem's constraints, we assume Sigma_a > 0.\n            return [np.inf if Q[0] > 0 else 0.0]\n        flux = Q[0] / Sigma_a[0]\n        return [round(flux, 6)]\n\n    # Convert lists to NumPy arrays for vectorized operations\n    h_arr = np.array(h, dtype=float)\n    D_arr = np.array(D, dtype=float)\n    Sigma_a_arr = np.array(Sigma_a, dtype=float)\n    Q_arr = np.array(Q, dtype=float)\n\n    # Initialize the system matrix A and right-hand side vector b\n    A = np.zeros((N, N))\n    b = Q_arr * h_arr\n\n    # Populate the diagonal of A with the removal term (Sigma_a,i * h_i)\n    np.fill_diagonal(A, Sigma_a_arr * h_arr)\n\n    # Populate the matrix with leakage coupling terms\n    # Iterate over the N-1 interfaces between nodes\n    for i in range(N - 1):\n        # Resistance of the left half-node at the interface\n        r_left = h_arr[i] / (2.0 * D_arr[i])\n        # Resistance of the right half-node at the interface\n        r_right = h_arr[i+1] / (2.0 * D_arr[i+1])\n        \n        # Total interface resistance\n        R_interface = r_left + r_right\n        \n        # Coupling coefficient is the inverse of the resistance\n        C = 1.0 / R_interface\n        \n        # Add to diagonal elements for node i and i+1\n        A[i, i] += C\n        A[i+1, i+1] += C\n        \n        # Set the off-diagonal elements\n        A[i, i+1] = -C\n        A[i+1, i] = -C\n        \n    # Solve the linear system A * phi_bar = b\n    phi_bar = np.linalg.solve(A, b)\n    \n    # Round the results to 6 decimal places and return as a standard list\n    return [round(x, 6) for x in phi_bar.tolist()]\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the final output.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {'N': 3, 'h': [10.0, 10.0, 10.0], 'D': [1.0, 1.0, 1.0], 'Sigma_a': [0.1, 0.1, 0.1], 'Q': [0.5, 0.5, 0.5]},\n        # Test case 2\n        {'N': 3, 'h': [10.0, 10.0, 10.0], 'D': [1.0, 1.0, 1.0], 'Sigma_a': [0.1, 1.0, 0.1], 'Q': [0.5, 0.5, 0.5]},\n        # Test case 3\n        {'N': 4, 'h': [5.0, 20.0, 5.0, 20.0], 'D': [1.0, 0.5, 1.5, 1.0], 'Sigma_a': [0.1, 0.2, 0.05, 0.15], 'Q': [0.0, 2.0, 0.0, 0.0]},\n        # Test case 4\n        {'N': 1, 'h': [10.0], 'D': [1.0], 'Sigma_a': [0.1], 'Q': [0.5]}\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = solve_diffusion_system(case['N'], case['h'], case['D'], case['Sigma_a'], case['Q'])\n        all_results.append(result)\n\n    # Format the final output string as a list of lists, without spaces.\n    # str() on a list produces a string with spaces. We build it manually.\n    inner_strings = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[[{','.join(inner_strings)}]]\"\n    \n    print(final_output.replace(\" \", \"\"))\n\nsolve()\n\n```"
        }
    ]
}