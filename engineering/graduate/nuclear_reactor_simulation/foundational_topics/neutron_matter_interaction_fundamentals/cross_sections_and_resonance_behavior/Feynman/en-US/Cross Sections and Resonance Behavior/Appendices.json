{
    "hands_on_practices": [
        {
            "introduction": "The single-level Breit-Wigner formula is the cornerstone for describing the behavior of an isolated neutron resonance. This practice provides a foundational theoretical workout, guiding you through the derivation of the absorption resonance area, which is a crucial parameter quantifying the integral strength of a resonance. Mastering this derivation  reinforces your understanding of the key parameters—such as the partial widths $\\Gamma_n$ and $\\Gamma_\\gamma$—that govern resonance phenomena and prepares you for more complex self-shielding calculations.",
            "id": "4220669",
            "problem": "A single, isolated, narrow radiative capture resonance dominates the neutron absorption in a heavy-nucleus target within an energy interval centered at the resonance energy $E_{0}$. Assume $s$-wave incidence, negligible background (potential) scattering, no interference between resonances, and no Doppler broadening. The neutron has reduced mass $\\mu$ with respect to the target, wave number $k(E)=\\sqrt{2\\mu E}/\\hbar$, and spin-statistical factor $g$ appropriate to the entrance channel. The partial widths in the single-level description are $\\Gamma_{n}(E)$ for the neutron entrance channel and $\\Gamma_{\\gamma}$ for the radiative exit channel, with total width $\\Gamma(E)=\\Gamma_{n}(E)+\\Gamma_{\\gamma}$.\n\nStarting from the single-level Breit–Wigner representation for an isolated resonance and using only well-tested scattering theory facts, compute the resonance area $\\displaystyle \\int_{0}^{\\infty}\\sigma_{a}(E)\\,dE$ of the absorption cross section $\\sigma_{a}(E)$ in the narrow-resonance approximation, in which the energy dependence of $k(E)$ and $\\Gamma_{n}(E)$ across the resonance can be neglected by evaluating them at $E_{0}$. You may further replace the finite integration limits by the entire real line in the narrow-resonance limit and assume $\\Gamma_{\\gamma}$ is energy independent across the resonance. Express your final result as a closed-form analytic expression in terms of $k_{0}$, $g$, $\\Gamma_{n}$, $\\Gamma_{\\gamma}$, and $\\Gamma$, all evaluated at $E_{0}$, where $k_{0}=\\sqrt{2\\mu E_{0}}/\\hbar$ and $\\Gamma=\\Gamma_{n}+\\Gamma_{\\gamma}$. Also state how this result relates to the conventional resonance strength $S$ evaluated at $E_{0}$. Provide the final expression only; no numerical evaluation is required.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and consistent with established principles of nuclear scattering theory. All conditions are clearly specified for a standard derivation within the framework of the Breit-Wigner single-level formalism.\n\nThe objective is to compute the resonance area for absorption, defined as the integral of the absorption cross section $\\sigma_{a}(E)$ over all energies. The starting point is the single-level Breit-Wigner formula for a reaction cross section $\\sigma_{xy}(E)$, where the entrance channel $x$ is the neutron channel ($n$) and the exit channel $y$ is the radiative capture channel ($\\gamma$). For $s$-wave neutrons ($l=0$) and a single isolated resonance at energy $E_{0}$, this formula is:\n$$\n\\sigma_{a}(E) = \\sigma_{n\\gamma}(E) = \\frac{\\pi}{k(E)^2} g \\frac{\\Gamma_{n}(E) \\Gamma_{\\gamma}(E)}{(E-E_{0})^2 + (\\Gamma(E)/2)^2}\n$$\nHere, $k(E)$ is the neutron wave number, $g$ is the spin-statistical factor, $\\Gamma_{n}(E)$ is the energy-dependent partial width for neutron emission, $\\Gamma_{\\gamma}(E)$ is the partial width for radiative capture, and $\\Gamma(E) = \\Gamma_{n}(E) + \\Gamma_{\\gamma}(E)$ is the total resonance width.\n\nThe problem specifies the use of the narrow-resonance approximation. This approximation posits that the resonance width $\\Gamma$ is very small compared to the resonance energy $E_{0}$, such that the terms $k(E)$, $\\Gamma_n(E)$, and $\\Gamma_\\gamma(E)$ can be considered constant over the energy range where the cross section is significant. These constants are their values evaluated at the resonance energy $E_{0}$:\n- $k(E) \\approx k_{0} = \\sqrt{2\\mu E_{0}}/\\hbar$\n- $\\Gamma_{n}(E) \\approx \\Gamma_{n}(E_{0}) \\equiv \\Gamma_{n}$\n- $\\Gamma_{\\gamma}(E) \\approx \\Gamma_{\\gamma}(E_{0}) \\equiv \\Gamma_{\\gamma}$ (stated as energy-independent)\n- $\\Gamma(E) \\approx \\Gamma(E_{0}) \\equiv \\Gamma = \\Gamma_{n} + \\Gamma_{\\gamma}$\n\nApplying these approximations to the Breit-Wigner formula yields:\n$$\n\\sigma_{a}(E) \\approx \\frac{\\pi}{k_{0}^2} g \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{(E-E_{0})^2 + (\\Gamma/2)^2}\n$$\nThe resonance area $A_{a}$ is the integral of this expression:\n$$\nA_{a} = \\int_{0}^{\\infty} \\sigma_{a}(E) \\,dE \\approx \\int_{0}^{\\infty} \\frac{\\pi g}{k_{0}^2} \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{(E-E_{0})^2 + (\\Gamma/2)^2} \\,dE\n$$\nThe integrand, known as the Lorentzian function, is sharply peaked around $E = E_{0}$. Since $E_{0} \\gg \\Gamma$, the contribution to the integral from the region $E  0$ is negligible. Therefore, we can extend the lower limit of integration to $-\\infty$ without introducing significant error, as specified in the problem statement.\n$$\nA_{a} \\approx \\frac{\\pi g \\Gamma_{n} \\Gamma_{\\gamma}}{k_{0}^2} \\int_{-\\infty}^{\\infty} \\frac{1}{(E-E_{0})^2 + (\\Gamma/2)^2} \\,dE\n$$\nTo evaluate the integral, we perform a change of variables. Let $x = E - E_{0}$, so $dx = dE$. Let $a = \\Gamma/2$. The integral becomes:\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{x^2 + a^2} \\,dx\n$$\nThis is a standard definite integral, whose value is well-known:\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{x^2 + a^2} \\,dx = \\left[ \\frac{1}{a} \\arctan\\left(\\frac{x}{a}\\right) \\right]_{-\\infty}^{\\infty} = \\frac{1}{a} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{\\pi}{a}\n$$\nSubstituting $a = \\Gamma/2$, the value of the integral is $\\frac{\\pi}{(\\Gamma/2)} = \\frac{2\\pi}{\\Gamma}$.\n\nNow, we substitute this result back into the expression for the resonance area $A_{a}$:\n$$\nA_{a} = \\frac{\\pi g \\Gamma_{n} \\Gamma_{\\gamma}}{k_{0}^2} \\left( \\frac{2\\pi}{\\Gamma} \\right) = \\frac{2\\pi^2 g}{k_{0}^2} \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{\\Gamma}\n$$\nThis is the final expression for the absorption resonance area in the narrow-resonance approximation.\n\nThe problem also asks to relate this result to the conventional resonance strength $S$. In nuclear data and reactor physics, the strength $S$ is often defined as the area under the total cross section resonance curve, $S = \\int_{0}^{\\infty} \\sigma_{\\text{tot}}(E) \\,dE$. The total cross section within this single-level model (neglecting potential scattering) is the sum of the resonance scattering and absorption cross sections, $\\sigma_{\\text{tot}}(E) = \\sigma_{s}(E) + \\sigma_{a}(E)$.\n$$\n\\sigma_{\\text{tot}}(E) \\approx \\frac{\\pi}{k_{0}^2} g \\frac{\\Gamma_{n}^2}{(E-E_{0})^2 + (\\Gamma/2)^2} + \\frac{\\pi}{k_{0}^2} g \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{(E-E_{0})^2 + (\\Gamma/2)^2} = \\frac{\\pi}{k_{0}^2} g \\frac{\\Gamma_{n}(\\Gamma_{n} + \\Gamma_{\\gamma})}{(E-E_{0})^2 + (\\Gamma/2)^2}\n$$\n$$\n\\sigma_{\\text{tot}}(E) \\approx \\frac{\\pi g \\Gamma_{n} \\Gamma}{k_{0}^2} \\frac{1}{(E-E_{0})^2 + (\\Gamma/2)^2}\n$$\nIntegrating this expression for $\\sigma_{\\text{tot}}(E)$ over all energies gives the strength $S$:\n$$\nS = \\int_{-\\infty}^{\\infty} \\sigma_{\\text{tot}}(E) \\,dE = \\frac{\\pi g \\Gamma_{n} \\Gamma}{k_{0}^2} \\int_{-\\infty}^{\\infty} \\frac{1}{(E-E_{0})^2 + (\\Gamma/2)^2} \\,dE = \\frac{\\pi g \\Gamma_{n} \\Gamma}{k_{0}^2} \\left( \\frac{2\\pi}{\\Gamma} \\right) = \\frac{2\\pi^2 g \\Gamma_{n}}{k_{0}^2}\n$$\nComparing our result for the absorption area $A_{a}$ with the expression for the total strength $S$:\n$$\nA_{a} = \\frac{2\\pi^2 g}{k_{0}^2} \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{\\Gamma} = \\left( \\frac{2\\pi^2 g \\Gamma_{n}}{k_{0}^2} \\right) \\frac{\\Gamma_{\\gamma}}{\\Gamma} = S \\frac{\\Gamma_{\\gamma}}{\\Gamma}\n$$\nThis relation shows that the absorption resonance area is equal to the total resonance strength multiplied by the branching ratio $\\Gamma_{\\gamma}/\\Gamma$, which is the probability that the compound nucleus, once formed, de-excites through radiative capture.",
            "answer": "$$\n\\boxed{\\frac{2\\pi^2 g}{k_{0}^2} \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{\\Gamma}}\n$$"
        },
        {
            "introduction": "Moving from pure theory to practical computation, this exercise addresses a core task in reactor physics: generating group-averaged cross sections for simulations. You will implement a program to calculate effective absorption cross sections, directly confronting the critical concept of resonance self-shielding, where a strong resonance depresses the local neutron flux $\\phi(E)$. By comparing a self-shielded flux model to an idealized $1/E$ spectrum , you will quantify how this effect reduces the apparent absorption rate, a vital consideration for accurate reactor analysis.",
            "id": "4220652",
            "problem": "You are asked to design and implement a program that constructs a slowing-down neutron flux spectrum in an infinite, homogeneous medium and uses it to compute a group-collapsed, resonance-dominated microscopic absorption cross section over specified energy bands. You must evaluate the sensitivity of the collapsed cross section to different assumptions for the energy-dependent neutron flux $\\phi(E)$. All energies must be expressed in electronvolts (eV), and all cross sections must be expressed in barns. The final results for each test case must include the collapsed cross section under two flux assumptions and their relative difference, reported as decimals without the percent sign.\n\nBegin from fundamental balance considerations for a non-leaking, infinite medium where fission and external sources are not considered within the specified energy bands, and elastic scattering dominates the slowing down. In such a case, the steady-state lethargy balance leads to an epithermal flux shape proportional to $1/E$ in the absence of significant absorption. Use this as the first flux model. Then incorporate resonance self-shielding by assuming that the flux is depressed in proportion to the local absorption strength, approximated by a rational depression factor. You will combine these flux models with a single-level absorption resonance representation to compute and compare group-collapsed cross sections.\n\nUse the following fundamental bases and definitions:\n- The time-independent slowing-down balance in an infinite medium with dominant elastic scattering implies an epithermal flux of the form $\\phi(E) \\propto 1/E$ in energy regions where absorption is weak.\n- The group-collapsed microscopic absorption cross section over an energy band $[E_{\\min}, E_{\\max}]$ with flux weighting $\\phi(E)$ is\n$$\n\\bar{\\sigma}_{a} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\sigma_{a}(E)\\,\\phi(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,dE},\n$$\nwhere $\\sigma_{a}(E)$ is the microscopic absorption cross section in barns.\n- Model the resonance-dominated microscopic absorption cross section $\\sigma_{a}(E)$ using the Single-Level Breit-Wigner (SLBW) approximation under the narrow-resonance hypothesis with energy-dependent neutron width. In this approximation,\n$$\n\\sigma_{a}(E) = \\left(\\frac{\\pi}{k^{2}(E)}\\right)\\,g\\,\\frac{\\Gamma_{n}(E)\\,\\Gamma_{\\gamma}}{\\left(E - E_{0}\\right)^{2} + \\left(\\dfrac{\\Gamma_{n}(E) + \\Gamma_{\\gamma}}{2}\\right)^{2}},\n$$\nwith $k(E)$ the neutron wave number, $g$ a statistical spin factor, $E_{0}$ the resonance energy, $\\Gamma_{\\gamma}$ the radiative width, and $\\Gamma_{n}(E)$ the neutron width. Use\n$$\n\\frac{\\pi}{k^{2}(E)} = \\frac{\\pi \\hbar^{2}}{2 m_{n} E},\n$$\nwith $\\hbar$ the reduced Planck constant, $m_{n}$ the neutron mass, and $E$ in joules when evaluating this term. Convert the resulting area to barns using $1\\,\\text{barn} = 10^{-28}\\,\\text{m}^{2}$. Assume\n$$\n\\Gamma_{n}(E) = \\Gamma_{n0}\\,\\sqrt{\\frac{E}{E_{0}}},\n$$\nwith $\\Gamma_{n0}$ the neutron width at $E_{0}$, and assume $\\Gamma_{\\gamma}$ is energy-independent over the band. Use $g = 1$ in all cases.\n\nDefine two flux models:\n- Model A (ideal epithermal): $\\phi_{A}(E) \\propto \\dfrac{1}{E}$.\n- Model B (self-shielded epithermal): $\\phi_{B}(E) \\propto \\dfrac{1/E}{1 + \\sigma_{a}(E)/\\sigma_{0}}$, where $\\sigma_{0}$ is a positive background microscopic cross section parameter in barns that represents the effect of other interaction channels and background scattering.\n\nFor each test case, compute:\n- $\\bar{\\sigma}_{a}^{(A)}$ using $\\phi_{A}(E)$,\n- $\\bar{\\sigma}_{a}^{(B)}$ using $\\phi_{B}(E)$,\n- Sensitivity metric $r = \\dfrac{\\bar{\\sigma}_{a}^{(B)} - \\bar{\\sigma}_{a}^{(A)}}{\\bar{\\sigma}_{a}^{(A)}}$ as a decimal.\n\nUnits and numerical requirements:\n- Energies must be in electronvolts (eV).\n- Cross sections must be in barns.\n- The final outputs $\\bar{\\sigma}_{a}^{(A)}$ and $\\bar{\\sigma}_{a}^{(B)}$ must be reported in barns as floating-point numbers.\n- The sensitivity metric $r$ must be reported as a decimal (fraction), not as a percentage.\n\nNumerical integration:\n- Your program must evaluate the necessary integrals over energy numerically with sufficient accuracy to capture narrow resonance effects. If an integrand includes $1/E$, you may use the exact analytical denominator $\\int_{E_{\\min}}^{E_{\\max}} \\frac{1}{E}\\,dE = \\ln\\!\\left(\\frac{E_{\\max}}{E_{\\min}}\\right)$ for improved accuracy when appropriate.\n\nTest suite:\nImplement your program to run the following four test cases. For each case, the parameters are given as an ordered tuple $\\left(E_{0}, \\Gamma_{\\gamma}, \\Gamma_{n0}, \\sigma_{0}, E_{\\min}, E_{\\max}\\right)$, with $E_{0}$, $\\Gamma_{\\gamma}$, $\\Gamma_{n0}$, $E_{\\min}$, and $E_{\\max}$ in eV and $\\sigma_{0}$ in barns:\n- Case $1$: $\\left(6.67, 0.023, 0.027, 10.0, 5.0, 9.0\\right)$\n- Case $2$: $\\left(6.67, 0.023, 0.027, 10.0, 10.0, 20.0\\right)$\n- Case $3$: $\\left(6.67, 0.023, 0.010, 5.0, 6.6, 6.8\\right)$\n- Case $4$: $\\left(20.0, 0.100, 0.150, 15.0, 18.0, 22.0\\right)$\n\nOutput specification:\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, in the following order for each case: first $\\bar{\\sigma}_{a}^{(A)}$ (in barns), then $\\bar{\\sigma}_{a}^{(B)}$ (in barns), then $r$ as a decimal. Concatenate these triples in the same order as the test cases to form a single flat list.\n- For example, the output format must be exactly\n$$\n[\\bar{\\sigma}_{a,1}^{(A)},\\bar{\\sigma}_{a,1}^{(B)},r_{1},\\bar{\\sigma}_{a,2}^{(A)},\\bar{\\sigma}_{a,2}^{(B)},r_{2},\\bar{\\sigma}_{a,3}^{(A)},\\bar{\\sigma}_{a,3}^{(B)},r_{3},\\bar{\\sigma}_{a,4}^{(A)},\\bar{\\sigma}_{a,4}^{(B)},r_{4}]\n$$\nwith no additional text.\n\nYour program must be fully self-contained, require no input, and directly print the required single-line output. Use the physical constants with standard accepted values, including the reduced Planck constant $\\hbar$, the neutron mass $m_{n}$, and the electronvolt-to-joule conversion factor, to evaluate $\\dfrac{\\pi}{k^{2}(E)}$ consistently in SI units and convert to barns.",
            "solution": "The problem is valid. It is a well-posed, scientifically sound, and complete problem statement in computational nuclear reactor physics. It requires the implementation of standard models for resonance cross sections and neutron flux to quantify the physical effect of self-shielding.\n\n### Principle-Based Solution Design\n\nThe core task is to compute and compare group-collapsed microscopic absorption cross sections for a resonance absorber using two different energy-dependent neutron flux models. This procedure is fundamental to generating multigroup cross-section libraries used in reactor analysis codes. The difference between the two results quantifies the phenomenon of resonance self-shielding, where high absorption at the resonance peak depresses the local neutron flux, reducing the effective reaction rate compared to what would be expected with an unperturbed flux.\n\n#### 1. Fundamental Equations\n\nThe group-collapsed microscopic absorption cross section, $\\bar{\\sigma}_a$, over an energy group $[E_{\\min}, E_{\\max}]$ is defined as the reaction rate per atom, averaged over the group, and normalized by the group-averaged flux. This is mathematically expressed as:\n$$\n\\bar{\\sigma}_{a} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\sigma_{a}(E)\\,\\phi(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,dE}\n$$\nwhere $\\sigma_{a}(E)$ is the energy-dependent microscopic absorption cross section and $\\phi(E)$ is the energy-dependent neutron flux.\n\n#### 2. Absorption Cross Section Model: Single-Level Breit-Wigner (SLBW)\n\nThe absorption cross section near an isolated resonance is modeled by the Single-Level Breit-Wigner formula. For s-wave ($l=0$) neutrons and assuming the narrow resonance approximation, this is given by:\n$$\n\\sigma_{a}(E) = \\left(\\frac{\\pi}{k^{2}(E)}\\right)\\,g\\,\\frac{\\Gamma_{n}(E)\\,\\Gamma_{\\gamma}}{\\left(E - E_{0}\\right)^{2} + \\left(\\dfrac{\\Gamma}{2}\\right)^{2}}\n$$\nwhere $\\Gamma(E) = \\Gamma_{n}(E) + \\Gamma_{\\gamma}$ is the total resonance width. The problem specifies a statistical spin factor $g=1$.\n\nThe term $\\pi/k^2(E)$ relates to the de Broglie wavelength of the neutron and is proportional to $1/E$. For consistent unit handling (cross sections in barns, energy in eV), we first establish the conversion factor. The neutron wave number $k(E)$ is related to its kinetic energy $E$ by $E = \\frac{\\hbar^2 k^2}{2 m_n}$. Thus:\n$$\n\\frac{\\pi}{k^2(E)} = \\frac{\\pi \\hbar^2}{2 m_n E}\n$$\nTo evaluate this in practical units, we use the values of the reduced Planck constant $\\hbar$, the neutron mass $m_n$, and the electronvolt-to-Joule conversion factor $e$. Let $E_{\\text{eV}}$ be the energy in eV and $E_{\\text{J}}$ be the energy in Joules.\n$$\n\\frac{\\pi}{k^2(E)} [\\text{m}^2] = \\frac{\\pi \\hbar^2}{2 m_n E_{\\text{J}}} = \\frac{\\pi \\hbar^2}{2 m_n e E_{\\text{eV}}}\n$$\nConverting from $\\text{m}^2$ to barns ($1\\,\\text{barn} = 10^{-28}\\,\\text{m}^2$):\n$$\n\\frac{\\pi}{k^2(E)} [\\text{barns}] = \\left( \\frac{\\pi \\hbar^2}{2 m_n e \\times 10^{-28}} \\right) \\frac{1}{E_{\\text{eV}}} \\equiv \\frac{C_{\\sigma}}{E_{\\text{eV}}}\n$$\nUsing standard values for the constants ($\\hbar \\approx 1.05457 \\times 10^{-34}\\,\\text{J s}$, $m_n \\approx 1.67493 \\times 10^{-27}\\,\\text{kg}$, $e \\approx 1.60218 \\times 10^{-19}\\,\\text{J/eV}$), the constant $C_{\\sigma}$ is calculated to be approximately $6.5355 \\times 10^5\\,\\text{barns} \\cdot \\text{eV}$.\n\nThe neutron width $\\Gamma_n(E)$ is energy-dependent, proportional to the neutron speed, and is modeled as $\\Gamma_n(E) = \\Gamma_{n0} \\sqrt{E/E_0}$, where $\\Gamma_{n0}$ is the neutron width at the resonance energy $E_0$. The radiative capture width $\\Gamma_{\\gamma}$ is assumed to be constant over the resonance.\n\n#### 3. Neutron Flux Models\n\nTwo flux distributions are considered:\n-   **Model A (Unshielded)**: $\\phi_A(E) = C_A/E$. This represents the ideal slowing-down flux in a purely scattering infinite medium. The constant $C_A$ is arbitrary and cancels in the expression for $\\bar{\\sigma}_a$.\n-   **Model B (Self-Shielded)**: $\\phi_B(E) = C_B \\frac{1/E}{1 + \\sigma_{a}(E)/\\sigma_{0}}$. This model introduces a flux depression factor, $1 / (1 + \\sigma_{a}(E)/\\sigma_{0})$, which reduces the flux in regions of high absorption. The parameter $\\sigma_0$ represents the total background cross section per absorber atom and controls the strength of the self-shielding effect. A smaller $\\sigma_0$ leads to a more pronounced flux depression. The constant $C_B$ also cancels.\n\n#### 4. Algorithmic Implementation\n\nThe solution is implemented by constructing a program to perform the following steps for each test case:\n\n1.  **Define a function for $\\sigma_a(E)$**: This function takes energy $E$ (in eV) and the resonance parameters ($E_0, \\Gamma_{\\gamma}, \\Gamma_{n0}$) as input. It computes $\\Gamma_n(E)$, the total width $\\Gamma(E)$, the $\\pi/k^2(E)$ term (using the pre-calculated constant $C_{\\sigma}$), and combines them according to the SLBW formula to return $\\sigma_a(E)$ in barns.\n\n2.  **Compute $\\bar{\\sigma}_{a}^{(A)}$**:\n    The collapsed cross section for the unshielded model is:\n    $$\n    \\bar{\\sigma}_{a}^{(A)} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\sigma_{a}(E)\\,\\frac{1}{E}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\frac{1}{E}\\,dE}\n    $$\n    The numerator integral is computed numerically using a robust quadrature algorithm (e.g., `scipy.integrate.quad`). The denominator integral has a simple analytical solution, $\\int_{E_{\\min}}^{E_{\\max}} (1/E) dE = \\ln(E_{\\max}/E_{\\min})$, which is used for superior accuracy.\n\n3.  **Compute $\\bar{\\sigma}_{a}^{(B)}$**:\n    The collapsed cross section for the self-shielded model is:\n    $$\n    \\bar{\\sigma}_{a}^{(B)} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\sigma_{a}(E)\\,\\frac{1/E}{1 + \\sigma_{a}(E)/\\sigma_{0}}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\frac{1/E}{1 + \\sigma_{a}(E)/\\sigma_{0}}\\,dE}\n    $$\n    Due to the complexity of the integrands, both the numerator and the denominator integrals must be evaluated numerically. The same quadrature routine is used. The integrand functions are defined to compute $\\sigma_a(E)$ once per evaluation point for efficiency.\n\n4.  **Compute Sensitivity Metric $r$**:\n    The relative difference, $r$, quantifies the impact of self-shielding:\n    $$\n    r = \\frac{\\bar{\\sigma}_{a}^{(B)} - \\bar{\\sigma}_{a}^{(A)}}{\\bar{\\sigma}_{a}^{(A)}}\n    $$\n    A negative value of $r$ indicates that self-shielding has reduced the effective absorption cross section.\n\nThe program iterates through the provided test cases, performs these calculations for each, and aggregates the results ($\\bar{\\sigma}_{a}^{(A)}$, $\\bar{\\sigma}_{a}^{(B)}$, $r$) into a single flat list for formatted printing. The use of numerical integration is essential to capture the rapid variation of the cross section across the resonance profile.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates group-collapsed microscopic absorption cross sections under\n    two different flux assumptions (unshielded and self-shielded) to\n    evaluate the effect of resonance self-shielding.\n    \"\"\"\n\n    # Physical constants for unit conversions\n    # hbar in J.s\n    HBAR = 1.054571817e-34\n    # neutron mass in kg\n    M_N = 1.67492749804e-27\n    # eV to Joules conversion\n    EV_TO_J = 1.602176634e-19\n    # m^2 to barns conversion\n    M2_TO_BARN = 1e28\n\n    # Pre-calculate the constant C in the formula: pi/k^2(E) [barns] = C / E [eV]\n    # C = (pi * hbar^2) / (2 * m_n * eV_to_J) * m2_to_barn\n    PI_K2_CONST = (np.pi * HBAR**2) / (2 * M_N * EV_TO_J) * M2_TO_BARN\n\n    # Test cases: (E0, Gamma_gamma, Gamma_n0, sigma0, Emin, Emax)\n    # E0, Gamma_gamma, Gamma_n0, Emin, Emax in eV\n    # sigma0 in barns\n    test_cases = [\n        (6.67, 0.023, 0.027, 10.0, 5.0, 9.0),\n        (6.67, 0.023, 0.027, 10.0, 10.0, 20.0),\n        (6.67, 0.023, 0.010, 5.0, 6.6, 6.8),\n        (20.0, 0.100, 0.150, 15.0, 18.0, 22.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        E0, Gamma_gamma, Gamma_n0, sigma0, Emin, Emax = case\n        g_factor = 1.0\n\n        def sigma_a(E: float) - float:\n            \"\"\"\n            Calculates the microscopic absorption cross section using the\n            Single-Level Breit-Wigner (SLBW) formula.\n\n            Args:\n                E (float): Neutron energy in eV.\n\n            Returns:\n                float: Absorption cross section in barns.\n            \"\"\"\n            if E = 0:\n                return 0.0\n            \n            # Energy-dependent neutron width\n            Gamma_n_E = Gamma_n0 * np.sqrt(E / E0)\n            \n            # Total resonance width\n            Gamma_total_E = Gamma_n_E + Gamma_gamma\n            \n            # pi/k^2 term in barns\n            pi_over_k2 = PI_K2_CONST / E\n            \n            # Breit-Wigner formula\n            numerator = Gamma_n_E * Gamma_gamma\n            denominator = (E - E0)**2 + (Gamma_total_E / 2)**2\n            \n            return pi_over_k2 * g_factor * (numerator / denominator)\n\n        # --- Calculation for Model A (unshielded flux, phi ~ 1/E) ---\n        # Numerator: integral of sigma_a(E) * phi_A(E) dE\n        # Denominator: integral of phi_A(E) dE\n        # The constant in phi_A cancels out.\n        \n        # Numerator integrand\n        integrand_A_num = lambda E: sigma_a(E) / E\n        \n        # Numerator calculation via numerical integration\n        num_A, _ = quad(integrand_A_num, Emin, Emax, limit=200)\n\n        # Denominator calculation (analytical)\n        den_A = np.log(Emax / Emin)\n        \n        sigma_a_bar_A = num_A / den_A\n        \n        # --- Calculation for Model B (self-shielded flux) ---\n        # phi ~ (1/E) / (1 + sigma_a(E)/sigma0)\n        \n        def integrand_B_num(E: float) - float:\n            s_a = sigma_a(E)\n            flux_B_unnormalized = (1.0 / E) / (1.0 + s_a / sigma0)\n            return s_a * flux_B_unnormalized\n\n        def integrand_B_den(E: float) - float:\n            s_a = sigma_a(E)\n            flux_B_unnormalized = (1.0 / E) / (1.0 + s_a / sigma0)\n            return flux_B_unnormalized\n\n        # Numerical integration for both numerator and denominator\n        num_B, _ = quad(integrand_B_num, Emin, Emax, limit=200)\n        den_B, _ = quad(integrand_B_den, Emin, Emax, limit=200)\n        \n        sigma_a_bar_B = num_B / den_B\n\n        # --- Sensitivity Metric Calculation ---\n        if sigma_a_bar_A == 0:\n            r = 0.0 if sigma_a_bar_B == 0.0 else np.inf\n        else:\n            r = (sigma_a_bar_B - sigma_a_bar_A) / sigma_a_bar_A\n\n        results.extend([sigma_a_bar_A, sigma_a_bar_B, r])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This practice advances into the Unresolved Resonance Region (URR), where individual resonance parameters are statistically characterized rather than deterministically known. You will implement the subgroup method, a sophisticated technique used in modern reactor codes to handle the probabilistic nature of cross sections in the URR. By modeling the cross section $\\sigma$ with a probability distribution and approximating its shielded reaction rate with a discrete set of representative cross sections and weights , you will gain hands-on experience with the statistical physics essential for high-fidelity reactor modeling.",
            "id": "4220673",
            "problem": "You are tasked with constructing and analyzing a discrete subgroup representation of the microscopic absorption cross section in the Unresolved Resonance Region (URR) for use in nuclear reactor simulation. The Unresolved Resonance Region (URR) is characterized by dense resonances whose individual parameters are not resolved; instead, the microscopic cross section at a fixed energy behaves as a random variable due to the random superposition of many broadened resonances. The objective is to approximate expectation functionals of the cross section by a finite weighted sum over discrete sublevels and to justify convergence of this approximation as the number of sublevels increases.\n\nStarting from the neutron slowing-down balance and the definition of reaction rate, consider a homogeneous absorber with background cross section modeled by a positive constant. Under the narrow-resonance approximation and assuming constant lethargy source, a common shielding functional of the cross section $\\,\\sigma\\,$ is the rational function\n$$\ng(\\sigma;\\alpha) \\equiv \\frac{\\sigma}{1+\\alpha\\,\\sigma},\n$$\nwhere $\\,\\alpha = 1/\\sigma_0\\,$ and $\\,\\sigma_0\\,$ is the positive background cross section. This functional encapsulates the self-shielding effect through the reduction in local neutron flux induced by absorption; it is monotone increasing and bounded above by $\\,1/\\alpha\\,$.\n\nAt a fixed energy $\\,E\\,$ in the Unresolved Resonance Region (URR), assume that the microscopic absorption cross section $\\,\\sigma\\,$ is modeled as a positive random variable with a Gamma probability density function (PDF),\n$$\np(\\sigma; k, \\theta) \\equiv \\frac{1}{\\theta^k \\,\\Gamma(k)}\\,\\sigma^{k-1}\\,e^{-\\sigma/\\theta}, \\quad \\sigma \\ge 0,\n$$\nwhere $\\,k>0\\,$ is the dimensionless shape parameter and $\\,\\theta>0\\,$ is the scale parameter with units of barns. The corresponding cumulative distribution function (CDF) is $\\,F(\\sigma; k, \\theta) = P\\!\\left(k,\\sigma/\\theta\\right)\\,$, where $\\,P(a,x)\\,$ denotes the regularized lower incomplete gamma function. This model enforces positivity, allows tunable variability typical of unresolved resonance fluctuations, and is mathematically tractable.\n\nDefine the exact expectation of the shielding functional as\n$$\nI(k,\\theta,\\alpha) \\equiv \\int_0^{\\infty} g(\\sigma;\\alpha)\\,p(\\sigma; k, \\theta)\\,d\\sigma.\n$$\n\nTo construct the subgroup representation with $\\,n\\,$ sublevels, partition the probability space into $\\,n\\,$ equal-probability strata. Let the mid-quantile points be\n$$\nu_i \\equiv \\frac{i-\\tfrac{1}{2}}{n}, \\quad i=1,2,\\dots,n,\n$$\nand define the subgroup cross sections by the quantile map\n$$\n\\sigma_i \\equiv F^{-1}(u_i;k,\\theta), \\quad i=1,2,\\dots,n.\n$$\nAssign equal weights $\\,w_i \\equiv 1/n\\,$. The subgroup approximation to the exact expectation is then the midpoint Riemann sum on the probability scale,\n$$\nS_n(k,\\theta,\\alpha) \\equiv \\frac{1}{n}\\sum_{i=1}^{n} g(\\sigma_i;\\alpha).\n$$\n\nYour program must:\n- Compute the exact expectation $\\,I(k,\\theta,\\alpha)\\,$ by numerical quadrature over $\\,\\sigma \\in [0,\\infty)\\,$.\n- Construct the subgroup approximation $\\,S_n(k,\\theta,\\alpha)\\,$ using the quantile-based nodes as defined above.\n- Report the relative error\n$$\n\\varepsilon_n \\equiv \\frac{\\left|S_n(k,\\theta,\\alpha) - I(k,\\theta,\\alpha)\\right|}{I(k,\\theta,\\alpha)}.\n$$\n- Demonstrate convergence numerically by evaluating $\\,\\varepsilon_n\\,$ for increasing $\\,n\\,$.\n\nScientific and mathematical bases to employ:\n- The reaction rate involves expectations of cross sections against flux-dependent functionals, and in narrow resonance approximations yields rational forms like $\\,g(\\sigma;\\alpha)\\,$ through balance equations and flux depression considerations.\n- The Gamma model for $\\,\\sigma\\,$ is selected for positivity and tunable skewness consistent with unresolved resonance statistics; $\\,g(\\sigma;\\alpha)\\,$ is bounded and measurable, ensuring that expectations exist and that Riemann-sum approximations over the probability space converge under standard dominated-convergence arguments.\n\nUnits and output:\n- Cross sections $\\,\\sigma\\,$, $\\,\\theta\\,$, and $\\,\\sigma_0\\,$ must be treated in barns. The parameter $\\,\\alpha\\,$ thus has units of inverse barns. The reported relative errors $\\,\\varepsilon_n\\,$ are unitless and must be expressed as decimals.\n- Angle units are not applicable to this problem.\n\nTest suite and coverage:\nEvaluate $\\,\\varepsilon_n\\,$ for $\\,n \\in \\{\\,2,4,8,16\\,\\}\\,$ across the following test cases, chosen to probe typical, narrow, and heavy-tailed unresolved-resonance regimes as well as different shielding intensities:\n1. Happy path: $\\,k=3.0\\,$, $\\,\\theta=0.6\\,\\text{barns}\\,$, $\\,\\sigma_0=1.5\\,\\text{barns}\\,$.\n2. Heavy-tail variability: $\\,k=0.7\\,$, $\\,\\theta=2.0\\,\\text{barns}\\,$, $\\,\\sigma_0=0.2\\,\\text{barns}\\,$.\n3. Narrow distribution: $\\,k=20.0\\,$, $\\,\\theta=0.1\\,\\text{barns}\\,$, $\\,\\sigma_0=5.0\\,\\text{barns}\\,$.\n4. Edge heavy-tail case: $\\,k=0.3\\,$, $\\,\\theta=1.0\\,\\text{barns}\\,$, $\\,\\sigma_0=0.5\\,\\text{barns}\\,$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, one inner list per test case, and within each inner list the relative errors for $\\,n=2\\,$, $\\,n=4\\,$, $\\,n=8\\,$, and $\\,n=16\\,$ in that order. For example, the output must look like\n$$\n[\\,[\\varepsilon_2^{(1)},\\varepsilon_4^{(1)},\\varepsilon_8^{(1)},\\varepsilon_{16}^{(1)}],\\,[\\varepsilon_2^{(2)},\\dots],\\,[\\varepsilon_2^{(3)},\\dots],\\,[\\varepsilon_2^{(4)},\\dots]\\,],\n$$\nprinted on a single line and with decimal values. Here the superscript $\\,(\\ell)\\,$ indexes the test case $\\,\\ell\\in\\{\\,1,2,3,4\\,\\}\\,$.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of nuclear reactor physics, specifically the treatment of neutron cross sections in the unresolved resonance region. The problem is mathematically well-posed, with all necessary parameters and definitions provided to ensure a unique, computable solution. The language is objective and the setup is free from internal contradictions or physical implausibility.\n\nThe task is to analyze the convergence of a subgroup approximation for a self-shielding functional in the unresolved resonance region (URR). This involves comparing the numerically computed exact expectation of the functional with its discrete approximation for an increasing number of subgroups.\n\nThe self-shielding functional, which describes the effective absorption rate in a homogeneous medium under the narrow-resonance approximation, is given by the rational function\n$$\ng(\\sigma;\\alpha) \\equiv \\frac{\\sigma}{1+\\alpha\\,\\sigma}\n$$\nwhere $\\sigma$ is the microscopic absorption cross section, a positive random variable, and $\\alpha = 1/\\sigma_0$ is the inverse of the constant background cross section $\\sigma_0$.\n\nThe microscopic cross section $\\sigma$ at a fixed energy in the URR is modeled by a Gamma probability density function (PDF):\n$$\np(\\sigma; k, \\theta) \\equiv \\frac{1}{\\theta^k \\,\\Gamma(k)}\\,\\sigma^{k-1}\\,e^{-\\sigma/\\theta}, \\quad \\sigma \\ge 0\n$$\nwith shape parameter $k0$ and scale parameter $\\theta0$. The corresponding cumulative distribution function (CDF) is $F(\\sigma; k, \\theta)$.\n\nThe analysis proceeds in three main steps: calculation of the exact expectation, construction of the discrete subgroup approximation, and evaluation of the relative error.\n\nFirst, the exact expectation of the shielding functional, denoted $I(k,\\theta,\\alpha)$, is defined by the integral of the functional over the distribution of the cross section:\n$$\nI(k,\\theta,\\alpha) \\equiv \\int_0^{\\infty} g(\\sigma;\\alpha)\\,p(\\sigma; k, \\theta)\\,d\\sigma = \\int_0^{\\infty} \\left(\\frac{\\sigma}{1+\\alpha\\,\\sigma}\\right) \\left(\\frac{1}{\\theta^k \\,\\Gamma(k)}\\,\\sigma^{k-1}\\,e^{-\\sigma/\\theta}\\right) \\,d\\sigma\n$$\nThis integral does not generally possess a simple closed-form analytical solution. Therefore, its value must be determined using numerical quadrature methods. The integrand is a product of two well-behaved functions: $g(\\sigma;\\alpha)$ is bounded and continuous for $\\sigma \\ge 0$, and $p(\\sigma; k, \\theta)$ is the Gamma PDF. The integral is guaranteed to converge. We will employ the `scipy.integrate.quad` function for a high-precision evaluation over the domain $\\sigma \\in [0, \\infty)$.\n\nSecond, we construct the $n$-point subgroup approximation, $S_n(k,\\theta,\\alpha)$. This method discretizes the probability space of the random variable $\\sigma$. The procedure is equivalent to changing the integration variable from $\\sigma$ to the probability level $u=F(\\sigma;k,\\theta)$, such that $d\\sigma = du / p(\\sigma;k,\\theta)$ and $\\sigma = F^{-1}(u;k,\\theta)$. The expectation integral transforms to:\n$$\nI(k,\\theta,\\alpha) = \\int_0^1 g(F^{-1}(u;k,\\theta); \\alpha) \\, du\n$$\nThe subgroup approximation $S_n$ is a midpoint Riemann sum of this transformed integral. The probability interval $[0,1]$ is partitioned into $n$ equal subintervals of width $w_i = 1/n$. The evaluation points, or nodes, are chosen as the mid-quantiles:\n$$\nu_i \\equiv \\frac{i-\\tfrac{1}{2}}{n}, \\quad i=1,2,\\dots,n\n$$\nThe corresponding cross section values, termed the subgroup cross sections, are obtained via the inverse CDF, also known as the quantile function:\n$$\n\\sigma_i \\equiv F^{-1}(u_i;k,\\theta)\n$$\nComputationally, the quantile function for the Gamma distribution is implemented as the percent point function (PPF), available in `scipy.stats.gamma.ppf`. The subgroup approximation is then the weighted sum:\n$$\nS_n(k,\\theta,\\alpha) \\equiv \\sum_{i=1}^{n} w_i \\, g(\\sigma_i;\\alpha) = \\frac{1}{n}\\sum_{i=1}^{n} \\frac{\\sigma_i}{1+\\alpha\\,\\sigma_i}\n$$\nBy construction, as $n \\to \\infty$, the Riemann-sum approximation $S_n$ converges to the exact integral $I$. The function $g(F^{-1}(u;k,\\theta); \\alpha)$ is continuous with respect to $u \\in (0,1)$, which guarantees the convergence of the midpoint rule. Our task is to demonstrate this convergence numerically.\n\nThird, the relative error $\\varepsilon_n$ is computed for each value of $n$ to quantify the accuracy of the approximation:\n$$\n\\varepsilon_n \\equiv \\frac{\\left|S_n(k,\\theta,\\alpha) - I(k,\\theta,\\alpha)\\right|}{I(k,\\theta,\\alpha)}\n$$\nWe will implement an algorithm that, for each given test case $(k, \\theta, \\sigma_0)$, first computes the reference value $I(k,\\theta,\\alpha)$ and then iteratively computes $S_n(k,\\theta,\\alpha)$ and $\\varepsilon_n$ for $n \\in \\{2, 4, 8, 16\\}$. This will produce a sequence of errors that is expected to decrease as $n$ increases, thereby numerically verifying the convergence of the subgroup method.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import gamma\nfrom scipy.integrate import quad\nfrom scipy.special import gammainc\n\ndef solve():\n    \"\"\"\n    Computes and analyzes a discrete subgroup representation of a microscopic \n    absorption cross section model in the Unresolved Resonance Region (URR).\n    \"\"\"\n\n    # Define the shielding functional g(sigma; alpha)\n    def g_func(sigma, alpha):\n        return sigma / (1.0 + alpha * sigma)\n\n    # Define the test cases from the problem statement: (k, theta, sigma_0)\n    test_cases = [\n        (3.0, 0.6, 1.5),    # Case 1: Happy path\n        (0.7, 2.0, 0.2),    # Case 2: Heavy-tail variability\n        (20.0, 0.1, 5.0),   # Case 3: Narrow distribution\n        (0.3, 1.0, 0.5)     # Case 4: Edge heavy-tail case\n    ]\n\n    # Define the number of subgroup levels n to test\n    n_values = [2, 4, 8, 16]\n\n    # A list to store the results for all test cases\n    all_results = []\n\n    for k, theta, sigma_0 in test_cases:\n        # Calculate alpha from the background cross section sigma_0\n        alpha = 1.0 / sigma_0\n\n        # Define the integrand for the exact expectation I\n        # The integrand is g(sigma; alpha) * p(sigma; k, theta)\n        # We use scipy.stats.gamma.pdf for p(sigma; k, theta)\n        integrand = lambda s: g_func(s, alpha) * gamma.pdf(s, a=k, scale=theta)\n\n        # Compute the exact expectation I by numerical quadrature\n        # The integration is from 0 to infinity.\n        I_exact, _ = quad(integrand, 0, np.inf)\n\n        # A list to store the relative errors for the current test case\n        case_errors = []\n\n        for n in n_values:\n            # 1. Define the mid-quantile points u_i\n            u_i = (np.arange(1, n + 1) - 0.5) / n\n\n            # 2. Find the subgroup cross sections sigma_i = F^-1(u_i; k, theta)\n            # This is the Percent Point Function (PPF) of the Gamma distribution.\n            # scipy.stats.gamma uses shape 'a' for k and 'scale' for theta.\n            sigma_i = gamma.ppf(u_i, a=k, scale=theta)\n            \n            # 3. Calculate the subgroup approximation S_n\n            # This is the average of g(sigma_i; alpha) since weights are 1/n.\n            g_values = g_func(sigma_i, alpha)\n            S_n = np.mean(g_values)\n\n            # 4. Calculate the relative error epsilon_n\n            relative_error = np.abs(S_n - I_exact) / I_exact\n\n            case_errors.append(relative_error)\n\n        all_results.append(case_errors)\n\n    # Format the final output string exactly as required:\n    # [[err_n1_c1, err_n2_c1, ...],[err_n1_c2, ...], ...]\n    inner_lists_str = [f\"[{','.join([f'{err:.10f}' for err in err_list])}]\" for err_list in all_results]\n    final_str = f\"[{','.join(inner_lists_str)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_str)\n\nsolve()\n```"
        }
    ]
}