{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的共振现象之前，我们必须首先理解单个孤立共振的基本性质。本练习的核心是从 Breit-Wigner 公式出发，推导共振面积——一个量化共振总吸收强度的关键参数 。这项实践建立了理论共振参数（如共振宽度 $\\Gamma$）与一个可积分、可测量的物理量之间的重要联系。",
            "id": "4220669",
            "problem": "在以共振能量 $E_{0}$ 为中心的能量区间内，一个单一、孤立、窄的辐射俘获共振在重核靶的中子吸收中占主导地位。假设为 $s$ 波入射，背景（势）散射可忽略不计，共振之间无干涉，且无多普勒展宽。相对于靶，中子的约化质量为 $\\mu$，波数为 $k(E)=\\sqrt{2\\mu E}/\\hbar$，入射道对应的自旋统计因子为 $g$。在单能级描述中，中子入射道的分波宽度为 $\\Gamma_{n}(E)$，辐射出射道的分波宽度为 $\\Gamma_{\\gamma}$，总宽度为 $\\Gamma(E)=\\Gamma_{n}(E)+\\Gamma_{\\gamma}$。\n\n从孤立共振的单能级 Breit–Wigner 表示出发，并且仅使用经过充分检验的散射理论事实，在窄共振近似下计算吸收截面 $\\sigma_{a}(E)$ 的共振面积 $\\displaystyle \\int_{0}^{\\infty}\\sigma_{a}(E)\\,dE$。在窄共振近似中，可以忽略 $k(E)$ 和 $\\Gamma_{n}(E)$ 跨越共振的能量依赖性，即在 $E_{0}$ 处对它们进行求值。在窄共振极限下，您可以进一步将有限的积分限替换为整个实数轴，并假设 $\\Gamma_{\\gamma}$ 在共振范围内与能量无关。将您的最终结果表示为一个由 $k_{0}$、$g$、$\\Gamma_{n}$、$\\Gamma_{\\gamma}$ 和 $\\Gamma$ 构成的闭式解析表达式，所有这些量都在 $E_{0}$ 处求值，其中 $k_{0}=\\sqrt{2\\mu E_{0}}/\\hbar$ 且 $\\Gamma=\\Gamma_{n}+\\Gamma_{\\gamma}$。同时说明该结果如何与在 $E_{0}$ 处求值的常规共振强度 $S$ 相关联。仅需提供最终表达式；无需进行数值计算。",
            "solution": "该问题陈述经核实具有科学依据，提法得当，客观，并与核散射理论的既定原则相符。所有条件都已明确规定，适用于在 Breit-Wigner 单能级形式理论框架内进行标准推导。\n\n目标是计算吸收共振面积，其定义为吸收截面 $\\sigma_{a}(E)$ 对所有能量的积分。出发点是反应截面 $\\sigma_{xy}(E)$ 的单能级 Breit-Wigner 公式，其中入射道 $x$ 是中子道（$n$），出射道 $y$ 是辐射俘获道（$\\gamma$）。对于 $s$ 波中子（$l=0$）和位于能量 $E_{0}$ 的单一孤立共振，该公式为：\n$$\n\\sigma_{a}(E) = \\sigma_{n\\gamma}(E) = \\frac{\\pi}{k(E)^2} g \\frac{\\Gamma_{n}(E) \\Gamma_{\\gamma}(E)}{(E-E_{0})^2 + (\\Gamma(E)/2)^2}\n$$\n此处，$k(E)$ 是中子波数，$g$ 是自旋统计因子，$\\Gamma_{n}(E)$ 是中子发射的能量依赖分波宽度，$\\Gamma_{\\gamma}(E)$ 是辐射俘获的分波宽度，而 $\\Gamma(E) = \\Gamma_{n}(E) + \\Gamma_{\\gamma}(E)$ 是总共振宽度。\n\n问题指定使用窄共振近似。该近似假定共振宽度 $\\Gamma$ 相对于共振能量 $E_{0}$ 非常小，因此在截面值显著的能量范围内，可以将 $k(E)$、$\\Gamma_n(E)$ 和 $\\Gamma_\\gamma(E)$ 等项视为常数。这些常数是它们在共振能量 $E_{0}$ 处的值：\n- $k(E) \\approx k_{0} = \\sqrt{2\\mu E_{0}}/\\hbar$\n- $\\Gamma_{n}(E) \\approx \\Gamma_{n}(E_{0}) \\equiv \\Gamma_{n}$\n- $\\Gamma_{\\gamma}(E) \\approx \\Gamma_{\\gamma}(E_{0}) \\equiv \\Gamma_{\\gamma}$ （规定为能量无关）\n- $\\Gamma(E) \\approx \\Gamma(E_{0}) \\equiv \\Gamma = \\Gamma_{n} + \\Gamma_{\\gamma}$\n\n将这些近似应用于 Breit-Wigner 公式，可得：\n$$\n\\sigma_{a}(E) \\approx \\frac{\\pi}{k_{0}^2} g \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{(E-E_{0})^2 + (\\Gamma/2)^2}\n$$\n共振面积 $A_{a}$ 是此表达式的积分：\n$$\nA_{a} = \\int_{0}^{\\infty} \\sigma_{a}(E) \\,dE \\approx \\int_{0}^{\\infty} \\frac{\\pi g}{k_{0}^2} \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{(E-E_{0})^2 + (\\Gamma/2)^2} \\,dE\n$$\n被积函数，即洛伦兹函数，在 $E = E_{0}$ 附近呈尖锐峰值。由于 $E_{0} \\gg \\Gamma$，积分在 $E  0$ 区域的贡献可以忽略不计。因此，正如问题陈述中所指定的，我们可以将积分下限扩展到 $-\\infty$ 而不引入显著误差。\n$$\nA_{a} \\approx \\frac{\\pi g \\Gamma_{n} \\Gamma_{\\gamma}}{k_{0}^2} \\int_{-\\infty}^{\\infty} \\frac{1}{(E-E_{0})^2 + (\\Gamma/2)^2} \\,dE\n$$\n为计算该积分，我们进行变量替换。令 $x = E - E_{0}$，则 $dx = dE$。令 $a = \\Gamma/2$。积分为：\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{x^2 + a^2} \\,dx\n$$\n这是一个标准的定积分，其值是众所周知的：\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{x^2 + a^2} \\,dx = \\left[ \\frac{1}{a} \\arctan\\left(\\frac{x}{a}\\right) \\right]_{-\\infty}^{\\infty} = \\frac{1}{a} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{\\pi}{a}\n$$\n代入 $a = \\Gamma/2$，积分值为 $\\frac{\\pi}{(\\Gamma/2)} = \\frac{2\\pi}{\\Gamma}$。\n\n现在，我们将此结果代回共振面积 $A_{a}$ 的表达式中：\n$$\nA_{a} = \\frac{\\pi g \\Gamma_{n} \\Gamma_{\\gamma}}{k_{0}^2} \\left( \\frac{2\\pi}{\\Gamma} \\right) = \\frac{2\\pi^2 g}{k_{0}^2} \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{\\Gamma}\n$$\n这就是在窄共振近似下吸收共振面积的最终表达式。\n\n问题还要求将此结果与常规共振强度 $S$ 联系起来。在核数据和反应堆物理学中，强度 $S$ 通常定义为总截面共振曲线下的面积，$S = \\int_{0}^{\\infty} \\sigma_{\\text{tot}}(E) \\,dE$。在这个单能级模型中（忽略势散射），总截面是共振散射截面和吸收截面之和，$\\sigma_{\\text{tot}}(E) = \\sigma_{s}(E) + \\sigma_{a}(E)$。\n$$\n\\sigma_{\\text{tot}}(E) \\approx \\frac{\\pi}{k_{0}^2} g \\frac{\\Gamma_{n}^2}{(E-E_{0})^2 + (\\Gamma/2)^2} + \\frac{\\pi}{k_{0}^2} g \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{(E-E_{0})^2 + (\\Gamma/2)^2} = \\frac{\\pi}{k_{0}^2} g \\frac{\\Gamma_{n}(\\Gamma_{n} + \\Gamma_{\\gamma})}{(E-E_{0})^2 + (\\Gamma/2)^2}\n$$\n$$\n\\sigma_{\\text{tot}}(E) \\approx \\frac{\\pi g \\Gamma_{n} \\Gamma}{k_{0}^2} \\frac{1}{(E-E_{0})^2 + (\\Gamma/2)^2}\n$$\n将 $\\sigma_{\\text{tot}}(E)$ 的这个表达式对所有能量进行积分，得到强度 $S$：\n$$\nS = \\int_{-\\infty}^{\\infty} \\sigma_{\\text{tot}}(E) \\,dE = \\frac{\\pi g \\Gamma_{n} \\Gamma}{k_{0}^2} \\int_{-\\infty}^{\\infty} \\frac{1}{(E-E_{0})^2 + (\\Gamma/2)^2} \\,dE = \\frac{\\pi g \\Gamma_{n} \\Gamma}{k_{0}^2} \\left( \\frac{2\\pi}{\\Gamma} \\right) = \\frac{2\\pi^2 g \\Gamma_{n}}{k_{0}^2}\n$$\n将我们得到的吸收面积 $A_{a}$ 的结果与总强度 $S$ 的表达式进行比较：\n$$\nA_{a} = \\frac{2\\pi^2 g}{k_{0}^2} \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{\\Gamma} = \\left( \\frac{2\\pi^2 g \\Gamma_{n}}{k_{0}^2} \\right) \\frac{\\Gamma_{\\gamma}}{\\Gamma} = S \\frac{\\Gamma_{\\gamma}}{\\Gamma}\n$$\n该关系表明，吸收共振面积等于总共振强度乘以分支比 $\\Gamma_{\\gamma}/\\Gamma$，该分支比是复合核一旦形成后通过辐射俘获退激的概率。",
            "answer": "$$\n\\boxed{\\frac{2\\pi^2 g}{k_{0}^2} \\frac{\\Gamma_{n} \\Gamma_{\\gamma}}{\\Gamma}}\n$$"
        },
        {
            "introduction": "在实际的反应堆模拟中，我们通常不直接使用连续能量的截面数据，而是使用在特定能群上平均化的“群常数”。本练习将理论付诸实践，要求你编写程序来计算一个已分辨共振的群常数 。通过比较未受扰动的中子注量率与更真实的、因吸收而降低的中子注量率下的结果，本练习深入探讨了“共振自屏”这一关键概念，这是共振处理的基石。",
            "id": "4220652",
            "problem": "要求您设计并实现一个程序，用于在无限均匀介质中构建慢化中子通量谱，并利用该谱计算指定能带上由共振主导的群平均微观吸收截面。您必须评估该群平均截面对不同能量依赖中子通量 $\\phi(E)$ 假设的敏感性。所有能量必须以电子伏特 (eV) 表示，所有截面必须以靶恩 (barn) 表示。每个测试用例的最终结果必须包括两种通量假设下的群平均截面及其相对差异，以小数形式报告，不带百分号。\n\n从一个无泄漏的无限介质的基本平衡考虑开始，在指定的能带内不考虑裂变和外部源，且弹性散射在慢化过程中占主导地位。在这种情况下，稳态勒西平衡导致在没有显著吸收时，超热通量形状与 $1/E$ 成正比。将此作为第一个通量模型。然后，通过假设通量与局部吸收强度成比例地被压低（由一个有理压低因子近似），来引入共振自屏效应。您将把这些通量模型与单能级吸收共振表示相结合，以计算和比较群平均截面。\n\n使用以下基本依据和定义：\n- 在吸收较弱的能量区域，无限介质中以弹性散射为主导的、不依赖于时间的慢化平衡意味着超热通量的形式为 $\\phi(E) \\propto 1/E$。\n- 在能带 $[E_{\\min}, E_{\\max}]$ 上，经过通量 $\\phi(E)$ 加权的群平均微观吸收截面为\n$$\n\\bar{\\sigma}_{a} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\sigma_{a}(E)\\,\\phi(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,dE},\n$$\n其中 $\\sigma_{a}(E)$ 是以靶恩为单位的微观吸收截面。\n- 使用单能级 Breit-Wigner (SLBW) 近似，在窄共振假设和能量依赖的中子宽度条件下，对共振主导的微观吸收截面 $\\sigma_{a}(E)$ 进行建模。在此近似下，\n$$\n\\sigma_{a}(E) = \\left(\\frac{\\pi}{k^{2}(E)}\\right)\\,g\\,\\frac{\\Gamma_{n}(E)\\,\\Gamma_{\\gamma}}{\\left(E - E_{0}\\right)^{2} + \\left(\\dfrac{\\Gamma_{n}(E) + \\Gamma_{\\gamma}}{2}\\right)^{2}},\n$$\n其中 $k(E)$ 是中子波数，$g$ 是统计自旋因子，$E_{0}$ 是共振能量，$\\Gamma_{\\gamma}$ 是辐射宽度，$\\Gamma_{n}(E)$ 是中子宽度。使用\n$$\n\\frac{\\pi}{k^{2}(E)} = \\frac{\\pi \\hbar^{2}}{2 m_{n} E},\n$$\n其中 $\\hbar$ 是约化普朗克常数，$m_{n}$ 是中子质量，在计算此项时 $E$ 的单位是焦耳。使用 $1\\,\\text{barn} = 10^{-28}\\,\\text{m}^{2}$ 将得到的面积转换为靶恩。假设\n$$\n\\Gamma_{n}(E) = \\Gamma_{n0}\\,\\sqrt{\\frac{E}{E_{0}}},\n$$\n其中 $\\Gamma_{n0}$ 是在 $E_{0}$ 处的中子宽度，并假设 $\\Gamma_{\\gamma}$ 在该能带上不随能量变化。在所有情况下都使用 $g = 1$。\n\n定义两种通量模型：\n- 模型 A (理想超热通量): $\\phi_{A}(E) \\propto \\dfrac{1}{E}$。\n- 模型 B (自屏超热通量): $\\phi_{B}(E) \\propto \\dfrac{1/E}{1 + \\sigma_{a}(E)/\\sigma_{0}}$，其中 $\\sigma_{0}$ 是一个以靶恩为单位的正值本底微观截面参数，代表其他相互作用道和本底散射的影响。\n\n对于每个测试用例，计算：\n- 使用 $\\phi_{A}(E)$ 计算 $\\bar{\\sigma}_{a}^{(A)}$，\n- 使用 $\\phi_{B}(E)$ 计算 $\\bar{\\sigma}_{a}^{(B)}$，\n- 敏感性度量 $r = \\dfrac{\\bar{\\sigma}_{a}^{(B)} - \\bar{\\sigma}_{a}^{(A)}}{\\bar{\\sigma}_{a}^{(A)}}$，以小数形式表示。\n\n单位和数值要求：\n- 能量必须以电子伏特 (eV) 为单位。\n- 截面必须以靶恩为单位。\n- 最终输出 $\\bar{\\sigma}_{a}^{(A)}$ 和 $\\bar{\\sigma}_{a}^{(B)}$ 必须以靶恩为单位，作为浮点数报告。\n- 敏感性度量 $r$ 必须以小数（分数）形式报告，而不是百分比。\n\n数值积分：\n- 您的程序必须对能量进行数值积分，并具有足够的精度来捕捉窄共振效应。\n- 如果被积函数包含 $1/E$，您可以在适当时使用精确的解析分母 $\\int_{E_{\\min}}^{E_{\\max}} \\frac{1}{E}\\,dE = \\ln\\!\\left(\\frac{E_{\\max}}{E_{\\min}}\\right)$ 以提高精度。\n\n测试套件：\n实现您的程序以运行以下四个测试用例。对于每个用例，参数以有序元组 $\\left(E_{0}, \\Gamma_{\\gamma}, \\Gamma_{n0}, \\sigma_{0}, E_{\\min}, E_{\\max}\\right)$ 的形式给出，其中 $E_{0}$、$\\Gamma_{\\gamma}$、$\\Gamma_{n0}$、$E_{\\min}$ 和 $E_{\\max}$ 的单位是 eV，$\\sigma_{0}$ 的单位是靶恩：\n- 用例 1: $\\left(6.67, 0.023, 0.027, 10.0, 5.0, 9.0\\right)$\n- 用例 2: $\\left(6.67, 0.023, 0.027, 10.0, 10.0, 20.0\\right)$\n- 用例 3: $\\left(6.67, 0.023, 0.010, 5.0, 6.6, 6.8\\right)$\n- 用例 4: $\\left(20.0, 0.100, 0.150, 15.0, 18.0, 22.0\\right)$\n\n输出规格：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，形式为方括号内的一个逗号分隔列表，每个用例的结果按以下顺序排列：首先是 $\\bar{\\sigma}_{a}^{(A)}$（单位为靶恩），然后是 $\\bar{\\sigma}_{a}^{(B)}$（单位为靶恩），最后是 $r$（以小数表示）。\n- 将这些三元组按照测试用例的顺序连接起来，形成一个单一的扁平列表。\n- 例如，输出格式必须严格为\n$$\n[\\bar{\\sigma}_{a,1}^{(A)},\\bar{\\sigma}_{a,1}^{(B)},r_{1},\\bar{\\sigma}_{a,2}^{(A)},\\bar{\\sigma}_{a,2}^{(B)},r_{2},\\bar{\\sigma}_{a,3}^{(A)},\\bar{\\sigma}_{a,3}^{(B)},r_{3},\\bar{\\sigma}_{a,4}^{(A)},\\bar{\\sigma}_{a,4}^{(B)},r_{4}]\n$$\n不带任何附加文本。\n\n您的程序必须完全自包含，不需要任何输入，并直接打印所需的单行输出。使用标准公认值的物理常数，包括约化普朗克常数 $\\hbar$、中子质量 $m_{n}$ 以及电子伏特到焦耳的转换因子，以国际单位制 (SI units) 一致地计算 $\\dfrac{\\pi}{k^{2}(E)}$ 并转换为靶恩。",
            "solution": "该问题是有效的。它是在计算核反应堆物理领域中一个定义良好、科学上合理且完整的命题陈述。它要求实现共振截面和中子通量的标准模型，以量化自屏效应的物理影响。\n\n### 基于原理的解决方案设计\n\n核心任务是使用两种不同的能量依赖中子通量模型，为一种共振吸收体计算并比较群平均微观吸收截面。此过程是生成反应堆分析程序中使用的多群截面库的基础。两种结果之间的差异量化了共振自屏现象，即共振峰处的高吸收会压低局部中子通量，从而与未受扰动通量下的预期反应率相比，有效反应率降低。\n\n#### 1. 基本方程\n\n在能群 $[E_{\\min}, E_{\\max}]$ 上的群平均微观吸收截面 $\\bar{\\sigma}_a$ 定义为群平均的每原子反应率，并由群平均通量归一化。其数学表达式为：\n$$\n\\bar{\\sigma}_{a} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\sigma_{a}(E)\\,\\phi(E)\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\phi(E)\\,dE}\n$$\n其中 $\\sigma_{a}(E)$ 是能量依赖的微观吸收截面，$\\phi(E)$ 是能量依赖的中子通量。\n\n#### 2. 吸收截面模型：单能级 Breit-Wigner (SLBW)\n\n孤立共振附近的吸收截面由单能级 Breit-Wigner 公式建模。对于 s 波 ($l=0$) 中子并假设窄共振近似，该公式由下式给出：\n$$\n\\sigma_{a}(E) = \\left(\\frac{\\pi}{k^{2}(E)}\\right)\\,g\\,\\frac{\\Gamma_{n}(E)\\,\\Gamma_{\\gamma}}{\\left(E - E_{0}\\right)^{2} + \\left(\\dfrac{\\Gamma}{2}\\right)^{2}}\n$$\n其中 $\\Gamma(E) = \\Gamma_{n}(E) + \\Gamma_{\\gamma}$ 是总共振宽度。问题指定统计自旋因子 $g=1$。\n\n项 $\\pi/k^2(E)$ 与中子的德布罗意波长相关，且与 $1/E$ 成正比。为了统一单位处理（截面单位为靶恩，能量单位为 eV），我们首先确定转换因子。中子波数 $k(E)$ 与其动能 $E$ 的关系为 $E = \\frac{\\hbar^2 k^2}{2 m_n}$。因此：\n$$\n\\frac{\\pi}{k^2(E)} = \\frac{\\pi \\hbar^2}{2 m_n E}\n$$\n为了用实用单位计算此式，我们使用约化普朗克常数 $\\hbar$、中子质量 $m_n$ 和电子伏特到焦耳的转换因子 $e$ 的值。设 $E_{\\text{eV}}$ 是以 eV 为单位的能量，$E_{\\text{J}}$ 是以焦耳为单位的能量。\n$$\n\\frac{\\pi}{k^2(E)} [\\text{m}^2] = \\frac{\\pi \\hbar^2}{2 m_n E_{\\text{J}}} = \\frac{\\pi \\hbar^2}{2 m_n e E_{\\text{eV}}}\n$$\n从 $\\text{m}^2$ 转换为靶恩 ($1\\,\\text{barn} = 10^{-28}\\,\\text{m}^2$)：\n$$\n\\frac{\\pi}{k^2(E)} [\\text{barns}] = \\left( \\frac{\\pi \\hbar^2}{2 m_n e \\times 10^{-28}} \\right) \\frac{1}{E_{\\text{eV}}} \\equiv \\frac{C_{\\sigma}}{E_{\\text{eV}}}\n$$\n使用这些常数的标准值（$\\hbar \\approx 1.05457 \\times 10^{-34}\\,\\text{J s}$，$m_n \\approx 1.67493 \\times 10^{-27}\\,\\text{kg}$，$e \\approx 1.60218 \\times 10^{-19}\\,\\text{J/eV}$），计算出常数 $C_{\\sigma}$ 约为 $6.5355 \\times 10^5\\,\\text{barns} \\cdot \\text{eV}$。\n\n中子宽度 $\\Gamma_n(E)$ 依赖于能量，与中子速度成正比，并建模为 $\\Gamma_n(E) = \\Gamma_{n0} \\sqrt{E/E_0}$，其中 $\\Gamma_{n0}$ 是在共振能量 $E_0$ 处的中子宽度。辐射俘获宽度 $\\Gamma_{\\gamma}$ 在共振范围内被假定为常数。\n\n#### 3. 中子通量模型\n\n考虑两种通量分布：\n-   **模型 A (未屏蔽)**: $\\phi_A(E) = C_A/E$。这代表了纯散射无限介质中的理想慢化通量。常数 $C_A$ 是任意的，在 $\\bar{\\sigma}_a$ 的表达式中会被消去。\n-   **模型 B (自屏蔽)**: $\\phi_B(E) = C_B \\frac{1/E}{1 + \\sigma_{a}(E)/\\sigma_{0}}$。该模型引入了一个通量压低因子 $1 / (1 + \\sigma_{a}(E)/\\sigma_{0})$，它在高吸收区域降低了通量。参数 $\\sigma_0$ 代表每个吸收体原子的总本底截面，并控制自屏效应的强度。较小的 $\\sigma_0$ 会导致更显著的通量压低。常数 $C_B$ 也会被消去。\n\n#### 4. 算法实现\n\n解决方案通过构建一个程序来实现，该程序为每个测试用例执行以下步骤：\n\n1.  **定义 $\\sigma_a(E)$ 函数**：该函数接受能量 $E$（单位 eV）和共振参数（$E_0, \\Gamma_{\\gamma}, \\Gamma_{n0}$）作为输入。它计算 $\\Gamma_n(E)$、总宽度 $\\Gamma(E)$、$\\pi/k^2(E)$ 项（使用预先计算的常数 $C_{\\sigma}$），并根据 SLBW 公式将它们组合起来，返回以靶恩为单位的 $\\sigma_a(E)$。\n\n2.  **计算 $\\bar{\\sigma}_{a}^{(A)}$**：\n    未屏蔽模型的群平均截面为：\n    $$\n    \\bar{\\sigma}_{a}^{(A)} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\sigma_{a}(E)\\,\\frac{1}{E}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\frac{1}{E}\\,dE}\n    $$\n    分子积分使用鲁棒的求积算法（例如 `scipy.integrate.quad`）进行数值计算。分母积分有一个简单的解析解 $\\int_{E_{\\min}}^{E_{\\max}} (1/E) dE = \\ln(E_{\\max}/E_{\\min})$，使用该解析解可获得更高的精度。\n\n3.  **计算 $\\bar{\\sigma}_{a}^{(B)}$**：\n    自屏蔽模型的群平均截面为：\n    $$\n    \\bar{\\sigma}_{a}^{(B)} = \\frac{\\int_{E_{\\min}}^{E_{\\max}} \\sigma_{a}(E)\\,\\frac{1/E}{1 + \\sigma_{a}(E)/\\sigma_{0}}\\,dE}{\\int_{E_{\\min}}^{E_{\\max}} \\frac{1/E}{1 + \\sigma_{a}(E)/\\sigma_{0}}\\,dE}\n    $$\n    由于被积函数的复杂性，分子和分母的积分都必须进行数值计算。使用相同的求积例程。为了提高效率，被积函数被定义为在每个求值点只计算一次 $\\sigma_a(E)$。\n\n4.  **计算敏感性度量 $r$**：\n    相对差异 $r$ 量化了自屏效应的影响：\n    $$\n    r = \\frac{\\bar{\\sigma}_{a}^{(B)} - \\bar{\\sigma}_{a}^{(A)}}{\\bar{\\sigma}_{a}^{(A)}}\n    $$\n    $r$ 的负值表示自屏效应降低了有效吸收截面。\n\n程序遍历所提供的测试用例，对每个用例执行这些计算，并将结果（$\\bar{\\sigma}_{a}^{(A)}$, $\\bar{\\sigma}_{a}^{(B)}$, $r$）汇总到一个单一的扁平列表中，以便进行格式化打印。使用数值积分对于捕捉截面在共振剖面上的快速变化至关重要。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates group-collapsed microscopic absorption cross sections under\n    two different flux assumptions (unshielded and self-shielded) to\n    evaluate the effect of resonance self-shielding.\n    \"\"\"\n\n    # Physical constants for unit conversions\n    # hbar in J.s\n    HBAR = 1.054571817e-34\n    # neutron mass in kg\n    M_N = 1.67492749804e-27\n    # eV to Joules conversion\n    EV_TO_J = 1.602176634e-19\n    # m^2 to barns conversion\n    M2_TO_BARN = 1e28\n\n    # Pre-calculate the constant C in the formula: pi/k^2(E) [barns] = C / E [eV]\n    # C = (pi * hbar^2) / (2 * m_n * eV_to_J) * m2_to_barn\n    PI_K2_CONST = (np.pi * HBAR**2) / (2 * M_N * EV_TO_J) * M2_TO_BARN\n\n    # Test cases: (E0, Gamma_gamma, Gamma_n0, sigma0, Emin, Emax)\n    # E0, Gamma_gamma, Gamma_n0, Emin, Emax in eV\n    # sigma0 in barns\n    test_cases = [\n        (6.67, 0.023, 0.027, 10.0, 5.0, 9.0),\n        (6.67, 0.023, 0.027, 10.0, 10.0, 20.0),\n        (6.67, 0.023, 0.010, 5.0, 6.6, 6.8),\n        (20.0, 0.100, 0.150, 15.0, 18.0, 22.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        E0, Gamma_gamma, Gamma_n0, sigma0, Emin, Emax = case\n        g_factor = 1.0\n\n        def sigma_a(E: float) -> float:\n            \"\"\"\n            Calculates the microscopic absorption cross section using the\n            Single-Level Breit-Wigner (SLBW) formula.\n\n            Args:\n                E (float): Neutron energy in eV.\n\n            Returns:\n                float: Absorption cross section in barns.\n            \"\"\"\n            if E == 0:\n                return 0.0\n            \n            # Energy-dependent neutron width\n            Gamma_n_E = Gamma_n0 * np.sqrt(E / E0)\n            \n            # Total resonance width\n            Gamma_total_E = Gamma_n_E + Gamma_gamma\n            \n            # pi/k^2 term in barns\n            pi_over_k2 = PI_K2_CONST / E\n            \n            # Breit-Wigner formula\n            numerator = Gamma_n_E * Gamma_gamma\n            denominator = (E - E0)**2 + (Gamma_total_E / 2)**2\n            \n            return pi_over_k2 * g_factor * (numerator / denominator)\n\n        # --- Calculation for Model A (unshielded flux, phi ~ 1/E) ---\n        # Numerator: integral of sigma_a(E) * phi_A(E) dE\n        # Denominator: integral of phi_A(E) dE\n        # The constant in phi_A cancels out.\n        \n        # Numerator integrand\n        integrand_A_num = lambda E: sigma_a(E) / E\n        \n        # Numerator calculation via numerical integration\n        num_A, _ = quad(integrand_A_num, Emin, Emax, limit=200)\n\n        # Denominator calculation (analytical)\n        den_A = np.log(Emax / Emin)\n        \n        sigma_a_bar_A = num_A / den_A\n        \n        # --- Calculation for Model B (self-shielded flux) ---\n        # phi ~ (1/E) / (1 + sigma_a(E)/sigma0)\n        \n        def integrand_B_num(E: float) -> float:\n            s_a = sigma_a(E)\n            flux_B_unnormalized = (1.0 / E) / (1.0 + s_a / sigma0)\n            return s_a * flux_B_unnormalized\n\n        def integrand_B_den(E: float) -> float:\n            s_a = sigma_a(E)\n            flux_B_unnormalized = (1.0 / E) / (1.0 + s_a / sigma0)\n            return flux_B_unnormalized\n\n        # Numerical integration for both numerator and denominator\n        num_B, _ = quad(integrand_B_num, Emin, Emax, limit=200)\n        den_B, _ = quad(integrand_B_den, Emin, Emax, limit=200)\n        \n        sigma_a_bar_B = num_B / den_B\n\n        # --- Sensitivity Metric Calculation ---\n        if sigma_a_bar_A == 0:\n            r = 0.0 if sigma_a_bar_B == 0.0 else np.inf\n        else:\n            r = (sigma_a_bar_B - sigma_a_bar_A) / sigma_a_bar_A\n\n        results.extend([sigma_a_bar_A, sigma_a_bar_B, r])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在更高能量区域，单个共振变得过于密集而无法分辨，形成了所谓的“未分辨共振区”(URR)。本练习介绍了一种先进且实用的技术——子群方法，来应对这一挑战 。通过对截面进行统计建模，并用一组离散值来近似其效应，这项实践让你深入了解即使在缺乏详细共振数据的情况下，现代计算程序如何精确地考虑自屏效应。",
            "id": "4220673",
            "problem": "您的任务是构建并分析用于核反应堆模拟的未分辨共振区（URR）中微观吸收截面的离散子群表示。\n\n未分辨共振区（URR）的特征是共振峰密集，其单个参数无法分辨；因此，在固定能量下，由于许多展宽共振的随机叠加，微观截面表现为随机变量。目标是通过对离散子能级的有限加权和来近似截面的期望泛函，并证明当子能级数量增加时该近似的收敛性。\n\n从“中子慢化平衡”和“反应率”的定义出发，考虑一个均匀吸收剂，其背底截面由一个正常数建模。在窄共振近似和恒定勒源假设下，截面$\\,\\sigma\\,$的一个常见屏蔽泛函是有理函数\n$$\ng(\\sigma;\\alpha) \\equiv \\frac{\\sigma}{1+\\alpha\\,\\sigma},\n$$\n其中$\\,\\alpha = 1/\\sigma_0\\,$，$\\,\\sigma_0\\,$是正的背底截面。该泛函通过吸收引起的局域中子通量减少来概括自屏效应；它是单调递增的，并以$\\,1/\\alpha\\,$为上界。\n\n在未分辨共振区（URR）的固定能量$\\,E\\,$下，假设微观吸收截面$\\,\\sigma\\,$被建模为一个具有伽马概率密度函数（PDF）的正随机变量，\n$$\np(\\sigma; k, \\theta) \\equiv \\frac{1}{\\theta^k \\,\\Gamma(k)}\\,\\sigma^{k-1}\\,e^{-\\sigma/\\theta}, \\quad \\sigma \\ge 0,\n$$\n其中$\\,k>0\\,$是无量纲的形状参数，$\\,\\theta>0\\,$是尺度参数，单位为靶（barn）。相应的累积分布函数（CDF）是$\\,F(\\sigma; k, \\theta) = P\\!\\left(k,\\sigma/\\theta\\right)\\,$，其中$\\,P(a,x)\\,$表示正则化下不完全伽马函数。该模型强制了正性，允许与未分辨共振涨落相符的可调变异性，并且在数学上易于处理。\n\n将屏蔽泛函的精确期望定义为\n$$\nI(k,\\theta,\\alpha) \\equiv \\int_0^{\\infty} g(\\sigma;\\alpha)\\,p(\\sigma; k, \\theta)\\,d\\sigma.\n$$\n\n为了构建具有$\\,n\\,$个子能级的子群表示，将概率空间划分为$\\,n\\,$个等概率层。设中位分位数点为\n$$\nu_i \\equiv \\frac{i-\\tfrac{1}{2}}{n}, \\quad i=1,2,\\dots,n,\n$$\n并通过分位数映射定义子群截面\n$$\n\\sigma_i \\equiv F^{-1}(u_i;k,\\theta), \\quad i=1,2,\\dots,n.\n$$\n分配相等的权重$\\,w_i \\equiv 1/n\\,$。对精确期望的子群近似即为在概率尺度上的中点黎曼和，\n$$\nS_n(k,\\theta,\\alpha) \\equiv \\frac{1}{n}\\sum_{i=1}^{n} g(\\sigma_i;\\alpha).\n$$\n\n您的程序必须：\n- 通过在$\\,\\sigma \\in [0,\\infty)\\,$上的数值积分计算精确期望$\\,I(k,\\theta,\\alpha)\\,$。\n- 使用上述定义的基于分位数的节点构建子群近似$\\,S_n(k,\\theta,\\alpha)\\,$。\n- 报告相对误差\n$$\n\\varepsilon_n \\equiv \\frac{\\left|S_n(k,\\theta,\\alpha) - I(k,\\theta,\\alpha)\\right|}{I(k,\\theta,\\alpha)}.\n$$\n- 通过为递增的$\\,n\\,$计算$\\,\\varepsilon_n\\,$来数值化地展示收敛性。\n\n应采用的科学和数学基础：\n- 反应率涉及截面相对于通量依赖泛函的期望，在窄共振近似中，通过平衡方程和通量凹陷的考虑，产生如$\\,g(\\sigma;\\alpha)\\,$的有理形式。\n- 选择$\\,\\sigma\\,$的伽马模型是因为其正性和与未分辨共振统计一致的可调偏度；$\\,g(\\sigma;\\alpha)\\,$有界且可测，确保期望存在，并且在标准控制收敛论证下，概率空间上的黎曼和近似是收敛的。\n\n单位和输出：\n- 截面$\\,\\sigma\\,$, $\\,\\theta\\,$和$\\,\\sigma_0\\,$必须以靶（barn）为单位处理。因此，参数$\\,\\alpha\\,$的单位是靶的倒数。报告的相对误差$\\,\\varepsilon_n\\,$是无单位的，必须表示为小数。\n- 角度单位不适用于此问题。\n\n测试套件和覆盖范围：\n对$\\,n \\in \\{\\,2,4,8,16\\,\\}\\,$，在以下测试案例中评估$\\,\\varepsilon_n\\,$。这些案例旨在探测典型的、窄的、重尾的未分辨共振区域以及不同的屏蔽强度：\n1. 正常路径：$\\,k=3.0\\,$, $\\,\\theta=0.6\\,\\text{barns}\\,$, $\\,\\sigma_0=1.5\\,\\text{barns}\\,$。\n2. 重尾变异性：$\\,k=0.7\\,$, $\\,\\theta=2.0\\,\\text{barns}\\,$, $\\,\\sigma_0=0.2\\,\\text{barns}\\,$。\n3. 窄分布：$\\,k=20.0\\,$, $\\,\\theta=0.1\\,\\text{barns}\\,$, $\\,\\sigma_0=5.0\\,\\text{barns}\\,$。\n4. 边缘重尾案例：$\\,k=0.3\\,$, $\\,\\theta=1.0\\,\\text{barns}\\,$, $\\,\\sigma_0=0.5\\,\\text{barns}\\,$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个由列表组成的逗号分隔列表的结果，每个内部列表对应一个测试案例，在每个内部列表中按顺序包含$\\,n=2\\,$, $\\,n=4\\,$, $\\,n=8\\,$和$\\,n=16\\,$的相对误差。例如，输出必须如下所示：\n$$\n[\\,[\\varepsilon_2^{(1)},\\varepsilon_4^{(1)},\\varepsilon_8^{(1)},\\varepsilon_{16}^{(1)}],\\,[\\varepsilon_2^{(2)},\\dots],\\,[\\varepsilon_2^{(3)},\\dots],\\,[\\varepsilon_2^{(4)},\\dots]\\,],\n$$\n打印在单行上，并使用小数值。这里的上标$\\,(\\ell)\\,$索引测试案例$\\,\\ell\\in\\{\\,1,2,3,4\\,\\}\\,$。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于核反应堆物理学的原理，特别是未分辨共振区中子截面的处理方法。该问题在数学上是适定的，提供了所有必要的参数和定义以确保一个唯一的、可计算的解。语言客观，设置没有内部矛盾或物理上的不可能性。\n\n任务是分析未分辨共振区（URR）中自屏蔽泛函的子群近似的收敛性。这涉及将该泛函的数值计算精确期望与其在子群数量增加时的离散近似进行比较。\n\n自屏蔽泛函描述了在窄共振近似下均匀介质中的有效吸收率，由有理函数给出\n$$\ng(\\sigma;\\alpha) \\equiv \\frac{\\sigma}{1+\\alpha\\,\\sigma}\n$$\n其中$\\sigma$是微观吸收截面，一个正随机变量，而$\\alpha = 1/\\sigma_0$是恒定背底截面$\\sigma_0$的倒数。\n\n在URR中固定能量下的微观截面$\\sigma$由伽马概率密度函数（PDF）建模：\n$$\np(\\sigma; k, \\theta) \\equiv \\frac{1}{\\theta^k \\,\\Gamma(k)}\\,\\sigma^{k-1}\\,e^{-\\sigma/\\theta}, \\quad \\sigma \\ge 0\n$$\n其中形状参数$k>0$，尺度参数$\\theta>0$。相应的累积分布函数（CDF）是$F(\\sigma; k, \\theta)$。\n\n分析过程分为三个主要步骤：计算精确期望，构建离散子群近似，以及评估相对误差。\n\n首先，屏蔽泛函的精确期望，记为$I(k,\\theta,\\alpha)$，由该泛函在截面分布上的积分定义：\n$$\nI(k,\\theta,\\alpha) \\equiv \\int_0^{\\infty} g(\\sigma;\\alpha)\\,p(\\sigma; k, \\theta)\\,d\\sigma = \\int_0^{\\infty} \\left(\\frac{\\sigma}{1+\\alpha\\,\\sigma}\\right) \\left(\\frac{1}{\\theta^k \\,\\Gamma(k)}\\,\\sigma^{k-1}\\,e^{-\\sigma/\\theta}\\right) \\,d\\sigma\n$$\n该积分通常不具有简单的闭式解析解。因此，其值必须使用数值积分方法确定。被积函数是两个良态函数的乘积：对于$\\sigma \\ge 0$，$g(\\sigma;\\alpha)$是有界且连续的，而$p(\\sigma; k, \\theta)$是伽马PDF。该积分保证收敛。我们将使用`scipy.integrate.quad`函数在域$\\sigma \\in [0, \\infty)$上进行高精度评估。\n\n其次，我们构建$n$点子群近似$S_n(k,\\theta,\\alpha)$。此方法将随机变量$\\sigma$的概率空间离散化。该过程等效于将积分变量从$\\sigma$更改为概率水平$u=F(\\sigma;k,\\theta)$，使得$d\\sigma = du / p(\\sigma;k,\\theta)$且$\\sigma = F^{-1}(u;k,\\theta)$。期望积分变换为：\n$$\nI(k,\\theta,\\alpha) = \\int_0^1 g(F^{-1}(u;k,\\theta); \\alpha) \\, du\n$$\n子群近似$S_n$是该变换后积分的一个中点黎曼和。概率区间$[0,1]$被划分为$n$个宽度为$w_i = 1/n$的相等子区间。评估点（或节点）选择为中位分位数：\n$$\nu_i \\equiv \\frac{i-\\tfrac{1}{2}}{n}, \\quad i=1,2,\\dots,n\n$$\n相应的截面值，称为子群截面，通过逆CDF（也称为分位数函数）获得：\n$$\n\\sigma_i \\equiv F^{-1}(u_i;k,\\theta)\n$$\n在计算上，伽马分布的分位数函数被实现为百分点函数（PPF），在`scipy.stats.gamma.ppf`中可用。子群近似即为加权和：\n$$\nS_n(k,\\theta,\\alpha) \\equiv \\sum_{i=1}^{n} w_i \\, g(\\sigma_i;\\alpha) = \\frac{1}{n}\\sum_{i=1}^{n} \\frac{\\sigma_i}{1+\\alpha\\,\\sigma_i}\n$$\n根据构造，当$n \\to \\infty$时，黎曼和近似$S_n$收敛到精确积分$I$。函数$g(F^{-1}(u;k,\\theta); \\alpha)$关于$u \\in (0,1)$是连续的，这保证了中点法则的收敛性。我们的任务是数值化地证明这种收敛性。\n\n第三，为每个$n$值计算相对误差$\\varepsilon_n$，以量化近似的准确性：\n$$\n\\varepsilon_n \\equiv \\frac{\\left|S_n(k,\\theta,\\alpha) - I(k,\\theta,\\alpha)\\right|}{I(k,\\theta,\\alpha)}\n$$\n我们将实现一个算法，对于每个给定的测试案例$(k, \\theta, \\sigma_0)$，首先计算参考值$I(k,\\theta,\\alpha)$，然后为$n \\in \\{2, 4, 8, 16\\}$迭代计算$S_n(k,\\theta,\\alpha)$和$\\varepsilon_n$。这将产生一个误差序列，预计该序列会随着$n$的增加而减小，从而数值验证子群方法的收敛性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import gamma\nfrom scipy.integrate import quad\nfrom scipy.special import gammainc\n\ndef solve():\n    \"\"\"\n    Computes and analyzes a discrete subgroup representation of a microscopic \n    absorption cross section model in the Unresolved Resonance Region (URR).\n    \"\"\"\n\n    # Define the shielding functional g(sigma; alpha)\n    def g_func(sigma, alpha):\n        return sigma / (1.0 + alpha * sigma)\n\n    # Define the test cases from the problem statement: (k, theta, sigma_0)\n    test_cases = [\n        (3.0, 0.6, 1.5),    # Case 1: Happy path\n        (0.7, 2.0, 0.2),    # Case 2: Heavy-tail variability\n        (20.0, 0.1, 5.0),   # Case 3: Narrow distribution\n        (0.3, 1.0, 0.5)     # Case 4: Edge heavy-tail case\n    ]\n\n    # Define the number of subgroup levels n to test\n    n_values = [2, 4, 8, 16]\n\n    # A list to store the results for all test cases\n    all_results = []\n\n    for k, theta, sigma_0 in test_cases:\n        # Calculate alpha from the background cross section sigma_0\n        alpha = 1.0 / sigma_0\n\n        # Define the integrand for the exact expectation I\n        # The integrand is g(sigma; alpha) * p(sigma; k, theta)\n        # We use scipy.stats.gamma.pdf for p(sigma; k, theta)\n        integrand = lambda s: g_func(s, alpha) * gamma.pdf(s, a=k, scale=theta)\n\n        # Compute the exact expectation I by numerical quadrature\n        # The integration is from 0 to infinity.\n        I_exact, _ = quad(integrand, 0, np.inf)\n\n        # A list to store the relative errors for the current test case\n        case_errors = []\n\n        for n in n_values:\n            # 1. Define the mid-quantile points u_i\n            u_i = (np.arange(1, n + 1) - 0.5) / n\n\n            # 2. Find the subgroup cross sections sigma_i = F^-1(u_i; k, theta)\n            # This is the Percent Point Function (PPF) of the Gamma distribution.\n            # scipy.stats.gamma uses shape 'a' for k and 'scale' for theta.\n            sigma_i = gamma.ppf(u_i, a=k, scale=theta)\n            \n            # 3. Calculate the subgroup approximation S_n\n            # This is the average of g(sigma_i; alpha) since weights are 1/n.\n            g_values = g_func(sigma_i, alpha)\n            S_n = np.mean(g_values)\n\n            # 4. Calculate the relative error epsilon_n\n            relative_error = np.abs(S_n - I_exact) / I_exact\n\n            case_errors.append(relative_error)\n\n        all_results.append(case_errors)\n\n    # Format the final output string exactly as required:\n    # [[err_n1_c1, err_n2_c1, ...],[err_n1_c2, ...], ...]\n    inner_lists_str = [f\"[{','.join([f'{err:.10f}' for err in err_list])}]\" for err_list in all_results]\n    final_str = f\"[{','.join(inner_lists_str)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_str)\n\nsolve()\n```"
        }
    ]
}