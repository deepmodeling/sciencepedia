{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex data formats, it is crucial to understand the fundamental physical quantities they represent. Nuclear data libraries often tabulate microscopic cross sections, $\\sigma$, in units of barns against incident particle energy in electron-volts. This practice bridges the gap between the abstract data in a file and its physical meaning by tasking you with converting these specialized units to the International System of Units (SI). By performing unit conversions and a dimensional analysis, you will solidify your understanding of how these quantities combine to produce a physically meaningful reaction rate, a cornerstone calculation in reactor physics. ",
            "id": "4238999",
            "problem": "A thermal-neutron reaction channel in a nuclear reactor simulation is represented in an Evaluated Nuclear Data File (ENDF). The ENDF convention is that microscopic cross sections are tabulated in barns as functions of incident energy in electron-volts. Consider a nuclide whose microscopic cross section obeys an exact inverse-speed law in the thermal range, with a quoted reference value at a reference energy. Use the following quantities and definitions:\n\n- The quoted reference microscopic cross section is $\\sigma_{0} = 540\\ \\mathrm{b}$ at the reference energy $E_{0} = 0.0253\\ \\mathrm{eV}$.\n- One barn is defined by $1\\ \\mathrm{b} = 10^{-24}\\ \\mathrm{cm}^{2}$.\n- The electron-volt is defined by $1\\ \\mathrm{eV} = q_{e}\\times 1\\ \\mathrm{V}$ with $q_{e} = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$ and $1\\ \\mathrm{V} = 1\\ \\mathrm{J/C}$.\n- The mega-electron-volt satisfies $1\\ \\mathrm{MeV} = 10^{6}\\ \\mathrm{eV}$.\n- Thermal equilibrium at temperature $T$ is connected to energy by the Boltzmann constant via $E = k_{\\mathrm{B}}T$ with $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$.\n- The neutron mass is $m_{n} = 1.674927498\\times 10^{-27}\\ \\mathrm{kg}$.\n\nA homogeneous neutron gas is in Maxwell–Boltzmann equilibrium at temperature $T = 600\\ \\mathrm{K}$ with uniform neutron number density $n_{n} = 1.00\\times 10^{15}\\ \\mathrm{m}^{-3}$. Starting from fundamental definitions, perform the following:\n\n1. Derive the unit conversions that map the nuclear data library conventions into International System of Units: $1\\ \\mathrm{b}$ to $\\mathrm{m}^{2}$, $1\\ \\mathrm{eV}$ to $\\mathrm{J}$, $1\\ \\mathrm{MeV}$ to $\\mathrm{J}$, and $1\\ \\mathrm{K}$ to $\\mathrm{J}$ via $k_{\\mathrm{B}}$.\n2. Using the microscopic inverse-speed law, the definition of microscopic cross section, and the definition of neutron scalar flux for a Maxwell–Boltzmann distribution, construct a dimensional analysis that demonstrates that the reaction rate per target nucleus has units of $\\mathrm{s}^{-1}$.\n3. Compute the reaction rate per target nucleus for the given data. To do this, first determine the reference speed $v_{0}$ corresponding to $E_{0}$ using nonrelativistic kinematics, and then use the inverse-speed law to evaluate the energy-integrated reaction rate per target nucleus in the Maxwell–Boltzmann gas.\n\nRound your final numerical answer to four significant figures and express it in $\\mathrm{s}^{-1}$. No intermediate rounding should be performed beyond what is necessary for the final reported value.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in established principles of nuclear physics and statistical mechanics, well-posed with sufficient and consistent information, and objective in its language. All provided data and terminologies are standard in the field of nuclear engineering. The tasks are clearly defined and lead to a unique, verifiable solution. We may therefore proceed with the solution.\n\nThe solution is presented in three parts, corresponding to the tasks specified in the problem statement.\n\n**Part 1: Unit Conversions**\n\nThe first task is to derive the unit conversions from the given definitions, mapping nuclear data library conventions and other common units to the International System of Units (SI).\n\n- **Barns to square meters ($b \\to m^2$):**\nThe barn is defined as $1 \\text{ b} = 10^{-24} \\text{ cm}^2$. The conversion from centimeters to meters is $1 \\text{ m} = 100 \\text{ cm}$, or $1 \\text{ cm} = 10^{-2} \\text{ m}$.\nTherefore, $1 \\text{ cm}^2 = (10^{-2} \\text{ m})^2 = 10^{-4} \\text{ m}^2$.\nSubstituting this into the definition of the barn gives:\n$1 \\text{ b} = 10^{-24} \\times (10^{-4} \\text{ m}^2) = 10^{-28} \\text{ m}^2$.\n\n- **Electron-volts to Joules ($eV \\to J$):**\nThe electron-volt is defined as $1 \\text{ eV} = q_e \\times 1 \\text{ V}$, where $q_e = 1.602176634 \\times 10^{-19} \\text{ C}$ is the elementary charge and $1 \\text{ V} = 1 \\text{ J/C}$.\nThus, $1 \\text{ eV} = (1.602176634 \\times 10^{-19} \\text{ C}) \\times (1 \\text{ J/C}) = 1.602176634 \\times 10^{-19} \\text{ J}$.\n\n- **Mega-electron-volts to Joules ($MeV \\to J$):**\nUsing the definition $1 \\text{ MeV} = 10^6 \\text{ eV}$ and the conversion for electron-volts to Joules:\n$1 \\text{ MeV} = 10^6 \\times (1.602176634 \\times 10^{-19} \\text{ J}) = 1.602176634 \\times 10^{-13} \\text{ J}$.\n\n- **Kelvin to Joules ($K \\to J$):**\nThe problem asks for the conversion of $1 \\text{ K}$ to $\\text{J}$ via the Boltzmann constant, using the relation $E = k_{\\mathrm{B}} T$. This provides the energy equivalent of a temperature of $1$ Kelvin. With $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\text{ J/K}$, the energy equivalence is:\n$E(1 \\text{ K}) = (1.380649 \\times 10^{-23} \\text{ J/K}) \\times (1 \\text{ K}) = 1.380649 \\times 10^{-23} \\text{ J}$.\n\n**Part 2: Dimensional Analysis of Reaction Rate**\n\nThe second task is to demonstrate that the reaction rate per target nucleus has units of inverse time ($\\text{s}^{-1}$).\n\nThe reaction rate per target nucleus, denoted by $R$, is the probability per unit time of a reaction occurring. It is calculated by integrating the product of the microscopic cross section, $\\sigma(E)$, and the energy-dependent neutron scalar flux, $\\phi(E)$, over all possible neutron energies $E$:\n$$R = \\int_{0}^{\\infty} \\sigma(E) \\phi(E) dE$$\nLet us analyze the dimensions of each term in SI units, denoted by square brackets $[...]$.\n\n1.  **Microscopic cross section $\\sigma(E)$:** This quantity represents an effective target area. Its dimension is area, $[L]^2$. In SI units, this is $\\text{m}^2$.\n\n2.  **Energy-dependent neutron scalar flux $\\phi(E)$:** The scalar flux $\\phi(E)$ is defined such that $\\phi(E)dE$ gives the flux of neutrons with energies in the interval $[E, E+dE]$. The total scalar flux $\\Phi = \\int \\phi(E) dE$ has units of neutrons per unit area per unit time, or $[\\text{length}]^{-2} [\\text{time}]^{-1}$ ($\\text{m}^{-2} \\text{s}^{-1}$).\n    Therefore, the dimension of $\\phi(E)$ must be $[\\Phi]/[E]$, which is $([\\text{length}]^{-2} [\\text{time}]^{-1}) / [\\text{energy}]$. In SI units, this is $\\text{m}^{-2} \\text{s}^{-1} \\text{J}^{-1}$.\n\nAlternatively, we can derive the units of $\\phi(E)$ from fundamental definitions for a gas of particles. The flux is $\\phi(E) = n(E) v(E)$, where $n(E)$ is the number density of neutrons per unit energy, and $v(E)$ is the neutron speed at energy $E$.\n-   The dimension of number density $n_n$ is $[\\text{number}]/[\\text{volume}]$, which is $[L]^{-3}$ ($\\text{m}^{-3}$).\n-   The dimension of $n(E)$ is $[n_n]/[E] = [L]^{-3} [\\text{energy}]^{-1}$ ($\\text{m}^{-3} \\text{J}^{-1}$).\n-   The dimension of speed $v(E)$ is $[L] [T]^{-1}$ ($\\text{m s}^{-1}$).\n-   Thus, the dimension of $\\phi(E)$ is $[\\phi(E)] = [n(E)][v(E)] = ([L]^{-3} [\\text{energy}]^{-1}) \\times ([L][T]^{-1}) = [L]^{-2} [T]^{-1} [\\text{energy}]^{-1}$. In SI, this is $\\text{m}^{-2} \\text{s}^{-1} \\text{J}^{-1}$, which is consistent.\n\n3.  **Integral:** The dimension of the integral is the product of the dimensions of its components:\n    $[R] = [\\sigma(E)] \\times [\\phi(E)] \\times [dE]$.\n    Substituting the dimensions derived above:\n    $[R] = ([L]^2) \\times ([L]^{-2} [T]^{-1} [\\text{energy}]^{-1}) \\times ([\\text{energy}])$.\n    The dimensions of length and energy cancel out, leaving:\n    $[R] = [T]^{-1}$.\nIn SI units, the unit of time is the second, so the unit of the reaction rate per target nucleus is $\\text{s}^{-1}$.\n\n**Part 3: Calculation of Reaction Rate**\n\nThe third task is to compute the numerical value of the reaction rate per target nucleus, $R$.\n\nThe cross section follows an inverse-speed law, meaning $\\sigma(v) \\propto 1/v$. We can write this in terms of the reference values $\\sigma_0$ and $v_0$ (the speed corresponding to energy $E_0$):\n$\\sigma(v)v = \\sigma_0 v_0 = \\text{constant}$.\nThe non-relativistic kinetic energy is $E = \\frac{1}{2}m_n v^2$, so $v = \\sqrt{2E/m_n}$.\nThe cross section as a function of energy is therefore:\n$\\sigma(E) = \\sigma_0 \\frac{v_0}{v(E)} = \\sigma_0 \\frac{\\sqrt{2E_0/m_n}}{\\sqrt{2E/m_n}} = \\sigma_0 \\sqrt{\\frac{E_0}{E}}$.\n\nThe reaction rate per target nucleus is $R = \\int_0^\\infty \\sigma(E)\\phi(E)dE$. The neutron gas is in Maxwell-Boltzmann equilibrium at temperature $T$. The energy-dependent neutron number density $n(E)$ is given by the Maxwell-Boltzmann distribution:\n$$n(E) = n_n \\frac{2}{\\sqrt{\\pi}} (k_{\\mathrm{B}} T)^{-3/2} \\sqrt{E} \\exp\\left(-\\frac{E}{k_{\\mathrm{B}} T}\\right)$$\nwhere $n_n$ is the total neutron number density.\nThe energy-dependent scalar flux is $\\phi(E) = n(E)v(E)$. Substituting the expressions for $\\sigma(E)$ and $\\phi(E)$:\n$$R = \\int_0^\\infty \\left(\\sigma_0 \\sqrt{\\frac{E_0}{E}}\\right) \\left(n(E) \\sqrt{\\frac{2E}{m_n}}\\right) dE$$\n$$R = \\int_0^\\infty \\left(\\sigma_0 \\sqrt{E_0}\\right) \\left(n(E) \\sqrt{\\frac{2}{m_n}}\\right) dE$$\nThe term $\\sqrt{E}$ in the denominator of $\\sigma(E)$ cancels with a $\\sqrt{E}$ from $v(E)$. We can factor out the constants:\n$$R = \\sigma_0 \\sqrt{E_0} \\sqrt{\\frac{2}{m_n}} \\int_0^\\infty n(E) dE$$\nThe integral $\\int_0^\\infty n(E) dE$ is, by definition, the total neutron number density $n_n$.\nSo, the expression for the reaction rate simplifies to:\n$$R = n_n \\sigma_0 \\sqrt{\\frac{2E_0}{m_n}}$$\nWe recognize that $v_0 = \\sqrt{2E_0/m_n}$ is the reference speed corresponding to the reference energy $E_0$. The expression becomes:\n$$R = n_n \\sigma_0 v_0$$\nThis is a notable result: for a $1/v$ cross section, the reaction rate in a thermal neutron gas is independent of the gas temperature $T$. The value given for $T = 600 \\text{ K}$ is not needed for the final calculation.\n\nNow, we compute the numerical value. First, we find the reference speed $v_0$ using the given constants, all in SI units.\n-   $E_0 = 0.0253 \\text{ eV} = 0.0253 \\times (1.602176634 \\times 10^{-19} \\text{ J}) = 4.05350587442 \\times 10^{-21} \\text{ J}$.\n-   $m_n = 1.674927498 \\times 10^{-27} \\text{ kg}$.\n$$v_0 = \\sqrt{\\frac{2 \\times (4.05350587442 \\times 10^{-21} \\text{ J})}{1.674927498 \\times 10^{-27} \\text{ kg}}} = \\sqrt{4840251.272 \\text{ m}^2/\\text{s}^2} \\approx 2199.988016 \\text{ m/s}$$\nNext, we convert the cross section $\\sigma_0$ to SI units:\n-   $\\sigma_0 = 540 \\text{ b} = 540 \\times 10^{-28} \\text{ m}^2 = 5.40 \\times 10^{-26} \\text{ m}^2$.\n\nFinally, we calculate $R$ using the given neutron density $n_n = 1.00 \\times 10^{15} \\text{ m}^{-3}$:\n$$R = (1.00 \\times 10^{15} \\text{ m}^{-3}) \\times (5.40 \\times 10^{-26} \\text{ m}^2) \\times (2199.988016 \\text{ m/s})$$\n$$R = 1.187993529 \\times 10^{-7} \\text{ s}^{-1}$$\nRounding the result to four significant figures as requested:\n$$R \\approx 1.188 \\times 10^{-7} \\text{ s}^{-1}$$",
            "answer": "$$\\boxed{1.188 \\times 10^{-7}}$$"
        },
        {
            "introduction": "Modern nuclear data is stored in structured formats like the A Compact ENDF (ACE) format, designed for efficient use in Monte Carlo simulation codes. A core task for any nuclear data tool is to parse these files and retrieve cross section values at arbitrary energies, which requires interpolation between tabulated grid points. This exercise provides hands-on experience in simulating this fundamental data retrieval process by having you implement a function to locate specific reaction channels by their Material Type (MT) number and perform linear interpolation. This is a skill directly applicable to building custom analysis scripts or understanding the inner workings of reactor simulation codes. ",
            "id": "4238995",
            "problem": "You are given a simplified in-memory representation of an A Compact Evaluated Nuclear Data File (ACE) for a single nuclide, restricted to the information required to compute microscopic reaction cross sections on a common energy grid. The goal is to determine the total microscopic cross section at a specified energy by locating the Material Type (MT) reaction identifiers corresponding to elastic scattering and radiative capture, interpolating each reaction's cross section at the target energy, and summing the relevant contributions.\n\nFundamental base: The microscopic reaction cross section $\\sigma(E)$ is the probability per unit path length for an interaction channel at neutron energy $E$ and is expressed in barns. For independent channels, the total microscopic cross section for a selected set of reactions is given by the sum of their microscopic cross sections. Linear interpolation in energy is justified on piecewise smooth, tabulated cross sections; specifically, for energies tabulated at monotonically increasing points $\\{E_i\\}_{i=0}^{N-1}$ with corresponding values $\\{\\sigma_i\\}_{i=0}^{N-1}$, the interpolation inside the interval $[E_i, E_{i+1}]$ is obtained by the unique linear function passing through the two points.\n\nData representation: Each dataset consists of a single energy grid and a list of reactions. Each reaction is identified by its MT number and provides an array of tabulated cross sections over the same energy grid. Use MT $2$ for elastic scattering and MT $102$ for radiative capture. If any of these reactions are absent, treat their contribution as zero.\n\nInterpolation and extrapolation rule:\n- For $E$ within the grid, find $i$ such that $E_i \\le E \\le E_{i+1}$ and compute\n$$\nt = \\frac{E - E_i}{E_{i+1} - E_i}, \\quad \\sigma(E) = \\sigma_i + t\\left(\\sigma_{i+1} - \\sigma_i\\right).\n$$\n- For $E < E_0$, extrapolate using the first segment $[E_0, E_1]$ with the same formula.\n- For $E > E_{N-1}$, extrapolate using the last segment $[E_{N-2}, E_{N-1}]$ with the same formula.\n- Enforce physical non-negativity per channel by setting $\\sigma(E) \\leftarrow \\max(0, \\sigma(E))$ after interpolation or extrapolation.\n- The total microscopic cross section is the sum of the elastic and capture cross sections at $E$.\n\nUnits:\n- Energies must be treated and reported in electronvolts (eV).\n- Cross sections must be treated and reported in barns (b).\n- Your program’s numeric outputs must be rounded to six decimal places.\n\nImplement a program that, for each test case below, locates the indices of MT $2$ and MT $102$ within the reaction list, performs the interpolation or extrapolation as specified, sums the elastic and capture contributions, and outputs the total microscopic cross section in barns. If a reaction is missing, its contribution is zero.\n\nTest suite:\n- Dataset $\\mathcal{A}$:\n  - Energy grid $\\mathbf{E}^{(\\mathcal{A})} = [\\,10^{-5},\\,10^{-3},\\,10^{-1},\\,1\\,]$ eV.\n  - Reactions:\n    - MT $2$ (elastic): $\\boldsymbol{\\sigma}_{2}^{(\\mathcal{A})} = [\\,20.0,\\,18.0,\\,12.0,\\,8.0\\,]$ b.\n    - MT $102$ (capture): $\\boldsymbol{\\sigma}_{102}^{(\\mathcal{A})} = [\\,100.0,\\,10.0,\\,1.0,\\,0.1\\,]$ b.\n  - Energies to evaluate:\n    - $E^{(\\mathcal{A},1)} = 10^{-3}$ eV (exactly on grid).\n    - $E^{(\\mathcal{A},2)} = 5\\times 10^{-2}$ eV (between grid points).\n    - $E^{(\\mathcal{A},3)} = 10^{-6}$ eV (below grid, extrapolation).\n    - $E^{(\\mathcal{A},4)} = 2$ eV (above grid, extrapolation).\n- Dataset $\\mathcal{B}$:\n  - Energy grid $\\mathbf{E}^{(\\mathcal{B})} = [\\,10^{-2},\\,10^{-1},\\,10\\,]$ eV.\n  - Reactions:\n    - MT $2$ (elastic): $\\boldsymbol{\\sigma}_{2}^{(\\mathcal{B})} = [\\,5.0,\\,5.5,\\,6.0\\,]$ b.\n    - MT $102$ (capture): missing.\n  - Energy to evaluate:\n    - $E^{(\\mathcal{B},1)} = 1$ eV (between grid points).\n- Dataset $\\mathcal{C}$:\n  - Energy grid $\\mathbf{E}^{(\\mathcal{C})} = [\\,0.0253,\\,0.5,\\,1.0\\,]$ eV.\n  - Reactions:\n    - MT $102$ (capture): $\\boldsymbol{\\sigma}_{102}^{(\\mathcal{C})} = [\\,600.0,\\,30.0,\\,15.0\\,]$ b.\n    - MT $2$ (elastic): missing.\n  - Energy to evaluate:\n    - $E^{(\\mathcal{C},1)} = 0.5$ eV (exactly on grid).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases listed above:\n$[\\,\\sigma_{\\text{tot}}^{(\\mathcal{A},1)},\\,\\sigma_{\\text{tot}}^{(\\mathcal{A},2)},\\,\\sigma_{\\text{tot}}^{(\\mathcal{A},3)},\\,\\sigma_{\\text{tot}}^{(\\mathcal{A},4)},\\,\\sigma_{\\text{tot}}^{(\\mathcal{B},1)},\\,\\sigma_{\\text{tot}}^{(\\mathcal{C},1)}\\,]$.",
            "solution": "The problem presented is valid. It is scientifically grounded in the principles of nuclear reactor physics, specifically concerning the use of evaluated nuclear data. The problem is well-posed, providing a self-contained, unambiguous set of data and rules for calculating microscopic cross sections. All required parameters, boundary conditions, and calculation steps are explicitly defined, permitting a unique and verifiable solution.\n\nThe objective is to compute the total microscopic cross section, $\\sigma_{\\text{tot}}(E)$, at a specified neutron energy $E$ by summing the contributions from elastic scattering (Material Type MT $2$) and radiative capture (MT $102$). The calculation is based on tabulated cross-section data for a single nuclide. The governing principle is that for independent reaction channels, the total cross section is the linear superposition of the partial cross sections:\n$$\n\\sigma_{\\text{tot}}(E) = \\sigma_{\\text{elastic}}(E) + \\sigma_{\\text{capture}}(E)\n$$\nIn this context, $\\sigma_{\\text{elastic}}(E)$ corresponds to the cross section for MT $2$ at energy $E$, and $\\sigma_{\\text{capture}}(E)$ corresponds to that for MT $102$. If either reaction is not specified in the dataset, its contribution to the sum is taken to be zero.\n\nThe core of the task is to determine the value of a partial cross section $\\sigma(E)$ from a discrete set of energy points, $\\{E_i\\}_{i=0}^{N-1}$, and their corresponding cross section values, $\\{\\sigma_i\\}_{i=0}^{N-1}$. The problem mandates a specific procedure for interpolation and extrapolation.\n\nAn algorithm to solve this problem is structured as follows. First, a generalized function is designed to compute a single reaction's cross section at a target energy $E$. This function encapsulates the logic for interpolation, extrapolation, and the non-negativity constraint.\n\nLet the energy grid be $\\mathbf{E} = [E_0, E_1, \\dots, E_{N-1}]$ and the corresponding cross section values be $\\boldsymbol{\\sigma} = [\\sigma_0, \\sigma_1, \\dots, \\sigma_{N-1}]$.\n\nThe procedure to find $\\sigma(E)$ is:\n1.  **Identify the bracketing interval:** The energy grid is monotonically increasing. We must find the indices that define the segment for linear interpolation or extrapolation.\n    *   **Extrapolation (below-grid):** If $E < E_0$, the calculation uses the first segment, i.e., the points $(E_0, \\sigma_0)$ and $(E_1, \\sigma_1)$. The indices for calculation are $i=0$ and $i+1=1$.\n    *   **Extrapolation (above-grid):** If $E > E_{N-1}$, the calculation uses the last segment, i.e., the points $(E_{N-2}, \\sigma_{N-2})$ and $(E_{N-1}, \\sigma_{N-1})$. The indices are $i=N-2$ and $i+1=N-1$.\n    *   **Interpolation (on-grid):** If $E_0 \\le E \\le E_{N-1}$, we must find an index $i$ such that $E_i \\le E \\le E_{i+1}$. This can be achieved efficiently using a binary search algorithm on the energy grid. For an exact match, where $E = E_i$, the cross section is simply $\\sigma_i$.\n\n2.  **Calculate the interpolated/extrapolated value:** Once the bracketing points $(E_i, \\sigma_i)$ and $(E_{i+1}, \\sigma_{i+1})$ are determined, the value $\\sigma(E)$ is found using the formula for linear interpolation:\n    $$\n    t = \\frac{E - E_i}{E_{i+1} - E_i}\n    $$\n    $$\n    \\sigma(E) = \\sigma_i + t(\\sigma_{i+1} - \\sigma_i)\n    $$\n    This single formula correctly handles both interpolation (where $0 \\le t \\le 1$) and extrapolation (where $t < 0$ or $t > 1$) based on the chosen interval.\n\n3.  **Enforce physical constraint:** The microscopic cross section cannot be negative. Therefore, the computed value is subject to a non-negativity condition:\n    $$\n    \\sigma(E) \\leftarrow \\max(0, \\sigma(E))\n    $$\n\nThis robust, single-channel calculation function is then applied to each test case. For each specified evaluation energy, we perform the following steps:\n1.  Initialize the contributions $\\sigma_{\\text{elastic}}(E) = 0$ and $\\sigma_{\\text{capture}}(E) = 0$.\n2.  Check if data for MT $2$ is available in the given dataset. If so, call the interpolation function with the energy $E$, the dataset's energy grid, and the MT $2$ cross-section array. The result is assigned to $\\sigma_{\\text{elastic}}(E)$.\n3.  Check if data for MT $102$ is available. If so, perform the same calculation for MT $102$ and assign the result to $\\sigma_{\\text{capture}}(E)$.\n4.  Compute the total cross section $\\sigma_{\\text{tot}}(E) = \\sigma_{\\text{elastic}}(E) + \\sigma_{\\text{capture}}(E)$.\n5.  The final result is rounded to six decimal places as required.\n\nThis procedure is systematically applied to all specified datasets and evaluation energies to generate the final list of results.",
            "answer": "[28.000000,20.575758,120.836364,3.555556,5.545455,30.000000]"
        },
        {
            "introduction": "For physical consistency, the total microscopic cross section, $\\sigma_{\\text{tot}}$, must equal the sum of all its constituent partial reaction cross sections, $\\sum_j \\sigma_j$. However, discrepancies can arise in evaluated data files due to different processing methods, such as the use of varied energy grids or incompatible interpolation laws between different reaction channels. This advanced practice delves into the critical task of data validation, challenging you to programmatically verify this conservation principle. By identifying and classifying inconsistencies, you will gain insight into the practical challenges of nuclear data processing and the importance of ensuring a library's internal consistency before it is used in high-fidelity simulations. ",
            "id": "4239013",
            "problem": "You are given a collection of simplified Evaluated Nuclear Data File version 6 (ENDF-6) reaction cross section sections representing a single target nuclide, including one total cross section section and several partial reaction cross section sections (elastic scattering, radiative capture, fission, and inelastic scattering). In nuclear reactor simulation, the total microscopic cross section is expected to equal the sum of its exclusive reaction channel cross sections when defined consistently under the same processing assumptions. Your task is to programmatically detect and quantify discrepancies between the tabulated total cross section and the sum of the interpolated partial cross sections over a unified energy grid, and to classify likely sources of discrepancy, focusing on threshold misalignment and interpolation mismatch.\n\nFundamental base and assumptions:\n- The reaction rate for a process is given by $R = N \\, \\phi \\, \\sigma$, where $N$ is number density, $\\phi$ is neutron flux, and $\\sigma$ is the microscopic cross section. For a fixed target and energy, the total reaction probability per unit path length is the sum over exclusive channels, which implies the identity $\\sigma_{\\text{tot}}(E) \\approx \\sum_{j} \\sigma_{j}(E)$ when all channels $j$ are consistently defined and processed.\n- ENDF-6 sections tabulate pairs $(E_i, \\sigma_i)$ and specify interpolation laws that define $\\sigma(E)$ between tabulated energies. In this problem, we restrict to the widely used ENDF-6 interpolation law codes: $1$ for linear-linear and $4$ for logarithmic-logarithmic. Let $(E_0, \\sigma_0)$ and $(E_1, \\sigma_1)$ bracket an energy $E$:\n    - For code $1$ (linear-linear), the interpolated cross section is\n    $$\\sigma(E) = \\sigma_0 + \\left(\\sigma_1 - \\sigma_0\\right) \\frac{E - E_0}{E_1 - E_0}.$$\n    - For code $4$ (logarithmic-logarithmic), assuming $E_0 > 0$, $E_1 > 0$, $\\sigma_0 > 0$, and $\\sigma_1 > 0$,\n    $$\\ln \\sigma(E) = \\ln \\sigma_0 + \\left(\\ln \\sigma_1 - \\ln \\sigma_0\\right) \\frac{\\ln E - \\ln E_0}{\\ln E_1 - \\ln E_0}, \\quad \\sigma(E) = \\exp\\left(\\ln \\sigma(E)\\right).$$\n- Threshold behavior is present when a reaction channel has $\\sigma_j(E) \\approx 0$ below some threshold energy while the total cross section remains nonzero due to contributions from other channels. Interpolation mismatch occurs when the total and partial sections use different interpolation laws such that even if tabulated values sum at the node points, their interpolations in between differ.\n\nEnergy grid construction:\n- Let $E_{\\text{union}}$ be the sorted union of all tabulated energies across all sections.\n- Define the evaluation grid $G$ as the union of $E_{\\text{union}}$ and the arithmetic midpoints between adjacent elements of $E_{\\text{union}}$, i.e., if $E_{\\text{union}} = \\{e_1 < e_2 < \\dots < e_n\\}$, then\n$$G = E_{\\text{union}} \\cup \\left\\{\\frac{e_i + e_{i+1}}{2} : i = 1, \\dots, n-1\\right\\}.$$\n\nDiscrepancy metric:\n- For each $E \\in G$, let $\\sigma_{\\text{tot}}(E)$ be the interpolated total cross section and $\\sigma_{\\text{sum}}(E) = \\sum_{j} \\sigma_j(E)$ be the interpolated sum of partials over all provided partial reaction sections (excluding the total section).\n- Define the absolute fractional discrepancy at $E$ as\n$$d(E) = \\frac{\\left|\\sigma_{\\text{tot}}(E) - \\sigma_{\\text{sum}}(E)\\right|}{\\max\\left(\\epsilon, \\sigma_{\\text{tot}}(E)\\right)},$$\nwhere $\\epsilon = 10^{-12}$ in barns is a small stabilizing constant. Energies must be in electron-volts (eV) and cross sections in barns (b); the discrepancy $d(E)$ is dimensionless and must be reported as a decimal (not a percentage).\n- The output for each test case is the pair consisting of the maximum absolute fractional discrepancy over $G$ and an integer code classifying the likely source:\n    - $0$ means no likely issue detected.\n    - $1$ means threshold misalignment likely (discrepancies concentrated where one or more partial cross sections are approximately zero while the total is nonzero).\n    - $2$ means interpolation mismatch likely (discrepancies occurring away from thresholds and interpolation laws differ across sections).\n\nDiagnostic classification rule to implement:\n- Let $\\tau = 10^{-8}$ b. Compute $E^{\\star} = \\arg\\max_{E \\in G} d(E)$. If for at least one partial reaction $j$ we have $\\sigma_j(E^{\\star}) < \\tau$ while $\\sigma_{\\text{tot}}(E^{\\star}) \\ge 10 \\tau$, classify as $1$ (threshold misalignment). Else, if the interpolation law codes differ among sections and at $E^{\\star}$ all cross sections are $\\ge \\tau$, classify as $2$ (interpolation mismatch). Otherwise classify as $0$.\n\nInput representation and constraints:\n- Each section is specified by a tuple $(\\text{MT}, \\text{INT}, \\text{NBT}, E, \\sigma)$, where:\n    - $\\text{MT}$ is the ENDF reaction identifier (with $\\text{MT} = 1$ for the total cross section).\n    - $\\text{INT}$ is a list of ENDF interpolation law codes applicable over segments.\n    - $\\text{NBT}$ is a list of $1$-based indices denoting the end of each interpolation segment in the tabulation (cumulative, as per ENDF-6 convention). In these test cases, a single segment is used with $\\text{NBT} = [N]$ and one law code.\n    - $E$ is the list of tabulated energies in eV (strictly increasing and positive).\n    - $\\sigma$ is the list of tabulated cross sections in barns (nonnegative, and strictly positive when used with logarithmic interpolation).\n- Your program must interpolate only within the convex hull of tabulated energies for each section. If $E \\in G$ falls outside a section’s energy range, clamp to the nearest tabulated cross section value at the boundary for that section.\n\nTest suite:\n- Case $1$ (happy path, coherent lin-lin): Sections with $\\text{INT} = [1]$ for all, tabulated at $E = [1.0\\times 10^{2}, 1.0\\times 10^{3}, 1.0\\times 10^{4}, 1.0\\times 10^{5}]$ eV. Cross sections (in barns):\n    - Total ($\\text{MT}=1$): $\\sigma = [3.0, 3.0, 3.0, 3.0]$.\n    - Elastic ($\\text{MT}=2$): $\\sigma = [2.0, 1.8, 1.5, 1.2]$.\n    - Capture ($\\text{MT}=102$): $\\sigma = [1.0, 0.8, 0.5, 0.3]$.\n    - Fission ($\\text{MT}=18$): $\\sigma = [0.0, 0.4, 1.0, 1.5]$.\n- Case $2$ (threshold misalignment): Sections with $\\text{INT} = [1]$ for all, tabulated at $E = [5.0\\times 10^{4}, 1.0\\times 10^{5}, 5.0\\times 10^{5}]$ eV. Cross sections (in barns):\n    - Total ($\\text{MT}=1$): $\\sigma = [2.0, 2.5, 3.0]$.\n    - Elastic ($\\text{MT}=2$): $\\sigma = [1.0, 1.1, 1.2]$.\n    - Capture ($\\text{MT}=102$): $\\sigma = [0.8, 0.9, 1.0]$.\n    - Inelastic ($\\text{MT}=51$): $\\sigma = [0.0, 0.5, 0.8]$.\n- Case $3$ (interpolation mismatch): Total uses linear-linear, partials use logarithmic-logarithmic; tabulated at $E = [1.0\\times 10^{2}, 1.0\\times 10^{4}, 1.0\\times 10^{6}]$ eV. Cross sections (in barns):\n    - Total ($\\text{MT}=1$, $\\text{INT}=[1]$): $\\sigma = [3.0, 3.0, 3.0]$.\n    - Elastic ($\\text{MT}=2$, $\\text{INT}=[4]$): $\\sigma = [2.0, 2.5, 2.8]$.\n    - Capture ($\\text{MT}=102$, $\\text{INT}=[4]$): $\\sigma = [1.0, 0.5, 0.2]$.\n\nYour program should produce a single line of output containing a list of per-case results, where each per-case result is a two-element list $[\\text{dmax}, \\text{code}]$, with $\\text{dmax}$ the maximum absolute fractional discrepancy over $G$ rounded to six digits after the decimal point (dimensionless decimal), and $\\text{code}$ the integer classification as defined above. The final line must be of the form\n$$[[\\text{dmax}_1,\\text{code}_1],[\\text{dmax}_2,\\text{code}_2],[\\text{dmax}_3,\\text{code}_3]].$$\nNo other output should be printed. Energies must be treated in eV and cross sections in barns throughout.",
            "solution": "The problem requires the validation of simplified nuclear cross section data by verifying the fundamental physical principle of reaction probability conservation. This principle dictates that the total reaction cross section, $\\sigma_{\\text{tot}}(E)$, must be equal to the sum of all its constituent partial reaction cross sections, $\\sum_{j} \\sigma_{j}(E)$. Discrepancies often arise from data processing artifacts, such as inconsistent interpolation schemes or misaligned reaction thresholds. The task is to implement an algorithm to quantify such discrepancies and classify their likely origin. The solution is executed through a sequence of rigorous computational steps.\n\nFirst, an appropriate energy grid for comparison must be established. Since different reaction channels (and the total cross section) may be tabulated on different energy grids, we must construct a unified evaluation grid, denoted as $G$. This grid must be fine enough to capture variations between tabulated points. It is constructed from the sorted union of all tabulated energy points from all provided sections, which we call $E_{\\text{union}}$. To probe the behavior between the tabulated nodes, we also include the arithmetic midpoints between each pair of adjacent nodes in $E_{\\text{union}}$. Thus, if $E_{\\text{union}} = \\{e_1, e_2, \\dots, e_n\\}$ with $e_1 < e_2 < \\dots < e_n$, the final grid is $G = E_{\\text{union}} \\cup \\{ \\frac{e_i + e_{i+1}}{2} \\}_{i=1}^{n-1}$.\n\nSecond, for each energy point $E$ in the grid $G$, we must compute the cross section value for every reaction channel. This requires an interpolation function that can handle the standard ENDF-6 laws specified. For a given energy $E$ and a reaction section with data points $(E_i, \\sigma_i)$, we first locate the bracketing energy interval $[E_0, E_1]$ such that $E_0 \\le E \\le E_1$. If $E$ lies outside the tabulated range for a section, the cross section is clamped to the value at the nearest boundary. Within an interval, the interpolated value $\\sigma(E)$ is calculated based on the specified law. For interpolation code $1$ (linear-linear), the formula is:\n$$ \\sigma(E) = \\sigma_0 + (\\sigma_1 - \\sigma_0) \\frac{E - E_0}{E_1 - E_0} $$\nFor interpolation code $4$ (logarithmic-logarithmic), applicable for positive energies and cross sections, the interpolation is performed on the logarithms:\n$$ \\ln \\sigma(E) = \\ln \\sigma_0 + (\\ln \\sigma_1 - \\ln \\sigma_0) \\frac{\\ln E - \\ln E_0}{\\ln E_1 - \\ln E_0} $$\nThe final cross section is then $\\sigma(E) = \\exp(\\ln \\sigma(E))$.\n\nThird, we compute the discrepancy at each energy $E \\in G$. We calculate the interpolated total cross section, $\\sigma_{\\text{tot}}(E)$, from the section with reaction identifier $\\text{MT}=1$. Concurrently, we calculate the sum of the interpolated partial cross sections, $\\sigma_{\\text{sum}}(E) = \\sum_{j} \\sigma_{j}(E)$, where $j$ ranges over all provided partial reaction channels. The absolute fractional discrepancy $d(E)$ is then quantified using the formula:\n$$ d(E) = \\frac{|\\sigma_{\\text{tot}}(E) - \\sigma_{\\text{sum}}(E)|}{\\max(\\epsilon, \\sigma_{\\text{tot}}(E))} $$\nHere, $\\epsilon = 10^{-12}$ barns is a small constant to prevent division by zero when $\\sigma_{\\text{tot}}(E)$ is very small or zero.\n\nFourth, we analyze the calculated discrepancies to identify the maximum value and its likely cause. We find the maximum discrepancy, $d_{\\max} = \\max_{E \\in G} d(E)$, and the energy at which it occurs, $E^{\\star} = \\arg\\max_{E \\in G} d(E)$. To classify the source, we apply the specified diagnostic rules at $E^{\\star}$ using a threshold value $\\tau = 10^{-8}$ barns:\n1.  **Threshold Misalignment (Code 1)**: This is suspected if the discrepancy is largest where a partial reaction is negligible but the total reaction rate is not. The condition is met if there exists at least one partial reaction $j$ with $\\sigma_j(E^{\\star}) < \\tau$ while the total cross section satisfies $\\sigma_{\\text{tot}}(E^{\\star}) \\ge 10\\tau$.\n2.  **Interpolation Mismatch (Code 2)**: This is the likely cause if different interpolation laws are used and the discrepancy is significant in a region where all reactions are active. This is classified if the threshold condition is not met, the set of interpolation law codes used across all sections contains more than one distinct code, and all cross section values (total and all partials) at $E^{\\star}$ are greater than or equal to $\\tau$.\n3.  **No Likely Issue (Code 0)**: If neither of the above conditions is met, the discrepancy is considered to be within acceptable bounds or of an unclassified nature, and is assigned code $0$.\n\nThis systematic procedure allows for the robust detection and categorization of common inconsistencies in evaluated nuclear data files, which is a critical quality assurance step in preparing data for nuclear reactor simulations.",
            "answer": "[[0.000000,0],[0.095238,1],[0.040851,2]]"
        }
    ]
}