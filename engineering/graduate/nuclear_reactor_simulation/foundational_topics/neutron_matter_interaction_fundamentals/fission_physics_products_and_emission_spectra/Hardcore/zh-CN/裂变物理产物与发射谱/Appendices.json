{
    "hands_on_practices": [
        {
            "introduction": "理解裂变释放的巨大能量如何分配是至关重要的。本练习在一个平均裂变事件中应用能量守恒原理，您将使用一个标准的瞬发中子能谱模型来计算中子带走的平均能量。通过这种能量审计，您将能够把粒子发射的微观物理与裂变过程的宏观能量平衡联系起来 。",
            "id": "4226518",
            "problem": "考虑在反应堆模拟中，一次由热中子诱发的铀-$235$裂变事件。设平均瞬发中子数为 $\\bar{\\nu} = 2.43$。每个发射出的瞬发中子的动能谱由麦克斯韦蒸发概率密度函数 (PDF) 建模\n$$\nf_{n}(E;T) = \\frac{2}{\\sqrt{\\pi}}\\,\\frac{1}{T^{3/2}}\\,\\sqrt{E}\\,\\exp\\!\\left(-\\frac{E}{T}\\right), \\quad E \\ge 0,\n$$\n其温度参数为 $T = 1.32~\\text{MeV}$（此处 $T$ 以能量单位表示，并包含了玻尔兹曼常数）。每次裂变的总质能释放（Q值）为 $Q = 202.36~\\text{MeV}$，裂变碎片的平均总动能为 $E_{F} = 167.4~\\text{MeV}$，平均瞬发伽马射线能量为 $E_{\\gamma} = 6.6~\\text{MeV}$。\n\n从第一性原理以及系综平均和能量守恒的核心定义出发：\n1. 推导由 $f_{n}(E;T)$ 所蕴含的每个瞬发中子的系综平均动能 $\\langle \\epsilon_{n} \\rangle$。\n2. 利用对独立同分布的瞬发中子的系综平均定义和给定的 $\\bar{\\nu}$，求出每次裂变事件的总平均瞬发中子能量。\n3. 应用能量守恒，通过从 $Q$ 中减去碎片动能、总瞬发中子能量和瞬发伽马能量，确定分配给非瞬发道的剩余能量 $E_{\\text{res}}$。\n\n用 $\\text{MeV}$ 表示 $E_{\\text{res}}$ 的最终结果，并四舍五入到四位有效数字。",
            "solution": "经评估，该问题具有科学依据，是良定的，且内部一致。所有提供的数据和物理模型（裂变中子的麦克斯韦谱）在核反应堆物理领域都是标准的。因此，该问题是有效的，可以构建解答。\n\n解题过程遵循问题陈述中列出的三个步骤。\n\n**第1部分：推导每个瞬发中子的系综平均动能 $\\langle \\epsilon_{n} \\rangle$**\n\n瞬发中子的系综平均动能 $\\langle \\epsilon_{n} \\rangle$ 是能量变量 $E$ 关于其概率密度函数 (PDF) $f_{n}(E;T)$ 的期望值。对于分布在 $[0, \\infty)$ 上的连续变量，期望值的定义为：\n$$\n\\langle \\epsilon_{n} \\rangle = \\int_{0}^{\\infty} E \\cdot f_{n}(E;T) \\, dE\n$$\n代入给定的麦克斯韦PDF：\n$$\nf_{n}(E;T) = \\frac{2}{\\sqrt{\\pi}}\\,\\frac{1}{T^{3/2}}\\,\\sqrt{E}\\,\\exp\\!\\left(-\\frac{E}{T}\\right)\n$$\n其中 $T$ 是以能量单位表示的温度参数。平均能量的积分变为：\n$$\n\\langle \\epsilon_{n} \\rangle = \\int_{0}^{\\infty} E \\left( \\frac{2}{\\sqrt{\\pi} \\, T^{3/2}} E^{1/2} \\exp\\!\\left(-\\frac{E}{T}\\right) \\right) dE\n$$\n我们可以合并包含 $E$ 的项，并将常数移到积分号外：\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{2}{\\sqrt{\\pi} \\, T^{3/2}} \\int_{0}^{\\infty} E^{3/2} \\exp\\!\\left(-\\frac{E}{T}\\right) dE\n$$\n为了计算这个积分，我们进行变量替换。令 $x = E/T$。则 $E = xT$ 且 $dE = T dx$。积分上下限仍为 $0$ 到 $\\infty$。将这些代入积分中：\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{2}{\\sqrt{\\pi} \\, T^{3/2}} \\int_{0}^{\\infty} (xT)^{3/2} \\exp(-x) \\, (T \\, dx)\n$$\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{2}{\\sqrt{\\pi} \\, T^{3/2}} \\, T^{3/2} \\, T \\int_{0}^{\\infty} x^{3/2} \\exp(-x) \\, dx\n$$\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{2T}{\\sqrt{\\pi}} \\int_{0}^{\\infty} x^{3/2} \\exp(-x) \\, dx\n$$\n剩余的积分是伽马函数的形式，$\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} \\exp(-t) \\, dt$。在我们的例子中，$x$ 的指数是 $3/2$，所以 $z-1 = 3/2$，这意味着 $z=5/2$。因此，该积分为 $\\Gamma(5/2)$。\n伽马函数具有性质 $\\Gamma(z+1) = z\\Gamma(z)$。我们可以用这个性质来计算 $\\Gamma(5/2)$：\n$$\n\\Gamma(5/2) = \\Gamma(3/2 + 1) = \\frac{3}{2} \\Gamma(3/2) = \\frac{3}{2} \\Gamma(1/2 + 1) = \\frac{3}{2} \\left( \\frac{1}{2} \\Gamma(1/2) \\right)\n$$\n已知 $\\Gamma(1/2) = \\sqrt{\\pi}$，我们有：\n$$\n\\Gamma(5/2) = \\frac{3}{4} \\sqrt{\\pi}\n$$\n将此结果代回 $\\langle \\epsilon_{n} \\rangle$ 的表达式中：\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{2T}{\\sqrt{\\pi}} \\left( \\frac{3\\sqrt{\\pi}}{4} \\right) = \\frac{3}{2}T\n$$\n这就是由麦克斯韦谱描述的中子的平均动能的解析表达式。使用给定的温度参数 $T = 1.32~\\text{MeV}$：\n$$\n\\langle \\epsilon_{n} \\rangle = \\frac{3}{2} (1.32~\\text{MeV}) = 1.98~\\text{MeV}\n$$\n\n**第2部分：计算每次裂变事件的总平均瞬发中子能量**\n\n每次裂变的总平均瞬发中子能量（我们记为 $E_{n, \\text{total}}$）是每次裂变发射的平均瞬发中子数 $\\bar{\\nu}$ 与每个中子的平均动能 $\\langle \\epsilon_{n} \\rangle$ 的乘积。这些中子被视为独立同分布的。\n$$\nE_{n, \\text{total}} = \\bar{\\nu} \\cdot \\langle \\epsilon_{n} \\rangle\n$$\n使用给定的值 $\\bar{\\nu} = 2.43$ 和第1部分的结果：\n$$\nE_{n, \\text{total}} = 2.43 \\times 1.98~\\text{MeV} = 4.8114~\\text{MeV}\n$$\n\n**第3部分：确定剩余能量 $E_{\\text{res}}$**\n\n能量守恒原理规定，裂变事件中释放的总能量，即Q值 ($Q$)，必须被所有产物的能量完全解释。问题指明了主要的瞬发能量组分：裂变碎片的动能 ($E_{F}$)，瞬发中子的总动能 ($E_{n, \\text{total}}$)，以及瞬发伽马射线的总能量 ($E_{\\gamma}$)。剩余的能量是 $E_{\\text{res}}$，它主要包括裂变产物的衰变能（β粒子、反中微子和缓发伽马射线）。\n能量平衡方程为：\n$$\nQ = E_{F} + E_{n, \\text{total}} + E_{\\gamma} + E_{\\text{res}}\n$$\n我们可以解出 $E_{\\text{res}}$：\n$$\nE_{\\text{res}} = Q - E_{F} - E_{n, \\text{total}} - E_{\\gamma}\n$$\n代入给定值和计算值：\n$Q = 202.36~\\text{MeV}$\n$E_{F} = 167.4~\\text{MeV}$\n$E_{n, \\text{total}} = 4.8114~\\text{MeV}$\n$E_{\\gamma} = 6.6~\\text{MeV}$\n$$\nE_{\\text{res}} = 202.36~\\text{MeV} - 167.4~\\text{MeV} - 4.8114~\\text{MeV} - 6.6~\\text{MeV}\n$$\n$$\nE_{\\text{res}} = 202.36~\\text{MeV} - (167.4 + 4.8114 + 6.6)~\\text{MeV}\n$$\n$$\nE_{\\text{res}} = 202.36~\\text{MeV} - 178.8114~\\text{MeV}\n$$\n$$\nE_{\\text{res}} = 23.5486~\\text{MeV}\n$$\n问题要求最终结果四舍五入到四位有效数字。\n$$\nE_{\\text{res}} \\approx 23.55~\\text{MeV}\n$$\n这部分剩余能量解释了未包含在瞬发能量释放中的那些道，例如由不稳定的裂变碎片后续衰变所产生的β粒子和反中微子带走的能量，以及缓发伽马和中子发射的能量。",
            "answer": "$$\\boxed{23.55}$$"
        },
        {
            "introduction": "裂变后，产生的碎片通常是不稳定的，并通过放射性衰变释放更多能量，即所谓的衰变热。本练习将我们的视角从单个事件转移到整个裂变产物库存的集体、随时间演变的行为。您将实现一个计算模型，以追踪反应堆运行期间关键裂变产物的累积，并计算它们在停堆后的总β衰变功率 。",
            "id": "4226484",
            "problem": "您将执行一个简化的、但有科学依据的建模任务，在核反应堆模拟背景下，计算由选定裂变产物的β衰变引起的停堆后衰变热功率。反应堆在指定的辐照时间内以恒定的停堆前热功率运行，产生一组裂变产物，这些产物具有独立的产额、半衰期和平均β衰变能量。在停堆后的指定时间，您将通过对活度求和来计算总β衰变功率。\n\n使用以下基本依据：\n\n- 生产和放射性衰变下的核素数密度演化：对于核素索引$i$，其库存量$N_i(t)$满足线性一阶常微分方程$dN_i/dt = R_f Y_i - \\lambda_i N_i$，其中$R_f$是裂变率，$Y_i$是该核素的每次裂变独立产额，$\\lambda_i$是衰变常数。\n- 活度与库存量之间的放射性衰变关系：$A_i(t) = \\lambda_i N_i(t)$。\n- 停堆前裂变率：$R_f = P_{\\mathrm{th}} / E_f$，其中$P_{\\mathrm{th}}$是热功率，$E_f$是每次裂变释放的能量。\n- 每次β衰变的平均释放能量（仅电子；反中微子能量不进行局部沉积）：为每种核素提供了$E_{\\beta,i}$。\n- 衰变常数：$\\lambda_i = \\ln(2) / t_{1/2,i}$，其中$t_{1/2,i}$是半衰期。\n\n假设在从$t=-T_{\\mathrm{irr}}$到$0$的辐照持续时间$T_{\\mathrm{irr}}$内，反应堆以恒定热功率$P_{\\mathrm{th}}$运行，然后在$t=0$时刻瞬时停堆。忽略中子俘获、超出所提供独立产额的前驱核素累积、γ射线能量沉积和空间效应。通过将活度乘以其平均β能量后求和，计算停堆后$t=1\\,\\mathrm{s}$时的总β衰变功率。\n\n要使用的常数和单位：\n\n- 每次裂变的裂变能：$E_f = 200\\,\\mathrm{MeV}$。\n- 能量单位转换：$1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$，因此$1\\,\\mathrm{MeV} = 1.602176634 \\times 10^{-13}\\,\\mathrm{J}$。\n- 热功率$P_{\\mathrm{th}}$以瓦特为单位，时间以秒为单位，能量以兆电子伏特为单位；最终的衰变热功率以瓦特表示。使用国际单位制（SI）。\n\n使用以下裂变产物的代表性子集（铀-235热裂变的独立产额，平均β能量是每次衰变所发射电子动能的近似平均值）：\n\n- Rubidium-92：独立产额 $Y = 0.060$，半衰期 $t_{1/2} = 4.50\\,\\mathrm{s}$，平均β能量 $E_{\\beta} = 3.50\\,\\mathrm{MeV}$。\n- Yttrium-96：独立产额 $Y = 0.045$，半衰期 $t_{1/2} = 5.35\\,\\mathrm{s}$，平均β能量 $E_{\\beta} = 3.00\\,\\mathrm{MeV}$。\n- Iodine-137：独立产额 $Y = 0.042$，半衰期 $t_{1/2} = 24.00\\,\\mathrm{s}$，平均β能量 $E_{\\beta} = 2.00\\,\\mathrm{MeV}$。\n- Tellurium-135：独立产额 $Y = 0.048$，半衰期 $t_{1/2} = 19.00\\,\\mathrm{s}$，平均β能量 $E_{\\beta} = 2.50\\,\\mathrm{MeV}$。\n- Rubidium-94：独立产额 $Y = 0.030$，半衰期 $t_{1/2} = 2.70\\,\\mathrm{s}$，平均β能量 $E_{\\beta} = 3.80\\,\\mathrm{MeV}$。\n\n您的程序必须实现以下计算流程：\n\n- 计算 $R_f = P_{\\mathrm{th}} / (E_f \\times 1.602176634 \\times 10^{-13}\\,\\mathrm{J/MeV})$。\n- 对每种核素$i$，计算 $\\lambda_i = \\ln(2) / t_{1/2,i}$。\n- 对每种核素$i$，根据上述线性模型，计算在从$t=-T_{\\mathrm{irr}}$到$0$的恒定辐照下，停堆时（$t=0$）的库存量。\n- 在停堆后$t=1\\,\\mathrm{s}$时，计算$A_i(1)$和β功率贡献$P_{\\beta,i}(1) = A_i(1)\\,E_{\\beta,i}$（转换为焦耳/衰变）。\n- 对所有核素求和以获得$P_{\\beta}(1) = \\sum_i P_{\\beta,i}(1)$。\n\n测试套件和要求的最终输出：\n\n为以下五个测试用例实施计算，以确保覆盖典型、短时辐照、近饱和及边缘条件。在所有情况下，均使用停堆后$t = 1\\,\\mathrm{s}$的时间。\n\n- 情况1：$P_{\\mathrm{th}} = 3.0 \\times 10^{9}\\,\\mathrm{W}$，$T_{\\mathrm{irr}} = 1.0 \\times 10^{5}\\,\\mathrm{s}$。\n- 情况2：$P_{\\mathrm{th}} = 1.0 \\times 10^{8}\\,\\mathrm{W}$，$T_{\\mathrm{irr}} = 1.0 \\times 10^{1}\\,\\mathrm{s}$。\n- 情况3：$P_{\\mathrm{th}} = 3.0 \\times 10^{9}\\,\\mathrm{W}$，$T_{\\mathrm{irr}} = 1.0 \\times 10^{6}\\,\\mathrm{s}$。\n- 情况4：$P_{\\mathrm{th}} = 0.0\\,\\mathrm{W}$，$T_{\\mathrm{irr}} = 1.0 \\times 10^{5}\\,\\mathrm{s}$。\n- 情况5：$P_{\\mathrm{th}} = 3.0 \\times 10^{9}\\,\\mathrm{W}$，$T_{\\mathrm{irr}} = 0.0\\,\\mathrm{s}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个条目是相应情况下计算出的衰变热功率$P_{\\beta}(1)$（以瓦特为单位的浮点数，例如$[x_1,x_2,x_3,x_4,x_5]$）。不应打印任何其他文本。",
            "solution": "该问题被评估为具有科学依据、提法恰当且客观。它提供了一套完整且一致的数据、物理模型和约束条件，以确定一个唯一且有意义的解。所用方法将遵循放射性衰变和反应堆物理学的原理。\n\n主要目标是计算反应堆停堆后特定时间$t$的总β衰变功率$P_{\\beta}$。该功率源于一组给定的裂变产物。反应堆已在辐照时间$T_{\\mathrm{irr}}$内以恒定热功率$P_{\\mathrm{th}}$运行。\n\n首先，我们确定停堆前运行期间的恒定裂变率$R_f$。热功率$P_{\\mathrm{th}}$（单位为瓦特，即焦耳/秒）由裂变产生，每次裂变平均释放能量$E_f$（单位为焦耳）。\n每次裂变的能量必须使用给定的转换因子$C_{MeV\\_to\\_J} = 1.602176634 \\times 10^{-13}\\,\\mathrm{J/MeV}$，从兆电子伏特（$MeV$）转换为焦耳（$J$）。\n$$E_f [\\mathrm{J}] = E_f [\\mathrm{MeV}] \\times C_{MeV\\_to\\_J}$$\n裂变率则为：\n$$R_f = \\frac{P_{\\mathrm{th}}}{E_f [\\mathrm{J}]} = \\frac{P_{\\mathrm{th}}}{E_f [\\mathrm{MeV}] \\times C_{MeV\\_to\\_J}}$$\n\n在辐照期间，每种裂变产物核素$i$以恒定速率$R_f Y_i$产生，其中$Y_i$是其独立裂变产额。同时，它会发生放射性衰变。核素$i$的原子数（库存量）$N_i$的演化由以下一阶线性常微分方程描述：\n$$\\frac{dN_i}{dt'} = R_f Y_i - \\lambda_i N_i(t')$$\n其中$\\lambda_i$是衰变常数，通过$\\lambda_i = \\ln(2) / t_{1/2,i}$与半衰期$t_{1/2,i}$相关。我们将辐照期间的时间变量表示为$t'$，其范围从$-T_{\\mathrm{irr}}$到$0$。假设在辐照开始时，每种核素的库存量为零（$N_i(-T_{\\mathrm{irr}}) = 0$），则该微分方程的解为：\n$$N_i(t') = \\frac{R_f Y_i}{\\lambda_i} \\left( 1 - e^{-\\lambda_i (t' + T_{\\mathrm{irr}})} \\right)$$\n在停堆时刻（$t' = 0$），核素$i$的库存量为：\n$$N_i(0) = \\frac{R_f Y_i}{\\lambda_i} \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right)$$\n该项描述了裂变产物的累积过程，对于非常长的辐照时间（$T_{\\mathrm{irr}} \\gg 1/\\lambda_i$），其库存量会接近饱和水平$\\frac{R_f Y_i}{\\lambda_i}$。\n\n在$t=0$停堆后，产生项$R_f Y_i$停止。每种核素$i$的库存量随后仅因放射性衰变而减少，遵循以下方程：\n$$\\frac{dN_i}{dt} = -\\lambda_i N_i(t) \\quad (\\text{for } t > 0)$$\n根据上面确定的初始条件$N_i(0)$，停堆后$t$时刻的库存量解为：\n$$N_i(t) = N_i(0) e^{-\\lambda_i t} = \\frac{R_f Y_i}{\\lambda_i} \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i t}$$\n核素$i$的活度$A_i(t)$，即每秒的衰变次数，定义为$A_i(t) = \\lambda_i N_i(t)$。\n$$A_i(t) = \\lambda_i \\left[ \\frac{R_f Y_i}{\\lambda_i} \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i t} \\right] = R_f Y_i \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i t}$$\n\n核素$i$的每次β衰变平均释放能量$E_{\\beta,i}$。来自核素$i$的功率贡献$P_{\\beta,i}(t)$是其活度与每次衰变释放的能量（转换为瓦特）的乘积。\n$$P_{\\beta,i}(t) [\\mathrm{W}] = A_i(t) [\\mathrm{s}^{-1}] \\times E_{\\beta,i} [\\mathrm{MeV}] \\times C_{MeV\\_to\\_J} [\\mathrm{J/MeV}]$$\n代入$A_i(t)$和$R_f$的表达式：\n$$P_{\\beta,i}(t) = \\left[ \\frac{P_{\\mathrm{th}}}{E_f [\\mathrm{MeV}] \\times C_{MeV\\_to\\_J}} \\right] Y_i \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i t} \\times E_{\\beta,i} [\\mathrm{MeV}] \\times C_{MeV\\_to\\_J}$$\n转换因子$C_{MeV\\_to\\_J}$相互消去，从而得到核素$i$的功率贡献（单位为瓦特）的简化表达式：\n$$P_{\\beta,i}(t) = \\frac{P_{\\mathrm{th}}}{E_f} Y_i E_{\\beta,i} \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i t}$$\n请注意，在此最终表达式中，$E_f$和$E_{\\beta,i}$必须使用相同的单位（如给定的MeV），而$P_{\\mathrm{th}}$必须以瓦特为单位。\n\n停堆后$t = 1\\,\\mathrm{s}$时的总β衰变功率$P_{\\beta}(t)$是所有指定裂变产物贡献的总和：\n$$P_{\\beta}(t=1\\,\\mathrm{s}) = \\sum_i P_{\\beta,i}(t=1\\,\\mathrm{s})$$\n$$P_{\\beta}(t=1\\,\\mathrm{s}) = \\frac{P_{\\mathrm{th}}}{E_f} \\sum_i \\left[ Y_i E_{\\beta,i} \\left( 1 - e^{-\\lambda_i T_{\\mathrm{irr}}} \\right) e^{-\\lambda_i \\cdot 1} \\right]$$\n这个最终公式为计算每个测试用例所需的总衰变功率提供了一个直接的方法。对于$P_{\\mathrm{th}} = 0$或$T_{\\mathrm{irr}} = 0$的边缘情况，该公式正确地计算出结果为$0$。\n\n计算步骤如下：\n1.  定义常数$E_f=200\\,\\mathrm{MeV}$和冷却时间$t=1\\,\\mathrm{s}$。\n2.  对每种核素，计算其衰变常数$\\lambda_i = \\ln(2)/t_{1/2,i}$。\n3.  对每个测试用例（由$P_{\\mathrm{th}}$和$T_{\\mathrm{irr}}$定义）：\n    a. 如果$P_{\\mathrm{th}}$或$T_{\\mathrm{irr}}$为零，结果为$0$。\n    b. 否则，计算求和项$\\sum_i Y_i E_{\\beta,i} (1 - e^{-\\lambda_i T_{\\mathrm{irr}}}) e^{-\\lambda_i t}$。\n    c. 使用最终推导出的公式计算总功率$P_{\\beta}(t)$。\n4.  收集所有测试用例的结果，并按规定格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the post-shutdown beta decay heat power from a set of fission products\n    for several test cases, based on a simplified reactor physics model.\n    \"\"\"\n\n    # --- Constants and Units ---\n    # Energy released per fission in MeV\n    E_FISSION_MEV = 200.0\n    # Time after shutdown for which to calculate the power, in seconds\n    T_COOL = 1.0\n\n    # --- Fission Product Data ---\n    # A dictionary holding the properties for each nuclide.\n    # Y: Independent fission yield (dimensionless)\n    # t_half: Half-life (seconds)\n    # E_beta: Mean beta decay energy (MeV)\n    nuclide_data = {\n        'Rb-92': {'Y': 0.060, 't_half': 4.50, 'E_beta': 3.50},\n        'Y-96':  {'Y': 0.045, 't_half': 5.35, 'E_beta': 3.00},\n        'I-137': {'Y': 0.042, 't_half': 24.00, 'E_beta': 2.00},\n        'Te-135':{'Y': 0.048, 't_half': 19.00, 'E_beta': 2.50},\n        'Rb-94': {'Y': 0.030, 't_half': 2.70, 'E_beta': 3.80}\n    }\n\n    # Pre-calculate decay constants (lambda) for each nuclide\n    for nuclide in nuclide_data.values():\n        nuclide['lambda'] = np.log(2) / nuclide['t_half']\n\n    # --- Test Cases ---\n    # A list of tuples, where each tuple is (P_th_W, T_irr_s)\n    # P_th_W: Pre-shutdown thermal power in Watts\n    # T_irr_s: Irradiation duration in seconds\n    test_cases = [\n        (3.0e9, 1.0e5),\n        (1.0e8, 1.0e1),\n        (3.0e9, 1.0e6),\n        (0.0,   1.0e5),\n        (3.0e9, 0.0),\n    ]\n\n    def calculate_decay_power(P_th_W, T_irr_s):\n        \"\"\"\n        Computes the total beta decay power for a given set of operating conditions.\n\n        Args:\n            P_th_W (float): Pre-shutdown thermal power in Watts.\n            T_irr_s (float): Irradiation time in seconds.\n\n        Returns:\n            float: Total beta decay power in Watts at T_COOL after shutdown.\n        \"\"\"\n        # Handle edge cases where power is zero if P_th or T_irr is zero.\n        if P_th_W == 0.0 or T_irr_s == 0.0:\n            return 0.0\n\n        sum_term = 0.0\n        for nuclide in nuclide_data.values():\n            Y = nuclide['Y']\n            E_beta = nuclide['E_beta']\n            lam = nuclide['lambda']\n            \n            # Buildup term: (1 - exp(-lambda * T_irr))\n            # This factor represents the fraction of saturation inventory reached.\n            buildup_factor = 1.0 - np.exp(-lam * T_irr_s)\n            \n            # Decay term: exp(-lambda * t_cool)\n            # This factor represents the decay of the inventory after shutdown.\n            decay_factor = np.exp(-lam * T_COOL)\n            \n            sum_term += Y * E_beta * buildup_factor * decay_factor\n\n        # Final formula: P_decay = (P_th / E_fission) * sum_term\n        total_decay_power_W = (P_th_W / E_FISSION_MEV) * sum_term\n        \n        return total_decay_power_W\n\n    # --- Main Calculation Loop ---\n    results = []\n    for P_th, T_irr in test_cases:\n        decay_power = calculate_decay_power(P_th, T_irr)\n        results.append(decay_power)\n    \n    # --- Output ---\n    # Format the results into the required string format: [r1,r2,r3,r4,r5]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "先进的反应堆模拟依赖于对裂变事件的详细描述。这项综合性练习将指导您构建一个随机模型，以从第一性原理模拟一个完整的、物理上自洽的裂变事件。您将综合运用多个物理模型，同时严格执行能量、动量、电荷和质量数守恒定律，这代表了高保真裂变模拟的核心方法 。",
            "id": "4226561",
            "problem": "考虑一次铀-235吸收一个热中子形成激发复合核（记作 Uranium-236 star）的瞬发裂变事件。假定在裂变前瞬间，该复合核在质心系中是静止的。您将编写一个程序，随机抽样一个物理上一致的事件实现，产生一系列满足能量、动量、质量数和电荷守恒的物理量 $\\left(A,Z,\\mathrm{TKE},\\nu,E_{n,i},E_{\\gamma,j}\\right)$，并且这些物理量在科学上是合理的，与广为接受的核裂变中瞬发辐射的经验特征相符。\n\n推导的基本依据是：\n\n- 能量守恒：在复合核静止的质心系中，可用于动能和辐射发射的总能量是裂变的 $Q$ 值，$Q = \\left(M_{\\mathrm{in}} - M_{\\mathrm{out}}\\right)c^2$，对于铀-235热中子裂变，普遍观测到其数量级为 $200\\,\\mathrm{MeV}$。可用能量被分配到碎片动能、瞬发中子动能和瞬发伽马射线能量中，满足\n$$\nQ = \\mathrm{TKE} + \\sum_{i=1}^{\\nu} E_{n,i} + \\sum_{j=1}^{N_{\\gamma}} E_{\\gamma,j},\n$$\n其中 $\\mathrm{TKE}$ 是瞬发辐射后两个碎片的总动能 (Total Kinetic Energy, TKE)，$E_{n,i}$ 是 $\\nu$ 个瞬发中子的动能，$E_{\\gamma,j}$ 是 $N_{\\gamma}$ 个瞬发伽马射线的能量。\n\n- 动量守恒：在质心系中，所有末态动量的矢量和必须为零。将碎片动量记为 $\\mathbf{p}_1$ 和 $\\mathbf{p}_2$，中子动量记为 $\\mathbf{p}_{n,i}$，伽马射线动量记为 $\\mathbf{p}_{\\gamma,j}$；则\n$$\n\\mathbf{p}_1 + \\mathbf{p}_2 + \\sum_{i=1}^{\\nu} \\mathbf{p}_{n,i} + \\sum_{j=1}^{N_{\\gamma}} \\mathbf{p}_{\\gamma,j} = \\mathbf{0}.\n$$\n\n- 电荷守恒：碎片电荷之和等于复合核的电荷，\n$$\nZ_1 + Z_2 = Z_{\\mathrm{CN}},\n$$\n并且，根据电荷不变分布 (Unchanged Charge Distribution, UCD) 近似，碎片电荷被分配在平均值 $Z_i \\approx \\left( Z_{\\mathrm{CN}} / A_{\\mathrm{CN}} \\right) A_i$ 附近，四舍五入到最近的整数，并进行校正调整以强制精确的电荷守恒。\n\n- 质量数守恒：质量数满足\n$$\nA_1 + A_2 + \\nu = A_{\\mathrm{CN}},\n$$\n因为每个瞬发中子带走一个单位的质量数且电荷为零。\n\n- 相对论运动学：对于任何静止质量为 $m$、动量大小为 $p$ 的粒子，其动能为\n$$\nK(p,m) = \\sqrt{p^2 c^2 + m^2 c^4} - m c^2,\n$$\n对于给定的动能，其逆关系为\n$$\np(K,m) = \\frac{1}{c} \\sqrt{K^2 + 2 K m c^2}.\n$$\n光子静止质量为零，因此 $p_{\\gamma} = E_{\\gamma} / c$。\n\n您的程序应根据以下规则抽样并构建一个一致的事件，然后验证守恒定律：\n\n- 质心核与常数：\n  - 使用复合核 Uranium-236 star，其特征为 $A_{\\mathrm{CN}} = 236$ 和 $Z_{\\mathrm{CN}} = 92$。\n  - 使用统一原子质量单位 $u$，其 $m_u c^2 = 931.49410242\\,\\mathrm{MeV}$，以及中子静止质量能量 $m_n c^2 = 939.5654133\\,\\mathrm{MeV}$。在 $c = 1$ 的单位制中工作，因此能量单位为 $\\mathrm{MeV}$，动量单位为 $\\mathrm{MeV}/c$，质量单位为 $\\mathrm{MeV}/c^2$。\n\n- 多重数与碎片质量数的抽样：\n  - 从均值为 $\\bar{\\nu}$ 的泊松分布中抽样瞬发中子多重数 $\\nu$；或者，测试用例可以指定一个强制的整数值 $\\nu$。\n  - 从均值为 $\\mu_A$、标准差为 $\\sigma_A$ 的截断正态分布中抽样轻碎片的质量数 $A_1$，限制在物理上合理的整数范围 $\\left[A_{\\min},A_{\\max}\\right]$ 内。将重碎片的质量数设置为 $A_2 = A_{\\mathrm{CN}} - \\nu - A_1$。如果 $A_2$ 落在了 $\\left[A_{\\min},A_{\\max}\\right]$ 之外，则重新抽样 $A_1$，直到获得可接受的 $A_2$ 为止。\n  - 使用电荷不变分布近似分配碎片电荷：$Z_1 = \\mathrm{round}\\left( A_1 Z_{\\mathrm{CN}} / A_{\\mathrm{CN}} \\right)$ 且 $Z_2 = Z_{\\mathrm{CN}} - Z_1$；如果任一 $Z_i$ 落在了物理有效范围 $\\left[1,Z_{\\mathrm{CN}}-1\\right]$ 之外，则向有效范围内调整一个单位，同时保持 $Z_1 + Z_2 = Z_{\\mathrm{CN}}$。\n\n- 发射能量的抽样：\n  - 从温度参数为 $T_n$ 的类麦克斯韦谱中独立抽样 $\\nu$ 个中子动能 $E_{n,i}$，其密度与 $E^{1/2} \\exp(-E/T_n)$ 成正比；等效地，从形状参数为 $k = 3/2$、尺度参数为 $\\theta = T_n$ 的伽马分布中抽样 $E_{n,i}$。\n  - 从均值为 $\\bar{N}_{\\gamma}$ 的泊松分布中抽样瞬发伽马射线多重数 $N_{\\gamma}$，并从均值为 $E_{\\gamma,\\mathrm{mean}}$ 的指数分布中独立抽样 $E_{\\gamma,j}$。\n  - 通过将瞬发辐射后的碎片总动能设置为 $\\mathrm{TKE} = Q - \\sum_i E_{n,i} - \\sum_j E_{\\gamma,j}$ 来强制能量守恒。如果这会导致 $\\mathrm{TKE} \\le 0$，则按比例缩减抽样的辐射能量（如果存在伽马射线能量，则优先缩减；否则缩减中子能量），以使 $0  \\mathrm{TKE} \\ll Q$。所有能量单位均为 $\\mathrm{MeV}$。\n\n- 动量分配：\n  - 对于每个中子，计算动量大小 $p_{n,i} = \\sqrt{E_{n,i}\\left(E_{n,i} + 2 m_n\\right)}$，并在单位球面上抽样一个各向同性的方向以构成 $\\mathbf{p}_{n,i}$。\n  - 对于每个伽马射线，设置 $p_{\\gamma,j} = E_{\\gamma,j}$，并抽样一个各向同性的方向以构成 $\\mathbf{p}_{\\gamma,j}$。\n  - 计算净发射动量矢量 $\\mathbf{P}_{\\mathrm{emit}} = \\sum_i \\mathbf{p}_{n,i} + \\sum_j \\mathbf{p}_{\\gamma,j}$。\n  - 设碎片静止质量为 $m_1 = A_1 m_u$ 和 $m_2 = A_2 m_u$。构建碎片动量 $\\mathbf{p}_1$ 和 $\\mathbf{p}_2$，使得 $\\mathbf{p}_1 + \\mathbf{p}_2 = -\\mathbf{P}_{\\mathrm{emit}}$ 且 $K\\left(\\|\\mathbf{p}_1\\|,m_1\\right) + K\\left(\\|\\mathbf{p}_2\\|,m_2\\right) = \\mathrm{TKE}$。一种稳健的构建方法是选择一个单位矢量 $\\hat{\\mathbf{u}}$：\n    - 如果 $\\|\\mathbf{P}_{\\mathrm{emit}}\\| > 0$，设置 $\\hat{\\mathbf{u}} = -\\mathbf{P}_{\\mathrm{emit}} / \\|\\mathbf{P}_{\\mathrm{emit}}\\|$，并求解一个标量 $s \\ge \\|\\mathbf{P}_{\\mathrm{emit}}\\|$，使得 $K\\left(s,m_1\\right) + K\\left(s - \\|\\mathbf{P}_{\\mathrm{emit}}\\|,m_2\\right) = \\mathrm{TKE}$，然后设置 $\\mathbf{p}_1 = s \\hat{\\mathbf{u}}$ 和 $\\mathbf{p}_2 = -\\left(s - \\|\\mathbf{P}_{\\mathrm{emit}}\\|\\right)\\hat{\\mathbf{u}}$。\n    - 如果 $\\|\\mathbf{P}_{\\mathrm{emit}}\\| = 0$，选择任意固定的 $\\hat{\\mathbf{u}}$（例如，$x$ 轴单位矢量），并求解 $s \\ge 0$，使得 $K\\left(s,m_1\\right) + K\\left(s,m_2\\right) = \\mathrm{TKE}$，然后设置 $\\mathbf{p}_1 = s \\hat{\\mathbf{u}}$ 和 $\\mathbf{p}_2 = -s \\hat{\\mathbf{u}}$。\n\n您的程序必须对每个测试用例执行指定的抽样，然后验证：\n- 电荷守恒：$Z_1 + Z_2 = Z_{\\mathrm{CN}}$ 精确成立。\n- 质量数守恒：$A_1 + A_2 + \\nu = A_{\\mathrm{CN}}$ 精确成立。\n- 能量守恒：$\\left| Q - \\left(\\mathrm{TKE} + \\sum_i E_{n,i} + \\sum_j E_{\\gamma,j} \\right) \\right|$ 小于一个严格的数值容差（使用 $10^{-9}\\,\\mathrm{MeV}$）。\n- 动量守恒：$\\left\\| \\mathbf{p}_1 + \\mathbf{p}_2 + \\sum_i \\mathbf{p}_{n,i} + \\sum_j \\mathbf{p}_{\\gamma,j} \\right\\|$ 小于一个严格的数值容差（使用 $10^{-9}\\,\\mathrm{MeV}/c$）。\n\n物理和数值单位：\n- 所有能量以 $\\mathrm{MeV}$ 表示。\n- 所有动量以 $\\mathrm{MeV}/c$ 表示。\n- 对于任何用于方向抽样的内部角度变量，使用弧度。\n\n测试套件和参数值：\n实现以下四个测试用例，每个用例由参数 $\\left(Q,\\bar{\\nu},\\bar{N}_{\\gamma},T_n,E_{\\gamma,\\mathrm{mean}},\\mu_A,\\sigma_A,A_{\\min},A_{\\max},\\mathrm{seed},\\nu_{\\mathrm{force}}\\right)$ 指定，其中 $\\nu_{\\mathrm{force}}$ 是一个整数或 $\\mathrm{None}$（表示需要抽样）：\n\n1. 案例1（通用理想路径）：$Q = 200.0$, $\\bar{\\nu} = 2.5$, $\\bar{N}_{\\gamma} = 6.0$, $T_n = 1.3$, $E_{\\gamma,\\mathrm{mean}} = 0.85$, $\\mu_A = 96.0$, $\\sigma_A = 5.0$, $A_{\\min} = 70$, $A_{\\max} = 120$, $\\mathrm{seed} = 1234$, $\\nu_{\\mathrm{force}} = \\mathrm{None}$。\n\n2. 案例2（可用能量下边界）：$Q = 170.0$, $\\bar{\\nu} = 2.5$, $\\bar{N}_{\\gamma} = 5.0$, $T_n = 1.2$, $E_{\\gamma,\\mathrm{mean}} = 0.60$, $\\mu_A = 96.0$, $\\sigma_A = 6.0$, $A_{\\min} = 70$, $A_{\\max} = 120$, $\\mathrm{seed} = 5678$, $\\nu_{\\mathrm{force}} = \\mathrm{None}$。\n\n3. 案例3（瞬发中子数为零的边缘情况）：$Q = 210.0$, $\\bar{\\nu} = 2.5$, $\\bar{N}_{\\gamma} = 8.0$, $T_n = 1.3$, $E_{\\gamma,\\mathrm{mean}} = 0.90$, $\\mu_A = 96.0$, $\\sigma_A = 5.0$, $A_{\\min} = 70$, $A_{\\max} = 120$, $\\mathrm{seed} = 42$, $\\nu_{\\mathrm{force}} = 0$。\n\n4. 案例4（可用能量上边界）：$Q = 230.0$, $\\bar{\\nu} = 2.8$, $\\bar{N}_{\\gamma} = 10.0$, $T_n = 1.4$, $E_{\\gamma,\\mathrm{mean}} = 0.95$, $\\mu_A = 97.0$, $\\sigma_A = 5.0$, $A_{\\min} = 70$, $A_{\\max} = 120$, $\\mathrm{seed} = 314159$, $\\nu_{\\mathrm{force}} = \\mathrm{None}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按能量、动量、电荷守恒检查的顺序输出三个布尔值。按顺序汇总所有四个测试用例，得到一个包含 12 个值的列表，例如 $\\left[\\mathrm{e}_1,\\mathrm{m}_1,\\mathrm{c}_1,\\mathrm{e}_2,\\mathrm{m}_2,\\mathrm{c}_2,\\mathrm{e}_3,\\mathrm{m}_3,\\mathrm{c}_3,\\mathrm{e}_4,\\mathrm{m}_4,\\mathrm{c}_4\\right]$。",
            "solution": "问题陈述为一次铀-235瞬发裂变事件的随机模型提供了详细的规范。它要求实现一个程序，为给定的参数集和随机种子生成该事件的单一、物理上一致的实现。该模型必须遵守物理学的基本守恒定律：能量、动量、电荷和质量数守恒。\n\n该问题被评估为**有效**。它在科学上基于核物理的既定原理，问题表述清晰，具有明确的算法流程，并且是客观的，所有量和规则都经过了形式化定义。所描述的模型虽然是对核裂变复杂现实的简化，却是科学模拟中使用的标准唯象学方法。它不包含任何会妨碍对每个测试用例得出严谨且唯一解的科学谬误、矛盾或模糊之处。\n\n解决方案通过逐步实现指定的随机模拟来进行。所有数学量都按要求以 LaTeX 格式呈现。\n\n模拟围绕复合核 $^{236}\\mathrm{U}^*$ 展开，其特征为质量数 $A_{\\mathrm{CN}} = 236$ 和电荷数 $Z_{\\mathrm{CN}} = 92$。使用以下物理常数：中子静止质量能量 $m_n c^2 = 939.5654133\\,\\mathrm{MeV}$ 和统一原子质量单位能量当量 $m_u c^2 = 931.49410242\\,\\mathrm{MeV}$。我们在 $c=1$ 的单位制中工作，因此能量单位为 $\\mathrm{MeV}$，动量单位为 $\\mathrm{MeV}/c$，质量单位为 $\\mathrm{MeV}/c^2$。\n\n对于每个由参数元组 $\\left(Q,\\bar{\\nu},\\bar{N}_{\\gamma},T_n,E_{\\gamma,\\mathrm{mean}},\\mu_A,\\sigma_A,A_{\\min},A_{\\max},\\mathrm{seed},\\nu_{\\mathrm{force}}\\right)$ 定义的测试用例，执行以下操作序列：\n\n1.  **主要事件特征的随机抽样**：\n    *   **中子多重数 ($\\nu$)**：瞬发中子的数量 $\\nu$ 要么取自强制的整数值 $\\nu_{\\mathrm{force}}$，要么从均值为 $\\bar{\\nu}$ 的泊松分布中抽样，即 $\\nu \\sim \\mathrm{Pois}(\\bar{\\nu})$。\n    *   **碎片质量数 ($A_1, A_2$)**：轻碎片的质量数 $A_1$ 从均值为 $\\mu_A$、标准差为 $\\sigma_A$ 的截断正态分布中抽样，并限制在整数范围 $[A_{\\min}, A_{\\max}]$ 内。一个重抽样循环确保由此计算出的重碎片质量数 $A_2 = A_{\\mathrm{CN}} - \\nu - A_1$ 也落在有效范围 $[A_{\\min}, A_{\\max}]$ 内。此过程通过构造保证了质量数守恒：$A_1 + A_2 + \\nu = A_{\\mathrm{CN}}$。\n    *   **碎片电荷 ($Z_1, Z_2$)**：使用电荷不变分布 (UCD) 近似分配碎片电荷。轻碎片的电荷为 $Z_1 = \\mathrm{round}(A_1 Z_{\\mathrm{CN}} / A_{\\mathrm{CN}})$。然后重碎片的电荷为 $Z_2 = Z_{\\mathrm{CN}} - Z_1$，确保电荷守恒。如果 $Z_1$ 或 $Z_2$ 落在了有效范围 $[1, Z_{\\mathrm{CN}}-1]$ 之外，则会进行校正，将其调整到该范围的最近边界，同时保持总和不变。\n\n2.  **发射能量抽样与 TKE 确定**：\n    *   **中子能量 ($E_{n,i}$)**：从类麦克斯韦谱中独立抽样 $\\nu$ 个瞬发中子动能，这等效于从形状参数为 $k = 3/2$、尺度参数（温度）为 $\\theta = T_n$ 的伽马分布中抽样。因此，$E_{n,i} \\sim \\Gamma(k=3/2, \\theta=T_n)$。\n    *   **伽马射线多重数与能量 ($N_{\\gamma}, E_{\\gamma,j}$)**：从均值为 $\\bar{N}_{\\gamma}$ 的泊松分布中抽样瞬发伽马射线的数量 $N_{\\gamma}$。随后，从均值为 $E_{\\gamma,\\mathrm{mean}}$ 的指数分布中独立抽样 $N_{\\gamma}$ 个伽马射线能量。\n    *   **总动能 (TKE)**：两个裂变碎片的总动能 TKE 由能量守恒定律确定：$\\mathrm{TKE} = Q - \\sum_{i=1}^{\\nu} E_{n,i} - \\sum_{j=1}^{N_{\\gamma}} E_{\\gamma,j}$。如果抽样的辐射能量总和超过可用能量 $Q$，导致 $\\mathrm{TKE} \\le 0$，则辐射能量将被缩减。此过程优先减少伽马射线能量。如果所需减少量超过总伽马射线能量，则所有伽马能量都设置为零，剩余的减少量按比例应用于中子能量。这确保最终的 TKE 是一个小的正值。\n\n3.  **动量守恒与末态运动学**：\n    *   **发射物动量 ($\\mathbf{p}_{n,i}, \\mathbf{p}_{\\gamma,j}$)**：为每个发射的粒子构建一个动量矢量。其大小根据动能使用相对论公式 $p(K,m) = \\sqrt{K^2 + 2Km c^2}$（对于中子）或 $p = E/c$（对于伽马射线）计算。方向从单位球面上各向同性地抽样。所有发射动量的矢量和给出了施加给碎片的净反冲动量，$\\mathbf{P}_{\\mathrm{emit}} = \\sum_i \\mathbf{p}_{n,i} + \\sum_j \\mathbf{p}_{\\gamma,j}$。\n    *   **碎片动量 ($\\mathbf{p}_1, \\mathbf{p}_2$)**：为了保持总动量守恒，碎片动量之和必须为 $-\\mathbf{P}_{\\mathrm{emit}}$。碎片在它们自身的质心系中背对背发射，方向沿着 $-\\mathbf{P}_{\\mathrm{emit}}$。TKE 在两个碎片之间的分配通过求解一个关于标量动量大小 $s$ 的非线性方程来确定。令 $m_1 = A_1 m_u$ 和 $m_2 = A_2 m_u$ 为碎片的静止质量（单位为 $\\mathrm{MeV}/c^2$），$P_{\\mathrm{emit}} = \\|\\mathbf{P}_{\\mathrm{emit}}\\|$，则需要求解的方程为 $K(s, m_1) + K(s - P_{\\mathrm{emit}}, m_2) = \\mathrm{TKE}$，其中 $K(p,m)=\\sqrt{p^2c^2+m^2c^4}-mc^2$ 是相对论动能。使用数值求根算法（Brent 方法）来找到 $s$。最终的碎片动量为 $\\mathbf{p}_1 = s \\hat{\\mathbf{u}}$ 和 $\\mathbf{p}_2 = -\\mathbf{P}_{\\mathrm{emit}} - \\mathbf{p}_1$，其中 $\\hat{\\mathbf{u}} = -\\mathbf{P}_{\\mathrm{emit}}/P_{\\mathrm{emit}}$。如果 $P_{\\mathrm{emit}}=0$，方程简化，发射轴 $\\hat{\\mathbf{u}}$ 可任意选择（例如，沿 x 轴）。\n\n4.  **验证**：\n    最后，生成的事件将根据其设计所遵循的物理定律进行检查。\n    *   **电荷守恒**：验证 $Z_1 + Z_2$ 的和是否精确等于 $Z_{\\mathrm{CN}}$。\n    *   **质量数守恒**：验证 $A_1 + A_2 + \\nu$ 的和是否精确等于 $A_{\\mathrm{CN}}$。\n    *   **能量守恒**：将最终的总能量（即最终碎片动能、中子动能和伽马射线能量之和）与初始 $Q$ 值进行比较。绝对差必须小于 $10^{-9}\\,\\mathrm{MeV}$ 的容差。\n    *   **动量守恒**：计算所有末态动量的矢量和 $\\mathbf{p}_1 + \\mathbf{p}_2 + \\mathbf{P}_{\\mathrm{emit}}$。其大小必须小于 $10^{-9}\\,\\mathrm{MeV}/c$ 的容差。\n\n能量、动量和电荷守恒检查的结果（以布尔值形式）被收集起来，用于每个测试用例，并格式化为所需的最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import truncnorm\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to run the fission event simulation for all test cases.\n    \"\"\"\n    # Define physical constants\n    A_CN = 236\n    Z_CN = 92\n    M_U_C2 = 931.49410242  # MeV/c^2\n    M_N_C2 = 939.5654133  # MeV/c^2\n    ENERGY_TOL = 1e-9  # MeV\n    MOMENTUM_TOL = 1e-9 # MeV/c\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Q, nu_bar, N_gamma_bar, T_n, E_gamma_mean, mu_A, sigma_A, A_min, A_max, seed, nu_force)\n        (200.0, 2.5, 6.0, 1.3, 0.85, 96.0, 5.0, 70, 120, 1234, None),\n        (170.0, 2.5, 5.0, 1.2, 0.60, 96.0, 6.0, 70, 120, 5678, None),\n        (210.0, 2.5, 8.0, 1.3, 0.90, 96.0, 5.0, 70, 120, 42, 0),\n        (230.0, 2.8, 10.0, 1.4, 0.95, 97.0, 5.0, 70, 120, 314159, None),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        Q, nu_bar, N_gamma_bar, T_n, E_gamma_mean, mu_A, sigma_A, A_min, A_max, seed, nu_force = params\n        \n        rng = np.random.default_rng(seed)\n\n        # 1. Sample multiplicities and fragment masses\n        if nu_force is not None:\n            nu = nu_force\n        else:\n            nu = rng.poisson(nu_bar)\n\n        while True:\n            # Sample A1 from a truncated normal distribution\n            a, b = (A_min - mu_A) / sigma_A, (A_max - mu_A) / sigma_A\n            A1_float = truncnorm.rvs(a, b, loc=mu_A, scale=sigma_A, random_state=rng)\n            A1 = int(round(A1_float))\n            \n            # Ensure A1 is within integer bounds after rounding\n            if not (A_min <= A1 <= A_max):\n                continue\n\n            A2 = A_CN - A1 - nu\n            if A_min <= A2 <= A_max:\n                break\n        \n        # 2. Assign fragment charges\n        Z1_raw = int(round(A1 * Z_CN / A_CN))\n        Z1 = np.clip(Z1_raw, 1, Z_CN - 1)\n        Z2 = Z_CN - Z1\n        \n        # 3. Sample emission energies\n        E_n = rng.gamma(shape=1.5, scale=T_n, size=nu) if nu > 0 else np.array([])\n        N_gamma = rng.poisson(N_gamma_bar)\n        E_gamma = rng.exponential(scale=E_gamma_mean, size=N_gamma) if N_gamma > 0 else np.array([])\n        \n        # 4. Enforce energy conservation, determine TKE\n        E_n_total = np.sum(E_n)\n        E_gamma_total = np.sum(E_gamma)\n        TKE = Q - (E_n_total + E_gamma_total)\n\n        if TKE <= 0:\n            TKE_target = 1e-6  # Set a small positive target TKE\n            E_rad_total = E_n_total + E_gamma_total\n            E_reduction_needed = E_rad_total - (Q - TKE_target)\n\n            if E_gamma_total > 0 and E_reduction_needed <= E_gamma_total:\n                E_gamma_total_new = E_gamma_total - E_reduction_needed\n                gamma_scale_factor = E_gamma_total_new / E_gamma_total\n                E_gamma *= gamma_scale_factor\n            else:\n                E_reduction_from_gamma = E_gamma_total\n                E_gamma.fill(0.0)\n                E_reduction_still_needed = E_reduction_needed - E_reduction_from_gamma\n                \n                if E_n_total > 0:\n                    E_n_total_new = E_n_total - E_reduction_still_needed\n                    if E_n_total_new > 0:\n                        neutron_scale_factor = E_n_total_new / E_n_total\n                        E_n *= neutron_scale_factor\n                    else: # Failsafe, shouldn't happen with given params\n                        E_n.fill(0)\n\n            # Recalculate totals\n            E_n_total = np.sum(E_n)\n            E_gamma_total = np.sum(E_gamma)\n            TKE = Q - (E_n_total + E_gamma_total)\n        \n        # 5. Momentum assignment\n        def sample_isotropic_direction(rng_gen):\n            phi = rng_gen.uniform(0, 2 * np.pi)\n            cos_theta = rng_gen.uniform(-1, 1)\n            sin_theta = np.sqrt(1 - cos_theta**2)\n            return np.array([sin_theta * np.cos(phi), sin_theta * np.sin(phi), cos_theta])\n\n        # Emission momenta\n        P_emit = np.zeros(3)\n        for e_n in E_n:\n            p_n_mag = np.sqrt(e_n**2 + 2 * e_n * M_N_C2)\n            P_emit += p_n_mag * sample_isotropic_direction(rng)\n        \n        for e_gamma in E_gamma:\n            p_gamma_mag = e_gamma  # c=1\n            P_emit += p_gamma_mag * sample_isotropic_direction(rng)\n        \n        # Fragment momenta\n        m1, m2 = A1 * M_U_C2, A2 * M_U_C2\n        P_emit_mag = np.linalg.norm(P_emit)\n\n        def kinetic_energy_rel(p_mag, mass):\n            return np.sqrt(p_mag**2 + mass**2) - mass\n\n        if P_emit_mag <= 1e-12: # Effectively zero\n            def eqn_to_solve(s):\n                return kinetic_energy_rel(s, m1) + kinetic_energy_rel(s, m2) - TKE\n            s_low = 0.0\n            p_approx_nr = np.sqrt(2 * TKE / (1/m1 + 1/m2)) if TKE > 0 else 0\n            s_high = max(1e-9, 2*p_approx_nr) # Avoid bracket of zero size\n            s_sol = brentq(eqn_to_solve, s_low, s_high)\n            u_hat = np.array([1.0, 0.0, 0.0])\n            p1 = s_sol * u_hat\n            p2 = -s_sol * u_hat\n        else:\n            def eqn_to_solve(s):\n                return kinetic_energy_rel(s, m1) + kinetic_energy_rel(s - P_emit_mag, m2) - TKE\n            s_low = P_emit_mag\n            p_approx_rel_1 = np.sqrt(TKE**2 + 2*TKE*m1) if TKE > 0 else 0\n            s_high = p_approx_rel_1 + P_emit_mag\n            s_sol = brentq(eqn_to_solve, s_low, s_high)\n            u_hat = -P_emit / P_emit_mag\n            p1 = s_sol * u_hat\n            p2 = -(s_sol - P_emit_mag) * u_hat\n        \n        # 6. Verification\n        mass_num_ok = (A1 + A2 + nu) == A_CN\n        charge_ok = (Z1 + Z2) == Z_CN\n\n        TKE_final = kinetic_energy_rel(np.linalg.norm(p1), m1) + kinetic_energy_rel(np.linalg.norm(p2), m2)\n        total_final_energy = TKE_final + np.sum(E_n) + np.sum(E_gamma)\n        energy_ok = abs(Q - total_final_energy) < ENERGY_TOL\n\n        total_final_momentum = p1 + p2 + P_emit\n        momentum_ok = np.linalg.norm(total_final_momentum) < MOMENTUM_TOL\n        \n        # Although mass_num_ok is always true by construction, it's good practice.\n        # The problem only asks for energy, momentum, charge.\n        all_results.extend([energy_ok, momentum_ok, charge_ok])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda b: str(b).lower(), all_results))}]\")\n\nsolve()\n```"
        }
    ]
}