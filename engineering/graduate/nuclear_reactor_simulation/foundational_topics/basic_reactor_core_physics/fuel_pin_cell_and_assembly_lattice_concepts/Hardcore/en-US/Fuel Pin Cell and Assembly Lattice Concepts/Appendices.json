{
    "hands_on_practices": [
        {
            "introduction": "Reactor analysis often begins by simplifying the complex geometry of a fuel pin cell. This exercise tackles a foundational concept in this process: geometric homogenization. You will explore how to represent an annular fuel pellet—a design with a central hole—as a solid, \"smeared\" cylinder while conserving the total amount of fuel, and then consider the neutronic implications of this simplification .",
            "id": "4228069",
            "problem": "A cylindrical fuel pellet in a light water reactor pin cell has a central axial hole of radius $R_{h}$ and an outer fuel radius $R_{f}$, with $R_{h} < R_{f}$. The solid fuel material has a bulk mass density $\\rho_{\\text{bulk}}$ that would be realized if the material filled the entire cylinder without a hole. For neutronics homogenization in an assembly lattice, it is common to replace the annular fuel region by a uniform “smeared” fuel occupying the full radius $R_{f}$, chosen such that the total mass per unit length of fuel is conserved.\n\nStarting from conservation of mass per unit length and fundamental geometric relations for areas of a disk and an annulus, derive the closed-form analytic expression for the effective smeared fuel density $\\rho_{\\text{eff}}$ in terms of $\\rho_{\\text{bulk}}$, $R_{h}$, and $R_{f}$. In your reasoning, explicitly frame the homogenization step as equating the mass per unit length of the actual annulus to that of a uniform disk with density $\\rho_{\\text{eff}}$.\n\nThen, using first principles of neutron transport and macroscopic cross sections, explain qualitatively how replacing the annular fuel by smeared fuel with density $\\rho_{\\text{eff}}$ alters resonance self-shielding in the pin cell when embedded in an assembly lattice, focusing on the role of number density and optical thickness. No numerical evaluation is required for this discussion.\n\nProvide the final answer as a single closed-form analytical expression for $\\rho_{\\text{eff}}$. Do not include units in the final answer box. No rounding is required.",
            "solution": "The problem asks for two parts: first, a derivation of an effective smeared fuel density, $\\rho_{\\text{eff}}$, for an annular fuel pellet; and second, a qualitative explanation of how this homogenization affects resonance self-shielding.\n\nFirst, we address the derivation of the effective smeared fuel density, $\\rho_{\\text{eff}}$. The fundamental principle guiding this homogenization is the conservation of the total mass of fuel per unit length.\n\nLet us consider a section of the fuel pin of unit length. The actual fuel is in the form of an annulus with an inner radius $R_{h}$ and an outer radius $R_{f}$. The fuel material itself has a uniform bulk mass density denoted by $\\rho_{\\text{bulk}}$. The volume of this annular fuel region per unit length is equivalent to its cross-sectional area, $A_{\\text{annulus}}$. The area of an annulus is the area of the outer disk minus the area of the inner disk.\n$$A_{\\text{annulus}} = \\pi R_{f}^{2} - \\pi R_{h}^{2} = \\pi (R_{f}^{2} - R_{h}^{2})$$\nThe mass of the fuel in the annulus per unit length, $m_{\\text{annulus}}$, is the product of its volume per unit length and its density.\n$$m_{\\text{annulus}} = \\rho_{\\text{bulk}} \\times A_{\\text{annulus}} = \\rho_{\\text{bulk}} \\pi (R_{f}^{2} - R_{h}^{2})$$\n\nNext, we consider the homogenized model. In this model, the annular fuel is replaced by a uniform, solid cylindrical disk of fuel with the same outer radius $R_{f}$. The central hole is filled with this \"smeared\" fuel material. This homogenized fuel disk has an effective smeared density $\\rho_{\\text{eff}}$, which we need to determine. The volume of this homogenized fuel disk per unit length is its cross-sectional area, $A_{\\text{smeared}}$.\n$$A_{\\text{smeared}} = \\pi R_{f}^{2}$$\nThe mass of the fuel in this homogenized disk per unit length, $m_{\\text{smeared}}$, is the product of its volume per unit length and its effective density.\n$$m_{\\text{smeared}} = \\rho_{\\text{eff}} \\times A_{\\text{smeared}} = \\rho_{\\text{eff}} \\pi R_{f}^{2}$$\n\nThe core requirement of the homogenization is that the total mass of fuel per unit length is conserved. Therefore, we must equate the mass per unit length of the actual annulus to that of the smeared disk.\n$$m_{\\text{annulus}} = m_{\\text{smeared}}$$\nSubstituting the expressions derived above:\n$$\\rho_{\\text{bulk}} \\pi (R_{f}^{2} - R_{h}^{2}) = \\rho_{\\text{eff}} \\pi R_{f}^{2}$$\nWe can now solve for the effective smeared density, $\\rho_{\\text{eff}}$, by isolating it. The factor of $\\pi$ cancels from both sides.\n$$\\rho_{\\text{eff}} = \\rho_{\\text{bulk}} \\frac{R_{f}^{2} - R_{h}^{2}}{R_{f}^{2}}$$\nThis expression can be simplified to its final form:\n$$\\rho_{\\text{eff}} = \\rho_{\\text{bulk}} \\left(1 - \\frac{R_{h}^{2}}{R_{f}^{2}}\\right) = \\rho_{\\text{bulk}} \\left(1 - \\left(\\frac{R_{h}}{R_{f}}\\right)^{2}\\right)$$\nThis result is physically intuitive. Since the smeared volume is larger than the actual fuel volume, the effective density $\\rho_{\\text{eff}}$ must be less than the bulk material density $\\rho_{\\text{bulk}}$, which is consistent with the factor $\\left(1 - (R_{h}/R_{f})^2\\right)$ being less than $1$ for $R_{h} > 0$.\n\nSecond, we explain qualitatively how this homogenization alters resonance self-shielding. Resonance self-shielding is a critical heterogeneous effect in nuclear reactors. At specific neutron energies known as resonances, the absorption cross section, $\\sigma_{a}$, of fuel isotopes like $^{238}\\text{U}$ becomes extremely large.\n\nIn the actual annular geometry, the fuel material has a high bulk number density, $N_{\\text{bulk}}$, which is directly proportional to the mass density $\\rho_{\\text{bulk}}$. The macroscopic absorption cross section in the fuel, $\\Sigma_{a, \\text{bulk}} = N_{\\text{bulk}} \\sigma_{a}$, is therefore very high at resonance energies. This makes the fuel annulus optically thick. Neutrons entering the fuel from the surrounding moderator or from the central hole are absorbed very near the surface of the fuel region. This creates a significant depression in the neutron flux at these resonance energies within the bulk of the fuel. The nuclei in the interior of the fuel are \"shielded\" from the resonance-energy neutrons by the nuclei at the surface. This reduces the overall effective absorption rate compared to a case where the flux is uniform.\n\nWhen we replace the annular fuel with the smeared model, two key changes occur. First, as we derived, the effective density is reduced: $\\rho_{\\text{eff}} < \\rho_{\\text{bulk}}$. This directly implies that the effective number density of fuel atoms is also reduced: $N_{\\text{eff}} < N_{\\text{bulk}}$. Second, the geometry is changed from a hollow annulus to a solid disk; the central void, which previously allowed neutron streaming, is now filled with a dilute fuel-moderator mixture (in effect).\n\nThe reduction in number density leads to a smaller effective macroscopic cross section, $\\Sigma_{a, \\text{eff}} = N_{\\text{eff}} \\sigma_{a} < \\Sigma_{a, \\text{bulk}}$. A lower macroscopic cross section means the mean free path of neutrons is longer, and the fuel medium becomes more optically transparent. Consequently, the severe flux depression at the fuel surfaces is lessened. Neutrons can penetrate deeper into the fuel region before being absorbed. The homogenization process essentially replaces a strong, spatially localized absorber with a weaker, more diffuse absorber.\n\nBy reducing the optical thickness and smoothing out the material distribution, the homogenization procedure inherently diminishes the self-shielding effect. The model no longer captures the strong surface absorption and internal flux depression characteristic of the heterogeneous system. As a result, the calculated resonance absorption rate in the smeared fuel model will be higher than the actual rate in the annular pin cell, because the model underestimates the self-shielding. From a practical standpoint, reactor analysis codes that use such homogenized models must apply correction factors to account for this underestimation of resonance self-shielding.",
            "answer": "$$\n\\boxed{\\rho_{\\text{bulk}} \\left(1 - \\left(\\frac{R_{h}}{R_{f}}\\right)^{2}\\right)}\n$$"
        },
        {
            "introduction": "After simplifying geometry, the next step in preparing data for reactor core simulators is often simplifying the energy dependence of neutron interactions through group condensation. This computational practice demonstrates how to condense multigroup cross sections from a fine 70-group structure to a broad 2-group structure. You will investigate the critical role of the weighting spectrum by comparing results from an idealized infinite-lattice model with those from a more realistic leakage-adjusted model .",
            "id": "4228080",
            "problem": "You are given fine-energy-group data at the pin-cell resolution that represent a single fuel pin within an assembly lattice in a nuclear reactor simulation. The objective is to condense the fine-group macroscopic reaction data from $G=70$ energy groups down to $2$ groups and to quantify the variance in the resulting condensed group constants when two different weighting spectra are used: an infinite-lattice weighting spectrum and a leakage-adjusted weighting spectrum.\n\nStart from the following fundamental definitions:\n- The reaction rate density in group $g$ for a macroscopic reaction with cross section $\\Sigma_{X,g}$ and scalar flux $\\phi_g$ is $R_{X,g}=\\Sigma_{X,g}\\,\\phi_g$. Here $X$ denotes a particular reaction type, specifically absorption and fission production.\n- A condensed $H$-group macroscopic constant $\\overline{\\Sigma}_{X,H}$ is the unique constant that, when multiplied by a suitably weighted average flux in group $H$, reproduces the total reaction rate integrated over all fine groups that belong to $H$. In a discrete multigroup setting, this is achieved by weighting with a spectrum $w_g$ and enforcing reaction-rate preservation, which leads to the discrete flux-weighted average definition $\\overline{\\Sigma}_{X,H}=\\dfrac{\\sum_{g\\in H}\\Sigma_{X,g}\\,w_g}{\\sum_{g\\in H}w_g}$.\n\nTwo weighting spectra are to be used:\n1. Infinite-lattice weighting, defined by $w_g=\\phi_g$.\n2. Leakage-adjusted weighting, defined by $w_g=\\tilde{\\phi}_g$, where $\\tilde{\\phi}_g=\\max\\left(\\phi_g-\\lambda\\,L_g,\\epsilon\\right)$ with a small positive floor $\\epsilon$ to prevent division by zero and with $L_g$ a leakage spectral estimate. The leakage term models spectral softening or hardening induced by net currents in a finite assembly environment.\n\nPartition the $G=70$ fine groups into $2$ condensed groups as follows:\n- Group $H=1$ (fast/epithermal): indices $g=0,1,\\dots,29$.\n- Group $H=2$ (thermalized): indices $g=30,31,\\dots,69$.\n\nYou are provided synthetic but physically plausible pin-resolved fine-group data via parametric generators for the scalar flux $\\phi_g$, the absorption reaction rate density $R_{a,g}$, and the fission production reaction rate density $R_{p,g}$, together with a leakage spectrum $L_g$. For each test case, the following constructions and parameter values must be used to generate the inputs:\n\nCommon construction for all test cases:\n- Let the group index be $g\\in\\{0,1,\\dots,69\\}$, with $g=0$ the highest-energy group and $g=69$ the lowest-energy (thermal) group.\n- Flux decomposition into an epithermal tail and a thermal peak:\n  $$\\phi_g=\\frac{A}{g+1}+B\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s^2}\\right).$$\n- Absorption macroscopic cross section shape:\n  $$\\Sigma_{a,g}=\\sigma_{a,0}+\\sigma_{a,1}\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s_a^2}\\right)+\\frac{\\sigma_{a,2}}{g+1}.$$\n- Fission production macroscopic term:\n  $$\\nu\\Sigma_{f,g}=\\sigma_{p,0}\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s_f^2}\\right)+\\frac{\\sigma_{p,1}}{\\sqrt{g+1}}.$$\n- Reaction rate densities:\n  $$R_{a,g}=\\Sigma_{a,g}\\,\\phi_g,\\qquad R_{p,g}=\\nu\\Sigma_{f,g}\\,\\phi_g.$$\n- Leakage spectrum estimator (finite-difference magnitude of within-pin spectral gradient):\n  $$L_g=c_{\\ell}\\,\\left|\\phi_g-\\phi_{g+1}\\right|,\\quad\\text{with}\\quad \\phi_{70}\\equiv\\phi_{69}\\ \\text{for the boundary},$$\n  and the leakage-adjustment floor $\\epsilon=10^{-12}$ to preserve numerical stability in all divisions.\n- Units: $\\phi_g$ is in $\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}$, $R_{a,g}$ and $R_{p,g}$ are in $\\text{n}\\,\\text{cm}^{-3}\\,\\text{s}^{-1}$, $\\Sigma_{a,g}$ and $\\nu\\Sigma_{f,g}$ are in $\\text{cm}^{-1}$, and $L_g$ is in $\\text{n}\\,\\text{cm}^{-2}\\,\\text{s}^{-1}$. All condensed macroscopic constants $\\overline{\\Sigma}_{a,H}$ and $\\overline{\\nu\\Sigma}_{f,H}$ are in $\\text{cm}^{-1}$.\n\nDefine the leakage-adjusted spectrum by selecting a nonnegative parameter $\\lambda$ and computing\n$$\\tilde{\\phi}_g=\\max\\left(\\phi_g-\\lambda\\,L_g,\\,\\epsilon\\right).$$\n\nFor each test case, compute the condensed two-group macroscopic absorption and fission production constants using both the infinite-lattice weighting and the leakage-adjusted weighting. Then, for each condensed group $H\\in\\{1,2\\}$ and each reaction type $X\\in\\{a,\\,p\\}$ (where $p$ denotes fission production), compute the variance across the two weighting outcomes,\n$$\\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{X,H}\\right)=\\frac{1}{2}\\sum_{k\\in\\{\\text{inf},\\text{leak}\\}}\\left(\\overline{\\Sigma}_{X,H}^{(k)}-\\overline{\\Sigma}_{X,H}^{\\text{mean}}\\right)^2,\\quad \\overline{\\Sigma}_{X,H}^{\\text{mean}}=\\frac{\\overline{\\Sigma}_{X,H}^{(\\text{inf})}+\\overline{\\Sigma}_{X,H}^{(\\text{leak})}}{2}.$$\nThe variance unit is $\\left(\\text{cm}^{-1}\\right)^2$.\n\nTest suite with three cases that probe different spectral and leakage regimes:\n- Case $1$ (thermalized pin, moderate leakage):\n  - $A=1.0$, $B=5.0$, $g_t=65$, $s=3.0$,\n  - $\\sigma_{a,0}=0.02$, $\\sigma_{a,1}=0.5$, $s_a=5.0$, $\\sigma_{a,2}=0.01$,\n  - $\\sigma_{p,0}=0.7$, $s_f=4.0$, $\\sigma_{p,1}=0.02$,\n  - $c_{\\ell}=1.0$, $\\lambda=0.05$.\n- Case $2$ (harder spectrum pin, stronger leakage):\n  - $A=3.0$, $B=0.5$, $g_t=60$, $s=5.0$,\n  - $\\sigma_{a,0}=0.01$, $\\sigma_{a,1}=0.2$, $s_a=7.0$, $\\sigma_{a,2}=0.03$,\n  - $\\sigma_{p,0}=0.2$, $s_f=6.0$, $\\sigma_{p,1}=0.05$,\n  - $c_{\\ell}=2.0$, $\\lambda=0.10$.\n- Case $3$ (thermalized pin, no leakage adjustment boundary case):\n  - $A=1.0$, $B=5.0$, $g_t=65$, $s=3.0$,\n  - $\\sigma_{a,0}=0.02$, $\\sigma_{a,1}=0.5$, $s_a=5.0$, $\\sigma_{a,2}=0.01$,\n  - $\\sigma_{p,0}=0.7$, $s_f=4.0$, $\\sigma_{p,1}=0.02$,\n  - $c_{\\ell}=1.0$, $\\lambda=0.00$.\n\nYour program must:\n- For each test case, construct the fine-group arrays $\\phi_g$, $\\Sigma_{a,g}$, $\\nu\\Sigma_{f,g}$, $R_{a,g}$, $R_{p,g}$, and $L_g$ using the formulas and parameters above.\n- Compute the condensed two-group macroscopic absorption and fission production constants for both weighting spectra.\n- Compute, for each test case, the four variances $\\left[\\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{a,1}\\right),\\ \\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{a,2}\\right),\\ \\mathrm{Var}\\!\\left(\\overline{\\nu\\Sigma}_{f,1}\\right),\\ \\mathrm{Var}\\!\\left(\\overline{\\nu\\Sigma}_{f,2}\\right)\\right]$ measured in $\\left(\\text{cm}^{-1}\\right)^2$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by test case and within each test case in the order listed above. Concretely, the output must be $$\\left[\\text{case}_1\\ \\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{a,1}\\right),\\ \\text{case}_1\\ \\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{a,2}\\right),\\ \\text{case}_1\\ \\mathrm{Var}\\!\\left(\\overline{\\nu\\Sigma}_{f,1}\\right),\\ \\text{case}_1\\ \\mathrm{Var}\\!\\left(\\overline{\\nu\\Sigma}_{f,2}\\right),\\ \\text{case}_2\\ \\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{a,1}\\right),\\dots,\\ \\text{case}_3\\ \\mathrm{Var}\\!\\left(\\overline{\\nu\\Sigma}_{f,2}\\right)\\right],$$ where each entry is a float in $\\left(\\text{cm}^{-1}\\right)^2$.",
            "solution": "The problem statement has been rigorously validated and is determined to be valid. It is scientifically grounded in the principles of nuclear reactor physics, specifically multigroup neutron transport theory. The problem is well-posed, with all necessary data, formulas, and constraints clearly defined, ensuring a unique and computable solution. The language is objective and the setup is self-consistent and mathematically sound.\n\nThe core task is to perform energy group condensation of macroscopic cross sections, a standard technique in reactor analysis used to reduce computational complexity while preserving essential physics. The fundamental principle is the preservation of reaction rates. The total reaction rate in a coarse energy group $H$ must equal the sum of reaction rates across all fine energy groups $g$ that constitute group $H$.\nGiven a reaction of type $X$, the total reaction rate in coarse group $H$ is $\\sum_{g \\in H} R_{X,g} = \\sum_{g \\in H} \\Sigma_{X,g}\\,\\phi_g$. We seek a condensed cross section $\\overline{\\Sigma}_{X,H}$ such that this rate is reproduced by $\\overline{\\Sigma}_{X,H}\\,\\overline{\\phi}_H$, where $\\overline{\\phi}_H$ is the total flux in group $H$, defined as $\\overline{\\phi}_H = \\sum_{g \\in H} \\phi_g$. Equating these gives:\n$$\n\\overline{\\Sigma}_{X,H} \\left( \\sum_{g \\in H} \\phi_g \\right) = \\sum_{g \\in H} \\Sigma_{X,g}\\,\\phi_g \\implies \\overline{\\Sigma}_{X,H} = \\frac{\\sum_{g \\in H} \\Sigma_{X,g}\\,\\phi_g}{\\sum_{g \\in H} \\phi_g}\n$$\nThis is precisely the formula provided in the problem statement for the case where the weighting spectrum $w_g$ is the scalar flux $\\phi_g$ itself. The problem generalizes this concept by introducing an arbitrary weighting spectrum $w_g$, leading to the discrete flux-weighted average definition:\n$$\n\\overline{\\Sigma}_{X,H} = \\frac{\\sum_{g\\in H}\\Sigma_{X,g}\\,w_g}{\\sum_{g\\in H}w_g}\n$$\nThis calculation must be performed for two different choices of weighting spectrum $w_g$:\n1.  **Infinite-lattice weighting**: $w_g = \\phi_g$. This spectrum is characteristic of the neutronic environment in a conceptually infinite, periodic lattice of fuel pins, far from any boundaries or material discontinuities.\n2.  **Leakage-adjusted weighting**: $w_g = \\tilde{\\phi}_g = \\max(\\phi_g - \\lambda L_g, \\epsilon)$. This spectrum is a modification of the infinite-lattice flux, designed to approximate the effects of neutron leakage (net current) in a finite-sized fuel assembly. The parameter $\\lambda$ controls the magnitude of this adjustment, and the floor $\\epsilon$ ensures numerical stability.\n\nThe solution is obtained by following a direct computational procedure for each of the three test cases provided.\n\n**Step 1: Generation of Fine-Group Data**\nFor each test case, we first generate the necessary $G=70$ fine-group neutronic data. The group indices range from $g=0$ to $g=69$.\nThe scalar flux $\\phi_g$, absorption cross section $\\Sigma_{a,g}$, and fission production term $\\nu\\Sigma_{f,g}$ are computed using the given parametric formulas and the specific parameters for the case:\n$$\n\\phi_g = \\frac{A}{g+1} + B\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s^2}\\right)\n$$\n$$\n\\Sigma_{a,g} = \\sigma_{a,0} + \\sigma_{a,1}\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s_a^2}\\right) + \\frac{\\sigma_{a,2}}{g+1}\n$$\n$$\n\\nu\\Sigma_{f,g} = \\sigma_{p,0}\\,\\exp\\!\\left(-\\frac{(g-g_t)^2}{2\\,s_f^2}\\right) + \\frac{\\sigma_{p,1}}{\\sqrt{g+1}}\n$$\nThe leakage spectrum estimator $L_g$ is calculated as the magnitude of a finite difference of the flux spectrum. For $g \\in \\{0, 1, \\dots, 68\\}$, $L_g = c_{\\ell}|\\phi_g - \\phi_{g+1}|$. For the boundary group $g=69$, the problem specifies $\\phi_{70} \\equiv \\phi_{69}$, which implies $L_{69} = c_{\\ell}|\\phi_{69} - \\phi_{69}| = 0$. The requested reaction rates $R_{a,g}=\\Sigma_{a,g}\\phi_g$ and $R_{p,g}=\\nu\\Sigma_{f,g}\\phi_g$ are also constructed.\n\n**Step 2: Group Condensation**\nThe $70$ fine groups are partitioned into $2$ coarse groups: Group $H=1$ (fast/epithermal, $g \\in \\{0, \\dots, 29\\}$) and Group $H=2$ (thermal, $g \\in \\{30, \\dots, 69\\}$). For each reaction type ($X=a$ for absorption, $X=p$ for fission production) and for each coarse group ($H=1, 2$), we compute the condensed constant using both weighting schemes.\n\nFor the **infinite-lattice weighting**, we use $w_g = \\phi_g$. The condensed cross section for absorption in Group $1$, for example, is:\n$$\n\\overline{\\Sigma}_{a,1}^{(\\text{inf})} = \\frac{\\sum_{g=0}^{29} \\Sigma_{a,g}\\,\\phi_g}{\\sum_{g=0}^{29} \\phi_g}\n$$\nThe other three constants, $\\overline{\\Sigma}_{a,2}^{(\\text{inf})}$, $\\overline{\\nu\\Sigma}_{f,1}^{(\\text{inf})}$, and $\\overline{\\nu\\Sigma}_{f,2}^{(\\text{inf})}$, are calculated analogously by applying the formula to the appropriate cross section data and group indices.\n\nFor the **leakage-adjusted weighting**, we first compute the weighting spectrum $w_g = \\tilde{\\phi}_g = \\max(\\phi_g - \\lambda L_g, \\epsilon)$, where $\\epsilon = 10^{-12}$. The condensed cross section for absorption in Group $1$ is then:\n$$\n\\overline{\\Sigma}_{a,1}^{(\\text{leak})} = \\frac{\\sum_{g=0}^{29} \\Sigma_{a,g}\\,\\tilde{\\phi}_g}{\\sum_{g=0}^{29} \\tilde{\\phi}_g}\n$$\nSimilarly, we compute $\\overline{\\Sigma}_{a,2}^{(\\text{leak})}$, $\\overline{\\nu\\Sigma}_{f,1}^{(\\text{leak})}$, and $\\overline{\\nu\\Sigma}_{f,2}^{(\\text{leak})}$.\n\n**Step 3: Variance Calculation**\nThe final step is to quantify the difference between the results from the two weighting schemes. For each pair of condensed constants ($\\overline{\\Sigma}_{X,H}^{(\\text{inf})}$ and $\\overline{\\Sigma}_{X,H}^{(\\text{leak})}$), the variance is computed. The provided formula, $\\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{X,H}\\right)=\\frac{1}{2}\\sum_{k}\\left(\\overline{\\Sigma}_{X,H}^{(k)}-\\overline{\\Sigma}_{X,H}^{\\text{mean}}\\right)^2$, simplifies for a population of two to the squared semi-difference:\n$$\n\\mathrm{Var}\\!\\left(\\overline{\\Sigma}_{X,H}\\right) = \\left( \\frac{\\overline{\\Sigma}_{X,H}^{(\\text{inf})} - \\overline{\\Sigma}_{X,H}^{(\\text{leak})}}{2} \\right)^2\n$$\nThis calculation is performed for all four pairs of constants ($X \\in \\{a, p\\}$, $H \\in \\{1, 2\\}$) for each of the three test cases. For Case $3$, where the leakage adjustment parameter $\\lambda=0$, the leakage-adjusted spectrum $\\tilde{\\phi}_g$ becomes identical to the infinite-lattice flux $\\phi_g$ (as $\\phi_g \\gg \\epsilon$), leading to the expectation that $\\overline{\\Sigma}_{X,H}^{(\\text{inf})} = \\overline{\\Sigma}_{X,H}^{(\\text{leak})}$ and all resulting variances are zero. This serves as an important validation check for the numerical implementation.\n\nThe entire procedure is implemented using Python with the `numpy` library, which is well-suited for the required vectorized numerical computations. The results for the three test cases are aggregated into a single list as per the output format requirements.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the group condensation problem for three test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: thermalized pin, moderate leakage\n        {\n            \"A\": 1.0, \"B\": 5.0, \"g_t\": 65.0, \"s\": 3.0,\n            \"sigma_a_0\": 0.02, \"sigma_a_1\": 0.5, \"s_a\": 5.0, \"sigma_a_2\": 0.01,\n            \"sigma_p_0\": 0.7, \"s_f\": 4.0, \"sigma_p_1\": 0.02,\n            \"c_l\": 1.0, \"lambda\": 0.05\n        },\n        # Case 2: harder spectrum pin, stronger leakage\n        {\n            \"A\": 3.0, \"B\": 0.5, \"g_t\": 60.0, \"s\": 5.0,\n            \"sigma_a_0\": 0.01, \"sigma_a_1\": 0.2, \"s_a\": 7.0, \"sigma_a_2\": 0.03,\n            \"sigma_p_0\": 0.2, \"s_f\": 6.0, \"sigma_p_1\": 0.05,\n            \"c_l\": 2.0, \"lambda\": 0.10\n        },\n        # Case 3: thermalized pin, no leakage adjustment\n        {\n            \"A\": 1.0, \"B\": 5.0, \"g_t\": 65.0, \"s\": 3.0,\n            \"sigma_a_0\": 0.02, \"sigma_a_1\": 0.5, \"s_a\": 5.0, \"sigma_a_2\": 0.01,\n            \"sigma_p_0\": 0.7, \"s_f\": 4.0, \"sigma_p_1\": 0.02,\n            \"c_l\": 1.0, \"lambda\": 0.00\n        }\n    ]\n\n    epsilon = 1.0e-12\n    num_groups = 70\n    g = np.arange(num_groups, dtype=np.float64)\n\n    group1_indices = slice(0, 30)\n    group2_indices = slice(30, num_groups)\n\n    all_results = []\n\n    for params in test_cases:\n        # Step 1: Generate fine-group data\n        phi_g = (params[\"A\"] / (g + 1.0) +\n                 params[\"B\"] * np.exp(-(g - params[\"g_t\"])**2 / (2.0 * params[\"s\"]**2)))\n\n        Sigma_a_g = (params[\"sigma_a_0\"] +\n                     params[\"sigma_a_1\"] * np.exp(-(g - params[\"g_t\"])**2 / (2.0 * params[\"s_a\"]**2)) +\n                     params[\"sigma_a_2\"] / (g + 1.0))\n\n        nuSigma_f_g = (params[\"sigma_p_0\"] * np.exp(-(g - params[\"g_t\"])**2 / (2.0 * params[\"s_f\"]**2)) +\n                       params[\"sigma_p_1\"] / np.sqrt(g + 1.0))\n\n        # These are requested but not used in the final variance calculation\n        # R_a_g = Sigma_a_g * phi_g\n        # R_p_g = nuSigma_f_g * phi_g\n\n        # Calculate L_g with boundary condition phi_70 = phi_69\n        phi_g_plus_1 = np.append(phi_g[1:], phi_g[-1])\n        L_g = params[\"c_l\"] * np.abs(phi_g - phi_g_plus_1)\n\n        # Step 2: Group Condensation\n        # Define weighting spectra\n        w_inf = phi_g\n        w_leak = np.maximum(phi_g - params[\"lambda\"] * L_g, epsilon)\n\n        def condense(sigma_fine, weight_fine, group_slice):\n            \"\"\"Performs group condensation for a single coarse group.\"\"\"\n            numerator = np.sum(sigma_fine[group_slice] * weight_fine[group_slice])\n            denominator = np.sum(weight_fine[group_slice])\n            return numerator / denominator if denominator != 0.0 else 0.0\n\n        # Condense using infinite-lattice weighting\n        Sigma_a1_inf = condense(Sigma_a_g, w_inf, group1_indices)\n        Sigma_a2_inf = condense(Sigma_a_g, w_inf, group2_indices)\n        nuSigma_f1_inf = condense(nuSigma_f_g, w_inf, group1_indices)\n        nuSigma_f2_inf = condense(nuSigma_f_g, w_inf, group2_indices)\n\n        # Condense using leakage-adjusted weighting\n        Sigma_a1_leak = condense(Sigma_a_g, w_leak, group1_indices)\n        Sigma_a2_leak = condense(Sigma_a_g, w_leak, group2_indices)\n        nuSigma_f1_leak = condense(nuSigma_f_g, w_leak, group1_indices)\n        nuSigma_f2_leak = condense(nuSigma_f_g, w_leak, group2_indices)\n\n        # Step 3: Variance Calculation\n        def calculate_variance(val_inf, val_leak):\n            \"\"\"Calculates variance for a population of two values.\"\"\"\n            return ((val_inf - val_leak) / 2.0)**2\n\n        var_a1 = calculate_variance(Sigma_a1_inf, Sigma_a1_leak)\n        var_a2 = calculate_variance(Sigma_a2_inf, Sigma_a2_leak)\n        var_p1 = calculate_variance(nuSigma_f1_inf, nuSigma_f1_leak)\n        var_p2 = calculate_variance(nuSigma_f2_inf, nuSigma_f2_leak)\n\n        all_results.extend([var_a1, var_a2, var_p1, var_p2])\n\n    # Final print statement in the exact required format.\n    # Using scientific notation to handle potentially very small numbers.\n    print(f\"[{','.join(f'{r:.12e}' for r in all_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Homogenized cross sections are typically generated assuming an infinite, perfectly repeating lattice, but real reactor cores are finite and leak neutrons. This practice confronts the calculational bias that arises from this idealization, a critical issue in reactor simulation. You will implement a simplified diffusion model to quantify the error in the effective multiplication factor, $k_{\\text{eff}}$, and then apply two common correction techniques to reconcile the simplified model with the physical reality of a finite system .",
            "id": "4228084",
            "problem": "You are asked to implement and analyze a simplified single-region, one-group diffusion model to quantify the bias introduced in the effective neutron multiplication factor $k_{\\text{eff}}$ when homogenized cross sections are generated using an infinite lattice spectrum but then applied to a finite core with leakage. You must also implement two correction strategies: Superhomogenization (SPH) scaling and an albedo-adjusted weighting model.\n\nUse the following fundamental basis. The steady-state one-group diffusion equation in a homogeneous medium can be written as\n$$\n\\nabla \\cdot \\left( D \\nabla \\phi \\right) + \\Sigma_a \\phi = \\frac{\\nu \\Sigma_f}{k_{\\text{eff}}} \\phi,\n$$\nwhere $D$ is the diffusion coefficient in $\\text{cm}$, $\\Sigma_a$ is the macroscopic absorption cross section in $\\text{cm}^{-1}$, $\\nu \\Sigma_f$ is the production cross section in $\\text{cm}^{-1}$, and $\\phi$ is the neutron scalar flux. In an infinite homogeneous medium, the geometric buckling $B^2$ is zero, and the infinite multiplication factor is\n$$\nk_{\\infty} = \\frac{\\nu \\Sigma_f}{\\Sigma_a}.\n$$\nFor a finite homogeneous core whose flux shape yields a geometric buckling $B^2$ (in $\\text{cm}^{-2}$), the one-speed non-leakage probability is approximated by\n$$\nP_{\\text{NL}} = \\frac{1}{1 + B^2 L^2},\n$$\nwith the diffusion length $L^2 = \\frac{D}{\\Sigma_a}$ expressed in $\\text{cm}^2$. Consequently,\n$$\nk_{\\text{eff}} = k_{\\infty} P_{\\text{NL}} = \\frac{\\nu \\Sigma_f / \\Sigma_a}{1 + B^2 \\frac{D}{\\Sigma_a}}.\n$$\n\nIn practice, when homogenized cross sections are generated using an infinite lattice spectrum, they neglect leakage-induced spectral shifts present in a finite core. This produces a calculational bias in $k_{\\text{eff}}$ when such cross sections are used in finite-core diffusion calculations. To assess this bias, you are provided with a parametrized reference value $k_{\\text{true}}$ that emulates a more accurate calculation (e.g., transport or multi-group) by enhancing the leakage effect with a factor $\\beta > 1$:\n$$\nk_{\\text{true}} = \\frac{k_{\\infty}}{1 + \\beta B^2 L^2}.\n$$\n\nYou must implement two correction strategies:\n\n1. Superhomogenization (SPH) scaling: Scale both $\\Sigma_a$ and $\\nu \\Sigma_f$ by the same factor $s$ (dimensionless), leaving $D$ unchanged. This preserves $k_{\\infty}$ but modifies $L^2$ to $L^2_s = \\frac{D}{\\Sigma_a s}$, yielding\n$$\nk_{\\text{eff}}^{\\text{SPH}} = \\frac{k_{\\infty}}{1 + B^2 \\frac{D}{\\Sigma_a s}}.\n$$\nChoose $s$ such that $k_{\\text{eff}}^{\\text{SPH}} = k_{\\text{true}}$.\n\n2. Albedo-adjusted weighting: Introduce a boundary albedo $a \\in [0,1]$ (dimensionless), which represents the fraction of outgoing neutron current that is reflected back into the system. Assume a first-order perturbative dependence of homogenized cross sections on the leakage fraction $(1-a)$ via coefficients $\\gamma_a \\ge 0$ and $\\gamma_f \\ge 0$ (dimensionless), producing adjusted cross sections\n$$\n\\Sigma_a^{\\text{alb}} = \\Sigma_a \\left(1 + \\gamma_a (1-a) \\right), \\quad \\nu \\Sigma_f^{\\text{alb}} = \\nu \\Sigma_f \\left(1 - \\gamma_f (1-a) \\right).\n$$\nUse these adjusted cross sections to compute\n$$\nk_{\\text{eff}}^{\\text{alb}} = \\frac{\\nu \\Sigma_f^{\\text{alb}} / \\Sigma_a^{\\text{alb}}}{1 + B^2 \\frac{D}{\\Sigma_a^{\\text{alb}}}}.\n$$\n\nFor each test case, compute:\n- The calculational $k_{\\text{eff}}$ using infinite-lattice cross sections applied to the finite core, denoted $k_{\\text{calc}}$.\n- The bias $\\Delta k = k_{\\text{calc}} - k_{\\text{true}}$.\n- The SPH scaling factor $s$ and the corrected $k_{\\text{eff}}^{\\text{SPH}}$.\n- The albedo-adjusted corrected $k_{\\text{eff}}^{\\text{alb}}$ and its residual error $\\Delta k_{\\text{alb}} = k_{\\text{eff}}^{\\text{alb}} - k_{\\text{true}}$.\n\nUnits:\n- $\\Sigma_a$ in $\\text{cm}^{-1}$.\n- $\\nu \\Sigma_f$ in $\\text{cm}^{-1}$.\n- $D$ in $\\text{cm}$.\n- $B^2$ in $\\text{cm}^{-2}$.\n- $k_{\\text{eff}}$ is dimensionless.\n- $a$, $\\beta$, $\\gamma_a$, and $\\gamma_f$ are dimensionless.\n\nAngle units are not applicable. All ratio outputs must be decimal numbers. Express numerical results as floating-point decimals.\n\nTest suite:\n- Case $1$ (happy path): $\\Sigma_a = 0.08 \\,\\text{cm}^{-1}$, $\\nu \\Sigma_f = 0.10 \\,\\text{cm}^{-1}$, $D = 1.2 \\,\\text{cm}$, $B^2 = 0.00044 \\,\\text{cm}^{-2}$, $a = 0.70$, $\\beta = 1.10$, $\\gamma_a = 0.02$, $\\gamma_f = 0.015$.\n- Case $2$ (strong leakage, vacuum boundary): $\\Sigma_a = 0.10 \\,\\text{cm}^{-1}$, $\\nu \\Sigma_f = 0.115 \\,\\text{cm}^{-1}$, $D = 1.0 \\,\\text{cm}$, $B^2 = 0.00090 \\,\\text{cm}^{-2}$, $a = 0.00$, $\\beta = 1.20$, $\\gamma_a = 0.02$, $\\gamma_f = 0.015$.\n- Case $3$ (near-critical infinite medium, weak leakage): $\\Sigma_a = 0.095 \\,\\text{cm}^{-1}$, $\\nu \\Sigma_f = 0.095 \\,\\text{cm}^{-1}$, $D = 1.0 \\,\\text{cm}$, $B^2 = 0.00020 \\,\\text{cm}^{-2}$, $a = 0.90$, $\\beta = 1.05$, $\\gamma_a = 0.01$, $\\gamma_f = 0.005$.\n\nProgram requirements:\n- Implement the calculations exactly as described above for all test cases.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list in the order $[k_{\\text{calc}}, \\Delta k, k_{\\text{eff}}^{\\text{SPH}}, s, k_{\\text{eff}}^{\\text{alb}}, \\Delta k_{\\text{alb}}]$.",
            "solution": "The user has provided a valid problem statement.\n\nThe problem requires a quantitative analysis of the calculational bias in the effective neutron multiplication factor, $k_{\\text{eff}}$, that arises when homogenized cross sections from an infinite lattice model are applied to a finite reactor core. The analysis is based on the one-group, one-region neutron diffusion equation. Furthermore, two methods for correcting this bias are to be implemented and evaluated: Superhomogenization (SPH) and an albedo-adjusted cross-section model.\n\nThe fundamental model is the steady-state one-group diffusion equation in a homogeneous medium:\n$$\n\\nabla \\cdot \\left( D \\nabla \\phi \\right) + \\Sigma_a \\phi = \\frac{\\nu \\Sigma_f}{k_{\\text{eff}}} \\phi\n$$\nBy applying the buckling approximation, $\\nabla^2\\phi = -B^2\\phi$, this can be rewritten as the characteristic equation:\n$$\n-D B^2 \\phi + \\Sigma_a \\phi = \\frac{\\nu \\Sigma_f}{k_{\\text{eff}}} \\phi\n$$\nSolving for $k_{\\text{eff}}$ and rearranging yields the standard expression for a finite core:\n$$\nk_{\\text{eff}} = \\frac{\\nu \\Sigma_f}{\\Sigma_a + D B^2} = \\frac{\\nu \\Sigma_f / \\Sigma_a}{1 + B^2 (D/\\Sigma_a)}\n$$\nThis can be expressed in terms of the infinite multiplication factor, $k_{\\infty} = \\frac{\\nu \\Sigma_f}{\\Sigma_a}$, and the non-leakage probability, $P_{\\text{NL}} = \\frac{1}{1+B^2 L^2}$, where $L^2 = \\frac{D}{\\Sigma_a}$ is the squared diffusion length. Thus, $k_{\\text{eff}} = k_{\\infty} P_{\\text{NL}}$.\n\nThe computational procedure for each test case is as follows:\n\n1.  **Base Calculation and Bias Assessment**:\n    First, we calculate the naive or `calculational` $k_{\\text{eff}}$, denoted $k_{\\text{calc}}$, using the provided infinite-lattice cross sections ($\\Sigma_a$, $\\nu \\Sigma_f$) and diffusion coefficient ($D$) applied to the finite core geometry represented by the buckling $B^2$.\n    $$\n    k_{\\text{calc}} = \\frac{\\nu \\Sigma_f / \\Sigma_a}{1 + B^2 \\frac{D}{\\Sigma_a}}\n    $$\n    The problem provides a reference or `true` value, $k_{\\text{true}}$, which models the physical effect of leakage-induced spectrum hardening by enhancing the leakage term with a factor $\\beta > 1$. This hardening typically increases the effective diffusion length and alters reaction rates, phenomena not captured by the one-group infinite-lattice model.\n    $$\n    k_{\\text{true}} = \\frac{k_{\\infty}}{1 + \\beta B^2 L^2} = \\frac{\\nu \\Sigma_f / \\Sigma_a}{1 + \\beta B^2 \\frac{D}{\\Sigma_a}}\n    $$\n    The calculational bias is then the direct difference:\n    $$\n    \\Delta k = k_{\\text{calc}} - k_{\\text{true}}\n    $$\n    A positive $\\Delta k$ indicates that the uncorrected model overestimates the core's reactivity by underestimating neutron leakage.\n\n2.  **Superhomogenization (SPH) Correction**:\n    The SPH method seeks to correct the diffusion parameters such that the simplified diffusion calculation reproduces a known high-fidelity result, in this case $k_{\\text{true}}$. Here, we scale the absorption and production cross sections by a factor $s$, leaving $D$ unchanged. The corrected effective multiplication factor is:\n    $$\n    k_{\\text{eff}}^{\\text{SPH}} = \\frac{(\\nu \\Sigma_f s) / (\\Sigma_a s)}{1 + B^2 \\frac{D}{\\Sigma_a s}} = \\frac{k_{\\infty}}{1 + \\frac{B^2 L^2}{s}}\n    $$\n    Note that $k_{\\infty}$ is invariant under this scaling. We find $s$ by enforcing the condition $k_{\\text{eff}}^{\\text{SPH}} = k_{\\text{true}}$:\n    $$\n    \\frac{k_{\\infty}}{1 + \\frac{B^2 L^2}{s}} = \\frac{k_{\\infty}}{1 + \\beta B^2 L^2}\n    $$\n    This implies $1 + \\frac{B^2 L^2}{s} = 1 + \\beta B^2 L^2$, which, for $B^2 \\neq 0$ and $L^2 \\neq 0$, simplifies to $\\frac{1}{s} = \\beta$, or $s = \\frac{1}{\\beta}$.\n    Since $\\beta > 1$ (to model enhanced leakage), the SPH factor $s$ will be less than $1$. This correctly scales up the leakage term $\\frac{B^2 L^2}{s}$ to match the enhanced leakage in the reference model. We explicitly calculate $k_{\\text{eff}}^{\\text{SPH}}$ using this value of $s$ to confirm it equates to $k_{\\text{true}}$.\n\n3.  **Albedo-Adjusted Weighting Correction**:\n    This method introduces a phenomenological correction to the cross sections based on the boundary albedo, $a$. The albedo quantifies the fraction of neutrons reflected at the core boundary, so the leakage fraction is proportional to $(1-a)$. The cross sections are adjusted as follows:\n    $$\n    \\Sigma_a^{\\text{alb}} = \\Sigma_a \\left(1 + \\gamma_a (1-a) \\right)\n    $$\n    $$\n    \\nu \\Sigma_f^{\\text{alb}} = \\nu \\Sigma_f \\left(1 - \\gamma_f (1-a) \\right)\n    $$\n    Here, $\\gamma_a$ and $\\gamma_f$ are non-negative empirical coefficients. This model captures the physical trend that increased leakage (lower $a$) hardens the neutron spectrum, which tends to increase $\\Sigma_a$ (due to moving above thermal absorption resonances) and decrease $\\nu \\Sigma_f$ (due to moving to less fissile energy regions for some isotopes). The corrected $k_{\\text{eff}}$ is then computed using these adjusted cross sections:\n    $$\n    k_{\\text{eff}}^{\\text{alb}} = \\frac{\\nu \\Sigma_f^{\\text{alb}} / \\Sigma_a^{\\text{alb}}}{1 + B^2 \\frac{D}{\\Sigma_a^{\\text{alb}}}}\n    $$\n    The performance of this model is evaluated by its residual error relative to the reference value:\n    $$\n    \\Delta k_{\\text{alb}} = k_{\\text{eff}}^{\\text{alb}} - k_{\\text{true}}\n    $$\n    A small residual error indicates that this physically-motivated, albedo-based correction is a good approximation for the complex leakage effects modeled by the $\\beta$ factor.\n\nThe implementation will process each test case by sequentially applying these formulas to compute the six required quantities: $k_{\\text{calc}}$, $\\Delta k$, $k_{\\text{eff}}^{\\text{SPH}}$, $s$, $k_{\\text{eff}}^{\\text{alb}}$, and $\\Delta k_{\\text{alb}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Implements and analyzes a single-region, one-group diffusion model to quantify\n    and correct the bias in k_eff from using infinite-lattice cross sections.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Sa, nuSf, D, B2, a, beta, gamma_a, gamma_f)\n        (0.08, 0.10, 1.2, 0.00044, 0.70, 1.10, 0.02, 0.015),\n        (0.10, 0.115, 1.0, 0.00090, 0.00, 1.20, 0.02, 0.015),\n        (0.095, 0.095, 1.0, 0.00020, 0.90, 1.05, 0.01, 0.005),\n    ]\n\n    results = []\n    for case in test_cases:\n        Sigma_a, nuSigma_f, D, B2, a, beta, gamma_a, gamma_f = case\n\n        # --- Intermediate Quantities ---\n        # Infinite multiplication factor\n        k_inf = nuSigma_f / Sigma_a\n        # Squared diffusion length\n        L2 = D / Sigma_a\n\n        # --- Base Calculation and Bias Assessment ---\n        \n        # 1. Calculational k_eff using infinite-lattice cross sections\n        # k_eff = (nuSf/Sa) / (1 + B^2 * D/Sa)\n        k_calc = k_inf / (1.0 + B2 * L2)\n\n        # 2. Reference k_true with leakage enhancement factor beta\n        # k_true = k_inf / (1 + beta * B^2 * L^2)\n        k_true = k_inf / (1.0 + beta * B2 * L2)\n        \n        # 3. Bias Delta_k\n        delta_k = k_calc - k_true\n\n        # --- Correction Strategy 1: Superhomogenization (SPH) ---\n\n        # 4. SPH scaling factor s\n        # The derivation k_eff_sph = k_true leads to s = 1/beta\n        s = 1.0 / beta\n        \n        # 5. Corrected k_eff_sph\n        # Calculated explicitly as a verification, though by definition it equals k_true.\n        # k_eff_sph = k_inf / (1 + B^2 * (D / (Sigma_a * s)))\n        k_eff_sph = k_inf / (1.0 + B2 * (D / (Sigma_a * s)))\n\n        # --- Correction Strategy 2: Albedo-Adjusted Weighting ---\n        \n        # 6. Albedo-adjusted cross sections\n        leakage_fraction = 1.0 - a\n        Sigma_a_alb = Sigma_a * (1.0 + gamma_a * leakage_fraction)\n        nuSigma_f_alb = nuSigma_f * (1.0 - gamma_f * leakage_fraction)\n\n        # 7. Corrected k_eff_alb\n        # k_eff_alb = (nuSf_alb / Sa_alb) / (1 + B^2 * D / Sa_alb)\n        if Sigma_a_alb == 0:\n            # Avoid division by zero, although not expected with given constraints\n            k_eff_alb = float('inf') if nuSigma_f_alb > 0 else 0\n        else:\n            k_inf_alb = nuSigma_f_alb / Sigma_a_alb\n            k_eff_alb = k_inf_alb / (1.0 + B2 * D / Sigma_a_alb)\n\n        # 8. Residual error for albedo model\n        delta_k_alb = k_eff_alb - k_true\n        \n        # Assemble the results for the current case\n        case_results = [\n            k_calc,\n            delta_k,\n            k_eff_sph,\n            s,\n            k_eff_alb,\n            delta_k_alb\n        ]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The map(str, results) will convert each inner list to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}