{
    "hands_on_practices": [
        {
            "introduction": "This exercise isolates a specific but important contributor to the total decay heat: the energy released from metastable isomeric states. To accurately model decay heat, particularly at short times after shutdown, we must account for the inventory of these isomers built up during reactor operation. This practice guides you through calculating the equilibrium concentration of an isomer and determining its contribution to the overall heat load, demonstrating the crucial link between the reactor's operational history and the initial conditions for decay .",
            "id": "4221442",
            "problem": "A thermal nuclear reactor has been operating at steady state at thermal power $P_{\\text{th}}=3000$ megawatts for a time much longer than the half-lives of short-lived fission products. Immediately after shutdown at time $t=0$, the reactorâ€™s decay heat power $P_{\\text{DH}}(t)$ is modeled by summing energy releases from radioactive decays of the fission product inventory. Consider a specific fission fragment $X$ that has an isomeric (metastable) state $X^{m}$ which decays by internal transition (IT) to the ground state $X^{g}$ with half-life $t_{1/2}=1\\ \\text{min}$ and branching fraction $b_{\\text{IT}}=1$. The energy released per IT decay is $E_{\\text{IT}}=0.300$ mega-electronvolts (MeV), and the energy released per fission is $E_{f}=200$ mega-electronvolts (MeV). The isomer is produced directly in fission with yield $y_{m}=5.0\\times 10^{-3}$ isomers per fission. Assume all IT gamma energy is locally deposited and contributes to decay heat, and that the ground-state decay chain and its energy releases are unaffected by whether $X$ passed through $X^{m}$.\n\nA baseline decay heat model that ignores isomeric states underestimates $P_{\\text{DH}}(t)$ because it omits the delayed IT gamma energy released after shutdown. Starting from the number balance for production and decay under steady-state operation and the definition of radioactive decay with decay constant $\\lambda=\\ln(2)/t_{1/2}$, derive an expression for the correction $\\Delta P(t)$ that must be added to the baseline $P_{\\text{DH}}(t)$ to account for $X^{m}$ after shutdown. Then evaluate $\\Delta P(t)$ at $t=3\\ \\text{min}$.\n\nExpress your final answer in megawatts (MW) and round your answer to four significant figures.",
            "solution": "The decay heat correction, $\\Delta P(t)$, is the power generated by the decay of the isomer $X^{m}$ after shutdown. To find this, we must first determine the number of $X^{m}$ nuclei present in the reactor at the moment of shutdown, $t=0$.\n\nDuring steady-state operation at power $P_{\\text{th}}$, the rate of fissions, $R_f$, is constant. It is given by the total thermal power divided by the energy released per fission, $E_f$.\n$$R_f = \\frac{P_{\\text{th}}}{E_f}$$\nThe unit of $P_{\\text{th}}$ is megawatts (MW) and $E_f$ is in mega-electronvolts (MeV). To make the units consistent for calculating the fission rate in fissions per second, one would convert units. However, we will see that the energy units cancel, so we can proceed symbolically.\n\nThe number of $X^{m}$ isomers, denoted by $N_m(t)$, is governed by the rate equation:\n$$\\frac{dN_m(t)}{dt} = (\\text{Production Rate}) - (\\text{Decay Rate})$$\nThe production rate is the fission rate multiplied by the yield of the isomer, $y_m R_f$. The decay rate is $\\lambda_m N_m(t)$, where $\\lambda_m$ is the decay constant of the isomer. Since the branching fraction $b_{\\text{IT}}$ is $1$, all decays contribute to the loss of $N_m$.\n$$\\frac{dN_m(t)}{dt} = y_m R_f - \\lambda_m N_m(t)$$\nThe problem states the reactor has been operating for a time much longer than the half-life of short-lived fission products. The half-life of $X^m$ is $t_{1/2} = 1\\ \\text{min}$, which is short. Therefore, we can assume that the isomer population has reached secular equilibrium before shutdown. In this state, the rate of change is zero, $\\frac{dN_m}{dt} = 0$. The number of isomers at equilibrium, which is the number at shutdown $t=0$, is $N_{m,0}$.\n$$0 = y_m R_f - \\lambda_m N_{m,0}$$\nSolving for $N_{m,0}$:\n$$N_{m,0} = \\frac{y_m R_f}{\\lambda_m}$$\nAfter shutdown at $t=0$, the fission process stops, so the production term becomes zero. The number of isomers $N_m(t)$ for $t \\ge 0$ is governed by the simple radioactive decay equation:\n$$\\frac{dN_m(t)}{dt} = - \\lambda_m N_m(t)$$\nThe solution to this first-order linear differential equation with the initial condition $N_m(0) = N_{m,0}$ is:\n$$N_m(t) = N_{m,0} \\exp(-\\lambda_m t)$$\nThe activity of the isomer at time $t$ after shutdown, $A_m(t)$, is the number of decays per unit time, given by $\\lambda_m N_m(t)$.\n$$A_m(t) = \\lambda_m N_m(t) = \\lambda_m N_{m,0} \\exp(-\\lambda_m t)$$\nSubstituting the expression for $N_{m,0}$:\n$$A_m(t) = \\lambda_m \\left(\\frac{y_m R_f}{\\lambda_m}\\right) \\exp(-\\lambda_m t) = y_m R_f \\exp(-\\lambda_m t)$$\nThe decay heat correction, $\\Delta P(t)$, is the energy released per unit time from these decays. This is the activity multiplied by the energy released per decay, $E_{\\text{IT}}$.\n$$\\Delta P(t) = A_m(t) E_{\\text{IT}} = y_m R_f E_{\\text{IT}} \\exp(-\\lambda_m t)$$\nNow, we substitute the expression for the fission rate, $R_f = P_{\\text{th}} / E_f$:\n$$\\Delta P(t) = y_m \\left(\\frac{P_{\\text{th}}}{E_f}\\right) E_{\\text{IT}} \\exp(-\\lambda_m t)$$\nThis can be rearranged to show the relationship more clearly:\n$$\\Delta P(t) = P_{\\text{th}} \\cdot y_m \\cdot \\frac{E_{\\text{IT}}}{E_f} \\cdot \\exp(-\\lambda_m t)$$\nThis expression gives the decay heat correction at any time $t \\ge 0$. Note that since $P_{\\text{th}}$ is in MW and the energy ratio $E_{\\text{IT}}/E_f$ is dimensionless, $\\Delta P(t)$ will be in MW.\n\nWe are asked to evaluate this at $t=3\\ \\text{min}$. First, we calculate the decay constant $\\lambda_m$:\n$$\\lambda_m = \\frac{\\ln(2)}{t_{1/2}} = \\frac{\\ln(2)}{1\\ \\text{min}}$$\nThe argument of the exponential function is:\n$$-\\lambda_m t = -\\left(\\frac{\\ln(2)}{1\\ \\text{min}}\\right) (3\\ \\text{min}) = -3 \\ln(2) = \\ln(2^{-3}) = \\ln\\left(\\frac{1}{8}\\right)$$\nTherefore, the exponential term is:\n$$\\exp(-\\lambda_m t) = \\exp\\left(\\ln\\left(\\frac{1}{8}\\right)\\right) = \\frac{1}{8}$$\nNow, we substitute all the given numerical values into the expression for $\\Delta P(t)$:\n-   $P_{\\text{th}} = 3000$ MW\n-   $y_m = 5.0 \\times 10^{-3}$\n-   $E_{\\text{IT}} = 0.300$ MeV\n-   $E_f = 200$ MeV\n-   $t = 3$ min\n\n$$\\Delta P(t=3\\ \\text{min}) = (3000\\ \\text{MW}) \\cdot (5.0 \\times 10^{-3}) \\cdot \\frac{0.300\\ \\text{MeV}}{200\\ \\text{MeV}} \\cdot \\frac{1}{8}$$\n$$\\Delta P(3\\ \\text{min}) = 3000 \\cdot (5.0 \\times 10^{-3}) \\cdot (1.5 \\times 10^{-3}) \\cdot 0.125\\ \\text{MW}$$\n$$\\Delta P(3\\ \\text{min}) = (15) \\cdot (1.5 \\times 10^{-3}) \\cdot 0.125\\ \\text{MW}$$\n$$\\Delta P(3\\ \\text{min}) = (22.5 \\times 10^{-3}) \\cdot 0.125\\ \\text{MW}$$\n$$\\Delta P(3\\ \\text{min}) = 0.0225 \\cdot 0.125\\ \\text{MW}$$\n$$\\Delta P(3\\ \\text{min}) = 0.0028125\\ \\text{MW}$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\\Delta P(3\\ \\text{min}) \\approx 0.002813\\ \\text{MW}$$",
            "answer": "$$\n\\boxed{0.002813}\n$$"
        },
        {
            "introduction": "Decay heat is a composite phenomenon arising from multiple physical processes occurring in different locations within a reactor system. This practice expands the scope beyond fission products to compare alpha decay heating from actinides in the fuel against gamma heating from activation products in surrounding structural materials . By solving this problem, you will gain a quantitative appreciation for the relative importance of different heat sources at long cooling times and understand the critical modeling distinction between locally deposited alpha energy and transport-dependent gamma energy deposition.",
            "id": "4221371",
            "problem": "A Pressurized Water Reactor (PWR) has been shut down and stored fuel remains in the spent fuel pool. At long times after shutdown, decay heat arises from different mechanisms whose relative importance must be assessed to inform thermal-hydraulic modeling and shielding assumptions for nuclear reactor simulation. In this problem, you will compare actinide alpha decay heating within the fuel to activation gamma heating from $^{60}\\text{Co}$ in nearby steel structures at a specified time.\n\nAssume the following conditions at time $t = 3.0$ years after shutdown:\n- The actinide inventories within the fuel are measured and given as numbers of atoms: $^{238}\\text{Pu}$ has $N_{\\text{Pu-238}} = 1.50 \\times 10^{23}$ atoms, $^{241}\\text{Am}$ has $N_{\\text{Am-241}} = 8.00 \\times 10^{23}$ atoms, and $^{244}\\text{Cm}$ has $N_{\\text{Cm-244}} = 5.00 \\times 10^{22}$ atoms.\n- The activation product inventory in the steel structures is dominated by $^{60}\\text{Co}$ with $N_{\\text{Co-60}} = 3.00 \\times 10^{22}$ atoms.\n- The half-lives (in years) are: $t_{1/2,\\text{Pu-238}} = 87.7$, $t_{1/2,\\text{Am-241}} = 432.2$, $t_{1/2,\\text{Cm-244}} = 18.1$, and $t_{1/2,\\text{Co-60}} = 5.271$. Use $1 \\, \\text{year} = 3.15576 \\times 10^{7} \\, \\text{s}$.\n- The mean alpha-particle kinetic energies per decay (Mega-electronvolt (MeV)) are: $E_{\\alpha,\\text{Pu-238}} = 5.50 \\, \\text{MeV}$, $E_{\\alpha,\\text{Am-241}} = 5.486 \\, \\text{MeV}$, and $E_{\\alpha,\\text{Cm-244}} = 5.80 \\, \\text{MeV}$, with all alpha-particle energy deposited locally in the fuel.\n- The $^{60}\\text{Co}$ prompt gamma cascade has a mean total gamma energy per decay $E_{\\gamma,\\text{Co-60}} = 2.50 \\, \\text{MeV}$. Due to finite photon mean free paths and surrounding water and steel, only a fraction $f_{\\gamma} = 0.35$ of this gamma energy is effectively deposited as local heating in the structures of interest.\n- Ignore any neutrino energy and any beta-particle energy deposition for the activation chain; treat only the gamma energy for $^{60}\\text{Co}$. For actinide alpha decays, ignore any low-probability gamma emissions and treat the listed alpha kinetic energies as the deposited energy per decay.\n\nStarting from first principles, use the radioactive decay law and basic energy conversion to derive expressions for and compute the alpha-decay heating rate in the fuel and the activation gamma heating rate in the structures, both at $t = 3.0$ years. Then, compute the ratio\n$$\nR \\equiv \\frac{\\dot{Q}_{\\alpha}}{\\dot{Q}_{\\gamma}} ,\n$$\nwhere $\\dot{Q}_{\\alpha}$ is the total alpha-decay heating rate from the listed actinides and $\\dot{Q}_{\\gamma}$ is the effective local gamma heating rate from $^{60}\\text{Co}$.\n\nUse the fundamental constants $\\ln(2)$ and the electron volt conversion $1 \\, \\text{eV} = 1.602176634 \\times 10^{-19} \\, \\text{J}$. Express your final answer for $R$ as a dimensionless decimal. Round your answer to three significant figures.",
            "solution": "The heating rate (power), $\\dot{Q}$, generated by a radioactive isotope is the product of its activity, $A$, and the amount of energy deposited in the material of interest per decay, $E_{\\text{dep}}$.\n$$\n\\dot{Q} = A \\cdot E_{\\text{dep}}\n$$\nThe activity $A$ of a population of $N$ radioactive atoms is given by the radioactive decay law:\n$$\nA = \\lambda N\n$$\nwhere $\\lambda$ is the decay constant. The decay constant is related to the half-life, $t_{1/2}$, by:\n$$\n\\lambda = \\frac{\\ln(2)}{t_{1/2}}\n$$\nCombining these expressions, the heating rate for a single isotopic species, $i$, can be written as:\n$$\n\\dot{Q}_i = \\frac{\\ln(2)}{t_{1/2,i}} N_i E_{\\text{dep},i}\n$$\nThe problem provides the number of atoms $N_i$ for each isotope at the time of interest, $t=3.0$ years.\n\nFirst, we formulate the expression for the total alpha-decay heating rate, $\\dot{Q}_{\\alpha}$. This is the sum of the heating rates from the three specified actinides: $^{238}\\text{Pu}$, $^{241}\\text{Am}$, and $^{244}\\text{Cm}$. The problem states that all alpha-particle energy is deposited locally, so for these isotopes, $E_{\\text{dep},i} = E_{\\alpha,i}$.\n$$\n\\dot{Q}_{\\alpha} = \\dot{Q}_{\\text{Pu-238}} + \\dot{Q}_{\\text{Am-241}} + \\dot{Q}_{\\text{Cm-244}}\n$$\n$$\n\\dot{Q}_{\\alpha} = \\ln(2) \\left( \\frac{N_{\\text{Pu-238}}}{t_{1/2,\\text{Pu-238}}} E_{\\alpha,\\text{Pu-238}} + \\frac{N_{\\text{Am-241}}}{t_{1/2,\\text{Am-241}}} E_{\\alpha,\\text{Am-241}} + \\frac{N_{\\text{Cm-244}}}{t_{1/2,\\text{Cm-244}}} E_{\\alpha,\\text{Cm-244}} \\right)\n$$\nNext, we formulate the expression for the effective local gamma heating rate, $\\dot{Q}_{\\gamma}$, from $^{60}\\text{Co}$. For this isotope, only a fraction $f_{\\gamma}$ of the total gamma energy $E_{\\gamma,\\text{Co-60}}$ is deposited locally. Thus, $E_{\\text{dep},\\gamma} = f_{\\gamma} E_{\\gamma,\\text{Co-60}}$.\n$$\n\\dot{Q}_{\\gamma} = \\frac{\\ln(2)}{t_{1/2,\\text{Co-60}}} N_{\\text{Co-60}} (f_{\\gamma} E_{\\gamma,\\text{Co-60}})\n$$\nThe problem requires the calculation of the ratio $R = \\frac{\\dot{Q}_{\\alpha}}{\\dot{Q}_{\\gamma}}$.\n$$\nR = \\frac{\\ln(2) \\left( \\frac{N_{\\text{Pu-238}}}{t_{1/2,\\text{Pu-238}}} E_{\\alpha,\\text{Pu-238}} + \\frac{N_{\\text{Am-241}}}{t_{1/2,\\text{Am-241}}} E_{\\alpha,\\text{Am-241}} + \\frac{N_{\\text{Cm-244}}}{t_{1/2,\\text{Cm-244}}} E_{\\alpha,\\text{Cm-244}} \\right)}{\\frac{\\ln(2)}{t_{1/2,\\text{Co-60}}} N_{\\text{Co-60}} f_{\\gamma} E_{\\gamma,\\text{Co-60}}}\n$$\nThe term $\\ln(2)$ cancels from the numerator and denominator. Furthermore, since all half-lives are given in years and all energies are in MeV, the conversion factors to SI units (seconds and Joules, respectively) would also cancel out in the ratio. We can therefore proceed with the given numerical values and units directly.\n$$\nR = \\frac{ \\frac{N_{\\text{Pu-238}}}{t_{1/2,\\text{Pu-238}}} E_{\\alpha,\\text{Pu-238}} + \\frac{N_{\\text{Am-241}}}{t_{1/2,\\text{Am-241}}} E_{\\alpha,\\text{Am-241}} + \\frac{N_{\\text{Cm-244}}}{t_{1/2,\\text{Cm-244}}} E_{\\alpha,\\text{Cm-244}} }{ \\frac{N_{\\text{Co-60}}}{t_{1/2,\\text{Co-60}}} f_{\\gamma} E_{\\gamma,\\text{Co-60}} }\n$$\nNow, we substitute the numerical values provided in the problem statement.\nLet's compute the terms in the numerator:\n- Contribution from $^{238}\\text{Pu}$:\n$$ \\frac{1.50 \\times 10^{23} \\, \\text{atoms}}{87.7 \\, \\text{yr}} \\times 5.50 \\, \\text{MeV} = 9.407069... \\times 10^{21} \\, \\frac{\\text{atoms} \\cdot \\text{MeV}}{\\text{yr}} $$\n- Contribution from $^{241}\\text{Am}$:\n$$ \\frac{8.00 \\times 10^{23} \\, \\text{atoms}}{432.2 \\, \\text{yr}} \\times 5.486 \\, \\text{MeV} = 1.015455... \\times 10^{22} \\, \\frac{\\text{atoms} \\cdot \\text{MeV}}{\\text{yr}} $$\n- Contribution from $^{244}\\text{Cm}$:\n$$ \\frac{5.00 \\times 10^{22} \\, \\text{atoms}}{18.1 \\, \\text{yr}} \\times 5.80 \\, \\text{MeV} = 1.602209... \\times 10^{22} \\, \\frac{\\text{atoms} \\cdot \\text{MeV}}{\\text{yr}} $$\nThe numerator is the sum of these contributions:\n$$ \\dot{Q}_{\\alpha, \\text{proportional}} = (0.9407069... + 1.015455... + 1.602209...) \\times 10^{22} = 3.558372... \\times 10^{22} \\, \\frac{\\text{atoms} \\cdot \\text{MeV}}{\\text{yr}} $$\nNext, we compute the denominator:\n- Contribution from $^{60}\\text{Co}$:\n$$ \\frac{3.00 \\times 10^{22} \\, \\text{atoms}}{5.271 \\, \\text{yr}} \\times 0.35 \\times 2.50 \\, \\text{MeV} = 4.98008... \\times 10^{21} \\, \\frac{\\text{atoms} \\cdot \\text{MeV}}{\\text{yr}} $$\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{3.558372... \\times 10^{22}}{4.98008... \\times 10^{21}} = 7.14523...\n$$\nThe problem requires rounding the final answer to three significant figures.\n$$\nR \\approx 7.15\n$$\nThis result indicates that at $3$ years after shutdown, the actinide alpha decay heating in the fuel is approximately $7.15$ times greater than the activation gamma heating from $^{60}\\text{Co}$ in the nearby steel structures under the specified conditions.",
            "answer": "$$\n\\boxed{7.15}\n$$"
        },
        {
            "introduction": "Understanding decay heat principles culminates in the ability to build and trust predictive computational models. This hands-on coding practice moves from analytical problems to the essential engineering task of model verification and validation (V&V) . You will implement a standard decay heat model and test it against a benchmark, using quantitative error metrics to diagnose discrepancies and build confidence in your numerical tools, a core skill in reactor simulation.",
            "id": "4221415",
            "problem": "You are asked to validate a numerical implementation of transient decay heat modeling by reproducing a benchmark post-shutdown decay heat curve derived from the radioactive decay law. The validation must quantify discrepancies relative to a benchmark and diagnose likely causes of mismatch. The scenario and requirements are presented in purely mathematical and logical terms suitable for implementation in any modern programming language.\n\nBegin from the foundational radioactive decay law $dN/dt=-\\lambda N$ and the observation that the instantaneous heat release rate for a decay group is proportional to $E\\lambda N(t)$, where $E$ is the mean energy release per decay, $\\lambda$ is the decay constant, and $N(t)$ is the population of the decaying species. Under shutdown conditions, the benchmark transient decay heat curve is modeled as a finite mixture of exponential modes. Let $P_0$ denote the pre-shutdown steady thermal power and let $w_i$ denote the dimensionless weight of the $i$-th decay group such that $\\sum_i w_i$ equals the initial decay heat fraction at shutdown. Let the half-life of the $i$-th group be $T_{1/2,i}$ and the decay constant be $\\lambda_i=\\ln 2/T_{1/2,i}$. The benchmark decay heat curve $H_{\\mathrm{ref}}(t)$ is defined for time $t\\ge 0$ by\n$$\nH_{\\mathrm{ref}}(t)=P_0\\sum_{i=1}^n w_i e^{-\\lambda_i t}.\n$$\nAll quantities of power, when they appear, must be interpreted in megawatts (MW). In this problem, the output consists of dimensionless errors and counts, so the final printed answers do not carry physical units.\n\nYour numerical implementation produces a candidate curve $H_{\\mathrm{num}}(t)$ using its own parameter set $(\\tilde{w}_i,\\tilde{\\lambda}_i)$. For a prescribed discrete set of times $\\{t_j\\}_{j=1}^m$, compute the signed pointwise relative error\n$$\nr_j=\\frac{H_{\\mathrm{num}}(t_j)-H_{\\mathrm{ref}}(t_j)}{H_{\\mathrm{ref}}(t_j)}.\n$$\nFrom $\\{r_j\\}$, compute the following metrics:\n- Root-mean-square relative error\n$$\nE_{\\mathrm{rms}}=\\sqrt{\\frac{1}{m}\\sum_{j=1}^m r_j^2}.\n$$\n- Maximum relative error\n$$\nE_{\\mathrm{max}}=\\max_{1\\le j\\le m}\\left|r_j\\right|.\n$$\n- Bias magnitude\n$$\nB=\\left|\\frac{1}{m}\\sum_{j=1}^m r_j\\right|.\n$$\n- Shape variability\n$$\nS=\\sqrt{\\frac{1}{m}\\sum_{j=1}^m\\left(r_j-\\frac{1}{m}\\sum_{k=1}^m r_k\\right)^2}.\n$$\n\nFor a given tolerance $\\varepsilon$, define a boolean validation flag $\\mathrm{pass}$ as true if and only if $E_{\\mathrm{max}}\\le \\varepsilon$. Define the count of violations\n$$\nN_\\varepsilon=\\#\\{j:\\left|r_j\\right|>\\varepsilon\\}.\n$$\nDefine a diagnostic code $D$ to distinguish between predominantly amplitude bias and predominantly shape/timing mismatch:\n- $D=0$ if $E_{\\mathrm{max}}\\le \\varepsilon$ (passes tolerance).\n- $D=1$ if $E_{\\mathrm{max}}>\\varepsilon$ and $B\\ge 0.5\\,E_{\\mathrm{max}}$ and $S<0.5\\,E_{\\mathrm{max}}$ (bias-dominated).\n- $D=2$ otherwise (shape/timing-dominated mismatch).\n\nImplement the following benchmark and test suite. Use $P_0=3400$ MW, $n=6$, half-lives (in seconds) and weights as:\n- $T_{1/2}=[2,20,300,3600,36000,259200]$,\n- $w=[0.015,0.020,0.012,0.009,0.006,0.003]$.\nUse $m=200$ logarithmically spaced times $t_j$ spanning $t_{\\min}=1$ s to $t_{\\max}=86400$ s, inclusive.\n\nConstruct the candidate $H_{\\mathrm{num}}(t)$ for each test case by modifying the benchmark parameters as specified. The test suite consists of five cases:\n1. Case A (happy path): $\\tilde{w}_i=w_i$ and $\\tilde{T}_{1/2,i}=T_{1/2,i}$ for all $i$; tolerance $\\varepsilon=10^{-12}$.\n2. Case B (uniform amplitude bias): $\\tilde{w}_i=1.01\\,w_i$ and $\\tilde{T}_{1/2,i}=T_{1/2,i}$ for all $i$; tolerance $\\varepsilon=0.015$.\n3. Case C (single-group timing discrepancy): $\\tilde{w}_i=w_i$ for all $i$, but the fourth group has $\\tilde{T}_{1/2,4}=1.10\\,T_{1/2,4}$ while other half-lives are unchanged; tolerance $\\varepsilon=0.005$.\n4. Case D (missing slow group): $\\tilde{w}_6=0$ and $\\tilde{w}_i=w_i$ for $i\\neq 6$, with $\\tilde{T}_{1/2,i}=T_{1/2,i}$ for all $i$; tolerance $\\varepsilon=0.010$.\n5. Case E (near-boundary amplitude bias): $\\tilde{w}_i=1.001\\,w_i$ and $\\tilde{T}_{1/2,i}=T_{1/2,i}$ for all $i$; tolerance $\\varepsilon=0.001$.\n\nYour program should compute, for each case, the tuple of results $[E_{\\mathrm{rms}},E_{\\mathrm{max}},\\mathrm{pass},N_\\varepsilon,D]$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above. For example, the output format must look like $[[e_{1,\\mathrm{rms}},e_{1,\\mathrm{max}},p_1,n_1,d_1],[e_{2,\\mathrm{rms}},e_{2,\\mathrm{max}},p_2,n_2,d_2],\\ldots]$, where each $e_{k,\\cdot}$ is a decimal, each $p_k$ is a boolean, each $n_k$ is an integer, and each $d_k$ is an integer code.",
            "solution": "The core of this problem is to implement a computational framework for quantifying the discrepancy between a reference model and a candidate numerical model for post-shutdown decay heat. The solution is structured into three main steps: implementing the decay heat model, calculating the specified error and diagnostic metrics, and executing the defined test suite.\n\n**1. Decay Heat Model Implementation**\n\nThe benchmark decay heat curve, $H_{\\mathrm{ref}}(t)$, is given by a sum of exponential decay modes:\n$$\nH_{\\mathrm{ref}}(t) = P_0\\sum_{i=1}^n w_i e^{-\\lambda_i t}\n$$\nwhere $P_0$ is the reactor's steady-state thermal power, $w_i$ are the weights for each of the $n$ decay groups, and $\\lambda_i$ are the decay constants. The decay constant $\\lambda_i$ for group $i$ is related to its half-life $T_{1/2,i}$ by $\\lambda_i = \\frac{\\ln 2}{T_{1/2,i}}$. A candidate numerical model, $H_{\\mathrm{num}}(t)$, is defined by the same functional form but may use a different set of parameters, $(\\tilde{w}_i, \\tilde{\\lambda}_i)$.\n\nComputationally, we first establish the discrete time points $\\{t_j\\}_{j=1}^m$ over which the comparison will be made. The problem specifies $m=200$ points logarithmically spaced from $t_{\\min}=1$ s to $t_{\\max}=86400$ s.\n\nA function is designed to calculate the heat curve $H(t)$ for a given set of parameters $(P_0, w, T_{1/2})$ over the time vector $t$. This function first computes the decay constants $\\lambda_i$ from the half-lives $T_{1/2,i}$. To efficiently calculate $H(t_j)$ for all $j$, we can use matrix-vector operations. Let $\\mathbf{t}$ be the column vector of time points $(t_j)_{j=1}^m$ and $\\boldsymbol{\\lambda}$ be the row vector of decay constants $(\\lambda_i)_{i=1}^n$. The outer product $-\\mathbf{t} \\boldsymbol{\\lambda}$ yields an $m \\times n$ matrix whose $(j,i)$ element is $-\\lambda_i t_j$. Applying the exponential function element-wise gives a matrix $\\mathbf{E}$ where $E_{ji} = e^{-\\lambda_i t_j}$. The heat curve, a vector $\\mathbf{H}$ of length $m$, is then computed as $\\mathbf{H} = P_0 (\\mathbf{E} \\mathbf{w}^T)$, where $\\mathbf{w}$ is the column vector of weights.\n\n**2. Error and Diagnostic Metrics Calculation**\n\nWith the reference curve $H_{\\mathrm{ref}}(t_j)$ and the numerical curve $H_{\\mathrm{num}}(t_j)$ computed at each time point $t_j$, we proceed to calculate the specified metrics.\n\nFirst, the signed pointwise relative error vector $\\mathbf{r}$ is computed, with elements:\n$$\nr_j = \\frac{H_{\\mathrm{num}}(t_j) - H_{\\mathrm{ref}}(t_j)}{H_{\\mathrm{ref}}(t_j)}\n$$\nNote that since $P_0 > 0$, $w_i > 0$, and $t_j > 0$, the denominator $H_{\\mathrm{ref}}(t_j)$ is strictly positive, precluding any division by zero.\n\nFrom the vector $\\mathbf{r}$ of relative errors, the following aggregate metrics are calculated:\n- Root-mean-square relative error, $E_{\\mathrm{rms}} = \\sqrt{\\frac{1}{m}\\sum_{j=1}^m r_j^2}$. This is the L2-norm of the error vector, scaled by $1/\\sqrt{m}$.\n- Maximum relative error, $E_{\\mathrm{max}} = \\max_{j} |r_j|$. This is the L-infinity norm of the error vector.\n- Bias magnitude, $B = |\\frac{1}{m}\\sum_{j=1}^m r_j|$. This represents the magnitude of the mean relative error.\n- Shape variability, $S = \\sqrt{\\frac{1}{m}\\sum_{j=1}^m (r_j - \\bar{r})^2}$, where $\\bar{r} = \\frac{1}{m}\\sum_k r_k$. This is the population standard deviation of the relative errors, quantifying the variation of the error over time, independent of its mean value.\n\nNext, for a given tolerance $\\varepsilon$, the validation flag and diagnostic code are determined:\n- The validation flag, $\\mathrm{pass}$, is a boolean defined as `true` if $E_{\\mathrm{max}} \\le \\varepsilon$ and `false` otherwise.\n- The count of violations, $N_\\varepsilon$, is the number of time points $j$ where the absolute relative error $|r_j|$ exceeds $\\varepsilon$.\n- The diagnostic code, $D$, is an integer assigned based on the following logic:\n  - If $\\mathrm{pass}$ is `true` ($E_{\\mathrm{max}} \\le \\varepsilon$), then $D=0$.\n  - If $\\mathrm{pass}$ is `false` ($E_{\\mathrm{max}} > \\varepsilon$) and the error is dominated by a consistent bias ($B \\ge 0.5 E_{\\mathrm{max}}$ and $S < 0.5 E_{\\mathrm{max}}$), then $D=1$.\n  - Otherwise (i.e., if $\\mathrm{pass}$ is `false` and the error is dominated by shape/timing variation), then $D=2$.\n\n**3. Test Suite Execution**\n\nThe entire process is automated to run through five specified test cases. A set of reference parameters is defined: $P_0=3400$, $n=6$, with reference half-lives $T_{1/2}$ and weights $w$ as given in the problem statement. The reference heat curve $H_{\\mathrm{ref}}(t)$ is computed once.\n\nA loop iterates through the five test cases (A-E). In each iteration:\n1. The numerical parameters $(\\tilde{w}, \\tilde{T}_{1/2})$ and the tolerance $\\varepsilon$ are set according to the case definition.\n2. The numerical heat curve $H_{\\mathrm{num}}(t)$ is computed.\n3. The set of metrics $(E_{\\mathrm{rms}}, E_{\\mathrm{max}}, B, S, \\mathrm{pass}, N_\\varepsilon, D)$ is calculated.\n4. The required output tuple $[E_{\\mathrm{rms}}, E_{\\mathrm{max}}, \\mathrm{pass}, N_\\varepsilon, D]$ is stored.\n\nAfter all cases are processed, the list of result tuples is formatted into a single string as specified: a comma-separated list of lists, all enclosed in a parent pair of square brackets, with no whitespace. This formatted string constitutes the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates a numerical implementation of transient decay heat modeling\n    by calculating error metrics against a benchmark for several test cases.\n    \"\"\"\n\n    # --- 1. Define Benchmark Parameters and Time Discretization ---\n\n    P0 = 3400.0  # MW\n    \n    # Reference 6-group parameters\n    T_half_ref = np.array([2.0, 20.0, 300.0, 3600.0, 36000.0, 259200.0])  # seconds\n    w_ref = np.array([0.015, 0.020, 0.012, 0.009, 0.006, 0.003])  # dimensionless\n    \n    # Time vector\n    m = 200\n    t_min = 1.0  # s\n    t_max = 86400.0  # s (1 day)\n    t_vec = np.logspace(np.log10(t_min), np.log10(t_max), m)\n\n    # --- 2. Define Helper Functions ---\n\n    def calculate_decay_heat(t, P_0, w, T_half):\n        \"\"\"Calculates decay heat H(t) for a given set of parameters.\"\"\"\n        if T_half.size == 0:\n            return np.zeros_like(t)\n        \n        lambda_vals = np.log(2) / T_half\n        \n        # Use broadcasting for efficient calculation:\n        # t_vec is (m, 1), lambda_vals is (n,) -> result is (m, n)\n        exponents = -t[:, np.newaxis] * lambda_vals\n        exp_matrix = np.exp(exponents)\n        \n        # H is (m,) vector\n        H = P_0 * np.sum(w * exp_matrix, axis=1)\n        return H\n\n    # --- 3. Define Test Cases ---\n\n    test_cases = [\n        {\n            \"name\": \"Case A (happy path)\",\n            \"w_mod\": lambda w: w,\n            \"T_half_mod\": lambda T: T,\n            \"epsilon\": 1e-12\n        },\n        {\n            \"name\": \"Case B (uniform amplitude bias)\",\n            \"w_mod\": lambda w: 1.01 * w,\n            \"T_half_mod\": lambda T: T,\n            \"epsilon\": 0.015\n        },\n        {\n            \"name\": \"Case C (single-group timing discrepancy)\",\n            \"w_mod\": lambda w: w,\n            \"T_half_mod\": lambda T: np.array([T[0], T[1], T[2], 1.10 * T[3], T[4], T[5]]),\n            \"epsilon\": 0.005\n        },\n        {\n            \"name\": \"Case D (missing slow group)\",\n            \"w_mod\": lambda w: np.array([w[0], w[1], w[2], w[3], w[4], 0.0]),\n            \"T_half_mod\": lambda T: T,\n            \"epsilon\": 0.010\n        },\n        {\n            \"name\": \"Case E (near-boundary amplitude bias)\",\n            \"w_mod\": lambda w: 1.001 * w,\n            \"T_half_mod\": lambda T: T,\n            \"epsilon\": 0.001\n        }\n    ]\n\n    # --- 4. Execute Benchmark and Test Cases ---\n\n    # Calculate the reference heat curve once\n    H_ref = calculate_decay_heat(t_vec, P0, w_ref, T_half_ref)\n\n    results = []\n    for case in test_cases:\n        # Construct numerical parameters for the current case\n        w_num = case[\"w_mod\"](w_ref.copy())\n        T_half_num = case[\"T_half_mod\"](T_half_ref.copy())\n        epsilon = case[\"epsilon\"]\n\n        # Calculate numerical heat curve\n        H_num = calculate_decay_heat(t_vec, P0, w_num, T_half_num)\n\n        # Calculate pointwise relative error\n        # H_ref is always positive for t > 0, so no division by zero\n        r = (H_num - H_ref) / H_ref\n        \n        # Calculate error metrics\n        E_rms = np.sqrt(np.mean(r**2))\n        E_max = np.max(np.abs(r))\n        r_mean = np.mean(r)\n        B = np.abs(r_mean)\n        # S is population standard deviation, default ddof=0 for np.std\n        S = np.std(r)\n\n        # Calculate validation and diagnostic metrics\n        passed = E_max <= epsilon\n        N_eps = np.sum(np.abs(r) > epsilon)\n\n        D = 0\n        if not passed:\n            if B >= 0.5 * E_max and S < 0.5 * E_max:\n                D = 1\n            else:\n                D = 2\n        \n        case_result = [E_rms, E_max, passed, int(N_eps), D]\n        results.append(case_result)\n\n    # --- 5. Format and Print Final Output ---\n    \n    # Format each sublist into a string like \"[val1,val2,val3]\"\n    result_strings = []\n    for res in results:\n        # Manually format to match \"True/False\" and avoid whitespace\n        s = f\"[{res[0]},{res[1]},{res[2]},{res[3]},{res[4]}]\"\n        result_strings.append(s)\n\n    # Join the sublist strings into the final format \"[...],[...]\"\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}