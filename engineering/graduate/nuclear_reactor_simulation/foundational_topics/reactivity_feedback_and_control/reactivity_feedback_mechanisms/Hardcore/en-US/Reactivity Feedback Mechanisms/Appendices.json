{
    "hands_on_practices": [
        {
            "introduction": "The Moderator Temperature Coefficient (MTC) of reactivity is one of the most important parameters for ensuring the stable and safe operation of water-moderated reactors. This practice guides you through a foundational analysis, starting with a first-order calculation of the reactivity change due to a shift in moderator temperature. The exercise then challenges you to explore the underlying physics, dissecting the competing effects of neutron spectrum hardening, leakage, and soluble boron dilution that collectively determine the MTC's sign and magnitude .",
            "id": "4244477",
            "problem": "A Pressurized Water Reactor (PWR) is operating at near-zero power with the core in a critical state. The core-average moderator temperature is initially $T_{m0} = 580\\ \\mathrm{K}$, and the reactivity at this state is $ \\rho_{0} = 0 $. In reactor physics, reactivity is defined by $ \\rho = (k_{\\mathrm{eff}} - 1)/k_{\\mathrm{eff}} $, where $k_{\\mathrm{eff}}$ is the effective multiplication factor. The reactor simulation employs a locally linear moderator temperature coefficient, defined as $ \\alpha_{m} = \\left.\\frac{\\partial \\rho}{\\partial T_{m}}\\right|_{T_{m0}} $, measured at the initial state. At the given boron chemistry and burnup, the measured moderator temperature coefficient is $ \\alpha_{m} = -18\\ \\mathrm{pcm/K} $ at $ T_{m0} $. Here, per cent mille (pcm) is a unit of reactivity defined by $1\\ \\mathrm{pcm} = 1 \\times 10^{-5}$ in dimensionless reactivity units. \n\nThe moderator temperature is increased to $ T_{m} = 592\\ \\mathrm{K} $ by adjusting coolant inlet conditions. Starting from the definition of reactivity and the definition of the moderator temperature coefficient as a local derivative at $T_{m0}$, derive a first-order expression for the change in reactivity $ \\Delta \\rho $ and compute its numerical value for the above change in $ T_{m} $. Round your final numerical answer for $ \\Delta \\rho $ to four significant figures and express it as a dimensionless decimal reactivity (do not include units in the final number).\n\nThen, based on first principles, discuss the physical conditions under which the moderator temperature coefficient $ \\alpha_{m} $ can change sign in a PWR, identifying the competing mechanisms that contribute to $ \\frac{\\partial \\rho}{\\partial T_{m}} $ and how their magnitudes depend on moderator density, soluble boron concentration, and neutron spectrum.",
            "solution": "The problem is evaluated to be scientifically grounded, well-posed, objective, and contains all necessary information for a complete solution. It is therefore deemed valid.\n\nThe problem consists of two parts. The first part requires the derivation and calculation of the change in reactivity, $\\Delta\\rho$, due to a change in moderator temperature. The second part requires a qualitative discussion of the physical mechanisms governing the sign of the moderator temperature coefficient of reactivity, $\\alpha_m$.\n\n**Part 1: Calculation of Reactivity Change**\n\nThe reactivity, $\\rho$, is a function of the state of the reactor core, including the moderator temperature, $T_m$. The moderator temperature coefficient of reactivity, $\\alpha_m$, is defined as the partial derivative of reactivity with respect to the moderator temperature, evaluated at a specific state. In this problem, it is evaluated at the initial state ($T_{m0}$, $\\rho_0$).\n$$\n\\alpha_{m} = \\left.\\frac{\\partial \\rho}{\\partial T_{m}}\\right|_{T_{m0}}\n$$\nTo find a first-order expression for the change in reactivity, $\\Delta\\rho = \\rho(T_m) - \\rho(T_{m0})$, a first-order Taylor series expansion of the function $\\rho(T_m)$ around the initial temperature $T_{m0}$ is employed.\n$$\n\\rho(T_m) \\approx \\rho(T_{m0}) + \\left.\\frac{\\partial \\rho}{\\partial T_{m}}\\right|_{T_{m0}} (T_m - T_{m0})\n$$\nBy substituting the definition of $\\alpha_m$ and rearranging the terms, we obtain the expression for the change in reactivity, $\\Delta\\rho$.\n$$\n\\rho(T_m) - \\rho(T_{m0}) \\approx \\alpha_{m} (T_m - T_{m0})\n$$\n$$\n\\Delta\\rho \\approx \\alpha_{m} \\Delta T_{m}\n$$\nThis is the required first-order expression for the change in reactivity. It shows that for small changes in temperature, the change in reactivity is approximately linear.\n\nNow, we compute the numerical value of $\\Delta\\rho$ using the provided data.\nThe givens are:\nInitial moderator temperature, $T_{m0} = 580\\ \\mathrm{K}$.\nFinal moderator temperature, $T_{m} = 592\\ \\mathrm{K}$.\nModerator temperature coefficient at $T_{m0}$, $\\alpha_{m} = -18\\ \\mathrm{pcm/K}$.\nOne per cent mille, $1\\ \\mathrm{pcm} = 1 \\times 10^{-5}$ in dimensionless reactivity units.\n\nFirst, convert $\\alpha_m$ into dimensionless units per Kelvin.\n$$\n\\alpha_{m} = -18\\ \\frac{\\mathrm{pcm}}{\\mathrm{K}} = -18 \\times (1 \\times 10^{-5})\\ \\mathrm{K}^{-1} = -1.8 \\times 10^{-4}\\ \\mathrm{K}^{-1}\n$$\nNext, calculate the change in moderator temperature, $\\Delta T_m$.\n$$\n\\Delta T_{m} = T_m - T_{m0} = 592\\ \\mathrm{K} - 580\\ \\mathrm{K} = 12\\ \\mathrm{K}\n$$\nFinally, calculate the change in reactivity, $\\Delta\\rho$.\n$$\n\\Delta\\rho \\approx (-1.8 \\times 10^{-4}\\ \\mathrm{K}^{-1}) \\times (12\\ \\mathrm{K})\n$$\n$$\n\\Delta\\rho \\approx -21.6 \\times 10^{-4} = -0.00216\n$$\nThe problem requires the answer to be rounded to four significant figures. Therefore, the final numerical value is $-0.002160$. This negative change in reactivity indicates that the reactor has become subcritical as a result of the temperature increase, which is consistent with the negative sign of $\\alpha_m$.\n\n**Part 2: Physical Mechanisms for Sign Change of $\\alpha_m$**\n\nThe moderator temperature coefficient of reactivity, $\\alpha_m = \\frac{\\partial \\rho}{\\partial T_m}$, can change sign and become positive under certain conditions in a Pressurized Water Reactor (PWR). A positive $\\alpha_m$ represents a significant safety concern, as an increase in temperature would add positive reactivity, leading to a potential power excursion. The sign and magnitude of $\\alpha_m$ are determined by the net effect of several competing physical phenomena that are triggered by a change in moderator (water) density, $\\rho_w$, as temperature changes. For water in the typical operating range of a PWR, an increase in temperature, $T_m$, causes a decrease in density, $\\rho_w$.\n\nThe total derivative can be expressed using the chain rule as $\\frac{\\partial \\rho}{\\partial T_m} = \\frac{\\partial \\rho}{\\partial \\rho_w} \\frac{\\partial \\rho_w}{\\partial T_m}$. Since $\\frac{\\partial \\rho_w}{\\partial T_m}$ is always negative for water above $4^\\circ\\mathrm{C}$, the sign of $\\alpha_m$ is opposite to the sign of $\\frac{\\partial \\rho}{\\partial \\rho_w}$. The change in reactivity with respect to moderator density, $\\frac{\\partial \\rho}{\\partial \\rho_w}$, is the sum of three primary effects:\n\n1.  **Neutron Spectrum Hardening (Negative Reactivity Effect)**: The primary role of the water moderator is to slow down fast neutrons produced by fission to thermal energies, where the probability of causing another fission in $^{235}$U is much higher. A decrease in water density (due to increased $T_m$) reduces the number of hydrogen nuclei per unit volume, which impairs the moderating power of the coolant. Consequently, fewer neutrons are thermalized, and the average energy of the neutron population increases. This phenomenon is called spectrum hardening. For a typical low-enriched uranium fuel, this harder spectrum leads to a lower effective fission cross-section, reducing the thermal fission rate and thus inserting negative reactivity.\n\n2.  **Increased Neutron Leakage (Negative Reactivity Effect)**: The water in a PWR acts as both a moderator and a neutron reflector. A decrease in moderator density reduces the scattering cross-section of the core, increasing the mean free path for neutrons. This makes it more likely for neutrons to escape from the core volume entirely without being absorbed or causing fission. This increased neutron leakage represents a loss of neutrons from the chain reaction, thus contributing negative reactivity.\n\n3.  **Soluble Boron Density Change (Positive Reactivity Effect)**: To control excess reactivity over the fuel cycle, PWRs use boric acid ($H_3BO_3$) dissolved in the moderator. The isotope $^{10}$B is a very strong absorber of thermal neutrons. When the moderator temperature increases, the water expands and its density decreases. This expansion forces a certain amount of water, and with it the dissolved boron, out of the reactor core. The total number of boron atoms within the core volume is therefore reduced. This reduction in the concentration of a neutron poison leads to less parasitic absorption and thus inserts positive reactivity.\n\nThe moderator temperature coefficient, $\\alpha_m$, is the sum of these competing effects.\n$$\n\\alpha_m = (\\alpha_m)_{\\text{spectrum}} + (\\alpha_m)_{\\text{leakage}} + (\\alpha_m)_{\\text{boron}}\n$$\nwhere the spectrum and leakage components are negative, and the boron component is positive.\n\nThe coefficient $\\alpha_m$ can change sign and become positive if the positive reactivity insertion from the boron density effect is large enough to overcome the sum of the negative reactivity effects from spectrum hardening and increased leakage. This condition is most likely to occur under a specific set of circumstances:\n\n-   **High Soluble Boron Concentration**: The magnitude of the positive boron effect is directly proportional to the concentration of boric acid in the coolant. Boron concentration is highest at the beginning of a fuel cycle (BOC) to compensate for the high reactivity of fresh fuel. Therefore, the risk of a positive $\\alpha_m$ is greatest at BOC. As the fuel is depleted and the boron concentration is reduced (a process called boron letdown), the positive component of $\\alpha_m$ diminishes, making $\\alpha_m$ more negative.\n\n-   **Low Moderator Temperature**: The density of water is higher at lower temperatures. A reactor at zero-power, cold or hot-standby conditions, contains a higher inventory of coolant and thus a greater number of boron atoms in the core than at full-power operating temperatures. A temperature increase from this state will expel a larger absolute mass of water and boron, leading to a stronger positive reactivity effect. For this reason, regulatory limits on $\\alpha_m$ are particularly strict for zero-power physics testing conditions.\n\nIn summary, the competition between the negative reactivity feedback from spectral and leakage effects and the positive feedback from the reduction in soluble boron density determines the sign of $\\alpha_m$. A positive $\\alpha_m$ is most probable at the beginning of a fuel cycle when boron concentration is at its maximum, especially at lower moderator temperatures.",
            "answer": "$$\n\\boxed{-0.002160}\n$$"
        },
        {
            "introduction": "Moving from static coefficients to their critical role in reactor dynamics, this exercise examines a rapid power excursion scenario. You will analyze a hypothetical event where a reactor becomes super-prompt-critical, a condition where the chain reaction can be sustained by prompt neutrons alone. The core of this practice is to calculate the fuel temperature rise required for the inherent negative temperature feedback to counteract the initial reactivity insertion and bring the reactor back to the threshold of prompt criticality . This demonstrates the fundamental principle of self-regulation that underpins passive reactor safety.",
            "id": "4244448",
            "problem": "A thermal nuclear reactor is initially at steady state at time $t=0^{-}$ with constant power $P_{0}$, fuel temperature $T_{F,0}$, and moderator temperature $T_{M,0}$. The reactor can be modeled by the reactor point kinetics equations and standard linear temperature feedback. At $t=0$, a positive step reactivity insertion $ \\rho_{0} $ is introduced due to control rod motion. The effective delayed neutron fraction is $ \\beta $, and the prompt neutron generation time is $ \\Lambda $. The total instantaneous reactivity during the transient is modeled as\n$$\n\\rho(t) = \\rho_{0} + \\alpha_{F}\\left(T_{F}(t)-T_{F,0}\\right) + \\alpha_{M}\\left(T_{M}(t)-T_{M,0}\\right),\n$$\nwhere $\\alpha_{F}0$ and $\\alpha_{M}0$ are the fuel and moderator temperature coefficients of reactivity (Temperature Coefficient of Reactivity (TCR)), respectively. During the prompt timescale of interest, the moderator temperature rise tracks a fixed fraction $\\eta$ of the fuel temperature rise, so that\n$$\nT_{M}(t)-T_{M,0} = \\eta\\left(T_{F}(t)-T_{F,0}\\right)\n$$\nwith $0\\eta1$. Assume an adiabatic fuel model on the prompt timescale and neglect any external reactivity feedback other than temperature.\n\nUsing reactor point kinetics as the fundamental base, identify the condition that demarcates the onset of prompt critical behavior. Then, under the above assumptions, derive an algebraic expression for the minimum fuel temperature rise $\\Delta T_{F}^{\\star} = T_{F}(t^{\\star})-T_{F,0}$ required such that the instantaneous net reactivity reaches this boundary. Finally, compute $\\Delta T_{F}^{\\star}$ for the following reactor parameters:\n- $ \\beta = 6.5 \\times 10^{-3} $,\n- $ \\Lambda = 1.0 \\times 10^{-4}~\\text{s} $,\n- $ \\lambda_{d} = 8.0 \\times 10^{-2}~\\text{s}^{-1} $ (effective single delayed group decay constant),\n- $ \\rho_{0} = 8.0 \\times 10^{-3} $,\n- $ \\alpha_{F} = -3.6 \\times 10^{-5}~\\text{K}^{-1} $,\n- $ \\alpha_{M} = -1.6 \\times 10^{-5}~\\text{K}^{-1} $,\n- $ \\eta = 0.25 $.\n\nRound your final numerical answer for the temperature rise to four significant figures. Express the final temperature rise in K. No additional quantities need to be reported besides $\\Delta T_{F}^{\\star}$.",
            "solution": "The problem statement is evaluated against the established criteria and is found to be valid. It is scientifically grounded in the principles of nuclear reactor kinetics and thermal-hydraulics, well-posed with sufficient and consistent information, and formulated with objective, unambiguous language. The parameters provided are physically realistic for a thermal nuclear reactor. The presence of the effective single delayed group decay constant, $\\lambda_{d}$, and the prompt neutron generation time, $\\Lambda$, although not required for the final algebraic calculation, are essential context for the reactor point kinetics model and do not invalidate the problem. We may therefore proceed with the solution.\n\nThe problem asks for three distinct items: the condition for prompt critical behavior, an algebraic expression for the required fuel temperature rise to meet this condition, and a numerical calculation of this temperature rise.\n\nFirst, we identify the condition that demarcates the onset of prompt critical behavior. In reactor physics, the total reactivity, $\\rho$, determines the rate of change of the neutron population. The effective delayed neutron fraction, $\\beta$, represents the fraction of fission neutrons that are born from the decay of fission products (delayed neutrons), as opposed to being born directly from fission (prompt neutrons).\n- If $\\rho  \\beta$, the reactor is said to be \"delayed supercritical.\" The chain reaction is sustained by both prompt and delayed neutrons, and the reactor power increases on a timescale governed by the delayed neutron precursors, which is relatively slow (seconds to minutes).\n- If $\\rho \\geq \\beta$, the reactor is said to be \"prompt critical.\" At the boundary $\\rho = \\beta$, the production of prompt neutrons alone is sufficient to sustain a new generation of fissions that is equal in size to the previous one. The reactor becomes critical on prompt neutrons alone, and the power increases extremely rapidly on a timescale dictated by the prompt neutron generation time, $\\Lambda$, which is typically on the order of microseconds to milliseconds.\nTherefore, the condition that demarcates the onset of prompt critical behavior is when the total instantaneous reactivity $\\rho(t)$ is equal to the effective delayed neutron fraction $\\beta$.\n$$\n\\rho(t) = \\beta\n$$\n\nSecond, we derive an algebraic expression for the minimum fuel temperature rise, $\\Delta T_{F}^{\\star}$, required for the net reactivity to reach this boundary. At time $t=0$, a positive step reactivity $\\rho_{0}$ is inserted. The total instantaneous reactivity is given by:\n$$\n\\rho(t) = \\rho_{0} + \\alpha_{F}\\left(T_{F}(t)-T_{F,0}\\right) + \\alpha_{M}\\left(T_{M}(t)-T_{M,0}\\right)\n$$\nwhere $T_{F,0}$ and $T_{M,0}$ are the initial steady-state fuel and moderator temperatures, respectively.\nLet us define the temperature rise for the fuel and moderator as $\\Delta T_{F}(t) = T_{F}(t)-T_{F,0}$ and $\\Delta T_{M}(t) = T_{M}(t)-T_{M,0}$. The reactivity equation can be written as:\n$$\n\\rho(t) = \\rho_{0} + \\alpha_{F}\\Delta T_{F}(t) + \\alpha_{M}\\Delta T_{M}(t)\n$$\nThe problem states that on the prompt timescale, the moderator temperature rise tracks the fuel temperature rise according to the relation:\n$$\n\\Delta T_{M}(t) = \\eta \\Delta T_{F}(t)\n$$\nSubstituting this into the reactivity equation yields an expression for reactivity solely in terms of the fuel temperature rise:\n$$\n\\rho(t) = \\rho_{0} + \\alpha_{F}\\Delta T_{F}(t) + \\alpha_{M}\\left(\\eta \\Delta T_{F}(t)\\right)\n$$\nFactoring out the term $\\Delta T_{F}(t)$, we get:\n$$\n\\rho(t) = \\rho_{0} + \\left(\\alpha_{F} + \\eta\\alpha_{M}\\right)\\Delta T_{F}(t)\n$$\nThe initial reactivity insertion $\\rho_{0} = 8.0 \\times 10^{-3}$ is greater than $\\beta = 6.5 \\times 10^{-3}$, meaning the reactor is initially super-prompt-critical. The subsequent power rise causes the fuel temperature to increase, introducing negative reactivity feedback (since $\\alpha_F  0$ and $\\alpha_M  0$). This feedback reduces the total reactivity. We seek the fuel temperature rise, denoted $\\Delta T_{F}^{\\star}$, at the time $t^{\\star}$ when the reactivity has decreased to the prompt critical boundary, i.e., $\\rho(t^{\\star}) = \\beta$.\nSetting $\\rho(t^{\\star}) = \\beta$ and $\\Delta T_{F}(t^{\\star}) = \\Delta T_{F}^{\\star}$ in the equation above gives:\n$$\n\\beta = \\rho_{0} + \\left(\\alpha_{F} + \\eta\\alpha_{M}\\right) \\Delta T_{F}^{\\star}\n$$\nSolving for $\\Delta T_{F}^{\\star}$, we find:\n$$\n\\left(\\alpha_{F} + \\eta\\alpha_{M}\\right) \\Delta T_{F}^{\\star} = \\beta - \\rho_{0}\n$$\n$$\n\\Delta T_{F}^{\\star} = \\frac{\\beta - \\rho_{0}}{\\alpha_{F} + \\eta\\alpha_{M}}\n$$\nThis is the required algebraic expression.\n\nThird, we compute the numerical value of $\\Delta T_{F}^{\\star}$ using the provided parameters:\n- $\\beta = 6.5 \\times 10^{-3}$\n- $\\rho_{0} = 8.0 \\times 10^{-3}$\n- $\\alpha_{F} = -3.6 \\times 10^{-5}~\\text{K}^{-1}$\n- $\\alpha_{M} = -1.6 \\times 10^{-5}~\\text{K}^{-1}$\n- $\\eta = 0.25$\n\nFirst, we calculate the numerator of the expression:\n$$\n\\beta - \\rho_{0} = (6.5 \\times 10^{-3}) - (8.0 \\times 10^{-3}) = -1.5 \\times 10^{-3}\n$$\nNext, we calculate the denominator, which is the effective temperature coefficient of reactivity:\n$$\n\\alpha_{F} + \\eta\\alpha_{M} = (-3.6 \\times 10^{-5}) + (0.25) \\times (-1.6 \\times 10^{-5})\n$$\n$$\n\\alpha_{F} + \\eta\\alpha_{M} = -3.6 \\times 10^{-5} - 0.4 \\times 10^{-5} = -4.0 \\times 10^{-5}~\\text{K}^{-1}\n$$\nNow, we can compute $\\Delta T_{F}^{\\star}$:\n$$\n\\Delta T_{F}^{\\star} = \\frac{-1.5 \\times 10^{-3}}{-4.0 \\times 10^{-5}~\\text{K}^{-1}} = \\frac{1.5}{4.0} \\times 10^{2}~\\text{K}\n$$\n$$\n\\Delta T_{F}^{\\star} = 0.375 \\times 100~\\text{K} = 37.5~\\text{K}\n$$\nThe problem requires rounding the final answer to four significant figures. Therefore, the fuel temperature rise is $37.50~\\text{K}$.",
            "answer": "$$\\boxed{37.50}$$"
        },
        {
            "introduction": "This final practice advances from lumped-parameter models to the domain of computational reactor physics, where feedback effects are spatially distributed. You are tasked with developing a numerical solver for the one-dimensional neutron diffusion equation to investigate the void reactivity feedback, a key phenomenon in boiling water reactors. By simulating how different spatial distributions of steam voids affect the material properties and neutron balance, you will calculate the net change in core reactivity . This hands-on simulation develops essential skills in applying numerical methods to practical reactor analysis problems.",
            "id": "4244436",
            "problem": "You are asked to compute the net reactivity change induced by spatially varying void fraction in a one-dimensional reactor channel using the one-speed diffusion approximation. Begin from the steady-state neutron balance and Fick’s law as the fundamental base, and derive the discrete mathematical model that leads to a generalized eigenvalue problem for the effective multiplication factor. All quantities must be treated symbolically and mathematically, with explicit physical units where appropriate. Your final program must solve the generalized eigenvalue problem numerically for a set of prescribed void fraction profiles and output the net reactivity change for each case in a single line.\n\nThe fundamental base is the steady-state, one-speed neutron diffusion equation in one spatial dimension with vacuum boundary conditions. Using the neutron continuity equation and Fick’s law, the flux satisfies\n$$\n-\\frac{d}{dx}\\left(D(x)\\,\\frac{d\\phi(x)}{dx}\\right) + \\Sigma_a(x)\\,\\phi(x) \\;=\\; \\frac{1}{k}\\,\\nu\\Sigma_f(x)\\,\\phi(x),\n$$\nfor spatial coordinate $x$ in a slab domain $[0,L]$, where $D(x)$ is the diffusion coefficient in $\\mathrm{cm}$, $\\Sigma_a(x)$ is the macroscopic absorption cross section in $\\mathrm{cm}^{-1}$, $\\nu\\Sigma_f(x)$ is the macroscopic neutron production (neutron yield per fission times macroscopic fission cross section) in $\\mathrm{cm}^{-1}$, $\\phi(x)$ is the neutron flux in arbitrary units, and $k$ is the effective multiplication factor (dimensionless). Impose vacuum (zero flux) boundary conditions, $\\phi(0)=0$ and $\\phi(L)=0$, which approximate net neutron leakage at the channel ends in a way that is scientifically sound for a channel segment analysis.\n\nThe void fraction $\\alpha(x)$ modifies moderation, which in turn changes transport and reaction rates. Model this feedback by allowing the coefficients to depend on $\\alpha(x)$ through the following physically plausible linear relationships:\n$$\nD(\\alpha) \\;=\\; D_0 \\,\\big(1 + d_D \\,\\alpha\\big), \\quad\n\\Sigma_a(\\alpha) \\;=\\; \\Sigma_{a0} \\,\\big(1 + d_a \\,\\alpha\\big), \\quad\n\\nu\\Sigma_f(\\alpha) \\;=\\; \\Sigma_{p0} \\,\\big(1 - d_f \\,\\alpha\\big),\n$$\nwhere $D_0$ is the baseline diffusion coefficient in $\\mathrm{cm}$, $\\Sigma_{a0}$ is the baseline absorption cross section in $\\mathrm{cm}^{-1}$, $\\Sigma_{p0}$ is the baseline neutron production cross section in $\\mathrm{cm}^{-1}$ (equal to $\\nu\\Sigma_{f0}$), and $d_D$, $d_a$, $d_f$ are dimensionless sensitivities encoding moderation feedback. Assume $0 \\le \\alpha(x) \\le 1$ and parameters such that $D(\\alpha)0$, $\\Sigma_a(\\alpha)0$, and $\\nu\\Sigma_f(\\alpha)0$.\n\nTo solve, discretize the interval $[0,L]$ into $N$ interior points with spacing $\\Delta x = L/(N+1)$ and impose the vacuum boundary conditions $\\phi_0 = 0$ and $\\phi_{N+1} = 0$. Use a conservative finite-difference approximation of the diffusion operator with face-centered coefficients. At interior node $i = 1,\\dots,N$, let $D_i = D(\\alpha_i)$ and define face coefficients $D_{i+\\frac{1}{2}} = \\frac{1}{2}\\big(D_i + D_{i+1}\\big)$ and $D_{i-\\frac{1}{2}} = \\frac{1}{2}\\big(D_{i-1} + D_i\\big)$. The discrete balance at node $i$ becomes\n$$\n\\left[\\frac{D_{i+\\frac{1}{2}} + D_{i-\\frac{1}{2}}}{\\Delta x^2} + \\Sigma_{a,i}\\right]\\phi_i\n\\;-\\; \\frac{D_{i+\\frac{1}{2}}}{\\Delta x^2}\\,\\phi_{i+1}\n\\;-\\; \\frac{D_{i-\\frac{1}{2}}}{\\Delta x^2}\\,\\phi_{i-1}\n\\;=\\; \\frac{1}{k}\\,\\Sigma_{p,i}\\,\\phi_i,\n$$\nwhere $\\Sigma_{a,i} = \\Sigma_a(\\alpha_i)$ and $\\Sigma_{p,i} = \\nu\\Sigma_f(\\alpha_i)$. This yields the generalized symmetric eigenvalue problem\n$$\n\\mathbf{A}\\,\\boldsymbol{\\phi} \\;=\\; \\lambda\\,\\mathbf{F}\\,\\boldsymbol{\\phi}, \\quad \\lambda \\;=\\; \\frac{1}{k},\n$$\nwith $\\mathbf{A}$ a tridiagonal, symmetric, positive-definite matrix representing leakage plus absorption, and $\\mathbf{F}$ a diagonal, positive-definite matrix representing neutron production. The smallest positive eigenvalue $\\lambda$ gives the fundamental mode and thus $k = 1/\\lambda$.\n\nDefine the reactivity as\n$$\n\\rho \\;=\\; \\frac{k - 1}{k},\n$$\nwhich is a dimensionless number. The net reactivity change for a given void fraction profile is\n$$\n\\Delta\\rho \\;=\\; \\rho_{\\text{void}} \\;-\\; \\rho_{\\text{ref}},\n$$\nwhere $\\rho_{\\text{ref}}$ is the reactivity for the reference profile with zero void fraction (that is, $\\alpha(x)=0$ everywhere).\n\nImplement the above formulation and compute $\\Delta\\rho$ for the following test suite. Use the physical units specified for parameters and ensure scientific realism. All lengths must be in $\\mathrm{cm}$, cross sections in $\\mathrm{cm}^{-1}$, and the diffusion coefficient in $\\mathrm{cm}$. The final numerical answers for $\\Delta\\rho$ must be dimensionless decimal numbers. For numerical stability and accuracy, use $N=400$ interior nodes for all cases.\n\nGlobal parameters common to all test cases:\n- Channel length: $L = 100\\,\\mathrm{cm}$.\n- Baseline diffusion coefficient: $D_0 = 1.5\\,\\mathrm{cm}$.\n- Baseline absorption cross section: $\\Sigma_{a0} = 0.08\\,\\mathrm{cm}^{-1}$.\n- Baseline neutron production cross section: $\\Sigma_{p0} = 0.16\\,\\mathrm{cm}^{-1}$.\n- Void sensitivity coefficients: $d_D = 0.3$, $d_a = 0.2$, $d_f = 0.5$.\n\nTest suite of void fraction profiles $\\alpha(x)$ on $[0,L]$:\n1. Case A (reference): Uniform zero void, $\\alpha(x) = 0$ for all $x$.\n2. Case B (uniform void): $\\alpha(x) = 0.3$ for all $x$.\n3. Case C (linear gradient): $\\alpha(x) = 0.6\\,x/L$.\n4. Case D (step profile): $\\alpha(x) = 0$ for $0 \\le x  L/2$, and $\\alpha(x) = 0.6$ for $L/2 \\le x \\le L$.\n5. Case E (high uniform void): $\\alpha(x) = 0.8$ for all $x$.\n\nFor each case, compute $k_{\\text{void}}$, $\\rho_{\\text{void}}$, and then $\\Delta\\rho$ relative to Case A. Your program should produce a single line of output containing the net reactivity changes for Cases A through E as a comma-separated list enclosed in square brackets. Express each $\\Delta\\rho$ as a decimal number rounded to six digits after the decimal point. For example, an output format like “[0.000000,-0.012345, ...]” is required, with no additional text.",
            "solution": "The derivation begins from the steady-state neutron balance and the constitutive relation for diffusive transport. The neutron continuity equation for a single energy group in steady state equates absorption plus leakage to neutron production from fission. Using Fick’s law, the neutron current density is $J(x) = -D(x)\\,\\frac{d\\phi}{dx}$, and the leakage term is $-\\frac{dJ}{dx} = -\\frac{d}{dx}\\left(D(x)\\,\\frac{d\\phi}{dx}\\right)$. Combining these with macroscopic absorption $\\Sigma_a(x)$ and neutron production $\\nu\\Sigma_f(x)$ yields the one-speed diffusion equation\n$$\n-\\frac{d}{dx}\\left(D(x)\\,\\frac{d\\phi(x)}{dx}\\right) + \\Sigma_a(x)\\,\\phi(x) \\;=\\; \\frac{1}{k}\\,\\nu\\Sigma_f(x)\\,\\phi(x),\n$$\nwith boundary conditions $\\phi(0) = 0$ and $\\phi(L) = 0$, representing vacuum boundaries. This formulation is a consequence of conservation of neutrons and the well-tested approximation that spatial transport can be modeled by diffusion when scattering dominates.\n\nReactivity feedback from void fraction $\\alpha(x)$ enters through moderation changes that alter transport and reaction coefficients. Void reduces moderation, typically increasing the transport mean free path (and thus $D$), increasing effective resonance absorption (modeled as increased $\\Sigma_a$), and decreasing thermal fission probability (modeled as decreased $\\nu\\Sigma_f$). A linearized dependence captures first-order feedback effects:\n$$\nD(\\alpha) = D_0 (1 + d_D \\alpha), \\quad \\Sigma_a(\\alpha) = \\Sigma_{a0} (1 + d_a \\alpha), \\quad \\nu\\Sigma_f(\\alpha) = \\Sigma_{p0} (1 - d_f \\alpha),\n$$\nwith $D_00$, $\\Sigma_{a0}0$, $\\Sigma_{p0}0$, and $d_D, d_a, d_f$ dimensionless. Provided $0 \\le \\alpha \\le 1$ and $d_f$ is not so large as to drive $\\nu\\Sigma_f$ to zero or negative, these choices keep the operators positive and physically meaningful.\n\nTo compute $k$ numerically, discretize the slab $[0,L]$ with $N$ interior points, spacing $\\Delta x = L/(N+1)$, and index interior nodes by $i=1,\\dots,N$ at positions $x_i = i\\,\\Delta x$. Enforce vacuum boundaries by fixing $\\phi_0 = 0$ and $\\phi_{N+1} = 0$. Approximate the flux gradient at faces with centered differences and define face-centered diffusion coefficients by arithmetic averaging:\n$$\nD_{i+\\frac{1}{2}} = \\frac{D_i + D_{i+1}}{2}, \\quad D_{i-\\frac{1}{2}} = \\frac{D_{i-1} + D_i}{2}.\n$$\nThe conservative finite-difference form of the leakage term at node $i$ is\n$$\n-\\frac{1}{\\Delta x}\\left[J_{i+\\frac{1}{2}} - J_{i-\\frac{1}{2}}\\right] \\approx \\frac{D_{i+\\frac{1}{2}}}{\\Delta x^2}\\left(\\phi_{i+1} - \\phi_i\\right) - \\frac{D_{i-\\frac{1}{2}}}{\\Delta x^2}\\left(\\phi_i - \\phi_{i-1}\\right),\n$$\nwith $J_{i+\\frac{1}{2}} \\approx -D_{i+\\frac{1}{2}}\\frac{\\phi_{i+1}-\\phi_i}{\\Delta x}$. Including absorption and production, the discrete balance at node $i$ reads\n$$\n\\left[\\frac{D_{i+\\frac{1}{2}} + D_{i-\\frac{1}{2}}}{\\Delta x^2} + \\Sigma_{a,i}\\right]\\phi_i\n- \\frac{D_{i+\\frac{1}{2}}}{\\Delta x^2}\\phi_{i+1}\n- \\frac{D_{i-\\frac{1}{2}}}{\\Delta x^2}\\phi_{i-1}\n= \\frac{1}{k}\\,\\Sigma_{p,i}\\,\\phi_i,\n$$\nwhere $\\Sigma_{a,i} = \\Sigma_a(\\alpha_i)$ and $\\Sigma_{p,i} = \\nu\\Sigma_f(\\alpha_i)$. Collecting coefficients yields a tridiagonal, symmetric matrix $\\mathbf{A}$ encoding leakage and absorption, and a diagonal matrix $\\mathbf{F}$ encoding production:\n$$\n\\mathbf{A}\\,\\boldsymbol{\\phi} = \\lambda\\,\\mathbf{F}\\,\\boldsymbol{\\phi}, \\quad \\lambda = \\frac{1}{k}.\n$$\nHere, $\\mathbf{A}$ is positive definite under vacuum boundary conditions because the diffusion operator with Dirichlet boundaries is coercive and $\\Sigma_a0$; $\\mathbf{F}$ is positive definite provided $\\Sigma_p0$ everywhere. For symmetric $\\mathbf{A}$ and positive-definite $\\mathbf{F}$, the generalized eigenvalues $\\lambda$ are positive, and the smallest one corresponds to the fundamental mode. Therefore,\n$$\nk_{\\text{eff}} = \\frac{1}{\\lambda_{\\min}}.\n$$\n\nDefine dimensionless reactivity by\n$$\n\\rho = \\frac{k - 1}{k}.\n$$\nFor a void profile, compute $k_{\\text{void}}$ from the generalized eigenvalue problem, then $\\rho_{\\text{void}}$, and compare to the reference reactivity $\\rho_{\\text{ref}}$ obtained with $\\alpha(x)=0$ to form\n$$\n\\Delta\\rho = \\rho_{\\text{void}} - \\rho_{\\text{ref}}.\n$$\n\nAlgorithmic design:\n- Choose $N=400$ to balance accuracy and cost, set $\\Delta x = L/(N+1)$, and sample $\\alpha_i = \\alpha(x_i)$ at interior nodes $x_i=i\\Delta x$.\n- Compute $D_i$, $\\Sigma_{a,i}$, and $\\Sigma_{p,i}$ using the linearized feedback relations and the given global parameters.\n- Build $\\mathbf{A}$ as a tridiagonal sparse matrix with diagonal entries $\\left(D_{i+\\frac{1}{2}} + D_{i-\\frac{1}{2}}\\right)/\\Delta x^2 + \\Sigma_{a,i}$ and off-diagonals $-\\frac{D_{i+\\frac{1}{2}}}{\\Delta x^2}$ and $-\\frac{D_{i-\\frac{1}{2}}}{\\Delta x^2}$, respecting vacuum boundary conditions by omitting extra terms at the ends (since $\\phi_0=\\phi_{N+1}=0$).\n- Build $\\mathbf{F}$ as a diagonal sparse matrix with entries $\\Sigma_{p,i}$.\n- Solve the generalized symmetric eigenproblem for the smallest eigenvalue using a shift-invert strategy: find the eigenvalue of $\\mathbf{A}\\boldsymbol{\\phi}=\\lambda\\mathbf{F}\\boldsymbol{\\phi}$ closest to zero via the parameter $\\sigma=0$, then $k=1/\\lambda$.\n- Compute $\\rho$ and $\\Delta\\rho$ for each case. Round each $\\Delta\\rho$ to six decimal places for output consistency.\n\nNumerical output requirements:\n- All physical inputs use $\\mathrm{cm}$ and $\\mathrm{cm}^{-1}$ as specified; the computed reactivity change $\\Delta\\rho$ is dimensionless.\n- Express the final results as a single line with a comma-separated list enclosed in square brackets, with each value rounded to six decimal places.\n\nThis approach integrates fundamentals (neutron conservation and diffusive transport), realistic feedback modeling via void-modified coefficients, and a mathematically sound discretization leading to a generalized symmetric eigenvalue problem whose principal eigenpair gives the effective multiplication factor. The solution is general and applicable to any modern programming language that can perform sparse linear algebra; the provided implementation uses a scientific computing library to solve the eigenproblem efficiently and accurately.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import diags\nfrom scipy.sparse.linalg import eigsh\n\ndef build_matrices(L, N, D0, Sa0, Sp0, dD, da, df, alpha_profile_func):\n    \"\"\"\n    Build the generalized eigenproblem matrices A and F for the 1D diffusion model.\n\n    Parameters:\n        L (float): Channel length in cm.\n        N (int): Number of interior nodes.\n        D0 (float): Baseline diffusion coefficient (cm).\n        Sa0 (float): Baseline absorption cross section (cm^-1).\n        Sp0 (float): Baseline neutron production cross section (cm^-1) (nu * Sigma_f).\n        dD (float): Sensitivity of D to void (dimensionless).\n        da (float): Sensitivity of Sigma_a to void (dimensionless).\n        df (float): Sensitivity of Sigma_p to void (dimensionless).\n        alpha_profile_func (callable): Function alpha(x) returning void fraction in [0,1].\n\n    Returns:\n        A (scipy.sparse.csr_matrix): Symmetric matrix for leakage+absorption.\n        F (scipy.sparse.csr_matrix): Diagonal matrix for production.\n    \"\"\"\n    dx = L / (N + 1)\n    # Interior node positions\n    x_nodes = np.linspace(dx, L - dx, N)\n    alpha_nodes = alpha_profile_func(x_nodes)\n\n    # Material coefficients at interior nodes\n    D_nodes = D0 * (1.0 + dD * alpha_nodes)\n    Sa_nodes = Sa0 * (1.0 + da * alpha_nodes)\n    Sp_nodes = Sp0 * (1.0 - df * alpha_nodes)\n    \n    # Coefficients at boundaries (x=0 and x=L) for face-centered differences\n    alpha_bcs = alpha_profile_func(np.array([0, L]))\n    D_bcs = D0 * (1.0 + dD * alpha_bcs)\n\n    # Ensure positivity of coefficients\n    eps = 1e-12\n    D_nodes = np.maximum(D_nodes, eps)\n    D_bcs = np.maximum(D_bcs, eps)\n    Sa_nodes = np.maximum(Sa_nodes, eps)\n    Sp_nodes = np.maximum(Sp_nodes, eps)\n\n    # Face coefficients D_{i-1/2} for i=1,...,N\n    D_m = np.empty(N)\n    D_m[0] = 0.5 * (D_bcs[0] + D_nodes[0])      # D_{1/2}\n    D_m[1:] = 0.5 * (D_nodes[:-1] + D_nodes[1:]) # D_{3/2} to D_{N-1/2}\n    \n    # Face coefficients D_{i+1/2} for i=1,...,N\n    D_p = np.empty(N)\n    D_p[:-1] = 0.5 * (D_nodes[:-1] + D_nodes[1:]) # D_{3/2} to D_{N-1/2}\n    D_p[-1] = 0.5 * (D_nodes[-1] + D_bcs[1])   # D_{N+1/2}\n\n    # Construct tridiagonal A matrix\n    main_diag = (D_p + D_m) / (dx * dx) + Sa_nodes\n    # Off-diagonal is -D_{i+1/2} for i=1,...,N-1\n    off_diag = -D_p[:-1] / (dx * dx)\n\n    A = diags(\n        diagonals=[main_diag, off_diag, off_diag],\n        offsets=[0, 1, -1],\n        format=\"csr\"\n    )\n\n    # Production matrix F is diagonal\n    F = diags(Sp_nodes, offsets=0, format=\"csr\")\n\n    return A, F\n\ndef compute_k_eff(A, F):\n    \"\"\"\n    Compute the effective multiplication factor k_eff by solving the generalized\n    symmetric eigenvalue problem A phi = lambda F phi for the smallest eigenvalue lambda,\n    then k = 1 / lambda.\n\n    Uses shift-invert with sigma=0 to target eigenvalues near zero (smallest).\n    \"\"\"\n    vals, vecs = eigsh(A, k=1, M=F, sigma=0.0, which='LM')\n    lam = float(vals[0])\n    k_eff = 1.0 / lam\n    return k_eff\n\ndef reactivity(k_eff):\n    \"\"\"\n    Compute dimensionless reactivity rho = (k - 1) / k.\n    \"\"\"\n    return (k_eff - 1.0) / k_eff\n\ndef solve():\n    # Global parameters\n    L = 100.0         # cm\n    N = 400           # interior nodes\n    D0 = 1.5          # cm\n    Sa0 = 0.08        # cm^-1\n    Sp0 = 0.16        # cm^-1  (nu * Sigma_f)\n    dD = 0.3          # dimensionless\n    da = 0.2          # dimensionless\n    df = 0.5          # dimensionless\n\n    # Define void fraction profile functions for each test case\n    def alpha_case_A(x):\n        return np.zeros_like(x)\n\n    def alpha_case_B(x):\n        return np.full_like(x, 0.3)\n\n    def alpha_case_C(x):\n        return 0.6 * (x / L)\n\n    def alpha_case_D(x):\n        alpha = np.zeros_like(x)\n        alpha[x >= (L / 2.0)] = 0.6\n        return alpha\n\n    def alpha_case_E(x):\n        return np.full_like(x, 0.8)\n\n    # List of test cases\n    test_cases = [\n        alpha_case_A,\n        alpha_case_B,\n        alpha_case_C,\n        alpha_case_D,\n        alpha_case_E\n    ]\n\n    # Compute reference reactivity (Case A)\n    A_ref, F_ref = build_matrices(L, N, D0, Sa0, Sp0, dD, da, df, alpha_case_A)\n    k_ref = compute_k_eff(A_ref, F_ref)\n    rho_ref = reactivity(k_ref)\n\n    results = []\n    for alpha_func in test_cases:\n        A_mat, F_mat = build_matrices(L, N, D0, Sa0, Sp0, dD, da, df, alpha_func)\n        k_void = compute_k_eff(A_mat, F_mat)\n        rho_void = reactivity(k_void)\n        delta_rho = rho_void - rho_ref\n        results.append(f\"{delta_rho:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}