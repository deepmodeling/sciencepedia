{
    "hands_on_practices": [
        {
            "introduction": "掌握瞬发跳跃近似的第一步是直接从点动力学方程中推导出其核心关系。这个练习将指导您完成这一基本推导，展示中子密度如何在反应性阶跃变化后瞬时调整。通过验证在没有反应性变化时模型能退化为恒等情况，我们还能建立对该近似内部一致性的信心。",
            "id": "4243374",
            "problem": "考虑一个空间均匀的反应堆，其由包含 $m$ 个缓发中子群且无外部中子源的点堆动力学方程描述。令中子密度为 $n(t)$，有效缓发中子份额为 $\\beta=\\sum_{i=1}^{m}\\beta_{i}$，有效瞬发中子代时间为 $\\Lambda$，第 $i$ 群的缓发中子先驱核浓度为 $C_{i}(t)$，其衰变常数为 $\\lambda_{i}$。控制方程为\n$$\\Lambda\\,\\frac{dn}{dt}=\\left(\\rho(t)-\\beta\\right)n(t)+\\Lambda\\sum_{i=1}^{m}\\lambda_{i}C_{i}(t),$$\n$$\\frac{dC_{i}}{dt}=\\frac{\\beta_{i}}{\\Lambda}\\,n(t)-\\lambda_{i}C_{i}(t),\\quad i=1,\\dots,m,$$\n其中 $\\rho(t)$ 是反应性。在 $t=0$ 时，引入一个阶跃反应性变化，从 $\\rho(0^{-})=\\rho_{0}$ 变为 $\\rho(0^{+})=\\rho_{1}$。假设瞬发跳跃近似：在阶跃的无穷小时间间隔内，缓发中子先驱核是连续的，即 $C_{i}(0^{+})=C_{i}(0^{-})$，并且它们的源项 $\\sum_{i=1}^{m}\\lambda_{i}C_{i}(t)$ 在跳跃期间不发生变化；瞬发中子时间尺度 $\\Lambda$ 足够小，以至于中子密度几乎瞬时调整，以维持中子平衡方程右侧的有限性。\n\n从点堆动力学方程和仅有的这些假设出发，推导比值 $J=\\frac{n(0^{+})}{n(0^{-})}$ 关于 $\\rho_{0}$、$\\rho_{1}$ 和 $\\beta$ 的解析表达式。\n\n然后，使用您推导的表达式，在 $\\rho_{1}=\\rho_{0}$ 的特殊情况下计算 $J$ 的值。将 $J$ 的最终值表示为一个单一的数字。不需要四舍五入，也不涉及单位。",
            "solution": "出发点是空间均匀反应堆的点堆动力学模型。中子平衡方程为\n$$\\Lambda\\,\\frac{dn}{dt}=\\left(\\rho(t)-\\beta\\right)n(t)+\\Lambda\\sum_{i=1}^{m}\\lambda_{i}C_{i}(t).$$\n先驱核平衡方程为\n$$\\frac{dC_{i}}{dt}=\\frac{\\beta_{i}}{\\Lambda}\\,n(t)-\\lambda_{i}C_{i}(t),\\quad i=1,\\dots,m.$$\n\n在 $t=0$ 时，反应性从 $\\rho_{0}$ 瞬时变为 $\\rho_{1}$。在这个无穷小的时间间隔内，缓发中子先驱核不能发生不连续的变化，因为它们的演化由具有有限系数的一阶常微分方程控制；因此，\n$$C_{i}(0^{+})=C_{i}(0^{-}),\\quad i=1,\\dots,m.$$\n因此，缓发中子源\n$$S_{d}(t)\\equiv\\sum_{i=1}^{m}\\lambda_{i}C_{i}(t)$$\n在 $t=0$ 时是连续的，所以\n$$S_{d}(0^{+})=S_{d}(0^{-}).$$\n\n在瞬发跳跃近似下，瞬发中子时间尺度 $\\Lambda$ 极小。这意味着中子密度 $n(t)$ 会瞬时调整以达到一个新的准静态平衡，在该平衡点，$\\Lambda\\frac{dn}{dt}$ 项可以忽略不计。因此，在阶跃前后的瞬间（$t=0^-$ 和 $t=0^+$），中子平衡方程的右侧都近似为零。\n在 $t=0^-$: $(\\rho_0 - \\beta)n(0^-) + \\Lambda S_d(0^-) \\approx 0$\n在 $t=0^+$: $(\\rho_1 - \\beta)n(0^+) + \\Lambda S_d(0^+) \\approx 0$\n\n从这两个关系式中，我们可以分别表示缓发中子源项：\n$\\Lambda S_d(0^-) \\approx (\\beta - \\rho_0)n(0^-)$\n$\\Lambda S_d(0^+) \\approx (\\beta - \\rho_1)n(0^+)$\n\n由于缓发中子源是连续的（$S_d(0^+) = S_d(0^-)$），我们可以令上述两式的右侧相等：\n$$(\\beta - \\rho_0)n(0^-) = (\\beta - \\rho_1)n(0^+)$$\n整理后得到瞬发跳跃因子 $J$：\n$$J\\equiv\\frac{n(0^{+})}{n(0^{-})}=\\frac{\\beta-\\rho_0}{\\beta-\\rho_1}.$$\n该结果可以等效地写为：\n$$J = \\frac{\\rho_0-\\beta}{\\rho_1-\\beta}.$$\n\n现在考虑 $\\rho_{1}=\\rho_{0}$ 的特殊情况。将此代入 $J$ 的表达式，得到\n$$J=\\frac{\\rho_{0}-\\beta}{\\rho_{0}-\\beta}=1.$$\n\n这个结果表明，如果没有反应性变化，瞬发跳跃因子等于1，且 $n(0^{+})=n(0^{-})$。这是一个关键的内部一致性检验：在没有扰动的情况下，推导出的跳跃条件简化为恒等式，从而验证了当 $\\rho_{1}=\\rho_{0}$ 时，该跳跃条件不会引入虚假的间断。它证实了该近似符合物理预期，即在增殖特性（反应性）没有变化的情况下，中子密度不会发生瞬时变化。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "瞬发跳跃近似的真正威力在于它能够预测反应堆其他物理量的瞬时响应。本练习将动力学与集总参数热工模型相结合，探讨中子密度的瞬时跳跃如何立即影响燃料温度的变化率。通过求解燃料温度的初始变化率，您将体会到该近似在多物理场耦合问题和安全分析中的实用价值。",
            "id": "4243339",
            "problem": "考虑一个空间均匀的反应堆，其模型为具有 $m$ 组缓发中子的点堆动力学模型，该模型耦合到一个单节点（集总）燃料热容。中子布居动力学由点堆动力学方程控制：\n$$\n\\frac{dn(t)}{dt}=\\frac{\\rho(t)-\\beta}{\\Lambda}\\,n(t)+\\sum_{i=1}^{m}\\lambda_i C_i(t),\\qquad\n\\frac{dC_i(t)}{dt}=\\frac{\\beta_i}{\\Lambda}\\,n(t)-\\lambda_i C_i(t),\n$$\n其中 $n(t)$ 是中子密度，$C_i(t)$ 是第 $i$ 组缓发中子先驱核的浓度，$\\rho(t)$ 是反应性，$\\Lambda$ 是瞬发中子代时间，$\\beta_i$ 和 $\\lambda_i$ 分别是第 $i$ 组的缓发中子份额和衰变常数，而 $\\beta=\\sum_{i=1}^{m}\\beta_i$ 是总缓发中子份额。集总燃料的热能平衡方程为：\n$$\nC_F\\frac{dT_F(t)}{dt}=P(t)-H\\left(T_F(t)-T_C\\right),\n$$\n其中 $T_F(t)$ 是平均燃料温度，$C_F$ 是燃料集总热容，$H$ 是在瞬发时间尺度上，向固定温度 $T_C$ 的冷却剂的有效总传热系数，$P(t)$ 是总裂变功率。假设在瞬发时间尺度上，总功率与中子密度成正比，$P(t)=\\kappa\\,n(t)$，其中比例常数 $\\kappa>0$。\n\n该反应堆在 $t<0$ 时初始处于稳定临界运行状态，此时 $\\rho(t)=0$, $n(t)=n_0$, $C_i(t)=C_{i0}$, $T_F(t)=T_{F0}$, 且 $P(t)=P_0=\\kappa n_0$。初始时处于热稳态，因此 $H\\left(T_{F0}-T_C\\right)=P_0$。在 $t=0$ 时，引入一个空间均匀、大小为 $\\rho_s$ 的瞬时阶跃反应性，且 $|\\rho_s| < \\beta$。在瞬发时间尺度上，冷却剂温度 $T_C$ 和先驱核浓度 $C_i$ 不能发生不连续变化。\n\n以点堆动力学方程和燃料能量平衡方程为基本出发点，推导在阶跃之后瞬间燃料温度的初始变化率 $\\dot{T}_F(0^+)$ 的闭式解析表达式，该表达式应以 $\\rho_s$、$\\beta$、$C_F$ 和 $P_0$ 表示。清晰地陈述并证明所使用的、与瞬发跳跃近似一致的任何近似方法。\n\n请以 $\\mathrm{K\\,s^{-1}}$ 为单位表示您的最终答案。不要将答案保留为不等式或待解方程的形式；请提供一个单一的解析表达式。",
            "solution": "### 解答推导\n\n问题的核心在于应用瞬发跳跃近似来确定在 $t=0$ 时阶跃反应性引入后瞬间的反应堆状态。\n\n**1. 初始稳态 ($t=0^-$)**\n\n对于 $t<0$，反应堆处于临界稳态。所有时间导数均为零，且反应性 $\\rho(t)=0$。\n根据先驱核平衡方程：\n$$\n\\frac{dC_i}{dt}=0 \\implies \\frac{\\beta_i}{\\Lambda}n_0 - \\lambda_i C_{i0} = 0 \\implies \\lambda_i C_{i0} = \\frac{\\beta_i}{\\Lambda}n_0\n$$\n对所有 $m$ 个先驱核群求和：\n$$\n\\sum_{i=1}^{m} \\lambda_i C_{i0} = \\sum_{i=1}^{m} \\frac{\\beta_i}{\\Lambda}n_0 = \\frac{n_0}{\\Lambda} \\sum_{i=1}^{m} \\beta_i = \\frac{\\beta}{\\Lambda}n_0\n$$\n这个结果与稳态时的中子平衡方程一致：\n$$\n\\frac{dn}{dt}=0 \\implies \\frac{0-\\beta}{\\Lambda}n_0 + \\sum_{i=1}^{m}\\lambda_i C_{i0} = 0 \\implies \\sum_{i=1}^{m}\\lambda_i C_{i0} = \\frac{\\beta}{\\Lambda}n_0\n$$\n根据稳态时的热平衡方程：\n$$\n\\frac{dT_F}{dt}=0 \\implies P_0 - H(T_{F0}-T_C) = 0 \\implies H(T_{F0}-T_C) = P_0\n$$\n\n**2. 反应性引入后的瞬时状态 ($t=0^+$)**\n\n在 $t=0$ 时，引入一个阶跃反应性 $\\rho_s$，因此对于 $t \\ge 0$ 有 $\\rho(t)=\\rho_s$。瞬发中子代时间 $\\Lambda$ 极小（通常为 $10^{-7}$ 到 $10^{-4}\\,\\mathrm{s}$）。这种时间尺度上的差异允许使用瞬发跳跃近似 (PJA)。PJA 指出，中子布居 $n(t)$ 会几乎瞬时地调整到一个新的准平衡水平，其时间尺度远快于慢得多的先驱核浓度或燃料温度的变化。\n\n因此，我们可以陈述：\n- 先驱核浓度是连续的：$C_i(0^+) = C_i(0^-) = C_{i0}$。\n- 燃料温度是连续的：$T_F(0^+) = T_F(0^-) = T_{F0}$。\n\n对于 $t > 0$ 的中子动力学方程为：\n$$\n\\frac{dn(t)}{dt} = \\frac{\\rho_s-\\beta}{\\Lambda}n(t) + \\sum_{i=1}^{m}\\lambda_i C_i(t)\n$$\n在 $t=0^+$ 瞬间，利用先驱核的连续性，源项为：\n$$\n\\sum_{i=1}^{m}\\lambda_i C_i(0^+) = \\sum_{i=1}^{m}\\lambda_i C_{i0} = \\frac{\\beta}{\\Lambda}n_0\n$$\n将此代入 $t=0^+$ 时的动力学方程：\n$$\n\\frac{dn(t)}{dt}\\bigg|_{t=0^+} = \\frac{\\rho_s-\\beta}{\\Lambda}n(0^+) + \\frac{\\beta}{\\Lambda}n_0\n$$\nPJA 的形式化基础是考虑 $\\Lambda \\to 0$ 的极限情况。在此极限下，为了使导数 $\\frac{dn}{dt}$ 保持有限，右侧乘以 $1/\\Lambda$ 的项必须相互抵消。这意味着中子布居 $n(t)$ “跳跃”到一个使右侧为零的值 $n(0^+)$。\n$$\n0 = (\\rho_s-\\beta)n(0^+) + \\beta n_0\n$$\n求解跳跃后的中子密度 $n(0^+)$：\n$$\n(\\beta-\\rho_s)n(0^+) = \\beta n_0 \\implies n(0^+) = \\frac{\\beta}{\\beta-\\rho_s} n_0\n$$\n问题陈述了 $|\\rho_s| < \\beta$，这确保了分母非零且为正，从而在跳跃后得到一个有限的正中子布居。\n\n功率水平与中子密度成正比，$P(t) = \\kappa n(t)$。跳跃后瞬间的功率水平是：\n$$\nP(0^+) = \\kappa n(0^+) = \\kappa \\left(\\frac{\\beta}{\\beta-\\rho_s} n_0\\right) = \\left(\\frac{\\beta}{\\beta-\\rho_s}\\right) (\\kappa n_0) = \\frac{\\beta}{\\beta-\\rho_s} P_0\n$$\n\n**3. 燃料温度的初始变化率**\n\n我们现在评估 $t=0^+$ 时的燃料热能平衡，以求得温度的初始变化率 $\\dot{T}_F(0^+)$。\n$$\nC_F\\frac{dT_F(t)}{dt}\\bigg|_{t=0^+} = P(0^+) - H\\left(T_F(0^+) - T_C\\right)\n$$\n我们代入右侧的各项：\n- 跳跃后的功率为 $P(0^+) = \\frac{\\beta}{\\beta-\\rho_s} P_0$。\n- 由于热惯性，燃料温度是连续的，所以 $T_F(0^+) = T_{F0}$。\n- 因此，热移除项为 $H(T_F(0^+) - T_C) = H(T_{F0} - T_C)$。根据初始稳态条件，这等于初始功率 $P_0$。\n\n将这些代入能量平衡方程：\n$$\nC_F \\dot{T}_F(0^+) = \\frac{\\beta}{\\beta-\\rho_s} P_0 - P_0\n$$\n提出公因子 $P_0$：\n$$\nC_F \\dot{T}_F(0^+) = P_0 \\left(\\frac{\\beta}{\\beta-\\rho_s} - 1\\right)\n$$\n$$\nC_F \\dot{T}_F(0^+) = P_0 \\left(\\frac{\\beta - (\\beta-\\rho_s)}{\\beta-\\rho_s}\\right)\n$$\n$$\nC_F \\dot{T}_F(0^+) = P_0 \\left(\\frac{\\rho_s}{\\beta-\\rho_s}\\right)\n$$\n最后，求解燃料温度的初始变化率 $\\dot{T}_F(0^+)$：\n$$\n\\dot{T}_F(0^+) = \\frac{P_0}{C_F} \\frac{\\rho_s}{\\beta-\\rho_s}\n$$\n该表达式给出了燃料温度的初始变化率，用初始功率 $P_0$、燃料热容 $C_F$、引入的反应性 $\\rho_s$ 和总缓发中子份额 $\\beta$ 表示，符合题目要求。单位是一致的：$P_0$ 的单位是 $[\\mathrm{J}\\,\\mathrm{s}^{-1}]$，$C_F$ 的单位是 $[\\mathrm{J}\\,\\mathrm{K}^{-1}]$，而 $\\rho_s, \\beta$ 是无量纲的，从而得到 $\\dot{T}_F(0^+)$ 的单位为 $[\\mathrm{K}\\,\\mathrm{s}^{-1}]$。",
            "answer": "$$\\boxed{\\frac{P_0 \\rho_s}{C_F (\\beta - \\rho_s)}}$$"
        },
        {
            "introduction": "将理论模型转化为可靠的计算工具是反应堆模拟的核心技能。这个综合练习要求您将瞬发跳跃的解析公式实现为一个事件处理算法，这是数值求解器中处理反应性阶跃变化的标准方法。通过设计和测试这一算法，您将掌握在模拟中精确捕捉反应堆快速瞬态行为的关键技术。",
            "id": "4256423",
            "problem": "反应堆点模型由点堆动力学方程控制，这些方程在零维近似下表达了中子平衡和先驱核动力学。令 $n(t)$ 表示中子密度，令 $C_i(t)$ 表示第 $i$ 组的缓发中子先驱核浓度，其中 $i = 1,2,\\dots,G$。令 $\\rho(t)$ 为反应性，$\\beta_i$ 为第 $i$ 组的缓发中子份额，$\\beta = \\sum_{i=1}^G \\beta_i$ 为总缓发中子份额，$\\lambda_i$ 为第 $i$ 组的衰变常数，$\\Lambda$ 为瞬发中子代时间。点堆动力学方程，表示为一个常微分方程 (ODE) 组，如下所示：\n$$\\frac{dn}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda}\\,n(t) + \\sum_{i=1}^G \\lambda_i\\,C_i(t),$$\n$$\\frac{dC_i}{dt} = \\frac{\\beta_i}{\\Lambda}\\,n(t) - \\lambda_i\\,C_i(t), \\quad i=1,\\dots,G.$$\n考虑在时间 $t_0$ 发生一次阶跃反应性引入，其中\n$$\\rho(t) = \\begin{cases}\n\\rho_0, & t < t_0,\\\\\n\\rho_1, & t \\ge t_0.\n\\end{cases}$$\n假设没有外部源，并且所有量均采用国际单位制 (SI)，时间单位为秒。\n\n您的任务包含两个部分：\n1. 仅从上述方程和 $C_i(t)$ 在 $t_0$ 处保持连续的物理要求出发，推导 $n(t)$ 在 $t_0$ 处的瞬时更新规则，该规则能捕捉由 $\\rho(t)$ 的阶跃变化引起的瞬发跳变。推导过程必须说明为什么该更新能保持有限的 $\\frac{dn}{dt}$，并且必须严格证明 $C_i(t)$ 在事件发生时间的连续性。\n2. 在一个程序中实现一个事件处理策略，该策略在给定事件前瞬间的 $n(t_0^-)$ 和 $C_i(t_0^-)$ 的情况下，瞬时更新 $n(t_0^+)$，同时设置 $C_i(t_0^+) = C_i(t_0^-)$，从而保持 $C_i(t)$ 的连续性。\n\n使用以下适用于 Uranium-235 中热中子诱发裂变的科学真实参数集：\n- 缓发中子组数 $G$：$6$。\n- 各组缓发中子份额 $\\beta_i$：$[0.000215,\\,0.001424,\\,0.001274,\\,0.002568,\\,0.000748,\\,0.000273]$ (无量纲)。\n- 衰变常数 $\\lambda_i$ (单位 $\\mathrm{s}^{-1}$)：$[0.0124,\\,0.0305,\\,0.111,\\,0.301,\\,1.14,\\,3.01]$。\n- 瞬发中子代时间 $\\Lambda$ (单位 $\\mathrm{s}$)：$1.0\\times 10^{-5}$。\n- 事件时间 $t_0$ (单位 $\\mathrm{s}$)：$1.0$。\n- 事件前反应性 $\\rho_0$：$0.0$ (临界)。\n- 事件前中子密度 $n(t_0^-)$：$1.0$ (任意标度)。\n- 临界稳态下事件前的先驱核浓度：$C_i(t_0^-)=\\frac{\\beta_i}{\\Lambda \\lambda_i} n(t_0^-)$。\n\n设计一个测试套件，用于评估您针对四种不同的阶跃反应性引入 $\\rho_1$ 的事件处理更新：\n- 情况 A (正常情况，正阶跃，次瞬发临界)：$\\rho_1 = 0.0025$。\n- 情况 B (负阶跃)：$\\rho_1 = -0.0030$。\n- 情况 C (无变化)：$\\rho_1 = 0.0$。\n- 情况 D (从下方接近瞬发临界边界)：$\\rho_1 = \\beta - 10^{-5}$。\n\n对于每种情况，计算两个浮点数：\n- 您实现的 $n(t_0^+)/n(t_0^-)$ 比率与从您的推导中解析得出的比率之间的绝对误差。\n- 事件前后先驱核向量的最大绝对不连续性，$\\max_i |C_i(t_0^+) - C_i(t_0^-)|$，其单位与 $C_i$ 相同，但由于所选标度，数值上是无量纲的。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表 (例如 $[r_1,d_1,r_2,d_2,r_3,d_3,r_4,d_4]$)，其中 $r_k$ 是情况 $k$ 的中子密度比率的绝对误差，$d_k$ 是情况 $k$ 的最大先驱核不连续性。所有输出均为浮点数。不需要用户输入；程序必须能按原样运行。",
            "solution": "### 第一部分：瞬时更新规则的推导\n\n分析始于中子密度 $n(t)$ 和 $G$ 组缓发中子先驱核浓度 $C_i(t)$（其中 $i=1, \\dots, G$）的点堆动力学方程：\n$$ \\frac{dn}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda}\\,n(t) + \\sum_{i=1}^G \\lambda_i\\,C_i(t) \\quad (1) $$\n$$ \\frac{dC_i}{dt} = \\frac{\\beta_i}{\\Lambda}\\,n(t) - \\lambda_i\\,C_i(t) \\quad (2) $$\n其中 $\\rho(t)$ 是反应性，$\\beta_i$ 是第 $i$ 组的缓发中子份额，$\\beta = \\sum_{i=1}^G \\beta_i$ 是总缓发中子份额，$\\lambda_i$ 是第 $i$ 组的衰变常数，$\\Lambda$ 是瞬发中子代时间。反应性在时间 $t_0$ 发生从 $\\rho_0$ 到 $\\rho_1$ 的阶跃变化。\n\n#### 先驱核浓度连续性的证明\n\n物理量 $n(t)$ 和 $C_i(t)$ 必须保持有限。方程 $(2)$ 的右侧是导数 $\\frac{dC_i}{dt}$，它由本身有限的项组成。即使 $n(t)$ 在 $t_0$ 处经历一个有限的跳跃不连续性，$\\frac{\\beta_i}{\\Lambda}n(t)$ 和 $\\lambda_i C_i(t)$ 这两项仍然是时间的有界函数。因此，导数 $\\frac{dC_i}{dt}$ 在所有时间 $t$ 都是有界的。\n\n一个导数有界的函数不能有跳跃不连续性。为了正式证明这一点，我们将方程 $(2)$ 在一个无穷小时间间隔 $[t_0 - \\epsilon, t_0 + \\epsilon]$ 上积分，并取 $\\epsilon \\to 0^+$ 的极限：\n$$ C_i(t_0^+) - C_i(t_0^-) = \\lim_{\\epsilon \\to 0^+} \\int_{t_0-\\epsilon}^{t_0+\\epsilon} \\frac{dC_i}{dt} dt = \\lim_{\\epsilon \\to 0^+} \\int_{t_0-\\epsilon}^{t_0+\\epsilon} \\left( \\frac{\\beta_i}{\\Lambda}n(t) - \\lambda_i C_i(t) \\right) dt $$\n由于被积函数是一个有界函数，其在长度趋于零的区间 ($2\\epsilon$) 上的积分必须为零。因此：\n$$ C_i(t_0^+) - C_i(t_0^-) = 0 \\implies C_i(t_0^+) = C_i(t_0^-) $$\n这证明了先驱核浓度 $C_i(t)$ 在 $t_0$ 事件发生时是连续的。从物理上讲，先驱核浓度是代表原子核物理数量的状态变量，它们不能瞬时改变。\n\n#### 中子密度瞬发跳变近似的推导\n\n瞬发中子代时间 $\\Lambda$ 是一个非常小的参数，通常在 $10^{-5}\\,\\mathrm{s}$ 或更小的量级。这使得方程 $(1)$ 中的 $1/\\Lambda$ 项非常大，表明这是一个具有相差悬殊的时间尺度的“刚性”系统。中子布居数 $n(t)$ 是快变数，而先驱核 $C_i(t)$ 是慢变数。\n\n我们可以通过将方程 $(1)$ 乘以 $\\Lambda$ 来重写它：\n$$ \\Lambda \\frac{dn}{dt} = (\\rho(t) - \\beta) n(t) + \\Lambda \\sum_{i=1}^G \\lambda_i C_i(t) \\quad (3) $$\n当 $t < t_0$ 时，反应堆处于临界稳态，$\\rho(t) = \\rho_0 = 0$。在稳态下，所有时间导数均为零。从方程 $(3)$ 可得：\n$$ 0 = (\\rho_0 - \\beta) n(t_0^-) + \\Lambda \\sum_{i=1}^G \\lambda_i C_i(t_0^-) $$\n整理后得到跳变前的总缓发中子源项：\n$$ \\Lambda \\sum_{i=1}^G \\lambda_i C_i(t_0^-) = (\\beta - \\rho_0) n(t_0^-) \\quad (4) $$\n在 $t_0$ 时刻，反应性从 $\\rho_0$ 跳变到 $\\rho_1$。由于 $\\Lambda$ 极小，方程 $(3)$ 右侧各项的任何有限不平衡都会导致一个极大且不符合物理现实（趋于无穷大）的导数 $\\frac{dn}{dt}$。系统通过使快变数 $n(t)$ 瞬时跳变到一个新值 $n(t_0^+)$ 来避免这种情况，这个新值重新建立了一个准平衡，从而确保 $\\frac{dn}{dt}$ 在跳变后立即保持有限。\n\n让我们写出 $t_0^+$ 时刻的方程 $(3)$：\n$$ \\Lambda \\frac{dn}{dt}\\bigg|_{t_0^+} = (\\rho_1 - \\beta) n(t_0^+) + \\Lambda \\sum_{i=1}^G \\lambda_i C_i(t_0^+) $$\n由于先驱核的连续性，我们知道 $C_i(t_0^+) = C_i(t_0^-)$。因此，缓发中子源项也是连续的：$\\Lambda \\sum_i \\lambda_i C_i(t_0^+) = \\Lambda \\sum_i \\lambda_i C_i(t_0^-)$。\n代入方程 $(4)$ 中源的表达式：\n$$ \\Lambda \\frac{dn}{dt}\\bigg|_{t_0^+} = (\\rho_1 - \\beta) n(t_0^+) + (\\beta - \\rho_0) n(t_0^-) $$\n为了在 $\\Lambda \\to 0$ 的极限下保持有限的导数 $\\frac{dn}{dt}\\big|_{t_0^+}$，该方程的右侧必须趋近于零。这是瞬发跳变近似的核心宗旨，它源于奇异摄动理论。将右侧设为零得到：\n$$ 0 = (\\rho_1 - \\beta) n(t_0^+) + (\\beta - \\rho_0) n(t_0^-) $$\n解出 $n(t_0^+)$，得到瞬时更新规则，即瞬发跳变公式：\n$$ n(t_0^+) = n(t_0^-) \\frac{\\beta - \\rho_0}{\\beta - \\rho_1} $$\n这个推导通过强制要求状态变量即使在存在理想化的不连续输入时也以有限的变化率演化，从而严格地证明了该更新规则。\n\n### 第二部分：实现策略\n\n编程任务是实现推导出的事件处理规则，并针对四个测试用例验证其自洽性。实现将使用 Python 和 `numpy` 库完成。\n\n要实现的更新规则是：\n1. 先驱核更新：对所有 $i=1,\\dots,G$，$C_i(t_0^+) = C_i(t_0^-)$。\n2. 中子密度更新：$n(t_0^+) = n(t_0^-) \\frac{\\beta - \\rho_0}{\\beta - \\rho_1}$。\n\n程序的算法如下：\n1. 定义给定的物理参数：$\\beta_i$ (作为数组)、$\\lambda_i$ (作为数组)、$\\Lambda$、$\\rho_0$ 和 $n(t_0^-)$。\n2. 计算总缓发中子份额 $\\beta = \\sum_{i=1}^G \\beta_i$。\n3. 定义最终反应性 $\\rho_1$ 的测试用例列表。\n4. 初始化一个空列表来存储结果。\n5. 遍历 $\\rho_1$ 的每个测试用例值：\n    a. 计算解析推导的比率 $R_{\\text{analytic}} = \\frac{n(t_0^+)}{n(t_0^-)} = \\frac{\\beta - \\rho_0}{\\beta - \\rho_1}$。\n    b. 实现中子密度更新，使用事件前值 $n(t_0^-)$ 和 $R_{\\text{analytic}}$ 来找到事件后值 $n(t_0^+)$。\n    c. 计算实现的比率 $R_{\\text{impl}} = n(t_0^+) / n(t_0^-)$。\n    d. 计算第一个所需指标：比率之间的绝对误差，$r = |R_{\\text{impl}} - R_{\\text{analytic}}|$。这可以验证实现是否正确反映了推导。\n    e. 实现先驱核更新规则 $C_i(t_0^+) = C_i(t_0^-)$。\n    f. 计算第二个所需指标：先驱核向量中的最大绝对不连续性，$d = \\max_i |C_i(t_0^+) - C_i(t_0^-)|$。这可以验证是否遵循了连续性条件。\n    g. 将 $r$ 和 $d$ 附加到结果列表中。\n6. 将结果列表格式化为所需的输出字符串 `[r1,d1,r2,d2,...]` 并打印。\n\n鉴于 $n(t_0^+)$ 的更新实现将直接使用比率的解析公式，而 $C_i(t_0^+)$ 的更新是一个恒等赋值，因此对于所有测试用例，比率误差 $r$ 和先驱核不连续性 $d$ 在浮点运算的精度限制内，预计都将数值上等于 $0.0$。代码将确认这一结果。\n\n初始先驱核浓度 $C_i(t_0^-)$ 由 $\\rho_0=0$ 的稳态条件确定，即 $C_i(t_0^-)=\\frac{\\beta_i}{\\Lambda \\lambda_i} n(t_0^-)$。虽然计算所要求的不连续性（根据更新规则的定义为零）并不严格需要这些值，但它们的计算表明了对初始状态的完全理解。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements the prompt jump approximation for a step reactivity\n    insertion in a point kinetics model, and verifies the implementation.\n    \"\"\"\n\n    # Define the physical parameters for U-235 from the problem statement.\n    beta_i_vals = np.array([0.000215, 0.001424, 0.001274, 0.002568, 0.000748, 0.000273])\n    lambda_i_vals = np.array([0.0124, 0.0305, 0.111, 0.301, 1.14, 3.01])\n    Lambda = 1.0e-5\n    \n    # Pre-event conditions\n    rho_0 = 0.0\n    n_minus = 1.0\n\n    # Calculate total delayed neutron fraction beta, a critical parameter.\n    beta = np.sum(beta_i_vals)\n\n    # Define the test cases for the post-event reactivity rho_1.\n    test_cases = [\n        # Case A: Happy path, positive step, subprompt-critical\n        0.0025,\n        # Case B: Negative step\n        -0.0030,\n        # Case C: No change\n        0.0,\n        # Case D: Near prompt-critical boundary from below\n        beta - 1.0e-5,\n    ]\n\n    results = []\n\n    # Calculate pre-event precursor concentrations from the steady-state critical condition.\n    # C_i(t_0^-) = (beta_i / (Lambda * lambda_i)) * n(t_0^-)\n    # This calculation is for completeness, as the discontinuity is zero by definition.\n    C_minus = (beta_i_vals / (Lambda * lambda_i_vals)) * n_minus\n\n    # Iterate through each test case.\n    for rho_1 in test_cases:\n        #\n        # --- Event Handling Implementation ---\n        #\n\n        # 1. Update rule for precursor concentrations:\n        #    As derived, C_i is continuous, so C_i(t_0^+) = C_i(t_0^-).\n        C_plus = C_minus\n\n        # 2. Update rule for neutron density using the prompt jump approximation:\n        #    n(t_0^+) = n(t_0^-) * (beta - rho_0) / (beta - rho_1)\n        #    First, calculate the analytical ratio derived in the solution.\n        analytic_ratio = (beta - rho_0) / (beta - rho_1)\n        \n        #    Then, apply the update rule to find n(t_0^+).\n        n_plus = n_minus * analytic_ratio\n\n        #\n        # --- Compute Required Metrics ---\n        #\n\n        # Metric 1: Absolute error of the neutron density ratio.\n        # This compares the implemented ratio against the analytically derived one.\n        # Since the implementation directly uses the analytical formula, this\n        # error is expected to be zero (or within machine precision).\n        implemented_ratio = n_plus / n_minus\n        ratio_error = abs(implemented_ratio - analytic_ratio)\n        \n        # Metric 2: Maximum absolute discontinuity in the precursor vector.\n        # This is max|C_i(t_0^+) - C_i(t_0^-)|. Since the update rule is\n        # C_plus = C_minus, this is expected to be exactly zero.\n        precursor_discontinuity = np.max(np.abs(C_plus - C_minus))\n        \n        results.append(ratio_error)\n        results.append(precursor_discontinuity)\n\n    # Final print statement in the exact required format.\n    # The map(str, results) ensures all numbers are converted to strings\n    # for the join operation, producing the desired \"[f1,f2,f3,...]\" format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}