{
    "hands_on_practices": [
        {
            "introduction": "反应堆动力学中最基本的问题之一是：当向系统中引入少量反应性时，功率水平将以多快的速度变化？本练习  让你直接面对这一核心问题，通过求解点动力学模型的特征方程（即“反应时方程”）来量化反应堆的响应。这个计算将清晰地揭示，对于低于缓发中子份额的反应性插入，反应堆的渐近周期是如何由缓发中子的特性所决定的。",
            "id": "4243047",
            "problem": "一个均匀热中子反应堆由具有单有效缓发中子群的点动力学模型建模。在点动力学近似下，总中子数由于瞬发和缓发中子的产生与损失而演变。当在时间 $t=0$ 时引入一个小的阶跃反应性时，中子数呈现出指数模式，其速率由瞬发中子和缓发中子先驱体的耦合平衡决定。\n\n假设反应堆初始处于临界状态，并在 $t=0$ 时施加一个大小为 $\\rho$ 的恒定正反应性。有效总缓发中子份额为 $\\beta$，瞬发中子代时间为 $\\Lambda$，单缓发中子群的有效衰变常数为 $\\lambda$。控制中子数 $n(t)$ 和缓发中子先驱体浓度 $C(t)$ 的常微分方程（ODE）是基于中子平衡和先驱体衰变定律的标准点动力学方程。\n\n给定 $\\beta = 0.0065$，$\\Lambda = 1 \\times 10^{-5}\\,\\mathrm{s}$，$\\lambda = 0.08\\,\\mathrm{s}^{-1}$ 和 $\\rho = 0.004$，从第一性原理推导指数模式的特征方程，并确定中子数的渐近指数增长率 $s$，其定义为长时间下 $n(t) \\propto \\exp(s t)$。将 $s$ 的最终值以 $\\mathrm{s}^{-1}$ 表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题被评估为有效。它在科学上基于成熟的核反应堆动力学点动力学模型，在数学上是适定的，并提供了一套完整且一致的数据来确定唯一解。\n\n反应堆动力学由中子数 $n(t)$ 和单有效缓发中子先驱体群浓度 $C(t)$ 的点动力学方程描述。对于在 $t=0$ 时施加的恒定反应性 $\\rho$，当 $t0$ 时，控制线性常微分方程为：\n$$\n\\frac{dn(t)}{dt} = \\frac{\\rho - \\beta}{\\Lambda} n(t) + \\lambda C(t) \\quad (1)\n$$\n$$\n\\frac{dC(t)}{dt} = \\frac{\\beta}{\\Lambda} n(t) - \\lambda C(t) \\quad (2)\n$$\n此处，$\\beta$ 是有效缓发中子份额，$\\Lambda$ 是瞬发中子代时间，$\\lambda$ 是有效先驱体衰变常数。\n\n为了找到系统的指数模式，我们假设解的形式为 $n(t) = n_0 \\exp(st)$ 和 $C(t) = C_0 \\exp(st)$，其中 $s$ 是逆时间常数，或指数速率，$n_0$ 和 $C_0$ 是振幅。将这些代入方程 (1) 和 (2) 得到一个代数方程组：\n$$\ns n_0 \\exp(st) = \\frac{\\rho - \\beta}{\\Lambda} n_0 \\exp(st) + \\lambda C_0 \\exp(st)\n$$\n$$\ns C_0 \\exp(st) = \\frac{\\beta}{\\Lambda} n_0 \\exp(st) - \\lambda C_0 \\exp(st)\n$$\n对于非平凡解，我们可以除以 $\\exp(st)$：\n$$\ns n_0 = \\frac{\\rho - \\beta}{\\Lambda} n_0 + \\lambda C_0 \\quad (3)\n$$\n$$\ns C_0 = \\frac{\\beta}{\\Lambda} n_0 - \\lambda C_0 \\quad (4)\n$$\n从方程 (4)，我们可以用 $n_0$ 表示振幅 $C_0$：\n$$\nC_0(s + \\lambda) = \\frac{\\beta}{\\Lambda} n_0\n$$\n$$\nC_0 = \\frac{\\beta}{\\Lambda(s + \\lambda)} n_0\n$$\n将 $C_0$ 的这个表达式代入方程 (3)：\n$$\ns n_0 = \\frac{\\rho - \\beta}{\\Lambda} n_0 + \\lambda \\left( \\frac{\\beta}{\\Lambda(s + \\lambda)} n_0 \\right)\n$$\n对于非零中子数 ($n_0 \\neq 0$)，我们除以 $n_0$ 以获得关于 $s$ 的特征方程：\n$$\ns = \\frac{\\rho - \\beta}{\\Lambda} + \\frac{\\lambda \\beta}{\\Lambda(s + \\lambda)}\n$$\n这个方程通常通过求解 $\\rho$ 来重新排列，这给出了反应性方程的标准形式：\n$$\ns\\Lambda = \\rho - \\beta + \\frac{\\lambda\\beta}{s+\\lambda}\n$$\n$$\n\\rho = s\\Lambda + \\beta - \\frac{\\lambda\\beta}{s+\\lambda} = s\\Lambda + \\beta\\left(1 - \\frac{\\lambda}{s+\\lambda}\\right) = s\\Lambda + \\beta\\left(\\frac{s+\\lambda-\\lambda}{s+\\lambda}\\right)\n$$\n$$\n\\rho = s\\Lambda + \\frac{s\\beta}{s+\\lambda}\n$$\n渐近增长率是该方程的主导根（最大、最正的根）。为了求根，我们将方程重新整理成一个关于 $s$ 的多项式：\n$$\n\\rho(s+\\lambda) = s\\Lambda(s+\\lambda) + s\\beta\n$$\n$$\n\\rho s + \\rho\\lambda = s^2\\Lambda + s\\lambda\\Lambda + s\\beta\n$$\n$$\n\\Lambda s^2 + (\\lambda\\Lambda + \\beta - \\rho)s - \\rho\\lambda = 0\n$$\n这是一个形式为 $as^2+bs+c=0$ 的二次方程，其系数为：\n$a = \\Lambda$\n$b = \\lambda\\Lambda + \\beta - \\rho$\n$c = -\\rho\\lambda$\n\n根由二次公式给出。渐近增长率对应于较大的根（在分子中使用 `+` 号）：\n$$\ns = \\frac{-b + \\sqrt{b^2 - 4ac}}{2a} = \\frac{-(\\lambda\\Lambda + \\beta - \\rho) + \\sqrt{(\\lambda\\Lambda + \\beta - \\rho)^2 + 4\\Lambda\\rho\\lambda}}{2\\Lambda}\n$$\n给定以下数值：\n$\\beta = 0.0065$\n$\\Lambda = 1 \\times 10^{-5}\\,\\mathrm{s}$\n$\\lambda = 0.08\\,\\mathrm{s}^{-1}$\n$\\rho = 0.004$\n\n首先，我们计算系数 $a$、$b$ 和 $c$：\n$a = \\Lambda = 1 \\times 10^{-5}$\n$b = \\lambda\\Lambda + \\beta - \\rho = (0.08)(1 \\times 10^{-5}) + 0.0065 - 0.004 = 8 \\times 10^{-7} + 0.0025 = 0.0025008$\n$c = -\\rho\\lambda = -(0.004)(0.08) = -0.00032$\n\n接下来，我们计算判别式 $D = b^2 - 4ac$：\n$b^2 = (0.0025008)^2 = 6.25400064 \\times 10^{-6}$\n$-4ac = -4(1 \\times 10^{-5})(-0.00032) = 1.28 \\times 10^{-8} = 0.0128 \\times 10^{-6}$\n$D = 6.25400064 \\times 10^{-6} + 0.0128 \\times 10^{-6} = 6.26680064 \\times 10^{-6}$\n\n现在，我们计算判别式的平方根：\n$\\sqrt{D} = \\sqrt{6.26680064 \\times 10^{-6}} \\approx 0.00250335787$\n\n最后，我们将这些值代入 $s$ 的公式中：\n$$\ns = \\frac{-b + \\sqrt{D}}{2a} = \\frac{-0.0025008 + 0.00250335787}{2 \\times (1 \\times 10^{-5})}\n$$\n$$\ns = \\frac{0.00000255787}{2 \\times 10^{-5}} = \\frac{2.55787 \\times 10^{-6}}{2 \\times 10^{-5}} \\approx 0.1278935 \\, \\mathrm{s}^{-1}\n$$\n根据要求将结果四舍五入到四位有效数字，得到：\n$$\ns \\approx 0.1279 \\, \\mathrm{s}^{-1}\n$$\n这个正根对应于稳定反应堆周期，它控制着超临界反应性引入后中子数的长期指数增长。",
            "answer": "$$\\boxed{0.1279}$$"
        },
        {
            "introduction": "实际的反应堆分析需要考虑来自不同裂变产物的多个缓发中子群。本练习  将从多群点动力学方程出发，研究反应堆在稳态（临界）条件下的平衡。通过推导每个先驱核群的平衡浓度，你将验证一个基本关系：总的缓发中子源项在稳态时等于总的先驱核生成率，从而加深对缓发中子在维持链式反应中作用的理解。",
            "id": "4243126",
            "problem": "一个均匀热中子反应堆使用带有六组缓发中子群的点堆动力学模型进行建模。中子布居（归一化反应堆功率）用 $n(t)$ 表示，第 $i$ 组缓发中子先驱核的浓度用 $C_i(t)$ 表示。总缓发中子份额为 $\\beta = \\sum_{i=1}^{6} \\beta_i$，其中 $\\beta_i$ 是第 $i$ 组所占的份额。点堆动力学系统可由以下耦合常微分方程组 (ODEs) 表示：\n$$\\frac{dn(t)}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^{6} \\lambda_i C_i(t),$$\n$$\\frac{dC_i(t)}{dt} = \\frac{\\beta_i}{\\Lambda} n(t) - \\lambda_i C_i(t), \\quad i = 1,2,\\dots,6,$$\n其中 $\\rho(t)$ 是反应性，$\\Lambda$ 是瞬发中子代时间，$\\lambda_i$ 是第 $i$ 组先驱核的衰变常数。假设在恒定归一化功率 $n(t) = n_0$ 下稳态运行，并且所有状态变量的时间导数均为零。使用以下具有代表性的热中子铀-235六群数据：\n- 衰变常数：$\\lambda_1 = 0.0124\\,\\mathrm{s}^{-1}$，$\\lambda_2 = 0.0305\\,\\mathrm{s}^{-1}$，$\\lambda_3 = 0.111\\,\\mathrm{s}^{-1}$，$\\lambda_4 = 0.301\\,\\mathrm{s}^{-1}$，$\\lambda_5 = 1.14\\,\\mathrm{s}^{-1}$，$\\lambda_6 = 3.01\\,\\mathrm{s}^{-1}$。\n- 各组份额：$\\beta_1 = 0.000266$，$\\beta_2 = 0.001491$，$\\beta_3 = 0.001316$，$\\beta_4 = 0.002647$，$\\beta_5 = 0.000772$，$\\beta_6 = 0.000273$。\n- 瞬发中子代时间：$\\Lambda = 4.0 \\times 10^{-5}\\,\\mathrm{s}$。\n- 稳态归一化功率：$n_0 = 1.000$。\n\n仅从上述常微分方程组和基本稳态条件出发，推导 $i = 1,\\dots,6$ 的平衡先驱核浓度 $C_i$，然后验证在稳态下总缓发中子源 $\\sum_{i=1}^{6} \\lambda_i C_i$ 等于 $\\beta n_0 / \\Lambda$。作为最终答案，报告稳态下总缓发中子源 $\\sum_{i=1}^{6} \\lambda_i C_i$ 的数值，单位为 $\\mathrm{s}^{-1}$，并四舍五入到四位有效数字。",
            "solution": "首先根据指定标准对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n给定的点堆动力学常微分方程组为：\n$$\n\\frac{dn(t)}{dt} = \\frac{\\rho(t) - \\beta}{\\Lambda} n(t) + \\sum_{i=1}^{6} \\lambda_i C_i(t)\n$$\n$$\n\\frac{dC_i(t)}{dt} = \\frac{\\beta_i}{\\Lambda} n(t) - \\lambda_i C_i(t), \\quad i = 1,2,\\dots,6\n$$\n提供了以下定义和常数：\n- $n(t)$：归一化反应堆功率（中子布居）\n- $C_i(t)$：第 $i$ 组先驱核的浓度\n- $\\rho(t)$：反应性\n- $\\beta_i$：第 $i$ 组的缓发中子份额\n- $\\beta = \\sum_{i=1}^{6} \\beta_i$：总缓发中子份额\n- $\\lambda_i$：第 $i$ 组先驱核的衰变常数\n- $\\Lambda$：瞬发中子代时间\n- 衰变常数：$\\lambda_1 = 0.0124\\,\\mathrm{s}^{-1}$，$\\lambda_2 = 0.0305\\,\\mathrm{s}^{-1}$，$\\lambda_3 = 0.111\\,\\mathrm{s}^{-1}$，$\\lambda_4 = 0.301\\,\\mathrm{s}^{-1}$，$\\lambda_5 = 1.14\\,\\mathrm{s}^{-1}$，$\\lambda_6 = 3.01\\,\\mathrm{s}^{-1}$\n- 各组份额：$\\beta_1 = 0.000266$，$\\beta_2 = 0.001491$，$\\beta_3 = 0.001316$，$\\beta_4 = 0.002647$，$\\beta_5 = 0.000772$，$\\beta_6 = 0.000273$\n- 瞬发中子代时间：$\\Lambda = 4.0 \\times 10^{-5}\\,\\mathrm{s}$\n- 稳态条件：反应堆处于稳态运行，这意味着所有时间导数均为零（$\\frac{dn}{dt}=0$，$\\frac{dC_i}{dt}=0$）。\n- 稳态归一化功率：$n(t) = n_0 = 1.000$（常数）。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题的有效性进行分析：\n- **科学依据充分**：该问题基于标准的点堆动力学方程，这是反应堆物理学中用于分析反应堆瞬态的一个成熟的基础模型。所有概念、变量和参数（$\\rho$、$\\beta$、$\\Lambda$、$\\lambda_i$）都是该领域的标准术语。所提供的热中子U-235反应堆的数值数据具有代表性且物理上是现实的。该问题牢固地植根于既定的科学原理。\n- **提法明确**：问题陈述清晰。它要求在指定的稳态条件下，从所给方程出发进行推导，并进行后续的数值计算。所有必要的数据都已提供。任务具体，并能导出一个唯一的、有意义的解。\n- **客观性**：语言精确、量化，没有任何主观或基于意见的论断。\n- **完整性与一致性**：问题是自洽的。给定的常微分方程组、常数和稳态条件足以进行所需的推导和计算。所提供的信息中没有矛盾之处。\n\n### 步骤 3：结论与行动\n问题被认定为有效。它在科学上是合理的、提法明确、客观且完整。可以继续进行求解过程。\n\n按照要求，解题过程分为两部分：首先是推导和验证，其次是数值计算。\n\n稳态运行的条件是方程组中所有的时间导数都等于零。\n$$\n\\frac{dn(t)}{dt} = 0\n$$\n$$\n\\frac{dC_i(t)}{dt} = 0 \\quad \\text{for } i = 1,2,\\dots,6\n$$\n在这些条件下，中子布居和先驱核浓度是恒定的，分别表示为 $n_0$ 和 $C_i$。\n\n首先，我们使用第二个点堆动力学方程来推导平衡先驱核浓度 $C_i$：\n$$\n\\frac{dC_i(t)}{dt} = \\frac{\\beta_i}{\\Lambda} n(t) - \\lambda_i C_i(t)\n$$\n在稳态下，该方程变为：\n$$\n0 = \\frac{\\beta_i}{\\Lambda} n_0 - \\lambda_i C_i\n$$\n解出平衡浓度 $C_i$ 可得：\n$$\n\\lambda_i C_i = \\frac{\\beta_i}{\\Lambda} n_0 \\implies C_i = \\frac{\\beta_i n_0}{\\lambda_i \\Lambda}\n$$\n这个方程表明，在稳态下，每个先驱核群的产生率与其衰变率完全平衡。\n\n接下来，我们验证在稳态下总缓发中子源 $\\sum_{i=1}^{6} \\lambda_i C_i$ 等于 $\\frac{\\beta n_0}{\\Lambda}$。我们将推导出的 $C_i$ 表达式代入求和式中：\n$$\n\\sum_{i=1}^{6} \\lambda_i C_i = \\sum_{i=1}^{6} \\lambda_i \\left( \\frac{\\beta_i n_0}{\\lambda_i \\Lambda} \\right)\n$$\n分子和分母中的衰变常数 $\\lambda_i$ 相互抵消：\n$$\n\\sum_{i=1}^{6} \\lambda_i C_i = \\sum_{i=1}^{6} \\frac{\\beta_i n_0}{\\Lambda}\n$$\n由于 $n_0$ 和 $\\Lambda$ 对所有组都是常数，它们可以从求和式中提出来：\n$$\n\\sum_{i=1}^{6} \\lambda_i C_i = \\frac{n_0}{\\Lambda} \\sum_{i=1}^{6} \\beta_i\n$$\n根据定义，总缓发中子份额为 $\\beta = \\sum_{i=1}^{6} \\beta_i$。将此代入方程中，确认了以下关系：\n$$\n\\sum_{i=1}^{6} \\lambda_i C_i = \\frac{\\beta n_0}{\\Lambda}\n$$\n验证完成。在稳态下，缓发中子的总产生率等于先驱核的总形成率。这也与稳态下的中子布居方程 $\\frac{dn}{dt}=0$ 一致，该方程要求 $\\frac{\\rho - \\beta}{\\Lambda}n_0 + \\frac{\\beta n_0}{\\Lambda}=0$，这意味着对于非零功率 $n_0$，反应性 $\\rho$ 必须为零。\n\n最后，我们计算总缓发中子源的数值 $\\sum_{i=1}^{6} \\lambda_i C_i = \\frac{\\beta n_0}{\\Lambda}$。\n首先，我们通过对各组份额 $\\beta_i$ 求和来计算总缓发中子份额 $\\beta$：\n$$\n\\beta = \\sum_{i=1}^{6} \\beta_i = \\beta_1 + \\beta_2 + \\beta_3 + \\beta_4 + \\beta_5 + \\beta_6\n$$\n$$\n\\beta = 0.000266 + 0.001491 + 0.001316 + 0.002647 + 0.000772 + 0.000273\n$$\n$$\n\\beta = 0.006765\n$$\n现在，将 $\\beta$、$n_0$ 和 $\\Lambda$ 的值代入已验证的表达式中。\n给定值为：\n- $\\beta = 0.006765$ (无量纲)\n- $n_0 = 1.000$ (无量纲)\n- $\\Lambda = 4.0 \\times 10^{-5}\\,\\mathrm{s}$\n\n总缓发中子源为：\n$$\n\\sum_{i=1}^{6} \\lambda_i C_i = \\frac{\\beta n_0}{\\Lambda} = \\frac{(0.006765)(1.000)}{4.0 \\times 10^{-5}\\,\\mathrm{s}}\n$$\n$$\n\\sum_{i=1}^{6} \\lambda_i C_i = \\frac{0.006765}{4.0 \\times 10^{-5}}\\,\\mathrm{s}^{-1} = \\frac{6.765 \\times 10^{-3}}{4.0 \\times 10^{-5}}\\,\\mathrm{s}^{-1} = 1.69125 \\times 10^{2}\\,\\mathrm{s}^{-1} = 169.125\\,\\mathrm{s}^{-1}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n169.125 \\approx 169.1\n$$\n稳态下总缓发中子源的数值为 $169.1\\,\\mathrm{s}^{-1}$。",
            "answer": "$$\n\\boxed{169.1}\n$$"
        },
        {
            "introduction": "对于反应性发生快速变化的瞬态，瞬发跳跃近似 (Prompt Jump Approximation, PJA) 提供了一种有效的分析工具，其核心思想是分离瞬发中子和缓发中子的时间尺度。在本计算实践  中，你将通过编程实现并对比瞬发跳跃近似与点动力学方程的精确数值解。这项练习不仅能让你掌握 PJA 的应用条件和推导，还能让你通过量化其误差来深入理解该近似在何种条件下有效，以及其物理基础。",
            "id": "4243064",
            "problem": "一个反应堆由单区点动力学描述，包含一个瞬发中子群和六组缓发中子先驱核。考虑一个有限时长的反应性脉冲，其幅度在时间 $t=0$ 时瞬时施加，并保持恒定，持续时间为 $1\\,\\mathrm{ms}$，之后反应性瞬时恢复为零。目标是比较通过 (i) 直接积分点动力学方程和 (ii) 在两个不连续点采用瞬发跳跃近似的模型计算出的在 $t=10\\,\\mathrm{ms}$ 时的中子密度 $n(t)$ 的预测值，并量化其偏差。所有时间量在内部必须以秒为单位处理；指定的评估时间为 $t=10\\,\\mathrm{ms}=0.01\\,\\mathrm{s}$。最终的中子密度是无量纲的（相对于初始稳态），偏差应以无量纲浮点数的形式报告。\n\n从以下基础出发，它们将作为本问题的基本定律和定义：\n\n- 带缓发中子群的点动力学方程：\n$$\\frac{dn(t)}{dt}=\\frac{\\rho(t)-\\beta}{\\Lambda}n(t)+\\sum_{i=1}^{6}\\lambda_i C_i(t),$$\n$$\\frac{dC_i(t)}{dt}=\\frac{\\beta_i}{\\Lambda}n(t)-\\lambda_i C_i(t),\\quad i=1,\\dots,6,$$\n其中，$n(t)$ 是中子密度，$C_i(t)$ 是第 $i$ 组缓发中子先驱核的浓度，$\\rho(t)$ 是反应性（无量纲），$\\beta=\\sum_{i=1}^{6}\\beta_i$ 是总缓发中子份额（无量纲），$\\Lambda$ 是瞬发中子代时间（单位为秒），$\\lambda_i$ 是先驱核群的衰变常数（单位为 $\\mathrm{s}^{-1}$）。在点动力学假设下，这些方程是经过充分检验的反应堆动力学模型。\n\n- 在零反应性的初始稳态下，时间导数消失，稳态关系为：\n$$\\rho(0^-)=0,\\quad \\frac{dn}{dt}=0,\\quad \\frac{dC_i}{dt}=0,$$\n这意味着\n$$\\sum_{i=1}^{6}\\lambda_i C_i(0^-)=\\frac{\\beta}{\\Lambda}n(0^-),\\quad C_i(0^-)=\\frac{\\beta_i}{\\lambda_i \\Lambda}n(0^-)。$$\n\n将反应性脉冲定义为\n$$\\rho(t)=\\begin{cases}\\Delta \\rho,  0 \\le t  t_p \\\\ 0,  t \\ge t_p \\end{cases}$$\n脉冲持续时间为 $t_p=1\\times 10^{-3}\\,\\mathrm{s}$，$\\Delta \\rho$ 由每个测试用例指定。评估时间固定为 $t_f=10\\times 10^{-3}\\,\\mathrm{s}$。\n\n必须实现两种模型：\n\n1. “精确”模型直接对点动力学微分方程进行积分，从 $t=0$ 时的初始稳态 $n(0)=1$ 和 $C_i(0)=\\beta_i/(\\lambda_i \\Lambda)$ 开始，使用上述分段恒定的 $\\rho(t)$。\n\n2. “瞬发跳跃”近似模型在每个瞬时反应性不连续点强制先驱核浓度 $C_i(t)$ 连续，并将中子密度 $n(t)$ 视为在每个不连续点经历瞬时重新调整以保持先驱核源的一致性。在不连续点之间，使用相应的恒定反应性对点动力学方程进行积分。\n\n对于所有计算，请使用以下用于铀-235缓发中子数据（六组）、瞬发中子代时间和初始条件的物理上合理且科学上标准的参数值：\n- 瞬发中子代时间 $\\Lambda=1.0\\times 10^{-4}\\,\\mathrm{s}$。\n- 各组缓发中子份额 $\\beta_i$（无量纲）：\n  - $\\beta_1=2.15\\times 10^{-4}$,\n  - $\\beta_2=1.424\\times 10^{-3}$,\n  - $\\beta_3=1.274\\times 10^{-3}$,\n  - $\\beta_4=2.568\\times 10^{-3}$,\n  - $\\beta_5=7.48\\times 10^{-4}$,\n  - $\\beta_6=2.73\\times 10^{-4}$,\n  因此总缓发中子份额为 $\\beta=\\sum_{i=1}^{6}\\beta_i=6.502\\times 10^{-3}$。\n- 各组衰变常数 $\\lambda_i$（单位为 $\\mathrm{s}^{-1}$）：\n  - $\\lambda_1=1.24\\times 10^{-2}$,\n  - $\\lambda_2=3.05\\times 10^{-2}$,\n  - $\\lambda_3=1.11\\times 10^{-1}$,\n  - $\\lambda_4=3.01\\times 10^{-1}$,\n  - $\\lambda_5=1.14$,\n  - $\\lambda_6=3.01$。\n- $t=0$ 时的初始条件是 $\\rho=0$ 的稳态值：$n(0)=1$ 以及对每个 $i$ 有 $C_i(0)=\\beta_i/(\\lambda_i \\Lambda)$。\n\n实现这两种模型，并为每个测试用例计算：\n- 来自精确模型的中子密度 $n_{\\mathrm{exact}}(t_f)$（无量纲）。\n- 来自瞬发跳跃模型的中子密度 $n_{\\mathrm{pj}}(t_f)$（无量纲）。\n- 绝对偏差 $d_{\\mathrm{abs}}=|n_{\\mathrm{exact}}(t_f)-n_{\\mathrm{pj}}(t_f)|$（无量纲）。\n- 相对偏差 $d_{\\mathrm{rel}}=d_{\\mathrm{abs}}/n_{\\mathrm{exact}}(t_f)$（无量纲）。\n\n测试套件规格：\n- 用例 1 (一般情况): $\\Delta \\rho=2.0\\times 10^{-3}$。\n- 用例 2 (接近瞬发临界边界但为亚瞬发): $\\Delta \\rho=6.2\\times 10^{-3}$。\n- 用例 3 (负脉冲): $\\Delta \\rho=-1.0\\times 10^{-3}$。\n- 用例 4 (非常小的脉冲边缘情况): $\\Delta \\rho=1.0\\times 10^{-5}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且其本身是一个包含四个浮点数的列表，顺序为 $[n_{\\mathrm{exact}}(t_f),n_{\\mathrm{pj}}(t_f),d_{\\mathrm{abs}},d_{\\mathrm{rel}}]$。例如，输出格式必须是：\n`[[n1_exact,n1_pj,d1_abs,d1_rel],[n2_exact,n2_pj,d2_abs,d2_rel],[n3_exact,n3_pj,d3_abs,d3_rel],[n4_exact,n4_pj,d4_abs,d4_rel]]`\n无任何附加文本。所有量均为无量纲，时间单位在内部为秒，指定的评估时间为 $0.01\\,\\mathrm{s}$。",
            "solution": "该问题要求解一个经受有限时长反应性脉冲的反应堆的点动力学方程，并与瞬发跳跃近似模型进行比较。该问题具有科学依据，提法明确且客观。它基于核反应堆物理学中的标准模型——点动力学方程，并使用了适用于铀-235燃料系统的物理上合理的参数。它构成了一个目标明确、定义良好的初值问题。因此，该问题是有效的，可以构建解决方案。\n\n### 1. 数学模型：点动力学方程\n\n中子密度 $n(t)$ 和六组缓发中子先驱核浓度 $C_i(t)$ 的时间演化由以下线性常微分方程（ODE）组控制：\n$$\n\\frac{dn(t)}{dt} = \\frac{\\rho(t)-\\beta}{\\Lambda}n(t) + \\sum_{i=1}^{6}\\lambda_i C_i(t)\n$$\n$$\n\\frac{dC_i(t)}{dt} = \\frac{\\beta_i}{\\Lambda}n(t) - \\lambda_i C_i(t), \\quad i=1,\\dots,6\n$$\n其中 $\\rho(t)$ 是反应性，$\\Lambda$ 是瞬发中子代时间，$\\beta_i$ 和 $\\lambda_i$ 分别是第 $i$ 组先驱核的缓发中子份额和衰变常数，$\\beta = \\sum_{i=1}^{6}\\beta_i$ 是总缓发中子份额。\n\n这个包含7个方程的方程组可以用矩阵形式表示。设状态向量为 $Y(t) = [n(t), C_1(t), ..., C_6(t)]^T$。则该系统为：\n$$\n\\frac{dY(t)}{dt} = A(\\rho(t)) Y(t)\n$$\n其中 $A$ 是 $7 \\times 7$ 的动力学矩阵，它依赖于反应性 $\\rho$：\n$$\nA(\\rho) = \\begin{pmatrix}\n\\frac{\\rho - \\beta}{\\Lambda}  \\lambda_1  \\lambda_2  \\dots  \\lambda_6 \\\\\n\\frac{\\beta_1}{\\Lambda}  -\\lambda_1  0  \\dots  0 \\\\\n\\frac{\\beta_2}{\\Lambda}  0  -\\lambda_2  \\dots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\n\\frac{\\beta_6}{\\Lambda}  0  0  \\dots  -\\lambda_6\n\\end{pmatrix}\n$$\n对于分段恒定的反应性 $\\rho(t) = \\rho_k$（在区间 $[t_{k-1}, t_k)$ 上），矩阵 $A(\\rho_k)$ 是常数。这个具有常系数的线性系统的解由矩阵指数给出：\n$$\nY(t) = e^{A(\\rho_k)(t-t_{k-1})} Y(t_{k-1})\n$$\n\n### 2. “精确”模型解法\n\n反应性 $\\rho(t)$ 是由脉冲定义的分段常数函数：\n$$\n\\rho(t) = \\begin{cases}\n\\Delta \\rho,  0 \\le t  t_p \\\\\n0,  t \\ge t_p\n\\end{cases}\n$$\n其中 $t_p = 1 \\times 10^{-3}\\,\\mathrm{s}$。我们需要求解在 $t_f = 1 \\times 10^{-2}\\,\\mathrm{s}$ 时的状态。\n\n$t=0$ 时的初始条件对应于 $\\rho(0^-)=0$ 的临界稳态。时间导数为零，由此得出 $n(0)=1$（通过归一化）和 $C_i(0) = \\frac{\\beta_i}{\\lambda_i \\Lambda}n(0) = \\frac{\\beta_i}{\\lambda_i \\Lambda}$。这定义了初始状态向量 $Y(0)$。\n\n求解过程分两步进行：\n1.  **区间 1 ($0 \\le t  t_p$)：** 反应性恒定为 $\\rho = \\Delta\\rho$。脉冲结束时（$t_p$）的状态通过对初始状态 $Y(0)$ 进行演化得到：\n    $$\n    Y(t_p) = e^{A(\\Delta\\rho)t_p} Y(0)\n    $$\n2.  **区间 2 ($t_p \\le t \\le t_f$)：** 反应性恢复为 $\\rho = 0$。最终时间 $t_f$ 时的状态通过将 $t_p$ 时的状态在 $t_f - t_p$ 的时间段内进行演化得到：\n    $$\n    Y(t_f) = e^{A(0)(t_f-t_p)} Y(t_p)\n    $$\n结合这些步骤，精确模型的最终状态为：\n$$\nY_{\\mathrm{exact}}(t_f) = e^{A(0)(t_f-t_p)} e^{A(\\Delta\\rho)t_p} Y(0)\n$$\n中子密度 $n_{\\mathrm{exact}}(t_f)$ 是向量 $Y_{\\mathrm{exact}}(t_f)$ 的第一个分量。\n\n### 3. 瞬发跳跃近似（PJA）模型\n\n当反应性变化的时间尺度远快于先驱核衰变常数，但不一定快于瞬发中子代时间时，瞬发跳跃近似是有效的。该模型假设先驱核浓度 $C_i(t)$ 在瞬时反应性变化时是连续的，而中子密度 $n(t)$ 会“跳跃”到一个新值。\n\n跳跃条件是通过假设项 $\\Lambda \\frac{dn}{dt}$ 在远离不连续点时可以忽略不计而推导出来的，这导致了准静态关系 $n(t) \\approx \\frac{\\Lambda}{\\beta - \\rho(t)} \\sum_{i=1}^{6}\\lambda_i C_i(t)$。在时间 $t_d$ 的不连续点上，由于先驱核浓度 $C_i$（及其总和）是连续的，中子密度必须跳跃以维持此关系。这给出了跳跃比率：\n$$\n\\frac{n(t_d^+)}{n(t_d^-)} = \\frac{\\beta - \\rho(t_d^-)}{\\beta - \\rho(t_d^+)}\n$$\n\nPJA 模型的求解算法如下：\n1.  **初始状态 ($t = 0^-$):** 系统从与精确模型相同的稳态 $Y(0^-) = Y(0)$ 开始。\n2.  **在 $t = 0$ 处的跳跃:** 反应性从 $\\rho(0^-) = 0$ 变为 $\\rho(0^+) = \\Delta\\rho$。\n    -   先驱核浓度是连续的：$C_i(0^+) = C_i(0^-)$。\n    -   中子密度发生跳跃：$n(0^+) = n(0^-) \\frac{\\beta - \\rho(0^-)}{\\beta - \\rho(0^+)} = n(0) \\frac{\\beta}{\\beta - \\Delta\\rho}$。\n    -   这为后续的演化定义了一个新的初始状态向量 $Y_{PJ}(0^+)$。\n3.  **从 $t=0^+$ 到 $t=t_p^-$ 的演化:** 系统以 $\\rho = \\Delta\\rho$ 演化 $t_p$ 的时长：\n    $$\n    Y_{PJ}(t_p^-) = e^{A(\\Delta\\rho)t_p} Y_{PJ}(0^+)\n    $$\n4.  **在 $t=t_p$ 处的跳跃:** 反应性从 $\\rho(t_p^-) = \\Delta\\rho$ 变为 $\\rho(t_p^+) = 0$。\n    -   先驱核浓度是连续的：$C_i(t_p^+) = C_i(t_p^-)$。\n    -   中子密度发生跳跃：$n(t_p^+) = n(t_p^-) \\frac{\\beta - \\rho(t_p^-)}{\\beta - \\rho(t_p^+)} = n(t_p^-) \\frac{\\beta - \\Delta\\rho}{\\beta}$。\n    -   这为最终的演化阶段提供了状态向量 $Y_{PJ}(t_p^+)$。\n5.  **从 $t=t_p^+$ 到 $t_f$ 的演化:** 系统以 $\\rho = 0$ 演化 $t_f - t_p$ 的时长：\n    $$\n    Y_{PJ}(t_f) = e^{A(0)(t_f-t_p)} Y_{PJ}(t_p^+)\n    $$\n中子密度 $n_{\\mathrm{pj}}(t_f)$ 是向量 $Y_{PJ}(t_f)$ 的第一个分量。\n\n### 4. 偏差计算\n\n两种模型之间的绝对偏差和相对偏差在最终时间 $t_f$ 计算如下：\n$$\nd_{\\mathrm{abs}} = |n_{\\mathrm{exact}}(t_f) - n_{\\mathrm{pj}}(t_f)|\n$$\n$$\nd_{\\mathrm{rel}} = \\frac{d_{\\mathrm{abs}}}{n_{\\mathrm{exact}}(t_f)}\n$$\n\n### 5. 实现\n\n所述算法通过计算实现。为每个反应性值构建动力学矩阵 $A(\\rho)$。矩阵指数 $e^{At}$ 使用 `scipy.linalg.expm` 计算。如上所述，精确模型和PJA模型的状态向量都通过每个阶段进行传播。对每个测试用例的 $\\Delta\\rho$ 值重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the point kinetics equations for a reactivity pulse and compares\n    the result with the prompt jump approximation.\n    \"\"\"\n    \n    # Define physical constants and problem parameters.\n    # Prompt neutron generation time in seconds.\n    Lambda = 1.0e-4\n    \n    # Delayed neutron fractions (dimensionless).\n    beta_i = np.array([\n        2.15e-4, 1.424e-3, 1.274e-3, 2.568e-3, 7.48e-4, 2.73e-4\n    ])\n    \n    # Decay constants in s^-1.\n    lambda_i = np.array([\n        1.24e-2, 3.05e-2, 1.11e-1, 3.01e-1, 1.14, 3.01\n    ])\n    \n    # Total delayed neutron fraction.\n    beta = np.sum(beta_i)\n    \n    # Time parameters in seconds.\n    tp = 1.0e-3  # Pulse duration\n    tf = 10.0e-3 # Final evaluation time\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        2.0e-3,     # Case 1: general\n        6.2e-3,     # Case 2: near prompt-critical\n        -1.0e-3,    # Case 3: negative pulse\n        1.0e-5      # Case 4: very small pulse\n    ]\n\n    def build_A_matrix(rho):\n        \"\"\"Builds the 7x7 point kinetics matrix A for a given reactivity rho.\"\"\"\n        A = np.zeros((7, 7))\n        # Top row for dn/dt\n        A[0, 0] = (rho - beta) / Lambda\n        A[0, 1:] = lambda_i\n        # Subsequent rows for dC_i/dt\n        A[1:, 0] = beta_i / Lambda\n        np.fill_diagonal(A[1:, 1:], -lambda_i)\n        return A\n\n    results = []\n    for delta_rho in test_cases:\n        # Initial conditions: steady state at rho=0, n=1.\n        n0 = 1.0\n        C0 = beta_i / (lambda_i * Lambda) * n0\n        Y0 = np.concatenate(([n0], C0))\n        \n        # --- Model 1: \"Exact\" Integration ---\n        # Construct matrices for the two reactivity intervals.\n        A1 = build_A_matrix(delta_rho)\n        A2 = build_A_matrix(0.0)\n        \n        # Evolve from t=0 to t=tp with rho = delta_rho.\n        Y_tp_exact = expm(A1 * tp) @ Y0\n        \n        # Evolve from t=tp to t=tf with rho = 0.\n        Y_tf_exact = expm(A2 * (tf - tp)) @ Y_tp_exact\n        n_exact = Y_tf_exact[0]\n\n        # --- Model 2: Prompt Jump Approximation ---\n        # State at t=0- is Y0.\n        \n        # Jump at t=0: rho changes from 0 to delta_rho.\n        # Precursors are continuous. Neutron density jumps.\n        n_0_plus = n0 * beta / (beta - delta_rho)\n        Y0_pj = Y0.copy()\n        Y0_pj[0] = n_0_plus\n\n        # Evolve from t=0+ to t=tp- with rho = delta_rho.\n        Y_tp_minus_pj = expm(A1 * tp) @ Y0_pj\n        n_tp_minus_pj = Y_tp_minus_pj[0]\n        \n        # Jump at t=tp: rho changes from delta_rho to 0.\n        # Precursors are continuous. Neutron density jumps.\n        n_tp_plus_pj = n_tp_minus_pj * (beta - delta_rho) / beta\n        Y_tp_plus_pj = Y_tp_minus_pj.copy()\n        Y_tp_plus_pj[0] = n_tp_plus_pj\n        \n        # Evolve from t=tp+ to t=tf with rho = 0.\n        Y_tf_pj = expm(A2 * (tf - tp)) @ Y_tp_plus_pj\n        n_pj = Y_tf_pj[0]\n\n        # --- Discrepancy Calculation ---\n        d_abs = abs(n_exact - n_pj)\n        d_rel = d_abs / n_exact if n_exact != 0 else float('inf')\n        \n        # Append the list of four floats for the current case.\n        results.append([n_exact, n_pj, d_abs, d_rel])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}