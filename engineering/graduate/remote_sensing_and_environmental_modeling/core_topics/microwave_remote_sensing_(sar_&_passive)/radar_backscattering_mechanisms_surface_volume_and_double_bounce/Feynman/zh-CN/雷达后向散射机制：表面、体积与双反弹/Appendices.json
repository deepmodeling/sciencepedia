{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在为地表散射（三种机制中最简单的一种）建立基础直觉。在进行复杂计算之前，理解其潜在的物理原理和我们所用模型的有效性至关重要。这个问题  要求你应用小扰动法（SPM）来预测微粗糙土壤表面如何与雷达波相互作用，重点关注布拉格共振和极化效应等关键现象。",
            "id": "3836781",
            "problem": "一个工作在微波频率的单站合成孔径雷达（SAR）探测一个裸露、均匀的电介质土壤表面。该表面的高度统计特性为零均值、平稳且各向同性，其均方根高度为 $s$，相关长度为 $l$。土壤可被建模为具有实数相对介电常数 $\\epsilon_r > 1$ 的半空间（这是湿润矿物土壤的典型特征）。雷达波数为 $k = 2\\pi/\\lambda$，测得的无量纲粗糙度参数为 $ks = 0.3$ 和 $kl = 10$。从材料界面的电磁边界条件、粗糙表面的统计表征以及小边界偏差散射的一阶微扰处理出发，评估小微扰法（SPM）是否适用，并预测表面后向散射的角向布拉格响应的极化依赖行为。特别地，论述水平-水平（HH）和垂直-垂直（VV）同极化的菲涅尔反射系数的作用、电介质界面布儒斯特角的存在，以及在各向同性粗糙度的一阶表面散射中交叉极化回波的预期强度。假设没有上覆植被层，也没有离散的垂直结构，因此不存在体散射和二次反射机制。\n\n在给定条件下，哪个选项最能概括物理上一致的结论？\n\nA. 在 $ks = 0.3$ 和 $kl = 10$ 的条件下，一阶小微扰法（SPM）适用于裸露的电介质土壤；主导机制是带有同极化回波的表面（布拉格）散射；布拉格角向响应是极化相关的，在空气-土壤界面的布儒斯特角附近，HH 同极化峰值超过 VV，并且对于各向同性粗糙度，一阶交叉极化回波可以忽略不计。\n\nB. 在 $ks = 0.3$ 和 $kl = 10$ 的条件下，SPM 无效；体散射和二次反射机制占主导；布拉格特征缺失；由于更强的反射，VV 在所有入射角下都超过 HH。\n\nC. SPM 适用；由于表面是各向同性的，布拉格峰值在 HH 和 VV 中以相同的角度和相等的强度出现；由于随机小面元取向，交叉极化回波与同极化回波相当。\n\nD. SPM 适用；VV 中的布拉格峰值总是比 HH 强，因为布儒斯特角增强了 VV 反射；即使在一阶 SPM 中，交叉极化回波也很显著。\n\nE. 仅当 $ks  0.03$ 和 $kl > 100$ 时，SPM 才有效；否则，布拉格条件无法满足，并且不应期望有任何极化依赖性。",
            "solution": "问题陈述在科学上是合理的、适定的和客观的。它提供了一个微波遥感领域的标准情景，并有足够的数据来评估指定理论模型的适用性及其物理预测。假设陈述清晰，问题可以被形式化地回答。该问题是有效的。\n\n求解过程首先评估小微扰法（SPM）在给定条件下的有效性，然后基于此一阶模型推导出预期的散射行为。\n\n**1. 小微扰法（SPM）的适用性**\n\nSPM 是一种用于描述电磁波在粗糙度相对于入射波长较小的表面上散射的模型。其有效性通过两个主要标准进行评估：\n\n- **垂直粗糙度：** 表面均方根（RMS）高度 $s$ 必须远小于雷达波长 $\\lambda$。这通过无量纲参数 $ks$ 来表示，其中 $k = 2\\pi/\\lambda$ 是雷达波数。普遍接受的条件是 $ks \\ll 1$，实际的上限通常被认为是 $ks \\le 0.3$。问题陈述中 $ks = 0.3$，这正处于此条件的边界。对于定性和一阶定量分析，SPM 在此极限下被认为是适用的。\n\n- **表面斜率：** 表面斜率必须很小。均方根斜率的量级约为均方根高度 $s$ 与相关长度 $l$ 的比值。根据给定参数，我们可以计算这个比值：\n$$ \\frac{s}{l} = \\frac{(ks)/k}{(kl)/k} = \\frac{ks}{kl} = \\frac{0.3}{10} = 0.03 $$\n由于 $0.03 \\ll 1$，小斜率条件得到了很好的满足。\n\n鉴于两个条件都得到满足（其中一个处于其极限），应用一阶 SPM 来分析散射行为是合适的。问题陈述本身也指导我们使用这个框架。\n\n**2. 一阶 SPM 对后向散射的预测**\n\n问题指定了一个单站 SAR，这意味着我们关心的是后向散射，即散射方向与入射方向相反。问题还指定了体散射和二次反射散射不存在，只剩下表面散射。\n\n- **散射机制：** 在 SPM 框架中，给定入射角 $\\theta$ 下的后向散射功率主要来自布拉格谐振。当雷达波与表面粗糙度谱的特定傅里叶分量发生相长干涉时，就会发生这种情况。对于单站后向散射，布拉格条件选择了满足 $K = 2k \\sin\\theta$ 的表面空间频率 $K$。归一化雷达散射截面 $\\sigma^0$ 与表面在该谐振波数下的功率谱密度 $W(2k \\sin\\theta)$ 成正比。\n\n- **交叉极化回波（$\\sigma^0_{HV}$ 和 $\\sigma^0_{VH}$）：** 对于各向同性表面，一阶 SPM 的一个关键预测是在后向散射方向上没有去极化。各向同性表面的对称性没有提供旋转入射波极化平面的机制。在数学上，交叉极化的一阶散射系数 $\\alpha_{hv}$ 和 $\\alpha_{vh}$ 为零。因此，$\\sigma^0_{HV} = \\sigma^0_{VH} = 0$。在任何实际测量中，这意味着交叉极化回波与同极化回波相比可以忽略不计。\n\n- **同极化回波（$\\sigma^0_{HH}$ 和 $\\sigma^0_{VV}$）：** 同极化的后向散射系数由以下公式给出：\n$$ \\sigma^0_{pp}(\\theta) \\propto |\\alpha_{pp}|^2 W(2k \\sin\\theta) $$\n其中 $p$ 代表 $H$（水平）或 $V$（垂直）极化。因子 $\\alpha_{HH}$ 和 $\\alpha_{VV}$ 取决于入射角 $\\theta$ 和相对介电常数 $\\epsilon_r$。它们有本质上的不同，导致后向散射响应具有强烈的极化依赖性。\n$\\alpha_{HH}$ 的表达式与水平极化的菲涅尔反射系数 $R_H(\\theta)$ 相同。$\\alpha_{VV}$ 的表达式更为复杂，并且与菲涅尔系数 $R_V(\\theta)$ 不同。\n一个关键特征源于当 $\\epsilon_r  1$ 时电介质界面存在布儒斯特角 $\\theta_B$。布儒斯特角由 $\\tan\\theta_B = \\sqrt{\\epsilon_r}$ 定义，在该角度下，垂直极化的镜面反射系数 $R_V(\\theta_B)$ 为零。虽然反向散射系数 $\\sigma^0_{VV}$ 不直接与 $|R_V|^2$ 成正比，但在 $\\theta_B$ 附近，V 极化反射率极小的物理效应导致 $\\sigma^0_{VV}$ 响应出现显著的下降。SPM 的一个公认结果是，在布儒斯特角附近，通常较强的 $\\sigma^0_{VV}$ 可能会降至 $\\sigma^0_{HH}$ 以下。因此，同极化回波是不同的，并且 $\\sigma^0_{VV}$ 总是大于 $\\sigma^0_{HH}$ 的说法是不正确的。\n\n**3. 选项评估**\n\n- **A. 在 $ks = 0.3$ 和 $kl = 10$ 的条件下，一阶小微扰法（SPM）适用于裸露的电介质土壤；主导机制是带有同极化回波的表面（布拉格）散射；布拉格角向响应是极化相关的，在空气-土壤界面的布儒斯特角附近，HH 同极化峰值超过 VV，并且对于各向同性粗糙度，一阶交叉极化回波可以忽略不计。**\n该选项正确地指出 SPM 适用，将布拉格散射确定为主要机制，正确地描述了同极化行为（包括在布儒斯特角附近的 HH/VV 交叉），并正确地指出交叉极化回波可以忽略不计。这是一个完整且物理上准确的描述。**正确。**\n\n- **B. 在 $ks = 0.3$ 和 $kl = 10$ 的条件下，SPM 无效；体散射和二次反射机制占主导；布拉格特征缺失；由于更强的反射，VV 在所有入射角下都超过 HH。**\n此选项在几个方面都是错误的。SPM 被认为是适用的。问题明确排除了体散射和二次反射机制。布拉格散射是 SPM 的标志。关于 $\\sigma^0_{VV}$ 总是超过 $\\sigma^0_{HH}$ 的陈述是错误的，因为存在布儒斯特角效应。**不正确。**\n\n- **C. SPM 适用；由于表面是各向同性的，布拉格峰值在 HH 和 VV 中以相同的角度和相等的强度出现；由于随机小面元取向，交叉极化回波与同极化回波相当。**\n虽然 SPM 适用，但该选项错误地声称 $\\sigma^0_{HH} = \\sigma^0_{VV}$。表面各向同性确保散射与方位角无关，而与极化无关。H 和 V 极化波与表面的相互作用在本质上是不同的。它还错误地声称存在显著的交叉极化，这与一阶 SPM 对各向同性表面的预测相矛盾。**不正确。**\n\n- **D. SPM 适用；VV 中的布拉格峰值总是比 HH 强，因为布儒斯特角增强了 VV 反射；即使在一阶 SPM 中，交叉极化回波也很显著。**\n该选项正确地指出了 SPM 的适用性，但包含两个主要错误。它错误地指出 $\\sigma^0_{VV}$ “总是”比 $\\sigma^0_{HH}$ 强，并且它从根本上误解了布儒斯特角，该角度对应于 V 极化反射的最小值，而非增强。它还错误地声称存在显著的交叉极化。**不正确。**\n\n- **E. 仅当 $ks  0.03$ 和 $kl > 100$ 时，SPM 才有效；否则，布拉格条件无法满足，并且不应期望有任何极化依赖性。**\n该选项为 SPM 提出了过于严格和武断的有效性标准。布拉格条件是波干涉定律，不取决于特定的粗糙度值。极化依赖性是电磁波与边界相互作用的基本属性，即使 SPM 模型的假设处于临界状态，它也不会消失。**不正确。**\n\n基于详细分析，选项 A 提供了对该情景唯一物理上一致且完整的描述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "真实的雷达信号通常是地表散射、体散射和二次散射的混合体。本练习  将从单一的概念模型转向一种强大的数据分析技术——Cloude-Pottier分解。通过实现该算法，你将学会如何利用极化雷达数据计算散射熵（$H$）和阿尔法角（$\\alpha$），这两个参数分别量化了散射过程的随机性和平均散射类型，从而能够对不同环境进行分类。",
            "id": "3836809",
            "problem": "提供了一个在Pauli基下的合成极化散射场景，用于通过相干矩阵的特征分解来分析雷达后向散射机制。从以下基础知识开始。\n\n- 极化散射由 $2 \\times 2$ 的Sinclair散射矩阵 $S$ 表示，其通过酉变换转换为Pauli散射向量 $k_{\\mathrm{p}}$，生成一个 $3 \\times 1$ 的复向量，该向量的多视二阶统计量定义了 $3 \\times 3$ 的厄米半正定相干矩阵 $T$。在当前任务中，直接提供了Pauli散射向量，您必须通过对外积进行多视平均来构造 $T$。\n- 相干矩阵 $T$ 可进行特征分解，得到非负实数特征值和标准正交的特征向量。定义归一化的特征值概率，并用它们来计算熵和各向异性度。使用特征向量定义平均散射角。\n\n任务：对于每个测试用例，您将获得一个包含复数分量的Pauli散射向量列表 $k_{\\mathrm{p}}^{(m)} \\in \\mathbb{C}^{3}$，其中 $m = 1, \\dots, M$。您的程序必须：\n1. 使用多视平均构造相干矩阵，公式如下\n   $$T = \\sum_{m=1}^{M} k_{\\mathrm{p}}^{(m)} \\left(k_{\\mathrm{p}}^{(m)}\\right)^{\\mathrm{H}},$$\n   其中 ${}^{\\mathrm{H}}$ 表示共轭转置。\n2. 计算 $T$ 的特征值 $\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3 \\ge 0$ 和相应的单位范数特征向量 $v_1, v_2, v_3$。\n3. 定义概率权重 $p_i = \\lambda_i / \\left(\\lambda_1 + \\lambda_2 + \\lambda_3\\right)$，其中 $i \\in \\{1,2,3\\}$。\n4. 计算熵 $H$，即 $\\{p_i\\}$ 以3为底的香农熵，\n   $$H = -\\sum_{i=1}^{3} p_i \\log_3 p_i,$$\n   其中必须使用约定 $0 \\log_3 0 = 0$。\n5. 使用第二和第三个特征值计算各向异性度 $A$，\n   $$A = \\frac{\\lambda_2 - \\lambda_3}{\\lambda_2 + \\lambda_3},$$\n   并约定如果 $\\lambda_2 + \\lambda_3 = 0$，则 $A = 0$。\n6. 计算平均散射角 $\\alpha$（以度为单位），其为各特征向量角度 $\\alpha_i$ 的概率加权平均值，其中每个 $\\alpha_i$ 由下式给出：\n   $$\\alpha_i = \\arctan\\left(\\frac{\\sqrt{|(v_i)_2|^2 + |(v_i)_3|^2}}{|(v_i)_1|}\\right),$$\n   然后将结果从弧度转换为度。使用约定，如果 $|(v_i)_1| = 0$，则 $\\alpha_i = \\pi/2$ 弧度。\n7. 根据以下规则，通过返回一个整数代码来解释 $H$-$\\alpha$ 平面上的散射机制位置：\n   - 如果 $H \\le 0.3$ 且 $\\alpha  35$ 度，返回 $0$（类表面散射）。\n   - 否则，如果 $H \\le 0.3$ 且 $\\alpha \\ge 55$ 度，返回 $2$（类二次反射散射）。\n   - 否则，如果 $H \\ge 0.7$，返回 $1$（类体散射）。\n   - 否则，在一个归一化平面中，使用欧几里得距离选择三个标准中心中最近的一个，该平面中 $\\alpha$ 通过除以 $90$ 被映射到 $[0,1]$ 区间：表面散射中心 $(H,\\alpha) = (0.2, 20)$，体散射中心 $(0.85, 45)$，二次反射散射中心 $(0.2, 70)$。根据最近的中心分别返回 $0$、$1$ 或 $2$。\n\n物理和数值单位：\n- 以度为单位报告 $\\alpha$。\n- $H$ 和 $A$ 是无量纲的。\n- 将 $H$、$\\alpha$ 和 $A$ 四舍五入到三位小数。\n\n测试套件：\n- 情况 1（表面散射主导，低熵，小 $\\alpha$ 角）：$M = 2$，其中\n  $k_{\\mathrm{p}}^{(1)} = \\begin{bmatrix} 1.00 + 0.00\\mathrm{i} \\\\ 0.15 + 0.05\\mathrm{i} \\\\ 0.06 - 0.02\\mathrm{i} \\end{bmatrix}$，\n  $k_{\\mathrm{p}}^{(2)} = \\begin{bmatrix} 0.95 + 0.01\\mathrm{i} \\\\ 0.22 - 0.04\\mathrm{i} \\\\ 0.05 + 0.03\\mathrm{i} \\end{bmatrix}$。\n- 情况 2（二次反射主导，低熵，大 $\\alpha$ 角）：$M = 2$，其中\n  $k_{\\mathrm{p}}^{(1)} = \\begin{bmatrix} 0.12 + 0.02\\mathrm{i} \\\\ 1.00 + 0.00\\mathrm{i} \\\\ 0.10 - 0.03\\mathrm{i} \\end{bmatrix}$，\n  $k_{\\mathrm{p}}^{(2)} = \\begin{bmatrix} 0.20 - 0.01\\mathrm{i} \\\\ 0.90 + 0.05\\mathrm{i} \\\\ 0.06 + 0.02\\mathrm{i} \\end{bmatrix}$。\n- 情况 3（富含体散射，高交叉极化，高熵）：$M = 3$，其中\n  $k_{\\mathrm{p}}^{(1)} = \\begin{bmatrix} 0.30 + 0.05\\mathrm{i} \\\\ 0.35 - 0.02\\mathrm{i} \\\\ 0.80 + 0.00\\mathrm{i} \\end{bmatrix}$，\n  $k_{\\mathrm{p}}^{(2)} = \\begin{bmatrix} 0.25 - 0.03\\mathrm{i} \\\\ 0.20 + 0.04\\mathrm{i} \\\\ 0.85 - 0.01\\mathrm{i} \\end{bmatrix}$，\n  $k_{\\mathrm{p}}^{(3)} = \\begin{bmatrix} 0.40 + 0.00\\mathrm{i} \\\\ 0.30 + 0.02\\mathrm{i} \\\\ 0.75 - 0.04\\mathrm{i} \\end{bmatrix}$。\n- 情况 4（近各向同性，高熵，中等 $\\alpha$ 角）：$M = 3$，其中\n  $k_{\\mathrm{p}}^{(1)} = \\begin{bmatrix} 0.60 + 0.10\\mathrm{i} \\\\ 0.60 - 0.10\\mathrm{i} \\\\ 0.60 + 0.00\\mathrm{i} \\end{bmatrix}$，\n  $k_{\\mathrm{p}}^{(2)} = \\begin{bmatrix} 0.55 - 0.08\\mathrm{i} \\\\ 0.60 + 0.06\\mathrm{i} \\\\ 0.57 + 0.02\\mathrm{i} \\end{bmatrix}$，\n  $k_{\\mathrm{p}}^{(3)} = \\begin{bmatrix} 0.58 + 0.05\\mathrm{i} \\\\ 0.62 + 0.00\\mathrm{i} \\\\ 0.59 - 0.03\\mathrm{i} \\end{bmatrix}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为方括号内包含的逗号分隔列表。每个测试用例的结果是一个包含四个值的列表，顺序为 $[H, \\alpha, A, \\text{code}]$，其中前三个是四舍五入到三位小数的浮点数，最后一个是整数分类代码。例如，输出行必须如下所示：\n  $$\\left[[h_1, \\alpha_1, A_1, c_1],[h_2, \\alpha_2, A_2, c_2],[h_3, \\alpha_3, A_3, c_3],[h_4, \\alpha_4, A_4, c_4]\\right].$$",
            "solution": "该问题要求实现用于极化雷达数据的Cloude-Pottier特征分解。该方法是雷达极化测量中用于定量分析散射机制的基石。对于几个测试用例，我们给定了一组 $M$ 个Pauli散射向量 $k_{\\mathrm{p}}^{(m)}$。对于每个用例，我们必须计算相干矩阵 $T$，对其进行特征分解，并根据得到的特征值和特征向量计算熵 $H$、各向异性度 $A$ 和平均散射角 $\\alpha$。最后，我们必须根据计算出的 $H$ 和 $\\alpha$ 值对主导散射机制进行分类。步骤如下。\n\n1.  **相干矩阵的构造**\n\n散射过程的二阶统计特性由 $3 \\times 3$ 的相干矩阵 $T$ 捕获。它是由Pauli散射向量 $k_{\\mathrm{p}}^{(m)} \\in \\mathbb{C}^{3}$ 的外积进行多视平均形成的。给定 $M$ 视（样本），相干矩阵定义为：\n$$T = \\sum_{m=1}^{M} k_{\\mathrm{p}}^{(m)} \\left(k_{\\mathrm{p}}^{(m)}\\right)^{\\mathrm{H}}$$\n其中上标 ${}^{\\mathrm{H}}$ 表示共轭转置（厄米转置）。由于每一项 $k_{\\mathrm{p}}^{(m)} (k_{\\mathrm{p}}^{(m)})^{\\mathrm{H}}$ 都是一个半正定厄米矩阵，它们的和 $T$ 也是一个半正定厄米矩阵。\n\n2.  **相干矩阵的特征分解**\n\n由于 $T$ 是一个厄米矩阵，它可以被一个酉矩阵对角化，并且其特征值是实数。此外，由于 $T$ 是半正定的，其特征值是非负的。$T$ 的特征分解由下式给出：\n$$T = V \\Lambda V^{\\mathrm{H}} = \\sum_{i=1}^{3} \\lambda_i v_i v_i^{\\mathrm{H}}$$\n其中 $\\Lambda$ 是包含特征值 $\\lambda_i$ 的对角矩阵，$V$ 是一个酉矩阵，其列是相应的标准正交特征向量 $v_i$。我们将特征值按降序排序，$\\lambda_1 \\ge \\lambda_2 \\ge \\lambda_3 \\ge 0$，并相应地排列特征向量 $v_1, v_2, v_3$。总后向散射功率是相干矩阵的迹，$\\text{Tr}(T) = \\sum_{i=1}^{3} \\lambda_i$。\n\n3.  **概率权重**\n\n特征值 $\\lambda_i$ 可以解释为由特征向量 $v_i$ 表示的三个独立、正交散射机制的权重。我们对特征值进行归一化，以定义一组概率 $\\{p_i\\}$：\n$$p_i = \\frac{\\lambda_i}{\\lambda_1 + \\lambda_2 + \\lambda_3}, \\quad i \\in \\{1, 2, 3\\}$$\n根据定义，$\\sum_{i=1}^{3} p_i = 1$，因此 $\\{p_i\\}$ 构成一个有效的概率分布。\n\n4.  **散射熵 ($H$)**\n\n熵 $H$ 衡量散射过程中的随机性程度。它被定义为概率权重 $\\{p_i\\}$ 的以3为底的香non熵：\n$$H = -\\sum_{i=1}^{3} p_i \\log_3 p_i$$\n选择底数3是因为有三个特征值。$H$ 的值范围从0（对于单个非零特征值，表示单一的确定性散射机制）到1（对于三个相等的特征值，$\\lambda_1=\\lambda_2=\\lambda_3$，表示最大随机性）。对于任何 $p_i = 0$，应用约定 $0 \\log_3 0 = 0$。\n\n5.  **散射各向异性度 ($A$)**\n\n各向异性度 $A$ 衡量第二和第三散射机制的相对重要性。它使用第二和第三个特征值定义：\n$$A = \\frac{\\lambda_2 - \\lambda_3}{\\lambda_2 + \\lambda_3}$$\n各向异性度是为 $H > 0$ 定义的。如果 $\\lambda_2 + \\lambda_3 = 0$，这意味着 $\\lambda_2 = \\lambda_3 = 0$，则各向异性度定义为 $A=0$。$A=0$ 的值表示次要机制具有相等的功率，而 $A=1$ 表示第三个机制的功率为零。\n\n6.  **平均散射角 ($\\alpha$)**\n\n每个特征向量 $v_i = [(v_i)_1, (v_i)_2, (v_i)_3]^{\\mathrm{T}}$ 都可以与一个特征散射角 $\\alpha_i$ 相关联，这有助于识别物理散射的类型（例如，表面散射、偶极子散射或二次反射散射）。角度 $\\alpha_i$ 定义为：\n$$\\alpha_i = \\arctan\\left(\\frac{\\sqrt{|(v_i)_2|^2 + |(v_i)_3|^2}}{|(v_i)_1|}\\right)$$\n其结果以弧度为单位。如果分母 $|(v_i)_1|$ 为零，则取 $\\alpha_i = \\pi/2$。由于特征向量 $v_i$ 是单位范数的，因此 $|(v_i)_1|^2 + |(v_i)_2|^2 + |(v_i)_3|^2 = 1$。这允许一个简化且数值稳定的计算：$\\alpha_i = \\arccos(|(v_i)_1|)$。然后，平均散射角 $\\alpha$ 是这些单个角度的概率加权平均值：\n$$\\alpha = \\sum_{i=1}^{3} p_i \\alpha_i$$\n$\\alpha$ 的最终结果必须通过乘以 $180/\\pi$ 从弧度转换为度。\n\n7.  **散射机制分类**\n\n对 $(H, \\alpha)$ 为主导散射机制的分类提供了一个稳健的基础。该问题指定了一个两阶段分类方案：\na. 一套基于阈值的主要规则：\n   - 如果 $H \\le 0.3$ 且 $\\alpha  35^\\circ$，则该机制被分类为类表面散射（代码 $0$）。\n   - 如果 $H \\le 0.3$ 且 $\\alpha \\ge 55^\\circ$，则被分类为类二次反射散射（代码 $2$）。\n   - 如果 $H \\ge 0.7$，则被分类为类体散射（代码 $1$）。\nb. 如果以上规则都不适用，则通过在归一化的 $H$-$\\alpha$ 平面中找到三个标准中心中最近的一个来确定分类。坐标空间通过将 $\\alpha$ 从 $[0^\\circ, 90^\\circ]$ 通过除以 $90$ 映射到 $[0, 1]$ 来进行归一化。计算从点 $(H, \\alpha/90)$ 到三个中心的欧几里得距离：\n   - 表面散射中心 $C_0 = (0.2, 20/90)$\n   - 体散射中心 $C_1 = (0.85, 45/90)$\n   - 二次反射散射中心 $C_2 = (0.2, 70/90)$\n分类代码（$0$、$1$ 或 $2$）对应于距离最小的中心。\n\n每个测试用例的最终输出将是一个数组，其中包含计算出的 $H$、$\\alpha$ 和 $A$ 的值（四舍五入到三位小数），以及整数分类代码。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the radar polarimetry problem for the given test suite.\n    This involves calculating the coherency matrix, performing eigen-decomposition,\n    computing H, A, alpha parameters, and classifying the scattering mechanism.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: surface-dominated\n        [np.array([1.00 + 0.00j, 0.15 + 0.05j, 0.06 - 0.02j]),\n         np.array([0.95 + 0.01j, 0.22 - 0.04j, 0.05 + 0.03j])],\n        # Case 2: double-bounce-dominated\n        [np.array([0.12 + 0.02j, 1.00 + 0.00j, 0.10 - 0.03j]),\n         np.array([0.20 - 0.01j, 0.90 + 0.05j, 0.06 + 0.02j])],\n        # Case 3: volume-rich\n        [np.array([0.30 + 0.05j, 0.35 - 0.02j, 0.80 + 0.00j]),\n         np.array([0.25 - 0.03j, 0.20 + 0.04j, 0.85 - 0.01j]),\n         np.array([0.40 + 0.00j, 0.30 + 0.02j, 0.75 - 0.04j])],\n        # Case 4: near-isotropic\n        [np.array([0.60 + 0.10j, 0.60 - 0.10j, 0.60 + 0.00j]),\n         np.array([0.55 - 0.08j, 0.60 + 0.06j, 0.57 + 0.02j]),\n         np.array([0.58 + 0.05j, 0.62 + 0.00j, 0.59 - 0.03j])]\n    ]\n\n    results = []\n    for k_p_list in test_cases:\n        # Step 1: Construct the coherency matrix T\n        T = np.zeros((3, 3), dtype=np.complex128)\n        for k_p in k_p_list:\n            T += np.outer(k_p, np.conj(k_p))\n\n        # Step 2: Compute eigenvalues and eigenvectors of T\n        # np.linalg.eigh returns eigenvalues in ascending order and corresponding\n        # eigenvectors as columns. We sort them in descending order.\n        eigenvalues, eigenvectors = np.linalg.eigh(T)\n        eigenvalues = eigenvalues[::-1]\n        eigenvectors = eigenvectors[:, ::-1]\n        lambda1, lambda2, lambda3 = eigenvalues\n\n        # Step 3: Define the probability weights p_i\n        trace_T = np.sum(eigenvalues)\n        if trace_T  1e-12: # Check for zero matrix to avoid division by zero\n            p = np.array([1/3, 1/3, 1/3]) # Or handle as error\n        else:\n            p = eigenvalues / trace_T\n\n        # Step 4: Compute the entropy H\n        # Convention 0*log(0) = 0 is handled by filtering for p > 0\n        p_nonzero = p[p > 1e-12]\n        if p_nonzero.size == 0:\n            H = 0.0\n        else:\n            H = -np.sum(p_nonzero * np.log(p_nonzero) / np.log(3))\n\n        # Step 5: Compute the anisotropy A\n        denom_A = lambda2 + lambda3\n        if denom_A  1e-12:\n            A = 0.0\n        else:\n            A = (lambda2 - lambda3) / denom_A\n\n        # Step 6: Compute the average scattering angle alpha\n        # For unit-norm eigenvectors, alpha_i = arccos(|(v_i)_1|)\n        v1_mag = np.abs(eigenvectors[0, :])\n        # Use np.clip for robustness against float errors > 1.0\n        alpha_i_rad = np.arccos(np.clip(v1_mag, 0.0, 1.0))\n        alpha_rad = np.sum(p * alpha_i_rad)\n        alpha_deg = np.rad2deg(alpha_rad)\n\n        # Step 7: Interpret the scattering mechanism\n        code = -1 # Initialize with a value to indicate it's not set\n        if H = 0.3 and alpha_deg  35:\n            code = 0  # surface-like\n        elif H = 0.3 and alpha_deg >= 55:\n            code = 2  # double-bounce-like\n        elif H >= 0.7:\n            code = 1  # volume-like\n        else:\n            # Fallback: choose nearest canonical center\n            point = np.array([H, alpha_deg / 90.0])\n            centers = np.array([\n                [0.20, 20/90.0],  # Surface (0)\n                [0.85, 45/90.0],  # Volume (1)\n                [0.20, 70/90.0]   # Double-bounce (2)\n            ])\n            distances = np.linalg.norm(centers - point, axis=1)\n            code = int(np.argmin(distances))\n            \n        # Round the float values to three decimal places\n        H_rounded = round(H, 3)\n        alpha_rounded = round(alpha_deg, 3)\n        A_rounded = round(A, 3)\n\n        results.append(f\"[{H_rounded},{alpha_rounded},{A_rounded},{code}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "分析的最后一步通常是从分类向量化——估算每种散射机制贡献的精确功率。这个高级练习  介绍了模型反演的概念，即我们将一个物理模型与观测数据进行拟合。你将实现一个最小二乘拟合，更重要的是，你将学会通过分析模型的可辨識度和对噪声的敏感性来评估结果的可靠性，这是任何定量遥感科学家都必须具备的关键技能。",
            "id": "3836792",
            "problem": "给定一个简化的、具有物理动机的线性混合模型，用于合成孔径雷达（SAR）遥感中的后向散射。该模型将多种极化和入射角下观测到的线性尺度后向散射系数表示为三种典型散射机制的叠加：表面散射、体散射和二次散射。令后向散射系数表示为 $\\sigma^0$（无量纲，线性尺度；不使用分贝）。三个未知的分量强度分别为 $S$（表面）、$V$（体积）和 $D$（二次反射），均为非负无量纲值。\n\n对于给定的入射角 $\\alpha$（单位为度），令 $\\theta = \\alpha \\pi / 180$ 为其弧度度量。对于每种极化 $p \\in \\{\\mathrm{HH}, \\mathrm{HV}, \\mathrm{VV}\\}$ 和角度 $\\theta$，这三种机制对观测后向散射的贡献建模如下\n$$\na_{\\text{surf},p}(\\theta) = k_{s,p}\\,\\cos^p(\\theta), \\quad\na_{\\text{vol},p}(\\theta) = k_{v,p}\\,\\sin^q(\\theta), \\quad\na_{\\text{db},p}(\\theta) = k_{d,p}\\,\\cos^{p_d}(\\theta),\n$$\n其中包含固定的、物理上合理的常数\n$$\nk_{s,\\mathrm{HH}} = 0.80,\\quad k_{s,\\mathrm{HV}} = 0.05,\\quad k_{s,\\mathrm{VV}} = 0.60,\n$$\n$$\nk_{v,\\mathrm{HH}} = 0.20,\\quad k_{v,\\mathrm{HV}} = 1.00,\\quad k_{v,\\mathrm{VV}} = 0.20,\n$$\n$$\nk_{d,\\mathrm{HH}} = 1.00,\\quad k_{d,\\mathrm{HV}} = 0.02,\\quad k_{d,\\mathrm{VV}} = 0.80,\n$$\n和指数\n$$\np = 3,\\quad q = 2,\\quad p_d = 1.\n$$\n对于每个入射角 $\\theta$ 和极化 $p$，观测后向散射的模型为\n$$\n\\sigma^0_{p}(\\theta) = S\\,a_{\\text{surf},p}(\\theta) + V\\,a_{\\text{vol},p}(\\theta) + D\\,a_{\\text{db},p}(\\theta).\n$$\n将所有极化和角度的观测值堆叠起来，形成一个线性系统\n$$\n\\mathbf{y} = \\mathbf{A}\\,\\mathbf{x},\n$$\n其中 $\\mathbf{x} = [S,\\,V,\\,D]^{\\top}$，$\\mathbf{y} \\in \\mathbb{R}^{3N}$ 包含 $k=1,\\dots,N$ 时的 $\\sigma^0_{\\mathrm{HH}}(\\theta_k)$、$\\sigma^0_{\\mathrm{HV}}(\\theta_k)$ 和 $\\sigma^0_{\\mathrm{VV}}(\\theta_k)$，而 $\\mathbf{A} \\in \\mathbb{R}^{3N \\times 3}$ 的行由相应的 $a_{\\text{surf},p}(\\theta_k)$、$a_{\\text{vol},p}(\\theta_k)$ 和 $a_{\\text{db},p}(\\theta_k)$ 构建。\n\n你的任务是：\n- 在给定 $\\mathbf{y}$ 和 $\\mathbf{A}$ 的情况下，实现 $\\mathbf{x}$ 的最小二乘估计。\n- 使用 $\\mathbf{A}$ 的谱条件数评估可辨识性，其定义为\n$$\n\\kappa(\\mathbf{A}) = \\frac{\\sigma_{\\max}(\\mathbf{A})}{\\sigma_{\\min}(\\mathbf{A})},\n$$\n其中 $\\sigma_{\\max}(\\mathbf{A})$ 和 $\\sigma_{\\min}(\\mathbf{A})$ 分别是 $\\mathbf{A}$ 的最大和最小奇异值。\n- 使用 Moore–Penrose 伪逆的二范数（其值等于 $1/\\sigma_{\\min}(\\mathbf{A})$）进行灵敏度分析。在大小为 $0.01\\|\\mathbf{y}\\|_2$（即 $\\|\\mathbf{y}\\|_2$ 的 $0.01$ 倍）的对抗性测量扰动下，计算最坏情况下的相对参数变化界限\n$$\n\\eta = \\frac{\\| \\mathbf{A}^{+} \\|_2 \\cdot 0.01 \\|\\mathbf{y}\\|_2}{\\|\\mathbf{x}_{\\text{true}}\\|_2} = \\frac{0.01\\,\\|\\mathbf{y}\\|_2}{\\sigma_{\\min}(\\mathbf{A})\\,\\|\\mathbf{x}_{\\text{true}}\\|_2},\n$$\n其中 $\\mathbf{A}^{+}$ 表示 Moore–Penrose 伪逆，$\\mathbf{x}_{\\text{true}}$ 是综合测试中的真实参数向量。\n\n声明一个包含三个综合案例的测试套件。对于每个案例，给定入射角（单位为度）和真实参数向量 $\\mathbf{x}_{\\text{true}}$；你应该根据角度和给定模型构建 $\\mathbf{A}$，然后通过 $\\mathbf{y} = \\mathbf{A}\\,\\mathbf{x}_{\\text{true}}$ 生成无噪声观测值，通过最小二乘法拟合 $\\hat{\\mathbf{x}}$，并计算各项指标。角度以度为单位指定，必须使用 $\\theta = \\alpha \\pi / 180$ 转换为弧度。所有后向散射量均为线性尺度下的无量纲值。\n\n使用以下测试套件：\n- 案例 1（常规，良态）：$\\alpha = [25.0,\\,35.0,\\,45.0]$, $\\mathbf{x}_{\\text{true}} = [0.25,\\,0.12,\\,0.18]^{\\top}$。\n- 案例 2（边界，由于交叉极化弱且 $\\sin(\\theta)$ 小而呈病态）：$\\alpha = [5.0,\\,10.0,\\,15.0]$, $\\mathbf{x}_{\\text{true}} = [0.30,\\,0.02,\\,0.25]^{\\top}$。\n- 案例 3（边缘，体散射主导且交叉极化强）：$\\alpha = [50.0,\\,55.0,\\,60.0]$, $\\mathbf{x}_{\\text{true}} = [0.05,\\,0.30,\\,0.08]^{\\top}$。\n\n将可辨识性标准定义为一个布尔标志，通过两个阈值的逻辑与运算计算得出：\n$$\n\\kappa(\\mathbf{A}) \\leq \\kappa_{\\text{thr}} \\quad \\text{and} \\quad \\eta \\leq \\eta_{\\text{thr}},\n$$\n其中 $\\kappa_{\\text{thr}} = 150$ 且 $\\eta_{\\text{thr}} = 0.5$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试案例贡献一个形式为 $[\\kappa(\\mathbf{A}),\\,\\eta,\\,\\text{identifiable}]$ 的子列表，其中 $\\kappa(\\mathbf{A})$ 和 $\\eta$ 是浮点数，$\\text{identifiable}$ 是布尔值。例如，三个案例的输出应类似于 $[[x_1,y_1,True],[x_2,y_2,False],[x_3,y_3,True]]$，并包含相应的数值。",
            "solution": "用户在计算遥感和线性代数领域提供了一个定义明确的问题。任务是分析一个简化的合成孔径雷达（SAR）后向散射线性混合模型。这包括基于模型构建系统矩阵，为给定的测试案例计算可辨识性和灵敏度指标，并根据指定标准确定模型参数是否可辨识。该问题具有科学依据，数学上合理，并包含其解决所需的所有必要信息。我将着手进行正式的解答。\n\n问题围绕观测到的后向散射系数 $\\sigma^0$ 的线性模型展开，该模型是三种典型散射机制：表面散射（$S$）、体散射（$V$）和二次散射（$D$）的加权和。该模型表示为：\n$$\n\\sigma^0_{p}(\\theta) = S \\cdot a_{\\text{surf},p}(\\theta) + V \\cdot a_{\\text{vol},p}(\\theta) + D \\cdot a_{\\text{db},p}(\\theta)\n$$\n其中 $p \\in \\{\\mathrm{HH}, \\mathrm{HV}, \\mathrm{VV}\\}$ 表示极化，$\\theta$ 是以弧度为单位的入射角。待估计的未知参数是非负系数 $\\mathbf{x} = [S, V, D]^{\\top}$。\n\n基函数 $a_{\\text{mechanism},p}(\\theta)$ 定义为：\n$$\na_{\\text{surf},p}(\\theta) = k_{s,p}\\,\\cos^p(\\theta) \\\\\na_{\\text{vol},p}(\\theta) = k_{v,p}\\,\\sin^q(\\theta) \\\\\na_{\\text{db},p}(\\theta) = k_{d,p}\\,\\cos^{p_d}(\\theta)\n$$\n给定指数 $p=3$、$q=2$、$p_d=1$ 和系数 $k_{\\cdot, \\cdot}$。\n\n在 $N$ 个不同入射角 $\\{\\theta_1, \\theta_2, \\dots, \\theta_N\\}$ 和三种极化下收集的全套观测数据，可以表示为一个线性方程组：\n$$\n\\mathbf{y} = \\mathbf{A}\\,\\mathbf{x}\n$$\n其中 $\\mathbf{y} \\in \\mathbb{R}^{3N}$ 是堆叠观测值 $\\sigma^0_{p}(\\theta_k)$ 的向量，$\\mathbf{A} \\in \\mathbb{R}^{3N \\times 3}$ 是系统矩阵或设计矩阵。$\\mathbf{A}$ 的结构是这个问题的核心。对于每个角度 $\\theta_k$，$\\mathbf{A}$ 中有三个对应的行，每种极化占一行。该矩阵通过堆叠这 $N$ 个各含三行的块来构建：\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\na_{\\text{surf,HH}}(\\theta_1)  a_{\\text{vol,HH}}(\\theta_1)  a_{\\text{db,HH}}(\\theta_1) \\\\\na_{\\text{surf,HV}}(\\theta_1)  a_{\\text{vol,HV}}(\\theta_1)  a_{\\text{db,HV}}(\\theta_1) \\\\\na_{\\text{surf,VV}}(\\theta_1)  a_{\\text{vol,VV}}(\\theta_1)  a_{\\text{db,VV}}(\\theta_1) \\\\\n\\vdots  \\vdots  \\vdots \\\\\na_{\\text{surf,HH}}(\\theta_N)  a_{\\text{vol,HH}}(\\theta_N)  a_{\\text{db,HH}}(\\theta_N) \\\\\na_{\\text{surf,HV}}(\\theta_N)  a_{\\text{vol,HV}}(\\theta_N)  a_{\\text{db,HV}}(\\theta_N) \\\\\na_{\\text{surf,VV}}(\\theta_N)  a_{\\text{vol,VV}}(\\theta_N)  a_{\\text{db,VV}}(\\theta_N)\n\\end{bmatrix}\n$$\n\n对每个测试案例的分析主要分为三个部分。\n\n**1. 最小二乘估计与综合数据生成**\n问题指定了综合测试案例，其中“真实”参数向量 $\\mathbf{x}_{\\text{true}}$ 是已知的。相应的无噪声观测向量 $\\mathbf{y}$ 通过正向模型生成：$\\mathbf{y} = \\mathbf{A}\\,\\mathbf{x}_{\\text{true}}$。标准最小二乘估计 $\\hat{\\mathbf{x}}$ 是使残差的欧几里得范数平方 $\\|\\mathbf{y} - \\mathbf{A}\\mathbf{x}\\|_2^2$ 最小化的解。该解由 $\\hat{\\mathbf{x}} = \\mathbf{A}^{+}\\mathbf{y}$ 给出，其中 $\\mathbf{A}^{+}$ 是 $\\mathbf{A}$ 的 Moore-Penrose 伪逆。对于我们的无噪声综合数据，假设 $\\mathbf{A}$ 具有满列秩，估计将是精确的：$\\hat{\\mathbf{x}} = \\mathbf{A}^{+}(\\mathbf{A}\\mathbf{x}_{\\text{true}}) = (\\mathbf{A}^{+}\\mathbf{A})\\mathbf{x}_{\\text{true}} = \\mathbf{I}\\mathbf{x}_{\\text{true}} = \\mathbf{x}_{\\text{true}}$。因此，$\\hat{\\mathbf{x}}$ 的计算是隐式处理的，我们专注于稳定性指标。\n\n**2. 通过条件数进行可辨识性分析**\n可靠地区分 $S$、$V$ 和 $D$ 的贡献的能力取决于 $\\mathbf{A}$ 的列向量的线性无关性。对此的一个定量度量是 $\\mathbf{A}$ 的谱条件数，定义为：\n$$\n\\kappa(\\mathbf{A}) = \\frac{\\sigma_{\\max}(\\mathbf{A})}{\\sigma_{\\min}(\\mathbf{A})}\n$$\n其中 $\\sigma_{\\max}(\\mathbf{A})$ 和 $\\sigma_{\\min}(\\mathbf{A})$ 分别是 $\\mathbf{A}$ 的最大和最小奇异值。这些值通过对 $\\mathbf{A}$ 进行奇异值分解（SVD）得到。大的条件数意味着矩阵接近奇异（即其列向量几乎线性相关），这使得从 $\\mathbf{y}$ 求解 $\\mathbf{x}$ 的逆问题成为病态问题，并且对测量中的噪声非常敏感。\n\n**3. 灵敏度分析**\n题目要求我们在给定测量值有小扰动的情况下，计算估计参数相对变化的最坏情况界限 $\\eta$。观测向量中的扰动 $\\delta\\mathbf{y}$ 会导致解的扰动 $\\delta\\mathbf{x}$，其中 $\\|\\delta\\mathbf{x}\\|_2 \\le \\|\\mathbf{A}^{+}\\|_2 \\|\\delta\\mathbf{y}\\|_2$。问题指定了一个大小为 $\\|\\delta\\mathbf{y}\\|_2 = 0.01\\|\\mathbf{y}\\|_2$ 的对抗性扰动。那么最坏情况下的相对参数变化由以下公式界定：\n$$\n\\frac{\\|\\delta\\mathbf{x}\\|_2}{\\|\\mathbf{x}_{\\text{true}}\\|_2} \\le \\frac{\\|\\mathbf{A}^{+}\\|_2 \\cdot (0.01\\|\\mathbf{y}\\|_2)}{\\|\\mathbf{x}_{\\text{true}}\\|_2}\n$$\n这个上界就是我们需要计算的 $\\eta$。伪逆的二范数是最小非零奇异值的倒数：$\\|\\mathbf{A}^{+}\\|_2 = 1/\\sigma_{\\min}(\\mathbf{A})$。因此，计算公式为：\n$$\n\\eta = \\frac{0.01\\,\\|\\mathbf{y}\\|_2}{\\sigma_{\\min}(\\mathbf{A})\\,\\|\\mathbf{x}_{\\text{true}}\\|_2}\n$$\n\n**4. 可辨识性标准**\n最后，根据条件数和灵敏度指标是否都低于各自的阈值，确定一个布尔标志 `identifiable`：\n$$\n\\text{identifiable} = (\\kappa(\\mathbf{A}) \\le \\kappa_{\\text{thr}}) \\land (\\eta \\le \\eta_{\\text{thr}})\n$$\n其中 $\\kappa_{\\text{thr}} = 150$ 且 $\\eta_{\\text{thr}} = 0.5$。这个复合标准确保了系统不仅在理论上是可辨识的（有限的条件数），而且在实践中对合理水平的测量噪声也具有鲁棒性。\n\n每个测试案例的算法如下：\n1.  将给定的角度 $\\alpha$ 从度数转换为弧度 $\\theta$。\n2.  使用提供的模型方程和常数构建 $3N \\times 3$ 矩阵 $\\mathbf{A}$。\n3.  计算 $\\mathbf{A}$ 的 SVD 以找到其奇异值 $\\sigma_i$。\n4.  计算条件数 $\\kappa(\\mathbf{A}) = \\sigma_{\\max}/\\sigma_{\\min}$。\n5.  生成综合观测向量 $\\mathbf{y} = \\mathbf{A}\\,\\mathbf{x}_{\\text{true}}$。\n6.  计算灵敏度指标 $\\eta = (0.01 \\cdot \\|\\mathbf{y}\\|_2) / (\\sigma_{\\min} \\cdot \\|\\mathbf{x}_{\\text{true}}\\|_2)$。\n7.  根据阈值评估布尔可辨识性标志。\n8.  编译得到的三元组结果 $[\\kappa(\\mathbf{A}), \\eta, \\text{identifiable}]$。\n此过程将应用于所有三个指定的测试案例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the radar backscatter model inversion problem for three test cases.\n    For each case, it computes the condition number of the system matrix,\n    a sensitivity metric, and an identifiability flag.\n    \"\"\"\n\n    # --- Model Constants ---\n    # Exponents\n    P_EXP = 3\n    Q_EXP = 2\n    PD_EXP = 1\n\n    # Coefficients k for surface (s), volume (v), and double-bounce (d)\n    K_S = {'HH': 0.80, 'HV': 0.05, 'VV': 0.60}\n    K_V = {'HH': 0.20, 'HV': 1.00, 'VV': 0.20}\n    K_D = {'HH': 1.00, 'HV': 0.02, 'VV': 0.80}\n    \n    POLARIZATIONS = ['HH', 'HV', 'VV']\n\n    # --- Analysis Thresholds ---\n    KAPPA_THR = 150.0\n    ETA_THR = 0.5\n\n    # --- Test Suite ---\n    test_cases = [\n        {\n            \"name\": \"Case 1 (general, well-conditioned)\",\n            \"alpha_deg\": np.array([25.0, 35.0, 45.0]),\n            \"x_true\": np.array([0.25, 0.12, 0.18])\n        },\n        {\n            \"name\": \"Case 2 (boundary, poorly conditioned)\",\n            \"alpha_deg\": np.array([5.0, 10.0, 15.0]),\n            \"x_true\": np.array([0.30, 0.02, 0.25])\n        },\n        {\n            \"name\": \"Case 3 (edge, volume-dominated)\",\n            \"alpha_deg\": np.array([50.0, 55.0, 60.0]),\n            \"x_true\": np.array([0.05, 0.30, 0.08])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        alpha_deg = case[\"alpha_deg\"]\n        x_true = case[\"x_true\"]\n\n        # Convert angles to radians\n        theta_rad = np.deg2rad(alpha_deg)\n\n        # --- Construct the System Matrix A ---\n        num_angles = len(theta_rad)\n        A = np.zeros((3 * num_angles, 3))\n\n        for i, theta in enumerate(theta_rad):\n            cos_theta = np.cos(theta)\n            sin_theta = np.sin(theta)\n\n            for j, pol in enumerate(POLARIZATIONS):\n                row_idx = i * 3 + j\n                # Surface component\n                A[row_idx, 0] = K_S[pol] * (cos_theta ** P_EXP)\n                # Volume component\n                A[row_idx, 1] = K_V[pol] * (sin_theta ** Q_EXP)\n                # Double-bounce component\n                A[row_idx, 2] = K_D[pol] * (cos_theta ** PD_EXP)\n        \n        # --- Perform SVD and Compute Metrics ---\n        # SVD of A to get singular values\n        # U, s, Vt = np.linalg.svd(A) where s is the vector of singular values\n        singular_values = np.linalg.svd(A, compute_uv=False)\n        \n        sigma_max = singular_values[0]\n        sigma_min = singular_values[-1]\n\n        # 1. Condition number kappa\n        # Avoid division by zero if sigma_min is numerically zero\n        if sigma_min  np.finfo(float).eps:\n            kappa = np.inf\n        else:\n            kappa = sigma_max / sigma_min\n\n        # Generate synthetic data y\n        y = A @ x_true\n        \n        # 2. Sensitivity metric eta\n        # Avoid division by zero if sigma_min or norm(x_true) is zero\n        norm_y = np.linalg.norm(y)\n        norm_x_true = np.linalg.norm(x_true)\n\n        if sigma_min  np.finfo(float).eps or norm_x_true  np.finfo(float).eps:\n            eta = np.inf\n        else:\n            eta = (0.01 * norm_y) / (sigma_min * norm_x_true)\n\n        # 3. Identifiability criterion\n        identifiable = (kappa = KAPPA_THR) and (eta = ETA_THR)\n        \n        # Store results for the case\n        results.append([kappa, eta, identifiable])\n\n    # --- Format and Print Final Output ---\n    # Custom format to match `[val1,val2,Bool]` with no spaces\n    formatted_results = []\n    for res in results:\n        # The str(bool) in Python produces \"True\" or \"False\", which matches the example\n        sublist_str = f\"[{res[0]},{res[1]},{str(res[2])}]\"\n        formatted_results.append(sublist_str)\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}