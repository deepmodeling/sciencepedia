{
    "hands_on_practices": [
        {
            "introduction": "一台微波辐射计的核心性能指标是其探测微弱温度变化的能力，即其灵敏度。本实践将引导你从基本物理原理出发，推导决定辐射计灵敏度（噪声等效温差，NEΔT）的基础方程。通过这个过程，你将理解系统噪声温度 $T_{\\text{sys}}$ 和带宽 $B$ 等仪器参数如何共同决定测量精度，这对于理解仪器设计权衡和评估数据质量至关重要。",
            "id": "3833251",
            "problem": "一个星载无源微波全功率辐射计通道在一个中心频率上观测地球表面，该频率下瑞利-金斯近似（即 $h \\nu \\ll k_{B} T$，其中 $h$ 为普朗克常数，$\\nu$ 为频率，$k_{B}$ 为玻尔兹曼常数）有效。该仪器经过校准，其输出与观测到的亮温成正比。该辐射计的等效噪声带宽为 $B = 18$ MHz，系统噪声温度为 $T_{\\text{sys}} = 800$ K，其中 $T_{\\text{sys}}$ 包括来自天线、前端、接收机和观测场景的贡献，且噪声可以很好地用在频带内呈白噪声特性的、平稳的、带限的、零均值高斯涨落来描述。假设采用平方律检波，并在积分时间 $ \\tau $ 内进行平均。\n\n从基本的热噪声概念和瑞利-金斯定律出发，在积分时间 $ \\tau $ 内增益涨落可忽略的情况下，推导全功率辐射计中噪声等效温差 (NEΔT)、$T_{\\text{sys}}$、$B$ 和 $\\tau$ 之间的关系。然后，使用推导出的关系，计算在给定的 $B$ 和 $T_{\\text{sys}}$ 条件下，实现 $\\text{NE}\\Delta T = 0.2$ K 所需的积分时间 $ \\tau $。\n\n将最终数值答案四舍五入到四位有效数字。积分时间以秒为单位表示。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它为微波辐射测量中的一个标准问题提供了完整且一致的设置。\n\n解答过程分为两部分：首先，推导噪声等效温差 (NEΔT) 的关系式；其次，计算所需的积分时间 $\\tau$。\n\n**第一部分：NEΔT 关系式的推导**\n\n无源微波辐射测量的基础在于热辐射物理学。对于物理温度为 $T$ 的黑体源，其光谱辐射亮度 $L_\\nu$ 由普朗克定律给出。在微波频率范围内，通常满足条件 $h \\nu \\ll k_{B} T$，其中 $h$ 是普朗克常数，$\\nu$ 是频率，$k_B$ 是玻尔兹曼常数，$T$ 是温度。这使得可以使用瑞利-金斯近似：\n$$L_\\nu \\approx \\frac{2 \\nu^2 k_B T}{c^2}$$\n其中 $c$ 是光速。天线接收到的功率与该辐射亮度有关，并且方便地将此功率用等效温度（即亮温）来表示。\n\n根据电路理论，温度为 $T$ 的电阻在频率带宽 $B$ 上可提供的最大热噪声功率 $P_n$ 由奈奎斯特公式给出。在瑞利-金斯极限下，这简化为：\n$$P_n = k_B T B$$\n无源微波辐射计的设计目的就是测量这种噪声功率。接收机输入端的总噪声功率由系统噪声温度 $T_{\\text{sys}}$ 来表征。该温度是天线温度（由观测场景引起）和接收机各部件贡献的噪声温度之和。因此，接收机系统的输入噪声功率为：\n$$P_{\\text{in}} = k_B T_{\\text{sys}} B$$\n该输入信号是一个随机过程，对于热噪声，可以很好地将其建模为方差等于噪声功率的零均值高斯过程。\n\n全功率辐射计的基本形式包括一个中心频率为 $\\nu_0$、带宽为 $B$ 的带通滤波器，其后跟一个增益为 $G$ 的放大器、一个平方律检波器和一个积分器（平均器）。\n\n$1$. 平方律检波器输入端的功率为 $P_{det} = G P_{\\text{in}} = G k_B T_{\\text{sys}} B$。\n$2$. 平方律检波器产生一个与其输入功率成正比的输出电压。设检波器输出电压为 $V_d(t) = C_{det} P_{in,inst}(t)$，其中 $P_{in,inst}(t)$ 是瞬时输入功率，$C_{det}$ 是检波器的转换常数。检波器输出电压的均值与平均输入功率成正比：\n$$\\langle V_d \\rangle = C_{det} \\langle P_{in,inst}(t) \\rangle = C_{det} (G k_B T_{\\text{sys}} B)$$\n这表明平均输出电压与系统温度 $T_{\\text{sys}}$ 直接成正比，而 $T_{\\text{sys}}$ 就是我们期望的信号。我们可以将其简写为 $\\langle V_d \\rangle = K T_{\\text{sys}}$，其中 $K = C_{det} G k_B B$ 是整个系统的增益常数。\n\n$3$. 平方律检波器的输出也包含围绕其均值的涨落（噪声）。对于输入为带宽为 $B$ 的带限高斯噪声，检波器输出电压的标准差 $\\sigma_{V_d}$ 等于其均值：\n$$\\sigma_{V_d} = \\langle V_d \\rangle = K T_{\\text{sys}}$$\n\n$4$. 积分器在指定的积分时间 $\\tau$ 内对检波器输出电压进行平均。这个平均过程减小了噪声的方差。在时间 $\\tau$ 内平均的独立样本数 $N$ 近似等于时间-带宽积，$N \\approx B\\tau$。$N$ 个独立随机变量的均值的标准差，等于单个变量的标准差除以 $\\sqrt{N}$。因此，最终积分输出电压的标准差 $\\Delta V_{\\text{out}}$ 为：\n$$\\Delta V_{\\text{out}} = \\frac{\\sigma_{V_d}}{\\sqrt{N}} = \\frac{K T_{\\text{sys}}}{\\sqrt{B\\tau}}$$\n\n$5$. 噪声等效温差 (NEΔT) 定义为能引起最终平均输出电压变化量等于该输出电压标准差的输入系统温度变化量。辐射计的灵敏度将输入温度的变化与输出电压的变化联系起来：\n$$\\Delta V_{\\text{out, signal}} = K \\cdot (\\text{NE}\\Delta T)$$\n根据 NEΔT 的定义，我们将信号变化量设为等于输出噪声水平：\n$$K \\cdot (\\text{NE}\\Delta T) = \\Delta V_{\\text{out}} = \\frac{K T_{\\text{sys}}}{\\sqrt{B\\tau}}$$\n\n$6$. 消去两边的系统增益常数 $K$，得到增益涨落可忽略的理想全功率辐射计的基本辐射计方程：\n$$\\text{NE}\\Delta T = \\frac{T_{\\text{sys}}}{\\sqrt{B\\tau}}$$\n这就是所要求的关系式。\n\n**第二部分：积分时间 $\\tau$ 的计算**\n\n题目要求我们根据给定的系统参数，计算实现特定 NEΔT 所需的积分时间 $\\tau$。我们首先重新整理推导出的公式来求解 $\\tau$：\n$$\\sqrt{B\\tau} = \\frac{T_{\\text{sys}}}{\\text{NE}\\Delta T}$$\n两边平方得到：\n$$B\\tau = \\left( \\frac{T_{\\text{sys}}}{\\text{NE}\\Delta T} \\right)^2$$\n最后，分离出 $\\tau$：\n$$\\tau = \\frac{1}{B} \\left( \\frac{T_{\\text{sys}}}{\\text{NE}\\Delta T} \\right)^2$$\n给定值为：\n系统噪声温度, $T_{\\text{sys}} = 800$ K。\n等效噪声带宽, $B = 18$ MHz $= 18 \\times 10^6$ Hz $= 1.8 \\times 10^7$ s$^{-1}$。\n目标噪声等效温差, NEΔT $= 0.2$ K。\n\n首先，我们计算温度的比值：\n$$\\frac{T_{\\text{sys}}}{\\text{NE}\\Delta T} = \\frac{800 \\text{ K}}{0.2 \\text{ K}} = 4000$$\n现在，将这个比值和带宽代入 $\\tau$ 的方程中：\n$$\\tau = \\frac{1}{1.8 \\times 10^7 \\text{ s}^{-1}} \\left( 4000 \\right)^2$$\n$$\\tau = \\frac{1}{1.8 \\times 10^7} \\left( 16 \\times 10^6 \\right) \\text{ s}$$\n$$\\tau = \\frac{16 \\times 10^6}{1.8 \\times 10^7} \\text{ s} = \\frac{1.6 \\times 10^7}{1.8 \\times 10^7} \\text{ s} = \\frac{1.6}{1.8} \\text{ s} = \\frac{16}{18} \\text{ s} = \\frac{8}{9} \\text{ s}$$\n为了得到数值，我们进行除法运算：\n$$\\tau = \\frac{8}{9} \\approx 0.888888... \\text{ s}$$\n题目要求答案四舍五入到四位有效数字。\n$$\\tau \\approx 0.8889 \\text{ s}$$",
            "answer": "$$\\boxed{0.8889}$$"
        },
        {
            "introduction": "星载辐射计的原始观测值来自大气层顶，而我们的研究目标通常是地球表面。本实践将带你解决“大气校正”这一关键问题，学习如何应用辐射传输方程，将地表自身的热辐射信号从大气的贡献中分离出来。掌握这项技能是从遥感数据中准确提取地表物理属性（如发射率）的基础。",
            "id": "3833302",
            "problem": "一颗卫星上搭载的天底观测无源微波辐射计在频率 $\\nu = 18.7\\,\\mathrm{GHz}$ 处观测一个半干旱陆地表面。测得的大气层顶 (TOA) 亮温为 $T_{b,\\mathrm{meas}} = 241\\,\\mathrm{K}$。一项独立的测温测量（例如，经过发射率和大气效应适当校正的地基红外反演）表明，物理表面（表层）温度为 $T_{s} = 296\\,\\mathrm{K}$。大气是水平均匀的、平面平行的，并且可以被建模为等温的，其物理温度为 $T_{a} = 270\\,\\mathrm{K}$，在 $\\nu = 18.7\\,\\mathrm{GHz}$ 处的天顶光学厚度为 $\\tau = 0.08$。在大气层之上，宇宙微波背景的亮温为 $T_{c} = 2.73\\,\\mathrm{K}$。陆地表面是不透明的，其界面遵循基尔霍夫热辐射定律，因此半球反射率 $R$ 和发射率 $e$ 满足 $R = 1 - e$。\n\n使用普朗克定律的瑞利-金斯极限将微波比辐射强度与亮温联系起来，并从一维平面平行辐射传输方程和空气-地表界面的适当边界条件出发，推导出一个将测量的TOA亮温 $T_{b,\\mathrm{meas}}$ 与未知的有效表面发射率 $e$ 联系起来的关系式。然后，使用给定的数值输入，求解 $e$。将你的数值答案四舍五入到四位有效数字，并将其表示为一个无量纲数。\n\n最后，仅基于推导出的关系式的结构（不进行任何额外的数值计算），简要讨论忽略大气的非等温性和表面微粗糙度会如何使推断出的 $e$ 相对于其真实值产生向上或向下的偏差。",
            "solution": "该问题要求推导表面发射率的表达式，进行数值计算，并对模型简化带来的偏差进行定性讨论。该分析基于瑞利-金斯极限下的辐射传输方程 (RTE)，其中比辐射强度与亮温成线性比例。\n\n首先，我们推导有效表面发射率 $e$ 的关系式。对于观测一个无散射、平面平行大气的天底观测辐射计，测得的大气层顶 (TOA) 亮温 $T_{b,\\mathrm{meas}}$ 可以表示为两个分量的和：\n$1$. 来自地表的上行辐射 $T_{b,\\text{surf,up}}$，被大气衰减。\n$2$. 来自大气自身的上行热辐射 $T_{b,\\text{up,atm}}$。\n\n大气衰减由透过率 $\\Gamma = \\exp(-\\tau)$ 来表征，其中 $\\tau$ 是天顶光学厚度。对于一个物理温度为 $T_a$ 的等温大气，上行大气辐射为 $T_{b,\\text{up,atm}} = T_a(1 - \\exp(-\\tau))$。\n因此，TOA亮温为：\n$$T_{b,\\mathrm{meas}} = T_{b,\\text{surf,up}} \\exp(-\\tau) + T_a(1 - \\exp(-\\tau))$$\n这个方程可以被反演，以根据TOA的测量值和大气属性来求得离开地表的亮温：\n$$T_{b,\\text{surf,up}} = \\frac{T_{b,\\mathrm{meas}} - T_a(1 - \\exp(-\\tau))}{\\exp(-\\tau)}$$\n\n接下来，我们对离开地表的辐射 $T_{b,\\text{surf,up}}$ 进行建模。它由两部分组成：\n$1$. 来自地表自身的热辐射。\n$2$. 地表对下行的大气和宇宙辐射的反射。\n\n对于一个发射率为 $e$、物理温度为 $T_s$ 的不透明表面，其辐射分量为 $e T_s$。根据基尔霍夫定律，反射率为 $R = 1 - e$。因此，反射分量为 $(1-e)T_{b,\\text{down,surf}}$，其中 $T_{b,\\text{down,surf}}$ 是入射到地表的总下行亮温。\n$$T_{b,\\text{surf,up}} = e T_s + (1-e) T_{b,\\text{down,surf}}$$\n到达地表的下行辐射由被大气衰减的宇宙微波背景 (CMB) 辐射 $T_c$ 和来自大气的下行热辐射 $T_{b,\\text{down,atm}}$ 组成。\n对于等温大气，下行辐射等于上行辐射：$T_{b,\\text{down,atm}} = T_a(1 - \\exp(-\\tau))$。\n到达地表的总下行辐射为：\n$$T_{b,\\text{down,surf}} = T_c \\exp(-\\tau) + T_a(1 - \\exp(-\\tau))$$\n\n现在我们得到了一个用未知发射率 $e$ 表示 $T_{b,\\text{surf,up}}$ 的表达式。通过重新整理这个表达式，我们可以求解 $e$：\n$$T_{b,\\text{surf,up}} - T_{b,\\text{down,surf}} = e T_s + (1-e) T_{b,\\text{down,surf}} - T_{b,\\text{down,surf}}$$\n$$T_{b,\\text{surf,up}} - T_{b,\\text{down,surf}} = e T_s - e T_{b,\\text{down,surf}} = e(T_s - T_{b,\\text{down,surf}})$$\n这给出了发射率 $e$ 的最终推导关系式：\n$$e = \\frac{T_{b,\\text{surf,up}} - T_{b,\\text{down,surf}}}{T_s - T_{b,\\text{down,surf}}}$$\n这个关系式通过物理温度和大气属性，将测量值 $T_{b,\\mathrm{meas}}$（嵌入在 $T_{b,\\text{surf,up}}$ 项中）与发射率 $e$ 联系起来。\n\n第二，我们使用给定的数值来计算 $e$。\n已知：\n- $T_{b,\\mathrm{meas}} = 241\\,\\mathrm{K}$\n- $T_{s} = 296\\,\\mathrm{K}$\n- $T_{a} = 270\\,\\mathrm{K}$\n- $\\tau = 0.08$\n- $T_{c} = 2.73\\,\\mathrm{K}$\n\n我们计算中间量：\n大气透过率为 $\\exp(-\\tau) = \\exp(-0.08) \\approx 0.923116$。\n大气不透明度项为 $1 - \\exp(-\\tau) \\approx 1 - 0.923116 = 0.076884$。\n\n到达地表的下行亮温为：\n$$T_{b,\\text{down,surf}} = T_c \\exp(-\\tau) + T_a(1 - \\exp(-\\tau))$$\n$$T_{b,\\text{down,surf}} \\approx (2.73\\,\\mathrm{K})(0.923116) + (270\\,\\mathrm{K})(0.076884) \\approx 2.5194\\,\\mathrm{K} + 20.7587\\,\\mathrm{K} \\approx 23.2781\\,\\mathrm{K}$$\n\n离开地表的上行亮温为：\n$$T_{b,\\text{surf,up}} = \\frac{T_{b,\\mathrm{meas}} - T_a(1 - \\exp(-\\tau))}{\\exp(-\\tau)}$$\n$$T_{b,\\text{surf,up}} \\approx \\frac{241\\,\\mathrm{K} - (270\\,\\mathrm{K})(0.076884)}{0.923116} \\approx \\frac{241\\,\\mathrm{K} - 20.7587\\,\\mathrm{K}}{0.923116} \\approx \\frac{220.2413\\,\\mathrm{K}}{0.923116} \\approx 238.5830\\,\\mathrm{K}$$\n\n最后，我们计算发射率 $e$：\n$$e = \\frac{T_{b,\\text{surf,up}} - T_{b,\\text{down,surf}}}{T_s - T_{b,\\text{down,surf}}}$$\n$$e \\approx \\frac{238.5830\\,\\mathrm{K} - 23.2781\\,\\mathrm{K}}{296\\,\\mathrm{K} - 23.2781\\,\\mathrm{K}} = \\frac{215.3049\\,\\mathrm{K}}{272.7219\\,\\mathrm{K}} \\approx 0.789473$$\n四舍五入到四位有效数字，表面发射率是 $e \\approx 0.7895$。\n\n第三，我们基于关系式 $e = (T_{b,\\text{surf,up}} - T_{b,\\text{down,surf}})/(T_s - T_{b,\\text{down,surf}})$ 的结构，讨论模型简化假设对推断出的发射率 $e$ 产生的潜在偏差。\n\n关于非等温大气：真实大气是非等温的，温度通常随高度增加而降低。到达地表的下行辐射 $T_{b,\\text{down,surf}}$ 对最低、最暖的大气层的温度最为敏感。用于大气校正的上行辐射项 $T_{b,\\text{up,atm}}$ 对更广的高度范围敏感。单一有效温度 $T_a$ 是一个近似。通常，下行辐射的有效温度高于上行辐射的有效温度（$T_{a,\\text{down}} > T_{a,\\text{up}}$）。等温模型假设 $T_{a,\\text{down}} = T_{a,\\text{up}} = T_a$。如果我们选择 $T_a$ 为一个合理的平均大气温度，该模型很可能会低估真实的下行辐射，因为后者主要由较暖的近地表空气决定（$T_{b,\\text{down,surf, model}}  T_{b,\\text{down,surf, true}}$）。令 $e = f(T_{b,\\text{down,surf}})$。该函数相对于 $T_{b,\\text{down,surf}}$ 的导数为 $f' = (T_{b,\\text{surf,up}} - T_s)/(T_s - T_{b,\\text{down,surf}})^2$。由于地表亮温低于其物理温度（$T_{b,\\text{surf,up}}  T_s$），该导数为负。因此，低估 $T_{b,\\text{down,surf}}$ 会导致对 $e$ 的高估。因此，忽略大气的非等温性会在反演的发射率中引入向上偏差。\n\n关于表面微粗糙度：该模型假设表面是光滑的（例如，镜面或朗伯体）。真实表面具有微粗糙度，这有两个主要效应。首先，它倾向于增加有效发射率（“空腔效应”）。其次，它引起下行辐射的漫散射。下行辐射是各向异性的，在更大的天顶角（更长的大气路径）处更亮。粗糙表面会将这种更亮的非天顶辐射散射到传感器的天底观测方向。相比之下，光滑表面模型只考虑了较暗的天顶下行辐射的反射。这意味着从粗糙表面反射到传感器的总辐射 $T_{\\text{refl,rough}}$，对于相同的内在材料属性，要大于光滑模型的预测值。光滑模型将所有上行辐射都解释为一个有效发射率 $e_{\\text{inf}}$。由于真实表面提供的反射分量比模型预期的要大，模型必须将这部分多余的辐射归因于表面发射，从而夸大了反演的发射率值。因此，忽略表面微粗糙度也会使推断的发射率相对于表面的真实有效发射率偏高。",
            "answer": "$$\\boxed{0.7895}$$"
        },
        {
            "introduction": "我们从观测中获得的地表发射率富含着关于地球物理参数（如土壤湿度）的信息。本实践将引导你利用菲涅尔方程，将发射率这一宏观属性与地表介质的复介电常数 $\\epsilon$ 这一基本物理量联系起来。通过编程实现并进行敏感性分析，你将定量地探索土壤湿度的变化如何影响亮温信号，从而揭示微波遥感监测土壤水分的物理基础。",
            "id": "3833292",
            "problem": "一束微波频率的平面电磁波从自由空间入射到一个半无限、均匀、非磁性的土壤半空间，该半空间的特征由复相对介电常数 $\\epsilon = \\epsilon^{\\prime} - i \\epsilon^{\\prime\\prime}$ 描述。界面是平面的，入射角 $\\theta_i$ 是相对于表面法线而言的。考虑相对于入射面定义的两种线性极化：水平极化（$H$，也称为 $s$-极化），其电场垂直于入射面；以及垂直极化（$V$，也称为 $p$-极化），其电场在入射面内。假设界面上方的自由空间相对介电常数 $\\epsilon_1 = 1$，相对磁导率 $\\mu_1 = \\mu_2 = 1$。\n\n从强制界面上切向电场和磁场连续的电磁边界条件出发，可以推导出 $s$-极化和 $p$-极化的振幅反射系数，作为入射角和下层介质复介电常数的函数。每种极化的反射率（功率反射系数）是相应振幅反射系数的模平方。根据基尔霍夫热辐射定律和微波频率下的瑞利-金斯近似，对于一个等温、电厚的半空间，方向发射率 $e$ 满足 $e = 1 - \\mathcal{R}$，其中 $\\mathcal{R}$ 是相同方向和极化的反射率，亮度温度 $T_b$ 为 $T_b = e T_s$，其中 $T_s$ 是热力学表面温度。\n\n您的任务是实现一个程序，为每个指定的测试用例，计算在给定入射角 $\\theta_i$ 下的方向发射率 $e_H$ 和 $e_V$，并使用有限差分法分析这些系数对 $\\epsilon^{\\prime}$ 和 $\\epsilon^{\\prime\\prime}$ 微小变化的灵敏度。然后，利用提供的土壤复介电常数相对于体积土壤湿度 $\\theta$（单位为 $\\mathrm{m^3/m^3}$，无量纲）的局部线性化关系，通过链式法则将发射率灵敏度转换为亮度温度对土壤湿度的灵敏度。最后，报告在无损耗近似下（仅使用 $\\epsilon^{\\prime}$）$p$-极化的近似布儒斯特角，以及 $\\theta_i$ 与此布儒斯特角之间的绝对角度偏移。\n\n推导和计算的基本依据：\n- 使用两个各向同性线性介质之间平面界面上的电磁边界条件，结合斯涅尔定律和非磁性假设（$\\mu_1 = \\mu_2 = 1$），得到 $s$-极化和 $p$-极化的振幅反射系数，作为 $\\theta_i$ 和复数 $\\epsilon$ 的函数。\n- 在微波瑞利-金斯区域，对于半无限、等温介质，将反射率定义为振幅反射系数的模平方，发射率定义为 $e = 1 - \\mathcal{R}$。\n- 使用链式法则将发射率灵敏度转换为亮度温度对土壤湿度 $\\theta$ 的灵敏度。\n\n实现要求：\n- 对于每个测试用例，计算在给定入射角 $\\theta_i$ 下的 $e_H$ 和 $e_V$（角度以度为单位指定；三角函数计算可在内部使用弧度）。\n- 通过对称有限差分法计算偏导数 $\\partial e_H / \\partial \\epsilon^{\\prime}$、$\\partial e_H / \\partial \\epsilon^{\\prime\\prime}$、$\\partial e_V / \\partial \\epsilon^{\\prime}$ 和 $\\partial e_V / \\partial \\epsilon^{\\prime\\prime}$，扰动量为 $\\delta \\epsilon^{\\prime} = 10^{-3}$ 和 $\\delta \\epsilon^{\\prime\\prime} = 10^{-3}$。\n- 使用提供的局部灵敏度 $\\mathrm{d}\\epsilon^{\\prime}/\\mathrm{d}\\theta$ 和 $\\mathrm{d}\\epsilon^{\\prime\\prime}/\\mathrm{d}\\theta$，计算亮度温度对体积土壤湿度 $\\theta$ 的灵敏度：\n  $$\\frac{\\mathrm{d} T_{b,H}}{\\mathrm{d}\\theta} = T_s \\left( \\frac{\\partial e_H}{\\partial \\epsilon^{\\prime}} \\frac{\\mathrm{d}\\epsilon^{\\prime}}{\\mathrm{d}\\theta} + \\frac{\\partial e_H}{\\partial \\epsilon^{\\prime\\prime}} \\frac{\\mathrm{d}\\epsilon^{\\prime\\prime}}{\\mathrm{d}\\theta} \\right), \\quad \\frac{\\mathrm{d} T_{b,V}}{\\mathrm{d}\\theta} = T_s \\left( \\frac{\\partial e_V}{\\partial \\epsilon^{\\prime}} \\frac{\\mathrm{d}\\epsilon^{\\prime}}{\\mathrm{d}\\theta} + \\frac{\\partial e_V}{\\partial \\epsilon^{\\prime\\prime}} \\frac{\\mathrm{d}\\epsilon^{\\prime\\prime}}{\\mathrm{d}\\theta} \\right)。$$\n- 在无损耗近似下计算 $p$-极化的近似布儒斯特角：\n  $$\\theta_B = \\arctan\\left(\\sqrt{\\epsilon^{\\prime}}\\right),$$\n  以度表示，并计算绝对差值 $|\\theta_i - \\theta_B|$（以度为单位）。\n\n物理和数值单位及精度：\n- 频率固定在L波段，$f = 1.41 \\times 10^9 \\ \\mathrm{Hz}$；它为 $\\epsilon$ 提供了背景，但不是菲涅尔系数的显式输入。\n- 输入和报告的角度差值必须视为度；内部计算可使用弧度。\n- 表面温度 $T_s$ 必须以开尔文（$\\mathrm{K}$）为单位处理。\n- 体积土壤湿度 $\\theta$ 是无量纲的，单位为 $\\mathrm{m^3/m^3}$。\n- 亮度温度灵敏度 $\\mathrm{d} T_{b}/\\mathrm{d}\\theta$ 必须以 $\\mathrm{K}$ 每 $\\mathrm{m^3/m^3}$ 表示。\n\n测试套件：\n对于每个测试用例，参数以 $(\\theta_i \\text{ 度}, \\epsilon^{\\prime}, \\epsilon^{\\prime\\prime}, T_s \\text{ K}, \\mathrm{d}\\epsilon^{\\prime}/\\mathrm{d}\\theta, \\mathrm{d}\\epsilon^{\\prime\\prime}/\\mathrm{d}\\theta)$ 的形式给出。\n\n- 测试用例 1（典型的中等湿度土壤，中等入射角）：$(40.0, \\ 10.0, \\ 2.0, \\ 300.0, \\ 15.0, \\ 1.5)$。\n- 测试用例 2（接近 $\\epsilon^{\\prime} \\approx 5.0$ 的布儒斯特角入射）：$(65.0, \\ 5.0, \\ 0.5, \\ 300.0, \\ 12.0, \\ 1.0)$。\n- 测试用例 3（垂直入射边界）：$(0.0, \\ 3.0, \\ 0.2, \\ 300.0, \\ 10.0, \\ 0.5)$。\n- 测试用例 4（高损耗湿润土壤）：$(55.0, \\ 20.0, \\ 5.0, \\ 300.0, \\ 20.0, \\ 2.0)$。\n\n最终输出规范：\n- 对于每个测试用例，按顺序计算并输出以下10个量：\n  $e_H$、$e_V$、$\\partial e_H / \\partial \\epsilon^{\\prime}$、$\\partial e_H / \\partial \\epsilon^{\\prime\\prime}$、$\\partial e_V / \\partial \\epsilon^{\\prime}$、$\\partial e_V / \\partial \\epsilon^{\\prime\\prime}$、$\\mathrm{d} T_{b,H}/\\mathrm{d}\\theta$、$\\mathrm{d} T_{b,V}/\\mathrm{d}\\theta$、$\\theta_B$（度）、$|\\theta_i - \\theta_B|$（度）。\n- 将所有输出表示为四舍五入到6位小数的浮点数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，对于4个测试用例，格式为 $[x_1,x_2,\\dots,x_{40}]$）。4个测试用例的结果必须按顺序连接，形成一个长度为40的列表。",
            "solution": "该问题被认为是有效的，因为它在科学上基于电磁学和热力学原理，问题陈述清晰且信息充分，足以得到唯一解，并且其表述是客观的。因此，我们可以着手进行合理的求解。\n\n该问题要求计算微波发射率、其对土壤半空间介电特性的灵敏度，以及随后亮度温度对土壤湿度的灵敏度。物理模型包括一个位于两种半无限、均匀、各向同性和非磁性介质之间的平面界面。介质1是自由空间，其相对介电常数 $\\epsilon_1 = 1$，相对磁导率 $\\mu_1 = 1$。介质2是土壤，其特征是复相对介电常数 $\\epsilon = \\epsilon' - i\\epsilon''$ 和相对磁导率 $\\mu_2 = 1$。一束平面波从介质1入射，入射角为 $\\theta_i$（相对于法线）。\n\n解法源于菲涅尔方程，这些方程描述了电磁波在界面上的反射和透射。这些方程本身是从麦克斯韦方程组推导出的边界条件（切向电场和磁场的连续性）应用的结果。\n\n对于非磁性介质（$\\mu_1 = \\mu_2 = 1$），折射率分别为 $n_1 = \\sqrt{\\epsilon_1} = 1$ 和 $n_2 = \\sqrt{\\epsilon}$。入射角 $\\theta_i$ 和透射角 $\\theta_t$ 之间的关系由斯涅尔定律给出：$n_1 \\sin\\theta_i = n_2 \\sin\\theta_t$。\n\n水平极化（$H$，或 $s$-极化）和垂直极化（$V$，或 $p$-极化）的振幅反射系数由以下公式给出：\n$$r_H = \\frac{n_1 \\cos\\theta_i - n_2 \\cos\\theta_t}{n_1 \\cos\\theta_i + n_2 \\cos\\theta_t}$$\n$$r_V = \\frac{n_2 \\cos\\theta_i - n_1 \\cos\\theta_t}{n_2 \\cos\\theta_i + n_1 \\cos\\theta_t}$$\n\n为了完全用 $\\theta_i$ 和介电特性来表示这些系数，我们消去 $\\theta_t$。根据斯涅尔定律，$\\sin\\theta_t = (n_1/n_2) \\sin\\theta_i$。那么，$\\cos\\theta_t = \\sqrt{1 - \\sin^2\\theta_t} = \\sqrt{1 - (n_1^2/n_2^2) \\sin^2\\theta_i} = \\frac{1}{n_2}\\sqrt{n_2^2 - n_1^2 \\sin^2\\theta_i}$。代入 $n_1 = 1$ 和 $n_2 = \\sqrt{\\epsilon}$，反射系数变为：\n$$r_H = \\frac{\\cos\\theta_i - \\sqrt{\\epsilon - \\sin^2\\theta_i}}{\\cos\\theta_i + \\sqrt{\\epsilon - \\sin^2\\theta_i}}$$\n$$r_V = \\frac{\\epsilon \\cos\\theta_i - \\sqrt{\\epsilon - \\sin^2\\theta_i}}{\\epsilon \\cos\\theta_i + \\sqrt{\\epsilon - \\sin^2\\theta_i}}$$\n这里，$\\epsilon = \\epsilon' - i\\epsilon''$ 是一个复数，平方根运算必须在复平面中进行。物理上正确的根是主根，其实部为非负，这确保了波在有损耗介质中会衰减。\n\n反射率 $\\mathcal{R}_p$（对于极化 $p \\in \\{H, V\\}$）是入射功率中被反射的部分，由振幅反射系数的模平方给出：\n$$\\mathcal{R}_p = |r_p|^2$$\n\n对于微波波段（其中瑞利-金斯近似成立）下的一个等温、均匀且电厚（不透明）的介质，基尔霍夫热辐射定律简化为方向发射率 $e_p$ 和反射率之间的关系：\n$$e_p = 1 - \\mathcal{R}_p$$\n\n在相同方向上观测到的亮度温度 $T_{b,p}$ 是发射率和物理表面温度 $T_s$ 的乘积：\n$$T_{b,p} = e_p T_s$$\n\n为了分析发射率对复介电常数分量微小变化的灵敏度，我们计算偏导数 $\\partial e_p/\\partial\\epsilon'$ 和 $\\partial e_p/\\partial\\epsilon''$。这通过对称有限差分近似进行数值计算：\n$$\\frac{\\partial e_p}{\\partial \\epsilon'} \\approx \\frac{e_p(\\epsilon'+\\delta\\epsilon', \\epsilon'') - e_p(\\epsilon'-\\delta\\epsilon', \\epsilon'')}{2\\delta\\epsilon'}$$\n$$\\frac{\\partial e_p}{\\partial \\epsilon''} \\approx \\frac{e_p(\\epsilon', \\epsilon''+\\delta\\epsilon'') - e_p(\\epsilon', \\epsilon''-\\delta\\epsilon'')}{2\\delta\\epsilon''}$$\n其中 $\\delta\\epsilon' = 10^{-3}$ 和 $\\delta\\epsilon'' = 10^{-3}$ 是指定的小扰动。\n\n亮度温度对体积土壤湿度 $\\theta$ 的灵敏度使用链式法则求得。鉴于 $e_p$ 是 $\\epsilon'(\\theta)$ 和 $\\epsilon''(\\theta)$ 的函数，且 $T_s$ 相对于 $\\theta$ 是常数，我们有：\n$$\\frac{\\mathrm{d} T_{b,p}}{\\mathrm{d}\\theta} = T_s \\frac{\\mathrm{d} e_p}{\\mathrm{d}\\theta} = T_s \\left( \\frac{\\partial e_p}{\\partial \\epsilon'} \\frac{\\mathrm{d}\\epsilon'}{\\mathrm{d}\\theta} + \\frac{\\partial e_p}{\\partial \\epsilon''} \\frac{\\mathrm{d}\\epsilon''}{\\mathrm{d}\\theta} \\right)$$\n每个测试用例都提供了 $\\mathrm{d}\\epsilon'/\\mathrm{d}\\theta$ 和 $\\mathrm{d}\\epsilon''/\\mathrm{d}\\theta$ 这两个项作为输入。\n\n最后，布儒斯特角 $\\theta_B$ 是指V极化（p极化）波的反射率为零时的入射角。对于无损耗电介质（$\\epsilon''=0$），这在 $r_V=0$ 时发生。该条件导出了著名的公式：\n$$\\theta_B = \\arctan\\left(\\frac{n_2}{n_1}\\right) = \\arctan(\\sqrt{\\epsilon'})$$\n问题要求计算这个近似的布儒斯特角（基于无损耗假设）及其与给定入射角的绝对差值 $|\\theta_i - \\theta_B|$。\n\n实现将包括一个主函数，该函数根据菲涅尔方程计算 $e_H$ 和 $e_V$。然后用扰动后的输入调用此函数，以计算有限差分导数。这些导数通过链式法则组合，以求得亮度温度灵敏度。布儒斯特角直接根据其公式计算。对提供的每个测试用例重复此过程。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_emissivities(theta_i_deg, eps_r, eps_i):\n    \"\"\"\n    Computes directional emissivities for horizontal (H) and vertical (V) polarizations.\n\n    Args:\n        theta_i_deg (float): Incidence angle in degrees.\n        eps_r (float): Real part of the relative permittivity.\n        eps_i (float): Imaginary part of the relative permittivity.\n\n    Returns:\n        tuple: A tuple containing (e_H, e_V).\n    \"\"\"\n    theta_i_rad = np.deg2rad(theta_i_deg)\n    epsilon = complex(eps_r, -eps_i)\n\n    cos_theta_i = np.cos(theta_i_rad)\n    sin2_theta_i = np.sin(theta_i_rad)**2\n\n    term_under_sqrt = epsilon - sin2_theta_i\n    # numpy.sqrt on a complex number returns the principal root, which is physically correct.\n    sqrt_term = np.sqrt(term_under_sqrt)\n\n    # Amplitude reflection coefficients (Fresnel equations)\n    # H-polarization (s-pol)\n    r_H = (cos_theta_i - sqrt_term) / (cos_theta_i + sqrt_term)\n    # V-polarization (p-pol)\n    r_V = (epsilon * cos_theta_i - sqrt_term) / (epsilon * cos_theta_i + sqrt_term)\n\n    # Reflectivities (power reflection coefficients)\n    R_H = np.abs(r_H)**2\n    R_V = np.abs(r_V)**2\n\n    # Emissivities\n    e_H = 1.0 - R_H\n    e_V = 1.0 - R_V\n\n    return e_H, e_V\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and generate the final output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (theta_i_deg, eps_prime, eps_double_prime, T_s_K, d(eps')/d(theta), d(eps'')/d(theta))\n        (40.0, 10.0, 2.0, 300.0, 15.0, 1.5),\n        (65.0, 5.0, 0.5, 300.0, 12.0, 1.0),\n        (0.0, 3.0, 0.2, 300.0, 10.0, 0.5),\n        (55.0, 20.0, 5.0, 300.0, 20.0, 2.0),\n    ]\n\n    all_results = []\n    \n    # Perturbations for finite difference calculation\n    delta_eps_r = 1e-3\n    delta_eps_i = 1e-3\n\n    for case in test_cases:\n        theta_i_deg, eps_r, eps_i, T_s, d_eps_r_d_theta, d_eps_i_d_theta = case\n\n        # 1. Compute emissivities for the central point\n        e_H, e_V = calculate_emissivities(theta_i_deg, eps_r, eps_i)\n\n        # 2. Compute partial derivatives of emissivity via symmetric finite differences\n        # Sensitivity to epsilon_prime\n        e_H_plus_r, e_V_plus_r = calculate_emissivities(theta_i_deg, eps_r + delta_eps_r, eps_i)\n        e_H_minus_r, e_V_minus_r = calculate_emissivities(theta_i_deg, eps_r - delta_eps_r, eps_i)\n        deH_deps_r = (e_H_plus_r - e_H_minus_r) / (2 * delta_eps_r)\n        deV_deps_r = (e_V_plus_r - e_V_minus_r) / (2 * delta_eps_r)\n\n        # Sensitivity to epsilon_double_prime\n        e_H_plus_i, e_V_plus_i = calculate_emissivities(theta_i_deg, eps_r, eps_i + delta_eps_i)\n        e_H_minus_i, e_V_minus_i = calculate_emissivities(theta_i_deg, eps_r, eps_i - delta_eps_i)\n        deH_deps_i = (e_H_plus_i - e_H_minus_i) / (2 * delta_eps_i)\n        deV_deps_i = (e_V_plus_i - e_V_minus_i) / (2 * delta_eps_i)\n\n        # 3. Compute brightness temperature sensitivities w.r.t. soil moisture\n        dTbH_dtheta = T_s * (deH_deps_r * d_eps_r_d_theta + deH_deps_i * d_eps_i_d_theta)\n        dTbV_dtheta = T_s * (deV_deps_r * d_eps_r_d_theta + deV_deps_i * d_eps_i_d_theta)\n\n        # 4. Compute approximate Brewster angle (lossless case) and its offset\n        theta_B_deg = np.rad2deg(np.arctan(np.sqrt(eps_r)))\n        offset_deg = np.abs(theta_i_deg - theta_B_deg)\n\n        case_results = [\n            e_H, e_V,\n            deH_deps_r, deH_deps_i,\n            deV_deps_r, deV_deps_i,\n            dTbH_dtheta, dTbV_dtheta,\n            theta_B_deg, offset_deg\n        ]\n        \n        # Round and collect results\n        all_results.extend([round(val, 6) for val in case_results])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```",
            "answer": "[0.722838,0.92348,-0.038318,-0.024976,-0.007142,-0.027004,-190.540188,-34.761005,72.474487,32.474487,0.730325,0.992683,-0.091176,-0.043588,0.000185,-0.020353,-331.042571,-4.249733,65.905157,0.905157,0.612871,0.612871,-0.126442,-0.028564,-0.126442,-0.028564,-380.753303,-380.753303,60.0,60.0,0.672322,0.901518,-0.01633,-0.012579,-0.003789,-0.014264,-105.51613,-25.390494,77.348612,22.348612]"
        }
    ]
}