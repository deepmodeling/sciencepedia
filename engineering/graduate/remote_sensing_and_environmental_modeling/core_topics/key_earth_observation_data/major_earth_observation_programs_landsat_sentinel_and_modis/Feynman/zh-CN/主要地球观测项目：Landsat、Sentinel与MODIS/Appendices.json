{
    "hands_on_practices": [
        {
            "introduction": "卫星传感器记录的原始数据，即数字量（$DN$），本身不具有物理意义。为了进行科学分析，我们必须将其转换为物理量，如辐射亮度或反射率。本练习将指导您完成从Landsat 8原始$DN$值到大气层顶（TOA）反射率的关键转换过程，这一过程是遥感数据预处理的基础。此外，本练习还引入了从定标系数中传播测量不确定性的重要概念，这是进行定量科学研究的一项核心技能。",
            "id": "3825717",
            "problem": "一景来自Landsat 8陆地成像仪（OLI）的Level-1场景提供了红波段中一个像素的数字量化值（DN）。Landsat的Level-1辐射定标是将DN线性映射到传感器处光谱辐亮度的过程，其基于元数据提供的乘性与加性辐射定标系数。在朗伯体假设下，大气层顶（TOA）双向反射率定义为反射辐亮度与入射的大气层外太阳辐照度之比，并考虑了日地距离和太阳天顶角几何。\n\n基于以上基础：\n- 连接DN与光谱辐亮度的Level-1线性辐射定标定义。\n- 在太阳天顶角下，朗伯目标TOA反射率的辐射度学定义。\n\n推导从DN转换为光谱辐亮度 $L_{\\lambda}$，再转换为TOA反射率 $\\rho$ 所需的表达式，并仅使用一阶（高斯）不确定性传播方法来传播辐射定标系数的不确定性。假设所有其他量都是精确的，并忽略大气路径项。\n\n对于Landsat 8 OLI波段4（红光）中的一个特定像素，给定以下数据：\n- 数字量化值 (DN): $Q = 12000$。\n- 辐射定标乘性系数: $M_{L} = 6.000 \\times 10^{-3}\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}\\,\\text{DN}^{-1}$，其标准不确定度为 $u(M_{L}) = 1.5 \\times 10^{-4}\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}\\,\\text{DN}^{-1}$。\n- 辐射定标加性系数: $A_{L} = 2.0 \\times 10^{-1}\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$，其标准不确定度为 $u(A_{L}) = 1.0 \\times 10^{-1}\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$。\n- Landsat 8 OLI波段4的平均大气层外太阳辐照度（波段内大气层外太阳常数）: $E_{\\text{SUN}} = 1.570 \\times 10^{3}\\ \\text{W}\\,\\text{m}^{-2}\\,\\mu\\text{m}^{-1}$。\n- 日地距离，以天文单位（AU）计: $d = 1.005$。\n- 太阳天顶角: $\\theta_{s} = 30^\\circ$。\n\n假设：\n- 将 $Q$, $E_{\\text{SUN}}$, $d$, 和 $\\theta_{s}$ 视为不确定性可忽略的常数。\n- 将 $M_{L}$ 和 $A_{L}$ 视为具有给定标准不确定度的独立（不相关）随机变量。\n- 使用一阶（高斯）不确定性传播方法。\n- 角度以度表示；三角函数应相应计算。\n- TOA反射率是无量纲的；以小数形式表示（无百分号）。\n\n计算仅由 $u(M_{L})$ 和 $u(A_{L})$ 引起的TOA反射率的标准不确定度 $u(\\rho)$。将最终结果四舍五入至三位有效数字。仅报告 $u(\\rho)$ 的最终数值（无单位）。",
            "solution": "该问题被认为是有效的，因为它科学地基于遥感辐射度学原理，问题设定良好，有足够的信息得出唯一解，并且其表述是客观的。\n\n任务是推导大气层顶（TOA）反射率 $\\rho$ 作为数字量化值（$Q$）和其他参数的函数表达式，然后计算由辐射定标系数 $M_L$ 和 $A_L$ 的不确定性所引起的该反射率的标准不确定度 $u(\\rho)$。\n\n首先，我们建立传感器原始数字量化值（$Q$）与传感器处光谱辐亮度 $L_{\\lambda}$ 之间的关系。如题所述，这是一个由乘性定标因子 $M_L$ 和加性定标因子 $A_L$ 定义的线性变换。\n$$L_{\\lambda} = M_{L} Q + A_{L}$$\n其中 $L_{\\lambda}$ 是光谱辐亮度，单位为 $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$。\n\n接下来，我们定义TOA反射率 $\\rho$。在朗伯体假设下，反射率是总反射能量与总入射能量之比。用辐亮度的形式表示，TOA反射率为：\n$$\\rho = \\frac{\\pi L_{\\lambda}}{E_{\\text{incident}}}$$\n其中 $L_{\\lambda}$ 是传感器观测到的反射辐亮度，而 $E_{\\text{incident}}$ 是入射到大气层顶部水平表面上的总太阳辐照度。因子 $\\pi$ 是对理想朗伯体表面在半球空间内进行立体角积分的结果。\n\n入射太阳辐照度 $E_{\\text{incident}}$ 必须由平均大气层外太阳辐照度 $E_{\\text{SUN}}$ 计算得出，需要校正两个因素：太阳天顶角 $\\theta_s$ 和日地距离 $d$（以天文单位AU计）。太阳天顶角的余弦值用于校正入射太阳通量在水平表面上的投影。反比平方定律（与 $1/d^2$ 成正比）用于校正因地球椭圆轨道引起的太阳辐照度变化。\n$$E_{\\text{incident}} = \\frac{E_{\\text{SUN}} \\cos(\\theta_s)}{d^2}$$\n\n将 $E_{\\text{incident}}$ 的表达式代入 $\\rho$ 的方程，我们得到：\n$$\\rho = \\frac{\\pi L_{\\lambda} d^2}{E_{\\text{SUN}} \\cos(\\theta_s)}$$\n\n现在，我们将第一个关于 $L_{\\lambda}$ 的方程代入此表达式，以获得TOA反射率作为输入DN和传感器/场景参数的完整模型：\n$$\\rho(Q, M_L, A_L, E_{\\text{SUN}}, d, \\theta_s) = \\frac{\\pi d^2}{E_{\\text{SUN}} \\cos(\\theta_s)} (M_{L} Q + A_{L})$$\n\n问题要求计算仅由 $M_L$ 和 $A_L$ 的不确定性引起的 $\\rho$ 的标准不确定度 $u(\\rho)$。所有其他变量（$Q$, $E_{\\text{SUN}}$, $d$, $\\theta_s$）均被视为精确常数。给定 $M_L$ 和 $A_L$ 是独立的。对于具有独立变量 $x$ 和 $y$ 的函数 $f(x, y)$，其一阶（高斯）不确定性传播公式为：\n$$u(f)^2 = \\left(\\frac{\\partial f}{\\partial x}\\right)^2 u(x)^2 + \\left(\\frac{\\partial f}{\\partial y}\\right)^2 u(y)^2$$\n将此公式应用于我们的函数 $\\rho(M_L, A_L)$：\n$$u(\\rho)^2 = \\left(\\frac{\\partial \\rho}{\\partial M_L}\\right)^2 u(M_L)^2 + \\left(\\frac{\\partial \\rho}{\\partial A_L}\\right)^2 u(A_L)^2$$\n\n我们计算 $\\rho$ 对 $M_L$ 和 $A_L$ 的偏导数：\n$$\\frac{\\partial \\rho}{\\partial M_L} = \\frac{\\partial}{\\partial M_L} \\left[ \\frac{\\pi d^2}{E_{\\text{SUN}} \\cos(\\theta_s)} (M_{L} Q + A_{L}) \\right] = \\frac{\\pi Q d^2}{E_{\\text{SUN}} \\cos(\\theta_s)}$$\n$$\\frac{\\partial \\rho}{\\partial A_L} = \\frac{\\partial}{\\partial A_L} \\left[ \\frac{\\pi d^2}{E_{\\text{SUN}} \\cos(\\theta_s)} (M_{L} Q + A_{L}) \\right] = \\frac{\\pi d^2}{E_{\\text{SUN}} \\cos(\\theta_s)}$$\n\n将这些导数代入不确定性传播公式：\n$$u(\\rho)^2 = \\left(\\frac{\\pi Q d^2}{E_{\\text{SUN}} \\cos(\\theta_s)}\\right)^2 u(M_L)^2 + \\left(\\frac{\\pi d^2}{E_{\\text{SUN}} \\cos(\\theta_s)}\\right)^2 u(A_L)^2$$\n我们可以提出公因式：\n$$u(\\rho)^2 = \\left(\\frac{\\pi d^2}{E_{\\text{SUN}} \\cos(\\theta_s)}\\right)^2 \\left[ (Q u(M_L))^2 + u(A_L)^2 \\right]$$\n\n现在我们代入给定的数值：\n- $Q = 12000$\n- $u(M_{L}) = 1.5 \\times 10^{-4}$\n- $u(A_{L}) = 1.0 \\times 10^{-1}$\n- $E_{\\text{SUN}} = 1.570 \\times 10^{3}$\n- $d = 1.005$\n- $\\theta_{s} = 30^\\circ$\n\n首先，计算括号内的项：\n$$(Q u(M_L))^2 = (12000 \\times 1.5 \\times 10^{-4})^2 = (1.8)^2 = 3.24$$\n$$u(A_L)^2 = (1.0 \\times 10^{-1})^2 = 0.01$$\n\n这些平方项的和是：\n$$(Q u(M_L))^2 + u(A_L)^2 = 3.24 + 0.01 = 3.25$$\n\n接下来，计算前置因子的平方。我们使用 $\\cos(30^\\circ) = \\frac{\\sqrt{3}}{2}$。\n$$\\left(\\frac{\\pi d^2}{E_{\\text{SUN}} \\cos(\\theta_s)}\\right)^2 = \\left(\\frac{\\pi (1.005)^2}{(1.570 \\times 10^{3}) \\times \\frac{\\sqrt{3}}{2}}\\right)^2$$\n$$\\left(\\frac{\\pi \\times 1.010025}{1359.6601...}\\right)^2 \\approx (0.00233370...)^2 \\approx 5.44614 \\times 10^{-6}$$\n\n现在，将两部分相乘以求得 $u(\\rho)^2$：\n$$u(\\rho)^2 \\approx (5.44614 \\times 10^{-6}) \\times 3.25 \\approx 1.769996 \\times 10^{-5}$$\n\n最后，取平方根以求得标准不确定度 $u(\\rho)$：\n$$u(\\rho) = \\sqrt{1.769996 \\times 10^{-5}} \\approx 0.00420713$$\n\n根据要求将结果四舍五入至三位有效数字：\n$$u(\\rho) \\approx 0.00421$$",
            "answer": "$$\\boxed{0.00421}$$"
        },
        {
            "introduction": "由于云、阴影、气溶胶或传感器问题，并非所有卫星观测数据都具有可用的质量。因此，在进行任何分析之前，对数据进行质量筛选是保证科学结论可靠性的关键一步。本练习以MODIS数据为例，深入探讨了解析和解释位打包（bit-packed）质量评估（QA）标志的实用技术，以构建一个严格的过滤器，只保留最高质量的像素用于后续分析。掌握这种基于位运算的筛选方法对于处理现代遥感数据集至关重要。",
            "id": "3825837",
            "problem": "给定一个表示像素质量的复合质量评估 (QA) 整数，该整数旨在单个位打包字中表示中分辨率成像光谱仪 (MODIS) 的地表反射率和大气状态信息的质量。您必须解构其位结构，推导出一个逻辑上严格的高质量过滤器，并计算满足该过滤器的像素所占的保留比例。目标是实施一种基于二进制表示和逻辑运算符的原则性策略，以确保质量筛选中的科学真实性。复合 QA 整数使用以下位布局，位位置从最低有效位（位置 $0$）开始计数：\n\n- 地表反射率质量（低 $8$ 位）：\n  - 位 $0$–$1$（两位字段）：地表反射率的 MODLAND 质量\n    - $00$：以理想质量生成的校正产品（可接受）\n    - $01$：质量欠佳（对于严格过滤器应拒绝）\n    - $10$：因云未生成校正产品（拒绝）\n    - $11$：因其他原因未生成校正产品（拒绝）\n  - 位 $2$–$3$（两位字段）：波段质量摘要\n    - $00$：最高（可接受）\n    - $01$：良好（对于严格过滤器应拒绝）\n    - $10$：一般（拒绝）\n    - $11$：差（拒绝）\n  - 位 $4$（单位字段）：气溶胶反演成功\n    - $0$：成功（可接受）\n    - $1$：失败（拒绝）\n  - 位 $5$（单位字段）：邻近校正标志\n    - $0$：不需要（对于严格的以陆地为重点的过滤器是可接受的）\n    - $1$：已执行（对于此严格过滤器应拒绝）\n- 大约 $1$ 公里处的状态（高 $8$ 位）：\n  - 位 $8$–$9$（两位字段）：云状态\n    - $00$：晴朗（可接受）\n    - $01$：多云（拒绝）\n    - $10$：混合（拒绝）\n    - $11$：未设置（拒绝）\n  - 位 $10$（单位字段）：云阴影\n    - $0$：无（可接受）\n    - $1$：有（拒绝）\n  - 位 $11$（单位字段）：陆地或水体\n    - $1$：陆地（有资格考虑）\n    - $0$：水体（无资格；从分母中排除）\n  - 位 $12$–$13$（两位字段）：气溶胶含量\n    - $00$：低或气候学值（可接受）\n    - $01$：平均（对于严格过滤应拒绝）\n    - $10$：高（拒绝）\n    - $11$：缺失（拒绝）\n  - 位 $14$–$15$（两位字段）：卷云检测\n    - $00$：无（可接受）\n    - $01$：少量（拒绝）\n    - $10$：平均（拒绝）\n    - $11$：大量（拒绝）\n\n您的程序必须：\n- 使用上述位字段定义来解释每个提供的像素 QA 整数。\n- 为一个像素定义一个高质量谓词，该谓词是上述所有可接受状态的逻辑合取。一个像素当且仅当同时满足以下所有条件时，才被视为高质量：\n  - 地表反射率质量字段：位 $0$–$1$ 等于 $00$，位 $2$–$3$ 等于 $00$，位 $4$ 等于 $0$，位 $5$ 等于 $0$。\n  - 状态字段：位 $8$–$9$ 等于 $00$，位 $10$ 等于 $0$，位 $11$ 等于 $1$，位 $12$–$13$ 等于 $00$，位 $14$–$15$ 等于 $00$。\n- 将保留比例的分母定义为标记为陆地（位 $11$ 等于 $1$）的像素数量。标记为水体（位 $11$ 等于 $0$）的像素从分子和分母中排除。\n- 将分子定义为满足高质量谓词的陆地像素数量。\n- 在分母等于 $0$（无陆地像素）的边界情况下，按惯例将保留比例定义为 $0.0$。\n- 将每个保留比例表示为无量纲小数，并四舍五入到六位小数。\n\n您的推导必须以整数的二进制表示、按位逻辑运算和指示函数为基础。您可以使用整除、取模、位移和位掩码来隔离和测试字段。避免使用任何未从所述位字段语义中演绎推导出的启发式规则。\n\n测试套件：\n对于每个测试用例，您将得到一个 QA 整数列表。对于每个测试用例，按规定计算一个保留比例值。\n\n- 测试用例 1（混合质量，混合陆地/水体）：\n  - 数据：[$2048$, $2304$, $10240$, $2049$, $0$, $2064$, $18432$, $2048$]\n- 测试用例 2（无陆地像素）：\n  - 数据：[$0$, $256$, $16384$]\n- 测试用例 3（全部为晴朗高质量陆地）：\n  - 数据：[$2048$, $2048$, $2048$, $2048$, $2048$]\n- 测试用例 4（全部为陆地，但有各种不合格问题）：\n  - 数据：[$6144$, $2080$, $3072$, $2056$, $34816$]\n- 测试用例 5（单个陆地像素，波段质量不满足严格标准）：\n  - 数据：[$2052$]\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个保留比例都四舍五入到六位小数，并与测试用例的顺序相同（例如，[$0.123456$,$0.000000$,$1.000000$,$0.500000$,$0.250000$]）。",
            "solution": "该问题要求为模拟的中分辨率成像光谱仪 (MODIS) 质量评估 (QA) 数据实现一个严格的质量过滤算法。每个像素的质量被编码在一个单一整数中，这是一个位打包字，必须对其进行解构并根据一组严格的标准进行评估。最终目标是计算高质量陆地像素相对于总陆地像素数的比例。\n\n该方法论基于二进制算术和按位逻辑运算的原理。一个整数值可以被解释为一串比特序列，其中每个比特或一组比特（一个位字段）可以表示一个特定的状态或标志。为了访问 QA 整数（表示为 $v_{qa}$）中某个位字段的状态，我们采用两种基本运算：按位右移（$\\gg$）和按位与（$\\$）。\n\n一个从位位置 $p$ 开始、长度为 $l$ 位的位字段可以通过先将整数向右移动 $p$ 位（$v_{qa} \\gg p$）来使其与最低有效位对齐，从而将其隔离出来。然后，使用按位与运算符应用一个位掩码来清除所有更高位的比特。对于一个 $l$ 位的字段，其掩码为 $2^l - 1$。因此，该字段的值由 $(v_{qa} \\gg p) \\ (2^l - 1)$ 给出。对于位置 $p$ 上的单个比特标志，这可以简化为 $(v_{qa} \\gg p) \\ 1$。\n\n问题定义了两组主要的像素：所有陆地像素的集合，它构成了分析的基础（分母）；以及这些像素中属于高质量的子集（分子）。\n\n首先，我们定义一个像素为陆地的谓词 $P_{land}$。根据规范，位 $11$ 决定了陆地/水体状态，其中值 $1$ 表示陆地。因此，对于一个给定的 QA 整数 $v_{qa}$：\n$$P_{land}(v_{qa}) \\equiv ((v_{qa} \\gg 11) \\ 1) = 1$$\n分母 $N_{d}$ 是给定数据集中满足此谓词的像素总数。使用指示函数 $I(\\cdot)$（当其参数为真时值为 $1$，否则为 $0$），我们有：\n$$N_{d} = \\sum_{v_{qa} \\in \\text{Data}} I(P_{land}(v_{qa}))$$\n\n接下来，我们形式化高质量谓词 $P_{hq}$。该谓词是应用于各个位字段的多个条件的逻辑合取。一个像素当且仅当所有指定条件都同时满足时，才被视为高质量。这些条件如下：\n\\begin{itemize}\n    \\item $P_{0-1}(v_{qa}) \\equiv ((v_{qa} \\gg 0) \\ 3) = 0$：MODLAND 质量为理想（$00_2$）。\n    \\item $P_{2-3}(v_{qa}) \\equiv ((v_{qa} \\gg 2) \\ 3) = 0$：波段质量为最高（$00_2$）。\n    \\item $P_{4}(v_{qa}) \\equiv ((v_{qa} \\gg 4) \\ 1) = 0$：气溶胶反演成功。\n    \\item $P_{5}(v_{qa}) \\equiv ((v_{qa} \\gg 5) \\ 1) = 0$：未执行邻近校正。\n    \\item $P_{8-9}(v_{qa}) \\equiv ((v_{qa} \\gg 8) \\ 3) = 0$：云状态为晴朗（$00_2$）。\n    \\item $P_{10}(v_{qa}) \\equiv ((v_{qa} \\gg 10) \\ 1) = 0$：无云阴影。\n    \\item $P_{11}(v_{qa}) \\equiv ((v_{qa} \\gg 11) \\ 1) = 1$：像素为陆地。\n    \\item $P_{12-13}(v_{qa}) \\equiv ((v_{qa} \\gg 12) \\ 3) = 0$：气溶胶含量为低/气候学值（$00_2$）。\n    \\item $P_{14-15}(v_{qa}) \\equiv ((v_{qa} \\gg 14) \\ 3) = 0$：未检测到卷云（$00_2$）。\n\\end{itemize}\n完整的高质量谓词是所有这些单个谓词的合取：\n$$P_{hq}(v_{qa}) \\equiv P_{0-1}(v_{qa}) \\land P_{2-3}(v_{qa}) \\land P_{4}(v_{qa}) \\land P_{5}(v_{qa}) \\land P_{8-9}(v_{qa}) \\land P_{10}(v_{qa}) \\land P_{11}(v_{qa}) \\land P_{12-13}(v_{qa}) \\land P_{14-15}(v_{qa})$$\n分子 $N_{n}$ 是数据集中满足此复合谓词 $P_{hq}$ 的像素总数：\n$$N_{n} = \\sum_{v_{qa} \\in \\text{Data}} I(P_{hq}(v_{qa}))$$\n请注意，由于 $P_{hq}$ 包含了条件 $P_{11}$，任何满足 $P_{hq}$ 的像素也必须满足 $P_{land}$。\n\n最后，保留比例 $F$ 是分子与分母的比值：\n$$F = \\frac{N_{n}}{N_{d}}$$\n根据问题规范，在没有陆地像素（$N_{d} = 0$）的边界情况下，该比例定义为 $0.0$。\n\n在计算实现上，可以利用 NumPy 等库的特性，使用矢量化操作高效地对 QA 整数数组执行这些布尔谓词评估。每个谓词生成一个布尔数组，然后使用逻辑与运算组合这些数组，以找到最终的高质量像素集。计数 $N_n$ 和 $N_d$ 是通过对相应布尔数组中的 `True` 值求和得到的。这种方法避免了对像素的显式循环，从而得到一个更简洁、性能更高的解决方案。最终值四舍五入到六位小数。",
            "answer": "[0.285714,0.000000,1.000000,0.000000,0.000000]"
        },
        {
            "introduction": "现代环境分析常常需要整合来自不同传感器（如Landsat和Sentinel-2）的数据，而这些传感器具有不同的空间分辨率。本练习通过一个简化的海岸线模型，探讨了在将高分辨率数据重采样至较低分辨率时，不同的重采样算法（如最近邻法、双线性插值法和三次卷积法）如何在地物边界处对归一化水体指数（$NDWI$）等衍生产品产生影响。理解这些空间处理引入的偏差对于实现准确的多传感器数据融合至关重要。",
            "id": "3825805",
            "problem": "考虑一项跨 Landsat、Copernicus Sentinel-2 和中分辨率成像光谱仪 (MODIS) 的跨传感器协调任务，其中一条岸线边界将开阔水体与植被覆盖地分开。假设反射率场是沿水平坐标 $x$ 的一维分段常数阶跃函数，边界位于 $x=0$，当 $x<0$ 时为水体，当 $x\\geq 0$ 时为陆地。设水体端元的绿光和近红外 (NIR) 地表反射率分别为 $R_{g}^{w}=0.05$ 和 $R_{n}^{w}=0.01$，陆地端元（茂密植被）的反射率分别为 $R_{g}^{\\ell}=0.08$ 和 $R_{n}^{\\ell}=0.45$。将归一化差异水体指数 (NDWI) 定义为 $I=\\frac{R_{g}-R_{n}}{R_{g}+R_{n}}$，该指数在 Landsat、Sentinel-2 和 MODIS 中常用于水体探测。\n\n您正在将 Sentinel-2 的绿光和近红外反射率从其原始网格（$10\\,\\mathrm{m}$ 采样间距）重采样到位于 $x=0$ 的目标像素中心的 Landsat 目标网格（$30\\,\\mathrm{m}$）。由于典型的跨传感器地理定位差异，Sentinel-2 的采样中心相对于岸线有 $\\Delta=5\\,\\mathrm{m}$ 的偏移，因此采样中心位于 $x_{k}=\\Delta+10k$，其中 $k\\in\\mathbb{Z}$。因此，距离 $x=0$ 最近的四个 Sentinel-2 样本点位于 $x=-15\\,\\mathrm{m}$、$x=-5\\,\\mathrm{m}$（水体侧）和 $x=+5\\,\\mathrm{m}$、$x=+15\\,\\mathrm{m}$（陆地侧）。\n\n从采样和插值算子的定义以及 NDWI 的定义出发，推导最近邻、双线性（一维情况下）和立方卷积重采样（Keys 核，参数 $a=-\\frac{1}{2}$）如何改变该阶跃边缘在 $x=0$ 处的边缘对比度。然后，使用这些算子，计算每种方法在岸线目标位置的 NDWI 偏差，定义为\n$$\nB=\\left(\\frac{R_{g}^{\\mathrm{res}}-R_{n}^{\\mathrm{res}}}{R_{g}^{\\mathrm{res}}+R_{n}^{\\mathrm{res}}}\\right)-\\left(\\frac{R_{g}^{w}-R_{n}^{w}}{R_{g}^{w}+R_{n}^{w}}\\right),\n$$\n其中 $R_{g}^{\\mathrm{res}}$ 和 $R_{n}^{\\mathrm{res}}$ 是每种方法在 $x=0$ 处生成的重采样后的绿光和近红外反射率。\n\n假设在像素中心进行理想点采样（忽略点扩散函数和除重采样权重外的亚像素混合），并假设反射率在每个端元内部在光谱和空间上是恒定的。使用 Keys 立方卷积核：\n$$\nh(t)=\n\\begin{cases}\n(a+2)|t|^{3}-(a+3)|t|^{2}+1,  & 0\\leq |t|<1,\\\\\na|t|^{3}-5a|t|^{2}+8a|t|-4a,  & 1\\leq |t|<2,\\\\\n0,  & |t|\\geq 2,\n\\end{cases}\n\\quad a=-\\frac{1}{2}.\n$$\n\n提供分别对应于最近邻、双线性和立方卷积的三种 NDWI 偏差 $B_{\\mathrm{NN}}$、$B_{\\mathrm{BL}}$ 和 $B_{\\mathrm{CC}}$。将最终偏差表示为小数（无单位），并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它在科学上基于遥感原理，问题陈述清晰，包含所有必要信息，且没有矛盾或含糊之处。\n\n对于给定的光谱波段，一维反射率场 $R(x)$ 是一个在 $x=0$ 处存在不连续点的分段常数阶跃函数。\n$$\nR(x) =\n\\begin{cases}\nR^{w}  \\text{if } x  < 0 \\\\\nR^{\\ell}  \\text{if } x \\ge 0\n\\end{cases}\n$$\n给出了绿光 ($g$) 和近红外 ($n$) 波段的端元反射率：\n水体 (w)：$R_{g}^{w}=0.05$，$R_{n}^{w}=0.01$。\n陆地 ($\\ell$)：$R_{g}^{\\ell}=0.08$，$R_{n}^{\\ell}=0.45$。\n\n源 Sentinel-2 样本位于 $x_k = \\Delta + S \\cdot k = 5 + 10k$ 的位置，其中 $k \\in \\mathbb{Z}$，采样间距为 $S=10\\,\\mathrm{m}$。\n当 $k \\le -1$ 时，$x_k  < 0$，因此样本具有水体反射率，$R(x_k)=R^w$。\n当 $k \\ge 0$ 时，$x_k > 0$，因此样本具有陆地反射率，$R(x_k)=R^\\ell$。\n\n我们正在重采样到目标位置 $x_{\\mathrm{target}}=0$。重采样后的反射率 $R^{\\mathrm{res}}$ 是源样本的加权和：\n$$\nR^{\\mathrm{res}}(x_{\\mathrm{target}}) = \\sum_{k \\in \\mathbb{Z}} R(x_k) h\\left(\\frac{x_{\\mathrm{target}} - x_k}{S}\\right)\n$$\n其中 $h(t)$ 是重采样核。当 $x_{\\mathrm{target}}=0$ 且 $S=10$ 时，核的参数为 $t_k = -x_k/10 = -(5+10k)/10 = -0.5-k$。\n\n重采样核具有有限支撑域，因此我们只需考虑 $x=0$ 附近的样本。四个最近的样本位于：\n$x_{-2} = -15\\,\\mathrm{m}$ (水体)，$t_{-2} = 1.5$\n$x_{-1} = -5\\,\\mathrm{m}$ (水体)，$t_{-1} = 0.5$\n$x_{0} = 5\\,\\mathrm{m}$ (陆地)，$t_{0} = -0.5$\n$x_{1} = 15\\,\\mathrm{m}$ (陆地)，$t_{1} = -1.5$\n\n现在我们将计算每种方法的重采样绿光 ($R_g^{\\mathrm{res}}$) 和近红外 ($R_n^{\\mathrm{res}}$) 反射率。\n\n**1. 最近邻 (NN) 重采样**\n该方法将最近的源样本值赋给目标位置。目标 $x_{\\mathrm{target}}=0$ 与 $x_{-1}=-5\\,\\mathrm{m}$ 和 $x_0=5\\,\\mathrm{m}$ 等距。在这种平局情况下存在歧义。一个物理上一致的选择是使用与目标位置分类相对应的端元类型。由于 $x=0$ 被定义为陆地 ($x \\ge 0$)，我们分配陆地反射率值。\n$$\nR^{\\mathrm{res, NN}} = R(x_0) = R^{\\ell}\n$$\n因此，重采样后的反射率为：\n$R_{g}^{\\mathrm{NN}} = R_{g}^{\\ell} = 0.08$\n$R_{n}^{\\mathrm{NN}} = R_{n}^{\\ell} = 0.45$\n该方法完美地保留了端元的光谱特征，但改变了边界的感知位置。\n\n**2. 双线性 (一维线性) 重采样**\n一维线性插值核为 $h(t) = \\max(0, 1-|t|)$，其支撑域为 $|t|<1$。只有 $|t_k|<1$ 的样本才会起作用。这些样本是 $x_{-1}$ ($t_{-1}=0.5$) 和 $x_0$ ($t_0=-0.5$)。\n权重为：\n$w_{-1} = h(t_{-1}) = h(0.5) = 1 - 0.5 = 0.5$\n$w_0 = h(t_0) = h(-0.5) = 1 - |-0.5| = 0.5$\n重采样后的反射率是加权平均值：\n$R^{\\mathrm{res, BL}} = w_{-1}R(x_{-1}) + w_0R(x_0) = 0.5 R^w + 0.5 R^\\ell$。\n对于每个波段：\n$R_{g}^{\\mathrm{BL}} = 0.5 R_{g}^{w} + 0.5 R_{g}^{\\ell} = 0.5(0.05) + 0.5(0.08) = 0.025 + 0.04 = 0.065$\n$R_{n}^{\\mathrm{BL}} = 0.5 R_{n}^{w} + 0.5 R_{n}^{\\ell} = 0.5(0.01) + 0.5(0.45) = 0.005 + 0.225 = 0.23$\n该方法通过创建一个反射率恰好是两个端元之间中点的混合像元来模糊边缘。\n\n**3. 立方卷积 (CC) 重采样**\n参数为 $a=-1/2$ 的 Keys 核由以下公式给出：\n$$\nh(t)=\n\\begin{cases}\n1.5|t|^{3}-2.5|t|^{2}+1,  & 0\\leq |t|<1\\\\\n-0.5|t|^{3}+2.5|t|^{2}-4|t|+2,  & 1\\leq |t|<2\\\\\n0,  & |t|\\geq 2\n\\end{cases}\n$$\n该核的支撑域为 $|t|<2$，因此四个最近的样本 ($x_{-2}, x_{-1}, x_0, x_1$) 都会起作用。\n权重是为 $t_{-2}=1.5$、$t_{-1}=0.5$、$t_0=-0.5$、$t_1=-1.5$ 计算的。由于核的对称性，$h(t)=h(-t)$。\n对于 $|t|=0.5$ (适用于 $t_{-1}, t_0$)：\n$w_{-1} = w_0 = h(0.5) = 1.5(0.5)^3 - 2.5(0.5)^2 + 1 = 1.5(0.125) - 2.5(0.25) + 1 = 0.1875 - 0.625 + 1 = 0.5625$。\n对于 $|t|=1.5$ (适用于 $t_{-2}, t_1$)：\n$w_{-2} = w_1 = h(1.5) = -0.5(1.5)^3 + 2.5(1.5)^2 - 4(1.5) + 2 = -0.5(3.375) + 2.5(2.25) - 6 + 2 = -1.6875 + 5.625 - 4 = -0.0625$。\n重采样后的反射率为：\n$R^{\\mathrm{res, CC}} = w_{-2}R(x_{-2}) + w_{-1}R(x_{-1}) + w_0R(x_0) + w_1R(x_1)$\n$R^{\\mathrm{res, CC}} = w_{-2}R^w + w_{-1}R^w + w_0R^\\ell + w_1R^\\ell = (w_{-2}+w_{-1})R^w + (w_0+w_1)R^\\ell$。\n水体端元的总权重为 $w_{-2}+w_{-1} = -0.0625 + 0.5625 = 0.5$。\n陆地端元的总权重为 $w_0+w_1 = 0.5625 - 0.0625 = 0.5$。\n所以，$R^{\\mathrm{res, CC}} = 0.5R^w + 0.5R^\\ell$。\n这表明，在这种完全对称的配置下，立方卷积得到的结果与双线性插值完全相同。\n$R_{g}^{\\mathrm{CC}} = R_{g}^{\\mathrm{BL}} = 0.065$\n$R_{n}^{\\mathrm{CC}} = R_{n}^{\\mathrm{BL}} = 0.23$\n\n**NDWI 偏差计算**\nNDWI 为 $I = \\frac{R_g-R_n}{R_g+R_n}$。偏差定义为 $B = I^{\\mathrm{res}} - I^w$。\n首先，我们计算水体的参考 NDWI：\n$$\nI^w = \\frac{R_{g}^{w}-R_{n}^{w}}{R_{g}^{w}+R_{n}^{w}} = \\frac{0.05 - 0.01}{0.05 + 0.01} = \\frac{0.04}{0.06} = \\frac{2}{3}\n$$\n现在我们计算每种重采样方法的偏差。\n\nNN 的偏差 ($B_{\\mathrm{NN}}$):\n$I_{\\mathrm{NN}} = \\frac{R_{g}^{\\mathrm{NN}}-R_{n}^{\\mathrm{NN}}}{R_{g}^{\\mathrm{NN}}+R_{n}^{\\mathrm{NN}}} = \\frac{0.08 - 0.45}{0.08 + 0.45} = \\frac{-0.37}{0.53}$\n$B_{\\mathrm{NN}} = \\frac{-0.37}{0.53} - \\frac{2}{3} \\approx -0.698113 - 0.666667 = -1.36478\\dots$\n四舍五入到四位有效数字，$B_{\\mathrm{NN}} \\approx -1.365$。\n\n双线性的偏差 ($B_{\\mathrm{BL}}$):\n$I_{\\mathrm{BL}} = \\frac{R_{g}^{\\mathrm{BL}}-R_{n}^{\\mathrm{BL}}}{R_{g}^{\\mathrm{BL}}+R_{n}^{\\mathrm{BL}}} = \\frac{0.065 - 0.23}{0.065 + 0.23} = \\frac{-0.165}{0.295}$\n$B_{\\mathrm{BL}} = \\frac{-0.165}{0.295} - \\frac{2}{3} \\approx -0.559322 - 0.666667 = -1.225989\\dots$\n四舍五入到四位有效数字，$B_{\\mathrm{BL}} \\approx -1.226$。\n\n立方卷积的偏差 ($B_{\\mathrm{CC}}$):\n由于重采样后的反射率与双线性情况相同，因此 NDWI 和偏差也相同。\n$I_{\\mathrm{CC}} = I_{\\mathrm{BL}}$，所以 $B_{\\mathrm{CC}} = B_{\\mathrm{BL}} \\approx -1.226$。\n这些偏差表明，重采样算法的选择会显著影响在清晰边界处派生的指数值，这在跨传感器协调和特征提取中是一个关键的考虑因素。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -1.365 & -1.226 & -1.226 \\end{pmatrix}}\n$$"
        }
    ]
}