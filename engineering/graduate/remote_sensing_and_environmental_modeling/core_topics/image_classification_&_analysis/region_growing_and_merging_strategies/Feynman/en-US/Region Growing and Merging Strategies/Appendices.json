{
    "hands_on_practices": [
        {
            "introduction": "Understanding complex algorithms often begins with a simple, concrete example. This first exercise provides a foundational walkthrough of the region growing process at the most fundamental level: the pixel grid . By manually applying an iterative rule based on a simple intensity predicate, you will trace the algorithm's evolution from a single seed, building an intuitive grasp of how region statistics and neighborhood definitions drive the segmentation result.",
            "id": "3840810",
            "problem": "Consider a single-band remote sensing image patch represented by a $5 \\times 5$ grid of Digital Numbers (DNs), where each DN is an integer in the range $[0,255]$. You are to perform region growing using a connectivity definition and an intensity-based inclusion predicate, both defined below, and report the final size of the grown region as a count of pixels. The image patch $I$ is given by the matrix\n$$\nI = \\begin{pmatrix}\n135 & 130 & 128 & 131 & 136 \\\\\n132 & 112 & 105 & 114 & 133 \\\\\n129 & 108 & 100 & 109 & 130 \\\\\n134 & 113 & 106 & 115 & 135 \\\\\n137 & 131 & 129 & 132 & 138\n\\end{pmatrix}.\n$$\nLet the seed location be the pixel at row $3$, column $3$ with DN $100$. Define $4$-connected adjacency, so that a pixel $p$ is adjacent to a pixel $q$ if and only if $p$ and $q$ share an edge. Let the current region at iteration $k$ be $R_k$, with mean intensity\n$$\n\\bar{I}_{R_k} = \\frac{1}{|R_k|} \\sum_{p \\in R_k} I(p),\n$$\nwhere $|R_k|$ is the number of pixels in $R_k$ and $I(p)$ is the DN at pixel $p$. At each iteration, form the set of candidate neighbors $N(R_k)$ consisting of all pixels not in $R_k$ that are $4$-connected to at least one pixel in $R_k$. The inclusion predicate is the absolute deviation threshold\n$$\n|I(p) - \\bar{I}_{R_k}| \\le \\tau,\n$$\nwith threshold $\\tau = 10$. At each iteration, add all pixels in $N(R_k)$ that satisfy the predicate simultaneously to obtain $R_{k+1}$, recompute $\\bar{I}_{R_{k+1}}$, and repeat until no further additions occur.\n\nStarting from the seed region $R_0 = \\{(3,3)\\}$, apply this process until convergence and compute the final region size $|R_{\\star}|$, where $R_{\\star}$ is the terminal region. Provide your final answer as a single integer equal to $|R_{\\star}|$. No rounding instructions are needed. Express your answer as a pure number without units.",
            "solution": "The user has provided a valid problem statement for a region growing algorithm. The problem is well-posed, scientifically grounded, and contains all necessary information to derive a unique solution. The process will be executed iteratively as specified.\n\nThe image patch is given by the matrix $I$:\n$$\nI = \\begin{pmatrix}\n135 & 130 & 128 & 131 & 136 \\\\\n132 & 112 & 105 & 114 & 133 \\\\\n129 & 108 & 100 & 109 & 130 \\\\\n134 & 113 & 106 & 115 & 135 \\\\\n137 & 131 & 129 & 132 & 138\n\\end{pmatrix}\n$$\nThe inclusion predicate is given by $|I(p) - \\bar{I}_{R_k}| \\le \\tau$, with a threshold of $\\tau = 10$. Connectivity is defined as $4$-connected adjacency.\n\n**Iteration 0**\nThe process starts with the seed region $R_0$.\nThe seed pixel is at location $(3,3)$, with Digital Number (DN) $I(3,3) = 100$.\nThe initial region is $R_0 = \\{(3,3)\\}$.\nThe size of the region is $|R_0| = 1$.\nThe mean intensity of the region is $\\bar{I}_{R_0} = \\frac{1}{|R_0|} \\sum_{p \\in R_0} I(p) = \\frac{100}{1} = 100$.\nThe inclusion predicate for the next step is $|I(p) - 100| \\le 10$, which simplifies to the condition $90 \\le I(p) \\le 110$.\n\n**Iteration 1**\nThe current region is $R_0$. We find its $4$-connected neighbors, which form the set of candidate pixels $N(R_0)$.\n$N(R_0) = \\{(2,3), (3,2), (3,4), (4,3)\\}$.\nThe DNs of these candidates are:\n$I(2,3) = 105$\n$I(3,2) = 108$\n$I(3,4) = 109$\n$I(4,3) = 106$\n\nWe test each candidate against the predicate $90 \\le I(p) \\le 110$:\n- For pixel $(2,3)$: $I(2,3) = 105$. Since $90 \\le 105 \\le 110$, the condition is satisfied.\n- For pixel $(3,2)$: $I(3,2) = 108$. Since $90 \\le 108 \\le 110$, the condition is satisfied.\n- For pixel $(3,4)$: $I(3,4) = 109$. Since $90 \\le 109 \\le 110$, the condition is satisfied.\n- For pixel $(4,3)$: $I(4,3) = 106$. Since $90 \\le 106 \\le 110$, the condition is satisfied.\n\nAll candidate pixels satisfy the inclusion criterion. They are added to the region to form $R_1$.\n$R_1 = R_0 \\cup \\{(2,3), (3,2), (3,4), (4,3)\\} = \\{(3,3), (2,3), (3,2), (3,4), (4,3)\\}$.\nThe size of the new region is $|R_1| = 5$.\nThe sum of intensities in $R_1$ is $100 + 105 + 108 + 109 + 106 = 528$.\nThe new mean intensity is $\\bar{I}_{R_1} = \\frac{528}{5} = 105.6$.\nThe inclusion predicate for the next step is $|I(p) - 105.6| \\le 10$, which is $95.6 \\le I(p) \\le 115.6$. Since DNs are integers, this is equivalent to $96 \\le I(p) \\le 115$.\n\n**Iteration 2**\nThe current region is $R_1$. We find the set of its neighbors not already in $R_1$.\n$N(R_1) = \\{(1,3), (2,2), (2,4), (3,1), (3,5), (4,2), (4,4), (5,3)\\}$.\nThe DNs of these candidates are:\n$I(1,3) = 128$\n$I(2,2) = 112$\n$I(2,4) = 114$\n$I(3,1) = 129$\n$I(3,5) = 130$\n$I(4,2) = 113$\n$I(4,4) = 115$\n$I(5,3) = 129$\n\nWe test each candidate against the predicate $96 \\le I(p) \\le 115$:\n- For pixel $(1,3)$: $I(1,3) = 128$. $128 > 115$, condition not satisfied.\n- For pixel $(2,2)$: $I(2,2) = 112$. $96 \\le 112 \\le 115$, condition satisfied.\n- For pixel $(2,4)$: $I(2,4) = 114$. $96 \\le 114 \\le 115$, condition satisfied.\n- For pixel $(3,1)$: $I(3,1) = 129$. $129 > 115$, condition not satisfied.\n- For pixel $(3,5)$: $I(3,5) = 130$. $130 > 115$, condition not satisfied.\n- For pixel $(4,2)$: $I(4,2) = 113$. $96 \\le 113 \\le 115$, condition satisfied.\n- For pixel $(4,4)$: $I(4,4) = 115$. $96 \\le 115 \\le 115$, condition satisfied.\n- For pixel $(5,3)$: $I(5,3) = 129$. $129 > 115$, condition not satisfied.\n\nThe pixels to be added are $\\{(2,2), (2,4), (4,2), (4,4)\\}$.\nThe new region $R_2$ is $R_1 \\cup \\{(2,2), (2,4), (4,2), (4,4)\\}$. This forms a $3 \\times 3$ block of pixels in the center of the image.\n$R_2 = \\{(2,2), (2,3), (2,4), (3,2), (3,3), (3,4), (4,2), (4,3), (4,4)\\}$.\nThe size of the new region is $|R_2| = |R_1| + 4 = 5 + 4 = 9$.\nThe sum of intensities for the newly added pixels is $112 + 114 + 113 + 115 = 454$.\nThe total sum of intensities in $R_2$ is $528 + 454 = 982$.\nThe new mean intensity is $\\bar{I}_{R_2} = \\frac{982}{9} \\approx 109.111...$.\nThe inclusion predicate for the next step is $|I(p) - \\frac{982}{9}| \\le 10$.\nThis is $\\frac{982}{9} - 10 \\le I(p) \\le \\frac{1072}{9}$, which is $\\frac{892}{9} \\le I(p) \\le \\frac{1072}{9}$.\nIn decimal form, this is approximately $99.111... \\le I(p) \\le 119.111...$. For integer DNs, this is equivalent to $100 \\le I(p) \\le 119$.\n\n**Iteration 3**\nThe current region is the central $3 \\times 3$ block, $R_2$. We find the set of its neighbors not already in $R_2$. These are the $12$ pixels forming a frame around the central block.\n$N(R_2) = \\{(1,2), (1,3), (1,4), (2,1), (2,5), (3,1), (3,5), (4,1), (4,5), (5,2), (5,3), (5,4)\\}$.\nThe DNs of these candidates are:\n$I(1,2)=130$, $I(1,3)=128$, $I(1,4)=131$\n$I(2,1)=132$, $I(2,5)=133$\n$I(3,1)=129$, $I(3,5)=130$\n$I(4,1)=134$, $I(4,5)=135$\n$I(5,2)=131$, $I(5,3)=129$, $I(5,4)=132$\n\nWe test each candidate against the predicate $100 \\le I(p) \\le 119$.\nThe minimum intensity value among all candidates in $N(R_2)$ is $I(1,3) = 128$.\nSince $128 > 119$, none of the candidate pixels satisfy the inclusion criterion.\n\nNo new pixels are added to the region. Thus, $R_3 = R_2$. The region growing process has converged.\n\n**Conclusion**\nThe terminal region is $R_{\\star} = R_2$.\nThe final size of the grown region is $|R_{\\star}| = |R_2| = 9$.",
            "answer": "$$\n\\boxed{9}\n$$"
        },
        {
            "introduction": "In practice, especially with multispectral or hyperspectral imagery, merging decisions cannot rely on simple thresholds alone. We need statistically robust methods to determine if two adjacent regions belong to the same land cover class. This practice introduces Hotelling’s $T^2$ test, a multivariate generalization of the Student's t-test, as a powerful tool for this purpose . You will apply this statistical framework to test the hypothesis that two regions have the same mean spectral signature, providing a principled foundation for region merging.",
            "id": "3840770",
            "problem": "In a region-growing segmentation of a multispectral remote sensing image for environmental modeling, two adjacent candidate regions $A$ and $B$ are evaluated for merging by testing whether their bandwise mean reflectance vectors are statistically indistinguishable under a multivariate homoscedastic model. Assume that pixel reflectance vectors within each region are independently and identically distributed as draws from a multivariate normal distribution with a common covariance matrix across regions, and that the two regions have sample sizes $n_A$ and $n_B$, sample mean vectors $\\mu_A$ and $\\mu_B$, and a pooled sample covariance matrix $\\Sigma$ estimated from the two regions.\n\nConsider two spectral bands (red and near-infrared), so the reflectance vectors are two-dimensional. The region summaries are:\n- $n_A = 120$, $n_B = 150$,\n- $\\mu_A = \\begin{pmatrix} 0.34 \\\\ 0.28 \\end{pmatrix}$, $\\mu_B = \\begin{pmatrix} 0.36 \\\\ 0.31 \\end{pmatrix}$,\n- $\\Sigma = \\begin{pmatrix} \\frac{1}{400} & 0 \\\\ 0 & \\frac{1}{225} \\end{pmatrix}$.\n\nUsing the two-sample Hotelling’s $T^2$ statistic under the equal-covariance assumption, compute the value of $T^2$ for testing the null hypothesis $H_0: \\mu_A = \\mu_B$. Then, state the corresponding decision threshold $T^2_{\\mathrm{crit}}$ for merging at significance level $\\alpha = 0.05$, expressed in terms of the upper $(1 - \\alpha)$ quantile of the Fisher–Snedecor $F$ distribution. You may express any non-elementary quantile symbolically as $F^{-1}_{p,\\nu}(1 - \\alpha)$, where $p$ is the dimension and $\\nu$ is the appropriate degrees of freedom. Do not provide a numerical approximation for the $F$ quantile. If you choose to numerically approximate any intermediate quantity, round to four significant figures. The final answer must be provided as a single row matrix containing the computed $T^2$ value and the symbolic $T^2_{\\mathrm{crit}}$ threshold, with no units.",
            "solution": "The decision to merge adjacent regions in a region-growing strategy can be framed as a multivariate hypothesis test on the equality of mean reflectance vectors. A standard assumption in this context is that, within each region, pixel reflectance vectors are independent and identically distributed from a multivariate normal distribution with a common covariance across regions. Under this homoscedasticity and normality assumption, the two-sample Hotelling’s $T^2$ statistic provides a well-tested multivariate generalization of the two-sample $t$-test.\n\nWe start from the following foundational elements:\n- If $X \\in \\mathbb{R}^p$ is multivariate normal with mean $\\mu$ and covariance $\\Sigma$, then the squared Mahalanobis distance of a mean difference $\\delta = \\mu_A - \\mu_B$ with respect to $\\Sigma$ is $\\delta^{\\top} \\Sigma^{-1} \\delta$.\n- For two independent samples with sizes $n_A$ and $n_B$, sample means $\\mu_A$ and $\\mu_B$, and common covariance estimated by the pooled sample covariance $\\Sigma$, the two-sample Hotelling’s $T^2$ statistic is defined by\n$$\nT^2 \\;=\\; \\frac{n_A \\, n_B}{n_A + n_B} \\, (\\mu_A - \\mu_B)^{\\top} \\, \\Sigma^{-1} \\, (\\mu_A - \\mu_B).\n$$\n- Under the null hypothesis $H_0: \\mu_A = \\mu_B$, the distributional calibration relates $T^2$ to the Fisher–Snedecor $F$ distribution via\n$$\n\\frac{n_A + n_B - p - 1}{p \\, (n_A + n_B - 2)} \\, T^2 \\;\\sim\\; F_{p, \\, n_A + n_B - p - 1},\n$$\nwhere $p$ is the dimension of the reflectance vector. Consequently, the $(1 - \\alpha)$ critical threshold for $T^2$ is\n$$\nT^2_{\\mathrm{crit}} \\;=\\; \\frac{p \\, (n_A + n_B - 2)}{n_A + n_B - p - 1} \\; F^{-1}_{p, \\, n_A + n_B - p - 1}(1 - \\alpha).\n$$\n\nWe now compute $T^2$ for the provided data. Let $p = 2$, $n_A = 120$, $n_B = 150$, $\\mu_A = \\begin{pmatrix} 0.34 \\\\ 0.28 \\end{pmatrix}$, $\\mu_B = \\begin{pmatrix} 0.36 \\\\ 0.31 \\end{pmatrix}$, and\n$$\n\\Sigma \\;=\\; \\begin{pmatrix} \\frac{1}{400} & 0 \\\\ 0 & \\frac{1}{225} \\end{pmatrix}.\n$$\nFirst compute the mean difference:\n$$\n\\Delta \\mu \\;=\\; \\mu_A - \\mu_B \\;=\\; \\begin{pmatrix} 0.34 - 0.36 \\\\ 0.28 - 0.31 \\end{pmatrix} \\;=\\; \\begin{pmatrix} -0.02 \\\\ -0.03 \\end{pmatrix}.\n$$\nNext, compute $\\Sigma^{-1}$. Since $\\Sigma$ is diagonal, its inverse is simply the reciprocal of the diagonal entries:\n$$\n\\Sigma^{-1} \\;=\\; \\begin{pmatrix} 400 & 0 \\\\ 0 & 225 \\end{pmatrix}.\n$$\nThe quadratic form is\n$$\n(\\Delta \\mu)^{\\top} \\Sigma^{-1} (\\Delta \\mu) \\;=\\; \\begin{pmatrix} -0.02 & -0.03 \\end{pmatrix}\n\\begin{pmatrix} 400 & 0 \\\\ 0 & 225 \\end{pmatrix}\n\\begin{pmatrix} -0.02 \\\\ -0.03 \\end{pmatrix}.\n$$\nCompute this explicitly. First, $\\Sigma^{-1} (\\Delta \\mu) = \\begin{pmatrix} 400 \\cdot (-0.02) \\\\ 225 \\cdot (-0.03) \\end{pmatrix} = \\begin{pmatrix} -8 \\\\ -6.75 \\end{pmatrix}$. Then,\n$$\n(\\Delta \\mu)^{\\top} \\Sigma^{-1} (\\Delta \\mu) \\;=\\; (-0.02)(-8) + (-0.03)(-6.75) \\;=\\; 0.16 + 0.2025 \\;=\\; 0.3625 \\;=\\; \\frac{29}{80}.\n$$\nThe scaling factor is\n$$\n\\frac{n_A \\, n_B}{n_A + n_B} \\;=\\; \\frac{120 \\cdot 150}{120 + 150} \\;=\\; \\frac{18000}{270} \\;=\\; \\frac{200}{3}.\n$$\nTherefore,\n$$\nT^2 \\;=\\; \\frac{200}{3} \\cdot \\frac{29}{80} \\;=\\; \\frac{200 \\cdot 29}{3 \\cdot 80} \\;=\\; \\frac{5 \\cdot 29}{2 \\cdot 3} \\;=\\; \\frac{145}{6}.\n$$\n\nFor the decision threshold, compute the degrees of freedom terms. Here $p = 2$ and $n_A + n_B = 270$, so\n$$\nn_A + n_B - 2 \\;=\\; 268, \\quad n_A + n_B - p - 1 \\;=\\; 270 - 2 - 1 \\;=\\; 267.\n$$\nHence,\n$$\nT^2_{\\mathrm{crit}} \\;=\\; \\frac{p \\, (n_A + n_B - 2)}{n_A + n_B - p - 1} \\; F^{-1}_{p, \\, n_A + n_B - p - 1}(1 - \\alpha)\n\\;=\\; \\frac{2 \\cdot 268}{267} \\; F^{-1}_{2,\\,267}(0.95)\n\\;=\\; \\frac{536}{267} \\; F^{-1}_{2,\\,267}(0.95).\n$$\n\nThe final requested output is the row matrix containing the computed $T^2$ value and the symbolic $T^2_{\\mathrm{crit}}$ threshold, with no units.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{145}{6} & \\frac{536}{267}\\,F^{-1}_{2,267}(0.95)\\end{pmatrix}}$$"
        },
        {
            "introduction": "Modern segmentation strategies often combine the efficiency of graph-based representations with sophisticated, adaptive merging criteria. This final hands-on practice challenges you to implement a powerful algorithm that operates on a Region Adjacency Graph (RAG) . By using a criterion that adapts to the size of the regions being considered, this method elegantly balances local and global information to produce a meaningful segmentation, and you will investigate the critical effect of its control parameter, $k$.",
            "id": "3840813",
            "problem": "You are given a Region Adjacency Graph (RAG) used in remote sensing and environmental modeling to represent spectrally homogeneous superpixels extracted from a multispectral image. The nodes $v_0,\\dots,v_7$ represent superpixels, and each undirected edge $(v_i,v_j)$ is assigned a unitless spectral dissimilarity weight $w_{ij}$, defined as a normalized squared Euclidean spectral distance, scaled to the interval $[0,1000]$. The RAG $G=(V,E)$ is specified as follows, with $V=\\{v_0,v_1,v_2,v_3,v_4,v_5,v_6,v_7\\}$ and edge set $E$:\n- $(v_0,v_1)$ with $w_{01}=30$,\n- $(v_1,v_2)$ with $w_{12}=40$,\n- $(v_2,v_3)$ with $w_{23}=50$,\n- $(v_1,v_3)$ with $w_{13}=60$,\n- $(v_0,v_2)$ with $w_{02}=70$,\n- $(v_2,v_4)$ with $w_{24}=180$,\n- $(v_3,v_4)$ with $w_{34}=200$,\n- $(v_3,v_5)$ with $w_{35}=240$,\n- $(v_4,v_5)$ with $w_{45}=250$,\n- $(v_4,v_6)$ with $w_{46}=550$,\n- $(v_5,v_7)$ with $w_{57}=580$,\n- $(v_5,v_6)$ with $w_{56}=600$,\n- $(v_6,v_7)$ with $w_{67}=620$.\n\nThe goal is to segment $G$ into regions (components) by a size-adaptive region growing and merging strategy grounded on the following principle-based definitions:\n- The internal difference of a component $C$, denoted $\\mathrm{Int}(C)$, is defined as the maximum edge weight along the minimum spanning tree (MST) of the subgraph induced by $C$.\n- The adaptive threshold of a component $C$ under parameter $k$ is defined as $\\tau(C)=k/|C|$, where $|C|$ is the number of nodes in $C$.\n- Edges are processed in nondecreasing order of $w_{ij}$. When considering an edge $(v_i,v_j)$ connecting two distinct components $C_i$ and $C_j$, merge $C_i$ and $C_j$ if and only if the dissimilarity $w_{ij}$ does not exceed the adaptive bound of both components, in the sense that the merge is permitted exactly when $w_{ij}$ does not surpass each component’s current internal difference augmented by its adaptive threshold. After merging, update the merged component’s internal difference to be the maximum of the previous internal differences of $C_i$ and $C_j$ and the weight $w_{ij}$ just used.\n\nYour task:\n1. Implement the above size-adaptive region growing and merging procedure to compute the final segmentation for the specified RAG given $k=500$.\n2. Analyze how changing $k$ alters the number and size of segments by running the procedure for each $k$ in the test suite $\\{0,50,200,500,520,2000\\}$.\n3. For each $k$ value, report two quantities: the number of segments and the multiset of segment sizes (each size is an integer count of nodes), sorted in nonincreasing order.\n\nThere are no physical units attached to the weights (they are unitless by construction), and the segment sizes are counts expressed as integers. Angles are not involved. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each entry should itself be a two-element list of the form $[n,[s_1,s_2,\\dots]]$, where $n$ is the integer number of segments and $[s_1,s_2,\\dots]$ is the list of segment sizes in nonincreasing order. For example, an output matching the required format would look like $[[n_1,[\\dots]],[n_2,[\\dots]],\\dots]$ for the six $k$ values in the given test suite, in the same order.",
            "solution": "The problem presents a well-defined graph segmentation task based on a size-adaptive region growing and merging algorithm. The problem is scientifically grounded in principles of image segmentation and computational geometry, providing all necessary definitions, data, and constraints. It is self-contained, logically consistent, and algorithmically solvable. There are no factual errors, ambiguities, or contradictions. Therefore, the problem is deemed valid and a formal solution can be constructed.\n\nThe core of the task is to implement a specific segmentation algorithm on a given Region Adjacency Graph (RAG), $G=(V, E)$, where $V=\\{v_0, v_1, \\dots, v_7\\}$ represents a set of $8$ superpixels and the edges are weighted by a spectral dissimilarity metric $w_{ij}$. The algorithm is a variant of Kruskal's algorithm for finding a Minimum Spanning Tree (MST), but with a more complex, adaptive predicate for merging components.\n\nThe procedure is as follows:\n1.  **Initialization**: Begin with a partition of the RAG where each node $v_i$ constitutes its own component, $C_i = \\{v_i\\}$. For each such initial component, its size $|C_i|$ is $1$, and its internal difference, $\\mathrm{Int}(C_i)$, is defined as $0$, since a single-node subgraph has no edges.\n\n2.  **Edge Processing**: The edges of the graph are processed in nondecreasing order of their weight $w_{ij}$. This sorted order ensures that we consider merging the most similar (least dissimilar) components first.\n\n3.  **Merge Criterion**: For each edge $(v_i, v_j)$ with weight $w_{ij}$, let $C_i$ and $C_j$ be the components containing $v_i$ and $v_j$, respectively. If $C_i$ and $C_j$ are already the same component, the edge is discarded as it is internal to an existing segment. If they are distinct, a merge is considered based on the following condition:\n    $$w_{ij} \\le \\min(\\mathrm{Int}(C_i) + \\tau(C_i), \\mathrm{Int}(C_j) + \\tau(C_j))$$\n    where $\\mathrm{Int}(C)$ is the internal difference of a component $C$, and $\\tau(C)$ is its adaptive threshold, defined as $\\tau(C) = k/|C|$ for a given parameter $k$. The condition can be stated as two simultaneous inequalities:\n    $$w_{ij} \\le \\mathrm{Int}(C_i) + \\frac{k}{|C_i|}$$\n    $$w_{ij} \\le \\mathrm{Int}(C_j) + \\frac{k}{|C_j|}$$\n    This predicate allows a merge only if the dissimilarity between the two components (represented by $w_{ij}$) is not significantly larger than the internal dissimilarities of the components themselves. The term $\\tau(C)$ provides an adaptive tolerance that is larger for smaller components, encouraging merges of small regions, and smaller for larger components, preventing them from merging unless they are very similar.\n\n4.  **Component Update**: If the merge condition is satisfied, components $C_i$ and $C_j$ are merged into a new component, $C_{new} = C_i \\cup C_j$. The properties of this new component are updated as follows:\n    -   **Size**: The new size is the sum of the old sizes: $|C_{new}| = |C_i| + |C_j|$.\n    -   **Internal Difference**: The new internal difference is the maximum of the internal differences of the original components and the weight of the edge that connected them: $\\mathrm{Int}(C_{new}) = \\max(\\mathrm{Int}(C_i), \\mathrm{Int}(C_j), w_{ij})$. This definition is consistent with interpreting $\\mathrm{Int}(C)$ as the largest edge weight in the minimum spanning forest of the component's induced subgraph.\n\n5.  **Data Structure**: A Disjoint-Set Union (DSU) or Union-Find data structure is ideally suited for this problem. Each set in the DSU represents a component. We augment the standard DSU structure to store the size $|C|$ and internal difference $\\mathrm{Int}(C)$ for each component, associated with the root of that component's set.\n\n6.  **Termination and Output**: The algorithm terminates after all edges have been processed. The final set of disjoint components in the DSU structure represents the segmentation of the graph. The task requires calculating the number of final segments and the multiset of their sizes (number of nodes per segment), sorted in nonincreasing order for each value of $k$ in the test suite $\\{0, 50, 200, 500, 520, 2000\\}$. The parameter $k$ controls the algorithm's sensitivity to merging; a larger $k$ increases the adaptive threshold $\\tau(C)$, making merges more likely and resulting in fewer, larger segments. Conversely, $k=0$ yields $\\tau(C)=0$, making the merge condition very strict.\n\nThe implementation will loop through the provided $k$ values. For each $k$, it will initialize the DSU structure for the $8$ nodes, process the sorted list of edges according to the rules above, and finally collect and format the resulting segmentation statistics.",
            "answer": "```text\n[[8,[1,1,1,1,1,1,1,1]],[5,[4,1,1,1,1]],[5,[4,1,1,1,1]],[4,[4,2,1,1]],[3,[6,1,1]],[1,[8]]]\n```"
        }
    ]
}