{
    "hands_on_practices": [
        {
            "introduction": "决策树的强大之处在于其能够将数据集递归地划分成更纯净的子集。本练习将带您进入这一过程的核心：评估一个潜在的划分。通过计算一个节点的基尼不纯度（Gini impurity）以及一次划分带来的不纯度下降量，您将亲身体会驱动CART决策树生长的基本准则。",
            "id": "3805182",
            "problem": "一个用于环境建模的土地覆盖制图工作流使用分类与回归树（CART）分类器将遥感影像分割为不同的语义类别。考虑一个包含 $120$ 个像素的内部节点 $S$，其类别计数为：森林 $=60$，农田 $=40$，水体 $=20$。一个基于某个光谱特征的轴对齐分裂产生了一个左子节点，其计数为 $(50,30,10)$，以及一个右子节点，其计数为 $(10,10,10)$。\n\n使用 CART 采用的标准多类不纯度准则，计算父节点的不纯度 $G(S)$ 以及由该分裂引起的不纯度下降量。不纯度下降量定义为父节点不纯度减去按子节点大小加权的分割后不纯度。将这两个量表示为精确的既约分数。不要四舍五入。最终答案必须将这两个值按 $G(S)$、不纯度下降量的顺序排成一行。",
            "solution": "首先验证问题，以确保其自洽、科学合理且定义明确。\n\n**步骤1：提取已知条件**\n- 父节点 $S$ 包含 $N = 120$ 个像素。\n- $S$ 中的类别计数：$n_{\\text{forest}} = 60$（森林），$n_{\\text{cropland}} = 40$（农田），$n_{\\text{water}} = 20$（水体）。\n- 一次分裂产生左子节点 $S_L$ 和右子节点 $S_R$。\n- $S_L$ 中的类别计数：$n_{\\text{forest},L} = 50$，$n_{\\text{cropland},L} = 30$，$n_{\\text{water},L} = 10$。\n- $S_R$ 中的类别计数：$n_{\\text{forest},R} = 10$，$n_{\\text{cropland},R} = 10$，$n_{\\text{water},R} = 10$。\n- 不纯度准则是 CART 的标准准则，即基尼不纯度。\n- 不纯度下降量定义为父节点不纯度减去加权后的分割后不纯度。\n- 要求输出父节点的不纯度 $G(S)$ 和不纯度下降量 $\\Delta G(S)$，以精确的既约分数表示。\n\n**步骤2：使用提取的已知条件进行验证**\n- 父节点中的总像素数为 $60 + 40 + 20 = 120$，与给定条件一致。\n- 左子节点中的总像素数为 $N_L = 50 + 30 + 10 = 90$。\n- 右子节点中的总像素数为 $N_R = 10 + 10 + 10 = 30$。\n- 像素守恒检验得出 $N_L + N_R = 90 + 30 = 120 = N$，正确。\n- 各类别的计数守恒检验也满足：\n  - 森林：$50 + 10 = 60$。\n  - 农田：$30 + 10 = 40$。\n  - 水体：$10 + 10 = 20$。\n- 该问题在决策树理论上具有科学依据，数值上一致，且定义明确。未发现任何缺陷。\n\n**步骤3：结论与行动**\n- 问题有效。开始求解。\n\n分类与回归树（CART）的标准不纯度准则是基尼不纯度。对于一个包含来自 $K$ 个类别的样本的节点 $T$，其基尼不纯度 $G(T)$ 定义为：\n$$G(T) = \\sum_{k=1}^{K} p_k(1-p_k) = 1 - \\sum_{k=1}^{K} p_k^2$$\n其中 $p_k$ 是节点 $T$ 中类别为 $k$ 的样本所占的比例。\n\n首先，我们计算父节点 $S$ 的基尼不纯度，记为 $G(S)$。节点 $S$ 共有 $N_S = 120$ 个像素。三个类别（森林、农田、水体）的比例 $p_k$ 分别为：\n- $p_{\\text{forest},S} = \\frac{60}{120} = \\frac{1}{2}$\n- $p_{\\text{cropland},S} = \\frac{40}{120} = \\frac{1}{3}$\n- $p_{\\text{water},S} = \\frac{20}{120} = \\frac{1}{6}$\n\n基尼不纯度 $G(S)$ 为：\n$$G(S) = 1 - \\left( p_{\\text{forest},S}^2 + p_{\\text{cropland},S}^2 + p_{\\text{water},S}^2 \\right)$$\n$$G(S) = 1 - \\left( \\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{3}\\right)^2 + \\left(\\frac{1}{6}\\right)^2 \\right)$$\n$$G(S) = 1 - \\left( \\frac{1}{4} + \\frac{1}{9} + \\frac{1}{36} \\right)$$\n为了对分数求和，我们找到一个公分母，即 $36$：\n$$G(S) = 1 - \\left( \\frac{9}{36} + \\frac{4}{36} + \\frac{1}{36} \\right) = 1 - \\frac{9+4+1}{36} = 1 - \\frac{14}{36}$$\n化简该分数得到：\n$$G(S) = 1 - \\frac{7}{18} = \\frac{11}{18}$$\n\n接下来，我们计算不纯度下降量。不纯度下降量 $\\Delta G$ 定义为父节点的不纯度减去子节点不纯度的加权平均值：\n$$\\Delta G = G(S) - \\left( \\frac{N_L}{N_S} G(S_L) + \\frac{N_R}{N_S} G(S_R) \\right)$$\n我们必须首先计算左子节点的不纯度 $G(S_L)$ 和右子节点的不纯度 $G(S_R)$。\n\n对于左子节点 $S_L$，总像素数为 $N_L = 90$。类别比例如下：\n- $p_{\\text{forest},L} = \\frac{50}{90} = \\frac{5}{9}$\n- $p_{\\text{cropland},L} = \\frac{30}{90} = \\frac{3}{9} = \\frac{1}{3}$\n- $p_{\\text{water},L} = \\frac{10}{90} = \\frac{1}{9}$\n基尼不纯度 $G(S_L)$ 为：\n$$G(S_L) = 1 - \\left( \\left(\\frac{5}{9}\\right)^2 + \\left(\\frac{1}{3}\\right)^2 + \\left(\\frac{1}{9}\\right)^2 \\right)$$\n$$G(S_L) = 1 - \\left( \\frac{25}{81} + \\frac{1}{9} + \\frac{1}{81} \\right) = 1 - \\left( \\frac{25}{81} + \\frac{9}{81} + \\frac{1}{81} \\right)$$\n$$G(S_L) = 1 - \\frac{25+9+1}{81} = 1 - \\frac{35}{81} = \\frac{46}{81}$$\n\n对于右子节点 $S_R$，总像素数为 $N_R = 30$。类别比例如下：\n- $p_{\\text{forest},R} = \\frac{10}{30} = \\frac{1}{3}$\n- $p_{\\text{cropland},R} = \\frac{10}{30} = \\frac{1}{3}$\n- $p_{\\text{water},R} = \\frac{10}{30} = \\frac{1}{3}$\n基尼不纯度 $G(S_R)$ 为：\n$$G(S_R) = 1 - \\left( \\left(\\frac{1}{3}\\right)^2 + \\left(\\frac{1}{3}\\right)^2 + \\left(\\frac{1}{3}\\right)^2 \\right)$$\n$$G(S_R) = 1 - 3 \\times \\left(\\frac{1}{9}\\right) = 1 - \\frac{3}{9} = 1 - \\frac{1}{3} = \\frac{2}{3}$$\n\n现在我们可以计算分裂的加权不纯度：\n$$G_{\\text{split}} = \\frac{N_L}{N_S} G(S_L) + \\frac{N_R}{N_S} G(S_R)$$\n权重为 $w_L = \\frac{N_L}{N_S} = \\frac{90}{120} = \\frac{3}{4}$ 和 $w_R = \\frac{N_R}{N_S} = \\frac{30}{120} = \\frac{1}{4}$。\n$$G_{\\text{split}} = \\left(\\frac{3}{4}\\right) \\left(\\frac{46}{81}\\right) + \\left(\\frac{1}{4}\\right) \\left(\\frac{2}{3}\\right)$$\n$$G_{\\text{split}} = \\frac{1 \\times 46}{4 \\times 27} + \\frac{2}{12} = \\frac{46}{108} + \\frac{1}{6}$$\n为了将它们相加，我们使用公分母 $108$：\n$$G_{\\text{split}} = \\frac{46}{108} + \\frac{18}{108} = \\frac{64}{108}$$\n将分子和分母同除以 $4$ 来化简分数：\n$$G_{\\text{split}} = \\frac{16}{27}$$\n\n最后，我们计算不纯度下降量 $\\Delta G$：\n$$\\Delta G = G(S) - G_{\\text{split}} = \\frac{11}{18} - \\frac{16}{27}$$\n$18$ 和 $27$ 的最小公倍数是 $54$。\n$$\\Delta G = \\frac{11 \\times 3}{18 \\times 3} - \\frac{16 \\times 2}{27 \\times 2} = \\frac{33}{54} - \\frac{32}{54} = \\frac{1}{54}$$\n\n父节点不纯度 $G(S)$ 是 $\\frac{11}{18}$，不纯度下降量是 $\\frac{1}{54}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{11}{18}  \\frac{1}{54} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在理解了如何评估单次划分后，下一步是在众多候选划分中找到最佳的一个。本练习聚焦于为分类预测变量（categorical predictor）寻找最优划分。它将向您展示CART算法中处理分类变量时所使用的特定高效算法，这对于在决策树建模中处理非数值数据是一项至关重要的技能。",
            "id": "3805106",
            "problem": "一项针对温带流域的土地覆盖分类研究，使用多光谱遥感训练数据构建决策树，该决策树根据具有5个水平的类别型预测变量$X$（代表土壤类型）来预测二元土地覆盖类别 $Y \\in \\{\\text{forest}, \\text{cropland}\\}$。土壤类型水平为 $\\{S_{1}, S_{2}, S_{3}, S_{4}, S_{5}\\}$。每种土壤类型的训练样本计数如下：\n\n- $S_{1}$：森林 $80$，农田 $20$，\n- $S_{2}$：森林 $60$，农田 $40$，\n- $S_{3}$：森林 $40$，农田 $60$，\n- $S_{4}$：森林 $20$，农田 $80$，\n- $S_{5}$：森林 $70$，农田 $30$。\n\n你需要评估一个分类与回归树（CART）决策树在根节点处使用$X$作为分裂变量的单次分裂。使用基尼不纯度（Gini impurity）的标准定义来衡量一个节点（根据经验类别比例），并使用因分裂导致的基尼下降（Gini decrease）的标准定义（即父节点不纯度减去两个子节点不纯度的加权平均值，权重为其样本量）。在将5个土壤类型水平划分为两个非空、不相交的组的所有二元划分中，确定使基尼下降最大化的划分。\n\n在你的计算过程中，报告实现此最大值的两组土壤类型水平，并计算此最优划分所达到的最大基尼下降。将最大基尼下降表示为一个简化的有理数。你提供的最终数值答案必须仅为最大基尼下降值。",
            "solution": "用户提供了一个问题，在尝试解决之前需要进行验证。\n\n### 第1步：提取已知条件\n-   **响应变量**：土地覆盖类别 $Y \\in \\{\\text{forest}, \\text{cropland}\\}$。\n-   **预测变量**：土壤类型 $X \\in \\{S_{1}, S_{2}, S_{3}, S_{4}, S_{5}\\}$。\n-   **训练数据计数**：\n    -   $S_{1}$：$80$ 森林，$20$ 农田。\n    -   $S_{2}$：$60$ 森林，$40$ 农田。\n    -   $S_{3}$：$40$ 森林，$60$ 农田。\n    -   $S_{4}$：$20$ 森林，$80$ 农田。\n    -   $S_{5}$：$70$ 森林，$30$ 农田。\n-   **算法**：根节点处的分类与回归树（CART）。\n-   **分裂标准**：基尼下降，定义为父节点不纯度减去子节点不纯度的加权平均值。\n-   **任务**：找到5个土壤类型水平的二元划分，使其基尼下降最大化，并计算此最大值。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是CART算法的一个标准应用，CART是机器学习和统计建模中的一个基本方法。使用基尼不纯度来分裂类别型预测变量是该算法的核心概念。使用遥感数据进行土地覆盖分类的背景是一个常见且有效的应用领域。\n2.  **适定性**：该问题是适定的。5个类别的可能二元划分数量是有限的（$2^{5-1} - 1 = 15$），这保证了最大基尼下降的存在。基尼不纯度和基尼下降的定义是标准且明确的。执行计算所需的所有数据都已提供。\n3.  **客观性**：该问题以定量数据和清晰、正式的定义客观地陈述。它不包含主观或基于意见的陈述。\n\n该问题没有任何无效性缺陷。它在科学上是合理的、适定的、客观的、完整的并且计算上是可行的。\n\n### 第3步：结论与行动\n问题有效。将提供详细的解决方案。\n\n### 解答\n目标是找到预测变量 $X$（土壤类型）的二元划分，该划分使得CART决策树根节点的基尼下降最大化。\n\n首先，我们定义节点 $m$ 的基尼不纯度。设 $p_{mk}$ 是节点 $m$ 中类别 $k$ 的训练实例所占的比例。对于一组类别 $K$，基尼不纯度为：\n$$G(m) = 1 - \\sum_{k \\in K} p_{mk}^2$$\n对于我们的二元分类问题（$Y \\in \\{\\text{forest}, \\text{cropland}\\}$），这可以简化为：\n$$G(m) = 1 - (p_{m, \\text{forest}}^2 + p_{m, \\text{cropland}}^2)$$\n\n将父节点 $p$ 分裂为两个子节点（左节点 $l$ 和右节点 $r$）的基尼下降由下式给出：\n$$\\Delta G = G(p) - (w_l G(l) + w_r G(r))$$\n其中 $w_l$ 和 $w_r$ 分别是父节点中进入左、右子节点的实例比例（$w_l = N_l / N_p$，$w_r = N_r / N_p$，其中 $N$ 是样本数）。\n\n**1. 计算根（父）节点的基尼不纯度。**\n\n首先，我们计算整个数据集中的总样本数和每个类别的计数。\n每种土壤类型的总样本数：$S_1, S_2, S_3, S_4, S_5$ 各有 $100$ 个样本。\n总样本数 $N_p = 5 \\times 100 = 500$。\n\n“森林”类总样本数：$N_{p, \\text{forest}} = 80 + 60 + 40 + 20 + 70 = 270$。\n“农田”类总样本数：$N_{p, \\text{cropland}} = 20 + 40 + 60 + 80 + 30 = 230$。\n检验：$270 + 230 = 500 = N_p$。\n\n根节点的比例为：\n$p_{p, \\text{forest}} = \\frac{270}{500} = \\frac{27}{50}$\n$p_{p, \\text{cropland}} = \\frac{230}{500} = \\frac{23}{50}$\n\n父节点的基尼不纯度为：\n$$G(p) = 1 - \\left( \\left(\\frac{27}{50}\\right)^2 + \\left(\\frac{23}{50}\\right)^2 \\right) = 1 - \\frac{729 + 529}{2500} = 1 - \\frac{1258}{2500} = \\frac{1242}{2500} = \\frac{621}{1250}$$\n\n**2. 确定最优分裂。**\n\n对于具有 $C$ 个水平的类别型预测变量和二元结果，寻找最优分裂的过程可以简化。我们根据其中一个类别的比例对各类别进行排序。最优划分将通过分裂这个有序的类别列表来找到。有 $C-1$ 个这样的分裂需要检查。\n\n让我们计算每种土壤类型中“森林”类的比例：\n- $S_1: p_f = \\frac{80}{100} = 0.8$\n- $S_2: p_f = \\frac{60}{100} = 0.6$\n- $S_3: p_f = \\frac{40}{100} = 0.4$\n- $S_4: p_f = \\frac{20}{100} = 0.2$\n- $S_5: p_f = \\frac{70}{100} = 0.7$\n\n按“森林”类比例递增排序的土壤类型顺序是：$\\{S_4, S_3, S_2, S_5, S_1\\}$。\n这给了我们 $5-1=4$ 个候选分裂进行评估。\n\n**候选分裂 1: $\\{S_4\\}$ vs. $\\{S_3, S_2, S_5, S_1\\}$**\n- 左节点 ($l_1 = \\{S_4\\}$)：$N_{l_1} = 100$。$N_{l_1,f}=20, N_{l_1,c}=80$。\n$G(l_1) = 1 - ((\\frac{20}{100})^2 + (\\frac{80}{100})^2) = 1 - (0.04 + 0.64) = 0.32 = \\frac{8}{25}$。\n- 右节点 ($r_1 = \\{S_3, S_2, S_5, S_1\\}$)：$N_{r_1} = 400$。$N_{r_1,f}=40+60+70+80=250$, $N_{r_1,c}=60+40+30+20=150$。\n$G(r_1) = 1 - ((\\frac{250}{400})^2 + (\\frac{150}{400})^2) = 1 - ((\\frac{5}{8})^2 + (\\frac{3}{8})^2) = 1 - \\frac{25+9}{64} = 1 - \\frac{34}{64} = \\frac{30}{64} = \\frac{15}{32}$。\n- 基尼下降：$\\Delta G_1 = G(p) - (\\frac{100}{500}G(l_1) + \\frac{400}{500}G(r_1)) = \\frac{621}{1250} - (\\frac{1}{5}\\frac{8}{25} + \\frac{4}{5}\\frac{15}{32}) = \\frac{621}{1250} - (\\frac{8}{125} + \\frac{3}{8}) = \\frac{621}{1250} - \\frac{64+375}{1000} = \\frac{621}{1250} - \\frac{439}{1000} = \\frac{2484-2195}{5000} = \\frac{289}{5000}$。\n\n**候选分裂 2: $\\{S_4, S_3\\}$ vs. $\\{S_2, S_5, S_1\\}$**\n- 左节点 ($l_2 = \\{S_4, S_3\\}$)：$N_{l_2} = 200$。$N_{l_2,f}=20+40=60$, $N_{l_2,c}=80+60=140$。\n$G(l_2) = 1 - ((\\frac{60}{200})^2 + (\\frac{140}{200})^2) = 1 - ((\\frac{3}{10})^2 + (\\frac{7}{10})^2) = 1 - \\frac{9+49}{100} = \\frac{42}{100} = \\frac{21}{50}$。\n- 右节点 ($r_2 = \\{S_2, S_5, S_1\\}$)：$N_{r_2} = 300$。$N_{r_2,f}=60+70+80=210$, $N_{r_2,c}=40+30+20=90$。\n$G(r_2) = 1 - ((\\frac{210}{300})^2 + (\\frac{90}{300})^2) = 1 - ((\\frac{7}{10})^2 + (\\frac{3}{10})^2) = 1 - \\frac{49+9}{100} = \\frac{42}{100} = \\frac{21}{50}$。\n- 基尼下降：$\\Delta G_2 = G(p) - (\\frac{200}{500}G(l_2) + \\frac{300}{500}G(r_2)) = \\frac{621}{1250} - (\\frac{2}{5}\\frac{21}{50} + \\frac{3}{5}\\frac{21}{50}) = \\frac{621}{1250} - (\\frac{2+3}{5})\\frac{21}{50} = \\frac{621}{1250} - \\frac{21}{50} = \\frac{621 - 21 \\times 25}{1250} = \\frac{621-525}{1250} = \\frac{96}{1250} = \\frac{48}{625}$。\n\n**候选分裂 3: $\\{S_4, S_3, S_2\\}$ vs. $\\{S_5, S_1\\}$**\n- 左节点 ($l_3 = \\{S_4, S_3, S_2\\}$)：$N_{l_3} = 300$。$N_{l_3,f}=20+40+60=120$, $N_{l_3,c}=80+60+40=180$。\n$G(l_3) = 1 - ((\\frac{120}{300})^2 + (\\frac{180}{300})^2) = 1 - ((\\frac{2}{5})^2 + (\\frac{3}{5})^2) = 1 - \\frac{4+9}{25} = \\frac{12}{25}$。\n- 右节点 ($r_3 = \\{S_5, S_1\\}$)：$N_{r_3} = 200$。$N_{r_3,f}=70+80=150$, $N_{r_3,c}=30+20=50$。\n$G(r_3) = 1 - ((\\frac{150}{200})^2 + (\\frac{50}{200})^2) = 1 - ((\\frac{3}{4})^2 + (\\frac{1}{4})^2) = 1 - \\frac{9+1}{16} = \\frac{6}{16} = \\frac{3}{8}$。\n- 基尼下降：$\\Delta G_3 = G(p) - (\\frac{3}{5}G(l_3) + \\frac{2}{5}G(r_3)) = \\frac{621}{1250} - (\\frac{3}{5}\\frac{12}{25} + \\frac{2}{5}\\frac{3}{8}) = \\frac{621}{1250} - (\\frac{36}{125} + \\frac{3}{20}) = \\frac{621}{1250} - \\frac{144+75}{500} = \\frac{621}{1250} - \\frac{219}{500} = \\frac{1242-1095}{2500} = \\frac{147}{2500}$。\n\n**候选分裂 4: $\\{S_4, S_3, S_2, S_5\\}$ vs. $\\{S_1\\}$**\n- 左节点 ($l_4 = \\{S_4, S_3, S_2, S_5\\}$)：$N_{l_4} = 400$。$N_{l_4,f}=20+40+60+70=190$, $N_{l_4,c}=80+60+40+30=210$。\n$G(l_4) = 1 - ((\\frac{190}{400})^2 + (\\frac{210}{400})^2) = 1 - ((\\frac{19}{40})^2+(\\frac{21}{40})^2) = 1 - \\frac{361+441}{1600} = \\frac{1600-802}{1600} = \\frac{798}{1600}=\\frac{399}{800}$。\n- 右节点 ($r_4 = \\{S_1\\}$)：$N_{r_4} = 100$。$N_{r_4,f}=80, N_{r_4,c}=20$。\n$G(r_4) = 1 - ((\\frac{80}{100})^2 + (\\frac{20}{100})^2) = 1 - (0.64+0.04) = 0.32 = \\frac{8}{25}$。\n- 基尼下降：$\\Delta G_4 = G(p) - (\\frac{4}{5}G(l_4) + \\frac{1}{5}G(r_4)) = \\frac{621}{1250} - (\\frac{4}{5}\\frac{399}{800} + \\frac{1}{5}\\frac{8}{25}) = \\frac{621}{1250} - (\\frac{399}{1000} + \\frac{8}{125}) = \\frac{621}{1250} - \\frac{399+64}{1000} = \\frac{621}{1250} - \\frac{463}{1000} = \\frac{2484 - 2315}{5000} = \\frac{169}{5000}$。\n\n**3. 比较基尼下降值。**\n我们比较这四个值：\n- $\\Delta G_1 = \\frac{289}{5000} = 0.0578$\n- $\\Delta G_2 = \\frac{48}{625} = \\frac{384}{5000} = 0.0768$\n- $\\Delta G_3 = \\frac{147}{2500} = \\frac{294}{5000} = 0.0588$\n- $\\Delta G_4 = \\frac{169}{5000} = 0.0338$\n\n最大值是 $\\Delta G_2 = \\frac{48}{625}$。\n这个最大的基尼下降是通过将土壤类型划分为 $\\{S_4, S_3\\}$ 和 $\\{S_1, S_2, S_5\\}$ 这两组的划分实现的。\n\n最大基尼下降为 $\\frac{48}{625}$。",
            "answer": "$$\\boxed{\\frac{48}{625}}$$"
        },
        {
            "introduction": "一棵完全生长的决策树往往会捕捉到训练数据中的噪声，导致过拟合。为了创建一个更稳健的模型，我们必须对树进行剪枝。本练习将介绍成本复杂度剪枝法，这是CART算法的核心先进技术，它使用一个复杂度参数 $\\alpha$ 来惩罚叶节点的数量。通过追踪剪枝路径，您将学会如何策略性地简化决策树，以提高其泛化能力。",
            "id": "3805108",
            "problem": "一棵土地覆盖分类决策树在一个带标签的卫星像素集上进行了训练，以使用多光谱阈值来区分主要类别（城市、植被、水体、裸土）。该方法是分类与回归树（CART）。在此训练中，每个终端叶节点分配其区域内的多数类别，并产生一个重代入误分类计数。下面这棵小树有五个终端叶节点，其重代入误差为 $\\left(e_{1}, e_{2}, e_{3}, e_{4}, e_{5}\\right)$，以及四个内部节点，其聚合误差（即如果整个节点的区域被单一多数类别标记时的误分类计数）也已给出。\n\n树的拓扑结构如下：根节点 $U$ 分裂为一个左内部节点 $A$ 和一个右内部节点 $D$；节点 $A$ 分裂为叶节点 $1$ 和 $2$；节点 $D$ 分裂为一个内部节点 $B$ 和叶节点 $5$；节点 $B$ 分裂为叶节点 $3$ 和 $4$。\n\n叶节点的重代入误差为\n$$\ne_{1} = 12,\\quad e_{2} = 8,\\quad e_{3} = 15,\\quad e_{4} = 10,\\quad e_{5} = 6.\n$$\n内部节点的聚合误差（如果每个节点都被剪枝成一个单一叶节点，并使用其区域内的多数标签进行标记）为\n$$\nE_{A} = 24,\\quad E_{B} = 28,\\quad E_{D} = 40,\\quad E_{U} = 72.\n$$\n\n假设使用成本复杂度剪枝，复杂度惩罚参数为 $\\alpha \\geq 0$，树的选择是通过最小化一个惩罚经验风险来进行的，该风险是所有叶节点的重代入误分类计数之和，再加上一个与叶节点数量成线性关系的惩罚项。使用源自结构风险最小化的第一性原理进行推理，通过确定最优子树发生变化的临界惩罚值序列以及每个子树成为最优所对应的 $\\alpha$ 区间，来确定剪枝路径。\n\n以单行矩阵的形式，按升序报告临界惩罚值的序列。给出精确值（不要四舍五入）。",
            "solution": "该问题提法明确，具有科学依据，并为获得唯一解提供了所有必要信息。数据内部一致。因此，将推导出解答。\n\n该问题要求使用成本复杂度剪枝来确定给定决策树的剪枝路径。该方法是分类与回归树（CART）算法的核心，旨在找到一系列对于复杂度惩罚参数 $\\alpha$ 的一个连续范围而言是最优的子树。\n\n树 $T$ 的成本复杂度定义为：\n$$\nC_{\\alpha}(T) = R(T) + \\alpha |T_{\\text{leaves}}|\n$$\n其中 $R(T)$ 是总重代入误分类计数，即树 $T$ 中所有终端叶节点的误差之和，而 $|T_{\\text{leaves}}|$ 是 $T$ 中终端叶节点的数量。参数 $\\alpha \\ge 0$ 对树的复杂度进行惩罚，该复杂度由其叶节点的数量来衡量。\n\n对于树中的任意内部节点 $t$，我们可以考虑以 $t$ 为根的子树 $T_t$。该子树的成本复杂度为 $C_{\\alpha}(T_t) = R(T_t) + \\alpha |(T_t)_{\\text{leaves}}|$。如果我们将这个子树剪枝，节点 $t$ 将成为一个终端叶节点。这种剪枝后状态的成本复杂度为 $C_{\\alpha}(\\{t\\}) = E_t + \\alpha \\cdot 1$，其中 $E_t$ 是对应于节点 $t$ 区域的聚合误分类计数。\n\n当将节点 $t$ 变为叶节点的成本小于或等于以 $t$ 为根的未剪枝子树的成本时，该节点 $t$ 成为一个剪枝候选者：\n$$\nE_t + \\alpha \\le R(T_t) + \\alpha |(T_t)_{\\text{leaves}}|\n$$\n使成本相等的 $\\alpha$ 的临界值定义了节点 $t$ 成为树中“最弱环节”的点。整理该方程可得到节点 $t$ 的临界复杂度参数：\n$$\n\\alpha_t = \\frac{E_t - R(T_t)}{|(T_t)_{\\text{leaves}}| - 1}\n$$\n成本复杂度剪枝算法是迭代进行的。从完整的树开始，我们为每个内部节点计算 $\\alpha_t$。$\\alpha_t$ 值最小的节点首先被剪枝。这个过程在新剪枝的树上重复进行，直到只剩下根节点。\n\n我们将初始的完整树表示为 $T_0$。其拓扑结构包括内部节点 $U, A, D, B$ 和终端叶节点 $1, 2, 3, 4, 5$。\n叶节点的误差给定为 $e_{1} = 12$，$e_{2} = 8$，$e_{3} = 15$，$e_{4} = 10$ 和 $e_{5} = 6$。\n内部节点的聚合误差为 $E_{A} = 24$，$E_{B} = 28$，$E_{D} = 40$ 和 $E_{U} = 72$。\n\n首先，我们必须计算完整树 $T_0$ 的每个内部节点为根的子树的重代入误差 $R(T_t)$ 和叶节点数量 $|(T_t)_{\\text{leaves}}|$。\n\n对于节点 $A$：\n子树 $T_A$ 有叶节点 $1$ 和 $2$。\n$R(T_A) = e_1 + e_2 = 12 + 8 = 20$。\n$|(T_A)_{\\text{leaves}}| = 2$。\n\n对于节点 $B$：\n子树 $T_B$ 有叶节点 $3$ 和 $4$。\n$R(T_B) = e_3 + e_4 = 15 + 10 = 25$。\n$|(T_B)_{\\text{leaves}}| = 2$。\n\n对于节点 $D$：\n子树 $T_D$ 有一个内部节点 $B$ 和一个叶节点 $5$。它的叶节点是 $T_B$ 的叶节点和叶节点 $5$。\n$R(T_D) = R(T_B) + e_5 = 25 + 6 = 31$。\n$|(T_D)_{\\text{leaves}}| = |(T_B)_{\\text{leaves}}| + 1 = 2 + 1 = 3$。\n\n对于根节点 $U$：\n完整树 $T_U = T_0$ 有内部节点 $A$ 和 $D$。它的叶节点是来自 $T_A$ 和 $T_D$ 的叶节点的并集。\n$R(T_U) = R(T_A) + R(T_D) = 20 + 31 = 51$。\n$|(T_U)_{\\text{leaves}}| = |(T_A)_{\\text{leaves}}| + |(T_D)_{\\text{leaves}}| = 2 + 3 = 5$。\n\n现在，我们可以计算 $T_0$ 中所有内部节点的临界 $\\alpha$ 值。\n\n$\\alpha_A = \\frac{E_A - R(T_A)}{|(T_A)_{\\text{leaves}}| - 1} = \\frac{24 - 20}{2 - 1} = \\frac{4}{1} = 4$。\n$\\alpha_B = \\frac{E_B - R(T_B)}{|(T_B)_{\\text{leaves}}| - 1} = \\frac{28 - 25}{2 - 1} = \\frac{3}{1} = 3$。\n$\\alpha_D = \\frac{E_D - R(T_D)}{|(T_D)_{\\text{leaves}}| - 1} = \\frac{40 - 31}{3 - 1} = \\frac{9}{2} = 4.5$。\n$\\alpha_U = \\frac{E_U - R(T_U)}{|(T_U)_{\\text{leaves}}| - 1} = \\frac{72 - 51}{5 - 1} = \\frac{21}{4} = 5.25$。\n\n这些值的最小值是 $\\alpha_B = 3$。因此，第一个临界惩罚值是 $\\alpha_{(1)} = 3$。对于 $\\alpha \\in [0, 3)$，完整树 $T_0$ 是最优子树。在 $\\alpha = 3$ 时，我们剪枝节点 $B$。\n\n设 $T_1$ 是通过剪枝节点 $B$ 得到的树。在 $T_1$ 中，$B$ 成为一个叶节点（我们将其表示为 $B'$），其误差为 $R(B') = E_B = 28$。\n$T_1$ 的内部节点是 $A, D, U$。叶节点是 $\\{1, 2, B', 5\\}$。\n我们重新计算 $T_1$ 内部节点的临界 $\\alpha$ 值。\n\n对于节点 $A$：子树 $T_A$ 未改变，所以 $\\alpha_A = 4$。\n对于节点 $D$：$T_1$ 中的子树 $T_D$ 现在有叶节点 $\\{B', 5\\}$。\n$R(T_D \\text{ in } T_1) = R(B') + e_5 = 28 + 6 = 34$。\n$|(T_D \\text{ in } T_1)_{\\text{leaves}}| = 2$。\n$\\alpha_D = \\frac{E_D - R(T_D \\text{ in } T_1)}{|(T_D \\text{ in } T_1)_{\\text{leaves}}| - 1} = \\frac{40 - 34}{2 - 1} = \\frac{6}{1} = 6$。\n对于节点 $U$：树 $T_U$ 现在是 $T_1$。\n$R(T_1) = R(T_A) + R(T_D \\text{ in } T_1) = (e_1+e_2) + (E_B+e_5) = 20 + 34 = 54$。\n$|T_1|_{\\text{leaves}} = 4$。\n$\\alpha_U = \\frac{E_U - R(T_1)}{|T_1|_{\\text{leaves}} - 1} = \\frac{72 - 54}{4 - 1} = \\frac{18}{3} = 6$。\n\n候选临界值集合为 $\\{\\alpha_A, \\alpha_D, \\alpha_U\\} = \\{4, 6, 6\\}$。最小值是 $\\alpha_A = 4$。所以，第二个临界值是 $\\alpha_{(2)} = 4$。对于 $\\alpha \\in [3, 4)$，树 $T_1$ 是最优的。在 $\\alpha=4$ 时，节点 $A$ 被剪枝。\n\n设 $T_2$ 是从 $T_1$ 中剪枝节点 $A$ 得到的树。节点 $A$ 成为一个叶节点 $A'$，其误差为 $R(A')=E_A = 24$。\n$T_2$ 的内部节点是 $D, U$。叶节点是 $\\{A', B', 5\\}$。\n我们重新计算 $T_2$ 内部节点的临界 $\\alpha$ 值。\n\n对于节点 $D$：子树 $T_D$ 不受在 $A$ 处剪枝的影响。它在 $T_2$ 中的结构与在 $T_1$ 中相同。因此，$\\alpha_D = 6$。\n对于节点 $U$：树 $T_U$ 现在是 $T_2$。\n$R(T_2) = R(A') + R(B') + e_5 = 24 + 28 + 6 = 58$。\n$|T_2|_{\\text{leaves}} = 3$。\n$\\alpha_U = \\frac{E_U - R(T_2)}{|T_2|_{\\text{leaves}} - 1} = \\frac{72 - 58}{3 - 1} = \\frac{14}{2} = 7$。\n\n候选值集合为 $\\{\\alpha_D, \\alpha_U\\} = \\{6, 7\\}$。最小值是 $\\alpha_D = 6$。所以，第三个临界值是 $\\alpha_{(3)} = 6$。对于 $\\alpha \\in [4, 6)$，树 $T_2$ 是最优的。在 $\\alpha=6$ 时，节点 $D$ 被剪枝。\n\n设 $T_3$ 是从 $T_2$ 中剪枝节点 $D$ 得到的树。节点 $D$ 成为一个叶节点 $D'$，其误差为 $R(D')=E_D = 40$。\n$T_3$ 的唯一内部节点是 $U$。叶节点是 $\\{A', D'\\}$。\n我们计算剩余内部节点 $U$ 的临界 $\\alpha$ 值。\n\n对于节点 $U$：树 $T_U$ 现在是 $T_3$。\n$R(T_3) = R(A') + R(D') = 24 + 40 = 64$。\n$|T_3|_{\\text{leaves}} = 2$。\n$\\alpha_U = \\frac{E_U - R(T_3)}{|T_3|_{\\text{leaves}} - 1} = \\frac{72 - 64}{2 - 1} = \\frac{8}{1} = 8$。\n\n只有一个内部节点，所以它的 $\\alpha$ 值是下一个临界值，$\\alpha_{(4)} = 8$。对于 $\\alpha \\in [6, 8)$，树 $T_3$ 是最优的。在 $\\alpha=8$ 时，节点 $U$ 被剪枝。\n\n剪枝节点 $U$ 得到平凡树 $T_4$，它只包含根节点。这棵树有 1 个叶节点，总误差为 $E_U = 72$。剪枝过程现已完成。对于 $\\alpha \\in [8, \\infty)$，平凡树 $T_4$ 是最优的。\n\n最优子树发生变化的临界惩罚值序列为 $\\alpha_{(1)}, \\alpha_{(2)}, \\alpha_{(3)}, \\alpha_{(4)}$。\n该序列为 $3, 4, 6, 8$。\n由这些值定义的区间所对应的最优子树序列是 $T_0, T_1, T_2, T_3, T_4$。\n\n临界惩罚值的序列，按升序排列，为 $\\{3, 4, 6, 8\\}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  4  6  8\n\\end{pmatrix}\n}\n$$"
        }
    ]
}