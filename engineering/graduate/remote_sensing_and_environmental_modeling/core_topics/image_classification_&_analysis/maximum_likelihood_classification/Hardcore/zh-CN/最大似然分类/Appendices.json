{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习是一项基础性训练，它将引导你完成最大似然分类（Maximum Likelihood Classification）的基本步骤。你将学习如何利用训练数据为不同类别推导均值和协方差的最大似然估计量，然后使用这些估计出的参数来为一个新的未知像素计算对数似然值。这个过程构成了概率分类方法的基石，是理解更高级模型的基础 。",
            "id": "3826538",
            "problem": "一幅多光谱卫星图像提供了三个经过校准的反射率波段：蓝光、红光和近红外（NIR）。考虑水体和植被两种地物覆盖类型，它们由具有未知均值向量和协方差矩阵的类条件三变量正态分布建模。为您提供了每个类别的训练样本，这些样本采集自同质区域，并经过预处理以消除大气和光照伪影。设水体类别的训练样本为\n$$\n(0.05,\\,0.03,\\,0.02),\\quad\n(0.06,\\,0.03,\\,0.02),\\quad\n(0.04,\\,0.03,\\,0.02),\\quad\n(0.05,\\,0.04,\\,0.02),\\quad\n(0.05,\\,0.02,\\,0.02),\\quad\n(0.05,\\,0.03,\\,0.03),\\quad\n(0.05,\\,0.03,\\,0.01),\n$$\n植被类别的训练样本为\n$$\n(0.06,\\,0.08,\\,0.45),\\quad\n(0.08,\\,0.08,\\,0.45),\\quad\n(0.04,\\,0.08,\\,0.45),\\quad\n(0.06,\\,0.11,\\,0.45),\\quad\n(0.06,\\,0.05,\\,0.45),\\quad\n(0.06,\\,0.08,\\,0.50),\\quad\n(0.06,\\,0.08,\\,0.40).\n$$\n一个反射率向量为\n$$\n\\mathbf{x}=(0.052,\\,0.031,\\,0.022)\n$$\n的新像素需要通过最大似然分类法进行分类（忽略任何类别先验概率和错分代价）。从多变量正态分布的概率密度函数和最大似然原理出发，推导每个类别的均值和协方差的最大似然估计量，根据给定的训练数据估计这些参数，然后计算精确的对数似然比\n$$\n\\Lambda(\\mathbf{x})=\\ln p(\\mathbf{x}\\mid \\text{water})-\\ln p(\\mathbf{x}\\mid \\text{vegetation}),\n$$\n在估计的参数下求值。\n\n将 $\\Lambda(\\mathbf{x})$ 的最终值表示为一个无量纲实数，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求我们使用最大似然分类法对一个新像素进行分类，这涉及到计算该像素的反射率向量属于“水体”类别与“植被”类别的对数似然比。类条件概率分布被建模为三变量正态分布。\n\n首先，我们必须验证问题陈述的有效性。\n给定条件如下：\n- 两个类别：水体 ($\\omega_1$) 和植被 ($\\omega_2$)。\n- 数据是 $d=3$ 维的，代表蓝光、红光和近红外（NIR）反射率。\n- 每个类别 $i$ 的类条件概率密度函数（PDF）是一个三变量正态分布 $p(\\mathbf{x}|\\omega_i) \\sim N(\\boldsymbol{\\mu}_i, \\boldsymbol{\\Sigma}_i)$。\n- 水体类别有 $N_1=7$ 个训练样本：\n$(0.05, 0.03, 0.02)$, $(0.06, 0.03, 0.02)$, $(0.04, 0.03, 0.02)$, $(0.05, 0.04, 0.02)$, $(0.05, 0.02, 0.02)$, $(0.05, 0.03, 0.03)$, $(0.05, 0.03, 0.01)$。\n- 植被类别有 $N_2=7$ 个训练样本：\n$(0.06, 0.08, 0.45)$, $(0.08, 0.08, 0.45)$, $(0.04, 0.08, 0.45)$, $(0.06, 0.11, 0.45)$, $(0.06, 0.05, 0.45)$, $(0.06, 0.08, 0.50)$, $(0.06, 0.08, 0.40)$。\n- 一个反射率向量为 $\\mathbf{x}=(0.052, 0.031, 0.022)$ 的新像素需要被分类。\n- 任务是计算对数似然比 $\\Lambda(\\mathbf{x})=\\ln p(\\mathbf{x}\\mid \\text{water})-\\ln p(\\mathbf{x}\\mid \\text{vegetation})$，忽略类别先验概率。\n- 最终答案必须四舍五入到四位有效数字。\n\n该问题具有科学依据，因为它代表了遥感图像分析中的一个标准任务。对于水体和植被，这些反射率值在物理上是合理的。使用多变量正态模型是一种常见且合适的统计假设。问题是适定的，提供了所有必要的数据和明确的目标。没有矛盾或含糊之处。样本数量（$N=7$）大于维度（$d=3$），这确保了样本协方差矩阵是非奇异的。因此，该问题是有效的。\n\n我们开始解题。\n\n**步骤1：推导最大似然估计量（MLE）**\n设一组 $N$ 个独立同分布（i.i.d.）的样本 $\\{\\mathbf{x}_1, \\dots, \\mathbf{x}_N\\}$ 从一个 $d$ 维多变量正态分布 $N(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$ 中抽取。其概率密度函数（PDF）为：\n$$p(\\mathbf{x} | \\boldsymbol{\\mu}, \\boldsymbol{\\Sigma}) = \\frac{1}{(2\\pi)^{d/2} |\\boldsymbol{\\Sigma}|^{1/2}} \\exp\\left(-\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^T \\boldsymbol{\\Sigma}^{-1} (\\mathbf{x}-\\boldsymbol{\\mu})\\right)$$\n这 $N$ 个样本的对数似然函数为：\n$$\n\\ln L(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma}) = \\sum_{k=1}^{N} \\ln p(\\mathbf{x}_k | \\boldsymbol{\\mu}, \\boldsymbol{\\Sigma}) = -\\frac{Nd}{2}\\ln(2\\pi) - \\frac{N}{2}\\ln|\\boldsymbol{\\Sigma}| - \\frac{1}{2}\\sum_{k=1}^{N} (\\mathbf{x}_k-\\boldsymbol{\\mu})^T \\boldsymbol{\\Sigma}^{-1} (\\mathbf{x}_k-\\boldsymbol{\\mu})\n$$\n为了找到均值 $\\boldsymbol{\\mu}$ 的最大似然估计（MLE），我们对 $\\boldsymbol{\\mu}$ 求梯度并令其为零：\n$$\n\\nabla_{\\boldsymbol{\\mu}} \\ln L = \\sum_{k=1}^{N} \\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}_k - \\boldsymbol{\\mu}) = \\boldsymbol{0} \\implies \\sum_{k=1}^{N} (\\mathbf{x}_k - \\boldsymbol{\\mu}) = \\boldsymbol{0} \\implies N\\hat{\\boldsymbol{\\mu}} = \\sum_{k=1}^{N} \\mathbf{x}_k\n$$\n这给出了均值的最大似然估计，即样本均值：\n$$\\hat{\\boldsymbol{\\mu}} = \\frac{1}{N} \\sum_{k=1}^{N} \\mathbf{x}_k$$\n为了找到协方差 $\\boldsymbol{\\Sigma}$ 的最大似然估计，我们将 $\\ln L$ 对 $\\boldsymbol{\\Sigma}^{-1}$ 求导并令结果为零。这得出：\n$$\\hat{\\boldsymbol{\\Sigma}} = \\frac{1}{N} \\sum_{k=1}^{N} (\\mathbf{x}_k - \\hat{\\boldsymbol{\\mu}})(\\mathbf{x}_k - \\hat{\\boldsymbol{\\mu}})^T$$\n这就是样本协方差矩阵（使用 $1/N$ 进行缩放）。\n\n**步骤2：估计每个类别的参数**\n设 $\\omega_1$ 为水体类别，$\\omega_2$ 为植被类别。这里，$d=3$ 且 $N_1=N_2=7$。\n\n对于水体类别（$ \\omega_1 $）：\n样本向量的和为 $\\sum_{k=1}^{7} \\mathbf{x}_{1,k} = (0.35, 0.21, 0.14)^T$。\n均值的最大似然估计为：\n$$\\hat{\\boldsymbol{\\mu}}_1 = \\frac{1}{7}(0.35, 0.21, 0.14)^T = (0.05, 0.03, 0.02)^T$$\n中心化向量 $(\\mathbf{x}_{1,k} - \\hat{\\boldsymbol{\\mu}}_1)$ 为：$(0,0,0)^T$, $(0.01,0,0)^T$, $(-0.01,0,0)^T$, $(0,0.01,0)^T$, $(0,-0.01,0)^T$, $(0,0,0.01)^T$, $(0,0,-0.01)^T$。\n外积的和为：\n$$ \\sum_{k=1}^{7} (\\mathbf{x}_{1,k} - \\hat{\\boldsymbol{\\mu}}_1)(\\mathbf{x}_{1,k} - \\hat{\\boldsymbol{\\mu}}_1)^T = \\begin{pmatrix} 2(0.01^2)  0  0 \\\\ 0  2(0.01^2)  0 \\\\ 0  0  2(0.01^2) \\end{pmatrix} = \\begin{pmatrix} 0.0002  0  0 \\\\ 0  0.0002  0 \\\\ 0  0  0.0002 \\end{pmatrix} $$\n协方差矩阵的最大似然估计为：\n$$ \\hat{\\boldsymbol{\\Sigma}}_1 = \\frac{1}{7} \\begin{pmatrix} 0.0002  0  0 \\\\ 0  0.0002  0 \\\\ 0  0  0.0002 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{70000}  0  0 \\\\ 0  \\frac{2}{70000}  0 \\\\ 0  0  \\frac{2}{70000} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{35000}  0  0 \\\\ 0  \\frac{1}{35000}  0 \\\\ 0  0  \\frac{1}{35000} \\end{pmatrix} $$\n\n对于植被类别（$ \\omega_2 $）：\n样本向量的和为 $\\sum_{k=1}^{7} \\mathbf{x}_{2,k} = (0.42, 0.56, 3.15)^T$。\n均值的最大似然估计为：\n$$\\hat{\\boldsymbol{\\mu}}_2 = \\frac{1}{7}(0.42, 0.56, 3.15)^T = (0.06, 0.08, 0.45)^T$$\n中心化向量 $(\\mathbf{x}_{2,k} - \\hat{\\boldsymbol{\\mu}}_2)$ 的非零分量为：$(0.02,0,0)^T$, $(-0.02,0,0)^T$, $(0,0.03,0)^T$, $(0,-0.03,0)^T$, $(0,0,0.05)^T$, $(0,0,-0.05)^T$。\n外积的和为：\n$$ \\sum_{k=1}^{7} (\\mathbf{x}_{2,k} - \\hat{\\boldsymbol{\\mu}}_2)(\\mathbf{x}_{2,k} - \\hat{\\boldsymbol{\\mu}}_2)^T = \\begin{pmatrix} 2(0.02^2)  0  0 \\\\ 0  2(0.03^2)  0 \\\\ 0  0  2(0.05^2) \\end{pmatrix} = \\begin{pmatrix} 0.0008  0  0 \\\\ 0  0.0018  0 \\\\ 0  0  0.0050 \\end{pmatrix} $$\n协方差矩阵的最大似然估计为：\n$$ \\hat{\\boldsymbol{\\Sigma}}_2 = \\frac{1}{7} \\begin{pmatrix} 0.0008  0  0 \\\\ 0  0.0018  0 \\\\ 0  0  0.0050 \\end{pmatrix} = \\begin{pmatrix} \\frac{8}{70000}  0  0 \\\\ 0  \\frac{18}{70000}  0 \\\\ 0  0  \\frac{50}{70000} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{35000}  0  0 \\\\ 0  \\frac{9}{35000}  0 \\\\ 0  0  \\frac{25}{35000} \\end{pmatrix} $$\n\n**步骤3：计算对数似然比**\n对数似然比 $\\Lambda(\\mathbf{x})$ 由下式给出：\n$$\n\\Lambda(\\mathbf{x}) = \\ln p(\\mathbf{x}\\mid \\hat{\\boldsymbol{\\mu}}_1, \\hat{\\boldsymbol{\\Sigma}}_1) - \\ln p(\\mathbf{x}\\mid \\hat{\\boldsymbol{\\mu}}_2, \\hat{\\boldsymbol{\\Sigma}}_2)\n$$\n代入对数概率密度函数（log-PDF）的表达式：\n$$\n\\Lambda(\\mathbf{x}) = \\left[-\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\hat{\\boldsymbol{\\Sigma}}_1| - \\frac{1}{2}D_1^2(\\mathbf{x})\\right] - \\left[-\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\hat{\\boldsymbol{\\Sigma}}_2| - \\frac{1}{2}D_2^2(\\mathbf{x})\\right]\n$$\n其中 $D_i^2(\\mathbf{x}) = (\\mathbf{x}-\\hat{\\boldsymbol{\\mu}}_i)^T \\hat{\\boldsymbol{\\Sigma}}_i^{-1} (\\mathbf{x}-\\hat{\\boldsymbol{\\mu}}_i)$ 是马氏距离（Mahalanobis distance）的平方。\n简化后，我们得到：\n$$\n\\Lambda(\\mathbf{x}) = \\frac{1}{2}\\ln\\left(\\frac{|\\hat{\\boldsymbol{\\Sigma}}_2|}{|\\hat{\\boldsymbol{\\Sigma}}_1|}\\right) - \\frac{1}{2}\\left(D_1^2(\\mathbf{x}) - D_2^2(\\mathbf{x})\\right)\n$$\n待分类的像素是 $\\mathbf{x}=(0.052, 0.031, 0.022)^T$。\n\n首先，计算行列式的比值：\n$|\\hat{\\boldsymbol{\\Sigma}}_1| = (\\frac{1}{35000})^3$\n$|\\hat{\\boldsymbol{\\Sigma}}_2| = (\\frac{4}{35000})(\\frac{9}{35000})(\\frac{25}{35000}) = \\frac{900}{35000^3}$\n$\\frac{|\\hat{\\boldsymbol{\\Sigma}}_2|}{|\\hat{\\boldsymbol{\\Sigma}}_1|} = 900$。所以，第一项是 $\\frac{1}{2}\\ln(900) = \\ln(\\sqrt{900}) = \\ln(30)$。\n\n接下来，计算马氏距离的平方。由于协方差矩阵是对角的，$D_i^2(\\mathbf{x}) = \\sum_{j=1}^{3} \\frac{(x_j - \\hat{\\mu}_{i,j})^2}{\\hat{\\sigma}_{i,j}^2}$。\n\n对于水体（$\\omega_1$）：\n$\\mathbf{x} - \\hat{\\boldsymbol{\\mu}}_1 = (0.052 - 0.05, 0.031 - 0.03, 0.022 - 0.02)^T = (0.002, 0.001, 0.002)^T$。\n方差是常数 $\\hat{\\sigma}_{1,j}^2 = 1/35000$。\n$$ D_1^2(\\mathbf{x}) = \\frac{(0.002)^2}{1/35000} + \\frac{(0.001)^2}{1/35000} + \\frac{(0.002)^2}{1/35000} = 35000 \\times (0.000004 + 0.000001 + 0.000004) = 35000 \\times 9 \\times 10^{-6} = 0.315 $$\n\n对于植被（$\\omega_2$）：\n$\\mathbf{x} - \\hat{\\boldsymbol{\\mu}}_2 = (0.052 - 0.06, 0.031 - 0.08, 0.022 - 0.45)^T = (-0.008, -0.049, -0.428)^T$。\n方差为 $\\hat{\\sigma}_{2,1}^2=4/35000$, $\\hat{\\sigma}_{2,2}^2=9/35000$, $\\hat{\\sigma}_{2,3}^2=25/35000$。\n$$ D_2^2(\\mathbf{x}) = \\frac{(-0.008)^2}{4/35000} + \\frac{(-0.049)^2}{9/35000} + \\frac{(-0.428)^2}{25/35000} $$\n$$ D_2^2(\\mathbf{x}) = \\frac{0.000064 \\times 35000}{4} + \\frac{0.002401 \\times 35000}{9} + \\frac{0.183184 \\times 35000}{25} $$\n$$ D_2^2(\\mathbf{x}) = 0.56 + \\frac{84.035}{9} + \\frac{6411.44}{25} = 0.56 + 9.33722... + 256.4576 = 266.35482... $$\n现在，组合成对数似然比：\n$$ \\Lambda(\\mathbf{x}) = \\ln(30) - \\frac{1}{2}(0.315 - 266.35482...) = \\ln(30) - \\frac{1}{2}(-266.03982...) $$\n$$ \\Lambda(\\mathbf{x}) = \\ln(30) + 133.01991... \\approx 3.401197 + 133.019911 = 136.421108... $$\n四舍五入到四位有效数字，我们得到 $136.4$。",
            "answer": "$$\\boxed{136.4}$$"
        },
        {
            "introduction": "在上一个练习的基础上，本练习旨在探索决策规则的数学结构。你将从贝叶斯决策理论的第一性原理出发推导判别函数，并观察关于类别协方差的假设（无论它们是相等还是不同）如何决定决策边界的几何形状，从而产生线性或二次分类器。这个练习将概率计算与几何解释联系起来，帮助你深入理解不同分类器模型之间的关系 。",
            "id": "3826536",
            "problem": "针对一个双波段（红光和近红外）的多光谱遥感场景，提出了一个两类最大似然分类（MLC）问题。考虑特征向量 $x = (x_{\\mathrm{R}}, x_{\\mathrm{NIR}})^{\\top}$，它表示红光和近红外波段的大气层顶反射率（无量纲分数）。假设新生植被（类 $\\mathcal{V}$）和清澈水体（类 $\\mathcal{W}$）的类条件分布被建模为多元高斯（正态）分布，其参数由训练数据估计得出：\n$$\n\\mu_{\\mathcal{V}} = \\begin{pmatrix} 0.08 \\\\ 0.45 \\end{pmatrix}, \\quad \\Sigma_{\\mathcal{V}} = \\begin{pmatrix} 0.0025  0 \\\\ 0  0.0121 \\end{pmatrix},\n$$\n$$\n\\mu_{\\mathcal{W}} = \\begin{pmatrix} 0.05 \\\\ 0.06 \\end{pmatrix}, \\quad \\Sigma_{\\mathcal{W}} = \\begin{pmatrix} 0.0016  0 \\\\ 0  0.0025 \\end{pmatrix},\n$$\n以及先验概率\n$$\nP(\\mathcal{V}) = 0.55, \\quad P(\\mathcal{W}) = 0.45.\n$$\n假设波段间的独立性是一个合理的近似，因此给出的协方差矩阵是对角阵。观测到一个反射率为 $x_{0} = (0.07, 0.40)^{\\top}$ 的像素。\n\n仅从最小错误率分类的贝叶斯决策规则和多元高斯概率密度函数出发，推导一般异方差情况（即特定于类的协方差矩阵）下对数判别函数的差 $\\Delta(x) = g_{\\mathcal{V}}(x) - g_{\\mathcal{W}}(x)$，并明确写出所有依赖于 $x$、均值、协方差矩阵和先验概率的项。然后，在同方差假设（即类间协方差相等）下，使用公共协方差\n$$\n\\Sigma = \\begin{pmatrix} 0.0020  0 \\\\ 0  0.0040 \\end{pmatrix},\n$$\n证明判别函数差可简化为关于 $x$ 的线性函数，并用 $\\mu_{\\mathcal{V}}$、$\\mu_{\\mathcal{W}}$、$\\Sigma$ 和先验概率来确定权重向量和偏置。\n\n最后，使用上面为 $\\Sigma_{\\mathcal{V}}$ 和 $\\Sigma_{\\mathcal{W}}$ 提供的参数，对异方差判别函数差 $\\Delta(x_{0})$ 进行数值计算。将 $\\Delta(x_{0})$ 的最终值表示为一个四舍五入到四位有效数字的单个实数。答案是无单位的。",
            "solution": "这个问题是有效的，因为它在科学上基于统计模式识别和贝叶斯决策理论，提法恰当，提供了所有必要的数据，并且其表述是客观的。我们可以开始解题。\n\n该问题要求完成三个任务：第一，推导一般异方差情况下对数判别函数的差 $\\Delta(x) = g_{\\mathcal{V}}(x) - g_{\\mathcal{W}}(x)$；第二，证明在同方差情况下该差值简化为一个线性函数，并确定其组成项；第三，对特定观测值 $x_{0}$ 进行 $\\Delta(x_{0})$ 的数值计算。\n\n**第一部分：异方差判别函数差的推导**\n\n最小分类错误率的贝叶斯决策规则是将一个特征向量 $x$ 分配给具有最大后验概率 $P(\\omega_i | x)$ 的类别 $\\omega_i$。根据贝叶斯定理，该后验概率由下式给出：\n$$\nP(\\omega_i | x) = \\frac{p(x | \\omega_i) P(\\omega_i)}{p(x)}\n$$\n其中 $p(x | \\omega_i)$ 是类条件概率密度函数，$P(\\omega_i)$ 是类别 $\\omega_i$ 的先验概率，而 $p(x)$ 是证据。由于 $p(x)$ 对所有类别都是相同的，因此最大化后验概率等价于最大化乘积 $p(x | \\omega_i) P(\\omega_i)$。\n\n为了计算方便，我们使用该乘积的对数，因为对数是单调递增函数。这就定义了判别函数 $g_i(x)$：\n$$\ng_i(x) = \\ln\\left(p(x | \\omega_i) P(\\omega_i)\\right) = \\ln(p(x | \\omega_i)) + \\ln(P(\\omega_i))\n$$\n问题陈述，类条件密度是多元高斯分布。对于一个维度为 $d$ 的特征向量 $x$，类别 $\\omega_i$ 的概率密度函数为：\n$$\np(x | \\omega_i) = \\frac{1}{(2\\pi)^{d/2} |\\Sigma_i|^{1/2}} \\exp\\left(-\\frac{1}{2} (x - \\mu_i)^{\\top} \\Sigma_i^{-1} (x - \\mu_i)\\right)\n$$\n将此代入判别函数表达式，我们得到：\n$$\ng_i(x) = \\ln\\left(\\frac{1}{(2\\pi)^{d/2} |\\Sigma_i|^{1/2}}\\right) - \\frac{1}{2} (x - \\mu_i)^{\\top} \\Sigma_i^{-1} (x - \\mu_i) + \\ln(P(\\omega_i))\n$$\n$$\ng_i(x) = -\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(|\\Sigma_i|) - \\frac{1}{2}(x - \\mu_i)^{\\top} \\Sigma_i^{-1} (x - \\mu_i) + \\ln(P(\\omega_i))\n$$\n我们需要求出类别 $\\mathcal{V}$（植被）和类别 $\\mathcal{W}$（水体）的判别函数之差，记为 $\\Delta(x) = g_{\\mathcal{V}}(x) - g_{\\mathcal{W}}(x)$。\n$$\ng_{\\mathcal{V}}(x) = -\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(|\\Sigma_{\\mathcal{V}}|) - \\frac{1}{2}(x - \\mu_{\\mathcal{V}})^{\\top} \\Sigma_{\\mathcal{V}}^{-1} (x - \\mu_{\\mathcal{V}}) + \\ln(P(\\mathcal{V}))\n$$\n$$\ng_{\\mathcal{W}}(x) = -\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(|\\Sigma_{\\mathcal{W}}|) - \\frac{1}{2}(x - \\mu_{\\mathcal{W}})^{\\top} \\Sigma_{\\mathcal{W}}^{-1} (x - \\mu_{\\mathcal{W}}) + \\ln(P(\\mathcal{W}))\n$$\n从 $g_{\\mathcal{V}}(x)$ 中减去 $g_{\\mathcal{W}}(x)$，公共项 $-\\frac{d}{2}\\ln(2\\pi)$ 被消掉：\n$$\n\\Delta(x) = \\left( - \\frac{1}{2}\\ln(|\\Sigma_{\\mathcal{V}}|) - \\frac{1}{2}(x - \\mu_{\\mathcal{V}})^{\\top} \\Sigma_{\\mathcal{V}}^{-1} (x - \\mu_{\\mathcal{V}}) + \\ln(P(\\mathcal{V})) \\right) - \\left( - \\frac{1}{2}\\ln(|\\Sigma_{\\mathcal{W}}|) - \\frac{1}{2}(x - \\mu_{\\mathcal{W}})^{\\top} \\Sigma_{\\mathcal{W}}^{-1} (x - \\mu_{\\mathcal{W}}) + \\ln(P(\\mathcal{W})) \\right)\n$$\n整理各项，我们得到了一般的异方差判别函数差：\n$$\n\\Delta(x) = \\frac{1}{2}\\left[ (x - \\mu_{\\mathcal{W}})^{\\top} \\Sigma_{\\mathcal{W}}^{-1} (x - \\mu_{\\mathcal{W}}) - (x - \\mu_{\\mathcal{V}})^{\\top} \\Sigma_{\\mathcal{V}}^{-1} (x - \\mu_{\\mathcal{V}}) \\right] + \\frac{1}{2}\\ln\\left(\\frac{|\\Sigma_{\\mathcal{W}}|}{|\\Sigma_{\\mathcal{V}}|}\\right) + \\ln\\left(\\frac{P(\\mathcal{V})}{P(\\mathcal{W})}\\right)\n$$\n该表达式包含一个关于 $x$ 的二次项（因为 $\\Sigma_{\\mathcal{V}} \\neq \\Sigma_{\\mathcal{W}}$），以及依赖于均值、协方差矩阵和先验概率的项。\n\n**第二部分：简化为线性情况（同方差假设）**\n\n在同方差假设下，所有类别的协方差矩阵都相等，即 $\\Sigma_{\\mathcal{V}} = \\Sigma_{\\mathcal{W}} = \\Sigma$。我们来分析这对 $\\Delta(x)$ 的影响。\n对数行列式项变为：\n$$\n\\frac{1}{2}\\ln\\left(\\frac{|\\Sigma|}{|\\Sigma|}\\right) = \\frac{1}{2}\\ln(1) = 0\n$$\n为了看二次项如何简化，我们将其展开：\n$$\n(x - \\mu)^{\\top}\\Sigma^{-1}(x - \\mu) = x^{\\top}\\Sigma^{-1}x - 2\\mu^{\\top}\\Sigma^{-1}x + \\mu^{\\top}\\Sigma^{-1}\\mu\n$$\n将此代入 $\\Delta(x)$ 的第一部分，并设 $\\Sigma_{\\mathcal{V}}^{-1} = \\Sigma_{\\mathcal{W}}^{-1} = \\Sigma^{-1}$：\n$$\n\\frac{1}{2}\\left[ (x^{\\top}\\Sigma^{-1}x - 2\\mu_{\\mathcal{W}}^{\\top}\\Sigma^{-1}x + \\mu_{\\mathcal{W}}^{\\top}\\Sigma^{-1}\\mu_{\\mathcal{W}}) - (x^{\\top}\\Sigma^{-1}x - 2\\mu_{\\mathcal{V}}^{\\top}\\Sigma^{-1}x + \\mu_{\\mathcal{V}}^{\\top}\\Sigma^{-1}\\mu_{\\mathcal{V}}) \\right]\n$$\n关于 $x$ 的二次项 $x^{\\top}\\Sigma^{-1}x$ 被消去。表达式简化为：\n$$\n\\frac{1}{2}\\left[ 2\\mu_{\\mathcal{V}}^{\\top}\\Sigma^{-1}x - 2\\mu_{\\mathcal{W}}^{\\top}\\Sigma^{-1}x + \\mu_{\\mathcal{W}}^{\\top}\\Sigma^{-1}\\mu_{\\mathcal{W}} - \\mu_{\\mathcal{V}}^{\\top}\\Sigma^{-1}\\mu_{\\mathcal{V}} \\right] = (\\mu_{\\mathcal{V}} - \\mu_{\\mathcal{W}})^{\\top}\\Sigma^{-1}x - \\frac{1}{2}(\\mu_{\\mathcal{V}}^{\\top}\\Sigma^{-1}\\mu_{\\mathcal{V}} - \\mu_{\\mathcal{W}}^{\\top}\\Sigma^{-1}\\mu_{\\mathcal{W}})\n$$\n将此与先验概率项结合，判别函数差简化为关于 $x$ 的一个线性函数：\n$$\n\\Delta(x) = (\\mu_{\\mathcal{V}} - \\mu_{\\mathcal{W}})^{\\top}\\Sigma^{-1}x - \\frac{1}{2}\\mu_{\\mathcal{V}}^{\\top}\\Sigma^{-1}\\mu_{\\mathcal{V}} + \\frac{1}{2}\\mu_{\\mathcal{W}}^{\\top}\\Sigma^{-1}\\mu_{\\mathcal{W}} + \\ln\\left(\\frac{P(\\mathcal{V})}{P(\\mathcal{W})}\\right)\n$$\n这是一个形式为 $\\Delta(x) = w^{\\top}x + b$ 的线性函数，其中：\n权重向量为 $w = \\Sigma^{-1}(\\mu_{\\mathcal{V}} - \\mu_{\\mathcal{W}})$。\n偏置项为 $b = -\\frac{1}{2}\\mu_{\\mathcal{V}}^{\\top}\\Sigma^{-1}\\mu_{\\mathcal{V}} + \\frac{1}{2}\\mu_{\\mathcal{W}}^{\\top}\\Sigma^{-1}\\mu_{\\mathcal{W}} + \\ln\\left(\\frac{P(\\mathcal{V})}{P(\\mathcal{W})}\\right)$。\n\n**第三部分：$\\Delta(x_0)$ 的数值计算**\n\n我们现在使用异方差公式和给定的参数来计算像素 $x_0 = (0.07, 0.40)^{\\top}$ 的 $\\Delta(x_0)$ 值。\n参数如下：\n$$\nx_0 = \\begin{pmatrix} 0.07 \\\\ 0.40 \\end{pmatrix}, \\quad \\mu_{\\mathcal{V}} = \\begin{pmatrix} 0.08 \\\\ 0.45 \\end{pmatrix}, \\quad \\mu_{\\mathcal{W}} = \\begin{pmatrix} 0.05 \\\\ 0.06 \\end{pmatrix}\n$$\n$$\n\\Sigma_{\\mathcal{V}} = \\begin{pmatrix} 0.0025  0 \\\\ 0  0.0121 \\end{pmatrix}, \\quad \\Sigma_{\\mathcal{W}} = \\begin{pmatrix} 0.0016  0 \\\\ 0  0.0025 \\end{pmatrix}\n$$\n$$\nP(\\mathcal{V}) = 0.55, \\quad P(\\mathcal{W}) = 0.45\n$$\n首先，我们计算协方差矩阵的逆矩阵和行列式。由于它们是对角矩阵，这个计算很简单。\n$$\n\\Sigma_{\\mathcal{V}}^{-1} = \\begin{pmatrix} \\frac{1}{0.0025}  0 \\\\ 0  \\frac{1}{0.0121} \\end{pmatrix} = \\begin{pmatrix} 400  0 \\\\ 0  \\frac{10000}{121} \\end{pmatrix}\n$$\n$$\n|\\Sigma_{\\mathcal{V}}| = 0.0025 \\times 0.0121 = 0.00003025\n$$\n$$\n\\Sigma_{\\mathcal{W}}^{-1} = \\begin{pmatrix} \\frac{1}{0.0016}  0 \\\\ 0  \\frac{1}{0.0025} \\end{pmatrix} = \\begin{pmatrix} 625  0 \\\\ 0  400 \\end{pmatrix}\n$$\n$$\n|\\Sigma_{\\mathcal{W}}| = 0.0016 \\times 0.0025 = 0.000004\n$$\n接下来，我们计算马氏距离平方项，也就是二次型 $(x-\\mu)^{\\top}\\Sigma^{-1}(x-\\mu)$：\n$$\nx_0 - \\mu_{\\mathcal{V}} = \\begin{pmatrix} 0.07 - 0.08 \\\\ 0.40 - 0.45 \\end{pmatrix} = \\begin{pmatrix} -0.01 \\\\ -0.05 \\end{pmatrix}\n$$\n$$\n(x_0 - \\mu_{\\mathcal{V}})^{\\top}\\Sigma_{\\mathcal{V}}^{-1}(x_0 - \\mu_{\\mathcal{V}}) = 400(-0.01)^2 + \\frac{10000}{121}(-0.05)^2 = 400(0.0001) + \\frac{10000}{121}(0.0025) = 0.04 + \\frac{25}{121} \\approx 0.24661\n$$\n$$\nx_0 - \\mu_{\\mathcal{W}} = \\begin{pmatrix} 0.07 - 0.05 \\\\ 0.40 - 0.06 \\end{pmatrix} = \\begin{pmatrix} 0.02 \\\\ 0.34 \\end{pmatrix}\n$$\n$$\n(x_0 - \\mu_{\\mathcal{W}})^{\\top}\\Sigma_{\\mathcal{W}}^{-1}(x_0 - \\mu_{\\mathcal{W}}) = 625(0.02)^2 + 400(0.34)^2 = 625(0.0004) + 400(0.1156) = 0.25 + 46.24 = 46.49\n$$\n现在，我们计算对数项：\n$$\n\\frac{1}{2}\\ln\\left(\\frac{|\\Sigma_{\\mathcal{W}}|}{|\\Sigma_{\\mathcal{V}}|}\\right) = \\frac{1}{2}\\ln\\left(\\frac{0.000004}{0.00003025}\\right) = \\frac{1}{2}\\ln\\left(\\frac{16}{121}\\right) = \\ln\\left(\\frac{4}{11}\\right) \\approx -1.01160\n$$\n$$\n\\ln\\left(\\frac{P(\\mathcal{V})}{P(\\mathcal{W})}\\right) = \\ln\\left(\\frac{0.55}{0.45}\\right) = \\ln\\left(\\frac{11}{9}\\right) \\approx 0.20067\n$$\n最后，我们组合各个部分来计算 $\\Delta(x_0)$：\n$$\n\\Delta(x_0) = \\frac{1}{2}\\left[ 46.49 - \\left(0.04 + \\frac{25}{121}\\right) \\right] + \\ln\\left(\\frac{4}{11}\\right) + \\ln\\left(\\frac{11}{9}\\right)\n$$\n$$\n\\Delta(x_0) \\approx \\frac{1}{2}[46.49 - 0.24661] - 1.01160 + 0.20067\n$$\n$$\n\\Delta(x_0) \\approx \\frac{1}{2}[46.24339] - 1.01160 + 0.20067\n$$\n$$\n\\Delta(x_0) \\approx 23.12170 - 1.01160 + 0.20067 = 22.31077\n$$\n将结果四舍五入到四位有效数字，得到 $22.31$。\n$\\Delta(x_0)$ 的值是一个很大的正数，这表明类别 $\\mathcal{V}$（植被）的后验概率远高于类别 $\\mathcal{W}$（水体），因此该像素将被分类为植被。",
            "answer": "$$\\boxed{22.31}$$"
        },
        {
            "introduction": "最后一个练习展示了最大似然框架在处理更复杂、更真实场景时的灵活性和强大功能。在这里，你将通过构建一个模型来解决遥感中常见的“混合像元”问题，其中像元信号被建模为不同土地覆盖类型的线性组合。这需要使用广义似然比，你必须先找出最可能的混合比例，然后才能比较不同假设，这展示了最大似然原理如何巧妙地扩展到分类任务中的参数估计问题 。",
            "id": "3826529",
            "problem": "一个多光谱传感器测量了一个地表像元在 $2$ 个波段的双向反射因子。该场景包含两种端元，植被和土壤，其已知的平均反射率向量分别为 $\\boldsymbol{\\mu}_{V} = \\begin{pmatrix} 0.42 \\\\ 0.30 \\end{pmatrix}$ 和 $\\boldsymbol{\\mu}_{S} = \\begin{pmatrix} 0.12 \\\\ 0.18 \\end{pmatrix}$。仪器和大气残差被建模为零均值高斯噪声，其协方差矩阵已知为 $\\boldsymbol{\\Sigma} = \\begin{pmatrix} 0.0025  0.0010 \\\\ 0.0010  0.0040 \\end{pmatrix}$。单个像元的观测值为 $\\boldsymbol{x} = \\begin{pmatrix} 0.28 \\\\ 0.24 \\end{pmatrix}$。\n\n考虑在以下两个假设之间进行最大似然（ML）分类：\n- $H_{V}$ (纯植被): $\\boldsymbol{x} = \\boldsymbol{\\mu}_{V} + \\boldsymbol{\\varepsilon}$，\n- $H_{M}$ (混合像元): $\\boldsymbol{x} = f \\boldsymbol{\\mu}_{V} + (1 - f)\\boldsymbol{\\mu}_{S} + \\boldsymbol{\\varepsilon}$，\n\n其中 $f \\in [0,1]$ 是一个未知的亚像元混合分数，$\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\boldsymbol{0}, \\boldsymbol{\\Sigma})$ 是一个协方差为 $\\boldsymbol{\\Sigma}$ 的零均值高斯向量。假设类别先验概率相等，并且在两个假设下 $\\boldsymbol{\\Sigma}$ 是相同的。\n\n仅从多元高斯概率密度函数的定义和最大似然原理出发，通过在 $H_{M}$ 内对 $f \\in [0,1]$ 最大化似然函数，推导比较 $H_{M}$ 与 $H_{V}$ 的广义似然比 $\\Lambda(\\boldsymbol{x})$ 的自然对数。然后，根据给定的 $\\boldsymbol{\\mu}_{V}$、$\\boldsymbol{\\mu}_{S}$、$\\boldsymbol{\\Sigma}$ 和 $\\boldsymbol{x}$，对您推导的表达式进行数值计算，并以单一闭式解析表达式的形式给出 $\\ln \\Lambda(\\boldsymbol{x})$。不要进行数值近似。",
            "solution": "问题要求推导和评估用于区分两个假设 $H_V$ 和 $H_M$ 的广义似然比的自然对数 $\\ln \\Lambda(\\boldsymbol{x})$。\n\n对于 $d$ 维多元高斯分布 $\\mathcal{N}(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$，观测向量 $\\boldsymbol{x}$ 的似然函数由概率密度函数（PDF）给出：\n$$L(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma} | \\boldsymbol{x}) = p(\\boldsymbol{x}|\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma}) = \\frac{1}{(2\\pi)^{d/2} |\\boldsymbol{\\Sigma}|^{1/2}} \\exp\\left(-\\frac{1}{2}(\\boldsymbol{x} - \\boldsymbol{\\mu})^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{x} - \\boldsymbol{\\mu})\\right)$$\n相应的对数似然函数为：\n$$\\ln L = -\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\boldsymbol{\\Sigma}| - \\frac{1}{2}(\\boldsymbol{x} - \\boldsymbol{\\mu})^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{x} - \\boldsymbol{\\mu})$$\n\n对于假设 $H_V$ (纯植被)，模型为 $\\boldsymbol{x} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_V, \\boldsymbol{\\Sigma})$。由于所有参数都已知，似然函数 $L_V$ 是固定的。其对数似然函数为：\n$$\\ln L_V = -\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\boldsymbol{\\Sigma}| - \\frac{1}{2}(\\boldsymbol{x} - \\boldsymbol{\\mu}_V)^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{x} - \\boldsymbol{\\mu}_V)$$\n\n对于假设 $H_M$ (混合像元)，模型为 $\\boldsymbol{x} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_M(f), \\boldsymbol{\\Sigma})$，其中均值向量 $\\boldsymbol{\\mu}_M(f) = f \\boldsymbol{\\mu}_V + (1-f) \\boldsymbol{\\mu}_S$ 取决于未知的混合分数 $f \\in [0,1]$。\n$H_M$ 下的对数似然函数是 $f$ 的函数：\n$$\\ln L_M(f) = -\\frac{d}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\boldsymbol{\\Sigma}| - \\frac{1}{2}(\\boldsymbol{x} - \\boldsymbol{\\mu}_M(f))^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{x} - \\boldsymbol{\\mu}_M(f))$$\n\n$H_M$ 的广义似然函数通过对 $f$ 最大化 $L_M(f)$ 来找到。这等价于最大化 $\\ln L_M(f)$，而这又等价于最小化指数中的二次型，我们将其表示为 $J(f)$：\n$$J(f) = (\\boldsymbol{x} - \\boldsymbol{\\mu}_M(f))^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{x} - \\boldsymbol{\\mu}_M(f))$$\n我们寻求 $\\hat{f} = \\arg\\min_{f \\in [0,1]} J(f)$。\n\n让我们展开 $J(f)$。令 $\\boldsymbol{\\delta} = \\boldsymbol{\\mu}_V - \\boldsymbol{\\mu}_S$ 且 $\\boldsymbol{r} = \\boldsymbol{x} - \\boldsymbol{\\mu}_S$。那么 $\\boldsymbol{\\mu}_M(f) = \\boldsymbol{\\mu}_S + f\\boldsymbol{\\delta}$，并且 $\\boldsymbol{x} - \\boldsymbol{\\mu}_M(f) = \\boldsymbol{r} - f\\boldsymbol{\\delta}$。\n$$J(f) = (\\boldsymbol{r} - f\\boldsymbol{\\delta})^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{r} - f\\boldsymbol{\\delta}) = \\boldsymbol{r}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r} - 2f \\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r} + f^2 \\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\delta}$$\n为了找到无约束最小值，我们对 $f$ 求导并令结果为零：\n$$\\frac{dJ}{df} = -2\\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r} + 2f \\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\delta} = 0$$\n这得出了 $f$ 的无约束最大似然估计：\n$$f_{unc} = \\frac{\\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r}}{\\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\delta}} = \\frac{(\\boldsymbol{\\mu}_V - \\boldsymbol{\\mu}_S)^T\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{x} - \\boldsymbol{\\mu}_S)}{(\\boldsymbol{\\mu}_V - \\boldsymbol{\\mu}_S)^T\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_V - \\boldsymbol{\\mu}_S)}$$\n约束估计 $\\hat{f}$ 是通过将 $f_{unc}$ 截断到区间 $[0,1]$ 内得到的：\n$$\\hat{f} = \\max(0, \\min(1, f_{unc}))$$\n那么 $H_M$ 的最大化对数似然函数为 $\\ln L_M^* = \\ln L_M(\\hat{f})$。\n\n广义似然比 $\\Lambda(\\boldsymbol{x})$ 定义为 $\\frac{L_M^*}{L_V}$。其自然对数为：\n$$\\ln \\Lambda(\\boldsymbol{x}) = \\ln L_M^* - \\ln L_V = \\ln L_M(\\hat{f}) - \\ln L_V$$\n代入对数似然函数的表达式，常数项消掉了：\n$$\\ln \\Lambda(\\boldsymbol{x}) = \\frac{1}{2} \\left[ (\\boldsymbol{x} - \\boldsymbol{\\mu}_V)^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{x} - \\boldsymbol{\\mu}_V) - (\\boldsymbol{x} - \\boldsymbol{\\mu}_M(\\hat{f}))^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{x} - \\boldsymbol{\\mu}_M(\\hat{f})) \\right]$$\n这就是推导出的表达式。现在我们对其进行数值计算。\n\n给定数据：\n$\\boldsymbol{\\mu}_{V} = \\begin{pmatrix} 0.42 \\\\ 0.30 \\end{pmatrix}$, $\\boldsymbol{\\mu}_{S} = \\begin{pmatrix} 0.12 \\\\ 0.18 \\end{pmatrix}$, $\\boldsymbol{x} = \\begin{pmatrix} 0.28 \\\\ 0.24 \\end{pmatrix}$, $\\boldsymbol{\\Sigma} = \\begin{pmatrix} 0.0025  0.0010 \\\\ 0.0010  0.0040 \\end{pmatrix}$。\n\n首先，计算协方差矩阵的逆矩阵 $\\boldsymbol{\\Sigma}^{-1}$：\n$|\\boldsymbol{\\Sigma}| = (0.0025)(0.0040) - (0.0010)^2 = 0.000010 - 0.000001 = 0.000009 = 9 \\times 10^{-6}$。\n$$\\boldsymbol{\\Sigma}^{-1} = \\frac{1}{0.000009} \\begin{pmatrix} 0.0040  -0.0010 \\\\ -0.0010  0.0025 \\end{pmatrix} = \\frac{10^6}{9} \\begin{pmatrix} 0.0040  -0.0010 \\\\ -0.0010  0.0025 \\end{pmatrix} = \\frac{1000}{9} \\begin{pmatrix} 4  -1 \\\\ -1  2.5 \\end{pmatrix}$$\n\n接下来，计算用于 $f_{unc}$ 的向量：\n$\\boldsymbol{\\delta} = \\boldsymbol{\\mu}_V - \\boldsymbol{\\mu}_S = \\begin{pmatrix} 0.42 - 0.12 \\\\ 0.30 - 0.18 \\end{pmatrix} = \\begin{pmatrix} 0.30 \\\\ 0.12 \\end{pmatrix}$。\n$\\boldsymbol{r} = \\boldsymbol{x} - \\boldsymbol{\\mu}_S = \\begin{pmatrix} 0.28 - 0.12 \\\\ 0.24 - 0.18 \\end{pmatrix} = \\begin{pmatrix} 0.16 \\\\ 0.06 \\end{pmatrix}$。\n\n现在，计算 $f_{unc}$ 的各项：\n分母：$\\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\delta}$\n$\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\delta} = \\frac{1000}{9} \\begin{pmatrix} 4  -1 \\\\ -1  2.5 \\end{pmatrix} \\begin{pmatrix} 0.30 \\\\ 0.12 \\end{pmatrix} = \\frac{1000}{9} \\begin{pmatrix} 4(0.30) - 1(0.12) \\\\ -1(0.30) + 2.5(0.12) \\end{pmatrix} = \\frac{1000}{9} \\begin{pmatrix} 1.20 - 0.12 \\\\ -0.30 + 0.30 \\end{pmatrix} = \\frac{1000}{9} \\begin{pmatrix} 1.08 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 120 \\\\ 0 \\end{pmatrix}$。\n$\\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\delta} = \\begin{pmatrix} 0.30  0.12 \\end{pmatrix} \\begin{pmatrix} 120 \\\\ 0 \\end{pmatrix} = (0.30)(120) = 36$。\n\n分子：$\\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r}$\n$\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r} = \\frac{1000}{9} \\begin{pmatrix} 4  -1 \\\\ -1  2.5 \\end{pmatrix} \\begin{pmatrix} 0.16 \\\\ 0.06 \\end{pmatrix} = \\frac{1000}{9} \\begin{pmatrix} 4(0.16) - 1(0.06) \\\\ -1(0.16) + 2.5(0.06) \\end{pmatrix} = \\frac{1000}{9} \\begin{pmatrix} 0.64 - 0.06 \\\\ -0.16 + 0.15 \\end{pmatrix} = \\frac{1000}{9} \\begin{pmatrix} 0.58 \\\\ -0.01 \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 580 \\\\ -10 \\end{pmatrix}$。\n$\\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r} = \\begin{pmatrix} 0.30  0.12 \\end{pmatrix} \\frac{1}{9} \\begin{pmatrix} 580 \\\\ -10 \\end{pmatrix} = \\frac{1}{9} (0.30 \\times 580 + 0.12 \\times (-10)) = \\frac{1}{9} (174 - 1.2) = \\frac{172.8}{9} = 19.2$。\n\n计算 $f_{unc}$：\n$f_{unc} = \\frac{19.2}{36} = \\frac{192}{360} = \\frac{192/24}{360/24} = \\frac{8}{15}$。\n由于 $0 \\le \\frac{8}{15} \\le 1$，约束估计为 $\\hat{f} = f_{unc} = \\frac{8}{15}$。\n\n现在，为 $\\ln \\Lambda(\\boldsymbol{x})$ 计算两个马氏距离项。\n第 1 项：$(\\boldsymbol{x} - \\boldsymbol{\\mu}_V)^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{x} - \\boldsymbol{\\mu}_V)$。\n$\\boldsymbol{x} - \\boldsymbol{\\mu}_V = \\begin{pmatrix} 0.28 - 0.42 \\\\ 0.24 - 0.30 \\end{pmatrix} = \\begin{pmatrix} -0.14 \\\\ -0.06 \\end{pmatrix}$。\n$\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{x} - \\boldsymbol{\\mu}_V) = \\frac{1000}{9} \\begin{pmatrix} 4  -1 \\\\ -1  2.5 \\end{pmatrix} \\begin{pmatrix} -0.14 \\\\ -0.06 \\end{pmatrix} = \\frac{1000}{9} \\begin{pmatrix} -0.56 + 0.06 \\\\ 0.14 - 0.15 \\end{pmatrix} = \\frac{1000}{9} \\begin{pmatrix} -0.50 \\\\ -0.01 \\end{pmatrix} = \\frac{1}{9}\\begin{pmatrix} -500 \\\\ -10 \\end{pmatrix}$。\n$(\\boldsymbol{x} - \\boldsymbol{\\mu}_V)^T[\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{x} - \\boldsymbol{\\mu}_V)] = \\begin{pmatrix} -0.14  -0.06 \\end{pmatrix}\\frac{1}{9}\\begin{pmatrix} -500 \\\\ -10 \\end{pmatrix} = \\frac{1}{9}((-0.14)(-500) + (-0.06)(-10)) = \\frac{1}{9}(70 + 0.6) = \\frac{70.6}{9}$。\n\n第 2 项：$(\\boldsymbol{x} - \\boldsymbol{\\mu}_M(\\hat{f}))^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{x} - \\boldsymbol{\\mu}_M(\\hat{f})) = J(\\hat{f})$。\n这是 $J(f)$ 的最小值，可以使用公式 $J(f_{unc}) = \\boldsymbol{r}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r} - \\frac{(\\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r})^2}{\\boldsymbol{\\delta}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\delta}}$ 计算。\n首先，我们需要计算 $\\boldsymbol{r}^T\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r}$：\n$\\boldsymbol{r}^T[\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{r}] = \\begin{pmatrix} 0.16  0.06 \\end{pmatrix} \\frac{1}{9} \\begin{pmatrix} 580 \\\\ -10 \\end{pmatrix} = \\frac{1}{9}(0.16 \\times 580 - 0.06 \\times 10) = \\frac{1}{9}(92.8 - 0.6) = \\frac{92.2}{9}$。\n$J(\\hat{f}) = \\frac{92.2}{9} - \\frac{(19.2)^2}{36} = \\frac{92.2}{9} - \\frac{368.64}{36} = \\frac{4 \\times 92.2}{36} - \\frac{368.64}{36} = \\frac{368.8 - 368.64}{36} = \\frac{0.16}{36} = \\frac{16}{3600} = \\frac{1}{225}$。\n\n最后，组合得到 $\\ln \\Lambda(\\boldsymbol{x})$：\n$$\\ln \\Lambda(\\boldsymbol{x}) = \\frac{1}{2}\\left( \\frac{70.6}{9} - \\frac{1}{225} \\right)$$\n为了合并这些项，我们找到一个公分母。$9$ 和 $225$ 的最小公倍数是 $225$。\n$$\\ln \\Lambda(\\boldsymbol{x}) = \\frac{1}{2}\\left( \\frac{70.6 \\times 25}{9 \\times 25} - \\frac{1}{225} \\right) = \\frac{1}{2}\\left( \\frac{1765}{225} - \\frac{1}{225} \\right) = \\frac{1}{2}\\left( \\frac{1764}{225} \\right) = \\frac{882}{225}$$\n这个分数可以通过将分子和分母除以它们的最大公约数 $9$ 来化简。\n$882 \\div 9 = 98$。\n$225 \\div 9 = 25$。\n$$\\ln \\Lambda(\\boldsymbol{x}) = \\frac{98}{25}$$",
            "answer": "$$\n\\boxed{\\frac{98}{25}}\n$$"
        }
    ]
}