{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of aerosol remote sensing is the analysis of multi-wavelength data to infer particle properties. This exercise demonstrates how to extract the Angström exponent $\\alpha$, a key indicator of aerosol particle size, from a set of Aerosol Optical Depth (AOD) measurements . By linearizing the Angström power law and applying a weighted least-squares fit, you will practice fundamental techniques for robust parameter estimation and uncertainty quantification that are vital for handling experimental data.",
            "id": "3795318",
            "problem": "Aerosol Optical Depth (AOD) is a spectrally dependent quantity often parameterized by the Angström power law. Consider clear-sky column measurements from a calibrated Sun photometer that have been corrected for Rayleigh scattering and gaseous absorption, including water vapor, leaving residual aerosol AOD. At wavelengths $\\lambda$ in micrometers, the measured AOD values $\\tau$ and their one-standard-deviation uncertainties $\\sigma_{\\tau}$ are:\n- $\\lambda = 0.440$, $\\tau = 0.35$, $\\sigma_{\\tau} = 0.01$;\n- $\\lambda = 0.675$, $\\tau = 0.22$, $\\sigma_{\\tau} = 0.01$;\n- $\\lambda = 0.870$, $\\tau = 0.16$, $\\sigma_{\\tau} = 0.01$;\n- $\\lambda = 1.020$, $\\tau = 0.13$, $\\sigma_{\\tau} = 0.01$.\n\nAssume that the spectral dependence of aerosol extinction follows the Angström relation $\\tau(\\lambda) = \\beta \\lambda^{-\\alpha}$, where $\\alpha$ is the Angström exponent and $\\beta$ is a turbidity coefficient, and that the AOD measurement errors are independent, Gaussian, and sufficiently small to justify first-order uncertainty propagation.\n\nStarting from the stated physical relation and core statistical principles, do the following:\n1. Linearize the dependence to a form suitable for a straight-line fit in log–log space using the natural logarithm.\n2. Propagate the AOD uncertainties $\\sigma_{\\tau}$ to uncertainties in the log-transformed observations.\n3. Formulate and solve the corresponding weighted least-squares problem to estimate the slope and its standard uncertainty based on the inverse of the normal matrix.\n4. Report the Angström exponent $\\alpha$ and its one-standard-deviation uncertainty as dimensionless numbers, rounded to three significant figures. Use the natural logarithm and express your final answer as dimensionless quantities. The final reported answer must be a calculation.",
            "solution": "The problem requires the determination of the Angström exponent $\\alpha$ and its uncertainty from a set of Aerosol Optical Depth (AOD) measurements at different wavelengths. This will be accomplished by performing a weighted least-squares fit to the linearized form of the Angström power law.\n\nThe problem is deemed valid as it is scientifically grounded in established principles of atmospheric optics, is well-posed with sufficient and consistent data, and is formulated objectively.\n\nThe solution proceeds in four steps as outlined in the problem statement.\n\n**1. Linearization of the Angström Relation**\n\nThe Angström power law relates the aerosol optical depth $\\tau$ to the wavelength $\\lambda$ via two parameters: the Angström exponent $\\alpha$ and the turbidity coefficient $\\beta$. The relation is given by:\n$$\n\\tau(\\lambda) = \\beta \\lambda^{-\\alpha}\n$$\nTo linearize this equation, we take the natural logarithm of both sides:\n$$\n\\ln(\\tau(\\lambda)) = \\ln(\\beta \\lambda^{-\\alpha})\n$$\nUsing the properties of logarithms, $\\ln(ab) = \\ln(a) + \\ln(b)$ and $\\ln(a^b) = b\\ln(a)$, we get:\n$$\n\\ln(\\tau) = \\ln(\\beta) - \\alpha \\ln(\\lambda)\n$$\nThis equation is in the form of a straight line, $y = c + mx$, where:\n- The dependent variable is $y = \\ln(\\tau)$.\n- The independent variable is $x = \\ln(\\lambda)$.\n- The y-intercept is $c = \\ln(\\beta)$.\n- The slope is $m = -\\alpha$.\n\nOur goal is to find the best-fit value for the slope $m$ and its uncertainty, from which we can determine $\\alpha = -m$ and its uncertainty $\\sigma_{\\alpha} = \\sigma_m$.\n\n**2. Propagation of Uncertainties**\n\nThe measurements of AOD, $\\tau_i$, have associated uncertainties, $\\sigma_{\\tau_i}$. We must propagate these uncertainties to the transformed variable $y_i = \\ln(\\tau_i)$. Assuming the uncertainties are small, we can use first-order uncertainty propagation. For a function $y = f(\\tau)$, the uncertainty $\\sigma_y$ is related to the uncertainty $\\sigma_{\\tau}$ by:\n$$\n\\sigma_y = \\left| \\frac{dy}{d\\tau} \\right| \\sigma_{\\tau}\n$$\nIn our case, $y = \\ln(\\tau)$, so the derivative is $\\frac{dy}{d\\tau} = \\frac{1}{\\tau}$. The uncertainty in $y_i$ is therefore:\n$$\n\\sigma_{y_i} = \\frac{\\sigma_{\\tau_i}}{\\tau_i}\n$$\nThe wavelengths $\\lambda_i$ are treated as exact values with no uncertainty.\n\n**3. Weighted Least-Squares Formulation and Solution**\n\nWe have a set of $N=4$ data points $(x_i, y_i)$ with uncertainties $\\sigma_{y_i}$. A weighted least-squares (WLS) fit is appropriate, where each point is weighted by the inverse of the variance of the dependent variable. The weight for the $i$-th data point is:\n$$\nw_i = \\frac{1}{\\sigma_{y_i}^2} = \\left( \\frac{\\tau_i}{\\sigma_{\\tau_i}} \\right)^2\n$$\nThe WLS method finds the parameters $m$ and $c$ that minimize the weighted sum of squared residuals, $\\chi^2$:\n$$\n\\chi^2 = \\sum_{i=1}^{N} w_i (y_i - c - m x_i)^2\n$$\nIn matrix notation, the linear model is $\\mathbf{y} = \\mathbf{X}\\mathbf{a}$, where $\\mathbf{a} = \\begin{pmatrix} c \\\\ m \\end{pmatrix}$ is the vector of parameters, and $\\mathbf{X}$ is the design matrix. The normal equations for the WLS problem are:\n$$\n(\\mathbf{X}^T \\mathbf{W} \\mathbf{X}) \\mathbf{a} = \\mathbf{X}^T \\mathbf{W} \\mathbf{y}\n$$\nHere, $\\mathbf{W}$ is the diagonal matrix of weights $w_i$. The normal matrix is $\\mathbf{A} = \\mathbf{X}^T \\mathbf{W} \\mathbf{X}$. The solution for the parameters is $\\mathbf{a} = \\mathbf{A}^{-1} (\\mathbf{X}^T \\mathbf{W} \\mathbf{y})$.\nThe covariance matrix of the estimated parameters is given by the inverse of the normal matrix, $\\mathbf{C} = \\mathbf{A}^{-1}$.\n$$\n\\mathbf{A} = \\mathbf{X}^T \\mathbf{W} \\mathbf{X} = \\begin{pmatrix} 1  \\dots  1 \\\\ x_1  \\dots  x_N \\end{pmatrix} \\begin{pmatrix} w_1   \\\\  \\ddots  \\\\   w_N \\end{pmatrix} \\begin{pmatrix} 1  x_1 \\\\ \\vdots  \\vdots \\\\ 1  x_N \\end{pmatrix} = \\begin{pmatrix} \\sum w_i  \\sum w_i x_i \\\\ \\sum w_i x_i  \\sum w_i x_i^2 \\end{pmatrix}\n$$\nThe determinant of this matrix is $\\Delta = (\\sum w_i)(\\sum w_i x_i^2) - (\\sum w_i x_i)^2$.\nThe inverse matrix is $\\mathbf{C} = \\mathbf{A}^{-1} = \\frac{1}{\\Delta} \\begin{pmatrix} \\sum w_i x_i^2  -\\sum w_i x_i \\\\ -\\sum w_i x_i  \\sum w_i \\end{pmatrix}$.\nThe variances of the intercept and slope are the diagonal elements of $\\mathbf{C}$:\n$$\n\\sigma_c^2 = C_{11} = \\frac{\\sum w_i x_i^2}{\\Delta} \\quad \\text{and} \\quad \\sigma_m^2 = C_{22} = \\frac{\\sum w_i}{\\Delta}\n$$\nThe best-fit slope $m$ is given by:\n$$\nm = \\frac{(\\sum w_i)(\\sum w_i x_i y_i) - (\\sum w_i x_i)(\\sum w_i y_i)}{\\Delta}\n$$\n\n**4. Calculation**\n\nFirst, we process the given data to obtain the transformed variables and weights. The data are:\n- $i=1$: $\\lambda_1 = 0.440$, $\\tau_1 = 0.35$, $\\sigma_{\\tau_1} = 0.01$\n- $i=2$: $\\lambda_2 = 0.675$, $\\tau_2 = 0.22$, $\\sigma_{\\tau_2} = 0.01$\n- $i=3$: $\\lambda_3 = 0.870$, $\\tau_3 = 0.16$, $\\sigma_{\\tau_3} = 0.01$\n- $i=4$: $\\lambda_4 = 1.020$, $\\tau_4 = 0.13$, $\\sigma_{\\tau_4} = 0.01$\n\nWe compute $x_i = \\ln(\\lambda_i)$, $y_i = \\ln(\\tau_i)$, and $w_i = (\\tau_i/\\sigma_{\\tau_i})^2$ for each point:\n- $x_1 = \\ln(0.440) \\approx -0.82098$, $y_1 = \\ln(0.35) \\approx -1.04982$, $w_1 = (0.35/0.01)^2 = 1225$\n- $x_2 = \\ln(0.675) \\approx -0.39304$, $y_2 = \\ln(0.22) \\approx -1.51413$, $w_2 = (0.22/0.01)^2 = 484$\n- $x_3 = \\ln(0.870) \\approx -0.13926$, $y_3 = \\ln(0.16) \\approx -1.83258$, $w_3 = (0.16/0.01)^2 = 256$\n- $x_4 = \\ln(1.020) \\approx \\hphantom{-}0.01980$, $y_4 = \\ln(0.13) \\approx -2.04022$, $w_4 = (0.13/0.01)^2 = 169$\n\nNext, we compute the required weighted sums:\n- $\\sum w_i = 1225 + 484 + 256 + 169 = 2134$\n- $\\sum w_i x_i = (1225)(-0.82098) + (484)(-0.39304) + (256)(-0.13926) + (169)(0.01980) \\approx -1228.24$\n- $\\sum w_i y_i = (1225)(-1.04982) + (484)(-1.51413) + (256)(-1.83258) + (169)(-2.04022) \\approx -2832.91$\n- $\\sum w_i x_i^2 = (1225)(-0.82098)^2 + (484)(-0.39304)^2 + (256)(-0.13926)^2 + (169)(0.01980)^2 \\approx 905.47$\n- $\\sum w_i x_i y_i = (1225)(-0.82098)(-1.04982) + \\dots \\approx 1402.37$\n\nUsing these sums (with higher precision for calculation), we find $\\Delta$:\n$$\n\\Delta = (2134)(905.4703) - (-1228.2436)^2 \\approx 1932352.66 - 1508482.25 \\approx 423870.41\n$$\nNow, we calculate the slope $m$:\n$$\nm = \\frac{(2134)(1402.3677) - (-1228.2436)(-2832.9081)}{423870.41} \\approx \\frac{2992455.0 - 3479979.7}{423870.41} \\approx -1.15018\n$$\nThe variance of the slope, $\\sigma_m^2$, is:\n$$\n\\sigma_m^2 = \\frac{\\sum w_i}{\\Delta} = \\frac{2134}{423870.41} \\approx 0.0050345\n$$\nThe standard uncertainty of the slope is the square root of the variance:\n$$\n\\sigma_m = \\sqrt{0.0050345} \\approx 0.07095\n$$\nFinally, we determine the Angström exponent $\\alpha$ and its uncertainty $\\sigma_{\\alpha}$:\n$$\n\\alpha = -m = -(-1.15018) \\approx 1.15018\n$$\n$$\n\\sigma_{\\alpha} = \\sigma_m \\approx 0.07095\n$$\nRounding these values to three significant figures as requested:\n- $\\alpha \\approx 1.15$\n- $\\sigma_{\\alpha} \\approx 0.0710$\n\nThe Angström exponent is $\\alpha = 1.15$ and its one-standard-deviation uncertainty is $\\sigma_{\\alpha} = 0.0710$. These are dimensionless quantities.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.15  0.0710 \\end{pmatrix}}$$"
        },
        {
            "introduction": "To build predictive models of the atmosphere, we must connect an aerosol's physical and chemical composition to its radiative properties. This practice focuses on deriving the mass extinction efficiency $\\varepsilon_{\\text{ext}}$, a critical parameter that quantifies how effectively aerosol mass attenuates light . Starting from a given particle size distribution and single-particle scattering properties, you will develop a closed-form expression for $\\varepsilon_{\\text{ext}}$, reinforcing the fundamental link between aerosol microphysics and bulk optical behavior.",
            "id": "3795267",
            "problem": "Aerosol mass extinction efficiency quantifies how effectively an aerosol mass attenuates light and is central to remote sensing retrievals in Light Detection and Ranging (LIDAR) and passive measurements. Consider a polydisperse, externally mixed aerosol composed of spherical sulfate particles that are non-absorbing at visible wavelengths. Let the extinction coefficient be defined by the Beer–Lambert law, and let the aerosol mass concentration be defined as the total particulate mass per unit air volume. Assume the following:\n\n- The particle number size distribution is lognormal with number concentration $N$, geometric mean radius $r_{g}$, and geometric standard deviation $\\sigma_{g}$, given by\n$$\nn(r) \\;=\\; \\frac{N}{\\sqrt{2\\pi}\\,\\ln(\\sigma_{g})}\\,\\frac{1}{r}\\,\\exp\\!\\left[-\\frac{\\left(\\ln\\!\\left(\\frac{r}{r_{g}}\\right)\\right)^{2}}{2\\,\\ln^{2}(\\sigma_{g})}\\right].\n$$\n- The particles are homogeneous spheres of density $\\rho_{p}$.\n- The wavelength is $\\lambda$ with wavenumber $k = 2\\pi/\\lambda$, and the complex refractive index is $m$.\n- In the small size parameter limit with negligible absorption, the extinction cross section for a sphere is given by the Rayleigh-scattering expression\n$$\nC_{\\text{ext}}(r) \\;=\\; \\frac{8\\pi}{3}\\,k^{4}\\,r^{6}\\,\\left|\\frac{m^{2}-1}{m^{2}+2}\\right|^{2}.\n$$\n\nStarting from the definitions of the volume extinction coefficient $b_{\\text{ext}}$ and aerosol mass concentration $\\rho_{\\text{a}}$, derive a closed-form expression for the mass extinction efficiency $\\varepsilon_{\\text{ext}} = b_{\\text{ext}}/\\rho_{\\text{a}}$ in terms of $\\rho_{p}$, $r_{g}$, $\\sigma_{g}$, $k$, and $m$. Then, numerically evaluate $\\varepsilon_{\\text{ext}}$ for ammonium sulfate aerosol under the following conditions, which are representative of remote sensing at green wavelengths:\n\n- $\\lambda = 532 \\,\\mathrm{nm}$,\n- $m = 1.53$ (real, negligible imaginary part),\n- $\\rho_{p} = 1.77 \\times 10^{3} \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n- $r_{g} = 60 \\,\\mathrm{nm}$,\n- $\\sigma_{g} = 1.6$.\n\nExpress your final answer for $\\varepsilon_{\\text{ext}}$ in $\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}$, and round to three significant figures. Clearly state any intermediate symbolic expressions you derive before substituting numerical values, and justify the regime and assumptions used.",
            "solution": "The problem requires the derivation of the mass extinction efficiency, $\\varepsilon_{\\text{ext}}$, for a polydisperse aerosol, followed by a numerical evaluation under specific conditions.\n\n### Step 1: Problem Validation\n\n**1.1. Extracted Givens:**\n- Aerosol type: Polydisperse, externally mixed, spherical, non-absorbing sulfate particles.\n- Particle number size distribution $n(r)$: Lognormal\n$$n(r) = \\frac{N}{\\sqrt{2\\pi}\\,\\ln(\\sigma_{g})}\\,\\frac{1}{r}\\,\\exp\\!\\left[-\\frac{\\left(\\ln\\!\\left(\\frac{r}{r_{g}}\\right)\\right)^{2}}{2\\,\\ln^{2}(\\sigma_{g})}\\right]$$\nwhere $N$ is the total number concentration, $r_g$ is the geometric mean radius, and $\\sigma_g$ is the geometric standard deviation.\n- Particle properties: Homogeneous spheres of density $\\rho_p$.\n- Radiation properties: Wavelength $\\lambda$, wavenumber $k = 2\\pi/\\lambda$, real refractive index $m$.\n- Extinction cross section $C_{\\text{ext}}(r)$ (Rayleigh scattering approximation):\n$$C_{\\text{ext}}(r) = \\frac{8\\pi}{3}\\,k^{4}\\,r^{6}\\,\\left|\\frac{m^{2}-1}{m^{2}+2}\\right|^{2}$$\n- Definitions:\n  - Volume extinction coefficient: $b_{\\text{ext}}$ (from Beer-Lambert law).\n  - Aerosol mass concentration: $\\rho_{\\text{a}}$ (total particulate mass per unit air volume).\n  - Mass extinction efficiency: $\\varepsilon_{\\text{ext}} = b_{\\text{ext}}/\\rho_{\\text{a}}$.\n- Numerical values for evaluation:\n  - $\\lambda = 532 \\,\\mathrm{nm}$\n  - $m = 1.53$\n  - $\\rho_{p} = 1.77 \\times 10^{3} \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n  - $r_{g} = 60 \\,\\mathrm{nm}$\n  - $\\sigma_{g} = 1.6$\n\n**1.2. Validation Using Extracted Givens:**\nThe problem is scientifically grounded in the principles of atmospheric radiation and aerosol science. The definitions and equations provided are standard in the field. The problem is mathematically well-posed, providing all necessary information for a unique solution.\n\nHowever, a critical point of analysis is the consistency between the provided physical model and the numerical parameters. The problem states that the expression for $C_{\\text{ext}}(r)$ is valid \"in the small size parameter limit\". The size parameter is $x = kr = 2\\pi r/\\lambda$. The given numerical parameters are $r_g = 60 \\times 10^{-9} \\, \\mathrm{m}$ and $\\lambda = 532 \\times 10^{-9} \\, \\mathrm{m}$. This gives a size parameter for the geometric mean radius of $x_g = 2\\pi (60)/532 \\approx 0.708$. The Rayleigh regime is strictly valid for $x \\ll 1$ (e.g., $x0.3$). Given the geometric standard deviation $\\sigma_g = 1.6$, a significant fraction of particles will have radii larger than $r_g$, and thus size parameters exceeding $1$. This means the Rayleigh scattering approximation is not physically accurate for the specified aerosol population.\n\nDespite this physical inconsistency, the problem constitutes a well-defined mathematical task: \"Starting from the definitions ... derive a closed-form expression ... Then, numerically evaluate ...\". It instructs the use of a specific formula, regardless of its domain of validity. In this context, the problem is treated as a valid exercise in mathematical physics, designed to test the ability to integrate physical properties over a statistical distribution. The instruction to \"justify the regime and assumptions used\" allows for this very critique to be part of the solution.\n\n**1.3. Verdict and Action:**\nThe problem is deemed valid as a self-contained mathematical problem. The derivation and calculation will proceed as instructed, with commentary on the physical limitations of the model.\n\n### Step 2: Symbolic Derivation of Mass Extinction Efficiency $\\varepsilon_{\\text{ext}}$\n\n**2.1. Volume Extinction Coefficient ($b_{\\text{ext}}$):**\nThe volume extinction coefficient is the total extinction cross section per unit volume, obtained by integrating the single-particle cross section over the size distribution:\n$$b_{\\text{ext}} = \\int_{0}^{\\infty} C_{\\text{ext}}(r) n(r) \\, dr$$\nSubstituting the given expressions for $C_{\\text{ext}}(r)$ and $n(r)$:\n$$b_{\\text{ext}} = \\int_{0}^{\\infty} \\left( \\frac{8\\pi}{3}\\,k^{4}\\,r^{6}\\,\\left|\\frac{m^{2}-1}{m^{2}+2}\\right|^{2} \\right) \\left( \\frac{N}{\\sqrt{2\\pi}\\,\\ln(\\sigma_{g})}\\,\\frac{1}{r}\\,\\exp\\!\\left[-\\frac{\\left(\\ln(r/r_{g})\\right)^{2}}{2\\,\\ln^{2}(\\sigma_{g})}\\right] \\right) \\, dr$$\nGrouping the constant terms, we have:\n$$b_{\\text{ext}} = \\frac{8\\pi k^{4}}{3} \\left|\\frac{m^{2}-1}{m^{2}+2}\\right|^{2} \\int_{0}^{\\infty} r^{6} n(r) \\, dr$$\nThe integral represents the $6^{th}$ moment of the particle size distribution, which is $\\int_{0}^{\\infty} r^6 n(r) dr = N \\mathbb{E}[r^6]$. For a lognormal distribution, the $p^{th}$ moment is given by $\\mathbb{E}[r^p] = r_{g}^{p} \\exp\\left(\\frac{p^{2}}{2}\\ln^{2}(\\sigma_{g})\\right)$. For $p=6$:\n$$\\int_{0}^{\\infty} r^{6} n(r) \\, dr = N r_{g}^{6} \\exp\\left(\\frac{6^{2}}{2}\\ln^{2}(\\sigma_{g})\\right) = N r_{g}^{6} \\exp\\left(18\\ln^{2}(\\sigma_{g})\\right)$$\nSubstituting this back into the expression for $b_{\\text{ext}}$:\n$$b_{\\text{ext}} = \\frac{8\\pi}{3} k^{4} \\left|\\frac{m^{2}-1}{m^{2}+2}\\right|^{2} N r_{g}^{6} \\exp\\left(18\\ln^{2}(\\sigma_{g})\\right)$$\n\n**2.2. Aerosol Mass Concentration ($\\rho_{\\text{a}}$):**\nThe aerosol mass concentration is the total mass of particles per unit volume. The mass of a single spherical particle is $m_p(r) = \\rho_p V(r) = \\rho_p \\frac{4}{3}\\pi r^3$.\n$$\\rho_{\\text{a}} = \\int_{0}^{\\infty} m_p(r) n(r) \\, dr = \\int_{0}^{\\infty} \\left( \\rho_p \\frac{4}{3}\\pi r^3 \\right) n(r) \\, dr$$\n$$\\rho_{\\text{a}} = \\frac{4\\pi \\rho_p}{3} \\int_{0}^{\\infty} r^{3} n(r) \\, dr$$\nThe integral is the $3^{rd}$ moment of the size distribution. Using the moment formula with $p=3$:\n$$\\int_{0}^{\\infty} r^{3} n(r) \\, dr = N r_{g}^{3} \\exp\\left(\\frac{3^{2}}{2}\\ln^{2}(\\sigma_{g})\\right) = N r_{g}^{3} \\exp\\left(4.5\\ln^{2}(\\sigma_{g})\\right)$$\nSubstituting this result:\n$$\\rho_{\\text{a}} = \\frac{4\\pi}{3} \\rho_p N r_{g}^{3} \\exp\\left(4.5\\ln^{2}(\\sigma_{g})\\right)$$\n\n**2.3. Mass Extinction Efficiency ($\\varepsilon_{\\text{ext}}$):**\nThe mass extinction efficiency is the ratio $\\varepsilon_{\\text{ext}} = b_{\\text{ext}} / \\rho_{\\text{a}}$.\n$$\\varepsilon_{\\text{ext}} = \\frac{\\frac{8\\pi}{3} k^{4} \\left|\\frac{m^{2}-1}{m^{2}+2}\\right|^{2} N r_{g}^{6} \\exp\\left(18\\ln^{2}(\\sigma_{g})\\right)}{\\frac{4\\pi}{3} \\rho_p N r_{g}^{3} \\exp\\left(4.5\\ln^{2}(\\sigma_{g})\\right)}$$\nCanceling common terms ($N$, $\\pi$, $4/3$):\n$$\\varepsilon_{\\text{ext}} = \\frac{2k^{4}}{\\rho_p} \\left|\\frac{m^{2}-1}{m^{2}+2}\\right|^{2} r_{g}^{3} \\exp\\left(18\\ln^{2}(\\sigma_{g}) - 4.5\\ln^{2}(\\sigma_{g})\\right)$$\nThe final symbolic expression for the mass extinction efficiency is:\n$$\\varepsilon_{\\text{ext}} = \\frac{2k^{4} r_{g}^{3}}{\\rho_p} \\left|\\frac{m^{2}-1}{m^{2}+2}\\right|^{2} \\exp\\left(13.5\\ln^{2}(\\sigma_{g})\\right)$$\n\n### Step 3: Numerical Evaluation\n\nWe now substitute the given numerical values into the derived expression. All values must be in base SI units (meters, kilograms).\n\n- $\\lambda = 532 \\times 10^{-9} \\, \\mathrm{m} \\implies k = \\frac{2\\pi}{\\lambda} = \\frac{2\\pi}{532 \\times 10^{-9}} \\, \\mathrm{m}^{-1}$\n- $r_g = 60 \\times 10^{-9} \\, \\mathrm{m}$\n- $\\rho_p = 1.77 \\times 10^3 \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $m = 1.53$ (real)\n- $\\sigma_g = 1.6$\n\nFirst, we calculate the individual components of the expression:\n- Wavenumber squared term: $k^4 = \\left(\\frac{2\\pi}{532 \\times 10^{-9}}\\right)^4 \\approx 1.94435 \\times 10^{28} \\, \\mathrm{m}^{-4}$\n- Geometric mean radius cubed: $r_g^3 = (60 \\times 10^{-9})^3 = 2.16 \\times 10^{-22} \\, \\mathrm{m}^3$\n- Refractive index function:\n$\\left|\\frac{m^{2}-1}{m^{2}+2}\\right|^{2} = \\left(\\frac{1.53^{2}-1}{1.53^{2}+2}\\right)^{2} = \\left(\\frac{2.3409-1}{2.3409+2}\\right)^{2} = \\left(\\frac{1.3409}{4.3409}\\right)^{2} \\approx 0.0954088$\n- Size distribution width term:\n$\\ln(\\sigma_g) = \\ln(1.6) \\approx 0.470004$\n$\\exp\\left(13.5 \\ln^2(\\sigma_g)\\right) = \\exp\\left(13.5 \\times (0.470004)^2\\right) \\approx \\exp(2.98220) \\approx 19.7304$\n\nNow we combine these values:\n$$\\varepsilon_{\\text{ext}} = \\frac{2 \\times (1.94435 \\times 10^{28}) \\times (2.16 \\times 10^{-22})}{1.77 \\times 10^3} \\times 0.0954088 \\times 19.7304$$\n$$\\varepsilon_{\\text{ext}} \\approx \\frac{8.4001 \\times 10^6}{1.77 \\times 10^3} \\times 1.8824 \\approx \\frac{1.5810 \\times 10^7}{1.77 \\times 10^3} \\approx 8932.2 \\, \\mathrm{m}^2\\,\\mathrm{kg}^{-1}$$\nLet's recalculate the product more carefully:\n$$ \\varepsilon_{\\text{ext}} = \\frac{2}{1.77 \\times 10^3} \\times (1.94435 \\times 10^{28}) \\times (2.16 \\times 10^{-22}) \\times 0.0954088 \\times 19.7304 $$\n$$ \\varepsilon_{\\text{ext}} = \\left(\\frac{2 \\times 1.94435 \\times 2.16 \\times 0.0954088 \\times 19.7304}{1.77}\\right) \\times 10^{-3+28-22} $$\n$$ \\varepsilon_{\\text{ext}} = \\left(\\frac{15.8104}{1.77}\\right) \\times 10^3 \\approx 8932.4 \\, \\mathrm{m}^2\\,\\mathrm{kg}^{-1} $$\n\nRounding the result to three significant figures gives $8.93 \\times 10^3 \\, \\mathrm{m}^2\\,\\mathrm{kg}^{-1}$.\n\nThe obtained value of approximately $8.9 \\, \\mathrm{m}^2\\,\\mathrm{g}^{-1}$ is at the high end of typical values for atmospheric aerosols. This is a direct consequence of using the Rayleigh approximation, where mass-specific extinction is proportional to $r^3$, in conjunction with a broad size distribution ($\\sigma_g = 1.6$). The larger particles in the tail of the distribution, for which the Rayleigh approximation is a significant overestimation of the true cross-section, dominate the integrated result and produce a large efficiency value. Had the more general Mie theory been used, the result would be quantitatively different and more physically accurate.",
            "answer": "$$\\boxed{8.93 \\times 10^{3}}$$"
        },
        {
            "introduction": "The ultimate goal of many remote sensing applications is to solve the inverse problem: retrieving atmospheric properties from measured radiation. This capstone exercise guides you through the development of a state-of-the-art retrieval algorithm using the Optimal Estimation (OE) framework . You will derive the analytical Jacobians—the sensitivity of the satellite signal to aerosol properties—and implement the linear Bayesian update to retrieve the aerosol state, gaining invaluable insight into the engine behind modern satellite data products.",
            "id": "3795293",
            "problem": "Consider a plane-parallel, horizontally homogeneous atmosphere above a Lambertian surface observed at the Top-of-Atmosphere (TOA). The atmosphere contains aerosols characterized by the aerosol optical thickness $\\,\\tau\\,$ (dimensionless), the single scattering albedo $\\,\\omega_0\\,$ (dimensionless), and the asymmetry parameter $\\,g\\,$ (dimensionless). The surface is characterized by a Lambertian reflectance $\\,\\rho\\,$ (dimensionless) that is spectrally constant at the wavelength under consideration. The extraterrestrial spectral solar irradiance at the wavelength is $\\,E_0\\,$ with units $\\mathrm{W\\,m^{-2}\\,\\mu m^{-1}}$. The observation geometry is described by the solar zenith cosine $\\,\\mu_0 = \\cos\\theta_0\\,$, the viewing zenith cosine $\\,\\mu = \\cos\\theta\\,$, and the relative azimuth $\\,\\phi\\,$ in radians. The scattering angle $\\,\\Theta\\,$ is defined via\n$$\n\\cos\\Theta \\equiv \\mu \\mu_0 + \\sqrt{1 - \\mu^2}\\,\\sqrt{1 - \\mu_0^2}\\,\\cos\\phi.\n$$\nAssume the Single-Scattering Approximation (SSA) holds and neglect multiple scattering beyond the first order in the atmosphere. The aerosol phase function is modeled by the Henyey–Greenstein (HG) form:\n$$\nP(\\Theta; g) = \\frac{1 - g^2}{\\left(1 + g^2 - 2 g \\cos\\Theta\\right)^{3/2}},\n$$\nwhich is dimensionless and captures the angular redistribution of scattered light. Let $\\,I(\\mu,\\mu_0,\\phi;\\tau,\\omega_0,g)\\,$ denote the TOA specific intensity (radiance) in $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$ arising from atmospheric path radiance and attenuated Lambertian surface reflection under these assumptions.\n\nTask 1 (Derivation): Starting from the scalar radiative transfer equation under the SSA and a homogeneous atmosphere, derive the analytic expressions for the Jacobian components of the TOA specific intensity with respect to the aerosol parameters:\n- $$\\frac{\\partial I}{\\partial \\tau},$$\n- $$\\frac{\\partial I}{\\partial \\omega_0},$$\n- $$\\frac{\\partial I}{\\partial g}.$$\nYour derivation must begin from fundamental definitions: the Beer–Lambert transmittance along the solar and sensor paths, the HG phase function, and the single-scattering source term integrated over optical depth. Express all intermediate quantities symbolically; do not invoke any pre-assembled shortcut formula without showing how it follows from these bases.\n\nTask 2 (Algorithmic Framework): Using the Optimal Estimation (OE) framework, linearize the forward model around a chosen prior state $\\,\\mathbf{x}_{\\text{a}} = [\\tau_{\\text{a}}, \\omega_{0,\\text{a}}, g_{\\text{a}}]^T\\,$ with prior covariance $\\,\\mathbf{S}_{\\text{a}}\\,$ (a $3\\times3$ positive-definite matrix). Define the Jacobian matrix $\\,\\mathbf{K}\\,$ whose $i$-th row contains $\\,\\left[\\partial I_i/\\partial \\tau,\\ \\partial I_i/\\partial \\omega_0,\\ \\partial I_i/\\partial g\\right]\\,$ evaluated at $\\,\\mathbf{x}_{\\text{a}}\\,$ for measurement $\\,i\\,$. With a measurement vector $\\,\\mathbf{y}\\,$ and measurement error covariance $\\,\\mathbf{S}_{\\text{e}}\\,$, compute the OE posterior mean using the linear Bayesian update:\n$$\n\\hat{\\mathbf{x}} = \\mathbf{x}_{\\text{a}} + \\mathbf{G}\\,\\left(\\mathbf{y} - \\mathbf{F}(\\mathbf{x}_{\\text{a}})\\right), \\quad \\text{where} \\quad \\mathbf{G} = \\mathbf{S}_{\\text{a}} \\mathbf{K}^T \\left(\\mathbf{K}\\,\\mathbf{S}_{\\text{a}}\\,\\mathbf{K}^T + \\mathbf{S}_{\\text{e}}\\right)^{-1},\n$$\nand $\\,\\mathbf{F}(\\mathbf{x}_{\\text{a}})\\,$ is the forward model evaluated at $\\,\\mathbf{x}_{\\text{a}}\\,$ producing the synthetic radiance vector. You must compute $\\,\\hat{\\mathbf{x}}\\,$ for each test case described below. Angles must be handled in radians, and all radiance computations must be internally consistent with $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$ units. The final retrieval parameters $\\,\\hat{\\tau}, \\hat{\\omega}_0, \\hat{g}\\,$ are dimensionless.\n\nImplementation Requirements: Your program must implement the derived analytic Jacobians and the OE posterior mean computation. Numerical differentiation is not permitted. Use the HG phase function as specified and the SSA-based homogeneous-layer single-scattering formulation for both the atmospheric path radiance and the attenuated surface-reflected term.\n\nTest Suite: For each test case, the measurement vector $\\,\\mathbf{y}\\,$ must be generated internally by evaluating the forward model at the specified true state $\\,\\mathbf{x}_{\\text{true}}\\,$ without added noise. Use three geometries per case. The test cases are:\n\n- Case A (typical aerosol):\n  - $E_0 = 1800$,\n  - $\\rho = 0.05$,\n  - $\\mu_0 = 0.8$,\n  - $(\\mu,\\phi)$ triplets: $(0.2,0.0)$, $(0.5,0.0)$, $(0.9,0.0)$,\n  - Prior mean $\\,\\mathbf{x}_{\\text{a}} = [0.50,\\,0.90,\\,0.50]^T$,\n  - Prior covariance $\\,\\mathbf{S}_{\\text{a}} = \\mathrm{diag}([0.20^2,\\,0.10^2,\\,0.30^2])$,\n  - Measurement error covariance $\\,\\mathbf{S}_{\\text{e}} = \\mathrm{diag}([0.50^2,\\,0.50^2,\\,0.50^2])$,\n  - True state $\\,\\mathbf{x}_{\\text{true}} = [0.30,\\,0.95,\\,0.70]^T$.\n\n- Case B (thin, highly scattering aerosol):\n  - $E_0 = 1800$,\n  - $\\rho = 0.10$,\n  - $\\mu_0 = 0.60$,\n  - $(\\mu,\\phi)$ triplets: $(0.30,0.0)$, $(0.60,0.0)$, $(0.95,0.0)$,\n  - Prior mean $\\,\\mathbf{x}_{\\text{a}} = [0.15,\\,0.92,\\,0.60]^T$,\n  - Prior covariance $\\,\\mathbf{S}_{\\text{a}} = \\mathrm{diag}([0.15^2,\\,0.08^2,\\,0.25^2])$,\n  - Measurement error covariance $\\,\\mathbf{S}_{\\text{e}} = \\mathrm{diag}([0.20^2,\\,0.20^2,\\,0.20^2])$,\n  - True state $\\,\\mathbf{x}_{\\text{true}} = [0.02,\\,0.99,\\,0.80]^T$.\n\n- Case C (strongly backscattering tendency):\n  - $E_0 = 1800$,\n  - $\\rho = 0.20$,\n  - $\\mu_0 = 0.90$,\n  - $(\\mu,\\phi)$ triplets: $(0.10,0.0)$, $(0.40,0.0)$, $(0.85,0.0)$,\n  - Prior mean $\\,\\mathbf{x}_{\\text{a}} = [0.60,\\,0.80,\\,0.00]^T$,\n  - Prior covariance $\\,\\mathbf{S}_{\\text{a}} = \\mathrm{diag}([0.25^2,\\,0.10^2,\\,0.20^2])$,\n  - Measurement error covariance $\\,\\mathbf{S}_{\\text{e}} = \\mathrm{diag}([0.30^2,\\,0.30^2,\\,0.30^2])$,\n  - True state $\\,\\mathbf{x}_{\\text{true}} = [0.50,\\,0.85,\\,-0.20]^T$.\n\nFinal Output Specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a bracketed, comma-separated triple $[\\hat{\\tau},\\hat{\\omega}_0,\\hat{g}]$ for Cases A, B, and C respectively. Each number must be rounded to six decimal places. For example, an output with three cases should look like:\n$$\n\\text{[[0.321000,0.950000,0.700000],[\\dots],[\\dots]]}.\n$$",
            "solution": "The problem requires the derivation and implementation of an Optimal Estimation (OE) retrieval algorithm for aerosol properties from Top-of-Atmosphere (TOA) radiance measurements. The retrieval is based on a linearized forward model under the single-scattering approximation (SSA). The solution is structured in two parts: first, the derivation of the forward model and its Jacobians, and second, the description of the OE algorithmic framework.\n\n### Part 1: Derivation of the Forward Model and Jacobians\n\nThe TOA specific intensity (radiance) $I$ is the sum of two components: the atmospheric path radiance $I_{\\text{path}}$, which is solar radiation scattered by the atmosphere into the sensor's direction, and the surface-reflected radiance $I_{\\text{surf}}$, which is radiation reflected by the surface and attenuated by the atmosphere along the path to the sensor.\n$$\nI = I_{\\text{path}} + I_{\\text{surf}}\n$$\n\n**1.1. Atmospheric Path Radiance ($I_{\\text{path}}$)**\n\nThe path radiance is found by integrating the single-scattering source term along the line of sight. For a plane-parallel, homogeneous atmosphere with total aerosol optical thickness $\\tau$, the source of singly scattered radiation at an optical depth $\\tau'$ (measured from TOA) is given by:\n$$\nJ(\\tau') = \\frac{\\omega_0}{4\\pi} P(\\Theta; g) \\times (\\text{Incident Irradiance at } \\tau')\n$$\nThe incident irradiance is from the direct solar beam, which is attenuated according to the Beer-Lambert law. The flux perpendicular to the solar beam is $E_0$, so the irradiance on a horizontal plane at optical depth $\\tau'$ is $E_0 \\mu_0 \\exp(-\\tau'/\\mu_0)$. The radiance of the direct beam is this irradiance divided by the solid angle of the sun, but for the source term, we consider the direct solar beam as a plane wave with flux $E_0$ incident from direction $(\\mu_0, \\phi_0)$. The source function is thus:\n$$\nJ(\\tau') = \\frac{\\omega_0}{4\\pi} P(\\Theta; g) E_0 \\exp(-\\tau'/\\mu_0)\n$$\nThe contribution to the TOA radiance from a layer of thickness $d\\tau'$ at optical depth $\\tau'$ is this source function, attenuated along the path to the sensor (viewing zenith cosine $\\mu$):\n$$\ndI_{\\text{path}} = J(\\tau') \\exp(-\\tau'/\\mu) \\frac{d\\tau'}{\\mu}\n$$\nIntegrating from the TOA ($\\tau'=0$) to the bottom of the aerosol layer ($\\tau'=\\tau$):\n$$\nI_{\\text{path}} = \\int_0^\\tau J(\\tau') \\exp(-\\tau'/\\mu) \\frac{d\\tau'}{\\mu} = \\int_0^\\tau \\frac{\\omega_0 E_0}{4\\pi\\mu} P(\\Theta; g) \\exp\\left(-\\frac{\\tau'}{\\mu_0}\\right) \\exp\\left(-\\frac{\\tau'}{\\mu}\\right) d\\tau'\n$$\n$$\nI_{\\text{path}} = \\frac{\\omega_0 E_0 P(\\Theta; g)}{4\\pi\\mu} \\int_0^\\tau \\exp\\left(-\\tau'\\left(\\frac{1}{\\mu_0}+\\frac{1}{\\mu}\\right)\\right) d\\tau'\n$$\nThe integral evaluates to:\n$$\n\\int_0^\\tau \\exp(-\\tau' m) d\\tau' = \\left[-\\frac{1}{m}\\exp(-\\tau'm)\\right]_0^\\tau = \\frac{1}{m}\\left(1-\\exp(-\\tau m)\\right)\n$$\nwhere $m = 1/\\mu_0 + 1/\\mu = (\\mu + \\mu_0)/(\\mu\\mu_0)$. Substituting this back:\n$$\nI_{\\text{path}} = \\frac{\\omega_0 E_0 P(\\Theta; g)}{4\\pi\\mu} \\frac{\\mu\\mu_0}{\\mu+\\mu_0} \\left(1-\\exp\\left(-\\tau\\left(\\frac{1}{\\mu_0}+\\frac{1}{\\mu}\\right)\\right)\\right)\n$$\n$$\nI_{\\text{path}} = \\frac{E_0 \\mu_0}{4\\pi(\\mu+\\mu_0)} \\omega_0 P(\\Theta; g) \\left(1-\\exp\\left(-\\tau\\left(\\frac{1}{\\mu_0}+\\frac{1}{\\mu}\\right)\\right)\\right)\n$$\n\n**1.2. Surface-Reflected Radiance ($I_{\\text{surf}}$)**\n\nUnder the SSA, we consider only the direct solar beam illuminating the surface. The downwelling direct solar irradiance at the surface (at total optical depth $\\tau$) is:\n$$\nE_{\\text{down}} = E_0 \\mu_0 \\exp(-\\tau/\\mu_0)\n$$\nFor a Lambertian surface with reflectance $\\rho$, the upwelling radiance from the surface is isotropic:\n$$\nL_{\\text{surf}} = \\frac{\\rho E_{\\text{down}}}{\\pi} = \\frac{\\rho E_0 \\mu_0}{\\pi} \\exp(-\\tau/\\mu_0)\n$$\nThis upwelling radiance is attenuated along the path to the sensor:\n$$\nI_{\\text{surf}} = L_{\\text{surf}} \\exp(-\\tau/\\mu) = \\frac{\\rho E_0 \\mu_0}{\\pi} \\exp(-\\tau/\\mu_0) \\exp(-\\tau/\\mu)\n$$\n$$\nI_{\\text{surf}} = \\frac{\\rho E_0 \\mu_0}{\\pi} \\exp\\left(-\\tau\\left(\\frac{1}{\\mu_0}+\\frac{1}{\\mu}\\right)\\right)\n$$\n\n**1.3. Total TOA Radiance (Forward Model $F$ )**\n\nThe total TOA radiance $I(\\tau, \\omega_0, g)$ is the sum $I_{\\text{path}} + I_{\\text{surf}}$. Let's define the total two-way path transmittance $T$ as:\n$$\nT(\\tau) = \\exp\\left(-\\tau\\left(\\frac{1}{\\mu_0}+\\frac{1}{\\mu}\\right)\\right)\n$$\nThe forward model can be written compactly as:\n$$\nI(\\tau, \\omega_0, g) = \\frac{E_0 \\mu_0}{4\\pi(\\mu+\\mu_0)} \\omega_0 P(\\Theta; g) (1 - T(\\tau)) + \\frac{\\rho E_0 \\mu_0}{\\pi} T(\\tau)\n$$\nwhere $P(\\Theta; g) = (1 - g^2) / (1 + g^2 - 2 g \\cos\\Theta)^{3/2}$.\n\n**1.4. Jacobians of the TOA Radiance**\n\nThe Jacobian matrix $\\mathbf{K}$ requires the partial derivatives of $I$ with respect to the state vector components $\\mathbf{x} = [\\tau, \\omega_0, g]^T$.\n\n**Derivative with respect to $\\tau$:**\nWe differentiate $I$ with respect to $\\tau$. Note that only $T(\\tau)$ depends on $\\tau$.\n$$\n\\frac{\\partial T}{\\partial \\tau} = -\\left(\\frac{1}{\\mu_0}+\\frac{1}{\\mu}\\right) \\exp\\left(-\\tau\\left(\\frac{1}{\\mu_0}+\\frac{1}{\\mu}\\right)\\right) = -\\left(\\frac{1}{\\mu_0}+\\frac{1}{\\mu}\\right)T(\\tau)\n$$\n$$\n\\frac{\\partial I}{\\partial \\tau} = \\frac{E_0 \\mu_0}{4\\pi(\\mu+\\mu_0)} \\omega_0 P(\\Theta; g) \\left(-\\frac{\\partial T}{\\partial \\tau}\\right) + \\frac{\\rho E_0 \\mu_0}{\\pi} \\frac{\\partial T}{\\partial \\tau}\n$$\n$$\n\\frac{\\partial I}{\\partial \\tau} = \\left( \\frac{E_0 \\mu_0 \\omega_0 P(\\Theta; g)}{4\\pi(\\mu+\\mu_0)} - \\frac{\\rho E_0 \\mu_0}{\\pi} \\right) \\left(-\\frac{\\partial T}{\\partial \\tau}\\right)\n$$\n$$\n\\frac{\\partial I}{\\partial \\tau} = \\left(\\frac{1}{\\mu_0}+\\frac{1}{\\mu}\\right) T(\\tau) \\left( \\frac{E_0 \\mu_0 \\omega_0 P(\\Theta; g)}{4\\pi(\\mu+\\mu_0)} - \\frac{\\rho E_0 \\mu_0}{\\pi} \\right)\n$$\n\n**Derivative with respect to $\\omega_0$:**\nThe single scattering albedo $\\omega_0$ appears linearly and only in the path radiance term.\n$$\n\\frac{\\partial I}{\\partial \\omega_0} = \\frac{E_0 \\mu_0}{4\\pi(\\mu+\\mu_0)} P(\\Theta; g) (1 - T(\\tau))\n$$\nThis derivative is always non-negative, as increasing the scattering efficiency (at fixed extinction) increases path radiance.\n\n**Derivative with respect to $g$:**\nThe asymmetry parameter $g$ appears only in the Henyey-Greenstein phase function $P(\\Theta; g)$.\n$$\n\\frac{\\partial I}{\\partial g} = \\frac{E_0 \\mu_0}{4\\pi(\\mu+\\mu_0)} \\omega_0 (1 - T(\\tau)) \\frac{\\partial P}{\\partial g}\n$$\nTo find $\\partial P/\\partial g$, we use the product and chain rules on $P(g) = (1-g^2)(1+g^2-2g\\cos\\Theta)^{-3/2}$. Let $C = \\cos\\Theta$.\n$$\n\\frac{\\partial P}{\\partial g} = (-2g)(1+g^2-2gC)^{-3/2} + (1-g^2)\\left(-\\frac{3}{2}\\right)(1+g^2-2gC)^{-5/2}(2g-2C)\n$$\n$$\n\\frac{\\partial P}{\\partial g} = (1+g^2-2gC)^{-5/2} \\left[ -2g(1+g^2-2gC) - 3(1-g^2)(g-C) \\right]\n$$\nExpanding the term in brackets:\n$$\n[-2g-2g^3+4g^2C] - [3(g-C-g^3+g^2C)] = -2g-2g^3+4g^2C - 3g+3C+3g^3-3g^2C\n$$\n$$\n= g^3 + g^2C - 5g + 3C\n$$\nThus, the derivative is:\n$$\n\\frac{\\partial P}{\\partial g} = \\frac{g^3 + g^2\\cos\\Theta - 5g + 3\\cos\\Theta}{(1+g^2-2g\\cos\\Theta)^{5/2}}\n$$\n\n### Part 2: Optimal Estimation Algorithmic Framework\n\nThe OE framework provides a method to find the most probable state vector $\\mathbf{x}$ given a set of measurements $\\mathbf{y}$, prior knowledge about the state $\\mathbf{x}_{\\text{a}}$, and their respective uncertainties.\n\nThe forward model $\\mathbf{F}(\\mathbf{x})$, which predicts measurements $\\mathbf{y}$ from a state $\\mathbf{x}$, is linearized around the prior state $\\mathbf{x}_{\\text{a}}$:\n$$\n\\mathbf{F}(\\mathbf{x}) \\approx \\mathbf{F}(\\mathbf{x}_{\\text{a}}) + \\mathbf{K}(\\mathbf{x} - \\mathbf{x}_{\\text{a}})\n$$\nwhere $\\mathbf{K} = \\partial \\mathbf{F} / \\partial \\mathbf{x}|_{\\mathbf{x}_{\\text{a}}}$ is the Jacobian matrix evaluated at the prior state. Each row $i$ of $\\mathbf{K}$ consists of the partial derivatives of the $i$-th measurement with respect to each state variable: $[\\partial I_i/\\partial\\tau, \\partial I_i/\\partial\\omega_0, \\partial I_i/\\partial g]$.\n\nThe problem provides the linear Bayesian update equation for the posterior mean state $\\hat{\\mathbf{x}}$:\n$$\n\\hat{\\mathbf{x}} = \\mathbf{x}_{\\text{a}} + \\mathbf{G}(\\mathbf{y} - \\mathbf{F}(\\mathbf{x}_{\\text{a}}))\n$$\nwhere $\\mathbf{y}$ is the measurement vector, $\\mathbf{F}(\\mathbf{x}_{\\text{a}})$ is the forward model evaluated at the prior, and $\\mathbf{G}$ is the gain matrix, which optimally blends the prior information with the measurement information. The gain matrix is defined as:\n$$\n\\mathbf{G} = \\mathbf{S}_{\\text{a}} \\mathbf{K}^T (\\mathbf{K}\\mathbf{S}_{\\text{a}}\\mathbf{K}^T + \\mathbf{S}_{\\text{e}})^{-1}\n$$\nHere, $\\mathbf{S}_{\\text{a}}$ is the prior error covariance matrix, and $\\mathbf{S}_{\\text{e}}$ is the measurement error covariance matrix.\n\nThe algorithm for each test case proceeds as follows:\n1.  **Synthesize Measurements**: The measurement vector $\\mathbf{y}$ is generated by evaluating the forward model $\\mathbf{F}$ at the \"true\" state $\\mathbf{x}_{\\text{true}}$. For each of the three specified geometries, we compute $I_i(\\mathbf{x}_{\\text{true}})$ to form the vector $\\mathbf{y} = [I_1, I_2, I_3]^T$. No noise is added.\n2.  **Evaluate at Prior**: The forward model is evaluated at the prior mean state $\\mathbf{x}_{\\text{a}}$ to produce the vector $\\mathbf{F}(\\mathbf{x}_{\\text{a}})$.\n3.  **Compute Jacobian**: The Jacobian matrix $\\mathbf{K}$ is computed. Each of its three rows corresponds to one of the measurement geometries. For each row $i$, the analytical derivatives $(\\partial I_i/\\partial\\tau, \\partial I_i/\\partial\\omega_0, \\partial I_i/\\partial g)$ are evaluated at the prior state $\\mathbf{x}_{\\text{a}}$.\n4.  **Compute Posterior State**: Using the computed $\\mathbf{y}$, $\\mathbf{F}(\\mathbf{x}_{\\text{a}})$, $\\mathbf{K}$, and the given $\\mathbf{S}_{\\text{a}}$ and $\\mathbf{S}_{\\text{e}}$, the gain matrix $\\mathbf{G}$ is calculated. This involves matrix-matrix multiplications and one matrix inversion. Finally, the posterior state $\\hat{\\mathbf{x}}$ is computed using the linear update formula.\n\nThis procedure is repeated for each of the three test cases provided. The implementation relies on numerical linear algebra libraries to perform the matrix operations.",
            "answer": "[[0.317502,0.952934,0.672314],[0.046187,0.983944,0.762888],[0.528434,0.844783,-0.165245]]"
        }
    ]
}