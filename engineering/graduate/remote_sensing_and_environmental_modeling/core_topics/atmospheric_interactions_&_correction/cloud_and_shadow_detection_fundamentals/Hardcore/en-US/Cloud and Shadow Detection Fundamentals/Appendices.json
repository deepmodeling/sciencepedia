{
    "hands_on_practices": [
        {
            "introduction": "Effective remote sensing begins with a solid understanding of the underlying physics. This exercise grounds you in the fundamental principles of shadow detection by exploring how the spectral quality of illumination changes in a shadow . By modeling the difference between direct sunlight and diffuse, blue-rich skylight, you will derive a physically-based shadow likelihood score, translating first principles of radiative transfer into a practical detection tool.",
            "id": "3801373",
            "problem": "A multispectral satellite pixel over a homogeneous vegetated canopy has been atmospherically corrected to surface reflectance, yielding measured blue-channel reflectance $\\rho_{\\mathrm{blue}} = 0.12$ and red-channel reflectance $\\rho_{\\mathrm{red}} = 0.06$. The pixel lies within a spatial context suspected to be in cast shadow, and the goal is to quantify a shadow-likelihood score from first principles using the blue-to-red reflectance ratio.\n\nAssume the following physical model and conditions:\n- The canopy behaves approximately as a Lambertian surface, so the top-of-canopy radiance $L_{\\lambda}$ relates to surface reflectance $\\rho_{\\lambda}$ and band-averaged downwelling irradiance $E_{\\lambda}$ via $L_{\\lambda} \\propto \\rho_{\\lambda} E_{\\lambda}$, with proportionality constants cancelling in channel ratios under equal geometry.\n- The measured reflectance ratio $r \\equiv \\rho_{\\mathrm{blue}} / \\rho_{\\mathrm{red}}$ is controlled by the product of the canopy’s intrinsic spectral reflectance ratio and the illumination’s spectral ratio, i.e., $r \\approx \\left(\\rho_{\\mathrm{blue}}^{\\mathrm{intr}} / \\rho_{\\mathrm{red}}^{\\mathrm{intr}}\\right)\\left(E_{\\mathrm{blue}} / E_{\\mathrm{red}}\\right)$, under negligible adjacency effects and equal bidirectional geometry.\n- For typical green vegetation in the visible bands, take the intrinsic reflectance ratio $\\gamma \\equiv \\rho_{\\mathrm{blue}}^{\\mathrm{intr}} / \\rho_{\\mathrm{red}}^{\\mathrm{intr}} = 1.3$, reflecting the similar chlorophyll absorption in blue and red with slightly higher blue reflectance.\n- Under direct-sun dominated illumination, use a representative band-averaged irradiance spectral ratio $\\alpha_{\\mathrm{sun}} \\equiv E_{\\mathrm{blue}} / E_{\\mathrm{red}} = 0.95$, consistent with a redder solar spectrum at the surface due to atmospheric scattering and absorption.\n- Under skylight-dominated shadow illumination on a clear-sky day, use $\\alpha_{\\mathrm{shad}} \\equiv E_{\\mathrm{blue}} / E_{\\mathrm{red}} = 1.8$, reflecting the blue-enriched diffuse sky.\n\nUsing these physically motivated quantities, define the expected blue-to-red reflectance ratios for sunlit vegetation as $r_{\\mathrm{sun}} \\equiv \\gamma \\alpha_{\\mathrm{sun}}$ and for shadowed vegetation as $r_{\\mathrm{shad}} \\equiv \\gamma \\alpha_{\\mathrm{shad}}$. Construct a shadow-likelihood score $S(r)$ that assigns $S=0$ to $r=r_{\\mathrm{sun}}$ and $S=1$ to $r=r_{\\mathrm{shad}}$, assuming a linear mapping in $r$ consistent with the above Lambertian and spectral-mixture assumptions. Then, for the given measurements, compute the score $S$ using the measured ratio $r = \\rho_{\\mathrm{blue}} / \\rho_{\\mathrm{red}}$.\n\nReport the final score as a dimensionless decimal rounded to four significant figures.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in the principles of radiative transfer and remote sensing, well-posed with all necessary information provided, and objective in its formulation. We will proceed with the solution.\n\nThe objective is to compute a shadow-likelihood score, $S$, for a vegetated pixel based on its measured blue and red channel surface reflectances. The score is to be derived from a linear model defined by theoretical sunlit and shadowed conditions.\n\nFirst, we calculate the measured blue-to-red reflectance ratio, $r$, from the given data:\nMeasured blue-channel reflectance, $\\rho_{\\mathrm{blue}} = 0.12$.\nMeasured red-channel reflectance, $\\rho_{\\mathrm{red}} = 0.06$.\n\nThe measured ratio $r$ is defined as:\n$$r = \\frac{\\rho_{\\mathrm{blue}}}{\\rho_{\\mathrm{red}}}$$\nSubstituting the given values:\n$$r = \\frac{0.12}{0.06} = 2.0$$\n\nNext, we calculate the theoretical reference ratios for a fully sunlit pixel, $r_{\\mathrm{sun}}$, and a fully shadowed pixel, $r_{\\mathrm{shad}}$. These are based on the provided physical models.\nThe expected ratio for sunlit vegetation is given by $r_{\\mathrm{sun}} = \\gamma \\alpha_{\\mathrm{sun}}$, where $\\gamma$ is the intrinsic reflectance ratio of the vegetation and $\\alpha_{\\mathrm{sun}}$ is the irradiance spectral ratio under direct sun.\nWe are given:\nIntrinsic reflectance ratio, $\\gamma = 1.3$.\nSunlit irradiance ratio, $\\alpha_{\\mathrm{sun}} = 0.95$.\nThus, the sunlit reference ratio is:\n$$r_{\\mathrm{sun}} = 1.3 \\times 0.95 = 1.235$$\n\nThe expected ratio for shadowed vegetation is given by $r_{\\mathrm{shad}} = \\gamma \\alpha_{\\mathrm{shad}}$, where $\\alpha_{\\mathrm{shad}}$ is the irradiance spectral ratio under skylight-dominated shadow.\nWe are given:\nShadowed irradiance ratio, $\\alpha_{\\mathrm{shad}} = 1.8$.\nThus, the shadowed reference ratio is:\n$$r_{\\mathrm{shad}} = 1.3 \\times 1.8 = 2.34$$\n\nThe shadow-likelihood score, $S(r)$, is defined as a linear function of $r$ that maps the sunlit condition to a score of $0$ and the shadowed condition to a score of $1$. That is, $S(r_{\\mathrm{sun}}) = 0$ and $S(r_{\\mathrm{shad}}) = 1$.\nLet the linear function be $S(r) = m \\cdot r + c$. We can determine the slope $m$ and intercept $c$ using the two conditions.\nThe slope $m$ is:\n$$m = \\frac{S(r_{\\mathrm{shad}}) - S(r_{\\mathrm{sun}})}{r_{\\mathrm{shad}} - r_{\\mathrm{sun}}} = \\frac{1 - 0}{r_{\\mathrm{shad}} - r_{\\mathrm{sun}}} = \\frac{1}{r_{\\mathrm{shad}} - r_{\\mathrm{sun}}}$$\nUsing the point-slope form with the point $(r_{\\mathrm{sun}}, 0)$:\n$$S(r) - S(r_{\\mathrm{sun}}) = m (r - r_{\\mathrm{sun}})$$\n$$S(r) - 0 = \\left(\\frac{1}{r_{\\mathrm{shad}} - r_{\\mathrm{sun}}}\\right) (r - r_{\\mathrm{sun}})$$\nThis gives the general formula for the score:\n$$S(r) = \\frac{r - r_{\\mathrm{sun}}}{r_{\\mathrm{shad}} - r_{\\mathrm{sun}}}$$\nThis equation represents a linear normalization of the measured ratio $r$ to the range $[0, 1]$ defined by the reference ratios $r_{\\mathrm{sun}}$ and $r_{\\mathrm{shad}}$.\n\nFinally, we substitute the calculated values of $r$, $r_{\\mathrm{sun}}$, and $r_{\\mathrm{shad}}$ into this expression to compute the score for the given pixel.\n$$S = \\frac{2.0 - 1.235}{2.34 - 1.235}$$\n$$S = \\frac{0.765}{1.105}$$\n$$S \\approx 0.6923076923...$$\n\nThe problem requires the result to be rounded to four significant figures.\n$$S \\approx 0.6923$$\nThis score indicates that the pixel's spectral signature is significantly closer to the pure shadow case ($S=1$) than the pure sunlit case ($S=0$), which is consistent with the initial suspicion that it lies in a cast shadow.",
            "answer": "$$\\boxed{0.6923}$$"
        },
        {
            "introduction": "Moving from physical principles to automated analysis requires a robust classification framework. This practice challenges you to design a statistically optimal classifier to distinguish between two notoriously difficult classes: clouds and snow . Using Bayesian decision theory and a multivariate Gaussian model, you will derive the explicit linear decision boundary in a multi-dimensional feature space and compute a pixel's geometric margin, providing a quantitative measure of classification confidence.",
            "id": "3801429",
            "problem": "A multispectral satellite pixel is characterized by three features used in cloud and snow discrimination: the Normalized Difference Snow Index (NDSI), blue-band surface reflectance, and short-wave infrared (SWIR) surface reflectance. The Normalized Difference Snow Index (NDSI) is defined as $ \\mathrm{NDSI} = \\frac{\\rho_{\\mathrm{green}} - \\rho_{\\mathrm{SWIR}}}{\\rho_{\\mathrm{green}} + \\rho_{\\mathrm{SWIR}}} $, where $ \\rho_{\\mathrm{green}} $ and $ \\rho_{\\mathrm{SWIR}} $ denote green and short-wave infrared reflectances, respectively. For this problem, you are provided the feature vector $ \\mathbf{x} = [\\mathrm{NDSI}, \\rho_{\\mathrm{blue}}, \\rho_{\\mathrm{SWIR}}]^{\\top} $ with values $ \\mathrm{NDSI} = 0.6 $, $ \\rho_{\\mathrm{blue}} = 0.8 $, and $ \\rho_{\\mathrm{SWIR}} = 0.1 $.\n\nAssume two classes: Snow ($\\mathcal{S}$) and Cloud ($\\mathcal{C}$). The class-conditional distributions of $ \\mathbf{x} $ are multivariate normal with equal isotropic covariance and equal priors:\n- $ \\mathbf{x} | \\mathcal{S} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{\\mathcal{S}}, \\sigma^{2} \\mathbf{I}) $,\n- $ \\mathbf{x} | \\mathcal{C} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{\\mathcal{C}}, \\sigma^{2} \\mathbf{I}) $,\n- $ \\mathbb{P}(\\mathcal{S}) = \\mathbb{P}(\\mathcal{C}) $,\n\nwith class means\n$ \\boldsymbol{\\mu}_{\\mathcal{S}} = [0.75, 0.85, 0.08]^{\\top} $ and $ \\boldsymbol{\\mu}_{\\mathcal{C}} = [0.25, 0.70, 0.25]^{\\top} $, and variance parameter $ \\sigma^{2} = 0.01 $.\n\nStarting from the Bayes decision rule and these Gaussian assumptions, derive the explicit linear decision boundary separating Snow and Cloud in the feature space. Define the signed geometric margin of the observed pixel to this boundary as the signed distance along the boundary’s normal vector that points from the Cloud mean toward the Snow mean. A positive margin indicates the Snow side, and a negative margin indicates the Cloud side.\n\nCompute the signed geometric margin for the given pixel with $ \\mathrm{NDSI} = 0.6 $, $ \\rho_{\\mathrm{blue}} = 0.8 $, and $ \\rho_{\\mathrm{SWIR}} = 0.1 $. Report only the signed geometric margin as a pure number (dimensionless). Round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It provides all necessary information to derive a unique solution based on established principles of Bayesian decision theory and multivariate statistics.\n\nThe task is to compute the signed geometric margin of a given pixel with feature vector $\\mathbf{x} = [\\mathrm{NDSI}, \\rho_{\\mathrm{blue}}, \\rho_{\\mathrm{SWIR}}]^{\\top}$ with respect to the decision boundary separating two classes, Snow ($\\mathcal{S}$) and Cloud ($\\mathcal{C}$).\n\nThe Bayes decision rule classifies a feature vector $\\mathbf{x}$ to the class with the highest posterior probability. We choose class $\\mathcal{S}$ if $\\mathbb{P}(\\mathcal{S} | \\mathbf{x})  \\mathbb{P}(\\mathcal{C} | \\mathbf{x})$ and class $\\mathcal{C}$ otherwise. Using Bayes' theorem, the posterior probability for a class $k$ is given by $\\mathbb{P}(k | \\mathbf{x}) = \\frac{p(\\mathbf{x} | k) \\mathbb{P}(k)}{p(\\mathbf{x})}$. The decision rule becomes:\n$$\np(\\mathbf{x} | \\mathcal{S}) \\mathbb{P}(\\mathcal{S})  p(\\mathbf{x} | \\mathcal{C}) \\mathbb{P}(\\mathcal{C})\n$$\nThe problem states that the priors are equal, $\\mathbb{P}(\\mathcal{S}) = \\mathbb{P}(\\mathcal{C})$, so they cancel out. The decision rule simplifies to comparing the class-conditional probability densities (likelihoods):\n$$\np(\\mathbf{x} | \\mathcal{S})  p(\\mathbf{x} | \\mathcal{C})\n$$\nIt is often more convenient to work with the logarithm of the likelihoods, as the logarithm is a strictly monotonic function. The rule is equivalent to:\n$$\n\\ln p(\\mathbf{x} | \\mathcal{S})  \\ln p(\\mathbf{x} | \\mathcal{C})\n$$\nThe class-conditional distributions are given as multivariate normal:\n$\\mathbf{x} | k \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{k}, \\sigma^{2} \\mathbf{I})$ for $k \\in \\{\\mathcal{S}, \\mathcal{C}\\}$.\nThe log-likelihood for a class $k$ is:\n$$\n\\ln p(\\mathbf{x} | k) = -\\frac{d}{2}\\ln(2\\pi) - \\frac{d}{2}\\ln(\\sigma^2) - \\frac{1}{2\\sigma^2} (\\mathbf{x} - \\boldsymbol{\\mu}_k)^{\\top} (\\mathbf{x} - \\boldsymbol{\\mu}_k)\n$$\nwhere $d=3$ is the dimensionality of the feature space.\n\nThe decision boundary is the set of points $\\mathbf{x}$ where the posterior probabilities are equal, which in this case means the log-likelihoods are equal:\n$$\n\\ln p(\\mathbf{x} | \\mathcal{S}) = \\ln p(\\mathbf{x} | \\mathcal{C})\n$$\n$$\n-\\frac{d}{2}\\ln(2\\pi) - \\frac{d}{2}\\ln(\\sigma^2) - \\frac{1}{2\\sigma^2} \\|\\mathbf{x} - \\boldsymbol{\\mu}_{\\mathcal{S}}\\|^2 = -\\frac{d}{2}\\ln(2\\pi) - \\frac{d}{2}\\ln(\\sigma^2) - \\frac{1}{2\\sigma^2} \\|\\mathbf{x} - \\boldsymbol{\\mu}_{\\mathcal{C}}\\|^2\n$$\nThe constant terms and the factor of $-\\frac{1}{2\\sigma^2}$ cancel, leaving:\n$$\n\\|\\mathbf{x} - \\boldsymbol{\\mu}_{\\mathcal{S}}\\|^2 = \\|\\mathbf{x} - \\boldsymbol{\\mu}_{\\mathcal{C}}\\|^2\n$$\n$$\n(\\mathbf{x} - \\boldsymbol{\\mu}_{\\mathcal{S}})^{\\top}(\\mathbf{x} - \\boldsymbol{\\mu}_{\\mathcal{S}}) = (\\mathbf{x} - \\boldsymbol{\\mu}_{\\mathcal{C}})^{\\top}(\\mathbf{x} - \\boldsymbol{\\mu}_{\\mathcal{C}})\n$$\nExpanding these terms:\n$$\n\\mathbf{x}^{\\top}\\mathbf{x} - 2\\boldsymbol{\\mu}_{\\mathcal{S}}^{\\top}\\mathbf{x} + \\boldsymbol{\\mu}_{\\mathcal{S}}^{\\top}\\boldsymbol{\\mu}_{\\mathcal{S}} = \\mathbf{x}^{\\top}\\mathbf{x} - 2\\boldsymbol{\\mu}_{\\mathcal{C}}^{\\top}\\mathbf{x} + \\boldsymbol{\\mu}_{\\mathcal{C}}^{\\top}\\boldsymbol{\\mu}_{\\mathcal{C}}\n$$\nThe quadratic term $\\mathbf{x}^{\\top}\\mathbf{x}$ cancels, which confirms the decision boundary is linear. Rearranging the terms, we get:\n$$\n2(\\boldsymbol{\\mu}_{\\mathcal{S}} - \\boldsymbol{\\mu}_{\\mathcal{C}})^{\\top}\\mathbf{x} - (\\boldsymbol{\\mu}_{\\mathcal{S}}^{\\top}\\boldsymbol{\\mu}_{\\mathcal{S}} - \\boldsymbol{\\mu}_{\\mathcal{C}}^{\\top}\\boldsymbol{\\mu}_{\\mathcal{C}}) = 0\n$$\nUsing the identity $\\boldsymbol{\\mu}_{\\mathcal{S}}^{\\top}\\boldsymbol{\\mu}_{\\mathcal{S}} - \\boldsymbol{\\mu}_{\\mathcal{C}}^{\\top}\\boldsymbol{\\mu}_{\\mathcal{C}} = (\\boldsymbol{\\mu}_{\\mathcal{S}} - \\boldsymbol{\\mu}_{\\mathcal{C}})^{\\top}(\\boldsymbol{\\mu}_{\\mathcal{S}} + \\boldsymbol{\\mu}_{\\mathcal{C}})$:\n$$\n2(\\boldsymbol{\\mu}_{\\mathcal{S}} - \\boldsymbol{\\mu}_{\\mathcal{C}})^{\\top}\\mathbf{x} - (\\boldsymbol{\\mu}_{\\mathcal{S}} - \\boldsymbol{\\mu}_{\\mathcal{C}})^{\\top}(\\boldsymbol{\\mu}_{\\mathcal{S}} + \\boldsymbol{\\mu}_{\\mathcal{C}}) = 0\n$$\n$$\n(\\boldsymbol{\\mu}_{\\mathcal{S}} - \\boldsymbol{\\mu}_{\\mathcal{C}})^{\\top} \\left( \\mathbf{x} - \\frac{\\boldsymbol{\\mu}_{\\mathcal{S}} + \\boldsymbol{\\mu}_{\\mathcal{C}}}{2} \\right) = 0\n$$\nThis is the equation of a hyperplane. Let $\\mathbf{w} = \\boldsymbol{\\mu}_{\\mathcal{S}} - \\boldsymbol{\\mu}_{\\mathcal{C}}$ be the normal vector to the hyperplane and $\\mathbf{x}_0 = \\frac{\\boldsymbol{\\mu}_{\\mathcal{S}} + \\boldsymbol{\\mu}_{\\mathcal{C}}}{2}$ be a point on the hyperplane (the midpoint of the class means). The equation is $\\mathbf{w}^{\\top}(\\mathbf{x} - \\mathbf{x}_0) = 0$. Note that the variance parameter $\\sigma^2$ is not needed to define the decision boundary because the covariances are identical for both classes.\n\nThe problem defines the signed geometric margin as the signed distance from the observed pixel $\\mathbf{x}_{pixel}$ to this boundary, along the normal vector pointing from the Cloud mean toward the Snow mean. This normal vector is precisely $\\mathbf{w} = \\boldsymbol{\\mu}_{\\mathcal{S}} - \\boldsymbol{\\mu}_{\\mathcal{C}}$. The signed geometric margin $m$ is given by the projection of the vector $(\\mathbf{x}_{pixel} - \\mathbf{x}_0)$ onto the unit normal vector $\\frac{\\mathbf{w}}{\\|\\mathbf{w}\\|}$:\n$$\nm = \\frac{\\mathbf{w}^{\\top}(\\mathbf{x}_{pixel} - \\mathbf{x}_0)}{\\|\\mathbf{w}\\|}\n$$\nThe given data are:\n$\\mathbf{x}_{pixel} = [0.6, 0.8, 0.1]^{\\top}$\n$\\boldsymbol{\\mu}_{\\mathcal{S}} = [0.75, 0.85, 0.08]^{\\top}$\n$\\boldsymbol{\\mu}_{\\mathcal{C}} = [0.25, 0.70, 0.25]^{\\top}$\n\nFirst, we compute the normal vector $\\mathbf{w}$:\n$$\n\\mathbf{w} = \\boldsymbol{\\mu}_{\\mathcal{S}} - \\boldsymbol{\\mu}_{\\mathcal{C}} = \\begin{pmatrix} 0.75 \\\\ 0.85 \\\\ 0.08 \\end{pmatrix} - \\begin{pmatrix} 0.25 \\\\ 0.70 \\\\ 0.25 \\end{pmatrix} = \\begin{pmatrix} 0.50 \\\\ 0.15 \\\\ -0.17 \\end{pmatrix}\n$$\nNext, we compute the point $\\mathbf{x}_0$ on the hyperplane:\n$$\n\\mathbf{x}_0 = \\frac{\\boldsymbol{\\mu}_{\\mathcal{S}} + \\boldsymbol{\\mu}_{\\mathcal{C}}}{2} = \\frac{1}{2} \\left( \\begin{pmatrix} 0.75 \\\\ 0.85 \\\\ 0.08 \\end{pmatrix} + \\begin{pmatrix} 0.25 \\\\ 0.70 \\\\ 0.25 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 1.00 \\\\ 1.55 \\\\ 0.33 \\end{pmatrix} = \\begin{pmatrix} 0.500 \\\\ 0.775 \\\\ 0.165 \\end{pmatrix}\n$$\nNow, we can compute the numerator of the margin expression, $\\mathbf{w}^{\\top}(\\mathbf{x}_{pixel} - \\mathbf{x}_0)$:\n$$\n\\mathbf{x}_{pixel} - \\mathbf{x}_0 = \\begin{pmatrix} 0.6 \\\\ 0.8 \\\\ 0.1 \\end{pmatrix} - \\begin{pmatrix} 0.500 \\\\ 0.775 \\\\ 0.165 \\end{pmatrix} = \\begin{pmatrix} 0.100 \\\\ 0.025 \\\\ -0.065 \\end{pmatrix}\n$$\n$$\n\\mathbf{w}^{\\top}(\\mathbf{x}_{pixel} - \\mathbf{x}_0) = \\begin{pmatrix} 0.50  0.15  -0.17 \\end{pmatrix} \\begin{pmatrix} 0.100 \\\\ 0.025 \\\\ -0.065 \\end{pmatrix}\n$$\n$$\n= (0.50)(0.100) + (0.15)(0.025) + (-0.17)(-0.065) = 0.05 + 0.00375 + 0.01105 = 0.0648\n$$\nNext, we compute the denominator, which is the magnitude of the normal vector, $\\|\\mathbf{w}\\|$:\n$$\n\\|\\mathbf{w}\\| = \\sqrt{0.50^2 + 0.15^2 + (-0.17)^2} = \\sqrt{0.25 + 0.0225 + 0.0289} = \\sqrt{0.3014}\n$$\nFinally, we compute the signed geometric margin $m$:\n$$\nm = \\frac{0.0648}{\\sqrt{0.3014}} \\approx 0.11803299\n$$\nRounding to four significant figures as requested, we get $m = 0.1180$. The positive sign indicates that the pixel is on the Snow side of the decision boundary.",
            "answer": "$$\\boxed{0.1180}$$"
        },
        {
            "introduction": "Real-world satellite imagery is rarely composed of pure pixels; instead, it contains mixtures of different surface types. This advanced exercise moves beyond binary classification to the quantitative estimation of subpixel cloud fraction ($f$) using a linear mixing model . Furthermore, it connects this estimate to the cloud's physical properties by modeling reflectance as a function of optical thickness ($\\tau$) and introduces first-order uncertainty propagation, a critical skill for assessing the reliability of remote sensing products.",
            "id": "3801428",
            "problem": "A nadir-viewing multispectral satellite observes a partly cloudy pixel in a visible band where anisotropy is weak enough to treat both the cloud field and the clear surface-atmosphere system as Lambertian. Let the Top-of-Atmosphere (TOA) reflectance, defined as $ \\rho_{\\mathrm{TOA}} = \\pi L / (E_{0} \\cos \\theta_{0}) $, be measured as $ \\rho_{\\mathrm{TOA}} = 0.4 $, where $ L $ is radiance at the sensor, $ E_{0} $ is extraterrestrial irradiance, and $ \\theta_{0} $ is solar zenith angle. The scene is modeled as a subpixel mixture of a cloudy portion with reflectance $ \\rho_{\\mathrm{cloud}} $ and a clear-sky portion with reflectance $ \\rho_{\\mathrm{clear}} $, with cloud fraction $ f $ and clear fraction $ 1-f $. The clear-sky TOA reflectance is independently characterized as $ \\rho_{\\mathrm{clear}} = 0.1 $, and the cloudy portion’s TOA reflectance under the present conditions is $ \\rho_{\\mathrm{cloud}} = 0.8 $. Using the physically standard assumption that radiances add linearly over area for independent components and that the mapping to reflectance is linear under fixed illumination, determine the subpixel cloud fraction $ f $.\n\nNext, assess the uncertainty in $ f $ arising from variability in cloud optical thickness $ \\tau $ under a physically motivated parameterization of cloudy reflectance. Assume the cloudy reflectance is governed by a semi-infinite approach parameterization,\n$$\n\\rho_{\\mathrm{cloud}}(\\tau) = \\rho_{\\infty}\\left(1 - \\exp(-\\beta \\tau)\\right),\n$$\nwith $ \\rho_{\\infty} = 0.9 $ and $ \\beta = 0.6 $. Let $ \\tau_{0} $ be the optical thickness at which $ \\rho_{\\mathrm{cloud}}(\\tau_{0}) = 0.8 $, and suppose the retrieved optical thickness has a standard uncertainty $ \\sigma_{\\tau} = 0.2 $. Using first-order (linear) uncertainty propagation with all other quantities treated as fixed, compute the standard uncertainty $ \\sigma_{f} $ in the cloud fraction $ f $.\n\nExpress both $ f $ and $ \\sigma_{f} $ as dimensionless numbers and round both to four significant figures. The final answer must contain both values together.",
            "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the principles of radiative transfer and remote sensing, well-posed with sufficient information for a unique solution, and formulated using objective and precise terminology. All provided numerical values are physically realistic. The problem is a standard application of linear mixture modeling and uncertainty analysis. Therefore, a solution will be formulated.\n\nThe problem is addressed in two parts: first, the determination of the subpixel cloud fraction $f$, and second, the estimation of the uncertainty in this fraction, $\\sigma_f$.\n\nPart 1: Calculation of the subpixel cloud fraction $f$.\n\nThe core physical model provided is the linear mixing model for the Top-of-Atmosphere (TOA) reflectance, $\\rho_{\\mathrm{TOA}}$. This model assumes that the total reflectance measured from a pixel is the area-weighted average of the reflectances of its constituent components. In this case, the components are a cloudy portion with fraction $f$ and reflectance $\\rho_{\\mathrm{cloud}}$, and a clear-sky portion with fraction $1-f$ and reflectance $\\rho_{\\mathrm{clear}}$. The assumption that radiances add linearly and that the mapping to reflectance is linear under fixed illumination leads to the following equation:\n$$\n\\rho_{\\mathrm{TOA}} = f \\rho_{\\mathrm{cloud}} + (1-f) \\rho_{\\mathrm{clear}}\n$$\nOur goal is to solve for the cloud fraction, $f$. We rearrange the equation algebraically:\n$$\n\\rho_{\\mathrm{TOA}} = f \\rho_{\\mathrm{cloud}} + \\rho_{\\mathrm{clear}} - f \\rho_{\\mathrm{clear}}\n$$\n$$\n\\rho_{\\mathrm{TOA}} - \\rho_{\\mathrm{clear}} = f (\\rho_{\\mathrm{cloud}} - \\rho_{\\mathrm{clear}})\n$$\nIsolating $f$ yields the expression for the cloud fraction in terms of the component reflectances:\n$$\nf = \\frac{\\rho_{\\mathrm{TOA}} - \\rho_{\\mathrm{clear}}}{\\rho_{\\mathrm{cloud}} - \\rho_{\\mathrm{clear}}}\n$$\nThe problem provides the following values for this part: $\\rho_{\\mathrm{TOA}} = 0.4$, $\\rho_{\\mathrm{clear}} = 0.1$, and $\\rho_{\\mathrm{cloud}} = 0.8$. Substituting these values into the expression for $f$:\n$$\nf = \\frac{0.4 - 0.1}{0.8 - 0.1} = \\frac{0.3}{0.7} = \\frac{3}{7}\n$$\nAs a decimal, this is $f \\approx 0.4285714$. Rounding to four significant figures as required, we get:\n$$\nf = 0.4286\n$$\n\nPart 2: Calculation of the uncertainty in the cloud fraction, $\\sigma_f$.\n\nThe uncertainty in $f$ arises from the uncertainty in the cloud optical thickness, $\\tau$. The problem specifies that the cloudy reflectance, $\\rho_{\\mathrm{cloud}}$, is a function of $\\tau$ given by the parameterization:\n$$\n\\rho_{\\mathrm{cloud}}(\\tau) = \\rho_{\\infty}\\left(1 - \\exp(-\\beta \\tau)\\right)\n$$\nwith constants $\\rho_{\\infty} = 0.9$ and $\\beta = 0.6$.\n\nThe cloud fraction $f$ is therefore also a function of $\\tau$:\n$$\nf(\\tau) = \\frac{\\rho_{\\mathrm{TOA}} - \\rho_{\\mathrm{clear}}}{\\rho_{\\mathrm{cloud}}(\\tau) - \\rho_{\\mathrm{clear}}}\n$$\nWe are asked to use first-order uncertainty propagation. For a function $f(\\tau)$, the standard uncertainty $\\sigma_f$ related to the standard uncertainty $\\sigma_\\tau$ is given by:\n$$\n\\sigma_f = \\left| \\frac{df}{d\\tau} \\right| \\sigma_\\tau\n$$\nThis derivative must be evaluated at the operating point, which is specified by $\\rho_{\\mathrm{cloud}}(\\tau_0) = 0.8$.\n\nFirst, we must compute the derivative $\\frac{df}{d\\tau}$. Using the chain rule:\n$$\n\\frac{df}{d\\tau} = \\frac{d}{d\\tau} \\left[ (\\rho_{\\mathrm{TOA}} - \\rho_{\\mathrm{clear}}) \\left( \\rho_{\\mathrm{cloud}}(\\tau) - \\rho_{\\mathrm{clear}} \\right)^{-1} \\right]\n$$\n$$\n\\frac{df}{d\\tau} = -(\\rho_{\\mathrm{TOA}} - \\rho_{\\mathrm{clear}}) \\left( \\rho_{\\mathrm{cloud}}(\\tau) - \\rho_{\\mathrm{clear}} \\right)^{-2} \\frac{d\\rho_{\\mathrm{cloud}}}{d\\tau}\n$$\nNext, we compute the derivative of $\\rho_{\\mathrm{cloud}}(\\tau)$:\n$$\n\\frac{d\\rho_{\\mathrm{cloud}}}{d\\tau} = \\frac{d}{d\\tau} \\left[ \\rho_{\\infty}\\left(1 - \\exp(-\\beta \\tau)\\right) \\right] = \\rho_{\\infty} \\left( - \\exp(-\\beta \\tau) \\cdot (-\\beta) \\right) = \\rho_{\\infty} \\beta \\exp(-\\beta \\tau)\n$$\nWe need to evaluate this derivative at $\\tau_0$, where $\\rho_{\\mathrm{cloud}}(\\tau_0) = 0.8$. We can express $\\exp(-\\beta \\tau_0)$ in terms of known quantities. From the cloud reflectance model:\n$$\n\\rho_{\\mathrm{cloud}}(\\tau_0) = \\rho_{\\infty}\\left(1 - \\exp(-\\beta \\tau_0)\\right)\n$$\n$$\n\\frac{\\rho_{\\mathrm{cloud}}(\\tau_0)}{\\rho_{\\infty}} = 1 - \\exp(-\\beta \\tau_0)\n$$\n$$\n\\exp(-\\beta \\tau_0) = 1 - \\frac{\\rho_{\\mathrm{cloud}}(\\tau_0)}{\\rho_{\\infty}}\n$$\nSubstituting this back into the expression for $\\frac{d\\rho_{\\mathrm{cloud}}}{d\\tau}$ at $\\tau_0$:\n$$\n\\left. \\frac{d\\rho_{\\mathrm{cloud}}}{d\\tau} \\right|_{\\tau=\\tau_0} = \\rho_{\\infty} \\beta \\left( 1 - \\frac{\\rho_{\\mathrm{cloud}}(\\tau_0)}{\\rho_{\\infty}} \\right) = \\beta (\\rho_{\\infty} - \\rho_{\\mathrm{cloud}}(\\tau_0))\n$$\nNow, we can assemble the full expression for $\\frac{df}{d\\tau}$ evaluated at $\\tau_0$:\n$$\n\\left. \\frac{df}{d\\tau} \\right|_{\\tau=\\tau_0} = - \\frac{\\rho_{\\mathrm{TOA}} - \\rho_{\\mathrm{clear}}}{(\\rho_{\\mathrm{cloud}}(\\tau_0) - \\rho_{\\mathrm{clear}})^2} \\cdot \\beta (\\rho_{\\infty} - \\rho_{\\mathrm{cloud}}(\\tau_0))\n$$\nWe substitute the given numerical values: $\\rho_{\\mathrm{TOA}} = 0.4$, $\\rho_{\\mathrm{clear}} = 0.1$, $\\rho_{\\mathrm{cloud}}(\\tau_0) = 0.8$, $\\rho_{\\infty} = 0.9$, and $\\beta = 0.6$:\n$$\n\\left. \\frac{df}{d\\tau} \\right|_{\\tau=\\tau_0} = - \\frac{0.4 - 0.1}{(0.8 - 0.1)^2} \\cdot 0.6 \\cdot (0.9 - 0.8)\n$$\n$$\n\\left. \\frac{df}{d\\tau} \\right|_{\\tau=\\tau_0} = - \\frac{0.3}{(0.7)^2} \\cdot 0.6 \\cdot (0.1) = - \\frac{0.3}{0.49} \\cdot 0.06 = - \\frac{0.018}{0.49}\n$$\nThis evaluates to approximately $-0.03673469$. The negative sign indicates, as expected, that for a fixed mixed-pixel reflectance $\\rho_{\\mathrm{TOA}}$, a higher cloud reflectance (from a higher $\\tau$) implies a smaller required cloud fraction $f$.\n\nFinally, we calculate the uncertainty $\\sigma_f$ using the provided standard uncertainty in optical thickness, $\\sigma_\\tau = 0.2$:\n$$\n\\sigma_f = \\left| \\left. \\frac{df}{d\\tau} \\right|_{\\tau=\\tau_0} \\right| \\sigma_\\tau = \\left| - \\frac{0.018}{0.49} \\right| \\cdot 0.2 \\approx 0.03673469 \\cdot 0.2 \\approx 0.007346938\n$$\nRounding to four significant figures, we get:\n$$\n\\sigma_f = 0.007347\n$$\nThe final results for the cloud fraction and its standard uncertainty are $f=0.4286$ and $\\sigma_f=0.007347$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4286  0.007347\n\\end{pmatrix}\n}\n$$"
        }
    ]
}