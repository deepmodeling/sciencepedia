{
    "hands_on_practices": [
        {
            "introduction": "Before we can model thermal emission, we must first understand its physical origin. The emissivity of a material is not an arbitrary property but is fundamentally determined by how electromagnetic waves interact with its surface, a process governed by its complex refractive index. This first practice  will guide you through calculating directional emissivity from first principles using the Fresnel equations, providing a crucial link between electromagnetic theory and practical remote sensing parameters.",
            "id": "3808376",
            "problem": "A thermal infrared remote sensing instrument observes a locally plane, optically smooth interface between air and an optically thick (opaque) dielectric surface at wavelength $10\\,\\mu\\mathrm{m}$. The dielectric has refractive index $n = 1.5$ and extinction coefficient $k \\approx 0$ at this wavelength. Assume the incident medium is air with refractive index $n_{1} \\approx 1.0$, the material is non-magnetic with relative permeability approximately unity, and the interface is in local thermodynamic equilibrium so that Kirchhoff’s law of thermal radiation applies.\n\nDirectional emissivity $\\epsilon(\\theta)$ is defined as the directional absorptivity in the emission direction, and for an opaque interface with zero transmission it satisfies $\\epsilon(\\theta) = 1 - R(\\theta)$, where $R(\\theta)$ is the directional reflectance at incidence angle $\\theta$. For unpolarized illumination, take $R(\\theta)$ to be the arithmetic mean of the reflectances for the two linear polarizations: $R(\\theta) = \\left(R_{s}(\\theta) + R_{p}(\\theta)\\right)/2$, where $R_{s}$ and $R_{p}$ denote the reflectance for the electric field perpendicular and parallel to the plane of incidence, respectively.\n\nStarting from fundamental electromagnetic boundary conditions at a planar interface, Snell’s law, and the definitions above, compute the directional emissivity $\\epsilon(\\theta)$ at normal incidence $\\theta = 0^\\circ$ and at $\\theta = 60^\\circ$ under the assumptions given. Express both emissivities as dimensionless numbers and round your answers to four significant figures. Angles are in degrees.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n- Wavelength of observation: $10\\,\\mu\\mathrm{m}$.\n- Interface: Locally plane, optically smooth, between air and an optically thick (opaque) dielectric.\n- Refractive index of the dielectric (medium 2): $n = n_2 = 1.5$.\n- Extinction coefficient of the dielectric: $k \\approx 0$.\n- Refractive index of the incident medium (air, medium 1): $n_1 \\approx 1.0$.\n- Magnetic properties: Material is non-magnetic, relative permeability is approximately unity.\n- Thermodynamic state: Local thermodynamic equilibrium, Kirchhoff's law applies.\n- Relation for directional emissivity for an opaque material: $\\epsilon(\\theta) = 1 - R(\\theta)$, where $R(\\theta)$ is the directional reflectance.\n- Reflectance for unpolarized light: $R(\\theta) = \\frac{1}{2}(R_s(\\theta) + R_p(\\theta))$, where $R_s$ and $R_p$ are the reflectances for s- and p-polarization.\n- Angles for computation: $\\theta = 0^\\circ$ (normal incidence) and $\\theta = 60^\\circ$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, drawing upon fundamental principles of electromagnetism (Fresnel's equations), optics (Snell's law), and thermodynamics (Kirchhoff's law). The given physical parameters ($n_1 = 1.0$, $n_2 = 1.5$, $k=0$) are realistic for a transparent dielectric such as glass in the thermal infrared region. The problem is well-posed, providing all necessary information to derive a unique, quantitative solution. The language is objective and precise. No flaws related to scientific soundness, completeness, consistency, or feasibility are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will now be derived.\n\nThe solution requires the calculation of directional emissivity, $\\epsilon(\\theta)$, which is related to the directional-hemispherical reflectance, $R(\\theta)$, for an opaque material by Kirchhoff's law:\n$$ \\epsilon(\\theta) = 1 - R(\\theta) $$\nThe reflectance for unpolarized radiation is the average of the reflectances for s-polarization ($R_s$) and p-polarization ($R_p$):\n$$ R(\\theta) = \\frac{R_s(\\theta) + R_p(\\theta)}{2} $$\nThe reflectances $R_s$ and $R_p$ are given by the Fresnel equations, which are derived from the boundary conditions for the electric and magnetic fields at a planar interface between two media. For non-magnetic media with real refractive indices $n_1$ and $n_2$, they are:\n$$ R_s(\\theta_1) = \\left( \\frac{n_1 \\cos(\\theta_1) - n_2 \\cos(\\theta_2)}{n_1 \\cos(\\theta_1) + n_2 \\cos(\\theta_2)} \\right)^2 $$\n$$ R_p(\\theta_1) = \\left( \\frac{n_2 \\cos(\\theta_1) - n_1 \\cos(\\theta_2)}{n_2 \\cos(\\theta_1) + n_1 \\cos(\\theta_2)} \\right)^2 $$\nHere, $\\theta_1$ is the angle of incidence in medium 1 (air), and $\\theta_2$ is the angle of refraction in medium 2 (dielectric). The angles are related by Snell's law:\n$$ n_1 \\sin(\\theta_1) = n_2 \\sin(\\theta_2) $$\nThe problem provides $n_1 = 1.0$ and $n_2 = 1.5$. We will compute the emissivity for the two specified angles of incidence.\n\n**Case 1: Normal Incidence ($\\theta_1 = 0^\\circ$)**\nAt normal incidence, the angle of incidence is $\\theta_1 = 0^\\circ$. From Snell's law:\n$$ 1.0 \\sin(0^\\circ) = 1.5 \\sin(\\theta_2) \\implies \\sin(\\theta_2) = 0 \\implies \\theta_2 = 0^\\circ $$\nTherefore, $\\cos(\\theta_1) = \\cos(0^\\circ) = 1$ and $\\cos(\\theta_2) = \\cos(0^\\circ) = 1$.\nThe distinction between s- and p-polarization vanishes at normal incidence. The Fresnel equations become identical:\n$$ R_s(0^\\circ) = \\left( \\frac{n_1 - n_2}{n_1 + n_2} \\right)^2 $$\n$$ R_p(0^\\circ) = \\left( \\frac{n_2 - n_1}{n_2 + n_1} \\right)^2 = \\left( \\frac{n_1 - n_2}{n_1 + n_2} \\right)^2 $$\nThe total reflectance is:\n$$ R(0^\\circ) = \\frac{R_s(0^\\circ) + R_p(0^\\circ)}{2} = R_s(0^\\circ) = \\left( \\frac{n_1 - n_2}{n_1 + n_2} \\right)^2 $$\nSubstituting the given values:\n$$ R(0^\\circ) = \\left( \\frac{1.0 - 1.5}{1.0 + 1.5} \\right)^2 = \\left( \\frac{-0.5}{2.5} \\right)^2 = \\left( -\\frac{1}{5} \\right)^2 = \\frac{1}{25} = 0.04 $$\nThe directional emissivity at normal incidence is:\n$$ \\epsilon(0^\\circ) = 1 - R(0^\\circ) = 1 - 0.04 = 0.96 $$\nTo four significant figures, this is $0.9600$.\n\n**Case 2: Oblique Incidence ($\\theta_1 = 60^\\circ$)**\nThe angle of incidence is $\\theta_1 = 60^\\circ$. First, we find the angle of refraction $\\theta_2$ using Snell's law:\n$$ n_1 \\sin(\\theta_1) = n_2 \\sin(\\theta_2) $$\n$$ 1.0 \\sin(60^\\circ) = 1.5 \\sin(\\theta_2) $$\n$$ \\sin(\\theta_2) = \\frac{\\sin(60^\\circ)}{1.5} = \\frac{\\sqrt{3}/2}{3/2} = \\frac{\\sqrt{3}}{3} $$\nWe need the cosines of both angles.\n$$ \\cos(\\theta_1) = \\cos(60^\\circ) = \\frac{1}{2} $$\n$$ \\cos(\\theta_2) = \\sqrt{1 - \\sin^2(\\theta_2)} = \\sqrt{1 - \\left(\\frac{\\sqrt{3}}{3}\\right)^2} = \\sqrt{1 - \\frac{3}{9}} = \\sqrt{\\frac{6}{9}} = \\frac{\\sqrt{6}}{3} $$\nNow we compute the reflectances $R_s$ and $R_p$.\nFor s-polarization:\n$$ R_s(60^\\circ) = \\left( \\frac{n_1 \\cos(\\theta_1) - n_2 \\cos(\\theta_2)}{n_1 \\cos(\\theta_1) + n_2 \\cos(\\theta_2)} \\right)^2 = \\left( \\frac{1.0(\\frac{1}{2}) - 1.5(\\frac{\\sqrt{6}}{3})}{1.0(\\frac{1}{2}) + 1.5(\\frac{\\sqrt{6}}{3})} \\right)^2 $$\n$$ R_s(60^\\circ) = \\left( \\frac{0.5 - 0.5\\sqrt{6}}{0.5 + 0.5\\sqrt{6}} \\right)^2 = \\left( \\frac{1 - \\sqrt{6}}{1 + \\sqrt{6}} \\right)^2 $$\nNumerically, $R_s(60^\\circ) \\approx \\left( \\frac{1 - 2.44949}{1 + 2.44949} \\right)^2 \\approx (-0.42019)^2 \\approx 0.176562 $\n\nFor p-polarization:\n$$ R_p(60^\\circ) = \\left( \\frac{n_2 \\cos(\\theta_1) - n_1 \\cos(\\theta_2)}{n_2 \\cos(\\theta_1) + n_1 \\cos(\\theta_2)} \\right)^2 = \\left( \\frac{1.5(\\frac{1}{2}) - 1.0(\\frac{\\sqrt{6}}{3})}{1.5(\\frac{1}{2}) + 1.0(\\frac{\\sqrt{6}}{3})} \\right)^2 $$\n$$ R_p(60^\\circ) = \\left( \\frac{0.75 - \\frac{\\sqrt{6}}{3}}{0.75 + \\frac{\\sqrt{6}}{3}} \\right)^2 $$\nNumerically, $R_p(60^\\circ) \\approx \\left( \\frac{0.75 - 0.816497}{0.75 + 0.816497} \\right)^2 \\approx (-0.042449)^2 \\approx 0.0018019 $\n\nThe total reflectance for unpolarized light is the average:\n$$ R(60^\\circ) = \\frac{R_s(60^\\circ) + R_p(60^\\circ)}{2} \\approx \\frac{0.176562 + 0.0018019}{2} = \\frac{0.1783639}{2} \\approx 0.089182 $$\nThe directional emissivity at $60^\\circ$ is:\n$$ \\epsilon(60^\\circ) = 1 - R(60^\\circ) \\approx 1 - 0.089182 = 0.910818 $$\nRounding to four significant figures, this is $0.9108$.\n\nThe calculated emissivities are $\\epsilon(0^\\circ) = 0.9600$ and $\\epsilon(60^\\circ) = 0.9108$.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 0.9600  0.9108 \\end{pmatrix}} $$"
        },
        {
            "introduction": "Real-world surfaces are often mixtures of different components within a single sensor's field of view. A common pitfall in modeling these heterogeneous pixels is to linearly average emissivity and temperature before applying Planck's law, which ignores the law's inherent non-linearity. This computational exercise  demonstrates the physically correct method of mixing radiances and allows you to quantify the significant errors that can result from this incorrect shortcut, a vital lesson in rigorous model formulation.",
            "id": "3808391",
            "problem": "You are given a synthetic thermal infrared pixel that is a sub-pixel mixture of two materials with distinct wavelength-dependent emissivities and different physical temperatures. The objective is to quantify the error introduced by assuming linear mixing of emissivity and a linearly averaged temperature, rather than mixing radiances, by comparing two retrievals of the pixel’s spectral radiance and the associated brightness temperatures. All computations must be based on first principles of thermal radiation.\n\nUse the following foundational definitions and assumptions:\n1. The spectral radiance of an ideal blackbody at wavelength $\\lambda$ and temperature $T$ is given by Planck’s law in wavelength form,\n$$\nB_{\\lambda}(\\lambda,T) = \\frac{2 h c^2}{\\lambda^5} \\left( \\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1 \\right)^{-1},\n$$\nwhere $h$ is Planck’s constant, $c$ is the speed of light in vacuum, and $k_{\\mathrm{B}}$ is Boltzmann’s constant. The units of $B_{\\lambda}$ are $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{sr}^{-1}$.\n\n2. The directional hemispherical emissivity $\\varepsilon(\\lambda)$ of a material at wavelength $\\lambda$ is a dimensionless multiplier ($0 \\le \\varepsilon(\\lambda) \\le 1$) that scales the blackbody spectral radiance to produce the material’s spectral radiance:\n$$\nL_{\\lambda}(\\lambda,T) = \\varepsilon(\\lambda)\\, B_{\\lambda}(\\lambda,T).\n$$\n\n3. For a sub-pixel mixture of two materials that occupy fractional areas $f$ and $1-f$, and temperatures $T_1$ and $T_2$, the physically correct observed spectral radiance under the assumption of no atmospheric effects and linear areal mixing is\n$$\nL_{\\lambda}^{\\mathrm{corr}}(\\lambda) = f\\, \\varepsilon_1(\\lambda)\\, B_{\\lambda}(\\lambda,T_1) + (1-f)\\, \\varepsilon_2(\\lambda)\\, B_{\\lambda}(\\lambda,T_2).\n$$\n\n4. A common but incorrect modeling assumption for heterogeneous pixels is to linearly mix emissivities and linearly average temperatures first, then apply Planck’s law once:\n$$\n\\varepsilon_{\\mathrm{mix}}(\\lambda) = f\\, \\varepsilon_1(\\lambda) + (1-f)\\, \\varepsilon_2(\\lambda),\n\\quad\nT_{\\mathrm{m}} = f\\, T_1 + (1-f)\\, T_2,\n$$\nand\n$$\nL_{\\lambda}^{\\mathrm{wrong}}(\\lambda) = \\varepsilon_{\\mathrm{mix}}(\\lambda)\\, B_{\\lambda}(\\lambda, T_{\\mathrm{m}}).\n$$\n\n5. The brightness temperature at a given wavelength $\\lambda$ associated with a spectral radiance $L_{\\lambda}$ (assuming unit emissivity for inversion) is defined as the temperature that satisfies $B_{\\lambda}(\\lambda,T_{\\mathrm{b}}) = L_{\\lambda}(\\lambda)$. Inverting Planck’s law yields\n$$\nT_{\\mathrm{b}}(\\lambda; L_{\\lambda}) = \\frac{h c}{\\lambda k_{\\mathrm{B}}} \\left[ \\ln\\!\\left(1 + \\frac{2 h c^2}{\\lambda^5\\, L_{\\lambda}(\\lambda)}\\right) \\right]^{-1}.\n$$\n\nYour task:\n- Implement both models, $L_{\\lambda}^{\\mathrm{corr}}(\\lambda)$ and $L_{\\lambda}^{\\mathrm{wrong}}(\\lambda)$, for a set of thermal infrared wavelengths and a pair of materials with strong spectral contrast in emissivity.\n- For each test case, compute two quantitative metrics:\n  1. The root-mean-square error in spectral radiance over the wavelength set,\n     $$\n     R = \\sqrt{\\frac{1}{N} \\sum_{j=1}^{N} \\left(L_{\\lambda}^{\\mathrm{wrong}}(\\lambda_j) - L_{\\lambda}^{\\mathrm{corr}}(\\lambda_j)\\right)^2},\n     $$\n     expressed in $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{sr}^{-1}$.\n  2. The average brightness temperature difference,\n     $$\n     \\Delta T = \\frac{1}{N} \\sum_{j=1}^{N} \\left( T_{\\mathrm{b}}(\\lambda_j; L_{\\lambda}^{\\mathrm{wrong}}) - T_{\\mathrm{b}}(\\lambda_j; L_{\\lambda}^{\\mathrm{corr}}) \\right),\n     $$\n     expressed in $\\mathrm{K}$.\n\nUse the following spectral and material parameters for all test cases:\n- Wavelengths: $\\lambda \\in \\{8.5 \\times 10^{-6},\\, 10.5 \\times 10^{-6},\\, 12.0 \\times 10^{-6}\\}$ $\\mathrm{m}$.\n- Material $1$ emissivities: $\\varepsilon_1(\\lambda) \\in \\{0.75,\\, 0.95,\\, 0.92\\}$ aligned with the above wavelengths.\n- Material $2$ emissivities: $\\varepsilon_2(\\lambda) \\in \\{0.95,\\, 0.80,\\, 0.88\\}$ aligned with the above wavelengths.\n\nTest suite:\n- Case $1$ (general heterogeneous case with strong contrast): $f = 0.5$, $T_1 = 320\\,\\mathrm{K}$, $T_2 = 300\\,\\mathrm{K}$.\n- Case $2$ (minor fraction of hotter material): $f = 0.1$, $T_1 = 330\\,\\mathrm{K}$, $T_2 = 295\\,\\mathrm{K}$.\n- Case $3$ (weak thermal contrast, moderate mixing): $f = 0.5$, $T_1 = 305\\,\\mathrm{K}$, $T_2 = 300\\,\\mathrm{K}$.\n- Case $4$ (isothermal mixture boundary): $f = 0.5$, $T_1 = 310\\,\\mathrm{K}$, $T_2 = 310\\,\\mathrm{K}$.\n- Case $5$ (pure material boundary, material $2$ only): $f = 0.0$, $T_1 = 315\\,\\mathrm{K}$, $T_2 = 295\\,\\mathrm{K}$.\n- Case $6$ (pure material boundary, material $1$ only): $f = 1.0$, $T_1 = 315\\,\\mathrm{K}$, $T_2 = 295\\,\\mathrm{K}$.\n\nOutput requirements:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result must be a two-element list $[R, \\Delta T]$, where $R$ is in $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{sr}^{-1}$ and $\\Delta T$ is in $\\mathrm{K}$, both represented as floating-point numbers. For example, the final output format must look like\n$$\n[[R_1,\\Delta T_1],[R_2,\\Delta T_2],\\dots,[R_6,\\Delta T_6]].\n$$",
            "solution": "We begin from first principles of thermal radiation. The synthetic pixel comprises two materials with emissivities $\\varepsilon_1(\\lambda)$ and $\\varepsilon_2(\\lambda)$, occupying fractional areas $f$ and $1-f$, at temperatures $T_1$ and $T_2$. The physically correct mixed spectral radiance for the pixel under the assumptions of linear areal mixing and negligible atmospheric effects is the linear combination of component radiances,\n$$\nL_{\\lambda}^{\\mathrm{corr}}(\\lambda) = f\\, \\varepsilon_1(\\lambda)\\, B_{\\lambda}(\\lambda, T_1) + (1-f)\\, \\varepsilon_2(\\lambda)\\, B_{\\lambda}(\\lambda, T_2).\n$$\nThis is justified because radiance is an extensive quantity over area under the linear mixing model: each component contributes its emissive power proportionally to its areal fraction, and radiance superposes linearly.\n\nThe erroneous approach commonly made is to mix emissivities first and linearly average temperatures, then apply Planck’s law once. Specifically, define\n$$\n\\varepsilon_{\\mathrm{mix}}(\\lambda) = f\\, \\varepsilon_1(\\lambda) + (1-f)\\, \\varepsilon_2(\\lambda),\n\\quad\nT_{\\mathrm{m}} = f\\, T_1 + (1-f)\\, T_2,\n$$\nand compute\n$$\nL_{\\lambda}^{\\mathrm{wrong}}(\\lambda) = \\varepsilon_{\\mathrm{mix}}(\\lambda)\\, B_{\\lambda}(\\lambda, T_{\\mathrm{m}}).\n$$\nThis procedure is not physically consistent when $T_1 \\neq T_2$, because Planck’s law is non-linear in temperature: $B_{\\lambda}(\\lambda, \\cdot)$ is not a linear operator, so $B_{\\lambda}(\\lambda, f T_1 + (1-f) T_2) \\neq f B_{\\lambda}(\\lambda, T_1) + (1-f) B_{\\lambda}(\\lambda, T_2)$.\n\nTo quantify the error, we define two metrics.\n\nFirst, the root-mean-square error in spectral radiance across the $N$ wavelengths $\\{\\lambda_j\\}_{j=1}^N$,\n$$\nR = \\sqrt{\\frac{1}{N} \\sum_{j=1}^{N} \\left( L_{\\lambda}^{\\mathrm{wrong}}(\\lambda_j) - L_{\\lambda}^{\\mathrm{corr}}(\\lambda_j) \\right)^2 }.\n$$\nThis is expressed in $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{sr}^{-1}$, consistent with the units of $B_{\\lambda}$.\n\nSecond, we measure the induced bias in brightness temperatures. The brightness temperature at wavelength $\\lambda$ for a measured spectral radiance $L_{\\lambda}(\\lambda)$ is the temperature $T_{\\mathrm{b}}$ that satisfies $B_{\\lambda}(\\lambda,T_{\\mathrm{b}}) = L_{\\lambda}(\\lambda)$. Inverting Planck’s law yields\n$$\nT_{\\mathrm{b}}(\\lambda; L_{\\lambda}) = \\frac{h c}{\\lambda k_{\\mathrm{B}}} \\left[ \\ln\\!\\left(1 + \\frac{2 h c^2}{\\lambda^5\\, L_{\\lambda}(\\lambda)}\\right) \\right]^{-1}.\n$$\nThis inversion assumes unit emissivity for the purpose of mapping radiance to temperature (a standard definition of brightness temperature). We compute $T_{\\mathrm{b}}(\\lambda_j; L_{\\lambda}^{\\mathrm{wrong}})$ and $T_{\\mathrm{b}}(\\lambda_j; L_{\\lambda}^{\\mathrm{corr}})$ at each wavelength and define\n$$\n\\Delta T = \\frac{1}{N} \\sum_{j=1}^{N} \\left( T_{\\mathrm{b}}(\\lambda_j; L_{\\lambda}^{\\mathrm{wrong}}) - T_{\\mathrm{b}}(\\lambda_j; L_{\\lambda}^{\\mathrm{corr}}) \\right),\n$$\nin $\\mathrm{K}$. This average captures the systematic bias induced across the spectral window.\n\nAlgorithmic steps:\n1. Define the wavelength grid $\\lambda \\in \\{8.5 \\times 10^{-6},\\, 10.5 \\times 10^{-6},\\, 12.0 \\times 10^{-6}\\}$ $\\mathrm{m}$ with $N=3$.\n2. Specify emissivity spectra with strong spectral contrast: $\\varepsilon_1(\\lambda) \\in \\{0.75,\\, 0.95,\\, 0.92\\}$ and $\\varepsilon_2(\\lambda) \\in \\{0.95,\\, 0.80,\\, 0.88\\}$ aligned to the wavelength grid.\n3. For each test case, set $f$, $T_1$, and $T_2$ per the test suite.\n4. Compute $L_{\\lambda}^{\\mathrm{corr}}(\\lambda_j)$ using the radiance mixing formula.\n5. Compute $\\varepsilon_{\\mathrm{mix}}(\\lambda_j)$ and $T_{\\mathrm{m}}$, then $L_{\\lambda}^{\\mathrm{wrong}}(\\lambda_j)$.\n6. Compute $R$ via the defined root-mean-square error between $L_{\\lambda}^{\\mathrm{wrong}}$ and $L_{\\lambda}^{\\mathrm{corr}}$.\n7. Invert Planck’s law to obtain $T_{\\mathrm{b}}(\\lambda_j; L_{\\lambda}^{\\mathrm{corr}})$ and $T_{\\mathrm{b}}(\\lambda_j; L_{\\lambda}^{\\mathrm{wrong}})$ for all $j$, then compute $\\Delta T$ as the average difference.\n8. Output for each test case the pair $[R, \\Delta T]$.\n\nSanity checks and boundary behavior:\n- If $T_1 = T_2$, then $T_{\\mathrm{m}} = T_1 = T_2$ and $L_{\\lambda}^{\\mathrm{wrong}}(\\lambda) = L_{\\lambda}^{\\mathrm{corr}}(\\lambda)$ for all $\\lambda$, yielding $R = 0$ and $\\Delta T = 0$.\n- If $f \\in \\{0,1\\}$, the pixel is pure material $2$ or $1$ respectively, so both models coincide exactly; again $R = 0$ and $\\Delta T = 0$.\n- For heterogeneous thermal mixtures ($T_1 \\neq T_2$) with strong spectral emissivity contrast across wavelengths, $R > 0$ and $\\Delta T \\neq 0$ are expected due to nonlinearity in $B_{\\lambda}(\\lambda,T)$.\n\nThe implementation directly encodes these steps using stable closed-form expressions for $B_{\\lambda}$ and the inverse brightness temperature, ensuring numerical robustness across the thermal infrared wavelengths provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nh = 6.62607015e-34       # Planck constant [J*s]\nc = 299792458.0          # Speed of light [m/s]\nkB = 1.380649e-23        # Boltzmann constant [J/K]\n\ndef planck_radiance_lambda(wavelength_m, T_K):\n    \"\"\"\n    Spectral radiance in wavelength form B_lambda(λ,T)\n    Units: W m^-3 sr^-1\n    \"\"\"\n    lam = wavelength_m\n    # Avoid division by zero or negative temperatures\n    if T_K = 0:\n        return np.inf\n    term1 = 2.0 * h * c**2 / lam**5\n    exponent = h * c / (lam * kB * T_K)\n    # Use exp safely; exponent is positive\n    denom = np.exp(exponent) - 1.0\n    return term1 / denom\n\ndef invert_planck_lambda(L_lambda, wavelength_m):\n    \"\"\"\n    Invert Planck law to get brightness temperature T_b from spectral radiance L_lambda at wavelength.\n    Assumes unit emissivity for inversion.\n    Formula: T = (h c)/(λ kB) * [ ln( 1 + (2 h c^2)/(λ^5 L) ) ]^{-1}\n    \"\"\"\n    lam = wavelength_m\n    # Ensure positive radiance\n    if L_lambda = 0:\n        return 0.0\n    inside = 1.0 + (2.0 * h * c**2) / (lam**5 * L_lambda)\n    # Numerical safety: inside must be  1, otherwise temperature - inf\n    if inside = 1.0:\n        return np.inf\n    return (h * c) / (lam * kB) / np.log(inside)\n\ndef solve():\n    # Wavelengths in meters\n    wavelengths = np.array([8.5e-6, 10.5e-6, 12.0e-6], dtype=float)\n\n    # Emissivity spectra aligned to wavelengths\n    eps1 = np.array([0.75, 0.95, 0.92], dtype=float)  # material 1\n    eps2 = np.array([0.95, 0.80, 0.88], dtype=float)  # material 2\n\n    # Define the test cases: (f, T1[K], T2[K])\n    test_cases = [\n        (0.5, 320.0, 300.0),  # Case 1: general heterogeneous\n        (0.1, 330.0, 295.0),  # Case 2: minor fraction hotter\n        (0.5, 305.0, 300.0),  # Case 3: weak thermal contrast\n        (0.5, 310.0, 310.0),  # Case 4: isothermal mixture\n        (0.0, 315.0, 295.0),  # Case 5: pure material 2\n        (1.0, 315.0, 295.0),  # Case 6: pure material 1\n    ]\n\n    results = []\n    for f, T1, T2 in test_cases:\n        # Correct radiance mixing\n        L_corr = np.array([\n            f * eps1[j] * planck_radiance_lambda(wavelengths[j], T1) +\n            (1.0 - f) * eps2[j] * planck_radiance_lambda(wavelengths[j], T2)\n            for j in range(wavelengths.size)\n        ], dtype=float)\n\n        # Wrong approach: mix emissivities and average temperature linearly, then apply Planck once\n        eps_mix = f * eps1 + (1.0 - f) * eps2\n        T_m = f * T1 + (1.0 - f) * T2\n        L_wrong = np.array([\n            eps_mix[j] * planck_radiance_lambda(wavelengths[j], T_m)\n            for j in range(wavelengths.size)\n        ], dtype=float)\n\n        # Radiance RMSE\n        rmse_radiance = float(np.sqrt(np.mean((L_wrong - L_corr) ** 2)))\n\n        # Brightness temperatures (assuming unit emissivity for inversion)\n        Tb_corr = np.array([invert_planck_lambda(L_corr[j], wavelengths[j]) for j in range(wavelengths.size)], dtype=float)\n        Tb_wrong = np.array([invert_planck_lambda(L_wrong[j], wavelengths[j]) for j in range(wavelengths.size)], dtype=float)\n\n        # Average brightness temperature difference\n        delta_T = float(np.mean(Tb_wrong - Tb_corr))\n\n        results.append([rmse_radiance, delta_T])\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from static properties to dynamic processes, thermal inertia describes a material's resistance to temperature changes and is a key parameter in geology, hydrology, and climate science. This property can be retrieved by combining remotely sensed surface temperatures with a physical model of heat conduction. This final practice  provides a capstone exercise where you will develop an algorithm to invert for thermal inertia from diurnal temperature data, demonstrating how emissivity serves as a critical input for deriving more advanced geophysical products and assessing model sensitivity.",
            "id": "3808380",
            "problem": "Consider a horizontally uniform, semi-infinite solid representing an Earth surface pixel observed by thermal infrared remote sensing. The diurnal surface energy balance at the surface is given by the simplified form $R_n(t) = H(t) + LE(t) + G(t)$, where $R_n(t)$ is net radiation, $H(t)$ is the sensible heat flux, $LE(t)$ is the latent heat flux, and $G(t)$ is the ground (conductive) heat flux into the substrate. Assume that over a clear day the diurnal cycle of net radiation can be approximated as a sinusoid with period $\\tau$ and angular frequency $\\omega = 2\\pi/\\tau$, and that a fixed fraction $f_G$ of net radiation is conducted into the ground so that $G(t) = f_G R_n(t)$. Midday and pre-dawn correspond approximately to the peak and trough of the diurnal cycle.\n\nLet the material be a homogeneous, semi-infinite medium with thermal inertia $I = \\sqrt{k \\rho c}$, where $k$ is thermal conductivity, $\\rho$ is density, and $c$ is specific heat capacity. The temperature field $T(z,t)$ satisfies the one-dimensional heat equation $\\frac{\\partial T}{\\partial t} = \\kappa \\frac{\\partial^2 T}{\\partial z^2}$, with thermal diffusivity $\\kappa = \\frac{k}{\\rho c}$. The sinusoidal surface heat flux forcing and semi-infinite conduction lead to a periodic surface temperature response that is characterized by an amplitude $A_T$ and phase shift relative to the forcing.\n\nRemote sensing observations provide band-integrated thermal infrared radiative exitance $L_b$ at pre-dawn and midday. Under clear-sky conditions and for a graybody surface with emissivity $\\varepsilon$ in the instrument’s band, assume negligible atmospheric attenuation and approximate the surface-leaving band exitance as $L_b = \\varepsilon \\sigma T^4$, where $\\sigma$ is the Stefan–Boltzmann constant. This allows retrieval of the surface kinetic temperature $T$ via $T = \\left(\\frac{L_b}{\\varepsilon \\sigma}\\right)^{1/4}$.\n\nTask: Using only these physically grounded relations, derive an algorithm to invert for the thermal inertia $I$ from the amplitude of the conductive heat flux (obtained from the net radiation amplitude via $f_G$) and the amplitude of the surface temperature (obtained from the pre-dawn and midday thermal images and emissivity). Then, quantify the impact of emissivity uncertainty on the retrieved $I$ by computing $I$ at a nominal emissivity and at lower and upper emissivity bounds, and reporting the resulting fractional sensitivity defined as $\\frac{I(\\varepsilon_{\\text{high}}) - I(\\varepsilon_{\\text{low}})}{I(\\varepsilon_{\\text{nominal}})}$.\n\nImplement this inversion algorithm in a program that, for each test case, performs the following steps:\n- Convert the provided pre-dawn and midday band exitances to temperatures using the provided emissivity values (nominal, lower bound, upper bound).\n- Compute the temperature amplitude $A_T$ as half the absolute difference between the retrieved midday and pre-dawn temperatures.\n- Compute the angular frequency $\\omega = \\frac{2\\pi}{\\tau}$ using the provided period $\\tau$.\n- Compute the amplitude of the surface conductive heat flux $A_q$ as $A_q = f_G A_{R}$ using the provided net radiation amplitude $A_{R}$.\n- Invert for $I$ using the conduction solution for sinusoidal forcing.\n- Report, for each test case, a list of four values: the nominal $I$, $I$ using the lower emissivity bound, $I$ using the upper emissivity bound, and the fractional sensitivity as defined above. All thermal inertia values must be expressed in $\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\\,\\text{s}^{-1/2}$ and rounded to $3$ decimal places. The fractional sensitivity must be a decimal (rounded to $3$ decimal places).\n\nUse the following test suite. Each test case is an ordered tuple $\\left(L_{b,\\text{mid}}, L_{b,\\text{pre}}, \\varepsilon_{\\text{nom}}, \\varepsilon_{\\text{low}}, \\varepsilon_{\\text{high}}, A_{R}, f_G, \\tau\\right)$ with $L_{b,\\text{mid}}$ and $L_{b,\\text{pre}}$ in $\\text{W}\\,\\text{m}^{-2}$, $\\varepsilon_{\\cdot}$ dimensionless, $A_{R}$ in $\\text{W}\\,\\text{m}^{-2}$, $f_G$ dimensionless, and $\\tau$ in $\\text{s}$:\n\n- Case $1$: $\\left($ $430$, $330$, $0.95$, $0.90$, $0.98$, $400$, $0.30$, $86400$ $\\right)$\n- Case $2$: $\\left($ $470$, $360$, $0.99$, $0.97$, $1.00$, $500$, $0.25$, $86400$ $\\right)$\n- Case $3$: $\\left($ $380$, $280$, $0.82$, $0.78$, $0.88$, $450$, $0.20$, $86400$ $\\right)$\n- Case $4$: $\\left($ $350$, $340$, $0.95$, $0.92$, $0.98$, $300$, $0.30$, $86400$ $\\right)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case result itself being a list of four comma-separated floats without spaces, for example, $[\\,[i_{1,\\text{nom}},i_{1,\\text{low}},i_{1,\\text{high}},s_1],\\,[i_{2,\\text{nom}},i_{2,\\text{low}},i_{2,\\text{high}},s_2],\\,...\\,]$.\n\nNote: Treat midday as the temperature maximum and pre-dawn as the temperature minimum. If the temperature amplitude is very small, the inverted thermal inertia will be large, reflecting reduced diurnal temperature oscillation for high-inertia materials. Express all thermal inertia values in $\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\\,\\text{s}^{-1/2}$, and ensure all angles, if needed, are in radians.",
            "solution": "The problem requires the derivation and implementation of an algorithm to determine the thermal inertia of a material from remotely sensed surface temperature data, and to assess the sensitivity of the result to uncertainty in surface emissivity. This is a classic inversion problem in geophysical and environmental remote sensing.\n\nThe foundation of the model is the one-dimensional heat conduction in a semi-infinite, homogeneous medium, which is a standard representation for the Earth's subsurface on a local scale. The temperature field $T(z,t)$ at depth $z$ and time $t$ is governed by the heat equation:\n$$\n\\frac{\\partial T}{\\partial t} = \\kappa \\frac{\\partial^2 T}{\\partial z^2}\n$$\nwhere $\\kappa = k / (\\rho c)$ is the thermal diffusivity, with $k$ being the thermal conductivity, $\\rho$ the density, and $c$ the specific heat capacity.\n\nThe problem states that a sinusoidal heat flux is applied at the surface ($z=0$). This flux is the ground heat flux, $G(t)$, which is a fraction $f_G$ of the net radiation $R_n(t)$. Since $R_n(t)$ is assumed to be sinusoidal with amplitude $A_R$ and angular frequency $\\omega = 2\\pi/\\tau$, the ground heat flux $G(t)$ is also sinusoidal with the same frequency and an amplitude $A_q = f_G A_R$. We can represent this forcing as a boundary condition using Fourier's law of heat conduction:\n$$\nG(t) = -k \\left. \\frac{\\partial T}{\\partial z} \\right|_{z=0} = A_q \\cos(\\omega t)\n$$\nThe phase of the cosine function is set to zero without loss of generality. The second boundary condition is that temperature fluctuations must decay to zero deep within the medium:\n$$\n\\lim_{z \\to \\infty} T(z,t) = \\bar{T}\n$$\nwhere $\\bar{T}$ is the mean temperature.\n\nWe seek a periodic solution to the heat equation of the form $T(z, t) = \\bar{T} + \\tilde{T}(z,t)$, where $\\tilde{T}$ is the oscillatory part. Using complex notation, we can write $\\tilde{T}(z,t) = \\text{Re}\\{\\hat{T}(z) e^{i\\omega t}\\}$. Substituting this into the heat equation yields an ordinary differential equation for the complex amplitude $\\hat{T}(z)$:\n$$\ni\\omega \\hat{T}(z) = \\kappa \\frac{d^2 \\hat{T}(z)}{dz^2} \\implies \\frac{d^2 \\hat{T}}{dz^2} = \\frac{i\\omega}{\\kappa} \\hat{T}\n$$\nThe general solution is $\\hat{T}(z) = C_1 e^{\\lambda z} + C_2 e^{-\\lambda z}$, where $\\lambda^2 = i\\omega/\\kappa$.\nSince $\\sqrt{i} = (1+i)/\\sqrt{2}$, we have $\\lambda = \\sqrt{\\frac{i\\omega}{\\kappa}} = \\frac{1+i}{\\sqrt{2}} \\sqrt{\\frac{\\omega}{\\kappa}}$. The real part of $\\lambda$ is positive. The boundary condition at $z \\to \\infty$ requires that the solution remains bounded, so we must set $C_1=0$. The solution is thus $\\hat{T}(z) = C_2 e^{-\\lambda z}$. At the surface $z=0$, the complex temperature amplitude is $\\hat{T}(0) = C_2$. Therefore, $\\hat{T}(z) = \\hat{T}(0) e^{-\\lambda z}$.\n\nThe complex surface heat flux, $\\hat{G}$, is related to the temperature gradient at the surface:\n$$\n\\hat{G} = -k \\left. \\frac{d\\hat{T}}{dz} \\right|_{z=0} = -k \\left[ -\\lambda \\hat{T}(0) e^{-\\lambda z} \\right]_{z=0} = k \\lambda \\hat{T}(0)\n$$\nThe amplitudes are the moduli of these complex numbers. Let $A_T = |\\hat{T}(0)|$ be the amplitude of the surface temperature oscillation, and $A_q = |\\hat{G}|$ be the amplitude of the ground heat flux. Then:\n$$\nA_q = |k| |\\lambda| |\\hat{T}(0)| = k \\cdot \\left| \\frac{1+i}{\\sqrt{2}} \\sqrt{\\frac{\\omega}{\\kappa}} \\right| \\cdot A_T = k \\cdot \\sqrt{\\frac{\\omega}{\\kappa}} \\cdot A_T\n$$\nWe introduce the thermal inertia, $I = \\sqrt{k \\rho c}$. We can relate $k$ and $\\kappa$ to $I$. From their definitions, $I^2 = k \\rho c$ and $\\kappa = k/(\\rho c)$, we can write $k = I\\sqrt{\\kappa}$. Substituting this into the amplitude equation:\n$$\nA_q = (I\\sqrt{\\kappa}) \\sqrt{\\frac{\\omega}{\\kappa}} A_T = I \\sqrt{\\kappa} \\frac{\\sqrt{\\omega}}{\\sqrt{\\kappa}} A_T = I A_T \\sqrt{\\omega}\n$$\nThis provides the fundamental relationship between the amplitudes of the surface heat flux ($A_q$) and the surface temperature ($A_T$), the thermal inertia ($I$), and the angular frequency of the forcing ($\\omega$). To invert for thermal inertia, we rearrange this equation:\n$$\nI = \\frac{A_q}{A_T \\sqrt{\\omega}}\n$$\nThis is the core formula for the inversion algorithm.\n\nThe algorithm to implement is as follows:\n1.  For each test case, the inputs are $(L_{b,\\text{mid}}, L_{b,\\text{pre}}, \\varepsilon_{\\text{nom}}, \\varepsilon_{\\text{low}}, \\varepsilon_{\\text{high}}, A_{R}, f_G, \\tau)$. Use the Stefan-Boltzmann constant $\\sigma = 5.670374419 \\times 10^{-8} \\, \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$.\n2.  Calculate the constant parameters for each case:\n    -   Angular frequency: $\\omega = 2\\pi / \\tau$.\n    -   Amplitude of the ground heat flux: $A_q = f_G A_R$.\n3.  Define a procedure to calculate $I$ for a given emissivity $\\varepsilon$:\n    a. Retrieve the surface kinetic temperatures from the band exitances $L_b$ using the Stefan-Boltzmann law, rearranged as $T = (L_b / (\\varepsilon \\sigma))^{1/4}$.\n       $$\n       T_{\\text{mid}} = \\left(\\frac{L_{b,\\text{mid}}}{\\varepsilon \\sigma}\\right)^{1/4}, \\quad T_{\\text{pre}} = \\left(\\frac{L_{b,\\text{pre}}}{\\varepsilon \\sigma}\\right)^{1/4}\n       $$\n    b. Calculate the amplitude of the surface temperature diurnal cycle. Since midday and pre-dawn correspond to the maximum and minimum temperatures, respectively:\n       $$\n       A_T = \\frac{T_{\\text{mid}} - T_{\\text{pre}}}{2}\n       $$\n    c. Use the derived inversion formula to compute the thermal inertia:\n       $$\n       I = \\frac{A_q}{A_T \\sqrt{\\omega}}\n       $$\n4.  Apply this procedure three times for each test case, using the nominal ($\\varepsilon_{\\text{nom}}$), lower-bound ($\\varepsilon_{\\text{low}}$), and upper-bound ($\\varepsilon_{\\text{high}}$) emissivities to compute $I_{\\text{nom}}$, $I_{\\text{low}}$, and $I_{\\text{high}}$.\n5.  Calculate the fractional sensitivity to emissivity uncertainty as defined in the problem:\n    $$\n    S = \\frac{I_{\\text{high}} - I_{\\text{low}}}{I_{\\text{nom}}}\n    $$\n6.  For each test case, compile the four computed values ($I_{\\text{nom}}, I_{\\text{low}}, I_{\\text{high}}, S$), round them to 3 decimal places, and format them as specified. The units of thermal inertia will be $\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\\,\\text{s}^{-1/2}$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.constants import Stefan_Boltzmann as sigma_const\n\ndef solve():\n    \"\"\"\n    Solves for thermal inertia and its sensitivity to emissivity based on\n    remote sensing data.\n    \"\"\"\n\n    # Value of the Stefan-Boltzmann constant from scipy.constants\n    # sigma_const in W m^-2 K^-4\n    sigma = sigma_const\n\n    # Test cases as provided in the problem statement.\n    # Each case: (L_b_mid, L_b_pre, e_nom, e_low, e_high, A_R, f_G, tau)\n    test_cases = [\n        (430.0, 330.0, 0.95, 0.90, 0.98, 400.0, 0.30, 86400.0),\n        (470.0, 360.0, 0.99, 0.97, 1.00, 500.0, 0.25, 86400.0),\n        (380.0, 280.0, 0.82, 0.78, 0.88, 450.0, 0.20, 86400.0),\n        (350.0, 340.0, 0.95, 0.92, 0.98, 300.0, 0.30, 86400.0),\n    ]\n\n    def calculate_thermal_inertia(L_b_mid, L_b_pre, epsilon, A_R, f_G, tau):\n        \"\"\"\n        Calculates thermal inertia from input parameters.\n        \n        Args:\n            L_b_mid (float): Midday band exitance (W m^-2).\n            L_b_pre (float): Pre-dawn band exitance (W m^-2).\n            epsilon (float): Surface emissivity (dimensionless).\n            A_R (float): Net radiation amplitude (W m^-2).\n            f_G (float): Fraction of net radiation as ground heat flux (dimensionless).\n            tau (float): Period of diurnal cycle (s).\n\n        Returns:\n            float: Thermal inertia (J m^-2 K^-1 s^-1/2).\n        \"\"\"\n        # Step 1: Convert band exitances to temperatures\n        T_mid = (L_b_mid / (epsilon * sigma))**0.25\n        T_pre = (L_b_pre / (epsilon * sigma))**0.25\n        \n        # Step 2: Compute temperature amplitude\n        A_T = (T_mid - T_pre) / 2.0\n        \n        # Step 3: Compute angular frequency\n        omega = (2.0 * np.pi) / tau\n        \n        # Step 4: Compute amplitude of surface conductive heat flux\n        A_q = f_G * A_R\n        \n        # Avoid division by zero if temperature difference is negligible\n        if A_T = 1e-9:\n            return np.inf  # Physically, very high inertia\n\n        # Step 5: Invert for thermal inertia I\n        I = A_q / (A_T * np.sqrt(omega))\n        \n        return I\n\n    results = []\n    for case in test_cases:\n        L_b_mid, L_b_pre, e_nom, e_low, e_high, A_R, f_G, tau = case\n\n        # Calculate thermal inertia for nominal, low, and high emissivity\n        I_nom = calculate_thermal_inertia(L_b_mid, L_b_pre, e_nom, A_R, f_G, tau)\n        I_low = calculate_thermal_inertia(L_b_mid, L_b_pre, e_low, A_R, f_G, tau)\n        I_high = calculate_thermal_inertia(L_b_mid, L_b_pre, e_high, A_R, f_G, tau)\n\n        # Calculate fractional sensitivity\n        if I_nom == 0:\n            sensitivity = np.inf\n        else:\n            sensitivity = (I_high - I_low) / I_nom\n\n        # Format results for the current case as a string without spaces\n        result_str = (f\"[{I_nom:.3f},{I_low:.3f},\"\n                      f\"{I_high:.3f},{sensitivity:.3f}]\")\n        results.append(result_str)\n\n    # Final print statement in the exact required format\n    final_output = f\"[{','.join(results)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}