{
    "hands_on_practices": [
        {
            "introduction": "A central challenge in thermal remote sensing is that a single radiance measurement conflates the effects of surface temperature and emissivity. This ill-posed problem can be tackled by exploiting the distinct ways temperature and emissivity vary with wavelength. This practice challenges you to derive an emissivity shape vector from first principles, using a key physical approximation of Planck's law to algebraically separate the temperature and emissivity contributions in multi-band thermal data .",
            "id": "3858971",
            "problem": "A five-band Thermal Infrared (TIR) instrument observes a homogeneous, horizontally extensive land surface. Each band has a narrow, approximately rectangular spectral response centered at wavelengths $\\lambda_{i}$ for $i=1,\\dots,5$. The instrument reports calibrated surface-leaving spectral radiances $L_{i}$ (assume unity atmospheric transmittance and negligible reflected downwelling radiance) in each band. The surface is assumed to be well-approximated as a graybody with spectrally varying emissivity $\\varepsilon(\\lambda)$ and a single, spatially uniform physical temperature $T$. The band-integrated radiance in band $i$ is modeled by the narrowband approximation $L_{i} \\approx \\varepsilon_{i}\\,B_{\\lambda}(\\lambda_{i},T)$, where $\\varepsilon_{i} \\equiv \\varepsilon(\\lambda_{i})$ and $B_{\\lambda}(\\lambda,T)$ is the spectral Planck radiance given by $B_{\\lambda}(\\lambda,T) = \\dfrac{2 h c^{2}}{\\lambda^{5}}\\left(\\exp\\left(\\dfrac{h c}{\\lambda k_{B} T}\\right)-1\\right)^{-1}$, with $h$ the Planck constant, $c$ the speed of light, and $k_{B}$ the Boltzmann constant.\n\nStarting only from Planck’s law and the emissivity-radiance relationship, derive an emissivity normalization scheme that uses interband ratios to eliminate the dependence on the unknown temperature $T$ to leading order in the long-wave limit. Specifically, work in the regime where $\\dfrac{h c}{\\lambda_{i} k_{B} T} \\ll 1$ for all $i$ (typical of long-wave infrared and terrestrial temperatures), and use an asymptotic expansion of $B_{\\lambda}(\\lambda_{i},T)$ appropriate to this regime to justify algebraic elimination of $T$ from interband ratios.\n\nDefine the emissivity shape vector $s = (s_{1},s_{2},s_{3},s_{4},s_{5})$ to be dimensionless, proportional to the relative emissivity across bands, and normalized so that its geometric mean equals unity, i.e., $\\left(\\prod_{i=1}^{5} s_{i}\\right)^{1/5} = 1$. Derive a closed-form analytic expression for $s_{i}$ in terms of the measured radiances $L_{i}$ and the central wavelengths $\\lambda_{i}$ that is independent of $T$ to leading order under the stated assumptions. Present your result as a single expression for the full five-component shape vector.\n\nNo numerical evaluation is required. The final answer must be a single analytic expression. The shape components are dimensionless; do not include units in the final answer.",
            "solution": "The fundamental base is the radiative transfer at the surface under negligible reflection and unity atmospheric transmittance, combined with Planck’s law. Under the narrowband approximation for a band centered at $\\lambda_{i}$,\n$$\nL_{i} \\approx \\varepsilon_{i}\\,B_{\\lambda}(\\lambda_{i},T),\n$$\nwhere $\\varepsilon_{i} \\equiv \\varepsilon(\\lambda_{i})$ and\n$$\nB_{\\lambda}(\\lambda,T) = \\frac{2 h c^{2}}{\\lambda^{5}}\\,\\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right)-1}.\n$$\n\nWe seek to eliminate $T$ using interband ratios by exploiting the long-wave limit. Introduce $x_{i} \\equiv \\dfrac{h c}{\\lambda_{i} k_{B} T}$. In the long-wave limit for terrestrial temperatures and TIR wavelengths, $x_{i} \\ll 1$. Use the standard expansion\n$$\n\\frac{1}{\\exp(x)-1} = \\frac{1}{x} - \\frac{1}{2} + \\frac{x}{12} + \\mathcal{O}(x^{2}),\n$$\nvalid for $x \\to 0$. Substituting $x_{i}$ into Planck’s law gives\n\\begin{align*}\nB_{\\lambda}(\\lambda_{i},T)\n= \\frac{2 h c^{2}}{\\lambda_{i}^{5}}\\left(\\frac{1}{x_{i}} - \\frac{1}{2} + \\frac{x_{i}}{12} + \\mathcal{O}(x_{i}^{2})\\right) \\\\\n= \\frac{2 h c^{2}}{\\lambda_{i}^{5}}\\left(\\frac{\\lambda_{i} k_{B} T}{h c}\\right) - \\frac{2 h c^{2}}{\\lambda_{i}^{5}}\\left(\\frac{1}{2}\\right) + \\frac{2 h c^{2}}{\\lambda_{i}^{5}}\\left(\\frac{1}{12}\\frac{h c}{\\lambda_{i} k_{B} T}\\right) + \\mathcal{O}(x_{i}^{2}) \\\\\n= \\frac{2 c k_{B} T}{\\lambda_{i}^{4}} - \\frac{h c^{2}}{\\lambda_{i}^{5}} + \\frac{h^{2} c^{3}}{6\\,\\lambda_{i}^{6} k_{B} T} + \\mathcal{O}(x_{i}^{2}).\n\\end{align*}\n\nTo leading order in $x_{i}$, the Rayleigh–Jeans term dominates:\n$$\nB_{\\lambda}(\\lambda_{i},T) \\approx \\frac{2 c k_{B} T}{\\lambda_{i}^{4}}.\n$$\nSubstituting into the narrowband radiance model, we obtain\n$$\nL_{i} \\approx \\varepsilon_{i}\\,\\frac{2 c k_{B} T}{\\lambda_{i}^{4}}.\n$$\nThis expression shows that $L_{i}\\,\\lambda_{i}^{4} \\approx \\varepsilon_{i}\\,(2 c k_{B} T)$, so that across bands the combination $L_{i}\\,\\lambda_{i}^{4}$ is proportional to $\\varepsilon_{i}$ with the same proportionality constant $2 c k_{B} T$ for all $i$.\n\nTherefore, taking interband ratios cancels $T$ to leading order:\n$$\n\\frac{L_{i}\\,\\lambda_{i}^{4}}{L_{j}\\,\\lambda_{j}^{4}} \\approx \\frac{\\varepsilon_{i}}{\\varepsilon_{j}}.\n$$\nWe can construct a temperature-independent emissivity shape vector by normalizing any proportional set to have geometric mean unity. Define the unnormalized shape components $\\tilde{s}_{i} \\equiv L_{i}\\,\\lambda_{i}^{4}$. The geometric mean of $\\{\\tilde{s}_{i}\\}_{i=1}^{5}$ is\n$$\nG \\equiv \\left(\\prod_{k=1}^{5} \\tilde{s}_{k}\\right)^{1/5} = \\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}.\n$$\nNormalize by $G$ to obtain the final shape components\n$$\ns_{i} \\equiv \\frac{\\tilde{s}_{i}}{G} = \\frac{L_{i}\\,\\lambda_{i}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}}.\n$$\nBy construction, $\\left(\\prod_{i=1}^{5} s_{i}\\right)^{1/5} = 1$, and $s_{i}$ is independent of $T$ to leading order because the factor $2 c k_{B} T$ cancels in the ratio across bands.\n\nIt remains to justify that instrument-specific bandpass scaling factors do not contaminate the shape. Under the narrowband assumption with unit-normalized spectral response, any constant multiplicative band calibration factor would appear as $L_{i} \\to \\alpha_{i} L_{i}$. If $\\alpha_{i}$ is identical across bands (absolute calibration), it cancels trivially. If $\\alpha_{i}$ varies, it would enter $s_{i}$ as $s_{i} \\propto \\alpha_{i} L_{i}\\lambda_{i}^{4}$; thus, accurate interband relative calibration is required for the scheme to reflect emissivity shape rather than instrument artifacts, which is a standard requirement in Temperature–Emissivity Separation (TES) methods. Under proper relative calibration, the derived $s_{i}$ provides the desired relative emissivity shape independent of $T$ to leading order in the long-wave expansion.\n\nThus, the requested closed-form expression for the five-component emissivity shape vector is\n$$\ns = \\left(\\frac{L_{1}\\,\\lambda_{1}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}},\\ \\frac{L_{2}\\,\\lambda_{2}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}},\\ \\frac{L_{3}\\,\\lambda_{3}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}},\\ \\frac{L_{4}\\,\\lambda_{4}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}},\\ \\frac{L_{5}\\,\\lambda_{5}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}}\\right),\n$$\nwhich is temperature-independent to leading order under the stated assumptions and satisfies the geometric mean normalization.",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\dfrac{L_{1}\\,\\lambda_{1}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}}  \\dfrac{L_{2}\\,\\lambda_{2}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}}  \\dfrac{L_{3}\\,\\lambda_{3}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}}  \\dfrac{L_{4}\\,\\lambda_{4}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}}  \\dfrac{L_{5}\\,\\lambda_{5}^{4}}{\\left(\\prod_{k=1}^{5} L_{k}\\,\\lambda_{k}^{4}\\right)^{1/5}}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "Beyond first-principles physics, many operational Temperature–Emissivity Separation (TES) algorithms leverage robust empirical relationships found in extensive spectral libraries of natural materials. One such critical relationship connects a material's minimum emissivity ($\\epsilon_{\\min}$) to its maximum-minimum difference ($\\text{MMD}$). This exercise provides a practical, data-driven exploration of this concept, guiding you through fitting and validating a model for this relationship using rigorous statistical criteria .",
            "id": "3858915",
            "problem": "You are given synthetic thermal infrared emissivity spectra for multiple materials in three separate spectral libraries. Each spectrum consists of emissivity values across six bands. Emissivity is a dimensionless quantity bounded between $0$ and $1$. For each spectrum, define the minimum emissivity as $ \\epsilon_{\\min} = \\min_{j} \\epsilon_{j} $ and the maximum minimum difference (MMD) as $ \\text{MMD} = \\max_{j} \\epsilon_{j} - \\min_{j} \\epsilon_{j} $. Under the temperature–emissivity separation methodology in remote sensing, many materials exhibit a smooth relationship between $ \\epsilon_{\\min} $ and $ \\text{MMD} $, and this relationship can be approximated by a polynomial model whose order must be justified by residual analysis rather than assumed.\n\nYour task is to, for each spectral library:\n- Compute $ \\epsilon_{\\min} $ and $ \\text{MMD} $ for each spectrum in the library.\n- Fit both a first-order polynomial model and a second-order polynomial model mapping from $ \\text{MMD} $ (input) to $ \\epsilon_{\\min} $ (output) using ordinary least squares, without any regularization.\n- Perform residual analysis consisting of both an information criterion and a diagnostic for monotonic trend in residuals:\n  - Compute the Akaike Information Criterion (AIC) from the residual sum of squares. Use $ k = 2 $ parameters for the first-order model and $ k = 3 $ parameters for the second-order model. If the residual sum of squares is numerically zero, you may add a negligible positive number to avoid taking the logarithm of zero, but your logic must remain consistent across both models.\n  - Test for a monotonic trend between residuals and $ \\text{MMD} $ using Spearman’s rank correlation at significance level $ \\alpha = 0.05 $ (dimensionless), and record the $p$-value for each model.\n- Choose the preferred model according to the following rule:\n  - If one model’s residuals show no significant monotonic trend (its $p$-value is at least $ \\alpha $) and the other’s do show a significant trend (its $p$-value is less than $ \\alpha $), select the former.\n  - Otherwise, compare AIC values. If the absolute AIC difference is less than $ 2 $, select the first-order model for parsimony. If the difference is at least $ 2 $, select the model with the lower AIC.\n\nOutput specification:\n- For each spectral library (three total), output an integer representing the selected model: $0$ for first-order and $1$ for second-order. Emissivity and MMD are dimensionless; there are no physical units to report. The output should be a single line containing a list of three integers, in the order Library A, Library B, Library C, printed exactly as a comma-separated list enclosed in square brackets, for example $[0,1,0]$.\n\nUse the following spectral libraries. Each row is one spectrum (six bands). All numbers are dimensionless.\n\nLibrary A (intended to be well described by a first-order relationship):\n- $[\\;0.982,\\;0.9835,\\;0.981,\\;0.98275,\\;0.986,\\;0.984\\;]$\n- $[\\;0.9778,\\;0.9814,\\;0.9754,\\;0.9796,\\;0.9874,\\;0.9826\\;]$\n- $[\\;0.9742,\\;0.9796,\\;0.9706,\\;0.9769,\\;0.9886,\\;0.9814\\;]$\n- $[\\;0.97,\\;0.9775,\\;0.965,\\;0.97375,\\;0.99,\\;0.98\\;]$\n- $[\\;0.9652,\\;0.9751,\\;0.9586,\\;0.97015,\\;0.9916,\\;0.9784\\;]$\n- $[\\;0.958,\\;0.9715,\\;0.949,\\;0.96475,\\;0.994,\\;0.976\\;]$\n- $[\\;0.949,\\;0.967,\\;0.937,\\;0.958,\\;0.997,\\;0.973\\;]$\n- $[\\;0.94,\\;0.9625,\\;0.925,\\;0.95125,\\;1.0,\\;0.97\\;]$\n\nLibrary B (intended to be well described by a second-order relationship):\n- $[\\;0.9649424,\\;0.9673424,\\;0.9633424,\\;0.9661424,\\;0.9713424,\\;0.9681424\\;]$\n- $[\\;0.9647975,\\;0.9692975,\\;0.9617975,\\;0.9670475,\\;0.9767975,\\;0.9707975\\;]$\n- $[\\;0.9645644,\\;0.9711644,\\;0.9601644,\\;0.9678644,\\;0.9821644,\\;0.9733644\\;]$\n- $[\\;0.96419,\\;0.97319,\\;0.95819,\\;0.96869,\\;0.98819,\\;0.97619\\;]$\n- $[\\;0.9637004,\\;0.9751004,\\;0.9561004,\\;0.9694004,\\;0.9941004,\\;0.9789004\\;]$\n- $[\\;0.9634124,\\;0.9760124,\\;0.9550124,\\;0.9697124,\\;0.9970124,\\;0.9802124\\;]$\n- $[\\;0.9631775,\\;0.9766775,\\;0.9541775,\\;0.9699275,\\;0.9991775,\\;0.9811775\\;]$\n\nLibrary C (edge case with very low spectral contrast):\n- $[\\;0.979,\\;0.979,\\;0.979,\\;0.979,\\;0.979,\\;0.979\\;]$\n- $[\\;0.97915,\\;0.97945,\\;0.97895,\\;0.9793,\\;0.97995,\\;0.97955\\;]$\n- $[\\;0.9793,\\;0.9799,\\;0.9789,\\;0.9796,\\;0.9809,\\;0.9801\\;]$\n- $[\\;0.97945,\\;0.98035,\\;0.97885,\\;0.9799,\\;0.98185,\\;0.98065\\;]$\n- $[\\;0.9796,\\;0.9808,\\;0.9788,\\;0.9802,\\;0.9828,\\;0.9812\\;]$\n- $[\\;0.97975,\\;0.98125,\\;0.97875,\\;0.9805,\\;0.98375,\\;0.98175\\;]$\n- $[\\;0.9799,\\;0.9817,\\;0.9787,\\;0.9808,\\;0.9847,\\;0.9823\\;]$\n\nTest suite and output:\n- Apply the above algorithm independently to Library A, Library B, and Library C.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[\\;0,\\;1,\\;0\\;]$.\n- The entries are integers $0$ or $1$ as defined above. There are no physical units to report. Angles are not involved. Percentages are not involved; any proportions are to be expressed as decimals if needed internally. The output should be exactly three integers in one list.",
            "solution": "The problem requires selecting the optimal polynomial model (first-order versus second-order) to describe the relationship between minimum emissivity ($\\epsilon_{\\min}$) and maximum-minimum difference ($\\text{MMD}$) for three distinct spectral libraries. The selection process is governed by a hierarchical set of rules based on residual analysis.\n\nThe methodology proceeds in four principal steps for each library:\n1.  **Data Derivation**: For each emissivity spectrum, two key metrics are calculated. A spectrum is a vector of emissivity values $\\boldsymbol{\\epsilon} = [\\epsilon_1, \\epsilon_2, \\dots, \\epsilon_6]$. The minimum emissivity, $\\epsilon_{\\min}$, is defined as:\n    $$ \\epsilon_{\\min} = \\min_{j} \\epsilon_{j} $$\n    The maximum-minimum difference, $\\text{MMD}$, is defined as:\n    $$ \\text{MMD} = \\max_{j} \\epsilon_{j} - \\min_{j} \\epsilon_{j} $$\n    This process transforms each spectral library of $n$ spectra into a dataset of $n$ pairs $(\\text{MMD}_i, \\epsilon_{\\min, i})$, where $\\text{MMD}$ is the independent variable and $\\epsilon_{\\min}$ is the dependent variable.\n\n2.  **Polynomial Regression**: Two polynomial models are fitted to the $(\\text{MMD}, \\epsilon_{\\min})$ data using the method of Ordinary Least Squares (OLS).\n    -   **First-Order Model**: This is a linear model of the form:\n        $$ \\epsilon_{\\min} = \\beta_0 + \\beta_1 \\cdot \\text{MMD} $$\n        The model has $k=2$ parameters $(\\beta_0, \\beta_1)$.\n    -   **Second-Order Model**: This is a quadratic model of the form:\n        $$ \\epsilon_{\\min} = \\gamma_0 + \\gamma_1 \\cdot \\text{MMD} + \\gamma_2 \\cdot \\text{MMD}^2 $$\n        The model has $k=3$ parameters $(\\gamma_0, \\gamma_1, \\gamma_2)$.\n\n    OLS determines the model parameters by minimizing the Residual Sum of Squares ($\\text{RSS}$), defined as $\\text{RSS} = \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2$, where $y_i$ are the observed values ($\\epsilon_{\\min, i}$) and $\\hat{y}_i$ are the values predicted by the model.\n\n3.  **Model Diagnostics**: The quality of each fit is assessed by analyzing its residuals, $r_i = y_i - \\hat{y}_i$. The analysis comprises two components:\n    -   **Spearman's Rank Correlation Test**: This non-parametric test assesses whether there is a monotonic trend between the residuals and the independent variable, $\\text{MMD}$. The null hypothesis is that there is no monotonic association. A low $p$-value (less than the significance level $\\alpha = 0.05$) suggests the residuals are not random and contain a systematic pattern, indicating that the model is misspecified. If the residuals are constant (e.g., all zero), a trend is absent, corresponding to a $p$-value of $1$.\n    -   **Akaike Information Criterion (AIC)**: AIC provides a means to select a model by balancing goodness of fit with model complexity. It is calculated as:\n        $$ \\text{AIC} = n \\log\\left(\\frac{\\text{RSS}}{n}\\right) + 2k $$\n        where $n$ is the number of data points and $k$ is the number of model parameters. A lower AIC value indicates a better model. To handle cases where $\\text{RSS}$ is numerically zero, a negligible positive constant is added to prevent an undefined logarithm, ensuring calculability without affecting the comparison.\n\n4.  **Model Selection Rule**: A hierarchical rule dictates the final choice:\n    -   **Primary Criterion (Residual Trend)**: The $p$-values from the Spearman tests for the first-order model ($p_1$) and second-order model ($p_2$) are compared against $\\alpha=0.05$. If one model's residuals show a significant monotonic trend (e.g., $p_1  \\alpha$) while the other's do not ($p_2 \\ge \\alpha$), the model without the significant trend is chosen.\n    -   **Secondary Criterion (AIC Comparison)**: If the primary criterion is inconclusive (i.e., both models show a significant trend or both do not), the AIC values ($\\text{AIC}_1$ and $\\text{AIC}_2$) are compared.\n        -   If the absolute difference $|\\text{AIC}_1 - \\text{AIC}_2|  2$, the evidence for one model over the other is weak. In this case, the principle of parsimony dictates selecting the simpler, first-order model (coded as $0$).\n        -   If $|\\text{AIC}_1 - \\text{AIC}_2| \\ge 2$, the difference is considered significant, and the model with the lower AIC is selected.\n\nThis complete procedure is applied independently to each of the three spectral libraries to determine the most appropriate model for each dataset. The final output for each library is an integer: $0$ for the first-order model and $1$ for the second-order model.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import spearmanr\n\ndef solve():\n    \"\"\"\n    Validates and solves the problem of model selection for temperature-emissivity\n    separation data based on the provided specifications.\n    \"\"\"\n\n    # Define the spectral libraries from the problem statement.\n    libraries = {\n        \"A\": np.array([\n            [0.982, 0.9835, 0.981, 0.98275, 0.986, 0.984],\n            [0.9778, 0.9814, 0.9754, 0.9796, 0.9874, 0.9826],\n            [0.9742, 0.9796, 0.9706, 0.9769, 0.9886, 0.9814],\n            [0.97, 0.9775, 0.965, 0.97375, 0.99, 0.98],\n            [0.9652, 0.9751, 0.9586, 0.97015, 0.9916, 0.9784],\n            [0.958, 0.9715, 0.949, 0.96475, 0.994, 0.976],\n            [0.949, 0.967, 0.937, 0.958, 0.997, 0.973],\n            [0.94, 0.9625, 0.925, 0.95125, 1.0, 0.97],\n        ], dtype=np.float64),\n        \"B\": np.array([\n            [0.9649424, 0.9673424, 0.9633424, 0.9661424, 0.9713424, 0.9681424],\n            [0.9647975, 0.9692975, 0.9617975, 0.9670475, 0.9767975, 0.9707975],\n            [0.9645644, 0.9711644, 0.9601644, 0.9678644, 0.9821644, 0.9733644],\n            [0.96419, 0.97319, 0.95819, 0.96869, 0.98819, 0.97619],\n            [0.9637004, 0.9751004, 0.9561004, 0.9694004, 0.9941004, 0.9789004],\n            [0.9634124, 0.9760124, 0.9550124, 0.9697124, 0.9970124, 0.9802124],\n            [0.9631775, 0.9766775, 0.9541775, 0.9699275, 0.9991775, 0.9811775],\n        ], dtype=np.float64),\n        \"C\": np.array([\n            [0.979, 0.979, 0.979, 0.979, 0.979, 0.979],\n            [0.97915, 0.97945, 0.97895, 0.9793, 0.97995, 0.97955],\n            [0.9793, 0.9799, 0.9789, 0.9796, 0.9809, 0.9801],\n            [0.97945, 0.98035, 0.97885, 0.9799, 0.98185, 0.98065],\n            [0.9796, 0.9808, 0.9788, 0.9802, 0.9828, 0.9812],\n            [0.97975, 0.98125, 0.97875, 0.9805, 0.98375, 0.98175],\n            [0.9799, 0.9817, 0.9787, 0.9808, 0.9847, 0.9823],\n        ], dtype=np.float64)\n    }\n\n    def process_library(spectra):\n        # Step 1: Compute epsilon_min and MMD for each spectrum\n        epsilon_min = np.min(spectra, axis=1)\n        mmd = np.max(spectra, axis=1) - epsilon_min\n        n = len(spectra)\n        alpha = 0.05\n        \n        # --- Model 1: First-order polynomial ---\n        k1 = 2\n        X1 = np.vstack([np.ones(n), mmd]).T\n        beta, rss_list1, _, _ = np.linalg.lstsq(X1, epsilon_min, rcond=None)\n        # lstsq returns RSS as a list, or an empty list if rank is sufficient.\n        rss1 = rss_list1[0] if len(rss_list1)  0 else np.sum((epsilon_min - X1 @ beta)**2)\n        residuals1 = epsilon_min - (X1 @ beta)\n        \n        # --- Model 2: Second-order polynomial ---\n        k2 = 3\n        X2 = np.vstack([np.ones(n), mmd, mmd**2]).T\n        gamma, rss_list2, _, _ = np.linalg.lstsq(X2, epsilon_min, rcond=None)\n        rss2 = rss_list2[0] if len(rss_list2)  0 else np.sum((epsilon_min - X2 @ gamma)**2)\n        residuals2 = epsilon_min - (X2 @ gamma)\n\n        # --- Model Diagnostics ---\n        # AIC calculation with safety for log(0)\n        # Using a small epsilon as per problem statement's allowance\n        # for numerically zero RSS.\n        small_positive_number = 1e-30\n        aic1 = n * np.log(max(rss1, small_positive_number) / n) + 2 * k1\n        aic2 = n * np.log(max(rss2, small_positive_number) / n) + 2 * k2\n        \n        # Spearman's rank correlation test\n        # Handle case of constant residuals (no variation) where spearmanr returns NaN\n        if len(np.unique(residuals1))  2:\n            p_value1 = 1.0\n        else:\n            _, p_value1 = spearmanr(mmd, residuals1)\n        \n        if len(np.unique(residuals2))  2:\n            p_value2 = 1.0\n        else:\n            _, p_value2 = spearmanr(mmd, residuals2)\n\n        # --- Model Selection Logic ---\n        has_trend1 = p_value1  alpha\n        has_trend2 = p_value2  alpha\n        \n        # Priority 1: Residual trend test\n        if has_trend1 and not has_trend2:\n            return 1 # Model 2 is preferred\n        if not has_trend1 and has_trend2:\n            return 0 # Model 1 is preferred\n        \n        # Priority 2: AIC comparison\n        # This block is reached if both have a trend or both do not.\n        delta_aic = np.abs(aic1 - aic2)\n        if delta_aic  2:\n            return 0 # Parsimony: prefer simpler model (1st order)\n        else:\n            return 1 if aic2  aic1 else 0\n\n    results = []\n    # Process libraries in specified order: A, B, C\n    for lib_key in sorted(libraries.keys()):\n        result = process_library(libraries[lib_key])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The accuracy of any Temperature–Emissivity Separation (TES) method is fundamentally linked to the quality of the atmospheric correction that precedes it. In this exercise, you will conduct a sensitivity analysis to quantify how uncertainties in atmospheric properties, specifically the column water vapor amount, propagate into the final retrieved temperature and emissivity products. By implementing a simplified radiative transfer model and an inversion scheme, you will gain hands-on experience in evaluating the robustness of a retrieval algorithm in the face of real-world complexities .",
            "id": "3858925",
            "problem": "You are to implement a simplified, yet physically consistent sensitivity study of Temperature–Emissivity Separation (TES) to atmospheric water vapor in the thermal infrared, using a one-dimensional nadir-viewing radiative transfer model and a multi-band retrieval procedure grounded in fundamental laws.\n\nStart from the following foundations:\n- The spectral radiance of a blackbody at wavelength $\\lambda$ and temperature $T$ is given by Planck's law,\n$$\nB_{\\lambda}(\\lambda,T) = \\frac{2 h c^2}{\\lambda^5} \\left( e^{\\frac{h c}{\\lambda k_B T}} - 1 \\right)^{-1},\n$$\nwhere $h$ is Planck's constant, $c$ is the speed of light in vacuum, and $k_B$ is Boltzmann's constant. When computing numerically, be careful to express $\\lambda$ in meters and the resulting spectral radiance per meter; if output is required per micrometer, convert units accordingly.\n- The Beer–Lambert law for a homogeneous absorber with mass absorption coefficient $\\kappa_{\\lambda}$ and column mass $w$ (expressed in $\\mathrm{g}/\\mathrm{cm}^2$) gives the spectral transmittance\n$$\n\\tau_{\\lambda} = \\exp(-\\kappa_{\\lambda} \\, w),\n$$\nassuming nadir viewing in a plane-parallel atmosphere.\n- For an isothermal, emitting and absorbing atmosphere with temperature $T_a$, the upwelling atmospheric path radiance is modeled as\n$$\nL_{\\lambda}^{\\uparrow} = (1 - \\tau_{\\lambda}) \\, B_{\\lambda}(\\lambda,T_a),\n$$\nand the downwelling atmospheric radiance at the surface is modeled as\n$$\nL_{\\lambda}^{\\downarrow} = (1 - \\tau_{\\lambda}) \\, B_{\\lambda}(\\lambda,T_a).\n$$\n- The top-of-atmosphere spectral radiance for a surface with temperature $T_s$ and spectral emissivity $\\epsilon_{\\lambda}$ is modeled as\n$$\nL_{\\lambda}^{\\mathrm{TOA}} = \\tau_{\\lambda} \\left[ \\epsilon_{\\lambda} \\, B_{\\lambda}(\\lambda,T_s) + (1 - \\epsilon_{\\lambda}) \\, L_{\\lambda}^{\\downarrow} \\right] + L_{\\lambda}^{\\uparrow}.\n$$\n\nYou will use a set of five thermal infrared window channels with center wavelengths\n$$\n\\Lambda = [8.5,\\, 9.5,\\, 10.0,\\, 11.0,\\, 12.0] \\text{ micrometers}.\n$$\nAssume a spectrally varying water vapor mass absorption coefficient vector (per channel) given by\n$$\n\\boldsymbol{\\kappa} = [0.08,\\, 0.04,\\, 0.02,\\, 0.03,\\, 0.09] \\text{ cm}^2/\\text{g},\n$$\na true surface temperature\n$$\nT_s^{\\mathrm{true}} = 300 \\text{ K},\n$$\nan atmospheric (isothermal layer) temperature\n$$\nT_a = 280 \\text{ K},\n$$\nand a true surface spectral emissivity vector\n$$\n\\boldsymbol{\\epsilon}^{\\mathrm{true}} = [0.96,\\, 0.97,\\, 0.985,\\, 0.98,\\, 0.95].\n$$\n\nFor each specified column water vapor test case $w$ (in $\\mathrm{g}/\\mathrm{cm}^2$), do the following:\n1. Compute the spectral transmittance $\\tau_{\\lambda}$ per channel using Beer–Lambert law and the given $\\boldsymbol{\\kappa}$ and $w$.\n2. Simulate the top-of-atmosphere spectral radiance $\\boldsymbol{L}^{\\mathrm{TOA}}$ per channel using the radiative transfer equation above with the provided $T_s^{\\mathrm{true}}$, $T_a$, and $\\boldsymbol{\\epsilon}^{\\mathrm{true}}$. Express spectral radiance in units of $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$.\n3. Retrieve the surface temperature $T_s$ and emissivity $\\boldsymbol{\\epsilon}$ using the following two-step TES procedure that uses only first-principles constructs:\n   - Step A (graybody temperature by variance minimization): Form the surface-leaving radiance estimate per channel that corrects only for upwelling atmospheric emission,\n   $$\n   \\widehat{L}_{\\lambda}^{\\mathrm{surf}} = \\frac{L_{\\lambda}^{\\mathrm{TOA}} - L_{\\lambda}^{\\uparrow}}{\\tau_{\\lambda}}.\n   $$\n   For a test temperature $T$, define the ratio\n   $$\n   r_{\\lambda}(T) = \\frac{\\widehat{L}_{\\lambda}^{\\mathrm{surf}}}{B_{\\lambda}(\\lambda,T)}.\n   $$\n   Find the graybody temperature $T_s^{(0)}$ that minimizes the variance of $\\{ r_{\\lambda}(T) \\}$ across channels over the bounded interval $T \\in [250,\\, 340]$ Kelvin. Then set preliminary emissivities $\\epsilon_{\\lambda}^{(0)} = \\mathrm{clip}(r_{\\lambda}(T_s^{(0)}),\\, [0.6,\\, 1.0])$, where $\\mathrm{clip}(\\cdot,[a,b])$ constrains values to the interval $[a,b]$.\n   - Step B (refined temperature by residual minimization): With $\\boldsymbol{\\epsilon}^{(0)}$ fixed, find $T_s^{(1)}$ that minimizes\n   $$\n   J(T) = \\sum_{\\lambda \\in \\Lambda} \\left( L_{\\lambda}^{\\mathrm{TOA}} - \\tau_{\\lambda} \\, \\epsilon_{\\lambda}^{(0)} \\, B_{\\lambda}(\\lambda,T) - L_{\\lambda}^{\\uparrow} \\right)^2\n   $$\n   over $T \\in [250,\\, 340]$ Kelvin. Finally, compute refined emissivities\n   $$\n   \\epsilon_{\\lambda}^{(1)} = \\mathrm{clip}\\left( \\frac{\\widehat{L}_{\\lambda}^{\\mathrm{surf}}}{B_{\\lambda}(\\lambda,T_s^{(1)})},\\, [0.0,\\, 1.0] \\right).\n   $$\n\nFor each test case $w$, quantify TES sensitivity with two metrics:\n- The temperature error $\\Delta T = T_s^{(1)} - T_s^{\\mathrm{true}}$ in Kelvin.\n- The mean absolute emissivity error,\n$$\n\\mathrm{MAE}_{\\epsilon} = \\frac{1}{|\\Lambda|} \\sum_{\\lambda \\in \\Lambda} \\left| \\epsilon_{\\lambda}^{(1)} - \\epsilon_{\\lambda}^{\\mathrm{true}} \\right|.\n$$\n\nTest Suite:\n- Use the following water vapor column amounts $w$ in $\\mathrm{g}/\\mathrm{cm}^2$:\n$$\nw \\in \\{ 0.0,\\, 1.0,\\, 5.0,\\, 10.0 \\}.\n$$\n\nAnswer specification:\n- For each $w$ in the order given, compute and return the pair $(\\Delta T,\\, \\mathrm{MAE}_{\\epsilon})$.\n- Express $\\Delta T$ in Kelvin and $\\mathrm{MAE}_{\\epsilon}$ as a unitless decimal. Round each value to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the sequence\n$$\n[\\Delta T_{w=0.0},\\, \\mathrm{MAE}_{\\epsilon,w=0.0},\\, \\Delta T_{w=1.0},\\, \\mathrm{MAE}_{\\epsilon,w=1.0},\\, \\Delta T_{w=5.0},\\, \\mathrm{MAE}_{\\epsilon,w=5.0},\\, \\Delta T_{w=10.0},\\, \\mathrm{MAE}_{\\epsilon,w=10.0} ].\n$$\nNo other text should be printed.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We will proceed by first implementing the forward radiative transfer model to simulate the sensor measurements, and then implementing the two-step inverse model to retrieve the surface temperature and emissivity. The sensitivity of the retrieval to atmospheric water vapor will be quantified using the specified error metrics.\n\n### Part 1: Forward Radiative Transfer Model\n\nThe forward model simulates the top-of-atmosphere (TOA) radiance based on a given atmospheric and surface state.\n\n**Physical Constants and Parameters:**\nThe model relies on the following physical constants and specified parameters:\n- Planck's constant: $h \\approx 6.626 \\times 10^{-34} \\, \\mathrm{J \\cdot s}$\n- Speed of light in vacuum: $c \\approx 2.998 \\times 10^{8} \\, \\mathrm{m/s}$\n- Boltzmann's constant: $k_B \\approx 1.381 \\times 10^{-23} \\, \\mathrm{J/K}$\n- Channel center wavelengths: $\\Lambda = [8.5, 9.5, 10.0, 11.0, 12.0] \\, \\mu\\mathrm{m}$\n- Water vapor mass absorption coefficients: $\\boldsymbol{\\kappa} = [0.08, 0.04, 0.02, 0.03, 0.09] \\, \\mathrm{cm}^2/\\mathrm{g}$\n- True surface temperature: $T_s^{\\mathrm{true}} = 300 \\, \\mathrm{K}$\n- Atmospheric temperature: $T_a = 280 \\, \\mathrm{K}$\n- True surface emissivities: $\\boldsymbol{\\epsilon}^{\\mathrm{true}} = [0.96, 0.97, 0.985, 0.98, 0.95]$\n\n**Planck's Law:**\nThe spectral radiance of a blackbody at temperature $T$ and wavelength $\\lambda$ is given by Planck's law:\n$$\nB_{\\lambda}(\\lambda,T) = \\frac{2 h c^2}{\\lambda^5} \\left( e^{\\frac{h c}{\\lambda k_B T}} - 1 \\right)^{-1}\n$$\nIn this formula, $\\lambda$ must be in meters, yielding units of $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$. To convert to the required units of $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$, the result must be multiplied by a factor of $10^{-6} \\, \\mathrm{m}/\\mu\\mathrm{m}$.\n\n**Atmospheric and Surface Radiative Transfer:**\nFor each water vapor column amount $w$ (in $\\mathrm{g}/\\mathrm{cm}^2$), we first compute the atmospheric spectral transmittance $\\tau_{\\lambda}$ for each channel using the Beer-Lambert law:\n$$\n\\tau_{\\lambda} = \\exp(-\\kappa_{\\lambda} \\, w)\n$$\nThe upwelling and downwelling atmospheric path radiances, for an isothermal atmosphere at temperature $T_a$, are modeled as:\n$$\nL_{\\lambda}^{\\uparrow} = L_{\\lambda}^{\\downarrow} = (1 - \\tau_{\\lambda}) \\, B_{\\lambda}(\\lambda,T_a)\n$$\nThe \"true\" TOA spectral radiance, which serves as the synthetic measurement for our inversion, is then simulated using the true surface properties ($T_s^{\\mathrm{true}}$, $\\boldsymbol{\\epsilon}^{\\mathrm{true}}$):\n$$\nL_{\\lambda}^{\\mathrm{TOA}} = \\tau_{\\lambda} \\left[ \\epsilon_{\\lambda}^{\\mathrm{true}} \\, B_{\\lambda}(\\lambda,T_s^{\\mathrm{true}}) + (1 - \\epsilon_{\\lambda}^{\\mathrm{true}}) \\, L_{\\lambda}^{\\downarrow} \\right] + L_{\\lambda}^{\\uparrow}\n$$\n\n### Part 2: Inverse Model - Temperature-Emissivity Separation (TES)\n\nThe TES algorithm is an inverse procedure that attempts to estimate $T_s$ and $\\boldsymbol{\\epsilon}$ from the simulated $L_{\\lambda}^{\\mathrm{TOA}}$ and known atmospheric properties ($\\tau_\\lambda$, $T_a$). The algorithm described is simplified and does not fully account for all physical effects (specifically, reflected downwelling radiance), which is the source of the error we are studying.\n\n**Step A: Graybody Temperature Estimation ($T_s^{(0)}$)**\nFirst, an initial estimate of the surface-leaving radiance is found by correcting for upwelling atmospheric emission and attenuation:\n$$\n\\widehat{L}_{\\lambda}^{\\mathrm{surf}} = \\frac{L_{\\lambda}^{\\mathrm{TOA}} - L_{\\lambda}^{\\uparrow}}{\\tau_{\\lambda}} = \\epsilon_{\\lambda}^{\\mathrm{true}} \\, B_{\\lambda}(\\lambda,T_s^{\\mathrm{true}}) + (1 - \\epsilon_{\\lambda}^{\\mathrm{true}}) \\, L_{\\lambda}^{\\downarrow}\n$$\nThe second equality shows that $\\widehat{L}_{\\lambda}^{\\mathrm{surf}}$ is the total radiance leaving the surface, composed of both emitted and reflected components.\nNext, we define the ratio $r_{\\lambda}(T)$ as an apparent emissivity for a given test temperature $T$:\n$$\nr_{\\lambda}(T) = \\frac{\\widehat{L}_{\\lambda}^{\\mathrm{surf}}}{B_{\\lambda}(\\lambda,T)}\n$$\nThe initial temperature estimate, $T_s^{(0)}$, is found by minimizing the variance of the set $\\{ r_{\\lambda}(T) \\}_{\\lambda \\in \\Lambda}$ over the interval $T \\in [250, 340] \\, \\mathrm{K}$. This is based on the heuristic that an incorrect temperature will introduce a spectral distortion, increasing the variance of the apparent emissivity. A numerical scalar minimization routine is used for this task. The preliminary emissivities are then calculated and clipped: $\\epsilon_{\\lambda}^{(0)} = \\mathrm{clip}(r_{\\lambda}(T_s^{(0)}), [0.6, 1.0])$.\n\n**Step B: Refined Temperature Estimation ($T_s^{(1)}$)**\nThis step refines the temperature by minimizing the sum of squared residuals between the \"measured\" $L_{\\lambda}^{\\mathrm{TOA}}$ and a simplified forward model. The cost function is:\n$$\nJ(T) = \\sum_{\\lambda \\in \\Lambda} \\left( L_{\\lambda}^{\\mathrm{TOA}} - \\left[ \\tau_{\\lambda} \\, \\epsilon_{\\lambda}^{(0)} \\, B_{\\lambda}(\\lambda,T) + L_{\\lambda}^{\\uparrow} \\right] \\right)^2\n$$\nThe term in square brackets is the algorithm's simplified model of TOA radiance, which notably omits the reflected downwelling radiance component. The refined temperature, $T_s^{(1)}$, is the value of $T$ in the range $[250, 340] \\, \\mathrm{K}$ that minimizes $J(T)$.\nFinally, the refined emissivities are calculated by inverting the relationship for surface-leaving radiance using the new temperature estimate, followed by clipping:\n$$\n\\epsilon_{\\lambda}^{(1)} = \\mathrm{clip}\\left( \\frac{\\widehat{L}_{\\lambda}^{\\mathrm{surf}}}{B_{\\lambda}(\\lambda,T_s^{(1)})}, [0.0, 1.0] \\right)\n$$\n\n### Part 3: Sensitivity Analysis\n\nThe entire procedure, from simulating $L_{\\lambda}^{\\mathrm{TOA}}$ to retrieving $T_s^{(1)}$ and $\\boldsymbol{\\epsilon}^{(1)}$, is executed for each water vapor case $w \\in \\{0.0, 1.0, 5.0, 10.0\\} \\, \\mathrm{g}/\\mathrm{cm}^2$. For each case, the sensitivity of the TES algorithm is quantified by two error metrics:\n- **Temperature Error:** $\\Delta T = T_s^{(1)} - T_s^{\\mathrm{true}}$\n- **Mean Absolute Emissivity Error:** $\\mathrm{MAE}_{\\epsilon} = \\frac{1}{|\\Lambda|} \\sum_{\\lambda \\in \\Lambda} \\left| \\epsilon_{\\lambda}^{(1)} - \\epsilon_{\\lambda}^{\\mathrm{true}} \\right|$\n\nThe results quantify how the algorithm's accuracy degrades as the atmosphere becomes more opaque (increasing $w$), which enhances the contribution of the unaccounted-for reflected downwelling radiance term. For $w=0.0$, the atmospheric effects vanish, and the algorithm is expected to perform perfectly, yielding $\\Delta T = 0$ and $\\mathrm{MAE}_{\\epsilon} = 0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Implements a sensitivity study of a Temperature-Emissivity Separation (TES)\n    algorithm to atmospheric water vapor.\n    \"\"\"\n    # Define physical constants\n    h = 6.62607015e-34  # Planck's constant (J·s)\n    c = 2.99792458e8    # Speed of light (m/s)\n    k_B = 1.380649e-23   # Boltzmann constant (J/K)\n\n    # Define problem parameters\n    wavelengths_um = np.array([8.5, 9.5, 10.0, 11.0, 12.0])\n    wavelengths_m = wavelengths_um * 1e-6\n    kappa = np.array([0.08, 0.04, 0.02, 0.03, 0.09])  # cm^2/g\n    T_s_true = 300.0  # K\n    T_a = 280.0       # K\n    epsilon_true = np.array([0.96, 0.97, 0.985, 0.98, 0.95])\n    \n    # Define test cases for column water vapor\n    test_cases = [0.0, 1.0, 5.0, 10.0]  # g/cm^2\n\n    # Temperature search bounds\n    T_bounds = (250.0, 340.0)\n    \n    # Store results\n    results = []\n\n    def planck(wav_m, T):\n        \"\"\"\n        Calculates Planck's law for given wavelengths and temperature.\n        \n        Args:\n            wav_m (np.ndarray): Wavelengths in meters.\n            T (float): Temperature in Kelvin.\n        \n        Returns:\n            np.ndarray: Spectral radiance in W m^-2 sr^-1 um^-1.\n        \"\"\"\n        exponent = (h * c) / (wav_m * k_B * T)\n        # Calculate radiance in W m^-2 sr^-1 m^-1\n        radiance_per_m = (2 * h * c**2) / (wav_m**5 * (np.exp(exponent) - 1))\n        # Convert to W m^-2 sr^-1 um^-1\n        radiance_per_um = radiance_per_m * 1e-6\n        return radiance_per_um\n\n    for w in test_cases:\n        # 1. Simulate TOA spectral radiance (the \"measurement\")\n        tau = np.exp(-kappa * w)\n        B_a = planck(wavelengths_m, T_a)\n        L_up = (1 - tau) * B_a\n        L_down = L_up  # As per problem statement\n        \n        B_s_true = planck(wavelengths_m, T_s_true)\n        L_toa_measured = tau * (epsilon_true * B_s_true + (1 - epsilon_true) * L_down) + L_up\n\n        # 2. Retrieve T_s and epsilon using the TES procedure\n        \n        # Step A: Graybody temperature by variance minimization\n        l_surf_hat = (L_toa_measured - L_up) / tau\n\n        def variance_cost(T):\n            \"\"\"Objective function for Step A: variance of apparent emissivity.\"\"\"\n            B_T = planck(wavelengths_m, T)\n            # Handle potential division by zero if B_T is zero, though unlikely in this range\n            B_T[B_T == 0] = 1e-9\n            r_T = l_surf_hat / B_T\n            return np.var(r_T)\n\n        res_A = minimize_scalar(variance_cost, bounds=T_bounds, method='bounded')\n        T_s0 = res_A.x\n        \n        B_T_s0 = planck(wavelengths_m, T_s0)\n        epsilon_0 = np.clip(l_surf_hat / B_T_s0, 0.6, 1.0)\n\n        # Step B: Refined temperature by residual minimization\n        def residual_cost(T):\n            \"\"\"Objective function for Step B: sum of squared residuals.\"\"\"\n            B_T = planck(wavelengths_m, T)\n            L_toa_model = tau * epsilon_0 * B_T + L_up\n            return np.sum((L_toa_measured - L_toa_model)**2)\n        \n        res_B = minimize_scalar(residual_cost, bounds=T_bounds, method='bounded')\n        T_s1 = res_B.x\n\n        # Calculate final emissivity\n        B_T_s1 = planck(wavelengths_m, T_s1)\n        epsilon_1 = np.clip(l_surf_hat / B_T_s1, 0.0, 1.0)\n        \n        # 3. Quantify TES sensitivity with error metrics\n        delta_T = T_s1 - T_s_true\n        mae_epsilon = np.mean(np.abs(epsilon_1 - epsilon_true))\n        \n        results.append(round(delta_T, 3))\n        results.append(round(mae_epsilon, 3))\n\n    # Final print statement in the exact required format.\n    # The format \"[0.0,0.0,...]\" for w=0 might have small numerical errors.\n    # The problem asks for rounded values, so we use them.\n    # The expected 0.0 for w=0 case might show as -0.0 due to float arithmetic. str() handles this.\n    formatted_results = [f\"{val:.3f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}