{
    "hands_on_practices": [
        {
            "introduction": "要掌握热红外数据的大气校正，第一步是能够从卫星测量的总信号中反演出地表温度。本练习将引导你完成这一核心任务。通过代数方法重排辐射传输方程，你将学习如何分离出地表自身的热辐射项，然后利用普朗克定律的逆运算，从该辐射值计算出地表动力学温度 $T_s$。这项基本技能是几乎所有热红外遥感应用的基石，对于理解大气影响如何被“剥离”以揭示真实地表信息至关重要 。",
            "id": "3797035",
            "problem": "一台星载热红外成像仪在均匀、不透明的陆地表面上进行天底观测，获取了中心波长为 $\\lambda=11\\,\\mu m$ 的窄带测量数据。测得的大气层顶（TOA）光谱辐亮度 $L_{TOA}$ 为 $9.0\\,W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。大气被近似为平面平行、水平均质，并且在视线路径上处于局部热力学平衡状态。大气透过率为 $\\tau=0.85$。地表光谱发射率为 $\\epsilon=0.98$。入射到地表的下行大气光谱辐亮度为 $L_{d}=2.0\\,W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。上行路径光谱辐亮度为 $L_{u}=1.5\\,W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。假设地表是朗伯体，并在热红外区域遵守基尔霍夫定律，因此在测量波长处的半球反射率等于 $1-\\epsilon$。\n\n从地表和视线路径上的热发射与反射的辐射传输描述出发，并利用普朗克光谱辐亮度定律，\n$$\nB_{\\lambda}(\\lambda,T)=\\frac{2\\,h\\,c^{2}}{\\lambda^{5}}\\;\\frac{1}{\\exp\\!\\left(\\frac{h\\,c}{\\lambda\\,k_{B}\\,T}\\right)-1},\n$$\n推导出地表温度 $T_{s}$ 的表达式，并使用所提供的数据计算其数值。使用以下物理常数：普朗克常数 $h=6.62607015\\times 10^{-34}\\,J\\,s$，真空光速 $c=2.99792458\\times 10^{8}\\,m\\,s^{-1}$，以及玻尔兹曼常数 $k_{B}=1.380649\\times 10^{-23}\\,J\\,K^{-1}$。将 $B_{\\lambda}$ 视为单位波长的光谱辐亮度，因此当 $\\lambda$ 以米表示时，$B_{\\lambda}$ 的单位为 $W\\,m^{-2}\\,sr^{-1}\\,m^{-1}$。在使用以每微米为单位报告的测量值时，请保持单位转换的一致性。\n\n将 $T_{s}$ 的最终数值结果四舍五入到四位有效数字。最终温度以开尔文表示。",
            "solution": "星载传感器在大气层顶测得的光谱辐亮度 $L_{TOA}$ 是三个分量的总和：\n1.  地表发射并穿过大气层的辐亮度。\n2.  下行大气辐亮度被地表反射，然后穿过大气层。\n3.  大气本身发射的上行路径辐亮度。\n\n在数学上，对于给定的波长 $\\lambda$，这由辐射传输方程表示：\n$$\nL_{TOA}(\\lambda) = \\tau(\\lambda) \\left[ \\epsilon(\\lambda) B_{\\lambda}(\\lambda, T_s) + \\rho(\\lambda) L_d(\\lambda) \\right] + L_u(\\lambda)\n$$\n其中 $T_s$ 是地表温度，$B_{\\lambda}(\\lambda, T_s)$ 是由普朗克定律给出的温度为 $T_s$ 的黑体的光谱辐亮度，$\\epsilon(\\lambda)$ 是地表发射率，$\\tau(\\lambda)$ 是大气透过率，$L_d(\\lambda)$ 是下行大气辐亮度，$L_u(\\lambda)$ 是上行路径辐亮度，$\\rho(\\lambda)$ 是地表反射率。\n\n问题指出，地表是不透明的，在热红外区域遵守基尔霍夫定律，并且是一个朗伯反射体。对于处于局部热力学平衡状态的不透明朗伯表面，其方向-半球反射率等于半球反射率，并通过 $\\rho(\\lambda) = 1 - \\epsilon(\\lambda)$ 与发射率相关。将此代入方程，并且为了简化符号，省略明确的波长依赖性（因为所有量都针对同一窄带），我们得到：\n$$\nL_{TOA} = \\tau [ \\epsilon B_{\\lambda}(T_s) + (1 - \\epsilon) L_d ] + L_u\n$$\n\n我们的目标是求解 $T_s$。温度内嵌在普朗克函数项 $B_{\\lambda}(T_s)$ 中。我们必须首先通过代数方法重新排列方程来分离这一项。\n$$\nL_{TOA} - L_u = \\tau \\epsilon B_{\\lambda}(T_s) + \\tau(1 - \\epsilon) L_d\n$$\n$$\nL_{TOA} - L_u - \\tau(1 - \\epsilon) L_d = \\tau \\epsilon B_{\\lambda}(T_s)\n$$\n这给出了地表发射的黑体光谱辐亮度的表达式：\n$$\nB_{\\lambda}(T_s) = \\frac{L_{TOA} - L_u - \\tau(1 - \\epsilon) L_d}{\\tau \\epsilon}\n$$\n接下来，我们必须反演普朗克定律来求解 $T_s$。普朗克定律为：\n$$\nB_{\\lambda}(\\lambda, T_s) = \\frac{2 h c^2}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_B T_s}\\right) - 1}\n$$\n为简化起见，我们定义第一和第二辐射常数：$c_1 = 2 h c^2$ 和 $c_2 = \\frac{h c}{k_B}$。方程变为：\n$$\nB_{\\lambda}(\\lambda, T_s) = \\frac{c_1}{\\lambda^5 \\left( \\exp\\left(\\frac{c_2}{\\lambda T_s}\\right) - 1 \\right)}\n$$\n重新整理以求解 $T_s$：\n$$\n\\exp\\left(\\frac{c_2}{\\lambda T_s}\\right) - 1 = \\frac{c_1}{\\lambda^5 B_{\\lambda}(\\lambda, T_s)}\n$$\n$$\n\\exp\\left(\\frac{c_2}{\\lambda T_s}\\right) = \\frac{c_1}{\\lambda^5 B_{\\lambda}(\\lambda, T_s)} + 1\n$$\n对两边取自然对数：\n$$\n\\frac{c_2}{\\lambda T_s} = \\ln\\left( \\frac{c_1}{\\lambda^5 B_{\\lambda}(\\lambda, T_s)} + 1 \\right)\n$$\n最后，求解 $T_s$，我们得到所需的表达式：\n$$\nT_s = \\frac{c_2}{\\lambda \\ln\\left( \\frac{c_1}{\\lambda^5 B_{\\lambda}(\\lambda, T_s)} + 1 \\right)}\n$$\n将辐射传输方程中 $B_{\\lambda}(\\lambda, T_s)$ 的表达式代入，我们得到 $T_s$ 的完整符号解：\n$$\nT_s = \\frac{c_2}{\\lambda \\ln\\left( \\frac{c_1 \\tau \\epsilon}{\\lambda^5 [L_{TOA} - L_u - \\tau(1 - \\epsilon) L_d]} + 1 \\right)}\n$$\n现在我们计算数值。关键一步是确保所有单位一致。物理常数采用国际单位制（SI units）（使用米），而辐亮度和波长值则以每微米（$\\mu m$）或微米为单位给出。我们将所有量转换为国际单位制。\n$$\n1 \\, \\mu m = 10^{-6} \\, m\n$$\n$$\n1 \\, W \\, m^{-2} \\, sr^{-1} \\, \\mu m^{-1} = 10^6 \\, W \\, m^{-2} \\, sr^{-1} \\, m^{-1}\n$$\n以国际单位制表示的给定值为：\n*   $\\lambda = 11 \\, \\mu m = 11 \\times 10^{-6} \\, m$\n*   $L_{TOA} = 9.0 \\, W \\, m^{-2} \\, sr^{-1} \\, \\mu m^{-1} = 9.0 \\times 10^6 \\, W \\, m^{-2} \\, sr^{-1} \\, m^{-1}$\n*   $L_d = 2.0 \\, W \\, m^{-2} \\, sr^{-1} \\, \\mu m^{-1} = 2.0 \\times 10^6 \\, W \\, m^{-2} \\, sr^{-1} \\, m^{-1}$\n*   $L_u = 1.5 \\, W \\, m^{-2} \\, sr^{-1} \\, \\mu m^{-1} = 1.5 \\times 10^6 \\, W \\, m^{-2} \\, sr^{-1} \\, m^{-1}$\n*   $\\tau = 0.85$\n*   $\\epsilon = 0.98$\n\n首先，计算地表黑体辐亮度 $B_{\\lambda}(T_s)$：\n$$\nB_{\\lambda}(T_s) = \\frac{9.0 \\times 10^6 - 1.5 \\times 10^6 - 0.85(1 - 0.98)(2.0 \\times 10^6)}{0.85 \\times 0.98}\n$$\n$$\nB_{\\lambda}(T_s) = \\frac{7.5 \\times 10^6 - 0.85(0.02)(2.0 \\times 10^6)}{0.833}\n$$\n$$\nB_{\\lambda}(T_s) = \\frac{7.5 \\times 10^6 - 0.034 \\times 10^6}{0.833} = \\frac{7.466 \\times 10^6}{0.833}\n$$\n$$\nB_{\\lambda}(T_s) \\approx 8.962785114 \\times 10^6 \\, W \\, m^{-2} \\, sr^{-1} \\, m^{-1}\n$$\n接下来，计算辐射常数 $c_1$ 和 $c_2$：\n*   $c_1 = 2 h c^2 = 2 \\times (6.62607015 \\times 10^{-34}) \\times (2.99792458 \\times 10^8)^2 \\approx 1.19104297 \\times 10^{-16} \\, W \\, m^2 \\, sr^{-1}$\n*   $c_2 = \\frac{h c}{k_B} = \\frac{(6.62607015 \\times 10^{-34}) \\times (2.99792458 \\times 10^8)}{1.380649 \\times 10^{-23}} \\approx 0.0143877735 \\, m \\cdot K$\n\n现在，将这些值代入 $T_s$ 的表达式中：\n$$\nT_s = \\frac{c_2}{\\lambda \\ln\\left( \\frac{c_1}{\\lambda^5 B_{\\lambda}(T_s)} + 1 \\right)}\n$$\n计算对数中的项：\n$$\n\\lambda^5 = (11 \\times 10^{-6})^5 = 1.61051 \\times 10^{-25} \\, m^5\n$$\n$$\n\\frac{c_1}{\\lambda^5 B_{\\lambda}(T_s)} = \\frac{1.19104297 \\times 10^{-16}}{(1.61051 \\times 10^{-25}) \\times (8.962785114 \\times 10^6)} \\approx 82.508119\n$$\n对数的参数为：\n$$\n\\frac{c_1}{\\lambda^5 B_{\\lambda}(T_s)} + 1 \\approx 82.508119 + 1 = 83.508119\n$$\n现在我们可以计算 $T_s$：\n$$\nT_s = \\frac{0.0143877735}{(11 \\times 10^{-6}) \\ln(83.508119)} \\approx \\frac{0.0143877735}{(11 \\times 10^{-6}) \\times 4.4249419}\n$$\n$$\nT_s \\approx \\frac{0.0143877735}{4.86743609 \\times 10^{-5}} \\approx 295.6136 \\, K\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nT_s \\approx 295.6 \\, K\n$$\n这代表地表温度约为 $22.46^\\circ C$。\n\n$T_s$ 的最终表达式：\n$$\nT_s = \\frac{hc}{k_B \\lambda \\ln\\left( \\frac{2hc^2 \\tau \\epsilon}{\\lambda^5 [L_{TOA} - L_u - \\tau(1 - \\epsilon) L_d]} + 1 \\right)}\n$$\n最终数值：\n$$\nT_s = 295.6 \\, K\n$$",
            "answer": "$$\n\\boxed{295.6}\n$$"
        },
        {
            "introduction": "任何遥感反演的结果都伴随着不确定性，评估这种不确定性是科学分析的关键环节。本练习聚焦于大气校正后残余的辐射不确定性如何传播到最终的地表温度产品中。你将推导普朗克函数对温度的灵敏度（即导数 $\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T}$），并理解它作为辐射不确定性与温度不确定性之间转换因子的作用。通过这个练习，你能够定量地评估一个给定的辐射误差会对温度反演结果造成多大的影响，这对于评估遥感产品的质量至关重要 。",
            "id": "3797038",
            "problem": "在波长 $\\lambda = 11\\,\\mu\\mathrm{m}$ 的热红外（TIR）地表温度反演中，需要对大气顶层（TOA）辐射率进行大气校正。校正后，地表出射光谱辐射率 $L_{\\lambda}^{\\mathrm{surf}}$ 被建模为 $L_{\\lambda}^{\\mathrm{surf}} = \\varepsilon_{\\lambda}\\,B_{\\lambda}(T)$，其中 $B_{\\lambda}(T)$ 是黑体的普朗克光谱辐射率，$\\varepsilon_{\\lambda}$ 是地表光谱发射率。大气校正中的不确定度导致了在地表处估计的辐射率不确定度 $\\Delta L_{\\lambda}$。\n\n从以下基本定律出发：\n- 单位波长的普朗克光谱辐射率定律，\n$$\nB_{\\lambda}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right)-1},\n$$\n- 以及可微映射的线性化不确定度传播，\n解析地推导出灵敏度 $\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T}$，在 $\\lambda = 11\\,\\mu\\mathrm{m}$ 和 $T = 300\\,\\mathrm{K}$ 条件下进行数值计算，然后利用它在小信号近似下将辐射率不确定度转换为温度不确定度。\n\n假设中红外大气窗口通道具有以下符合物理现实的条件：\n- 波长 $\\lambda = 11\\,\\mu\\mathrm{m}$，\n- 地表发射率 $\\varepsilon_{\\lambda} = 0.98$，\n- 地表动力学温度 $T = 300\\,\\mathrm{K}$，\n- 大气校正后的辐射率不确定度 $\\Delta L_{\\lambda} = 0.15\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu\\mathrm{m}^{-1}}$。\n\n使用以下精确的物理常数：\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$，\n- 真空光速 $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$，\n- 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n\n任务：\n1. 从普朗克定律推导出 $\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T}$ 的解析表达式，不引入任何快捷公式。\n2. 在指定的 $\\lambda$ 和 $T$ 条件下，数值计算 $\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T}$，并以 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}\\,K^{-1}}$ 为单位报告结果。\n3. 在 $L_{\\lambda}^{\\mathrm{surf}} = \\varepsilon_{\\lambda} B_{\\lambda}(T)$ 的小信号线性化条件下，根据 $\\Delta L_{\\lambda}$ 计算相应的温度不确定度 $\\Delta T$。\n\n将 $\\Delta T$ 的最终数值答案四舍五入到三位有效数字，并以开尔文为单位表示。你的最终答案必须是一个实数值。",
            "solution": "### 1. 灵敏度 $\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T}$ 的解析推导\n\n出发点是单位波长的普朗克光谱辐射率定律，$B_{\\lambda}(T)$：\n$$\nB_{\\lambda}(T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right)-1}\n$$\n为了求得光谱辐射率对温度的灵敏度，我们必须计算 $B_{\\lambda}(T)$ 对 $T$ 的导数。为清晰起见，我们定义两个常量：$A = \\frac{2 h c^{2}}{\\lambda^{5}}$ 和 $x(T) = \\frac{h c}{\\lambda k_{B} T}$。普朗克定律的表达式变为：\n$$\nB_{\\lambda}(T) = A \\left( \\exp(x(T)) - 1 \\right)^{-1}\n$$\n我们应用链式求导法则：$\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T} = \\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}x} \\frac{\\mathrm{d}x}{\\mathrm{d}T}$。\n\n首先，我们对 $B_{\\lambda}$ 关于 $x$ 求导：\n$$\n\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}x} = A \\cdot (-1) \\left( \\exp(x) - 1 \\right)^{-2} \\cdot \\frac{\\mathrm{d}}{\\mathrm{d}x}(\\exp(x) - 1) = -A \\frac{\\exp(x)}{(\\exp(x) - 1)^{2}}\n$$\n接下来，我们对 $x(T)$ 关于 $T$ 求导：\n$$\nx(T) = \\frac{h c}{\\lambda k_{B}} T^{-1}\n$$\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}T} = \\frac{h c}{\\lambda k_{B}} \\cdot (-1) T^{-2} = -\\frac{h c}{\\lambda k_{B} T^{2}}\n$$\n现在，我们使用链式法则将这些结果结合起来：\n$$\n\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T} = \\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}x} \\frac{\\mathrm{d}x}{\\mathrm{d}T} = \\left( -A \\frac{\\exp(x)}{(\\exp(x) - 1)^{2}} \\right) \\left( -\\frac{h c}{\\lambda k_{B} T^{2}} \\right)\n$$\n两个负号相互抵消，并将 $A$ 和 $x$ 的表达式代回，我们得到导数的解析公式：\n$$\n\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T} = \\left( \\frac{2 h c^{2}}{\\lambda^{5}} \\right) \\frac{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right)}{\\left(\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right)-1\\right)^{2}} \\left( \\frac{h c}{\\lambda k_{B} T^{2}} \\right)\n$$\n通过将其与 $B_{\\lambda}(T)$ 本身关联，这个表达式可以写得更紧凑：\n$$\n\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T} = B_{\\lambda}(T) \\frac{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right)}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right)-1} \\frac{h c}{\\lambda k_{B} T^{2}}\n$$\n\n### 2. $\\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T}$ 的数值计算\n\n我们已知以下参数和常数：\n- 波长 $\\lambda = 11\\,\\mu\\mathrm{m} = 11 \\times 10^{-6}\\,\\mathrm{m}$\n- 地表动力学温度 $T = 300\\,\\mathrm{K}$\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n- 光速 $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$\n- 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n\n计算将在国际单位制（SI）基本单位下进行，这将得到单位为 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,m^{-1}\\,K^{-1}}$ 的导数。需要进行单位转换以获得单位为 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}\\,K^{-1}}$ 的结果。由于 $1\\,\\mu\\mathrm{m} = 10^{-6}\\,\\mathrm{m}$，转换因子是 $10^{-6}$。\n\n首先，我们计算指数函数的无量纲参数：\n$$\nx = \\frac{h c}{\\lambda k_{B} T} = \\frac{(6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}) (2.99792458 \\times 10^{8}\\,\\mathrm{m\\,s^{-1}})}{(11 \\times 10^{-6}\\,\\mathrm{m})(1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}})(300\\,\\mathrm{K})} \\approx 4.35993\n$$\n接下来，我们以“每米”为单位计算普朗克函数 $B_{\\lambda_m}(T)$。\n第一辐射常数为 $c_1 = 2hc^2 = 2(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^{8})^2 \\approx 1.19104297 \\times 10^{-16}\\,\\mathrm{W\\,m^2\\,sr^{-1}}$。\n$$\nB_{\\lambda_m}(T) = \\frac{c_1}{\\lambda^5 (\\exp(x)-1)} = \\frac{1.19104297 \\times 10^{-16}}{(11 \\times 10^{-6})^5 (\\exp(4.35993)-1)} \\approx \\frac{7.39563 \\times 10^8}{78.2513 - 1} \\approx 9.57347 \\times 10^6\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,m^{-1}}\n$$\n现在，我们可以使用紧凑形式以“每米”为单位计算导数：\n$$\n\\frac{\\mathrm{d}B_{\\lambda_m}}{\\mathrm{d}T} = B_{\\lambda_m}(T) \\frac{x}{T} \\frac{\\exp(x)}{\\exp(x)-1}\n$$\n$$\n\\frac{\\mathrm{d}B_{\\lambda_m}}{\\mathrm{d}T} \\approx (9.57347 \\times 10^6) \\left( \\frac{4.35993}{300} \\right) \\left( \\frac{\\exp(4.35993)}{\\exp(4.35993)-1} \\right) \\approx (9.57347 \\times 10^6) (0.0145331) (1.01294) \\approx 140857\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,m^{-1}\\,K^{-1}}\n$$\n为了以要求的单位 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}\\,K^{-1}}$ 报告此值，我们乘以 $10^{-6}$：\n$$\n\\frac{\\mathrm{d}B_{\\lambda_{\\mu\\mathrm{m}}}}{\\mathrm{d}T} \\approx 140857 \\times 10^{-6} \\approx 0.140857\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}\\,K^{-1}}\n$$\n\n### 3. 温度不确定度 $\\Delta T$ 的计算\n\n地表出射光谱辐射率 $L_{\\lambda}^{\\mathrm{surf}}$ 与黑体光谱辐射率 $B_{\\lambda}(T)$ 之间的关系由下式给出：\n$$\nL_{\\lambda}^{\\mathrm{surf}} = \\varepsilon_{\\lambda}\\,B_{\\lambda}(T)\n$$\n假设发射率 $\\varepsilon_{\\lambda}$ 对于温度的微小变化是恒定的，我们可以将此关系线性化以传播不确定度。对于温度的微小变化 $\\Delta T$，辐射率的变化 $\\Delta L_{\\lambda}$ 近似为：\n$$\n\\Delta L_{\\lambda} \\approx \\frac{\\mathrm{d}L_{\\lambda}^{\\mathrm{surf}}}{\\mathrm{d}T} \\Delta T = \\left( \\varepsilon_{\\lambda} \\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T} \\right) \\Delta T\n$$\n我们可以重新整理这个方程来求解温度不确定度 $\\Delta T$：\n$$\n\\Delta T = \\frac{\\Delta L_{\\lambda}}{\\varepsilon_{\\lambda} \\frac{\\mathrm{d}B_{\\lambda}}{\\mathrm{d}T}}\n$$\n我们已知：\n- 辐射率不确定度 $\\Delta L_{\\lambda} = 0.15\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu\\mathrm{m}^{-1}}$\n- 地表发射率 $\\varepsilon_{\\lambda} = 0.98$\n\n使用单位一致的数值计算出的灵敏度：\n$$\n\\Delta T = \\frac{0.15\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu\\mathrm{m}^{-1}}}{0.98 \\cdot (0.140857\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}\\,K^{-1}})}\n$$\n$$\n\\Delta T \\approx \\frac{0.15}{0.13804} \\,\\mathrm{K} \\approx 1.08664\\,\\mathrm{K}\n$$\n根据要求将最终答案四舍五入到三位有效数字，我们得到：\n$$\n\\Delta T \\approx 1.09\\,\\mathrm{K}\n$$",
            "answer": "$$\n\\boxed{1.09}\n$$"
        },
        {
            "introduction": "在更高级的应用中，地表温度 $T_s$ 和地表发射率 $\\epsilon$ 通常都是未知的，并且需要同时反演，这使得问题变得更加复杂。本练习将指导你实现一种强大且应用广泛的现代反演技术——最优估计（Optimal Estimation）。你将学习如何构建一个包含先验知识的代价函数，并通过迭代计算（高斯-牛顿法）同时求解 $T_s$ 和 $\\epsilon$。这个练习模拟了真实业务化遥感算法的核心逻辑，让你能够处理非线性、欠定性的反演问题，是连接理论与前沿遥感实践的桥梁 。",
            "id": "3797043",
            "problem": "您的任务是在遥感和环境建模的热红外大气校正背景下，使用最优估计（OE）方法，根据在 $11\\,\\mu m$ 和 $12\\,\\mu m$ 两个波长处测得的大气层顶辐射率 $L_{\\text{band}}$，实现对地表温度 $T_s$ 和波段常数发射率 $\\epsilon$ 的反演。\n\n该反演必须基于以下基本原理从第一性原理进行构建：\n\n- 热红外大气层顶辐射率的辐射传输（RT）：对于每个波长 $\\lambda$，正向模型为\n$$\nL_{\\text{TOA},\\lambda} = \\tau_{\\lambda} \\left[ \\epsilon \\, B_{\\lambda}(T_s) + \\left(1-\\epsilon\\right) L_{d,\\lambda} \\right] + L_{u,\\lambda},\n$$\n其中，$L_{\\text{TOA},\\lambda}$ 是大气层顶辐射率，$\\tau_{\\lambda}$ 是大气透过率，$L_{u,\\lambda}$ 是上行路径辐射率，$L_{d,\\lambda}$ 是下行路径辐射率，$\\epsilon$ 是地表发射率（假定在两个波长上为波段常数），$B_{\\lambda}(T_s)$ 是普朗克辐射率，单位为 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。\n\n- 单位波长的光谱辐射率的普朗克定律：\n$$\nB_{\\lambda}(T) = \\frac{2 h c^2}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k T}\\right) - 1},\n$$\n其中 $h$ 是普朗克常数，$c$ 是光速，$k$ 是玻尔兹曼常数，$\\lambda$ 是以 $m$ 为单位的波长，并且辐射率随后通过一个 $10^{-6}$ 的乘法因子表示为每 $\\mu m$ 的值。其关于温度的导数为\n$$\n\\frac{\\partial B_{\\lambda}}{\\partial T}(T) = \\frac{2 h c^2}{\\lambda^5} \\cdot \\frac{\\exp\\left(\\frac{h c}{\\lambda k T}\\right)}{\\left[\\exp\\left(\\frac{h c}{\\lambda k T}\\right)-1\\right]^2} \\cdot \\frac{h c}{\\lambda k T^2},\n$$\n也通过相同的乘法因子表示为每 $\\mu m$ 的值。\n\n- 针对状态向量 $\\mathbf{x} = \\begin{bmatrix} T_s & \\epsilon \\end{bmatrix}^T$、测量值 $\\mathbf{y} = \\begin{bmatrix} L_{\\text{TOA},11\\,\\mu m} & L_{\\text{TOA},12\\,\\mu m} \\end{bmatrix}^T$、正向模型 $\\mathbf{F}(\\mathbf{x})$、测量误差协方差 $\\mathbf{S}_e$ 以及带有先验协方差 $\\mathbf{S}_a$ 的先验 $\\mathbf{x}_a$ 的最优估计（OE）。OE 成本函数为\n$$\nJ(\\mathbf{x}) = \\left[\\mathbf{y} - \\mathbf{F}(\\mathbf{x})\\right]^T \\mathbf{S}_e^{-1} \\left[\\mathbf{y} - \\mathbf{F}(\\mathbf{x})\\right] + \\left[\\mathbf{x} - \\mathbf{x}_a\\right]^T \\mathbf{S}_a^{-1} \\left[\\mathbf{x} - \\mathbf{x}_a\\right].\n$$\n\n您的程序必须实现一个迭代 Gauss-Newton OE 反演算法，该算法使用 $\\mathbf{F}$ 相对于 $\\mathbf{x}$ 的雅可比矩阵，并报告收敛行为。收敛的定义是：当状态更新量的欧几里得范数（以状态分量的原生单位衡量，即 $T_s$ 为开尔文，$\\epsilon$ 为无量纲）低于 $10^{-6}$ 的阈值，或达到最大迭代次数 $20$ 次时，以先到者为准。对于每个测试用例，程序必须计算并报告：反演得到的 $T_s$（单位 K）、反演得到的 $\\epsilon$（无量纲）、作为整数的迭代次数、一个指示是否达到收敛的布尔值，以及作为浮点数的最终成本 $J$。\n\n所有具有物理单位的量都必须得到一致处理：\n- 波长必须以 $\\mu m$ 为单位。\n- 辐射率必须以 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$ 为单位。\n- 温度必须以 $K$ 为单位。\n- 不涉及角度；无需使用。\n- 不涉及百分比；无需使用。\n\n测试套件：\n为以下四个测试用例实现反演。在每个用例中，测量的辐射率 $\\mathbf{y}$ 将通过对给定的 $T_s$ 和 $\\epsilon$ “真实”值以及指定的大气参数应用 RT 正向模型在内部生成。然后，反演过程使用这些生成的测量值（不添加噪声）以及指定的 $\\mathbf{S}_e$ 和 $\\mathbf{S}_a$。\n\n- 用例 1（理想情况）：\n    - 波长：$[11\\,\\mu m, 12\\,\\mu m]$。\n    - 大气透过率：$\\boldsymbol{\\tau} = [0.90, 0.88]$。\n    - 上行路径辐射率：$\\mathbf{L}_u = [1.20, 1.10]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。\n    - 下行路径辐射率：$\\mathbf{L}_d = [8.70, 9.20]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。\n    - 真实地表温度和发射率：$T_s^{\\text{true}} = 300\\,K$，$\\epsilon^{\\text{true}} = 0.98$。\n    - 测量误差标准差：$\\boldsymbol{\\sigma}_e = [0.10, 0.10]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$，其中 $\\mathbf{S}_e = \\mathrm{diag}(\\boldsymbol{\\sigma}_e^2)$。\n    - 先验状态和协方差：$\\mathbf{x}_a = [290\\,K, 0.95]^T$，$\\mathbf{S}_a = \\mathrm{diag}([5^2, 0.03^2])$。\n\n- 用例 2（中等路径吸收）：\n    - 波长：$[11\\,\\mu m, 12\\,\\mu m]$。\n    - 大气透过率：$\\boldsymbol{\\tau} = [0.50, 0.45]$。\n    - 上行路径辐射率：$\\mathbf{L}_u = [3.00, 3.50]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。\n    - 下行路径辐射率：$\\mathbf{L}_d = [10.50, 11.00]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。\n    - 真实地表温度和发射率：$T_s^{\\text{true}} = 310\\,K$，$\\epsilon^{\\text{true}} = 0.92$。\n    - 测量误差标准差：$\\boldsymbol{\\sigma}_e = [0.20, 0.20]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$，其中 $\\mathbf{S}_e = \\mathrm{diag}(\\boldsymbol{\\sigma}_e^2)$。\n    - 先验状态和协方差：$\\mathbf{x}_a = [295\\,K, 0.95]^T$，$\\mathbf{S}_a = \\mathrm{diag}([8^2, 0.05^2])$。\n\n- 用例 3（近晴空大气，发射率接近于 1）：\n    - 波长：$[11\\,\\mu m, 12\\,\\mu m]$。\n    - 大气透过率：$\\boldsymbol{\\tau} = [0.99, 0.985]$。\n    - 上行路径辐射率：$\\mathbf{L}_u = [0.30, 0.30]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。\n    - 下行路径辐射率：$\\mathbf{L}_d = [7.50, 8.00]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。\n    - 真实地表温度和发射率：$T_s^{\\text{true}} = 280\\,K$，$\\epsilon^{\\text{true}} = 0.999$。\n    - 测量误差标准差：$\\boldsymbol{\\sigma}_e = [0.05, 0.05]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$，其中 $\\mathbf{S}_e = \\mathrm{diag}(\\boldsymbol{\\sigma}_e^2)$。\n    - 先验状态和协方差：$\\mathbf{x}_a = [300\\,K, 0.97]^T$，$\\mathbf{S}_a = \\mathrm{diag}([4^2, 0.02^2])$。\n\n- 用例 4（低透过率，具挑战性的反演）：\n    - 波长：$[11\\,\\mu m, 12\\,\\mu m]$。\n    - 大气透过率：$\\boldsymbol{\\tau} = [0.30, 0.25]$。\n    - 上行路径辐射率：$\\mathbf{L}_u = [5.00, 5.50]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。\n    - 下行路径辐射率：$\\mathbf{L}_d = [12.00, 12.50]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$。\n    - 真实地表温度和发射率：$T_s^{\\text{true}} = 295\\,K$，$\\epsilon^{\\text{true}} = 0.90$。\n    - 测量误差标准差：$\\boldsymbol{\\sigma}_e = [0.50, 0.50]$，单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$，其中 $\\mathbf{S}_e = \\mathrm{diag}(\\boldsymbol{\\sigma}_e^2)$。\n    - 先验状态和协方差：$\\mathbf{x}_a = [330\\,K, 0.85]^T$，$\\mathbf{S}_a = \\mathrm{diag}([20^2, 0.10^2])$。\n\n算法要求：\n- 使用 RT 方程和普朗克定律实现正向模型 $\\mathbf{F}(\\mathbf{x})$。\n- 使用关于 $T_s$ 和 $\\epsilon$ 的解析导数实现雅可比矩阵 $\\mathbf{K} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{x}}$。\n- 实现一个迭代 Gauss-Newton OE 求解器：\n    - 初始化 $\\mathbf{x}_0 = \\mathbf{x}_a$。\n    - 在每次迭代中，通过求解一个基于 $\\mathbf{K}$、$\\mathbf{S}_e$ 和 $\\mathbf{S}_a$ 的线性系统来计算更新量 $\\Delta \\mathbf{x}$。\n    - 更新 $\\mathbf{x} \\leftarrow \\mathbf{x} + \\Delta \\mathbf{x}$。\n    - 当 $\\|\\Delta \\mathbf{x}\\|_2 < 10^{-6}$ 或达到 $20$ 次迭代后停止。\n    - 计算最终成本 $J$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。按顺序为四个测试用例中的每一个追加以下五个值：反演得到的 $T_s$（单位 K，浮点数）、反演得到的 $\\epsilon$（浮点数）、迭代次数（整数）、收敛标志（布尔值）和最终成本 $J$（浮点数）。因此，最终输出必须包含 20 个用方括号括起来的逗号分隔条目，例如 $\\left[ T_{s,1}, \\epsilon_1, n_1, \\text{converged}_1, J_1, T_{s,2}, \\epsilon_2, n_2, \\text{converged}_2, J_2, T_{s,3}, \\epsilon_3, n_3, \\text{converged}_3, J_3, T_{s,4}, \\epsilon_4, n_4, \\text{converged}_4, J_4 \\right]$。",
            "solution": "该问题要求实现一个最优估计（OE）反演算法，以从一对大气层顶（TOA）热红外辐射率测量值中确定地表温度 $T_s$ 和地表发射率 $\\epsilon$。该解决方案基于辐射传输的第一性原理和贝叶斯反演理论进行构建，并使用 Gauss-Newton 迭代法实现。\n\n**1. 理论框架**\n\n该反演问题被置于一个贝叶斯框架中，我们旨在找到能使成本函数 $J(\\mathbf{x})$ 最小化的状态向量 $\\mathbf{x}$。状态向量由待反演的参数组成：\n$$\n\\mathbf{x} = \\begin{bmatrix} T_s \\\\ \\epsilon \\end{bmatrix}\n$$\n其中 $T_s$ 是以开尔文为单位的地表温度，$\\epsilon$ 是地表发射率，假定在两个测量波长上是恒定的。\n\n测量值是在两个不同波长 $\\lambda_1 = 11\\,\\mu m$ 和 $\\lambda_2 = 12\\,\\mu m$ 处的 TOA 辐射率。测量向量为：\n$$\n\\mathbf{y} = \\begin{bmatrix} L_{\\text{TOA},\\lambda_1} \\\\ L_{\\text{TOA},\\lambda_2} \\end{bmatrix}\n$$\n\n**2. 正向模型**\n\n正向模型，记为 $\\mathbf{F}(\\mathbf{x})$，将状态向量 $\\mathbf{x}$ 与测量向量 $\\mathbf{y}$ 联系起来。它基于无散射、平面平行热力学大气的辐射传输方程。对于给定的波长 $\\lambda$，TOA 辐射率 $L_{\\text{TOA},\\lambda}$ 建模为：\n$$\nL_{\\text{TOA},\\lambda} = \\tau_{\\lambda} L_{\\text{surf},\\lambda} + L_{u,\\lambda}\n$$\n地表出射辐射率 $L_{\\text{surf},\\lambda}$ 由发射分量和反射的下行分量组成：\n$$\nL_{\\text{surf},\\lambda} = \\epsilon \\, B_{\\lambda}(T_s) + \\left(1-\\epsilon\\right) L_{d,\\lambda}\n$$\n将这些结合起来，得到单个通道的完整正向模型：\n$$\nF_{\\lambda}(\\mathbf{x}) = \\tau_{\\lambda} \\left[ \\epsilon \\, B_{\\lambda}(T_s) + \\left(1-\\epsilon\\right) L_{d,\\lambda} \\right] + L_{u,\\lambda}\n$$\n其中 $\\tau_{\\lambda}$ 是大气透过率，$L_{u,\\lambda}$ 是上行路径辐射率，$L_{d,\\lambda}$ 是下行大气辐射率，$B_{\\lambda}(T_s)$ 是普朗克黑体辐射函数。向量正向模型 $\\mathbf{F}(\\mathbf{x})$ 就是这些函数在 $\\lambda_1$ 和 $\\lambda_2$ 处求值的向量。\n\n普朗克函数给出了温度为 $T$、波长为 $\\lambda$ 的黑体的光谱辐射率，其表达式为：\n$$\nB_{\\lambda}(T) = \\frac{2 h c^2}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k T}\\right) - 1}\n$$\n此处，$h$ 是普朗克常数，$c$ 是光速，$k$ 是玻尔兹曼常数。在此问题中，所有辐射率均以 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}$ 为单位。这需要仔细处理单位，因为基本的普朗克方程使用以米（$m$）为单位的波长 $\\lambda$，并产生每米的辐射率。一个 $10^{-6}$ 的转换因子被应用于结果，以将其表示为所需单位。\n\n**3. 最优估计（OE）与成本函数**\n\nOE 方法将来自测量的信息与状态向量的先验知识相结合。最优状态通过最小化成本函数 $J(\\mathbf{x})$ 来找到，该函数对偏离测量值和偏离状态先验估计值的行为进行惩罚，并由它们各自的不确定性加权：\n$$\nJ(\\mathbf{x}) = \\left[\\mathbf{y} - \\mathbf{F}(\\mathbf{x})\\right]^T \\mathbf{S}_e^{-1} \\left[\\mathbf{y} - \\mathbf{F}(\\mathbf{x})\\right] + \\left[\\mathbf{x} - \\mathbf{x}_a\\right]^T \\mathbf{S}_a^{-1} \\left[\\mathbf{x} - \\mathbf{x}_a\\right]\n$$\n此处，$\\mathbf{x}_a$ 是先验状态向量，$\\mathbf{S}_a$ 是先验误差协方差矩阵，$\\mathbf{S}_e$ 是测量误差协方差矩阵。\n\n**4. 使用 Gauss-Newton 方法的迭代解**\n\n由于正向模型 $\\mathbf{F}(\\mathbf{x})$ 在 $T_s$ 上是非线性的，最小化 $J(\\mathbf{x})$ 需要采用迭代方法。我们采用 Gauss-Newton 方法。从一个初始猜测 $\\mathbf{x}_0$（通常是先验值 $\\mathbf{x}_a$）开始，状态被迭代更新：\n$$\n\\mathbf{x}_{i+1} = \\mathbf{x}_i + \\Delta \\mathbf{x}_i\n$$\n更新步长 $\\Delta \\mathbf{x}_i$ 是通过在当前状态估计 $\\mathbf{x}_i$ 周围对正向模型进行线性化，并求解线性化成本函数的最小值来找到的。这导致了以下用于更新向量 $\\Delta \\mathbf{x}_i$ 的线性系统：\n$$\n\\left[ \\mathbf{K}_i^T \\mathbf{S}_e^{-1} \\mathbf{K}_i + \\mathbf{S}_a^{-1} \\right] \\Delta \\mathbf{x}_i = \\mathbf{K}_i^T \\mathbf{S}_e^{-1} \\left[ \\mathbf{y} - \\mathbf{F}(\\mathbf{x}_i) \\right] - \\mathbf{S}_a^{-1} \\left[ \\mathbf{x}_i - \\mathbf{x}_a \\right]\n$$\n其中 $\\mathbf{K}_i$ 是在 $\\mathbf{x}_i$ 处求值的正向模型雅可比矩阵。\n\n**5. 雅可比矩阵**\n\n雅可比矩阵 $\\mathbf{K} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{x}}$ 包含正向模型关于状态向量每个元素的偏导数。对于我们的 2 通道、2 参数系统，它是一个 $2 \\times 2$ 矩阵：\n$$\n\\mathbf{K} = \\begin{bmatrix}\n\\frac{\\partial F_{\\lambda_1}}{\\partial T_s} & \\frac{\\partial F_{\\lambda_1}}{\\partial \\epsilon} \\\\\n\\frac{\\partial F_{\\lambda_2}}{\\partial T_s} & \\frac{\\partial F_{\\lambda_2}}{\\partial \\epsilon}\n\\end{bmatrix}\n$$\n解析导数为：\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial T_s} = \\tau_{\\lambda} \\, \\epsilon \\, \\frac{\\partial B_{\\lambda}(T_s)}{\\partial T_s}\n$$\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial \\epsilon} = \\tau_{\\lambda} \\left[ B_{\\lambda}(T_s) - L_{d,\\lambda} \\right]\n$$\n普朗克函数关于温度的导数由下式给出：\n$$\n\\frac{\\partial B_{\\lambda}}{\\partial T}(T) = \\frac{2 h c^2}{\\lambda^5} \\cdot \\frac{\\exp\\left(\\frac{h c}{\\lambda k T}\\right)}{\\left[\\exp\\left(\\frac{h c}{\\lambda k T}\\right)-1\\right]^2} \\cdot \\frac{h c}{\\lambda k T^2}\n$$\n与普朗克函数本身一样，该导数通过一个 $10^{-6}$ 的乘法因子转换为单位 $W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}K^{-1}$。\n\n**6. 算法实现与收敛**\n\n算法实现如下：\n1.  初始化状态向量：$\\mathbf{x}_0 = \\mathbf{x}_a$。\n2.  对于每次迭代 $i=0, 1, 2, ...$：\n    a. 评估正向模型 $\\mathbf{F}(\\mathbf{x}_i)$ 和雅可比矩阵 $\\mathbf{K}_i$。\n    b. 构建上述的状态更新线性系统。\n    c. 求解系统以获得 $\\Delta \\mathbf{x}_i$。这是通过使用标准的线性求解器进行数值计算完成的，这种方法比显式矩阵求逆更稳定。\n    d. 更新状态：$\\mathbf{x}_{i+1} = \\mathbf{x}_i + \\Delta \\mathbf{x}_i$。\n    e. 通过计算更新向量的欧几里得范数 $\\|\\Delta \\mathbf{x}_i\\|_2$ 来检查收敛性。如果 $\\|\\Delta \\mathbf{x}_i\\|_2 < 10^{-6}$，迭代停止。\n3.  如果达到最大迭代次数（$20$），过程也会终止。\n4.  终止后，使用最终反演的状态计算最终成本 $J(\\mathbf{x}_{\\text{final}})$。\n\n测试用例的执行方式是：首先使用提供的真实状态（$T_s^{\\text{true}}, \\epsilon^{\\text{true}}$）和大气参数生成“真实”测量向量 $\\mathbf{y}$，不添加任何随机噪声。然后，反演算法使用这个合成的测量值 $\\mathbf{y}$ 以及指定的先验信息（$\\mathbf{x}_a, \\mathbf{S}_a$）和测量不确定性（$\\mathbf{S}_e$）来反演状态。这种“孪生实验”的设置允许在理想（无噪声）条件下直接评估算法恢复真实状态的能力。",
            "answer": "[300.0000000216524,0.9799999999081254,4,True,4.453315663737332,309.99999995577626,0.9200000001550974,5,True,5.286282247545304,280.000000002237,0.9989999999988223,5,True,25.044036000018595,294.999999955074,0.9000000002196025,7,True,2.8271383501257493]"
        }
    ]
}