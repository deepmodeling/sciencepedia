{
    "hands_on_practices": [
        {
            "introduction": "Before retrieving temperature from a satellite's thermal measurement, we must first understand the instrument's fundamental sensitivity. This practice introduces the concept of Noise-Equivalent Delta Temperature (NE$\\Delta$T), a key metric that quantifies the smallest temperature difference a sensor can theoretically detect. By deriving the relationship between radiance noise and temperature noise from Planck's law, you will gain a first-principles understanding of an instrument's precision. ",
            "id": "3823905",
            "problem": "A thermal infrared imaging spectroradiometer is used for land surface temperature retrieval over a scene that can be treated as a near-blackbody emitter and is observed through a dry, isothermal atmosphere with negligible path effects. Focus on a single narrow band centered at wavelength $\\lambda_c = 10.8\\,\\mu\\text{m}$ with a rectangular spectral response of negligible width, so that the band-averaged spectral radiance equals the monochromatic spectral radiance at $\\lambda_c$. The scene temperature is $T_s = 300\\,\\text{K}$. The instrument reports the band-averaged spectral radiance with a one-standard-deviation radiometric noise of $\\sigma_{L_b} = 2.0 \\times 10^{-2}\\ \\text{W}\\ \\text{m}^{-2}\\ \\text{sr}^{-1}\\ \\mu\\text{m}^{-1}$.\n\nStart from Planck’s law for monochromatic spectral radiance per unit wavelength,\n$$\nL_{\\lambda}(\\lambda,T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1},\n$$\nwhere $h$ is Planck’s constant, $c$ is the speed of light, and $k_{B}$ is the Boltzmann constant.\n\nUsing only fundamental definitions and first-order linearization about $T_s$, derive how the Noise-Equivalent Delta Temperature (NE$\\Delta$T) relates to the instrument’s radiance noise via the temperature sensitivity of radiance, and then evaluate NE$\\Delta$T numerically for this band and scene. Use the constants $h = 6.62607015 \\times 10^{-34}\\ \\text{J}\\,\\text{s}$, $c = 2.99792458 \\times 10^{8}\\ \\text{m}\\,\\text{s}^{-1}$, and $k_{B} = 1.380649 \\times 10^{-23}\\ \\text{J}\\,\\text{K}^{-1}$. Express your final result in kelvin and round your answer to three significant figures.",
            "solution": "The problem requires the derivation and numerical evaluation of the Noise-Equivalent Delta Temperature (NE$\\Delta$T). This quantity represents the change in temperature of a target that produces a change in measured radiance equal to the instrument's radiometric noise. The derivation will be based on a first-order linearization of Planck's law.\n\nFirst, the definition of NE$\\Delta$T is formalized. A small change in temperature, $\\Delta T$, around a central temperature $T_s$, results in a small change in spectral radiance, $\\Delta L_{\\lambda}$, which can be approximated by the first term of a Taylor series expansion:\n$$\n\\Delta L_{\\lambda} \\approx \\frac{\\partial L_{\\lambda}}{\\partial T}\\bigg|_{T=T_s} \\Delta T\n$$\nThe NE$\\Delta$T is the value of $\\Delta T$ for which the radiance change $\\Delta L_{\\lambda}$ is equal to the one-standard-deviation radiometric noise of the instrument, $\\sigma_{L_b}$. The problem specifies that the band-averaged radiance can be treated as the monochromatic radiance at the band center, $\\lambda_c$. Thus, we can write:\n$$\n\\sigma_{L_b} = \\left| \\frac{\\partial L_{\\lambda}}{\\partial T}\\bigg|_{T=T_s, \\lambda=\\lambda_c} \\right| \\cdot \\text{NE}\\Delta\\text{T}\n$$\nThis equation can be rearranged to solve for NE$\\Delta$T:\n$$\n\\text{NE}\\Delta\\text{T} = \\frac{\\sigma_{L_b}}{\\left| \\frac{\\partial L_{\\lambda}}{\\partial T}\\bigg|_{T=T_s, \\lambda=\\lambda_c} \\right|}\n$$\nThe core of the problem is to compute the temperature sensitivity of the spectral radiance, $\\frac{\\partial L_{\\lambda}}{\\partial T}$, using the provided form of Planck's law:\n$$\nL_{\\lambda}(\\lambda,T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1}\n$$\nTo facilitate differentiation, we introduce the constants $C_1 = 2 h c^2$ and $C_2 = \\frac{h c}{k_B}$, rewriting the law as:\n$$\nL_{\\lambda}(\\lambda,T) = \\frac{C_1}{\\lambda^{5}} \\left[ \\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1 \\right]^{-1}\n$$\nWe differentiate $L_{\\lambda}$ with respect to temperature $T$ using the chain rule:\n$$\n\\frac{\\partial L_{\\lambda}}{\\partial T} = \\frac{C_1}{\\lambda^{5}} \\cdot (-1) \\left[ \\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1 \\right]^{-2} \\cdot \\frac{\\partial}{\\partial T} \\left[ \\exp\\left(\\frac{C_2}{\\lambda T}\\right) \\right]\n$$\nThe derivative of the exponential term is:\n$$\n\\frac{\\partial}{\\partial T} \\left[ \\exp\\left(\\frac{C_2}{\\lambda T}\\right) \\right] = \\exp\\left(\\frac{C_2}{\\lambda T}\\right) \\cdot \\frac{\\partial}{\\partial T}\\left(\\frac{C_2}{\\lambda T}\\right) = \\exp\\left(\\frac{C_2}{\\lambda T}\\right) \\cdot \\left( -\\frac{C_2}{\\lambda T^2} \\right)\n$$\nSubstituting this back into the expression for $\\frac{\\partial L_{\\lambda}}{\\partial T}$ and simplifying:\n$$\n\\frac{\\partial L_{\\lambda}}{\\partial T} = \\frac{C_1}{\\lambda^{5}} (-1) \\left[ \\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1 \\right]^{-2} \\exp\\left(\\frac{C_2}{\\lambda T}\\right) \\left( -\\frac{C_2}{\\lambda T^2} \\right) = \\frac{C_1 C_2}{\\lambda^6 T^2} \\frac{\\exp\\left(\\frac{C_2}{\\lambda T}\\right)}{\\left[ \\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1 \\right]^2}\n$$\nThis derivative can be expressed more conveniently in terms of the original Planck function $L_{\\lambda}(\\lambda, T)$:\n$$\n\\frac{\\partial L_{\\lambda}}{\\partial T} = \\left[ \\frac{C_1}{\\lambda^5 \\left( \\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1 \\right)} \\right] \\cdot \\frac{C_2}{\\lambda T^2} \\frac{\\exp\\left(\\frac{C_2}{\\lambda T}\\right)}{\\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1} = L_{\\lambda}(\\lambda, T) \\cdot \\frac{C_2}{\\lambda T^2} \\frac{\\exp\\left(\\frac{C_2}{\\lambda T}\\right)}{\\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1}\n$$\nFor physical temperatures, the derivative is positive, so the absolute value is not needed. The problem assumes a near-blackbody ($\\epsilon=1$) and negligible atmospheric effects, allowing us to use Planck's law evaluated at the surface temperature $T_s$.\n\nWe now proceed to the numerical calculation using the given values:\n$\\lambda_c = 10.8\\,\\mu\\text{m} = 10.8 \\times 10^{-6}\\,\\text{m}$\n$T_s = 300\\,\\text{K}$\n$\\sigma_{L_b} = 2.0 \\times 10^{-2}\\ \\text{W}\\ \\text{m}^{-2}\\ \\text{sr}^{-1}\\ \\mu\\text{m}^{-1}$\n$h = 6.62607015 \\times 10^{-34}\\ \\text{J}\\,\\text{s}$\n$c = 2.99792458 \\times 10^{8}\\ \\text{m}\\,\\text{s}^{-1}$\n$k_{B} = 1.380649 \\times 10^{-23}\\ \\text{J}\\,\\text{K}^{-1}$\n\nFirst, we compute the dimensionless argument of the exponential, which we denote as $x$:\n$$\nx = \\frac{h c}{\\lambda_c k_{B} T_s} = \\frac{(6.62607015 \\times 10^{-34}) (2.99792458 \\times 10^{8})}{(10.8 \\times 10^{-6}) (1.380649 \\times 10^{-23}) (300)} \\approx 4.43878\n$$\nA critical step is to ensure unit consistency. Planck's law as written yields spectral radiance in SI units of $\\text{W}\\ \\text{m}^{-2}\\ \\text{sr}^{-1}\\ \\text{m}^{-1}$, whereas the given noise $\\sigma_{L_b}$ is in units of $\\text{W}\\ \\text{m}^{-2}\\ \\text{sr}^{-1}\\ \\mu\\text{m}^{-1}$. The conversion relies on the fact that $1\\,\\mu\\text{m} = 10^{-6}\\,\\text{m}$. Therefore, radiance per micrometer is $10^{-6}$ times the radiance per meter. This factor applies to the derivative as well:\n$$\n\\frac{\\partial L_{\\lambda, \\text{units of }\\mu\\text{m}^{-1}}}{\\partial T} = \\frac{\\partial L_{\\lambda, \\text{units of }\\text{m}^{-1}}}{\\partial T} \\times 10^{-6}\n$$\nLet's first calculate the derivative in SI units, denoted $\\frac{\\partial L^{\\text{SI}}}{\\partial T}$, evaluated at $T_s = 300\\,\\text{K}$ and $\\lambda_c = 10.8 \\times 10^{-6}\\,\\text{m}$.\nWe first compute the radiance $L^{\\text{SI}}(\\lambda_c, T_s)$:\n$$\nL^{\\text{SI}} = \\frac{2 h c^2}{\\lambda_c^5 (\\exp(x)-1)} = \\frac{2 (6.626... \\times 10^{-34}) (2.997... \\times 10^8)^2}{(10.8 \\times 10^{-6})^5 (\\exp(4.43878)-1)} \\approx 9.6899 \\times 10^{6} \\text{ W m}^{-2}\\text{sr}^{-1}\\text{m}^{-1}\n$$\nNow we compute the derivative in SI units:\n$$\n\\frac{\\partial L^{\\text{SI}}}{\\partial T} = L^{\\text{SI}} \\cdot \\frac{x}{T_s} \\cdot \\frac{\\exp(x)}{\\exp(x) - 1} = (9.6899 \\times 10^6) \\cdot \\frac{4.43878}{300} \\cdot \\frac{\\exp(4.43878)}{\\exp(4.43878) - 1}\n$$\n$$\n\\frac{\\partial L^{\\text{SI}}}{\\partial T} \\approx (9.6899 \\times 10^6) \\cdot (0.014796) \\cdot (1.01195) \\approx 1.4503 \\times 10^5 \\text{ W m}^{-2}\\text{sr}^{-1}\\text{m}^{-1}\\text{K}^{-1}\n$$\nNext, we convert this sensitivity to match the units of the noise (per micrometer):\n$$\n\\frac{\\partial L_b}{\\partial T_s} = (1.4503 \\times 10^5) \\times 10^{-6} \\approx 0.14503 \\text{ W m}^{-2}\\text{sr}^{-1}\\mu\\text{m}^{-1}\\text{K}^{-1}\n$$\nFinally, we calculate the NE$\\Delta$T using its definition:\n$$\n\\text{NE}\\Delta\\text{T} = \\frac{\\sigma_{L_b}}{\\frac{\\partial L_b}{\\partial T_s}} = \\frac{2.0 \\times 10^{-2}}{0.14503} \\text{ K} \\approx 0.13789 \\text{ K}\n$$\nThe problem asks for the answer to be rounded to $3$ significant figures.\n$$\n\\text{NE}\\Delta\\text{T} \\approx 0.138 \\text{ K}\n$$",
            "answer": "$$\n\\boxed{0.138}\n$$"
        },
        {
            "introduction": "Land surfaces are rarely uniform, and a single satellite pixel often contains a mix of components like soil and vegetation, each with its own thermal properties. This exercise tackles the critical challenge of determining the effective emissivity for such a heterogeneous surface, a crucial parameter for accurate LST retrieval. You will derive a model from first principles that accounts not only for the component properties but also for the 'cavity effect,' an increase in emissivity caused by radiation trapping and multiple reflections between surface elements. ",
            "id": "3823903",
            "problem": "A square satellite pixel contains a spatially heterogeneous land surface with fractional vegetation cover $f_v \\in [0,1]$ and fractional bare soil cover $1 - f_v$. Assume both the vegetation and soil components are opaque, isothermal, and behave as diffuse Lambertian emitters and reflectors in the thermal infrared. Let the component emissivities be $\\epsilon_v$ for vegetation and $\\epsilon_s$ for soil, and denote the corresponding directional-hemispherical reflectivities by $\\rho_v = 1 - \\epsilon_v$ and $\\rho_s = 1 - \\epsilon_s$ by Kirchhoff’s law of thermal radiation for opaque materials. \n\nModel sub-pixel multiple reflections between vegetation and soil using a symmetric, dimensionless, geometry parameter $\\Gamma \\in [0,1]$ with the following interpretation: for flux reflected from vegetation, a fraction $\\Gamma(1 - f_v)$ is intercepted by soil and a fraction $1 - \\Gamma(1 - f_v)$ escapes the pixel to the hemisphere; for flux reflected from soil, a fraction $\\Gamma f_v$ is intercepted by vegetation and a fraction $1 - \\Gamma f_v$ escapes the pixel. Neglect any atmospheric effects within the pixel and any transmission through the media.\n\nUsing only the above physical assumptions and the equality of emissivity and absorptivity for opaque surfaces, derive from first principles a closed-form expression for the effective pixel emissivity $\\epsilon_{\\mathrm{eff}}$ as a function of $f_v$, $\\epsilon_v$, $\\epsilon_s$, and $\\Gamma$, accounting for an infinite series of vegetation–soil interreflections (the “cavity effect”). Express your final answer as a single closed-form analytic expression for $\\epsilon_{\\mathrm{eff}}$ in terms of $f_v$, $\\epsilon_v$, $\\epsilon_s$, and $\\Gamma$. No numerical evaluation is required. Provide the exact expression; do not approximate or truncate the series.",
            "solution": "The problem asks for the effective emissivity, $\\epsilon_{\\mathrm{eff}}$, of a mixed pixel composed of vegetation and bare soil. According to Kirchhoff's law of thermal radiation for an opaque body in thermal equilibrium, its emissivity is equal to its absorptivity. We will therefore derive the effective absorptivity, $\\alpha_{\\mathrm{eff}}$, of the pixel, which is equal to $\\epsilon_{\\mathrm{eff}}$.\n\nThe effective absorptivity $\\alpha_{\\mathrm{eff}}$ is defined as the fraction of incident radiation that is absorbed by the pixel. To calculate this, we can model the fate of an external, uniform hemispherical irradiance, $E_{in}$, incident upon the pixel. The value of $\\alpha_{\\mathrm{eff}}$ is independent of $E_{in}$, so for simplicity, we can set the incident irradiance to unity, $E_{in} = 1$. The total power absorbed by the pixel will then be numerically equal to $\\alpha_{\\mathrm{eff}}$.\n\nThe pixel consists of two components: vegetation with fractional area $f_v$ and soil with fractional area $1 - f_v$. Let $H_v$ and $H_s$ be the total irradiance (flux per unit area) incident on the vegetation and soil surfaces, respectively. This total irradiance is the sum of the external irradiance and the irradiance from multiple reflections between the soil and vegetation components.\n\nThe external irradiance on both surfaces is $E_{in} = 1$.\nThe irradiance on the vegetation surface that comes from reflections off the soil surface is denoted $H_{v \\leftarrow s}$.\nThe irradiance on the soil surface that comes from reflections off the vegetation surface is denoted $H_{s \\leftarrow v}$.\n\nThe total irradiance on each component is thus:\n$$ H_v = E_{in} + H_{v \\leftarrow s} = 1 + H_{v \\leftarrow s} $$\n$$ H_s = E_{in} + H_{s \\leftarrow v} = 1 + H_{s \\leftarrow v} $$\n\nTo determine $H_{v \\leftarrow s}$ and $H_{s \\leftarrow v}$, we use the model provided in the problem statement. The total power reflected by the vegetation component, which has area $f_v A_{pix}$ (where $A_{pix}$ is the pixel area), is $P_{refl, v} = (H_v A_v) \\rho_v = H_v f_v A_{pix} \\rho_v$, where $\\rho_v = 1 - \\epsilon_v$ is the reflectivity of the vegetation. The problem states that a fraction $\\Gamma(1-f_v)$ of the flux reflected from vegetation is intercepted by soil. The power intercepted by the soil is thus $P_{v \\to s} = P_{refl, v} \\Gamma(1-f_v)$. The irradiance on the soil surface (area $(1-f_v)A_{pix}$) due to this intercepted power is:\n$$ H_{s \\leftarrow v} = \\frac{P_{v \\to s}}{A_s} = \\frac{H_v f_v A_{pix} \\rho_v \\Gamma(1-f_v)}{(1-f_v)A_{pix}} = \\Gamma f_v \\rho_v H_v $$\n\nSimilarly, the total power reflected by the soil component (area $(1-f_v)A_{pix}$) is $P_{refl, s} = (H_s A_s) \\rho_s = H_s(1-f_v)A_{pix}\\rho_s$, where $\\rho_s = 1 - \\epsilon_s$. A fraction $\\Gamma f_v$ of this flux is intercepted by vegetation. The power intercepted by vegetation is $P_{s \\to v} = P_{refl, s} \\Gamma f_v$. The irradiance on the vegetation surface (area $f_v A_{pix}$) is:\n$$ H_{v \\leftarrow s} = \\frac{P_{s \\to v}}{A_v} = \\frac{H_s(1-f_v)A_{pix}\\rho_s \\Gamma f_v}{f_v A_{pix}} = \\Gamma(1-f_v)\\rho_s H_s $$\n\nWe can now write a system of two coupled linear equations for the total irradiances $H_v$ and $H_s$:\n$$ H_v = 1 + \\Gamma(1-f_v)\\rho_s H_s $$\n$$ H_s = 1 + \\Gamma f_v \\rho_v H_v $$\n\nWe can solve this system. Substitute the second equation into the first:\n$$ H_v = 1 + \\Gamma(1-f_v)\\rho_s (1 + \\Gamma f_v \\rho_v H_v) $$\n$$ H_v = 1 + \\Gamma(1-f_v)\\rho_s + \\Gamma^2 f_v(1-f_v)\\rho_v\\rho_s H_v $$\n$$ H_v(1 - \\Gamma^2 f_v(1-f_v)\\rho_v\\rho_s) = 1 + \\Gamma(1-f_v)\\rho_s $$\nLet the denominator be $D = 1 - \\Gamma^2 f_v(1-f_v)\\rho_v\\rho_s$. Then:\n$$ H_v = \\frac{1 + \\Gamma(1-f_v)\\rho_s}{D} $$\n\nBy symmetry, we can find $H_s$:\n$$ H_s = \\frac{1 + \\Gamma f_v \\rho_v}{D} $$\n\nNow that we have the total irradiance on each component, we can calculate the total power absorbed by the pixel. The absorbed power is the sum of the power absorbed by the vegetation and the power absorbed by the soil. The absorptivity of each component is equal to its emissivity ($\\alpha_v = \\epsilon_v$, $\\alpha_s = \\epsilon_s$).\nThe power absorbed per unit pixel area is:\n$$ P_{abs} = \\frac{H_v \\epsilon_v A_v + H_s \\epsilon_s A_s}{A_{pix}} = H_v \\epsilon_v f_v + H_s \\epsilon_s (1-f_v) $$\n\nThe effective absorptivity is $\\alpha_{\\mathrm{eff}} = P_{abs} / E_{in}$. Since we set $E_{in}=1$, $\\alpha_{\\mathrm{eff}} = P_{abs}$.\n$$ \\alpha_{\\mathrm{eff}} = f_v \\epsilon_v H_v + (1-f_v) \\epsilon_s H_s $$\nSubstituting the expressions for $H_v$ and $H_s$:\n$$ \\alpha_{\\mathrm{eff}} = \\frac{f_v \\epsilon_v (1 + \\Gamma(1-f_v)\\rho_s) + (1-f_v) \\epsilon_s (1 + \\Gamma f_v \\rho_v)}{D} $$\nExpanding the numerator:\n$$ \\text{Numerator} = f_v \\epsilon_v + f_v \\epsilon_v \\Gamma(1-f_v)\\rho_s + (1-f_v)\\epsilon_s + (1-f_v)\\epsilon_s \\Gamma f_v \\rho_v $$\n$$ \\text{Numerator} = f_v \\epsilon_v + (1-f_v)\\epsilon_s + f_v(1-f_v)\\Gamma(\\epsilon_v\\rho_s + \\epsilon_s\\rho_v) $$\nSo the effective absorptivity is:\n$$ \\alpha_{\\mathrm{eff}} = \\frac{f_v \\epsilon_v + (1-f_v)\\epsilon_s + f_v(1-f_v)\\Gamma(\\epsilon_v\\rho_s + \\epsilon_s\\rho_v)}{1 - \\Gamma^2 f_v(1-f_v)\\rho_v\\rho_s} $$\n\nFinally, we express the result in terms of the given parameters $f_v, \\epsilon_v, \\epsilon_s, \\Gamma$ by substituting $\\rho_v = 1 - \\epsilon_v$ and $\\rho_s = 1 - \\epsilon_s$.\nThe term $\\epsilon_v\\rho_s + \\epsilon_s\\rho_v$ becomes:\n$$ \\epsilon_v(1-\\epsilon_s) + \\epsilon_s(1-\\epsilon_v) = \\epsilon_v - \\epsilon_v\\epsilon_s + \\epsilon_s - \\epsilon_s\\epsilon_v = \\epsilon_v + \\epsilon_s - 2\\epsilon_v\\epsilon_s $$\nThe term $\\rho_v\\rho_s$ becomes $(1-\\epsilon_v)(1-\\epsilon_s)$.\n\nSubstituting these into the expression for $\\alpha_{\\mathrm{eff}}$ gives the final closed-form expression for the effective emissivity $\\epsilon_{\\mathrm{eff}} = \\alpha_{\\mathrm{eff}}$:\n$$ \\epsilon_{\\mathrm{eff}} = \\frac{f_v \\epsilon_v + (1-f_v)\\epsilon_s + f_v(1-f_v)\\Gamma(\\epsilon_v + \\epsilon_s - 2\\epsilon_v\\epsilon_s)}{1 - \\Gamma^2 f_v(1-f_v)(1-\\epsilon_v)(1-\\epsilon_s)} $$\nThis expression represents the total emissivity of the pixel, accounting for the single scattering contributions (the linear mixing term $f_v \\epsilon_v + (1-f_v)\\epsilon_s$) and the enhancement due to the infinite series of multiple reflections between the vegetation and soil components (the \"cavity effect\").",
            "answer": "$$\\boxed{\\frac{f_v \\epsilon_v + (1-f_v)\\epsilon_s + f_v(1-f_v)\\Gamma(\\epsilon_v + \\epsilon_s - 2\\epsilon_v\\epsilon_s)}{1 - \\Gamma^{2} f_v(1-f_v)(1-\\epsilon_v)(1-\\epsilon_s)}}$$"
        },
        {
            "introduction": "LST retrieval is fundamentally an inverse problem: we use a physical model to work backward from satellite-measured radiances to the temperature that caused them. This process is highly sensitive to our knowledge of surface and atmospheric parameters, especially surface emissivity. In this comprehensive coding exercise, you will implement the full radiative transfer model to simulate satellite observations and then invert it to retrieve LST, allowing you to directly quantify the bias introduced when emissivity is incorrectly specified. ",
            "id": "3823833",
            "problem": "You are asked to implement a physically based two-channel split-window retrieval of Land Surface Temperature (LST) from thermal infrared radiances and to quantify emissivity-driven biases when a naive emissivity assumption is used. The retrieval must be grounded in first principles: Planck’s law and the thermal infrared radiative transfer equation. You will explicitly simulate Top-of-Atmosphere (TOA) radiances for two thermal channels given a true surface temperature, atmospheric transmittance, atmospheric path radiance, downwelling atmospheric radiance, and surface emissivities. You will then retrieve LST by fitting both channels simultaneously under two emissivity settings: the true emissivities and a naive constant emissivity assumption. The emissivity-driven bias is defined as the difference between the LST retrieved using the naive emissivity and the LST retrieved using the true emissivities.\n\nFundamental base:\n- Planck’s law (spectral radiance per unit wavelength): for wavelength $\\lambda$ (in meters) and physical temperature $T$ (in Kelvin),\n$$\nB_\\lambda(\\lambda, T) = \\frac{2 h c^2}{\\lambda^5} \\left( \\exp\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1 \\right)^{-1},\n$$\nwhere $h$ is Planck’s constant, $c$ is the speed of light, and $k_B$ is Boltzmann’s constant.\n- Thermal infrared (TIR) top-of-atmosphere radiance for channel $i$ with atmospheric transmittance $\\tau_i$, upwelling path radiance $L_{\\text{up},i}$, downwelling atmospheric radiance $L_{\\text{down},i}$, surface emissivity $\\varepsilon_i$, surface temperature $T_s$, and channel central wavelength $\\lambda_i$ (narrow-band approximation),\n$$\nL_{\\text{TOA},i}(T_s) = \\tau_i \\left[ \\varepsilon_i B_\\lambda(\\lambda_i, T_s) + (1 - \\varepsilon_i) L_{\\text{down},i} \\right] + L_{\\text{up},i}.\n$$\n\nRetrieval design requirement:\n- Use both channels jointly. Given observed two-channel TOA radiances $L_{\\text{TOA},1}^{\\text{obs}}$ and $L_{\\text{TOA},2}^{\\text{obs}}$ generated from the true parameters, retrieve $T_s$ by minimizing the sum of squared residuals across channels,\n$$\nJ(T_s;\\,\\varepsilon_1,\\varepsilon_2) = \\sum_{i=1}^{2} \\left( L_{\\text{TOA},i}(T_s) - L_{\\text{TOA},i}^{\\text{obs}} \\right)^2,\n$$\nwith respect to $T_s$ over a physically plausible interval. Perform this minimization twice: once with the true emissivities $(\\varepsilon_1,\\varepsilon_2)$ and once with a naive emissivity assumption $(\\hat{\\varepsilon}_1,\\hat{\\varepsilon}_2)$.\n- Define the emissivity-driven bias $\\Delta T$ for a case as\n$$\n\\Delta T = T_s^{\\text{naive}} - T_s^{\\text{true-fit}},\n$$\nwhere $T_s^{\\text{naive}}$ is the minimizer under $(\\hat{\\varepsilon}_1,\\hat{\\varepsilon}_2)$ and $T_s^{\\text{true-fit}}$ is the minimizer under the true $(\\varepsilon_1,\\varepsilon_2)$. Express all biases in Kelvin.\n\nChannels:\n- Use two Thermal Infrared (TIR) channels with central wavelengths $\\lambda_1 = 10.8\\,\\mu\\text{m}$ and $\\lambda_2 = 12.0\\,\\mu\\text{m}$, i.e., $\\lambda_1 = 10.8 \\times 10^{-6}\\,\\text{m}$ and $\\lambda_2 = 12.0 \\times 10^{-6}\\,\\text{m}$.\n\nNaive emissivity assumption:\n- Use $(\\hat{\\varepsilon}_1, \\hat{\\varepsilon}_2) = (0.98, 0.98)$ for all surfaces.\n\nTest suite:\n- For each case, specify $(T_s^{\\text{true}}, \\varepsilon_1, \\varepsilon_2, \\tau_1, \\tau_2, L_{\\text{up},1}, L_{\\text{up},2}, L_{\\text{down},1}, L_{\\text{down},2})$; simulate $L_{\\text{TOA},i}^{\\text{obs}}$ using the forward model with the true parameters.\n\nCase 1 (desert, dry):\n- $T_s^{\\text{true}} = 320\\,\\text{K}$,\n- $(\\varepsilon_1, \\varepsilon_2) = (0.92, 0.89)$,\n- $(\\tau_1, \\tau_2) = (0.85, 0.80)$,\n- $(L_{\\text{up},1}, L_{\\text{up},2}) = (1.2, 1.6)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $(L_{\\text{down},1}, L_{\\text{down},2}) = (3.0, 3.5)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n\nCase 2 (desert, humid):\n- $T_s^{\\text{true}} = 320\\,\\text{K}$,\n- $(\\varepsilon_1, \\varepsilon_2) = (0.92, 0.89)$,\n- $(\\tau_1, \\tau_2) = (0.65, 0.55)$,\n- $(L_{\\text{up},1}, L_{\\text{up},2}) = (2.5, 3.2)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $(L_{\\text{down},1}, L_{\\text{down},2}) = (6.0, 7.0)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n\nCase 3 (vegetation, dry):\n- $T_s^{\\text{true}} = 300\\,\\text{K}$,\n- $(\\varepsilon_1, \\varepsilon_2) = (0.98, 0.98)$,\n- $(\\tau_1, \\tau_2) = (0.85, 0.80)$,\n- $(L_{\\text{up},1}, L_{\\text{up},2}) = (1.2, 1.6)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $(L_{\\text{down},1}, L_{\\text{down},2}) = (3.0, 3.5)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n\nCase 4 (vegetation, humid):\n- $T_s^{\\text{true}} = 300\\,\\text{K}$,\n- $(\\varepsilon_1, \\varepsilon_2) = (0.98, 0.98)$,\n- $(\\tau_1, \\tau_2) = (0.65, 0.55),\n- $(L_{\\text{up},1}, L_{\\text{up},2}) = (2.5, 3.2)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $(L_{\\text{down},1}, L_{\\text{down},2}) = (6.0, 7.0)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n\nCase 5 (desert, very low emissivity, very humid; edge case):\n- $T_s^{\\text{true}} = 330\\,\\text{K}$,\n- $(\\varepsilon_1, \\varepsilon_2) = (0.85, 0.80)$,\n- $(\\tau_1, \\tau_2) = (0.50, 0.40)$,\n- $(L_{\\text{up},1}, L_{\\text{up},2}) = (3.0, 4.0)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $(L_{\\text{down},1}, L_{\\text{down},2}) = (8.0, 9.5)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n\nImplementation requirements:\n- Simulate $L_{\\text{TOA},i}^{\\text{obs}}$ for each case using the forward model with the true parameters.\n- For each case, perform two fits:\n  1. Minimization using the true emissivities $(\\varepsilon_1, \\varepsilon_2)$ to obtain $T_s^{\\text{true-fit}}$.\n  2. Minimization using the naive emissivities $(\\hat{\\varepsilon}_1, \\hat{\\varepsilon}_2)$ to obtain $T_s^{\\text{naive}}$.\n- Compute the emissivity-driven bias $\\Delta T$ in Kelvin for each case and round each to three decimal places.\n\nUnits:\n- Temperatures must be in Kelvin.\n- Radiances must be in $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n- Wavelengths must be in meters within computations, with channel definitions given in micrometers converted to meters.\n\nFinal output format:\n- Your program should produce a single line of output containing the emissivity-driven biases for all five test cases as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4,x_5]$, where each $x_i$ is a float in Kelvin rounded to three decimal places.",
            "solution": "The problem statement is scientifically grounded, well-posed, and complete. It describes a standard procedure in quantitative thermal remote sensing for retrieving Land Surface Temperature (LST) and assessing the impact of emissivity uncertainty. The physical model is based on fundamental principles, namely Planck's law of black-body radiation and the simplified radiative transfer equation for a non-scattering atmosphere in the thermal infrared. All required parameters, constants, and procedural steps are explicitly provided. The problem is therefore valid.\n\nThe solution proceeds in three main stages:\n1.  **Forward Simulation**: We first simulate the Top-of-Atmosphere (TOA) radiances that a satellite sensor would measure for two thermal channels. This is achieved using the provided radiative transfer model and the \"true\" parameters for each test case.\n2.  **Inverse Retrieval**: We then invert this process to retrieve the LST ($T_s$). The retrieval is formulated as a non-linear optimization problem. We seek the temperature $T_s$ that minimizes the sum of squared differences between the radiances predicted by the model and the \"observed\" radiances simulated in the first step.\n3.  **Bias Quantification**: The retrieval is performed twice for each case. The first retrieval uses the true surface emissivities $(\\varepsilon_1, \\varepsilon_2)$, yielding a reference LST, $T_s^{\\text{true-fit}}$. The second retrieval uses a naive, constant emissivity assumption $(\\hat{\\varepsilon}_1, \\hat{\\varepsilon}_2)$, yielding a biased LST, $T_s^{\\text{naive}}$. The emissivity-driven bias is the difference $\\Delta T = T_s^{\\text{naive}} - T_s^{\\text{true-fit}}$.\n\n**1. Physical and Mathematical Formulation**\n\nThe foundation of the model is Planck's law, which gives the spectral radiance $B_\\lambda$ of a black body at temperature $T$ as a function of wavelength $\\lambda$. The formula is:\n$$\nB_\\lambda(\\lambda, T) = \\frac{2 h c^2}{\\lambda^5} \\left( \\exp\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1 \\right)^{-1}\n$$\nwhere $h$ is Planck's constant ($6.62607015 \\times 10^{-34}\\,\\text{J}\\,\\text{s}$), $c$ is the speed of light ($2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}$), and $k_B$ is the Boltzmann constant ($1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$). This formula provides radiance in units of $\\text{W}\\,\\text{m}^{-3}\\,\\text{sr}^{-1}$. As the problem specifies radiances in $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$, a conversion factor of $10^{-6}$ is applied to the output of the Planck function to match units.\n\nThe TOA radiance, $L_{\\text{TOA},i}$, for a given channel $i$ is modeled by the radiative transfer equation (RTE):\n$$\nL_{\\text{TOA},i}(T_s) = \\tau_i \\left[ \\varepsilon_i B_\\lambda(\\lambda_i, T_s) + (1 - \\varepsilon_i) L_{\\text{down},i} \\right] + L_{\\text{up},i}\n$$\nHere, $\\tau_i$ is the atmospheric transmittance, $\\varepsilon_i$ is the surface emissivity, $L_{\\text{down},i}$ is the downwelling atmospheric radiance, and $L_{\\text{up},i}$ is the upwelling atmospheric path radiance for channel $i$. The two channels are centered at $\\lambda_1 = 10.8 \\times 10^{-6}\\,\\text{m}$ and $\\lambda_2 = 12.0 \\times 10^{-6}\\,\\text{m}$.\n\n**2. Algorithmic Implementation**\n\nFor each of the five test cases, we first simulate the \"observed\" radiances, $L_{\\text{TOA},1}^{\\text{obs}}$ and $L_{\\text{TOA},2}^{\\text{obs}}$, by applying the RTE with all the true parameters provided for that case, including the true surface temperature $T_s^{\\text{true}}$.\n\nNext, we establish the cost function $J(T_s)$ for the retrieval:\n$$\nJ(T_s;\\,\\varepsilon_1,\\varepsilon_2) = \\sum_{i=1}^{2} \\left( L_{\\text{TOA},i}(T_s; \\varepsilon_i, \\tau_i, L_{\\text{up},i}, L_{\\text{down},i}) - L_{\\text{TOA},i}^{\\text{obs}} \\right)^2\n$$\nThe retrieval of $T_s$ involves finding the temperature that minimizes this cost function. Since $L_{\\text{TOA},i}(T_s)$ is a strictly monotonic function of $T_s$, the cost function $J(T_s)$ is convex and has a unique minimum. We can find this minimum using a numerical optimization algorithm. A one-dimensional bounded minimizer, such as `scipy.optimize.minimize_scalar`, is well-suited for this task. We define a physically plausible search interval for $T_s$, such as [$200\\,\\text{K}$, $400\\,\\text{K}$].\n\nThis minimization is performed twice:\n1.  **True-Fit Retrieval**: We minimize $J(T_s; \\varepsilon_1, \\varepsilon_2)$ using the true emissivities $(\\varepsilon_1, \\varepsilon_2)$ from the test case. The resulting temperature is $T_s^{\\text{true-fit}}$. In an ideal scenario with no numerical error, this should be equal to $T_s^{\\text{true}}$.\n2.  **Naive-Fit Retrieval**: We minimize $J(T_s; \\hat{\\varepsilon}_1, \\hat{\\varepsilon}_2)$ using the naive emissivities $(\\hat{\\varepsilon}_1, \\hat{\\varepsilon}_2) = (0.98, 0.98)$. The resulting temperature is $T_s^{\\text{naive}}$.\n\nFinally, the emissivity-driven bias for the case is computed as $\\Delta T = T_s^{\\text{naive}} - T_s^{\\text{true-fit}}$. The results for all five cases are collected, rounded to three decimal places, and formatted as specified. For cases where the true emissivity equals the naive assumption (Cases 3 and 4), the bias $\\Delta T$ is expected to be $0$. For cases where the true emissivity is lower than the naive assumption (Cases 1, 2, 5), the retrieval algorithm will compensate for the overestimated emissivity $\\hat{\\varepsilon}_i$ by finding a lower temperature $T_s^{\\text{naive}}$, resulting in a negative bias.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the LST retrieval problem for all test cases and prints the results.\n    \"\"\"\n    # Physical Constants\n    H = 6.62607015e-34  # Planck's constant (J s)\n    C = 2.99792458e8    # Speed of light (m/s)\n    KB = 1.380649e-23   # Boltzmann constant (J/K)\n    \n    # Channel Wavelengths (m)\n    LAMBDA_1 = 10.8e-6\n    LAMBDA_2 = 12.0e-6\n\n    # Naive Emissivity Assumption\n    EPS_NAIVE = (0.98, 0.98)\n\n    # Test cases data\n    test_cases = [\n        # Case 1 (desert, dry)\n        {\n            \"Ts_true\": 320.0,\n            \"eps_true\": (0.92, 0.89),\n            \"tau\": (0.85, 0.80),\n            \"L_up\": (1.2, 1.6),\n            \"L_down\": (3.0, 3.5),\n        },\n        # Case 2 (desert, humid)\n        {\n            \"Ts_true\": 320.0,\n            \"eps_true\": (0.92, 0.89),\n            \"tau\": (0.65, 0.55),\n            \"L_up\": (2.5, 3.2),\n            \"L_down\": (6.0, 7.0),\n        },\n        # Case 3 (vegetation, dry)\n        {\n            \"Ts_true\": 300.0,\n            \"eps_true\": (0.98, 0.98),\n            \"tau\": (0.85, 0.80),\n            \"L_up\": (1.2, 1.6),\n            \"L_down\": (3.0, 3.5),\n        },\n        # Case 4 (vegetation, humid)\n        {\n            \"Ts_true\": 300.0,\n            \"eps_true\": (0.98, 0.98),\n            \"tau\": (0.65, 0.55),\n            \"L_up\": (2.5, 3.2),\n            \"L_down\": (6.0, 7.0),\n        },\n        # Case 5 (desert, very low emissivity, very humid)\n        {\n            \"Ts_true\": 330.0,\n            \"eps_true\": (0.85, 0.80),\n            \"tau\": (0.50, 0.40),\n            \"L_up\": (3.0, 4.0),\n            \"L_down\": (8.0, 9.5),\n        },\n    ]\n\n    def planck_function(lam, T):\n        \"\"\"\n        Calculates spectral radiance using Planck's law.\n        Args:\n            lam (float): Wavelength in meters.\n            T (float): Temperature in Kelvin.\n        Returns:\n            float: Spectral radiance in W m^-2 sr^-1 um^-1.\n        \"\"\"\n        c1 = 2 * H * C**2\n        c2 = H * C / KB\n        val = c1 / (lam**5 * (np.exp(c2 / (lam * T)) - 1))\n        return val * 1e-6  # Convert from W m^-3 sr^-1 to W m^-2 sr^-1 um^-1\n\n    def forward_model(Ts, lam, eps, tau, L_up, L_down):\n        \"\"\"\n        Calculates Top-of-Atmosphere (TOA) radiance for a single channel.\n        \"\"\"\n        B_lambda = planck_function(lam, Ts)\n        L_toa = tau * (eps * B_lambda + (1 - eps) * L_down) + L_up\n        return L_toa\n\n    biases = []\n    for case in test_cases:\n        Ts_true = case[\"Ts_true\"]\n        eps_true_1, eps_true_2 = case[\"eps_true\"]\n        tau_1, tau_2 = case[\"tau\"]\n        L_up_1, L_up_2 = case[\"L_up\"]\n        L_down_1, L_down_2 = case[\"L_down\"]\n\n        # 1. Simulate \"observed\" TOA radiances using true parameters\n        L_toa_obs_1 = forward_model(Ts_true, LAMBDA_1, eps_true_1, tau_1, L_up_1, L_down_1)\n        L_toa_obs_2 = forward_model(Ts_true, LAMBDA_2, eps_true_2, tau_2, L_up_2, L_down_2)\n\n        # 2. Define the cost function for minimization\n        def cost_function(T, eps1, eps2):\n            L_mod_1 = forward_model(T, LAMBDA_1, eps1, tau_1, L_up_1, L_down_1)\n            L_mod_2 = forward_model(T, LAMBDA_2, eps2, tau_2, L_up_2, L_down_2)\n            \n            residual_1 = L_mod_1 - L_toa_obs_1\n            residual_2 = L_mod_2 - L_toa_obs_2\n            \n            return residual_1**2 + residual_2**2\n\n        # 3. Retrieve LST with true emissivities\n        res_true_fit = minimize_scalar(\n            lambda T: cost_function(T, eps_true_1, eps_true_2),\n            bounds=(200, 400),\n            method='bounded'\n        )\n        Ts_true_fit = res_true_fit.x\n        \n        # 4. Retrieve LST with naive emissivities\n        res_naive = minimize_scalar(\n            lambda T: cost_function(T, EPS_NAIVE[0], EPS_NAIVE[1]),\n            bounds=(200, 400),\n            method='bounded'\n        )\n        Ts_naive = res_naive.x\n\n        # 5. Calculate and store the bias\n        bias = Ts_naive - Ts_true_fit\n        biases.append(round(bias, 3))\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, biases))}]\")\n\nsolve()\n\n```"
        }
    ]
}