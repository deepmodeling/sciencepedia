{
    "hands_on_practices": [
        {
            "introduction": "卫星像元所观测的真实地表往往并非均匀的单一组分，而是由植被、土壤等多种元素构成的混合场景。该像元的有效发射率并不仅是各组分发射率的简单线性平均，因为组分间的多次反射会捕获部分辐射，从而提升整体的辐射出射能力，这种现象被称为“腔体效应”。本练习  将引导您从第一性原理出发，推导出一个描述混合像元有效发射率的物理模型，这对于在辐射传输方程中精确描述地表边界条件至关重要。",
            "id": "3823903",
            "problem": "一个方形卫星像元包含一个空间异质的地表，其植被覆盖度为 $f_v \\in [0,1]$，裸土覆盖度为 $1 - f_v$。假设植被和土壤组分在热红外波段都是不透明、等温的，并且表现为漫朗伯发射体和反射体。设植被的组分发射率为 $\\epsilon_v$，土壤的组分发射率为 $\\epsilon_s$，并根据不透明材料的基尔霍夫热辐射定律，将其相应的定向半球反射率表示为 $\\rho_v = 1 - \\epsilon_v$ 和 $\\rho_s = 1 - \\epsilon_s$。\n\n使用一个对称的、无量纲的几何参数 $\\Gamma \\in [0,1]$ 来模拟植被和土壤之间的亚像元内多次反射，其解释如下：对于从植被反射的通量，有 $\\Gamma(1 - f_v)$ 的部分被土壤截获，有 $1 - \\Gamma(1 - f_v)$ 的部分逃逸出像元进入半球空间；对于从土壤反射的通量，有 $\\Gamma f_v$ 的部分被植被截获，有 $1 - \\Gamma f_v$ 的部分逃逸出像元。忽略像元内的任何大气效应以及任何通过介质的透射。\n\n仅使用上述物理假设以及不透明表面发射率和吸收率相等的原理，从第一性原理推导出像元有效发射率 $\\epsilon_{\\mathrm{eff}}$ 作为 $f_v$、$\\epsilon_v$、$\\epsilon_s$ 和 $\\Gamma$ 的函数的闭式表达式，并考虑植被-土壤间无限次相互反射（即“空腔效应”）。将最终答案表示为 $\\epsilon_{\\mathrm{eff}}$ 关于 $f_v$、$\\epsilon_v$、$\\epsilon_s$ 和 $\\Gamma$ 的单个闭式解析表达式。无需进行数值计算。请提供精确表达式，不要对级数进行近似或截断。",
            "solution": "问题要求解由植被和裸土组成的混合像元的有效发射率 $\\epsilon_{\\mathrm{eff}}$。根据处于热平衡状态的不透明物体的基尔霍夫热辐射定律，其发射率等于其吸收率。因此，我们将推导像元的有效吸收率 $\\alpha_{\\mathrm{eff}}$，它等于有效发射率 $\\epsilon_{\\mathrm{eff}}$。\n\n有效吸收率 $\\alpha_{\\mathrm{eff}}$ 定义为像元吸收的入射辐射的比例。为计算此值，我们可以模拟入射到像元上的外部均匀半球辐照度 $E_{in}$ 的去向。$\\alpha_{\\mathrm{eff}}$ 的值与 $E_{in}$ 无关，因此为简便起见，我们可以将入射辐照度设为单位1，即 $E_{in} = 1$。此时，像元吸收的总功率在数值上等于 $\\alpha_{\\mathrm{eff}}$。\n\n像元由两个组分构成：面积分数为 $f_v$ 的植被和面积分数为 $1 - f_v$ 的土壤。设 $H_v$ 和 $H_s$ 分别为入射到植被和土壤表面的总辐照度（单位面积通量）。该总辐照度是外部辐照度与土壤和植被组分之间多次反射产生的辐照度之和。\n\n两个表面上的外部辐照度均为 $E_{in} = 1$。来自土壤表面反射的、到达植被表面的辐照度记为 $H_{v \\leftarrow s}$。来自植被表面反射的、到达土壤表面的辐照度记为 $H_{s \\leftarrow v}$。\n\n因此，每个组分上的总辐照度为：\n$$ H_v = E_{in} + H_{v \\leftarrow s} = 1 + H_{v \\leftarrow s} $$\n$$ H_s = E_{in} + H_{s \\leftarrow v} = 1 + H_{s \\leftarrow v} $$\n\n为确定 $H_{v \\leftarrow s}$ 和 $H_{s \\leftarrow v}$，我们使用问题描述中提供的模型。植被组分（面积为 $f_v A_{pix}$，其中 $A_{pix}$ 为像元面积）反射的总功率为 $P_{refl, v} = (H_v A_v) \\rho_v = H_v f_v A_{pix} \\rho_v$，其中 $\\rho_v = 1 - \\epsilon_v$ 是植被的反射率。问题陈述，从植被反射的通量中，有 $\\Gamma(1-f_v)$ 的部分被土壤截获。因此，被土壤截获的功率为 $P_{v \\to s} = P_{refl, v} \\Gamma(1-f_v)$。由此截获功率在土壤表面（面积为 $(1-f_v)A_{pix}$）上产生的辐照度为：\n$$ H_{s \\leftarrow v} = \\frac{P_{v \\to s}}{A_s} = \\frac{H_v f_v A_{pix} \\rho_v \\Gamma(1-f_v)}{(1-f_v)A_{pix}} = \\Gamma f_v \\rho_v H_v $$\n\n类似地，土壤组分（面积为 $(1-f_v)A_{pix}$）反射的总功率为 $P_{refl, s} = (H_s A_s) \\rho_s = H_s(1-f_v)A_{pix}\\rho_s$，其中 $\\rho_s = 1 - \\epsilon_s$。该通量中有 $\\Gamma f_v$ 的部分被植被截获。被植被截获的功率为 $P_{s \\to v} = P_{refl, s} \\Gamma f_v$。在植被表面（面积为 $f_v A_{pix}$）上产生的辐照度为：\n$$ H_{v \\leftarrow s} = \\frac{P_{s \\to v}}{A_v} = \\frac{H_s(1-f_v)A_{pix}\\rho_s \\Gamma f_v}{f_v A_{pix}} = \\Gamma(1-f_v)\\rho_s H_s $$\n\n现在，我们可以为总辐照度 $H_v$ 和 $H_s$ 写出一个包含两个耦合线性方程的方程组：\n$$ H_v = 1 + \\Gamma(1-f_v)\\rho_s H_s $$\n$$ H_s = 1 + \\Gamma f_v \\rho_v H_v $$\n\n我们可以求解该方程组。将第二个方程代入第一个方程：\n$$ H_v = 1 + \\Gamma(1-f_v)\\rho_s (1 + \\Gamma f_v \\rho_v H_v) $$\n$$ H_v = 1 + \\Gamma(1-f_v)\\rho_s + \\Gamma^2 f_v(1-f_v)\\rho_v\\rho_s H_v $$\n$$ H_v(1 - \\Gamma^2 f_v(1-f_v)\\rho_v\\rho_s) = 1 + \\Gamma(1-f_v)\\rho_s $$\n令分母为 $D = 1 - \\Gamma^2 f_v(1-f_v)\\rho_v\\rho_s$。则：\n$$ H_v = \\frac{1 + \\Gamma(1-f_v)\\rho_s}{D} $$\n\n根据对称性，我们可以求得 $H_s$：\n$$ H_s = \\frac{1 + \\Gamma f_v \\rho_v}{D} $$\n\n既然我们得到了每个组分上的总辐照度，我们就可以计算像元吸收的总功率。吸收功率是植被吸收的功率和土壤吸收的功率之和。每个组分的吸收率等于其发射率（$\\alpha_v = \\epsilon_v$，$\\alpha_s = \\epsilon_s$）。\n单位像元面积吸收的功率为：\n$$ P_{abs} = \\frac{H_v \\epsilon_v A_v + H_s \\epsilon_s A_s}{A_{pix}} = H_v \\epsilon_v f_v + H_s \\epsilon_s (1-f_v) $$\n\n有效吸收率为 $\\alpha_{\\mathrm{eff}} = P_{abs} / E_{in}$。由于我们设定 $E_{in}=1$，因此 $\\alpha_{\\mathrm{eff}} = P_{abs}$。\n$$ \\alpha_{\\mathrm{eff}} = f_v \\epsilon_v H_v + (1-f_v) \\epsilon_s H_s $$\n代入 $H_v$ 和 $H_s$ 的表达式：\n$$ \\alpha_{\\mathrm{eff}} = \\frac{f_v \\epsilon_v (1 + \\Gamma(1-f_v)\\rho_s) + (1-f_v) \\epsilon_s (1 + \\Gamma f_v \\rho_v)}{D} $$\n展开分子：\n$$ \\text{Numerator} = f_v \\epsilon_v + f_v \\epsilon_v \\Gamma(1-f_v)\\rho_s + (1-f_v)\\epsilon_s + (1-f_v)\\epsilon_s \\Gamma f_v \\rho_v $$\n$$ \\text{Numerator} = f_v \\epsilon_v + (1-f_v)\\epsilon_s + f_v(1-f_v)\\Gamma(\\epsilon_v\\rho_s + \\epsilon_s\\rho_v) $$\n因此有效吸收率为：\n$$ \\alpha_{\\mathrm{eff}} = \\frac{f_v \\epsilon_v + (1-f_v)\\epsilon_s + f_v(1-f_v)\\Gamma(\\epsilon_v\\rho_s + \\epsilon_s\\rho_v)}{1 - \\Gamma^2 f_v(1-f_v)\\rho_v\\rho_s} $$\n\n最后，通过代入 $\\rho_v = 1 - \\epsilon_v$ 和 $\\rho_s = 1 - \\epsilon_s$，我们用给定的参数 $f_v, \\epsilon_v, \\epsilon_s, \\Gamma$ 来表示结果。\n项 $\\epsilon_v\\rho_s + \\epsilon_s\\rho_v$ 变为：\n$$ \\epsilon_v(1-\\epsilon_s) + \\epsilon_s(1-\\epsilon_v) = \\epsilon_v - \\epsilon_v\\epsilon_s + \\epsilon_s - \\epsilon_s\\epsilon_v = \\epsilon_v + \\epsilon_s - 2\\epsilon_v\\epsilon_s $$\n项 $\\rho_v\\rho_s$ 变为 $(1-\\epsilon_v)(1-\\epsilon_s)$。\n\n将这些代入 $\\alpha_{\\mathrm{eff}}$ 的表达式，得到有效发射率 $\\epsilon_{\\mathrm{eff}} = \\alpha_{\\mathrm{eff}}$ 的最终闭式表达式：\n$$ \\epsilon_{\\mathrm{eff}} = \\frac{f_v \\epsilon_v + (1-f_v)\\epsilon_s + f_v(1-f_v)\\Gamma(\\epsilon_v + \\epsilon_s - 2\\epsilon_v\\epsilon_s)}{1 - \\Gamma^2 f_v(1-f_v)(1-\\epsilon_v)(1-\\epsilon_s)} $$\n该表达式代表了像元的总发射率，它考虑了单次散射的贡献（线性混合项 $f_v \\epsilon_v + (1-f_v)\\epsilon_s$）以及由植被和土壤组分之间无限次多次反射（“空腔效应”）引起的增强作用。",
            "answer": "$$\\boxed{\\frac{f_v \\epsilon_v + (1-f_v)\\epsilon_s + f_v(1-f_v)\\Gamma(\\epsilon_v + \\epsilon_s - 2\\epsilon_v\\epsilon_s)}{1 - \\Gamma^{2} f_v(1-f_v)(1-\\epsilon_v)(1-\\epsilon_s)}}$$"
        },
        {
            "introduction": "在理解了地表发射率 $\\varepsilon$ 的复杂性之后，我们如何从卫星测量的辐射值中反演出地表温度？一种核心方法是基于物理的“正向-反向”建模：我们使用辐射传输方程（RTE）作为正向模型来预测给定地表和大气条件下的卫星观测辐射，再通过反向优化寻找能使模型预测与卫星观测最匹配的地表温度 $T_s$。本编程练习  将让您亲手实现这一完整流程，并通过具体的案例研究，量化不准确的发射率假设对 LST 反演结果造成的偏差，从而将理论与地表温度反演的实际挑战联系起来。",
            "id": "3823833",
            "problem": "你的任务是根据热红外辐射率，实现一个基于物理的双通道分裂窗算法来反演陆地表面温度（LST），并量化使用朴素发射率假设时由发射率驱动的偏差。该反演必须基于第一性原理：普朗克定律和热红外辐射传输方程。你将根据真实的表面温度、大气透过率、大气程辐射率、下行大气辐射和地表发射率，为两个热红外通道显式地模拟大气层顶（TOA）辐射率。然后，你将在两种发射率设置下（即真实发射率和朴素的恒定发射率假设），通过同时拟合两个通道来反演LST。由发射率驱动的偏差定义为使用朴素发射率反演的LST与使用真实发射率反演的LST之差。\n\n基本原理：\n- 普朗克定律（单位波长的光谱辐射率）：对于波长 $\\lambda$（单位：米）和物理温度 $T$（单位：开尔文），\n$$\nB_\\lambda(\\lambda, T) = \\frac{2 h c^2}{\\lambda^5} \\left( \\exp\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1 \\right)^{-1},\n$$\n其中 $h$ 是普朗克常数，$c$ 是光速，$k_B$ 是玻尔兹曼常数。\n- 热红外（TIR）大气层顶辐射率：对于通道 $i$，其大气透过率为 $\\tau_i$，上行路径辐射率为 $L_{\\text{up},i}$，下行大气辐射为 $L_{\\text{down},i}$，地表发射率为 $\\varepsilon_i$，地表温度为 $T_s$，通道中心波长为 $\\lambda_i$（窄带近似），\n$$\nL_{\\text{TOA},i}(T_s) = \\tau_i \\left[ \\varepsilon_i B_\\lambda(\\lambda_i, T_s) + (1 - \\varepsilon_i) L_{\\text{down},i} \\right] + L_{\\text{up},i}.\n$$\n\n反演设计要求：\n- 联合使用两个通道。给定由真实参数生成的观测到的双通道TOA辐射率 $L_{\\text{TOA},1}^{\\text{obs}}$ 和 $L_{\\text{TOA},2}^{\\text{obs}}$，通过最小化各通道残差平方和来反演 $T_s$，\n$$\nJ(T_s;\\,\\varepsilon_1,\\varepsilon_2) = \\sum_{i=1}^{2} \\left( L_{\\text{TOA},i}(T_s) - L_{\\text{TOA},i}^{\\text{obs}} \\right)^2,\n$$\n在物理上合理的区间内对 $T_s$ 进行优化。此最小化过程需执行两次：一次使用真实发射率 $(\\varepsilon_1,\\varepsilon_2)$，另一次使用朴素发射率假设 $(\\hat{\\varepsilon}_1,\\hat{\\varepsilon}_2)$。\n- 将一个案例中由发射率驱动的偏差 $\\Delta T$ 定义为\n$$\n\\Delta T = T_s^{\\text{naive}} - T_s^{\\text{true-fit}},\n$$\n其中 $T_s^{\\text{naive}}$ 是在 $(\\hat{\\varepsilon}_1,\\hat{\\varepsilon}_2)$ 假设下的最小化结果，$T_s^{\\text{true-fit}}$ 是在真实发射率 $(\\varepsilon_1,\\varepsilon_2)$ 下的最小化结果。所有偏差均以开尔文表示。\n\n通道：\n- 使用两个热红外（TIR）通道，中心波长分别为 $\\lambda_1 = 10.8\\,\\mu\\text{m}$ 和 $\\lambda_2 = 12.0\\,\\mu\\text{m}$，即 $\\lambda_1 = 10.8 \\times 10^{-6}\\,\\text{m}$ 和 $\\lambda_2 = 12.0 \\times 10^{-6}\\,\\text{m}$。\n\n朴素发射率假设：\n- 对所有表面使用 $(\\hat{\\varepsilon}_1, \\hat{\\varepsilon}_2) = (0.98, 0.98)$。\n\n测试套件：\n- 对每个案例，指定 $(T_s^{\\text{true}}, \\varepsilon_1, \\varepsilon_2, \\tau_1, \\tau_2, L_{\\text{up},1}, L_{\\text{up},2}, L_{\\text{down},1}, L_{\\text{down},2})$；使用正向模型和真实参数模拟 $L_{\\text{TOA},i}^{\\text{obs}}$。\n\n案例1（沙漠，干燥）：\n- $T_s^{\\text{true}} = 320\\,\\text{K}$,\n- $(\\varepsilon_1, \\varepsilon_2) = (0.92, 0.89)$,\n- $(\\tau_1, \\tau_2) = (0.85, 0.80)$,\n- $(L_{\\text{up},1}, L_{\\text{up},2}) = (1.2, 1.6)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $(L_{\\text{down},1}, L_{\\text{down},2}) = (3.0, 3.5)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n\n案例2（沙漠，湿润）：\n- $T_s^{\\text{true}} = 320\\,\\text{K}$,\n- $(\\varepsilon_1, \\varepsilon_2) = (0.92, 0.89)$,\n- $(\\tau_1, \\tau_2) = (0.65, 0.55)$,\n- $(L_{\\text{up},1}, L_{\\text{up},2}) = (2.5, 3.2)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $(L_{\\text{down},1}, L_{\\text{down},2}) = (6.0, 7.0)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n\n案例3（植被，干燥）：\n- $T_s^{\\text{true}} = 300\\,\\text{K}$,\n- $(\\varepsilon_1, \\varepsilon_2) = (0.98, 0.98)$,\n- $(\\tau_1, \\tau_2) = (0.85, 0.80)$,\n- $(L_{\\text{up},1}, L_{\\text{up},2}) = (1.2, 1.6)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $(L_{\\text{down},1}, L_{\\text{down},2}) = (3.0, 3.5)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n\n案例4（植被，湿润）：\n- $T_s^{\\text{true}} = 300\\,\\text{K}$,\n- $(\\varepsilon_1, \\varepsilon_2) = (0.98, 0.98)$,\n- $(\\tau_1, \\tau_2) = (0.65, 0.55)$,\n- $(L_{\\text{up},1}, L_{\\text{up},2}) = (2.5, 3.2)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $(L_{\\text{down},1}, L_{\\text{down},2}) = (6.0, 7.0)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n\n案例5（沙漠，极低发射率，极湿润；边缘案例）：\n- $T_s^{\\text{true}} = 330\\,\\text{K}$,\n- $(\\varepsilon_1, \\varepsilon_2) = (0.85, 0.80)$,\n- $(\\tau_1, \\tau_2) = (0.50, 0.40)$,\n- $(L_{\\text{up},1}, L_{\\text{up},2}) = (3.0, 4.0)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$,\n- $(L_{\\text{down},1}, L_{\\text{down},2}) = (8.0, 9.5)\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$.\n\n实现要求：\n- 使用正向模型和真实参数为每个案例模拟 $L_{\\text{TOA},i}^{\\text{obs}}$。\n- 对每个案例，执行两次拟合：\n  1. 使用真实发射率 $(\\varepsilon_1, \\varepsilon_2)$ 进行最小化，以获得 $T_s^{\\text{true-fit}}$。\n  2. 使用朴素发射率 $(\\hat{\\varepsilon}_1, \\hat{\\varepsilon}_2)$ 进行最小化，以获得 $T_s^{\\text{naive}}$。\n- 计算每个案例中由发射率驱动的偏差 $\\Delta T$（以开尔文为单位），并将每个值四舍五入到三位小数。\n\n单位：\n- 温度单位必须是开尔文。\n- 辐射率单位必须是 $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$。\n- 在计算中，波长单位必须是米，通道定义中给出的微米单位需要转换为米。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有五个测试案例的发射率驱动偏差，格式为方括号内以逗号分隔的列表，例如 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_i$ 是一个以开尔文为单位、四舍五入到三位小数的浮点数。",
            "solution": "该问题陈述具有科学依据，定义明确且完整。它描述了在定量热红外遥感中反演陆地表面温度(LST)和评估发射率不确定性影响的标准流程。该物理模型基于基本原理，即普朗克黑体辐射定律和热红外波段非散射大气的简化辐射传输方程。所有必需的参数、常数和程序步骤都已明确提供。因此，该问题是有效的。\n\n解决方案主要分为三个阶段：\n1.  **正向模拟**：我们首先模拟卫星传感器在两个热红外通道上将测量到的大气层顶(TOA)辐射率。这是通过使用所提供的辐射传输模型和每个测试案例的“真实”参数来实现的。\n2.  **反演**：然后我们反转此过程以反演LST ($T_s$)。反演过程被表述为一个非线性优化问题。我们寻求能够最小化模型预测辐射率与第一步中模拟的“观测”辐射率之间差值平方和的温度 $T_s$。\n3.  **偏差量化**：对每个案例执行两次反演。第一次反演使用真实的地表发射率 $(\\varepsilon_1, \\varepsilon_2)$，得到参考LST，$T_s^{\\text{true-fit}}$。第二次反演使用一个朴素的、恒定的发射率假设 $(\\hat{\\varepsilon}_1, \\hat{\\varepsilon}_2)$，得到有偏差的LST，$T_s^{\\text{naive}}$。由发射率驱动的偏差即为差值 $\\Delta T = T_s^{\\text{naive}} - T_s^{\\text{true-fit}}$。\n\n**1. 物理和数学公式**\n\n该模型的基础是普朗克定律，它给出了黑体在温度 $T$ 时作为波长 $\\lambda$ 函数的光谱辐射率 $B_\\lambda$。公式为：\n$$\nB_\\lambda(\\lambda, T) = \\frac{2 h c^2}{\\lambda^5} \\left( \\exp\\left(\\frac{h c}{\\lambda k_B T}\\right) - 1 \\right)^{-1}\n$$\n其中 $h$ 是普朗克常数 ($6.62607015 \\times 10^{-34}\\,\\text{J}\\,\\text{s}$)，$c$ 是光速 ($2.99792458 \\times 10^{8}\\,\\text{m}\\,\\text{s}^{-1}$)，$k_B$ 是玻尔兹曼常数 ($1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$)。此公式提供的辐射率单位为 $\\text{W}\\,\\text{m}^{-3}\\,\\text{sr}^{-1}$。由于问题指定的辐射率单位为 $\\text{W}\\,\\text{m}^{-2}\\,\\text{sr}^{-1}\\,\\mu\\text{m}^{-1}$，因此需要对普朗克函数的输出应用一个 $10^{-6}$ 的转换因子以匹配单位。\n\n给定通道 $i$ 的TOA辐射率 $L_{\\text{TOA},i}$ 由辐射传输方程 (RTE) 建模：\n$$\nL_{\\text{TOA},i}(T_s) = \\tau_i \\left[ \\varepsilon_i B_\\lambda(\\lambda_i, T_s) + (1 - \\varepsilon_i) L_{\\text{down},i} \\right] + L_{\\text{up},i}\n$$\n此处，$\\tau_i$ 是大气透过率，$\\varepsilon_i$ 是地表发射率，$L_{\\text{down},i}$ 是大气下行辐射，$L_{\\text{up},i}$ 是通道 $i$ 的上行大气路径辐射率。两个通道的中心波长分别为 $\\lambda_1 = 10.8 \\times 10^{-6}\\,\\text{m}$ 和 $\\lambda_2 = 12.0 \\times 10^{-6}\\,\\text{m}$。\n\n**2. 算法实现**\n\n对于五个测试案例中的每一个，我们首先通过应用RTE以及为该案例提供的所有真实参数（包括真实地表温度 $T_s^{\\text{true}}$），模拟出“观测”辐射率 $L_{\\text{TOA},1}^{\\text{obs}}$ 和 $L_{\\text{TOA},2}^{\\text{obs}}$。\n\n接下来，我们建立用于反演的成本函数 $J(T_s)$：\n$$\nJ(T_s;\\,\\varepsilon_1,\\varepsilon_2) = \\sum_{i=1}^{2} \\left( L_{\\text{TOA},i}(T_s; \\varepsilon_i, \\tau_i, L_{\\text{up},i}, L_{\\text{down},i}) - L_{\\text{TOA},i}^{\\text{obs}} \\right)^2\n$$\n$T_s$ 的反演涉及找到最小化此成本函数的温度。由于 $L_{\\text{TOA},i}(T_s)$ 是 $T_s$ 的严格单调函数，成本函数 $J(T_s)$ 是凸函数并且有唯一的最小值。我们可以使用数值优化算法找到这个最小值。一维有界最小化器，例如 `scipy.optimize.minimize_scalar`，非常适合此任务。我们为 $T_s$ 定义一个物理上合理的搜索区间，例如 [$200\\,\\text{K}$, $400\\,\\text{K}$]。\n\n这个最小化过程执行两次：\n1.  **真实拟合反演**：我们使用测试案例中的真实发射率 $(\\varepsilon_1, \\varepsilon_2)$ 来最小化 $J(T_s; \\varepsilon_1, \\varepsilon_2)$。得到的温度是 $T_s^{\\text{true-fit}}$。在没有数值误差的理想情况下，这个值应等于 $T_s^{\\text{true}}$。\n2.  **朴素拟合反演**：我们使用朴素发射率 $(\\hat{\\varepsilon}_1, \\hat{\\varepsilon}_2) = (0.98, 0.98)$ 来最小化 $J(T_s; \\hat{\\varepsilon}_1, \\hat{\\varepsilon}_2)$。得到的温度是 $T_s^{\\text{naive}}$。\n\n最后，该案例的发射率驱动偏差计算为 $\\Delta T = T_s^{\\text{naive}} - T_s^{\\text{true-fit}}$。收集所有五个案例的结果，四舍五入到三位小数，并按指定格式进行格式化。对于真实发射率等于朴素假设的案例（案例3和4），偏差 $\\Delta T$ 预计为 $0$。对于真实发射率低于朴素假设的案例（案例1、2、5），反演算法将通过找到一个较低的温度 $T_s^{\\text{naive}}$ 来补偿被高估的发射率 $\\hat{\\varepsilon}_i$，从而导致负偏差。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the LST retrieval problem for all test cases and prints the results.\n    \"\"\"\n    # Physical Constants\n    H = 6.62607015e-34  # Planck's constant (J s)\n    C = 2.99792458e8    # Speed of light (m/s)\n    KB = 1.380649e-23   # Boltzmann constant (J/K)\n    \n    # Channel Wavelengths (m)\n    LAMBDA_1 = 10.8e-6\n    LAMBDA_2 = 12.0e-6\n\n    # Naive Emissivity Assumption\n    EPS_NAIVE = (0.98, 0.98)\n\n    # Test cases data\n    test_cases = [\n        # Case 1 (desert, dry)\n        {\n            \"Ts_true\": 320.0,\n            \"eps_true\": (0.92, 0.89),\n            \"tau\": (0.85, 0.80),\n            \"L_up\": (1.2, 1.6),\n            \"L_down\": (3.0, 3.5),\n        },\n        # Case 2 (desert, humid)\n        {\n            \"Ts_true\": 320.0,\n            \"eps_true\": (0.92, 0.89),\n            \"tau\": (0.65, 0.55),\n            \"L_up\": (2.5, 3.2),\n            \"L_down\": (6.0, 7.0),\n        },\n        # Case 3 (vegetation, dry)\n        {\n            \"Ts_true\": 300.0,\n            \"eps_true\": (0.98, 0.98),\n            \"tau\": (0.85, 0.80),\n            \"L_up\": (1.2, 1.6),\n            \"L_down\": (3.0, 3.5),\n        },\n        # Case 4 (vegetation, humid)\n        {\n            \"Ts_true\": 300.0,\n            \"eps_true\": (0.98, 0.98),\n            \"tau\": (0.65, 0.55),\n            \"L_up\": (2.5, 3.2),\n            \"L_down\": (6.0, 7.0),\n        },\n        # Case 5 (desert, very low emissivity, very humid)\n        {\n            \"Ts_true\": 330.0,\n            \"eps_true\": (0.85, 0.80),\n            \"tau\": (0.50, 0.40),\n            \"L_up\": (3.0, 4.0),\n            \"L_down\": (8.0, 9.5),\n        },\n    ]\n\n    def planck_function(lam, T):\n        \"\"\"\n        Calculates spectral radiance using Planck's law.\n        Args:\n            lam (float): Wavelength in meters.\n            T (float): Temperature in Kelvin.\n        Returns:\n            float: Spectral radiance in W m^-2 sr^-1 um^-1.\n        \"\"\"\n        c1 = 2 * H * C**2\n        c2 = H * C / KB\n        val = c1 / (lam**5 * (np.exp(c2 / (lam * T)) - 1))\n        return val * 1e-6  # Convert from W m^-3 sr^-1 to W m^-2 sr^-1 um^-1\n\n    def forward_model(Ts, lam, eps, tau, L_up, L_down):\n        \"\"\"\n        Calculates Top-of-Atmosphere (TOA) radiance for a single channel.\n        \"\"\"\n        B_lambda = planck_function(lam, Ts)\n        L_toa = tau * (eps * B_lambda + (1 - eps) * L_down) + L_up\n        return L_toa\n\n    biases = []\n    for case in test_cases:\n        Ts_true = case[\"Ts_true\"]\n        eps_true_1, eps_true_2 = case[\"eps_true\"]\n        tau_1, tau_2 = case[\"tau\"]\n        L_up_1, L_up_2 = case[\"L_up\"]\n        L_down_1, L_down_2 = case[\"L_down\"]\n\n        # 1. Simulate \"observed\" TOA radiances using true parameters\n        L_toa_obs_1 = forward_model(Ts_true, LAMBDA_1, eps_true_1, tau_1, L_up_1, L_down_1)\n        L_toa_obs_2 = forward_model(Ts_true, LAMBDA_2, eps_true_2, tau_2, L_up_2, L_down_2)\n\n        # 2. Define the cost function for minimization\n        def cost_function(T, eps1, eps2):\n            L_mod_1 = forward_model(T, LAMBDA_1, eps1, tau_1, L_up_1, L_down_1)\n            L_mod_2 = forward_model(T, LAMBDA_2, eps2, tau_2, L_up_2, L_down_2)\n            \n            residual_1 = L_mod_1 - L_toa_obs_1\n            residual_2 = L_mod_2 - L_toa_obs_2\n            \n            return residual_1**2 + residual_2**2\n\n        # 3. Retrieve LST with true emissivities\n        res_true_fit = minimize_scalar(\n            lambda T: cost_function(T, eps_true_1, eps_true_2),\n            bounds=(200, 400),\n            method='bounded'\n        )\n        Ts_true_fit = res_true_fit.x\n        \n        # 4. Retrieve LST with naive emissivities\n        res_naive = minimize_scalar(\n            lambda T: cost_function(T, EPS_NAIVE[0], EPS_NAIVE[1]),\n            bounds=(200, 400),\n            method='bounded'\n        )\n        Ts_naive = res_naive.x\n\n        # 5. Calculate and store the bias\n        bias = Ts_naive - Ts_true_fit\n        biases.append(round(bias, 3))\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, biases))}]\")\n\nsolve()\n\n```"
        }
    ]
}