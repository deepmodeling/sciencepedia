{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of retrieving Land Surface Temperature (LST) is the ability to mathematically reverse the radiative transfer process. This practice guides you through this fundamental procedure, starting from the single-channel radiative transfer equation. You will learn to isolate the radiance emitted by the surface and then employ a numerical method to solve for temperature by inverting the non-linear Planck function, a core skill in quantitative remote sensing .",
            "id": "3846866",
            "problem": "You are given the single-channel radiative transfer equation for a narrow Thermal Infrared (TIR) band: $L_{\\text{TOA}}=\\tau\\left[\\varepsilon B(\\lambda,T_s)+(1-\\varepsilon)L^{\\downarrow}\\right]+L^{\\uparrow}$, where $L_{\\text{TOA}}$ is the top-of-atmosphere spectral radiance, $\\tau$ is the atmospheric transmittance, $\\varepsilon$ is the land surface emissivity, $B(\\lambda,T_s)$ is the Planck spectral radiance at wavelength $\\lambda$ for land surface temperature $T_s$, $L^{\\downarrow}$ is the downwelling atmospheric spectral radiance incident on the surface, and $L^{\\uparrow}$ is the upwelling atmospheric spectral radiance. Starting from this equation and the fundamental Planck's law, derive a numerical procedure to solve for $T_s$ by inverting $B(\\lambda,T_s)$, and implement the procedure in a program that produces the required outputs for a test suite.\n\nUse as the fundamental base the following well-tested formulas and physical constants:\n- Planck's law for spectral radiance (per unit wavelength): $$B(\\lambda,T)=\\frac{2h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}}T}\\right)-1},$$ where $h$ is Planck’s constant, $c$ is the speed of light in vacuum, and $k_{\\mathrm{B}}$ is Boltzmann’s constant.\n- Physical constants: $h=6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}$, $c=2.99792458\\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$, $k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$.\n- All spectral radiances $L_{\\text{TOA}}$, $L^{\\uparrow}$, and $L^{\\downarrow}$ are to be treated as narrowband spectral radiances given in $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$, and $\\lambda$ is given in $\\mu\\mathrm{m}$. Internally, you must convert radiances to $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,m^{-1}}$ and wavelength to $\\mathrm{m}$ to be consistent with Planck's law. The land surface temperature $T_s$ must be expressed in $\\mathrm{K}$.\n\nDerivation target and computational task:\n1. Starting from $L_{\\text{TOA}}=\\tau\\left[\\varepsilon B(\\lambda,T_s)+(1-\\varepsilon)L^{\\downarrow}\\right]+L^{\\uparrow}$, derive the monotonic equation in $T_s$ that must be solved numerically to obtain $T_s$. You are required to perform the inversion by solving for $T_s$ such that $B(\\lambda,T_s)$ equals a target spectral radiance deduced from the given inputs. Explicit closed-form inversion of the Planck function is not allowed; you must use a robust iterative numerical method grounded in first principles.\n2. Describe and implement a bracketed iterative procedure (for example, bisection with optional Newton refinement) that guarantees convergence to the solution for $T_s$ in physically realistic ranges, using only the monotonicity of $B(\\lambda,T)$ with respect to $T$.\n3. For numerical stability, require a bracketing interval for $T_s$ in $\\mathrm{K}$ that covers typical terrestrial conditions, and a stopping criterion based on either the absolute residual in spectral radiance or the change in temperature between iterations.\n\nUnit specification and output requirements:\n- Report each estimated land surface temperature $T_s$ in $\\mathrm{K}$, rounded to three decimal places.\n- Angles are not involved in this problem.\n- Do not use percentages; any fractional quantities must remain as decimals.\n\nTest suite:\nUse the following set of parameter values to create four physically plausible test scenarios. In each case, let $\\lambda$ be in $\\mu\\mathrm{m}$, $\\varepsilon$ be unitless, $\\tau$ be unitless, and $L^{\\uparrow}$, $L^{\\downarrow}$ be in $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$. For each scenario, a “true” land surface temperature $T_s^{\\text{true}}$ is provided only to generate a self-consistent $L_{\\text{TOA}}$ via the forward model; your program must invert the equation to estimate $T_s$ from the constructed $L_{\\text{TOA}}$.\n\n- Case $1$ (general happy path): $\\lambda=10.8\\,\\mu\\mathrm{m}$, $\\varepsilon=0.98$, $\\tau=0.85$, $L^{\\uparrow}=1.2\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$, $L^{\\downarrow}=2.6\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$, $T_s^{\\text{true}}=300\\,\\mathrm{K}$.\n- Case $2$ (low emissivity surface): $\\lambda=11.0\\,\\mu\\mathrm{m}$, $\\varepsilon=0.85$, $\\tau=0.95$, $L^{\\uparrow}=0.6\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$, $L^{\\downarrow}=1.8\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$, $T_s^{\\text{true}}=320\\,\\mathrm{K}$.\n- Case $3$ (strong atmospheric path effects): $\\lambda=12.0\\,\\mu\\mathrm{m}$, $\\varepsilon=0.99$, $\\tau=0.50$, $L^{\\uparrow}=3.5\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$, $L^{\\downarrow}=4.2\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$, $T_s^{\\text{true}}=280\\,\\mathrm{K}$.\n- Case $4$ (near-blackbody, high transmittance): $\\lambda=10.5\\,\\mu\\mathrm{m}$, $\\varepsilon=1.00$, $\\tau=0.90$, $L^{\\uparrow}=1.0\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$, $L^{\\downarrow}=2.0\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$, $T_s^{\\text{true}}=295\\,\\mathrm{K}$.\n\nIn each case, construct $L_{\\text{TOA}}$ using the forward radiative transfer equation and the given $T_s^{\\text{true}}$, and then estimate $T_s$ by numerically inverting the equation. Your program should produce a single line of output containing the four estimated temperatures as a comma-separated list enclosed in square brackets (for example, $[300.000,319.997,280.003,295.000]$), with each value in $\\mathrm{K}$ rounded to three decimal places.",
            "solution": "The problem requires the derivation and implementation of a numerical procedure to determine the Land Surface Temperature ($T_s$) by inverting a single-channel radiative transfer equation. The validation process confirms that the problem is scientifically grounded, well-posed, and all necessary data and physical constants are provided. We may therefore proceed with the solution.\n\n### 1. Derivation of the Target Equation\n\nThe starting point is the single-channel radiative transfer equation (RTE) for a narrow thermal infrared band, which models the radiance measured by a satellite sensor:\n$$L_{\\text{TOA}}=\\tau\\left[\\varepsilon B(\\lambda,T_s)+(1-\\varepsilon)L^{\\downarrow}\\right]+L^{\\uparrow}$$\nHere, $L_{\\text{TOA}}$ is the observed Top-of-Atmosphere radiance, $\\tau$ is atmospheric transmittance, $\\varepsilon$ is land surface emissivity, $L^{\\downarrow}$ and $L^{\\uparrow}$ are the downwelling and upwelling atmospheric radiances, respectively, and $B(\\lambda, T_s)$ is the Planck spectral radiance emitted by the land surface at temperature $T_s$ and wavelength $\\lambda$. Our objective is to solve this equation for $T_s$.\n\nTo do this, we must first algebraically isolate the term containing the unknown, $B(\\lambda, T_s)$. This is performed step-by-step:\n\n1.  Subtract the upwelling atmospheric radiance, $L^{\\uparrow}$, from both sides of the equation:\n    $$L_{\\text{TOA}} - L^{\\uparrow} = \\tau\\left[\\varepsilon B(\\lambda,T_s)+(1-\\varepsilon)L^{\\downarrow}\\right]$$\n2.  Divide by the atmospheric transmittance, $\\tau$. This is physically permissible as $\\tau > 0$ for any non-opaque atmosphere. This step corrects for the attenuation of the signal as it travels through the atmosphere.\n    $$\\frac{L_{\\text{TOA}} - L^{\\uparrow}}{\\tau} = \\varepsilon B(\\lambda,T_s)+(1-\\varepsilon)L^{\\downarrow}$$\n3.  The term on the left represents the total radiance leaving the surface. It is composed of two components: the radiance emitted by the surface, $\\varepsilon B(\\lambda, T_s)$, and the portion of downwelling atmospheric radiance reflected by the surface, $(1-\\varepsilon)L^{\\downarrow}$. We isolate the emitted component by subtracting the reflected component:\n    $$\\frac{L_{\\text{TOA}} - L^{\\uparrow}}{\\tau} - (1-\\varepsilon)L^{\\downarrow} = \\varepsilon B(\\lambda,T_s)$$\n4.  Finally, to find the radiance that a blackbody at temperature $T_s$ would emit, we divide by the surface emissivity, $\\varepsilon$. This is valid for any physical surface where $\\varepsilon>0$.\n    $$B(\\lambda,T_s) = \\frac{1}{\\varepsilon} \\left[ \\frac{L_{\\text{TOA}} - L^{\\uparrow}}{\\tau} - (1-\\varepsilon)L^{\\downarrow} \\right]$$\n\nThis equation provides a target value for the Planck function. Let us denote this target spectral radiance as $B_{\\text{target}}$:\n$$B_{\\text{target}} = \\frac{1}{\\varepsilon} \\left[ \\frac{L_{\\text{TOA}} - L^{\\uparrow}}{\\tau} - (1-\\varepsilon)L^{\\downarrow} \\right]$$\nThe problem of finding $T_s$ is now reduced to solving the following equation for $T_s$:\n$$B(\\lambda, T_s) = B_{\\text{target}}$$\nwhere $B(\\lambda, T_s)$ is given by Planck's law:\n$$B(\\lambda,T_s)=\\frac{2h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}}T_s}\\right)-1}$$\n\n### 2. Numerical Inversion Procedure\n\nAs specified, we are forbidden from using an explicit closed-form inversion of Planck's law. Instead, we must employ an iterative numerical method. This is equivalent to finding the root of the residual function, $f(T_s)$, defined as:\n$$f(T_s) = B(\\lambda, T_s) - B_{\\text{target}} = 0$$\n\nThe suitability of a numerical root-finding algorithm depends on the properties of the function $f(T_s)$. The derivative of the Planck function with respect to temperature $T$ for $T>0$ is:\n$$\\frac{\\partial B}{\\partial T} = \\frac{2h^2c^3}{\\lambda^6 k_B T^2} \\frac{\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right)}{\\left(\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right)-1\\right)^2} > 0$$\nSince all physical constants and variables in this expression are positive, the derivative is strictly positive. This proves that $B(\\lambda, T_s)$ is a strictly monotonic increasing function of $T_s$. Consequently, the residual function $f(T_s)$ is also strictly monotonic, which guarantees that a unique root exists if it is bracketed.\n\nWe will use the **bisection method**, a robust, bracketed root-finding algorithm that exploits this monotonicity. The procedure is as follows:\n1.  **Bracketing**: Choose an initial search interval $[T_a, T_b]$ that is guaranteed to contain the solution $T_s$. This interval must satisfy $f(T_a) < 0$ and $f(T_b) > 0$. For terrestrial applications, a range of $[200\\,\\mathrm{K}, 350\\,\\mathrm{K}]$ is a conservative and robust choice, covering conditions from extreme cold to hot deserts.\n2.  **Iteration**:\n    a. Calculate the midpoint of the interval: $T_m = (T_a + T_b) / 2$.\n    b. Evaluate the residual function at the midpoint, $f(T_m) = B(\\lambda, T_m) - B_{\\text{target}}$.\n    c. If $f(T_m) < 0$, the root must lie in the upper half of the interval, so the new interval becomes $[T_m, T_b]$.\n    d. If $f(T_m) > 0$, the root must lie in the lower half of the interval, so the new interval becomes $[T_a, T_m]$.\n    e. If $f(T_m) = 0$, the exact root has been found.\n3.  **Termination**: The iterative process continues until the size of the interval, $|T_b - T_a|$, is smaller than a prescribed tolerance, $\\delta_T$. A tolerance of $\\delta_T = 10^{-6}\\,\\mathrm{K}$ is more than sufficient to ensure the required output precision of three decimal places. The final estimate for $T_s$ is taken as the midpoint of the final interval.\n\n### 3. Implementation Details\n\nThe implementation must strictly adhere to physical principles and unit consistency.\n-   **Unit Conversion**: All input parameters must be converted to base SI units for use in the Planck function. Wavelength $\\lambda$ in $\\mu\\text{m}$ is converted to meters by multiplying by $10^{-6}$. Spectral radiances ($L_{\\text{TOA}}$, $L^{\\uparrow}$, $L^{\\downarrow}$) in $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,\\mu m^{-1}}$ are converted to $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,m^{-1}}$ by multiplying by $10^6$.\n-   **Physical Constants**: For computational efficiency, the first and second radiation constants are pre-calculated:\n    $$c_1 = 2hc^2 \\approx 1.19104297 \\times 10^{-16} \\, \\mathrm{W\\,m^2\\,sr^{-1}}$$\n    $$c_2 = \\frac{hc}{k_{\\mathrm{B}}} \\approx 0.0143877686 \\, \\mathrm{m\\,K}$$\n    The Planck function is then computed as $B(\\lambda, T) = c_1 / (\\lambda^5 (\\exp(c_2 / (\\lambda T)) - 1))$.\n-   **Test Case Procedure**: For each test case, we first use the given parameters and $T_s^{\\text{true}}$ to compute a synthetic $L_{\\text{TOA}}$ via the forward RTE. This $L_{\\text{TOA}}$ then serves as the input to the inversion algorithm, which estimates $T_s$. This procedure validates that the inversion correctly reverses the forward model, and the estimated $T_s$ should be very close to $T_s^{\\text{true}}$, with minor differences attributable to floating-point precision.\n\nThe combination of this rigorous derivation and a robust numerical method ensures an accurate and reliable solution for the Land Surface Temperature.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a numerical procedure to solve for Land Surface Temperature (LST).\n    \"\"\"\n\n    # Physical constants\n    H = 6.62607015e-34  # Planck's constant (J s)\n    C = 2.99792458e8  # Speed of light in vacuum (m/s)\n    KB = 1.380649e-23  # Boltzmann constant (J/K)\n    \n    # Pre-calculated radiation constants for Planck's law\n    C1 = 2 * H * C**2  # First radiation constant (W m^2 sr^-1)\n    C2 = (H * C) / KB  # Second radiation constant (m K)\n\n    def planck_radiance(lambda_m, temp_k):\n        \"\"\"\n        Calculates spectral radiance using Planck's law.\n        \n        Args:\n            lambda_m (float): Wavelength in meters (m).\n            temp_k (float): Temperature in Kelvin (K).\n            \n        Returns:\n            float: Spectral radiance in W m^-2 sr^-1 m^-1.\n        \"\"\"\n        if temp_k <= 0:\n            return 0.0\n        val = C2 / (lambda_m * temp_k)\n        # Handle potential overflow for very large exponents\n        if val > np.log(np.finfo(float).max):\n            return 0.0\n        return C1 / (lambda_m**5 * (np.exp(val) - 1))\n\n    def estimate_lst_bisection(lambda_um, epsilon, tau, L_up_um, L_down_um, L_toa_um):\n        \"\"\"\n        Estimates LST by numerically inverting the radiative transfer equation.\n\n        Args:\n            lambda_um (float): Wavelength in micrometers (µm).\n            epsilon (float): Surface emissivity (unitless).\n            tau (float): Atmospheric transmittance (unitless).\n            L_up_um (float): Upwelling radiance in W m^-2 sr^-1 µm^-1.\n            L_down_um (float): Downwelling radiance in W m^-2 sr^-1 µm^-1.\n            L_toa_um (float): Top-of-atmosphere radiance in W m^-2 sr^-1 µm^-1.\n\n        Returns:\n            float: Estimated Land Surface Temperature in Kelvin (K).\n        \"\"\"\n        # --- Unit Conversion to SI ---\n        # Convert wavelength from µm to m\n        lambda_m = lambda_um * 1e-6\n        # Convert radiances from per-µm to per-m\n        L_up_si = L_up_um * 1e6\n        L_down_si = L_down_um * 1e6\n        L_toa_si = L_toa_um * 1e6\n\n        # --- Inversion Step 1: Calculate Target Blackbody Radiance ---\n        if tau <= 0 or epsilon <= 0:\n            # Physical constraints, avoid division by zero\n            return -1.0 \n\n        radiance_at_surface = (L_toa_si - L_up_si) / tau\n        emitted_radiance = radiance_at_surface - (1 - epsilon) * L_down_si\n        B_target = emitted_radiance / epsilon\n\n        if B_target < 0:\n            # Non-physical result, indicates bad input parameters\n            return -1.0\n\n        # --- Inversion Step 2: Bisection Method ---\n        # Define the residual function to find the root of\n        def residual_function(temp_k):\n            return planck_radiance(lambda_m, temp_k) - B_target\n\n        # Set a robust bracketing interval for terrestrial temperatures\n        Ta = 200.0  # Lower bound in Kelvin\n        Tb = 350.0  # Upper bound in Kelvin\n        \n        # Validate the bracket\n        if residual_function(Ta) > 0 or residual_function(Tb) < 0:\n            # Root is not bracketed, which is highly unlikely for valid inputs\n            # Extend bracket if necessary, or return error\n            # For this problem, we assume the initial bracket is sufficient.\n            # A more robust implementation might dynamically find a bracket.\n            pass\n\n        # Set the tolerance for the temperature estimate\n        tolerance = 1e-6\n        \n        # Bisection loop\n        while (Tb - Ta) > tolerance:\n            Tm = (Ta + Tb) / 2\n            if residual_function(Tm) < 0:\n                Ta = Tm\n            else:\n                Tb = Tm\n\n        return (Ta + Tb) / 2\n\n    test_cases = [\n        # (lambda_um, epsilon, tau, L_up_um, L_down_um, T_s_true_K)\n        (10.8, 0.98, 0.85, 1.2, 2.6, 300.0),\n        (11.0, 0.85, 0.95, 0.6, 1.8, 320.0),\n        (12.0, 0.99, 0.50, 3.5, 4.2, 280.0),\n        (10.5, 1.00, 0.90, 1.0, 2.0, 295.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        lambda_um, epsilon, tau, L_up_um, L_down_um, T_s_true_K = case\n\n        # --- FORWARD MODEL: Generate synthetic L_TOA ---\n        # Convert units for forward calculation\n        lambda_m = lambda_um * 1e-6\n        L_up_si = L_up_um * 1e6\n        L_down_si = L_down_um * 1e6\n\n        # Calculate blackbody radiance for the true temperature\n        B_true_si = planck_radiance(lambda_m, T_s_true_K)\n        \n        # Apply the Radiative Transfer Equation\n        L_toa_si = tau * (epsilon * B_true_si + (1 - epsilon) * L_down_si) + L_up_si\n        \n        # Convert synthetic L_toa back to per-µm units for the inversion function input\n        L_toa_um = L_toa_si / 1e6\n\n        # --- INVERSION: Estimate T_s from synthetic L_TOA ---\n        T_s_estimated = estimate_lst_bisection(\n            lambda_um, epsilon, tau, L_up_um, L_down_um, L_toa_um\n        )\n        \n        results.append(T_s_estimated)\n\n    # Format the final output string as required\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While single-channel methods are foundational, their accuracy is limited by atmospheric effects, primarily water vapor absorption. This is where the ingenuity of the split-window technique becomes apparent, as it uses measurements from two adjacent thermal channels to self-correct for the atmosphere. In this exercise, you will derive the theoretical basis for this correction by quantifying the sensitivity of the brightness temperature difference to water vapor, giving you a first-principles understanding of how these powerful algorithms work .",
            "id": "3846994",
            "problem": "A satellite observes a land surface through a vertically homogeneous, plane-parallel atmosphere in the thermal infrared split-window centered at two channels, one near $10.8\\,\\mu\\mathrm{m}$ (denote its brightness temperature by $T_{10}$) and one near $12.0\\,\\mu\\mathrm{m}$ (denote its brightness temperature by $T_{11}$). Assume nadir viewing, surface emissivity equal to $1$, negligible reflection and scattering in the thermal infrared, and Local Thermodynamic Equilibrium (LTE) so that emission is governed by the Planck function. Let the atmosphere be of the midlatitude summer type and be characterized by a total column water vapor $W$ (in $\\mathrm{g}\\,\\mathrm{cm}^{-2}$). Let the channel-dependent atmospheric transmissivities be governed by the Beer–Lambert law, $\\tau_{i}(W)=\\exp\\!\\left(-k_{i}\\,W\\right)$, with absorption coefficients $k_{10}$ and $k_{11}$ (in $\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$). Adopt the narrow-band approximation and linearize the Planck function around a representative atmospheric mean radiating temperature $T_{a}$ to connect radiance to brightness temperature.\n\nStarting strictly from these principles, first derive a general expression for the slope $\\partial\\!\\left(T_{10}-T_{11}\\right)/\\partial W$ in terms of $k_{10}$, $k_{11}$, $\\tau_{10}(W)$, $\\tau_{11}(W)$, $T_{a}$, and the land surface temperature $T_{s}$. Next, consider the standard two-channel split-window estimator for Land Surface Temperature (LST), $\\widehat{T}_{s}=T_{11}+a\\left(T_{10}-T_{11}\\right)$, and determine the coefficient $a$ that makes $\\widehat{T}_{s}$ locally insensitive to first-order perturbations in $W$ about a specified $W_{0}$; that is, enforce $\\left.\\partial \\widehat{T}_{s}/\\partial W\\right|_{W=W_{0}}=0$ and express $a$ in terms of $k_{10}$, $k_{11}$, $\\tau_{10}(W_{0})$, and $\\tau_{11}(W_{0})$.\n\nFinally, evaluate both the slope $\\left.\\partial\\!\\left(T_{10}-T_{11}\\right)/\\partial W\\right|_{W=W_{0}}$ and the corresponding $a$ numerically for the midlatitude summer case with\n$k_{10}=0.07\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$, $k_{11}=0.13\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$, $W_{0}=3.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$, $T_{s}=302\\,\\mathrm{K}$, and $T_{a}=280\\,\\mathrm{K}$. \n\nExpress the slope in $\\mathrm{K}$ per $\\mathrm{g}\\,\\mathrm{cm}^{-2}$ and the coefficient $a$ as unitless. Round your answers to three significant figures. The final answer must be a calculation.",
            "solution": "We begin from the Beer–Lambert law for channel-dependent atmospheric transmissivity, $\\tau_{i}(W)=\\exp\\!\\left(-k_{i}\\,W\\right)$, with $i\\in\\{10,11\\}$. In the thermal infrared, under the stated assumptions (nadir viewing, unity emissivity, negligible reflection/scattering, Local Thermodynamic Equilibrium), the upwelling radiance at the sensor in channel $i$ can be modeled as the linear superposition of attenuated surface emission and atmospheric self-emission:\n$$\nL_{i}(W)=\\tau_{i}(W)\\,B_{i}(T_{s})+\\left[1-\\tau_{i}(W)\\right]\\,B_{i}(T_{a}),\n$$\nwhere $B_{i}(T)$ denotes the band-effective Planck function for channel $i$. The channel brightness temperature $T_{i}$ is defined implicitly by $B_{i}(T_{i})=L_{i}$. Using the narrow-band approximation and linearizing $B_{i}(T)$ about $T_{a}$,\n$$\nB_{i}(T)\\approx B_{i}(T_{a})+B_{i}'(T_{a})\\,(T-T_{a}),\n$$\nwe obtain\n$$\nB_{i}(T_{i})\\approx B_{i}(T_{a})+B_{i}'(T_{a})\\,(T_{i}-T_{a})=\\tau_{i}(W)\\,\\big[B_{i}(T_{a})+B_{i}'(T_{a})(T_{s}-T_{a})\\big]+\\big[1-\\tau_{i}(W)\\big]\\,B_{i}(T_{a}).\n$$\nCanceling $B_{i}(T_{a})$ and dividing by $B_{i}'(T_{a})$ yields\n$$\nT_{i}\\approx \\tau_{i}(W)\\,T_{s}+\\big[1-\\tau_{i}(W)\\big]\\,T_{a}.\n$$\nTherefore, the split-window brightness temperature difference is\n$$\nT_{10}-T_{11}\\approx \\big[\\tau_{10}(W)-\\tau_{11}(W)\\big]\\,(T_{s}-T_{a}).\n$$\nDifferentiating with respect to $W$ and using $\\frac{\\partial \\tau_{i}}{\\partial W}=-k_{i}\\,\\tau_{i}(W)$ gives the general slope\n$$\n\\frac{\\partial\\!\\left(T_{10}-T_{11}\\right)}{\\partial W}=\\Big(-k_{10}\\,\\tau_{10}(W)+k_{11}\\,\\tau_{11}(W)\\Big)\\,(T_{s}-T_{a})=\\Big(k_{11}\\,\\tau_{11}(W)-k_{10}\\,\\tau_{10}(W)\\Big)\\,(T_{s}-T_{a}).\n$$\n\nWe now relate this slope to the coefficient $a$ in the two-channel split-window estimator for Land Surface Temperature (LST),\n$$\n\\widehat{T}_{s}(W)=T_{11}(W)+a\\big(T_{10}(W)-T_{11}(W)\\big).\n$$\nImposing local first-order insensitivity of $\\widehat{T}_{s}$ to $W$ at $W=W_{0}$ requires\n$$\n\\left.\\frac{\\partial \\widehat{T}_{s}}{\\partial W}\\right|_{W=W_{0}}=\\left.\\frac{\\partial T_{11}}{\\partial W}\\right|_{W=W_{0}}+a\\,\\left.\\frac{\\partial\\!\\left(T_{10}-T_{11}\\right)}{\\partial W}\\right|_{W=W_{0}}=0.\n$$\nSolving for $a$ yields\n$$\na=-\\frac{\\left.\\frac{\\partial T_{11}}{\\partial W}\\right|_{W_{0}}}{\\left.\\frac{\\partial\\!\\left(T_{10}-T_{11}\\right)}{\\partial W}\\right|_{W_{0}}}.\n$$\nFrom $T_{i}(W)\\approx \\tau_{i}(W)T_{s}+\\big[1-\\tau_{i}(W)\\big]T_{a}$, we have\n$$\n\\frac{\\partial T_{i}}{\\partial W}=\\frac{\\partial \\tau_{i}}{\\partial W}\\,(T_{s}-T_{a})=-k_{i}\\,\\tau_{i}(W)\\,(T_{s}-T_{a}).\n$$\nSubstituting into the expression for $a$ and cancelling the common factor $(T_{s}-T_{a})$ gives the closed-form relation\n$$\na=\\frac{k_{11}\\,\\tau_{11}(W_{0})}{k_{11}\\,\\tau_{11}(W_{0})-k_{10}\\,\\tau_{10}(W_{0})}.\n$$\n\nWe now evaluate both the slope and $a$ numerically for the specified midlatitude summer case: $k_{10}=0.07\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$, $k_{11}=0.13\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$, $W_{0}=3.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$, $T_{s}=302\\,\\mathrm{K}$, and $T_{a}=280\\,\\mathrm{K}$. First compute the transmissivities at $W_{0}$:\n$$\n\\tau_{10}(W_{0})=\\exp\\!\\big(-k_{10}W_{0}\\big)=\\exp\\!\\big(-0.07\\times 3.2\\big)=\\exp(-0.224)\\approx 0.799369,\n$$\n$$\n\\tau_{11}(W_{0})=\\exp\\!\\big(-k_{11}W_{0}\\big)=\\exp\\!\\big(-0.13\\times 3.2\\big)=\\exp(-0.416)\\approx 0.659748.\n$$\nCompute the products $k_{10}\\tau_{10}(W_{0})$ and $k_{11}\\tau_{11}(W_{0})$:\n$$\nk_{10}\\tau_{10}(W_{0})\\approx 0.07\\times 0.799369\\approx 0.0559558,\\qquad\nk_{11}\\tau_{11}(W_{0})\\approx 0.13\\times 0.659748\\approx 0.0857672.\n$$\nThe brightness temperature difference slope at $W_{0}$ is\n$$\n\\left.\\frac{\\partial\\!\\left(T_{10}-T_{11}\\right)}{\\partial W}\\right|_{W_{0}}=\\big(k_{11}\\tau_{11}(W_{0})-k_{10}\\tau_{10}(W_{0})\\big)\\,(T_{s}-T_{a})\\approx (0.0857672-0.0559558)\\times (302-280).\n$$\nCompute the numeric value:\n$$\n0.0857672-0.0559558=0.0298114,\\quad T_{s}-T_{a}=22,\n$$\n$$\n\\left.\\frac{\\partial\\!\\left(T_{10}-T_{11}\\right)}{\\partial W}\\right|_{W_{0}}\\approx 0.0298114\\times 22\\approx 0.655851\\ \\mathrm{K}\\,\\mathrm{(g\\,cm^{-2})}^{-1}.\n$$\nThe coefficient $a$ at $W_{0}$ is\n$$\na=\\frac{k_{11}\\tau_{11}(W_{0})}{k_{11}\\tau_{11}(W_{0})-k_{10}\\tau_{10}(W_{0})}\\approx \\frac{0.0857672}{0.0298114}\\approx 2.87731.\n$$\nRounding both to three significant figures, the slope is $0.656$ in $\\mathrm{K}$ per $\\mathrm{g}\\,\\mathrm{cm}^{-2}$ and the coefficient $a$ is $2.88$ (unitless).",
            "answer": "$$\\boxed{\\begin{pmatrix}0.656 & 2.88\\end{pmatrix}}$$"
        },
        {
            "introduction": "Moving from simplified theory to practical application, this final exercise demonstrates how a comprehensive, operational-style split-window algorithm functions. Real-world algorithms must account not only for differential water vapor absorption but also for the complexities of surface emissivity and non-linear atmospheric effects. By applying a pre-calibrated, multi-term formula to a realistic scenario, you will see how these various physical corrections are integrated to produce a robust and accurate LST estimate .",
            "id": "3846899",
            "problem": "A satellite observes a terrestrial scene in two longwave infrared window channels centered near $10\\,\\mu\\mathrm{m}$ and $12\\,\\mu\\mathrm{m}$. The instrument reports band-specific brightness temperatures $T_{10}$ and $T_{11}$, and surface emissivities $\\varepsilon_{10}$ and $\\varepsilon_{11}$ have been estimated from a spectral library. The columnar atmospheric water vapor burden $W$ along the line of sight is available from a collocated retrieval. The goal is to estimate the Land Surface Temperature (LST), denoted $T_{s}$, for this scene using a two-channel split-window approach grounded in radiative transfer.\n\nStarting from the bandwise top-of-atmosphere radiative transfer for thermal emission, the definition of brightness temperature through Planck's law, and first-order linearization in band-dependent transmittance and emissivity, derive a practical two-channel split-window retrieval expression for $T_{s}$ that applies corrections based on inter-band brightness temperature differences, emissivity effects, and water vapor. Then, evaluate $T_{s}$ for the specific scene whose measured and estimated properties are:\n- $T_{10}=300\\,\\mathrm{K}$, $T_{11}=298\\,\\mathrm{K}$,\n- $\\varepsilon_{10}=0.98$, $\\varepsilon_{11}=0.97$,\n- $W=2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$.\n\nUse a previously calibrated “simple coefficient set” for midlatitude window-channel conditions, with coefficients\n$$\nc_{0}=0\\,\\mathrm{K},\\quad\nc_{1}=0.50,\\quad\nc_{2}=0.050\\,\\mathrm{K}^{-1},\\quad\nc_{3}=15\\,\\mathrm{K},\\quad\nc_{4}=1.0\\,\\mathrm{K},\\quad\nc_{5}=0.30\\,\\mathrm{K}\\,(\\mathrm{g}\\,\\mathrm{cm}^{-2})^{-1},\n$$\nwhose units are ordered to yield a temperature when combined with appropriate powers of brightness temperature differences, emissivity combinations, and water vapor burden. Round your final numerical answer for $T_{s}$ to four significant figures and express it in kelvins.",
            "solution": "The Land Surface Temperature (LST) $T_{s}$ can be inferred from thermal infrared measurements by relating the top-of-atmosphere radiance in each band to the surface emission, atmospheric transmission, and path radiance terms. For a window band $i\\in\\{10,11\\}$, the upwelling spectral radiance $L_{i}$ can be written as\n$$\nL_{i} \\;=\\; \\varepsilon_{i}\\,\\tau_{i}\\,B_{\\lambda_{i}}(T_{s}) \\;+\\; L_{i}^{\\uparrow} \\;+\\; (1-\\varepsilon_{i})\\,\\tau_{i}\\,L_{i}^{\\downarrow},\n$$\nwhere $\\varepsilon_{i}$ is the surface emissivity in band $i$, $\\tau_{i}$ is the atmospheric transmittance in band $i$, $B_{\\lambda_{i}}(T)$ is the Planck function at wavelength $\\lambda_{i}$, $L_{i}^{\\uparrow}$ is the atmospheric upwelling path radiance, and $L_{i}^{\\downarrow}$ is the downwelling atmospheric radiance incident on the surface. The measured brightness temperature $T_{i}$ is defined implicitly by\n$$\nB_{\\lambda_{i}}(T_{i}) \\;=\\; L_{i}.\n$$\n\nUnder window-channel conditions, $\\tau_{i}$ is close to unity but modulated by the atmospheric water vapor burden $W$, and $L_{i}^{\\uparrow}$ and $L_{i}^{\\downarrow}$ are moderate. A common approach linearizes the inverse Planck relation around $T_{s}$ and treats the atmospheric terms via first-order expansions in $W$ and emissivity contrasts. Specifically, one may write a bandwise approximation\n$$\nT_{i} \\;\\approx\\; T_{s} \\;-\\; \\alpha_{i}\\,W \\;-\\; \\beta_{i}\\,(1-\\varepsilon_{i}) \\;+\\; \\gamma_{i},\n$$\nwhere the coefficients $\\alpha_{i}$, $\\beta_{i}$, and $\\gamma_{i}$ incorporate the sensitivity to water vapor absorption and path radiance, and to the emissivity deficit, along with small offsets due to linearization. Taking differences between bands reduces common-mode dependencies on $T_{s}$. Define\n$$\n\\Delta T \\;=\\; T_{10} - T_{11}, \\quad \\bar{\\varepsilon} \\;=\\; \\frac{\\varepsilon_{10} + \\varepsilon_{11}}{2}, \\quad \\Delta \\varepsilon \\;=\\; \\varepsilon_{10} - \\varepsilon_{11}.\n$$\nA two-channel split-window parameterization that captures the leading-order corrections then expresses $T_{s}$ as a function of $T_{10}$, $\\Delta T$, emissivity combinations, and $W$. Retaining terms up to second order in $\\Delta T$ and first order in $(1-\\bar{\\varepsilon})$, $\\Delta\\varepsilon$, and $W$, a widely used functional form is\n$$\nT_{s} \\;\\approx\\; T_{10} \\;+\\; c_{0} \\;+\\; c_{1}\\,\\Delta T \\;+\\; c_{2}\\,(\\Delta T)^{2} \\;+\\; c_{3}\\,(1-\\bar{\\varepsilon}) \\;+\\; c_{4}\\,\\Delta \\varepsilon \\;+\\; c_{5}\\,W,\n$$\nwhere the coefficients $\\{c_{k}\\}$ summarize the combined effects of inverse-Planck linearization and atmospheric corrections calibrated for the sensor and viewing geometry. This expression emerges from solving the pair of linearized band equations for $T_{s}$ and then re-expressing the atmospheric and emissivity sensitivities in terms of observable inter-band combinations; the quadratic term in $\\Delta T$ accounts for mild nonlinearity in the inter-band differential absorption.\n\nWith the given scene, compute the required combinations symbolically first:\n$$\n\\Delta T \\;=\\; T_{10} - T_{11}, \\quad \\bar{\\varepsilon} \\;=\\; \\frac{\\varepsilon_{10} + \\varepsilon_{11}}{2}, \\quad \\Delta \\varepsilon \\;=\\; \\varepsilon_{10} - \\varepsilon_{11}.\n$$\nSubstitute the provided values only at the final step:\n$$\nT_{10} = 300\\,\\mathrm{K}, \\quad T_{11} = 298\\,\\mathrm{K} \\;\\Rightarrow\\; \\Delta T = 2\\,\\mathrm{K},\n$$\n$$\n\\varepsilon_{10} = 0.98, \\quad \\varepsilon_{11} = 0.97 \\;\\Rightarrow\\; \\bar{\\varepsilon} = \\frac{0.98+0.97}{2} = 0.975, \\quad \\Delta \\varepsilon = 0.98 - 0.97 = 0.01,\n$$\n$$\nW = 2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}.\n$$\nNow evaluate each correction term using the coefficient set:\n$$\nc_{0} = 0\\,\\mathrm{K},\n\\quad c_{1}\\,\\Delta T = 0.50 \\times 2\\,\\mathrm{K} = 1.0\\,\\mathrm{K},\n\\quad c_{2}\\,(\\Delta T)^{2} = 0.050\\,\\mathrm{K}^{-1} \\times (2\\,\\mathrm{K})^{2} = 0.050 \\times 4\\,\\mathrm{K} = 0.20\\,\\mathrm{K},\n$$\n$$\nc_{3}\\,(1-\\bar{\\varepsilon}) = 15\\,\\mathrm{K} \\times (1 - 0.975) = 15 \\times 0.025\\,\\mathrm{K} = 0.375\\,\\mathrm{K},\n$$\n$$\nc_{4}\\,\\Delta \\varepsilon = 1.0\\,\\mathrm{K} \\times 0.01 = 0.010\\,\\mathrm{K},\n\\quad c_{5}\\,W = 0.30\\,\\mathrm{K}\\,(\\mathrm{g}\\,\\mathrm{cm}^{-2})^{-1} \\times 2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2} = 0.60\\,\\mathrm{K}.\n$$\nSum the corrections and add $T_{10}$:\n$$\nT_{s} \\;\\approx\\; 300\\,\\mathrm{K} \\;+\\; \\left( 0 + 1.0 + 0.20 + 0.375 + 0.010 + 0.60 \\right)\\,\\mathrm{K}\n\\;=\\; 300\\,\\mathrm{K} \\;+\\; 2.185\\,\\mathrm{K}\n\\;=\\; 302.185\\,\\mathrm{K}.\n$$\nRound to four significant figures:\n$$\nT_{s} \\;\\approx\\; 302.2\\,\\mathrm{K}.\n$$",
            "answer": "$$\\boxed{302.2}$$"
        }
    ]
}