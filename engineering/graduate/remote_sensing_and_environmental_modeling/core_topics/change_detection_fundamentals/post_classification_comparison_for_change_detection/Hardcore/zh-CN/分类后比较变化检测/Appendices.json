{
    "hands_on_practices": [
        {
            "introduction": "有意义的变化检测要求我们进行“同类”比较。本练习旨在解决一个常见挑战：分类方案随时间演变，导致类别定义不一致。你将学习如何通过原则性方法协调不同的分类粒度，为进行有效的分类后比较分析奠定坚实基础 。",
            "id": "3835097",
            "problem": "在用于变化检测的分类后比较中，一个核心工具是交叉制表（列联）矩阵，其条目 $n_{ij}$ 统计了在时间 $t_1$ 被标记为类别 $i$ 且在时间 $t_2$ 被标记为类别 $j$ 的空间单元（例如，像素）的数量。设时间 $t_1$ 的类别集合为 $C_1 = \\{\\text{农业 }(A), \\text{ 森林 }(F), \\text{ 城市 }(U)\\}$，时间 $t_2$ 的类别集合为 $C_2 = \\{\\text{ 农业 }(A), \\text{ 常绿林 }(F_e), \\text{ 落叶林 }(F_d), \\text{ 城市 }(U)\\}$。假设时间 $t_2$ 的标签仅细化了森林的语义，即 $F_e$ 和 $F_d$ 都是 $F$ 的子类，并且所有像素的面积相等。\n\n给定以下交叉制表矩阵 $\\mathbf{N} \\in \\mathbb{N}^{3 \\times 4}$（行对应于 $C_1$，列对应于 $C_2$）：\n$$\n\\mathbf{N} =\n\\begin{pmatrix}\n420  30  50  20 \\\\\n40  350  310  25 \\\\\n15  10  5  480\n\\end{pmatrix},\n$$\n例如，其中 $n_{F,F_e} = 350$ 表示在时间 $t_1$ 被标记为 $F$ 的 $350$ 个像素在时间 $t_2$ 被标记为 $F_e$。\n\n仅从变化检测的语义一致性首要原则出发，即“变化”必须相对于跨时间的共同类别本体来定义，请评估 $t_1$ 和 $t_2$ 之间不一致的子类粒度对 $n_{ij}$ 转移可解释性的影响，并选择最有原则的聚合方案及其生成的聚合矩阵，以在 $t_1$ 类别分辨率下恢复有意义的“无变化”与“变化”语义。您的答案必须遵守以下规定：\n\n- 使用一个映射，在不对 $t_1$ 时刻创造标签的情况下，对齐跨时间的类别语义。\n- 聚合后，保持每行的像素总数不变。\n- 对于在 $t_1$ 时刻从 $F$ 转移到 $t_2$ 时刻的 $F_e$ 或 $F_d$ 的分配，在 $t_1$ 分辨率下，就“无变化”而言，进行适当处理。\n\n哪个选项正确地描述了可解释性后果并提供了有效的聚合矩阵？\n\nA. 因为 $F_e$ 和 $F_d$ 是 $F$ 的细化，所以在 $t_1$ 分辨率下，转移 $n_{F,F_e}$ 和 $n_{F,F_d}$ 不是语义上的“变化”；它们是 $F$ 内部的子类分配。通过满射 $f: C_2 \\to C_1$（其中 $f(A)=A, f(F_e)=F, f(F_d)=F, f(U)=U$）将 $C_2$ 聚合到 $C_1$，这通过一个列映射矩阵 $\\mathbf{M} \\in \\{0,1\\}^{4 \\times 3}$ 来实现，其中如果 $f(j)=k$ 则 $M_{jk}=1$，否则 $M_{jk}=0$。由此产生的 $\\mathbf{N}^{\\text{agg}} = \\mathbf{N}\\mathbf{M}$ 保持行和不变。聚合后的矩阵为\n$$\n\\mathbf{N}^{\\text{agg}} =\n\\begin{pmatrix}\n420  80  20 \\\\\n40  660  25 \\\\\n15  15  480\n\\end{pmatrix},\n$$\n因此，在 $t_1$ 分辨率下，“无变化”的计数是对角线元素：$A\\to A$ 为 $420$，$F\\to F$ 为 $660$（其中 $660 = 350 + 310$），以及 $U\\to U$ 为 $480$。\n\nB. 任何不同标签之间的转移都意味着“变化”，因此 $n_{F,F_e}$ 和 $n_{F,F_d}$ 都是森林变化。保持 $\\mathbf{N}$ 不变，并计算 $t_1$ 时刻的森林总损失为 $n_{F,F_e}+n_{F,F_d} = 660$，因为 $F_e$ 和 $F_d$ 与 $F$ 不同。\n\nC. 为了协调粒度，使用时间 $t_2$ 时 $F_e$ 和 $F_d$ 的列比例将 $t_1$ 的森林拆分为 $F_e$ 和 $F_d$，从而在 $t_1$ 时刻生成一个包含四个类别的合成矩阵。然后通过按比例重新估计 $t_1$ 时刻 $F_e$ 和 $F_d$ 的 $n_{ij}$ 条目来进行同类比较。\n\nD. 将 $t_2$ 时刻的每个森林子类列进行归一化，使得 $n_{F,F_e}+n_{F,F_d}$ 等于 $t_1$ 时刻森林行的总和，并将归一化后的 $n_{F,F_e}$ 和 $n_{F,F_d}$ 条目视为“无变化”，同时保持其他列不变；这将产生一个保持总计数但不一定保持行和的聚合矩阵。",
            "solution": "### 问题验证\n\n**第1步：提取已知条件**\n\n-   **工具**：用于分类后比较变化检测的交叉制表（列联）矩阵。\n-   **矩阵条目**：$n_{ij}$ 统计了在时间 $t_1$ 被标记为类别 $i$ 且在时间 $t_2$ 被标记为类别 $j$ 的空间单元（像素）的数量。\n-   **$t_1$ 时刻的类别集合**：$C_1 = \\{\\text{农业 }(A), \\text{ 森林 }(F), \\text{ 城市 }(U)\\}$。\n-   **$t_2$ 时刻的类别集合**：$C_2 = \\{\\text{ 农业 }(A), \\text{ 常绿林 }(F_e), \\text{ 落叶林 }(F_d), \\text{ 城市 }(U)\\}$。\n-   **语义关系**：$t_2$ 时刻的标签仅细化了森林语义；$F_e$ 和 $F_d$ 是 $F$ 的子类。\n-   **空间单元假设**：所有像素面积相等。\n-   **交叉制表矩阵**：\n    $$\n    \\mathbf{N} =\n    \\begin{pmatrix}\n    420  30  50  20 \\\\\n    40  350  310  25 \\\\\n    15  10  5  480\n    \\end{pmatrix}\n    $$\n    其中行对应于 $C_1$（顺序为 $A, F, U$），列对应于 $C_2$（顺序为 $A, F_e, F_d, U$）。\n-   **示例**：$n_{F,F_e} = 350$。\n-   **目标**：评估不一致粒度的后果，并选择一个有原则的聚合方案，以在 $t_1$ 类别分辨率下恢复有意义的“无变化”与“变化”语义。\n-   **方案约束**：\n    1.  使用一个映射，在不对 $t_1$ 时刻创造标签的情况下，对齐跨时间的类别语义。\n    2.  聚合后，保持每行的像素总数不变。\n    3.  对于在 $t_1$ 时刻从 $F$ 转移到 $t_2$ 时刻的 $F_e$ 或 $F_d$ 的分配，在 $t_1$ 分辨率下，就“无变化”而言，进行适当处理。\n\n**第2步：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题设置在遥感和地理信息科学的既定框架内，具体解决了多时相土地覆盖变化分析中一个常见且关键的问题，即语义互操作性。所使用的概念（交叉制表、类别本体、语义细化）是该领域的标准概念。该问题是科学合理的。\n-   **适定性**：该问题是适定的。它提供了所有必要的数据（矩阵和类别定义），陈述了一个明确的目标（找到一个有原则的聚合方案），并列出了推导唯一解的明确约束。\n-   **客观性**：语言是技术性的、精确的，并且没有主观性。问题是以对已定义实体的数学和逻辑运算来陈述的。\n-   **缺陷评估**：\n    1.  **科学或事實上的不健全**：无。该场景是变化检测中的一个现实挑战。\n    2.  **不可形式化或不相关**：无。该问题可以用矩阵代数和集合论完美地形式化，并且与主题密切相关。\n    3.  **不完整或矛盾的设置**：无。数据和约束是完整且一致的。矩阵维度（$3 \\times 4$）与 $C_1$（$3$）和 $C_2$（$4$）中的类别数量相对应。\n    4.  **不现实或不可行**：无。像素计数是正整数，这在物理上是现实的。\n    5.  **病态的或结构不良**：无。可以从陈述的原则和约束中推導出唯一的、有意义的解。\n    6.  **伪深刻、琐碎或同义反复**：无。该问题解决的是数据分析中一个真正的概念性挑战，需要的不仅仅是死记硬背的计算。\n    7.  **超出科学可验证性范围**：无。解可以通过逻辑推导和数学计算来验证。\n\n**第3步：结论与行动**\n\n问题陈述是**有效的**。现在将进行解答过程。\n\n### 解答推导\n\n问题的核心是时间 $t_1$ 和 $t_2$ 之间类别本体的语义不一致性。$t_1$ 时刻的“森林”类别（$F$）对应于 $t_2$ 时刻的一组更详细的类别，即{“常绿林”（$F_e$），“落叶林”（$F_d$）}。为了进行有意义的变化分析，我们必须首先建立一个共同的语义参考框架。\n\n问题要求我们在 $t_1$ 类别的分辨率下定义“变化”。这决定了我们必须协调 $t_2$ 的分类方案以匹配 $t_1$ 的方案。这是通过将 $C_2$ 中的子类聚合到它们在 $C_1$ 中对应的父类来实现的。这遵守了不在 $t_1$ 时刻创造信息的约束。\n\n所需的语义映射 $f: C_2 \\to C_1$ 如下：\n-   $f(A) = A$\n-   $f(F_e) = F$\n-   $f(F_d) = F$\n-   $f(U) = U$\n\n这个映射是满射（onto）。要将其应用于交叉制表矩阵 $\\mathbf{N}$，我们必须将 $C_2$ 中映射到 $C_1$ 中相同类别的列合并起来。\n原始矩阵 $\\mathbf{N}$ 是：\n$$\n\\mathbf{N} =\n\\begin{pmatrix}\n420  30  50  20 \\\\\n40  350  310  25 \\\\\n15  10  5  480\n\\end{pmatrix}\n$$\n行由 $C_1 = \\{A, F, U\\}$ 索引，列由 $C_2 = \\{A, F_e, F_d, U\\}$ 索引。\n\n聚合后的矩阵 $\\mathbf{N}^{\\text{agg}}$ 的维度将是 $3 \\times 3$，其行和列都由 $C_1 = \\{A, F, U\\}$ 索引。\n\n-   新的 'A' 列就是旧的 'A' 列（第1列）：\n    $$ \\begin{pmatrix} 420 \\\\ 40 \\\\ 15 \\end{pmatrix} $$\n-   新的 'F' 列是旧的 '$F_e$' 和 '$F_d$' 列（第2列和第3列）之和：\n    $$ \\begin{pmatrix} 30+50 \\\\ 350+310 \\\\ 10+5 \\end{pmatrix} = \\begin{pmatrix} 80 \\\\ 660 \\\\ 15 \\end{pmatrix} $$\n-   新的 'U' 列就是旧的 'U' 列（第4列）：\n    $$ \\begin{pmatrix} 20 \\\\ 25 \\\\ 480 \\end{pmatrix} $$\n\n将这些列组合起来得到聚合矩阵：\n$$\n\\mathbf{N}^{\\text{agg}} =\n\\begin{pmatrix}\n420  80  20 \\\\\n40  660  25 \\\\\n15  15  480\n\\end{pmatrix}\n$$\n\n让我们验证约束条件：\n1.  **不创造标签的映射**：这是我们方法的基础。我们将 $t_2$ 的类别聚合以匹配较粗糙的 $t_1$ 模式。此约束得到满足。\n2.  **保持每行的像素总数不变**：\n    -   第1行 (A): 原始总和 = $420+30+50+20 = 520$。聚合后总和 = $420+80+20 = 520$。保持不变。\n    -   第2行 (F): 原始总和 = $40+350+310+25 = 725$。聚合后总和 = $40+660+25 = 725$。保持不变。\n    -   第3行 (U): 原始总和 = $15+10+5+480 = 510$。聚合后总和 = $15+15+480 = 510$。保持不变。\n    此约束得到满足。\n3.  **对“无变化”的适当处理**：问题规定，从 $t_1$ 的 $F$ 转移到 $t_2$ 的 $F_e$ 或 $F_d$ 的像素，在 $t_1$ 的分辨率下不构成专题变化。在我们的聚合矩阵中，这些计数（$n_{F,F_e}=350$ 和 $n_{F,F_d}=310$）被加总到一个单元格 $n^{\\text{agg}}_{F,F} = 660$ 中。这个单元格位于协调后矩阵的对角线上，正确地将这 $660$ 个像素分类为在 $t_1$ 语义级别上土地覆盖类型“无变化”。此约束得到满足。\n\n$\\mathbf{N}^{\\text{agg}}$ 的对角线代表了在 $t_1$ 分辨率下未改变类别的像素总数：$n^{\\text{agg}}_{A,A}=420$，$n^{\\text{agg}}_{F,F}=660$，$n^{\\text{agg}}_{U,U}=480$。\n\n### 逐项分析选项\n\n**A. 因为 $F_e$ 和 $F_d$ 是 $F$ 的细化，所以在 $t_1$ 分辨率下，转移 $n_{F,F_e}$ 和 $n_{F,F_d}$ 不是语义上的“变化”；它们是 $F$ 内部的子类分配。通过满射 $f: C_2 \\to C_1$（其中 $f(A)=A, f(F_e)=F, f(F_d)=F, f(U)=U$）将 $C_2$ 聚合到 $C_1$，这通过一个列映射矩阵 $\\mathbf{M} \\in \\{0,1\\}^{4 \\times 3}$ 来实现，其中如果 $f(j)=k$ 则 $M_{jk}=1$，否则 $M_{jk}=0$。由此产生的 $\\mathbf{N}^{\\text{agg}} = \\mathbf{N}\\mathbf{M}$ 保持行和不变。聚合后的矩阵为...**\n\n这个选项正确地指出了核心原则：语义粒度的细化在较粗糙的层次上不构成专题变化。它提出了从 $C_2$到 $C_1$ 的正确聚合映射。它正确地将此聚合表述为通过一个列映射矩阵的右乘，已知这种操作可以保持行和不变。得到的矩阵，\n$$\n\\mathbf{N}^{\\text{agg}} =\n\\begin{pmatrix}\n420  80  20 \\\\\n40  660  25 \\\\\n15  15  480\n\\end{pmatrix},\n$$\n以及对对角线元素的解释与我们的推导完全一致。计算出的森林“无变化”计数（$660 = 350+310$）是正确的。\n**结论：正确。**\n\n**B. 任何不同标签之间的转移都意味着“变化”，因此 $n_{F,F_e}$ 和 $n_{F,F_d}$ 都是森林变化。保持 $\\mathbf{N}$ 不变，并计算 $t_1$ 时刻的森林总损失为 $n_{F,F_e}+n_{F,F_d} = 660$，因为 $F_e$ 和 $F_d$ 与 $F$ 不同。**\n\n该选项体现了对变化检测的一种幼稚且不正确的理解。它将标签的变化与语义的变化混为一谈。问题明确指出 $F_e$ 和 $F_d$ 是 $F$ 的子类，所以从 $F$到 $F_e$ 的转移不是森林的损失。此外，它灾难性地误解了矩阵条目的含义：$n_{F,F_e}$ 和 $n_{F,F_d}$ 代表*仍然*是森林的像素。从 $t_1$ 的角度看，森林的损失应该是从 $F$ 行到非森林列（$A$ 和 $U$）的转移，总和为 $40+25=65$ 个像素。该选项的推理根本上是有缺陷的。\n**结论：不正确。**\n\n**C. 为了协调粒度，使用时间 $t_2$ 时 $F_e$ 和 $F_d$ 的列比例将 $t_1$ 的森林拆分为 $F_e$ 和 $F_d$，从而在 $t_1$ 时刻生成一个包含四个类别的合成矩阵。然后通过按比例重新估计 $t_1$ 时刻 $F_e$ 和 $F_d$ 的 $n_{ij}$ 条目来进行同类比较。**\n\n该选项建议分解较粗糙的 $t_1$ 数据以匹配较精细的 $t_2$ 数据。此过程违反了“不对 $t_1$ 时刻创造标签”的明确约束。它要求做出一个强烈的、无法验证的假设，即 $t_1$ 时刻森林子类的比例与 $t_2$ 时刻相同。这相当于创造信息，当有更保守且有原则的方法（聚合）可用时，这是一种科学上不健全的做法。有原则的方法总是协调到语义细节的最低公分母，在本例中即为 $t_1$ 的方案。\n**结论：不正确。**\n\n**D. 将 $t_2$ 时刻的每个森林子类列进行归一化，使得 $n_{F,F_e}+n_{F,F_d}$ 等于 $t_1$ 时刻森林行的总和，并将归一化后的 $n_{F,F_e}$ 和 $n_{F,F_d}$ 条目视为“无变化”，同时保持其他列不变；这将产生一个保持总计数但不一定保持行和的聚合矩阵。**\n\n该选项提出了一个毫无意义的“归一化”过程。条目 $n_{ij}$ 是像素计数；它们是离散数据，不应被任意重新缩放。目标是重新分组计数，而不是改变它们。关键是，该选项承认该方法“不一定[保持]行和”。$t_1$ 时刻某个类别的行和代表该类别中的像素总数，这是从 $t_1$ 地图得出的固定数量。任何有效的聚合都*必须*保持这些行和不变。该选项违反了列联矩阵的一个基本属性以及问题陈述中给出的明确约束。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "单纯的变化百分比可能会产生误导。本练习介绍一种高级技术，它将两幅地图间的总不一致性分解为两个不同部分：数量不一致性（quantity disagreement）和分配不一致性（allocation disagreement）。掌握这种方法能让你对土地覆盖动态提供更细致的解释，区分面积的净变化与空间位置的交换 。",
            "id": "3835113",
            "problem": "一个沿海流域在两个时间点 $t_{1}$ 和 $t_{2}$，使用监督分类法从两幅多光谱卫星图像中进行了制图。四个土地类别为：森林 ($F$)、农业 ($A$)、城市 ($U$) 和水体 ($W$)。分类后比较生成了以下 $4 \\times 4$ 的交叉制表（变化）矩阵，其中包含了像素计数，行表示时间 $t_{1}$ 的类别，列表示时间 $t_{2}$ 的类别。制图的总像素数为 $N = 5000$。在两个时间点，这些类别都是互斥且完全穷尽的，并且两幅地图应用了相同的空间支持和研究区域。\n$$\n\\begin{pmatrix}\n1600  270  230  0 \\\\\n120  1200  90  90 \\\\\n30  60  800  10 \\\\\n50  170  80  200\n\\end{pmatrix}\n$$\n在高级分类后比较中，两幅分类地图之间的总体不一致性可以分解为两个可相加的分量：数量不一致性 $Q$ 和分配不一致性 $A$。数量不一致性 $Q$ 可归因于 $t_{1}$ 和 $t_{2}$ 之间类别总量的差异，而分配不一致性 $A$ 则可归因于无法用总量差异解释的类别空间重分配。从交叉制表导出的比例基本定义以及总体不一致性为1减去归一化对角线之和的概念出发，计算这两个时间点的数量不一致性 $Q$ 和分配不一致性 $A$。将 $Q$ 和 $A$ 均表示为小数（不带百分号），并各自四舍五入到四位有效数字。最后，根据你计算出的 $Q$ 和 $A$ 来解释不一致性中哪一部分源于类别总量的差异，哪一部分源于空间分配（解释是解答的一部分；最终答案必须只包含数值）。",
            "solution": "该问题经检验具有科学依据、提法明确且客观。它展示了遥感土地变化科学中的一种标准分析方法。所有必要数据均已提供且内部一致。给定的交叉制表矩阵中所有元素的总和为 $1600+270+230+0+120+1200+90+90+30+60+800+10+50+170+80+200=5000$，与指定的总像素数 $N=5000$ 相符。我现在开始解答。\n\n设像素计数的交叉制表矩阵为 $C$，其中 $c_{ij}$ 是在时间 $t_1$ 属于类别 $i$ 且在时间 $t_2$ 属于类别 $j$ 的像素数量。类别分别为森林 ($i,j=1$)、农业 ($i,j=2$)、城市 ($i,j=3$) 和水体 ($i,j=4$)。\n$$\nC = \\begin{pmatrix}\n1600  270  230  0 \\\\\n120  1200  90  90 \\\\\n30  60  800  10 \\\\\n50  170  80  200\n\\end{pmatrix}\n$$\n总像素数为 $N = 5000$。为了处理比例，我们将矩阵 $C$ 除以 $N$ 进行归一化，得到比例矩阵 $P$，其中 $P_{ij} = c_{ij} / N$。\n\n首先，我们计算比例矩阵的边际总和。行总和 $P_{i+}$ 代表时间 $t_1$ 时每个类别 $i$ 的比例。列总和 $P_{+j}$ 代表时间 $t_2$ 时每个类别 $j$ 的比例。\n\n计数矩阵 $C$ 的行总和为：\n$c_{1+} = 1600+270+230+0 = 2100$\n$c_{2+} = 120+1200+90+90 = 1500$\n$c_{3+} = 30+60+800+10 = 900$\n$c_{4+} = 50+170+80+200 = 500$\n\n在时间 $t_1$ 对应的比例为：\n$P_{1+} = \\frac{2100}{5000} = 0.42$\n$P_{2+} = \\frac{1500}{5000} = 0.30$\n$P_{3+} = \\frac{900}{5000} = 0.18$\n$P_{4+} = \\frac{500}{5000} = 0.10$\n\n计数矩阵 $C$ 的列总和为：\n$c_{+1} = 1600+120+30+50 = 1800$\n$c_{+2} = 270+1200+60+170 = 1700$\n$c_{+3} = 230+90+800+80 = 1200$\n$c_{+4} = 0+90+10+200 = 300$\n\n在时间 $t_2$ 对应的比例为：\n$P_{+1} = \\frac{1800}{5000} = 0.36$\n$P_{+2} = \\frac{1700}{5000} = 0.34$\n$P_{+3} = \\frac{1200}{5000} = 0.24$\n$P_{+4} = \\frac{300}{5000} = 0.06$\n\n总体一致性是对角线上比例的总和，即 $\\sum_{j=1}^{4} P_{jj}$。\n主对角线上的比例为：\n$P_{11} = \\frac{1600}{5000} = 0.32$\n$P_{22} = \\frac{1200}{5000} = 0.24$\n$P_{33} = \\frac{800}{5000} = 0.16$\n$P_{44} = \\frac{200}{5000} = 0.04$\n总体一致性为 $0.32 + 0.24 + 0.16 + 0.04 = 0.76$。\n\n总体不一致性 $D$ 定义为1减去总体一致性：\n$D = 1 - \\sum_{j=1}^{4} P_{jj} = 1 - 0.76 = 0.24$。\n该不一致性可分解为数量不一致性 ($Q$) 和分配不一致性 ($A$)，使得 $D = Q + A$。\n\n数量不一致性 $Q$ 源于两个时间点之间各类别的总比例差异。它被定义为列边际比例与行边际比例之差的绝对值总和的一半：\n$$\nQ = \\frac{1}{2} \\sum_{j=1}^{4} |P_{+j} - P_{j+}|\n$$\n代入计算出的比例：\n$|P_{+1} - P_{1+}| = |0.36 - 0.42| = 0.06$\n$|P_{+2} - P_{2+}| = |0.34 - 0.30| = 0.04$\n$|P_{+3} - P_{3+}| = |0.24 - 0.18| = 0.06$\n$|P_{+4} - P_{4+}| = |0.06 - 0.10| = 0.04$\n将这些绝对差相加：$0.06 + 0.04 + 0.06 + 0.04 = 0.20$。\n因此，数量不一致性为：\n$Q = \\frac{1}{2} (0.20) = 0.10$。\n\n分配不一致性 $A$ 代表在考虑了类别总量的净变化后，由于类别空间交换而导致的不一致性。它可以作为总不一致性的余项来计算：\n$A = D - Q = 0.24 - 0.10 = 0.14$。\n\n作为验证，我们也可以直接从其定义来计算 $A$。分配不一致性是每个类别在考虑了持续性之后，其总损失和总增益中较小者的总和。对于每个类别 $j$，总损失为 $P_{j+} - P_{jj}$，总增益为 $P_{+j} - P_{jj}$。分配不一致性由下式给出：\n$$\nA = \\sum_{j=1}^{4} \\min(P_{j+} - P_{jj}, P_{+j} - P_{jj})\n$$\n对于每个类别：\n$j=1$: $\\min(P_{1+} - P_{11}, P_{+1} - P_{11}) = \\min(0.42 - 0.32, 0.36 - 0.32) = \\min(0.10, 0.04) = 0.04$\n$j=2$: $\\min(P_{2+} - P_{22}, P_{+2} - P_{22}) = \\min(0.30 - 0.24, 0.34 - 0.24) = \\min(0.06, 0.10) = 0.06$\n$j=3$: $\\min(P_{3+} - P_{33}, P_{+3} - P_{33}) = \\min(0.18 - 0.16, 0.24 - 0.16) = \\min(0.02, 0.08) = 0.02$\n$j=4$: $\\min(P_{4+} - P_{44}, P_{+4} - P_{44}) = \\min(0.10 - 0.04, 0.06 - 0.04) = \\min(0.06, 0.02) = 0.02$\n将这些值相加得到分配不一致性：\n$A = 0.04 + 0.06 + 0.02 + 0.02 = 0.14$。\n这证实了从 $A = D - Q$ 得到的结果。\n\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。\n$Q = 0.1000$\n$A = 0.1400$\n总不一致性为 $D = 0.2400$，对应研究区域的 $24\\%$ 发生了变化。在这总不一致性中，数量不一致性 ($Q = 0.1000$) 占区域面积的 $10\\%$，分配不一致性 ($A = 0.1400$) 占区域面积的 $14\\%$。\n\n解释：比较这两个分量，我们发现 $A > Q$ ($0.1400 > 0.1000$)。这表明两幅地图之间的不一致性更多地归因于土地类别的空间重分配，而不是每个类别总面积的净变化。换句话说，与每个类别的数量变化相比，类别位置的变化是总体地图差异中更重要的组成部分。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1000  0.1400 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "若无精度评估，变化检测地图则是不完整的。本练习将指导你使用分层抽样设计一个统计上稳健的验证方案，这是一种非常高效的方法。你将应用奈曼分配（Neyman allocation）来确定每个层级的最佳样本量，从而在固定成本下，确保对真实变化面积的估算达到最高精度 。",
            "id": "3835032",
            "problem": "一个国家级土地覆盖监测项目使用分类后比较法（PCC），通过卫星影像绘制两个时期之间的二元森林扰动（变化与未变化）地图。该地图将通过分层随机抽样进行审核，以便在固定的总样本量下，以最小的估计量方差来估计真实的扰动面积。分层由地图标签定义：层 $h=1$ 是地图上的变化区域，层 $h=0$ 是地图上的未变化区域。假设有限总体由 $N$ 个像素组成，其中 $N_1$ 个像素被标记为变化，$N_0$ 个像素被标记为未变化，因此 $N=N_0+N_1$。在每个层 $h$ 内，我们感兴趣的变量是二元指示变量 $y$，如果像素确实受到扰动，则 $y$ 等于 $1$，否则等于 $0$。前一年的一项统计上可靠的试点审核，为当前传感器和分类器提供了经过良好校准的层内标准差 $S_h$ 的估计值，并且各层的单位抽样成本相等。抽样分数足够小，因此在设计阶段可以忽略有限总体校正。\n\n从分层抽样的标准定义以及在层内独立简单随机抽样下分层均值估计量的方差出发，推导在总样本量 $n=\\sum_{h} n_h$ 固定的约束下，使估计的总体扰动比例的方差最小化的 $n_h$ 分配规则。然后，使用以下设计值，计算每个层的最优整数样本量：\n- $N_1=4000$，$N_0=8000$，因此 $N=12000$，\n- $S_1=0.30$ 且 $S_0=0.10$，\n- 总样本量 $n=300$。\n\n假设您将从每个层中抽取 $n_h$ 个整数样本，且总和必须等于 $n$。请将您的最终答案表示为层样本量的有序对 $(n_1,n_0)$。无需单位。如果需要任何近似，您应将答案四舍五入到四位有效数字；但在本例中，请提供精确的整数值。",
            "solution": "该问题要求推导在固定总样本量下分层抽样的最优分配规则，并将其应用于一个具体的遥感场景。\n\n首先，我们验证问题的有效性。\n已知条件如下：\n- 两个层，$h=1$（地图变化区域）和 $h=0$（地图未变化区域）。\n- 层 $h=1$ 的总体大小为 $N_1=4000$。\n- 层 $h=0$ 的总体大小为 $N_0=8000$。\n- 总总体大小为 $N=12000$。\n- 层 $h=1$ 的层内标准差为 $S_1=0.30$。\n- 层 $h=0$ 的层内标准差为 $S_0=0.10$。\n- 总样本量为 $n=300$。\n- 感兴趣的变量 $y$ 是一个二元指示变量（$1$ 表示真实扰动，$0$ 表示其他）。\n- 各层抽样成本相等。\n- 可以忽略有限总体校正。\n- 目标是找到整数样本量 $n_1$ 和 $n_0$，以最小化估计的总体扰动比例的方差。\n\n该问题在科学上基于调查抽样的统计理论，这是遥感中用于精度评估的一种标准方法（分类后比较法是一种常见的变化检测技术）。该问题提法明确，提供了一个清晰的目标函数（最小化方差）和一个约束条件（固定的总样本量），并附有所有必要的数据。所提供的数值是一致的（$N_0+N_1=N$）且合理的。因此，该问题是有效的。\n\n我们开始求解。感兴趣的量是总体扰动像素的比例，即二元变量 $y$ 的总体均值 $\\mu$。$\\mu$ 的分层估计量表示为 $\\hat{\\mu}_{st}$，计算为层样本均值 $\\bar{y}_h$ 的加权平均值：\n$$ \\hat{\\mu}_{st} = \\sum_{h=0}^{1} W_h \\bar{y}_h $$\n其中 $W_h = \\frac{N_h}{N}$ 是层 $h$ 的权重。\n\n假设在层内进行独立简单随机抽样，并忽略有限总体校正（如问题所述），该估计量的方差由下式给出：\n$$ V(\\hat{\\mu}_{st}) = \\sum_{h=0}^{1} \\frac{W_h^2 S_h^2}{n_h} $$\n其中 $S_h^2$ 是层 $h$ 内 $y$ 的总体方差，$n_h$ 是层 $h$ 的样本量。\n\n目标是在总样本量 $n$ 固定的约束下，最小化 $V(\\hat{\\mu}_{st})$。约束条件是：\n$$ n_0 + n_1 = n $$\n这是一个约束优化问题，可以使用拉格朗日乘数法求解。我们定义拉格朗日函数 $L$：\n$$ L(n_0, n_1, \\lambda) = V(\\hat{\\mu}_{st}) + \\lambda(n_0 + n_1 - n) $$\n$$ L(n_0, n_1, \\lambda) = \\left( \\frac{W_0^2 S_0^2}{n_0} + \\frac{W_1^2 S_1^2}{n_1} \\right) + \\lambda(n_0 + n_1 - n) $$\n为了找到最小值，我们对 $L$ 分别求关于 $n_0$ 和 $n_1$ 的偏导数，并令它们为零：\n$$ \\frac{\\partial L}{\\partial n_0} = -\\frac{W_0^2 S_0^2}{n_0^2} + \\lambda = 0 \\implies \\lambda = \\frac{W_0^2 S_0^2}{n_0^2} $$\n$$ \\frac{\\partial L}{\\partial n_1} = -\\frac{W_1^2 S_1^2}{n_1^2} + \\lambda = 0 \\implies \\lambda = \\frac{W_1^2 S_1^2}{n_1^2} $$\n从这些方程中，我们得到：\n$$ \\frac{W_0^2 S_0^2}{n_0^2} = \\frac{W_1^2 S_1^2}{n_1^2} $$\n对两边取平方根（因为 $n_h$、$W_h$ 和 $S_h$ 都是非负的）得到：\n$$ \\frac{W_0 S_0}{n_0} = \\frac{W_1 S_1}{n_1} $$\n这表明每个层的最优样本量 $n_h$ 与层权重 $W_h$ 和层标准差 $S_h$ 的乘积成正比。设比例常数为 $k$：\n$$ n_h = k W_h S_h $$\n为了求出 $k$，我们使用总样本量的约束条件：\n$$ \\sum_{h=0}^{1} n_h = n \\implies k W_0 S_0 + k W_1 S_1 = n $$\n$$ k \\left( \\sum_{h=0}^{1} W_h S_h \\right) = n \\implies k = \\frac{n}{\\sum_{j=0}^{1} W_j S_j} $$\n将 $k$ 的这个表达式代回 $n_h$ 的方程，我们得到分配规则，即（在成本相等的情况下）所谓的 Neyman 分配：\n$$ n_h = n \\frac{W_h S_h}{\\sum_{j=0}^{1} W_j S_j} $$\n至此，分配规则的推导完成。\n\n接下来，我们使用所提供的设计值应用此规则。\n- $N_1=4000$，$N_0=8000$，$N=12000$\n- $S_1=0.30$，$S_0=0.10$\n- $n=300$\n\n首先，我们计算层权重 $W_h$：\n$$ W_1 = \\frac{N_1}{N} = \\frac{4000}{12000} = \\frac{1}{3} $$\n$$ W_0 = \\frac{N_0}{N} = \\frac{8000}{12000} = \\frac{2}{3} $$\n接下来，我们计算乘积 $W_h S_h$：\n$$ W_1 S_1 = \\frac{1}{3} \\times 0.30 = \\frac{1}{3} \\times \\frac{3}{10} = \\frac{1}{10} $$\n$$ W_0 S_0 = \\frac{2}{3} \\times 0.10 = \\frac{2}{3} \\times \\frac{1}{10} = \\frac{2}{30} = \\frac{1}{15} $$\n现在，我们计算分配公式分母中的和：\n$$ \\sum_{j=0}^{1} W_j S_j = W_0 S_0 + W_1 S_1 = \\frac{1}{15} + \\frac{1}{10} = \\frac{2}{30} + \\frac{3}{30} = \\frac{5}{30} = \\frac{1}{6} $$\n最后，我们计算最优样本量 $n_1$ 和 $n_0$：\n$$ n_1 = n \\frac{W_1 S_1}{\\sum_{j=0}^{1} W_j S_j} = 300 \\times \\frac{1/10}{1/6} = 300 \\times \\frac{6}{10} = 180 $$\n$$ n_0 = n \\frac{W_0 S_0}{\\sum_{j=0}^{1} W_j S_j} = 300 \\times \\frac{1/15}{1/6} = 300 \\times \\frac{6}{15} = \\frac{1800}{15} = 120 $$\n最优分配得出的结果是 $n_1 = 180$ 和 $n_0 = 120$。这些是整数值，因此无需四舍五入。我们可以验证其和是正确的：$n_1 + n_0 = 180 + 120 = 300$，与总样本量 $n$ 相符。\n\n每个层的最优整数样本量为：地图变化层（$h=1$）为 $180$，地图未变化层（$h=0$）为 $120$。最终答案为有序对 $(n_1, n_0)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 180  120 \\end{pmatrix}}$$"
        }
    ]
}