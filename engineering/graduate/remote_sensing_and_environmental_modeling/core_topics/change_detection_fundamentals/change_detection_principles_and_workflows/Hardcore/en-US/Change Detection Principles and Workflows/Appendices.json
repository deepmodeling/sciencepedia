{
    "hands_on_practices": [
        {
            "introduction": "Reliable change detection often requires combining data from different satellite sensors, each with its own unique characteristics. A primary challenge is that sensors designed to measure the same spectral band, like near-infrared, have different spectral response functions, leading to inconsistent measurements. This exercise provides a practical, hands-on opportunity to implement a data harmonization technique from first principles, showing how to create comparable reflectance values before any change analysis can begin .",
            "id": "3800409",
            "problem": "You are tasked with designing and implementing a preprocessing pipeline for multi-sensor optical images that harmonizes differing spectral response functions using bandpass integration. The goal is to produce per-band change estimates that are comparable across sensors to enable scientifically valid change detection in remote sensing and environmental modeling.\n\nYou must derive the algorithm starting from fundamental definitions of radiometry and linear systems. Let $ \\lambda $ denote wavelength in nanometers, $ \\rho(\\lambda) $ denote the unitless surface reflectance spectrum, and $ S_i(\\lambda) $ denote the spectral response function of sensor band $ i $ (unitless and nonnegative). The raw band measurement $ b_i $ is modeled as the bandpass integral\n$$\nb_i = \\int S_i(\\lambda) \\, \\rho(\\lambda) \\, d\\lambda.\n$$\nTo produce physically consistent reflectance averages across sensors, define the area-normalized spectral response\n$$\ns_i(\\lambda) = \\frac{S_i(\\lambda)}{\\int S_i(\\lambda)\\, d\\lambda},\n$$\nand the corresponding band-averaged reflectance\n$$\n\\bar{b}_i = \\int s_i(\\lambda)\\, \\rho(\\lambda)\\, d\\lambda,\n$$\nwhich is unitless and comparable across sensors when their $ s_i(\\lambda) $ differ. To harmonize bands across two sensors $ A $ and $ B $, define canonical per-band response functions for matched bands by taking the pointwise minimum of the normalized responses and renormalizing the result:\n$$\nh_j(\\lambda) = \\min\\{ s_{A,j}(\\lambda), s_{B,j}(\\lambda) \\}, \\quad H_j(\\lambda) = \\frac{h_j(\\lambda)}{\\int h_j(\\lambda)\\, d\\lambda},\n$$\nwhich yields a canonical band response $ H_j(\\lambda) $ for band $ j $ shared by both sensors. The canonical band-averaged reflectance at time $ t $ is\n$$\n\\bar{c}_j(t) = \\int H_j(\\lambda)\\, \\rho_t(\\lambda)\\, d\\lambda,\n$$\nand the corresponding changes are $ \\Delta \\bar{c}_j = \\bar{c}_j(2) - \\bar{c}_j(1) $. The naive per-sensor changes are $ \\Delta \\bar{b}_{A,j} = \\bar{b}_{A,j}(2) - \\bar{b}_{A,j}(1) $ and $ \\Delta \\bar{b}_{B,j} = \\bar{b}_{B,j}(2) - \\bar{b}_{B,j}(1) $. Define per-band errors relative to the canonical change by\n$$\ne_{A,j} = \\left| \\Delta \\bar{b}_{A,j} - \\Delta \\bar{c}_j \\right|, \\quad e_{B,j} = \\left| \\Delta \\bar{b}_{B,j} - \\Delta \\bar{c}_j \\right|,\n$$\nand the aggregate error for a scenario as\n$$\nE_{\\max} = \\max\\left( e_{A,1}, e_{A,2}, e_{B,1}, e_{B,2} \\right).\n$$\nAll integrals must be computed numerically by the trapezoidal rule over a wavelength grid.\n\nImplement the following algorithm:\n- Use a common wavelength grid $ \\lambda \\in [400, 1000] $ nanometers with $ 1 $ nanometer spacing.\n- Define two sensors, $ A $ and $ B $, each with two bands: a \"green-like\" band and a \"near-infrared (NIR) band\". Model $ S(\\lambda) $ for each band as a Gaussian with unit amplitude:\n  - Sensor $ A $:\n    - Green band: center $ \\mu_{A,g} = 550 $ nanometers, standard deviation $ \\sigma_{A,g} = 15 $ nanometers.\n    - NIR band: center $ \\mu_{A,n} = 850 $ nanometers, standard deviation $ \\sigma_{A,n} = 25 $ nanometers.\n  - Sensor $ B $:\n    - Green band: center $ \\mu_{B,g} = 560 $ nanometers, standard deviation $ \\sigma_{B,g} = 35 $ nanometers.\n    - NIR band: center $ \\mu_{B,n} = 830 $ nanometers, standard deviation $ \\sigma_{B,n} = 50 $ nanometers.\n- Normalize each $ S(\\lambda) $ to $ s(\\lambda) $ by dividing by its area (trapezoidal rule over the grid).\n- Define canonical band responses $ H_g(\\lambda) $ and $ H_n(\\lambda) $ for green and NIR as the renormalized pointwise minimum of the corresponding normalized responses from sensors $ A $ and $ B $.\n\nFor each of the following four test scenarios, compute $ E_{\\max} $:\n- Scenario $ 1 $ (smooth vegetation spectrum with NIR increase): Let\n  $$\n  \\rho_1(\\lambda) = \\mathrm{clip}\\left( 0.03 + 0.07 \\exp\\left( -\\left( \\frac{\\lambda - 550}{25} \\right)^2 \\right) - 0.04 \\exp\\left( -\\left( \\frac{\\lambda - 680}{8} \\right)^2 \\right) + \\frac{0.5}{1 + \\exp\\left( -\\frac{\\lambda - 700}{15} \\right)} ,\\, 0,\\, 1 \\right),\n  $$\n  $$\n  \\rho_2(\\lambda) = \\mathrm{clip}\\left( \\rho_1(\\lambda) + \\frac{0.03}{1 + \\exp\\left( -\\frac{\\lambda - 730}{12} \\right)},\\, 0,\\, 1 \\right).\n  $$\n- Scenario $ 2 $ (uniform reflectance, unchanged): $ \\rho_1(\\lambda) = 0.2 $ and $ \\rho_2(\\lambda) = 0.2 $ for all $ \\lambda $.\n- Scenario $ 3 $ (narrow green feature emerging): $ \\rho_1(\\lambda) $ equals Scenario $ 1 $'s $ \\rho_1(\\lambda) $, and\n  $$\n  \\rho_2(\\lambda) = \\mathrm{clip}\\left( \\rho_1(\\lambda) + 0.1 \\exp\\left( -\\frac{1}{2}\\left( \\frac{\\lambda - 560}{5} \\right)^2 \\right),\\, 0,\\, 1 \\right).\n  $$\n- Scenario $ 4 $ (NIR decrease): $ \\rho_1(\\lambda) $ equals Scenario $ 1 $'s $ \\rho_1(\\lambda) $, and\n  $$\n  \\rho_2(\\lambda) = \\mathrm{clip}\\left( \\rho_1(\\lambda) - \\frac{0.10}{1 + \\exp\\left( -\\frac{\\lambda - 730}{12} \\right)},\\, 0,\\, 1 \\right).\n  $$\n\nRequirements:\n- All numerical integrations must use the trapezoidal rule on the specified grid.\n- Wavelength must be handled in nanometers.\n- Reflectance is unitless and must be kept within $ [0, 1] $ by clipping as shown.\n- Your program must compute $ E_{\\max} $ for each scenario and produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, expressed as decimal floats rounded to six decimal places (e.g., $ [0.012345,0.000000,0.001234,0.056789] $).\n\nYour solution must demonstrate principled derivation from the provided base and implement the algorithm correctly.",
            "solution": "The problem presented is a well-defined exercise in computational remote sensing, specifically addressing the critical task of harmonizing data from different optical sensors for reliable change detection. The problem is scientifically grounded, mathematically coherent, and algorithmically specified. It is therefore deemed valid and a solution will be presented.\n\nThe core challenge stems from the fact that different sensors, even when designed to measure the same nominal spectral band (e.g., \"green\" or \"near-infrared\"), possess distinct spectral response functions, denoted $S_i(\\lambda)$, where $i$ is the band index and $\\lambda$ is the wavelength. This function describes the sensitivity of a sensor band to incoming radiation at each wavelength.\n\nThe raw measurement, or digital number, recorded by a sensor band $i$ is proportional to the bandpass integral of the surface reflectance spectrum $\\rho(\\lambda)$ weighted by the sensor's response function. This is modeled as:\n$$\nb_i = \\int S_i(\\lambda) \\rho(\\lambda) d\\lambda\n$$\nThe value of $b_i$ depends on the total area under the $S_i(\\lambda)$ curve. To make measurements comparable, we must first normalize the spectral response function to have unit area, transforming it into a probability distribution over wavelength. This yields the area-normalized spectral response, $s_i(\\lambda)$:\n$$\ns_i(\\lambda) = \\frac{S_i(\\lambda)}{\\int S_i(\\lambda) d\\lambda}\n$$\nUsing this normalized function, we can define the band-averaged reflectance $\\bar{b}_i$, which is a physically meaningful and unitless quantity representing the average reflectance of the surface as \"seen\" by the sensor's band $i$:\n$$\n\\bar{b}_i = \\int s_i(\\lambda) \\rho(\\lambda) d\\lambda\n$$\nWhile $\\bar{b}_i$ is more comparable across sensors than $b_i$, a discrepancy persists. If two sensors, $A$ and $B$, have different normalized response functions, $s_{A,j}(\\lambda) \\neq s_{B,j}(\\lambda)$ for the same nominal band $j$, then their measured band-averaged reflectances, $\\bar{b}_{A,j}$ and $\\bar{b}_{B,j}$, will differ even when observing the exact same surface reflectance $\\rho(\\lambda)$. This introduces systematic error into change detection analyses that combine data from both sensors.\n\nTo mitigate this, a harmonization procedure is required. The problem specifies a method to create a \"canonical\" spectral response function, $H_j(\\lambda)$, for each matched band pair $j$. This canonical band is derived from the common spectral domain of the two sensor bands. The procedure is as follows:\n$1$. First, find the pointwise minimum of the two normalized sensor responses:\n$$\nh_j(\\lambda) = \\min\\{ s_{A,j}(\\lambda), s_{B,j}(\\lambda) \\}\n$$\nThis function, $h_j(\\lambda)$, represents the shared sensitivity of both sensors across the spectrum.\n$2$. Second, renormalize this minimum function to ensure it has unit area, which yields the canonical spectral response function $H_j(\\lambda)$:\n$$\nH_j(\\lambda) = \\frac{h_j(\\lambda)}{\\int h_j(\\lambda) d\\lambda}\n$$\nUsing this harmonized function, we can define a canonical band-averaged reflectance $\\bar{c}_j(t)$ at a given time $t$ for a surface with reflectance $\\rho_t(\\lambda)$:\n$$\n\\bar{c}_j(t) = \\int H_j(\\lambda) \\rho_t(\\lambda) d\\lambda\n$$\nThe change in this canonical reflectance between two times, $t=1$ and $t=2$, provides a sensor-independent benchmark for the true change:\n$$\n\\Delta \\bar{c}_j = \\bar{c}_j(2) - \\bar{c}_j(1) = \\int H_j(\\lambda) [\\rho_2(\\lambda) - \\rho_1(\\lambda)] d\\lambda\n$$\nThe naive changes measured by each sensor individually are:\n$$\n\\Delta \\bar{b}_{A,j} = \\bar{b}_{A,j}(2) - \\bar{b}_{A,j}(1)\n$$\n$$\n\\Delta \\bar{b}_{B,j} = \\bar{b}_{B,j}(2) - \\bar{b}_{B,j}(1)\n$$\nThe error introduced by the differing sensor characteristics can now be quantified as the absolute difference between the naively-measured change and the canonical change:\n$$\ne_{A,j} = \\left| \\Delta \\bar{b}_{A,j} - \\Delta \\bar{c}_j \\right|\n$$\n$$\ne_{B,j} = \\left| \\Delta \\bar{b}_{B,j} - \\Delta \\bar{c}_j \\right|\n$$\nThe problem defines an aggregate error metric, $E_{\\max}$, for a given scenario as the maximum of these errors across both sensors and both bands (green and near-infrared, denoted by indices $j=1, 2$ or $g, n$):\n$$\nE_{\\max} = \\max\\left( e_{A,g}, e_{A,n}, e_{B,g}, e_{B,n} \\right)\n$$\nThe implementation will follow a discrete numerical approach. All functions are evaluated on a common wavelength grid $\\lambda_k$ from $400$ to $1000$ nm with a spacing of $\\Delta\\lambda = 1$ nm. All integrals are computed using the trapezoidal rule:\n$$\n\\int_a^b f(\\lambda) d\\lambda \\approx \\sum_{k=1}^{N-1} \\frac{f(\\lambda_{k+1}) + f(\\lambda_k)}{2} \\Delta\\lambda\n$$\nThe specific steps for the computation are:\n$1$. Define the discrete wavelength grid.\n$2$. For each sensor ($A, B$) and band (green, NIR), generate the spectral response function $S(\\lambda)$ using the provided Gaussian model with unit amplitude, $S(\\lambda) = \\exp\\left( -\\frac{1}{2} \\left( \\frac{\\lambda - \\mu}{\\sigma} \\right)^2 \\right)$, and parameters.\n$3$. For each of the four generated $S(\\lambda)$ functions, compute the normalized version $s(\\lambda)$ by dividing by its trapezoidal integral over the grid.\n$4$. For each band (green, NIR), compute the canonical response function $H(\\lambda)$ by taking the pointwise minimum of the corresponding $s_A(\\lambda)$ and $s_B(\\lambda)$ and renormalizing the result.\n$5$. For each of the four test scenarios:\n    a. Generate the reflectance spectra $\\rho_1(\\lambda)$ and $\\rho_2(\\lambda)$ on the grid using the provided formulas, ensuring values are clipped to the range $[0, 1]$.\n    b. Calculate the naive changes $\\Delta \\bar{b}_{A,g}$, $\\Delta \\bar{b}_{A,n}$, $\\Delta \\bar{b}_{B,g}$, and $\\Delta \\bar{b}_{B,n}$ by performing the necessary trapezoidal integrations.\n    c. Calculate the canonical changes $\\Delta \\bar{c}_{g}$ and $\\Delta \\bar{c}_{n}$.\n    d. Compute the four error terms $e_{A,g}, e_{A,n}, e_{B,g}, e_{B,n}$.\n    e. Determine $E_{\\max}$ as the maximum of these four errors.\n$6$. Collate the $E_{\\max}$ values from the four scenarios into the final output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum error in change detection across four scenarios\n    by harmonizing simulated multi-sensor optical data.\n    \"\"\"\n\n    # 1. Define the common wavelength grid.\n    # Wavelength grid from 400 to 1000 nm with 1 nm spacing.\n    wavelengths = np.arange(400, 1001, 1).astype(float)\n\n    # Helper function for numerical integration using the trapezoidal rule.\n    def trapezoidal_integral(y_vals, x_vals):\n        return np.trapz(y_vals, x_vals)\n\n    # Helper function to normalize a function over the grid.\n    def normalize_srf(srf_vals, x_vals):\n        integral = trapezoidal_integral(srf_vals, x_vals)\n        if integral == 0:\n            return np.zeros_like(srf_vals)\n        return srf_vals / integral\n\n    # Helper function to define Gaussian SRF (unit amplitude).\n    # The problem description contains two different forms for the Gaussian exponent.\n    # Scenario 1: -(x^2). Scenario 3: -(1/2)*(x^2). The text \"Model S(lambda)\n    # as a Gaussian\" implies the standard form with the 1/2 factor. We will\n    # consistently use the standard Gaussian function form: exp(-0.5 * ((x-mu)/sigma)**2).\n    def gaussian(x, mu, sigma):\n        return np.exp(-0.5 * ((x - mu) / sigma)**2)\n        \n    # 2. Define sensor spectral response functions (SRFs).\n    # Sensor A parameters\n    mu_Ag, sigma_Ag = 550.0, 15.0  # Green\n    mu_An, sigma_An = 850.0, 25.0  # NIR\n    \n    # Sensor B parameters\n    mu_Bg, sigma_Bg = 560.0, 35.0  # Green\n    mu_Bn, sigma_Bn = 830.0, 50.0  # NIR\n\n    # Generate unnormalized SRFs S(lambda)\n    S_Ag = gaussian(wavelengths, mu_Ag, sigma_Ag)\n    S_An = gaussian(wavelengths, mu_An, sigma_An)\n    S_Bg = gaussian(wavelengths, mu_Bg, sigma_Bg)\n    S_Bn = gaussian(wavelengths, mu_Bn, sigma_Bn)\n    \n    # 3. Normalize SRFs to get s(lambda)\n    s_Ag = normalize_srf(S_Ag, wavelengths)\n    s_An = normalize_srf(S_An, wavelengths)\n    s_Bg = normalize_srf(S_Bg, wavelengths)\n    s_Bn = normalize_srf(S_Bn, wavelengths)\n    \n    # 4. Compute canonical SRFs H(lambda)\n    # Green band\n    h_g = np.minimum(s_Ag, s_Bg)\n    H_g = normalize_srf(h_g, wavelengths)\n    \n    # NIR band\n    h_n = np.minimum(s_An, s_Bn)\n    H_n = normalize_srf(h_n, wavelengths)\n    \n    # 5. Define reflectance spectra for all scenarios.\n    def get_scenario_reflectance():\n        # Scenario 1 (and base for 3, 4)\n        lam = wavelengths\n        # Note: The formula for rho1 has an inconsistent Gaussian form.\n        # We assume the intent was the standard Gaussian, but will implement as written.\n        # The impact is small.\n        rho1_scen1_unclipped = (\n            0.03\n            + 0.07 * np.exp(-((lam - 550) / 25)**2)\n            - 0.04 * np.exp(-((lam - 680) / 8)**2)\n            + 0.5 / (1 + np.exp(-(lam - 700) / 15))\n        )\n        rho1_scen1 = np.clip(rho1_scen1_unclipped, 0, 1)\n\n        rho2_scen1 = np.clip(rho1_scen1 + 0.03 / (1 + np.exp(-(lam - 730) / 12)), 0, 1)\n        \n        # Scenario 2\n        rho1_scen2 = np.full_like(lam, 0.2)\n        rho2_scen2 = np.full_like(lam, 0.2)\n        \n        # Scenario 3\n        rho1_scen3 = rho1_scen1\n        rho2_scen3 = np.clip(rho1_scen3 + 0.1 * np.exp(-0.5 * ((lam - 560) / 5)**2), 0, 1)\n        \n        # Scenario 4\n        rho1_scen4 = rho1_scen1\n        rho2_scen4 = np.clip(rho1_scen4 - 0.10 / (1 + np.exp(-(lam - 730) / 12)), 0, 1)\n        \n        return [\n            (rho1_scen1, rho2_scen1),\n            (rho1_scen2, rho2_scen2),\n            (rho1_scen3, rho2_scen3),\n            (rho1_scen4, rho2_scen4),\n        ]\n\n    test_cases = get_scenario_reflectance()\n    results = []\n\n    # 6. Loop through scenarios to calculate E_max for each.\n    for rho1, rho2 in test_cases:\n        # Calculate band-averaged reflectances\n        b_bar_Ag_1 = trapezoidal_integral(s_Ag * rho1, wavelengths)\n        b_bar_Ag_2 = trapezoidal_integral(s_Ag * rho2, wavelengths)\n        b_bar_An_1 = trapezoidal_integral(s_An * rho1, wavelengths)\n        b_bar_An_2 = trapezoidal_integral(s_An * rho2, wavelengths)\n        \n        b_bar_Bg_1 = trapezoidal_integral(s_Bg * rho1, wavelengths)\n        b_bar_Bg_2 = trapezoidal_integral(s_Bg * rho2, wavelengths)\n        b_bar_Bn_1 = trapezoidal_integral(s_Bn * rho1, wavelengths)\n        b_bar_Bn_2 = trapezoidal_integral(s_Bn * rho2, wavelengths)\n        \n        c_bar_g_1 = trapezoidal_integral(H_g * rho1, wavelengths)\n        c_bar_g_2 = trapezoidal_integral(H_g * rho2, wavelengths)\n        c_bar_n_1 = trapezoidal_integral(H_n * rho1, wavelengths)\n        c_bar_n_2 = trapezoidal_integral(H_n * rho2, wavelengths)\n\n        # Calculate naive changes\n        delta_b_bar_Ag = b_bar_Ag_2 - b_bar_Ag_1\n        delta_b_bar_An = b_bar_An_2 - b_bar_An_1\n        delta_b_bar_Bg = b_bar_Bg_2 - b_bar_Bg_1\n        delta_b_bar_Bn = b_bar_Bn_2 - b_bar_Bn_1\n\n        # Calculate canonical changes\n        delta_c_bar_g = c_bar_g_2 - c_bar_g_1\n        delta_c_bar_n = c_bar_n_2 - c_bar_n_1\n        \n        # Calculate per-band errors\n        e_Ag = abs(delta_b_bar_Ag - delta_c_bar_g)\n        e_An = abs(delta_b_bar_An - delta_c_bar_n)\n        e_Bg = abs(delta_b_bar_Bg - delta_c_bar_g)\n        e_Bn = abs(delta_b_bar_Bn - delta_c_bar_n)\n\n        # Find the aggregate maximum error for the scenario\n        E_max = max(e_Ag, e_An, e_Bg, e_Bn)\n        results.append(E_max)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once data are preprocessed and a difference image is created, the core task of change detection is to separate pixels representing true change from those showing only background noise. This practice explores the fundamental statistical approach to this problem by applying the Neyman-Pearson decision criterion. You will practice deriving and applying a decision threshold to control the false alarm probability ($P_{FA}$) at a specific level, a critical skill in designing any operational monitoring system .",
            "id": "3800392",
            "problem": "A pixel-wise change detection workflow is applied to a time series of Synthetic Aperture Radar (SAR) images in which the per-pixel log-intensity difference variable $d$ (in decibels) between two acquisition times is modeled as follows: under the no-change hypothesis $H_0$, $d$ is Gaussian with distribution $d \\sim \\mathcal{N}(\\mu_0, \\sigma^2)$; under the change hypothesis $H_1$, $d$ is Gaussian with distribution $d \\sim \\mathcal{N}(\\mu_1, \\sigma^2)$. The operational objective is to detect positive changes (increases in backscatter), so assume $\\mu_1 > \\mu_0$ and adopt the Neyman–Pearson decision criterion that controls the false alarm probability at a target value. In a calibrated coastal wetland monitoring scenario, the sensor and preprocessing pipeline yield the following parameters: $\\mu_0 = -0.2$ (decibels), $\\sigma = 1.3$ (decibels), and a target false alarm probability $P_{FA} = 0.01$ (expressed as a decimal). Starting from the foundational definitions of hypothesis testing and the Neyman–Pearson principle, derive the decision threshold $\\tau$ on $d$ for an upper-tail test that achieves the specified $P_{FA}$, and then compute its numerical value using the given parameters. Express the final threshold in decibels and round your answer to four significant figures.",
            "solution": "The workflow is a binary hypothesis test on the scalar difference variable $d$. Under the no-change hypothesis $H_0$, $d \\sim \\mathcal{N}(\\mu_0, \\sigma^2)$; under the change hypothesis $H_1$, $d \\sim \\mathcal{N}(\\mu_1, \\sigma^2)$, with $\\mu_1 > \\mu_0$. The Neyman–Pearson principle prescribes a most-powerful test for a fixed false alarm rate by thresholding the likelihood ratio. For two Gaussian distributions with a common variance, the likelihood ratio is a monotone function of $d$ when the means are ordered, so the most-powerful test reduces to an upper-tail threshold on $d$ when $\\mu_1 > \\mu_0$. \n\nLet the decision rule be to declare change if $d \\geq \\tau$ and no change otherwise. The false alarm probability is defined as\n$$\nP_{FA} = \\mathbb{P}(d \\geq \\tau \\mid H_0).\n$$\nUnder $H_0$, $d$ is Gaussian, so we can standardize:\n$$\nZ = \\frac{d - \\mu_0}{\\sigma} \\sim \\mathcal{N}(0, 1).\n$$\nTherefore,\n$$\nP_{FA} = \\mathbb{P}\\!\\left( \\frac{d - \\mu_0}{\\sigma} \\geq \\frac{\\tau - \\mu_0}{\\sigma} \\,\\middle|\\, H_0 \\right) = \\mathbb{P}\\!\\left( Z \\geq \\frac{\\tau - \\mu_0}{\\sigma} \\right) = 1 - \\Phi\\!\\left( \\frac{\\tau - \\mu_0}{\\sigma} \\right),\n$$\nwhere $\\Phi(\\cdot)$ is the cumulative distribution function of the standard normal distribution. Solving for the threshold that achieves a specified $P_{FA}$ gives\n$$\n1 - \\Phi\\!\\left( \\frac{\\tau - \\mu_0}{\\sigma} \\right) = P_{FA}\n\\quad \\Longrightarrow \\quad\n\\Phi\\!\\left( \\frac{\\tau - \\mu_0}{\\sigma} \\right) = 1 - P_{FA}\n\\quad \\Longrightarrow \\quad\n\\frac{\\tau - \\mu_0}{\\sigma} = \\Phi^{-1}(1 - P_{FA}),\n$$\nand hence\n$$\n\\tau = \\mu_0 + \\sigma \\, \\Phi^{-1}(1 - P_{FA}).\n$$\n\nWe now compute the numerical value using the given parameters. With $\\mu_0 = -0.2$, $\\sigma = 1.3$, and $P_{FA} = 0.01$, we have $1 - P_{FA} = 0.99$ and\n$$\n\\Phi^{-1}(0.99) \\approx 2.326347874.\n$$\nThus,\n$$\n\\tau = -0.2 + 1.3 \\times 2.326347874 = -0.2 + 3.0242522362 = 2.8242522362.\n$$\nRounding to four significant figures yields\n$$\n\\tau \\approx 2.824.\n$$\nInterpreting in the application context, the threshold $2.824$ decibels defines the upper-tail decision rule for declaring change at the desired false alarm probability $P_{FA} = 0.01$.",
            "answer": "$$\\boxed{2.824}$$"
        },
        {
            "introduction": "Simply detecting change is not enough; we must also objectively evaluate how well our method performs. This practice introduces the Receiver Operating Characteristic (ROC) curve, a powerful, threshold-independent tool for assessing a detector's ability to distinguish signal from noise. By deriving the mathematical relationship between the true positive rate and false positive rate, you will learn how to quantify and compare the intrinsic effectiveness of different change detection statistics .",
            "id": "3800442",
            "problem": "In an operational change detection workflow for multi-temporal satellite observations of a temperate forest, a scalar detection statistic $T$ is computed per pixel from the two-date imagery using a radiometrically calibrated linear index. After atmospheric correction and bidirectional reflectance normalization, assume $T$ can be modeled as Gaussian under both the null hypothesis of no-change and the alternative hypothesis of change, with equal variance. Specifically, under $H_{0}$ (no-change), $T \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$, and under $H_{1}$ (change), $T \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$, with $\\sigma > 0$. A threshold detector declares change if $T \\geq \\tau$, where $\\tau \\in \\mathbb{R}$ is varied to trace the Receiver Operating Characteristic (ROC) curve. Let the separability index be defined as $d' = (\\mu_{1} - \\mu_{0})/\\sigma$.\n\nStarting from the fundamental definitions of the false positive rate $\\text{FPR}(\\tau) = \\mathbb{P}(T \\geq \\tau \\mid H_{0})$ and the true positive rate $\\text{TPR}(\\tau) = \\mathbb{P}(T \\geq \\tau \\mid H_{1})$ for a threshold detector applied to Gaussian distributions, and using only the standard properties of the Gaussian probability density function and cumulative distribution function, perform the following:\n\n1. Derive the parametric ROC relation by eliminating the threshold $\\tau$ to express $\\text{TPR}$ directly as a function of $\\text{FPR}$ for the equal-variance Gaussian case in terms of the separability $d'$.\n\n2. Using the definition of the Area Under the Curve (AUC) as the integral of $\\text{TPR}$ with respect to $\\text{FPR}$ over its domain, derive a closed-form analytic expression for the AUC that depends only on $d'$ and fundamental functions.\n\nExpress your final AUC solely as a function of $d'$. The final answer must be a single closed-form analytic expression. No numerical rounding is required, and no physical units are involved.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in statistical signal detection theory as applied to remote sensing, is well-posed, objective, and self-contained. The assumptions of Gaussian distributions with equal variance are standard for theoretical analysis of a threshold detector's performance. The problem is a non-trivial but solvable derivation based on these assumptions.\n\nThe solution proceeds in two parts as requested by the problem statement. First, we derive the parametric relationship for the Receiver Operating Characteristic (ROC) curve. Second, we derive the Area Under the Curve (AUC) from its fundamental integral definition.\n\nLet $\\Phi(z)$ denote the cumulative distribution function (CDF) of the standard normal distribution $\\mathcal{N}(0, 1)$, and let $\\phi(z)$ be its probability density function (PDF).\n$$\n\\Phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{z} \\exp\\left(-\\frac{x^2}{2}\\right) dx\n$$\n$$\n\\phi(z) = \\frac{d\\Phi(z)}{dz} = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right)\n$$\nThe complementary CDF is $Q(z) = 1 - \\Phi(z) = \\mathbb{P}(Z > z)$ for $Z \\sim \\mathcal{N}(0, 1)$.\n\nThe false positive rate (FPR) is the probability of detecting change when there is none ($H_0$). With the detection statistic $T \\sim \\mathcal{N}(\\mu_0, \\sigma^2)$ under $H_0$, the FPR for a threshold $\\tau$ is:\n$$\n\\text{FPR}(\\tau) = \\mathbb{P}(T \\geq \\tau \\mid H_0)\n$$\nTo evaluate this, we standardize the variable $T$:\n$$\n\\text{FPR}(\\tau) = \\mathbb{P}\\left(\\frac{T - \\mu_0}{\\sigma} \\geq \\frac{\\tau - \\mu_0}{\\sigma}\\right)\n$$\nSince $(T - \\mu_0)/\\sigma \\sim \\mathcal{N}(0, 1)$, we have:\n$$\n\\text{FPR}(\\tau) = Q\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right)\n$$\n\nThe true positive rate (TPR), or sensitivity, is the probability of detecting change when it has occurred ($H_1$). With $T \\sim \\mathcal{N}(\\mu_1, \\sigma^2)$ under $H_1$, the TPR is:\n$$\n\\text{TPR}(\\tau) = \\mathbb{P}(T \\geq \\tau \\mid H_1) = \\mathbb{P}\\left(\\frac{T - \\mu_1}{\\sigma} \\geq \\frac{\\tau - \\mu_1}{\\sigma}\\right)\n$$\nSince $(T - \\mu_1)/\\sigma \\sim \\mathcal{N}(0, 1)$, we have:\n$$\n\\text{TPR}(\\tau) = Q\\left(\\frac{\\tau - \\mu_1}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_1}{\\sigma}\\right)\n$$\n\n**Part 1: Derivation of the Parametric ROC Relation**\n\nTo express TPR as a function of FPR, we must eliminate the threshold parameter $\\tau$.\nFrom the FPR expression:\n$$\n\\text{FPR} = 1 - \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) \\implies \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) = 1 - \\text{FPR}\n$$\nApplying the inverse standard normal CDF, $\\Phi^{-1}(\\cdot)$:\n$$\n\\frac{\\tau - \\mu_0}{\\sigma} = \\Phi^{-1}(1 - \\text{FPR})\n$$\nUsing the property of the standard normal distribution that $\\Phi^{-1}(1 - p) = -\\Phi^{-1}(p)$:\n$$\n\\frac{\\tau - \\mu_0}{\\sigma} = -\\Phi^{-1}(\\text{FPR})\n$$\nNow, let's manipulate the argument of the TPR's CDF:\n$$\n\\frac{\\tau - \\mu_1}{\\sigma} = \\frac{(\\tau - \\mu_0) - (\\mu_1 - \\mu_0)}{\\sigma} = \\frac{\\tau - \\mu_0}{\\sigma} - \\frac{\\mu_1 - \\mu_0}{\\sigma}\n$$\nSubstituting the term for the threshold and the definition of the separability index $d' = (\\mu_1 - \\mu_0)/\\sigma$:\n$$\n\\frac{\\tau - \\mu_1}{\\sigma} = -\\Phi^{-1}(\\text{FPR}) - d'\n$$\nNow, substitute this back into the expression for TPR:\n$$\n\\text{TPR} = 1 - \\Phi\\left(\\frac{\\tau - \\mu_1}{\\sigma}\\right) = 1 - \\Phi(-\\Phi^{-1}(\\text{FPR}) - d')\n$$\nUsing the symmetry property of the normal CDF, $\\Phi(-z) = 1 - \\Phi(z)$, or equivalently $1 - \\Phi(-z) = \\Phi(z)$:\n$$\n\\text{TPR} = \\Phi(\\Phi^{-1}(\\text{FPR}) + d')\n$$\nThis is the parametric ROC relation, expressing TPR as a function of FPR and the separability $d'$.\n\n**Part 2: Derivation of the Area Under the Curve (AUC)**\n\nThe AUC is the integral of TPR with respect to FPR over the entire range of FPR, which is $[0, 1]$.\n$$\n\\text{AUC} = \\int_0^1 \\text{TPR}(\\text{FPR}) \\, d(\\text{FPR})\n$$\nThe ROC curve is parameterized by $\\tau$. As $\\tau$ varies from $-\\infty$ to $+\\infty$, FPR varies from $1$ to $0$. We can use this parameterization to evaluate the integral.\nFirst, we find the differential $d(\\text{FPR})$ in terms of $d\\tau$:\n$$\n\\text{FPR}(\\tau) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right)\n$$\n$$\n\\frac{d(\\text{FPR})}{d\\tau} = -\\frac{d}{d\\tau} \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) = -\\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) \\cdot \\frac{1}{\\sigma}\n$$\nSo, $d(\\text{FPR}) = -\\frac{1}{\\sigma} \\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) d\\tau$.\n\nThe limits of integration for $\\tau$ corresponding to $\\text{FPR}=0$ and $\\text{FPR}=1$ are $\\tau=+\\infty$ and $\\tau=-\\infty$, respectively.\nSubstituting into the AUC integral:\n$$\n\\text{AUC} = \\int_{\\tau=+\\infty}^{\\tau=-\\infty} \\text{TPR}(\\tau) \\left(-\\frac{1}{\\sigma} \\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right)\\right) d\\tau\n$$\nFlipping the integration limits reverses the sign:\n$$\n\\text{AUC} = \\int_{-\\infty}^{+\\infty} \\text{TPR}(\\tau) \\frac{1}{\\sigma} \\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) d\\tau\n$$\nSubstitute the expression for $\\text{TPR}(\\tau)$:\n$$\n\\text{AUC} = \\int_{-\\infty}^{+\\infty} \\left[1 - \\Phi\\left(\\frac{\\tau - \\mu_1}{\\sigma}\\right)\\right] \\frac{1}{\\sigma} \\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) d\\tau\n$$\nTo solve this integral, we perform a change of variables. Let $u = (\\tau - \\mu_0)/\\sigma$. Then $\\tau = \\sigma u + \\mu_0$ and $d\\tau = \\sigma du$. The limits of integration for $u$ remain $(-\\infty, +\\infty)$.\nThe term $\\frac{1}{\\sigma} \\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) d\\tau$ becomes $\\phi(u) du$.\nThe argument of the $\\Phi$ function becomes:\n$$\n\\frac{\\tau - \\mu_1}{\\sigma} = \\frac{(\\sigma u + \\mu_0) - \\mu_1}{\\sigma} = u + \\frac{\\mu_0 - \\mu_1}{\\sigma} = u - d'\n$$\nThe integral transforms to:\n$$\n\\text{AUC} = \\int_{-\\infty}^{+\\infty} [1 - \\Phi(u - d')] \\phi(u) du\n$$\nThis integral has a probabilistic interpretation. If $U$ and $Z$ are two independent random variables drawn from the standard normal distribution $\\mathcal{N}(0, 1)$, their PDFs are $\\phi(u)$ and $\\phi(z)$, respectively. The integral represents:\n$$\n\\text{AUC} = \\int_{-\\infty}^{+\\infty} \\mathbb{P}(Z > u - d') \\phi(u) du = \\mathbb{P}(Z > U - d')\n$$\nwhere the probability is taken over the joint distribution of $U$ and $Z$.\nThe inequality can be rewritten as $\\mathbb{P}(U - Z < d')$.\nLet us define a new random variable $W = U - Z$. Since $U$ and $Z$ are independent Gaussian variables, $W$ is also Gaussian.\nThe mean of $W$ is $\\mathbb{E}[W] = \\mathbb{E}[U] - \\mathbb{E}[Z] = 0 - 0 = 0$.\nThe variance of $W$ is $\\text{Var}(W) = \\text{Var}(U) + \\text{Var}(-Z) = \\text{Var}(U) + (-1)^2 \\text{Var}(Z) = 1 + 1 = 2$.\nSo, $W \\sim \\mathcal{N}(0, 2)$.\nThe AUC is the probability $\\mathbb{P}(W < d')$. To calculate this, we standardize $W$:\n$$\n\\mathbb{P}(W < d') = \\mathbb{P}\\left(\\frac{W - 0}{\\sqrt{2}} < \\frac{d' - 0}{\\sqrt{2}}\\right)\n$$\nThe variable $(W-0)/\\sqrt{2}$ is a standard normal variable. Therefore, the probability is given by the standard normal CDF $\\Phi(\\cdot)$:\n$$\n\\text{AUC} = \\Phi\\left(\\frac{d'}{\\sqrt{2}}\\right)\n$$\nThis is the closed-form analytic expression for the AUC, dependent only on the separability index $d'$.",
            "answer": "$$\n\\boxed{\\Phi\\left(\\frac{d'}{\\sqrt{2}}\\right)}\n$$"
        }
    ]
}