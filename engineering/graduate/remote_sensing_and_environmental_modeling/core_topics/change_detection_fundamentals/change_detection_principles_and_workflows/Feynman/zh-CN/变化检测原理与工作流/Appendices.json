{
    "hands_on_practices": [
        {
            "introduction": "变化检测的核心挑战在于从噪声中分离出真实的变化信号。一个关键步骤是理解噪声如何通过我们用于构建变化指数的数学公式进行传播。通过解决这个问题 ，您将通过一个形式化推导，揭示在一个常用变化指数中，噪声的影响并非恒定，而是与地表本身的反射率有关。这一重要结论解释了为什么简单的全局阈值方法会失效，并强调了发展自适应阈值技术的必要性。",
            "id": "3800443",
            "problem": "一种双时相光学卫星变化检测工作流通过计算单波段指数来突出变化，同时减轻不同采集时相间的光照和增益差异。假设给定像素在时间 $t_1$ 和 $t_2$ 观测到的地表反射率分别为 $R_1$ 和 $R_2$，其模型为 $R_1 = \\rho_1 + \\epsilon_1$ 和 $R_2 = \\rho_2 + \\epsilon_2$，其中 $\\rho_1$ 和 $\\rho_2$ 是在时间 $t_1$ 和 $t_2$ 的真实地表反射率，而 $\\epsilon_1$ 和 $\\epsilon_2$ 是独立的、零均值的测量噪声，其方差分别为 $\\sigma_1^2$ 和 $\\sigma_2^2$。考虑归一化差异变化指数（NDCI），其定义为\n$$\nD = \\frac{R_2 - R_1}{R_2 + R_1}.\n$$\n从 $\\epsilon_1$ 和 $\\epsilon_2$ 的独立性出发，并利用可微随机变量变换的方差定义，推导 $\\operatorname{Var}(D)$ 关于 $\\rho_1$、$\\rho_2$、$\\sigma_1^2$ 和 $\\sigma_2^2$ 的解析近似。然后，在无变化假设（即 $\\rho_1 = \\rho_2 = \\rho$）下，简化您对 $\\operatorname{Var}(D)$ 的表达式。\n\n在您的推导中，解释当假设在无变化条件下 $D$ 近似服从高斯分布时，您的方差表达式对于一个旨在控制虚警率的变化检测工作流中的阈值选择有何启示。最终答案中不要提供任何数值阈值。\n\n将最终答案表示为在 $\\rho_1 = \\rho_2 = \\rho$ 条件下 $\\operatorname{Var}(D)$ 的闭式简化表达式。最终表达式中无需四舍五入，也不应包含单位。",
            "solution": "问题要求推导归一化差异变化指数（NDCI）方差的解析近似，其定义为 $D = \\frac{R_2 - R_1}{R_2 + R_1}$。推导将首先针对一般情况进行，然后在无变化假设（$\\rho_1 = \\rho_2 = \\rho$）下进行简化。\n\n观测反射率 $R_1$ 和 $R_2$ 是随机变量，其模型为 $R_1 = \\rho_1 + \\epsilon_1$ 和 $R_2 = \\rho_2 + \\epsilon_2$。项 $\\rho_1$ 和 $\\rho_2$ 是真实的、确定性的地表反射率，而 $\\epsilon_1$ 和 $\\epsilon_2$ 是独立的、零均值的测量噪声，其方差分别为 $\\operatorname{Var}(\\epsilon_1) = \\sigma_1^2$ 和 $\\operatorname{Var}(\\epsilon_2) = \\sigma_2^2$。\n\n根据这些模型，我们可以确定 $R_1$ 和 $R_2$ 的期望值和方差。\n$R_1$ 的期望值为 $E[R_1] = E[\\rho_1 + \\epsilon_1] = \\rho_1 + E[\\epsilon_1] = \\rho_1$，因为 $\\rho_1$ 是一个常数。同样地，$E[R_2] = \\rho_2$。\n$R_1$ 的方差为 $\\operatorname{Var}(R_1) = \\operatorname{Var}(\\rho_1 + \\epsilon_1) = \\operatorname{Var}(\\epsilon_1) = \\sigma_1^2$。同样地，$\\operatorname{Var}(R_2) = \\sigma_2^2$。\n由于 $\\epsilon_1$ 和 $\\epsilon_2$ 是独立的，随机变量 $R_1$ 和 $R_2$ 也是独立的，这意味着它们的协方差为零：$\\operatorname{Cov}(R_1, R_2) = 0$。\n\n问题要求 $D$ 的方差的近似值，而 $D$ 是随机变量 $R_1$ 和 $R_2$ 的函数。我们使用不确定性传播方法，该方法基于函数 $D = f(R_1, R_2)$ 在 $R_1$ 和 $R_2$ 的均值（即 $\\rho_1$ 和 $\\rho_2$）附近的一阶泰勒级数展开。对于两个独立随机变量 $X$ 和 $Y$ 的函数，其方差近似为：\n$$\n\\operatorname{Var}(f(X, Y)) \\approx \\left( \\frac{\\partial f}{\\partial X} \\right)^2 \\operatorname{Var}(X) + \\left( \\frac{\\partial f}{\\partial Y} \\right)^2 \\operatorname{Var}(Y)\n$$\n其中偏导数在均值点 $(E[X], E[Y])$ 处求值。\n\n在我们的例子中，$f(R_1, R_2) = D$, $X = R_1$, $Y = R_2$, $\\operatorname{Var}(R_1) = \\sigma_1^2$ 且 $\\operatorname{Var}(R_2) = \\sigma_2^2$。我们需要计算 $D$ 对 $R_1$ 和 $R_2$ 的偏导数。\n\n使用除法求导法则，$\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^2}$：\n对 $R_1$ 的偏导数为：\n$$\n\\frac{\\partial D}{\\partial R_1} = \\frac{\\partial}{\\partial R_1} \\left( \\frac{R_2 - R_1}{R_2 + R_1} \\right) = \\frac{(-1)(R_2 + R_1) - (R_2 - R_1)(1)}{(R_2 + R_1)^2} = \\frac{-R_2 - R_1 - R_2 + R_1}{(R_2 + R_1)^2} = \\frac{-2R_2}{(R_2 + R_1)^2}\n$$\n对 $R_2$ 的偏导数为：\n$$\n\\frac{\\partial D}{\\partial R_2} = \\frac{\\partial}{\\partial R_2} \\left( \\frac{R_2 - R_1}{R_2 + R_1} \\right) = \\frac{(1)(R_2 + R_1) - (R_2 - R_1)(1)}{(R_2 + R_1)^2} = \\frac{R_2 + R_1 - R_2 + R_1}{(R_2 + R_1)^2} = \\frac{2R_1}{(R_2 + R_1)^2}\n$$\n接下来，我们在均值点 $(E[R_1], E[R_2]) = (\\rho_1, \\rho_2)$ 处计算这些偏导数：\n$$\n\\left. \\frac{\\partial D}{\\partial R_1} \\right|_{(\\rho_1, \\rho_2)} = \\frac{-2\\rho_2}{(\\rho_1 + \\rho_2)^2}\n$$\n$$\n\\left. \\frac{\\partial D}{\\partial R_2} \\right|_{(\\rho_1, \\rho_2)} = \\frac{2\\rho_1}{(\\rho_1 + \\rho_2)^2}\n$$\n将这些表达式代入方差传播公式：\n$$\n\\operatorname{Var}(D) \\approx \\left( \\frac{-2\\rho_2}{(\\rho_1 + \\rho_2)^2} \\right)^2 \\operatorname{Var}(R_1) + \\left( \\frac{2\\rho_1}{(\\rho_1 + \\rho_2)^2} \\right)^2 \\operatorname{Var}(R_2)\n$$\n$$\n\\operatorname{Var}(D) \\approx \\frac{4\\rho_2^2}{(\\rho_1 + \\rho_2)^4} \\sigma_1^2 + \\frac{4\\rho_1^2}{(\\rho_1 + \\rho_2)^4} \\sigma_2^2\n$$\n这可以更紧凑地写成：\n$$\n\\operatorname{Var}(D) \\approx \\frac{4}{(\\rho_1 + \\rho_2)^4} \\left( \\rho_2^2 \\sigma_1^2 + \\rho_1^2 \\sigma_2^2 \\right)\n$$\n这就是 $\\operatorname{Var}(D)$ 关于 $\\rho_1$、$\\rho_2$、$\\sigma_1^2$ 和 $\\sigma_2^2$ 的一般解析近似。\n\n现在，我们在无变化假设下简化这个表达式，即真实反射率在两个时相之间没有变化，即 $\\rho_1 = \\rho_2 = \\rho$。将此代入一般方差表达式：\n$$\n\\operatorname{Var}(D) \\approx \\frac{4}{(\\rho + \\rho)^4} \\left( \\rho^2 \\sigma_1^2 + \\rho^2 \\sigma_2^2 \\right)\n$$\n$$\n\\operatorname{Var}(D) \\approx \\frac{4}{(2\\rho)^4} \\rho^2 (\\sigma_1^2 + \\sigma_2^2)\n$$\n$$\n\\operatorname{Var}(D) \\approx \\frac{4\\rho^2}{16\\rho^4} (\\sigma_1^2 + \\sigma_2^2)\n$$\n$$\n\\operatorname{Var}(D) \\approx \\frac{1}{4\\rho^2} (\\sigma_1^2 + \\sigma_2^2)\n$$\n这就是在无变化假设下 NDCI 方差的简化表达式。\n\n最后，我们讨论这对变化检测工作流中阈值选择的启示。\n在无变化假设（$\\rho_1 = \\rho_2 = \\rho$）下，$D$ 的期望值近似为 $E[D] \\approx \\frac{\\rho-\\rho}{\\rho+\\rho} = 0$。对于无变化的像素，$D$ 的分布被假定为近似高斯分布，因此 $D | H_0 \\sim \\mathcal{N}(0, \\sigma_D^2)$，其中 $H_0$ 是无变化假设，且 $\\sigma_D^2 = \\operatorname{Var}(D) \\approx \\frac{\\sigma_1^2 + \\sigma_2^2}{4\\rho^2}$。\n\n如果变化指数的绝对值 $|D|$ 超过某个阈值 $T$，变化检测算法就将该像素识别为“已变化”。当一个无变化的像素被错误地分类为已变化时，就会发生虚警。虚警率（FAR）$\\alpha$ 是此事件的概率：$\\alpha = P(|D| > T | H_0)$。\n\n为了将虚警率控制在期望的水平 $\\alpha$，必须相应地选择阈值 $T$。对于高斯分布，这种关系由 $T = z_{\\alpha/2} \\sigma_D$ 给出，其中 $z_{\\alpha/2}$ 是双尾检验的标准正态分布的临界值（例如，对于 $\\alpha = 0.05$，$z_{\\alpha/2} \\approx 1.96$）。\n代入我们对 $\\sigma_D$ 的表达式：\n$$\nT = z_{\\alpha/2} \\sqrt{\\frac{\\sigma_1^2 + \\sigma_2^2}{4\\rho^2}} = z_{\\alpha/2} \\frac{\\sqrt{\\sigma_1^2 + \\sigma_2^2}}{2|\\rho|}\n$$\n这个结果的关键启示是，方差 $\\sigma_D^2$ 以及因此的适当阈值 $T$ 在整幅图像中并非恒定。它与真实地表反射率 $\\rho$ 成反比。\n这意味着：\n1.  对于暗地物（如水体、阴影），$\\rho$ 值很小，导致方差 $\\sigma_D^2$ 很大。因此，需要一个较大的阈值 $T$ 来维持较低的虚警率。在这些暗区使用一个较小的全局阈值会导致大量虚警。\n2.  对于亮地物（如沙地、雪、城市区域），$\\rho$ 值很大，导致方差 $\\sigma_D^2$ 很小。一个较小的阈值 $T$ 就足以达到期望的虚警率，并能提供更高的灵敏度来检测真实变化。\n\n因此，一个稳健的变化检测工作流不能依赖于单个、全局的阈值来处理整幅图像。相反，它必须采用一种空间自适应的阈值策略。这涉及到在逐像素或局部邻域的基础上估计局部反射率 $\\rho$（例如，通过 $R_1$ 和 $R_2$ 的平均值）和噪声方差（$\\sigma_1^2$、$\\sigma_2^2$）。然后根据每个像素估计的背景反射率来调整其阈值 $T$，从而确保整个场景的虚警率恒定，并提高变化检测的整体准确性。",
            "answer": "$$\n\\boxed{\\frac{\\sigma_1^2 + \\sigma_2^2}{4\\rho^2}}\n$$"
        },
        {
            "introduction": "在理解了噪声的复杂性后，下一个核心任务是设定一个决策边界来区分“变化”与“未变化”的像元。与其依赖于启发式或任意选择的阈值，我们可以利用数据的统计模型来寻找一个理论上的*最优*阈值。本练习  介绍了基于贝叶斯决策理论的Kittler-Illingworth方法，它通过对变化与未变化类别的分布进行建模，推导出能够最小化总体分类错误的阈值。",
            "id": "3800402",
            "problem": "一个双时相光学反射率数据集经过辐射归一化和差分处理，生成了一个标量变化幅度图像，记为 $m \\in \\mathbb{R}$。经验证据表明，$m$ 的直方图是双峰的，可以建模为一个双组分混合模型，其类条件密度为高斯分布：一个峰对应“未变化”像素（$U$），另一个峰对应“已变化”像素（$C$）。假设类条件密度是具有相等方差的高斯分布，即 $m \\mid U \\sim \\mathcal{N}(\\mu_{U}, \\sigma^{2})$ 和 $m \\mid C \\sim \\mathcal{N}(\\mu_{C}, \\sigma^{2})$，并且由于归一化后已变化像素的变化幅度通常更大，因此有 $\\,\\mu_{U}  \\mu_{C}\\,$。设先验概率为 $\\pi_{U}$ 和 $\\pi_{C}$，且 $\\pi_{U} + \\pi_{C} = 1$。\n\n在等同错分成本下，Kittler–Illingworth 最小误差阈值是一个标量决策边界 $\\tau$，贝叶斯决策规则据此将实数线划分为两个区域：当 $m  \\tau$ 时判定为 $U$，当 $m \\ge \\tau$ 时判定为 $C$，从而最小化总分类误差。从贝叶斯决策理论和最大后验概率（MAP）规则的基本原理出发，推导阈值 $\\tau$ 关于 $\\mu_{U}$、$\\mu_{C}$、$\\sigma^{2}$、$\\pi_{U}$ 和 $\\pi_{C}$ 的解析表达式。\n\n将您的最终答案表示为 $\\tau$ 的单个闭式解析表达式。无需四舍五入。阈值 $\\tau$ 是与 $m$ 具有相同测量尺度的标量；最终的方框表达式中不要包含单位。",
            "solution": "用户希望我扮演一位严谨的STEM教授，在经过严格验证过程后解决所提供的问题。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 一个标量变化幅度图像由随机变量 $m \\in \\mathbb{R}$ 给出。\n- $m$ 的分布被建模为一个用于“未变化”像素（$U$）和“已变化”像素（$C$）的双组分混合模型。\n- “未变化”类别的类条件密度为高斯分布：$m \\mid U \\sim \\mathcal{N}(\\mu_{U}, \\sigma^{2})$。\n- “已变化”类别的类条件密度为高斯分布：$m \\mid C \\sim \\mathcal{N}(\\mu_{C}, \\sigma^{2})$。\n- 两个类别的方差相等，记为 $\\sigma^{2}$。\n- 均值排序为 $\\mu_{U}  \\mu_{C}$。\n- “未变化”类别的先验概率为 $\\pi_{U}$。\n- “已变化”类别的先验概率为 $\\pi_{C}$。\n- 先验概率之和为一：$\\pi_{U} + \\pi_{C} = 1$。\n- 错分成本相等。\n- 决策边界是一个单一阈值 $\\tau$，该阈值最小化总分类误差。\n- 决策规则为：如果 $m  \\tau$，则判定为类别 $U$；如果 $m \\ge \\tau$，则判定为类别 $C$。\n- 目标是从贝叶斯决策理论和最大后验概率（MAP）规则的基本原理出发，推导 $\\tau$ 的解析表达式。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于贝叶斯决策理论，这是统计模式识别和机器学习的基石。使用高斯混合模型表示像素强度分布是图像分析和遥感中一种标准且广为接受的技术。Kittler-Illingworth 算法是一种经典的、已发表的最优阈值处理方法。该问题在科学上是合理的。\n- **适定性：** 该问题是适定的。它提供了所有必需的参数（$\\mu_{U}$、$\\mu_{C}$、$\\sigma^{2}$、$\\pi_{U}$、$\\pi_{C}$）和一个明确的目标。假设条件（高斯分布、等方差）确保了决策阈值 $\\tau$ 存在唯一的解析解。\n- **客观性：** 该问题以精确、客观、形式化的数学语言陈述，没有任何主观性或歧义。\n\n**第3步：结论与行动**\n该问题是有效的。这是一个统计决策理论中的标准、自洽且适定的问题。我将继续进行推导。\n\n### 解题推导\n\n目标是找到最优决策阈值 $\\tau$，以最小化总分类错误概率。在指定的等同错分成本条件下，这可以通过最大后验概率（MAP）决策规则实现。MAP规则将测量值 $m$ 分配给具有最大后验概率 $P(K \\mid m)$ 的类别 $K$。\n\n决策边界 $\\tau$ 是测量值 $m$ 的一个特定值，在该点上，两个类别的后验概率相等。在这个无差异点上，我们有：\n$$P(U \\mid m=\\tau) = P(C \\mid m=\\tau)$$\n\n根据贝叶斯定理，给定测量值 $m$ 时，类别 $K \\in \\{U, C\\}$ 的后验概率为：\n$$P(K \\mid m) = \\frac{p(m \\mid K) P(K)}{p(m)}$$\n这里，$p(m \\mid K)$ 是类条件概率密度函数（似然），$P(K)$ 是该类的先验概率，$p(m)$ 是证据，即测量值 $m$ 的边缘概率密度。\n\n将贝叶斯公式代入我们在阈值 $\\tau$ 处的等式：\n$$\\frac{p(\\tau \\mid U) P(U)}{p(\\tau)} = \\frac{p(\\tau \\mid C) P(C)}{p(\\tau)}$$\n\n由于 $p(\\tau)$ 是一个公共的、非零的分母，可以从两边消去，从而得到似然和先验之间的关系：\n$$p(\\tau \\mid U) P(U) = p(\\tau \\mid C) P(C)$$\n\n我们已知这些项的显式形式：\n- 先验概率：$P(U) = \\pi_{U}$ 和 $P(C) = \\pi_{C}$。\n- 似然：类条件密度是高斯分布。正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 的概率密度函数是 $p(x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$。\n因此，\n$$p(\\tau \\mid U) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(\\tau - \\mu_{U})^2}{2\\sigma^2}\\right)$$\n$$p(\\tau \\mid C) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(\\tau - \\mu_{C})^2}{2\\sigma^2}\\right)$$\n\n将这些表达式代入等式：\n$$\\left[ \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(\\tau - \\mu_{U})^2}{2\\sigma^2}\\right) \\right] \\pi_{U} = \\left[ \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(\\tau - \\mu_{C})^2}{2\\sigma^2}\\right) \\right] \\pi_{C}$$\n\n常数项 $\\frac{1}{\\sqrt{2\\pi\\sigma^2}}$ 在等式两边都存在，可以消去：\n$$\\pi_{U} \\exp\\left(-\\frac{(\\tau - \\mu_{U})^2}{2\\sigma^2}\\right) = \\pi_{C} \\exp\\left(-\\frac{(\\tau - \\mu_{C})^2}{2\\sigma^2}\\right)$$\n\n为了求解 $\\tau$，我们对等式两边取自然对数（$\\ln$）。这是一个单调变换，可以简化指数项：\n$$\\ln\\left( \\pi_{U} \\exp\\left(-\\frac{(\\tau - \\mu_{U})^2}{2\\sigma^2}\\right) \\right) = \\ln\\left( \\pi_{C} \\exp\\left(-\\frac{(\\tau - \\mu_{C})^2}{2\\sigma^2}\\right) \\right)$$\n\n使用对数性质 $\\ln(ab) = \\ln(a) + \\ln(b)$：\n$$\\ln(\\pi_{U}) + \\ln\\left( \\exp\\left(-\\frac{(\\tau - \\mu_{U})^2}{2\\sigma^2}\\right) \\right) = \\ln(\\pi_{C}) + \\ln\\left( \\exp\\left(-\\frac{(\\tau - \\mu_{C})^2}{2\\sigma^2}\\right) \\right)$$\n\n使用性质 $\\ln(\\exp(x)) = x$：\n$$\\ln(\\pi_{U}) - \\frac{(\\tau - \\mu_{U})^2}{2\\sigma^2} = \\ln(\\pi_{C}) - \\frac{(\\tau - \\mu_{C})^2}{2\\sigma^2}$$\n\n为了分离出 $\\tau$，我们首先将整个方程乘以 $2\\sigma^2$ 以消除分母：\n$$2\\sigma^2 \\ln(\\pi_{U}) - (\\tau - \\mu_{U})^2 = 2\\sigma^2 \\ln(\\pi_{C}) - (\\tau - \\mu_{C})^2$$\n\n接下来，展开平方二项式：\n$$2\\sigma^2 \\ln(\\pi_{U}) - (\\tau^2 - 2\\tau\\mu_{U} + \\mu_{U}^2) = 2\\sigma^2 \\ln(\\pi_{C}) - (\\tau^2 - 2\\tau\\mu_{C} + \\mu_{C}^2)$$\n$$2\\sigma^2 \\ln(\\pi_{U}) - \\tau^2 + 2\\tau\\mu_{U} - \\mu_{U}^2 = 2\\sigma^2 \\ln(\\pi_{C}) - \\tau^2 + 2\\tau\\mu_{C} - \\mu_{C}^2$$\n\n等式两边的 $\\tau^2$ 项相互抵消。这个简化是方差相等假设（$\\sigma_U^2 = \\sigma_C^2 = \\sigma^2$）的直接结果。\n$$2\\sigma^2 \\ln(\\pi_{U}) + 2\\tau\\mu_{U} - \\mu_{U}^2 = 2\\sigma^2 \\ln(\\pi_{C}) + 2\\tau\\mu_{C} - \\mu_{C}^2$$\n\n现在，我们重新整理方程，将含 $\\tau$ 的项归到一边，所有其他项归到另一边：\n$$2\\tau\\mu_{U} - 2\\tau\\mu_{C} = \\mu_{U}^2 - \\mu_{C}^2 + 2\\sigma^2 \\ln(\\pi_{C}) - 2\\sigma^2 \\ln(\\pi_{U})$$\n\n提取公因式：左边是 $2\\tau$，右边是 $2\\sigma^2$。\n$$2\\tau(\\mu_{U} - \\mu_{C}) = (\\mu_{U}^2 - \\mu_{C}^2) + 2\\sigma^2 (\\ln(\\pi_{C}) - \\ln(\\pi_{U}))$$\n\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$ 和平方差公式 $\\mu_{U}^2 - \\mu_{C}^2 = (\\mu_{U} - \\mu_{C})(\\mu_{U} + \\mu_{C})$：\n$$2\\tau(\\mu_{U} - \\mu_{C}) = (\\mu_{U} - \\mu_{C})(\\mu_{U} + \\mu_{C}) + 2\\sigma^2 \\ln\\left(\\frac{\\pi_{C}}{\\pi_{U}}\\right)$$\n\n为了求解 $\\tau$，我们将等式两边除以 $2(\\mu_{U} - \\mu_{C})$。这是允许的，因为已知 $\\mu_{U}  \\mu_{C}$，这意味着 $\\mu_{U} - \\mu_{C} \\neq 0$。\n$$\\tau = \\frac{(\\mu_{U} - \\mu_{C})(\\mu_{U} + \\mu_{C})}{2(\\mu_{U} - \\mu_{C})} + \\frac{2\\sigma^2}{2(\\mu_{U} - \\mu_{C})} \\ln\\left(\\frac{\\pi_{C}}{\\pi_{U}}\\right)$$\n\n简化表达式：\n$$\\tau = \\frac{\\mu_{U} + \\mu_{C}}{2} + \\frac{\\sigma^2}{\\mu_{U} - \\mu_{C}} \\ln\\left(\\frac{\\pi_{C}}{\\pi_{U}}\\right)$$\n\n为了保持分母为正（因为 $\\mu_{C} > \\mu_{U}$），我们可以将 $\\frac{1}{\\mu_{U} - \\mu_{C}}$ 改写为 $-\\frac{1}{\\mu_{C} - \\mu_{U}}$。同时，使用性质 $\\ln(a/b) = -\\ln(b/a)$：\n$$\\tau = \\frac{\\mu_{U} + \\mu_{C}}{2} + \\frac{\\sigma^2}{-(\\mu_{C} - \\mu_{U})} \\ln\\left(\\frac{\\pi_{C}}{\\pi_{U}}\\right) = \\frac{\\mu_{U} + \\mu_{C}}{2} - \\frac{\\sigma^2}{\\mu_{C} - \\mu_{U}} [-\\ln\\left(\\frac{\\pi_{U}}{\\pi_{C}}\\right)]$$\n这就得到了最终的、更常规的形式：\n$$\\tau = \\frac{\\mu_{U} + \\mu_{C}}{2} + \\frac{\\sigma^2}{\\mu_{C} - \\mu_{U}} \\ln\\left(\\frac{\\pi_{U}}{\\pi_{C}}\\right)$$\n\n这个解析表达式表明，最优阈值 $\\tau$ 是两个类别均值的中点 $\\frac{\\mu_{U} + \\mu_{C}}{2}$，并由一个偏置项进行调整。该偏置项取决于公共方差 $\\sigma^2$ 和先验概率的比值。如果先验概率相等，即 $\\pi_{U} = \\pi_{C}$，那么 $\\ln(\\pi_{U}/\\pi_{C}) = \\ln(1) = 0$，阈值就简化为中点 $\\tau = \\frac{\\mu_{U} + \\mu_{C}}{2}$，这与预期相符。如果某个类别的先验概率更高，阈值会偏离该类别的均值，以减少对这个更可能出现的类别的错分。",
            "answer": "$$\n\\boxed{\\frac{\\mu_{U} + \\mu_{C}}{2} + \\frac{\\sigma^{2}}{\\mu_{C} - \\mu_{U}} \\ln\\left(\\frac{\\pi_{U}}{\\pi_{C}}\\right)}\n$$"
        },
        {
            "introduction": "一个变化检测算法的真正效能，不应取决于某个特定阈值的选择。受试者工作特征（ROC）曲线和其曲线下面积（AUC）提供了一个稳健的、独立于阈值的框架来评估检测器的内在性能。本练习  将指导您推导ROC曲线的解析表达式及AUC，让您掌握定量比较不同变化特征可分性的核心技能，这对于算法的设计与验证至关重要。",
            "id": "3800442",
            "problem": "在一个用于温带森林多时相卫星观测的业务化变化检测工作流中，使用辐射定标的线性指数，从两个日期的影像中为每个像素计算一个标量检测统计量 $T$。经过大气校正和双向反射率归一化后，假设在无变化（零假设）和有变化（备择假设）两种情况下，$T$ 都可以用等方差的高斯分布进行建模。具体来说，在 $H_{0}$（无变化）下，$T \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$；在 $H_{1}$（有变化）下，$T \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$，其中 $\\sigma > 0$。一个阈值检测器在 $T \\geq \\tau$ 时判断为变化，其中 $\\tau \\in \\mathbb{R}$ 是一个可变参数，用于绘制受试者工作特征（ROC）曲线。定义可分离性指数为 $d' = (\\mu_{1} - \\mu_{0})/\\sigma$。\n\n从应用于高斯分布的阈值检测器的假阳性率 $\\text{FPR}(\\tau) = \\mathbb{P}(T \\geq \\tau \\mid H_{0})$ 和真阳性率 $\\text{TPR}(\\tau) = \\mathbb{P}(T \\geq \\tau \\mid H_{1})$ 的基本定义出发，并仅使用高斯概率密度函数和累积分布函数的标准性质，执行以下操作：\n\n1. 对于等方差高斯情况，通过消除阈值 $\\tau$ 来推导参数化的ROC关系，将 $\\text{TPR}$ 直接表示为 $\\text{FPR}$ 和可分离性指数 $d'$ 的函数。\n\n2. 使用曲线下面积（AUC）的定义，即 $\\text{TPR}$ 对其定义域上的 $\\text{FPR}$ 的积分，推导出一个仅依赖于 $d'$ 和基本函数的 AUC 闭式解析表达式。\n\n将你的最终 AUC 仅表示为 $d'$ 的函数。最终答案必须是单个闭式解析表达式。不需要数值舍入，也不涉及物理单位。",
            "solution": "问题陈述被评估为有效。它在科学上基于应用于遥感的统计信号检测理论，是适定的、客观的且自洽的。对于阈值检测器性能的理论分析，假设高斯分布具有等方差是标准做法。这个问题是一个基于这些假设的非平凡但可解的推导。\n\n解答过程按问题陈述的要求分为两部分。首先，我们推导受试者工作特征（ROC）曲线的参数化关系。其次，我们从其基本积分定义推导曲线下面积（AUC）。\n\n令 $\\Phi(z)$ 表示标准正态分布 $\\mathcal{N}(0, 1)$ 的累积分布函数（CDF），令 $\\phi(z)$ 表示其概率密度函数（PDF）。\n$$\n\\Phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{z} \\exp\\left(-\\frac{x^2}{2}\\right) dx\n$$\n$$\n\\phi(z) = \\frac{d\\Phi(z)}{dz} = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right)\n$$\n互补累积分布函数为 $Q(z) = 1 - \\Phi(z) = \\mathbb{P}(Z > z)$，其中 $Z \\sim \\mathcal{N}(0, 1)$。\n\n假阳性率（FPR）是在没有变化（$H_0$）时检测到变化的概率。在 $H_0$ 下，检测统计量 $T \\sim \\mathcal{N}(\\mu_0, \\sigma^2)$，对于阈值 $\\tau$ 的FPR为：\n$$\n\\text{FPR}(\\tau) = \\mathbb{P}(T \\geq \\tau \\mid H_0)\n$$\n为计算此值，我们对变量 $T$ 进行标准化：\n$$\n\\text{FPR}(\\tau) = \\mathbb{P}\\left(\\frac{T - \\mu_0}{\\sigma} \\geq \\frac{\\tau - \\mu_0}{\\sigma}\\right)\n$$\n由于 $(T - \\mu_0)/\\sigma \\sim \\mathcal{N}(0, 1)$，我们有：\n$$\n\\text{FPR}(\\tau) = Q\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right)\n$$\n\n真阳性率（TPR），或称灵敏度，是在发生变化（$H_1$）时检测到变化的概率。在 $H_1$ 下，$T \\sim \\mathcal{N}(\\mu_1, \\sigma^2)$，TPR为：\n$$\n\\text{TPR}(\\tau) = \\mathbb{P}(T \\geq \\tau \\mid H_1) = \\mathbb{P}\\left(\\frac{T - \\mu_1}{\\sigma} \\geq \\frac{\\tau - \\mu_1}{\\sigma}\\right)\n$$\n由于 $(T - \\mu_1)/\\sigma \\sim \\mathcal{N}(0, 1)$，我们有：\n$$\n\\text{TPR}(\\tau) = Q\\left(\\frac{\\tau - \\mu_1}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_1}{\\sigma}\\right)\n$$\n\n**第1部分：参数化ROC关系的推导**\n\n为将TPR表示为FPR的函数，我们必须消除阈值参数 $\\tau$。\n从FPR的表达式可知：\n$$\n\\text{FPR} = 1 - \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) \\implies \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) = 1 - \\text{FPR}\n$$\n应用标准正态CDF的逆函数 $\\Phi^{-1}(\\cdot)$：\n$$\n\\frac{\\tau - \\mu_0}{\\sigma} = \\Phi^{-1}(1 - \\text{FPR})\n$$\n使用标准正态分布的性质 $\\Phi^{-1}(1 - p) = -\\Phi^{-1}(p)$：\n$$\n\\frac{\\tau - \\mu_0}{\\sigma} = -\\Phi^{-1}(\\text{FPR})\n$$\n现在，我们处理TPR的CDF的参数：\n$$\n\\frac{\\tau - \\mu_1}{\\sigma} = \\frac{(\\tau - \\mu_0) - (\\mu_1 - \\mu_0)}{\\sigma} = \\frac{\\tau - \\mu_0}{\\sigma} - \\frac{\\mu_1 - \\mu_0}{\\sigma}\n$$\n代入阈值项和可分离性指数的定义 $d' = (\\mu_1 - \\mu_0)/\\sigma$：\n$$\n\\frac{\\tau - \\mu_1}{\\sigma} = -\\Phi^{-1}(\\text{FPR}) - d'\n$$\n现在，将此代回TPR的表达式中：\n$$\n\\text{TPR} = 1 - \\Phi\\left(\\frac{\\tau - \\mu_1}{\\sigma}\\right) = 1 - \\Phi(-\\Phi^{-1}(\\text{FPR}) - d')\n$$\n使用正态CDF的对称性 $\\Phi(-z) = 1 - \\Phi(z)$，或等效地 $1 - \\Phi(-z) = \\Phi(z)$：\n$$\n\\text{TPR} = \\Phi(\\Phi^{-1}(\\text{FPR}) + d')\n$$\n这就是参数化的ROC关系式，它将TPR表示为FPR和可分离性指数 $d'$ 的函数。\n\n**第2部分：曲线下面积（AUC）的推导**\n\nAUC是TPR在FPR的整个范围 $[0, 1]$ 上对FPR的积分。\n$$\n\\text{AUC} = \\int_0^1 \\text{TPR}(\\text{FPR}) \\, d(\\text{FPR})\n$$\nROC曲线由 $\\tau$ 参数化。当 $\\tau$ 从 $-\\infty$ 变化到 $+\\infty$ 时，FPR从 $1$ 变化到 $0$。我们可以使用这种参数化来计算积分。\n首先，我们求出微分 $d(\\text{FPR})$（用 $d\\tau$ 表示）：\n$$\n\\text{FPR}(\\tau) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right)\n$$\n$$\n\\frac{d(\\text{FPR})}{d\\tau} = -\\frac{d}{d\\tau} \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) = -\\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) \\cdot \\frac{1}{\\sigma}\n$$\n所以，$d(\\text{FPR}) = -\\frac{1}{\\sigma} \\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) d\\tau$。\n\n对应于 $\\text{FPR}=0$ 和 $\\text{FPR}=1$ 的 $\\tau$ 的积分极限分别是 $\\tau=+\\infty$ 和 $\\tau=-\\infty$。\n代入AUC积分中：\n$$\n\\text{AUC} = \\int_{\\tau=+\\infty}^{\\tau=-\\infty} \\text{TPR}(\\tau) \\left(-\\frac{1}{\\sigma} \\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right)\\right) d\\tau\n$$\n翻转积分极限会改变符号：\n$$\n\\text{AUC} = \\int_{-\\infty}^{+\\infty} \\text{TPR}(\\tau) \\frac{1}{\\sigma} \\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) d\\tau\n$$\n代入 $\\text{TPR}(\\tau)$ 的表达式：\n$$\n\\text{AUC} = \\int_{-\\infty}^{+\\infty} \\left[1 - \\Phi\\left(\\frac{\\tau - \\mu_1}{\\sigma}\\right)\\right] \\frac{1}{\\sigma} \\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) d\\tau\n$$\n为了解这个积分，我们进行变量替换。令 $u = (\\tau - \\mu_0)/\\sigma$。则 $\\tau = \\sigma u + \\mu_0$ 且 $d\\tau = \\sigma du$。$u$ 的积分极限仍然是 $(-\\infty, +\\infty)$。\n项 $\\frac{1}{\\sigma} \\phi\\left(\\frac{\\tau - \\mu_0}{\\sigma}\\right) d\\tau$ 变为 $\\phi(u) du$。\n$\\Phi$ 函数的参数变为：\n$$\n\\frac{\\tau - \\mu_1}{\\sigma} = \\frac{(\\sigma u + \\mu_0) - \\mu_1}{\\sigma} = u + \\frac{\\mu_0 - \\mu_1}{\\sigma} = u - d'\n$$\n积分变换为：\n$$\n\\text{AUC} = \\int_{-\\infty}^{+\\infty} [1 - \\Phi(u - d')] \\phi(u) du\n$$\n这个积分有一个概率解释。如果 $U$ 和 $Z$ 是从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽取的两个独立随机变量，它们的PDF分别为 $\\phi(u)$ 和 $\\phi(z)$。该积分表示：\n$$\n\\text{AUC} = \\int_{-\\infty}^{+\\infty} \\mathbb{P}(Z > u - d') \\phi(u) du = \\mathbb{P}(Z > U - d')\n$$\n其中概率是基于 $U$ 和 $Z$ 的联合分布计算的。\n该不等式可以重写为 $\\mathbb{P}(U - Z  d')$。\n让我们定义一个新的随机变量 $W = U - Z$。由于 $U$ 和 $Z$ 是独立的高斯变量，$W$ 也是高斯变量。\n$W$ 的均值为 $\\mathbb{E}[W] = \\mathbb{E}[U] - \\mathbb{E}[Z] = 0 - 0 = 0$。\n$W$ 的方差为 $\\text{Var}(W) = \\text{Var}(U) + \\text{Var}(-Z) = \\text{Var}(U) + (-1)^2 \\text{Var}(Z) = 1 + 1 = 2$。\n所以，$W \\sim \\mathcal{N}(0, 2)$。\nAUC是概率 $\\mathbb{P}(W  d')$。为了计算这个概率，我们对 $W$ 进行标准化：\n$$\n\\mathbb{P}(W  d') = \\mathbb{P}\\left(\\frac{W - 0}{\\sqrt{2}}  \\frac{d' - 0}{\\sqrt{2}}\\right)\n$$\n变量 $(W-0)/\\sqrt{2}$ 是一个标准正态变量。因此，该概率由标准正态CDF $\\Phi(\\cdot)$ 给出：\n$$\n\\text{AUC} = \\Phi\\left(\\frac{d'}{\\sqrt{2}}\\right)\n$$\n这就是AUC的闭式解析表达式，它仅依赖于可分离性指数 $d'$。",
            "answer": "$$\n\\boxed{\\Phi\\left(\\frac{d'}{\\sqrt{2}}\\right)}\n$$"
        }
    ]
}