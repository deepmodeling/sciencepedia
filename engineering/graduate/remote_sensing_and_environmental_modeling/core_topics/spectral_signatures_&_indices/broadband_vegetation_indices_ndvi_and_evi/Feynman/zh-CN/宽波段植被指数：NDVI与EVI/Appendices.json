{
    "hands_on_practices": [
        {
            "introduction": "要想真正理解一个工具，我们必须了解它的局限性。本练习运用基础微积分来探究归一化植被指数(NDVI)对其输入——近红外($R_{NIR}$)和红光($R_{Red}$)反射率——的敏感性。通过分析NDVI的响应如何随植被密度的变化而改变，您将揭示出著名的“饱和”效应背后的数学原理，这是解读植被数据的关键概念。",
            "id": "3799746",
            "problem": "考虑在植被表面上进行的一次被动光学遥感反演，其中可测量的量是两个宽波段通道（近红外和红光）的冠层顶部双向反射因子。分别用 $R_{NIR} \\in (0,1)$ 和 $R_{Red} \\in (0,1)$ 表示这些反射率，并假设 $R_{NIR} + R_{Red} \\neq 0$。构建一个归一化差异指数以减少对两个波段共有的乘性光照和增益效应的敏感性。根据这种归一化差异构造，归一化植被指数 (NDVI) 由近红外和红光反射率定义。\n\n假设由于测量噪声，每个反射率都受到小的加性扰动 $\\delta R_{NIR}$ 和 $\\delta R_{Red}$，并假设 NDVI 关于 $R_{NIR}$ 和 $R_{Red}$ 的一阶泰勒近似在工作点 $(R_{NIR}, R_{Red})$ 处有效。从归一化差异构造和基本多元微积分出发，推导出偏导数 $\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{NIR}}$ 和 $\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{Red}}$。然后定义相对灵敏度比\n$$S(R_{NIR}, R_{Red}) = \\frac{\\left|\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{NIR}}\\right|}{\\left|\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{Red}}\\right|}$$\n并将 $S$ 表示为 $R_{NIR}$ 和 $R_{Red}$ 的闭式函数。\n\n定性地解释在 $R_{NIR}$ 相对于 $R_{Red}$ 较低和较高的不同情况下，$S$ 如何变化，并讨论这对归一化差异构造在各波段中对扰动的响应性有何影响。你可以参考增强型植被指数 (EVI) 作为一种旨在减轻饱和和大气影响的宽波段指数的一般用途，但在推导中不要引用任何特定的 EVI 公式。\n\n你最终报告的答案必须是 $S(R_{NIR}, R_{Red})$ 的单一、闭式解析表达式。无需四舍五入。将结果表示为无量纲量（无单位）。",
            "solution": "该问题陈述经证实具有科学依据、提法恰当且客观。它提出了一个对广泛使用的遥感指数——归一化植被指数 (NDVI) 进行灵敏度分析的标准练习。所有必要的条件和定义要么已提供，要么可以从该领域的标准术语中明确推断。该问题可通过直接应用多元微积分来解决。\n\n该问题要求推导归一化植被指数 (NDVI) 对其输入反射率的相对灵敏度比。第一步是根据应用于近红外 ($R_{NIR}$) 和红光 ($R_{Red}$) 反射率的“归一化差异构造”来陈述 NDVI 的正式定义。该构造由下式给出：\n$$ \\mathrm{NDVI} = \\frac{R_{NIR} - R_{Red}}{R_{NIR} + R_{Red}} $$\n问题陈述中指出 $R_{NIR} \\in (0,1)$ 和 $R_{Red} \\in (0,1)$，并且 $R_{NIR} + R_{Red} \\neq 0$。鉴于反射率的定义域，后一个条件总是满足的。\n\n分析的核心在于求出 NDVI 函数关于 $R_{NIR}$ 和 $R_{Red}$ 的偏导数。我们应用微分的商法则，该法则指出对于函数 $f(x) = \\frac{u(x)}{v(x)}$，其导数为 $f'(x) = \\frac{u'(x)v(x) - u(x)v'(x)}{[v(x)]^2}$。\n\n首先，我们计算关于 $R_{NIR}$ 的偏导数。令 $u = R_{NIR} - R_{Red}$ 和 $v = R_{NIR} + R_{Red}$。\n$u$ 和 $v$ 关于 $R_{NIR}$ 的偏导数是：\n$$ \\frac{\\partial u}{\\partial R_{NIR}} = 1 $$\n$$ \\frac{\\partial v}{\\partial R_{NIR}} = 1 $$\n应用商法则：\n$$ \\frac{\\partial \\mathrm{NDVI}}{\\partial R_{NIR}} = \\frac{\\left(\\frac{\\partial u}{\\partial R_{NIR}}\\right)v - u\\left(\\frac{\\partial v}{\\partial R_{NIR}}\\right)}{v^2} = \\frac{(1)(R_{NIR} + R_{Red}) - (R_{NIR} - R_{Red})(1)}{(R_{NIR} + R_{Red})^2} $$\n$$ \\frac{\\partial \\mathrm{NDVI}}{\\partial R_{NIR}} = \\frac{R_{NIR} + R_{Red} - R_{NIR} + R_{Red}}{(R_{NIR} + R_{Red})^2} = \\frac{2 R_{Red}}{(R_{NIR} + R_{Red})^2} $$\n\n接下来，我们计算关于 $R_{Red}$ 的偏导数。函数 $u$ 和 $v$ 相同。\n$u$ 和 $v$ 关于 $R_{Red}$ 的偏导数是：\n$$ \\frac{\\partial u}{\\partial R_{Red}} = -1 $$\n$$ \\frac{\\partial v}{\\partial R_{Red}} = 1 $$\n应用商法则：\n$$ \\frac{\\partial \\mathrm{NDVI}}{\\partial R_{Red}} = \\frac{\\left(\\frac{\\partial u}{\\partial R_{Red}}\\right)v - u\\left(\\frac{\\partial v}{\\partial R_{Red}}\\right)}{v^2} = \\frac{(-1)(R_{NIR} + R_{Red}) - (R_{NIR} - R_{Red})(1)}{(R_{NIR} + R_{Red})^2} $$\n$$ \\frac{\\partial \\mathrm{NDVI}}{\\partial R_{Red}} = \\frac{-R_{NIR} - R_{Red} - R_{NIR} + R_{Red}}{(R_{NIR} + R_{Red})^2} = \\frac{-2 R_{NIR}}{(R_{NIR} + R_{Red})^2} $$\n\n问题将相对灵敏度比 $S(R_{NIR}, R_{Red})$ 定义为：\n$$ S(R_{NIR}, R_{Red}) = \\frac{\\left|\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{NIR}}\\right|}{\\left|\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{Red}}\\right|} $$\n我们将推导出的偏导数代入此定义：\n$$ S = \\frac{\\left| \\frac{2 R_{Red}}{(R_{NIR} + R_{Red})^2} \\right|}{\\left| \\frac{-2 R_{NIR}}{(R_{NIR} + R_{Red})^2} \\right|} $$\n鉴于 $R_{NIR} \\in (0,1)$ 和 $R_{Red} \\in (0,1)$， $R_{NIR}$ 和 $R_{Red}$ 都是严格为正的。分母 $(R_{NIR} + R_{Red})^2$ 也严格为正。因此，我们可以去掉绝对值符号：\n$$ S = \\frac{\\frac{2 R_{Red}}{(R_{NIR} + R_{Red})^2}}{\\frac{2 R_{NIR}}{(R_{NIR} + R_{Red})^2}} $$\n分子和分母中的公因子 $\\frac{2}{(R_{NIR} + R_{Red})^2}$ 可以消去，得到 $S$ 的最终闭式表达式：\n$$ S = \\frac{R_{Red}}{R_{NIR}} $$\n\n对于定性解释，比率 $S$ 直接比较了 NDVI 对 $R_{NIR}$ 和 $R_{Red}$ 中扰动的灵敏度大小。\n1. 在高植被密度区域，红光波段的叶绿素吸收率高，而近红外波段的散射率高，导致 $R_{NIR} \\gg R_{Red}$。在这种情况下，灵敏度比 $S = \\frac{R_{Red}}{R_{NIR}} \\ll 1$。这意味着 $|\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{NIR}}| \\ll |\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{Red}}|$。NDVI 对近红外波段的变化（或噪声）的敏感度远低于对红光波段同等变化的敏感度。这一数学结果支撑了众所周知 的NDVI 在高生物量区域的“饱和”效应，即指数对植被密度的进一步增加变得不敏感，因为这些增加主要影响 $R_{NIR}$。\n2. 在低植被覆盖区域，如裸土，红光和近红外波段的反射率通常大小相近，即 $R_{NIR} \\approx R_{Red}$。此时，$S \\approx 1$，意味着 NDVI 对两个波段中的扰动大致同样敏感。\n3. 对于某些地表，如水体，近红外反射率通常非常低，常低于红光反射率，因此 $R_{NIR}  R_{Red}$。在这种情况下，$S  1$，表明 NDVI 对近红外波段的扰动更敏感。\n\n观察到 NDVI 在高生物量时（情况1）对近红外通道失去敏感性，这是发展其他指数如增强型植被指数 (EVI) 的主要动机之一。EVI 的公式旨在通过调整近红外反射率的贡献来减轻饱和效应，从而在更广泛的生物量条件下保持敏感性。我们对 $S$ 的推导为这种对归一化差异构造的响应性变化的担忧提供了正式的理由。",
            "answer": "$$\n\\boxed{\\frac{R_{Red}}{R_{NIR}}}\n$$"
        },
        {
            "introduction": "卫星像素很少只捕捉单一、纯净的地表类型，它们通常包含植被和土壤等多种元素的混合。本练习使用线性混合模型来模拟这一常见情景，探讨像素的NDVI值如何随着绿色植被覆盖度($f$)的变化而改变。这一实践对于理解植被覆盖度与NDVI值之间的非线性关系至关重要，而这正是利用遥感数据估算生物量时面临的一大挑战。",
            "id": "3799724",
            "problem": "考虑一个亚像元线性混合模型，该模型由水平均质的绿叶冠层和裸土组成。在相同的光照和观测几何条件下进行观测，使得大气路径辐射和邻近效应可以忽略不计。设宽波段红光通道的双向表面反射率为 $R^{R}$，宽波段近红外通道的为 $R^{N}$。在面积加权混合假设下，每个波段的混合像元反射率由土壤-叶片混合模型给出：$R_{\\text{mix}} = f\\,R_{\\text{leaf}} + (1 - f)\\,R_{\\text{soil}}$，其中 $f \\in [0,1]$ 是绿色植被覆盖度。\n\n现为您提供为两个端元测量的物理上合理的反射率值：\n- 叶片（冠层）：$R_{\\text{leaf}}^{R} = 0.06$, $R_{\\text{leaf}}^{N} = 0.52$。\n- 土壤（裸土）：$R_{\\text{soil}}^{R} = 0.25$, $R_{\\text{soil}}^{N} = 0.36$。\n\n仅使用由宽波段近红外和红光反射率构建的归一化差异的第一性原理定义，推导混合像元的归一化植被指数 (NDVI) 作为 $f$ 的函数的解析表达式。定义土壤主导阈值 $f^{\\ast}$ 为这样一个 $f$ 值，在该值下，混合像元的 NDVI 值与纯土壤 NDVI 值和纯叶片 NDVI 值的距离相等（在 NDVI 空间中）。求解 $f^{\\ast}$ 的符号表达式（用给定的反射率表示），然后根据上述数值计算其具体值。将最终数值答案四舍五入至四位有效数字。将最终答案表示为无量纲分数 $f^{\\ast}$。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、适定、客观和完整的。获得唯一解所需的所有条件和数据均已提供，并且它们符合光学遥感中的既定原则。\n\n该问题要求推导叶片和土壤组分线性混合的归一化植被指数 (NDVI) 的表达式，然后求出特定的植被覆盖度 $f^{\\ast}$。\n\n首先，我们建立定义和控制方程。归一化植被指数 (NDVI) 根据近红外 ($R^N$) 和红光 ($R^R$) 反射率定义如下：\n$$\n\\text{NDVI} = \\frac{R^N - R^R}{R^N + R^R}\n$$\n\n问题陈述指出，混合像元的反射率 $R_{\\text{mix}}$ 是叶片 ($R_{\\text{leaf}}$) 和土壤 ($R_{\\text{soil}}$) 端元反射率的线性组合，由绿色植被覆盖度 $f \\in [0,1]$ 加权。这独立地应用于每个光谱波段：\n$$\nR_{\\text{mix}}^{N}(f) = f\\,R_{\\text{leaf}}^{N} + (1 - f)\\,R_{\\text{soil}}^{N}\n$$\n$$\nR_{\\text{mix}}^{R}(f) = f\\,R_{\\text{leaf}}^{R} + (1 - f)\\,R_{\\text{soil}}^{R}\n$$\n\n为了求出混合像元的 NDVI，即 $\\text{NDVI}_{\\text{mix}}(f)$，我们将这些表达式代入 NDVI 定义中：\n$$\n\\text{NDVI}_{\\text{mix}}(f) = \\frac{[f\\,R_{\\text{leaf}}^{N} + (1 - f)\\,R_{\\text{soil}}^{N}] - [f\\,R_{\\text{leaf}}^{R} + (1 - f)\\,R_{\\text{soil}}^{R}]}{[f\\,R_{\\text{leaf}}^{N} + (1 - f)\\,R_{\\text{soil}}^{N}] + [f\\,R_{\\text{leaf}}^{R} + (1 - f)\\,R_{\\text{soil}}^{R}]}\n$$\n我们可以通过将含有 $f$ 的项分组来重排分子和分母：\n分子：\n$$\nf(R_{\\text{leaf}}^{N} - R_{\\text{leaf}}^{R}) + (1 - f)(R_{\\text{soil}}^{N} - R_{\\text{soil}}^{R}) = f(R_{\\text{leaf}}^{N} - R_{\\text{leaf}}^{R} - R_{\\text{soil}}^{N} + R_{\\text{soil}}^{R}) + (R_{\\text{soil}}^{N} - R_{\\text{soil}}^{R})\n$$\n分母：\n$$\nf(R_{\\text{leaf}}^{N} + R_{\\text{leaf}}^{R}) + (1 - f)(R_{\\text{soil}}^{N} + R_{\\text{soil}}^{R}) = f(R_{\\text{leaf}}^{N} + R_{\\text{leaf}}^{R} - R_{\\text{soil}}^{N} - R_{\\text{soil}}^{R}) + (R_{\\text{soil}}^{N} + R_{\\text{soil}}^{R})\n$$\n让我们为每个端元定义反射率的和 ($\\Sigma R$) 与差 ($\\Delta R$)：\n$$\n\\Delta R_{\\text{leaf}} = R_{\\text{leaf}}^{N} - R_{\\text{leaf}}^{R} \\quad ; \\quad \\Sigma R_{\\text{leaf}} = R_{\\text{leaf}}^{N} + R_{\\text{leaf}}^{R}\n$$\n$$\n\\Delta R_{\\text{soil}} = R_{\\text{soil}}^{N} - R_{\\text{soil}}^{R} \\quad ; \\quad \\Sigma R_{\\text{soil}} = R_{\\text{soil}}^{N} + R_{\\text{soil}}^{R}\n$$\n有了这些定义，$\\text{NDVI}_{\\text{mix}}(f)$ 的表达式变为：\n$$\n\\text{NDVI}_{\\text{mix}}(f) = \\frac{f(\\Delta R_{\\text{leaf}}) + (1-f)(\\Delta R_{\\text{soil}})}{f(\\Sigma R_{\\text{leaf}}) + (1-f)(\\Sigma R_{\\text{soil}})} = \\frac{f(\\Delta R_{\\text{leaf}} - \\Delta R_{\\text{soil}}) + \\Delta R_{\\text{soil}}}{f(\\Sigma R_{\\text{leaf}} - \\Sigma R_{\\text{soil}}) + \\Sigma R_{\\text{soil}}}\n$$\n这就是所要求的混合像元 NDVI 作为 $f$ 的函数的解析表达式。\n\n接下来，我们必须找到土壤主导阈值 $f^{\\ast}$。它被定义为这样一个 $f$ 值，在该值下，$\\text{NDVI}_{\\text{mix}}(f)$ 与纯土壤 NDVI 和纯叶片 NDVI 等距。这意味着 $\\text{NDVI}_{\\text{mix}}(f^{\\ast})$ 是端元 NDVI 的算术平均值。端元的 NDVI 分别为：\n$$\n\\text{NDVI}_{\\text{leaf}} = \\frac{\\Delta R_{\\text{leaf}}}{\\Sigma R_{\\text{leaf}}} \\quad ; \\quad \\text{NDVI}_{\\text{soil}} = \\frac{\\Delta R_{\\text{soil}}}{\\Sigma R_{\\text{soil}}}\n$$\n$f^{\\ast}$ 满足的条件是：\n$$\n\\text{NDVI}_{\\text{mix}}(f^{\\ast}) = \\frac{\\text{NDVI}_{\\text{leaf}} + \\text{NDVI}_{\\text{soil}}}{2}\n$$\n代入 $\\text{NDVI}_{\\text{mix}}(f)$ 的表达式得到：\n$$\n\\frac{f^{\\ast}(\\Delta R_{\\text{leaf}} - \\Delta R_{\\text{soil}}) + \\Delta R_{\\text{soil}}}{f^{\\ast}(\\Sigma R_{\\text{leaf}} - \\Sigma R_{\\text{soil}}) + \\Sigma R_{\\text{soil}}} = \\frac{1}{2} \\left( \\frac{\\Delta R_{\\text{leaf}}}{\\Sigma R_{\\text{leaf}}} + \\frac{\\Delta R_{\\text{soil}}}{\\Sigma R_{\\text{soil}}} \\right)\n$$\n这是一个关于 $f^{\\ast}$ 的线性方程。我们来求解 $f^{\\ast}$。为清晰起见，我们可以将方程写成 $\\frac{A f^{\\ast} + B}{C f^{\\ast} + D} = K$ 的形式，其中：\n$A = \\Delta R_{\\text{leaf}} - \\Delta R_{\\text{soil}}$\n$B = \\Delta R_{\\text{soil}}$\n$C = \\Sigma R_{\\text{leaf}} - \\Sigma R_{\\text{soil}}$\n$D = \\Sigma R_{\\text{soil}}$\n$K = \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}} + \\text{NDVI}_{\\text{soil}})$\n\n求解 $f^{\\ast}$：\n$$\nA f^{\\ast} + B = K (C f^{\\ast} + D)\n$$\n$$\nf^{\\ast}(A - KC) = KD - B\n$$\n$$\nf^{\\ast} = \\frac{KD - B}{A - KC}\n$$\n现在我们将表达式代回。\n分子：\n$$\nKD - B = \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}} + \\text{NDVI}_{\\text{soil}})\\Sigma R_{\\text{soil}} - \\Delta R_{\\text{soil}}\n$$\n使用 $\\Delta R_{\\text{soil}} = \\text{NDVI}_{\\text{soil}} \\Sigma R_{\\text{soil}}$：\n$$\nKD - B = \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{soil}} + \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}}) - \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}} = \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{soil}} - \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}})\n$$\n$$\nKD - B = \\frac{1}{2}\\Sigma R_{\\text{soil}}(\\text{NDVI}_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}})\n$$\n分母：\n$$\nA - KC = (\\Delta R_{\\text{leaf}} - \\Delta R_{\\text{soil}}) - \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}} + \\text{NDVI}_{\\text{soil}})(\\Sigma R_{\\text{leaf}} - \\Sigma R_{\\text{soil}})\n$$\n使用 $\\Delta R = \\text{NDVI} \\cdot \\Sigma R$：\n$$\nA - KC = (\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}}) - \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{leaf}} - \\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{soil}} + \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}})\n$$\n$$\nA - KC = \\frac{1}{2}\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{leaf}} + \\frac{1}{2}\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{soil}} - \\frac{1}{2}\\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{leaf}} - \\frac{1}{2}\\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}}\n$$\n$$\nA - KC = \\frac{1}{2}[\\text{NDVI}_{\\text{leaf}}(\\Sigma R_{\\text{leaf}} + \\Sigma R_{\\text{soil}}) - \\text{NDVI}_{\\text{soil}}(\\Sigma R_{\\text{leaf}} + \\Sigma R_{\\text{soil}})]\n$$\n$$\nA - KC = \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}})(\\Sigma R_{\\text{leaf}} + \\Sigma R_{\\text{soil}})\n$$\n将简化后的分子和分母代回 $f^{\\ast}$ 的表达式中：\n$$\nf^{\\ast} = \\frac{\\frac{1}{2}\\Sigma R_{\\text{soil}}(\\text{NDVI}_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}})}{\\frac{1}{2}(\\text{NDVI}_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}})(\\Sigma R_{\\text{leaf}} + \\Sigma R_{\\text{soil}})}\n$$\n假设 $\\text{NDVI}_{\\text{leaf}} \\neq \\text{NDVI}_{\\text{soil}}$ （对于给定的数据这是成立的），我们可以消去公因项：\n$$\nf^{\\ast} = \\frac{\\Sigma R_{\\text{soil}}}{\\Sigma R_{\\text{leaf}} + \\Sigma R_{\\text{soil}}}\n$$\n这就是 $f^{\\ast}$ 的符号解。用原始反射率表示为：\n$$\nf^{\\ast} = \\frac{R_{\\text{soil}}^{N} + R_{\\text{soil}}^{R}}{(R_{\\text{leaf}}^{N} + R_{\\text{leaf}}^{R}) + (R_{\\text{soil}}^{N} + R_{\\text{soil}}^{R})}\n$$\n现在，我们使用提供的数据计算其数值：\n- 叶片：$R_{\\text{leaf}}^{R} = 0.06$, $R_{\\text{leaf}}^{N} = 0.52$。\n- 土壤：$R_{\\text{soil}}^{R} = 0.25$, $R_{\\text{soil}}^{N} = 0.36$。\n\n首先，计算每个端元的反射率之和：\n$$\n\\Sigma R_{\\text{leaf}} = R_{\\text{leaf}}^{N} + R_{\\text{leaf}}^{R} = 0.52 + 0.06 = 0.58\n$$\n$$\n\\Sigma R_{\\text{soil}} = R_{\\text{soil}}^{N} + R_{\\text{soil}}^{R} = 0.36 + 0.25 = 0.61\n$$\n将这些值代入 $f^{\\ast}$ 的表达式中：\n$$\nf^{\\ast} = \\frac{0.61}{0.58 + 0.61} = \\frac{0.61}{1.19}\n$$\n计算数值：\n$$\nf^{\\ast} \\approx 0.512605042...\n$$\n按要求四舍五入到四位有效数字：\n$$\nf^{\\ast} \\approx 0.5126\n$$",
            "answer": "$$\\boxed{0.5126}$$"
        },
        {
            "introduction": "理论的理解通过模拟才得以生动体现。这个动手编程练习要求您建立一个模拟卫星测量的模型，该模型同时包含了亚像素混合和大气效应。通过在稀疏植被覆盖明亮土壤等挑战性条件下，实施并比较归一化植被指数(NDVI)和增强型植被指数(EVI)，您将获得关于为何要开发EVI以及它如何缓解NDVI一些关键局限性的实践性见解。",
            "id": "3799731",
            "problem": "您需要开发一个完整的程序，模拟并比较两种宽波段植被指数在明亮土壤上的稀疏植被冠层下的行为。该比较必须基于反射率混合和大气辐射传输的基本原理，并最终在低植被覆盖度条件下进行定量敏感性分析。您的程序必须产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n\n基本依据和假设：\n\n- 令 $r_{\\lambda}$ 表示波段 $\\lambda$ 的地表（冠层顶）反射率，令 $R_{\\lambda}$ 表示传感器测量的波段 $\\lambda$ 的表观反射率。反射率是 $[0,1]$ 范围内的无量纲分数。\n- 在稀疏冠层条件下，且冠层内多次散射可忽略不计时，冠层顶反射率可近似为叶片和土壤的线性光谱混合：\n$$\nr_{\\lambda}(f) = f \\, r_{\\lambda}^{\\text{leaf}} + (1-f) \\, r_{\\lambda}^{\\text{soil}},\n$$\n其中 $f \\in [0,1]$ 是植被覆盖度分数，$r_{\\lambda}^{\\text{leaf}}$ 是叶片反射率，$r_{\\lambda}^{\\text{soil}}$ 是土壤反射率，均为无量纲值。\n- 将大气建模为与波段相关的乘性透射率和加性路径反射率：\n$$\nR_{\\lambda}(f) = t_{\\lambda} \\, r_{\\lambda}(f) + a_{\\lambda},\n$$\n其中 $t_{\\lambda} \\in (0,1]$ 是双程大气透射率，$a_{\\lambda} \\in [0,1)$ 是路径反射率。\n\n需要推导和实现的指数：\n\n- 归一化植被指数 (NDVI) 是一种结合了红光和近红外波段的宽波段植被指数。根据红光和近红外波段之间的亮度归一化和对比度增强的目标，推导出以 $R_{\\text{nir}}$ 和 $R_{\\text{red}}$ 表示的 NDVI 表达式，并在您的程序中实现它。\n- 增强型植被指数 (EVI) 是一种结合了红光、近红外和蓝光波段的宽波段植被指数，旨在减少大气和背景的影响。根据利用蓝光波段实现抗气溶胶性和土壤/背景调节的目标，推导出以 $R_{\\text{nir}}$、$R_{\\text{red}}$ 和 $R_{\\text{blue}}$ 表示的 EVI 表达式，并在您的程序中实现它。在您推导的表达式中，采用广泛使用的校准常数 $G = 2.5$、$C_1 = 6$、$C_2 = 7.5$ 和 $L = 1$。\n\n敏感性分析：\n\n- 对于每个测试案例，在两个较低的覆盖度分数 $f_1$ 和 $f_2$（其中 $f_1  f_2$ 且两者都接近 $0$）下评估这些指数，并通过有限差分商定义指数 $I$ 对 $f$ 的局部敏感度\n$$\nS_I = \\frac{I(f_2) - I(f_1)}{f_2 - f_1}.\n$$\n- 对于每个测试案例，计算比率\n$$\n\\mathcal{R} = \\frac{S_{\\text{EVI}}}{S_{\\text{NDVI}}},\n$$\n以小数值表示。该比率为无量纲。将每个比率精确到小数点后 $6$ 位。\n\n测试套件：\n\n使用以下科学上一致的参数集，每个参数集代表不同大气条件下明亮土壤上的稀疏冠层。所有反射率均为无量纲分数。对于每种情况，计算如上定义的 $\\mathcal{R}$。\n\n- 案例 A（中等气溶胶，明亮土壤）：\n    - $f_1 = 0.0$, $f_2 = 0.05$\n    - 叶片反射率：$r_{\\text{red}}^{\\text{leaf}} = 0.04$, $r_{\\text{nir}}^{\\text{leaf}} = 0.55$, $r_{\\text{blue}}^{\\text{leaf}} = 0.05$\n    - 土壤反射率：$r_{\\text{red}}^{\\text{soil}} = 0.30$, $r_{\\text{nir}}^{\\text{soil}} = 0.50$, $r_{\\text{blue}}^{\\text{soil}} = 0.25$\n    - 大气：$t_{\\text{red}} = 0.90$, $t_{\\text{nir}} = 0.95$, $t_{\\text{blue}} = 0.85$, $a_{\\text{red}} = 0.02$, $a_{\\text{nir}} = 0.005$, $a_{\\text{blue}} = 0.03$\n- 案例 B（较强气溶胶，非常明亮的土壤）：\n    - $f_1 = 0.0$, $f_2 = 0.10$\n    - 叶片反射率：$r_{\\text{red}}^{\\text{leaf}} = 0.03$, $r_{\\text{nir}}^{\\text{leaf}} = 0.58$, $r_{\\text{blue}}^{\\text{leaf}} = 0.04$\n    - 土壤反射率：$r_{\\text{red}}^{\\text{soil}} = 0.40$, $r_{\\text{nir}}^{\\text{soil}} = 0.60$, $r_{\\text{blue}}^{\\text{soil}} = 0.35$\n    - 大气：$t_{\\text{red}} = 0.88$, $t_{\\text{nir}} = 0.94$, $t_{\\text{blue}} = 0.80$, $a_{\\text{red}} = 0.04$, $a_{\\text{nir}} = 0.008$, $a_{\\text{blue}} = 0.06$\n- 案例 C（晴朗大气边界）：\n    - $f_1 = 0.0$, $f_2 = 0.05$\n    - 叶片反射率：$r_{\\text{red}}^{\\text{leaf}} = 0.02$, $r_{\\text{nir}}^{\\text{leaf}} = 0.60$, $r_{\\text{blue}}^{\\text{leaf}} = 0.03$\n    - 土壤反射率：$r_{\\text{red}}^{\\text{soil}} = 0.35$, $r_{\\text{nir}}^{\\text{soil}} = 0.55$, $r_{\\text{blue}}^{\\text{soil}} = 0.30$\n    - 大气：$t_{\\text{red}} = 1.0$, $t_{\\text{nir}} = 1.0$, $t_{\\text{blue}} = 1.0$, $a_{\\text{red}} = 0.0$, $a_{\\text{nir}} = 0.0$, $a_{\\text{blue}} = 0.0$\n- 案例 D（较低的叶片-土壤对比度，中等气溶胶）：\n    - $f_1 = 0.0$, $f_2 = 0.05$\n    - 叶片反射率：$r_{\\text{red}}^{\\text{leaf}} = 0.06$, $r_{\\text{nir}}^{\\text{leaf}} = 0.45$, $r_{\\text{blue}}^{\\text{leaf}} = 0.07$\n    - 土壤反射率：$r_{\\text{red}}^{\\text{soil}} = 0.25$, $r_{\\text{nir}}^{\\text{soil}} = 0.40$, $r_{\\text{blue}}^{\\text{soil}} = 0.20$\n    - 大气：$t_{\\text{red}} = 0.92$, $t_{\\text{nir}} = 0.96$, $t_{\\text{blue}} = 0.86$, $a_{\\text{red}} = 0.02$, $a_{\\text{nir}} = 0.004$, $a_{\\text{blue}} = 0.025$\n- 案例 E（极明亮的土壤，强气溶胶；极小的 $f$ 增量边界）：\n    - $f_1 = 0.0$, $f_2 = 0.01$\n    - 叶片反射率：$r_{\\text{red}}^{\\text{leaf}} = 0.04$, $r_{\\text{nir}}^{\\text{leaf}} = 0.55$, $r_{\\text{blue}}^{\\text{leaf}} = 0.05$\n    - 土壤反射率：$r_{\\text{red}}^{\\text{soil}} = 0.45$, $r_{\\text{nir}}^{\\text{soil}} = 0.65$, $r_{\\text{blue}}^{\\text{soil}} = 0.45$\n    - 大气：$t_{\\text{red}} = 0.85$, $t_{\\text{nir}} = 0.93$, $t_{\\text{blue}} = 0.78$, $a_{\\text{red}} = 0.05$, $a_{\\text{nir}} = 0.01$, $a_{\\text{blue}} = 0.07$\n\n实现和输出要求：\n\n- 对于每个测试案例以及 $f_1$ 和 $f_2$ 两种情况，使用指定的物理模型计算 $R_{\\text{red}}(f)$、$R_{\\text{nir}}(f)$ 和 $R_{\\text{blue}}(f)$。\n- 在 $f_1$ 和 $f_2$ 处评估推导出的归一化植被指数 (NDVI) 和增强型植被指数 (EVI)。\n- 为每个案例计算 $S_{\\text{NDVI}}$、$S_{\\text{EVI}}$ 及其比率 $\\mathcal{R}$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，按案例 A 到 E 的顺序排列，每个比率精确到小数点后 $6$ 位，例如 $\\left[0.123456,0.234567,0.345678\\right]$。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于光学遥感的原理，其参数集完整且一致，问题提出得当，表述客观。所提供的光谱混合和大气效应模型是环境科学中使用的标准（尽管是简化的）近似方法。植被指数的定义和敏感性分析在数学上是明确的。因此，可以构建一个合理的解决方案。\n\n解决方案首先将植被指数的数学模型形式化，然后在一个计算框架内应用这些模型来分析指定的测试案例。\n\n### 1. 植被指数的推导和公式化\n\n该问题要求实现两种标准的宽波段植被指数，NDVI 和 EVI。它们的公式基于传感器测量的、与光谱相关的表观反射率 $R_{\\lambda}$。\n\n**归一化植被指数 (NDVI):**\nNDVI 旨在通过利用健康、具有光合作用活性的植被的特征光谱信号来增强植被与其他地表类型之间的对比度：光谱红光部分的低反射率（由于叶绿素吸收）和近红外（NIR）部分的高反射率（由于叶片内部散射）。归一化差异结构有助于减少某些类型的噪声和光照差异。基于亮度归一化和对比度增强的既定目标，使用传感器测量的反射率计算 NDVI 的标准公式为：\n$$\n\\text{NDVI}(R_{\\text{nir}}, R_{\\text{red}}) = \\frac{R_{\\text{nir}} - R_{\\text{red}}}{R_{\\text{nir}} + R_{\\text{red}}}\n$$\n其中 $R_{\\text{nir}}$ 是近红外波段的表观反射率，$R_{\\text{red}}$ 是红光波段的表观反射率。\n\n**增强型植被指数 (EVI):**\nEVI 的开发旨在改进 NDVI，使其对茂密植被的变化更敏感，并减少土壤背景和大气气溶胶的影响。它结合了蓝光波段（$R_{\\text{blue}}$）来校正气溶胶的影响，因为气溶胶散射在较短波长处更为显著。使用提供的系数 $G = 2.5$、$C_1 = 6$、$C_2 = 7.5$ 和土壤调节因子 $L = 1$，标准的 EVI 公式为：\n$$\n\\text{EVI}(R_{\\text{nir}}, R_{\\text{red}}, R_{\\text{blue}}) = G \\cdot \\frac{R_{\\text{nir}} - R_{\\text{red}}}{R_{\\text{nir}} + C_1 \\cdot R_{\\text{red}} - C_2 \\cdot R_{\\text{blue}} + L}\n$$\n\n### 2. 物理模型实现\n\n模拟的核心是针对给定的植被覆盖度分数 ($f$) 计算传感器测量的表观反射率 ($R_{\\lambda}$)。这涉及问题中定义的两个连续建模步骤。\n\n首先，使用线性光谱混合模型计算冠层顶反射率 $r_{\\lambda}(f)$。该模型将地表表示为纯植被和纯土壤反射率的加权平均值：\n$$\nr_{\\lambda}(f) = f \\cdot r_{\\lambda}^{\\text{leaf}} + (1-f) \\cdot r_{\\lambda}^{\\text{soil}}\n$$\n其中 $f$ 是植被覆盖度分数，$r_{\\lambda}^{\\text{leaf}}$ 是纯植被像元的反射率，$r_{\\lambda}^{\\text{soil}}$ 是纯土壤像元在给定光谱波段 $\\lambda \\in \\{\\text{red}, \\text{nir}, \\text{blue}\\}$ 的反射率。\n\n其次，通过对大气效应进行建模来计算传感器测量的表观反射率 $R_{\\lambda}(f)$。该模型考虑了地表反射信号通过透射率 ($t_{\\lambda}$) 发生的衰减，以及散射的大气信号（即路径反射率 $a_{\\lambda}$）的加入：\n$$\nR_{\\lambda}(f) = t_{\\lambda} \\cdot r_{\\lambda}(f) + a_{\\lambda}\n$$\n\n### 3. 敏感性分析\n\n目标是比较 EVI 和 NDVI 对植被覆盖度分数 $f$ 微小变化的局部敏感度，特别是在稀疏冠层（即 $f$ 接近 $0$）的情况下。指数 $I$ 的敏感度 $S_I$ 使用两点 $f_1$ 和 $f_2$ 之间的有限差分商来近似：\n$$\nS_I = \\frac{I(f_2) - I(f_1)}{f_2 - f_1}\n$$\n该量近似于区间 $[f_1, f_2]$ 上的导数 $\\frac{dI}{df}$。\n\n用于比较的最终度量是两个指数敏感度的比率 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{S_{\\text{EVI}}}{S_{\\text{NDVI}}} = \\frac{(\\text{EVI}(f_2) - \\text{EVI}(f_1)) / (f_2 - f_1)}{(\\text{NDVI}(f_2) - \\text{NDVI}(f_1)) / (f_2 - f_1)} = \\frac{\\text{EVI}(f_2) - \\text{EVI}(f_1)}{\\text{NDVI}(f_2) - \\text{NDVI}(f_1)}\n$$\n\n### 4. 计算策略\n\n解决该问题的算法如下：\n\n1.  对于每个测试案例（A 到 E），检索指定的参数：$f_1, f_2$、叶片反射率 ($r_{\\lambda}^{\\text{leaf}}$)、土壤反射率 ($r_{\\lambda}^{\\text{soil}}$) 和大气参数 ($t_{\\lambda}, a_{\\lambda}$)。\n2.  对于两个植被覆盖度分数 $f_1$ 和 $f_2$ 中的每一个：\n    a. 使用线性混合模型计算地表反射率 $r_{\\text{red}}$、$r_{\\text{nir}}$ 和 $r_{\\text{blue}}$。\n    b. 使用大气模型计算传感器测量的表观反射率 $R_{\\text{red}}$、$R_{\\text{nir}}$ 和 $R_{\\text{blue}}$。\n    c. 使用这些表观反射率评估 $\\text{NDVI}(f)$ 和 $\\text{EVI}(f)$。这将产生两对值：$(\\text{NDVI}(f_1), \\text{EVI}(f_1))$ 和 $(\\text{NDVI}(f_2), \\text{EVI}(f_2))$。\n3.  使用计算出的指数值计算敏感度比率 $\\mathcal{R}$。\n4.  将得到的 $\\mathcal{R}$ 四舍五入到小数点后 6 位。\n5.  收集所有测试案例的舍入后比率。\n6.  将收集到的结果格式化为单个用方括号括起来的逗号分隔字符串，以供输出。\n\n此过程将在提供的 Python 环境中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the broadband vegetation index sensitivity problem.\n    \"\"\"\n    \n    # EVI constants\n    G = 2.5\n    C1 = 6.0\n    C2 = 7.5\n    L = 1.0\n\n    # Define the 5 test cases from the problem statement.\n    test_cases = [\n        # Case A (moderate aerosol, bright soil)\n        {\n            \"f_vals\": (0.0, 0.05),\n            \"leaf_refl\": {\"red\": 0.04, \"nir\": 0.55, \"blue\": 0.05},\n            \"soil_refl\": {\"red\": 0.30, \"nir\": 0.50, \"blue\": 0.25},\n            \"atmos\": {\n                \"t\": {\"red\": 0.90, \"nir\": 0.95, \"blue\": 0.85},\n                \"a\": {\"red\": 0.02, \"nir\": 0.005, \"blue\": 0.03},\n            },\n        },\n        # Case B (stronger aerosol, very bright soil)\n        {\n            \"f_vals\": (0.0, 0.10),\n            \"leaf_refl\": {\"red\": 0.03, \"nir\": 0.58, \"blue\": 0.04},\n            \"soil_refl\": {\"red\": 0.40, \"nir\": 0.60, \"blue\": 0.35},\n            \"atmos\": {\n                \"t\": {\"red\": 0.88, \"nir\": 0.94, \"blue\": 0.80},\n                \"a\": {\"red\": 0.04, \"nir\": 0.008, \"blue\": 0.06},\n            },\n        },\n        # Case C (clear atmosphere boundary)\n        {\n            \"f_vals\": (0.0, 0.05),\n            \"leaf_refl\": {\"red\": 0.02, \"nir\": 0.60, \"blue\": 0.03},\n            \"soil_refl\": {\"red\": 0.35, \"nir\": 0.55, \"blue\": 0.30},\n            \"atmos\": {\n                \"t\": {\"red\": 1.0, \"nir\": 1.0, \"blue\": 1.0},\n                \"a\": {\"red\": 0.0, \"nir\": 0.0, \"blue\": 0.0},\n            },\n        },\n        # Case D (lower leaf–soil contrast, moderate aerosol)\n        {\n            \"f_vals\": (0.0, 0.05),\n            \"leaf_refl\": {\"red\": 0.06, \"nir\": 0.45, \"blue\": 0.07},\n            \"soil_refl\": {\"red\": 0.25, \"nir\": 0.40, \"blue\": 0.20},\n            \"atmos\": {\n                \"t\": {\"red\": 0.92, \"nir\": 0.96, \"blue\": 0.86},\n                \"a\": {\"red\": 0.02, \"nir\": 0.004, \"blue\": 0.025},\n            },\n        },\n        # Case E (extremely bright soil, strong aerosol; very small f increment)\n        {\n            \"f_vals\": (0.0, 0.01),\n            \"leaf_refl\": {\"red\": 0.04, \"nir\": 0.55, \"blue\": 0.05},\n            \"soil_refl\": {\"red\": 0.45, \"nir\": 0.65, \"blue\": 0.45},\n            \"atmos\": {\n                \"t\": {\"red\": 0.85, \"nir\": 0.93, \"blue\": 0.78},\n                \"a\": {\"red\": 0.05, \"nir\": 0.01, \"blue\": 0.07},\n            },\n        },\n    ]\n\n    def calculate_indices(f, case_params):\n        \"\"\"\n        Calculates NDVI and EVI for a given fractional cover and parameter set.\n        \"\"\"\n        bands = [\"red\", \"nir\", \"blue\"]\n        r = {}\n        R = {}\n\n        # 1. Calculate surface reflectance (r_lambda) using linear mixture model\n        for band in bands:\n            r[band] = f * case_params[\"leaf_refl\"][band] + \\\n                      (1 - f) * case_params[\"soil_refl\"][band]\n        \n        # 2. Calculate apparent reflectance (R_lambda) using atmospheric model\n        for band in bands:\n            R[band] = case_params[\"atmos\"][\"t\"][band] * r[band] + \\\n                      case_params[\"atmos\"][\"a\"][band]\n\n        # 3. Calculate NDVI\n        ndvi_numerator = R[\"nir\"] - R[\"red\"]\n        ndvi_denominator = R[\"nir\"] + R[\"red\"]\n        # Handle potential division by zero, though unlikely with given data\n        ndvi = ndvi_numerator / ndvi_denominator if ndvi_denominator != 0 else 0.0\n\n        # 4. Calculate EVI\n        evi_numerator = G * (R[\"nir\"] - R[\"red\"])\n        evi_denominator = R[\"nir\"] + C1 * R[\"red\"] - C2 * R[\"blue\"] + L\n        evi = evi_numerator / evi_denominator if evi_denominator != 0 else 0.0\n        \n        return ndvi, evi\n\n    results = []\n    for case in test_cases:\n        f1, f2 = case[\"f_vals\"]\n        \n        # Calculate indices at f1 and f2\n        ndvi1, evi1 = calculate_indices(f1, case)\n        ndvi2, evi2 = calculate_indices(f2, case)\n        \n        # Calculate change in indices\n        delta_ndvi = ndvi2 - ndvi1\n        delta_evi = evi2 - evi1\n        \n        # Calculate sensitivity ratio R\n        # R = (S_EVI) / (S_NDVI) = (delta_evi/delta_f) / (delta_ndvi/delta_f) = delta_evi / delta_ndvi\n        # Check for delta_ndvi being zero to avoid division by zero\n        if delta_ndvi == 0:\n            # This case shouldn't occur for f1 != f2 and valid inputs,\n            # but is good practice to handle.\n            # If NDVI is insensitive but EVI is, the ratio is infinite.\n            # If both are insensitive, the ratio is undefined (we can use 0 or NaN).\n            # Given the problem's nature, a very large number or specific handling would be needed.\n            # We assume it doesn't happen based on the physics of the problem.\n            ratio = np.nan\n        else:\n            ratio = delta_evi / delta_ndvi\n\n        # Round to 6 decimal places as required\n        rounded_ratio = round(ratio, 6)\n        results.append(rounded_ratio)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}