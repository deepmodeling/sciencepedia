{
    "hands_on_practices": [
        {
            "introduction": "这项练习旨在深入探讨归一化植被指数（NDVI）的基本数学特性。通过运用基础的微积分知识，我们可以量化评估NDVI对其输入反射率——即近红外（$R_{\\mathrm{NIR}}$）和红光（$R_{\\mathrm{Red}}$）波段变化的敏感程度。这种敏感性分析不仅是一次理论推演，它还为NDVI最广为人知的局限性之一——在高密度植被区的饱和效应——提供了严谨的解释。",
            "id": "3799746",
            "problem": "考虑一次在植被表面的被动光学遥感反演，其中可测量的量是两个宽波段通道（近红外和红光）的冠层顶双向反射因子。将这些反射率分别记为 $R_{\\mathrm{NIR}} \\in (0,1)$ 和 $R_{\\mathrm{Red}} \\in (0,1)$，并假设 $R_{\\mathrm{NIR}} + R_{\\mathrm{Red}} \\neq 0$。为了降低对两个波段上乘性光照和增益效应的敏感度，构建了一个归一化差异指数。归一化植被指数（NDVI）是根据这种归一化差异构造，用近红外和红光反射率来定义的。\n\n假设每个反射率都受到由测量噪声引起的微小加性扰动 $\\delta R_{\\mathrm{NIR}}$ 和 $\\delta R_{\\mathrm{Red}}$，并假设NDVI关于 $R_{\\mathrm{NIR}}$ 和 $R_{\\mathrm{Red}}$ 的一阶泰勒近似在工作点 $(R_{\\mathrm{NIR}}, R_{\\mathrm{Red}})$ 处是有效的。从归一化差异构造和基础多元微积分出发，推导偏导数 $\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{NIR}}}$ 和 $\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{Red}}}$。然后定义相对灵敏度比\n$$S(R_{\\mathrm{NIR}}, R_{\\mathrm{Red}}) = \\frac{\\left|\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{NIR}}}\\right|}{\\left|\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{Red}}}\\right|}$$\n并将 $S$ 表示为 $R_{\\mathrm{NIR}}$ 和 $R_{\\mathrm{Red}}$ 的闭式函数。\n\n定性解释当 $R_{\\mathrm{NIR}}$ 相对于 $R_{\\mathrm{Red}}$ 较高和较低时，$S$ 在不同区间内如何变化，并讨论这对归一化差异构造在各波段扰动下的响应性的影响。你可以提及增强型植被指数（EVI）作为一种旨在减轻饱和和大气影响的宽波段指数的一般用途，但不要在你的推导中引用任何具体的EVI公式。\n\n你最终报告的答案必须是 $S(R_{\\mathrm{NIR}}, R_{\\mathrm{Red}})$ 的单一闭式解析表达式。无需四舍五入。将结果表示为无量纲量（无单位）。",
            "solution": "该问题陈述经证实具有科学依据、提法明确且客观。它是一个对广泛使用的遥感指数——归一化植被指数（NDVI）进行灵敏度分析的标准练习。所有必要的条件和定义要么已经给出，要么可以从该领域的标准术语中明确推断出来。该问题可通过直接应用多元微积分来解决。\n\n该问题要求推导归一化植被指数（NDVI）相对于其输入反射率的相对灵敏度比。第一步是陈述基于应用于近红外（$R_{\\mathrm{NIR}}$）和红光（$R_{\\mathrm{Red}}$）反射率的“归一化差异构造”的NDVI的正式定义。该构造如下所示：\n$$ \\mathrm{NDVI} = \\frac{R_{\\mathrm{NIR}} - R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}} + R_{\\mathrm{Red}}} $$\n问题陈述指出 $R_{\\mathrm{NIR}} \\in (0,1)$ 和 $R_{\\mathrm{Red}} \\in (0,1)$，且 $R_{\\mathrm{NIR}} + R_{\\mathrm{Red}} \\neq 0$。鉴于反射率的定义域，后一个条件总是满足的。\n\n分析的核心在于求NDVI函数关于 $R_{\\mathrm{NIR}}$ 和 $R_{\\mathrm{Red}}$ 的偏导数。我们应用微分的商法则，该法则规定对于函数 $f(x) = \\frac{u(x)}{v(x)}$，其导数为 $f'(x) = \\frac{u'(x)v(x) - u(x)v'(x)}{[v(x)]^2}$。\n\n首先，我们计算关于 $R_{\\mathrm{NIR}}$ 的偏导数。令 $u = R_{\\mathrm{NIR}} - R_{\\mathrm{Red}}$ 且 $v = R_{\\mathrm{NIR}} + R_{\\mathrm{Red}}$。\n$u$ 和 $v$ 关于 $R_{\\mathrm{NIR}}$ 的偏导数是：\n$$ \\frac{\\partial u}{\\partial R_{\\mathrm{NIR}}} = 1 $$\n$$ \\frac{\\partial v}{\\partial R_{\\mathrm{NIR}}} = 1 $$\n应用商法则：\n$$ \\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{NIR}}} = \\frac{\\left(\\frac{\\partial u}{\\partial R_{\\mathrm{NIR}}}\\right)v - u\\left(\\frac{\\partial v}{\\partial R_{\\mathrm{NIR}}}\\right)}{v^2} = \\frac{(1)(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}}) - (R_{\\mathrm{NIR}} - R_{\\mathrm{Red}})(1)}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2} $$\n$$ \\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{NIR}}} = \\frac{R_{\\mathrm{NIR}} + R_{\\mathrm{Red}} - R_{\\mathrm{NIR}} + R_{\\mathrm{Red}}}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2} = \\frac{2 R_{\\mathrm{Red}}}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2} $$\n\n接下来，我们计算关于 $R_{\\mathrm{Red}}$ 的偏导数。函数 $u$ 和 $v$ 相同。\n$u$ 和 $v$ 关于 $R_{\\mathrm{Red}}$ 的偏导数是：\n$$ \\frac{\\partial u}{\\partial R_{\\mathrm{Red}}} = -1 $$\n$$ \\frac{\\partial v}{\\partial R_{\\mathrm{Red}}} = 1 $$\n应用商法则：\n$$ \\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{Red}}} = \\frac{\\left(\\frac{\\partial u}{\\partial R_{\\mathrm{Red}}}\\right)v - u\\left(\\frac{\\partial v}{\\partial R_{\\mathrm{Red}}}\\right)}{v^2} = \\frac{(-1)(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}}) - (R_{\\mathrm{NIR}} - R_{\\mathrm{Red}})(1)}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2} $$\n$$ \\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{Red}}} = \\frac{-R_{\\mathrm{NIR}} - R_{\\mathrm{Red}} - R_{\\mathrm{NIR}} + R_{\\mathrm{Red}}}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2} = \\frac{-2 R_{\\mathrm{NIR}}}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2} $$\n\n问题将相对灵敏度比 $S(R_{\\mathrm{NIR}}, R_{\\mathrm{Red}})$ 定义为：\n$$ S(R_{\\mathrm{NIR}}, R_{\\mathrm{Red}}) = \\frac{\\left|\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{NIR}}}\\right|}{\\left|\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{Red}}}\\right|} $$\n我们将推导出的偏导数代入此定义：\n$$ S = \\frac{\\left| \\frac{2 R_{\\mathrm{Red}}}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2} \\right|}{\\left| \\frac{-2 R_{\\mathrm{NIR}}}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2} \\right|} $$\n鉴于 $R_{\\mathrm{NIR}} \\in (0,1)$ 且 $R_{\\mathrm{Red}} \\in (0,1)$， $R_{\\mathrm{NIR}}$ 和 $R_{\\mathrm{Red}}$ 都是严格为正的。分母 $(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2$ 也是严格为正的。因此，我们可以去掉绝对值符号：\n$$ S = \\frac{\\frac{2 R_{\\mathrm{Red}}}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2}}{\\frac{2 R_{\\mathrm{NIR}}}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2}} $$\n分子和分母中的公因子 $\\frac{2}{(R_{\\mathrm{NIR}} + R_{\\mathrm{Red}})^2}$ 相消，得到 $S$ 的最终闭式表达式：\n$$ S = \\frac{R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}}} $$\n\n对于定性解释，比率 $S$ 直接比较了NDVI对 $R_{\\mathrm{NIR}}$ 扰动与对 $R_{\\mathrm{Red}}$ 扰动的灵敏度大小。\n1.  在植被密度高的区域，红光波段的叶绿素吸收率高，而近红外波段的散射率高，导致 $R_{\\mathrm{NIR}} \\gg R_{\\mathrm{Red}}$。在这种情况下，灵敏度比 $S = \\frac{R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}}} \\ll 1$。这意味着 $|\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{NIR}}}| \\ll |\\frac{\\partial \\mathrm{NDVI}}{\\partial R_{\\mathrm{Red}}}|$。NDVI对近红外波段的变化（或噪声）的敏感度远低于对红光波段同等变化的敏感度。这一数学结果为高生物量区域NDVI众所周知的“饱和”效应提供了理论基础，即指数对植被密度的进一步增加变得不敏感，因为这些增加主要影响 $R_{\\mathrm{NIR}}$。\n2.  在植被覆盖率低的区域，如裸土，红光和近红外波段的反射率通常大小相近，即 $R_{\\mathrm{NIR}} \\approx R_{\\mathrm{Red}}$。此时，$S \\approx 1$，意味着NDVI对两个波段的扰动大致同样敏感。\n3.  对于某些地表，如水体，近红外反射率通常非常低，常低于红光反射率，因此 $R_{\\mathrm{NIR}}  R_{\\mathrm{Red}}$。在这种情况下，$S > 1$，表明NDVI对近红外波段的扰动更敏感。\n\n在高生物量条件下（情况1），NDVI对近红外通道失去敏感度的观察结果，是开发其他指数（如增强型植被指数EVI）的主要动机。EVI的公式旨在通过调整近红外反射率的贡献来减轻饱和效应，从而在更广泛的生物量条件下保持敏感度。我们对 $S$ 的推导为这种关于归一化差异构造的响应性变化的担忧提供了正式的理论依据。",
            "answer": "$$\n\\boxed{\\frac{R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}}}}\n$$"
        },
        {
            "introduction": "在遥感应用中，单个卫星像元很少只捕捉一种纯净的地表类型，它通常代表了植被和土壤等不同组分的混合体。本练习模拟了这样一个常见情景，将像元视为叶片冠层和裸土的线性混合体，从而使我们能够观察植被覆盖度（$f$）和土壤背景的光谱特性如何影响最终的NDVI值。理解这种关系对于准确解译植被指数，避免因土壤亮度变化而错误评估植被状况至关重要。",
            "id": "3799724",
            "problem": "考虑一个由水平均匀的绿色叶冠和裸土组成的亚像元线性混合体，在相同的光照和观测几何条件下进行观测，使得大气路径辐射和邻近效应可以忽略不计。设宽波段红光通道的双向表面反射率表示为 $R_{\\mathrm{Red}}$，宽波段近红外通道的表示为 $R_{\\mathrm{NIR}}$。在面积加权混合假设下，每个波段的混合反射率由土壤-叶片混合模型给出：$R_{\\text{mix}} = f R_{\\text{leaf}} + (1 - f) R_{\\text{soil}}$，其中 $f \\in [0,1]$ 是绿色植被覆盖度。\n\n现为这两个端元提供了物理上合理的实测反射率：\n- 叶片（冠层）：$R_{\\mathrm{leaf}}^{\\mathrm{Red}} = 0.06$， $R_{\\mathrm{leaf}}^{\\mathrm{NIR}} = 0.52$。\n- 土壤（裸土）：$R_{\\mathrm{soil}}^{\\mathrm{Red}} = 0.25$， $R_{\\mathrm{soil}}^{\\mathrm{NIR}} = 0.36$。\n\n仅使用由宽波段近红外和红光反射率构建的归一化差异的第一性原理定义，推导混合物的归一化植被指数 (NDVI) 作为 $f$ 的函数的解析表达式。将土壤主导阈值 $f^{\\ast}$ 定义为这样一个 $f$ 值，在该值下，混合物的 NDVI 与纯土壤 NDVI 和纯叶片 NDVI 的距离（在 NDVI 空间中）完全相等。符号求解 $f^{\\ast}$（用给定的反射率表示），然后根据上述数值计算其具体值。将最终数值答案四舍五入至四位有效数字。将最终答案表示为无量纲分数 $f^{\\ast}$。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观和完整的。获得唯一解所需的所有条件和数据均已提供，并且它们符合光学遥感的既定原则。\n\n该问题要求推导叶片和土壤组分线性混合物的归一化植被指数 (NDVI) 的表达式，然后找到一个特定的植被覆盖度 $f^{\\ast}$。\n\n首先，我们建立定义和控制方程。归一化植被指数 (NDVI) 根据近红外 ($R_{\\mathrm{NIR}}$) 和红光 ($R_{\\mathrm{Red}}$) 反射率定义为：\n$$\n\\text{NDVI} = \\frac{R_{\\mathrm{NIR}} - R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}} + R_{\\mathrm{Red}}}\n$$\n\n问题指出，混合物的反射率 $R_{\\text{mix}}$ 是叶片 ($R_{\\text{leaf}}$) 和土壤 ($R_{\\text{soil}}$) 端元反射率的线性组合，由绿色植被覆盖度 $f \\in [0,1]$ 加权。这独立地适用于每个光谱波段：\n$$\nR_{\\text{mix}}^{\\mathrm{NIR}}(f) = f R_{\\mathrm{leaf}}^{\\mathrm{NIR}} + (1 - f) R_{\\mathrm{soil}}^{\\mathrm{NIR}}\n$$\n$$\nR_{\\text{mix}}^{\\mathrm{Red}}(f) = f R_{\\mathrm{leaf}}^{\\mathrm{Red}} + (1 - f) R_{\\mathrm{soil}}^{\\mathrm{Red}}\n$$\n\n为了求出混合物的 NDVI，即 $\\text{NDVI}_{\\text{mix}}(f)$，我们将这些表达式代入 NDVI 的定义中：\n$$\n\\text{NDVI}_{\\text{mix}}(f) = \\frac{[f R_{\\mathrm{leaf}}^{\\mathrm{NIR}} + (1 - f) R_{\\mathrm{soil}}^{\\mathrm{NIR}}] - [f R_{\\mathrm{leaf}}^{\\mathrm{Red}} + (1 - f) R_{\\mathrm{soil}}^{\\mathrm{Red}}]}{[f R_{\\mathrm{leaf}}^{\\mathrm{NIR}} + (1 - f) R_{\\mathrm{soil}}^{\\mathrm{NIR}}] + [f R_{\\mathrm{leaf}}^{\\mathrm{Red}} + (1 - f) R_{\\mathrm{soil}}^{\\mathrm{Red}}]}\n$$\n我们可以通过对含 $f$ 的项进行分组来重新整理分子和分母：\n分子：\n$$\nf(R_{\\mathrm{leaf}}^{\\mathrm{NIR}} - R_{\\mathrm{leaf}}^{\\mathrm{Red}}) + (1 - f)(R_{\\mathrm{soil}}^{\\mathrm{NIR}} - R_{\\mathrm{soil}}^{\\mathrm{Red}}) = f(R_{\\mathrm{leaf}}^{\\mathrm{NIR}} - R_{\\mathrm{leaf}}^{\\mathrm{Red}} - R_{\\mathrm{soil}}^{\\mathrm{NIR}} + R_{\\mathrm{soil}}^{\\mathrm{Red}}) + (R_{\\mathrm{soil}}^{\\mathrm{NIR}} - R_{\\mathrm{soil}}^{\\mathrm{Red}})\n$$\n分母：\n$$\nf(R_{\\mathrm{leaf}}^{\\mathrm{NIR}} + R_{\\mathrm{leaf}}^{\\mathrm{Red}}) + (1 - f)(R_{\\mathrm{soil}}^{\\mathrm{NIR}} + R_{\\mathrm{soil}}^{\\mathrm{Red}}) = f(R_{\\mathrm{leaf}}^{\\mathrm{NIR}} + R_{\\mathrm{leaf}}^{\\mathrm{Red}} - R_{\\mathrm{soil}}^{\\mathrm{NIR}} - R_{\\mathrm{soil}}^{\\mathrm{Red}}) + (R_{\\mathrm{soil}}^{\\mathrm{NIR}} + R_{\\mathrm{soil}}^{\\mathrm{Red}})\n$$\n让我们为每个端元定义反射率的和 ($\\Sigma R$) 与差 ($\\Delta R$)：\n$$\n\\Delta R_{\\text{leaf}} = R_{\\mathrm{leaf}}^{\\mathrm{NIR}} - R_{\\mathrm{leaf}}^{\\mathrm{Red}} \\quad ; \\quad \\Sigma R_{\\text{leaf}} = R_{\\mathrm{leaf}}^{\\mathrm{NIR}} + R_{\\mathrm{leaf}}^{\\mathrm{Red}}\n$$\n$$\n\\Delta R_{\\text{soil}} = R_{\\mathrm{soil}}^{\\mathrm{NIR}} - R_{\\mathrm{soil}}^{\\mathrm{Red}} \\quad ; \\quad \\Sigma R_{\\text{soil}} = R_{\\mathrm{soil}}^{\\mathrm{NIR}} + R_{\\mathrm{soil}}^{\\mathrm{Red}}\n$$\n有了这些，$\\text{NDVI}_{\\text{mix}}(f)$ 的表达式变为：\n$$\n\\text{NDVI}_{\\text{mix}}(f) = \\frac{f(\\Delta R_{\\text{leaf}}) + (1-f)(\\Delta R_{\\text{soil}})}{f(\\Sigma R_{\\text{leaf}}) + (1-f)(\\Sigma R_{\\text{soil}})} = \\frac{f(\\Delta R_{\\text{leaf}} - \\Delta R_{\\text{soil}}) + \\Delta R_{\\text{soil}}}{f(\\Sigma R_{\\text{leaf}} - \\Sigma R_{\\text{soil}}) + \\Sigma R_{\\text{soil}}}\n$$\n这就是所要求的混合物 NDVI 作为 $f$ 的函数的解析表达式。\n\n接下来，我们必须找到土壤主导阈值 $f^{\\ast}$。它被定义为这样一个 $f$ 值，使得 $\\text{NDVI}_{\\text{mix}}(f)$ 与纯土壤 NDVI 和纯叶片 NDVI 的距离相等。这意味着 $\\text{NDVI}_{\\text{mix}}(f^{\\ast})$ 是端元 NDVI 的算术平均值。各端元的 NDVI 为：\n$$\n\\text{NDVI}_{\\text{leaf}} = \\frac{\\Delta R_{\\text{leaf}}}{\\Sigma R_{\\text{leaf}}} \\quad ; \\quad \\text{NDVI}_{\\text{soil}} = \\frac{\\Delta R_{\\text{soil}}}{\\Sigma R_{\\text{soil}}}\n$$\n$f^{\\ast}$ 的条件是：\n$$\n\\text{NDVI}_{\\text{mix}}(f^{\\ast}) = \\frac{\\text{NDVI}_{\\text{leaf}} + \\text{NDVI}_{\\text{soil}}}{2}\n$$\n代入 $\\text{NDVI}_{\\text{mix}}(f)$ 的表达式可得：\n$$\n\\frac{f^{\\ast}(\\Delta R_{\\text{leaf}} - \\Delta R_{\\text{soil}}) + \\Delta R_{\\text{soil}}}{f^{\\ast}(\\Sigma R_{\\text{leaf}} - \\Sigma R_{\\text{soil}}) + \\Sigma R_{\\text{soil}}} = \\frac{1}{2} \\left( \\frac{\\Delta R_{\\text{leaf}}}{\\Sigma R_{\\text{leaf}}} + \\frac{\\Delta R_{\\text{soil}}}{\\Sigma R_{\\text{soil}}} \\right)\n$$\n这是一个关于 $f^{\\ast}$ 的线性方程。让我们求解 $f^{\\ast}$。为清晰起见，我们可以将方程写为 $\\frac{A f^{\\ast} + B}{C f^{\\ast} + D} = K$，其中：\n$A = \\Delta R_{\\text{leaf}} - \\Delta R_{\\text{soil}}$\n$B = \\Delta R_{\\text{soil}}$\n$C = \\Sigma R_{\\text{leaf}} - \\Sigma R_{\\text{soil}}$\n$D = \\Sigma R_{\\text{soil}}$\n$K = \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}} + \\text{NDVI}_{\\text{soil}})$\n\n求解 $f^{\\ast}$：\n$$\nA f^{\\ast} + B = K (C f^{\\ast} + D)\n$$\n$$\nf^{\\ast}(A - KC) = KD - B\n$$\n$$\nf^{\\ast} = \\frac{KD - B}{A - KC}\n$$\n现在我们将表达式代回。\n分子：\n$$\nKD - B = \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}} + \\text{NDVI}_{\\text{soil}})\\Sigma R_{\\text{soil}} - \\Delta R_{\\text{soil}}\n$$\n使用 $\\Delta R_{\\text{soil}} = \\text{NDVI}_{\\text{soil}} \\Sigma R_{\\text{soil}}$：\n$$\nKD - B = \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{soil}} + \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}}) - \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}} = \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{soil}} - \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}})\n$$\n$$\nKD - B = \\frac{1}{2}\\Sigma R_{\\text{soil}}(\\text{NDVI}_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}})\n$$\n分母：\n$$\nA - KC = (\\Delta R_{\\text{leaf}} - \\Delta R_{\\text{soil}}) - \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}} + \\text{NDVI}_{\\text{soil}})(\\Sigma R_{\\text{leaf}} - \\Sigma R_{\\text{soil}})\n$$\n使用 $\\Delta R = \\text{NDVI} \\cdot \\Sigma R$：\n$$\nA - KC = (\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}}) - \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{leaf}} - \\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{soil}} + \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}})\n$$\n$$\nA - KC = \\frac{1}{2}\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{leaf}} + \\frac{1}{2}\\text{NDVI}_{\\text{leaf}}\\Sigma R_{\\text{soil}} - \\frac{1}{2}\\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{leaf}} - \\frac{1}{2}\\text{NDVI}_{\\text{soil}}\\Sigma R_{\\text{soil}}\n$$\n$$\nA - KC = \\frac{1}{2}[\\text{NDVI}_{\\text{leaf}}(\\Sigma R_{\\text{leaf}} + \\Sigma R_{\\text{soil}}) - \\text{NDVI}_{\\text{soil}}(\\Sigma R_{\\text{leaf}} + \\Sigma R_{\\text{soil}})]\n$$\n$$\nA - KC = \\frac{1}{2}(\\text{NDVI}_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}})(\\Sigma R_{\\text{leaf}} + \\Sigma R_{\\text{soil}})\n$$\n将简化后的分子和分母代回到 $f^{\\ast}$ 的表达式中：\n$$\nf^{\\ast} = \\frac{\\frac{1}{2}\\Sigma R_{\\text{soil}}(\\text{NDVI}_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}})}{\\frac{1}{2}(\\text{NDVI}_{\\text{leaf}} - \\text{NDVI}_{\\text{soil}})(\\Sigma R_{\\text{leaf}} + \\Sigma R_{\\text{soil}})}\n$$\n假设 $\\text{NDVI}_{\\text{leaf}} \\neq \\text{NDVI}_{\\text{soil}}$（对于给定数据这是成立的），我们可以消去公因式：\n$$\nf^{\\ast} = \\frac{\\Sigma R_{\\text{soil}}}{\\Sigma R_{\\text{leaf}} + \\Sigma R_{\\text{soil}}}\n$$\n这就是 $f^{\\ast}$ 的符号解。用原始反射率表示为：\n$$\nf^{\\ast} = \\frac{R_{\\mathrm{soil}}^{\\mathrm{NIR}} + R_{\\mathrm{soil}}^{\\mathrm{Red}}}{(R_{\\mathrm{leaf}}^{\\mathrm{NIR}} + R_{\\mathrm{leaf}}^{\\mathrm{Red}}) + (R_{\\mathrm{soil}}^{\\mathrm{NIR}} + R_{\\mathrm{soil}}^{\\mathrm{Red}})}\n$$\n现在，我们使用所提供的数据计算其数值：\n- 叶片：$R_{\\mathrm{leaf}}^{\\mathrm{Red}} = 0.06$, $R_{\\mathrm{leaf}}^{\\mathrm{NIR}} = 0.52$。\n- 土壤：$R_{\\mathrm{soil}}^{\\mathrm{Red}} = 0.25$, $R_{\\mathrm{soil}}^{\\mathrm{NIR}} = 0.36$。\n\n首先，计算每个端元的反射率之和：\n$$\n\\Sigma R_{\\text{leaf}} = R_{\\mathrm{leaf}}^{\\mathrm{NIR}} + R_{\\mathrm{leaf}}^{\\mathrm{Red}} = 0.52 + 0.06 = 0.58\n$$\n$$\n\\Sigma R_{\\text{soil}} = R_{\\mathrm{soil}}^{\\mathrm{NIR}} + R_{\\mathrm{soil}}^{\\mathrm{Red}} = 0.36 + 0.25 = 0.61\n$$\n将这些值代入 $f^{\\ast}$ 的表达式中：\n$$\nf^{\\ast} = \\frac{0.61}{0.58 + 0.61} = \\frac{0.61}{1.19}\n$$\n计算数值：\n$$\nf^{\\ast} \\approx 0.512605042...\n$$\n按要求四舍五入到四位有效数字：\n$$\nf^{\\ast} \\approx 0.5126\n$$",
            "answer": "$$\\boxed{0.5126}$$"
        },
        {
            "introduction": "理论知识通过模拟得以展现其实用价值，模拟使我们能够在受控且贴近现实的条件下测试和比较不同指数的性能。本练习将指导您构建一个综合模拟，用以比较NDVI和增强型植被指数（EVI）在稀疏植被覆盖明亮土壤等挑战性情景下的敏感性，同时还将大气效应纳入考量。通过这种量化比较，您将更深刻地理解为何要开发EVI，以及它如何缓解NDVI的一些关键局限性。",
            "id": "3799731",
            "problem": "您需要开发一个完整的程序，模拟和比较两种宽波段植被指数在明亮土壤上的稀疏植被冠层中的行为。该比较必须基于反射率混合和大气辐射传输的基本原理，并最终在低植被分数下进行定量的灵敏度分析。您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n\n基本依据和假设：\n\n- 令 $r_{\\lambda}$ 表示波段 $\\lambda$ 的地表（冠层顶）反射率，令 $R_{\\lambda}$ 表示传感器测量的波段 $\\lambda$ 的表观反射率。反射率是 $[0,1]$ 范围内的无量纲分数。\n- 在稀疏冠层条件下且冠层内多次散射可忽略不计时，使用叶片和土壤的线性光谱混合来近似冠层顶反射率：\n$$\nr_{\\lambda}(f) = f \\, r_{\\lambda}^{\\text{leaf}} + (1-f) \\, r_{\\lambda}^{\\text{soil}},\n$$\n其中 $f \\in [0,1]$ 是植被覆盖度分数，$r_{\\lambda}^{\\text{leaf}}$ 是叶片反射率，$r_{\\lambda}^{\\text{soil}}$ 是土壤反射率，均为无量纲。\n- 将大气建模为与波段相关的乘性透射率和加性路径反射率：\n$$\nR_{\\lambda}(f) = t_{\\lambda} \\, r_{\\lambda}(f) + a_{\\lambda},\n$$\n其中 $t_{\\lambda} \\in (0,1]$ 是双程大气透射率，$a_{\\lambda} \\in [0,1)$ 是路径反射率。\n\n需要推导和实现的指数：\n\n- 归一化植被指数 (NDVI) 是一种结合了红光和近红外波段的宽波段植被指数。根据对红光和近红外波段进行亮度归一化和对比度增强的目标，推导出以 $R_{\\mathrm{NIR}}$ 和 $R_{\\mathrm{Red}}$ 表示的 NDVI 表达式，并在您的程序中实现它。\n- 增强型植被指数 (EVI) 是一种结合了红光、近红外和蓝光波段的宽波段植被指数，旨在减少大气和背景的影响。根据使用蓝光波段进行气溶胶抵抗和土壤/背景调整的目标，推导出以 $R_{\\mathrm{NIR}}$、$R_{\\mathrm{Red}}$ 和 $R_{\\mathrm{Blue}}$ 表示的 EVI 表达式，并在您的程序中实现它。在您推导的表达式中，采用广泛使用的校准常数 $G = 2.5$、$C_1 = 6$、$C_2 = 7.5$ 和 $L = 1$。\n\n灵敏度分析：\n\n- 对于每个测试案例，在两个较低的覆盖度分数 $f_1$ 和 $f_2$（其中 $f_1  f_2$ 且两者都接近于 $0$）下评估这些指数，并通过有限差分商定义指数 $I$ 对 $f$ 的局部灵敏度\n$$\nS_I = \\frac{I(f_2) - I(f_1)}{f_2 - f_1}.\n$$\n- 对于每个测试案例，计算比率\n$$\n\\mathcal{R} = \\frac{S_{\\text{EVI}}}{S_{\\text{NDVI}}},\n$$\n并以十进制数表示。该比率是无量纲的。将每个比率四舍五入到恰好 $6$ 位小数。\n\n测试套件：\n\n使用以下科学上一致的参数集，每个参数集代表不同大气条件下明亮土壤上的稀疏冠层。所有反射率均为无量纲分数。对于每种情况，按上文定义计算 $\\mathcal{R}$。\n\n- 案例 A (中等气溶胶，明亮土壤)：\n    - $f_1 = 0.0$, $f_2 = 0.05$\n    - 叶片反射率：$r_{\\mathrm{Red}}^{\\text{leaf}} = 0.04$, $r_{\\mathrm{NIR}}^{\\text{leaf}} = 0.55$, $r_{\\mathrm{Blue}}^{\\text{leaf}} = 0.05$\n    - 土壤反射率：$r_{\\mathrm{Red}}^{\\text{soil}} = 0.30$, $r_{\\mathrm{NIR}}^{\\text{soil}} = 0.50$, $r_{\\mathrm{Blue}}^{\\text{soil}} = 0.25$\n    - 大气：$t_{\\mathrm{Red}} = 0.90$, $t_{\\mathrm{NIR}} = 0.95$, $t_{\\mathrm{Blue}} = 0.85$, $a_{\\mathrm{Red}} = 0.02$, $a_{\\mathrm{NIR}} = 0.005$, $a_{\\mathrm{Blue}} = 0.03$\n- 案例 B (更强气溶胶，非常明亮的土壤)：\n    - $f_1 = 0.0$, $f_2 = 0.10$\n    - 叶片反射率：$r_{\\mathrm{Red}}^{\\text{leaf}} = 0.03$, $r_{\\mathrm{NIR}}^{\\text{leaf}} = 0.58$, $r_{\\mathrm{Blue}}^{\\text{leaf}} = 0.04$\n    - 土壤反射率：$r_{\\mathrm{Red}}^{\\text{soil}} = 0.40$, $r_{\\mathrm{NIR}}^{\\text{soil}} = 0.60$, $r_{\\mathrm{Blue}}^{\\text{soil}} = 0.35$\n    - 大气：$t_{\\mathrm{Red}} = 0.88$, $t_{\\mathrm{NIR}} = 0.94$, $t_{\\mathrm{Blue}} = 0.80$, $a_{\\mathrm{Red}} = 0.04$, $a_{\\mathrm{NIR}} = 0.008$, $a_{\\mathrm{Blue}} = 0.06$\n- 案例 C (晴空大气边界)：\n    - $f_1 = 0.0$, $f_2 = 0.05$\n    - 叶片反射率：$r_{\\mathrm{Red}}^{\\text{leaf}} = 0.02$, $r_{\\mathrm{NIR}}^{\\text{leaf}} = 0.60$, $r_{\\mathrm{Blue}}^{\\text{leaf}} = 0.03$\n    - 土壤反射率：$r_{\\mathrm{Red}}^{\\text{soil}} = 0.35$, $r_{\\mathrm{NIR}}^{\\text{soil}} = 0.55$, $r_{\\mathrm{Blue}}^{\\text{soil}} = 0.30$\n    - 大气：$t_{\\mathrm{Red}} = 1.0$, $t_{\\mathrm{NIR}} = 1.0$, $t_{\\mathrm{Blue}} = 1.0$, $a_{\\mathrm{Red}} = 0.0$, $a_{\\mathrm{NIR}} = 0.0$, $a_{\\mathrm{Blue}} = 0.0$\n- 案例 D (较低的叶-土对比度，中等气溶胶)：\n    - $f_1 = 0.0$, $f_2 = 0.05$\n    - 叶片反射率：$r_{\\mathrm{Red}}^{\\text{leaf}} = 0.06$, $r_{\\mathrm{NIR}}^{\\text{leaf}} = 0.45$, $r_{\\mathrm{Blue}}^{\\text{leaf}} = 0.07$\n    - 土壤反射率：$r_{\\mathrm{Red}}^{\\text{soil}} = 0.25$, $r_{\\mathrm{NIR}}^{\\text{soil}} = 0.40$, $r_{\\mathrm{Blue}}^{\\text{soil}} = 0.20$\n    - 大气：$t_{\\mathrm{Red}} = 0.92$, $t_{\\mathrm{NIR}} = 0.96$, $t_{\\mathrm{Blue}} = 0.86$, $a_{\\mathrm{Red}} = 0.02$, $a_{\\mathrm{NIR}} = 0.004$, $a_{\\mathrm{Blue}} = 0.025$\n- 案例 E (极明亮的土壤，强气溶胶；非常小的 $f$ 增量边界)：\n    - $f_1 = 0.0$, $f_2 = 0.01$\n    - 叶片反射率：$r_{\\mathrm{Red}}^{\\text{leaf}} = 0.04$, $r_{\\mathrm{NIR}}^{\\text{leaf}} = 0.55$, $r_{\\mathrm{Blue}}^{\\text{leaf}} = 0.05$\n    - 土壤反射率：$r_{\\mathrm{Red}}^{\\text{soil}} = 0.45$, $r_{\\mathrm{NIR}}^{\\text{soil}} = 0.65$, $r_{\\mathrm{Blue}}^{\\text{soil}} = 0.45$\n    - 大气：$t_{\\mathrm{Red}} = 0.85$, $t_{\\mathrm{NIR}} = 0.93$, $t_{\\mathrm{Blue}} = 0.78$, $a_{\\mathrm{Red}} = 0.05$, $a_{\\mathrm{NIR}} = 0.01$, $a_{\\mathrm{Blue}} = 0.07$\n\n实现和输出要求：\n\n- 对于每个测试案例以及 $f_1$ 和 $f_2$ 两个值，使用指定的物理模型计算 $R_{\\mathrm{Red}}(f)$、$R_{\\mathrm{NIR}}(f)$ 和 $R_{\\mathrm{Blue}}(f)$。\n- 在 $f_1$ 和 $f_2$ 处评估推导出的归一化植被指数 (NDVI) 和增强型植被指数 (EVI)。\n- 为每种情况计算 $S_{\\text{NDVI}}$、$S_{\\text{EVI}}$ 及其比率 $\\mathcal{R}$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，按案例 A 到 E 的顺序排列，每个比率四舍五入到恰好 $6$ 位小数，例如 $\\left[0.123456,0.234567,0.345678\\right]$。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于光学遥感的原理，问题设定良好，具有一套完整且一致的参数，并且其表述是客观的。所提供的光谱混合和大气效应模型是环境科学中使用的标准（尽管是简化的）近似方法。植被指数的定义和灵敏度分析在数学上是明确无误的。因此，可以构建一个合理的解决方案。\n\n解决方案的步骤是首先形式化植被指数的数学模型，然后在一个计算框架内应用这些模型来分析指定的测试案例。\n\n### 1. 植被指数的推导和公式化\n\n问题要求实现两种标准的宽波段植被指数，NDVI 和 EVI。它们的公式基于传感器测量的、与光谱相关的表观反射率 $R_{\\lambda}$。\n\n**归一化植被指数 (NDVI):**\nNDVI 旨在通过利用健康、具有光合作用活性的植被的特征光谱信号来增强植被与其他地表类型之间的对比度：光谱红光部分的低反射率（由于叶绿素吸收）和近红外（NIR）部分的高反射率（由于叶片内部散射）。归一化差异结构有助于减少某些类型的噪声和光照差异。基于所述的亮度归一化和对比度增强目标，使用传感器测量的反射率计算 NDVI 的标准公式为：\n$$\n\\text{NDVI}(R_{\\mathrm{NIR}}, R_{\\mathrm{Red}}) = \\frac{R_{\\mathrm{NIR}} - R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}} + R_{\\mathrm{Red}}}\n$$\n其中 $R_{\\mathrm{NIR}}$ 是近红外波段的表观反射率，$R_{\\mathrm{Red}}$ 是红光波段的表观反射率。\n\n**增强型植被指数 (EVI):**\n开发 EVI 是为了改进 NDVI，使其对茂密植被的变化更敏感，并减少土壤背景和大气气溶胶的影响。它引入了蓝光波段（$R_{\\mathrm{Blue}}$）来校正气溶胶的影响，因为气溶胶散射在较短波长处更为显著。使用提供的系数 $G = 2.5$、$C_1 = 6$、$C_2 = 7.5$ 和土壤调节因子 $L = 1$，标准的 EVI 公式为：\n$$\n\\text{EVI}(R_{\\mathrm{NIR}}, R_{\\mathrm{Red}}, R_{\\mathrm{Blue}}) = G \\cdot \\frac{R_{\\mathrm{NIR}} - R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}} + C_1 \\cdot R_{\\mathrm{Red}} - C_2 \\cdot R_{\\mathrm{Blue}} + L}\n$$\n\n### 2. 物理模型实现\n\n模拟的核心是针对给定的植被覆盖度分数 ($f$) 计算传感器测量的表观反射率 ($R_{\\lambda}$)。这涉及问题中定义的两个连续建模步骤。\n\n首先，使用线性光谱混合模型计算冠层顶反射率 $r_{\\lambda}(f)$。该模型将地表表示为纯植被和纯土壤反射率的加权平均值：\n$$\nr_{\\lambda}(f) = f \\cdot r_{\\lambda}^{\\text{leaf}} + (1-f) \\cdot r_{\\lambda}^{\\text{soil}}\n$$\n其中 $f$ 是植被覆盖度分数，$r_{\\lambda}^{\\text{leaf}}$ 是纯植被像元的反射率，$r_{\\lambda}^{\\text{soil}}$ 是纯土壤像元在给定光谱波段 $\\lambda \\in \\{\\text{Red}, \\text{NIR}, \\text{Blue}\\}$ 的反射率。\n\n其次，通过对大气效应建模来计算传感器测量的表观反射率 $R_{\\lambda}(f)$。该模型考虑了地表反射信号通过透射率 ($t_{\\lambda}$) 发生的衰减以及散射的大气信号（即路径反射率 $a_{\\lambda}$）的加入：\n$$\nR_{\\lambda}(f) = t_{\\lambda} \\cdot r_{\\lambda}(f) + a_{\\lambda}\n$$\n\n### 3. 灵敏度分析\n\n目标是比较 EVI 和 NDVI 对植被覆盖度分数 $f$ 微小变化的局部灵敏度，特别是在稀疏冠层（即 $f$ 接近 $0$）的情况下。指数 $I$ 的灵敏度 $S_I$ 使用两点 $f_1$ 和 $f_2$ 之间的有限差分商来近似：\n$$\nS_I = \\frac{I(f_2) - I(f_1)}{f_2 - f_1}\n$$\n该量近似了在区间 $[f_1, f_2]$ 上的导数 $\\frac{dI}{df}$。\n\n用于比较的最终度量是两个指数灵敏度的比率 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{S_{\\text{EVI}}}{S_{\\text{NDVI}}} = \\frac{(\\text{EVI}(f_2) - \\text{EVI}(f_1)) / (f_2 - f_1)}{(\\text{NDVI}(f_2) - \\text{NDVI}(f_1)) / (f_2 - f_1)} = \\frac{\\text{EVI}(f_2) - \\text{EVI}(f_1)}{\\text{NDVI}(f_2) - \\text{NDVI}(f_1)}\n$$\n\n### 4. 计算策略\n\n解决该问题的算法如下：\n\n1.  对于每个测试案例（A 到 E），检索指定的参数：$f_1, f_2$、叶片反射率 ($r_{\\lambda}^{\\text{leaf}}$)、土壤反射率 ($r_{\\lambda}^{\\text{soil}}$) 和大气参数 ($t_{\\lambda}, a_{\\lambda}$)。\n2.  对于两个植被覆盖度分数 $f_1$ 和 $f_2$ 中的每一个：\n    a. 使用线性混合模型计算地表反射率 $r_{\\mathrm{Red}}$、$r_{\\mathrm{NIR}}$ 和 $r_{\\mathrm{Blue}}$。\n    b. 使用大气模型计算传感器测量的表观反射率 $R_{\\mathrm{Red}}$、$R_{\\mathrm{NIR}}$ 和 $R_{\\mathrm{Blue}}$。\n    c. 使用这些表观反射率评估 $\\text{NDVI}(f)$ 和 $\\text{EVI}(f)$。这将产生两对值：$(\\text{NDVI}(f_1), \\text{EVI}(f_1))$ 和 $(\\text{NDVI}(f_2), \\text{EVI}(f_2))$。\n3.  使用计算出的指数值计算灵敏度比率 $\\mathcal{R}$。\n4.  将得到的 $\\mathcal{R}$ 四舍五入到 6 位小数。\n5.  收集所有测试案例的四舍五入后的比率。\n6.  将收集到的结果格式化为单个用方括号括起来的逗号分隔字符串，用于输出。\n\n该过程将在提供的 Python 环境中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the broadband vegetation index sensitivity problem.\n    \"\"\"\n    \n    # EVI constants\n    G = 2.5\n    C1 = 6.0\n    C2 = 7.5\n    L = 1.0\n\n    # Define the 5 test cases from the problem statement.\n    test_cases = [\n        # Case A (moderate aerosol, bright soil)\n        {\n            \"f_vals\": (0.0, 0.05),\n            \"leaf_refl\": {\"red\": 0.04, \"nir\": 0.55, \"blue\": 0.05},\n            \"soil_refl\": {\"red\": 0.30, \"nir\": 0.50, \"blue\": 0.25},\n            \"atmos\": {\n                \"t\": {\"red\": 0.90, \"nir\": 0.95, \"blue\": 0.85},\n                \"a\": {\"red\": 0.02, \"nir\": 0.005, \"blue\": 0.03},\n            },\n        },\n        # Case B (stronger aerosol, very bright soil)\n        {\n            \"f_vals\": (0.0, 0.10),\n            \"leaf_refl\": {\"red\": 0.03, \"nir\": 0.58, \"blue\": 0.04},\n            \"soil_refl\": {\"red\": 0.40, \"nir\": 0.60, \"blue\": 0.35},\n            \"atmos\": {\n                \"t\": {\"red\": 0.88, \"nir\": 0.94, \"blue\": 0.80},\n                \"a\": {\"red\": 0.04, \"nir\": 0.008, \"blue\": 0.06},\n            },\n        },\n        # Case C (clear atmosphere boundary)\n        {\n            \"f_vals\": (0.0, 0.05),\n            \"leaf_refl\": {\"red\": 0.02, \"nir\": 0.60, \"blue\": 0.03},\n            \"soil_refl\": {\"red\": 0.35, \"nir\": 0.55, \"blue\": 0.30},\n            \"atmos\": {\n                \"t\": {\"red\": 1.0, \"nir\": 1.0, \"blue\": 1.0},\n                \"a\": {\"red\": 0.0, \"nir\": 0.0, \"blue\": 0.0},\n            },\n        },\n        # Case D (lower leaf–soil contrast, moderate aerosol)\n        {\n            \"f_vals\": (0.0, 0.05),\n            \"leaf_refl\": {\"red\": 0.06, \"nir\": 0.45, \"blue\": 0.07},\n            \"soil_refl\": {\"red\": 0.25, \"nir\": 0.40, \"blue\": 0.20},\n            \"atmos\": {\n                \"t\": {\"red\": 0.92, \"nir\": 0.96, \"blue\": 0.86},\n                \"a\": {\"red\": 0.02, \"nir\": 0.004, \"blue\": 0.025},\n            },\n        },\n        # Case E (extremely bright soil, strong aerosol; very small f increment)\n        {\n            \"f_vals\": (0.0, 0.01),\n            \"leaf_refl\": {\"red\": 0.04, \"nir\": 0.55, \"blue\": 0.05},\n            \"soil_refl\": {\"red\": 0.45, \"nir\": 0.65, \"blue\": 0.45},\n            \"atmos\": {\n                \"t\": {\"red\": 0.85, \"nir\": 0.93, \"blue\": 0.78},\n                \"a\": {\"red\": 0.05, \"nir\": 0.01, \"blue\": 0.07},\n            },\n        },\n    ]\n\n    def calculate_indices(f, case_params):\n        \"\"\"\n        Calculates NDVI and EVI for a given fractional cover and parameter set.\n        \"\"\"\n        bands = [\"red\", \"nir\", \"blue\"]\n        r = {}\n        R = {}\n\n        # 1. Calculate surface reflectance (r_lambda) using linear mixture model\n        for band in bands:\n            r[band] = f * case_params[\"leaf_refl\"][band] + \\\n                      (1 - f) * case_params[\"soil_refl\"][band]\n        \n        # 2. Calculate apparent reflectance (R_lambda) using atmospheric model\n        for band in bands:\n            R[band] = case_params[\"atmos\"][\"t\"][band] * r[band] + \\\n                      case_params[\"atmos\"][\"a\"][band]\n\n        # 3. Calculate NDVI\n        ndvi_numerator = R[\"nir\"] - R[\"red\"]\n        ndvi_denominator = R[\"nir\"] + R[\"red\"]\n        # Handle potential division by zero, though unlikely with given data\n        ndvi = ndvi_numerator / ndvi_denominator if ndvi_denominator != 0 else 0.0\n\n        # 4. Calculate EVI\n        evi_numerator = G * (R[\"nir\"] - R[\"red\"])\n        evi_denominator = R[\"nir\"] + C1 * R[\"red\"] - C2 * R[\"blue\"] + L\n        evi = evi_numerator / evi_denominator if evi_denominator != 0 else 0.0\n        \n        return ndvi, evi\n\n    results = []\n    for case in test_cases:\n        f1, f2 = case[\"f_vals\"]\n        \n        # Calculate indices at f1 and f2\n        ndvi1, evi1 = calculate_indices(f1, case)\n        ndvi2, evi2 = calculate_indices(f2, case)\n        \n        # Calculate change in indices\n        delta_ndvi = ndvi2 - ndvi1\n        delta_evi = evi2 - evi1\n        \n        # Calculate sensitivity ratio R\n        # R = (S_EVI) / (S_NDVI) = (delta_evi/delta_f) / (delta_ndvi/delta_f) = delta_evi / delta_ndvi\n        # Check for delta_ndvi being zero to avoid division by zero\n        if delta_ndvi == 0:\n            # This case shouldn't occur for f1 != f2 and valid inputs,\n            # but is good practice to handle.\n            # If NDVI is insensitive but EVI is, the ratio is infinite.\n            # If both are insensitive, the ratio is undefined (we can use 0 or NaN).\n            # Given the problem's nature, a very large number or specific handling would be needed.\n            # We assume it doesn't happen based on the physics of the problem.\n            ratio = np.nan\n        else:\n            ratio = delta_evi / delta_ndvi\n\n        # Round to 6 decimal places as required\n        rounded_ratio = round(ratio, 6)\n        results.append(rounded_ratio)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}