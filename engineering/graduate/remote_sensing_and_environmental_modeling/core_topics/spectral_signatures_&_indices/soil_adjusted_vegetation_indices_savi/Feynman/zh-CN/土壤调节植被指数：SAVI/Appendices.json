{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在建立对土壤调节植被指数（SAVI）的深刻理解，我们不直接给出公式，而是从几个基本的设计要求出发进行推导。通过这种方式，您将清晰地看到该指数各个组成部分，尤其是调节参数 $L$ 的物理意义和数学作用 ()。这项练习将强化您从第一性原理出发构建和分析遥感模型的能力。",
            "id": "3849021",
            "problem": "考虑对一个非均质地表进行被动光学遥感观测，其中红光波段的表观双向反射因子表示为 $R$，近红外波段的表示为 $N$，且 $R$ 和 $N$ 均被视为满足 $0 \\leq R \\leq 1$ 和 $0 \\leq N \\leq 1$ 的无量纲反射率。归一化植被指数 (NDVI) 定义为 $\\mathrm{NDVI} = \\frac{N - R}{N + R}$，已知在稀疏植被覆盖下，由于附加的土壤亮度贡献，该指数对土壤背景敏感。\n\n为减轻土壤背景的影响，假设您寻求一种修正的、经土壤调节的植被指数，其结构通过在分母上添加一个非负的土壤调节参数 $L$ 来推广归一化差异，并包含一个允许依赖于 $L$ 的标量归一化因子。设计要求如下：\n1. 当 $L = 0$ 时，该指数应退化为归一化差异结构。\n2. 在理想化植被端元条件 $N = 1$ 和 $R = 0$ 下，对于任何 $L \\geq 0$，该指数应达到最大值 $1$。\n3. 该指数应是对称的，即对于任何 $L \\geq 0$，当 $N = R$ 时，其值为 $0$。\n\n从这些要求和 NDVI 的定义出发，推导出土壤调节植被指数 (SAVI) 作为 $N$、$R$ 和 $L$ 的函数的显式解析形式。然后，计算偏导数 $\\frac{\\partial \\mathrm{SAVI}}{\\partial L}$ 并将其简化为以 $N$、$R$ 和 $L$ 表示的闭合形式表达式。最后，根据该导数，讨论在哪些物理上有意义的区间（就 $N$、$R$ 和 $L$ 而言）下，该指数对 $L$ 的选择不敏感（即 $\\frac{\\partial \\mathrm{SAVI}}{\\partial L}$ 的量级很小或为零）。请将最终导数以单一闭合形式的解析表达式表示。无需四舍五入，也无需单位，因为反射率是无量纲的。",
            "solution": "该问题要求基于一组设计要求推导土壤调节植被指数 (SAVI)，然后计算并解读其关于土壤调节参数 $L$ 的偏导数。\n\n首先，我们验证问题陈述。\n已知条件为：\n-   红光波段反射率：$R$，其中 $0 \\leq R \\leq 1$。\n-   近红外波段反射率：$N$，其中 $0 \\leq N \\leq 1$。\n-   归一化植被指数：$\\mathrm{NDVI} = \\frac{N - R}{N + R}$。\n-   土壤调节参数：$L \\geq 0$。\n-   设计要求1：当 $L=0$ 时，该指数退化为 NDVI 结构。\n-   设计要求2：对于任何 $L \\geq 0$，当 $N=1, R=0$ 时，该指数为 $1$。\n-   设计要求3：对于任何 $L \\geq 0$，当 $N=R$ 时，该指数为 $0$。\n该问题在科学上基于遥感原理，特别是植被指数理论。问题是适定的，提供了足够的约束来推导出唯一解。语言客观，设定一致。因此，该问题被认为是有效的，我们可以继续进行求解。\n\n**第1部分：SAVI 公式的推导**\n\n我们首先为新指数提出一个通用形式，该形式包含了给定的结构修改。问题陈述该指数通过在分母上添加 $L$ 来推广归一化差异，并包含一个我们记为 $K(L)$ 的标量归一化因子。一个合理的通用形式是：\n$$\n\\mathrm{SAVI} = K(L) \\frac{N - R}{N + R + L}\n$$\n现在，我们应用三个设计要求来确定函数 $K(L)$。\n\n要求3指出，当 $N = R$ 时，指数必须为 $0$。将 $N=R$ 代入我们提出的形式中：\n$$\n\\mathrm{SAVI} = K(L) \\frac{R - R}{R + R + L} = K(L) \\frac{0}{2R + L} = 0\n$$\n只要分母 $2R+L$ 不为零，这个条件对于任何函数 $K(L)$ 都满足。由于 $R \\ge 0$ 和 $L \\ge 0$，分母仅在 $R=0$ 且 $L=0$ 时为零。在这种特殊情况（$N=R=L=0$）下，表达式为不定型 $0/0$，我们将其定义为 $0$ 以普遍满足该要求。因此，分子中的因子 $(N-R)$ 正确地实现了此要求。\n\n要求2指出，对于理想植被端元（$N=1$ 和 $R=0$），指数必须达到值 $1$。这必须对任何 $L \\geq 0$ 成立。我们将这些值代入 SAVI 的表达式中：\n$$\n1 = K(L) \\frac{1 - 0}{1 + 0 + L} = K(L) \\frac{1}{1 + L}\n$$\n求解 $K(L)$，我们得到归一化因子的显式形式：\n$$\nK(L) = 1 + L\n$$\n将此 $K(L)$ 的表达式代回我们的通用形式，我们得到土壤调节植被指数的解析形式：\n$$\n\\mathrm{SAVI} = (1 + L) \\frac{N - R}{N + R + L}\n$$\n最后，我们检验要求1，该要求指出当 $L=0$ 时，指数应退化为 NDVI 结构。在我们推导的公式中令 $L=0$：\n$$\n\\mathrm{SAVI}|_{L=0} = (1 + 0) \\frac{N - R}{N + R + 0} = \\frac{N - R}{N + R} = \\mathrm{NDVI}\n$$\n这证实了我们推导的 SAVI 表达式满足所有三个设计要求。\n\n**第2部分：偏导数 $\\frac{\\partial \\mathrm{SAVI}}{\\partial L}$ 的计算**\n\n我们现在计算 SAVI 关于 $L$ 的偏导数，将 $N$ 和 $R$ 视为常数。SAVI 的表达式为：\n$$\n\\mathrm{SAVI}(L) = (N - R) \\left( \\frac{1 + L}{N + R + L} \\right)\n$$\n我们可以对括号中的项使用商法则求导，$\\frac{d}{dx}\\left(\\frac{u(x)}{v(x)}\\right) = \\frac{u'(x)v(x) - u(x)v'(x)}{[v(x)]^2}$。\n令 $u(L) = 1 + L$ 和 $v(L) = N + R + L$。\n关于 $L$ 的导数是 $u'(L) = 1$ 和 $v'(L) = 1$。\n\n应用商法则：\n$$\n\\frac{\\partial}{\\partial L} \\left( \\frac{1 + L}{N + R + L} \\right) = \\frac{(1)(N + R + L) - (1 + L)(1)}{(N + R + L)^2}\n$$\n化简分子：\n$$\n(N + R + L) - (1 + L) = N + R + L - 1 - L = N + R - 1\n$$\n所以，分式项的导数为：\n$$\n\\frac{\\partial}{\\partial L} \\left( \\frac{1 + L}{N + R + L} \\right) = \\frac{N + R - 1}{(N + R + L)^2}\n$$\n乘以常数因子 $(N-R)$ 得到 SAVI 的最终偏导数：\n$$\n\\frac{\\partial \\mathrm{SAVI}}{\\partial L} = (N - R) \\frac{N + R - 1}{(N + R + L)^2}\n$$\n\n**第3部分：关于对 $L$ 不敏感性的讨论**\n\n当其偏导数 $\\frac{\\partial \\mathrm{SAVI}}{\\partial L}$ 为零或接近于零时，指数 SAVI 对参数 $L$ 的选择变得不敏感。我们分析导数的表达式以识别此类情景。\n$$\n\\frac{\\partial \\mathrm{SAVI}}{\\partial L} = \\frac{(N - R)(N + R - 1)}{(N + R + L)^2}\n$$\n当其分子为零时，导数精确为零。这在两种不同的条件下发生：\n1.  $N - R = 0$，即 $N = R$。这对应于 $N-R$ 光谱空间中的“灰线”，代表红光和近红外波段之间没有显著光谱差异的表面。物理上，这包括非植被表面，如裸土、岩石和人造结构。对于这些表面，无论 $L$ 为何值，$\\mathrm{SAVI} = 0$，因此该指数对土壤调节参数完全不敏感，这是一个理想的特性。\n\n2.  $N + R - 1 = 0$，即 $N + R = 1$。这在 $N-R$ 光谱空间中定义了一条线。对于任何反射率满足此条件的像元，SAVI 变得对 $L$ 不敏感。要看到这一点，将 $N+R=1$ 代入 SAVI 公式得到 $\\mathrm{SAVI} = (1+L)\\frac{N-R}{1+L} = N-R$，这与 $L$ 无关。\n\n在以下物理上有意义的情景中，导数的量级 $|\\frac{\\partial \\mathrm{SAVI}}{\\partial L}|$ 很小：\n-   **低植被覆盖或非植被表面**：此处 $N \\approx R$，所以项 $(N-R)$ 接近于零，使得导数很小。\n-   **茂密植被冠层**：对于茂密、健康的植被，红光波段的反射率非常低（$R \\to 0$），而近红外波段的反射率非常高（$N \\to 1$）。随着接近这一理想条件，和 $N+R$ 趋近于 $1$。因此，项 $(N+R-1)$ 趋近于 $0$，导致导数 $\\frac{\\partial \\mathrm{SAVI}}{\\partial L}$ 趋近于 $0$。这也是一个理想的特性，因为在完全冠层下，土壤背景的影响减小至零，因此土壤调节参数应具有可忽略的影响。\n\n总之，SAVI 对于非植被表面和非常茂密的植被冠层（这两种是植被覆盖的极端情况）对土壤参数 $L$ 不敏感。",
            "answer": "$$\n\\boxed{(N - R) \\frac{N + R - 1}{(N + R + L)^{2}}}\n$$"
        },
        {
            "introduction": "这是一个实际应用的案例研究，旨在检验您对SAVI核心功能的理解。我们将模拟遥感应用中一个常见的挑战——地表土壤湿度变化，并要求您定量分析在这种情景下，与传统的归一化植被指数（NDVI）相比，SAVI如何更有效地抑制土壤背景噪声 ()。这个练习突显了在植被稀疏区域使用SAVI的必要性和优势。",
            "id": "3849016",
            "problem": "一个天底观测多光谱传感器在一场降雨事件前后，对一个大面积、均质、无植被的裸土区域进行冠层顶部双向反射因子的测量。这场降雨使土壤体积含水量从 $0.05$ 增加到 $0.25$（无量纲）。该土壤的实验室特性分析表明，在数据采集的光照和观测几何条件下，湿润过程由于薄膜镜面增强效应导致红波段反射率轻微增加，同时由于水的吸收特征导致近红外反射率降低。测得的地表反射率如下：\n- 干燥状态：红波段反射率 $R_{\\mathrm{Red,dry}} = 0.20$，近红外反射率 $R_{\\mathrm{NIR,dry}} = 0.25$。\n- 湿润状态：红波段反射率 $R_{\\mathrm{Red,wet}} = 0.22$，近红外反射率 $R_{\\mathrm{NIR,wet}} = 0.18$。\n\n假设两次采集中均无植被存在，且观测几何与传感器定标等其他条件完全相同。考虑由这些波段计算出的归一化植被指数 (NDVI) 和土壤调节植被指数 (SAVI；土壤调节因子 $L = 0.50$) 的行为。\n\n哪一项陈述最能描述由这种湿度驱动的光谱偏移所引起的指数变化的符号和相对大小？\n\nA. 从干燥到湿润状态，NDVI 和 SAVI 均减小，但 SAVI 的减小幅度小于 NDVI，这反映了其对土壤背景的敏感度降低。\n\nB. 从干燥到湿润状态，NDVI 减小，但 SAVI 增加，因为土壤调节因子抵消了红波段的增加。\n\nC. NDVI 和 SAVI 的减小量相同，因为对于裸土，土壤调节没有效果。\n\nD. 从干燥到湿润状态，NDVI 增加而 SAVI 减小，表明它们对土壤光谱变化的敏感度相反。\n\nE. 从干燥到湿润状态，NDVI 和 SAVI 均减小，但 SAVI 的减小幅度大于 NDVI，因为在分母中加入 $L$ 会放大对土壤湿度的敏感度。",
            "solution": "我们从反射率和指数的定义开始。令 $R_{\\mathrm{Red}}$ 和 $R_{\\mathrm{NIR}}$ 分别表示红光和近红外波段的冠层顶部地表反射率。对于任何由波段组合构建的指数，其对 $R_{\\mathrm{Red}}$ 和 $R_{\\mathrm{NIR}}$ 变化的敏感度可以从它们的定义形式中确定。\n\n归一化植被指数 (NDVI) 定义为\n$$\n\\mathrm{NDVI} = \\frac{R_{\\mathrm{NIR}} - R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}} + R_{\\mathrm{Red}}}.\n$$\n带有土壤调节因子 $L$ 的土壤调节植被指数 (SAVI) 定义为\n$$\n\\mathrm{SAVI} = \\left(1+L\\right)\\,\\frac{R_{\\mathrm{NIR}} - R_{\\mathrm{Red}}}{R_{\\mathrm{NIR}} + R_{\\mathrm{Red}} + L}.\n$$\n\n首先，我们使用偏导数分析变化的符号。为简洁起见，令 $N \\equiv R_{\\mathrm{NIR}}$ 和 $R \\equiv R_{\\mathrm{Red}}$。\n\n对于 NDVI，定义\n$$\nf(N,R) = \\frac{N - R}{N + R}.\n$$\n其偏导数为\n$$\n\\frac{\\partial f}{\\partial N} = \\frac{(N+R) - (N-R)}{(N+R)^2} = \\frac{2R}{(N+R)^2} > 0,\n$$\n$$\n\\frac{\\partial f}{\\partial R} = \\frac{-(N+R) - (N-R)}{(N+R)^2} = -\\frac{2N}{(N+R)^2}  0.\n$$\n因此，$R$ 的增加会使 NDVI 减小，$N$ 的减小也会使 NDVI 减小。在所述的湿度变化下，$\\Delta R > 0$ 且 $\\Delta N  0$，因此两种效应都共同作用以降低 NDVI。\n\n对于 SAVI，定义\n$$\ng(N,R) = \\left(1+L\\right)\\,\\frac{N - R}{N + R + L}.\n$$\n其偏导数为\n$$\n\\frac{\\partial g}{\\partial N} = \\left(1+L\\right)\\,\\frac{(N+R+L) - (N-R)}{(N+R+L)^2} = \\left(1+L\\right)\\,\\frac{2R + L}{(N+R+L)^2}  0,\n$$\n$$\n\\frac{\\partial g}{\\partial R} = \\left(1+L\\right)\\,\\frac{-(N+R+L) - (N-R)}{(N+R+L)^2} = -\\left(1+L\\right)\\,\\frac{2N + L}{(N+R+L)^2}  0.\n$$\n与 NDVI 类似，$R$ 的增加和 $N$ 的减小都会降低 SAVI。因此，两个指数都必定会因指定的变化而减小。\n\n接下来，我们比较相对大小。NDVI 和 SAVI 的敏感度系数在两方面有所不同：SAVI 的分母包含 $L$，这增大了平方分母 $(N+R+L)^2$；SAVI 的分子包含由 $(1+L)$ 缩放的项 $2R+L$ 和 $2N+L$。对于典型的裸土反射率和适度的 $L$ 值（例如，$L=0.50$），分母的增加占主导地位，从而相对于 NDVI，降低了 SAVI 对土壤驱动的波段变化的敏感度大小。\n\n我们可以用给定的数值进行验证。\n\n干燥状态：\n- $R_{\\mathrm{Red,dry}} = 0.20$，\n- $R_{\\mathrm{NIR,dry}} = 0.25$。\n\n湿润状态：\n- $R_{\\mathrm{Red,wet}} = 0.22$，\n- $R_{\\mathrm{NIR,wet}} = 0.18$。\n\n计算 NDVI：\n$$\n\\mathrm{NDVI}_{\\mathrm{dry}} = \\frac{0.25 - 0.20}{0.25 + 0.20} = \\frac{0.05}{0.45} \\approx 0.111111,\n$$\n$$\n\\mathrm{NDVI}_{\\mathrm{wet}} = \\frac{0.18 - 0.22}{0.18 + 0.22} = \\frac{-0.04}{0.40} = -0.10.\n$$\n变化量：\n$$\n\\Delta \\mathrm{NDVI} = \\mathrm{NDVI}_{\\mathrm{wet}} - \\mathrm{NDVI}_{\\mathrm{dry}} \\approx -0.10 - 0.111111 \\approx -0.211111.\n$$\n\n用 $L=0.50$ 计算 SAVI：\n$$\n\\mathrm{SAVI}_{\\mathrm{dry}} = \\left(1+0.50\\right)\\frac{0.25 - 0.20}{0.25 + 0.20 + 0.50} = 1.50\\,\\frac{0.05}{0.95} \\approx 1.50 \\times 0.0526316 \\approx 0.078947,\n$$\n$$\n\\mathrm{SAVI}_{\\mathrm{wet}} = \\left(1+0.50\\right)\\frac{0.18 - 0.22}{0.18 + 0.22 + 0.50} = 1.50\\,\\frac{-0.04}{0.90} \\approx 1.50 \\times \\left(-0.0444444\\right) \\approx -0.0666667.\n$$\n变化量：\n$$\n\\Delta \\mathrm{SAVI} = \\mathrm{SAVI}_{\\mathrm{wet}} - \\mathrm{SAVI}_{\\mathrm{dry}} \\approx -0.0666667 - 0.078947 \\approx -0.145614.\n$$\n\n两个指数都减小了，且 SAVI 的减小幅度（约 $0.1456$）小于 NDVI 的减小幅度（约 $0.2111$），这与 SAVI 通过引入 $L$ 来减轻土壤背景效应的设计初衷一致。\n\n逐项分析选项：\n\n- 选项 A: 陈述了两个指数都减小，且 SAVI 的减小幅度小于 NDVI。这与基于导数的推理和显式计算都相符。正确。\n\n- 选项 B: 声称由于土壤调节因子，NDVI 减小但 SAVI 增加。符号分析表明 $\\partial g/\\partial N  0$ 和 $\\partial g/\\partial R  0$，因此在 $\\Delta N  0$ 和 $\\Delta R > 0$ 的情况下，SAVI 必须减小。错误。\n\n- 选项 C: 声称减小量相同。两个公式不同，数值结果也显示了不同的大小。错误。\n\n- 选项 D: 声称 NDVI 增加而 SAVI 减小。给定的波段变化会使两个指数都减小。错误。\n\n- 选项 E: 声称两者都减小，但由于 $L$ 的存在，SAVI 的减小幅度大于 NDVI。计算和敏感度分析显示了相反的结果：$L$ 降低了对土壤背景的敏感度，导致 SAVI 的变化幅度更小。错误。\n\n因此，最佳描述由选项 A 给出。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "本练习是一项高级的数据驱动挑战，旨在将理论与实践相结合。在许多应用中，调节参数 $L$ 常被设为一个通用值（如0.5），但最优值取决于当地的土壤特性。这项练习将指导您定义一个稳定性泛函，并利用真实的裸土光谱数据，通过编程实现经验性地确定最优 $L$ 值 ()，从而最大限度地减少土壤背景变化对植被指数的干扰。",
            "id": "3849008",
            "problem": "您的任务是在遥感和环境建模的背景下，推导并实现土壤调节植被指数（SAVI）的稳定性分析。从与基于反射率的植被指数相关的基本原理和经过充分检验的事实出发。具体来说，使用以下基础：\n\n- 光谱反射率是一个无量纲量，以 $0$ 到 $1$ 之间的小数形式度量，表示反射辐射与入射辐射之比。\n- 在稀疏植被冠层中，红光和近红外反射率可以近似为植和土壤组分的线性混合：$R = f R^{v} + (1-f) R^{s}$ 和 $N = f N^{v} + (1-f) N^{s}$，其中 $R$ 是红光反射率，$N$ 是近红外反射率，$f$ 是植被覆盖度，$R^{v},N^{v}$ 是植被反射率，$R^{s},N^{s}$ 是土壤反射率。\n- 裸土（$f=0$）的反射率通常沿着一条经验性的“土壤线”分布，该线建模为 $N^{s} \\approx \\alpha R^{s} + \\beta$，其中常数 $\\alpha$ 和 $\\beta$ 通过线性回归估计。\n\n基于以上基础，执行以下操作：\n\n1. 推导一个植被指数 $V(N,R;L)$，该指数明确包含一个标量土壤调节参数 $L \\in [0,1]$，并且相对于归一化植被指数（NDVI），它能降低对土壤背景的敏感性，同时保持植被信号的适当缩放。您的推导必须清楚地说明该指数是什么，为什么它能减少土壤影响，以及 $L$ 是如何从第一性原理出发，结合混合模型和土壤线概念引入表达式的，而不能假设目标指数的任何预先给定的公式。\n\n2. 将裸土的复合稳定性泛函定义为\n$$\nJ(L) = \\operatorname{MAD}_0(L) + \\left|m(L)\\right|,\n$$\n其中 $\\operatorname{MAD}_0(L)$ 是在测量的裸土样本 $(N_i,R_i)$ 上 $V(N_i,R_i;L)$ 绝对值的中位数，而 $m(L)$ 是 $V(N_i,R_i;L)$ 对土壤亮度 $B_i = (N_i + R_i)/2$ 进行普通最小二乘回归的斜率。当 $\\operatorname{Var}(B)  0$ 时，回归斜率计算为 $m(L)=\\operatorname{Cov}(B,V)/\\operatorname{Var}(B)$，当 $\\operatorname{Var}(B) = 0$ 时，设置为 $0$。\n\n3. 对于一组给定的裸土光谱，选择 $L$ 以在闭区间 $[0,1]$ 上最小化 $J(L)$。$L$ 的选择应表示为小数，并四舍五入到三位小数。\n\n您的程序必须实现推导出的指数 $V(N,R;L)$ 和稳定性泛函 $J(L)$，在 $[0,1]$ 上密集的 $L$ 值网格上评估 $J(L)$，并为每个测试用例返回最小化 $J(L)$ 的 $L$ 值。\n\n测试套件。使用以下测量的裸土反射率数据集。每对是 $(N,R)$，两个条目都是 $0$ 到 $1$ 之间的小数：\n\n- 集合 $\\mathcal{A}$（中等变异性）：\n  $(\\,\\,0.12\\,\\,,\\,\\,0.08\\,\\,)$, $(\\,\\,0.13\\,\\,,\\,\\,0.10\\,\\,)$, $(\\,\\,0.16\\,\\,,\\,\\,0.12\\,\\,)$, $(\\,\\,0.22\\,\\,,\\,\\,0.15\\,\\,)$, $(\\,\\,0.25\\,\\,,\\,\\,0.18\\,\\,)$, $(\\,\\,0.27\\,\\,,\\,\\,0.20\\,\\,)$, $(\\,\\,0.29\\,\\,,\\,\\,0.22\\,\\,)$, $(\\,\\,0.31\\,\\,,\\,\\,0.24\\,\\,)$, $(\\,\\,0.33\\,\\,,\\,\\,0.26\\,\\,)$, $(\\,\\,0.35\\,\\,,\\,\\,0.28\\,\\,)$, $(\\,\\,0.36\\,\\,,\\,\\,0.30\\,\\,)$, $(\\,\\,0.38\\,\\,,\\,\\,0.32\\,\\,)$.\n\n- 集合 $\\mathcal{B}$（高变异性，包括深色腐殖土和明亮沙土）：\n  $(\\,\\,0.05\\,\\,,\\,\\,0.03\\,\\,)$, $(\\,\\,0.08\\,\\,,\\,\\,0.06\\,\\,)$, $(\\,\\,0.12\\,\\,,\\,\\,0.10\\,\\,)$, $(\\,\\,0.21\\,\\,,\\,\\,0.20\\,\\,)$, $(\\,\\,0.24\\,\\,,\\,\\,0.22\\,\\,)$, $(\\,\\,0.30\\,\\,,\\,\\,0.28\\,\\,)$, $(\\,\\,0.42\\,\\,,\\,\\,0.39\\,\\,)$, $(\\,\\,0.45\\,\\,,\\,\\,0.40\\,\\,)$, $(\\,\\,0.50\\,\\,,\\,\\,0.45\\,\\,)$, $(\\,\\,0.55\\,\\,,\\,\\,0.50\\,\\,)$, $(\\,\\,0.58\\,\\,,\\,\\,0.52\\,\\,)$, $(\\,\\,0.60\\,\\,,\\,\\,0.55\\,\\,)$.\n\n- 集合 $\\mathcal{C}$（低变异性边界情况）：\n  $(\\,\\,0.25\\,\\,,\\,\\,0.18\\,\\,)$, $(\\,\\,0.26\\,\\,,\\,\\,0.18\\,\\,)$, $(\\,\\,0.25\\,\\,,\\,\\,0.19\\,\\,)$, $(\\,\\,0.26\\,\\,,\\,\\,0.19\\,\\,)$, $(\\,\\,0.24\\,\\,,\\,\\,0.18\\,\\,)$, $(\\,\\,0.24\\,\\,,\\,\\,0.19\\,\\,)$, $(\\,\\,0.25\\,\\,,\\,\\,0.18\\,\\,)$, $(\\,\\,0.25\\,\\,,\\,\\,0.19\\,\\,)$.\n\n数值要求：\n\n- 所有反射率都是无量纲的，并且必须作为 $0$ 到 $1$ 之间的小数处理。\n- 不涉及角度。\n- 您的程序必须输出为集合 $\\mathcal{A}$、$\\mathcal{B}$ 和 $\\mathcal{C}$ 选择的土壤调节参数，以小数形式表示并四舍五入到三位小数。\n\n算法要求：\n\n- 在 $[0,1]$ 上的均匀网格 $L_k$ 上评估 $J(L)$，步长为 $\\Delta L = $ $0.001$（即 $L_k = $ $0.000$, $0.001$, $0.002$, $\\dots$, $1.000$）。\n- 对于每个数据集，选择最小化 $J(L)$ 的 $L^\\star$；如果多个值并列最小，则在最小化器中选择最小的 $L$。\n- 使用上面定义的复合稳定性泛函 $J(L)$ 来表达在土壤变异性高的区域中 $L$ 的最终选择标准。\n\n最终输出格式：\n\n您的程序应生成一行输出，其中包含结果，格式为方括号内以逗号分隔的列表，顺序为 $[L^\\star_{\\mathcal{A}},L^\\star_{\\mathcal{B}},L^\\star_{\\mathcal{C}}]$，每个条目四舍五入到三位小数，例如：$[\\,\\,0.375\\,\\,,\\,\\,0.512\\,\\,,\\,\\,0.100\\,\\,]$。",
            "solution": "用户提供的问题已经过验证，并被确定为是合理的。\n\n**问题验证**\n\n1.  **提取已知条件**：\n    -   光谱反射率 $N$（近红外）和 $R$（红光）是 $[0,1]$ 内的无量纲小数。\n    -   给定了冠层反射率的线性混合模型：$R = f R^{v} + (1-f) R^{s}$ 和 $N = f N^{v} + (1-f) N^{s}$，其中 $f$ 是植被覆盖度。\n    -   给定了裸土反射率的线性模型（“土壤线”）：$N^{s} \\approx \\alpha R^{s} + \\beta$。\n    -   任务1：从这些原理出发，推导一个带有参数 $L \\in [0,1]$ 的土壤调节植被指数 $V(N,R;L)$。\n    -   任务2：为裸土定义一个稳定性泛函 $J(L) = \\operatorname{MAD}_0(L) + \\left|m(L)\\right|$。\n    -   $\\operatorname{MAD}_0(L)$ 是一组裸土样本的 $V(N_i,R_i;L)$ 绝对值的中位数。\n    -   $m(L)$ 是 $V(N_i,R_i;L)$ 相对于土壤亮度 $B_i = (N_i + R_i)/2$ 的普通最小二乘（OLS）回归斜率。当 $\\operatorname{Var}(B)  0$ 时，斜率为 $m(L)=\\operatorname{Cov}(B,V)/\\operatorname{Var}(B)$，否则为 $0$。\n    -   任务3：对于三个给定的裸土光谱数据集 $(\\mathcal{A}, \\mathcal{B}, \\mathcal{C})$，在 $L \\in [0,1]$ 上最小化 $J(L)$。\n    -   数值程序：在从 $0$ 到 $1$、步长为 $0.001$ 的均匀网格上评估 $J(L)$。如果出现平局，选择最小的 $L$。\n    -   每个数据集的最终结果是最佳 $L$ 值，四舍五入到三位小数。\n\n2.  **使用提取的已知条件进行验证**：\n    -   **科学基础**：该问题基于遥感领域的基本且被广泛接受的原理，包括线性混合模型、土壤线概念以及像 NDVI 和 SAVI 这样的植被指数的构建。最小化土壤背景效应的目标是该领域的核心主题之一。\n    -   **良态问题**：问题定义清晰。它要求进行推导（模型的论证）、函数定义和数值优化。目标函数 $J(L)$、搜索空间 $[0,1]$ 和优化过程（网格搜索）都已明确指定。提供的数据集足以执行所需的计算。\n    -   **客观性**：问题以精确、量化和无偏见的语言陈述。\n\n3.  **结论与行动**：该问题是**有效的**。它在科学上是合理的，问题是良态的，并且是客观的。它提出了一个环境建模中的非平凡任务，需要理论推理和数值实现。我现在将着手解决。\n\n---\n\n**1. 植被指数 $V(N,R;L)$ 的推导**\n\n植被指数的一个主要目标是提供一个与植被属性（如植被覆盖度 $f$、叶面积指数）强相关，同时受其他因素（如土壤背景、光照和大气条件）影响最小的度量。\n\n归一化植被指数（NDVI）定义为 $NDVI = \\frac{N-R}{N+R}$，是一个广泛使用的指数。然而，它存在一个已知的对土壤背景的敏感性问题。对于裸土（$f=0$），冠层反射率与土壤反射率相同，$N=N^s$ 和 $R=R^s$。这些土壤反射率在 $N-R$ 光谱空间中通常聚集在一条经验性的“土壤线”周围，该线由 $N^s \\approx \\alpha R^s + \\beta$ 描述。将此代入裸土的 NDVI 公式，得到：\n$$\nNDVI_{\\text{soil}} = \\frac{N^s - R^s}{N^s + R^s} = \\frac{(\\alpha R^s + \\beta) - R^s}{(\\alpha R^s + \\beta) + R^s} = \\frac{(\\alpha-1)R^s + \\beta}{(\\alpha+1)R^s + \\beta}\n$$\n这个表达式表明，$NDVI_{\\text{soil}}$ 是红光反射率 $R^s$（土壤亮度的代表）的函数。随着 $R^s$ 从暗土到亮土变化，裸土的 NDVI 值也随之改变，这会混淆指数的解释，特别是在土壤信号显著的稀疏植被区域。理想情况下，裸土的指数值应该是一个常数（例如，零）。\n\n为了减轻这种由土壤引起的变化，我们可以修改 NDVI 公式。核心思想是引入一个校正项，以解释土壤线的非零截距 $\\beta$ 和斜率 $\\alpha \\neq 1$。一个简单而有效的方法是在分母中添加一个恒定的调节因子，该因子可作为亮度项。让我们定义一个新指数 $V'$，带有一个土壤调节参数，我们称之为 $L_{abs}$：\n$$\nV' = \\frac{N - R}{N + R + L_{abs}}\n$$\n为使该指数沿土壤线保持恒定，其值必须独立于 $R^s$：\n$$\nV'_{\\text{soil}} = \\frac{(\\alpha-1)R^s + \\beta}{(\\alpha+1)R^s + \\beta + L_{abs}}\n$$\n为了使 $V'_{\\text{soil}}$ 独立于 $R^s$，分子和分母中 $R^s$ 的系数之比必须等于常数项之比。这将要求 $\\frac{\\alpha-1}{\\alpha+1} = \\frac{\\beta}{\\beta + L_{abs}}$，这意味着 $L_{abs}(\\alpha-1)=2\\beta$。这表明，如果土壤线参数 $\\alpha$ 和 $\\beta$ 精确已知，理论上是可能进行完美校正的。\n\n在实践中，土壤特性在空间上是变化的，因此单一的一组 $(\\alpha, \\beta)$ 并不普遍适用。一种更稳健的方法是引入一个通用调节参数，一个无量纲量 $L \\in [0,1]$，它不与特定的土壤线绑定，而是被优化以在一系列预期的土壤类型中最小化由土壤引起的噪声。这就导致了土壤调节植被指数（SAVI）及相关指数的公式化。我们可以通过将调节项设置为此参数 $L$ 来构建这样一个指数。\n问题不要求匹配 NDVI 的缩放比例，只要求保持植被信号的适当缩放并减少土壤影响。因此，我们的指数 $V(N,R;L)$ 的一个直接且充分的候选者是：\n$$\nV(N,R;L) = \\frac{N - R}{N + R + L}\n$$\n这里，$L$ 是标量土壤调节参数。当 $L=0$ 时，该指数与 NDVI 成比例（具体来说，它是 $NDVI / (1+NDVI)$）。随着 $L$ 的增加，它有助于缓冲指数对裸土分母 $N+R$ 变化的敏感性，从而稳定其值。$L$ 的最优值是对于给定数据集最能最小化土壤相关变化的那个值，这也是后续任务的目标。\n\n**2. 稳定性泛函与优化过程**\n\n问题定义了一个复合稳定性泛函 $J(L)$ 来寻找最优的 $L$：\n$$\nJ(L) = \\operatorname{MAD}_0(L) + \\left|m(L)\\right|\n$$\n这个泛函旨在找到一个 $L$ 值，使得裸土的指数 $V$ 同时接近于零且与土壤亮度不相关。\n-   $\\operatorname{MAD}_0(L) = \\operatorname{median}_{i}(\\{|V(N_i,R_i;L)|\\})$：距零中位绝对偏差衡量了裸土指数值的典型大小。一个理想的指数对所有裸土都会产生 $V=0$ 的结果，因此最小化此项会迫使指数值趋向于零。\n-   $m(L) = \\operatorname{Cov}(B,V)/\\operatorname{Var}(B)$：$V$ 对土壤亮度 $B = (N+R)/2$ 回归的斜率，衡量了指数随土壤亮度变化的残余系统趋势。最小化其绝对值 $|m(L)|$ 可以消除这种残余依赖性。\n\n优化通过网格搜索执行。我们对从 $0.000$ 到 $1.000$、步长为 $\\Delta L = 0.001$ 的一系列 $L$ 值评估 $J(L)$。对于每个提供的裸土数据集（$\\mathcal{A}$、$\\mathcal{B}$ 和 $\\mathcal{C}$），我们计算指数值向量 $V_i$、土壤亮度值 $B_i$，然后计算泛函 $J(L)$。产生最小 $J(L)$ 的值 $L^{\\star}$被选为该数据集的最优参数。如果出现平局，选择最小的 $L$ 值，这可以通过按升序迭代 $L$ 并在严格小于的情况下才更新最小值来自然处理。\n\n**3. 数值实现**\n\n对每个数据集，算法实现如下：\n1.  将 $(N, R)$ 反射率对解析为数值数组。\n2.  计算土壤亮度数组 $B_i = (N_i + R_i)/2$。\n3.  将 `min_J` 初始化为一个大值，将 `best_L` 初始化为一个默认值。\n4.  以 $0.001$ 为步长，从 $0.000$ 到 $1.000$ 循环遍历 $L_k$。\n5.  在每次迭代中，计算指数值数组 $V_i(L_k) = \\frac{N_i - R_i}{N_i + R_i + L_k}$。\n6.  计算 $\\operatorname{MAD}_0(L_k) = \\operatorname{median}(\\{|V_i(L_k)|\\})$。\n7.  计算亮度方差 $\\operatorname{Var}(B)$。如果方差为零，则将斜率 $m(L_k)$ 设为 $0$。否则，计算协方差 $\\operatorname{Cov}(B, V(L_k))$ 和斜率 $m(L_k) = \\operatorname{Cov}(B, V(L_k)) / \\operatorname{Var}(B)$。这些统计量使用总体公式（分母为 $n$）计算。\n8.  计算稳定性泛函 $J(L_k) = \\operatorname{MAD}_0(L_k) + |m(L_k)|$。\n9.  如果 $J(L_k)$ 小于当前的 `min_J`，则更新 `min_J = J(L_k)` 和 `best_L = L_k`。\n10. 循环完成后，`best_L` 包含该数据集的最优参数 $L^{\\star}$。\n11. 收集所有数据集的最终结果，并按要求格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a stability analysis for the Soil Adjusted \n    Vegetation Index (SAVI) to find the optimal soil-adjustment parameter L.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Set A (moderate variability)\n        np.array([\n            [0.12, 0.08], [0.13, 0.10], [0.16, 0.12], [0.22, 0.15],\n            [0.25, 0.18], [0.27, 0.20], [0.29, 0.22], [0.31, 0.24],\n            [0.33, 0.26], [0.35, 0.28], [0.36, 0.30], [0.38, 0.32]\n        ]),\n        # Set B (high variability)\n        np.array([\n            [0.05, 0.03], [0.08, 0.06], [0.12, 0.10], [0.21, 0.20],\n            [0.24, 0.22], [0.30, 0.28], [0.42, 0.39], [0.45, 0.40],\n            [0.50, 0.45], [0.55, 0.50], [0.58, 0.52], [0.60, 0.55]\n        ]),\n        # Set C (low variability boundary case)\n        np.array([\n            [0.25, 0.18], [0.26, 0.18], [0.25, 0.19], [0.26, 0.19],\n            [0.24, 0.18], [0.24, 0.19], [0.25, 0.18], [0.25, 0.19]\n        ])\n    ]\n\n    results = []\n    \n    # Define the grid for L\n    L_grid = np.arange(0.0, 1.001, 0.001)\n\n    for soil_data in test_cases:\n        N = soil_data[:, 0]\n        R = soil_data[:, 1]\n        \n        # Calculate soil brightness B\n        B = (N + R) / 2.0\n        \n        min_J = float('inf')\n        best_L = -1.0\n        \n        # Calculate Var(B) once. ddof=0 for population variance.\n        var_B = np.var(B, ddof=0)\n        \n        # Grid search for L\n        for L in L_grid:\n            # Calculate the vegetation index V for the current L\n            # Using a small epsilon to avoid division by zero if N+R+L is somehow zero,\n            # though not expected with the given positive reflectances and L=0.\n            denominator = N + R + L\n            V = (N - R) / (denominator + 1e-12)\n            \n            # Calculate MAD_0(L)\n            mad_0 = np.median(np.abs(V))\n            \n            # Calculate m(L)\n            m_L = 0.0\n            if var_B  0:\n                # Calculate Cov(B, V). ddof=0 for population covariance.\n                cov_matrix = np.cov(B, V, ddof=0)\n                cov_BV = cov_matrix[0, 1]\n                m_L = cov_BV / var_B\n            \n            # Calculate the stability functional J(L)\n            J = mad_0 + np.abs(m_L)\n            \n            # Check for new minimum\n            if J  min_J:\n                min_J = J\n                best_L = L\n\n        results.append(best_L)\n\n    # Format the final output as specified.\n    # The f-string formatting with .3f handles rounding.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}