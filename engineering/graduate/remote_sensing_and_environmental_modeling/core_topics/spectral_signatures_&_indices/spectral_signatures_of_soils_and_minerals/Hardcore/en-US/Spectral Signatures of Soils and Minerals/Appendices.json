{
    "hands_on_practices": [
        {
            "introduction": "A mineral's spectral signature is governed by both its chemical composition and its physical structure. This exercise explores the fundamental relationship between grain size and reflectance by modeling a mineral grain as a simple absorbing slab . By applying the Beer-Lambert law, you will derive how increased photon path length in larger grains leads to stronger absorption and, consequently, lower reflectance, providing a crucial first-order approximation for interpreting the spectra of particulate surfaces.",
            "id": "3854166",
            "problem": "A hyperspectral sensor observing a dry, granular mineral soil in the near-infrared records a decrease in reflectance as the mean grain diameter increases, consistent with increased photon path lengths and stronger absorption in larger grains. Consider a particulate bed whose grains can be idealized as homogeneous, plane-parallel slabs of thickness equal to the mean grain diameter $d$, with negligible internal scattering. Assume that photons contributing to the observed reflectance undergo a single specular reflection at the far interface of a grain and traverse the slab twice (in and out) before emerging. Let the absorption of the material at the wavelength of interest be characterized by the absorption coefficient $\\alpha$ (units of $\\mathrm{cm}^{-1}$), and assume that any Fresnel reflection factors and geometric collection constants are independent of $d$.\n\nStarting from the Beer–Lambert law and the definition of reflectance as the ratio of emergent to incident radiant power, derive an expression for the reflectance $R(d)$ as a function of $d$ and $\\alpha$ under the stated assumptions. Then, compute the reflectance change expressed as the ratio $R(200\\,\\mu\\mathrm{m})/R(100\\,\\mu\\mathrm{m})$ for a mineral with $\\alpha = 100\\,\\mathrm{cm}^{-1}$ when the mean grain diameter doubles from $100\\,\\mu\\mathrm{m}$ to $200\\,\\mu\\mathrm{m}$. Carefully account for unit conversions when substituting numerical values. Express your final result as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\n- The system is a dry, granular mineral soil idealized as a particulate bed of homogeneous, plane-parallel slabs.\n- The thickness of each slab is equal to the mean grain diameter, $d$.\n- Internal scattering within the grains is negligible.\n- Observed photons undergo a single specular reflection at the far interface of a grain.\n- The total path length of a photon inside a grain is twice the slab thickness.\n- The absorption coefficient of the material is $\\alpha$, with units of $\\mathrm{cm}^{-1}$.\n- Fresnel reflection factors and geometric collection constants are independent of $d$.\n- The task is to derive the reflectance $R(d)$ as a function of $d$ and $\\alpha$.\n- A second task is to compute the ratio $R(d_2)/R(d_1)$ for $d_1 = 100\\,\\mu\\mathrm{m}$ and $d_2 = 200\\,\\mu\\mathrm{m}$.\n- The value of the absorption coefficient is given as $\\alpha = 100\\,\\mathrm{cm}^{-1}$.\n- The final numerical result must be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the Beer-Lambert law, a fundamental principle of absorption spectroscopy. The model, although simplified (plane-parallel slabs, no scattering), is a common and valid idealization for introducing the concept of photon path length in particulate media, a cornerstone of more advanced models like Hapke theory in planetary remote sensing. The premise that reflectance decreases with increasing grain size for absorbing materials is factually correct.\n- **Well-Posed:** The problem provides a clear set of assumptions and sufficient information to derive the required expression and compute the numerical ratio. A unique, stable, and meaningful solution exists.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased language.\n- **Completeness and Consistency:** The problem is self-contained. The assumptions, such as the path length being $2d$ and other factors being independent of $d$, are explicitly stated and create a consistent framework for a solution.\n- **Realism:** The given values for grain size ($100\\,\\mu\\mathrm{m}$ to $200\\,\\mu\\mathrm{m}$, corresponding to fine sand) and absorption coefficient ($\\alpha = 100\\,\\mathrm{cm}^{-1}$) are physically realistic for minerals in the near-infrared portion of the spectrum.\n- **Conclusion:** The problem is scientifically sound, well-posed, and contains no apparent flaws or inconsistencies.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A solution will be provided.\n\n### Solution Derivation and Calculation\nThe problem requires the derivation of an expression for reflectance, $R(d)$, based on the Beer-Lambert law and a simplified model of light interaction with a mineral grain.\n\nThe Beer-Lambert law describes the attenuation of radiant power as it traverses an absorbing medium. The radiant power $P(x)$ after traveling a distance $x$ through a medium with absorption coefficient $\\alpha$ is given by:\n$$P(x) = P_0 \\exp(-\\alpha x)$$\nwhere $P_0$ is the initial radiant power entering the medium.\n\nAccording to the problem statement, the photons contributing to the measured reflectance traverse the grain of thickness $d$ twice (once on the way in to the far interface, and once on the way out after reflection). Therefore, the total path length of the light within the absorbing medium is $x = 2d$.\n\nLet $P_{inc}$ be the incident radiant power on the sensor's field of view, and let $P_{emerge}(d)$ be the emergent radiant power that is collected by the sensor. Reflectance is defined as the ratio of these two quantities:\n$$R(d) = \\frac{P_{emerge}(d)}{P_{inc}}$$\n\nThe process for a photon contributing to $P_{emerge}(d)$ involves several stages:\n1. Incident light must enter the grain.\n2. It propagates a distance $d$ to the far interface, undergoing absorption.\n3. It reflects specularly at the far interface.\n4. It propagates a distance $d$ back to the front interface, undergoing further absorption.\n5. It exits the grain and is collected by the sensor.\n\nThe radiant power is attenuated by the factor $\\exp(-\\alpha \\cdot 2d)$ due to absorption over the total path length $2d$. All other factors—such as the fraction of light that initially enters the grain, the reflectivity of the far interface, the fraction that exits the grain, and any geometric factors related to collection efficiency—are explicitly stated to be independent of the grain diameter $d$. We can group these factors into a single constant, $C_0$.\nThus, the emergent power can be written as:\n$$P_{emerge}(d) = C_0 \\cdot P_{inc} \\cdot \\exp(-2\\alpha d)$$\nwhere $C_0$ is a dimensionless proportionality constant that encapsulates all $d$-independent optical and geometric effects.\n\nSubstituting this into the definition of reflectance, we get:\n$$R(d) = \\frac{C_0 \\cdot P_{inc} \\cdot \\exp(-2\\alpha d)}{P_{inc}} = C_0 \\exp(-2\\alpha d)$$\nThis is the desired expression for reflectance as a function of $d$ and $\\alpha$.\n\nNext, we must compute the ratio $\\frac{R(200\\,\\mu\\mathrm{m})}{R(100\\,\\mu\\mathrm{m})}$. Let $d_1 = 100\\,\\mu\\mathrm{m}$ and $d_2 = 200\\,\\mu\\mathrm{m}$.\nUsing our derived expression for $R(d)$:\n$$R(d_1) = C_0 \\exp(-2\\alpha d_1)$$\n$$R(d_2) = C_0 \\exp(-2\\alpha d_2)$$\nThe ratio is:\n$$\\frac{R(d_2)}{R(d_1)} = \\frac{C_0 \\exp(-2\\alpha d_2)}{C_0 \\exp(-2\\alpha d_1)} = \\exp(-2\\alpha d_2 - (-2\\alpha d_1)) = \\exp(-2\\alpha(d_2-d_1))$$\nThe constant $C_0$ cancels, as expected.\n\nNow we substitute the numerical values:\n$\\alpha = 100\\,\\mathrm{cm}^{-1}$\n$d_1 = 100\\,\\mu\\mathrm{m}$\n$d_2 = 200\\,\\mu\\mathrm{m}$\n\nThe product $\\alpha d$ must be dimensionless, so we must use consistent units. We convert the grain diameters from micrometers ($\\mu\\mathrm{m}$) to centimeters ($\\mathrm{cm}$) to match the units of $\\alpha$.\nWe know that $1\\,\\mathrm{cm} = 10^4\\,\\mu\\mathrm{m}$, or $1\\,\\mu\\mathrm{m} = 10^{-4}\\,\\mathrm{cm}$.\n$$d_1 = 100\\,\\mu\\mathrm{m} = 100 \\times 10^{-4}\\,\\mathrm{cm} = 1 \\times 10^{-2}\\,\\mathrm{cm}$$\n$$d_2 = 200\\,\\mu\\mathrm{m} = 200 \\times 10^{-4}\\,\\mathrm{cm} = 2 \\times 10^{-2}\\,\\mathrm{cm}$$\nThe difference in path length is:\n$$d_2 - d_1 = (2 \\times 10^{-2} - 1 \\times 10^{-2})\\,\\mathrm{cm} = 1 \\times 10^{-2}\\,\\mathrm{cm}$$\nNow, we calculate the exponent:\n$$-2\\alpha(d_2-d_1) = -2 \\cdot (100\\,\\mathrm{cm}^{-1}) \\cdot (1 \\times 10^{-2}\\,\\mathrm{cm}) = -2 \\cdot 100 \\cdot 10^{-2} = -2$$\nThe exponent is dimensionless, as required.\n\nThe reflectance ratio is therefore:\n$$\\frac{R(200\\,\\mu\\mathrm{m})}{R(100\\,\\mu\\mathrm{m})} = \\exp(-2)$$\nCalculating the numerical value and rounding to four significant figures:\n$$\\exp(-2) \\approx 0.13533528...$$\nRounded to four significant figures, the result is $0.1353$.",
            "answer": "$$\\boxed{0.1353}$$"
        },
        {
            "introduction": "Moving from theory to practice, this problem addresses the fundamental task of obtaining accurate reflectance spectra in the field. Since spectroradiometers measure radiance ($L$), not intrinsic reflectance ($R$), a calibration step is required to account for the unknown incident illumination ($E$). This exercise guides you through the standard method of referencing a target's radiance measurement to that of a calibrated panel with known reflectance, allowing you to derive the target's true reflectance and assess how measurement uncertainties propagate through your calculations .",
            "id": "3854199",
            "problem": "A field spectroradiometer is used to retrieve the bidirectional reflectance factor of an iron-rich soil at wavelength $\\lambda = 650\\,\\mathrm{nm}$ by referencing measurements to a calibrated diffuse reflectance panel. The instrument is operated under clear-sky conditions with fixed viewing and illumination geometry, identical sensor integration time and gain for both the panel and the soil, and the atmospheric path contribution is negligible and identical for both measurements. Assume the surfaces are sufficiently close to Lambertian for the ratio method to be valid and the instrument response is linear.\n\nUse fundamental radiometric relations to derive how the soil reflectance $R(\\lambda)$ can be obtained from measured radiances and a known panel reflectance, starting from the observation that, for a Lambertian surface under identical irradiance, the exitant radiance is proportional to the reflectance. Then compute $R(\\lambda)$ from the following measurements and calibration information:\n- Reference panel reflectance at $\\lambda$: $R_{r}(\\lambda) = 0.500$ with an absolute uncertainty of $\\pm 0.010$.\n- Measured reference panel radiance at $\\lambda$: $L_{r}(\\lambda) = 3.10 \\times 10^{-3}\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,nm^{-1}}$.\n- Measured soil radiance at $\\lambda$: $L_{s}(\\lambda) = 1.27 \\times 10^{-3}\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,nm^{-1}}$.\n\nPropagate only the stated uncertainty in $R_{r}(\\lambda)$ to the retrieved $R(\\lambda)$, treating uncertainties in $L_{s}(\\lambda)$ and $L_{r}(\\lambda)$ as negligible. Use first-order uncertainty propagation.\n\nReport your final result as a row matrix containing the soil reflectance and its propagated absolute uncertainty at $\\lambda$, rounded to four significant figures. Express the reflectance as a dimensionless fraction.",
            "solution": "The goal is to retrieve the soil reflectance $R(\\lambda)$ by referencing the soil radiance to a calibrated diffuse reflectance panel, under identical illumination and viewing geometry and with a linear instrument. The fundamental base is the radiometric relation for a Lambertian reflector, which connects radiance to reflectance via irradiance. For a Lambertian surface with reflectance $R(\\lambda)$ under irradiance $E(\\lambda)$, the exitant radiance $L(\\lambda)$ in any viewing direction is given by\n$$\nL(\\lambda) = \\frac{E(\\lambda)}{\\pi}\\,R(\\lambda).\n$$\nThis relation follows from the definition of a Lambertian surface, whose Bidirectional Reflectance Distribution Function (BRDF) is constant and equals $R(\\lambda)/\\pi$, leading to $L(\\lambda) = f_{r}(\\lambda)\\,E(\\lambda)$ with $f_{r}(\\lambda) = R(\\lambda)/\\pi$.\n\nUnder identical measurement geometry and illumination for both the soil and the reference panel, the same irradiance $E(\\lambda)$ applies and instrument factors cancel in ratios due to linearity. Therefore, for the soil and the reference panel,\n$$\nL_{s}(\\lambda) = \\frac{E(\\lambda)}{\\pi}\\,R(\\lambda), \\qquad L_{r}(\\lambda) = \\frac{E(\\lambda)}{\\pi}\\,R_{r}(\\lambda).\n$$\nTaking the ratio eliminates $E(\\lambda)$ and $\\pi$:\n$$\n\\frac{L_{s}(\\lambda)}{L_{r}(\\lambda)} = \\frac{R(\\lambda)}{R_{r}(\\lambda)}.\n$$\nSolving for the soil reflectance yields\n$$\nR(\\lambda) = \\frac{L_{s}(\\lambda)}{L_{r}(\\lambda)}\\,R_{r}(\\lambda).\n$$\n\nWith the provided measurements,\n$$\nL_{s}(\\lambda) = 1.27 \\times 10^{-3}, \\qquad L_{r}(\\lambda) = 3.10 \\times 10^{-3},\n$$\nin units of $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,nm^{-1}}$; the ratio is\n$$\n\\frac{L_{s}(\\lambda)}{L_{r}(\\lambda)} = \\frac{1.27 \\times 10^{-3}}{3.10 \\times 10^{-3}} = \\frac{1.27}{3.10} = \\frac{127}{310}.\n$$\nThus,\n$$\nR(\\lambda) = \\left(\\frac{127}{310}\\right) R_{r}(\\lambda).\n$$\nUsing $R_{r}(\\lambda) = 0.500$,\n$$\nR(\\lambda) = \\frac{127}{310} \\times 0.500 = \\frac{127}{620}.\n$$\n\nNext, propagate the uncertainty from $R_{r}(\\lambda)$ to $R(\\lambda)$ using first-order uncertainty propagation. Treat $L_{s}(\\lambda)$ and $L_{r}(\\lambda)$ as exact relative to the panel uncertainty. Define the proportionality factor\n$$\na \\equiv \\frac{L_{s}(\\lambda)}{L_{r}(\\lambda)} = \\frac{127}{310}.\n$$\nThe retrieved reflectance is $R(\\lambda) = a\\,R_{r}(\\lambda)$. For $y = a\\,x$ with $a$ constant and only $x$ uncertain, the standard uncertainty propagates as\n$$\n\\sigma_{y} = |a|\\,\\sigma_{x}.\n$$\nHere, $\\sigma_{x} = \\sigma_{R_{r}} = 0.010$, so\n$$\n\\sigma_{R} = \\left|\\frac{127}{310}\\right| \\times 0.010 = \\frac{127}{31000}.\n$$\n\nCompute the numerical values and round to four significant figures. The soil reflectance is\n$$\nR(\\lambda) = \\frac{127}{620} \\approx 0.2048387097 \\quad \\Rightarrow \\quad R(\\lambda) \\approx 0.2048 \\text{ (four significant figures)}.\n$$\nThe propagated absolute uncertainty is\n$$\n\\sigma_{R} = \\frac{127}{31000} \\approx 0.004096774 \\quad \\Rightarrow \\quad \\sigma_{R} \\approx 0.004097 \\text{ (four significant figures)}.\n$$\n\nAs required, report the soil reflectance and its propagated absolute uncertainty at $\\lambda$ as a row matrix with dimensionless entries, rounded to four significant figures.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.2048 & 0.004097 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Once a reliable reflectance spectrum is obtained, the next challenge is to extract quantitative information about specific mineral absorptions. This practice challenges you to design a spectral index to detect a Magnesium-hydroxyl (Mg–OH) feature by implementing the technique of continuum removal, which normalizes the spectrum to isolate the absorption feature from the background continuum . By calculating a continuum-removed band depth ($\\mathrm{BD}_{\\mathrm{Mg}}$) for synthetic spectra, you will develop a practical understanding of how to create robust algorithms for mineral identification that are insensitive to confounding variables like overall brightness and local spectral slope.",
            "id": "3854175",
            "problem": "You are tasked with designing a detection index for the Magnesium hydroxyl (Mg–OH) absorption feature centered near $2.31\\,\\mu\\mathrm{m}$ in the Short-Wave Infrared (SWIR) region of the electromagnetic spectrum. The goal is to quantify the depth of the Mg–OH absorption feature while minimizing interference from the strong water absorption band near $1.90\\,\\mu\\mathrm{m}$ by using only adjacent spectral bands that are not affected by water. Your program must implement an index derived from first principles of reflectance spectroscopy that is robust to multiplicative illumination or moisture scaling and local spectral slope, and that uses only bands adjacent to the target feature.\n\nFundamental base:\n- The Beer–Lambert law states that transmitted irradiance through an absorbing medium at wavelength $\\lambda$ is $I(\\lambda) = I_0(\\lambda)\\exp(-k(\\lambda) L)$, where $k(\\lambda)$ is the absorption coefficient and $L$ is the optical path length. Surface reflectance $R(\\lambda)$ is the ratio $R(\\lambda) = I_\\mathrm{out}(\\lambda)/I_\\mathrm{in}(\\lambda)$ and exhibits diagnostic absorption features where $k(\\lambda)$ is large.\n- In mineral reflectance spectroscopy, an absorption feature can be modeled as a local multiplicative dip in reflectance. A widely used practice to quantify feature depth while mitigating continuum slope is local continuum removal via a linear continuum between shoulder bands.\n\nDesign constraints:\n- Use only wavelengths in the vicinity of the Mg–OH feature, specifically adjacent bands $\\lambda_L$ and $\\lambda_R$ that flank the center $\\lambda_C$ near $2.31\\,\\mu\\mathrm{m}$.\n- Explicitly avoid bands impacted by the $1.90\\,\\mu\\mathrm{m}$ water absorption by working in the interval $[2.29\\,\\mu\\mathrm{m}, 2.34\\,\\mu\\mathrm{m}]$.\n- The detection index must be dimensionless, derived from the ratio of measured reflectance at $\\lambda_C$ to a locally estimated continuum at $\\lambda_C$ computed from $\\lambda_L$ and $\\lambda_R$.\n\nMathematical model for synthetic test spectra:\nFor each test case, the reflectance function is defined on $\\lambda \\in \\{\\lambda_L, \\lambda_C, \\lambda_R\\}$ by\n$$\nR(\\lambda) = g \\cdot \\left(b + s\\cdot(\\lambda - \\lambda_0)\\right) \\cdot \\left(1 - a_{\\mathrm{Mg}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{Mg}})^2}{2\\sigma_{\\mathrm{Mg}}^2}\\right)\\right) \\cdot \\left(1 - a_{\\mathrm{side}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{side}})^2}{2\\sigma_{\\mathrm{side}}^2}\\right)\\right) \\cdot \\left(1 - a_{\\mathrm{H_2O}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{H_2O}})^2}{2\\sigma_{\\mathrm{H_2O}}^2}\\right)\\right),\n$$\nwhere:\n- $g$ is a global multiplicative factor (e.g., due to illumination or moisture film),\n- $b$ is a baseline reflectance at $\\lambda_0$,\n- $s$ is a local spectral slope in units of reflectance per micrometer,\n- $(a_{\\mathrm{Mg}}, \\lambda_{\\mathrm{Mg}}, \\sigma_{\\mathrm{Mg}})$ parameterize the Mg–OH absorption as a Gaussian dip,\n- $(a_{\\mathrm{side}}, \\lambda_{\\mathrm{side}}, \\sigma_{\\mathrm{side}})$ parameterize a possible adjacent interfering absorption feature,\n- $(a_{\\mathrm{H_2O}}, \\lambda_{\\mathrm{H_2O}}, \\sigma_{\\mathrm{H_2O}})$ parameterize the broad water absorption centered at $\\lambda_{\\mathrm{H_2O}}$,\n- $\\lambda_0$ is a reference wavelength used to define $b$ and $s$.\n\nIndex definition requirements:\n- Compute the local linear continuum at $\\lambda_C$ as\n$$\nC(\\lambda_C) = R(\\lambda_L) + \\left(R(\\lambda_R) - R(\\lambda_L)\\right)\\cdot \\frac{\\lambda_C - \\lambda_L}{\\lambda_R - \\lambda_L}.\n$$\n- Define the Mg–OH detection index, the continuum-removed band depth, as\n$$\n\\mathrm{BD}_{\\mathrm{Mg}} = 1 - \\frac{R(\\lambda_C)}{C(\\lambda_C)}.\n$$\nThis index is dimensionless and must be reported as a decimal number.\n\nPhysical and numerical units:\n- Wavelengths must be treated in micrometers (i.e., $\\mu\\mathrm{m}$).\n- Reflectance is dimensionless.\n- The final reported index values must be dimensionless decimal numbers rounded to $6$ decimal places.\n\nBand selection:\n- Use $\\lambda_L = 2.295\\,\\mu\\mathrm{m}$, $\\lambda_C = 2.315\\,\\mu\\mathrm{m}$, $\\lambda_R = 2.335\\,\\mu\\mathrm{m}$.\n- Use $\\lambda_0 = 2.315\\,\\mu\\mathrm{m}$ and $\\lambda_{\\mathrm{Mg}} = 2.315\\,\\mu\\mathrm{m}$.\n- Use $\\lambda_{\\mathrm{H_2O}} = 1.900\\,\\mu\\mathrm{m}$.\n\nTest suite:\nYour program must evaluate $\\mathrm{BD}_{\\mathrm{Mg}}$ for the following four test cases, each specified by parameters $(g, b, s, a_{\\mathrm{Mg}}, \\sigma_{\\mathrm{Mg}}, a_{\\mathrm{side}}, \\lambda_{\\mathrm{side}}, \\sigma_{\\mathrm{side}}, a_{\\mathrm{H_2O}}, \\sigma_{\\mathrm{H_2O}})$:\n\n- Test case $1$ (strong Mg–OH absorption, moderate slope, dry baseline):\n  - $g = 1.0$, $b = 0.5$, $s = 0.12$, $a_{\\mathrm{Mg}} = 0.35$, $\\sigma_{\\mathrm{Mg}} = 0.008$, $a_{\\mathrm{side}} = 0.0$, $\\lambda_{\\mathrm{side}} = 2.340$, $\\sigma_{\\mathrm{side}} = 0.006$, $a_{\\mathrm{H_2O}} = 0.2$, $\\sigma_{\\mathrm{H_2O}} = 0.05$.\n- Test case $2$ (no Mg–OH absorption, flat spectrum):\n  - $g = 1.0$, $b = 0.4$, $s = 0.0$, $a_{\\mathrm{Mg}} = 0.0$, $\\sigma_{\\mathrm{Mg}} = 0.008$, $a_{\\mathrm{side}} = 0.0$, $\\lambda_{\\mathrm{side}} = 2.340$, $\\sigma_{\\mathrm{side}} = 0.006$, $a_{\\mathrm{H_2O}} = 0.2$, $\\sigma_{\\mathrm{H_2O}} = 0.05$.\n- Test case $3$ (wet soil with global attenuation and shallow Mg–OH absorption):\n  - $g = 0.7$, $b = 0.6$, $s = 0.05$, $a_{\\mathrm{Mg}} = 0.10$, $\\sigma_{\\mathrm{Mg}} = 0.010$, $a_{\\mathrm{side}} = 0.0$, $\\lambda_{\\mathrm{side}} = 2.340$, $\\sigma_{\\mathrm{side}} = 0.006$, $a_{\\mathrm{H_2O}} = 0.3$, $\\sigma_{\\mathrm{H_2O}} = 0.06$.\n- Test case $4$ (Mg–OH absorption with adjacent interfering feature near $2.34\\,\\mu\\mathrm{m}$):\n  - $g = 1.0$, $b = 0.5$, $s = 0.10$, $a_{\\mathrm{Mg}} = 0.25$, $\\sigma_{\\mathrm{Mg}} = 0.010$, $a_{\\mathrm{side}} = 0.15$, $\\lambda_{\\mathrm{side}} = 2.340$, $\\sigma_{\\mathrm{side}} = 0.006$, $a_{\\mathrm{H_2O}} = 0.25$, $\\sigma_{\\mathrm{H_2O}} = 0.05$.\n\nAlgorithmic task:\n- For each test case, compute $R(\\lambda_L)$, $R(\\lambda_C)$, and $R(\\lambda_R)$ using the model above.\n- Compute $C(\\lambda_C)$ and then $\\mathrm{BD}_{\\mathrm{Mg}}$.\n- Report the four $\\mathrm{BD}_{\\mathrm{Mg}}$ values as a single line containing a comma-separated list enclosed in square brackets, with each value rounded to $6$ decimal places, e.g., $\\left[\\mathrm{bd}_1,\\mathrm{bd}_2,\\mathrm{bd}_3,\\mathrm{bd}_4\\right]$.\n\nFinal output format:\nYour program should produce exactly one line of output containing the results as a comma-separated list enclosed in square brackets, with each value rounded to $6$ decimal places (e.g., $[0.123456,0.000000,0.045678,0.234567]$).",
            "solution": "The problem is valid as it is scientifically grounded in the principles of reflectance spectroscopy, is mathematically well-posed, and provides a complete and consistent set of definitions, models, and data for a solvable computational task. The objective is to calculate a spectroscopic index, the continuum-removed band depth for a Magnesium-hydroxyl (Mg–OH) absorption feature, for four synthetic test cases.\n\nThe solution proceeds by first implementing the provided mathematical model for spectral reflectance and then using this model to compute the band depth index for each given parameter set.\n\nThe spectral reflectance $R(\\lambda)$ at a given wavelength $\\lambda$ is modeled as a product of four components: a global multiplicative factor $g$, a local linear continuum, and three Gaussian-shaped absorption features. The equation is:\n$$\nR(\\lambda) = g \\cdot \\left(b + s\\cdot(\\lambda - \\lambda_0)\\right) \\cdot \\left(1 - a_{\\mathrm{Mg}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{Mg}})^2}{2\\sigma_{\\mathrm{Mg}}^2}\\right)\\right) \\cdot \\left(1 - a_{\\mathrm{side}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{side}})^2}{2\\sigma_{\\mathrm{side}}^2}\\right)\\right) \\cdot \\left(1 - a_{\\mathrm{H_2O}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{H_2O}})^2}{2\\sigma_{\\mathrm{H_2O}}^2}\\right)\\right)\n$$\nThe parameters are provided for each test case. The fixed wavelengths are specified as $\\lambda_0 = 2.315\\,\\mu\\mathrm{m}$, $\\lambda_{\\mathrm{Mg}} = 2.315\\,\\mu\\mathrm{m}$, and $\\lambda_{\\mathrm{H_2O}} = 1.900\\,\\mu\\mathrm{m}$.\n\nThe algorithm involves a sequence of calculations for three specific wavelengths, which define the shoulders and center of the absorption feature:\n- Left shoulder: $\\lambda_L = 2.295\\,\\mu\\mathrm{m}$\n- Feature center: $\\lambda_C = 2.315\\,\\mu\\mathrm{m}$\n- Right shoulder: $\\lambda_R = 2.335\\,\\mu\\mathrm{m}$\n\nThe process for each test case is as follows:\n\nStep 1: Calculate Reflectance at Key Wavelengths\nUsing the reflectance model $R(\\lambda)$ and the given parameters for a specific test case, we compute the reflectance values at the three key wavelengths: $R(\\lambda_L)$, $R(\\lambda_C)$, and $R(\\lambda_R)$.\n\nStep 2: Estimate the Continuum\nA linear continuum is constructed between the two shoulder bands, $\\lambda_L$ and $\\lambda_R$. The value of this continuum at the feature's center wavelength, $\\lambda_C$, is estimated by linear interpolation:\n$$\nC(\\lambda_C) = R(\\lambda_L) + \\left(R(\\lambda_R) - R(\\lambda_L)\\right)\\cdot \\frac{\\lambda_C - \\lambda_L}{\\lambda_R - \\lambda_L}\n$$\nGiven the specified wavelengths, the fractional distance is $(\\lambda_C - \\lambda_L) / (\\lambda_R - \\lambda_L) = (2.315 - 2.295) / (2.335 - 2.295) = 0.020 / 0.040 = 0.5$. Thus, the continuum at $\\lambda_C$ simplifies to the arithmetic mean of the shoulder reflectances:\n$$\nC(\\lambda_C) = \\frac{R(\\lambda_L) + R(\\lambda_R)}{2}\n$$\n\nStep 3: Compute the Band Depth Index\nThe Mg–OH detection index, $\\mathrm{BD}_{\\mathrm{Mg}}$, is defined as the normalized depth of the reflectance at $\\lambda_C$ relative to the estimated continuum value $C(\\lambda_C)$. This is a standard formulation for continuum-removed band depth:\n$$\n\\mathrm{BD}_{\\mathrm{Mg}} = 1 - \\frac{R(\\lambda_C)}{C(\\lambda_C)}\n$$\nThis index is dimensionless. The global multiplicative factor $g$ in the reflectance model cancels out in the ratio $R(\\lambda_C) / C(\\lambda_C)$, making the index robust to variations in illumination.\n\nThis three-step procedure is applied to each of the four test cases. The resulting four $\\mathrm{BD}_{\\mathrm{Mg}}$ values are then collected and formatted as a comma-separated list, with each value rounded to $6$ decimal places.\n\nFor example, performing the calculation for Test Case 1:\n- Parameters: $(g, b, s, a_{\\mathrm{Mg}}, \\sigma_{\\mathrm{Mg}}, \\dots) = (1.0, 0.5, 0.12, 0.35, 0.008, \\dots)$\n- Compute reflectances: $R(\\lambda_L) \\approx 0.490041$, $R(\\lambda_C) \\approx 0.325000$, $R(\\lambda_R) \\approx 0.494727$. The water absorption term has a negligible effect as the wavelengths are far from its center.\n- Compute continuum: $C(\\lambda_C) = (0.490041 + 0.494727) / 2 \\approx 0.492384$.\n- Compute band depth: $\\mathrm{BD}_{\\mathrm{Mg}} = 1 - (0.325000 / 0.492384) \\approx 1 - 0.660054 \\approx 0.339946$.\n\nThe same calculation is systematically repeated for the remaining three test cases to generate the final list of results.",
            "answer": "[0.339946,0.000000,0.096472,0.237221]"
        }
    ]
}