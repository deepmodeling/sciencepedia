{
    "hands_on_practices": [
        {
            "introduction": "在光谱学中，我们测量的基本物理量是反射率。为了从传感器记录的原始辐射亮度信号中准确地获取地物反射率，我们必须进行辐射定标。本练习将指导您完成这一基本过程，即使用已知反射率的参考板来计算土壤样本的反射率。 该方法不仅能够有效消除光照条件变化和部分大气影响，也是野外光谱测量的标准操作流程。通过这个实践，您将掌握反射率测量的核心辐射学原理，并学会如何将定标标准的不确定性传递到最终结果中，这是确保数据质量的关键一步。",
            "id": "3854199",
            "problem": "一台野外光谱辐射计用于通过参考对一个已校准的漫反射板的测量值来反演富铁土壤在波长 $\\lambda = 650\\,\\mathrm{nm}$ 处的双向反射因子。该仪器在晴空条件下运行，具有固定的观测和照明几何结构，对反射板和土壤使用相同的传感器积分时间和增益，并且大气路径贡献对于两次测量都是可以忽略且相同的。假设表面足够接近朗伯体，以使比率法有效，并且仪器响应是线性的。\n\n使用基本的辐射度学关系，从“对于一个朗伯表面，在相同辐照度下，出射辐亮度与反射率成正比”这一观察出发，推导如何从测量的辐亮度和已知的反射板反射率中获得土壤反射率 $R(\\lambda)$。然后根据以下测量和校准信息计算 $R(\\lambda)$：\n- 参考板在波长 $\\lambda$ 处的反射率：$R_{r}(\\lambda) = 0.500$，绝对不确定度为 $\\pm 0.010$。\n- 测得的参考板在波长 $\\lambda$ 处的辐亮度：$L_{r}(\\lambda) = 3.10 \\times 10^{-3}\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,nm^{-1}}$。\n- 测得的土壤在波长 $\\lambda$ 处的辐亮度：$L_{s}(\\lambda) = 1.27 \\times 10^{-3}\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,nm^{-1}}$。\n\n仅将 $R_{r}(\\lambda)$ 中给出的不确定度传播到反演出的 $R(\\lambda)$，将 $L_{s}(\\lambda)$ 和 $L_{r}(\\lambda)$ 的不确定度视为可忽略不计。使用一阶不确定度传播。\n\n将你的最终结果报告为一个行矩阵，其中包含土壤在波长 $\\lambda$ 处的反射率及其传播的绝对不确定度，四舍五入到四位有效数字。将反射率表示为无量纲的分数。",
            "solution": "目标是通过将土壤辐亮度与一个已校准的漫反射板进行比对来反演土壤反射率 $R(\\lambda)$，此过程在相同的照明和观测几何条件下，并使用线性响应的仪器。其基本依据是朗伯反射体的辐射度学关系，该关系通过辐照度将辐亮度与反射率联系起来。对于一个在辐照度 $E(\\lambda)$ 下，反射率为 $R(\\lambda)$ 的朗伯表面，其在任何观测方向的出射辐亮度 $L(\\lambda)$ 由下式给出\n$$\nL(\\lambda) = \\frac{E(\\lambda)}{\\pi}\\,R(\\lambda).\n$$\n此关系源于朗伯表面的定义，其双向反射分布函数（BRDF）为常数且等于 $R(\\lambda)/\\pi$，从而得出 $L(\\lambda) = f_{r}(\\lambda)\\,E(\\lambda)$，其中 $f_{r}(\\lambda) = R(\\lambda)/\\pi$。\n\n在对土壤和参考板进行测量时，由于测量几何结构和照明条件相同，因此适用相同的辐照度 $E(\\lambda)$，并且由于仪器的线性响应，仪器因子在比率中被抵消。因此，对于土壤和参考板，\n$$\nL_{s}(\\lambda) = \\frac{E(\\lambda)}{\\pi}\\,R(\\lambda), \\qquad L_{r}(\\lambda) = \\frac{E(\\lambda)}{\\pi}\\,R_{r}(\\lambda).\n$$\n取两式之比可消去 $E(\\lambda)$ 和 $\\pi$：\n$$\n\\frac{L_{s}(\\lambda)}{L_{r}(\\lambda)} = \\frac{R(\\lambda)}{R_{r}(\\lambda)}.\n$$\n求解土壤反射率可得\n$$\nR(\\lambda) = \\frac{L_{s}(\\lambda)}{L_{r}(\\lambda)}\\,R_{r}(\\lambda).\n$$\n\n根据提供的测量数据，\n$$\nL_{s}(\\lambda) = 1.27 \\times 10^{-3}, \\qquad L_{r}(\\lambda) = 3.10 \\times 10^{-3},\n$$\n单位为 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,nm^{-1}}$；其比值为\n$$\n\\frac{L_{s}(\\lambda)}{L_{r}(\\lambda)} = \\frac{1.27 \\times 10^{-3}}{3.10 \\times 10^{-3}} = \\frac{1.27}{3.10} = \\frac{127}{310}.\n$$\n因此，\n$$\nR(\\lambda) = \\left(\\frac{127}{310}\\right) R_{r}(\\lambda).\n$$\n使用 $R_{r}(\\lambda) = 0.500$，\n$$\nR(\\lambda) = \\frac{127}{310} \\times 0.500 = \\frac{127}{620}.\n$$\n\n接下来，使用一阶不确定度传播将 $R_{r}(\\lambda)$ 的不确定度传播到 $R(\\lambda)$。相对于反射板的不确定度，将 $L_{s}(\\lambda)$ 和 $L_{r}(\\lambda)$ 视为精确值。定义比例因子\n$$\na \\equiv \\frac{L_{s}(\\lambda)}{L_{r}(\\lambda)} = \\frac{127}{310}.\n$$\n反演得到的反射率为 $R(\\lambda) = a\\,R_{r}(\\lambda)$。对于 $y = a\\,x$，其中 $a$ 为常数，只有 $x$ 具有不确定性，标准不确定度传播如下\n$$\n\\sigma_{y} = |a|\\,\\sigma_{x}.\n$$\n此处，$\\sigma_{x} = \\sigma_{R_{r}} = 0.010$，所以\n$$\n\\sigma_{R} = \\left|\\frac{127}{310}\\right| \\times 0.010 = \\frac{127}{31000}.\n$$\n\n计算数值并四舍五入到四位有效数字。土壤反射率为\n$$\nR(\\lambda) = \\frac{127}{620} \\approx 0.2048387097 \\quad \\Rightarrow \\quad R(\\lambda) \\approx 0.2048 \\text{ (四位有效数字)}.\n$$\n传播的绝对不确定度为\n$$\n\\sigma_{R} = \\frac{127}{31000} \\approx 0.004096774 \\quad \\Rightarrow \\quad \\sigma_{R} \\approx 0.004097 \\text{ (四位有效数字)}.\n$$\n\n按要求，将土壤在波长 $\\lambda$ 处的反射率及其传播的绝对不确定度报告为一个行矩阵，其条目为无量纲数，并四舍五入到四位有效数字。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.2048 & 0.004097 \\end{pmatrix}}$$"
        },
        {
            "introduction": "获得了准确的反射率光谱后，下一步是理解是什么物理因素决定了光谱的形态和亮度。除了物质成分，颗粒大小也是一个关键的控制因素。本练习  旨在通过一个简化的物理模型，帮助您探索颗粒大小对反射率的显著影响。基于比尔-朗伯定律，该模型阐释了对于吸收性介质，较大的颗粒会增加光子在物质内部的平均路径长度，从而导致更强的吸收和更低的反射率。这个思想实验有助于您建立一个直观的认识，理解为何同一种矿物在不同物理状态下会呈现出不同的光谱特征。",
            "id": "3854166",
            "problem": "一个高光谱传感器在近红外波段观测干燥的颗粒状矿物土壤时，记录到反射率随着平均粒径的增加而减小，这与较大颗粒中光子路径长度增加和吸收更强是一致的。考虑一个颗粒床，其颗粒可以理想化为厚度等于平均粒径 $d$ 的均匀平行平面板，其内部散射可忽略不计。假设对观测到的反射率有贡献的光子在颗粒的远界面经历一次镜面反射，并在出射前两次穿过平板（进入和出来）。设该材料在感兴趣波长处的吸收由吸收系数 $\\alpha$（单位为 $\\mathrm{cm}^{-1}$）来表征，并假设任何菲涅耳反射因子和几何收集常数都与 $d$ 无关。\n\n从比尔-朗伯定律和反射率作为出射辐射功率与入射辐射功率之比的定义出发，在所述假设下，推导反射率 $R(d)$ 作为 $d$ 和 $\\alpha$ 的函数表达式。然后，当平均粒径从 $100\\,\\mu\\mathrm{m}$ 翻倍到 $200\\,\\mu\\mathrm{m}$ 时，对于 $\\alpha = 100\\,\\mathrm{cm}^{-1}$ 的矿物，计算表示为比率 $R(200\\,\\mu\\mathrm{m})/R(100\\,\\mu\\mathrm{m})$ 的反射率变化。在代入数值时，请仔细考虑单位换算。将最终结果表示为一个无量纲数，并将答案四舍五入到四位有效数字。",
            "solution": "问题要求基于比尔-朗伯定律和一个简化的光与矿物颗粒相互作用模型，推导反射率 $R(d)$ 的表达式。\n\n比尔-朗伯定律描述了辐射功率在穿过吸收介质时的衰减。辐射功率 $P(x)$ 在穿过吸收系数为 $\\alpha$ 的介质一段距离 $x$ 后，由下式给出：\n$$P(x) = P_0 \\exp(-\\alpha x)$$\n其中 $P_0$ 是进入介质的初始辐射功率。\n\n根据问题陈述，对测量反射率有贡献的光子穿过厚度为 $d$ 的颗粒两次（一次是进入到达远界面，一次是反射后出来）。因此，光在吸收介质中的总路径长度是 $x = 2d$。\n\n设 $P_{inc}$ 是传感器视场上的入射辐射功率，设 $P_{emerge}(d)$ 是被传感器收集的出射辐射功率。反射率定义为这两个量的比值：\n$$R(d) = \\frac{P_{emerge}(d)}{P_{inc}}$$\n\n对 $P_{emerge}(d)$ 有贡献的光子其过程包括几个阶段：\n1. 入射光必须进入颗粒。\n2. 它传播距离 $d$ 到达远界面，期间发生吸收。\n3. 它在远界面发生镜面反射。\n4. 它传播距离 $d$ 返回到前界面，期间发生进一步吸收。\n5. 它离开颗粒并被传感器收集。\n\n由于在总路径长度 $2d$ 上的吸收，辐射功率被因子 $\\exp(-\\alpha \\cdot 2d)$ 衰减。所有其他因素——例如最初进入颗粒的光的分数、远界面的反射率、离开颗粒的分数以及与收集效率相关的任何几何因素——都明确说明与粒径 $d$ 无关。我们可以将这些因素组合成一个单一的常数 $C_0$。\n因此，出射功率可以写成：\n$$P_{emerge}(d) = C_0 \\cdot P_{inc} \\cdot \\exp(-2\\alpha d)$$\n其中 $C_0$ 是一个无量纲的比例常数，它包含了所有与 $d$ 无关的光学和几何效应。\n\n将此代入反射率的定义，我们得到：\n$$R(d) = \\frac{C_0 \\cdot P_{inc} \\cdot \\exp(-2\\alpha d)}{P_{inc}} = C_0 \\exp(-2\\alpha d)$$\n这就是所求的反射率作为 $d$ 和 $\\alpha$ 的函数的表达式。\n\n接下来，我们必须计算比率 $\\frac{R(200\\,\\mu\\mathrm{m})}{R(100\\,\\mu\\mathrm{m})}$。设 $d_1 = 100\\,\\mu\\mathrm{m}$ 和 $d_2 = 200\\,\\mu\\mathrm{m}$。\n使用我们推导出的 $R(d)$ 表达式：\n$$R(d_1) = C_0 \\exp(-2\\alpha d_1)$$\n$$R(d_2) = C_0 \\exp(-2\\alpha d_2)$$\n该比率为：\n$$\\frac{R(d_2)}{R(d_1)} = \\frac{C_0 \\exp(-2\\alpha d_2)}{C_0 \\exp(-2\\alpha d_1)} = \\exp(-2\\alpha d_2 - (-2\\alpha d_1)) = \\exp(-2\\alpha(d_2-d_1))$$\n常数 $C_0$ 被消掉了，正如预期的那样。\n\n现在我们代入数值：\n$\\alpha = 100\\,\\mathrm{cm}^{-1}$\n$d_1 = 100\\,\\mu\\mathrm{m}$\n$d_2 = 200\\,\\mu\\mathrm{m}$\n\n乘积 $\\alpha d$ 必须是无量纲的，所以我们必须使用一致的单位。我们将粒径从微米（$\\mu\\mathrm{m}$）转换为厘米（$\\mathrm{cm}$）以匹配 $\\alpha$ 的单位。\n我们知道 $1\\,\\mathrm{cm} = 10^4\\,\\mu\\mathrm{m}$，或者 $1\\,\\mu\\mathrm{m} = 10^{-4}\\,\\mathrm{cm}$。\n$$d_1 = 100\\,\\mu\\mathrm{m} = 100 \\times 10^{-4}\\,\\mathrm{cm} = 1 \\times 10^{-2}\\,\\mathrm{cm}$$\n$$d_2 = 200\\,\\mu\\mathrm{m} = 200 \\times 10^{-4}\\,\\mathrm{cm} = 2 \\times 10^{-2}\\,\\mathrm{cm}$$\n路径长度的差异是：\n$$d_2 - d_1 = (2 \\times 10^{-2} - 1 \\times 10^{-2})\\,\\mathrm{cm} = 1 \\times 10^{-2}\\,\\mathrm{cm}$$\n现在，我们计算指数：\n$$-2\\alpha(d_2-d_1) = -2 \\cdot (100\\,\\mathrm{cm}^{-1}) \\cdot (1 \\times 10^{-2}\\,\\mathrm{cm}) = -2 \\cdot 100 \\cdot 10^{-2} = -2$$\n指数是无量纲的，符合要求。\n\n因此，反射率比为：\n$$\\frac{R(200\\,\\mu\\mathrm{m})}{R(100\\,\\mu\\mathrm{m})} = \\exp(-2)$$\n计算数值并四舍五入到四位有效数字：\n$$\\exp(-2) \\approx 0.13533528...$$\n四舍五入到四位有效数字，结果是 $0.1353$。",
            "answer": "$$\\boxed{0.1353}$$"
        },
        {
            "introduction": "在考虑了颗粒大小等物理效应之后，光谱分析的核心任务是根据材料独特的光谱吸收特征来识别其化学成分。本练习  模拟了一项遥感应用中的真实任务：设计一个光谱指数来探测特定的矿物（在此案例中为含镁羟基的矿物）。您将使用“背景去除”这一经典技术来分离并量化吸收特征的深度，这种方法可以使测量结果对光谱背景的斜率和光照强度的变化具有稳健性。通过实现这个算法，您将掌握一种强大且广泛应用于定量矿物填图的技术，并从不同测试案例中体会到设计稳健指数以应对实际应用中干扰（如水分）的重要性。",
            "id": "3854175",
            "problem": "你的任务是为电磁波谱短波红外 (SWIR) 区域中，中心位于 $2.31\\,\\mu\\mathrm{m}$ 附近的镁羟基 (Mg–OH) 吸收特征设计一个检测指数。目标是量化 Mg–OH 吸收特征的深度，同时通过仅使用不受水影响的相邻光谱波段，最小化来自 $1.90\\,\\mu\\mathrm{m}$ 附近强水吸收带的干扰。你的程序必须实现一个源于反射光谱学第一性原理的指数，该指数对乘性光照或湿度缩放以及局部光谱斜率具有稳健性，并且仅使用邻近目标特征的波段。\n\n基本原理：\n- Beer–Lambert 定律指出，穿过吸收介质的透射辐照度在波长 $\\lambda$ 处为 $I(\\lambda) = I_0(\\lambda)\\exp(-k(\\lambda) L)$，其中 $k(\\lambda)$ 是吸收系数，$L$ 是光程长度。表面反射率 $R(\\lambda)$ 是比率 $R(\\lambda) = I_\\mathrm{out}(\\lambda)/I_\\mathrm{in}(\\lambda)$，并在 $k(\\lambda)$ 较大的地方表现出诊断性吸收特征。\n- 在矿物反射光谱学中，一个吸收特征可以被建模为反射率的局部乘性下降。一种广泛用于量化特征深度同时减轻连续谱斜率影响的方法是，通过肩部波段之间的线性连续谱进行局部连续谱去除。\n\n设计约束：\n- 仅使用 Mg–OH 特征附近的波长，特别是位于中心 $\\lambda_C$（接近 $2.31\\,\\mu\\mathrm{m}$）两侧的相邻波段 $\\lambda_L$ 和 $\\lambda_R$。\n- 通过在区间 $[2.29\\,\\mu\\mathrm{m}, 2.34\\,\\mu\\mathrm{m}]$ 内工作，明确避免受 $1.90\\,\\mu\\mathrm{m}$ 水吸收影响的波段。\n- 检测指数必须是无量纲的，由 $\\lambda_C$ 处的测量反射率与根据 $\\lambda_L$ 和 $\\lambda_R$ 计算出的 $\\lambda_C$ 处的局部估计连续谱的比值导出。\n\n合成测试光谱的数学模型：\n对于每个测试案例，反射率函数在 $\\lambda \\in \\{\\lambda_L, \\lambda_C, \\lambda_R\\}$ 上定义为\n$$\nR(\\lambda) = g \\cdot \\left(b + s\\cdot(\\lambda - \\lambda_0)\\right) \\cdot \\left(1 - a_{\\mathrm{Mg}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{Mg}})^2}{2\\sigma_{\\mathrm{Mg}}^2}\\right)\\right) \\cdot \\left(1 - a_{\\mathrm{side}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{side}})^2}{2\\sigma_{\\mathrm{side}}^2}\\right)\\right) \\cdot \\left(1 - a_{\\mathrm{H_2O}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{H_2O}})^2}{2\\sigma_{\\mathrm{H_2O}}^2}\\right)\\right),\n$$\n其中：\n- $g$ 是一个全局乘性因子（例如，由于光照或湿润膜），\n- $b$ 是在 $\\lambda_0$ 处的基线反射率，\n- $s$ 是局部光谱斜率，单位为反射率/微米，\n- $(a_{\\mathrm{Mg}}, \\lambda_{\\mathrm{Mg}}, \\sigma_{\\mathrm{Mg}})$ 将 Mg–OH 吸收参数化为高斯凹陷，\n- $(a_{\\mathrm{side}}, \\lambda_{\\mathrm{side}}, \\sigma_{\\mathrm{side}})$ 参数化一个可能的相邻干扰吸收特征，\n- $(a_{\\mathrm{H_2O}}, \\lambda_{\\mathrm{H_2O}}, \\sigma_{\\mathrm{H_2O}})$ 参数化以 $\\lambda_{\\mathrm{H_2O}}$ 为中心的宽水吸收带，\n- $\\lambda_0$ 是用于定义 $b$ 和 $s$ 的参考波长。\n\n指数定义要求：\n- 计算 $\\lambda_C$ 处的局部线性连续谱为\n$$\nC(\\lambda_C) = R(\\lambda_L) + \\left(R(\\lambda_R) - R(\\lambda_L)\\right)\\cdot \\frac{\\lambda_C - \\lambda_L}{\\lambda_R - \\lambda_L}.\n$$\n- 将 Mg–OH 检测指数，即连续谱去除后的波段深度，定义为\n$$\n\\mathrm{BD}_{\\mathrm{Mg}} = 1 - \\frac{R(\\lambda_C)}{C(\\lambda_C)}.\n$$\n该指数是无量纲的，必须以小数值报告。\n\n物理和数值单位：\n- 波长必须以微米（即 $\\mu\\mathrm{m}$）为单位处理。\n- 反射率是无量纲的。\n- 最终报告的指数值必须是无量纲的小数，四舍五入到 $6$ 位小数。\n\n波段选择：\n- 使用 $\\lambda_L = 2.295\\,\\mu\\mathrm{m}$，$\\lambda_C = 2.315\\,\\mu\\mathrm{m}$，$\\lambda_R = 2.335\\,\\mu\\mathrm{m}$。\n- 使用 $\\lambda_0 = 2.315\\,\\mu\\mathrm{m}$ 和 $\\lambda_{\\mathrm{Mg}} = 2.315\\,\\mu\\mathrm{m}$。\n- 使用 $\\lambda_{\\mathrm{H_2O}} = 1.900\\,\\mu\\mathrm{m}$。\n\n测试套件：\n你的程序必须为以下四个测试案例评估 $\\mathrm{BD}_{\\mathrm{Mg}}$，每个案例由参数 $(g, b, s, a_{\\mathrm{Mg}}, \\sigma_{\\mathrm{Mg}}, a_{\\mathrm{side}}, \\lambda_{\\mathrm{side}}, \\sigma_{\\mathrm{side}}, a_{\\mathrm{H_2O}}, \\sigma_{\\mathrm{H_2O}})$ 指定：\n\n- 测试案例 $1$ (强 Mg–OH 吸收，中等斜率，干燥基线):\n  - $g = 1.0$, $b = 0.5$, $s = 0.12$, $a_{\\mathrm{Mg}} = 0.35$, $\\sigma_{\\mathrm{Mg}} = 0.008$, $a_{\\mathrm{side}} = 0.0$, $\\lambda_{\\mathrm{side}} = 2.340$, $\\sigma_{\\mathrm{side}} = 0.006$, $a_{\\mathrm{H_2O}} = 0.2$, $\\sigma_{\\mathrm{H_2O}} = 0.05$。\n- 测试案例 $2$ (无 Mg–OH 吸收，平坦光谱):\n  - $g = 1.0$, $b = 0.4$, $s = 0.0$, $a_{\\mathrm{Mg}} = 0.0$, $\\sigma_{\\mathrm{Mg}} = 0.008$, $a_{\\mathrm{side}} = 0.0$, $\\lambda_{\\mathrm{side}} = 2.340$, $\\sigma_{\\mathrm{side}} = 0.006$, $a_{\\mathrm{H_2O}} = 0.2$, $\\sigma_{\\mathrm{H_2O}} = 0.05$。\n- 测试案例 $3$ (带有全局衰减和浅 Mg–OH 吸收的湿润土壤):\n  - $g = 0.7$, $b = 0.6$, $s = 0.05$, $a_{\\mathrm{Mg}} = 0.10$, $\\sigma_{\\mathrm{Mg}} = 0.010$, $a_{\\mathrm{side}} = 0.0$, $\\lambda_{\\mathrm{side}} = 2.340$, $\\sigma_{\\mathrm{side}} = 0.006$, $a_{\\mathrm{H_2O}} = 0.3$, $\\sigma_{\\mathrm{H_2O}} = 0.06$。\n- 测试案例 $4$ (带有 $2.34\\,\\mu\\mathrm{m}$ 附近相邻干扰特征的 Mg–OH 吸收):\n  - $g = 1.0$, $b = 0.5$, $s = 0.10$, $a_{\\mathrm{Mg}} = 0.25$, $\\sigma_{\\mathrm{Mg}} = 0.010$, $a_{\\mathrm{side}} = 0.15$, $\\lambda_{\\mathrm{side}} = 2.340$, $\\sigma_{\\mathrm{side}} = 0.006$, $a_{\\mathrm{H_2O}} = 0.25$, $\\sigma_{\\mathrm{H_2O}} = 0.05$。\n\n算法任务：\n- 对于每个测试案例，使用上述模型计算 $R(\\lambda_L)$、$R(\\lambda_C)$ 和 $R(\\lambda_R)$。\n- 计算 $C(\\lambda_C)$，然后计算 $\\mathrm{BD}_{\\mathrm{Mg}}$。\n- 将四个 $\\mathrm{BD}_{\\mathrm{Mg}}$ 值报告为单行，形式为一个用方括号括起来的逗号分隔列表，每个值四舍五入到 $6$ 位小数，例如 $\\left[\\mathrm{bd}_1,\\mathrm{bd}_2,\\mathrm{bd}_3,\\mathrm{bd}_4\\right]$。\n\n最终输出格式：\n你的程序应精确生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个值四舍五入到 $6$ 位小数（例如，$[0.123456,0.000000,0.045678,0.234567]$）。",
            "solution": "该问题是有效的，因为它在科学上基于反射光谱学原理，在数学上是适定的，并为可解的计算任务提供了一套完整且一致的定义、模型和数据。目标是为四个合成测试案例计算一个光谱指数——镁羟基 (Mg–OH) 吸收特征的连续谱去除后波段深度。\n\n解决方案首先实现所提供的光谱反射率数学模型，然后使用该模型为每个给定的参数集计算波段深度指数。\n\n在给定波长 $\\lambda$ 处的光谱反射率 $R(\\lambda)$ 被建模为四个分量的乘积：一个全局乘性因子 $g$，一个局部线性连续谱，以及三个高斯形状的吸收特征。方程为：\n$$\nR(\\lambda) = g \\cdot \\left(b + s\\cdot(\\lambda - \\lambda_0)\\right) \\cdot \\left(1 - a_{\\mathrm{Mg}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{Mg}})^2}{2\\sigma_{\\mathrm{Mg}}^2}\\right)\\right) \\cdot \\left(1 - a_{\\mathrm{side}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{side}})^2}{2\\sigma_{\\mathrm{side}}^2}\\right)\\right) \\cdot \\left(1 - a_{\\mathrm{H_2O}} \\exp\\left(-\\frac{(\\lambda - \\lambda_{\\mathrm{H_2O}})^2}{2\\sigma_{\\mathrm{H_2O}}^2}\\right)\\right)\n$$\n每个测试案例都提供了参数。固定波长被指定为 $\\lambda_0 = 2.315\\,\\mu\\mathrm{m}$，$\\lambda_{\\mathrm{Mg}} = 2.315\\,\\mu\\mathrm{m}$ 和 $\\lambda_{\\mathrm{H_2O}} = 1.900\\,\\mu\\mathrm{m}$。\n\n该算法涉及对三个特定波长的一系列计算，这三个波长定义了吸收特征的肩部和中心：\n- 左肩：$\\lambda_L = 2.295\\,\\mu\\mathrm{m}$\n- 特征中心：$\\lambda_C = 2.315\\,\\mu\\mathrm{m}$\n- 右肩：$\\lambda_R = 2.335\\,\\mu\\mathrm{m}$\n\n每个测试案例的处理过程如下：\n\n步骤1：计算关键波长处的反射率\n使用反射率模型 $R(\\lambda)$ 和特定测试案例给定的参数，我们计算三个关键波长处的反射率值：$R(\\lambda_L)$、$R(\\lambda_C)$ 和 $R(\\lambda_R)$。\n\n步骤2：估计连续谱\n在两个肩部波段 $\\lambda_L$ 和 $\\lambda_R$ 之間构建一个线性连续谱。通过线性插值来估计该连续谱在特征中心波长 $\\lambda_C$ 处的值：\n$$\nC(\\lambda_C) = R(\\lambda_L) + \\left(R(\\lambda_R) - R(\\lambda_L)\\right)\\cdot \\frac{\\lambda_C - \\lambda_L}{\\lambda_R - \\lambda_L}\n$$\n鉴于指定的波长，距离分数是 $(\\lambda_C - \\lambda_L) / (\\lambda_R - \\lambda_L) = (2.315 - 2.295) / (2.335 - 2.295) = 0.020 / 0.040 = 0.5$。因此，$\\lambda_C$ 处的连续谱简化为肩部反射率的算术平均值：\n$$\nC(\\lambda_C) = \\frac{R(\\lambda_L) + R(\\lambda_R)}{2}\n$$\n\n步骤3：计算波段深度指数\nMg–OH 检测指数 $\\mathrm{BD}_{\\mathrm{Mg}}$ 定义为 $\\lambda_C$ 处的反射率相对于估计连续谱值 $C(\\lambda_C)$ 的归一化深度。这是连续谱去除后波段深度的标准公式：\n$$\n\\mathrm{BD}_{\\mathrm{Mg}} = 1 - \\frac{R(\\lambda_C)}{C(\\lambda_C)}\n$$\n该指数是无量纲的。反射率模型中的全局乘性因子 $g$ 在比率 $R(\\lambda_C) / C(\\lambda_C)$ 中被消去，使得该指数对光照变化具有稳健性。\n\n将此三步过程应用于四个测试案例中的每一个。然后将得到的四个 $\\mathrm{BD}_{\\mathrm{Mg}}$ 值收集并格式化为一个逗号分隔的列表，每个值四舍五入到 $6$ 位小数。\n\n例如，对测试案例1进行计算：\n- 参数：$(g, b, s, a_{\\mathrm{Mg}}, \\sigma_{\\mathrm{Mg}}, \\dots) = (1.0, 0.5, 0.12, 0.35, 0.008, \\dots)$\n- 计算反射率：$R(\\lambda_L) \\approx 0.490041$，$R(\\lambda_C) \\approx 0.325000$，$R(\\lambda_R) \\approx 0.494727$。由于波长远离水吸收中心，水吸收项的影响可以忽略不计。\n- 计算连续谱：$C(\\lambda_C) = (0.490041 + 0.494727) / 2 \\approx 0.492384$。\n- 计算波段深度：$\\mathrm{BD}_{\\mathrm{Mg}} = 1 - (0.325000 / 0.492384) \\approx 1 - 0.660054 \\approx 0.339946$。\n\n对剩下的三个测试案例系统地重复相同的计算，以生成最终的结果列表。",
            "answer": "$$[0.339946,0.000000,0.093375,0.231908]$$"
        }
    ]
}