{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习旨在巩固水体指数背后的基本原理。通过为一个假设的水体像元计算归一化差异水体指数 ($NDWI$) 和修正归一化差异水体指数 ($MNDWI$)，您将直接观察到 $MNDWI$ 所提供的增强对比度。这个练习不仅强化了这些指数的物理基础——水的独特光谱特性，还展示了波段选择上的简单改变如何能显著改善水体的提取效果 。",
            "id": "3865928",
            "problem": "一幅经过大气校正的多光谱图像中的单个像素，其在绿光、近红外和短波红外通道的表面反射率分别为 $\\rho_{\\text{green}}=0.08$、$\\rho_{\\text{NIR}}=0.02$ 和 $\\rho_{\\text{SWIR}}=0.01$。假设这些反射率代表了均匀光照下朗伯表面的双向反射率因子，并且邻近效应和地形效应可以忽略不计。从一个稳健的用于物质判别的双波段光谱指数的设计原则出发，该指数应（i）对目标相对明亮的波段与相对暗淡的波段之间的光谱对比度做出单调响应，以及（ii）对乘性光照或增益变化保持不变，请构建该指数的适当归一化形式。利用此构造以及一个公认的物理事实，即液态水由于强烈的分子吸收，在光谱的绿光部分的反射率比在近红外部分，尤其是在短波红外部分要高，推导出该像素的归一化差异水体指数（NDWI）和修正归一化差异水体指数（MNDWI）的表达式，为给定的反射率计算这两个指数的值，然后根据结果的大小，论证在乘性光照变化下，哪个指数能为开放水体与非水体背景提供更强的对比度。将两个数值指数值四舍五入到四位有效数字。最终数值不带单位。",
            "solution": "该问题经过验证，被认为是有效的，因为它具有科学依据、问题明确且客观，并提供了在遥感领域内获得唯一且有意义解所需的所有数据和定义。\n\n解决该任务的方法是，首先根据给定的设计原则推导出归一化差异指数的一般形式，然后应用此形式来定义归一化差异水体指数（NDWI）和修正归一化差异水体指数（MNDWI），计算它们在给定像素反射率下的值，最后比较它们的大小以确定哪一个能为水体提供更强的对比度。\n\n首先，我们构建一个稳健光谱指数的一般形式。设两个不同光谱波段的反射率分别为 $\\rho_1$ 和 $\\rho_2$。第一个设计原则指出，指数应与目标明亮波段（例如 $\\rho_1$）和暗淡波段（例如 $\\rho_2$）之间的光谱对比度呈单调响应。一个简单的差值 $\\rho_1 - \\rho_2$ 满足此标准，因为它随对比度的增加而增加。\n\n第二个设计原则要求指数对乘性的光照或传感器增益变化保持不变。设这样的乘性因子为 $k$，其中 $k > 0$。观测到的辐射亮度以及由此导出的反射率将缩放为 $k \\rho_1$ 和 $k \\rho_2$。简单的差值变为 $k(\\rho_1 - \\rho_2)$，它不是不变的，因为它随 $k$ 缩放。为了实现不变性，我们必须用一个同样随 $k$ 线性缩放的因子来归一化这个差值。一个自然的选择是使用反射率之和 $\\rho_1 + \\rho_2$ 进行归一化，它会缩放为 $k(\\rho_1 + \\rho_2)$。\n\n将指数 $I$ 构建为差值与和值的比率，我们得到：\n$$I = \\frac{k\\rho_1 - k\\rho_2}{k\\rho_1 + k\\rho_2} = \\frac{k(\\rho_1 - \\rho_2)}{k(\\rho_1 + \\rho_2)} = \\frac{\\rho_1 - \\rho_2}{\\rho_1 + \\rho_2}$$\n这是归一化差异指数（NDI）的一般形式。它的取值范围在 $-1$ 和 $1$ 之间，是无量纲的，并且对输入反射率的线性缩放保持不变，因此满足两个设计原则。\n\n接下来，我们将此NDI形式应用于水体探测的特定情况。问题指出，由于在较长波长处的强分子吸收，液态水在光谱的绿光部分的反射率相对于近红外（NIR）和短波红外（SWIR）部分要高。\n\n由 McFeeters (1996) 最初提出的归一化差异水体指数（NDWI）使用绿光和近红外波段。选择绿光波段作为“明亮”波段（$\\rho_1$），近红外波段作为“暗淡”波段（$\\rho_2$），以最大化水体相对于陆地特征的对比度。因此，NDWI的表达式为：\n$$\\text{NDWI} = \\frac{\\rho_{\\text{green}} - \\rho_{\\text{NIR}}}{\\rho_{\\text{green}} + \\rho_{\\text{NIR}}}$$\n\n由 Xu (2006) 提出的修正归一化差异水体指数（MNDWI）旨在进一步增强这种对比度。它基于一个物理原理，即水在短波红外波段的吸收甚至比在近红外波段更强。因此，用短波红外波段替换近红外波段应能增加水体的光谱可分性。在此公式中，绿光波段仍然是“明亮”波段（$\\rho_1$），而短波红外波段成为“暗淡”波段（$\\rho_2$）。MNDWI的表达式为：\n$$\\text{MNDWI} = \\frac{\\rho_{\\text{green}} - \\rho_{\\text{SWIR}}}{\\rho_{\\text{green}} + \\rho_{\\text{SWIR}}}$$\n\n现在，我们使用给定的像素反射率值来计算这些指数：$\\rho_{\\text{green}} = 0.08$，$\\rho_{\\text{NIR}} = 0.02$，$\\rho_{\\text{SWIR}} = 0.01$。\n\n对于 NDWI：\n$$\\text{NDWI} = \\frac{0.08 - 0.02}{0.08 + 0.02} = \\frac{0.06}{0.10} = 0.6$$\n四舍五入到四位有效数字，我们得到 $0.6000$。\n\n对于 MNDWI：\n$$\\text{MNDWI} = \\frac{0.08 - 0.01}{0.08 + 0.01} = \\frac{0.07}{0.09} = \\frac{7}{9} \\approx 0.77777...$$\n四舍五入到四位有效数字，我们得到 $0.7778$。\n\n最后，我们必须论证哪个指数能产生更强的对比度。归一化差异指数值的大小是衡量一个波段相对于另一个波段的相对优势的度量。对于水体，更高的正指数值表示更强、更清晰的水体信号。我们计算出的值为 $\\text{NDWI} = 0.6000$ 和 $\\text{MNDWI} = 0.7778$。\n\n由于 $0.7778 > 0.6000$，对于这个水体像素，MNDWI 产生的值明显高于 NDWI。这意味着 MNDWI 为开放水体提供了更强的对比度。这种对比度增强的原因在于水的光谱特性和指数的数学结构。绿光和短波红外之间的反射率差异（$0.08 - 0.01 = 0.07$）大于绿光和近红外之间的差异（$0.08 - 0.02 = 0.06$）。同时，MNDWI 分母中的反射率之和（$0.08 + 0.01 = 0.09$）小于 NDWI 的分母（$0.08 + 0.02 = 0.10$）。更大的分子和更小的分母共同导致了 MNDWI 具有更大的指数值。这个更大的数值增强了水体像素与非水体像素（通常具有较低或负的指数值）的可分性，从而为开放水体的探测和制图提供了更强的对比度。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6000  0.7778\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "遥感中的一个关键挑战是如何将目标地物与其他光谱相似的物质区分开来。本练习将探讨水体指数在处理一种常见的“伪阳性”来源——城市建成区时的表现。通过将 $NDWI$ 和 $MNDWI$ 应用于一个屋顶像元，您将从定量角度理解为何 $MNDWI$ 在抑制建成区信号方面通常更优越，从而在混合的城市-水体环境中生成更纯净的水体图 。",
            "id": "3865877",
            "problem": "一个城市-植被-水体测绘工作流使用基于地表反射率构建的归一化差异类指数。考虑一个城市屋顶像素，其在绿光、近红外和短波红外波段具有光谱上合理且经传感器校正的反射率：$\\rho_{\\text{green}}=0.12$，$\\rho_{\\text{NIR}}=0.30$，以及$\\rho_{\\text{SWIR}}=0.25$。开阔水体通常在近红外和短波红外波段相对于绿光波段表现出强烈的吸收，而大多数人造地物在近红外和短波红外波段表现出中到高反射率。\n\n归一化差异水体指数 (NDWI) 和修正归一化差异水体指数 (MNDWI) 都是通过对一对旨在最大化相对水体对比度的波段应用归一化差异算子来构建的。对于 NDWI，该算子对比绿光波段与近红外波段；而对于 MNDWI，它对比绿光波段与短波红外波段。\n\n根据归一化差异结构的一般原理和所述的光谱行为（除了水体由大于零的值识别这一常规做法外，不假设任何特定的阈值），对上述屋顶像素执行以下操作：\n- 根据适当波段对之间归一化差异的第一性原理，构建 NDWI 和 MNDWI 的函数形式，并计算给定反射率下它们的值。\n- 将标量 $\\Delta$ 定义为修正指数值与原始指数值之差，$\\Delta=\\mathrm{MNDWI}-\\mathrm{NDWI}$，并计算 $\\Delta$。\n- 根据 $\\Delta$ 的符号和大小，解释当使用零阈值来划分水体时，哪个指数能减少人造地物像素的假阳性。\n\n将最终答案表示为 $\\Delta$ 的精确有理数形式。不要四舍五入。",
            "solution": "我们从遥感中广泛使用的一般归一化差异结构开始。对于任意两个波段 $a$ 和 $b$，一个旨在反映相对对比度的归一化差异指数 $I$ 写为\n$$\nI(a,b) \\equiv \\frac{\\rho_{a}-\\rho_{b}}{\\rho_{a}+\\rho_{b}},\n$$\n其中 $\\rho_{a}$ 和 $\\rho_{b}$ 是波段 $a$ 和 $b$ 的地表反射率。该结构产生的值在 $(-1,1)$ 范围内，并强调了两个波段之间差异的符号和相对大小。\n\n归一化差异水体指数 (NDWI) 旨在通过对比绿光波段与近红外波段来突出水体，因为由于水对近红外的强烈吸收，开阔水体在绿光波段的反射率可能相对高于近红外波段。使用归一化差异结构，令 $a=\\text{green}$ 和 $b=\\text{NIR}$，\n$$\n\\mathrm{NDWI}=\\frac{\\rho_{\\text{green}}-\\rho_{\\text{NIR}}}{\\rho_{\\text{green}}+\\rho_{\\text{NIR}}}.\n$$\n修正归一化差异水体指数 (MNDWI) 用短波红外波段取代了近红外波段，利用了水在短波红外波段更强的吸收特性，以及人造地物在短波红外波段通常更强的反射特性。因此，\n$$\n\\mathrm{MNDWI}=\\frac{\\rho_{\\text{green}}-\\rho_{\\text{SWIR}}}{\\rho_{\\text{green}}+\\rho_{\\text{SWIR}}}.\n$$\n\n对于给定的屋顶像素，我们使用 $\\rho_{\\text{green}}=0.12$，$\\rho_{\\text{NIR}}=0.30$ 和 $\\rho_{\\text{SWIR}}=0.25$ 来计算这些值。\n\n首先，计算 $\\mathrm{NDWI}$：\n$$\n\\mathrm{NDWI}=\\frac{0.12-0.30}{0.12+0.30}=\\frac{-0.18}{0.42}=-\\frac{18}{42}=-\\frac{3}{7}.\n$$\n\n接下来，计算 $\\mathrm{MNDWI}$：\n$$\n\\mathrm{MNDWI}=\\frac{0.12-0.25}{0.12+0.25}=\\frac{-0.13}{0.37}=-\\frac{13}{37}.\n$$\n\n现在将标量 $\\Delta$ 定义为差值 $\\Delta=\\mathrm{MNDWI}-\\mathrm{NDWI}$ 并精确计算它：\n$$\n\\Delta=\\left(-\\frac{13}{37}\\right)-\\left(-\\frac{3}{7}\\right)=\\frac{3}{7}-\\frac{13}{37}=\\frac{3\\cdot 37-13\\cdot 7}{259}=\\frac{111-91}{259}=\\frac{20}{259}.\n$$\n\n为了解释在零阈值下哪个指数能减少人造地物的假阳性，我们检查其符号和大小。零阈值意味着当指数大于零时，表示为水体。对于该屋顶像素，两个计算值都为负，因此在此阈值下，两者都不会被误判为水体。然而，值更负的指数在负数一侧离零更远，因此对于人造地物像素具有更大的防止假阳性的安全边际。\n\n我们可以通过直接考虑差值来将其形式化：\n$$\n\\Delta=\\mathrm{MNDWI}-\\mathrm{NDWI}=\\frac{20}{259}>0,\n$$\n这意味着对于该像素，$\\mathrm{MNDWI}>\\mathrm{NDWI}$。由于两者都为负，这意味着 $\\mathrm{MNDWI}$ 比 $\\mathrm{NDWI}$ 更接近于零（负得更少）。因此，在零阈值下，$\\mathrm{NDWI}$ 提供了更大的负边际，从而比 $\\mathrm{MNDWI}$ 更能减少给定屋顶的假阳性。\n\n这个针对特定像素的结论也可以与差值的一般表达式联系起来。设 $g=\\rho_{\\text{green}}$，$n=\\rho_{\\text{NIR}}$，且 $s=\\rho_{\\text{SWIR}}$。那么\n$$\n\\mathrm{MNDWI}-\\mathrm{NDWI}=\\frac{g-s}{g+s}-\\frac{g-n}{g+n}=\\frac{2g(n-s)}{(g+s)(g+n)}.\n$$\n分母为正，因此 $\\Delta$ 的符号与 $n-s$ 的符号相同。对于给定的屋顶，$n-s=0.30-0.25>0$，因此 $\\Delta>0$，这证实了 $\\mathrm{MNDWI}$ 的负值比 $\\mathrm{NDWI}$ 小，因而在零阈值下提供了更小的防止假阳性的安全边际。相反，对于 $\\rho_{\\text{SWIR}}$ 超过 $\\rho_{\\text{NIR}}$ 的人造地物，则会有 $\\Delta0$，$\\mathrm{MNDWI}$ 会产生更负的值，并相对于 $\\mathrm{NDWI}$ 减少假阳性——这是在城市环境中使用修正指数的一个常见动机。",
            "answer": "$$\\boxed{\\frac{20}{259}}$$"
        },
        {
            "introduction": "生成水体图并非终点，评估其可靠性至关重要。本练习将从指数计算转向性能评估，采用一个存在显著类别不平衡的真实场景——这是水体作为少数类时的常见情况。您将计算包括总体精度、精确率、召回率和 F1 分数在内的几个关键指标，并在此过程中理解为何像 F1 分数这样的指标，比单独的总体精度能更有效地评估模型性能 。",
            "id": "3865867",
            "problem": "一项洪泛区测绘研究使用了根据多光谱卫星影像计算的修正归一化差异水体指数（MNDWI），通过阈值处理生成了二元水体掩膜。研究人员收集了一个独立的验证像素分层随机样本，并将其目视标记为水体或非水体。考虑以下混淆矩阵计数（将水体视为正类）：\n\n- 参考水体像素：预测为水体 $=$ $900$，预测为非水体 $=$ $300$。\n- 参考非水体像素：预测为水体 $=$ $700$，预测为非水体 $=$ $18{,}100$。\n\n假设所有验证像素都是从底层空间过程中相互独立的抽样。仅使用基于混淆矩阵的统计分类基本定义，计算水体类别的以下性能指标：总体精度、精确率、召回率和F1分数。按$\\big[$总体精度、精确率、召回率、F1分数$\\big]$的顺序返回结果。将每个值四舍五入到四位有效数字。最后，基于第一性原理，且不使用任何领域特定的简化方法，讨论在存在严重类别不平衡的情况下，哪项指标对于评估MNDWI衍生的水体地图最具信息量，并根据指标的定义和所提供的数据来证明你的理由。",
            "solution": "该问题要求计算一个二元分类任务的四个标准性能指标，并批判性地讨论它们在严重类别不平衡场景下的效用。第一步是规范化混淆矩阵中给出的计数。\n\n设“水体”类为正类，“非水体”类为负类。提供的计数可定义如下：\n-   真阳性 ($TP$)：参考为水体，预测为水体。$TP = 900$。\n-   假阴性 ($FN$)：参考为水体，预测为非水体。$FN = 300$。\n-   假阳性 ($FP$)：参考为非水体，预测为水体。$FP = 700$。\n-   真阴性 ($TN$)：参考为非水体，预测为非水体。$TN = 18{,}100$。\n\n验证像素的总数 $N$ 是这些计数的总和：\n$$N = TP + FN + FP + TN = 900 + 300 + 700 + 18{,}100 = 20{,}000$$\n\n有了这些基本量，我们就可以计算所需的指标。\n\n**1. 总体精度 (OA)**\n总体精度衡量所有预测中正确的比例。其公式为：\n$$OA = \\frac{TP + TN}{TP + FN + FP + TN} = \\frac{TP + TN}{N}$$\n代入给定值：\n$$OA = \\frac{900 + 18{,}100}{20{,}000} = \\frac{19{,}000}{20{,}000} = 0.95$$\n四舍五入到四位有效数字，即 $0.9500$。\n\n**2. 精确率 (P)**\n精确率（P），对于正类，衡量正类预测中实际正确的比例。它也被称为用户精度。其公式为：\n$$P = \\frac{TP}{TP + FP}$$\n代入给定值：\n$$P = \\frac{900}{900 + 700} = \\frac{900}{1{,}600} = \\frac{9}{16} = 0.5625$$\n该值已有四位有效数字。\n\n**3. 召回率 (R)**\n召回率（R），对于正类，衡量实际正类中被正确识别的比例。它也被称为灵敏度或生产者精度。其公式为：\n$$R = \\frac{TP}{TP + FN}$$\n代入给定值：\n$$R = \\frac{900}{900 + 300} = \\frac{900}{1{,}200} = \\frac{3}{4} = 0.75$$\n四舍五入到四位有效数字，即 $0.7500$。\n\n**4. F1分数 (F1)**\nF1分数是精确率和召回率的调和平均数。它提供了一个平衡这两个指标的单一分数。其公式为：\n$$F1 = 2 \\times \\frac{P \\times R}{P + R}$$\n使用基本计数的等效公式是：\n$$F1 = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN}$$\n使用后一个公式直接计算：\n$$F1 = \\frac{2 \\times 900}{2 \\times 900 + 700 + 300} = \\frac{1{,}800}{1{,}800 + 1{,}000} = \\frac{1{,}800}{2{,}800} = \\frac{18}{28} = \\frac{9}{14}$$\n换算成小数，约为 $0.64285714...$。四舍五入到四位有效数字，F1分数为 $0.6429$。\n\n计算出的指标是：总体精度 $= 0.9500$，精确率 $= 0.5625$，召回率 $= 0.7500$，F1分数 $= 0.6429$。\n\n**关于类别不平衡下指标信息量的讨论**\n\n该问题表现出严重的类别不平衡。实际水体像素（正类）的数量是 $P_{actual} = TP + FN = 900 + 300 = 1{,}200$。实际非水体像素（负类）的数量是 $N_{actual} = FP + TN = 700 + 18{,}100 = 18{,}800$。负类与正类的比率是 $18{,}800 / 1{,}200 \\approx 15.7$。\n\n-   **总体精度 (OA)**：OA为 $0.9500$，看起来非常高。然而，在类别不平衡的情况下，这个指标具有误导性。公式 $OA = (TP + TN) / N$ 受到多数类性能的严重影响。在这个问题中，真阴性（$TN = 18{,}100$）的数量在分子中占主导地位。一个总是预测多数类（“非水体”）的朴素模型将达到 $N_{actual} / N = 18{,}800 / 20{,}000 = 0.94$ 的精度。MNDWI模型的精度 $0.95$ 仅比这个平凡基线有微不足道的提升。因此，总体精度对于评估模型识别少数“水体”类的能力来说，不是一个信息量丰富的指标。\n\n-   **精确率 (P) 和召回率 (R)**：这些指标专门评估正类的性能，使其对大量的真阴性不敏感。\n    -   精确率 ($P = 0.5625$) 回答了这样一个问题：“在所有被预测为水体的像素中，实际是水体的比例是多少？”它惩罚假阳性 ($FP$)。低精确率表示大量的错误警报。\n    -   召回率 ($R = 0.7500$) 回答了这样一个问题：“在所有实际的水体像素中，模型识别出了多少比例？”它惩罚假阴性 ($FN$)。低召回率表示许多实际的水体像素被漏掉了。\n    这两个指标都信息量丰富，但描述了性能的不同方面。在优先考虑精确率还是召回率之间的选择，取决于特定应用中假阳性与假阴性的相对成本（例如，洪水风险评估与应急响应）。\n\n-   **F1分数**：F1分数是精确率和召回率的调和平均数。调和平均数对较低的值给予更多的权重。因此，只有当精确率和召回率都很高时，F1分数才会高。它将来自假阳性和假阴性的信息合成为一个单一的数字。在这种情况下，需要在中等的精确率（$0.5625$）和较好的召回率（$0.7500$）之间进行权衡。F1分数（$0.6429$）比过于乐观的总体精度，为模型在水体类别上的性能提供了一个更平衡和现实的评估。\n\n**讨论结论**：在存在严重类别不平衡的情况下，总体精度是一个糟糕且具有误导性的性能指标。精确率和召回率的信息量要大得多，因为它们关注的是我们感兴趣的少数类。**F1分数**可以说是用于一般性评估的信息量最丰富的单一指标，因为它将精确率和召回率结合成一个对类别不平衡具有鲁棒性的平衡度量。它有效地总结了模型处理正类的能力，同时考虑了与该类别相关的两种分类错误（$FP$ 和 $FN$）。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9500  0.5625  0.7500  0.6429\n\\end{pmatrix}\n}\n$$"
        }
    ]
}