{
    "hands_on_practices": [
        {
            "introduction": "The foundation of image-to-map registration lies in defining a precise geometric transformation that aligns image pixels to map coordinates. The affine model is a fundamental tool for this, capable of representing translation, scaling, rotation, and shear. This practice provides a hands-on exercise in deriving a unique affine transform from a minimal set of three non-collinear control points, a core skill in photogrammetry and remote sensing. By working from first principles, you will solidify your understanding of how image and map spaces are geometrically linked .",
            "id": "3821081",
            "problem": "A small Unmanned Aerial Vehicle (UAV) image must be registered to a local map for floodplain habitat modeling. Three non-collinear Ground Control Points (GCPs) are available as pixel coordinates in the image and corresponding coordinates in a local map reference frame. The image coordinates (in pixels) are: $\\mathbf{p}_{I,1} = \\begin{pmatrix}120 \\\\ 80\\end{pmatrix}$, $\\mathbf{p}_{I,2} = \\begin{pmatrix}420 \\\\ 80\\end{pmatrix}$, and $\\mathbf{p}_{I,3} = \\begin{pmatrix}120 \\\\ 380\\end{pmatrix}$. The corresponding map coordinates (in meters) are: $\\mathbf{p}_{M,1} = \\begin{pmatrix}325 \\\\ -44\\end{pmatrix}$, $\\mathbf{p}_{M,2} = \\begin{pmatrix}925 \\\\ -344\\end{pmatrix}$, and $\\mathbf{p}_{M,3} = \\begin{pmatrix}625 \\\\ 256\\end{pmatrix}$.\n\nAssume a planar affine image-to-map model $\\mathbf{p}_{M} = A\\,\\mathbf{p}_{I} + \\mathbf{t}$, where $A \\in \\mathbb{R}^{2 \\times 2}$ and $\\mathbf{t} \\in \\mathbb{R}^{2}$. Using only the core definition of an affine map and the linear independence of point differences implied by non-collinearity, derive the unique affine transform $(A,\\mathbf{t})$ that maps the three image points to their corresponding map points. Then, formally validate invertibility by evaluating $\\det(A)$ and interpreting it as the local area-scaling factor under the registration.\n\nProvide as your final answer the exact numerical value of $\\det(A)$. Express the determinant as a pure number corresponding to meters squared per pixel squared, and do not include any unit symbol in your answer. No rounding is required; report the exact value.",
            "solution": "The problem requires the determination of a unique affine transformation $(A, \\mathbf{t})$ that maps a set of three non-collinear image points to a corresponding set of map points. The transformation is defined by the equation $\\mathbf{p}_{M} = A\\,\\mathbf{p}_{I} + \\mathbf{t}$, where $\\mathbf{p}_{I}$ are image coordinates, $\\mathbf{p}_{M}$ are map coordinates, $A \\in \\mathbb{R}^{2 \\times 2}$ is the linear transformation matrix, and $\\mathbf{t} \\in \\mathbb{R}^{2}$ is the translation vector.\n\nThe given corresponding points are:\nImage coordinates (in pixels):\n$$ \\mathbf{p}_{I,1} = \\begin{pmatrix}120 \\\\ 80\\end{pmatrix}, \\quad \\mathbf{p}_{I,2} = \\begin{pmatrix}420 \\\\ 80\\end{pmatrix}, \\quad \\mathbf{p}_{I,3} = \\begin{pmatrix}120 \\\\ 380\\end{pmatrix} $$\nMap coordinates (in meters):\n$$ \\mathbf{p}_{M,1} = \\begin{pmatrix}325 \\\\ -44\\end{pmatrix}, \\quad \\mathbf{p}_{M,2} = \\begin{pmatrix}925 \\\\ -344\\end{pmatrix}, \\quad \\mathbf{p}_{M,3} = \\begin{pmatrix}625 \\\\ 256\\end{pmatrix} $$\n\nThe affine relationship holds for each pair of corresponding points:\n$1.$ $\\mathbf{p}_{M,1} = A\\mathbf{p}_{I,1} + \\mathbf{t}$\n$2.$ $\\mathbf{p}_{M,2} = A\\mathbf{p}_{I,2} + \\mathbf{t}$\n$3.$ $\\mathbf{p}_{M,3} = A\\mathbf{p}_{I,3} + \\mathbf{t}$\n\nTo isolate the matrix $A$, we can eliminate the translation vector $\\mathbf{t}$ by considering the differences between points. Subtracting equation ($1$) from equations ($2$) and ($3$) yields:\n$$ \\mathbf{p}_{M,2} - \\mathbf{p}_{M,1} = (A\\mathbf{p}_{I,2} + \\mathbf{t}) - (A\\mathbf{p}_{I,1} + \\mathbf{t}) = A(\\mathbf{p}_{I,2} - \\mathbf{p}_{I,1}) $$\n$$ \\mathbf{p}_{M,3} - \\mathbf{p}_{M,1} = (A\\mathbf{p}_{I,3} + \\mathbf{t}) - (A\\mathbf{p}_{I,1} + \\mathbf{t}) = A(\\mathbf{p}_{I,3} - \\mathbf{p}_{I,1}) $$\n\nLet us define the difference vectors:\nIn the image space:\n$$ \\Delta\\mathbf{p}_{I,21} = \\mathbf{p}_{I,2} - \\mathbf{p}_{I,1} = \\begin{pmatrix}420 - 120 \\\\ 80 - 80\\end{pmatrix} = \\begin{pmatrix}300 \\\\ 0\\end{pmatrix} $$\n$$ \\Delta\\mathbf{p}_{I,31} = \\mathbf{p}_{I,3} - \\mathbf{p}_{I,1} = \\begin{pmatrix}120 - 120 \\\\ 380 - 80\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 300\\end{pmatrix} $$\nIn the map space:\n$$ \\Delta\\mathbf{p}_{M,21} = \\mathbf{p}_{M,2} - \\mathbf{p}_{M,1} = \\begin{pmatrix}925 - 325 \\\\ -344 - (-44)\\end{pmatrix} = \\begin{pmatrix}600 \\\\ -300\\end{pmatrix} $$\n$$ \\Delta\\mathbf{p}_{M,31} = \\mathbf{p}_{M,3} - \\mathbf{p}_{M,1} = \\begin{pmatrix}625 - 325 \\\\ 256 - (-44)\\end{pmatrix} = \\begin{pmatrix}300 \\\\ 300\\end{pmatrix} $$\n\nThese two vector equations, $\\Delta\\mathbf{p}_{M,21} = A \\Delta\\mathbf{p}_{I,21}$ and $\\Delta\\mathbf{p}_{M,31} = A \\Delta\\mathbf{p}_{I,31}$, can be combined into a single matrix equation by forming matrices whose columns are these difference vectors:\n$$ \\begin{pmatrix} \\Delta\\mathbf{p}_{M,21} & \\Delta\\mathbf{p}_{M,31} \\end{pmatrix} = A \\begin{pmatrix} \\Delta\\mathbf{p}_{I,21} & \\Delta\\mathbf{p}_{I,31} \\end{pmatrix} $$\nLet $P_M = \\begin{pmatrix} \\Delta\\mathbf{p}_{M,21} & \\Delta\\mathbf{p}_{M,31} \\end{pmatrix}$ and $P_I = \\begin{pmatrix} \\Delta\\mathbf{p}_{I,21} & \\Delta\\mathbf{p}_{I,31} \\end{pmatrix}$. The equation is $P_M = A P_I$.\nSubstituting the calculated values:\n$$ \\begin{pmatrix} 600 & 300 \\\\ -300 & 300 \\end{pmatrix} = A \\begin{pmatrix} 300 & 0 \\\\ 0 & 300 \\end{pmatrix} $$\nThe problem states that the points are non-collinear, which implies that the difference vectors in each space are linearly independent. This ensures that the matrix $P_I$ is invertible. We can solve for $A$ by post-multiplying by the inverse of $P_I$:\n$$ A = P_M P_I^{-1} $$\nFirst, we find $P_I^{-1}$:\n$$ P_I = \\begin{pmatrix} 300 & 0 \\\\ 0 & 300 \\end{pmatrix} = 300 \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = 300 I $$\nThe inverse is:\n$$ P_I^{-1} = \\frac{1}{300} I^{-1} = \\frac{1}{300} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{300} & 0 \\\\ 0 & \\frac{1}{300} \\end{pmatrix} $$\nNow, we compute $A$:\n$$ A = \\begin{pmatrix} 600 & 300 \\\\ -300 & 300 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{300} & 0 \\\\ 0 & \\frac{1}{300} \\end{pmatrix} = \\begin{pmatrix} 600 \\cdot \\frac{1}{300} & 300 \\cdot \\frac{1}{300} \\\\ -300 \\cdot \\frac{1}{300} & 300 \\cdot \\frac{1}{300} \\end{pmatrix} = \\begin{pmatrix} 2 & 1 \\\\ -1 & 1 \\end{pmatrix} $$\nHaving found $A$, we can find $\\mathbf{t}$ using the first point correspondence: $\\mathbf{t} = \\mathbf{p}_{M,1} - A\\mathbf{p}_{I,1}$.\n$$ \\mathbf{t} = \\begin{pmatrix} 325 \\\\ -44 \\end{pmatrix} - \\begin{pmatrix} 2 & 1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} 120 \\\\ 80 \\end{pmatrix} = \\begin{pmatrix} 325 \\\\ -44 \\end{pmatrix} - \\begin{pmatrix} 2(120) + 1(80) \\\\ -1(120) + 1(80) \\end{pmatrix} $$\n$$ \\mathbf{t} = \\begin{pmatrix} 325 \\\\ -44 \\end{pmatrix} - \\begin{pmatrix} 240 + 80 \\\\ -120 + 80 \\end{pmatrix} = \\begin{pmatrix} 325 \\\\ -44 \\end{pmatrix} - \\begin{pmatrix} 320 \\\\ -40 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ -4 \\end{pmatrix} $$\nThus, the unique affine transformation is specified by $A = \\begin{pmatrix} 2 & 1 \\\\ -1 & 1 \\end{pmatrix}$ and $\\mathbf{t} = \\begin{pmatrix} 5 \\\\ -4 \\end{pmatrix}$.\n\nThe final step is to validate the invertibility of the transformation and interpret the determinant of $A$. A transformation is invertible if and only if its linear part, represented by matrix $A$, is invertible. This is true if and only if $\\det(A) \\ne 0$.\nLet's compute the determinant of $A$:\n$$ \\det(A) = \\det\\begin{pmatrix} 2 & 1 \\\\ -1 & 1 \\end{pmatrix} = (2)(1) - (1)(-1) = 2 + 1 = 3 $$\nSince $\\det(A) = 3 \\ne 0$, the matrix $A$ is invertible, and therefore the affine transformation is invertible. There exists a unique inverse transformation that maps points from the map back to the image.\n\nThe determinant of the transformation matrix $A$ represents the ratio of area elements between the output space (map) and the input space (image). In this context, the units of the image space are pixels (px) and the units of the map space are meters (m). The determinant, $\\det(A)$, has units of meters squared per pixel squared, i.e., $\\text{m}^2/\\text{px}^2$.\nThe value $\\det(A) = 3$ signifies that a unit area of $1$ square pixel in the image corresponds to an area of $3$ square meters on the map. The positive sign of the determinant indicates that the transformation is orientation-preserving, meaning it does not include a reflection.\nThe final answer required is the numerical value of $\\det(A)$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "While geometric models define the \"how\" of registration, finding the correct correspondences between images requires a robust measure of similarity. Simple intensity comparisons are often unreliable due to variations in lighting and sensor response. This exercise explores Normalized Cross-Correlation ($NCC$), a powerful metric that is invariant to linear changes in brightness and contrast. You will calculate the $NCC$ for two hypothetical patches related by a radiometric transform to demonstrate this invariance firsthand, and then derive a general expression for $NCC$ under a noisy model to understand its statistical underpinnings .",
            "id": "3821077",
            "problem": "A pair of coarsely co-registered image patches from two satellite overpasses of the same region is given as digital numbers (DN). Let the first patch be\n$$\nA \\;=\\; \\begin{pmatrix}\n12 & 14 & 16 \\\\\n14 & 16 & 18 \\\\\n16 & 18 & 20\n\\end{pmatrix},\n$$\nand suppose the second patch is related to the first by a linear radiometric transform due to sensor gain and offset variations,\n$$\nB \\;=\\; a\\,A + b\\,\\mathbf{1},\n$$\nwith $a = 2$ and $b = 10$, where $\\mathbf{1}$ denotes the matrix with all entries equal to $1$. Treat each $3 \\times 3$ patch as a vector by stacking its entries in a fixed order.\n\nStarting only from the core definitions of sample mean, centering, inner product, and variance, and the definition of Normalized Cross-Correlation (NCC) as the cosine of the angle between the zero-mean vectors, do the following:\n\n1. Compute the NCC between the two patches by explicitly centering both vectors (subtracting their sample means), computing their inner product, and normalizing by the product of their Euclidean norms. Provide the final NCC value as a pure number. Round your answer to four significant figures.\n\n2. Using the core definitions of covariance, variance, and independence, consider the general photometric model $Y = a X + b + N$ for corresponding pixel intensities, where $X$ is a zero-mean random variable with variance $\\sigma_{X}^{2}$, $a$ and $b$ are constants, and $N$ is an additive, zero-mean noise term independent of $X$ with variance $\\sigma_{N}^{2}$. Derive an analytic expression for the expected NCC between $X$ and $Y$ when both are centered by their means and normalized by their standard deviations. Your derivation must begin from the definitions of covariance and variance and the independence of $X$ and $N$; do not assume any specialized registration formulas.\n\nAlthough you must carry out both tasks in your solution, the final answer to report is the NCC computed in part $1$, rounded to four significant figures. The NCC is dimensionless; no units are required.",
            "solution": "This problem consists of two parts. The first part requires the computation of the Normalized Cross-Correlation (NCC) for two given image patches. The second part requires the derivation of a general analytic expression for the expected NCC under a noisy linear model.\n\n### Part 1: NCC Computation\n\nThe two image patches are given by a base patch $A$ and a transformed patch $B$.\nThe first patch is:\n$$\nA = \\begin{pmatrix}\n12 & 14 & 16 \\\\\n14 & 16 & 18 \\\\\n16 & 18 & 20\n\\end{pmatrix}\n$$\nThe second patch $B$ is related to $A$ by the linear radiometric transform $B = aA + b\\mathbf{1}$, with $a=2$ and $b=10$. The matrix $\\mathbf{1}$ is the $3 \\times 3$ matrix of ones.\nFirst, we compute the matrix $B$:\n$$\nB = 2 \\begin{pmatrix}\n12 & 14 & 16 \\\\\n14 & 16 & 18 \\\\\n16 & 18 & 20\n\\end{pmatrix} + 10 \\begin{pmatrix}\n1 & 1 & 1 \\\\\n1 & 1 & 1 \\\\\n1 & 1 & 1\n\\end{pmatrix} = \\begin{pmatrix}\n24 & 28 & 32 \\\\\n28 & 32 & 36 \\\\\n32 & 36 & 40\n\\end{pmatrix} + \\begin{pmatrix}\n10 & 10 & 10 \\\\\n10 & 10 & 10 \\\\\n10 & 10 & 10\n\\end{pmatrix} = \\begin{pmatrix}\n34 & 38 & 42 \\\\\n38 & 42 & 46 \\\\\n42 & 46 & 50\n\\end{pmatrix}\n$$\nTo compute the NCC, we treat the $3 \\times 3$ patches as $9$-element vectors. Let's denote these vectors as $\\vec{A}$ and $\\vec{B}$, formed by stacking the rows of the matrices.\n$$\n\\vec{A} = (12, 14, 16, 14, 16, 18, 16, 18, 20)^T\n$$\n$$\n\\vec{B} = (34, 38, 42, 38, 42, 46, 42, 46, 50)^T\n$$\nThe NCC is defined as the cosine of the angle between the zero-mean (centered) versions of these vectors. Let the centered vectors be $\\vec{\\tilde{A}}$ and $\\vec{\\tilde{B}}$.\n\nFirst, we compute the sample means, $\\mu_A$ and $\\mu_B$.\nThe sum of elements in $\\vec{A}$ is:\n$$\n\\sum_{i=1}^{9} A_i = 12+14+16+14+16+18+16+18+20 = 144\n$$\nThe mean of $\\vec{A}$ is:\n$$\n\\mu_A = \\frac{1}{9} \\sum_{i=1}^{9} A_i = \\frac{144}{9} = 16\n$$\nThe sum of elements in $\\vec{B}$ is:\n$$\n\\sum_{i=1}^{9} B_i = 34+38+42+38+42+46+42+46+50 = 378\n$$\nThe mean of $\\vec{B}$ is:\n$$\n\\mu_B = \\frac{1}{9} \\sum_{i=1}^{9} B_i = \\frac{378}{9} = 42\n$$\nNotice that $\\mu_B = a\\mu_A + b = 2(16) + 10 = 32 + 10 = 42$, which is consistent.\n\nNext, we compute the centered vectors by subtracting the mean from each element.\n$$\n\\vec{\\tilde{A}} = \\vec{A} - \\mu_A \\vec{1} = (12-16, 14-16, 16-16, 14-16, 16-16, 18-16, 16-16, 18-16, 20-16)^T\n$$\n$$\n\\vec{\\tilde{A}} = (-4, -2, 0, -2, 0, 2, 0, 2, 4)^T\n$$\n$$\n\\vec{\\tilde{B}} = \\vec{B} - \\mu_B \\vec{1} = (34-42, 38-42, 42-42, 38-42, 42-42, 46-42, 42-42, 46-42, 50-42)^T\n$$\n$$\n\\vec{\\tilde{B}} = (-8, -4, 0, -4, 0, 4, 0, 4, 8)^T\n$$\nWe can observe that $\\vec{\\tilde{B}} = 2\\vec{\\tilde{A}}$, which follows from the linear relationship: $\\vec{\\tilde{B}} = \\vec{B} - \\mu_B \\vec{1} = (a\\vec{A} + b\\vec{1}) - (a\\mu_A+b)\\vec{1} = a\\vec{A} - a\\mu_A\\vec{1} = a(\\vec{A} - \\mu_A\\vec{1}) = a\\vec{\\tilde{A}}$.\n\nThe NCC is given by the formula:\n$$\n\\text{NCC} = \\frac{\\vec{\\tilde{A}} \\cdot \\vec{\\tilde{B}}}{\\|\\vec{\\tilde{A}}\\| \\|\\vec{\\tilde{B}}\\|}\n$$\nWe compute the inner product of the centered vectors:\n$$\n\\vec{\\tilde{A}} \\cdot \\vec{\\tilde{B}} = (-4)(-8) + (-2)(-4) + (0)(0) + (-2)(-4) + (0)(0) + (2)(4) + (0)(0) + (2)(4) + (4)(8)\n$$\n$$\n\\vec{\\tilde{A}} \\cdot \\vec{\\tilde{B}} = 32 + 8 + 0 + 8 + 0 + 8 + 0 + 8 + 32 = 96\n$$\nNext, we compute the Euclidean norms of the centered vectors.\nThe squared norm of $\\vec{\\tilde{A}}$ is:\n$$\n\\|\\vec{\\tilde{A}}\\|^2 = (-4)^2 + (-2)^2 + 0^2 + (-2)^2 + 0^2 + 2^2 + 0^2 + 2^2 + 4^2\n$$\n$$\n\\|\\vec{\\tilde{A}}\\|^2 = 16 + 4 + 0 + 4 + 0 + 4 + 0 + 4 + 16 = 48\n$$\nSo, $\\|\\vec{\\tilde{A}}\\| = \\sqrt{48}$.\nSince $\\vec{\\tilde{B}} = 2\\vec{\\tilde{A}}$, its norm is $\\|\\vec{\\tilde{B}}\\| = \\|2\\vec{\\tilde{A}}\\| = |2|\\|\\vec{\\tilde{A}}\\| = 2\\sqrt{48}$.\nThe squared norm of $\\vec{\\tilde{B}}$ is:\n$$\n\\|\\vec{\\tilde{B}}\\|^2 = (-8)^2 + (-4)^2 + 0^2 + (-4)^2 + 0^2 + 4^2 + 0^2 + 4^2 + 8^2\n$$\n$$\n\\|\\vec{\\tilde{B}}\\|^2 = 64 + 16 + 0 + 16 + 0 + 16 + 0 + 16 + 64 = 192\n$$\nSo, $\\|\\vec{\\tilde{B}}\\| = \\sqrt{192} = \\sqrt{4 \\times 48} = 2\\sqrt{48}$.\n\nNow, we can compute the NCC:\n$$\n\\text{NCC} = \\frac{96}{\\sqrt{48} \\times \\sqrt{192}} = \\frac{96}{\\sqrt{48 \\times 192}} = \\frac{96}{\\sqrt{9216}} = \\frac{96}{96} = 1\n$$\nAlternatively, using the relationship $\\vec{\\tilde{B}} = 2\\vec{\\tilde{A}}$:\n$$\n\\text{NCC} = \\frac{\\vec{\\tilde{A}} \\cdot (2\\vec{\\tilde{A}})}{\\|\\vec{\\tilde{A}}\\| \\|2\\vec{\\tilde{A}}\\|} = \\frac{2(\\vec{\\tilde{A}} \\cdot \\vec{\\tilde{A}})}{2\\|\\vec{\\tilde{A}}\\| \\|\\vec{\\tilde{A}}\\|} = \\frac{\\|\\vec{\\tilde{A}}\\|^2}{\\|\\vec{\\tilde{A}}\\|^2} = 1\n$$\nThe problem asks for the answer rounded to four significant figures. Thus, the value is $1.000$.\n\n### Part 2: Derivation of Expected NCC\n\nWe are given the photometric model $Y = aX + b + N$, where $X$ is a zero-mean random variable with variance $\\sigma_X^2$, and $N$ is an independent, zero-mean noise term with variance $\\sigma_N^2$. We need to find the expected NCC between $X$ and $Y$ after centering. The NCC for random variables is their correlation coefficient, $\\rho$.\n\nLet the centered variables be $X_c = X - E[X]$ and $Y_c = Y - E[Y]$.\nThe problem states $X$ is a zero-mean random variable, so $E[X] = 0$.\nThus, $X_c = X - 0 = X$.\nNext, we find the mean of $Y$:\n$$\nE[Y] = E[aX + b + N]\n$$\nBy linearity of expectation:\n$$\nE[Y] = aE[X] + E[b] + E[N]\n$$\nGiven $E[X]=0$ and $E[N]=0$, and $b$ is a constant:\n$$\nE[Y] = a(0) + b + 0 = b\n$$\nThe centered variable $Y_c$ is:\n$$\nY_c = Y - E[Y] = (aX + b + N) - b = aX + N\n$$\nThe correlation coefficient between $X_c$ and $Y_c$ (which are $X$ and $aX+N$) is defined as:\n$$\n\\rho_{X, Y_c} = \\frac{\\text{Cov}(X, Y_c)}{\\sigma_X \\sigma_{Y_c}}\n$$\nWe need to compute the covariance in the numerator and the standard deviations in the denominator.\n\nThe covariance is:\n$$\n\\text{Cov}(X, Y_c) = \\text{Cov}(X, aX+N)\n$$\nUsing the properties of covariance:\n$$\n\\text{Cov}(X, aX+N) = \\text{Cov}(X, aX) + \\text{Cov}(X, N)\n$$\n$$\n\\text{Cov}(X, aX) = a\\,\\text{Cov}(X, X) = a\\,\\text{Var}(X) = a\\sigma_X^2\n$$\nSince $X$ and $N$ are independent, their covariance is zero: $\\text{Cov}(X, N) = 0$.\nThus, the numerator is:\n$$\n\\text{Cov}(X, Y_c) = a\\sigma_X^2\n$$\nNow for the denominator. We have $\\sigma_X$, which is the standard deviation of $X$ (and $X_c$). We need to find $\\sigma_{Y_c}$, the standard deviation of $Y_c = aX + N$. This is found from its variance:\n$$\n\\sigma_{Y_c}^2 = \\text{Var}(Y_c) = \\text{Var}(aX+N)\n$$\nSince $X$ and $N$ are independent, $aX$ and $N$ are also independent. For independent variables, the variance of the sum is the sum of the variances:\n$$\n\\text{Var}(aX+N) = \\text{Var}(aX) + \\text{Var}(N)\n$$\n$$\n\\text{Var}(aX) = a^2\\text{Var}(X) = a^2\\sigma_X^2\n$$\nWe are given $\\text{Var}(N) = \\sigma_N^2$.\nSo, the variance of $Y_c$ is:\n$$\n\\sigma_{Y_c}^2 = a^2\\sigma_X^2 + \\sigma_N^2\n$$\nThe standard deviation of $Y_c$ is:\n$$\n\\sigma_{Y_c} = \\sqrt{a^2\\sigma_X^2 + \\sigma_N^2}\n$$\nFinally, we assemble the expression for the expected NCC:\n$$\n\\rho_{X, Y_c} = \\frac{a\\sigma_X^2}{\\sigma_X \\sqrt{a^2\\sigma_X^2 + \\sigma_N^2}}\n$$\n$$\n\\rho_{X, Y_c} = \\frac{a\\sigma_X}{\\sqrt{a^2\\sigma_X^2 + \\sigma_N^2}}\n$$\nThis is the analytic expression for the expected NCC. This result shows that the correlation is $1$ if $a>0$ and there is no noise ($\\sigma_N=0$), which is consistent with the result from Part 1.\n\nThe final answer required is the numerical result from Part 1.\nNCC = $1.000$ (rounded to four significant figures).",
            "answer": "$$\\boxed{1.000}$$"
        },
        {
            "introduction": "In many real-world applications, such as creating an orthophoto, registration is not just a 2D-to-2D problem but involves correcting for 3D terrain effects using a Digital Elevation Model (DEM). The accuracy of the final registered product is therefore critically dependent on the quality of the DEM. This practice delves into error propagation, guiding you through a first-order derivation of how vertical uncertainty in a DEM translates into planimetric (horizontal) error in an orthorectified image . This analysis, based on a simplified local terrain model, is crucial for understanding accuracy limitations and for planning remote sensing projects.",
            "id": "3821033",
            "problem": "In orthorectifying a near-nadir remote sensing image to a map using a Digital Elevation Model (DEM), a common first-order source of planimetric misregistration is the vertical uncertainty of the DEM. Consider a small terrain patch around a point whose elevation field is differentiable and can be locally approximated by a plane. Let the true terrain be locally modeled as $z(x,y) \\approx z_{0} + \\nabla z \\cdot \\boldsymbol{r}$, where $\\boldsymbol{r} = \\begin{pmatrix}x - x_{0} \\\\ y - y_{0}\\end{pmatrix}$ and $\\nabla z$ is the horizontal gradient of elevation. Assume an orthographic projection along the vertical (appropriate for small fields of view in map orthorectification), so that the orthoimage pixel $(x,y)$ is the horizontal location whose vertical projection intersects the DEM surface.\n\nSuppose the DEM has an unbiased, random vertical error with standard deviation $\\sigma_{Z}$, and assume the linear approximation is valid so that the first-order change in elevation induced by a small horizontal displacement $\\delta \\boldsymbol{r}$ is $\\nabla z \\cdot \\delta \\boldsymbol{r}$. Let $\\beta$ denote the conventional terrain slope angle measured from the horizontal so that $\\|\\nabla z\\| = \\tan \\beta$, and define $\\theta := \\frac{\\pi}{2} - \\beta$ as the complementary angle measured from the vertical (so that $\\tan \\theta = \\cot \\beta$). Under these assumptions, derive a first-order expression for the root-mean-square planimetric registration uncertainty $\\sigma_{XY}$ induced by the DEM vertical uncertainty $\\sigma_{Z}$, expressed in terms of $\\sigma_{Z}$ and $\\theta$. Express $\\theta$ in radians and $\\sigma_{XY}$ in meters. Your final answer must be a single closed-form analytic expression for $\\sigma_{XY}$ in terms of $\\sigma_{Z}$ and $\\theta$.",
            "solution": "The problem requires the derivation of a first-order expression for the root-mean-square (RMS) planimetric registration uncertainty, denoted $\\sigma_{XY}$, that arises from vertical uncertainty in a Digital Elevation Model (DEM), denoted $\\sigma_Z$. The derivation is to be performed under the assumption of a locally planar terrain surface and an orthographic projection.\n\nLet the true terrain surface be locally described by a function $z_{\\text{true}}(x,y)$. The problem states that this surface can be approximated by a plane. The DEM provides an estimate of this surface, $z_{\\text{dem}}(x,y)$, which includes a random, unbiased vertical error $\\delta Z$. At any given horizontal position $\\boldsymbol{r} = \\begin{pmatrix}x \\\\ y\\end{pmatrix}$, we have $z_{\\text{dem}}(\\boldsymbol{r}) = z_{\\text{true}}(\\boldsymbol{r}) + \\delta Z$. The vertical error $\\delta Z$ is a random variable with mean $E[\\delta Z] = 0$ and standard deviation $\\sigma_Z$.\n\nThe essence of the planimetric misregistration is that a feature on the true ground at a certain elevation is effectively sought on a DEM surface with an erroneous elevation. This mismatch forces a horizontal displacement to find a point on the true surface that corresponds to the erroneous elevation.\n\nLet's consider a point on the DEM with horizontal coordinates $\\boldsymbol{r}$ and elevation $z_{\\text{dem}}(\\boldsymbol{r})$. The planimetric error arises when we try to find the corresponding point on the true surface. We are looking for a point on the true surface, $\\boldsymbol{r}' = \\boldsymbol{r} + \\delta \\boldsymbol{r}$, that has the same elevation as the point on the erroneous DEM surface at $\\boldsymbol{r}$. That is, we seek the horizontal displacement $\\delta \\boldsymbol{r}$ such that:\n$$z_{\\text{true}}(\\boldsymbol{r} + \\delta \\boldsymbol{r}) = z_{\\text{dem}}(\\boldsymbol{r})$$\nSubstituting the definition of the DEM error, we get:\n$$z_{\\text{true}}(\\boldsymbol{r} + \\delta \\boldsymbol{r}) = z_{\\text{true}}(\\boldsymbol{r}) + \\delta Z$$\nThe change in elevation on the true surface corresponding to a horizontal displacement $\\delta\\boldsymbol{r}$ is $\\Delta z_{\\text{true}} = z_{\\text{true}}(\\boldsymbol{r} + \\delta \\boldsymbol{r}) - z_{\\text{true}}(\\boldsymbol{r})$. Thus, we have:\n$$\\Delta z_{\\text{true}} = \\delta Z$$\nThis equation establishes the core relationship: the vertical error in the DEM is equivalent to the change in elevation on the true terrain surface over the planimetric displacement vector $\\delta\\boldsymbol{r}$.\n\nThe problem models the terrain locally as a plane. Let's analyze the geometry on this plane. The terrain slope is defined by two angles: $\\beta$, the angle with the horizontal, and $\\theta$, the angle with the vertical. These are related by $\\theta = \\frac{\\pi}{2} - \\beta$.\n\nConsider a right-angled triangle where the hypotenuse lies on the sloped terrain surface. The two legs of this triangle represent a horizontal displacement, let its magnitude be $\\delta r_{xy} = \\|\\delta \\boldsymbol{r}\\|$, and the corresponding vertical displacement, $\\Delta z_{\\text{true}}$. The angle between the vertical direction and the sloped surface (the hypotenuse) is $\\theta$.\n\nFrom the definition of the tangent function in this right-angled triangle, the angle $\\theta$ relates the horizontal leg (opposite) to the vertical leg (adjacent):\n$$\\tan \\theta = \\frac{\\delta r_{xy}}{\\Delta z_{\\text{true}}}$$\nSubstituting $\\Delta z_{\\text{true}} = \\delta Z$, we obtain a direct relationship between the magnitude of the planimetric error and the vertical DEM error for a single realization:\n$$\\delta r_{xy} = \\delta Z \\tan \\theta$$\nThis expression shows that for a given vertical error $\\delta Z$, the resulting planimetric error $\\delta r_{xy}$ is modulated by the terrain slope, represented by $\\tan \\theta$.\n\nThe problem asks for the root-mean-square (RMS) planimetric uncertainty, $\\sigma_{XY}$, which is the standard deviation of $\\delta r_{xy}$ since the error is unbiased. The RMS value is defined as $\\sigma_{XY} = \\sqrt{E[(\\delta r_{xy})^2]}$.\nWe square the expression for $\\delta r_{xy}$:\n$$(\\delta r_{xy})^2 = (\\delta Z \\tan \\theta)^2 = (\\delta Z)^2 \\tan^2 \\theta$$\nNow, we take the expectation. The terrain slope, and thus $\\tan \\theta$, is a fixed parameter for the local patch under consideration. Therefore, it can be treated as a constant with respect to the expectation operator, which acts on the random variable $\\delta Z$.\n$$E[(\\delta r_{xy})^2] = E[(\\delta Z)^2 \\tan^2 \\theta] = \\tan^2 \\theta \\cdot E[(\\delta Z)^2]$$\nThe term $E[(\\delta Z)^2]$ is the variance of the vertical error, since the error is unbiased ($E[\\delta Z]=0$). The variance is the square of the standard deviation, $\\sigma_Z$.\n$$\\text{Var}(\\delta Z) = E[(\\delta Z - E[\\delta Z])^2] = E[(\\delta Z)^2] = \\sigma_Z^2$$\nSubstituting this into the equation for the expected squared planimetric error:\n$$E[(\\delta r_{xy})^2] = \\sigma_Z^2 \\tan^2 \\theta$$\nThe RMS planimetric uncertainty $\\sigma_{XY}$ is the square root of this value:\n$$\\sigma_{XY} = \\sqrt{\\sigma_Z^2 \\tan^2 \\theta} = |\\sigma_Z \\tan \\theta|$$\nThe standard deviation $\\sigma_Z$ is, by definition, a non-negative quantity. The conventional slope angle $\\beta$ is in the range $[0, \\frac{\\pi}{2})$. Consequently, the complementary angle $\\theta = \\frac{\\pi}{2} - \\beta$ is in the range $(0, \\frac{\\pi}{2}]$. For $\\theta$ in this range, $\\tan \\theta$ is non-negative. Therefore, the absolute value is not necessary.\n\nThe final first-order expression for the RMS planimetric registration uncertainty is:\n$$\\sigma_{XY} = \\sigma_Z \\tan \\theta$$\nThis result is consistent with the provided definitions. For verification, we can express it in terms of the slope angle $\\beta$. Since $\\theta = \\frac{\\pi}{2} - \\beta$, we have $\\tan \\theta = \\tan(\\frac{\\pi}{2} - \\beta) = \\cot \\beta = \\frac{1}{\\tan \\beta}$. So, $\\sigma_{XY} = \\frac{\\sigma_Z}{\\tan \\beta}$. This relationship correctly shows that the planimetric error increases infinitely as the terrain becomes flat ($\\beta \\to 0$, $\\tan \\beta \\to 0$), and the error approaches zero as the terrain becomes vertical ($\\beta \\to \\frac{\\pi}{2}$, $\\tan \\beta \\to \\infty$).",
            "answer": "$$\\boxed{\\sigma_{Z} \\tan(\\theta)}$$"
        }
    ]
}