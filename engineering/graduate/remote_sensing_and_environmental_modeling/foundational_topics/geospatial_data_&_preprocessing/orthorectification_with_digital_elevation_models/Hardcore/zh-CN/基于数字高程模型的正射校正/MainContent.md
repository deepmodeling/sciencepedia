## 引言
原始的遥感影像，无论是从飞机还是卫星上获取，本质上都更像一张照片而非一张地图。它们采用中心[投影几何](@entry_id:156239)，这意味着地表的地形起伏会直接导致影像上地物位置的偏移，使得直接在影像上进行的距离、面积或方向测量充满误差。为了将这些丰富的观测数据转化为可进行精确定量分析的科学产品，我们必须进行一项关键的几何处理——正射校正。这项技术通过引入地表的第三维信息，即数字高程模型（DEM），系统性地消除了这些几何畸变，生成了具有统一比例尺和精确地理坐标的正射影像。

本文旨在全面剖析利用DEM进行正射校正的核心知识体系。我们将解决原始遥感数据与地理[空间分析](@entry_id:183208)需求之间的关键差距，带领读者深入理解从原始像素到分析就绪数据的完整转换过程。

在接下来的内容中，您将首先通过“**原理与机制**”一章，探索正射校正的根本依据，从[地形位移](@entry_id:1130831)的几何学成因，到描述成像过程的严密传感器模型，再到[数字高程模型](@entry_id:1123727)（DEM）在整个工作流程中的核心作用。随后，在“**应用与跨学科连接**”一章中，我们将通过丰富的案例，展示[正射校正](@entry_id:1129216)产品如何在[地理信息系统](@entry_id:905468)（GIS）、环境科学监测、城市[三维建模](@entry_id:267022)等多个领域发挥关键作用，揭示其作为连接原始观测与科学发现的桥梁价值。最后，“**动手实践**”部分将提供具体的计算问题，帮助您巩固对核心概念的理解，并将理论知识转化为实践技能。

## 原理与机制

正射校正的目的是将原始遥感影像的中心[投影几何](@entry_id:156239)转换为正射[投影几何](@entry_id:156239)，从而消除由地形起伏和传感器视角引起的[几何畸变](@entry_id:914706)。其最终产品，即正射影像，具有地图的特性：统一的比例尺和精确的平面位置。本章将深入探讨实现这一转换所依赖的核心原理和关键机制，从基础的成像几何学到实际的算法工作流程。

### 中心[投影几何](@entry_id:156239)及其后果

大多数[光学遥感](@entry_id:1129164)传感器，无论是航空相机还是卫星传感器，其成像原理都可近似为中心投影（或[针孔相机](@entry_id:172894)）模型。在此模型中，来自地面目标的光线穿过一个单一的透镜中心（或称投影中心），并在焦平面上形成影像。这个简单的几何模型是所有后续分析的基础，也正是它导致了原始影像与地图之间存在根本差异。

#### [地形位移](@entry_id:1130831)：影像失真的主要来源

在中心投影下，地形的高低起伏会直接导致影像上地物位置的偏移，这种现象称为**[地形位移](@entry_id:1130831)**（Relief Displacement）。直观地说，对于一个非垂直下视（off-nadir）的传感器，一个位于高处的物体（如山顶或建筑物顶部）相较于其正下方的基底，会在影像上被记录在离像[主点](@entry_id:173969)（nadir point）更远的位置。这种位移是沿着从像[主点](@entry_id:173969)到该点的径向方向发生的。

我们可以通过一个简化的几何关系来量化这种位移。考虑一个物体，其高出参考平面的高度为 $\Delta Z$。如果传感器从一个偏离天顶的角度 $\theta$ 观测该物体，那么由高度差引起的地平面位置误差 $\Delta P$ 近似为：

$$ \Delta P \approx \Delta Z \tan(\theta) $$

这个关系揭示了正射校正的核心挑战：水平位置误差与地形高度差和观测角度直接相关  。例如，在一个离天顶角为 $25^{\circ}$ 的[卫星影像](@entry_id:1131212)中，一个 $20$ 米高的建筑物顶部，其影像位置会比其底部偏离大约 $20 \tan(25^{\circ}) \approx 9.3$ 米 。如果不对这种位移进行校正，直接在影像上进行的任何距离、面积或方向测量都将是不准确的。[正射校正](@entry_id:1129216)的根本任务就是利用精确的地形高程信息，逐像素地消除这种[地形位移](@entry_id:1130831)。

与之相比，一种简化的[地理配准](@entry_id:1125613)方法，如基于[地面控制点](@entry_id:1125825)（GCPs）的二维多项式或[仿射变换](@entry_id:144885)，仅仅是在二维平面间建立一个整体的数学映射。这种方法本质上假设地表是一个平面，因此无法模拟和校正随地形变化的、逐像素的[地形位移](@entry_id:1130831)。其结果是，尽管影像在控制点附近可能位置准确，但在地形起伏区域会保留大量的残余位移，导致整个影像的比例尺不一致 。

### 严密的传感器模型

为了精确地校正[地形位移](@entry_id:1130831)，必须首先建立一个能够描述从三维地面点到二维影像点之间映射关系的严密数学模型。这种模型被称为传感器模型。

#### 共线方程：框幅式相机的物理模型

对于传统的航空框幅式相机，其成像过程可以在一个瞬间完成，整个影像共享同一组外方位元素。描述其几何关系的基础是**共线方程**（Collinearity Equations）。该方程的物理意义是：投影中心、像点和对应的物方点三点位于一条直线上。

其数学表达式将地面点坐标 $(X, Y, Z)$ 与其对应的影像点坐标 $(x, y)$ 联系起来：

$$
x-x_0 = -f \frac{r_{11}(X-X_s)+r_{12}(Y-Y_s)+r_{13}(Z-Z_s)}{r_{31}(X-X_s)+r_{32}(Y-Y_s)+r_{33}(Z-Z_s)}
$$

$$
y-y_0 = -f \frac{r_{21}(X-X_s)+r_{22}(Y-Y_s)+r_{23}(Z-Z_s)}{r_{31}(X-X_s)+r_{32}(Y-Y_s)+r_{33}(Z-Z_s)}
$$

其中：
- $(x, y)$ 是像点的坐标。
- $(x_0, y_0)$ 是像[主点](@entry_id:173969)坐标，$f$ 是相机焦距。这三者共同构成了相机的**内方位元素**（Interior Orientation Parameters, IOPs），描述了相机的内部几何特性。
- $(X, Y, Z)$ 是地面点的物方空间坐标。
- $(X_s, Y_s, Z_s)$ 是相机投影中心在物方坐标系中的位置。
- $\mathbf{R} = \{r_{ij}\}$ 是一个 $3 \times 3$ 的旋转矩阵，描述了相机坐标系相对于物方坐标系的方向。$(X_s, Y_s, Z_s)$ 和 $\mathbf{R}$ 共同构成了相机的**外方位元素**（Exterior Orientation Parameters, EOPs），描述了相机在拍摄瞬间的空间位置和姿态。

在正射校正中，我们正是利用这些方程，结合地面点的 $Z$ 值（由数字高程模型提供），来反算或正算其精确的平面位置 。

#### 推扫式传感器的动态模型

与一次性曝光成像的框幅式相机不同，现代卫星大多采用**推扫式**（Pushbroom）或称线阵扫描的成像方式。推扫式传感器通过在卫星沿轨道飞行时，逐行获取影像来构建一幅完整的图像。

这种动态成像过程引入了一个关键的复杂性：每一行影像都是在不同的时刻 $t$ 获取的。因此，传感器的外方位元素——位置 $\mathbf{r}_s(t)$ 和姿态 $\mathbf{R}(t)$——不再是整个影像的常数，而是时间的函数。每一行影像都有其自己独立的投影中心和方向。这意味着，对推扫式影像进行[正射校正](@entry_id:1129216)，不能再使用单一的共线方程模型，而必须采用一个能够描述传感器位置和姿态随时间连续变化的动态模型。任何平台运动的不稳定或姿态的漂移都会直接转化为影像的几何畸变，这使得其校正过程比框幅式影像更为复杂 。

#### 通用传感器模型：有理[多项式系数](@entry_id:262287)（RPC）

由于严密物理模型的复杂性，尤其对于推扫式传感器，商业卫星数据通常提供一种通用的替代模型，即**有理[多项式系数](@entry_id:262287)**（Rational Polynomial Coefficients, RPC）模型。RPC 模型通过一对有理多项式函数，直接建立了地面坐标到影像坐标的映射关系，而无需用户了解传感器的具体物理参数。

该模型首先将地面坐标（经度 $\lambda$, 纬度 $\phi$, 高程 $h$）和影像坐标（行号 $r$, 列号 $c$）通过各自的比例（scale）和偏移（offset）参数进行归一化，使其值落在 $[-1, 1]$ 区间内：

$$
L = \frac{\lambda-\lambda_0}{s_\lambda}, \quad P = \frac{\phi-\phi_0}{s_\phi}, \quad H = \frac{h-h_0}{s_h}
$$
$$
R = \frac{r-r_0}{s_r}, \quad S = \frac{c-c_0}{s_c}
$$

这种归一化的主要目的是改善数值计算的稳定性，避免在[多项式拟合](@entry_id:178856)过程中因变量尺度差异过大而导致的[病态问题](@entry_id:137067) 。

然后，归一化后的影像坐标 $(R, S)$ 由归一化地面坐标 $(L, P, H)$ 的三阶多项式比值给出：

$$
R = \frac{\text{Num}_R(L, P, H)}{\text{Den}_R(L, P, H)}, \quad S = \frac{\text{Num}_S(L, P, H)}{\text{Den}_S(L, P, H)}
$$

RPC模型提供了一套标准的系数，用于计算这些多项式。在正射校正中，对于给定的地面点 $(\lambda, \phi)$ 和从DEM获取的高程 $h$，可以通过RPC模型计算出其在原始影像上的精确行列号 $(r, c)$。

### 高程数据的核心作用

[正射校正](@entry_id:1129216)之所以能够“校正”[地形位移](@entry_id:1130831)，其关键在于引入了地表的第三维信息——高程。这些信息由数字高程模型（Digital Elevation Model, DEM）提供。

#### DEM、DTM与DSM的区别及其应用

虽然**[数字高程模型](@entry_id:1123727)（DEM）**是一个通用术语，但在实际应用中，必须严格区分两种主要类型 ：

- **数字地表模型（Digital Surface Model, DSM）**：表示地表最[上层](@entry_id:198114)物体的高度，包括建筑物顶部、树冠、植被等。它通常由航空摄影测量或LiDAR的首次回波生成。
- **[数字地形模型](@entry_id:1123737)（Digital Terrain Model, DTM）**：表示裸露地面的高程，不包括其上的建筑物和植被。它通过对DSM进行滤波处理，移除地物后得到。

这两种模型的选择对正射校正的结果有决定性影响：

- 在**城市地区**，如果目标是精确地对建筑物进行地理定位，并生成无建筑物倾斜的“真”正射影像（True Orthophoto），则必须使用**DSM**。因为只有DSM提供了建筑物顶部的真实高程。如果使用DTM，校正过程会错误地将建筑物顶部的像元投影到其地面的位置，从而导致建筑物向远离传感器天底的方向“倾斜”。
- 在**植被覆盖的乡村地区**，如果目标是绘制地面的道路、河流或地块边界，则应使用**DTM**。如果使用DSM，校正过程会将树冠的顶部定位到其正确的平面位置，但这会掩盖其下方的地物，并可能导致透过树冠缝隙看到的地面特征发生错误位移。

#### [大地测量学](@entry_id:272545)考量：高程基准的统一

传感器模型（如RPC）通常使用基于参考椭球的**椭球高（$h$）**，而DEM产品（如SRTM）提供的高程通常是基于[大地水准面](@entry_id:749836)的**正高（$H$）**。这两者之间存在一个差值，称为**[大地水准面](@entry_id:749836)差距（$N$）**。

- **椭球高 ($h$)**: 地面点沿参考椭球[法线](@entry_id:167651)到椭球面的距离。
- **正高 ($H$)**: 地面点沿重力线（铅垂线）到大地水准面的距离。
- **[大地水准面](@entry_id:749836)差距 ($N$)**: 大地水准面相对于参考椭球的高度，沿椭球法线测量。

它们之间的关系近似为：
$$
h = H + N
$$

在进行正射校正时，必须首先利用一个[大地水准面](@entry_id:749836)模型（如EGM2008）计算出每个DEM像素点的[大地水准面](@entry_id:749836)差距 $N$，然后将其与DEM提供的正高 $H$ 相加，得到与传感器模型基准一致的椭球高 $h$。忽略这一转换将引入系统性的高程误差，进而根据 $\Delta P \approx \Delta Z \tan(\theta)$ 的关系，导致整个影像产生系统性的平面位置误差 。例如，如果一个点的正高为 $1245.0$ 米，大地水准面差距为 $+36.5$ 米，那么用于RPC模型的椭球高应为 $1281.5$ 米。

### 正射校正工作流程

现代[正射校正](@entry_id:1129216)普遍采用一种高效且稳健的**[反向映射](@entry_id:1121305)**（Inverse Mapping）工作流程。

#### [反向映射](@entry_id:1121305)与重采样

[反向映射](@entry_id:1121305)工作流程不是从原始影像像素出发，而是从定义好的输出正射影像网格出发，对每一个网格像素进行计算 ：

1.  **确定地面坐标**：对于输出正射影像网格中的每一个像素中心 $(x_t, y_t)$，利用目标[地图投影](@entry_id:149968)的反算公式，计算出其对应的地面大地坐标 $(\lambda_t, \phi_t)$。

2.  **获取高程**：以 $(\lambda_t, \phi_t)$ 为查询位置，通过插值从DEM中获取该点的正高 $H_t$。

3.  **统一高程基准**：利用大地水准面模型计算该点的[大地水准面](@entry_id:749836)差距 $N_t$，并计算出椭球高 $h_t = H_t + N_t$。

4.  **[反投影](@entry_id:746638)至原始影像**：将完整的三维地面坐标 $(\lambda_t, \phi_t, h_t)$ 输入传感器模型（如RPC），计算出该地面点在原始影像上对应的坐标 $(r_t, c_t)$。这个坐标通常是浮点数，表示它落在原始影像像素网格之间。

5.  **[重采样](@entry_id:142583)**：以[浮点](@entry_id:749453)坐标 $(r_t, c_t)$ 为中心，通过一定的**[重采样](@entry_id:142583)**（Resampling）算法，从其周围的原始影像像素中内插出一个亮度值（DN），并将该值赋给输出像素 $(x_t, y_t)$。

这个流程系统性地为输出网格的每一个像素“拉取”一个源像素值，因此也被称为“拉”式（pull）方法。其最大优点是能生成一个完整、无孔洞的输出影像，因为计算是按输出网格驱动的 。相比之下，从原始影像像素出发的正向映射（“推”式方法）在影像被拉伸的区域会产生像素间的空隙或“洞”，需要额外的步骤来填充。

#### [重采样方法](@entry_id:144346)及其影响

[重采样](@entry_id:142583)是决定最终影像质量的关键一步。不同的方法在保持空间细节和辐射保真度之间做出了不同的权衡 ：

- **最近邻法（Nearest Neighbor）**：直接选用离[浮点](@entry_id:749453)坐标 $(r_t, c_t)$ 最近的原始像素的DN值。这种方法完美地保持了原始影像的辐射值，对于后续的分类或定量分析非常重要。但它的缺点是会产生块状的、锯齿状的视觉效果，空间细节损失严重。

- **[双线性插值](@entry_id:170280)法（Bilinear Interpolation）**：取[浮点](@entry_id:749453)坐标周围最近的4个像素（$2 \times 2$ 邻域），根据距离进行加权平均。这种方法生成的影像在视觉上更平滑，但它通过平均改变了原始的DN值，对辐射信息造成了一定的平滑或模糊。

- **三次卷积插值法（Cubic Convolution）**：使用一个更大的邻域（通常是16个像素，$4 \times 4$），应用一个三次多项式函数来计算加权平均值。它比[双线性插值](@entry_id:170280)能更好地保持边缘的锐利度，提供更好的空间细节恢复。然而，它同样会改变原始DN值，并且可能在强边缘附近引入轻微的“振铃”或“光晕”效应。

### 实现高绝对定位精度

即使使用了严密的传感器模型和精确的DEM，[正射校正](@entry_id:1129216)的最终绝对定位精度仍然可能受到限制。这是因为传感器初始的外方位元素（通常由机载GPS和[惯性测量单元](@entry_id:1126479)IMU直接测定）本身可能存在微小的系统性偏差。

#### [地面控制点](@entry_id:1125825)（GCPs）的角色

为了消除这些残余的系统误差，并将影像精确地锚定到大地坐标系统中，需要使用**[地面控制点](@entry_id:1125825)（Ground Control Points, GCPs）**。GCP是地面上易于辨认的点，其精确的三维大地坐标已经通过实地测量（如GPS）获得。

通过一个称为**区域网平差**（Bundle Adjustment）或传感器模型精化的过程，将GCP在影像上的量测坐标与其已知的地面坐标进行[最小二乘法拟合](@entry_id:1127151)，可以解算出传感器模型的修正参数（例如，对位置和姿态的微小偏移和旋转）。这个过程实现了**绝对校正**，确保了最终的正射影像不仅内部几何一致，而且在全局坐标系中具有很高的绝对定位精度 。

需要强调的是，仅使用DEM进行校正，虽然能消除[地形位移](@entry_id:1130831)，但并不能消除传感器模型本身的系统偏差。因此，若无GCPs的约束，得到的正射影像仅具有**相对精度**，其整体位置可能偏离真实地理位置 。同样，如果只使用影像间的连接点（tie points）进行多景影像的联合平差，虽然可以使影像块内部高度一致（相对校正），但整个影像块的绝对位置、方向和尺度仍然是悬浮的，需要至少少数几个GCP来将其固定到大地坐标系中 。