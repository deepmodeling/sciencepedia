{
    "hands_on_practices": [
        {
            "introduction": "The raster data model represents the world as a grid of cells, but how we define contiguous objects within this grid is not always straightforward. This practice explores the fundamental concept of connectivity, demonstrating how different neighborhood rules—specifically 4-neighbor versus 8-neighbor—can lead to vastly different interpretations of spatial patterns. By analyzing a binary mask, you will see firsthand how this seemingly simple modeling choice impacts the topological structure of raster data .",
            "id": "3840460",
            "problem": "A binary raster mask is a discrete grid representation where each grid cell stores a binary state. Consider a $6 \\times 6$ binary raster representing inundated cells ($1$) and non-inundated cells ($0$) derived from a satellite classification in a Geographic Information System (GIS). The mask is\n$$\n\\begin{bmatrix}\n1 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 1 & 0 \\\\\n0 & 0 & 1 & 1 & 1 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & 0 \\\\\n1 & 1 & 0 & 1 & 1 & 0 \\\\\n1 & 1 & 0 & 0 & 0 & 1\n\\end{bmatrix}.\n$$\nUse the following core definitions as the fundamental base:\n- Two raster cells are considered adjacent under $4$-neighbor connectivity if and only if their Manhattan distance is $1$, i.e., for cell centers at integer coordinates $(i,j)$ and $(k,\\ell)$, adjacency holds when $|i-k|+|j-\\ell|=1$.\n- Two raster cells are considered adjacent under $8$-neighbor connectivity if and only if their Chebyshev distance is $1$, i.e., adjacency holds when $\\max\\{|i-k|,|j-\\ell|\\}=1$.\n- A connected component is a maximal set of $1$-valued cells such that each pair of cells in the set is linked by a path of pairwise adjacent $1$-valued cells.\n\nTask:\n1. Using only these definitions, determine the number of connected components of $1$-valued cells under $4$-neighbor connectivity and under $8$-neighbor connectivity for the given mask.\n2. In your derivation, make clear how diagonal connections present in this mask lead to different component counts under the two schemes, thereby demonstrating how $4$-neighbor connectivity can misclassify diagonally continuous inundation as fragmented when compared to $8$-neighbor connectivity.\n\nReport your final answer as the ordered pair $(C_{4},C_{8})$, where $C_{4}$ is the number of connected components under $4$-neighbor connectivity and $C_{8}$ is the number under $8$-neighbor connectivity. Express your final answer as exact integers. No rounding is required and no physical units apply.",
            "solution": "The problem is valid. It is self-contained, scientifically grounded in the principles of raster data analysis and graph theory, and presented with objective, formal definitions. All necessary data, including the raster mask and connectivity rules, are provided to determine a unique, verifiable solution.\n\nLet the given $6 \\times 6$ binary raster mask be denoted by the matrix $M$. We will use $1$-based indexing for rows and columns, so a cell is represented by its coordinates $(i,j)$ where $i,j \\in \\{1, 2, 3, 4, 5, 6\\}$. The set of all cells with value $1$ is:\n$$S = \\{(1,1), (2,2), (2,5), (3,3), (3,4), (3,5), (4,3), (5,1), (5,2), (5,4), (5,5), (6,1), (6,2), (6,6)\\}$$\n\n**1. Analysis for 4-Neighbor Connectivity ($C_4$)**\n\nWe apply the definition of $4$-neighbor connectivity, where two cells $(i,j)$ and $(k,\\ell)$ are adjacent if $|i-k|+|j-\\ell|=1$. This means a cell is connected only to its immediate neighbors to the north, south, east, and west. We will enumerate the connected components by systematically traversing the set $S$.\n\n- **Component 1:** Start with the cell $(1,1)$. Its $4$-neighbors are $(1,2)$ and $(2,1)$. The values at these locations in the mask are $M_{12}=0$ and $M_{21}=0$. Thus, $(1,1)$ has no $4$-connected neighbors with a value of $1$. It forms a component by itself: $C_{4,1} = \\{(1,1)\\}$.\n\n- **Component 2:** The next unassigned cell is $(2,2)$. Its $4$-neighbors are $(1,2)$, $(2,1)$, $(2,3)$, and $(3,2)$, all of which have a value of $0$. Thus, $(2,2)$ is also an isolated component: $C_{4,2} = \\{(2,2)\\}$.\n\n- **Component 3:** The next unassigned cell is $(2,5)$. Its only $4$-neighbor with value $1$ is $(3,5)$. Following the path from $(3,5)$, it is $4$-connected to $(3,4)$. From $(3,4)$, it is $4$-connected to $(3,3)$. From $(3,3)$, it is $4$-connected to $(4,3)$. The cell $(4,3)$ has no further unassigned $4$-neighbors with value $1$. Therefore, this component is the set: $C_{4,3} = \\{(2,5), (3,5), (3,4), (3,3), (4,3)\\}$.\n\n- **Component 4:** The next unassigned cell is $(5,1)$. It is $4$-connected to $(5,2)$ and $(6,1)$. Both $(5,2)$ and $(6,1)$ are $4$-connected to $(6,2)$. There are no other $4$-connections from this group to other cells with value $1$. This component is the set: $C_{4,4} = \\{(5,1), (5,2), (6,1), (6,2)\\}$.\n\n- **Component 5:** The next unassigned cell is $(5,4)$. It is $4$-connected to $(5,5)$. The cell $(5,5)$ has no other $4$-neighbors with value $1$. This component is the set: $C_{4,5} = \\{(5,4), (5,5)\\}$.\n\n- **Component 6:** The final unassigned cell is $(6,6)$. Its $4$-neighbors, $(5,6)$ and $(6,5)$, both have a value of $0$. It forms an isolated component: $C_{4,6} = \\{(6,6)\\}$.\n\nAll cells in $S$ have been assigned to a component. The number of distinct components under $4$-neighbor connectivity is $6$. Thus, $C_{4}=6$.\n\n**2. Analysis for 8-Neighbor Connectivity ($C_8$)**\n\nWe now apply the definition of $8$-neighbor connectivity, where two cells $(i,j)$ and $(k,\\ell)$ are adjacent if $\\max\\{|i-k|, |j-\\ell|\\}=1$. This rule includes diagonal neighbors in addition to the cardinal neighbors from the $4$-connectivity rule. We analyze how this broader definition of adjacency merges the components identified previously.\n\nThe task requires us to demonstrate how diagonal connections cause the component count to differ. We will show that all $6$ of the $4$-neighbor components are linked into a single component by new connections enabled by the $8$-neighbor rule.\n\n- **Merging $C_{4,1}$ and $C_{4,2}$:** Component $C_{4,1} = \\{(1,1)\\}$ and $C_{4,2} = \\{(2,2)\\}$ are separate under $4$-connectivity. However, for cells $(1,1)$ and $(2,2)$, we have $\\max\\{|1-2|, |1-2|\\} = \\max\\{1,1\\} = 1$. They are diagonal neighbors and are therefore connected under the $8$-neighbor rule. This merges them into a single group $\\{(1,1), (2,2)\\}$.\n\n- **Merging with $C_{4,3}$:** The cell $(2,2)$ from the newly merged group is diagonally adjacent to cell $(3,3)$ from component $C_{4,3}$, since $\\max\\{|2-3|, |2-3|\\} = \\max\\{1,1\\} = 1$. This connection merges the group $\\{(1,1), (2,2)\\}$ with the entirety of $C_{4,3}$.\n\n- **Merging with $C_{4,4}$:** Cell $(4,3)$ (now part of the growing single component) is diagonally adjacent to cell $(5,2)$ from component $C_{4,4}$, since $\\max\\{|4-5|,|3-2|\\} = \\max\\{1,1\\}=1$. This merges $C_{4,4}$ into the main component.\n\n- **Merging with $C_{4,5}$:** Cell $(4,3)$ is also diagonally adjacent to cell $(5,4)$ from component $C_{4,5}$, since $\\max\\{|4-5|,|3-4|\\} = \\max\\{1,1\\}=1$. This merges $C_{4,5}$ into the main component.\n\n- **Merging with $C_{4,6}$:** The cell $(5,5)$ (now part of the main component after merging with $C_{4,5}$) is a diagonal neighbor of cell $(6,6)$ from component $C_{4,6}$, since $\\max\\{|5-6|,|5-6|\\} = \\max\\{1,1\\}=1$. This final connection merges $C_{4,6}$ into the main component.\n\nThrough this chain of diagonal connections, all $6$ components that were distinct under $4$-connectivity become linked into a single, large connected component. No $1$-valued cells remain outside this single component. Therefore, the number of components under $8$-neighbor connectivity is $1$. Thus, $C_{8}=1$.\n\nThe analysis highlights a critical aspect of raster data modeling. The choice of connectivity rule directly impacts the topological structure of the data. Visually, the inundated cells form a large, contiguous, albeit thin, diagonal feature. The $8$-neighbor connectivity model correctly identifies this as a single entity. In contrast, the more restrictive $4$-neighbor connectivity model fails to capture the diagonal continuity, resulting in the misclassification of the single feature as $6$ fragmented and disconnected pieces. This has significant implications in environmental modeling, for instance, where measuring the number or size of inundated areas would yield drastically different results depending on the chosen connectivity scheme.\n\nThe final ordered pair is $(C_4, C_8) = (6,1)$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 6 & 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Once objects are identified in a raster, their shapes are often imperfect due to sensor noise or classification errors. Mathematical morphology provides a powerful, set-theoretic toolkit for refining these shapes. This exercise requires you to derive the fundamental operators of erosion and dilation from first principles and apply them in sequence to perform a morphological opening, a technique used to remove small noise features and smooth object boundaries .",
            "id": "3840489",
            "problem": "Consider a binary raster representation on a discrete integer lattice $\\,\\mathbb{Z}^{2}\\,$, where each raster cell corresponds to a lattice site and is labeled by $\\,0\\,$ (background) or $\\,1\\,$ (foreground). In remote sensing and environmental modeling, morphological filtering is used to regularize class masks obtained from classification of satellite imagery. Starting from core set-theoretic definitions on $\\,\\mathbb{Z}^{2}\\,$ (translation, reflection, subset), derive explicit formal definitions for the morphological erosion and dilation of a binary raster by a finite structuring element, using no image-specific shortcuts. Assume the structuring element has a designated origin at $\\,\\mathbf{0}=(0,0)\\,$ and operations are defined on the infinite lattice with implicit background of $\\,0\\,$ outside any finite raster extent.\n\nThen, let the $\\,6 \\times 6\\,$ mask $\\,A\\,$ be given by\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 1 & 1 & 1 & 1 \\\\\n0 & 1 & 1 & 1 & 1 & 1 \\\\\n0 & 1 & 1 & 1 & 1 & 0 \\\\\n0 & 1 & 1 & 1 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix},\n$$\nwhere rows and columns are indexed by $\\,1,2,3,4,5,6\\,$. Let the structuring element $\\,B\\,$ be the $\\,3 \\times 3\\,$ filled square (Moore neighborhood of radius $\\,1\\,$) centered at its origin:\n$$\nB \\;=\\; \\{-1,0,1\\} \\times \\{-1,0,1\\}.\n$$\nApply the morphological opening of $\\,A\\,$ by $\\,B\\,$, defined as erosion of $\\,A\\,$ by $\\,B\\,$ followed by dilation of the result by $\\,B\\,$. Compute the total number of foreground cells (the cardinality) in the opened mask. Provide the single final answer as the number of foreground cells. No rounding is required.",
            "solution": "The problem requires a formal derivation of morphological erosion and dilation, followed by the application of morphological opening to a given binary mask. The final result is the cardinality of the opened mask.\n\nFirst, we establish the theoretical framework. A binary raster image is represented as a set of foreground coordinates on the integer lattice $\\mathbb{Z}^2$. Let $A \\subseteq \\mathbb{Z}^2$ be the set of foreground pixels of the image, and $B \\subseteq \\mathbb{Z}^2$ be the set of points in the structuring element. The problem states that $B$ has a designated origin at $\\mathbf{0} = (0,0)$.\n\nThe fundamental operations are set-theoretic:\n1.  **Translation**: The translation of a set $S \\subseteq \\mathbb{Z}^2$ by a vector $z \\in \\mathbb{Z}^2$ is defined as:\n    $$ S_z = \\{s+z \\mid s \\in S\\} $$\n    This operation shifts the entire set $S$ such that its origin moves to the point $z$.\n\n2.  **Reflection**: The reflection of a set $S \\subseteq \\mathbb{Z}^2$ through the origin is defined as:\n    $$ \\hat{S} = \\{-s \\mid s \\in S\\} $$\n\nUsing these, we can formally define morphological erosion and dilation.\n\n**Morphological Erosion**\nThe erosion of a set $A$ by a structuring element $B$, denoted $A \\ominus B$, is the set of all points $z$ such that the structuring element $B$ translated to $z$ is completely contained within $A$. This operation is used to shrink or thin objects.\nFormally, the definition is:\n$$ A \\ominus B = \\{z \\in \\mathbb{Z}^2 \\mid B_z \\subseteq A\\} $$\nSubstituting the definition of translation, this becomes:\n$$ A \\ominus B = \\{z \\in \\mathbb{Z}^2 \\mid \\{b+z \\mid b \\in B\\} \\subseteq A\\} $$\nFor a point $z$ to be in the eroded set, every point of the structuring element, when shifted by $z$, must correspond to a foreground point in the original set $A$.\n\n**Morphological Dilation**\nThe dilation of a set $A$ by a structuring element $B$, denoted $A \\oplus B$, is the set of all points $z$ such that the reflected structuring element $\\hat{B}$ translated to $z$ has a non-empty intersection with $A$. This operation expands or thickens objects.\nFormally, the definition is:\n$$ A \\oplus B = \\{z \\in \\mathbb{Z}^2 \\mid \\hat{B}_z \\cap A \\neq \\emptyset\\} $$\nAn equivalent and often more intuitive definition is the Minkowski sum of the two sets, which can be derived from the first definition. A point $z$ is in $A \\oplus B$ if there exists $a \\in A$ and $b \\in B$ such that $z = a - (-b) = a+b$. This leads to:\n$$ A \\oplus B = \\{a+b \\mid a \\in A, b \\in B\\} $$\nThis latter form states that the dilation of $A$ by $B$ is the set of all possible vector sums of pairs of elements, one from $A$ and one from $B$.\n\n**Morphological Opening**\nThe problem asks for the morphological opening of $A$ by $B$, denoted $A \\circ B$. It is defined as an erosion followed by a dilation:\n$$ A \\circ B = (A \\ominus B) \\oplus B $$\n\nNow we apply these definitions to the specific problem. The input mask $A$ is given by a $6 \\times 6$ matrix. We represent it as a set of coordinates $(r, c)$ where $r$ is the row index and $c$ is the column index, both from $1$ to $6$. The set of foreground pixels in $A$ is:\n$$ A = \\{(1,1), (2,2), (2,3), (2,4), (2,5), (2,6), (3,2), (3,3), (3,4), (3,5), (3,6), (4,2), (4,3), (4,4), (4,5), (5,2), (5,3), (5,4), (5,5)\\} $$\nThe structuring element $B$ is a $3 \\times 3$ filled square centered at the origin, given by the Cartesian product $B = \\{-1,0,1\\} \\times \\{-1,0,1\\}$. As a set of displacement vectors, this is:\n$$ B = \\{(-1,-1), (-1,0), (-1,1), (0,-1), (0,0), (0,1), (1,-1), (1,0), (1,1)\\} $$\n\n**Step 1: Erosion ($E = A \\ominus B$)**\nWe need to find all points $z = (r,c)$ such that the $3 \\times 3$ block of pixels in $A$ centered at $(r,c)$ consists entirely of $1$s. We scan the matrix $A$ for such $3 \\times 3$ blocks.\n-   Consider $z = (3,3)$. The set $B_z$ corresponds to the points $(r', c')$ where $r' \\in \\{2,3,4\\}$ and $c' \\in \\{2,3,4\\}$. Checking the matrix $A$, all $A_{r'c'}$ for these indices are $1$. Thus, $(3,3) \\in E$.\n-   Consider $z = (3,4)$. The set $B_z$ corresponds to points where $r' \\in \\{2,3,4\\}$ and $c' \\in \\{3,4,5\\}$. All these points in $A$ are $1$. Thus, $(3,4) \\in E$.\n-   Consider $z = (4,3)$. The set $B_z$ corresponds to points where $r' \\in \\{3,4,5\\}$ and $c' \\in \\{2,3,4\\}$. All these points in $A$ are $1$. Thus, $(4,3) \\in E$.\n-   Consider $z = (4,4)$. The set $B_z$ corresponds to points where $r' \\in \\{3,4,5\\}$ and $c' \\in \\{3,4,5\\}$. All these points in $A$ are $1$. Thus, $(4,4) \\in E$.\nAny other point $z$ will result in $B_z$ including at least one coordinate where $A$ has a value of $0$. For example, for $z=(3,5)$, $B_z$ includes the point $(4,6)$, but $A_{4,6}=0$, so $(3,5) \\notin E$. The isolated pixel at $(1,1)$ is also removed as it cannot contain a $3 \\times 3$ structuring element.\nThe eroded set is:\n$$ E = A \\ominus B = \\{(3,3), (3,4), (4,3), (4,4)\\} $$\nThe matrix representation of $E$ is:\n$$ E = \\begin{pmatrix} 0 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 0 \\end{pmatrix} $$\n\n**Step 2: Dilation ($O = E \\oplus B$)**\nWe now dilate the eroded set $E$ by $B$. We use the Minkowski sum definition: $O = \\{e+b \\mid e \\in E, b \\in B\\}$. This is the union of four translated sets of $B$, centered at each point in $E$.\n-   For $e=(3,3)$, the set $\\{e+b \\mid b \\in B\\}$ is a $3 \\times 3$ block of pixels centered at $(3,3)$. This is the set $\\{2,3,4\\} \\times \\{2,3,4\\}$.\n-   For $e=(3,4)$, the set $\\{e+b \\mid b \\in B\\}$ is a $3 \\times 3$ block of pixels centered at $(3,4)$. This is the set $\\{2,3,4\\} \\times \\{3,4,5\\}$.\n-   For $e=(4,3)$, the set $\\{e+b \\mid b \\in B\\}$ is a $3 \\times 3$ block of pixels centered at $(4,3)$. This is the set $\\{3,4,5\\} \\times \\{2,3,4\\}$.\n-   For $e=(4,4)$, the set $\\{e+b \\mid b \\in B\\}$ is a $3 \\times 3$ block of pixels centered at $(4,4)$. This is the set $\\{3,4,5\\} \\times \\{3,4,5\\}$.\n\nThe final opened set $O$ is the union of these four sets.\nThe union of the row indices is $\\{2,3,4\\} \\cup \\{3,4,5\\} = \\{2,3,4,5\\}$.\nThe union of the column indices is $\\{2,3,4\\} \\cup \\{3,4,5\\} = \\{2,3,4,5\\}$.\nSo, the opened set $O$ is the Cartesian product of these index sets:\n$$ O = \\{2,3,4,5\\} \\times \\{2,3,4,5\\} $$\nThis corresponds to a $4 \\times 4$ block of foreground pixels. The matrix representation is:\n$$ O = \\begin{pmatrix} 0 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 1 & 1 & 1 & 1 & 0 \\\\ 0 & 1 & 1 & 1 & 1 & 0 \\\\ 0 & 1 & 1 & 1 & 1 & 0 \\\\ 0 & 1 & 1 & 1 & 1 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 0 \\end{pmatrix} $$\n\n**Step 3: Cardinality of the opened mask**\nThe final task is to compute the total number of foreground cells in the opened mask $O$. This is the cardinality of the set $O$, denoted $|O|$.\nThe set $O$ is a $4 \\times 4$ block of pixels.\n$$ |O| = 4 \\times 4 = 16 $$",
            "answer": "$$\\boxed{16}$$"
        },
        {
            "introduction": "Beyond representing static objects, the raster model excels at simulating dynamic processes like movement across a landscape. This practice delves into least-cost path analysis, a cornerstone of geographic modeling where the grid represents a field of friction or resistance. You will derive the dynamic programming recurrence for accumulated cost and apply it to find the optimal path, providing a foundational understanding of how GIS models accessibility and flow .",
            "id": "3840444",
            "problem": "A raster grid in a Geographic Information System (GIS) encodes a spatial field of movement resistance as cell-wise friction values. Consider a discrete-time, discrete-space movement model on a raster where an agent starts from a single source cell and may move at each step to any of its $8$-connected neighbors (the four orthogonal and the four diagonal neighbors). Assume the cost of traversing from one cell to another is the product of a per-unit-distance friction and the Euclidean distance of the move. The friction at a cell is the resistance per unit distance and is assumed to be an isotropic scalar. Use the following setup.\n\nFundamental base and assumptions:\n- The raster is indexed by integer row and column coordinates $(i,j)$ with $i \\in \\{1,2,3\\}$ and $j \\in \\{1,2,3\\}$, where $(1,1)$ is the upper-left cell and rows increase downward.\n- The friction field $F(i,j)$ is defined on the raster cells and represents resistance per unit distance. The raster cell size is $s$, the edge length of each square cell. The Euclidean distance of a single-step move is $s$ for orthogonal moves and $s\\sqrt{2}$ for diagonal moves.\n- The movement cost of a single step from a cell $(p,q)$ to an adjacent cell $(i,j)$ is modeled as the product of the Euclidean step length and the average of the two endpoint frictions, that is, $\\left(\\frac{F(p,q)+F(i,j)}{2}\\right)$ times the step length.\n- The accumulated cost $C(i,j)$ is defined as the minimal sum of step costs over all valid paths from the source cell to $(i,j)$. The source cell $(i_{0},j_{0})$ has $C(i_{0},j_{0})=0$.\n\nTask:\n1. Starting from the core definitions of path cost on a weighted graph and the principle of optimality for dynamic programming, derive a recurrence for the accumulated cost $C(i,j)$ over an $8$-connected raster. Clearly state the neighbor set and the transition cost used in the recurrence.\n2. Using the recurrence you derive, compute the accumulated cost $C(3,3)$ for the following $3 \\times 3$ raster with cell size $s$ and friction field $F(i,j)$:\n$$\nF=\\begin{pmatrix}\n2 & 3 & 5 \\\\\n4 & 1 & 2 \\\\\n6 & 2 & 1\n\\end{pmatrix},\n\\quad s=1,\n\\quad (i_{0},j_{0})=(2,2).\n$$\nExpress the final accumulated cost as a closed-form analytic expression in cost-units. No rounding is required. The answer must be a single real-valued number or a single closed-form analytic expression.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and internally consistent. It presents a standard least-cost path problem on a raster grid, a fundamental topic in Geographic Information Science and computational geography. All parameters and definitions required for a unique solution are provided. We may therefore proceed with the solution.\n\nThe problem is divided into two parts: first, the derivation of a general recurrence for accumulated cost, and second, the application of this principle to compute a specific cost on a given raster.\n\n### Part 1: Derivation of the Recurrence for Accumulated Cost\n\nThe problem of finding the minimal accumulated cost from a source cell to all other cells on a friction grid is equivalent to the single-source shortest path problem on a weighted graph. Let the graph be $G=(V, E)$, where the set of vertices $V$ consists of the center points of the raster cells $(i,j)$, and the set of edges $E$ connects each cell to its $8$ neighbors.\n\nThe cost, or weight, of traversing an edge from a cell $(p,q)$ to an adjacent cell $(i,j)$ is given as the transition cost $T((p,q), (i,j))$. According to the problem statement, this is:\n$$\nT((p,q), (i,j)) = \\left(\\frac{F(p,q) + F(i,j)}{2}\\right) d((p,q), (i,j))\n$$\nwhere $F(i,j)$ is the friction at cell $(i,j)$ and $d((p,q), (i,j))$ is the Euclidean distance between the cell centers. Given a cell size of $s$, the distance is:\n$$\nd((p,q), (i,j)) =\n\\begin{cases}\ns & \\text{if } (i,j) \\text{ is an orthogonal neighbor of } (p,q) \\\\\ns\\sqrt{2} & \\text{if } (i,j) \\text{ is a diagonal neighbor of } (p,q)\n\\end{cases}\n$$\nThe set of neighbors for a cell $(i,j)$, denoted $\\mathcal{N}(i,j)$, is the set of $8$ cells $(p,q)$ such that $\\max(|i-p|, |j-q|) = 1$.\n\nThe accumulated cost $C(i,j)$ is the cost of the shortest path from the source cell $(i_0, j_0)$ to the cell $(i,j)$. The derivation of its recurrence relation is based on the principle of optimality (as formulated by Bellman). This principle states that if a path from $(i_0, j_0)$ to $(i,j)$ is a shortest path, then any subpath of it is also a shortest path.\n\nConsider a shortest path to an arbitrary cell $(i,j)$ from the source $(i_0, j_0)$. This path must arrive at $(i,j)$ from one of its neighbors, say $(p,q) \\in \\mathcal{N}(i,j)$. The principle of optimality implies that the portion of the path from $(i_0, j_0)$ to $(p,q)$ must be the shortest path to $(p,q)$. The cost of this path to $(i,j)$ via $(p,q)$ is therefore the sum of the minimal cost to reach $(p,q)$, which is $C(p,q)$, and the transition cost from $(p,q)$ to $(i,j)$, which is $T((p,q), (i,j))$.\n\nSince $C(i,j)$ must be the minimal cost, it must be the minimum of the costs of all possible paths arriving from any of its neighbors. This leads to the general recurrence relation for the accumulated cost:\n$$\nC(i,j) = \\min_{(p,q) \\in \\mathcal{N}(i,j)} \\{ C(p,q) + T((p,q), (i,j)) \\}\n$$\nSubstituting the definition of the transition cost, we get:\n$$\nC(i,j) = \\min_{(p,q) \\in \\mathcal{N}(i,j)} \\left\\{ C(p,q) + \\left(\\frac{F(p,q) + F(i,j)}{2}\\right) d((p,q), (i,j)) \\right\\}\n$$\nThis recurrence holds for all cells $(i,j)$ not equal to the source cell. The base case for the recurrence is the cost at the source cell, which is defined to be zero:\n$$\nC(i_0, j_0) = 0\n$$\nThese equations define the properties of the final accumulated cost surface. Iterative algorithms, such as Dijkstra's algorithm or its variants (e.g., A*), are used to solve this system of equations and compute the cost values, starting from the source and expanding outward.\n\n### Part 2: Computation of Accumulated Cost C(3,3)\n\nWe are given the following problem-specific data:\n- Cell size $s=1$.\n- Source cell $(i_0, j_0) = (2,2)$.\n- Friction field $F$:\n$$\nF=\\begin{pmatrix}\n2 & 3 & 5 \\\\\n4 & 1 & 2 \\\\\n6 & 2 & 1\n\\end{pmatrix}\n$$\nThis means $F(1,1)=2$, $F(1,2)=3$, $F(1,3)=5$, $F(2,1)=4$, $F(2,2)=1$, $F(2,3)=2$, $F(3,1)=6$, $F(3,2)=2$, and $F(3,3)=1$.\nOur goal is to compute $C(3,3)$. We will employ Dijkstra's algorithm, which systematically finds the shortest path from a source node to all other nodes in a graph with non-negative edge weights.\n\n1.  **Initialization**:\n    The cost at the source cell is $C(2,2) = 0$. The costs for all other cells are initialized to infinity. We maintain a set of \"visited\" cells for which the minimal cost is finalized. Initially, this set is empty. We use a priority queue of \"unvisited\" cells, ordered by their current tentative minimum cost.\n    - $C(2,2) = 0$.\n    - $C(i,j) = \\infty$ for all $(i,j) \\neq (2,2)$.\n\n2.  **First Iteration**:\n    The algorithm selects the node with the minimum cost, which is the source $(2,2)$. We finalize its cost and update the tentative costs of its $8$ neighbors. The friction at the source is $F(2,2)=1$.\n\n    -   **Path to $(1,1)$ (diagonal)**: $d=\\sqrt{2}$. $F(1,1)=2$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(1,1)}{2}d = 0 + \\frac{1+2}{2}\\sqrt{2} = \\frac{3}{2}\\sqrt{2}$.\n    -   **Path to $(1,2)$ (orthogonal)**: $d=1$. $F(1,2)=3$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(1,2)}{2}d = 0 + \\frac{1+3}{2}(1) = 2$.\n    -   **Path to $(1,3)$ (diagonal)**: $d=\\sqrt{2}$. $F(1,3)=5$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(1,3)}{2}d = 0 + \\frac{1+5}{2}\\sqrt{2} = 3\\sqrt{2}$.\n    -   **Path to $(2,1)$ (orthogonal)**: $d=1$. $F(2,1)=4$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(2,1)}{2}d = 0 + \\frac{1+4}{2}(1) = \\frac{5}{2}$.\n    -   **Path to $(2,3)$ (orthogonal)**: $d=1$. $F(2,3)=2$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(2,3)}{2}d = 0 + \\frac{1+2}{2}(1) = \\frac{3}{2}$.\n    -   **Path to $(3,1)$ (diagonal)**: $d=\\sqrt{2}$. $F(3,1)=6$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(3,1)}{2}d = 0 + \\frac{1+6}{2}\\sqrt{2} = \\frac{7}{2}\\sqrt{2}$.\n    -   **Path to $(3,2)$ (orthogonal)**: $d=1$. $F(3,2)=2$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(3,2)}{2}d = 0 + \\frac{1+2}{2}(1) = \\frac{3}{2}$.\n    -   **Path to $(3,3)$ (diagonal)**: $d=\\sqrt{2}$. $F(3,3)=1$.\n        Cost = $C(2,2) + \\frac{F(2,2)+F(3,3)}{2}d = 0 + \\frac{1+1}{2}\\sqrt{2} = \\sqrt{2}$.\n\n3.  **Second Iteration**:\n    The tentative costs for the neighbors of the source are now:\n    $C(1,1) = \\frac{3\\sqrt{2}}{2} \\approx 2.121$\n    $C(1,2) = 2$\n    $C(1,3) = 3\\sqrt{2} \\approx 4.243$\n    $C(2,1) = 2.5$\n    $C(2,3) = 1.5$\n    $C(3,1) = \\frac{7\\sqrt{2}}{2} \\approx 4.950$\n    $C(3,2) = 1.5$\n    $C(3,3) = \\sqrt{2} \\approx 1.414$\n\n    Dijkstra's algorithm now selects the unvisited cell with the minimum tentative cost. Comparing the values, the minimum is $C(3,3) = \\sqrt{2}$.\n\n    Because our target cell $(3,3)$ is the one selected from the priority queue, its minimal cost has been found. The algorithm guarantees this because all edge weights (transition costs) are non-negative. Any alternative path to $(3,3)$ must pass through another unvisited cell $(p,q)$. However, at this stage, all other unvisited cells $(p,q)$ have a tentative cost $C(p,q) \\ge C(3,3) = \\sqrt{2}$. Therefore, any path routed through such a cell could not possibly result in a total cost less than $\\sqrt{2}$. The shortest path to $(3,3)$ is the direct diagonal move from $(2,2)$.\n\nThe accumulated cost at $(3,3)$ is thus the cost of this direct path.\n$$\nC(3,3) = \\sqrt{2}\n$$",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        }
    ]
}