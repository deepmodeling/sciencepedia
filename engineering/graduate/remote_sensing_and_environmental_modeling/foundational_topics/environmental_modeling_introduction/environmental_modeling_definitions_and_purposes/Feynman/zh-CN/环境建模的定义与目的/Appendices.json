{
    "hands_on_practices": [
        {
            "introduction": "环境建模的一个核心目的是量化输入（如遥感测量值）中的不确定性如何通过模型传播，最终导致输出（如生物地球化学通量）的不确定性。这项练习将引导你使用一种基本但功能强大的技术——一阶泰勒展开，来建立输入协方差与输出方差之间的直接联系。通过这个计算，你将亲身体验如何为一个复杂的非线性模型进行误差传播分析 ()。",
            "id": "3809318",
            "problem": "遥感环境建模的一个核心目的是，将可观测量与生物地球物理通量进行定量关联，同时严格地表征输入不确定性如何传播到输出不确定性。考虑一个标量环境通量 $y$，代表每日总初级生产力 (GPP)，单位为克碳/平方米/天，其模型为 $y = \\mathcal{H}(x)$，其中 $x \\in \\mathbb{R}^{3}$ 包含来自遥感和气象学的输入。输入向量为 $x = (x_{1}, x_{2}, x_{3})$，其中 $x_{1}$ 是归一化植被指数 (NDVI)，$x_{2}$ 是增强型植被指数 (EVI)，$x_{3}$ 是入射短波辐射，单位为瓦特/平方米。正向模型定义为\n$$\n\\mathcal{H}(x) = \\alpha \\,\\ln\\!\\big(1 + \\beta \\, x_{1}\\big) + \\gamma \\,\\sqrt{x_{3}} + \\delta \\, x_{1} x_{2},\n$$\n其中参数 $\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 是通过校准和过程理解确定的常数。\n\n假设 $x$ 是一个随机向量，其均值状态为\n$$\nx_{0} = \\big(0.7,\\; 0.5,\\; 550\\big),\n$$\n协方差矩阵为\n$$\n\\Sigma_{x} = \n\\begin{pmatrix}\n0.0025  & 0.0010  & 0.50 \\\\\n0.0010  & 0.0016  & 0.20 \\\\\n0.50  & 0.20  & 2500\n\\end{pmatrix}.\n$$\n校准后的参数值为\n$$\n\\alpha = 2.5,\\quad \\beta = 0.8,\\quad \\gamma = 0.5,\\quad \\delta = 1.2.\n$$\n\n从方差和协方差的定义出发，并利用 $\\mathcal{H}(x)$ 在 $x_{0}$ 处的一阶泰勒展开，推导出一个用在 $x_{0}$ 处计算的 $\\mathcal{H}$ 的梯度和 $x$ 的协方差表示的 $y$ 的近似方差的表达式。然后，根据给定数据对此表达式进行数值计算。\n\n将您的最终方差四舍五入至四位有效数字。以 $(\\text{g C m}^{-2}\\,\\text{d}^{-1})^{2}$ 为单位表示方差。",
            "solution": "此问题经评估有效。其科学依据在于环境建模和不确定性分析的原理，特别是使用了一阶泰勒级数展开（一种标准的误差传播方法）。该问题提法恰当，提供了清晰定义的模型、所有必要的参数以及输入统计数据（均值和协方差）。给定的遥感指数（NDVI, EVI）、辐射及其不确定性的值在物理上是现实的。问题是客观的，没有内部矛盾。\n\n任务是推导环境模型输出近似方差的表达式，然后计算其值。环境通量 $y$ 由函数 $y = \\mathcal{H}(x)$ 给出，其中 $x = (x_1, x_2, x_3)$ 是一个随机输入向量。$y$ 的不确定性源于 $x$ 的不确定性，后者由其均值 $x_0$ 和协方差矩阵 $\\Sigma_x$ 表征。\n\n首先，我们推导 $y$ 的方差的一般表达式。我们使用函数 $\\mathcal{H}(x)$ 在均值输入向量 $x_0$ 附近的一阶泰勒展开：\n$$\ny = \\mathcal{H}(x) \\approx \\mathcal{H}(x_0) + \\nabla\\mathcal{H}(x_0)^T (x - x_0)\n$$\n其中 $\\nabla\\mathcal{H}(x_0)$ 是 $\\mathcal{H}$ 在 $x_0$ 处计算的梯度。我们用 $g = \\nabla\\mathcal{H}(x_0)$ 表示梯度向量（作为列向量），用 $J = g^T$ 表示其转置，即雅可比行向量。表达式变为：\n$$\ny \\approx \\mathcal{H}(x_0) + J (x - x_0)\n$$\n$y$ 的期望值近似为：\n$$\nE[y] \\approx E[\\mathcal{H}(x_0) + J (x - x_0)] = \\mathcal{H}(x_0) + J E[x - x_0]\n$$\n由于 $E[x] = x_0$，我们有 $E[x - x_0] = E[x] - x_0 = x_0 - x_0 = 0$。因此，$y$ 的期望值近似为 $\\mathcal{H}(x_0)$。\n$$\nE[y] \\approx \\mathcal{H}(x_0)\n$$\n$y$ 的方差 $\\sigma_y^2$ 定义为 $E[(y - E[y])^2]$。使用我们的近似：\n$$\n\\sigma_y^2 = \\text{Var}(y) \\approx E\\left[ \\left( \\left(\\mathcal{H}(x_0) + J(x-x_0)\\right) - \\mathcal{H}(x_0) \\right)^2 \\right] = E\\left[ (J(x-x_0))^2 \\right]\n$$\n由于 $J(x-x_0)$ 是一个标量，其平方可以写为其转置与自身的乘积：\n$$\n(J(x-x_0))^2 = (J(x-x_0))^T(J(x-x_0)) = (x-x_0)^T J^T J (x-x_0)\n$$\n等等，这是不正确的。乘积 $J(x-x_0)$ 是一个标量，所以我们可以将其平方写为 $(J(x-x_0))(J(x-x_0))^T$。让我们使用另一种表述方式：一个标量是其自身的转置。所以 $(J(x-x_0))^2 = (J(x-x_0)) (J(x-x_0))$。让我们使用矩阵乘法的性质 $(AB)^T = B^T A^T$。\n$$\n\\sigma_y^2 \\approx E\\left[ (J(x-x_0)) (J(x-x_0))^T \\right] = E\\left[ J(x-x_0) (x-x_0)^T J^T \\right]\n$$\n由于 $J$ 和 $J^T$ 是常数矩阵（在 $x_0$ 处计算），它们可以从期望中提出：\n$$\n\\sigma_y^2 \\approx J E\\left[(x-x_0)(x-x_0)^T\\right] J^T\n$$\n$x$ 的协方差矩阵的定义是 $\\Sigma_x = E[(x-x_0)(x-x_0)^T]$。因此，$y$ 的近似方差的表达式为：\n$$\n\\sigma_y^2 \\approx J \\Sigma_x J^T\n$$\n其中 $J = \\nabla\\mathcal{H}(x_0)^T$ 是在 $x_0$ 处计算的 $\\mathcal{H}$ 的雅可比矩阵。\n\n接下来，我们对此表达式进行数值计算。正向模型是：\n$$\n\\mathcal{H}(x) = \\alpha \\ln(1 + \\beta x_1) + \\gamma \\sqrt{x_3} + \\delta x_1 x_2\n$$\n雅可比行向量 $J = [\\frac{\\partial\\mathcal{H}}{\\partial x_1}, \\frac{\\partial\\mathcal{H}}{\\partial x_2}, \\frac{\\partial\\mathcal{H}}{\\partial x_3}]$ 的分量是：\n$$\n\\frac{\\partial\\mathcal{H}}{\\partial x_1} = \\frac{\\alpha\\beta}{1 + \\beta x_1} + \\delta x_2\n$$\n$$\n\\frac{\\partial\\mathcal{H}}{\\partial x_2} = \\delta x_1\n$$\n$$\n\\frac{\\partial\\mathcal{H}}{\\partial x_3} = \\frac{\\gamma}{2\\sqrt{x_3}}\n$$\n我们已知参数 $\\alpha = 2.5$、$\\beta = 0.8$、$\\gamma = 0.5$、$\\delta = 1.2$ 和均值状态 $x_0 = (0.7, 0.5, 550)$。我们在 $x_0$ 处计算偏导数：\n$$\nJ_1 = \\frac{\\partial\\mathcal{H}}{\\partial x_1}\\bigg|_{x_0} = \\frac{2.5 \\times 0.8}{1 + 0.8 \\times 0.7} + 1.2 \\times 0.5 = \\frac{2}{1 + 0.56} + 0.6 = \\frac{2}{1.56} + 0.6 \\approx 1.28205128 + 0.6 = 1.88205128\n$$\n$$\nJ_2 = \\frac{\\partial\\mathcal{H}}{\\partial x_2}\\bigg|_{x_0} = 1.2 \\times 0.7 = 0.84\n$$\n$$\nJ_3 = \\frac{\\partial\\mathcal{H}}{\\partial x_3}\\bigg|_{x_0} = \\frac{0.5}{2\\sqrt{550}} \\approx \\frac{0.5}{2 \\times 23.452078} \\approx 0.01065983\n$$\n所以，雅可比向量是 $J \\approx [1.882051, 0.84, 0.010660]$。\n\n协方差矩阵给定为：\n$$\n\\Sigma_{x} = \n\\begin{pmatrix}\n0.0025  & 0.0010  & 0.50 \\\\\n0.0010  & 0.0016  & 0.20 \\\\\n0.50  & 0.20  & 2500\n\\end{pmatrix}\n$$\n方差通过 $\\sigma_y^2 \\approx J \\Sigma_x J^T$ 计算。该矩阵乘法结果为展开的和：\n$$\n\\sigma_y^2 \\approx \\sum_{i=1}^{3} \\sum_{j=1}^{3} J_i J_j (\\Sigma_x)_{ij} = J_1^2 (\\Sigma_x)_{11} + J_2^2 (\\Sigma_x)_{22} + J_3^2 (\\Sigma_x)_{33} + 2J_1J_2(\\Sigma_x)_{12} + 2J_1J_3(\\Sigma_x)_{13} + 2J_2J_3(\\Sigma_x)_{23}\n$$\n我们计算每一项：\n来自 $x_1$ 方差的贡献： $J_1^2 (\\Sigma_x)_{11} \\approx (1.882051)^2 \\times 0.0025 \\approx 3.542118 \\times 0.0025 = 0.00885530$\n来自 $x_2$ 方差的贡献： $J_2^2 (\\Sigma_x)_{22} = (0.84)^2 \\times 0.0016 = 0.7056 \\times 0.0016 = 0.00112896$\n来自 $x_3$ 方差的贡献： $J_3^2 (\\Sigma_x)_{33} \\approx (0.01065983)^2 \\times 2500 \\approx 0.000113632 \\times 2500 = 0.28407993$\n\n来自 $x_1, x_2$ 协方差的贡献： $2J_1J_2(\\Sigma_x)_{12} \\approx 2 \\times 1.882051 \\times 0.84 \\times 0.0010 \\approx 0.00316185$\n来自 $x_1, x_3$ 协方差的贡献： $2J_1J_3(\\Sigma_x)_{13} \\approx 2 \\times 1.882051 \\times 0.01065983 \\times 0.50 \\approx 0.02006126$\n来自 $x_2, x_3$ 协方差的贡献： $2J_2J_3(\\Sigma_x)_{23} \\approx 2 \\times 0.84 \\times 0.01065983 \\times 0.20 \\approx 0.00358170$\n\n将所有贡献相加：\n$$\n\\sigma_y^2 \\approx 0.00885530 + 0.00112896 + 0.28407993 + 0.00316185 + 0.02006126 + 0.00358170\n$$\n$$\n\\sigma_y^2 \\approx 0.320869\n$$\n问题要求结果四舍五入至四位有效数字。\n$$\n\\sigma_y^2 \\approx 0.3209\n$$\n方差的单位是 $y$ 单位的平方，即 $(\\text{g C m}^{-2}\\,\\text{d}^{-1})^{2}$。",
            "answer": "$$\n\\boxed{0.3209}\n$$"
        },
        {
            "introduction": "在量化了模型总的输出不确定性之后，下一个合乎逻辑的问题是：哪些输入参数是造成这种不确定性的主要“元凶”？本练习介绍了一种更高级的全局敏感性分析方法，即基于方差的索博尔指数（Sobol indices），用于将输出方差分解到各个输入参数上。掌握这项技能对于确定模型改进、数据采集和科学研究的优先方向至关重要 ()。",
            "id": "3809326",
            "problem": "在遥感和环境建模中，环境模型的一个核心目的是量化参数中的不确定性如何传播到预测通量的不确定性中，以便为数据收集和模型优化确定优先级。考虑一个简化的蒸散（ET）模型，其中预测的日通量 $y$ 表示为参考潜在蒸散量 $E_{0}$ 与两个不确定的独立参数（能量分配系数 $\\theta_{1}$ 和空气动力学尺度因子 $\\theta_{2}$）的乘积。具体来说，令\n$$\ny \\;=\\; \\theta_{1}\\,\\theta_{2}\\,E_{0},\n$$\n其中 $E_{0}$ 是一个固定常数，表示晴空条件下的参考潜在蒸散量，单位为毫米/天（mm day$^{-1}$）。假设 $\\theta_{1} \\sim \\mathrm{Uniform}(0,1)$ 和 $\\theta_{2} \\sim \\mathrm{Uniform}(0,1)$ 是独立的，并且代表了由于校准和场地异质性引起的认知不确定性。仅使用针对独立输入的方差分解和条件期望的第一性原理，推导并计算 $\\theta_{1}$ 和 $\\theta_{2}$ 相对于 $y$ 的一阶基于方差的 Sobol 灵敏度指数。将两个指数表示为精确分数，并以包含这两个指数的行矩阵形式提供最终答案。最终答案中不需要单位，因为 Sobol 指数是无量纲的。在您的推导过程中，用一两句话解释哪个参数主导了 $y$ 的方差。",
            "solution": "首先根据指定标准验证问题。\n\n### 第1步：提取已知条件\n-   预测日通量 $y$ 的模型：$y = \\theta_{1}\\,\\theta_{2}\\,E_{0}$\n-   $E_{0}$：一个代表参考潜在蒸散量的固定常数。\n-   $\\theta_{1}$：能量分配系数，分布为 $\\theta_{1} \\sim \\mathrm{Uniform}(0,1)$。\n-   $\\theta_{2}$：空气动力学尺度因子，分布为 $\\theta_{2} \\sim \\mathrm{Uniform}(0,1)$。\n-   $\\theta_{1}$ 和 $\\theta_{2}$ 是独立的。\n-   目标：推导并计算 $\\theta_{1}$ 和 $\\theta_{2}$ 相对于 $y$ 的一阶基于方差的 Sobol 灵敏度指数。\n-   方法：使用方差分解和条件期望的第一性原理。\n-   输出格式：以行矩阵形式表示的精确分数指数。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于不确定性量化和灵敏度分析这一成熟领域，特别是使用了 Sobol 指数，这是一种分析环境和工程模型的标准技术。模型形式虽然简单，但是对物理系统中常见的乘法效应的合理解释。\n-   **适定性**：该问题是适定的。模型函数、输入参数分布及其独立性都已明确定义。待计算的量（一阶 Sobol 指数）有精确的数学定义，确保存在唯一解。\n-   **客观性**：问题以精确、客观和定量的术语陈述。\n-   **完整性和一致性**：提供了所有必要信息，没有矛盾之处。\n\n### 第3步：结论和行动\n问题有效。有必要给出完整解答。\n\n***\n\n参数 $\\theta_i$ 相对于输出 $y$ 的一阶 Sobol 灵敏度指数 $S_i$ 定义为 $y$ 的总方差中仅由 $\\theta_i$ 的方差贡献的部分。在数学上，它由下式给出：\n$$\nS_i = \\frac{V_i}{\\mathrm{Var}(y)} = \\frac{\\mathrm{Var}_{\\theta_i}\\left(E_{\\theta_{\\sim i}}(y | \\theta_i)\\right)}{\\mathrm{Var}(y)}\n$$\n其中 $\\mathrm{Var}(y)$ 是输出的总方差，$V_i$ 是由 $\\theta_i$ 引起的偏方差，而项 $E_{\\theta_{\\sim i}}(y | \\theta_i)$ 是在固定 $\\theta_i$ 值的条件下，对除 $\\theta_i$ 之外的所有参数（记作 $\\theta_{\\sim i}$）求取的输出 $y$ 的期望值。\n\n参数 $\\theta_{1}$ 和 $\\theta_{2}$ 独立且服从相同的 $\\mathrm{Uniform}(0,1)$ 分布。对于一个随机变量 $X \\sim \\mathrm{Uniform}(a,b)$，其期望为 $E[X] = \\frac{a+b}{2}$，其方差为 $\\mathrm{Var}(X) = \\frac{(b-a)^2}{12}$。\n对于 $\\theta_1$ 和 $\\theta_2$，有 $a=0$ 和 $b=1$：\n$$\nE[\\theta_1] = E[\\theta_2] = \\frac{0+1}{2} = \\frac{1}{2}\n$$\n$$\n\\mathrm{Var}(\\theta_1) = \\mathrm{Var}(\\theta_2) = \\frac{(1-0)^2}{12} = \\frac{1}{12}\n$$\n我们还需要二阶矩 $E[\\theta_i^2]$。使用关系式 $\\mathrm{Var}(X) = E[X^2] - (E[X])^2$：\n$$\nE[\\theta_i^2] = \\mathrm{Var}(\\theta_i) + (E[\\theta_i])^2 = \\frac{1}{12} + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{12} + \\frac{1}{4} = \\frac{1+3}{12} = \\frac{4}{12} = \\frac{1}{3}\n$$\n对于 $i=1,2$。\n\n首先，我们计算输出的总方差 $\\mathrm{Var}(y)$。\n$$\ny = \\theta_{1}\\,\\theta_{2}\\,E_{0}\n$$\n由于 $E_{0}$ 是一个常数，其平方可以从方差中提取出来：\n$$\n\\mathrm{Var}(y) = \\mathrm{Var}(\\theta_{1}\\,\\theta_{2}\\,E_{0}) = E_{0}^2 \\mathrm{Var}(\\theta_{1}\\,\\theta_{2})\n$$\n两个独立变量 $\\theta_1$ 和 $\\theta_2$ 的乘积的方差由 $\\mathrm{Var}(\\theta_{1}\\,\\theta_{2}) = E[\\theta_1^2]E[\\theta_2^2] - (E[\\theta_1]E[\\theta_2])^2$ 给出。\n$$\nE[\\theta_{1}\\,\\theta_{2}] = E[\\theta_1]E[\\theta_2] = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}\n$$\n$$\nE[(\\theta_{1}\\,\\theta_{2})^2] = E[\\theta_1^2 \\theta_2^2] = E[\\theta_1^2]E[\\theta_2^2] = \\frac{1}{3} \\times \\frac{1}{3} = \\frac{1}{9}\n$$\n因此，乘积的方差为：\n$$\n\\mathrm{Var}(\\theta_{1}\\,\\theta_{2}) = \\frac{1}{9} - \\left(\\frac{1}{4}\\right)^2 = \\frac{1}{9} - \\frac{1}{16} = \\frac{16-9}{144} = \\frac{7}{144}\n$$\n因此，$y$ 的总方差为：\n$$\n\\mathrm{Var}(y) = E_{0}^2 \\frac{7}{144}\n$$\n接下来，我们计算 $\\theta_1$ 的一阶偏方差，记作 $V_1 = \\mathrm{Var}_{\\theta_1}(E_{\\theta_2}(y | \\theta_1))$。\n首先，求内部的条件期望，我们在保持 $\\theta_1$ 固定的同时对 $\\theta_2$ 求平均：\n$$\nE_{\\theta_2}(y | \\theta_1) = E_{\\theta_2}(\\theta_{1}\\,\\theta_{2}\\,E_{0} | \\theta_1) = \\theta_1 E_0 E_{\\theta_2}[\\theta_2]\n$$\n代入 $E[\\theta_2] = 1/2$：\n$$\nE_{\\theta_2}(y | \\theta_1) = \\theta_1 E_0 \\left(\\frac{1}{2}\\right) = \\frac{E_0}{2}\\theta_1\n$$\n现在，我们计算该表达式关于 $\\theta_1$ 的方差：\n$$\nV_1 = \\mathrm{Var}_{\\theta_1}\\left(\\frac{E_0}{2}\\theta_1\\right) = \\left(\\frac{E_0}{2}\\right)^2 \\mathrm{Var}_{\\theta_1}(\\theta_1) = \\frac{E_0^2}{4} \\times \\frac{1}{12} = \\frac{E_0^2}{48}\n$$\n$\\theta_1$ 的一阶 Sobol 指数是偏方差 $V_1$ 与总方差 $\\mathrm{Var}(y)$ 的比值：\n$$\nS_1 = \\frac{V_1}{\\mathrm{Var}(y)} = \\frac{E_0^2 / 48}{E_0^2 (7/144)} = \\frac{1}{48} \\times \\frac{144}{7} = \\frac{3}{7}\n$$\n模型 $y = \\theta_1 \\theta_2 E_0$ 关于 $\\theta_1$ 和 $\\theta_2$ 是对称的，且两个参数服从相同的分布。因此，$S_2$ 的计算将得到相同的结果。具体地：\n$$\nE_{\\theta_1}(y | \\theta_2) = E_{\\theta_1}(\\theta_{1}\\,\\theta_{2}\\,E_{0} | \\theta_2) = \\theta_2 E_0 E_{\\theta_1}[\\theta_1] = \\frac{E_0}{2}\\theta_2\n$$\n$$\nV_2 = \\mathrm{Var}_{\\theta_2}\\left(\\frac{E_0}{2}\\theta_2\\right) = \\left(\\frac{E_0}{2}\\right)^2 \\mathrm{Var}_{\\theta_2}(\\theta_2) = \\frac{E_0^2}{4} \\times \\frac{1}{12} = \\frac{E_0^2}{48}\n$$\n$$\nS_2 = \\frac{V_2}{\\mathrm{Var}(y)} = \\frac{E_0^2 / 48}{E_0^2 (7/144)} = \\frac{3}{7}\n$$\n由于一阶指数 $S_1$ 和 $S_2$ 相等，因此没有哪个参数单独主导模型输出 $y$ 的方差。它们各自占总方差的相同部分。\n\n$\\theta_{1}$ 和 $\\theta_{2}$ 的一阶灵敏度指数分别为 $S_1 = 3/7$ 和 $S_2 = 3/7$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{7}  & \\frac{3}{7}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "建立和分析模型本身并不足够；我们还必须严格评估其在未见数据上的预测性能。这项练习直面环境科学中的一个关键挑战：当数据存在时空自相关时，如何进行有效的交叉验证。通过理解随机交叉验证的陷阱并探索块状交叉验证等替代方案，你可以确保对模型泛化能力的评估是稳健可靠的，而非过于乐观的误判 ()。",
            "id": "3809316",
            "problem": "考虑一个时空环境建模任务，其中空间位置 $s$ 和日期 $t$ 的每日地表温度被建模为 $y(s,t) = w(s,t) + \\epsilon(s,t)$，其中 $w(s,t)$ 是一个零均值的潜在场，用于捕捉结构化的空间和时间变异性，而 $\\epsilon(s,t)$ 是零均值的测量噪声。假设 $w(s,t)$ 是一个平稳高斯过程（GP），其协方差函数为 $C(h,u) = \\sigma_w^2 \\exp\\!\\left(-\\frac{h}{\\phi_s}\\right)\\exp\\!\\left(-\\frac{|u|}{\\phi_t}\\right)$，其中 $h$ 是空间距离，$u$ 是时间间隔，并且 $\\epsilon(s,t)$ 在不同位置和时间上是独立的，其方差为 $\\sigma_\\epsilon^2$。交叉验证（CV）旨在估计样本外泛化误差，定义为 $R = \\mathbb{E}\\big[(y^*(s,t) - \\hat{y}(s,t))^2\\big]$，其中期望是针对新的测试点 $(s,t)$ 和用于构建 $\\hat{y}$ 的训练数据计算的。\n\n为了明确时空依赖性的作用，考虑以下评估设置和一个简单的预测器，该预测器使用时空上最近的训练观测值作为预测值：$\\hat{y}(s^*,t^*) = y(s_{\\text{nn}},t_{\\text{nn}})$，其中 $(s_{\\text{nn}},t_{\\text{nn}})$ 是在空间和时间上最接近 $(s^*,t^*)$ 的训练点。设 $\\sigma_w^2 = 9$，$\\sigma_\\epsilon^2 = 1$，$\\phi_s = 30\\ \\text{km}$，以及 $\\phi_t = 3\\ \\text{days}$。假设对一个密集数据集应用随机 $K$ 折交叉验证，使得测试点通常具有空间距离为 $h_{\\text{cv}} = 10\\ \\text{km}$、时间间隔为 $u_{\\text{cv}} = 1\\ \\text{day}$ 的最近训练邻居。相比之下，假设计划的部署需要外推到一个新的区域和未来的时期，其中典型的距离为 $h_{\\text{dep}} = 90\\ \\text{km}$、时间间隔为 $u_{\\text{dep}} = 7\\ \\text{days}$。根据高斯过程协方差的基本原理以及 $\\epsilon(s,t)$ 在不同位置和时间上的独立性，对于具有最近训练邻居 $(s,t)$ 的测试点 $(s^*,t^*)$，最近邻预测器的均方误差（MSE）由 $y(s^*,t^*) - y(s,t)$ 的方差决定。\n\n基于此设置，选择所有正确的陈述：\n\nA. 在给定的协方差下，预期的随机交叉验证均方误差严格小于预期的区域外和时间外部署误差，因为 $C(h,u)$ 随着 $h$ 和 $|u|$ 的增加而减小，并且误差方差 $2\\sigma_\\epsilon^2 + 2\\sigma_w^2 - 2C(h,u)$ 随着距离的增加而增加。\n\nB. 在随机交叉验证中增加折数 $K$ 可以消除由空间自相关引起的乐观偏差，即使训练点和测试点在空间和时间上交错分布，也能产生对部署误差的无偏估计。\n\nC. 强制训练集-测试集分离距离超过相关范围（例如 $h \\gg \\phi_s$ 和 $|u| \\gg \\phi_t$）的时空块交叉验证，可以对具有相似分离尺度的、向新区域和新时间的部署误差，产生一个近似无偏的估计。\n\nD. 留一位置交叉验证（Leave-one-location-out cross-validation）移除单个空间站点的所有观测数据，但保留附近站点在同一天的观测数据，无论空间自相关强度如何，它都能保证对时间外泛化（out-of-time generalization）是无偏的。\n\nE. 在量化交叉验证风险的不确定性时忽略空间自相关，会导致对不确定性的低估，因为在正自相关的情况下，有效样本量 $n_{\\text{eff}}$ 小于 $n$，这相对于独立同分布的情况，会夸大风险估计量的方差。\n\n你的答案必须是选项 A–E 的一个子集。",
            "solution": "用户要求对问题陈述进行严格验证，然后对每个选项进行详细的推导和评估。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- **模型：** 一个时空过程被建模为 $y(s,t) = w(s,t) + \\epsilon(s,t)$，其中 $s$ 是空间位置，$t$ 是时间。\n- **潜在场：** $w(s,t)$ 是一个零均值的平稳高斯过程（GP），其可分离协方差函数为 $C(h,u) = \\sigma_w^2 \\exp\\!\\left(-\\frac{h}{\\phi_s}\\right)\\exp\\!\\left(-\\frac{|u|}{\\phi_t}\\right)$。\n- **噪声：** $\\epsilon(s,t)$ 是零均值测量噪声，在所有 $s$ 和 $t$ 上独立，方差为 $\\sigma_\\epsilon^2$。\n- **参数：** $\\sigma_w^2 = 9$，$\\sigma_\\epsilon^2 = 1$，$\\phi_s = 30\\ \\text{km}$ (空间相关长度)，$\\phi_t = 3\\ \\text{days}$ (时间相关长度)。\n- **预测器：** 一个最近邻预测器，$\\hat{y}(s^*,t^*) = y(s_{\\text{nn}},t_{\\text{nn}})$。\n- **误差度量：** 均方误差（MSE），定义为 $\\mathbb{E}\\big[(y^*(s,t) - \\hat{y}(s,t))^2\\big]$，对于给定的预测器，即为 $\\text{Var}(y(s^*,t^*) - y(s_{\\text{nn}},t_{\\text{nn}}))$。\n- **交叉验证（CV）场景：** 随机 $K$ 折交叉验证，典型的最近邻距离为 $h_{\\text{cv}} = 10\\ \\text{km}$ 和 $u_{\\text{cv}} = 1\\ \\text{day}$。\n- **部署场景：** 外推到一个新的区域和时间，典型的最近邻距离为 $h_{\\text{dep}} = 90\\ \\text{km}$ 和 $u_{\\text{dep}} = 7\\ \\text{days}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n1.  **科学依据：** 该问题牢固地建立在地理统计学和机器学习的既定原则之上。该模型（GP + 噪声）是时空数据的标准工具。可分离指数协方差是一种有效且常用的协方差函数。在存在自相关的情况下讨论交叉验证的挑战是环境建模背景下的一个核心且关键的话题。该表述在科学上是合理的。\n2.  **适定性：** 这是一个适定问题。它提供了一个清晰的模型、具体的参数以及两个不同的比较场景（CV vs. 部署）。选项中提出的问题可以根据所提供的信息和既定的统计理论来回答。\n3.  **客观性：** 问题以精确、客观和定量的术语陈述。没有主观或模糊的语言。\n\n问题陈述没有违反任何指定的无效标准。它在科学上是合理的、适定的、客观的，并为对相关性数据的交叉验证方法进行概念性分析提供了一个完整且一致的设置。\n\n**第 3 步：结论和行动**\n问题是**有效的**。开始进行解答。\n\n### 推导与选项分析\n\n需要分析的基本量是最近邻预测器的均方误差（MSE）。设一个测试点为 $(s^*, t^*)$，其最近的训练邻居为 $(s,t)$，空间距离为 $h$，时间间隔为 $u$。MSE 是：\n$$\n\\text{MSE}(h,u) = \\mathbb{E}\\left[ \\left( y(s^*,t^*) - y(s,t) \\right)^2 \\right]\n$$\n由于模型分量的均值为零，MSE 即为差值的方差：\n$$\n\\text{MSE}(h,u) = \\text{Var}\\left( y(s^*,t^*) - y(s,t) \\right)\n$$\n代入 $y(s,t) = w(s,t) + \\epsilon(s,t)$:\n$$\n\\text{MSE}(h,u) = \\text{Var}\\left( (w(s^*,t^*) + \\epsilon(s^*,t^*)) - (w(s,t) + \\epsilon(s,t)) \\right)\n$$\n$$\n\\text{MSE}(h,u) = \\text{Var}\\left( (w(s^*,t^*) - w(s,t)) + (\\epsilon(s^*,t^*) - \\epsilon(s,t)) \\right)\n$$\n由于潜在场 $w$ 和噪声 $\\epsilon$ 是独立的，和的方差等于方差的和：\n$$\n\\text{MSE}(h,u) = \\text{Var}(w(s^*,t^*) - w(s,t)) + \\text{Var}(\\epsilon(s^*,t^*) - \\epsilon(s,t))\n$$\n对于噪声项，由于 $\\epsilon(s^*,t^*)$ 和 $\\epsilon(s,t)$ 位于不同的时空点，它们是独立的。\n$$\n\\text{Var}(\\epsilon(s^*,t^*) - \\epsilon(s,t)) = \\text{Var}(\\epsilon(s^*,t^*)) + \\text{Var}(\\epsilon(s,t)) = \\sigma_\\epsilon^2 + \\sigma_\\epsilon^2 = 2\\sigma_\\epsilon^2\n$$\n对于 GP 项，使用属性 $\\text{Var}(X-Y) = \\text{Var}(X) + \\text{Var}(Y) - 2\\text{Cov}(X,Y)$:\n$$\n\\text{Var}(w(s^*,t^*) - w(s,t)) = \\text{Var}(w(s^*,t^*)) + \\text{Var}(w(s,t)) - 2\\text{Cov}(w(s^*,t^*), w(s,t))\n$$\n由于 GP $w$ 是平稳的，$\\text{Var}(w(s,t))$ 是一个常数，等于零距离处的协方差，即 $C(0,0) = \\sigma_w^2$。两点之间的协方差是 $C(h,u)$。\n$$\n\\text{Var}(w(s^*,t^*) - w(s,t)) = \\sigma_w^2 + \\sigma_w^2 - 2C(h,u) = 2\\sigma_w^2 - 2C(h,u)\n$$\n结合这些结果，MSE 为：\n$$\n\\text{MSE}(h,u) = 2\\sigma_w^2 + 2\\sigma_\\epsilon^2 - 2C(h,u)\n$$\n这证实了选项 A 中给出的公式。\n\n现在我们评估每个选项。\n\n**A. 在给定的协方差下，预期的随机交叉验证均方误差严格小于预期的区域外和时间外部署误差，因为 $C(h,u)$ 随着 $h$ 和 $|u|$ 的增加而减小，并且误差方差 $2\\sigma_\\epsilon^2 + 2\\sigma_w^2 - 2C(h,u)$ 随着距离的增加而增加。**\n\n- **分析：** 该陈述比较了随机 CV 的误差与部署误差。\n    - 协方差函数是 $C(h,u) = \\sigma_w^2 \\exp\\!\\left(-\\frac{h}{\\phi_s}\\right)\\exp\\!\\left(-\\frac{|u|}{\\phi_t}\\right)$。对于正的 $h, |u|, \\phi_s, \\phi_t$，两个指数项都是距离的严格递减函数，因此 $C(h,u)$ 是 $h$ 和 $|u|$ 的严格递减函数。\n    - MSE 是 $2\\sigma_w^2 + 2\\sigma_\\epsilon^2 - 2C(h,u)$。随着距离 $(h, |u|)$ 的增加，$C(h,u)$ 减小。因此，$-2C(h,u)$ 增加，整个 MSE 表达式也增加。\n    - 问题陈述 $h_{\\text{cv}} = 10\\ \\text{km} < h_{\\text{dep}} = 90\\ \\text{km}$ 和 $u_{\\text{cv}} = 1\\ \\text{day} < u_{\\text{dep}} = 7\\ \\text{days}$。\n    - 因为随机 CV 的距离更小，所以协方差会更大：$C(h_{\\text{cv}}, u_{\\text{cv}}) > C(h_{\\text{dep}}, u_{\\text{dep}})$。\n    - 这直接意味着随机 CV 产生的 MSE 会更小：$\\text{MSE}(h_{\\text{cv}}, u_{\\text{cv}}) < \\text{MSE}(h_{\\text{dep}}, u_{\\text{dep}})$。\n    - 数值上：\n      - $\\text{MSE}_{\\text{cv}} = 2(9) + 2(1) - 2(9) \\exp(-\\frac{10}{30}) \\exp(-\\frac{1}{3}) = 20 - 18 e^{-2/3} \\approx 20 - 18(0.513) = 10.766$\n      - $\\text{MSE}_{\\text{dep}} = 2(9) + 2(1) - 2(9) \\exp(-\\frac{90}{30}) \\exp(-\\frac{7}{3}) = 20 - 18 e^{-3} e^{-7/3} \\approx 20 - 18(0.050)(0.097) = 19.913$\n    - 随机 CV 误差确实远小于部署误差，导致了乐观偏差。选项中提供的推理是正确的。\n- **结论：** 正确。\n\n**B. 在随机交叉验证中增加折数 $K$ 可以消除由空间自相关引起的乐观偏差，即使训练点和测试点在空间和时间上交错分布，也能产生对部署误差的无偏估计。**\n\n- **分析：** 该陈述表明，在随机 $K$ 折交叉验证中增加 $K$ 值可以解决乐观偏差问题。对于一个大小为 $n$ 的数据集，每折使用大小为 $n(K-1)/K$ 的训练集。随着 $K$ 的增加，训练集变大。对于密集数据，更大的训练集意味着对于任何给定的测试点，找到一个更近的训练点的概率会增加。这将使平均距离 $h_{\\text{cv}}$ 和 $u_{\\text{cv}}$ 更小，从而增强自相关效应，并使 CV 误差估计更加乐观（进一步低估了真实的部署误差）。根本问题是训练/测试点的交错分布，这并不能通过增加 $K$ 来解决。\n- **结论：** 错误。\n\n**C. 强制训练集-测试集分离距离超过相关范围（例如 $h \\gg \\phi_s$ 和 $|u| \\gg \\phi_t$）的时空块交叉验证，可以对具有相似分离尺度的、向新区域和新时间的部署误差，产生一个近似无偏的估计。**\n\n- **分析：** 这描述了块交叉验证，一种专为相关性数据设计的技术。通过在空间和/或时间上留出连续的数据块，它强制在训练集和测试集之间产生分离。这模拟了外推场景，而这正是部署的目标。如果选择的块结构能够创建与部署中预期的分离距离（$h_{\\text{dep}}, u_{\\text{dep}}$）在统计上相似的训练-测试分离，那么通过此 CV 过程估计的 MSE 将是对真实部署误差的一个更好、且可能近似无偏的估计。条件 $h \\gg \\phi_s$ 和 $|u| \\gg \\phi_t$ 对应于一个部署场景，其中外推到足够远的位置以至于相关性可以忽略不计（$C(h,u) \\approx 0$）。在这种情况下，块 CV 误差和部署误差都将接近 $2\\sigma_w^2 + 2\\sigma_\\epsilon^2 = 20$，从而提供一个无偏估计。该陈述正确地指出了块 CV 的原理和目的。\n- **结论：** 正确。\n\n**D. 留一位置交叉验证（Leave-one-location-out cross-validation）移除单个空间站点的所有观测数据，但保留附近站点在同一天的观测数据，无论空间自相关强度如何，它都能保证对时间外泛化（out-of-time generalization）是无偏的。**\n\n- **分析：** 这描述了留一位置交叉验证（LOLO CV）。在这种方案中，一个站点 $s^*$ 的所有数据都用于测试。训练集包括所有其他站点的所有数据，包括测试集中出现的时间点的数据。对于一个测试点 $(s^*, t^*)$，训练集包含在附近位置 $s$ 但在同一时间 $t^*$ 的点 $(s, t^*)$。模型可以利用在时间 $t^*$ 的强空间相关性来预测 $y(s^*, t^*)$。因此，此过程评估的是模型的空间插值能力，而不是时间外推能力。“时间外泛化”的目标意味着仅根据过去的数据来预测未来的时间。LOLO CV 并没有模拟这一点。它的误差估计对于时间外推将是高度乐观的，并且随着空间自相关性的增强，这种乐观性会更严重，这直接与该陈述相矛盾。\n- **结论：** 错误。\n\n**E. 在量化交叉验证风险的不确定性时忽略空间自相关，会导致对不确定性的低估，因为在正自相关的情况下，有效样本量 $n_{\\text{eff}}$ 小于 $n$，这相对于独立同分布的情况，会夸大风险估计量的方差。**\n\n- **分析：** 该陈述关注交叉验证风险估计本身的方差（即我们性能估计的不确定性）。风险通常通过对测试集上的平方误差求平均来估计：$\\hat{R} = (1/N) \\sum_{i=1}^N (y_i - \\hat{y}_i)^2$。该均值的标准方差公式，如 $\\text{Var}(\\hat{R}) \\approx \\text{Var}((y-\\hat{y})^2)/N$，假设平方误差项是独立的。然而，由于底层数据 $y_i$ 是自相关的，预测误差 $(y_i - \\hat{y}_i)$ 也是相关的。在正自相关的情况下，和的方差中的协方差项为正，这会增加总方差。这种现象通常用有效样本量 $n_{\\text{eff}}$ 的概念来描述，当数据呈正相关时，它小于名义样本量 $n$。在方差计算中使用 $n$ 而不是 $n_{\\text{eff}}$ 将导致方差被低估，从而导致对风险的置信区间过于乐观。该陈述的最后一部分“这相对于独立同分布的情况，会夸大风险估计量的方差”的措辞有些含糊，但其意图似乎是“存在自相关这一事实，会夸大风险估计量的方差（相较于独立同分布情况）”。基于此解释，整个陈述是正确的。其核心观点“忽略自相关会导致对（风险估计）不确定性的低估”是绝对正确的。\n- **结论：** 正确。",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}