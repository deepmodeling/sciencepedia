{
    "hands_on_practices": [
        {
            "introduction": "一个稳健的环境模型通常始于基本的物理定律。本练习 () 旨在挑战您从能量守恒和质量传输的第一性原理出发，推导出著名的Penman-Monteith蒸散发方程。这个练习将展示复杂的环境过程如何被浓缩在一个强大的方程中，并引入敏感性分析来理解关键参数对模型的控制作用。",
            "id": "3809774",
            "problem": "在一个为高草冠层设计的遥感驱动工作流中，正在开发一个陆面能量平衡模型。卫星和原位产品提供净辐射和近地面湿度，而空气动力学和冠层交换参数由一个冠层-大气模块提供。您的任务是从第一性原理出发，推导蒸散（ET）速率，并量化其对冠层阻力的局部敏感性，该方法需与 Penman–Monteith 的概念框架一致。\n\n从陆面能量守恒以及感热和水汽的整体输送定律出发，推导潜热通量（LE）以及蒸散的解析表达式，该表达式是净辐射、饱和水汽压差、空气动力学导度和冠层阻力的函数。在您的推导中，请使用以下基于物理的定义：陆面能量平衡 $R_{n}-G=H+\\mathrm{LE}$，感热的整体输送 $H=\\rho c_{p} g_{a}\\left(T_{s}-T_{a}\\right)$，围绕气温的饱和水汽压线性化 $e_{s}\\left(T_{s}\\right)\\approx e_{s}\\left(T_{a}\\right)+s\\left(T_{s}-T_{a}\\right)$，饱和水汽压差 $\\mathrm{VPD}=e_{s}\\left(T_{a}\\right)-e_{a}$，以及湿度计常数 $\\gamma=\\frac{c_{p}P}{\\varepsilon \\lambda}$，其中 $\\varepsilon$ 是水的分子量与干空气分子量之比。将蒸散 $E$ 表示为质量通量，使用 $\\mathrm{LE}=\\lambda E$。\n\n然后，将空气动力学导度和所有气象项视为常数，计算 $E$ 对冠层阻力 $r_{c}$ 的局部对数敏感度（弹性），其定义为 $\\epsilon_{r_{c}}=\\frac{\\partial E}{\\partial r_{c}}\\frac{r_{c}}{E}$，并在以下正午条件下，使用严格的国际单位制对其进行数值评估：\n\n- 可用能量 $A=R_{n}-G$ 为 $180\\,\\mathrm{W\\,m^{-2}}$（为简洁起见，使用 $A$）。\n- 饱和水汽压差（VPD）为 $1.2\\,\\mathrm{kPa}$。\n- 空气动力学导度 $g_{a}$ 为 $0.02\\,\\mathrm{m\\,s^{-1}}$。\n- 冠层阻力 $r_{c}$ 为 $70\\,\\mathrm{s\\,m^{-1}}$。\n- 空气密度 $\\rho$ 为 $1.2\\,\\mathrm{kg\\,m^{-3}}$。\n- 空气定压比热 $c_{p}$ 为 $1005\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 蒸发潜热 $\\lambda$ 为 $2.45\\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$。\n- 饱和水汽压曲线斜率 $s$ 为 $0.188\\,\\mathrm{kPa\\,K^{-1}}$。\n- 湿度计常数 $\\gamma$ 为 $0.066\\,\\mathrm{kPa\\,K^{-1}}$。\n\n使用 $1\\,\\mathrm{kPa}=1000\\,\\mathrm{Pa}$ 和 $1\\,\\mathrm{W}=1\\,\\mathrm{J\\,s^{-1}}$，并明确说明如何保持单位一致性。您可以假设压强接近海平面气压，温度适中，因此给定的 $s$ 和 $\\gamma$ 是合适的。\n\n作为您推理的一部分，请简要论证所推导的表达式结构如何揭示能量供应和空气动力学-气孔耦合对蒸散的竞争性控制，并确定在所述条件下哪些参数对 $E$ 的影响最大。\n\n请提供弹性 $\\epsilon_{r_{c}}$ 的数值作为您的唯一最终答案，该数值应为无量纲小数，并四舍五入到三位有效数字。",
            "solution": "该问题要求推导蒸散的 Penman-Monteith 方程，分析其控制因素，并计算蒸散对冠层阻力的敏感度。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n- 陆面能量平衡：$R_{n}-G=H+\\mathrm{LE}$\n- 可用能量定义：$A = R_{n}-G$\n- 感热通量：$H=\\rho c_{p} g_{a}\\left(T_{s}-T_{a}\\right)$\n- 饱和水汽压线性化：$e_{s}\\left(T_{s}\\right)\\approx e_{s}\\left(T_{a}\\right)+s\\left(T_{s}-T_{a}\\right)$\n- 饱和水汽压差：$\\mathrm{VPD}=e_{s}\\left(T_{a}\\right)-e_{a}$\n- 湿度计常数定义：$\\gamma=\\frac{c_{p}P}{\\varepsilon \\lambda}$\n- 蒸散与潜热通量关系：$\\mathrm{LE}=\\lambda E$\n- 用于弹性计算的数值：\n  - $A = 180\\,\\mathrm{W\\,m^{-2}}$\n  - $\\mathrm{VPD} = 1.2\\,\\mathrm{kPa}$\n  - $g_{a} = 0.02\\,\\mathrm{m\\,s^{-1}}$\n  - $r_{c} = 70\\,\\mathrm{s\\,m^{-1}}$\n  - $\\rho = 1.2\\,\\mathrm{kg\\,m^{-3}}$\n  - $c_{p} = 1005\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n  - $\\lambda = 2.45\\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$\n  - $s = 0.188\\,\\mathrm{kPa\\,K^{-1}}$\n  - $\\gamma = 0.066\\,\\mathrm{kPa\\,K^{-1}}$\n- 单位换算：$1\\,\\mathrm{kPa}=1000\\,\\mathrm{Pa}$，$1\\,\\mathrm{W}=1\\,\\mathrm{J\\,s^{-1}}$\n- 任务1：推导潜热通量（$\\mathrm{LE}$）和蒸散（$E$）的解析表达式。\n- 任务2：计算 $E$ 对冠层阻力 $r_{c}$ 的局部对数敏感度（弹性），定义为 $\\epsilon_{r_{c}}=\\frac{\\partial E}{\\partial r_{c}}\\frac{r_{c}}{E}$。\n- 任务3：简要论证推导出的表达式如何揭示对蒸散的竞争性控制。\n\n**步骤2：使用提取的给定信息进行验证**\n- **科学依据充分：** 该问题基于陆面能量平衡和整体输送定律的基本原理，这些是微气象学和水文学的基石。Penman-Monteith 方程是标准的、基于物理的蒸散模型。所有定义和关系都是该领域的标准。\n- **问题定义明确：** 问题定义清晰，提供了足够的信息来推导所需表达式并计算数值。要求的输出是一个唯一的、稳定的量。\n- **客观性：** 语言精确且量化。给定值对于植被覆盖表面在正午条件下的情况是物理上现实的。\n- **完整性和一致性：** 问题提供了所有必要的方程、常数和变量。没有矛盾之处。定义与标准推导一致。\n- **结论：** 问题有效。\n\n**步骤3：结论与行动**\n问题有效，可以按所述方式解决。\n\n### Penman-Monteith 方程的推导\n\n目标是找到一个潜热通量 $\\mathrm{LE}$ 的表达式，该表达式消除了未测量的地表温度 $T_s$。\n\n我们从给定的控制方程开始：\n1.  陆面能量平衡：$A = H + \\mathrm{LE}$\n2.  感热通量：$H = \\rho c_p g_a (T_s - T_a)$\n\n潜热通量 $\\mathrm{LE}$ 是水汽通量 $E$ 的能量当量。该通量由从地表到空气的水汽压梯度 $(e_s(T_s) - e_a)$ 驱动，并受到两个串联阻力的阻碍：空气动力学阻力 $r_a = 1/g_a$ 和冠层阻力 $r_c$。水汽的总导度为 $g_v = 1/(r_a + r_c) = 1/(1/g_a + r_c) = g_a / (1 + g_a r_c)$。$\\mathrm{LE}$ 的整体输送公式与 $H$ 的公式类似，其中包含了作为能量和水汽压单位之间转换因子的湿度计常数 $\\gamma$：\n$$ \\mathrm{LE} = \\frac{\\rho c_p}{\\gamma} g_v (e_s(T_s) - e_a) = \\frac{\\rho c_p}{\\gamma} \\frac{g_a}{1+g_a r_c} (e_s(T_s) - e_a) $$\n这个 $\\mathrm{LE}$ 的表达式包含未知的地表水汽压 $e_s(T_s)$，它依赖于未知的地表温度 $T_s$。我们使用其他方程来消除 $T_s$。\n\n从感热通量方程（2）中，我们分离出地表-空气温差：\n$$ T_s - T_a = \\frac{H}{\\rho c_p g_a} \\quad (3) $$\n将此代入所提供的饱和水汽压曲线的线性化表达式中：\n$$ e_s(T_s) \\approx e_s(T_a) + s(T_s - T_a) = e_s(T_a) + s \\frac{H}{\\rho c_p g_a} $$\n现在，将这个线性化的 $e_s(T_s)$ 代入 $\\mathrm{LE}$ 的表达式中：\n$$ \\mathrm{LE} = \\frac{\\rho c_p}{\\gamma} \\frac{g_a}{1+g_a r_c} \\left( \\left( e_s(T_a) + s \\frac{H}{\\rho c_p g_a} \\right) - e_a \\right) $$\n使用定义 $\\mathrm{VPD} = e_s(T_a) - e_a$，我们简化得到：\n$$ \\mathrm{LE} = \\frac{\\rho c_p}{\\gamma} \\frac{g_a}{1+g_a r_c} \\left( \\mathrm{VPD} + \\frac{s H}{\\rho c_p g_a} \\right) $$\n展开各项：\n$$ \\mathrm{LE} = \\frac{\\rho c_p g_a \\mathrm{VPD}}{\\gamma (1+g_a r_c)} + \\frac{s H}{\\gamma (1+g_a r_c)} $$\n我们现在有一个包含两个未知数 $\\mathrm{LE}$ 和 $H$ 的二元一次方程组：\n- $H = A - \\mathrm{LE}$\n- $\\mathrm{LE} ( \\gamma (1+g_a r_c) ) = \\rho c_p g_a \\mathrm{VPD} + s H$\n\n将第一个方程代入第二个方程以消除 $H$：\n$$ \\mathrm{LE} (\\gamma + \\gamma g_a r_c) = \\rho c_p g_a \\mathrm{VPD} + s(A - \\mathrm{LE}) $$\n$$ \\mathrm{LE} (\\gamma + \\gamma g_a r_c) = \\rho c_p g_a \\mathrm{VPD} + s A - s \\mathrm{LE} $$\n将所有包含 $\\mathrm{LE}$ 的项移到一边：\n$$ \\mathrm{LE} (\\gamma + \\gamma g_a r_c + s) = s A + \\rho c_p g_a \\mathrm{VPD} $$\n最后，解出 $\\mathrm{LE}$：\n$$ \\mathrm{LE} = \\frac{s A + \\rho c_p g_a \\mathrm{VPD}}{s + \\gamma (1+g_a r_c)} $$\n这就是潜热通量的 Penman-Monteith 方程。蒸散速率 $E$（作为质量通量，例如，单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$）通过 $\\mathrm{LE} = \\lambda E$ 得到：\n$$ E = \\frac{1}{\\lambda} \\left( \\frac{s A + \\rho c_p g_a \\mathrm{VPD}}{s + \\gamma (1+g_a r_c)} \\right) $$\n\n### 竞争性控制分析\n\nPenman-Monteith 方程的结构揭示了控制蒸散的竞争性因素。分子 $s A + \\rho c_p g_a \\mathrm{VPD}$ 代表了蒸发的总“源”。它由两个主要部分组成：\n1.  **能量项** $s A$，它代表了可用能量 $A$ 中可以转化为潜热的部分。因子 $s$（饱和水汽压曲线的斜率）是温度依赖的，表明在较高温度下，更大比例的能量被分配到蒸散中。\n2.  **空气动力学项** $\\rho c_p g_a \\mathrm{VPD}$，它代表大气的“干燥能力”。它量化了大气将水汽从地表输送走的能力，这种能力由饱和水汽压差（$\\mathrm{VPD}$）驱动，并由湍流输送（由 $g_a$ 代表）促进。\n\n分母 $s + \\gamma (1+g_a r_c)$ 代表了水汽传输的总“阻力”。它结合了空气的热力学性质（$s$ 和 $\\gamma$）与地表的物理阻力（$r_c$）和边界层的物理阻力（$r_a = 1/g_a$）。项 $\\gamma g_a r_c$ 明确地将冠层的生理控制（$r_c$）与空气动力学效率（$g_a$）耦合起来。\n\n在给定条件下，让我们在一致的国际单位制（SI）下比较分子中两项的大小，其中压强单位为 $\\mathrm{Pa}$。\n$s = 0.188\\,\\mathrm{kPa\\,K^{-1}} = 188\\,\\mathrm{Pa\\,K^{-1}}$。\n$\\mathrm{VPD} = 1.2\\,\\mathrm{kPa} = 1200\\,\\mathrm{Pa}$。\n能量项对分子驱动函数的贡献是 $s A = 188\\,\\mathrm{Pa\\,K^{-1}} \\times 180\\,\\mathrm{W\\,m^{-2}} = 33840\\,\\mathrm{W\\,m^{-2}\\,Pa\\,K^{-1}}$。\n空气动力学项的贡献是 $\\rho c_p g_a \\mathrm{VPD} = (1.2\\,\\mathrm{kg\\,m^{-3}})(1005\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}})(0.02\\,\\mathrm{m\\,s^{-1}})(1200\\,\\mathrm{Pa}) = 28944\\,\\mathrm{W\\,m^{-2}\\,Pa\\,K^{-1}}$。\n这两项的量级相当（$33840$ 对比 $28944$），表明在这些条件下，蒸散受到**混合控制**。可用的能量供应和大气的水汽需求都是强大的、相互竞争的驱动因素。冠层阻力也施加了显著的控制，因为项 $\\gamma g_a r_c = (0.066)(0.02)(70) \\approx 0.0924$ 在总分母项 $s + \\gamma + \\gamma g_a r_c = 0.188 + 0.066 + 0.0924 = 0.3464$ 中占有相当大的比例。\n\n### 弹性的推导和计算\n\n$E$ 对 $r_c$ 的弹性定义为 $\\epsilon_{r_{c}}=\\frac{\\partial E}{\\partial r_{c}}\\frac{r_{c}}{E}$。\n将 $E$ 的表达式写为 $E = K \\frac{N}{D(r_c)}$，其中 $K=1/\\lambda$ 和 $N = s A + \\rho c_p g_a \\mathrm{VPD}$ 是相对于 $r_c$ 的常数，分母为 $D(r_c) = s + \\gamma (1+g_a r_c)$。\n\n首先，我们使用链式法则求偏导数 $\\frac{\\partial E}{\\partial r_{c}}$：\n$$ \\frac{\\partial E}{\\partial r_{c}} = K N \\frac{\\partial}{\\partial r_{c}} \\left( [D(r_c)]^{-1} \\right) = - K N [D(r_c)]^{-2} \\frac{\\partial D(r_c)}{\\partial r_c} $$\n分母的导数是：\n$$ \\frac{\\partial D(r_c)}{\\partial r_c} = \\frac{\\partial}{\\partial r_c} (s + \\gamma + \\gamma g_a r_c) = \\gamma g_a $$\n将其代回，我们得到：\n$$ \\frac{\\partial E}{\\partial r_{c}} = -K N \\frac{\\gamma g_a}{(s + \\gamma (1+g_a r_c))^2} $$\n现在，我们构建弹性表达式：\n$$ \\epsilon_{r_{c}} = \\frac{\\partial E}{\\partial r_{c}}\\frac{r_{c}}{E} = \\left( -K N \\frac{\\gamma g_a}{[s + \\gamma (1+g_a r_c)]^2} \\right) \\frac{r_c}{K \\frac{N}{s + \\gamma (1+g_a r_c)}} $$\n消去常数项 $K$ 和 $N$，以及分母中的一个因子：\n$$ \\epsilon_{r_{c}} = - \\frac{\\gamma g_a r_c}{s + \\gamma (1+g_a r_c)} = - \\frac{\\gamma g_a r_c}{s + \\gamma + \\gamma g_a r_c} $$\n这是弹性的解析表达式。负号正确地表明蒸散随着冠层阻力的增加而减少。\n\n最后，我们代入给定的数值来计算 $\\epsilon_{r_{c}}$：\n- $g_{a} = 0.02\\,\\mathrm{m\\,s^{-1}}$\n- $r_{c} = 70\\,\\mathrm{s\\,m^{-1}}$\n- $s = 0.188\\,\\mathrm{kPa\\,K^{-1}}$\n- $\\gamma = 0.066\\,\\mathrm{kPa\\,K^{-1}}$\n\n表达式中的各项为：\n- 分子：$\\gamma g_a r_c = (0.066)(0.02)(70) = 0.066 \\times 1.4 = 0.0924$\n- 分母：$s + \\gamma + \\gamma g_a r_c = 0.188 + 0.066 + 0.0924 = 0.254 + 0.0924 = 0.3464$\n\n分子和分母的单位都是 $\\mathrm{kPa\\,K^{-1}}$，因此弹性是一个无量纲的量，符合预期。\n$$ \\epsilon_{r_{c}} = - \\frac{0.0924}{0.3464} \\approx -0.2667436... $$\n四舍五入到三位有效数字，弹性为 $-0.267$。这意味着在这些条件下，冠层阻力增加 $1\\%$ 将导致蒸散大约减少 $0.267\\%$。",
            "answer": "$$\\boxed{-0.267}$$"
        },
        {
            "introduction": "模型结构（如线性混合模型）一旦建立，我们常常需要从观测数据中反向推演未知参数。本练习 () 聚焦于线性光谱分解，这是遥感领域一个常见的反演问题。您需要推导在物理约束条件下估算地表覆盖组分比例的解，从而说明如何运用数学优化方法确保模型输出具有真实的物理意义。",
            "id": "3809793",
            "problem": "一个亚像素土地覆盖组成的环境模型依赖于从多光谱遥感数据中估计分数丰度。在典型的工作流程中，模型概念化首先定义如何用端元光谱来解释测量的像素反射率，然后构建一个物理约束的估计问题，以确保输出对于下游环境建模是可行的。\n\n在遥感和环境建模的背景下，定义线性光谱解混和端元。从线性混合和物理约束下最小二乘估计的基本原理出发，推导具有非负性和总和为一约束的约束最小二乘丰度估计器。使用 Karush-Kuhn-Tucker (KKT) 条件来证明解的结构的合理性。\n\n然后，将推导出的公式应用于以下无噪声的多光谱场景（单个像素）。存在 $B=5$ 个波段和 $p=3$ 个端元：植被、土壤和水。端元矩阵 $E \\in \\mathbb{R}^{B \\times p}$ 的列由端元的光谱反射率给出（每个值都是无单位的反射率）：\n- 植被：$\\begin{pmatrix}0.05 \\\\ 0.10 \\\\ 0.05 \\\\ 0.50 \\\\ 0.25\\end{pmatrix}$，\n- 土壤：$\\begin{pmatrix}0.12 \\\\ 0.15 \\\\ 0.18 \\\\ 0.30 \\\\ 0.35\\end{pmatrix}$，\n- 水：$\\begin{pmatrix}0.02 \\\\ 0.03 \\\\ 0.02 \\\\ 0.05 \\\\ 0.03\\end{pmatrix}$。\n\n测量的像素反射率向量 $y \\in \\mathbb{R}^{B}$ 为\n$$\ny \\;=\\; \\begin{pmatrix}0.068 \\\\ 0.108 \\\\ 0.086 \\\\ 0.395 \\\\ 0.258\\end{pmatrix}.\n$$\n\n构建并求解约束最小二乘丰度估计问题\n$$\n\\min_{a \\in \\mathbb{R}^{p}} \\;\\|E\\,a - y\\|_{2}^{2}\n\\quad \\text{subject to} \\quad a \\succeq 0,\\;\\; \\mathbf{1}^{\\top} a = 1,\n$$\n其中 $a$ 是丰度向量，$a \\succeq 0$ 表示元素非负，$\\mathbf{1}$ 是一个全为1的 $p$ 维向量。解释从线性混合模型到优化问题，再到解的特征描述的每个推导步骤。最后，计算该像素的丰度向量，并将其表示为无单位的分数。将每个丰度值四舍五入到四位有效数字，并使用 $\\text{pmatrix}$ 环境以单行矩阵的形式呈现最终的丰度向量。",
            "solution": "线性光谱解混是遥感中的一个概念和数学框架，其中像素的测量反射光谱被建模为一小组纯物质光谱（称为端元）的线性组合。端元是纯土地覆盖类型（例如，植被、土壤、水）的特征反射光谱，线性光谱解混模型假设，当物质在瞬时视场内区域混合，且多重散射和非线性相互作用可忽略不计时，混合像元的光谱是这些端元光谱的凸组合。\n\n该模型的基本基础是带有加性测量噪声的线性混合关系，\n$$\ny \\;=\\; E\\,a \\;+\\; n,\n$$\n其中 $y \\in \\mathbb{R}^{B}$ 是在 $B$ 个波段上测得的光谱，$E \\in \\mathbb{R}^{B \\times p}$ 包含 $p$ 个作为列的端元光谱，$a \\in \\mathbb{R}^{p}$ 是丰度向量，$n \\in \\mathbb{R}^{B}$ 是加性噪声（假设为零均值）。对于区域混合物的丰度的物理约束是非负性和总和为一：\n$$\na \\succeq 0, \\qquad \\mathbf{1}^{\\top} a = 1.\n$$\n这些约束要求丰度构成端元的凸组合，这与环境建模中的概念工作流程一致，在该流程中，土地覆盖分数必须是可行且可解释的。\n\n给定线性模型和类高斯噪声假设，经过充分检验的方法是通过约束最小二乘法来估计 $a$：\n$$\n\\min_{a} \\; \\|E\\,a - y\\|_{2}^{2} \\quad \\text{subject to} \\quad a \\succeq 0, \\;\\mathbf{1}^{\\top} a = 1.\n$$\n这是一个在单纯形上的凸二次规划问题。为了推导解的结构，考虑拉格朗日函数\n$$\n\\mathcal{L}(a,\\mu,\\gamma) \\;=\\; \\|E\\,a - y\\|_{2}^{2} \\;+\\; \\mu \\left(\\mathbf{1}^{\\top} a - 1\\right) \\;-\\; \\gamma^{\\top} a,\n$$\n其中 $\\mu \\in \\mathbb{R}$ 是等式约束的乘子，$\\gamma \\in \\mathbb{R}^{p}$ 是不等式约束 $a \\succeq 0$（写作 $-a \\preceq 0$）的乘子。Karush-Kuhn-Tucker (KKT) 条件是：\n- 平稳性：\n$$\n\\nabla_{a} \\mathcal{L} \\;=\\; 2 E^{\\top}(E\\,a - y) \\;+\\; \\mu\\,\\mathbf{1} \\;-\\; \\gamma \\;=\\; 0.\n$$\n- 原始可行性：$a \\succeq 0$, $\\mathbf{1}^{\\top} a = 1$。\n- 对偶可行性：$\\gamma \\succeq 0$。\n- 互补松弛性：对于所有 $i \\in \\{1,\\dots,p\\}$，$\\gamma_{i}\\,a_{i} = 0$。\n\n这些条件刻画了约束最小二乘解的特征。如果非负约束是不活跃的（即 $a$ 的所有分量都严格为正），那么根据互补松弛性，$\\gamma = 0$，平稳性条件简化为\n$$\n2 E^{\\top}(E\\,a - y) \\;+\\; \\mu\\,\\mathbf{1} \\;=\\; 0.\n$$\n两边除以 $2$（这不影响最小值点）并重新整理，我们得到\n$$\nE^{\\top} E \\, a \\;-\\; E^{\\top} y \\;+\\; \\mu \\,\\mathbf{1} \\;=\\; 0\n\\quad\\Rightarrow\\quad\na \\;=\\; (E^{\\top} E)^{-1} \\left(E^{\\top} y \\;-\\; \\mu \\,\\mathbf{1}\\right),\n$$\n假设 $E^{\\top} E$ 是可逆的，当端元光谱在各个波段上线性无关时，该条件成立。强制执行总和为一的约束，\n$$\n\\mathbf{1}^{\\top} a \\;=\\; \\mathbf{1}^{\\top} (E^{\\top} E)^{-1} \\left(E^{\\top} y \\;-\\; \\mu \\,\\mathbf{1}\\right) \\;=\\; 1,\n$$\n得到乘子的闭式表达式，\n$$\n\\mu \\;=\\; \\frac{\\mathbf{1}^{\\top} (E^{\\top} E)^{-1} E^{\\top} y \\;-\\; 1}{\\mathbf{1}^{\\top} (E^{\\top} E)^{-1} \\mathbf{1}}.\n$$\n代回可得等式约束的最小二乘解\n$$\na \\;=\\; (E^{\\top} E)^{-1} E^{\\top} y \\;-\\; (E^{\\top} E)^{-1} \\mathbf{1} \\;\\frac{\\mathbf{1}^{\\top} (E^{\\top} E)^{-1} E^{\\top} y \\;-\\; 1}{\\mathbf{1}^{\\top} (E^{\\top} E)^{-1} \\mathbf{1}}.\n$$\n如果这个 $a$ 的每个元素都严格为正，那么它也满足原始的非负约束和 $\\gamma=0$ 的 KKT 系统，因此由于 $\\|E\\,a - y\\|_{2}^{2}$ 的严格凸性，它是唯一的最小值点。\n\n我们现在将此应用于给定的光谱数据集。端元矩阵为\n$$\nE \\;=\\; \\begin{pmatrix}\n0.05  0.12  0.02 \\\\\n0.10  0.15  0.03 \\\\\n0.05  0.18  0.02 \\\\\n0.50  0.30  0.05 \\\\\n0.25  0.35  0.03\n\\end{pmatrix}, \\qquad\ny \\;=\\; \\begin{pmatrix}0.068 \\\\ 0.108 \\\\ 0.086 \\\\ 0.395 \\\\ 0.258\\end{pmatrix}.\n$$\n观察到测量的光谱是端元与丰度向量的凸组合\n$$\na_{\\text{true}} \\;=\\; \\begin{pmatrix}0.60 \\\\ 0.30 \\\\ 0.10\\end{pmatrix},\n$$\n因为\n$$\nE\\,a_{\\text{true}} \\;=\\; \\begin{pmatrix}\n0.05 \\cdot 0.60 + 0.12 \\cdot 0.30 + 0.02 \\cdot 0.10 \\\\\n0.10 \\cdot 0.60 + 0.15 \\cdot 0.30 + 0.03 \\cdot 0.10 \\\\\n0.05 \\cdot 0.60 + 0.18 \\cdot 0.30 + 0.02 \\cdot 0.10 \\\\\n0.50 \\cdot 0.60 + 0.30 \\cdot 0.30 + 0.05 \\cdot 0.10 \\\\\n0.25 \\cdot 0.60 + 0.35 \\cdot 0.30 + 0.03 \\cdot 0.10\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n0.068 \\\\ 0.108 \\\\ 0.086 \\\\ 0.395 \\\\ 0.258\n\\end{pmatrix}\n\\;=\\; y.\n$$\n因为 $y$ 正好位于 $E$ 的列空间中，并且 $a_{\\text{true}}$ 满足 $a_{\\text{true}} \\succeq 0$ 和 $\\mathbf{1}^{\\top} a_{\\text{true}} = 1$，所以约束最小二乘目标函数 $\\|E\\,a - y\\|_{2}^{2}$ 在 $a_{\\text{true}}$ 处达到其全局最小值 $0$。严格凸性意味着在 $E$ 满列秩的情况下（此处成立，因为端元在 $B$ 个波段上线性无关），最小值点是唯一的，因此约束最小二乘丰度估计等于\n$$\na^{\\star} \\;=\\; a_{\\text{true}} \\;=\\; \\begin{pmatrix}0.60 \\\\ 0.30 \\\\ 0.10\\end{pmatrix}.\n$$\n由于所有分量都严格为正，非负约束是不活跃的，KKT 乘子 $\\gamma$ 为 $0$；该解与上面推导的等式约束闭式解一致。\n\n最后，将每个丰度值四舍五入到四位有效数字，并将值表示为无单位分数，得到行矩阵\n$$\n\\begin{pmatrix}0.6000  0.3000  0.1000\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}0.6000  0.3000  0.1000\\end{pmatrix}}$$"
        },
        {
            "introduction": "建立和校准模型只是第一步，其预测能力必须经过严格的检验。本练习 () 直面模型验证中的一个关键挑战：如何使用在时空上自相关的环境数据进行有效评估。您需要设计一种交叉验证方案，以避免常见陷阱，确保对模型性能的评估是可靠的，这是任何可信建模工作流程的基石。",
            "id": "3809791",
            "problem": "一个环境建模团队正在为一个名为蒸散量（Evapotranspiration, ET）的变量构建预测模型。ET 定义为通过蒸发和植物蒸腾作用向大气损失的总水量，在空间位置 $\\mathbf{s} \\in \\mathbb{R}^2$ 和时间 $t \\in \\mathbb{R}$ 处记为 $ET(\\mathbf{s}, t)$。该模型 $f_{\\boldsymbol{\\theta}}$ 将遥感和气象预测因子 $\\mathbf{x}(\\mathbf{s}, t)$（例如，归一化植被指数 (NDVI)、地表温度、净辐射、土壤热通量、风速和湿度）映射到 $ET$，其中包含未知参数 $\\boldsymbol{\\theta} \\in \\mathbb{R}^p$。ET 的地面观测数据来自 $S$ 个站点的涡度相关（Eddy Covariance, EC）通量塔，每个站点 $s \\in \\{1,\\dots,S\\}$ 都有 $T_s$ 天的每日记录。\n\n假设残差过程 $e(\\mathbf{s}, t) = ET(\\mathbf{s}, t) - f_{\\boldsymbol{\\theta}}(\\mathbf{x}(\\mathbf{s}, t))$ 在空间和时间上是二阶平稳的，其协方差函数 $C(h,\\tau) = \\operatorname{Cov}(e(\\mathbf{s}, t), e(\\mathbf{s}', t'))$ 仅取决于空间间隔 $h = \\lVert \\mathbf{s} - \\mathbf{s}' \\rVert$ 和时间滞后 $\\tau = \\lvert t - t' \\rvert$。经验分析得出一个空间半变异函数 $\\gamma(h) = \\tfrac{1}{2} \\operatorname{Var}(e(\\mathbf{s}, t) - e(\\mathbf{s} + \\mathbf{h}, t))$，其变程为 $h_0$（超出此范围 $\\gamma(h)$ 达到基台值且 $C(h) \\approx 0$），以及一个时间自相关函数 $\\rho(\\tau) = \\operatorname{Corr}(e(\\mathbf{s}, t), e(\\mathbf{s}, t+\\tau))$，其解相关时间为 $\\tau_0$（超出此时间 $\\rho(\\tau) \\approx 0$）。该团队旨在设计一个能恰当区分校准（参数估计）和验证（性能评估）的工作流程，并选择一种能够同时尊重空间和时间自相关的交叉验证（Cross-Validation, CV）策略。\n\n仅从以下基本原则出发：\n- 校准的定义：在指定的训练集上通过最小化经验损失 $L(\\boldsymbol{\\theta}) = \\sum_{i=1}^{n} \\ell(ET_i, f_{\\boldsymbol{\\theta}}(\\mathbf{x}_i))$ 来进行参数估计；验证的定义：在未用于估计 $\\boldsymbol{\\theta}$ 的数据上进行性能评估。\n- 在数据生成过程中，验证数据必须近似独立于训练数据的要求。此处通过确保空间间隔大于 $h_0$ 且时间间隔大于 $\\tau_0$ 来实现，从而使得 $C(h,\\tau) \\approx 0$。\n- k-折交叉验证的概念：一种将数据划分为 $k$ 个不相交的折的程序，它迭代地保留一个折用于测试，同时在其余的折上进行训练，且不违反独立性近似。\n\n哪个选项正确地区分了该 $ET$ 模型的校准和验证，并提出了一种尊重空间和时间自相关的 CV 方案？\n\nA. 校准通过在训练集上最小化损失 $L(\\boldsymbol{\\theta})$ 来估计 $\\boldsymbol{\\theta}$；验证在未用于估计 $\\boldsymbol{\\theta}$ 的保留数据上评估泛化能力。一种合适的 CV 是嵌套时空块 CV：将站点划分为空间块，使得块间距离超过 $h_0$；将时间划分为连续的时间块，其长度超过 $\\tau_0$；在每个外部折中，保留一个空间块和一个连续的时间段作为测试集；在测试集周围应用空间宽度为 $h_0$ 和时间宽度为 $\\tau_0$ 的缓冲区以避免泄漏；在剩余的训练块内通过内部 CV 调整超参数。\n\nB. 校准和验证都涉及拟合 $\\boldsymbol{\\theta}$，但使用不同的损失函数；对所有站点-日记录选择随机 k-折 CV，以确保每个折均匀混合站点和时间。随机化即使在自相关设置中也能确保独立性，因此尊重空间和时间自相关。\n\nC. 校准是通过在完整数据集上测试多种备选方案来选择最佳模型架构的过程；验证是在完整训练后使用相同数据集进行的最终检查。在空间上使用留一站点交叉验证（无缓冲区），同时在所有折中混合所有日期；一旦使用空间分块，时间自相关就可以忽略不计。\n\nD. 校准使用保留的折来调整 $\\boldsymbol{\\theta}$，直到在测试折上的性能最大化；验证在训练折上执行。仅使用按植被类别分层的 k-折 CV；控制植被类别使得空间和时间自相关与独立性无关。",
            "solution": "在进行求解之前，对问题陈述的有效性进行严格评估。\n\n### 步骤 1：提取已知信息\n- **建模量：** 蒸散量，$ET(\\mathbf{s}, t)$，在空间位置 $\\mathbf{s} \\in \\mathbb{R}^2$ 和时间 $t \\in \\mathbb{R}$。\n- **模型：** 一个函数 $f_{\\boldsymbol{\\theta}}$，其参数为 $\\boldsymbol{\\theta} \\in \\mathbb{R}^p$，将预测因子 $\\mathbf{x}(\\mathbf{s}, t)$ 映射到 $ET$。\n- **预测因子：** 遥感和气象变量（例如，NDVI、地表温度、净辐射、土壤热通量、风速、湿度）。\n- **数据：** 来自 $S$ 个涡度相关 (EC) 通量塔站点的 $ET$ 地面观测数据，每个站点 $s \\in \\{1,\\dots,S\\}$ 都有 $T_s$ 天的每日记录。\n- **残差过程：** $e(\\mathbf{s}, t) = ET(\\mathbf{s}, t) - f_{\\boldsymbol{\\theta}}(\\mathbf{x}(\\mathbf{s}, t))$。\n- **残差属性：** 假设在空间和时间上是二阶平稳的。\n- **协方差函数：** $C(h,\\tau) = \\operatorname{Cov}(e(\\mathbf{s}, t), e(\\mathbf{s}', t'))$，仅取决于空间间隔 $h = \\lVert \\mathbf{s} - \\mathbf{s}' \\rVert$ 和时间滞后 $\\tau = \\lvert t - t' \\rvert$。\n- **空间自相关：** 由半变异函数 $\\gamma(h) = \\tfrac{1}{2} \\operatorname{Var}(e(\\mathbf{s}, t) - e(\\mathbf{s} + \\mathbf{h}, t))$ 描述，其变程为 $h_0$，超出该范围 $C(h) \\approx 0$。\n- **时间自相关：** 由自相关函数 $\\rho(\\tau) = \\operatorname{Corr}(e(\\mathbf{s}, t), e(\\mathbf{s}, t+\\tau))$ 描述，其解相关时间为 $\\tau_0$，超出该时间 $\\rho(\\tau) \\approx 0$。\n- **基本原则 1（定义）：** 校准是在训练集上通过最小化损失 $L(\\boldsymbol{\\theta}) = \\sum_{i=1}^{n} \\ell(ET_i, f_{\\boldsymbol{\\theta}}(\\mathbf{x}_i))$ 进行的参数估计。验证是在未用于估计 $\\boldsymbol{\\theta}$ 的保留数据上进行的性能评估。\n- **基本原则 2（独立性）：** 验证数据必须近似独立于训练数据，这通过确保空间间隔大于 $h_0$ 和/或时间间隔大于 $\\tau_0$ 来实现，从而使得协方差 $C(h,\\tau) \\approx 0$。\n- **基本原则 3（CV）：** k-折 CV 将数据划分为 $k$ 个不相交的折，以尊重独立性近似的方式，迭代地使用一个折进行测试，其余的折进行训练。\n\n### 步骤 2：使用提取的已知信息进行验证\n根据验证标准评估问题陈述。\n- **科学依据充分：** 该问题牢固地植根于环境科学、遥感和地统计学领域。对 $ET$ 进行建模是一项标准的科学任务。EC 塔、遥感预测因子以及二阶平稳性、协方差函数、半变异函数和自相关函数的统计框架的使用，都是该领域中标准且正确的概念。该问题在科学上是合理的。\n- **问题定义明确：** 该问题要求基于一组明确陈述的原则，给出正确的概念性工作流程和交叉验证 (CV) 策略。通过应用这些原则，问题被构造成可以在选项中逻辑推导出正确答案的形式。问题定义良好。\n- **客观性：** 语言技术性强且精确。所有量都通过数学或标准科学术语进行定义。没有主观或含糊的陈述。\n- **完整性和一致性：** 问题提供了所有必要的信息来推理正确的 CV 策略。它定义了数据结构（时空）、核心挑战（具有确定变程 $h_0$ 和解相关时间 $\\tau_0$ 的自相关），以及必须遵循的原则。设置是自洽和一致的。\n- **现实性：** 该场景非常现实。研究人员经常面临为时空自相关环境数据设计有效 CV 方案的挑战。所描述的方法反映了现代最佳实践。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。这是一个表述清晰、科学合理的问题，解决了环境建模中的一个关键方法论问题。我将继续进行求解。\n\n### 推导与选项分析\n问题的核心是设计一种能够解释时空自相关的验证策略。标准机器学习假设数据是独立同分布（i.i.d.）的。当这个假设被违反时（如此处所示），标准的随机 k-折 CV 是无效的。随机将数据点分配到折中，会将高度相关的数据（例如，来自同一站点连续几天的数据，或来自邻近站点的数据）同时放入训练集和测试集。这种“数据泄漏”使得模型能够从实际上属于测试集的数据中学习，从而导致对其泛化性能的评估被人为地抬高和产生偏差。\n\n为了满足独立性要求（基本原则 2），测试集必须与训练集在空间上相隔大于空间自相关变程 $h_0$ 的距离，和/或在时间上相隔大于时间解相关时间 $\\tau_0$ 的滞后。这是**块交叉验证**背后的原理。数据根据空间位置、时间或两者被划分为“块”，然后将整个块保留用于测试。\n\n一种稳健的实现方式，特别是在空间和时间依赖性都很显著的情况下，是**时空块 CV**。这涉及基于空间和时间创建分区。为了严格执行分离并防止在块的边界处发生泄漏，**缓冲区**是必要的。对于某个折，训练集中任何与测试块中任何点空间距离小于 $h_0$ 或时间滞后小于 $\\tau_0$ 的数据点都将从训练过程中排除。\n\n此外，必须严格维持校准和验证之间的区别（基本原则 1）。校准是在训练集上拟合参数 $\\boldsymbol{\\theta}$。验证是在测试集上评估具有已拟合参数 $\\boldsymbol{\\theta}$ 的模型。\n\n现在，我们根据这些原则评估每个选项。\n\n**A. 校准通过在训练集上最小化损失 $L(\\boldsymbol{\\theta})$ 来估计 $\\boldsymbol{\\theta}$；验证在未用于估计 $\\boldsymbol{\\theta}$ 的保留数据上评估泛化能力。一种合适的 CV 是嵌套时空块 CV：将站点划分为空间块，使得块间距离超过 $h_0$；将时间划分为连续的时间块，其长度超过 $\\tau_0$；在每个外部折中，保留一个空间块和一个连续的时间段作为测试集；在测试集周围应用空间宽度为 $h_0$ 和时间宽度为 $\\tau_0$ 的缓冲区以避免泄漏；在剩余的训练块内通过内部 CV 调整超参数。**\n\n这个选项首先根据基本原则 1 正确定义了校准和验证。然后，它提出了一种复杂且方法论上合理的 CV 策略。“时空块 CV”的使用直接解决了数据结构问题。明确提到基于空间块（以超过 $h_0$ 的距离分隔）和时间块（长度超过 $\\tau_0$）进行划分，表明对问题的正确理解。关键的是，它包含了使用“空间宽度为 $h_0$ 和时间宽度为 $\\tau_0$ 的缓冲区”来防止数据泄漏，这是块 CV 的一种先进实现，它严格执行了基本原则 2 中的独立性近似。最后，提到使用“嵌套 CV”进行超参数调整是方法严谨的另一个标志，可以防止来自外层循环测试集的信息影响超参数选择。此选项完全符合所有给定的原则，并代表了最佳实践。\n**结论：正确**\n\n**B. 校准和验证都涉及拟合 $\\boldsymbol{\\theta}$，但使用不同的损失函数；对所有站点-日记录选择随机 k-折 CV，以确保每个折均匀混合站点和时间。随机化即使在自相关设置中也能确保独立性，因此尊重空间和时间自相关。**\n\n这个选项在多个方面存在缺陷。首先，声称验证涉及拟合 $\\boldsymbol{\\theta}$ 是一个根本性的误解，违反了基本原则 1。验证是评估一个具有固定参数的模型。其次，它提倡“随机 k-折 CV”。这对于自相关数据来说恰恰是错误的方法，因为它会导致严重的数据泄漏。声称“随机化确保独立性”在这种情况下是事实性错误；随机化破坏了有效 CV 方案必须尊重的依赖结构。它直接与从基本原则 2 推导出的逻辑相矛盾。\n**结论：错误**\n\n**C. 校准是通过在完整数据集上测试多种备选方案来选择最佳模型架构的过程；验证是在完整训练后使用相同数据集进行的最终检查。在空间上使用留一站点交叉验证（无缓冲区），同时在所有折中混合所有日期；一旦使用空间分块，时间自相关就可以忽略不计。**\n\n这个选项混淆了校准和验证的定义。校准是参数拟合，而不是在完整数据集上进行模型选择。验证不能在训练数据上进行，因为那衡量的是拟合优度，而不是泛化能力。这违反了基本原则 1。所提出的 CV 策略，“留一站点交叉验证”，是一种空间分块，但它错误地建议“混合所有日期”，从而忽略了时间自相关。断言“一旦使用空间分块，时间自相关就可以忽略不计”是毫无根据的，并且与问题陈述相矛盾，问题陈述明确定义了时间解相关时间 $\\tau_0$。\n**结论：错误**\n\n**D. 校准使用保留的折来调整 $\\boldsymbol{\\theta}$，直到在测试折上的性能最大化；验证在训练折上执行。仅使用按植被类别分层的 k-折 CV；控制植被类别使得空间和时间自相关与独立性无关。**\n\n这个选项颠倒了训练集和测试集的作用。在测试集（“保留的折”）上调整 $\\boldsymbol{\\theta}$ 是机器学习中的一个基本错误，被称为“在测试集上训练”。它违反了基本原则 1。此外，虽然按植Ве类别等分类变量进行分层可能有用，但它并没有解决时空自相关这个主要问题。声称这种分层“使得空间和时间自相关变得无关紧要”是一种科学上毫无根据的过度简化。例如，驱动 $ET$ 的天气模式在空间和时间上是相关的，而不管其下的植被类别如何。\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}