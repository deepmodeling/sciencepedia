{
    "hands_on_practices": [
        {
            "introduction": "蒸散发是水循环中的关键通量，而Penman-Monteith方程是模拟这一过程的基石。本练习从地表能量平衡和空气动力学等基本物理原理出发，推导并分析该方程。通过探索其在辐射限制和空气动力学限制下的极限情况，您将深入理解可用能量或大气湿度需求如何主导蒸发过程，从而将抽象的理论与真实地表的行为联系起来。",
            "id": "3814631",
            "problem": "考虑一个植被覆盖的陆地表面，卫星遥感为模拟蒸散提供了所需的辐射强迫和地表属性。假设净辐射减去地表热通量 $R_{n} - G$ 已从Moderate Resolution Imaging Spectroradiometer (MODIS) 产品和一个基于物理的地表能量平衡模型中反演得出，并且空气动力学阻力 $r_{a}$ 和冠层总表层阻力 $r_{s}$ 已使用Monin–Obukhov相似性理论 (MOST) 以及从雷达后向散射和多光谱指数推断的冠层结构进行了约束。在该地一个有代表性的正午时刻，将以下数值作为已知值：$R_{n} - G = 180 \\ \\mathrm{W\\,m^{-2}}$，$r_{a} = 25 \\ \\mathrm{s\\,m^{-1}}$，$r_{s} = 150 \\ \\mathrm{s\\,m^{-1}}$，空气密度 $\\rho = 1.2 \\ \\mathrm{kg\\,m^{-3}}$，空气定压比热 $c_{p} = 1004 \\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$，蒸发潜热 $\\lambda = 2.45 \\times 10^{6} \\ \\mathrm{J\\,kg^{-1}}$，湿度计常数 $\\gamma = 0.066 \\ \\mathrm{kPa\\,K^{-1}}$，以及该地气温下的饱和水汽压曲线斜率 $\\Delta = 0.188 \\ \\mathrm{kPa\\,K^{-1}}$。\n\n从基本定律和经过充分检验的关系式出发：\n- 地表能量平衡 $R_{n} - G = H + \\lambda E$；\n- 感热的整体空气动力学公式 $H = \\rho c_{p} \\frac{T_{s} - T_{a}}{r_{a}}$，其中 $T_{s}$ 和 $T_{a}$ 分别是地表温度和气温；\n- 饱和水汽压曲线的线性化 $e_{s}(T_{s}) \\approx e_{s}(T_{a}) + \\Delta (T_{s} - T_{a})$；\n- 水汽从冠层输送到大气的串联电阻表示法，其中有效梯度为 $e_{s}(T_{s}) - e_{a}$，跨越 $r_{s}$ 和 $r_{a}$，并通过湿度计常数 $\\gamma$ 将温度和水汽压联系起来，\n\n推导空气动力学限制和辐射限制的蒸散机制如何作为控制表达式的适当极限而出现。然后，将机制之间的“过渡”定义为控制表达式中与辐射强迫相关的贡献等于与空气动力学强迫相关的贡献的条件。在此定义下，确定该地过渡状态下的水汽压亏缺 $(e_{s} - e_{a})^{\\ast}$。\n\n以千帕（kilopascals）为单位表示 $(e_{s} - e_{a})^{\\ast}$ 的最终答案。将答案四舍五入到三位有效数字。",
            "solution": "用户请求解决一个关于蒸散的环境模型问题。第一步是验证问题陈述。\n\n### 步骤1：提取已知条件\n问题提供了以下数据、定义和关系式：\n- 净辐射减去地表热通量：$R_{n} - G = 180 \\ \\mathrm{W\\,m^{-2}}$\n- 空气动力学阻力：$r_{a} = 25 \\ \\mathrm{s\\,m^{-1}}$\n- 冠层总表层阻力：$r_{s} = 150 \\ \\mathrm{s\\,m^{-1}}$\n- 空气密度：$\\rho = 1.2 \\ \\mathrm{kg\\,m^{-3}}$\n- 空气比热：$c_{p} = 1004 \\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- 蒸发潜热：$\\lambda = 2.45 \\times 10^{6} \\ \\mathrm{J\\,kg^{-1}}$\n- 湿度计常数：$\\gamma = 0.066 \\ \\mathrm{kPa\\,K^{-1}}$\n- 饱和水汽压曲线斜率：$\\Delta = 0.188 \\ \\mathrm{kPa\\,K^{-1}}$\n\n提供的基本关系式：\n1. 地表能量平衡：$R_{n} - G = H + \\lambda E$\n2. 感热的整体空气动力学公式：$H = \\rho c_{p} \\frac{T_{s} - T_{a}}{r_{a}}$\n3. 饱和水汽压曲线的线性化：$e_{s}(T_{s}) \\approx e_{s}(T_{a}) + \\Delta (T_{s} - T_{a})$\n4. 潜热通量 $\\lambda E$ 的水汽输送串联电阻表示法。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于蒸散的Penman-Monteith公式，这是水文学、微气象学和环境科学的基石。所有提供的方程都是标准的，代表了基本的物理原理（能量守恒）和公认的经验/半经验模型（整体输送、电阻网络）。物理常数（$\\rho$、$c_p$、$\\lambda$）和特定场地的参数（$R_n - G$、$r_a$、$r_s$、$\\gamma$、$\\Delta$）的数值对于正午条件下的植被地表是物理上现实的。该问题在科学上是合理的。\n- **适定性**：该问题要求推导极限机制并根据明确定义的条件计算一个特定值（过渡水汽压亏缺）。所提供的信息充分且自洽，可以得到唯一解。\n- **客观性**：该问题以精确、定量和客观的科学语言陈述，没有任何主观或基于意见的主张。\n\n### 步骤3：结论和行动\n该问题在科学上是合理的、适定的和客观的。它是**有效的**。将提供解答。\n\n### 控制表达式的推导（Penman-Monteith方程）\n目标是找到潜热通量 $\\lambda E$ 的一个表达式，该表达式消除了未测量的地表温度 $T_s$。这将是“控制表达式”。\n\n我们从提供的四个基本关系式开始。潜热通量 $\\lambda E$ 可以用类似于感热 $H$ 的阻力公式来表示。水汽质量通量 $E$ 由从地表到空气的比湿梯度驱动，并受到地表阻力和空气动力学阻力之和 $r_s + r_a$ 的阻碍：\n$$E = \\rho \\frac{q_{s} - q_{a}}{r_{s} + r_{a}}$$\n其中 $q_s$ 是有效表面的比湿（假设在温度 $T_s$ 下饱和），$q_a$ 是周围空气的比湿。使用近似式 $q \\approx (\\epsilon/P)e$，其中 $\\epsilon$ 是水与干空气的摩尔质量之比，$P$ 是大气压，以及湿度计常数 $\\gamma = c_p P / (\\epsilon \\lambda)$ 的定义，我们可以用蒸汽压来表示潜热通量：\n$$\\lambda E = \\lambda \\rho \\frac{\\epsilon}{P} \\frac{e_{s}(T_{s}) - e_{a}}{r_{a} + r_{s}} = \\rho \\frac{c_{p}}{\\gamma} \\frac{e_{s}(T_{s}) - e_{a}}{r_{a} + r_{s}}$$\n我们现在有四个关键方程组：\n1. $R_{n} - G = H + \\lambda E$\n2. $H = \\rho c_{p} \\frac{T_{s} - T_{a}}{r_{a}}$\n3. $e_{s}(T_{s}) = e_{s}(T_{a}) + \\Delta (T_{s} - T_{a})$\n4. $\\lambda E = \\rho \\frac{c_{p}}{\\gamma} \\frac{e_{s}(T_{s}) - e_{a}}{r_{a} + r_{s}}$\n\n从方程（2）中，我们分离出温差 $T_{s} - T_{a}$：\n$$T_{s} - T_{a} = \\frac{H r_{a}}{\\rho c_{p}}$$\n将此代入方程（3）：\n$$e_{s}(T_{s}) = e_{s}(T_{a}) + \\Delta \\frac{H r_{a}}{\\rho c_{p}}$$\n这用 $H$ 消去了 $T_{s}$。现在代入能量平衡（方程1）的形式 $H = (R_{n} - G) - \\lambda E$：\n$$e_{s}(T_{s}) = e_{s}(T_{a}) + \\frac{\\Delta r_{a}}{\\rho c_{p}} ( (R_{n} - G) - \\lambda E )$$\n驱动蒸发的水汽压梯度 $e_{s}(T_s) - e_a$ 现在可以写成：\n$$e_{s}(T_{s}) - e_{a} = (e_{s}(T_{a}) - e_{a}) + \\frac{\\Delta r_{a}}{\\rho c_{p}} (R_{n} - G) - \\frac{\\Delta r_{a}}{\\rho c_{p}} \\lambda E$$\n令 $D = e_{s}(T_{a}) - e_{a}$ 表示空气的水汽压亏缺。\n$$e_{s}(T_{s}) - e_{a} = D + \\frac{\\Delta r_{a}}{\\rho c_{p}} (R_{n} - G) - \\frac{\\Delta r_{a}}{\\rho c_{p}} \\lambda E$$\n现在，将这个关于 $e_{s}(T_{s}) - e_{a}$ 的完整表达式代入潜热通量方程（4）：\n$$\\lambda E = \\rho \\frac{c_{p}}{\\gamma} \\frac{1}{r_{a} + r_{s}} \\left( D + \\frac{\\Delta r_{a}}{\\rho c_{p}} (R_{n} - G) - \\frac{\\Delta r_{a}}{\\rho c_{p}} \\lambda E \\right)$$\n我们现在求解 $\\lambda E$。展开各项：\n$$\\lambda E = \\frac{\\rho c_{p} D}{\\gamma (r_{a} + r_{s})} + \\frac{\\Delta r_{a} (R_{n} - G)}{\\gamma (r_{a} + r_{s})} - \\frac{\\Delta r_{a} \\lambda E}{\\gamma (r_{a} + r_{s})}$$\n将含有 $\\lambda E$ 的项组合在一起：\n$$\\lambda E \\left( 1 + \\frac{\\Delta r_{a}}{\\gamma (r_{a} + r_{s})} \\right) = \\frac{\\Delta r_{a} (R_{n} - G) + \\rho c_{p} D}{\\gamma (r_{a} + r_{s})}$$\n$$\\lambda E \\left( \\frac{\\gamma(r_{a} + r_{s}) + \\Delta r_{a}}{\\gamma(r_{a} + r_{s})} \\right) = \\frac{\\Delta r_{a} (R_{n} - G) + \\rho c_{p} D}{\\gamma (r_{a} + r_{s})}$$\n求解 $\\lambda E$ 得：\n$$\\lambda E = \\frac{\\Delta r_{a} (R_n-G) + \\rho c_p D}{\\Delta r_a + \\gamma(r_a+r_s)}$$\n为了得到Penman-Monteith方程的标准形式，我们将分子和分母同时除以 $r_a$：\n$$\\lambda E = \\frac{\\Delta (R_n-G) + (\\rho c_p / r_a) D}{\\Delta + \\gamma (1 + r_s/r_a)}$$\n这是蒸散的控制表达式。它由一个辐射项和一个空气动力学项组成。\n\n### 极限机制分析\n控制表达式可以写成两个分量的和：\n$$\\lambda E = \\frac{\\Delta (R_n-G)}{\\Delta + \\gamma(1 + r_s/r_a)} + \\frac{(\\rho c_p / r_a) D}{\\Delta + \\gamma(1 + r_s/r_a)}$$\n第一项是辐射驱动分量，第二项是空气动力学驱动分量。\n\n- **辐射限制机制**：当可用能量 $R_n - G$ 是蒸发的主要驱动力时，就会出现这种机制。这发生在空气动力学项可以忽略不计时，即当空气接近饱和时（$D \\to 0$）。在此极限下，蒸发主要由辐射收支和地表阻力决定：\n  $$\\lambda E \\approx \\frac{\\Delta (R_n-G)}{\\Delta + \\gamma(1 + r_s/r_a)}$$\n- **空气动力学限制机制**：当大气的“干燥能力”是主要驱动力时，就会出现这种机制。这发生在空气非常干燥（$D$ 很大）且有风（$r_a$ 很小）的条件下，使得空气动力学项主导了辐射项。如果我们考虑可用能量很小（$R_n - G \\to 0$）的情况，方程简化为：\n  $$\\lambda E \\approx \\frac{(\\rho c_p / r_a) D}{\\Delta + \\gamma(1 + r_s/r_a)}$$\n  此时，蒸发主要取决于水汽压亏缺和湍流输送的效率。\n\n### 过渡水汽压亏缺的确定\n问题将“过渡”定义为与辐射强迫相关的贡献等于与空气动力学强迫相关的贡献的条件。基于Penman-Monteith方程的分子结构（它代表了蒸散的两个能量来源），我们令这两项相等：\n$$\\text{辐射强迫项} = \\text{空气动力学强迫项}$$\n$$\\Delta (R_{n}-G) = \\frac{\\rho c_{p}}{r_{a}} (e_{s} - e_{a})^{\\ast}$$\n这里，$(e_s - e_a)^{\\ast}$ 是过渡点的水汽压亏缺。我们求解这个量：\n$$(e_{s} - e_{a})^{\\ast} = \\frac{\\Delta (R_{n} - G) r_{a}}{\\rho c_{p}}$$\n\n### 计算\n现在我们将给定的数值代入此表达式。单位必须一致。$R_n - G$ 的单位是 $\\mathrm{W\\,m^{-2}}$，等同于 $\\mathrm{J\\,s^{-1}\\,m^{-2}}$。\n- $\\Delta = 0.188 \\ \\mathrm{kPa\\,K^{-1}}$\n- $R_{n} - G = 180 \\ \\mathrm{J\\,s^{-1}\\,m^{-2}}$\n- $r_{a} = 25 \\ \\mathrm{s\\,m^{-1}}$\n- $\\rho = 1.2 \\ \\mathrm{kg\\,m^{-3}}$\n- $c_{p} = 1004 \\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n\n$$(e_{s} - e_{a})^{\\ast} = \\frac{(0.188 \\ \\mathrm{kPa\\,K^{-1}}) (180 \\ \\mathrm{J\\,s^{-1}\\,m^{-2}}) (25 \\ \\mathrm{s\\,m^{-1}})}{(1.2 \\ \\mathrm{kg\\,m^{-3}}) (1004 \\ \\mathrm{J\\,kg^{-1}\\,K^{-1}})}$$\n$$(e_{s} - e_{a})^{\\ast} = \\frac{0.188 \\times 180 \\times 25}{1.2 \\times 1004} \\ \\mathrm{kPa}$$\n$$(e_{s} - e_{a})^{\\ast} = \\frac{846}{1204.8} \\ \\mathrm{kPa}$$\n$$(e_{s} - e_{a})^{\\ast} \\approx 0.70219 \\ \\mathrm{kPa}$$\n按要求四舍五入到三位有效数字，结果是 $0.702 \\ \\mathrm{kPa}$。",
            "answer": "$$\\boxed{0.702}$$"
        },
        {
            "introduction": "在遥感科学中，一个核心挑战是如何关联卫星像元（面平均值）和地面站点（点测量值）的数据。本练习引入了地统计学中的“代表性误差”概念，并使用半变异函数这一工具来对其进行量化。掌握这一理论对于准确验证遥感产品以及融合多源数据至关重要，它为您提供了一个严谨的框架来理解和计算因空间尺度不匹配而产生的不确定性。",
            "id": "3814604",
            "problem": "考虑一个标量地球物理场 $Z(\\mathbf{x})$，定义在水平域 $\\Omega \\subset \\mathbb{R}^2$ 上，代表一个水循环变量，例如近地表土壤湿度或降水率。假设 $Z(\\mathbf{x})$ 是二阶平稳的，具有常数均值 $\\mu$ 和协方差函数 $C(\\mathbf{h}) = \\operatorname{Cov}\\!\\big(Z(\\mathbf{x}), Z(\\mathbf{x}+\\mathbf{h})\\big)$，并且 $Z(\\mathbf{x})$ 具有有限二阶矩。$Z(\\mathbf{x})$ 的半变异函数定义为 $\\gamma(\\mathbf{h}) = \\tfrac{1}{2}\\,\\mathbb{E}\\!\\big[(Z(\\mathbf{x}+\\mathbf{h}) - Z(\\mathbf{x}))^2\\big]$，在二阶平稳性条件下，它满足 $\\gamma(\\mathbf{h}) = C(\\mathbf{0}) - C(\\mathbf{h})$。\n\n一颗星载传感器根据权重函数 $w(\\mathbf{u}) \\ge 0$（其中 $\\int_A w(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u} = 1$）观测区域 $A \\subset \\Omega$ 上的足迹平均值，得到区域平均量 $Z_A = \\int_A w(\\mathbf{u})\\,Z(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}$。一个位于 $\\mathbf{x}_0 \\in \\Omega$ 的原位点仪器测量 $Z(\\mathbf{x}_0)$。将代表性误差定义为不匹配量 $e(\\mathbf{x}_0) = Z(\\mathbf{x}_0) - Z_A$。\n\n仅使用上述定义和二阶平稳性假设，以下哪个表达式正确地将均方代表性误差 $\\mathbb{E}\\!\\big[e(\\mathbf{x}_0)^2\\big]$ 与半变异函数 $\\gamma(\\mathbf{h})$ 和足迹权重函数 $w(\\mathbf{u})$ 联系起来？\n\nA. $\\mathbb{E}\\!\\big[e(\\mathbf{x}_0)^2\\big] = 2 \\displaystyle\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{x}_0 - \\mathbf{u})\\,\\mathrm{d}\\mathbf{u} \\;-\\; \\displaystyle\\int_A \\!\\!\\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,\\gamma(\\mathbf{u} - \\mathbf{v})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v}$\n\nB. $\\mathbb{E}\\!\\big[e(\\mathbf{x}_0)^2\\big] = \\displaystyle\\int_A \\!\\!\\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,\\gamma(\\mathbf{u} - \\mathbf{v})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} \\;-\\; 2 \\displaystyle\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{x}_0 - \\mathbf{u})\\,\\mathrm{d}\\mathbf{u}$\n\nC. $\\mathbb{E}\\!\\big[e(\\mathbf{x}_0)^2\\big] = \\displaystyle\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{x}_0 - \\mathbf{u})\\,\\mathrm{d}\\mathbf{u}$\n\nD. $\\mathbb{E}\\!\\big[e(\\mathbf{x}_0)^2\\big] = 2 \\displaystyle\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{x}_0 - \\mathbf{u})\\,\\mathrm{d}\\mathbf{u} \\;+\\; \\displaystyle\\int_A \\!\\!\\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,\\gamma(\\mathbf{u} - \\mathbf{v})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v}$",
            "solution": "问题要求用半变异函数 $\\gamma(\\mathbf{h})$ 和权重函数 $w(\\mathbf{u})$ 来表示均方代表性误差 $\\mathbb{E}[e(\\mathbf{x}_0)^2]$。该问题陈述基于已建立的地球统计学原理，经证实是科学上合理、适定且客观的。\n\n我们从代表性误差的定义 $e(\\mathbf{x}_0) = Z(\\mathbf{x}_0) - Z_A$ 开始推导。待求量为均方误差：\n$$ \\mathbb{E}\\![e(\\mathbf{x}_0)^2] = \\mathbb{E}\\!\\big[(Z(\\mathbf{x}_0) - Z_A)^2\\big] $$\n展开平方项并利用期望算子 $\\mathbb{E}[\\cdot]$ 的线性性质，我们得到：\n$$ \\mathbb{E}\\![e(\\mathbf{x}_0)^2] = \\mathbb{E}\\![Z(\\mathbf{x}_0)^2] - 2\\,\\mathbb{E}\\![Z(\\mathbf{x}_0) Z_A] + \\mathbb{E}\\![Z_A^2] $$\n我们将计算右侧的三个项。\n\n标量场 $Z(\\mathbf{x})$ 是二阶平稳的，具有常数均值 $\\mu = \\mathbb{E}[Z(\\mathbf{x})]$ 和协方差函数 $C(\\mathbf{h}) = \\operatorname{Cov}(Z(\\mathbf{x}), Z(\\mathbf{x}+\\mathbf{h}))$。该场的方差是常数，$\\operatorname{Var}(Z(\\mathbf{x})) = C(\\mathbf{0})$。\n根据协方差的定义，我们有 $\\operatorname{Cov}(X, Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y]$，这意味着 $\\mathbb{E}[XY] = \\operatorname{Cov}(X, Y) + \\mathbb{E}[X]\\mathbb{E}[Y]$。\n\n对于任意两点 $\\mathbf{x}$ 和 $\\mathbf{y}$，我们有：\n$$ \\mathbb{E}[Z(\\mathbf{x}) Z(\\mathbf{y})] = \\operatorname{Cov}(Z(\\mathbf{x}), Z(\\mathbf{y})) + \\mathbb{E}[Z(\\mathbf{x})] \\mathbb{E}[Z(\\mathbf{y})] = C(\\mathbf{y}-\\mathbf{x}) + \\mu^2 $$\n如果 $\\mathbf{x} = \\mathbf{y}$，这变为：\n$$ \\mathbb{E}[Z(\\mathbf{x})^2] = C(\\mathbf{0}) + \\mu^2 $$\n\n现在我们计算这三项：\n1.  **第一项：** $\\mathbb{E}[Z(\\mathbf{x}_0)^2]$\n    $$ \\mathbb{E}[Z(\\mathbf{x}_0)^2] = C(\\mathbf{0}) + \\mu^2 $$\n\n2.  **第二项：** $-2\\,\\mathbb{E}[Z(\\mathbf{x}_0) Z_A]$\n    我们代入 $Z_A$ 的积分定义 $Z_A = \\int_A w(\\mathbf{u})\\,Z(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}$。假设期望和积分可以互换（由于该过程具有有限二阶矩，这由 Fubini 定理保证）：\n    $$ \\mathbb{E}[Z(\\mathbf{x}_0) Z_A] = \\mathbb{E}\\left[Z(\\mathbf{x}_0) \\int_A w(\\mathbf{u})\\,Z(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\right] = \\int_A w(\\mathbf{u})\\,\\mathbb{E}[Z(\\mathbf{x}_0) Z(\\mathbf{u})]\\,\\mathrm{d}\\mathbf{u} $$\n    使用关系式 $\\mathbb{E}[Z(\\mathbf{x}_0) Z(\\mathbf{u})] = C(\\mathbf{u}-\\mathbf{x}_0) + \\mu^2$：\n    $$ \\mathbb{E}[Z(\\mathbf{x}_0) Z_A] = \\int_A w(\\mathbf{u})\\,\\big(C(\\mathbf{u}-\\mathbf{x}_0) + \\mu^2\\big)\\,\\mathrm{d}\\mathbf{u} = \\int_A w(\\mathbf{u})\\,C(\\mathbf{u}-\\mathbf{x}_0)\\,\\mathrm{d}\\mathbf{u} + \\mu^2 \\int_A w(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u} $$\n    使用给定的归一化条件 $\\int_A w(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u} = 1$：\n    $$ \\mathbb{E}[Z(\\mathbf{x}_0) Z_A] = \\int_A w(\\mathbf{u})\\,C(\\mathbf{u}-\\mathbf{x}_0)\\,\\mathrm{d}\\mathbf{u} + \\mu^2 $$\n\n3.  **第三项：** $\\mathbb{E}[Z_A^2]$\n    $$ \\mathbb{E}[Z_A^2] = \\mathbb{E}\\left[\\left(\\int_A w(\\mathbf{u})\\,Z(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\right)\\left(\\int_A w(\\mathbf{v})\\,Z(\\mathbf{v})\\,\\mathrm{d}\\mathbf{v}\\right)\\right] $$\n    我们将其写成一个二重积分，并交换期望和积分：\n    $$ \\mathbb{E}[Z_A^2] = \\int_A \\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,\\mathbb{E}[Z(\\mathbf{u}) Z(\\mathbf{v})]\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} $$\n    使用 $\\mathbb{E}[Z(\\mathbf{u})Z(\\mathbf{v})] = C(\\mathbf{v}-\\mathbf{u}) + \\mu^2$：\n    $$ \\mathbb{E}[Z_A^2] = \\int_A \\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,\\big(C(\\mathbf{v}-\\mathbf{u}) + \\mu^2\\big)\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} $$\n    $$ \\mathbb{E}[Z_A^2] = \\int_A \\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,C(\\mathbf{v}-\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} + \\mu^2 \\left(\\int_A w(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\right)\\left(\\int_A w(\\mathbf{v})\\,\\mathrm{d}\\mathbf{v}\\right) $$\n    使用归一化条件 $\\int_A w(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u} = 1$：\n    $$ \\mathbb{E}[Z_A^2] = \\int_A \\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,C(\\mathbf{v}-\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} + \\mu^2 $$\n\n现在，我们将这三个表达式代回到 $\\mathbb{E}[e(\\mathbf{x}_0)^2]$ 的方程中：\n$$ \\mathbb{E}\\![e(\\mathbf{x}_0)^2] = (C(\\mathbf{0}) + \\mu^2) - 2\\left(\\int_A w(\\mathbf{u})\\,C(\\mathbf{u}-\\mathbf{x}_0)\\,\\mathrm{d}\\mathbf{u} + \\mu^2\\right) + \\left(\\int_A \\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,C(\\mathbf{v}-\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} + \\mu^2\\right) $$\n$$ \\mathbb{E}\\![e(\\mathbf{x}_0)^2] = C(\\mathbf{0}) + \\mu^2 - 2\\int_A w(\\mathbf{u})\\,C(\\mathbf{u}-\\mathbf{x}_0)\\,\\mathrm{d}\\mathbf{u} - 2\\mu^2 + \\int_A \\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,C(\\mathbf{v}-\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} + \\mu^2 $$\n涉及均值 $\\mu$ 的项相互抵消：$\\mu^2 - 2\\mu^2 + \\mu^2 = 0$。这表明均方误差不依赖于场的均值，这是预料之中的，因为误差 $e(\\mathbf{x}_0)$ 的均值为零。表达式简化为：\n$$ \\mathbb{E}\\![e(\\mathbf{x}_0)^2] = C(\\mathbf{0}) - 2\\int_A w(\\mathbf{u})\\,C(\\mathbf{u}-\\mathbf{x}_0)\\,\\mathrm{d}\\mathbf{u} + \\int_A \\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,C(\\mathbf{v}-\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} $$\n最后一步是使用给定的关系 $\\gamma(\\mathbf{h}) = C(\\mathbf{0}) - C(\\mathbf{h})$（这意味着 $C(\\mathbf{h}) = C(\\mathbf{0}) - \\gamma(\\mathbf{h})$）将此表达式从协方差函数 $C(\\mathbf{h})$ 转换为半变异函数 $\\gamma(\\mathbf{h})$。\n将此代入我们的表达式：\n$$ \\mathbb{E}\\![e(\\mathbf{x}_0)^2] = C(\\mathbf{0}) - 2\\int_A w(\\mathbf{u})\\,\\big(C(\\mathbf{0}) - \\gamma(\\mathbf{u}-\\mathbf{x}_0)\\big)\\,\\mathrm{d}\\mathbf{u} + \\int_A \\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,\\big(C(\\mathbf{0}) - \\gamma(\\mathbf{v}-\\mathbf{u})\\big)\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} $$\n让我们展开这些积分：\n$$ \\mathbb{E}\\![e(\\mathbf{x}_0)^2] = C(\\mathbf{0}) - 2C(\\mathbf{0})\\int_A w(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u} + 2\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{u}-\\mathbf{x}_0)\\,\\mathrm{d}\\mathbf{u} + C(\\mathbf{0})\\int_A\\int_A w(\\mathbf{u})w(\\mathbf{v})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} - \\int_A\\int_A w(\\mathbf{u})w(\\mathbf{v})\\,\\gamma(\\mathbf{v}-\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} $$\n使用归一化条件 $\\int_A w(\\mathbf{u})\\,\\mathrm{d}\\mathbf{u} = 1$：\n$$ \\mathbb{E}\\![e(\\mathbf{x}_0)^2] = C(\\mathbf{0}) - 2C(\\mathbf{0}) \\cdot 1 + 2\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{u}-\\mathbf{x}_0)\\,\\mathrm{d}\\mathbf{u} + C(\\mathbf{0}) \\cdot 1 \\cdot 1 - \\int_A\\int_A w(\\mathbf{u})w(\\mathbf{v})\\,\\gamma(\\mathbf{v}-\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} $$\n涉及方差 $C(\\mathbf{0})$ 的项相互抵消：$C(\\mathbf{0}) - 2C(\\mathbf{0}) + C(\\mathbf{0}) = 0$。最终表达式为：\n$$ \\mathbb{E}\\![e(\\mathbf{x}_0)^2] = 2\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{u}-\\mathbf{x}_0)\\,\\mathrm{d}\\mathbf{u} - \\int_A\\int_A w(\\mathbf{u})w(\\mathbf{v})\\,\\gamma(\\mathbf{v}-\\mathbf{u})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} $$\n半变异函数是偶函数，即 $\\gamma(\\mathbf{h}) = \\gamma(-\\mathbf{h})$。因此，我们可以写成 $\\gamma(\\mathbf{u}-\\mathbf{x}_0) = \\gamma(\\mathbf{x}_0-\\mathbf{u})$ 和 $\\gamma(\\mathbf{v}-\\mathbf{u}) = \\gamma(\\mathbf{u}-\\mathbf{v})$。表达式变为：\n$$ \\mathbb{E}\\![e(\\mathbf{x}_0)^2] = 2\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{x}_0-\\mathbf{u})\\,\\mathrm{d}\\mathbf{u} - \\int_A\\int_A w(\\mathbf{u})w(\\mathbf{v})\\,\\gamma(\\mathbf{u}-\\mathbf{v})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} $$\n该表达式表示点值和区域平均值之间误差的方差。这是地球统计学中的一个基本结果，通常表示为 $\\sigma_E^2 = 2\\bar{\\gamma}(\\mathbf{x}_0, A) - \\bar{\\gamma}(A, A)$，其中 $\\bar{\\gamma}$ 表示两个域（可以是点或区域）之间的平均半变异函数。\n\n现在我们评估每个选项：\n\n**A. $\\mathbb{E}\\!\\big[e(\\mathbf{x}_0)^2\\big] = 2 \\displaystyle\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{x}_0 - \\mathbf{u})\\,\\mathrm{d}\\mathbf{u} \\;-\\; \\displaystyle\\int_A \\!\\!\\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,\\gamma(\\mathbf{u} - \\mathbf{v})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v}$**\n该表达式与我们推导出的结果完全匹配。\n**结论：正确**\n\n**B. $\\mathbb{E}\\!\\big[e(\\mathbf{x}_0)^2\\big] = \\displaystyle\\int_A \\!\\!\\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,\\gamma(\\mathbf{u} - \\mathbf{v})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v} \\;-\\; 2 \\displaystyle\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{x}_0 - \\mathbf{u})\\,\\mathrm{d}\\mathbf{u}$**\n这是正确表达式的负值。由于均方误差必须为非负，并且涉及非负函数（$\\gamma(\\mathbf{h}) \\ge 0$, $w(\\mathbf{u}) \\ge 0$）积分的项是非负的，因此该表达式通常为非正。\n**结论：错误**\n\n**C. $\\mathbb{E}\\!\\big[e(\\mathbf{x}_0)^2\\big] = \\displaystyle\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{x}_0 - \\mathbf{u})\\,\\mathrm{d}\\mathbf{u}$**\n该选项省略了第一项中的因子 2，并完全省略了第二项（表示区域内平均半变异函数的二重积分）。这是一个不完整的表达式。\n**结论：错误**\n\n**D. $\\mathbb{E}\\!\\big[e(\\mathbf{x}_0)^2\\big] = 2 \\displaystyle\\int_A w(\\mathbf{u})\\,\\gamma(\\mathbf{x}_0 - \\mathbf{u})\\,\\mathrm{d}\\mathbf{u} \\;+\\; \\displaystyle\\int_A \\!\\!\\int_A w(\\mathbf{u})\\,w(\\mathbf{v})\\,\\gamma(\\mathbf{u} - \\mathbf{v})\\,\\mathrm{d}\\mathbf{u}\\,\\mathrm{d}\\mathbf{v}$**\n该选项在两个积分项之间用加号代替了减号。推导过程清楚地表明，二重积分项的符号为负，这是因为将 $C(\\mathbf{h}) = C(\\mathbf{0}) - \\gamma(\\mathbf{h})$ 代入 $\\mathbb{E}[Z_A^2]$ 项，而该项在 $(Z(\\mathbf{x}_0) - Z_A)^2$ 的初始展开式中带正号。\n**结论：错误**\n\n因此，唯一正确的表达式由选项 A 给出。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "本练习将理论应用于实践，旨在解决一个真实的遥感问题：监测人类活动对水循环的影响。它利用了灌溉活动、蒸发冷却效应（体现在地表温度）以及植被含水量（体现在微波植被光学厚度）之间的物理联系。通过从第一性原理出发，您将设计、实施并验证一个完整的遥感诊断算法，真实地模拟科学家如何结合多源卫星数据来监测环境和水资源的人为变化。",
            "id": "3814664",
            "problem": "必须设计一种遥感和环境模拟诊断方法，利用卫星地表皮温日振幅和植被光学厚度的异常来检测灌溉，并根据独立的灌溉地图进行验证。其推导和实现必须从地表能量平衡和微波辐射传输的基本物理原理出发，不得假定任何预先存在的检测公式。该诊断方法必须满足以下要求。\n\n使用的理论基础：\n- 地表能量平衡：净辐射分配为感热通量和潜热通量，其中灌溉导致的蒸发增加会降低近地表温度在日循环中的变率。昼夜地表温度振幅对这种能量分配做出响应。\n- 微波辐射传输：植被光学厚度随植被含水量的增加而增加，因此异常湿润的植被会使其光学厚度相对于气候态增加。\n\n数据与单位：\n- 使用以开尔文（用 $K$ 表示值）为单位的地表皮温日振幅。具体来说，差异指的是以 $K$ 为单位的昼夜振幅值和气候参考值。\n- 使用无量纲的植被光学厚度（VOD）值。\n- 所有报告的物理量必须在其指定单位下进行内部计算。最终的技能指标是无量纲的。\n\n实现任务：\n1. 针对地表皮温日振幅和植被光学厚度，定义相对于逐像素气候态的标准化异常。标准化应根据观测值、气候平均值和气候标准差计算，从而产生可比较和可组合的无量纲标准化异常。\n2. 从第一性原理出发，构建一个无量纲的灌溉指纹诊断方法，该诊断值在存在灌溉时会增加。其构建方式为：组合标准化异常，使得减小的日振幅（与蒸发增加一致）和增加的植被光学厚度（与植被含水量增加一致）都能使诊断值增加。使用一个对应于无灌溉信号的零期望且具有物理动机的阈值，来推导检测决策规则。\n3. 通过计算每个测试用例的混淆矩阵和 Matthews 相关系数，根据独立的灌溉地图标签来验证该诊断方法。如果 Matthews 相关系数的分母为零（退化情况），则将该系数设为 $0.0$。\n\n测试套件：\n实现程序，为以下四个测试用例计算检测和验证。每个测试用例包含逐像素输入的数组和一个独立灌溉标签的数组。对于每个数组条目，每个数字必须完全按照给定的方式使用。所有物理量都以其单位指定，除标签为整数外，所有数字都必须作为浮点数处理。\n\n- 测试用例 $1$（混合信号，正常路径）：\n  - 观测的日振幅 $A_{\\mathrm{obs}}$：$[9.0,14.0,10.0,16.0,11.0,13.0]$，单位 $K$。\n  - 日振幅气候平均值 $\\mu_{A}$：$[12.0,13.0,12.0,13.0,12.0,12.0]$，单位 $K$。\n  - 日振幅气候标准差 $\\sigma_{A}$：$[2.0,2.0,1.5,3.0,2.0,3.0]$，单位 $K$。\n  - 观测的植被光学厚度 $V_{\\mathrm{obs}}$：$[0.62,0.50,0.58,0.53,0.56,0.54]$（无量纲）。\n  - 植被光学厚度气候平均值 $\\mu_{V}$：$[0.54,0.52,0.55,0.53,0.55,0.55]$（无量纲）。\n  - 植被光学厚度气候标准差 $\\sigma_{V}$：$[0.04,0.03,0.02,0.04,0.02,0.02]$（无量纲）。\n  - 独立灌溉标签 $y$：$[1,0,1,0,1,0]$，其中 $1$ 表示灌溉，$0$ 表示非灌溉。\n\n- 测试用例 $2$（全为非灌溉，边界条件）：\n  - $A_{\\mathrm{obs}}$：$[13.6,12.0,13.0,12.6]$，单位 $K$。\n  - $\\mu_{A}$：$[12.0,12.0,12.0,12.0]$，单位 $K$。\n  - $\\sigma_{A}$：$[2.0,2.0,2.0,2.0]$，单位 $K$。\n  - $V_{\\mathrm{obs}}$：$[0.52,0.544,0.55,0.541]$（无量纲）。\n  - $\\mu_{V}$：$[0.55,0.55,0.55,0.55]$（无量纲）。\n  - $\\sigma_{V}$：$[0.03,0.03,0.03,0.03]$（无量纲）。\n  - $y$：$[0,0,0,0]$。\n\n- 测试用例 $3$（全为灌溉，边界条件）：\n  - $A_{\\mathrm{obs}}$：$[11.0,11.5,10.5,12.0]$，单位 $K$。\n  - $\\mu_{A}$：$[13.0,13.0,13.0,13.0]$，单位 $K$。\n  - $\\sigma_{A}$：$[2.0,2.0,2.0,2.0]$，单位 $K$。\n  - $V_{\\mathrm{obs}}$：$[0.56,0.55,0.57,0.54]$（无量纲）。\n  - $\\mu_{V}$：$[0.53,0.53,0.53,0.53]$（无量纲）。\n  - $\\sigma_{V}$：$[0.02,0.02,0.02,0.02]$（无量纲）。\n  - $y$：$[1,1,1,1]$。\n\n- 测试用例 $4$（模糊边缘情况，近阈值信号）：\n  - $A_{\\mathrm{obs}}$：$[11.2,12.8,11.0,12.0,13.5]$，单位 $K$。\n  - $\\mu_{A}$：$[12.0,12.0,12.0,12.0,12.0]$，单位 $K$。\n  - $\\sigma_{A}$：$[3.0,3.0,3.0,3.0,3.0]$，单位 $K$。\n  - $V_{\\mathrm{obs}}$：$[0.553,0.555,0.540,0.543,0.525]$（无量纲）。\n  - $\\mu_{V}$：$[0.54,0.54,0.54,0.54,0.54]$（无量纲）。\n  - $\\sigma_{V}$：$[0.03,0.03,0.03,0.03,0.03]$（无量纲）。\n  - $y$：$[1,0,1,0,0]$。\n\n所需计算：\n- 为每个测试用例中的每个像素计算日振幅的标准化异常 $z_{A}$ 和植被光学厚度的标准化异常 $z_{V}$。\n- 从第一性原理出发，构建一个随 $z_{A}$ 减小和 $z_{V}$ 增加而增加的无量纲灌溉指纹诊断。并实现一个检测规则，将该诊断值与代表无灌溉信号的零阈值进行比较。\n- 对于每个测试用例，根据检测结果与标签之间的混淆矩阵，生成 Matthews 相关系数，并将分母退化的情况映射为 $0.0$。\n\n最终输出格式和数值规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为四个测试用例的 Matthews 相关系数，每个系数四舍五入到三位小数（例如，$[0.750,0.000,0.000,0.250]$）。这些指标是无量纲的浮点数。\n\n不应读取任何外部输入；所有数组必须完全按照上述规定嵌入到程序中。",
            "solution": "该诊断方法源于将地表能量平衡与日温度变率、将微波辐射传输与植被光学厚度联系起来的基本关系，然后通过分类技能指标进行验证。\n\n地表皮温日振幅的第一性原理。地表能量平衡指出，净辐射 $R_{n}$ 分配给感热通量 $H$、潜热通量 $\\lambda E$ 和地面热通量 $G$：\n$$\nR_{n} = H + \\lambda E + G.\n$$\n在灌溉条件下，土壤湿度增加，从而增强了蒸发 $\\lambda E$，并且随着蒸发比的增加，通常会减少 $H$。增加的 $\\lambda E$ 抑制了近地表的温度波动，因为更多的可用能量被相变消耗，而不是用于升高空气和地表温度。当蒸发比增加时，昼夜地表温度振幅（记为 $A$，单位为 $K$）减小。围绕气候态，可以使用标准化异常来比较不同变量和区域间的信号。日振幅的标准化异常为\n$$\nz_{A} = \\frac{A_{\\mathrm{obs}} - \\mu_{A}}{\\sigma_{A}},\n$$\n其中 $A_{\\mathrm{obs}}$ 是观测到的振幅，$\\mu_{A}$ 是气候平均值，$\\sigma_{A}$ 是气候标准差。由于灌溉会使日振幅相对于气候态减小，因此灌溉与 $z_{A} < 0$ 相关，等效地，与 $-z_{A} > 0$ 相关。\n\n植被光学厚度的第一性原理。通过植被的微波辐射传输可以用光学厚度 $\\tau$ 来描述，它与植被含水量 $W$ 的关系如下\n$$\n\\tau \\propto W,\n$$\n其比例关系由取决于物种和频率的参数设定。因此，植被光学厚度（VOD），一个衡量微波衰减的无量纲量，在植被更湿润或生物量更高时会增加。围绕气候态，VOD的标准化异常为\n$$\nz_{V} = \\frac{V_{\\mathrm{obs}} - \\mu_{V}}{\\sigma_{V}},\n$$\n其中 $V_{\\mathrm{obs}}$ 是观测到的VOD，$\\mu_{V}$ 是气候平均值，$\\sigma_{V}$ 是其气候标准差。灌溉导致更高的植被含水量，并通常导致相对于气候态更高的VOD，从而得出 $z_{V} > 0$。\n\n构建一个具有物理动机的诊断方法。一个无量纲的灌溉指纹诊断值应当在日振幅异常减小和VOD异常增加时增加。遵循这种方向性的最简单的诊断方法是标准化异常的线性组合：\n$$\nS = \\alpha \\, (-z_{A}) + \\beta \\, z_{V},\n$$\n其中 $\\alpha$ 和 $\\beta$ 是非负权重。在没有额外校准的情况下，一个基于原则的选择是 $\\alpha = 1$ 和 $\\beta = 1$，这假定标准化后的灵敏度是可比的。由此得出\n$$\nS = -z_{A} + z_{V}.\n$$\n在无灌溉信号的零假设下，标准化异常以零为中心，$S$的期望值为零。因此，一个具有物理动机的检测规则是\n$$\n\\text{检测为灌溉，如果 } S > 0,\n$$\n也就是说，当增加的VOD的正贡献超过日振幅的任何增加时，或者当减小的日振幅与非负的VOD异常结合，产生一个总体为正的指纹时，检测为灌溉。\n\n验证指标。对于每个测试用例，将检测结果与标签 $y \\in \\{0,1\\}$ 进行比较，并计算混淆矩阵的计数：真阳性 $TP$、真阴性 $TN$、假阳性 $FP$ 和假阴性 $FN$。Matthews相关系数（无量纲）为\n$$\n\\mathrm{MCC} = \\frac{TP \\cdot TN - FP \\cdot FN}{\\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}}.\n$$\n在分母为零的退化情况下（例如，所有检测和标签都属于同一类别），定义 $\\mathrm{MCC} = 0.0$ 以避免未定义行为。这个约定为所有四个测试用例提供了一个有界且可计算的技能度量。\n\n实现的算法步骤：\n1. 对每个像素，使用给定的 $A_{\\mathrm{obs}}$、$\\mu_{A}$ 和 $\\sigma_{A}$ 计算 $z_{A}$，确保 $A$ 的量以 $K$ 为单位处理。\n2. 对每个像素，使用给定的 $V_{\\mathrm{obs}}$、$\\mu_{V}$ 和 $\\sigma_{V}$ 计算 $z_{V}$。\n3. 对每个像素计算 $S = -z_{A} + z_{V}$。应用检测规则 $S > 0$ 来产生一个布尔检测结果。\n4. 将检测结果与标签 $y$ 进行比较，以累积 $TP$、$TN$、$FP$ 和 $FN$，然后使用上述公式为每个测试用例计算 $\\mathrm{MCC}$，并将分母退化的情况映射为 $0.0$。\n5. 将每个 $\\mathrm{MCC}$ 四舍五入到三位小数，并以指定格式用单行输出这四个值。\n\n物理一致性与测试套件。给定的数值与所描述的物理原理在内部是一致的：与气候态相比，灌溉像素具有较低的日振幅（负 $z_{A}$）和较高的VOD（正 $z_{V}$），而非灌溉像素则具有相反或中性的特征。边界测试用例探查了退化的混淆矩阵，而模糊情况包含了近阈值信号以测试鲁棒性。最终程序将生成单行输出，按测试用例的顺序列出四个无量纲的 $\\mathrm{MCC}$ 值，每个值都四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef standardized_anomaly(obs: np.ndarray, mu: np.ndarray, sigma: np.ndarray) -> np.ndarray:\n    \"\"\"Compute standardized anomalies (z-scores) elementwise.\"\"\"\n    return (obs - mu) / sigma\n\ndef irrigation_fingerprint(z_A: np.ndarray, z_V: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Compute the irrigation fingerprint diagnostic S = -z_A + z_V.\n    Positive values indicate irrigation presence under the derived rule.\n    \"\"\"\n    return (-z_A) + z_V\n\ndef detect_irrigation(S: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Detection rule: irrigation is detected if S > 0.\n    Returns a boolean array.\n    \"\"\"\n    return S > 0.0\n\ndef matthews_correlation_coefficient(y_true: np.ndarray, y_pred: np.ndarray) -> float:\n    \"\"\"\n    Compute Matthews correlation coefficient.\n    If the denominator is zero (degenerate case), return 0.0.\n    \"\"\"\n    # Convert booleans to integers 0/1 for counting\n    yt = y_true.astype(int)\n    yp = y_pred.astype(int)\n    tp = int(np.sum((yp == 1)  (yt == 1)))\n    tn = int(np.sum((yp == 0)  (yt == 0)))\n    fp = int(np.sum((yp == 1)  (yt == 0)))\n    fn = int(np.sum((yp == 0)  (yt == 1)))\n\n    denom = np.sqrt((tp + fp) * (tp + fn) * (tn + fp) * (tn + fn))\n    if denom == 0.0:\n        return 0.0\n    return (tp * tn - fp * fn) / denom\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a dict with observed and climatological arrays and labels.\n    test_cases = [\n        {\n            \"A_obs\": np.array([9.0, 14.0, 10.0, 16.0, 11.0, 13.0], dtype=float),\n            \"A_mu\":  np.array([12.0, 13.0, 12.0, 13.0, 12.0, 12.0], dtype=float),\n            \"A_sigma\": np.array([2.0, 2.0, 1.5, 3.0, 2.0, 3.0], dtype=float),\n            \"V_obs\": np.array([0.62, 0.50, 0.58, 0.53, 0.56, 0.54], dtype=float),\n            \"V_mu\":  np.array([0.54, 0.52, 0.55, 0.53, 0.55, 0.55], dtype=float),\n            \"V_sigma\": np.array([0.04, 0.03, 0.02, 0.04, 0.02, 0.02], dtype=float),\n            \"labels\": np.array([1, 0, 1, 0, 1, 0], dtype=int),\n        },\n        {\n            \"A_obs\": np.array([13.6, 12.0, 13.0, 12.6], dtype=float),\n            \"A_mu\":  np.array([12.0, 12.0, 12.0, 12.0], dtype=float),\n            \"A_sigma\": np.array([2.0, 2.0, 2.0, 2.0], dtype=float),\n            \"V_obs\": np.array([0.52, 0.544, 0.55, 0.541], dtype=float),\n            \"V_mu\":  np.array([0.55, 0.55, 0.55, 0.55], dtype=float),\n            \"V_sigma\": np.array([0.03, 0.03, 0.03, 0.03], dtype=float),\n            \"labels\": np.array([0, 0, 0, 0], dtype=int),\n        },\n        {\n            \"A_obs\": np.array([11.0, 11.5, 10.5, 12.0], dtype=float),\n            \"A_mu\":  np.array([13.0, 13.0, 13.0, 13.0], dtype=float),\n            \"A_sigma\": np.array([2.0, 2.0, 2.0, 2.0], dtype=float),\n            \"V_obs\": np.array([0.56, 0.55, 0.57, 0.54], dtype=float),\n            \"V_mu\":  np.array([0.53, 0.53, 0.53, 0.53], dtype=float),\n            \"V_sigma\": np.array([0.02, 0.02, 0.02, 0.02], dtype=float),\n            \"labels\": np.array([1, 1, 1, 1], dtype=int),\n        },\n        {\n            \"A_obs\": np.array([11.2, 12.8, 11.0, 12.0, 13.5], dtype=float),\n            \"A_mu\":  np.array([12.0, 12.0, 12.0, 12.0, 12.0], dtype=float),\n            \"A_sigma\": np.array([3.0, 3.0, 3.0, 3.0, 3.0], dtype=float),\n            \"V_obs\": np.array([0.553, 0.555, 0.540, 0.543, 0.525], dtype=float),\n            \"V_mu\":  np.array([0.54, 0.54, 0.54, 0.54, 0.54], dtype=float),\n            \"V_sigma\": np.array([0.03, 0.03, 0.03, 0.03, 0.03], dtype=float),\n            \"labels\": np.array([1, 0, 1, 0, 0], dtype=int),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        z_A = standardized_anomaly(case[\"A_obs\"], case[\"A_mu\"], case[\"A_sigma\"])\n        z_V = standardized_anomaly(case[\"V_obs\"], case[\"V_mu\"], case[\"V_sigma\"])\n        S = irrigation_fingerprint(z_A, z_V)\n        detections = detect_irrigation(S)\n        mcc = matthews_correlation_coefficient(case[\"labels\"], detections)\n        results.append(mcc)\n\n    # Final print statement in the exact required format with three decimals.\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}