{
    "hands_on_practices": [
        {
            "introduction": "This exercise lays the groundwork for geostatistical interpolation by exploring Simple Kriging, the most fundamental form of kriging. In this scenario, we assume the mean of the spatial field is known, which allows us to focus purely on minimizing the estimation error based on the spatial covariance structure. By deriving the estimator and calculating a prediction from first principles, you will gain a core understanding of how kriging leverages spatial autocorrelation to produce optimal linear predictions .",
            "id": "3817484",
            "problem": "A remote sensing campaign uses thermal infrared observations to estimate land surface temperature at ground locations. Let $Z(\\mathbf{s})$ be a second-order stationary random field of land surface temperature anomalies (departures from a climatological mean), defined over a planar region. Assume the mean of $Z(\\mathbf{s})$ is known and equal to $m$, and the covariance function depends only on separation distance, with $C(h) = \\sigma^{2} \\exp(-h/a)$, where $h = \\|\\mathbf{s} - \\mathbf{s}'\\|$, $\\sigma^{2}  0$ is the process variance (sill), and $a  0$ is the correlation range parameter. There is no measurement error (no nugget effect).\n\nTwo in situ calibration sites, located along a straight transect, provide quality-controlled temperature measurements at positions $\\mathbf{s}_{1} = (-5, 0)$ and $\\mathbf{s}_{2} = (5, 0)$ (units in $\\mathrm{km}$), and the target location for prediction is the origin $\\mathbf{s}_{0} = (0, 0)$. The known climatological mean is $m = 300\\,\\mathrm{K}$. The observed temperatures at the two sites are $Z(\\mathbf{s}_{1}) = 302\\,\\mathrm{K}$ and $Z(\\mathbf{s}_{2}) = 296\\,\\mathrm{K}$. The covariance parameters are $\\sigma^{2} = 9\\,\\mathrm{K}^{2}$ and $a = 10\\,\\mathrm{km}$.\n\nFrom the definitions of second-order stationarity and the linear minimum mean squared error principle, derive the simple kriging estimator at $\\mathbf{s}_{0}$ and the corresponding system for the kriging weights based on the given covariance model. Then, solve for the weights and compute the simple kriging prediction $\\hat{Z}(\\mathbf{s}_{0})$.\n\nExpress the final predicted temperature in $\\mathrm{K}$ and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of a simple kriging estimate for the land surface temperature at a target location, based on observations at two nearby sites.\n\nFirst, we establish the theoretical framework for simple kriging. Let $Z(\\mathbf{s})$ be a second-order stationary random field with a known constant mean $E[Z(\\mathbf{s})] = m$ and a covariance function $C(\\mathbf{s}, \\mathbf{s}') = \\text{Cov}(Z(\\mathbf{s}), Z(\\mathbf{s}'))$. The covariance is assumed to depend only on the separation vector, and in this case, only on the distance $h = \\|\\mathbf{s} - \\mathbf{s}'\\|$, so $C(h)$.\n\nIt is computationally convenient to work with the anomalies (or residuals) from the mean, $Y(\\mathbf{s}) = Z(\\mathbf{s}) - m$. By construction, the anomaly field $Y(\\mathbf{s})$ has a mean of $E[Y(\\mathbf{s})] = 0$ and the same covariance function as $Z(\\mathbf{s})$, since $\\text{Cov}(Y(\\mathbf{s}), Y(\\mathbf{s}')) = \\text{Cov}(Z(\\mathbf{s})-m, Z(\\mathbf{s}')-m) = \\text{Cov}(Z(\\mathbf{s}), Z(\\mathbf{s}')) = C(h)$.\n\nThe simple kriging estimator for the value of the random field at a new location $\\mathbf{s}_{0}$ is a linear combination of the $n$ observed values. For the anomaly field, the estimator $\\hat{Y}(\\mathbf{s}_{0})$ is given by:\n$$ \\hat{Y}(\\mathbf{s}_{0}) = \\sum_{i=1}^{n} w_i Y(\\mathbf{s}_i) $$\nwhere $Y(\\mathbf{s}_i) = Z(\\mathbf{s}_i) - m$ are the observed anomalies at locations $\\mathbf{s}_i$, and $w_i$ are the kriging weights.\n\nThe weights $w_i$ are determined by minimizing the mean squared error (MSE) of the estimation, which is defined as $\\text{MSE} = E\\left[ (Y(\\mathbf{s}_{0}) - \\hat{Y}(\\mathbf{s}_{0}))^2 \\right]$.\n$$ \\text{MSE} = E\\left[ \\left(Y(\\mathbf{s}_{0}) - \\sum_{i=1}^{n} w_i Y(\\mathbf{s}_i)\\right)^2 \\right] $$\nTo find the weights that minimize the MSE, we take the partial derivative with respect to each weight $w_j$ ($j=1, \\dots, n$) and set it to zero:\n$$ \\frac{\\partial(\\text{MSE})}{\\partial w_j} = E\\left[ -2 Y(\\mathbf{s}_j) \\left(Y(\\mathbf{s}_{0}) - \\sum_{i=1}^{n} w_i Y(\\mathbf{s}_i)\\right) \\right] = 0 $$\n$$ \\Rightarrow E[Y(\\mathbf{s}_j) Y(\\mathbf{s}_{0})] - \\sum_{i=1}^{n} w_i E[Y(\\mathbf{s}_j) Y(\\mathbf{s}_i)] = 0 $$\nSince the mean of $Y(\\mathbf{s})$ is zero, $E[Y(\\mathbf{s}_a) Y(\\mathbf{s}_b)] = \\text{Cov}(Y(\\mathbf{s}_a), Y(\\mathbf{s}_b)) = C(\\mathbf{s}_a, \\mathbf{s}_b)$. The system of equations for the weights becomes:\n$$ \\sum_{i=1}^{n} w_i C(\\mathbf{s}_i, \\mathbf{s}_j) = C(\\mathbf{s}_0, \\mathbf{s}_j) \\quad \\text{for } j=1, \\dots, n $$\nThis is the simple kriging system. In matrix notation, it is $\\mathbf{C} \\mathbf{w} = \\mathbf{c}$, where:\n- $\\mathbf{C}$ is the $n \\times n$ covariance matrix of the observation locations, with elements $C_{ij} = C(\\mathbf{s}_i, \\mathbf{s}_j)$.\n- $\\mathbf{w}$ is the $n \\times 1$ vector of unknown weights, $\\mathbf{w} = [w_1, \\dots, w_n]^T$.\n- $\\mathbf{c}$ is the $n \\times 1$ vector of covariances between the observation locations and the prediction location, with elements $c_j = C(\\mathbf{s}_j, \\mathbf{s}_0)$.\n\nThe solution for the weights is $\\mathbf{w} = \\mathbf{C}^{-1} \\mathbf{c}$.\n\nNow, we apply this to the specific problem. We have $n=2$ observation points.\nThe given parameters are:\n- Mean temperature: $m = 300\\,\\mathrm{K}$\n- Observation locations: $\\mathbf{s}_{1} = (-5, 0)$ and $\\mathbf{s}_{2} = (5, 0)$\n- Prediction location: $\\mathbf{s}_{0} = (0, 0)$\n- Observed temperatures: $Z(\\mathbf{s}_{1}) = 302\\,\\mathrm{K}$ and $Z(\\mathbf{s}_{2}) = 296\\,\\mathrm{K}$\n- Observed anomalies: $Y(\\mathbf{s}_{1}) = 302 - 300 = 2\\,\\mathrm{K}$ and $Y(\\mathbf{s}_{2}) = 296 - 300 = -4\\,\\mathrm{K}$\n- Covariance function: $C(h) = \\sigma^{2} \\exp(-h/a)$ with variance $\\sigma^{2} = 9\\,\\mathrm{K}^{2}$ and range $a = 10\\,\\mathrm{km}$. So, $C(h) = 9 \\exp(-h/10)$.\n\nNext, we calculate the required distances (in km):\n- $h_{12} = \\|\\mathbf{s}_{1} - \\mathbf{s}_{2}\\| = \\|(-5, 0) - (5, 0)\\| = \\|(-10, 0)\\| = 10\\,\\mathrm{km}$\n- $h_{10} = \\|\\mathbf{s}_{1} - \\mathbf{s}_{0}\\| = \\|(-5, 0) - (0, 0)\\| = \\|(-5, 0)\\| = 5\\,\\mathrm{km}$\n- $h_{20} = \\|\\mathbf{s}_{2} - \\mathbf{s}_{0}\\| = \\|(5, 0) - (0, 0)\\| = \\|(5, 0)\\| = 5\\,\\mathrm{km}$\n- $h_{11} = h_{22} = 0\\,\\mathrm{km}$\n\nNow we compute the elements of the matrices $\\mathbf{C}$ and $\\mathbf{c}$:\n- $C_{11} = C(h_{11}) = C(0) = 9 \\exp(-0/10) = 9$\n- $C_{22} = C(h_{22}) = C(0) = 9$\n- $C_{12} = C_{21} = C(h_{12}) = C(10) = 9 \\exp(-10/10) = 9 \\exp(-1)$\n- $c_1 = C(\\mathbf{s}_{1}, \\mathbf{s}_{0}) = C(h_{10}) = C(5) = 9 \\exp(-5/10) = 9 \\exp(-0.5)$\n- $c_2 = C(\\mathbf{s}_{2}, \\mathbf{s}_{0}) = C(h_{20}) = C(5) = 9 \\exp(-0.5)$\n\nThe simple kriging system is:\n$$ \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{21}  C_{22} \\end{pmatrix} \\begin{pmatrix} w_1 \\\\ w_2 \\end{pmatrix} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} $$\n$$ \\begin{pmatrix} 9  9 \\exp(-1) \\\\ 9 \\exp(-1)  9 \\end{pmatrix} \\begin{pmatrix} w_1 \\\\ w_2 \\end{pmatrix} = \\begin{pmatrix} 9 \\exp(-0.5) \\\\ 9 \\exp(-0.5) \\end{pmatrix} $$\nWe can divide the entire system by the constant factor $9$:\n$$ \\begin{pmatrix} 1  \\exp(-1) \\\\ \\exp(-1)  1 \\end{pmatrix} \\begin{pmatrix} w_1 \\\\ w_2 \\end{pmatrix} = \\begin{pmatrix} \\exp(-0.5) \\\\ \\exp(-0.5) \\end{pmatrix} $$\nThis gives two linear equations:\n$1) \\quad w_1 + w_2 \\exp(-1) = \\exp(-0.5)$\n$2) \\quad w_1 \\exp(-1) + w_2 = \\exp(-0.5)$\nDue to the symmetry of the problem (equidistant observation points from the target), we expect $w_1 = w_2$. Substituting $w_1 = w_2$ into the first equation:\n$$ w_1 + w_1 \\exp(-1) = \\exp(-0.5) $$\n$$ w_1 (1 + \\exp(-1)) = \\exp(-0.5) $$\n$$ w_1 = \\frac{\\exp(-0.5)}{1 + \\exp(-1)} $$\nThus, the weights are identical:\n$$ w_1 = w_2 = \\frac{\\exp(-0.5)}{1 + \\exp(-1)} $$\nNow we calculate the estimated anomaly $\\hat{Y}(\\mathbf{s}_{0})$:\n$$ \\hat{Y}(\\mathbf{s}_{0}) = w_1 Y(\\mathbf{s}_{1}) + w_2 Y(\\mathbf{s}_{2}) = \\left(\\frac{\\exp(-0.5)}{1 + \\exp(-1)}\\right) (2) + \\left(\\frac{\\exp(-0.5)}{1 + \\exp(-1)}\\right) (-4) $$\n$$ \\hat{Y}(\\mathbf{s}_{0}) = -2 \\left(\\frac{\\exp(-0.5)}{1 + \\exp(-1)}\\right) $$\nThe final predicted temperature $\\hat{Z}(\\mathbf{s}_{0})$ is obtained by adding the mean back to the estimated anomaly:\n$$ \\hat{Z}(\\mathbf{s}_{0}) = m + \\hat{Y}(\\mathbf{s}_{0}) = 300 - 2 \\left(\\frac{\\exp(-0.5)}{1 + \\exp(-1)}\\right) $$\nNow, we compute the numerical value:\n- $\\exp(-0.5) \\approx 0.60653066$\n- $\\exp(-1) \\approx 0.36787944$\nThe weight $w_1 = w_2$ is:\n$$ w_1 = w_2 \\approx \\frac{0.60653066}{1 + 0.36787944} = \\frac{0.60653066}{1.36787944} \\approx 0.4434156 $$\nThe predicted temperature is:\n$$ \\hat{Z}(\\mathbf{s}_{0}) \\approx 300 - 2 \\times (0.4434156) = 300 - 0.8868312 = 299.1131688\\,\\mathrm{K} $$\nThe problem requires the answer to be rounded to four significant figures. The value is $299.1131688...$. The first four significant figures are $2$, $9$, $9$, and $1$. The fifth significant digit is $1$, which is less than $5$, so we round down.\n$$ \\hat{Z}(\\mathbf{s}_{0}) \\approx 299.1\\,\\mathrm{K} $$",
            "answer": "$$\n\\boxed{299.1}\n$$"
        },
        {
            "introduction": "In practice, the true mean of a spatial process is rarely known, making the assumptions of Simple Kriging impractical. This exercise introduces Ordinary Kriging, the most widely used kriging method, which overcomes this limitation by enforcing an unbiasedness constraint on the estimator. You will work with a semivariogram model to derive and solve the Ordinary Kriging system, providing a robust and practical tool for estimating values at unsampled locations in environmental science and beyond .",
            "id": "3817477",
            "problem": "A remote sensing campaign monitors fine particulate matter concentration, denoted by the random function $Z(\\mathbf{s})$ in $\\mathrm{mg\\,m^{-3}}$, over a $100\\,\\mathrm{m} \\times 100\\,\\mathrm{m}$ urban block. Assume intrinsic stationarity with an unknown constant local mean and an isotropic exponential semivariogram with nugget given by\n$$\n\\gamma(h) \\;=\\; c_{0} \\;+\\; c \\left(1 - \\exp\\!\\left(-\\frac{h}{a}\\right)\\right),\n$$\nwhere $c_{0} = 0.2\\,\\mathrm{(mg\\,m^{-3})^{2}}$, $c = 1.0\\,\\mathrm{(mg\\,m^{-3})^{2}}$, and $a = 50\\,\\mathrm{m}$. Three in situ reference measurements with precise geolocation are available:\n- $Z(\\mathbf{s}_{1}) = 12\\,\\mathrm{mg\\,m^{-3}}$ at $\\mathbf{s}_{1} = (0, 50)\\,\\mathrm{m}$,\n- $Z(\\mathbf{s}_{2}) = 10\\,\\mathrm{mg\\,m^{-3}}$ at $\\mathbf{s}_{2} = (50, 0)\\,\\mathrm{m}$,\n- $Z(\\mathbf{s}_{3}) = 15\\,\\mathrm{mg\\,m^{-3}}$ at $\\mathbf{s}_{3} = (50, 50)\\,\\mathrm{m}$.\n\nYou are to estimate the concentration at the target location $\\mathbf{s}_{0} = (0, 0)\\,\\mathrm{m}$ using ordinary kriging. Starting from the definition of the semivariogram for an intrinsically stationary process,\n$$\n\\gamma(\\mathbf{h}) \\;=\\; \\frac{1}{2}\\,\\mathbb{E}\\!\\left[\\big(Z(\\mathbf{s}+\\mathbf{h}) - Z(\\mathbf{s})\\big)^{2}\\right],\n$$\nand the unbiasedness condition for ordinary kriging with an unknown constant mean, derive the ordinary kriging weights that minimize the estimation variance, and compute the ordinary kriging estimate $\\hat{Z}(\\mathbf{s}_{0})$. Treat $\\gamma(0)$ as $0$ consistently with the definition. Express the final estimate in $\\mathrm{mg\\,m^{-3}}$ and round your answer to four significant figures.",
            "solution": "We model $Z(\\mathbf{s})$ as an intrinsically stationary random function with unknown constant local mean $m$ and semivariogram $\\gamma(h)$ as specified. The ordinary kriging estimator at $\\mathbf{s}_{0}$ is\n$$\n\\hat{Z}(\\mathbf{s}_{0}) \\;=\\; \\sum_{i=1}^{n} w_{i}\\, Z(\\mathbf{s}_{i}),\n$$\nwith $n = 3$ and weights $\\{w_{i}\\}$ chosen to be unbiased and to minimize the estimation variance. For ordinary kriging, unbiasedness under an unknown constant mean requires\n$$\n\\sum_{i=1}^{n} w_{i} \\;=\\; 1.\n$$\nThe estimation variance for an intrinsically stationary process can be expressed in terms of the semivariogram as\n$$\n\\sigma^{2}_{\\mathrm{OK}}(\\mathbf{s}_{0}) \\;=\\; \\mathrm{Var}\\!\\left(\\hat{Z}(\\mathbf{s}_{0}) - Z(\\mathbf{s}_{0})\\right)\n\\;=\\; \\sum_{i=1}^{n}\\sum_{j=1}^{n} w_{i} w_{j}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{i} - \\mathbf{s}_{j}\\|\\right)\n- 2 \\sum_{i=1}^{n} w_{i}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{i} - \\mathbf{s}_{0}\\|\\right).\n$$\nTo enforce the unbiasedness constraint while minimizing $\\sigma^{2}_{\\mathrm{OK}}(\\mathbf{s}_{0})$, we form the Lagrangian\n$$\n\\mathcal{L}(\\mathbf{w}, \\mu) \\;=\\; \\sum_{i=1}^{n}\\sum_{j=1}^{n} w_{i} w_{j}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{i} - \\mathbf{s}_{j}\\|\\right)\n- 2 \\sum_{i=1}^{n} w_{i}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{i} - \\mathbf{s}_{0}\\|\\right)\n+ 2\\mu \\left(\\sum_{i=1}^{n} w_{i} - 1\\right),\n$$\nand set partial derivatives with respect to $w_{k}$ to zero:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial w_{k}} \\;=\\; 2 \\sum_{j=1}^{n} w_{j}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{k} - \\mathbf{s}_{j}\\|\\right)\n- 2\\, \\gamma\\!\\left(\\|\\mathbf{s}_{k} - \\mathbf{s}_{0}\\|\\right)\n+ 2\\mu \\;=\\; 0.\n$$\nDividing by $2$ yields the ordinary kriging system in semivariogram form:\n$$\n\\sum_{j=1}^{n} w_{j}\\, \\gamma\\!\\left(\\|\\mathbf{s}_{k} - \\mathbf{s}_{j}\\|\\right) + \\mu \\;=\\; \\gamma\\!\\left(\\|\\mathbf{s}_{k} - \\mathbf{s}_{0}\\|\\right), \\quad k = 1, \\dots, n,\n$$\nwith the constraint $\\sum_{i=1}^{n} w_{i} = 1$. Because $\\gamma(0) = 0$, the diagonal elements satisfy $\\gamma(\\|\\mathbf{s}_{i} - \\mathbf{s}_{i}\\|) = 0$.\n\nWe compute all required distances. The target is $\\mathbf{s}_{0} = (0, 0)\\,\\mathrm{m}$, and the data locations are $\\mathbf{s}_{1} = (0, 50)\\,\\mathrm{m}$, $\\mathbf{s}_{2} = (50, 0)\\,\\mathrm{m}$, $\\mathbf{s}_{3} = (50, 50)\\,\\mathrm{m}$. The pairwise distances are:\n- $\\|\\mathbf{s}_{1} - \\mathbf{s}_{0}\\| = \\sqrt{(0-0)^{2} + (50-0)^{2}} = 50\\,\\mathrm{m}$,\n- $\\|\\mathbf{s}_{2} - \\mathbf{s}_{0}\\| = \\sqrt{(50-0)^{2} + (0-0)^{2}} = 50\\,\\mathrm{m}$,\n- $\\|\\mathbf{s}_{3} - \\mathbf{s}_{0}\\| = \\sqrt{(50-0)^{2} + (50-0)^{2}} = 50\\sqrt{2}\\,\\mathrm{m}$,\n- $\\|\\mathbf{s}_{1} - \\mathbf{s}_{2}\\| = \\sqrt{(0-50)^{2} + (50-0)^{2}} = 50\\sqrt{2}\\,\\mathrm{m}$,\n- $\\|\\mathbf{s}_{1} - \\mathbf{s}_{3}\\| = \\sqrt{(0-50)^{2} + (50-50)^{2}} = 50\\,\\mathrm{m}$,\n- $\\|\\mathbf{s}_{2} - \\mathbf{s}_{3}\\| = \\sqrt{(50-50)^{2} + (0-50)^{2}} = 50\\,\\mathrm{m}$.\n\nDefine\n$$\n\\gamma_{50} \\;=\\; \\gamma(50) \\;=\\; c_{0} + c\\left(1 - \\exp\\!\\left(-\\frac{50}{a}\\right)\\right)\n\\;=\\; 0.2 + 1.0\\left(1 - \\exp(-1)\\right)\n\\;=\\; 1.2 - \\exp(-1),\n$$\n$$\n\\gamma_{70} \\;=\\; \\gamma(50\\sqrt{2}) \\;=\\; c_{0} + c\\left(1 - \\exp\\!\\left(-\\frac{50\\sqrt{2}}{a}\\right)\\right)\n\\;=\\; 0.2 + 1.0\\left(1 - \\exp(-\\sqrt{2})\\right)\n\\;=\\; 1.2 - \\exp(-\\sqrt{2}).\n$$\nNumerically,\n$$\n\\exp(-1) \\approx 0.367879441, \\quad \\exp(-\\sqrt{2}) \\approx 0.243116734,\n$$\nso\n$$\n\\gamma_{50} \\approx 0.832120559, \\quad \\gamma_{70} \\approx 0.956883266.\n$$\n\nLet the weights be $w_{1}, w_{2}, w_{3}$, and the Lagrange multiplier be $\\mu$. The ordinary kriging equations become\n$$\n\\begin{aligned}\n\\gamma(\\|\\mathbf{s}_{1}-\\mathbf{s}_{2}\\|) w_{2} + \\gamma(\\|\\mathbf{s}_{1}-\\mathbf{s}_{3}\\|) w_{3} + \\mu \\;=\\; \\gamma(\\|\\mathbf{s}_{1}-\\mathbf{s}_{0}\\|), \\\\\n\\gamma(\\|\\mathbf{s}_{2}-\\mathbf{s}_{1}\\|) w_{1} + \\gamma(\\|\\mathbf{s}_{2}-\\mathbf{s}_{3}\\|) w_{3} + \\mu \\;=\\; \\gamma(\\|\\mathbf{s}_{2}-\\mathbf{s}_{0}\\|), \\\\\n\\gamma(\\|\\mathbf{s}_{3}-\\mathbf{s}_{1}\\|) w_{1} + \\gamma(\\|\\mathbf{s}_{3}-\\mathbf{s}_{2}\\|) w_{2} + \\mu \\;=\\; \\gamma(\\|\\mathbf{s}_{3}-\\mathbf{s}_{0}\\|), \\\\\nw_{1} + w_{2} + w_{3} \\;=\\; 1,\n\\end{aligned}\n$$\nwhich, after substituting distances, is\n$$\n\\begin{aligned}\n\\gamma_{70}\\, w_{2} + \\gamma_{50}\\, w_{3} + \\mu \\;=\\; \\gamma_{50}, \\\\\n\\gamma_{70}\\, w_{1} + \\gamma_{50}\\, w_{3} + \\mu \\;=\\; \\gamma_{50}, \\\\\n\\gamma_{50}\\, w_{1} + \\gamma_{50}\\, w_{2} + \\mu \\;=\\; \\gamma_{70}, \\\\\nw_{1} + w_{2} + w_{3} \\;=\\; 1.\n\\end{aligned}\n$$\nBy symmetry of the geometry relative to $\\mathbf{s}_{0}$, we have $w_{1} = w_{2} = w$. Let $w_{3} = v$. The system reduces to\n$$\n\\begin{aligned}\n\\gamma_{70}\\, w + \\gamma_{50}\\, v + \\mu \\;=\\; \\gamma_{50}, \\\\\n2\\,\\gamma_{50}\\, w + \\mu \\;=\\; \\gamma_{70}, \\\\\n2w + v \\;=\\; 1.\n\\end{aligned}\n$$\nSubtracting the second equation from the first eliminates $\\mu$:\n$$\n\\left(\\gamma_{70} - 2\\gamma_{50}\\right) w + \\gamma_{50}\\, v \\;=\\; \\gamma_{50} - \\gamma_{70}.\n$$\nUsing $v = 1 - 2w$ from the constraint, we obtain\n$$\n\\left(\\gamma_{70} - 2\\gamma_{50}\\right) w + \\gamma_{50} (1 - 2w) \\;=\\; \\gamma_{50} - \\gamma_{70},\n$$\nwhich simplifies to\n$$\n\\left(\\gamma_{70} - 2\\gamma_{50} - 2\\gamma_{50}\\right) w + \\gamma_{50} \\;=\\; \\gamma_{50} - \\gamma_{70},\n$$\n$$\n\\left(\\gamma_{70} - 4\\gamma_{50}\\right) w \\;=\\; -\\gamma_{70}.\n$$\nEquivalently (retaining the earlier aggregated coefficients),\n$$\n-2.37159897\\, w \\;\\approx\\; -0.956883266 \\quad\\Rightarrow\\quad w \\;\\approx\\; 0.403477.\n$$\nThen\n$$\nv \\;=\\; 1 - 2w \\;\\approx\\; 1 - 0.806954 \\;\\approx\\; 0.193046.\n$$\nThe ordinary kriging estimate is\n$$\n\\hat{Z}(\\mathbf{s}_{0}) \\;=\\; w\\, Z(\\mathbf{s}_{1}) + w\\, Z(\\mathbf{s}_{2}) + v\\, Z(\\mathbf{s}_{3})\n\\;=\\; w\\,(12 + 10) + v\\,(15)\n\\;=\\; 22w + 15v.\n$$\nNumerically,\n$$\n22w \\;\\approx\\; 22 \\times 0.403477 \\;\\approx\\; 8.876494, \\quad 15v \\;\\approx\\; 15 \\times 0.193046 \\;\\approx\\; 2.895690,\n$$\nso\n$$\n\\hat{Z}(\\mathbf{s}_{0}) \\;\\approx\\; 8.876494 + 2.895690 \\;\\approx\\; 11.772184\\,\\mathrm{mg\\,m^{-3}}.\n$$\nRounded to four significant figures and expressed in $\\mathrm{mg\\,m^{-3}}$, the ordinary kriging estimate is $11.77\\,\\mathrm{mg\\,m^{-3}}$.",
            "answer": "$$\\boxed{11.77}$$"
        },
        {
            "introduction": "A geostatistical model is only as good as its predictive performance. This hands-on practice moves beyond simple estimation to the critical task of model validation using Leave-One-Out Cross-Validation (LOOCV). By systematically removing one data point and predicting its value with the remaining data, you will learn how to assess the accuracy and reliability of your chosen variogram model and kriging setup. Calculating the Mean Squared Standardized Error (MSSE) provides a powerful diagnostic for evaluating whether the model's predicted uncertainty matches the observed errors .",
            "id": "3817496",
            "problem": "A remote sensing team uses Synthetic Aperture Radar (SAR) to estimate surface soil moisture fraction over a small agricultural field. Three ground validation sites are arranged in an equilateral triangle with side length $1$ $\\mathrm{km}$ at coordinates $\\left(0,0\\right)$, $\\left(1,0\\right)$, and $\\left(\\frac{1}{2},\\frac{\\sqrt{3}}{2}\\right)$, with measured soil moisture fractions $\\left(z_{1},z_{2},z_{3}\\right)=\\left(0.32,0.40,0.28\\right)$. Assume the soil moisture is a second-order stationary Gaussian random field with isotropic exponential covariance function $C\\!\\left(h\\right)=\\sigma^{2}\\exp\\!\\left(-\\frac{h}{\\phi}\\right)$, zero nugget effect, partial sill $\\sigma^{2}=0.02$, and range parameter $\\phi=1$ $\\mathrm{km}$. \n\nUsing ordinary kriging (unknown constant mean), conduct leave-one-out cross-validation (LOOCV) at each site: when predicting at location $\\mathbf{x}_{i}$, use only the remaining two points as the training set. Starting solely from the definition of ordinary kriging as the best linear unbiased estimator and the principle of variance minimization under the unbiasedness constraint, derive the ordinary kriging system, determine the weights for each LOOCV prediction, derive the corresponding kriging variance at the LOOCV target, and compute the Mean Squared Standardized Error (MSSE)\n$$\n\\mathrm{MSSE}=\\frac{1}{n}\\sum_{i=1}^{n}\\frac{\\left(z_{i}-\\hat{z}_{-i}\\right)^{2}}{\\sigma_{K,-i}^{2}},\n$$\nwhere $n=3$, $\\hat{z}_{-i}$ is the LOOCV ordinary kriging prediction at $\\mathbf{x}_{i}$ using the other two points, and $\\sigma_{K,-i}^{2}$ is the associated LOOCV ordinary kriging variance. Round your final MSSE to four significant figures and express it as a unitless decimal.",
            "solution": "The task is to compute the Mean Squared Standardized Error (MSSE) from a leave-one-out cross-validation (LOOCV) procedure using ordinary kriging. We begin by deriving the ordinary kriging system from first principles.\n\nLet the random field be $Z(\\mathbf{x})$, which is assumed to be second-order stationary with a constant but unknown mean $E[Z(\\mathbf{x})] = \\mu$ and a known covariance function $\\mathrm{Cov}(Z(\\mathbf{x}), Z(\\mathbf{y})) = C(\\mathbf{x}-\\mathbf{y})$.\nThe objective is to predict the value $Z(\\mathbf{x}_0)$ at a location $\\mathbf{x}_0$ using a linear combination of observed values $z_i = Z(\\mathbf{x}_i)$ at $N$ locations $\\mathbf{x}_1, \\dots, \\mathbf{x}_N$. The estimator is\n$$\n\\hat{Z}(\\mathbf{x}_0) = \\sum_{i=1}^N w_i z_i\n$$\nwhere $w_i$ are the weights to be determined.\n\nFor the estimator to be unbiased, i.e., $E[\\hat{Z}(\\mathbf{x}_0) - Z(\\mathbf{x}_0)] = 0$, we require:\n$$\nE[\\hat{Z}(\\mathbf{x}_0)] = E\\left[\\sum_{i=1}^N w_i Z(\\mathbf{x}_i)\\right] = \\sum_{i=1}^N w_i E[Z(\\mathbf{x}_i)] = \\mu \\sum_{i=1}^N w_i\n$$\nSince $E[Z(\\mathbf{x}_0)] = \\mu$, the unbiasedness condition demands that $\\mu \\sum_{i=1}^N w_i = \\mu$. As this must hold for any value of the unknown mean $\\mu$, we must impose the constraint:\n$$\n\\sum_{i=1}^N w_i = 1\n$$\nThe kriging method determines the weights by minimizing the estimation variance, $\\sigma_K^2 = E[(\\hat{Z}(\\mathbf{x}_0) - Z(\\mathbf{x}_0))^2]$, subject to this unbiasedness constraint. The estimation variance can be expanded as:\n$$\n\\sigma_K^2 = \\mathrm{Var}(\\hat{Z}(\\mathbf{x}_0) - Z(\\mathbf{x}_0)) = \\mathrm{Cov}\\left(\\sum_i w_i Z_i - Z_0, \\sum_j w_j Z_j - Z_0\\right)\n$$\n$$\n\\sigma_K^2 = \\sum_{i=1}^N \\sum_{j=1}^N w_i w_j C_{ij} - 2\\sum_{i=1}^N w_i C_{i0} + C_{00}\n$$\nwhere $Z_i = Z(\\mathbf{x}_i)$, $C_{ij} = \\mathrm{Cov}(Z_i, Z_j)$, $C_{i0} = \\mathrm{Cov}(Z_i, Z_0)$, and $C_{00} = \\mathrm{Var}(Z_0)$.\n\nTo solve this constrained minimization problem, we use the method of Lagrange multipliers. We define the Lagrangian $\\mathcal{L}$:\n$$\n\\mathcal{L}(\\mathbf{w}, \\lambda) = \\sum_{i=1}^N \\sum_{j=1}^N w_i w_j C_{ij} - 2\\sum_{i=1}^N w_i C_{i0} + C_{00} - 2\\lambda\\left(\\sum_{i=1}^N w_i - 1\\right)\n$$\nSetting the partial derivatives with respect to each weight $w_k$ to zero gives:\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial w_k} = 2\\sum_{i=1}^N w_i C_{ik} - 2C_{k0} - 2\\lambda = 0 \\implies \\sum_{i=1}^N w_i C_{ik} - \\lambda = C_{k0} \\quad (k=1, \\dots, N)\n$$\nThe derivative with respect to $\\lambda$ recovers the constraint $\\sum w_i = 1$. The resulting set of $N+1$ linear equations forms the ordinary kriging system, which in matrix form is:\n$$\n\\begin{pmatrix}\nC_{11}  \\cdots  C_{1N}  1 \\\\\n\\vdots  \\ddots  \\vdots  \\vdots \\\\\nC_{N1}  \\cdots  C_{NN}  1 \\\\\n1  \\cdots  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\nw_1 \\\\\n\\vdots \\\\\nw_N \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nC_{10} \\\\\n\\vdots \\\\\nC_{N0} \\\\\n1\n\\end{pmatrix}\n$$\nThe minimized kriging variance is given by $\\sigma_K^2 = C_{00} - \\sum_{i=1}^N w_i C_{i0} - \\lambda$.\n\nNow, we apply this framework to the specific problem. The coordinates are $\\mathbf{x}_1=(0,0)$, $\\mathbf{x}_2=(1,0)$, and $\\mathbf{x}_3=(\\frac{1}{2},\\frac{\\sqrt{3}}{2})$. The distance between any two of these points is $1$ $\\mathrm{km}$. The isotropic exponential covariance function is $C(h) = \\sigma^2 \\exp(-h/\\phi)$, with partial sill $\\sigma^2 = 0.02$ and range $\\phi = 1$ $\\mathrm{km}$. Thus, $C(h) = 0.02 \\exp(-h)$.\nThe variance of the field is $C(0) = 0.02$. The covariance between any two of the three sites is $C(1) = 0.02 \\exp(-1)$. Let's denote these as $C_0 = 0.02$ and $C_1 = 0.02e^{-1}$.\n\nWe perform leave-one-out cross-validation for each of the $n=3$ sites. Due to the equilateral geometry, the setup for each LOOCV prediction is identical. For instance, when predicting at $\\mathbf{x}_1$ (the target, $\\mathbf{x}_0$) using data from $\\mathbf{x}_2$ and $\\mathbf{x}_3$ ($N=2$), the kriging system is:\n$$\n\\begin{pmatrix}\nC(\\mathbf{x}_2, \\mathbf{x}_2)  C(\\mathbf{x}_2, \\mathbf{x}_3)  1 \\\\\nC(\\mathbf{x}_3, \\mathbf{x}_2)  C(\\mathbf{x}_3, \\mathbf{x}_3)  1 \\\\\n1  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\nw_2 \\\\\nw_3 \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nC(\\mathbf{x}_2, \\mathbf{x}_1) \\\\\nC(\\mathbf{x}_3, \\mathbf{x}_1) \\\\\n1\n\\end{pmatrix}\n$$\nThe distances are all $h=1$ $\\mathrm{km}$ for pairs of distinct points. Therefore, $C(\\mathbf{x}_i, \\mathbf{x}_i) = C_0$ and $C(\\mathbf{x}_i, \\mathbf{x}_j) = C_1$ for $i \\neq j$. The system becomes:\n$$\n\\begin{pmatrix}\nC_0  C_1  1 \\\\\nC_1  C_0  1 \\\\\n1  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\nw_2 \\\\\nw_3 \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nC_1 \\\\\nC_1 \\\\\n1\n\\end{pmatrix}\n$$\nThis yields three equations:\n1. $w_2 C_0 + w_3 C_1 + \\lambda = C_1$\n2. $w_2 C_1 + w_3 C_0 + \\lambda = C_1$\n3. $w_2 + w_3 = 1$\n\nSubtracting the second equation from the first yields $w_2(C_0 - C_1) - w_3(C_0 - C_1) = 0$. Since $C_0 \\neq C_1$, we can divide by $(C_0 - C_1)$ to get $w_2 = w_3$. Substituting this into the third equation gives $2w_2 = 1$, so $w_2 = w_3 = 0.5$.\nDue to symmetry, for any LOOCV prediction, the two available data points will always receive a weight of $0.5$.\n\nThe kriging variance $\\sigma_{K,-i}^2$ will also be the same for each LOOCV fold. Let's calculate it for the prediction at $\\mathbf{x}_1$:\n$$ \\sigma_{K,-1}^2 = C(\\mathbf{x}_1, \\mathbf{x}_1) - (w_2 C(\\mathbf{x}_2, \\mathbf{x}_1) + w_3 C(\\mathbf{x}_3, \\mathbf{x}_1)) - \\lambda $$\nTo find $\\lambda$, we use the first equation: $0.5 C_0 + 0.5 C_1 + \\lambda = C_1 \\implies \\lambda = 0.5 C_1 - 0.5 C_0$.\n$$ \\sigma_{K,-1}^2 = C_0 - (0.5 C_1 + 0.5 C_1) - (0.5 C_1 - 0.5 C_0) = C_0 - C_1 - 0.5 C_1 + 0.5 C_0 $$\n$$ \\sigma_{K,-1}^2 = 1.5 C_0 - 1.5 C_1 = 1.5(C_0 - C_1) $$\nSubstituting the values $C_0 = 0.02$ and $C_1 = 0.02e^{-1}$:\n$$ \\sigma_{K,-1}^2 = 1.5(0.02 - 0.02e^{-1}) = 0.03(1 - e^{-1}) $$\nThis constant kriging variance is denoted $\\sigma_{K}^2$ for all three folds.\n\nNow we compute the LOOCV predictions and errors:\nThe measured values are $(z_1, z_2, z_3) = (0.32, 0.40, 0.28)$.\n1.  Prediction at $\\mathbf{x}_1$: $\\hat{z}_{-1} = 0.5 z_2 + 0.5 z_3 = 0.5(0.40 + 0.28) = 0.34$.\n    Squared error: $(z_1 - \\hat{z}_{-1})^2 = (0.32 - 0.34)^2 = (-0.02)^2 = 0.0004$.\n2.  Prediction at $\\mathbf{x}_2$: $\\hat{z}_{-2} = 0.5 z_1 + 0.5 z_3 = 0.5(0.32 + 0.28) = 0.30$.\n    Squared error: $(z_2 - \\hat{z}_{-2})^2 = (0.40 - 0.30)^2 = (0.10)^2 = 0.01$.\n3.  Prediction at $\\mathbf{x}_3$: $\\hat{z}_{-3} = 0.5 z_1 + 0.5 z_2 = 0.5(0.32 + 0.40) = 0.36$.\n    Squared error: $(z_3 - \\hat{z}_{-3})^2 = (0.28 - 0.36)^2 = (-0.08)^2 = 0.0064$.\n\nFinally, we compute the Mean Squared Standardized Error (MSSE):\n$$ \\mathrm{MSSE} = \\frac{1}{n}\\sum_{i=1}^{n}\\frac{(z_i - \\hat{z}_{-i})^2}{\\sigma_{K,-i}^2} $$\nSince $n=3$ and $\\sigma_{K,-i}^2 = \\sigma_{K}^2 = 0.03(1 - e^{-1})$ for all $i$:\n$$ \\mathrm{MSSE} = \\frac{1}{3 \\sigma_{K}^2} \\sum_{i=1}^3 (z_i - \\hat{z}_{-i})^2 $$\nThe sum of squared errors is $0.0004 + 0.01 + 0.0064 = 0.0168$.\n$$ \\mathrm{MSSE} = \\frac{0.0168}{3 \\times 0.03(1 - e^{-1})} = \\frac{0.0168}{0.09(1 - e^{-1})} $$\nNumerically evaluating this expression:\n$$ \\mathrm{MSSE} = \\frac{0.0168}{0.09 \\times (1 - \\exp(-1))} \\approx \\frac{0.0168}{0.09 \\times (1 - 0.367879)} = \\frac{0.0168}{0.09 \\times 0.632121} \\approx \\frac{0.0168}{0.0568909} \\approx 0.295311 $$\nRounding to four significant figures, we get $0.2953$.",
            "answer": "$$\n\\boxed{0.2953}\n$$"
        }
    ]
}