{
    "hands_on_practices": [
        {
            "introduction": "环境模型中的许多物理参数，例如物质浓度或丰度，都必须是严格为正的。本练习  演示了一种在贝叶斯最大后验 (MAP) 估计框架内处理此类正定约束的基本技术。通过应用对数变换，我们将一个有约束的优化问题转化为一个无约束的问题，从而允许使用标准的基于梯度的算法，同时确保结果具有物理意义。",
            "id": "3831139",
            "problem": "一台高光谱成像光谱仪在植被覆盖的地表上采集了 $m$ 个波长的辐射率测量值。一个简化的线性化正向模型通过一个已知的灵敏度矩阵 $G \\in \\mathbb{R}^{m \\times n}$，将测量到的辐射率向量 $y \\in \\mathbb{R}^{m}$ 与一组 $n$ 个严格为正的生物物理参数 $\\theta \\in \\mathbb{R}_{>0}^{n}$（例如，辐射传输基函数的非负丰度类缩放系数）关联起来，其中包含附加的、独立的高斯测量误差。具体来说，数据模型是条件分布 $y \\,|\\, \\theta \\sim \\mathcal{N}(G \\theta, \\sigma^{2} I_{m})$，其中 $\\mathcal{N}(\\mu, \\Sigma)$ 表示均值为 $\\mu$、协方差为 $\\Sigma$ 的多元正态分布，$\\sigma^{2} > 0$ 是已知的噪声方差，$I_{m}$ 是 $m \\times m$ 的单位矩阵。为了编码物理正定性和先验知识，假设 $\\theta$ 的各分量是先验独立的，并且服从形状参数为 $k_{i} > 0$、率参数为 $\\lambda_{i} > 0$ 的伽马分布，即对于每个 $i \\in \\{1,\\dots,n\\}$，有 $\\theta_{i} \\sim \\mathrm{Gamma}(k_{i}, \\lambda_{i})$，其密度函数为 $p(\\theta_{i}) = \\frac{\\lambda_{i}^{k_{i}}}{\\Gamma(k_{i})} \\theta_{i}^{k_{i}-1} \\exp(-\\lambda_{i} \\theta_{i})$（对于 $\\theta_{i} > 0$），其中 $\\Gamma(\\cdot)$ 是伽马函数。\n\n根据贝叶斯定理，后验密度满足 $p(\\theta \\,|\\, y) \\propto p(y \\,|\\, \\theta) \\, p(\\theta)$。考虑在无约束空间中进行最大后验（MAP）估计，方法是引入对数变换 $\\phi \\in \\mathbb{R}^{n}$，其按分量定义为 $\\phi_{i} = \\ln(\\theta_{i})$（对于 $i = 1,\\dots,n$），因此 $\\theta = \\exp(\\phi)$，其中指数函数是逐元素应用的。将 $\\phi$ 视为优化变量，并使用密度的变量替换法则，根据 $p(\\theta \\,|\\, y)$ 和变换的雅可比行列式来写出后验密度 $p(\\phi \\,|\\, y)$。\n\n推导并简化需要关于 $\\phi$ 最小化的负对数后验目标函数 $J_{\\phi}(\\phi)$，该函数完全用 $\\phi$、$y$、$G$、$\\sigma^{2}$、$k_{i}$ 和 $\\lambda_{i}$ 表示。忽略不依赖于 $\\phi$ 的加法常数。你的最终答案必须是单一的闭式解析表达式。不需要数值近似。",
            "solution": "### 目标函数的推导\n目标是在变换空间中找到参数的最大后验（MAP）估计，这等同于最小化负对数后验密度。我们将推导这个目标函数 $J_{\\phi}(\\phi)$。\n\n首先，我们使用贝叶斯定理建立 $\\theta$ 的后验概率密度：\n$$\np(\\theta \\,|\\, y) \\propto p(y \\,|\\, \\theta) p(\\theta)\n$$\n似然项 $p(y \\,|\\, \\theta)$ 由多元正态分布 $y \\,|\\, \\theta \\sim \\mathcal{N}(G \\theta, \\sigma^{2} I_{m})$ 给出。其概率密度函数为：\n$$\np(y \\,|\\, \\theta) = \\frac{1}{(2\\pi\\sigma^{2})^{m/2}} \\exp\\left(-\\frac{1}{2\\sigma^{2}} (y - G\\theta)^{T}(y - G\\theta)\\right) = \\frac{1}{(2\\pi\\sigma^{2})^{m/2}} \\exp\\left(-\\frac{1}{2\\sigma^{2}} \\|y - G\\theta\\|_2^2\\right)\n$$\n忽略与 $\\theta$ 无关的归一化常数，我们有：\n$$\np(y \\,|\\, \\theta) \\propto \\exp\\left(-\\frac{1}{2\\sigma^{2}} \\|y - G\\theta\\|_2^2\\right)\n$$\n先验项 $p(\\theta)$ 由各分量 $\\theta_{i}$ 的独立伽马分布的乘积给出：\n$$\np(\\theta) = \\prod_{i=1}^{n} p(\\theta_{i}) = \\prod_{i=1}^{n} \\frac{\\lambda_{i}^{k_{i}}}{\\Gamma(k_{i})} \\theta_{i}^{k_{i}-1} \\exp(-\\lambda_{i} \\theta_{i})\n$$\n再次忽略归一化常数 $\\frac{\\lambda_{i}^{k_{i}}}{\\Gamma(k_{i})}$，我们得到：\n$$\np(\\theta) \\propto \\left( \\prod_{i=1}^{n} \\theta_{i}^{k_{i}-1} \\right) \\exp\\left(-\\sum_{i=1}^{n} \\lambda_{i} \\theta_{i}\\right)\n$$\n这可以重写为：\n$$\np(\\theta) \\propto \\exp\\left(\\sum_{i=1}^{n} (k_{i}-1)\\ln(\\theta_{i})\\right) \\exp\\left(-\\sum_{i=1}^{n} \\lambda_{i} \\theta_{i}\\right)\n$$\n结合似然和先验，$\\theta$ 的后验分布为：\n$$\np(\\theta \\,|\\, y) \\propto \\exp\\left(-\\frac{1}{2\\sigma^{2}} \\|y - G\\theta\\|_2^2 - \\sum_{i=1}^{n} \\lambda_{i} \\theta_{i} + \\sum_{i=1}^{n} (k_{i}-1)\\ln(\\theta_{i})\\right)\n$$\n接下来，我们进行从 $\\theta$ 到 $\\phi$ 的变量替换，其中 $\\phi_{i} = \\ln(\\theta_{i})$，或 $\\theta_{i} = \\exp(\\phi_{i})$。概率密度函数之间的关系如下：\n$$\np_{\\phi}(\\phi \\,|\\, y) = p_{\\theta}(\\theta(\\phi) \\,|\\, y) \\left| \\det\\left(J_{\\phi \\to \\theta}\\right) \\right|\n$$\n其中 $J_{\\phi \\to \\theta}$ 是从 $\\phi$ 到 $\\theta$ 变换的雅可比矩阵。该雅可比矩阵的元素为 $(J_{\\phi \\to \\theta})_{ij} = \\frac{\\partial \\theta_i}{\\partial \\phi_j}$。由于 $\\theta_i = \\exp(\\phi_i)$，该变换是逐分量的，因此雅可比矩阵是一个对角矩阵：\n$$\n\\frac{\\partial \\theta_i}{\\partial \\phi_j} = \\delta_{ij} \\frac{d}{d\\phi_i}(\\exp(\\phi_i)) = \\delta_{ij} \\exp(\\phi_i)\n$$\n其中 $\\delta_{ij}$ 是克罗内克δ。雅可比矩阵为：\n$$\nJ_{\\phi \\to \\theta} = \\mathrm{diag}(\\exp(\\phi_1), \\exp(\\phi_2), \\dots, \\exp(\\phi_n))\n$$\n其行列式是对角元素的乘积：\n$$\n\\det(J_{\\phi \\to \\theta}) = \\prod_{i=1}^{n} \\exp(\\phi_i) = \\exp\\left(\\sum_{i=1}^{n} \\phi_i\\right)\n$$\n由于 $\\exp(\\phi_i) > 0$，绝对值是多余的。\n\n现在，我们可以写出 $\\phi$ 的后验分布。我们将 $\\theta = \\exp(\\phi)$ 代入 $p(\\theta \\,|\\, y)$ 的表达式中，并乘以雅可比行列式。\n$$\np_{\\phi}(\\phi \\,|\\, y) \\propto \\exp\\left(-\\frac{1}{2\\sigma^{2}} \\|y - G\\exp(\\phi)\\|_2^2 - \\sum_{i=1}^{n} \\lambda_{i} \\exp(\\phi_{i}) + \\sum_{i=1}^{n} (k_{i}-1)\\ln(\\exp(\\phi_{i}))\\right) \\cdot \\exp\\left(\\sum_{i=1}^{n} \\phi_i\\right)\n$$\n使用 $\\ln(\\exp(\\phi_{i})) = \\phi_i$ 并合并指数中的所有项：\n$$\np_{\\phi}(\\phi \\,|\\, y) \\propto \\exp\\left(-\\frac{1}{2\\sigma^{2}} \\|y - G\\exp(\\phi)\\|_2^2 - \\sum_{i=1}^{n} \\lambda_{i} \\exp(\\phi_{i}) + \\sum_{i=1}^{n} (k_{i}-1)\\phi_{i} + \\sum_{i=1}^{n} \\phi_i\\right)\n$$\n简化关于 $\\phi_i$ 项的求和：\n$$\n\\sum_{i=1}^{n} (k_{i}-1)\\phi_{i} + \\sum_{i=1}^{n} \\phi_i = \\sum_{i=1}^{n} (k_{i}-1+1)\\phi_{i} = \\sum_{i=1}^{n} k_{i}\\phi_{i}\n$$\n因此，$\\phi$ 的后验分布为：\n$$\np_{\\phi}(\\phi \\,|\\, y) \\propto \\exp\\left(-\\frac{1}{2\\sigma^{2}} \\|y - G\\exp(\\phi)\\|_2^2 - \\sum_{i=1}^{n} \\lambda_{i} \\exp(\\phi_{i}) + \\sum_{i=1}^{n} k_{i}\\phi_{i}\\right)\n$$\n对数后验是此表达式的自然对数：\n$$\n\\ln(p_{\\phi}(\\phi \\,|\\, y)) = C - \\frac{1}{2\\sigma^{2}} \\|y - G\\exp(\\phi)\\|_2^2 - \\sum_{i=1}^{n} \\lambda_{i} \\exp(\\phi_{i}) + \\sum_{i=1}^{n} k_{i}\\phi_{i}\n$$\n其中 $C$ 是一个不依赖于 $\\phi$ 的常数。\n\n需要最小化的目标函数 $J_{\\phi}(\\phi)$ 是负对数后验。我们可以忽略加法常数 $C$：\n$$\nJ_{\\phi}(\\phi) = - \\left( \\ln(p_{\\phi}(\\phi \\,|\\, y)) - C \\right)\n$$\n$$\nJ_{\\phi}(\\phi) = \\frac{1}{2\\sigma^{2}} \\|y - G\\exp(\\phi)\\|_2^2 + \\sum_{i=1}^{n} \\lambda_{i} \\exp(\\phi_{i}) - \\sum_{i=1}^{n} k_{i}\\phi_{i}\n$$\n此表达式是最终简化的负对数后验目标函数，完全用所需变量表示。向量 $\\exp(\\phi)$ 按分量定义为 $(\\exp(\\phi))_i = \\exp(\\phi_i)$。",
            "answer": "$$ \\boxed{ \\frac{1}{2\\sigma^{2}} \\|y - G\\exp(\\phi)\\|_2^2 + \\sum_{i=1}^{n} \\lambda_{i} \\exp(\\phi_{i}) - \\sum_{i=1}^{n} k_{i}\\phi_{i} } $$"
        },
        {
            "introduction": "在为模型找到最优参数后，关键的下一步是评估模型与观测数据的拟合程度。本练习  介绍了用于评估参数估计中拟合优度的关键指标——约化卡方统计量 ($\\chi^2_\\nu$)。你将从第一性原理出发推导该统计量，并应用它来量化模型预测与测量值之间的差异，同时考虑到测量噪声和拟合参数的数量。",
            "id": "3831121",
            "problem": "在基于卫星的遥感地表属性反演中，假设一个正演模型通过一个可微函数 $f(x)$ 将一个标量大气参数 $x$（例如，气溶胶光学厚度）映射到 $n$ 个多光谱反射率观测值，并且测量误差是加性的、零均值的，并服从协方差矩阵为 $\\Sigma \\in \\mathbb{R}^{n \\times n}$ 的多变量高斯分布。参数 $x$ 通过最小化负对数似然（等价于广义最小二乘法 (GLS)）进行估计，得到一个估计值 $\\hat{x}$ 和一个残差向量 $r = y - f(\\hat{x})$，其中 $y \\in \\mathbb{R}^{n}$ 是观测到的反射率向量。\n\n从多变量正态密度的基本定义和最大似然估计 (MLE) 的概念出发，推导出一个拟合优度统计量，该统计量是在可用自由度上对归一化残差平方进行平均。明确指出观测数量 $n$ 和拟合参数数量 $p$ 在此统计量中的作用，并说明当模型和噪声协方差被正确指定时，其期望大小的解释。\n\n然后，对于一个具有 $n = 3$ 个通道和 $p = 1$ 个拟合参数的具体反演，假设残差向量和协方差矩阵为\n$$\nr = \\begin{pmatrix} 3 \\\\ -3 \\\\ 6 \\end{pmatrix}, \n\\quad\n\\Sigma = \\begin{pmatrix}\n4  2  0 \\\\\n2  4  0 \\\\\n0  0  9\n\\end{pmatrix}.\n$$\n计算您推导出的拟合优度统计量。将您的最终值表示为一个无单位的量，并将答案四舍五入到 $4$ 位有效数字。",
            "solution": "### 推导与计算\n\n**拟合优度统计量的推导**\n测量模型指出，观测向量 $y$ 通过 $y = f(x) + \\epsilon$ 与参数 $x$ 相关，其中误差项 $\\epsilon$ 服从均值为零、协方差矩阵为 $\\Sigma$ 的多变量正态分布。这表示为 $\\epsilon \\sim \\mathcal{N}(0, \\Sigma)$。因此，对于给定的 $x$，观测向量 $y$ 也服从正态分布：$y \\sim \\mathcal{N}(f(x), \\Sigma)$。\n\n给定参数 $x$ 时，观测向量 $y$ 的概率密度函数 (PDF) 为：\n$$\np(y|x) = \\frac{1}{\\sqrt{(2\\pi)^n \\det(\\Sigma)}} \\exp\\left(-\\frac{1}{2} (y - f(x))^T \\Sigma^{-1} (y - f(x))\\right)\n$$\n对数似然函数 $L(x|y) = \\ln(p(y|x))$ 为：\n$$\nL(x|y) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\det(\\Sigma)) - \\frac{1}{2} (y - f(x))^T \\Sigma^{-1} (y - f(x))\n$$\n最大似然估计 (MLE) 旨在寻找使 $L(x|y)$ 最大化的 $x$ 值。这等价于最小化负对数似然 $-L(x|y)$。由于前两项相对于 $x$ 是常数，这等价于最小化指数中的二次型：\n$$\n\\min_{x} \\left\\{ (y - f(x))^T \\Sigma^{-1} (y - f(x)) \\right\\}\n$$\n这个最小化问题被称为广义最小二乘法 (GLS)。被最小化的量是归一化残差的平方和，通常表示为卡方 ($\\chi^2$) 代价函数。\n\n设 $\\hat{x}$ 是最小化此代价函数的 $x$ 的估计值。解处的残差向量为 $r = y - f(\\hat{x})$。代价函数的最小值为：\n$$\n\\chi^2 = r^T \\Sigma^{-1} r\n$$\n这个标量值是模型与数据之间总失配度的一个度量，由测量不确定性加权。如果模型 $f(x)$ 是正确的，且协方差矩阵 $\\Sigma$ 被准确指定，则统计量 $\\chi^2$ 服从卡方分布。该分布的自由度 $\\nu$ 是观测数量 $n$ 减去被估计的参数数量 $p$。因此，$\\nu = n - p$。\n\n将这个总平方误差在可用自由度上进行平均的拟合优度统计量是约化卡方统计量，表示为 $\\chi^2_\\nu$ 或 $\\chi^2_\\text{red}$：\n$$\n\\chi^2_\\nu = \\frac{\\chi^2}{\\nu} = \\frac{r^T \\Sigma^{-1} r}{n - p}\n$$\n这就是所求的统计量。\n\n**$n$ 和 $p$ 的作用及解释**\n- $n$：用于拟合的观测或数据点的数量。\n- $p$：模型中为拟合数据而调整的参数数量。\n- 差值 $\\nu = n - p$ 代表拟合的自由度。它是在 $p$ 个参数被数据约束后，用于评估拟合质量的剩余独立数据点的数量。\n\n自由度为 $\\nu$ 的卡方分布的期望值为 $E[\\chi^2] = \\nu$。因此，约化卡方统计量的期望值为：\n$$\nE[\\chi^2_\\nu] = E\\left[\\frac{\\chi^2}{\\nu}\\right] = \\frac{E[\\chi^2]}{\\nu} = \\frac{\\nu}{\\nu} = 1\n$$\n- **解释：** 如果模型是正确的，并且误差协方差 $\\Sigma$ 被恰当估计，那么拟合优度统计量 $\\chi^2_\\nu$ 的值预计会接近 $1$。一个显著大于 $1$ 的值表明模型拟合不佳或测量误差被低估。一个显著小于 $1$ 的值可能表明数据过拟合（即，对于数据的噪声水平而言，模型过于复杂）或测量误差被高估。\n\n**具体案例的计算**\n我们已知：\n- $n = 3$，$p = 1$。自由度为 $\\nu = n - p = 3 - 1 = 2$。\n- $r = \\begin{pmatrix} 3 \\\\ -3 \\\\ 6 \\end{pmatrix}$。\n- $\\Sigma = \\begin{pmatrix} 4  2  0 \\\\ 2  4  0 \\\\ 0  0  9 \\end{pmatrix}$。\n\n首先，我们必须计算协方差矩阵的逆矩阵 $\\Sigma^{-1}$。矩阵 $\\Sigma$ 是块对角矩阵。设左上角的 $2 \\times 2$ 块为 $A = \\begin{pmatrix} 4  2 \\\\ 2  4 \\end{pmatrix}$。其逆矩阵为：\n$$\nA^{-1} = \\frac{1}{\\det(A)} \\begin{pmatrix} 4  -2 \\\\ -2  4 \\end{pmatrix} = \\frac{1}{4 \\times 4 - 2 \\times 2} \\begin{pmatrix} 4  -2 \\\\ -2  4 \\end{pmatrix} = \\frac{1}{12} \\begin{pmatrix} 4  -2 \\\\ -2  4 \\end{pmatrix} = \\begin{pmatrix} 1/3  -1/6 \\\\ -1/6  1/3 \\end{pmatrix}\n$$\n右下角的块是标量 $9$，所以其逆是 $1/9$。因此，$\\Sigma$ 的逆矩阵是：\n$$\n\\Sigma^{-1} = \\begin{pmatrix}\n1/3  -1/6  0 \\\\\n-1/6  1/3  0 \\\\\n0  0  1/9\n\\end{pmatrix}\n$$\n现在，我们计算 $\\chi^2$ 统计量，$\\chi^2 = r^T \\Sigma^{-1} r$：\n$$\n\\chi^2 = \\begin{pmatrix} 3  -3  6 \\end{pmatrix} \\begin{pmatrix}\n1/3  -1/6  0 \\\\\n-1/6  1/3  0 \\\\\n0  0  1/9\n\\end{pmatrix} \\begin{pmatrix} 3 \\\\ -3 \\\\ 6 \\end{pmatrix}\n$$\n首先，计算乘积 $r^T \\Sigma^{-1}$：\n$$\nr^T \\Sigma^{-1} = \\begin{pmatrix} (3)(\\frac{1}{3}) + (-3)(-\\frac{1}{6})  (3)(-\\frac{1}{6}) + (-3)(\\frac{1}{3})  (6)(\\frac{1}{9}) \\end{pmatrix}\n$$\n$$\nr^T \\Sigma^{-1} = \\begin{pmatrix} 1 + \\frac{1}{2}  -\\frac{1}{2} - 1  \\frac{6}{9} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2}  -\\frac{3}{2}  \\frac{2}{3} \\end{pmatrix}\n$$\n接下来，将此结果乘以 $r$：\n$$\n\\chi^2 = (r^T \\Sigma^{-1}) r = \\begin{pmatrix} \\frac{3}{2}  -\\frac{3}{2}  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} 3 \\\\ -3 \\\\ 6 \\end{pmatrix}\n$$\n$$\n\\chi^2 = \\left(\\frac{3}{2}\\right)(3) + \\left(-\\frac{3}{2}\\right)(-3) + \\left(\\frac{2}{3}\\right)(6) = \\frac{9}{2} + \\frac{9}{2} + \\frac{12}{3} = 9 + 4 = 13\n$$\n最后，我们通过除以自由度 $\\nu = 2$ 来计算拟合优度统计量 $\\chi^2_\\nu$：\n$$\n\\chi^2_\\nu = \\frac{\\chi^2}{\\nu} = \\frac{13}{2} = 6.5\n$$\n问题要求答案四舍五入到 $4$ 位有效数字。\n$$\n\\chi^2_\\nu = 6.500\n$$\n这个值显著大于 $1$，表明模型对数据的拟合不佳，或者假定的测量误差被低估了。",
            "answer": "$$\\boxed{6.500}$$"
        },
        {
            "introduction": "如果没有对其不确定性的度量，参数估计值的用处是有限的。本练习  深入探讨了如何使用拉普拉斯近似——一种贝叶斯分析中的强大方法——来量化最大后验 (MAP) 估计的不确定性。你将计算近似的后验协方差矩阵，它不仅揭示了每个估计参数的方差，还揭示了它们之间的相关性，从而为解的稳定性和可靠性提供了一幅全面的图景。",
            "id": "3831132",
            "problem": "一个多光谱卫星传感器被用于从三个冠层顶反射率测量值 $y \\in \\mathbb{R}^{3}$ 中推断两个无量纲地表参数 $x \\in \\mathbb{R}^{2}$，这两个参数分别代表归一化叶片生化指数和归一化土壤湿度指数。在最大后验（MAP）点附近，辐射传输正演模型被线性化，使得数据失配由在 MAP 点处计算的雅可比矩阵 $J \\in \\mathbb{R}^{3 \\times 2}$ 控制。假设测量噪声是均值为零、协方差为 $\\Sigma \\in \\mathbb{R}^{3 \\times 3}$ 的高斯噪声，且 $x$ 的先验是均值为零、协方差为 $\\Gamma \\in \\mathbb{R}^{2 \\times 2}$ 的高斯分布。所有量均为无量纲。\n\n矩阵如下：\n$$\nJ \\;=\\; \\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n1  1\n\\end{pmatrix}, \n\\qquad\n\\Sigma \\;=\\; \\begin{pmatrix}\n\\frac{1}{4}  0  0 \\\\\n0  \\frac{1}{9}  0 \\\\\n0  0  \\frac{1}{16}\n\\end{pmatrix},\n\\qquad\n\\Gamma \\;=\\; \\begin{pmatrix}\n\\frac{1}{2}  0 \\\\\n0  \\frac{1}{3}\n\\end{pmatrix}.\n$$\n\n使用由负对数后验的二阶泰勒展开和对数据失配海森矩阵的高斯-牛顿近似所得到的后验分布的标准高斯（拉普拉斯）近似，计算在最大后验（MAP）点处 $x$ 的近似后验协方差矩阵。将最终的协方差矩阵元素精确地表示为分数，不要四舍五入。由于所有量均为无量纲，答案中不要包含单位。最终答案必须是单一的矩阵表达式。",
            "solution": "用于参数估计的贝叶斯逆问题始于贝叶斯法则，该法则指出后验密度与似然和先验的乘积成正比。对于协方差为 $\\Sigma$ 的加性零均值高斯测量噪声和均值为零、协方差为 $\\Gamma$ 的高斯先验，负对数后验（不考虑与 $x$ 无关的加性常数）为\n$$\n\\Phi(x) \\;=\\; \\frac{1}{2}\\,\\|y - f(x)\\|_{\\Sigma^{-1}}^{2} \\;+\\; \\frac{1}{2}\\,\\|x\\|_{\\Gamma^{-1}}^{2},\n$$\n其中 $f(x)$ 是正演模型，且 $\\|v\\|_{A}^{2} \\equiv v^{\\top} A v$。在最大后验（MAP）点附近，我们将正演模型线性化为 $f(x) \\approx f(x_{\\text{MAP}}) + J (x - x_{\\text{MAP}})$，其中 $J$ 是在 MAP 点处的雅可比矩阵。在高斯-牛顿近似下，在 MAP 点处的负对数后验的海森矩阵近似为\n$$\nH_{\\text{GN}} \\;\\approx\\; J^{\\top} \\Sigma^{-1} J \\;+\\; \\Gamma^{-1}.\n$$\n那么，在 MAP 点附近的后验的拉普拉斯（高斯）近似为 $\\mathcal{N}(x_{\\text{MAP}}, \\Gamma_{\\text{post}})$，其协方差为\n$$\n\\Gamma_{\\text{post}} \\;\\approx\\; H_{\\text{GN}}^{-1} \\;=\\; \\left(J^{\\top} \\Sigma^{-1} J \\;+\\; \\Gamma^{-1}\\right)^{-1}.\n$$\n\n我们现在使用给定的矩阵计算 $J^{\\top} \\Sigma^{-1} J$ 和 $\\Gamma^{-1}$。首先，计算 $\\Sigma^{-1}$：\n$$\n\\Sigma \\;=\\; \\operatorname{diag}\\!\\left(\\frac{1}{4},\\, \\frac{1}{9},\\, \\frac{1}{16}\\right)\n\\;\\;\\Longrightarrow\\;\\;\n\\Sigma^{-1} \\;=\\; \\operatorname{diag}\\!\\left(4,\\, 9,\\, 16\\right).\n$$\n将 $J$ 的行写为\n$$\nr_{1} \\;=\\; \\begin{pmatrix} 1  0 \\end{pmatrix}, \n\\quad\nr_{2} \\;=\\; \\begin{pmatrix} 0  1 \\end{pmatrix},\n\\quad\nr_{3} \\;=\\; \\begin{pmatrix} 1  1 \\end{pmatrix}.\n$$\n则\n$$\nJ^{\\top} \\Sigma^{-1} J \n\\;=\\; \\sum_{i=1}^{3} w_{i}\\, r_{i}^{\\top} r_{i}\n\\quad\\text{其中}\\quad\n(w_{1}, w_{2}, w_{3}) \\;=\\; (4, 9, 16).\n$$\n计算每一项：\n$$\n4\\, r_{1}^{\\top} r_{1} \\;=\\; 4 \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} 4  0 \\\\ 0  0 \\end{pmatrix},\n$$\n$$\n9\\, r_{2}^{\\top} r_{2} \\;=\\; 9 \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} 0  0 \\\\ 0  9 \\end{pmatrix},\n$$\n$$\n16\\, r_{3}^{\\top} r_{3} \\;=\\; 16 \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} 16  16 \\\\ 16  16 \\end{pmatrix}.\n$$\n求和得到\n$$\nJ^{\\top} \\Sigma^{-1} J \n\\;=\\; \\begin{pmatrix} 4  0 \\\\ 0  0 \\end{pmatrix}\n\\;+\\; \\begin{pmatrix} 0  0 \\\\ 0  9 \\end{pmatrix}\n\\;+\\; \\begin{pmatrix} 16  16 \\\\ 16  16 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} 20  16 \\\\ 16  25 \\end{pmatrix}.\n$$\n\n接下来，计算 $\\Gamma^{-1}$。给定\n$$\n\\Gamma \\;=\\; \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{3} \\end{pmatrix},\n$$\n我们有\n$$\n\\Gamma^{-1} \\;=\\; \\begin{pmatrix} 2  0 \\\\ 0  3 \\end{pmatrix}.\n$$\n因此，\n$$\nH_{\\text{GN}} \\;=\\; J^{\\top} \\Sigma^{-1} J \\;+\\; \\Gamma^{-1}\n\\;=\\; \\begin{pmatrix} 20  16 \\\\ 16  25 \\end{pmatrix} \\;+\\; \\begin{pmatrix} 2  0 \\\\ 0  3 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} 22  16 \\\\ 16  28 \\end{pmatrix}.\n$$\n\n最后，对这个 $2 \\times 2$ 矩阵求逆以获得 $\\Gamma_{\\text{post}}$：\n$$\n\\Gamma_{\\text{post}} \\;\\approx\\; H_{\\text{GN}}^{-1}\n\\;=\\; \\left(\\begin{pmatrix} 22  16 \\\\ 16  28 \\end{pmatrix}\\right)^{-1}.\n$$\n对于一个对称的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ b  d \\end{pmatrix}$，其逆矩阵为 $\\frac{1}{ad - b^{2}} \\begin{pmatrix} d  -b \\\\ -b  a \\end{pmatrix}$。这里，$a \\,=\\, 22$，$b \\,=\\, 16$，$d \\,=\\, 28$，所以\n$$\n\\det(H_{\\text{GN}}) \\;=\\; 22 \\cdot 28 \\;-\\; 16^{2} \\;=\\; 616 \\;-\\; 256 \\;=\\; 360.\n$$\n因此，\n$$\n\\Gamma_{\\text{post}} \\;\\approx\\; \\frac{1}{360} \\begin{pmatrix} 28  -16 \\\\ -16  22 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} \\frac{28}{360}  -\\frac{16}{360} \\\\ -\\frac{16}{360}  \\frac{22}{360} \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} \\frac{7}{90}  -\\frac{2}{45} \\\\ -\\frac{2}{45}  \\frac{11}{180} \\end{pmatrix}.\n$$\n\n这就是在最大后验（MAP）估计点附近，采用拉普拉斯近似得到的近似后验协方差矩阵的精确分数形式。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{7}{90}  -\\frac{2}{45} \\\\ -\\frac{2}{45}  \\frac{11}{180} \\end{pmatrix}}$$"
        }
    ]
}