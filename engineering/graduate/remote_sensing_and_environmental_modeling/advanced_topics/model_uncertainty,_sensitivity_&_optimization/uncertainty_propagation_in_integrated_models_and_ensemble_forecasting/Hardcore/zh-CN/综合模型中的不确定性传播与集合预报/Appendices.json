{
    "hands_on_practices": [
        {
            "introduction": "在环境建模中，数据同化是将模型预测（先验）与卫星或现场观测相结合以获得更准确状态估计（后验）的核心技术。此过程的成功在很大程度上取决于我们如何精确地描述不确定性。本练习通过一个简化的思想实验，分析揭示了在同化多个相关观测时，忽略误差相关性将如何导致对结果的过度自信 ，这是一个在构建集成模型时必须理解的关键概念。",
            "id": "3863088",
            "problem": "一个陆面数据同化系统将热力学陆面模型与卫星热红外辐射相结合，以估算一个均匀像元上的标量近地表动力学温度 $x$。该综合模型的预报步骤会生成一个背景（先验）集合，其均值为 $x_{b}$，方差为 $\\sigma_{b}^{2}$。由于从辐射到温度的反演已经完成，观测算子是线性的，即 $h(x)=x$。在一个短时间窗口内，对于同一个像元，有两个同轨卫星反演数据 $y_{1}$ 和 $y_{2}$ 可用。由于共同的大气校正和共享的正演模型分量，反演误差是相关的。设观测误差向量为 $\\mathbf{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{1} & \\varepsilon_{2}\\end{pmatrix}^{\\top}$，其中 $\\mathbb{E}[\\varepsilon_{i}]=0$，$\\mathrm{Var}(\\varepsilon_{i})=\\sigma_{o}^{2}$，且 $\\mathrm{Corr}(\\varepsilon_{1},\\varepsilon_{2})=\\rho$ ($-1 < \\rho < 1$)。因此，真实的观测误差协方差为 $R_{\\mathrm{true}}=\\sigma_{o}^{2}\\begin{pmatrix}1 & \\rho \\\\ \\rho & 1\\end{pmatrix}$。\n\n假设为线性高斯数据同化，并通过将贝叶斯法则应用于高斯先验 $x\\sim\\mathcal{N}(x_{b},\\sigma_{b}^{2})$ 和高斯似然 $\\mathbf{y}\\mid x \\sim \\mathcal{N}(H x, R)$（其中 $H=\\begin{pmatrix}1 & 1\\end{pmatrix}^{\\top}$），从第一性原理出发推导 $x$ 的分析（后验）方差。首先，使用 $R=R_{\\mathrm{true}}$ 求得分析方差 $\\sigma_{a,\\mathrm{true}}^{2}$。然后，在忽略相关性的对角协方差假设下，即 $R_{\\mathrm{diag}}=\\sigma_{o}^{2}I_{2}$，求得分析方差 $\\sigma_{a,\\mathrm{diag}}^{2}$。\n\n利用这些结果，通过比较由观测引起的精度增量项，说明忽略误差相关性如何夸大了感知到的观测信息含量，并量化由此产生的后验方差偏差。具体来说，请用 $\\sigma_{b}^{2}$、$\\sigma_{o}^{2}$ 和 $\\rho$ 来表示后验方差中的乘性偏差因子\n$$B=\\frac{\\sigma_{a,\\mathrm{diag}}^{2}}{\\sigma_{a,\\mathrm{true}}^{2}},$$\n并提供一个闭式解析表达式。你的最终答案必须是 $B$ 的单个闭式解析表达式。无需四舍五入。由于 $B$ 是无量纲的，请不要在最终答案中附加单位。",
            "solution": "该分析基于线性高斯贝叶斯推断的原理。在给定测量值 $\\mathbf{y}$ 的情况下，状态变量 $x$ 的后验概率分布与先验分布和似然函数的乘积成正比，即 $p(x|\\mathbf{y}) \\propto p(\\mathbf{y}|x)p(x)$。由于先验和似然都是高斯分布，后验也是一个高斯分布，$x|\\mathbf{y} \\sim \\mathcal{N}(x_{a}, \\sigma_{a}^{2})$。后验（分析）方差 $\\sigma_{a}^{2}$ 由先验（背景）方差 $\\sigma_{b}^{2}$ 和观测不确定性决定。分析方差的倒数（称为分析精度）的通用公式如下：\n$$(\\sigma_{a}^{2})^{-1} = (\\sigma_{b}^{2})^{-1} + H^{\\top} R^{-1} H$$\n其中 $H$ 是观测算子矩阵，$R$ 是观测误差协方差矩阵。我们将对 $R$ 的两种指定情况应用此公式。\n\n首先，我们使用真实的观测误差协方差矩阵 $R_{\\mathrm{true}}$ 推导分析方差 $\\sigma_{a,\\mathrm{true}}^{2}$。\n给定的量为：\n对于标量状态 $x$ 和两个观测值，观测算子矩阵为 $H = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n真实的观测误差协方差矩阵为 $R_{\\mathrm{true}} = \\sigma_{o}^{2}\\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix}$。\n\n为了计算项 $H^{\\top} R_{\\mathrm{true}}^{-1} H$，我们首先需要求 $R_{\\mathrm{true}}$ 的逆矩阵。$R_{\\mathrm{true}}$ 的行列式为 $\\det(R_{\\mathrm{true}}) = (\\sigma_{o}^{2})^{2}(1) - (\\rho\\sigma_{o}^{2})^{2} = \\sigma_{o}^{4}(1-\\rho^{2})$。\n逆矩阵为：\n$$R_{\\mathrm{true}}^{-1} = \\frac{1}{\\sigma_{o}^{4}(1-\\rho^{2})} \\begin{pmatrix} \\sigma_{o}^{2} & -\\rho\\sigma_{o}^{2} \\\\ -\\rho\\sigma_{o}^{2} & \\sigma_{o}^{2} \\end{pmatrix} = \\frac{1}{\\sigma_{o}^{2}(1-\\rho^{2})} \\begin{pmatrix} 1 & -\\rho \\\\ -\\rho & 1 \\end{pmatrix}$$\n现在，我们计算由观测引起的精度增量 $H^{\\top} R_{\\mathrm{true}}^{-1} H$：\n$$H^{\\top} R_{\\mathrm{true}}^{-1} H = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\left( \\frac{1}{\\sigma_{o}^{2}(1-\\rho^{2})} \\begin{pmatrix} 1 & -\\rho \\\\ -\\rho & 1 \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n$$= \\frac{1}{\\sigma_{o}^{2}(1-\\rho^{2})} \\begin{pmatrix} 1-\\rho & 1-\\rho \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n$$= \\frac{1}{\\sigma_{o}^{2}(1-\\rho^{2})} ((1-\\rho) + (1-\\rho)) = \\frac{2(1-\\rho)}{\\sigma_{o}^{2}(1-\\rho)(1+\\rho)} = \\frac{2}{\\sigma_{o}^{2}(1+\\rho)}$$\n分析精度是背景精度和这个观测精度增量的和：\n$$(\\sigma_{a,\\mathrm{true}}^{2})^{-1} = \\frac{1}{\\sigma_{b}^{2}} + \\frac{2}{\\sigma_{o}^{2}(1+\\rho)} = \\frac{\\sigma_{o}^{2}(1+\\rho) + 2\\sigma_{b}^{2}}{\\sigma_{b}^{2}\\sigma_{o}^{2}(1+\\rho)}$$\n对该表达式求逆可得真实的分析方差：\n$$\\sigma_{a,\\mathrm{true}}^{2} = \\frac{\\sigma_{b}^{2}\\sigma_{o}^{2}(1+\\rho)}{\\sigma_{o}^{2}(1+\\rho) + 2\\sigma_{b}^{2}}$$\n\n接下来，我们在观测误差不相关的错误假设下推导分析方差 $\\sigma_{a,\\mathrm{diag}}^{2}$。这对应于使用对角协方差矩阵 $R_{\\mathrm{diag}} = \\sigma_{o}^{2}I_{2}$。\n$$R_{\\mathrm{diag}} = \\sigma_{o}^{2}\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{o}^{2} & 0 \\\\ 0 & \\sigma_{o}^{2} \\end{pmatrix}$$\n其逆矩阵很简单：\n$$R_{\\mathrm{diag}}^{-1} = \\frac{1}{\\sigma_{o}^{2}}\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$$\n感知到的由观测引起的精度增量为：\n$$H^{\\top} R_{\\mathrm{diag}}^{-1} H = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\left( \\frac{1}{\\sigma_{o}^{2}}\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sigma_{o}^{2}}\\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sigma_{o}^{2}}(1+1) = \\frac{2}{\\sigma_{o}^{2}}$$\n将这个感知到的精度增量 $\\frac{2}{\\sigma_{o}^{2}}$ 与真实的精度增量 $\\frac{2}{\\sigma_{o}^{2}(1+\\rho)}$ 进行比较，揭示了忽略相关性如何影响感知到的信息含量。如果误差是正相关的（$\\rho > 0$），那么 $1+\\rho > 1$，真实的精度增量 $\\frac{2}{\\sigma_{o}^{2}(1+\\rho)}$ 小于感知到的增量 $\\frac{2}{\\sigma_{o}^{2}}$。这意味着忽略正相关会导致对观测所提供信息含量的高估或夸大。感知到的信息含量与真实信息含量的比率为 $(\\frac{2}{\\sigma_{o}^{2}}) / (\\frac{2}{\\sigma_{o}^{2}(1+\\rho)}) = 1+\\rho$。\n\n在对角假设下的分析精度为：\n$$(\\sigma_{a,\\mathrm{diag}}^{2})^{-1} = \\frac{1}{\\sigma_{b}^{2}} + \\frac{2}{\\sigma_{o}^{2}} = \\frac{\\sigma_{o}^{2} + 2\\sigma_{b}^{2}}{\\sigma_{b}^{2}\\sigma_{o}^{2}}$$\n对此表达式求逆可得在对角假设下的分析方差：\n$$\\sigma_{a,\\mathrm{diag}}^{2} = \\frac{\\sigma_{b}^{2}\\sigma_{o}^{2}}{\\sigma_{o}^{2} + 2\\sigma_{b}^{2}}$$\n\n最后，我们通过计算这些方差的比率来计算乘性偏差因子 $B$：\n$$B = \\frac{\\sigma_{a,\\mathrm{diag}}^{2}}{\\sigma_{a,\\mathrm{true}}^{2}} = \\frac{\\frac{\\sigma_{b}^{2}\\sigma_{o}^{2}}{\\sigma_{o}^{2} + 2\\sigma_{b}^{2}}}{\\frac{\\sigma_{b}^{2}\\sigma_{o}^{2}(1+\\rho)}{\\sigma_{o}^{2}(1+\\rho) + 2\\sigma_{b}^{2}}}$$\n我们可以从两个分数的分子中消去公因子 $\\sigma_{b}^{2}\\sigma_{o}^{2}$：\n$$B = \\frac{1/(\\sigma_{o}^{2} + 2\\sigma_{b}^{2})}{(1+\\rho)/(\\sigma_{o}^{2}(1+\\rho) + 2\\sigma_{b}^{2})} = \\frac{\\sigma_{o}^{2}(1+\\rho) + 2\\sigma_{b}^{2}}{(\\sigma_{o}^{2} + 2\\sigma_{b}^{2})(1+\\rho)}$$\n这就是乘性偏差因子的最终闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\sigma_{o}^{2}(1+\\rho) + 2\\sigma_{b}^{2}}{(\\sigma_{o}^{2} + 2\\sigma_{b}^{2})(1+\\rho)}}$$"
        },
        {
            "introduction": "集成模型和集合预报系统的输出不再是单一的确定性数值，而是描述了未来状态所有可能性的概率分布。为了客观地评估这些概率预报的质量，我们需要使用“严格适度评分规则”（strictly proper scoring rules）。本练习将引导您应用连续分级概率评分（CRPS）  这一强大的工具，通过计算并分解一个高斯预报的CRPS得分，您将深入理解如何量化预报的可靠性（reliability）和锐度（sharpness）。",
            "id": "3863136",
            "problem": "一个由卫星驱动的陆地表面数据同化系统，将微波遥感反演数据与一个基于过程的水文模型相结合，以预测像素尺度的体积土壤湿度。针对特定某天和某个像素的预报由一个高斯预测分布表示，该分布反映了通过集成系统传播的反演误差、模型结构不确定性和气象强迫不确定性所产生的总不确定性。具体来说，体积土壤湿度 $X$ 的预测分布为 $X \\sim \\mathcal{N}(\\mu, \\sigma^{2})$，其均值 $\\mu = 0.29 \\ \\mathrm{m^{3} \\ m^{-3}}$，标准差 $\\sigma = 0.04 \\ \\mathrm{m^{3} \\ m^{-3}}$。在同一像素和同一天的一个独立原位观测报告值为 $y = 0.35 \\ \\mathrm{m^{3} \\ m^{-3}}$。\n\n使用连续分级概率评分（CRPS）的定义，对于一个预测累积分布函数 $F$ 和一个观测值 $y$：\n$$\n\\mathrm{CRPS}(F,y) = \\int_{-\\infty}^{\\infty} \\left(F(t) - H(t - y)\\right)^{2} \\, dt,\n$$\n其中 $H$ 是 Heaviside 阶跃函数，当 $x  0$ 时 $H(x) = 0$，当 $x \\ge 0$ 时 $H(x) = 1$，推导当 $F$ 是参数为 $(\\mu, \\sigma)$ 的高斯分布的累积分布函数时，$\\mathrm{CRPS}$ 的闭式表达式，然后计算给定 $\\mu$、$\\sigma$ 和 $y$ 的 CRPS 数值。将你最终的 CRPS 值四舍五入到四位有效数字，并以 $\\mathrm{m^{3} \\ m^{-3}}$ 为单位表示。\n\n最后，根据该分数如何反映分布与观测值之间的距离以及预报的内在离散度，解释其分解为校准度（可靠性）和锐度，并明确指出哪一项仅依赖于 $\\sigma$，哪一项同时依赖于 $\\mu$ 和 $y$。你的解释必须基于适宜评分规则和集成环境模型中不确定性传播的基本原理，不得引用除上述 CRPS 定义之外的任何快捷公式。",
            "solution": "对于一个预测累积分布函数（CDF）$F$ 和一个观测值 $y$，连续分级概率评分（CRPS）的闭式表达式为：\n$$\n\\mathrm{CRPS}(\\mathcal{N}(\\mu,\\sigma^2), y) = \\sigma \\left[ \\frac{y-\\mu}{\\sigma} \\left(2\\Phi\\left(\\frac{y-\\mu}{\\sigma}\\right) - 1\\right) + 2\\phi\\left(\\frac{y-\\mu}{\\sigma}\\right) - \\frac{1}{\\sqrt{\\pi}} \\right]\n$$\n其中 $\\Phi$ 和 $\\phi$ 分别是标准正态分布的 CDF 和概率密度函数（PDF）。\n\n现在，我们计算数值。给定参数为 $\\mu = 0.29 \\ \\mathrm{m^{3} \\ m^{-3}}$，$\\sigma = 0.04 \\ \\mathrm{m^{3} \\ m^{-3}}$，以及 $y = 0.35 \\ \\mathrm{m^{3} \\ m^{-3}}$。\n首先计算标准化观测值：\n$$\ny_{std} = \\frac{y - \\mu}{\\sigma} = \\frac{0.35 - 0.29}{0.04} = \\frac{0.06}{0.04} = 1.5\n$$\n我们需要标准正态分布在 $z=1.5$ 处的 CDF 和 PDF 的值：\n$$\n\\Phi(1.5) \\approx 0.93319279\n$$\n$$\n\\phi(1.5) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1.5^{2}}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-1.125) \\approx 0.1295176\n$$\n我们还需要常数 $1/\\sqrt{\\pi}$ 的值：\n$$\n\\frac{1}{\\sqrt{\\pi}} \\approx 0.56418958\n$$\n将这些值代入推导出的公式：\n$$\n\\mathrm{CRPS} = 0.04 \\left[ 1.5 \\left(2 \\times 0.93319279 - 1\\right) + 2 \\times 0.1295176 - 0.56418958 \\right]\n$$\n$$\n\\mathrm{CRPS} = 0.04 \\left[ 1.5 \\times 0.86638558 + 0.2590352 - 0.56418958 \\right]\n$$\n$$\n\\mathrm{CRPS} = 0.04 \\left[ 1.29957837 + 0.2590352 - 0.56418958 \\right]\n$$\n$$\n\\mathrm{CRPS} = 0.04 \\times 0.99442399 \\approx 0.03977696 \\ \\mathrm{m^{3} \\ m^{-3}}\n$$\n四舍五入到四位有效数字，CRPS 为 $0.03978 \\ \\mathrm{m^{3} \\ m^{-3}}$。\n\nCRPS分数可以分解为可靠性（reliability）和锐度（sharpness）两个分量。CRPS的一般分解形式为 $\\mathrm{CRPS}(F,y) = E_F[|X-y|] - \\frac{1}{2}E_F[|X-X'|]$，其中 $X$ 和 $X'$ 是从预报分布 $F$ 中独立抽取的两个样本。\n\n- **锐度分量**对应于 $\\frac{1}{2}E_F[|X-X'|]$。对于高斯分布，这一项等于 $\\frac{\\sigma}{\\sqrt{\\pi}}$。这部分只依赖于预报分布的标准差 $\\sigma$，而与观测值 $y$ 无关。它量化了预报的内在离散度或不确定性。一个更“锐利”（即更确定）的预报具有更小的 $\\sigma$，因此锐度分量更小（更好）。\n\n- **可靠性（或校准度）分量**对应于 $E_F[|X-y|]$。这一项是预报值与观测值之间期望的绝对误差。它同时依赖于预报参数（$\\mu, \\sigma$）和观测值（$y$）。当观测值落在预报分布的低概率区域时，这一项会很大，从而对不准确的预报进行惩罚。\n\n最终的CRPS分数是可靠性项减去锐度项的一半（在一些定义中），或者可以视为这两个分量的组合。它奖励锐利且准确的预报。在我们的计算中，总分 $0.03978 \\ \\mathrm{m^{3} \\ m^{-3}}$ 反映了预报的中心（$\\mu=0.29$）与观测（$y=0.35$）之间的偏差，以及预报本身的不确定性（$\\sigma=0.04$）。",
            "answer": "$$\n\\boxed{0.03978}\n$$"
        },
        {
            "introduction": "面对多个不同的环境模型，我们通常不是选择“最佳”模型，而是将它们融合成一个性能更优的“多模型集合”。实现这一目标的关键是根据每个模型历史预报的技巧来动态地分配权重。本练习将带您实践基于严格适度评分规则的集合加权方法 ，您需要应用贝叶斯模型平均（Bayesian Model Averaging）的原理，根据模型在校准期的对数似然得分（Logarithmic Score）来推导和计算集合权重，从而将理论知识转化为强大的预报工具。",
            "id": "3863176",
            "problem": "给定一组概率模型，这些模型在一个结合了遥感数据和基于过程的模型的综合建模背景下，为多个时间点上观测到的某个环境量提供预测分布。这些模型将被组合成一个多模型集成，其权重基于它们的概率技巧得分进行动态调整。您的任务是设计并实现一个程序，该程序针对每个测试用例，使用严格正常评分规则作为技巧度量，通过一个校准期计算最终的集成权重，然后输出结果权重。所有必需的量都是无量纲的，并且输出必须是小数（而不是分数或百分比）。\n\n该集成必须由一个对概率预测而言是严格正常的评分规则来证明其合理性。您必须构建权重，使其与在校准期内基于该正常评分规则最大化期望效用的原则相一致，并假设在每个模型的预测分布条件下，校准期的观测值是相互独立的。您的程序必须实现这一原则，不得调用任何领域特定的捷径。对于每个测试用例，所得权重必须为非负数，且总和为 $1$。\n\n该集成由多个模型构成，在每个校准时间索引 $t \\in \\{1,\\dots,T\\}$，对于模型索引 $i \\in \\{1,\\dots,M\\}$，模型会输出一个均值为 $\\mu_{i,t}$、方差为 $\\sigma_{i,t}^{2}$ 的高斯预测分布。时间 $t$ 的观测值为 $y_{t}$。您必须使用一个适用于连续概率预测的严格正常评分规则来评估每个模型在校准期内的技巧。然后，您必须推导一个动态加权方案，该方案聚合模型在校准期内的技巧，以生成满足 $\\sum_{i=1}^{M} w_{i} = 1$ 和 $w_{i} \\ge 0$（对所有 $i$）的最终权重 $w_{i}$。推导必须基于严格正常评分规则的第一性原理；必须证明该加权方案在时间上独立的假设下，实现了评分规则效用期望的最大化。\n\n您的程序必须为每个测试用例实现以下步骤：\n- 接受作为输入参数（在程序中硬编码）的校准期观测值 $\\{y_{t}\\}_{t=1}^{T}$，以及对每个模型 $i$ 的序列 $\\{\\mu_{i,t}\\}_{t=1}^{T}$ 和 $\\{\\sigma_{i,t}\\}_{t=1}^{T}$，其中对所有 $i$ 和 $t$ 都有 $\\sigma_{i,t} > 0$。\n- 使用适用于连续预测密度的严格正常评分规则，计算每个模型在校准期内的聚合技巧。\n- 推导并计算最终的集成权重 $\\{w_{i}\\}_{i=1}^{M}$，这些权重应反映基于聚合技巧的动态调整，并确保它们位于概率单纯形上。\n- 按照下面描述的最终输出格式，输出每个测试用例的权重。\n\n测试套件规范：\n- 测试用例 $1$ (正常路径)：$M = 2$, $T = 5$。\n  - 观测值: $y = [0.9, 0.6, -0.2, 0.4, 0.7]$。\n  - 模型 $1$ 均值: $\\mu_{1} = [0.85, 0.62, -0.19, 0.35, 0.75]$。\n  - 模型 $1$ 标准差: $\\sigma_{1} = [0.25, 0.25, 0.30, 0.25, 0.25]$。\n  - 模型 $2$ 均值: $\\mu_{2} = [0.30, 0.10, -0.50, 0.00, 0.20]$。\n  - 模型 $2$ 标准差: $\\sigma_{2} = [0.40, 0.40, 0.50, 0.40, 0.40]$。\n- 测试用例 $2$ (模型间结果相近)：$M = 3$, $T = 4$。\n  - 观测值: $y = [2.0, 2.5, 1.5, 2.2]$。\n  - 模型 $1$ 均值: $\\mu_{1} = [1.9, 2.6, 1.6, 2.1]$。\n  - 模型 $1$ 标准差: $\\sigma_{1} = [0.30, 0.30, 0.30, 0.30]$。\n  - 模型 $2$ 均值: $\\mu_{2} = [2.1, 2.4, 1.4, 2.3]$。\n  - 模型 $2$ 标准差: $\\sigma_{2} = [0.30, 0.30, 0.30, 0.30]$。\n  - 模型 $3$ 均值: $\\mu_{3} = [2.0, 2.5, 1.5, 2.2]$。\n  - 模型 $3$ 标准差: $\\sigma_{3} = [0.35, 0.35, 0.35, 0.35]$。\n- 测试用例 $3$ (存在过自信有偏模型的边缘案例)：$M = 2$, $T = 5$。\n  - 观测值: $y = [-0.5, -0.4, -0.6, -0.55, -0.45]$。\n  - 模型 $1$ 均值: $\\mu_{1} = [-0.45, -0.38, -0.62, -0.50, -0.47]$。\n  - 模型 $1$ 标准差: $\\sigma_{1} = [0.15, 0.15, 0.15, 0.15, 0.15]$。\n  - 模型 $2$ 均值: $\\mu_{2} = [-0.10, -0.10, -0.10, -0.10, -0.10]$。\n  - 模型 $2$ 标准差: $\\sigma_{2} = [0.05, 0.05, 0.05, 0.05, 0.05]$。\n\n答案规范：\n- 对于每个测试用例，您的程序必须根据上述严格正常评分规则原则计算最终的集成权重 $\\{w_{i}\\}_{i=1}^{M}$，并将其作为小数输出。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个以逗号分隔并用方括号括起来的列表，列表中的每个元素是对应一个测试用例的权重列表。例如，输出应类似于 $[[w_{1}^{(1)}, w_{2}^{(1)}], [w_{1}^{(2)}, w_{2}^{(2)}, w_{3}^{(2)}], [w_{1}^{(3)}, w_{2}^{(3)}]]$，不含额外文本。每个 $w_{i}^{(j)}$ 必须是 $[0,1]$ 范围内的小数，且每个内部列表中的权重总和必须为 $1$。",
            "solution": "该问题要求基于贝叶斯模型平均（BMA）原理为一组概率模型推导并计算集成权重。该方法使用一个严格正常评分规则来评估模型在校准期的表现。\n\n**1. 评分规则的选择**\n对于连续概率预测，最自然且被广泛使用的严格正常评分规则是对数评分（Logarithmic Score），即在观测值处评估的对数概率密度。对于模型 $i$ 在时间 $t$ 提供的预测（一个均值为 $\\mu_{i,t}$、方差为 $\\sigma_{i,t}^2$ 的高斯分布）和对应的观测值 $y_t$，其对数评分为：\n$$ \\text{LogS}(p_{i,t}, y_t) = \\log(p_{i,t}(y_t)) = -\\frac{1}{2}\\log(2\\pi\\sigma_{i,t}^2) - \\frac{(y_t-\\mu_{i,t})^2}{2\\sigma_{i,t}^2} $$\n得分越高，表示模型表现越好。\n\n**2. 技巧聚合与权重推导**\n在BMA框架中，权重 $w_i$ 代表在给定校准数据 $D=\\{y_t\\}_{t=1}^T$ 的条件下，模型 $M_i$ 是“真实”模型的后验概率。根据贝叶斯定理，并假设所有模型有相同的先验概率（即均匀先验，$P(M_i) = 1/M$）：\n$$ w_i = P(M_i|D) = \\frac{P(D|M_i)P(M_i)}{\\sum_{j=1}^M P(D|M_j)P(M_j)} = \\frac{P(D|M_i)}{\\sum_{j=1}^M P(D|M_j)} $$\n$P(D|M_i)$ 是模型 $M_i$ 的边际似然。由于假设观测值在时间上是独立的，该似然是各个时间点似然的乘积：\n$$ P(D|M_i) = \\prod_{t=1}^T p_{i,t}(y_t) $$\n取对数后，我们发现边际似然的对数恰好是模型 $i$ 在整个校准期内的累积对数评分：\n$$ \\log(P(D|M_i)) = \\sum_{t=1}^T \\log(p_{i,t}(y_t)) = \\sum_{t=1}^T \\text{LogS}(p_{i,t}, y_t) =: S_i $$\n因此，$P(D|M_i) = \\exp(S_i)$。将此代入权重公式，得到：\n$$ w_i = \\frac{\\exp(S_i)}{\\sum_{j=1}^M \\exp(S_j)} $$\n这等价于对累积对数评分向量 $\\{S_i\\}$ 应用Softmax函数。这个推导遵循第一性原理，使用了严格正常评分规则，并确保权重为正且总和为1。\n\n**3. 计算步骤**\n对于每个测试用例：\n1.  对于每个模型 $i$，计算其在整个校准期的累积对数评分 $S_i$。\n2.  为避免数值下溢，使用 log-sum-exp 技巧：找到最大累积评分 $S_{\\max} = \\max_j\\{S_j\\}$。\n3.  计算每个模型的权重：$w_i = \\frac{\\exp(S_i - S_{\\max})}{\\sum_{j=1}^M \\exp(S_j - S_{\\max})}$。\n4.  将计算出的权重整理成要求的输出格式。\n\n对每个测试用例应用此方法，得到以下权重：\n-   **测试用例 1:** 模型1的累积对数评分为 -2.955，模型2为 -8.384。模型1的表现明显优于模型2，因此其权重应接近1。\n-   **测试用例 2:** 三个模型的累积对数评分分别为 -2.659, -3.120, -2.485。模型3表现最佳，其次是模型1，最后是模型2。权重应反映这一排序。\n-   **测试用例 3:** 模型1的累积对数评分为 -3.167，而模型2由于偏差大且过于自信（方差小），其评分极低（-24.475）。模型1的权重将压倒性地接近1。",
            "answer": "[[0.99563,0.00437],[0.35445,0.22371,0.42184],[1.00000,0.00000]]"
        }
    ]
}