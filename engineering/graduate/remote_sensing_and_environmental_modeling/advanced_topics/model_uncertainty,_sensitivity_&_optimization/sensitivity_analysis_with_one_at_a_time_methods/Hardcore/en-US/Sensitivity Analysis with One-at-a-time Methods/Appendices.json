{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration of One-at-a-Time ($OAT$) sensitivity analysis, we start with the fundamentals. This first practice grounds you in the core definitions of local sensitivity and elasticity using a simple, analytically solvable model of first-order decay. By directly differentiating the model's solution with respect to a parameter, you will develop a concrete, intuitive understanding of how a model's output changes in response to a small parameter perturbation, a foundational skill for any modeling endeavor .",
            "id": "3926708",
            "problem": "A single-compartment biomedical tracer model describes the concentration $x(t)$ of a tracer in plasma undergoing first-order elimination with rate constant $k>0$. The model is governed by the ordinary differential equation $ \\dot{x}(t) = -k\\,x(t)$ with initial condition $x(0) = x_{0} > 0$. The measured output is $y(t) = x(t)$.\n\nUsing the framework of local one-at-a-time (OAT) sensitivity analysis, the local sensitivity of the state with respect to the parameter $k$ is defined as $s_{k}(t) = \\frac{\\partial x(t;k)}{\\partial k}$, where time $t$ is held fixed and the dependence of the solution on $k$ is made explicit. The elasticity (logarithmic sensitivity) of the output with respect to $k$ is defined as $E_{k}(t) = \\frac{k}{y(t)}\\,\\frac{\\partial y(t)}{\\partial k}$.\n\nStarting from these definitions and the given model, derive an explicit closed-form expression for the elasticity $E_{k}(t)$ as a function of $t$ and $k$. Express your final answer as a single analytic expression. Do not approximate or round. Provide only $E_{k}(t)$ as your final reported answer. The elasticity is dimensionless; do not include units in your final answer.",
            "solution": "The problem statement is validated as follows.\n\n1.  **Extracted Givens**:\n    -   Governing ordinary differential equation (ODE): $\\dot{x}(t) = -k\\,x(t)$\n    -   Parameter constraint: $k > 0$\n    -   Initial condition: $x(0) = x_{0} > 0$\n    -   Measured output: $y(t) = x(t)$\n    -   Definition of local sensitivity: $s_{k}(t) = \\frac{\\partial x(t;k)}{\\partial k}$\n    -   Definition of elasticity: $E_{k}(t) = \\frac{k}{y(t)}\\,\\frac{\\partial y(t)}{\\partial k}$\n\n2.  **Validation**:\n    -   **Scientific Grounding**: The problem is scientifically grounded. The equation $\\dot{x}(t) = -k\\,x(t)$ is the fundamental mathematical model for first-order kinetics, which is a cornerstone of pharmacology, chemistry, and physics.\n    -   **Well-Posedness**: The problem is well-posed. It presents a first-order linear ordinary differential equation with a specified initial condition, which constitutes a standard initial value problem (IVP) possessing a unique and stable solution. The definitions for sensitivity and elasticity are standard in systems analysis and control theory.\n    -   **Objectivity**: The problem is objective, utilizing precise mathematical language and definitions.\n    -   **Completeness**: The problem is self-contained and provides all necessary information for its solution. There are no contradictions.\n\n3.  **Verdict**:\n    -   The problem is deemed **valid**. The solution process will now proceed.\n\nThe objective is to derive an explicit closed-form expression for the elasticity $E_{k}(t)$. The derivation proceeds in three steps: first, solving the state equation for $x(t)$; second, calculating the partial derivative of the solution with respect to the parameter $k$; and third, substituting these results into the definition of elasticity.\n\nStep 1: Solve the differential equation for the state variable $x(t)$.\nThe model is given by the linear first-order ODE:\n$$\n\\frac{dx}{dt} = -k\\,x(t)\n$$\nThis equation is separable. We can rearrange it as:\n$$\n\\frac{1}{x} \\, dx = -k \\, dt\n$$\nIntegrating both sides yields:\n$$\n\\int \\frac{1}{x} \\, dx = \\int -k \\, dt\n$$\n$$\n\\ln|x(t)| = -k\\,t + C\n$$\nwhere $C$ is the constant of integration. Since $x(t)$ represents a concentration, we assume $x(t) > 0$ for all $t \\ge 0$, so $|x(t)| = x(t)$.\n$$\n\\ln(x(t)) = -k\\,t + C\n$$\nExponentiating both sides gives the general solution:\n$$\nx(t) = \\exp(-k\\,t + C) = \\exp(C)\\,\\exp(-k\\,t)\n$$\nWe use the initial condition $x(0) = x_0$ to determine the constant of integration. Let $A = \\exp(C)$.\n$$\nx(0) = A\\,\\exp(-k \\cdot 0) = A \\cdot 1 = A\n$$\nThus, $A = x_0$. The particular solution for the state variable is:\n$$\nx(t) = x_0 \\exp(-k\\,t)\n$$\n\nStep 2: Calculate the partial derivative of the output with respect to the parameter $k$.\nThe measured output is $y(t) = x(t)$. Therefore, we need to calculate $\\frac{\\partial y(t)}{\\partial k} = \\frac{\\partial x(t)}{\\partial k}$. We treat the solution $x(t)$ as a function of both time $t$ and the parameter $k$, denoted explicitly as $x(t; k)$.\n$$\nx(t; k) = x_0 \\exp(-k\\,t)\n$$\nWe now differentiate this expression with respect to $k$, holding $t$ constant:\n$$\n\\frac{\\partial x(t; k)}{\\partial k} = \\frac{\\partial}{\\partial k} \\left[ x_0 \\exp(-k\\,t) \\right]\n$$\nUsing the chain rule for differentiation, where the outer function is the exponential and the inner function is its argument $(-k\\,t)$:\n$$\n\\frac{\\partial x}{\\partial k} = x_0 \\exp(-k\\,t) \\cdot \\frac{\\partial}{\\partial k}(-k\\,t)\n$$\n$$\n\\frac{\\partial x}{\\partial k} = x_0 \\exp(-k\\,t) \\cdot (-t)\n$$\n$$\n\\frac{\\partial x}{\\partial k} = -t\\,x_0 \\exp(-k\\,t)\n$$\n\nStep 3: Substitute the expressions into the elasticity formula.\nThe definition of the elasticity of the output $y(t)$ with respect to the parameter $k$ is given as:\n$$\nE_{k}(t) = \\frac{k}{y(t)}\\,\\frac{\\partial y(t)}{\\partial k}\n$$\nSince $y(t) = x(t) = x_0 \\exp(-k\\,t)$ and we have found $\\frac{\\partial y(t)}{\\partial k} = \\frac{\\partial x(t)}{\\partial k} = -t\\,x_0 \\exp(-k\\,t)$, we can substitute these expressions into the formula for $E_{k}(t)$.\n$$\nE_{k}(t) = \\frac{k}{x_0 \\exp(-k\\,t)} \\left( -t\\,x_0 \\exp(-k\\,t) \\right)\n$$\nThe terms $x_0$ and $\\exp(-k\\,t)$ in the numerator and denominator cancel out.\n$$\nE_{k}(t) = k \\cdot (-t)\n$$\nThis simplifies to the final closed-form expression for the elasticity:\n$$\nE_{k}(t) = -k\\,t\n$$\nThis expression shows that the elasticity is a linear function of time $t$ and the rate constant $k$. It is a dimensionless quantity, as expected. For a given $k > 0$, the magnitude of the relative sensitivity grows linearly with time.",
            "answer": "$$\n\\boxed{-kt}\n$$"
        },
        {
            "introduction": "While direct differentiation is instructive, it requires an analytical solution for the model's state, which is often unavailable for complex environmental systems. This exercise introduces a more powerful and general technique: the sensitivity equations method. Here, you will learn to derive a separate ordinary differential equation ($ODE$) that governs the sensitivity function itself, allowing you to solve for sensitivities directly, a method that is far more scalable and forms the basis for sophisticated numerical analysis tools .",
            "id": "3926758",
            "problem": "Consider a pharmacokinetic compartment model idealized as a single compartment with exponential elimination, described by the ordinary differential equation (ODE) $ \\dot{x}(t) = -k\\,x(t) $ with initial condition $ x(0) = x_0 $, where $ k $ is a positive elimination rate constant and $ x(t) $ is the compartment amount. Let the measurable output be $ y(t) = x(t) $. Using local one-at-a-time sensitivity analysis with respect to the parameter $ k $, define the unnormalized local sensitivity function as $ s_k(t) = \\frac{\\partial y(t)}{\\partial k} $. Starting only from the ODE, fundamental differentiation rules, and the definition of $ s_k(t) $, derive the governing ODE for $ s_k(t) $, identify the initial condition $ s_k(0) $ under the assumption that $ x_0 $ does not depend on $ k $, and solve for $ s_k(t) $ analytically. Independently, verify the solution by directly differentiating the closed-form solution $ x(t) = x_0 \\exp(-k t) $ with respect to $ k $ and demonstrate agreement. Report the final sensitivity $ s_k(t) $ as a single closed-form analytic expression. No numerical approximation or rounding is required, and no physical units are to be included in the final expression.",
            "solution": "The problem statement is first validated for scientific soundness, self-consistency, and well-posedness.\n\n### Step 1: Extract Givens\n- The governing ordinary differential equation (ODE) for the system is $ \\dot{x}(t) = -k\\,x(t) $.\n- The initial condition for the state is $ x(0) = x_0 $.\n- The elimination rate constant $ k $ is a positive parameter, i.e., $ k > 0 $.\n- The measurable output is defined as $ y(t) = x(t) $.\n- The unnormalized local sensitivity function with respect to $ k $ is defined as $ s_k(t) = \\frac{\\partial y(t)}{\\partial k} $.\n- An assumption is provided: the initial condition $ x_0 $ does not depend on the parameter $ k $.\n\nThe tasks are:\n1.  Derive the governing ODE for $ s_k(t) $.\n2.  Identify the initial condition $ s_k(0) $.\n3.  Solve the resulting initial value problem for $ s_k(t) $.\n4.  Independently verify the solution by differentiating the analytical solution for $ x(t) $.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes a single-compartment model with first-order elimination, a cornerstone of pharmacokinetic modeling. The use of sensitivity analysis to study the effect of a parameter ($k$) on the state ($x(t)$) is a standard, rigorous technique in systems biology and engineering. The problem is based on established mathematical and scientific principles.\n- **Well-Posed:** The problem is clearly stated with a linear ODE, a well-defined initial condition, and a precise definition for the sensitivity function. All required information is present, and there are no contradictions. A unique analytical solution is expected to exist.\n- **Objective:** The problem is expressed in precise mathematical language, free from any subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, objective, and complete. I will proceed with the solution.\n\n### Solution Derivation\n\nThe analysis proceeds in two parts as requested: first, by deriving and solving the sensitivity ODE, and second, by direct differentiation for verification.\n\n**Part 1: Derivation and Solution of the Sensitivity ODE**\n\nThe system is described by the ODE:\n$$ \\dot{x}(t) = -k\\,x(t) $$\nSince the output is $ y(t) = x(t) $, the equation can be written in terms of the output:\n$$ \\dot{y}(t) = -k\\,y(t) $$\nThe sensitivity function is defined as $ s_k(t) = \\frac{\\partial y(t)}{\\partial k} $. To find the governing ODE for $ s_k(t) $, we differentiate the system's ODE with respect to the parameter $ k $. Assuming the function $ y(t, k) $ is sufficiently smooth, we can interchange the order of differentiation with respect to $ t $ and $ k $:\n$$ \\frac{\\partial}{\\partial k} \\left( \\frac{d y(t)}{dt} \\right) = \\frac{d}{dt} \\left( \\frac{\\partial y(t)}{\\partial k} \\right) = \\frac{d s_k(t)}{dt} = \\dot{s}_k(t) $$\nApplying this to the system ODE:\n$$ \\frac{\\partial}{\\partial k} (\\dot{y}(t)) = \\frac{\\partial}{\\partial k} (-k\\,y(t)) $$\n$$ \\dot{s}_k(t) = \\frac{\\partial}{\\partial k} (-k\\,y(t)) $$\nUsing the product rule for differentiation on the right-hand side:\n$$ \\dot{s}_k(t) = - \\left( \\frac{\\partial k}{\\partial k} \\cdot y(t) + k \\cdot \\frac{\\partial y(t)}{\\partial k} \\right) $$\n$$ \\dot{s}_k(t) = - \\left( 1 \\cdot y(t) + k \\cdot s_k(t) \\right) $$\nThis gives the linear, non-homogeneous ODE for the sensitivity function:\n$$ \\dot{s}_k(t) = -k\\,s_k(t) - y(t) $$\nNext, we determine the initial condition for $ s_k(t) $. The initial condition for the state is $ y(0) = x(0) = x_0 $. The initial sensitivity is found by differentiating the initial state with respect to $ k $:\n$$ s_k(0) = \\left. \\frac{\\partial y(t)}{\\partial k} \\right|_{t=0} = \\frac{\\partial y(0)}{\\partial k} = \\frac{\\partial x_0}{\\partial k} $$\nThe problem states that $ x_0 $ is independent of $ k $, so $ \\frac{\\partial x_0}{\\partial k} = 0 $. Therefore, the initial condition for the sensitivity is:\n$$ s_k(0) = 0 $$\nTo solve the sensitivity ODE, we must first substitute the solution for $ y(t) $. The original ODE, $ \\dot{y}(t) = -k\\,y(t) $ with $ y(0) = x_0 $, has the analytical solution:\n$$ y(t) = x_0 \\exp(-kt) $$\nSubstituting this into the sensitivity ODE yields:\n$$ \\dot{s}_k(t) = -k\\,s_k(t) - x_0 \\exp(-kt) $$\nThis can be rearranged into the standard form for a first-order linear ODE:\n$$ \\dot{s}_k(t) + k\\,s_k(t) = -x_0 \\exp(-kt) $$\nWe solve this using an integrating factor, $ I(t) $.\n$$ I(t) = \\exp\\left(\\int k \\, dt\\right) = \\exp(kt) $$\nMultiplying the ODE by $ I(t) $:\n$$ \\exp(kt) \\dot{s}_k(t) + k \\exp(kt) s_k(t) = -x_0 \\exp(-kt) \\exp(kt) $$\nThe left side is the derivative of the product $ I(t) s_k(t) $:\n$$ \\frac{d}{dt} \\left( s_k(t) \\exp(kt) \\right) = -x_0 \\exp(0) = -x_0 $$\nIntegrating both sides with respect to $ t $:\n$$ \\int \\frac{d}{dt} \\left( s_k(t) \\exp(kt) \\right) dt = \\int -x_0 \\, dt $$\n$$ s_k(t) \\exp(kt) = -x_0 t + C $$\nwhere $ C $ is the constant of integration. We solve for $ s_k(t) $:\n$$ s_k(t) = (-x_0 t + C) \\exp(-kt) $$\nNow, we apply the initial condition $ s_k(0) = 0 $:\n$$ s_k(0) = (-x_0 \\cdot 0 + C) \\exp(-k \\cdot 0) = (0 + C) \\cdot 1 = C $$\nThus, $ C = 0 $. The analytical solution for the sensitivity function is:\n$$ s_k(t) = -x_0 t \\exp(-kt) $$\n\n**Part 2: Independent Verification**\n\nWe are asked to verify this result by directly differentiating the closed-form solution of the state variable, $ x(t) = x_0 \\exp(-kt) $, with respect to $ k $.\nGiven $ y(t) = x(t) = x_0 \\exp(-kt) $.\nThe sensitivity is $ s_k(t) = \\frac{\\partial y(t)}{\\partial k} $.\n$$ s_k(t) = \\frac{\\partial}{\\partial k} \\left( x_0 \\exp(-kt) \\right) $$\nSince $ x_0 $ is independent of $ k $, we treat it as a constant:\n$$ s_k(t) = x_0 \\frac{\\partial}{\\partial k} \\left( \\exp(-kt) \\right) $$\nUsing the chain rule for differentiation, let $ u = -kt $. Then $ \\frac{\\partial u}{\\partial k} = -t $.\n$$ s_k(t) = x_0 \\cdot \\exp(-kt) \\cdot \\frac{\\partial}{\\partial k}(-kt) $$\n$$ s_k(t) = x_0 \\exp(-kt) (-t) $$\n$$ s_k(t) = -x_0 t \\exp(-kt) $$\nThis expression is identical to the one derived by solving the sensitivity ODE. The agreement between the two methods confirms the correctness of the result. The final expression for the sensitivity is $ s_k(t) = -x_0 t \\exp(-kt) $.",
            "answer": "$$ \\boxed{-x_0 t \\exp(-kt)} $$"
        },
        {
            "introduction": "This final practice bridges the gap from analytical theory to computational application, simulating the workflow used for complex environmental models. You will apply the sensitivity equations method to a multi-parameter system that requires numerical integration, building an augmented system of $ODE$s for both the model states and their sensitivities. This exercise culminates in the construction of the Jacobian matrix, whose properties, like its rank, provide deep insights into parameter identifiabilityâ€”the crucial question of whether a parameter's value can be uniquely determined from available data .",
            "id": "3926762",
            "problem": "Consider the Bergman minimal glucose-insulin model for an intravenous glucose tolerance test in which the plasma glucose concentration is represented by the state variable $G(t)$ and the remote insulin effect is represented by the state variable $X(t)$. The governing ordinary differential equations are\n$$\n\\frac{dG}{dt} = -p_1\\,(G - G_b) - X\\,G,\n$$\n$$\n\\frac{dX}{dt} = -p_2\\,X + p_3\\,(I(t) - I_b),\n$$\nwhere $p_1, p_2, p_3$ are unknown parameters to be analyzed, $G_b$ is the basal glucose concentration, $I_b$ is the basal insulin concentration, and $I(t)$ is a known exogenous insulin input function. Assume the initial conditions $G(0) = G_0$ and $X(0) = X_0$ are independent of the parameters $p_1, p_2, p_3$. The measured output of interest is the glucose trajectory sampled at specified times, i.e., $y_j = G(t_j)$.\n\nLocal one-at-a-time sensitivity analysis for the parameters $p_1, p_2, p_3$ is to be performed via sensitivity equations. For each parameter $p_i$, define sensitivity variables $S_{G,p_i}(t) = \\frac{\\partial G(t)}{\\partial p_i}$ and $S_{X,p_i}(t) = \\frac{\\partial X(t)}{\\partial p_i}$. These sensitivities satisfy first-order ordinary differential equations obtained by differentiating the model with respect to $p_i$. Using these sensitivity equations, construct numerically the Jacobian matrix $J(\\theta^*) \\in \\mathbb{R}^{m \\times 3}$, where $\\theta^* = (p_1, p_2, p_3)$ and $m$ is the number of sampling times, with entries\n$$\nJ_{j,i}(\\theta^*) = \\left.\\frac{\\partial G(t_j)}{\\partial p_i}\\right|_{\\theta = \\theta^*} = S_{G,p_i}(t_j).\n$$\nDetermine the matrix rank of $J(\\theta^*)$.\n\nYour program must implement the sensitivity equations rigorously (not by finite differences) and compute $J(\\theta^*)$ based on an integration of the augmented system consisting of the original state equations and the sensitivity equations. Use precise numerical integration appropriate for stiff or non-stiff systems as needed.\n\nFor all cases below, set the basal values to $G_b = 90$ and $I_b = 10$, and use parameter vector $\\theta^* = (p_1, p_2, p_3) = (0.01, 0.02, 0.0005)$. The insulin input is modeled as\n$$\nI(t) = I_b + A\\,e^{-\\alpha t},\n$$\nwhere $A$ and $\\alpha$ are specified per test case.\n\nTest Suite:\n- Case 1 (general case): Sampling times $t_j = [5, 10, 20, 40, 60]$ (minutes), initial conditions $G_0 = 180$, $X_0 = 0$, insulin parameters $A = 50$, $\\alpha = 0.1$.\n- Case 2 (boundary case with no insulin variation): Sampling times $t_j = [5, 10, 20, 40, 60]$, initial conditions $G_0 = 150$, $X_0 = 0$, insulin parameters $A = 0$, $\\alpha = 0.1$.\n- Case 3 (edge case with sparse sampling): Sampling times $t_j = [1, 2]$, initial conditions $G_0 = 200$, $X_0 = 0$, insulin parameters $A = 50$, $\\alpha = 0.1$.\n- Case 4 (early-time sampling with small insulin perturbation): Sampling times $t_j = [0.5, 1.0, 1.5, 2.0, 3.0]$, initial conditions $G_0 = 90$, $X_0 = 0$, insulin parameters $A = 1$, $\\alpha = 0.2$.\n\nFor each case, construct $J(\\theta^*)$ from the computed sensitivities at the specified sampling times and return the matrix rank as an integer. The final output must be a single line containing the ranks of the four cases as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4]\"), where each $r_k$ is an integer. No physical units are required in the output, and no angles or percentages are involved. The program must be complete and runnable as-is, with no external input required.",
            "solution": "The user-provided problem is rigorously validated below.\n\n### Step 1: Extract Givens\n- **Model Equations**:\n  - $\\frac{dG}{dt} = -p_1\\,(G - G_b) - X\\,G$\n  - $\\frac{dX}{dt} = -p_2\\,X + p_3\\,(I(t) - I_b)$\n- **State Variables**: $G(t)$, $X(t)$\n- **Parameters to Analyze**: $\\theta = (p_1, p_2, p_3)$\n- **Constants and Knowns**:\n  - Basal glucose concentration: $G_b = 90$\n  - Basal insulin concentration: $I_b = 10$\n  - Parameter vector for analysis: $\\theta^* = (p_1, p_2, p_3) = (0.01, 0.02, 0.0005)$\n  - Exogenous insulin input: $I(t) = I_b + A\\,e^{-\\alpha t}$\n- **Initial Conditions**:\n  - $G(0) = G_0$\n  - $X(0) = X_0$\n  - The initial conditions are stated to be independent of the parameters $p_1, p_2, p_3$.\n- **Measured Output**: $y_j = G(t_j)$ at specified sampling times $t_j$.\n- **Sensitivity Variables**:\n  - $S_{G,p_i}(t) = \\frac{\\partial G(t)}{\\partial p_i}$\n  - $S_{X,p_i}(t) = \\frac{\\partial X(t)}{\\partial p_i}$\n- **Task**:\n  - Construct the Jacobian matrix $J(\\theta^*)$ with entries $J_{j,i} = S_{G,p_i}(t_j)$.\n  - Determine the matrix rank of $J(\\theta^*)$ for four specific test cases.\n- **Test Cases**:\n  - Case 1: $t_j = [5, 10, 20, 40, 60]$, $G_0 = 180$, $X_0 = 0$, $A = 50$, $\\alpha = 0.1$.\n  - Case 2: $t_j = [5, 10, 20, 40, 60]$, $G_0 = 150$, $X_0 = 0$, $A = 0$, $\\alpha = 0.1$.\n  - Case 3: $t_j = [1, 2]$, $G_0 = 200$, $X_0 = 0$, $A = 50$, $\\alpha = 0.1$.\n  - Case 4: $t_j = [0.5, 1.0, 1.5, 2.0, 3.0]$, $G_0 = 90$, $X_0 = 0$, $A = 1$, $\\alpha = 0.2$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n\n- **Scientifically Grounded**: The problem uses the Bergman minimal model, a cornerstone of glucose-insulin dynamics modeling in physiology and biomedical engineering. The method of sensitivity equations is a standard, rigorous technique in systems theory and parameter estimation. The problem is firmly rooted in established scientific and mathematical principles.\n- **Well-Posed**: The problem is well-defined. It provides a complete set of ordinary differential equations (ODEs), all necessary parameter values, initial conditions, and input functions. The task is to compute a deterministic quantity, the rank of a matrix, which is a well-defined mathematical operation. For each test case, the setup is complete, leading to a unique solution.\n- **Objective**: The language is precise and quantitative. All instructions are clear and unambiguous. There are no subjective or opinion-based statements.\n- **Completeness**: The problem is self-contained. All values and functions required for the solution are explicitly provided.\n- **Consistency**: The givens are internally consistent. There are no contradictions in the model equations, parameters, or conditions.\n- **Relevance**: The problem is directly on the topic of local one-at-a-time sensitivity analysis for a biomedical system model.\n\nThe problem does not exhibit any of the flaws listed in the validation criteria. It is scientifically sound, well-posed, objective, and complete.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Principle-Based Design\nThe core of this problem is to perform a local sensitivity analysis of the Bergman minimal model with respect to its parameters $p_1, p_2, p_3$. The sensitivity of the state variables to these parameters is quantified by their partial derivatives, which are themselves functions of time. The governing equations for these sensitivity functions are derived by differentiating the original model's ODEs with respect to each parameter. This results in a larger, augmented system of ODEs that can be solved numerically.\n\nThe state variables are $G(t)$ and $X(t)$, governed by:\n$$\n\\frac{dG}{dt} = f_G(G, X, p_1, p_2, p_3) = -p_1(G - G_b) - XG\n$$\n$$\n\\frac{dX}{dt} = f_X(X, p_1, p_2, p_3, t) = -p_2 X + p_3(I(t) - I_b)\n$$\nThe sensitivity variables are defined as $S_{G,p_i} = \\frac{\\partial G}{\\partial p_i}$ and $S_{X,p_i} = \\frac{\\partial X}{\\partial p_i}$ for $i=1,2,3$. Their dynamics are found by applying the chain rule, for example $\\frac{d}{dt} S_{G,p_i} = \\frac{\\partial f_G}{\\partial G}S_{G,p_i} + \\frac{\\partial f_G}{\\partial X}S_{X,p_i} + \\frac{\\partial f_G}{\\partial p_i}$. The required partial derivatives of the right-hand side functions are:\n- $\\frac{\\partial f_G}{\\partial G} = -p_1 - X$\n- $\\frac{\\partial f_G}{\\partial X} = -G$\n- $\\frac{\\partial f_G}{\\partial p_1} = -(G - G_b)$\n- $\\frac{\\partial f_G}{\\partial p_2} = 0$\n- $\\frac{\\partial f_G}{\\partial p_3} = 0$\n- $\\frac{\\partial f_X}{\\partial G} = 0$\n- $\\frac{\\partial f_X}{\\partial X} = -p_2$\n- $\\frac{\\partial f_X}{\\partial p_1} = 0$\n- $\\frac{\\partial f_X}{\\partial p_2} = -X$\n- $\\frac{\\partial f_X}{\\partial p_3} = I(t) - I_b$\n\nUsing these, we derive the set of ODEs for the sensitivities:\n1.  **Sensitivity to $p_1$**:\n    $$\n    \\frac{dS_{G,p_1}}{dt} = (-p_1 - X)S_{G,p_1} - G S_{X,p_1} - (G - G_b)\n    $$\n    $$\n    \\frac{dS_{X,p_1}}{dt} = -p_2 S_{X,p_1}\n    $$\n2.  **Sensitivity to $p_2$**:\n    $$\n    \\frac{dS_{G,p_2}}{dt} = (-p_1 - X)S_{G,p_2} - G S_{X,p_2}\n    $$\n    $$\n    \\frac{dS_{X,p_2}}{dt} = -p_2 S_{X,p_2} - X\n    $$\n3.  **Sensitivity to $p_3$**:\n    $$\n    \\frac{dS_{G,p_3}}{dt} = (-p_1 - X)S_{G,p_3} - G S_{X,p_3}\n    $$\n    $$\n    \\frac{dS_{X,p_3}}{dt} = -p_2 S_{X,p_3} + (I(t) - I_b)\n    $$\nThe problem states that the initial conditions $G(0)=G_0$ and $X(0)=X_0$ are independent of the parameters $p_i$. This implies that the initial sensitivities are zero:\n$$\nS_{G,p_i}(0) = \\frac{\\partial G_0}{\\partial p_i} = 0\n$$\n$$\nS_{X,p_i}(0) = \\frac{\\partial X_0}{\\partial p_i} = 0\n$$\nfor $i=1, 2, 3$.\n\nWe now construct an augmented state vector $Y(t) \\in \\mathbb{R}^8$:\n$$\nY(t) = [G, X, S_{G,p_1}, S_{X,p_1}, S_{G,p_2}, S_{X,p_2}, S_{G,p_3}, S_{X,p_3}]^T\n$$\nThe dynamics of this augmented system, $\\frac{dY}{dt} = F(t, Y)$, are given by the two original state equations and the six sensitivity equations. The initial condition vector is $Y(0) = [G_0, X_0, 0, 0, 0, 0, 0, 0]^T$.\n\nTo solve the problem, we integrate this $8$-dimensional ODE system from $t=0$ to the latest sampling time for each test case. We use a robust numerical solver, such as `scipy.integrate.solve_ivp`, which can handle potential stiffness in the system. The solver is configured to output the solution at the specific sampling times $t_j$.\n\nFrom the numerical solution, we extract the values of the glucose sensitivities $S_{G,p_i}(t_j)$ for $i=1,2,3$ at each sampling time $t_j$ for $j=1, \\dots, m$. These values form the $m \\times 3$ Jacobian matrix $J$:\n$$\nJ = \n\\begin{pmatrix}\n S_{G,p_1}(t_1) & S_{G,p_2}(t_1) & S_{G,p_3}(t_1) \\\\\n S_{G,p_1}(t_2) & S_{G,p_2}(t_2) & S_{G,p_3}(t_2) \\\\\n \\vdots & \\vdots & \\vdots \\\\\n S_{G,p_1}(t_m) & S_{G,p_2}(t_m) & S_{G,p_3}(t_m)\n\\end{pmatrix}\n$$\nThe final step is to compute the rank of this matrix $J$ using a standard numerical linear algebra routine, such as `numpy.linalg.matrix_rank`, which typically employs Singular Value Decomposition (SVD) for a numerically stable computation. This process is repeated for each of the four test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the Bergman minimal model sensitivity analysis problem for four test cases.\n    \"\"\"\n    \n    # Global parameters and constants\n    p1_star, p2_star, p3_star = 0.01, 0.02, 0.0005\n    Gb, Ib = 90.0, 10.0\n\n    # Test cases as defined in the problem statement\n    test_cases = [\n        {\n            \"t_j\": [5, 10, 20, 40, 60],\n            \"G0\": 180.0, \"X0\": 0.0,\n            \"A\": 50.0, \"alpha\": 0.1\n        },\n        {\n            \"t_j\": [5, 10, 20, 40, 60],\n            \"G0\": 150.0, \"X0\": 0.0,\n            \"A\": 0.0, \"alpha\": 0.1\n        },\n        {\n            \"t_j\": [1.0, 2.0],\n            \"G0\": 200.0, \"X0\": 0.0,\n            \"A\": 50.0, \"alpha\": 0.1\n        },\n        {\n            \"t_j\": [0.5, 1.0, 1.5, 2.0, 3.0],\n            \"G0\": 90.0, \"X0\": 0.0,\n            \"A\": 1.0, \"alpha\": 0.2\n        }\n    ]\n\n    def ode_system(t, y, p1, p2, p3, Gb_val, Ib_val, A_val, alpha_val):\n        \"\"\"\n        Defines the augmented ODE system including states and sensitivities.\n        State vector y:\n        y[0]: G(t)\n        y[1]: X(t)\n        y[2]: S_G,p1(t)\n        y[3]: S_X,p1(t)\n        y[4]: S_G,p2(t)\n        y[5]: S_X,p2(t)\n        y[6]: S_G,p3(t)\n        y[7]: S_X,p3(t)\n        \"\"\"\n        G, X, SGp1, SXp1, SGp2, SXp2, SGp3, SXp3 = y\n        \n        # Insulin input\n        I_minus_Ib = A_val * np.exp(-alpha_val * t)\n\n        # Original state equations\n        dG_dt = -p1 * (G - Gb_val) - X * G\n        dX_dt = -p2 * X + p3 * I_minus_Ib\n        \n        # Sensitivity equations\n        # w.r.t p1\n        dSGp1_dt = (-p1 - X) * SGp1 - G * SXp1 - (G - Gb_val)\n        dS_Xp1_dt = -p2 * SXp1\n        \n        # w.r.t p2\n        dSGp2_dt = (-p1 - X) * SGp2 - G * SXp2\n        dSXp2_dt = -p2 * SXp2 - X\n\n        # w.r t p3\n        dSGp3_dt = (-p1 - X) * SGp3 - G * SXp3\n        dSXp3_dt = -p2 * SXp3 + I_minus_Ib\n\n        return [dG_dt, dX_dt, dSGp1_dt, dS_Xp1_dt, dSGp2_dt, dSXp2_dt, dSGp3_dt, dSXp3_dt]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack case parameters\n        t_j = case[\"t_j\"]\n        G0, X0 = case[\"G0\"], case[\"X0\"]\n        A, alpha = case[\"A\"], case[\"alpha\"]\n\n        # Initial conditions for the augmented system\n        y0 = [G0, X0, 0, 0, 0, 0, 0, 0]\n        \n        # Time span for integration\n        t_span = (0, max(t_j))\n        \n        # Parameters to pass to the ODE function\n        args = (p1_star, p2_star, p3_star, Gb, Ib, A, alpha)\n        \n        # Solve the augmented ODE system\n        # LSODA is a good choice for systems that may be stiff or non-stiff.\n        sol = solve_ivp(\n            ode_system, \n            t_span, \n            y0, \n            method='LSODA', \n            t_eval=t_j, \n            args=args,\n            rtol=1e-6, \n            atol=1e-9\n        )\n        \n        # Extract sensitivities for glucose w.r.t. p1, p2, p3\n        # SGp1 is at index 2, SGp2 at 4, SGp3 at 6\n        SGp1_vals = sol.y[2]\n        SGp2_vals = sol.y[4]\n        SGp3_vals = sol.y[6]\n        \n        # Construct the Jacobian (Sensitivity) matrix J\n        J = np.vstack([SGp1_vals, SGp2_vals, SGp3_vals]).T\n        \n        # Compute the rank of J\n        rank = np.linalg.matrix_rank(J)\n        results.append(rank)\n\n    # Print the final result in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}