{
    "hands_on_practices": [
        {
            "introduction": "本实践旨在从第一性原理出发，为热惯量这一核心概念奠定坚实的物理基础。通过求解一个受周期性能量强迫的半无限介质中的一维热传导方程，您将亲自推导出热惯量 $I = \\sqrt{k \\rho c}$ 的表达式 。这项练习不仅在于计算一个数值，更在于深刻理解为何这一物理量的组合能够决定地表对昼夜温度变化的响应幅度。",
            "id": "3861490",
            "problem": "在一个晴天，一个热红外（TIR）遥感仪器观测到一片均质、干燥的壤土。假设地表的上边界受到一个日变化的净热通量强迫，该强迫可以近似为单频正弦波，并且地下可以被视为半无限介质。该土壤的特征是热导率 $k$、容重 $\\rho$ 和比热容 $c$。利用第一性原理的热传输理论，推导出一个用于量化材料在日循环中抵抗地表温度变化的特性的恰当表达式，然后计算给定土壤的该属性值。\n\n给定 $k=1.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$，$\\rho=1600\\,\\mathrm{kg\\,m^{-3}}$ 和 $c=800\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$：\n- 推导出综合 $k$、$\\rho$ 和 $c$ 以表征土壤抵抗日温度波动趋势的物理量，然后计算其数值。将您的数值答案四舍五入到四位有效数字，并以 $\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$ 为单位表示。\n- 在振幅为 $q_{0}$、角频率为 $\\omega$ 的相同正弦地表热通量强迫（代表日循环）下，根据热传导的控制定律，论证当 $k$ 加倍与当 $c$ 加倍时，日地表温度振幅是增加还是减少，并确定每种情况下振幅变化的乘数因子。您的论证应基于物理上清晰的步骤（能量储存和扩散），而不是记忆的最终公式。\n\n您的最终数值答案应该是上面指出的聚合属性的计算值。四舍五入到四位有效数字。",
            "solution": "该问题要求基于热传递的第一性原理，推导并计算一个量化土壤对日温度变化抵抗能力的材料属性。它还要求对热导率和比热容如何分别影响这种温度响应给出物理解释。\n\n物理系统被建模为一维、半无限、均质的介质（土壤），其热传输由热传导方程控制。假设没有内部热源，该方程为：\n$$ \\frac{\\partial T(z, t)}{\\partial t} = \\alpha \\frac{\\partial^2 T(z, t)}{\\partial z^2} $$\n其中 $T$ 是在深度 $z$（从地表 $z=0$ 处向下为正）和时间 $t$ 处的温度。参数 $\\alpha$ 是热扩散率，定义为：\n$$ \\alpha = \\frac{k}{\\rho c} $$\n其中 $k$ 是热导率，$\\rho$ 是容重， $c$ 是比热容。\n\n地表（$z=0$）的上边界受到一个正弦变化的净热通量，代表了白天的太阳加热和夜间的冷却的日循环。为数学上的方便，我们可以使用复数表示法来表示这个强迫，其中物理通量是其实部：\n$$ q(0, t) = q_0 \\cos(\\omega t) = \\text{Re}\\{q_0 \\exp(i\\omega t)\\} $$\n这里，$q_0$ 是净热通量的振幅，$\\omega$ 是日循环的角频率，其中 $\\omega=2\\pi/P$，$P$ 是周期（例如，$24$ 小时）。\n\n地表热通量通过傅里叶热传导定律与温度梯度相关：\n$$ q(z, t) = -k \\frac{\\partial T(z, t)}{\\partial z} $$\n将其应用于地表，得到边界条件：\n$$ q_0 \\exp(i\\omega t) = -k \\left. \\frac{\\partial T}{\\partial z} \\right|_{z=0} $$\n请注意，我们在方程两边都使用了复数形式，并理解物理量是它们的实部。\n\n我们寻求由此通量驱动的温度扰动 $T'(z,t)$ 的周期解。我们假设解的形式为传播到介质中的热波：\n$$ T'(z, t) = \\text{Re}\\{\\hat{T}(z) \\exp(i\\omega t)\\} $$\n其中 $\\hat{T}(z)$ 是深度 $z$ 处温度波动的复振幅。将其代入热传导方程，得到关于 $\\hat{T}(z)$ 的常微分方程：\n$$ i\\omega \\hat{T}(z) = \\alpha \\frac{d^2 \\hat{T}(z)}{dz^2} \\implies \\frac{d^2 \\hat{T}}{dz^2} - \\frac{i\\omega}{\\alpha}\\hat{T} = 0 $$\n该方程的通解是 $\\hat{T}(z) = C_1 \\exp(\\lambda z) + C_2 \\exp(-\\lambda z)$，其中 $\\lambda^2 = i\\omega/\\alpha$。\n因此，$\\lambda = \\sqrt{i\\omega/\\alpha} = \\sqrt{i} \\sqrt{\\omega/\\alpha}$。因为 $\\sqrt{i} = \\exp(i\\pi/4) = (1+i)/\\sqrt{2}$，我们有：\n$$ \\lambda = \\frac{1+i}{\\sqrt{2}} \\sqrt{\\frac{\\omega}{\\alpha}} = (1+i)\\sqrt{\\frac{\\omega}{2\\alpha}} $$\n介质是半无限的（$z \\in [0, \\infty)$）。为了使解具有物理现实性，温度波动必须随着深度的无限增加而衰减至零（当 $z \\to \\infty$ 时，$ T' \\to 0 $）。项 $\\exp(\\lambda z)$ 随 $z$ 增长，因此其系数 $C_1$ 必须为零。这样剩下：\n$$ \\hat{T}(z) = C_2 \\exp(-\\lambda z) = \\hat{T}_s \\exp(-\\lambda z) $$\n其中 $\\hat{T}_s = C_2$ 是地表（$z=0$）的复温度振幅。\n\n现在我们通过先对 $\\hat{T}(z)$ 求导来应用地表通量边界条件：\n$$ \\frac{d\\hat{T}}{dz} = -\\lambda \\hat{T}_s \\exp(-\\lambda z) $$\n在地表 $z=0$ 处，这给出 $\\frac{d\\hat{T}}{dz}|_{z=0} = -\\lambda \\hat{T}_s$。代入边界条件的复数形式：\n$$ q_0 = -k \\left( -\\lambda \\hat{T}_s \\right) = k \\lambda \\hat{T}_s $$\n我们现在可以解出地表温度振幅 $\\hat{T}_s$：\n$$ \\hat{T}_s = \\frac{q_0}{k\\lambda} = \\frac{q_0}{k \\sqrt{i\\omega/\\alpha}} = \\frac{q_0}{\\sqrt{k^2(i\\omega/\\alpha)}} = \\frac{q_0}{\\sqrt{i k^2 \\omega / (k/(\\rho c))}} = \\frac{q_0}{\\sqrt{i k \\rho c \\omega}} $$\n地表温度波动的物理振幅 $T_{amp}$ 是复振幅 $\\hat{T}_s$ 的模：\n$$ T_{amp} = |\\hat{T}_s| = \\left| \\frac{q_0}{\\sqrt{i} \\sqrt{k \\rho c \\omega}} \\right| = \\frac{|q_0|}{|\\sqrt{i}| \\cdot |\\sqrt{k \\rho c \\omega}|} $$\n因为 $|\\sqrt{i}| = 1$，表达式简化为：\n$$ T_{amp} = \\frac{q_0}{\\sqrt{k \\rho c \\omega}} $$\n这个方程表明，对于给定的热通量强迫（固定的 $q_0$ 和 $\\omega$），产生的地表温度振幅与项 $\\sqrt{k \\rho c}$ 成反比。因此，材料对温度变化的抵抗能力与该项成正比。量化这种抵抗能力的聚合属性是**热惯量**（thermal inertia），$P_T$：\n$$ P_T = \\sqrt{k \\rho c} $$\n更高的热惯量意味着对温度变化的抵抗能力更强。\n\n接下来，我们为给定的土壤属性计算热惯量的数值：\n$k=1.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n$\\rho=1600\\,\\mathrm{kg\\,m^{-3}}$\n$c=800\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n\n乘积 $k \\rho c$ 为：\n$$ k \\rho c = (1.5) \\times (1600) \\times (800) = 1,920,000 $$\n单位是 $(\\mathrm{W\\,m^{-1}\\,K^{-1}}) \\times (\\mathrm{kg\\,m^{-3}}) \\times (\\mathrm{J\\,kg^{-1}\\,K^{-1}}) = (\\mathrm{J\\,s^{-1}\\,m^{-1}\\,K^{-1}}) \\times (\\mathrm{kg\\,m^{-3}}) \\times (\\mathrm{J\\,kg^{-1}\\,K^{-1}}) = \\mathrm{J^2\\,s^{-1}\\,m^{-4}\\,K^{-2}}$。\n热惯量 $P_T$ 是其平方根：\n$$ P_T = \\sqrt{1,920,000} \\approx 1385.6406... \\,\\, \\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}} $$\n四舍五入到四位有效数字，我们得到：\n$$ P_T = 1386 \\,\\, \\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}} $$\n\n最后，我们从物理原理分析改变 $k$ 和 $c$ 对地表温度振幅 $T_{amp}$ 的影响。任何时刻的地表温度都是地表能量通量与地下介质储存这种能量（由体积热容 $\\rho c$ 决定）并将其从地表传输走（由热导率 $k$ 决定）的能力之间动态平衡的结果。\n\n情况1：热导率加倍（$k \\to 2k$）\n当 $k$ 加倍时，土壤的热传导能力增强。在白天，当地表吸收净辐射时，这些能量更迅速、更有效地被传输（扩散）到较冷的地下。这种从紧邻地表层快速移除能量的方式意味着更少的能量在顶层积聚，导致温度升高较小。在夜晚，当地表通过辐射散热而冷却时，更高的 $k$ 使得来自较暖地下的热量能更有效地传导回地表，从而减缓了冷却速率。这两种效应都会缓和温度的极端变化。因此，日地表温度振幅**减小**。\n\n情况2：比热容加倍（$c \\to 2c$）\n当 $c$ 加倍时，体积热容 $\\rho c$ 也加倍。这意味着将单位体积土壤的温度升高一度需要两倍的热能。在白天，当地表吸收给定量的净热通量时，这种增加的储能能力意味着地表层的温度上升得更慢，幅度更小。材料充当了一个更大的热储库。在夜晚，土壤储存了更多的热量，必须失去更多的热量才能冷却相同的度数，从而减缓了冷却过程。这种缓冲效应也缓和了温度的极端变化。因此，日地表温度振幅**减小**。\n\n为了确定变化的乘数因子，我们使用推导出的关系 $T_{amp} \\propto 1/\\sqrt{k \\rho c}$。设初始振幅为 $T_{amp, i}$。\n如果 $k \\to 2k$，新的振幅 $T_{amp, k}$ 是：\n$$ T_{amp, k} \\propto \\frac{1}{\\sqrt{(2k)\\rho c}} = \\frac{1}{\\sqrt{2}} \\frac{1}{\\sqrt{k\\rho c}} \\implies T_{amp, k} = \\frac{1}{\\sqrt{2}} T_{amp, i} $$\n如果 $c \\to 2c$，新的振幅 $T_{amp, c}$ 是：\n$$ T_{amp, c} \\propto \\frac{1}{\\sqrt{k\\rho(2c)}} = \\frac{1}{\\sqrt{2}} \\frac{1}{\\sqrt{k\\rho c}} \\implies T_{amp, c} = \\frac{1}{\\sqrt{2}} T_{amp, i} $$\n在这两种情况下，振幅都减小了 $1/\\sqrt{2}$ 的乘数因子。",
            "answer": "$$\\boxed{1386}$$"
        },
        {
            "introduction": "在理解了热惯量的物理定义之后，下一步是将其置于更宏观的环境系统中进行考察。本练习将热惯量与地表能量平衡（地气相互作用的核心框架）联系起来，您将通过分析一个典型白天的能量通量数据来估算地表热通量$G$ 。此过程将帮助您掌握如何根据能量在不同路径（如加热大气或加热土壤）上的分配，来判断地表热惯量的高低，这是利用热遥感数据反演土壤水分和评估干旱状况的关键技能。",
            "id": "3861467",
            "problem": "在一个晴空正午、水平均匀的陆地表面情景下，考虑由陆-气界面能量守恒推导出的垂直积分地表能量收支。可测量的通量有净辐射 ($R_n$)、感热通量 ($H$)、潜热通量 ($\\lambda E$) 和地（土）热通量 ($G$)。假设适用于正午条件的单层能量闭合：忽略冠层内和气柱中的能量储存项、水平平流以及光合作用热储存，因此主要能量交换途径是辐射交换、湍流交换以及向基底的传导交换。使用常规符号约定，其中 $R_n$ 向下（朝向地表）为正，$H$ 和 $\\lambda E$ 向上（离开地表）为正，$G$ 向下（进入基底）为正。热惯量 $I$ 定义为 $I=\\sqrt{k\\,\\rho\\,c}$，其中 $k$ 是热导率，$\\rho$ 是密度，$c$ 是比热容。\n\n从能量守恒定律出发，在上述假设下，推导用 $R_n$、$H$ 和 $\\lambda E$ 表示 $G$ 的表达式，然后利用典型的正午通量值 $R_n=600\\,\\mathrm{W\\,m^{-2}}$、$H=250\\,\\mathrm{W\\,m^{-2}}$ 和 $\\lambda E=250\\,\\mathrm{W\\,m^{-2}}$ 计算 $G$。最后，根据传入地下的 $R_n$ 比例，解释 $G$ 的计算值更符合高热惯量表面还是低热惯量表面。\n\n以 $\\mathrm{W\\,m^{-2}}$ 为单位表示 $G$ 的数值。无需四舍五入。",
            "solution": "首先验证问题以确保其科学上成立、适定且客观。\n\n**步骤1：提取已知条件**\n- **系统**：晴空正午条件下的水平均匀陆地表面。\n- **模型**：垂直积分地表能量收支由陆-气界面能量守恒方程描述。\n- **通量**：净辐射 ($R_n$)、感热通量 ($H$)、潜热通量 ($\\lambda E$) 和地（土）热通量 ($G$)。\n- **假设**：忽略冠层内和气柱中的能量储存项、水平平流以及光合作用热储存。主要的能量途径是辐射、湍流和传导交换。\n- **符号约定**：\n    - $R_n$ 向下（朝向地表）为正。\n    - $H$ 向上（离开地表）为正。\n    - $\\lambda E$ 向上（离开地表）为正。\n    - $G$ 向下（进入基底）为正。\n- **定义**：热惯量为 $I=\\sqrt{k\\,\\rho\\,c}$，其中 $k$ 是热导率，$\\rho$ 是密度，$c$ 是比热容。\n- **数值**：$R_n=600\\,\\mathrm{W\\,m^{-2}}$，$H=250\\,\\mathrm{W\\,m^{-2}}$，$\\lambda E=250\\,\\mathrm{W\\,m^{-2}}$。\n- **任务**：\n    1. 推导用 $R_n$、$H$ 和 $\\lambda E$ 表示 $G$ 的表达式。\n    2. 使用给定的数值计算 $G$。\n    3. 解释结果是否与高或低热惯量（$I$）表面一致。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础**：该问题基于能量守恒原理，这是一条基本的物理定律。地表能量平衡方程是微气象学、气候学和环境遥感学的基石。所做的假设是针对正午、晴空情景的标准简化。热惯量的定义是正确的。该问题在科学上是合理的。\n- **适定性**：问题陈述清晰，提供了所有必要的数据和定义（包括关键的符号约定），并要求进行推导、计算和物理解释。这种结构导向一个唯一且有意义的解。\n- **客观性**：问题以精确、客观的语言表述。为通量提供的数值在指定条件下是物理上现实的。\n\n**步骤3：结论与行动**\n该问题有效。它在科学上合理，自成体系且适定。可以继续求解过程。\n\n**求解推导与解释**\n\n首先要应用的原理是地表界面的能量守恒。在所述假设下，供给地表的净能量通量必须被离开地表的能量通量之和所平衡。\n\n净辐射 $R_n$ 代表净入射辐射能量通量。根据符号约定，正的 $R_n$ 是地表的能量增益。\n\n感热通量 $H$ 和潜热通量 $\\lambda E$ 分别代表通过湍流和相变从地表传输到大气的能量。根据符号约定，正的 $H$ 和 $\\lambda E$ 是地表的能量损失。\n\n地热通量 $G$ 代表从地表传导到土壤中的能量。根据符号约定，正的 $G$ 是从地表界面到其下方地下的能量损失。\n\n因此，将主要能量源与能量汇的总和相等的能量平衡方程为：\n$$R_n = H + \\lambda E + G$$\n\n第一个任务是推导 $G$ 的表达式。通过重新排列能量平衡方程中的各项，我们分离出 $G$：\n$$G = R_n - H - \\lambda E$$\n\n第二个任务是使用给定的数值计算 $G$：$R_n = 600\\,\\mathrm{W\\,m^{-2}}$，$H = 250\\,\\mathrm{W\\,m^{-2}}$，以及 $\\lambda E = 250\\,\\mathrm{W\\,m^{-2}}$。将这些值代入 $G$ 的表达式中：\n$$G = 600\\,\\mathrm{W\\,m^{-2}} - 250\\,\\mathrm{W\\,m^{-2}} - 250\\,\\mathrm{W\\,m^{-2}}$$\n$$G = 600\\,\\mathrm{W\\,m^{-2}} - 500\\,\\mathrm{W\\,m^{-2}}$$\n$$G = 100\\,\\mathrm{W\\,m^{-2}}$$\n\n第三个任务是在热惯量 $I$ 的背景下解释这个结果。热惯量 $I = \\sqrt{k\\,\\rho\\,c}$ 量化了材料在受到加热或冷却时抵抗温度变化的能力。\n\n具有**高热惯量**的表面（例如，湿土、水）具有高热导率 $k$ 和/或高体积热容 $\\rho c$。它可以有效地传导和储存热能。当暴露于太阳辐射时，净辐射 $R_n$ 的一大部分被传导到地下。这导致较大的地热通量 $G$ 和相对较小的地表温度升高。因此，由地-气温差和湿度差驱动的湍流通量（$H$ 和 $\\lambda E$）相对于 $R_n$ 较小。对于高 $I$ 表面，比率 $G/R_n$ 相对较大（通常 > 0.3）。\n\n具有**低热惯量**的表面（例如，干沙、绝热材料）具有低热导率和/或低体积热容。它不能有效地传导或储存热量。当暴露于太阳辐射时，只有很少的能量被传导到地下（$G$ 很小），导致地表温度迅速升高。这种大的地表温度升高会驱动大的湍流通量（$H$ 和 $\\lambda E$）将能量耗散到大气中。对于低 $I$ 表面，比率 $G/R_n$ 相对较小（通常 < 0.15）。\n\n在本问题中，我们计算分配到地热通量中的净辐射比例：\n$$\\frac{G}{R_n} = \\frac{100\\,\\mathrm{W\\,m^{-2}}}{600\\,\\mathrm{W\\,m^{-2}}} = \\frac{1}{6} \\approx 0.167$$\n这个值表明，只有大约 $16.7\\%$ 的可用净辐射被传导到地下。大部分能量，$H + \\lambda E = 500\\,\\mathrm{W\\,m^{-2}}$，或大约 $R_n$ 的 $83.3\\%$，被传输到大气中。这种能量强烈地分配到湍流通量而弱地分配到地下储存的特点，是表面快速升温的特征，这是**低热惯量**表面的典型行为特征。",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "现实世界中的遥感像素往往是多种地物的混合体，这为物理量的反演带来了挑战。本高级实践要求您编写一个仿真模型，模拟一个由不同组分构成的混合像元的地表温度日变化曲线 。通过这个过程，您将计算出像元的“表观热惯量”（ATI），并深刻体会到材料的本征物理属性（热惯量$I$）与遥感传感器在像元尺度上观测到的表观属性之间的区别与联系，这是定量遥感研究中一个至关重要的问题。",
            "id": "3861493",
            "problem": "您将执行一项遥感和环境建模领域的物理建模任务。考虑一个由两个均质地表组分组成的亚像元混合物，在天底观测（垂直入射）下进行观察。每个组分被建模为一个半无限介质，遵循一维热传导，并具有模拟日循环的周期性地表热通量边界条件。目标是模拟每个组分的日地表温度（LST）曲线，并使用公认的遥感实践方法计算像元的表观热惯量（ATI）。\n\n假设与所需推导：\n- 从半无限半空间中的一维热传导方程开始，采用正弦地表热通量边界条件。推导在角频率为 $\\omega$ 的周期性强迫下，地表温度响应与材料热学性质之间的关系。热惯量定义为 $I=\\sqrt{k \\,\\rho \\,c}$，其中 $k$ 是热导率，$\\rho$ 是密度， $c$ 是比热容。\n- 假设进入地下的净热通量是地表吸收的短波辐射的固定部分。设吸收的短波振幅为 $(1-\\alpha)\\,S_{\\mathrm{amp}}$，其中 $\\alpha$ 是宽波段反照率， $S_{\\mathrm{amp}}$ 是入射短波辐射的振幅。设此吸收振幅的一个恒定比例 $f_g$ 以振幅为 $q_0=f_g\\,(1-\\alpha)\\,S_{\\mathrm{amp}}$ 的正弦边界热通量形式传导至地下。\n- 将每个组分的日 LST 响应推导为一个余弦函数，其相对于强迫的相位滞后与传导解一致。使用一个恒定的基线温度 $T_0$作为日变化的平均值。\n- 在天底观测下，假设组分 LST 的线性面积混合构成了像元 LST：对于组分权重 $w_1$ 和 $w_2$，表观像元 LST 是加权平均值 $T_p(t)=w_1\\,T_1(t)+w_2\\,T_2(t)$，且 $w_1+w_2=1$。对于陆地表面典型的较小日振幅，将 LST 空间中的混合视为热辐射混合的一阶近似。\n- 使用遥感中对像元的表观热惯量（ATI）的定义：$\\mathrm{ATI}_p=\\dfrac{1-\\alpha_p}{\\Delta T_p}$，其中 $\\alpha_p=w_1\\,\\alpha_1+w_2\\,\\alpha_2$ 是面积平均反照率，$\\Delta T_p$ 是一个周期内的日 LST 范围（最大值减去最小值）。将 $\\mathrm{ATI}_p$ 表示为一个无量纲浮点数。\n\n单位与数值要求：\n- 热惯量 $I$ 的单位必须是 $\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$。\n- 短波振幅 $S_{\\mathrm{amp}}$ 和热通量 $q_0$ 的单位必须是 $\\mathrm{W\\,m^{-2}}$。\n- 周期 $P$ 的单位必须是 $\\mathrm{s}$，角度单位必须是弧度。\n- 温度必须以开尔文表示。\n- 最终结果必须是四舍五入到 $6$ 位小数的浮点数。\n\n您的程序必须：\n- 为每个测试案例，在一个周期内实现推导出的日 LST 曲线 $T_1(t)$ 和 $T_2(t)$，使用足够精细的时间离散化来捕捉最大值和最小值。\n- 为每个测试案例计算 $\\Delta T_p$ 和 $\\alpha_p$，然后计算 $\\mathrm{ATI}_p$。\n- 生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表，例如 $[\\text{result1},\\text{result2},\\text{result3}]$。\n\n测试套件（为所有案例提供结果）：\n- 案例 $1$（给定缩略情景，理想路径）：双组分像元，$w_1=0.5$，$w_2=0.5$；热惯量 $I_1=2500\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$，$I_2=900\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$；反照率 $\\alpha_1=0.15$，$\\alpha_2=0.35$；基线温度 $T_0=300\\,\\mathrm{K}$；短波振幅 $S_{\\mathrm{amp}}=800\\,\\mathrm{W\\,m^{-2}}$；地表热通量比例 $f_g=0.25$；周期 $P=86400\\,\\mathrm{s}$。\n- 案例 $2$（一致性检查，相同组分）：$w_1=0.5$，$w_2=0.5$；$I_1=1500\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$，$I_2=1500\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$；$\\alpha_1=0.25$，$\\alpha_2=0.25$；$T_0=300\\,\\mathrm{K}$；$S_{\\mathrm{amp}}=800\\,\\mathrm{W\\,m^{-2}}$；$f_g=0.25$；$P=86400\\,\\mathrm{s}$。\n- 案例 $3$（低强迫边缘案例）：$w_1=0.5$，$w_2=0.5$；$I_1=2500\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$，$I_2=900\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$；$\\alpha_1=0.15$，$\\alpha_2=0.35$；$T_0=300\\,\\mathrm{K}$；$S_{\\mathrm{amp}}=1\\,\\mathrm{W\\,m^{-2}}$；$f_g=0.25$；$P=86400\\,\\mathrm{s}$。\n- 案例 $4$（对比材料）：$w_1=0.2$，$w_2=0.8$；$I_1=1600\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$（类水），$I_2=900\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$（沙土）；$\\alpha_1=0.06$，$\\alpha_2=0.35$；$T_0=300\\,\\mathrm{K}$；$S_{\\mathrm{amp}}=800\\,\\mathrm{W\\,m^{-2}}$；$f_g=0.25$；$P=86400\\,\\mathrm{s}$。\n- 案例 $5$（单组分极限）：$w_1=1.0$，$w_2=0.0$；$I_1=2500\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$，$I_2=900\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$；$\\alpha_1=0.15$，$\\alpha_2=0.35$；$T_0=300\\,\\mathrm{K}$；$S_{\\mathrm{amp}}=800\\,\\mathrm{W\\,m^{-2}}$；$f_g=0.25$；$P=86400\\,\\mathrm{s}$。\n\n最终输出规范：\n- 您的程序应生成一行输出，其中包含五个案例的 $\\mathrm{ATI}_p$ 值，格式为用方括号括起来的逗号分隔列表。每个值必须四舍五入到 $6$ 位小数，例如 $[\\text{v}_1,\\text{v}_2,\\text{v}_3,\\text{v}_4,\\text{v}_5]$。",
            "solution": "用户提供的问题已经过评估，并被确定为有效。其前提在科学上基于热传导原理，问题设定良好，目标明确，数据充分，语言客观正式。可以按照大纲进行推导和计算。注意到最终结果的量纲存在一个微小的不一致，但这不影响问题的核心结构。\n\n目标是基于日地表温度变化的物理模型，计算双组分亚像元混合物的表观热惯量（$\\mathrm{ATI}_p$）。\n\n解决方案通过以下顺序步骤展开：\n$1$. 推导均质半无限介质对周期性地表热通量的地表温度响应。\n$2$. 将此模型应用于像元内的两个组分中的每一个。\n$3$. 结合各组分的温度，求出像元平均地表温度（$LST$）及其日较差（$\\Delta T_p$）。\n$4$. 使用遥感中对 $\\mathrm{ATI}_p$ 的定义来计算最终值。\n\n**步骤 1：地表温度响应的推导**\n\n问题始于半无限介质（$z \\ge 0$）的一维热传导方程：\n$$\n\\frac{\\partial T(z, t)}{\\partial t} = \\kappa \\frac{\\partial^2 T(z, t)}{\\partial z^2}\n$$\n其中 $T$ 是温度，$z$ 是深度，$t$ 是时间，$\\kappa = k / (\\rho c)$ 是热扩散率，$k$ 是热导率，$\\rho$ 是密度，$c$ 是比热容。\n\n在 $z=0$ 处的地表边界条件是周期性热通量，代表了驱动地表热传导的太阳辐射部分。我们将其建模为简谐强迫：\n$$\n-k \\frac{\\partial T}{\\partial z}\\bigg|_{z=0} = q(t) = q_0 \\cos(\\omega t)\n$$\n其中 $q_0$ 是地表热通量的振幅，$\\omega = 2\\pi/P$ 是日周期 $P$ 的角频率。选择余弦函数将峰值通量设置在 $t=0$（太阳正午）。\n\n我们寻求形式为 $T(z, t) = T_0 + \\Re\\{\\hat{T}(z) e^{i\\omega t}\\}$ 的稳态周期解，其中 $T_0$ 是平均温度，$\\hat{T}(z)$ 是作为深度函数的复温度振幅。将此代入热方程，得到关于 $\\hat{T}(z)$ 的常微分方程：\n$$\n\\frac{d^2 \\hat{T}}{dz^2} - \\frac{i\\omega}{\\kappa}\\hat{T} = 0\n$$\n通解为 $\\hat{T}(z) = A \\exp\\left(-(1+i)\\sqrt{\\frac{\\omega}{2\\kappa}}z\\right) + B \\exp\\left(+(1+i)\\sqrt{\\frac{\\omega}{2\\kappa}}z\\right)$。温度波动必须在介质深处（$z \\to \\infty$）消失的条件要求 $B=0$。\n\n系数 $A$ 通过在复数域中应用地表通量边界条件 $-k\\frac{d\\hat{T}}{dz}\\big|_{z=0} = q_0$ 求得：\n$$\n-k \\left[ -A(1+i)\\sqrt{\\frac{\\omega}{2\\kappa}} \\right] = q_0 \\implies A = \\frac{q_0}{k(1+i)\\sqrt{\\frac{\\omega}{2\\kappa}}}\n$$\n使用热惯量定义 $I = \\sqrt{k\\rho c}$，我们可以简化分母：$k\\sqrt{\\frac{\\omega}{2\\kappa}} = k\\sqrt{\\frac{\\omega \\rho c}{2k}} = \\sqrt{\\frac{k\\omega\\rho c}{2}} = I\\sqrt{\\frac{\\omega}{2}}$。\n代入此式，我们得到：\n$$\nA = \\frac{q_0}{I(1+i)\\sqrt{\\frac{\\omega}{2}}} = \\frac{q_0(1-i)}{I(2)\\sqrt{\\frac{\\omega}{2}}} = \\frac{q_0(1-i)}{I\\sqrt{2\\omega}}\n$$\n复振幅 $A$ 的模为 $|A| = \\frac{q_0}{I\\sqrt{\\omega}}$，相位为 $\\arg(A) = -\\pi/4$。\n因此，地表温度（$z=0$）响应为：\n$$\nT_s(t) = T_0 + \\Re\\{A e^{i\\omega t}\\} = T_0 + |A| \\cos(\\omega t + \\arg(A)) = T_0 + \\frac{q_0}{I\\sqrt{\\omega}} \\cos\\left(\\omega t - \\frac{\\pi}{4}\\right)\n$$\n该方程表明，地表温度以振幅 $\\Delta T_{\\mathrm{amp}} = \\frac{q_0}{I\\sqrt{\\omega}}$ 振荡，并滞后于峰值热通量一个 $\\pi/4$ 的相位，这对应于 $P/8$ 的时间延迟，即对于一个 24 小时的周期为 3 小时。\n\n**步骤 2：组分 LST 计算**\n\n对于像元中的每个组分 $j$（其中 $j \\in \\{1, 2\\}$），我们应用推导出的公式。热通量振幅 $q_{0,j}$ 由 $q_{0,j} = f_g (1-\\alpha_j) S_{\\mathrm{amp}}$ 给出，其中 $\\alpha_j$ 是组分的反照率，$S_{\\mathrm{amp}}$ 是短波辐射振幅，$f_g$ 是地表热通量比例。\n组分 $j$ 的温度振幅为：\n$$\n\\Delta T_{\\mathrm{amp}, j} = \\frac{q_{0,j}}{I_j\\sqrt{\\omega}} = \\frac{f_g (1-\\alpha_j) S_{\\mathrm{amp}}}{I_j\\sqrt{\\omega}}\n$$\n因此，组分 $j$ 的日 LST 曲线为：\n$$\nT_j(t) = T_0 + \\Delta T_{\\mathrm{amp}, j} \\cos\\left(\\omega t - \\frac{\\pi}{4}\\right)\n$$\n\n**步骤 3：像元平均 LST 和日较差**\n\n像元的表观 LST，$T_p(t)$，是组分温度的线性面积平均值：\n$$\nT_p(t) = w_1 T_1(t) + w_2 T_2(t)\n$$\n其中 $w_1$ 和 $w_2$ 是面积分数（$w_1+w_2=1$）。代入 $T_1(t)$ 和 $T_2(t)$ 的表达式：\n$$\nT_p(t) = w_1 \\left[T_0 + \\Delta T_{\\mathrm{amp}, 1} \\cos\\left(\\omega t - \\frac{\\pi}{4}\\right)\\right] + w_2 \\left[T_0 + \\Delta T_{\\mathrm{amp}, 2} \\cos\\left(\\omega t - \\frac{\\pi}{4}\\right)\\right]\n$$\n$$\nT_p(t) = (w_1+w_2)T_0 + (w_1 \\Delta T_{\\mathrm{amp}, 1} + w_2 \\Delta T_{\\mathrm{amp}, 2}) \\cos\\left(\\omega t - \\frac{\\pi}{4}\\right)\n$$\n由于 $w_1+w_2=1$，像元平均 LST 也是一个简单的余弦函数，其平均值为 $T_0$，复合振幅为 $\\Delta T_{\\mathrm{amp}, p} = w_1 \\Delta T_{\\mathrm{amp}, 1} + w_2 \\Delta T_{\\mathrm{amp}, 2}$。\n\n日 LST 范围 $\\Delta T_p$ 是 $T_p(t)$ 的最大值和最小值之差。对于振幅为 $\\Delta T_{\\mathrm{amp}, p}$ 的余弦函数，此范围就是 $2 \\times \\Delta T_{\\mathrm{amp}, p}$。\n$$\n\\Delta T_p = 2 \\Delta T_{\\mathrm{amp}, p} = 2(w_1 \\Delta T_{\\mathrm{amp}, 1} + w_2 \\Delta T_{\\mathrm{amp}, 2})\n$$\n代入每个组分振幅的表达式：\n$$\n\\Delta T_p = 2 \\left( w_1 \\frac{f_g (1-\\alpha_1) S_{\\mathrm{amp}}}{I_1\\sqrt{\\omega}} + w_2 \\frac{f_g (1-\\alpha_2) S_{\\mathrm{amp}}}{I_2\\sqrt{\\omega}} \\right) = \\frac{2 f_g S_{\\mathrm{amp}}}{\\sqrt{\\omega}} \\left( \\frac{w_1 (1-\\alpha_1)}{I_1} + \\frac{w_2 (1-\\alpha_2)}{I_2} \\right)\n$$\n在模型假设下，这个关于 $\\Delta T_p$ 的解析结果是精确的，并且在计算上优于在离散时间序列上进行数值搜索。\n\n**步骤 4：表观热惯量（$\\mathrm{ATI}_p$）的计算**\n\n像元平均反照率 $\\alpha_p$ 是组分反照率的线性组合：\n$$\n\\alpha_p = w_1 \\alpha_1 + w_2 \\alpha_2\n$$\n问题将像元的表观热惯量定义为：\n$$\n\\mathrm{ATI}_p = \\frac{1-\\alpha_p}{\\Delta T_p}\n$$\n值得注意的是，尽管问题陈述要求将此量表示为“无量纲浮点数”，但其正式单位是 K$^{-1}$，因为 $\\alpha_p$ 是无量纲的，而 $\\Delta T_p$ 的单位是开尔文。计算将按定义进行，得出的数值隐含地带有这些单位。\n\n代入推导出的 $\\alpha_p$ 和 $\\Delta T_p$ 表达式，即可得到用于实现的最终公式：\n$$\n\\mathrm{ATI}_p = \\frac{1 - (w_1 \\alpha_1 + w_2 \\alpha_2)}{\\frac{2 f_g S_{\\mathrm{amp}}}{\\sqrt{2\\pi/P}} \\left( \\frac{w_1 (1-\\alpha_1)}{I_1} + \\frac{w_2 (1-\\alpha_2)}{I_2} \\right)}\n$$\n算法将为所提供的五个测试案例中的每一个计算此值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Apparent Thermal Inertia (ATI) for a two-component\n    sub-pixel mixture based on a 1D heat conduction model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (w1, w2, I1, I2, alpha1, alpha2, T0, Samp, fg, P)\n    test_cases = [\n        # Case 1 (happy path)\n        (0.5, 0.5, 2500, 900, 0.15, 0.35, 300, 800, 0.25, 86400),\n        # Case 2 (consistency check, identical components)\n        (0.5, 0.5, 1500, 1500, 0.25, 0.25, 300, 800, 0.25, 86400),\n        # Case 3 (low-forcing edge case)\n        (0.5, 0.5, 2500, 900, 0.15, 0.35, 300, 1, 0.25, 86400),\n        # Case 4 (contrasting materials)\n        (0.2, 0.8, 1600, 900, 0.06, 0.35, 300, 800, 0.25, 86400),\n        # Case 5 (single-component limit)\n        (1.0, 0.0, 2500, 900, 0.15, 0.35, 300, 800, 0.25, 86400),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        w1, w2, I1, I2, alpha1, alpha2, T0, S_amp, f_g, P = case\n\n        # Calculate angular frequency\n        omega = (2 * np.pi) / P\n\n        # Calculate the pixel-averaged albedo\n        alpha_p = w1 * alpha1 + w2 * alpha2\n\n        # Calculate the diurnal LST range for the pixel (Delta T_p)\n        # This is derived from the formula:\n        # Delta_Tp = 2 * (w1 * Delta_T_amp_1 + w2 * Delta_T_amp_2)\n        # where Delta_T_amp_j = (f_g * (1 - alpha_j) * S_amp) / (I_j * sqrt(omega))\n        \n        term1 = (w1 * (1 - alpha1)) / I1\n        term2 = (w2 * (1 - alpha2)) / I2\n        \n        scaling_factor = (2 * f_g * S_amp) / np.sqrt(omega)\n        \n        delta_T_p = scaling_factor * (term1 + term2)\n        \n        # Calculate Apparent Thermal Inertia (ATI)\n        # Handle the edge case of delta_T_p being zero or very close to it\n        # to avoid division by zero, although not expected with given test cases.\n        if abs(delta_T_p)  1e-9:\n             # For zero forcing (S_amp=0), delta_T_p is 0, ATI is infinite.\n             # In a physical context, this is ill-defined.\n             # We can represent it as a very large number or NaN.\n             # For this problem, we'll store as NaN, but test cases avoid this.\n             ati_p = np.nan\n        else:\n             ati_p = (1 - alpha_p) / delta_T_p\n\n        # Round the result to 6 decimal places as required\n        results.append(round(ati_p, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}