{
    "hands_on_practices": [
        {
            "introduction": "This first exercise takes us back to the fundamental physics of heat transfer. Before we can apply the concept of thermal inertia, it's crucial to understand its origin. By solving the one-dimensional heat equation for a simplified, yet powerful, model of diurnal surface heating, we will derive the expression for thermal inertia ($I$) from the ground up and explore how its constituent properties—thermal conductivity ($k$), density ($\\rho$), and specific heat capacity ($c$)—govern a material's resistance to temperature change .",
            "id": "3861490",
            "problem": "A homogeneous, dry loamy soil is observed by a Thermal Infrared (TIR) remote sensing instrument over a clear-sky day. Assume the upper boundary at the land surface is subject to a diurnally varying net heat-flux forcing that can be approximated as a single-frequency sinusoid and that the subsurface can be treated as a semi-infinite medium. The soil is characterized by thermal conductivity $k$, bulk density $\\rho$, and specific heat capacity $c$. Using first-principles heat transport, derive an appropriate expression for the material property commonly used to quantify resistance to surface temperature change over the diurnal cycle, then compute its value for the given soil.\n\nGiven $k=1.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\rho=1600\\,\\mathrm{kg\\,m^{-3}}$, and $c=800\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$:\n- Derive the quantity that aggregates $k$, $\\rho$, and $c$ to characterize the soil’s tendency to resist diurnal temperature swings, and then compute its numerical value. Round your numerical answer to four significant figures and express it in $\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$.\n- Under identical sinusoidal surface heat-flux forcing of amplitude $q_{0}$ and angular frequency $\\omega$ representative of the diurnal cycle, reason from the governing laws of heat conduction whether the diurnal surface temperature amplitude increases or decreases when $k$ is doubled versus when $c$ is doubled, and determine the multiplicative factor of change in the amplitude in each case. Base your reasoning on physically transparent steps (energy storage and diffusion), not on memorized end formulas.\n\nYour final numerical answer should be the computed value of the aggregated property indicated above. Round to four significant figures.",
            "solution": "The problem requires the derivation and calculation of a material property that quantifies a soil's resistance to diurnal temperature change, based on first principles of heat transfer. It also requires a physical explanation of how thermal conductivity and specific heat capacity individually affect this temperature response.\n\nThe physical system is modeled as a one-dimensional, semi-infinite, homogeneous medium (the soil), with heat transport governed by the heat conduction equation. Assuming no internal heat generation, the equation is:\n$$ \\frac{\\partial T(z, t)}{\\partial t} = \\alpha \\frac{\\partial^2 T(z, t)}{\\partial z^2} $$\nwhere $T$ is the temperature at depth $z$ (positive downwards from the surface at $z=0$) and time $t$. The parameter $\\alpha$ is the thermal diffusivity, defined as:\n$$ \\alpha = \\frac{k}{\\rho c} $$\nwith $k$ being the thermal conductivity, $\\rho$ the bulk density, and $c$ the specific heat capacity.\n\nThe upper boundary at the surface ($z=0$) is subjected to a sinusoidal net heat flux, representing the diurnal cycle of solar heating and nighttime cooling. We can represent this forcing using complex notation for mathematical convenience, where the physical flux is the real part:\n$$ q(0, t) = q_0 \\cos(\\omega t) = \\text{Re}\\{q_0 \\exp(i\\omega t)\\} $$\nHere, $q_0$ is the amplitude of the net heat flux and $\\omega$ is the angular frequency of the diurnal cycle, where $\\omega=2\\pi/P$ and $P$ is the period (e.g., $24$ hours).\n\nThe surface heat flux is related to the temperature gradient by Fourier's law of heat conduction:\n$$ q(z, t) = -k \\frac{\\partial T(z, t)}{\\partial z} $$\nApplying this at the surface gives the boundary condition:\n$$ q_0 \\exp(i\\omega t) = -k \\left. \\frac{\\partial T}{\\partial z} \\right|_{z=0} $$\nNote that we use the complex form for both sides of the equation, with the understanding that the physical quantities are their real parts.\n\nWe seek a periodic solution for the temperature perturbation, $T'(z,t)$, that is driven by this flux. We assume a solution of the form of a thermal wave that propagates into the medium:\n$$ T'(z, t) = \\text{Re}\\{\\hat{T}(z) \\exp(i\\omega t)\\} $$\nwhere $\\hat{T}(z)$ is the complex amplitude of the temperature fluctuation at depth $z$. Substituting this into the heat equation yields an ordinary differential equation for $\\hat{T}(z)$:\n$$ i\\omega \\hat{T}(z) = \\alpha \\frac{d^2 \\hat{T}(z)}{dz^2} \\implies \\frac{d^2 \\hat{T}}{dz^2} - \\frac{i\\omega}{\\alpha}\\hat{T} = 0 $$\nThe general solution to this equation is $\\hat{T}(z) = C_1 \\exp(\\lambda z) + C_2 \\exp(-\\lambda z)$, where $\\lambda^2 = i\\omega/\\alpha$.\nThus, $\\lambda = \\sqrt{i\\omega/\\alpha} = \\sqrt{i} \\sqrt{\\omega/\\alpha}$. Since $\\sqrt{i} = \\exp(i\\pi/4) = (1+i)/\\sqrt{2}$, we have:\n$$ \\lambda = \\frac{1+i}{\\sqrt{2}} \\sqrt{\\frac{\\omega}{\\alpha}} = (1+i)\\sqrt{\\frac{\\omega}{2\\alpha}} $$\nThe medium is semi-infinite ($z \\in [0, \\infty)$). For the solution to be physically realistic, temperature fluctuations must decay to zero as depth increases indefinitely ($ T' \\to 0 $ as $z \\to \\infty$). The term $\\exp(\\lambda z)$ grows with $z$, so its coefficient $C_1$ must be zero. This leaves:\n$$ \\hat{T}(z) = C_2 \\exp(-\\lambda z) = \\hat{T}_s \\exp(-\\lambda z) $$\nwhere $\\hat{T}_s = C_2$ is the complex temperature amplitude at the surface ($z=0$).\n\nNow we apply the surface flux boundary condition by first differentiating $\\hat{T}(z)$:\n$$ \\frac{d\\hat{T}}{dz} = -\\lambda \\hat{T}_s \\exp(-\\lambda z) $$\nAt the surface $z=0$, this gives $\\frac{d\\hat{T}}{dz}|_{z=0} = -\\lambda \\hat{T}_s$. Substituting into the complex form of the boundary condition:\n$$ q_0 = -k \\left( -\\lambda \\hat{T}_s \\right) = k \\lambda \\hat{T}_s $$\nWe can now solve for the surface temperature amplitude $\\hat{T}_s$:\n$$ \\hat{T}_s = \\frac{q_0}{k\\lambda} = \\frac{q_0}{k \\sqrt{i\\omega/\\alpha}} = \\frac{q_0}{\\sqrt{k^2(i\\omega/\\alpha)}} = \\frac{q_0}{\\sqrt{i k^2 \\omega / (k/(\\rho c))}} = \\frac{q_0}{\\sqrt{i k \\rho c \\omega}} $$\nThe physical amplitude of the surface temperature swing, $T_{amp}$, is the magnitude of the complex amplitude $\\hat{T}_s$:\n$$ T_{amp} = |\\hat{T}_s| = \\left| \\frac{q_0}{\\sqrt{i} \\sqrt{k \\rho c \\omega}} \\right| = \\frac{|q_0|}{|\\sqrt{i}| \\cdot |\\sqrt{k \\rho c \\omega}|} $$\nSince $|\\sqrt{i}| = 1$, the expression simplifies to:\n$$ T_{amp} = \\frac{q_0}{\\sqrt{k \\rho c \\omega}} $$\nThis equation shows that for a given heat flux forcing (fixed $q_0$ and $\\omega$), the resulting surface temperature amplitude is inversely proportional to the term $\\sqrt{k \\rho c}$. Therefore, the material's resistance to temperature change is directly proportional to this term. The aggregated property that quantifies this resistance is the **thermal inertia**, $I$:\n$$ I = \\sqrt{k \\rho c} $$\nA higher thermal inertia signifies greater resistance to temperature change.\n\nNext, we compute the numerical value of the thermal inertia for the given soil properties:\n$k=1.5\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n$\\rho=1600\\,\\mathrm{kg\\,m^{-3}}$\n$c=800\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n\nThe product $k \\rho c$ is:\n$$ k \\rho c = (1.5) \\times (1600) \\times (800) = 1,920,000 $$\nThe units are $(\\mathrm{W\\,m^{-1}\\,K^{-1}}) \\times (\\mathrm{kg\\,m^{-3}}) \\times (\\mathrm{J\\,kg^{-1}\\,K^{-1}}) = (\\mathrm{J\\,s^{-1}\\,m^{-1}\\,K^{-1}}) \\times (\\mathrm{kg\\,m^{-3}}) \\times (\\mathrm{J\\,kg^{-1}\\,K^{-1}}) = \\mathrm{J^2\\,s^{-1}\\,m^{-4}\\,K^{-2}}$.\nThe thermal inertia $I$ is the square root:\n$$ I = \\sqrt{1,920,000} \\approx 1385.6406... \\,\\, \\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}} $$\nRounding to four significant figures, we get:\n$$ I = 1386 \\,\\, \\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}} $$\n\nFinally, we analyze the effect of changing $k$ and $c$ on the surface temperature amplitude, $T_{amp}$, from physical principles. The surface temperature at any moment is the result of a dynamic balance between the energy flux at the surface and the subsurface's ability to store this energy (governed by volumetric heat capacity $\\rho c$) and transport it away from the surface (governed by thermal conductivity $k$).\n\nCase 1: Doubling thermal conductivity ($k \\to 2k$)\nWhen $k$ is doubled, the soil's ability to conduct heat is enhanced. During the day, as the surface absorbs net radiation, this energy is more rapidly and efficiently transported (diffused) into the cooler subsurface. This rapid removal of energy from the immediate surface layer means that less energy accumulates at the very top, resulting in a smaller temperature increase. At night, as the surface cools by radiating heat away, a higher $k$ allows heat from the warmer subsurface to be conducted back to the surface more effectively, which slows the rate of cooling. Both effects lead to a moderation of the temperature extremes. Consequently, the diurnal surface temperature amplitude **decreases**.\n\nCase 2: Doubling specific heat capacity ($c \\to 2c$)\nWhen $c$ is doubled, the volumetric heat capacity $\\rho c$ also doubles. This means that twice the amount of thermal energy is required to raise the temperature of a unit volume of soil by one degree. During the day, as the surface absorbs a given amount of net heat flux, this increased capacity for energy storage means the temperature of the surface layer rises more slowly and to a lesser extent. The material acts as a larger thermal reservoir. At night, the soil has stored more heat and must lose more of it to cool down by a given amount, thus slowing the cooling process. This buffering effect also moderates temperature extremes. Consequently, the diurnal surface temperature amplitude **decreases**.\n\nTo determine the multiplicative factor of change, we use the derived relationship $T_{amp} \\propto 1/\\sqrt{k \\rho c}$. Let the initial amplitude be $T_{amp, i}$.\nIf $k \\to 2k$, the new amplitude $T_{amp, k}$ is:\n$$ T_{amp, k} \\propto \\frac{1}{\\sqrt{(2k)\\rho c}} = \\frac{1}{\\sqrt{2}} \\frac{1}{\\sqrt{k\\rho c}} \\implies T_{amp, k} = \\frac{1}{\\sqrt{2}} T_{amp, i} $$\nIf $c \\to 2c$, the new amplitude $T_{amp, c}$ is:\n$$ T_{amp, c} \\propto \\frac{1}{\\sqrt{k\\rho(2c)}} = \\frac{1}{\\sqrt{2}} \\frac{1}{\\sqrt{k\\rho c}} \\implies T_{amp, c} = \\frac{1}{\\sqrt{2}} T_{amp, i} $$\nIn both cases, the amplitude decreases by a multiplicative factor of $1/\\sqrt{2}$.",
            "answer": "$$\\boxed{1386}$$"
        },
        {
            "introduction": "Moving from pure theory to practical application, we often infer thermal inertia from remote sensing measurements rather than calculating it from its base components. This practice confronts a critical aspect of any measurement-based science: uncertainty. Here, you will use the standard technique of linear error propagation to quantify how independent uncertainties in our measurements, such as Land Surface Temperature amplitude ($\\Delta T$), albedo ($A$), and even the timing of the solar cycle, combine to affect the final confidence in our estimated thermal inertia .",
            "id": "3861476",
            "problem": "A semi-arid site is observed under clear-sky conditions. Assume the land surface behaves as a semi-infinite, laterally homogeneous half-space governed by one-dimensional heat diffusion with constant properties. The surface is driven by a sinusoidal absorbed heat flux with angular frequency $\\omega$ and amplitude $q_{0}$. Let the thermal inertia be defined as $I=\\sqrt{k\\,\\rho\\,c}$, where $k$ is thermal conductivity, $\\rho$ is density, and $c$ is specific heat capacity. Land Surface Temperature (LST) retrievals indicate a diurnal surface temperature oscillation that is well-approximated as sinusoidal with amplitude $\\Delta T$. The absorbed shortwave heat-flux amplitude is modeled as $q_{0}=(1-A)\\,S_{a}$, where $A$ is the broadband shortwave albedo and $S_{a}$ is the amplitude of incoming shortwave radiation at the surface. The effective forcing period is taken as the photoperiod $P$, such that $\\omega=2\\pi/P$.\n\nUsing the one-dimensional heat equation for a semi-infinite medium subject to a sinusoidal surface heat-flux boundary condition, derive the dependence of the surface temperature amplitude on $I$ and $\\omega$, then solve for $I$ in terms of $q_{0}$, $\\Delta T$, and $P$. Finally, compute the one-standard-deviation uncertainty in $I$ by linear error propagation due to independent uncertainties in LST amplitude, albedo, and timing (photoperiod), using the parameters below. Assume all uncertainties are one-standard-deviation, mutually independent, and small enough that first-order (linear) propagation is valid.\n\nGiven:\n- Absorbed shortwave model: $q_{0}=(1-A)\\,S_{a}$.\n- Shortwave amplitude: $S_{a}=600~\\text{W m}^{-2}$.\n- Albedo: $A=0.30$ with uncertainty $\\sigma_{A}=0.02$ (absolute).\n- LST amplitude: $\\Delta T=10~\\text{K}$ with uncertainty $\\sigma_{\\Delta T}=0.5~\\text{K}$.\n- Photoperiod: $P=12~\\text{h}$ with uncertainty $\\sigma_{P}=0.5~\\text{h}$.\n- Relationship between angular frequency and period: $\\omega=2\\pi/P$.\n\nInstructions:\n- Start from the one-dimensional heat diffusion equation and the sinusoidal surface heat-flux boundary condition to obtain the amplitude relation between the surface temperature and the imposed flux. Then solve symbolically for $I$ as a function of $q_{0}$, $\\Delta T$, and $P$.\n- Treat the “timing error” as uncertainty in the photoperiod $P$.\n- Use linear error propagation to obtain the uncertainty $\\sigma_{I}$, expressing $I$ as a function of $A$, $\\Delta T$, and $P$.\n- Express the final uncertainty $\\sigma_{I}$ in $\\text{J m}^{-2}\\,\\text{K}^{-1}\\,\\text{s}^{-1/2}$.\n- Round your final numerical result to three significant figures.\n- Report only the resulting $\\sigma_{I}$ in the end.",
            "solution": "The objective is to compute the one-standard-deviation uncertainty in the thermal inertia, $I$, derived from measurements of LST amplitude ($\\Delta T$), albedo ($A$), and photoperiod ($P$).\n\n**1. Symbolic Expression for Thermal Inertia ($I$)**\n\nFrom the one-dimensional heat equation with a sinusoidal surface heat flux, the relationship between the surface temperature amplitude ($\\Delta T$), the heat flux amplitude ($q_0$), thermal inertia ($I$), and angular frequency ($\\omega$) is:\n$$ \\Delta T = \\frac{q_0}{I \\sqrt{\\omega}} $$\nSolving for $I$:\n$$ I = \\frac{q_0}{\\Delta T \\sqrt{\\omega}} $$\nWe are given the models $q_0 = (1-A)S_a$ and $\\omega = 2\\pi/P$. Substituting these into the expression for $I$:\n$$ I = \\frac{(1-A)S_a}{\\Delta T \\sqrt{2\\pi/P}} = \\frac{(1-A)S_a \\sqrt{P}}{\\Delta T \\sqrt{2\\pi}} $$\nThis equation expresses $I$ as a function of the measured variables with uncertainties: $A$, $\\Delta T$, and $P$.\n\n**2. Linear Error Propagation**\n\nFor a function $I = f(A, \\Delta T, P)$, the general formula for linear propagation of independent uncertainties is:\n$$ \\sigma_I^2 = \\left(\\frac{\\partial I}{\\partial A}\\sigma_A\\right)^2 + \\left(\\frac{\\partial I}{\\partial \\Delta T}\\sigma_{\\Delta T}\\right)^2 + \\left(\\frac{\\partial I}{\\partial P}\\sigma_P\\right)^2 $$\nTo apply this, we compute the partial derivatives of $I$ with respect to each variable:\n$$ \\frac{\\partial I}{\\partial A} = \\frac{-S_a \\sqrt{P}}{\\Delta T \\sqrt{2\\pi}} = -\\frac{I}{1-A} $$\n$$ \\frac{\\partial I}{\\partial \\Delta T} = -\\frac{(1-A)S_a \\sqrt{P}}{\\Delta T^2 \\sqrt{2\\pi}} = -\\frac{I}{\\Delta T} $$\n$$ \\frac{\\partial I}{\\partial P} = \\frac{(1-A)S_a}{\\Delta T \\sqrt{2\\pi}} \\cdot \\frac{1}{2\\sqrt{P}} = \\frac{I}{2P} $$\nSubstituting these into the uncertainty formula and factoring out $I^2$ gives the squared relative uncertainty:\n$$ \\left(\\frac{\\sigma_I}{I}\\right)^2 = \\left(\\frac{\\sigma_A}{1-A}\\right)^2 + \\left(\\frac{\\sigma_{\\Delta T}}{\\Delta T}\\right)^2 + \\left(\\frac{\\sigma_P}{2P}\\right)^2 $$\n\n**3. Numerical Calculation**\n\nFirst, convert all values to SI units and calculate the nominal value of $I$:\n- $S_a = 600~\\text{W m}^{-2}$\n- $A = 0.30$, $\\sigma_A = 0.02$\n- $\\Delta T = 10~\\text{K}$, $\\sigma_{\\Delta T} = 0.5~\\text{K}$\n- $P = 12~\\text{h} = 12 \\times 3600~\\text{s} = 43200~\\text{s}$\n- $\\sigma_P = 0.5~\\text{h} = 0.5 \\times 3600~\\text{s} = 1800~\\text{s}$\n\nNominal value of $I$:\n$$ I = \\frac{(1-0.30) \\cdot 600 \\cdot \\sqrt{43200}}{10 \\cdot \\sqrt{2\\pi}} \\approx \\frac{420 \\cdot 207.846}{10 \\cdot 2.5066} \\approx 3482.56~\\text{J m}^{-2}\\,\\text{K}^{-1}\\,\\text{s}^{-1/2} $$\n\nNext, calculate each term in the squared relative uncertainty equation:\n- Albedo contribution: $\\left(\\frac{\\sigma_A}{1-A}\\right)^2 = \\left(\\frac{0.02}{1-0.30}\\right)^2 = \\left(\\frac{0.02}{0.7}\\right)^2 \\approx 0.000816$\n- LST amplitude contribution: $\\left(\\frac{\\sigma_{\\Delta T}}{\\Delta T}\\right)^2 = \\left(\\frac{0.5}{10}\\right)^2 = (0.05)^2 = 0.0025$\n- Period contribution: $\\left(\\frac{\\sigma_P}{2P}\\right)^2 = \\left(\\frac{1800}{2 \\cdot 43200}\\right)^2 = \\left(\\frac{1800}{86400}\\right)^2 \\approx 0.000434$\n\nSum the squared relative uncertainties:\n$$ \\left(\\frac{\\sigma_I}{I}\\right)^2 \\approx 0.000816 + 0.0025 + 0.000434 = 0.003750 $$\nThe total relative uncertainty is the square root:\n$$ \\frac{\\sigma_I}{I} = \\sqrt{0.003750} \\approx 0.06124 $$\nFinally, compute the absolute uncertainty $\\sigma_I$:\n$$ \\sigma_I = I \\cdot \\left(\\frac{\\sigma_I}{I}\\right) \\approx 3482.56 \\cdot 0.06124 \\approx 213.29~\\text{J m}^{-2}\\,\\text{K}^{-1}\\,\\text{s}^{-1/2} $$\nRounding to three significant figures, the uncertainty is:\n$$ \\sigma_I \\approx 213~\\text{J m}^{-2}\\,\\text{K}^{-1}\\,\\text{s}^{-1/2} $$",
            "answer": "$$\n\\boxed{213}\n$$"
        },
        {
            "introduction": "Our final practice addresses a ubiquitous challenge in remote sensing: the heterogeneity of the Earth's surface. Satellite sensor pixels are rarely composed of a single, uniform material. This simulation exercise delves into the complexities of these 'mixed pixels,' requiring you to model the distinct thermal responses of different surface components and then explore how they combine to produce a single, pixel-averaged temperature signal. Through this process, you will compute the Apparent Thermal Inertia (ATI), a critical concept that helps interpret thermal data from real-world, non-uniform landscapes .",
            "id": "3861493",
            "problem": "You are given a physically based modeling task in the domain of remote sensing and environmental modeling. Consider a sub-pixel mixture composed of two homogeneous surface components observed under nadir viewing (normal incidence). Each component is modeled as a semi-infinite medium obeying one-dimensional heat conduction with a periodic surface heat flux boundary condition that mimics a diurnal cycle. The objective is to simulate the diurnal Land Surface Temperature (LST) curve for each component and compute the apparent pixel Apparent Thermal Inertia (ATI) using accepted remote sensing practice.\n\nAssumptions and required derivations:\n- Start from the one-dimensional heat conduction equation in a semi-infinite half-space, with a sinusoidal surface heat flux boundary condition. Derive the surface temperature response for a periodic forcing of angular frequency $\\omega$ in terms of the material thermal properties. The thermal inertia is defined as $I=\\sqrt{k \\,\\rho \\,c}$, where $k$ is thermal conductivity, $\\rho$ is density, and $c$ is specific heat capacity.\n- Assume the net heat flux into the ground is a fixed fraction of the absorbed shortwave radiation at the surface. Let the absorbed shortwave amplitude be $(1-\\alpha)\\,S_{\\mathrm{amp}}$, where $\\alpha$ is broadband albedo and $S_{\\mathrm{amp}}$ is the amplitude of the incident shortwave radiation. Let a constant fraction $f_g$ of this absorbed amplitude be conducted into the ground as the sinusoidal boundary heat flux of amplitude $q_0=f_g\\,(1-\\alpha)\\,S_{\\mathrm{amp}}$.\n- Derive the diurnal LST response for each component as a cosine function with a phase lag relative to the forcing consistent with the conduction solution. Use a constant baseline temperature $T_0$ for the mean around which the diurnal oscillation occurs.\n- Under nadir viewing, assume linear areal mixing of component LSTs to form the pixel LST: for component weights $w_1$ and $w_2$, the apparent pixel LST is the weighted average $T_p(t)=w_1\\,T_1(t)+w_2\\,T_2(t)$, with $w_1+w_2=1$. For small diurnal amplitudes typical of terrestrial surfaces, treat the mixture in LST space as a first-order approximation to thermal radiance mixing.\n- Use the remote-sensing definition of Apparent Thermal Inertia (ATI) for the pixel: $\\mathrm{ATI}_p=\\dfrac{1-\\alpha_p}{\\Delta T_p}$, where $\\alpha_p=w_1\\,\\alpha_1+w_2\\,\\alpha_2$ is the areal-average albedo and $\\Delta T_p$ is the diurnal LST range (maximum minus minimum) over one period. Express $\\mathrm{ATI}_p$ as a dimensionless float.\n\nUnits and numerical requirements:\n- Thermal inertia $I$ must be in $\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$.\n- Shortwave amplitude $S_{\\mathrm{amp}}$ and heat flux $q_0$ must be in $\\mathrm{W\\,m^{-2}}$.\n- Period $P$ must be in $\\mathrm{s}$, and angles must be in radians.\n- Temperatures must be expressed in Kelvin.\n- The final results must be floats rounded to $6$ decimal places.\n\nYour program must:\n- Implement the derived diurnal LST curves $T_1(t)$ and $T_2(t)$ over one period for each test case, using a sufficiently fine time discretization to capture maxima and minima.\n- Compute $\\Delta T_p$ and $\\alpha_p$ and then $\\mathrm{ATI}_p$ for each test case.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\text{result1},\\text{result2},\\text{result3}]$.\n\nTest suite (provide results for all cases):\n- Case $1$ (given thumbnail scenario, happy path): two-component pixel with $w_1=0.5$, $w_2=0.5$; thermal inertias $I_1=2500\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$, $I_2=900\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$; albedos $\\alpha_1=0.15$, $\\alpha_2=0.35$; baseline temperature $T_0=300\\,\\mathrm{K}$; shortwave amplitude $S_{\\mathrm{amp}}=800\\,\\mathrm{W\\,m^{-2}}$; ground-flux fraction $f_g=0.25$; period $P=86400\\,\\mathrm{s}$.\n- Case $2$ (consistency check, identical components): $w_1=0.5$, $w_2=0.5$; $I_1=1500\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$, $I_2=1500\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$; $\\alpha_1=0.25$, $\\alpha_2=0.25$; $T_0=300\\,\\mathrm{K}$; $S_{\\mathrm{amp}}=800\\,\\mathrm{W\\,m^{-2}}$; $f_g=0.25$; $P=86400\\,\\mathrm{s}$.\n- Case $3$ (low-forcing edge case): $w_1=0.5$, $w_2=0.5$; $I_1=2500\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$, $I_2=900\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$; $\\alpha_1=0.15$, $\\alpha_2=0.35$; $T_0=300\\,\\mathrm{K}$; $S_{\\mathrm{amp}}=1\\,\\mathrm{W\\,m^{-2}}$; $f_g=0.25$; $P=86400\\,\\mathrm{s}$.\n- Case $4$ (contrasting materials): $w_1=0.2$, $w_2=0.8$; $I_1=1600\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$ (water-like), $I_2=900\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$ (sand); $\\alpha_1=0.06$, $\\alpha_2=0.35$; $T_0=300\\,\\mathrm{K}$; $S_{\\mathrm{amp}}=800\\,\\mathrm{W\\,m^{-2}}$; $f_g=0.25$; $P=86400\\,\\mathrm{s}$.\n- Case $5$ (single-component limit): $w_1=1.0$, $w_2=0.0$; $I_1=2500\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$, $I_2=900\\,\\mathrm{J\\,m^{-2}\\,K^{-1}\\,s^{-1/2}}$; $\\alpha_1=0.15$, $\\alpha_2=0.35$; $T_0=300\\,\\mathrm{K}$; $S_{\\mathrm{amp}}=800\\,\\mathrm{W\\,m^{-2}}$; $f_g=0.25$; $P=86400\\,\\mathrm{s}$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the $\\mathrm{ATI}_p$ values for the five cases as a comma-separated list enclosed in square brackets. Each value must be rounded to $6$ decimal places, for example, $[\\text{v}_1,\\text{v}_2,\\text{v}_3,\\text{v}_4,\\text{v}_5]$.",
            "solution": "The user-provided problem has been assessed and is determined to be valid. The premises are scientifically grounded in the principles of heat transfer, the problem is well-posed with a clear objective and sufficient data, and the language is objective and formal. The derivation and computations can proceed as outlined. A minor inconsistency regarding the dimensionality of the final result is noted but does not invalidate the problem's core structure.\n\nThe objective is to compute the Apparent Thermal Inertia ($\\mathrm{ATI}_p$) for a two-component sub-pixel mixture based on a physical model of diurnal surface temperature variation.\n\nThe solution is developed through the following sequential steps:\n$1$. Derive the surface temperature response of a homogeneous, semi-infinite medium to a periodic surface heat flux.\n$2$. Apply this model to each of the two components within the pixel.\n$3$. Combine the component temperatures to find the pixel-averaged Land Surface Temperature ($LST$) and its diurnal range ($\\Delta T_p$).\n$4$. Use the remote sensing definition of $\\mathrm{ATI}_p$ to compute the final value.\n\n**Step 1: Derivation of the Surface Temperature Response**\n\nThe problem begins with the one-dimensional heat conduction equation for a semi-infinite medium ($z \\ge 0$):\n$$\n\\frac{\\partial T(z, t)}{\\partial t} = \\kappa \\frac{\\partial^2 T(z, t)}{\\partial z^2}\n$$\nwhere $T$ is temperature, $z$ is depth, $t$ is time, and $\\kappa = k / (\\rho c)$ is the thermal diffusivity, with $k$ being thermal conductivity, $\\rho$ density, and $c$ specific heat capacity.\n\nThe surface boundary condition at $z=0$ is a periodic heat flux, representing the portion of solar radiation that drives ground heat conduction. We model this as a simple harmonic forcing:\n$$\n-k \\frac{\\partial T}{\\partial z}\\bigg|_{z=0} = q(t) = q_0 \\cos(\\omega t)\n$$\nwhere $q_0$ is the amplitude of the ground heat flux and $\\omega = 2\\pi/P$ is the angular frequency for a diurnal period $P$. The choice of a cosine function sets the peak flux at $t=0$ (solar noon).\n\nWe seek a steady-state periodic solution of the form $T(z, t) = T_0 + \\Re\\{\\hat{T}(z) e^{i\\omega t}\\}$, where $T_0$ is the mean temperature and $\\hat{T}(z)$ is the complex temperature amplitude as a function of depth. Substituting this into the heat equation yields an ordinary differential equation for $\\hat{T}(z)$:\n$$\n\\frac{d^2 \\hat{T}}{dz^2} - \\frac{i\\omega}{\\kappa}\\hat{T} = 0\n$$\nThe general solution is $\\hat{T}(z) = A \\exp\\left(-(1+i)\\sqrt{\\frac{\\omega}{2\\kappa}}z\\right) + B \\exp\\left(+(1+i)\\sqrt{\\frac{\\omega}{2\\kappa}}z\\right)$. The condition that the temperature fluctuation must vanish deep within the medium ($z \\to \\infty$) requires $B=0$.\n\nThe coefficient $A$ is found by applying the surface flux boundary condition in the complex domain, $-k\\frac{d\\hat{T}}{dz}\\big|_{z=0} = q_0$:\n$$\n-k \\left[ -A(1+i)\\sqrt{\\frac{\\omega}{2\\kappa}} \\right] = q_0 \\implies A = \\frac{q_0}{k(1+i)\\sqrt{\\frac{\\omega}{2\\kappa}}}\n$$\nUsing the definition of thermal inertia, $I = \\sqrt{k\\rho c}$, we can simplify the denominator: $k\\sqrt{\\frac{\\omega}{2\\kappa}} = k\\sqrt{\\frac{\\omega \\rho c}{2k}} = \\sqrt{\\frac{k\\omega\\rho c}{2}} = I\\sqrt{\\frac{\\omega}{2}}$.\nSubstituting this, we get:\n$$\nA = \\frac{q_0}{I(1+i)\\sqrt{\\frac{\\omega}{2}}} = \\frac{q_0(1-i)}{I(2)\\sqrt{\\frac{\\omega}{2}}} = \\frac{q_0(1-i)}{I\\sqrt{2\\omega}}\n$$\nThe complex amplitude $A$ has a magnitude of $|A| = \\frac{q_0}{I\\sqrt{\\omega}}$ and a phase of $\\arg(A) = -\\pi/4$.\nThe surface temperature ($z=0$) response is therefore:\n$$\nT_s(t) = T_0 + \\Re\\{A e^{i\\omega t}\\} = T_0 + |A| \\cos(\\omega t + \\arg(A)) = T_0 + \\frac{q_0}{I\\sqrt{\\omega}} \\cos\\left(\\omega t - \\frac{\\pi}{4}\\right)\n$$\nThis equation shows that the surface temperature oscillates with an amplitude $\\Delta T_{\\mathrm{amp}} = \\frac{q_0}{I\\sqrt{\\omega}}$ and lags the peak heat flux by a phase of $\\pi/4$, which corresponds to a time lag of $P/8$, or $3$ hours for a $24$-hour period.\n\n**Step 2: Component LST Calculation**\n\nFor each component $j$ (where $j \\in \\{1, 2\\}$) in the pixel, we apply the derived formula. The heat flux amplitude $q_{0,j}$ is given by $q_{0,j} = f_g (1-\\alpha_j) S_{\\mathrm{amp}}$, where $\\alpha_j$ is the component's albedo, $S_{\\mathrm{amp}}$ is the shortwave radiation amplitude, and $f_g$ is the ground-flux fraction.\nThe temperature amplitude for component $j$ is:\n$$\n\\Delta T_{\\mathrm{amp}, j} = \\frac{q_{0,j}}{I_j\\sqrt{\\omega}} = \\frac{f_g (1-\\alpha_j) S_{\\mathrm{amp}}}{I_j\\sqrt{\\omega}}\n$$\nThus, the diurnal LST curve for component $j$ is:\n$$\nT_j(t) = T_0 + \\Delta T_{\\mathrm{amp}, j} \\cos\\left(\\omega t - \\frac{\\pi}{4}\\right)\n$$\n\n**Step 3: Pixel-Averaged LST and Diurnal Range**\n\nThe apparent LST of the pixel, $T_p(t)$, is the linear areal average of the component temperatures:\n$$\nT_p(t) = w_1 T_1(t) + w_2 T_2(t)\n$$\nwhere $w_1$ and $w_2$ are the fractional areas ($w_1+w_2=1$). Substituting the expressions for $T_1(t)$ and $T_2(t)$:\n$$\nT_p(t) = w_1 \\left[T_0 + \\Delta T_{\\mathrm{amp}, 1} \\cos\\left(\\omega t - \\frac{\\pi}{4}\\right)\\right] + w_2 \\left[T_0 + \\Delta T_{\\mathrm{amp}, 2} \\cos\\left(\\omega t - \\frac{\\pi}{4}\\right)\\right]\n$$\n$$\nT_p(t) = (w_1+w_2)T_0 + (w_1 \\Delta T_{\\mathrm{amp}, 1} + w_2 \\Delta T_{\\mathrm{amp}, 2}) \\cos\\left(\\omega t - \\frac{\\pi}{4}\\right)\n$$\nSince $w_1+w_2=1$, the pixel-averaged LST is also a simple cosine function with mean $T_0$ and a composite amplitude $\\Delta T_{\\mathrm{amp}, p} = w_1 \\Delta T_{\\mathrm{amp}, 1} + w_2 \\Delta T_{\\mathrm{amp}, 2}$.\n\nThe diurnal LST range, $\\Delta T_p$, is the difference between the maximum and minimum of $T_p(t)$. For a cosine function with amplitude $\\Delta T_{\\mathrm{amp}, p}$, this range is simply $2 \\times \\Delta T_{\\mathrm{amp}, p}$.\n$$\n\\Delta T_p = 2 \\Delta T_{\\mathrm{amp}, p} = 2(w_1 \\Delta T_{\\mathrm{amp}, 1} + w_2 \\Delta T_{\\mathrm{amp}, 2})\n$$\nSubstituting the expressions for each component's amplitude:\n$$\n\\Delta T_p = 2 \\left( w_1 \\frac{f_g (1-\\alpha_1) S_{\\mathrm{amp}}}{I_1\\sqrt{\\omega}} + w_2 \\frac{f_g (1-\\alpha_2) S_{\\mathrm{amp}}}{I_2\\sqrt{\\omega}} \\right) = \\frac{2 f_g S_{\\mathrm{amp}}}{\\sqrt{\\omega}} \\left( \\frac{w_1 (1-\\alpha_1)}{I_1} + \\frac{w_2 (1-\\alpha_2)}{I_2} \\right)\n$$\nThis analytical result for $\\Delta T_p$ is exact under the model assumptions and is computationally superior to a numerical search over a discretized time series.\n\n**Step 4: Calculation of Apparent Thermal Inertia ($\\mathrm{ATI}_p$)**\n\nThe pixel-averaged albedo, $\\alpha_p$, is the linear combination of component albedos:\n$$\n\\alpha_p = w_1 \\alpha_1 + w_2 \\alpha_2\n$$\nThe problem defines the Apparent Thermal Inertia for the pixel as:\n$$\n\\mathrm{ATI}_p = \\frac{1-\\alpha_p}{\\Delta T_p}\n$$\nIt is pertinent to note that while the problem statement requests this quantity as a \"dimensionless float,\" its formal units are K$^{-1}$, as $\\alpha_p$ is dimensionless and $\\Delta T_p$ is in Kelvin. The computation will proceed as defined, yielding a numerical value that implicitly carries these units.\n\nSubstituting the derived expressions for $\\alpha_p$ and $\\Delta T_p$ provides the final formula for implementation:\n$$\n\\mathrm{ATI}_p = \\frac{1 - (w_1 \\alpha_1 + w_2 \\alpha_2)}{\\frac{2 f_g S_{\\mathrm{amp}}}{\\sqrt{2\\pi/P}} \\left( \\frac{w_1 (1-\\alpha_1)}{I_1} + \\frac{w_2 (1-\\alpha_2)}{I_2} \\right)}\n$$\nThe algorithm will compute this value for each of the five test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Apparent Thermal Inertia (ATI) for a two-component\n    sub-pixel mixture based on a 1D heat conduction model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (w1, w2, I1, I2, alpha1, alpha2, T0, Samp, fg, P)\n    test_cases = [\n        # Case 1 (happy path)\n        (0.5, 0.5, 2500, 900, 0.15, 0.35, 300, 800, 0.25, 86400),\n        # Case 2 (consistency check, identical components)\n        (0.5, 0.5, 1500, 1500, 0.25, 0.25, 300, 800, 0.25, 86400),\n        # Case 3 (low-forcing edge case)\n        (0.5, 0.5, 2500, 900, 0.15, 0.35, 300, 1, 0.25, 86400),\n        # Case 4 (contrasting materials)\n        (0.2, 0.8, 1600, 900, 0.06, 0.35, 300, 800, 0.25, 86400),\n        # Case 5 (single-component limit)\n        (1.0, 0.0, 2500, 900, 0.15, 0.35, 300, 800, 0.25, 86400),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        w1, w2, I1, I2, alpha1, alpha2, T0, S_amp, f_g, P = case\n\n        # Calculate angular frequency\n        omega = (2 * np.pi) / P\n\n        # Calculate the pixel-averaged albedo\n        alpha_p = w1 * alpha1 + w2 * alpha2\n\n        # Calculate the diurnal LST range for the pixel (Delta T_p)\n        # This is derived from the formula:\n        # Delta_Tp = 2 * (w1 * Delta_T_amp_1 + w2 * Delta_T_amp_2)\n        # where Delta_T_amp_j = (f_g * (1 - alpha_j) * S_amp) / (I_j * sqrt(omega))\n        \n        term1 = (w1 * (1 - alpha1)) / I1\n        term2 = (w2 * (1 - alpha2)) / I2\n        \n        scaling_factor = (2 * f_g * S_amp) / np.sqrt(omega)\n        \n        delta_T_p = scaling_factor * (term1 + term2)\n        \n        # Calculate Apparent Thermal Inertia (ATI)\n        # Handle the edge case of delta_T_p being zero or very close to it\n        # to avoid division by zero, although not expected with given test cases.\n        if abs(delta_T_p)  1e-9:\n             # For zero forcing (S_amp=0), delta_T_p is 0, ATI is infinite.\n             # In a physical context, this is ill-defined.\n             # We can represent it as a very large number or NaN.\n             # For this problem, we'll store as NaN, but test cases avoid this.\n             ati_p = np.nan\n        else:\n             ati_p = (1 - alpha_p) / delta_T_p\n\n        # Round the result to 6 decimal places as required\n        results.append(round(ati_p, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, [f'{r:.6f}' for r in results]))}]\")\n\nsolve()\n```"
        }
    ]
}