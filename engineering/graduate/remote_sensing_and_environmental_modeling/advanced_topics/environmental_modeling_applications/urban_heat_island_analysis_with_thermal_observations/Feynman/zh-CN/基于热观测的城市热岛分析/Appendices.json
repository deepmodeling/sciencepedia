{
    "hands_on_practices": [
        {
            "introduction": "在分析任何环境现象之前，我们必须首先将卫星传感器的原始数据转换为有意义的物理量。本实践聚焦于辐射定标，即将传感器的数字（DN）值转换为传感器处辐射亮度，再利用普朗克定律转换为亮度温度的过程。通过传播定标系数的不确定性，您将学会量化初始测量的置信度，这是任何严谨科学分析中的一项关键技能。",
            "id": "3864235",
            "problem": "一台搭载于极轨卫星上的热红外成像光谱仪用于研究某特大城市的城市热岛 (UHI) 效应。对于 10.8 微米波段的一个星下点像元，传感器输出的数字量 (DN) 为 $700$。将 DN 转换为传感器处光谱辐亮度（单位微米）的辐射定标模型是线性的：$L_{\\mu\\mathrm{m}} = a \\, \\mathrm{DN} + b$，其中 $L_{\\mu\\mathrm{m}}$ 的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$。定标系数具有不确定性：$a = 0.012 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$，其标准差为 $\\sigma_{a} = 1.00 \\times 10^{-4} \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$；$b = 1.20 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$，其标准差为 $\\sigma_{b} = 0.05 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$。$a$ 和 $b$ 的定标误差的相关系数为 $\\rho_{ab} = -0.3$。\n\n假设该波段足够窄，以至于波段中心波长 $\\lambda = 10.8 \\ \\mu\\mathrm{m}$ 处的传感器光谱辐亮度可被视为单色的。定义亮度温度 $T_{b}$ 为理想黑体在产生与传感器处相同光谱辐亮度时的温度，即 $L_{\\lambda} = B(\\lambda, T_{b})$，其中 $B(\\lambda, T)$ 是普朗克光谱辐亮度，由下式给出\n$$\nB(\\lambda, T) = \\frac{2 h c^{2}}{\\lambda^{5}} \\, \\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{B} T}\\right) - 1},\n$$\n其中普朗克常数 $h = 6.62607015 \\times 10^{-34} \\ \\mathrm{J}\\,\\mathrm{s}$，光速 $c = 2.99792458 \\times 10^{8} \\ \\mathrm{m}\\,\\mathrm{s}^{-1}$，玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J}\\,\\mathrm{K}^{-1}$。请注意，在使用普朗克关系式之前，必须将 $L_{\\mu\\mathrm{m}}$ 转换为单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$ 的 $L_{\\lambda}$。\n\n从这些基本原理出发，将定标不确定性视为高斯分布，推导从 DN 到传感器处光谱辐亮度的转换，并使用一阶不确定性传播方法，将定标不确定性传播到亮度温度的标准差 $\\sigma_{T_{b}}$ 中，其中需包括 $a$ 和 $b$ 之间的协方差。计算给定像元的 $\\sigma_{T_{b}}$ 数值，并：\n\n- 以开尔文为单位表示最终的标准差。\n- 将您的答案四舍五入至三位有效数字。",
            "solution": "用户希望通过传播热红外传感器辐射定标系数的不确定性，来计算亮度温度的标准差 $\\sigma_{T_b}$。\n\n该问题被认为是有效的，因为它基于黑体辐射原理和测量不确定性分析，具有科学依据；所有必要信息均已提供，问题是适定的；并且其表述是客观的。所要求的计算是定量遥感中的一个标准流程。\n\n整体分析分为四个阶段：\n1.  计算传感器处光谱辐亮度 $L_{\\lambda}$ 及其不确定性 $\\sigma_{L_{\\lambda}}$。\n2.  反演普朗克函数以确定亮度温度 $T_b$。\n3.  推导亮度温度对传感器处辐亮度的灵敏度 $\\frac{dT_b}{dL_{\\lambda}}$。\n4.  结合辐亮度不确定性和温度灵敏度，计算最终的亮度温度不确定性 $\\sigma_{T_b}$。\n\n**1. 传感器处光谱辐亮度及其不确定性**\n\n问题提供了一个线性定标模型，用于将传感器的数字量（$\\mathrm{DN}$）转换为单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$ 的传感器处光谱辐亮度 $L_{\\mu\\mathrm{m}}$：\n$$L_{\\mu\\mathrm{m}} = a \\cdot \\mathrm{DN} + b$$\n给定 $\\mathrm{DN} = 700$，$a = 0.012 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}\\,\\mathrm{DN}^{-1}$ 和 $b = 1.20 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$，标称辐亮度为：\n$$L_{\\mu\\mathrm{m}} = (0.012) \\cdot (700) + 1.20 = 8.40 + 1.20 = 9.60 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1}$$\n普朗克函数是根据单位波长（米）的光谱辐亮度（$L_{\\lambda}$）给出的。我们必须将 $L_{\\mu\\mathrm{m}}$ 转换为单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$ 的 $L_{\\lambda}$。转换因子是 $10^6 \\ \\mu\\mathrm{m}/\\mathrm{m}$。\n$$L_{\\lambda} = L_{\\mu\\mathrm{m}} \\times 10^6 = 9.60 \\times 10^6 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$$\n$L_{\\lambda}$ 作为定标系数函数的通用表达式是：\n$$L_{\\lambda}(a, b) = (a \\cdot \\mathrm{DN} + b) \\times 10^6$$\n为了求得 $L_{\\lambda}$ 的不确定性，我们使用一阶泰勒级数展开进行不确定性传播。$L_{\\lambda}$ 的方差，记为 $\\sigma_{L_{\\lambda}}^2$，由下式给出：\n$$\\sigma_{L_{\\lambda}}^2 = \\left(\\frac{\\partial L_{\\lambda}}{\\partial a}\\right)^2 \\sigma_a^2 + \\left(\\frac{\\partial L_{\\lambda}}{\\partial b}\\right)^2 \\sigma_b^2 + 2 \\left(\\frac{\\partial L_{\\lambda}}{\\partial a}\\right) \\left(\\frac{\\partial L_{\\lambda}}{\\partial b}\\right) \\sigma_{ab}$$\n其中 $\\sigma_{ab} = \\rho_{ab} \\sigma_a \\sigma_b$ 是 $a$ 和 $b$ 之间的协方差。偏导数是：\n$$\\frac{\\partial L_{\\lambda}}{\\partial a} = \\mathrm{DN} \\times 10^6$$\n$$\\frac{\\partial L_{\\lambda}}{\\partial b} = 1 \\times 10^6$$\n将这些代入方差方程：\n$$\\sigma_{L_{\\lambda}}^2 = (\\mathrm{DN} \\times 10^6)^2 \\sigma_a^2 + (10^6)^2 \\sigma_b^2 + 2 (\\mathrm{DN} \\times 10^6)(10^6) \\rho_{ab} \\sigma_a \\sigma_b$$\n$$\\sigma_{L_{\\lambda}}^2 = (10^6)^2 \\left[ (\\mathrm{DN} \\cdot \\sigma_a)^2 + \\sigma_b^2 + 2 \\cdot \\mathrm{DN} \\cdot \\rho_{ab} \\sigma_a \\sigma_b \\right]$$\n给定数值：$\\mathrm{DN} = 700$，$\\sigma_a = 1.00 \\times 10^{-4}$，$\\sigma_b = 0.05$ 和 $\\rho_{ab} = -0.3$。让我们计算括号中的各项：\n$$(\\mathrm{DN} \\cdot \\sigma_a)^2 = (700 \\cdot 1.00 \\times 10^{-4})^2 = (0.07)^2 = 0.0049$$\n$$\\sigma_b^2 = (0.05)^2 = 0.0025$$\n$$2 \\cdot \\mathrm{DN} \\cdot \\rho_{ab} \\sigma_a \\sigma_b = 2 \\cdot (700) \\cdot (-0.3) \\cdot (1.00 \\times 10^{-4}) \\cdot (0.05) = -0.0021$$\n括号中的项，即 $L_{\\mu\\mathrm{m}}$ 的方差，为：\n$$\\sigma_{L_{\\mu\\mathrm{m}}}^2 = 0.0049 + 0.0025 - 0.0021 = 0.0053 \\ (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mu\\mathrm{m}^{-1})^2$$\n那么 $L_{\\lambda}$ 的方差是：\n$$\\sigma_{L_{\\lambda}}^2 = (10^6)^2 \\cdot 0.0053 = 5.3 \\times 10^9 \\ (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1})^2$$\n辐亮度的标准差是：\n$$\\sigma_{L_{\\lambda}} = \\sqrt{5.3 \\times 10^9} \\approx 72801.1 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$$\n\n**2. 亮度温度 $T_b$ 的计算**\n\n亮度温度 $T_b$ 通过反演普朗克函数 $L_{\\lambda} = B(\\lambda, T_b)$ 求得：\n$$L_{\\lambda} = \\frac{2 h c^{2}}{\\lambda^{5}} \\, \\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{B} T_b}\\right) - 1}$$\n令 $c_1 = 2hc^2$ 和 $c_2 = hc/k_B$。方程变为 $L_{\\lambda} = \\frac{c_1}{\\lambda^5} (\\exp(\\frac{c_2}{\\lambda T_b}) - 1)^{-1}$。\n求解 $T_b$：\n$$\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right) = \\frac{c_1}{\\lambda^5 L_{\\lambda}} + 1$$\n$$T_b = \\frac{c_2}{\\lambda \\ln\\left(\\frac{c_1}{\\lambda^5 L_{\\lambda}} + 1\\right)}$$\n使用给定的物理常数：\n$c_1 = 2(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^8)^2 \\approx 1.19104297 \\times 10^{-16} \\ \\mathrm{W}\\,\\mathrm{m}^2\\,\\mathrm{sr}^{-1}$\n$c_2 = \\frac{(6.62607015 \\times 10^{-34})(2.99792458 \\times 10^8)}{1.380649 \\times 10^{-23}} \\approx 0.01438777 \\ \\mathrm{m}\\,\\mathrm{K}$\n当 $\\lambda = 10.8 \\ \\mu\\mathrm{m} = 10.8 \\times 10^{-6} \\ \\mathrm{m}$ 且 $L_{\\lambda} = 9.60 \\times 10^6 \\ \\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$ 时：\n$$\\frac{c_1}{\\lambda^5 L_{\\lambda}} = \\frac{1.191043 \\times 10^{-16}}{(10.8 \\times 10^{-6})^5 \\cdot (9.60 \\times 10^6)} \\approx \\frac{1.191043 \\times 10^{-16}}{1.411281 \\times 10^{-18}} \\approx 84.3946$$\n$$T_b = \\frac{0.01438777}{(10.8 \\times 10^{-6}) \\ln(84.3946 + 1)} \\approx \\frac{0.01438777}{(10.8 \\times 10^{-6}) (4.44723)} \\approx 299.56 \\ \\mathrm{K}$$\n\n**3. 温度对辐亮度的灵敏度 $\\frac{dT_b}{dL_{\\lambda}}$**\n\n由 $L_{\\lambda}$ 的不确定性引起的 $T_b$ 的不确定性由 $\\sigma_{T_b} = \\left| \\frac{dT_b}{dL_{\\lambda}} \\right| \\sigma_{L_{\\lambda}}$ 给出。我们需要计算导数 $\\frac{dT_b}{dL_{\\lambda}}$。最方便的方法是通过对普朗克函数关于温度求导来找到它的倒数 $\\frac{dL_{\\lambda}}{dT_b}$。\n$$\\frac{dL_{\\lambda}}{dT_b} = \\frac{\\partial B(\\lambda,T)}{\\partial T} \\bigg|_{T=T_b}$$\n$$\\frac{\\partial B}{\\partial T} = \\frac{c_1}{\\lambda^5} (-1) \\left(\\exp\\left(\\frac{c_2}{\\lambda T}\\right) - 1\\right)^{-2} \\exp\\left(\\frac{c_2}{\\lambda T}\\right) \\left(-\\frac{c_2}{\\lambda T^2}\\right)$$\n这个表达式可以通过提出原始普朗克函数 $B(\\lambda, T)$ 作为公因子来简化：\n$$\\frac{\\partial B}{\\partial T} = B(\\lambda, T) \\cdot \\frac{c_2}{\\lambda T^2} \\cdot \\frac{\\exp\\left(\\frac{c_2}{\\lambda T}\\right)}{\\exp\\left(\\frac{c_2}{\\lambda T}\\right) - 1}$$\n因此，导数 $\\frac{dT_b}{dL_{\\lambda}}$ 是：\n$$\\frac{dT_b}{dL_{\\lambda}} = \\left( \\frac{dL_{\\lambda}}{dT_b} \\right)^{-1} = \\frac{1}{L_{\\lambda}} \\cdot \\frac{\\lambda T_b^2}{c_2} \\cdot \\frac{\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right) - 1}{\\exp\\left(\\frac{c_2}{\\lambda T_b}\\right)} = \\frac{\\lambda T_b^2}{c_2 L_{\\lambda}} \\left(1 - \\exp\\left(-\\frac{c_2}{\\lambda T_b}\\right)\\right)$$\n我们已经计算了指数中的参数：$\\frac{c_2}{\\lambda T_b} \\approx 4.44723$。\n$$\\frac{dT_b}{dL_{\\lambda}} \\approx \\frac{(10.8 \\times 10^{-6}) (299.56)^2}{(0.01438777)(9.60 \\times 10^6)} \\left(1 - \\exp(-4.44723)\\right)$$\n$$\\frac{dT_b}{dL_{\\lambda}} \\approx \\frac{0.96910}{138122.6} (1 - 0.01171) \\approx (7.0163 \\times 10^{-6})(0.98829) \\approx 6.9344 \\times 10^{-6} \\ \\mathrm{K} \\cdot (\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1})^{-1}$$\n\n**4. 最终亮度温度不确定性 $\\sigma_{T_b}$**\n\n最后，我们整合结果。亮度温度的不确定性是辐亮度灵敏度与辐亮度标准差的乘积：\n$$\\sigma_{T_b} = \\left| \\frac{dT_b}{dL_{\\lambda}} \\right| \\sigma_{L_{\\lambda}}$$\n$$\\sigma_{T_b} \\approx (6.9344 \\times 10^{-6}) \\cdot (72801.1) \\approx 0.50484 \\ \\mathrm{K}$$\n问题要求将答案四舍五入到三位有效数字。\n$$\\sigma_{T_b} \\approx 0.505 \\ \\mathrm{K}$$",
            "answer": "$$\n\\boxed{0.505}\n$$"
        },
        {
            "introduction": "卫星测得的亮度温度并非真实的地表温度，它会受到大气和地表发射率的共同影响。本练习介绍了一种强大的技术——劈窗算法，它利用两个相邻热红外通道的观测值来校正这些影响。掌握这种方法使您能够反演得到准确的地表温度（$T_s$），这是量化城市热岛效应的核心变量。",
            "id": "3864213",
            "problem": "使用来自一个极轨传感器的热红外观测数据进行密集城市核心区的夜间城市热岛反演，该传感器具有两个分别以$11\\,\\mu\\mathrm{m}$和$12\\,\\mu\\mathrm{m}$为中心的大气窗口通道。令 $T_{11}$ 和 $T_{12}$ 分别表示 $11\\,\\mu\\mathrm{m}$ 和 $12\\,\\mu\\mathrm{m}$ 通道的大气层顶亮温，单位为开尔文。假设城市地表在像元内是等温的，并且在热红外波段呈朗伯体特性，其已知平均发射率为 $\\varepsilon$，发射率差异为 $\\Delta \\varepsilon \\equiv \\varepsilon_{11}-\\varepsilon_{12}$。大气状态由总水汽柱含量 $W$（单位为 $\\mathrm{g}\\,\\mathrm{cm}^{-2}$）来概括。作为城市热岛分析工作流的一部分，目标是估算该城市像元的地表温度 $T_{s}$。\n\n从大气层顶的上行辐射亮度的热红外辐射传输方程以及亮温（定义为应用于辐射亮度的普朗克函数的反函数）出发，在分裂窗线性化和通道间亮温差的二阶校正条件下，推导 $T_{s}$ 对 $T_{11}$、$T_{12}$、$\\varepsilon$、$\\Delta \\varepsilon$ 和 $W$ 的函数依赖关系。然后，使用提供的回归系数（这些系数包含了传感器光谱响应和代表性的中纬度大气透过率行为信息），为下面描述的具体场景计算 $T_{s}$ 的值。\n\n对该城市像元使用以下输入：\n- $T_{11} = 315.2\\,\\mathrm{K}$，\n- $T_{12} = 313.7\\,\\mathrm{K}$，\n- $\\varepsilon = 0.964$，\n- $\\Delta \\varepsilon = 0.010$，\n- $W = 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$。\n\n采用以下分裂窗回归系数（除特别注明外，均为无量纲），这些系数是针对具有$11\\,\\mu\\mathrm{m}$和$12\\,\\mu\\mathrm{m}$通道的传感器在中纬度夏季大气条件下校准的：\n- $a_{0} = -0.268$，\n- $a_{1} = 1.378$，\n- $a_{2} = 0.183$，\n- $a_{3} = 54.3$，\n- $a_{4} = -2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$，\n- $a_{5} = -129.2$，\n- $a_{6} = 16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$。\n\n计算并报告该像元的地表温度 $T_{s}$。最终答案以开尔文表示，并四舍五入到四位有效数字。",
            "solution": "用户希望解决一个热遥感问题。\n\n### 步骤1：提取已知条件\n-   **传感器通道：** $11\\,\\mu\\mathrm{m}$ 和 $12\\,\\mu\\mathrm{m}$。\n-   **大气层顶亮温：** $T_{11}$ 和 $T_{12}$。\n-   **地表属性：** 平均发射率 $\\varepsilon$，发射率差异 $\\Delta \\varepsilon \\equiv \\varepsilon_{11}-\\varepsilon_{12}$。\n-   **大气状态：** 总水汽柱含量 $W$。\n-   **目标：** 估算地表温度 $T_{s}$。\n-   **方法：** 使用分裂窗线性化和通道间亮温差的二阶校正，推导 $T_{s}$ 对 $T_{11}$、$T_{12}$、$\\varepsilon$、$\\Delta \\varepsilon$ 和 $W$ 的函数依赖关系。然后，使用提供的数据计算 $T_s$。\n-   **计算用输入数据：**\n    -   $T_{11} = 315.2\\,\\mathrm{K}$\n    -   $T_{12} = 313.7\\,\\mathrm{K}$\n    -   $\\varepsilon = 0.964$\n    -   $\\Delta \\varepsilon = 0.010$\n    -   $W = 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}$\n-   **回归系数：**\n    -   $a_{0} = -0.268$\n    -   $a_{1} = 1.378$\n    -   $a_{2} = 0.183$\n    -   $a_{3} = 54.3$\n    -   $a_{4} = -2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$\n    -   $a_{5} = -129.2$\n    -   $a_{6} = 16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$\n-   **最终答案要求：** 以开尔文报告 $T_s$，并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n所提出的问题是定量热遥感领域的一个标准应用。它要求使用分裂窗算法计算地表温度（LST），这是一种利用两个相邻热红外大气窗口通道的观测数据的成熟技术。\n\n-   **科学依据：** 该问题牢固地植根于辐射传输理论和遥感科学的原理。辐射传输方程、普朗克定律、亮温的概念以及分裂窗算法的物理基础（主要是由水汽引起的大气差分吸收）都是该学科的基础。指定的算法结构，包括对大气效应和地表发射率的校正，代表了一种常见且有效的方法。\n-   **适定性：** 该问题提供了一套完整的输入参数和回归系数，以及对算法类型（“分裂窗线性化和二阶校正”）的足够详细的描述。这些信息隐含地定义了一个特定的数学公式，确保可以计算出唯一的解。输入值（$T_{11}$、$T_{12}$、$\\varepsilon$、$W$）对于暖季的夜间城市环境是物理上合理的。\n-   **客观性和一致性：** 该问题使用客观、精确的科学语言陈述。所有提供的数据和系数在数值和量纲上都与常见的广义分裂窗算法的结构一致。不存在内部矛盾、歧义或主观论断。\n\n该问题是一个定义明确、科学有效且可解的物理问题。\n\n### 步骤3：结论和行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 解答推导与计算\n\n从星载热传感器估算地表温度（$T_s$）需要校正路径大气和地表非黑体性质（即发射率 $\\varepsilon  1$）的影响。分裂窗技术是为此目的而广泛使用的一种方法。\n\n其物理基础是传感器在通道 $i$ 测量到的热辐射的辐射传输方程（RTE）：\n$$L_{i} = \\varepsilon_{i} B_{i}(T_s) \\tau_{i} + L^{\\uparrow}_{i, \\text{atm}} + (1 - \\varepsilon_{i}) L^{\\downarrow}_{i, \\text{atm}} \\tau_{i}$$\n在此，$L_{i}$ 是传感器处接收到的辐射亮度，$\\varepsilon_{i}$ 是地表发射率，$B_{i}(T_s)$ 是对温度为 $T_s$ 的地表在通道响应函数上积分后的普朗克函数值，$\\tau_i$ 是大气透过率，而 $L^{\\uparrow}_{i, \\text{atm}}$ 和 $L^{\\downarrow}_{i, \\text{atm}}$ 分别是上行和下行大气路径辐射亮度。\n\n亮温 $T_{i}$ 定义为发射相同辐射亮度 $L_i$ 的黑体的温度，即 $L_i = B_i(T_i)$。求解辐射传输方程以得到 $T_s$ 是一个不适定反演问题，因为它涉及多个未知数（$T_s$、$\\varepsilon_i$、$\\tau_i$、$L^{\\uparrow}_{i, \\text{atm}}$、$L^{\\downarrow}_{i, \\text{atm}}$）而只有两个测量值（$T_{11}$、$T_{12}$）。\n\n分裂窗方法通过利用 $11\\,\\mu\\mathrm{m}$ 和 $12\\,\\mu\\mathrm{m}$ 通道之间的差分吸收（这主要是总水汽柱含量 $W$ 的函数）来克服这个问题。通过对普朗克函数进行线性化并做出近似，可以将 $T_s$ 表示为测量的亮温 $T_{11}$ 和 $T_{12}$ 以及发射率校正的函数。包含一个亮温差的二次项 $(T_{11} - T_{12})^2$，可以增强对更广泛大气条件的校正，正如题目中“二阶校正”的要求。\n\n该问题暗示了一种文献中常见的、基于回归的特定算法结构，该结构将这些校正形式化。根据所提供的变量和系数（$a_0$ 到 $a_6$），$T_s$ 的函数形式是一个广义分裂窗算法：\n$$T_s = T_{11} + a_1(T_{11}-T_{12}) + a_2(T_{11}-T_{12})^2 + a_0 + (a_3 + a_4 W)(1-\\varepsilon) + (a_5 + a_6 W)\\Delta\\varepsilon$$\n此方程考虑了：\n-   一个基准温度（$T_{11}$）。\n-   一个一阶大气校正，与亮温差成线性关系（$a_1(T_{11}-T_{12})$）。\n-   一个二阶大气校正，与亮温差的平方成二次关系（$a_2(T_{11}-T_{12})^2$）。\n-   一个常数偏移量（$a_0$）。\n-   一个发射率幅度校正，其中 $(1-\\varepsilon)$ 项与反射的下行辐射亮度有关。该项的系数取决于水汽柱含量 $W$。\n-   一个发射率光谱对比度校正，与 $\\Delta\\varepsilon$ 有关，其系数也取决于 $W$。\n\n我们现在将给定值代入该方程来计算 $T_s$。\n\n首先，我们计算中间量：\n-   亮温差：$T_{11} - T_{12} = 315.2\\,\\mathrm{K} - 313.7\\,\\mathrm{K} = 1.5\\,\\mathrm{K}$。\n-   亮温差的平方：$(T_{11} - T_{12})^2 = (1.5\\,\\mathrm{K})^2 = 2.25\\,\\mathrm{K}^2$。\n-   发射率项：$1 - \\varepsilon = 1 - 0.964 = 0.036$。\n-   发射率差异：$\\Delta \\varepsilon = 0.010$。\n\n接下来，我们计算方程的主要组成部分：\n-   第1项（$T_{11}$）：$315.2\\,\\mathrm{K}$\n-   第2项（线性大气校正）：$a_1(T_{11}-T_{12}) = 1.378 \\times 1.5 = 2.067\\,\\mathrm{K}$\n-   第3项（二次大气校正）：$a_2(T_{11}-T_{12})^2 = 0.183 \\times 2.25 = 0.41175\\,\\mathrm{K}$\n-   第4项（偏移量）：$a_0 = -0.268\\,\\mathrm{K}$\n-   第5项（发射率幅度校正）：$(a_3 + a_4 W)(1-\\varepsilon)$\n    -   水汽依赖部分：$a_3 + a_4 W = 54.3 + (-2.238\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1} \\times 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}) = 54.3 - 4.9236 = 49.3764$。题目陈述意味着，为了量纲一致性，$a_3$ 和 $a_5$ 的单位应为开尔文，因此该项的单位为开尔文。\n    -   完整项：$49.3764\\,\\mathrm{K} \\times 0.036 = 1.7775504\\,\\mathrm{K}$\n-   第6项（发射率光谱对比度校正）：$(a_5 + a_6 W)\\Delta\\varepsilon$\n    -   水汽依赖部分：$a_5 + a_6 W = -129.2 + (16.4\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1} \\times 2.2\\,\\mathrm{g}\\,\\mathrm{cm}^{-2}) = -129.2 + 36.08 = -93.12$。该项的单位为开尔文。\n    -   完整项：$-93.12\\,\\mathrm{K} \\times 0.010 = -0.9312\\,\\mathrm{K}$\n\n最后，我们将所有项相加得到 $T_s$：\n$$T_s = 315.2 + 2.067 + 0.41175 - 0.268 + 1.7775504 - 0.9312$$\n$$T_s = 318.2571004\\,\\mathrm{K}$$\n\n按照要求将最终结果四舍五入到四位有效数字：\n$$T_s \\approx 318.3\\,\\mathrm{K}$$",
            "answer": "$$\n\\boxed{318.3}\n$$"
        },
        {
            "introduction": "成功反演地表温度后，关键的下一步是理解驱动其时空变化的物理机制。本实践应用地表能量平衡模型，来探究城市结构和材料特性（如反照率 $\\alpha$ 和天空视域因子 SVF）如何影响净辐射并最终决定地表温度。通过敏感性分析，您将获得关于城市规划决策如何改变局地气候和缓解热岛效应的定量见解。",
            "id": "3864207",
            "problem": "您的任务是设计并实现一个敏感性分析，以量化在晴朗夏日，地表反照率和天空视域因子（SVF）的变化如何独立影响净辐射和地表温度。您编写的程序必须计算敏感性并评估特定的边界情况。该分析必须基于基本的辐射和能量平衡定律，并且所有输出都必须以所要求的单位进行数值指定。\n\n假设存在以下物理背景和建模假设：\n- 使用斯蒂芬-玻尔兹曼定律计算长波辐射，其中斯蒂芬-玻尔兹曼常数 $\\sigma = 5.670374419 \\times 10^{-8}\\ \\mathrm{W\\,m^{-2}\\,K^{-4}}$。\n- 对于一个水平城市表面，晴朗天空正午的理想化稳态地表能量平衡模型为 $R_n = H + \\mathrm{LE} + G$，其中 $R_n$ 是净辐射，$H$ 是感热通量，$\\mathrm{LE}$ 是潜热通量，$G$ 是地表热通量。将非辐射通量之和线性化为一个集总项 $H + \\mathrm{LE} + G \\approx \\Lambda \\left(T_s - T_a\\right)$，其中 $T_s$ 是地表温度，$T_a$ 是气温，$\\Lambda$ 是一个有效集总传热系数。\n- 将净辐射定义为 $R_n = (1 - \\alpha)\\,S_{\\downarrow,\\mathrm{eff}} + \\varepsilon_s \\left(L_{\\downarrow,\\mathrm{eff}} - \\sigma T_s^4\\right)$，其中 $\\alpha$ 是地表反照率，$S_{\\downarrow,\\mathrm{eff}}$ 是地表的有效向下短波辐照度，$\\varepsilon_s$ 是地表长波发射率，$L_{\\downarrow,\\mathrm{eff}}$ 是地表的有效向下长波辐照度。\n- 按如下方式模拟天空视域因子（SVF）对有效辐射强迫的影响：令 $S_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF}\\,S_{\\downarrow}$，并令 $L_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF}\\,L_{\\downarrow} + (1 - \\mathrm{SVF})\\,\\sigma T_a^4$，代表天空与周围温度等于气温的峡谷表面之间的线性混合。\n\n晴朗夏日正午情景的参数值指定如下：\n- 气温 $T_a = 303\\ \\mathrm{K}$。\n- 全球水平短波辐照度 $S_{\\downarrow} = 900\\ \\mathrm{W\\,m^{-2}}$。\n- 大气发射率 $\\varepsilon_a = 0.82$，得出向下长波辐射 $L_{\\downarrow} = \\varepsilon_a \\sigma T_a^4$，单位为 $\\mathrm{W\\,m^{-2}}$。\n- 地表发射率 $\\varepsilon_s = 0.95$（无量纲）。\n- 集总传热系数 $\\Lambda = 15\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n您的任务是：\n1. 从上述基本定律推导出关于稳态下 $T_s$ 的单个非线性标量方程，并将其作为 $(\\alpha,\\mathrm{SVF})$ 的函数进行数值求解，然后一致地计算 $R_n$。\n2. 使用对称有限差分法，在基线处计算偏导数（敏感性）：\n   - 基线参数：$\\alpha_0 = 0.20$，$\\mathrm{SVF}_0 = 0.70$。\n   - 扰动：$\\Delta \\alpha = 0.02$，$\\Delta \\mathrm{SVF} = 0.05$。\n   - 所需敏感性：\n     - $\\partial R_n / \\partial \\alpha$，单位为 $\\mathrm{W\\,m^{-2}}$ / 每单位 $\\alpha$ 变化，\n     - $\\partial T_s / \\partial \\alpha$，单位为 $\\mathrm{K}$ / 每单位 $\\alpha$ 变化，\n     - $\\partial R_n / \\partial \\mathrm{SVF}$，单位为 $\\mathrm{W\\,m^{-2}}$ / 每单位 $\\mathrm{SVF}$ 变化，\n     - $\\partial T_s / \\partial \\mathrm{SVF}$，单位为 $\\mathrm{K}$ / 每单位 $\\mathrm{SVF}$ 变化。\n   使用中心差分法在 $(\\alpha_0,\\mathrm{SVF}_0)$ 处计算这些导数。\n3. 通过为以下情况计算 $(T_s,R_n)$ 来评估边界和边缘情况：\n   - 固定的 $\\mathrm{SVF}=\\mathrm{SVF}_0$，低反照率 $\\alpha=0.05$。\n   - 固定的 $\\mathrm{SVF}=\\mathrm{SVF}_0$，高反照率 $\\alpha=0.50$。\n   - 固定的 $\\alpha=\\alpha_0$，低 $\\mathrm{SVF}=0.30$。\n   - 固定的 $\\alpha=\\alpha_0$，高 $\\mathrm{SVF}=1.00$。\n   - 组合极端情况：$\\alpha=0.05$，$\\mathrm{SVF}=1.00$。\n\n数学和算法要求：\n- 从上述定义和斯蒂芬-玻尔兹曼定律出发，获得 $T_s$ 的标量方程，形式为 $f(T_s;\\alpha,\\mathrm{SVF})=0$，并通过求根法求解 $T_s$。然后使用能量平衡一致性 $R_n = \\Lambda\\left(T_s - T_a\\right)$ 来计算 $R_n$。\n- 以 $\\mathrm{K}$ 为单位表示地表温度 $T_s$，以 $\\mathrm{W\\,m^{-2}}$ 为单位表示净辐射 $R_n$。\n- 所有角度（若有）必须以弧度为单位；此任务中没有角度。\n\n测试套件：\n- 使用上述指定的基线和扰动，通过中心差分法计算 $4$ 种敏感性。\n- 为上述给出的 $5$ 个边界和边缘情况计算 $(T_s,R_n)$ 对。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表。该列表必须按以下顺序排列：\n  [$\\partial R_n/\\partial \\alpha$, $\\partial T_s/\\partial \\alpha$, $\\partial R_n/\\partial \\mathrm{SVF}$, $\\partial T_s/\\partial \\mathrm{SVF}$, $T_s(\\alpha{=}0.05,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $R_n(\\alpha{=}0.05,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $T_s(\\alpha{=}0.50,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $R_n(\\alpha{=}0.50,\\mathrm{SVF}{=}\\mathrm{SVF}_0)$, $T_s(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}0.30)$, $R_n(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}0.30)$, $T_s(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}1.00)$, $R_n(\\alpha{=}\\alpha_0,\\mathrm{SVF}{=}1.00)$, $T_s(\\alpha{=}0.05,\\mathrm{SVF}{=}1.00)$, $R_n(\\alpha{=}0.05,\\mathrm{SVF}{=}1.00)$]。\n- 将输出中的每个数字四舍五入到恰好 $3$ 位小数。",
            "solution": "该问题是有效的。其科学基础是辐射传输和地表能量平衡原理，数学上是适定的，并为唯一解提供了所有必要的参数和方程。该模型虽然经过简化，却是城市气候学和环境建模中使用的标准表示方法。\n\n解决方案分为三个主要步骤：\n1. 从能量平衡原理推导地表温度（$T_s$）的控制性非线性标量方程。\n2. 设计一个数值算法来求解 $T_s$ 并随后计算净辐射（$R_n$）。\n3. 应用此算法计算所需的敏感性并评估指定的边界情况。\n\n**1. 地表温度控制方程的推导**\n\n基本原理是地表能量守恒。在稳态下，净辐射（$R_n$）必须与非辐射热通量（感热 $H$、潜热 $\\mathrm{LE}$ 和地表热 $G$）的总和相平衡。问题为 $R_n$ 提供了两个表达式：一个来自辐射分量，另一个来自线性化的非辐射通量。\n\n能量平衡方程为：\n$$R_n = H + \\mathrm{LE} + G$$\n\n问题为非辐射通量提供了一个线性化表达式：\n$$H + \\mathrm{LE} + G \\approx \\Lambda (T_s - T_a)$$\n其中 $\\Lambda$ 是集总传热系数，$T_s$ 是地表温度，$T_a$ 是气温。\n\n净辐射 $R_n$ 是净短波辐射和净长波辐射的总和：\n$$R_n = (1 - \\alpha) S_{\\downarrow,\\mathrm{eff}} + \\varepsilon_s (L_{\\downarrow,\\mathrm{eff}} - \\sigma T_s^4)$$\n其中 $\\alpha$ 是反照率，$S_{\\downarrow,\\mathrm{eff}}$ 是有效向下短波辐射，$\\varepsilon_s$ 是地表发射率，$L_{\\downarrow,\\mathrm{eff}}$ 是有效向下长波辐射，$\\sigma$ 是斯蒂芬-玻尔兹曼常数。项 $\\varepsilon_s \\sigma T_s^4$ 代表地表发出的长波辐射，与斯蒂芬-玻尔兹曼定律和基尔霍夫热辐射定律（吸收率等于发射率）一致。\n\n通过令 $R_n$ 的两个表达式相等，我们为系统的稳态建立了一个单一方程：\n$$\\Lambda (T_s - T_a) = (1 - \\alpha) S_{\\downarrow,\\mathrm{eff}} + \\varepsilon_s (L_{\\downarrow,\\mathrm{eff}} - \\sigma T_s^4)$$\n\n接下来，我们代入给定的有效辐照度模型，这些模型依赖于天空视域因子（$\\mathrm{SVF}$）：\n$$S_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF} \\cdot S_{\\downarrow}$$\n$$L_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF} \\cdot L_{\\downarrow} + (1 - \\mathrm{SVF}) \\sigma T_a^4$$\n以及向下大气长波辐射：\n$$L_{\\downarrow} = \\varepsilon_a \\sigma T_a^4$$\n将 $L_{\\downarrow}$ 代入 $L_{\\downarrow,\\mathrm{eff}}$ 的表达式中，得到：\n$$L_{\\downarrow,\\mathrm{eff}} = \\mathrm{SVF} (\\varepsilon_a \\sigma T_a^4) + (1 - \\mathrm{SVF}) \\sigma T_a^4 = \\sigma T_a^4 (\\mathrm{SVF} \\cdot \\varepsilon_a + 1 - \\mathrm{SVF})$$\n\n现在，我们将 $S_{\\downarrow,\\mathrm{eff}}$ 和 $L_{\\downarrow,\\mathrm{eff}}$ 代入能量平衡方程：\n$$\\Lambda (T_s - T_a) = (1 - \\alpha)(\\mathrm{SVF} \\cdot S_{\\downarrow}) + \\varepsilon_s \\left[ \\sigma T_a^4 (\\mathrm{SVF} \\cdot \\varepsilon_a + 1 - \\mathrm{SVF}) - \\sigma T_s^4 \\right]$$\n\n为了求出 $T_s$，我们将其重新整理为 $f(T_s; \\alpha, \\mathrm{SVF}) = 0$ 形式的求根问题。\n$$f(T_s) = \\varepsilon_s \\sigma T_s^4 + \\Lambda T_s - \\Lambda T_a - (1 - \\alpha)\\mathrm{SVF}S_{\\downarrow} - \\varepsilon_s \\sigma T_a^4 (\\mathrm{SVF} \\cdot \\varepsilon_a + 1 - \\mathrm{SVF}) = 0$$\n这就是最终的 $T_s$ 的非线性标量方程。\n\n**2. 数值解法与敏感性分析**\n\n该方程无法解析求解 $T_s$。需要一个数值求根算法。对于有物理意义的温度（$T_s  0$），函数 $f(T_s)$ 是单调递增的，因为其导数 $f'(T_s) = 4\\varepsilon_s \\sigma T_s^3 + \\Lambda$ 始终为正。这保证了存在唯一的正根。我们将使用基于牛顿-拉夫逊法的求解器。\n\n一旦对于给定的参数集 $(\\alpha, \\mathrm{SVF})$ 确定了 $T_s$，就使用问题陈述中指定的线性化通量表达式来一致地计算净辐射 $R_n$：\n$$R_n = \\Lambda (T_s - T_a)$$\n\n敏感性（偏导数）使用在基线点 $(\\alpha_0, \\mathrm{SVF}_0)$ 的对称有限差分近似法计算：\n$$\\frac{\\partial T_s}{\\partial \\alpha} \\approx \\frac{T_s(\\alpha_0 + \\Delta\\alpha, \\mathrm{SVF}_0) - T_s(\\alpha_0 - \\Delta\\alpha, \\mathrm{SVF}_0)}{2 \\Delta\\alpha}$$\n$$\\frac{\\partial R_n}{\\partial \\alpha} \\approx \\frac{R_n(\\alpha_0 + \\Delta\\alpha, \\mathrm{SVF}_0) - R_n(\\alpha_0 - \\Delta\\alpha, \\mathrm{SVF}_0)}{2 \\Delta\\alpha}$$\n对于关于 $\\mathrm{SVF}$ 的偏导数，使用类似的公式和扰动 $\\Delta\\mathrm{SVF}$。\n\n**3. 测试用例的实现**\n\n总体算法如下：\n1. 定义一个函数，该函数以 $\\alpha$ 和 $\\mathrm{SVF}$ 作为输入，构造函数 $f(T_s)$ 及其导数 $f'(T_s)$，并使用数值求根器求解 $f(T_s)=0$ 以得到 $T_s$。气温 $T_a$ 可作为一个良好的初始猜测值。\n2. 然后，该函数计算 $R_n = \\Lambda (T_s - T_a)$ 并返回对 $(T_s, R_n)$。\n3. 为了计算敏感性，为扰动后的参数值 $(\\alpha_0 \\pm \\Delta\\alpha, \\mathrm{SVF}_0)$ 和 $(\\alpha_0, \\mathrm{SVF}_0 \\pm \\Delta\\mathrm{SVF})$ 调用此函数。然后将有限差分公式应用于结果。\n4. 为了评估边界和边缘情况，为五个指定的 $(\\alpha, \\mathrm{SVF})$ 对中的每一个调用该函数。\n5. 将所有得到的十四个数值收集起来，四舍五入到三位小数，并格式化为最终的输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import newton as root_finder\n\ndef solve():\n    \"\"\"\n    Solves the urban surface energy balance problem, calculating sensitivities\n    and boundary case values for surface temperature and net radiation.\n    \"\"\"\n    #\n    # Step 1: Define physical constants and scenario parameters\n    #\n    SIGMA = 5.670374419e-8  # Stefan-Boltzmann constant (W m^-2 K^-4)\n    TA = 303.0               # Air temperature (K)\n    S_DOWN = 900.0           # Global horizontal shortwave irradiance (W m^-2)\n    EPS_A = 0.82             # Atmospheric emissivity (dimensionless)\n    EPS_S = 0.95             # Surface emissivity (dimensionless)\n    LAMBDA = 15.0            # Bulk transfer coefficient (W m^-2 K^-1)\n\n    # Pre-calculate constants\n    L_DOWN_ATM = EPS_A * SIGMA * TA**4\n    TA_TERM_LONGWAVE = SIGMA * TA**4\n\n    def calculate_Ts_Rn(alpha, svf):\n        \"\"\"\n        Calculates steady-state surface temperature (Ts) and net radiation (Rn)\n        for a given albedo (alpha) and Sky View Factor (svf).\n        \n        Args:\n            alpha (float): Surface albedo (dimensionless, 0-1).\n            svf (float): Sky View Factor (dimensionless, 0-1).\n\n        Returns:\n            tuple[float, float]: A tuple containing (Ts in K, Rn in W/m^2).\n        \"\"\"\n        # Effective radiative forcings based on SVF\n        S_down_eff = svf * S_DOWN\n        L_down_eff = svf * L_DOWN_ATM + (1 - svf) * TA_TERM_LONGWAVE\n\n        # Define the function f(Ts) = 0 to be solved.\n        # f(Ts) = ε_s*σ*Ts^4 + Λ*Ts - (all other constant terms) = 0\n        constant_terms = (\n            LAMBDA * TA\n            + (1 - alpha) * S_down_eff\n            + EPS_S * L_down_eff\n        )\n        \n        def f(Ts):\n            return EPS_S * SIGMA * Ts**4 + LAMBDA * Ts - constant_terms\n\n        # Define the derivative of f(Ts) for a more efficient solver\n        def f_prime(Ts):\n            return 4 * EPS_S * SIGMA * Ts**3 + LAMBDA\n\n        # Solve for Ts using Newton-Raphson method with an initial guess of Ta\n        Ts = root_finder(f, x0=TA, fprime=f_prime)\n        \n        # Calculate Rn consistently with the found Ts\n        Rn = LAMBDA * (Ts - TA)\n        \n        return Ts, Rn\n\n    #\n    # Step 2: Calculate sensitivities using symmetric finite differences\n    #\n    alpha0 = 0.20\n    svf0 = 0.70\n    delta_alpha = 0.02\n    delta_svf = 0.05\n\n    # Perturbations for albedo\n    Ts_alpha_plus, Rn_alpha_plus = calculate_Ts_Rn(alpha0 + delta_alpha, svf0)\n    Ts_alpha_minus, Rn_alpha_minus = calculate_Ts_Rn(alpha0 - delta_alpha, svf0)\n\n    # Perturbations for SVF\n    Ts_svf_plus, Rn_svf_plus = calculate_Ts_Rn(alpha0, svf0 + delta_svf)\n    Ts_svf_minus, Rn_svf_minus = calculate_Ts_Rn(alpha0, svf0 - delta_svf)\n\n    # Compute sensitivities\n    dRn_dalpha = (Rn_alpha_plus - Rn_alpha_minus) / (2 * delta_alpha)\n    dTs_dalpha = (Ts_alpha_plus - Ts_alpha_minus) / (2 * delta_alpha)\n    dRn_dsvf = (Rn_svf_plus - Rn_svf_minus) / (2 * delta_svf)\n    dTs_dsvf = (Ts_svf_plus - Ts_svf_minus) / (2 * delta_svf)\n\n    sensitivities = [dRn_dalpha, dTs_dalpha, dRn_dsvf, dTs_dsvf]\n\n    #\n    # Step 3: Evaluate boundary and edge cases\n    #\n    boundary_cases = [\n        (0.05, svf0),   # low albedo, baseline SVF\n        (0.50, svf0),   # high albedo, baseline SVF\n        (alpha0, 0.30), # baseline albedo, low SVF\n        (alpha0, 1.00), # baseline albedo, high SVF\n        (0.05, 1.00),   # combined extreme: low albedo, high SVF\n    ]\n    \n    boundary_results = []\n    for alpha_case, svf_case in boundary_cases:\n        Ts_case, Rn_case = calculate_Ts_Rn(alpha_case, svf_case)\n        boundary_results.extend([Ts_case, Rn_case])\n\n    #\n    # Step 4: Combine all results and format for output\n    #\n    all_results = sensitivities + boundary_results\n    \n    formatted_results = [f\"{val:.3f}\" for val in all_results]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}