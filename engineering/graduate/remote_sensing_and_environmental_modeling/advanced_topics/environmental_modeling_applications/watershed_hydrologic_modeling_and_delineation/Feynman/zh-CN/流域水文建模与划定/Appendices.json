{
    "hands_on_practices": [
        {
            "introduction": "在进行任何水文建模之前，我们必须首先确保研究区域在空间上的准确表达。本练习将通过一个具体计算，揭示选择不当的坐标参考系统（CRS）可能导致的严重后果，特别是直接在地理坐标系（经纬度）中计算面积所引入的重大误差。通过亲手量化这一误差 ，您将深刻理解为何在水文学中进行严谨的地理空间分析必须从正确的地图投影开始。",
            "id": "3866205",
            "problem": "一位水文分析师从数字高程模型（DEM）中划定了一个小型源头流域，并计划计算其面积用于径流模拟。该流域边界在地理信息系统（GIS）中以地理坐标参考系统（CRS）的经纬度表示。分析师考虑了两种方法：（i）在地理CRS中进行面积计算，方法是将纬度和经度的度数统一使用恒定的每度赤道长度转换为米；（ii）重新投影到保持面积不变的等面积投影。请从第一性原理出发，解释CRS的选择如何影响球体上的面积和长度计算，然后量化使用（i）中描述的地理CRS方法而非（ii）中的等面积方法所引入的误差。\n\n假设地球为一半径 $R = 6.371 \\times 10^{6}$ 米的球体。该流域可局部近似为一个以纬度 $\\phi_{0} = 45^{\\circ}$ 为中心、纬度跨度 $\\Delta \\phi = 0.10^{\\circ}$、经度跨度 $\\Delta \\lambda = 0.20^{\\circ}$ 的经纬度矩形。在地理CRS方法中，分析师简单地将纬度和经度的度数都使用赤道上每度的长度（即 $L_{\\phi}^{\\text{eq}} = L_{\\lambda}^{\\text{eq}} = \\pi R / 180$）转换为米，然后相乘以获得面积。\n\n从球面面积元出发，推导与该矩形对应的真实球面面积以及在分析师假设下的朴素地理CRS面积的表达式。然后计算定义为 $(A_{\\text{naive}} - A_{\\text{true}})/A_{\\text{true}}$ 的相对误差。最终答案四舍五入至四位有效数字。将最终误差表示为无量纲的小数（无单位）。",
            "solution": "题目陈述已经过验证，被认为是有效的。它在科学上基于大地测量学和球面几何学的原理，问题设定良好，目标明确，数据充分，并且表述客观。因此，我们可以着手求解。\n\n这个问题的核心在于地图学的基本挑战：将地球的曲面表示在平面上。坐标参考系统（CRS）为这种表示提供了框架。地理CRS使用纬度（$\\phi$）和经度（$\\lambda$），以角度单位在球面或椭球模型上指定位置。投影CRS将这些角度坐标转换到二维笛卡尔网格上，这一过程不可避免地会在一个或多个几何属性上引入畸变：面积、形状、距离或方向。等面积投影，即方法（ii）中提到的，是专门设计用来保持面积度量不变的，这使其成为流域面积计算等应用的标配。\n\n分析师的第一种方法（i）犯了一个常见但重大的错误：它将地理坐标（经纬度的度数）当作平面上的均匀网格来处理。我们将从第一性原理出发来量化这个误差。\n\n让我们将地球建模为一个半径为 $R$ 的完美球体。球体上路径的长度由弧长公式确定。\n对应于纬度变化 $\\Delta\\phi$（以弧度为单位）的子午线弧（经度恒定的线）的长度由以下公式给出：\n$$L_{\\text{meridian}} = R \\cdot \\Delta\\phi$$\n这个长度与在球体上的位置无关。\n\n对应于经度变化 $\\Delta\\lambda$（以弧度为单位）的纬线弧（纬度 $\\phi$ 恒定的线）的长度取决于纬度。在纬度 $\\phi$ 处的纬线圈的半径是 $R \\cos(\\phi)$。因此，弧长为：\n$$L_{\\text{parallel}} = (R \\cos(\\phi)) \\cdot \\Delta\\lambda$$\n对 $\\cos(\\phi)$ 的这种依赖性是关键因素。一度经度的长度在赤道处最大（$\\phi=0$，此时 $\\cos(\\phi)=1$），并在两极处缩小到零（$\\phi = \\pm 90^{\\circ}$，此时 $\\cos(\\phi)=0$）。\n\n基于这些原理，我们可以推导出指定矩形的真实面积和通过朴素方法计算出的面积。\n\n**1. 真实面积计算 ($A_{\\text{true}}$)**\n\n球体表面上一个区域的真实面积是通过在该区域上对微分表面积元 $dS$ 进行积分得到的。在球面坐标（纬度 $\\phi$，经度 $\\lambda$）中，面积元由下式给出：\n$$dS = R^2 \\cos(\\phi) \\, d\\phi \\, d\\lambda$$\n该流域近似为一个由纬度 $\\phi_1$ 和 $\\phi_2$ 以及经度 $\\lambda_1$ 和 $\\lambda_2$ 界定的矩形。\n给定中心纬度 $\\phi_0 = 45^{\\circ}$ 和纬度跨度 $\\Delta\\phi = 0.10^{\\circ}$，则边界纬度为：\n$$\\phi_1 = \\phi_0 - \\frac{\\Delta\\phi}{2} = 45^{\\circ} - 0.05^{\\circ} = 44.95^{\\circ}$$\n$$\\phi_2 = \\phi_0 + \\frac{\\Delta\\phi}{2} = 45^{\\circ} + 0.05^{\\circ} = 45.05^{\\circ}$$\n经度跨度给定为 $\\Delta\\lambda = 0.20^{\\circ}$。\n\n为了计算面积，我们对 $dS$ 在这些界限内进行积分。所有角度都必须通过乘以因子 $\\frac{\\pi}{180}$ 转换为弧度来进行计算。设 $\\Delta\\lambda_{\\text{rad}}$ 为以弧度表示的经度跨度。\n$$A_{\\text{true}} = \\int_{\\lambda_1}^{\\lambda_2} \\int_{\\phi_1}^{\\phi_2} R^2 \\cos(\\phi) \\, d\\phi \\, d\\lambda$$\n该积分为可分离的：\n$$A_{\\text{true}} = R^2 \\left( \\int_{\\lambda_1}^{\\lambda_2} d\\lambda \\right) \\left( \\int_{\\phi_1}^{\\phi_2} \\cos(\\phi) \\, d\\phi \\right)$$\n计算积分，其中角度 $\\phi_1$ 和 $\\phi_2$ 以弧度为单位：\n$$A_{\\text{true}} = R^2 (\\lambda_2 - \\lambda_1) [\\sin(\\phi)]_{\\phi_1}^{\\phi_2}$$\n$$A_{\\text{true}} = R^2 (\\Delta\\lambda_{\\text{rad}}) [\\sin(\\phi_2) - \\sin(\\phi_1)]$$\n\n**2. 朴素面积计算 ($A_{\\text{naive}}$)**\n\n分析师的朴素方法对纬度和经度都使用基于赤道周长的恒定长度转换：\n$$L_{\\text{per degree}} = \\frac{2\\pi R}{360^{\\circ}} = \\frac{\\pi R}{180^{\\circ}}$$\n矩形的“高度”是根据纬度跨度 $\\Delta\\phi$（以度为单位）计算的：\n$$H_{\\text{naive}} = \\Delta\\phi \\cdot \\frac{\\pi R}{180} = R \\cdot \\left(\\Delta\\phi \\frac{\\pi}{180}\\right) = R \\cdot \\Delta\\phi_{\\text{rad}}$$\n“宽度”是根据经度跨度 $\\Delta\\lambda$（以度为单位）计算的：\n$$W_{\\text{naive}} = \\Delta\\lambda \\cdot \\frac{\\pi R}{180} = R \\cdot \\left(\\Delta\\lambda \\frac{\\pi}{180}\\right) = R \\cdot \\Delta\\lambda_{\\text{rad}}$$\n朴素面积是这个宽度和高度的乘积：\n$$A_{\\text{naive}} = W_{\\text{naive}} \\cdot H_{\\text{naive}} = (R \\cdot \\Delta\\lambda_{\\text{rad}}) (R \\cdot \\Delta\\phi_{\\text{rad}}) = R^2 \\Delta\\lambda_{\\text{rad}} \\Delta\\phi_{\\text{rad}}$$\n这个计算实际上假设地球是一个从球体投影而来的圆柱体，其中一度经度的长度在任何地方都是恒定的，等于其在赤道处的长度。\n\n**3. 相对误差计算**\n\n相对误差定义为 $\\frac{A_{\\text{naive}} - A_{\\text{true}}}{A_{\\text{true}}} = \\frac{A_{\\text{naive}}}{A_{\\text{true}}} - 1$。\n代入上面推导出的表达式：\n$$\\frac{A_{\\text{naive}}}{A_{\\text{true}}} = \\frac{R^2 \\Delta\\lambda_{\\text{rad}} \\Delta\\phi_{\\text{rad}}}{R^2 \\Delta\\lambda_{\\text{rad}} [\\sin(\\phi_2) - \\sin(\\phi_1)]} = \\frac{\\Delta\\phi_{\\text{rad}}}{\\sin(\\phi_2) - \\sin(\\phi_1)}$$\n我们使用三角恒等式 $\\sin(A) - \\sin(B) = 2\\cos\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$。\n此处，$A = \\phi_2$ 且 $B = \\phi_1$。\n$$\\frac{A+B}{2} = \\frac{\\phi_2+\\phi_1}{2} = \\phi_0$$\n$$\\frac{A-B}{2} = \\frac{\\phi_2-\\phi_1}{2} = \\frac{\\Delta\\phi}{2}$$\n将此代入比率中，所有角度均以弧度为单位：\n$$\\frac{A_{\\text{naive}}}{A_{\\text{true}}} = \\frac{\\Delta\\phi_{\\text{rad}}}{2\\cos(\\phi_{0,\\text{rad}}) \\sin(\\frac{\\Delta\\phi_{\\text{rad}}}{2})}$$\n相对误差 $E_r$ 为：\n$$E_r = \\frac{\\Delta\\phi_{\\text{rad}}}{2\\cos(\\phi_{0,\\text{rad}}) \\sin(\\frac{\\Delta\\phi_{\\text{rad}}}{2})} - 1$$\n现在我们代入给定值：\n$\\phi_0 = 45^{\\circ}$，所以 $\\phi_{0,\\text{rad}} = \\frac{\\pi}{4}$。因此，$\\cos(\\phi_{0,\\text{rad}}) = \\cos(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$。\n$\\Delta\\phi = 0.10^{\\circ}$，所以 $\\Delta\\phi_{\\text{rad}} = 0.10 \\cdot \\frac{\\pi}{180} = \\frac{\\pi}{1800}$。\n那么 $\\frac{\\Delta\\phi_{\\text{rad}}}{2} = \\frac{\\pi}{3600}$。\n\n将这些值代入误差表达式：\n$$E_r = \\frac{\\frac{\\pi}{1800}}{2\\left(\\frac{\\sqrt{2}}{2}\\right)\\sin\\left(\\frac{\\pi}{3600}\\right)} - 1 = \\frac{\\frac{\\pi}{1800}}{\\sqrt{2}\\sin\\left(\\frac{\\pi}{3600}\\right)} - 1$$\n对于小角度 $x$，$\\sin(x) \\approx x$。如果我们做此近似，分母将是 $\\sqrt{2} \\cdot \\frac{\\pi}{3600}$，分数将简化为 $\\frac{\\pi/1800}{\\pi/(1800\\sqrt{2})} = \\sqrt{2}$。误差将是 $\\sqrt{2}-1 \\approx 0.4142$。这提供了一个很好的估计和概念性检验：朴素的宽度被高估了 $1/\\cos(\\phi_0) = 1/\\cos(45^\\circ) = \\sqrt{2}$ 倍。\n为了更精确的计算，我们直接计算其值：\n$$E_r = \\frac{\\frac{\\pi}{1800}}{\\sqrt{2}\\sin\\left(\\frac{\\pi}{3600}\\right)} - 1$$\n$$E_r \\approx \\frac{0.00174532925}{\\sqrt{2} \\cdot \\sin(0.0008726646...)} - 1$$\n$$E_r \\approx \\frac{0.00174532925}{\\sqrt{2} \\cdot 0.00087266451} - 1$$\n$$E_r \\approx \\frac{0.00174532925}{0.00123409641} - 1$$\n$$E_r \\approx 1.41421367 - 1 = 0.41421367$$\n四舍五入到四位有效数字，相对误差为 $0.4142$。这表示真实面积被高估了约 $41.42\\%$。",
            "answer": "$$\\boxed{0.4142}$$"
        },
        {
            "introduction": "建立了可靠的空间框架后，下一步便是利用数字高程模型（DEM）来划定流域，其核心在于追踪水流的路径。本练习将带您深入GIS软件的“黑箱”之中，手动执行作为大多数自动流域划定基础的D8算法 。通过为一个小网格计算流向和流量累积，您将对数字地形分析建立起直观且扎实的理解，并能体会到地形数据微小变化对分析结果的敏感性。",
            "id": "3866230",
            "problem": "由激光探测与测距 (LiDAR) 技术衍生的数字高程模型 (DEM) 在一个均匀的正方形网格上提供了以单元为中心的高程，该网格用于水文地形分析。考虑一个方形区域上的合成DEM，该区域包含一个 $3 \\times 3$ 的单元格集合，网格间距为 $\\Delta x = 30$ 米。水流方向将使用 D8 算法进行分配，该算法基于以下基本定义：朝向八个相邻单元中每一个的局部地形梯度大小近似为高程差除以中心间距，其中，到四个基本方位相邻单元的距离为 $\\Delta x$，到四个对角方位相邻单元的距离为 $\\Delta x \\sqrt{2}$。对于每个单元，水流被分配给具有最大正梯度值（最陡下降方向）的唯一相邻单元。汇流量定义为在有限域内流入给定单元的单元数量，包括该单元自身（贡献值为 $1$），并且没有来自 $3 \\times 3$ 区域外部的流入。\n\n用 $(i,j)$ 对网格进行索引，其中 $i \\in \\{1,2,3\\}$ 表示从北到南的行， $j \\in \\{1,2,3\\}$ 表示从西到东的列。高程 $z(i,j)$ 以米为单位，具体如下：\n- $(1,1)$: $z=99$,\n- $(1,2)$: $z=98$,\n- $(1,3)$: $z=94$,\n- $(2,1)$: $z=97$,\n- $(2,2)$: $z=100$,\n- $(2,3)$: $z=95$,\n- $(3,1)$: $z=96$,\n- $(3,2)$: $z=96$,\n- $(3,3)$: $z=93$.\n\n首先，仅使用上述基本定义确定所有九个单元的 D8 水流方向。然后，确定单元 $(2,3)$ 的基准汇流量。\n\n接下来，评估 D8 分配和汇流量对中心单元东侧相邻单元高程微小扰动的敏感性。具体来说，将单元 $(2,3)$ 的高程增加一个非负扰动量 $\\delta$，使其扰动后的高程变为 $z(2,3) + \\delta$。确定最小的严格为正的扰动量 $\\delta_{\\min}$，使得中心单元 $(2,2)$ 的 D8 出流方向偏离其基准方向，从而使单元 $(2,3)$ 的汇流量恰好比其基准值减少 $1$。\n\n仅报告 $\\delta_{\\min}$。最终答案以米为单位，并四舍五入到四位有效数字。",
            "solution": "该问题是有效的。它在科学上基于流域水文学的既定原则（D8 水流路径算法，汇流量），问题是适定的，可以从提供的数据中辨别出唯一解，并且它是客观的，使用了精确的定义和定量数据。所有必要的信息都已提供，且没有内部矛盾。\n\nD8 水流方向算法将水流从中心单元分配到其八个相邻单元之一。其决定性标准是最大正地形梯度，定义为高程差除以中心间距。设 $z_c$ 为中心单元的高程， $z_n$ 为相邻单元的高程。梯度 $S$ 由以下公式给出：\n$$S = \\frac{z_c - z_n}{L}$$\n其中距离 $L$ 对于基本方位（北、南、东、西）的相邻单元是网格间距 $\\Delta x$，对于对角方位（东北、西北、东南、西南）的相邻单元是 $\\Delta x \\sqrt{2}$。在本问题中，$\\Delta x = 30$ 米。\n\n首先，我们确定中心单元 $(2,2)$ 的基准水流方向，其高程为 $z(2,2) = 100$ 米。我们计算其到所有八个相邻单元的梯度。高程数据为：$z(1,1)=99$, $z(1,2)=98$, $z(1,3)=94$, $z(2,1)=97$, $z(2,3)=95$, $z(3,1)=96$, $z(3,2)=96$, $z(3,3)=93$。\n\n从单元 $(2,2)$ 到其相邻单元 $(i,j)$ 的梯度 $S_{2,2 \\to i,j}$ 如下：\n- 到 $(1,1)$： $S_{2,2 \\to 1,1} = \\frac{100 - 99}{\\Delta x \\sqrt{2}} = \\frac{1}{\\Delta x \\sqrt{2}}$\n- 到 $(1,2)$： $S_{2,2 \\to 1,2} = \\frac{100 - 98}{\\Delta x} = \\frac{2}{\\Delta x}$\n- 到 $(1,3)$： $S_{2,2 \\to 1,3} = \\frac{100 - 94}{\\Delta x \\sqrt{2}} = \\frac{6}{\\Delta x \\sqrt{2}}$\n- 到 $(2,1)$： $S_{2,2 \\to 2,1} = \\frac{100 - 97}{\\Delta x} = \\frac{3}{\\Delta x}$\n- 到 $(2,3)$： $S_{2,2 \\to 2,3} = \\frac{100 - 95}{\\Delta x} = \\frac{5}{\\Delta x}$\n- 到 $(3,1)$： $S_{2,2 \\to 3,1} = \\frac{100 - 96}{\\Delta x \\sqrt{2}} = \\frac{4}{\\Delta x \\sqrt{2}}$\n- 到 $(3,2)$： $S_{2,2 \\to 3,2} = \\frac{100 - 96}{\\Delta x} = \\frac{4}{\\Delta x}$\n- 到 $(3,3)$： $S_{2,2 \\to 3,3} = \\frac{100 - 93}{\\Delta x \\sqrt{2}} = \\frac{7}{\\Delta x \\sqrt{2}}$\n\n为了比较这些梯度，我们可以比较 $(\\text{高程差}) / (\\text{距离}/\\Delta x)$ 的值。需要比较的值是 $1/\\sqrt{2}$, $2$, $6/\\sqrt{2}$, $3$, $5$, $4/\\sqrt{2}$, $4$, 和 $7/\\sqrt{2}$。\n这些值的近似数值分别为 $0.707$, $2$, $4.243$, $3$, $5$, $2.828$, $4$, 和 $4.950$。\n最大值为 $5$，对应于流向单元 $(2,3)$ 的梯度。因此，从单元 $(2,2)$ 出发的基准水流方向是流向单元 $(2,3)$。\n\n单元 $(2,3)$ 的基准汇流量是流入该单元的单元数量，包括其自身。根据对整个网格的全面分析（为简洁起见此处省略，但已经过验证），只有单元 $(2,2)$ 流入单元 $(2,3)$。因此，贡献单元是 $(2,2)$ 和 $(2,3)$ 本身。单元 $(2,3)$ 的基准汇流量为 $1+1=2$。\n\n接下来，我们分析扰动。单元 $(2,3)$ 的高程增加一个非负量 $\\delta$，因此其新高程为 $z'(2,3) = 95 + \\delta$。这一变化只影响从 $(2,2)$ 到 $(2,3)$ 的梯度。新的梯度 $S'_{2,2 \\to 2,3}$ 为：\n$$S'_{2,2 \\to 2,3} = \\frac{100 - (95 + \\delta)}{\\Delta x} = \\frac{5 - \\delta}{\\Delta x}$$\n问题要求找到最小的严格为正的 $\\delta_{\\min}$，该扰动能改变 $(2,2)$ 的水流方向，从而使 $(2,3)$ 的汇流量恰好减少 $1$。这种情况发生在单元 $(2,2)$ 不再流向 $(2,3)$ 时。要使水流方向改变，梯度 $S'_{2,2 \\to 2,3}$ 必须不再是最大梯度。新的水流方向将朝向具有次高原始梯度的相邻单元。\n\n根据基准计算，次高的梯度是 $S_{2,2 \\to 3,3} = \\frac{7}{\\Delta x \\sqrt{2}}$（对应分值为 $4.950$，是其余分值中的最大值）。当流向 $(2,3)$ 的梯度变得小于流向 $(3,3)$ 的梯度时，从 $(2,2)$ 出发的水流方向将从 $(2,3)$ 切换到 $(3,3)$。这种变化的阈值发生在两个梯度相等时。最小扰动量 $\\delta_{\\min}$ 对应于这个等式条件：\n$$S'_{2,2 \\to 2,3} = S_{2,2 \\to 3,3}$$\n$$\\frac{5 - \\delta_{\\min}}{\\Delta x} = \\frac{7}{\\Delta x \\sqrt{2}}$$\n我们可以消去等式两边的 $\\Delta x$：\n$$5 - \\delta_{\\min} = \\frac{7}{\\sqrt{2}}$$\n求解 $\\delta_{\\min}$：\n$$\\delta_{\\min} = 5 - \\frac{7}{\\sqrt{2}}$$\n这个 $\\delta_{\\min}$ 的值是严格为正的，因为 $5 > 7/\\sqrt{2}$（由于 $5\\sqrt{2} \\approx 7.07 > 7$）。在这个阈值下，来自 $(2,2)$ 的水流被转向 $(3,3)$。这使得流入 $(2,3)$ 的单元数量减少一个，并且经检查确认没有其他单元被重新路由到 $(2,3)$。因此，单元 $(2,3)$ 的汇流量严格地从 $2$ 减少到 $1$，变化量恰好为 $1$，满足了问题的条件。\n\n最后，我们计算 $\\delta_{\\min}$ 的数值，并四舍五入到四位有效数字。\n$$\\delta_{\\min} = 5 - \\frac{7}{\\sqrt{2}} = 5 - \\frac{7\\sqrt{2}}{2} \\approx 5 - \\frac{7 \\times 1.41421356}{2} \\approx 5 - 4.94974746 = 0.05025254$$\n四舍五入到四位有效数字得到 $0.05025$。",
            "answer": "$$\\boxed{0.05025}$$"
        },
        {
            "introduction": "当流域被准确划定后，我们便可以对其核心水文功能——将降雨转化为径流——进行建模。本练习将指导您应用水文学的经典基石——单位线理论 。通过将一场风暴的有效降雨过程与流域的单位响应函数进行卷积，您将能亲手模拟出完整的径流过程线并计算出洪峰流量，这是洪水预报与水资源管理中一项至关重要的实践技能。",
            "id": "3866240",
            "problem": "一个流域已通过卫星衍生的数字高程模型（DEM）划分出来，其平面面积估算为 $A = 50\\,\\mathrm{km}^2$。从多光谱遥感推断出的土地覆盖比例被用于一个损失模型中，以生成一个时间步长均匀为 $\\Delta t = 15\\,\\mathrm{min}$ 的有效降雨过程线。在一次暴雨事件中，每个时间步长的有效降雨深度（单位为毫米/$\\Delta t$）以序列 $\\{r_k\\}$ 的形式给出（$k=1,\\dots,8$）：\n$\\{r_k\\} = [0,\\,2,\\,6,\\,12,\\,8,\\,3,\\,1,\\,0]$。\n假设该流域的响应是线性和时不变的，并由峰现时间 $T_p = 1\\,\\mathrm{h}$ 的 Soil Conservation Service (SCS) 无量纲单位过程线（DUH）表示。在与建模时间步长 $\\Delta t$ 相匹配的离散网格上，给出了无量纲时间 $\\tau = t/T_p$ 处的 DUH 纵坐标 $U(\\tau)$（因此每个连续的纵坐标对应一个增量 $\\Delta \\tau = \\Delta t/T_p = 0.25$）：\n$(\\tau,\\,U(\\tau)) \\in \\{(0.00,\\,0.00),\\,(0.25,\\,0.08),\\,(0.50,\\,0.20),\\,(0.75,\\,0.40),\\,(1.00,\\,1.00),\\,(1.25,\\,0.90),\\,(1.50,\\,0.75),\\,(1.75,\\,0.55),\\,(2.00,\\,0.35),\\,(2.25,\\,0.22),\\,(2.50,\\,0.12),\\,(2.75,\\,0.05),\\,(3.00,\\,0.00)\\}$。\n将 DUH 视为对应于单个时间步长内在流域上均匀分布的 $1\\,\\mathrm{mm}$ 有效降雨的单位过程线的形状。使用单位过程线理论和卷积的基本原理，计算分辨率为 $\\Delta t$ 的直接径流过程线的纵坐标（以流量为单位）。然后，确定过程线的洪峰并报告其量值。\n\n将您报告的洪峰流量四舍五入到四位有效数字。以 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$ 为单位表示最终流量。",
            "solution": "该问题要求计算给定流域和暴雨事件下直接径流过程线的洪峰流量。该方法基于水文学中的线性时不变系统原理，特别是单位过程线理论。直接径流过程线（DRH）是通过将有效降雨过程线（ERH）与流域的单位过程线（UH）进行卷积得到的。问题提供了 ERH 和 UH 的无量纲表示，必须首先从中推导出实际的 UH。\n\n求解过程包括三个主要步骤：\n1.  从给定的 Soil Conservation Service (SCS) 无量纲单位过程线（DUH）纵坐标推导出 $\\Delta t$ 时段单位过程线的纵坐标。\n2.  通过将有效降雨过程线与推导出的单位过程线进行离散卷积，计算直接径流过程线。\n3.  确定直接径流过程线的最大纵坐标，即洪峰流量。\n\n**步骤 1：单位过程线（UH）的推导**\n\n问题提供了流域的平面面积 $A = 50\\,\\mathrm{km}^2$，均匀时间步长 $\\Delta t = 15\\,\\mathrm{min}$，以及一组对应于峰现时间 $T_p = 1\\,\\mathrm{h}$ 的无量纲单位过程线（DUH）纵坐标 $\\{U_j\\}$。单位过程线是为在单个时间步长 $\\Delta t$ 内发生的 $1\\,\\mathrm{mm}$ 有效降雨定义的。\n\n首先，我们必须建立一个比例因子 $C$，将无量纲纵坐标 $\\{U_j\\}$ 转换为具有流量物理单位（$\\mathrm{m}^3\\,\\mathrm{s}^{-1}$）的单位过程线纵坐标 $\\{u_j\\}$。关系式为 $u_j = C \\cdot U_j$。该因子由质量守恒原理确定：单位过程线所代表的径流总体积必须等于产生它的有效降雨的总体积。\n\n有效降雨量 $V_{rain}$ 是降雨深度 $d=1\\,\\mathrm{mm}$ 和流域面积 $A$ 的乘积。\n首先，将所有单位转换为一致的系统（国际单位制：米、秒）。\n面积：$A = 50\\,\\mathrm{km}^2 = 50 \\times (10^3\\,\\mathrm{m})^2 = 5 \\times 10^7\\,\\mathrm{m}^2$。\n降雨深度：$d = 1\\,\\mathrm{mm} = 1 \\times 10^{-3}\\,\\mathrm{m}$。\n时间步长：$\\Delta t = 15\\,\\mathrm{min} = 15 \\times 60\\,\\mathrm{s} = 900\\,\\mathrm{s}$。\n\n降雨量为：\n$$V_{rain} = d \\cdot A = (1 \\times 10^{-3}\\,\\mathrm{m}) \\times (5 \\times 10^7\\,\\mathrm{m}^2) = 5 \\times 10^4\\,\\mathrm{m}^3$$\n\n单位过程线下的径流量 $V_{runoff}$ 是流量对时间的积分。对于离散时间过程线，这可近似为每个纵坐标与时间步长的乘积之和：\n$$V_{runoff} = \\sum_{j} u_j \\Delta t$$\n代入 $u_j = C \\cdot U_j$：\n$$V_{runoff} = \\sum_{j} (C \\cdot U_j) \\Delta t = C \\cdot \\Delta t \\sum_{j} U_j$$\n根据水量守恒，$V_{runoff} = V_{rain}$：\n$$C \\cdot \\Delta t \\sum_{j} U_j = V_{rain}$$\n因此，比例因子 $C$ 可以计算为：\n$$C = \\frac{V_{rain}}{\\Delta t \\sum_{j} U_j}$$\nDUH 纵坐标给出如下：\n$\\{U_j\\} = [0.00,\\,0.08,\\,0.20,\\,0.40,\\,1.00,\\,0.90,\\,0.75,\\,0.55,\\,0.35,\\,0.22,\\,0.12,\\,0.05,\\,0.00]$。\n这些纵坐标的总和是：\n$$\\sum_{j} U_j = 0.00+0.08+0.20+0.40+1.00+0.90+0.75+0.55+0.35+0.22+0.12+0.05+0.00 = 4.62$$\n现在，我们可以计算比例因子 $C$：\n$$C = \\frac{5 \\times 10^4\\,\\mathrm{m}^3}{(900\\,\\mathrm{s}) \\times 4.62} = \\frac{50000}{4158}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1} \\approx 12.025\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$$\n由于 DUH 的最大值为 $U_{peak} = 1.00$，比例因子 $C$ 也是单位过程线的洪峰流量 $u_{peak}$。$\\Delta t$ 时段单位过程线的纵坐标 $\\{u_j\\}$ 是通过将 DUH 纵坐标 $\\{U_j\\}$ 乘以该因子 $C$ 得到的。\n\n**步骤 2：通过卷积计算直接径流过程线（DRH）**\n\nDRH 是有效降雨过程线（ERH）$\\{r_k\\}$ 和单位过程线 $\\{u_j\\}$ 卷积的结果。ERH 以每个 $\\Delta t$ 内以 $\\mathrm{mm}$ 为单位的深度序列形式给出：\n$\\{r_k\\}_{k=1}^8 = [0,\\,2,\\,6,\\,12,\\,8,\\,3,\\,1,\\,0]$。\nDRH 的纵坐标 $\\{Q_n\\}$ 是使用离散卷积和计算的，在水文学中通常表示为叠加法。对于每个时间步长 $n$，流量 $Q_n$ 是对所有先前降雨脉冲响应的总和：\n$$Q_n = \\sum_{k=1}^{n} r_k u_{n-k+1}$$\n其中我们定义，对于 $k>8$， $r_k=0$；对于 UH 定义范围之外的 $j$（此处为 $j1$ 或 $j>13$），$u_j=0$。由于 $u_j = C \\cdot U_j$，我们可以写成：\n$$Q_n = C \\sum_{k=1}^{n} r_k U_{n-k+1} = C \\cdot Q'_n$$\n其中 $Q'_n$ 代表“无量纲”流量，我们首先计算它。我们将降雨序列 $\\{r_k\\}$ 和 DUH 序列 $\\{U_j\\}$ 的索引分别从 $k=1$ 和 $j=1$ 开始。由于第一个降雨脉冲 $r_1=0$，我们可以从 $k=2$ 开始求和以简化书写。\n\n无量纲流量纵坐标 $Q'_n$ 的计算过程如下：\n$Q'_1 = r_1 U_1 = 0 \\cdot 0.00 = 0$\n$Q'_2 = r_1 U_2 + r_2 U_1 = 0 \\cdot 0.08 + 2 \\cdot 0.00 = 0$\n$Q'_3 = r_1 U_3 + r_2 U_2 + r_3 U_1 = 0 + 2(0.08) + 0 = 0.16$\n$Q'_4 = r_2 U_3 + r_3 U_2 + r_4 U_1 = 2(0.20) + 6(0.08) + 12(0.00) = 0.40+0.48 = 0.88$\n$Q'_5 = r_2 U_4 + r_3 U_3 + r_4 U_2 + r_5 U_1 = 2(0.40) + 6(0.20) + 12(0.08) + 8(0.00) = 0.8+1.2+0.96 = 2.96$\n$Q'_6 = r_2 U_5 + r_3 U_4 + r_4 U_3 + r_5 U_2 + r_6 U_1 = 2(1.00) + 6(0.40) + 12(0.20) + 8(0.08) + 3(0.00) = 2.0+2.4+2.4+0.64 = 7.44$\n$Q'_7 = r_2 U_6 + r_3 U_5 + r_4 U_4 + r_5 U_3 + r_6 U_2 + r_7 U_1 = 2(0.90) + 6(1.00) + 12(0.40) + 8(0.20) + 3(0.08) + 1(0.00) = 1.8+6.0+4.8+1.6+0.24 = 14.44$\n$Q'_8 = r_2 U_7 + r_3 U_6 + r_4 U_5 + r_5 U_4 + r_6 U_3 + r_7 U_2 + r_8 U_1 = 2(0.75) + 6(0.90) + 12(1.00) + 8(0.40) + 3(0.20) + 1(0.08) + 0(0.00) = 1.5+5.4+12.0+3.2+0.6+0.08 = 22.78$\n$Q'_9 = r_2 U_8 + r_3 U_7 + r_4 U_6 + r_5 U_5 + r_6 U_4 + r_7 U_3 + r_8 U_2 = 2(0.55) + 6(0.75) + 12(0.90) + 8(1.00) + 3(0.40) + 1(0.20) + 0(0.08) = 1.1+4.5+10.8+8.0+1.2+0.2 = 25.8$\n$Q'_{10} = r_2 U_9 + r_3 U_8 + r_4 U_7 + r_5 U_6 + r_6 U_5 + r_7 U_4 + r_8 U_3 = 2(0.35) + 6(0.55) + 12(0.75) + 8(0.90) + 3(1.00) + 1(0.40) + 0(0.20) = 0.7+3.3+9.0+7.2+3.0+0.4 = 23.6$\n\n计算在后续时间步继续进行，但我们可以看到在 $n=9$ 之后数值开始减小。\n\n**步骤 3：确定洪峰流量**\n\n通过检查计算出的无量纲纵坐标序列 $\\{Q'_n\\}$，发现在时间步 $n=9$ 处出现最大值：\n$$Q'_{peak} = Q'_9 = 25.8$$\nDRH 对应的洪峰流量 $Q_{peak}$ 是这个无量纲峰值乘以比例因子 $C$。\n$$Q_{peak} = C \\cdot Q'_{peak} = \\left(\\frac{50000}{4158}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}\\right) \\times 25.8$$\n$$Q_{peak} = \\frac{1290000}{4158}\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1} \\approx 310.24531\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$$\n问题要求将洪峰流量的量值四舍五入到四位有效数字。\n$$Q_{peak} \\approx 310.2\\,\\mathrm{m}^3\\,\\mathrm{s}^{-1}$$\n该洪峰出现在暴雨事件开始后的 $t = 9 \\times \\Delta t = 9 \\times 15\\,\\mathrm{min} = 135\\,\\mathrm{min}$，即 $2.25\\,\\mathrm{h}$ 时。",
            "answer": "$$ \\boxed{310.2} $$"
        }
    ]
}