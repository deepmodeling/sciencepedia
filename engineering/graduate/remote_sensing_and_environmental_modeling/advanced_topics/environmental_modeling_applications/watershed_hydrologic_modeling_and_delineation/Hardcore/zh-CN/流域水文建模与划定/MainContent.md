## 引言
流域作为水文循环与[地表过程](@entry_id:192310)的基本单元，对其进行精确划分与动态模拟是水文学、环境科学及相关工程领域的核心任务。从预测洪水灾害、管理水资源，到评估土地利用变化的环境影响，流域水文模型提供了不可或缺的定量分析工具。然而，对于研究生和初入该领域的研究人员而言，将分散的理论知识（如水量平衡、单位线）与复杂的地理空间技术（如DEM处理）以及前沿的建模理念（如[非平稳性](@entry_id:180513)）融会贯通，往往构成了一大挑战。

为应对这一挑战，本文构建了一个从理论到实践的系统化学习路径。第一章“原理与机制”将奠定坚实的理论基础，深入剖析流域的物理定义、数字化表达方法以及降雨-径流转换的核心机制。第二章“应用与跨学科联系”将视野拓宽至真实世界的复杂问题，通过一系列案例展示流域分析如何作为一种通用框架，在[水利工程](@entry_id:184767)、城市规划、土壤科学乃至生态学等多个领域中发挥关键作用。最后，第三章“动手实践”将理论付诸行动，通过精心设计的问题引导读者亲身体验数据处理与模型构建的过程。

通过这一结构化的学习旅程，读者将能够系统地掌握流域[水文建模](@entry_id:1126276)与划分的精髓，为未来的学术研究与专业实践打下坚实的基础。

## 原理与机制

本章旨在系统阐述流域水文学的核心原理与关键机制。我们将从流域作为基本水文单元的定义出发，探讨其水量平衡的控制方程。随后，我们将深入数字化流[域划分](@entry_id:748628)的技术细节，包括高程数据源的特性、水文预处理方法以及决定水流路径的核心算法。在此基础上，本章将构建降雨-径流模拟的理论框架，区分不同类型的模型结构，并剖析构成径流过程的关键组分，如基流和直接径流。最后，我们将探讨水文模型在现实应用中面临的两个前沿挑战：不确定性与非平稳性，并介绍相应的分析与建模策略。

### 作为水文控制体的流域

在水文学中，建立一个明确定义的控制体是进行任何定量分析的前提。流域（watershed），或称汇水盆地（catchment/drainage basin），正是这一基本控制体。

#### 流域的定义与水文边界

一个**流域**被严格定义为地表上的一片区域，所有降落在这片区域内的地表水（在重力作用下）最终都会汇集到同一个出口点（outlet）。流域的边界被称为**分水岭**（watershed divide），它是一条沿地形最高点连接而成的线，将该流域与相邻流域分隔开。因此，流域的界限完全由地形地貌决定，反映了水流的自然路径。

这与基于行政或管理目的划分的**水文区域**（hydrologic region）有本质区别。行政边界（如县界或[水资源管理](@entry_id:1133968)区界线）是基于政治或法律标准设定的，通常与地形分水岭不符。因此，地表水流可以自由穿越这些行政边界，这意味着行政区域对于[地表径流](@entry_id:1132694)而言并非一个封闭的物理系统。在进行精确的水文物理模拟时，选择由地形定义的流域作为控制体至关重要 。

#### 水量平衡方程

将流域视为一个控制体，我们可以应用质量守恒定律来描述其水量变化。在一个给定的时间段内，进入控制体的水量减去流出控制体的水量，必须等于控制体内水储量的变化。对于一个自然流域，在忽略人为取水和跨流域调水的情况下，其年度水量平衡可以表示为以下方程 ：

$$P - ET - Q - \Delta S = 0$$

这个方程中的每一项都代表了一年内整个流域的水量，各分量的含义如下：

*   **降水（Precipitation, $P$）**：这是进入流域的主要水分输入，包括降雨、降雪等所有形式的降水总量。

*   **[蒸散](@entry_id:180694)发（Evapotranspiration, $ET$）**：这是水分返回大气的主要途径，包括从土壤和水体表面的蒸发（evaporation）以及通过植物的蒸腾（transpiration）作用散失的水分总量。

*   **径流（Discharge, $Q$）**：这是通过流域出口断面的总流水量。它是一年内总的河流流量，包含了所有来源的贡献，即快速的[地表径流](@entry_id:1132694)（surface runoff）和缓慢释放的**基流**（baseflow），后者主要由地下水补给。

*   **储量变化（Change in Storage, $\Delta S$）**：这代表了从年初到年末，流域内部储存的总水量所发生的净变化。水可以多种形式储存在流域内，包括土壤水、地下水、积雪、湖泊和水库蓄水等。在单一年尺度上，$\Delta S$ 不一定为零，因为它反映了该年度是偏湿还是偏干。只有在长期的多年平均下，我们才通常假设 $\Delta S \approx 0$。

### 流域的数字化表达与划分

随着[地理信息系统](@entry_id:905468)（GIS）和遥感技术的发展，流域及其水系的自动划分已成为水文分析的标准流程。这一过程的核心是利用[数字高程模型](@entry_id:1123727)（Digital Elevation Model, DEM）来模拟地表水的流动。

#### 数字高程模型（DEM）数据源

DEM 是地表地形的三维栅格化表达，是进行水文分析的基础数据。不同的遥感技术可以生成具有不同特征的 DEM：

*   **激光雷达（LiDAR）**：通过[机载激光扫描](@entry_id:1120899)获取数据，可以生成空间分辨率极高（如 $1$–$3\,\mathrm{m}$）、垂直精度极高（[均方根误差](@entry_id:170440)通常小于 $0.15\,\mathrm{m}$）的“裸土”DEM。它能穿透植被，直接测量地表高程，是局部和区域尺度精细水文研究的“黄金标准”。

*   **航天飞机雷达地形测绘任务（SRTM）**：利用雷达干涉测量技术生成，是应用最广的全球性 DEM 之一，通常分辨率为 $30\,\mathrm{m}$。其垂直精度适中，但存在[雷达信号](@entry_id:190382)无法穿透茂密植被冠层而导致的**植被高程偏倚**，以及在水体和陡峭地形区域的数据**空洞**。

*   **先进星载热发射和反射辐射计（ASTER）**：利用光学立体像对生成，分辨率也为 $30\,\mathrm{m}$。其精度通常低于 SRTM，且易受云层遮蔽影响，导致大面积数据缺失或错误。此外，ASTER DEM 中也常见**条带噪声**等伪影 。

#### DEM 的水文预处理

无论是哪种来源的 DEM，原始数据都不能直接用于水文分析，因为数据噪声或真实的地表特征（如桥梁、路基）会在模型中形成不透水的“大坝”或虚假的洼地，从而中断模拟的水流路径。因此，在进行流向计算之前，必须对 DEM 进行**水文预处理**（hydrologic conditioning）。

主要方法包括：

*   **填洼（Pit Filling）**：识别出所有邻近栅格高程都比其高的“洼地”（sink 或 pit），并将其高程值提高到其外围最低的“溢出点”（pour point）的高度，形成一个平坦区域，使水流可以“漫过”障碍。

*   **挖穿（Breach Carving）**：识别洼地后，通过降低洼地边界上一系列栅格单元的高程，刻画出一条窄而深的通道，将洼地与下游更低的区域连接起来。这种方法在处理由道路或桥梁造成的长条形障碍时尤为有效，因为它能维持河谷的自然坡度，避免了填洼法可能造成的过大平坦河底 。

#### 水流路径算法

水文[预处理](@entry_id:141204)后的 DEM 为计算每个栅格的水流方向提供了基础。其物理原理是水在重力作用下沿最陡峭的路径向下流动。

*   **单流向算法（Single Flow Direction, SFD）**：最经典的 SFD 算法是 **D8 算法**。对于一个中心栅格 $c$（高程为 $z_c$），该算法计算其流向 $8$ 个邻居栅格 $i$（高程为 $z_i$）的坡度，并选择坡度最大的方向作为唯一的出流方向。坡度的计算考虑了距离因素：
    $$S_i = \frac{z_c - z_i}{d_i}$$
    其中，对于四个基本方向（上、下、左、右）的邻居，$d_i = r$（栅格边长）；对于四个对角线方向的邻居，$d_i = \sqrt{2}r$。D8 算法的本质是寻找使 $S_i$ 最大化的邻居。然而，由于它将水流强制分配到 $8$ 个离散方向之一，当真实坡降方向介于两者之间时，会产生系统性的方向偏差，导致模拟的水系呈现不自然的平行格局 。

*   **多流向算法（Multiple Flow Direction, MFD）**：为了更真实地模拟水流在某些地形上的分散特性，多流向算法应运而生。在**凸形山坡**（如山脊的鼻状突出部分）上，地表径流是发散的。D8 算法无法表达这种从一个栅格流向多个栅格的现象。
    *   **D-Infinity (D∞) 算法**：该算法首先计算一个不受八方向限制的、连续的坡降角，然后将水流[按比例分配](@entry_id:634725)给该流向向量所夹的两个下游邻居。这能很好地模拟在平缓山坡上的片状流，尤其是在坡向与栅格主轴斜交时。
    *   **经典 MFD 算法**：这类算法允许水流分配给所有坡度向下的邻居，分配的比例通常是其坡度的函数。这能有效模拟在山顶点或尖锐凸脊处的强烈发散流 。

#### 可复现的 GIS 流[域划分](@entry_id:748628)工作流

一个科学、严谨且可复现的流[域划分](@entry_id:748628)工作流应包含以下步骤 ：

1.  **坐标系重投影**：原始 DEM 可能使用地理坐标系（如 [WGS84](@entry_id:1134054)），其单位是度。为确保面积和距离计算的准确性，必须首先将其重投影到平面坐标系（如 UTM）。

2.  **DEM 预处理**：进行水文[预处理](@entry_id:141204)。一个精细的工作流应能区分真实洼地（如湖泊）和虚假洼地。例如，可以先“烧入”（burn-in）已知的矢量河网（通过降低河网所在栅格的高程来强化河道），同时保护湖泊区域不被填充，然后对剩余区域进行填洼处理。

3.  **计算流向与[汇流量](@entry_id:1125097)**：基于[预处理](@entry_id:141204)后的 DEM，使用选定的算法（如 D8）计算**流向栅格**（flow direction grid）。然后，基于流向栅格计算**[汇流量](@entry_id:1125097)栅格**（flow accumulation grid），该栅格中每个像元的值等于汇入该像元的上游像元总数。

4.  **提取河网**：通过对[汇流量](@entry_id:1125097)栅格设定一个阈值 $T$ 来定义河网。所有[汇流量](@entry_id:1125097)值大于等于 $T$ 的栅格被识别为河道。这个阈值 $T$ 应根据一个有物理意义的最小汇水面积 $A^*$ 来确定。如果栅格分辨率为 $r \times r$，则 $T = A^* / r^2$。例如，若要在 $10\,\mathrm{m}$ 分辨率的 DEM 上提取源头汇水面积至少为 $2.5\,\mathrm{km}^2$ 的河道，阈值应为 $T = (2.5 \times 10^6\,\mathrm{m}^2) / (100\,\mathrm{m}^2) = 25000$。

5.  **流域边界生成**：将给定的流域出口点“捕捉”（snap）到提取出的河网上的最近高[汇流量](@entry_id:1125097)栅格，以确保其位于真实的河道上。然后，利用流向栅格，追溯所有最终汇入该捕捉点的上游栅格，这些栅格的集合就构成了该出口点对应的流域。

6.  **[元数据](@entry_id:275500)记录**：为了保证研究的可复现性，必须详细记录整个工作流的所有信息，包括数据来源、软件版本、坐标系统、所有处理步骤及所用参数（如河网烧入深度、[汇流量](@entry_id:1125097)阈值 $T$ 等）。

### 降雨-径流模拟原理

在流域被界定后，下一步便是建立数学模型来模拟其内部的水文过程，核心是理解降雨如何转化为径流。

#### 水文模型的分类

根据对空间异质性的处理方式，水文模型可分为三类 ：

*   **集总式模型（Lumped Models）**：将整个流域视为一个均质单元，不考虑内部的空间差异。模型参数是代表整个流域的有效值，输入数据（如降雨）也是全流域的平均值。这类模型结构简单，数据需求量小，但无法描述流域内部的水文过[程差](@entry_id:201533)异。

*   **[半分布式模型](@entry_id:1131426)（Semi-distributed Models）**：这是集总式与分布式之间的一种折衷。模型将流[域划分](@entry_id:748628)为若干个子单元，每个子单元内部被视为均质，但不同子单元间的参数可以不同。这些子单元可以是根据地形划分的**子流域**，也可以是基于土地利用、土壤类型和坡度组合而成的**水文响应单元（Hydrologic Response Units, HRUs）**。这类模型能够部分反映空间异质性，同时计算成本可控。

*   **全分布式模型（Fully Distributed Models）**：将流域剖分成高分辨率的规则网格（或不规则单元），并为每个网格单元赋予独立的参数。模型在每个单元上求解基于物理的水流控制方程（如[圣维南方程](@entry_id:1131187)或[理查兹方程](@entry_id:1131022)），并模拟水流在单元间的传输。这类模型能最精细地刻画空间异质性，但对输入数据（高分辨率的地形、土壤、植被图及空间分布的降雨场）的要求极高，且参数众多，率定和验证极具挑战。

#### 水文响应单元（HRU）

HRU 是[半分布式模型](@entry_id:1131426)中一个极为重要的概念。一个 HRU 代表了一种独特的土地利用、土壤类型和坡度等级的组合。其核心假设是：凡是具有相同物理属性组合的地块，其对降雨等气象输入的响应方式是相似的。

在基于 HRU 的模型中，工作流程如下 ：

1.  在每个子流域内，根据土地利用、土壤和坡度图的叠加，确定所有 HRU 类型及其各自所占的总面积。
2.  模型对每种 HRU 类型独立运行水分平衡计算，模拟产流、入渗、蒸散发等过程。
3.  然后，将每个 HRU 产生的径流量（或其他物质通量）按其面积加权求和，得到该子流域的总产流量。
4.  最后，这个子流域的总产流量作为整体，通过河网被输送到下一个子流域或总出水口。

通过这种方式，HRU 方法在不直接处理各个地块具体空间位置和连接关系的情况下，有效地考虑了流域下垫面的异质性，实现了计算效率和物理真实性之间的平衡。

#### 水文过程线及其组分

河流出口断面的流量随时间变化的曲线称为**水文过程线**（hydrograph）。它通常被分解为两个主要部分：由降雨事件直接产生的**直接径流**（direct runoff）和在干旱期维持河流不断流的**基流**（baseflow）。

*   **基流与退水分析**：基流是流域地下水储库缓慢释放并补给河道的水流。在一次暴雨过后进入无降雨的干旱期，河川径流主要由基流构成，其流量会逐渐衰减，这一过程称为**退水**（recession）。
    一个经典的描述退水过程的模型是**[线性水库模型](@entry_id:1127285)**。该模型假设地下水库的动态储水量 $S(t)$ 与其出流量（即基流 $Q_b(t)$）成正比：$S(t) = k Q_b(t)$。这里的 $k$ 是一个具有时间量纲的常数，称为水库的特征排空时间或蓄泄系数。结合水量平衡方程 $\frac{\mathrm{d}S}{\mathrm{d}t} = -Q_b(t)$（储量的减少速率等于流出速率），可以推导出基流随时间变化的[微分](@entry_id:158422)方程，并解得指数衰减函数 ：
    $$Q_b(t) = Q_0 \exp(-t/k)$$
    其中 $Q_0$ 是退水开始时的流量。这个关系表明，在半对数坐标系中（$\ln(Q)$ 对 $t$），基流退水曲线是一条直线，其斜率为 $-1/k$。通过对观测到的退水期流量数据进行[线性回归](@entry_id:142318)，我们就可以估算出特征时间 $k$。此外，基流减半所需的时间（半衰期）为 $t_{1/2} = k \ln(2)$。

*   **直接径流与[单位线理论](@entry_id:1133610)**：直接径流是流域对[有效降雨](@entry_id:1124195)（即扣除入渗和填洼等损失后的那部分降雨）的快速响应。**[单位线理论](@entry_id:1133610)**（Unit Hydrograph theory）是描述这一响应过程的经典集总式方法。它将流域视为一个**[线性时不变](@entry_id:276287)（LTI）系统**。
    该理论的核心假设是 ：
    1.  **线性（Linearity）**：包含**齐次性**（若有效雨强加倍，则直接径流过程线上每一点的流量值也加倍）和**叠加性**（对复杂降雨过程的响应等于对其各组成部分单独响应的加和）。
    2.  **[时不变性](@entry_id:198838)（Time-Invariance）**：流域的响应特性不随时间改变。即，对于相同的[有效降雨](@entry_id:1124195)，无论它发生在何时，所产生的直接径流过程线形状都是相同的（仅在时间轴上平移）。
    在这些假设下，流域的响应可以由其[脉冲响应函数](@entry_id:1126431)——**瞬时单位线**（Instantaneous Unit Hydrograph, IUH），记为 $u(t)$——来完全表征。直接径流过程线 $q(t)$ 便是[有效降雨](@entry_id:1124195)过程 $e(t)$ 与瞬时单位线 $u(t)$ 的卷积：
    $$q(t) = \int_{0}^{t} e(\tau) u(t-\tau) \,\mathrm{d}\tau$$
    在现实中，流域的响应过程（如坡面流速随水深增加）并非严格线性的，且其特性也可能因季节（植被覆盖）或长期变化而改变。因此，检验这些假设的有效性至关重要。例如，可以通过比较不同量级暴雨产生的标准化径流过程线（用总径流量归一化）的形状是否一致来检验线性假设；通过比较不同季节暴雨推求出的单位线是否一致来检验时不变性假设。

### 前沿主题：不确定性与非平稳性

[水文建模](@entry_id:1126276)不仅要处理已知物理过程，还必须面对数据和模型本身的局限性，以及外部环境的不断变化。

#### 不确定性与等效性

在水文模型率定中，我们常常发现一个令人困惑的现象：多个截然不同的参数组合（$\boldsymbol{\theta}$）能够产生与观测数据同样“吻合”的模拟结果，尤其是在考虑到观测数据本身存在不确定性时。这一现象被称为**等效性**（equifinality）。它意味着，仅凭有限的观测数据，我们无法唯一地确定一个“最优”的参数集。

传统的单点最优化的思路在此失效。现代[不确定性分析](@entry_id:149482)方法，如**广义似然[不确定性估计](@entry_id:191096)（GLUE）**，选择接受并量化这种不确定性 。GLUE 的步骤大致如下：
1.  从参数的先验分布中进行大量随机抽样，得到许多参数集。
2.  为每个参数集运行模型，并根据其模拟结果与观测数据的吻合程度，计算一个**[似然](@entry_id:167119)值**（likelihood measure）。[似然](@entry_id:167119)值的定义可以很灵活，例如，基于高斯误差假设的正式贝叶斯[似然函数](@entry_id:921601)，或者更简单的性能指标（如 [Nash-Sutcliffe 效率](@entry_id:1128429)）。
3.  设定一个似然阈值，所有似然值高于该阈值的参数集被认定为**“可行”**（behavioral）。这组参数集代表了与观测数据相容的所有模型。
4.  将这些可行模型的似然值归一化，得到每个模型的权重。
5.  最终的预测不再是单一的曲线，而是所有可行模型预测结果的加权集合，可以用来生成预测的置信区间或概率分布。这种方法明确地承认并传达了模型预测的不确定性。

#### 变化环境下的建模：非平稳性

经典水文模型通常假设流域是一个**平稳**（stationary）系统，即其统计特性（如年均径流量、径流的[自相关](@entry_id:138991)结构）不随时间改变。然而，在全球气候变化和剧烈人类活动的影响下，这一假设越来越难以成立。一个水文时间序列如果其统计特性随时间演变，则称其具有**非平稳性**（nonstationarity） 。

[非平稳性](@entry_id:180513)的驱动因素主要有两个：
1.  **气候变化**：导致模型输入（如降雨、温度）的[统计分布](@entry_id:182030)发生变化（例如，平均降雨量趋势性增加或减少）。
2.  **下垫面变化**：如土地利用/覆盖的改变（城市化、森林砍伐或恢复），直接改变了流域本身的物理属性（如入渗能力、蒸散发效率）。

在一个变化的环境中，如果仍坚持使用固定参数的水文模型，模型将无法捕捉到系统的真实演变，从而导致模拟误差出现系统性的、随时间变化的趋势，这违背了[模型误差](@entry_id:175815)应为随机白噪声的基本假设。

应对非平稳性的现代[水文建模](@entry_id:1126276)策略是，让模型本身也“动”起来。具体而言，就是构建**时变[参数模型](@entry_id:170911)**。这通常通过将模型中的关键参数 $\theta$ 表示为时间的函数 $\theta_t$ 来实现。更进一步，为了让这种时变具有物理基础，可以将参数 $\theta_t$ 与可观测的、反映环境变化的[协变](@entry_id:634097)量联系起来，例如，将与植被相关的[蒸散](@entry_id:180694)发参数与遥感反演的**归一化[植被指数](@entry_id:1133751)（NDVI）** 挂钩，或将融雪参数与**雪盖面积**数据联系起来。这种方法使得模型能够在保持其物理[可解释性](@entry_id:637759)的同时，动态地适应不断变化的外部环境，从而在非平稳条件下提供更可靠的模拟与预测 。