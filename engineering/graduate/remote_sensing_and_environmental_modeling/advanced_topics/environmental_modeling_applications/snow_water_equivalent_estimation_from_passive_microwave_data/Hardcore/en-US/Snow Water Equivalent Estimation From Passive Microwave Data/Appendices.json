{
    "hands_on_practices": [
        {
            "introduction": "Before we can interpret satellite measurements to retrieve a variable like Snow Water Equivalent (SWE), we must first understand how that variable influences the signal the satellite observes. This is the role of a forward model, which acts as a \"what-if\" engine, predicting the measured brightness temperature for a given set of surface conditions. This exercise guides you through building such a forward model from first principles, connecting the physical properties of a snowpack, like its density and depth, to its electromagnetic signature at microwave frequencies . Mastering this practice provides a foundational understanding of the physics governing passive microwave remote sensing of snow.",
            "id": "3847393",
            "problem": "You are tasked with designing and implementing a forward model for the observed microwave Brightness Temperature (BT) from a snow-covered surface using fundamental radiative transfer principles and physically grounded constitutive relations. The goal is to compute the upward-directed Brightness Temperature at the top of the atmosphere for a set of specified conditions, represented by a small test suite. The modeled scenario is a plane-parallel, horizontally homogeneous dry snowpack overlying soil, observed at a specified microwave frequency and viewing angle.\n\nUse the following foundational base and definitions to derive the model you will implement:\n\n- Radiative transfer in a plane-parallel, absorbing medium: The specific intensity along a path coordinate $s$ within a medium with absorption coefficient $\\kappa_a$ and source function given by the Rayleigh-Jeans approximation is governed by the differential equation\n$$\\frac{dI}{ds} = -\\kappa_a I + \\kappa_a B(T),$$\nwhere $B(T)$ is the Planck function approximated at microwave frequencies by the Rayleigh-Jeans expression.\n\n- Brightness Temperature (BT) definition: At microwave frequencies, the Rayleigh-Jeans approximation allows intensity to be expressed as $I = \\alpha(f) T$, where $\\alpha(f)$ is a known frequency-dependent constant. Under this approximation, the measured quantity is equivalently represented as a Brightness Temperature $T_B$, such that effective emission is proportional to $T_B$ and the radiative transfer equation can be written directly in terms of $T_B$ as\n$$\\frac{d T_B}{ds} = -\\kappa_a T_B + \\kappa_a T(s),$$\nfor a uniform medium of temperature $T(s) = T_{\\text{snow}}$.\n\n- Boundary at the snow–ground interface: The soil is characterized by a ground emissivity $e_g$ and a physical temperature $T_{\\text{ground}}$, so the upward boundary condition at the bottom of the snowpack is\n$$T_{B,\\text{ground}} = e_g \\, T_{\\text{ground}}.$$\n\n- Passive Microwave Radiometry (PMR) observation geometry: For an observation angle $\\theta$ (measured from the local zenith), the path length through a layer of physical thickness $h$ is $h / \\cos(\\theta)$.\n\n- Snow Water Equivalent (SWE) and thickness: Snow Water Equivalent (SWE) is defined as the thickness of liquid water that would result if the snow melted and spread uniformly. Let the snow density be $\\rho_s$ and the density of liquid water be $\\rho_w$. Using mass per unit area conservation, deduce the physical snow thickness $h$ from the given SWE and $\\rho_s$.\n\n- Electromagnetic attenuation and dielectric properties: For a nonmagnetic, weakly lossy dielectric with complex relative permittivity $\\varepsilon = \\varepsilon' + i \\varepsilon''$, the complex refractive index is $n = \\sqrt{\\varepsilon} \\approx \\sqrt{\\varepsilon'} + i \\left(\\frac{\\varepsilon''}{2\\sqrt{\\varepsilon'}}\\right)$ in the low-loss limit. The power attenuation coefficient (in $\\text{m}^{-1}$) is\n$$\\alpha(f) = \\frac{2\\pi f}{c} \\, \\operatorname{Im}(n) \\approx \\frac{2\\pi f}{c} \\frac{\\varepsilon''}{\\sqrt{\\varepsilon'}},$$\nwhere $f$ is the frequency in $\\text{Hz}$ and $c$ is the speed of light in vacuum.\n\n- Dry snow effective permittivity parameterization: Model the dry snow effective permittivity using the volume fraction of ice phase. Let $\\rho_i$ denote the density of pure ice. Define the ice volume fraction $\\phi = \\rho_s / \\rho_i$. Use the following parameterization for dry snow at microwave frequencies:\n$$\\varepsilon' = 1 + a \\, \\phi, \\quad \\varepsilon'' = b \\, \\phi \\, f_{\\text{GHz}},$$\nwhere $f_{\\text{GHz}}$ is the frequency expressed in $\\text{GHz}$, and the constants are $a = 1.7$, $b = 5 \\times 10^{-4}$.\n\nConstants to use:\n- Speed of light: $c = 2.99792458 \\times 10^8 \\, \\text{m}\\,\\text{s}^{-1}$.\n- Water density: $\\rho_w = 1000 \\, \\text{kg}\\,\\text{m}^{-3}$.\n- Ice density: $\\rho_i = 917 \\, \\text{kg}\\,\\text{m}^{-3}$.\n\nAssumptions to adopt:\n- The snow layer is isothermal at $T_{\\text{snow}}$ and absorption-dominated at the frequencies considered. Scattering is neglected.\n- The air–snow interface reflection is neglected; only absorption within the layer and the ground emissivity contribute to the model.\n- The Rayleigh-Jeans approximation is valid at the specified microwave frequencies.\n\nTask:\n- Starting from the above base, derive a forward model for the upward Brightness Temperature $T_{B,\\text{top}}$ at the top of the snow layer and implement it to compute $T_{B,\\text{top}}$ for each test case.\n- All angles are specified in degrees; convert to radians as needed and use $\\cos(\\theta)$ consistently.\n- Express the final Brightness Temperature values in $\\text{K}$, rounded to three decimals.\n\nTest suite:\nCompute $T_{B,\\text{top}}$ for the following five cases, each defined as a tuple $(f_{\\text{GHz}}, \\theta_{\\text{deg}}, \\text{SWE}_{\\text{m}}, \\rho_s, T_{\\text{snow}}, T_{\\text{ground}}, e_g)$ with units as noted:\n\n1. $(19.35, 0, 0.15, 300, 263, 273, 0.90)$\n2. $(19.35, 0, 0.00, 300, 268, 270, 0.95)$\n3. $(37.00, 0, 0.40, 400, 258, 265, 0.85)$\n4. $(19.35, 0, 0.25, 350, 260, 273, 0.60)$\n5. $(37.00, 50, 0.20, 300, 265, 272, 0.92)$\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each result must be the corresponding Brightness Temperature in $\\text{K}$ for the test case, rounded to three decimals.",
            "solution": "The problem requires the derivation and implementation of a forward model for the upward-directed microwave brightness temperature from a dry snowpack overlying soil. The problem statement is scientifically sound, well-posed, and self-contained, providing all necessary physical principles, constitutive relations, parameters, and constants. It is therefore deemed a valid problem.\n\nThe derivation proceeds as follows.\n\n**Step 1: Determine Physical Snow Thickness from Snow Water Equivalent (SWE)**\nThe Snow Water Equivalent, $\\text{SWE}$, represents the height of water if the snowpack were melted. The mass of snow per unit area is given by the product of snow density, $\\rho_s$, and snow thickness, $h$. This mass must be equal to the mass of the equivalent water column, which is the product of water density, $\\rho_w$, and $\\text{SWE}$.\n$$ \\text{mass per unit area} = \\rho_s h = \\rho_w \\text{SWE} $$\nFrom this conservation of mass, we can express the physical snow thickness, $h$, as:\n$$ h = \\text{SWE} \\frac{\\rho_w}{\\rho_s} $$\n\n**Step 2: Characterize Snowpack Dielectric and Absorption Properties**\nThe electromagnetic properties of the dry snow are determined by its effective complex permittivity, $\\varepsilon = \\varepsilon' + i \\varepsilon''$. The problem provides a parameterization based on the ice volume fraction, $\\phi$.\nThe ice volume fraction is the ratio of the snow density, $\\rho_s$, to the density of pure ice, $\\rho_i$:\n$$ \\phi = \\frac{\\rho_s}{\\rho_i} $$\nThe real ($\\varepsilon'$) and imaginary ($\\varepsilon''$) parts of the effective permittivity are given by:\n$$ \\varepsilon' = 1 + a \\phi $$\n$$ \\varepsilon'' = b \\phi f_{\\text{GHz}} $$\nwhere $f_{\\text{GHz}}$ is the microwave frequency in gigahertz, and $a=1.7$ and $b=5 \\times 10^{-4}$ are empirical constants.\n\nThe absorption of microwaves in the snow is governed by the power absorption coefficient, $\\kappa_a$. For a weakly lossy dielectric medium, this is related to the imaginary part of the complex refractive index, $n = \\sqrt{\\varepsilon}$. The absorption coefficient is given as:\n$$ \\kappa_a = \\frac{2\\pi f}{c} \\frac{\\varepsilon''}{\\sqrt{\\varepsilon'}} $$\nHere, $f$ is the frequency in Hertz ($f = f_{\\text{GHz}} \\times 10^9$), and $c$ is the speed of light in vacuum.\n\n**Step 3: Solve the Radiative Transfer Equation (RTE)**\nThe problem simplifies the radiative transfer process by neglecting scattering and assuming an isothermal snowpack at temperature $T_{\\text{snow}}$. The RTE for brightness temperature, $T_B$, along a path coordinate, $s$, is given as:\n$$ \\frac{dT_B}{ds} = -\\kappa_a T_B + \\kappa_a T_{\\text{snow}} $$\nThis is a first-order linear ordinary differential equation. We can solve it by defining a coordinate system where $s=0$ at the snow-ground interface and increases upwards along the observation path. The path is at an angle $\\theta$ from the zenith, so the total path length, $L$, through the snowpack of thickness $h$ is $L = h / \\cos(\\theta)$.\n\nThe general solution to the RTE is:\n$$ T_B(s) = T_{\\text{snow}} + C e^{-\\kappa_a s} $$\nwhere $C$ is a constant of integration determined by the boundary condition at the base of the snowpack ($s=0$).\n\nThe boundary condition at the snow-ground interface is the upward-emitted brightness temperature from the ground, $T_{B,\\text{ground}}$, given by:\n$$ T_B(0) = T_{B,\\text{ground}} = e_g T_{\\text{ground}} $$\nwhere $e_g$ is the ground emissivity and $T_{\\text{ground}}$ is the physical temperature of the ground.\n\nApplying this boundary condition to the general solution at $s=0$:\n$$ T_B(0) = T_{\\text{snow}} + C e^{-\\kappa_a (0)} = T_{\\text{snow}} + C $$\n$$ \\implies C = T_B(0) - T_{\\text{snow}} = e_g T_{\\text{ground}} - T_{\\text{snow}} $$\nSubstituting $C$ back into the general solution gives the profile of brightness temperature within the snowpack:\n$$ T_B(s) = T_{\\text{snow}} + (e_g T_{\\text{ground}} - T_{\\text{snow}}) e^{-\\kappa_a s} $$\n\n**Step 4: Calculate the Upward Brightness Temperature at the Snow-Air Interface**\nThe desired quantity is the upward brightness temperature at the top of the snow layer, $T_{B,\\text{top}}$, which corresponds to $T_B(s=L)$. We substitute $s=L$ into the equation:\n$$ T_{B,\\text{top}} = T_B(L) = T_{\\text{snow}} + (e_g T_{\\text{ground}} - T_{\\text{snow}}) e^{-\\kappa_a L} $$\nSubstituting $L = h / \\cos(\\theta)$, we get:\n$$ T_{B,\\text{top}} = T_{\\text{snow}} + (e_g T_{\\text{ground}} - T_{\\text{snow}}) e^{-\\kappa_a h / \\cos(\\theta)} $$\nLet the transmissivity of the snowpack be $\\tau(\\theta) = e^{-\\kappa_a h / \\cos(\\theta)}$. The equation can be rearranged into a more physically intuitive form:\n$$ T_{B,\\text{top}} = T_{\\text{snow}} (1 - e^{-\\kappa_a h / \\cos(\\theta)}) + (e_g T_{\\text{ground}}) e^{-\\kappa_a h / \\cos(\\theta)} $$\n$$ T_{B,\\text{top}} = T_{\\text{snow}}(1-\\tau(\\theta)) + T_{B,\\text{ground}} \\tau(\\theta) $$\nThis expression shows that the observed brightness temperature is a sum of two components: the emission from the snowpack itself, $T_{\\text{snow}}(1-\\tau(\\theta))$, and the emission from the underlying ground, $T_{B,\\text{ground}}$, attenuated by the snowpack, $\\tau(\\theta)$. The term $(1-\\tau(\\theta))$ represents the effective emissivity of the snow layer.\n\nThe complete forward model is thus constructed by sequentially calculating $h$, $\\phi$, $\\varepsilon'$, $\\varepsilon''$, $\\kappa_a$, and finally $T_{B,\\text{top}}$ using the derived expression. For the special case where $\\text{SWE} = 0$, the snow thickness $h=0$, the path length $L=0$, the transmissivity $\\tau(\\theta)=1$, and the model correctly simplifies to $T_{B,\\text{top}} = e_g T_{\\text{ground}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the upward brightness temperature (BT) at the top of a snow layer\n    for a given set of environmental and observational parameters.\n    \"\"\"\n\n    # Define physical and model constants\n    C_LIGHT = 2.99792458e8  # Speed of light in vacuum, m/s\n    RHO_WATER = 1000.0      # Density of liquid water, kg/m^3\n    RHO_ICE = 917.0         # Density of pure ice, kg/m^3\n    A_PERMITTIVITY = 1.7    # Empirical constant for real part of permittivity\n    B_PERMITTIVITY = 5.0e-4 # Empirical constant for imaginary part of permittivity\n\n    # Test suite: (f_GHz, theta_deg, SWE_m, rho_s, T_snow, T_ground, e_g)\n    test_cases = [\n        (19.35, 0, 0.15, 300, 263, 273, 0.90),\n        (19.35, 0, 0.00, 300, 268, 270, 0.95),\n        (37.00, 0, 0.40, 400, 258, 265, 0.85),\n        (19.35, 0, 0.25, 350, 260, 273, 0.60),\n        (37.00, 50, 0.20, 300, 265, 272, 0.92),\n    ]\n\n    results = []\n    for case in test_cases:\n        f_ghz, theta_deg, swe_m, rho_s, t_snow, t_ground, e_g = case\n\n        # Handle the trivial case of no snow\n        if swe_m == 0.0:\n            tb_top = e_g * t_ground\n            results.append(round(tb_top, 3))\n            continue\n\n        # Step 1: Calculate physical snow thickness (h) from SWE\n        # rho_s * h = rho_w * SWE  =>  h = SWE * (rho_w / rho_s)\n        h = swe_m * (RHO_WATER / rho_s)\n\n        # Step 2: Characterize snowpack dielectric and absorption properties\n        # Ice volume fraction\n        phi = rho_s / RHO_ICE\n\n        # Real and imaginary parts of relative permittivity\n        eps_prime = 1 + A_PERMITTIVITY * phi\n        eps_double_prime = B_PERMITTIVITY * phi * f_ghz\n\n        # Absorption coefficient (kappa_a) in Np/m\n        f_hz = f_ghz * 1e9\n        kappa_a = 2 * (np.pi * f_hz / C_LIGHT) * (eps_double_prime / np.sqrt(eps_prime))\n\n        # Step 3  4: Calculate final brightness temperature at the top\n        # Convert viewing angle to radians\n        theta_rad = np.deg2rad(theta_deg)\n        \n        # Calculate cos(theta). Handle theta=90 to avoid division by zero, though not in test cases.\n        cos_theta = np.cos(theta_rad)\n        if cos_theta == 0:\n            # Path length is infinite, so transmissivity is zero\n            transmissivity = 0.0\n        else:\n            # Optical depth along the slant path\n            optical_depth = kappa_a * h / cos_theta\n            \n            # Transmissivity of the snowpack\n            transmissivity = np.exp(-optical_depth)\n\n        # Brightness temperature from the ground\n        tb_ground_up = e_g * t_ground\n\n        # Final brightness temperature at the top of the snowpack\n        # T_B_top = T_snow * (1 - tau) + T_B_ground * tau\n        tb_top = t_snow * (1 - transmissivity) + tb_ground_up * transmissivity\n\n        results.append(round(tb_top, 3))\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) is robust for different number types\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having established the forward relationship from SWE to brightness temperature, we now tackle the inverse problem in a realistic scenario. Satellite sensors measure radiation at the top of the atmosphere, meaning the signal is a composite of surface emission and atmospheric interference. This problem demonstrates the critical, real-world workflow of atmospheric correction, where you will first \"clean\" the satellite measurement by modeling and removing the effects of atmospheric emission and attenuation . Once the true surface-emitted brightness temperature is isolated, you will apply an empirical algorithm to retrieve the final SWE value, bridging the gap between raw satellite data and a valuable geophysical product.",
            "id": "3847382",
            "problem": "A snow-covered land pixel is observed by a spaceborne passive microwave radiometer at two frequencies, $18.7\\ \\mathrm{GHz}$ and $36.5\\ \\mathrm{GHz}$, vertical polarization. The task is to perform atmospheric correction of the measured Top of Atmosphere (TOA) brightness temperatures using first-principles radiative transfer, then convert the corrected surface-emitted brightness temperatures into Snow Water Equivalent (SWE) using an empirically calibrated linear mapping.\n\nStarting from the scalar radiative transfer equation for a plane-parallel, non-scattering atmosphere and the Rayleigh–Jeans approximation (brightness temperature form), together with Kirchhoff’s law at the snow–air interface, derive the forward expression that links the TOA brightness temperature to the surface-leaving brightness temperature and the atmospheric terms. From that expression, analytically solve for the surface-leaving brightness temperature at each frequency as a function of the TOA brightness temperature, the one-way atmospheric transmittance, and the effective upwelling atmospheric temperature. Then, use the surface boundary condition to remove the reflected downwelling atmospheric contribution and obtain the purely emissive surface brightness temperature at each frequency.\n\nUse the following physically plausible, self-consistent parameters:\n- Measured TOA brightness temperatures: $T_{B,\\mathrm{toa}}(18.7\\ \\mathrm{GHz}) = 240.5\\ \\mathrm{K}$, $T_{B,\\mathrm{toa}}(36.5\\ \\mathrm{GHz}) = 226.7\\ \\mathrm{K}$.\n- One-way atmospheric transmittances: $\\tau(18.7\\ \\mathrm{GHz}) = 0.90$, $\\tau(36.5\\ \\mathrm{GHz}) = 0.80$.\n- Effective upwelling atmospheric temperatures: $T_{\\mathrm{atm}}^{\\uparrow}(18.7\\ \\mathrm{GHz}) = 260\\ \\mathrm{K}$, $T_{\\mathrm{atm}}^{\\uparrow}(36.5\\ \\mathrm{GHz}) = 265\\ \\mathrm{K}$.\n- Effective downwelling atmospheric brightness temperatures incident at the surface: $T_{\\mathrm{atm}}^{\\downarrow}(18.7\\ \\mathrm{GHz}) = 30\\ \\mathrm{K}$, $T_{\\mathrm{atm}}^{\\downarrow}(36.5\\ \\mathrm{GHz}) = 40\\ \\mathrm{K}$.\n- Snow effective nadir emissivities (vertical polarization): $\\epsilon(18.7\\ \\mathrm{GHz}) = 0.95$, $\\epsilon(36.5\\ \\mathrm{GHz}) = 0.85$.\n\nAssume that $T_{\\mathrm{atm}}^{\\downarrow}$ already includes the cosmic microwave background contribution. After obtaining the emissive surface brightness temperatures $T_{B,\\mathrm{emit}}(18.7\\ \\mathrm{GHz})$ and $T_{B,\\mathrm{emit}}(36.5\\ \\mathrm{GHz})$, convert to Snow Water Equivalent (SWE) using a regionally calibrated first-order linear mapping\n$$\n\\mathrm{SWE} = \\gamma_{1}\\,\\big[T_{B,\\mathrm{emit}}(18.7\\ \\mathrm{GHz}) - T_{B,\\mathrm{emit}}(36.5\\ \\mathrm{GHz})\\big] + \\gamma_{0},\n$$\nwith coefficients $\\gamma_{1} = 1.20\\ \\mathrm{mm}\\ \\mathrm{K}^{-1}$ and $\\gamma_{0} = 5.0\\ \\mathrm{mm}$.\n\nCompute the final $\\mathrm{SWE}$ and express it in millimeters of water equivalent (notated as an equivalent depth, where $1\\ \\mathrm{mm} \\equiv 1\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}$). Round your final numerical answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of radiative transfer, well-posed with sufficient and consistent data, and stated in objective, formal language. We may proceed with the solution.\n\nThe task is to first perform an atmospheric correction on passive microwave brightness temperature data and then use the corrected data to estimate Snow Water Equivalent (SWE). This will be accomplished in three main steps:\n1.  Derive the relationship for atmospheric correction.\n2.  Apply the correction to the given data for two frequencies.\n3.  Use the corrected brightness temperatures to calculate SWE.\n\nLet $\\nu$ denote the frequency. The radiative transfer equation for a non-scattering, plane-parallel atmosphere, expressed in terms of brightness temperature under the Rayleigh-Jeans approximation, relates the Top of Atmosphere (TOA) brightness temperature, $T_{B,\\mathrm{toa}}(\\nu)$, to the surface-leaving brightness temperature, $T_{B,\\mathrm{surf}}(\\nu)$, and atmospheric properties. The equation is:\n$$\nT_{B,\\mathrm{toa}}(\\nu) = T_{B,\\mathrm{surf}}(\\nu) \\tau(\\nu) + T_{\\mathrm{atm}}^{\\uparrow}(\\nu) (1 - \\tau(\\nu))\n$$\nwhere $\\tau(\\nu)$ is the one-way atmospheric transmittance and $T_{\\mathrm{atm}}^{\\uparrow}(\\nu)$ is the effective upwelling atmospheric temperature.\n\nFirst, we must solve this equation for the surface-leaving brightness temperature, $T_{B,\\mathrm{surf}}(\\nu)$. This is the quantity that would be measured by a sensor at the surface looking upward. Rearranging the equation:\n$$\nT_{B,\\mathrm{surf}}(\\nu) \\tau(\\nu) = T_{B,\\mathrm{toa}}(\\nu) - T_{\\mathrm{atm}}^{\\uparrow}(\\nu) (1 - \\tau(\\nu))\n$$\n$$\nT_{B,\\mathrm{surf}}(\\nu) = \\frac{T_{B,\\mathrm{toa}}(\\nu) - T_{\\mathrm{atm}}^{\\uparrow}(\\nu) (1 - \\tau(\\nu))}{\\tau(\\nu)}\n$$\nThis is the atmospherically corrected brightness temperature as seen from just above the surface.\n\nNext, we must remove the contribution of downwelling atmospheric radiation that is reflected by the snow surface. The surface-leaving brightness temperature $T_{B,\\mathrm{surf}}(\\nu)$ is the sum of two components: the radiation emitted by the surface and the radiation reflected by the surface.\n$$\nT_{B,\\mathrm{surf}}(\\nu) = T_{B,\\mathrm{emit}}(\\nu) + T_{B,\\mathrm{refl}}(\\nu)\n$$\nThe emitted component is $T_{B,\\mathrm{emit}}(\\nu) = \\epsilon(\\nu) T_s$, where $\\epsilon(\\nu)$ is the surface emissivity and $T_s$ is the physical temperature of the snow surface. The reflected component is $T_{B,\\mathrm{refl}}(\\nu) = \\rho(\\nu) T_{\\mathrm{atm}}^{\\downarrow}(\\nu)$, where $\\rho(\\nu)$ is the surface reflectivity and $T_{\\mathrm{atm}}^{\\downarrow}(\\nu)$ is the downwelling atmospheric brightness temperature incident on the surface.\n\nAccording to Kirchhoff's law for an opaque body in thermal equilibrium, $\\epsilon(\\nu) + \\rho(\\nu) = 1$. Thus, the reflectivity is $\\rho(\\nu) = 1 - \\epsilon(\\nu)$. Substituting this into the expression for $T_{B,\\mathrm{surf}}(\\nu)$:\n$$\nT_{B,\\mathrm{surf}}(\\nu) = T_{B,\\mathrm{emit}}(\\nu) + (1 - \\epsilon(\\nu)) T_{\\mathrm{atm}}^{\\downarrow}(\\nu)\n$$\nOur goal is to find the purely emissive surface brightness temperature, $T_{B,\\mathrm{emit}}(\\nu)$. Rearranging the above equation gives:\n$$\nT_{B,\\mathrm{emit}}(\\nu) = T_{B,\\mathrm{surf}}(\\nu) - (1 - \\epsilon(\\nu)) T_{\\mathrm{atm}}^{\\downarrow}(\\nu)\n$$\nBy combining the two derived expressions, we get the complete formula for $T_{B,\\mathrm{emit}}(\\nu)$ in terms of the measured TOA brightness temperature and other parameters:\n$$\nT_{B,\\mathrm{emit}}(\\nu) = \\frac{T_{B,\\mathrm{toa}}(\\nu) - T_{\\mathrm{atm}}^{\\uparrow}(\\nu) (1 - \\tau(\\nu))}{\\tau(\\nu)} - (1 - \\epsilon(\\nu)) T_{\\mathrm{atm}}^{\\downarrow}(\\nu)\n$$\nWe now apply this formula to the given data for the two frequencies, $\\nu_1 = 18.7\\ \\mathrm{GHz}$ and $\\nu_2 = 36.5\\ \\mathrm{GHz}$.\n\nFor $\\nu_1 = 18.7\\ \\mathrm{GHz}$:\n-   $T_{B,\\mathrm{toa}}(18.7\\ \\mathrm{GHz}) = 240.5\\ \\mathrm{K}$\n-   $\\tau(18.7\\ \\mathrm{GHz}) = 0.90$\n-   $T_{\\mathrm{atm}}^{\\uparrow}(18.7\\ \\mathrm{GHz}) = 260\\ \\mathrm{K}$\n-   $T_{\\mathrm{atm}}^{\\downarrow}(18.7\\ \\mathrm{GHz}) = 30\\ \\mathrm{K}$\n-   $\\epsilon(18.7\\ \\mathrm{GHz}) = 0.95$\n\nFirst, calculate the surface-leaving brightness temperature:\n$$\nT_{B,\\mathrm{surf}}(18.7\\ \\mathrm{GHz}) = \\frac{240.5 - 260 \\cdot (1 - 0.90)}{0.90} = \\frac{240.5 - 260 \\cdot 0.10}{0.90} = \\frac{240.5 - 26}{0.90} = \\frac{214.5}{0.90} = 238.\\overline{3}\\ \\mathrm{K}\n$$\nNext, calculate the emissive surface brightness temperature:\n$$\nT_{B,\\mathrm{emit}}(18.7\\ \\mathrm{GHz}) = 238.\\overline{3} - (1 - 0.95) \\cdot 30 = 238.\\overline{3} - 0.05 \\cdot 30 = 238.\\overline{3} - 1.5 = 236.8\\overline{3}\\ \\mathrm{K}\n$$\n\nFor $\\nu_2 = 36.5\\ \\mathrm{GHz}$:\n-   $T_{B,\\mathrm{toa}}(36.5\\ \\mathrm{GHz}) = 226.7\\ \\mathrm{K}$\n-   $\\tau(36.5\\ \\mathrm{GHz}) = 0.80$\n-   $T_{\\mathrm{atm}}^{\\uparrow}(36.5\\ \\mathrm{GHz}) = 265\\ \\mathrm{K}$\n-   $T_{\\mathrm{atm}}^{\\downarrow}(36.5\\ \\mathrm{GHz}) = 40\\ \\mathrm{K}$\n-   $\\epsilon(36.5\\ \\mathrm{GHz}) = 0.85$\n\nFirst, calculate the surface-leaving brightness temperature:\n$$\nT_{B,\\mathrm{surf}}(36.5\\ \\mathrm{GHz}) = \\frac{226.7 - 265 \\cdot (1 - 0.80)}{0.80} = \\frac{226.7 - 265 \\cdot 0.20}{0.80} = \\frac{226.7 - 53}{0.80} = \\frac{173.7}{0.80} = 217.125\\ \\mathrm{K}\n$$\nNext, calculate the emissive surface brightness temperature:\n$$\nT_{B,\\mathrm{emit}}(36.5\\ \\mathrm{GHz}) = 217.125 - (1 - 0.85) \\cdot 40 = 217.125 - 0.15 \\cdot 40 = 217.125 - 6 = 211.125\\ \\mathrm{K}\n$$\n\nFinally, we compute the Snow Water Equivalent (SWE) using the provided linear mapping:\n$$\n\\mathrm{SWE} = \\gamma_{1}\\,\\big[T_{B,\\mathrm{emit}}(18.7\\ \\mathrm{GHz}) - T_{B,\\mathrm{emit}}(36.5\\ \\mathrm{GHz})\\big] + \\gamma_{0}\n$$\nThe coefficients are $\\gamma_{1} = 1.20\\ \\mathrm{mm}\\ \\mathrm{K}^{-1}$ and $\\gamma_{0} = 5.0\\ \\mathrm{mm}$.\n\nFirst, calculate the brightness temperature difference:\n$$\n\\Delta T_B = T_{B,\\mathrm{emit}}(18.7\\ \\mathrm{GHz}) - T_{B,\\mathrm{emit}}(36.5\\ \\mathrm{GHz}) = 236.8\\overline{3}\\ \\mathrm{K} - 211.125\\ \\mathrm{K}\n$$\nTo maintain precision, we can use fractions: $236.8\\overline{3} = 236 + \\frac{5}{6}$ and $211.125 = 211 + \\frac{1}{8}$.\n$$\n\\Delta T_B = \\left(236 + \\frac{5}{6}\\right) - \\left(211 + \\frac{1}{8}\\right) = 25 + \\left(\\frac{5}{6} - \\frac{1}{8}\\right) = 25 + \\left(\\frac{20 - 3}{24}\\right) = 25 + \\frac{17}{24} = \\frac{617}{24}\\ \\mathrm{K}\n$$\nAs a decimal, $\\Delta T_B \\approx 25.708\\overline{3}\\ \\mathrm{K}$.\n\nNow substitute this into the SWE equation:\n$$\n\\mathrm{SWE} = 1.20 \\cdot \\left(\\frac{617}{24}\\right) + 5.0\n$$\n$$\n\\mathrm{SWE} = \\frac{1.20}{24} \\cdot 617 + 5.0 = \\frac{1}{20} \\cdot 617 + 5.0 = 30.85 + 5.0 = 35.85\\ \\mathrm{mm}\n$$\nThe problem requires the final answer to be rounded to four significant figures. The calculated value $35.85$ already has four significant figures.",
            "answer": "$$\n\\boxed{35.85}\n$$"
        },
        {
            "introduction": "Our final practice moves beyond direct retrieval to a more sophisticated method for synthesizing information. Both our physical models and our satellite observations have inherent uncertainties. Data assimilation offers a powerful statistical framework to optimally combine a model forecast with new observations to produce a more accurate estimate, or \"analysis.\" This exercise introduces the one-dimensional variational (1D-Var) approach, framing the SWE estimation as a minimization problem: find the state that best fits both the prior model knowledge and the satellite data, weighted by their respective uncertainties . This technique is a cornerstone of modern environmental prediction systems, enabling the creation of consistent and robust climate data records.",
            "id": "3847379",
            "problem": "You are tasked with implementing a one-dimensional variational data assimilation for estimating Snow Water Equivalent (SWE) from passive microwave Brightness Temperature (BT) observations at two frequencies over a single land pixel, using a simple land surface snow model. The estimation should be grounded in first principles and well-tested formulas of radiative transfer for microwave remote sensing under clear-sky nadir viewing.\n\nFundamental starting point:\n- For a plane-parallel, non-emitting atmosphere and nadir viewing, the observed microwave Brightness Temperature (BT) at frequency $f$, denoted $T_{B,f}$, can be approximated by $T_{B,f} \\approx \\epsilon_f T_s$, where $\\epsilon_f$ is the effective surface emissivity at frequency $f$ and $T_s$ is the bulk physical temperature of the snow-covered surface layer.\n- For dry snow, volume scattering reduces the effective emissivity as the optical path increases. A key state variable that correlates with path length and scattering is Snow Water Equivalent (SWE), denoted $x$ and expressed in millimeters $\\mathrm{mm}$. Around a reference background value $x_b$, the emissivity at frequency $f$ can be linearized using a first-order Taylor expansion as $\\epsilon_f(x) \\approx \\epsilon_{0,f} - k_f x$, where $\\epsilon_{0,f} \\in (0,1)$ is the emissivity at zero SWE and $k_f  0$ is a scattering slope coefficient with units $\\mathrm{mm}^{-1}$.\n\nModel and data assimilation framework:\n- The observation operator mapping SWE $x$ to BTs at two microwave frequencies $f_1$ and $f_2$ is the vector function $H(x)$ whose $i$-th component is $H_i(x) = T_s \\epsilon_{f_i}(x)$, with $\\epsilon_{f_i}(x)$ approximated via the linearization described above.\n- The analysis is formulated as a One-Dimensional Variational (1D-Var) problem. Let the background SWE be $x_b$ with background error variance $B  0$, and let the observed BTs be $y = [y_1, y_2]^T$ with observation error covariance $R = \\mathrm{diag}(\\sigma_{y_1}^2, \\sigma_{y_2}^2)$, where $\\sigma_{y_i}^2  0$. Assuming Gaussian errors, the cost function to be minimized is\n$$\nJ(x) = (x - x_b)^2 B^{-1} + (y - H(x))^\\top R^{-1} (y - H(x)).\n$$\n- You must derive from the given physical base and definitions the gradient $\\nabla J(x)$ and the Hessian for the scalar $x$, and obtain the closed-form analysis for $x$ under the linearized observation operator. You must implement the resulting computation of the posterior mean SWE (analysis) $x_a$ and its non-negativity physical constraint (i.e., enforce $x_a \\geq 0$ by projection if needed). You do not need to output the posterior variance, but the derivation should be consistent with the posed statistical model.\n\nUnits and output:\n- All Brightness Temperatures $T_{B,f}$ and physical temperatures $T_s$ are in Kelvin $\\mathrm{K}$.\n- Snow Water Equivalent $x$ must be expressed in millimeters $\\mathrm{mm}$.\n- Your program should produce a single line of output containing the posterior SWE estimates $x_a$ for each test case in $\\mathrm{mm}$, rounded to three decimals, as a comma-separated list enclosed in square brackets (e.g., $[12.345,67.890,0.000]$).\n\nTest suite:\nImplement your solution for the following five test cases. Each case specifies $T_s$, emissivity parameters $\\epsilon_{0,f}$, scattering slopes $k_f$, observed BTs $y$, the background $x_b$, the background variance $B$, and the observation error variances for the two channels.\n\n- Case $1$ (happy path, mid SWE, moderate errors):\n  - $T_s = 260\\,\\mathrm{K}$\n  - Frequencies: $f_1 = 19\\,\\mathrm{GHz}$, $f_2 = 37\\,\\mathrm{GHz}$\n  - $\\epsilon_{0,f_1} = 0.95$, $\\epsilon_{0,f_2} = 0.92$\n  - $k_{f_1} = 1.5 \\times 10^{-4}\\,\\mathrm{mm}^{-1}$, $k_{f_2} = 3.0 \\times 10^{-4}\\,\\mathrm{mm}^{-1}$\n  - $y = [241.1\\,\\mathrm{K}, 227.4\\,\\mathrm{K}]$\n  - $x_b = 100\\,\\mathrm{mm}$, $B = 900\\,\\mathrm{mm}^2$\n  - $R = \\mathrm{diag}(4.0\\,\\mathrm{K}^2, 9.0\\,\\mathrm{K}^2)$\n\n- Case $2$ (near-zero SWE, relatively confident background and observations):\n  - $T_s = 260\\,\\mathrm{K}$\n  - $f_1 = 19\\,\\mathrm{GHz}$, $f_2 = 37\\,\\mathrm{GHz}$\n  - $\\epsilon_{0,f_1} = 0.95$, $\\epsilon_{0,f_2} = 0.92$\n  - $k_{f_1} = 1.5 \\times 10^{-4}\\,\\mathrm{mm}^{-1}$, $k_{f_2} = 3.0 \\times 10^{-4}\\,\\mathrm{mm}^{-1}$\n  - $y = [246.8\\,\\mathrm{K}, 238.8\\,\\mathrm{K}]$\n  - $x_b = 20\\,\\mathrm{mm}$, $B = 400\\,\\mathrm{mm}^2$\n  - $R = \\mathrm{diag}(4.0\\,\\mathrm{K}^2, 4.0\\,\\mathrm{K}^2)$\n\n- Case $3$ (high SWE, larger background uncertainty and moderate observation errors):\n  - $T_s = 260\\,\\mathrm{K}$\n  - $f_1 = 19\\,\\mathrm{GHz}$, $f_2 = 37\\,\\mathrm{GHz}$\n  - $\\epsilon_{0,f_1} = 0.95$, $\\epsilon_{0,f_2} = 0.92$\n  - $k_{f_1} = 1.5 \\times 10^{-4}\\,\\mathrm{mm}^{-1}$, $k_{f_2} = 3.0 \\times 10^{-4}\\,\\mathrm{mm}^{-1}$\n  - $y = [235.1\\,\\mathrm{K}, 216.2\\,\\mathrm{K}]$\n  - $x_b = 250\\,\\mathrm{mm}$, $B = 1600\\,\\mathrm{mm}^2$\n  - $R = \\mathrm{diag}(9.0\\,\\mathrm{K}^2, 9.0\\,\\mathrm{K}^2)$\n\n- Case $4$ (colder surface, mid SWE, mixed observation errors):\n  - $T_s = 240\\,\\mathrm{K}$\n  - $f_1 = 19\\,\\mathrm{GHz}$, $f_2 = 37\\,\\mathrm{GHz}$\n  - $\\epsilon_{0,f_1} = 0.96$, $\\epsilon_{0,f_2} = 0.93$\n  - $k_{f_1} = 1.5 \\times 10^{-4}\\,\\mathrm{mm}^{-1}$, $k_{f_2} = 3.0 \\times 10^{-4}\\,\\mathrm{mm}^{-1}$\n  - $y = [226.1\\,\\mathrm{K}, 214.7\\,\\mathrm{K}]$\n  - $x_b = 130\\,\\mathrm{mm}$, $B = 900\\,\\mathrm{mm}^2$\n  - $R = \\mathrm{diag}(4.0\\,\\mathrm{K}^2, 9.0\\,\\mathrm{K}^2)$\n\n- Case $5$ (warmer surface, mid-high SWE, highly uncertain second channel):\n  - $T_s = 265\\,\\mathrm{K}$\n  - $f_1 = 19\\,\\mathrm{GHz}$, $f_2 = 37\\,\\mathrm{GHz}$\n  - $\\epsilon_{0,f_1} = 0.94$, $\\epsilon_{0,f_2} = 0.91$\n  - $k_{f_1} = 1.5 \\times 10^{-4}\\,\\mathrm{mm}^{-1}$, $k_{f_2} = 3.0 \\times 10^{-4}\\,\\mathrm{mm}^{-1}$\n  - $y = [241.9\\,\\mathrm{K}, 226.9\\,\\mathrm{K}]$\n  - $x_b = 160\\,\\mathrm{mm}$, $B = 900\\,\\mathrm{mm}^2$\n  - $R = \\mathrm{diag}(4.0\\,\\mathrm{K}^2, 25.0\\,\\mathrm{K}^2)$\n\nImplementation requirements:\n- Derive the analytical expression of the posterior mean $x_a$ from the cost function $J(x)$ using the specified observation operator and linearization assumptions, starting from the radiative transfer base described above.\n- Implement the computation of $x_a$ for each test case and enforce $x_a \\geq 0$ by projection onto the feasible set if necessary.\n- Your program must produce a single line of output containing the posterior SWE estimates for the five test cases in $\\mathrm{mm}$, rounded to three decimals, as a comma-separated list enclosed in square brackets.",
            "solution": "The problem has been validated and is deemed scientifically grounded, well-posed, objective, and complete. It constitutes a standard exercise in one-dimensional variational data assimilation (1D-Var) with a linear observation operator, grounded in the physics of microwave radiative transfer for snow. All necessary parameters and conditions are provided for a unique solution.\n\nThe objective is to find the Snow Water Equivalent (SWE), denoted by the scalar state variable $x$, that minimizes the following cost function $J(x)$:\n$$\nJ(x) = (x - x_b)^2 B^{-1} + (y - H(x))^\\top R^{-1} (y - H(x))\n$$\nwhere $x_b$ is the background estimate of SWE with error variance $B$, $y$ is the vector of observed Brightness Temperatures (BTs) at two frequencies, $R$ is the diagonal observation error covariance matrix, and $H(x)$ is the observation operator that maps the state $x$ to the observation space.\n\nFirst, we must explicitly define the observation operator $H(x)$ and its Jacobian. The problem states that the BT at frequency $f$, $T_{B,f}$, is approximated by $T_{B,f} \\approx \\epsilon_f T_s$, where $T_s$ is the physical snow temperature and $\\epsilon_f$ is the emissivity. The emissivity is linearized with respect to SWE $x$ as $\\epsilon_f(x) \\approx \\epsilon_{0,f} - k_f x$.\nFor two frequencies, $f_1$ and $f_2$, the vector observation operator $H(x)$ is:\n$$\nH(x) = \\begin{pmatrix} T_s (\\epsilon_{0,f_1} - k_{f_1} x) \\\\ T_s (\\epsilon_{0,f_2} - k_{f_2} x) \\end{pmatrix}\n$$\nThis is a linear operator in $x$. We can express it in the form $H(x) = \\mathbf{h}_0 - \\mathbf{h}x$, where:\n$$\n\\mathbf{h}_0 = T_s \\begin{pmatrix} \\epsilon_{0,f_1} \\\\ \\epsilon_{0,f_2} \\end{pmatrix} \\quad \\text{and} \\quad \\mathbf{h} = T_s \\begin{pmatrix} k_{f_1} \\\\ k_{f_2} \\end{pmatrix}\n$$\n$\\mathbf{h}_0$ represents the BTs for zero snow ($x=0$), and the vector $\\mathbf{h}$ represents the sensitivity of the BTs to SWE.\n\nTo find the minimum of the cost function $J(x)$, we must compute its gradient with respect to $x$ and set it to zero.\n$$\nJ(x) = B^{-1}(x - x_b)^2 + (y - (\\mathbf{h}_0 - \\mathbf{h}x))^\\top R^{-1} (y - (\\mathbf{h}_0 - \\mathbf{h}x))\n$$\nLet's define the innovation vector (observation minus forecast at $x=0$) as $\\mathbf{d} = y - \\mathbf{h}_0$. The cost function becomes:\n$$\nJ(x) = B^{-1}(x - x_b)^2 + (\\mathbf{d} + \\mathbf{h}x)^\\top R^{-1} (\\mathbf{d} + \\mathbf{h}x)\n$$\nExpanding the observation term:\n$$\n(\\mathbf{d} + \\mathbf{h}x)^\\top R^{-1} (\\mathbf{d} + \\mathbf{h}x) = \\mathbf{d}^\\top R^{-1} \\mathbf{d} + \\mathbf{d}^\\top R^{-1} \\mathbf{h}x + x\\mathbf{h}^\\top R^{-1} \\mathbf{d} + x^2\\mathbf{h}^\\top R^{-1} \\mathbf{h}\n$$\nSince all terms are scalars, and $R^{-1}$ is symmetric, $\\mathbf{d}^\\top R^{-1} \\mathbf{h}x = x\\mathbf{h}^\\top R^{-1} \\mathbf{d}$. The expression simplifies to:\n$$\nJ(x) = B^{-1}(x^2 - 2x_b x + x_b^2) + \\mathbf{d}^\\top R^{-1} \\mathbf{d} + 2x(\\mathbf{h}^\\top R^{-1} \\mathbf{d}) + x^2(\\mathbf{h}^\\top R^{-1} \\mathbf{h})\n$$\nThe gradient (first derivative) with respect to $x$ is:\n$$\n\\frac{dJ}{dx} = 2B^{-1}(x - x_b) + 2(\\mathbf{h}^\\top R^{-1} \\mathbf{d}) + 2x(\\mathbf{h}^\\top R^{-1} \\mathbf{h})\n$$\nSetting the gradient to $0$ to find the minimum:\n$$\nB^{-1}(x_a - x_b) + \\mathbf{h}^\\top R^{-1} \\mathbf{d} + x_a(\\mathbf{h}^\\top R^{-1} \\mathbf{h}) = 0\n$$\nwhere $x_a$ is the analysis (optimal) value of $x$. We solve for $x_a$:\n$$\nx_a(B^{-1} + \\mathbf{h}^\\top R^{-1} \\mathbf{h}) = x_b B^{-1} - \\mathbf{h}^\\top R^{-1} \\mathbf{d}\n$$\nSubstituting $\\mathbf{d} = y - \\mathbf{h}_0$ back into the equation:\n$$\nx_a(B^{-1} + \\mathbf{h}^\\top R^{-1} \\mathbf{h}) = x_b B^{-1} - \\mathbf{h}^\\top R^{-1} (y - \\mathbf{h}_0)\n$$\nThis gives the closed-form solution for the analysis SWE, $x_a$:\n$$\nx_a = \\frac{x_b B^{-1} - \\mathbf{h}^\\top R^{-1} (y - \\mathbf{h}_0)}{B^{-1} + \\mathbf{h}^\\top R^{-1} \\mathbf{h}}\n$$\nThe second derivative (Hessian) is $\\frac{d^2J}{dx^2} = 2(B^{-1} + \\mathbf{h}^\\top R^{-1}\\mathbf{h})$. Since $B  0$ and $R$ is a positive-definite covariance matrix, $R^{-1}$ is also positive-definite. The term $\\mathbf{h}^\\top R^{-1}\\mathbf{h}$ is a quadratic form which is non-negative, and positive if $\\mathbf{h} \\neq 0$ (which is true as $k_f  0$). Thus, the Hessian is positive, confirming that our solution corresponds to a unique minimum.\n\nThe terms in the formula can be written explicitly. Given $R = \\mathrm{diag}(\\sigma_{y_1}^2, \\sigma_{y_2}^2)$, its inverse is $R^{-1} = \\mathrm{diag}(1/\\sigma_{y_1}^2, 1/\\sigma_{y_2}^2)$. The scalar products are:\n$$\n\\mathbf{h}^\\top R^{-1} \\mathbf{h} = \\frac{(T_s k_{f_1})^2}{\\sigma_{y_1}^2} + \\frac{(T_s k_{f_2})^2}{\\sigma_{y_2}^2}\n$$\n$$\n\\mathbf{h}^\\top R^{-1} (y - \\mathbf{h}_0) = \\frac{T_s k_{f_1}}{\\sigma_{y_1}^2}(y_1 - T_s \\epsilon_{0,f_1}) + \\frac{T_s k_{f_2}}{\\sigma_{y_2}^2}(y_2 - T_s \\epsilon_{0,f_2})\n$$\nSo the final equation for implementation is:\n$$\nx_a = \\frac{\\frac{x_b}{B} - \\left[ \\frac{T_s k_{f_1}(y_1 - T_s \\epsilon_{0,f_1})}{\\sigma_{y_1}^2} + \\frac{T_s k_{f_2}(y_2 - T_s \\epsilon_{0,f_2})}{\\sigma_{y_2}^2} \\right]}{\\frac{1}{B} + \\frac{(T_s k_{f_1})^2}{\\sigma_{y_1}^2} + \\frac{(T_s k_{f_2})^2}{\\sigma_{y_2}^2}}\n$$\nFinally, since SWE must be physically non-negative, the result is projected onto the feasible set:\n$$\nx_a \\leftarrow \\max(0, x_a)\n$$\nThis procedure is applied to each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the posterior Snow Water Equivalent (SWE) using a 1D-Var assimilation scheme.\n    \"\"\"\n\n    # Test cases are provided as tuples with the following structure:\n    # (Ts, e0_f1, e0_f2, k_f1, k_f2, y1, y2, xb, B, R11, R22)\n    test_cases = [\n        # Case 1\n        (260.0, 0.95, 0.92, 1.5e-4, 3.0e-4, 241.1, 227.4, 100.0, 900.0, 4.0, 9.0),\n        # Case 2\n        (260.0, 0.95, 0.92, 1.5e-4, 3.0e-4, 246.8, 238.8, 20.0, 400.0, 4.0, 4.0),\n        # Case 3\n        (260.0, 0.95, 0.92, 1.5e-4, 3.0e-4, 235.1, 216.2, 250.0, 1600.0, 9.0, 9.0),\n        # Case 4\n        (240.0, 0.96, 0.93, 1.5e-4, 3.0e-4, 226.1, 214.7, 130.0, 900.0, 4.0, 9.0),\n        # Case 5\n        (265.0, 0.94, 0.91, 1.5e-4, 3.0e-4, 241.9, 226.9, 160.0, 900.0, 4.0, 25.0)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        Ts, e0_f1, e0_f2, k_f1, k_f2, y1, y2, xb, B, sy1_sq, sy2_sq = case\n\n        # Numerator calculation for the analysis SWE formula\n        # Numerator = xb*B^-1 - h^T * R^-1 * (y - h0)\n        \n        # Background term in numerator\n        num_bg_term = xb / B\n\n        # h^T * R^-1 * (y - h0) term\n        # First component: h1 * R11^-1 * (y1 - h0_1)\n        h0_1 = Ts * e0_f1\n        h1 = Ts * k_f1\n        innov_term1 = (h1 * (y1 - h0_1)) / sy1_sq\n        \n        # Second component: h2 * R22^-1 * (y2 - h0_2)\n        h0_2 = Ts * e0_f2\n        h2 = Ts * k_f2\n        innov_term2 = (h2 * (y2 - h0_2)) / sy2_sq\n        \n        # Full numerator\n        numerator = num_bg_term - (innov_term1 + innov_term2)\n\n        # Denominator calculation for the analysis SWE formula\n        # Denominator = B^-1 + h^T * R^-1 * h\n        \n        # Background term in denominator\n        den_bg_term = 1.0 / B\n        \n        # h^T * R^-1 * h term\n        hRh_term = (h1**2 / sy1_sq) + (h2**2 / sy2_sq)\n        \n        # Full denominator\n        denominator = den_bg_term + hRh_term\n\n        # Calculate analysis SWE (xa)\n        if denominator == 0:\n            # This case shouldn't happen with the given problem constraints\n            # (B  0, R positive definite, k_f  0)\n            xa_unconstrained = 0.0\n        else:\n            xa_unconstrained = numerator / denominator\n\n        # Apply non-negativity constraint by projection\n        xa = max(0.0, xa_unconstrained)\n        \n        results.append(f\"{xa:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}