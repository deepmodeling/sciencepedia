{
    "hands_on_practices": [
        {
            "introduction": "理解土壤水分反演始于掌握正向模型，该模型描述了能量如何从地球表面传播到卫星传感器。第一个实践将指导您构建基础的 tau-omega 模型，并将观测到的亮度温度分解为其核心物理分量：土壤发射、植被发射和反射能量。通过从第一性原理构建此模型，您将清晰地、定量地理解不同的地表和植被属性如何对卫星信号做出贡献 。",
            "id": "3833618",
            "problem": "一个平面平行、等温的植被层覆盖在半无限的土壤之上。植被的特征由天底方向上与偏振相关的植被光学厚度（VOD）$\\tau_V$ 和与偏振相关的单次散射反照率（SSA）$\\omega_V$ 描述。土壤的特征由与偏振相关的发射率 $e_V$ 和相应的反射率 $r_V = 1 - e_V$ 描述。假设一个标量的、单次散射的辐射传输框架，使用亮温（BT）表示，并采用瑞利-金斯近似，从而发射和散射可以直接用亮温单位表示。植被的物理温度为 $T_v$，土壤的物理温度为 $T_s$，冠层顶部的下行天空亮温为 $T_{sky}$。设传感器在同一偏振通道 $V$ 内，以距离天底方向 $\\theta$ 度（单位：度）的入射角进行观测。\n\n从具有消光和单次散射的平面平行板的辐射传输方程出发，并利用以下基本事实：\n\n- 斜路径光学厚度为 $\\tau_V / \\cos\\theta$，因此植被层沿斜路径的透过率为 $\\Gamma_V = \\exp\\!\\big(-\\tau_V / \\cos\\theta\\big)$。\n- 在单次散射和各向同性发射的近似下，植被的亮温源函数为 $(1 - \\omega_V) T_v$。\n- 下层土壤向上发射 $e_V T_s$ 并反射下行亮度的 $r_V$ 部分。\n\n通过明确计算并求和以下物理上不同的贡献，推导出冠层顶部的垂直偏振亮温 $T_{B,V}(\\theta)$：\n\n1. 沿斜路径被植被衰减的土壤上行发射。\n2. 沿斜路径的植被上行自发射。\n3. 被土壤反射一次并向上穿过植被透射的植被下行发射。\n4. 透射到土壤、被反射一次并向上穿过植被透射的下行天空亮度。\n\n然后，对于以下物理上一致的参数，在 $\\theta = 40^\\circ$ 处对 $T_{B,V}$ 进行数值计算：\n- $e_V = 0.92$ (无量纲),\n- $T_s = 300\\,\\mathrm{K}$,\n- $T_v = 295\\,\\mathrm{K}$,\n- $\\tau_V = 0.60$ (无量纲),\n- $\\omega_V = 0.05$ (无量纲),\n- $T_{sky} = 2.73\\,\\mathrm{K}$。\n\n在计算过程中，通过逐项评估，分离并报告可归因于植被发射与土壤发射的数值贡献。将最终的 $T_{B,V}$ 以 $\\mathrm{K}$ 为单位表示，并将最终结果四舍五入到四位有效数字。",
            "solution": "该问题具有科学依据，提法明确且客观。它提出了一个用于土壤湿度被动微波遥感的标准一阶辐射传输模型（τ-ω模型）。所有必要的参数都已提供，其数值在物理上是现实的。该问题有效。\n\n传感器在冠层顶部观测到的总亮温 $T_{B,V}(\\theta)$ 是四个不同物理贡献的总和，其中 $\\theta$ 是从天底方向算起的入射角。\n\n首先，我们定义关键参数和中间变量：\n- $\\tau_V$：天底（垂直路径）方向的植被光学厚度。\n- $\\omega_V$：植被单次散射反照率。\n- $e_V$：土壤发射率。\n- $r_V$：土壤反射率，由 $r_V = 1 - e_V$ 给出。\n- $T_s$：土壤的物理温度。\n- $T_v$：植被的物理温度。\n- $T_{sky}$：冠层上方的下行天空亮温。\n- 为了考虑在斜向观测角 $\\theta$ 下穿过植被的更长路径，斜路径光学厚度为 $\\frac{\\tau_V}{\\cos\\theta}$。\n- 植被层沿此斜路径的透过率 $\\Gamma_V$ 由下式给出：\n$$\n\\Gamma_V(\\theta) = \\exp\\left(-\\frac{\\tau_V}{\\cos\\theta}\\right)\n$$\n\n我们现在推导总亮温 $T_{B,V}(\\theta)$ 的四个分量。\n\n1.  **被植被衰减的土壤上行发射 ($T_1$)**: 土壤作为灰体发射，亮温为 $e_V T_s$。该辐射向上穿过植被层并被衰减。到达传感器的部分是：\n    $$\n    T_1 = e_V T_s \\Gamma_V(\\theta)\n    $$\n\n2.  **植被上行自发射 ($T_2$)**: 植被层自身也发射辐射。对于物理温度为 $T_v$ 的等温层，其沿斜路径的发射率为 $(1 - \\Gamma_V(\\theta))$。单次散射反照率 $\\omega_V$ 考虑了散射，因此只有一小部分 $(1 - \\omega_V)$ 的消光是由吸收和再发射引起的。因此，来自植被的上行发射为：\n    $$\n    T_2 = (1 - \\omega_V)(1 - \\Gamma_V(\\theta)) T_v\n    $$\n\n3.  **被土壤反射的植被下行发射 ($T_3$)**: 植被也向下发射。根据对称性，下行发射的亮温与上行发射相同，即 $(1 - \\omega_V)(1 - \\Gamma_V(\\theta)) T_v$。该辐射传播到土壤表面，其中一部分 $r_V$ 被向上反射。这部分反射的辐射在向上返回穿过植被到达传感器的过程中再次被衰减。其贡献为：\n    $$\n    T_3 = \\underbrace{(1 - \\omega_V)(1 - \\Gamma_V(\\theta)) T_v}_{\\text{下行发射}} \\times \\underbrace{r_V}_{\\text{反射}} \\times \\underbrace{\\Gamma_V(\\theta)}_{\\text{上行衰减}}\n    $$\n    $$\n    T_3 = r_V (1 - \\omega_V)(1 - \\Gamma_V(\\theta)) \\Gamma_V(\\theta) T_v\n    $$\n\n4.  **被土壤反射的下行天空亮度 ($T_4$)**: 天空亮温 $T_{sky}$ 首先向下穿过冠层透射到土壤表面。它被一个因子 $\\Gamma_V(\\theta)$ 衰减。然后，这部分下行辐射被土壤反射（反射率为 $r_V$），并在其向上传播到传感器的途中再次被一个因子 $\\Gamma_V(\\theta)$ 衰减。\n    $$\n    T_4 = \\underbrace{T_{sky} \\Gamma_V(\\theta)}_{\\text{到土壤的透射}} \\times \\underbrace{r_V}_{\\text{反射}} \\times \\underbrace{\\Gamma_V(\\theta)}_{\\text{到传感器的透射}}\n    $$\n    $$\n    T_4 = r_V T_{sky} (\\Gamma_V(\\theta))^2\n    $$\n\n观测到的总亮温是这四个分量的总和：\n$$\nT_{B,V}(\\theta) = T_1 + T_2 + T_3 + T_4\n$$\n$$\nT_{B,V}(\\theta) = e_V T_s \\Gamma_V(\\theta) + (1 - \\omega_V)(1 - \\Gamma_V(\\theta)) T_v + r_V (1 - \\omega_V)(1 - \\Gamma_V(\\theta)) \\Gamma_V(\\theta) T_v + r_V T_{sky} (\\Gamma_V(\\theta))^2\n$$\n代入 $\\Gamma_V(\\theta) = \\exp(-\\frac{\\tau_V}{\\cos\\theta})$ 和 $r_V=1-e_V$ 即可得到完整的解析表达式。\n\n现在，我们对给定参数进行 $T_{B,V}$ 的数值计算：\n- $\\theta = 40^\\circ$\n- $e_V = 0.92$, 所以 $r_V = 1 - 0.92 = 0.08$\n- $T_s = 300\\,\\mathrm{K}$\n- $T_v = 295\\,\\mathrm{K}$\n- $\\tau_V = 0.60$\n- $\\omega_V = 0.05$\n- $T_{sky} = 2.73\\,\\mathrm{K}$\n\n首先，我们计算角度的余弦值和植被透过率 $\\Gamma_V$：\n$$\n\\cos(40^\\circ) \\approx 0.766044\n$$\n$$\n\\frac{\\tau_V}{\\cos\\theta} = \\frac{0.60}{\\cos(40^\\circ)} \\approx 0.783244\n$$\n$$\n\\Gamma_V(40^\\circ) = \\exp(-0.783244) \\approx 0.456910\n$$\n\n接下来，我们计算四个亮温项中每一项的数值：\n1.  $T_1 = e_V T_s \\Gamma_V = 0.92 \\times 300\\,\\mathrm{K} \\times 0.456910 \\approx 126.101\\,\\mathrm{K}$\n2.  $T_2 = (1 - \\omega_V)(1 - \\Gamma_V) T_v = (1 - 0.05)(1 - 0.456910) \\times 295\\,\\mathrm{K} = 0.95 \\times 0.543090 \\times 295\\,\\mathrm{K} \\approx 152.201\\,\\mathrm{K}$\n3.  $T_3 = r_V (1 - \\omega_V)(1 - \\Gamma_V) \\Gamma_V T_v = 0.08 \\times (0.95 \\times 0.543090 \\times 295\\,\\mathrm{K}) \\times 0.456910 \\approx 0.08 \\times 152.201\\,\\mathrm{K} \\times 0.456910 \\approx 5.562\\,\\mathrm{K}$\n4.  $T_4 = r_V T_{sky} \\Gamma_V^2 = 0.08 \\times 2.73\\,\\mathrm{K} \\times (0.456910)^2 \\approx 0.046\\,\\mathrm{K}$\n\n问题要求分离出土壤发射与植被发射的贡献。\n- 来自土壤发射的贡献由 $T_1$ 给出：\n  $$\n  T_{\\text{soil contrib.}} = T_1 \\approx 126.101\\,\\mathrm{K}\n  $$\n- 来自植被发射的贡献包括直接上行发射（$T_2$）和反射的下行发射（$T_3$）：\n  $$\n  T_{\\text{veg contrib.}} = T_2 + T_3 \\approx 152.201\\,\\mathrm{K} + 5.562\\,\\mathrm{K} = 157.763\\,\\mathrm{K}\n  $$\n余下的项 $T_4 \\approx 0.046\\,\\mathrm{K}$ 是反射的天空贡献，在本例中可以忽略不计。\n\n最后，我们将所有贡献相加，求得总亮温：\n$$\nT_{B,V}(40^\\circ) = T_1 + T_2 + T_3 + T_4 \\approx 126.101 + 152.201 + 5.562 + 0.046 = 283.910\\,\\mathrm{K}\n$$\n将最终结果四舍五入到四位有效数字，得到 $283.9\\,\\mathrm{K}$。",
            "answer": "$$\n\\boxed{283.9}\n$$"
        },
        {
            "introduction": "现实世界的反演算法通常必须做出简化假设，而科学家的一项关键任务是量化这些假设引入的误差。本实践聚焦于地表粗糙度，这是一个主要的影响因子，其模型常常不完善或被忽略。通过一个模拟实验，您将量化因错误地假设地表平滑而导致的土壤水分反演偏差，从而为模型保真度和误差分析提供一个关键视角 。",
            "id": "3833642",
            "problem": "在无源微波土壤湿度反演中，一项高级研究生课题是量化反演过程中因忽略地表粗糙度而引入的偏差。您必须实现一个完整、可运行的程序，该程序针对几个测试用例执行以下操作：模拟均方根高度为 $s = 1\\,\\mathrm{cm}$ 的粗糙裸土表面的亮度温度 ($T_B$)，然后在平滑表面假设下反演体积土壤湿度 $\\theta$，最后计算反演误差。您的推导和实现必须从公认的电磁学和辐射传输基本原理出发，不得使用未经推导而引入的简化公式。\n\n使用以下物理上一致的基础作为您的出发点：\n- 微波遥感的 Rayleigh–Jeans 近似，它通过 $T_B = e\\,T_s$ 将亮度温度 ($T_B$) 与表面发射率 $e$ 和热力学温度 $T_s$ 联系起来。\n- 对于无损耗等温半空间的关系 $e = 1 - r$，其中 $r$ 是半球反射率，并且在平面波入射下的空气-土壤界面处，$r$ 由从 Maxwell 边界条件推导出的、与极化相关的 Fresnel 反射系数确定。\n- 土壤有效复介电常数对体积湿度 $\\theta$ 和孔隙度 $\\phi$ 的依赖关系，通过一个基于物理原理合理的折射率混合模型，该模型结合了空气、土壤基质和液态水的介电常数。\n- 针对相干（镜面）反射率分量的、与小扰动理论一致的粗糙度衰减，适用于粗糙度参数 $k\\,s$ 为中等大小的情况，其中 $k$ 是自由空间波数。\n\n您的程序必须使用以下参数化和常数，实现水平极化的正向模拟和反向反演：\n- 频率 $f = 1.41\\,\\mathrm{GHz}$。\n- 光速 $c = 2.99792458\\times 10^8\\,\\mathrm{m/s}$。\n- 孔隙度 $\\phi = 0.50$（无单位，即 $\\mathrm{m}^3/\\mathrm{m}^3$）。\n- 土壤基质相对介电常数 $\\varepsilon_\\text{solid} = 4.7$（无单位）。\n- 空气相对介电常数 $\\varepsilon_\\text{air} = 1.0$（无单位）。\n- 液态水相对介电常数，由温度 $T = 300\\,\\mathrm{K}$ 下的单极点 Debye 弛豫模型描述，其静态介电常数为 $\\varepsilon_s = 80.1$，无限频率介电常数为 $\\varepsilon_\\infty = 4.9$，弛豫时间为 $\\tau = 8.27\\times 10^{-12}\\,\\mathrm{s}$。为简化起见，忽略离子电导率。\n- 粗糙度均方根高度 $s = 1\\,\\mathrm{cm} = 0.01\\,\\mathrm{m}$。\n- 使用水平极化，并根据每个测试用例指定的入射角进行处理。\n\n待实现的正向模型规范：\n- 计算作为 Debye 弛豫模型的水的复相对介电常数。\n- 使用折射率混合模型，计算作为空气、土壤基质和水体积混合物的土壤有效复相对介电常数。\n- 计算水平极化下平滑表面的、与极化相关的 Fresnel 反射系数的模平方 $r_\\text{smooth}$，其是入射角和复介电常数的函数。\n- 对 $r_\\text{smooth}$ 应用小扰动粗糙度衰减以获得 $r_\\text{rough}$。\n- 计算发射率 $e_\\text{rough} = 1 - r_\\text{rough}$ 和 $T_B = e_\\text{rough}\\,T_s$。\n\n待实现的反向反演规范：\n- 假设表面平滑（$s=0$），并使用与正向模拟相同的物理介电常数和混合模型。\n- 给定测量的 $T_B$ 和 $T_s$，在物理上允许的区间 $[0,\\phi]$ 内找到 $\\theta$，使得 $e_\\text{smooth}(\\theta) = T_B/T_s$。\n- 在 $\\theta\\in[0,\\phi]$ 上使用稳健的一维求根方法。如果由于模型不匹配而没有精确根，则返回 $[0,\\phi]$ 内使 $\\lvert e_\\text{smooth}(\\theta) - T_B/T_s\\rvert$ 最小化的 $\\theta$（即，当区间限定失败时，取最接近的端点值）。\n\n计算每个测试用例的反演误差 $\\Delta\\theta = \\theta_\\text{retrieved} - \\theta_\\text{true}$，并以 $\\mathrm{m}^3/\\mathrm{m}^3$ 为单位，用十进制数报告。\n\n测试套件中的角度以度为单位指定；您的实现必须在内部将其转换为弧度。\n\n测试套件：\n- 案例 A：$\\theta_\\text{true} = 0.05\\,\\mathrm{m}^3/\\mathrm{m}^3$，$\\theta$ 单位是体积分数，入射角 $0^\\circ$，地表温度 $T_s = 300\\,\\mathrm{K}$。\n- 案例 B：$\\theta_\\text{true} = 0.20\\,\\mathrm{m}^3/\\mathrm{m}^3$，入射角 $40^\\circ$，$T_s = 300\\,\\mathrm{K}$。\n- 案例 C：$\\theta_\\text{true} = 0.40\\,\\mathrm{m}^3/\\mathrm{m}^3$，入射角 $55^\\circ$，$T_s = 300\\,\\mathrm{K}$。\n- 案例 D（边缘干燥，大角度）：$\\theta_\\text{true} = 0.01\\,\\mathrm{m}^3/\\mathrm{m}^3$，入射角 $60^\\circ$，$T_s = 300\\,\\mathrm{K}$。\n\n输出规范：\n- 对于上述四个案例，您的程序必须生成单行输出，其中包含案例 A–D 的反演误差 $\\Delta\\theta$，按顺序排列，四舍五入到六位小数，以 $\\mathrm{m}^3/\\mathrm{m}^3$ 为单位表示为十进制数，并汇总为方括号内以逗号分隔的列表。例如，输出格式必须为 $\\left[\\mathrm{val}_A,\\mathrm{val}_B,\\mathrm{val}_C,\\mathrm{val}_D\\right]$，无任何附加文本。\n\n您的任务是从所述的物理基础中推导出必要的关系，并以算法方式实现它们，以生成所要求的输出。",
            "solution": "该问题要求量化在忽略地表粗糙度时，体积土壤湿度 $\\theta$ 的反演误差。该过程涉及一个正向模型，用以模拟粗糙土壤表面的水平极化亮度温度 $T_{B,h}$，随后是一个反演模型，它在表面平滑的错误假设下，从模拟的 $T_{B,h}$ 中反演 $\\theta$。误差即为反演得到的湿度 $\\theta_\\text{retrieved}$ 与真实湿度 $\\theta_\\text{true}$ 之间的差值。\n\n解决方案分为三个主要阶段：1) 推导用于模拟测量的正向模型，2) 构建用于执行反演的反演模型，以及 3) 计算指定测试用例的反演误差。\n\n**1. 正向模型：模拟粗糙表面亮度温度**\n\n正向模型从基本物理参数计算 $T_{B,h}$。这基于不透明、等温表面的辐射传输方程的 Rayleigh-Jeans 近似：\n$$ T_{B,p}(\\theta_i, \\theta) = e_p(\\theta_i, \\theta) T_s $$\n其中 $p$ 表示极化（在此问题中为水平极化，$h$），$e_p$ 是入射角为 $\\theta_i$ 时的表面发射率，$\\theta$ 是体积土壤湿度，$T_s$ 是地表物理温度。对于处于局部热力学平衡的表面，Kirchhoff 定律将发射率与反射率 $r_p$ 联系起来：\n$$ e_p(\\theta_i, \\theta) = 1 - r_p(\\theta_i, \\theta) $$\n因此，正向模型的核心是精确计算粗糙表面反射率 $r_{\\text{rough},h}$。\n\n**1.1. 土壤组分的复介电常数**\n\n土壤的电磁特性由其有效复相对介电常数 $\\varepsilon_\\text{eff}$ 决定。该值由其组分——水、土壤固体和空气的特性推导而来。\n\n首先，液态水的复相对介电常数 $\\varepsilon_w$ 使用给定角频率 $\\omega = 2\\pi f$ 下的单极点 Debye 弛豫公式进行建模：\n$$ \\varepsilon_w(\\omega) = \\varepsilon_\\infty + \\frac{\\varepsilon_s - \\varepsilon_\\infty}{1 + i\\omega\\tau} $$\n其中 $f = 1.41 \\times 10^9\\,\\mathrm{Hz}$ 是频率，$\\varepsilon_s = 80.1$ 是静态相对介电常数，$\\varepsilon_\\infty = 4.9$ 是无限频率相对介电常数，$\\tau = 8.27 \\times 10^{-12}\\,\\mathrm{s}$ 是弛豫时间，$i = \\sqrt{-1}$ 是虚数单位。对于给定的问题参数，该值是恒定的。土壤基质和空气的介电常数作为实常数给出：$\\varepsilon_\\text{solid} = 4.7$ 和 $\\varepsilon_\\text{air} = 1.0$。\n\n**1.2. 使用混合模型的有效土壤介电常数**\n\n土壤混合物的有效介电常数 $\\varepsilon_\\text{eff}$ 是体积土壤湿度 $\\theta$ 的函数。我们使用指定的折射率混合模型。一种材料的折射率 $n$ 是其相对介电常数的平方根，即 $n = \\sqrt{\\varepsilon_r}$。该模型表明，土壤的有效折射率 $n_\\text{eff} = \\sqrt{\\varepsilon_\\text{eff}}$ 是其各组分折射率的体积平均值：\n$$ n_\\text{eff}(\\theta) = v_\\text{water} n_\\text{water} + v_\\text{air} n_\\text{air} + v_\\text{solid} n_\\text{solid} $$\n各组分的体积分数分别为 $v_\\text{water} = \\theta$、$v_\\text{solid} = 1 - \\phi$ 和 $v_\\text{air} = \\phi - \\theta$，其中孔隙度 $\\phi = 0.50$。将这些代入混合法则得到：\n$$ \\sqrt{\\varepsilon_\\text{eff}(\\theta)} = \\theta\\sqrt{\\varepsilon_w} + (\\phi - \\theta)\\sqrt{\\varepsilon_\\text{air}} + (1 - \\phi)\\sqrt{\\varepsilon_\\text{solid}} $$\n由此，将结果平方即可求得 $\\varepsilon_\\text{eff}(\\theta)$。\n\n**1.3. 平滑与粗糙表面的反射率**\n\n平滑平面界面的反射率由 Fresnel 方程给出。对于水平极化（H-pol），功率反射率 $r_{\\text{smooth},h}$ 是反射系数 $\\Gamma_h$ 的模平方：\n$$ r_{\\text{smooth},h}(\\theta_i, \\theta) = |\\Gamma_h(\\theta_i, \\theta)|^2 $$\n$$ \\Gamma_h(\\theta_i, \\theta) = \\frac{n_1 \\cos\\theta_i - n_2 \\cos\\theta_t}{n_1 \\cos\\theta_i + n_2 \\cos\\theta_t} $$\n此处，介质 1 是空气（$n_1 = \\sqrt{\\varepsilon_\\text{air}} = 1$），介质 2 是土壤（$n_2 = \\sqrt{\\varepsilon_\\text{eff}(\\theta)}$）。透射角 $\\theta_t$ 通过 Snell 定律与入射角 $\\theta_i$ 相关：$n_1 \\sin\\theta_i = n_2 \\sin\\theta_t$。这使我们能够仅使用 $\\theta_i$ 和介电常数来表示 $\\Gamma_h$：\n$$ \\Gamma_h(\\theta_i, \\theta) = \\frac{\\cos\\theta_i - \\sqrt{\\varepsilon_\\text{eff}(\\theta) - \\sin^2\\theta_i}}{\\cos\\theta_i + \\sqrt{\\varepsilon_\\text{eff}(\\theta) - \\sin^2\\theta_i}} $$\n地表粗糙度会改变反射率。问题指定了对相干（镜面）反射率分量的衰减。一个与此描述一致、常用于小到中等粗糙度的标准模型是：\n$$ r_{\\text{rough},h}(\\theta_i, \\theta) = r_{\\text{smooth},h}(\\theta_i, \\theta) \\exp\\left[-(2 k_0 s \\cos\\theta_i)^2\\right] $$\n其中 $k_0 = 2\\pi f/c$ 是自由空间波数，$s = 0.01\\,\\mathrm{m}$ 是地表粗糙度的均方根高度，$c = 2.99792458 \\times 10^8\\,\\mathrm{m/s}$ 是光速。\n\n**1.4. 最终正向计算**\n\n对于给定的真实土壤湿度 $\\theta_\\text{true}$ 和入射角 $\\theta_i$，模拟的“观测”亮度温度 $T_{B,\\text{obs}}$ 计算如下：\n1.  使用混合模型计算 $\\varepsilon_\\text{eff}(\\theta_\\text{true})$。\n2.  使用 Fresnel 公式计算 $r_{\\text{smooth},h}(\\theta_i, \\theta_\\text{true})$。\n3.  应用粗糙度衰减计算 $r_{\\text{rough},h}(\\theta_i, \\theta_\\text{true})$。\n4.  计算粗糙表面发射率 $e_{\\text{rough},h} = 1 - r_{\\text{rough},h}$。\n5.  计算亮度温度 $T_{B,\\text{obs}} = e_{\\text{rough},h} \\cdot T_s$。\n\n**2. 反演模型：土壤湿度反演**\n\n反演模型在明确假设表面平滑（$s = 0$）的情况下，从 $T_{B,\\text{obs}}$ 中反演土壤湿度 $\\theta_\\text{retrieved}$。这引入了一个系统性的模型不匹配，而这正是我们旨在量化的误差来源。\n\n**2.1. 反演问题公式化**\n\n该反演算法在物理上允许的范围 $[0, \\phi]$ 内寻找一个 $\\theta$ 值，该值满足平滑表面辐射传输方程：\n$$ T_{B,\\text{obs}} = e_{\\text{smooth},h}(\\theta_i, \\theta) T_s $$\n其中 $e_{\\text{smooth},h} = 1 - r_{\\text{smooth},h}$。这等效于求解方程中的 $\\theta$：\n$$ r_{\\text{smooth},h}(\\theta_i, \\theta) = 1 - \\frac{T_{B,\\text{obs}}}{T_s} $$\n令 $r_\\text{target} = 1 - T_{B,\\text{obs}}/T_s$。问题简化为求函数 $F(\\theta)$ 的根：\n$$ F(\\theta) = r_{\\text{smooth},h}(\\theta_i, \\theta) - r_\\text{target} = 0 $$\n\n**2.2. 数值解**\n\n由于函数 $r_{\\text{smooth},h}(\\theta_i, \\theta)$ 随 $\\theta$ 单调增加（因为更高的湿度含量导致更高的介电常数，从而导致更高的反射率），方程 $F(\\theta)=0$ 在区间 $[0, \\phi]$ 内至多有一个解。这种结构非常适合一维数值求根算法，例如二分法或 Brent 方法。\n\n我们将搜索区间定义为 $[a, b] = [0, \\phi]$。如果 $F(a)$ 和 $F(b)$ 符号相反，则保证在该区间内存在一个根。如果它们的符号相同，则意味着目标反射率 $r_\\text{target}$ 位于范围 $[r_{\\text{smooth},h}(\\theta_i, 0), r_{\\text{smooth},h}(\\theta_i, \\phi)]$ 之外。在这种情况下，根据问题陈述，我们选择边界（$0$ 或 $\\phi$）上使绝对残差 $|F(\\theta)|$ 最小的 $\\theta$ 值。这等同于选择其对应反射率更接近 $r_\\text{target}$ 的端点。\n\n**3. 误差计算与算法总结**\n\n对于每个测试用例 $(\\theta_\\text{true}, \\theta_i, T_s)$：\n1.  使用 $\\theta_\\text{true}$ 和 $\\theta_i$ 执行正向模型，生成一个合成观测值 $T_{B,\\text{obs}}$。\n2.  假设表面平滑，使用 $T_{B,\\text{obs}}$ 和 $\\theta_i$ 执行反演模型，以找到 $\\theta_\\text{retrieved}$。\n3.  计算反演误差为 $\\Delta\\theta = \\theta_\\text{retrieved} - \\theta_\\text{true}$。\n\n对每个提供的案例实施此过程，并以指定格式报告所得误差。以度为单位给出的入射角必须转换为弧度，以便在三角函数中使用。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Implements the forward and inverse models for passive microwave soil moisture\n    retrieval to quantify the bias from neglecting surface roughness.\n    \"\"\"\n\n    # --- Problem Constants ---\n    F = 1.41e9  # Frequency in Hz\n    C = 2.99792458e8  # Speed of light in m/s\n    PHI = 0.50  # Porosity (unitless)\n    EPS_SOLID = 4.7  # Soil matrix relative permittivity\n    EPS_AIR = 1.0  # Air relative permittivity\n    # Water permittivity (Debye model parameters)\n    EPS_S = 80.1  # Static permittivity\n    EPS_INF = 4.9  # Infinite-frequency permittivity\n    TAU = 8.27e-12  # Relaxation time in s\n    # Roughness parameter\n    S = 0.01  # RMS height in m\n\n    # --- Pre-calculated Values ---\n    OMEGA = 2 * np.pi * F  # Angular frequency in rad/s\n    K0 = OMEGA / C  # Wavenumber in rad/m\n    # Complex relative permittivity of water (constant for the problem)\n    EPS_W = EPS_INF + (EPS_S - EPS_INF) / (1 + 1j * OMEGA * TAU)\n\n    def get_eff_permittivity(theta: float) -> complex:\n        \"\"\"\n        Calculates the effective complex relative permittivity of soil using\n        a refractive-index mixing model.\n        \n        Args:\n            theta: Volumetric soil moisture (m^3/m^3).\n        \n        Returns:\n            The complex effective permittivity.\n        \"\"\"\n        n_eff = (theta * np.sqrt(EPS_W) +\n                 (PHI - theta) * np.sqrt(EPS_AIR) +\n                 (1 - PHI) * np.sqrt(EPS_SOLID))\n        return n_eff**2\n\n    def get_smooth_reflectivity_h(theta: float, inc_angle_rad: float) -> float:\n        \"\"\"\n        Calculates the smooth-surface Fresnel reflectivity for horizontal polarization.\n        \n        Args:\n            theta: Volumetric soil moisture (m^3/m^3).\n            inc_angle_rad: Incidence angle in radians.\n\n        Returns:\n            The smooth-surface power reflectivity.\n        \"\"\"\n        eps_eff = get_eff_permittivity(theta)\n        cos_theta_i = np.cos(inc_angle_rad)\n        \n        # Using the formulation stable for complex permittivity\n        term_sqrt = np.sqrt(eps_eff - np.sin(inc_angle_rad)**2)\n        \n        gamma_h = (cos_theta_i - term_sqrt) / (cos_theta_i + term_sqrt)\n        return np.abs(gamma_h)**2\n\n    def forward_model(theta_true: float, inc_angle_rad: float, t_s: float) -> float:\n        \"\"\"\n        Simulates the brightness temperature of a rough soil surface.\n\n        Args:\n            theta_true: True volumetric soil moisture.\n            inc_angle_rad: Incidence angle in radians.\n            t_s: Physical surface temperature in Kelvin.\n\n        Returns:\n            The simulated brightness temperature in Kelvin.\n        \"\"\"\n        r_smooth_h = get_smooth_reflectivity_h(theta_true, inc_angle_rad)\n        \n        # Apply roughness model\n        roughness_factor = np.exp(-(2 * K0 * S * np.cos(inc_angle_rad))**2)\n        r_rough_h = r_smooth_h * roughness_factor\n        \n        e_rough_h = 1 - r_rough_h\n        tb = e_rough_h * t_s\n        return tb\n\n    def inverse_model(tb_obs: float, inc_angle_rad: float, t_s: float) -> float:\n        \"\"\"\n        Retrieves soil moisture from brightness temperature assuming a smooth surface.\n\n        Args:\n            tb_obs: Observed brightness temperature in Kelvin.\n            inc_angle_rad: Incidence angle in radians.\n            t_s: Physical surface temperature in Kelvin.\n\n        Returns:\n            The retrieved volumetric soil moisture.\n        \"\"\"\n        e_target = tb_obs / t_s\n        r_target = 1 - e_target\n        \n        def objective_func(theta: float) -> float:\n            return get_smooth_reflectivity_h(theta, inc_angle_rad) - r_target\n\n        # Check boundaries of the search interval [0, PHI]\n        val_at_0 = objective_func(0.0)\n        val_at_phi = objective_func(PHI)\n\n        if np.sign(val_at_0) == np.sign(val_at_phi):\n            # No root in the interval, return the theta at the boundary that\n            # minimizes the residual, per problem spec.\n            if np.abs(val_at_0)  np.abs(val_at_phi):\n                return 0.0\n            else:\n                return PHI\n        \n        # A unique root exists, find it using Brent's method.\n        try:\n            theta_retrieved = brentq(objective_func, 0.0, PHI, xtol=1e-9, rtol=1e-9)\n            return theta_retrieved\n        except ValueError:\n            # This path is defensive and should not be reached due to the sign check above.\n            if np.abs(val_at_0)  np.abs(val_at_phi):\n                return 0.0\n            else:\n                return PHI\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (theta_true, incidence_angle_deg, surface_temp_K)\n        (0.05, 0.0, 300.0),   # Case A\n        (0.20, 40.0, 300.0),  # Case B\n        (0.40, 55.0, 300.0),  # Case C\n        (0.01, 60.0, 300.0),  # Case D\n    ]\n\n    results = []\n    for theta_true, inc_angle_deg, t_s in test_cases:\n        inc_angle_rad = np.deg2rad(inc_angle_deg)\n        \n        # 1. Forward model: Simulate observed Tb from the rough surface\n        tb_obs = forward_model(theta_true, inc_angle_rad, t_s)\n        \n        # 2. Inverse model: Retrieve theta assuming a smooth surface\n        theta_retrieved = inverse_model(tb_obs, inc_angle_rad, t_s)\n        \n        # 3. Calculate retrieval error\n        delta_theta = theta_retrieved - theta_true\n        results.append(delta_theta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从正向建模转向反演，现代反演算法采用概率框架来处理测量和模型参数中的不确定性。最后一个实践介绍了一种贝叶斯反演方法，用于在植被属性也不确定的情景下估算土壤水分。通过对这个“讨厌的参数”进行边缘化，您将推导并实现一种统计上稳健的反演方法，它不仅提供一个估算值，还提供了土壤水分的完整后验概率分布，代表了地球物理反演领域的最新技术 。",
            "id": "3833636",
            "problem": "给定一个单频、天底视角、纯陆地反演场景下的线性化被动微波观测模型，其中观测亮温被建模为体积土壤湿度和植被光学厚度的线性函数，并加上高斯噪声。假设该正向模型在背景态的一个小扰动范围内有效，这与辐射传输的一阶线性化一致，并表示为\n$$\ny = a\\,\\theta + b\\,\\tau + c + \\epsilon,\n$$\n其中，$y$ 是以开尔文为单位的测量亮温，$\\theta$ 是以立方米/立方米为单位的体积土壤湿度，$\\tau$ 是植被光学厚度（无量纲），$a$ 和 $b$ 是线性灵敏度系数（单位为开尔文/相应状态变量单位），$c$ 是以开尔文为单位的恒定偏移量，$\\epsilon$ 是满足 $\\epsilon \\sim \\mathcal{N}(0,\\sigma_\\epsilon^2)$ 的加性噪声，其中 $\\sigma_\\epsilon^2$ 已知。假设状态变量具有独立的高斯先验：\n$$\n\\theta \\sim \\mathcal{N}(\\mu_\\theta,\\sigma_\\theta^2), \\quad \\tau \\sim \\mathcal{N}(\\mu_\\tau,\\sigma_\\tau^2),\n$$\n其中 $\\sigma_\\theta^2$ 和 $\\sigma_\\tau^2$ 已知且为正。所有参数 $a$、$b$、$c$、$\\sigma_\\epsilon^2$、$\\mu_\\theta$、$\\sigma_\\theta^2$、$\\mu_\\tau$ 和 $\\sigma_\\tau^2$ 均已知。\n\n从贝叶斯法则和高斯分布的性质出发，并且不假设任何“捷径”反演公式，执行以下任务：\n\n1. 通过对其先验进行积分，积分掉讨厌参数 $\\tau$，从而推导出边缘似然 $p(y \\mid \\theta)$。清晰地说明所得分布的分布族、均值和方差，并用 $a$、$b$、$c$、$\\sigma_\\epsilon^2$、$\\mu_\\tau$ 和 $\\sigma_\\tau^2$ 表示。\n\n2. 使用边缘似然 $p(y \\mid \\theta)$ 和先验 $p(\\theta)$，推导出后验分布 $p(\\theta \\mid y)$，确定其分布族，并以闭合形式表示其均值和方差。\n\n3. 实现一个程序，对于给定的参数集，根据推导出的高斯假设计算 $\\theta$ 的后验均值。后验均值应作为实数返回。数值答案代表体积土壤湿度，必须表示为无量纲的体积分数（单位为 $\\mathrm{m^3/m^3}$），并四舍五入到六位小数。\n\n使用以下参数集测试套件来验证您的程序。每个测试用例提供了在指定单位下的 $(y, a, b, c, \\sigma_\\epsilon, \\mu_\\theta, \\sigma_\\theta, \\mu_\\tau, \\sigma_\\tau)$ 的值：\n- 测试用例1（一般情况）：\n  - $y = 270.0$ K, $a = -20.0$ K / $\\mathrm{m^3/m^3}$, $b = -5.0$ K / 单位 $\\tau$, $c = 280.0$ K,\n  - $\\sigma_\\epsilon = 2.0$ K, $\\mu_\\theta = 0.2$ $\\mathrm{m^3/m^3}$, $\\sigma_\\theta = 0.05$ $\\mathrm{m^3/m^3}$,\n  - $\\mu_\\tau = 0.3$ (无量纲), $\\sigma_\\tau = 0.1$ (无量纲)。\n- 测试用例2（信息量大的植被先验）：\n  - $y = 270.0$ K, $a = -20.0$, $b = -5.0$, $c = 280.0$,\n  - $\\sigma_\\epsilon = 2.0$, $\\mu_\\theta = 0.2$, $\\sigma_\\theta = 0.05$,\n  - $\\mu_\\tau = 0.3$, $\\sigma_\\tau = 0.01$。\n- 测试用例3（不确定性高的植被先验）：\n  - $y = 270.0$ K, $a = -20.0$, $b = -5.0$, $c = 280.0$,\n  - $\\sigma_\\epsilon = 2.0$, $\\mu_\\theta = 0.2$, $\\sigma_\\theta = 0.05$,\n  - $\\mu_\\tau = 0.3$, $\\sigma_\\tau = 0.5$。\n- 测试用例4（正向模型中无植被效应）：\n  - $y = 270.0$ K, $a = -20.0$, $b = 0.0$, $c = 280.0$,\n  - $\\sigma_\\epsilon = 2.0$, $\\mu_\\theta = 0.2$, $\\sigma_\\theta = 0.05$,\n  - $\\mu_\\tau = 0.3$, $\\sigma_\\tau = 0.1$。\n- 测试用例5（仪器噪声极低）：\n  - $y = 270.0$ K, $a = -20.0$, $b = -5.0$, $c = 280.0$,\n  - $\\sigma_\\epsilon = 0.1$, $\\mu_\\theta = 0.2$, $\\sigma_\\theta = 0.05$,\n  - $\\mu_\\tau = 0.3$, $\\sigma_\\tau = 0.1$。\n\n您的程序应生成单行输出，其中包含上述测试用例的 $\\theta$ 的后验均值，形式为用方括号括起来的逗号分隔列表，每个值都四舍五入到六位小数，例如：\n\"[0.242857,0.245000,0.220000,0.260000,0.378000]\".",
            "solution": "在尝试给出解决方案之前，对问题进行验证。\n\n### 步骤1：提取给定条件\n问题提供了以下模型和假设：\n-   **正向模型**：测量亮温 $y$ 是体积土壤湿度 $\\theta$ 和植被光学厚度 $\\tau$ 的线性函数。方程为 $y = a\\,\\theta + b\\,\\tau + c + \\epsilon$。\n-   **状态变量**：\n    -   $\\theta$：体积土壤湿度 ($\\mathrm{m^3/m^3}$)。\n    -   $\\tau$：植被光学厚度（无量纲）。\n-   **模型参数**：\n    -   $a$：$y$ 对 $\\theta$ 的灵敏度系数 (K / $\\mathrm{m^3/m^3}$)。\n    -   $b$：$y$ 对 $\\tau$ 的灵敏度系数 (K / 单位 $\\tau$)。\n    -   $c$：恒定偏移量 (K)。\n-   **噪声分布**：加性噪声 $\\epsilon$ 是一个高斯随机变量，其均值为零，方差 $\\sigma_\\epsilon^2$ 已知：$\\epsilon \\sim \\mathcal{N}(0, \\sigma_\\epsilon^2)$。\n-   **先验分布**：假设状态变量 $\\theta$ 和 $\\tau$ 相互独立，并遵循均值和方差已知的高斯分布：\n    -   $\\theta \\sim \\mathcal{N}(\\mu_\\theta, \\sigma_\\theta^2)$\n    -   $\\tau \\sim \\mathcal{N}(\\mu_\\tau, \\sigma_\\tau^2)$\n-   **已知量**：所有参数（$a$、$b$、$c$、$\\sigma_\\epsilon^2$、$\\mu_\\theta$、$\\sigma_\\theta^2$、$\\mu_\\tau$、$\\sigma_\\tau^2$）均为已知常数。\n\n### 步骤2：使用提取的给定条件进行验证\n对问题的有效性进行评估：\n-   **科学依据**：该模型是辐射传输方程的线性化版本，这是被动微波遥感中处理小扰动反演问题的标准有效方法。使用带有高斯先验的贝叶斯推断是现代数据同化和地球物理反演的基石。该问题在科学上是合理的。\n-   **适定性**：该问题在数学上是适定的。所有必要的参数和概率分布都已定义，从而可以得到唯一的闭合形式解。对所有随机分量使用高斯分布确保了所需积分是可解的，并且后验分布也是高斯分布。\n-   **客观性**：问题陈述使用精确、客观且无歧义的科学语言编写。\n-   **完整性与一致性**：设置是完整且自洽的。推导所需的信息没有缺失，所给假设中也没有矛盾。\n-   **真实性**：该场景虽然是对现实的简化，但代表了环境遥感中一个常见且基本的问题。测试用例中的参数值在物理上是合理的。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、有理有据的解决方案。\n\n### 解题推导\n\n解决方案需要两部分的推导，然后是实现。首先，我们推导边缘似然 $p(y \\mid \\theta)$。其次，我们使用这个似然和 $\\theta$ 的先验来推导后验分布 $p(\\theta \\mid y)$。\n\n#### 1. 边缘似然 $p(y \\mid \\theta)$ 的推导\n\n目标是通过积分掉讨厌参数 $\\tau$ 的影响，来求出在给定土壤湿度 $\\theta$ 的条件下观测值 $y$ 的概率分布。边缘似然定义为：\n$$\np(y \\mid \\theta) = \\int_{-\\infty}^{\\infty} p(y, \\tau \\mid \\theta) \\,d\\tau\n$$\n根据条件概率的定义，$p(y, \\tau \\mid \\theta) = p(y \\mid \\theta, \\tau) p(\\tau \\mid \\theta)$。由于 $\\theta$ 和 $\\tau$ 的先验是独立的，所以 $p(\\tau \\mid \\theta) = p(\\tau)$。表达式变为：\n$$\np(y \\mid \\theta) = \\int_{-\\infty}^{\\infty} p(y \\mid \\theta, \\tau) p(\\tau) \\,d\\tau\n$$\n这个积分代表了与观测值和讨厌参数相关的分布的卷积。我们可以通过考察随机变量来更直接地解决这个问题。\n\n给定 $\\theta$，正向模型可以重排为：\n$$\ny - (a\\,\\theta + c) = b\\,\\tau + \\epsilon\n$$\n等式右边是两个独立高斯随机变量的和：\n-   项 $b\\,\\tau$ 是一个经过缩放的高斯变量。由于 $\\tau \\sim \\mathcal{N}(\\mu_\\tau, \\sigma_\\tau^2)$，那么 $b\\,\\tau \\sim \\mathcal{N}(b\\,\\mu_\\tau, b^2\\,\\sigma_\\tau^2)$。\n-   噪声项是 $\\epsilon \\sim \\mathcal{N}(0, \\sigma_\\epsilon^2)$。\n\n两个独立高斯随机变量的和也是一个高斯随机变量。设 $Z = b\\,\\tau + \\epsilon$。$Z$ 的均值和方差是：\n$$\nE[Z] = E[b\\,\\tau] + E[\\epsilon] = b\\,\\mu_\\tau + 0 = b\\,\\mu_\\tau\n$$\n$$\n\\mathrm{Var}(Z) = \\mathrm{Var}(b\\,\\tau) + \\mathrm{Var}(\\epsilon) = b^2\\,\\sigma_\\tau^2 + \\sigma_\\epsilon^2\n$$\n因此，$Z \\sim \\mathcal{N}(b\\,\\mu_\\tau, b^2\\,\\sigma_\\tau^2 + \\sigma_\\epsilon^2)$。\n\n在给定 $\\theta$ 的特定值条件下，观测值 $y$ 只是 $Z$ 的一个平移版本：\n$$\ny = (a\\,\\theta + c) + Z\n$$\n因此，在给定 $\\theta$ 条件下 $y$ 的分布也是高斯的。其均值为：\n$$\nE[y \\mid \\theta] = a\\,\\theta + c + E[Z] = a\\,\\theta + c + b\\,\\mu_\\tau\n$$\n其方差为：\n$$\n\\mathrm{Var}(y \\mid \\theta) = \\mathrm{Var}(Z) = b^2\\,\\sigma_\\tau^2 + \\sigma_\\epsilon^2\n$$\n因此，边缘似然是一个高斯分布：\n$$\np(y \\mid \\theta) \\sim \\mathcal{N}\\left( a\\,\\theta + b\\,\\mu_\\tau + c, \\ b^2\\sigma_\\tau^2 + \\sigma_\\epsilon^2 \\right)\n$$\n\n#### 2. 后验分布 $p(\\theta \\mid y)$ 的推导\n\n根据贝叶斯法则，给定观测值 $y$ 的条件下 $\\theta$ 的后验分布正比于似然与先验的乘积：\n$$\np(\\theta \\mid y) \\propto p(y \\mid \\theta) p(\\theta)\n$$\n我们已经确定右侧的两个分布都是高斯分布：\n-   **似然**：$p(y \\mid \\theta) \\sim \\mathcal{N}(\\mu_L, \\sigma_L^2)$，其中 $\\mu_L = a\\,\\theta + b\\,\\mu_\\tau + c$ 且 $\\sigma_L^2 = b^2\\sigma_\\tau^2 + \\sigma_\\epsilon^2$。\n-   **先验**：$p(\\theta) \\sim \\mathcal{N}(\\mu_\\theta, \\sigma_\\theta^2)$。\n\n两个高斯概率密度函数的乘积正比于另一个高斯分布。我们可以通过分析乘积的指数项来找到后验高斯分布 $p(\\theta \\mid y) \\sim \\mathcal{N}(\\mu_{post}, \\sigma_{post}^2)$ 的参数。一个通用高斯分布的概率密度函数 $p(x) \\propto \\exp\\left(-\\frac{1}{2} \\frac{(x-\\mu)^2}{\\sigma^2}\\right)$。指数项是 $x$ 的二次式。我们合并似然和先验的指数项：\n$$\n\\ln[p(\\theta \\mid y)] = -\\frac{1}{2} \\left[ \\frac{(y - (a\\,\\theta + b\\,\\mu_\\tau + c))^2}{b^2\\sigma_\\tau^2 + \\sigma_\\epsilon^2} + \\frac{(\\theta - \\mu_\\theta)^2}{\\sigma_\\theta^2} \\right] + \\text{const}\n$$\n让我们定义有效似然方差为 $\\sigma_{y,eff}^2 = b^2\\sigma_\\tau^2 + \\sigma_\\epsilon^2$。方括号中的表达式是：\n$$\n\\frac{( (y - b\\,\\mu_\\tau - c) - a\\,\\theta)^2}{\\sigma_{y,eff}^2} + \\frac{(\\theta - \\mu_\\theta)^2}{\\sigma_\\theta^2}\n$$\n我们需要对 $\\theta$ 进行配方。涉及 $\\theta^2$ 和 $\\theta$ 的项将定义后验方差和均值。$\\theta^2$ 的系数是：\n$$\n\\frac{a^2}{\\sigma_{y,eff}^2} + \\frac{1}{\\sigma_\\theta^2}\n$$\n这个量是后验方差的倒数（后验精度）：\n$$\n\\frac{1}{\\sigma_{post}^2} = \\frac{a^2}{\\sigma_{y,eff}^2} + \\frac{1}{\\sigma_\\theta^2} \\implies \\sigma_{post}^2 = \\left(\\frac{a^2}{b^2\\sigma_\\tau^2 + \\sigma_\\epsilon^2} + \\frac{1}{\\sigma_\\theta^2}\\right)^{-1}\n$$\n二次式展开后 $-2\\theta$ 的系数是：\n$$\n\\frac{a(y - b\\,\\mu_\\tau - c)}{\\sigma_{y,eff}^2} + \\frac{\\mu_\\theta}{\\sigma_\\theta^2}\n$$\n此项等于 $\\mu_{post}/\\sigma_{post}^2$。因此，后验均值 $\\mu_{post}$ 是：\n$$\n\\mu_{post} = \\sigma_{post}^2 \\left( \\frac{a(y - b\\,\\mu_\\tau - c)}{\\sigma_{y,eff}^2} + \\frac{\\mu_\\theta}{\\sigma_\\theta^2} \\right)\n$$\n这个方程为 $\\theta$ 的后验均值提供了闭合形式解。它代表了来自测量和先验的信息的精度加权平均。\n\n#### 3. 实现计划\n将实现推导出的后验均值公式 $\\mu_{post}$。步骤如下：\n1.  对于每个测试用例，接收参数 $(y, a, b, c, \\sigma_\\epsilon, \\mu_\\theta, \\sigma_\\theta, \\mu_\\tau, \\sigma_\\tau)$。\n2.  计算所需的方差：$\\sigma_\\epsilon^2$, $\\sigma_\\theta^2$ 和 $\\sigma_\\tau^2$。\n3.  计算边缘似然的有效方差：$\\sigma_{y,eff}^2 = b^2\\sigma_\\tau^2 + \\sigma_\\epsilon^2$。\n4.  计算后验方差：$\\sigma_{post}^2 = \\left(\\frac{a^2}{\\sigma_{y,eff}^2} + \\frac{1}{\\sigma_\\theta^2}\\right)^{-1}$。\n5.  计算后验均值：$\\mu_{post} = \\sigma_{post}^2 \\left( \\frac{a(y - b\\mu_\\tau - c)}{\\sigma_{y,eff}^2} + \\frac{\\mu_\\theta}{\\sigma_\\theta^2} \\right)$。\n6.  将每个案例的最终结果四舍五入到六位小数。\n此过程将使用 Python 编码，并遵循指定的执行环境和输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the posterior mean of soil moisture for a linearized\n    passive microwave observation model.\n    \"\"\"\n\n    # Test cases provide values for:\n    # (y, a, b, c, sigma_epsilon, mu_theta, sigma_theta, mu_tau, sigma_tau)\n    test_cases = [\n        # Test case 1 (general case)\n        (270.0, -20.0, -5.0, 280.0, 2.0, 0.2, 0.05, 0.3, 0.1),\n        # Test case 2 (highly informative vegetation prior)\n        (270.0, -20.0, -5.0, 280.0, 2.0, 0.2, 0.05, 0.3, 0.01),\n        # Test case 3 (highly uncertain vegetation prior)\n        (270.0, -20.0, -5.0, 280.0, 2.0, 0.2, 0.05, 0.3, 0.5),\n        # Test case 4 (no vegetation effect in the forward model)\n        (270.0, -20.0, 0.0, 280.0, 2.0, 0.2, 0.05, 0.3, 0.1),\n        # Test case 5 (very low instrument noise)\n        (270.0, -20.0, -5.0, 280.0, 0.1, 0.2, 0.05, 0.3, 0.1),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        y, a, b, c, sigma_epsilon, mu_theta, sigma_theta, mu_tau, sigma_tau = case\n\n        # Convert standard deviations to variances\n        sigma_epsilon_sq = sigma_epsilon**2\n        sigma_theta_sq = sigma_theta**2\n        sigma_tau_sq = sigma_tau**2\n        \n        # 1. Calculate the effective variance of the marginalized likelihood p(y|theta)\n        # Var(y|theta) = b^2 * sigma_tau^2 + sigma_epsilon^2\n        sigma_y_eff_sq = b**2 * sigma_tau_sq + sigma_epsilon_sq\n        \n        # 2. Calculate the posterior variance of theta, sigma_post^2\n        # 1/sigma_post^2 = a^2 / sigma_y_eff^2 + 1 / sigma_theta^2\n        if sigma_y_eff_sq == 0:\n            # This case would imply perfect observation, which is not expected here.\n            # The precision would be infinite.\n            # Handle to avoid division by zero, although not triggered by test cases.\n            if a == 0:\n                post_precision = 1.0 / sigma_theta_sq\n            else:\n                post_precision = float('inf') # Theoretically\n        else:\n            post_precision = (a**2 / sigma_y_eff_sq) + (1.0 / sigma_theta_sq)\n        \n        if post_precision == 0:\n            # Pure prior-driven case (no information from likelihood)\n            sigma_post_sq = sigma_theta_sq\n        else:\n            sigma_post_sq = 1.0 / post_precision\n            \n        # 3. Calculate the posterior mean of theta, mu_post\n        # mu_post = sigma_post^2 * (a*(y - b*mu_tau - c)/sigma_y_eff^2 + mu_theta/sigma_theta^2)\n        if sigma_y_eff_sq == 0:\n            # Likelihood is a delta function. The posterior is a delta at the MLE.\n            # Not physically realistic for this problem but handled for completeness.\n            if a != 0:\n                mu_post = (y - b * mu_tau - c) / a\n            else: # a==0 and sigma_y_eff_sq==0, ill-posed.\n                mu_post = mu_theta\n        else:\n            term1 = (a * (y - b * mu_tau - c)) / sigma_y_eff_sq\n            term2 = mu_theta / sigma_theta_sq\n            mu_post = sigma_post_sq * (term1 + term2)\n            \n        # Round to six decimal places as required\n        results.append(round(mu_post, 6))\n\n    # Format the final output string\n    formatted_results = f\"[{','.join(map(str, results))}]\"\n    \n    # Print the final result in the exact required format\n    print(formatted_results)\n\nsolve()\n```"
        }
    ]
}