{
    "hands_on_practices": [
        {
            "introduction": "在地理空间分析中，“高度”并非一个单一的概念。本练习将引导你区分并转换两种基本的高度系统：由GNSS（全球导航卫星系统）直接测量的椭球高 $h$，以及与重力场和平均海平面相关的正高 $H$。掌握这种转换对于任何涉及水流（如洪水模拟）的物理模型都至关重要，因为水是在重力势能面（由大地水准面近似）上流动的，而非纯粹的几何椭球面上 。",
            "id": "3816651",
            "problem": "国家级水文数字孪生（DT）集成了源自全球导航卫星系统（GNSS）测量、参考于WGS84椭球体的激光雷达（LiDAR）高程数据，并且必须将其转换为参考于大地水准面的正高，以用于洪水建模。考虑沿海洪泛区中的一个点，其大地高为 $h=100.0$，由2008年地球引力场模型（EGM2008）提供的当地大地水准面起伏为 $N=-28.5$。仅使用以下核心大地测量学定义：(i) 大地高是点在参考椭球体之上的高度，(ii) 正高是点在大地水准面之上的高度，以及 (iii) 大地水准面起伏是点处大地水准面与椭球体之间的带符号间距（当大地水准面在椭球体之上时为正），推导与这些定义一致的 $h$、$H$ 和 $N$ 之间的关系，并计算该点的正高 $H$。用两句话总结，在处理 $10^{9}$ 个点的高性能计算（HPC）环境中的地理空间大数据管道中，为何转换为正高对洪水淹没建模至关重要。以米为单位表示最终的正高，并将您的数值答案四舍五入到四位有效数字。",
            "solution": "在尝试求解之前，对问题陈述的有效性进行评估。\n\n**步骤1：提取已知条件**\n- 大地高：$h = 100.0$\n- 当地大地水准面起伏：$N = -28.5$\n- 定义 (i)：大地高 ($h$) 是点在参考椭球体之上的高度。\n- 定义 (ii)：正高 ($H$) 是点在大地水准面之上的高度。\n- 定义 (iii)：大地水准面起伏 ($N$) 是点处大地水准面与椭球体之间的带符号间距（当大地水准面在椭球体之上时为正）。\n- 任务：推导 $h$、$H$ 和 $N$ 之间的关系。\n- 任务：计算正高 $H$。\n- 任务：用两句话总结在特定情境下转换为正高对洪水淹没建模的重要性。\n- 任务：将最终数值答案表示为四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法恰当且客观。它基于大地测量学的基本原理，这些原理定义了大地高（来自GNSS）、正高（与平均海平面相关）和大地水准面之间的关系。所提供的定义是标准且正确的。给定的 $h$ 和 $N$ 值在物理上是现实的。问题是自洽的，提供了推导公式和计算结果所需的所有必要信息。不存在矛盾、歧义或事实不准确之处。\n\n**步骤3：结论与行动**\n问题有效。将提供解答。\n\n该问题要求推导大地高（$h$）、正高（$H$）和大地水准面起伏（$N$）之间的关系，然后进行计算并简要解释其相关性。我们将使用所提供的定义来建立这种关系。\n\n让我们将地球表面上的一个点表示为 $P$。\n设参考椭球体为一个数学旋转曲面，$S_{E}$。\n设大地水准面为地球引力场的一个等势面，它近似于平均海平面，记为 $S_{G}$。\n\n根据定义 (i)，大地高 $h$ 是从 $S_{E}$ 到 $P$ 的距离，沿椭球体的法线测量。\n根据定义 (ii)，正高 $H$ 是从 $S_{G}$ 到 $P$ 的距离，沿铅垂线测量。\n根据定义 (iii)，大地水准面起伏 $N$ 是从 $S_{E}$ 到 $S_{G}$ 的距离。符号约定至关重要：如果 $S_{G}$ 在 $S_{E}$ 之上，则 $N$ 为正；如果 $S_{G}$ 在 $S_{E}$ 之下，则 $N$ 为负。\n\n在此情境下，为实际应用目的，椭球体法线和铅垂线可被视为共线。点 $P$ 在椭球体之上的高度 $h$ 可以在几何上分解为沿此线的两段：大地水准面 $S_{G}$ 在椭球体 $S_{E}$ 之上的高度（即 $N$），以及点 $P$ 在大地水准面 $S_{G}$ 之上的高度（即 $H$）。\n\n因此，总高度 $h$ 是 $H$ 和 $N$ 的和。这给出了基本的大地测量关系式：\n$$h = H + N$$\n\n要计算正高 $H$，我们重排这个方程：\n$$H = h - N$$\n\n现在，我们将给定的值代入此方程。\n大地高为 $h = 100.0$ 米。\n大地水准面起伏为 $N = -28.5$ 米。\n\n$N$ 的负号表示，在此特定位置，大地水准面位于WGS84椭球体表面以下 $28.5$ 米。\n\n代入数值：\n$$H = 100.0 - (-28.5)$$\n$$H = 100.0 + 28.5$$\n$$H = 128.5$$\n\n得到的正高为 $H = 128.5$ 米。问题要求答案四舍五入到四位有效数字。计算值 $128.5$ 已经恰好是四位有效数字。\n\n最后，问题要求总结为何在大规模数据处理情境下，这种转换为洪水建模非常重要。\n转换为正高至关重要，因为水流受重力控制，这意味着它遵循大地水准面（一个近似于平均海平面的等势面）的轮廓，而不是几何定义的椭球体。在处理 $10^{9}$ 个点的大数据情境中，在高性能计算（HPC）管道内自动化此大地测量校正，可确保海量LiDAR数据集一致地参考到这个具有物理意义的高程基准，这对于数字孪生中的精确大规模洪水淹没模拟至关重要。",
            "answer": "$$\\boxed{128.5}$$"
        },
        {
            "introduction": "将地球的三维表面呈现在二维地图上，必然会引入变形，这是地图投影的核心挑战。本练习将聚焦于广泛使用的网络墨卡托（Web Mercator）投影，通过亲手计算其在高纬度地区的面积变形，你将深刻理解为何在进行面积相关的定量分析时，必须对投影变形进行校正 。",
            "id": "3816672",
            "problem": "一个全国性的流域环境数字孪生系统是部署在一个地理空间大数据管道上的，该管道以Web墨卡托投影（由欧洲石油调查组织 (EPSG) 代码 $3857$ 标识）存储栅格瓦片。为了大规模计算流域统计数据，该管道目前使用来自瓦片像素计数的平面面积。为了校正这些统计数据，您需要量化高纬度地区小地物的局部面积夸大程度。\n\n假设地球是一个半径为 $R$ 的球体，标准地理坐标为 $(\\phi,\\lambda)$，其中 $\\phi$ 是大地纬度，$\\lambda$ 是经度。球面度量为\n$$\n\\mathrm{d}s^{2} = R^{2}\\left(\\mathrm{d}\\phi^{2} + \\cos^{2}\\!\\phi\\,\\mathrm{d}\\lambda^{2}\\right),\n$$\nWeb墨卡托（球面墨卡托）正向地图投影为\n$$\nx = R\\,\\lambda, \\qquad y = R\\,\\ln\\!\\tan\\!\\left(\\frac{\\pi}{4} + \\frac{\\phi}{2}\\right).\n$$\n微积分中使用的所有角度均以弧度为单位。\n\n仅使用这些定义以及局部线性比例尺（定义为在给定方向上投影的微分距离与真实微分距离之比）的概念，首先确定Web墨卡토在纬度 $\\phi$ 处的通用局部线性比例因子 $k(\\phi)$（注意该投影是正形的），然后推导出局部面积比例因子 $a(\\phi)$ 作为正交线性比例的乘积。最后，计算在纬度 $\\phi = 60^\\circ$（相当于 $\\phi = \\pi/3$ 弧度）处的局部面积比例因子，并将其报告为一个无单位的纯数。无需四舍五入。在您的推理中，简要解释如果未经校正地使用来自 EPSG:$3857$ 的平面面积，这对数字孪生中高纬度小地物的面积测量意味着什么。",
            "solution": "我们从球面度量和Web墨卡托正向地图投影开始。球面上沿子午线方向运动（保持 $\\lambda$ 不变，$\\mathrm{d}\\lambda=0$）的地面微分弧长为\n$$\n\\mathrm{d}s_{\\text{merid}} = R\\,|\\mathrm{d}\\phi|\n$$.\n对于沿纬线的东西向运动（保持 $\\phi$ 不变，$\\mathrm{d}\\phi=0$），地面微分弧长为\n$$\n\\mathrm{d}s_{\\text{parallel}} = R\\,\\cos\\!\\phi\\,|\\mathrm{d}\\lambda|\n$$.\n\n在投影平面上，正向地图投影的微分为\n$$\n\\mathrm{d}x = R\\,\\mathrm{d}\\lambda, \\qquad \\mathrm{d}y = R\\,\\frac{\\mathrm{d}}{\\mathrm{d}\\phi}\\left[\\ln\\!\\tan\\!\\left(\\frac{\\pi}{4} + \\frac{\\phi}{2}\\right)\\right]\\mathrm{d}\\phi\n$$.\n为了计算该导数，使用恒等式\n$$\n\\tan\\!\\left(\\frac{\\pi}{4} + \\frac{\\phi}{2}\\right) = \\frac{1+\\sin\\!\\phi}{\\cos\\!\\phi},\n$$\n于是\n$$\n\\ln\\!\\tan\\!\\left(\\frac{\\pi}{4} + \\frac{\\phi}{2}\\right) = \\ln\\!\\big(1+\\sin\\!\\phi\\big) - \\ln\\!\\big(\\cos\\!\\phi\\big).\n$$\n对 $\\phi$ 求导（角度以弧度为单位），\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\phi}\\left[\\ln\\!\\big(1+\\sin\\!\\phi\\big) - \\ln\\!\\big(\\cos\\!\\phi\\big)\\right] = \\frac{\\cos\\!\\phi}{1+\\sin\\!\\phi} + \\tan\\!\\phi\n$$.\n将右侧通分以简化：\n$$\n\\frac{\\cos\\!\\phi}{1+\\sin\\!\\phi} + \\frac{\\sin\\!\\phi}{\\cos\\!\\phi} = \\frac{\\cos^{2}\\!\\phi + \\sin\\!\\phi\\,(1+\\sin\\!\\phi)}{\\cos\\!\\phi\\,(1+\\sin\\!\\phi)} = \\frac{\\cos^{2}\\!\\phi + \\sin\\!\\phi + \\sin^{2}\\!\\phi}{\\cos\\!\\phi\\,(1+\\sin\\!\\phi)} = \\frac{1+\\sin\\!\\phi}{\\cos\\!\\phi\\,(1+\\sin\\!\\phi)} = \\frac{1}{\\cos\\!\\phi}.\n$$\n因此，\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\phi}\\left[\\ln\\!\\tan\\!\\left(\\frac{\\pi}{4} + \\frac{\\phi}{2}\\right)\\right] = \\sec\\!\\phi,\n$$\n从而\n$$\n\\mathrm{d}y = R\\,\\sec\\!\\phi\\,\\mathrm{d}\\phi\n$$.\n\n现在计算局部线性比例因子，即投影微分与真实微分在正交方向上的比值。\n\n对于子午线方向，\n$$\nk_{\\text{merid}}(\\phi) = \\frac{|\\mathrm{d}y|}{\\mathrm{d}s_{\\text{merid}}} = \\frac{R\\,\\sec\\!\\phi\\,|\\mathrm{d}\\phi|}{R\\,|\\mathrm{d}\\phi|} = \\sec\\!\\phi\n$$.\n\n对于纬线（东西）方向，\n$$\nk_{\\text{parallel}}(\\phi) = \\frac{|\\mathrm{d}x|}{\\mathrm{d}s_{\\text{parallel}}} = \\frac{R\\,|\\mathrm{d}\\lambda|}{R\\,\\cos\\!\\phi\\,|\\mathrm{d}\\lambda|} = \\sec\\!\\phi\n$$.\n\n因为墨卡托投影是正形的，局部线性比例是各向同性的，所以通用的局部线性比例因子是\n$$\nk(\\phi) = \\sec\\!\\phi\n$$.\n\n局部面积比例因子 $a(\\phi)$ 是正交线性比例的乘积，\n$$\na(\\phi) = k_{\\text{merid}}(\\phi)\\,k_{\\text{parallel}}(\\phi) = \\big(\\sec\\!\\phi\\big)^{2} = \\sec^{2}\\!\\phi\n$$.\n\n在纬度 $\\phi = 60^\\circ = \\pi/3$ 弧度处进行计算。使用 $\\cos\\!\\left(\\pi/3\\right) = \\frac{1}{2}$，\n$$\n\\sec\\!\\left(\\frac{\\pi}{3}\\right) = 2 \\quad \\Longrightarrow \\quad a\\!\\left(\\frac{\\pi}{3}\\right) = \\big(2\\big)^{2} = 4\n$$.\n\n在数字孪生背景下的解释：对于中心位于纬度 $\\phi=60^\\circ$ 的小地物，在 EPSG:$3857$ 瓦片中直接测量的平面面积相对于球体上的真实表面积被放大了4倍。因此，在 $\\phi=60^\\circ$ 附近，未经校正的、基于面积的高纬度流域统计数据将存在4倍的高估偏差。在大规模应用中，地理空间大数据管道应该对像素面积应用 $1/a(\\phi) = \\cos^{2}\\!\\phi$ 的权重，或者在等面积投影中进行计算，以获得无偏的面积估算。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "卫星影像中的单个像素很少代表一种纯净的地表物质，它通常是多种地物（如植被、土壤、水体）的混合体。本练习将带你探究“混合像元”这一遥感中的基本问题，并应用线性混合模型来量化像元观测值是如何由其内部不同组分的反射率和面积比例共同决定的。理解这一点是进行精确地表分类和参数反演的基础 。",
            "id": "3816648",
            "problem": "一台高分辨率多光谱卫星传感器，在一个由分布式集群处理的洲际尺度地理空间数据立方体内运行，该传感器接收经过辐射定标和大气校正的影像，以维护一个地表数字孪生。每个面积为 $A$ 的传感器像元都在晴空条件下于天底方向进行观测，且邻近效应可忽略不计。像元内的光照在空间上是均匀的，冠层顶的直接辐照度 $E$ 在整个像元上为常数。在此光谱波段内，植被和土壤的双向反射分布函数（BRDF）均被近似为朗伯体，并且像元辐亮度是地表辐亮度的面积平均值。\n\n考虑一个位于植被覆盖的半干旱地区的单个像元，通过在同一可扩展计算平台上的独立亚像元制图得知，该像元中植被的面积覆盖度为 $f_{v}=0.6$，裸土的面积覆盖度为 $f_{s}=0.4$（且 $f_{v}+f_{s}=1$）。植被端元的光谱平均反射率为 $\\rho_{v}=0.5$，土壤端元的光谱平均反射率为 $\\rho_{s}=0.2$。在朗伯近似下，这两个量均为无量纲的双向反射因子。\n\n从朗伯体表面的辐亮度辐射度学定义出发，其中，在辐照度为 $E$ 的条件下，反射率为 $\\rho$ 的表面在传感器处产生的辐亮度 $L$ 满足关系式 $L=\\frac{E\\,\\rho}{\\pi}$，并且像元平均辐亮度是像元上逐点辐亮度 $L(\\mathbf{x})$ 的面积平均值。请推导出在相同光照条件下，能够再现该像元平均辐亮度的观测像元反射率 $\\rho_{\\text{obs}}$。然后，使用给定的覆盖度分数和端元反射率，在所述假设所蕴含的线性混合模型下，计算 $\\rho_{\\text{obs}}$ 的数值。将最终反射率表示为无量纲的小数（不带百分号）。如果需要四舍五入，请至少保留三位有效数字。",
            "solution": "在尝试解答之前，将首先对问题进行严格的验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n问题描述中提供的明确数据和定义如下：\n- 像元面积：$A$\n- 观测几何：天底视角\n- 大气条件：晴空\n- 空间效应：邻近效应可忽略不计\n- 光照：均匀的冠层顶直接辐照度 $E$\n- 地表属性：所有地表组分的双向反射分布函数（BRDF）均近似为朗伯体。\n- 像元级辐亮度定义：像元辐亮度是像元内地表辐亮度的面积平均值。\n- 植被面积覆盖度：$f_{v} = 0.6$\n- 土壤面积覆盖度：$f_{s} = 0.4$\n- 覆盖度约束：$f_{v} + f_{s} = 1$\n- 植被端元反射率：$\\rho_{v} = 0.5$（无量纲）\n- 土壤端元反射率：$\\rho_{s} = 0.2$（无量纲）\n- 朗伯体表面的辐射关系式：$L = \\frac{E\\,\\rho}{\\pi}$，其中 $L$ 是辐亮度，$E$ 是辐照度，$\\rho$ 是反射率。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据既定标准对问题进行评估：\n- **科学性：** 该问题牢固地植根于辐射传输和遥感的基本原理。关系式 $L = (E\\rho)/\\pi$ 是理想漫反射（朗伯）表面辐亮度的正确定义。线性光谱混合的概念，即像元信号是其组成成分（端元）信号的加权平均，是定量遥感中一个标准且广泛使用的模型。所有给定值对于半干旱环境都是物理上现实的。\n- **适定性：** 该问题提供了一套完整且一致的信息。推导和最终计算所需的所有变量（$f_v, f_s, \\rho_v, \\rho_s$）都已定义。目标明确陈述：推导观测到的像元反射率 $\\rho_{\\text{obs}}$ 并计算其值。问题设置保证了唯一且有意义的解。约束条件 $f_{v} + f_{s} = 0.6 + 0.4 = 1$ 得到满足。\n- **客观性：** 该问题使用精确、无歧义的科学术语进行陈述。没有主观、基于观点或不可量化的元素。\n- **结论：** 该问题未违反任何无效性标准。它在科学上是合理的、适定的和客观的。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。现在将提供一个完整且论证充分的解答。\n\n### 推导与求解\n\n核心任务是基于辐亮度空间平均的原理，推导出观测像元反射率 $\\rho_{\\text{obs}}$ 的表达式。\n\n根据问题陈述，像元平均辐亮度（我们将其表示为 $L_{\\text{pix}}$）是像元面积 $A$ 上逐点辐亮度 $L(\\mathbf{x})$ 的面积平均值。这可以用数学方式表示为：\n$$L_{\\text{pix}} = \\frac{1}{A} \\int_{A} L(\\mathbf{x}) \\, dA$$\n该像元由两种不同的地表类型组成：植被和土壤。总面积 $A$ 可以划分为被植被覆盖的区域 $A_v$ 和被土壤覆盖的区域 $A_s$。由于给定了分数覆盖度，我们有 $A_v = f_v A$ 和 $A_s = f_s A$。\n\n该积分可以分解到这两个不同的子区域上：\n$$L_{\\text{pix}} = \\frac{1}{A} \\left( \\int_{A_v} L(\\mathbf{x}) \\, dA + \\int_{A_s} L(\\mathbf{x}) \\, dA \\right)$$\n在子区域 $A_v$ 内，地表是反射率为常数 $\\rho_v$ 的植被。由于光照 $E$ 是均匀的且地表是朗伯体，因此整个子区域的辐亮度是恒定的。我们称此辐亮度为 $L_v$。使用给定的公式：\n$$L_v = \\frac{E \\rho_v}{\\pi}$$\n同样，在子区域 $A_s$ 内，地表是反射率为常数 $\\rho_s$ 的裸土。该子区域的辐亮度 $L_s$ 也是恒定的：\n$$L_s = \\frac{E \\rho_s}{\\pi}$$\n由于 $L_v$ 和 $L_s$ 在它们各自的积分域上是常数，因此可以将其移到积分符号之外：\n$$L_{\\text{pix}} = \\frac{1}{A} \\left( L_v \\int_{A_v} dA + L_s \\int_{A_s} dA \\right)$$\n这些积分就是子区域的面积：$\\int_{A_v} dA = A_v$ 和 $\\int_{A_s} dA = A_s$。\n$$L_{\\text{pix}} = \\frac{1}{A} (L_v A_v + L_s A_s)$$\n代入 $A_v = f_v A$ 和 $A_s = f_s A$：\n$$L_{\\text{pix}} = \\frac{1}{A} (L_v f_v A + L_s f_s A) = f_v L_v + f_s L_s$$\n这个结果证实了像元平均辐亮度是其组分辐亮度的面积分数加权和。这就是线性混合模型。\n\n现在，我们代入 $L_v$ 和 $L_s$ 的表达式：\n$$L_{\\text{pix}} = f_v \\left( \\frac{E \\rho_v}{\\pi} \\right) + f_s \\left( \\frac{E \\rho_s}{\\pi} \\right)$$\n提取公因式 $\\frac{E}{\\pi}$：\n$$L_{\\text{pix}} = \\frac{E}{\\pi} (f_v \\rho_v + f_s \\rho_s)$$\n问题要求的是观测像元反射率 $\\rho_{\\text{obs}}$，它被定义为一个均匀像元的有效反射率，该像元在相同的光照 $E$ 下会产生相同的像元平均辐亮度 $L_{\\text{pix}}$。将基本辐射度学关系应用于这个有效像元：\n$$L_{\\text{pix}} = \\frac{E \\rho_{\\text{obs}}}{\\pi}$$\n通过令 $L_{\\text{pix}}$ 的两个表达式相等，我们可以解出 $\\rho_{\\text{obs}}$：\n$$\\frac{E \\rho_{\\text{obs}}}{\\pi} = \\frac{E}{\\pi} (f_v \\rho_v + f_s \\rho_s)$$\n项 $\\frac{E}{\\pi}$ 非零，可以从等式两边消去，得到观测像元反射率的正式表达式：\n$$\\rho_{\\text{obs}} = f_v \\rho_v + f_s \\rho_s$$\n这表明，在给定的假设（均匀光照、朗伯表面、可忽略的邻近和地形效应）下，有效像元反射率是各端元反射率以其各自的面积分数作为权重的线性组合。\n\n最后，我们使用给定的数据计算 $\\rho_{\\text{obs}}$ 的数值：\n- $f_v = 0.6$\n- $\\rho_v = 0.5$\n- $f_s = 0.4$\n- $\\rho_s = 0.2$\n\n将这些值代入推导出的方程：\n$$\\rho_{\\text{obs}} = (0.6)(0.5) + (0.4)(0.2)$$\n$$\\rho_{\\text{obs}} = 0.30 + 0.08$$\n$$\\rho_{\\text{obs}} = 0.38$$\n观测到的像元反射率为 $0.38$。根据要求，这是一个无量纲的量。计算是精确的，无需四舍五入。",
            "answer": "$$\\boxed{0.38}$$"
        }
    ]
}