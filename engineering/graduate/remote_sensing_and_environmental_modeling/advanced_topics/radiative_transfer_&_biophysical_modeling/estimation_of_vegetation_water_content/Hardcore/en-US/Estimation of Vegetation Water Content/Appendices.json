{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of quantitative remote sensing is the ability to relate satellite- or airborne-measurements to physical quantities on the ground. This practice provides a foundational exercise in this process, connecting a direct, field-based measurement of vegetation water content (VWC) with an estimate derived from a spectral index. By calculating VWC from fresh and dry biomass samples and comparing it to an estimate from a calibrated Normalized Difference Water Index (NDWI), you will gain direct experience with the principles of algorithm validation and the importance of ground-truthing remote sensing products .",
            "id": "3810646",
            "problem": "A field campaign in a temperate grassland aims to estimate vegetation water content per unit area from destructive samples and to compare it with an independent remote sensing retrieval. The vegetation water content per unit area is defined as the mass of water contained in vegetation per unit ground area. Use the following foundational bases: mass conservation for plant tissue and a spectrally based index calibration.\n\nIn the field, the average fresh biomass per unit area is measured as $2.8\\ \\text{kg m}^{-2}$ and the corresponding oven-dry biomass per unit area is $1.9\\ \\text{kg m}^{-2}$. Assume that fresh biomass is the sum of dry biomass and water mass and that oven drying removes all water but does not remove structural dry matter.\n\nFor the remote sensing retrieval, consider the Normalized Difference Water Index (NDWI, Gao 1996), defined as\n$$\n\\text{NDWI} = \\frac{R_{\\text{NIR}} - R_{\\text{SWIR}}}{R_{\\text{NIR}} + R_{\\text{SWIR}}},\n$$\nwhere $R_{\\text{NIR}}$ and $R_{\\text{SWIR}}$ are top-of-canopy reflectances in the near-infrared and shortwave-infrared bands, respectively. For the plot, a nadir-view hyperspectral measurement yields $R_{\\text{NIR}} = 0.42$ and $R_{\\text{SWIR}} = 0.23$ (unitless). A previously validated calibration for this canopy structural class relates canopy water content per unit area $W_{\\text{RS}}$ (in $\\text{kg m}^{-2}$) to NDWI by a linear model,\n$$\nW_{\\text{RS}} = \\alpha\\,\\text{NDWI} + \\beta,\n$$\nwith $\\alpha = 2.00\\ \\text{kg m}^{-2}$ and $\\beta = 0.20\\ \\text{kg m}^{-2}$.\n\nCompute the fractional discrepancy between the remote sensing estimate and the field-derived vegetation water content, defined as\n$$\n\\delta = \\frac{W_{\\text{RS}} - W_{\\text{field}}}{W_{\\text{field}}},\n$$\nand express $\\delta$ as a decimal (dimensionless). Round your final answer to four significant figures. If you compute intermediate quantities with units, express them in $\\text{kg m}^{-2}$; however, the final fractional discrepancy is unitless as specified above.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n**Step 1: Extracted Givens**\n- Definition: Vegetation water content per unit area is the mass of water contained in vegetation per unit ground area.\n- Field measurement, average fresh biomass per unit area ($B_{\\text{fresh}}$): $2.8\\ \\text{kg m}^{-2}$.\n- Field measurement, average oven-dry biomass per unit area ($B_{\\text{dry}}$): $1.9\\ \\text{kg m}^{-2}$.\n- Assumption 1: Fresh biomass is the sum of dry biomass and water mass.\n- Assumption 2: Oven drying removes all water but not structural dry matter.\n- Remote sensing index definition: $\\text{NDWI} = \\frac{R_{\\text{NIR}} - R_{\\text{SWIR}}}{R_{\\text{NIR}} + R_{\\text{SWIR}}}$.\n- Reflectance in the near-infrared ($R_{\\text{NIR}}$): $0.42$.\n- Reflectance in the shortwave-infrared ($R_{\\text{SWIR}}$): $0.23$.\n- Calibration model for remote sensing water content ($W_{\\text{RS}}$): $W_{\\text{RS}} = \\alpha\\,\\text{NDWI} + \\beta$.\n- Calibration parameter $\\alpha$: $2.00\\ \\text{kg m}^{-2}$.\n- Calibration parameter $\\beta$: $0.20\\ \\text{kg m}^{-2}$.\n- Required calculation: Fractional discrepancy $\\delta = \\frac{W_{\\text{RS}} - W_{\\text{field}}}{W_{\\text{field}}}$.\n- Final answer requirement: Decimal rounded to four significant figures.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is assessed to be valid.\n- **Scientifically Grounded:** The problem is based on the fundamental principle of mass conservation for determining water content from fresh and dry biomass. The use of the Normalized Difference Water Index (NDWI) is a standard technique in remote sensing for estimating vegetation water status. The provided numerical values for biomass and reflectances are physically realistic for a temperate grassland ecosystem.\n- **Well-Posed:** The problem provides all necessary data, assumptions, and equations to compute a unique numerical value for the fractional discrepancy, $\\delta$. The objective is clearly stated.\n- **Objective:** The problem is formulated with precise, quantitative terms and definitions, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe objective is to compute the fractional discrepancy, $\\delta$, between the remote sensing estimate of vegetation water content, $W_{\\text{RS}}$, and the field-derived estimate, $W_{\\text{field}}$. The formula for $\\delta$ is given as:\n$$\n\\delta = \\frac{W_{\\text{RS}} - W_{\\text{field}}}{W_{\\text{field}}}\n$$\nThis requires the separate calculation of $W_{\\text{field}}$ and $W_{\\text{RS}}$.\n\n**1. Calculation of a Field-Derived Vegetation Water Content ($W_{\\text{field}}$)**\n\nBased on the principle of mass conservation, the fresh biomass ($B_{\\text{fresh}}$) is the sum of its constituent water mass and dry biomass ($B_{\\text{dry}}$). The vegetation water content per unit area, $W_{\\text{field}}$, is therefore the difference between the fresh and dry biomass per unit area.\n$$\nW_{\\text{field}} = B_{\\text{fresh}} - B_{\\text{dry}}\n$$\nUsing the provided field measurements:\n$$\nB_{\\text{fresh}} = 2.8\\ \\text{kg m}^{-2}\n$$\n$$\nB_{\\text{dry}} = 1.9\\ \\text{kg m}^{-2}\n$$\nThe calculation is:\n$$\nW_{\\text{field}} = 2.8\\ \\text{kg m}^{-2} - 1.9\\ \\text{kg m}^{-2} = 0.9\\ \\text{kg m}^{-2}\n$$\n\n**2. Calculation of the Remote Sensing-Derived Vegetation Water Content ($W_{\\text{RS}}$)**\n\nThis calculation proceeds in two steps. First, the Normalized Difference Water Index (NDWI) is computed from the given reflectances. Second, the linear calibration model is applied.\n\n**a. Compute NDWI**\nThe NDWI is defined as:\n$$\n\\text{NDWI} = \\frac{R_{\\text{NIR}} - R_{\\text{SWIR}}}{R_{\\text{NIR}} + R_{\\text{SWIR}}}\n$$\nWith the given reflectance values:\n$$\nR_{\\text{NIR}} = 0.42\n$$\n$$\nR_{\\text{SWIR}} = 0.23\n$$\nSubstituting these values into the formula:\n$$\n\\text{NDWI} = \\frac{0.42 - 0.23}{0.42 + 0.23} = \\frac{0.19}{0.65}\n$$\n\n**b. Compute $W_{\\text{RS}}$**\nThe remote sensing estimate, $W_{\\text{RS}}$, is related to NDWI by the linear model:\n$$\nW_{\\text{RS}} = \\alpha\\,\\text{NDWI} + \\beta\n$$\nThe parameters are given as:\n$$\n\\alpha = 2.00\\ \\text{kg m}^{-2}\n$$\n$$\n\\beta = 0.20\\ \\text{kg m}^{-2}\n$$\nSubstituting the parameters and the expression for NDWI:\n$$\nW_{\\text{RS}} = \\left(2.00\\ \\text{kg m}^{-2}\\right) \\left(\\frac{0.19}{0.65}\\right) + 0.20\\ \\text{kg m}^{-2}\n$$\n$$\nW_{\\text{RS}} = \\left(\\frac{0.38}{0.65} + 0.20\\right)\\ \\text{kg m}^{-2}\n$$\nNumerically evaluating this expression:\n$$\nW_{\\text{RS}} \\approx (0.58461538... + 0.20)\\ \\text{kg m}^{-2} = 0.78461538...\\ \\text{kg m}^{-2}\n$$\n\n**3. Calculation of the Fractional Discrepancy ($\\delta$)**\n\nNow, substitute the computed values of $W_{\\text{field}}$ and $W_{\\text{RS}}$ into the formula for $\\delta$.\n$$\n\\delta = \\frac{W_{\\text{RS}} - W_{\\text{field}}}{W_{\\text{field}}}\n$$\nUsing the derived values:\n$$\n\\delta = \\frac{0.78461538...\\ \\text{kg m}^{-2} - 0.9\\ \\text{kg m}^{-2}}{0.9\\ \\text{kg m}^{-2}}\n$$\nTo maintain precision, we use the fractional form of $W_{\\text{RS}}$:\n$$\n\\delta = \\frac{\\left(\\frac{0.38}{0.65} + 0.20\\right) - 0.9}{0.9} = \\frac{\\frac{0.38}{0.65} - 0.70}{0.9}\n$$\nTo simplify the numerator, a common denominator is used:\n$$\n\\frac{0.38}{0.65} - \\frac{0.70 \\times 0.65}{0.65} = \\frac{0.38 - 0.455}{0.65} = \\frac{-0.075}{0.65}\n$$\nNow substitute this back into the expression for $\\delta$:\n$$\n\\delta = \\frac{\\frac{-0.075}{0.65}}{0.9} = \\frac{-0.075}{0.65 \\times 0.9} = \\frac{-0.075}{0.585}\n$$\nPerforming the final division:\n$$\n\\delta \\approx -0.128205128...\n$$\nThe problem requires the final answer to be rounded to four significant figures. The fifth significant figure is $0$, so we round down.\n$$\n\\delta \\approx -0.1282\n$$",
            "answer": "$$\\boxed{-0.1282}$$"
        },
        {
            "introduction": "Beyond simply generating an estimate, a critical task in scientific measurement is to quantify its uncertainty. This practice advances from VWC estimation to VWC uncertainty assessment, demonstrating how noise inherent in a sensor's measurement propagates through an algorithm to the final data product. By calculating the sensitivity of the Normalized Difference Moisture Index (NDMI) to changes in reflectance and using the instrument's Signal-to-Noise Ratio (SNR), you will learn the fundamentals of first-order error propagation and its application in evaluating the reliability of remote sensing retrievals .",
            "id": "3810702",
            "problem": "A vegetation canopy is observed by a hyperspectral imaging radiometer. The Normalized Difference Moisture Index (NDMI) is defined for two bands, near-infrared and shortwave infrared, by the widely used index expression\n$$\n\\mathrm{NDMI} = \\frac{\\rho_{\\mathrm{NIR}} - \\rho_{1240}}{\\rho_{\\mathrm{NIR}} + \\rho_{1240}},\n$$\nwhere $\\rho_{\\mathrm{NIR}}$ is the surface reflectance in the near-infrared band and $\\rho_{1240}$ is the surface reflectance at $1240\\ \\mathrm{nm}$. Vegetation Water Content (VWC) is estimated from NDMI using a linear calibration model\n$$\n\\mathrm{VWC} = a + b\\,\\mathrm{NDMI},\n$$\nwhere $a$ is an intercept and $b$ is the calibration slope with units $\\mathrm{kg}\\ \\mathrm{m}^{-2}$ per unit NDMI. The instrument has a Signal-to-Noise Ratio (SNR) of $200$ at $1240\\ \\mathrm{nm}$, defined as the ratio of the mean signal to the standard deviation of the noise. Assume that uncertainty is dominated by $\\rho_{1240}$ measurement noise, that $\\rho_{\\mathrm{NIR}}$ is known exactly for the purpose of this calculation, and that first-order (linear) uncertainty propagation is valid.\n\nGiven the following conditions:\n- $\\rho_{\\mathrm{NIR}} = 0.45$,\n- $\\rho_{1240} = 0.25$,\n- $b = 2.5\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}$ per unit NDMI,\n- SNR at $1240\\ \\mathrm{nm}$ is $200$,\n\nperform the following tasks:\n1. Compute the sensitivity of $\\mathrm{NDMI}$ to changes in $\\rho_{1240}$ by taking the partial derivative $\\frac{\\partial\\,\\mathrm{NDMI}}{\\partial \\rho_{1240}}$ evaluated at the given reflectances.\n2. Using the SNR definition and the result from part 1, evaluate the resulting standard deviation in VWC due solely to the measurement noise in $\\rho_{1240}$.\n\nRound your final VWC standard deviation to three significant figures and express it in $\\mathrm{kg}\\ \\mathrm{m}^{-2}$. The final answer must be a single real number.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of remote sensing and error propagation, well-posed with a clear objective and sufficient information, and free of any logical contradictions or factual inaccuracies.\n\nThe solution proceeds in two parts as requested by the problem statement. First, the sensitivity of the Normalized Difference Moisture Index ($\\mathrm{NDMI}$) to changes in the shortwave infrared reflectance ($\\rho_{1240}$) is computed. Second, this sensitivity is used within a first-order uncertainty propagation framework to determine the standard deviation of the Vegetation Water Content ($\\mathrm{VWC}$) estimate.\n\n**Part 1: Sensitivity of $\\mathrm{NDMI}$ to $\\rho_{1240}$**\n\nThe Normalized Difference Moisture Index ($\\mathrm{NDMI}$) is given by the expression:\n$$\n\\mathrm{NDMI} = \\frac{\\rho_{\\mathrm{NIR}} - \\rho_{1240}}{\\rho_{\\mathrm{NIR}} + \\rho_{1240}}\n$$\nwhere $\\rho_{\\mathrm{NIR}}$ is the reflectance in the near-infrared band and $\\rho_{1240}$ is the reflectance at the $1240\\ \\mathrm{nm}$ wavelength.\n\nTo find the sensitivity of $\\mathrm{NDMI}$ to changes in $\\rho_{1240}$, we must compute the partial derivative $\\frac{\\partial\\,\\mathrm{NDMI}}{\\partial \\rho_{1240}}$. We apply the quotient rule for differentiation, which states that for a function $f(x) = \\frac{u(x)}{v(x)}$, the derivative is $f'(x) = \\frac{u'(x)v(x) - u(x)v'(x)}{[v(x)]^2}$.\nIn our case, the variable is $\\rho_{1240}$, and the functions are $u(\\rho_{1240}) = \\rho_{\\mathrm{NIR}} - \\rho_{1240}$ and $v(\\rho_{1240}) = \\rho_{\\mathrm{NIR}} + \\rho_{1240}$. The derivatives with respect to $\\rho_{1240}$ are:\n$$\n\\frac{\\partial u}{\\partial \\rho_{1240}} = -1\n$$\n$$\n\\frac{\\partial v}{\\partial \\rho_{1240}} = 1\n$$\nApplying the quotient rule:\n$$\n\\frac{\\partial\\,\\mathrm{NDMI}}{\\partial \\rho_{1240}} = \\frac{(-1)(\\rho_{\\mathrm{NIR}} + \\rho_{1240}) - (\\rho_{\\mathrm{NIR}} - \\rho_{1240})(1)}{(\\rho_{\\mathrm{NIR}} + \\rho_{1240})^2}\n$$\nSimplifying the numerator:\n$$\n\\frac{\\partial\\,\\mathrm{NDMI}}{\\partial \\rho_{1240}} = \\frac{-\\rho_{\\mathrm{NIR}} - \\rho_{1240} - \\rho_{\\mathrm{NIR}} + \\rho_{1240}}{(\\rho_{\\mathrm{NIR}} + \\rho_{1240})^2} = \\frac{-2\\rho_{\\mathrm{NIR}}}{(\\rho_{\\mathrm{NIR}} + \\rho_{1240})^2}\n$$\nNow, we evaluate this partial derivative using the given values $\\rho_{\\mathrm{NIR}} = 0.45$ and $\\rho_{1240} = 0.25$:\n$$\n\\frac{\\partial\\,\\mathrm{NDMI}}{\\partial \\rho_{1240}} \\bigg|_{\\substack{\\rho_{\\mathrm{NIR}}=0.45 \\\\ \\rho_{1240}=0.25}} = \\frac{-2(0.45)}{(0.45 + 0.25)^2} = \\frac{-0.90}{(0.70)^2} = \\frac{-0.90}{0.49}\n$$\nThis value represents the sensitivity of $\\mathrm{NDMI}$ to changes in $\\rho_{1240}$.\n$$\n\\frac{\\partial\\,\\mathrm{NDMI}}{\\partial \\rho_{1240}} \\approx -1.8367\\ldots\n$$\n\n**Part 2: Standard Deviation of VWC**\n\nThe standard deviation in Vegetation Water Content ($\\sigma_{\\mathrm{VWC}}$) is found using first-order uncertainty propagation. The relationship between $\\mathrm{VWC}$ and $\\mathrm{NDMI}$ is given as:\n$$\n\\mathrm{VWC} = a + b\\,\\mathrm{NDMI}\n$$\nThe uncertainty in $\\mathrm{VWC}$, represented by its variance $\\sigma_{\\mathrm{VWC}}^2$, can be related to the uncertainty in $\\mathrm{NDMI}$ ($\\sigma_{\\mathrm{NDMI}}^2$) by:\n$$\n\\sigma_{\\mathrm{VWC}}^2 = \\left(\\frac{\\partial\\,\\mathrm{VWC}}{\\partial\\,\\mathrm{NDMI}}\\right)^2 \\sigma_{\\mathrm{NDMI}}^2\n$$\nThe partial derivative is $\\frac{\\partial\\,\\mathrm{VWC}}{\\partial\\,\\mathrm{NDMI}} = b$. Taking the square root gives the relationship for standard deviations:\n$$\n\\sigma_{\\mathrm{VWC}} = |b|\\,\\sigma_{\\mathrm{NDMI}}\n$$\nThe problem states that uncertainty is dominated by noise in the $\\rho_{1240}$ measurement and that $\\rho_{\\mathrm{NIR}}$ is known exactly ($\\sigma_{\\rho_{\\mathrm{NIR}}} = 0$). Therefore, the uncertainty in $\\mathrm{NDMI}$ arises solely from the uncertainty in $\\rho_{1240}$ ($\\sigma_{\\rho_{1240}}$):\n$$\n\\sigma_{\\mathrm{NDMI}}^2 = \\left(\\frac{\\partial\\,\\mathrm{NDMI}}{\\partial \\rho_{1240}}\\right)^2 \\sigma_{\\rho_{1240}}^2\n$$\nTaking the square root:\n$$\n\\sigma_{\\mathrm{NDMI}} = \\left|\\frac{\\partial\\,\\mathrm{NDMI}}{\\partial \\rho_{1240}}\\right| \\sigma_{\\rho_{1240}}\n$$\nCombining the two propagation steps, we get an expression for $\\sigma_{\\mathrm{VWC}}$:\n$$\n\\sigma_{\\mathrm{VWC}} = |b| \\left|\\frac{\\partial\\,\\mathrm{NDMI}}{\\partial \\rho_{1240}}\\right| \\sigma_{\\rho_{1240}}\n$$\nThe standard deviation of the reflectance measurement, $\\sigma_{\\rho_{1240}}$, is determined from the Signal-to-Noise Ratio ($\\mathrm{SNR}$), which is defined as the mean signal divided by the standard deviation of the noise. The mean signal is the reflectance value itself.\n$$\n\\mathrm{SNR}_{1240} = \\frac{\\rho_{1240}}{\\sigma_{\\rho_{1240}}}\n$$\nRearranging for $\\sigma_{\\rho_{1240}}$ and substituting the given values $\\rho_{1240} = 0.25$ and $\\mathrm{SNR}_{1240} = 200$:\n$$\n\\sigma_{\\rho_{1240}} = \\frac{\\rho_{1240}}{\\mathrm{SNR}_{1240}} = \\frac{0.25}{200} = 0.00125\n$$\nNow we can substitute all the known values into the expression for $\\sigma_{\\mathrm{VWC}}$. Given $b = 2.5\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}$, and $|b|=b$ since $b > 0$:\n$$\n\\sigma_{\\mathrm{VWC}} = b \\left|\\frac{-2\\rho_{\\mathrm{NIR}}}{(\\rho_{\\mathrm{NIR}} + \\rho_{1240})^2}\\right| \\sigma_{\\rho_{1240}}\n$$\n$$\n\\sigma_{\\mathrm{VWC}} = (2.5) \\left|\\frac{-0.90}{0.49}\\right| (0.00125)\n$$\n$$\n\\sigma_{\\mathrm{VWC}} = 2.5 \\times \\frac{0.90}{0.49} \\times 0.00125\n$$\n$$\n\\sigma_{\\mathrm{VWC}} = \\frac{2.5 \\times 0.90 \\times 0.00125}{0.49} = \\frac{0.0028125}{0.49} \\approx 0.0057397959\\ldots\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\n$$\nThe problem requires the result to be rounded to three significant figures.\n$$\n\\sigma_{\\mathrm{VWC}} \\approx 0.00574\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}\n$$\nExpressed in scientific notation, this is $5.74 \\times 10^{-3}\\ \\mathrm{kg}\\ \\mathrm{m}^{-2}$.",
            "answer": "$$\n\\boxed{5.74 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "While spectral indices provide a powerful and simple tool, they are often limited by saturation and environmental factors. This advanced practice introduces a more robust, physics-based approach to parameter retrieval using a Bayesian inversion framework, a state-of-the-art method in environmental modeling. You will implement a simplified radiative transfer model and use Bayesian principles to estimate Equivalent Water Thickness (EWT) by combining model predictions, observational data, and prior knowledge of the vegetation parameters . This exercise illustrates how to solve the ill-posed inverse problem common in remote sensing and obtain a probabilistic estimate of vegetation properties.",
            "id": "3810666",
            "problem": "Consider the estimation of Equivalent Water Thickness (EWT) in vegetation, parameterized as $C_w$ in grams per square centimeter ($g\\,cm^{-2}$), using a simplified, physics-informed surrogate of the leaf PROperties SPECTrum (PROSPECT) and Scattering by Arbitrarily Inclined Leaves (SAIL) models. Let the state vector be $\\boldsymbol{\\theta} = (C_w, LAI, C_{ab})$, where $LAI$ is the Leaf Area Index in square meters per square meter ($m^2\\,m^{-2}$), and $C_{ab}$ is the leaf chlorophyll content in micrograms per square centimeter ($\\mu g\\,cm^{-2}$). Observations are top-of-canopy reflectance at three wavelengths representative of absorption and scattering regimes: visible ($0.68\\,\\mu m$), near-infrared ($0.86\\,\\mu m$), and shortwave-infrared ($1.64\\,\\mu m$). Assume additive, independent, identically distributed Gaussian observation noise with standard deviation $\\sigma = 0.01$ reflectance units.\n\nForward model definition. Let canopy extinction coefficient be $b = 0.5$. Define leaf transmittance at wavelength $\\lambda$ via Beer–Lambert law as\n$$\nt_{\\lambda}(C_w, C_{ab}) = \\exp\\!\\big(-a_{w,\\lambda}\\,C_w - a_{p,\\lambda}\\,C_{ab}\\big),\n$$\nwhere $a_{w,\\lambda}$ and $a_{p,\\lambda}$ are wavelength-specific absorption factors for water and pigments, respectively. The top-of-canopy reflectance $r_{\\lambda}$ is modeled as the sum of a canopy scattering term and an attenuated soil background term:\n$$\nr_{\\lambda}(C_w, LAI, C_{ab}) = s_{\\lambda}\\,\\big(1 - \\exp(-b\\,LAI)\\big) + r_{\\text{soil},\\lambda}\\,\\exp(-b\\,LAI)\\,t_{\\lambda}(C_w, C_{ab}).\n$$\nUse the following constants, chosen to reflect known spectral behaviors (high pigment absorption in the visible band, weak absorption in the near-infrared band, strong water absorption in the shortwave-infrared band):\n- Visible ($0.68\\,\\mu m$): $a_{w,VIS} = 0.10$, $a_{p,VIS} = 0.015$, $s_{VIS} = 0.05$, $r_{\\text{soil},VIS} = 0.20$.\n- Near-infrared ($0.86\\,\\mu m$): $a_{w,NIR} = 0.50$, $a_{p,NIR} = 0.001$, $s_{NIR} = 0.50$, $r_{\\text{soil},NIR} = 0.35$.\n- Shortwave-infrared ($1.64\\,\\mu m$): $a_{w,SWIR} = 25.00$, $a_{p,SWIR} = 0.000$, $s_{SWIR} = 0.10$, $r_{\\text{soil},SWIR} = 0.25$.\n\nBayesian specification. Assume independent Gaussian priors truncated to physically plausible ranges:\n- $C_w \\sim \\mathcal{N}(\\mu_{C_w}, \\sigma_{C_w}^2)$ truncated to $[C_{w,\\min}, C_{w,\\max}]$.\n- $LAI \\sim \\mathcal{N}(\\mu_{LAI}, \\sigma_{LAI}^2)$ truncated to $[LAI_{\\min}, LAI_{\\max}]$.\n- $C_{ab} \\sim \\mathcal{N}(\\mu_{C_{ab}}, \\sigma_{C_{ab}}^2)$ truncated to $[C_{ab,\\min}, C_{ab,\\max}]$.\n\nUse the following prior parameters and bounds:\n- Means: $\\mu_{C_w} = 0.015$, $\\mu_{LAI} = 2.5$, $\\mu_{C_{ab}} = 45.0$.\n- Standard deviations: $\\sigma_{C_w} = 0.006$, $\\sigma_{LAI} = 1.0$, $\\sigma_{C_{ab}} = 15.0$.\n- Bounds: $C_{w,\\min} = 0.002$, $C_{w,\\max} = 0.050$; $LAI_{\\min} = 0.2$, $LAI_{\\max} = 8.0$; $C_{ab,\\min} = 5.0$, $C_{ab,\\max} = 100.0$.\n\nObservation model. Let the observed reflectance vector be $\\mathbf{y} = \\big(y_{VIS}, y_{NIR}, y_{SWIR}\\big)$. The likelihood is\n$$\np(\\mathbf{y}\\mid \\boldsymbol{\\theta}) = \\mathcal{N}\\big(\\mathbf{y}; \\mathbf{r}(\\boldsymbol{\\theta}), \\sigma^2 \\mathbf{I}_3\\big),\n$$\nwhere $\\mathbf{r}(\\boldsymbol{\\theta}) = \\big(r_{VIS}, r_{NIR}, r_{SWIR}\\big)$ obtained from the forward model above.\n\nTask. Starting from Bayes’ theorem and the forward model, derive the posterior distribution $p(\\boldsymbol{\\theta}\\mid \\mathbf{y})$ up to a proportionality constant. Then, implement a deterministic numerical scheme that approximates the posterior mean of $C_w$ by grid-based integration over the truncated domain. Specifically:\n- Construct uniform grids:\n  - $C_w \\in [C_{w,\\min}, C_{w,\\max}]$ with step $0.001$ ($g\\,cm^{-2}$).\n  - $LAI \\in [LAI_{\\min}, LAI_{\\max}]$ with step $0.1$ ($m^2\\,m^{-2}$).\n  - $C_{ab} \\in [C_{ab,\\min}, C_{ab,\\max}]$ with step $5.0$ ($\\mu g\\,cm^{-2}$).\n- On this grid, compute the unnormalized posterior weights using the likelihood and priors defined above, then normalize these weights and compute the posterior mean of $C_w$.\n\nExpress all reported $C_w$ values in $g\\,cm^{-2}$, rounded to five decimal places.\n\nTest suite. Use $\\sigma = 0.01$ for all cases. Evaluate your program for the following three observation vectors:\n1. $\\mathbf{y}_1 = (0.060, 0.450, 0.150)$.\n2. $\\mathbf{y}_2 = (0.050, 0.400, 0.080)$.\n3. $\\mathbf{y}_3 = (0.070, 0.550, 0.220)$.\n\nFinal output format. Your program should produce a single line of output containing the posterior means of $C_w$ for the three test cases, in order, as a comma-separated list enclosed in square brackets (e.g., $[c_1,c_2,c_3]$), with each $c_i$ rounded to five decimal places and expressed in $g\\,cm^{-2}$ units.",
            "solution": "The problem is subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n\n-   **State Vector**: $\\boldsymbol{\\theta} = (C_w, LAI, C_{ab})$\n    -   $C_w$: Equivalent Water Thickness in $g\\,cm^{-2}$.\n    -   $LAI$: Leaf Area Index in $m^2\\,m^{-2}$.\n    -   $C_{ab}$: Leaf chlorophyll content in $\\mu g\\,cm^{-2}$.\n-   **Observations**: Top-of-canopy reflectance at three wavelengths:\n    -   Visible (VIS): $0.68\\,\\mu m$\n    -   Near-infrared (NIR): $0.86\\,\\mu m$\n    -   Shortwave-infrared (SWIR): $1.64\\,\\mu m$\n-   **Observation Noise**: Additive, independent, identically distributed Gaussian noise with standard deviation $\\sigma = 0.01$.\n-   **Forward Model**:\n    -   Canopy extinction coefficient: $b = 0.5$.\n    -   Leaf transmittance at wavelength $\\lambda$: $t_{\\lambda}(C_w, C_{ab}) = \\exp\\!\\big(-a_{w,\\lambda}\\,C_w - a_{p,\\lambda}\\,C_{ab}\\big)$.\n    -   Top-of-canopy reflectance at wavelength $\\lambda$: $r_{\\lambda}(C_w, LAI, C_{ab}) = s_{\\lambda}\\,\\big(1 - \\exp(-b\\,LAI)\\big) + r_{\\text{soil},\\lambda}\\,\\exp(-b\\,LAI)\\,t_{\\lambda}(C_w, C_{ab})$.\n-   **Model Constants**:\n    -   VIS: $a_{w,VIS} = 0.10$, $a_{p,VIS} = 0.015$, $s_{VIS} = 0.05$, $r_{\\text{soil},VIS} = 0.20$.\n    -   NIR: $a_{w,NIR} = 0.50$, $a_{p,NIR} = 0.001$, $s_{NIR} = 0.50$, $r_{\\text{soil},NIR} = 0.35$.\n    -   SWIR: $a_{w,SWIR} = 25.00$, $a_{p,SWIR} = 0.000$, $s_{SWIR} = 0.10$, $r_{\\text{soil},SWIR} = 0.25$.\n-   **Priors**: Independent truncated Gaussian distributions.\n    -   $C_w \\sim \\mathcal{N}(\\mu_{C_w}, \\sigma_{C_w}^2)$ truncated to $[C_{w,\\min}, C_{w,\\max}]$.\n        -   $\\mu_{C_w} = 0.015$, $\\sigma_{C_w} = 0.006$.\n        -   $C_{w,\\min} = 0.002$, $C_{w,\\max} = 0.050$.\n    -   $LAI \\sim \\mathcal{N}(\\mu_{LAI}, \\sigma_{LAI}^2)$ truncated to $[LAI_{\\min}, LAI_{\\max}]$.\n        -   $\\mu_{LAI} = 2.5$, $\\sigma_{LAI} = 1.0$.\n        -   $LAI_{\\min} = 0.2$, $LAI_{\\max} = 8.0$.\n    -   $C_{ab} \\sim \\mathcal{N}(\\mu_{C_{ab}}, \\sigma_{C_{ab}}^2)$ truncated to $[C_{ab,\\min}, C_{ab,\\max}]$.\n        -   $\\mu_{C_{ab}} = 45.0$, $\\sigma_{C_{ab}} = 15.0$.\n        -   $C_{ab,\\min} = 5.0$, $C_{ab,\\max} = 100.0$.\n-   **Likelihood Function**: $p(\\mathbf{y}\\mid \\boldsymbol{\\theta}) = \\mathcal{N}\\big(\\mathbf{y}; \\mathbf{r}(\\boldsymbol{\\theta}), \\sigma^2 \\mathbf{I}_3\\big)$, where $\\mathbf{y} = \\big(y_{VIS}, y_{NIR}, y_{SWIR}\\big)$ and $\\mathbf{r}(\\boldsymbol{\\theta}) = \\big(r_{VIS}, r_{NIR}, r_{SWIR}\\big)$.\n-   **Task**: Compute the posterior mean of $C_w$ via grid-based numerical integration.\n    -   $C_w$ grid: $[0.002, 0.050]$ with step $0.001$.\n    -   $LAI$ grid: $[0.2, 8.0]$ with step $0.1$.\n    -   $C_{ab}$ grid: $[5.0, 100.0]$ with step $5.0$.\n-   **Test Cases**: $\\sigma = 0.01$ and observation vectors:\n    1.  $\\mathbf{y}_1 = (0.060, 0.450, 0.150)$.\n    2.  $\\mathbf{y}_2 = (0.050, 0.400, 0.080)$.\n    3.  $\\mathbf{y}_3 = (0.070, 0.550, 0.220)$.\n-   **Output Format**: Final $C_w$ values rounded to five decimal places, as a comma-separated list in brackets.\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientifically Grounded**: The problem employs a simplified, physics-informed model of canopy reflectance, which is a standard approach in remote sensing research. The model structure is a simplification of the PROSPECT-SAIL models, combining Beer's law for leaf optical properties and a simple turbid medium model for canopy scattering. The physical parameter ranges, constants, and wavelengths are representative of vegetation analysis. The use of Bayesian inference for parameter retrieval is a well-established and rigorous method in the sciences. The problem is scientifically grounded.\n2.  **Well-Posed**: The problem is well-posed. It asks for a specific quantity (the posterior mean of $C_w$) and provides all necessary components for its computation: a forward model, a likelihood function, and fully specified prior distributions for all unknown parameters. The task is a deterministic numerical approximation (grid-based integration), which, given the defined grid, yields a unique result.\n3.  **Objective**: The problem is stated in precise, formal, and objective mathematical language. It is free of any subjective or opinion-based claims.\n4.  **Flaw Checklist**:\n    -   **Scientific/Factual Unsoundness**: None. The model is a simplification, not a violation of physical principles.\n    -   **Non-Formalizable/Irrelevant**: The problem is highly formal and directly relevant to the specified domain.\n    -   **Incomplete/Contradictory**: All required data, parameters, equations, and conditions are provided. All units are dimensionally consistent.\n    -   **Unrealistic/Infeasible**: The physical parameters and observation values are within plausible ranges for vegetation remote sensing.\n    -   **Ill-Posed/Poorly Structured**: The problem is well-structured, leading to a unique numerical solution.\n    -   **Pseudo-Profound/Trivial**: The problem requires a non-trivial implementation of a standard Bayesian numerical integration scheme. It is a substantive computational science task.\n    -   **Outside Scientific Verifiability**: The calculations are deterministic and can be independently verified.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Principle-Based Solution Design\n\nThe objective is to estimate the posterior mean of the Equivalent Water Thickness, $C_w$, given a vector of observed reflectances, $\\mathbf{y}$. This is a classic Bayesian inference problem. The posterior mean, $E[C_w \\mid \\mathbf{y}]$, is defined by the integral:\n$$\nE[C_w \\mid \\mathbf{y}] = \\int_{\\boldsymbol{\\Theta}} C_w \\, p(C_w \\mid \\mathbf{y}) \\, dC_w = \\int_{\\boldsymbol{\\Theta}} C_w \\, p(\\boldsymbol{\\theta} \\mid \\mathbf{y}) \\, d\\boldsymbol{\\theta}\n$$\nwhere $p(\\boldsymbol{\\theta} \\mid \\mathbf{y})$ is the posterior probability density function (PDF) of the state vector $\\boldsymbol{\\theta} = (C_w, LAI, C_{ab})$ over its parameter space $\\boldsymbol{\\Theta}$.\n\nAccording to Bayes' theorem, the posterior PDF is proportional to the product of the likelihood and the prior PDF:\n$$\np(\\boldsymbol{\\theta} \\mid \\mathbf{y}) = \\frac{p(\\mathbf{y} \\mid \\boldsymbol{\\theta}) \\, p(\\boldsymbol{\\theta})}{p(\\mathbf{y})} \\propto p(\\mathbf{y} \\mid \\boldsymbol{\\theta}) \\, p(\\boldsymbol{\\theta})\n$$\nThe term $p(\\mathbf{y}) = \\int p(\\mathbf{y} \\mid \\boldsymbol{\\theta}) \\, p(\\boldsymbol{\\theta}) \\, d\\boldsymbol{\\theta}$ is the marginal likelihood or evidence, which acts as a normalization constant.\n\nThe components of the unnormalized posterior, $p(\\mathbf{y} \\mid \\boldsymbol{\\theta}) \\, p(\\boldsymbol{\\theta})$, are specified as follows:\n\n1.  **Likelihood Function**: The observations $\\mathbf{y} = (y_{VIS}, y_{NIR}, y_{SWIR})$ are assumed to follow a Gaussian distribution centered at the forward model prediction $\\mathbf{r}(\\boldsymbol{\\theta})$ with a diagonal covariance matrix $\\sigma^2 \\mathbf{I}_3$. The likelihood is:\n    $$\n    p(\\mathbf{y} \\mid \\boldsymbol{\\theta}) = \\prod_{\\lambda \\in \\{VIS, NIR, SWIR\\}} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_\\lambda - r_\\lambda(\\boldsymbol{\\theta}))^2}{2\\sigma^2}\\right) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{\\lambda} \\big(y_\\lambda - r_\\lambda(\\boldsymbol{\\theta})\\big)^2\\right)\n    $$\n    where $r_\\lambda(\\boldsymbol{\\theta})$ is the reflectance predicted by the forward model for wavelength $\\lambda$.\n\n2.  **Prior Distribution**: The parameters $C_w$, $LAI$, and $C_{ab}$ are assumed to be a priori independent. The joint prior is the product of their individual priors:\n    $$\n    p(\\boldsymbol{\\theta}) = p(C_w) \\, p(LAI) \\, p(C_{ab})\n    $$\n    Each individual prior $p(x)$ is a truncated normal distribution. For a parameter $x \\sim \\mathcal{N}(\\mu_x, \\sigma_x^2)$ truncated to $[x_{\\min}, x_{\\max}]$, its PDF is zero outside this range, and inside the range it is:\n    $$\n    p(x) = \\frac{\\frac{1}{\\sigma_x} \\phi\\left(\\frac{x - \\mu_x}{\\sigma_x}\\right)}{\\Phi\\left(\\frac{x_{\\max} - \\mu_x}{\\sigma_x}\\right) - \\Phi\\left(\\frac{x_{\\min} - \\mu_x}{\\sigma_x}\\right)}\n    $$\n    where $\\phi(\\cdot)$ and $\\Phi(\\cdot)$ are the PDF and cumulative distribution function (CDF) of the standard normal distribution, respectively.\n\n**Numerical Approximation by Grid-Based Integration**\n\nThe continuous integral for the posterior mean is intractable analytically. We approximate it numerically by discretizing the parameter space $\\boldsymbol{\\Theta}$ into a three-dimensional grid. Let the grid points be indexed by $i, j, k$, corresponding to specific values $(C_{w,i}, LAI_j, C_{ab,k})$. The integral for the posterior mean is approximated by a weighted sum:\n$$\nE[C_w \\mid \\mathbf{y}] \\approx \\frac{\\sum_{i,j,k} C_{w,i} \\cdot W_{ijk}}{\\sum_{i,j,k} W_{ijk}}\n$$\nThe weights $W_{ijk}$ are the values of the unnormalized posterior evaluated at each grid point:\n$$\nW_{ijk} = p(\\mathbf{y} \\mid \\boldsymbol{\\theta}_{ijk}) \\, p(\\boldsymbol{\\theta}_{ijk})\n$$\nwhere $\\boldsymbol{\\theta}_{ijk} = (C_{w,i}, LAI_j, C_{ab,k})$. The term $\\sum_{i,j,k} W_{ijk}$ approximates the normalization constant (the evidence).\n\n**Computational Strategy**\n\nFor numerical stability, it is preferable to work with logarithms. The unnormalized log-posterior is:\n$$\n\\log W(\\boldsymbol{\\theta}) = \\log p(\\mathbf{y} \\mid \\boldsymbol{\\theta}) + \\log p(\\boldsymbol{\\theta})\n$$\nIgnoring constant terms that will cancel during normalization, we have:\n$$\n\\log W(\\boldsymbol{\\theta}) \\approx -\\frac{1}{2\\sigma^2} \\sum_{\\lambda} \\big(y_\\lambda - r_\\lambda(\\boldsymbol{\\theta})\\big)^2 + \\sum_{x \\in \\{C_w, LAI, C_{ab}\\}} \\log p(x)\n$$\nThe algorithm proceeds as follows:\n1.  Define all physical and statistical constants.\n2.  Construct the 3D grid for $(C_w, LAI, C_{ab})$ according to the specified ranges and steps.\n3.  For each test case observation vector $\\mathbf{y}$:\n    a.  Vectorize the computation over the entire grid. Create 3D arrays for $C_w$, $LAI$, and $C_{ab}$ values.\n    b.  Calculate the 3D grid of log-prior values, $\\log p(\\boldsymbol{\\theta}_{ijk})$. This involves computing the log-PDF of each truncated normal distribution for each parameter vector and summing them.\n    c.  Calculate the 3D grid of forward model outputs $r_{\\lambda}(\\boldsymbol{\\theta}_{ijk})$ for each of the three wavelengths.\n    d.  Calculate the 3D grid of log-likelihood values, $\\log p(\\mathbf{y} \\mid \\boldsymbol{\\theta}_{ijk})$.\n    e.  Sum the log-prior and log-likelihood grids to obtain the log-posterior grid.\n    f.  To prevent numerical underflow when exponentiating, shift the log-posterior grid by subtracting its maximum value: $\\log W'_{ijk} = \\log W_{ijk} - \\max(\\log W)$.\n    g.  Exponentiate to get the unnormalized posterior weights: $W'_{ijk} = \\exp(\\log W'_{ijk})$. This is numerically stable and mathematically equivalent for the final ratio.\n    h.  Compute the numerator $\\sum_{i,j,k} C_{w,i} \\cdot W'_{ijk}$ and the denominator $\\sum_{i,j,k} W'_{ijk}$.\n    i.  The posterior mean is the ratio of these two sums.\n4.  Round the final results to five decimal places as required.\n\nThis vectorized approach is computationally efficient and leverages the capabilities of numerical libraries like NumPy.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import truncnorm\n\ndef solve():\n    \"\"\"\n    Computes the posterior mean of Equivalent Water Thickness (C_w) using\n    grid-based numerical integration for a simplified radiative transfer model.\n    \"\"\"\n\n    # --- 1. Define Constants and Model Parameters ---\n\n    # Observation noise standard deviation\n    sigma_obs = 0.01\n\n    # Canopy extinction coefficient\n    b = 0.5\n\n    # Wavelength-specific absorption and scattering constants\n    # (w: water, p: pigment, s: scattering, soil: soil background)\n    params = {\n        'VIS': {'aw': 0.10, 'ap': 0.015, 's': 0.05, 'r_soil': 0.20},\n        'NIR': {'aw': 0.50, 'ap': 0.001, 's': 0.50, 'r_soil': 0.35},\n        'SWIR': {'aw': 25.0, 'ap': 0.000, 's': 0.10, 'r_soil': 0.25}\n    }\n\n    # Prior distribution parameters and bounds for the state vector\n    priors_spec = {\n        'Cw': {'mu': 0.015, 'sigma': 0.006, 'min': 0.002, 'max': 0.050, 'step': 0.001},\n        'LAI': {'mu': 2.5, 'sigma': 1.0, 'min': 0.2, 'max': 8.0, 'step': 0.1},\n        'Cab': {'mu': 45.0, 'sigma': 15.0, 'min': 5.0, 'max': 100.0, 'step': 5.0}\n    }\n\n    # Test cases: observed reflectance vectors\n    test_cases = [\n        (0.060, 0.450, 0.150),\n        (0.050, 0.400, 0.080),\n        (0.070, 0.550, 0.220)\n    ]\n\n    # --- 2. Construct Grids and Pre-compute Priors ---\n\n    # Create 1D grids for each parameter\n    cw_spec = priors_spec['Cw']\n    cw_vals = np.arange(cw_spec['min'], cw_spec['max'] + cw_spec['step']/2, cw_spec['step'])\n    \n    lai_spec = priors_spec['LAI']\n    lai_vals = np.arange(lai_spec['min'], lai_spec['max'] + lai_spec['step']/2, lai_spec['step'])\n\n    cab_spec = priors_spec['Cab']\n    cab_vals = np.arange(cab_spec['min'], cab_spec['max'] + cab_spec['step']/2, cab_spec['step'])\n\n    # Create 3D meshgrids from the 1D grids\n    # 'ij' indexing ensures Cw varies along axis 0, LAI along axis 1, Cab along axis 2\n    Cw_grid, LAI_grid, Cab_grid = np.meshgrid(cw_vals, lai_vals, cab_vals, indexing='ij')\n\n    # Calculate log-priors for each parameter on its 1D grid\n    # For a truncated normal N(mu, sigma^2) on [a,b], the standardized bounds are:\n    # alpha = (a - mu) / sigma, beta = (b - mu) / sigma\n    \n    a_cw = (cw_spec['min'] - cw_spec['mu']) / cw_spec['sigma']\n    b_cw = (cw_spec['max'] - cw_spec['mu']) / cw_spec['sigma']\n    log_prior_cw = truncnorm.logpdf(cw_vals, a=a_cw, b=b_cw, loc=cw_spec['mu'], scale=cw_spec['sigma'])\n\n    a_lai = (lai_spec['min'] - lai_spec['mu']) / lai_spec['sigma']\n    b_lai = (lai_spec['max'] - lai_spec['mu']) / lai_spec['sigma']\n    log_prior_lai = truncnorm.logpdf(lai_vals, a=a_lai, b=b_lai, loc=lai_spec['mu'], scale=lai_spec['sigma'])\n\n    a_cab = (cab_spec['min'] - cab_spec['mu']) / cab_spec['sigma']\n    b_cab = (cab_spec['max'] - cab_spec['mu']) / cab_spec['sigma']\n    log_prior_cab = truncnorm.logpdf(cab_vals, a=a_cab, b=b_cab, loc=cab_spec['mu'], scale=cab_spec['sigma'])\n\n    # Combine 1D log-priors into a 3D grid using broadcasting\n    # log(p(a,b,c)) = log(p(a)) + log(p(b)) + log(p(c))\n    log_prior_grid = log_prior_cw[:, np.newaxis, np.newaxis] + \\\n                     log_prior_lai[np.newaxis, :, np.newaxis] + \\\n                     log_prior_cab[np.newaxis, np.newaxis, :]\n\n    # --- 3. Implement Forward Model (Vectorized) ---\n    \n    def forward_model(Cw_grid, LAI_grid, Cab_grid):\n        \"\"\"Calculates reflectances for all points on the parameter grid.\"\"\"\n        canopy_transmittance = np.exp(-b * LAI_grid)\n        \n        reflectances = {}\n        for band in ['VIS', 'NIR', 'SWIR']:\n            p = params[band]\n            leaf_transmittance = np.exp(-p['aw'] * Cw_grid - p['ap'] * Cab_grid)\n            r_lambda = p['s'] * (1 - canopy_transmittance) + \\\n                       p['r_soil'] * canopy_transmittance * leaf_transmittance\n            reflectances[band] = r_lambda\n        return reflectances\n\n    # Pre-calculate model outputs over the grid as they are constant for all test cases\n    r_model = forward_model(Cw_grid, LAI_grid, Cab_grid)\n\n    # --- 4. Main Calculation Loop for Each Test Case ---\n    \n    results = []\n    for y_obs in test_cases:\n        y_vis, y_nir, y_swir = y_obs\n\n        # Calculate sum of squared errors between observations and model predictions\n        sse = ((y_vis - r_model['VIS'])**2 +\n               (y_nir - r_model['NIR'])**2 +\n               (y_swir - r_model['SWIR'])**2)\n\n        # Calculate log-likelihood (constants are omitted as they cancel out)\n        log_likelihood_grid = -0.5 * sse / (sigma_obs**2)\n        \n        # Calculate unnormalized log-posterior\n        log_posterior_grid = log_prior_grid + log_likelihood_grid\n        \n        # Normalize to prevent underflow/overflow during exponentiation\n        # This is the log-sum-exp trick for the denominator, but here we\n        # shift before exponentiating to get stable weights.\n        log_posterior_shifted = log_posterior_grid - np.max(log_posterior_grid)\n        posterior_weights = np.exp(log_posterior_shifted)\n        \n        # Calculate the posterior mean of Cw\n        # E[Cw|y] = sum(Cw * P(Cw|y)) / sum(P(Cw|y))\n        numerator = np.sum(Cw_grid * posterior_weights)\n        denominator = np.sum(posterior_weights)\n        \n        posterior_mean_cw = numerator / denominator\n        results.append(round(posterior_mean_cw, 5))\n\n    # --- 5. Print Final Output ---\n    # Format: [c1,c2,c3] with 5 decimal places\n    print(f\"[{','.join(f'{r:.5f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}