{
    "hands_on_practices": [
        {
            "introduction": "在估算植被光学厚度（VOD）之前，我们必须首先理解将其与我们的测量值——亮温——联系起来的物理模型。本练习通过探索模型在两种极端（或称“渐近”）情景下的行为来巩固这一理解：植被极为稀疏（$\\tau \\to 0$）和极为茂密（$\\tau \\to \\infty$）。通过推导这些极限情况下的亮温表达式，您将对土壤和植被的辐射贡献如何混合形成卫星观测信号建立起物理直觉 。",
            "id": "3810334",
            "problem": "一个无源微波辐射计在天底方向观测一个半无限土壤半空间上方的水平无限、平面平行的植被冠层。在适用于微波频率的瑞利-金斯近似下，亮温（BT）与辐射率成正比，因此直接以亮温单位进行处理会很方便。植被光学厚度（VOD），用 $\\tau$ 表示，用于参数化沿天底路径穿过冠层时的衰减。植被层是等温的，物理温度为 $T_{v}$，其特征是单次散射反照率 $\\omega \\in [0,1)$，该值代表了消光中由散射而非真实吸收所占的比例。土壤的物理温度为 $T_{s}$，具有极化相关的发射率 $\\varepsilon_{s}$ 和反射率 $r_{s}$，满足 $r_{s} = 1 - \\varepsilon_{s}$，且进入土壤的透射可忽略不计。\n\n假设采用一维、平面平行的辐射传输描述，具有均匀特性，无大气贡献，且为天底观测（$\\mu = 1$）。使用标准的单次散射反照率近似来处理冠层内的散射，并忽略除植被向下发射经土壤单次反射之外的多次反射。设冠层透射率为 $\\Gamma \\equiv \\exp(-\\tau)$。\n\n从冠层中热发射和衰减的辐射传输平衡方程出发，并考虑 (i) 经冠层衰减的向上土壤发射，(ii) 离开冠层的向上植被发射，以及 (iii) 被土壤反射然后向上穿过冠层并被衰减的向下植被发射，推导在两种渐近状态 $\\tau \\to 0$ 和 $\\tau \\to \\infty$ 下，观测到的冠层顶部亮温 $T_{b}$ 的极限形式。用 $\\varepsilon_{s}$、$r_{s}$、$T_{s}$、$T_{v}$ 和 $\\omega$ 来表示最终的极限表达式。用开尔文单位表示你最终的 $T_{b}$ 极限表达式。然后，在你的推理中，对土壤或植被发射主导观测亮温的状态进行物理解释。\n\n你的最终答案必须是单个解析表达式或包含两个极限表达式的单行矩阵。",
            "solution": "该问题要求推导冠层顶部观测亮温 $T_b$ 在植被光学厚度 $\\tau$ 的两种渐近状态下的极限形式。总亮温是问题陈述中列出的三个不同贡献之和。我们将首先通过对这些贡献求和来构建 $T_b$ 的完整表达式，然后评估其极限。\n\n观测亮温 $T_b$ 的三个分量是：\n1.  $T_{b,1}$：经冠层衰减的向上土壤发射。\n2.  $T_{b,2}$：来自植被冠层的直接向上发射。\n3.  $T_{b,3}$：从冠层向下发射，被土壤反射，然后再次被冠层衰减的辐射。\n\n设冠层在天底路径上的透射率为 $\\Gamma$，定义为 $\\Gamma = \\exp(-\\tau)$。\n\n首先，我们推导每个分量的表达式。\n\n分量 1 ($T_{b,1}$): 土壤表面物理温度为 $T_s$，发射率为 $\\varepsilon_s$。在瑞利-金斯近似下，土壤发射的辐射亮温为 $\\varepsilon_s T_s$。该辐射必须向上穿过植被冠层才能被观测到。在此过程中，它被因子 $\\Gamma$ 衰减。因此，第一个分量是：\n$$T_{b,1} = (\\varepsilon_s T_s) \\Gamma = \\varepsilon_s T_s \\exp(-\\tau)$$\n\n分量 2 ($T_{b,2}$): 植被层是一个温度为 $T_v$ 的等温介质。它沿天底路径上的每一点都发射热辐射。在光学深度 $\\tau'$（从冠层顶部测量）处，一个光学厚度为 $d\\tau'$ 的无穷小层的发射由 $(1-\\omega)T_v d\\tau'$ 给出。这里，$(1-\\omega)$ 是单次散射余反照率，代表冠层的吸收率，因此也代表其单位消光的有效发射率。此发射随后被其上方的光学路径 $\\tau'$ 衰减，衰减因子为 $\\exp(-\\tau')$。为了求出从冠层顶部射出的总直接向上发射，我们必须对整个冠层光学厚度进行积分，从顶部（$\\tau' = 0$）到底部（$\\tau'=\\tau$）：\n$$T_{b,2} = \\int_{0}^{\\tau} (1-\\omega) T_v \\exp(-\\tau') d\\tau'$$\n由于 $T_v$ 和 $\\omega$ 是给定的常数：\n$$T_{b,2} = (1-\\omega) T_v \\int_{0}^{\\tau} \\exp(-\\tau') d\\tau' = (1-\\omega) T_v \\left[-\\exp(-\\tau')\\right]_{0}^{\\tau} = (1-\\omega) T_v \\left(-\\exp(-\\tau) - (-\\exp(0))\\right)$$\n$$T_{b,2} = (1-\\omega) T_v (1 - \\exp(-\\tau))$$\n\n分量 3 ($T_{b,3}$): 该分量考虑了从冠层向下、被土壤反射的热发射。对于一个均匀的等温层，其底部的向下辐射通量与源自该层本身的向上辐射通量是对称的。因此，入射到土壤表面的向下亮温与 $T_{b,2}$ 的表达式形式相同：\n$$T_{b, \\text{down}} = (1-\\omega) T_v (1 - \\exp(-\\tau))$$\n这部分向下的辐射被土壤反射，土壤的反射率为 $r_s$。地表正上方的反射辐射亮温为 $r_s T_{b, \\text{down}}$。这股新产生的向上反射辐射在向上穿过整个冠层时再次被衰减，衰减因子为 $\\Gamma = \\exp(-\\tau)$。因此，第三个分量是：\n$$T_{b,3} = r_s \\left[ (1-\\omega) T_v (1 - \\exp(-\\tau)) \\right] \\exp(-\\tau)$$\n\n观测到的总亮温 $T_b$ 是这三部分之和：\n$$T_b = T_{b,1} + T_{b,2} + T_{b,3}$$\n$$T_b = \\varepsilon_s T_s \\exp(-\\tau) + (1-\\omega) T_v (1 - \\exp(-\\tau)) + r_s (1-\\omega) T_v (1 - \\exp(-\\tau)) \\exp(-\\tau)$$\n有了这个完整的表达式，我们现在评估所要求的两个渐近极限。\n\n**渐近状态 1：光学薄冠层 ($\\tau \\to 0$)**\n在 $\\tau \\to 0$ 的极限下，植被冠层变得有效透明。在数学上，这意味着 $\\exp(-\\tau) \\to 1$。我们可以分别评估每个分量的极限：\n$$\\lim_{\\tau \\to 0} T_{b,1} = \\lim_{\\tau \\to 0} \\varepsilon_s T_s \\exp(-\\tau) = \\varepsilon_s T_s (1) = \\varepsilon_s T_s$$\n$$\\lim_{\\tau \\to 0} T_{b,2} = \\lim_{\\tau \\to 0} (1-\\omega) T_v (1 - \\exp(-\\tau)) = (1-\\omega) T_v (1 - 1) = 0$$\n$$\\lim_{\\tau \\to 0} T_{b,3} = \\lim_{\\tau \\to 0} r_s (1-\\omega) T_v (1 - \\exp(-\\tau)) \\exp(-\\tau) = r_s (1-\\omega) T_v (1 - 1) (1) = 0$$\n将这些极限相加，得到该状态下的总亮温：\n$$\\lim_{\\tau \\to 0} T_b = \\varepsilon_s T_s + 0 + 0 = \\varepsilon_s T_s$$\n**物理解释**：此结果对应于“土壤主导”状态。随着植被冠层消失，其对发射和衰减的贡献变得可以忽略不计。辐射计“直接”看透到土壤表面，观测到的信号完全由裸土的发射决定。该发射是土壤物理温度 $T_s$ 与其发射率 $\\varepsilon_s$ 的乘积。\n\n**渐近状态 2：光学厚冠层 ($\\tau \\to \\infty$)**\n在 $\\tau \\to \\infty$ 的极限下，植被冠层变得完全不透明。在数学上，这意味着 $\\exp(-\\tau) \\to 0$。我们再次评估每个分量的极限：\n$$\\lim_{\\tau \\to \\infty} T_{b,1} = \\lim_{\\tau \\to \\infty} \\varepsilon_s T_s \\exp(-\\tau) = \\varepsilon_s T_s (0) = 0$$\n$$\\lim_{\\tau \\to \\infty} T_{b,2} = \\lim_{\\tau \\to \\infty} (1-\\omega) T_v (1 - \\exp(-\\tau)) = (1-\\omega) T_v (1 - 0) = (1-\\omega) T_v$$\n$$\\lim_{\\tau \\to \\infty} T_{b,3} = \\lim_{\\tau \\to \\infty} r_s (1-\\omega) T_v (1 - \\exp(-\\tau)) \\exp(-\\tau) = r_s (1-\\omega) T_v (1 - 0) (0) = 0$$\n将这些极限相加，得到该状态下的总亮温：\n$$\\lim_{\\tau \\to \\infty} T_b = 0 + (1-\\omega) T_v + 0 = (1-\\omega) T_v$$\n**物理解释**：此结果对应于“植被主导”状态。非常稠密的冠层完全遮蔽了土壤，使得土壤的贡献为零。观测到的辐射完全源自植被层，此时植被层表现为一个半无限的发射介质。其观测亮温是其有效发射率（即单次散射余反照率 $(1-\\omega)$）与其物理温度 $T_v$ 的乘积。散射的存在（非零的 $\\omega$）会降低与同温完美黑体相比的发射。\n\n因此，$T_b$ 的两个极限表达式分别为 $\\tau \\to 0$ 时的 $\\varepsilon_s T_s$ 和 $\\tau \\to \\infty$ 时的 $(1-\\omega)T_v$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\varepsilon_s T_s & (1 - \\omega) T_v\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了正向模型之后，下一步自然是将其“反演”——即从测量的亮温反向推算出植被光学厚度。本练习将指导您推导 VOD 的反演公式，并完成任何定量科学中的一项关键任务：不确定性传播。通过计算亮温测量中的微小误差如何影响最终的 VOD 估算值，您将深入了解反演算法的稳健性与敏感性 。",
            "id": "3810310",
            "problem": "一个天底观测、水平极化的L波段微波辐射计正在观测一个均匀植被覆盖的陆地表面，该过程使用微波辐射传输的平行平面、平板、$\\tau$–$\\omega$模型进行建模。在局部热力学平衡和瑞利-金斯近似下，此配置下的上行微波亮温 $T_b$ 可以用植被透射率 $\\gamma$、土壤发射率 $e_s$、单次散射反照率 $\\omega$、土壤有效热力学温度 $T_s$ 和冠层热力学温度 $T_c$ 来表示。天底观测的植被光学厚度（VOD）$\\tau$ 与透射率的关系为 $\\gamma = \\exp(-\\tau)$。假设在此场景的L波段，由冠层-土壤反射引起的相互作用项可以忽略不计。\n\n记录到一次观测数据，其测得的亮温为 $T_b$，相关的测量噪声标准差为 $\\sigma_T$。所有地球物理参数 $(e_s, \\omega, T_s, T_c)$ 均被视为已知且没有不确定性。提供以下数值：\n- $T_b = 281\\ \\mathrm{K}$，\n- $T_s = 300\\ \\mathrm{K}$，\n- $T_c = 295\\ \\mathrm{K}$，\n- $e_s = 0.95$，\n- $\\omega = 0.06$，\n- $\\sigma_T = 0.80\\ \\mathrm{K}$。\n\n从植被层的基本辐射传输概念和植被光学厚度（VOD）的定义出发，推导从 $T_b$ 到 $\\tau$ 的反演映射，然后使用一阶泰勒近似将测量噪声 $\\sigma_T$ 通过反演过程进行传播，以获得VOD的不确定性 $\\sigma_{\\tau}$。请用 $T_b$、$T_s$、$T_c$、$e_s$、$\\omega$ 和 $\\sigma_T$ 表示 $\\sigma_{\\tau}$，然后使用上述数值进行计算。将您最终的 $\\sigma_{\\tau}$ 数值结果四舍五入至三位有效数字。将最终的不确定性表示为无量纲量。",
            "solution": "### 解答推导\n在天底观测到的上行微波亮温 $T_b$ 可以建模为三个分量的总和：1) 来自植被冠层的直接上行辐射，2) 来自冠层的下行辐射被土壤反射后经冠层衰减的部分，以及 3) 来自土壤的辐射经冠层衰减的部分。\n\n冠层的天底观测透射率为 $\\gamma$。根据比尔-朗伯定律，它与植被光学厚度（VOD）$\\tau$ 的关系为 $\\gamma = \\exp(-\\tau)$。\n\n亮温的三个分量是：\n1.  来自冠层的上行辐射：$T_{c,up} = (1-\\omega)(1-\\gamma)T_c$。\n2.  来自冠层的下行辐射，被土壤反射后经冠层衰减：$T_{refl} = (1-e_s)(1-\\omega)(1-\\gamma)T_c\\gamma$。\n3.  来自土壤的辐射，经冠层衰减：$T_{s,att} = e_s T_s \\gamma$。\n\n总亮温为 $T_b = T_{c,up} + T_{refl} + T_{s,att}$。问题陈述中指明，由冠层-土壤反射引起的相互作用项（第二项，$T_{refl}$）可忽略不计。这使得辐射传输方程简化为：\n$$T_b = (1-\\omega)(1-\\gamma)T_c + e_s T_s \\gamma$$\n\n任务是推导从 $T_b$ 到 $\\tau$ 的反演映射。首先，我们求解方程以得到植被透射率 $\\gamma$。\n$$T_b = (1-\\omega)T_c - (1-\\omega)T_c\\gamma + e_s T_s \\gamma$$\n重新整理各项以分离出 $\\gamma$：\n$$T_b - (1-\\omega)T_c = \\gamma [e_s T_s - (1-\\omega)T_c]$$\n求解 $\\gamma$：\n$$\\gamma = \\frac{T_b - (1-\\omega)T_c}{e_s T_s - (1-\\omega)T_c}$$\nVOD $\\tau$ 由 $\\gamma = \\exp(-\\tau)$ 定义，因此 $\\tau = -\\ln(\\gamma)$。代入 $\\gamma$ 的表达式：\n$$\\tau = -\\ln\\left( \\frac{T_b - (1-\\omega)T_c}{e_s T_s - (1-\\omega)T_c} \\right)$$\n利用对数性质 $\\ln(a/b) = -\\ln(b/a)$，我们可以将反演映射 $\\tau(T_b)$ 写为：\n$$\\tau(T_b) = \\ln\\left( \\frac{e_s T_s - (1-\\omega)T_c}{T_b - (1-\\omega)T_c} \\right)$$\n\n接下来，我们传播测量不确定度 $\\sigma_T$ 以求出VOD的不确定度 $\\sigma_\\tau$。使用一阶泰勒级数近似进行误差传播，不确定度 $\\sigma_\\tau$ 由下式给出：\n$$\\sigma_\\tau = \\left| \\frac{d\\tau}{dT_b} \\right| \\sigma_T$$\n为了计算导数 $\\frac{d\\tau}{dT_b}$，我们可以将 $\\tau$ 重写为：\n$$\\tau(T_b) = \\ln\\left( e_s T_s - (1-\\omega)T_c \\right) - \\ln\\left( T_b - (1-\\omega)T_c \\right)$$\n第一项相对于 $T_b$ 是常数。对 $T_b$ 求导：\n$$\\frac{d\\tau}{dT_b} = 0 - \\frac{1}{T_b - (1-\\omega)T_c} \\cdot \\frac{d}{dT_b}\\left(T_b - (1-\\omega)T_c\\right)$$\n$$\\frac{d\\tau}{dT_b} = -\\frac{1}{T_b - (1-\\omega)T_c}$$\n将此导数代入误差传播公式：\n$$\\sigma_\\tau = \\left| -\\frac{1}{T_b - (1-\\omega)T_c} \\right| \\sigma_T = \\frac{\\sigma_T}{|T_b - (1-\\omega)T_c|}$$\n对于一个物理上有意义的正VOD，$\\tau$ 表达式中对数的参数必须大于1，这意味着 $e_s T_s - (1-\\omega)T_c > T_b - (1-\\omega)T_c > 0$。因此，绝对值内的项是正的，我们可以将VOD不确定度的表达式写为：\n$$\\sigma_\\tau = \\frac{\\sigma_T}{T_b - (1-\\omega)T_c}$$\n\n最后，我们使用给定值对该表达式进行数值计算：\n-   $T_b = 281\\ \\mathrm{K}$\n-   $T_c = 295\\ \\mathrm{K}$\n-   $\\omega = 0.06$\n-   $\\sigma_T = 0.80\\ \\mathrm{K}$\n\n首先，计算分母：\n$$T_b - (1-\\omega)T_c = 281 - (1 - 0.06) \\times 295$$\n$$T_b - (1-\\omega)T_c = 281 - (0.94) \\times 295$$\n$$T_b - (1-\\omega)T_c = 281 - 277.3 = 3.7\\ \\mathrm{K}$$\n现在，计算 $\\sigma_\\tau$：\n$$\\sigma_\\tau = \\frac{0.80}{3.7}$$\n$$\\sigma_\\tau \\approx 0.216216...$$\n问题要求将结果四舍五入到三位有效数字。\n$$\\sigma_\\tau \\approx 0.216$$\nVOD $\\tau$ 是一个无量纲量，因此其不确定度 $\\sigma_\\tau$ 也是无量纲的，因为温度单位（K）在计算中被消掉了。",
            "answer": "$$\\boxed{0.216}$$"
        },
        {
            "introduction": "简单的单变量反演很有用，但现实世界的遥感问题更为复杂；VOD 的信号常常与土壤湿度等其他变量的信号交织在一起。最后一个练习将介绍一种功能强大的现代方法：联合贝叶斯反演。您将探索一个概率框架，该框架可以同时估算 VOD 和土壤湿度，并利用它们之间关系的先验知识来提高两者的估算精度。本练习展示了如何从确定性计算过渡到更复杂的统计估算，这正是许多现代地球物理反演算法的核心 。",
            "id": "3810352",
            "problem": "考虑在一个基于贝叶斯推断的概率状态空间框架内，利用被动微波观测联合反演植被光学厚度 (VOD) 和地表土壤湿度。设未知状态向量为 $\\mathbf{x} \\in \\mathbb{R}^2$，其分量为 $\\mathbf{x} = [\\tau, s]^\\top$，其中 $\\tau$ 表示植被光学厚度（无量纲），$s$ 表示体积地表土壤湿度（无量纲，单位为立方米/立方米）。设 $\\mathbf{x}$ 的先验（背景）分布为高斯分布，其均值为 $\\mathbf{x}_b$，协方差矩阵为 $\\mathbf{B} \\in \\mathbb{R}^{2 \\times 2}$。设观测向量为 $\\mathbf{y} \\in \\mathbb{R}^m$，表示单位为开尔文的亮温，并经过预中心化处理，使得线性化观测模型为\n$\\mathbf{y} \\approx \\mathbf{H} \\mathbf{x} + \\boldsymbol{\\varepsilon}$，\n其中 $\\mathbf{H} \\in \\mathbb{R}^{m \\times 2}$ 是一个已知的灵敏度（雅可比）矩阵，该矩阵源于一个基于物理的辐射传输模型在名义状态附近线性化得到，而 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R})$ 是零均值高斯观测误差，其协方差为 $\\mathbf{R} \\in \\mathbb{R}^{m \\times m}$。所有亮温都必须以开尔文为单位处理，$\\tau$ 和 $s$ 均为无量纲。本问题不涉及角度，因此不需要角度单位。\n\n你的任务是在上述线性高斯假设下，实现一个联合贝叶斯反演，为几个测试用例计算后验（分析）均值 $\\mathbf{x}_a$ 和后验协方差 $\\mathbf{A}$，并量化 $\\tau$ 和 $s$ 之间的先验交叉协方差在约束这两个状态中的作用。具体而言，对于每个测试用例：\n- 计算后验均值 $\\mathbf{x}_a$ 和后验协方差 $\\mathbf{A}$。\n- 从 $\\mathbf{A}$ 计算后验标准差 $\\sigma_{\\tau,a}$ 和 $\\sigma_{s,a}$，以及后验相关系数 $\\rho_a = A_{12} / (\\sigma_{\\tau,a} \\, \\sigma_{s,a})$。\n- 报告后验均值和这些不确定性度量。\n\n使用以下测试套件，其中所有数字必须按给定值精确解释，所有矩阵均按自然的行主序排列。$\\mathbf{y}$ 中的每个亮温单位均为开尔文。状态变量 $\\tau$ 和 $s$ 是无量纲的。对于每个用例，$\\mathbf{x}_b = [0.5, 0.2]^\\top$。\n\n- 测试用例 1（单次观测，非零先验交叉协方差）：\n  - $\\mathbf{y} = \\begin{bmatrix} 1.0 \\end{bmatrix}$\n  - $\\mathbf{H} = \\begin{bmatrix} 0.6 & -5.0 \\end{bmatrix}$\n  - $\\mathbf{R} = \\begin{bmatrix} 4.0 \\end{bmatrix}$\n  - $\\mathbf{B} = \\begin{bmatrix} 0.04 & -0.005 \\\\ -0.005 & 0.01 \\end{bmatrix}$\n\n- 测试用例 2（单次观测，零先验交叉协方差）：\n  - $\\mathbf{y} = \\begin{bmatrix} 1.0 \\end{bmatrix}$\n  - $\\mathbf{H} = \\begin{bmatrix} 0.6 & -5.0 \\end{bmatrix}$\n  - $\\mathbf{R} = \\begin{bmatrix} 4.0 \\end{bmatrix}$\n  - $\\mathbf{B} = \\begin{bmatrix} 0.04 & 0.0 \\\\ 0.0 & 0.01 \\end{bmatrix}$\n\n- 测试用例 3（两次观测，零先验交叉协方差）：\n  - $\\mathbf{y} = \\begin{bmatrix} 1.0 \\\\ 0.0 \\end{bmatrix}$\n  - $\\mathbf{H} = \\begin{bmatrix} 0.6 & -5.0 \\\\ 0.4 & -3.0 \\end{bmatrix}$\n  - $\\mathbf{R} = \\begin{bmatrix} 4.0 & 0.0 \\\\ 0.0 & 4.0 \\end{bmatrix}$\n  - $\\mathbf{B} = \\begin{bmatrix} 0.04 & 0.0 \\\\ 0.0 & 0.01 \\end{bmatrix}$\n\n- 测试用例 4（单次观测，对 $\\tau$ 灵敏度弱，正先验交叉协方差）：\n  - $\\mathbf{y} = \\begin{bmatrix} 1.0 \\end{bmatrix}$\n  - $\\mathbf{H} = \\begin{bmatrix} 0.01 & -5.0 \\end{bmatrix}$\n  - $\\mathbf{R} = \\begin{bmatrix} 4.0 \\end{bmatrix}$\n  - $\\mathbf{B} = \\begin{bmatrix} 0.04 & 0.006 \\\\ 0.006 & 0.01 \\end{bmatrix}$\n\n对于每个测试用例，你的程序必须按顺序输出以下值：\n- $\\tau_a$（$\\tau$ 的后验均值），\n- $s_a$（$s$ 的后验均值），\n- $\\sigma_{\\tau,a}$，\n- $\\sigma_{s,a}$，\n- $\\rho_a$。\n\n将所有四个测试用例的结果按测试用例 1 到 4 的顺序汇总到一个列表中。将每个报告值四舍五入到恰好 $6$ 位小数。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,\\dots,r_{20}]$）。",
            "solution": "我们使用线性高斯贝叶斯推断来构建反演，该方法源于贝叶斯定理和多元正态分布的性质。其基本依据是以下假设：状态的先验分布和观测的似然函数均为高斯分布，并且在对辐射传输模型进行适当的线性化之后，观测算子是状态的线性函数。\n\n设未知状态为 $\\mathbf{x} \\in \\mathbb{R}^2$，其先验分布为 $\\mathbf{x} \\sim \\mathcal{N}(\\mathbf{x}_b, \\mathbf{B})$，其中 $\\mathbf{x}_b \\in \\mathbb{R}^2$ 且 $\\mathbf{B} \\in \\mathbb{R}^{2 \\times 2}$。设观测值为 $\\mathbf{y} \\in \\mathbb{R}^m$，其线性观测模型为\n$$\n\\mathbf{y} = \\mathbf{H}\\mathbf{x} + \\boldsymbol{\\varepsilon}, \\quad \\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R}),\n$$\n其中 $\\mathbf{H} \\in \\mathbb{R}^{m \\times 2}$ 且 $\\mathbf{R} \\in \\mathbb{R}^{m \\times m}$ 是正定的。高斯先验和高斯似然意味着在给定 $\\mathbf{y}$ 的条件下，$\\mathbf{x}$ 的后验分布也是高斯分布。通过对联合密度的指数部分进行配方（或应用条件高斯分布的标准结果），可以得到后验均值 $\\mathbf{x}_a$ 和后验协方差 $\\mathbf{A}$：\n$$\n\\mathbf{S} = \\mathbf{H}\\mathbf{B}\\mathbf{H}^\\top + \\mathbf{R}, \\quad \\mathbf{K} = \\mathbf{B}\\mathbf{H}^\\top \\mathbf{S}^{-1},\n$$\n$$\n\\mathbf{x}_a = \\mathbf{x}_b + \\mathbf{K}\\left(\\mathbf{y} - \\mathbf{H}\\mathbf{x}_b\\right), \\quad \\mathbf{A} = \\left(\\mathbf{I} - \\mathbf{K}\\mathbf{H}\\right)\\mathbf{B},\n$$\n其中 $\\mathbf{S} \\in \\mathbb{R}^{m \\times m}$ 是新息协方差，$\\mathbf{K} \\in \\mathbb{R}^{2 \\times m}$ 是卡尔曼增益。这些表达式是线性高斯假设下贝叶斯定理的直接推论，除了多元正态条件化的核心定义外，不需要任何捷径公式。\n\n从 $\\mathbf{A}$ 中，我们计算后验边际标准差和相关系数：\n$$\n\\sigma_{\\tau,a} = \\sqrt{A_{11}}, \\quad \\sigma_{s,a} = \\sqrt{A_{22}}, \\quad \\rho_a = \\frac{A_{12}}{\\sigma_{\\tau,a}\\sigma_{s,a}}.\n$$\n先验交叉协方差的作用体现在 $\\mathbf{B}$ 的非对角元素中。当 $B_{12} \\neq 0$ 时，卡尔曼增益 $\\mathbf{K} = \\mathbf{B}\\mathbf{H}^\\top \\mathbf{S}^{-1}$ 会继承一些分量，这些分量将一个状态变量的更新与另一个状态变量的观测灵敏度耦合起来，从而允许信息在 $\\tau$ 和 $s$ 之间传递。即使观测对其中一个状态变量的灵敏度很弱，这种交叉协方差也可以减少两个状态的后验不确定性，这一现象被称为“通过先验的耦合约束”。\n\n我们现在将此框架应用于指定的测试用例。对于每个用例，我们构造 $\\mathbf{S}$，计算 $\\mathbf{K}$，计算 $\\mathbf{x}_a$ 和 $\\mathbf{A}$，然后提取 $\\tau_a$、$s_a$、$\\sigma_{\\tau,a}$、$\\sigma_{s,a}$ 和 $\\rho_a$。所有计算都是使用给定的 $\\mathbf{y}$、$\\mathbf{H}$、$\\mathbf{R}$、$\\mathbf{x}_b$ 和 $\\mathbf{B}$ 进行的确定性线性代数运算。我们按要求将每个报告值四舍五入到 $6$ 位小数。输出是一个单一列表，按顺序连接测试用例 1 到 4 的结果：\n$$\n[\\tau_{a,1}, s_{a,1}, \\sigma_{\\tau,a,1}, \\sigma_{s,a,1}, \\rho_{a,1}, \\ \\tau_{a,2}, s_{a,2}, \\sigma_{\\tau,a,2}, \\sigma_{s,a,2}, \\rho_{a,2}, \\ \\tau_{a,3}, s_{a,3}, \\sigma_{\\tau,a,3}, \\sigma_{s,a,3}, \\rho_{a,3}, \\ \\tau_{a,4}, s_{a,4}, \\sigma_{\\tau,a,4}, \\sigma_{s,a,4}, \\rho_{a,4}],\n$$\n其中每个条目都四舍五入到 $6$ 位小数。单位如下：$\\mathbf{y}$ 的亮温单位为开尔文，状态分量 $\\tau$ 和 $s$ 无量纲；标准差无量纲；相关系数根据定义也是无量纲的。\n\n通过比较测试用例 1 和 2，我们在保持观测模型固定的情况下，分离出非零与零先验交叉协方差的影响。测试用例 3 展示了多个观测如何在不依赖先验交叉协方差的情况下约束两个状态。测试用例 4 演示了当观测算子对 $\\tau$ 的直接灵敏度较弱时，正的先验交叉协方差如何有效地将观测信息传播到 $\\tau$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef posterior_linear_gaussian(xb, B, H, R, y):\n    \"\"\"\n    Compute the posterior (analysis) mean and covariance for a linear-Gaussian model:\n        y = H x + e,   e ~ N(0, R)\n        x ~ N(xb, B)\n    Returns:\n        xa, A\n    \"\"\"\n    # Ensure arrays\n    xb = np.asarray(xb).reshape(-1, 1)         # (n,1)\n    H = np.asarray(H)                          # (m,n)\n    y = np.asarray(y).reshape(-1, 1)           # (m,1)\n    B = np.asarray(B)                          # (n,n)\n    R = np.asarray(R)                          # (m,m)\n\n    # Innovation covariance S and Kalman gain K\n    S = H @ B @ H.T + R                        # (m,m)\n    # Use solve for numerical stability\n    K = B @ H.T @ np.linalg.inv(S)             # (n,m)\n\n    # Analysis mean\n    innovation = y - (H @ xb)                  # (m,1)\n    xa = xb + K @ innovation                   # (n,1)\n\n    # Analysis covariance (Joseph form not needed here; standard is fine)\n    A = (np.eye(B.shape[0]) - K @ H) @ B\n\n    return xa, A\n\ndef summarize_posterior(xa, A):\n    \"\"\"\n    Extract tau_a, s_a, sigma_tau_a, sigma_s_a, rho_a from xa and A.\n    \"\"\"\n    tau_a = float(xa[0, 0])\n    s_a = float(xa[1, 0])\n    sigma_tau_a = float(np.sqrt(max(A[0, 0], 0.0)))\n    sigma_s_a = float(np.sqrt(max(A[1, 1], 0.0)))\n    # Handle numerical edge cases for correlation\n    if sigma_tau_a > 0 and sigma_s_a > 0:\n        rho_a = float(A[0, 1] / (sigma_tau_a * sigma_s_a))\n    else:\n        rho_a = 0.0\n    return tau_a, s_a, sigma_tau_a, sigma_s_a, rho_a\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    xb = np.array([0.5, 0.2])  # prior mean for all cases\n\n    test_cases = [\n        # Each case: dict with y, H, R, B\n        {\n            \"y\": np.array([1.0]),\n            \"H\": np.array([[0.6, -5.0]]),\n            \"R\": np.array([[4.0]]),\n            \"B\": np.array([[0.04, -0.005],\n                           [-0.005, 0.01]])\n        },\n        {\n            \"y\": np.array([1.0]),\n            \"H\": np.array([[0.6, -5.0]]),\n            \"R\": np.array([[4.0]]),\n            \"B\": np.array([[0.04, 0.0],\n                           [0.0, 0.01]])\n        },\n        {\n            \"y\": np.array([1.0, 0.0]),\n            \"H\": np.array([[0.6, -5.0],\n                           [0.4, -3.0]]),\n            \"R\": np.array([[4.0, 0.0],\n                           [0.0, 4.0]]),\n            \"B\": np.array([[0.04, 0.0],\n                           [0.0, 0.01]])\n        },\n        {\n            \"y\": np.array([1.0]),\n            \"H\": np.array([[0.01, -5.0]]),\n            \"R\": np.array([[4.0]]),\n            \"B\": np.array([[0.04, 0.006],\n                           [0.006, 0.01]])\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        xa, A = posterior_linear_gaussian(\n            xb=xb,\n            B=case[\"B\"],\n            H=case[\"H\"],\n            R=case[\"R\"],\n            y=case[\"y\"]\n        )\n        tau_a, s_a, sigma_tau_a, sigma_s_a, rho_a = summarize_posterior(xa, A)\n        # Round to exactly 6 decimals in output\n        results.extend([\n            f\"{tau_a:.6f}\",\n            f\"{s_a:.6f}\",\n            f\"{sigma_tau_a:.6f}\",\n            f\"{sigma_s_a:.6f}\",\n            f\"{rho_a:.6f}\"\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}