{
    "hands_on_practices": [
        {
            "introduction": "Understanding the complex dance of light with a surface begins with the simplest case: a perfectly smooth interface. This exercise grounds our study in fundamental physics by asking you to derive the Fresnel equations from electromagnetic boundary conditions. By applying these principles to the real-world remote sensing phenomenon of sunglint on water, you will see how unpolarized sunlight becomes polarized upon reflection, a critical concept in both passive and active remote sensing applications .",
            "id": "3857433",
            "problem": "A remote imaging spectropolarimeter observes a sunglint event over a deep, optically smooth water surface. The water can be modeled as a non-magnetic, isotropic, lossless dielectric with refractive index $n_{2} = 1.33$ at the observed wavelength, and the atmosphere above it is approximated as a non-absorbing medium with refractive index $n_{1} = 1.000$. A collimated, unpolarized beam of solar radiance arrives from the atmosphere onto the flat water surface at an incidence angle $\\theta_{i} = 60^{\\circ}$ measured from the surface normal. The instrument is positioned in the mirror (specular) direction, so the reflected direction satisfies the law of reflection.\n\nStarting from the electromagnetic boundary conditions at a planar interface (continuity of tangential components of the electric and magnetic fields) together with phase-matching at the boundary, derive the amplitude reflection coefficients for the two orthogonal linear polarization states defined with respect to the plane of incidence: the polarization with the electric field perpendicular to the plane of incidence ($s$-polarization) and the polarization with the electric field parallel to the plane of incidence ($p$-polarization). Using these, obtain the corresponding reflectance coefficients $F_{s}$ and $F_{p}$ (the ratios of reflected to incident irradiance for $s$ and $p$), evaluated at the given $\\theta_{i}$ and refractive indices.\n\nAssume the Bidirectional Reflectance Distribution Function (BRDF) of the water surface near the specular direction is dominated by the Fresnel specular term from this planar interface. Using conservation of energy and the definition of degree of linear polarization for the reflected beam collected at the specular direction, predict the degree of linear polarization as a dimensionless fraction for the reflected radiance measured by the instrument. Express your final answer as three numbers in the order $F_{s}$, $F_{p}$, and the degree of linear polarization. Round each to four significant figures. Angles must be treated in degrees throughout.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of classical electromagnetism, specifically the behavior of electromagnetic waves at a dielectric interface. The problem is well-posed, providing all necessary information ($n_1=1.000$, $n_2=1.33$, $\\theta_i=60^{\\circ}$, unpolarized incident light) to derive the Fresnel equations and compute the required quantities. The language is objective and the scenario is physically realistic.\n\nWe begin by establishing the geometric and physical framework. Let the interface between the two media be the $z=0$ plane. The plane of incidence is the $x-z$ plane. An incident plane electromagnetic wave travels in medium $1$ (refractive index $n_1$) and strikes the interface, giving rise to a reflected wave in medium $1$ and a transmitted wave in medium $2$ (refractive index $n_2$). The incident, reflected, and transmitted electric fields can be written as:\n$$ \\vec{E}_i(\\vec{r}, t) = \\vec{E}_{0i} \\exp[i(\\vec{k}_i \\cdot \\vec{r} - \\omega t)] $$\n$$ \\vec{E}_r(\\vec{r}, t) = \\vec{E}_{0r} \\exp[i(\\vec{k}_r \\cdot \\vec{r} - \\omega t)] $$\n$$ \\vec{E}_t(\\vec{r}, t) = \\vec{E}_{0t} \\exp[i(\\vec{k}_t \\cdot \\vec{r} - \\omega t)] $$\nThe wave vectors are given by $\\vec{k}_i = k_1(\\sin\\theta_i \\hat{x} + \\cos\\theta_i \\hat{z})$, $\\vec{k}_r = k_1(\\sin\\theta_r \\hat{x} - \\cos\\theta_r \\hat{z})$, and $\\vec{k}_t = k_2(\\sin\\theta_t \\hat{x} + \\cos\\theta_t \\hat{z})$, where $k_1 = n_1 \\omega/c$ and $k_2 = n_2 \\omega/c$.\n\nThe electromagnetic boundary conditions require the tangential components of the electric field $\\vec{E}$ and magnetic field $\\vec{H}$ to be continuous across the interface at $z=0$. For these conditions to hold for all points on the interface and for all time, the phases of the three waves must be equal at $z=0$. This phase-matching condition, $(\\vec{k}_i \\cdot \\vec{r})_{z=0} = (\\vec{k}_r \\cdot \\vec{r})_{z=0} = (\\vec{k}_t \\cdot \\vec{r})_{z=0}$, leads to two fundamental laws:\n$1$. The law of reflection: $\\theta_i = \\theta_r$.\n$2$. Snell's law: $n_1 \\sin\\theta_i = n_2 \\sin\\theta_t$.\n\nThe boundary conditions are:\n$1$. $(\\vec{E}_i + \\vec{E}_r)_{\\parallel} = (\\vec{E}_t)_{\\parallel}$\n$2$. $(\\vec{H}_i + \\vec{H}_r)_{\\parallel} = (\\vec{H}_t)_{\\parallel}$\n\nWe now derive the amplitude reflection coefficients for the two orthogonal polarization states.\n\n**1. Perpendicular ($s$-) Polarization**\nFor $s$-polarization, the electric field vector is perpendicular to the plane of incidence, i.e., in the $y$-direction.\n$\\vec{E}_i = E_{0i} \\hat{y}$, $\\vec{E}_r = E_{0r} \\hat{y}$, $\\vec{E}_t = E_{0t} \\hat{y}$.\nThe first boundary condition (continuity of tangential $\\vec{E}$) gives:\n$$ E_{0i} + E_{0r} = E_{0t} $$\nThe magnetic field is related to the electric field by $\\vec{H} = \\frac{1}{\\mu_0 \\omega} (\\vec{k} \\times \\vec{E})$. The tangential component of $\\vec{H}$ lies in the $x$-direction.\n$H_{ix} = -H_i \\cos\\theta_i = -\\frac{n_1}{c\\mu_0} E_{0i} \\cos\\theta_i$.\n$H_{rx} = H_r \\cos\\theta_r = \\frac{n_1}{c\\mu_0} E_{0r} \\cos\\theta_i$ (The sign is positive as the $z$-component of $\\vec{k}_r$ is negative).\n$H_{tx} = -H_t \\cos\\theta_t = -\\frac{n_2}{c\\mu_0} E_{0t} \\cos\\theta_t$.\nThe second boundary condition (continuity of tangential $\\vec{H}$) gives:\n$$ -\\frac{n_1}{c\\mu_0} E_{0i} \\cos\\theta_i + \\frac{n_1}{c\\mu_0} E_{0r} \\cos\\theta_i = -\\frac{n_2}{c\\mu_0} E_{0t} \\cos\\theta_t $$\n$$ n_1 \\cos\\theta_i (E_{0i} - E_{0r}) = n_2 \\cos\\theta_t E_{0t} $$\nSubstituting $E_{0t} = E_{0i} + E_{0r}$ into this equation:\n$$ n_1 \\cos\\theta_i (E_{0i} - E_{0r}) = n_2 \\cos\\theta_t (E_{0i} + E_{0r}) $$\nSolving for the amplitude reflection coefficient $r_s = E_{0r}/E_{0i}$:\n$$ E_{0r} (-n_1 \\cos\\theta_i - n_2 \\cos\\theta_t) = E_{0i} (n_2 \\cos\\theta_t - n_1 \\cos\\theta_i) $$\n$$ r_s = \\frac{E_{0r}}{E_{0i}} = \\frac{n_1 \\cos\\theta_i - n_2 \\cos\\theta_t}{n_1 \\cos\\theta_i + n_2 \\cos\\theta_t} $$\n\n**2. Parallel ($p$-) Polarization**\nFor $p$-polarization, the magnetic field vector is perpendicular to the plane of incidence, i.e., in the $y$-direction.\n$\\vec{H}_i = H_{0i} \\hat{y}$, $\\vec{H}_r = H_{0r} \\hat{y}$, $\\vec{H}_t = H_{0t} \\hat{y}$.\nThe second boundary condition gives:\n$$ H_{0i} + H_{0r} = H_{0t} $$\nThe electric field lies in the $x-z$ plane. The tangential component is in the $x$-direction. For non-magnetic media, $E = Z H = \\frac{Z_0}{n} H$, where $Z_0=\\sqrt{\\mu_0/\\epsilon_0}$.\n$E_{ix} = E_i \\cos\\theta_i = \\frac{Z_0}{n_1} H_{0i} \\cos\\theta_i$.\n$E_rx = -E_r \\cos\\theta_r = -\\frac{Z_0}{n_1} H_{0r} \\cos\\theta_i$.\n$E_{tx} = E_t \\cos\\theta_t = \\frac{Z_0}{n_2} H_{0t} \\cos\\theta_t$.\nThe first boundary condition gives:\n$$ \\frac{Z_0}{n_1} H_{0i} \\cos\\theta_i - \\frac{Z_0}{n_1} H_{0r} \\cos\\theta_i = \\frac{Z_0}{n_2} H_{0t} \\cos\\theta_t $$\n$$ \\frac{\\cos\\theta_i}{n_1} (H_{0i} - H_{0r}) = \\frac{\\cos\\theta_t}{n_2} H_{0t} $$\nSubstituting $H_{0t} = H_{0i} + H_{0r}$:\n$$ \\frac{\\cos\\theta_i}{n_1} (H_{0i} - H_{0r}) = \\frac{\\cos\\theta_t}{n_2} (H_{0i} + H_{0r}) $$\nThe amplitude reflection coefficient for the electric field, $r_p = E_{0r}/E_{0i}$, is commonly used. With the sign conventions for the fields ($E_{r} \\propto -H_r$, $E_{i} \\propto H_i$), we find $r_p = -H_{0r}/H_{0i}$. However, different conventions exist. A direct derivation for $r_p$ (or using the equivalence shown in many standard texts) gives:\n$$ r_p = \\frac{E_{0r}}{E_{0i}} = \\frac{n_2 \\cos\\theta_i - n_1 \\cos\\theta_t}{n_2 \\cos\\theta_i + n_1 \\cos\\theta_t} $$\n\n**Numerical Evaluation**\nGiven values are $n_1 = 1.000$, $n_2 = 1.33$, and $\\theta_i = 60^{\\circ}$.\nFirst, find the transmission angle $\\theta_t$ from Snell's Law: $n_1 \\sin\\theta_i = n_2 \\sin\\theta_t$.\n$$ \\sin\\theta_t = \\frac{n_1}{n_2} \\sin\\theta_i = \\frac{1.000}{1.33} \\sin(60^{\\circ}) \\approx 0.651147 $$\n$$ \\theta_t = \\arcsin(0.651147) \\approx 40.6272^{\\circ} $$\nWe also need the cosines of the angles:\n$\\cos\\theta_i = \\cos(60^{\\circ}) = 0.5$\n$\\cos\\theta_t = \\cos(40.6272^{\\circ}) \\approx 0.758954$\n\nNow we can calculate the reflectance coefficients $F_s$ and $F_p$, which are the ratios of reflected to incident irradiance and are equal to the square of the moduli of the amplitude reflection coefficients: $F = |r|^2$.\nFor $s$-polarization:\n$$ r_s = \\frac{1.000 \\times 0.5 - 1.33 \\times 0.758954}{1.000 \\times 0.5 + 1.33 \\times 0.758954} = \\frac{0.5 - 1.009409}{0.5 + 1.009409} \\approx -0.33751 $$\n$$ F_s = |r_s|^2 \\approx (-0.33751)^2 \\approx 0.113915 $$\nFor $p$-polarization:\n$$ r_p = \\frac{1.33 \\times 0.5 - 1.000 \\times 0.758954}{1.33 \\times 0.5 + 1.000 \\times 0.758954} = \\frac{0.665 - 0.758954}{0.665 + 0.758954} \\approx -0.065981 $$\n$$ F_p = |r_p|^2 \\approx (-0.065981)^2 \\approx 0.0043535 $$\n\n**Degree of Linear Polarization**\nThe incident solar radiation is unpolarized, meaning it contains equal irradiances of $s$- and $p$-polarized light. Let the total incident irradiance be $I_i$. Then $I_{is} = I_{ip} = I_i/2$.\nThe reflected irradiances for each component are:\n$I_{rs} = F_s I_{is} = F_s (I_i/2)$\n$I_{rp} = F_p I_{ip} = F_p (I_i/2)$\nThe Degree of Linear Polarization (DoLP) of the reflected beam is defined as the normalized difference between the orthogonal polarized components:\n$$ \\text{DoLP} = \\frac{|I_{rs} - I_{rp}|}{I_{rs} + I_{rp}} $$\nSubstituting the expressions for reflected irradiances:\n$$ \\text{DoLP} = \\frac{|F_s (I_i/2) - F_p (I_i/2)|}{F_s (I_i/2) + F_p (I_i/2)} = \\frac{|F_s - F_p|}{F_s + F_p} $$\nUsing the calculated values for $F_s$ and $F_p$:\n$$ \\text{DoLP} = \\frac{|0.113915 - 0.0043535|}{0.113915 + 0.0043535} = \\frac{0.1095615}{0.1182685} \\approx 0.92638 $$\nRounding the final results to four significant figures:\n$F_s \\approx 0.1139$\n$F_p \\approx 0.004354$\n$\\text{DoLP} \\approx 0.9264$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.1139  0.004354  0.9264 \\end{pmatrix} } $$"
        },
        {
            "introduction": "While many surfaces can be modeled as randomly rough, others exhibit distinct anisotropy due to organized, macroscopic structures like the rows of a plowed field. This practice challenges you to think like a modeler, constructing a simple but physically meaningful Bidirectional Reflectance Distribution Function (BRDF) from first principles. By incorporating constraints such as reciprocity and the expected azimuthal patterns, you will learn how to translate qualitative physical intuition into a quantitative, analytical model that captures directional reflectance effects .",
            "id": "3857417",
            "problem": "A plowed agricultural field presents anisotropy in its bidirectional reflectance due to row-and-furrow microgeometry. Consider a non-emitting surface under collimated solar illumination with solar zenith angle $\\theta_{s} \\in [0, \\pi/2)$, sensor zenith angle $\\theta_{v} \\in [0, \\pi/2)$, and relative azimuth $\\Delta\\phi \\in [0, 2\\pi)$. The Bidirectional Reflectance Distribution Function (BRDF) $f_{r}(\\theta_{s}, \\theta_{v}, \\Delta\\phi)$ is defined as the ratio of differential radiance to differential irradiance, so that for a collimated beam $L = f_{r} E_{0} \\cos\\theta_{s}$, where $L$ is radiance and $E_{0}$ is the incident irradiance. Define the directional reflectance factor $r(\\theta_{s}, \\theta_{v}, \\Delta\\phi) := \\pi f_{r}(\\theta_{s}, \\theta_{v}, \\Delta\\phi)$.\n\nFurrows aligned at azimuth $\\phi_{0} \\in [0, 2\\pi)$ introduce an azimuthal anisotropy. Starting from the core principles that (i) $f_{r}$ is a function of viewing and illumination geometry through $\\theta_{s}$, $\\theta_{v}$, and $\\Delta\\phi$, (ii) $f_{r}$ reduces to an isotropic Lambertian form when anisotropy vanishes, (iii) $f_{r}$ respects reciprocity under interchange of $\\theta_{s}$ and $\\theta_{v}$, and (iv) the leading azimuthal harmonic for a row-induced anisotropy is proportional to $\\cos(\\Delta\\phi - \\phi_{0})$, construct the simplest additive model $f_{r}$ that satisfies these conditions and that ensures the anisotropy vanishes when either $\\theta_{s}=0$ or $\\theta_{v}=0$. Use two positive parameters: a Lambertian-equivalent reflectance scale $\\rho \\in (0, 1)$ and an anisotropy amplitude $\\alpha \\in (0, \\rho)$.\n\nThen, using your constructed $f_{r}$, compute the difference in directional reflectance factor between along-row viewing and across-row viewing for fixed $\\theta_{s}$ and $\\theta_{v}$, where along-row is defined by $\\Delta\\phi = \\phi_{0}$ and across-row is defined by $\\Delta\\phi = \\phi_{0} + \\pi/2$. Express your final answer as a single closed-form analytic expression in terms of the model parameters and angles. All angles must be treated in radians. The final answer is dimensionless. No rounding is required.",
            "solution": "The user wants to construct a Bidirectional Reflectance Distribution Function (BRDF) model for a surface with row-induced anisotropy and then use it to compare reflectance in specific viewing directions.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\n- **Geometric variables**: Solar zenith angle $\\theta_{s} \\in [0, \\pi/2)$, sensor zenith angle $\\theta_{v} \\in [0, \\pi/2)$, and relative azimuth angle $\\Delta\\phi \\in [0, 2\\pi)$.\n- **Definitions**:\n    - BRDF: $f_{r}(\\theta_{s}, \\theta_{v}, \\Delta\\phi)$.\n    - Directional reflectance factor: $r(\\theta_{s}, \\theta_{v}, \\Delta\\phi) := \\pi f_{r}(\\theta_{s}, \\theta_{v}, \\Delta\\phi)$.\n    - Furrow alignment azimuth: $\\phi_{0} \\in [0, 2\\pi)$.\n- **Model Construction Conditions**:\n    1. $f_{r}$ is a function of $\\theta_{s}$, $\\theta_{v}$, and $\\Delta\\phi$.\n    2. $f_{r}$ reduces to an isotropic Lambertian form when anisotropy vanishes.\n    3. $f_{r}$ respects reciprocity: $f_{r}(\\theta_{s}, \\theta_{v}, \\Delta\\phi) = f_{r}(\\theta_{v}, \\theta_{s}, \\Delta\\phi)$.\n    4. The leading azimuthal harmonic for row-induced anisotropy is proportional to $\\cos(\\Delta\\phi - \\phi_{0})$.\n    5. The model is the simplest additive model satisfying these conditions.\n    6. The anisotropy vanishes when $\\theta_{s}=0$ or $\\theta_{v}=0$.\n- **Model Parameters**:\n    - Lambertian-equivalent reflectance scale: $\\rho \\in (0, 1)$.\n    - Anisotropy amplitude: $\\alpha \\in (0, \\rho)$.\n- **Task**:\n    1. Construct the model for $f_{r}$.\n    2. Compute the difference in the directional reflectance factor, $r$, between along-row ($\\Delta\\phi = \\phi_{0}$) and across-row ($\\Delta\\phi = \\phi_{0} + \\pi/2$) viewing directions.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the field of radiometry and remote sensing. The concepts of BRDF, directional reflectance factor, and anisotropy due to surface structure are standard. The principle of reciprocity is fundamental. The use of a simple harmonic function to model azimuthal dependence is a common and valid simplification. The constraints provided are self-contained, mathematically consistent, and physically plausible. The given parameter ranges, $\\rho \\in (0, 1)$ and $\\alpha \\in (0, \\rho)$, ensure the physical validity (non-negativity) of the resulting BRDF model, as will be demonstrated. The problem is well-posed and leads to a unique solution under the \"simplest model\" constraint. Therefore, the problem is valid.\n\n### Step 3: Action\nThe problem is valid. I will proceed with a full solution.\n\nThe task is to construct the simplest additive model for the BRDF, $f_{r}$, based on the given conditions. An additive model can be expressed as the sum of an isotropic component and an anisotropic component:\n$$f_{r}(\\theta_{s}, \\theta_{v}, \\Delta\\phi) = f_{iso}(\\theta_{s}, \\theta_{v}, \\Delta\\phi) + f_{aniso}(\\theta_{s}, \\theta_{v}, \\Delta\\phi)$$\n\n1.  **Isotropic Component ($f_{iso}$)**: Condition (ii) states that the BRDF should reduce to an isotropic Lambertian form. A Lambertian surface has a constant BRDF given by $f_{L} = R/\\pi$, where $R$ is the surface reflectance (or albedo). The problem provides a Lambertian-equivalent reflectance scale parameter $\\rho$. Thus, the isotropic part of the model is:\n    $$f_{iso} = \\frac{\\rho}{\\pi}$$\n    This term is independent of viewing and illumination angles, consistent with isotropy.\n\n2.  **Anisotropic Component ($f_{aniso}$)**: This component must capture the directional effects described by the remaining conditions.\n    - Condition (iv) specifies that the leading azimuthal harmonic is proportional to $\\cos(\\Delta\\phi - \\phi_{0})$. This dictates the dependence on the relative azimuth angle.\n    - Condition (vi) requires the anisotropy to vanish for nadir illumination ($\\theta_{s}=0$) or nadir viewing ($\\theta_{v}=0$). A simple mathematical function that satisfies this is the product of terms that are zero when the angles are zero. The simplest non-trivial choice that is standard in physical models (relating to projected areas) is $\\sin(\\theta_{s}) \\sin(\\theta_{v})$.\n    - Condition (iii), reciprocity, requires that $f_{r}(\\theta_{s}, \\theta_{v}, \\Delta\\phi) = f_{r}(\\theta_{v}, \\theta_{s}, \\Delta\\phi)$. Since $f_{iso}$ and the azimuthal term $\\cos(\\Delta\\phi - \\phi_{0})$ are already symmetric under the exchange of source and viewer (as $\\Delta\\phi$ is the same), the geometric term dependent on zenith angles must also be symmetric. The chosen function $\\sin(\\theta_{s}) \\sin(\\theta_{v})$ is indeed symmetric: $\\sin(\\theta_{s}) \\sin(\\theta_{v}) = \\sin(\\theta_{v}) \\sin(\\theta_{s})$.\n    - We combine these elements with the anisotropy amplitude parameter $\\alpha$. To maintain consistency with the definition of the directional reflectance factor $r = \\pi f_r$ and the interpretation of $\\rho$ and $\\alpha$ as reflectance-scale parameters, the anisotropic term is formulated as $\\frac{\\alpha}{\\pi}$ multiplied by the geometric and azimuthal functions.\n\n    Therefore, the anisotropic component is:\n    $$f_{aniso} = \\frac{\\alpha}{\\pi} \\sin(\\theta_{s}) \\sin(\\theta_{v}) \\cos(\\Delta\\phi - \\phi_{0})$$\n\n3.  **Complete BRDF Model**: Combining the isotropic and anisotropic components, we obtain the complete BRDF model:\n    $$f_{r}(\\theta_{s}, \\theta_{v}, \\Delta\\phi) = \\frac{\\rho}{\\pi} + \\frac{\\alpha}{\\pi} \\sin(\\theta_{s}) \\sin(\\theta_{v}) \\cos(\\Delta\\phi - \\phi_{0})$$\n    $$f_{r}(\\theta_{s}, \\theta_{v}, \\Delta\\phi) = \\frac{1}{\\pi} \\left[ \\rho + \\alpha \\sin(\\theta_{s}) \\sin(\\theta_{v}) \\cos(\\Delta\\phi - \\phi_{0}) \\right]$$\n    This model satisfies all the stated conditions. The constraint $\\alpha  \\rho$ ensures that $f_{r}$ is always positive, since $\\sin(\\theta_{s})\\sin(\\theta_{v}) \\in [0,1)$ and $\\cos(\\Delta\\phi - \\phi_0) \\in [-1,1]$, so the minimum value of the term in the brackets is $\\rho - \\alpha > 0$.\n\nNow, we compute the directional reflectance factor, $r$, using its definition:\n$$r(\\theta_{s}, \\theta_{v}, \\Delta\\phi) = \\pi f_{r}(\\theta_{s}, \\theta_{v}, \\Delta\\phi)$$\nSubstituting our model for $f_{r}$:\n$$r(\\theta_{s}, \\theta_{v}, \\Delta\\phi) = \\pi \\left( \\frac{1}{\\pi} \\left[ \\rho + \\alpha \\sin(\\theta_{s}) \\sin(\\theta_{v}) \\cos(\\Delta\\phi - \\phi_{0}) \\right] \\right)$$\n$$r(\\theta_{s}, \\theta_{v}, \\Delta\\phi) = \\rho + \\alpha \\sin(\\theta_{s}) \\sin(\\theta_{v}) \\cos(\\Delta\\phi - \\phi_{0})$$\n\nThe final step is to calculate the difference in $r$ between along-row and across-row viewing for fixed $\\theta_{s}$ and $\\theta_{v}$.\n\n-   **Along-row viewing**: This corresponds to $\\Delta\\phi = \\phi_{0}$. The directional reflectance factor, $r_{along}$, is:\n    $$r_{along} = r(\\theta_{s}, \\theta_{v}, \\phi_{0}) = \\rho + \\alpha \\sin(\\theta_{s}) \\sin(\\theta_{v}) \\cos(\\phi_{0} - \\phi_{0})$$\n    Since $\\cos(0) = 1$:\n    $$r_{along} = \\rho + \\alpha \\sin(\\theta_{s}) \\sin(\\theta_{v})$$\n\n-   **Across-row viewing**: This corresponds to $\\Delta\\phi = \\phi_{0} + \\pi/2$. The directional reflectance factor, $r_{across}$, is:\n    $$r_{across} = r(\\theta_{s}, \\theta_{v}, \\phi_{0} + \\pi/2) = \\rho + \\alpha \\sin(\\theta_{s}) \\sin(\\theta_{v}) \\cos\\left((\\phi_{0} + \\pi/2) - \\phi_{0}\\right)$$\n    Since $\\cos(\\pi/2) = 0$:\n    $$r_{across} = \\rho + \\alpha \\sin(\\theta_{s}) \\sin(\\theta_{v}) \\cdot 0$$\n    $$r_{across} = \\rho$$\n\nThe problem asks for the difference between these two values: $\\Delta r = r_{along} - r_{across}$.\n$$\\Delta r = \\left( \\rho + \\alpha \\sin(\\theta_{s}) \\sin(\\theta_{v}) \\right) - \\rho$$\n$$\\Delta r = \\alpha \\sin(\\theta_{s}) \\sin(\\theta_{v})$$\n\nThis is the final closed-form analytic expression for the difference in directional reflectance factor, expressed in terms of the model parameters and angles.",
            "answer": "$$\\boxed{\\alpha \\sin(\\theta_{s}) \\sin(\\theta_{v})}$$"
        },
        {
            "introduction": "The ultimate test and purpose of BRDF models in remote sensing is their application to real-world observational data. This exercise provides a hands-on experience in this crucial final step: inverting a model to retrieve surface properties from a set of multi-angle reflectance measurements. You will implement a weighted least-squares inversion for a kernel-driven model, a technique widely used in operational satellite data processing, and learn to quantify the confidence in your retrieved parameters through posterior uncertainty analysis .",
            "id": "3857436",
            "problem": "Consider a kernel-driven Bidirectional Reflectance Distribution Function (BRDF) model in which multiangle surface reflectance observations are represented as a linear combination of physically motivated basis functions. Let the solar zenith angle be denoted by $\\theta_s$, the view zenith angle by $\\theta_v$, and the relative azimuth angle by $\\phi$. All angles are provided in degrees but must be converted to radians prior to any trigonometric computation. Define the following three kernels:\n- Isotropic kernel: $K_{\\text{iso}}(\\theta_s,\\theta_v,\\phi) = 1$.\n- Volumetric kernel: $K_{\\text{vol}}(\\theta_s,\\theta_v,\\phi) = \\cos(\\theta_s) + \\cos(\\theta_v)$.\n- Geometric kernel: $K_{\\text{geo}}(\\theta_s,\\theta_v,\\phi) = \\cos(\\alpha)$, where the phase-angle cosine is $\\cos(\\alpha) = \\cos(\\theta_s)\\cos(\\theta_v) + \\sin(\\theta_s)\\sin(\\theta_v)\\cos(\\phi)$.\n\nLet the reflectance observation vector be $\\mathbf{y} \\in \\mathbb{R}^n$ (dimensionless) at $n$ multiangle geometries, and let the kernel design matrix be $\\mathbf{K} \\in \\mathbb{R}^{n \\times 3}$ with rows $\\left[K_{\\text{iso}}, K_{\\text{vol}}, K_{\\text{geo}}\\right]$ evaluated at each geometry. Let the coefficient vector be $\\mathbf{f} = [f_{\\text{iso}}, f_{\\text{vol}}, f_{\\text{geo}}]^T$. Assume an additive noise model $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma})$ with known positive-definite covariance matrix $\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{n \\times n}$. The observations satisfy $\\mathbf{y} = \\mathbf{K}\\mathbf{f} + \\boldsymbol{\\epsilon}$.\n\nTask: From the above statistical and physical definitions, implement a weighted least squares inversion to estimate $\\widehat{\\mathbf{f}}$ from $(\\mathbf{K}, \\mathbf{y}, \\boldsymbol{\\Sigma})$ and compute the posterior uncertainty quantified by the square roots of the diagonal entries of the posterior covariance matrix of $\\widehat{\\mathbf{f}}$. Use angles in degrees and convert them to radians before computing trigonometric functions. Reflectance is dimensionless, and covariance entries are in reflectance squared (dimensionless squared). Your program must output, for each test case, a list of $6$ floats in the order $[f_{\\text{iso}}, f_{\\text{vol}}, f_{\\text{geo}}, \\sigma_{f_{\\text{iso}}}, \\sigma_{f_{\\text{vol}}}, \\sigma_{f_{\\text{geo}}}]$, where $\\sigma_{f_i}$ denotes the posterior standard deviation for the corresponding coefficient. Aggregate the results from all test cases into a single line, printed as a comma-separated list enclosed in square brackets, with each test case result itself being a bracketed comma-separated list. For example, print exactly a single line of the form $[\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,]$.\n\nTest Suite:\n- Test Case $1$ (general, well-conditioned):\n  - Solar zenith angle $\\theta_s = 35^\\circ$.\n  - View zenith angles $\\theta_v = [\\,0^\\circ,\\,15^\\circ,\\,30^\\circ,\\,45^\\circ,\\,60^\\circ\\,]$.\n  - Relative azimuth angles $\\phi = [\\,0^\\circ,\\,30^\\circ,\\,60^\\circ,\\,90^\\circ,\\,120^\\circ\\,]$.\n  - Observations $\\mathbf{y} = [\\,0.09107876,\\,0.089902325,\\,0.08826754,\\,0.08292132,\\,0.07738777\\,]$ (dimensionless).\n  - Covariance $\\boldsymbol{\\Sigma} = \\operatorname{diag}([\\,1\\times 10^{-6},\\,1\\times 10^{-6},\\,1\\times 10^{-6},\\,1\\times 10^{-6},\\,1\\times 10^{-6}\\,])$ (dimensionless squared).\n- Test Case $2$ (correlated noise, more oblique geometries):\n  - Solar zenith angle $\\theta_s = 60^\\circ$.\n  - View zenith angles $\\theta_v = [\\,10^\\circ,\\,35^\\circ,\\,50^\\circ,\\,70^\\circ,\\,80^\\circ\\,]$.\n  - Relative azimuth angles $\\phi = [\\,180^\\circ,\\,150^\\circ,\\,120^\\circ,\\,90^\\circ,\\,60^\\circ\\,]$.\n  - Observations $\\mathbf{y} = [\\,0.081806256,\\,0.076078325,\\,0.073304186,\\,0.067395453,\\,0.066140008\\,]$ (dimensionless).\n  - Covariance $\\boldsymbol{\\Sigma} = 10^{-6}\\times \\begin{bmatrix}\n    4  1  0.6  0.3  0.1 \\\\\n    1  4  1  0.6  0.3 \\\\\n    0.6  1  4  1  0.6 \\\\\n    0.3  0.6  1  4  1 \\\\\n    0.1  0.3  0.6  1  4\n  \\end{bmatrix}$ (dimensionless squared).\n- Test Case $3$ (boundary case with minimal observations equal to number of coefficients):\n  - Solar zenith angle $\\theta_s = 25^\\circ$.\n  - View zenith angles $\\theta_v = [\\,10^\\circ,\\,40^\\circ,\\,70^\\circ\\,]$.\n  - Relative azimuth angles $\\phi = [\\,0^\\circ,\\,90^\\circ,\\,180^\\circ\\,]$.\n  - Observations $\\mathbf{y} = [\\,0.092351932,\\,0.0871184046,\\,0.0744293686\\,]$ (dimensionless).\n  - Covariance $\\boldsymbol{\\Sigma} = \\operatorname{diag}([\\,1\\times 10^{-6},\\,1\\times 10^{-6},\\,1\\times 10^{-6}\\,])$ (dimensionless squared).\n\nAlgorithmic Requirements:\n- Construct $\\mathbf{K}$ by evaluating $K_{\\text{iso}}$, $K_{\\text{vol}}$, and $K_{\\text{geo}}$ at each geometry using angles converted to radians.\n- Implement a statistically principled weighted least squares estimator derived from a Gaussian likelihood with covariance $\\boldsymbol{\\Sigma}$.\n- Compute the posterior covariance of $\\widehat{\\mathbf{f}}$ under the linear-Gaussian model assumptions.\n- Extract posterior uncertainties as the square roots of the diagonal entries of the posterior covariance matrix.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and ordered per test case as described above. That is, print $[\\,[f_{\\text{iso}}, f_{\\text{vol}}, f_{\\text{geo}}, \\sigma_{f_{\\text{iso}}}, \\sigma_{f_{\\text{vol}}}, \\sigma_{f_{\\text{geo}}}],\\,[\\cdots],\\,[\\cdots]\\,]$.",
            "solution": "The problem requires the estimation of parameters for a linear Bidirectional Reflectance Distribution Function (BRDF) model from multiangle reflectance observations. This is a classic parameter estimation problem in statistical signal processing and remote sensing, which can be solved using the method of Weighted Least Squares (WLS).\n\nThe model is given by the linear equation:\n$$\n\\mathbf{y} = \\mathbf{K}\\mathbf{f} + \\boldsymbol{\\epsilon}\n$$\nwhere:\n- $\\mathbf{y} \\in \\mathbb{R}^n$ is the vector of $n$ reflectance observations.\n- $\\mathbf{K} \\in \\mathbb{R}^{n \\times 3}$ is the design matrix, whose rows are formed by evaluating three kernel functions at each observation geometry.\n- $\\mathbf{f} = [f_{\\text{iso}}, f_{\\text{vol}}, f_{\\text{geo}}]^T$ is the vector of $3$ unknown coefficients to be estimated.\n- $\\boldsymbol{\\epsilon} \\in \\mathbb{R}^n$ is the vector of observational noise, modeled as a multivariate normal distribution with zero mean and a known positive-definite covariance matrix $\\boldsymbol{\\Sigma}$, i.e., $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma})$.\n\nThe three kernel functions are defined based on the solar zenith angle $\\theta_s$, view zenith angle $\\theta_v$, and relative azimuth angle $\\phi$. It is imperative that all angles, given in degrees, are converted to radians before use in any trigonometric function.\n- Isotropic kernel: $K_{\\text{iso}}(\\theta_s,\\theta_v,\\phi) = 1$. This kernel represents isotropic scattering, which is uniform in all directions.\n- Volumetric kernel: $K_{\\text{vol}}(\\theta_s,\\theta_v,\\phi) = \\cos(\\theta_s) + \\cos(\\theta_v)$. This kernel models scattering from a volume, such as a plant canopy, where the path length of light through the medium is a key factor.\n- Geometric kernel: $K_{\\text{geo}}(\\theta_s,\\theta_v,\\phi) = \\cos(\\alpha)$, where the phase-angle cosine is given by $\\cos(\\alpha) = \\cos(\\theta_s)\\cos(\\theta_v) + \\sin(\\theta_s)\\sin(\\theta_v)\\cos(\\phi)$. This kernel accounts for geometric effects like shadowing and mutual occlusion of scene components.\n\nThe task is to find the best estimate for the coefficient vector, $\\widehat{\\mathbf{f}}$, and to quantify the uncertainty of this estimate.\n\nGiven the Gaussian noise model, the likelihood function for the parameters $\\mathbf{f}$ is:\n$$\n\\mathcal{L}(\\mathbf{f} | \\mathbf{y}, \\mathbf{K}, \\boldsymbol{\\Sigma}) \\propto \\exp\\left(-\\frac{1}{2} (\\mathbf{y} - \\mathbf{K}\\mathbf{f})^T \\boldsymbol{\\Sigma}^{-1} (\\mathbf{y} - \\mathbf{K}\\mathbf{f})\\right)\n$$\nMaximizing this likelihood is equivalent to minimizing the negative log-likelihood, which simplifies to minimizing the quadratic form in the exponent, often denoted as the chi-squared statistic:\n$$\nS(\\mathbf{f}) = (\\mathbf{y} - \\mathbf{K}\\mathbf{f})^T \\boldsymbol{\\Sigma}^{-1} (\\mathbf{y} - \\mathbf{K}\\mathbf{f})\n$$\nThis minimization problem is known as Weighted Least Squares, with the weight matrix being the inverse of the noise covariance matrix, $\\mathbf{W} = \\boldsymbol{\\Sigma}^{-1}$.\n\nTo find the minimum of $S(\\mathbf{f})$, we compute its gradient with respect to $\\mathbf{f}$ and set it to zero:\n$$\n\\nabla_{\\mathbf{f}} S(\\mathbf{f}) = \\nabla_{\\mathbf{f}} \\left( \\mathbf{y}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y} - 2\\mathbf{f}^T \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y} + \\mathbf{f}^T \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K} \\mathbf{f} \\right) = -2 \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y} + 2 \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K} \\mathbf{f} = \\mathbf{0}\n$$\nThis leads to the so-called normal equations for the WLS problem:\n$$\n(\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K}) \\mathbf{f} = \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y}\n$$\nAssuming the matrix $(\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})$ is invertible, which is generally true if the number of observations $n$ is at least the number of parameters ($3$) and the columns of $\\mathbf{K}$ are linearly independent, we can solve for the estimator $\\widehat{\\mathbf{f}}$:\n$$\n\\widehat{\\mathbf{f}} = (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y}\n$$\nThis is the WLS solution for the parameter vector $\\mathbf{f}$.\n\nThe next step is to determine the uncertainty associated with this estimate. In a frequentist framework, this corresponds to the covariance of the estimator $\\widehat{\\mathbf{f}}$. Using the properties of covariance, specifically $\\operatorname{Cov}(\\mathbf{A}\\mathbf{x}) = \\mathbf{A}\\operatorname{Cov}(\\mathbf{x})\\mathbf{A}^T$ for a constant matrix $\\mathbf{A}$, we have:\n$$\n\\mathbf{C}_{\\widehat{\\mathbf{f}}} = \\operatorname{Cov}(\\widehat{\\mathbf{f}}) = \\operatorname{Cov}\\left( (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y} \\right)\n$$\nLet $\\mathbf{M} = (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1}$. Since $\\mathbf{f}$ is a fixed (though unknown) quantity, $\\operatorname{Cov}(\\mathbf{y}) = \\operatorname{Cov}(\\mathbf{K}\\mathbf{f} + \\boldsymbol{\\epsilon}) = \\operatorname{Cov}(\\boldsymbol{\\epsilon}) = \\boldsymbol{\\Sigma}$.\nTherefore:\n$$\n\\mathbf{C}_{\\widehat{\\mathbf{f}}} = \\mathbf{M} \\operatorname{Cov}(\\mathbf{y}) \\mathbf{M}^T = \\left( (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\right) \\boldsymbol{\\Sigma} \\left( (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\right)^T\n$$\nUsing the facts that $\\boldsymbol{\\Sigma}$ and $(\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})$ are symmetric, this expression simplifies significantly:\n$$\n\\mathbf{C}_{\\widehat{\\mathbf{f}}} = (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1}) \\boldsymbol{\\Sigma} (\\boldsymbol{\\Sigma}^{-1} \\mathbf{K}) ((\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1})\n$$\n$$\n\\mathbf{C}_{\\widehat{\\mathbf{f}}} = (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1} (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K}) (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1}\n$$\n$$\n\\mathbf{C}_{\\widehat{\\mathbf{f}}} = (\\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K})^{-1}\n$$\nThis matrix, $\\mathbf{C}_{\\widehat{\\mathbf{f}}}$, is the posterior covariance matrix of the estimated parameters (under a flat prior in a Bayesian context, or the covariance of the sampling distribution of the estimator in a frequentist context). The posterior uncertainties for each parameter are the square roots of the diagonal elements of this matrix:\n$$\n\\sigma_{f_i} = \\sqrt{(\\mathbf{C}_{\\widehat{\\mathbf{f}}})_{ii}}\n$$\nwhere $i \\in \\{\\text{iso}, \\text{vol}, \\text{geo}\\}$.\n\nThe algorithm to be implemented is as follows:\n1. For each test case, parse the provided angles $(\\theta_s, \\theta_v, \\phi)$, observation vector $\\mathbf{y}$, and covariance matrix $\\boldsymbol{\\Sigma}$.\n2. Convert all angle values from degrees to radians.\n3. Construct the $n \\times 3$ design matrix $\\mathbf{K}$ by computing the values of $K_{\\text{iso}}$, $K_{\\text{vol}}$, and $K_{\\text{geo}}$ for each of the $n$ observation geometries.\n4. Compute the inverse of the observation covariance matrix, $\\boldsymbol{\\Sigma}^{-1}$.\n5. Calculate the matrix $\\mathbf{A} = \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{K}$.\n6. The posterior covariance matrix is the inverse of $\\mathbf{A}$: $\\mathbf{C}_{\\widehat{\\mathbf{f}}} = \\mathbf{A}^{-1}$.\n7. Calculate the vector $\\mathbf{b} = \\mathbf{K}^T \\boldsymbol{\\Sigma}^{-1} \\mathbf{y}$.\n8. Compute the estimated parameter vector: $\\widehat{\\mathbf{f}} = \\mathbf{C}_{\\widehat{\\mathbf{f}}} \\mathbf{b}$.\n9. Extract the posterior standard deviations by taking the square root of the diagonal elements of $\\mathbf{C}_{\\widehat{\\mathbf{f}}}$.\n10. Assemble the six output values $[f_{\\text{iso}}, f_{\\text{vol}}, f_{\\text{geo}}, \\sigma_{f_{\\text{iso}}}, \\sigma_{f_{\\text{vol}}}, \\sigma_{f_{\\text{geo}}}]$ for each test case and format them as required.",
            "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the results.\n    \"\"\"\n\n    test_cases = [\n        # Test Case 1 (general, well-conditioned)\n        {\n            \"theta_s_deg\": 35.0,\n            \"theta_v_deg\": np.array([0.0, 15.0, 30.0, 45.0, 60.0]),\n            \"phi_deg\": np.array([0.0, 30.0, 60.0, 90.0, 120.0]),\n            \"y\": np.array([0.09107876, 0.089902325, 0.08826754, 0.08292132, 0.07738777]),\n            \"Sigma\": np.diag([1e-6] * 5),\n        },\n        # Test Case 2 (correlated noise, more oblique geometries)\n        {\n            \"theta_s_deg\": 60.0,\n            \"theta_v_deg\": np.array([10.0, 35.0, 50.0, 70.0, 80.0]),\n            \"phi_deg\": np.array([180.0, 150.0, 120.0, 90.0, 60.0]),\n            \"y\": np.array([0.081806256, 0.076078325, 0.073304186, 0.067395453, 0.066140008]),\n            \"Sigma\": 1e-6 * np.array([\n                [4.0, 1.0, 0.6, 0.3, 0.1],\n                [1.0, 4.0, 1.0, 0.6, 0.3],\n                [0.6, 1.0, 4.0, 1.0, 0.6],\n                [0.3, 0.6, 1.0, 4.0, 1.0],\n                [0.1, 0.3, 0.6, 1.0, 4.0]\n            ]),\n        },\n        # Test Case 3 (boundary case, n=p)\n        {\n            \"theta_s_deg\": 25.0,\n            \"theta_v_deg\": np.array([10.0, 40.0, 70.0]),\n            \"phi_deg\": np.array([0.0, 90.0, 180.0]),\n            \"y\": np.array([0.092351932, 0.0871184046, 0.0744293686]),\n            \"Sigma\": np.diag([1e-6] * 3),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = estimate_brdf_params(\n            case[\"theta_s_deg\"],\n            case[\"theta_v_deg\"],\n            case[\"phi_deg\"],\n            case[\"y\"],\n            case[\"Sigma\"]\n        )\n        results.append(result)\n\n    # Convert each inner list to its string representation\n    # and join them with commas.\n    str_results = [str(res) for res in results]\n    final_output = f\"[{','.join(str_results)}]\"\n    print(final_output)\n\ndef estimate_brdf_params(theta_s_deg, theta_v_deg, phi_deg, y, Sigma):\n    \"\"\"\n    Estimates BRDF model parameters and their uncertainties using Weighted Least Squares.\n\n    Args:\n        theta_s_deg (float): Solar zenith angle in degrees.\n        theta_v_deg (np.ndarray): Array of view zenith angles in degrees.\n        phi_deg (np.ndarray): Array of relative azimuth angles in degrees.\n        y (np.ndarray): Vector of reflectance observations.\n        Sigma (np.ndarray): Covariance matrix of the observations.\n\n    Returns:\n        list: A list of 6 floats: [f_iso, f_vol, f_geo, sigma_f_iso, sigma_f_vol, sigma_f_geo].\n    \"\"\"\n    # Convert angles from degrees to radians\n    theta_s = np.deg2rad(theta_s_deg)\n    theta_v = np.deg2rad(theta_v_deg)\n    phi = np.deg2rad(phi_deg)\n\n    # Pre-compute trigonometric values\n    cos_ts, sin_ts = np.cos(theta_s), np.sin(theta_s)\n    cos_tv, sin_tv = np.cos(theta_v), np.sin(theta_v)\n    cos_phi = np.cos(phi)\n\n    # Construct the design matrix K\n    n_obs = len(y)\n    K = np.zeros((n_obs, 3))\n\n    # K_iso\n    K[:, 0] = 1.0\n\n    # K_vol\n    K[:, 1] = cos_ts + cos_tv\n    \n    # K_geo\n    K[:, 2] = cos_ts * cos_tv + sin_ts * sin_tv * cos_phi\n\n    # Perform Weighted Least Squares\n    # WLS solution: f_hat = (K.T * Sigma^-1 * K)^-1 * K.T * Sigma^-1 * y\n    \n    # Inverse of the covariance matrix (Weight matrix)\n    Sigma_inv = linalg.inv(Sigma)\n\n    # Compute the posterior covariance matrix of parameters: (K.T * Sigma^-1 * K)^-1\n    # This is a 3x3 matrix.\n    KT_Sigma_inv_K = K.T @ Sigma_inv @ K\n    \n    # Using scipy.linalg.inv as specified in the execution environment\n    post_cov_f = linalg.inv(KT_Sigma_inv_K)\n\n    # Compute the parameter estimates\n    KT_Sigma_inv_y = K.T @ Sigma_inv @ y\n    f_hat = post_cov_f @ KT_Sigma_inv_y\n\n    # Compute uncertainties (standard deviations)\n    # These are the square roots of the diagonal elements of the posterior covariance matrix\n    uncertainties = np.sqrt(np.diag(post_cov_f))\n\n    # Assemble the result vector\n    result_list = list(f_hat) + list(uncertainties)\n    \n    return result_list\n\nsolve()\n\n```"
        }
    ]
}