{
    "hands_on_practices": [
        {
            "introduction": "A primary goal in quantitative remote sensing is to derive the intrinsic physical properties of the Earth's surface from sensor measurements. The at-sensor radiance, $L(\\lambda)$, is a composite signal containing contributions from both surface reflectance and atmospheric scattering and absorption. This practice guides you through a foundational atmospheric correction workflow, using a simplified radiative transfer model to disentangle these components and retrieve the true surface reflectance, $\\rho(\\lambda)$, which is the essential input for mineralogical analysis .",
            "id": "3820016",
            "problem": "A hyperspectral imaging spectrometer acquires data over a narrow geological band centered at wavelength $\\lambda$, observing a mineralized outcrop under clear-sky conditions. Assume a plane-parallel atmosphere and a surface that can be approximated as Lambertian, with no adjacency effects and negligible atmospheric multiple scattering (no atmospheric spherical albedo). The spectrometer records the at-sensor spectral radiance $L(\\lambda)$ and the atmospheric path radiance $L_{p}(\\lambda)$ along the line-of-sight. The extraterrestrial spectral irradiance is $E_{0}(\\lambda)$, and the solar zenith angle is $\\theta_{s}$. The upward and downward atmospheric spectral transmittances along the solar and sensor paths are $T_{u}(\\lambda)$ and $T_{d}(\\lambda)$, respectively. Use the definitions of spectral radiance, spectral irradiance, and surface reflectance, together with the plane-parallel radiative transfer decomposition into path and surface-transmitted terms, to derive the expression for the surface spectral reflectance $\\rho(\\lambda)$ and evaluate it for the following measured quantities:\n$$L(\\lambda)=100 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}, \\quad L_{p}(\\lambda)=20 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1},$$\n$$E_{0}(\\lambda)\\cos\\theta_{s}=900 \\, \\text{W m}^{-2} \\text{ nm}^{-1}, \\quad T_{u}(\\lambda)T_{d}(\\lambda)=0.7.$$\nHere $\\rho(\\lambda)$ is the directional-hemispherical reflectance of the surface under the Lambertian assumption, which is related to the Bidirectional Reflectance Distribution Function (BRDF) by the Lambertian property. Round your final numerical answer for $\\rho(\\lambda)$ to four significant figures and express it as a unitless decimal number.",
            "solution": "The problem requires the derivation of the surface spectral reflectance, $\\rho(\\lambda)$, from at-sensor hyperspectral measurements, based on a simplified model of radiative transfer, and then to evaluate it using the provided data.\n\nFirst, we validate the problem statement.\nThe givens are:\n- At-sensor spectral radiance: $L(\\lambda)=100 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- Atmospheric path radiance: $L_{p}(\\lambda)=20 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- Top-of-atmosphere horizontal spectral irradiance: $E_{0}(\\lambda)\\cos\\theta_{s}=900 \\, \\text{W m}^{-2} \\text{ nm}^{-1}$, where $E_{0}(\\lambda)$ is the extraterrestrial spectral irradiance, and $\\theta_{s}$ is the solar zenith angle.\n- Product of upward and downward atmospheric spectral transmittances: $T_{u}(\\lambda)T_{d}(\\lambda)=0.7$\n\nThe assumptions are:\n- Plane-parallel atmosphere.\n- Lambertian surface.\n- No adjacency effects.\n- Negligible atmospheric multiple scattering.\n\nThe problem is scientifically grounded in the principles of radiative transfer, a fundamental concept in remote sensing and atmospheric physics. The quantities and their units are standard and dimensionally consistent. The provided values are physically plausible. The problem is well-posed, providing all necessary information for a unique solution under the specified assumptions. It is objective and free of ambiguity. Therefore, the problem is valid, and we may proceed with the solution.\n\nThe fundamental principle is that the total spectral radiance measured by the sensor, $L(\\lambda)$, is the sum of the radiance scattered by the atmosphere directly into the sensor's field of view (path radiance, $L_p(\\lambda)$) and the radiance originating from the sun, reflected by the surface, and then transmitted through the atmosphere to the sensor.\n\nThe at-sensor spectral radiance $L(\\lambda)$ can be expressed as:\n$$L(\\lambda) = L_{p}(\\lambda) + L_{surface-reflected}(\\lambda)$$\nwhere $L_{surface-reflected}(\\lambda)$ is the component of the radiance originating from the surface reflection.\n\nWe must now formulate the term $L_{surface-reflected}(\\lambda)$.\n1.  The solar spectral irradiance at the top of the atmosphere on a horizontal plane is $E_{0}(\\lambda)\\cos\\theta_{s}$.\n2.  This radiation is transmitted through the atmosphere to the surface. The downward atmospheric spectral transmittance is $T_{d}(\\lambda)$. Thus, the spectral irradiance incident on the surface is $E_{g}(\\lambda)$. Under the assumption of negligible multiple scattering, we consider only the direct solar beam, so the total irradiance reaching the surface is:\n    $$E_{g}(\\lambda) = E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda)$$\n3.  The surface is assumed to be Lambertian. For a Lambertian surface with spectral reflectance $\\rho(\\lambda)$, the reflected radiance is isotropic (independent of viewing direction) and is related to the total incident hemispherical irradiance $E_g(\\lambda)$ by:\n    $$L_{refl}(\\lambda) = \\frac{\\rho(\\lambda) E_{g}(\\lambda)}{\\pi}$$\n    The factor of $\\pi$ arises from the integration of the isotropic radiance over the hemisphere of outgoing directions, which must equal the reflected exitance $M = \\rho(\\lambda) E_g(\\lambda)$. For a Lambertian surface, $M = \\pi L$.\n4.  Substituting the expression for $E_{g}(\\lambda)$ into the equation for $L_{refl}(\\lambda)$:\n    $$L_{refl}(\\lambda) = \\frac{\\rho(\\lambda)}{\\pi} \\left( E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) \\right)$$\n5.  This reflected radiance from the surface, $L_{refl}(\\lambda)$, is then attenuated as it travels upward through the atmosphere to the sensor. The upward atmospheric spectral transmittance along the sensor path is $T_{u}(\\lambda)$. Therefore, the surface-reflected radiance that reaches the sensor is:\n    $$L_{surface-reflected}(\\lambda) = L_{refl}(\\lambda) T_{u}(\\lambda) = \\left( \\frac{\\rho(\\lambda)}{\\pi} E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) \\right) T_{u}(\\lambda)$$\n\nNow, we substitute this back into the main equation for $L(\\lambda)$:\n$$L(\\lambda) = L_{p}(\\lambda) + \\frac{\\rho(\\lambda)}{\\pi} E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) T_{u}(\\lambda)$$\n\nThe first part of the task is to derive the expression for the surface spectral reflectance $\\rho(\\lambda)$. We rearrange the equation to solve for $\\rho(\\lambda)$:\n$$L(\\lambda) - L_{p}(\\lambda) = \\frac{\\rho(\\lambda)}{\\pi} E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) T_{u}(\\lambda)$$\n$$\\rho(\\lambda) = \\frac{\\pi \\left( L(\\lambda) - L_{p}(\\lambda) \\right)}{E_{0}(\\lambda)\\cos\\theta_{s} T_{u}(\\lambda) T_{d}(\\lambda)}$$\nThis is the desired analytical expression for the surface spectral reflectance.\n\nThe second part of the task is to evaluate this expression using the given numerical values. For notational simplicity in the calculation, let us drop the explicit dependence on $\\lambda$:\n- $L = 100 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- $L_{p} = 20 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- $E_{0}\\cos\\theta_{s} = 900 \\, \\text{W m}^{-2} \\text{ nm}^{-1}$\n- $T_{u}T_{d} = 0.7$\n\nSubstituting these values into the derived formula for $\\rho$:\n$$\\rho = \\frac{\\pi \\left( 100 - 20 \\right)}{900 \\times 0.7}$$\n$$\\rho = \\frac{80\\pi}{630}$$\n$$\\rho = \\frac{8\\pi}{63}$$\n\nNow we compute the numerical value:\n$$\\rho \\approx \\frac{8 \\times 3.14159265}{63}$$\n$$\\rho \\approx \\frac{25.1327412}{63}$$\n$$\\rho \\approx 0.39893240045...$$\n\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $3$, $9$, $8$, $9$. The fifth significant digit is $3$, which is less than $5$, so we round down (i.e., we truncate).\n$$\\rho \\approx 0.3989$$\nThis is a dimensionless quantity, as expected for reflectance.",
            "answer": "$$\\boxed{0.3989}$$"
        },
        {
            "introduction": "Once a clean surface reflectance spectrum has been retrieved, the next task is to analyze its diagnostic features, which hold the key to mineral identification. This exercise focuses on continuum removal, a standard technique used to isolate specific absorption features from the overall albedo and shape of the spectrum. By calculating the continuum-removed band depth, you will learn how to convert a qualitative spectral feature into a quantitative parameter suitable for creating detailed mineral maps .",
            "id": "3820046",
            "problem": "A hyperspectral imaging (HSI) spectrometer measures surface bidirectional reflectance factor $R(\\lambda)$ over a carbonate-rich outcrop. An absorption feature associated with metalâ€“carbonate overtones is centered near $2.33\\,\\mu\\mathrm{m}$, with shoulders at $2.30\\,\\mu\\mathrm{m}$ and $2.36\\,\\mu\\mathrm{m}$. The measured reflectances are $R(2.30\\,\\mu\\mathrm{m}) = 0.42$, $R(2.36\\,\\mu\\mathrm{m}) = 0.46$, and a local minimum $R(2.33\\,\\mu\\mathrm{m}) = 0.35$. For continuum removal, take the continuum reflectance $R_{c}(\\lambda)$ as the straight line that passes through the two shoulder points at $2.30\\,\\mu\\mathrm{m}$ and $2.36\\,\\mu\\mathrm{m}$. Using the standard continuum-removal definition of band depth evaluated at the absorption minimum, compute the continuum-removed band depth at $\\lambda = 2.33\\,\\mu\\mathrm{m}$. Express your final answer as a dimensionless fraction rounded to four significant figures.",
            "solution": "The problem asks for the calculation of the continuum-removed band depth for a specific absorption feature in a hyperspectral reflectance spectrum. The process involves defining a linear continuum, calculating its value at the absorption minimum, and then applying the standard formula for band depth.\n\nThe givens from the problem statement are:\n- The shoulder points of the absorption feature are at wavelength $\\lambda_1 = 2.30\\,\\mu\\mathrm{m}$ with reflectance $R_1 = R(2.30) = 0.42$, and at wavelength $\\lambda_2 = 2.36\\,\\mu\\mathrm{m}$ with reflectance $R_2 = R(2.36) = 0.46$.\n- The absorption feature has a local minimum at wavelength $\\lambda_{min} = 2.33\\,\\mu\\mathrm{m}$ with a measured reflectance of $R_{min} = R(2.33) = 0.35$.\n\nThe first step is to determine the equation of the continuum reflectance, $R_c(\\lambda)$, which is defined as the straight line passing through the two shoulder points $(\\lambda_1, R_1)$ and $(\\lambda_2, R_2)$. The general two-point form of a linear equation is:\n$$R_c(\\lambda) = R_1 + \\frac{R_2 - R_1}{\\lambda_2 - \\lambda_1}(\\lambda - \\lambda_1)$$\n\nWe need to calculate the value of this continuum reflectance at the wavelength of the absorption minimum, $\\lambda_{min} = 2.33\\,\\mu\\mathrm{m}$. Substituting the given values into the equation:\n$$R_c(\\lambda_{min}) = R_c(2.33) = R_1 + \\frac{R_2 - R_1}{\\lambda_2 - \\lambda_1}(\\lambda_{min} - \\lambda_1)$$\n$$R_c(2.33) = 0.42 + \\frac{0.46 - 0.42}{2.36 - 2.30}(2.33 - 2.30)$$\n\nNow, we compute the numerical values:\n$$R_c(2.33) = 0.42 + \\frac{0.04}{0.06}(0.03)$$\n$$R_c(2.33) = 0.42 + \\left(\\frac{2}{3}\\right)(0.03)$$\n$$R_c(2.33) = 0.42 + 0.02$$\n$$R_c(2.33) = 0.44$$\nThis is the reflectance value of the continuum at the wavelength of the absorption minimum.\n\nThe next step is to calculate the continuum-removed band depth, denoted as $BD$. The standard definition of band depth normalizes the depth of the absorption feature with respect to the continuum level, making it a dimensionless quantity. The formula is:\n$$BD(\\lambda) = \\frac{R_c(\\lambda) - R(\\lambda)}{R_c(\\lambda)} = 1 - \\frac{R(\\lambda)}{R_c(\\lambda)}$$\n\nWe evaluate the band depth at the absorption minimum, $\\lambda_{min} = 2.33\\,\\mu\\mathrm{m}$, using the measured reflectance $R_{min} = R(2.33) = 0.35$ and the calculated continuum reflectance $R_c(2.33) = 0.44$:\n$$BD(2.33) = 1 - \\frac{R(2.33)}{R_c(2.33)}$$\n$$BD(2.33) = 1 - \\frac{0.35}{0.44}$$\n\nTo find the exact fractional value:\n$$BD(2.33) = \\frac{0.44 - 0.35}{0.44} = \\frac{0.09}{0.44} = \\frac{9}{44}$$\n\nFinally, we convert this fraction to a decimal and round to four significant figures as requested:\n$$BD(2.33) = \\frac{9}{44} \\approx 0.20454545...$$\nRounding to four significant figures gives $0.2045$.",
            "answer": "$$\\boxed{0.2045}$$"
        },
        {
            "introduction": "Hyperspectral data cubes are characterized by high dimensionality and inherent noise, posing significant challenges for analysis. This practice introduces the Minimum Noise Fraction (MNF) transform, a powerful technique that reorders data based on signal-to-noise ratio to facilitate dimensionality reduction and noise suppression. By working through the relationship between observed data variance, signal variance, and noise, you will develop the critical skill of selecting the most informative components, ensuring your subsequent mapping efforts are based on genuine geological signals .",
            "id": "3820058",
            "problem": "A hyperspectral scene of a mineralized outcrop is modeled by an additive signal-plus-noise process, where each observed spectrum vector $\\mathbf{x} \\in \\mathbb{R}^{p}$ is the sum of a latent signal $\\mathbf{s}$ and an additive noise $\\mathbf{n}$, so that $\\mathbf{x} = \\mathbf{s} + \\mathbf{n}$. Assume the noise is zero-mean, uncorrelated with the signal, and spatially white with variance $\\sigma_{n}^{2}$ per band, so that $\\mathrm{Cov}(\\mathbf{n}) = \\sigma_{n}^{2}\\mathbf{I}$. You compute the sample covariance of the demeaned observed data and find that its eigenvalues are $\\{12, 7, 3, 0.8, 0.5\\}$. An independent noise characterization yields an estimated per-band noise variance of $\\sigma_{n}^{2} = 1$. You intend to perform the Minimum Noise Fraction (MNF) transform to reduce dimensionality before geological and mineral mapping, retaining only components whose Signal-to-Noise Ratio (SNR) is at least $1$ (that is, signal variance at least equals noise variance).\n\nStarting only from the additive model $\\mathbf{x}=\\mathbf{s}+\\mathbf{n}$, the covariance additivity $\\mathrm{Cov}(\\mathbf{x})=\\mathrm{Cov}(\\mathbf{s})+\\mathrm{Cov}(\\mathbf{n})$, the definition of SNR as the ratio of signal variance to noise variance along a component, and the properties of eigenvalues of covariance matrices under isotropic noise, determine how many MNF components to retain under the stated SNR threshold and justify the choice in terms of the relationship between the observed eigenvalues, signal variance, and noise variance.\n\nProvide your final answer as a single integer representing the count of retained components. No rounding is required and no physical units apply.",
            "solution": "The problem is deemed valid as it is scientifically grounded in signal processing and linear algebra, well-posed with sufficient and consistent information, and objectively stated.\n\nThe problem requires a determination of the number of components to retain after a Minimum Noise Fraction (MNF) transform based on a Signal-to-Noise Ratio (SNR) criterion. We begin by formalizing the relationships provided.\n\nThe observed spectrum vector $\\mathbf{x}$ is described by the additive model:\n$$\n\\mathbf{x} = \\mathbf{s} + \\mathbf{n}\n$$\nwhere $\\mathbf{s}$ is the latent signal and $\\mathbf{n}$ is the additive noise.\n\nThe signal $\\mathbf{s}$ and noise $\\mathbf{n}$ are stated to be uncorrelated. This property implies that the covariance matrix of the observed data, $\\mathrm{Cov}(\\mathbf{x})$ or $\\mathbf{\\Sigma_x}$, is the sum of the covariance matrices of the signal, $\\mathrm{Cov}(\\mathbf{s})$ or $\\mathbf{\\Sigma_s}$, and the noise, $\\mathrm{Cov}(\\mathbf{n})$ or $\\mathbf{\\Sigma_n}$:\n$$\n\\mathbf{\\Sigma_x} = \\mathbf{\\Sigma_s} + \\mathbf{\\Sigma_n}\n$$\n\nThe noise is specified as being spatially white with a per-band variance of $\\sigma_{n}^{2}$. This is precisely the definition of isotropic noise, meaning its covariance matrix is a scaled identity matrix:\n$$\n\\mathbf{\\Sigma_n} = \\sigma_{n}^{2}\\mathbf{I}\n$$\nwhere $\\mathbf{I}$ is the identity matrix.\n\nSubstituting this into the covariance additivity equation yields:\n$$\n\\mathbf{\\Sigma_x} = \\mathbf{\\Sigma_s} + \\sigma_{n}^{2}\\mathbf{I}\n$$\n\nThe MNF transform identifies components that are ordered by SNR. These components correspond to the principal components of the signal, which are the eigenvectors of the signal covariance matrix $\\mathbf{\\Sigma_s}$. Let $\\mathbf{v}_i$ be an eigenvector of $\\mathbf{\\Sigma_s}$ with a corresponding eigenvalue $\\lambda_{s,i}$. The eigenvalue $\\lambda_{s,i}$ represents the signal variance along the direction of the eigenvector $\\mathbf{v}_i$.\n$$\n\\mathbf{\\Sigma_s}\\mathbf{v}_i = \\lambda_{s,i}\\mathbf{v}_i\n$$\n\nThe assumption of isotropic noise allows us to establish a direct relationship between the eigenvalues of the signal covariance $\\mathbf{\\Sigma_s}$ and the observed data covariance $\\mathbf{\\Sigma_x}$. Because $\\mathbf{\\Sigma_s}$ and $\\sigma_{n}^{2}\\mathbf{I}$ are simultaneously diagonalizable (any matrix commutes with the identity matrix), they share the same set of eigenvectors. Therefore, $\\mathbf{v}_i$ is also an eigenvector of $\\mathbf{\\Sigma_x}$. Let's find the corresponding eigenvalue, $\\lambda_{x,i}$:\n$$\n\\mathbf{\\Sigma_x}\\mathbf{v}_i = (\\mathbf{\\Sigma_s} + \\sigma_{n}^{2}\\mathbf{I})\\mathbf{v}_i = \\mathbf{\\Sigma_s}\\mathbf{v}_i + \\sigma_{n}^{2}\\mathbf{I}\\mathbf{v}_i = \\lambda_{s,i}\\mathbf{v}_i + \\sigma_{n}^{2}\\mathbf{v}_i = (\\lambda_{s,i} + \\sigma_{n}^{2})\\mathbf{v}_i\n$$\nThus, the eigenvalue of the observed data covariance matrix, $\\lambda_{x,i}$, is the sum of the signal variance $\\lambda_{s,i}$ and the noise variance $\\sigma_{n}^{2}$ for that component's direction:\n$$\n\\lambda_{x,i} = \\lambda_{s,i} + \\sigma_{n}^{2}\n$$\nThis allows us to express the signal variance for the $i$-th component in terms of the observed eigenvalue and the noise variance:\n$$\n\\lambda_{s,i} = \\lambda_{x,i} - \\sigma_{n}^{2}\n$$\n\nThe SNR for the $i$-th component is defined as the ratio of its signal variance to its noise variance. The signal variance is $\\lambda_{s,i}$. The noise variance along any direction $\\mathbf{v}_i$ (assuming $\\|\\mathbf{v}_i\\|=1$) is given by $\\mathbf{v}_i^T \\mathbf{\\Sigma_n} \\mathbf{v}_i = \\mathbf{v}_i^T (\\sigma_{n}^{2}\\mathbf{I}) \\mathbf{v}_i = \\sigma_{n}^{2}(\\mathbf{v}_i^T\\mathbf{v}_i) = \\sigma_{n}^{2}$.\nTherefore, the SNR for the $i$-th component is:\n$$\n\\mathrm{SNR}_i = \\frac{\\lambda_{s,i}}{\\sigma_{n}^{2}}\n$$\n\nThe problem specifies that we must retain components for which the SNR is at least $1$.\n$$\n\\mathrm{SNR}_i \\geq 1\n$$\nThis is equivalent to the parenthetical statement that \"signal variance at least equals noise variance\":\n$$\n\\lambda_{s,i} \\geq \\sigma_{n}^{2}\n$$\n\nTo make a decision based on the provided data, we substitute the expression for $\\lambda_{s,i}$ in terms of the observed eigenvalue $\\lambda_{x,i}$:\n$$\n\\lambda_{x,i} - \\sigma_{n}^{2} \\geq \\sigma_{n}^{2}\n$$\nThis simplifies to the final retention criterion:\n$$\n\\lambda_{x,i} \\geq 2\\sigma_{n}^{2}\n$$\n\nWe are given the eigenvalues of the sample covariance of the observed data:\n$$\n\\lambda_{x,i} \\in \\{12, 7, 3, 0.8, 0.5\\}\n$$\nAnd the estimated per-band noise variance:\n$$\n\\sigma_{n}^{2} = 1\n$$\nApplying the retention criterion, we need to find which eigenvalues satisfy $\\lambda_{x,i} \\geq 2 \\times 1 = 2$.\n\nLet's check each eigenvalue:\n1.  For the first component, $\\lambda_{x,1} = 12$. Since $12 \\geq 2$, this component is retained.\n2.  For the second component, $\\lambda_{x,2} = 7$. Since $7 \\geq 2$, this component is retained.\n3.  For the third component, $\\lambda_{x,3} = 3$. Since $3 \\geq 2$, this component is retained.\n4.  For the fourth component, $\\lambda_{x,4} = 0.8$. Since $0.8 < 2$, this component is discarded.\n5.  For the fifth component, $\\lambda_{x,5} = 0.5$. Since $0.5 < 2$, this component is discarded.\n\nThe eigenvalues that satisfy the criterion are $\\{12, 7, 3\\}$. Counting these components, we find that $3$ components are to be retained.",
            "answer": "$$\n\\boxed{3}\n$$"
        }
    ]
}