{
    "hands_on_practices": [
        {
            "introduction": "任何高光谱地质分析的第一步都是将传感器记录的原始数据——视辐射率（at-sensor radiance）——转换为地表固有的物理属性，即地表反射率。这个过程被称为大气校正，因为它旨在消除太阳-地表-传感器路径上大气散射和吸收造成的失真。本练习  将引导您通过一个简化的辐射传输模型，从给定的传感器测量值、大气路径辐射和透过率中，亲手计算出地表反射率，从而掌握大气校正的核心原理。",
            "id": "3820016",
            "problem": "一台高光谱成像光谱仪在晴空条件下观测一个矿化露头，采集中心波长为 $\\lambda$ 的狭窄地质波段上的数据。假设大气为平行平面大气，地表可近似为朗伯体，无邻近效应，且大气多次散射可忽略（无大气球面反照率）。光谱仪记录了沿视线方向的传感器处光谱辐亮度 $L(\\lambda)$ 和大气路径辐亮度 $L_{p}(\\lambda)$。大气外光谱辐照度为 $E_{0}(\\lambda)$，太阳天顶角为 $\\theta_{s}$。沿太阳路径和传感器路径的向上和向下的大气光谱透过率分别为 $T_{u}(\\lambda)$ 和 $T_{d}(\\lambda)$。请利用光谱辐亮度、光谱辐照度和地表反射率的定义，结合平行平面辐射传输分解为路径项和地表透射项的方法，推导出地表光谱反射率 $\\rho(\\lambda)$ 的表达式，并根据以下测量数据计算其值：\n$$L(\\lambda)=100 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}, \\quad L_{p}(\\lambda)=20 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1},$$\n$$E_{0}(\\lambda)\\cos\\theta_{s}=900 \\, \\text{W m}^{-2} \\text{ nm}^{-1}, \\quad T_{u}(\\lambda)T_{d}(\\lambda)=0.7.$$\n此处，$\\rho(\\lambda)$ 是朗伯体假设下的地表方向-半球反射率，它通过朗伯特性与双向反射分布函数（BRDF）相关。请将 $\\rho(\\lambda)$ 的最终数值结果四舍五入至四位有效数字，并表示为一个无量纲的小数。",
            "solution": "该问题要求基于简化的辐射传输模型，从传感器处的高光谱测量数据中推导出地表光谱反射率 $\\rho(\\lambda)$，然后利用所提供的数据进行计算。\n\n首先，我们验证问题陈述的有效性。\n已知条件如下：\n- 传感器处光谱辐亮度: $L(\\lambda)=100 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- 大气路径辐亮度: $L_{p}(\\lambda)=20 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- 大气层顶水平面光谱辐照度: $E_{0}(\\lambda)\\cos\\theta_{s}=900 \\, \\text{W m}^{-2} \\text{ nm}^{-1}$，其中 $E_{0}(\\lambda)$ 是大气外光谱辐照度，$\\theta_{s}$ 是太阳天顶角。\n- 向上和向下大气光谱透过率的乘积: $T_{u}(\\lambda)T_{d}(\\lambda)=0.7$\n\n假设条件如下：\n- 平行平面大气。\n- 朗伯体表面。\n- 无邻近效应。\n- 可忽略的大气多次散射。\n\n该问题在科学上基于辐射传输原理，这是遥感和大气物理学中的一个基本概念。各个物理量及其单位都是标准的，并且量纲一致。所提供的值在物理上是合理的。该问题是适定的，为在指定假设下获得唯一解提供了所有必要信息。它是客观的，没有歧义。因此，该问题是有效的，我们可以继续进行求解。\n\n基本原理是，传感器测量的总光谱辐亮度 $L(\\lambda)$ 是由大气直接散射到传感器视场内的辐亮度（路径辐亮度, $L_p(\\lambda)$）与源自太阳、经地表反射、再穿过大气传输到传感器的辐亮度之和。\n\n传感器处的光谱辐亮度 $L(\\lambda)$ 可以表示为：\n$$L(\\lambda) = L_{p}(\\lambda) + L_{surface-reflected}(\\lambda)$$\n其中 $L_{surface-reflected}(\\lambda)$ 是源于地表反射的辐亮度分量。\n\n现在我们必须构建 $L_{surface-reflected}(\\lambda)$ 这一项。\n1.  大气层顶水平面上的太阳光谱辐照度为 $E_{0}(\\lambda)\\cos\\theta_{s}$。\n2.  该辐射穿过大气传输到地表。向下的大气光谱透过率为 $T_{d}(\\lambda)$。因此，入射到地表的光谱辐照度为 $E_{g}(\\lambda)$。在可忽略多次散射的假设下，我们只考虑直接太阳辐射束，因此到达地表的总辐照度为：\n    $$E_{g}(\\lambda) = E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda)$$\n3.  假设地表为朗伯体。对于一个光谱反射率为 $\\rho(\\lambda)$ 的朗伯体表面，其反射的辐亮度是各向同性的（与观测方向无关），并通过以下公式与总的入射半球光谱辐照度 $E_g(\\lambda)$ 相关：\n    $$L_{refl}(\\lambda) = \\frac{\\rho(\\lambda) E_{g}(\\lambda)}{\\pi}$$\n    因子 $\\pi$ 来自于对各向同性辐亮度在出射方向的半球上进行积分，该积分必须等于反射出射度 $M = \\rho(\\lambda) E_g(\\lambda)$。对于朗伯体表面，有 $M = \\pi L$。\n4.  将 $E_{g}(\\lambda)$ 的表达式代入 $L_{refl}(\\lambda)$ 的方程中：\n    $$L_{refl}(\\lambda) = \\frac{\\rho(\\lambda)}{\\pi} \\left( E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) \\right)$$\n5.  从地表反射的辐亮度 $L_{refl}(\\lambda)$ 在向上穿过大气到达传感器的过程中会发生衰减。沿传感器路径的向上大气光谱透过率为 $T_{u}(\\lambda)$。因此，到达传感器的地表反射辐亮度为：\n    $$L_{surface-reflected}(\\lambda) = L_{refl}(\\lambda) T_{u}(\\lambda) = \\left( \\frac{\\rho(\\lambda)}{\\pi} E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) \\right) T_{u}(\\lambda)$$\n\n现在，我们将其代回到 $L(\\lambda)$ 的主方程中：\n$$L(\\lambda) = L_{p}(\\lambda) + \\frac{\\rho(\\lambda)}{\\pi} E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) T_{u}(\\lambda)$$\n\n任务的第一部分是推导地表光谱反射率 $\\rho(\\lambda)$ 的表达式。我们重新整理方程以求解 $\\rho(\\lambda)$：\n$$L(\\lambda) - L_{p}(\\lambda) = \\frac{\\rho(\\lambda)}{\\pi} E_{0}(\\lambda)\\cos\\theta_{s} T_{d}(\\lambda) T_{u}(\\lambda)$$\n$$\\rho(\\lambda) = \\frac{\\pi \\left( L(\\lambda) - L_{p}(\\lambda) \\right)}{E_{0}(\\lambda)\\cos\\theta_{s} T_{u}(\\lambda) T_{d}(\\lambda)}$$\n这就是所求的地表光谱反射率的解析表达式。\n\n任务的第二部分是使用给定的数值计算该表达式。为简化计算中的标记，我们省略对 $\\lambda$ 的显式依赖：\n- $L = 100 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- $L_{p} = 20 \\, \\text{W m}^{-2} \\text{ sr}^{-1} \\text{ nm}^{-1}$\n- $E_{0}\\cos\\theta_{s} = 900 \\, \\text{W m}^{-2} \\text{ nm}^{-1}$\n- $T_{u}T_{d} = 0.7$\n\n将这些值代入推导出的 $\\rho$ 公式中：\n$$\\rho = \\frac{\\pi \\left( 100 - 20 \\right)}{900 \\times 0.7}$$\n$$\\rho = \\frac{80\\pi}{630}$$\n$$\\rho = \\frac{8\\pi}{63}$$\n\n现在我们计算数值：\n$$\\rho \\approx \\frac{8 \\times 3.14159265}{63}$$\n$$\\rho \\approx \\frac{25.1327412}{63}$$\n$$\\rho \\approx 0.39893240045...$$\n\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $3$、$9$、$8$、$9$。第五位有效数字是 $3$，小于 $5$，所以我们向下取整（即截断）。\n$$\\rho \\approx 0.3989$$\n这是一个无量纲的量，符合反射率的预期。",
            "answer": "$$\\boxed{0.3989}$$"
        },
        {
            "introduction": "获得了准确的地表反射率光谱后，下一步便是从中提取与特定矿物成分相关的诊断性信息。矿物的“指纹”通常表现为在特定波长位置的吸收特征。本练习  将教您一种关键的光谱分析技术：连续体去除和吸收深度计算。通过对一个典型的碳酸盐矿物吸收特征进行量化，您将学会如何标准化光谱特征，以便进行可靠的矿物识别和填图。",
            "id": "3820046",
            "problem": "一台高光谱成像（HSI）光谱仪测量了富含碳酸盐的露头上的表面双向反射因子 $R(\\lambda)$。一个与金属-碳酸盐泛频相关的吸收特征中心位于 $2.33\\,\\mu\\mathrm{m}$ 附近，其肩部分别位于 $2.30\\,\\mu\\mathrm{m}$ 和 $2.36\\,\\mu\\mathrm{m}$。测得的反射率分别为 $R(2.30\\,\\mu\\mathrm{m}) = 0.42$，$R(2.36\\,\\mu\\mathrm{m}) = 0.46$，以及一个局部最小值 $R(2.33\\,\\mu\\mathrm{m}) = 0.35$。为了进行包络线去除，将包络线反射率 $R_{c}(\\lambda)$ 定义为穿過 $2.30\\,\\mu\\mathrm{m}$ 和 $2.36\\,\\mu\\mathrm{m}$ 处两个肩部点的直线。使用在吸收最小值处评估的标准包络线去除谱带深度定义，计算在 $\\lambda = 2.33\\,\\mu\\mathrm{m}$ 处经包络线去除后的谱带深度。將最终答案表示为一个无量纲分数，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算高光谱反射光谱中特定吸收特征的经包络线去除后的谱带深度。该过程包括定义线性包络线，计算其在吸收最小值处的值，然后应用谱带深度的标准公式。\n\n题目给出的已知条件是：\n- 吸收特征的肩部点位于波长 $\\lambda_1 = 2.30\\,\\mu\\mathrm{m}$ 处，反射率为 $R_1 = R(2.30) = 0.42$；以及波长 $\\lambda_2 = 2.36\\,\\mu\\mathrm{m}$ 处，反射率为 $R_2 = R(2.36) = 0.46$。\n- 吸收特征在波长 $\\lambda_{min} = 2.33\\,\\mu\\mathrm{m}$ 处有一个局部最小值，测得的反射率为 $R_{min} = R(2.33) = 0.35$。\n\n第一步是确定包络线反射率 $R_c(\\lambda)$ 的方程，它被定义为穿过两个肩部点 $(\\lambda_1, R_1)$ 和 $(\\lambda_2, R_2)$ 的直线。线性方程的一般两点式为：\n$$R_c(\\lambda) = R_1 + \\frac{R_2 - R_1}{\\lambda_2 - \\lambda_1}(\\lambda - \\lambda_1)$$\n\n我们需要计算该包络线反射率在吸收最小值波长 $\\lambda_{min} = 2.33\\,\\mu\\mathrm{m}$ 处的值。将给定值代入方程中：\n$$R_c(\\lambda_{min}) = R_c(2.33) = R_1 + \\frac{R_2 - R_1}{\\lambda_2 - \\lambda_1}(\\lambda_{min} - \\lambda_1)$$\n$$R_c(2.33) = 0.42 + \\frac{0.46 - 0.42}{2.36 - 2.30}(2.33 - 2.30)$$\n\n现在，我们来计算数值：\n$$R_c(2.33) = 0.42 + \\frac{0.04}{0.06}(0.03)$$\n$$R_c(2.33) = 0.42 + \\left(\\frac{2}{3}\\right)(0.03)$$\n$$R_c(2.33) = 0.42 + 0.02$$\n$$R_c(2.33) = 0.44$$\n这是包络线在吸收最小值波长处的反射率值。\n\n下一步是计算经包络线去除后的谱带深度，记为 $BD$。谱带深度的标准定义是将吸收特征的深度相对于包络线水平进行归一化，使其成为一个无量纲的量。其公式为：\n$$BD(\\lambda) = \\frac{R_c(\\lambda) - R(\\lambda)}{R_c(\\lambda)} = 1 - \\frac{R(\\lambda)}{R_c(\\lambda)}$$\n\n我们利用测得的反射率 $R_{min} = R(2.33) = 0.35$ 和计算出的包络线反射率 $R_c(2.33) = 0.44$ 来评估吸收最小值 $\\lambda_{min} = 2.33\\,\\mu\\mathrm{m}$ 处的谱带深度：\n$$BD(2.33) = 1 - \\frac{R(2.33)}{R_c(2.33)}$$\n$$BD(2.33) = 1 - \\frac{0.35}{0.44}$$\n\n为了求出精确的分数值：\n$$BD(2.33) = \\frac{0.44 - 0.35}{0.44} = \\frac{0.09}{0.44} = \\frac{9}{44}$$\n\n最后，我们按照要求将这个分数转换成小数，并四舍五入到四位有效数字：\n$$BD(2.33) = \\frac{9}{44} \\approx 0.20454545...$$\n四舍五入到四位有效数字得到 $0.2045$。",
            "answer": "$$\\boxed{0.2045}$$"
        },
        {
            "introduction": "在处理包含数百万像素的高光谱数据立方体时，我们面临着数据维度高和噪声普遍存在的双重挑战。为了有效进行大规模地质填图，必须对数据进行预处理，以增强信号质量并降低计算复杂性。最小噪声分离（Minimum Noise Fraction, MNF）变换是一种强大的标准化技术，本练习  将带您深入其核心原理。您将学会如何利用数据的协方差矩阵特征值和噪声方差来判断哪些成分是富含信息的“信号”，哪些是应被舍弃的“噪声”，这是高光谱数据处理流程中至关重要的一步。",
            "id": "3820058",
            "problem": "一个矿化露头的高光谱场景通过一个加性信号加噪声过程建模，其中每个观测到的光谱向量 $\\mathbf{x} \\in \\mathbb{R}^{p}$ 是一个潜在信号 $\\mathbf{s}$ 和一个加性噪声 $\\mathbf{n}$ 的和，即 $\\mathbf{x} = \\mathbf{s} + \\mathbf{n}$。假设噪声为零均值，与信号不相关，并且是空间白噪声，每个波段的方差为 $\\sigma_{n}^{2}$，因此 $\\mathrm{Cov}(\\mathbf{n}) = \\sigma_{n}^{2}\\mathbf{I}$。您计算了去均值的观测数据的样本协方差，发现其特征值为 $\\{12, 7, 3, 0.8, 0.5\\}$。一项独立的噪声表征得出的估计每波段噪声方差为 $\\sigma_{n}^{2} = 1$。在进行地质和矿物填图之前，您打算执行最小噪声分数（MNF）变换以进行降维，只保留信噪比（SNR）至少为 $1$ 的分量（即信号方差至少等于噪声方差）。\n\n仅从加性模型 $\\mathbf{x}=\\mathbf{s}+\\mathbf{n}$、协方差可加性 $\\mathrm{Cov}(\\mathbf{x})=\\mathrm{Cov}(\\mathbf{s})+\\mathrm{Cov}(\\mathbf{n})$、SNR 定义为沿一个分量的信号方差与噪声方差之比，以及各向同性噪声下协方差矩阵特征值的性质出发，确定在所述的 SNR 阈值下要保留多少个 MNF 分量，并根据观测到的特征值、信号方差和噪声方差之间的关系来证明您的选择。\n\n请以单个整数作为最终答案，表示保留的分量数量。无需四舍五入，不涉及物理单位。",
            "solution": "该问题被认为是有效的，因为它在信号处理和线性代数方面有科学依据，信息充分且一致，问题提法得当，并且陈述客观。\n\n该问题要求根据信噪比（SNR）准则，确定在最小噪声分数（MNF）变换后要保留的分量数量。我们首先将所给定的关系形式化。\n\n观测到的光谱向量 $\\mathbf{x}$ 由以下加性模型描述：\n$$\n\\mathbf{x} = \\mathbf{s} + \\mathbf{n}\n$$\n其中 $\\mathbf{s}$ 是潜在信号，$\\mathbf{n}$ 是加性噪声。\n\n信号 $\\mathbf{s}$ 和噪声 $\\mathbf{n}$ 被说明为不相关。这个性质意味着观测数据 $\\mathbf{x}$ 的协方差矩阵 $\\mathrm{Cov}(\\mathbf{x})$（或 $\\mathbf{\\Sigma_x}$）是信号 $\\mathbf{s}$ 的协方差矩阵 $\\mathrm{Cov}(\\mathbf{s})$（或 $\\mathbf{\\Sigma_s}$）与噪声 $\\mathbf{n}$ 的协方差矩阵 $\\mathrm{Cov}(\\mathbf{n})$（或 $\\mathbf{\\Sigma_n}$）之和：\n$$\n\\mathbf{\\Sigma_x} = \\mathbf{\\Sigma_s} + \\mathbf{\\Sigma_n}\n$$\n\n噪声被指定为空间白噪声，其每波段方差为 $\\sigma_{n}^{2}$。这正是各向同性噪声的定义，意味着其协方差矩阵是一个缩放的单位矩阵：\n$$\n\\mathbf{\\Sigma_n} = \\sigma_{n}^{2}\\mathbf{I}\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。\n\n将此代入协方差可加性方程，得到：\n$$\n\\mathbf{\\Sigma_x} = \\mathbf{\\Sigma_s} + \\sigma_{n}^{2}\\mathbf{I}\n$$\n\nMNF 变换识别按 SNR 排序的分量。这些分量对应于信号的主成分，即信号协方差矩阵 $\\mathbf{\\Sigma_s}$ 的特征向量。设 $\\mathbf{v}_i$ 是 $\\mathbf{\\Sigma_s}$ 的一个特征向量，其对应的特征值为 $\\lambda_{s,i}$。特征值 $\\lambda_{s,i}$ 表示沿特征向量 $\\mathbf{v}_i$ 方向的信号方差。\n$$\n\\mathbf{\\Sigma_s}\\mathbf{v}_i = \\lambda_{s,i}\\mathbf{v}_i\n$$\n\n各向同性噪声的假设使我们能够建立信号协方差 $\\mathbf{\\Sigma_s}$ 和观测数据协方差 $\\mathbf{\\Sigma_x}$ 的特征值之间的直接关系。因为 $\\mathbf{\\Sigma_s}$ 和 $\\sigma_{n}^{2}\\mathbf{I}$ 可同时对角化（任何矩阵都与单位矩阵可交换），它们共享相同的特征向量集。因此，$\\mathbf{v}_i$ 也是 $\\mathbf{\\Sigma_x}$ 的一个特征向量。让我们找出对应的特征值 $\\lambda_{x,i}$：\n$$\n\\mathbf{\\Sigma_x}\\mathbf{v}_i = (\\mathbf{\\Sigma_s} + \\sigma_{n}^{2}\\mathbf{I})\\mathbf{v}_i = \\mathbf{\\Sigma_s}\\mathbf{v}_i + \\sigma_{n}^{2}\\mathbf{I}\\mathbf{v}_i = \\lambda_{s,i}\\mathbf{v}_i + \\sigma_{n}^{2}\\mathbf{v}_i = (\\lambda_{s,i} + \\sigma_{n}^{2})\\mathbf{v}_i\n$$\n因此，观测数据协方差矩阵的特征值 $\\lambda_{x,i}$ 是该分量方向上的信号方差 $\\lambda_{s,i}$ 和噪声方差 $\\sigma_{n}^{2}$ 之和：\n$$\n\\lambda_{x,i} = \\lambda_{s,i} + \\sigma_{n}^{2}\n$$\n这使我们能够用观测到的特征值和噪声方差来表示第 $i$ 个分量的信号方差：\n$$\n\\lambda_{s,i} = \\lambda_{x,i} - \\sigma_{n}^{2}\n$$\n\n第 $i$ 个分量的信噪比（SNR）定义为其信号方差与噪声方差的比值。信号方差是 $\\lambda_{s,i}$。沿任意方向 $\\mathbf{v}_i$（假设 $\\|\\mathbf{v}_i\\|=1$）的噪声方差由 $\\mathbf{v}_i^T \\mathbf{\\Sigma_n} \\mathbf{v}_i = \\mathbf{v}_i^T (\\sigma_{n}^{2}\\mathbf{I}) \\mathbf{v}_i = \\sigma_{n}^{2}(\\mathbf{v}_i^T\\mathbf{v}_i) = \\sigma_{n}^{2}$ 给出。\n因此，第 $i$ 个分量的 SNR 为：\n$$\n\\mathrm{SNR}_i = \\frac{\\lambda_{s,i}}{\\sigma_{n}^{2}}\n$$\n\n问题规定我们必须保留 SNR 至少为 $1$ 的分量。\n$$\n\\mathrm{SNR}_i \\geq 1\n$$\n这等同于括号中的陈述“信号方差至少等于噪声方差”：\n$$\n\\lambda_{s,i} \\geq \\sigma_{n}^{2}\n$$\n\n为了根据所提供的数据做出决策，我们将用观测特征值 $\\lambda_{x,i}$ 表示的 $\\lambda_{s,i}$ 的表达式代入：\n$$\n\\lambda_{x,i} - \\sigma_{n}^{2} \\geq \\sigma_{n}^{2}\n$$\n这可以简化为最终的保留准则：\n$$\n\\lambda_{x,i} \\geq 2\\sigma_{n}^{2}\n$$\n\n我们已知观测数据的样本协方差的特征值：\n$$\n\\lambda_{x,i} \\in \\{12, 7, 3, 0.8, 0.5\\}\n$$\n以及估计的每波段噪声方差：\n$$\n\\sigma_{n}^{2} = 1\n$$\n应用保留准则，我们需要找出哪些特征值满足 $\\lambda_{x,i} \\geq 2 \\times 1 = 2$。\n\n让我们逐一检查每个特征值：\n1.  对于第一个分量，$\\lambda_{x,1} = 12$。因为 $12 \\geq 2$，所以保留该分量。\n2.  对于第二个分量，$\\lambda_{x,2} = 7$。因为 $7 \\geq 2$，所以保留该分量。\n3.  对于第三个分量，$\\lambda_{x,3} = 3$。因为 $3 \\geq 2$，所以保留该分量。\n4.  对于第四个分量，$\\lambda_{x,4} = 0.8$。因为 $0.8  2$，所以舍弃该分量。\n5.  对于第五个分量，$\\lambda_{x,5} = 0.5$。因为 $0.5  2$，所以舍弃该分量。\n\n满足该准则的特征值是 $\\{12, 7, 3\\}$。计算这些分量的数量，我们发现应保留 $3$ 个分量。",
            "answer": "$$\n\\boxed{3}\n$$"
        }
    ]
}