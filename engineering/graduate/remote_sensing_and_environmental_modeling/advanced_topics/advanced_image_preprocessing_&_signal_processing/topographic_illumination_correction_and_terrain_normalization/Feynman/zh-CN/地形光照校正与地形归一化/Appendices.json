{
    "hands_on_practices": [
        {
            "introduction": "第一个练习旨在为地形校正奠定基础。我们将从第一性原理出发，在理想化的朗伯体表面假设下，推导经典的余弦校正模型。通过应用该模型并分析测量噪声的影响，您将对地形几何如何影响观测反射率以及如何初步对其进行校正获得核心理解。",
            "id": "3862388",
            "problem": "在晴空条件下，观测到一个位于倾斜地形面上的被动光学遥感像素。遥感反射率 $R$ 定义为出射辐亮度与入射辐照度之比，其假设是双向反射分布函数 (BRDF) 近似为各向同性，即地表在相关角度范围内表现为朗伯体。对于大气外辐照度为 $E_{0}$ 的太阳直射光束，入射到表面单元上的辐照度由光束在表面法线方向上的投影给出。在水平面上，入射辐照度与 $\\cos \\theta_{s}$ 成正比，其中 $\\theta_{s}$ 是太阳天顶角。在倾斜表面上，入射辐照度与 $\\cos i$ 成正比，其中 $i$ 是由地形几何形状和太阳位置决定的太阳光束与表面法线之间的局部入射角。\n\n从这些几何和辐射定义出发，推导地形归一化反射率 $R_{corr}$ 的表达式，该反射率是在相同大气和传感器条件下，如果同一地表单元是水平时所能观测到的值。然后，使用此表达式，计算一个像素的 $R_{corr}$，其观测反射率 $R_{obs} = 0.12$，太阳天顶角 $\\theta_{s} = 35^{\\circ}$，局部光照因子 $\\cos i = 0.6$。在计算前，通过将以度为单位的参数 $\\theta_{s}$ 转换为弧度来处理三角函数。\n\n假设测量的 $R_{obs}$ 受到附加的、零均值的高斯噪声的干扰，其标准差为 $\\sigma_{R} = 0.05$（反射率单位）。将 $R_{obs}$ 视为真实平均反射率的最佳估计，并将校正后的反射率建模为带噪声测量值的线性变换。在被动光学遥感的反射率介于 $0$ 和 $1$ 之间的物理约束下，计算校正后的反射率位于区间 $[0, 1]$ 内的概率（以小数表示）。将所有数值结果四舍五入到四位有效数字。最终答案应以无量纲的反射率单位表示，概率以小数形式表示（无百分号）。",
            "solution": "该问题要求推导地形归一化反射率，进行后续的数值计算，并基于噪声模型进行概率分析。我们首先验证问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- 遥感反射率的定义：$R$ 是出射辐亮度与入射辐照度之比。\n- 地表BRDF假设：各向同性（朗伯体）。\n- 水平面上的入射辐照度与 $\\cos \\theta_{s}$ 成正比，其中 $\\theta_{s}$ 是太阳天顶角。\n- 倾斜表面上的入射辐照度与 $\\cos i$ 成正比，其中 $i$ 是局部入射角。\n- 目标1：推导地形归一化反射率 $R_{corr}$ 的表达式。\n- 目标2：根据给定数据计算 $R_{corr}$。\n- 目标3：计算校正后的反射率在物理边界 $[0, 1]$ 内的概率。\n- 计算数据：\n    - 观测反射率，$R_{obs} = 0.12$。\n    - 太阳天顶角，$\\theta_{s} = 35^{\\circ}$。\n    - 局部光照因子，$\\cos i = 0.6$。\n- 噪声模型：$R_{obs}$ 受到附加的、零均值的高斯噪声干扰，标准差为 $\\sigma_{R} = 0.05$。\n- 物理约束：反射率限制在区间 $[0, 1]$ 内。\n- 四舍五入：所有数值结果保留四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了遥感中用于地形效应的标准余弦校正方法。所做的假设（朗伯体表面，直接光照）是建立一阶模型时常用的简化方法。这是一个适定的问题，因为它提供了一组明确的目标和实现这些目标所需的所有数据（$R_{obs}$，$\\theta_s$，$\\cos i$，$\\sigma_R$）。其语言是客观的，数值在物理上是现实的。该问题并非微不足道，因为它需要推导、数值计算以及将概率论应用于误差模型。没有违反任何科学定律，且设置是内部一致的。\n\n### 步骤3：结论与行动\n该问题被认为是**有效的**。我们继续进行解答。\n\n### 第1部分：地形归一化反射率的推导\n设 $\\rho_{true}$ 为表面材料固有的、与地形无关的朗伯反射率。这就是问题中所谓的“地形归一化反射率”，$R_{corr}$。\n对于朗伯体表面，出射辐亮度 $L$ 与入射辐照度 $E_{inc}$ 及固有反射率 $\\rho_{true}$ 之间的关系由以下公式给出：\n$$L = \\frac{\\rho_{true}}{\\pi} E_{inc}$$\n倾斜表面上的入射辐照度 $E_{tilted}$ 与局部太阳入射角 $i$ 的余弦成正比。设 $E_{direct}$ 是经过大气衰减后到达地表的太阳直射辐照度。那么：\n$$E_{tilted} = E_{direct} \\cos i$$\n因此，离开倾斜表面的辐亮度为：\n$$L = \\frac{\\rho_{true}}{\\pi} (E_{direct} \\cos i)$$\n在遥感中，观测反射率或表观反射率 $R_{obs}$ 通常通过将测量的辐亮度 $L$ 用将入射到水平表面上的太阳辐照度 $E_{horiz}$ 进行归一化来计算。这是因为在初始数据处理过程中，通常默认地形是平坦的。\n在同一位置的假设水平表面上的辐照度为：\n$$E_{horiz} = E_{direct} \\cos \\theta_s$$\n那么表观反射率 $R_{obs}$ 定义为：\n$$R_{obs} = \\frac{\\pi L}{E_{horiz}}$$\n将 $L$ 和 $E_{horiz}$ 的表达式代入此方程可得：\n$$R_{obs} = \\frac{\\pi}{E_{direct} \\cos \\theta_s} \\left( \\frac{\\rho_{true}}{\\pi} E_{direct} \\cos i \\right)$$\n项 $\\pi$ 和 $E_{direct}$ 被消去，得到表观反射率和固有反射率之间的关系：\n$$R_{obs} = \\rho_{true} \\frac{\\cos i}{\\cos \\theta_s}$$\n问题将地形归一化反射率定义为 $R_{corr}$，也就是我们的 $\\rho_{true}$。因此，我们求解 $R_{corr}$：\n$$R_{corr} = R_{obs} \\frac{\\cos \\theta_s}{\\cos i}$$\n这就是所需的地形归一化反射率的表达式。\n\n### 第2部分：$R_{corr}$ 的数值计算\n给定 $R_{obs} = 0.12$，$\\theta_s = 35^{\\circ}$，以及 $\\cos i = 0.6$。值 $R_{obs} = 0.12$ 是带噪声测量的均值。我们首先计算校正后反射率的均值 $\\mu_{corr}$。\n首先，我们计算 $\\cos \\theta_s$ 的值：\n$$\\cos(35^{\\circ}) \\approx 0.819152$$\n现在，我们将给定值代入推导出的表达式：\n$$\\mu_{corr} = 0.12 \\times \\frac{\\cos(35^{\\circ})}{0.6} \\approx 0.12 \\times \\frac{0.819152}{0.6} \\approx 0.1638304$$\n四舍五入到四位有效数字，估计的地形归一化反射率为 $0.1638$。\n\n### 第3部分：概率分析\n观测反射率 $R_{obs}$ 被建模为一个高斯随机变量，我们记为 $\\mathcal{R}_{obs}$，其均值为 $\\mu_{R} = 0.12$，标准差为 $\\sigma_{R} = 0.05$。\n$$\\mathcal{R}_{obs} \\sim N(\\mu_{R}, \\sigma_{R}^2)$$\n校正后的反射率 $\\mathcal{R}_{corr}$ 是 $\\mathcal{R}_{obs}$ 的一个线性变换：\n$$\\mathcal{R}_{corr} = \\mathcal{R}_{obs} \\left( \\frac{\\cos \\theta_s}{\\cos i} \\right)$$\n令校正系数为 $C = \\frac{\\cos \\theta_s}{\\cos i}$。\n$$C = \\frac{\\cos(35^{\\circ})}{0.6} \\approx \\frac{0.819152}{0.6} \\approx 1.36525$$\n由于 $\\mathcal{R}_{corr}$ 是高斯随机变量的线性变换，因此它也是一个高斯随机变量。其均值 $\\mu_{corr}$ 和标准差 $\\sigma_{corr}$ 由下式给出：\n$$\\mu_{corr} = C \\mu_{R} \\approx 1.36525 \\times 0.12 \\approx 0.16383$$\n$$\\sigma_{corr} = |C| \\sigma_{R} \\approx 1.36525 \\times 0.05 \\approx 0.0682625$$\n所以，校正后的反射率服从分布 $\\mathcal{R}_{corr} \\sim N(\\mu_{corr} = 0.16383, \\sigma_{corr}^2 = 0.0682625^2)$。\n\n我们需要计算 $\\mathcal{R}_{corr}$ 位于物理上有意义的区间 $[0, 1]$ 内的概率：\n$$P(0 \\le \\mathcal{R}_{corr} \\le 1)$$\n为此，我们将变量 $\\mathcal{R}_{corr}$ 标准化为一个标准正态变量 $Z \\sim N(0, 1)$，其中 $Z = (\\mathcal{R}_{corr} - \\mu_{corr}) / \\sigma_{corr}$。\n概率变为：\n$$P\\left( \\frac{0 - \\mu_{corr}}{\\sigma_{corr}} \\le Z \\le \\frac{1 - \\mu_{corr}}{\\sigma_{corr}} \\right)$$\n让我们计算标准化的下限 $z_1$ 和上限 $z_2$：\n$$z_1 = \\frac{0 - 0.16383}{0.0682625} \\approx -2.3999$$\n$$z_2 = \\frac{1 - 0.16383}{0.0682625} = \\frac{0.83617}{0.0682625} \\approx 12.249$$\n概率由 $\\Phi(z_2) - \\Phi(z_1)$ 给出，其中 $\\Phi$ 是标准正态分布的累积分布函数 (CDF)。\n$$P(-2.3999 \\le Z \\le 12.249) = \\Phi(12.249) - \\Phi(-2.3999)$$\n$\\Phi(12.249)$ 的值极其接近 $1$。$\\Phi(-2.3999)$ 的值可以使用标准正态分布表或计算函数找到。\n$$\\Phi(-2.3999) \\approx 0.008198$$\n因此，概率为：\n$$P \\approx 1 - 0.008198 = 0.991802$$\n四舍五入到四位有效数字，概率为 $0.9918$。\n\n最终结果，四舍五入到四位有效数字，是：\n- 地形归一化反射率 $R_{corr}$：$0.1638$。\n- 概率 $P(0 \\le R_{corr} \\le 1)$：$0.9918$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.1638  0.9918 \\end{pmatrix}}$$"
        },
        {
            "introduction": "真实世界的地表很少表现为完美的朗伯反射体。本练习将从理想模型转向一种广泛应用的半经验方法——C模型校正，该方法考虑了数据中观测到的非朗伯效应。您将学习构建并应用这种更精细的模型，这是在实际应用中实现更准确、更稳健的地形归一化的关键一步。",
            "id": "3862401",
            "problem": "在山区地形中，由坡度和坡向引起的局部光照变化会改变天底观测光学传感器记录的表观地表反射率。考虑一个已校准为地表反射率的传感器的单光谱波段。设太阳以太阳天顶角 $\\theta_{s}$ 为特征，设一个像素的局部入射角 $i$ 是地表法线与光照方向之间的夹角。角度以弧度为单位，其余弦值为无量纲量。假设以下基于物理原理并得到经验支持的建模基础：\n\n- 对于一个完美的朗伯体表面，在恒定辐照度下，出射辐射亮度与 $\\cos i$ 成正比，因此表观反射率与 $\\cos i$ 呈线性比例关系。\n- 真实表面并非完美的朗伯体。在均质地表覆盖上，通常可以发现观测反射率与局部光照之间存在逐波段的经验线性关系：观测反射率 $R_{\\text{obs}}$ 通过波段特定的回归参数 $a$（斜率）和 $b$（截距）与 $\\cos i$ 近似呈线性变化，这些参数是通过野外或基于图像的采样估算的，其中地形变化涵盖了一系列的 $i$ 值，但地表覆盖保持不变。\n\n基于这些基础，构建一个地形归一化模型，将局部光照 $\\cos i$ 下像素的观测反射率 $R_{\\text{obs}}$ 映射到相同太阳几何条件下（以 $\\cos \\theta_{s}$ 为特征）的假设平坦地形所期望的反射率。您的归一化必须对 $R_{\\text{obs}}$ 是乘性的，仅依赖于 $\\cos \\theta_{s}$、$\\cos i$ 以及经验回归参数 $a$ 和 $b$，并且当 $\\cos i = \\cos \\theta_{s}$ 时，简化为恒等映射。\n\n然后，对于回归参数 $a = 0.18$ 和 $b = 0.03$ 的单光谱波段，计算您的归一化所隐含的波段特定常数 $C$，并将所得的校正应用于一个 $R_{\\text{obs}} = 0.20$、$\\cos \\theta_{s} = 0.82$ 和 $\\cos i = 0.55$ 的像素。\n\n将您最终的地形归一化反射率四舍五入至四位有效数字，并将其表示为无单位的反射率。",
            "solution": "用户希望我解决这个问题。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n-   太阳以太阳天顶角 $\\theta_{s}$ 为特征。\n-   一个像素的局部入射角是 $i$。\n-   观测反射率为 $R_{\\text{obs}}$。\n-   对于均质地表覆盖存在经验线性关系：$R_{\\text{obs}} \\approx a \\cos i + b$，其中 $a$ 和 $b$ 是波段特定的回归参数。\n-   目标是构建一个地形归一化模型，将 $R_{\\text{obs}}$ 映射到假设平坦地形所期望的反射率，其中入射角等于太阳天顶角，即 $i = \\theta_{s}$。\n-   约束1：归一化必须对 $R_{\\text{obs}}$ 是乘性的。\n-   约束2：归一化必须仅依赖于 $\\cos \\theta_{s}$、$\\cos i$、$a$ 和 $b$。\n-   约束3：当 $\\cos i = \\cos \\theta_{s}$ 时，归一化必须简化为恒等映射。\n-   用于计算的数值：\n    -   $a = 0.18$\n    -   $b = 0.03$\n    -   $R_{\\text{obs}} = 0.20$\n    -   $\\cos \\theta_{s} = 0.82$\n    -   $\\cos i = 0.55$\n-   最终的归一化反射率应四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题基于光学遥感的既定原理。朗伯模型是一个起点，而线性经验模型 $R_{\\text{obs}} \\approx a \\cos i + b$ 是著名的半经验地形校正方法（如C-校正方法）的基础。\n-   **适定性**：该问题是适定的。它提供了清晰的约束和足够的信息来推导唯一的归一化函数并计算数值结果。\n-   **客观性**：问题以客观、定量的术语陈述，没有主观或模糊的语言。\n-   **缺陷核查**：该问题没有违反任何无效标准。它在科学上是合理的，可形式化的，完整的，并且其前提和数据是现实的。其结构是逻辑的，可以得出一个唯一且有意义的解。\n\n**步骤3：结论与行动**\n该问题是**有效的**。将提供完整解答。\n\n**地形归一化的推导**\n\n目标是找到一个归一化反射率 $R_{N}$，它代表观测表面在水平（平坦）情况下的反射率。对于平坦表面，局部入射角 $i$ 等于太阳天顶角 $\\theta_{s}$。\n\n该问题基于在变化地形下，针对均质地表覆盖类型的观测反射率的经验线性模型：\n$$R_{\\text{model}}(\\cos i) = a \\cos i + b$$\n该模型描述了在给定光照条件（以 $\\cos i$ 为特征）下的期望反射率。特定像素的观测反射率 $R_{\\text{obs}}$ 可能会因与地形无关的表面固有属性变化（例如，湿度、密度）而偏离此模型。\n\n我们可以将这种固有变异性建模为一个乘性因子 $f_{\\text{int}}$，它对模型反射率进行缩放：\n$$R_{\\text{obs}} = f_{\\text{int}} \\cdot (a \\cos i + b)$$\n这个因子 $f_{\\text{int}} = \\frac{R_{\\text{obs}}}{a \\cos i + b}$ 代表特定像素与回归线所描述的“平均”或“理想”像素相比的明暗程度。\n\n地形归一化的目标是消除地形效应（与 $\\cos i$ 相关），同时保留这种固有变异性。归一化反射率 $R_N$ 应对应于同一像素在平坦表面上（即入射角为 $\\theta_s$）时的反射率。我们通过将固有因子 $f_{\\text{int}}$ 应用于平坦表面的模型反射率来实现这一点：\n$$R_N = f_{\\text{int}} \\cdot R_{\\text{model}}(\\cos \\theta_s)$$\n代入 $f_{\\text{int}}$ 和 $R_{\\text{model}}(\\cos \\theta_s)$ 的表达式：\n$$R_N = \\left( \\frac{R_{\\text{obs}}}{a \\cos i + b} \\right) \\cdot (a \\cos \\theta_s + b)$$\n重新整理这个方程，得到一个对 $R_{\\text{obs}}$ 的乘性校正：\n$$R_N = R_{\\text{obs}} \\left( \\frac{a \\cos \\theta_s + b}{a \\cos i + b} \\right)$$\n这就是所求的地形归一化公式。让我们根据问题的约束条件来验证它：\n1.  它对 $R_{\\text{obs}}$ 是乘性的，校正因子为 $K = \\frac{a \\cos \\theta_s + b}{a \\cos i + b}$。\n2.  因子 $K$ 仅依赖于 $\\cos \\theta_{s}$、$\\cos i$、$a$ 和 $b$。\n3.  如果 $\\cos i = \\cos \\theta_{s}$，校正因子变为 $K = \\frac{a \\cos \\theta_s + b}{a \\cos \\theta_s + b} = 1$，因此 $R_N = R_{\\text{obs}}$。该映射为恒等映射。\n\n所有约束条件均满足。\n\n**计算**\n\n问题要求首先计算归一化所隐含的波段特定常数 $C$。该常数是比率 $C = b/a$，它是此方法（称为C-校正）标准公式中的一个关键参数。\n$$C = \\frac{b}{a} = \\frac{0.03}{0.18} = \\frac{3}{18} = \\frac{1}{6}$$\n归一化公式可以写成：\n$$R_N = R_{\\text{obs}} \\left( \\frac{\\cos \\theta_s + C}{\\cos i + C} \\right)$$\n我们已知以下数值：\n-   $R_{\\text{obs}} = 0.20$\n-   $\\cos \\theta_s = 0.82$\n-   $\\cos i = 0.55$\n-   $a = 0.18$\n-   $b = 0.03$\n\n我们可以使用原始推导出的含 $a$ 和 $b$ 的公式：\n$$R_N = R_{\\text{obs}} \\left( \\frac{a \\cos \\theta_s + b}{a \\cos i + b} \\right)$$\n将数值代入表达式中：\n$$R_N = 0.20 \\left( \\frac{(0.18)(0.82) + 0.03}{(0.18)(0.55) + 0.03} \\right)$$\n计算校正因子中分子和分母的项：\n-   分子：$(0.18)(0.82) + 0.03 = 0.1476 + 0.03 = 0.1776$\n-   分母：$(0.18)(0.55) + 0.03 = 0.099 + 0.03 = 0.129$\n\n现在，计算归一化反射率：\n$$R_N = 0.20 \\left( \\frac{0.1776}{0.129} \\right)$$\n$$R_N = 0.20 \\times 1.376744186...$$\n$$R_N = 0.275348837...$$\n问题要求将最终答案四舍五入至四位有效数字。\n$$R_N \\approx 0.2753$$",
            "answer": "$$\\boxed{0.2753}$$"
        },
        {
            "introduction": "在光照不良的区域，地形校正模型可能变得数值不稳定，可能将噪声放大到不可接受的水平。最后一个练习通过分析误差在归一化过程中的传播来直面这一关键限制。通过推导方差膨胀因子，您将量化此风险并制定一个实用的阈值规则，以确保校正后数据的完整性。",
            "id": "3862405",
            "problem": "一个卫星成像系统获取了崎岖地形上经过大气校正的地表反射率。设一个均质像元的真实地表反射率用 $\\rho$ 表示，太阳入射角为 $i$（单位为弧度），余弦光照因子为 $c = \\cos i$。根据朗伯余弦定律，测量反射率可以建模为 $y = \\rho c + n$，其中 $n$ 是方差为 $\\sigma_{n}^{2}$ 的零均值传感器噪声。为了进行地形归一化，该系统将测量值除以一个根据数字高程模型（DEM）计算出的估计余弦因子 $\\hat{c}$。假设基于 DEM 的估计值为 $\\hat{c} = c + e$，其中 $e$ 是方差为 $\\sigma_{e}^{2}$ 的零均值估计误差，且与 $n$ 独立。\n\n将归一化反射率估计量定义为 $\\tilde{\\rho} = \\frac{y}{\\hat{c}}$。从上述定义出发，使用随机变量之比的一阶误差传播方法，推导出一个用 $c$、$\\rho$、$\\sigma_{n}^{2}$ 和 $\\sigma_{e}^{2}$ 表示的 $\\operatorname{Var}(\\tilde{\\rho})$ 的表达式。利用此表达式，将方差膨胀因子 $\\mathrm{VIF}(c)$ 定义为在通用 $c$ 值下的 $\\operatorname{Var}(\\tilde{\\rho})$ 与在 $c = 1$ 时的 $\\operatorname{Var}(\\tilde{\\rho})$ 之比，并解释用较小的 $c$ 值进行除法运算如何放大了噪声。\n\n然后，推导一个阈值规则，对 $c  c_{\\min}$ 的像元进行掩膜处理，以保证对于用户指定的 $\\alpha > 1$，有 $\\mathrm{VIF}(c) \\leq \\alpha$。最后，对于 $\\alpha = 3.2$，计算 $c_{\\min}$ 的数值。将最终数值答案四舍五入至四位有效数字。最终答案以纯数字形式表示，不带单位。",
            "solution": "问题陈述经评估有效。其科学依据扎根于遥感和误差分析原理，问题提法得当，信息充分，可得出唯一解，且表述客观，没有歧义。\n\n任务是分析地形归一化反射率估计量的方差，推导方差膨胀因子，并在此基础上建立一个阈值规则。\n\n首先，我们推导归一化反射率估计量 $\\tilde{\\rho} = \\frac{y}{\\hat{c}}$ 的方差表达式。该估计量是两个包含随机分量的量之比：测量反射率 $y = \\rho c + n$ 和估计的余弦因子 $\\hat{c} = c + e$。随机变量是传感器噪声 $n$ 和 DEM 误差 $e$，具有以下性质：\n$E[n] = 0$，$\\operatorname{Var}(n) = \\sigma_{n}^{2}$\n$E[e] = 0$，$\\operatorname{Var}(e) = \\sigma_{e}^{2}$\n$n$ 和 $e$ 是独立的，这意味着 $\\operatorname{Cov}(n, e) = 0$。\n\n我们使用一阶泰勒级数近似法来计算两个随机变量之比 $Z = X/Y$ 的方差。公式如下：\n$$ \\operatorname{Var}(Z) \\approx \\left(\\frac{\\mu_X}{\\mu_Y}\\right)^2 \\left( \\frac{\\operatorname{Var}(X)}{\\mu_X^2} + \\frac{\\operatorname{Var}(Y)}{\\mu_Y^2} - \\frac{2\\operatorname{Cov}(X, Y)}{\\mu_X \\mu_Y} \\right) $$\n在我们的例子中，$Z = \\tilde{\\rho}$，$X = y$，$Y = \\hat{c}$。我们计算必要的期望值、方差和协方差。\n\n$y$ 的期望值是：\n$$ \\mu_y = E[y] = E[\\rho c + n] = \\rho c + E[n] = \\rho c $$\n$\\hat{c}$ 的期望值是：\n$$ \\mu_{\\hat{c}} = E[\\hat{c}] = E[c + e] = c + E[e] = c $$\n$y$ 的方差是：\n$$ \\operatorname{Var}(y) = \\operatorname{Var}(\\rho c + n) = \\operatorname{Var}(n) = \\sigma_{n}^{2} $$\n$\\hat{c}$ 的方差是：\n$$ \\operatorname{Var}(\\hat{c}) = \\operatorname{Var}(c + e) = \\operatorname{Var}(e) = \\sigma_{e}^{2} $$\n$y$ 和 $\\hat{c}$ 的协方差是：\n$$ \\operatorname{Cov}(y, \\hat{c}) = \\operatorname{Cov}(\\rho c + n, c + e) = \\operatorname{Cov}(n, e) = 0 $$\n由于 $n$ 和 $e$ 的独立性声明。\n\n现在，我们将这些分量代入方差公式。注意，估计量的期望值是 $E[\\tilde{\\rho}] \\approx \\mu_y / \\mu_{\\hat{c}} = (\\rho c) / c = \\rho$。\n$$ \\operatorname{Var}(\\tilde{\\rho}) \\approx \\left(\\frac{\\rho c}{c}\\right)^2 \\left( \\frac{\\sigma_{n}^{2}}{(\\rho c)^2} + \\frac{\\sigma_{e}^{2}}{c^2} - 0 \\right) $$\n$$ \\operatorname{Var}(\\tilde{\\rho}) \\approx \\rho^2 \\left( \\frac{\\sigma_{n}^{2}}{\\rho^2 c^2} + \\frac{\\sigma_{e}^{2}}{c^2} \\right) $$\n$$ \\operatorname{Var}(\\tilde{\\rho}) \\approx \\rho^2 \\frac{\\sigma_{n}^{2}}{\\rho^2 c^2} + \\rho^2 \\frac{\\sigma_{e}^{2}}{c^2} $$\n$$ \\operatorname{Var}(\\tilde{\\rho}) \\approx \\frac{\\sigma_{n}^{2}}{c^2} + \\frac{\\rho^2 \\sigma_{e}^{2}}{c^2} $$\n将 $1/c^2$ 项提取出来，得到方差的最终表达式：\n$$ \\operatorname{Var}(\\tilde{\\rho}) \\approx \\frac{1}{c^2} \\left( \\sigma_{n}^{2} + \\rho^2 \\sigma_{e}^{2} \\right) $$\n\n接下来，我们将方差膨胀因子 $\\mathrm{VIF}(c)$ 定义为在通用光照因子 $c$ 下的 $\\operatorname{Var}(\\tilde{\\rho})$ 与其在 $c = 1$ 时的值之比。首先，我们计算 $c=1$ 时的方差：\n$$ \\operatorname{Var}(\\tilde{\\rho})|_{c=1} \\approx \\frac{1}{1^2} \\left( \\sigma_{n}^{2} + \\rho^2 \\sigma_{e}^{2} \\right) = \\sigma_{n}^{2} + \\rho^2 \\sigma_{e}^{2} $$\n这代表了在理想光照条件下（太阳在正头顶）的基线方差。那么方差膨胀因子为：\n$$ \\mathrm{VIF}(c) = \\frac{\\operatorname{Var}(\\tilde{\\rho})}{\\operatorname{Var}(\\tilde{\\rho})|_{c=1}} = \\frac{\\frac{1}{c^2} \\left( \\sigma_{n}^{2} + \\rho^2 \\sigma_{e}^{2} \\right)}{\\sigma_{n}^{2} + \\rho^2 \\sigma_{e}^{2}} $$\n$$ \\mathrm{VIF}(c) = \\frac{1}{c^2} $$\n解释：$\\mathrm{VIF}(c) = 1/c^2$ 这一项量化了反射率估计中方差随光照几何变化的放大程度。余弦因子 $c$ 的范围从 $0$（掠射光照，阴影）到 $1$（太阳直射）。当 $c$ 趋近于 $0$ 时，$\\mathrm{VIF}(c)$ 趋近于无穷大。这表明，将测量信号 $y$ 除以一个小的、不确定的估计值 $\\hat{c}$ 是一个数值不稳定的操作，会灾难性地放大传感器噪声和 DEM 误差对最终反射率估计的综合影响。光照不良（$c \\ll 1$）的像元将具有高度不确定的反射率估计值。\n\n第三，我们推导一个阈值规则，以屏蔽方差膨胀超过指定容差 $\\alpha > 1$ 的像元。条件是 $\\mathrm{VIF}(c) \\leq \\alpha$。\n$$ \\frac{1}{c^2} \\leq \\alpha $$\n由于 $c = \\cos i$，其中 $i$ 是太阳入射角，对于被照亮的表面，我们有 $0 \\le i \\le \\pi/2$，这意味着 $0 \\le c \\le 1$。我们关心的是 $c > 0$ 的情况。我们可以重新排列不等式：\n$$ 1 \\leq \\alpha c^2 $$\n$$ c^2 \\geq \\frac{1}{\\alpha} $$\n对两边取平方根（并知道 $c > 0$）：\n$$ c \\geq \\frac{1}{\\sqrt{\\alpha}} $$\n这个不等式定义了 $c$ 的可接受范围。阈值规则是屏蔽不满足此条件（即 $c  1/\\sqrt{\\alpha}$）的像元。因此，最小可接受的余弦因子是：\n$$ c_{\\min} = \\frac{1}{\\sqrt{\\alpha}} $$\n\n最后，我们为用户指定的容差 $\\alpha = 3.2$ 计算 $c_{\\min}$ 的数值。\n$$ c_{\\min} = \\frac{1}{\\sqrt{3.2}} $$\n计算数值：\n$$ c_{\\min} \\approx \\frac{1}{1.78885438} \\approx 0.55901699 $$\n按照要求将结果四舍五入到四位有效数字，得到 $0.5590$。这意味着，为确保校正后反射率的方差不超过其理想值的 $3.2$ 倍，所有光照因子小于 $0.5590$（对应于太阳入射角 $i > \\arccos(0.5590) \\approx 56.0^{\\circ}$）的像元都必须被屏蔽。",
            "answer": "$$\\boxed{0.5590}$$"
        }
    ]
}