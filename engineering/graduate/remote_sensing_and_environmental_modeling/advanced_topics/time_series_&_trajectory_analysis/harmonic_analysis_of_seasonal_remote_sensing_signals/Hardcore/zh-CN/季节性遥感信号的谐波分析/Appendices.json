{
    "hands_on_practices": [
        {
            "introduction": "卫星影像中的单个像元通常包含多种具有不同季节性模式（物候）的地物类型。本练习将演示如何为此类混合像元的组合信号建模。这是将信号叠加原理（相量加法）应用于一个常见遥感问题的动手实践，有助于学生建立对复杂季节性信号如何产生的直观理解。",
            "id": "3818982",
            "problem": "一颗卫星在一个日历年内观测到的季节性植被信号被建模为归一化植被指数 (NDVI) 的截断傅里叶表示，其中 $t$ 表示以天为单位的时间，$T = 365$ 是以天为单位的周期。考虑一个 $3 \\times 3$ 公里的像元，它是两种分别记为 $A$ 和 $B$ 的子像元生态气候系统的线性混合，其面积分数分别为 $w_{A} = 0.6$ 和 $w_{B} = 0.4$。假设子像元 NDVI 季节性异常是可加的，并且仅用其角频率为 $\\omega = \\frac{4\\pi}{T}$、相位以弧度为单位的半年度谐波即可很好地近似。子像元半年度分量为\n$$\ns_{A}(t) = A_{A}\\cos\\!\\left(\\omega t + \\phi_{A}\\right), \\quad s_{B}(t) = A_{B}\\cos\\!\\left(\\omega t + \\phi_{B}\\right),\n$$\n其中 $A_{A} = 0.18$，$\\phi_{A} = -\\frac{\\pi}{6}$，$A_{B} = 0.12$ 且 $\\phi_{B} = \\frac{\\pi}{3}$。像元级信号被建模为\n$$\nx(t) = w_{A}s_{A}(t) + w_{B}s_{B}(t).\n$$\n存在一个等效的单一半年度谐波 $x(t) = A_{\\text{mix}}\\cos\\!\\left(\\omega t + \\phi_{\\text{mix}}\\right)$，它能精确匹配 $x(t)$ 的半年度内容。\n\n利用傅里叶分析的基础和线性混合假设，确定组合的半年度振幅 $A_{\\text{mix}}$。将最终数值答案四舍五入至四位有效数字。将振幅表示为无量纲量。此外，根据你的推导，从影响植被生长的可能的双峰气候系统的角度，解释半年度分量的两个峰值的存在和时间，但不要在最终答案中包含任何解释性文本。",
            "solution": "用户希望我验证问题陈述，如果有效，则解决该问题。\n\n### 第 1 步：提取已知条件\n-   时间变量：$t$，以天为单位的时间。\n-   周期：$T = 365$ 天。\n-   像元构成：两个系统 $A$ 和 $B$ 的线性混合。\n-   系统 $A$ 的面积分数：$w_{A} = 0.6$。\n-   系统 $B$ 的面积分数：$w_{B} = 0.4$。\n-   系统 $A$ 的子像元半年度分量：$s_{A}(t) = A_{A}\\cos(\\omega t + \\phi_{A})$。\n-   系统 $B$ 的子像元半年度分量：$s_{B}(t) = A_{B}\\cos(\\omega t + \\phi_{B})$。\n-   角频率：$\\omega = \\frac{4\\pi}{T}$。\n-   系统 $A$ 的振幅：$A_{A} = 0.18$。\n-   系统 $A$ 的相位：$\\phi_{A} = -\\frac{\\pi}{6}$ 弧度。\n-   系统 $B$ 的振幅：$A_{B} = 0.12$。\n-   系统 $B$ 的相位：$\\phi_{B} = \\frac{\\pi}{3}$ 弧度。\n-   像元级信号模型：$x(t) = w_{A}s_{A}(t) + w_{B}s_{B}(t)$。\n-   等效单一谐波模型：$x(t) = A_{\\text{mix}}\\cos(\\omega t + \\phi_{\\text{mix}})$。\n-   目标：确定组合的半年度振幅 $A_{\\text{mix}}$。\n-   约束：将最终答案四舍五入至四位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学上合理：** 问题是科学上合理的。它采用了线性混合模型和傅里叶级数表示（具体来说是单一谐波），这些是遥感数据定量分析中的标准和基本技术，特别是在研究植被动态（例如 NDVI 时间序列）时。将像元建模为子像元分量的加权和是光谱混合分析的基石。给出的振幅和面积分数值是现实的。将半年度角频率定义为 $\\omega = \\frac{2\\pi}{(T/2)} = \\frac{4\\pi}{T}$ 是正确的。\n2.  **适定的：** 问题是适定的。任务是求两个同频率余弦函数线性组合的振幅。此操作是明确定义的，并产生一个该同频率的唯一结果余弦函数。所有必要的参数都已提供。\n3.  **客观的：** 问题以精确、客观的数学和科学术语陈述。对解释的要求是一个独立的认知任务，不影响计算的客观性。\n4.  **设置不完整或矛盾：** 问题是自洽且一致的。面积分数之和为一 ($w_A + w_B = 0.6 + 0.4 = 1.0$)。计算所需的所有变量都已定义。\n5.  **不切实际或不可行：** 该场景是现实的，模拟了一种常见情况，即单个遥感像元覆盖一个异质区域，该区域具有不同的生态或气候特征，导致不同的季节性响应。\n6.  **不适定或结构不良：** 问题结构清晰，并能导出一个唯一解。\n7.  **伪深刻、琐碎或同义反复：** 该问题需要对叠加原理（相量加法）进行标准但非琐碎的应用，测试了信号处理和物理学的基础知识。\n8.  **超出科学可验证性：** 结果是可以通过数学推导和验证的。\n9.  **不可形式化或不相关：** 该问题可直接用数学形式化，并且与遥感信号谐波分析领域高度相关。\n\n### 第 3 步：结论与行动\n问题是有效的。将提供完整的解答。\n\n像元级信号 $x(t)$ 是两个子像元信号的线性组合：\n$$\nx(t) = w_{A}s_{A}(t) + w_{B}s_{B}(t) = w_{A}A_{A}\\cos(\\omega t + \\phi_{A}) + w_{B}A_{B}\\cos(\\omega t + \\phi_{B})\n$$\n两个相同频率 $\\omega$ 的正弦波相加，会得到一个相同频率的新正弦波，可以表示为 $x(t) = A_{\\text{mix}}\\cos(\\omega t + \\phi_{\\text{mix}})$。合成信号的振幅 $A_{\\text{mix}}$ 和相位 $\\phi_{\\text{mix}}$ 可以使用相量加法原理来确定。\n\n形式为 $A\\cos(\\omega t + \\phi)$ 的正弦信号可以表示为复指数 $\\text{Re}\\{A e^{i(\\omega t + \\phi)}\\}$ 的实部。项 $A e^{i\\phi}$ 是复振幅，或称相量。该问题等效于将两个加权分量的相量相加。\n\n设两个加权分量信号由其相量 $C_{1}$ 和 $C_{2}$ 表示：\n$$\nC_{1} = (w_{A}A_{A})e^{i\\phi_{A}}\n$$\n$$\nC_{2} = (w_{B}A_{B})e^{i\\phi_{B}}\n$$\n混合信号的相量 $C_{\\text{mix}}$ 是这两个相量之和：\n$$\nC_{\\text{mix}} = C_{1} + C_{2} = A_{\\text{mix}}e^{i\\phi_{\\text{mix}}}\n$$\n所求振幅 $A_{\\text{mix}}$ 是复数 $C_{\\text{mix}}$ 的模，即 $A_{\\text{mix}} = |C_{\\text{mix}}|$。\n\n两个复数（或向量）之和的模可以使用余弦定理找到：\n$$\nA_{\\text{mix}}^2 = |C_{1}|^2 + |C_{2}|^2 + 2|C_{1}||C_{2}|\\cos(\\Delta\\phi)\n$$\n其中 $|C_{1}| = w_{A}A_{A}$，$|C_{2}| = w_{B}A_{B}$，而 $\\Delta\\phi = \\phi_{B} - \\phi_{A}$ 是两个相量之间的相位差。\n\n首先，我们计算分量相量的模：\n$$\n|C_{1}| = w_{A}A_{A} = 0.6 \\times 0.18 = 0.108\n$$\n$$\n|C_{2}| = w_{B}A_{B} = 0.4 \\times 0.12 = 0.048\n$$\n接下来，我们计算相位差 $\\Delta\\phi$：\n$$\n\\Delta\\phi = \\phi_{B} - \\phi_{A} = \\frac{\\pi}{3} - \\left(-\\frac{\\pi}{6}\\right) = \\frac{2\\pi}{6} + \\frac{\\pi}{6} = \\frac{3\\pi}{6} = \\frac{\\pi}{2}\n$$\n相位差为 $\\frac{\\pi}{2}$ 弧度，这意味着两个相量是正交的。该角度的余弦值为：\n$$\n\\cos(\\Delta\\phi) = \\cos\\left(\\frac{\\pi}{2}\\right) = 0\n$$\n将此代入余弦定理公式可大大简化表达式：\n$$\nA_{\\text{mix}}^2 = |C_{1}|^2 + |C_{2}|^2 + 2|C_{1}||C_{2}|(0)\n$$\n$$\nA_{\\text{mix}}^2 = (w_{A}A_{A})^2 + (w_{B}A_{B})^2\n$$\n这是勾股定理，正如预期的那样，因为是两个正交向量相加。现在，我们代入加权振幅的数值：\n$$\nA_{\\text{mix}}^2 = (0.108)^2 + (0.048)^2\n$$\n$$\nA_{\\text{mix}}^2 = 0.011664 + 0.002304\n$$\n$$\nA_{\\text{mix}}^2 = 0.013968\n$$\n为了求得 $A_{\\text{mix}}$，我们取该值的平方根：\n$$\nA_{\\text{mix}} = \\sqrt{0.013968} \\approx 0.1181863...\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nA_{\\text{mix}} \\approx 0.1182\n$$\n\n关于解释，具有不同相位和振幅的两个子像元分量的存在表明像元内存在双峰季节性响应。系统 A ($w_A=0.6, A_A=0.18, \\phi_A=-\\pi/6$) 是主导分量。其半年度峰值出现在 $t_A = \\frac{365}{4}(2k + 1/6)$，当 $k=0,1$ 时，大约是第 15 天和第 198 天。系统 B ($w_B=0.4, A_B=0.12, \\phi_B=\\pi/3$) 的贡献较小，其峰值出现在 $t_B = \\frac{365}{4}(2k - 1/3)$。当 $k=1,2$ 时，大约是第 152 天和第 335 天。这些峰值之间显著的时间偏移（A 和 B 的第一个峰值之间约 137 天）指向两个不同的潜在过程。这可能代表了具有不同物候的不同植被类型（例如，早春草地和晚熟作物）的混合，或者是一个受两种不同气候模式影响的区域（例如，早春增温和晚夏的季风都驱动植被生长）。$\\frac{\\pi}{2}$ 的相位差表明，一个系统的活动峰值出现在另一个系统接近其平均值时，导致组合信号的振幅介于完全相长干涉和完全相消干涉之间。",
            "answer": "$$\\boxed{0.1182}$$"
        },
        {
            "introduction": "在信号建模的基础上，本练习将探讨从真实世界数据中*估计*模型参数的关键步骤。遥感数据的噪声水平很少是恒定的；本练习介绍加权最小二乘法（WLS）作为处理此类异方差性的正确方法。你将推导估计系数的协方差矩阵，这是量化估计量不确定性的一项基本技能。",
            "id": "3818979",
            "problem": "一颗卫星在单个水文年内测量植被指数，其名义周期为 $T$ 天，在不一定是均匀间隔的观测时间 $t_i$ 生成时间序列 $\\{y(t_i)\\}_{i=1}^{N}$。经过基于物理的预处理，移除了长期均值和除了选定波数 $k$ 之外的所有谐波后，残差信号被建模为\n$$\ny(t_i) \\;=\\; a_k \\,\\cos\\!\\big(\\omega_k\\, t_i\\big) \\;+\\; b_k \\,\\sin\\!\\big(\\omega_k\\, t_i\\big) \\;+\\; \\varepsilon_i,\n$$\n其中 $\\omega_k = 2\\pi k / T$ 是以弧度/天为单位的角频率，$a_k$ 和 $b_k$ 是保留波数 $k$ 的未知谐波系数，残差 $\\varepsilon_i$ 满足 $\\mathbb{E}[\\varepsilon_i]=0$，相互不相关，并具有一个由传感器几何形状和大气条件决定的已知异方差函数 $\\operatorname{Var}(\\varepsilon_i) = \\sigma^2(t_i)$。所有三角函数的参数均以弧度为单位。\n\n在环境建模实践中，当方差函数 $\\sigma^2(t)$ 已知时，通过使用权重 $w(t_i) = 1/\\sigma^2(t_i)$ 的加权最小二乘法 (WLS) 可以获得最佳线性无偏估计量。设保留波数的设计矩阵为 $N \\times 2$ 的\n$$\n\\mathbf{X}_k \\;=\\;\n\\begin{pmatrix}\n\\cos(\\omega_k t_1)  \\sin(\\omega_k t_1) \\\\\n\\vdots  \\vdots \\\\\n\\cos(\\omega_k t_N)  \\sin(\\omega_k t_N)\n\\end{pmatrix},\n$$\n并设对角权重矩阵为 $\\mathbf{W} = \\operatorname{diag}\\big(w(t_1),\\ldots,w(t_N)\\big)$，其中 $w(t_i) = 1/\\sigma^2(t_i)$。\n\n从基本线性模型假设和已知异方差性下的 WLS 性质出发，推导保留波数 $k$ 的参数矢量 $\\boldsymbol{\\theta}_k = (a_k, b_k)^{\\top}$ 的 WLS 估计量的期望协方差矩阵，并使用离散加权和\n$$\nS_{cc} \\;=\\; \\sum_{i=1}^{N} w(t_i)\\,\\cos^2(\\omega_k t_i), \\quad\nS_{ss} \\;=\\; \\sum_{i=1}^{N} w(t_i)\\,\\sin^2(\\omega_k t_i), \\quad\nS_{cs} \\;=\\; \\sum_{i=1}^{N} w(t_i)\\,\\cos(\\omega_k t_i)\\,\\sin(\\omega_k t_i).\n$$\n以封闭形式表示最终答案。\n\n你的最终答案必须是关于 $(a_k,b_k)$ 的 $2 \\times 2$ 协方差矩阵的单一封闭形式解析表达式，用 $S_{cc}$、$S_{ss}$ 和 $S_{cs}$ 表示。无需进行数值计算，也无需四舍五入。只需陈述最终表达式；最终表达式内不应包含单位。在整个过程中，角度应视为以弧度为单位。",
            "solution": "问题要求推导谐波系数 $\\boldsymbol{\\theta}_k = (a_k, b_k)^{\\top}$ 的加权最小二乘 (WLS) 估计量的期望协方差矩阵。推导将从将问题表述为一般线性模型的基本形式开始。\n\n给定的单个观测 $t_i$ 的模型是\n$$\ny(t_i) \\;=\\; a_k \\,\\cos(\\omega_k\\, t_i) \\;+\\; b_k \\,\\sin(\\omega_k\\, t_i) \\;+\\; \\varepsilon_i\n$$\n对于所有 $N$ 个观测，这可以表示为线性模型 $\\mathbf{y} = \\mathbf{X}_k\\boldsymbol{\\theta}_k + \\boldsymbol{\\varepsilon}$ 的矩阵形式，其中：\n- $\\mathbf{y} = (y(t_1), \\dots, y(t_N))^{\\top}$ 是观测值的 $N \\times 1$ 向量。\n- $\\mathbf{X}_k$ 是 $N \\times 2$ 的设计矩阵，如问题陈述中所给。\n- $\\boldsymbol{\\theta}_k = (a_k, b_k)^{\\top}$ 是待估计参数的 $2 \\times 1$ 向量。\n- $\\boldsymbol{\\varepsilon} = (\\varepsilon_1, \\dots, \\varepsilon_N)^{\\top}$ 是随机误差的 $N \\times 1$ 向量。\n\n问题陈述了误差项的统计特性：\n1.  每个误差的期望值为零，$\\mathbb{E}[\\varepsilon_i] = 0$。这意味着误差向量的期望值为零向量，$\\mathbb{E}[\\boldsymbol{\\varepsilon}] = \\mathbf{0}$。\n2.  误差是相互不相关的，即对于 $i \\neq j$，$\\operatorname{Cov}(\\varepsilon_i, \\varepsilon_j) = 0$。\n3.  每个误差的方差是已知的且是异方差的，$\\operatorname{Var}(\\varepsilon_i) = \\sigma^2(t_i)$。\n\n根据这些特性，我们可以构建误差向量 $\\boldsymbol{\\varepsilon}$ 的协方差矩阵：\n$$\n\\operatorname{Cov}(\\boldsymbol{\\varepsilon}) = \\mathbb{E}[\\boldsymbol{\\varepsilon}\\boldsymbol{\\varepsilon}^{\\top}] = \\operatorname{diag}(\\operatorname{Var}(\\varepsilon_1), \\dots, \\operatorname{Var}(\\varepsilon_N)) = \\operatorname{diag}(\\sigma^2(t_1), \\dots, \\sigma^2(t_N))\n$$\n问题将 WLS 的权重定义为 $w(t_i) = 1/\\sigma^2(t_i)$，权重矩阵为 $\\mathbf{W} = \\operatorname{diag}(w(t_1), \\dots, w(t_N))$。由此直接得出，误差的协方差矩阵是权重矩阵的逆：\n$$\n\\operatorname{Cov}(\\boldsymbol{\\varepsilon}) = \\mathbf{W}^{-1}\n$$\n$\\boldsymbol{\\theta}_k$ 的 WLS 估计量 $\\hat{\\boldsymbol{\\theta}}_k$ 是使由表达式 $(\\mathbf{y} - \\mathbf{X}_k\\boldsymbol{\\theta}_k)^{\\top}\\mathbf{W}(\\mathbf{y} - \\mathbf{X}_k\\boldsymbol{\\theta}_k)$ 给出的加权残差平方和最小化的估计量。这个最小化问题的解是著名的 WLS 估计量：\n$$\n\\hat{\\boldsymbol{\\theta}}_k = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{y}\n$$\n为了求这个估计量的协方差矩阵，我们首先确定它的期望值。由于 $\\mathbb{E}[\\mathbf{y}] = \\mathbb{E}[\\mathbf{X}_k\\boldsymbol{\\theta}_k + \\boldsymbol{\\varepsilon}] = \\mathbf{X}_k\\boldsymbol{\\theta}_k + \\mathbb{E}[\\boldsymbol{\\varepsilon}] = \\mathbf{X}_k\\boldsymbol{\\theta}_k$，我们有：\n$$\n\\mathbb{E}[\\hat{\\boldsymbol{\\theta}}_k] = \\mathbb{E}[(\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{y}] = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbb{E}[\\mathbf{y}] = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k) \\boldsymbol{\\theta}_k = \\boldsymbol{\\theta}_k\n$$\n这证实了 WLS 估计量是无偏的。$\\hat{\\boldsymbol{\\theta}}_k$ 的协方差矩阵定义为 $\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_k) = \\mathbb{E}[(\\hat{\\boldsymbol{\\theta}}_k - \\mathbb{E}[\\hat{\\boldsymbol{\\theta}}_k])(\\hat{\\boldsymbol{\\theta}}_k - \\mathbb{E}[\\hat{\\boldsymbol{\\theta}}_k])^{\\top}]$。利用其无偏性，该表达式变为：\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_k) = \\mathbb{E}[(\\hat{\\boldsymbol{\\theta}}_k - \\boldsymbol{\\theta}_k)(\\hat{\\boldsymbol{\\theta}}_k - \\boldsymbol{\\theta}_k)^{\\top}]\n$$\n我们可以用误差向量 $\\boldsymbol{\\varepsilon}$ 来表示项 $(\\hat{\\boldsymbol{\\theta}}_k - \\boldsymbol{\\theta}_k)$：\n$$\n\\hat{\\boldsymbol{\\theta}}_k - \\boldsymbol{\\theta}_k = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{y} - \\boldsymbol{\\theta}_k = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W}(\\mathbf{X}_k\\boldsymbol{\\theta}_k + \\boldsymbol{\\varepsilon}) - \\boldsymbol{\\theta}_k = \\boldsymbol{\\theta}_k + (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W}\\boldsymbol{\\varepsilon} - \\boldsymbol{\\theta}_k = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W}\\boldsymbol{\\varepsilon}\n$$\n现在我们将此代入协方差矩阵的表达式中。设 $\\mathbf{M} = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W}$。那么 $\\hat{\\boldsymbol{\\theta}}_k - \\boldsymbol{\\theta}_k = \\mathbf{M}\\boldsymbol{\\varepsilon}$。\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_k) = \\mathbb{E}[(\\mathbf{M}\\boldsymbol{\\varepsilon})(\\mathbf{M}\\boldsymbol{\\varepsilon})^{\\top}] = \\mathbb{E}[\\mathbf{M}\\boldsymbol{\\varepsilon}\\boldsymbol{\\varepsilon}^{\\top}\\mathbf{M}^{\\top}] = \\mathbf{M} \\mathbb{E}[\\boldsymbol{\\varepsilon}\\boldsymbol{\\varepsilon}^{\\top}] \\mathbf{M}^{\\top} = \\mathbf{M} \\operatorname{Cov}(\\boldsymbol{\\varepsilon}) \\mathbf{M}^{\\top}\n$$\n将 $\\mathbf{M}$ 和 $\\operatorname{Cov}(\\boldsymbol{\\varepsilon}) = \\mathbf{W}^{-1}$ 的表达式代回：\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_k) = \\left( (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W} \\right) (\\mathbf{W}^{-1}) \\left( (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W} \\right)^{\\top}\n$$\n转置项是 $(\\mathbf{W}^{\\top}\\mathbf{X}_k^{\\top\\top})((\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1})^{\\top} = \\mathbf{W}\\mathbf{X}_k(\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1}$，因为 $\\mathbf{W}$ 是对角矩阵且 $\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k$ 是对称的。\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_k) = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} (\\mathbf{X}_k^{\\top}\\mathbf{W}) (\\mathbf{W}^{-1}) (\\mathbf{W}\\mathbf{X}_k) (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1}\n$$\n利用矩阵乘法的结合律，中间部分简化为：$(\\mathbf{X}_k^{\\top}\\mathbf{W}) (\\mathbf{W}^{-1}) (\\mathbf{W}\\mathbf{X}_k) = \\mathbf{X}_k^{\\top}(\\mathbf{W}\\mathbf{W}^{-1})\\mathbf{W}\\mathbf{X}_k = \\mathbf{X}_k^{\\top}\\mathbf{I}\\mathbf{W}\\mathbf{X}_k = \\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k$。\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_k) = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k) (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} = \\mathbf{I} (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1}\n$$\n任务简化为计算矩阵 $\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k$，然后求其逆矩阵。\n设 $c_i = \\cos(\\omega_k t_i)$ 且 $s_i = \\sin(\\omega_k t_i)$。\n$$\n\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k = \\begin{pmatrix} c_1  \\cdots  c_N \\\\ s_1  \\cdots  s_N \\end{pmatrix} \\begin{pmatrix} w(t_1)   0 \\\\  \\ddots  \\\\ 0   w(t_N) \\end{pmatrix} \\begin{pmatrix} c_1  s_1 \\\\ \\vdots  \\vdots \\\\ c_N  s_N \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} c_1  \\cdots  c_N \\\\ s_1  \\cdots  s_N \\end{pmatrix} \\begin{pmatrix} w(t_1)c_1  w(t_1)s_1 \\\\ \\vdots  \\vdots \\\\ w(t_N)c_N  w(t_N)s_N \\end{pmatrix}\n= \\begin{pmatrix} \\sum_{i=1}^{N} w(t_i)c_i^2  \\sum_{i=1}^{N} w(t_i)c_i s_i \\\\ \\sum_{i=1}^{N} w(t_i)s_i c_i  \\sum_{i=1}^{N} w(t_i)s_i^2 \\end{pmatrix}\n$$\n使用问题陈述中提供的定义：\n- $S_{cc} = \\sum_{i=1}^{N} w(t_i)\\cos^2(\\omega_k t_i)$\n- $S_{ss} = \\sum_{i=1}^{N} w(t_i)\\sin^2(\\omega_k t_i)$\n- $S_{cs} = \\sum_{i=1}^{N} w(t_i)\\cos(\\omega_k t_i)\\sin(\\omega_k t_i)$\n矩阵变为：\n$$\n\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k = \\begin{pmatrix} S_{cc}  S_{cs} \\\\ S_{cs}  S_{ss} \\end{pmatrix}\n$$\n最后，我们计算这个 $2 \\times 2$ 矩阵的逆。行列式为 $\\det(\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k) = S_{cc}S_{ss} - S_{cs}^2$。逆矩阵是：\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_k) = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} = \\frac{1}{S_{cc}S_{ss} - S_{cs}^2} \\begin{pmatrix} S_{ss}  -S_{cs} \\\\ -S_{cs}  S_{cc} \\end{pmatrix}\n$$\n这是 $(a_k, b_k)^{\\top}$ 的 WLS 估计量的协方差矩阵的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{S_{cc}S_{ss} - S_{cs}^2} \\begin{pmatrix} S_{ss}  -S_{cs} \\\\ -S_{cs}  S_{cc} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "谐波分析的最终目的通常是提取有意义的环境指标，例如植被绿度峰值的时间。这最后一个练习将所有环节联系起来：它展示了如何将估计的谐波系数的不确定性（正如前一个练习所推导的）传播到派生物理量的不确定性上。这对于创建具有已知置信水平的科学严谨的数据产品至关重要。",
            "id": "3818966",
            "problem": "由卫星传感器观测到的单个像素的季节性植被信号在时间 $t$ 被建模为余弦和正弦的一次谐波线性组合：\n$$\ny(t) \\;=\\; \\mu \\;+\\; c \\cos\\!\\big(\\omega t\\big) \\;+\\; s \\sin\\!\\big(\\omega t\\big) \\;+\\; \\varepsilon(t),\n$$\n其中 $\\omega \\;=\\; \\frac{2\\pi}{T}$ 是周期 $T$ 的已知年角频率，$\\mu$ 是一个常数偏移量，$\\varepsilon(t)$ 是零均值噪声。余弦和正弦系数 $(c,s)$ 通过普通最小二乘法 (OLS) 获得，它们的联合不确定性由协方差矩阵概括：\n$$\n\\Sigma \\;=\\; \\begin{pmatrix}\n\\operatorname{Var}(c)  \\operatorname{Cov}(c,s) \\\\\n\\operatorname{Cov}(c,s)  \\operatorname{Var}(s)\n\\end{pmatrix}.\n$$\n振幅-相位重参数化定义为\n$$\nc \\;=\\; A \\cos(\\phi), \\qquad s \\;=\\; A \\sin(\\phi),\n$$\n因此\n$$\ny(t) \\;=\\; \\mu \\;+\\; A \\cos\\!\\big(\\omega t - \\phi\\big),\n$$\n其中相位 $\\phi \\in [0,2\\pi)$ 以弧度为单位。年内峰值时间定义为满足 $\\omega t - \\phi \\equiv 0 \\;(\\mathrm{mod}\\; 2\\pi)$ 的最早时间 $t$，在主分支上为\n$$\nt_{\\mathrm{peak}} \\;=\\; \\frac{\\phi}{2\\pi}\\,T.\n$$\n\n对于特定像素和年份，您将获得以下统计上一致的 OLS 输出：\n- 估计的余弦系数 $\\hat{c} \\;=\\; 0.12$，\n- 估计的正弦系数 $\\hat{s} \\;=\\; 0.16$，\n- 协方差矩阵项 $\\operatorname{Var}(c) \\;=\\; 2.0 \\times 10^{-5}$，$\\operatorname{Var}(s) \\;=\\; 3.0 \\times 10^{-5}$，以及 $\\operatorname{Cov}(c,s) \\;=\\; 0.5 \\times 10^{-5}$，\n- 年周期 $T \\;=\\; 365$ 天，\n- 所有角度均以弧度为单位。\n\n仅从上述定义、光滑映射的可微性以及随机向量的可微变换的一阶（线性）不确定性传播出发，从 $(c,s)$ 的联合不确定性中推导 $\\phi$ 的一阶方差，然后通过 $t_{\\mathrm{peak}} \\;=\\; \\frac{\\phi}{2\\pi} T$ 传播该方差，以获得以天为单位的单标准差不确定性 $\\sigma_{t_{\\mathrm{peak}}}$。 \n\n将您对 $\\sigma_{t_{\\mathrm{peak}}}$ 的最终数值答案四舍五入至四位有效数字。以天为单位表示最终的时间不确定性。仅提供单个数值作为您的最终答案。角度单位是弧度。",
            "solution": "目标是求出植被信号峰值时间 $t_{\\mathrm{peak}}$ 的单标准差不确定性 $\\sigma_{t_{\\mathrm{peak}}}$。该问题要求基于一阶不确定性传播（也称为 Delta 方法）进行推导。这包括两个主要步骤：首先，将不确定性从余弦和正弦系数 $(c, s)$ 传播到相位角 $\\phi$；其次，将不确定性从 $\\phi$ 传播到 $t_{\\mathrm{peak}}$。\n\n相位角 $\\phi$ 是系数 $(c,s)$ 的函数，通过变换 $c = A \\cos(\\phi)$ 和 $s = A \\sin(\\phi)$ 联系。这意味着 $\\tan(\\phi) = s/c$。对于给定的估计系数 $\\hat{c} = 0.12 > 0$ 和 $\\hat{s} = 0.16 > 0$，相位角位于第一象限，函数可以写成 $\\phi(c, s) = \\arctan(s/c)$。\n\n随机向量 $X$ 的函数 $g(X)$ 的方差的一阶近似由下式给出：\n$$\n\\operatorname{Var}(g(X)) \\approx (\\nabla g)^T \\Sigma_X (\\nabla g)\n$$\n其中 $\\nabla g$ 是在 $X$ 的均值处求值的函数 $g$ 的梯度，$\\Sigma_X$ 是 $X$ 的协方差矩阵。在我们的例子中，$g(c,s) = \\phi(c,s)$，随机向量是 $X = (c,s)^T$，其协方差矩阵是 $\\Sigma$。\n\n首先，我们计算 $\\phi(c,s) = \\arctan(s/c)$ 的梯度。偏导数是：\n$$\n\\frac{\\partial\\phi}{\\partial c} = \\frac{\\partial}{\\partial c} \\arctan\\left(\\frac{s}{c}\\right) = \\frac{1}{1 + (s/c)^2} \\cdot \\left(-\\frac{s}{c^2}\\right) = \\frac{c^2}{c^2+s^2} \\cdot \\left(-\\frac{s}{c^2}\\right) = -\\frac{s}{c^2+s^2}\n$$\n$$\n\\frac{\\partial\\phi}{\\partial s} = \\frac{\\partial}{\\partial s} \\arctan\\left(\\frac{s}{c}\\right) = \\frac{1}{1 + (s/c)^2} \\cdot \\left(\\frac{1}{c}\\right) = \\frac{c^2}{c^2+s^2} \\cdot \\left(\\frac{1}{c}\\right) = \\frac{c}{c^2+s^2}\n$$\n因此，梯度向量 $\\nabla \\phi$ 是：\n$$\n\\nabla \\phi = \\begin{pmatrix} \\frac{\\partial\\phi}{\\partial c} \\\\ \\frac{\\partial\\phi}{\\partial s} \\end{pmatrix} = \\frac{1}{c^2+s^2} \\begin{pmatrix} -s \\\\ c \\end{pmatrix}\n$$\n现在，我们应用不确定性传播公式来求 $\\phi$ 的方差 $\\operatorname{Var}(\\phi)$：\n$$\n\\operatorname{Var}(\\phi) \\approx \\left( \\frac{1}{c^2+s^2} \\begin{pmatrix} -s \\\\ c \\end{pmatrix} \\right)^T \\begin{pmatrix} \\operatorname{Var}(c)  \\operatorname{Cov}(c,s) \\\\ \\operatorname{Cov}(c,s)  \\operatorname{Var}(s) \\end{pmatrix} \\left( \\frac{1}{c^2+s^2} \\begin{pmatrix} -s \\\\ c \\end{pmatrix} \\right)\n$$\n$$\n\\operatorname{Var}(\\phi) \\approx \\frac{1}{(c^2+s^2)^2} \\begin{pmatrix} -s  c \\end{pmatrix} \\begin{pmatrix} \\operatorname{Var}(c)  \\operatorname{Cov}(c,s) \\\\ \\operatorname{Cov}(c,s)  \\operatorname{Var}(s) \\end{pmatrix} \\begin{pmatrix} -s \\\\ c \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n\\begin{pmatrix} -s  c \\end{pmatrix} \\begin{pmatrix} \\operatorname{Var}(c)  \\operatorname{Cov}(c,s) \\\\ \\operatorname{Cov}(c,s)  \\operatorname{Var}(s) \\end{pmatrix} = \\begin{pmatrix} -s\\operatorname{Var}(c) + c\\operatorname{Cov}(c,s)  -s\\operatorname{Cov}(c,s) + c\\operatorname{Var}(s) \\end{pmatrix}\n$$\n$$\n\\left( \\begin{pmatrix} -s\\operatorname{Var}(c) + c\\operatorname{Cov}(c,s)  -s\\operatorname{Cov}(c,s) + c\\operatorname{Var}(s) \\end{pmatrix} \\right) \\begin{pmatrix} -s \\\\ c \\end{pmatrix} = s^2\\operatorname{Var}(c) - sc\\operatorname{Cov}(c,s) - sc\\operatorname{Cov}(c,s) + c^2\\operatorname{Var}(s)\n$$\n这可以简化为：\n$$\ns^2\\operatorname{Var}(c) + c^2\\operatorname{Var}(s) - 2sc\\operatorname{Cov}(c,s)\n$$\n因此，推导出的相位方差表达式为：\n$$\n\\operatorname{Var}(\\phi) \\approx \\frac{s^2\\operatorname{Var}(c) + c^2\\operatorname{Var}(s) - 2sc\\operatorname{Cov}(c,s)}{(c^2+s^2)^2}\n$$\n现在我们将给定的数值代入此表达式，并在估计值 $(\\hat{c}, \\hat{s})$ 处进行计算：\n$\\hat{c} = 0.12$，$\\hat{s} = 0.16$，$\\operatorname{Var}(c) = 2.0 \\times 10^{-5}$，$\\operatorname{Var}(s) = 3.0 \\times 10^{-5}$，以及 $\\operatorname{Cov}(c,s) = 0.5 \\times 10^{-5}$。\n\n我们计算各个分量：\n$\\hat{c}^2 = (0.12)^2 = 0.0144$\n$\\hat{s}^2 = (0.16)^2 = 0.0256$\n$\\hat{c}^2 + \\hat{s}^2 = 0.0144 + 0.0256 = 0.04$\n$2\\hat{s}\\hat{c} = 2(0.16)(0.12) = 0.0384$\n\n分子是：\n$N = (0.0256)(2.0 \\times 10^{-5}) + (0.0144)(3.0 \\times 10^{-5}) - (0.0384)(0.5 \\times 10^{-5})$\n$N = (0.0512 \\times 10^{-5}) + (0.0432 \\times 10^{-5}) - (0.0192 \\times 10^{-5})$\n$N = (0.0512 + 0.0432 - 0.0192) \\times 10^{-5} = 0.0752 \\times 10^{-5} = 7.52 \\times 10^{-7}$\n\n分母是：\n$D = (\\hat{c}^2 + \\hat{s}^2)^2 = (0.04)^2 = 0.0016 = 1.6 \\times 10^{-3}$\n\n所以，$\\phi$ 的方差是：\n$$\n\\operatorname{Var}(\\phi) \\approx \\frac{7.52 \\times 10^{-7}}{1.6 \\times 10^{-3}} = 4.7 \\times 10^{-4} \\;\\text{rad}^2\n$$\n第二步是将此方差传播到 $t_{\\mathrm{peak}}$。关系式如下：\n$$\nt_{\\mathrm{peak}} = \\frac{\\phi}{2\\pi} T\n$$\n这是对随机变量 $\\phi$ 按常数因子 $k = \\frac{T}{2\\pi}$进行的线性缩放。对于变换 $Y = kX$，方差传播为 $\\operatorname{Var}(Y) = k^2 \\operatorname{Var}(X)$。因此：\n$$\n\\operatorname{Var}(t_{\\mathrm{peak}}) = \\left(\\frac{T}{2\\pi}\\right)^2 \\operatorname{Var}(\\phi)\n$$\n单标准差不确定性 $\\sigma_{t_{\\mathrm{peak}}}$ 是方差的平方根：\n$$\n\\sigma_{t_{\\mathrm{peak}}} = \\sqrt{\\operatorname{Var}(t_{\\mathrm{peak}})} = \\sqrt{\\left(\\frac{T}{2\\pi}\\right)^2 \\operatorname{Var}(\\phi)} = \\frac{T}{2\\pi} \\sqrt{\\operatorname{Var}(\\phi)}\n$$\n代入年周期 $T = 365$ 天和计算出的 $\\operatorname{Var}(\\phi)$ 的值：\n$$\n\\sigma_{t_{\\mathrm{peak}}} = \\frac{365}{2\\pi} \\sqrt{4.7 \\times 10^{-4}}\n$$\n我们计算数值：\n$$\n\\sqrt{4.7 \\times 10^{-4}} \\approx 0.021679483\n$$\n$$\n\\sigma_{t_{\\mathrm{peak}}} \\approx \\frac{365}{2\\pi} \\times 0.021679483 \\approx 58.09155 \\times 0.021679483 \\approx 1.2593683 \\;\\text{天}\n$$\n按照要求将最终结果四舍五入到四位有效数字，我们得到 $1.259$。",
            "answer": "$$\n\\boxed{1.259}\n$$"
        }
    ]
}