{
    "hands_on_practices": [
        {
            "introduction": "遥感影像中的单个像元常常覆盖着包含不同地表覆盖类型的异质区域，每种类型都有其独特的季节性周期。本练习将引导您运用线性叠加原理，将在遥感中至关重要的相量加法概念应用于一个实际场景。通过此练习，您将学会如何从数学上合并两个独立的谐波分量，从而理解次像元（sub-pixel）的异质性如何影响我们观测到的整体季节性信号的振幅与相位。",
            "id": "3818982",
            "problem": "一颗卫星在一个日历年内观测到的季节性植被信号被建模为归一化植被指数 (NDVI) 的截断傅里叶表示，其中 $t$ 表示以天为单位的时间，$T = 365$ 是以天为单位的周期。考虑一个 $3 \\times 3$ 公里的像素，该像素是两种亚像素生态气候系统（表示为 $A$ 和 $B$）的线性混合，其面积分数分别为 $w_{A} = 0.6$ 和 $w_{B} = 0.4$。假设亚像素 NDVI 季节性异常是可加的，并且仅由其半年度谐波很好地近似，角频率为 $\\omega = \\frac{4\\pi}{T}$，相位以弧度为单位。亚像素半年度分量为\n$$\ns_{A}(t) = A_{A}\\cos\\!\\left(\\omega t + \\phi_{A}\\right), \\quad s_{B}(t) = A_{B}\\cos\\!\\left(\\omega t + \\phi_{B}\\right),\n$$\n其中 $A_{A} = 0.18$，$\\phi_{A} = -\\frac{\\pi}{6}$，$A_{B} = 0.12$，且 $\\phi_{B} = \\frac{\\pi}{3}$。像素级信号被建模为\n$$\nx(t) = w_{A}s_{A}(t) + w_{B}s_{B}(t).\n$$\n存在一个等效的单一半年度谐波 $x(t) = A_{\\text{mix}}\\cos\\!\\left(\\omega t + \\phi_{\\text{mix}}\\right)$，它能精确匹配 $x(t)$ 的半年度内容。\n\n利用傅里叶分析的基础和线性混合假设，确定组合的半年度振幅 $A_{\\text{mix}}$。将您的最终数值答案四舍五入到四位有效数字。将振幅表示为无量纲量。此外，根据您的推导，用合理的双峰气候系统（影响植被生长）来解释半年度分量的两个峰值的存在和时间，但不要在最终答案中包含任何解释性文本。",
            "solution": "像素级信号 $x(t)$ 是两个亚像素信号的线性组合：\n$$\nx(t) = w_{A}s_{A}(t) + w_{B}s_{B}(t) = w_{A}A_{A}\\cos(\\omega t + \\phi_{A}) + w_{B}A_{B}\\cos(\\omega t + \\phi_{B})\n$$\n两个相同频率 $\\omega$ 的正弦波相加，结果是一个新的同频率正弦波，可以表示为 $x(t) = A_{\\text{mix}}\\cos(\\omega t + \\phi_{\\text{mix}})$。合成信号的振幅 $A_{\\text{mix}}$ 和相位 $\\phi_{\\text{mix}}$ 可以使用相量加法原理确定。\n\n形式为 $A\\cos(\\omega t + \\phi)$ 的正弦信号可以表示为复指数 $\\text{Re}\\{A e^{i(\\omega t + \\phi)}\\}$ 的实部。项 $A e^{i\\phi}$ 是复振幅，或称相量。该问题等效于将两个加权分量的相量相加。\n\n设两个加权分量信号由其相量 $C_{1}$ 和 $C_{2}$ 表示：\n$$\nC_{1} = (w_{A}A_{A})e^{i\\phi_{A}}\n$$\n$$\nC_{2} = (w_{B}A_{B})e^{i\\phi_{B}}\n$$\n混合信号的相量 $C_{\\text{mix}}$ 是这两个相量的和：\n$$\nC_{\\text{mix}} = C_{1} + C_{2} = A_{\\text{mix}}e^{i\\phi_{\\text{mix}}}\n$$\n所求振幅 $A_{\\text{mix}}$ 是复数 $C_{\\text{mix}}$ 的模，即 $A_{\\text{mix}} = |C_{\\text{mix}}|$。\n\n两个复数（或向量）之和的模可以使用余弦定理求得：\n$$\nA_{\\text{mix}}^2 = |C_{1}|^2 + |C_{2}|^2 + 2|C_{1}||C_{2}|\\cos(\\Delta\\phi)\n$$\n其中 $|C_{1}| = w_{A}A_{A}$，$|C_{2}| = w_{B}A_{B}$，且 $\\Delta\\phi = \\phi_{B} - \\phi_{A}$ 是两个相量之间的相位差。\n\n首先，我们计算分量相量的模：\n$$\n|C_{1}| = w_{A}A_{A} = 0.6 \\times 0.18 = 0.108\n$$\n$$\n|C_{2}| = w_{B}A_{B} = 0.4 \\times 0.12 = 0.048\n$$\n接下来，我们计算相位差 $\\Delta\\phi$：\n$$\n\\Delta\\phi = \\phi_{B} - \\phi_{A} = \\frac{\\pi}{3} - \\left(-\\frac{\\pi}{6}\\right) = \\frac{2\\pi}{6} + \\frac{\\pi}{6} = \\frac{3\\pi}{6} = \\frac{\\pi}{2}\n$$\n相位差为 $\\frac{\\pi}{2}$ 弧度，这意味着两个相量是正交的。该角度的余弦值为：\n$$\n\\cos(\\Delta\\phi) = \\cos\\left(\\frac{\\pi}{2}\\right) = 0\n$$\n将此代入余弦定理公式，可大大简化表达式，变为勾股定理：\n$$\nA_{\\text{mix}}^2 = |C_{1}|^2 + |C_{2}|^2\n$$\n现在，我们代入加权振幅的数值：\n$$\nA_{\\text{mix}}^2 = (0.108)^2 + (0.048)^2\n$$\n$$\nA_{\\text{mix}}^2 = 0.011664 + 0.002304\n$$\n$$\nA_{\\text{mix}}^2 = 0.013968\n$$\n为了求得 $A_{\\text{mix}}$，我们取该值的平方根：\n$$\nA_{\\text{mix}} = \\sqrt{0.013968} \\approx 0.1181863...\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\nA_{\\text{mix}} \\approx 0.1182\n$$\n\n就解释而言，具有不同相位和振幅的两个亚像素分量的存在，表明像素内存在双峰季节性响应。系统 A 是主导分量，而系统 B 的贡献较小且在时间上存在显著偏移。这可能代表了具有不同物候期的不同植被类型的混合（例如，早春的草和晚熟的作物），或者是一个受两种不同气候模式影响的区域（例如，早春变暖和夏季晚些时候的季风都驱动植被生长）。$\\frac{\\pi}{2}$ 的相位差表明，一个系统的活动峰值出现在另一个系统接近其均值时，导致组合信号的振幅介于完全相长干涉和完全相消干涉之间，而不是简单的代数和。",
            "answer": "$$\\boxed{0.1182}$$"
        },
        {
            "introduction": "从遥感时间序列中拟合谐波模型后，我们常常需要提取如植被生长高峰期等具有物理意义的物候参数。此练习的核心是解决一个关键的统计问题：如何量化这些派生参数的不确定性。您将应用一阶泰勒级数展开（即“德尔塔方法”）来推导误差传播，将最小二乘法拟合得到的正弦和余弦系数的协方差，传递到关键物候指标“峰值时间”上，这是严谨科学分析中不可或缺的一步。",
            "id": "3818966",
            "problem": "由卫星传感器观测到的单个像素的季节性植被信号在时间 $t$ 被建模为余弦和正弦的一阶谐波线性组合：\n$$\ny(t) \\;=\\; \\mu \\;+\\; c \\cos\\!\\big(\\omega t\\big) \\;+\\; s \\sin\\!\\big(\\omega t\\big) \\;+\\; \\varepsilon(t),\n$$\n其中 $\\omega \\;=\\; \\frac{2\\pi}{T}$ 是周期 $T$ 的已知年角频率，$\\mu$ 是一个恒定的偏移量，$\\varepsilon(t)$ 是零均值噪声。余弦和正弦系数 $(c,s)$ 通过普通最小二乘法 (OLS) 获得，它们的联合不确定性由协方差矩阵概括：\n$$\n\\Sigma \\;=\\; \\begin{pmatrix}\n\\operatorname{Var}(c)  \\operatorname{Cov}(c,s) \\\\\n\\operatorname{Cov}(c,s)  \\operatorname{Var}(s)\n\\end{pmatrix}.\n$$\n振幅-相位重新参数化定义为：\n$$\nc \\;=\\; A \\cos(\\phi), \\qquad s \\;=\\; A \\sin(\\phi),\n$$\n因此\n$$\ny(t) \\;=\\; \\mu \\;+\\; A \\cos\\!\\big(\\omega t - \\phi\\big),\n$$\n其中相位 $\\phi \\in [0,2\\pi)$ 以弧度为单位。年内峰值时间定义为满足 $\\omega t - \\phi \\equiv 0 \\;(\\mathrm{mod}\\; 2\\pi)$ 的最早时间 $t$，在主支上为：\n$$\nt_{\\mathrm{peak}} \\;=\\; \\frac{\\phi}{2\\pi}\\,T.\n$$\n\n对于特定像素和年份，您被给予以下统计上一致的 OLS 输出：\n- 估计的余弦系数 $\\hat{c} \\;=\\; 0.12$，\n- 估计的正弦系数 $\\hat{s} \\;=\\; 0.16$，\n- 协方差矩阵项 $\\operatorname{Var}(c) \\;=\\; 2.0 \\times 10^{-5}$，$\\operatorname{Var}(s) \\;=\\; 3.0 \\times 10^{-5}$，以及 $\\operatorname{Cov}(c,s) \\;=\\; 0.5 \\times 10^{-5}$，\n- 年周期 $T \\;=\\; 365$ 天，\n- 所有角度均以弧度为单位。\n\n仅从上述定义、平滑映射的可微性以及随机向量可微变换的一阶（线性）不确定性传播出发，从 $(c,s)$ 的联合不确定性推导 $\\phi$ 的一阶方差，然后通过 $t_{\\mathrm{peak}} \\;=\\; \\frac{\\phi}{2\\pi} T$ 进行传播，以获得以天为单位的单标准差不确定性 $\\sigma_{t_{\\mathrm{peak}}}$。\n\n将您的 $\\sigma_{t_{\\mathrm{peak}}}$ 最终数值答案四舍五入到四位有效数字。最终时间不确定性以天为单位表示。仅提供单个数值作为您的最终答案。角度单位是弧度。",
            "solution": "目标是求出植被信号峰值时间 $t_{\\mathrm{peak}}$ 的单标准差不确定性 $\\sigma_{t_{\\mathrm{peak}}}$。该问题要求基于一阶不确定性传播（也称为Delta方法）进行推导。这涉及两个主要步骤：首先，将不确定性从余弦和正弦系数 $(c, s)$ 传播到相角 $\\phi$，其次，将不确定性从 $\\phi$ 传播到 $t_{\\mathrm{peak}}$。\n\n相角 $\\phi$ 是系数 $(c,s)$ 的函数，通过变换 $c = A \\cos(\\phi)$ 和 $s = A \\sin(\\phi)$。这意味着 $\\tan(\\phi) = s/c$。对于给定的估计系数 $\\hat{c} = 0.12 > 0$ 和 $\\hat{s} = 0.16 > 0$，相角位于第一象限，函数可以写成 $\\phi(c, s) = \\arctan(s/c)$。\n\n随机向量 $X$ 的函数 $g(X)$ 的方差的一阶近似由下式给出：\n$$\n\\operatorname{Var}(g(X)) \\approx (\\nabla g)^T \\Sigma_X (\\nabla g)\n$$\n其中 $\\nabla g$ 是在 $X$ 的均值处计算的函数 $g$ 的梯度，$\\Sigma_X$ 是 $X$ 的协方差矩阵。在我们的例子中，$g(c,s) = \\phi(c,s)$，随机向量是 $X = (c,s)^T$，其协方差矩阵是 $\\Sigma$。\n\n首先，我们计算 $\\phi(c,s) = \\arctan(s/c)$ 的梯度。偏导数是：\n$$\n\\frac{\\partial\\phi}{\\partial c} = \\frac{\\partial}{\\partial c} \\arctan\\left(\\frac{s}{c}\\right) = \\frac{1}{1 + (s/c)^2} \\cdot \\left(-\\frac{s}{c^2}\\right) = \\frac{c^2}{c^2+s^2} \\cdot \\left(-\\frac{s}{c^2}\\right) = -\\frac{s}{c^2+s^2}\n$$\n$$\n\\frac{\\partial\\phi}{\\partial s} = \\frac{\\partial}{\\partial s} \\arctan\\left(\\frac{s}{c}\\right) = \\frac{1}{1 + (s/c)^2} \\cdot \\left(\\frac{1}{c}\\right) = \\frac{c^2}{c^2+s^2} \\cdot \\left(\\frac{1}{c}\\right) = \\frac{c}{c^2+s^2}\n$$\n因此，梯度向量 $\\nabla \\phi$ 为：\n$$\n\\nabla \\phi = \\begin{pmatrix} \\frac{\\partial\\phi}{\\partial c} \\\\ \\frac{\\partial\\phi}{\\partial s} \\end{pmatrix} = \\frac{1}{c^2+s^2} \\begin{pmatrix} -s \\\\ c \\end{pmatrix}\n$$\n现在，我们应用不确定性传播公式来求 $\\phi$ 的方差 $\\operatorname{Var}(\\phi)$：\n$$\n\\operatorname{Var}(\\phi) \\approx \\left( \\frac{1}{c^2+s^2} \\begin{pmatrix} -s \\\\ c \\end{pmatrix} \\right)^T \\begin{pmatrix} \\operatorname{Var}(c)  \\operatorname{Cov}(c,s) \\\\ \\operatorname{Cov}(c,s)  \\operatorname{Var}(s) \\end{pmatrix} \\left( \\frac{1}{c^2+s^2} \\begin{pmatrix} -s \\\\ c \\end{pmatrix} \\right)\n$$\n$$\n\\operatorname{Var}(\\phi) \\approx \\frac{1}{(c^2+s^2)^2} \\begin{pmatrix} -s  c \\end{pmatrix} \\begin{pmatrix} \\operatorname{Var}(c)  \\operatorname{Cov}(c,s) \\\\ \\operatorname{Cov}(c,s)  \\operatorname{Var}(s) \\end{pmatrix} \\begin{pmatrix} -s \\\\ c \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n\\begin{pmatrix} -s  c \\end{pmatrix} \\begin{pmatrix} \\operatorname{Var}(c)  \\operatorname{Cov}(c,s) \\\\ \\operatorname{Cov}(c,s)  \\operatorname{Var}(s) \\end{pmatrix} = \\begin{pmatrix} -s\\operatorname{Var}(c) + c\\operatorname{Cov}(c,s)  -s\\operatorname{Cov}(c,s) + c\\operatorname{Var}(s) \\end{pmatrix}\n$$\n$$\n\\left( \\begin{pmatrix} -s\\operatorname{Var}(c) + c\\operatorname{Cov}(c,s)  -s\\operatorname{Cov}(c,s) + c\\operatorname{Var}(s) \\end{pmatrix} \\right) \\begin{pmatrix} -s \\\\ c \\end{pmatrix} = s^2\\operatorname{Var}(c) - sc\\operatorname{Cov}(c,s) - sc\\operatorname{Cov}(c,s) + c^2\\operatorname{Var}(s)\n$$\n这可以简化为：\n$$\ns^2\\operatorname{Var}(c) + c^2\\operatorname{Var}(s) - 2sc\\operatorname{Cov}(c,s)\n$$\n因此，推导出的相位方差表达式为：\n$$\n\\operatorname{Var}(\\phi) \\approx \\frac{s^2\\operatorname{Var}(c) + c^2\\operatorname{Var}(s) - 2sc\\operatorname{Cov}(c,s)}{(c^2+s^2)^2}\n$$\n现在我们将给定的数值代入这个表达式，在估计值 $(\\hat{c}, \\hat{s})$ 处进行计算：\n$\\hat{c} = 0.12$，$\\hat{s} = 0.16$，$\\operatorname{Var}(c) = 2.0 \\times 10^{-5}$，$\\operatorname{Var}(s) = 3.0 \\times 10^{-5}$，以及 $\\operatorname{Cov}(c,s) = 0.5 \\times 10^{-5}$。\n\n我们计算各个组成部分：\n$\\hat{c}^2 = (0.12)^2 = 0.0144$\n$\\hat{s}^2 = (0.16)^2 = 0.0256$\n$\\hat{c}^2 + \\hat{s}^2 = 0.0144 + 0.0256 = 0.04$\n$2\\hat{s}\\hat{c} = 2(0.16)(0.12) = 0.0384$\n\n分子是：\n$N = (0.0256)(2.0 \\times 10^{-5}) + (0.0144)(3.0 \\times 10^{-5}) - (0.0384)(0.5 \\times 10^{-5})$\n$N = (0.0512 \\times 10^{-5}) + (0.0432 \\times 10^{-5}) - (0.0192 \\times 10^{-5})$\n$N = (0.0512 + 0.0432 - 0.0192) \\times 10^{-5} = 0.0752 \\times 10^{-5} = 7.52 \\times 10^{-7}$\n\n分母是：\n$D = (\\hat{c}^2 + \\hat{s}^2)^2 = (0.04)^2 = 0.0016 = 1.6 \\times 10^{-3}$\n\n所以，$\\phi$ 的方差是：\n$$\n\\operatorname{Var}(\\phi) \\approx \\frac{7.52 \\times 10^{-7}}{1.6 \\times 10^{-3}} = 4.7 \\times 10^{-4} \\;\\text{rad}^2\n$$\n第二步是将此方差传播到 $t_{\\mathrm{peak}}$。关系式如下：\n$$\nt_{\\mathrm{peak}} = \\frac{\\phi}{2\\pi} T\n$$\n这是对随机变量 $\\phi$ 按常数因子 $k = \\frac{T}{2\\pi}$ 的线性缩放。对于变换 $Y = kX$，方差传播为 $\\operatorname{Var}(Y) = k^2 \\operatorname{Var}(X)$。因此：\n$$\n\\operatorname{Var}(t_{\\mathrm{peak}}) = \\left(\\frac{T}{2\\pi}\\right)^2 \\operatorname{Var}(\\phi)\n$$\n单标准差不确定性 $\\sigma_{t_{\\mathrm{peak}}}$ 是方差的平方根：\n$$\n\\sigma_{t_{\\mathrm{peak}}} = \\sqrt{\\operatorname{Var}(t_{\\mathrm{peak}})} = \\sqrt{\\left(\\frac{T}{2\\pi}\\right)^2 \\operatorname{Var}(\\phi)} = \\frac{T}{2\\pi} \\sqrt{\\operatorname{Var}(\\phi)}\n$$\n代入年周期 $T = 365$ 天和计算出的 $\\operatorname{Var}(\\phi)$ 的值：\n$$\n\\sigma_{t_{\\mathrm{peak}}} = \\frac{365}{2\\pi} \\sqrt{4.7 \\times 10^{-4}}\n$$\n我们计算数值：\n$$\n\\sqrt{4.7 \\times 10^{-4}} \\approx 0.021679483\n$$\n$$\n\\sigma_{t_{\\mathrm{peak}}} \\approx \\frac{365}{2\\pi} \\times 0.021679483 \\approx 58.09155 \\times 0.021679483 \\approx 1.2593683 \\;\\text{days}\n$$\n按照要求将最终结果四舍五入到四位有效数字，我们得到 $1.259$。",
            "answer": "$$\\boxed{1.259}$$"
        },
        {
            "introduction": "在处理真实的遥感数据时，我们必须面对一个普遍存在的问题：观测噪声的方差（即数据质量）并非恒定，它会随时间变化，这种现象称为异方差性。本练习将指导您超越传统的普通最小二乘法，应用加权最小二乘法（WLS）来获得最佳线性无偏估计。您将推导WLS估计量的协方差矩阵，从而掌握在数据质量不均的情况下，如何通过合理加权来最精确地估算季节性谐波系数。",
            "id": "3818979",
            "problem": "一颗卫星在标称周期为 $T$（单位：天）的单个水文年内测量植被指数，在不一定等间隔的观测时间 $t_i$ 生成一个时间序列 $\\{y(t_i)\\}_{i=1}^{N}$。经过基于物理的预处理，移除了长期均值和除选定波数 $k$ 之外的所有谐波后，残差信号被建模为\n$$\ny(t_i) \\;=\\; a_k \\,\\cos\\!\\big(\\omega_k\\, t_i\\big) \\;+\\; b_k \\,\\sin\\!\\big(\\omega_k\\, t_i\\big) \\;+\\; \\varepsilon_i,\n$$\n其中 $\\omega_k = 2\\pi k / T$ 是以弧度/天表示的角频率，$a_k$ 和 $b_k$ 是保留波数 $k$ 的未知谐波系数，残差 $\\varepsilon_i$ 满足 $\\mathbb{E}[\\varepsilon_i]=0$，相互不相关，并具有一个已知的异方差方差函数 $\\operatorname{Var}(\\varepsilon_i) = \\sigma^2(t_i)$，该函数由传感器几何形状和大气条件确定。所有三角函数参数均以弧度为单位。\n\n在环境建模实践中，当方差函数 $\\sigma^2(t)$ 已知时，最佳线性无偏估计量可通过使用权重 $w(t_i) = 1/\\sigma^2(t_i)$ 的加权最小二乘法 (WLS) 获得。设保留波数的设计矩阵为 $N \\times 2$ 矩阵\n$$\n\\mathbf{X}_k \\;=\\;\n\\begin{pmatrix}\n\\cos(\\omega_k t_1)  \\sin(\\omega_k t_1) \\\\\n\\vdots  \\vdots \\\\\n\\cos(\\omega_k t_N)  \\sin(\\omega_k t_N)\n\\end{pmatrix},\n$$\n并设对角权重矩阵为 $\\mathbf{W} = \\operatorname{diag}\\big(w(t_1),\\ldots,w(t_N)\\big)$，其中 $w(t_i) = 1/\\sigma^2(t_i)$。\n\n从基本线性模型假设和已知异方差性下 WLS 的性质出发，推导保留波数 $k$ 的参数矢量 $\\boldsymbol{\\theta}_k = (a_k, b_k)^{\\top}$ 的 WLS 估计量的期望协方差矩阵，并使用离散加权和\n$$\nS_{cc} \\;=\\; \\sum_{i=1}^{N} w(t_i)\\,\\cos^2(\\omega_k t_i), \\quad\nS_{ss} \\;=\\; \\sum_{i=1}^{N} w(t_i)\\,\\sin^2(\\omega_k t_i), \\quad\nS_{cs} \\;=\\; \\sum_{i=1}^{N} w(t_i)\\,\\cos(\\omega_k t_i)\\,\\sin(\\omega_k t_i).\n$$\n以闭合形式表示您的最终答案。\n\n您的最终答案必须是关于 $(a_k,b_k)$ 的 $2 \\times 2$ 协方差矩阵的单一闭合形式解析表达式，用 $S_{cc}$、$S_{ss}$ 和 $S_{cs}$ 表示。不需要进行数值评估，也不需要四舍五入。仅陈述最终表达式；不要在最终表达式中包含单位。在整个过程中，角度应视为以弧度为单位。",
            "solution": "该问题要求推导谐波系数 $\\boldsymbol{\\theta}_k = (a_k, b_k)^{\\top}$ 的加权最小二乘 (WLS) 估计量的期望协方差矩阵。推导将从问题作为一般线性模型的基本表述开始。\n\n给定单个观测值 $t_i$ 的模型为\n$$\ny(t_i) \\;=\\; a_k \\,\\cos(\\omega_k\\, t_i) \\;+\\; b_k \\,\\sin(\\omega_k\\, t_i) \\;+\\; \\varepsilon_i\n$$\n这可以对所有 $N$ 个观测值以矩阵形式表示为线性模型 $\\mathbf{y} = \\mathbf{X}_k\\boldsymbol{\\theta}_k + \\boldsymbol{\\varepsilon}$，其中：\n- $\\mathbf{y} = (y(t_1), \\dots, y(t_N))^{\\top}$ 是 $N \\times 1$ 的观测向量。\n- $\\mathbf{X}_k$ 是问题陈述中给出的 $N \\times 2$ 设计矩阵。\n- $\\boldsymbol{\\theta}_k = (a_k, b_k)^{\\top}$ 是待估计的 $2 \\times 1$ 参数矢量。\n- $\\boldsymbol{\\varepsilon} = (\\varepsilon_1, \\dots, \\varepsilon_N)^{\\top}$ 是 $N \\times 1$ 的随机误差向量。\n\n问题陈述了误差项的统计特性：\n1.  每个误差的期望值为零，即 $\\mathbb{E}[\\varepsilon_i] = 0$。这意味着误差向量的期望值为零向量，即 $\\mathbb{E}[\\boldsymbol{\\varepsilon}] = \\mathbf{0}$。\n2.  误差是相互不相关的，即当 $i \\neq j$ 时，$\\operatorname{Cov}(\\varepsilon_i, \\varepsilon_j) = 0$。\n3.  每个误差的方差是已知的并且是异方差的，即 $\\operatorname{Var}(\\varepsilon_i) = \\sigma^2(t_i)$。\n\n根据这些特性，我们可以构建误差向量 $\\boldsymbol{\\varepsilon}$ 的协方差矩阵：\n$$\n\\operatorname{Cov}(\\boldsymbol{\\varepsilon}) = \\mathbb{E}[\\boldsymbol{\\varepsilon}\\boldsymbol{\\varepsilon}^{\\top}] = \\operatorname{diag}(\\operatorname{Var}(\\varepsilon_1), \\dots, \\operatorname{Var}(\\varepsilon_N)) = \\operatorname{diag}(\\sigma^2(t_1), \\dots, \\sigma^2(t_N))\n$$\n问题将 WLS 的权重定义为 $w(t_i) = 1/\\sigma^2(t_i)$，权重矩阵定义为 $\\mathbf{W} = \\operatorname{diag}(w(t_1), \\dots, w(t_N))$。由此直接得出，误差的协方差矩阵是权重矩阵的逆矩阵：\n$$\n\\operatorname{Cov}(\\boldsymbol{\\varepsilon}) = \\mathbf{W}^{-1}\n$$\n$\\boldsymbol{\\theta}_k$ 的 WLS 估计量 $\\hat{\\boldsymbol{\\theta}}_k$ 是使加权残差平方和（由表达式 $(\\mathbf{y} - \\mathbf{X}_k\\boldsymbol{\\theta}_k)^{\\top}\\mathbf{W}(\\mathbf{y} - \\mathbf{X}_k\\boldsymbol{\\theta}_k)$ 给出）最小化的估计量。这个最小化问题的解是著名的 WLS 估计量：\n$$\n\\hat{\\boldsymbol{\\theta}}_k = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} \\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{y}\n$$\n根据标准线性模型理论，WLS 估计量 $\\hat{\\boldsymbol{\\theta}}_k$ 的协方差矩阵为：\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_k) = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1}\n$$\n任务简化为计算矩阵 $\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k$ 然后求其逆矩阵。\n令 $c_i = \\cos(\\omega_k t_i)$ 且 $s_i = \\sin(\\omega_k t_i)$。\n$$\n\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k = \\begin{pmatrix} c_1  \\cdots  c_N \\\\ s_1  \\cdots  s_N \\end{pmatrix} \\begin{pmatrix} w(t_1)   0 \\\\  \\ddots  \\\\ 0   w(t_N) \\end{pmatrix} \\begin{pmatrix} c_1  s_1 \\\\ \\vdots  \\vdots \\\\ c_N  s_N \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} c_1  \\cdots  c_N \\\\ s_1  \\cdots  s_N \\end{pmatrix} \\begin{pmatrix} w(t_1)c_1  w(t_1)s_1 \\\\ \\vdots  \\vdots \\\\ w(t_N)c_N  w(t_N)s_N \\end{pmatrix}\n= \\begin{pmatrix} \\sum_{i=1}^{N} w(t_i)c_i^2  \\sum_{i=1}^{N} w(t_i)c_i s_i \\\\ \\sum_{i=1}^{N} w(t_i)s_i c_i  \\sum_{i=1}^{N} w(t_i)s_i^2 \\end{pmatrix}\n$$\n使用问题陈述中提供的定义：\n- $S_{cc} = \\sum_{i=1}^{N} w(t_i)\\cos^2(\\omega_k t_i)$\n- $S_{ss} = \\sum_{i=1}^{N} w(t_i)\\sin^2(\\omega_k t_i)$\n- $S_{cs} = \\sum_{i=1}^{N} w(t_i)\\cos(\\omega_k t_i)\\sin(\\omega_k t_i)$\n矩阵变为：\n$$\n\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k = \\begin{pmatrix} S_{cc}  S_{cs} \\\\ S_{cs}  S_{ss} \\end{pmatrix}\n$$\n最后，我们计算这个 $2 \\times 2$ 矩阵的逆。行列式为 $\\det(\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k) = S_{cc}S_{ss} - S_{cs}^2$。逆矩阵为：\n$$\n\\operatorname{Cov}(\\hat{\\boldsymbol{\\theta}}_k) = (\\mathbf{X}_k^{\\top}\\mathbf{W}\\mathbf{X}_k)^{-1} = \\frac{1}{S_{cc}S_{ss} - S_{cs}^2} \\begin{pmatrix} S_{ss}  -S_{cs} \\\\ -S_{cs}  S_{cc} \\end{pmatrix}\n$$\n这是 $(a_k, b_k)^{\\top}$ 的 WLS 估计量的协方差矩阵的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{S_{cc}S_{ss} - S_{cs}^2} \\begin{pmatrix} S_{ss}  -S_{cs} \\\\ -S_{cs}  S_{cc} \\end{pmatrix}}\n$$"
        }
    ]
}