{
    "hands_on_practices": [
        {
            "introduction": "这项实践将引导你动手计算雷达成像层析中估计精度的基本限度。在构建复杂的层析图像之前，理解我们能达到的对单个体素反射率的最佳估计精度至关重要。通过计算克拉默-拉奥下界（CRLB），你将学习传感器的测量特性与噪声水平如何共同决定任何无偏估计量方差的理论“下限”，从而为评估系统性能提供一个关键基准。",
            "id": "3838169",
            "problem": "一项合成孔径雷达（SAR）层析成像实验使用 $M=4$ 次多基线采集来反演森林冠层的三维反射率。考虑单个体素，其实值反射率幅度参数表示为 $\\theta \\in \\mathbb{R}$。对该体素进行相位参考和聚焦后，对于 $M$ 个堆叠的实值可观测值，其线性化均值数据模型为\n$$\n\\mathbf{y} = \\boldsymbol{\\mu}(\\theta) + \\mathbf{n}, \\quad \\boldsymbol{\\mu}(\\theta) = \\theta \\mathbf{J},\n$$\n其中 $\\mathbf{y} \\in \\mathbb{R}^{4}$ 是测量向量，$\\mathbf{J} \\in \\mathbb{R}^{4}$ 是工作点处已知的体素响应向量，$\\mathbf{n} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{C})$ 是零均值高斯噪声，其协方差矩阵 $\\mathbf{C}$ 已知，且与 $\\theta$ 无关。该设置反映了一种标准的高频雷达遥感情况，其中相干处理已经消除了目标体素的相位，留下了实值的线性化响应幅度。向量 $\\mathbf{J}$ 和协方差 $\\mathbf{C}$ 分别反映了仪器波束方向图权重和采集间噪声统计。\n\n提供了以下通过实验确定的量：\n$$\n\\mathbf{J} = \\begin{pmatrix} 0.8 \\\\ 1.1 \\\\ 0.9 \\\\ 1.0 \\end{pmatrix}, \\qquad \\mathbf{C} = \\operatorname{diag}\\!\\left(0.5,\\,0.7,\\,0.6,\\,0.9\\right).\n$$\n\n使用上述多元高斯模型的统计估计基本原理，计算在此线性化模型下 $\\theta$ 的任意无偏估计量方差的克拉美-罗下界（CRLB）。将最终答案表示为一个实数，四舍五入到四位有效数字，并以无量纲量的形式报告。",
            "solution": "题目要求计算实值参数 $\\theta$ 的任意无偏估计量方差的克拉美-罗下界（CRLB）。CRLB 为无偏估计量 $\\hat{\\theta}$ 的方差提供了一个下界。对于单参数情况，它由费雪信息 $I(\\theta)$ 的倒数给出。\n$$ \\text{Var}(\\hat{\\theta}) \\geq \\text{CRLB}(\\theta) = \\frac{1}{I(\\theta)} $$\n费雪信息定义为对数似然函数关于参数的二阶导数的负期望值：\n$$ I(\\theta) = -E\\left[\\frac{\\partial^2}{\\partial \\theta^2} \\ln p(\\mathbf{y}; \\theta)\\right] $$\n其中 $p(\\mathbf{y}; \\theta)$ 是测量向量 $\\mathbf{y}$ 的概率密度函数（PDF），由 $\\theta$ 参数化。\n\n题目指出，测量向量 $\\mathbf{y} \\in \\mathbb{R}^{4}$ 服从多元高斯分布，其均值与 $\\theta$ 呈线性关系，协方差矩阵 $\\mathbf{C}$ 已知。具体来说，模型为：\n$$ \\mathbf{y} = \\theta \\mathbf{J} + \\mathbf{n}, \\quad \\mathbf{n} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{C}) $$\n这意味着 $\\mathbf{y}$ 本身服从多元高斯分布：\n$$ \\mathbf{y} \\sim \\mathcal{N}(\\boldsymbol{\\mu}(\\theta), \\mathbf{C}) \\quad \\text{with} \\quad \\boldsymbol{\\mu}(\\theta) = \\theta \\mathbf{J} $$\n$\\mathbf{y}$ 的概率密度函数（PDF）由下式给出：\n$$ p(\\mathbf{y}; \\theta) = \\frac{1}{(2\\pi)^{M/2} (\\det(\\mathbf{C}))^{1/2}} \\exp\\left(-\\frac{1}{2} (\\mathbf{y} - \\theta\\mathbf{J})^T \\mathbf{C}^{-1} (\\mathbf{y} - \\theta\\mathbf{J})\\right) $$\n此处，测量次数为 $M=4$。对数似然函数是概率密度函数（PDF）的自然对数：\n$$ \\ln p(\\mathbf{y}; \\theta) = -\\frac{M}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\det(\\mathbf{C})) - \\frac{1}{2} (\\mathbf{y} - \\theta\\mathbf{J})^T \\mathbf{C}^{-1} (\\mathbf{y} - \\theta\\mathbf{J}) $$\n为了计算费雪信息，我们对 $\\theta$ 求导。项 $-\\frac{M}{2}\\ln(2\\pi)$ 和 $-\\frac{1}{2}\\ln(\\det(\\mathbf{C}))$ 相对于 $\\theta$ 是常数。让我们展开指数中的二次项：\n$$ (\\mathbf{y} - \\theta\\mathbf{J})^T \\mathbf{C}^{-1} (\\mathbf{y} - \\theta\\mathbf{J}) = \\mathbf{y}^T\\mathbf{C}^{-1}\\mathbf{y} - 2\\theta\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{y} + \\theta^2\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{J} $$\n因此，对数似然函数可以写成：\n$$ \\ln p(\\mathbf{y}; \\theta) = K - \\frac{1}{2}\\left( \\mathbf{y}^T\\mathbf{C}^{-1}\\mathbf{y} - 2\\theta\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{y} + \\theta^2\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{J} \\right) $$\n其中 $K$ 代表所有不依赖于 $\\theta$ 的项。\n\n对数似然函数关于 $\\theta$ 的一阶导数（得分函数）是：\n$$ \\frac{\\partial}{\\partial \\theta} \\ln p(\\mathbf{y}; \\theta) = - \\frac{1}{2} \\left( -2\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{y} + 2\\theta\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{J} \\right) = \\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{y} - \\theta\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{J} $$\n关于 $\\theta$ 的二阶导数是：\n$$ \\frac{\\partial^2}{\\partial \\theta^2} \\ln p(\\mathbf{y}; \\theta) = -\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{J} $$\n二阶导数相对于数据 $\\mathbf{y}$ 是一个常数，所以其期望就是其本身：\n$$ E\\left[\\frac{\\partial^2}{\\partial \\theta^2} \\ln p(\\mathbf{y}; \\theta)\\right] = -\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{J} $$\n因此，费雪信息为：\n$$ I(\\theta) = -E\\left[\\frac{\\partial^2}{\\partial \\theta^2} \\ln p(\\mathbf{y}; \\theta)\\right] = -(-\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{J}) = \\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{J} $$\n注意，对于这个模型，费雪信息与参数 $\\theta$ 无关。CRLB 是费雪信息的倒数：\n$$ \\text{CRLB}(\\theta) = \\frac{1}{I(\\theta)} = (\\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{J})^{-1} $$\n现在我们代入给定的值：\n$$ \\mathbf{J} = \\begin{pmatrix} 0.8 \\\\ 1.1 \\\\ 0.9 \\\\ 1.0 \\end{pmatrix}, \\qquad \\mathbf{C} = \\operatorname{diag}\\!\\left(0.5,\\,0.7,\\,0.6,\\,0.9\\right) $$\n因为 $\\mathbf{C}$ 是一个对角矩阵，其逆矩阵 $\\mathbf{C}^{-1}$ 也是一个对角矩阵，其对角元素是 $\\mathbf{C}$ 对角元素的倒数：\n$$ \\mathbf{C}^{-1} = \\operatorname{diag}\\!\\left(\\frac{1}{0.5}, \\frac{1}{0.7}, \\frac{1}{0.6}, \\frac{1}{0.9}\\right) $$\n费雪信息是一个标量，计算如下：\n$$ I(\\theta) = \\mathbf{J}^T\\mathbf{C}^{-1}\\mathbf{J} = \\sum_{i=1}^{4} \\frac{J_i^2}{C_{ii}} $$\n其中 $J_i$ 是 $\\mathbf{J}$ 的分量，$C_{ii}$ 是 $\\mathbf{C}$ 的对角元素。\n让我们计算各个项：\n$$ \\frac{J_1^2}{C_{11}} = \\frac{(0.8)^2}{0.5} = \\frac{0.64}{0.5} = 1.28 $$\n$$ \\frac{J_2^2}{C_{22}} = \\frac{(1.1)^2}{0.7} = \\frac{1.21}{0.7} \\approx 1.72857 $$\n$$ \\frac{J_3^2}{C_{33}} = \\frac{(0.9)^2}{0.6} = \\frac{0.81}{0.6} = 1.35 $$\n$$ \\frac{J_4^2}{C_{44}} = \\frac{(1.0)^2}{0.9} = \\frac{1}{0.9} \\approx 1.11111 $$\n将这些项相加得到费雪信息：\n$$ I(\\theta) = 1.28 + \\frac{1.21}{0.7} + 1.35 + \\frac{1}{0.9} \\approx 5.46968 $$\n为了避免舍入误差，我们使用分数：\n$$ I(\\theta) = \\frac{128}{100} + \\frac{121}{70} + \\frac{135}{100} + \\frac{10}{9} = \\frac{263}{100} + \\frac{121}{70} + \\frac{10}{9} $$\n使用公分母 $6300$：\n$$ I(\\theta) = \\frac{263 \\times 63}{6300} + \\frac{121 \\times 90}{6300} + \\frac{10 \\times 700}{6300} = \\frac{16569 + 10890 + 7000}{6300} = \\frac{34459}{6300} $$\nCRLB 是 $I(\\theta)$ 的倒数：\n$$ \\text{CRLB}(\\theta) = \\frac{1}{I(\\theta)} = \\frac{6300}{34459} $$\n计算数值：\n$$ \\text{CRLB}(\\theta) \\approx 0.182796366... $$\n题目要求结果四舍五入到四位有效数字。前四位有效数字是 $1$、$8$、$2$、$7$。第五位有效数字是 $9$，所以我们将第四位数字向上舍入。\n$$ \\text{CRLB}(\\theta) \\approx 0.1828 $$\n这就是 $\\theta$ 的任意无偏估计量方差的下界。",
            "answer": "$$\\boxed{0.1828}$$"
        },
        {
            "introduction": "从理论极限转向实际重建，本练习旨在连接数学公式与计算实现之间的鸿沟。雷达成像层析本质上是一个逆问题，而反射率等物理量不能为负。这项实践  将指导你实现投影梯度法，这是一种能够强制施加此类物理约束的强大算法，并分析其收敛行为。你将通过此过程获得构建和调试科学反演求解器的第一手经验。",
            "id": "3838203",
            "problem": "考虑三维（3D）结构重建中的单散射（Born）近似下的线性化雷达断层成像模型。设未知的非负反射率场由向量 $x \\in \\mathbb{R}^n$ 表示，其分量约束为 $x_i \\ge 0$，测量模型为 $y = A x + \\eta$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 是由雷达照射和观测几何结构决定的系统（正向）矩阵，$y \\in \\mathbb{R}^m$ 是测量的振幅，$\\eta$ 是加性噪声。一个标准的数据保真目标是最小二乘函数 $f(x) = \\tfrac{1}{2}\\|A x - y\\|_2^2$，其中 $\\|\\cdot\\|_2$ 表示欧几里得范数。反射率是无量纲（无单位）的，所有量均视为无量纲处理。\n\n目标是通过在迭代求解器中将迭代点投影到非负象限，来引入反射率的物理正性约束，并分析投影梯度法的收敛条件。从最小二乘目标及其梯度（通过链式法则和二次型性质推导）的基本定义出发，实现投影梯度迭代\n$$\nx^{k+1} = \\Pi_{\\mathbb{R}_+^n}\\!\\left(x^k - \\alpha \\nabla f(x^k)\\right),\n$$\n其中 $\\Pi_{\\mathbb{R}_+^n}$ 是到非负象限的分量投影（即 $(\\Pi_{\\mathbb{R}_+^n}(z))_i = \\max(z_i, 0)$），$\\alpha > 0$ 是一个恒定步长，$\\nabla f(x)$ 是 $f(x)$ 的梯度。\n\n您的程序必须：\n- 从 $f(x) = \\tfrac{1}{2}\\|A x - y\\|_2^2$ 的定义推导并计算 $\\nabla f(x)$。\n- 实现一个采用固定步长 $\\alpha$ 的投影梯度法。\n- 跟踪目标函数序列 $f(x^k)$ 并检查其单调递减性。\n- 在每一步验证迭代点的可行性（非负性）。\n- 通过标准 $\\|x^{k+1} - x^k\\|_2 \\le \\varepsilon$ 检查收敛性，其中 $\\varepsilon$ 是预设的容差。\n\n收敛性分析要求：\n- 利用 $\\nabla f(x)$ 的 Lipschitz 连续性（Lipschitz 常数为 $L = \\|A^\\top A\\|_2$，即谱范数）来推断在凸目标函数和闭凸约束集上投影梯度法收敛的步长条件。\n- 讨论在何种条件下 $f(x^k)$ 的单调递减性成立，以及在何种情况下可能不成立。\n\n测试套件：\n实现并运行以下四个测试案例。每个案例必须是确定性的。在指定情况下使用给定的随机种子来构造 $A$ 和 $y$。\n\n- 案例 1（单位矩阵，一步精确投影）：\n  - $n = 5$，$m = 5$，$A = I_n$（$n \\times n$ 单位矩阵），$y = [1.0,\\,-2.0,\\,0.5,\\,-0.1,\\,3.0]^\\top$，$x^0 = 0_n$，$\\alpha = 1.0$，$\\varepsilon = 10^{-8}$，最大迭代次数 $K = 5$。\n  - 预期行为：$x^1 = \\Pi_{\\mathbb{R}_+^n}(y)$。\n\n- 案例 2（良态随机系统，保守步长）：\n  - $n = 8$，$m = 8$，通过从标准正态分布中独立抽取元素来构造 $A$ 和 $y$（使用种子 $1$）：\n    - 使用种子 $1$ 生成 $A \\in \\mathbb{R}^{8 \\times 8}$ 和 $y \\in \\mathbb{R}^8$。\n    - 计算 $L = \\|A^\\top A\\|_2$。\n    - 设置 $\\alpha = 0.9 / L$。\n    - $x^0 = 0_n$，$\\varepsilon = 10^{-8}$，最大迭代次数 $K = 200$。\n\n- 案例 3（随机系统，超出稳定性边界的激进步长）：\n  - $n = 8$，$m = 8$，通过从标准正态分布中独立抽取元素来构造 $A$ 和 $y$（使用种子 $7$）：\n    - 使用种子 $7$ 生成 $A \\in \\mathbb{R}^{8 \\times 8}$ 和 $y \\in \\mathbb{R}^8$。\n    - 计算 $L = \\|A^\\top A\\|_2$。\n    - 设置 $\\alpha = 2.1 / L$。\n    - $x^0 = 0_n$，$\\varepsilon = 10^{-8}$，最大迭代次数 $K = 200$。\n\n- 案例 4（病态对角系统，接近边界的步长）：\n  - $n = 6$，$m = 6$，令 $A = \\operatorname{diag}([10^{-3},\\,10^{-2},\\,10^{-1},\\,1,\\,10,\\,100])$ 且 $y = [1,\\,2,\\,3,\\,4,\\,5,\\,6]^\\top$。\n  - 计算 $L = \\|A^\\top A\\|_2$。\n  - 设置 $\\alpha = 1.9 / L$。\n  - $x^0 = 0_n$，$\\varepsilon = 10^{-10}$，最大迭代次数 $K = 300$。\n\n程序输出：\n对于每个测试案例，生成一个包含以下四个条目的列表：\n$[f^\\ast,\\,\\text{is\\_monotone},\\,\\text{is\\_feasible},\\,\\text{is\\_converged}]$，其中：\n- $f^\\ast$ 是最终的目标函数值 $f(x^K)$，四舍五入到 $6$ 位小数（无量纲）。\n- $\\text{is\\_monotone}$ 是一个布尔值，指示对于所有迭代 $k$ 是否都满足 $f(x^{k+1}) \\le f(x^k)$ （在 $10^{-12}$ 的数值容差内）。\n- $\\text{is\\_feasible}$ 是一个布尔值，指示所有迭代点 $x^k$ 是否都满足分量非负。\n- $\\text{is\\_converged}$ 是一个布尔值，指示在达到最大迭代次数 $K$ 之前，是否在某次迭代中满足了停止标准 $\\|x^{k+1} - x^k\\|_2 \\le \\varepsilon$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，按顺序为每个测试案例提供一个结果列表：$[\\,\\text{case1\\_result},\\,\\text{case2\\_result},\\,\\text{case3\\_result},\\,\\text{case4\\_result}\\,]$。",
            "solution": "该问题是有效的。它提出了一个明确定义的数值优化任务，该任务基于标准的信号处理和优化理论，并提供了所有必要的参数和条件。\n\n问题的核心是使用投影梯度法求解一个非负最小二乘（NNLS）问题，形式如下\n$$\n\\min_{x \\ge 0} f(x) = \\min_{x \\in \\mathbb{R}_+^n} \\frac{1}{2}\\|A x - y\\|_2^2,\n$$\n\n**1. 梯度的推导**\n\n目标函数为 $f(x) = \\frac{1}{2}\\|A x - y\\|_2^2$。根据欧几里得范数的定义 $\\|v\\|_2^2 = v^\\top v$，可以将其展开：\n$$\nf(x) = \\frac{1}{2}(A x - y)^\\top (A x - y)\n$$\n展开乘积可得：\n$$\nf(x) = \\frac{1}{2}(x^\\top A^\\top - y^\\top)(A x - y) = \\frac{1}{2}(x^\\top A^\\top A x - x^\\top A^\\top y - y^\\top A x + y^\\top y)\n$$\n由于 $y^\\top A x$ 是一个标量，它等于其转置，即 $(y^\\top A x)^\\top = x^\\top A^\\top y$。因此，两个交叉项是相同的。\n$$\nf(x) = \\frac{1}{2}(x^\\top A^\\top A x - 2 y^\\top A x + y^\\top y)\n$$\n这是关于 $x$ 的一个二次函数。为了求梯度 $\\nabla f(x)$，我们对 $x$ 求导。使用矩阵微积分的标准结果，其中 $\\nabla_x(x^\\top B x) = (B+B^\\top)x$ 和 $\\nabla_x(c^\\top x) = c$：\n- 二次项 $x^\\top(A^\\top A)x$ 的梯度是 $(A^\\top A + (A^\\top A)^\\top)x = 2A^\\top A x$，因为 $A^\\top A$ 是对称的。\n- 线性项 $-2y^\\top A x = -2(A^\\top y)^\\top x$ 的梯度是 $-2A^\\top y$。\n- 常数项 $y^\\top y$ 的梯度是 $0$。\n\n合并这些项并计入因子 $\\frac{1}{2}$：\n$$\n\\nabla f(x) = \\frac{1}{2}(2A^\\top A x - 2A^\\top y) = A^\\top A x - A^\\top y\n$$\n提出公因子 $A^\\top$，我们得到计算上方便的形式：\n$$\n\\nabla f(x) = A^\\top(A x - y)\n$$\n\n**2. 投影梯度法**\n\n投影梯度法是一种用于求解约束优化问题的迭代算法。对于给定的问题，约束是解 $x$ 必须位于非负象限中，即 $C = \\mathbb{R}_+^n = \\{x \\in \\mathbb{R}^n \\mid x_i \\ge 0 \\text{ for all } i\\}$。这是一个闭凸集。\n\n迭代过程分两步进行：\n1.  执行一个标准的梯度下降步，以找到一个中间点 $z^k$：\n    $$\n    z^k = x^k - \\alpha \\nabla f(x^k)\n    $$\n    其中 $x^k$ 是当前迭代点，$\\alpha > 0$ 是步长。\n2.  将点 $z^k$ 投影回可行集 $C$ 上，以获得下一个迭代点 $x^{k+1}$：\n    $$\n    x^{k+1} = \\Pi_C(z^k)\n    $$\n到非负象限的投影 $\\Pi_C(z)$ 是一种分量级运算，将任何负分量置为零：\n$$\n(\\Pi_{\\mathbb{R}_+^n}(z))_i = \\max(z_i, 0)\n$$\n结合这些步骤，得到完整的迭代更新规则：\n$$\nx^{k+1} = \\Pi_{\\mathbb{R}_+^n}\\!\\left(x^k - \\alpha \\nabla f(x^k)\\right)\n$$\n算法从一个初始猜测 $x^0$ 开始，重复此更新直到满足收敛准则，例如当连续迭代点之间的变化很小时，即 $\\|x^{k+1} - x^k\\|_2 \\le \\varepsilon$。\n\n**3. 收敛性分析和步长条件**\n\n投影梯度法的收敛性关键取决于目标函数的性质和步长 $\\alpha$ 的选择。\n\n目标函数 $f(x)$ 是凸函数，因为它的 Hessian 矩阵 $\\nabla^2 f(x) = A^\\top A$ 是一个半正定矩阵。梯度 $\\nabla f(x)$ 是 Lipschitz 连续的，意味着存在一个常数 $L > 0$ 使得对于任意两点 $x_1, x_2$：\n$$\n\\|\\nabla f(x_1) - \\nabla f(x_2)\\|_2 \\le L \\|x_1 - x_2\\|_2\n$$\n满足此条件的最小常数 $L$ 是 Lipschitz 常数。对于我们的梯度，有：\n$$\n\\|\\nabla f(x_1) - \\nabla f(x_2)\\|_2 = \\|(A^\\top A x_1 - A^\\top y) - (A^\\top A x_2 - A^\\top y)\\|_2 = \\|A^\\top A (x_1 - x_2)\\|_2\n$$\n根据诱导矩阵范数的定义，这受 $\\|A^\\top A\\|_2 \\|x_1 - x_2\\|_2$ 的限制。因此，Lipschitz 常数是 $L = \\|A^\\top A\\|_2$，即矩阵 $A^\\top A$ 的谱范数。\n\n对于具有 L-Lipschitz 连续梯度的凸函数，如果步长 $\\alpha$ 是常数且满足 $0 < \\alpha < 2/L$，则投影梯度法保证收敛到一个最小值点。\n\n目标函数单调递减的条件 $f(x^{k+1}) \\le f(x^k)$ 可以更形式化地推导出来。一个从下降引理和投影的性质推导出的关键不等式是：\n$$\nf(x^{k+1}) \\le f(x^k) - \\left(\\frac{1}{\\alpha} - \\frac{L}{2}\\right)\\|x^{k+1}-x^k\\|_2^2\n$$\n为使目标函数非增，我们需要范数项的系数为非负：\n$$\n\\frac{1}{\\alpha} - \\frac{L}{2} \\ge 0 \\implies \\frac{1}{\\alpha} \\ge \\frac{L}{2} \\implies \\alpha \\le \\frac{2}{L}\n$$\n因此，对于任何步长 $\\alpha \\in (0, 2/L)$，除非达到不动点（$x^{k+1} = x^k$），否则目标函数保证在每一步都减小。\n-   如果选择的 $\\alpha$ 满足 $\\alpha \\ge 2/L$（如案例 3），则项 $(\\frac{1}{\\alpha} - \\frac{L}{2})$ 变为零或负。这意味着目标值不再保证减小，算法可能会振荡或发散，导致单调性检查失败。\n-   如果选择的 $\\alpha$ 在稳定范围 $(0, 2/L)$ 内（如案例 2 和 4），则预期目标函数会单调递减。\n\n实现将通过设置每个测试案例、计算 Lipschitz 常数 $L$、相应地设置步长 $\\alpha$，然后迭代投影梯度算法，同时监控指定的条件来进行。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases for the projected gradient method.\n    \"\"\"\n\n    def run_projected_gradient(A, y, x0, alpha, epsilon, max_iter):\n        \"\"\"\n        Implements the projected gradient method for nonnegative least squares.\n        \n        Args:\n            A (np.ndarray): The system matrix.\n            y (np.ndarray): The measurement vector.\n            x0 (np.ndarray): The initial guess for the solution.\n            alpha (float): The step size.\n            epsilon (float): The convergence tolerance.\n            max_iter (int): The maximum number of iterations.\n\n        Returns:\n            list: A list containing [f_star, is_monotone, is_feasible, is_converged].\n        \"\"\"\n        x_current = x0.copy()\n        \n        is_feasible = np.all(x_current >= 0)\n        is_monotone = True\n        is_converged = False\n        \n        f_current = 0.5 * np.linalg.norm(A @ x_current - y)**2\n        \n        for _ in range(max_iter):\n            # Gradient calculation\n            grad = A.T @ (A @ x_current - y)\n            \n            # Update step with projection\n            x_next = np.maximum(x_current - alpha * grad, 0)\n            \n            # Feasibility check for all iterates (projection guarantees this)\n            if np.any(x_next < 0):\n                is_feasible = False\n                \n            # Monotonicity check\n            f_next = 0.5 * np.linalg.norm(A @ x_next - y)**2\n            if f_next > f_current + 1e-12:\n                is_monotone = False\n                \n            # Convergence check\n            if np.linalg.norm(x_next - x_current) <= epsilon:\n                is_converged = True\n                f_current = f_next  # Update to the final value before breaking\n                break\n            \n            # Prepare for next iteration\n            x_current = x_next\n            f_current = f_next\n            \n        f_star = round(f_current, 6)\n        \n        return [f_star, is_monotone, is_feasible, is_converged]\n\n    results = []\n\n    # Case 1: Identity matrix, exact projection in one step\n    n1, m1 = 5, 5\n    A1 = np.identity(n1)\n    y1 = np.array([1.0, -2.0, 0.5, -0.1, 3.0])\n    x0_1 = np.zeros(n1)\n    alpha1 = 1.0\n    eps1 = 1e-8\n    K1 = 5\n    results.append(run_projected_gradient(A1, y1, x0_1, alpha1, eps1, K1))\n    \n    # Case 2: Well-conditioned random system, conservative step size\n    n2, m2 = 8, 8\n    rng2 = np.random.default_rng(seed=1)\n    A2 = rng2.standard_normal((m2, n2))\n    y2 = rng2.standard_normal(m2)\n    L2 = np.linalg.norm(A2.T @ A2, ord=2)\n    alpha2 = 0.9 / L2\n    x0_2 = np.zeros(n2)\n    eps2 = 1e-8\n    K2 = 200\n    results.append(run_projected_gradient(A2, y2, x0_2, alpha2, eps2, K2))\n    \n    # Case 3: Random system, aggressive step size\n    n3, m3 = 8, 8\n    rng3 = np.random.default_rng(seed=7)\n    A3 = rng3.standard_normal((m3, n3))\n    y3 = rng3.standard_normal(m3)\n    L3 = np.linalg.norm(A3.T @ A3, ord=2)\n    alpha3 = 2.1 / L3\n    x0_3 = np.zeros(n3)\n    eps3 = 1e-8\n    K3 = 200\n    results.append(run_projected_gradient(A3, y3, x0_3, alpha3, eps3, K3))\n    \n    # Case 4: Ill-conditioned diagonal system, near-boundary step size\n    n4, m4 = 6, 6\n    A4 = np.diag([1e-3, 1e-2, 1e-1, 1, 10, 100])\n    y4 = np.array([1.0, 2.0, 3.0, 4.0, 5.0, 6.0])\n    L4 = np.linalg.norm(A4.T @ A4, ord=2)\n    alpha4 = 1.9 / L4\n    x0_4 = np.zeros(n4)\n    eps4 = 1e-10\n    K4 = 300\n    results.append(run_projected_gradient(A4, y4, x0_4, alpha4, eps4, K4))\n    \n    # Format the results into the required single-line string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "当一幅层析图像被重建出来后，我们如何定量地评估其质量？本练习深入探讨重建结果的理论分析，重点关注点扩散函数（PSF），它描述了系统的空间分辨率和可能存在的伪影。通过推导吉洪诺夫正则化解的后验点扩散函数 ，你将揭示反演算法参数（如正则化强度 $\\lambda$）与最终图像保真度之间的深刻联系，为你理解和优化层析系统提供一个强大的理论框架。",
            "id": "3838202",
            "problem": "考虑三维合成孔径雷达（SAR）断层成像，用于从含噪声的频域测量中重建体积反射率场 $x(\\mathbf{r})$。假设一个加性高斯白噪声的线性正演模型，$y = \\mathbf{A}x + n$，其中 $\\mathbf{A}$ 将物空间映射到测量空间，$\\mathbf{A}^{*}$ 是其伴随算子，$n$ 的均值为零。Tikhonov正则化重建是通过在零均值高斯先验和二次惩罚下的后验均值得到的，该重建是泛函 $\\| \\mathbf{A}x - y \\|^{2} + \\lambda \\| x \\|^{2}$ 的最小化子，其中 $\\lambda > 0$ 是无量纲的。\n\n假设场景在立方域上是周期的，并且由于在球形带限内对物体的三维傅里叶变换进行均匀和各向同性采样，正规算子 $\\mathbf{A}^{*}\\mathbf{A}$ 是平移不变的。在幺正傅里叶变换约定下进行计算，其逆变换为\n$$\n\\mathcal{F}^{-1}\\{F\\}(\\mathbf{r}) = \\frac{1}{(2\\pi)^{3}} \\int_{\\mathbb{R}^{3}} F(\\mathbf{k}) \\exp(i \\mathbf{k}\\cdot \\mathbf{r}) \\, d^{3}\\mathbf{k}.\n$$\n令正规算子的谱响应为半径 $k_{c}>0$ 的球的指示函数，即当 $\\|\\mathbf{k}\\|\\leq k_{c}$ 时 $W(\\mathbf{k}) = 1$，否则 $W(\\mathbf{k}) = 0$。在这些假设下，将真实场 $x$ 映射到后验均值的分辨率算子是平移不变的，其脉冲响应是后验点扩散函数，定义为 $r(\\mathbf{r}) = \\mathcal{F}^{-1}\\{ \\widehat{R}(\\mathbf{k}) \\}(\\mathbf{r})$，其中 $\\widehat{R}(\\mathbf{k})$ 是分辨率算子的傅里叶域传递函数。\n\n从线性逆问题和Tikhonov正则化估计器的后验均值定义出发，推导分辨率算子的傅里叶域形式，求得后验点扩散函数 $r(\\mathbf{r})$，并解释为什么分辨率算子在标准基下的对角元等于 $r(\\mathbf{0})$。最后，使用所述的傅里叶归一化，将单一量 $r(\\mathbf{0})$ 表示为仅含 $k_{c}$ 和 $\\lambda$ 的闭式解。将此最终量 $r(\\mathbf{0})$ 作为你的答案报告。无需四舍五入，所有量均为无量纲；最终答案中不要包含单位。",
            "solution": "## 问题验证\n\n### 步骤1：提取已知条件\n从问题陈述中提取的已知条件如下：\n-   **模型**：一个加性噪声的线性正演模型，$y = \\mathbf{A}x + n$。\n-   **场**：$x(\\mathbf{r})$ 是体积反射率场。\n-   **数据**：$y$ 是含噪声的频域测量值。\n-   **算子**：$\\mathbf{A}$ 将物空间映射到测量空间；$\\mathbf{A}^{*}$ 是其伴随算子。\n-   **噪声**：$n$ 是均值为零的加性高斯白噪声。\n-   **估计器**：Tikhonov正则化重建是泛函 $\\| \\mathbf{A}x - y \\|^{2} + \\lambda \\| x \\|^{2}$ 的最小化子。\n-   **正则化参数**：$\\lambda > 0$ 且无量纲。\n-   **假设**：\n    -   场景在立方域上是周期的。\n    -   正规算子 $\\mathbf{A}^{*}\\mathbf{A}$ 是平移不变的。\n    -   采样是均匀且各向同性的。\n-   **傅里叶变换约定**：逆变换定义为 $\\mathcal{F}^{-1}\\{F\\}(\\mathbf{r}) = \\frac{1}{(2\\pi)^{3}} \\int_{\\mathbb{R}^{3}} F(\\mathbf{k}) \\exp(i \\mathbf{k}\\cdot \\mathbf{r}) \\, d^{3}\\mathbf{k}$。\n-   **谱响应**：正规算子 $\\mathbf{A}^{*}\\mathbf{A}$ 的谱响应 $W(\\mathbf{k})$ 是半径为 $k_{c}>0$ 的球的指示函数：当 $\\|\\mathbf{k}\\|\\leq k_{c}$ 时 $W(\\mathbf{k}) = 1$，否则 $W(\\mathbf{k}) = 0$。\n-   **分辨率算子**：将真实场 $x$ 映射到后验均值的算子是平移不变的。\n-   **后验点扩散函数 (PSF)**：分辨率算子的脉冲响应是 $r(\\mathbf{r}) = \\mathcal{F}^{-1}\\{ \\widehat{R}(\\mathbf{k}) \\}(\\mathbf{r})$，其中 $\\widehat{R}(\\mathbf{k})$ 是傅里叶域传递函数。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行分析：\n-   **科学基础**：该问题在逆问题、信号处理以及医学/地球物理成像（特别是SAR断层成像）领域有坚实的科学基础。Tikhonov正则化是解决不适定线性逆问题的标准和基本技术。在平移不变性假设下使用傅里叶分析是线性时不变（LTI）系统理论的基石，在此处直接适用。\n-   **适定的**：问题陈述是适定的。对于 $\\lambda > 0$，Tikhonov泛函是严格凸的，保证了唯一的最小化子。这些假设虽然理想化（例如，完美的球形带限），却是用于推导解析见解的标准简化方法。\n-   **客观的**：问题以精确、客观的数学语言陈述。诸如“平移不变”、“后验均值”和“谱响应”等术语在此上下文中具有清晰、明确的定义。\n-   **完整性**：问题提供了推导所求量 $r(\\mathbf{0})$ 所需的所有信息。它明确了估计器、算子的性质、傅里叶约定以及所有相关参数。\n-   **未检测到其他缺陷**：该问题在科学上不是不合理的、不切实际的（在理论问题的背景下）、矛盾的或存在其他缺陷。这是一个实质性的理论推导。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n---\n\n## 解答\n\n该问题要求推导Tikhonov正则化逆问题的后验点扩散函数在原点的值 $r(\\mathbf{0})$ 的闭式表达式。\n\n首先，我们通过最小化Tikhonov泛函 $J(x)$ 来找到估计器 $\\hat{x}$：\n$$J(x) = \\| \\mathbf{A}x - y \\|^{2} + \\lambda \\| x \\|^{2}$$\n这是一个二次泛函。通过将其关于 $x$ 的梯度设为零来找到最小化子。取复导数，我们发现：\n$$\\nabla_{x^{*}} J(x) = \\mathbf{A}^{*}(\\mathbf{A}x - y) + \\lambda x = 0$$\n重新排列各项，我们得到：\n$$\\mathbf{A}^{*}\\mathbf{A}x + \\lambda x = \\mathbf{A}^{*}y$$\n$$(\\mathbf{A}^{*}\\mathbf{A} + \\lambda\\mathbf{I})x = \\mathbf{A}^{*}y$$\n其中 $\\mathbf{I}$ 是单位算子。因此，Tikhonov正则化估计，也就是后验均值 $\\hat{x}$，为：\n$$\\hat{x} = (\\mathbf{A}^{*}\\mathbf{A} + \\lambda\\mathbf{I})^{-1}\\mathbf{A}^{*}y$$\n观测数据 $y$ 是根据模型 $y = \\mathbf{A}x_{true} + n$ 从真实的未知场 $x_{true}$ 生成的。将此代入 $\\hat{x}$ 的表达式中：\n$$\\hat{x} = (\\mathbf{A}^{*}\\mathbf{A} + \\lambda\\mathbf{I})^{-1}\\mathbf{A}^{*}(\\mathbf{A}x_{true} + n)$$\n$$\\hat{x} = (\\mathbf{A}^{*}\\mathbf{A} + \\lambda\\mathbf{I})^{-1}\\mathbf{A}^{*}\\mathbf{A}x_{true} + (\\mathbf{A}^{*}\\mathbf{A} + \\lambda\\mathbf{I})^{-1}\\mathbf{A}^{*}n$$\n分辨率算子 $\\mathbf{R}$ 被定义为在没有噪声（$n=0$）的情况下，将真实场 $x_{true}$ 映射到估计 $\\hat{x}$ 的算子。从上面的表达式中，我们可以确定 $\\mathbf{R}$ 为：\n$$\\mathbf{R} = (\\mathbf{A}^{*}\\mathbf{A} + \\lambda\\mathbf{I})^{-1}\\mathbf{A}^{*}\\mathbf{A}$$\n问题指出，正规算子 $\\mathbf{A}^{*}\\mathbf{A}$ 是平移不变的。这意味着它在空间域中作为卷积运算，而在傅里叶域中作为乘法运算。令 $\\widehat{R}(\\mathbf{k})$ 为 $\\mathbf{R}$ 的脉冲响应的傅里叶变换（分辨率传递函数），$W(\\mathbf{k})$ 为 $\\mathbf{A}^{*}\\mathbf{A}$ 的脉冲响应的傅里叶变换（谱响应）。$\\mathbf{R}$ 在傅里叶域中的运算由下式给出：\n$$\\widehat{R}(\\mathbf{k}) = (W(\\mathbf{k}) + \\lambda)^{-1}W(\\mathbf{k}) = \\frac{W(\\mathbf{k})}{W(\\mathbf{k}) + \\lambda}$$\n我们已知 $W(\\mathbf{k})$ 是半径为 $k_{c}$ 的球的指示函数：\n$$\nW(\\mathbf{k}) =\n\\begin{cases}\n1  &\\text{若 } \\|\\mathbf{k}\\| \\leq k_{c} \\\\\n0  &\\text{若 } \\|\\mathbf{k}\\| > k_{c}\n\\end{cases}\n$$\n将此代入 $\\widehat{R}(\\mathbf{k})$ 的表达式中，得到：\n$$\n\\widehat{R}(\\mathbf{k}) =\n\\begin{cases}\n\\frac{1}{1 + \\lambda}  &\\text{若 } \\|\\mathbf{k}\\| \\leq k_{c} \\\\\n\\frac{0}{0 + \\lambda} = 0  &\\text{若 } \\|\\mathbf{k}\\| > k_{c}\n\\end{cases}\n$$\n所以，分辨率传递函数 $\\widehat{R}(\\mathbf{k})$ 是同一个半径为 $k_{c}$ 的球的一个缩放指示函数。\n\n后验点扩散函数 $r(\\mathbf{r})$ 是分辨率算子的脉冲响应，即 $\\widehat{R}(\\mathbf{k})$ 的傅里叶逆变换：\n$$r(\\mathbf{r}) = \\mathcal{F}^{-1}\\{\\widehat{R}(\\mathbf{k})\\}(\\mathbf{r})$$\n使用提供的傅里叶逆变换定义：\n$$r(\\mathbf{r}) = \\frac{1}{(2\\pi)^{3}} \\int_{\\mathbb{R}^{3}} \\widehat{R}(\\mathbf{k}) \\exp(i \\mathbf{k}\\cdot \\mathbf{r}) \\, d^{3}\\mathbf{k}$$\n问题要求解释为什么分辨率算子在标准基下的对角元等于 $r(\\mathbf{0})$。分辨率算子 $\\mathbf{R}$ 是一个卷积算子，其核（PSF）为 $r(\\mathbf{r})$。它对场 $x_{true}$ 的作用是 $(\\mathbf{R}x_{true})(\\mathbf{r'}) = \\int r(\\mathbf{r'} - \\mathbf{r''})x_{true}(\\mathbf{r''}) d^3\\mathbf{r''}$。因此，该积分算子的核为 $R(\\mathbf{r'}, \\mathbf{r''}) = r(\\mathbf{r'} - \\mathbf{r''})$。“对角元”对应于输入和输出坐标相同的情况，即 $\\mathbf{r'} = \\mathbf{r''}$。这得到 $R(\\mathbf{r'}, \\mathbf{r'}) = r(\\mathbf{r'} - \\mathbf{r'}) = r(\\mathbf{0})$。\n\n我们现在计算这个量 $r(\\mathbf{0})$，通过在 $r(\\mathbf{r})$ 的积分中设置 $\\mathbf{r}=\\mathbf{0}$：\n$$r(\\mathbf{0}) = \\frac{1}{(2\\pi)^{3}} \\int_{\\mathbb{R}^{3}} \\widehat{R}(\\mathbf{k}) \\exp(i \\mathbf{k}\\cdot \\mathbf{0}) \\, d^{3}\\mathbf{k} = \\frac{1}{(2\\pi)^{3}} \\int_{\\mathbb{R}^{3}} \\widehat{R}(\\mathbf{k}) \\, d^{3}\\mathbf{k}$$\n由于 $\\widehat{R}(\\mathbf{k})$ 仅在 $\\|\\mathbf{k}\\| \\le k_{c}$ 时非零，积分变为：\n$$r(\\mathbf{0}) = \\frac{1}{(2\\pi)^{3}} \\int_{\\|\\mathbf{k}\\| \\le k_{c}} \\frac{1}{1 + \\lambda} \\, d^{3}\\mathbf{k}$$\n项 $\\frac{1}{1+\\lambda}$ 是一个常数，可以从积分中提出。剩下的积分是3D k空间中半径为 $k_{c}$ 的球的体积。\n$$\\int_{\\|\\mathbf{k}\\| \\le k_{c}} d^{3}\\mathbf{k} = \\text{半径为 } k_{c} \\text{ 的球的体积} = \\frac{4}{3}\\pi k_{c}^{3}$$\n将此代回 $r(\\mathbf{0})$ 的表达式中：\n$$r(\\mathbf{0}) = \\frac{1}{(2\\pi)^{3}} \\frac{1}{1+\\lambda} \\left(\\frac{4}{3}\\pi k_{c}^{3}\\right)$$\n$$r(\\mathbf{0}) = \\frac{1}{8\\pi^{3}(1+\\lambda)} \\left(\\frac{4}{3}\\pi k_{c}^{3}\\right)$$\n通过约分简化表达式：\n$$r(\\mathbf{0}) = \\frac{4\\pi k_{c}^{3}}{24\\pi^{3}(1+\\lambda)} = \\frac{k_{c}^{3}}{6\\pi^{2}(1+\\lambda)}$$\n这是 $r(\\mathbf{0})$ 作为 $k_{c}$ 和 $\\lambda$ 的函数的最终闭式表达式。",
            "answer": "$$\n\\boxed{\\frac{k_{c}^{3}}{6\\pi^{2}(1+\\lambda)}}\n$$"
        }
    ]
}