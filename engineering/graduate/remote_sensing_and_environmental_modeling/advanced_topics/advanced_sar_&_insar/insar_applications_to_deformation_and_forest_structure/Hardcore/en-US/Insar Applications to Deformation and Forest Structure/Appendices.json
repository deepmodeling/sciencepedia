{
    "hands_on_practices": [
        {
            "introduction": "This exercise takes us back to the first principles of interferometry. By deriving the relationship between ground displacement and the resulting phase \"fringes\" in an interferogram, you will solidify your understanding of how InSAR measures motion. This practice also introduces the critical concept of phase unwrapping and the Nyquist-like sampling limit that determines whether a deformation signal can be recovered without ambiguity. ",
            "id": "3822661",
            "problem": "You are given a one-dimensional idealization of an Interferometric Synthetic Aperture Radar (InSAR) observation of coseismic deformation. The electromagnetic phase measured by interferometry is periodic in the radar wavelength and relates to round-trip path length differences. Use the following fundamental bases, without relying on any pre-derived InSAR-specific shortcuts:\n\n- The phase of a monochromatic electromagnetic wave of wavelength $\\lambda$ accumulated along a travel path of length $r$ is proportional to $r/\\lambda$.\n- In repeat-pass interferometry, a change in line-of-sight range produces a two-way path length change, and thus a phase difference between acquisitions.\n- Fringes are defined as $2\\pi$ phase cycles across the wrapped interferometric phase.\n- For phase unwrapping between neighboring pixels sampled at spacing $p$, a sufficient (but not necessary) condition to avoid aliasing is that the maximum magnitude of the interferometric phase difference between adjacent samples is strictly less than $\\pi$ radians.\n\nAssume the following idealized deformation model for a shallow strike-slip fault observed by InSAR:\n\n- The line-of-sight displacement field across the fault is approximated as a linear ramp from $0$ to a maximum line-of-sight offset $s$ over a shear zone of width $W$ (in meters), centered on the fault trace. Outside the shear zone, the displacement is constant.\n- The interferometric phase is wrapped to the interval $(-\\pi,\\pi]$ radians.\n- The radar wavelength is $\\lambda$ (in meters), pixel spacing is $p$ (in meters), and all angles must be treated in radians.\n\nTasks to perform for each test case:\n\n1) Using only the above bases, derive from first principles and compute the expected number of fringes $N$ associated with the maximum line-of-sight displacement magnitude $s$ and wavelength $\\lambda$. Report $N$ as a floating-point number rounded to six decimal places (dimensionless).\n\n2) Using only the above bases, derive a nearest-neighbor criterion to assess whether phase unwrapping is feasible without aliasing, under the assumption that the maximum phase slope occurs within the linear shear zone. Determine the boolean feasibility by checking if the maximum possible wrapped phase difference between adjacent pixels is strictly less than $\\pi$ radians. Report the feasibility as a boolean value.\n\nTest Suite (each as a tuple $(\\lambda, s, W, p)$, with all lengths in meters):\n\n- Case 1: $(0.056, 0.5, 200.0, 20.0)$\n- Case 2: $(0.23, 0.05, 500.0, 30.0)$\n- Case 3: $(0.031, 0.02, 100.0, 3.0)$\n- Case 4 (boundary case): $(0.056, 1.4, 100.0, 1.0)$\n- Case 5 (no deformation): $(0.24, 0.0, 50.0, 10.0)$\n\nProgram requirements:\n\n- Your program must compute, for each case, a pair consisting of the expected number of fringes $N$ (rounded to six decimal places) and the boolean feasibility of aliasing-free unwrapping based on the nearest-neighbor criterion.\n- The final output format must be a single line containing a Python-style list of lists, where each inner list is of the form $[N, \\text{feasible}]$. For example: $[[N_1,\\text{True}],[N_2,\\text{False}],\\dots]$.\n- Ensure that all computations treat angles in radians, and lengths in meters as provided.",
            "solution": "The problem has been validated and is deemed sound. It is scientifically grounded, well-posed, objective, and contains all necessary information for a complete solution. The provided parameters are physically realistic for InSAR observations of coseismic deformation. The tasks require deriving fundamental relationships from first principles, which is a valid and instructive exercise.\n\nThe solution is presented in two parts, corresponding to the two tasks requested for each test case. All derivations are based on the principles provided in the problem statement.\n\n### Part 1: Derivation of the Number of Fringes ($N$)\n\nThe relationship between the phase $\\phi$ of an electromagnetic wave, its travel path length $r$, and its wavelength $\\lambda$ is given as proportional. The standard physical relation for a full cycle of $2\\pi$ radians is:\n$$ \\phi = 2\\pi \\frac{r}{\\lambda} $$\nIn repeat-pass Interferometric Synthetic Aperture Radar (InSAR), the sensor measures the phase difference $\\Delta\\phi$ between two acquisitions. This phase difference is caused by a change in the line-of-sight (LOS) distance between the satellite and a point on the ground. A change in the LOS distance, let's call it $d_{los}$, alters the round-trip path length of the radar signal. The signal travels from the satellite to the ground and back, so the total path length change is twice the LOS displacement, i.e., $2d_{los}$.\n\nThe interferometric phase difference $\\Delta\\phi$ is therefore related to the LOS displacement $d_{los}$ by:\n$$ \\Delta\\phi = 2\\pi \\frac{2d_{los}}{\\lambda} = \\frac{4\\pi d_{los}}{\\lambda} $$\nThe problem defines a fringe as a $2\\pi$ phase cycle. The total number of fringes, $N$, across a deforming area is the total accumulated phase change, $\\Delta\\phi_{total}$, divided by $2\\pi$. The problem specifies a maximum LOS displacement magnitude of $s$, which represents the total displacement across the fault shear zone. The total phase change associated with this displacement $s$ is:\n$$ \\Delta\\phi_{max} = \\frac{4\\pi s}{\\lambda} $$\nThus, the total number of fringes $N$ is calculated as:\n$$ N = \\frac{\\Delta\\phi_{max}}{2\\pi} = \\frac{4\\pi s / \\lambda}{2\\pi} $$\nThis simplifies to the final expression for the number of fringes:\n$$ N = \\frac{2s}{\\lambda} $$\nThis value is dimensionless. For each test case, we will compute $N$ using the provided values of $s$ and $\\lambda$ and round the result to six decimal places.\n\n### Part 2: Derivation of the Unwrapping Feasibility Criterion\n\nPhase unwrapping aims to reconstruct the original, continuous phase field from its wrapped representation, which is confined to the interval $(-\\pi, \\pi]$. Aliasing occurs when the phase gradient is too steep, causing the phase difference between adjacent samples to exceed half a cycle ($\\pi$ radians). This leads to an ambiguity in the number of $2\\pi$ cycles to add or subtract.\n\nThe problem provides a sufficient condition to avoid aliasing: the maximum magnitude of the interferometric phase difference between adjacent pixels, $\\Delta\\phi_{adj}$, must be strictly less than $\\pi$ radians.\n$$ |\\Delta\\phi_{adj}|_{max}  \\pi $$\nWe need to find an expression for $|\\Delta\\phi_{adj}|_{max}$. The problem assumes an idealized deformation model where the LOS displacement $d_{los}$ varies linearly from $0$ to $s$ over a shear zone of width $W$. Within this zone, the displacement gradient is constant and at its maximum value. Let $x$ be the coordinate perpendicular to the fault trace. The displacement gradient is:\n$$ \\frac{\\partial d_{los}}{\\partial x} = \\frac{s}{W} $$\nOutside the shear zone, the displacement is constant, and the gradient is $0$.\n\nThe phase gradient is related to the displacement gradient:\n$$ \\frac{\\partial\\phi}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{4\\pi d_{los}(x)}{\\lambda} \\right) = \\frac{4\\pi}{\\lambda} \\frac{\\partial d_{los}}{\\partial x} $$\nThe maximum phase gradient occurs within the shear zone:\n$$ \\left( \\frac{\\partial\\phi}{\\partial x} \\right)_{max} = \\frac{4\\pi}{\\lambda} \\frac{s}{W} = \\frac{4\\pi s}{\\lambda W} $$\nThe phase difference between two adjacent pixels separated by a spacing $p$ can be approximated using a first-order Taylor expansion (or finite difference), assuming the gradient is constant over the distance $p$:\n$$ \\Delta\\phi_{adj} \\approx \\frac{\\partial\\phi}{\\partial x} \\cdot p $$\nThe maximum phase difference between adjacent pixels, $|\\Delta\\phi_{adj}|_{max}$, will occur where the phase gradient is maximum:\n$$ |\\Delta\\phi_{adj}|_{max} = \\left( \\frac{\\partial\\phi}{\\partial x} \\right)_{max} \\cdot p = \\left( \\frac{4\\pi s}{\\lambda W} \\right) p $$\nApplying the aliasing condition:\n$$ \\frac{4\\pi s p}{\\lambda W}  \\pi $$\nDividing by $\\pi$ (since $\\pi  0$), we arrive at the criterion for aliasing-free unwrapping:\n$$ \\frac{4sp}{\\lambda W}  1 $$\nFor each test case, we will evaluate this inequality using the provided values of $s$, $p$, $\\lambda$, and $W$. The result is a boolean value indicating whether unwrapping is feasible without aliasing under the given model and sampling.\n\n### Summary of Formulas for Computation\n\nFor each test case $(\\lambda, s, W, p)$:\n1.  Number of fringes: $N = \\frac{2s}{\\lambda}$\n2.  Unwrapping feasibility: `True` if $\\frac{4sp}{\\lambda W}  1$, `False` otherwise.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other non-standard libraries are used or needed.\n\ndef solve():\n    \"\"\"\n    Computes InSAR fringe count and unwrapping feasibility for given test cases.\n\n    The solution is derived from first principles as outlined in the problem statement.\n    \n    1. Number of Fringes (N):\n       The interferometric phase change for a line-of-sight displacement 's' is\n       Δφ = 4πs/λ. A fringe is a 2π cycle.\n       Therefore, N = Δφ / 2π = 2s/λ.\n\n    2. Unwrapping Feasibility:\n       Aliasing is avoided if the phase difference between adjacent pixels is  π.\n       The displacement gradient is s/W in the shear zone.\n       The phase gradient is (4π/λ) * (s/W).\n       The phase difference between pixels spaced by 'p' is approx. p * (phase gradient).\n       So, |p * 4πs / (λW)|  π, which simplifies to 4sp / (λW)  1.\n    \"\"\"\n    # Test Suite (lambda, s, W, p) in meters.\n    test_cases = [\n        # Case 1: (λ, s, W, p)\n        (0.056, 0.5, 200.0, 20.0),\n        # Case 2\n        (0.23, 0.05, 500.0, 30.0),\n        # Case 3\n        (0.031, 0.02, 100.0, 3.0),\n        # Case 4 (boundary case)\n        (0.056, 1.4, 100.0, 1.0),\n        # Case 5 (no deformation)\n        (0.24, 0.0, 50.0, 10.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        lmbda, s, W, p = case\n\n        # Task 1: Calculate the number of fringes N\n        # Handle division by zero for lambda, although test cases are valid.\n        if lmbda == 0:\n            # Physically unrealistic, but for code robustness\n            n_fringes = float('inf') if s > 0 else 0.0\n        else:\n            n_fringes = 2 * s / lmbda\n\n        # Task 2: Determine phase unwrapping feasibility\n        # Handle division by zero for lambda or W\n        if lmbda == 0 or W == 0:\n            # A zero-width shear zone implies an infinite gradient if s > 0.\n            # A zero wavelength implies infinite phase for any displacement.\n            # In both scenarios, aliasing is guaranteed if s > 0.\n            feasible = (s == 0)\n        else:\n            # Criterion: 4 * s * p / (lambda * W)  1\n            aliasing_metric = 4 * s * p / (lmbda * W)\n            feasible = aliasing_metric  1\n\n        results.append([n_fringes, feasible])\n\n    # Format the final output string exactly as specified.\n    # N is formatted to six decimal places, and feasibility as a boolean literal.\n    output_parts = []\n    for n, f in results:\n        # Format N to 6 decimal places, ensuring trailing zeros.\n        n_str = f\"{n:.6f}\"\n        # Convert boolean to string \"True\" or \"False\".\n        f_str = str(f)\n        output_parts.append(f\"[{n_str},{f_str}]\")\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "Applying InSAR to vegetated areas like forests presents a major challenge: temporal decorrelation. This problem explores how the physical structure of a forest influences InSAR coherence by modeling the backscatter as a mix of signals from different, variably stable components. By calculating the expected coherence for different radar polarizations, you will learn how to connect scattering physics to the quality of an interferometric measurement. ",
            "id": "3822603",
            "problem": "An Interferometric Synthetic Aperture Radar (InSAR) observation of a tropical rainforest is conducted in repeat-pass mode at L-band. The two Synthetic Aperture Radar (SAR) acquisitions are separated by a time interval of $\\Delta t = 3$ days with a short perpendicular baseline such that geometric decorrelation is negligible. Atmospheric phase and thermal noise contributions are negligible and identical across polarizations. The total backscattered complex field at a given polarization is the sum of mutually uncorrelated scattering components: surface, double-bounce, and vegetation volume. Each component undergoes temporal decorrelation that can be modeled as a stationary first-order process with a characteristic time constant, leading to a coherence magnitude that depends on $\\Delta t$ and the component’s time constant. The forest canopy is old-growth and structurally complex, with the following physically plausible polarization-dependent fractional power contributions (normalized to sum to $1$):\n\n- For horizontal transmit, horizontal receive ($\\mathrm{HH}$): $f_{\\mathrm{vol}} = 0.50$, $f_{\\mathrm{db}} = 0.40$, $f_{\\mathrm{s}} = 0.10$.\n- For horizontal transmit, vertical receive ($\\mathrm{HV}$): $f_{\\mathrm{vol}} = 0.90$, $f_{\\mathrm{db}} = 0.05$, $f_{\\mathrm{s}} = 0.05$.\n- For vertical transmit, vertical receive ($\\mathrm{VV}$): $f_{\\mathrm{vol}} = 0.70$, $f_{\\mathrm{db}} = 0.10$, $f_{\\mathrm{s}} = 0.20$.\n\nHere, $f_{\\mathrm{vol}}$ denotes the vegetation volume fraction, $f_{\\mathrm{db}}$ the double-bounce (ground–trunk) fraction, and $f_{\\mathrm{s}}$ the surface (ground) fraction. The component-specific temporal coherences are governed by exponential decay with characteristic time constants representative of rainforest dynamics: $\\tau_{\\mathrm{vol}} = 1.5$ days, $\\tau_{\\mathrm{db}} = 7$ days, and $\\tau_{\\mathrm{s}} = 10$ days. Assume the total intensity is unchanged between the two dates for each polarization.\n\nStarting from the fundamental definition of complex interferometric coherence and basic scattering physics, derive an expression for the expected interferometric coherence magnitude for each polarization in terms of $\\Delta t$, $\\tau_{\\mathrm{vol}}$, $\\tau_{\\mathrm{db}}$, $\\tau_{\\mathrm{s}}$, and the fractional power contributions. Then compute the numerical values for $\\mathrm{HH}$, $\\mathrm{HV}$, and $\\mathrm{VV}$ and provide the final answer as a single row matrix in the order $\\mathrm{HH}$, $\\mathrm{HV}$, $\\mathrm{VV}$. Round each entry to three significant figures. The coherence is unitless. Your derivation and computation must also justify, based on scattering physics, which polarization is expected to have the highest coherence in a rainforest and why.",
            "solution": "The problem is subjected to validation and is deemed valid as it is scientifically grounded, well-posed, and objective. It provides a complete and consistent setup for a standard problem in radar remote sensing.\n\nThe solution proceeds by first deriving a general expression for the interferometric coherence magnitude under the given scattering model and then applying it to compute the specific numerical values for each polarization.\n\nThe fundamental definition of the complex interferometric coherence, $\\gamma$, between two complex synthetic aperture radar (SAR) images, $E_1$ and $E_2$, acquired at two different times is given by:\n$$\n\\gamma = \\frac{\\langle E_1 E_2^* \\rangle}{\\sqrt{\\langle |E_1|^2 \\rangle \\langle |E_2|^2 \\rangle}}\n$$\nwhere $\\langle \\cdot \\rangle$ denotes the spatial ensemble average over a processing window, and $E^*$ is the complex conjugate of $E$.\n\nThe problem states that the total backscattered complex field, $E$, for any given polarization is the sum of three mutually uncorrelated scattering components: volume ($E_{\\mathrm{vol}}$), double-bounce ($E_{\\mathrm{db}}$), and surface ($E_{\\mathrm{s}}$). Thus, for the two acquisitions, we have:\n$$\nE_1 = E_{\\mathrm{vol},1} + E_{\\mathrm{db},1} + E_{\\mathrm{s},1}\n$$\n$$\nE_2 = E_{\\mathrm{vol},2} + E_{\\mathrm{db},2} + E_{\\mathrm{s},2}\n$$\nThe property of mutual uncorrelation implies that the cross-correlation of different components is zero, i.e., $\\langle E_{i,m} E_{j,n}^* \\rangle = 0$ for $i \\neq j$, where $i, j \\in \\{\\mathrm{vol}, \\mathrm{db}, \\mathrm{s}\\}$ and $m, n \\in \\{1, 2\\}$.\n\nLet us expand the numerator of the coherence expression:\n$$\n\\langle E_1 E_2^* \\rangle = \\langle (E_{\\mathrm{vol},1} + E_{\\mathrm{db},1} + E_{\\mathrm{s},1}) (E_{\\mathrm{vol},2}^* + E_{\\mathrm{db},2}^* + E_{\\mathrm{s},2}^*) \\rangle\n$$\nDue to the uncorrelation of the components, all cross-terms vanish upon averaging. The expression simplifies to the sum of the autocorrelations of the individual components:\n$$\n\\langle E_1 E_2^* \\rangle = \\langle E_{\\mathrm{vol},1} E_{\\mathrm{vol},2}^* \\rangle + \\langle E_{\\mathrm{db},1} E_{\\mathrm{db},2}^* \\rangle + \\langle E_{\\mathrm{s},1} E_{\\mathrm{s},2}^* \\rangle\n$$\nNow, we analyze the denominator. It contains the total power (intensity) from each acquisition. The problem states that the total intensity is unchanged, so $\\langle |E_1|^2 \\rangle = \\langle |E_2|^2 \\rangle$. Let's denote the total power as $\\sigma^0_{\\mathrm{total}} = \\langle |E|^2 \\rangle$.\n$$\n\\sigma^0_{\\mathrm{total}} = \\langle |E_1|^2 \\rangle = \\langle |E_{\\mathrm{vol},1} + E_{\\mathrm{db},1} + E_{\\mathrm{s},1}|^2 \\rangle\n$$\nExpanding this and using the uncorrelation property again, we find that the total power is the sum of the powers of the individual components:\n$$\n\\sigma^0_{\\mathrm{total}} = \\langle |E_{\\mathrm{vol},1}|^2 \\rangle + \\langle |E_{\\mathrm{db},1}|^2 \\rangle + \\langle |E_{\\mathrm{s},1}|^2 \\rangle = \\sigma^0_{\\mathrm{vol}} + \\sigma^0_{\\mathrm{db}} + \\sigma^0_{\\mathrm{s}}\n$$\nwhere $\\sigma^0_i$ is the backscattered power of component $i$. The denominator of the coherence expression thus becomes $\\sqrt{(\\sigma^0_{\\mathrm{total}})^2} = \\sigma^0_{\\mathrm{total}}$.\n\nSubstituting these expanded forms for the numerator and denominator, we get:\n$$\n\\gamma = \\frac{\\langle E_{\\mathrm{vol},1} E_{\\mathrm{vol},2}^* \\rangle + \\langle E_{\\mathrm{db},1} E_{\\mathrm{db},2}^* \\rangle + \\langle E_{\\mathrm{s},1} E_{\\mathrm{s},2}^* \\rangle}{\\sigma^0_{\\mathrm{vol}} + \\sigma^0_{\\mathrm{db}} + \\sigma^0_{\\mathrm{s}}}\n$$\nThe complex coherence of an individual component $i$ is defined as $\\gamma_i = \\frac{\\langle E_{i,1} E_{i,2}^* \\rangle}{\\sqrt{\\langle |E_{i,1}|^2 \\rangle \\langle |E_{i,2}|^2 \\rangle}}$. Since the process is stationary, $\\langle |E_{i,1}|^2 \\rangle = \\langle |E_{i,2}|^2 \\rangle = \\sigma^0_i$. Therefore, we can write the interferometric cross-correlation for each component as $\\langle E_{i,1} E_{i,2}^* \\rangle = \\gamma_i \\sigma^0_i$. Substituting this into our expression for the total coherence $\\gamma$:\n$$\n\\gamma = \\frac{\\gamma_{\\mathrm{vol}}\\sigma^0_{\\mathrm{vol}} + \\gamma_{\\mathrm{db}}\\sigma^0_{\\mathrm{db}} + \\gamma_{\\mathrm{s}}\\sigma^0_{\\mathrm{s}}}{\\sigma^0_{\\mathrm{total}}}\n$$\nThe problem provides fractional power contributions, $f_i = \\sigma^0_i / \\sigma^0_{\\mathrm{total}}$. Using this definition, the total complex coherence becomes a weighted sum of the component complex coherences:\n$$\n\\gamma = f_{\\mathrm{vol}}\\gamma_{\\mathrm{vol}} + f_{\\mathrm{db}}\\gamma_{\\mathrm{db}} + f_{\\mathrm{s}}\\gamma_{\\mathrm{s}}\n$$\nEach component complex coherence $\\gamma_i$ includes effects of temporal decorrelation and a phase term related to the vertical location of the scatterer. However, the problem focuses on temporal decorrelation and provides no information to determine the phase differences between scattering components (which depend on forest height and baseline). A common and justified simplification in such models, when not explicitly solving for vertical structure, is to assume that the phase contributions are either negligible or aligned, allowing the total coherence *magnitude* to be approximated by the weighted sum of the component temporal coherence magnitudes. This is the model we will adopt.\n$$\n|\\gamma| \\approx f_{\\mathrm{vol}}|\\gamma_{\\mathrm{vol}}| + f_{\\mathrm{db}}|\\gamma_{\\mathrm{db}}| + f_{\\mathrm{s}}|\\gamma_{\\mathrm{s}}|\n$$\nThe problem states that temporal decorrelation for each component follows a stationary first-order process, which corresponds to an exponential decay model for the coherence magnitude, $|\\gamma_i|$. With negligible geometric, thermal, and atmospheric decorrelation, the coherence of each component is dominated by temporal decorrelation:\n$$\n|\\gamma_i| = \\exp\\left(-\\frac{\\Delta t}{\\tau_i}\\right)\n$$\nwhere $\\Delta t$ is the repeat-pass time interval and $\\tau_i$ is the characteristic decorrelation time constant for component $i$.\n\nThus, the final expression for the expected interferometric coherence magnitude is:\n$$\n|\\gamma| = f_{\\mathrm{vol}} \\exp\\left(-\\frac{\\Delta t}{\\tau_{\\mathrm{vol}}}\\right) + f_{\\mathrm{db}} \\exp\\left(-\\frac{\\Delta t}{\\tau_{\\mathrm{db}}}\\right) + f_{\\mathrm{s}} \\exp\\left(-\\frac{\\Delta t}{\\tau_{\\mathrm{s}}}\\right)\n$$\nWe now compute the numerical values using the given data: $\\Delta t = 3$ days, $\\tau_{\\mathrm{vol}} = 1.5$ days, $\\tau_{\\mathrm{db}} = 7$ days, and $\\tau_{\\mathrm{s}} = 10$ days.\n\nFirst, we calculate the component coherence magnitudes:\n$|\\gamma_{\\mathrm{vol}}| = \\exp\\left(-\\frac{3}{1.5}\\right) = \\exp(-2) \\approx 0.135335$\n$|\\gamma_{\\mathrm{db}}| = \\exp\\left(-\\frac{3}{7}\\right) \\approx 0.651430$\n$|\\gamma_{\\mathrm{s}}| = \\exp\\left(-\\frac{3}{10}\\right) = \\exp(-0.3) \\approx 0.740818$\n\nNext, we compute the total coherence magnitude for each polarization using its specific fractional power contributions.\n\nFor HH polarization ($f_{\\mathrm{vol}} = 0.50$, $f_{\\mathrm{db}} = 0.40$, $f_{\\mathrm{s}} = 0.10$):\n$|\\gamma_{\\mathrm{HH}}| = 0.50 \\times |\\gamma_{\\mathrm{vol}}| + 0.40 \\times |\\gamma_{\\mathrm{db}}| + 0.10 \\times |\\gamma_{\\mathrm{s}}|$\n$|\\gamma_{\\mathrm{HH}}| \\approx 0.50(0.135335) + 0.40(0.651430) + 0.10(0.740818)$\n$|\\gamma_{\\mathrm{HH}}| \\approx 0.067668 + 0.260572 + 0.074082 = 0.402322$\nRounded to three significant figures, $|\\gamma_{\\mathrm{HH}}| \\approx 0.402$.\n\nFor HV polarization ($f_{\\mathrm{vol}} = 0.90$, $f_{\\mathrm{db}} = 0.05$, $f_{\\mathrm{s}} = 0.05$):\n$|\\gamma_{\\mathrm{HV}}| = 0.90 \\times |\\gamma_{\\mathrm{vol}}| + 0.05 \\times |\\gamma_{\\mathrm{db}}| + 0.05 \\times |\\gamma_{\\mathrm{s}}|$\n$|\\gamma_{\\mathrm{HV}}| \\approx 0.90(0.135335) + 0.05(0.651430) + 0.05(0.740818)$\n$|\\gamma_{\\mathrm{HV}}| \\approx 0.121802 + 0.032572 + 0.037041 = 0.191415$\nRounded to three significant figures, $|\\gamma_{\\mathrm{HV}}| \\approx 0.191$.\n\nFor VV polarization ($f_{\\mathrm{vol}} = 0.70$, $f_{\\mathrm{db}} = 0.10$, $f_{\\mathrm{s}} = 0.20$):\n$|\\gamma_{\\mathrm{VV}}| = 0.70 \\times |\\gamma_{\\mathrm{vol}}| + 0.10 \\times |\\gamma_{\\mathrm{db}}| + 0.20 \\times |\\gamma_{\\mathrm{s}}|$\n$|\\gamma_{\\mathrm{VV}}| \\approx 0.70(0.135335) + 0.10(0.651430) + 0.20(0.740818)$\n$|\\gamma_{\\mathrm{VV}}| \\approx 0.094735 + 0.065143 + 0.148164 = 0.308042$\nRounded to three significant figures, $|\\gamma_{\\mathrm{VV}}| \\approx 0.308$.\n\nFinally, we justify which polarization has the highest coherence. The calculated values are $|\\gamma_{\\mathrm{HH}}| \\approx 0.402$, $|\\gamma_{\\mathrm{HV}}| \\approx 0.191$, and $|\\gamma_{\\mathrm{VV}}| \\approx 0.308$. The HH polarization yields the highest coherence.\n\nThis result is physically justified. The temporal coherence of the scattering components is ordered as follows, based on their time constants: $|\\gamma_{\\mathrm{vol}}|  |\\gamma_{\\mathrm{db}}|  |\\gamma_{\\mathrm{s}}|$. The volume component (canopy leaves and small branches) is the most dynamic and decorrelates fastest, while the surface and double-bounce components (involving the ground and tree trunks) are more stable. The total coherence is a weighted average of these component coherences.\n- The HV channel is dominated by volume scattering ($f_{\\mathrm{vol, HV}} = 0.90$), which is the least stable component, resulting in the lowest overall coherence. This is characteristic of cross-polarization in vegetated areas.\n- The VV channel has a large but smaller volume contribution ($f_{\\mathrm{vol, VV}} = 0.70$) and a more significant contribution from the stable surface component ($f_{\\mathrm{s, VV}} = 0.20$).\n- The HH channel has the smallest contribution from the unstable volume component ($f_{\\mathrm{vol, HH}} = 0.50$) and the largest contribution from the moderately stable double-bounce component ($f_{\\mathrm{db, HH}} = 0.40$).\nThe HH polarization's sensitivity to the relatively stable dihedral scattering from ground-trunk interactions, which is significant in forests, especially at L-band, allows it to maintain higher coherence compared to VV and HV. Therefore, the HH polarization is expected to have the highest coherence, a conclusion that is borne out by the calculation.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.402  0.191  0.308\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "InSAR analysis often involves a crucial trade-off between measurement precision and spatial resolution, especially in low-coherence areas like forests. This exercise places you in the role of a data processor who must use multilooking to reduce phase noise to a level suitable for a specific application. You will derive the statistical basis for this trade-off and determine an optimal processing strategy that balances competing scientific requirements. ",
            "id": "3822655",
            "problem": "An Interferometric Synthetic Aperture Radar (InSAR) pair at $C$-band observes a temperate forested region undergoing gentle ground deformation. The radar wavelength is $\\lambda = 0.056\\,\\mathrm{m}$. The single-look ground-projected resolutions are $R_0 = 5\\,\\mathrm{m}$ in range and $A_0 = 10\\,\\mathrm{m}$ in azimuth. The scene is statistically homogeneous at the scale of interest, and the complex backscatter from each pixel can be modeled as circular complex Gaussian speckle. The underlying interferometric coherence is approximately constant over the area, with $\\gamma = 0.7$.\n\nYou will create independent looks by averaging $L_r$ contiguous samples in ground range and $L_a$ contiguous samples in azimuth, forming a total look factor $L = L_r L_a$. Assume that multilooking is implemented by local spatial averaging (boxcar) and decimation such that the effective impulse response is convolved with a rectangular kernel in each dimension.\n\nStarting only from:\n- the linear systems principle that averaging over $L_r$ and $L_a$ samples broadens the effective impulse response by those factors in range and azimuth, respectively,\n- the circular complex Gaussian speckle model in which the sample cross-correlation of $L$ independent looks concentrates around the true complex coherence $\\rho = \\gamma e^{j\\phi}$ with fluctuations that diminish as $L$ increases,\n- and the interferometric phase-to-line-of-sight displacement relation $\\Delta \\phi = \\dfrac{4\\pi}{\\lambda}\\,\\Delta d$,\n\nperform the following:\n1. Derive how the effective ground resolution in range and azimuth scales with $L_r$ and $L_a$.\n2. Using small-noise linearization of the phase around the mean complex coherence, derive the leading-order dependence of interferometric phase variance on the number of looks $L$ and the coherence $\\gamma$.\n3. Translate a target line-of-sight displacement precision requirement of $\\sigma_d \\le 1.5\\,\\mathrm{mm}$ into a bound on the interferometric phase standard deviation $\\sigma_\\phi$, and determine the smallest integer $L$ that meets this bound for $\\gamma = 0.7$.\n4. The application requires mapping forest stand boundaries of characteristic size $s = 30\\,\\mathrm{m}$ without excessive anisotropy. Define “optimal” multilooking as the smallest total look number $L = L_r L_a$ that satisfies both the phase precision requirement and the resolution bound (i.e., both effective resolutions $\\le s$), and additionally enforces an aspect ratio constraint $A/R \\in [0.5, 2]$; if multiple $(L_r,L_a)$ achieve the same minimal $L$ under these constraints, choose the one with aspect ratio closest to $1$.\n\nWhich option corresponds to the optimal $(L_r, L_a)$ under these criteria?\n\nA. $L_r = 6$, $L_a = 1$\n\nB. $L_r = 3$, $L_a = 2$\n\nC. $L_r = 2$, $L_a = 3$\n\nD. $L_r = 4$, $L_a = 2$",
            "solution": "The problem statement has been critically validated and is deemed to be valid. It is scientifically grounded, well-posed, and objective, with all necessary data and clearly defined constraints for a unique solution.\n\nThe solution proceeds by following the four steps outlined in the problem statement.\n\n### Part 1: Effective Ground Resolution\nThe problem states that averaging over $L_r$ samples in range and $L_a$ samples in azimuth broadens the effective impulse response by those factors. Resolution is defined by the width of the impulse response. Therefore, the new multi-looked resolutions, $R$ and $A$, scale linearly with the number of looks in each dimension.\n\nGiven the single-look resolutions $R_0 = 5\\,\\mathrm{m}$ and $A_0 = 10\\,\\mathrm{m}$, the effective resolutions after multi-looking with factors $L_r$ and $L_a$ are:\n$$ R = L_r R_0 $$\n$$ A = L_a A_0 $$\n\n### Part 2: Interferometric Phase Variance\nThe problem requires deriving the leading-order dependence of the interferometric phase variance, $\\sigma_\\phi^2$, on the number of looks, $L$, and the coherence, $\\gamma$. The derivation is to be based on a small-noise linearization.\n\nThe interferometric phase, $\\hat{\\phi}$, is the argument of the sample complex coherence, $\\hat{\\rho}$. The true complex coherence is $\\rho = \\gamma e^{j\\phi_{true}}$. We can assume, without loss of generality, that the true phase is zero, so $\\rho = \\gamma$.\n\nThe sample coherence $\\hat{\\rho}$ is an estimate of $\\rho$ based on $L$ independent looks. For large $L$, the Central Limit Theorem implies that $\\hat{\\rho}$ is approximately normally distributed around $\\rho$. We can write $\\hat{\\rho} = \\rho + \\delta\\rho$, where $\\delta\\rho$ is a zero-mean complex noise term representing the estimation error. The estimated phase is $\\hat{\\phi} = \\arg(\\hat{\\rho}) = \\arg(\\gamma + \\delta\\rho)$.\n\nFor small noise (i.e., $|\\delta\\rho| \\ll \\gamma$), we can linearize the phase:\n$$ \\hat{\\phi} = \\arctan\\left(\\frac{\\mathrm{Im}(\\gamma + \\delta\\rho)}{\\mathrm{Re}(\\gamma + \\delta\\rho)}\\right) = \\arctan\\left(\\frac{\\mathrm{Im}(\\delta\\rho)}{\\gamma + \\mathrm{Re}(\\delta\\rho)}\\right) \\approx \\frac{\\mathrm{Im}(\\delta\\rho)}{\\gamma} $$\nThe variance of the phase estimate is therefore:\n$$ \\sigma_\\phi^2 = \\mathrm{Var}(\\hat{\\phi}) \\approx \\mathrm{Var}\\left(\\frac{\\mathrm{Im}(\\delta\\rho)}{\\gamma}\\right) = \\frac{1}{\\gamma^2}\\mathrm{Var}(\\mathrm{Im}(\\delta\\rho)) $$\nThe problem states that the complex backscatter is modeled as circular complex Gaussian speckle. For this model, the variance of the sample coherence estimator (the fluctuation term $\\delta\\rho$) is a standard result:\n$$ \\mathrm{Var}(\\delta\\rho) = E[|\\delta\\rho|^2] = \\frac{1 - \\gamma^2}{L} $$\nFor large $L$, the noise term $\\delta\\rho$ is approximately a circular complex Gaussian variable. For such a variable, its variance is equally distributed between its real and imaginary parts:\n$$ \\mathrm{Var}(\\mathrm{Im}(\\delta\\rho)) = \\frac{1}{2}\\mathrm{Var}(\\delta\\rho) = \\frac{1 - \\gamma^2}{2L} $$\nSubstituting this into the expression for the phase variance, we obtain the desired leading-order dependence:\n$$ \\sigma_\\phi^2 \\approx \\frac{1}{\\gamma^2} \\left( \\frac{1 - \\gamma^2}{2L} \\right) = \\frac{1 - \\gamma^2}{2L\\gamma^2} $$\n\n### Part 3: Minimum Number of Looks for Precision Requirement\nThe target line-of-sight (LOS) displacement precision is $\\sigma_d \\le 1.5\\,\\mathrm{mm} = 1.5 \\times 10^{-3}\\,\\mathrm{m}$. The relationship between LOS displacement $\\Delta d$ and interferometric phase $\\Delta \\phi$ is given as $\\Delta \\phi = \\frac{4\\pi}{\\lambda}\\,\\Delta d$. The standard deviations are related by the same factor:\n$$ \\sigma_\\phi = \\frac{4\\pi}{\\lambda}\\,\\sigma_d $$\nWith $\\lambda = 0.056\\,\\mathrm{m}$, the requirement on the phase standard deviation is:\n$$ \\sigma_\\phi \\le \\frac{4\\pi}{0.056\\,\\mathrm{m}} (1.5 \\times 10^{-3}\\,\\mathrm{m}) = \\frac{6\\pi \\times 10^{-3}}{0.056} = \\frac{3\\pi}{28}\\,\\text{rad} $$\nNumerically, $\\sigma_\\phi \\le \\frac{3\\pi}{28} \\approx 0.3366\\,\\mathrm{rad}$. The bound on the phase variance is $\\sigma_\\phi^2 \\le (\\frac{3\\pi}{28})^2 \\approx 0.1133$.\n\nWe use the phase variance formula from Part 2 to find the minimum number of looks $L$:\n$$ \\frac{1 - \\gamma^2}{2L\\gamma^2} \\le \\sigma_\\phi^2 $$\n$$ L \\ge \\frac{1 - \\gamma^2}{2\\gamma^2\\sigma_\\phi^2} $$\nSubstituting $\\gamma = 0.7$ and the derived bound for $\\sigma_\\phi^2$:\n$$ L \\ge \\frac{1 - (0.7)^2}{2(0.7)^2 \\left(\\frac{3\\pi}{28}\\right)^2} = \\frac{1 - 0.49}{2(0.49) \\left(\\frac{9\\pi^2}{784}\\right)} = \\frac{0.51}{0.98 \\left(\\frac{9\\pi^2}{784}\\right)} $$\n$$ L \\ge \\frac{0.51 \\times 784}{0.98 \\times 9\\pi^2} \\approx \\frac{399.84}{86.93} \\approx 4.599 $$\nSince $L$ must be an integer, the minimum total number of looks required to meet the precision requirement is $L_{min} = 5$.\n\n### Part 4: Optimal Multilooking Parameters\nWe need to find the integer pair $(L_r, L_a)$ that corresponds to the smallest total look number $L = L_r L_a$ while satisfying all constraints.\n\nThe constraints are:\n1.  **Precision**: $L = L_r L_a \\ge 5$.\n2.  **Resolution**: The effective resolutions must not exceed the characteristic size $s = 30\\,\\mathrm{m}$.\n    -   $R = L_r R_0 = 5 L_r \\le 30 \\implies L_r \\le 6$.\n    -   $A = L_a A_0 = 10 L_a \\le 30 \\implies L_a \\le 3$.\n3.  **Aspect Ratio**: The aspect ratio of the resolution cell, $A/R$, must be in the interval $[0.5, 2]$.\n    -   $\\frac{A}{R} = \\frac{10 L_a}{5 L_r} = 2 \\frac{L_a}{L_r}$.\n    -   $0.5 \\le 2 \\frac{L_a}{L_r} \\le 2 \\implies 0.25 \\le \\frac{L_a}{L_r} \\le 1$.\n\nWe search for the optimal pair $(L_r, L_a)$ by testing integer pairs starting from the minimal total look number, $L=5$.\n\n**Case $L=5$**:\nThe only integer factorization is $(L_r, L_a) = (5, 1)$ or $(1, 5)$ since $L_r, L_a$ must be positive integers.\n-   $(L_r, L_a) = (5, 1)$: $L_r=5 \\le 6$ (OK), $L_a=1 \\le 3$ (OK). Aspect ratio constraint: $L_a/L_r = 1/5 = 0.2$. This fails the condition $L_a/L_r \\ge 0.25$.\n-   $(L_r, L_a) = (1, 5)$: $L_a=5$ fails the condition $L_a \\le 3$.\nNo valid solution exists for $L=5$.\n\n**Case $L=6$**:\nInteger factorizations are $(1,6), (2,3), (3,2), (6,1)$.\n-   $(L_r, L_a) = (1, 6)$: $L_a=6$ fails $L_a \\le 3$.\n-   $(L_r, L_a) = (2, 3)$: $L_r=2 \\le 6$ (OK), $L_a=3 \\le 3$ (OK). Aspect ratio constraint: $L_a/L_r = 3/2 = 1.5$. This fails the condition $L_a/L_r \\le 1$.\n-   $(L_r, L_a) = (3, 2)$: $L_r=3 \\le 6$ (OK), $L_a=2 \\le 3$ (OK). Aspect ratio constraint: $L_a/L_r = 2/3$. Since $0.25 \\le 2/3 \\le 1$, this is valid.\nThis pair satisfies all constraints.\n-   $(L_r, L_a) = (6, 1)$: $L_r=6 \\le 6$ (OK), $L_a=1 \\le 3$ (OK). Aspect ratio constraint: $L_a/L_r = 1/6 \\approx 0.167$. This fails the condition $L_a/L_r \\ge 0.25$.\n\nThe smallest total look number $L$ for which a valid solution exists is $L=6$. The unique valid pair for this $L$ is $(L_r, L_a) = (3, 2)$. This is, by definition, the optimal choice. The tie-breaking rule (aspect ratio closest to $1$) is not needed.\n\n### Evaluation of Options\n\nLet's evaluate the given options against our derived optimal pair $(L_r, L_a) = (3, 2)$.\n\n**A. $L_r = 6$, $L_a = 1$**:\n This gives $L=6$. As checked above, it fails the aspect ratio constraint ($L_a/L_r = 1/6  0.25$). **Incorrect**.\n\n**B. $L_r = 3$, $L_a = 2$**:\n This is the optimal pair we derived. It gives $L=6$ and satisfies all constraints. **Correct**.\n\n**C. $L_r = 2$, $L_a = 3$**:\n This gives $L=6$. As checked above, it fails the aspect ratio constraint ($L_a/L_r = 1.5  1$). **Incorrect**.\n\n**D. $L_r = 4$, $L_a = 2$**:\n This pair gives a total look number $L = 4 \\times 2 = 8$. While this configuration is valid (it satisfies all constraints: $L=8 \\ge 5$; $L_r=4 \\le 6$; $L_a=2 \\le 3$; $L_a/L_r = 2/4 = 0.5$, which is in $[0.25, 1]$), it is not optimal. The definition of \"optimal\" requires the *smallest total look number*, which we found to be $L=6$. Since $8  6$, this option is suboptimal. **Incorrect**.\n\nThe unique optimal choice is $(L_r, L_a) = (3, 2)$.",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}