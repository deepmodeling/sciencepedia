{
    "hands_on_practices": [
        {
            "introduction": "在构建贝叶斯融合框架时，我们常常面临模型中方差分量等超参数未知的问题。经验贝叶斯（或称II型最大似然法）为此提供了一种实用的解决方案，它通过最大化边缘似然函数，直接从数据中估计这些超参数。这个练习将指导你推导一个线性高斯模型中的边缘似然，并利用它来估计过程模型振幅和观测误差方差。",
            "id": "3798344",
            "problem": "一个基于卫星的遥感系统测量两个位置的近地表气温异常，该过程在一个贝叶斯数据融合框架内建模，此框架将一个基于过程的陆地表面模型与带噪声的观测数据相结合。令 $x \\in \\mathbb{R}^{n}$ 表示潜在模型状态（以开尔文为单位的温度异常），令 $y \\in \\mathbb{R}^{m}$ 表示卫星观测值（也以开尔文为单位）。假设线性高斯数据融合模型为\n$$\ny = H x + \\varepsilon,\n$$\n其中 $H \\in \\mathbb{R}^{m \\times n}$ 是一个已知的线性观测算子，$x \\sim \\mathcal{N}(0, \\sigma^{2} K)$，其中 $K \\in \\mathbb{R}^{n \\times n}$ 是已知的半正定矩阵，$\\sigma^{2} > 0$ 是未知的标量振幅，并且 $\\varepsilon \\sim \\mathcal{N}(0, R)$，其中 $R \\in \\mathbb{R}^{m \\times m}$ 是未知的正定观测误差协方差矩阵。超参数为 $\\theta = \\{\\sigma^{2}, R\\}$。\n\n1) 从多元正态分布的定义和对联合高斯向量进行边缘化的规则出发，推导边际似然 $p(y \\mid \\theta)$，并用协方差 $S(\\theta)$ 表示。\n\n2) 写出对数边际似然，并推导其关于 $\\sigma^{2}$ 和 $R$ 的梯度（使用矩阵微积分），从而说明如何通过最大化边际似然来获得经验贝叶斯估计 $\\hat{\\theta}$。\n\n3) 考虑一个科学上现实的特殊情况，即两个位置（$m = n = 2$），观测算子为单位矩阵 $H = I_{2}$，对角结构 $K = \\operatorname{diag}(k_{1}, k_{2})$，其中 $k_{1} = 0.5$ 和 $k_{2} = 2.5$（无量纲的结构权重），以及同方差的观测误差协方差 $R = \\rho I_{2}$，其中 $\\rho > 0$ 未知（单位为 $\\mathrm{K}^{2}$）。观测到的异常值为 $y = (0.8, 1.4)^{\\top}$（单位为开尔文）。使用你在第（1）-（2）部分得到的结果，求出此情况下的经验贝叶斯估计 $\\hat{\\sigma}^{2}$ 和 $\\hat{\\rho}$。将你的数值估计四舍五入到三位有效数字。将最终方差以 $\\mathrm{K}^{2}$ 为单位表示。",
            "solution": "所述问题具有科学依据、适定、客观且内部一致。它描述了经验贝叶斯（也称为II型最大似然）在线性高斯模型中的一个标准应用，这是遥感和环境科学领域中数据同化和融合框架的一项常见任务。所有必要的数据和定义都已提供，以得到一个唯一且有意义的解。因此，该问题被认为是有效的，可以构建一个完整的解答。\n\n### 第1部分：边际似然的推导\n\n问题定义了一个分层模型。潜在状态 $x \\in \\mathbb{R}^{n}$ 的先验分布由下式给出：\n$$\np(x \\mid \\sigma^{2}) = \\mathcal{N}(x \\mid 0, \\sigma^{2}K)\n$$\n观测值 $y \\in \\mathbb{R}^{m}$ 通过似然与潜在状态 $x$ 相关联：\n$$\np(y \\mid x, R) = \\mathcal{N}(y \\mid Hx, R)\n$$\n其中模型为 $y = Hx + \\varepsilon$，观测误差 $\\varepsilon$ 服从分布 $\\varepsilon \\sim \\mathcal{N}(0, R)$。超参数集合为 $\\theta = \\{\\sigma^{2}, R\\}$。\n\n边际似然 $p(y \\mid \\theta)$ 是通过对潜在状态 $x$ 的所有可能值积分联合分布 $p(y, x \\mid \\theta)$ 得到的：\n$$\np(y \\mid \\theta) = \\int p(y, x \\mid \\theta) \\, dx\n$$\n使用概率的链式法则，联合分布为 $p(y, x \\mid \\theta) = p(y \\mid x, \\theta) p(x \\mid \\theta)$。由于 $y$ 和 $x$ 的分布仅依赖于 $\\theta$ 的特定部分，因此这可以写为 $p(y \\mid x, R) p(x \\mid \\sigma^{2})$。\n$$\np(y \\mid \\theta) = \\int p(y \\mid x, R) p(x \\mid \\sigma^{2}) \\, dx\n$$\n对于线性高斯模型，一种替代且更直接的方法是利用高斯随机向量线性变换的性质。观测值 $y$ 是两个独立高斯随机向量 $x$ 和 $\\varepsilon$ 的线性函数。\n\n首先，我们求项 $Hx$ 的分布。由于 $x \\sim \\mathcal{N}(0, \\sigma^{2}K)$，线性变换 $Hx$ 也是高斯分布的。其均值为：\n$$\n\\mathbb{E}[Hx] = H \\mathbb{E}[x] = H \\cdot 0 = 0\n$$\n其协方差为：\n$$\n\\text{Cov}(Hx) = H \\text{Cov}(x) H^{\\top} = H (\\sigma^{2}K) H^{\\top} = \\sigma^{2}HKH^{\\top}\n$$\n所以，$Hx \\sim \\mathcal{N}(0, \\sigma^{2}HKH^{\\top})$。\n\n现在，由于 $y = Hx + \\varepsilon$，并且 $x$ 和 $\\varepsilon$ 是独立的，所以 $Hx$ 和 $\\varepsilon$ 也是独立的。$y$ 的分布是高斯分布。其均值是均值之和：\n$$\n\\mathbb{E}[y \\mid \\theta] = \\mathbb{E}[Hx] + \\mathbb{E}[\\varepsilon] = 0 + 0 = 0\n$$\n其协方差是协方差之和：\n$$\n\\text{Cov}(y \\mid \\theta) = \\text{Cov}(Hx) + \\text{Cov}(\\varepsilon) = \\sigma^{2}HKH^{\\top} + R\n$$\n我们定义边际协方差矩阵为 $S(\\theta) = \\sigma^{2}HKH^{\\top} + R$。\n因此，给定超参数 $\\theta$ 的 $y$ 的边际分布是一个均值为零、协方差为 $S(\\theta)$ 的多元正态分布：\n$$\np(y \\mid \\theta) \\sim \\mathcal{N}(y \\mid 0, S(\\theta))\n$$\n其概率密度函数，即边际似然，由下式给出：\n$$\np(y \\mid \\theta) = \\frac{1}{(2\\pi)^{m/2} |S(\\theta)|^{1/2}} \\exp\\left(-\\frac{1}{2} y^{\\top} S(\\theta)^{-1} y\\right)\n$$\n\n### 第2部分：对数边际似然和梯度\n\n对数边际似然，记为 $L(\\theta)$，是 $p(y \\mid \\theta)$ 的自然对数：\n$$\nL(\\theta) = \\ln p(y \\mid \\theta) = -\\frac{m}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|S(\\theta)| - \\frac{1}{2}y^{\\top}S(\\theta)^{-1}y\n$$\n其中 $S(\\theta) = \\sigma^{2}HKH^{\\top} + R$。经验贝叶斯估计 $\\hat{\\theta}$ 是通过最大化 $L(\\theta)$ 来找到的，这涉及到将其关于超参数的梯度设为零。\n\n**关于 $\\sigma^{2}$ 的梯度：**\n我们计算 $L(\\theta)$ 关于标量超参数 $\\sigma^{2}$ 的导数。第一项是常数。我们使用两个标准的矩阵微积分恒等式：$\\frac{\\partial}{\\partial \\alpha}\\ln|A| = \\text{Tr}\\left(A^{-1}\\frac{\\partial A}{\\partial \\alpha}\\right)$ 和 $\\frac{\\partial}{\\partial \\alpha} z^{\\top}A^{-1}z = -z^{\\top}A^{-1}\\frac{\\partial A}{\\partial \\alpha}A^{-1}z$。\n$S(\\theta)$ 关于 $\\sigma^{2}$ 的导数是：\n$$\n\\frac{\\partial S(\\theta)}{\\partial \\sigma^{2}} = HKH^{\\top}\n$$\n对数行列式项的导数是：\n$$\n\\frac{\\partial}{\\partial \\sigma^{2}} \\ln|S(\\theta)| = \\text{Tr}\\left(S(\\theta)^{-1} \\frac{\\partial S(\\theta)}{\\partial \\sigma^{2}}\\right) = \\text{Tr}\\left(S(\\theta)^{-1}HKH^{\\top}\\right)\n$$\n二次型项的导数是：\n$$\n\\frac{\\partial}{\\partial \\sigma^{2}} y^{\\top}S(\\theta)^{-1}y = -y^{\\top}S(\\theta)^{-1}\\left(\\frac{\\partial S(\\theta)}{\\partial \\sigma^{2}}\\right)S(\\theta)^{-1}y = -y^{\\top}S(\\theta)^{-1}HKH^{\\top}S(\\theta)^{-1}y\n$$\n结合这些，对数边际似然关于 $\\sigma^{2}$ 的梯度是：\n$$\n\\frac{\\partial L(\\theta)}{\\partial \\sigma^{2}} = -\\frac{1}{2}\\text{Tr}\\left(S(\\theta)^{-1}HKH^{\\top}\\right) - \\frac{1}{2}\\left(-y^{\\top}S(\\theta)^{-1}HKH^{\\top}S(\\theta)^{-1}y\\right)\n$$\n$$\n\\frac{\\partial L(\\theta)}{\\partial \\sigma^{2}} = \\frac{1}{2}\\left(y^{\\top}S(\\theta)^{-1}HKH^{\\top}S(\\theta)^{-1}y - \\text{Tr}\\left(S(\\theta)^{-1}HKH^{\\top}\\right)\\right)\n$$\n将此梯度设为零，得到求解最优超参数所需的方程之一。\n\n**关于 $R$ 的梯度：**\n我们计算 $L(\\theta)$ 关于矩阵超参数 $R$ 的矩阵导数。我们使用恒等式：$\\frac{\\partial}{\\partial A}\\ln|A| = (A^{-1})^{\\top}$ 和 $\\frac{\\partial}{\\partial A} z^{\\top}A^{-1}z = -(A^{-1}zz^{\\top}A^{-1})^{\\top}$。由于 $S(\\theta)$ 是对称的，其逆矩阵也是对称的。\n$S(\\theta)$ 关于 $R$ 的导数是适当维度的单位矩阵，$\\frac{\\partial S(\\theta)}{\\partial R} = I$。\n对数行列式项的导数是：\n$$\n\\frac{\\partial}{\\partial R} \\ln|S(\\theta)| = (S(\\theta)^{-1})^{\\top} = S(\\theta)^{-1}\n$$\n二次型项的导数是：\n$$\n\\frac{\\partial}{\\partial R} y^{\\top}S(\\theta)^{-1}y = -(S(\\theta)^{-1}yy^{\\top}S(\\theta)^{-1})^{\\top} = -S(\\theta)^{-1}yy^{\\top}S(\\theta)^{-1}\n$$\n结合这些，对数边际似然关于 $R$ 的梯度是：\n$$\n\\frac{\\partial L(\\theta)}{\\partial R} = -\\frac{1}{2}S(\\theta)^{-1} - \\frac{1}{2}\\left(-S(\\theta)^{-1}yy^{\\top}S(\\theta)^{-1}\\right)\n$$\n$$\n\\frac{\\partial L(\\theta)}{\\partial R} = \\frac{1}{2}\\left(S(\\theta)^{-1}yy^{\\top}S(\\theta)^{-1} - S(\\theta)^{-1}\\right)\n$$\n将此梯度设为零得到 $S(\\theta)^{-1}yy^{\\top}S(\\theta)^{-1} = S(\\theta)^{-1}$。两边分别前乘和后乘 $S(\\theta)$ 得到 $yy^{\\top} = S(\\theta)$。\n经验贝叶斯估计 $\\hat{\\theta} = \\{\\hat{\\sigma}^{2}, \\hat{R}\\}$ 是通过联立求解将这些梯度设为零所产生的方程组得到的。\n\n### 第3部分：特殊情况与数值估计\n\n对于这个特殊情况，我们有：\n- $m = n = 2$\n- $H = I_{2}$（$2 \\times 2$ 单位矩阵）\n- $K = \\text{diag}(k_{1}, k_{2}) = \\text{diag}(0.5, 2.5)$\n- $R = \\rho I_{2}$，其中 $\\rho > 0$ 是未知标量\n- $y = (0.8, 1.4)^{\\top}$\n\n边际协方差 $S$ 简化为：\n$$\nS(\\theta) = \\sigma^{2}I_{2} K I_{2}^{\\top} + \\rho I_{2} = \\sigma^{2}K + \\rho I_{2}\n$$\n由于 $K$ 和 $I_{2}$ 都是对角矩阵，所以 $S$ 也是对角矩阵：\n$$\nS = \\sigma^{2}\\begin{pmatrix} 0.5 & 0 \\\\ 0 & 2.5 \\end{pmatrix} + \\rho\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0.5\\sigma^2 + \\rho & 0 \\\\ 0 & 2.5\\sigma^2 + \\rho \\end{pmatrix}\n$$\n令 $s_{1} = 0.5\\sigma^2 + \\rho$ 和 $s_{2} = 2.5\\sigma^2 + \\rho$。所以，$S = \\text{diag}(s_{1}, s_{2})$。\n对数边际似然变为：\n$$\nL(\\sigma^{2}, \\rho) = -\\ln(2\\pi) - \\frac{1}{2}(\\ln(s_{1}) + \\ln(s_{2})) - \\frac{1}{2}\\left(\\frac{y_{1}^{2}}{s_{1}} + \\frac{y_{2}^{2}}{s_{2}}\\right)\n$$\n我们需要求出关于 $\\sigma^{2}$ 和 $\\rho$ 的梯度，并令它们为零。\n\n关于 $\\rho$ 的导数：\n$$\n\\frac{\\partial L}{\\partial \\rho} = -\\frac{1}{2}\\left(\\frac{1}{s_{1}}\\frac{\\partial s_{1}}{\\partial \\rho} + \\frac{1}{s_{2}}\\frac{\\partial s_{2}}{\\partial \\rho}\\right) - \\frac{1}{2}\\left(-\\frac{y_{1}^{2}}{s_{1}^{2}}\\frac{\\partial s_{1}}{\\partial \\rho} - \\frac{y_{2}^{2}}{s_{2}^{2}}\\frac{\\partial s_{2}}{\\partial \\rho}\\right)\n$$\n由于 $\\frac{\\partial s_{1}}{\\partial \\rho} = 1$ 且 $\\frac{\\partial s_{2}}{\\partial \\rho} = 1$，令 $\\frac{\\partial L}{\\partial \\rho} = 0$ 可得：\n$$\n\\left(\\frac{y_{1}^{2}}{s_{1}^{2}} - \\frac{1}{s_{1}}\\right) + \\left(\\frac{y_{2}^{2}}{s_{2}^{2}} - \\frac{1}{s_{2}}\\right) = 0\n$$\n\n关于 $\\sigma^{2}$ 的导数：\n$$\n\\frac{\\partial L}{\\partial \\sigma^{2}} = -\\frac{1}{2}\\left(\\frac{1}{s_{1}}\\frac{\\partial s_{1}}{\\partial \\sigma^{2}} + \\frac{1}{s_{2}}\\frac{\\partial s_{2}}{\\partial \\sigma^{2}}\\right) - \\frac{1}{2}\\left(-\\frac{y_{1}^{2}}{s_{1}^{2}}\\frac{\\partial s_{1}}{\\partial \\sigma^{2}} - \\frac{y_{2}^{2}}{s_{2}^{2}}\\frac{\\partial s_{2}}{\\partial \\sigma^{2}}\\right)\n$$\n使用 $\\frac{\\partial s_{1}}{\\partial \\sigma^{2}} = k_{1} = 0.5$ 和 $\\frac{\\partial s_{2}}{\\partial \\sigma^{2}} = k_{2} = 2.5$，令 $\\frac{\\partial L}{\\partial \\sigma^{2}} = 0$ 可得：\n$$\nk_{1}\\left(\\frac{y_{1}^{2}}{s_{1}^{2}} - \\frac{1}{s_{1}}\\right) + k_{2}\\left(\\frac{y_{2}^{2}}{s_{2}^{2}} - \\frac{1}{s_{2}}\\right) = 0\n$$\n\n令 $z_{i} = \\frac{y_{i}^{2}}{s_{i}^{2}} - \\frac{1}{s_{i}}$，其中 $i=1,2$。方程组为：\n$$\n\\begin{cases} z_{1} + z_{2} = 0 \\\\ k_{1}z_{1} + k_{2}z_{2} = 0 \\end{cases} \\implies \\begin{pmatrix} 1 & 1 \\\\ k_{1} & k_{2} \\end{pmatrix} \\begin{pmatrix} z_{1} \\\\ z_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n系数矩阵的行列式为 $k_{2} - k_{1} = 2.5 - 0.5 = 2.0 \\neq 0$。由于该矩阵是可逆的，这个齐次线性系统的唯一解是零解，即 $z_{1} = 0$ 和 $z_{2} = 0$。\n\n对于 $z_{1} = 0$：\n$$\n\\frac{y_{1}^{2}}{s_{1}^{2}} - \\frac{1}{s_{1}} = 0 \\implies \\frac{1}{s_{1}}\\left(\\frac{y_{1}^{2}}{s_{1}} - 1\\right) = 0\n$$\n由于 $s_{1}$ 必须为正（它是一个方差），这意味着 $\\frac{y_{1}^{2}}{s_{1}} = 1$，即 $s_{1} = y_{1}^{2}$。\n\n对于 $z_{2} = 0$：\n$$\n\\frac{y_{2}^{2}}{s_{2}^{2}} - \\frac{1}{s_{2}} = 0 \\implies s_{2} = y_{2}^{2}\n$$\n所以对于经验贝叶斯估计，我们有条件 $s_{1} = y_{1}^{2}$ 和 $s_{2} = y_{2}^{2}$。代入 $s_{1}$ 和 $s_{2}$ 的定义：\n$$\n0.5\\hat{\\sigma}^2 + \\hat{\\rho} = y_{1}^{2}\n$$\n$$\n2.5\\hat{\\sigma}^2 + \\hat{\\rho} = y_{2}^{2}\n$$\n给定 $y = (0.8, 1.4)^{\\top}$，所以 $y_{1}^{2} = 0.8^{2} = 0.64$ 且 $y_{2}^{2} = 1.4^{2} = 1.96$。\n我们求解关于 $\\hat{\\sigma}^{2}$ 和 $\\hat{\\rho}$ 的线性方程组：\n$$\n0.5\\hat{\\sigma}^2 + \\hat{\\rho} = 0.64 \\quad (1)\n$$\n$$\n2.5\\hat{\\sigma}^2 + \\hat{\\rho} = 1.96 \\quad (2)\n$$\n方程（2）减去方程（1）：\n$$\n(2.5 - 0.5)\\hat{\\sigma}^2 = 1.96 - 0.64\n$$\n$$\n2.0\\hat{\\sigma}^2 = 1.32\n$$\n$$\n\\hat{\\sigma}^2 = \\frac{1.32}{2.0} = 0.66\n$$\n将此值代回方程（1）：\n$$\n0.5(0.66) + \\hat{\\rho} = 0.64\n$$\n$$\n0.33 + \\hat{\\rho} = 0.64\n$$\n$$\n\\hat{\\rho} = 0.64 - 0.33 = 0.31\n$$\n经验贝叶斯估计为 $\\hat{\\sigma}^2 = 0.66 \\, \\text{K}^2$ 和 $\\hat{\\rho} = 0.31 \\, \\text{K}^2$。两个值都为正，与模型约束一致。四舍五入到三位有效数字，得到：\n$\\hat{\\sigma}^2 = 0.660 \\, \\text{K}^2$\n$\\hat{\\rho} = 0.310 \\, \\text{K}^2$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.660 & 0.310 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "选择正确的模型结构是数据融合中的关键一步，尤其是在处理遥感数据中常见的异常值时。本练习将介绍如何使用贝叶斯因子来比较两种不同的噪声模型：标准的高斯模型和更具鲁棒性的学生t分布模型。通过计算贝叶斯因子，你将学习如何量化证据，以支持能够更好地解释异常数据的模型。",
            "id": "3798379",
            "problem": "一个多光谱地球观测（EO）传感器正在贝叶斯数据融合框架内进行校准，以将其大气层顶反射率与一个融合参考模型进行协调。设融合模型提供反射率预测值，并假设在$N=7$个并置点上单个波段的残差（观测值减去预测值），以反射率单位表示，为\n$$\nr_{1}=0.021,\\quad r_{2}=-0.034,\\quad r_{3}=0.018,\\quad r_{4}=0.027,\\quad r_{5}=-0.015,\\quad r_{6}=0.031,\\quad r_{7}=0.420.\n$$\n您需要比较这两个残差的两种噪声模型：\n\n- 模型 $\\mathcal{M}_{G}$（高斯模型）：残差是独立同分布（i.i.d.）的高斯分布，均值为零，已知标准差为 $\\sigma=0.05$。\n- 模型 $\\mathcal{M}_{T}$（学生t分布模型）：残差是独立同分布的学生t分布，均值为零，已知自由度为 $\\nu=3$，已知尺度参数为 $s=0.05$。\n\n比较必须通过贝叶斯因子（BF）进行，其定义为边际似然的比值 $BF=\\frac{p(\\mathbf{r}\\mid \\mathcal{M}_{T})}{p(\\mathbf{r}\\mid \\mathcal{M}_{G})}$，其中 $\\mathbf{r}=(r_{1},\\dots,r_{7})$。为了从第一性原理构建 $p(\\mathbf{r}\\mid \\mathcal{M}_{T})$，请使用学生t分布的有效分层表示，即作为具有适当混合分布的高斯尺度混合，并明确地对潜在的讨厌参数进行积分。然后，使用得到的 $p(\\mathbf{r}\\mid \\mathcal{M}_{T})$ 和 $p(\\mathbf{r}\\mid \\mathcal{M}_{G})$ 的闭合形式密度，计算所提供数据的贝叶斯因子。\n\n在遥感校准中存在异常值倾向的残差背景下，解释计算出的贝叶斯因子的含义。贝叶斯因子是无量纲的；请以纯数字形式报告。将最终数值答案四舍五入到三位有效数字。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它具有科学依据，提法明确，客观，并包含推导唯一且有意义解所需的所有必要信息。\n\n目标是计算贝叶斯因子（BF），用于比较给定残差集 $\\mathbf{r}=(r_{1},\\dots,r_{7})$ 的学生t噪声模型（$\\mathcal{M}_{T}$）和高斯噪声模型（$\\mathcal{M}_{G}$）。贝叶斯因子定义为它们的边际似然之比：\n$$\nBF=\\frac{p(\\mathbf{r}\\mid \\mathcal{M}_{T})}{p(\\mathbf{r}\\mid \\mathcal{M}_{G})}\n$$\n提供的数据是 $N=7$ 个残差：$r_{1}=0.021$，$r_{2}=-0.034$，$r_{3}=0.018$，$r_{4}=0.027$，$r_{5}=-0.015$，$r_{6}=0.031$ 和 $r_{7}=0.420$。\n\n首先，我们为高斯模型 $\\mathcal{M}_{G}$ 构建边际似然。在此模型下，残差 $r_i$ 根据均值为 $0$、已知标准差为 $\\sigma=0.05$ 的高斯分布独立同分布（i.i.d.）。单个残差 $r_i$ 的概率密度函数（PDF）为：\n$$\np(r_i \\mid \\mathcal{M}_G) = \\mathcal{N}(r_i \\mid 0, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{r_i^2}{2\\sigma^2}\\right)\n$$\n由于残差是独立同分布的，向量 $\\mathbf{r}$ 的联合似然是各个似然的乘积：\n$$\np(\\mathbf{r} \\mid \\mathcal{M}_G) = \\prod_{i=1}^{N} p(r_i \\mid \\mathcal{M}_G) = \\left(\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\right)^N \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} r_i^2\\right)\n$$\n这个表达式是边际似然，因为所有参数（$\\sigma$）都是已知的。\n\n接下来，我们为学生t模型 $\\mathcal{M}_{T}$ 构建边际似然。问题要求从学生t分布作为高斯尺度混合的分层表示中推导出此似然。如果一个随机变量 $r_i$ 是按以下方式分层生成的，它就服从位置为 $0$、自由度为 $\\nu$、尺度为 $s$ 的学生t分布：\n1. 从伽马分布中抽取一个潜在的精度缩放变量 $\\lambda_i$：$\\lambda_i \\sim \\text{Gamma}(\\frac{\\nu}{2}, \\frac{\\nu}{2})$。\n2. 从方差被 $\\lambda_i$ 缩放的高斯分布中抽取残差 $r_i$：$r_i \\mid \\lambda_i \\sim \\mathcal{N}(0, \\frac{s^2}{\\lambda_i})$。\n\n伽马分布的PDF是 $p(\\lambda_i) = \\frac{(\\nu/2)^{\\nu/2}}{\\Gamma(\\nu/2)} \\lambda_i^{\\nu/2 - 1} \\exp(-\\frac{\\nu}{2}\\lambda_i)$。$r_i$ 的条件PDF是 $p(r_i \\mid \\lambda_i) = \\sqrt{\\frac{\\lambda_i}{2\\pi s^2}} \\exp(-\\frac{\\lambda_i r_i^2}{2s^2})$。\n\n为了求得单个残差的边际似然 $p(r_i \\mid \\mathcal{M}_T)$，我们对潜在变量 $\\lambda_i$ 进行积分：\n$$\np(r_i \\mid \\mathcal{M}_T) = \\int_{0}^{\\infty} p(r_i \\mid \\lambda_i) p(\\lambda_i) d\\lambda_i\n$$\n$$\np(r_i \\mid \\mathcal{M}_T) = \\int_{0}^{\\infty} \\left(\\sqrt{\\frac{\\lambda_i}{2\\pi s^2}}\\right) \\exp\\left(-\\frac{\\lambda_i r_i^2}{2s^2}\\right) \\left(\\frac{(\\nu/2)^{\\nu/2}}{\\Gamma(\\nu/2)} \\lambda_i^{\\nu/2 - 1} \\exp\\left(-\\frac{\\nu}{2}\\lambda_i\\right)\\right) d\\lambda_i\n$$\n$$\np(r_i \\mid \\mathcal{M}_T) = \\frac{(\\nu/2)^{\\nu/2}}{\\Gamma(\\nu/2)\\sqrt{2\\pi s^2}} \\int_{0}^{\\infty} \\lambda_i^{(\\frac{\\nu+1}{2}) - 1} \\exp\\left(-\\lambda_i \\left(\\frac{r_i^2}{2s^2} + \\frac{\\nu}{2}\\right)\\right) d\\lambda_i\n$$\n该积分是伽马分布的核。回顾 $\\int_0^\\infty x^{\\alpha-1} e^{-\\beta x} dx = \\frac{\\Gamma(\\alpha)}{\\beta^\\alpha}$，我们可以用 $\\alpha = (\\nu+1)/2$ 和 $\\beta = (r_i^2/(2s^2) + \\nu/2)$ 来解这个积分。\n$$\np(r_i \\mid \\mathcal{M}_T) = \\frac{(\\nu/2)^{\\nu/2}}{\\Gamma(\\nu/2)\\sqrt{2\\pi s^2}} \\frac{\\Gamma((\\nu+1)/2)}{\\left(\\frac{r_i^2}{2s^2} + \\frac{\\nu}{2}\\right)^{(\\nu+1)/2}}\n$$\n化简此表达式可得到学生t分布的PDF：\n$$\np(r_i \\mid \\mathcal{M}_T) = \\frac{\\Gamma((\\nu+1)/2)}{\\Gamma(\\nu/2) \\sqrt{\\nu\\pi} s} \\left(1 + \\frac{1}{\\nu}\\left(\\frac{r_i}{s}\\right)^2\\right)^{-(\\nu+1)/2}\n$$\n在模型 $\\mathcal{M}_T$ 下，残差也是独立同分布的。因此，联合边际似然是各个密度的乘积：\n$$\np(\\mathbf{r} \\mid \\mathcal{M}_T) = \\prod_{i=1}^{N} \\left[ \\frac{\\Gamma((\\nu+1)/2)}{\\Gamma(\\nu/2) \\sqrt{\\nu\\pi} s} \\left(1 + \\frac{r_i^2}{\\nu s^2}\\right)^{-(\\nu+1)/2} \\right]\n$$\n\n为了避免极小似然值导致的数值下溢，最好先计算对数似然。\n高斯模型的对数似然为：\n$$\n\\ln p(\\mathbf{r} \\mid \\mathcal{M}_G) = -\\frac{N}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}\\sum_{i=1}^{N} r_i^2\n$$\n学生t模型的对数似然为：\n$$\n\\ln p(\\mathbf{r} \\mid \\mathcal{M}_T) = N \\ln\\left(\\frac{\\Gamma((\\nu+1)/2)}{\\Gamma(\\nu/2) \\sqrt{\\nu\\pi} s}\\right) - \\frac{\\nu+1}{2}\\sum_{i=1}^{N}\\ln\\left(1 + \\frac{r_i^2}{\\nu s^2}\\right)\n$$\n贝叶斯因子的对数为 $\\ln(BF) = \\ln p(\\mathbf{r} \\mid \\mathcal{M}_T) - \\ln p(\\mathbf{r} \\mid \\mathcal{M}_G)$。\n\n现在，我们代入数值。\n对两个模型，$N=7$。\n残差平方和为：\n$\\sum_{i=1}^{7} r_i^2 = (0.021)^2 + (-0.034)^2 + (0.018)^2 + (0.027)^2 + (-0.015)^2 + (0.031)^2 + (0.420)^2$\n$\\sum_{i=1}^{7} r_i^2 = 0.000441 + 0.001156 + 0.000324 + 0.000729 + 0.000225 + 0.000961 + 0.1764 = 0.180236$。\n\n对于 $\\mathcal{M}_{G}$：$\\sigma=0.05$，所以 $\\sigma^2=0.0025$。\n$\\ln p(\\mathbf{r} \\mid \\mathcal{M}_G) = -\\frac{7}{2}\\ln(2\\pi \\times 0.0025) - \\frac{1}{2 \\times 0.0025} (0.180236)$\n$\\ln p(\\mathbf{r} \\mid \\mathcal{M}_G) = -3.5\\ln(0.015708) - 200 \\times 0.180236$\n$\\ln p(\\mathbf{r} \\mid \\mathcal{M}_G) \\approx -3.5 \\times (-4.15333) - 36.0472 \\approx 14.53666 - 36.0472 = -21.51054$。\n\n对于 $\\mathcal{M}_{T}$：$\\nu=3$，$s=0.05$。\n对数似然的常数部分是：\n$N \\ln\\left(\\frac{\\Gamma((3+1)/2)}{\\Gamma(3/2) \\sqrt{3\\pi} \\times 0.05}\\right) = 7 \\ln\\left(\\frac{\\Gamma(2)}{\\Gamma(1.5) \\sqrt{3\\pi} \\times 0.05}\\right)$\n使用 $\\Gamma(2)=1$ 和 $\\Gamma(1.5)=\\sqrt{\\pi}/2$：\n$7 \\ln\\left(\\frac{1}{(\\sqrt{\\pi}/2) \\sqrt{3\\pi} \\times 0.05}\\right) = 7 \\ln\\left(\\frac{2}{\\pi\\sqrt{3} \\times 0.05}\\right) = 7 \\ln\\left(\\frac{40}{\\pi\\sqrt{3}}\\right)$\n$7 \\ln(7.35104) \\approx 7 \\times 1.99484 \\approx 13.96388$。\n求和部分，其中 $\\nu s^2 = 3 \\times (0.05)^2 = 0.0075$：\n$-\\frac{3+1}{2} \\sum_{i=1}^{7}\\ln\\left(1 + \\frac{r_i^2}{0.0075}\\right) = -2 \\sum_{i=1}^{7}\\ln\\left(1 + \\frac{r_i^2}{0.0075}\\right)$\n和中的各项是：\n$\\ln(1+0.021^2/0.0075) \\approx 0.05713$\n$\\ln(1+(-0.034)^2/0.0075) \\approx 0.14336$\n$\\ln(1+0.018^2/0.0075) \\approx 0.04229$\n$\\ln(1+0.027^2/0.0075) \\approx 0.09276$\n$\\ln(1+(-0.015)^2/0.0075) \\approx 0.02956$\n$\\ln(1+0.031^2/0.0075) \\approx 0.12056$\n$\\ln(1+0.420^2/0.0075) = \\ln(1+23.52) \\approx 3.19946$\n和约为 $\\approx 3.68512$。\n所以，对数似然的这部分是 $-2 \\times 3.68512 = -7.37024$。\n$\\ln p(\\mathbf{r} \\mid \\mathcal{M}_T) \\approx 13.96388 - 7.37024 = 6.59364$。\n\n现在，我们计算对数贝叶斯因子：\n$\\ln(BF) = \\ln p(\\mathbf{r} \\mid \\mathcal{M}_T) - \\ln p(\\mathbf{r} \\mid \\mathcal{M}_G) \\approx 6.59364 - (-21.51054) = 28.10418$\n贝叶斯因子是：\n$BF = \\exp(28.10418) \\approx 1.5973 \\times 10^{12}$。\n四舍五入到三位有效数字，我们得到 $1.60 \\times 10^{12}$。\n\n贝叶斯因子的极大值表明，相比于高斯模型（$\\mathcal{M}_{G}$），学生t模型（$\\mathcal{M}_{T}$）具有压倒性的证据优势。这是数据中包含一个显著异常值 $r_{7}=0.420$ 的直接后果。其他残差都在均值（$0$）的一个标准差（$\\sigma=0.05$）范围内，但 $r_7$ 距离均值有 $0.420/0.05 = 8.4$ 个标准差。\n高斯分布具有指数衰减的尾部，这意味着它为这类极端事件分配了极低的概率。这单个异常值使得整个数据集在高斯模型下变得异常不可能，从而严重惩罚了其边际似然。\n相比之下，学生t分布具有更重的、多项式衰减的尾部。它是一种稳健的分布，可以通过为异常值分配一个虽小但并非天文数字般小的概率来容纳它们。在重尾的学生t模型下，异常值 $r_7$ 比在瘦尾的高斯模型下要合理得多。\n在遥感校准的背景下，这一结果凸显了稳健统计建模的重要性。来自地球观测传感器的数据经常受到未建模效应（例如，未检测到的云、气溶胶羽流、地表异常）的污染，这些效应在残差中表现为异常值。使用标准高斯噪声模型可能导致模型拟合不佳和校准参数有偏，因为模型会受到异常值的过度影响。对学生t模型的强烈偏好表明，采用稳健的重尾噪声模型能更忠实地描述数据，防止异常值扭曲校准结果，从而得出更可靠的科学结论。",
            "answer": "$$\n\\boxed{1.60 \\times 10^{12}}\n$$"
        },
        {
            "introduction": "现实世界的数据流往往是不完整的，这给动态数据融合带来了挑战。本练习探讨了在动态状态空间模型中如何优雅地处理缺失观测值的问题。你将从第一性原理出发，推导当部分观测数据缺失时正确的贝叶斯更新步骤，并理解这对不确定性传播的后续影响。",
            "id": "3798311",
            "problem": "考虑一个用于遥感土壤湿度估计的线性高斯贝叶斯数据融合框架。设时间 $t$ 的潜状态为 $\\mathbf{x}_{t} \\in \\mathbb{R}^{2}$，表示两个相邻位置的像素级体积含水量，$\\mathbf{x}_{t} = [\\theta_{A,t}, \\theta_{B,t}]^{\\top}$。假设一个以过去数据 $\\mathcal{D}_{t-1}$ 为条件的高斯先验，其形式为 $\\mathbf{x}_{t} \\mid \\mathcal{D}_{t-1} \\sim \\mathcal{N}(\\mathbf{m}_{t}^{-}, \\mathbf{P}_{t}^{-})$，协方差为\n$$\n\\mathbf{P}_{t}^{-} = \\begin{bmatrix}\np_{11} & p_{12} \\\\\np_{12} & p_{22}\n\\end{bmatrix},\n$$\n其中 $p_{11} > 0$，$p_{22} > 0$，且 $| \\mathbf{P}_{t}^{-} | > 0$。\n\n两个独立的遥感仪器提供状态的带噪声线性测量：\n- 土壤水分主被动遥感卫星 (SMAP)：一个粗分辨率的被动微波辐射计，其足迹混合权重为 $w_{A} = 0.6$ 和 $w_{B} = 0.4$，测量值为\n$$\ny_{1,t} = w_{A} \\theta_{A,t} + w_{B} \\theta_{B,t} + \\epsilon_{1,t},\n$$\n其中 $\\epsilon_{1,t} \\sim \\mathcal{N}(0, r_{1})$ 且 $r_{1} > 0$。\n- 合成孔径雷达 (SAR)：一个分辨率更高的后向散射衍生的土壤湿度代理，其线性灵敏度系数 $u_{A}$ 和 $u_{B}$ 已知，测量值为\n$$\ny_{2,t} = u_{A} \\theta_{A,t} + u_{B} \\theta_{B,t} + \\epsilon_{2,t},\n$$\n其中 $\\epsilon_{2,t} \\sim \\mathcal{N}(0, r_{2})$ 且 $r_{2} > 0$。\n\n假设 $\\epsilon_{1,t}$ 和 $\\epsilon_{2,t}$ 相互独立，且独立于 $\\mathbf{x}_{t}$。构建完整观测向量 $\\mathbf{y}_{t} = [y_{1,t}, y_{2,t}]^{\\top}$，其观测算子为\n$$\n\\mathbf{H} = \\begin{bmatrix}\nw_{A} & w_{B} \\\\\nu_{A} & u_{B}\n\\end{bmatrix}\n= \\begin{bmatrix}\n0.6 & 0.4 \\\\\nu_{A} & u_{B}\n\\end{bmatrix},\n$$\n且观测噪声协方差为\n$$\n\\mathbf{R} = \\begin{bmatrix}\nr_{1} & 0 \\\\\n0 & r_{2}\n\\end{bmatrix}.\n$$\n\n在时间 $t$，假设由于射频干扰，SAR 不可用，因此 $y_{2,t}$ 缺失。令选择矩阵\n$$\n\\mathbf{M}_{t} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}\n$$\n将完整观测 $\\mathbf{y}_{t}$ 映射到可用测量 $\\mathbf{y}_{t}^{(\\mathrm{obs})} = \\mathbf{M}_{t} \\mathbf{y}_{t} = y_{1,t}$，从而导出有效算子 $\\mathbf{H}^{(\\mathrm{obs})} = \\mathbf{M}_{t} \\mathbf{H}$ 和噪声协方差 $\\mathbf{R}^{(\\mathrm{obs})} = \\mathbf{M}_{t} \\mathbf{R} \\mathbf{M}_{t}^{\\top}$。\n\n仅从线性高斯建模假设和多元高斯条件化的贝叶斯法则出发，推导能通过 $\\mathbf{M}_{t}$ 正确处理缺失观测的后验协方差更新，然后特化此结果以计算在仅同化 $y_{1,t}$ 后第一个状态分量的后验方差 $P_{11,t}^{+}$。将你的最终答案表示为关于 $p_{11}$、$p_{12}$、$p_{22}$ 和 $r_{1}$ 的闭式解析表达式（其中数值 $w_{A} = 0.6$ 和 $w_{B} = 0.4$ 已代入）。无需四舍五入。\n\n最后，使用带有过程噪声 $\\boldsymbol{\\eta}_{t} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{Q})$ 的线性状态演化方程 $\\mathbf{x}_{t+1} = \\mathbf{F} \\mathbf{x}_{t} + \\boldsymbol{\\eta}_{t}$，解释在时间 $t$ 缺少 SAR 数据如何影响不确定性向 $\\mathbf{P}_{t+1}^{-}$ 的传播，并将你的解释与你所推导的后验协方差的结构联系起来。你的解释必须基于所述的建模假设和高斯条件化的性质，不得引用任何预先给出的滤波公式。",
            "solution": "问题设定在线性高斯框架内。我们从基本模型开始：\n- 时间 $t$ 的先验状态是高斯的，$\\mathbf{x}_{t} \\mid \\mathcal{D}_{t-1} \\sim \\mathcal{N}(\\mathbf{m}_{t}^{-}, \\mathbf{P}_{t}^{-})$，其中 $\\mathbf{P}_{t}^{-} \\succ \\mathbf{0}$。\n- 观测是状态的线性函数，并带有独立的高斯噪声，在时间 $t$ 只有 SMAP 测量值 $y_{1,t}$ 可用。\n\n在数据缺失情况下的有效观测为\n$$\n\\mathbf{y}_{t}^{(\\mathrm{obs})} = \\mathbf{M}_{t} \\mathbf{y}_{t} = \\mathbf{M}_{t} \\mathbf{H} \\mathbf{x}_{t} + \\mathbf{M}_{t} \\boldsymbol{\\epsilon}_{t},\n$$\n其中 $\\boldsymbol{\\epsilon}_{t} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R})$ 且 $\\mathbf{M}_{t} = [1\\ \\ 0]$。因此，\n$$\n\\mathbf{H}^{(\\mathrm{obs})} = \\mathbf{M}_{t} \\mathbf{H} = \\begin{bmatrix} 0.6 & 0.4 \\end{bmatrix}, \\quad \\mathbf{R}^{(\\mathrm{obs})} = \\mathbf{M}_{t} \\mathbf{R} \\mathbf{M}_{t}^{\\top} = \\begin{bmatrix} r_{1} \\end{bmatrix}.\n$$\n\n根据应用于联合高斯变量的贝叶斯法则，后验分布 $\\mathbf{x}_{t} \\mid \\mathbf{y}_{t}^{(\\mathrm{obs})}$ 仍然是高斯的。我们使用从 $(\\mathbf{x}_{t}, \\mathbf{y}_{t}^{(\\mathrm{obs})})$ 的联合分布推导出的多元高斯条件化公式，该公式可以通过写出 $\\mathbf{x}_{t}$ 和线性形式 $\\mathbf{H}^{(\\mathrm{obs})} \\mathbf{x}_{t} + \\boldsymbol{\\epsilon}_{t}^{(\\mathrm{obs})}$ 的联合协方差来建立，其中 $\\boldsymbol{\\epsilon}_{t}^{(\\mathrm{obs})} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R}^{(\\mathrm{obs})})$ 且独立于 $\\mathbf{x}_{t}$。\n\n具体来说，$\\mathbf{x}_{t}$ 和 $y_{1,t}$ 的联合分布是高斯分布，其均值为\n$$\n\\begin{bmatrix}\n\\mathbf{m}_{t}^{-} \\\\\n\\mathbf{H}^{(\\mathrm{obs})} \\mathbf{m}_{t}^{-}\n\\end{bmatrix}\n$$\n且分块协方差为\n$$\n\\begin{bmatrix}\n\\mathbf{P}_{t}^{-} & \\mathbf{P}_{t}^{-} (\\mathbf{H}^{(\\mathrm{obs})})^{\\top} \\\\\n\\mathbf{H}^{(\\mathrm{obs})} \\mathbf{P}_{t}^{-} & \\mathbf{H}^{(\\mathrm{obs})} \\mathbf{P}_{t}^{-} (\\mathbf{H}^{(\\mathrm{obs})})^{\\top} + \\mathbf{R}^{(\\mathrm{obs})}\n\\end{bmatrix}.\n$$\n根据标准高斯条件化恒等式，给定 $y_{1,t}$ 时 $\\mathbf{x}_{t}$ 的后验协方差为\n$$\n\\mathbf{P}_{t}^{+} = \\mathbf{P}_{t}^{-} - \\mathbf{P}_{t}^{-} (\\mathbf{H}^{(\\mathrm{obs})})^{\\top} \\left( \\mathbf{H}^{(\\mathrm{obs})} \\mathbf{P}_{t}^{-} (\\mathbf{H}^{(\\mathrm{obs})})^{\\top} + \\mathbf{R}^{(\\mathrm{obs})} \\right)^{-1} \\mathbf{H}^{(\\mathrm{obs})} \\mathbf{P}_{t}^{-}.\n$$\n\n对于我们的情况，记 $\\mathbf{h} = (\\mathbf{H}^{(\\mathrm{obs})})^{\\top} = [0.6, 0.4]^{\\top}$，这是一个 $2 \\times 1$ 的向量。那么\n$$\n\\mathbf{h}^{\\top} \\mathbf{P}_{t}^{-} \\mathbf{h} = (0.6)^{2} p_{11} + 2 (0.6)(0.4) p_{12} + (0.4)^{2} p_{22} = 0.36\\, p_{11} + 0.48\\, p_{12} + 0.16\\, p_{22},\n$$\n且\n$$\n\\mathbf{P}_{t}^{-} \\mathbf{h} = \n\\begin{bmatrix}\np_{11} & p_{12} \\\\\np_{12} & p_{22}\n\\end{bmatrix}\n\\begin{bmatrix}\n0.6 \\\\\n0.4\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0.6\\, p_{11} + 0.4\\, p_{12} \\\\\n0.6\\, p_{12} + 0.4\\, p_{22}\n\\end{bmatrix}.\n$$\n因此，\n$$\n\\mathbf{P}_{t}^{-} \\mathbf{h} \\left( \\mathbf{h}^{\\top} \\mathbf{P}_{t}^{-} \\mathbf{h} + r_{1} \\right)^{-1} \\mathbf{h}^{\\top} \\mathbf{P}_{t}^{-}\n$$\n是一个秩一矩阵。其 $(1,1)$ 元素等于\n$$\n\\frac{\\left( 0.6\\, p_{11} + 0.4\\, p_{12} \\right)^{2}}{0.36\\, p_{11} + 0.48\\, p_{12} + 0.16\\, p_{22} + r_{1}}.\n$$\n因此，第一个状态分量的后验方差为\n$$\nP_{11,t}^{+} = p_{11} - \\frac{\\left( 0.6\\, p_{11} + 0.4\\, p_{12} \\right)^{2}}{0.36\\, p_{11} + 0.48\\, p_{12} + 0.16\\, p_{22} + r_{1}}.\n$$\n\n这就是在时间 $t$ 缺失 SAR 数据情况下所需的特化闭式表达式。请注意，如果 SAR 测量值 $y_{2,t}$ 可用，我们将会类似地以二维观测向量 $\\mathbf{y}_{t}$ 为条件，从而产生一个更大的信息项（涉及 $\\mathbf{H}^{\\top} \\mathbf{R}^{-1} \\mathbf{H}$），并因此根据高斯条件化在信息上的单调性得到一个更小的后验协方差。\n\n对不确定性传播的影响：在线性状态演化 $\\mathbf{x}_{t+1} = \\mathbf{F} \\mathbf{x}_{t} + \\boldsymbol{\\eta}_{t}$（其中 $\\boldsymbol{\\eta}_{t} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{Q})$ 且 $\\boldsymbol{\\eta}_{t}$ 独立于 $\\mathbf{x}_{t}$）下，预测协方差的传播方式为\n$$\n\\mathbf{P}_{t+1}^{-} = \\mathbf{F} \\mathbf{P}_{t}^{+} \\mathbf{F}^{\\top} + \\mathbf{Q}.\n$$\n因为缺失 SAR 数据减少了在时间 $t$ 的可用观测信息，所以上面推导出的后验协方差 $\\mathbf{P}_{t}^{+}$ 比 SAR 数据存在时的情况要大（在半正定序的意义上）。因此，$\\mathbf{P}_{t+1}^{-}$ 也更大，因为对于任何矩阵 $\\mathbf{F}$，映射 $\\mathbf{P} \\mapsto \\mathbf{F} \\mathbf{P} \\mathbf{F}^{\\top}$ 保持了半正定序，并且 $\\mathbf{Q} \\succeq \\mathbf{0}$ 增加了非负的不确定性。这表明，缺失的观测会增加分析时刻的不确定性，并通过动力学向前传播，导致后续步骤中更大的预测不确定性。$P_{11,t}^{+}$ 的结构明确地揭示了仅来自 SMAP 的信息是如何通过一个由信噪比因子 $\\left( \\mathbf{h}^{\\top} \\mathbf{P}_{t}^{-} \\mathbf{h} + r_{1} \\right)^{-1}$ 加权的秩一项来减少先验方差的；缺少 SAR 意味着没有由其灵敏度向量和噪声方差贡献的额外方差减少，因此不确定性的减少更弱，传播的不确定性更大。",
            "answer": "$$\\boxed{p_{11}-\\frac{\\left(0.6\\,p_{11}+0.4\\,p_{12}\\right)^{2}}{0.36\\,p_{11}+0.48\\,p_{12}+0.16\\,p_{22}+r_{1}}}$$"
        }
    ]
}