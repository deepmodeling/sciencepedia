{
    "hands_on_practices": [
        {
            "introduction": "要精通类似STARFM的算法，掌握其核心计算逻辑至关重要。第一个练习  提供了一个从基本原理出发，动手计算高分辨率反射率预测值的机会。通过一个具体的数值案例，您将学习STARFM如何利用相似邻近像元的信息，将参考日期的精细-粗糙分辨率偏差传递到预测日期，这是该融合方法的基石。",
            "id": "3851780",
            "problem": "考虑空间和时间自适应反射率融合模型（STARFM），该模型将预测日期的粗分辨率反射率与参考日期的高分辨率和粗分辨率图像对的邻域信息相融合。假设位于 $x_{0}$ 处的目标像元在预测日期 $t_{2}$ 的粗分辨率反射率为 $C_{0}(t_{2})$。在参考日期 $t_{1}$，三个由 $i \\in \\{1,2,3\\}$ 索引的相邻像元具有高分辨率反射率 $F_{i}(t_{1})$ 和粗分辨率反射率 $C_{i}(t_{1})$。类似于STARFM的估计器需要满足以下基于辐射一致性和局部平稳性的基本约束：(i) 在高分辨率和粗分辨率反射率在两个日期都一致的平凡情况下的不变性，(ii) 相邻像元贡献的线性叠加，其权重为非负且总和为一，以及 (iii) 将邻域的高-粗分辨率偏差从 $t_{1}$ 加性转移到 $t_{2}$ 的目标位置。\n\n仅从这些约束出发，推导目标像元处预测的高分辨率反射率 $\\widehat{F}_{0}(t_{2})$ 的估计器的唯一仿射形式。然后，使用以下给定的数值情景进行计算：\n\n- 目标像元在预测日期的粗分辨率反射率：$C_{0}(t_{2}) = 0.215$。\n- 参考日期 $t_{1}$ 的相邻像元：\n  - 相邻像元1：$F_{1}(t_{1}) = 0.180$, $C_{1}(t_{1}) = 0.170$。\n  - 相邻像元2：$F_{2}(t_{1}) = 0.250$, $C_{2}(t_{1}) = 0.260$。\n  - 相邻像元3：$F_{3}(t_{1}) = 0.205$, $C_{3}(t_{1}) = 0.200$。\n- 未归一化的倾向性得分：$s_{1} = 2.0$, $s_{2} = 1.0$, $s_{3} = 0.5$；权重定义为 $w_{i} = s_{i} \\Big/ \\sum_{j=1}^{3} s_{j}$。\n\n任务：\n1. 推导约束所蕴含的估计器形式。\n2. 计算归一化权重 $w_{i}$ 并验证归一化条件 $\\sum_{i=1}^{3} w_{i} = 1$。\n3. 使用推导出的估计器计算目标像元的数值预测 $\\widehat{F}_{0}(t_{2})$。\n\n将 $\\widehat{F}_{0}(t_{2})$ 的最终结果报告为无量纲反射率。将答案四舍五入至四位有效数字。",
            "solution": "问题陈述经评估是科学可靠、适定、客观且内部一致的。它提供了一套清晰的约束和数据，用以推导并计算一个类似于空间和时间自适应反射率融合模型（STARFM）的简化模型的预测值。我们着手进行解答。\n\n解答分为所要求的三个任务。\n\n### 任务1：推导估计器形式\n设 $\\widehat{F}_{0}(t_{2})$ 为预测日期 $t_{2}$ 时目标像元位置 $x_{0}$ 处高分辨率反射率的估计值。推导过程遵循所提供的三个基本约束。\n\n约束 (iii)，“将邻域的高-粗分辨率偏差从 $t_{1}$ 加性转移到 $t_{2}$ 的目标位置”，是核心原则。在参考日期 $t_{1}$，对于给定的相邻像元 $i$，其高-粗分辨率偏差是其高分辨率反射率 $F_{i}(t_{1})$ 与其粗分辨率反射率 $C_{i}(t_{1})$ 之间的差值。该偏差表示为 $\\Delta_{i}(t_{1}) = F_{i}(t_{1}) - C_{i}(t_{1})$。\n\n约束 (ii)，“相邻像元贡献的线性叠加，其权重为非负且总和为一”，规定了如何聚合各个相邻像元的偏差。在日期 $t_{1}$ 的总体“邻域高-粗分辨率偏差”是各个偏差的加权平均值：\n$$ \\Delta_{\\text{neighborhood}}(t_{1}) = \\sum_{i=1}^{3} w_{i} \\Delta_{i}(t_{1}) = \\sum_{i=1}^{3} w_{i} (F_{i}(t_{1}) - C_{i}(t_{1})) $$\n其中权重 $w_{i}$ 满足对所有 $i$ 都有 $w_{i} \\ge 0$ 且 $\\sum_{i=1}^{3} w_{i} = 1$。\n\n“加性转移”到日期 $t_{2}$ 目标位置的原则，假定由 $t_{1}$ 的邻域偏差所捕捉到的高分辨率和粗分辨率图像之间的关系，对于 $t_{2}$ 的目标像元同样成立。这意味着目标像元的期望偏差 $\\widehat{F}_{0}(t_{2}) - C_{0}(t_{2})$ 被设定为等于 $t_{1}$ 的邻域偏差：\n$$ \\widehat{F}_{0}(t_{2}) - C_{0}(t_{2}) = \\Delta_{\\text{neighborhood}}(t_{1}) $$\n通过重新排列该方程，我们将邻域偏差加到预测日期目标像元的已知粗分辨率反射率上，从而得到 $\\widehat{F}_{0}(t_{2})$ 的估计器：\n$$ \\widehat{F}_{0}(t_{2}) = C_{0}(t_{2}) + \\Delta_{\\text{neighborhood}}(t_{1}) $$\n代入邻域偏差的表达式，得到类似于STARFM的估计器的唯一仿射形式：\n$$ \\widehat{F}_{0}(t_{2}) = C_{0}(t_{2}) + \\sum_{i=1}^{3} w_{i} (F_{i}(t_{1}) - C_{i}(t_{1})) $$\n该形式满足所有约束。具体来说，对于约束 (i)，“平凡情况下的不变性”，如果所有高分辨率和粗分辨率反射率都相等（对于所有像元 $k$ 和时间 $t$ 都有 $F_{k}(t) = C_{k}(t)$），那么偏差项 $(F_{i}(t_{1}) - C_{i}(t_{1}))$ 对所有 $i$ 都将为 $0$。估计器将正确地简化为 $\\widehat{F}_{0}(t_{2}) = C_{0}(t_{2}) = F_{0}(t_{2})$。\n\n### 任务2：计算归一化权重\n给定的未归一化倾向性得分为 $s_{1} = 2.0$，$s_{2} = 1.0$ 和 $s_{3} = 0.5$。这些得分的总和是：\n$$ \\sum_{j=1}^{3} s_{j} = s_{1} + s_{2} + s_{3} = 2.0 + 1.0 + 0.5 = 3.5 $$\n归一化权重 $w_{i}$ 计算为 $w_{i} = \\frac{s_{i}}{\\sum_{j=1}^{3} s_{j}}$。\n$$ w_{1} = \\frac{2.0}{3.5} = \\frac{20}{35} = \\frac{4}{7} $$\n$$ w_{2} = \\frac{1.0}{3.5} = \\frac{10}{35} = \\frac{2}{7} $$\n$$ w_{3} = \\frac{0.5}{3.5} = \\frac{5}{35} = \\frac{1}{7} $$\n我们通过对权重求和来验证归一化条件：\n$$ \\sum_{i=1}^{3} w_{i} = w_{1} + w_{2} + w_{3} = \\frac{4}{7} + \\frac{2}{7} + \\frac{1}{7} = \\frac{4+2+1}{7} = \\frac{7}{7} = 1 $$\n条件 $\\sum_{i=1}^{3} w_{i} = 1$ 得到满足。\n\n### 任务3：计算数值预测\n现在我们使用推导出的估计器、计算出的权重和提供的数值数据来计算 $\\widehat{F}_{0}(t_{2})$。数据如下：\n- $C_{0}(t_{2}) = 0.215$\n- 相邻像元1：$F_{1}(t_{1}) = 0.180$, $C_{1}(t_{1}) = 0.170$\n- 相邻像元2：$F_{2}(t_{1}) = 0.250$, $C_{2}(t_{1}) = 0.260$\n- 相邻像元3：$F_{3}(t_{1}) = 0.205$, $C_{3}(t_{1}) = 0.200$\n\n首先，我们计算邻域高-粗分辨率偏差项 $\\sum_{i=1}^{3} w_{i} (F_{i}(t_{1}) - C_{i}(t_{1}))$：\n$$ \\frac{4}{7}(0.180 - 0.170) + \\frac{2}{7}(0.250 - 0.260) + \\frac{1}{7}(0.205 - 0.200) $$\n$$ = \\frac{4}{7}(0.010) + \\frac{2}{7}(-0.010) + \\frac{1}{7}(0.005) $$\n$$ = \\frac{1}{7} [4 \\times 0.010 + 2 \\times (-0.010) + 1 \\times 0.005] $$\n$$ = \\frac{1}{7} [0.040 - 0.020 + 0.005] $$\n$$ = \\frac{0.025}{7} $$\n现在，我们将此偏差加到预测日期目标像元的粗分辨率反射率上：\n$$ \\widehat{F}_{0}(t_{2}) = C_{0}(t_{2}) + \\frac{0.025}{7} $$\n$$ \\widehat{F}_{0}(t_{2}) = 0.215 + \\frac{0.025}{7} \\approx 0.215 + 0.00357142857... $$\n$$ \\widehat{F}_{0}(t_{2}) \\approx 0.21857142857... $$\n题目要求答案四舍五入到四位有效数字。第五位有效数字是 $7$，所以我们将第四位数字向上取整。\n$$ \\widehat{F}_{0}(t_{2}) \\approx 0.2186 $$",
            "answer": "$$ \\boxed{0.2186} $$"
        },
        {
            "introduction": "对于任何建模工作而言，一个关键问题是复杂方法是否比简单方法带来更显著的优势。本练习  直面这一问题，将一个简单的线性时间模型预测结果与一个类似STARFM的融合预测结果进行比较。通过量化两者之间的差异，该实践阐明了引入粗分辨率数据的价值所在，这些数据提供了关于时间变化的关键信息，而这可能无法仅通过稀疏的精细分辨率观测来捕捉。",
            "id": "3851874",
            "problem": "一个遥感站点由两个多光谱成像系统观测：一个高空间分辨率传感器（例如，NASA Landsat）提供精细分辨率的地表反射率，以及一个低空间分辨率传感器（例如，Moderate Resolution Imaging Spectroradiometer (MODIS)）提供粗分辨率的反射率。令 $H(\\mathbf{x}, t)$ 表示在像素位置 $\\mathbf{x}$ 和时间 $t$ 的精细分辨率反射率，令 $L(\\mathbf{x}, t)$ 表示在相同位置和时间的粗分辨率反射率。考虑单个像素 $\\mathbf{x}_0$ 和一个光谱波段，其中短时间内的反射率动态可以通过线性变化模型近似，并且跨尺度的反射率在局部邻域内近似成比例，且比例系数随时间缓慢变化。\n\n给定两个无云、共配准的观测日期 $t_1 = 100$ 天和 $t_2 = 160$ 天（相对于一个一致的参考，如年积日），以及一个目标预测时间 $t_p = 145$ 天。精细分辨率的观测值为 $H(\\mathbf{x}_0, t_1) = 0.124$ 和 $H(\\mathbf{x}_0, t_2) = 0.172$。粗分辨率的观测值为 $L(\\mathbf{x}_0, t_1) = 0.095$、$L(\\mathbf{x}_0, t_2) = 0.136$ 和 $L(\\mathbf{x}_0, t_p) = 0.129$。假设这些日期的采集几何形状和大气条件足够相似，因此对于局部建模而言，双向反射分布函数效应可以忽略不计。\n\n仅使用以下基本依据：\n- 对于固定的地表类型，在足够短的时间间隔内，反射率可以近似为时间的线性函数，即 $H(\\mathbf{x}_0, t)$ 在 $[t_1, t_2]$ 上可以很好地用一个关于 $t$ 的仿射函数来近似。\n- 在局部同质性和尺度聚合的条件下，精细分辨率和粗分辨率的反射率近似成比例关系 $H(\\mathbf{x}_0, t) \\approx \\alpha(t) \\, L(\\mathbf{x}_0, t)$，其中 $\\alpha(t)$ 相对于时间间隔 $[t_1, t_2]$ 变化缓慢。\n- 一个简化的时空自适应反射率融合模型 (Spatial and Temporal Adaptive Reflectance Fusion Model, STARFM) 方法，通过使用随时间间隔衰减的时间自适应权重，结合了来自可用精细分辨率日期的锚定预测；假设时间权重核为 $w_k \\propto \\exp\\!\\left(-\\frac{|t_p - t_k|}{\\tau}\\right)$，对于 $t_k \\in \\{t_1, t_2\\}$，时间尺度 $\\tau = 20$ 天，并且权重被归一化以使总和为 $1$。\n\n执行以下操作：\n1. 将线性变化模型拟合到 $t_1$ 和 $t_2$ 的两个精细分辨率观测值，以获得仿射近似 $H_{\\text{lin}}(\\mathbf{x}_0, t) = a + b t$ 并计算 $H_{\\text{lin}}(\\mathbf{x}_0, t_p)$。\n2. 通过以下步骤构建一个类似 STARFM 的混合预测 $H_{\\text{STAR}}(\\mathbf{x}_0, t_p)$：\n   (i) 根据成对的精细和粗分辨率观测值，估计在 $t_k \\in \\{t_1, t_2\\}$ 时的局部尺度因子 $\\alpha_k$，\n   (ii) 通过局部尺度传播从 $t_k$ 到 $t_p$ 的粗分辨率变化，形成在 $t_k$ 时的锚定预测，以及\n   (iii) 使用上面定义的时间自适应权重组合锚定预测。\n3. 计算定义为 $b^\\ast = H_{\\text{STAR}}(\\mathbf{x}_0, t_p) - H_{\\text{lin}}(\\mathbf{x}_0, t_p)$ 的偏差。\n\n将 $b^\\ast$ 的最终数值答案四舍五入到四位有效数字。以无单位反射率的小数形式表示最终结果。",
            "solution": "问题陈述已经过验证，被认为是内部一致、有科学依据且定义良好的。所有必要的数据和模型定义都已提供，以计算出唯一解。\n\n该问题要求计算和比较在特定像素位置 $\\mathbf{x}_0$ 和预测时间 $t_p$ 的精细分辨率反射率 $H(\\mathbf{x}_0, t_p)$ 的两种不同估计。第一个估计基于精细分辨率数据的时间线性插值，而第二个估计源自一个简化的时空自适应反射率融合模型 (STARFM) 方法。\n\n给定参数如下：\n- 精细分辨率观测值：在 $t_1 = 100$ 天时 $H(\\mathbf{x}_0, t_1) = 0.124$，在 $t_2 = 160$ 天时 $H(\\mathbf{x}_0, t_2) = 0.172$。\n- 粗分辨率观测值：在 $t_1 = 100$ 天时 $L(\\mathbf{x}_0, t_1) = 0.095$，在 $t_2 = 160$ 天时 $L(\\mathbf{x}_0, t_2) = 0.136$，以及在预测时间 $t_p = 145$ 天时 $L(\\mathbf{x}_0, t_p) = 0.129$。\n- 时间加权核的时间尺度：$\\tau = 20$ 天。\n\n我们将首先计算线性模型的预测值，然后计算类似 STARFM 模型的预测值，最后计算它们的差值。\n\n**1. 线性变化模型预测**\n\n问题陈述指出，精细分辨率反射率 $H(\\mathbf{x}_0, t)$ 在区间 $[t_1, t_2]$ 上可以由仿射函数 $H_{\\text{lin}}(\\mathbf{x}_0, t) = a + b t$ 近似。我们使用两个精细分辨率观测值来确定参数 $a$ 和 $b$。\n\n直线的斜率 $b$ 由反射率的变化量除以时间的变化量给出：\n$$b = \\frac{H(\\mathbf{x}_0, t_2) - H(\\mathbf{x}_0, t_1)}{t_2 - t_1} = \\frac{0.172 - 0.124}{160 - 100} = \\frac{0.048}{60} = 0.0008$$\n截距 $a$ 可以使用其中一个点来找到，例如 $(t_1, H(\\mathbf{x}_0, t_1))$：\n$$a = H(\\mathbf{x}_0, t_1) - b t_1 = 0.124 - (0.0008)(100) = 0.124 - 0.08 = 0.044$$\n因此，线性模型为：\n$$H_{\\text{lin}}(\\mathbf{x}_0, t) = 0.044 + 0.0008 t$$\n我们在预测时间 $t_p = 145$ 天时评估此模型：\n$$H_{\\text{lin}}(\\mathbf{x}_0, t_p) = 0.044 + 0.0008 \\times 145 = 0.044 + 0.116 = 0.160$$\n\n**2. 类似 STARFM 的混合预测**\n\n这个预测表示为 $H_{\\text{STAR}}(\\mathbf{x}_0, t_p)$，是两个“锚定预测”的加权平均。\n\n**(i) 局部尺度因子**\n首先，我们基于比例假设 $H(\\mathbf{x}_0, t) \\approx \\alpha(t) L(\\mathbf{x}_0, t)$，估计在观测日期 $t_k \\in \\{t_1, t_2\\}$ 的局部尺度因子 $\\alpha_k$。\n对于 $t_1 = 100$：\n$$\\alpha_1 = \\frac{H(\\mathbf{x}_0, t_1)}{L(\\mathbf{x}_0, t_1)} = \\frac{0.124}{0.095}$$\n对于 $t_2 = 160$：\n$$\\alpha_2 = \\frac{H(\\mathbf{x}_0, t_2)}{L(\\mathbf{x}_0, t_2)} = \\frac{0.172}{0.136}$$\n\n**(ii) 锚定预测**\n一个锚定预测 $H_{p}^{(k)}$ 是通过从锚定日期 $t_k$ 的精细分辨率观测值开始，并加上从 $t_k$ 到 $t_p$ 的粗分辨率变化（通过局部尺度因子 $\\alpha_k$ 传播）形成的。从日期 $t_k$ 的锚定预测公式为：\n$$H_{p}^{(k)} = H(\\mathbf{x}_0, t_k) + \\alpha_k [L(\\mathbf{x}_0, t_p) - L(\\mathbf{x}_0, t_k)]$$\n通过代入 $\\alpha_k = H(\\mathbf{x}_0, t_k) / L(\\mathbf{x}_0, t_k)$，这可以简化为：\n$$H_{p}^{(k)} = H(\\mathbf{x}_0, t_k) \\left( 1 + \\frac{L(\\mathbf{x}_0, t_p) - L(\\mathbf{x}_0, t_k)}{L(\\mathbf{x}_0, t_k)} \\right) = H(\\mathbf{x}_0, t_k) \\left( \\frac{L(\\mathbf{x}_0, t_p)}{L(\\mathbf{x}_0, t_k)} \\right) = \\alpha_k L(\\mathbf{x}_0, t_p)$$\n现在我们计算两个锚定预测：\n$$H_{p}^{(1)} = \\alpha_1 L(\\mathbf{x}_0, t_p) = \\frac{0.124}{0.095} \\times 0.129$$\n$$H_{p}^{(2)} = \\alpha_2 L(\\mathbf{x}_0, t_p) = \\frac{0.172}{0.136} \\times 0.129$$\n\n**(iii) 时间自适应权重和混合**\n最终预测是加权和 $H_{\\text{STAR}}(\\mathbf{x}_0, t_p) = w_1 H_{p}^{(1)} + w_2 H_{p}^{(2)}$。权重 $w_k$ 由核函数 $w_k \\propto \\exp(-|t_p - t_k|/\\tau)$ 导出，并被归一化以使总和为 1。时间尺度为 $\\tau = 20$。\n\n时间差为 $|t_p - t_1| = |145 - 100| = 45$ 天和 $|t_p - t_2| = |145 - 160| = 15$ 天。\n未归一化的权重为：\n$$u_1 = \\exp\\left(-\\frac{45}{20}\\right) = \\exp(-2.25)$$\n$$u_2 = \\exp\\left(-\\frac{15}{20}\\right) = \\exp(-0.75)$$\n归一化的权重为：\n$$w_1 = \\frac{u_1}{u_1 + u_2} = \\frac{\\exp(-2.25)}{\\exp(-2.25) + \\exp(-0.75)} = \\frac{1}{1 + \\exp(-0.75 - (-2.25))} = \\frac{1}{1 + \\exp(1.5)}$$\n$$w_2 = \\frac{u_2}{u_1 + u_2} = \\frac{\\exp(-0.75)}{\\exp(-2.25) + \\exp(-0.75)} = \\frac{\\exp(1.5)}{1 + \\exp(1.5)}$$\n现在我们使用这些权重组合锚定预测：\n$$H_{\\text{STAR}}(\\mathbf{x}_0, t_p) = w_1 H_{p}^{(1)} + w_2 H_{p}^{(2)}$$\n$$H_{\\text{STAR}}(\\mathbf{x}_0, t_p) = \\frac{1}{1 + \\exp(1.5)} \\left( \\frac{0.124}{0.095} \\times 0.129 \\right) + \\frac{\\exp(1.5)}{1 + \\exp(1.5)} \\left( \\frac{0.172}{0.136} \\times 0.129 \\right)$$\n$$H_{\\text{STAR}}(\\mathbf{x}_0, t_p) = \\frac{0.129}{1 + \\exp(1.5)} \\left( \\frac{0.124}{0.095} + \\exp(1.5) \\frac{0.172}{0.136} \\right)$$\n使用数值：\n$$H_{p}^{(1)} \\approx 1.305263 \\times 0.129 \\approx 0.168379$$\n$$H_{p}^{(2)} \\approx 1.264706 \\times 0.129 \\approx 0.163147$$\n$$\\exp(1.5) \\approx 4.481689$$\n$$w_1 \\approx \\frac{1}{1 + 4.481689} \\approx 0.182425$$\n$$w_2 \\approx 1 - 0.182425 \\approx 0.817575$$\n$$H_{\\text{STAR}}(\\mathbf{x}_0, t_p) \\approx (0.182425 \\times 0.168379) + (0.817575 \\times 0.163147) \\approx 0.030726 + 0.133376 \\approx 0.164102$$\n\n**3. 偏差计算**\n\n偏差 $b^\\ast$ 定义为类似 STARFM 的预测与线性模型预测之间的差值。\n$$b^\\ast = H_{\\text{STAR}}(\\mathbf{x}_0, t_p) - H_{\\text{lin}}(\\mathbf{x}_0, t_p)$$\n$$b^\\ast \\approx 0.164102 - 0.160 = 0.004102$$\n问题要求将最终答案四舍五入到四位有效数字。计算值为 $0.00410216...$。前四位有效数字是 $4$、$1$、$0$ 和 $2$。第五位有效数字是 $1$，所以我们向下舍入。\n\n偏差的最终值为 $0.004102$。",
            "answer": "$$\\boxed{0.004102}$$"
        },
        {
            "introduction": "生成融合数据产品是一项重要成就，但其科学价值取决于对其准确性的严格评估。这最后一个练习  侧重于模型验证，这是任何遥感工作流程中的关键步骤。您将计算预测值与参考值之间的均方根误差 (RMSE)，更重要的是，您将诠释该指标的实际意义，这将帮助您培养判断模型性能对于特定环境应用是否“足够好”的关键能力。",
            "id": "3851801",
            "problem": "一个时空数据融合工作流使用空间和时间自适应反射率融合模型 (STARFM) 来预测日期 $t_{0}$ 植被景观上近红外波段的类 Landsat 地表反射率。从同质斑块中采样了十个验证像素，以最小化混合像元效应。对于每个像素 $i \\in \\{1,\\dots,10\\}$，给定来自 Landsat Operational Land Imager (OLI) 且经过大气校正的参考反射率，记为 $\\,\\rho_{i}\\,$，以及 STARFM 预测的反射率，记为 $\\,\\hat{\\rho}_{i}\\,$。这些数据对为：\n$(\\rho_{1} = 0.215,\\ \\hat{\\rho}_{1} = 0.223)$,\n$(\\rho_{2} = 0.312,\\ \\hat{\\rho}_{2} = 0.298)$,\n$(\\rho_{3} = 0.145,\\ \\hat{\\rho}_{3} = 0.159)$,\n$(\\rho_{4} = 0.478,\\ \\hat{\\rho}_{4} = 0.463)$,\n$(\\rho_{5} = 0.389,\\ \\hat{\\rho}_{5} = 0.401)$,\n$(\\rho_{6} = 0.267,\\ \\hat{\\rho}_{6} = 0.254)$,\n$(\\rho_{7} = 0.531,\\ \\hat{\\rho}_{7} = 0.508)$,\n$(\\rho_{8} = 0.096,\\ \\hat{\\rho}_{8} = 0.105)$,\n$(\\rho_{9} = 0.423,\\ \\hat{\\rho}_{9} = 0.417)$,\n$(\\rho_{10} = 0.358,\\ \\hat{\\rho}_{10} = 0.372)$.\n\n从适用于遥感和误差分析的基本定义出发：\n- 地表反射率 $\\,\\rho\\,$ 是上行辐亮度与下行辐照度在传感器光谱响应范围内积分的比值，是一个无量纲的量，以及\n- 均方根误差 (RMSE) 源于误差向量的欧几里得范数经样本大小缩放后得到，\n\n推导 $\\,\\hat{\\rho}_{i}\\,$ 和 $\\,\\rho_{i}\\,$ 之间的 RMSE 表达式，计算其在上述数据集上的值，并就其大小对时空融合的实际意义提供简洁的解释。讨论对于常见的环境监测任务，在近红外波段，类 STARFM 预测可接受的误差阈值是多少，您的讨论应基于广泛观测到的反射率范围和传感器噪声特性，而非经验法则。\n\n将您计算的 RMSE 四舍五入到四位有效数字。将最终的 RMSE 表示为无量纲的小数。",
            "solution": "该问题经评估具有科学依据、问题明确、客观且完整。它提供了推导和计算一组预测与参考地表反射率值的均方根误差 (RMSE) 所需的所有数据和定义，并将结果置于遥感领域的背景中进行解读。因此，该问题被认定为有效，并随即提供解答。\n\n任务是推导均方根误差 (RMSE) 的表达式，计算其在给定数据集上的值，并解释其意义。\n\n首先，我们从所提供的基本定义推导 RMSE 的数学表达式。假设有一组 $N$ 个参考（真实）值 $\\rho_i$，以及一组对应的 $N$ 个预测（模型）值 $\\hat{\\rho}_i$，其中 $i \\in \\{1, 2, \\dots, N\\}$。对于本问题，$N=10$。\n\n每个独立预测的误差或残差是预测值与参考值之间的差：\n$$e_i = \\hat{\\rho}_i - \\rho_i$$\n\n这 $N$ 个独立的误差可以被看作是一个 $N$ 维误差向量 $\\mathbf{e}$ 的分量：\n$$\\mathbf{e} = \\begin{pmatrix} e_1 \\\\ e_2 \\\\ \\vdots \\\\ e_N \\end{pmatrix} = \\begin{pmatrix} \\hat{\\rho}_1 - \\rho_1 \\\\ \\hat{\\rho}_2 - \\rho_2 \\\\ \\vdots \\\\ \\hat{\\rho}_N - \\rho_N \\end{pmatrix}$$\n\n问题指出 RMSE 源于此误差向量的欧几里得范数。$\\mathbf{e}$ 的欧几里得范数（或 $L_2$ 范数），记为 $\\|\\mathbf{e}\\|_2$，是其各分量平方和的平方根。它表示误差向量的几何长度。\n$$\\|\\mathbf{e}\\|_2 = \\sqrt{\\sum_{i=1}^{N} e_i^2} = \\sqrt{\\sum_{i=1}^{N} (\\hat{\\rho}_i - \\rho_i)^2}$$\n\n均方误差 (MSE) 定义为误差平方的平均值。它是误差向量的欧几里得范数的平方，按样本数 $N$ 的倒数进行缩放：\n$$\\text{MSE} = \\frac{1}{N} \\sum_{i=1}^{N} e_i^2 = \\frac{1}{N} \\sum_{i=1}^{N} (\\hat{\\rho}_i - \\rho_i)^2 = \\frac{\\|\\mathbf{e}\\|_2^2}{N}$$\n\n根据定义，RMSE 是 MSE 的平方根。它用于将误差度量恢复到被测量（本例中为无量纲的反射率）的原始单位。因此，RMSE 是误差向量的欧几里得范数，按因子 $1/\\sqrt{N}$ 进行缩放：\n$$\\text{RMSE} = \\sqrt{\\text{MSE}} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} (\\hat{\\rho}_i - \\rho_i)^2} = \\frac{\\|\\mathbf{e}\\|_2}{\\sqrt{N}}$$\n这样就完成了从所述第一性原理对 RMSE 表达式的推导。\n\n接下来，我们计算给定数据集的 RMSE。样本数量为 $N=10$。参考反射率值 $\\rho_i$ 和预测值 $\\hat{\\rho}_i$ 已给出。我们首先计算 10 个像素中每个像素的误差平方 $(e_i^2 = (\\hat{\\rho}_i - \\rho_i)^2)$。\n\n- 对于 $i=1$: $(\\hat{\\rho}_1 - \\rho_1)^2 = (0.223 - 0.215)^2 = (0.008)^2 = 0.000064$\n- 对于 $i=2$: $(\\hat{\\rho}_2 - \\rho_2)^2 = (0.298 - 0.312)^2 = (-0.014)^2 = 0.000196$\n- 对于 $i=3$: $(\\hat{\\rho}_3 - \\rho_3)^2 = (0.159 - 0.145)^2 = (0.014)^2 = 0.000196$\n- 对于 $i=4$: $(\\hat{\\rho}_4 - \\rho_4)^2 = (0.463 - 0.478)^2 = (-0.015)^2 = 0.000225$\n- 对于 $i=5$: $(\\hat{\\rho}_5 - \\rho_5)^2 = (0.401 - 0.389)^2 = (0.012)^2 = 0.000144$\n- 对于 $i=6$: $(\\hat{\\rho}_6 - \\rho_6)^2 = (0.254 - 0.267)^2 = (-0.013)^2 = 0.000169$\n- 对于 $i=7$: $(\\hat{\\rho}_7 - \\rho_7)^2 = (0.508 - 0.531)^2 = (-0.023)^2 = 0.000529$\n- 对于 $i=8$: $(\\hat{\\rho}_8 - \\rho_8)^2 = (0.105 - 0.096)^2 = (0.009)^2 = 0.000081$\n- 对于 $i=9$: $(\\hat{\\rho}_9 - \\rho_9)^2 = (0.417 - 0.423)^2 = (-0.006)^2 = 0.000036$\n- 对于 $i=10$: $(\\hat{\\rho}_{10} - \\rho_{10})^2 = (0.372 - 0.358)^2 = (0.014)^2 = 0.000196$\n\n这些误差平方的总和（欧几里得范数的平方）是：\n$$\\sum_{i=1}^{10} (\\hat{\\rho}_i - \\rho_i)^2 = 0.000064 + 0.000196 + 0.000196 + 0.000225 + 0.000144 + 0.000169 + 0.000529 + 0.000081 + 0.000036 + 0.000196 = 0.001836$$\n\n现在，我们通过除以 $N=10$ 来计算 MSE：\n$$\\text{MSE} = \\frac{0.001836}{10} = 0.0001836$$\n\n最后，RMSE 是 MSE 的平方根：\n$$\\text{RMSE} = \\sqrt{0.0001836} \\approx 0.0135499077$$\n\n按要求四舍五入到四位有效数字，我们得到：\n$$\\text{RMSE} \\approx 0.01355$$\n\n计算出的 RMSE 约为 $0.01355$。地表反射率是一个无量纲的比率，因此 RMSE 也是一个无量纲的量，代表了以反射率单位表示的典型误差大小。$0.01355$ 的 RMSE 表明 STARFM 的预测值与参考的 Landsat 反射率值平均相差约 $1.36\\%$。对于近红外 (NIR) 反射率为 $0.40$ 的植被表面，此误差对应的相对误差约为 $0.01355 / 0.40 \\approx 3.4\\%$。对于像土壤这样反射率为 $0.10$ 的较暗表面，相对误差更高，为 $13.6\\%$。这表明，在广泛的反射率值范围内，绝对误差是比相对误差更稳定的性能指标。\n\n关于可接受的误差阈值，我们必须考虑参考数据本身固有的不确定性来源。“真实”的地表反射率并非完美可知；它是通过大气校正过程从传感器测量的辐亮度中推导出来的。这个过程本身也有不确定性。对于像 Landsat OLI 这样的高质量传感器，大气校正后推导的地表反射率误差通常估计为反射率值的 $5\\%$ 左右外加一个偏移量，通常认为在晴空条件下，可见光和近红外波段的误差在 $0.01$ 到 $0.02$ 反射率单位的范围内。此外，传感器噪声（以等效噪声反射率变化，即 $NE\\Delta\\rho$ 为特征）也带来了不确定性，尽管对于 Landsat OLI 而言，这种不确定性通常较小（量级约为 $0.001$ 反射率单位）。\n\n鉴于参考数据本身的不确定性通常在 $0.01 - 0.02$ 的范围内，一个能达到此范围内 RMSE 的融合模型表现已是极好。计算出的 RMSE $0.01355$ 正好落在这个界限内。在时空融合的文献中，近红外波段的 RMSE 低于 $0.02$ 被广泛认为是一个高保真预测的标志，适用于大多数定量应用，如监测植被物候、估算生物物理参数（例如，LAI，fAPAR）或变化检测。在此类应用中，感兴趣的信号（例如，近红外反射率的物候变化）通常为 $0.10$ 到 $0.30$ 或更大，比模型误差大一个数量级。因此，$0.01355$ 的 RMSE 意味着融合产品质量很高，模型误差不太可能掩盖地景中真实的时间变化。",
            "answer": "$$\\boxed{0.01355}$$"
        }
    ]
}