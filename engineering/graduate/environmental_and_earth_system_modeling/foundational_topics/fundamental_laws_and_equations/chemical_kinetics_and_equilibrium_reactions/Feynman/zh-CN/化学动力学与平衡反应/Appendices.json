{
    "hands_on_practices": [
        {
            "introduction": "多元弱酸和弱碱的质子转移反应是决定天然水体（如地下水和海水）化学性质的核心过程。本练习将指导你推导并计算一种典型多元酸（磷酸）的化学物质形态如何随 pH 值变化，并进一步考虑离子强度所带来的非理想效应。掌握这项从基本原理出发进行推导和计算的技能，对于准确理解和模拟复杂水生环境的化学行为至关重要。",
            "id": "3867376",
            "problem": "一个受磷酸盐影响的含水层中的地下水样本，在 $25\\,^{\\circ}\\mathrm{C}$ 下可近似为一个离子强度 $I = 0.10\\,\\mathrm{mol\\,L^{-1}}$ 的均匀水溶液。磷酸，通用符号表示为三元酸 $H_{3}A$，经历分步去质子化反应 $H_{3}A \\rightleftharpoons H_{2}A^{-} + H^{+}$、$H_{2}A^{-} \\rightleftharpoons HA^{2-} + H^{+}$ 和 $HA^{2-} \\rightleftharpoons A^{3-} + H^{+}$。在 $25\\,^{\\circ}\\mathrm{C}$ 和无限稀释条件下，其热力学（基于活度）酸解离常数为 $pK_{a1}^{\\mathrm{a}} = 2.148$，$pK_{a2}^{\\mathrm{a}} = 7.198$ 和 $pK_{a3}^{\\mathrm{a}} = 12.375$。测得样本的 $\\mathrm{pH}$ 值为 $7.50$（定义为 $\\mathrm{pH} = -\\log_{10} a_{H^{+}}$，其中 $a_{H^{+}}$ 是氢离子活度）。\n\n从质量作用定律、活度的定义以及多元酸的质量平衡出发，推导当 $j = 0,1,2,3$ 时物种分数 $\\alpha_{j}(\\mathrm{pH})$ 的分布，其中 $\\alpha_{j}$ 是总酸中以 $H_{3-j}A^{j-}$ 形式存在的分数。然后，使用 Davies 方程考虑在给定离子强度下的非理想性，计算在 $\\mathrm{pH} = 7.50$ 和 $I = 0.10\\,\\mathrm{mol\\,L^{-1}}$ 条件下以 $A^{3-}$ 形式存在的分数 $\\alpha_{3}$。\n\n在 $25\\,^{\\circ}\\mathrm{C}$ 下，对于电荷为 $z_{i}$ 的离子 $i$，使用 Davies 方程计算其活度系数 $\\gamma_{i}$，\n$$\n-\\log_{10}\\gamma_{i} = A z_{i}^{2}\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3\\,I\\right),\n$$\n其中 $A = 0.51$，并假设中性物种的 $\\gamma$ 为 $1$。将报告的 $\\mathrm{pH}$ 视为基于活度的，即 $a_{H^{+}} = 10^{-\\mathrm{pH}}$，并使用 $a_{H^{+}} = \\gamma_{H^{+}}[H^{+}]$ 将其转换为自由质子浓度 $[H^{+}]$。忽略所示酸碱反应之外的络合作用，并忽略活度系数所能描述范围之外的特定离子对。将 $\\alpha_{3}$ 的最终数值答案四舍五入到四位有效数字。该分数为无量纲量，必须以小数形式报告（而不是百分比）。",
            "solution": "该问题要求推导三元酸的物种分布，并计算在指定的 $\\mathrm{pH}$ 和离子强度条件下，完全去质子化的物种 $A^{3-}$ 的分数。解答必须使用 Davies 方程来考虑非理想行为。\n\n首先，我们推导物种分数 $\\alpha_j$ 的通用表达式。磷酸 $H_3A$ 的分步去质子化由以下三个平衡描述：\n$$H_{3}A \\rightleftharpoons H_{2}A^{-} + H^{+} \\quad K_{a1}^{\\mathrm{a}} = \\frac{a_{H_{2}A^{-}} a_{H^{+}}}{a_{H_{3}A}}$$\n$$H_{2}A^{-} \\rightleftharpoons HA^{2-} + H^{+} \\quad K_{a2}^{\\mathrm{a}} = \\frac{a_{HA^{2-}} a_{H^{+}}}{a_{H_{2}A^{-}}}$$\n$$HA^{2-} \\rightleftharpoons A^{3-} + H^{+} \\quad K_{a3}^{\\mathrm{a}} = \\frac{a_{A^{3-}} a_{H^{+}}}{a_{HA^{2-}}}$$\n此处，$K_{aj}^{\\mathrm{a}}$ 是热力学（基于活度）酸解离常数，$a_i$ 代表物种 $i$ 的活度。\n\n离子 $i$ 的活度 $a_i$ 与其摩尔浓度 $[i]$ 通过 $a_i = \\gamma_i [i]$ 相关联，其中 $\\gamma_i$ 是活度系数。对于像 $H_3A$ 这样的中性物种，给定 $\\gamma_{H_3A} = 1$。所有磷酸盐物种的总浓度 $C_T$ 是各个物种浓度的总和：\n$$C_T = [H_3A] + [H_2A^-] + [HA^{2-}] + [A^{3-}]$$\n每个物种的分数 $\\alpha_j$ 定义为该物种的浓度除以总浓度 $C_T$。例如，$\\alpha_3 = [A^{3-}]/C_T$。\n\n为了找到 $\\alpha_j$ 的表达式，我们将每个物种的浓度表示为相对于一个选定的参考物种。由于给定的 $\\mathrm{pH}$ 值 $7.50$ 最接近给定的 $pK_{a2}^{\\mathrm{a}}$ 值 $7.198$，物种 $H_2A^-$ 和 $HA^{2-}$ 将占主导地位。我们选择 $HA^{2-}$ 作为参考物种。\n\n根据平衡表达式，我们可以写出浓度比。令 $\\gamma_0, \\gamma_1, \\gamma_2, \\gamma_3$ 分别为 $H_3A, H_2A^-, HA^{2-}, A^{3-}$ 的活度系数。\n$$\\frac{[H_2A^-]}{[HA^{2-}]} = \\frac{a_{H_2A^-}/\\gamma_1}{a_{HA^{2-}}/\\gamma_2} = \\frac{a_{H^+}}{K_{a2}^{\\mathrm{a}}} \\frac{\\gamma_2}{\\gamma_1}$$\n$$\\frac{[H_3A]}{[H_2A^-]} = \\frac{a_{H_3A}/\\gamma_0}{a_{H_2A^-}/\\gamma_1} = \\frac{a_{H^+}}{K_{a1}^{\\mathrm{a}}} \\frac{\\gamma_1}{\\gamma_0}$$\n$$\\frac{[A^{3-}]}{[HA^{2-}]} = \\frac{a_{A^{3-}}/\\gamma_3}{a_{HA^{2-}}/\\gamma_2} = \\frac{K_{a3}^{\\mathrm{a}}}{a_{H^+}} \\frac{\\gamma_2}{\\gamma_3}$$\n综合这些，我们将所有浓度用 $[HA^{2-}]$ 表示：\n$$[H_2A^-] = [HA^{2-}] \\left( \\frac{a_{H^+}}{K_{a2}^{\\mathrm{a}}} \\frac{\\gamma_2}{\\gamma_1} \\right)$$\n$$[H_3A] = [H_2A^-] \\left( \\frac{a_{H^+}}{K_{a1}^{\\mathrm{a}}} \\frac{\\gamma_1}{\\gamma_0} \\right) = [HA^{2-}] \\left( \\frac{(a_{H^+})^2}{K_{a1}^{\\mathrm{a}} K_{a2}^{\\mathrm{a}}} \\frac{\\gamma_2}{\\gamma_0} \\right)$$\n$$[A^{3-}] = [HA^{2-}] \\left( \\frac{K_{a3}^{\\mathrm{a}}}{a_{H^+}} \\frac{\\gamma_2}{\\gamma_3} \\right)$$\n总浓度为：\n$$C_T = [HA^{2-}] \\left( \\frac{(a_{H^+})^2}{K_{a1}^{\\mathrm{a}} K_{a2}^{\\mathrm{a}}} \\frac{\\gamma_2}{\\gamma_0} + \\frac{a_{H^+}}{K_{a2}^{\\mathrm{a}}} \\frac{\\gamma_2}{\\gamma_1} + 1 + \\frac{K_{a3}^{\\mathrm{a}}}{a_{H^+}} \\frac{\\gamma_2}{\\gamma_3} \\right)$$\n物种分数 $\\alpha_j$ 的通用表达式是和式中对应于该物种的项除以整个和。令分母（括号中的项）为 $D$。那么物种分数分布为：\n$$\\alpha_0 = \\frac{1}{D} \\left(\\frac{(a_{H^+})^2}{K_{a1}^{\\mathrm{a}} K_{a2}^{\\mathrm{a}}} \\frac{\\gamma_2}{\\gamma_0}\\right), \\quad \\alpha_1 = \\frac{1}{D} \\left(\\frac{a_{H^+}}{K_{a2}^{\\mathrm{a}}} \\frac{\\gamma_2}{\\gamma_1}\\right), \\quad \\alpha_2 = \\frac{1}{D}, \\quad \\alpha_3 = \\frac{1}{D} \\left(\\frac{K_{a3}^{\\mathrm{a}}}{a_{H^+}} \\frac{\\gamma_2}{\\gamma_3}\\right)$$\n这就完成了所要求的物种分数分布 $\\alpha_j(\\mathrm{pH})$ 的推导。\n\n现在，我们计算 $\\alpha_3$ 的数值。给定的参数如下：\n$\\mathrm{pH} = 7.50 \\implies a_{H^+} = 10^{-7.50}$\n$I = 0.10\\,\\mathrm{mol\\,L^{-1}}$\n$A = 0.51$\n$pK_{a1}^{\\mathrm{a}} = 2.148 \\implies K_{a1}^{\\mathrm{a}} = 10^{-2.148}$\n$pK_{a2}^{\\mathrm{a}} = 7.198 \\implies K_{a2}^{\\mathrm{a}} = 10^{-7.198}$\n$pK_{a3}^{\\mathrm{a}} = 12.375 \\implies K_{a3}^{\\mathrm{a}} = 10^{-12.375}$\n\n首先，我们使用 Davies 方程计算每个电荷为 $z_i$ 的离子的活度系数 $\\gamma_i$：\n$$-\\log_{10}\\gamma_{i} = A z_{i}^{2} \\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right)$$\n括号中的项对于本问题是一个常数：\n$$\\frac{\\sqrt{0.10}}{1+\\sqrt{0.10}} - 0.3(0.10) \\approx \\frac{0.316228}{1.316228} - 0.03 \\approx 0.240253 - 0.03 = 0.210253$$\n因此，$-\\log_{10}\\gamma_i = 0.51 z_i^2 (0.210253) = 0.107229 z_i^2$。这得到 $\\log_{10}\\gamma_i = -0.107229 z_i^2$。\n\n磷酸盐物种的电荷分别为：$H_3A$ 为 $z_0 = 0$，$H_2A^-$ 为 $z_1 = -1$，$HA^{2-}$ 为 $z_2 = -2$，以及 $A^{3-}$ 为 $z_3 = -3$。\n$\\gamma_0 = \\gamma_{H_3A} = 1$（因为 $z_0=0$）。\n$\\log_{10}\\gamma_1 = -0.107229(-1)^2 = -0.107229 \\implies \\gamma_1 = 10^{-0.107229} \\approx 0.78121$\n$\\log_{10}\\gamma_2 = -0.107229(-2)^2 = -0.428916 \\implies \\gamma_2 = 10^{-0.428916} \\approx 0.37246$\n$\\log_{10}\\gamma_3 = -0.107229(-3)^2 = -0.965061 \\implies \\gamma_3 = 10^{-0.965061} \\approx 0.10838$\n\n接下来，我们计算分母 $D$ 中的各项：\n令 $T_0=\\frac{[H_3A]}{[HA^{2-}]}$，$T_1=\\frac{[H_2A^-]}{[HA^{2-}]}$，$T_2=1$，$T_3=\\frac{[A^{3-}]}{[HA^{2-}]}$。\n\n$T_0 = \\frac{(10^{-7.50})^2}{10^{-2.148} \\cdot 10^{-7.198}} \\frac{0.37246}{1} = \\frac{10^{-15.00}}{10^{-9.346}} (0.37246) = 10^{-5.654} (0.37246) \\approx 8.26 \\times 10^{-7}$\n$T_1 = \\frac{10^{-7.50}}{10^{-7.198}} \\frac{0.37246}{0.78121} = 10^{-0.302} (0.47677) \\approx 0.49888 \\times 0.47677 \\approx 0.23787$\n$T_2 = 1$\n$T_3 = \\frac{10^{-12.375}}{10^{-7.50}} \\frac{0.37246}{0.10838} = 10^{-4.875} (3.4367) \\approx (1.3335 \\times 10^{-5}) \\times 3.4367 \\approx 4.583 \\times 10^{-5}$\n\n分母是这些项的和：\n$D = T_0 + T_1 + T_2 + T_3 \\approx (8.26 \\times 10^{-7}) + 0.23787 + 1 + (4.583 \\times 10^{-5}) \\approx 1.23792$\n\n分数 $\\alpha_3$ 是项 $T_3$ 与总和 $D$ 的比值：\n$$\\alpha_3 = \\frac{T_3}{D} = \\frac{4.583 \\times 10^{-5}}{1.23792} \\approx 3.7021 \\times 10^{-5}$$\n四舍五入到四位有效数字，我们得到 $3.702 \\times 10^{-5}$。转换为小数形式：\n$$\\alpha_3 = 0.00003702$$\n这反映了一个事实，即在 $\\mathrm{pH}=7.50$ 时，该值远低于有效的第三解离常数（$pK_{a3}' \\approx 11.8$），因此完全去质子化的物种 $A^{3-}$ 的分数预计会非常小。",
            "answer": "$$\\boxed{0.00003702}$$"
        },
        {
            "introduction": "尽管简单体系的平衡问题可以通过解析方法求解，但真实环境系统通常包含多种相互作用的酸、碱和盐，使得解析方法变得不切实际。本练习将展示解决此类复杂问题的现代计算方法，即通过构建电中性方程来耦合所有化学平衡，并使用牛顿-拉夫逊（Newton-Raphson）迭代法进行数值求解，从而确定系统的关键变量 pH 值。这项实践弥合了理想化的教科书问题与真实世界环境建模之间的鸿沟。",
            "id": "3867365",
            "problem": "考虑一个封闭、充分混合的水溶液体系，温度为 $25\\,^{\\circ}\\mathrm{C}$。在该体系中，质子转移反应遵循化学质量作用定律、水的自电离以及各元素的质量守恒。体系中含有水、溶解的无机碳、硼和总氨，以及作为固定背景阳离子和阴离子的非反应性强离子。待求的未知量是以 $\\mathrm{pH}$ 值度量的酸度，其定义为 $\\mathrm{pH} = -\\log_{10}([\\mathrm{H}^{+}])$，其中 $[\\mathrm{H}^{+}]$ 是氢离子的摩尔浓度，单位为 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$。\n\n基本依据是：\n- 电中性（电荷平衡）：在一个封闭水溶液中，正电荷之和等于负电荷之和。\n- 稀溶液条件下酸碱平衡的化学质量作用定律。\n- 在 $25\\,^{\\circ}\\mathrm{C}$ 时水的自电离。\n- 各守恒总量（例如，总无机碳）的质量守恒。\n\n假设在 $25\\,^{\\circ}\\mathrm{C}$ 下，以下平衡和定义成立：\n- 水的自电离：$K_w = [\\mathrm{H}^{+}][\\mathrm{OH}^{-}]$，其中 $K_w = 10^{-14}$。\n- 碳酸盐体系：$\\mathrm{H}_2\\mathrm{CO}_3 \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{HCO}_3^{-}$，其中 $K_1 = 10^{-6.3}$；以及 $\\mathrm{HCO}_3^{-} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{CO}_3^{2-}$，其中 $K_2 = 10^{-10.3}$；定义总溶解无机碳 $C_T = [\\mathrm{H}_2\\mathrm{CO}_3] + [\\mathrm{HCO}_3^{-}] + [\\mathrm{CO}_3^{2-}]$。\n- 硼体系：$\\mathrm{B(OH)}_3 + \\mathrm{H}_2\\mathrm{O} \\rightleftharpoons \\mathrm{B(OH)}_4^{-} + \\mathrm{H}^{+}$，其中 $K_B = 10^{-9.24}$；定义总硼 $B_T = [\\mathrm{B(OH)}_3] + [\\mathrm{B(OH)}_4^{-}]$。\n- 氨/铵体系：$\\mathrm{NH}_4^{+} \\rightleftharpoons \\mathrm{NH}_3 + \\mathrm{H}^{+}$，其酸度常数 $K_{a,\\mathrm{NH}_4} = 10^{-9.25}$；定义总氨 $N_T = [\\mathrm{NH}_3] + [\\mathrm{NH}_4^{+}]$。\n- 固定的不参与酸碱平衡的一价强阳离子浓度 $S_c$（例如，钠离子）和固定的一价强阴离子浓度 $S_a$（例如，氯离子）。\n\n对于给定的 $[\\mathrm{H}^{+}] = H$，各物种的浓度由平衡约束和总浓度决定：\n- $[\\mathrm{OH}^{-}] = K_w / H$。\n- 碳酸盐形态分数由质量作用定律和 $C_T$ 守恒推导得出，其分母为 $D(H) = H^2 + K_1 H + K_1 K_2$。则 $[\\mathrm{HCO}_3^{-}] = C_T \\,\\alpha_1(H)$ 和 $[\\mathrm{CO}_3^{2-}] = C_T \\,\\alpha_2(H)$，其中 $\\alpha_1(H) = \\dfrac{K_1 H}{D(H)}$ 且 $\\alpha_2(H) = \\dfrac{K_1 K_2}{D(H)}$。\n- 硼：$[\\mathrm{B(OH)}_4^{-}] = B_T \\,\\dfrac{K_B}{H + K_B}$。\n- 氨/铵：$[\\mathrm{NH}_4^{+}] = N_T \\,\\dfrac{H}{H + K_{a,\\mathrm{NH}_4}}$。\n\n电中性原则给出了耦合所有平衡的标量方程，\n$$\nf(H) \\equiv \\underbrace{H}_{[\\mathrm{H}^{+}]} + \\underbrace{S_c}_{\\text{固定阳离子}} + \\underbrace{N_T \\,\\frac{H}{H + K_{a,\\mathrm{NH}_4}}}_{[\\mathrm{NH}_4^{+}]} \\;-\\; \\underbrace{\\frac{K_w}{H}}_{[\\mathrm{OH}^{-}]} \\;-\\; \\underbrace{S_a}_{\\text{固定阴离子}} \\;-\\; \\underbrace{C_T \\,\\alpha_1(H)}_{[\\mathrm{HCO}_3^{-}]} \\;-\\; \\underbrace{2\\,C_T \\,\\alpha_2(H)}_{2[\\mathrm{CO}_3^{2-}]} \\;-\\; \\underbrace{B_T \\,\\frac{K_B}{H + K_B}}_{[\\mathrm{B(OH)}_4^{-}]} \\;=\\; 0.\n$$\n\n你的任务是通过在变量 H 上使用牛顿-拉夫逊法（Newton–Raphson method）求根来解 $f(H) = 0$，从而计算 $\\mathrm{pH}$。通过对 $f(H)$ 关于 $H$ 求导，推导出牛顿-拉夫逊迭代更新式 $H_{n+1} = H_n - f(H_n)/f'(H_n)$，并实现一个鲁棒的算法，确保 H 保持在物理上有意义的界限 $H \\in [10^{-14}, 10^{0}]$（对应 $\\mathrm{pH} \\in [14, 0]$）内。如果牛顿-拉夫逊法从中性初始猜测开始未能收敛，则在 $\\log_{10}(H)$ 上实现一个备用的区间搜索来定位符号变化，然后使用二分法收敛到根。\n\n所有浓度必须以 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$ 为单位处理，最终答案必须表示为 $\\mathrm{pH}$ 值。你的程序必须为每个测试用例生成一个四位小数的浮点数 $\\mathrm{pH}$ 值。要求的最终输出格式是单行输出，包含一个用方括号括起来的、以逗号分隔的 $\\mathrm{pH}$ 值列表，例如 $[\\mathrm{pH}_1,\\mathrm{pH}_2,\\mathrm{pH}_3]$。\n\n使用以下参数值测试套件（$(C_T,B_T,N_T,S_c,S_a)$，单位为 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$）：\n1. 案例 1（基线纯水）：$(0, 0, 0, 0, 0)$。\n2. 案例 2（不含固定强离子的封闭碳酸盐-硼体系）：$(2\\times 10^{-3}, 4\\times 10^{-4}, 0, 0, 0)$。\n3. 案例 3（具有过量固定阳离子和混合弱酸/弱碱的碱性趋势）：$(1\\times 10^{-3}, 4\\times 10^{-4}, 1\\times 10^{-5}, 1\\times 10^{-3}, 2\\times 10^{-4})$。\n4. 案例 4（具有过量固定阴离子和氨存在的酸性趋势）：$(1\\times 10^{-4}, 0, 1\\times 10^{-4}, 2\\times 10^{-4}, 1\\times 10^{-3})$。\n5. 案例 5（氨主导，无碳酸盐或硼，无固定强离子）：$(0, 0, 3\\times 10^{-3}, 0, 0)$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表（例如，$[x_1,x_2,x_3,x_4,x_5]$），其中每个 $x_i$ 是案例 $i$ 的 $\\mathrm{pH}$ 值，四舍五入到四位小数。",
            "solution": "问题的核心是通过求解一个从电中性原理推导出的非线性代数方程，来找到氢离子浓度，记为 $H \\equiv [\\mathrm{H}^{+}]$。然后根据其定义 $\\mathrm{pH} = -\\log_{10}(H)$ 计算 pH 值。\n\n电荷平衡方程要求所有阳离子浓度的和等于所有阴离子浓度的和（以电荷当量计）：\n$$[\\mathrm{H}^{+}] + [\\mathrm{NH}_4^{+}] + S_c = [\\mathrm{OH}^{-}] + [\\mathrm{HCO}_3^{-}] + 2[\\mathrm{CO}_3^{2-}] + [\\mathrm{B(OH)}_4^{-}] + S_a$$\n将问题中给出的各物种浓度表达式代入并整理，得到求根问题 $f(H) = 0$，其中残差函数 $f(H)$ 为：\n$$\nf(H) = H + S_c + N_T \\frac{H}{H + K_{a,\\mathrm{NH}_4}} - \\frac{K_w}{H} - S_a - C_T \\frac{K_1 H + 2 K_1 K_2}{H^2 + K_1 H + K_1 K_2} - B_T \\frac{K_B}{H + K_B}\n$$\n为了使用牛顿-拉夫逊法求解 $f(H) = 0$，我们需要其对 $H$ 的导数 $f'(H)$。迭代过程由 $H_{n+1} = H_n - f(H_n)/f'(H_n)$ 给出。对 $f(H)$ 的每一项求导，得到：\n$$\nf'(H) = 1 + \\frac{K_w}{H^2} + N_T \\frac{K_{a,\\mathrm{NH}_4}}{(H + K_{a,\\mathrm{NH}_4})^2} + C_T \\frac{K_1(H^2 + 4K_2H + K_1K_2)}{(H^2 + K_1H + K_1K_2)^2} + B_T \\frac{K_B}{(H + K_B)^2}\n$$\n函数 $f(H)$ 对于所有正实数 $H$ 是严格单调递增的（因为 $f'(H) > 0$），这保证了方程 $f(H)=0$ 有且仅有一个正实数解。\n\n数值求解算法采用一种鲁棒的混合策略：\n1.  首先尝试使用牛顿-拉夫逊法，它具有二次收敛速度，效率很高。从中性 pH 值的猜测 $H_0 = 10^{-7}$ 开始迭代。\n2.  在每次迭代中，检查新的猜测值是否仍在物理有效区间（例如 $10^{-14} \\le H \\le 1$）内。如果越界，则牛顿-拉夫逊法失败。\n3.  如果牛顿-拉夫逊法在预设的迭代次数内未能收敛，或者中途失败，则切换到更稳定但较慢的二分法。\n4.  二分法在保证包含根的区间 $[10^{-14}, 1]$ 内进行，通过不断将区间减半来可靠地逼近根。\n5.  一旦找到根 $H$，便通过 $\\mathrm{pH} = -\\log_{10}(H)$ 计算最终的 pH 值。\n\n对给定的五个测试用例执行此算法，计算出相应的 pH 值，并四舍五入到四位小数，得到最终结果。",
            "answer": "[7.0000,7.7475,8.7088,6.2625,10.5985]"
        },
        {
            "introduction": "在掌握了静态的化学平衡计算之后，我们将关注点转移到动态的化学动力学，即反应达到平衡状态的过程和速率。本练习旨在解决描述反应速率的常微分方程，特别是针对环境科学中常见的非线性蒙诺（Monod）速率定律。你将学习并应用一种强大而稳定的隐式数值方法——后向欧拉法（Backward Euler method）——来模拟化学物质浓度随时间的变化，这是构建和求解动态环境模型的关键技能。",
            "id": "3867366",
            "problem": "在一个充分混合的水体控制体积中，溶解性有机底物被微生物菌群根据饱和（Monod）速率定律进行生物降解。令 $C(t)$ 表示底物浓度，单位为 $\\mathrm{mol\\, m^{-3}}$。忽略输运并假设体积恒定，其质量平衡为\n$$\\frac{dC}{dt} \\;=\\; -r(C),$$\n其中体积反应速率 $r(C)$ 服从 Monod 形式\n$$r(C) \\;=\\; V_{\\max}\\,\\frac{C}{K + C},$$\n其中 $V_{\\max}$ 是最大体积消耗速率，$K$ 是半饱和常数。考虑使用后向欧拉时间积分法，从 $t_n$ 到 $t_{n+1}=t_n+\\Delta t$ 的单个隐式时间步长。从给定的常微分方程（ODE）出发，推导 $C_{n+1}$ 的后向欧拉离散更新式以及必须求解的相应非线性残差函数。然后，建立 Newton–Raphson 迭代格式，包括显式标量雅可比，以求解该隐式步骤。采用以下收敛标准：当绝对残差满足 $|F(C_{n+1}^{(k)})| \\le \\tau_F$ 或相对变化满足 $\\left|\\Delta C^{(k)}\\right|/\\left|C_{n+1}^{(k)}\\right| \\le \\tau_x$ 时，终止 Newton–Raphson 迭代，其中 $F$ 是残差，$\\Delta C^{(k)}$ 是第 $k$ 次迭代的 Newton 校正量，$(\\tau_F,\\tau_x)$ 是预设的容差。\n\n使用以下参数值\n$$V_{\\max} \\;=\\; 1.5 \\times 10^{-7},\\quad K \\;=\\; 1.0 \\times 10^{-4},\\quad C_n \\;=\\; 5.0 \\times 10^{-4},\\quad \\Delta t \\;=\\; 900,$$\n所有量均采用一致的国际单位制（SI），因此 $C$ 的单位是 $\\mathrm{mol\\, m^{-3}}$，时间单位是 $\\mathrm{s}$，以及容差\n$$\\tau_F \\;=\\; 1.0 \\times 10^{-8} \\quad \\text{和} \\quad \\tau_x \\;=\\; 1.0 \\times 10^{-8},$$\n从初始猜测值 $C_{n+1}^{(0)}=C_n$ 开始执行 Newton–Raphson 迭代，并计算满足所述收敛标准的更新后浓度 $C_{n+1}$。将最终数值答案四舍五入至四位有效数字。最终浓度以 $\\mathrm{mol\\, m^{-3}}$ 表示。",
            "solution": "### 解答推导\n\n**1. 后向欧拉离散化与残差函数**\n\n控制 ODE 为：\n$$\n\\frac{dC}{dt} = -V_{\\max}\\,\\frac{C}{K + C}\n$$\n应用后向欧拉法，我们在时间 $t_{n+1}$ 处近似时间导数，并在 $t_{n+1}$ 处计算右侧项：\n$$\n\\frac{C_{n+1} - C_n}{\\Delta t} = -V_{\\max}\\,\\frac{C_{n+1}}{K + C_{n+1}}\n$$\n这是关于 $C_{n+1}$ 的隐式离散更新方程。为了求解 $C_{n+1}$，我们通过重新整理方程使其等于零来定义一个残差函数 $F(C_{n+1})$：\n$$\nF(C_{n+1}) = C_{n+1} - C_n + \\Delta t \\, V_{\\max} \\, \\frac{C_{n+1}}{K + C_{n+1}} = 0\n$$\n这就是必须为 $C_{n+1}$ 求解的非线性代数方程。\n\n**2. Newton–Raphson 公式**\n\nNewton–Raphson 方法是一种迭代求根算法。对于标量函数 $F(x)$，迭代公式为：\n$$\nx^{(k+1)} = x^{(k)} - \\frac{F(x^{(k)})}{F'(x^{(k)})}\n$$\n在我们的问题中，$x$ 对应于 $C_{n+1}$。$C_{n+1}$ 的迭代公式为：\n$$\nC_{n+1}^{(k+1)} = C_{n+1}^{(k)} - \\frac{F(C_{n+1}^{(k)})}{J(C_{n+1}^{(k)})}\n$$\n其中 $k$ 是迭代指数，$J(C_{n+1})$ 是标量雅可比，即残差函数关于 $C_{n+1}$ 的导数，即 $J(C) = F'(C)$。\n\n我们来计算雅可比 $J(C)$：\n$$\nJ(C) = \\frac{d}{dC} F(C) = \\frac{d}{dC} \\left( C - C_n + \\Delta t \\, V_{\\max} \\, \\frac{C}{K + C} \\right)\n$$\n第一项 $C$ 的导数是 $1$。第二项 $-C_n$ 相对于 $C$ 是一个常数，所以其导数为 $0$。对于第三项，我们使用微分的商法则，$\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^2}$：\n$$\n\\frac{d}{dC}\\left(\\frac{C}{K + C}\\right) = \\frac{(1)(K + C) - (C)(1)}{(K + C)^2} = \\frac{K}{(K + C)^2}\n$$\n综合这些结果，雅可比为：\n$$\nJ(C) = 1 + \\Delta t \\, V_{\\max} \\, \\frac{K}{(K + C)^2}\n$$\n第 $k$ 次迭代的 Newton 校正量是 $\\Delta C^{(k)} = -F(C_{n+1}^{(k)})/J(C_{n+1}^{(k)})$，更新后的值为 $C_{n+1}^{(k+1)} = C_{n+1}^{(k)} + \\Delta C^{(k)}$。\n\n**3. 数值计算**\n\n给定以下数值：\n$V_{\\max} = 1.5 \\times 10^{-7}$, $K = 1.0 \\times 10^{-4}$, $C_n = 5.0 \\times 10^{-4}$, $\\Delta t = 900$。\n容差为 $\\tau_F = 1.0 \\times 10^{-8}$ 和 $\\tau_x = 1.0 \\times 10^{-8}$。初始猜测值为 $C_{n+1}^{(0)} = C_n = 5.0 \\times 10^{-4}$。\n\n**迭代 $k=0$**：\n$C_{n+1}^{(0)} = 5.0 \\times 10^{-4}$。\n$F(C_{n+1}^{(0)}) = (900 \\times 1.5 \\times 10^{-7}) \\frac{5.0 \\times 10^{-4}}{1.0 \\times 10^{-4} + 5.0 \\times 10^{-4}} = 1.125 \\times 10^{-4}$。\n$J(C_{n+1}^{(0)}) = 1 + (900 \\times 1.5 \\times 10^{-7}) \\frac{1.0 \\times 10^{-4}}{(1.0 \\times 10^{-4} + 5.0 \\times 10^{-4})^2} = 1 + 0.0375 = 1.0375$。\n$\\Delta C^{(0)} = -\\frac{1.125 \\times 10^{-4}}{1.0375} \\approx -1.08434 \\times 10^{-4}$。\n$C_{n+1}^{(1)} = 5.0 \\times 10^{-4} - 1.08434 \\times 10^{-4} = 3.91566 \\times 10^{-4}$。\n\n**迭代 $k=1$**：\n$C_{n+1}^{(1)} = 3.91566 \\times 10^{-4}$。\n$F(C_{n+1}^{(1)}) = 3.91566 \\times 10^{-4} - 5.0 \\times 10^{-4} + (1.35 \\times 10^{-4}) \\frac{3.91566 \\times 10^{-4}}{1.0 \\times 10^{-4} + 3.91566 \\times 10^{-4}} \\approx -8.98 \\times 10^{-7}$。\n$J(C_{n+1}^{(1)}) \\approx 1 + 0.05587 = 1.05587$。\n$\\Delta C^{(1)} = -\\frac{-8.98 \\times 10^{-7}}{1.05587} \\approx 8.50 \\times 10^{-7}$。\n$C_{n+1}^{(2)} = 3.91566 \\times 10^{-4} + 8.50 \\times 10^{-7} = 3.92416 \\times 10^{-4}$。\n\n**迭代 $k=2$**：\n$C_{n+1}^{(2)} = 3.92416 \\times 10^{-4}$。\n$F(C_{n+1}^{(2)}) = 3.92416 \\times 10^{-4} - 5.0 \\times 10^{-4} + (1.35 \\times 10^{-4}) \\frac{3.92416 \\times 10^{-4}}{1.0 \\times 10^{-4} + 3.92416 \\times 10^{-4}} \\approx 7.5 \\times 10^{-10}$。\n由于 $|F(C_{n+1}^{(2)})| \\approx 7.5 \\times 10^{-10} \\le \\tau_F = 1.0 \\times 10^{-8}$，收敛标准已满足。迭代终止。\n\n在时间 $t_{n+1}$ 处浓度的收敛值为 $C_{n+1} \\approx 3.92416 \\times 10^{-4} \\, \\mathrm{mol\\, m^{-3}}$。\n按要求将结果四舍五入至四位有效数字：\n$C_{n+1} \\approx 3.924 \\times 10^{-4} \\, \\mathrm{mol\\, m^{-3}}$。",
            "answer": "$$\\boxed{3.924 \\times 10^{-4}}$$"
        }
    ]
}