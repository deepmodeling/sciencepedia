{
    "hands_on_practices": [
        {
            "introduction": "守恒定律的积分形式是环境建模的基石。本练习旨在通过对一个理想化的沿海控制体进行直接的质量平衡计算，来巩固对连续性方程积分形式的理解。通过亲手核算跨越边界的平流输运、地表和底部的通量交换，以及内部的源汇项，您将能够清晰地看到系统总质量的变化是如何由这些分力共同决定的 。这项基本技能对于验证复杂模型的输出或进行快速的初步估算至关重要。",
            "id": "3921745",
            "problem": "一个沿海海湾被理想化为一个矩形控制体，其水平坐标为 $x \\in [0,L]$、$y \\in [0,W]$，垂直坐标为 $z \\in [0,H]$，从海床向上测量。一种总质量为 $M(t)$ 的守恒溶解示踪剂通过开放的侧向边界输运，在海气界面沉积，在沉积物-水界面被吸收，并通过水体内的体源产生。假设所有过程在时间步长 $[t_{0},t_{0}+\\Delta t]$ 内是时间恒定的，在指定区域内是空间均匀的，并且在科学上是一致的。\n\n几何与时间参数：\n- $L = 5000\\,\\mathrm{m}$，$W = 2000\\,\\mathrm{m}$，$H = 15\\,\\mathrm{m}$。\n- $\\Delta t = 2.0\\,\\text{小时}$。\n\n边界通量和内部源（符号约定：正值表示域内质量增加；负值表示其减少）：\n- 穿过西部开放边界的时间平均积分侧向通量率：$F_{\\mathrm{W}} = +1.80 \\times 10^{4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$。\n- 穿过东部开放边界的时间平均积分侧向通量率：$F_{\\mathrm{E}} = -2.10 \\times 10^{4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$。\n- 表面的均匀沉积通量密度：$q_{\\mathrm{surf}} = +3.50 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，作用于面积 $A_{\\mathrm{surf}} = L W$。\n- 海床的均匀吸收通量密度：$q_{\\mathrm{bot}} = -1.20 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，作用于面积 $A_{\\mathrm{bot}} = L W$。\n- 内部的体源分布：$s(x,y,z) = s_{0}\\,\\bigl[1 + \\alpha\\,(x/L) + \\beta\\,(y/W)\\bigr]\\,(z/H)$，其中 $s_{0} = 2.00 \\times 10^{-8}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，$\\alpha = 0.25$，$\\beta = -0.10$。\n\n从质量守恒的基本原理以及通量和源的定义出发，通过一致地汇总侧向边界贡献、表面和底部通量以及积分体源，计算时间步长内的总质量变化 $\\Delta M = M(t_{0}+\\Delta t) - M(t_{0})$。以 $\\mathrm{kg}$ 为单位表示最终结果，并将答案四舍五入到四位有效数字。",
            "solution": "本题要求计算在一个指定的时间间隔 $\\Delta t$ 内，一个特定的矩形控制体中守恒示踪剂的总质量变化 $\\Delta M$。其控制原理是质量守恒定律，对于控制体 $V$，该定律可以以其积分形式表示。控制体内总质量 $M(t)$ 的变化率是穿过其边界的所有质量通量以及所有内部源和汇的总和。\n总质量变化率 $\\frac{dM}{dt}$ 是所有贡献过程速率的代数和：\n$$ \\frac{dM}{dt} = F_{\\mathrm{lateral}} + F_{\\mathrm{surf/bot}} + S_{\\mathrm{total}} $$\n等式右边的各项分别代表由侧向边界通量、表面和底部通量以及积分体源引起的净变化率。题目指定了一个符号约定，其中正值对应于域内质量的增加。\n由于假设所有通量和源率在时间步长 $\\Delta t = t_{0}+\\Delta t - t_{0}$ 内是恒定的，总质量变化 $\\Delta M = M(t_{0}+\\Delta t) - M(t_{0})$ 可以通过将恒定的总变化率乘以时间步长的持续时间来计算：\n$$ \\Delta M = \\left(\\frac{dM}{dt}\\right) \\times \\Delta t $$\n我们接下来计算对总速率 $\\frac{dM}{dt}$ 的各项贡献。\n\n1. 净侧向通量率\n题目给出了穿过西部和东部边界的时间平均积分质量通量率。北部和南部边界被默认为是封闭的（无通量）。\n-   西部边界通量：$F_{\\mathrm{W}} = +1.80 \\times 10^{4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$\n-   东部边界通量：$F_{\\mathrm{E}} = -2.10 \\times 10^{4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$\n净侧向通量率是这两项贡献的总和：\n$$ F_{\\mathrm{lateral}} = F_{\\mathrm{W}} + F_{\\mathrm{E}} = (1.80 \\times 10^{4}) + (-2.10 \\times 10^{4})\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = -0.30 \\times 10^{4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = -3000\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\n\n2. 净表面和底部通量率\n海气界面（表面）和沉积物-水界面（底部）的通量以通量密度（单位面积单位时间的质量）的形式给出。为了求得总通量率，我们将这些密度乘以它们作用的水平面积 $A = L \\times W$。\n-   面积：$A = (5000\\,\\mathrm{m})(2000\\,\\mathrm{m}) = 1.0 \\times 10^{7}\\,\\mathrm{m}^2$\n-   表面沉积通量密度：$q_{\\mathrm{surf}} = +3.50 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n-   底部吸收通量密度：$q_{\\mathrm{bot}} = -1.20 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n由表面通量引起的总质量变化率是：\n$$ F_{\\mathrm{surf}} = q_{\\mathrm{surf}} \\times A = (3.50 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}) \\times (1.0 \\times 10^{7}\\,\\mathrm{m}^2) = 35.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\n由底部通量引起的总质量变化率是：\n$$ F_{\\mathrm{bot}} = q_{\\mathrm{bot}} \\times A = (-1.20 \\times 10^{-6}\\,\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}) \\times (1.0 \\times 10^{7}\\,\\mathrm{m}^2) = -12.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\n来自这两个边界的净通量率是：\n$$ F_{\\mathrm{surf/bot}} = F_{\\mathrm{surf}} + F_{\\mathrm{bot}} = 35.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} - 12.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = 23.0\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\n\n3. 积分体源率\n体源项 $s(x,y,z)$ 是空间变化的，必须在整个控制体 $V = LWH = (5000\\,\\mathrm{m})(2000\\,\\mathrm{m})(15\\,\\mathrm{m}) = 1.5 \\times 10^{8}\\,\\mathrm{m}^3$ 上进行积分。总源率 $S_{\\mathrm{total}}$ 是：\n$$ S_{\\mathrm{total}} = \\int_V s(x,y,z) \\,dV = \\int_{0}^{H} \\int_{0}^{W} \\int_{0}^{L} s_{0}\\,\\left[1 + \\alpha\\,\\frac{x}{L} + \\beta\\,\\frac{y}{W}\\right]\\,\\frac{z}{H} \\, dx \\, dy \\, dz $$\n该积分在 $z$ 和 $(x,y)$ 对上是可分离的：\n$$ S_{\\mathrm{total}} = \\frac{s_0}{H} \\left( \\int_{0}^{H} z \\, dz \\right) \\left( \\int_{0}^{W} \\int_{0}^{L} \\left(1 + \\frac{\\alpha x}{L} + \\frac{\\beta y}{W}\\right) dx \\, dy \\right) $$\n计算各个积分：\n$$ \\int_{0}^{H} z \\, dz = \\left[\\frac{z^2}{2}\\right]_{0}^{H} = \\frac{H^2}{2} $$\n$$ \\int_{0}^{W} \\int_{0}^{L} \\left(1 + \\frac{\\alpha x}{L} + \\frac{\\beta y}{W}\\right) dx \\, dy = \\int_{0}^{W} \\left[x + \\frac{\\alpha x^2}{2L} + \\frac{\\beta y x}{W}\\right]_{x=0}^{x=L} dy = \\int_{0}^{W} \\left(L + \\frac{\\alpha L}{2} + \\frac{\\beta L y}{W}\\right) dy $$\n$$ = \\left[Ly + \\frac{\\alpha L y}{2} + \\frac{\\beta L y^2}{2W}\\right]_{y=0}^{y=W} = LW + \\frac{\\alpha LW}{2} + \\frac{\\beta LW}{2} = LW\\left(1 + \\frac{\\alpha + \\beta}{2}\\right) $$\n合并各项，我们得到：\n$$ S_{\\mathrm{total}} = \\frac{s_0}{H} \\left(\\frac{H^2}{2}\\right) \\left(LW\\left(1 + \\frac{\\alpha + \\beta}{2}\\right)\\right) = \\frac{s_0 LWH}{2} \\left(1 + \\frac{\\alpha + \\beta}{2}\\right) $$\n代入给定值：$s_{0} = 2.00 \\times 10^{-8}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，$V = LWH = 1.5 \\times 10^{8}\\,\\mathrm{m}^3$，$\\alpha = 0.25$，$\\beta = -0.10$。\n$$ S_{\\mathrm{total}} = \\frac{(2.00 \\times 10^{-8}\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1})(1.5 \\times 10^{8}\\,\\mathrm{m}^3)}{2} \\left(1 + \\frac{0.25 - 0.10}{2}\\right) $$\n$$ S_{\\mathrm{total}} = \\frac{3.00}{2} \\left(1 + \\frac{0.15}{2}\\right) \\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = 1.5 \\times (1 + 0.075) \\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = 1.5 \\times 1.075 \\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = 1.6125\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\n\n4. 总质量变化率\n总质量变化率是所有计算分量的总和：\n$$ \\frac{dM}{dt} = F_{\\mathrm{lateral}} + F_{\\mathrm{surf/bot}} + S_{\\mathrm{total}} $$\n$$ \\frac{dM}{dt} = (-3000) + (23.0) + (1.6125) \\,\\mathrm{kg}\\,\\mathrm{s}^{-1} = -2975.3875\\,\\mathrm{kg}\\,\\mathrm{s}^{-1} $$\n\n5. 总质量变化\n总质量变化 $\\Delta M$ 是通过将此速率乘以时间步长 $\\Delta t = 2.0\\,\\text{小时} = 2.0 \\times 3600\\,\\mathrm{s} = 7200\\,\\mathrm{s}$ 得到的。\n$$ \\Delta M = \\left(\\frac{dM}{dt}\\right) \\times \\Delta t = (-2975.3875\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}) \\times (7200\\,\\mathrm{s}) = -21422790\\,\\mathrm{kg} $$\n按要求将结果四舍五入到四位有效数字：\n$$ \\Delta M \\approx -2.142 \\times 10^{7}\\,\\mathrm{kg} $$",
            "answer": "$$\\boxed{-2.142 \\times 10^{7}}$$"
        },
        {
            "introduction": "掌握了静态的质量平衡计算后，下一步是将其应用于动态系统，模拟其随时间的变化。本练习要求您从质量守恒第一性原理出发，为一个具有非线性几何特征的潮汐盆地推导并实现一个时间演化模型 。通过编写代码来模拟水位的变化，您不仅能将抽象的守恒定律（即 $\\frac{dV}{dt} = Q_{\\text{in}} - Q_{\\text{out}}$）转化为可执行的算法，还将直接处理真实世界建模中常见的挑战，例如随水位变化的表面积以及确保水量非负的物理约束。",
            "id": "3921740",
            "problem": "一个充分混合的潮汐盆地被表示为一个单一的控制体，其水平自由表面的高程（相对于盆地底部）用 $h(t)$ 表示，单位为 $\\mathrm{m}$。该盆地接收一个特定的入流过程线 $Q_{\\text{in}}(t)$（单位 $\\mathrm{m^3/s}$），并通过大气蒸发失水，蒸发表示为单位面积通量 $E(t)$（单位 $\\mathrm{m/s}$）；不存在其他源项或汇项。盆地的测深数据定义了湿润表面积 $A(h)$（单位 $\\mathrm{m^2}$）作为自由表面高程 $h$ 的函数，其分段线性定义如下：\n- 当 $0 \\le h \\le h_1$ 时：$A(h) = s_1 h$。\n- 当 $h_1  h \\le h_2$ 时：$A(h) = s_1 h_1 + s_2 (h - h_1)$。\n- 当 $h > h_2$ 时：$A(h) = s_1 h_1 + s_2 (h_2 - h_1) + s_3 (h - h_2)$。\n此处，$h_1$ 和 $h_2$ 是正高程，单位为 $\\mathrm{m}$；$s_1$、$s_2$、$s_3$ 是正斜率，单位为 $\\mathrm{m^2/m}$。\n\n从基本的质量守恒定律以及体积与面积之间的几何关系出发，推导出一个算法来计算在有限时间范围内 $h(t)$ 的时间演化。盆地的水体体积 $V(t)$（单位 $\\mathrm{m^3}$）绝不能为负，且当 $V(t)=0$ 时，对应的自由表面高程为 $h(t)=0$。\n\n入流过程线由 $Q_{\\text{in}}(t) = Q_0 + Q_1 \\sin\\left( \\frac{2\\pi t}{P} \\right)$ 给出，其中 $Q_0$ 和 $Q_1$ 的单位为 $\\mathrm{m^3/s}$，潮汐周期 $P$ 的单位为 $\\mathrm{s}$。蒸发通量由 $E(t) = e_0 + e_1 \\cos\\left( \\frac{2\\pi t}{D} \\right)$ 给出，其中 $D = 86400$ 是一天的持续时间，单位为 $\\mathrm{s}$；$e_0$ 和 $e_1$ 以 $\\mathrm{mm/day}$ 为单位指定，使用前必须转换为 $\\mathrm{m/s}$。\n\n仅基于上述质量守恒原理和测深几何形状，使用固定时间步长 $\\Delta t$（单位 $\\mathrm{s}$）在有限时间范围 $T$（单位 $\\mathrm{s}$）内，实现一个数值时间推进解法。程序不得接受任何外部输入；它必须在内部定义并评估以下三个测试用例，每个用例使用相同的测深数据，但具有不同的入流过程线和蒸发参数。对于每个用例，计算并报告最终的自由表面高程 $h(T)$（单位 $\\mathrm{m}$），四舍五入到三位小数。\n\n所有用例共用的测深参数：\n- $h_1 = 2.0$（单位 $\\mathrm{m}$），$h_2 = 4.0$（单位 $\\mathrm{m}$）。\n- $s_1 = 5.0 \\times 10^5$（单位 $\\mathrm{m^2/m}$），$s_2 = 1.5 \\times 10^6$（单位 $\\mathrm{m^2/m}$），$s_3 = 6.0 \\times 10^6$（单位 $\\mathrm{m^2/m}$）。\n\n所有用例共用的时间积分参数：\n- $T = 432000$（单位 $\\mathrm{s}$）（五天）。\n- $\\Delta t = 300$（单位 $\\mathrm{s}$）。\n\n测试用例 1（一般变化情况的“理想路径”）：\n- 初始高程 $h(0) = 1.0$（单位 $\\mathrm{m}$）。\n- 入流：$Q_0 = 120$（单位 $\\mathrm{m^3/s}$），$Q_1 = 80$（单位 $\\mathrm{m^3/s}$），$P = 44712$（单位 $\\mathrm{s}$）。\n- 蒸发：$e_0 = 4.0$（单位 $\\mathrm{mm/day}$），$e_1 = 1.5$（单位 $\\mathrm{mm/day}$）。\n\n测试用例 2（以蒸发为主导且可能干涸的边界情况）：\n- 初始高程 $h(0) = 0.3$（单位 $\\mathrm{m}$）。\n- 入流：$Q_0 = 0$（单位 $\\mathrm{m^3/s}$），$Q_1 = 0$（单位 $\\mathrm{m^3/s}$），$P = 44712$（单位 $\\mathrm{s}$）。\n- 蒸发：$e_0 = 6.0$（单位 $\\mathrm{mm/day}$），$e_1 = 2.0$（单位 $\\mathrm{mm/day}$）。\n\n测试用例 3（强入流弱蒸发情况）：\n- 初始高程 $h(0) = 1.5$（单位 $\\mathrm{m}$）。\n- 入流：$Q_0 = 800$（单位 $\\mathrm{m^3/s}$），$Q_1 = 300$（单位 $\\mathrm{m^3/s}$），$P = 44712$（单位 $\\mathrm{s}$）。\n- 蒸发：$e_0 = 3.0$（单位 $\\mathrm{mm/day}$），$e_1 = 1.0$（单位 $\\mathrm{mm/day}$）。\n\n您的程序必须生成单行输出，其中包含三个最终高程，格式为以方括号括起来的逗号分隔列表，顺序为测试用例 1、测试用例 2、测试用例 3。例如，输出格式必须与 $[h_1,h_2,h_3]$ 完全相同，其中每个 $h_i$ 是一个四舍五入到三位小数的十进制数，单位为 $\\mathrm{m}$。",
            "solution": "该解法基于控制体的质量守恒原理。\n\n质量守恒方程的积分形式，也称为对于体积 $V$ 随时间变化的控制体的连续性方程，由下式给出：\n$$\n\\frac{dV}{dt} = \\sum Q_{\\text{in}} - \\sum Q_{\\text{out}}\n$$\n其中 $\\sum Q_{\\text{in}}$ 是所有体积流入率的总和，$\\sum Q_{\\text{out}}$ 是所有体积流出率的总和。\n\n对于所描述的潮汐盆地，唯一的入流是过程线 $Q_{\\text{in}}(t)$。唯一的出流是由蒸发引起的，蒸发以单位面积通量 $E(t)$ 的形式给出。因此，由蒸发引起的总体积流出率是通量乘以湿润表面积 $A(h(t))$。所以，盆地的质量平衡方程为：\n$$\n\\frac{dV}{dt} = Q_{\\text{in}}(t) - E(t)A(h(t))\n$$\n题目通过一个关于表面积 $A(h)$ 的分段线性关系来定义盆地的几何形状。盆地的体积 $V(h)$ 可以通过将面积函数从底部（$h=0$）积分到自由表面高程 $h$ 来确定：\n$$\nV(h) = \\int_0^h A(h') dh'\n$$\n给定 $A(h)$ 的分段定义：\n- 当 $0 \\le h \\le h_1$ 时：$A(h) = s_1 h$\n- 当 $h_1  h \\le h_2$ 时：$A(h) = A(h_1) + s_2 (h - h_1)$，其中 $A(h_1) = s_1 h_1$\n- 当 $h > h_2$ 时：$A(h) = A(h_2) + s_3 (h - h_2)$，其中 $A(h_2) = s_1 h_1 + s_2 (h_2 - h_1)$\n\n执行积分可得到体积 $V(h)$ 的分段函数：\n- 当 $0 \\le h \\le h_1$ 时：\n  $$ V(h) = \\int_0^h s_1 h' dh' = \\frac{1}{2} s_1 h^2 $$\n- 当 $h_1  h \\le h_2$ 时：\n  $$ V(h) = V(h_1) + \\int_{h_1}^h [s_1 h_1 + s_2 (h' - h_1)] dh' = V(h_1) + s_1 h_1 (h - h_1) + \\frac{1}{2} s_2 (h - h_1)^2 $$\n  其中 $V(h_1) = \\frac{1}{2} s_1 h_1^2$。\n- 当 $h > h_2$ 时：\n  $$ V(h) = V(h_2) + \\int_{h_2}^h [A(h_2) + s_3 (h' - h_2)] dh' = V(h_2) + A(h_2) (h - h_2) + \\frac{1}{2} s_3 (h - h_2)^2 $$\n  其中 $V(h_2)$ 是高程 $h_2$ 处的体积。\n\n为了对问题进行数值求解，我们使用固定时间步长 $\\Delta t$ 的前向欧拉法，对基于体积的微分方程进行时间离散化。设 $V_n$ 为时间 $t_n = n \\Delta t$ 时的体积。下一个时间步的体积 $V_{n+1}$ 近似为：\n$$\nV_{n+1} = V_n + \\Delta t \\left( Q_{\\text{in}}(t_n) - E(t_n)A(h_n) \\right)\n$$\n其中 $h_n$ 是与体积 $V_n$ 对应的高程。题目施加了体积不能为负的物理约束，因此我们必须强制 $V_{n+1} \\ge 0$。\n\n数值算法的核心是一个时间推进循环，其中系统的状态是其体积 $V(t)$。\n该算法的步骤如下：\n1.  在 $t=0$ 时初始化模拟。给定初始高程 $h(0)$，使用分段函数 $V(h)$ 计算初始体积 $V_0 = V(h(0))$。\n2.  对每个时间步 $n=0, 1, 2, \\dots, N-1$（其中 $N = T/\\Delta t$）进行迭代。在每个步骤中：\n    a. 设当前状态为体积 $V_n$。\n    b. 通过反解 $V(h)$ 关系计算相应的高程 $h_n$。这需要给定 $V_n$ 求解 $h$。\n    c. 使用分段函数 $A(h)$ 计算表面积 $A_n = A(h_n)$。\n    d. 计算在时间 $t_n = n \\Delta t$ 时的强迫项：$Q_{\\text{in}}(t_n)$ 和 $E(t_n)$。蒸发率 $e_0$ 和 $e_1$ 的单位为 $\\mathrm{mm/day}$，必须通过乘以因子 $\\frac{10^{-3} \\mathrm{m/mm}}{86400 \\mathrm{s/day}}$ 转换为 $\\mathrm{m/s}$。\n    e. 更新体积：$V_{n+1} = V_n + \\Delta t (Q_{\\text{in}}(t_n) - E(t_n) A_n)$。\n    f. 施加非负约束：$V_{n+1} = \\max(0, V_{n+1})$。\n    g. 新的状态是 $V_{n+1}$。\n3.  完成所有时间步后，最终体积为 $V_N$。最终高程 $h(T)$ 通过对 $V_N$ 反解 $V(h)$ 关系来计算。\n\n反解 $V(h)$ 以求得 $h(V)$ 的过程至关重要。设 $V_1 = V(h_1)$ 和 $V_2 = V(h_2)$ 为转换高程处的体积。\n- 当 $0 \\le V \\le V_1$ 时：\n  $$ h = \\sqrt{\\frac{2V}{s_1}} $$\n- 当 $V_1  V \\le V_2$ 时：$V = V_1 + s_1 h_1 (h - h_1) + \\frac{1}{2} s_2 (h - h_1)^2$。这是一个关于 $\\delta h = h - h_1$ 的二次方程。具有物理意义的解是：\n  $$ h = h_1 + \\frac{-s_1 h_1 + \\sqrt{(s_1 h_1)^2 + 2s_2(V - V_1)}}{s_2} $$\n- 当 $V > V_2$ 时：$V = V_2 + A(h_2) (h - h_2) + \\frac{1}{2} s_3 (h - h_2)^2$。这是一个关于 $\\delta h = h - h_2$ 的二次方程。解是：\n  $$ h = h_2 + \\frac{-A(h_2) + \\sqrt{A(h_2)^2 + 2s_3(V - V_2)}}{s_3} $$\n这个完整的算法将被实施，以求解三个测试用例中每一个的最终高程 $h(T)$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the final water surface elevation in a tidal basin for three test cases.\n    \"\"\"\n\n    # --- Global Parameters ---\n    # Bathymetry parameters (m, m^2/m)\n    h1, h2 = 2.0, 4.0\n    s1, s2, s3 = 5.0e5, 1.5e6, 6.0e6\n    \n    # Time integration parameters (s)\n    T = 432000.0  # Total simulation time (5 days)\n    dt = 300.0     # Time step\n\n    # Physical constants\n    D = 86400.0  # Duration of one day (s)\n    MM_DAY_TO_M_S = 1e-3 / 86400.0  # Conversion from mm/day to m/s\n\n    class Bathymetry:\n        \"\"\"\n        Encapsulates the bathymetric properties of the basin.\n        \"\"\"\n        def __init__(self, s1, s2, s3, h1, h2):\n            self.s1, self.s2, self.s3 = s1, s2, s3\n            self.h1, self.h2 = h1, h2\n\n            # Pre-calculate transition areas and volumes\n            self.A1 = self.s1 * self.h1\n            self.V1 = 0.5 * self.s1 * self.h1**2\n            \n            self.A2 = self.A1 + self.s2 * (self.h2 - self.h1)\n            self.V2 = self.V1 + self.A1 * (self.h2 - self.h1) + 0.5 * self.s2 * (self.h2 - self.h1)**2\n\n        def get_area_from_h(self, h):\n            \"\"\"Computes surface area A from elevation h.\"\"\"\n            if h = 0:\n                return 0.0\n            elif h = self.h1:\n                return self.s1 * h\n            elif h = self.h2:\n                return self.A1 + self.s2 * (h - self.h1)\n            else:\n                return self.A2 + self.s3 * (h - self.h2)\n        \n        def get_volume_from_h(self, h):\n            \"\"\"Computes volume V from elevation h.\"\"\"\n            if h = 0:\n                return 0.0\n            elif h = self.h1:\n                return 0.5 * self.s1 * h**2\n            elif h = self.h2:\n                return self.V1 + self.A1 * (h - self.h1) + 0.5 * self.s2 * (h - self.h1)**2\n            else:\n                return self.V2 + self.A2 * (h - self.h2) + 0.5 * self.s3 * (h - self.h2)**2\n\n        def get_h_from_volume(self, V):\n            \"\"\"Computes elevation h from volume V by inverting the V(h) relationship.\"\"\"\n            if V = 0:\n                return 0.0\n            elif V = self.V1:\n                return np.sqrt(2 * V / self.s1)\n            elif V = self.V2:\n                # Solve quadratic equation for (h-h1)\n                delta_h = (-self.A1 + np.sqrt(self.A1**2 + 2 * self.s2 * (V - self.V1))) / self.s2\n                return self.h1 + delta_h\n            else:\n                # Solve quadratic equation for (h-h2)\n                delta_h = (-self.A2 + np.sqrt(self.A2**2 + 2 * self.s3 * (V - self.V2))) / self.s3\n                return self.h2 + delta_h\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        # Case 1: General variability\n        {'h0': 1.0, 'Q0': 120.0, 'Q1': 80.0, 'P': 44712.0, 'e0': 4.0, 'e1': 1.5},\n        # Case 2: Evaporation-dominated\n        {'h0': 0.3, 'Q0': 0.0, 'Q1': 0.0, 'P': 44712.0, 'e0': 6.0, 'e1': 2.0},\n        # Case 3: Strong inflow\n        {'h0': 1.5, 'Q0': 800.0, 'Q1': 300.0, 'P': 44712.0, 'e0': 3.0, 'e1': 1.0},\n    ]\n\n    results = []\n    \n    # Instantiate the common bathymetry model\n    basin_bathy = Bathymetry(s1, s2, s3, h1, h2)\n\n    for case in test_cases:\n        # --- Simulation Setup ---\n        # Unpack parameters\n        h0 = case['h0']\n        Q0, Q1, P = case['Q0'], case['Q1'], case['P']\n        e0_conv = case['e0'] * MM_DAY_TO_M_S\n        e1_conv = case['e1'] * MM_DAY_TO_M_S\n\n        # Initial state\n        V = basin_bathy.get_volume_from_h(h0)\n        \n        # --- Time-Marching Loop ---\n        num_steps = int(T / dt)\n        for n in range(num_steps):\n            t = n * dt\n            \n            # Get h and A from the current state V\n            h = basin_bathy.get_h_from_volume(V)\n            A = basin_bathy.get_area_from_h(h)\n            \n            # Calculate forcing terms\n            Qin = Q0 + Q1 * np.sin(2 * np.pi * t / P)\n            E = e0_conv + e1_conv * np.cos(2 * np.pi * t / D)\n            \n            # Update volume using Forward Euler\n            V_next = V + dt * (Qin - E * A)\n            \n            # Enforce non-negativity constraint\n            V = max(0.0, V_next)\n\n        # --- Final Result ---\n        h_final = basin_bathy.get_h_from_volume(V)\n        results.append(round(h_final, 3))\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "当我们将连续性方程从适用于整个控制体的积分形式，发展为描述空间每一点变化的微分形式时，数值求解会带来新的挑战。本练习聚焦于求解平流项时一个至关重要的问题：许多高阶数值格式在数学上虽然精确，却可能产生非物理的“过冲”和“下冲”振荡 。通过一个具体的计算示例，您将亲眼见证这一现象的发生，并理解为什么需要引入通量限制器（flux limiters）等技术来保证解的物理真实性（如单调性），同时严格维持质量守恒。",
            "id": "3921743",
            "problem": "考虑一个一维守恒示踪剂 $c(x,t)$，它在一个直通道中以一个恒定的正速度 $u>0$ 平流。其控制定律是已知流场平流被动示踪剂的连续性方程，该方程指出，任何固定控制体积内示踪剂的变化率等于进入该体积的净平流通量。对于一个由 $N$ 个宽度为 $\\Delta x$ 的单元组成的均匀网格，在时间 $t^n$ 的单元平均值为 $c_i^n$，其有限体积更新是通过在每个单元上对连续性方程进行积分，并应用散度定理将变化量写为穿过单元面的通量差来获得的。将单元面通量记为 $F_{i+1/2}^n$，并考虑显式更新 $c_i^{n+1} = c_i^n - (\\Delta t/\\Delta x)\\left(F_{i+1/2}^n - F_{i-1/2}^n\\right)$，其中对于 $u>0$，平流通量 $F_{i+1/2}^n$ 近似为 $F_{i+1/2}^n = u\\,c_{i+1/2}^n$，而 $c_{i+1/2}^n$ 是根据相邻单元平均值重构的单元面值。\n\n假设网格有 $N=4$ 个内部单元，索引为 $i=1,2,3,4$，在面 $x_{1/2}$ 和 $x_{9/2}$ 处的区域边界上为零流入和流出，因此 $F_{1/2}^n=F_{9/2}^n=0$。考虑以下用于 $u>0$ 的无限制迎风偏置二阶重构：\n$$\nc_{i+1/2}^n \\equiv c_i^n + \\frac{1}{2}\\left(c_i^n - c_{i-1}^n\\right), \\quad \\text{for } i=1,2,3,4,\n$$\n需要理解的是，在左边界，由于 $c_0^n=0$ 且没有流入，重构简化为 $c_{1/2}^n=0$。\n\n假设在时间 $t^n$ 的初始数据为 $c_1^n=0$、 $c_2^n=1$、 $c_3^n=0$、 $c_4^n=0$，并选择库朗数 $\\nu=u\\Delta t/\\Delta x=0.6$。使用上述有限体积更新公式和 $F_{i+1/2}^n = u\\,c_{i+1/2}^n$，计算 $i=1,2,3,4$ 的单步更新值 $c_i^{n+1}$。基于计算结果以及平流输运的守恒性和单调性控制原理，选择所有正确的陈述：\n\nA. 所述的迎风偏置重构方案能够对总示踪剂质量进行守恒更新，但对于给定的初始条件和 $\\nu=0.6$，会产生新的极值（上冲和下冲）。\n\nB. 因为更新表示为每个单元的通量差，所以不会引入初始范围 $[0,1]$ 之外的值；单调性被自动保持。\n\nC. 在保守律的单调迎风格式（MUSCL）中引入一个通量限制器，该限制器在每个单元面上（对于 $u>0$）强制 $c_{i+1/2}^n \\in [\\min(c_{i-1}^n, c_i^n), \\max(c_{i-1}^n, c_i^n)]$，可以在 $0  \\nu \\le 1$ 的情况下保持有界性（没有新的上冲或下冲），同时通过有限体积通量差更新保持守恒性。\n\nD. 通量限制器必然会破坏守恒性，因为它们在每个单元面上改变通量值的方式对于左右相邻的单元是不同的。\n\nE. 可以构建一个总变差减小（TVD）限制器，使得对于 $0  \\nu \\le 1$，该格式在光滑区域是二阶精度的，在极值附近退化为一阶精度，从而在保持示踪剂质量的同时防止伪振荡。\n\n选择所有正确的选项。",
            "solution": "用户提供了一个关于使用有限体积法数值求解一维平流方程的问题。我将首先验证问题陈述，然后进行完整的求解并评估给定的选项。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   **控制定律：** 一维守恒示踪剂 $c(x,t)$ 以恒定的正速度 $u>0$ 平流。控制原理是连续性方程。\n-   **数值方法：** 在由 $N=4$ 个宽度为 $\\Delta x$ 的单元组成的均匀网格上的有限体积格式。\n-   **更新公式：** $c_i^{n+1} = c_i^n - (\\Delta t/\\Delta x)\\left(F_{i+1/2}^n - F_{i-1/2}^n\\right)$，对于单元 $i=1,2,3,4$。\n-   **通量公式：** $F_{i+1/2}^n = u\\,c_{i+1/2}^n$。\n-   **边界条件：** 零流入和流出，指定为 $F_{1/2}^n=0$ 和 $F_{9/2}^n=0$。这些对应于区域最左和最右边界处的通量。\n-   **重构格式：** 对于 $u>0$，一个无限制、迎风偏置的二阶重构由 $c_{i+1/2}^n \\equiv c_i^n + \\frac{1}{2}\\left(c_i^n - c_{i-1}^n\\right)$ 给出，对于 $i=1,2,3,4$。\n-   **重构的边界数据：** 为左边界的重构提供了一个虚拟单元值 $c_0^n=0$。\n-   **初始条件：** 在时间 $t^n$，单元平均值为 $c_1^n=0$, $c_2^n=1$, $c_3^n=0$, $c_4^n=0$。\n-   **库朗数：** $\\nu \\equiv u\\Delta t/\\Delta x = 0.6$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是计算流体动力学和双曲型偏微分方程数值分析中的一个标准课题。所使用的术语和方法（有限体积、连续性方程、迎风重构、库朗数）都是公认的。\n\n这个问题是适定的。它为唯一的计算提供了所有必要的组成部分：更新方程、通量计算方法、初始数据、边界条件以及所有相关参数。\n\n这个问题是客观的，并使用了精确、正式的语言。\n\n让我们检查一下一致性。对于 $N=4$ 个单元的有限体积更新需要通量 $F_{1/2}^n, F_{3/2}^n, F_{5/2}^n, F_{7/2}^n, F_{9/2}^n$。边界条件明确设定了 $F_{1/2}^n=0$ 和 $F_{9/2}^n=0$。剩余的内部通量 $F_{3/2}^n, F_{5/2}^n, F_{7/2}^n$ 必须使用重构来计算。重构公式是为 $i=1,2,3,4$ 给出的，这将定义 $c_{3/2}^n, c_{5/2}^n, c_{7/2}^n, c_{9/2}^n$。对于右边界通量 $F_{9/2}^n$，当 $i=4$ 时的重构给出 $c_{9/2}^n = c_4^n + \\frac{1}{2}(c_4^n-c_3^n)$。使用给定的初始数据（$c_3^n=0, c_4^n=0$），得到 $c_{9/2}^n=0$，这意味着 $F_{9/2}^n=0$。这与所陈述的边界条件一致。对于左边界，当 $i=1$ 时的重构给出 $c_{3/2}^n$，这需要 $c_0^n$。问题提供了 $c_0^n=0$。所有信息都是自洽且完整的。\n\n**步骤3：结论与行动**\n问题陈述是**有效的**。我将继续推导解答。\n\n### 解答推导\n\n任务首先是计算 $i=1,2,3,4$ 的单步更新值 $c_i^{n+1}$，然后评估各个选项。\n\n**1. 计算单步更新值 $c_i^{n+1}$**\n\n有限体积更新公式可以用库朗数 $\\nu = u\\Delta t/\\Delta x$ 表示为：\n$$c_i^{n+1} = c_i^n - \\nu \\left( \\frac{F_{i+1/2}^n}{u} - \\frac{F_{i-1/2}^n}{u} \\right) = c_i^n - \\nu \\left(c_{i+1/2}^n - c_{i-1/2}^n\\right)$$\n\n首先，我们必须使用给定的初始数据计算单元面上的重构值 $c_{i+1/2}^n$：$c_0^n=0$（虚拟单元），$c_1^n=0$, $c_2^n=1$, $c_3^n=0$, $c_4^n=0$。\n\n-   **单元面 $i=1/2$（左边界）：** 边界条件为 $F_{1/2}^n=0$，这意味着 $c_{1/2}^n=0$。\n-   **单元面 $i=3/2$：** 使用 $i=1$ 的重构公式：\n    $$c_{3/2}^n = c_1^n + \\frac{1}{2}\\left(c_1^n - c_0^n\\right) = 0 + \\frac{1}{2}(0 - 0) = 0$$\n-   **单元面 $i=5/2$：** 使用 $i=2$ 的重构公式：\n    $$c_{5/2}^n = c_2^n + \\frac{1}{2}\\left(c_2^n - c_1^n\\right) = 1 + \\frac{1}{2}(1 - 0) = 1.5$$\n-   **单元面 $i=7/2$：** 使用 $i=3$ 的重构公式：\n    $$c_{7/2}^n = c_3^n + \\frac{1}{2}\\left(c_3^n - c_2^n\\right) = 0 + \\frac{1}{2}(0 - 1) = -0.5$$\n-   **单元面 $i=9/2$（右边界）：** 边界条件为 $F_{9/2}^n=0$，这意味着 $c_{9/2}^n=0$。如验证时所述，当 $i=4$ 时的重构得到 $c_{9/2}^n=c_4^n+\\frac{1}{2}(c_4^n-c_3^n)=0+\\frac{1}{2}(0-0)=0$，这是一致的。\n\n现在，我们使用 $\\nu=0.6$ 计算更新后的单元平均值 $c_i^{n+1}$：\n-   **单元 $i=1$：**\n    $$c_1^{n+1} = c_1^n - \\nu(c_{3/2}^n - c_{1/2}^n) = 0 - 0.6(0 - 0) = 0$$\n-   **单元 $i=2$：**\n    $$c_2^{n+1} = c_2^n - \\nu(c_{5/2}^n - c_{3/2}^n) = 1 - 0.6(1.5 - 0) = 1 - 0.9 = 0.1$$\n-   **单元 $i=3$：**\n    $$c_3^{n+1} = c_3^n - \\nu(c_{7/2}^n - c_{5/2}^n) = 0 - 0.6(-0.5 - 1.5) = 0 - 0.6(-2.0) = 1.2$$\n-   **单元 $i=4$：**\n    $$c_4^{n+1} = c_4^n - \\nu(c_{9/2}^n - c_{7/2}^n) = 0 - 0.6(0 - (-0.5)) = 0 - 0.6(0.5) = -0.3$$\n\n更新后的状态为 $(c_1^{n+1}, c_2^{n+1}, c_3^{n+1}, c_4^{n+1}) = (0, 0.1, 1.2, -0.3)$。\n\n**2. 评估选项**\n\n初始数据 $c^n$ 在范围 $[0, 1]$ 内。更新后的数据 $c^{n+1}$ 的最大值为 $1.2$，最小值为 $-0.3$。这表明产生了新的极值：一个上冲（值大于初始最大值）和一个下冲（值小于初始最小值）。\n\n让我们检查总质量守恒性， $M = \\sum_i c_i \\Delta x$。\n-   初始总质量：$M^n = (c_1^n + c_2^n + c_3^n + c_4^n)\\Delta x = (0+1+0+0)\\Delta x = 1\\Delta x$。\n-   最终总质量：$M^{n+1} = (c_1^{n+1} + c_2^{n+1} + c_3^{n+1} + c_4^{n+1})\\Delta x = (0 + 0.1 + 1.2 - 0.3)\\Delta x = 1\\Delta x$。\n总质量是守恒的。这可以从有限体积的“通量差”形式 $c_i^{n+1} = c_i^n - (\\Delta t/\\Delta x)(F_{i+1/2}^n - F_{i-1/2}^n)$ 和零通量边界条件中预料到，因为所有更新项的总和是一个伸缩级数，其结果是穿过区域边界的净通量：$\\sum_i (F_{i+1/2}^n - F_{i-1/2}^n) = F_{N+1/2}^n - F_{1/2}^n$。在这里，就是 $F_{9/2}^n - F_{1/2}^n = 0-0=0$。\n\n现在我们评估每个选项。\n\n**A. 所述的迎风偏置重构方案能够对总示踪剂质量进行守恒更新，但对于给定的初始条件和 $\\nu=0.6$，会产生新的极值（上冲和下冲）。**\n我们的计算证实了这一陈述的两部分。总质量是守恒的（前后均为 $1\\Delta x$）。产生了新的极值（$c_3^{n+1}=1.2 > 1$ 和 $c_4^{n+1}=-0.3  0$）。这种行为是无限制的二阶线性格式（如本题所述的 Beam-Warming 格式）的典型特征。\n**结论：正确。**\n\n**B. 因为更新表示为每个单元的通量差，所以不会引入初始范围 $[0,1]$ 之外的值；单调性被自动保持。**\n前提“更新表示为通量差”是正确的，并且保证了守恒性。然而，结论“单调性被自动保持”是错误的。我们的直接计算提供了一个反例，从在范围 $[0, 1]$ 内的初始条件生成了 $1.2$ 和 $-0.3$ 的值。高阶线性格式通常不是保单调的。\n**结论：不正确。**\n\n**C. 在保守律的单调迎风格式（MUSCL）中引入一个通量限制器，该限制器在每个单元面上（对于 $u>0$）强制 $c_{i+1/2}^n \\in [\\min(c_{i-1}^n, c_i^n), \\max(c_{i-1}^n, c_i^n)]$，可以在 $0  \\nu \\le 1$ 的情况下保持有界性（没有新的上冲或下冲），同时通过有限体积通量差更新保持守恒性。**\n该陈述描述了带有通量限制器的 MUSCL 型格式的核心目的和功能。\n-   **守恒性：** 只要在每个单元面上定义一个单一、一致的通量值 $F_{i+1/2}^n$，并用于其左右两侧的单元，通量差公式就能确保守恒性。通量限制器就是这样设计的。\n-   **有界性/单调性：** 通量限制器的目的是在陡峭梯度或极值附近，将高阶重构（如本问题中的重构）调整为一阶的单调重构。这可以防止新极值的形成。所陈述的条件 $c_{i+1/2}^n \\in [\\min(c_{i-1}^n, c_i^n), \\max(c_{i-1}^n, c_i^n)]$ 是对重构施加的一种局部约束，以确保非振荡行为。对于像 $0  \\nu \\le 1$ 这样的库朗数范围，合理设计的限制器可以保证格式是总变差减小的（TVD），这意味着有界性。关于这“可以”做到的陈述是正确的。\n**结论：正确。**\n\n**D. 通量限制器必然会破坏守恒性，因为它们在每个单元面上改变通量值的方式对于左右相邻的单元是不同的。**\n这个陈述根本上是不正确的。守恒型有限体积格式的原理是，离开一个单元的通量恰好是进入下一个单元的通量。通量限制器通过在单元面上计算一个单一的、受限制的重构值 $c_{i+1/2}^n$ 来工作，该值定义了一个单一的通量值 $F_{i+1/2}^n$。这个相同的值被用作单元 $i$ 的流出通量和单元 $i+1$ 的流入通量。该陈述的推理是有缺陷的；限制器不会在同一个单元面上产生两个不同的通量值。因此，守恒性得以保持。\n**结论：不正确。**\n\n**E. 可以构建一个总变差减小（TVD）限制器，使得对于 $0  \\nu \\le 1$，该格式在光滑区域是二阶精度的，在极值附近退化为一阶精度，从而在保持示踪剂质量的同时防止伪振荡。**\n这是对现代高分辨率 TVD 格式全面而准确的描述。\n-   **守恒性：** 如同对 C 和 D 的解释，该格式保持守恒。\n-   **精度：** 在设计上，TVD 限制器在解的光滑区域是不活跃的（例如，限制器函数 $\\phi \\approx 1$），从而使格式能够达到其潜在的二阶精度。在极值附近，限制器变得活跃（$\\phi \\to 0$），将格式降为鲁棒（但有耗散）的一阶迎风格式。\n-   **振荡防止：** TVD 属性，$TV(c^{n+1}) \\le TV(c^n)$（其中 $TV$ 是总变差 $\\sum_i |c_{i+1}-c_i|$），在数学上保证了不会形成新的局部极值，且现有的极值不会被放大。这可以防止伪振荡。\n-   **CFL 条件：** 此类显式格式的 TVD 属性取决于库朗数小于或等于 $1$。\n该陈述正确地总结了所有这些关键特征。\n**结论：正确。**",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}