{
    "hands_on_practices": [
        {
            "introduction": "箱式模型是地球系统建模的基石，它通过将复杂的系统简化为相互连接的均质储库，使我们能够应用基本的守恒定律。本练习将指导您构建一个双层水体箱式模型，用于模拟跨越化学交界面的物质交换，这是理解湖泊和海洋中营养盐分布的关键。通过从质量守恒第一性原理出发，推导系统在外部输入、内部移除和循环作用下的稳态浓度，您将掌握将地球系统过程转化为可解数学方程的核心技能。",
            "id": "3876705",
            "problem": "考虑一个分层水体，它包含两个充分混合的层：一个好氧上层和一个缺氧下层。这两层由一个剧烈的化学梯度（化学跃层）隔开，该梯度作为垂直输运的物理屏障。设好氧层的体积为 $V_{o}$，溶解养分浓度为 $C_{o}(t)$；缺氧层的体积为 $V_{a}$，溶解养分浓度为 $C_{a}(t)$。化学跃层的面积为 $A_{c}$，厚度为 $\\Delta z$。湍流涡动扩散率 (TED) 通过跨越化学跃层的垂直扩散系数 $K_{z}$ 进行参数化。假设如下：\n\n- 对好氧层的外部养分输入为 $I_{o}$，对缺氧层的外部养分输入为 $I_{a}$，单位均为 $\\mathrm{mol\\, s^{-1}}$，代表了河流、大气、底栖和热液贡献的总和。\n- 跨越化学跃层的净垂直交换通量由一个菲克式闭合表示：从缺氧层到好氧层的输运通量为 $J_{o} = \\Lambda \\left(C_{a} - C_{o}\\right)$，其中 $\\Lambda = \\dfrac{K_{z} A_{c}}{\\Delta z}$ 的单位是 $\\mathrm{m^{3}\\, s^{-1}}$。根据质量守恒，进入缺氧层的通量为 $J_{a} = \\Lambda \\left(C_{o} - C_{a}\\right)$。\n- 在每一层中，溶解养分的永久性去除是一个一级过程，其速率常数分别为 $k_{o}$ 和 $k_{a}$，单位为 $\\mathrm{s^{-1}}$。每层内部的再循环将去除养分的一部分（分别为 $\\phi_{o}$ 和 $\\phi_{a}$）立即局部地返回到溶解相中，其中 $0 \\leq \\phi_{o}  1$ 且 $0 \\leq \\phi_{a}  1$。因此，净永久损失速率因再循环而降低。\n- 假设体积恒定、参数恒定，并且除了指定的带内部再循环的一级去除过程外，没有其他生物生长项。\n\n从每个箱室的质量守恒和跨化学跃层垂直交换的菲克式表示出发，推导稳态浓度 $C_{o}^{*}$ 和 $C_{a}^{*}$ 的闭式解析表达式，该表达式应以 $I_{o}$、$I_{a}$、$K_{z}$、$A_{c}$、$\\Delta z$、$V_{o}$、$V_{a}$、$k_{o}$、$k_{a}$、$\\phi_{o}$ 和 $\\phi_{a}$ 表示。定义复合参数 $\\alpha_{o} = (1 - \\phi_{o}) k_{o} V_{o}$ 和 $\\alpha_{a} = (1 - \\phi_{a}) k_{a} V_{a}$，并使用 $\\Lambda = \\dfrac{K_{z} A_{c}}{\\Delta z}$。将您的最终答案表示为包含 $C_{o}^{*}$ 和 $C_{a}^{*}$ 的单行向量，单位为 $\\mathrm{mol\\, m^{-3}}$。无需进行数值近似或四舍五入；请提供精确的符号表达式。",
            "solution": "该问题陈述已经过验证，被确定为环境和地球系统建模领域中一个有科学依据、适定且客观的问题。它是完整、一致的，并且可以形式化为一个可解的数学模型。\n\n该问题要求在一个分层水体的双层箱式模型中，推导溶解养分的稳态浓度。该系统由一个好氧上层（下标为 $o$）和一个缺氧下层（下标为 $a$）组成。推导过程始于为每一层中的养分建立质量平衡方程。\n\n给定层 $i$ 中养分的总质量是其体积 $V_i$ 和浓度 $C_i(t)$ 的乘积。质量守恒原理指出，控制体积内质量的变化率等于所有源通量之和减去所有汇通量之和。\n$$\n\\frac{d(V_i C_i)}{dt} = \\sum \\text{源} - \\sum \\text{汇}\n$$\n由于体积 $V_o$ 和 $V_a$ 假设为常数，因此上式简化为：\n$$\nV_i \\frac{dC_i}{dt} = \\sum \\text{源} - \\sum \\text{汇}\n$$\n\n对于好氧上层，源项是外部输入 $I_o$ 和来自缺氧层的扩散通量 $J_o = \\Lambda (C_a - C_o)$。汇项是向缺氧层的扩散通量（其值为来自缺氧层通量的负数，因此已在净通量项中计入）和层内的净永久去除。\n\n总去除是一个速率常数为 $k_o$ 的一级过程，因此质量去除速率为 $k_o (V_o C_o)$。这部分被去除的养分中有一部分（比例为 $\\phi_o$）被再循环回到溶解相。因此，从溶解相中净永久去除的速率为：\n$$\n\\text{净去除}_o = (1 - \\phi_o) k_o V_o C_o\n$$\n我们已知复合参数 $\\alpha_o = (1 - \\phi_o) k_o V_o$。该参数的单位是 $\\mathrm{m^3 s^{-1}}$，代表好氧层中养分从溶解相中的有效清除率。净永久去除速率可以写为 $\\alpha_o C_o$。\n\n因此，好氧层的质量平衡方程为：\n$$\nV_o \\frac{dC_o}{dt} = I_o + \\Lambda(C_a - C_o) - \\alpha_o C_o\n$$\n$$\nV_o \\frac{dC_o}{dt} = I_o + \\Lambda C_a - (\\Lambda + \\alpha_o) C_o\n$$\n\n类似地，对于缺氧下层，源项是外部输入 $I_a$ 和来自好氧层的扩散通量 $J_a = \\Lambda(C_o - C_a)$。缺氧层内的净永久去除量由 $(1 - \\phi_a) k_a V_a C_a$ 给出。使用复合参数 $\\alpha_a = (1 - \\phi_a) k_a V_a$，该汇项为 $\\alpha_a C_a$。\n\n缺氧层的质量平衡方程为：\n$$\nV_a \\frac{dC_a}{dt} = I_a + \\Lambda(C_o - C_a) - \\alpha_a C_a\n$$\n$$\nV_a \\frac{dC_a}{dt} = I_a + \\Lambda C_o - (\\Lambda + \\alpha_a) C_a\n$$\n垂直交换的复合参数定义为 $\\Lambda = \\frac{K_z A_c}{\\Delta z}$。\n\n为了求得稳态浓度（记为 $C_o^*$ 和 $C_a^*$），我们将时间导数设为零：$\\frac{dC_o}{dt} = 0$ 和 $\\frac{dC_a}{dt} = 0$。这将常微分方程组转化为一个二元线性代数方程组：\n$$\n(1) \\quad 0 = I_o + \\Lambda C_a^* - (\\Lambda + \\alpha_o) C_o^*\n$$\n$$\n(2) \\quad 0 = I_a + \\Lambda C_o^* - (\\Lambda + \\alpha_a) C_a^*\n$$\n将这些方程重排为线性系统的标准形式，得到：\n$$\n(1) \\quad (\\Lambda + \\alpha_o) C_o^* - \\Lambda C_a^* = I_o\n$$\n$$\n(2) \\quad -\\Lambda C_o^* + (\\Lambda + \\alpha_a) C_a^* = I_a\n$$\n该方程组可以使用多种方法求解 $C_o^*$ 和 $C_a^*$，例如克莱姆法则。该方程组的矩阵形式为：\n$$\n\\begin{pmatrix}\n\\Lambda + \\alpha_o  -\\Lambda \\\\\n-\\Lambda  \\Lambda + \\alpha_a\n\\end{pmatrix}\n\\begin{pmatrix}\nC_o^* \\\\\nC_a^*\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nI_o \\\\\nI_a\n\\end{pmatrix}\n$$\n系数矩阵的行列式 $D$ 为：\n$$\nD = (\\Lambda + \\alpha_o)(\\Lambda + \\alpha_a) - (-\\Lambda)(-\\Lambda) = \\Lambda^2 + \\Lambda\\alpha_o + \\Lambda\\alpha_a + \\alpha_o\\alpha_a - \\Lambda^2\n$$\n$$\nD = \\Lambda\\alpha_o + \\Lambda\\alpha_a + \\alpha_o\\alpha_a = \\Lambda(\\alpha_o + \\alpha_a) + \\alpha_o\\alpha_a\n$$\n由于所有基本参数（$K_z, A_c, \\Delta z, k_o, k_a, V_o, V_a$）均为正，且 $0 \\le \\phi  1$，所以复合参数 $\\Lambda, \\alpha_o, \\alpha_a$ 也均为正。因此，行列式 $D$ 严格为正，保证了唯一解的存在。\n\n使用克莱姆法则， $C_o^*$ 的解为：\n$$\nC_o^* = \\frac{1}{D}\n\\begin{vmatrix}\nI_o  -\\Lambda \\\\\nI_a  \\Lambda + \\alpha_a\n\\end{vmatrix}\n= \\frac{I_o(\\Lambda + \\alpha_a) - (-\\Lambda)I_a}{D} = \\frac{I_o(\\Lambda + \\alpha_a) + I_a\\Lambda}{D}\n$$\n$$\nC_o^* = \\frac{\\Lambda(I_o + I_a) + \\alpha_a I_o}{\\Lambda(\\alpha_o + \\alpha_a) + \\alpha_o\\alpha_a}\n$$\n$C_a^*$ 的解为：\n$$\nC_a^* = \\frac{1}{D}\n\\begin{vmatrix}\n\\Lambda + \\alpha_o  I_o \\\\\n-\\Lambda  I_a\n\\end{vmatrix}\n= \\frac{I_a(\\Lambda + \\alpha_o) - I_o(-\\Lambda)}{D} = \\frac{I_a(\\Lambda + \\alpha_o) + I_o\\Lambda}{D}\n$$\n$$\nC_a^* = \\frac{\\Lambda(I_o + I_a) + \\alpha_o I_a}{\\Lambda(\\alpha_o + \\alpha_a) + \\alpha_o\\alpha_a}\n$$\n这些表达式以外部输入 $I_o$、$I_a$ 和复合参数 $\\Lambda$、$\\alpha_o$、$\\alpha_a$ 的形式给出了稳态浓度，而这些复合参数本身又由问题陈述中给出的基本参数定义。最终答案以包含这两个表达式的行向量形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\Lambda(I_o + I_a) + \\alpha_a I_o}{\\Lambda(\\alpha_o + \\alpha_a) + \\alpha_o\\alpha_a}  \\frac{\\Lambda(I_o + I_a) + \\alpha_o I_a}{\\Lambda(\\alpha_o + \\alpha_a) + \\alpha_o\\alpha_a} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "地球系统远不止是各组分的简单加和，它充满了复杂的非线性反馈。本练习将引导您探索一个经典的能量平衡模型（EBM），以研究冰-反照率反馈——这是地球气候系统中最著名的正反馈之一。通过分析该模型如何产生多个稳定平衡态和迟滞现象，您将亲身体验“临界点”的概念，即系统状态的微小变化可能导致剧烈且往往不可逆的转变。理解这种系统层面的行为对于分析气候稳定性和预测未来变化至关重要。",
            "id": "3876686",
            "problem": "一个行星尺度的单箱能量平衡模型 (EBM) 用于表示地球系统的全球平均表面温度 $T$，其混合层热容为 $C$。该模型基于能量守恒：内能的变化率等于进入系统的净辐射通量。吸收的短波通量是入射太阳辐射与（1 减去行星反照率）的乘积，而发射的长波通量是温度的函数。基本演化方程为\n$$\nC\\,\\frac{dT}{dt} = \\frac{S}{4}\\,\\big(1 - \\alpha(f)\\big) - L(T),\n$$\n其中 $S$ 是太阳常数，因子 $1/4$ 考虑了球形几何，$\\alpha(f)$ 是依赖于冰覆盖分数 $f$ 的行星反照率，而 $L(T)$ 是出射长波辐射 (OLR)。假设 $L(T)$ 可以通过围绕一个气候参考态的线性化很好地近似为 $L(T) = A + B\\,T$，其中 $A  0$ 且 $B  0$。\n\n冰覆盖分数 $f$ 通过以下方式改变反照率\n$$\n\\alpha(f) = \\alpha_{o} + (\\alpha_{i} - \\alpha_{o})\\,f,\n$$\n其中 $0 \\le \\alpha_{o}  \\alpha_{i} \\le 1$。由于存在不同的冰点和融点阈值，冰分数 $f$ 对温度的响应具有迟滞性：当 $T \\le T_{i}$ 时，存在一个 $f=1$ 的冷分支；当 $T \\ge T_{o}$ 时，存在一个 $f=0$ 的暖分支，且 $T_{i}  T_{o}$。在 $S$ 的准静态变化下，系统可以表现出与地表反照率反馈相关的多重平衡和迟滞现象。\n\n从能量守恒原理和上述定义出发，执行以下操作：\n\n- 推导冷的完全冰覆盖分支（$f=1$）和暖的无冰分支（$f=0$）的平衡条件。\n- 通过分析方程右侧对 $T$ 的导数的符号，确定每个分支上平衡的稳定性。\n- 确定参数 $S$ 的区间，在此区间内两个分支同时存在平衡，从而产生多重平衡和迟滞现象。\n- 推导太阳常数迟滞区间的宽度 $\\Delta S = S_{\\text{warm}}^{\\ast} - S_{\\text{cold}}^{\\ast}$ 的闭式解析表达式，其中 $S_{\\text{cold}}^{\\ast}$ 是冷分支平衡达到 $T = T_{i}$ 时的临界值，而 $S_{\\text{warm}}^{\\ast}$ 是暖分支平衡达到 $T = T_{o}$ 时的临界值。\n\n将您的最终答案 $\\Delta S$ 以 $\\text{W}\\,\\text{m}^{-2}$ 为单位表示。无需进行数值计算；提供一个闭式解析表达式即可。",
            "solution": "该问题陈述被评估为具有科学依据、良定、客观且完整。它提出了一个经典的简化能量平衡模型 (EBM)，这是气候科学中一个标准的教学和研究工具。推导所需的所有定义、常数和函数形式都已明确给出。因此，该问题被认为是有效的，并将推导求解。\n\n控制系统全球平均表面温度 $T$ 的基本方程是能量守恒原理：\n$$\nC\\,\\frac{dT}{dt} = \\frac{S}{4}\\,\\big(1 - \\alpha(f)\\big) - L(T)\n$$\n其中 $C$ 是热容，$S$ 是太阳常数，$\\alpha(f)$ 是作为冰覆盖分数 $f$ 函数的反照率，而 $L(T)$ 是出射长波辐射。给定的函数形式是：\n$$\nL(T) = A + B\\,T\n$$\n$$\n\\alpha(f) = \\alpha_{o} + (\\alpha_{i} - \\alpha_{o})\\,f\n$$\n冰分数 $f$ 为两个稳定分支分段定义：一个冷的、完全被冰覆盖的分支，其中当 $T \\le T_i$ 时 $f=1$；以及一个暖的、无冰的分支，其中当 $T \\ge T_o$ 时 $f=0$。\n\n平衡态的特征是温度恒定，即 $\\frac{dT}{dt} = 0$。因此，平衡条件为：\n$$\n\\frac{S}{4}\\,\\big(1 - \\alpha(f)\\big) - (A + B\\,T) = 0\n$$\n\n首先，我们推导两个指定分支的平衡条件。\n\n对于冷的、完全被冰覆盖的分支，我们有 $f=1$。反照率变为 $\\alpha(f=1) = \\alpha_{o} + (\\alpha_{i} - \\alpha_{o})(1) = \\alpha_{i}$。该分支的平衡条件是：\n$$\n\\frac{S}{4}(1 - \\alpha_{i}) = A + B\\,T\n$$\n该条件在温度 $T \\le T_{i}$ 时成立。\n\n对于暖的、无冰的分支，我们有 $f=0$。反照率变为 $\\alpha(f=0) = \\alpha_{o} + (\\alpha_{i} - \\alpha_{o})(0) = \\alpha_{o}$。该分支的平衡条件是：\n$$\n\\frac{S}{4}(1 - \\alpha_{o}) = A + B\\,T\n$$\n该条件在温度 $T \\ge T_{o}$ 时成立。\n\n接下来，我们确定这些平衡的稳定性。让演化方程的右侧表示为 $G(T) = \\frac{S}{4}\\,(1 - \\alpha(f)) - (A + B T)$。如果温度的一个小扰动会衰减，则平衡是稳定的，这要求在平衡点处 $\\frac{dG}{dT}  0$。\n在每个指定的分支上，冰分数 $f$ 是恒定的（$f=1$ 或 $f=0$）。因此，在该分支内，反照率 $\\alpha(f)$ 相对于温度变化也是恒定的。\n\n对于冷分支，$G(T) = \\frac{S}{4}(1 - \\alpha_{i}) - A - B\\,T$。其导数为：\n$$\n\\frac{dG}{dT} = -B\n$$\n对于暖分支，$G(T) = \\frac{S}{4}(1 - \\alpha_{o}) - A - B\\,T$。其导数为：\n$$\n\\frac{dG}{dT} = -B\n$$\n由于问题陈述 $B  0$，因此在冷分支和暖分支上都有 $\\frac{dG}{dT} = -B  0$。所以，在这两个分支上找到的任何平衡都是稳定的。\n\n当两个分支上的稳定解可以共存时，就会在太阳常数 $S$ 的一定范围内出现多重平衡和迟滞现象。这需要确定每个分支失去其有效性的临界 $S$ 值。\n\n问题将 $S_{\\text{cold}}^{\\ast}$ 定义为冷分支平衡达到温度 $T = T_{i}$ 时的临界值。这是系统在进一步变暖时必须从完全冰封状态过渡出去的点。我们通过在冷分支平衡方程中设置 $T=T_{i}$ 来找到这个值：\n$$\n\\frac{S_{\\text{cold}}^{\\ast}}{4}(1 - \\alpha_{i}) = A + B\\,T_{i}\n$$\n解出 $S_{\\text{cold}}^{\\ast}$：\n$$\nS_{\\text{cold}}^{\\ast} = \\frac{4(A + B\\,T_{i})}{1 - \\alpha_{i}}\n$$\n\n类似地，$S_{\\text{warm}}^{\\ast}$ 被定义为暖分支平衡达到温度 $T = T_{o}$ 时的临界值。这是系统在进一步冷却时必须从无冰状态过渡出去的点。我们通过在暖分支平衡方程中设置 $T=T_{o}$ 来找到这个值：\n$$\n\\frac{S_{\\text{warm}}^{\\ast}}{4}(1 - \\alpha_{o}) = A + B\\,T_{o}\n$$\n解出 $S_{\\text{warm}}^{\\ast}$：\n$$\nS_{\\text{warm}}^{\\ast} = \\frac{4(A + B\\,T_{o})}{1 - \\alpha_{o}}\n$$\n多重平衡区域存在于这两个临界点之间的 $S$ 值范围内。对于一个物理上现实的迟滞回线，其中冰川消融所需的太阳常数要大于维持无冰状态所需的最小值，我们必须有 $S_{\\text{cold}}^{\\ast}  S_{\\text{warm}}^{\\ast}$。\n\n问题要求迟滞区间宽度的闭式表达式，定义为 $\\Delta S = S_{\\text{warm}}^{\\ast} - S_{\\text{cold}}^{\\ast}$。我们代入推导出的临界太阳常数表达式：\n$$\n\\Delta S = \\frac{4(A + B\\,T_{o})}{1 - \\alpha_{o}} - \\frac{4(A + B\\,T_{i})}{1 - \\alpha_{i}}\n$$\n为简化起见，我们将各项通分：\n$$\n\\Delta S = 4 \\left( \\frac{(A + B\\,T_{o})(1 - \\alpha_{i}) - (A + B\\,T_{i})(1 - \\alpha_{o})}{(1 - \\alpha_{o})(1 - \\alpha_{i})} \\right)\n$$\n现在，我们展开分子中的项：\n$$\n\\text{Numerator} = (A - A\\alpha_{i} + B\\,T_{o} - B\\,T_{o}\\alpha_{i}) - (A - A\\alpha_{o} + B\\,T_{i} - B\\,T_{i}\\alpha_{o})\n$$\n根据参数 $A$ 和 $B$ 合并各项：\n$$\n\\text{Numerator} = A(\\alpha_{o} - \\alpha_{i}) + B(T_{o} - T_{i}) + B(T_{i}\\alpha_{o} - T_{o}\\alpha_{i})\n$$\n将此代入 $\\Delta S$ 的表达式，得到最终的闭式解析表达式：\n$$\n\\Delta S = \\frac{4 \\left[ A(\\alpha_{o} - \\alpha_{i}) + B(T_{o} - T_{i}) + B(T_{i}\\alpha_{o} - T_{o}\\alpha_{i}) \\right]}{(1 - \\alpha_{o})(1 - \\alpha_{i})}\n$$\n$A$ 和 $B\\,T$ 的单位是 $\\text{W}\\,\\text{m}^{-2}$，反照率值是无量纲的，因此 $\\Delta S$ 的表达式正确地得出了 $\\text{W}\\,\\text{m}^{-2}$ 的单位，与太阳常数的单位一致。",
            "answer": "$$\\boxed{\\frac{4 \\left[ A(\\alpha_{o} - \\alpha_{i}) + B(T_{o} - T_{i}) + B(T_{i}\\alpha_{o} - T_{o}\\alpha_{i}) \\right]}{(1 - \\alpha_{o})(1 - \\alpha_{i})}}$$"
        },
        {
            "introduction": "理论模型与现实世界的观测数据之间必须建立桥梁，这正是模型校准的意义所在。本练习将您置于地球系统科学家的角色，任务是使用观测数据来校准和评估一个描述地-气边界层通量的湍流闭合方案。您将应用莫宁-奥布霍夫相似性理论（Monin-Obukhov Similarity Theory, MOST），通过最小化模型预测与涡度相关测量值之间的误差来确定关键参数，这是现代地球系统建模中的一项核心实践。这项练习将理论、数据和计算融为一体，为您提供了宝贵的实践经验。",
            "id": "3876733",
            "problem": "您的任务是校准和评估大气表面层中的一阶湍流闭合方案，重点关注陆地表面与大气之间的耦合，这是一个关键的地球系统边界。从 Reynolds 平均和 Monin–Obukhov 相似性理论 (MOST) 等具有坚实物理基础的原理出发，为热传输稳定度函数构建一个参数化闭合。给定摩擦速度 $u_*$ 和无量纲稳定度参数 $\\zeta = z/L$ 的观测值，以及已知测量高度上的温度梯度，通过最小化方法校准闭合参数，然后根据感热通量的直接涡度相关 (EC) 测量值来评估模型的性能。您的工作应以纯数学和逻辑术语表达；并按照末尾的规定在代码中实现。\n\n使用以下基本原理和定义：\n\n1. 表面层中的热量守恒将感热通量 $H$ 与湍流动能热通量 $\\overline{w' \\theta'}$ 联系起来，通过\n$$\nH = \\rho c_p \\, \\overline{w' \\theta'} ,\n$$\n其中 $\\rho$ 是空气密度，$c_p$ 是恒压下空气的比热容，$\\theta$ 是位温。\n\n2. 梯度扩散假说（一阶闭合）假定\n$$\n\\overline{w' \\theta'} = - K_h \\frac{d \\Theta}{d z} ,\n$$\n其中 $K_h$ 是热量的涡动扩散系数，$\\Theta$ 是平均位温。\n\n3. Monin–Obukhov 相似性理论 (MOST) 将 $K_h$ 与近地表湍流联系起来，通过\n$$\nK_h = \\frac{k \\, u_* \\, z}{\\phi_h(\\zeta)} ,\n$$\n其中 $k$ 是 von Kármán 常数，$u_*$ 是摩擦速度，$z$ 是测量高度，$\\phi_h(\\zeta)$ 是无量纲温度梯度稳定度函数，其中 $\\zeta = z/L$，$L$ 是 Monin–Obukhov 长度。\n\n4. 摩擦速度 $u_*$ 定义为 $u_* = \\sqrt{\\tau / \\rho}$，其中 $\\tau$ 是地表切应力。在本问题中，$u_*$ 作为观测值提供。\n\n您必须以分段形式参数化热量稳定度函数 $\\phi_h(\\zeta)$，使其在 $\\zeta = 0$ 时强制执行中性标度，并捕捉稳定和不稳定条件下的定性行为：\n- 对于稳定条件 ($\\zeta \\ge 0$)，\n$$\n\\phi_h(\\zeta) = 1 + a_s \\, \\zeta ,\n$$\n- 对于不稳定条件 ($\\zeta  0$)，\n$$\n\\phi_h(\\zeta) = \\left( 1 - a_u \\, \\zeta \\right)^{-1/2} .\n$$\n此处 $a_s$ 和 $a_u$ 是待校准的未知正常数。在不稳定分支中选择指数 $1/2$ 是为了表征对流条件下增强的混合，同时保持 $\\phi_h(0) = 1$。\n\n利用以上公式，模拟的感热通量为\n$$\nH_{\\text{model}} = - \\rho c_p \\left( \\frac{k \\, u_* \\, z}{\\phi_h(\\zeta)} \\right) \\frac{d \\Theta}{d z} .\n$$\n\n校准目标：给定一组由 $i$ 索引的个例，包含在已知高度 $z$ 的观测值 $\\left\\{ u_{*,i}, \\zeta_i, \\left( d \\Theta / d z \\right)_i, H_{\\text{EC}, i} \\right\\}$，通过最小化平方误差和来估计 $a_s$ 和 $a_u$\n$$\nJ(a_s, a_u) = \\sum_{i} \\left( H_{\\text{model}, i}(a_s, a_u) - H_{\\text{EC}, i} \\right)^2 ,\n$$\n约束条件为 $a_s \\ge 0$ 和 $a_u \\ge 0$。\n\n性能评估：校准后，计算每个个例的模拟通量 $H_{\\text{model}, i}$ 和均方根误差 (RMSE)\n$$\n\\text{RMSE} = \\sqrt{ \\frac{1}{N} \\sum_{i=1}^{N} \\left( H_{\\text{model}, i} - H_{\\text{EC}, i} \\right)^2 } ,\n$$\n其中 $N$ 是个例的总数。\n\n在所有计算中使用的物理常数：\n- Von Kármán 常数 $k = 0.4$ (无量纲)，\n- 空气密度 $\\rho = 1.2 \\, \\mathrm{kg \\, m^{-3}}$，\n- 恒压下空气比热 $c_p = 1004 \\, \\mathrm{J \\, kg^{-1} \\, K^{-1}}$，\n- 测量高度 $z = 10 \\, \\mathrm{m}$。\n\n测试组：使用以下四个个例（选择覆盖不稳定、中性和稳定条件）。所有数值均采用国际单位制 (SI units)。\n\n- 个例 $1$ (不稳定)：$z = 10 \\, \\mathrm{m}$, $u_* = 0.6 \\, \\mathrm{m \\, s^{-1}}$, $\\zeta = -0.5$, $d \\Theta / d z = -0.02 \\, \\mathrm{K \\, m^{-1}}$, $H_{\\text{EC}} = 180 \\, \\mathrm{W \\, m^{-2}}$。\n- 个例 $2$ (中性)：$z = 10 \\, \\mathrm{m}$, $u_* = 0.4 \\, \\mathrm{m \\, s^{-1}}$, $\\zeta = 0.0$, $d \\Theta / d z = -0.002 \\, \\mathrm{K \\, m^{-1}}$, $H_{\\text{EC}} = 4 \\, \\mathrm{W \\, m^{-2}}$。\n- 个例 $3$ (弱稳定)：$z = 10 \\, \\mathrm{m}$, $u_* = 0.2 \\, \\mathrm{m \\, s^{-1}}$, $\\zeta = 0.2$, $d \\Theta / d z = 0.01 \\, \\mathrm{K \\, m^{-1}}$, $H_{\\text{EC}} = -5 \\, \\mathrm{W \\, m^{-2}}$。\n- 个例 $4$ (强稳定)：$z = 10 \\, \\mathrm{m}$, $u_* = 0.15 \\, \\mathrm{m \\, s^{-1}}$, $\\zeta = 1.0$, $d \\Theta / d z = 0.05 \\, \\mathrm{K \\, m^{-1}}$, $H_{\\text{EC}} = -5 \\, \\mathrm{W \\, m^{-2}}$。\n\n要求的输出和单位说明：\n- 对于每个测试个例 $i$，输出校准后的模拟感热通量 $H_{\\text{model}, i}$，单位为 $\\mathrm{W \\, m^{-2}}$，四舍五入到一位小数。\n- 同时输出 RMSE，单位为 $\\mathrm{W \\, m^{-2}}$，四舍五入到一位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序完全如下\n$$\n\\left[ H_{\\text{model}, 1}, H_{\\text{model}, 2}, H_{\\text{model}, 3}, H_{\\text{model}, 4}, \\text{RMSE} \\right] .\n$$\n例如：$[123.4,5.6,-7.8,-9.0,12.3]$。",
            "solution": "该问题是一个有效且适定的科学建模任务。它在科学上基于大气表面层湍流的原理，特别是 Monin-Obukhov 相似性理论 (MOST)，并且没有任何科学或事实上的不健全、模糊或矛盾之处。所有必要的数据和常数都已提供。因此，我们可以进行完整的求解。\n\n目标是校准感热通量一阶湍流闭合方案的参数 $a_s$ 和 $a_u$，然后评估校准后的模型。\n\n模拟的感热通量 $H_{\\text{model}}$ 由梯度扩散假说和 MOST 组合给出：\n$$\nH_{\\text{model}} = - \\rho c_p K_h \\frac{d \\Theta}{d z}\n$$\n其中热量的涡动扩散系数 $K_h$ 参数化为\n$$\nK_h = \\frac{k \\, u_* \\, z}{\\phi_h(\\zeta)}\n$$\n代入 $K_h$ 得到模拟通量的完整表达式：\n$$\nH_{\\text{model}} = - \\rho c_p \\left( \\frac{k \\, u_* \\, z}{\\phi_h(\\zeta)} \\right) \\frac{d \\Theta}{d z}\n$$\n稳定度函数 $\\phi_h(\\zeta)$ 基于稳定度参数 $\\zeta = z/L$ 分段定义：\n$$\n\\phi_h(\\zeta) =\n\\begin{cases}\n    1 + a_s \\, \\zeta  \\text{for } \\zeta \\ge 0 \\text{ (稳定)} \\\\\n    (1 - a_u \\, \\zeta)^{-1/2}  \\text{for } \\zeta  0 \\text{ (不稳定)}\n\\end{cases}\n$$\n提供的物理常数有 von Kármán 常数 $k = 0.4$，空气密度 $\\rho = 1.2 \\, \\mathrm{kg \\, m^{-3}}$，空气比热 $c_p = 1004 \\, \\mathrm{J \\, kg^{-1} \\, K^{-1}}$，以及测量高度 $z = 10 \\, \\mathrm{m}$。我们可以预先计算常数项 $-\\rho c_p k z$：\n$$\n-\\rho c_p k z = - (1.2 \\, \\mathrm{kg \\, m^{-3}}) \\cdot (1004 \\, \\mathrm{J \\, kg^{-1} \\, K^{-1}}) \\cdot (0.4) \\cdot (10 \\, \\mathrm{m}) = -4819.2 \\, \\mathrm{W \\, s \\, m^{-2} \\, K^{-1}}\n$$\n\n校准过程涉及找到非负参数 $a_s$ 和 $a_u$，以最小化在 $N=4$ 个个例中，模拟通量 $H_{\\text{model}, i}$ 与观测的涡度相关通量 $H_{\\text{EC}, i}$ 之间的平方误差和 $J(a_s, a_u)$：\n$$\nJ(a_s, a_u) = \\sum_{i=1}^{4} \\left( H_{\\text{model}, i}(a_s, a_u) - H_{\\text{EC}, i} \\right)^2\n$$\n数据集覆盖了不稳定 ($\\zeta  0$)、中性 ($\\zeta = 0$) 和稳定 ($\\zeta  0$) 的条件。$\\phi_h(\\zeta)$ 的结构使得目标函数可以解耦。参数 $a_u$ 仅影响不稳定的个例（个例 $1$），而 $a_s$ 仅影响稳定的个例（个例 $3$ 和 $4$）。中性个例（个例 $2$）与这两个参数都无关，因为 $\\phi_h(0) = 1$。因此，目标函数可以写成：\n$$\nJ(a_s, a_u) = \\left( H_{\\text{model}, 1}(a_u) - H_{\\text{EC}, 1} \\right)^2 + \\left( H_{\\text{model}, 2} - H_{\\text{EC}, 2} \\right)^2 + \\sum_{i=3}^{4} \\left( H_{\\text{model}, i}(a_s) - H_{\\text{EC}, i} \\right)^2\n$$\n这使我们能够通过两个独立的最小化问题来求解 $a_u$ 和 $a_s$。\n\n**1. 不稳定参数 $a_u$ 的校准**\n我们使用个例 $1$ 的数据：$u_{*,1} = 0.6 \\, \\mathrm{m \\, s^{-1}}$，$\\zeta_1 = -0.5$，$(d\\Theta/dz)_1 = -0.02 \\, \\mathrm{K \\, m^{-1}}$，以及 $H_{\\text{EC}, 1} = 180 \\, \\mathrm{W \\, m^{-2}}$。\n模型方程为：\n$$\nH_{\\text{model}, 1}(a_u) = (-4819.2) \\cdot u_{*,1} \\cdot (1 - a_u \\zeta_1)^{1/2} \\cdot (d\\Theta/dz)_1\n$$\n由于我们用一个数据点来确定一个参数，通过将模型预测值设置为与观测值相等即可最小化平方和：\n$$\n180 = (-4819.2) \\cdot (0.6) \\cdot (1 - a_u(-0.5))^{1/2} \\cdot (-0.02)\n$$\n$$\n180 = 57.8304 \\cdot (1 + 0.5 a_u)^{1/2}\n$$\n求解 $a_u$：\n$$\n(1 + 0.5 a_u)^{1/2} = \\frac{180}{57.8304} \\approx 3.1122\n$$\n$$\n1 + 0.5 a_u = (3.1122)^2 \\approx 9.6858\n$$\n$$\n0.5 a_u = 8.6858 \\implies a_u \\approx 17.3716\n$$\n这满足约束条件 $a_u \\ge 0$。使用该值，$H_{\\text{model}, 1} = 180.0 \\, \\mathrm{W \\, m^{-2}}$。\n\n**2. 稳定参数 $a_s$ 的校准**\n我们必须最小化稳定个例（个例 $3$ 和 $4$）的平方误差和：\n$$\nJ_s(a_s) = \\left( H_{\\text{model}, 3}(a_s) - H_{\\text{EC}, 3} \\right)^2 + \\left( H_{\\text{model}, 4}(a_s) - H_{\\text{EC}, 4} \\right)^2\n$$\n数据：\n- 个例 3: $u_{*,3} = 0.2$, $\\zeta_3 = 0.2$, $(d\\Theta/dz)_3 = 0.01$, $H_{\\text{EC}, 3} = -5$。\n- 个例 4: $u_{*,4} = 0.15$, $\\zeta_4 = 1.0$, $(d\\Theta/dz)_4 = 0.05$, $H_{\\text{EC}, 4} = -5$。\n\n模型方程为：\n$$\nH_{\\text{model}, i}(a_s) = \\frac{-4819.2 \\cdot u_{*,i} \\cdot (d\\Theta/dz)_i}{1 + a_s \\zeta_i}\n$$\n$$\nH_{\\text{model}, 3}(a_s) = \\frac{-9.6384}{1 + 0.2 a_s}\n$$\n$$\nH_{\\text{model}, 4}(a_s) = \\frac{-36.144}{1 + a_s}\n$$\n目标函数为：\n$$\nJ_s(a_s) = \\left( \\frac{-9.6384}{1 + 0.2 a_s} - (-5) \\right)^2 + \\left( \\frac{-36.144}{1 + a_s} - (-5) \\right)^2\n$$\n这是一个关于 $a_s \\ge 0$ 的非线性优化问题。通过数值方法求解（例如，使用像 SciPy 的 `minimize` 这样的非线性求解器）得到最优值 $a_s \\approx 6.0466$。\n\n**3. 模型评估**\n使用校准后的参数 $a_u \\approx 17.3716$ 和 $a_s \\approx 6.0466$，我们计算所有四个个例的模拟通量。\n\n- **个例 1 (不稳定)：** 根据优化过程的构造，$H_{\\text{model}, 1} = 180.0 \\, \\mathrm{W \\, m^{-2}}$。\n\n- **个例 2 (中性)：** $\\zeta_2=0$，所以 $\\phi_h(0) = 1$。\n$H_{\\text{model}, 2} = (-4819.2) \\cdot u_{*,2} \\cdot (d\\Theta/dz)_2 = (-4819.2) \\cdot (0.4) \\cdot (-0.002) = 3.85536 \\, \\mathrm{W \\, m^{-2}}$。\n\n- **个例 3 (稳定)：**\n$H_{\\text{model}, 3} = \\frac{-9.6384}{1 + 0.2 \\cdot (6.0466)} = \\frac{-9.6384}{2.20932} \\approx -4.3627 \\, \\mathrm{W \\, m^{-2}}$。\n\n- **个例 4 (稳定)：**\n$H_{\\text{model}, 4} = \\frac{-36.144}{1 + 6.0466} = \\frac{-36.144}{7.0466} \\approx -5.1301 \\, \\mathrm{W \\, m^{-2}}$。\n\n**4. RMSE 计算**\n计算均方根误差 (RMSE) 以量化模型的整体性能。\n$$\n\\text{RMSE} = \\sqrt{ \\frac{1}{N} \\sum_{i=1}^{N} \\left( H_{\\text{model}, i} - H_{\\text{EC}, i} \\right)^2 }\n$$\n各个误差为：\n- $e_1 = 180.0 - 180.0 = 0$\n- $e_2 = 3.85536 - 4.0 = -0.14464$\n- $e_3 = -4.3627 - (-5.0) = 0.6373$\n- $e_4 = -5.1301 - (-5.0) = -0.1301$\n\n平方误差和为：\n$$\n\\sum e_i^2 = (0)^2 + (-0.14464)^2 + (0.6373)^2 + (-0.1301)^2 \\approx 0 + 0.02092 + 0.40615 + 0.01693 = 0.44399\n$$\n$$\n\\text{RMSE} = \\sqrt{\\frac{0.44399}{4}} = \\sqrt{0.11100} \\approx 0.33317 \\, \\mathrm{W \\, m^{-2}}\n$$\n\n**最终结果总结**\n将所需输出四舍五入到一位小数：\n- $H_{\\text{model}, 1} = 180.0 \\, \\mathrm{W \\, m^{-2}}$\n- $H_{\\text{model}, 2} = 3.9 \\, \\mathrm{W \\, m^{-2}}$\n- $H_{\\text{model}, 3} = -4.4 \\, \\mathrm{W \\, m^{-2}}$\n- $H_{\\text{model}, 4} = -5.1 \\, \\mathrm{W \\, m^{-2}}$\n- $\\text{RMSE} = 0.3 \\, \\mathrm{W \\, m^{-2}}$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Calibrates and evaluates a first-order turbulence closure model for sensible heat flux.\n    \"\"\"\n    # Define physical constants from the problem statement\n    k = 0.4  # von Kármán constant (dimensionless)\n    rho = 1.2  # Air density (kg m^-3)\n    c_p = 1004.0  # Specific heat of air (J kg^-1 K^-1)\n    z = 10.0  # Measurement height (m)\n\n    # Pre-calculate the constant multiplier in the flux equation\n    const_multiplier = -rho * c_p * k * z\n\n    # Define the test cases from the problem statement (all in SI units)\n    # Each case is a dictionary holding the observed data.\n    test_cases = [\n        # Case 1 (unstable)\n        {'u_star': 0.6, 'zeta': -0.5, 'dTheta_dz': -0.02, 'H_ec': 180.0},\n        # Case 2 (neutral)\n        {'u_star': 0.4, 'zeta': 0.0, 'dTheta_dz': -0.002, 'H_ec': 4.0},\n        # Case 3 (weakly stable)\n        {'u_star': 0.2, 'zeta': 0.2, 'dTheta_dz': 0.01, 'H_ec': -5.0},\n        # Case 4 (strongly stable)\n        {'u_star': 0.15, 'zeta': 1.0, 'dTheta_dz': 0.05, 'H_ec': -5.0},\n    ]\n    \n    # --- Parameter Calibration ---\n\n    # 1. Calibrate a_u for unstable conditions (zeta  0)\n    # Using Case 1 data. Since there's one parameter for one data point, we can solve algebraically\n    # by setting H_model_1 = H_ec_1.\n    case1 = test_cases[0]\n    # The model equation for the unstable case is:\n    # H_model = const_multiplier * (u_star / (1 - a_u * zeta)**(-0.5)) * dTheta_dz\n    # H_model = const_multiplier * u_star * (1 - a_u * zeta)**(0.5) * dTheta_dz\n    # Setting H_model_1 = H_ec_1:\n    # H_ec_1 = const_multiplier * u_star_1 * (1 - a_u * zeta_1)**(0.5) * dTheta_dz_1\n    # -- (1 - a_u * zeta_1)**0.5 = H_ec_1 / (const_multiplier * u_star_1 * dTheta_dz_1)\n    term = case1['H_ec'] / (const_multiplier * case1['u_star'] * case1['dTheta_dz'])\n    a_u = (term**2 - 1) / (-case1['zeta'])\n\n    # 2. Calibrate a_s for stable conditions (zeta = 0)\n    # We minimize the sum of squared errors for cases 3 and 4.\n    stable_cases = [test_cases[2], test_cases[3]]\n\n    def cost_function_s(a_s_param):\n        \"\"\"Objective function for a_s optimization.\"\"\"\n        a_s = a_s_param[0]\n        sse = 0.0\n        for case in stable_cases:\n            phi_h = 1.0 + a_s * case['zeta']\n            h_model = const_multiplier * (case['u_star'] / phi_h) * case['dTheta_dz']\n            sse += (h_model - case['H_ec'])**2\n        return sse\n\n    # Perform the minimization with a non-negativity constraint\n    initial_guess_s = [5.0]  # A physically reasonable starting point\n    bounds_s = [(0, None)]\n    result = minimize(cost_function_s, initial_guess_s, bounds=bounds_s, method='L-BFGS-B')\n    a_s = result.x[0]\n\n    # --- Model Evaluation ---\n    \n    def calculate_h_model(case, a_s_cal, a_u_cal):\n        \"\"\"Computes the modeled sensible heat flux for a given case.\"\"\"\n        zeta = case['zeta']\n        if zeta = 0: # Stable or Neutral\n            phi_h = 1.0 + a_s_cal * zeta\n        else: # Unstable\n            phi_h = (1.0 - a_u_cal * zeta)**(-0.5)\n        \n        h_model = const_multiplier * (case['u_star'] / phi_h) * case['dTheta_dz']\n        return h_model\n\n    # Calculate modeled fluxes for all cases with calibrated parameters\n    h_model_results = []\n    squared_errors = []\n    for case in test_cases:\n        h_m = calculate_h_model(case, a_s, a_u)\n        h_model_results.append(h_m)\n        squared_errors.append((h_m - case['H_ec'])**2)\n\n    # Calculate the Root Mean Squared Error (RMSE)\n    N = len(test_cases)\n    rmse = np.sqrt(sum(squared_errors) / N)\n    \n    # Format the final results as required (rounded to one decimal place)\n    output_values = [f\"{val:.1f}\" for val in h_model_results]\n    output_values.append(f\"{rmse:.1f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(output_values)}]\")\n\nsolve()\n```"
        }
    ]
}