{
    "hands_on_practices": [
        {
            "introduction": "在环境建模中，我们如何表示示踪剂的浓度并不仅仅是为了方便，它对守恒特性有着深远的影响，尤其是在像大气这样的可压缩流体中。本练习将基于基本物理定律，探讨不同示踪剂单位（如质量混合比 $r$、质量分数 $Y_X$、摩尔分数 $x_X$ 和摩尔浓度 $c_X$）之间的关系。通过这些推导和计算，您将更深入地理解哪些量是物质守恒的（即沿轨迹线保持不变），而哪些量是以通量形式守恒的——这对于构建和解释模型是至关重要的区别。",
            "id": "3870913",
            "problem": "一种稀薄气相示踪物种 $X$ 在可压缩、无粘性、绝热的大气流中输运，其分子扩散可忽略不计，且无化学源或汇。该混合物表现为理想气体。干空气的摩尔质量为 $M_{d} = 28.97 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$，示踪剂的摩尔质量为 $M_{X} = 48.00 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$。在给定的位置和时间，状态为 $P = 85{,}000 \\,\\mathrm{Pa}$ 和 $T = 260 \\,\\mathrm{K}$。示踪剂由其相对于干空气的质量混合比 $r \\equiv m_{X}/m_{d}$ 指定，其值为 $r = 2.50 \\times 10^{-7}$。\n\n任务：\n- 仅使用基本定义和理想气体定律，推导示踪剂质量混合比 $r$、示踪剂质量分数 $Y_{X}$、示踪剂摩尔分数 $x_{X}$ 和示踪剂摩尔浓度 $c_{X}$ 之间的转换关系。\n- 从各组分和混合物的质量守恒出发，推导在可压缩流中，哪些变量形式是严格的欧拉散度守恒形式，哪些变量是沿轨迹的物质守恒。解释守恒性质如何依赖于所选变量和密度变化。\n- 计算在指定状态下示踪剂摩尔浓度 $c_{X}$ 的数值。\n\n使用普适气体常数 $R = 8.314462618 \\,\\mathrm{J\\, mol^{-1}\\, K^{-1}}$。将最终数值答案四舍五入至四位有效数字。最终浓度以 $\\mathrm{mol\\, m^{-3}}$ 表示。仅报告摩尔浓度 $c_{X}$ 作为最终数值答案。",
            "solution": "该问题经评估具有科学依据，提法恰当，客观且内部一致。这是一个关于被动示踪剂输运和表示的大气科学和流体动力学标准问题。所有必要信息都已提供，可得出唯一解。\n\n解答根据问题陈述的要求分为三个部分：转换公式的推导、守恒性质的分析以及示踪剂摩尔浓度的数值计算。\n\n### 第一部分：示踪剂变量之间的转换\n\n给定示踪物种 $X$ 在与干空气（$d$）的混合物中的以下量定义：\n- 质量混合比：$r \\equiv \\frac{m_X}{m_d}$，其中 $m_X$ 和 $m_d$ 分别是示踪剂和干空气的质量。\n- 质量分数：$Y_X \\equiv \\frac{m_X}{m_{total}} = \\frac{m_X}{m_X + m_d}$。\n- 摩尔分数：$x_X \\equiv \\frac{n_X}{n_{total}} = \\frac{n_X}{n_X + n_d}$，其中 $n_X$ 和 $n_d$ 是摩尔数。\n- 摩尔浓度：$c_X \\equiv \\frac{n_X}{V}$，其中 $V$ 是体积。\n\n质量 $m$、摩尔数 $n$ 和摩尔质量 $M$ 之间的关系是 $m = n M$。\n\n1.  **质量混合比（$r$）与质量分数（$Y_X$）之间的转换**：\n    根据定义，$Y_X = \\frac{m_X}{m_X + m_d}$。将分子和分母同除以 $m_d$ 得：\n    $$Y_X = \\frac{m_X/m_d}{m_X/m_d + 1} = \\frac{r}{r+1}$$\n    反之，为了用 $Y_X$ 表示 $r$，我们可以使用干空气质量分数的定义，$Y_d = \\frac{m_d}{m_{total}} = 1 - Y_X$。\n    $$r = \\frac{m_X}{m_d} = \\frac{m_X/m_{total}}{m_d/m_{total}} = \\frac{Y_X}{Y_d} = \\frac{Y_X}{1 - Y_X}$$\n\n2.  **质量混合比（$r$）与摩尔分数（$x_X$）之间的转换**：\n    我们从摩尔分数的定义开始，$x_X = \\frac{n_X}{n_X + n_d}$。我们代入 $n_X = m_X/M_X$ 和 $n_d = m_d/M_d$：\n    $$x_X = \\frac{m_X/M_X}{m_X/M_X + m_d/M_d}$$\n    将分子和分母同除以 $m_d$ 得：\n    $$x_X = \\frac{(m_X/m_d)/M_X}{(m_X/m_d)/M_X + 1/M_d} = \\frac{r/M_X}{r/M_X + 1/M_d}$$\n    将分子和分母同乘以 $M_X M_d$ 将表达式简化为：\n    $$x_X = \\frac{r M_d}{r M_d + M_X}$$\n\n3.  **转换为摩尔浓度（$c_X$）**：\n    摩尔浓度 $c_X$ 通过理想气体定律与摩尔分数 $x_X$ 相关。对于混合物，理想气体定律为 $P V = n_{total} R T$，其中 $P$ 是总压， $T$ 是温度， $R$ 是普适气体常数。这可以重新排列以得到气体混合物的总摩尔浓度：\n    $$c_{total} = \\frac{n_{total}}{V} = \\frac{P}{RT}$$\n    示踪剂的摩尔浓度则是示踪剂的摩尔分数乘以总摩尔浓度：\n    $$c_X = \\frac{n_X}{V} = \\frac{n_X}{n_{total}} \\frac{n_{total}}{V} = x_X c_{total}$$\n    代入 $c_{total}$ 的表达式，我们得到：\n    $$c_X = x_X \\frac{P}{RT}$$\n    将此与先前推导的 $x_X$ 关系式结合，我们可以直接用质量混合比 $r$ 表示 $c_X$：\n    $$c_X = \\left( \\frac{r M_d}{M_X + r M_d} \\right) \\frac{P}{RT}$$\n\n### 第二部分：守恒性质\n\n我们分析在可压缩、无粘性流中，速度场为 $\\vec{u}$，且无化学源/汇或分子扩散的情况下的守恒性质。\n\n任何物种 $i$ 的质量守恒由连续性方程描述：\n$$ \\frac{\\partial \\rho_i}{\\partial t} + \\nabla \\cdot (\\rho_i \\vec{u}) = 0 $$\n其中 $\\rho_i$ 是物种 $i$ 的质量浓度（单位体积的质量）。\n\n**严格的欧拉散度守恒形式**：\n如果一个变量 $q$ 满足 $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (q \\vec{u}) = 0$，则其为严格的欧拉散度守恒形式。\n-   对于示踪剂质量浓度 $\\rho_X = m_X/V$，方程为 $\\frac{\\partial \\rho_X}{\\partial t} + \\nabla \\cdot (\\rho_X \\vec{u}) = 0$。因此，$\\rho_X$ 是这种形式的严格守恒量。\n-   将质量守恒方程除以常数摩尔质量 $M_X$，我们得到摩尔守恒方程：$\\frac{\\partial c_X}{\\partial t} + \\nabla \\cdot (c_X \\vec{u}) = 0$，其中 $c_X = \\rho_X/M_X$。因此，摩尔浓度 $c_X$ 也是严格的欧拉散度守恒形式。\n-   诸如 $Y_X$、$r$ 和 $x_X$ 之类的比值量不满足这种守恒形式。例如，对 $Y_X$ 的平流项展开得到 $\\nabla \\cdot (Y_X \\vec{u}) = Y_X(\\nabla \\cdot \\vec{u}) + \\vec{u} \\cdot \\nabla Y_X$。连续性方程将是 $\\frac{\\partial Y_X}{\\partial t} + \\vec{u} \\cdot \\nabla Y_X + Y_X(\\nabla \\cdot \\vec{u}) = 0$。这不符合 $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (q \\vec{u}) = 0$ 的形式。\n\n**沿轨迹的物质守恒**：\n如果一个变量 $q$ 沿着流体质点运动时其值保持不变，那么它就是物质守恒的。这可以用物质导数表示为 $\\frac{Dq}{Dt} \\equiv \\frac{\\partial q}{\\partial t} + \\vec{u} \\cdot \\nabla q = 0$。\n\n混合物的总质量连续性方程是 $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\vec{u}) = 0$，其中 $\\rho = \\rho_d + \\rho_X$。用物质导数表示，这即是 $\\frac{D\\rho}{Dt} = -\\rho (\\nabla \\cdot \\vec{u})$。\n类似地，对于示踪剂，$\\frac{D\\rho_X}{Dt} = -\\rho_X (\\nabla \\cdot \\vec{u})$。对于可压缩流，通常 $\\nabla \\cdot \\vec{u} \\neq 0$，因此质量浓度 $\\rho_X$（以及类似的摩尔浓度 $c_X$）不是物质守恒的。其值会因流体质点的体积变化（压缩或膨胀）而改变。\n\n现在我们分析比值量：\n-   **质量分数 ($Y_X = \\rho_X / \\rho$)**：\n    $$ \\frac{D Y_X}{Dt} = \\frac{D}{Dt}\\left(\\frac{\\rho_X}{\\rho}\\right) = \\frac{1}{\\rho}\\frac{D\\rho_X}{Dt} - \\frac{\\rho_X}{\\rho^2}\\frac{D\\rho}{Dt} = \\frac{1}{\\rho}(-\\rho_X \\nabla \\cdot \\vec{u}) - \\frac{\\rho_X}{\\rho^2}(-\\rho \\nabla \\cdot \\vec{u}) $$\n    $$ \\frac{D Y_X}{Dt} = -\\frac{\\rho_X}{\\rho}(\\nabla \\cdot \\vec{u}) + \\frac{\\rho_X}{\\rho}(\\nabla \\cdot \\vec{u}) = 0 $$\n    因此，质量分数 $Y_X$ 是物质守恒的。\n\n-   **质量混合比 ($r = \\rho_X / \\rho_d$)**：\n    分析与 $Y_X$ 的分析相同，因为干空气也是一个守恒物种，所以 $\\frac{D\\rho_d}{Dt} = -\\rho_d (\\nabla \\cdot \\vec{u})$。\n    $$ \\frac{Dr}{Dt} = \\frac{D}{Dt}\\left(\\frac{\\rho_X}{\\rho_d}\\right) = \\frac{1}{\\rho_d}\\frac{D\\rho_X}{Dt} - \\frac{\\rho_X}{\\rho_d^2}\\frac{D\\rho_d}{Dt} = \\frac{1}{\\rho_d}(-\\rho_X \\nabla \\cdot \\vec{u}) - \\frac{\\rho_X}{\\rho_d^2}(-\\rho_d \\nabla \\cdot \\vec{u}) = 0 $$\n    因此，质量混合比 $r$ 是物质守恒的。\n\n-   **摩尔分数 ($x_X = c_X / c_{total}$)**：\n    逻辑再次相同，但应用于摩尔浓度。我们有 $\\frac{Dc_X}{Dt} = -c_X(\\nabla \\cdot \\vec{u})$ 和 $\\frac{Dc_{total}}{Dt} = -c_{total}(\\nabla \\cdot \\vec{u})$。\n    $$ \\frac{Dx_X}{Dt} = \\frac{D}{Dt}\\left(\\frac{c_X}{c_{total}}\\right) = \\frac{1}{c_{total}}\\frac{Dc_X}{Dt} - \\frac{c_X}{c_{total}^2}\\frac{Dc_{total}}{Dt} = \\frac{1}{c_{total}}(-c_X \\nabla \\cdot \\vec{u}) - \\frac{c_X}{c_{total}^2}(-c_{total} \\nabla \\cdot \\vec{u}) = 0 $$\n    因此，摩尔分数 $x_X$ 是物质守恒的。\n\n**总结与对密度变化的依赖性**：\n-   严格的欧拉散度守恒形式的变量是“单位体积”量：质量浓度 $\\rho_X$ 和摩尔浓度 $c_X$。\n-   物质守恒（沿轨迹恒定）的变量是比值量：质量分数 $Y_X$、质量混合比 $r$ 和摩尔分数 $x_X$。\n-   在可压缩流中，$\\rho_X$ 和 $c_X$ 的守恒性质与 $Y_X$、$r$ 和 $x_X$ 的守恒性质有根本不同。比值量的物质守恒性与密度变化无关，因为膨胀/压缩效应在比值中被抵消了。这使得它们在模拟可压缩流体（如大气）中的示踪剂输运时特别有用。相比之下，“单位体积”量仅在流体不可压缩（$\\nabla \\cdot \\vec{u} = 0$）时才是物质守恒的，此时密度沿轨迹是恒定的。\n\n### 第三部分：摩尔浓度的数值计算\n\n我们使用第一部分推导的公式来计算示踪剂摩尔浓度 $c_X$：\n$$c_X = \\left( \\frac{r M_d}{M_X + r M_d} \\right) \\frac{P}{RT}$$\n给定以下值：\n-   $r = 2.50 \\times 10^{-7}$\n-   $M_d = 28.97 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$\n-   $M_X = 48.00 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$\n-   $P = 85{,}000 \\,\\mathrm{Pa}$\n-   $T = 260 \\,\\mathrm{K}$\n-   $R = 8.314462618 \\,\\mathrm{J\\, mol^{-1}\\, K^{-1}}$\n\n首先，我们计算摩尔分数 $x_X$：\n$$x_X = \\frac{(2.50 \\times 10^{-7}) \\times (28.97 \\times 10^{-3})}{(48.00 \\times 10^{-3}) + (2.50 \\times 10^{-7}) \\times (28.97 \\times 10^{-3})}$$\n$$x_X = \\frac{7.2425 \\times 10^{-9}}{0.0480000072425} \\approx 1.508854 \\times 10^{-7}$$\n接下来，我们计算总摩尔浓度 $P/(RT)$：\n$$\\frac{P}{RT} = \\frac{85000 \\,\\mathrm{Pa}}{(8.314462618 \\,\\mathrm{J\\, mol^{-1}\\, K^{-1}}) \\times (260 \\,\\mathrm{K})} \\approx \\frac{85000}{2161.760} \\,\\mathrm{mol\\,m^{-3}} \\approx 39.3197 \\,\\mathrm{mol\\,m^{-3}}$$\n最后，我们计算 $c_X$：\n$$c_X = x_X \\frac{P}{RT} \\approx (1.508854 \\times 10^{-7}) \\times (39.3197 \\,\\mathrm{mol\\,m^{-3}}) \\approx 5.9326 \\times 10^{-6} \\,\\mathrm{mol\\,m^{-3}}$$\n按要求将结果四舍五入至四位有效数字：\n$$c_X \\approx 5.933 \\times 10^{-6} \\,\\mathrm{mol\\,m^{-3}}$$",
            "answer": "$$ \\boxed{5.933 \\times 10^{-6}} $$"
        },
        {
            "introduction": "将连续的守恒定律转化为计算机可以求解的离散数值算法，需要仔细考虑其稳定性和准确性。一阶迎风格式是解决平流问题的基本构建模块。本练习着重于平流方程的有限体积离散化，并引入关键的 Courant-Friedrichs-Lewy (CFL) 条件。通过计算 Courant 数并分析该格式的稳定性，您将建立起对物理速度 $u$、网格间距 $\\Delta x$ 和时间步长 $\\Delta t$ 之间关系的直观理解，这对于防止模拟中出现非物理振荡或灾难性的不稳定性至关重要。",
            "id": "3870915",
            "problem": "考虑一个长度为 $L$ 的周期性通道中的一维被动示踪剂平流，其速度为恒定的正值 $u$。示踪剂浓度 $q(x,t)$ 满足守恒律 $\\partial_{t} q + \\partial_{x}(u q) = 0$ 和周期性边界条件。在由 $N$ 个宽度为 $\\Delta x$ 的控制体积（单元）组成的均匀网格上，使用有限体积通量形式的离散化方法，以及步长为 $\\Delta t$ 的显式时间步进。对于 $u0$，通过界面 $x_{i+1/2}$ 的数值通量取为迎风值 $F_{i+1/2}^{n} = u\\,q_{i}^{n}$，其中 $q_{i}^{n}$ 表示在时间层 $t^{n}$ 时单元 $i$ 内的单元平均值。\n\n计算参数如下：\n- $L = 180\\,\\text{km}$,\n- $N = 512$,\n- $u = 0.71\\,\\text{m}\\,\\text{s}^{-1}$,\n- $\\Delta t = 300\\,\\text{s}$.\n\n任务：\n1. 计算无量纲的库朗数（Courant number），其定义为一个时间步内流体质点平流的距离与网格间距之比。请用一个纯数字（无单位）表示您的答案，并四舍五入到四位有效数字。\n2. 从控制体积上的局部守恒积分形式和给定的通量形式更新出发，有理有据地解释总示踪剂质量的精确全局守恒如何依赖于离散化及其通量。然后，使用基于相邻单元平均值的凸组合的单调性论证，或使用傅里叶（von Neumann）放大因子分析，推导出该迎风格式对时间步长的稳定性要求（用库朗数表示）。最后，给出 $\\Delta t$ 关于 $u$ 和 $\\Delta x$ 的一个界限，以确保在 $u0$ 时演化是非负、非振荡的。\n\n只有任务1中要求的库朗数会被进行数值评分；请确保您将其四舍五入到四位有效数字，并以无单位的形式报告。所有其他推理必须从守恒和稳定性的第一性原理出发进行充分论证。",
            "solution": "该问题分为两个任务。第一个任务是计算库朗数，第二个任务是对给定数值格式的守恒性和稳定性进行理论分析。\n\n任务1：计算库朗数\n\n问题提供了以下参数：\n-   通道长度, $L = 180\\,\\text{km} = 1.8 \\times 10^{5}\\,\\text{m}$。\n-   网格单元数, $N = 512$。\n-   恒定速度, $u = 0.71\\,\\text{m}\\,\\text{s}^{-1}$。\n-   时间步长, $\\Delta t = 300\\,\\text{s}$。\n\n网格是均匀的，因此每个控制体积的宽度（网格间距）为 $\\Delta x$。\n$$ \\Delta x = \\frac{L}{N} = \\frac{1.8 \\times 10^{5}\\,\\text{m}}{512} = 351.5625\\,\\text{m} $$\n库朗数，我们记为 $C$，定义为一个时间步内平流的距离 $u \\Delta t$ 与网格间距 $\\Delta x$ 之比。\n$$ C = \\frac{u \\Delta t}{\\Delta x} $$\n代入给定值：\n$$ C = \\frac{(0.71\\,\\text{m}\\,\\text{s}^{-1}) \\times (300\\,\\text{s})}{351.5625\\,\\text{m}} = \\frac{213}{351.5625} \\approx 0.605893706... $$\n将结果四舍五入到四位有效数字，我们得到：\n$$ C \\approx 0.6059 $$\n\n任务2：守恒性与稳定性分析\n\n首先，我们讨论示踪剂质量的全局守恒性。控制偏微分方程是一个守恒律，$\\partial_{t} q + \\partial_{x}(uq) = 0$。该定律在控制体积 $V_i = [x_{i-1/2}, x_{i+1/2}]$ 上的积分形式为：\n$$ \\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,t) \\,dx + \\left[uq\\right]_{x=x_{i+1/2}} - \\left[uq\\right]_{x=x_{i-1/2}} = 0 $$\n令 $q_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,t) \\,dx$ 为单元 $i$ 中的单元平均浓度。积分形式变为：\n$$ \\Delta x \\frac{d q_i}{dt} + F(x_{i+1/2}, t) - F(x_{i-1/2}, t) = 0 $$\n其中 $F(x,t) = uq(x,t)$ 是连续通量。有限体积法通过用有限差分近似时间导数，并用数值通量 $F_{i\\pm1/2}^n$ 近似界面处的通量 $F(x_{i\\pm1/2}, t)$ 来进行离散化。使用显式前向欧拉时间步，我们得到：\n$$ \\frac{q_i^{n+1} - q_i^n}{\\Delta t} \\Delta x + F_{i+1/2}^n - F_{i-1/2}^n = 0 $$\n重新整理可得单元平均值的通量形式更新方程：\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) $$\n在时间层 $t^n$ 时，离散系统中的总示踪剂质量是每个单元中质量的总和，$M^n = \\sum_{i=1}^{N} q_i^n \\Delta x$。为了评估其守恒性，我们将更新方程对所有单元 $i = 1, \\dots, N$ 求和：\n$$ \\sum_{i=1}^{N} q_i^{n+1} = \\sum_{i=1}^{N} q_i^n - \\frac{\\Delta t}{\\Delta x} \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) $$\n乘以 $\\Delta x$ 得到总质量的更新：\n$$ M^{n+1} = M^n - \\Delta t \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) $$\n通量差之和是一个伸缩级数：\n$$ \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) = (F_{3/2}^n - F_{1/2}^n) + (F_{5/2}^n - F_{3/2}^n) + \\dots + (F_{N+1/2}^n - F_{N-1/2}^n) = F_{N+1/2}^n - F_{1/2}^n $$\n通量形式守恒格式的关键在于，在 $x_{i+1/2}$ 处离开单元 $i$ 的通量（即 $-F_{i+1/2}^n$）与在同一界面进入单元 $i+1$ 的通量（即 $+F_{i+1/2}^n$）完全相同。正是这种抵消导致了伸缩求和。对于周期性边界条件，单元 $N+1$ 与单元 $1$ 等同，因此界面 $x_{N+1/2}$ 与界面 $x_{1/2}$ 相同。这意味着通量必须相等：$F_{N+1/2}^n = F_{1/2}^n$。因此，所有通量差的总和为零：\n$$ \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) = 0 $$\n这导致 $M^{n+1} = M^n$。因此，总示踪剂质量在每个时间步都精确守恒，这是在周期性域上使用通量形式离散化的直接结果。\n\n接下来，我们推导稳定性要求。问题指定了 $u0$ 时的迎风通量，即 $F_{i+1/2}^n = u q_i^n$。在单元 $i$ 的左界面 $x_{i-1/2}$ 处的通量由单元 $i-1$ 中的状态决定，因此 $F_{i-1/2}^n = u q_{i-1}^n$。将这些代入更新方程：\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x} \\left( u q_i^n - u q_{i-1}^n \\right) $$\n引入无量纲库朗数 $C = \\frac{u \\Delta t}{\\Delta x}$，该格式变为：\n$$ q_i^{n+1} = q_i^n - C (q_i^n - q_{i-1}^n) $$\n重新整理各项，我们可以将新值 $q_i^{n+1}$ 表示为单元 $i$ 中旧值及其迎风邻居单元 $i-1$ 中旧值的线性组合：\n$$ q_i^{n+1} = (1 - C) q_i^n + C q_{i-1}^n $$\n为了使格式能确保非负演化（即，如果对所有 $j$ 都有 $q_j^n \\ge 0$，则 $q_i^{n+1} \\ge 0$）并且非振荡（单调，意味着不产生新的局部极值），值 $q_i^{n+1}$ 必须是计算它所用的值（这里是 $q_i^n$ 和 $q_{i-1}^n$）的凸组合。凸组合要求系数为非负且总和为1。\n系数之和为 $(1 - C) + C = 1$，这总是成立的。\n为了使系数为非负，我们需要：\n1.  $C \\ge 0$\n2.  $1 - C \\ge 0$\n\n由于 $u0$、$\\Delta t0$ 和 $\\Delta x0$，库朗数 $C$ 总是非负的，因此第一个条件得到满足。第二个条件 $1 - C \\ge 0$ 意味着 $C \\le 1$。\n综合这些，非负、非振荡演化的条件是 $0 \\le C \\le 1$。这是一阶迎风格式的稳定性要求。\n将此要求表示为对时间步长 $\\Delta t$ 的一个界限：\n$$ \\frac{u \\Delta t}{\\Delta x} \\le 1 $$\n$$ \\Delta t \\le \\frac{\\Delta x}{u} $$\n这就是该格式的 Courant-Friedrichs-Lewy (CFL) 条件。它的物理解释是，在单个时间步内，信息（或示踪剂）的传播距离不能超过一个网格单元的宽度。满足此条件可确保数值解是稳定的，并保持如非负性等具有物理意义的性质。",
            "answer": "$$ \\boxed{0.6059} $$"
        },
        {
            "introduction": "守恒原理虽然是全局性的，但其数值实现却是局部的，关键取决于如何在计算单元的交界面上计算通量，尤其是在计算域的边界上。这个编程练习将带您深入研究在交错网格（一种在地球物理模型中常见的设置）上计算平流通量的细致过程。通过实现正确的和两种典型的错误边界条件，您将亲身体验看似微小的错误如何导致示踪剂的人为产生或消失（即“泄漏”），从而加深理解为何严谨的守恒通量计算对于物理上真实的模拟至关重要。",
            "id": "3870921",
            "problem": "您正在一个二维均匀交错网格（Arakawa C-网格）上模拟一种被动示踪剂的平流。示踪剂浓度定义在网格中心，$x$ 方向的速度分量定义在垂直面上，$y$ 方向的速度分量定义在水平面上。其控制定律是积分形式的示踪剂守恒：对于任何固定的控制体，示踪剂含量的变化率等于穿过其边界的净向外平流通量的负值。您必须推导并实现一种对整个区域净边界通量的守恒计算方法，并将其与两种会导致泄漏的常见非守恒边界实现进行对比。\n\n从有限体积守heng陈述出发，该陈述针对面积为 $A$ 、边界 $\\partial \\Omega$ 上具有向外单位法向量 $\\boldsymbol{n}$ 的单个单元格进行表述：$$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\int_{\\Omega} c \\, \\mathrm{d}A\\right) \\;=\\; - \\oint_{\\partial \\Omega} \\left( \\boldsymbol{u}\\, c\\right)\\cdot \\boldsymbol{n} \\, \\mathrm{d}s,$$ 其中 $c$ 是浓度，$\\boldsymbol{u}$ 是速度。在一个间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀网格上，将其解释为逐个离散面的通量之和，同时要遵循向外法向量的方向并在各个面上对 $c$ 使用一致的迎风格式。使用以下定义和约定：\n- 网格在 $x$ 方向上有 $N_x$ 个单元格，在 $y$ 方向上有 $N_y$ 个单元格。\n- 示踪剂值 $c_{i,j}$ 位于网格中心，其索引为 $i \\in \\{0,\\dots,N_x-1\\}$ 和 $j \\in \\{0,\\dots,N_y-1\\}$。\n- $x$ 方向速度 $u_{i,j}$ 定义在垂直面上，其索引为 $i \\in \\{0,\\dots,N_x\\}$ 和 $j \\in \\{0,\\dots,N_y-1\\}$，并配置在分隔单元格 $i-1$ 和 $i$ 的 $x$ 方向面上。左边界（$i=0$）的向外法向量为 $-\\hat{\\boldsymbol{x}}$，右边界（$i=N_x$）的向外法向量为 $+\\hat{\\boldsymbol{x}}$。\n- $y$ 方向速度 $v_{i,j}$ 定义在水平面上，其索引为 $i \\in \\{0,\\dots,N_x-1\\}$ 和 $j \\in \\{0,\\dots,N_y\\}$，并配置在分隔单元格 $j-1$ 和 $j$ 的 $y$ 方向面上。下边界（$j=0$）的向外法向量为 $-\\hat{\\boldsymbol{y}}$，上边界（$j=N_y$）的向外法向量为 $+\\hat{\\boldsymbol{y}}$。\n- 对于面上平流通量的迎风计算，如果流动是向外的，则使用上游侧相邻内部单元格的值；如果流动是从域外向内的，则使用入流边界浓度。\n- 每个垂直面的通量贡献与其边长 $\\Delta y$ 成正比，每个水平面的通量贡献与其边长 $\\Delta x$ 成正比。\n\n您的程序必须为每个测试用例计算三个量：\n- 正确的守恒净向外边界通量 $F_{\\text{corr}}$，通过对各个面的通量求和计算得出，其中通量计算使用了一致的迎风示踪剂值、正确的面长度和正确的向外法线符号。\n- 一种非守恒的净向外边界通量 $F_{\\text{ghost}}$，它对入流边界使用错误的虚拟单元处理方法计算：当边界面有入流（速度指向内部）时，不使用指定的入流浓度，而是使用相邻内部单元格值的一半（$\\tfrac{1}{2} c_{\\text{adj}}$）；对于出流，则不变地使用内部值；使用正确的面长度和向外法线符号。\n- 一种非守恒的净向外边界通量 $F_{\\text{area}}$，它使用正确的迎风格式但错误的面长度分配来计算：所有垂直面使用 $\\Delta x$，所有水平面使用 $\\Delta y$，而不是正确的垂直面使用 $\\Delta y$ 和水平面使用 $\\Delta x$；使用正确的向外法线符号。\n\n此问题中的所有变量均为无量纲；所有输出均以十进制数表示。\n\n为以下测试套件实现上述计算。对于每种情况，请完全按照规定构造数组：\n\n- 情况 1（理想情况，边界通量为零）：\n  - $N_x = 4$, $N_y = 3$, $\\Delta x = 1$, $\\Delta y = 1$。\n  - 对所有 $i,j$，$c_{i,j} = 1$。\n  - 对所有 $i \\in \\{0,\\dots,4\\}$, $j \\in \\{0,\\dots,2\\}$，$u_{i,j} = 0$。\n  - 对所有 $i \\in \\{0,\\dots,3\\}$, $j \\in \\{0,\\dots,3\\}$，$v_{i,j} = 0$。\n  - 入流边界浓度已定义但未使用：将左、右、下、上边界设置为标量值 $1$。\n\n- 情况 2（$x$ 方向均匀流动，左侧为高浓度入流）：\n  - $N_x = 5$, $N_y = 4$, $\\Delta x = 1$, $\\Delta y = 1$。\n  - 对所有 $i,j$，$c_{i,j} = 1$。\n  - 对所有 $i \\in \\{0,\\dots,5\\}$, $j \\in \\{0,\\dots,3\\}$，$u_{i,j} = 1$。\n  - 对所有 $i \\in \\{0,\\dots,4\\}$, $j \\in \\{0,\\dots,4\\}$，$v_{i,j} = 0$。\n  - 左侧入流边界浓度为标量 $2$；其他入流边界浓度未使用。\n\n- 情况 3（$y$ 方向示踪剂不均匀，顶部和底部有垂直出流）：\n  - $N_x = 3$, $N_y = 3$, $\\Delta x = 1$, $\\Delta y = 2$。\n  - 对所有 $i \\in \\{0,\\dots,2\\}$ 和 $j \\in \\{0,\\dots,2\\}$，$c_{i,j} = 1 + 0.5\\, j$。\n  - 对所有 $i \\in \\{0,\\dots,3\\}$, $j \\in \\{0,\\dots,2\\}$，$u_{i,j} = 0$。\n  - 对所有 $i \\in \\{0,\\dots,2\\}$，$v_{i,0} = -2$（下边界），对所有 $i \\in \\{0,\\dots,2\\}$，$v_{i,3} = 1$（上边界），其他情况 $v_{i,j} = 0$。\n  - 未使用入流边界浓度。\n\n- 情况 4（单个单元格，混合入流和出流）：\n  - $N_x = 1$, $N_y = 1$, $\\Delta x = 3$, $\\Delta y = 2$。\n  - $c_{0,0} = 1.5$。\n  - 左边界 $u_{0,0} = 0$，右边界 $u_{1,0} = 0.7$。\n  - 下边界 $v_{0,0} = 0.1$，上边界 $v_{0,1} = -0.2$。\n  - 底部入流边界浓度为标量 $1$，顶部为标量 $3$。\n\n您的程序必须：\n- 为每种情况构造上述数组。\n- 为每种情况计算 $F_{\\text{corr}}$、$F_{\\text{ghost}}$ 和 $F_{\\text{area}}$。\n- 生成单行输出，其中包含按顺序排列的 $12$ 个结果，形式为方括号括起来的逗号分隔列表：$[F_{\\text{corr},1},F_{\\text{ghost},1},F_{\\text{area},1},F_{\\text{corr},2},F_{\\text{ghost},2},F_{\\text{area},2},F_{\\text{corr},3},F_{\\text{ghost},3},F_{\\text{area},3},F_{\\text{corr},4},F_{\\text{ghost},4},F_{\\text{area},4}]$。\n\n设计您的解决方案，使其能够通过给定的测试套件进行验证。重点在于正确应用向外法线符号，在入流和出流面上选择正确的迎风示踪剂值，并乘以正确的面长度。此外，还要实现上述两种特定的非守恒变体。最终输出为无量纲十进制数。",
            "solution": "该问题要求计算被动示踪剂穿过二维区域边界的净向外平流通量。计算将在一个均匀、交错的 Arakawa C-网格上进行。我们必须首先推导出正确的守恒通量 $F_{\\text{corr}}$，然后推导两种非守恒的变体 $F_{\\text{ghost}}$ 和 $F_{\\text{area}}$。\n\n其控制原理是浓度为 $c$、被速度场 $\\boldsymbol{u}$ 平流的示踪剂的积分守恒定律：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\int_{\\Omega} c \\, \\mathrm{d}A\\right) = - \\oint_{\\partial \\Omega} (\\boldsymbol{u} c) \\cdot \\boldsymbol{n} \\, \\mathrm{d}s $$\n右边的项是净向外通量的负值。我们需要计算整个计算域的这个净向外通量 $F_{\\text{net}} = \\oint_{\\partial \\Omega} (\\boldsymbol{u} c) \\cdot \\boldsymbol{n} \\, \\mathrm{d}s$。该区域的边界由四个部分组成：左、右、下、上。总通量是通过这四个部分的通量之和：$F_{\\text{net}} = F_{\\text{left}} + F_{\\text{right}} + F_{\\text{bottom}} + F_{\\text{top}}$。\n\n我们将对每个边界段的通量积分进行离散化。网格尺寸为 $N_x \\times N_y$，单元格间距为 $\\Delta x$ 和 $\\Delta y$。\n-   示踪剂浓度 $c_{i,j}$ 位于网格中心，其索引为 $i \\in \\{0, \\dots, N_x-1\\}$ 和 $j \\in \\{0, \\dots, N_y-1\\}$。\n-   $x$ 方向速度 $u_{i,j}$ 位于垂直面上，其索引为 $i \\in \\{0, \\dots, N_x\\}$ 和 $j \\in \\{0, \\dots, N_y-1\\}$。\n-   $y$ 方向速度 $v_{i,j}$ 位于水平面上，其索引为 $i \\in \\{0, \\dots, N_x-1\\}$ 和 $j \\in \\{0, \\dots, N_y\\}$。\n\n迎风原理用于确定每个面上的示踪剂浓度 $c$。对于穿过法向量为 $\\boldsymbol{n}$ 的面的流速 $\\boldsymbol{u}$，如果流动方向是从区域向外（$\\boldsymbol{u} \\cdot \\boldsymbol{n}  0$），$c$ 取自相邻的内部单元格。如果流动是向内的（$\\boldsymbol{u} \\cdot \\boldsymbol{n}  0$），$c$ 取自指定的入流边界条件。\n\n**1. 正确守恒通量 $F_{\\text{corr}}$ 的推导**\n\n通量是对所有边界面求和的。\n\n**左边界（在 $i=0$ 处）：**\n边界由 $N_y$ 个垂直面组成，索引为 $j \\in \\{0, \\dots, N_y-1\\}$。向外法向量为 $\\boldsymbol{n} = -\\hat{\\boldsymbol{x}}$。面长度为 $\\Delta y$。速度为 $u_{0,j}$。\n通过面 $j$ 的向外通量为 $((\\boldsymbol{u}c) \\cdot \\boldsymbol{n})_j \\Delta y = -u_{0,j} c_{\\text{face}} \\Delta y$。\n-   如果 $u_{0,j}  0$：入流。$c_{\\text{face}} = c_{\\text{left},j}$（指定的入流浓度）。通量为 $-u_{0,j} c_{\\text{left},j} \\Delta y$。\n-   如果 $u_{0,j} \\le 0$：出流。$c_{\\text{face}} = c_{0,j}$（相邻内部单元格）。通量为 $-u_{0,j} c_{0,j} \\Delta y$。\n总通量为：\n$$ F_{\\text{left}} = - \\Delta y \\sum_{j=0}^{N_y-1} \\left[ (u_{0,j})^+ c_{\\text{left},j} + (u_{0,j})^- c_{0,j} \\right] $$\n其中 $(x)^+ = \\max(x,0)$ 且 $(x)^- = \\min(x,0)$。\n\n**右边界（在 $i=N_x$ 处）：**\n边界由 $N_y$ 个垂直面组成，索引为 $j \\in \\{0, \\dots, N_y-1\\}$。向外法向量为 $\\boldsymbol{n} = +\\hat{\\boldsymbol{x}}$。面长度为 $\\Delta y$。速度为 $u_{N_x,j}$。\n通过面 $j$ 的向外通量为 $u_{N_x,j} c_{\\text{face}} \\Delta y$。\n-   如果 $u_{N_x,j}  0$：出流。$c_{\\text{face}} = c_{N_x-1,j}$。通量为 $u_{N_x,j} c_{N_x-1,j} \\Delta y$。\n-   如果 $u_{N_x,j} \\le 0$：入流。$c_{\\text{face}} = c_{\\text{right},j}$。通量为 $u_{N_x,j} c_{\\text{right},j} \\Delta y$。\n总通量为：\n$$ F_{\\text{right}} = \\Delta y \\sum_{j=0}^{N_y-1} \\left[ (u_{N_x,j})^+ c_{N_x-1,j} + (u_{N_x,j})^- c_{\\text{right},j} \\right] $$\n\n**下边界（在 $j=0$ 处）：**\n边界由 $N_x$ 个水平面组成，索引为 $i \\in \\{0, \\dots, N_x-1\\}$。向外法向量为 $\\boldsymbol{n} = -\\hat{\\boldsymbol{y}}$。面长度为 $\\Delta x$。速度为 $v_{i,0}$。\n通过面 $i$ 的向外通量为 $-v_{i,0} c_{\\text{face}} \\Delta x$。\n-   如果 $v_{i,0}  0$：入流。$c_{\\text{face}} = c_{\\text{bottom},i}$。通量为 $-v_{i,0} c_{\\text{bottom},i} \\Delta x$。\n-   如果 $v_{i,0} \\le 0$：出流。$c_{\\text{face}} = c_{i,0}$。通量为 $-v_{i,0} c_{i,0} \\Delta x$。\n总通量为：\n$$ F_{\\text{bottom}} = - \\Delta x \\sum_{i=0}^{N_x-1} \\left[ (v_{i,0})^+ c_{\\text{bottom},i} + (v_{i,0})^- c_{i,0} \\right] $$\n\n**上边界（在 $j=N_y$ 处）：**\n边界由 $N_x$ 个水平面组成，索引为 $i \\in \\{0, \\dots, N_x-1\\}$。向外法向量为 $\\boldsymbol{n} = +\\hat{\\boldsymbol{y}}$。面长度为 $\\Delta x$。速度为 $v_{i,N_y}$。\n通过面 $i$ 的向外通量为 $v_{i,N_y} c_{\\text{face}} \\Delta x$。\n-   如果 $v_{i,N_y}  0$：出流。$c_{\\text{face}} = c_{i,N_y-1}$。通量为 $v_{i,N_y} c_{i,N_y-1} \\Delta x$。\n-   如果 $v_{i,N_y} \\le 0$：入流。$c_{\\text{face}} = c_{\\text{top},i}$。通量为 $v_{i,N_y} c_{\\text{top},i} \\Delta x$。\n总通量为：\n$$ F_{\\text{top}} = \\Delta x \\sum_{i=0}^{N_x-1} \\left[ (v_{i,N_y})^+ c_{i,N_y-1} + (v_{i,N_y})^- c_{\\text{top},i} \\right] $$\n\n总的正确守恒通量为 $F_{\\text{corr}} = F_{\\text{left}} + F_{\\text{right}} + F_{\\text{bottom}} + F_{\\text{top}}$。\n\n**2. 非守恒通量 $F_{\\text{ghost}}$ 的推导**\n\n这个变体修改了入流边界条件。在入流的情况下，浓度取为相邻内部单元格值的一半，即 $c_{\\text{inflow}} = \\frac{1}{2} c_{\\text{adj}}$。出流逻辑和面长度保持正确。\n-   左侧入流（$u_{0,j} > 0$）：使用 $c = \\frac{1}{2} c_{0,j}$。\n-   右侧入流（$u_{N_x,j}  0$）：使用 $c = \\frac{1}{2} c_{N_x-1,j}$。\n-   底部入流（$v_{i,0} > 0$）：使用 $c = \\frac{1}{2} c_{i,0}$。\n-   顶部入流（$v_{i,N_y}  0$）：使用 $c = \\frac{1}{2} c_{i,N_y-1}$。\n通量公式也相应调整。例如，对于左边界，通量变为：\n$$ F_{\\text{left,ghost}} = - \\Delta y \\sum_{j=0}^{N_y-1} \\left[ (u_{0,j})^+ \\left(\\frac{1}{2} c_{0,j}\\right) + (u_{0,j})^- c_{0,j} \\right] $$\n对其他边界也进行类似的替换。\n\n**3. 非守恒通量 $F_{\\text{area}}$ 的推导**\n\n此变体使用正确的迎风逻辑，但采用错误的面长度。垂直面（左/右）被分配长度 $\\Delta x$ 而非 $\\Delta y$，水平面（下/上）被分配长度 $\\Delta y$ 而非 $\\Delta x$。四个边界通量的表达式与 $F_{\\text{corr}}$ 的表达式相同，但 $\\Delta x$ 和 $\\Delta y$ 互换。例如，对于左边界：\n$$ F_{\\text{left,area}} = - \\Delta x \\sum_{j=0}^{N_y-1} \\left[ (u_{0,j})^+ c_{\\text{left},j} + (u_{0,j})^- c_{0,j} \\right] $$\n对于下边界：\n$$ F_{\\text{bottom,area}} = - \\Delta y \\sum_{i=0}^{N_x-1} \\left[ (v_{i,0})^+ c_{\\text{bottom},i} + (v_{i,0})^- c_{i,0} \\right] $$\n\n实现过程将为每个测试用例构建指定的场，并应用这三套公式来计算 $F_{\\text{corr}}$、$F_{\\text{ghost}}$ 和 $F_{\\text{area}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_fluxes(case_data):\n    \"\"\"\n    Computes the net outward boundary flux for a given case.\n    The function calculates three versions of the flux:\n    1. F_corr: Correct conservative flux.\n    2. F_ghost: Non-conservative flux with erroneous ghost-cell inflow.\n    3. F_area: Non-conservative flux with erroneous face area assignments.\n    \"\"\"\n    Nx = case_data['Nx']\n    Ny = case_data['Ny']\n    dx = case_data['dx']\n    dy = case_data['dy']\n    c_field = case_data['c']\n    u_field = case_data['u']\n    v_field = case_data['v']\n    c_inflow = case_data['c_inflow']\n    \n    F_corr = 0.0\n    F_ghost = 0.0\n    F_area = 0.0\n\n    # Left boundary (i=0)\n    for j in range(Ny):\n        u = u_field[0, j]\n        if u > 0:  # Inflow\n            # Correct\n            c_up_corr = c_inflow['left']\n            F_corr += -u * c_up_corr * dy\n            # Ghost\n            c_up_ghost = 0.5 * c_field[0, j]\n            F_ghost += -u * c_up_ghost * dy\n            # Area\n            F_area += -u * c_up_corr * dx\n        else:  # Outflow (u = 0)\n            c_up = c_field[0, j]\n            # Correct\n            F_corr += -u * c_up * dy\n            # Ghost (same as correct for outflow)\n            F_ghost += -u * c_up * dy\n            # Area\n            F_area += -u * c_up * dx\n\n    # Right boundary (i=Nx)\n    for j in range(Ny):\n        u = u_field[Nx, j]\n        if u > 0:  # Outflow\n            c_up = c_field[Nx - 1, j]\n            # Correct\n            F_corr += u * c_up * dy\n            # Ghost (same as correct for outflow)\n            F_ghost += u * c_up * dy\n            # Area\n            F_area += u * c_up * dx\n        else:  # Inflow (u = 0)\n            c_up_corr = c_inflow['right']\n            # Correct\n            F_corr += u * c_up_corr * dy\n            # Ghost\n            c_up_ghost = 0.5 * c_field[Nx-1, j]\n            F_ghost += u * c_up_ghost * dy\n            # Area\n            F_area += u * c_up_corr * dx\n\n    # Bottom boundary (j=0)\n    for i in range(Nx):\n        v = v_field[i, 0]\n        if v > 0:  # Inflow\n            c_up_corr = c_inflow['bottom']\n            # Correct\n            F_corr += -v * c_up_corr * dx\n            # Ghost\n            c_up_ghost = 0.5 * c_field[i, 0]\n            F_ghost += -v * c_up_ghost * dx\n            # Area\n            F_area += -v * c_up_corr * dy\n        else:  # Outflow (v = 0)\n            c_up = c_field[i, 0]\n            # Correct\n            F_corr += -v * c_up * dx\n            # Ghost (same as correct for outflow)\n            F_ghost += -v * c_up * dx\n            # Area\n            F_area += -v * c_up * dy\n\n    # Top boundary (j=Ny)\n    for i in range(Nx):\n        v = v_field[i, Ny]\n        if v > 0:  # Outflow\n            c_up = c_field[i, Ny-1]\n            # Correct\n            F_corr += v * c_up * dx\n            # Ghost (same as correct for outflow)\n            F_ghost += v * c_up * dx\n            # Area\n            F_area += v * c_up * dy\n        else:  # Inflow (v = 0)\n            c_up_corr = c_inflow['top']\n            # Correct\n            F_corr += v * c_up_corr * dx\n            # Ghost\n            c_up_ghost = 0.5 * c_field[i, Ny-1]\n            F_ghost += v * c_up_ghost * dx\n            # Area\n            F_area += v * c_up_corr * dy\n            \n    return F_corr, F_ghost, F_area\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = []\n\n    # Case 1\n    Nx1, Ny1 = 4, 3\n    c1 = np.ones((Nx1, Ny1))\n    u1 = np.zeros((Nx1 + 1, Ny1))\n    v1 = np.zeros((Nx1, Ny1 + 1))\n    c_in1 = {'left': 1.0, 'right': 1.0, 'bottom': 1.0, 'top': 1.0}\n    test_cases.append({'Nx': Nx1, 'Ny': Ny1, 'dx': 1.0, 'dy': 1.0, 'c': c1, 'u': u1, 'v': v1, 'c_inflow': c_in1})\n\n    # Case 2\n    Nx2, Ny2 = 5, 4\n    c2 = np.ones((Nx2, Ny2))\n    u2 = np.ones((Nx2 + 1, Ny2))\n    v2 = np.zeros((Nx2, Ny2 + 1))\n    c_in2 = {'left': 2.0, 'right': 1.0, 'bottom': 1.0, 'top': 1.0}\n    test_cases.append({'Nx': Nx2, 'Ny': Ny2, 'dx': 1.0, 'dy': 1.0, 'c': c2, 'u': u2, 'v': v2, 'c_inflow': c_in2})\n\n    # Case 3\n    Nx3, Ny3 = 3, 3\n    c3 = np.zeros((Nx3, Ny3))\n    j_indices = np.arange(Ny3)\n    c3[:, :] = 1.0 + 0.5 * j_indices\n    u3 = np.zeros((Nx3 + 1, Ny3))\n    v3 = np.zeros((Nx3, Ny3 + 1))\n    v3[:, 0] = -2.0\n    v3[:, 3] = 1.0\n    c_in3 = {'left': 0.0, 'right': 0.0, 'bottom': 0.0, 'top': 0.0} # Not used\n    test_cases.append({'Nx': Nx3, 'Ny': Ny3, 'dx': 1.0, 'dy': 2.0, 'c': c3, 'u': u3, 'v': v3, 'c_inflow': c_in3})\n\n    # Case 4\n    Nx4, Ny4 = 1, 1\n    c4 = np.full((Nx4, Ny4), 1.5)\n    u4 = np.zeros((Nx4 + 1, Ny4))\n    u4[1, 0] = 0.7\n    v4 = np.zeros((Nx4, Ny4 + 1))\n    v4[0, 0] = 0.1\n    v4[0, 1] = -0.2\n    c_in4 = {'left': 0.0, 'right': 0.0, 'bottom': 1.0, 'top': 3.0}\n    test_cases.append({'Nx': Nx4, 'Ny': Ny4, 'dx': 3.0, 'dy': 2.0, 'c': c4, 'u': u4, 'v': v4, 'c_inflow': c_in4})\n\n    results = []\n    for case in test_cases:\n        F_corr, F_ghost, F_area = calculate_fluxes(case)\n        results.extend([F_corr, F_ghost, F_area])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}'.rstrip('0').rstrip('.') if '.' in f'{r:.10f}' else f'{r:.1f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}