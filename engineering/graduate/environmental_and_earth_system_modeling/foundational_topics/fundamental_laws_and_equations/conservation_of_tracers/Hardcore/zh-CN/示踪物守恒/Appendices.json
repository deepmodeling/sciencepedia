{
    "hands_on_practices": [
        {
            "introduction": "在模拟地球系统中的示踪剂时，我们选择的变量（如混合比或摩尔浓度）会极大地影响其在可压缩流体（如大气）中的守恒特性。本练习将引导你推导不同示踪剂变量之间的转换关系，并从基本原理出发，辨析哪些变量在欧拉框架下是严格守恒的，哪些则在拉格朗日视角下沿轨迹守恒。通过这个过程，你将深刻理解在建模实践中选择合适示踪剂表达方式的重要性。",
            "id": "3870913",
            "problem": "一种稀释气相示踪物种 $X$ 在可压缩、无粘性、绝热的大气流中输运，其分子扩散可忽略不计，且没有化学源或汇。该混合物表现为理想气体。干空气的摩尔质量为 $M_{d} = 28.97 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$，示踪剂的摩尔质量为 $M_{X} = 48.00 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$。在某一位置和时间，状态为 $P = 85{,}000 \\,\\mathrm{Pa}$ 和 $T = 260 \\,\\mathrm{K}$。示踪剂由其相对于干空气的质量混合比指定，定义为 $r \\equiv m_{X}/m_{d}$，其值为 $r = 2.50 \\times 10^{-7}$。\n\n任务：\n- 仅使用基本定义和理想气体定律，推导示踪剂质量混合比 $r$、示踪剂质量分数 $Y_{X}$、示踪剂摩尔分数 $x_{X}$ 和示踪剂摩尔浓度 $c_{X}$ 之间的转换关系。\n- 从各组分和混合物的质量守恒出发，推导在可压缩流中哪些变量形式在欧拉散度形式下是严格守恒的，哪些变量是沿轨迹物质守恒的。解释守恒性质如何依赖于所选变量和密度变化。\n- 计算在指定状态下示踪剂摩尔浓度 $c_{X}$ 的数值。\n\n使用普适气体常数 $R = 8.314462618 \\,\\mathrm{J\\, mol^{-1}\\, K^{-1}}$。将您的最终数值答案四舍五入到四位有效数字。最终浓度以 $\\mathrm{mol\\, m^{-3}}$ 表示。仅报告摩尔浓度 $c_{X}$作为您的最终数值答案。",
            "solution": "该问题经评估具有科学依据、提法恰当、客观且内部一致。这是大气科学和流体动力学中关于被动示踪剂输运和表示的一个标准问题。所有必要信息都已提供，以获得唯一解。\n\n根据题目要求，解答分为三个部分：转换公式的推导、守恒性质的分析以及示踪剂摩尔浓度的数值计算。\n\n### 第1部分：示踪剂变量之间的转换\n\n给定示踪物种 $X$ 在与干空气 ($d$) 的混合物中的以下量的定义：\n- 质量混合比：$r \\equiv \\frac{m_X}{m_d}$，其中 $m_X$ 和 $m_d$ 分别是示踪剂和干空气的质量。\n- 质量分数：$Y_X \\equiv \\frac{m_X}{m_{total}} = \\frac{m_X}{m_X + m_d}$。\n- 摩尔分数：$x_X \\equiv \\frac{n_X}{n_{total}} = \\frac{n_X}{n_X + n_d}$，其中 $n_X$ 和 $n_d$ 是摩尔数。\n- 摩尔浓度：$c_X \\equiv \\frac{n_X}{V}$，其中 $V$ 是体积。\n\n质量 $m$、摩尔数 $n$ 和摩尔质量 $M$ 之间的关系是 $m = n M$。\n\n1.  **质量混合比 ($r$) 和质量分数 ($Y_X$) 之间的转换**：\n    根据定义，$Y_X = \\frac{m_X}{m_X + m_d}$。将分子和分母同除以 $m_d$ 得：\n    $$Y_X = \\frac{m_X/m_d}{m_X/m_d + 1} = \\frac{r}{r+1}$$\n    反之，要用 $Y_X$ 表示 $r$，我们可以使用干空气质量分数的定义，$Y_d = \\frac{m_d}{m_{total}} = 1 - Y_X$。\n    $$r = \\frac{m_X}{m_d} = \\frac{m_X/m_{total}}{m_d/m_{total}} = \\frac{Y_X}{Y_d} = \\frac{Y_X}{1 - Y_X}$$\n\n2.  **质量混合比 ($r$) 和摩尔分数 ($x_X$) 之间的转换**：\n    我们从摩尔分数的定义开始，$x_X = \\frac{n_X}{n_X + n_d}$。代入 $n_X = m_X/M_X$ 和 $n_d = m_d/M_d$：\n    $$x_X = \\frac{m_X/M_X}{m_X/M_X + m_d/M_d}$$\n    将分子和分母同除以 $m_d$ 得：\n    $$x_X = \\frac{(m_X/m_d)/M_X}{(m_X/m_d)/M_X + 1/M_d} = \\frac{r/M_X}{r/M_X + 1/M_d}$$\n    将分子和分母同乘以 $M_X M_d$ 可简化表达式为：\n    $$x_X = \\frac{r M_d}{r M_d + M_X}$$\n\n3.  **转换为摩尔浓度 ($c_X$)**：\n    摩尔浓度 $c_X$ 通过理想气体定律与摩尔分数 $x_X$ 相关。对于混合物，理想气体定律为 $P V = n_{total} R T$，其中 $P$ 是总压， $T$ 是温度， $R$ 是普适气体常数。这可以重新排列得到气体混合物的总摩尔浓度：\n    $$c_{total} = \\frac{n_{total}}{V} = \\frac{P}{RT}$$\n    示踪剂的摩尔浓度即为其摩尔分数乘以总摩尔浓度：\n    $$c_X = \\frac{n_X}{V} = \\frac{n_X}{n_{total}} \\frac{n_{total}}{V} = x_X c_{total}$$\n    代入 $c_{total}$ 的表达式，我们得到：\n    $$c_X = x_X \\frac{P}{RT}$$\n    通过将其与先前推导的 $x_X$ 关系式结合，我们可以直接用质量混合比 $r$ 表示 $c_X$：\n    $$c_X = \\left( \\frac{r M_d}{M_X + r M_d} \\right) \\frac{P}{RT}$$\n\n### 第2部分：守恒性质\n\n我们分析在速度场为 $\\vec{u}$ 的可压缩、无粘性流中，且无化学源/汇或分子扩散时的守恒性质。\n\n任何物种 $i$ 的质量守恒由连续性方程描述：\n$$ \\frac{\\partial \\rho_i}{\\partial t} + \\nabla \\cdot (\\rho_i \\vec{u}) = 0 $$\n其中 $\\rho_i$ 是物种 $i$ 的质量浓度（单位体积的质量）。\n\n**欧拉散度形式下严格守恒**：\n如果一个变量 $q$ 满足 $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (q \\vec{u}) = 0$，则它在欧拉散度形式下是严格守恒的。\n-   对于示踪剂质量浓度 $\\rho_X = m_X/V$，方程为 $\\frac{\\partial \\rho_X}{\\partial t} + \\nabla \\cdot (\\rho_X \\vec{u}) = 0$。因此，$\\rho_X$ 在此形式下是严格守恒的。\n-   将质量守恒方程除以常数摩尔质量 $M_X$，我们得到摩尔守恒方程：$\\frac{\\partial c_X}{\\partial t} + \\nabla \\cdot (c_X \\vec{u}) = 0$，其中 $c_X = \\rho_X/M_X$。因此，摩尔浓度 $c_X$ 在欧拉散度形式下也是严格守恒的。\n-   像 $Y_X$、$r$ 和 $x_X$ 这样的比率量不满足这种守恒形式。例如，展开 $Y_X$ 的平流项得到 $\\nabla \\cdot (Y_X \\vec{u}) = Y_X(\\nabla \\cdot \\vec{u}) + \\vec{u} \\cdot \\nabla Y_X$。连续性方程将是 $\\frac{\\partial Y_X}{\\partial t} + \\vec{u} \\cdot \\nabla Y_X + Y_X(\\nabla \\cdot \\vec{u}) = 0$。这不符合 $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (q \\vec{u}) = 0$ 的形式。\n\n**沿轨迹物质守恒**：\n如果一个变量 $q$ 的值在跟随一个流体微团时保持不变，则称其为物质守恒，这可以用物质导数表示为 $\\frac{Dq}{Dt} \\equiv \\frac{\\partial q}{\\partial t} + \\vec{u} \\cdot \\nabla q = 0$。\n\n混合物的总质量连续性方程为 $\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\vec{u}) = 0$，其中 $\\rho = \\rho_d + \\rho_X$。用物质导数表示，这变为 $\\frac{D\\rho}{Dt} = -\\rho (\\nabla \\cdot \\vec{u})$。\n同样，对于示踪剂，$\\frac{D\\rho_X}{Dt} = -\\rho_X (\\nabla \\cdot \\vec{u})$。对于可压缩流，通常 $\\nabla \\cdot \\vec{u} \\neq 0$，所以质量浓度 $\\rho_X$（以及类似的摩尔浓度 $c_X$）不是物质守恒的。其值因流体微团的体积变化（压缩或膨胀）而改变。\n\n现在我们分析比率量：\n-   **质量分数 ($Y_X = \\rho_X / \\rho$)**：\n    $$ \\frac{D Y_X}{Dt} = \\frac{D}{Dt}\\left(\\frac{\\rho_X}{\\rho}\\right) = \\frac{1}{\\rho}\\frac{D\\rho_X}{Dt} - \\frac{\\rho_X}{\\rho^2}\\frac{D\\rho}{Dt} = \\frac{1}{\\rho}(-\\rho_X \\nabla \\cdot \\vec{u}) - \\frac{\\rho_X}{\\rho^2}(-\\rho \\nabla \\cdot \\vec{u}) $$\n    $$ \\frac{D Y_X}{Dt} = -\\frac{\\rho_X}{\\rho}(\\nabla \\cdot \\vec{u}) + \\frac{\\rho_X}{\\rho}(\\nabla \\cdot \\vec{u}) = 0 $$\n    因此，质量分数 $Y_X$ 是物质守恒的。\n\n-   **质量混合比 ($r = \\rho_X / \\rho_d$)**：\n    分析与 $Y_X$ 的情况相同，因为干空气也是一个守恒物种，所以 $\\frac{D\\rho_d}{Dt} = -\\rho_d (\\nabla \\cdot \\vec{u})$。\n    $$ \\frac{Dr}{Dt} = \\frac{D}{Dt}\\left(\\frac{\\rho_X}{\\rho_d}\\right) = \\frac{1}{\\rho_d}\\frac{D\\rho_X}{Dt} - \\frac{\\rho_X}{\\rho_d^2}\\frac{D\\rho_d}{Dt} = \\frac{1}{\\rho_d}(-\\rho_X \\nabla \\cdot \\vec{u}) - \\frac{\\rho_X}{\\rho_d^2}(-\\rho_d \\nabla \\cdot \\vec{u}) = 0 $$\n    因此，质量混合比 $r$ 是物质守恒的。\n\n-   **摩尔分数 ($x_X = c_X / c_{total}$)**：\n    逻辑再次相同，但应用于摩尔浓度。我们有 $\\frac{Dc_X}{Dt} = -c_X(\\nabla \\cdot \\vec{u})$ 和 $\\frac{Dc_{total}}{Dt} = -c_{total}(\\nabla \\cdot \\vec{u})$。\n    $$ \\frac{Dx_X}{Dt} = \\frac{D}{Dt}\\left(\\frac{c_X}{c_{total}}\\right) = \\frac{1}{c_{total}}\\frac{Dc_X}{Dt} - \\frac{c_X}{c_{total}^2}\\frac{Dc_{total}}{Dt} = \\frac{1}{c_{total}}(-c_X \\nabla \\cdot \\vec{u}) - \\frac{c_X}{c_{total}^2}(-c_{total} \\nabla \\cdot \\vec{u}) = 0 $$\n    因此，摩尔分数 $x_X$ 是物质守恒的。\n\n**总结与对密度变化的依赖性**：\n-   在欧拉散度形式下严格守恒的变量是“单位体积”量：质量浓度 $\\rho_X$ 和摩尔浓度 $c_X$。\n-   物质守恒（沿轨迹恒定）的变量是比率量：质量分数 $Y_X$、质量混合比 $r$ 和摩尔分数 $x_X$。\n-   在可压缩流中，$\\rho_X$ 和 $c_X$ 的守恒性质与 $Y_X$、$r$ 和 $x_X$ 的守恒性质有根本不同。无论密度如何变化，比率量的物质守恒都成立，因为膨胀/压缩效应在比率中被抵消。这使得它们在模拟可压缩流体（如大气）中的示踪剂输运时特别有用。相比之下，“单位体积”量仅在流体不可压缩（$\\nabla \\cdot \\vec{u} = 0$）时才是物质守恒的，在这种情况下，密度沿轨迹是恒定的。\n\n### 第3部分：摩尔浓度的数值计算\n\n我们使用第1部分推导的公式来计算示踪剂摩尔浓度 $c_X$：\n$$c_X = \\left( \\frac{r M_d}{M_X + r M_d} \\right) \\frac{P}{RT}$$\n给定以下值：\n-   $r = 2.50 \\times 10^{-7}$\n-   $M_d = 28.97 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$\n-   $M_X = 48.00 \\times 10^{-3} \\,\\mathrm{kg\\, mol^{-1}}$\n-   $P = 85{,}000 \\,\\mathrm{Pa}$\n-   $T = 260 \\,\\mathrm{K}$\n-   $R = 8.314462618 \\,\\mathrm{J\\, mol^{-1}\\, K^{-1}}$\n\n首先，我们计算摩尔分数 $x_X$：\n$$x_X = \\frac{(2.50 \\times 10^{-7}) \\times (28.97 \\times 10^{-3})}{(48.00 \\times 10^{-3}) + (2.50 \\times 10^{-7}) \\times (28.97 \\times 10^{-3})}$$\n$$x_X = \\frac{7.2425 \\times 10^{-9}}{0.0480000072425} \\approx 1.508854 \\times 10^{-7}$$\n接下来，我们计算总摩尔浓度 $P/(RT)$：\n$$\\frac{P}{RT} = \\frac{85000 \\,\\mathrm{Pa}}{(8.314462618 \\,\\mathrm{J\\, mol^{-1}\\, K^{-1}}) \\times (260 \\,\\mathrm{K})} \\approx \\frac{85000}{2161.760} \\,\\mathrm{mol\\,m^{-3}} \\approx 39.3197 \\,\\mathrm{mol\\,m^{-3}}$$\n最后，我们计算 $c_X$：\n$$c_X = x_X \\frac{P}{RT} \\approx (1.508854 \\times 10^{-7}) \\times (39.3197 \\,\\mathrm{mol\\,m^{-3}}) \\approx 5.9326 \\times 10^{-6} \\,\\mathrm{mol\\,m^{-3}}$$\n按要求将结果四舍五入到四位有效数字：\n$$c_X \\approx 5.933 \\times 10^{-6} \\,\\mathrm{mol\\,m^{-3}}$$",
            "answer": "$$ \\boxed{5.933 \\times 10^{-6}} $$"
        },
        {
            "introduction": "将连续的守恒律转化为离散的数值格式是环境建模的核心步骤，但这一过程必须确保数值解的稳定性。本练习将通过分析一个经典的一维平流问题，向你介绍著名的Courant-Friedrichs-Lewy (CFL)条件。你将亲手计算Courant数，并从原理出发解释一个数值格式如何依赖此无量纲数来保证其解的稳定性和物理实在性。",
            "id": "3870915",
            "problem": "考虑在一个长度为 $L$ 的周期性通道中，以恒定正速度 $u$ 进行的一维被动示踪剂平流。示踪剂浓度 $q(x,t)$ 满足守恒律 $\\partial_{t} q + \\partial_{x}(u q) = 0$ 和周期性边界条件。在一个由 $N$ 个宽度为 $\\Delta x$ 的控制体（单元）组成的均匀网格上，采用通量形式的有限体积离散化方法，并使用大小为 $\\Delta t$ 的显式时间步进。对于 $u>0$，通过界面 $x_{i+1/2}$ 的数值通量取为上游值 $F_{i+1/2}^{n} = u\\,q_{i}^{n}$，其中 $q_{i}^{n}$ 表示在时间层 $t^{n}$ 时单元 $i$ 内的单元平均值。\n\n计算参数如下：\n- $L = 180\\,\\text{km}$,\n- $N = 512$,\n- $u = 0.71\\,\\text{m}\\,\\text{s}^{-1}$,\n- $\\Delta t = 300\\,\\text{s}$.\n\n任务：\n1. 计算无量纲的 Courant 数，其定义为一个时间步内流体质点平流传播的距离与网格间距之比。请将您的答案表示为一个纯数字（无单位），并四舍五入到四位有效数字。\n2. 从控制体上的局部守恒积分形式和给定的通量形式更新出发，从原理出发解释总示踪剂质量的精确全局守恒如何依赖于离散化及其通量。然后，使用基于相邻单元平均值的凸组合的单调性论证或傅里叶（von Neumann）放大因子分析，推导此迎风格式下时间步长关于 Courant 数的稳定性要求。最后，得出对于 $u>0$ 确保非负、无振荡演化的 $\\Delta t$ 相对于 $u$ 和 $\\Delta x$ 的界限。\n\n只有任务1中要求的 Courant 数会被进行数值评分；请确保您四舍五入到四位有效数字，并报告时不要带单位。所有其他推理必须从守恒和稳定性的第一性原理出发进行充分论证。",
            "solution": "该问题分为两个任务。第一个任务是 Courant 数的数值计算，第二个任务是给定数值格式的守恒性和稳定性的理论分析。\n\n任务1：计算 Courant 数\n\n问题给出了以下参数：\n-   通道长度，$L = 180\\,\\text{km} = 1.8 \\times 10^{5}\\,\\text{m}$。\n-   网格单元数，$N = 512$。\n-   恒定速度，$u = 0.71\\,\\text{m}\\,\\text{s}^{-1}$。\n-   时间步长，$\\Delta t = 300\\,\\text{s}$。\n\n网格是均匀的，因此每个控制体的宽度（网格间距）为 $\\Delta x$。\n$$ \\Delta x = \\frac{L}{N} = \\frac{1.8 \\times 10^{5}\\,\\text{m}}{512} = 351.5625\\,\\text{m} $$\nCourant 数，我们记为 $C$，定义为一个时间步内平流传播的距离 $u \\Delta t$ 与网格间距 $\\Delta x$ 之比。\n$$ C = \\frac{u \\Delta t}{\\Delta x} $$\n代入给定值：\n$$ C = \\frac{(0.71\\,\\text{m}\\,\\text{s}^{-1}) \\times (300\\,\\text{s})}{351.5625\\,\\text{m}} = \\frac{213}{351.5625} \\approx 0.605893706... $$\n将结果四舍五入到四位有效数字，我们得到：\n$$ C \\approx 0.6059 $$\n\n任务2：守恒性与稳定性分析\n\n首先，我们讨论示踪剂质量的全局守恒性。控制偏微分方程是一个守恒律，$\\partial_{t} q + \\partial_{x}(uq) = 0$。该定律在控制体 $V_i = [x_{i-1/2}, x_{i+1/2}]$ 上的积分形式为：\n$$ \\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,t) \\,dx + \\left[uq\\right]_{x=x_{i+1/2}} - \\left[uq\\right]_{x=x_{i-1/2}} = 0 $$\n令 $q_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,t) \\,dx$ 为单元 $i$ 中的单元平均浓度。积分形式变为：\n$$ \\Delta x \\frac{d q_i}{dt} + F(x_{i+1/2}, t) - F(x_{i-1/2}, t) = 0 $$\n其中 $F(x,t) = uq(x,t)$ 是连续通量。有限体积法通过用有限差分近似时间导数，并用数值通量 $F_{i\\pm1/2}^n$ 近似界面处的通量 $F(x_{i\\pm1/2}, t)$ 来对此进行离散化。使用显式前向欧拉时间步长，我们得到：\n$$ \\frac{q_i^{n+1} - q_i^n}{\\Delta t} \\Delta x + F_{i+1/2}^n - F_{i-1/2}^n = 0 $$\n整理后得到单元平均值的通量形式更新方程：\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) $$\n在时间层 $t^n$ 时，离散系统中的总示踪剂质量是每个单元中质量的总和，$M^n = \\sum_{i=1}^{N} q_i^n \\Delta x$。为了评估其守恒性，我们将更新方程对所有单元 $i = 1, \\dots, N$求和：\n$$ \\sum_{i=1}^{N} q_i^{n+1} = \\sum_{i=1}^{N} q_i^n - \\frac{\\Delta t}{\\Delta x} \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) $$\n乘以 $\\Delta x$ 得到总质量的更新：\n$$ M^{n+1} = M^n - \\Delta t \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) $$\n通量差值的和是一个伸缩级数：\n$$ \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) = (F_{3/2}^n - F_{1/2}^n) + (F_{5/2}^n - F_{3/2}^n) + \\dots + (F_{N+1/2}^n - F_{N-1/2}^n) = F_{N+1/2}^n - F_{1/2}^n $$\n通量形式守恒格式的关键在于，在 $x_{i+1/2}$ 处离开单元 $i$ 的通量（即 $-F_{i+1/2}^n$）与在同一界面处进入单元 $i+1$ 的通量（即 $+F_{i+1/2}^n$）完全相同。正是这种抵消导致了伸缩求和。对于周期性边界条件，单元 $N+1$ 与单元 $1$ 等同，因此界面 $x_{N+1/2}$ 与界面 $x_{1/2}$ 是同一个界面。这意味着通量必须相等：$F_{N+1/2}^n = F_{1/2}^n$。因此，所有通量差值的总和为零：\n$$ \\sum_{i=1}^{N} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) = 0 $$\n这导致 $M^{n+1} = M^n$。因此，总示踪剂质量在每个时间步都精确守恒，这是周期性域上通量形式离散化的直接结果。\n\n接下来，我们推导稳定性要求。问题指定了对于 $u>0$ 的迎风通量为 $F_{i+1/2}^n = u q_i^n$。单元 $i$ 左界面 $x_{i-1/2}$ 处的通量由单元 $i-1$ 的状态决定，所以 $F_{i-1/2}^n = u q_{i-1}^n$。将这些代入更新方程：\n$$ q_i^{n+1} = q_i^n - \\frac{\\Delta t}{\\Delta x} \\left( u q_i^n - u q_{i-1}^n \\right) $$\n引入无量纲 Courant 数 $C = \\frac{u \\Delta t}{\\Delta x}$，格式变为：\n$$ q_i^{n+1} = q_i^n - C (q_i^n - q_{i-1}^n) $$\n整理各项，我们可以将新值 $q_i^{n+1}$ 表示为单元 $i$ 及其上游邻居单元 $i-1$ 中旧值的线性组合：\n$$ q_i^{n+1} = (1 - C) q_i^n + C q_{i-1}^n $$\n为了使格式能保证非负演化（即，如果对所有 $j$ 都有 $q_j^n \\ge 0$，则 $q_i^{n+1} \\ge 0$）且无振荡（单调，意味着不产生新的局部极值），值 $q_i^{n+1}$ 必须是计算它所用的值（这里是 $q_i^n$ 和 $q_{i-1}^n$）的凸组合。凸组合要求系数为非负且总和为1。\n系数的总和是 $(1 - C) + C = 1$，这总是成立的。\n为了使系数非负，我们需要：\n1.  $C \\ge 0$\n2.  $1 - C \\ge 0$\n\n由于 $u>0$，$\\Delta t>0$ 和 $\\Delta x>0$，Courant 数 $C$ 总是非负的，所以第一个条件得到满足。第二个条件 $1 - C \\ge 0$ 意味着 $C \\le 1$。\n综合这些，非负、无振荡演化的条件是 $0 \\le C \\le 1$。这是一阶迎风格式的稳定性要求。\n将此要求表示为对时间步长 $\\Delta t$ 的限制：\n$$ \\frac{u \\Delta t}{\\Delta x} \\le 1 $$\n$$ \\Delta t \\le \\frac{\\Delta x}{u} $$\n这就是该格式的 Courant-Friedrichs-Lewy (CFL) 条件。它的物理解释是，在单个时间步内，信息（或示踪剂）传播的距离不能超过一个网格单元的宽度。满足此条件可确保数值解是稳定的，并保持诸如非负性等物理上有意义的属性。",
            "answer": "$$ \\boxed{0.6059} $$"
        },
        {
            "introduction": "一个数值模型的整体守恒性不仅取决于其内部计算格式，还严重依赖于边界通量的正确处理。本练习将带你进入一个更真实的二维交错网格环境，设计并实现守恒的边界通量计算方案。通过将你的正确实现与两种常见的、会导致质量“泄露”的错误方法进行对比，你将获得处理模型边界条件这一关键且易错环节的宝贵实践经验。",
            "id": "3870921",
            "problem": "您正在一个二维均匀交错网格（Arakawa C-网格）上模拟被动示踪剂的平流。示踪剂浓度定义在网格中心，$x$方向的速度分量定义在垂直面上，$y$方向的速度分量定义在水平面上。控制定律是积分形式的示踪剂守恒：对于任何固定的控制体，示踪剂含量的变化率等于穿过其边界的净向外平流通量的负值。您必须推导并实现整个计算域的净边界通量的守恒计算方法，并将其与两种常见的导致泄漏的非守恒边界实现进行对比。\n\n从有限体积守恒定律出发，对于面积为 $A$、边界 $\\partial \\Omega$ 上具有向外单位法向量 $\\boldsymbol{n}$ 的单个网格单元，其表达式为：$$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\int_{\\Omega} c \\, \\mathrm{d}A\\right) \\;=\\; - \\oint_{\\partial \\Omega} \\left( \\boldsymbol{u}\\, c\\right)\\cdot \\boldsymbol{n} \\, \\mathrm{d}s,$$ 其中 $c$ 是浓度，$\\boldsymbol{u}$ 是速度。请在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀网格上，将其解释为逐个网格面的离散通量之和，并需要考虑向外法向量的方向以及在网格面上对 $c$ 进行一致的迎风处理。请使用以下定义和约定：\n- 网格在 $x$ 方向有 $N_x$ 个单元，在 $y$ 方向有 $N_y$ 个单元。\n- 示踪剂值 $c_{i,j}$位于网格中心，其索引为 $i \\in \\{0,\\dots,N_x-1\\}$ 和 $j \\in \\{0,\\dots,N_y-1\\}$。\n- $x$方向速度 $u_{i,j}$ 定义在垂直面上，其索引为 $i \\in \\{0,\\dots,N_x\\}$ 和 $j \\in \\{0,\\dots,N_y-1\\}$，位于分隔网格单元 $i-1$ 和 $i$ 的 $x$方向面上。左边界（$i=0$）的向外法向量为 $-\\hat{\\boldsymbol{x}}$，右边界（$i=N_x$）的向外法向量为 $+\\hat{\\boldsymbol{x}}$。\n- $y$方向速度 $v_{i,j}$ 定义在水平面上，其索引为 $i \\in \\{0,\\dots,N_x-1\\}$ 和 $j \\in \\{0,\\dots,N_y\\}$，位于分隔网格单元 $j-1$ 和 $j$ 的 $y$方向面上。下边界（$j=0$）的向外法向量为 $-\\hat{\\boldsymbol{y}}$，上边界（$j=N_y$）的向外法向量为 $+\\hat{\\boldsymbol{y}}$。\n- 对于面上平流通量的迎风格式，如果流出计算域，则使用上游一侧的相邻内部网格单元的值；如果从计算域外部流入，则使用入流边界浓度。\n- 每个垂直面贡献的通量与其线段长度 $\\Delta y$ 成正比，每个水平面贡献的通量与其线段长度 $\\Delta x$ 成正比。\n\n您的程序必须为每个测试案例计算三个量：\n- 正确的守恒净向外边界通量 $F_{\\text{corr}}$，通过将具有一致迎风示踪剂、正确面长度和向外法向符号的面通量相加计算得出。\n- 一个非守恒的净向外边界通量 $F_{\\text{ghost}}$，它对入流边界使用错误的“虚拟网格”处理方法：当边界上存在入流（速度指向内部）时，不使用指定的入流浓度，而是使用相邻内部网格单元值的一半（$\\tfrac{1}{2} c_{\\text{adj}}$）；对于出流，则不加改变地使用内部值；使用正确的面长度和向外法向符号。\n- 一个非守恒的净向外边界通量 $F_{\\text{area}}$，它使用正确的迎风格式但分配了错误的面长度：所有垂直面使用 $\\Delta x$，所有水平面使用 $\\Delta y$，而不是正确的垂直面使用 $\\Delta y$、水平面使用 $\\Delta x$；使用正确的向外法向符号。\n\n本问题中的所有变量都是无量纲的；所有输出均以十进制数表示。\n\n请为以下测试套件实现上述计算。对于每个案例，请严格按照规定构造数组：\n\n- 案例1（理想情况，边界通量为零）：\n  - $N_x = 4$, $N_y = 3$, $\\Delta x = 1$, $\\Delta y = 1$。\n  - 对所有 $i,j$，$c_{i,j} = 1$。\n  - 对所有 $i \\in \\{0,\\dots,4\\}$，$j \\in \\{0,\\dots,2\\}$，$u_{i,j} = 0$。\n  - 对所有 $i \\in \\{0,\\dots,3\\}$，$j \\in \\{0,\\dots,3\\}$，$v_{i,j} = 0$。\n  - 定义了入流边界浓度但未使用：将左、右、下、上边界设置为标量值1。\n\n- 案例2（$x$方向均匀流动，左侧为高浓度入流）：\n  - $N_x = 5$, $N_y = 4$, $\\Delta x = 1$, $\\Delta y = 1$。\n  - 对所有 $i,j$，$c_{i,j} = 1$。\n  - 对所有 $i \\in \\{0,\\dots,5\\}$，$j \\in \\{0,\\dots,3\\}$，$u_{i,j} = 1$。\n  - 对所有 $i \\in \\{0,\\dots,4\\}$，$j \\in \\{0,\\dots,4\\}$，$v_{i,j} = 0$。\n  - 左侧的入流边界浓度为标量2；其他入流边界浓度未使用。\n\n- 案例3（$y$方向示踪剂不均匀，顶部和底部为垂直出流）：\n  - $N_x = 3$, $N_y = 3$, $\\Delta x = 1$, $\\Delta y = 2$。\n  - 对所有 $i \\in \\{0,\\dots,2\\}$ 和 $j \\in \\{0,\\dots,2\\}$，$c_{i,j} = 1 + 0.5\\, j$。\n  - 对所有 $i \\in \\{0,\\dots,3\\}$，$j \\in \\{0,\\dots,2\\}$，$u_{i,j} = 0$。\n  - 对所有 $i \\in \\{0,\\dots,2\\}$，$v_{i,0} = -2$（下边界），对所有 $i \\in \\{0,\\dots,2\\}$，$v_{i,3} = 1$（上边界），其他情况下 $v_{i,j} = 0$。\n  - 未使用入流边界浓度。\n\n- 案例4（单网格单元，混合入流和出流）：\n  - $N_x = 1$, $N_y = 1$, $\\Delta x = 3$, $\\Delta y = 2$。\n  - $c_{0,0} = 1.5$。\n  - 左边界 $u_{0,0} = 0$，右边界 $u_{1,0} = 0.7$。\n  - 下边界 $v_{0,0} = 0.1$，上边界 $v_{0,1} = -0.2$。\n  - 下边界的入流浓度为标量1，上边界为标量3。\n\n您的程序必须：\n- 为每个案例构造上述数组。\n- 为每个案例计算 $F_{\\text{corr}}$、$F_{\\text{ghost}}$ 和 $F_{\\text{area}}$。\n- 生成单行输出，其中包含按顺序排列的12个结果，形式为方括号括起来的逗号分隔列表：$[F_{\\text{corr},1},F_{\\text{ghost},1},F_{\\text{area},1},F_{\\text{corr},2},F_{\\text{ghost},2},F_{\\text{area},2},F_{\\text{corr},3},F_{\\text{ghost},3},F_{\\text{area},3},F_{\\text{corr},4},F_{\\text{ghost},4},F_{\\text{area},4}]$。\n\n设计您的解决方案，使其能够通过给定的测试套件进行验证。重点在于正确应用向外法向符号，在入流和出流面上选择合适的迎风示踪剂值，并乘以正确的面长度。同时，实现上述两种特定的非守恒变体。最终输出为无量纲十进制数。",
            "solution": "该问题要求计算被动示踪剂穿过二维计算域边界的净向外平流通量。计算将在一个均匀、交错的 Arakawa C-网格上进行。我们必须首先推导正确的守恒通量 $F_{\\text{corr}}$，然后推导两种非守恒变体 $F_{\\text{ghost}}$ 和 $F_{\\text{area}}$。\n\n控制原理是浓度为 $c$ 的示踪剂被速度场 $\\boldsymbol{u}$ 平流输运的积分守恒定律：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\int_{\\Omega} c \\, \\mathrm{d}A\\right) = - \\oint_{\\partial \\Omega} (\\boldsymbol{u} c) \\cdot \\boldsymbol{n} \\, \\mathrm{d}s $$\n右侧项是净向外通量的负值。我们被要求计算整个计算域的净向外通量 $F_{\\text{net}} = \\oint_{\\partial \\Omega} (\\boldsymbol{u} c) \\cdot \\boldsymbol{n} \\, \\mathrm{d}s$。计算域边界由四个部分组成：左、右、下和上。总通量是通过这四个部分的通量之和：$F_{\\text{net}} = F_{\\text{left}} + F_{\\text{right}} + F_{\\text{bottom}} + F_{\\text{top}}$。\n\n我们将对每个边界段的通量积分进行离散化。网格尺寸为 $N_x \\times N_y$，网格间距为 $\\Delta x$ 和 $\\Delta y$。\n-   示踪剂浓度 $c_{i,j}$ 位于网格中心，索引为 $i \\in \\{0, \\dots, N_x-1\\}$ 和 $j \\in \\{0, \\dots, N_y-1\\}$。\n-   $x$方向速度 $u_{i,j}$ 位于垂直面上，索引为 $i \\in \\{0, \\dots, N_x\\}$ 和 $j \\in \\{0, \\dots, N_y-1\\}$。\n-   $y$方向速度 $v_{i,j}$ 位于水平面上，索引为 $i \\in \\{0, \\dots, N_x-1\\}$ 和 $j \\in \\{0, \\dots, N_y\\}$。\n\n迎风原理用于确定每个面上的示踪剂浓度 $c$。对于一个法向量为 $\\boldsymbol{n}$ 的面，流速为 $\\boldsymbol{u}$，如果流动方向是向外流出计算域（$\\boldsymbol{u} \\cdot \\boldsymbol{n} > 0$），则 $c$ 取自相邻的内部网格单元。如果流动方向是向内流入（$\\boldsymbol{u} \\cdot \\boldsymbol{n} < 0$），则 $c$ 取自指定的入流边界条件。\n\n**1. 正确守恒通量 $F_{\\text{corr}}$ 的推导**\n\n通量是在所有边界上求和。\n\n**左边界（$i=0$处）：**\n边界由 $N_y$ 个垂直面组成，索引为 $j \\in \\{0, \\dots, N_y-1\\}$。向外法向量为 $\\boldsymbol{n} = -\\hat{\\boldsymbol{x}}$。面长度为 $\\Delta y$。速度为 $u_{0,j}$。\n穿过面 $j$ 的向外通量为 $((\\boldsymbol{u}c) \\cdot \\boldsymbol{n})_j \\Delta y = -u_{0,j} c_{\\text{face}} \\Delta y$。\n-   如果 $u_{0,j} > 0$：入流。$c_{\\text{face}} = c_{\\text{left},j}$（指定的入流浓度）。通量为 $-u_{0,j} c_{\\text{left},j} \\Delta y$。\n-   如果 $u_{0,j} \\le 0$：出流。$c_{\\text{face}} = c_{0,j}$（相邻内部网格单元）。通量为 $-u_{0,j} c_{0,j} \\Delta y$。\n总通量为：\n$$ F_{\\text{left}} = - \\Delta y \\sum_{j=0}^{N_y-1} \\left[ (u_{0,j})^+ c_{\\text{left},j} + (u_{0,j})^- c_{0,j} \\right] $$\n其中 $(x)^+ = \\max(x,0)$ 且 $(x)^- = \\min(x,0)$。\n\n**右边界（$i=N_x$处）：**\n边界由 $N_y$ 个垂直面组成，索引为 $j \\in \\{0, \\dots, N_y-1\\}$。向外法向量为 $\\boldsymbol{n} = +\\hat{\\boldsymbol{x}}$。面长度为 $\\Delta y$。速度为 $u_{N_x,j}$。\n穿过面 $j$ 的向外通量为 $u_{N_x,j} c_{\\text{face}} \\Delta y$。\n-   如果 $u_{N_x,j} > 0$：出流。$c_{\\text{face}} = c_{N_x-1,j}$。通量为 $u_{N_x,j} c_{N_x-1,j} \\Delta y$。\n-   如果 $u_{N_x,j} \\le 0$：入流。$c_{\\text{face}} = c_{\\text{right},j}$。通量为 $u_{N_x,j} c_{\\text{right},j} \\Delta y$。\n总通量为：\n$$ F_{\\text{right}} = \\Delta y \\sum_{j=0}^{N_y-1} \\left[ (u_{N_x,j})^+ c_{N_x-1,j} + (u_{N_x,j})^- c_{\\text{right},j} \\right] $$\n\n**下边界（$j=0$处）：**\n边界由 $N_x$ 个水平面组成，索引为 $i \\in \\{0, \\dots, N_x-1\\}$。向外法向量为 $\\boldsymbol{n} = -\\hat{\\boldsymbol{y}}$。面长度为 $\\Delta x$。速度为 $v_{i,0}$。\n穿过面 $i$ 的向外通量为 $-v_{i,0} c_{\\text{face}} \\Delta x$。\n-   如果 $v_{i,0} > 0$：入流。$c_{\\text{face}} = c_{\\text{bottom},i}$。通量为 $-v_{i,0} c_{\\text{bottom},i} \\Delta x$。\n-   如果 $v_{i,0} \\le 0$：出流。$c_{\\text{face}} = c_{i,0}$。通量为 $-v_{i,0} c_{i,0} \\Delta x$。\n总通量为：\n$$ F_{\\text{bottom}} = - \\Delta x \\sum_{i=0}^{N_x-1} \\left[ (v_{i,0})^+ c_{\\text{bottom},i} + (v_{i,0})^- c_{i,0} \\right] $$\n\n**上边界（$j=N_y$处）：**\n边界由 $N_x$ 个水平面组成，索引为 $i \\in \\{0, \\dots, N_x-1\\}$。向外法向量为 $\\boldsymbol{n} = +\\hat{\\boldsymbol{y}}$。面长度为 $\\Delta x$。速度为 $v_{i,N_y}$。\n穿过面 $i$ 的向外通量为 $v_{i,N_y} c_{\\text{face}} \\Delta x$。\n-   如果 $v_{i,N_y} > 0$：出流。$c_{\\text{face}} = c_{i,N_y-1}$。通量为 $v_{i,N_y} c_{i,N_y-1} \\Delta x$。\n-   如果 $v_{i,N_y} \\le 0$：入流。$c_{\\text{face}} = c_{\\text{top},i}$。通量为 $v_{i,N_y} c_{\\text{top},i} \\Delta x$。\n总通量为：\n$$ F_{\\text{top}} = \\Delta x \\sum_{i=0}^{N_x-1} \\left[ (v_{i,N_y})^+ c_{i,N_y-1} + (v_{i,N_y})^- c_{\\text{top},i} \\right] $$\n\n正确的总守恒通量为 $F_{\\text{corr}} = F_{\\text{left}} + F_{\\text{right}} + F_{\\text{bottom}} + F_{\\text{top}}$。\n\n**2. 非守恒通量 $F_{\\text{ghost}}$ 的推导**\n\n此变体修改了入流边界条件。在入流情况下，浓度取为相邻内部网格单元值的一半，即 $c_{\\text{inflow}} = \\frac{1}{2} c_{\\text{adj}}$。出流逻辑和面长度保持正确。\n-   左侧入流（$u_{0,j} > 0$）：使用 $c = \\frac{1}{2} c_{0,j}$。\n-   右侧入流（$u_{N_x,j} \\le 0$）：使用 $c = \\frac{1}{2} c_{N_x-1,j}$。\n-   下侧入流（$v_{i,0} > 0$）：使用 $c = \\frac{1}{2} c_{i,0}$。\n-   上侧入流（$v_{i,N_y} \\le 0$）：使用 $c = \\frac{1}{2} c_{i,N_y-1}$。\n通量公式也相应调整。例如，对于左边界，通量变为：\n$$ F_{\\text{left,ghost}} = - \\Delta y \\sum_{j=0}^{N_y-1} \\left[ (u_{0,j})^+ \\left(\\frac{1}{2} c_{0,j}\\right) + (u_{0,j})^- c_{0,j} \\right] $$\n其他边界也进行类似的替换。\n\n**3. 非守恒通量 $F_{\\text{area}}$ 的推导**\n\n此变体使用正确的迎风逻辑，但采用了不正确的面长度。垂直面（左/右）的长度被指定为 $\\Delta x$ 而不是 $\\Delta y$，水平面（下/上）的长度被指定为 $\\Delta y$ 而不是 $\\Delta x$。\n四个边界通量的表达式与 $F_{\\text{corr}}$ 的表达式相同，但 $\\Delta x$ 和 $\\Delta y$ 互换。例如，对于左边界：\n$$ F_{\\text{left,area}} = - \\Delta x \\sum_{j=0}^{N_y-1} \\left[ (u_{0,j})^+ c_{\\text{left},j} + (u_{0,j})^- c_{0,j} \\right] $$\n对于下边界：\n$$ F_{\\text{bottom,area}} = - \\Delta y \\sum_{i=0}^{N_x-1} \\left[ (v_{i,0})^+ c_{\\text{bottom},i} + (v_{i,0})^- c_{i,0} \\right] $$\n\n该实现将为每个测试案例构建指定的场，并应用这三套公式来计算 $F_{\\text{corr}}$、$F_{\\text{ghost}}$ 和 $F_{\\text{area}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_fluxes(case_data):\n    \"\"\"\n    Computes the net outward boundary flux for a given case.\n    The function calculates three versions of the flux:\n    1. F_corr: Correct conservative flux.\n    2. F_ghost: Non-conservative flux with erroneous ghost-cell inflow.\n    3. F_area: Non-conservative flux with erroneous face area assignments.\n    \"\"\"\n    Nx = case_data['Nx']\n    Ny = case_data['Ny']\n    dx = case_data['dx']\n    dy = case_data['dy']\n    c_field = case_data['c']\n    u_field = case_data['u']\n    v_field = case_data['v']\n    c_inflow = case_data['c_inflow']\n    \n    F_corr = 0.0\n    F_ghost = 0.0\n    F_area = 0.0\n\n    # Left boundary (i=0)\n    for j in range(Ny):\n        u = u_field[0, j]\n        if u > 0:  # Inflow\n            # Correct\n            c_up_corr = c_inflow['left']\n            F_corr += -u * c_up_corr * dy\n            # Ghost\n            c_up_ghost = 0.5 * c_field[0, j]\n            F_ghost += -u * c_up_ghost * dy\n            # Area\n            F_area += -u * c_up_corr * dx\n        else:  # Outflow (u = 0)\n            c_up = c_field[0, j]\n            # Correct\n            F_corr += -u * c_up * dy\n            # Ghost (same as correct for outflow)\n            F_ghost += -u * c_up * dy\n            # Area\n            F_area += -u * c_up * dx\n\n    # Right boundary (i=Nx)\n    for j in range(Ny):\n        u = u_field[Nx, j]\n        if u > 0:  # Outflow\n            c_up = c_field[Nx - 1, j]\n            # Correct\n            F_corr += u * c_up * dy\n            # Ghost (same as correct for outflow)\n            F_ghost += u * c_up * dy\n            # Area\n            F_area += u * c_up * dx\n        else:  # Inflow (u = 0)\n            c_up_corr = c_inflow['right']\n            # Correct\n            F_corr += u * c_up_corr * dy\n            # Ghost\n            c_up_ghost = 0.5 * c_field[Nx-1, j]\n            F_ghost += u * c_up_ghost * dy\n            # Area\n            F_area += u * c_up_corr * dx\n\n    # Bottom boundary (j=0)\n    for i in range(Nx):\n        v = v_field[i, 0]\n        if v > 0:  # Inflow\n            c_up_corr = c_inflow['bottom']\n            # Correct\n            F_corr += -v * c_up_corr * dx\n            # Ghost\n            c_up_ghost = 0.5 * c_field[i, 0]\n            F_ghost += -v * c_up_ghost * dx\n            # Area\n            F_area += -v * c_up_corr * dy\n        else:  # Outflow (v = 0)\n            c_up = c_field[i, 0]\n            # Correct\n            F_corr += -v * c_up * dx\n            # Ghost (same as correct for outflow)\n            F_ghost += -v * c_up * dx\n            # Area\n            F_area += -v * c_up * dy\n\n    # Top boundary (j=Ny)\n    for i in range(Nx):\n        v = v_field[i, Ny]\n        if v > 0:  # Outflow\n            c_up = c_field[i, Ny-1]\n            # Correct\n            F_corr += v * c_up * dx\n            # Ghost (same as correct for outflow)\n            F_ghost += v * c_up * dx\n            # Area\n            F_area += v * c_up * dy\n        else:  # Inflow (v = 0)\n            c_up_corr = c_inflow['top']\n            # Correct\n            F_corr += v * c_up_corr * dx\n            # Ghost\n            c_up_ghost = 0.5 * c_field[i, Ny-1]\n            F_ghost += v * c_up_ghost * dx\n            # Area\n            F_area += v * c_up_corr * dy\n            \n    return F_corr, F_ghost, F_area\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = []\n\n    # Case 1\n    Nx1, Ny1 = 4, 3\n    c1 = np.ones((Nx1, Ny1))\n    u1 = np.zeros((Nx1 + 1, Ny1))\n    v1 = np.zeros((Nx1, Ny1 + 1))\n    c_in1 = {'left': 1.0, 'right': 1.0, 'bottom': 1.0, 'top': 1.0}\n    test_cases.append({'Nx': Nx1, 'Ny': Ny1, 'dx': 1.0, 'dy': 1.0, 'c': c1, 'u': u1, 'v': v1, 'c_inflow': c_in1})\n\n    # Case 2\n    Nx2, Ny2 = 5, 4\n    c2 = np.ones((Nx2, Ny2))\n    u2 = np.ones((Nx2 + 1, Ny2))\n    v2 = np.zeros((Nx2, Ny2 + 1))\n    c_in2 = {'left': 2.0, 'right': 1.0, 'bottom': 1.0, 'top': 1.0}\n    test_cases.append({'Nx': Nx2, 'Ny': Ny2, 'dx': 1.0, 'dy': 1.0, 'c': c2, 'u': u2, 'v': v2, 'c_inflow': c_in2})\n\n    # Case 3\n    Nx3, Ny3 = 3, 3\n    c3 = np.zeros((Nx3, Ny3))\n    j_indices = np.arange(Ny3)\n    c3[:, :] = 1.0 + 0.5 * j_indices\n    u3 = np.zeros((Nx3 + 1, Ny3))\n    v3 = np.zeros((Nx3, Ny3 + 1))\n    v3[:, 0] = -2.0\n    v3[:, 3] = 1.0\n    c_in3 = {'left': 0.0, 'right': 0.0, 'bottom': 0.0, 'top': 0.0} # Not used\n    test_cases.append({'Nx': Nx3, 'Ny': Ny3, 'dx': 1.0, 'dy': 2.0, 'c': c3, 'u': u3, 'v': v3, 'c_inflow': c_in3})\n\n    # Case 4\n    Nx4, Ny4 = 1, 1\n    c4 = np.full((Nx4, Ny4), 1.5)\n    u4 = np.zeros((Nx4 + 1, Ny4))\n    u4[1, 0] = 0.7\n    v4 = np.zeros((Nx4, Ny4 + 1))\n    v4[0, 0] = 0.1\n    v4[0, 1] = -0.2\n    c_in4 = {'left': 0.0, 'right': 0.0, 'bottom': 1.0, 'top': 3.0}\n    test_cases.append({'Nx': Nx4, 'Ny': Ny4, 'dx': 3.0, 'dy': 2.0, 'c': c4, 'u': u4, 'v': v4, 'c_inflow': c_in4})\n\n    results = []\n    for case in test_cases:\n        F_corr, F_ghost, F_area = calculate_fluxes(case)\n        results.extend([F_corr, F_ghost, F_area])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}'.rstrip('0').rstrip('.') if '.' in f'{r:.10f}' else f'{r:.1f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}