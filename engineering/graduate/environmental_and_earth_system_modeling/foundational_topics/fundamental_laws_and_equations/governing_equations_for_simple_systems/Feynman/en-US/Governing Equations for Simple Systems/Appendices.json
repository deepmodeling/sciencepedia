{
    "hands_on_practices": [
        {
            "introduction": "Modeling environmental systems often begins with translating fundamental physical laws into mathematical equations. This first practice provides a classic example from hydrogeology, where you will derive the governing equation for the water table in an unconfined aquifer. By combining the principle of mass conservation with Darcy's law for flow through porous media, you will construct and solve a model that describes how recharge and boundary conditions shape the groundwater profile, a core skill for any environmental modeler .",
            "id": "3883626",
            "problem": "Consider an unconfined aquifer extending along a horizontal coordinate $x$ on the interval $[0,L]$ under steady flow. The system is one-dimensional ($1$D) and receives uniform areal recharge (accumulation) at a constant rate $R0$. Assume the Dupuit–Forchheimer (DF) approximation (vertical hydraulic gradients are negligible and flow is predominantly horizontal) and Darcy’s law. Let $H(x)$ denote the saturated thickness of the aquifer measured from an impermeable base, and let $q(x)$ denote the specific discharge (volume flux per unit width) in the $+x$ direction. The hydraulic conductivity $K$ is constant. Two rivers fix the water table at the boundaries, imposing the Dirichlet conditions $H(0)=H_{0}0$ and $H(L)=H_{L}0$.\n\nStarting from the local mass balance in steady state and Darcy’s law under the DF approximation only, derive the governing equation and solve for the water table profile $H(x)$ that is consistent with these boundary conditions. Express your final answer as a single closed-form analytic expression for $H(x)$ in terms of $x$, $L$, $K$, $R$, $H_{0}$, and $H_{L}$. No numerical evaluation is required.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of hydrogeology, mathematically well-posed, and an objective statement of a standard boundary value problem. We can proceed with the derivation of the solution.\n\nThe derivation begins with the principle of mass conservation in a steady state. Consider a one-dimensional control volume of the aquifer of infinitesimal length $dx$ along the $x$-axis and of unit width. The flow is governed by the specific discharge per unit width, $q(x)$, which represents the volume of water flowing through the cross-section at $x$ per unit time. The aquifer receives a uniform areal recharge at a rate $R$, which has units of volume per unit area per unit time. For our one-dimensional system of unit width, this recharge contributes a source term of $R \\cdot dx$ to the control volume.\n\nThe steady-state mass balance equation for the control volume is:\n$$ \\text{Flow in} + \\text{Source} = \\text{Flow out} $$\n$$ q(x) + R \\, dx = q(x+dx) $$\nRearranging the terms, we get:\n$$ q(x+dx) - q(x) = R \\, dx $$\nDividing by $dx$ and taking the limit as $dx \\to 0$ yields the differential form of the mass conservation equation:\n$$ \\frac{dq}{dx} = R $$\nThis equation states that the rate of change of specific discharge along the flow path is equal to the recharge rate.\n\nNext, we apply Darcy's law as adapted by the Dupuit-Forchheimer (DF) approximation. The DF approximation assumes that the flow is essentially horizontal, so the hydraulic head, $h$, at any point $x$ can be taken as equal to the saturated thickness of the aquifer, $H(x)$. Thus, $h(x) = H(x)$.\n\nAccording to Darcy's law, the specific discharge (flux per unit area of aquifer), let's call it $q'$, is given by:\n$$ q'(x) = -K \\frac{dh}{dx} = -K \\frac{dH}{dx} $$\nwhere $K$ is the constant hydraulic conductivity. The quantity $q(x)$ in the problem statement is the specific discharge per unit width, which is the Darcy flux $q'(x)$ integrated over the saturated thickness $H(x)$:\n$$ q(x) = q'(x) \\cdot H(x) = \\left(-K \\frac{dH}{dx}\\right) H(x) = -K H(x) \\frac{dH}{dx} $$\nThis expression can be written more conveniently using the chain rule identity $\\frac{d}{dx}(H^2) = 2H \\frac{dH}{dx}$:\n$$ q(x) = -\\frac{K}{2} \\frac{d}{dx}\\left(H(x)^2\\right) $$\n\nNow, we substitute this expression for $q(x)$ into the mass conservation equation $\\frac{dq}{dx} = R$:\n$$ \\frac{d}{dx} \\left(-\\frac{K}{2} \\frac{d}{dx}\\left(H(x)^2\\right)\\right) = R $$\nSince $K$ is a constant, we can move it outside the derivative:\n$$ -\\frac{K}{2} \\frac{d^2}{dx^2}\\left(H(x)^2\\right) = R $$\nThis is the governing second-order ordinary differential equation for $H(x)^2$. Let us define a new variable $Y(x) = H(x)^2$. The equation becomes:\n$$ \\frac{d^2Y}{dx^2} = -\\frac{2R}{K} $$\nThis is a simple linear ODE which can be solved by direct integration. Integrating once with respect to $x$ gives:\n$$ \\frac{dY}{dx} = -\\frac{2R}{K}x + C_1 $$\nwhere $C_1$ is a constant of integration. Integrating a second time gives the general solution for $Y(x)$:\n$$ Y(x) = -\\frac{R}{K}x^2 + C_1 x + C_2 $$\nwhere $C_2$ is the second constant of integration. Substituting back $Y(x) = H(x)^2$:\n$$ H(x)^2 = -\\frac{R}{K}x^2 + C_1 x + C_2 $$\n\nThe constants $C_1$ and $C_2$ are determined by applying the given Dirichlet boundary conditions: $H(0) = H_0$ and $H(L) = H_L$. In terms of $Y(x)$, these are $Y(0) = H_0^2$ and $Y(L) = H_L^2$.\n\nApplying the first boundary condition at $x=0$:\n$$ Y(0) = H_0^2 = -\\frac{R}{K}(0)^2 + C_1(0) + C_2 $$\nThis immediately yields $C_2 = H_0^2$. The solution now takes the form:\n$$ H(x)^2 = -\\frac{R}{K}x^2 + C_1 x + H_0^2 $$\n\nApplying the second boundary condition at $x=L$:\n$$ Y(L) = H_L^2 = -\\frac{R}{K}L^2 + C_1 L + H_0^2 $$\nWe solve this equation for $C_1$:\n$$ C_1 L = H_L^2 - H_0^2 + \\frac{R}{K}L^2 $$\n$$ C_1 = \\frac{H_L^2 - H_0^2}{L} + \\frac{RL}{K} $$\n\nFinally, we substitute the expressions for $C_1$ and $C_2$ back into the general solution for $H(x)^2$:\n$$ H(x)^2 = -\\frac{R}{K}x^2 + \\left(\\frac{H_L^2 - H_0^2}{L} + \\frac{RL}{K}\\right)x + H_0^2 $$\nTo obtain a more organized expression, we can group the terms:\n$$ H(x)^2 = H_0^2 + \\frac{H_L^2 - H_0^2}{L}x + \\frac{RL}{K}x - \\frac{R}{K}x^2 $$\n$$ H(x)^2 = H_0^2 + \\left(\\frac{H_L^2 - H_0^2}{L}\\right)x + \\frac{R}{K}(Lx - x^2) $$\nSince $H(x)$ represents a physical saturated thickness, it must be non-negative. We therefore take the positive square root to obtain the final expression for the water table profile:\n$$ H(x) = \\sqrt{H_0^2 + \\frac{H_L^2 - H_0^2}{L}x + \\frac{R}{K}(Lx - x^2)} $$\nThis solution describes a parabolic water table profile superimposed on a linear profile that would exist in the absence of recharge ($R=0$).",
            "answer": "$$ \\boxed{\\sqrt{H_0^2 + \\frac{H_L^2 - H_0^2}{L}x + \\frac{R}{K}(Lx - x^2)}} $$"
        },
        {
            "introduction": "Once a governing equation is established, a modeler must define its domain and how it interacts with the outside world through boundary conditions. This conceptual exercise focuses on the ubiquitous advection-diffusion equation and the crucial task of specifying physically and mathematically sound conditions for an open-flow system . Your reasoning will appeal to the fundamental nature of transport processes, exploring how information propagates through the system and how to avoid introducing artificial reflections or constraints at the model's edge.",
            "id": "3883683",
            "problem": "Consider a conservative tracer concentration $C(x,t)$ in a straight channel reach $x \\in [0,L]$ transporting a passive pollutant with constant mean velocity $U0$ and constant molecular diffusivity $\\kappa0$. The domain $[0,L]$ represents a finite portion of a much longer river, with inflow at $x=0$ from an upstream reservoir and outflow at $x=L$ into a large receiving water body. Let $S(x,t)$ denote a volumetric source term per unit length within the reach. Starting from the principle of mass conservation and physically defined flux laws, derive the appropriate governing equation and determine which pair of boundary conditions at $x=0$ and $x=L$ is physically and mathematically appropriate for modeling an open inflow/outflow system with $U0$, where the upstream reservoir imposes an inflow concentration $C_{\\text{in}}(t)$ and the downstream receiving water is sufficiently large that tracer gradients become negligible far beyond $x=L$. Justify the selection by appealing to the hyperbolic limit (advection-dominated) and to energy or flux balance arguments for the full advection–diffusion case. Assume the initial condition $C(x,0)$ is given and sufficiently smooth.\n\nChoose the correct pair of boundary conditions from the options below. In each option, $C_{\\text{in}}(t)$ and $C_{\\text{out}}(t)$ are prescribed functions, and $\\partial_x$ denotes $\\partial/\\partial x$. Dirichlet boundary conditions fix the value of $C$, while Neumann boundary conditions fix $\\partial_x C$.\n\nA. $C(0,t)=C_{\\text{in}}(t)$ and $\\partial_x C(L,t)=0$.\n\nB. $\\partial_x C(0,t)=0$ and $C(L,t)=C_{\\text{out}}(t)$.\n\nC. $C(0,t)=C_{\\text{in}}(t)$ and $C(L,t)=C_{\\text{out}}(t)$.\n\nD. $\\partial_x C(0,t)=0$ and $\\partial_x C(L,t)=0$.\n\nExplain which choice is most consistent with the physics of an upstream inflow and a downstream open boundary and with well-posedness in the advection-dominated limit as $\\kappa \\to 0^+$. Provide a principled derivation and justification from conservation and flux arguments, without appealing to ad hoc numerical heuristics. For clarity, define One-Dimensional (1D) and Partial Differential Equation (PDE) upon their first use in your reasoning, and ensure your derivation uses only fundamental conservation laws and standard, well-tested constitutive relations for fluxes.",
            "solution": "The appropriate starting point is the local conservation of mass for a conservative tracer in One-Dimensional (1D) flow, which, in integral form for any subinterval $[a,b] \\subset [0,L]$, reads\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_a^b C(x,t)\\,\\mathrm{d}x \\;=\\; J(a,t) - J(b,t) \\;+\\; \\int_a^b S(x,t)\\,\\mathrm{d}x,\n$$\nwhere $J(x,t)$ is the total longitudinal flux of tracer. The constitutive decomposition of $J$ into advective and diffusive components is the standard, well-tested relation\n$$\nJ(x,t) \\;=\\; U\\,C(x,t) \\;-\\; \\kappa\\,\\partial_x C(x,t),\n$$\nwith $U0$ denoting the mean downstream velocity and $\\kappa0$ the molecular diffusivity. Applying the fundamental theorem of calculus to the flux difference, the integral statement implies the Partial Differential Equation (PDE)\n$$\n\\partial_t C(x,t) \\;+\\; \\partial_x\\big(U\\,C(x,t) \\;-\\; \\kappa\\,\\partial_x C(x,t)\\big) \\;=\\; S(x,t),\n\\quad x\\in(0,L),\\; t0,\n$$\nor equivalently,\n$$\n\\partial_t C(x,t) \\;+\\; U\\,\\partial_x C(x,t) \\;=\\; \\kappa\\,\\partial_{xx} C(x,t) \\;+\\; S(x,t).\n$$\n\nTo choose boundary conditions, we analyze two complementary limits and principles:\n\n1. Hyperbolic (advection-dominated) limit $\\kappa \\to 0^+$: In this limit, the PDE reduces to the first-order transport equation\n$$\n\\partial_t C(x,t) \\;+\\; U\\,\\partial_x C(x,t) \\;=\\; S(x,t),\n$$\nwhose characteristics satisfy $\\mathrm{d}x/\\mathrm{d}t = U  0$, moving strictly from $x=0$ to $x=L$. For a well-posed initial–boundary value problem of a first-order hyperbolic equation, boundary data must be prescribed only where characteristics enter the domain. Because $U0$, characteristics enter at $x=0$ and exit at $x=L$. Thus, one must specify a single boundary condition at $x=0$, and one must not prescribe an independent value at $x=L$, which would inject information from the outflow boundary counter to the direction of characteristic propagation. The natural physical datum at $x=0$ is the inflow concentration $C_{\\text{in}}(t)$ carried by the fluid entering from the upstream reservoir, i.e.,\n$$\nC(0,t) \\;=\\; C_{\\text{in}}(t).\n$$\n\n2. Parabolic (advection–diffusion) case with $\\kappa0$: The PDE is second order in space, and a well-posed problem on a finite interval typically requires one boundary condition at each end. The inflow condition $C(0,t)=C_{\\text{in}}(t)$ remains appropriate because it continuously connects to the hyperbolic limit and prescribes the incoming advective state. At the downstream boundary $x=L$, we seek an “open” condition that mimics extension to a semi-infinite domain, avoids spurious reflections, and enforces that no artificial diffusive exchange with an imagined boundary value occurs. Physically, if the reach is a truncation of a much longer river, then sufficiently far downstream the tracer equilibrates such that longitudinal gradients are negligible. A common and physically consistent choice is the zero-gradient Neumann condition\n$$\n\\partial_x C(L,t) \\;=\\; 0,\n$$\nwhich eliminates diffusive flux at the outflow boundary, ensuring the exit flux is purely advective $J(L,t)=U\\,C(L,t)$ and allowing the solution inside $(0,L)$ to determine the advective concentration leaving.\n\nThis choice can be justified by an energy estimate. Multiply the PDE by $C$ and integrate over $[0,L]$ to obtain\n$$\n\\frac{1}{2}\\,\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_0^L C^2\\,\\mathrm{d}x\n\\;+\\; \\frac{U}{2}\\,\\big(C^2(L,t) - C^2(0,t)\\big)\n\\;+\\; \\kappa \\int_0^L (\\partial_x C)^2\\,\\mathrm{d}x\n\\;-\\; \\kappa\\,\\big[C\\,\\partial_x C\\big]_{x=0}^{x=L}\n\\;=\\; \\int_0^L S\\,C\\,\\mathrm{d}x.\n$$\nThe boundary contributions are\n$$\nB(t) \\;=\\; \\frac{U}{2}\\,\\big(C^2(L,t) - C^2(0,t)\\big) \\;-\\; \\kappa\\,\\big(C(L,t)\\,\\partial_x C(L,t) - C(0,t)\\,\\partial_x C(0,t)\\big).\n$$\nImposing $\\partial_x C(L,t)=0$ removes the diffusive outflow term and leaves the advective energy transport $\\frac{U}{2} C^2(L,t)$ to exit the domain. At the inflow boundary, prescribing $C(0,t)=C_{\\text{in}}(t)$ renders $C(0,t)$ known, and the boundary energy input is controlled by the physical inflow state $C_{\\text{in}}(t)$. This structure mirrors an open downstream boundary and a prescribed upstream condition and is consistent with stability in the advection-dominated regime.\n\nAlternatively, consider the global mass balance obtained by integrating the conservation law directly:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_0^L C\\,\\mathrm{d}x\n\\;=\\; J(0,t) - J(L,t) \\;+\\; \\int_0^L S\\,\\mathrm{d}x\n\\;=\\; U\\,C(0,t) - \\kappa\\,\\partial_x C(0,t) \\;-\\; \\big(U\\,C(L,t) - \\kappa\\,\\partial_x C(L,t)\\big) \\;+\\; \\int_0^L S\\,\\mathrm{d}x.\n$$\nWith $C(0,t)=C_{\\text{in}}(t)$ and $\\partial_x C(L,t)=0$, the outflow is purely advective $J(L,t)=U\\,C(L,t)$, while the inflow is determined by the reservoir concentration $U\\,C_{\\text{in}}(t)$ plus any diffusive exchange across $x=0$ governed by $\\partial_x C(0,t)$, which the interior solution supplies. This is the correct physical partition: the upstream reservoir imposes concentration, the downstream receiver does not impose a value back into the domain, and diffusive leakage at $x=L$ is suppressed to emulate a large open domain beyond $L$.\n\nWe now assess each option:\n\nOption A: $C(0,t)=C_{\\text{in}}(t)$ and $\\partial_x C(L,t)=0$.\n- Analysis: At $x=0$, a Dirichlet condition fixes the inflow concentration, matching the hyperbolic limit requirement that data be prescribed only where characteristics enter for $U0$. At $x=L$, the Neumann zero-gradient condition removes diffusive flux, producing an open boundary that allows the solution-determined advective state to exit without imposing external information. This is consistent with the semi-infinite downstream extension and yields a well-posed problem connecting smoothly to the advection-dominated limit. Verdict: Correct.\n\nOption B: $\\partial_x C(0,t)=0$ and $C(L,t)=C_{\\text{out}}(t)$.\n- Analysis: A zero-gradient Neumann condition at the inflow fails to prescribe the entering advective state; instead, it ties the boundary gradient to zero, allowing the interior to determine the boundary concentration $C(0,t)$ and thereby the net advective inflow $U\\,C(0,t)$. This does not represent an upstream reservoir imposing $C_{\\text{in}}(t)$ and can lead to mass imbalance relative to the intended inflow. The Dirichlet condition at $x=L$ injects a concentration value at the outflow boundary, which in the advection-dominated limit would improperly force data into the domain from downstream, potentially causing nonphysical boundary layers and reflections. Verdict: Incorrect.\n\nOption C: $C(0,t)=C_{\\text{in}}(t)$ and $C(L,t)=C_{\\text{out}}(t)$.\n- Analysis: Although two Dirichlet conditions make the parabolic PDE mathematically well-posed, prescribing $C(L,t)$ at the outflow violates the hyperbolic limit for $U0$ by enforcing data where characteristics exit. Physically, an open downstream boundary should not impose a concentration back into the reach; doing so can generate artificial boundary layers near $x=L$ and reflected information upstream. It does not emulate a semi-infinite domain that naturally develops negligible gradients downstream. Verdict: Incorrect.\n\nOption D: $\\partial_x C(0,t)=0$ and $\\partial_x C(L,t)=0$.\n- Analysis: Two Neumann zero-gradient conditions suppress diffusive exchange at both boundaries and leave both boundary concentrations to be determined entirely by the interior solution. This deprives the inflow boundary of a prescribed advective state $C_{\\text{in}}(t)$, so the upstream reservoir is not represented. In the advection-dominated limit, the absence of inflow data at $x=0$ leads to an ill-posed first-order problem because no characteristic data are supplied where they enter the domain. Moreover, for the parabolic case, two Neumann conditions may lead to non-uniqueness up to an additive constant in the absence of additional constraints and do not reflect the physics of a prescribed inflow concentration. Verdict: Incorrect.\n\nTherefore, the appropriate inflow/outflow boundary conditions for $U0$ in a finite-reach advection–diffusion model with an upstream reservoir and a downstream open boundary are $C(0,t)=C_{\\text{in}}(t)$ and $\\partial_x C(L,t)=0$.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Most real-world governing equations are too complex to be solved by hand, necessitating the use of numerical methods. This practice bridges the gap between theory and computation by asking you to implement and analyze the Crank-Nicolson scheme, a workhorse for solving diffusion problems . Through a combination of coding and Fourier analysis, you will investigate the scheme’s stability and accuracy, gaining firsthand insight into how a numerical method's properties can affect the solution and why such analysis is a critical part of a modeler's toolkit.",
            "id": "3883646",
            "problem": "Consider one-dimensional diffusion of a passive tracer concentration governed by Fick’s First Law and conservation of mass. The flux is given by $J(x,t)=-D\\,\\partial_x c(x,t)$, where $D$ is a constant molecular diffusivity, and the conservation law is $\\partial_t c(x,t)+\\partial_x J(x,t)=0$. Combining these yields the parabolic partial differential equation (PDE) $\\partial_t c(x,t)=D\\,\\partial_{xx}c(x,t)$.\n\nYou will implement the Crank–Nicolson time-stepping scheme for the spatially discrete form of this PDE on a uniform periodic grid, and then use your implementation to numerically assess unconditional stability and numerical damping characteristics. The domain is $[0,L]$ with periodic boundary conditions and $N$ uniformly spaced grid points with spacing $\\Delta x=L/N$. Use the standard second-order centered difference for the discrete Laplacian operator and the trapezoidal (Crank–Nicolson) rule in time for the semi-implicit update between time levels $n$ and $n+1$.\n\nStarting from the fundamental base of Fick’s First Law and conservation of mass, derive the scheme you implement. Do not use any shortcut formulas in the problem statement. Your program should then apply the scheme in a way that allows you to:\n- Compute the per-step amplification factor of any discrete Fourier mode on the periodic grid.\n- Compare the Crank–Nicolson amplification with the exact semi-discrete time evolution of the spatially discretized ordinary differential equation.\n\nDefinitions to be used in your reasoning and implementation:\n- A discrete Fourier mode on a periodic grid with $N$ points is indexed by an integer $m\\in\\{0,1,\\dots,N-1\\}$ and has grid value proportional to $\\cos\\!\\big(2\\pi m\\, j/N\\big)$ or $\\sin\\!\\big(2\\pi m\\, j/N\\big)$ at grid index $j$.\n- The semi-discrete exact time evolution refers to analytically integrating the system of ordinary differential equations obtained after spatial discretization, yielding $c(t)=\\exp\\!\\big(\\lambda_m\\, t\\big)\\,c(0)$ for each discrete eigenmode, where $\\lambda_m$ is the eigenvalue of the discrete Laplacian corresponding to mode $m$.\n\nPhysical and numerical units:\n- Use $L$ in meters ($\\mathrm{m}$), $D$ in square meters per second ($\\mathrm{m}^2/\\mathrm{s}$), time $t$ in seconds ($\\mathrm{s}$), and wavenumbers in radians per meter ($\\mathrm{rad}/\\mathrm{m}$).\n- All requested outputs are dimensionless numbers and should be reported as plain floating-point values or booleans as specified.\n\nTest suite and outputs:\nImplement your program to evaluate the following three test cases. In each case, assume an initial condition $c(x,0)=A\\cos\\!\\big(2\\pi m\\,x/L\\big)$ with amplitude $A=1$ so that the dynamics are entirely captured by the amplification factor of mode $m$.\n\n- Test Case $1$ (accuracy in a non-stiff regime):\n    - Parameters: $L=1\\,\\mathrm{m}$, $N=128$, $D=10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t=10^{-3}\\,\\mathrm{s}$, final time $T=0.1\\,\\mathrm{s}$, mode index $m=4$.\n    - Task: Compute the absolute difference between the Crank–Nicolson-amplified magnitude after $T$ seconds and the semi-discrete exact magnitude after $T$ seconds for mode $m$. Return this absolute difference as a floating-point number.\n\n- Test Case $2$ (unconditional stability across all modes for a large time step):\n    - Parameters: $L=1\\,\\mathrm{m}$, $N=128$, $D=10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t=5\\,\\mathrm{s}$.\n    - Task: For all discrete modes $m\\in\\{0,\\dots,N-1\\}$, compute the per-step Crank–Nicolson amplification factor magnitude. Return a boolean that is $True$ if and only if every mode satisfies $|G_m|\\le 1$ (unconditional stability), otherwise return $False$.\n\n- Test Case $3$ (numerical damping deficiency for stiff high-frequency modes and temporal oscillations):\n    - Parameters: $L=1\\,\\mathrm{m}$, $N=128$, $D=1\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t=0.1\\,\\mathrm{s}$, final time $T=10\\,\\mathrm{s}$, mode index $m=N/2$ (Nyquist mode).\n    - Task: Compute the base-$10$ logarithm of the ratio of the Crank–Nicolson-amplified magnitude at $T$ seconds to the semi-discrete exact magnitude at $T$ seconds for mode $m$. Return this value as a floating-point number. A large positive value indicates severe under-damping by the Crank–Nicolson scheme relative to the semi-discrete exact decay.\n\nFinal output format:\nYour program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, in the order of Test Case $1$, Test Case $2$, Test Case $3$. For example, the output should look like $[x_1,x_2,x_3]$, where $x_1$ and $x_3$ are floating-point values and $x_2$ is a boolean.",
            "solution": "The user-provided problem is assessed to be **valid**. It is scientifically grounded in the principles of mass conservation and Fickian diffusion, mathematically well-posed, and presented with objective, precise language. All necessary data and definitions for the three specified test cases are provided, and the problem is a standard, non-trivial exercise in the numerical analysis of partial differential equations.\n\n### 1. Derivation of the Governing Equation and Numerical Scheme\n\nThe problem starts with two fundamental principles: the conservation of mass for a tracer concentration $c(x,t)$ and Fick's First Law for diffusive flux $J(x,t)$.\n\nThe conservation law in one dimension is expressed as a continuity equation:\n$$\n\\partial_t c(x,t) + \\partial_x J(x,t) = 0\n$$\nwhere $\\partial_t$ is the partial derivative with respect to time $t$ and $\\partial_x$ is the partial derivative with respect to space $x$.\n\nFick's First Law states that the flux is proportional to the negative of the concentration gradient, describing a down-gradient transport process:\n$$\nJ(x,t) = -D \\, \\partial_x c(x,t)\n$$\nwhere $D$ is the constant molecular diffusivity.\n\nSubstituting the expression for $J(x,t)$ into the conservation law yields:\n$$\n\\partial_t c(x,t) + \\partial_x \\left(-D \\, \\partial_x c(x,t)\\right) = 0\n$$\nAs the diffusivity $D$ is given as a constant, it can be factored out of the spatial derivative, leading to the one-dimensional diffusion equation, a parabolic partial differential equation (PDE):\n$$\n\\partial_t c(x,t) = D \\, \\partial_{xx} c(x,t)\n$$\n\n### 2. Spatial and Temporal Discretization\n\nTo solve this PDE numerically, we first perform a spatial discretization (method of lines). The domain $[0, L]$ is divided into $N$ uniform intervals of width $\\Delta x = L/N$, with grid points at $x_j = j \\Delta x$ for $j = 0, 1, \\dots, N-1$. Let $c_j(t)$ denote the numerical approximation of the concentration $c(x_j, t)$.\n\nThe second spatial derivative, $\\partial_{xx} c$, at grid point $x_j$ is approximated using the second-order central difference formula. This is appropriate for the periodic boundary conditions specified:\n$$\n\\partial_{xx} c(x_j, t) \\approx \\frac{c_{j+1}(t) - 2c_j(t) + c_{j-1}(t)}{\\Delta x^2}\n$$\nwhere indices are taken modulo $N$ (e.g., $c_N = c_0$ and $c_{-1} = c_{N-1}$). Substituting this into the PDE results in a system of coupled ordinary differential equations (ODEs), the semi-discrete form:\n$$\n\\frac{d c_j(t)}{dt} = \\frac{D}{\\Delta x^2} \\left( c_{j+1}(t) - 2c_j(t) + c_{j-1}(t) \\right)\n$$\nThis system can be written in vector form as $\\frac{d\\vec{c}}{dt} = \\mathbf{L}\\vec{c}$, where $\\vec{c} = [c_0, c_1, \\dots, c_{N-1}]^T$ and $\\mathbf{L}$ is the matrix representing the discrete Laplacian operator multiplied by $D$.\n\nFor the time integration, we apply the Crank-Nicolson method, which is equivalent to the trapezoidal rule. For a time step $\\Delta t$, with $\\vec{c}^n \\approx \\vec{c}(n\\Delta t)$, the scheme is:\n$$\n\\frac{\\vec{c}^{n+1} - \\vec{c}^n}{\\Delta t} = \\frac{1}{2} \\left( \\mathbf{L}\\vec{c}^{n+1} + \\mathbf{L}\\vec{c}^n \\right)\n$$\nThis is an implicit method. To facilitate computation, we rearrange the equation to isolate the unknown state $\\vec{c}^{n+1}$ on one side:\n$$\n\\vec{c}^{n+1} - \\frac{\\Delta t}{2} \\mathbf{L}\\vec{c}^{n+1} = \\vec{c}^n + \\frac{\\Delta t}{2} \\mathbf{L}\\vec{c}^n\n$$\nFactoring out the state vectors yields the standard form of the Crank-Nicolson scheme, which requires solving a linear system at each time step:\n$$\n\\left(\\mathbf{I} - \\frac{\\Delta t}{2} \\mathbf{L}\\right) \\vec{c}^{n+1} = \\left(\\mathbf{I} + \\frac{\\Delta t}{2} \\mathbf{L}\\right) \\vec{c}^n\n$$\nwhere $\\mathbf{I}$ is the identity matrix.\n\n### 3. Fourier Mode Analysis (von Neumann Stability Analysis)\n\nTo analyze the accuracy and stability of the scheme, we study its behavior on discrete Fourier modes, which are the eigenvectors of the circulant matrix $\\mathbf{L}$. A complex Fourier mode with index $m$ on the grid is given by $c_j = \\exp(i k x_j) = \\exp(i 2\\pi m j / N)$, where $k = 2\\pi m / L$ is the wavenumber.\n\nApplying the discrete spatial operator to this mode reveals the corresponding eigenvalue $\\lambda_m$:\n$$\n(\\mathbf{L} \\vec{c})_j = \\frac{D}{\\Delta x^2} \\left( e^{i 2\\pi m (j+1)/N} - 2e^{i 2\\pi m j/N} + e^{i 2\\pi m (j-1)/N} \\right) = \\frac{D}{\\Delta x^2} c_j \\left( e^{i 2\\pi m/N} - 2 + e^{-i 2\\pi m/N} \\right)\n$$\nUsing Euler's formula, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, this simplifies to:\n$$\n(\\mathbf{L} \\vec{c})_j = \\frac{2D}{\\Delta x^2} c_j \\left( \\cos\\left(\\frac{2\\pi m}{N}\\right) - 1 \\right)\n$$\nWith the identity $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$, the eigenvalue $\\lambda_m$ is:\n$$\n\\lambda_m = \\frac{-4D}{\\Delta x^2} \\sin^2\\left(\\frac{\\pi m}{N}\\right)\n$$\nThese eigenvalues are real and non-positive ($\\lambda_m \\le 0$), consistent with a purely dissipative physical process.\n\nThe \"semi-discrete exact\" evolution of mode $m$ follows the ODE $\\frac{dc_m(t)}{dt} = \\lambda_m c_m(t)$, whose solution is $c_m(t) = c_m(0) \\exp(\\lambda_m t)$. The amplification of this mode over a time $T$ is $\\exp(\\lambda_m T)$.\n\nThe numerical amplification factor, $G_m$, for the Crank-Nicolson scheme is found by substituting $\\vec{c}^{n+1} = G_m \\vec{c}^n$ and $\\mathbf{L}\\vec{c} = \\lambda_m \\vec{c}$ into the scheme's equation:\n$$\n\\left(1 - \\frac{\\Delta t}{2} \\lambda_m\\right) G_m = \\left(1 + \\frac{\\Delta t}{2} \\lambda_m\\right) \\implies G_m = \\frac{1 + \\lambda_m \\Delta t / 2}{1 - \\lambda_m \\Delta t / 2}\n$$\n\n### 4. Implementation Strategy for Test Cases\n\nThe derived formulas for $\\lambda_m$ and $G_m$ are used to evaluate the test cases.\n\n**Test Case 1:** The goal is to compute the accuracy of the scheme. We calculate the absolute difference between the total numerical amplification over $N_{steps} = T / \\Delta t$ steps and the total semi-discrete exact amplification over time $T$. The quantity is $\\left| |G_m|^{N_{steps}} - \\exp(\\lambda_m T) \\right|$.\n\n**Test Case 2:** This test verifies the unconditional stability property of the Crank-Nicolson scheme for the diffusion equation. We must check if $|G_m| \\le 1$ for all modes $m \\in \\{0, \\dots, N-1\\}$. Since $\\lambda_m \\le 0$ and $\\Delta t > 0$, the term $z_m = \\lambda_m \\Delta t / 2$ is non-positive. Let $z_m = -a_m$ where $a_m \\ge 0$. Then $|G_m| = |(1-a_m)/(1+a_m)|$. As shown in elementary analysis, this quantity is always less than or equal to $1$ for $a_m \\ge 0$. Therefore, the scheme is A-stable, and the test must evaluate to `True`.\n\n**Test Case 3:** This case highlights a known deficiency of the Crank-Nicolson scheme: its lack of strong damping for high-frequency (stiff) modes. We analyze the Nyquist mode, $m=N/2$, which has the largest magnitude eigenvalue and thus the fastest physical decay rate. We compute the base-$10$ logarithm of the ratio of the numerical amplification magnitude to the exact amplification magnitude: $\\log_{10}\\left( |G_m|^{N_{steps}} / \\exp(\\lambda_m T) \\right)$. For large $\\Delta t$, the value of $G_{N/2}$ approaches $-1$, meaning the numerical solution barely decays and oscillates in sign, whereas the exact solution decays almost instantaneously. This results in a very large positive value for the log-ratio. For numerical stability, this calculation is performed in log-space.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases for the Crank-Nicolson scheme analysis and print the results.\n    \"\"\"\n\n    # --- Helper function for core physics/numerics calculation ---\n    def get_modal_properties(L, N, D, dt, m):\n        \"\"\"\n        Computes the eigenvalue lambda_m of the discrete Laplacian and the \n        Crank-Nicolson amplification factor G_m for a given mode m.\n        \n        Args:\n            L (float): Domain length.\n            N (int): Number of grid points.\n            D (float): Diffusivity.\n            dt (float): Time step.\n            m (int): Fourier mode index.\n            \n        Returns:\n            tuple: (lambda_m, G_m)\n        \"\"\"\n        dx = L / N\n        \n        # Eigenvalue lambda_m. Handle the m=0 (constant) mode explicitly\n        # to ensure it is exactly zero.\n        if m % N == 0:\n            lambda_m = 0.0\n        else:\n            # Formula derived from centered difference operator on a periodic grid.\n            lambda_m = (-4.0 * D / dx**2) * np.sin(np.pi * m / N)**2\n\n        # Crank-Nicolson per-step amplification factor G_m.\n        numerator = 1.0 + 0.5 * dt * lambda_m\n        denominator = 1.0 - 0.5 * dt * lambda_m\n        # Denominator is guaranteed to be positive as D >= 0, dt > 0, and lambda_m = 0.\n        G_m = numerator / denominator\n        \n        return lambda_m, G_m\n\n    # --- Container for results ---\n    results = []\n\n    # =========================================================================\n    # Test Case 1: Accuracy in a non-stiff regime\n    # =========================================================================\n    params1 = {'L': 1.0, 'N': 128, 'D': 1e-4, 'dt': 1e-3, 'T': 0.1, 'm': 4}\n    \n    lambda_m1, G_m1 = get_modal_properties(params1['L'], params1['N'], params1['D'], params1['dt'], params1['m'])\n    \n    num_steps1 = int(round(params1['T'] / params1['dt']))\n    \n    # Final magnitude from Crank-Nicolson scheme after T seconds.\n    cn_magnitude1 = np.abs(G_m1)**num_steps1\n    \n    # Final magnitude from semi-discrete exact solution after T seconds.\n    exact_magnitude1 = np.exp(lambda_m1 * params1['T'])\n    \n    result1 = np.abs(cn_magnitude1 - exact_magnitude1)\n    results.append(result1)\n\n    # =========================================================================\n    # Test Case 2: Unconditional stability\n    # =========================================================================\n    params2 = {'L': 1.0, 'N': 128, 'D': 1e-4, 'dt': 5.0}\n\n    is_stable = True\n    # Theory guarantees stability (|G_m| = 1). This is a numerical verification.\n    for m_idx in range(params2['N']):\n        _, G_m_val = get_modal_properties(params2['L'], params2['N'], params2['D'], params2['dt'], m_idx)\n        # Allow a small floating-point tolerance for the check.\n        if np.abs(G_m_val) > 1.0 + 1e-12:\n            is_stable = False\n            break\n    \n    result2 = is_stable\n    results.append(result2)\n\n    # =========================================================================\n    # Test Case 3: Numerical damping deficiency for stiff modes\n    # =========================================================================\n    params3 = {'L': 1.0, 'N': 128, 'D': 1.0, 'dt': 0.1, 'T': 10.0, 'm': 128 // 2}\n\n    lambda_m3, G_m3 = get_modal_properties(params3['L'], params3['N'], params3['D'], params3['dt'], params3['m'])\n    \n    num_steps3 = int(round(params3['T'] / params3['dt']))\n\n    # To avoid potential underflow/overflow from direct ratio computation,\n    # the log of the ratio is computed in log space: log10(a/b) = log10(a) - log10(b).\n    # log10(|G|**N_steps) = N_steps * log10(|G|)\n    # log10(exp(lambda*T)) = (lambda*T) / ln(10)\n    \n    log10_cn_mag = num_steps3 * np.log10(np.abs(G_m3))\n    log10_exact_mag = (lambda_m3 * params3['T']) / np.log(10)\n    \n    result3 = log10_cn_mag - log10_exact_mag\n    results.append(result3)\n\n    # =========================================================================\n    # Final Output Formatting\n    # =========================================================================\n    # The format must be exactly [val1,val2,val3] with no extra spaces or text.\n    output_str = f\"[{results[0]},{results[1]},{results[2]}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}