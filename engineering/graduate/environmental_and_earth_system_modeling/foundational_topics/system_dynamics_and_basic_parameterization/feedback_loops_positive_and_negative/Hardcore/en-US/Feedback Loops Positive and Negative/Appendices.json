{
    "hands_on_practices": [
        {
            "introduction": "We begin with the most fundamental representation of the climate system: a zero-dimensional energy balance model at equilibrium. This exercise strips away complexity to focus on the core relationship between an external radiative forcing and the system's response, which is mediated by feedbacks. By calculating the expected warming from a doubling of atmospheric $CO_2$, you will see how the net climate feedback parameter, $\\lambda$, directly determines the equilibrium climate sensitivity and the overall stability of the system .",
            "id": "3879458",
            "problem": "An energy balance model at the Top of Atmosphere (TOA) is constructed for the equilibrium temperature response of the climate system to a radiative forcing. The fundamental starting point is conservation of energy at the TOA: the net radiative imbalance $N$ satisfies $N = F + R(T)$, where $F$ is an externally imposed radiative forcing and $R(T)$ is the radiative response of the climate system. Around a reference climate state, assume the radiative response can be linearized as $R(T) \\approx -\\lambda \\,\\Delta T$, where $\\Delta T$ is the change in global-mean surface temperature and $\\lambda$ is the net climate feedback parameter, defined as the sum of partial feedbacks arising from distinct physical processes.\n\nConsider a carbon dioxide doubling forcing of magnitude $F_2 = 3.7\\,\\mathrm{W\\,m^{-2}}$. The net feedback parameter is the sum of the following components (each in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$):\n- Planck (thermal) feedback: $\\lambda_{\\mathrm{P}} = 3.3$,\n- Water vapor plus lapse-rate feedback: $\\lambda_{\\mathrm{wv+lr}} = -1.2$,\n- Cloud feedback: $\\lambda_{\\mathrm{cld}} = -0.4$,\n- Ice–albedo feedback: $\\lambda_{\\mathrm{ia}} = -0.1$.\n\nUsing only the TOA energy balance and the linearized radiative response, first determine the equilibrium warming $\\Delta T$ for the given $F_2$ and net $\\lambda$, and analyze qualitatively how the sign and magnitude of $\\lambda$ control the existence and size of the equilibrium solution. Then, to quantify the sensitivity of the equilibrium warming to the feedback strength, compute the local derivative $\\partial \\Delta T / \\partial \\lambda$ at the computed net $\\lambda$, holding $F_2$ fixed.\n\nReport the numerical value of $\\partial \\Delta T / \\partial \\lambda$ evaluated at the given parameter values. Express the sensitivity in Kelvin per $\\left(\\mathrm{W\\,m^{-2}\\,K^{-1}}\\right)$. Round your answer to three significant figures.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded in the principles of climate modeling, well-posed with a clear objective and sufficient data, and free from any listed invalidating flaws.\n\nThe analysis begins with the fundamental equation for the Top of Atmosphere (TOA) energy balance at equilibrium. The net radiative imbalance $N$ must be zero. The model provided is $N = F + R(T)$, where $F$ is the radiative forcing and $R(T)$ is the radiative response. At equilibrium:\n$$N = F + R(T) = 0$$\nThe radiative response is linearized as $R(T) \\approx -\\lambda \\Delta T$, where $\\Delta T$ is the change in global-mean surface temperature and $\\lambda$ is the net climate feedback parameter. Substituting this into the equilibrium equation gives:\n$$F - \\lambda \\Delta T = 0$$\nSolving for the equilibrium warming $\\Delta T$ yields:\n$$\\Delta T = \\frac{F}{\\lambda}$$\nThe net climate feedback parameter $\\lambda$ is given as the sum of its constituent components:\n$$\\lambda = \\lambda_{\\mathrm{P}} + \\lambda_{\\mathrm{wv+lr}} + \\lambda_{\\mathrm{cld}} + \\lambda_{\\mathrm{ia}}$$\nThe problem provides the following values for the forcing and feedback components, with units of $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ for the feedbacks and $\\mathrm{W\\,m^{-2}}$ for the forcing:\n- Carbon dioxide doubling forcing: $F_2 = 3.7$\n- Planck feedback: $\\lambda_{\\mathrm{P}} = 3.3$\n- Water vapor plus lapse-rate feedback: $\\lambda_{\\mathrm{wv+lr}} = -1.2$\n- Cloud feedback: $\\lambda_{\\mathrm{cld}} = -0.4$\n- Ice–albedo feedback: $\\lambda_{\\mathrm{ia}} = -0.1$\n\nFirst, we calculate the numerical value of the net feedback parameter $\\lambda$:\n$$\\lambda = 3.3 + (-1.2) + (-0.4) + (-0.1) = 3.3 - 1.7 = 1.6 \\, \\mathrm{W\\,m^{-2}\\,K^{-1}}$$\nThe sign of $\\lambda$ determines the stability of the climate system. For a stable equilibrium to exist in response to a positive forcing ($F > 0$), the warming must also be positive ($\\Delta T > 0$). From the equation $\\Delta T = F/\\lambda$, this requires $\\lambda > 0$. A positive $\\lambda$ signifies that the net effect of all feedback processes is stabilizing (i.e., a negative feedback loop). In this case, the strongly stabilizing Planck feedback ($\\lambda_{\\mathrm{P}} = 3.3$) outweighs the sum of the destabilizing feedbacks ($\\lambda_{\\mathrm{wv+lr}} + \\lambda_{\\mathrm{cld}} + \\lambda_{\\mathrm{ia}} = -1.7$), resulting in a net positive $\\lambda$. If $\\lambda$ were zero or negative, the system would exhibit runaway warming or instability.\n\nThe magnitude of $\\lambda$ controls the magnitude of the warming. A larger value of $\\lambda$ implies a stronger stabilizing response from the climate system, leading to a smaller equilibrium temperature change for a given forcing. Conversely, a smaller positive $\\lambda$ results in a larger warming, characterizing a system with higher climate sensitivity.\n\nUsing the calculated value for $\\lambda$ and the given forcing $F_2$, we can determine the equilibrium warming:\n$$\\Delta T = \\frac{F_2}{\\lambda} = \\frac{3.7}{1.6} = 2.3125 \\, \\mathrm{K}$$\n\nNext, we quantify the sensitivity of the equilibrium warming $\\Delta T$ to the net feedback parameter $\\lambda$. We compute the partial derivative of $\\Delta T$ with respect to $\\lambda$, holding the forcing $F$ constant. Starting from the expression for $\\Delta T$:\n$$\\Delta T = F \\lambda^{-1}$$\nWe differentiate with respect to $\\lambda$:\n$$\\frac{\\partial \\Delta T}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda}(F \\lambda^{-1})$$\nApplying the power rule for differentiation ($d(x^n)/dx = nx^{n-1}$), we get:\n$$\\frac{\\partial \\Delta T}{\\partial \\lambda} = F(-1)\\lambda^{-2} = -\\frac{F}{\\lambda^2}$$\nThe negative sign indicates that an increase in the net feedback parameter $\\lambda$ (stronger stabilization) leads to a decrease in the equilibrium warming $\\Delta T$, consistent with our qualitative analysis.\n\nFinally, we substitute the numerical values for the forcing $F_2$ and the net feedback parameter $\\lambda$ to calculate the value of this sensitivity:\n$$F = F_2 = 3.7 \\, \\mathrm{W\\,m^{-2}}$$\n$$\\lambda = 1.6 \\, \\mathrm{W\\,m^{-2}\\,K^{-1}}$$\n$$\\frac{\\partial \\Delta T}{\\partial \\lambda} = -\\frac{3.7}{(1.6)^2} = -\\frac{3.7}{2.56} \\approx -1.4453125 \\, \\mathrm{K} / (\\mathrm{W\\,m^{-2}\\,K^{-1}})$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\\frac{\\partial \\Delta T}{\\partial \\lambda} \\approx -1.45 \\, \\mathrm{K} / (\\mathrm{W\\,m^{-2}\\,K^{-1}})$$\nThis value represents the rate at which the equilibrium warming decreases for a unit increase in the net climate feedback parameter.",
            "answer": "$$\\boxed{-1.45}$$"
        },
        {
            "introduction": "Building on the static equilibrium view, this practice introduces dynamics by incorporating the system's thermal inertia, or heat capacity. The problem shifts from a simple algebraic balance to a first-order differential equation, allowing us to model the *transient* warming path over time. Solving this model for the temperature anomaly $T(t)$ reveals how the feedback parameter $\\lambda$ not only determines the magnitude of the final equilibrium state but also governs the characteristic timescale $\\tau$ on which the system approaches it .",
            "id": "3879366",
            "problem": "Consider a globally averaged, one-layer Energy Balance Model (EBM) of the climate system in which the prognostic variable is the global-mean surface temperature anomaly $T(t)$ measured in kelvin. The conservation of energy for the layer is represented by\n$$\nC \\frac{dT}{dt} = F(t) - \\lambda T,\n$$\nwhere $C$ is the effective heat capacity of the coupled surface layer (ocean mixed layer plus land), $F(t)$ is the externally imposed radiative forcing in watts per square meter, and $\\lambda$ is the net climate feedback parameter in watts per square meter per kelvin. The function $F(t)$ is a step forcing of magnitude $F_00$, so $F(t)=F_0 H(t)$ with $H(t)$ the Heaviside step function defined by $H(t)=0$ for $t0$ and $H(t)=1$ for $t\\ge 0$. Assume the system is initially in equilibrium with $F(t)=0$ and $T(t)=0$ for $t0$, and that $C0$ and $\\lambda \\neq 0$ are time-independent.\n\nDerive the transient response $T(t)$ for all $t$ and express it as a single closed-form analytic expression in terms of $F_0$, $C$, $\\lambda$, $t$, and $H(t)$. Express $T(t)$ in kelvin. Additionally, starting from conservation of energy and the definitions above, explain in words how the time constant $\\tau=C/\\lambda$ encodes the strength and sign of feedbacks within this linear model (distinguishing negative feedback when $\\lambda0$ and positive feedback when $\\lambda0$), including the implications for stability and approach to equilibrium.\n\nYour final answer must be the single analytic expression for $T(t)$ only; any discussion of feedback mechanisms should appear in your derivation. No numerical approximation or rounding is required.",
            "solution": "The problem is valid. It presents a standard, well-posed first-order linear ordinary differential equation representing a simplified Energy Balance Model, with all necessary parameters and initial conditions clearly defined. The physical and mathematical setup is sound and self-consistent.\n\nThe governing equation for the global-mean surface temperature anomaly $T(t)$ is given by the conservation of energy principle:\n$$\nC \\frac{dT}{dt} = F(t) - \\lambda T\n$$\nwhere $C  0$ is the effective heat capacity, $F(t)$ is the external radiative forcing, and $\\lambda \\neq 0$ is the net climate feedback parameter. The forcing is a step function, $F(t) = F_0 H(t)$, where $F_0  0$ and $H(t)$ is the Heaviside step function. The initial condition is $T(t)=0$ for $t  0$, which implies continuity at $t=0$, so $T(0)=0$.\n\nThe equation can be rewritten in the standard form for a first-order linear ordinary differential equation, $\\frac{dT}{dt} + p(t)T = q(t)$:\n$$\n\\frac{dT}{dt} + \\frac{\\lambda}{C} T = \\frac{F(t)}{C}\n$$\nFor $t  0$, we have $F(t)=0$ and are given $T(t)=0$. This is the trivial equilibrium solution to $\\frac{dT}{dt} + \\frac{\\lambda}{C} T = 0$.\n\nFor $t \\ge 0$, the forcing is constant, $F(t)=F_0$, and the equation becomes:\n$$\n\\frac{dT}{dt} + \\frac{\\lambda}{C} T = \\frac{F_0}{C}\n$$\nThis is a non-homogeneous equation with constant coefficients. We solve it using an integrating factor $I(t)$:\n$$\nI(t) = \\exp\\left(\\int \\frac{\\lambda}{C} dt\\right) = \\exp\\left(\\frac{\\lambda}{C}t\\right)\n$$\nMultiplying the differential equation by $I(t)$ gives:\n$$\n\\exp\\left(\\frac{\\lambda}{C}t\\right) \\frac{dT}{dt} + \\frac{\\lambda}{C} \\exp\\left(\\frac{\\lambda}{C}t\\right) T = \\frac{F_0}{C} \\exp\\left(\\frac{\\lambda}{C}t\\right)\n$$\nThe left side is the result of the product rule for differentiation, $\\frac{d}{dt}\\left(T(t)I(t)\\right)$:\n$$\n\\frac{d}{dt}\\left(T(t) \\exp\\left(\\frac{\\lambda}{C}t\\right)\\right) = \\frac{F_0}{C} \\exp\\left(\\frac{\\lambda}{C}t\\right)\n$$\nIntegrating both sides with respect to $t$ from $0$ to $t$:\n$$\n\\int_0^t \\frac{d}{dt'}\\left(T(t') \\exp\\left(\\frac{\\lambda}{C}t'\\right)\\right) dt' = \\int_0^t \\frac{F_0}{C} \\exp\\left(\\frac{\\lambda}{C}t'\\right) dt'\n$$\n$$\n\\left[ T(t') \\exp\\left(\\frac{\\lambda}{C}t'\\right) \\right]_0^t = \\frac{F_0}{C} \\left[ \\frac{C}{\\lambda} \\exp\\left(\\frac{\\lambda}{C}t'\\right) \\right]_0^t\n$$\n$$\nT(t) \\exp\\left(\\frac{\\lambda}{C}t\\right) - T(0) \\exp(0) = \\frac{F_0}{\\lambda} \\left( \\exp\\left(\\frac{\\lambda}{C}t\\right) - \\exp(0) \\right)\n$$\nUsing the initial condition $T(0)=0$:\n$$\nT(t) \\exp\\left(\\frac{\\lambda}{C}t\\right) = \\frac{F_0}{\\lambda} \\left( \\exp\\left(\\frac{\\lambda}{C}t\\right) - 1 \\right)\n$$\nSolving for $T(t)$ by multiplying by $\\exp\\left(-\\frac{\\lambda}{C}t\\right)$:\n$$\nT(t) = \\frac{F_0}{\\lambda} \\left( 1 - \\exp\\left(-\\frac{\\lambda}{C}t\\right) \\right)\n$$\nThis solution is valid for $t \\ge 0$. To express the solution for all $t$ as a single closed-form expression, we use the Heaviside function $H(t)$. Since the derived expression is $0$ at $t=0$ and the solution is given as $0$ for $t0$, we can write:\n$$\nT(t) = \\frac{F_0}{\\lambda} \\left( 1 - \\exp\\left(-\\frac{\\lambda}{C}t\\right) \\right) H(t)\n$$\n\nNow, we explain the role of feedbacks and the time constant $\\tau = C/\\lambda$. The governing equation $C \\frac{dT}{dt} = F(t) - \\lambda T$ states that the rate of change of energy stored in the system is equal to the energy entering from the external forcing, $F(t)$, minus the energy leaving the system due to the response of the climate, $-\\lambda T$. The term $-\\lambda T$ is the net feedback.\n\nCase $1$: Negative feedback ($\\lambda  0$).\nIf $\\lambda$ is positive, a positive temperature anomaly ($T0$) results in a negative feedback term ($-\\lambda T  0$), signifying an increase in outgoing radiation that counteracts the initial warming. This is a stabilizing mechanism. The time constant $\\tau = C/\\lambda$ is positive. The solution for $t \\ge 0$ is $T(t) = \\frac{F_0}{\\lambda} \\left(1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\\right)$. As $t \\to \\infty$, the exponential term decays to $0$, and the temperature approaches a new, stable equilibrium $T_{eq} = \\frac{F_0}{\\lambda}$. The time constant $\\tau$ is the e-folding time; it is the time it takes for the temperature to complete approximately $1 - 1/e \\approx 63\\%$ of its change towards the new equilibrium. A larger $\\lambda$ (stronger negative feedback) leads to a smaller equilibrium temperature change $T_{eq}$ and a faster response (smaller $\\tau$).\n\nCase $2$: Positive feedback ($\\lambda  0$).\nIf $\\lambda$ is negative, a positive temperature anomaly ($T0$) results in a positive feedback term ($-\\lambda T  0$), signifying a decrease in outgoing radiation (or increase in absorbed energy) that amplifies the initial warming. This is a destabilizing mechanism. Let $\\lambda = -|\\lambda|$. The time constant $\\tau = C/\\lambda = -C/|\\lambda|$ is negative. The solution for $t \\ge 0$ becomes:\n$$\nT(t) = \\frac{F_0}{-|\\lambda|} \\left(1 - \\exp\\left(-\\frac{-|\\lambda|}{C}t\\right)\\right) = \\frac{F_0}{|\\lambda|} \\left(\\exp\\left(\\frac{|\\lambda|}{C}t\\right) - 1\\right)\n$$\nIn this case, for any $F_0  0$, the temperature $T(t)$ grows exponentially without bound. The system is unstable and does not approach an equilibrium. This is often termed a \"runaway\" climate scenario. The quantity $|\\tau| = C/|\\lambda|$ represents the characteristic time scale for this exponential divergence. A larger $|\\lambda|$ (stronger positive feedback) leads to a more rapid, catastrophic warming (smaller $|\\tau|$ and faster exponential growth).\n\nIn summary, the time constant $\\tau=C/\\lambda$ encodes the fundamental behavior of the system. Its sign, determined by $\\lambda$, dictates stability: a positive $\\tau$ implies a stable system approaching equilibrium, while a negative $\\tau$ implies an unstable, runaway system. Its magnitude, $|\\tau|=C/|\\lambda|$, represents the characteristic timescale of the system's response, which is proportional to the thermal inertia $C$ and inversely proportional to the magnitude of the net feedback strength $|\\lambda|$.",
            "answer": "$$\n\\boxed{\\frac{F_0}{\\lambda} \\left(1 - \\exp\\left(-\\frac{\\lambda t}{C}\\right)\\right) H(t)}\n$$"
        },
        {
            "introduction": "Our final practice moves from simple analytical models to a more physically realistic numerical simulation, a core activity in Earth system modeling. We will use a two-box model that distinguishes the fast-responding ocean mixed layer from the slow deep ocean, and we will explicitly implement a key positive feedback: the non-linear ice-albedo effect. By running simulations with and without this feedback, you will practice a fundamental technique for quantifying a specific feedback's contribution to overall system warming, bridging the gap between conceptual theory and applied climate science .",
            "id": "3879409",
            "problem": "Consider a global two-box Energy Balance Model (EBM) consisting of a mixed-layer ocean and a deep ocean, forced by an externally imposed radiative imbalance. The governing equations are derived from conservation of energy for each box. Let $T_m(t)$ denote the globally averaged mixed-layer temperature anomaly (in $\\mathrm{K}$) and $T_d(t)$ the deep-ocean temperature anomaly (in $\\mathrm{K}$). The mixed-layer and deep-ocean heat capacities per unit area are $C_m$ and $C_d$ in $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$. The atmosphere–ocean heat exchange coefficient is $\\kappa$ in $\\mathrm{W\\, m^{-2}\\, K^{-1}}$. The net longwave radiative response is linearized with the effective climate feedback parameter $\\lambda$ in $\\mathrm{W\\, m^{-2}\\, K^{-1}}$. The externally imposed radiative forcing is a linear ramp $F(t)$ (in $\\mathrm{W\\, m^{-2}}$) from $0$ to $F_{\\mathrm{end}}$ over a duration $T_{\\mathrm{end}}$ (in years), namely $F(t) = F_{\\mathrm{end}}\\, t / T_{\\mathrm{end}}$ for $t \\in [0, T_{\\mathrm{end}}]$. The planetary mean incoming shortwave radiation is $S_0$ (in $\\mathrm{W\\, m^{-2}}$), with baseline albedo $\\alpha_0$.\n\nTo represent the ice–albedo feedback, assume the planetary albedo is a temperature-dependent function $\\alpha(T_m)$ that decreases with increasing $T_m$, saturating between $\\alpha_{\\min}$ and $\\alpha_{\\max}$, given by\n$$\n\\alpha(T_m) = \\min\\Big(\\alpha_{\\max}, \\max\\big(\\alpha_{\\min}, \\alpha_0 - s\\, T_m\\big)\\Big),\n$$\nwhere $s$ (in $\\mathrm{K^{-1}}$) is a small positive slope controlling the sensitivity of albedo to mixed-layer warming. The change in absorbed shortwave due to albedo change relative to the baseline is modeled as an additive feedback forcing\n$$\nF_{\\alpha}(T_m) = S_0\\big(\\alpha_0 - \\alpha(T_m)\\big),\n$$\nso that $F_{\\alpha}(T_m) \\ge 0$ when $\\alpha(T_m) \\le \\alpha_0$.\n\nUnder these assumptions, the two-box EBM evolves according to\n$$\n\\begin{aligned}\nC_m \\frac{dT_m}{dt} = F(t) + F_{\\alpha}(T_m) - \\lambda\\, T_m - \\kappa\\,(T_m - T_d),\\\\\nC_d \\frac{dT_d}{dt} = \\kappa\\,(T_m - T_d),\n\\end{aligned}\n$$\nwith initial conditions $T_m(0) = 0$ and $T_d(0) = 0$.\n\nYour task is to quantify the contribution of the ice–albedo feedback to transient warming at the end of the ramp, $t = T_{\\mathrm{end}}$. Define the counterfactual without feedback by setting $F_{\\alpha}(T_m) \\equiv 0$. Let $T_m^{\\mathrm{on}}(T_{\\mathrm{end}})$ and $T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$ denote the mixed-layer temperatures at $t = T_{\\mathrm{end}}$ with feedback on and off, respectively. Quantify two metrics:\n- The attributable warming due to ice–albedo feedback,\n$$\n\\Delta T = T_m^{\\mathrm{on}}(T_{\\mathrm{end}}) - T_m^{\\mathrm{off}}(T_{\\mathrm{end}}),\n$$\nexpressed in $\\mathrm{K}$.\n- The fraction of transient warming attributable to ice–albedo feedback,\n$$\n\\phi = \n\\begin{cases}\n\\Delta T \\big/ T_m^{\\mathrm{off}}(T_{\\mathrm{end}}),  \\text{if } T_m^{\\mathrm{off}}(T_{\\mathrm{end}}) > 0,\\\\\n0,  \\text{if } T_m^{\\mathrm{off}}(T_{\\mathrm{end}}) = 0,\n\\end{cases}\n$$\nexpressed as a decimal.\n\nAdopt $S_0 = 340$ $\\mathrm{W\\, m^{-2}}$. Time is in years, temperature in $\\mathrm{K}$, and all flux-like parameters are in $\\mathrm{W\\, m^{-2}}$ or $\\mathrm{W\\, m^{-2}\\, K^{-1}}$ as appropriate. Numerically integrate the system to obtain $T_m^{\\mathrm{on}}(T_{\\mathrm{end}})$ and $T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$ for each test case specified below. Use accurate numerical integration; analytical shortcuts are not permitted.\n\nTest suite parameter sets, each given as a tuple $(F_{\\mathrm{end}}, T_{\\mathrm{end}}, s, \\alpha_{\\min}, \\alpha_{\\max}, \\alpha_0, \\lambda, \\kappa, C_m, C_d)$:\n- Case $1$ (general, moderate feedback): $(4, 100, 0.0010, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00)$.\n- Case $2$ (boundary, no feedback): $(4, 100, 0.0000, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00)$.\n- Case $3$ (edge, zero forcing): $(0, 100, 0.0010, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00)$.\n- Case $4$ (stronger ramp, stronger but stable feedback): $(8, 200, 0.0020, 0.20, 0.70, 0.30, 1.00, 0.80, 7.00, 100.00)$.\n\nYour program must output a single line containing the results for all test cases as a comma-separated list enclosed in square brackets, in the order $[\\Delta T_1, \\phi_1, \\Delta T_2, \\phi_2, \\Delta T_3, \\phi_3, \\Delta T_4, \\phi_4]$. Each element must be a float (in $\\mathrm{K}$ for $\\Delta T_i$ and a decimal for $\\phi_i$), with no extra text. No user input is required; all values are provided above and must be hard-coded. The numerical integration must be sufficiently accurate to capture the dynamics over the specified time horizons.",
            "solution": "The user has provided a problem that requires the numerical solution of a two-box Energy Balance Model (EBM) to quantify the effect of ice-albedo feedback on transient global warming.\n\n### Step 1: Problem Validation\n\nThe problem statement is first subjected to a rigorous validation process.\n\n**1. Givens Extraction:**\n- **State Variables:** Mixed-layer temperature anomaly $T_m(t)$ and deep-ocean temperature anomaly $T_d(t)$, both in $\\mathrm{K}$.\n- **Physical Constants:** Planetary mean incoming shortwave radiation $S_0 = 340 \\mathrm{\\,W\\,m^{-2}}$.\n- **Model Parameters:** Mixed-layer heat capacity $C_m$ and deep-ocean heat capacity $C_d$ (in $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$), atmosphere–ocean heat exchange coefficient $\\kappa$ ($\\mathrm{W\\,m^{-2}\\,K^{-1}}$), climate feedback parameter $\\lambda$ ($\\mathrm{W\\,m^{-2}\\,K^{-1}}$), albedo sensitivity $s$ ($\\mathrm{K^{-1}}$), and albedo limits $\\alpha_{\\min}$, $\\alpha_{\\max}$, and baseline $\\alpha_0$.\n- **Forcing:** A linear ramp forcing $F(t) = F_{\\mathrm{end}}\\, t / T_{\\mathrm{end}}$ over the interval $t \\in [0, T_{\\mathrm{end}}]$.\n- **Feedback Formulation:** The ice–albedo feedback is modeled as an additive forcing $F_{\\alpha}(T_m) = S_0(\\alpha_0 - \\alpha(T_m))$, where the albedo $\\alpha(T_m)$ is a piecewise linear function of $T_m$: $\\alpha(T_m) = \\min\\Big(\\alpha_{\\max}, \\max\\big(\\alpha_{\\min}, \\alpha_0 - s\\, T_m\\big)\\Big)$.\n- **Governing Equations:** A system of two coupled first-order ordinary differential equations (ODEs):\n$$\n\\begin{aligned}\nC_m \\frac{dT_m}{dt} = F(t) + F_{\\alpha}(T_m) - \\lambda\\, T_m - \\kappa\\,(T_m - T_d) \\\\\nC_d \\frac{dT_d}{dt} = \\kappa\\,(T_m - T_d)\n\\end{aligned}\n$$\n- **Initial Conditions:** $T_m(0) = 0$ and $T_d(0) = 0$.\n- **Objective:** For four specified parameter sets, calculate the attributable warming $\\Delta T = T_m^{\\mathrm{on}}(T_{\\mathrm{end}}) - T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$ and the attributable warming fraction $\\phi = \\Delta T / T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$. The superscripts 'on' and 'off' denote simulations with the albedo feedback enabled ($F_{\\alpha}(T_m)$ as defined) and disabled ($F_{\\alpha}(T_m) \\equiv 0$), respectively.\n\n**2. Validation Verdict:**\n- **Scientific Grounding:** The problem describes a canonical two-box EBM, a standard tool in climate science for conceptual understanding. The equations represent energy conservation. The formulation of forcing and feedbacks, including the non-linear ice-albedo feedback, is physically and conceptually sound within the context of such models. The specified parameter values are within plausible ranges for these simplified models. The units for the heat capacities ($C_m, C_d$) are given in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ but are noted to be \"expressed for time in years\". For dimensional consistency of the ODEs where time $t$ is in years, these parameters must be interpreted as having units of $\\mathrm{W\\,yr\\,m^{-2}\\,K^{-1}}$, which is a common convention in the literature for such models. With this standard interpretation, the problem is dimensionally consistent and scientifically valid.\n- **Well-Posedness:** The problem is well-posed. The system of ODEs with the given initial conditions has a unique solution because the right-hand side of the ODE system is a continuous and locally Lipschitz function of the state variables $(T_m, T_d)$.\n- **Completeness and Consistency:** The problem is self-contained, providing all necessary equations, parameters, initial conditions, and numerical tasks. There are no contradictions.\n- **Conclusion:** The problem is deemed valid and a solution can be constructed.\n\n### Step 2: Solution Derivation and Algorithmic Design\n\nThe core of the problem is to solve a system of initial value problems. As analytical solutions are complex for the non-linear \"feedback on\" case and explicitly disallowed, a numerical approach is required.\n\n**1. System of ODEs:**\nLet the state of the system be represented by the vector $\\mathbf{y}(t) = [T_m(t), T_d(t)]^T$. The governing equations can be rewritten in vector form $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$:\n$$\n\\frac{d}{dt} \\begin{pmatrix} T_m \\\\ T_d \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{C_m} \\left[ F(t) + F_{\\alpha}(T_m) - (\\lambda + \\kappa)T_m + \\kappa T_d \\right] \\\\ \\frac{1}{C_d} \\left[ \\kappa T_m - \\kappa T_d \\right] \\end{pmatrix}\n$$\nThe initial condition is $\\mathbf{y}(0) = [0, 0]^T$.\n\n**2. Numerical Integration:**\nThis system will be solved using a high-quality numerical ODE solver. The `scipy.integrate.solve_ivp` function from the SciPy library is an excellent choice. It provides several integration methods, including adaptive-step-size algorithms like the Dormand-Prince method (RK45), which are well-suited for achieving high accuracy efficiently.\n\n**3. Implementation Strategy:**\nThe overall algorithm will be as follows:\n- Iterate through each of the four test cases provided.\n- For each test case:\n    a. Define the full set of parameters $(F_{\\mathrm{end}}, T_{\\mathrm{end}}, s, \\dots, C_d)$.\n    b. **Solve for the \"feedback off\" case:**\n       - Set up the ODE system function with the albedo feedback term $F_{\\alpha}(T_m)$ forced to zero.\n       - Numerically integrate the system from $t=0$ to $t=T_{\\mathrm{end}}$ using `solve_ivp`.\n       - Extract the final mixed-layer temperature, $T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$.\n    c. **Solve for the \"feedback on\" case:**\n       - Set up the ODE system function with the full albedo feedback term $F_{\\alpha}(T_m)$ enabled. The piecewise nature of $\\alpha(T_m)$ will be implemented using clipping functions (e.g., `numpy.clip`).\n       - Numerically integrate this non-linear system from $t=0$ to $t=T_{\\mathrm{end}}$.\n       - Extract the final mixed-layer temperature, $T_m^{\\mathrm{on}}(T_{\\mathrm{end}})$.\n    d. **Calculate Metrics:**\n       - Compute the attributable warming: $\\Delta T = T_m^{\\mathrm{on}}(T_{\\mathrm{end}}) - T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$.\n       - Compute the fractional contribution $\\phi$. Special care is taken for the case $T_m^{\\mathrm{off}}(T_{\\mathrm{end}}) = 0$, where $\\phi$ is defined as $0$. Otherwise, $\\phi = \\Delta T / T_m^{\\mathrm{off}}(T_{\\mathrm{end}})$.\n- Collect the computed pairs $(\\Delta T, \\phi)$ for all test cases.\n- Format the final results into a single comma-separated string as specified in the problem statement.\n\nThis procedure will be encapsulated in a Python script, adhering strictly to the specified execution environment and output format. The use of high-precision tolerances (e.g., `rtol=1e-8`, `atol=1e-8`) in the ODE solver ensures the numerical accuracy required for this scientific computation. The provided edge cases (Case 2 with $s=0$ and Case 3 with $F_{\\mathrm{end}}=0$) will serve as internal validation for the implementation, as they are expected to yield $\\Delta T=0$ and $\\phi=0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the two-box EBM for given test cases and calculates feedback metrics.\n    \"\"\"\n    # Planetary mean incoming shortwave radiation (W m^-2)\n    S0 = 340.0\n\n    # Test suite parameter sets:\n    # (F_end, T_end, s, alpha_min, alpha_max, alpha_0, lambda, kappa, C_m, C_d)\n    test_cases = [\n        # Case 1 (general, moderate feedback)\n        (4.0, 100.0, 0.0010, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00),\n        # Case 2 (boundary, no feedback)\n        (4.0, 100.0, 0.0000, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00),\n        # Case 3 (edge, zero forcing)\n        (0.0, 100.0, 0.0010, 0.20, 0.70, 0.30, 1.20, 0.70, 7.00, 100.00),\n        # Case 4 (stronger ramp, stronger but stable feedback)\n        (8.0, 200.0, 0.0020, 0.20, 0.70, 0.30, 1.00, 0.80, 7.00, 100.00),\n    ]\n\n    def ebm_derivatives(t, y, params, feedback_on):\n        \"\"\"\n        Computes the time derivatives for the two-box EBM.\n        y: state vector [T_m, T_d]\n        t: time\n        params: tuple of model parameters\n        feedback_on: boolean to enable/disable ice-albedo feedback\n        \"\"\"\n        T_m, T_d = y\n        F_end, T_end, s, alpha_min, alpha_max, alpha_0, lam, kap, C_m, C_d = params\n\n        # External radiative forcing (linear ramp)\n        F_t = F_end * t / T_end\n\n        # Ice-albedo feedback forcing\n        if feedback_on:\n            # albedo is a function of T_m, clipped by min/max values\n            alpha_Tm = np.clip(alpha_0 - s * T_m, alpha_min, alpha_max)\n            F_alpha = S0 * (alpha_0 - alpha_Tm)\n        else:\n            F_alpha = 0.0\n\n        # System of ODEs from energy conservation\n        dTm_dt = (F_t + F_alpha - lam * T_m - kap * (T_m - T_d)) / C_m\n        dTd_dt = (kap * (T_m - T_d)) / C_d\n\n        return [dTm_dt, dTd_dt]\n\n    def run_simulation(params, feedback_on):\n        \"\"\"\n        Runs a single simulation for a given parameter set.\n        \"\"\"\n        _, T_end, _, _, _, _, _, _, _, _ = params\n        y0 = [0.0, 0.0]  # Initial conditions: T_m(0)=0, T_d(0)=0\n        t_span = [0, T_end]\n\n        sol = solve_ivp(\n            ebm_derivatives,\n            t_span,\n            y0,\n            args=(params, feedback_on),\n            method='RK45',\n            rtol=1e-8,\n            atol=1e-8\n        )\n        \n        # Return the final mixed-layer temperature\n        return sol.y[0, -1]\n\n    results = []\n    for params in test_cases:\n        # Run simulation with feedback OFF\n        T_m_off = run_simulation(params, feedback_on=False)\n        \n        # Run simulation with feedback ON\n        T_m_on = run_simulation(params, feedback_on=True)\n        \n        # Calculate attributable warming\n        delta_T = T_m_on - T_m_off\n\n        # Calculate fraction of warming attributable to feedback\n        if T_m_off > 1e-12:  # Use a small threshold to avoid division by zero\n            phi = delta_T / T_m_off\n        else:\n            phi = 0.0\n            \n        results.extend([delta_T, phi])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}