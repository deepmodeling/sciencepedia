{
    "hands_on_practices": [
        {
            "introduction": "许多物理过程，如辐射和湍流，本质上是非线性的。这意味着将物理定律应用于网格平均状态变量，与先计算每个次网格点的通量再进行平均，会得到不同的结果。本练习使用 Stefan-Boltzmann 定律作为具体例子，从数学上阐明为何在非线性公式中直接使用网格平均变量会导致系统性偏差（即聚合误差），这正是开发次网格参数化方案的核心动机之一。",
            "id": "3905583",
            "problem": "考虑一个大气环流模型（GCM）中的单个水平网格单元，其中未解析的次网格地表温度变率由一组以 $i$ 为索引的类别表示，每个类别占据网格单元面积的比例为 $w_i$，且满足 $\\sum_i w_i = 1$。每个类别的地表长波辐射通量遵循 Stefan–Boltzmann 定律，$F_i = \\epsilon \\sigma_{\\mathrm{SB}} T_i^{4}$，其中 $\\epsilon$ 是发射率（无量纲），$\\sigma_{\\mathrm{SB}}$ 是 Stefan–Boltzmann 常数，$T_i$ 是以开尔文为单位的绝对温度。从加权平均的定义和 Stefan–Boltzmann 定律出发，推导网格单元的聚合通量，并将其与使用网格平均温度计算的通量进行比较。仅使用加权平均、期望的定义以及函数 $x^{4}$ 的凸性，展示非线性聚合效应是如何产生的，并解释为什么 Jensen 不等式在此情境下适用。\n\n然后，假设次网格温度场 $T$ 可以被视为一个连续随机变量，近似服从均值为 $\\mu_T$、方差为 $\\sigma_T^{2}$ 的高斯分布，并且由于 $\\mu_T \\gg \\sigma_T$，出现非物理负值的概率可以忽略不计。使用正态分布的性质和 Stefan–Boltzmann 定律，为由 $B = F_{\\mathrm{true}} - F_{\\mathrm{mean}}$ 定义的系统性聚合偏差 $B$ 推导一个精确的闭式表达式，其中 $F_{\\mathrm{true}}$ 是真实的次网格加权通量，$F_{\\mathrm{mean}}$ 是根据网格平均温度计算的通量。将 $B$ 的最终答案以瓦特每平方米为单位表示。不代入任何数值；所有常数和参数均保留符号形式。最终答案必须是单个解析表达式。",
            "solution": "目标是从基本定义和定律出发，推导真实的聚合通量，将其与在平均状态下计算的通量进行比较，然后为一个特定的非线性通量定律量化因忽略次网格变率而引入的偏差。\n\nStefan–Boltzmann 定律指出，绝对温度为 $T$ 的表面的长波辐射通量为 $F = \\epsilon \\sigma_{\\mathrm{SB}} T^{4}$，其中 $\\epsilon$ 是发射率，$\\sigma_{\\mathrm{SB}}$ 是 Stefan–Boltzmann 常数。一个具有以 $i$ 为索引的次网格类别的网格单元，其温度为 $T_i$，面积分数为 $w_i$，且满足 $\\sum_i w_i = 1$。\n\n根据加权平均的定义，真实的、面积加权的网格单元通量（记为 $F_{\\mathrm{true}}$）为\n$$\nF_{\\mathrm{true}} = \\sum_i w_i F_i = \\sum_i w_i \\left( \\epsilon \\sigma_{\\mathrm{SB}} T_i^{4} \\right) = \\epsilon \\sigma_{\\mathrm{SB}} \\sum_i w_i T_i^{4}.\n$$\n将网格平均温度定义为\n$$\nT_{\\mathrm{mean}} = \\sum_i w_i T_i.\n$$\n一个平均态参数化方案计算通量时，视作整个网格单元都处于平均温度，从而得到\n$$\nF_{\\mathrm{mean}} = \\epsilon \\sigma_{\\mathrm{SB}} \\left( T_{\\mathrm{mean}} \\right)^{4} = \\epsilon \\sigma_{\\mathrm{SB}} \\left( \\sum_i w_i T_i \\right)^{4}.\n$$\n\n为了比较 $F_{\\mathrm{true}}$ 和 $F_{\\mathrm{mean}}$，我们借助于凸性和 Jensen 不等式。函数 $x^{4}$ 在正实数轴上是凸函数，因为它的二阶导数 $12 x^{2}$ 对所有 $x$ 都是非负的。对于一个凸函数 $f$，Jensen 不等式表述为 $f\\left( \\sum_i w_i x_i \\right) \\leq \\sum_i w_i f(x_i)$。将此不等式应用于 $f(x) = x^{4}$ 和 $x_i = T_i$ 可得\n$$\n\\left( \\sum_i w_i T_i \\right)^{4} \\leq \\sum_i w_i T_i^{4}.\n$$\n两边同乘以 $\\epsilon \\sigma_{\\mathrm{SB}}$ 可得\n$$\nF_{\\mathrm{mean}} \\leq F_{\\mathrm{true}}.\n$$\n因此，由于使用平均态参数化方案而产生的系统性偏差为\n$$\nB = F_{\\mathrm{true}} - F_{\\mathrm{mean}} = \\epsilon \\sigma_{\\mathrm{SB}} \\left( \\sum_i w_i T_i^{4} - \\left( \\sum_i w_i T_i \\right)^{4} \\right) \\geq 0,\n$$\n其非负性由 Jensen 不等式保证。这是非线性聚合效应的离散的、基于类别的表述。\n\n为了在次网格变率的统计描述下获得 $B$ 的精确闭式表达式，我们将 $T$ 建模为一个具有概率分布的连续随机变量，并将面积权重视为概率。那么真实的通量是\n$$\nF_{\\mathrm{true}} = \\epsilon \\sigma_{\\mathrm{SB}} \\mathbb{E}\\!\\left[ T^{4} \\right],\n$$\n而平均态通量是\n$$\nF_{\\mathrm{mean}} = \\epsilon \\sigma_{\\mathrm{SB}} \\left( \\mathbb{E}\\!\\left[ T \\right] \\right)^{4}.\n$$\n偏差变为\n$$\nB = \\epsilon \\sigma_{\\mathrm{SB}} \\left( \\mathbb{E}\\!\\left[ T^{4} \\right] - \\left( \\mathbb{E}\\!\\left[ T \\right] \\right)^{4} \\right).\n$$\n\n假设 $T$ 近似服从高斯分布，$T \\sim \\mathcal{N}\\!\\left( \\mu_T, \\sigma_T^{2} \\right)$，且 $\\mu_T \\gg \\sigma_T$，因此负值出现的概率可以忽略不计。使用正态分布的标准性质，记 $T = \\mu_T + Y$，其中 $Y \\sim \\mathcal{N}\\!\\left( 0, \\sigma_T^{2} \\right)$。展开 $T^{4}$：\n$$\nT^{4} = \\left( \\mu_T + Y \\right)^{4} = \\mu_T^{4} + 4 \\mu_T^{3} Y + 6 \\mu_T^{2} Y^{2} + 4 \\mu_T Y^{3} + Y^{4}.\n$$\n逐项取期望。对于一个零均值正态随机变量 $Y$，其各阶矩满足 $\\mathbb{E}\\!\\left[ Y \\right] = 0$，$\\mathbb{E}\\!\\left[ Y^{2} \\right] = \\sigma_T^{2}$，$\\mathbb{E}\\!\\left[ Y^{3} \\right] = 0$，以及 $\\mathbb{E}\\!\\left[ Y^{4} \\right] = 3 \\sigma_T^{4}$（正态分布的四阶中心矩是 $3 \\sigma_T^{4}$）。因此，\n$$\n\\mathbb{E}\\!\\left[ T^{4} \\right] = \\mu_T^{4} + 6 \\mu_T^{2} \\sigma_T^{2} + 3 \\sigma_T^{4}.\n$$\n由于 $\\mathbb{E}\\!\\left[ T \\right] = \\mu_T$，可得\n$$\nB = \\epsilon \\sigma_{\\mathrm{SB}} \\left( \\left[ \\mu_T^{4} + 6 \\mu_T^{2} \\sigma_T^{2} + 3 \\sigma_T^{4} \\right] - \\mu_T^{4} \\right) = \\epsilon \\sigma_{\\mathrm{SB}} \\left( 6 \\mu_T^{2} \\sigma_T^{2} + 3 \\sigma_T^{4} \\right).\n$$\n\n这个在高斯次网格变率假设下的精确表达式，量化了将 Stefan–Boltzmann 定律应用于平均态时产生的非线性聚合偏差，从而阐明了 Jensen 不等式对于参数化次网格尺度过程的意义。该偏差是非负的，并随 $\\mu_T^{2} \\sigma_T^{2}$ 和 $\\sigma_T^{4}$ 的增长而增长，这突显了方差和高阶矩在非线性通量聚合中的重要性。结果应以瓦特每平方米为单位表示，这与 $\\epsilon \\sigma_{\\mathrm{SB}} T^{4}$ 的单位是一致的。",
            "answer": "$$\\boxed{\\epsilon\\,\\sigma_{\\mathrm{SB}}\\left(6\\,\\mu_T^{2}\\,\\sigma_T^{2}+3\\,\\sigma_T^{4}\\right)}$$"
        },
        {
            "introduction": "从理论转向应用，我们来探讨一个次网格参数化的经典实例：大气边界层中的湍流。由于湍涡的尺度远小于典型气候模型的网格尺寸，我们无法直接解析它们，因此必须对其输送动量和热量的集体效应进行参数化。本练习将应用成熟的莫宁-奥布霍夫相似性理论 (Monin-Obukhov Similarity Theory)，利用经验性的稳定度函数来计算湍流涡动黏度和扩散系数，这是现代大气模型中的标准做法。",
            "id": "3905619",
            "problem": "考虑一个位于低矮植被上方的水平均匀、定常的近地面大气层，其中次网格尺度的湍流动量和热通量使用一阶闭合和Monin–Obukhov相似性理论（MOST）来表示。设高度为 $z=10~\\mathrm{m}$，Obukhov长度为 $L=-50~\\mathrm{m}$（不稳定层结），地表粗糙度长度为 $z_0=0.10~\\mathrm{m}$，零平面位移为 $d=0~\\mathrm{m}$。von Kármán常数为 $\\kappa=0.40$。在 $z=10~\\mathrm{m}$ 处测得的平均风速为 $U(z)=7.0~\\mathrm{m~s^{-1}}$。\n\n在MOST理论下，对于不稳定条件，使用以下广泛应用的经验稳定性函数，其中 $\\zeta=z/L$，角度以弧度为单位：\n- 梯度函数：$\\phi_m(\\zeta)=\\left(1-16\\zeta\\right)^{-1/4}$ 和 $\\phi_h(\\zeta)=\\left(1-16\\zeta\\right)^{-1/2}$。\n- 积分（廓线）修正函数：\n\n$$\n\\psi_m(\\zeta)=2\\ln\\!\\left(\\frac{1+x}{2}\\right)+\\ln\\!\\left(\\frac{1+x^2}{2}\\right)-2\\arctan(x)+\\frac{\\pi}{2},\\quad\n\\psi_h(\\zeta)=2\\ln\\!\\left(\\frac{1+x^2}{2}\\right),\n$$\n\n其中 $x=\\left(1-16\\zeta\\right)^{1/4}$。\n\n从基本的通量-梯度关系和常应力层假设出发，使用带有稳定性修正的对数廓线框架来推断摩擦速度 $u_*$，进而推导并计算在 $z=10~\\mathrm{m}$ 处的湍流涡黏性系数 $K_m$ 和热量湍流涡扩散系数 $K_h$。将 $K_m$ 和 $K_h$ 的最终数值答案以 $\\mathrm{m^2~s^{-1}}$ 为单位表示，并四舍五入到三位有效数字。你的最终答案必须是一个单行矩阵，按顺序包含 $K_m$ 和 $K_h$。",
            "solution": "该问题要求在不稳定条件下，计算大气近地面层特定高度的动量湍流涡黏性系数 $K_m$ 和热量湍流涡扩散系数 $K_h$。\n\n该问题的基础在于MOST框架内的通量-梯度关系。平均水平风速 $U$ 的垂直梯度与摩擦速度 $u_*$ 的关系为：\n$$\n\\frac{\\partial U}{\\partial z} = \\frac{u_*}{\\kappa (z-d)} \\phi_m(\\zeta)\n$$\n其中 $\\kappa$ 是von Kármán常数， $z$ 是离地高度， $d$ 是零平面位移， $\\phi_m(\\zeta)$ 是无量纲动量稳定性函数，而 $\\zeta = \\frac{z-d}{L}$ 是稳定性参数，其中 $L$ 是Obukhov长度。鉴于 $d=0$ m，该方程简化为：\n$$\n\\frac{\\partial U}{\\partial z} = \\frac{u_*}{\\kappa z} \\phi_m(\\zeta), \\quad \\text{with } \\zeta = \\frac{z}{L}\n$$\n将此表达式从粗糙度长度 $z_0$（假定该处风速为零）积分到高度 $z$，得到风廓线方程：\n$$\nU(z) = \\frac{u_*}{\\kappa} \\left[ \\ln\\left(\\frac{z}{z_0}\\right) - \\psi_m\\left(\\zeta\\right) + \\psi_m\\left(\\zeta_0\\right) \\right]\n$$\n其中 $\\psi_m(\\zeta)$ 是积分稳定性修正函数，$\\zeta_0 = z_0/L$。已知 $z_0 = 0.10~\\mathrm{m}$ 和 $L = -50~\\mathrm{m}$，则 $\\zeta_0 = -0.002$。由于 $|\\zeta_0| \\ll 1$，项 $\\psi_m(\\zeta_0)$ 近似为 $\\psi_m(0)$，根据所给的 $\\psi_m$ 定义，其值为零。因此，风廓线由下式给出：\n$$\nU(z) = \\frac{u_*}{\\kappa} \\left[ \\ln\\left(\\frac{z}{z_0}\\right) - \\psi_m(\\zeta) \\right]\n$$\n该方程可以重新整理以求解摩擦速度 $u_*$，因为所有其他量都是已知的。\n\n湍流涡系数由动量和热通量的一阶闭合（K-理论）关系定义：\n$$\nu_*^2 \\equiv -\\overline{u'w'} = K_m \\frac{\\partial U}{\\partial z} \\quad \\text{和} \\quad -\\overline{w'\\theta'} = K_h \\frac{\\partial \\Theta}{\\partial z}\n$$\n通过代入MOST的通量-梯度关系，我们可以推导出 $K_m$ 和 $K_h$ 的表达式：\n对于动量：\n$$\nK_m = \\frac{u_*^2}{\\partial U / \\partial z} = \\frac{u_*^2}{ (u_* / (\\kappa z)) \\phi_m(\\zeta) } = \\frac{\\kappa z u_*}{\\phi_m(\\zeta)}\n$$\n对于热量，类似地：\n$$\nK_h = \\frac{-\\overline{w'\\theta'}}{\\partial \\Theta / \\partial z} = \\frac{-\\overline{w'\\theta'}}{(\\theta_* / (\\kappa z)) \\phi_h(\\zeta)} = \\frac{u_* \\theta_*}{(\\theta_* / (\\kappa z)) \\phi_h(\\zeta)} = \\frac{\\kappa z u_*}{\\phi_h(\\zeta)}\n$$\n其中 $\\theta_* = -\\overline{w'\\theta'}/u_*$ 是特征温度尺度，$\\phi_h(\\zeta)$ 是无量纲热量稳定性函数。\n\n计算按以下步骤进行：\n\n1.  **计算 $z=10~\\mathrm{m}$ 处的稳定性参数 $\\zeta$**：\n    给定值为 $z = 10~\\mathrm{m}$ 和 $L = -50~\\mathrm{m}$。\n    $$\n    \\zeta = \\frac{z}{L} = \\frac{10}{-50} = -0.2\n    $$\n\n2.  **计算积分稳定性函数 $\\psi_m(\\zeta)$**：\n    首先，计算中间变量 $x$：\n    $$\n    x = (1-16\\zeta)^{1/4} = (1 - 16(-0.2))^{1/4} = (1 + 3.2)^{1/4} = (4.2)^{1/4} \\approx 1.43165\n    $$\n    现在，使用所给公式计算 $\\psi_m(\\zeta)$：\n    $$\n    \\psi_m(-0.2) = 2\\ln\\!\\left(\\frac{1+x}{2}\\right)+\\ln\\!\\left(\\frac{1+x^2}{2}\\right)-2\\arctan(x)+\\frac{\\pi}{2}\n    $$\n    代入 $x$ 的值：\n    $$\n    \\psi_m(-0.2) = 2\\ln\\!\\left(\\frac{1+1.43165}{2}\\right)+\\ln\\!\\left(\\frac{1+(1.43165)^2}{2}\\right)-2\\arctan(1.43165)+\\frac{\\pi}{2}\n    $$\n    $$\n    \\psi_m(-0.2) \\approx 2\\ln(1.21583) + \\ln(1.52482) - 2(0.96136) + 1.57080\n    $$\n    $$\n    \\psi_m(-0.2) \\approx 2(0.19543) + 0.42188 - 1.92272 + 1.57080 \\approx 0.46078\n    $$\n\n3.  **计算摩擦速度 $u_*$**：\n    我们重新整理风廓线方程以求解 $u_*$：\n    $$\n    u_* = \\frac{\\kappa U(z)}{\\ln\\left(\\frac{z}{z_0}\\right) - \\psi_m(\\zeta)}\n    $$\n    给定值为 $\\kappa = 0.40$，$U(10~\\mathrm{m})=7.0~\\mathrm{m~s^{-1}}$，$z=10~\\mathrm{m}$，$z_0=0.10~\\mathrm{m}$，以及 $\\psi_m(-0.2) \\approx 0.46078$。\n    $$\n    \\ln\\left(\\frac{z}{z_0}\\right) = \\ln\\left(\\frac{10}{0.10}\\right) = \\ln(100) \\approx 4.60517\n    $$\n    $$\n    u_* = \\frac{0.40 \\times 7.0}{4.60517 - 0.46078} = \\frac{2.8}{4.14439} \\approx 0.67558~\\mathrm{m~s^{-1}}\n    $$\n\n4.  **计算梯度稳定性函数 $\\phi_m(\\zeta)$ 和 $\\phi_h(\\zeta)$**：\n    使用所给公式及 $\\zeta = -0.2$：\n    $$\n    \\phi_m(\\zeta) = (1-16\\zeta)^{-1/4} = (1 - 16(-0.2))^{-1/4} = (4.2)^{-1/4} \\approx \\frac{1}{1.43165} \\approx 0.69849\n    $$\n    $$\n    \\phi_h(\\zeta) = (1-16\\zeta)^{-1/2} = (1 - 16(-0.2))^{-1/2} = (4.2)^{-1/2} \\approx \\frac{1}{\\sqrt{4.2}} \\approx 0.48795\n    $$\n    注意，对于这些特定的经验形式，有 $\\phi_h(\\zeta) = (\\phi_m(\\zeta))^2$。\n\n5.  **计算涡系数 $K_m$ 和 $K_h$**：\n    使用推导出的表达式和计算出的值：\n    $$\n    K_m = \\frac{\\kappa z u_*}{\\phi_m(\\zeta)} = \\frac{0.40 \\times 10 \\times 0.67558}{0.69849} \\approx \\frac{2.70232}{0.69849} \\approx 3.8688~\\mathrm{m^2~s^{-1}}\n    $$\n    $$\n    K_h = \\frac{\\kappa z u_*}{\\phi_h(\\zeta)} = \\frac{0.40 \\times 10 \\times 0.67558}{0.48795} \\approx \\frac{2.70232}{0.48795} \\approx 5.5381~\\mathrm{m^2~s^{-1}}\n    $$\n\n6.  **最终答案的形成**：\n    问题要求最终数值答案四舍五入到三位有效数字。\n    $$\n    K_m \\approx 3.87~\\mathrm{m^2~s^{-1}}\n    $$\n    $$\n    K_h \\approx 5.54~\\mathrm{m^2~s^{-1}}\n    $$\n    根据要求，这些结果以单行矩阵的形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 3.87  5.54 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "除了垂直方向的湍流过程，水平方向的次网格变异性同样至关重要，尤其是在陆面过程中。一个模型网格单元内可能包含多种地表类型，如农田、森林和水体，它们的物理特性和水文循环截然不同。本练习将通过一个土壤水分平衡模型的编码实践，带您实现一种“分块”（tiling）或“马赛克”（mosaic）参数化方案，即将一个网格单元划分为多个独立的子区域分别计算，从而更精确地模拟整个网格的平均能量和物质通量。",
            "id": "3905581",
            "problem": "考虑一个单一模型网格单元，该单元被划分为 $N$ 个子网格地块，各地块具有固定的面积分数 $\\{f_i\\}_{i=1}^N$，且满足 $\\sum_{i=1}^N f_i = 1$。每个地块 $i$ 包含一个单一的土壤桶，在离散的每日时间 $t = 0,1,\\dots,T$ 时，其储水量为 $S_i(t)$（单位：$\\mathrm{mm}$ 水）。每个地块的每日水量平衡遵循质量守恒定律：输入减去输出等于储水量的变化。物理上相关的过程包括降水 $P(t)$（单位：$\\mathrm{mm/day}$）、灌溉 $I_i(t)$（单位：$\\mathrm{mm/day}$）、蒸散（ET）$E_i(t)$（单位：$\\mathrm{mm/day}$）、重力排水 $D_i(t)$（单位：$\\mathrm{mm/day}$）和溢流（因超出容量而产生的地表径流）$R_i(t)$（单位：$\\mathrm{mm/day}$）。土壤桶具有三个特征含水量：凋萎点 $S_{\\mathrm{wp},i}$、田间持水量 $S_{\\mathrm{fc},i}$ 和最大储水量 $S_{\\max,i}$，均以 $\\mathrm{mm}$ 为单位，且满足 $0 \\le S_{\\mathrm{wp},i} \\le S_{\\mathrm{fc},i} \\le S_{\\max,i}$。设潜在蒸散（PET）为 $E_0(t)$（单位：$\\mathrm{mm/day}$），对所有地块通用，并设 $K_{c,i}$ 为地块 $i$ 的无量纲作物系数。ET 参数化由土壤水分胁迫因子 $\\alpha_i(S)$ 给出，其定义为\n$$\n\\alpha_i(S) = \n\\begin{cases}\n0,  S \\le S_{\\mathrm{wp},i}, \\\\\n\\dfrac{S - S_{\\mathrm{wp},i}}{S_{\\mathrm{fc},i} - S_{\\mathrm{wp},i}},  S_{\\mathrm{wp},i}  S  S_{\\mathrm{fc},i}, \\\\\n1,  S \\ge S_{\\mathrm{fc},i}.\n\\end{cases}\n$$\n因此，地块 ET 为\n$$\nE_i(t) = K_{c,i} \\, E_0(t) \\, \\alpha_i\\!\\big(S_i(t)\\big).\n$$\n重力排水参数化为\n$$\nD_i(t) = k_{d,i} \\, \\max\\!\\big( S_i'(t) - S_{\\mathrm{fc},i}, \\, 0 \\big),\n$$\n其中 $k_{d,i}$（单位：$\\mathrm{day}^{-1}$）是排水系数，$S_i'(t)$ 是计入输入和 ET 之后、但在排水和溢流之前的中间储水量。溢流 $R_i(t)$ 会移除任何超过 $S_{\\max,i}$ 的储水量，以确保在一天结束时 $S_i(t) \\le S_{\\max,i}$。对于每个地块 $i$ 和每一天 $t$，每日更新按以下顺序进行：\n1. 根据 $S_i(t)$ 计算 $E_i(t)$。\n2. 计算中间储水量 $S_i'(t) = S_i(t) + P(t) + I_i(t) - E_i(t)$。\n3. 计算 $D_i(t) = k_{d,i} \\max\\!\\big(S_i'(t) - S_{\\mathrm{fc},i},0\\big)$ 并设置 $S_i''(t) = S_i'(t) - D_i(t)$。\n4. 通过设置以下公式来强制执行容量和非负性约束\n$$\nS_i(t+1) = \\min\\!\\big(S_{\\max,i}, \\, \\max\\!\\big(S_i''(t), \\, 0\\big)\\big),\n$$\n其中溢流 $R_i(t) = \\max\\!\\big(S_i''(t) - S_{\\max,i}, \\, 0\\big)$ 被隐式移除。\n\n将第 $t$ 天的面积加权网格平均 ET 定义为\n$$\n\\overline{E}(t) = \\sum_{i=1}^N f_i \\, E_i(t),\n$$\n并将第 $T$ 天的最终网格平均土壤湿度定义为\n$$\n\\overline{S}(T) = \\sum_{i=1}^N f_i \\, S_i(T).\n$$\n\n您的任务是在指定的计划下，将灌溉作为地块特定的子网格补水 $I_i(t)$ 纳入模型，并为下面的每个测试用例计算 $T$ 天周期内的总网格平均 ET，\n$$\nE_{\\mathrm{tot}} = \\sum_{t=0}^{T-1} \\overline{E}(t),\n$$\n以及最终的网格平均土壤湿度 $\\overline{S}(T)$。所有输入和输出必须以 $\\mathrm{mm}$ 表示；时间以天为单位。不涉及角度。对于每个测试用例，返回两个浮点数：$E_{\\mathrm{tot}}$（单位：$\\mathrm{mm}$）和 $\\overline{S}(T)$（单位：$\\mathrm{mm}$），每个都四舍五入到三位小数。您的程序应生成单行输出，其中包含所有测试用例的结果，这些结果以一个扁平化的、用逗号分隔的列表形式放在方括号中，并严格按照测试用例的顺序排列。例如，如果有 $M$ 个测试用例，输出应为一个包含 $2M$ 个条目的单一列表：$[E_{\\mathrm{tot}}^{(1)},\\overline{S}^{(1)}(T),E_{\\mathrm{tot}}^{(2)},\\overline{S}^{(2)}(T),\\dots]$。\n\n使用以下包含五个测试用例的套件，每个用例都包含 $N=2$ 个地块和 $T=5$ 天。整个过程中，共享的顺序是先地块1，后地块2。\n\n测试用例 1（理想情况，对地块 1 进行灌溉）：\n- 面积分数：$f_1 = 0.4$, $f_2 = 0.6$。\n- 土壤参数：$S_{\\max,1} = 200$, $S_{\\mathrm{fc},1} = 120$, $S_{\\mathrm{wp},1} = 40$；$S_{\\max,2} = 150$, $S_{\\mathrm{fc},2} = 100$, $S_{\\mathrm{wp},2} = 30$。\n- 排水系数：$k_{d,1} = 0.10$, $k_{d,2} = 0.08$（单位：$\\mathrm{day}^{-1}$）。\n- 作物系数：$K_{c,1} = 1.05$, $K_{c,2} = 0.70$。\n- 初始土壤湿度：$S_1(0) = 100$, $S_2(0) = 90$（单位：$\\mathrm{mm}$）。\n- 潜在 ET：$E_0(t) = [4, 5, 4, 3, 4]$（单位：$\\mathrm{mm/day}$）。\n- 降水：$P(t) = [0, 0, 2, 0, 0]$（单位：$\\mathrm{mm/day}$）。\n- 灌溉计划：$I_1(t) = [0, 20, 0, 20, 0]$, $I_2(t) = [0, 0, 0, 0, 0]$（单位：$\\mathrm{mm/day}$）。\n\n测试用例 2（无灌溉基准）：\n- 参数与测试用例 1 相同，除了灌溉计划：$I_1(t) = [0, 0, 0, 0, 0]$, $I_2(t) = [0, 0, 0, 0, 0]$。\n\n测试用例 3（强力灌溉导致超出容量和排水）：\n- 面积分数：$f_1 = 0.4$, $f_2 = 0.6$。\n- 土壤参数：与测试用例 1 相同。\n- 排水系数：$k_{d,1} = 0.10$, $k_{d,2} = 0.08$（单位：$\\mathrm{day}^{-1}$）。\n- 作物系数：$K_{c,1} = 1.05$, $K_{c,2} = 0.70$。\n- 初始土壤湿度：$S_1(0) = 100$, $S_2(0) = 90$（单位：$\\mathrm{mm}$）。\n- 潜在 ET：$E_0(t) = [5, 5, 5, 5, 5]$（单位：$\\mathrm{mm/day}$）。\n- 降水：$P(t) = [0, 0, 0, 0, 0]$（单位：$\\mathrm{mm/day}$）。\n- 灌溉计划：$I_1(t) = [60, 0, 0, 0, 0]$, $I_2(t) = [0, 30, 0, 0, 0]$（单位：$\\mathrm{mm/day}$）。\n\n测试用例 4（初始条件干燥，低于凋萎点，无灌溉）：\n- 面积分数：$f_1 = 0.4$, $f_2 = 0.6$。\n- 土壤参数：与测试用例 1 相同。\n- 排水系数：$k_{d,1} = 0.10$, $k_{d,2} = 0.08$（单位：$\\mathrm{day}^{-1}$）。\n- 作物系数：$K_{c,1} = 1.05$, $K_{c,2} = 0.70$。\n- 初始土壤湿度：$S_1(0) = 30$, $S_2(0) = 25$（单位：$\\mathrm{mm}$）。\n- 潜在 ET：$E_0(t) = [4, 4, 4, 4, 4]$（单位：$\\mathrm{mm/day}$）。\n- 降水：$P(t) = [0, 0, 0, 0, 0]$（单位：$\\mathrm{mm/day}$）。\n- 灌溉计划：$I_1(t) = [0, 0, 0, 0, 0]$, $I_2(t) = [0, 0, 0, 0, 0]$（单位：$\\mathrm{mm/day}$）。\n\n测试用例 5（小灌溉面积比例，仅对地块 1 进行灌溉）：\n- 面积分数：$f_1 = 0.1$, $f_2 = 0.9$。\n- 土壤参数：与测试用例 1 相同。\n- 排水系数：$k_{d,1} = 0.10$, $k_{d,2} = 0.08$（单位：$\\mathrm{day}^{-1}$）。\n- 作物系数：$K_{c,1} = 1.05$, $K_{c,2} = 0.70$。\n- 初始土壤湿度：$S_1(0) = 110$, $S_2(0) = 95$（单位：$\\mathrm{mm}$）。\n- 潜在 ET：$E_0(t) = [4, 5, 4, 3, 4]$（单位：$\\mathrm{mm/day}$）。\n- 降水：$P(t) = [0, 1, 0, 0, 0]$（单位：$\\mathrm{mm/day}$）。\n- 灌溉计划：$I_1(t) = [0, 25, 0, 0, 0]$, $I_2(t) = [0, 0, 0, 0, 0]$（单位：$\\mathrm{mm/day}$）。\n\n您的程序必须实现上述参数化，并生成单行输出，其中包含一个扁平化的、包含 10 个浮点数（每个测试用例两个）的列表，四舍五入到三位小数，并用方括号括起来，不得包含任何额外文本。",
            "solution": "## 解决方案\n\n任务是为 $N=2$ 个地块在 $T=5$ 天的周期内实现一个分块土壤湿度模型的时间步进模拟。该模型在每个每日时间步 $t$ 更新每个地块 $i$ 的土壤储水量 $S_i(t)$，基于一系列物理过程：蒸散、水分输入（降水和灌溉）、排水和溢流。目标是计算模拟期内的总网格平均蒸散 $E_{\\mathrm{tot}}$ 和最终的网格平均土壤湿度 $\\overline{S}(T)$。\n\n模拟通过从第 $t=0$ 天迭代到 $t=T-1$ 天来进行。在每一天 $t$，对于每个地块 $i=1, \\dots, N$：\n\n1.  **计算蒸散（$E_i(t)$）**：\n    首先，根据当前土壤湿度 $S_i(t)$ 相对于地块的凋萎点 $S_{\\mathrm{wp},i}$ 和田间持水量 $S_{\\mathrm{fc},i}$ 的情况，确定土壤水分胁迫因子 $\\alpha_i$。\n    $$\n    \\alpha_i(S_i(t)) = \n    \\begin{cases}\n    0,  S_i(t) \\le S_{\\mathrm{wp},i} \\\\\n    \\frac{S_i(t) - S_{\\mathrm{wp},i}}{S_{\\mathrm{fc},i} - S_{\\mathrm{wp},i}},  S_{\\mathrm{wp},i}  S_i(t)  S_{\\mathrm{fc},i} \\\\\n    1,  S_i(t) \\ge S_{\\mathrm{fc},i}\n    \\end{cases}\n    $$\n    然后，通过用作物系数 $K_{c,i}$ 和胁迫因子 $\\alpha_i$ 调节潜在蒸散 $E_0(t)$ 来计算实际蒸散 $E_i(t)$。\n    $$\n    E_i(t) = K_{c,i} \\, E_0(t) \\, \\alpha_i(S_i(t))\n    $$\n\n2.  **计算中间储水量（$S_i'(t)$）**：\n    通过应用当天的水量平衡，考虑输入和上一步计算的 ET，来计算中间储水值 $S_i'(t)$。\n    $$\n    S_i'(t) = S_i(t) + P(t) + I_i(t) - E_i(t)\n    $$\n\n3.  **计算排水（$D_i(t)$）并更新储水量**：\n    只有当中间储水量 $S_i'(t)$ 超过田间持水量 $S_{\\mathrm{fc},i}$ 时，才会发生重力排水 $D_i(t)$。排水量与这部分多余水量成正比，由排水系数 $k_{d,i}$ 控制。\n    $$\n    D_i(t) = k_{d,i} \\, \\max(0, S_i'(t) - S_{\\mathrm{fc},i})\n    $$\n    然后从中间储水量中减去这部分排水，得到第二个中间值 $S_i''(t)$。\n    $$\n    S_i''(t) = S_i'(t) - D_i(t)\n    $$\n\n4.  **强制执行物理限制并确定最终储水量（$S_i(t+1)$）**：\n    最后一步是确保第二天的土壤湿度 $S_i(t+1)$ 遵守土壤桶的物理边界。储水量不能为负，也不能超过最大容量 $S_{\\max,i}$。\n    $$\n    S_i(t+1) = \\min(S_{\\max,i}, \\max(0, S_i''(t)))\n    $$\n    $S_i''(t)$ 中任何超过 $S_{\\max,i}$ 的水量都被视为溢流径流，并通过 $\\min$ 函数被隐式移除。\n\n5.  **聚合输出**：\n    在模拟的每一天 $t$ 中，通过对地块特定的 ET 值进行面积加权平均来计算网格平均蒸散 $\\overline{E}(t)$。\n    $$\n    \\overline{E}(t) = \\sum_{i=1}^N f_i \\, E_i(t)\n    $$\n    这个每日值在整个模拟期内累积，以求得总值 $E_{\\mathrm{tot}}$。\n    $$\n    E_{\\mathrm{tot}} = \\sum_{t=0}^{T-1} \\overline{E}(t)\n    $$\n    在最后一个时间步（$t=T-1$）之后，使用最终的土壤湿度值 $S_i(T)$ 来计算最终的网格平均土壤湿度 $\\overline{S}(T)$。\n    $$\n    \\overline{S}(T) = \\sum_{i=1}^N f_i \\, S_i(T)\n    $$\n\n对所提供的五个测试用例中的每一个都实施了这整个程序。参数 $\\{f_i, S_{\\max,i}, S_{\\mathrm{fc},i}, S_{\\mathrm{wp},i}, k_{d,i}, K_{c,i}\\}$ 和初始条件 $S_i(0)$，以及 $E_0(t)$、$P(t)$ 和 $I_i(t)$ 的时间序列，被用作每个案例模拟的输入。每个案例的最终计算值 $E_{\\mathrm{tot}}$ 和 $\\overline{S}(T)$ 都四舍五入到三位小数。",
            "answer": "[15.111,100.932,13.910,80.893,21.300,104.991,0.000,27.200,16.591,78.432]"
        }
    ]
}