{
    "hands_on_practices": [
        {
            "introduction": "线性化是稳定性分析的基石，它使我们能够通过研究系统在平衡点附近的局部行为来理解其稳定性。本练习  以无处不在的逻辑斯谛增长模型为背景，旨在通过实践泰勒展开的基本技术，来推导非平凡平衡点的线性化系统并评估其局部稳定性。掌握这项技能是分析任何环境动态模型的关键第一步。",
            "id": "3919783",
            "problem": "考虑一个用于描述生物量浓度 $x(t)$ 的充分混合单室环境箱式模型（例如，均匀混合层中的浮游植物生物量），该模型由常微分方程（ODE）控制\n$$\n\\frac{dx}{dt} = a x - b x^{2},\n$$\n其中 $a0$ 是内禀人均增长率，$b0$ 是由资源限制和自遮蔽引起的拥挤或自我限制系数。假设 $a$ 和 $b$ 不随时间变化，并且该室在空间上是均匀的。\n\n仅使用平衡和一阶泰勒展开的基本定义，推导关于非平凡平衡点 $x^{\\ast}$ 的线性化扰动方程，并计算该线性化系统在 $x^{\\ast}$ 处的单个特征值以评估局部稳定性。\n\n您必须：\n- 通过求解 $f(x)=a x - b x^{2}$ 的 $f(x^{\\ast})=0$ 来确定非平凡平衡点 $x^{\\ast}$。\n- 引入由 $x(t)=x^{\\ast}+\\eta(t)$ 定义的扰动 $\\eta(t)$，并从 $f(x)$ 在 $x^{\\ast}$ 附近的一阶泰勒展开式推导出关于 $\\eta(t)$ 的一阶线性化方程，仅保留 $\\eta$ 的一阶项。\n- 以 $a$ 和 $b$ 的符号表达式形式，显式计算所得线性化系统的特征值。\n\n以 $\\mathrm{s}^{-1}$ 为单位表示特征值。最终答案必须是单一的封闭形式符号表达式。不需要进行数值四舍五入。",
            "solution": "问题提供了一个描述生物量浓度 $x(t)$ 演化的微分方程，即逻辑斯谛增长模型：\n$$\n\\frac{dx}{dt} = f(x) = a x - b x^{2}\n$$\n其中参数 $a0$ 和 $b0$ 分别代表内禀增长率和自我限制系数。任务是分析该系统非平凡平衡点的局部稳定性。\n\n首先，我们通过将生物量浓度的变化率设为零来确定平衡点。平衡点，记作 $x_{eq}$，是系统不随时间变化的 $x$ 值。在数学上，这对应于求解 $\\frac{dx}{dt} = 0$。\n$$\nf(x_{eq}) = a x_{eq} - b x_{eq}^{2} = 0\n$$\n对表达式进行因式分解得到：\n$$\nx_{eq} (a - b x_{eq}) = 0\n$$\n此方程产生两个平衡点的解：\n1. 平凡平衡点：$x_{eq,1} = 0$。这对应于生物量的灭绝。\n2. 非平凡平衡点：$a - b x_{eq,2} = 0$，解得 $x_{eq,2} = \\frac{a}{b}$。\n\n题目要求分析非平凡平衡点，我们将其记为 $x^{\\ast}$。\n$$\nx^{\\ast} = \\frac{a}{b}\n$$\n由于 $a0$ 和 $b0$，这个平衡浓度 $x^{\\ast}$ 是正的，这在物理和生物学上是有意义的。\n\n接下来，我们研究该平衡点 $x^{\\ast}$ 的局部稳定性。这通过分析平衡点周围小扰动的行为来完成。设系统在时间 $t$ 的状态表示为平衡状态与一个小扰动 $\\eta(t)$ 的和：\n$$\nx(t) = x^{\\ast} + \\eta(t)\n$$\n我们假设 $|\\eta(t)|$ 很小。我们将此表达式代入原微分方程：\n$$\n\\frac{d}{dt}(x^{\\ast} + \\eta(t)) = f(x^{\\ast} + \\eta(t))\n$$\n由于 $x^{\\ast}$ 是一个常数，其时间导数为零，因此左侧简化为：\n$$\n\\frac{d\\eta}{dt}\n$$\n对于右侧，我们在点 $x = x^{\\ast}$ 附近对函数 $f(x)$ 进行一阶泰勒级数展开：\n$$\nf(x) \\approx f(x^{\\ast}) + f'(x^{\\ast})(x - x^{\\ast})\n$$\n代入 $x = x^{\\ast} + \\eta(t)$，我们得到：\n$$\nf(x^{\\ast} + \\eta(t)) \\approx f(x^{\\ast}) + f'(x^{\\ast})((x^{\\ast} + \\eta(t)) - x^{\\ast}) = f(x^{\\ast}) + f'(x^{\\ast})\\eta(t)\n$$\n根据平衡点的定义，$f(x^{\\ast}) = 0$。因此，仅保留 $\\eta(t)$ 的一阶项，右侧变为：\n$$\nf(x^{\\ast} + \\eta(t)) \\approx f'(x^{\\ast})\\eta(t)\n$$\n令左侧和右侧相等，得到线性化扰动方程：\n$$\n\\frac{d\\eta}{dt} = f'(x^{\\ast})\\eta(t)\n$$\n为了找到该方程的显式形式，我们必须计算 $f(x)$ 的导数并在 $x^{\\ast}$ 处求值。函数为 $f(x) = ax - bx^2$。其关于 $x$ 的一阶导数是：\n$$\nf'(x) = \\frac{df}{dx} = \\frac{d}{dx}(ax - bx^2) = a - 2bx\n$$\n现在，我们在非平凡平衡点 $x^{\\ast} = \\frac{a}{b}$ 处计算该导数的值：\n$$\nf'(x^{\\ast}) = f'\\left(\\frac{a}{b}\\right) = a - 2b\\left(\\frac{a}{b}\\right) = a - 2a = -a\n$$\n系数 $f'(x^{\\ast})$ 是这个一维线性化系统的单个特征值。特征值，记作 $\\lambda$，决定了平衡点的局部稳定性。对于形式为 $\\frac{d\\eta}{dt} = \\lambda \\eta$ 的一维系统，系数 $\\lambda$ 就是特征值。\n因此，线性化方程为：\n$$\n\\frac{d\\eta}{dt} = -a \\eta(t)\n$$\n线性化系统在平衡点 $x^{\\ast}$ 的特征值是 $\\eta(t)$ 的系数：\n$$\n\\lambda = -a\n$$\n参数 $a$ 的单位是速率，或 时间$^{-1}$。如果时间单位是秒，则单位是 $\\mathrm{s}^{-1}$。由于给定 $a  0$，特征值 $\\lambda = -a$ 是严格为负的。负特征值表示小扰动 $\\eta(t)$ 将随时间指数衰减，这意味着系统将返回到平衡状态 $x^{\\ast}$。因此，非平凡平衡点是局部渐近稳定的。",
            "answer": "$$\\boxed{-a}$$"
        },
        {
            "introduction": "在单变量系统的基础上，我们进一步探索多维系统，其中组件间的相互作用可以产生更复杂的动态行为。此练习  采用经典的捕食者-被捕食者模型，引入了作为导数概念在多维空间延伸的雅可比矩阵。您将通过分析雅可比矩阵的特征值，揭示系统组分（捕食者与被捕食者）之间的相互作用是如何导致振荡等复杂动态的。",
            "id": "3919758",
            "problem": "考虑一个在环境和地球系统建模中使用的典型捕食者-猎物相互作用，例如，用来表示浮游植物和浮游动物的动力学。该模型是一个自治常微分方程组（ODEs）：\n$$\n\\frac{dx}{dt} = x(\\alpha - \\beta y), \\qquad \\frac{dy}{dt} = y(\\delta x - \\gamma),\n$$\n其中 $x$ 和 $y$ 分别是猎物和捕食者的密度，参数 $\\alpha$、$\\beta$、$\\delta$ 和 $\\gamma$ 是具有生态学解释的正常数（猎物内在增长率 $\\alpha$、捕食率系数 $\\beta$、转化效率 $\\delta$ 和捕食者死亡率 $\\gamma$）。\n\n从动力学系统中的线性化基本原理出发，该原理指出非线性自治系统平衡点附近的局部行为可以通过在该平衡点处计算的其雅可比矩阵的特征值来表征，请执行以下操作：\n\n1. 确定具有严格为正坐标的共存平衡点 $(x^{\\ast}, y^{\\ast})$。\n2. 构建系统的雅可比矩阵 $J(x,y)$，并在 $(x^{\\ast}, y^{\\ast})$ 处对其进行求值。\n3. 利用在 $(x^{\\ast}, y^{\\ast})$ 处的雅可比矩阵的迹和行列式，通过确定特征值为复数的条件，推导出线性化动力学是振荡的条件。\n4. 在该条件下，确定由线性化预测的小振幅振荡的角频率 $\\omega$（单位为弧度/单位时间），并纯粹用参数 $\\alpha$、$\\beta$、$\\delta$ 和 $\\gamma$ 表示。\n\n请以 $\\omega$ 的单个闭式解析表达式的形式提供最终答案。无需进行数值计算或四舍五入，最终方框内的表达式中不應包含任何单位。",
            "solution": "该问题要求分析一个典型捕食者-猎物模型的共存平衡点的局部稳定性。分析将通过在该平衡点处对常微分方程组（ODEs）进行线性化来进行。\n\n该模型由以下自治常微分方程组给出：\n$$\n\\frac{dx}{dt} = x(\\alpha - \\beta y)\n$$\n$$\n\\frac{dy}{dt} = y(\\delta x - \\gamma)\n$$\n这里，$x(t)$ 和 $y(t)$ 分别表示在时间 $t$ 时的猎物和捕食者种群密度。参数 $\\alpha$、$\\beta$、$\\delta$ 和 $\\gamma$ 均为正常实数。\n\n**步骤 1：确定共存平衡点**\n\n系统的平衡点 $(x^{\\ast}, y^{\\ast})$ 是一个种群密度不随时间变化的状态。在数学上，这对应于时间导数为零的条件：\n$$\n\\frac{dx}{dt} = 0 \\quad \\text{和} \\quad \\frac{dy}{dt} = 0\n$$\n代入给定的方程，我们得到以下代数方程组：\n$$\nx^{\\ast}(\\alpha - \\beta y^{\\ast}) = 0\n$$\n$$\ny^{\\ast}(\\delta x^{\\ast} - \\gamma) = 0\n$$\n问题要求的是共存平衡点，其定义为两个种群都存在的平衡点 $(x^{\\ast}, y^{\\ast})$，即 $x^{\\ast}  0$ 和 $y^{\\ast}  0$。为了在这些条件下使上述方程成立，括号中的项必须等于零：\n$$\n\\alpha - \\beta y^{\\ast} = 0 \\implies y^{\\ast} = \\frac{\\alpha}{\\beta}\n$$\n$$\n\\delta x^{\\ast} - \\gamma = 0 \\implies x^{\\ast} = \\frac{\\gamma}{\\delta}\n$$\n由于所有参数 $\\alpha, \\beta, \\delta, \\gamma$ 均为正数，所以 $x^{\\ast}$ 和 $y^{\\ast}$ 都严格为正。因此，共存平衡点是 $(x^{\\ast}, y^{\\ast}) = (\\frac{\\gamma}{\\delta}, \\frac{\\alpha}{\\beta})$。\n\n**步骤 2：构建和求值雅可比矩阵**\n\n为了分析非线性系统在平衡点附近的行为，我们采用线性化原理。与平衡点的小扰动的动力学由在该平衡点处求值的系统雅可比矩阵决定。设常微分方程的右侧项为 $f(x,y) = \\alpha x - \\beta xy$ 和 $g(x,y) = \\delta xy - \\gamma y$。雅可比矩阵 $J(x,y)$ 由下式给出：\n$$\nJ(x,y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x}  \\frac{\\partial f}{\\partial y} \\\\ \\frac{\\partial g}{\\partial x}  \\frac{\\partial g}{\\partial y} \\end{pmatrix}\n$$\n所需的偏导数是：\n$$\n\\frac{\\partial f}{\\partial x} = \\alpha - \\beta y\n$$\n$$\n\\frac{\\partial f}{\\partial y} = -\\beta x\n$$\n$$\n\\frac{\\partial g}{\\partial x} = \\delta y\n$$\n$$\n\\frac{\\partial g}{\\partial y} = \\delta x - \\gamma\n$$\n这给出了作为 $x$ 和 $y$ 函数的雅可比矩阵：\n$$\nJ(x,y) = \\begin{pmatrix} \\alpha - \\beta y  -\\beta x \\\\ \\delta y  \\delta x - \\gamma \\end{pmatrix}\n$$\n接下来，我们在共存平衡点 $(x^{\\ast}, y^{\\ast}) = (\\frac{\\gamma}{\\delta}, \\frac{\\alpha}{\\beta})$ 处对此矩阵进行求值。设此矩阵为 $J^{\\ast}$：\n$$\nJ^{\\ast} = J\\left(\\frac{\\gamma}{\\delta}, \\frac{\\alpha}{\\beta}\\right) = \\begin{pmatrix} \\alpha - \\beta\\left(\\frac{\\alpha}{\\beta}\\right)  -\\beta\\left(\\frac{\\gamma}{\\delta}\\right) \\\\ \\delta\\left(\\frac{\\alpha}{\\beta}\\right)  \\delta\\left(\\frac{\\gamma}{\\delta}\\right) - \\gamma \\end{pmatrix}\n$$\n简化矩阵的每个元素得到：\n$$\nJ^{\\ast} = \\begin{pmatrix} 0  -\\frac{\\beta\\gamma}{\\delta} \\\\ \\frac{\\alpha\\delta}{\\beta}  0 \\end{pmatrix}\n$$\n\n**步骤 3 和 4：确定振荡条件并找到角频率**\n\n平衡点附近的局部动力学由雅可比矩阵 $J^{\\ast}$ 的特征值 $\\lambda$ 决定。特征值是特征方程 $\\det(J^{\\ast} - \\lambda I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。对于一般的 $2 \\times 2$ 矩阵，该方程可以写成：\n$$\n\\lambda^2 - \\text{Tr}(J^{\\ast})\\lambda + \\text{Det}(J^{\\ast}) = 0\n$$\n我们来计算 $J^{\\ast}$ 的迹和行列式：\n迹是对角元素之和：\n$$\n\\text{Tr}(J^{\\ast}) = 0 + 0 = 0\n$$\n行列式由下式给出：\n$$\n\\text{Det}(J^{\\ast}) = (0)(0) - \\left(-\\frac{\\beta\\gamma}{\\delta}\\right)\\left(\\frac{\\alpha\\delta}{\\beta}\\right) = \\frac{\\alpha\\beta\\gamma\\delta}{\\beta\\delta} = \\alpha\\gamma\n$$\n将这些值代入特征方程：\n$$\n\\lambda^2 - (0)\\lambda + \\alpha\\gamma = 0 \\implies \\lambda^2 + \\alpha\\gamma = 0\n$$\n特征值是此方程的解：\n$$\n\\lambda^2 = -\\alpha\\gamma \\implies \\lambda = \\pm\\sqrt{-\\alpha\\gamma}\n$$\n当特征值为复数时，动力学是振荡的。特征值由二次方程求根公式给出：\n$$\n\\lambda = \\frac{\\text{Tr}(J^{\\ast}) \\pm \\sqrt{\\text{Tr}(J^{\\ast})^2 - 4\\text{Det}(J^{\\ast})}}{2}\n$$\n为了使特征值为复数，判别式必须为负：\n$$\n\\text{Tr}(J^{\\ast})^2 - 4\\text{Det}(J^{\\ast})  0\n$$\n代入我们的结果：\n$$\n(0)^2 - 4(\\alpha\\gamma)  0 \\implies -4\\alpha\\gamma  0\n$$\n由于问题陈述 $\\alpha  0$ 和 $\\gamma  0$，它们的乘积 $\\alpha\\gamma$ 严格为正。因此，条件 $-4\\alpha\\gamma  0$ 总是满足的。这意味着在给定的模型假设下，共存平衡点周围的线性化动力学总是振荡的。\n\n形如 $\\lambda = \\mu \\pm i\\omega$ 的特征值对对应于一种动力学，其稳定性由实部 $\\mu$ 决定，振荡角频率由虚部 $\\omega$ 给出。\n我们的特征值是：\n$$\n\\lambda = \\pm i\\sqrt{\\alpha\\gamma}\n$$\n与一般形式 $\\lambda = \\mu \\pm i\\omega$ 比较，我们可以确定 $\\mu=0$ 和 $\\omega=\\sqrt{\\alpha\\gamma}$。零实部表明，在线性化近似中，该平衡点是一个中心点，对应于中性稳定振荡。围绕平衡点的小振幅振荡的角频率是：\n$$\n\\omega = \\sqrt{\\alpha\\gamma}\n$$\n这个表达式仅取决于猎物的内在增长率 $\\alpha$ 和捕食者的死亡率 $\\gamma$。",
            "answer": "$$\n\\boxed{\\sqrt{\\alpha\\gamma}}\n$$"
        },
        {
            "introduction": "经典的特征值分析仅能描述系统的长期渐近行为，但这并不总是故事的全部。本高级练习  挑战我们去理解非正规动态（non-normal dynamics）的概念，即一个渐近稳定的系统仍可能在短期内对某些扰动表现出显著的瞬时增长。您需要通过推导并实现一个基于奇异值分解（SVD）的算法，来找出能引发最大瞬时增长的“最优”初始扰动，这是理解气候和流体系统可预测性极限的关键一步。",
            "id": "3919718",
            "problem": "考虑一个线性时不变系统，该系统是通过在平衡态附近对环境或地球系统模型进行线性化得到的。设状态向量为 $x(t) \\in \\mathbb{R}^n$，平衡点处的常数雅可比矩阵为 $J \\in \\mathbb{R}^{n \\times n}$。线性化动力学由常微分方程 $\\frac{dx}{dt} = J x$ 给出，其解为 $x(t) = e^{J t} x(0)$。在给定时间 $t$（以秒为单位），初始扰动 $x(0)$ 在欧几里得范数下的瞬时放大被定义为无量纲量 $A(x(0), t) = \\frac{\\|x(t)\\|_2}{\\|x(0)\\|_2} = \\frac{\\|e^{J t} x(0)\\|_2}{\\|x(0)\\|_2}$。仅从给定的线性动力学 $\\frac{dx}{dt} = J x$、矩阵指数 $e^{J t}$ 的定义以及欧几里得范数的核心性质出发，推导在所有非零 $x(0)$ 中使 $A(x(0), t)$ 最大化的最优初始扰动方向 $x^\\star(0)$ 的表征，以及在时间 $t$ 时的相关最大放大率。将您的推导转化为一种算法，该算法针对指定的 $J$ 和 $t$ 计算：(i) 最大放大因子和 (ii) 最优初始扰动方向与 $J$ 的主导特征向量（对应于具有最大实部的特征值的特征向量）之间的夹角（以弧度为单位），两者均表示为实值浮点数。\n\n您的程序必须实现此算法以解决以下测试套件，其中每个案例指定一个 $2 \\times 2$ 实矩阵 $J$ 和一个时间 $t$（以秒为单位）：\n\n- 测试用例 1（正规，稳定）：$J = \\begin{bmatrix} -0.5  0 \\\\ 0  -0.1 \\end{bmatrix}$，$t = 10.0$。\n- 测试用例 2（非正规，稳定但有瞬时增长）：$J = \\begin{bmatrix} -1.0  10.0 \\\\ 0.0  -1.0 \\end{bmatrix}$，$t = 0.5$。\n- 测试用例 3（边界情况）：$J = \\begin{bmatrix} -0.3  2.0 \\\\ 0.0  -0.3 \\end{bmatrix}$，$t = 0.0$。\n- 测试用例 4（正规，不稳定）：$J = \\begin{bmatrix} 0.1  0.0 \\\\ 0.0  0.1 \\end{bmatrix}$，$t = 20.0$。\n- 测试用例 5（非正规，稳定，长时间）：$J = \\begin{bmatrix} -0.01  0.5 \\\\ 0.0  -0.01 \\end{bmatrix}$，$t = 500.0$。\n\n对于每个测试用例，计算 $e^{J t}$，通过基于 $e^{J t}$ 的适当奇异值问题确定最优初始扰动方向，并确定该方向与 $J$ 的主导特征向量之间的夹角。角度必须以弧度表示。放大率是无量纲的。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素是对应于一个测试用例的双元素列表 $[ \\text{放大率}, \\text{角度} ]$（例如，$[[\\text{float},\\text{float}],[\\text{float},\\text{float}],\\dots]$）。",
            "solution": "该问题要求推导并实现一种算法，以找到线性动力学系统的最大瞬时放大率，以及最优初始扰动相对于系统主导特征向量的方向。\n\n系统动力学由线性常微分方程给出：\n$$\n\\frac{d x}{dt} = J x\n$$\n其中 $x(t) \\in \\mathbb{R}^n$ 是状态向量，$J \\in \\mathbb{R}^{n \\times n}$ 是常数雅可比矩阵。该方程的解为 $x(t) = e^{J t} x(0)$，其中 $x(0)$ 是时间 $t=0$ 时的初始状态，$e^{Jt}$ 是矩阵指数。\n\n在时间 $t$ 时，对于初始扰动 $x(0)$ 的瞬时放大被定义为欧几里得范数的比率：\n$$\nA(x(0), t) = \\frac{\\|x(t)\\|_2}{\\|x(0)\\|_2} = \\frac{\\|e^{J t} x(0)\\|_2}{\\|x(0)\\|_2}\n$$\n我们的首要目标是通过选择最优初始扰动方向，找到在固定时间 $t$ 时的最大可能放大率。这对应于求解以下针对所有非零初始条件 $x(0) \\in \\mathbb{R}^n$ 的最大化问题：\n$$\n\\max_{x(0) \\neq 0} A(x(0), t) = \\max_{x(0) \\neq 0} \\frac{\\|e^{J t} x(0)\\|_2}{\\|x(0)\\|_2}\n$$\n我们定义矩阵 $M = e^{Jt}$。待最大化的表达式是矩阵 $M$ 的诱导 2-范数（或谱范数）的定义。\n$$\n\\|M\\|_2 = \\max_{x \\neq 0} \\frac{\\|M x\\|_2}{\\|x\\|_2}\n$$\n任何矩阵的诱导 2-范数等于其最大奇异值。为了证明这一点，我们利用 $M$ 的奇异值分解 (SVD)。任何实矩阵 $M \\in \\mathbb{R}^{n \\times n}$ 都可以分解为 $M = U \\Sigma V^T$，其中 $U$ 和 $V$ 是正交矩阵 ($U^T U = I$, $V^T V = I$) ，$\\Sigma$ 是包含奇异值 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_n \\ge 0$ 的对角矩阵。\n\n让我们分析 $Mx$ 范数的平方：\n$$\n\\|M x\\|_2^2 = (Mx)^T (Mx) = x^T M^T M x\n$$\n代入 $M$ 的 SVD：\n$$\nM^T M = (U \\Sigma V^T)^T (U \\Sigma V^T) = V \\Sigma^T U^T U \\Sigma V^T = V \\Sigma^T \\Sigma V^T = V \\Sigma^2 V^T\n$$\n因为 $\\Sigma$ 是对角矩阵。所以，我们有：\n$$\n\\|M x\\|_2^2 = x^T V \\Sigma^2 V^T x\n$$\n放大率平方的最大化问题是：\n$$\n\\max_{x \\neq 0} \\frac{x^T V \\Sigma^2 V^T x}{x^T x}\n$$\n我们定义一个新向量 $y = V^T x$。由于 $V$ 是一个正交矩阵，它保持范数不变，即 $\\|y\\|_2 = \\|V^T x\\|_2 = \\|x\\|_2$。因此，$y^T y = x^T x$。将 $y$ 代入表达式中得到：\n$$\n\\max_{y \\neq 0} \\frac{(Vy)^T V \\Sigma^2 y}{y^T y} = \\max_{y \\neq 0} \\frac{y^T V^T V \\Sigma^2 y}{y^T y} = \\max_{y \\neq 0} \\frac{y^T \\Sigma^2 y}{y^T y}\n$$\n用 $y = [y_1, y_2, \\dots, y_n]^T$ 的分量和奇异值 $\\sigma_i$ 来表示这个式子：\n$$\n\\frac{y^T \\Sigma^2 y}{y^T y} = \\frac{\\sum_{i=1}^n \\sigma_i^2 y_i^2}{\\sum_{i=1}^n y_i^2}\n$$\n这个表达式是 $\\sigma_i^2$ 值的加权平均。当所有的“权重”都放在最大值 $\\sigma_1^2$ 上时（因为我们已排序 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots$），该表达式达到最大值。这发生在 $y_1 \\neq 0$ 且 $y_2 = y_3 = \\dots = y_n = 0$ 时。例如，我们可以选择 $y$ 为第一个标准基向量，即 $y = e_1 = [1, 0, \\dots, 0]^T$。\n\n通过这种选择，该比率的最大值为 $\\sigma_1^2$。最大放大率 $A_{max}$ 是该值的平方根：\n$$\nA_{max}(t) = \\sqrt{\\sigma_1^2} = \\sigma_1 = \\sigma_{max}(e^{Jt})\n$$\n最大放大因子是矩阵传播算子 $e^{Jt}$ 的最大奇异值。\n\n最优初始扰动 $x^\\star(0)$ 是对应于 $y = e_1$ 的向量 $x$。从代换 $y = V^T x$ 中，我们可以求出 $x$：\n$$\nx = V y\n$$\n对于最优情况，$y = e_1$，所以最优初始扰动是：\n$$\nx^\\star(0) = V e_1\n$$\n这个向量 $V e_1$ 就是矩阵 $V$ 的第一列。$V$ 的列是 $M = e^{Jt}$ 的右奇异向量。因此，最优初始扰动 $x^\\star(0)$ 是 $e^{Jt}$ 对应于最大奇异值 $\\sigma_1$ 的右奇异向量。\n\n问题的第二部分是计算这个最优扰动方向 $x^\\star(0)$ 与雅可比矩阵 $J$ 的主导特征向量之间的夹角。$J$ 的主导特征向量被定义为对应于具有最大实部的特征值 $\\lambda_{dom}$ 的特征向量 $v_{dom}$：\n$$\n\\text{Re}(\\lambda_{dom}) = \\max_{i} \\{\\text{Re}(\\lambda_i)\\}\n$$\n其中 $\\lambda_i$ 是 $J$ 的特征值。\n\n一旦我们有了这两个向量，$x^\\star(0)$（$e^{Jt}$ 的第一个右奇异向量）和 $v_{dom}$（$J$ 的主导特征向量），它们之间的夹角 $\\theta$（以弧度为单位）可以用点积公式计算：\n$$\n\\theta = \\arccos\\left( \\frac{|x^\\star(0) \\cdot v_{dom}|}{\\|x^\\star(0)\\|_2 \\|v_{dom}\\|_2} \\right)\n$$\n使用点积的绝对值是因为特征向量或奇异向量的方向只在符号上是确定的。我们寻求由这两个向量张成的直线之间的最小夹角，该夹角位于区间 $[0, \\pi/2]$ 内。\n\n要实现的算法如下：\n对于每个具有给定矩阵 $J$ 和时间 $t$ 的测试用例：\n1.  计算矩阵 $M = e^{Jt}$。\n2.  对 $M$ 执行奇异值分解，以获得其奇异值和右奇异向量。\n3.  最大放大率是最大的奇异值 $\\sigma_1$。\n4.  最优初始扰动方向 $x^\\star(0)$ 是对应于 $\\sigma_1$ 的右奇异向量。\n5.  计算矩阵 $J$ 的特征值和特征向量。\n6.  通过找到对应于具有最大实部的特征值的特征向量来识别主导特征向量 $v_{dom}$。对于退化情况（具有最大实部的重复特征值），可以选择相应特征空间中的任何向量；标准的数值库将提供一个这样的向量。\n7.  使用它们归一化后的绝对点积的反余弦值，计算 $x^\\star(0)$ 和 $v_{dom}$ 之间的夹角（以弧度为单位）。\n8.  存储数据对 $[\\text{放大率}, \\text{角度}]$。\n\n此过程将应用于每个提供的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the problem for a given set of test cases.\n    For each case (J, t), it calculates the maximum transient amplification\n    and the angle between the optimal initial perturbation and the dominant\n    eigenvector of J.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (np.array([[-0.5, 0.0], [0.0, -0.1]]), 10.0),  # Case 1\n        (np.array([[-1.0, 10.0], [0.0, -1.0]]), 0.5), # Case 2\n        (np.array([[-0.3, 2.0], [0.0, -0.3]]), 0.0),  # Case 3\n        (np.array([[0.1, 0.0], [0.0, 0.1]]), 20.0),   # Case 4\n        (np.array([[-0.01, 0.5], [0.0, -0.01]]), 500.0), # Case 5\n    ]\n\n    results = []\n    for J, t in test_cases:\n        # Step 1: Compute the matrix exponential M = exp(J*t)\n        # The matrix Jt is computed first.\n        Jt = J * t\n        M = expm(Jt)\n\n        # Step 2: Compute the SVD of M = U * S * Vh\n        # U, S, Vh = np.linalg.svd(M)\n        # S contains the singular values in descending order.\n        # Vh is the conjugate transpose of the matrix of right singular vectors.\n        # The rows of Vh are the right singular vectors.\n        try:\n            _, s, vh = np.linalg.svd(M)\n        except np.linalg.LinAlgError:\n            # Handle cases where SVD might fail, though unlikely for these inputs.\n            results.append([float('nan'), float('nan')])\n            continue\n\n        # Step 3: The maximum amplification is the largest singular value.\n        max_amplification = s[0]\n\n        # Step 4: The optimal initial perturbation is the first right singular vector.\n        # This corresponds to the first row of Vh.\n        optimal_perturbation_vec = vh[0, :]\n\n        # Step 5: Compute eigenvalues and eigenvectors of J.\n        # w contains eigenvalues, v contains corresponding eigenvectors as columns.\n        try:\n            eigenvalues, eigenvectors = np.linalg.eig(J)\n        except np.linalg.LinAlgError:\n            results.append([max_amplification, float('nan')])\n            continue\n\n        # Step 6: Identify the dominant eigenvector.\n        # This is the eigenvector corresponding to the eigenvalue with the largest real part.\n        dominant_eigenvalue_idx = np.argmax(np.real(eigenvalues))\n        dominant_eigenvector = eigenvectors[:, dominant_eigenvalue_idx]\n\n        # Step 7: Calculate the angle between the two vectors.\n        # The vectors from np.linalg.svd and np.linalg.eig are normalized.\n        # We take the absolute value of the dot product because the sign of\n        # eigenvectors/singular vectors is arbitrary. This gives the acute angle.\n        dot_product = np.dot(optimal_perturbation_vec.conj(), dominant_eigenvector)\n        # Ensure the argument to arccos is within [-1, 1] to avoid numerical errors.\n        cosine_angle = np.clip(np.abs(dot_product), -1.0, 1.0)\n        angle_rad = np.arccos(cosine_angle)\n\n        results.append([max_amplification, angle_rad])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # e.g., [[float1, float2], [float3, float4]]\n    # Using map(str, results) and join correctly formats inner lists as strings.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}