{
    "hands_on_practices": [
        {
            "introduction": "动态模型与静态模型的根本区别在于它们如何处理时间。本练习旨在通过一个经典案例——碳库对输入变化的响应——来阐明这一核心差异。我们将从第一性原理出发，推导系统在受到外部强迫（例如，碳输入突然增加）后，其状态如何随时间逐渐演变并趋向新的平衡点。通过求解这个瞬态响应，你将亲手揭示动态模型所捕捉到的“过程”与“路径”，这与静态模型仅仅预测瞬时“终点”的视角形成了鲜明对比。",
            "id": "3915701",
            "problem": "考虑一个单库陆地土壤碳模型，其中碳储量 $C(t)$ 的演变由输入 $I(t)$ 和以恒定速率 $k$ 为特征的一阶周转所决定。质量守恒定律规定，储量的时间变化率等于输入减去输出。经验证据支持以下假设：输出与储量成正比，比例常数为 $k$。在 $t=0$ 之前，系统在恒定输入 $I(t)=I_0$ 下处于稳态；在 $t=0$ 时，输入发生瞬时阶跃增加，变为新的恒定输入 $I(t)=I_1$（对所有 $t \\geq 0$）。假设储量在 $t=0$ 时是连续的。\n\n仅使用质量守恒和一阶周转假设，推导输入发生阶跃变化后 $t \\geq 0$ 时的瞬态解 $C(t)$。确定阶跃后输入条件下的新稳态值 $C_{\\infty}$，并阐明动态模型的瞬态响应与静态模型（该模型将储量在任何时候都等同于其稳态值）有何不同。\n\n然后，对于参数值 $k = 0.08$ 年$^{-1}$，$I_0 = 300$ g C m$^{-2}$ 年$^{-1}$，以及 $I_1 = 360$ g C m$^{-2}$ 年$^{-1}$，计算最短时间 $t_{0.99}$，使得动态储量满足以下条件：\n$$\n|C(t) - C_{\\infty}| \\leq 0.01\\,|C(0^{+}) - C_{\\infty}|.\n$$\n时间以年为单位表示。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题陈述被认为是有效的，因为它具有科学依据、是良定的、客观的，并包含推导唯一且有意义解所需的所有必要信息。它代表了环境系统建模中的一个标准初值问题。\n\n土壤碳储量 $C(t)$ 的演变遵循质量守恒原理，即储量的变化率等于输入速率减去输出速率。\n$$\n\\frac{dC}{dt} = I(t) - \\text{输出}\n$$\n问题指明输出是由一阶周转引起的，意味着输出速率与当前储量大小成正比，比例常数为 $k$。\n$$\n\\text{输出} = kC(t)\n$$\n结合这两个陈述，得到该系统的控制方程，即一个一阶线性常微分方程：\n$$\n\\frac{dC}{dt} = I(t) - kC(t) \\quad \\text{或} \\quad \\frac{dC}{dt} + kC(t) = I(t)\n$$\n\n首先，我们必须确定 $t=0$ 时的初始条件。问题陈述，对于 $t  0$，系统在恒定输入 $I(t) = I_0$ 下处于稳态。在稳态下，储量不发生变化，因此 $\\frac{dC}{dt} = 0$。控制方程变为：\n$$\n0 = I_0 - kC_{ss,0}\n$$\n其中 $C_{ss,0}$ 是稳态碳储量。解出 $C_{ss,0}$ 可得：\n$$\nC_{ss,0} = \\frac{I_0}{k}\n$$\n问题指明储量 $C(t)$ 在 $t=0$ 处是连续的。因此，系统后续演变的初始条件是阶跃前时期的最终储量值。由于连续性，我们记为 $C(0) = C(0^+)$。\n$$\nC(0) = C_{ss,0} = \\frac{I_0}{k}\n$$\n\n接下来，我们求解 $t \\geq 0$ 时的瞬态响应。在此期间，输入是一个新的恒定值 $I(t) = I_1$。微分方程为：\n$$\n\\frac{dC}{dt} + kC = I_1\n$$\n这是一个非齐次一阶线性常微分方程。可以使用积分因子 $\\mu(t) = \\exp\\left(\\int k \\, dt\\right) = \\exp(kt)$ 求解。将该常微分方程两边乘以 $\\mu(t)$：\n$$\n\\exp(kt)\\frac{dC}{dt} + k\\exp(kt)C(t) = I_1\\exp(kt)\n$$\n左边是微分乘法法则的结果，即 $\\frac{d}{dt}[C(t)\\exp(kt)]$。\n$$\n\\frac{d}{dt}[C(t)\\exp(kt)] = I_1\\exp(kt)\n$$\n将两边对 $t$ 从 $0$ 积分到 $t$：\n$$\n\\int_0^t \\frac{d}{d\\tau}[C(\\tau)\\exp(k\\tau)] \\, d\\tau = \\int_0^t I_1\\exp(k\\tau) \\, d\\tau\n$$\n$$\nC(t)\\exp(kt) - C(0)\\exp(0) = I_1 \\left[ \\frac{\\exp(k\\tau)}{k} \\right]_0^t\n$$\n$$\nC(t)\\exp(kt) - C(0) = \\frac{I_1}{k} (\\exp(kt) - 1)\n$$\n解出 $C(t)$：\n$$\nC(t) = C(0)\\exp(-kt) + \\frac{I_1}{k}(1 - \\exp(-kt))\n$$\n代入初始条件 $C(0) = I_0/k$：\n$$\nC(t) = \\frac{I_0}{k}\\exp(-kt) + \\frac{I_1}{k} - \\frac{I_1}{k}\\exp(-kt)\n$$\n化简后得到 $t \\geq 0$ 时的瞬态解：\n$$\nC(t) = \\frac{I_1}{k} + \\left(\\frac{I_0}{k} - \\frac{I_1}{k}\\right)\\exp(-kt)\n$$\n\n新的稳态值 $C_{\\infty}$ 是 $C(t)$ 在 $t \\to \\infty$ 时的极限。由于 $k  0$，项 $\\exp(-kt)$ 趋近于 $0$。\n$$\nC_{\\infty} = \\lim_{t \\to \\infty} C(t) = \\lim_{t \\to \\infty} \\left[ \\frac{I_1}{k} + \\left(\\frac{I_0}{k} - \\frac{I_1}{k}\\right)\\exp(-kt) \\right] = \\frac{I_1}{k}\n$$\n使用这个结果，瞬态解可以用初始状态和最终状态更简洁地表示：\n$$\nC(t) = C_{\\infty} + (C(0) - C_{\\infty})\\exp(-kt)\n$$\n\n现在可以阐明动态模型和静态模型之间的区别。\n**静态模型**假设系统对强迫项的变化做出瞬时响应，并且始终处于平衡状态。在这种情况下，静态模型会预测碳储量为 $C_{static}(t) = I(t)/k$。因此，在 $t=0$ 时，储量会从旧的稳态值 $C_0 = I_0/k$ 不连续地跳变到新的稳态值 $C_{\\infty} = I_1/k$。\n**动态模型**，如我们所推导的，显示出一种根本不同的行为。储量 $C(t)$ 在 $t=0$ 时是连续的，并只是渐近地趋近于新的稳态 $C_{\\infty}$。这个过渡不是瞬时的，而是在一个由 $1/k$ 决定的特征时间尺度上发生。动态模型捕捉了系统的瞬态响应，反映了其对过去状态的惯性或“记忆”，而这是静态模型完全忽略的。\n\n最后，我们计算所需时间 $t_{0.99}$，以使储量与新稳态的差值相对于初始偏差减小到1%以内。该条件是：\n$$\n|C(t) - C_{\\infty}| \\leq 0.01\\,|C(0^{+}) - C_{\\infty}|\n$$\n根据我们的解，有 $C(t) - C_{\\infty} = (C(0) - C_{\\infty})\\exp(-kt)$。将其代入不等式：\n$$\n|(C(0) - C_{\\infty})\\exp(-kt)| \\leq 0.01\\,|C(0) - C_{\\infty}|\n$$\n由于 $C(0) = I_0/k$ 和 $C_{\\infty}=I_1/k$ 是不同的（因为 $I_0 \\neq I_1$），项 $|C(0) - C_{\\infty}|$ 非零，可以消去。此外，$\\exp(-kt)$ 总是正的。这可将不等式简化为：\n$$\n\\exp(-kt) \\leq 0.01\n$$\n为了找到满足此条件的最小时间 $t_{0.99}$，我们求解等式：\n$$\n\\exp(-kt_{0.99}) = 0.01\n$$\n取两边的自然对数：\n$$\n-kt_{0.99} = \\ln(0.01)\n$$\n解出 $t_{0.99}$：\n$$\nt_{0.99} = -\\frac{\\ln(0.01)}{k}\n$$\n代入给定值 $k = 0.08$ 年$^{-1}$：\n$$\nt_{0.99} = -\\frac{\\ln(0.01)}{0.08} = -\\frac{\\ln(10^{-2})}{0.08} = -\\frac{-2\\ln(10)}{0.08} = \\frac{2\\ln(10)}{0.08}\n$$\n数值上，$\\ln(0.01) \\approx -4.60517$。\n$$\nt_{0.99} = \\frac{4.60517...}{0.08} \\approx 57.5646... \\text{ 年}\n$$\n将结果四舍五入到四位有效数字，我们得到 $57.56$ 年。请注意，此计算不需要 $I_0$ 和 $I_1$ 的值，因为达到新平衡某一比例所需的时间仅取决于系统的内在速率常数 $k$。",
            "answer": "$$\n\\boxed{57.56}\n$$"
        },
        {
            "introduction": "理解了瞬态响应的存在之后，下一个关键问题是：这种“过程依赖性”源于何处？答案在于系统的“记忆”，即其当前状态是过去所有输入的累积效应。本实践将通过一个具体的土壤水分“桶模型”来生动地展示状态记忆的重要性。你将通过编程模拟，比较在完全相同的气象强迫下，仅因初始土壤湿度不同而导致的地表通量（如蒸散发）轨迹的显著差异。这个练习清晰地揭示了为什么忽略状态变量的动态演化会导致对地球系统过程的误判。",
            "id": "3915716",
            "problem": "您需要通过精确计算来证明，当状态变量表现出记忆性时，从气象强迫到地表通量的静态映射对于地球系统模拟来说是不充分的。考虑一个垂直集总的单层土壤桶模型，其储水量被限制在零和最大容量之间，并由相同的日降水量和潜在蒸散发时间序列驱动。您的任务是实现一个动态模型和一个静态映射模型，计算由此产生的蒸散发通量轨迹，并量化仅由初始土壤湿度差异引起的发散。\n\n使用的基本原理和定义如下。设土壤水储量为 $S(t)$，单位为 $\\mathrm{mm}$；潜在蒸散发为 $E_{p}(t)$，单位为 $\\mathrm{mm}/\\mathrm{day}$；日降水量为 $P(t)$，单位为 $\\mathrm{mm}/\\mathrm{day}$；最大储水量为 $S_{\\max}$，单位为 $\\mathrm{mm}$。日水量平衡由守恒原理给出：\n$$\\frac{dS}{dt} = P(t) - E(t) - D(t) - R(t),$$\n其中 $E(t)$ 是实际蒸散发，单位为 $\\mathrm{mm}/\\mathrm{day}$；$D(t)$ 是慢速排水，单位为 $\\mathrm{mm}/\\mathrm{day}$；$R(t)$ 是快速径流，单位为 $\\mathrm{mm}/\\mathrm{day}$。使用日时间步长的离散时间更新，并遵循物理上一致的顺序：降水加入储量，然后减去蒸散发和排水，任何超出容量的溢出量通过储量上限约束来隐式处理。具体来说，对于每一天 $t$：\n$$S^{+}(t) = \\min\\{S_{\\max}, S(t) + P(t)\\},$$\n$$E(t) = E_{p}(t)\\,\\phi\\!\\left(\\frac{S^{+}(t)}{S_{\\max}}\\right),\\quad \\phi(u) = u^{\\alpha},\\quad 0 \\le u \\le 1,$$\n$$E(t) \\le S^{+}(t),\\quad D(t) = k_{d}\\,S^{+}(t),$$\n$$S(t+1) = \\max\\{0,\\, S^{+}(t) - E(t) - D(t)\\}.$$\n所有量的单位均为 $\\mathrm{mm}$ 或 $\\mathrm{mm}/\\mathrm{day}$。静态映射模型将实际蒸散发定义为潜在蒸散发的一个与状态无关的标量倍数：\n$$E_{\\text{stat}}(t) = c\\,E_{p}(t),$$\n其中常数 $c \\in (0,1)$，因此无论初始土壤湿度如何，相同的强迫都会产生相同的 $E_{\\text{stat}}(t)$。\n\n所有测试用例的强迫时间序列均相同，由长度为 $T$ 天的确定性非负日序列指定：\n- 天数：$T = 60$。\n- 潜在蒸散发：对于 $t = 1,\\dots,60$，$E_{p}(t) = \\mathrm{clip}\\left(4 + 2\\sin\\left(\\frac{2\\pi t}{30}\\right),\\, 1,\\, 7\\right)$，单位为 $\\mathrm{mm}/\\mathrm{day}$；截断边界强制 $1 \\le E_{p}(t) \\le 7$，单位为 $\\mathrm{mm}/\\mathrm{day}$。\n- 降水量：对于 $t = 1,\\dots,60$，$P(t) = \\mathrm{clip}\\left(0.5 + 5\\max\\!\\left(0, \\sin\\left(\\frac{2\\pi (t+5)}{15}\\right)\\right),\\, 0,\\, 8\\right)$，单位为 $\\mathrm{mm}/\\mathrm{day}$；截断边界强制 $0 \\le P(t) \\le 8$，单位为 $\\mathrm{mm}/\\mathrm{day}$。\n\n所有测试用例的模型参数均固定如下：$S_{\\max} = 100$ $\\mathrm{mm}$，$\\alpha = 1.5$，$k_{d} = 0.02$ $\\mathrm{day}^{-1}$，以及 $c = 0.7$（无量纲）。潜在蒸散发（PET）是气象需求 $E_{p}(t)$，而实际蒸散发 $E(t)$ 通过 $\\phi(\\cdot)$ 由储水量控制。\n\n实现上述动态模型更新和静态映射。对于每个测试用例，运行两次模拟，两次模拟仅初始储量 $S(1)$ 不同，但使用相同的强迫。计算两个动态蒸散发轨迹之间的均方根差异：\n$$D_{\\text{dyn}} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T}\\left(E^{(1)}(t) - E^{(2)}(t)\\right)^{2}} \\quad \\text{in}\\ \\mathrm{mm}/\\mathrm{day},$$\n并计算相应的静态差异：\n$$D_{\\text{stat}} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T}\\left(E_{\\text{stat}}(t) - E_{\\text{stat}}(t)\\right)^{2}} = 0 \\quad \\text{in}\\ \\mathrm{mm}/\\mathrm{day}.$$\n您对每个测试用例的输出必须是有序对 $[D_{\\text{dyn}}, D_{\\text{stat}}]$，单位为 $\\mathrm{mm}/\\mathrm{day}$。\n\n使用以下初始储量对测试套件，所有单位均为 $\\mathrm{mm}$：\n- 案例 1（一般变异性）：$(S_{0}^{(1)}, S_{0}^{(2)}) = (10, 60)$。\n- 案例 2（接近干涸 vs 中等湿度）：$(S_{0}^{(1)}, S_{0}^{(2)}) = (0.5, 30)$。\n- 案例 3（接近饱和 vs 低湿度）：$(S_{0}^{(1)}, S_{0}^{(2)}) = (90, 20)$。\n- 案例 4（相同初始状态的边界条件）：$(S_{0}^{(1)}, S_{0}^{(2)}) = (50, 50)$。\n\n将 $D_{\\text{dyn}}$ 和 $D_{\\text{stat}}$ 表示为单位为 $\\mathrm{mm}/\\mathrm{day}$ 的实数。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个项目是对应测试用例的双元素列表 $[D_{\\text{dyn}},D_{\\text{stat}}]$。例如，形式为 $[[x_{1},y_{1}],[x_{2},y_{2}],\\dots]$ 的输出，其中 $x_{i}$ 和 $y_{i}$ 是单位为 $\\mathrm{mm}/\\mathrm{day}$ 的浮点数。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确且客观。它提供了一整套确定性的方程、参数和初始条件，可以唯一地求解指定的输出。该问题是地球系统模拟中的一个标准的、说明性的练习，通过对比一个状态依赖（动态）模型与一个状态无关（静态）模型，来展示系统记忆的概念。\n\n这个问题的核心在于展示动态系统中的路径依赖性，即系统的当前状态和未来演化依赖于其历史，而历史则由其状态变量所封装。相比之下，静态系统的输出仅是其当前输入的函数，没有记忆。在这里，土壤湿度 $S(t)$ 是承载系统记忆的状态变量。\n\n动态模型是土壤水量平衡的离散时间表示。对于从 $t=1$ 到 $T=60$ 的每一天 $t$，模拟根据一天开始时给定的初始储量 $S(t)$ 按以下步骤进行。\n\n1.  **更新前储量**：首先，将日降水量 $P(t)$ 加入前一天的储量 $S(t)$ 中。任何超过最大容量 $S_{\\max}$ 的水量被假定为立即成为地表径流，并通过限制储量上限来隐式去除。这个中间储量值表示为 $S^{+}(t)$。\n    $$S^{+}(t) = \\min\\{S_{\\max}, S(t) + P(t)\\}$$\n    这里，$S_{\\max} = 100\\,\\mathrm{mm}$。\n\n2.  **通量计算**：接下来，根据这个更新的前储量 $S^{+}(t)$ 计算流出通量——实际蒸散发 $E(t)$ 和排水 $D(t)$。\n    - 实际蒸散发 $E(t)$ 是大气需求（由潜在蒸散发 $E_{p}(t)$ 表示）和水分可利用性（由相对土壤湿度 $\\frac{S^{+}(t)}{S_{\\max}}$ 表示）的函数。其非线性关系由下式给出：\n      $$E(t) = E_{p}(t)\\,\\phi\\!\\left(\\frac{S^{+}(t)}{S_{\\max}}\\right) = E_{p}(t)\\left(\\frac{S^{+}(t)}{S_{\\max}}\\right)^{\\alpha}$$\n      参数 $\\alpha = 1.5$。检查可确认，给定的参数确保了物理约束 $E(t) \\le S^{+}(t)$ 始终满足，因为 $E_p(t)/S_{\\max} \\le 7/100 = 0.07 \\ll 1$。\n    - 排水 $D(t)$ 被建模为线性水库，与前储量成正比：\n      $$D(t) = k_{d}\\,S^{+}(t)$$\n      排水常数 $k_{d} = 0.02\\,\\mathrm{day}^{-1}$。\n\n3.  **日末储量**：最后，通过从 $S^{+}(t)$ 中减去流出通量来计算下一天开始时的储量 $S(t+1)$。储量被防止变为负值，任何亏缺都被视为未满足的需求。\n    $$S(t+1) = \\max\\{0,\\, S^{+}(t) - E(t) - D(t)\\}$$\n\n此序列迭代 $T=60$ 天。关键点在于输出通量 $E(t)$ 依赖于状态 $S(t)$。由于一次模拟中的 $S(t)$ 可能因初始条件 $S(1)$ 不同而与另一次模拟不同，它们各自的蒸散发轨迹 $E^{(1)}(t)$ 和 $E^{(2)}(t)$ 也将不同。这种差异由均方根差异 $D_{\\text{dyn}}$ 来量化，证明了模型对其初始状态的记忆。\n$$D_{\\text{dyn}} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T}\\left(E^{(1)}(t) - E^{(2)}(t)\\right)^{2}}$$\n\n相反，静态模型由一个无记忆映射定义：\n$$E_{\\text{stat}}(t) = c\\,E_{p}(t)$$\n其中常数系数 $c = 0.7$。在此模型中，输出 $E_{\\text{stat}}(t)$ 仅依赖于当前输入 $E_{p}(t)$。因此，对于由相同的 $E_{p}(t)$ 时间序列驱动的两次模拟，无论名义上的“初始状态”如何，输出轨迹都将是相同的。这导致其差异根据定义为零：\n$$D_{\\text{stat}} = \\sqrt{\\frac{1}{T}\\sum_{t=1}^{T}\\left(E_{\\text{stat}}(t) - E_{\\text{stat}}(t)\\right)^{2}} = 0$$\n\n潜在蒸散发 $E_p(t)$ 和降水 $P(t)$ 的强迫时间序列是使用所提供的确定性函数为 $t=1, \\dots, 60$ 生成的：\n$$E_{p}(t) = \\mathrm{clip}\\left(4 + 2\\sin\\left(\\frac{2\\pi t}{30}\\right),\\, 1,\\, 7\\right)$$\n$$P(t) = \\mathrm{clip}\\left(0.5 + 5\\max\\!\\left(0, \\sin\\left(\\frac{2\\pi (t+5)}{15}\\right)\\right),\\, 0,\\, 8\\right)$$\n\n实现将首先生成这些强迫时间序列。然后，对于每个测试用例的初始条件对 $(S_{0}^{(1)}, S_{0}^{(2)})$，将分别运行两次动态模型模拟，以生成实际蒸散发时间序列 $E^{(1)}(t)$ 和 $E^{(2)}(t)$。然后计算差异 $D_{\\text{dyn}}$。对于案例 4，其中 $S_{0}^{(1)} = S_{0}^{(2)} = 50\\,\\mathrm{mm}$，我们预期 $D_{\\text{dyn}} = 0$，这提供了一致性检验。$D_{\\text{stat}}$ 的值始终为 $0$。最终输出将是每个测试用例的 $[D_{\\text{dyn}}, D_{\\text{stat}}]$ 对的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and compares a dynamic soil moisture model with a static mapping\n    to demonstrate the effect of state memory on model outputs.\n    \"\"\"\n    \n    # Model parameters and constants\n    T = 60  # Number of days\n    S_max = 100.0  # Maximum storage (mm)\n    alpha = 1.5  # Evapotranspiration exponent\n    k_d = 0.02  # Drainage coefficient (day^-1)\n    c = 0.7  # Static model coefficient\n    \n    # Define the test cases for initial storage (mm)\n    test_cases = [\n        (10.0, 60.0),    # Case 1: general variability\n        (0.5, 30.0),     # Case 2: near-desiccation vs moderate\n        (90.0, 20.0),    # Case 3: near-saturation vs low\n        (50.0, 50.0)     # Case 4: identical initial state (sanity check)\n    ]\n\n    # Generate forcing time series\n    # Time array t from 1 to T (60)\n    time_t = np.arange(1, T + 1)\n    \n    # Potential Evapotranspiration (Ep)\n    ep_series = 4.0 + 2.0 * np.sin(2.0 * np.pi * time_t / 30.0)\n    ep_series = np.clip(ep_series, 1.0, 7.0)\n    \n    # Precipitation (P)\n    p_sin_arg = 2.0 * np.pi * (time_t + 5.0) / 15.0\n    p_series = 0.5 + 5.0 * np.maximum(0, np.sin(p_sin_arg))\n    p_series = np.clip(p_series, 0.0, 8.0)\n\n    def run_dynamic_model(S_initial, T, S_max, alpha, k_d, p_series, ep_series):\n        \"\"\"\n        Simulates the dynamic soil bucket model for T days.\n\n        Args:\n            S_initial (float): Initial soil water storage (mm).\n            T (int): Number of simulation days.\n            S_max (float): Maximum soil water storage (mm).\n            alpha (float): Evapotranspiration parameter.\n            k_d (float): Drainage coefficient (day^-1).\n            p_series (np.ndarray): Time series of precipitation (mm/day).\n            ep_series (np.ndarray): Time series of potential ET (mm/day).\n\n        Returns:\n            np.ndarray: Time series of actual evapotranspiration (mm/day).\n        \"\"\"\n        S = np.zeros(T)\n        E_actual = np.zeros(T)\n        \n        current_S = S_initial\n        \n        for t in range(T):\n            # Storage after precipitation\n            S_plus = min(S_max, current_S + p_series[t])\n            \n            # Calculate fluxes based on S_plus\n            # Relative storage u = S_plus / S_max\n            rel_storage = S_plus / S_max\n            # Actual Evapotranspiration E(t)\n            E = ep_series[t] * (rel_storage ** alpha)\n            \n            # Drainage D(t)\n            D = k_d * S_plus\n            \n            # Update storage for the next day\n            next_S = max(0, S_plus - E - D)\n            \n            # Store results\n            S[t] = next_S\n            E_actual[t] = E\n            \n            # Update current storage for next iteration\n            current_S = next_S\n            \n        return E_actual\n\n    results = []\n    \n    for s0_1, s0_2 in test_cases:\n        # Run dynamic model for both initial conditions\n        E_traj_1 = run_dynamic_model(s0_1, T, S_max, alpha, k_d, p_series, ep_series)\n        E_traj_2 = run_dynamic_model(s0_2, T, S_max, alpha, k_d, p_series, ep_series)\n        \n        # Calculate dynamic divergence\n        diff_sq = (E_traj_1 - E_traj_2) ** 2\n        mean_sq_diff = np.mean(diff_sq)\n        D_dyn = np.sqrt(mean_sq_diff)\n        \n        # Static divergence is always 0 by definition\n        D_stat = 0.0\n        \n        results.append([D_dyn, D_stat])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, so we need to stringify each inner list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "掌握了动态模型的行为特征后，我们来探讨一个更深层次的问题：这种动态特性对我们从观测数据中学习和推断系统参数有何影响？本练习揭示了一个在模型校准中普遍存在的陷阱——参数的非唯一性。你将证明，仅依靠静态的、处于平衡态的观测数据，可能无法唯一确定系统的内部参数，因为不同的参数组合可以产生完全相同的稳态输出。通过分析瞬态响应的差异，本练习强调了动态数据在揭示系统真实动力学机制和确保模型预测可靠性方面的不可或替代的价值。",
            "id": "3915709",
            "problem": "考虑一个用于守恒示踪剂的单室、充分混合箱式模型，其中浓度 $C(t)$ 根据具有恒定体积源和一级去除的线性质量平衡方程演变。其动力学由以下常微分方程 (ODE) 给出：\n$$\n\\frac{dC}{dt} \\;=\\; -\\,k\\,C \\;+\\; u(t),\n$$\n其中 $k$ 是一个正的一级去除速率常数，$u(t)$ 是一个在 $t=0$ 时从 $0$ 阶跃到一个正常数 $u_{0}$ 的源。观测值为一个标量输出\n$$\ny(t) \\;=\\; b\\,C(t),\n$$\n其中 $b$ 是一个正的、无量纲的观测增益。初始条件为 $C(0)=0$。这种设置在环境和地球系统建模中很常见，其中仅靠静态（稳态）观测本身无法区分动力学参数和观测增益。\n\n仅使用上述基本定义和常系数线性常微分方程的基本性质，完成以下任务：\n\n1) 从第一性原理出发，证明稳态输出 $y_{\\infty} \\equiv \\lim_{t\\to\\infty} y(t)$ 取决于比率 $b/k$，而不是单独取决于 $k$ 和 $b$。\n\n2) 利用这一点构造一个明确的反例，以证明静态数据下的不可辨识性：选择两个不同的参数集 $(k_{1},b_{1})$ 和 $(k_{2},b_{2})$，它们在相同的恒定输入 $u_{0}$ 下产生相同的稳态输出，但具有不同的瞬态响应。为具体起见，取 $k_{1}=1\\,\\text{day}^{-1}$ 和 $b_{1}=1$，并取 $k_{2}=2\\,\\text{day}^{-1}$。确定使这两个参数集的稳态输出相同的 $b_{2}$ 的值。\n\n3) 对于这两个参数集和任意固定的正 $u_{0}$，解析地推导出使输出差异的绝对值\n$$\n|y_{1}(t)-y_{2}(t)|,\n$$\n达到最大值的时间 $t^{\\ast}0$，其中 $y_{i}(t)$ 是对应于 $(k_{i},b_{i})$ 的输出。然后，对指定的 $k_{1}$ 和 $k_{2}$ 数值计算 $t^{\\ast}$。\n\n将您最终的 $t^{\\ast}$ 数值答案保留四位有效数字。最终时间以天为单位表示。",
            "solution": "经核实，该问题在科学上是合理的、适定的、客观的和完整的。我们开始解答，依次解决三个部分。\n\n控制示踪剂浓度 $C(t)$ 的常微分方程 (ODE) 为\n$$\n\\frac{dC}{dt} = -kC + u(t)\n$$\n初始条件为 $C(0)=0$。源项 $u(t)$ 是一个阶跃函数，其中对于 $t \\ge 0$，$u(t)=u_0$（一个正常数）。观测输出为 $y(t) = bC(t)$，其中 $b$ 是一个正的、无量纲的增益。\n\n第 1 部分：稳态输出分析\n\n稳态浓度，记为 $C_{\\infty}$，是当 $t \\to \\infty$ 时 $C(t)$ 的值。在此状态下，系统处于平衡，意味着浓度不再随时间变化。在数学上，这对应于条件 $\\frac{dC}{dt} = 0$。将此条件和恒定源 $u_0$ 代入控制 ODE，我们得到：\n$$\n0 = -k C_{\\infty} + u_0\n$$\n求解稳态浓度 $C_{\\infty}$ 得：\n$$\nk C_{\\infty} = u_0 \\implies C_{\\infty} = \\frac{u_0}{k}\n$$\n稳态输出 $y_{\\infty}$ 定义为当 $t \\to \\infty$ 时 $y(t)$ 的极限。使用关系式 $y(t) = bC(t)$，我们发现：\n$$\ny_{\\infty} = \\lim_{t\\to\\infty} y(t) = b \\left( \\lim_{t\\to\\infty} C(t) \\right) = b C_{\\infty}\n$$\n代入 $C_{\\infty}$ 的表达式：\n$$\ny_{\\infty} = b \\left(\\frac{u_0}{k}\\right) = u_0 \\left(\\frac{b}{k}\\right)\n$$\n这个结果表明，对于给定的恒定源 $u_0$，稳态输出 $y_{\\infty}$ 仅取决于参数的比率 $b/k$，而不取决于 $b$ 和 $k$ 的单个值。这个性质是仅从静态（稳态）数据无法进行辨识的基础。\n\n第 2 部分：构造反例\n\n我们需要找到两个不同的参数集 $(k_1, b_1)$ 和 $(k_2, b_2)$，它们产生相同的稳态输出但具有不同的瞬态动力学。稳态输出相同，即 $y_{1,\\infty} = y_{2,\\infty}$ 的条件是：\n$$\nu_0 \\left(\\frac{b_1}{k_1}\\right) = u_0 \\left(\\frac{b_2}{k_2}\\right)\n$$\n由于 $u_0  0$，这简化为参数比率必须相等的条件：\n$$\n\\frac{b_1}{k_1} = \\frac{b_2}{k_2}\n$$\n我们已知第一个参数集 $(k_1, b_1)$ 为 $k_1 = 1\\,\\text{day}^{-1}$ 和 $b_1 = 1$。对于第二个参数集，我们已知 $k_2 = 2\\,\\text{day}^{-1}$。现在我们可以求解所需的 $b_2$ 值：\n$$\n\\frac{1}{1} = \\frac{b_2}{2} \\implies b_2 = 2\n$$\n因此，这两个参数集是 $(k_1, b_1) = (1, 1)$ 和 $(k_2, b_2) = (2, 2)$。这两个集合是不同的，但它们都具有相同的参数比率 $b/k=1$。它们将产生相同的稳态输出 $y_\\infty = u_0$，但由于速率常数 $k_1$ 和 $k_2$ 不同，它们的瞬态响应将不同。系统的时间常数 $\\tau=1/k$ 对于第一个系统是 $\\tau_1 = 1\\,\\text{day}$，对于第二个系统是 $\\tau_2 = 1/2\\,\\text{day}$，这意味着第二个系统更快地接近稳态。\n\n第 3 部分：最大化瞬态输出的差异\n\n为了分析瞬态响应，我们必须首先求出当 $t \\ge 0$ 时 ODE 的完整解 $C(t)$：\n$$\n\\frac{dC}{dt} + kC = u_0, \\quad C(0)=0\n$$\n这是一个一阶线性常微分方程。我们使用积分因子法。积分因子是 $\\exp\\left(\\int k \\, dt\\right) = \\exp(kt)$。将 ODE 乘以积分因子得到：\n$$\n\\exp(kt) \\frac{dC}{dt} + k\\exp(kt)C = u_0 \\exp(kt)\n$$\n左边是一个乘积的导数：\n$$\n\\frac{d}{dt}\\left( C(t)\\exp(kt) \\right) = u_0 \\exp(kt)\n$$\n对两边从 $0$ 到 $t$ 积分：\n$$\n\\int_0^t \\frac{d}{ds}\\left( C(s)\\exp(ks) \\right) ds = \\int_0^t u_0 \\exp(ks) ds\n$$\n$$\nC(t)\\exp(kt) - C(0)\\exp(0) = u_0 \\left[ \\frac{1}{k}\\exp(ks) \\right]_0^t\n$$\n使用初始条件 $C(0)=0$：\n$$\nC(t)\\exp(kt) = \\frac{u_0}{k}(\\exp(kt) - \\exp(0)) = \\frac{u_0}{k}(\\exp(kt) - 1)\n$$\n求解 $C(t)$：\n$$\nC(t) = \\frac{u_0}{k}(1 - \\exp(-kt))\n$$\n相应的输出为 $y(t) = b C(t) = \\frac{b u_0}{k}(1 - \\exp(-kt))$。\n\n对于在第 2 部分中找到的两个参数集，输出 $y_1(t)$ 和 $y_2(t)$ 为：\n$$\ny_1(t) = \\frac{b_1 u_0}{k_1}(1 - \\exp(-k_1 t))\n$$\n$$\ny_2(t) = \\frac{b_2 u_0}{k_2}(1 - \\exp(-k_2 t))\n$$\n由于 $b_1/k_1 = b_2/k_2 = 1$，我们可以简化这些表达式：\n$$\ny_1(t) = u_0(1 - \\exp(-k_1 t))\n$$\n$$\ny_2(t) = u_0(1 - \\exp(-k_2 t))\n$$\n输出的差异为 $\\Delta y(t) = y_1(t) - y_2(t)$：\n$$\n\\Delta y(t) = u_0(1 - \\exp(-k_1 t)) - u_0(1 - \\exp(-k_2 t)) = u_0(\\exp(-k_2 t) - \\exp(-k_1 t))\n$$\n为了找到该差异的绝对值 $|\\Delta y(t)|$ 达到最大值的时间 $t^*$，我们首先通过将其关于 $t$ 的导数设为零来求 $\\Delta y(t)$ 的极值。\n$$\n\\frac{d}{dt}(\\Delta y(t)) = u_0(-k_2 \\exp(-k_2 t) - (-k_1)\\exp(-k_1 t)) = u_0(k_1 \\exp(-k_1 t) - k_2 \\exp(-k_2 t))\n$$\n在 $t = t^*$ 处将导数设为零：\n$$\nk_1 \\exp(-k_1 t^*) - k_2 \\exp(-k_2 t^*) = 0\n$$\n$$\nk_1 \\exp(-k_1 t^*) = k_2 \\exp(-k_2 t^*)\n$$\n为了求解 $t^*$，我们对两边取自然对数：\n$$\n\\ln(k_1) - k_1 t^* = \\ln(k_2) - k_2 t^*\n$$\n$$\n(k_2 - k_1)t^* = \\ln(k_2) - \\ln(k_1) = \\ln\\left(\\frac{k_2}{k_1}\\right)\n$$\n最大差异时间的解析表达式为：\n$$\nt^* = \\frac{\\ln(k_2/k_1)}{k_2 - k_1}\n$$\n由于 $k_2=2\\,\\text{day}^{-1}$ 和 $k_1=1\\,\\text{day}^{-1}$，我们有 $k_2  k_10$。对于 $t0$，$k_2 t  k_1 t$，这意味着 $-k_2 t  -k_1 t$ 和 $\\exp(-k_2 t)  \\exp(-k_1 t)$。因此，对于所有 $t0$，$\\Delta y(t)$ 都是负的。最大化其绝对值 $|\\Delta y(t)|$ 等同于找到其最小值的时间，这对应于我们找到的唯一临界点。\n\n最后，我们使用给定值 $k_1 = 1\\,\\text{day}^{-1}$ 和 $k_2 = 2\\,\\text{day}^{-1}$ 来数值计算 $t^*$：\n$$\nt^* = \\frac{\\ln(2/1)}{2 - 1} = \\frac{\\ln(2)}{1} = \\ln(2)\\,\\text{days}\n$$\n数值上，$\\ln(2) \\approx 0.693147...$。保留四位有效数字得到：\n$$\nt^* \\approx 0.6931\\,\\text{days}\n$$",
            "answer": "$$\n\\boxed{0.6931}\n$$"
        }
    ]
}