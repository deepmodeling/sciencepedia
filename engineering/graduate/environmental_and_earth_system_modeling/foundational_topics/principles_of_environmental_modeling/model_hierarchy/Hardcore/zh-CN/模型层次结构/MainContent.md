## 引言
在地球系统科学领域，理解和预测一个由无数相互作用过程构成的复杂系统是一项核心挑战。模型是我们在这一探索中的主要工具，但我们如何构建既可靠又可解释的模型？试图构建一个包含所有已知过程的单一、“完美”的超高分辨率模型，不仅在计算上不可行，更容易陷入“过拟合”的陷阱，导致其预测和解释能力大打[折扣](@entry_id:139170)。这种方法论上的困境要求我们寻求一种更精妙的科学策略。

本文将系统介绍**模型层次结构 (model hierarchy)** 这一强大的认识论框架，它正是为了应对这一挑战而生。读者将首先在“原理与机制”一章中学习构建模型层次的哲学基础与核心技术，例如如何利用[简约性](@entry_id:141352)原则和数学简化来隔离过程。接着，“应用与交叉学科联系”一章将展示该方法在构建[地球系统模型](@entry_id:1124096)、约束不确定性以及在材料科学、神经科学等领域的广泛应用。最后，“动手实践”部分将提供具体的计算练习，帮助读者将理论知识转化为实践技能。通过这个从理论到实践的旅程，本文旨在阐明模型层次结构为何是现代计算科学中不可或缺的工具。让我们首先深入其核心，探讨构成这一策略的原理与机制。

## 原理与机制

在上一章引言之后，我们现在深入探讨模型层次结构的核心原理与机制。在[地球系统科学](@entry_id:175035)中，模型不仅是预测工具，更是我们构建和检验关于世界如何运作的理论的实验室。一个核心的认识论挑战在于，我们面对的是一个具有多重时空尺度和无数相互作用过程的复杂系统，而我们的观测数据永远是有限且充满噪声的。这就引出了一个根本性的问题：我们应该如何构建和评估模型，以最可靠的方式增进我们的科学知识？

一个看似直接的答案是“构建尽可能最全面的模型”，即一个包含了所有已知过程并以最高分辨率运行的单一、庞大的“完美模型”。然而，这种方法面临着几个不可逾越的障碍。首先，计算成本是天文数字。其次，更根本的是，一个极其复杂的模型往往会变得“过度[参数化](@entry_id:265163)”，拥有如此多的自由度，以至于它几乎可以拟合任何有限的数据集，这种现象被称为“过拟合”。这样的模型虽然可能在拟合已有数据方面表现出色，但其预测能力和解释能力却非常值得怀疑。它变得难以理解、难以检验，也难以归因。

因此，地球[系统建模](@entry_id:197208)的实践者们采用了一种更为精妙和强大的认识论策略：**模型层次结构 (model hierarchy)**。本章将阐述构成这一策略的原理和机制，解释如何构建、分析和应用模型层次结构来系统地增进我们对地球系统的理解。

### 模型层次结构：一种认识论策略

模型层次结构并非简单地将一堆模型集合在一起，而是一个有序的、系统关联的模型序列，它为科学发现提供了一个严谨的框架。这个框架基于几个核心的科学哲学原理：[简约性](@entry_id:141352)、[可证伪性](@entry_id:137568)和渐进式改进。

**简约性（Parsimony）**，通常被称为**奥卡姆剃刀 (Occam's razor)**，主张在其他条件相同的情况下，我们应偏爱能用最少的可调自由度来解释数据的模型。模型层次结构通过从一个只包含基本守恒定律和[主导平衡](@entry_id:174783)的最小模型开始，来践行[简约性](@entry_id:141352)原则。只有当一个更简单的模型系统性地无法解释新的观测（即其残差超出了噪声预期的范围）时，我们才有理由增加其复杂性。

**[可证伪性](@entry_id:137568)（Falsifiability）** 是科学理论的试金石。一个科学模型必须做出足够明确的预测，以至于存在可能与这些预测相矛盾的观测。一个过于灵活、可以解释任何结果的模型，实际上什么都没有解释。在模型层次结构中，每一次复杂性的增加——例如，引入一个新的物理过程——都构成了一个新的、可[证伪](@entry_id:260896)的假说：“这个新过程对于解释我们观察到的差异是必要且充分的”。

**渐进式改进（Progressive Refinement）** 是通过上述原则实现的知识构建过程。我们不是一次性构建一个庞大的最终模型，而是通过一个迭代循环来逐步完善我们的理解：提出一个简约的模型，用数据对其进行检验，识别其系统性偏差（[证伪](@entry_id:260896)），然后有针对性地增加复杂性以解决这些偏差，形成一个更完善的模型，并重复这个循环。

 这种自下而上的方法，将复杂性直接导向未解决的差异，确保了模型的发展是有目的、有根据且可检验的。此外，一个设计良好的模型层次结构还能揭示**尺度鲁棒性（scale-robust）**的预测。如果一个预测在层次结构的不同层级中都持续存在，那么它很可能是一个**[涌现约束](@entry_id:189677)（emergent constraint）**，即不依赖于模型具体细节的系统基本属性。当这种[不变性](@entry_id:140168)在某个层级上被破坏时，这种失败本身就是一种[信息量](@entry_id:272315)极大的证伪，它能帮助我们将结构性错误定位到不同层级之间引入的特定机制上。

在贝叶斯统计的视角下，这一过程可以通过比较不同层级模型的**[边际似然](@entry_id:636856)（marginal likelihood）**来形式化。[边际似然](@entry_id:636856)自然地平衡了数据拟合优度与模型复杂性（通过惩罚更大的参数空间），从而实现了“[贝叶斯奥卡姆剃刀](@entry_id:196552)”。一个层次结构因此成为了一种操作化的简约性工具，它只在数据强烈要求时才允许引入新的机制，从而为在独立测试中进行决定性的证伪提供了更多机会 。

### 构建层次结构的机制

构建一个科学上有用的模型层次结构，依赖于几种关键的机制，这些机制确保了不同模型之间的联系是系统性的、可追溯的。

#### 基于[无量纲参数](@entry_id:169335)的系统简化

物理学的一个核心工具是**量纲分析（dimensional analysis）**和**尺度分析（scale analysis）**。通过将控制方程无量纲化，我们可以识别出控制系统行为的关键无量纲参数。这些参数通常表示不同物理过程速率或时间尺度的比值。

以一个流体中反应性示踪剂的守恒为例，其浓度 $c(\mathbf{x},t)$ 的演化由一个[平流-扩散-反应方程](@entry_id:156456)描述：
$$
\frac{\partial c}{\partial t} + \mathbf{u}\cdot\nabla c = \kappa \nabla^2 c + R(c)
$$
其中 $\mathbf{u}$ 是速度场，$\kappa$ 是扩散系数，$R(c)$ 是反应项。通过引入特征长度 $L$、速度 $U$ 和[反应速率](@entry_id:185114) $k$，我们可以定义如**佩克莱数（Péclet number）** $Pe = UL/\kappa$（平流与扩散速率之比）和**丹姆科勒数（Damköhler number）** $Da = k L^2/\kappa$（反应与[扩散时间尺度](@entry_id:264558)之比）等[无量纲数](@entry_id:260863)。

一个模型层次结构可以通过考察这些无量纲参数的**渐近极限（asymptotic limits）**来构建 。
-   当 $Pe \ll 1$ 时，平流过程相对于扩散可以忽略不计，完整的方程简化为一个更简单的[反应-扩散模型](@entry_id:271512)。
-   当 $Da \ll 1$ 时，反应过程非常缓慢，方程简化为一个被动示踪剂的平流-扩散模型。

这些简化模型不是随意选择的，而是从一个共同的“父模型”通过严谨的数学程序派生出来的。[无量纲参数](@entry_id:169335)（如 $Pe$ 或一个通用的小参数 $\epsilon$）充当了层次结构的**排序原则（ordering principle）**。这种方法的认识论价值是巨大的：它允许我们**隔离机制**，理解每个过程的独立贡献；它确保了不同模型间的差异具有**可追溯的归因**；并且，它提供了一种探索**结构不确定性**的方法，即模型对包含或排除某些过程的敏感性 。

#### 基于时间尺度分离的简化

许多地球系统过程发生在截然不同的时间尺度上。例如，大气的热力调整（几天）远快于[海洋混合层](@entry_id:1129065)的热力响应（数月到数年），而海洋深层的调整则需要数百年。这种**[时间尺度分离](@entry_id:149780)（timescale separation）**是构建模型层次结构的另一个强大机制。

当一个系统由快、慢两个子系统耦合而成时，我们可以利用这一点来简化模型。考虑一个简化的耦合海洋-大气柱模型 。[海洋混合层](@entry_id:1129065)温度异常 $T_o$ 的演化由其巨大的热容 $C_o$ 决定，而大气温度异常 $T_a$ 则遵循一个具有短[弛豫时间](@entry_id:191572) $\tau_a$ 的牛顿冷却过程。
$$
C_o \,\frac{d T_o}{d t} \;=\; -\lambda_o\, T_o \;+\; \gamma\, T_a \;+\; S_o
$$
$$
\tau_a \,\frac{d T_a}{d t} \;=\; -T_a \;+\; \alpha\, T_o \;+\; S_a
$$
我们可以计算出海洋的特征时间尺度 $\tau_o = C_o/\lambda_o$。使用典型的物理参数，我们可能发现 $\tau_o$ 约为 $59$ 天，而 $\tau_a$ 仅为 $5$ 天。这使得时间尺度比值 $\varepsilon = \tau_a/\tau_o \approx 0.084 \ll 1$ 。

由于 $\varepsilon$ 是一个小参数，我们可以进行**[奇异摄动](@entry_id:170303)分析（singular perturbation analysis）**。在极限 $\varepsilon \to 0$ 下，大气方程的左侧（时间导数项）趋于零。这意味着快速变化的大气分量 $T_a$ 几乎瞬时地调整到与慢速变化的海洋分量 $T_o$ [相平衡](@entry_id:136822)的状态。
$$
0 \approx -T_a + \alpha\, T_o + S_a \quad \implies \quad T_a = \alpha\, T_o + S_a
$$
我们将这个关系称为**依附（slaving）**关系：快速变量 $T_a$ 被“依附”于慢速变量 $T_o$。将这个代数关系代入慢速变量的方程中，我们就得到了一个只包含慢速变量的、简化的**降阶模型（reduced-order model）**：
$$
C_o \frac{d T_o}{d t} = -(\lambda_o - \gamma\alpha) T_o + (\gamma S_a + S_o)
$$
这个[降阶模型](@entry_id:754172)构成了层次结构的下一层。它极大地降低了计算成本，并清晰地揭示了快速过程（通过参数 $\alpha$ 和 $\gamma$）如何有效地修正慢速过程的动力学（改变了有效的阻尼和强迫）。通过求解这个简化方程的[平衡态](@entry_id:270364)，我们可以直接估算系统的长期响应，例如，[平衡态](@entry_id:270364)海洋温度异常为 $T_o^{\mathrm{eq}} = \frac{\gamma S_a + S_o}{\lambda_o - \gamma\alpha}$，一个使用典型参数可以计算出的具体数值 。

#### 基于过程增量的因果归因

除了数学上的简化，模型层次结构的一个关键应用是通过**渐进式复杂性（progressive complexity）**来隔离因果效应。这种方法要求我们从一个极简模型开始，每次只增加一个物理过程，同时保持其他所有方面（如[参数化](@entry_id:265163)方案、数值方法、边界条件）固定。

假设我们的任务是探究陆地[表面反照率](@entry_id:1132663)增加（$\Delta \alpha > 0$）对区域季风降水 $P$ 和温度 $T_s$ 的因果影响 。一个设计精良的层次结构实验将如下进行：

-   **层级 0 (L0)：零维[能量平衡模型](@entry_id:195903) (0D-EBM)**。该模型只包含全[球平均](@entry_id:165984)的能量守恒。它用于量化[反照率](@entry_id:188373)变化 $\Delta \alpha$ 导致的初始[行星能量收支](@entry_id:186042)变化，即顶层大气（TOA）的辐射强迫。这隔离了最直接的[辐射效应](@entry_id:148987)。

-   **层级 1 (L1)：单柱[辐射-对流平衡](@entry_id:1130504)模型 (1D-RCE)**。该模型在一个垂直气柱中引入了辐射传输和对流过程，但没有水平运动。通过在L1中施加 $\Delta \alpha$，我们可以研究局地[热力学](@entry_id:172368)响应，即[地表能量收支](@entry_id:1132675)变化如何直接改变对流和降水，而没有大尺度环流的干扰。

-   **层级 2 (L2)：三维大气环流模型 (3D-AGCM)**。该模型引入了水平方向的能量和水汽输送，但[海表温度](@entry_id:1131347)（SST）通常被设定为固定值。这允许我们研究“快速”的大气响应，包括环流变化如何重新分配能量和水汽，从而影响区域气候，但排除了缓慢的海洋反馈。

-   **层级 3 (L3)：耦合混合层海洋的环流模型**。在这一层，我们允许海洋表层温度响应大气变化，从而引入了[热力学](@entry_id:172368)上的海洋反馈。

-   **层级 4 (L4)：完全耦合的[地球系统模型 (ESM)](@entry_id:1124101)**。最后，我们引入了完整的动态海洋和海冰等其他分量，以包含所有主要的反馈过程。

在整个层次结构中，我们使用基于相同守恒定律（能量和水汽收支）的通用诊断方法。通过比较相邻层级之间对 $\Delta \alpha$ 响应的差异，我们可以清晰地将响应的特定部分归因于新引入的过程（例如，L2与L1的差异揭示了水平输送的作用，L3与L2的差异揭示了海洋热力反馈的作用）。这种“一次改变一件事”的严谨方法是进行可靠因果归因的黄金标准 。

#### 基于空间平均和滤波的[湍流建模](@entry_id:151192)

地球系统充满了[湍流](@entry_id:151300)，从大气边界层到海洋涡旋。在任何一个[计算网格](@entry_id:168560)尺度大于[湍流](@entry_id:151300)最小尺度的模型中，我们都必须对未解析的**次网格尺度（subgrid-scale）**运动进行**[参数化](@entry_id:265163)**。[湍流建模](@entry_id:151192)本身就构成了一个重要的模型层次结构，它为[地球系统模型](@entry_id:1124096)（ESM）中的[参数化](@entry_id:265163)方案提供了理论和数据基础 。

-   **[直接数值模拟](@entry_id:149543) (Direct Numerical Simulation, DNS)**：位于层次结构的顶端。DNS直接求解[流体动力](@entry_id:750449)学的Navier-Stokes方程，解析从最大的能量涡到最小的耗散涡（[Kolmogorov尺度](@entry_id:270763)）的所有运动尺度。由于其极高的计算成本，DNS仅限于低雷诺数和简单几何形状。其认识论作用是作为“数值实验”或“计算真理”，为[湍流理论](@entry_id:264896)和更简化模型的闭合假设提供最基础的检验基准。

-   **大涡模拟 (Large Eddy Simulation, LES)**：位于中间层次。LES通过对控制方程进行[空间滤波](@entry_id:202429)，将流场分离为可解析的大尺度涡和需要建模的[次网格尺度](@entry_id:1132591)（SGS）涡。LES明确解析了携带大部分能量的大涡，而对更具普适性的小尺度涡进行建模。其计算成本远低于DNS，使其能够模拟更高雷诺数和更复杂的情形。LES是开发和测试ESM[参数化](@entry_id:265163)方案的关键工具，因为它能明确地研究[湍流统计](@entry_id:200093)量对滤波尺度（即模型网格大小 $\Delta$）的依赖性，从而帮助开发**尺度感知（scale-aware）**的[参数化](@entry_id:265163)方案。

-   **[雷诺平均](@entry_id:754341)[Navier-Stokes](@entry_id:276387) (Reynolds-Averaged Navier–Stokes, RANS)**：位于层次结构的底端。RANS对Navier-Stokes方程进行时间或系综平均，从而将所有[湍流](@entry_id:151300)脉动从解中滤除，只求解平均流场。这个平均过程引入了未闭合的**雷诺应力（Reynolds stress）**项，它代表了[湍流](@entry_id:151300)脉动对平均动量的输运。整个[湍流](@entry_id:151300)效应都必须通过一个“闭合模型”（如涡粘模型）来[参数化](@entry_id:265163)。RANS是计算上最廉价的方法，使其能够快速探索广阔的[参数空间](@entry_id:178581)和不同的流动状态。它在ESM[参数化](@entry_id:265163)发展中的作用是评估一个方案在各种环境条件下的稳健性和普适性。

这个从DNS到LES再到RANS的层次结构，体现了在物理保真度与计算可行性之间的一种权衡，并为构建和验证必须在粗糙网格上运行的ESM[参数化](@entry_id:265163)方案提供了不可或缺的多尺度信息 。

### 在层次结构中导航：不确定性与诠释

构建了模型层次结构之后，我们需要工具和概念来分析和诠释它。这包括如何量化模型的复杂性，以及如何理解和处理不同类型的不确定性。

#### 量化复杂性及其对诠释和推断的影响

一个模型在层次结构中的位置通常与其“复杂性”相关。我们可以通过定义一个**排序准则（ordering criterion）**来形式化这一概念 。一个综合的复杂度指标 $O(M_i)$ 可以是模型 $M_i$ 多个属性的函数，例如：
-   $S_i$：预报[状态变量](@entry_id:138790)的数量。
-   $P_i$：[次网格参数化](@entry_id:1132597)方案的数量。
-   $h_i$：网格间距（分辨率的倒数）。

一个合理的复杂度指标 $O(M_i)$ 应该是 $S_i$ 和 $P_i$ 的增函数，以及 $h_i$ 的减函数（即分辨率的增函数）。例如，我们可以定义一个无量纲的加权和：
$$
O(M_i) = w_S \frac{S_i}{\max_j S_j} + w_\rho \frac{1/h_i}{\max_j (1/h_j)} + w_P \frac{P_i}{\max_j P_j}
$$
其中权重 $w_S, w_\rho, w_P$ 反映了不同复杂度维度的相对重要性。

模型复杂性的增加对**可诠释性（interpretability）**和**[统计推断](@entry_id:172747)（statistical inference）**有着深远的影响 。
-   **可诠释性**：随着模型复杂度的增加（更多的[状态变量](@entry_id:138790)、[参数化](@entry_id:265163)和更精细的分辨率），模型内部的自由度和相互作用呈爆炸性增长。这使得将模型的特定输出归因于特定机制变得越来越困难，从而降低了模型的可诠释性。一个简单的模型可能在物理上是“错误”的，但其因果链条是清晰的；一个复杂的模型可能更“正确”，但其内部工作机制可能变得像一个黑箱。

-   **[统计推断](@entry_id:172747)**：在固定的观测数据预算下，增加模型复杂性会导致经典的**偏倚-方差权衡（bias-variance tradeoff）**。一个更复杂的模型可能因为包含了更多真实过程而具有更低的**偏倚（bias）**，但由于需要从有限的数据中估计更多的参数或状态，其参数估计的**方差（variance）**会增加。这被称为“维数灾难”。从统计学角度看，信息被“稀释”了。**[克拉默-拉奥下界](@entry_id:154412)（Cramér–Rao Lower Bound）**和像**赤池信息准则（AIC）**这样的模型选择标准都表明，除非增加的复杂性能从数据中提取出显著更多的信息（例如，更高的分辨率极大地增强了模型对参数的敏感性），否则参数的**可识别性（identifiability）**会减弱，估计的不确定性会增大。

#### 结构不确定性与异参同效

模型层次结构的存在本身就突显了一种深刻的不确定性来源：**结构不确定性（structural uncertainty）**。这指的是我们对系统正确数学表达形式的不确定性，例如，一个过程应该用哪种函数形式来表示。

这常常导致**异参同效（equifinality）**问题，即在给定的有限观测数据下，多个不同的模型结构和参数组合可以同样好地拟合数据 。考虑一个简单的碳箱模型，$dC/dt = I - R(C)$，其中 $C$ 是碳储量，$I$ 是输入，$R(C)$ 是[呼吸作用](@entry_id:906901)。假设我们只有一个[稳态](@entry_id:139253)观测数据：当输入 $I=10$ 时，系统达到平衡储量 $C^*=100$。这意味着任何有效的模型都必须满足 $R(100)=10$。

-   **模型1（线性）**：$R(C) = kC$。要满足观测，必须有 $k \times 100 = 10$，这唯一地确定了 $k=0.1$。
-   **模型2（饱和型）**：$R(C) = \frac{V_{\max}C}{K_m + C}$。要满足观测，需要 $\frac{V_{\max} \times 100}{K_m + 100} = 10$。这是一个有两个未知数（$V_{\max}, K_m$）的方程，它有无穷多组解。例如，$V_{\max}=20, K_m=100$ 是一组解；$V_{\max}=40, K_m=300$ 也是一组解 。

这两个结构在拟合[稳态](@entry_id:139253)数据方面是等效的，但它们的动态行为可能完全不同。一个模型的[瞬态响应](@entry_id:165150)（即它从扰动中恢复的速度）由导数 $dR/dC$ 决定。对于线性模型，$dR/dC = k = 0.1$。对于饱和型模型，使用 $V_{\max}=20, K_m=100$ 这组参数，在 $C=100$ 处的斜率为 $dR/dC = 0.05$。它们对扰动的响应时间会相差一倍。

这个例子说明，增加结构复杂性（从1个参数的[线性模型](@entry_id:178302)到2个参数的[饱和模型](@entry_id:150782)）并不能消除、反而可能加剧异参同效。解决异参同效的唯一方法是引入新的、能够区分不同模型预测的观测数据。在这个例子中，一个测量系统对小扰动响应速率的**瞬态实验**，就可以约束 $dR/dC$ 的值，从而帮助我们区分这两种模型结构 。

#### 认知不确定性与[偶然不确定性](@entry_id:634772)

在模型层次结构的任何一个层级，预测的不确定性都可以分为两种[基本类](@entry_id:158335)型 ：

-   **认知不确定性（Epistemic Uncertainty）**：源于我们知识的缺乏。这包括对模型参数（如[气候敏感度](@entry_id:156628)）的不确定性和对模型结构本身（如前述的$R(C)$形式）的不确定性。原则上，认知不确定性是**可约减的**——通过更多的观测数据、更好的实验或更完善的理论，我们可以减少这种不确定性。

-   **[偶然不确定性](@entry_id:634772)（Aleatory Uncertainty）**：源于系统内在的、不可预测的随机性。在气候系统中，这通常指**内部变率（internal variability）**，例如，即使在完全相同的外部强迫和模型参数下，由于[混沌动力学](@entry_id:142566)和随机的天气事件，每次模拟的[长期演化](@entry_id:158486)路径也会有所不同。[偶然不确定性](@entry_id:634772)是**不可约减的**——即使我们拥有完美的模型和参数知识，这种不确定性依然存在。

我们可以使用**[全方差公式](@entry_id:177482)（Law of Total Variance）**来定量分离这两种不确定性。假设一个预测量 $Y$ 依赖于一个不确定的参数 $\theta$。总预测方差为：
$$
\mathrm{Var}(Y) = \mathbb{E}[\mathrm{Var}(Y|\theta)] + \mathrm{Var}(\mathbb{E}[Y|\theta])
$$
-   第一项 $\mathbb{E}[\mathrm{Var}(Y|\theta)]$ 是在参数 $\theta$ 已知情况下的方差的[期望值](@entry_id:150961)。这代表了系统的内在随机性，即**偶然方差**。
-   第二项 $\mathrm{Var}(\mathbb{E}[Y|\theta])$ 是由于我们对参数 $\theta$ 的不确定性而导致的预测[期望值](@entry_id:150961)的方差。这代表了知识缺乏带来的不确定性，即**认知方差**。

有趣的是，当我们在模型层次结构中从简单模型走向复杂模型时，这两种不确定性的相对贡献通常会发生系统性变化 。一个简单的能量平衡模型（EBM）可能几乎没有内部变率（[偶然不确定性](@entry_id:634772)低），但其高度简化的参数（如[气候敏感度](@entry_id:156628)）可能具有很大的不确定性（认知不确定性高）。相比之下，一个复杂的[地球系统模型](@entry_id:1124096)（GCM）能够明确地模拟天气系统和海洋涡旋，因此具有显著的内部变率（[偶然不确定性](@entry_id:634772)高），但由于其包含了更详细的物理过程，某些关键参数可能被数据更好地约束，从而可能减少了认知不确定性。因此，沿着模型层次结构向上移动，我们常常会看到总不确定性中，认知不确定性的占比下降，而[偶然不确定性](@entry_id:634772)的占比上升。

### 现代建模工作流

模型层次结构不仅是一个理论概念，它还深刻地塑造了现代地球[系统建模](@entry_id:197208)的实践工作流。

#### 代理模型与模拟器

层次结构顶端的模型（如高分辨率ESM）通常计算成本极高，使得进行大规模参数校准、不确定性量化或敏感性分析变得不切实际。为了解决这个问题，我们常常为这些昂贵的**机理模型（mechanistic models）**构建**代理模型（surrogate models）**或**模拟器（emulators）** 。

一个机理模型 $M_{\text{mech}}$ 是一个基于物理守恒定律的模拟器，它将一组输入 $\mathbf{u}$（如参数、边界条件）映射到一组输出 $\mathbf{y}$。一个代理模型 $M_{\text{sur}}$ 则是一个廉价的、通常是数据驱动的（如神经网络、高斯过程）模型，它通过在 $M_{\text{mech}}$ 的少量输入-输出样本上进行训练，来学习和模仿这个映射关系 $\mathbf{u} \mapsto \mathbf{y}$。

-   **代理模型**通常指一个确定性的近似，即给定一个输入，它返回一个单一的预测输出。
-   **模拟器**通常指一个**概率性**的代理模型，它不仅返回一个预测值，还返回一个关于该预测的概率分布。这个分布量化了模拟器自身因训练数据有限而产生的不确定性（一种认知不确定性）。

从认识论上讲，代理模型和模拟器是**工具性**的。它们是机理模型的快速预测工具，但它们本身并不包含物理定律或因果结构。解释性的权力仍然掌握在机理模型 $M_{\text{mech}}$ 手中。仅仅因为一个神经网络能够完美地复制一个气候模型的输出，并不意味着这个神经网络就“理解”了气候物理 。

#### 验证、确认与证伪

最后，一个严谨的、基于层次结构的建模项目必须遵循一个清晰的测试和评估协议，该协议严格区分三个关键活动：**验证（Verification）**、**确认（Validation）**和**证伪（Falsification）** 。

-   **验证 (Verification)**：回答“我们是否正确地求解了方程？”这是一个关于模型代码和数值实现的内部检查。它包括单元测试、与解析解或制造解方法的比较以[检验数](@entry_id:173345)值[收敛阶](@entry_id:146394)，以及在封闭系统中检查质量和能量等[守恒量](@entry_id:161475)的精确保持。

-   **确认 (Validation)**：回答“我们是否求解了正确的方程？”这是一个将模型输出与真实世界观测进行比较的外部检查。关键在于，用于确认的数据必须独立于用于[模型校准](@entry_id:146456)（参数估计）的数据。这可以[防止过拟合](@entry_id:635166)，并真实地评估模型的泛化预测能力。

-   **[证伪](@entry_id:260896) (Falsification)**：这是一个更严格的测试，旨在主动寻找模型的“[断裂点](@entry_id:157497)”。它涉及用模型已经通过确认的数据集之外的“严峻测试”来挑战模型。这些测试可能包括极端事件、模型未被校准去拟合的涌现关系，或长期的气候变化响应。证伪的成功（即模型的失败）是科学进步的关键，因为它暴露了模型结构中需要改进的根本缺陷。

一个逻辑自洽的协议必须是**自下而上**的 。我们首先在最基础的层级（例如，一个叶片[光合作用模型](@entry_id:1129634)L0）进行验证、确认和证伪。从L0中获得的参数及其不确定性随后被**向上传播**到更高层级（例如，一个单柱陆面模型L1）。在L1，我们再次执行验证、确认和证伪的完整循环，但任何参数调整都应被限制在从L0传播上来的不确定性范围内，除非在L1层级发现了明确的结构性失败。这个过程一直持续到最高层级（如全球ESM，L2）。这种结构化的方法确保了整个层次结构的科学完整性，防止了在更高层级用参数“调优”来掩盖低层级根本性错误的恶习，从而构建出真正可靠和可信的科学知识。