{
    "hands_on_practices": [
        {
            "introduction": "许多地球系统模型的核心是简化的动态系统，例如箱式模型。本练习 () 将通过分析一个基本的陆地碳库模型，帮助您巩固状态变量、参数和外部强迫的定义。通过求解这个模型，您将亲身体验系统如何响应外部变化，并理解其内在的时间尺度是如何由模型参数决定的。",
            "id": "3915326",
            "problem": "一个陆地碳库用一个储量为 $C(t)$ 的单一、充分混合的箱室来表示，其中 $t$ 表示时间。碳储量的演变遵循质量守恒定律，即储量的变化率等于输入减去输出：$\\dot{C}(t)=\\text{inputs}(t)-\\text{outputs}(t)$。假设输出通量与当前储量成正比，比例常数为 $k>0$，输入是一个外部规定的强迫 $F(t)$。因此，其控制常微分方程（ODE）为\n$$\n\\dot{C}(t)=-k\\,C(t)+F(t).\n$$\n在状态空间模型的框架内解释这个ODE。具体来说：\n- 识别哪个量是状态变量，哪些量是参数，哪些是外源强迫，并使用ODE的结构和量纲分析来证明你的识别。假设 $C$ 的单位是质量（例如，千兆吨碳），$t$ 的单位是时间（例如，年），$F$ 的单位是质量/时间。\n- 对于在时间 $t=0$ 施加的常数大小为 $F_{0}$ 的阶跃强迫，即，对于 $t\\ge 0$ 有 $F(t)=F_{0}$，且初始条件为 $C(0)=C_{i}$，请仅使用质量守恒和标准微积分，从第一性原理出发，推导 $t\\ge 0$ 时 $C(t)$ 的解析表达式，而不要使用任何预先记忆的解法模板。\n\n将 $C(t)$ 的最终表达式报告为关于 $t$、$C_{i}$、$k$ 和 $F_{0}$ 的闭式解析函数。在最终的方框答案中不要包含单位。如果你得到任何极限值，不要报告它们；只需报告 $C(t)$ 的完整表达式。",
            "solution": "问题陈述被评估为有效。它提出了一个基于地球系统科学中使用的基本箱室模型方法的标准、适定的初值问题。该问题具有科学依据，内容自洽，没有矛盾或歧义。\n\n该问题要求完成两项任务：首先，在状态空间模型的框架内解释控制常微分方程（ODE）的各个组成部分；其次，在特定强迫情景下推导碳储量 $C(t)$ 的解析解。\n\n**第1部分：ODE各组成部分的解释**\n\n控制ODE如下：\n$$\n\\dot{C}(t) = -k\\,C(t) + F(t)\n$$\n其中 $\\dot{C}(t)$ 表示时间导数 $\\frac{dC}{dt}$。\n\n**状态变量：**\n动态系统的状态变量是在给定时间 $t$ 的值能完全确定系统状态的量。其未来的演变仅取决于其当前值以及在大于 $t$ 的时间内的任何外部输入（强迫）。在给定的ODE中，碳储量的变化率 $\\dot{C}(t)$ 是储量本身 $C(t)$ 和外部输入 $F(t)$ 的函数。在任何时间 $t_0$ 知道 $C(t)$ 的值，以及对于 $t \\ge t_0$ 的函数 $F(t)$，就足以确定碳储量的整个未来轨迹。因此，$C(t)$ 是系统的状态变量。\n\n**参数：**\n参数是模型中定义系统固有结构和行为的常数。它们不是时间的函数，也不依赖于状态变量。在方程中，$k$ 是一个正常数，它决定了输出通量相对于储量大小的速率。它代表了碳库的固有属性，例如特征衰减率或周转率，并且不随时间或 $C$ 的值而改变。因此，$k$ 是一个参数。在 $F(t) = F_0$ 的特定情况下，常数 $F_0$ 也是一个定义恒定强迫大小的参数。初始条件 $C_i$ 是用于寻找特解的状态变量的特定值，而不是系统动力学本身的参数。\n\n**外源强迫：**\n外源强迫是驱动系统演变的外部输入，但其本身不受系统状态的影响。在ODE的一般形式中，$F(t)$ 代表进入碳库的碳输入通量。它的值是外部规定的，并且独立于 $C(t)$。因此，$F(t)$ 是外源强迫。对于待求解的特定问题，该强迫采用常数阶跃函数的形式，即对于 $t \\ge 0$ 有 $F(t) = F_0$。\n\n**量纲分析证明：**\n给定的单位是：$[C] = M$ (质量)，$[t] = T$ (时间)，以及 $[F] = M \\cdot T^{-1}$ (质量/时间)。\nODE 为 $\\dot{C} = -kC + F$。为了量纲一致性，该方程中的每一项都必须具有相同的单位。\n$\\dot{C} = \\frac{dC}{dt}$ 项的单位是 $\\frac{[C]}{[t]} = M \\cdot T^{-1}$。\n强迫项 $F$ 给定的单位是 $M \\cdot T^{-1}$，这是一致的。\n$-kC$ 项也必须具有 $M \\cdot T^{-1}$ 的单位。由于 $C$ 的单位是 $M$，参数 $k$ 的单位必须是 $\\frac{M \\cdot T^{-1}}{M} = T^{-1}$。一个单位为时间倒数的参数代表一个速率常数，这与其作为定义碳库动力学内在时间尺度（其滞留时间为 $\\frac{1}{k}$）的参数的角色是一致的。\n\n**第2部分：解析解的推导**\n\n该问题要求解决由以下定义的初值问题：\n$$\n\\frac{dC}{dt} = -k\\,C(t) + F_0, \\quad C(0) = C_i\n$$\n这是一个一阶线性非齐次ODE。我们被要求从第一性原理推导解。我们将使用积分因子法。\n\n首先，将ODE重排为标准线性形式：\n$$\n\\frac{dC}{dt} + k\\,C(t) = F_0\n$$\n积分因子（我们记为 $\\mu(t)$）是一个函数，当方程两边都乘以它时，左边就变成了一个单一乘积法则求导的结果。对于形如 $y' + p(t)y = q(t)$ 的方程，其积分因子为 $\\mu(t) = \\exp\\left(\\int p(t) dt\\right)$。在我们的例子中，$p(t) = k$，是一个常数。\n所以，积分因子是：\n$$\n\\mu(t) = \\exp\\left(\\int k \\, dt\\right) = \\exp(kt)\n$$\n我们可以省略积分常数，因为积分因子的任何非零倍数也是一个积分因子。\n\n现在，将整个ODE乘以 $\\mu(t) = \\exp(kt)$：\n$$\n\\exp(kt)\\frac{dC}{dt} + k\\exp(kt)C(t) = F_0\\exp(kt)\n$$\n根据构造，左边现在是乘积 $C(t)\\mu(t)$ 的导数：\n$$\n\\frac{d}{dt}\\left( C(t)\\exp(kt) \\right) = F_0\\exp(kt)\n$$\n为了求解 $C(t)$，我们将两边对时间从 $0$ 积分到 $t$：\n$$\n\\int_0^t \\frac{d}{d\\tau}\\left( C(\\tau)\\exp(k\\tau) \\right) d\\tau = \\int_0^t F_0\\exp(k\\tau) d\\tau\n$$\n对左边应用微积分基本定理：\n$$\n\\left[ C(\\tau)\\exp(k\\tau) \\right]_0^t = F_0 \\int_0^t \\exp(k\\tau) d\\tau\n$$\n$$\nC(t)\\exp(kt) - C(0)\\exp(k \\cdot 0) = F_0 \\left[ \\frac{1}{k}\\exp(k\\tau) \\right]_0^t\n$$\n代入初始条件 $C(0) = C_i$ 和 $\\exp(0) = 1$：\n$$\nC(t)\\exp(kt) - C_i = \\frac{F_0}{k} \\left( \\exp(kt) - \\exp(0) \\right)\n$$\n$$\nC(t)\\exp(kt) - C_i = \\frac{F_0}{k} \\left( \\exp(kt) - 1 \\right)\n$$\n现在，我们求解 $C(t)$。首先，两边都加上 $C_i$：\n$$\nC(t)\\exp(kt) = C_i + \\frac{F_0}{k}\\exp(kt) - \\frac{F_0}{k}\n$$\n最后，将整个方程乘以 $\\exp(-kt)$ 来分离出 $C(t)$：\n$$\nC(t) = C_i\\exp(-kt) + \\frac{F_0}{k}\\exp(kt)\\exp(-kt) - \\frac{F_0}{k}\\exp(-kt)\n$$\n$$\nC(t) = C_i\\exp(-kt) + \\frac{F_0}{k} - \\frac{F_0}{k}\\exp(-kt)\n$$\n将包含 $\\exp(-kt)$ 的项和常数项组合在一起，得到最终表达式：\n$$\nC(t) = \\frac{F_0}{k} + \\left( C_i - \\frac{F_0}{k} \\right) \\exp(-kt)\n$$\n这是对于 $t \\ge 0$ 时碳储量 $C(t)$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{F_{0}}{k} + \\left(C_{i} - \\frac{F_{0}}{k}\\right)\\exp(-kt)}\n$$"
        },
        {
            "introduction": "模型中的参数不仅仅是抽象的数学符号，它们代表着可测量的物理属性。本练习 () 将利用地表能量平衡方程——气候建模的基石——来展示量纲分析的重要性。您将推导出一个关键物理参数（汽化潜热）的单位，并利用观测数据计算其数值，从而将抽象的能量通量与具体的物质通量联系起来。",
            "id": "3915333",
            "problem": "在一个地球系统模型的陆面分量中，地表能量平衡表示为 $R_n = H + LE + G$，其中 $R_n$ 是净辐射，$H$ 是感热通量，$LE$ 是潜热通量，$G$ 是地热通量。为确保量纲一致性，必须将潜热通量与水汽化所需的能量以及地表的水汽质量通量联系起来。\n\n仅从地表能量守恒以及通量和汽化潜热的定义出发，在不使用超出这些定义之外的任何现成公式的情况下，完成以下任务：\n\n- 为 $R_n$、$H$、$LE$ 和 $G$ 指定国际单位制(SI)单位，并推导当蒸发深度速率 $E$ 以 $\\mathrm{mm\\, day^{-1}}$ 表示且液态水密度 $\\rho_w$ 被视为一个参数时，参数 $L_v$ (汽化潜热) 必须具有的SI单位。你的推理应使用 $\\rho_w$ 将 $E$ 明确地转换为单位面积的SI质量通量。\n\n- 在某观测时刻的稳态条件下，测量或采用以下数值：$R_n = 300~\\mathrm{W\\, m^{-2}}$，$H = 70~\\mathrm{W\\, m^{-2}}$，$G = 10~\\mathrm{W\\, m^{-2}}$，$E = 7.80~\\mathrm{mm\\, day^{-1}}$，以及 $\\rho_w = 1000~\\mathrm{kg\\, m^{-3}}$。利用你的量纲推理，计算精确满足 $R_n = H + LE + G$ 的 $L_v$ 的数值。将最终值以兆焦耳每千克 $\\left(\\mathrm{MJ\\, kg^{-1}}\\right)$ 表示，并将答案四舍五入到四位有效数字。\n\n你的最终答案必须是一个实数。",
            "solution": "该问题需要一个基于地表能量守恒原理和基本物理定义的两部分解答。首先，进行量纲分析以推导汽化潜热 $L_v$ 的单位。其次，根据所提供的数据计算 $L_v$ 的数值。\n\n问题陈述了地表能量平衡方程：\n$$R_n = H + LE + G$$\n此处，$R_n$ 是净辐射，$H$ 是感热通量，$LE$ 是潜热通量，$G$ 是地热通量。该方程中的每一项都代表一个能量通量，其定义为单位面积单位时间的能量。在国际单位制(SI)中，能量的单位是焦耳($J$)，面积的单位是平方米($m^2$)，时间的单位是秒($s$)。因此，每个通量项的SI单位是 $\\mathrm{J\\, m^{-2}\\, s^{-1}}$。瓦特($W$)的定义是 $1~\\mathrm{J\\, s^{-1}}$，所以能量通量的单位可以写成 $\\mathrm{W\\, m^{-2}}$。这证实了数值数据给出的单位是通量的标准SI单位。\n\n潜热通量 $LE$ 是与水的相变相关的能量通量。它通过汽化潜热 $L_v$ 与水汽的质量通量（我们将其表示为 $M_E$）相关联。根据定义，$L_v$ 是汽化单位质量物质所需的能量。因此，$L_v$ 的SI单位必须是能量每质量，即 $\\mathrm{J\\, kg^{-1}}$。这些量之间的关系是：\n$$LE = L_v \\cdot M_E$$\n质量通量 $M_E$ 是单位面积单位时间内蒸发的水的质量，其SI单位为 $\\mathrm{kg\\, m^{-2}\\, s^{-1}}$。验证该关系的量纲一致性：\n$$[\\mathrm{J\\, m^{-2}\\, s^{-1}}] = [L_v] \\cdot [\\mathrm{kg\\, m^{-2}\\, s^{-1}}]$$\n解出 $L_v$ 的单位可得：\n$$[L_v] = \\frac{[\\mathrm{J\\, m^{-2}\\, s^{-1}}]}{[\\mathrm{kg\\, m^{-2}\\, s^{-1}}]} = \\mathrm{J\\, kg^{-1}}$$\n这证实了汽化潜热的SI单位。\n\n问题以 $\\mathrm{mm\\, day^{-1}}$ 为单位给出了蒸发速率，这是一个深度速率 $E$，也就是一个速度（长度每时间）。我们必须使用液态水的密度 $\\rho_w$ 将其与质量通量 $M_E$ 联系起来。蒸发速率 $E$ 描述了在时间 $t$ 内从面积 $A$ 上蒸发的水的等效深度 $d$，因此 $E = d/t$。蒸发水的体积是 $V = A \\cdot d$。这部分水的质量 $m$ 由 $m = \\rho_w V = \\rho_w A d$ 给出。质量通量 $M_E$ 是单位面积单位时间的质量：\n$$M_E = \\frac{m}{A \\cdot t} = \\frac{\\rho_w A d}{A t} = \\rho_w \\frac{d}{t} = \\rho_w E$$\n将 $M_E$ 的这个表达式代入 $LE$ 的方程，我们从第一性原理推导出所需的公式：\n$$LE = L_v \\rho_w E$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须计算 $L_v$ 的数值。给定的值为 $R_n = 300~\\mathrm{W\\, m^{-2}}$，$H = 70~\\mathrm{W\\, m^{-2}}$，$G = 10~\\mathrm{W\\, m^{-2}}$，$E = 7.80~\\mathrm{mm\\, day^{-1}}$，以及 $\\rho_w = 1000~\\mathrm{kg\\, m^{-3}}$。\n首先，我们从能量平衡方程中解出 $LE$：\n$$LE = R_n - H - G = 300~\\mathrm{W\\, m^{-2}} - 70~\\mathrm{W\\, m^{-2}} - 10~\\mathrm{W\\, m^{-2}} = 220~\\mathrm{W\\, m^{-2}}$$\n这等价于 $LE = 220~\\mathrm{J\\, s^{-1}\\, m^{-2}}$。\n接下来，我们必须将蒸发速率 $E$ 转换为SI单位($\\mathrm{m\\, s^{-1}}$)。我们使用转换因子 $1~\\mathrm{m} = 1000~\\mathrm{mm}$ 和 $1~\\mathrm{day} = 24 \\times 60 \\times 60 = 86400~\\mathrm{s}$。\n$$E = 7.80~\\frac{\\mathrm{mm}}{\\mathrm{day}} = 7.80 \\times \\frac{10^{-3}~\\mathrm{m}}{86400~\\mathrm{s}} = \\frac{7.80 \\times 10^{-3}}{86400}~\\mathrm{m\\, s^{-1}}$$\n现在，我们重新整理推导出的公式以求解 $L_v$：\n$$L_v = \\frac{LE}{\\rho_w E}$$\n将数值代入其正确的SI单位：\n$$L_v = \\frac{220~\\mathrm{J\\, s^{-1}\\, m^{-2}}}{(1000~\\mathrm{kg\\, m^{-3}}) \\times \\left(\\frac{7.80 \\times 10^{-3}}{86400}~\\mathrm{m\\, s^{-1}}\\right)}$$\n$$L_v = \\frac{220 \\times 86400}{1000 \\times 7.80 \\times 10^{-3}}~\\frac{\\mathrm{J\\, s^{-1}\\, m^{-2}}}{\\mathrm{kg\\, m^{-2}\\, s^{-1}}}$$\n$$L_v = \\frac{19008000}{7.80}~\\mathrm{J\\, kg^{-1}} \\approx 2436923.077~\\mathrm{J\\, kg^{-1}}$$\n问题要求结果以兆焦耳每千克($\\mathrm{MJ\\, kg^{-1}}$)表示，并四舍五入到四位有效数字。由于 $1~\\mathrm{MJ} = 10^6~\\mathrm{J}$，我们将结果除以 $10^6$：\n$$L_v \\approx \\frac{2436923.077}{10^6}~\\mathrm{MJ\\, kg^{-1}} \\approx 2.436923077~\\mathrm{MJ\\, kg^{-1}}$$\n四舍五入到四位有效数字得到：\n$$L_v \\approx 2.437~\\mathrm{MJ\\, kg^{-1}}$$",
            "answer": "$$\\boxed{2.437}$$"
        },
        {
            "introduction": "在实际建模工作中，许多关键参数的数值是未知的，必须通过观测数据进行估计或“校准”。本计算练习 () 将指导您完成一个典型的参数估计任务：使用线性回归方法，从模拟的观测数据中拟合土壤呼吸模型中的温度敏感性参数 $Q_{10}$。更重要的是，您还将学习如何量化估计结果的不确定性，这是严谨科学建模不可或缺的一环。",
            "id": "3915317",
            "problem": "您正在模拟土壤中对温度敏感的异养呼吸，其中一阶过程速率的温度响应由广泛使用的 $Q_{10}$ 定律表示。在此设置中，过程速率参数 $k(T)$ 通过具有两个参数的参数化方法依赖于状态变量 $T$（温度）：基线速率 $k_0$ 和温度敏感性因子 $Q_{10}$。函数形式为\n$$\nk(T) \\;=\\; k_0 \\, Q_{10}^{\\frac{T - 20}{10}},\n$$\n其中 $T$ 是以摄氏度为单位的温度，$k(T)$ 的单位是 $\\mathrm{d}^{-1}$（每天），$k_0$ 的单位是 $\\mathrm{d}^{-1}$（每天），$Q_{10}$ 是无量纲的。将 $k_0$ 和 $Q_{10}$ 视为待校准的参数，并将 $k(T)$ 视为与状态变量 $T$ 相关的参数化速率。\n\n从基本的统计和物理建模基础出发：\n- 上述定律定义了 $k(T)$、$k_0$、$Q_{10}$ 和 $T$ 之间的确定性联系。\n- 假设在温度 $T_i$ 下的速率观测值 $k_{\\mathrm{obs},i}$ 为正，并遵循与对数正态噪声一致的乘性误差，这意味着 $\\ln k_{\\mathrm{obs},i}$ 被建模为具有加性高斯误差的线性回归。\n\n使用这些基础，通过以下步骤从观测值 $\\{(T_i,k_{\\mathrm{obs},i})\\}_{i=1}^n$ 推导出 $Q_{10}$ 及其 $95\\%$ 置信区间的估算程序：\n- 在对数域中转换为一个带截距和斜率的线性模型，其中斜率等于 $\\ln(Q_{10})$，截距等于 $\\ln(k_0)$。\n- 使用普通最小二乘法 (OLS) 拟合转换后的模型。\n- 使用自由度为 $n-2$ 的学生 t 分布为 $\\ln(Q_{10})$ 构建双侧 $95\\%$ 置信区间，然后通过指数函数将该区间映射回 $Q_{10}$。\n\n您的任务是编写一个完整、可运行的程序，为一组固定的测试用例实现此校准。对于每个用例，根据给定的真实参数值和指定的乘性扰动（以模拟测量变异性）确定性地构建观测值，然后执行校准。请使用以下测试套件。\n\n测试套件（每个用例指定温度、真实参数和乘性扰动；构建 $k_{\\mathrm{obs},i} = m_i \\, k_0 \\, Q_{10}^{\\frac{T_i - 20}{10}}$）：\n\n- 用例 A（正常路径，宽温度范围，中等噪声）：\n  - 温度 $T$（摄氏度）：$[5,10,15,20,25,30]$。\n  - 真实基线 $k_0$：$0.5 \\;\\mathrm{d}^{-1}$。\n  - 真实 $Q_{10}$：$2.1$。\n  - 乘数 $m$：$[0.98, 1.03, 1.01, 1.00, 0.97, 1.02]$。\n\n- 用例 B（边界条件，近等温数据，斜率可识别性弱）：\n  - 温度 $T$（摄氏度）：$[19.5,20.0,20.5]$。\n  - 真实基线 $k_0$：$0.8 \\;\\mathrm{d}^{-1}$。\n  - 真实 $Q_{10}$：$2.0$。\n  - 乘数 $m$：$[1.00, 1.02, 0.99]$。\n\n- 用例 C（边缘情况，宽温度范围，伴有类似离群值的扰动）：\n  - 温度 $T$（摄氏度）：$[0.0,10.0,20.0,30.0]$。\n  - 真实基线 $k_0$：$1.0 \\;\\mathrm{d}^{-1}$。\n  - 真实 $Q_{10}$：$1.4$。\n  - 乘数 $m$：$[1.10, 0.90, 1.25, 0.85]$。\n\n实现要求：\n- 对于每个用例，构建设计变量 $x_i = \\frac{T_i - 20}{10}$ 和响应 $y_i = \\ln(k_{\\mathrm{obs},i})$。通过普通最小二乘法拟合线性模型 $y_i = a + b x_i + \\varepsilon_i$，其中 $a = \\ln(k_0)$，$b = \\ln(Q_{10})$，$\\varepsilon_i$ 是均值为零、方差为 $\\sigma^2$ 的独立同分布高斯误差。\n- 使用基于残差方差估计 $\\hat{\\sigma}^2$ 和 $(X^\\top X)^{-1}$ 的常用公式计算 OLS 估计值 $\\hat{b}$ 及其标准误 $\\mathrm{SE}(\\hat{b})$，其中 $X$ 是由一列 1 和一列 $x_i$ 组成的设计矩阵。\n- 构建 $b$ 的双侧 $95\\%$ 置信区间，形式为 $\\hat{b} \\pm t_{1-\\alpha/2,\\nu} \\,\\mathrm{SE}(\\hat{b})$，其中 $\\alpha = 0.05$ 且 $\\nu = n-2$，$t_{1-\\alpha/2,\\nu}$ 是学生 t 分布的临界值。\n- 通过取指数将此区间转换为 $Q_{10}$ 的区间，得到 $[\\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}] = [\\exp(\\hat{b}_{\\mathrm{lo}}), \\exp(\\hat{b}_{\\mathrm{hi}})]$，并计算点估计值 $\\widehat{Q}_{10} = \\exp(\\hat{b})$。\n\n物理和数值单位：\n- 温度 $T$ 以摄氏度为单位。\n- 速率 $k$ 和 $k_0$ 以 $\\mathrm{d}^{-1}$ 为单位。\n- 输出 $\\widehat{Q}_{10}$ 及其置信界限是无量纲的。\n- 不涉及角度单位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有用例的结果，形式为列表的列表。对于每个用例，输出一个包含 $[\\widehat{Q}_{10}, \\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}]$ 的三元素列表。\n- 所有浮点数必须四舍五入到小数点后恰好 $6$ 位。\n- 整体输出必须是单行，格式完全如下：\n  - 示例结构：$[[q_{A},q_{A,\\mathrm{lo}},q_{A,\\mathrm{hi}}],[q_{B},q_{B,\\mathrm{lo}},q_{B,\\mathrm{hi}}],[q_{C},q_{C,\\mathrm{lo}},q_{C,\\mathrm{hi}}]]$，\n  不含多余空格或文本。\n\n您的程序必须是自包含的，不需要任何输入，并遵守指定的执行环境。",
            "solution": "我们从一阶过程速率的机理温度响应开始，\n$$\nk(T) = k_0 \\, Q_{10}^{\\frac{T-20}{10}},\n$$\n其中 $T$ 是温度，$k_0$ 是在 $T=20\\,^{\\circ}\\mathrm{C}$ 时的基线速率，$Q_{10}$ 是当 $T$ 增加 $10\\,^{\\circ}\\mathrm{C}$ 时速率增加的无量纲因子。在环境和地球系统建模中，$k_0$ 和 $Q_{10}$ 是参数，而 $T$ 是由模型测量或模拟的状态变量。假设在温度 $T_i$ 下的观测速率 $k_{\\mathrm{obs},i}$ 为正，并且通常使用与对数正态噪声一致的乘性误差进行建模。\n\n为了利用线性回归，对两边取自然对数：\n$$\n\\ln k(T) = \\ln k_0 + \\left(\\frac{T - 20}{10}\\right)\\ln Q_{10}.\n$$\n定义 $x_i = \\frac{T_i - 20}{10}$ 和 $y_i = \\ln k_{\\mathrm{obs},i}$。那么\n$$\ny_i = a + b x_i + \\varepsilon_i,\n$$\n其中 $a = \\ln k_0$，$b = \\ln Q_{10}$，且 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 独立同分布，这是一个标准的线性模型。普通最小二乘 (OLS) 估计量最小化 $\\sum_i (y_i - a - b x_i)^2$。使用设计矩阵\n$$\nX = \\begin{bmatrix}\n1  x_1\\\\\n\\vdots  \\vdots\\\\\n1  x_n\n\\end{bmatrix}, \\quad\ny = \\begin{bmatrix}\ny_1\\\\\n\\vdots\\\\\ny_n\n\\end{bmatrix},\n$$\nOLS 估计为\n$$\n\\hat{\\beta} = \\begin{bmatrix}\\hat{a}\\\\ \\hat{b}\\end{bmatrix} = (X^\\top X)^{-1} X^\\top y.\n$$\n残差为 $r = y - X \\hat{\\beta}$，无偏残差方差估计为\n$$\n\\hat{\\sigma}^2 = \\frac{r^\\top r}{n - p}, \\quad p=2,\n$$\n因为有 $p=2$ 个参数（$a$ 和 $b$）。$\\hat{\\beta}$ 的协方差矩阵是\n$$\n\\mathrm{Cov}(\\hat{\\beta}) = \\hat{\\sigma}^2 (X^\\top X)^{-1}.\n$$\n斜率估计量 $\\hat{b}$ 的方差是该矩阵的 $(2,2)$ 项，所以\n$$\n\\mathrm{SE}(\\hat{b}) = \\sqrt{\\left[\\mathrm{Cov}(\\hat{\\beta})\\right]_{22}}.\n$$\n对于 $b$ 的双侧 $95\\%$ 置信区间，使用自由度为 $\\nu = n - 2$ 的学生 t 分布：\n$$\n\\hat{b} \\pm t_{1-\\alpha/2,\\nu} \\, \\mathrm{SE}(\\hat{b}), \\quad \\alpha = 0.05.\n$$\n设 $\\hat{b}_{\\mathrm{lo}}$ 和 $\\hat{b}_{\\mathrm{hi}}$ 分别表示下限和上限。因为 $Q_{10} = \\exp(b)$，原始尺度上的点估计和置信区间为\n$$\n\\widehat{Q}_{10} = \\exp(\\hat{b}), \\quad\n\\left[\\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}\\right] = \\left[\\exp(\\hat{b}_{\\mathrm{lo}}), \\exp(\\hat{b}_{\\mathrm{hi}})\\right].\n$$\n\n算法实现：\n- 对于每个测试用例，按规定构建温度 $T_i$ 和乘数 $m_i$，确定性地计算 $k_{\\mathrm{obs},i} = m_i \\, k_0 \\, Q_{10}^{\\frac{T_i - 20}{10}}$，确保物理单位：$T_i$ 以摄氏度为单位，$k_{\\mathrm{obs},i}$ 以 $\\mathrm{d}^{-1}$ 为单位。根据构造，每个 $k_{\\mathrm{obs},i}$ 都是正数。\n- 构建 $x_i = \\frac{T_i - 20}{10}$ 和 $y_i = \\ln(k_{\\mathrm{obs},i})$。\n- 用一列 1 和一列 $x_i$ 组装 $X$，计算 $\\hat{\\beta}$、残差 $r$、$\\hat{\\sigma}^2$、$(X^\\top X)^{-1}$，并提取 $\\hat{b}$ 和 $\\mathrm{SE}(\\hat{b})$。\n- 从自由度为 $\\nu=n-2$ 的学生 t 分布的累积分布函数反函数中，在概率为 $1-\\alpha/2$ 处获得 $t_{1-\\alpha/2,\\nu}$。\n- 计算 $b$ 尺度上的区间端点，并通过取指数映射回去，得到 $\\widehat{Q}_{10}$、$\\widehat{Q}_{10,\\mathrm{lo}}$ 和 $\\widehat{Q}_{10,\\mathrm{hi}}$。\n- 将每个数值结果四舍五入到恰好 $6$ 位小数，以保证输出格式的一致性。\n- 将三个用例的结果汇总到一个列表的列表中，每个内部列表按 $[\\widehat{Q}_{10}, \\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}]$ 的顺序排列，并作为单行打印，不含多余空格或文本。\n\n数值注意事项：\n- 由于用例包含近等温数据（用例 B），$\\nu = n-2$ 可能很小，而 $t_{1-\\alpha/2,\\nu}$ 可能很大，导致置信区间很宽，这反映了在有限的温度变化下 $\\ln(Q_{10})$ 的可识别性较弱。\n- 由于所有 $k_{\\mathrm{obs},i}$ 均为严格正数，因此 $\\ln(k_{\\mathrm{obs},i})$ 是有明确定义的。\n- 在对数尺度上使用 OLS 方法与乘性误差假设一致，并且在对数域中的高斯误差假设下，可以产生无偏的斜率估计。\n\n程序精确地遵循这些步骤，并以要求的单行格式打印结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t as student_t\n\ndef ols_q10_confidence_interval(T_celsius, k_obs):\n    \"\"\"\n    Fit y = a + b x + e on log-scale where:\n      x = (T - 20)/10\n      y = ln(k_obs)\n    Returns Q10_hat, Q10_CI_lower, Q10_CI_upper (two-sided 95% CI).\n    \"\"\"\n    T_celsius = np.asarray(T_celsius, dtype=float)\n    k_obs = np.asarray(k_obs, dtype=float)\n\n    # Design variable and response\n    x = (T_celsius - 20.0) / 10.0\n    y = np.log(k_obs)\n\n    n = x.size\n    # Design matrix with intercept\n    X = np.column_stack([np.ones(n), x])\n\n    # OLS estimates\n    XtX = X.T @ X\n    XtX_inv = np.linalg.inv(XtX)\n    beta_hat = XtX_inv @ (X.T @ y)\n    a_hat, b_hat = beta_hat[0], beta_hat[1]\n\n    # Residuals and variance estimate\n    residuals = y - X @ beta_hat\n    dof = n - 2\n    # Protect against division by zero; if dof = 0, this would be ill-posed (not in our test suite).\n    sigma2_hat = (residuals @ residuals) / dof\n\n    # Standard error of slope\n    var_b = sigma2_hat * XtX_inv[1, 1]\n    se_b = np.sqrt(var_b)\n\n    # t critical value for two-sided 95% CI\n    alpha = 0.05\n    tcrit = student_t.ppf(1.0 - alpha/2.0, dof)\n\n    # CI on b = ln(Q10)\n    b_lo = b_hat - tcrit * se_b\n    b_hi = b_hat + tcrit * se_b\n\n    # Map to Q10 scale\n    Q10_hat = float(np.exp(b_hat))\n    Q10_lo = float(np.exp(b_lo))\n    Q10_hi = float(np.exp(b_hi))\n\n    return Q10_hat, Q10_lo, Q10_hi\n\ndef generate_observations(T_celsius, k0_true, Q10_true, multipliers):\n    \"\"\"\n    Deterministically construct k_obs = m_i * k0_true * Q10_true ** ((T_i - 20)/10)\n    \"\"\"\n    T_celsius = np.asarray(T_celsius, dtype=float)\n    multipliers = np.asarray(multipliers, dtype=float)\n    x = (T_celsius - 20.0) / 10.0\n    k_obs = multipliers * (k0_true * (Q10_true ** x))\n    return k_obs\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Case A\n    T_A = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0]\n    k0_A = 0.5\n    Q10_A = 2.1\n    m_A = [0.98, 1.03, 1.01, 1.00, 0.97, 1.02]\n\n    # Case B\n    T_B = [19.5, 20.0, 20.5]\n    k0_B = 0.8\n    Q10_B = 2.0\n    m_B = [1.00, 1.02, 0.99]\n\n    # Case C\n    T_C = [0.0, 10.0, 20.0, 30.0]\n    k0_C = 1.0\n    Q10_C = 1.4\n    m_C = [1.10, 0.90, 1.25, 0.85]\n\n    # Construct observations\n    k_obs_A = generate_observations(T_A, k0_A, Q10_A, m_A)\n    k_obs_B = generate_observations(T_B, k0_B, Q10_B, m_B)\n    k_obs_C = generate_observations(T_C, k0_C, Q10_C, m_C)\n\n    # Calibrate and compute CIs\n    results = []\n    for T, kobs in [(T_A, k_obs_A), (T_B, k_obs_B), (T_C, k_obs_C)]:\n        q_hat, q_lo, q_hi = ols_q10_confidence_interval(T, kobs)\n        results.append([q_hat, q_lo, q_hi])\n\n    # Format results with exactly 6 decimals and as a single-line nested list without spaces.\n    def format_triple(triple):\n        return \"[\" + \",\".join(f\"{v:.6f}\" for v in triple) + \"]\"\n\n    output = \"[\" + \",\".join(format_triple(tri) for tri in results) + \"]\"\n    print(output)\n\nsolve()\n```"
        }
    ]
}