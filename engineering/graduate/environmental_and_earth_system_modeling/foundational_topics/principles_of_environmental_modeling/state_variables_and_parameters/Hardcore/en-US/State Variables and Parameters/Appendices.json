{
    "hands_on_practices": [
        {
            "introduction": "Understanding the distinction between state variables, parameters, and forcings is the first step in building and interpreting any dynamic model. This practice will solidify these core concepts using a simple carbon cycle box model (). By analyzing a first-order ordinary differential equation, you will learn to identify each component based on its role in the system's dynamics and then solve for the system's evolution over time.",
            "id": "3915326",
            "problem": "A terrestrial carbon reservoir is represented by a single well-mixed box with stock $C(t)$, where $t$ denotes time. The evolution of the carbon stock is governed by the conservation of mass, stating that the rate of change of the stock equals inputs minus outputs: $\\dot{C}(t)=\\text{inputs}(t)-\\text{outputs}(t)$. Assume the output flux is proportional to the current stock with proportionality constant $k>0$, and the input is an externally prescribed forcing $F(t)$. Thus the governing ordinary differential equation (ODE) is\n$$\n\\dot{C}(t)=-k\\,C(t)+F(t).\n$$\nInterpret this ODE within the framework of state-space modeling. Specifically:\n- Identify which quantity is the state variable and which quantities are parameters versus exogenous forcings, justifying your identification using the structure of the ODE and dimensional analysis. Assume $C$ has units of mass (e.g., petagrams of carbon), $t$ has units of time (e.g., years), and $F$ has units of mass per time.\n- For a step forcing of constant magnitude $F_{0}$ applied at time $t=0$, i.e., $F(t)=F_{0}$ for $t\\ge 0$, and with initial condition $C(0)=C_{i}$, derive from first principles an analytic expression for $C(t)$ for $t\\ge 0$ using only conservation of mass and standard calculus, without invoking any pre-memorized solution templates.\n\nReport the final expression for $C(t)$ as a closed-form analytic function of $t$, $C_{i}$, $k$, and $F_{0}$. Do not include units in your final boxed answer. If you obtain any limiting values, do not report them; only report the full expression for $C(t)$.",
            "solution": "The problem statement is evaluated as valid. It presents a standard, well-posed initial value problem based on a fundamental compartmental modeling approach used in earth systems science. The problem is scientifically grounded, self-contained, and free of contradictions or ambiguities.\n\nThe problem asks for two tasks: first, to interpret the components of the governing ordinary differential equation (ODE) within the framework of state-space modeling, and second, to derive the analytical solution for the carbon stock $C(t)$ under a specific forcing scenario.\n\n**Part 1: Interpretation of the ODE Components**\n\nThe governing ODE is given as:\n$$\n\\dot{C}(t) = -k\\,C(t) + F(t)\n$$\nwhere $\\dot{C}(t)$ denotes the time derivative $\\frac{dC}{dt}$.\n\n**State Variable:**\nThe state variable of a dynamical system is a quantity whose value at a given time $t$ completely determines the state of the system. Its future evolution depends only on its present value and any external inputs (forcings) for times greater than $t$. In the given ODE, the rate of change of the carbon stock, $\\dot{C}(t)$, is a function of the stock itself, $C(t)$, and the external input $F(t)$. Knowledge of $C(t)$ at any time $t_0$, along with the function $F(t)$ for $t \\ge t_0$, is sufficient to determine the entire future trajectory of the carbon stock. Therefore, $C(t)$ is the state variable of the system.\n\n**Parameters:**\nParameters are constants within the model that define the system's intrinsic structure and behavior. They are not functions of time and do not depend on the state variable. In the equation, $k$ is a positive constant that determines the rate of the output flux relative to the stock size. It represents an inherent property of the reservoir, such as a characteristic decay or turnover rate, and does not change with time or with the value of $C$. Thus, $k$ is a parameter. For the specific case where $F(t) = F_0$, the constant $F_0$ is also a parameter defining the magnitude of the constant forcing. The initial condition $C_i$ is a specific value of the state variable used to find a particular solution, not a parameter of the system's dynamics itself.\n\n**Exogenous Forcing:**\nAn exogenous forcing is an external input that drives the system's evolution but is not itself affected by the system's state. In the general form of the ODE, $F(t)$ represents the input flux of carbon into the reservoir. Its value is prescribed externally and is independent of $C(t)$. Therefore, $F(t)$ is the exogenous forcing. For the specific problem to be solved, this forcing takes the form of a constant step function, $F(t) = F_0$ for $t \\ge 0$.\n\n**Dimensional Analysis Justification:**\nThe units provided are: $[C] = M$ (mass), $[t] = T$ (time), and $[F] = M \\cdot T^{-1}$ (mass per time).\nThe ODE is $\\dot{C} = -kC + F$. For dimensional consistency, every term in this equation must have the same units.\nThe term $\\dot{C} = \\frac{dC}{dt}$ has units of $\\frac{[C]}{[t]} = M \\cdot T^{-1}$.\nThe forcing term $F$ is given with units $M \\cdot T^{-1}$, which is consistent.\nThe term $-kC$ must also have units of $M \\cdot T^{-1}$. Since $C$ has units $M$, the parameter $k$ must have units $\\frac{M \\cdot T^{-1}}{M} = T^{-1}$. A parameter with units of inverse time represents a rate constant, which is consistent with its role as a parameter defining the intrinsic timescale of the reservoir's dynamics (its residence time is $\\frac{1}{k}$).\n\n**Part 2: Derivation of the Analytic Solution**\n\nThe problem requires solving the initial value problem defined by:\n$$\n\\frac{dC}{dt} = -k\\,C(t) + F_0, \\quad C(0) = C_i\n$$\nThis is a first-order linear non-homogeneous ODE. We are asked to derive the solution from first principles. We will use the method of integrating factors.\n\nFirst, rearrange the ODE into the standard linear form:\n$$\n\\frac{dC}{dt} + k\\,C(t) = F_0\n$$\nThe integrating factor, which we denote by $\\mu(t)$, is a function that, when multiplied through the equation, makes the left-hand side the result of a single product rule differentiation. The integrating factor for an equation of the form $y' + p(t)y = q(t)$ is $\\mu(t) = \\exp\\left(\\int p(t) dt\\right)$. In our case, $p(t) = k$, which is a constant.\nSo, the integrating factor is:\n$$\n\\mu(t) = \\exp\\left(\\int k \\, dt\\right) = \\exp(kt)\n$$\nWe can omit the constant of integration as any non-zero multiple of an integrating factor is also an integrating factor.\n\nNow, multiply the entire ODE by $\\mu(t) = \\exp(kt)$:\n$$\n\\exp(kt)\\frac{dC}{dt} + k\\exp(kt)C(t) = F_0\\exp(kt)\n$$\nThe left-hand side is now, by construction, the derivative of the product $C(t)\\mu(t)$:\n$$\n\\frac{d}{dt}\\left( C(t)\\exp(kt) \\right) = F_0\\exp(kt)\n$$\nTo solve for $C(t)$, we integrate both sides with respect to time from $0$ to $t$:\n$$\n\\int_0^t \\frac{d}{d\\tau}\\left( C(\\tau)\\exp(k\\tau) \\right) d\\tau = \\int_0^t F_0\\exp(k\\tau) d\\tau\n$$\nApplying the fundamental theorem of calculus to the left side:\n$$\n\\left[ C(\\tau)\\exp(k\\tau) \\right]_0^t = F_0 \\int_0^t \\exp(k\\tau) d\\tau\n$$\n$$\nC(t)\\exp(kt) - C(0)\\exp(k \\cdot 0) = F_0 \\left[ \\frac{1}{k}\\exp(k\\tau) \\right]_0^t\n$$\nSubstitute the initial condition $C(0) = C_i$ and the fact that $\\exp(0) = 1$:\n$$\nC(t)\\exp(kt) - C_i = \\frac{F_0}{k} \\left( \\exp(kt) - \\exp(0) \\right)\n$$\n$$\nC(t)\\exp(kt) - C_i = \\frac{F_0}{k} \\left( \\exp(kt) - 1 \\right)\n$$\nNow, we solve for $C(t)$. First, add $C_i$ to both sides:\n$$\nC(t)\\exp(kt) = C_i + \\frac{F_0}{k}\\exp(kt) - \\frac{F_0}{k}\n$$\nFinally, multiply the entire equation by $\\exp(-kt)$ to isolate $C(t)$:\n$$\nC(t) = C_i\\exp(-kt) + \\frac{F_0}{k}\\exp(kt)\\exp(-kt) - \\frac{F_0}{k}\\exp(-kt)\n$$\n$$\nC(t) = C_i\\exp(-kt) + \\frac{F_0}{k} - \\frac{F_0}{k}\\exp(-kt)\n$$\nGrouping the terms containing $\\exp(-kt)$ and the constant term gives the final expression:\n$$\nC(t) = \\frac{F_0}{k} + \\left( C_i - \\frac{F_0}{k} \\right) \\exp(-kt)\n$$\nThis is the closed-form analytic expression for the carbon stock $C(t)$ for $t \\ge 0$.",
            "answer": "$$\n\\boxed{\\frac{F_{0}}{k} + \\left(C_{i} - \\frac{F_{0}}{k}\\right)\\exp(-kt)}\n$$"
        },
        {
            "introduction": "Many Earth systems are not uniform but vary in space, requiring a more sophisticated description of their state. This exercise elevates our understanding from simple box models to spatially distributed systems governed by partial differential equations (). By modeling heat diffusion in a soil column, you will see how the 'state' of the system becomes a continuous field and how parameters like thermal diffusivity, $\\kappa$, define the behavior of that field.",
            "id": "3915315",
            "problem": "Consider vertical heat diffusion in a homogeneous soil column of height $H$, modeled by the one-dimensional (1D) Partial Differential Equation (PDE) heat equation\n$$\\partial_{t} T(z,t) = \\kappa \\,\\partial_{zz} T(z,t), \\quad 0<z<H,\\; t>0,$$\nwhere $T(z,t)$ denotes the temperature anomaly (relative to a pre-event baseline) and $\\kappa$ is the thermal diffusivity. The boundaries are subject to fixed-temperature (Dirichlet) forcing: at the surface $z=0$, the anomaly is abruptly imposed to a constant value for all $t>0$, and at the bottom $z=H$, the anomaly is held at zero for all $t>0$:\n$$T(0,t) = \\Theta_{0}, \\quad T(H,t) = 0, \\quad t>0.$$\nAssume the initial anomaly is zero throughout the column:\n$$T(z,0) = 0, \\quad 0<z<H.$$\nWithin the framework of environmental and earth system modeling, classify $\\kappa$ versus $T(z,0)$ as parameter or state, based on core definitions of state variables and parameters for dynamical systems. Then, starting from the governing equation and boundary conditions, and using only foundational methods (for example, separation of variables, eigenfunction expansions, and orthogonality of trigonometric bases), derive and compute the closed-form expression for $T(z,t)$ for $t>0$ in terms of $z$, $t$, $\\kappa$, $H$, and $\\Theta_{0}$. Express your final formula for $T(z,t)$ as an exact infinite series. No rounding is required. Express the temperature anomaly in Kelvin (K).",
            "solution": "The problem will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The one-dimensional heat equation for temperature anomaly $T(z,t)$ is $\\partial_{t} T(z,t) = \\kappa \\,\\partial_{zz} T(z,t)$, for $0<z<H$ and $t>0$.\n- **Variables and Constants**: $T(z,t)$ is the temperature anomaly, $z$ is the vertical coordinate (depth), $t$ is time, $\\kappa$ is the thermal diffusivity (a constant), $H$ is the height of the soil column (a constant).\n- **Boundary Conditions (BCs)**:\n  - At the surface ($z=0$): $T(0,t) = \\Theta_{0}$ for $t>0$, where $\\Theta_0$ is a constant.\n  - At the bottom ($z=H$): $T(H,t) = 0$ for $t>0$.\n- **Initial Condition (IC)**: $T(z,0) = 0$ for $0<z<H$.\n- **Tasks**:\n  1. Classify $\\kappa$ versus $T(z,0)$ as a parameter or a state variable.\n  2. Derive the closed-form expression for $T(z,t)$ as an exact infinite series.\n- **Constraints**: Use foundational methods such as separation of variables. Express the temperature anomaly in Kelvin (K).\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is based on the heat equation, a fundamental and universally accepted model for diffusion processes in physics and engineering. The setup is a canonical problem in heat transfer within a solid medium. This is scientifically sound.\n- **Well-Posedness**: The problem specifies a linear parabolic partial differential equation with well-defined Dirichlet boundary conditions and an initial condition. This constitutes a well-posed problem in mathematical physics, which guarantees the existence, uniqueness, and stability of the solution. The discontinuity at $(z,t)=(0,0)$ between the initial condition $T(z,0)=0$ and the boundary condition $T(0,t)=\\Theta_0$ is a standard feature of such problems and is correctly handled by Fourier series methods.\n- **Objectivity**: The problem is stated using precise mathematical language and contains no subjective or opinion-based content.\n- **Evaluation of Flaws**:\n  1. **Scientific/Factual Unsoundness**: None. The physics and mathematics are standard.\n  2. **Non-Formalizable/Irrelevant**: The problem is perfectly formalizable and directly addresses the core concepts of state variables and parameters within the specified field of environmental modeling.\n  3. **Incomplete/Contradictory Setup**: The problem is self-contained and provides all necessary information. As noted, the discontinuity at the corner of the domain is a resolvable feature, not a contradiction.\n  4. **Unrealistic/Infeasible**: The setup is an idealization (e.g., homogeneous soil, instantaneous surface temperature change) but is physically plausible and serves as a valid and useful model.\n  5. **Ill-Posed/Poorly Structured**: None. The problem is well-posed.\n  6. **Pseudo-Profound/Trivial**: The problem requires a standard but substantive application of PDE solution techniques and conceptual understanding of dynamical systems. It is not trivial.\n  7. **Outside Scientific Verifiability**: The derived solution can be rigorously verified by substitution back into the PDE and its boundary/initial conditions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Classification of $\\kappa$ and $T(z,0)$\nIn the context of dynamical systems, a **state variable** is a quantity that describes the condition or state of a system at a given time. The set of all state variables at a time $t$ constitutes the system's state, which, along with the governing equations, determines the future evolution of the system. In this problem, $T(z,t)$ is the function describing the temperature profile at any time. The initial condition, $T(z,0)$, specifies the value of this function at the initial time $t=0$. Therefore, $T(z,0)$ is the **initial state** of the system.\n\nA **parameter** is a quantity that appears in the governing equations but is considered constant for a given scenario. Parameters characterize the intrinsic properties of the system or the external conditions imposed upon it. The thermal diffusivity, $\\kappa$, is a physical property of the soil material. It is a constant coefficient in the PDE and does not evolve in time. Therefore, $\\kappa$ is a **parameter**. Similarly, $H$ (system geometry) and $\\Theta_0$ (boundary forcing) are also parameters.\n\n### Derivation of the solution for $T(z,t)$\nThe governing PDE has non-homogeneous boundary conditions. A standard method to solve such a problem is to decompose the solution $T(z,t)$ into a steady-state part, $T_{ss}(z)$, and a transient part, $T_{tr}(z,t)$:\n$$T(z,t) = T_{ss}(z) + T_{tr}(z,t)$$\n\n**1. Steady-State Solution**\nThe steady-state solution $T_{ss}(z)$ is the equilibrium temperature profile reached as $t \\to \\infty$. In this limit, the time derivative vanishes, $\\partial_{t} T \\to 0$. The heat equation simplifies to an ordinary differential equation:\n$$\\kappa \\frac{d^2 T_{ss}}{dz^2} = 0 \\implies \\frac{d^2 T_{ss}}{dz^2} = 0$$\nIntegrating twice with respect to $z$ yields the general solution:\n$$T_{ss}(z) = Az + B$$\nThe constants $A$ and $B$ are determined by applying the original boundary conditions, which the steady-state solution must satisfy:\n- At $z=0$: $T_{ss}(0) = A(0) + B = \\Theta_{0} \\implies B = \\Theta_{0}$.\n- At $z=H$: $T_{ss}(H) = AH + B = 0 \\implies AH + \\Theta_{0} = 0 \\implies A = -\\frac{\\Theta_{0}}{H}$.\nThus, the steady-state solution is:\n$$T_{ss}(z) = -\\frac{\\Theta_{0}}{H}z + \\Theta_{0} = \\Theta_{0} \\left(1 - \\frac{z}{H}\\right)$$\n\n**2. Transient Solution**\nNow, we formulate the problem for the transient part, $T_{tr}(z,t)$. We substitute $T(z,t) = T_{ss}(z) + T_{tr}(z,t)$ into the original PDE and boundary/initial conditions.\n- **PDE**:\n$\\partial_{t}(T_{ss} + T_{tr}) = \\kappa \\partial_{zz}(T_{ss} + T_{tr})$\nSince $\\partial_{t}T_{ss} = 0$ and $\\partial_{zz}T_{ss} = 0$, the equation for the transient part is the homogeneous heat equation:\n$$\\partial_{t} T_{tr}(z,t) = \\kappa \\partial_{zz} T_{tr}(z,t)$$\n- **Boundary Conditions**:\n- At $z=0$: $T(0,t) = T_{ss}(0) + T_{tr}(0,t) = \\Theta_{0}$. Since $T_{ss}(0) = \\Theta_{0}$, we must have $T_{tr}(0,t) = 0$.\n- At $z=H$: $T(H,t) = T_{ss}(H) + T_{tr}(H,t) = 0$. Since $T_{ss}(H) = 0$, we must have $T_{tr}(H,t) = 0$.\n- **Initial Condition**:\n$T(z,0) = T_{ss}(z) + T_{tr}(z,0) = 0$. This implies:\n$$T_{tr}(z,0) = -T_{ss}(z) = -\\Theta_{0}\\left(1 - \\frac{z}{H}\\right)$$\n\nThe problem for $T_{tr}(z,t)$ is a homogeneous PDE with homogeneous boundary conditions, which can be solved using the method of separation of variables. We assume a solution of the form $T_{tr}(z,t) = Z(z)\\tau(t)$. Substituting this into the transient PDE gives:\n$$Z(z) \\frac{d\\tau}{dt} = \\kappa \\tau(t) \\frac{d^2Z}{dz^2}$$\nSeparating variables, we get:\n$$\\frac{1}{\\kappa \\tau} \\frac{d\\tau}{dt} = \\frac{1}{Z} \\frac{d^2Z}{dz^2} = -\\lambda^2$$\nwhere $-\\lambda^2$ is the separation constant. This gives two ODEs:\n1. Temporal ODE: $\\frac{d\\tau}{dt} + \\lambda^2 \\kappa \\tau = 0$\n2. Spatial ODE: $\\frac{d^2Z}{dz^2} + \\lambda^2 Z = 0$\n\nSolving the spatial ODE with its boundary conditions:\nThe general solution for $Z(z)$ is $Z(z) = C_1 \\cos(\\lambda z) + C_2 \\sin(\\lambda z)$.\n- Applying $Z(0)=0$: $C_1 \\cos(0) + C_2 \\sin(0) = 0 \\implies C_1 = 0$. The solution becomes $Z(z) = C_2 \\sin(\\lambda z)$.\n- Applying $Z(H)=0$: $C_2 \\sin(\\lambda H) = 0$. For a non-trivial solution ($C_2 \\neq 0$), we require $\\sin(\\lambda H) = 0$, which implies $\\lambda H = n\\pi$ for $n=1, 2, 3, \\dots$.\nThe eigenvalues are $\\lambda_n = \\frac{n\\pi}{H}$, and the corresponding eigenfunctions are $Z_n(z) = \\sin\\left(\\frac{n\\pi z}{H}\\right)$.\n\nSolving the temporal ODE for each eigenvalue $\\lambda_n$:\nThe equation is $\\frac{d\\tau_n}{dt} + \\left(\\frac{n\\pi}{H}\\right)^2 \\kappa \\tau_n = 0$. The solution is $\\tau_n(t) = C_n \\exp\\left(-\\kappa \\left(\\frac{n\\pi}{H}\\right)^2 t\\right)$.\n\nThe general solution for the transient part is a superposition of all possible solutions:\n$$T_{tr}(z,t) = \\sum_{n=1}^{\\infty} C_n \\sin\\left(\\frac{n\\pi z}{H}\\right) \\exp\\left(-\\kappa \\left(\\frac{n\\pi}{H}\\right)^2 t\\right)$$\n\nTo find the coefficients $C_n$, we apply the initial condition for the transient part:\n$$T_{tr}(z,0) = \\sum_{n=1}^{\\infty} C_n \\sin\\left(\\frac{n\\pi z}{H}\\right) = -\\Theta_{0}\\left(1 - \\frac{z}{H}\\right)$$\nThis is a Fourier sine series. We use the orthogonality of the sine functions over the interval $[0, H]$:\n$$\\int_0^H \\sin\\left(\\frac{n\\pi z}{H}\\right) \\sin\\left(\\frac{m\\pi z}{H}\\right) dz = \\frac{H}{2}\\delta_{nm}$$\nMultiplying the series by $\\sin\\left(\\frac{m\\pi z}{H}\\right)$ and integrating from $0$ to $H$:\n$$C_m \\frac{H}{2} = \\int_0^H \\left[-\\Theta_{0}\\left(1 - \\frac{z}{H}\\right)\\right] \\sin\\left(\\frac{m\\pi z}{H}\\right) dz$$\n$$C_m = -\\frac{2\\Theta_{0}}{H} \\left[ \\int_0^H \\sin\\left(\\frac{m\\pi z}{H}\\right) dz - \\frac{1}{H} \\int_0^H z \\sin\\left(\\frac{m\\pi z}{H}\\right) dz \\right]$$\nEvaluating the integrals:\n- First integral: $\\int_0^H \\sin\\left(\\frac{m\\pi z}{H}\\right) dz = \\left[-\\frac{H}{m\\pi}\\cos\\left(\\frac{m\\pi z}{H}\\right)\\right]_0^H = -\\frac{H}{m\\pi}(\\cos(m\\pi) - 1) = -\\frac{H}{m\\pi}((-1)^m-1)$.\n- Second integral (using integration by parts with $u=z, dv=\\sin(\\frac{m\\pi z}{H})dz$):\n$\\int_0^H z \\sin\\left(\\frac{m\\pi z}{H}\\right) dz = \\left[-\\frac{Hz}{m\\pi}\\cos\\left(\\frac{m\\pi z}{H}\\right)\\right]_0^H + \\int_0^H \\frac{H}{m\\pi}\\cos\\left(\\frac{m\\pi z}{H}\\right)dz$\n$= -\\frac{H^2}{m\\pi}\\cos(m\\pi) - 0 + \\left[\\left(\\frac{H}{m\\pi}\\right)^2 \\sin\\left(\\frac{m\\pi z}{H}\\right)\\right]_0^H = -\\frac{H^2}{m\\pi}(-1)^m + 0 = \\frac{H^2}{m\\pi}(-1)^{m+1}$.\n\nSubstituting the integral results back into the expression for $C_m$:\n$$C_m = -\\frac{2\\Theta_{0}}{H} \\left[ -\\frac{H}{m\\pi}((-1)^m-1) - \\frac{1}{H}\\left(\\frac{H^2}{m\\pi}(-1)^{m+1}\\right) \\right]$$\n$$C_m = -\\frac{2\\Theta_{0}}{H} \\left[ \\frac{H}{m\\pi}(1-(-1)^m) + \\frac{H}{m\\pi}(-1)^m \\right]$$\n$$C_m = -\\frac{2\\Theta_{0}}{m\\pi} \\left[ 1 - (-1)^m + (-1)^m \\right] = -\\frac{2\\Theta_{0}}{m\\pi}$$\nReplacing $m$ with $n$, we have $C_n = -\\frac{2\\Theta_{0}}{n\\pi}$.\n\nThe transient solution is:\n$$T_{tr}(z,t) = \\sum_{n=1}^{\\infty} \\left(-\\frac{2\\Theta_{0}}{n\\pi}\\right) \\sin\\left(\\frac{n\\pi z}{H}\\right) \\exp\\left(-\\kappa \\left(\\frac{n\\pi}{H}\\right)^2 t\\right)$$\n$$T_{tr}(z,t) = -\\frac{2\\Theta_{0}}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n\\pi z}{H}\\right) \\exp\\left(-\\frac{\\kappa n^2 \\pi^2}{H^2} t\\right)$$\n\n**3. Final Solution**\nCombining the steady-state and transient solutions, we obtain the full solution for the temperature anomaly $T(z,t)$:\n$$T(z,t) = T_{ss}(z) + T_{tr}(z,t)$$\n$$T(z,t) = \\Theta_{0} \\left(1 - \\frac{z}{H}\\right) - \\frac{2\\Theta_{0}}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n\\pi z}{H}\\right) \\exp\\left(-\\frac{\\kappa n^2 \\pi^2}{H^2} t\\right)$$\nThis expression gives the temperature anomaly at any depth $z$ and time $t$. The instruction to express the anomaly in Kelvin implies that the constant $\\Theta_{0}$ has units of Kelvin, making the entire expression dimensionally consistent and yielding a result in Kelvin.",
            "answer": "$$\n\\boxed{\nT(z,t) = \\Theta_{0} \\left(1 - \\frac{z}{H}\\right) - \\frac{2\\Theta_{0}}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n\\pi z}{H}\\right) \\exp\\left(-\\frac{\\kappa n^2 \\pi^2 t}{H^2}\\right)\n}\n$$"
        },
        {
            "introduction": "A model's predictive power depends on the accuracy of its parameters, but where do these values come from? This hands-on computational exercise moves from theory to practice by tackling the essential task of model calibration (). You will write code to estimate the crucial temperature sensitivity parameter, $Q_{10}$, from synthetic observational data, learning how to use statistical methods to find the best-fit parameter value and quantify its uncertainty.",
            "id": "3915317",
            "problem": "You are modeling temperature-sensitive heterotrophic respiration in soils, where the temperature response of the first-order process rate is represented by the widely used $Q_{10}$ law. In this setting, a process rate parameter $k(T)$ depends on a state variable $T$ (temperature) through a parameterization with two parameters: a baseline rate $k_0$ and a temperature sensitivity factor $Q_{10}$. The functional form is\n$$\nk(T) \\;=\\; k_0 \\, Q_{10}^{\\frac{T - 20}{10}},\n$$\nwhere $T$ is temperature in degrees Celsius, $k(T)$ has units $\\mathrm{d}^{-1}$ (per day), $k_0$ has units $\\mathrm{d}^{-1}$ (per day), and $Q_{10}$ is dimensionless. Treat $k_0$ and $Q_{10}$ as parameters to be calibrated, and consider $k(T)$ as a parameterized rate linked to the state variable $T$.\n\nStarting from fundamental statistical and physical modeling bases:\n- The law above defines the deterministic link between $k(T)$, $k_0$, $Q_{10}$, and $T$.\n- Observations of rates $k_{\\mathrm{obs},i}$ at temperatures $T_i$ are assumed to be positive and to follow multiplicative errors consistent with lognormal noise, implying that $\\ln k_{\\mathrm{obs},i}$ are modeled as a linear regression with additive Gaussian errors.\n\nUse these bases to derive an estimation procedure for $Q_{10}$ and its $95\\%$ confidence interval from observations $\\{(T_i,k_{\\mathrm{obs},i})\\}_{i=1}^n$ by:\n- Transforming to a linear model in the logarithmic domain with an intercept and a slope, where the slope equals $\\ln(Q_{10})$ and the intercept equals $\\ln(k_0)$.\n- Fitting the transformed model using ordinary least squares (OLS).\n- Constructing a two-sided $95\\%$ confidence interval for $\\ln(Q_{10})$ with Student’s $t$ distribution with $n-2$ degrees of freedom, and then mapping that interval back to $Q_{10}$ via the exponential function.\n\nYour task is to write a complete, runnable program that implements this calibration for a fixed test suite of cases. For each case, construct the observations deterministically from given true parameter values and specified multiplicative perturbations (to emulate measurement variability) and then perform the calibration. Use the following test suite.\n\nTest suite (each case specifies temperatures, true parameters, and multiplicative perturbations; construct $k_{\\mathrm{obs},i} = m_i \\, k_0 \\, Q_{10}^{\\frac{T_i - 20}{10}}$):\n\n- Case A (happy path, broad temperature range, moderate noise):\n  - Temperatures $T$ in degrees Celsius: $[5,10,15,20,25,30]$.\n  - True baseline $k_0$: $0.5 \\;\\mathrm{d}^{-1}$.\n  - True $Q_{10}$: $2.1$.\n  - Multipliers $m$: $[0.98, 1.03, 1.01, 1.00, 0.97, 1.02]$.\n\n- Case B (boundary condition, near-isothermal data, weak identifiability of slope):\n  - Temperatures $T$ in degrees Celsius: $[19.5,20.0,20.5]$.\n  - True baseline $k_0$: $0.8 \\;\\mathrm{d}^{-1}$.\n  - True $Q_{10}$: $2.0$.\n  - Multipliers $m$: $[1.00, 1.02, 0.99]$.\n\n- Case C (edge case, wide temperature span with an outlier-like perturbation):\n  - Temperatures $T$ in degrees Celsius: $[0.0,10.0,20.0,30.0]$.\n  - True baseline $k_0$: $1.0 \\;\\mathrm{d}^{-1}$.\n  - True $Q_{10}$: $1.4$.\n  - Multipliers $m$: $[1.10, 0.90, 1.25, 0.85]$.\n\nImplementation requirements:\n- For each case, form the design variable $x_i = \\frac{T_i - 20}{10}$ and response $y_i = \\ln(k_{\\mathrm{obs},i})$. Fit the linear model $y_i = a + b x_i + \\varepsilon_i$ by ordinary least squares, where $a = \\ln(k_0)$, $b = \\ln(Q_{10})$, and $\\varepsilon_i$ are independent, identically distributed Gaussian errors with zero mean and variance $\\sigma^2$.\n- Compute the OLS estimate $\\hat{b}$ and its standard error $\\mathrm{SE}(\\hat{b})$ using the usual formulas based on the residual variance estimate $\\hat{\\sigma}^2$ and $(X^\\top X)^{-1}$, where $X$ is the design matrix with a column of ones and the column of $x_i$.\n- Form the two-sided $95\\%$ confidence interval for $b$ as $\\hat{b} \\pm t_{1-\\alpha/2,\\nu} \\,\\mathrm{SE}(\\hat{b})$ with $\\alpha = 0.05$ and $\\nu = n-2$, where $t_{1-\\alpha/2,\\nu}$ is the critical value of the Student’s $t$ distribution.\n- Transform this interval to $Q_{10}$ by exponentiation to obtain $[\\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}] = [\\exp(\\hat{b}_{\\mathrm{lo}}), \\exp(\\hat{b}_{\\mathrm{hi}})]$, and compute the point estimate $\\widehat{Q}_{10} = \\exp(\\hat{b})$.\n\nPhysical and numerical units:\n- Temperatures $T$ are in degrees Celsius.\n- Rates $k$ and $k_0$ are in $\\mathrm{d}^{-1}$.\n- The output $\\widehat{Q}_{10}$ and its confidence bounds are dimensionless.\n- No angle units are involved.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all cases as a list of lists. For each case, output a three-element list containing $[\\widehat{Q}_{10}, \\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}]$.\n- All floating-point numbers must be rounded to exactly $6$ digits after the decimal point.\n- The overall output must be a single line in the exact format:\n  - Example structure: $[[q_{A},q_{A,\\mathrm{lo}},q_{A,\\mathrm{hi}}],[q_{B},q_{B,\\mathrm{lo}},q_{B,\\mathrm{hi}}],[q_{C},q_{C,\\mathrm{lo}},q_{C,\\mathrm{hi}}]]$,\n  with no extra spaces or text.\n\nYour program must be self-contained, require no input, and adhere to the specified execution environment.",
            "solution": "We begin with the mechanistic temperature response for a first-order process rate,\n$$\nk(T) = k_0 \\, Q_{10}^{\\frac{T-20}{10}},\n$$\nwhere $T$ is temperature, $k_0$ is a baseline rate at $T=20\\,^{\\circ}\\mathrm{C}$, and $Q_{10}$ is the dimensionless factor by which the rate increases for a $10\\,^{\\circ}\\mathrm{C}$ increase in $T$. In environmental and earth system modeling, $k_0$ and $Q_{10}$ are parameters, and $T$ is a state variable measured or simulated by the model. Observed rates $k_{\\mathrm{obs},i}$ at temperatures $T_i$ are assumed positive and are often modeled with multiplicative errors consistent with lognormal noise.\n\nTo leverage linear regression, apply the natural logarithm to both sides:\n$$\n\\ln k(T) = \\ln k_0 + \\left(\\frac{T - 20}{10}\\right)\\ln Q_{10}.\n$$\nDefine $x_i = \\frac{T_i - 20}{10}$ and $y_i = \\ln k_{\\mathrm{obs},i}$. Then\n$$\ny_i = a + b x_i + \\varepsilon_i,\n$$\nwith $a = \\ln k_0$, $b = \\ln Q_{10}$, and $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ independently, which is a standard linear model. The ordinary least squares (OLS) estimator minimizes $\\sum_i (y_i - a - b x_i)^2$. With the design matrix\n$$\nX = \\begin{bmatrix}\n1 & x_1\\\\\n\\vdots & \\vdots\\\\\n1 & x_n\n\\end{bmatrix}, \\quad\ny = \\begin{bmatrix}\ny_1\\\\\n\\vdots\\\\\ny_n\n\\end{bmatrix},\n$$\nthe OLS estimate is\n$$\n\\hat{\\beta} = \\begin{bmatrix}\\hat{a}\\\\ \\hat{b}\\end{bmatrix} = (X^\\top X)^{-1} X^\\top y.\n$$\nResiduals are $r = y - X \\hat{\\beta}$, and the unbiased residual variance estimate is\n$$\n\\hat{\\sigma}^2 = \\frac{r^\\top r}{n - p}, \\quad p=2,\n$$\nbecause there are $p=2$ parameters ($a$ and $b$). The covariance matrix of $\\hat{\\beta}$ is\n$$\n\\mathrm{Cov}(\\hat{\\beta}) = \\hat{\\sigma}^2 (X^\\top X)^{-1}.\n$$\nThe variance of the slope estimator $\\hat{b}$ is the $(2,2)$ entry of this matrix, so\n$$\n\\mathrm{SE}(\\hat{b}) = \\sqrt{\\left[\\mathrm{Cov}(\\hat{\\beta})\\right]_{22}}.\n$$\nFor a two-sided $95\\%$ confidence interval on $b$, use the Student’s $t$ distribution with $\\nu = n - 2$ degrees of freedom:\n$$\n\\hat{b} \\pm t_{1-\\alpha/2,\\nu} \\, \\mathrm{SE}(\\hat{b}), \\quad \\alpha = 0.05.\n$$\nLet $\\hat{b}_{\\mathrm{lo}}$ and $\\hat{b}_{\\mathrm{hi}}$ denote the lower and upper endpoints. Because $Q_{10} = \\exp(b)$, the point estimate and confidence interval on the original scale are\n$$\n\\widehat{Q}_{10} = \\exp(\\hat{b}), \\quad\n\\left[\\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}\\right] = \\left[\\exp(\\hat{b}_{\\mathrm{lo}}), \\exp(\\hat{b}_{\\mathrm{hi}})\\right].\n$$\n\nAlgorithmic implementation:\n- For each test case, build temperatures $T_i$ and multipliers $m_i$ as specified, compute $k_{\\mathrm{obs},i} = m_i \\, k_0 \\, Q_{10}^{\\frac{T_i - 20}{10}}$ deterministically, ensuring physical units: $T_i$ in degrees Celsius and $k_{\\mathrm{obs},i}$ in $\\mathrm{d}^{-1}$. Each $k_{\\mathrm{obs},i}$ is positive by construction.\n- Construct $x_i = \\frac{T_i - 20}{10}$ and $y_i = \\ln(k_{\\mathrm{obs},i})$.\n- Assemble $X$ with a column of ones and the column of $x_i$, compute $\\hat{\\beta}$, residuals $r$, $\\hat{\\sigma}^2$, $(X^\\top X)^{-1}$, and extract $\\hat{b}$ and $\\mathrm{SE}(\\hat{b})$.\n- Obtain $t_{1-\\alpha/2,\\nu}$ from the cumulative distribution function inverse for the Student’s $t$ distribution at probability $1-\\alpha/2$ with $\\nu=n-2$ degrees of freedom.\n- Compute the interval endpoints on the $b$-scale and map back via exponentiation to obtain $\\widehat{Q}_{10}$, $\\widehat{Q}_{10,\\mathrm{lo}}$, and $\\widehat{Q}_{10,\\mathrm{hi}}$.\n- Round each numeric result to exactly $6$ decimal digits for output formatting consistency.\n- Aggregate results for the three cases into a list of lists, each inner list ordered as $[\\widehat{Q}_{10}, \\widehat{Q}_{10,\\mathrm{lo}}, \\widehat{Q}_{10,\\mathrm{hi}}]$, and print as a single line with no extra spaces or text.\n\nNumerical considerations:\n- Because cases include near-isothermal data (Case B), $\\nu = n-2$ may be small and $t_{1-\\alpha/2,\\nu}$ large, leading to wide intervals, which reflects weak identifiability of $\\ln(Q_{10})$ from limited temperature variability.\n- Because all $k_{\\mathrm{obs},i}$ are strictly positive, $\\ln(k_{\\mathrm{obs},i})$ is well-defined.\n- The OLS approach on the logarithmic scale is consistent with the multiplicative error assumption and yields unbiased slope estimates under the Gaussian error assumptions in the log domain.\n\nThe program follows these steps precisely and prints the results in the required single-line format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t as student_t\n\ndef ols_q10_confidence_interval(T_celsius, k_obs):\n    \"\"\"\n    Fit y = a + b x + e on log-scale where:\n      x = (T - 20)/10\n      y = ln(k_obs)\n    Returns Q10_hat, Q10_CI_lower, Q10_CI_upper (two-sided 95% CI).\n    \"\"\"\n    T_celsius = np.asarray(T_celsius, dtype=float)\n    k_obs = np.asarray(k_obs, dtype=float)\n\n    # Design variable and response\n    x = (T_celsius - 20.0) / 10.0\n    y = np.log(k_obs)\n\n    n = x.size\n    # Design matrix with intercept\n    X = np.column_stack([np.ones(n), x])\n\n    # OLS estimates\n    XtX = X.T @ X\n    XtX_inv = np.linalg.inv(XtX)\n    beta_hat = XtX_inv @ (X.T @ y)\n    a_hat, b_hat = beta_hat[0], beta_hat[1]\n\n    # Residuals and variance estimate\n    residuals = y - X @ beta_hat\n    dof = n - 2\n    # Protect against division by zero; if dof = 0, this would be ill-posed (not in our test suite).\n    sigma2_hat = (residuals @ residuals) / dof\n\n    # Standard error of slope\n    var_b = sigma2_hat * XtX_inv[1, 1]\n    se_b = np.sqrt(var_b)\n\n    # t critical value for two-sided 95% CI\n    alpha = 0.05\n    tcrit = student_t.ppf(1.0 - alpha/2.0, dof)\n\n    # CI on b = ln(Q10)\n    b_lo = b_hat - tcrit * se_b\n    b_hi = b_hat + tcrit * se_b\n\n    # Map to Q10 scale\n    Q10_hat = float(np.exp(b_hat))\n    Q10_lo = float(np.exp(b_lo))\n    Q10_hi = float(np.exp(b_hi))\n\n    return Q10_hat, Q10_lo, Q10_hi\n\ndef generate_observations(T_celsius, k0_true, Q10_true, multipliers):\n    \"\"\"\n    Deterministically construct k_obs = m_i * k0_true * Q10_true ** ((T_i - 20)/10)\n    \"\"\"\n    T_celsius = np.asarray(T_celsius, dtype=float)\n    multipliers = np.asarray(multipliers, dtype=float)\n    x = (T_celsius - 20.0) / 10.0\n    k_obs = multipliers * (k0_true * (Q10_true ** x))\n    return k_obs\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Case A\n    T_A = [5.0, 10.0, 15.0, 20.0, 25.0, 30.0]\n    k0_A = 0.5\n    Q10_A = 2.1\n    m_A = [0.98, 1.03, 1.01, 1.00, 0.97, 1.02]\n\n    # Case B\n    T_B = [19.5, 20.0, 20.5]\n    k0_B = 0.8\n    Q10_B = 2.0\n    m_B = [1.00, 1.02, 0.99]\n\n    # Case C\n    T_C = [0.0, 10.0, 20.0, 30.0]\n    k0_C = 1.0\n    Q10_C = 1.4\n    m_C = [1.10, 0.90, 1.25, 0.85]\n\n    # Construct observations\n    k_obs_A = generate_observations(T_A, k0_A, Q10_A, m_A)\n    k_obs_B = generate_observations(T_B, k0_B, Q10_B, m_B)\n    k_obs_C = generate_observations(T_C, k0_C, Q10_C, m_C)\n\n    # Calibrate and compute CIs\n    results = []\n    for T, kobs in [(T_A, k_obs_A), (T_B, k_obs_B), (T_C, k_obs_C)]:\n        q_hat, q_lo, q_hi = ols_q10_confidence_interval(T, kobs)\n        results.append([q_hat, q_lo, q_hi])\n\n    # Format results with exactly 6 decimals and as a single-line nested list without spaces.\n    def format_triple(triple):\n        return \"[\" + \",\".join(f\"{v:.6f}\" for v in triple) + \"]\"\n\n    output = \"[\" + \",\".join(format_triple(tri) for tri in results) + \"]\"\n    print(output)\n\nsolve()\n```"
        }
    ]
}