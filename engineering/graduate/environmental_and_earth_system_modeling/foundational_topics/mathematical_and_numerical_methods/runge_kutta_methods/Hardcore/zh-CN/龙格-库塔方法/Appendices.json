{
    "hands_on_practices": [
        {
            "introduction": "经典的四阶龙格-库塔 (RK4) 方法是数值求解常微分方程的基石，在环境和地球系统建模中有着广泛的应用。本练习将通过一个在大气科学中代表一阶衰减过程的基本模型，引导你手动完成 RK4 的每一步计算。通过这种方式，你将具体地理解这四个阶段是如何巧妙地组合起来，从而实现高阶精度的近似，为后续更复杂的应用打下坚实基础。",
            "id": "3909607",
            "problem": "考虑一个用于被动示踪剂经历一阶移除的充分混合零维大气箱式模型。根据质量守恒定律，如果 $M(t)$ 是示踪剂质量，且移除速率与 $M(t)$ 成正比，比例系数为常数，则控制方程为 $dM/dt=-\\lambda M$，其中 $\\lambda0$ 是移除速率。定义无量纲浓度 $y(t)=M(t)/M(0)$，并使用特征时间尺度 $1/\\lambda$ 对时间进行无量纲化，于是演化方程变为 $y'(t)=-y(t)$，初始条件为 $y(0)=1$。现需从 $t=0$ 到 $t=h$ 应用经典四阶龙格-库塔 (RK4) 方法的单个显式时间步，步长 $h=1$。请以 RK4 各阶段的定义和初值问题的积分形式为出发点，通过精确计算 RK4 的四个阶段来求出 $y(h)$。请将你的最终答案表示为一个精确值（无四舍五入，无单位）。",
            "solution": "该问题已经过验证，被认为是一个应用于环境科学标准模型中的、适定且有科学依据的自洽数值分析问题。所有必要信息均已提供，不存在矛盾或含糊不清之处。\n\n问题在于求解由以下常微分方程(ODE)给出的初值问题(IVP)：\n$$\ny'(t) = -y(t)\n$$\n初始条件为：\n$$\ny(0) = 1\n$$\n我们需要应用经典四阶龙格-库塔(RK4)方法的单个步骤来近似求解在时间 $t=h$ 处的解，其中步长为 $h=1$。定义该常微分方程的函数为 $f(t,y) = -y$。数值积分的起始点为 $(t_0, y_0) = (0, 1)$。\n\nRK4 方法单步的通用公式，用于将解从时间 $t_n$ 处的 $y_n$ 推进到时间 $t_{n+1} = t_n + h$ 处的 $y_{n+1}$，其形式如下：\n$$\ny_{n+1} = y_n + \\frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n$$\n四个阶段 $k_1, k_2, k_3,$ 和 $k_4$ 定义如下：\n$$\n\\begin{aligned}\nk_1 = f(t_n, y_n) \\\\\nk_2 = f\\left(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1\\right) \\\\\nk_3 = f\\left(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2\\right) \\\\\nk_4 = f(t_n + h, y_n + hk_3)\n\\end{aligned}\n$$\n问题要求计算 $y(h)$，这在数值格式中对应于 $y_1$。我们现在将对这第一个也是唯一一个步骤计算其四个阶段的值，其中 $n=0$，$t_0=0$，$y_0=1$，$h=1$。\n\n阶段 1：\n$$\nk_1 = f(t_0, y_0) = f(0, 1) = -y_0 = -1\n$$\n\n阶段 2：\n函数的自变量为 $t_0 + \\frac{h}{2} = 0 + \\frac{1}{2} = \\frac{1}{2}$ 和 $y_0 + \\frac{h}{2}k_1 = 1 + \\frac{1}{2}(-1) = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n$$\nk_2 = f\\left(\\frac{1}{2}, \\frac{1}{2}\\right) = -\\frac{1}{2}\n$$\n\n阶段 3：\n自变量为 $t_0 + \\frac{h}{2} = \\frac{1}{2}$ 和 $y_0 + \\frac{h}{2}k_2 = 1 + \\frac{1}{2}\\left(-\\frac{1}{2}\\right) = 1 - \\frac{1}{4} = \\frac{3}{4}$。\n$$\nk_3 = f\\left(\\frac{1}{2}, \\frac{3}{4}\\right) = -\\frac{3}{4}\n$$\n\n阶段 4：\n自变量为 $t_0 + h = 0 + 1 = 1$ 和 $y_0 + hk_3 = 1 + 1\\left(-\\frac{3}{4}\\right) = 1 - \\frac{3}{4} = \\frac{1}{4}$。\n$$\nk_4 = f\\left(1, \\frac{1}{4}\\right) = -\\frac{1}{4}\n$$\n\n现在，我们将这些值代入 RK4 公式来计算 $y_1$，这是我们对 $y(h) = y(1)$ 的近似值。\n$$\ny_1 = y_0 + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\n代入 $y_0=1$，$h=1$ 以及计算出的各阶段值：\n$$\ny_1 = 1 + \\frac{1}{6}\\left[(-1) + 2\\left(-\\frac{1}{2}\\right) + 2\\left(-\\frac{3}{4}\\right) + \\left(-\\frac{1}{4}\\right)\\right]\n$$\n我们化简括号内的表达式：\n$$\ny_1 = 1 + \\frac{1}{6}\\left[-1 - 1 - \\frac{3}{2} - \\frac{1}{4}\\right]\n$$\n$$\ny_1 = 1 + \\frac{1}{6}\\left[-2 - \\frac{3}{2} - \\frac{1}{4}\\right]\n$$\n为了合并这些项，我们找到公分母，即 $4$：\n$$\ny_1 = 1 + \\frac{1}{6}\\left[-\\frac{8}{4} - \\frac{6}{4} - \\frac{1}{4}\\right]\n$$\n$$\ny_1 = 1 + \\frac{1}{6}\\left[\\frac{-8 - 6 - 1}{4}\\right]\n$$\n$$\ny_1 = 1 + \\frac{1}{6}\\left[-\\frac{15}{4}\\right]\n$$\n$$\ny_1 = 1 - \\frac{15}{24}\n$$\n分数 $\\frac{15}{24}$ 可以通过将分子和分母同除以它们的最大公约数 $3$ 来化简：\n$$\ny_1 = 1 - \\frac{5}{8}\n$$\n$$\ny_1 = \\frac{8}{8} - \\frac{5}{8}\n$$\n$$\ny_1 = \\frac{3}{8}\n$$\n因此，经过一步 RK4 方法后，在 $t=1$ 处的数值解精确值为 $\\frac{3}{8}$。",
            "answer": "$$\n\\boxed{\\frac{3}{8}}\n$$"
        },
        {
            "introduction": "尽管像 RK4 这样的显式方法功能强大，但它们的有效性受到稳定性条件的制约，尤其是在处理“刚性”问题时。本练习将使用线性测试方程 $y' = \\lambda y$ 来探索绝对稳定性的概念。你将分析一个情景：尽管步长看起来很小，但相对于系统的刚性而言却过大，导致数值解发生爆炸性失稳，而此时真实解是衰减的。这个动手实践凸显了在处理包含极大不同时间尺度的环境模型时，选择合适步长或改用隐式方法的至关重要性。",
            "id": "3189153",
            "problem": "您将研究经典的四阶 Runge-Kutta 方法 (RK4) 应用于一个刚性线性常微分方程 (ODE) 时的绝对稳定性。请从线性测试方程和单步法绝对稳定性的定义开始，不假设任何预先推导出的该方法放大因子的公式。所有数学步骤都必须基于这些基础进行论证。\n\n使用的基本依据：\n- 线性测试方程为 $y^{\\prime}=\\lambda y$，其中 $\\lambda\\in\\mathbb{C}$ 且 $y(0)=y_0$。\n- 将一个单步法应用于 $y^{\\prime}=\\lambda y$ 会生成一个迭代式 $y_{n+1}=R(z)\\,y_n$，其中 $z=h\\lambda$，$h$ 是时间步长，$R(z)$ 是标量放大因子（也称为稳定性函数）。\n- 步进映射的绝对稳定性定义为 $\\lvert R(z)\\rvert\\le 1$。\n- 经典的四阶 Runge-Kutta 方法 (RK4) 使用 $4$ 个阶段和标准的 Butcher 权重，其更新是阶段导数的加权平均。您必须通过对 $k_1$、$k_2$、$k_3$、$k_4$ 进行阶段代数运算，并在方法的更新中组合它们，来为标量测试方程推导出其 $R(z)$。不要假设任何 $R(z)$ 的简化形式。\n\n您的任务：\n1) 从阶段定义和单步更新出发，推导 RK4 应用于 $y^{\\prime}=\\lambda y$ 时的标量放大因子 $R(z)$。然后在 $z=-10$ 处对其求值（这对应于 $\\lambda=-1000$ 和 $h=0.01$），并报告 $R(-10)$ 的数值。\n\n2) 使用 $\\lambda=-1000$、$h=0.01$ 和 $y_0=1$，以精确算术计算单步放大因子的模 $\\lvert R(-10)\\rvert$，并根据条件 $\\lvert R(-10)\\rvert\\le 1$ 判断绝对稳定性。然后计算 RK4 迭代 $N=3$ 步后的数值近似解，即 $y_3=R(-10)^3\\,y_0$，并将其与在 $t=Nh=0.03$ 处的精确解 $y(t)=\\mathrm{e}^{\\lambda t}\\,y_0$ 进行比较，报告 $y_3$ 和 $y_{\\text{exact}}(0.03)$。\n\n3) 保持 $\\lambda=-1000$ 和初始步长 $h=0.01$ 不变，确定最小的正整数 $m$，使得减小后的步长 $h^{\\star}=h/m$ 能让 RK4 方法达到绝对稳定，即 $\\lvert R(-1000\\,h^{\\star})\\rvert\\le 1$。报告这个最小的 $m$、对应的 $h^{\\star}$ 以及 $\\lvert R(-1000\\,h^{\\star})\\rvert$。\n\n4) 考虑隐式后向 Euler 方法，它是一种单步法，其对线性测试方程的稳定性函数可以直接从其定义中推导出来。对于相同的 $\\lambda=-1000$ 和 $h=0.01$，计算其放大因子的模，并根据相同的条件判断稳定性。\n\n5) 使用一种在负实轴上稳健的求根区间法，数值估算使得 RK4 方法满足 $\\lvert R(-1000\\,h)\\rvert\\le 1$ 的最大步长 $h_{\\max}\\in(0,0.01]$。报告 $h_{\\max}$，至少精确到小数点后 $6$ 位。\n\n6) 为了覆盖负实轴上的不同区域并探测边界行为，还需计算 RK4 的以下值：\n   - $\\lvert R(-1)\\rvert$ 及相关的稳定性判断，\n   - $\\lvert R(-2.8)\\rvert$ 及相关的稳定性判断，\n   - $\\lvert R(-2.5)\\rvert$ 及相关的稳定性判断。\n\n要使用的测试套件和参数值：\n- 对于任务 $(1)$–$(5)$，使用 $\\lambda=-1000$、$y_0=1$、$h=0.01$ 和 $N=3$，并遵循每个任务中描述的具体要求。\n- 对于任务 $(6)$，在 RK4 的放大因子中使用 $z\\in\\{-1,-2.8,-2.5\\}$。\n\n最终输出格式：\n- 您的程序必须生成单行输出，该输出是一个用方括号括起来的逗号分隔列表，顺序如下：\n  1. $R(-10)$，作为浮点数，\n  2. RK4 在 $h=0.01$ 时的布尔稳定性判断，\n  3. RK4 在 $h=0.01$ 时的 $y_3$，\n  4. $y_{\\text{exact}}(0.03)$，\n  5. 使 $h/m$ 对于 RK4 稳定的最小整数 $m$，\n  6. 对应的 $h^{\\star}=h/m$，作为浮点数，\n  7. $\\lvert R(-1000\\,h^{\\star})\\rvert$，作为浮点数，\n  8. 后向 Euler 方法在 $h=0.01$ 时的放大因子模，\n  9. 后向 Euler 方法在 $h=0.01$ 时的布尔稳定性判断，\n  10. $h_{\\max}$，作为浮点数，\n  11. $\\lvert R(-1)\\rvert$，作为浮点数，\n  12. 在 $z=-1$ 时的布尔稳定性判断，\n  13. $\\lvert R(-2.8)\\rvert$，作为浮点数，\n  14. 在 $z=-2.8$ 时的布尔稳定性判断，\n  15. $\\lvert R(-2.5)\\rvert$，作为浮点数，\n  16. 在 $z=-2.5$ 时的布尔稳定性判断。\n- 不涉及角度单位。不涉及物理单位。\n- 浮点数必须以科学记数法打印，小数点后恰好有十位数字（例如，$2.9100000000\\mathrm{e}{+02}$）。布尔值必须显示为 True 或 False，不带引号。\n\n您的程序应生成包含结果的单行输出，格式为逗号分隔的列表并用方括号括起来（例如，\"[result1,result2,result3]\"）。",
            "solution": "该问题是有效的，因为它提出了一系列在数值分析领域内定义明确且有科学依据的任务，具体涉及经典四阶 Runge-Kutta (RK4) 方法的稳定性。所有提供的信息都是自洽的，足以推导出所需的结果。\n\n解决方案按顺序处理六个任务中的每一个。\n\n对于常微分方程 $y^{\\prime}=f(t,y)$，经典的 RK4 方法由以下更新公式给出：\n$$y_{n+1} = y_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$$\n各阶段定义如下：\n$$k_1 = f(t_n, y_n)$$\n$$k_2 = f\\left(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1\\right)$$\n$$k_3 = f\\left(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2\\right)$$\n$$k_4 = f(t_n + h, y_n + h k_3)$$\n\n对于线性测试方程 $y^{\\prime}=\\lambda y$，其中 $\\lambda \\in \\mathbb{C}$，函数为 $f(t,y) = \\lambda y$。将其应用于各阶段可得：\n$k_1 = \\lambda y_n$\n$k_2 = \\lambda \\left(y_n + \\frac{h}{2}k_1\\right) = \\lambda \\left(y_n + \\frac{h}{2}\\lambda y_n\\right) = \\lambda y_n \\left(1 + \\frac{h\\lambda}{2}\\right)$\n$k_3 = \\lambda \\left(y_n + \\frac{h}{2}k_2\\right) = \\lambda \\left(y_n + \\frac{h}{2}\\lambda y_n \\left(1 + \\frac{h\\lambda}{2}\\right)\\right) = \\lambda y_n \\left(1 + \\frac{h\\lambda}{2} + \\frac{(h\\lambda)^2}{4}\\right)$\n$k_4 = \\lambda (y_n + h k_3) = \\lambda \\left(y_n + h \\lambda y_n \\left(1 + \\frac{h\\lambda}{2} + \\frac{(h\\lambda)^2}{4}\\right)\\right) = \\lambda y_n \\left(1 + h\\lambda + \\frac{(h\\lambda)^2}{2} + \\frac{(h\\lambda)^3}{4}\\right)$\n\n将这些代入更新公式，并令 $z = h\\lambda$：\n$y_{n+1} = y_n + \\frac{h}{6}\\left[ \\lambda y_n + 2\\lambda y_n \\left(1 + \\frac{z}{2}\\right) + 2\\lambda y_n \\left(1 + \\frac{z}{2} + \\frac{z^2}{4}\\right) + \\lambda y_n \\left(1 + z + \\frac{z^2}{2} + \\frac{z^3}{4}\\right) \\right]$\n提取公因式 $y_n$ 和 $z=h\\lambda$：\n$y_{n+1} = y_n \\left[ 1 + \\frac{z}{6} \\left( 1 + 2\\left(1+\\frac{z}{2}\\right) + 2\\left(1+\\frac{z}{2}+\\frac{z^2}{4}\\right) + \\left(1+z+\\frac{z^2}{2}+\\frac{z^3}{4}\\right) \\right) \\right]$\n展开括号内的项：\n$y_{n+1} = y_n \\left[ 1 + \\frac{z}{6} \\left( 1 + (2+z) + (2+z+\\frac{z^2}{2}) + (1+z+\\frac{z^2}{2}+\\frac{z^3}{4}) \\right) \\right]$\n合并同类项：\n$y_{n+1} = y_n \\left[ 1 + \\frac{z}{6} \\left( (1+2+2+1) + (z+z+z) + (\\frac{z^2}{2}+\\frac{z^2}{2}) + \\frac{z^3}{4} \\right) \\right]$\n$y_{n+1} = y_n \\left[ 1 + \\frac{z}{6} \\left( 6 + 3z + z^2 + \\frac{z^3}{4} \\right) \\right]$\n将 $\\frac{z}{6}$ 乘进去：\n$y_{n+1} = y_n \\left[ 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} \\right]$\n因此，RK4 的放大因子是 $e^z$ 的四阶泰勒多项式：\n$$R(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}$$\n\n1) 对于 $\\lambda=-1000$ 和 $h=0.01$，有 $z = h\\lambda = -10$。\n$R(-10) = 1 + (-10) + \\frac{(-10)^2}{2} + \\frac{(-10)^3}{6} + \\frac{(-10)^4}{24} = 1 - 10 + 50 - \\frac{1000}{6} + \\frac{10000}{24} = 41 - 166.66... + 416.66... = 41 + 250 = 291$。\n\n2) 放大因子的模为 $\\lvert R(-10) \\rvert = 291$。由于 $291 > 1$，对于这些参数，该方法是绝对不稳定的。经过 $N=3$ 步后的数值解是 $y_3=R(-10)^3 y_0 = (291)^3 \\times 1 = 24634551$。在 $t=Nh=0.03$ 处的精确解是 $y_{\\text{exact}}(0.03) = e^{-1000 \\times 0.03} = e^{-30}$，这是一个非常小的正数，突显了数值方法的爆炸性不稳定性。\n\n3) 为了在负实轴上实现绝对稳定，我们需要 $z=h\\lambda \\in [z_{stab}, 0]$，其中 $z_{stab}$ 是稳定区间的边界。该边界是 $\\lvert R(z) \\rvert = 1$ 的最大负根。对于实数 $z$，$R(z)$ 是一个具有正最小值的凸函数，因此 $R(z)0$。条件变为 $R(z) \\le 1$，可简化为 $z(1+z/2+z^2/6+z^3/24) \\le 0$。对于 $z0$，这要求 $1+z/2+z^2/6+z^3/24 \\ge 0$。边界 $z_{stab}$ 是 $1+z/2+z^2/6+z^3/24 = 0$ 的根，约为 $z_{stab} \\approx -2.78529$。\n我们需要 $z^{\\star} = -1000 h^{\\star} = -10/m \\ge z_{stab}$。这得出 $10/m \\le \\lvert z_{stab} \\rvert \\approx 2.78529$，因此 $m \\ge 10/2.78529 \\approx 3.59$。最小的整数是 $m=4$。\n稳定的步长是 $h^{\\star} = h/m = 0.01/4 = 0.0025$。\n对应的 $z^{\\star} = -1000 \\times 0.0025 = -2.5$。\n放大因子的模是 $\\lvert R(-2.5) \\rvert = \\left\\lvert 1 - 2.5 + \\frac{(-2.5)^2}{2} - \\frac{2.5^3}{6} + \\frac{2.5^4}{24} \\right\\rvert = 0.6484375$。\n\n4) 后向 Euler 方法是 $y_{n+1} = y_n + hf(t_{n+1}, y_{n+1})$。对于测试方程，有 $y_{n+1}=y_n+h\\lambda y_{n+1}$，这给出 $y_{n+1} = \\frac{1}{1-h\\lambda}y_n$。其稳定性函数是 $R_{BE}(z) = \\frac{1}{1-z}$。对于 $z=-10$，$\\lvert R_{BE}(-10) \\rvert = \\lvert \\frac{1}{1-(-10)} \\rvert = \\frac{1}{11}$。由于 $\\frac{1}{11} \\le 1$，该方法是绝对稳定的。\n\n5) 为保证稳定性，最大步长 $h_{\\max} \\in (0, 0.01]$ 需要满足 $z = -1000 h_{\\max} \\ge z_{stab}$。因此，$h_{\\max} = -z_{stab}/1000$。通过使用稳健的求根区间法（如二分法或 Brent 方法）在区间 $[-3, -2]$ 上数值求解 $1+z/2+z^2/6+z^3/24 = 0$，我们找到 $z_{stab} \\approx -2.785291596$。这得出 $h_{\\max} \\approx 0.002785291596$。\n\n6) 我们计算 $\\lvert R(z) \\rvert$ 并与 $1$ 比较。\n- 对于 $z=-1$：$R(-1) = 1-1+1/2-1/6+1/24 = 9/24 = 0.375$。由于 $\\lvert R(-1) \\rvert \\le 1$，方法是稳定的。\n- 对于 $z=-2.8$：由于 $-2.8  z_{stab} \\approx -2.785$，这在稳定区间之外。$R(-2.8) \\approx 1.02267  1$。由于 $\\lvert R(-2.8) \\rvert  1$，方法是不稳定的。\n- 对于 $z=-2.5$：由于 $-2.785  -2.5  0$，这在稳定区间之内。$R(-2.5) = 0.6484375$。由于 $\\lvert R(-2.5) \\rvert \\le 1$，方法是稳定的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the problem tasks related to the stability of the RK4 method.\n    \"\"\"\n\n    def rk4_amplification_factor(z):\n        \"\"\"Computes the RK4 amplification factor R(z).\"\"\"\n        return 1 + z + z**2 / 2.0 + z**3 / 6.0 + z**4 / 24.0\n\n    # Define parameters from the problem\n    lambda_val = -1000.0\n    y0 = 1.0\n    h_initial = 0.01\n    N_steps = 3\n\n    # Task 1: Evaluate R(-10)\n    z_unstable = lambda_val * h_initial  # z = -10\n    r_at_minus_10 = rk4_amplification_factor(z_unstable) # Item 1\n\n    # Task 2: Stability at h=0.01, y_3, and exact solution\n    is_stable_h_initial = np.abs(r_at_minus_10) = 1.0 # Item 2\n    y3_rk4 = (r_at_minus_10 ** N_steps) * y0 # Item 3\n    t_final = N_steps * h_initial\n    y_exact_final_t = np.exp(lambda_val * t_final) # Item 4\n\n    # Task 3: Find minimal integer m for stability\n    m = 1\n    while True:\n        h_star_m = h_initial / m\n        z_star_m = lambda_val * h_star_m\n        if np.abs(rk4_amplification_factor(z_star_m)) = 1.0:\n            min_m = m # Item 5\n            h_star = h_star_m # Item 6\n            r_abs_at_h_star = np.abs(rk4_amplification_factor(z_star_m)) # Item 7\n            break\n        m += 1\n\n    # Task 4: Backward Euler analysis\n    def be_amplification_factor(z):\n        return 1.0 / (1.0 - z)\n    \n    r_be_mag = np.abs(be_amplification_factor(z_unstable)) # Item 8\n    is_stable_be = r_be_mag = 1.0 # Item 9\n\n    # Task 5: Find maximum stable step size h_max\n    def rk4_stability_boundary_func(z):\n        # The stability boundary for real z  0 is where |R(z)| = 1.\n        # For RK4, R(z) > 0 for real z, so this is R(z) = 1.\n        # R(z)-1 = z + z^2/2 + z^3/6 + z^4/24 = z * (1 + z/2 + z^2/6 + z^3/24)\n        # For z != 0, we need to find the root of the polynomial in the parenthesis.\n        return 1.0 + z/2.0 + z**2/6.0 + z**3/24.0\n\n    # The stability interval on the real axis is [z_stab, 0].\n    # z_stab is the root of the boundary function.\n    # A bracket of [-3, -2] is known to contain the root.\n    z_stab = brentq(rk4_stability_boundary_func, -3.0, -2.0)\n    h_max = -z_stab / np.abs(lambda_val) # Item 10\n\n    # Task 6: Stability at specific z values\n    z_vals = [-1.0, -2.8, -2.5]\n    r_abs_vals = [np.abs(rk4_amplification_factor(z)) for z in z_vals]\n    stability_decisions = [r_abs = 1.0 for r_abs in r_abs_vals]\n\n    r_abs_at_minus_1 = r_abs_vals[0] # Item 11\n    is_stable_at_minus_1 = stability_decisions[0] # Item 12\n    r_abs_at_minus_2_8 = r_abs_vals[1] # Item 13\n    is_stable_at_minus_2_8 = stability_decisions[1] # Item 14\n    r_abs_at_minus_2_5 = r_abs_vals[2] # Item 15\n    is_stable_at_minus_2_5 = stability_decisions[2] # Item 16\n\n    # Assemble results in the specified order\n    results = [\n        r_at_minus_10,\n        is_stable_h_initial,\n        y3_rk4,\n        y_exact_final_t,\n        min_m,\n        h_star,\n        r_abs_at_h_star,\n        r_be_mag,\n        is_stable_be,\n        h_max,\n        r_abs_at_minus_1,\n        is_stable_at_minus_1,\n        r_abs_at_minus_2_8,\n        is_stable_at_minus_2_8,\n        r_abs_at_minus_2_5,\n        is_stable_at_minus_2_5,\n    ]\n\n    # Format output according to specifications\n    formatted_results = []\n    for res in results:\n        if isinstance(res, (bool, np.bool_)):\n            formatted_results.append(str(res))\n        elif isinstance(res, int):\n            formatted_results.append(str(res))\n        else:  # float or np.float64\n            formatted_results.append(f\"{res:.10e}\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "环境系统通常涉及具有快（刚性）和慢（非刚性）动态的相互作用过程，而隐式-显式 (IMEX) 方法正是为这类多尺度问题而设计的。本问题通过将一个可逆化学反应分解为刚性部分（隐式处理）和非刚性部分（显式处理）来解决这一挑战。你将应用一个特定的 IMEX-RK 格式来计算一个时间步，这需要你在求解隐式阶段的同时评估显式部分的贡献。这个练习为你提供了计算环境科学前沿复杂技术的实践经验，展示了如何高效稳定地求解那些对于纯显式或纯隐式方法而言计算成本过高的系统。",
            "id": "3909517",
            "problem": "考虑一个在恒温恒压下建模的充分混合大气包裹中的可逆化学反应，其中物种 $A$ 转化为物种 $B$ 并可逆，记作 $A \\rightleftharpoons B$。根据质量作用定律，并假设总浓度 $C_{\\mathrm{tot}}$ 守恒，物种 $A$ 的浓度 $A(t)$ 满足常微分方程 $dA/dt = -k_f A + k_b (C_{\\mathrm{tot}} - A)$，其中 $k_f$ 是正向反应速率常数，$k_b$ 是逆向反应速率常数。在一个隐式-显式 (IMEX) Runge-Kutta (RK) 时间积分中，将刚性正向反应项 $f(A) = -k_f A$ 视为隐式部分，将非刚性逆向反应项 $g(A) = k_b (C_{\\mathrm{tot}} - A)$ 视为显式部分。\n\n使用一个两阶段、二阶对角隐式 Runge-Kutta IMEX 格式，其系数如下：\n- 隐式系数 $\\tilde{A} = \\begin{pmatrix} \\tfrac{1}{2}  0 \\\\ \\tfrac{1}{2}  \\tfrac{1}{2} \\end{pmatrix}$，$\\tilde{b} = \\begin{pmatrix} \\tfrac{1}{2}  \\tfrac{1}{2} \\end{pmatrix}$，$\\tilde{c} = \\begin{pmatrix} \\tfrac{1}{2}  1 \\end{pmatrix}$，\n- 显式系数 $A = \\begin{pmatrix} 0  0 \\\\ \\tfrac{1}{2}  0 \\end{pmatrix}$，$b = \\begin{pmatrix} \\tfrac{1}{2}  \\tfrac{1}{2} \\end{pmatrix}$，$c = \\begin{pmatrix} 0  \\tfrac{1}{2} \\end{pmatrix}$，\n\n从时间 $t^n$ 的已知浓度 $A^n$ 开始，在单个时间步长 $\\Delta t$ 内，计算 $A(t)$ 的一个 IMEX RK 步。该步骤包含两个阶段，其隐式和显式计算由这些系数定义。取参数\n$A^n = 1.5 \\times 10^{-6}$，$C_{\\mathrm{tot}} = 2.0 \\times 10^{-6}$，$k_f = 3.0 \\times 10^{3}$，$k_b = 5.0$ 和 $\\Delta t = 1.0 \\times 10^{-2}$，其中所有浓度单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，时间单位为 $\\mathrm{s}$。\n\n从第一性原理出发，推导由该格式定义和质量作用动力学所蕴含的阶段方程，求解隐式阶段以获得阶段浓度，评估显式部分的贡献，并组合最终更新以得到 $A^{n+1}$。以 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ 为单位表示 $A^{n+1}$ 的最终数值答案，并将答案四舍五入到六位有效数字。",
            "solution": "问题陈述有效。它在科学上基于质量作用动力学和刚性常微分方程（ODE）的数值分析，这是环境建模中的一个标准课题。该问题是适定的，提供了计算唯一解所需的完整且一致的数据、方程和数值方法规范。语言客观明确。未检测到任何缺陷。\n\n问题要求计算由以下常微分方程控制的物种 $A$ 的浓度，使用隐式-显式 (IMEX) Runge-Kutta (RK) 方法进行单个时间步的计算：\n$$\n\\frac{dA}{dt} = -k_f A + k_b (C_{\\mathrm{tot}} - A)\n$$\n方程右侧被分为隐式部分 $f(A) = -k_f A$ 和显式部分 $g(A) = k_b (C_{\\mathrm{tot}} - A)$。\n\n该 IMEX RK 格式是一个由给定的 Butcher 表定义的两阶段方法。对于系统 $y' = f(y) + g(y)$，这种可加性 Runge-Kutta (ARK) 方法的一般阶段方程为：\n$$\nK_i = A^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} g(K_j) + \\Delta t \\sum_{j=1}^{i} \\tilde{a}_{ij} f(K_j)\n$$\n最终的更新方程为：\n$$\nA^{n+1} = A^n + \\Delta t \\sum_{i=1}^{s} b_i g(K_i) + \\Delta t \\sum_{i=1}^{s} \\tilde{b}_i f(K_i)\n$$\n此处，$s=2$ 是阶段数。系数 $a_{ij}$ 来自显式表 $A$，而 $\\tilde{a}_{ij}$ 来自隐式表 $\\tilde{A}$。\n\n给定的系数如下：\n隐式：$\\tilde{A} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}$，$\\tilde{b} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}^T$\n显式：$A = \\begin{pmatrix} 0  0 \\\\ \\frac{1}{2}  0 \\end{pmatrix}$，$b = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}^T$\n\n参数值为：\n$A^n = 1.5 \\times 10^{-6} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n$C_{\\mathrm{tot}} = 2.0 \\times 10^{-6} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n$k_f = 3.0 \\times 10^{3} \\, \\mathrm{s}^{-1}$\n$k_b = 5.0 \\, \\mathrm{s}^{-1}$\n$\\Delta t = 1.0 \\times 10^{-2} \\, \\mathrm{s}$\n\n我们现在推导并求解阶段方程。\n\n**阶段 1 ($i=1$):**\n第一阶段 $K_1$ 的方程为：\n$$\nK_1 = A^n + \\Delta t \\sum_{j=1}^{0} a_{1j} g(K_j) + \\Delta t \\sum_{j=1}^{1} \\tilde{a}_{1j} f(K_j)\n$$\n第一个求和为空。从 Butcher 表中可知，$\\tilde{a}_{11} = \\frac{1}{2}$。\n$$\nK_1 = A^n + \\Delta t \\tilde{a}_{11} f(K_1) = A^n + \\frac{\\Delta t}{2} f(K_1)\n$$\n代入 $f(K_1) = -k_f K_1$：\n$$\nK_1 = A^n - \\frac{\\Delta t k_f}{2} K_1\n$$\n这是一个关于 $K_1$ 的隐式方程，我们用代数方法求解：\n$$\nK_1 \\left(1 + \\frac{\\Delta t k_f}{2}\\right) = A^n \\implies K_1 = \\frac{A^n}{1 + \\frac{\\Delta t k_f}{2}}\n$$\n我们计算分母的值：\n$$\n1 + \\frac{\\Delta t k_f}{2} = 1 + \\frac{(1.0 \\times 10^{-2}) \\cdot (3.0 \\times 10^{3})}{2} = 1 + \\frac{30}{2} = 1 + 15 = 16\n$$\n现在，我们计算 $K_1$：\n$$\nK_1 = \\frac{1.5 \\times 10^{-6}}{16} = 0.09375 \\times 10^{-6} = 9.375 \\times 10^{-8} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n\n**阶段 2 ($i=2$):**\n第二阶段 $K_2$ 的方程为：\n$$\nK_2 = A^n + \\Delta t \\sum_{j=1}^{1} a_{2j} g(K_j) + \\Delta t \\sum_{j=1}^{2} \\tilde{a}_{2j} f(K_j)\n$$\n从 Butcher 表中可知，$a_{21} = \\frac{1}{2}$，$\\tilde{a}_{21} = \\frac{1}{2}$ 以及 $\\tilde{a}_{22} = \\frac{1}{2}$。\n$$\nK_2 = A^n + \\Delta t \\, a_{21} g(K_1) + \\Delta t (\\tilde{a}_{21} f(K_1) + \\tilde{a}_{22} f(K_2))\n$$\n$$\nK_2 = A^n + \\frac{\\Delta t}{2} g(K_1) + \\frac{\\Delta t}{2} f(K_1) + \\frac{\\Delta t}{2} f(K_2)\n$$\n代入 $f(K_2) = -k_f K_2$：\n$$\nK_2 = A^n + \\frac{\\Delta t}{2} (g(K_1) + f(K_1)) - \\frac{\\Delta t k_f}{2} K_2\n$$\n求解 $K_2$：\n$$\nK_2 \\left(1 + \\frac{\\Delta t k_f}{2}\\right) = A^n + \\frac{\\Delta t}{2} (g(K_1) + f(K_1))\n$$\n$$\nK_2 = \\frac{A^n + \\frac{\\Delta t}{2} (g(K_1) + f(K_1))}{1 + \\frac{\\Delta t k_f}{2}}\n$$\n我们需要计算 $f(K_1)$ 和 $g(K_1)$：\n$$\nf(K_1) = -k_f K_1 = -(3.0 \\times 10^{3}) \\cdot (9.375 \\times 10^{-8}) = -2.8125 \\times 10^{-4}\n$$\n$$\ng(K_1) = k_b (C_{\\mathrm{tot}} - K_1) = 5.0 \\cdot (2.0 \\times 10^{-6} - 9.375 \\times 10^{-8}) = 5.0 \\cdot (1.90625 \\times 10^{-6}) = 9.53125 \\times 10^{-6}\n$$\n现在计算 $K_2$ 的分子：\n$$\n\\frac{\\Delta t}{2} (g(K_1) + f(K_1)) = \\frac{1.0 \\times 10^{-2}}{2} (9.53125 \\times 10^{-6} - 2.8125 \\times 10^{-4}) \\\\\n= (5.0 \\times 10^{-3}) (9.53125 \\times 10^{-6} - 281.25 \\times 10^{-6}) \\\\\n= (5.0 \\times 10^{-3}) (-271.71875 \\times 10^{-6}) = -1.35859375 \\times 10^{-6}\n$$\n$$\nA^n + \\frac{\\Delta t}{2} (g(K_1) + f(K_1)) = 1.5 \\times 10^{-6} - 1.35859375 \\times 10^{-6} = 0.14140625 \\times 10^{-6}\n$$\n分母是 $16$。所以，我们得到 $K_2$：\n$$\nK_2 = \\frac{0.14140625 \\times 10^{-6}}{16} = 0.008837890625 \\times 10^{-6} = 8.837890625 \\times 10^{-9} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n\n**最终更新:**\n最终浓度 $A^{n+1}$ 由下式给出：\n$$\nA^{n+1} = A^n + \\Delta t \\sum_{i=1}^{2} b_i g(K_i) + \\Delta t \\sum_{i=1}^{2} \\tilde{b}_i f(K_i)\n$$\n当 $b_1=b_2=\\frac{1}{2}$ 且 $\\tilde{b}_1=\\tilde{b}_2=\\frac{1}{2}$ 时：\n$$\nA^{n+1} = A^n + \\frac{\\Delta t}{2} (g(K_1) + g(K_2)) + \\frac{\\Delta t}{2} (f(K_1) + f(K_2))\n$$\n我们已经有了 $f(K_1)$ 和 $g(K_1)$。我们需要计算 $f(K_2)$ 和 $g(K_2)$：\n$$\nf(K_2) = -k_f K_2 = -(3.0 \\times 10^{3}) \\cdot (8.837890625 \\times 10^{-9}) = -2.6513671875 \\times 10^{-5}\n$$\n$$\ng(K_2) = k_b(C_{\\mathrm{tot}} - K_2) = 5.0 \\cdot (2.0 \\times 10^{-6} - 8.837890625 \\times 10^{-9}) \\\\\n= 5.0 \\cdot (1.991162109375 \\times 10^{-6}) = 9.955810546875 \\times 10^{-6}\n$$\n现在，组合最终的更新。\n$$\nA^{n+1} = A^n + \\frac{\\Delta t}{2} \\left[ (g(K_1)+f(K_1)) + (g(K_2)+f(K_2)) \\right]\n$$\n显式项之和：\n$$\n\\frac{\\Delta t}{2} (g(K_1) + g(K_2)) = (5.0 \\times 10^{-3}) (9.53125 \\times 10^{-6} + 9.955810546875 \\times 10^{-6}) \\\\\n= (5.0 \\times 10^{-3}) (19.487060546875 \\times 10^{-6}) = 0.097435302734375 \\times 10^{-6}\n$$\n隐式项之和：\n$$\n\\frac{\\Delta t}{2} (f(K_1) + f(K_2)) = (5.0 \\times 10^{-3}) (-2.8125 \\times 10^{-4} - 2.6513671875 \\times 10^{-5}) \\\\\n= (5.0 \\times 10^{-3}) (-28.125 \\times 10^{-5} - 2.6513671875 \\times 10^{-5}) \\\\\n= (5.0 \\times 10^{-3}) (-30.7763671875 \\times 10^{-5}) = -1.538818359375 \\times 10^{-6}\n$$\n最后，将所有部分组合起来得到 $A^{n+1}$：\n$$\nA^{n+1} = 1.5 \\times 10^{-6} + 0.097435302734375 \\times 10^{-6} - 1.538818359375 \\times 10^{-6} \\\\\nA^{n+1} = (1.5 + 0.097435302734375 - 1.538818359375) \\times 10^{-6} \\\\\nA^{n+1} = 0.058616943359375 \\times 10^{-6} = 5.8616943359375 \\times 10^{-8}\n$$\n问题要求答案四舍五入到六位有效数字。\n$$\nA^{n+1} \\approx 5.86169 \\times 10^{-8} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$",
            "answer": "$$\n\\boxed{5.86169 \\times 10^{-8}}\n$$"
        }
    ]
}