{
    "hands_on_practices": [
        {
            "introduction": "This first exercise  takes you back to basics with the classical fourth-order Runge-Kutta ($RK4$) method. By manually calculating the four stages for a simple atmospheric tracer model, you will gain a concrete understanding of how $RK4$ builds a highly accurate solution from a series of carefully chosen slopes. This foundational skill is essential for diagnosing numerical behavior and appreciating the inner workings of more complex integration schemes.",
            "id": "3909607",
            "problem": "Consider a well-mixed zero-dimensional atmospheric box model for a passive tracer undergoing first-order removal. By mass conservation, if $M(t)$ is the tracer mass and the removal rate is proportional to $M(t)$ with a constant coefficient, then the governing equation is $dM/dt=-\\lambda M$, where $\\lambda>0$ is the removal rate. Define the non-dimensional concentration $y(t)=M(t)/M(0)$ and non-dimensionalize time with the characteristic time scale $1/\\lambda$, so that the evolution equation becomes $y'(t)=-y(t)$ with initial condition $y(0)=1$. A single explicit time step of the classical fourth-order Runge–Kutta (RK4) method is to be applied from $t=0$ to $t=h$, with step size $h=1$. Using the definition of RK4 stages and the integral form of the initial value problem as the starting point, compute $y(h)$ by evaluating the four RK4 stages exactly. Express your final answer as an exact value (no rounding and no units).",
            "solution": "The problem has been validated and is deemed a well-posed, scientifically grounded, and self-contained problem in numerical analysis applied to a standard model in environmental science. All necessary information is provided, and there are no contradictions or ambiguities.\n\nThe problem is to solve the initial value problem (IVP) given by the ordinary differential equation (ODE):\n$$\ny'(t) = -y(t)\n$$\nwith the initial condition:\n$$\ny(0) = 1\n$$\nWe are asked to apply a single step of the classical fourth-order Runge-Kutta (RK4) method to approximate the solution at time $t=h$, where the step size is $h=1$. The function defining the ODE is $f(t,y) = -y$. The initial point for the numerical integration is $(t_0, y_0) = (0, 1)$.\n\nThe general formula for one step of the RK4 method, advancing the solution from $y_n$ at time $t_n$ to $y_{n+1}$ at time $t_{n+1} = t_n + h$, is:\n$$\ny_{n+1} = y_n + \\frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n$$\nThe four stages, $k_1, k_2, k_3,$ and $k_4$, are defined as follows:\n$$\n\\begin{aligned}\nk_1 &= f(t_n, y_n) \\\\\nk_2 &= f\\left(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1\\right) \\\\\nk_3 &= f\\left(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2\\right) \\\\\nk_4 &= f(t_n + h, y_n + hk_3)\n\\end{aligned}\n$$\nThe problem asks for the computation of $y(h)$, which corresponds to $y_1$ in the numerical scheme. We will now evaluate the four stages for the first and only step, with $n=0$, $t_0=0$, $y_0=1$, and $h=1$.\n\nStage 1:\n$$\nk_1 = f(t_0, y_0) = f(0, 1) = -y_0 = -1\n$$\n\nStage 2:\nThe arguments for the function are $t_0 + \\frac{h}{2} = 0 + \\frac{1}{2} = \\frac{1}{2}$ and $y_0 + \\frac{h}{2}k_1 = 1 + \\frac{1}{2}(-1) = 1 - \\frac{1}{2} = \\frac{1}{2}$.\n$$\nk_2 = f\\left(\\frac{1}{2}, \\frac{1}{2}\\right) = -\\frac{1}{2}\n$$\n\nStage 3:\nThe arguments are $t_0 + \\frac{h}{2} = \\frac{1}{2}$ and $y_0 + \\frac{h}{2}k_2 = 1 + \\frac{1}{2}\\left(-\\frac{1}{2}\\right) = 1 - \\frac{1}{4} = \\frac{3}{4}$.\n$$\nk_3 = f\\left(\\frac{1}{2}, \\frac{3}{4}\\right) = -\\frac{3}{4}\n$$\n\nStage 4:\nThe arguments are $t_0 + h = 0 + 1 = 1$ and $y_0 + hk_3 = 1 + 1\\left(-\\frac{3}{4}\\right) = 1 - \\frac{3}{4} = \\frac{1}{4}$.\n$$\nk_4 = f\\left(1, \\frac{1}{4}\\right) = -\\frac{1}{4}\n$$\n\nNow, we substitute these values into the RK4 formula to compute $y_1$, which is our approximation for $y(h) = y(1)$.\n$$\ny_1 = y_0 + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\nSubstituting $y_0=1$, $h=1$, and the computed values for the stages:\n$$\ny_1 = 1 + \\frac{1}{6}\\left[(-1) + 2\\left(-\\frac{1}{2}\\right) + 2\\left(-\\frac{3}{4}\\right) + \\left(-\\frac{1}{4}\\right)\\right]\n$$\nWe simplify the expression inside the brackets:\n$$\ny_1 = 1 + \\frac{1}{6}\\left[-1 - 1 - \\frac{3}{2} - \\frac{1}{4}\\right]\n$$\n$$\ny_1 = 1 + \\frac{1}{6}\\left[-2 - \\frac{3}{2} - \\frac{1}{4}\\right]\n$$\nTo combine the terms, we find a common denominator, which is $4$:\n$$\ny_1 = 1 + \\frac{1}{6}\\left[-\\frac{8}{4} - \\frac{6}{4} - \\frac{1}{4}\\right]\n$$\n$$\ny_1 = 1 + \\frac{1}{6}\\left[\\frac{-8 - 6 - 1}{4}\\right]\n$$\n$$\ny_1 = 1 + \\frac{1}{6}\\left[-\\frac{15}{4}\\right]\n$$\n$$\ny_1 = 1 - \\frac{15}{24}\n$$\nThe fraction $\\frac{15}{24}$ can be simplified by dividing the numerator and denominator by their greatest common divisor, which is $3$:\n$$\ny_1 = 1 - \\frac{5}{8}\n$$\n$$\ny_1 = \\frac{8}{8} - \\frac{5}{8}\n$$\n$$\ny_1 = \\frac{3}{8}\n$$\nThus, the value of the numerical solution at $t=1$ after one step of the RK4 method is exactly $\\frac{3}{8}$.",
            "answer": "$$\n\\boxed{\\frac{3}{8}}\n$$"
        },
        {
            "introduction": "While fixed-step methods are instructive, practical efficiency in environmental modeling demands adaptive time-stepping. This practice  introduces the core mechanism of modern solvers: embedded Runge-Kutta pairs. You will implement a single step of the popular Dormand-Prince 5(4) method to compute an error estimate and decide whether to accept the step, learning how solvers intelligently adjust their step size to maintain accuracy for a nonlinear reaction model.",
            "id": "3909540",
            "problem": "Consider the explicit initial value problem for a dimensionless scalar state, motivated by a well-mixed box model in environmental and earth system modeling where a concentration decays quadratically due to bimolecular reactions: find $y(t)$ satisfying $y'(t) = -y(t)^2$ with $y(0) = 1$. Your task is to implement one adaptive step of an embedded explicit Runge–Kutta method of Dormand–Prince order $5(4)$ over a single step of size $h$ starting at $t=0$ and $y(0)=1$. The step must compute two numerical approximations: a higher-order estimate $y_5$ of order $5$ and a lower-order estimate $y_4$ of order $4$, using the standard Dormand–Prince $5(4)$ coefficients. Then form the scalar error estimate $\\Delta = y_5 - y_4$ and use it to compute a scaled error norm\n$$\n\\varepsilon = \\frac{|\\Delta|}{a_{\\mathrm{tol}} + r_{\\mathrm{tol}} \\max\\{|y(0)|, |y_5|\\}},\n$$\nwhere $a_{\\mathrm{tol}}$ is the absolute tolerance and $r_{\\mathrm{tol}}$ is the relative tolerance. Decide to accept the step if and only if $\\varepsilon \\le 1$; otherwise reject the step. All quantities are dimensionless, so no physical units are required.\n\nStart from the fundamental definition of an initial value problem $y'(t) = f(t,y)$ and the concept of explicit Runge–Kutta methods with embedded pairs (without shortcut formulas provided). The Dormand–Prince $5(4)$ coefficients are widely used and constitute a well-tested numerical scheme; you must use the standard coefficients for this pair to compute $y_5$ and $y_4$ from the stages. The function $f(t,y)$ here is $f(t,y) = -y^2$.\n\nImplement a complete, runnable program that:\n- For each test case, computes the single-step estimates $y_5$, $y_4$, the error estimate $\\Delta$, the scaled error norm $\\varepsilon$, and the acceptance decision based on $\\varepsilon \\le 1$.\n- Produces a single line of output aggregating the results for all test cases as a comma-separated list enclosed in square brackets, where each test case’s result is the list $[\\Delta,\\varepsilon,\\mathrm{accept}]$ with $\\Delta$ and $\\varepsilon$ as floating-point numbers and $\\mathrm{accept}$ as a boolean.\n\nUse the following test suite, which covers a typical case, a tight tolerance case, an absolute-tolerance-only case, and a loose tolerance with a large step:\n- Case A: $h = 0.05$, $a_{\\mathrm{tol}} = 10^{-9}$, $r_{\\mathrm{tol}} = 10^{-7}$.\n- Case B: $h = 1.0$, $a_{\\mathrm{tol}} = 10^{-6}$, $r_{\\mathrm{tol}} = 10^{-3}$.\n- Case C (absolute-only scaling): $h = 0.5$, $a_{\\mathrm{tol}} = 10^{-6}$, $r_{\\mathrm{tol}} = 0$.\n- Case D (loose tolerance, large step): $h = 2.5$, $a_{\\mathrm{tol}} = 10^{-2}$, $r_{\\mathrm{tol}} = 10^{-1}$.\n\nYour program should produce a single line of output containing a list of the four case results in the format\n$$\n[[\\Delta_A,\\varepsilon_A,\\mathrm{accept}_A],[\\Delta_B,\\varepsilon_B,\\mathrm{accept}_B],[\\Delta_C,\\varepsilon_C,\\mathrm{accept}_C],[\\Delta_D,\\varepsilon_D,\\mathrm{accept}_D]],\n$$\nwhere each symbol corresponds to the respective case and all mathematical entries are represented by their numerical values in the program output.",
            "solution": "The problem is well-posed and scientifically sound, resting on foundational principles of numerical analysis for ordinary differential equations (ODEs). We shall proceed with a formal solution.\n\nThe task is to perform a single adaptive step for the explicit initial value problem (IVP) given by the ordinary differential equation:\n$$\ny'(t) = -y(t)^2, \\quad y(0) = 1\n$$\nThis equation is of the general form $y'(t) = f(t, y(t))$, with $f(t,y) = -y^2$. The initial condition is $(t_0, y_0) = (0, 1)$. We will employ an embedded explicit Runge-Kutta method, specifically the Dormand-Prince $5(4)$ pair, to compute a solution estimate and decide whether to accept the step based on a calculated error norm.\n\nAn explicit Runge-Kutta (ERK) method with $s$ stages for an autonomous ODE $y' = f(y)$ advances the solution from $y_n$ at time $t_n$ to $y_{n+1}$ at time $t_{n+1} = t_n + h$ using the following sequence of calculations:\n$$\nk_1 = f(y_n) \\\\\nk_2 = f(y_n + h a_{21} k_1) \\\\\n\\vdots \\\\\nk_s = f\\left(y_n + h \\sum_{j=1}^{s-1} a_{sj} k_j\\right)\n$$\nThe new solution estimate is then formed by a weighted average of these stage derivatives:\n$$\ny_{n+1} = y_n + h \\sum_{i=1}^s b_i k_i\n$$\nThe non-autonomous case $y' = f(t,y)$ is a straightforward extension. The coefficients $c_i = \\sum_{j=1}^{i-1} a_{ij}$, $a_{ij}$, and $b_i$ define the specific method and are commonly organized in a Butcher tableau.\n\nAn embedded ERK method, or a Runge-Kutta pair, uses the same set of stage values $k_i$ to compute two approximations of different orders, $p$ and $\\hat{p} < p$.\n$$\ny_{n+1} = y_n + h \\sum_{i=1}^s b_i k_i \\quad (\\text{order } p) \\\\\n\\hat{y}_{n+1} = y_n + h \\sum_{i=1}^s \\hat{b}_i k_i \\quad (\\text{order } \\hat{p})\n$$\nThe difference between these two estimates provides a computationally inexpensive way to estimate the local truncation error of the lower-order method:\n$$\n\\Delta = y_{n+1} - \\hat{y}_{n+1} = h \\sum_{i=1}^s (b_i - \\hat{b}_i) k_i = h \\sum_{i=1}^s e_i k_i\n$$\nwhere $e_i = b_i - \\hat{b}_i$ are the error coefficients.\n\nThe problem specifies the Dormand-Prince $5(4)$ method, a renowned $s=7$ stage embedded pair that provides a $5^{th}$-order accurate solution, $y_5$, and a $4^{th}$-order accurate solution, $y_4$. The standard coefficients are as follows:\nThe nodes $c_i$ are:\n$$\nc = [0, 1/5, 3/10, 4/5, 8/9, 1, 1]^T\n$$\nThe weights for the $5^{th}$-order solution, $y_5$, are:\n$$\nb = [35/384, 0, 500/1113, 125/192, -2187/6784, 11/84, 0]^T\n$$\nThe error coefficients for $\\Delta = y_5-y_4$ are:\n$$\ne = b - \\hat{b} = [71/57600, 0, -71/16695, 71/1920, -17253/339200, 22/525, -1/40]^T\n$$\nThe matrix $A$ of coefficients $a_{ij}$ is a lower-triangular $7 \\times 7$ matrix:\n$$\nA = \\begin{pmatrix}\n0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n1/5 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n3/40 & 9/40 & 0 & 0 & 0 & 0 & 0 \\\\\n44/45 & -56/15 & 32/9 & 0 & 0 & 0 & 0 \\\\\n19372/6561 & -25360/2187 & 64448/6561 & -212/729 & 0 & 0 & 0 \\\\\n9017/3168 & -355/33 & 46732/5247 & 49/176 & -5103/18656 & 0 & 0 \\\\\n35/384 & 0 & 500/1113 & 125/192 & -2187/6784 & 11/84 & 0\n\\end{pmatrix}\n$$\nThe single-step procedure for a given step size $h$, absolute tolerance $a_{\\text{tol}}$, and relative tolerance $r_{\\text{tol}}$ is:\n1.  Initialize with $(t_0, y_0) = (0, 1)$.\n2.  Compute the seven stage derivatives, $k_1, \\dots, k_7$, for $i = 1, \\dots, 7$:\n    $$\n    k_i = f\\left(t_0 + c_i h, y_0 + h \\sum_{j=1}^{i-1} a_{ij} k_j\\right) = -\\left(y_0 + h \\sum_{j=1}^{i-1} a_{ij} k_j\\right)^2\n    $$\n3.  Compute the higher-order solution, $y_5$:\n    $$\n    y_5 = y_0 + h \\sum_{i=1}^7 b_i k_i\n    $$\n4.  Compute the error estimate, $\\Delta$. This can be done directly from the error coefficients:\n    $$\n    \\Delta = h \\sum_{i=1}^7 e_i k_i\n    $$\n5.  Optionally, the lower-order solution is $y_4 = y_5 - \\Delta$.\n6.  Calculate the scaled error norm $\\varepsilon$:\n    $$\n    \\varepsilon = \\frac{|\\Delta|}{a_{\\text{tol}} + r_{\\text{tol}} \\max\\{|y_0|, |y_5|\\}}\n    $$\n7.  Decide to accept or reject the step. The step is accepted if and only if $\\varepsilon \\le 1$.\n\nThis procedure will be implemented and applied to each of the four test cases provided. The results $[\\Delta, \\varepsilon, \\text{accept}]$ for each case will be collected and formatted into the specified output structure.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Applies one step of the Dormand-Prince 5(4) method to a given IVP\n    for a suite of test cases and determines step acceptance.\n    \"\"\"\n    \n    # Define the Dormand-Prince 5(4) Butcher tableau coefficients\n    # c: nodes, A: matrix, b: 5th-order weights, e: error weights (b-b_hat)\n    c = np.array([0, 1/5, 3/10, 4/5, 8/9, 1, 1], dtype=np.float64)\n    \n    A = np.array([\n        [0, 0, 0, 0, 0, 0, 0],\n        [1/5, 0, 0, 0, 0, 0, 0],\n        [3/40, 9/40, 0, 0, 0, 0, 0],\n        [44/45, -56/15, 32/9, 0, 0, 0, 0],\n        [19372/6561, -25360/2187, 64448/6561, -212/729, 0, 0, 0],\n        [9017/3168, -355/33, 46732/5247, 49/176, -5103/18656, 0, 0],\n        [35/384, 0, 500/1113, 125/192, -2187/6784, 11/84, 0]\n    ], dtype=np.float64)\n\n    b = np.array([35/384, 0, 500/1113, 125/192, -2187/6784, 11/84, 0], dtype=np.float64)\n    \n    # e = b - b_hat (error coefficients for Delta = y5 - y4)\n    e = np.array([\n        71/57600, 0, -71/16695, 71/1920, -17253/339200, 22/525, -1/40\n    ], dtype=np.float64)\n\n    def f(t, y):\n        \"\"\"The ODE function: y' = -y^2.\"\"\"\n        return -y**2\n\n    # Define the initial conditions from the problem statement.\n    t0 = 0.0\n    y0 = 1.0\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (h, atol, rtol)\n        (0.05, 1e-9, 1e-7),      # Case A\n        (1.0, 1e-6, 1e-3),       # Case B\n        (0.5, 1e-6, 0.0),        # Case C\n        (2.5, 1e-2, 1e-1),       # Case D\n    ]\n\n    results = []\n    for h, atol, rtol in test_cases:\n        # Array to store the stage derivatives k_i\n        k = np.zeros(7, dtype=np.float64)\n\n        # Calculate the 7 stages\n        for i in range(7):\n            y_stage_arg = y0 + h * np.dot(A[i, :], k)\n            t_stage_arg = t0 + c[i] * h\n            k[i] = f(t_stage_arg, y_stage_arg)\n        \n        # Compute the 5th order solution y5\n        y5 = y0 + h * np.dot(b, k)\n        \n        # Compute the error estimate Delta = y5 - y4\n        delta = h * np.dot(e, k)\n\n        # Compute the scaled error norm epsilon\n        # The scale must be non-negative.\n        scale = atol + rtol * max(abs(y0), abs(y5))\n        if scale == 0.0:\n            # This case occurs if atol=0, rtol=0, y0=0, and y5=0.\n            # The error is considered acceptable if Delta is also zero.\n            epsilon = 0.0 if delta == 0.0 else float('inf')\n        else:\n            epsilon = abs(delta) / scale\n\n        # Decide whether to accept the step\n        accept = epsilon <= 1.0\n\n        results.append([delta, epsilon, accept])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Many environmental systems, from atmospheric chemistry to soil biogeochemistry, are numerically \"stiff\"—they involve processes occurring on vastly different timescales, posing a major challenge to explicit solvers. This exercise  demonstrates a powerful strategy for such problems: Implicit-Explicit (IMEX) methods. By splitting a reversible chemical reaction's governing equation into its stiff and non-stiff parts, you will compute a single IMEX step by hand, revealing how these schemes balance the stability of implicit methods with the efficiency of explicit ones.",
            "id": "3909517",
            "problem": "Consider a reversible chemical reaction in a well-mixed atmospheric parcel modeled at constant temperature and pressure, where species $A$ converts to species $B$ and back, written as $A \\rightleftharpoons B$. Under the law of mass action and assuming the total concentration $C_{\\mathrm{tot}}$ is conserved, the concentration $A(t)$ of species $A$ satisfies the ordinary differential equation $dA/dt = -k_f A + k_b (C_{\\mathrm{tot}} - A)$, where $k_f$ is the forward reaction rate constant and $k_b$ is the backward reaction rate constant. In an Implicit-Explicit (IMEX) Runge-Kutta (RK) time integration, treat the stiff forward reaction term as the implicit component $f(A) = -k_f A$ and the nonstiff backward reaction term as the explicit component $g(A) = k_b (C_{\\mathrm{tot}} - A)$.\n\nUsing a two-stage, second-order Diagonally Implicit Runge-Kutta IMEX scheme with coefficients\n- implicit coefficients $\\tilde{A} = \\begin{pmatrix} \\tfrac{1}{2} & 0 \\\\ \\tfrac{1}{2} & \\tfrac{1}{2} \\end{pmatrix}$, $\\tilde{b} = \\begin{pmatrix} \\tfrac{1}{2} \\\\ \\tfrac{1}{2} \\end{pmatrix}$, $\\tilde{c} = \\begin{pmatrix} \\tfrac{1}{2} \\\\ 1 \\end{pmatrix}$,\n- explicit coefficients $A = \\begin{pmatrix} 0 & 0 \\\\ \\tfrac{1}{2} & 0 \\end{pmatrix}$, $b = \\begin{pmatrix} \\tfrac{1}{2} \\\\ \\tfrac{1}{2} \\end{pmatrix}$, $c = \\begin{pmatrix} 0 \\\\ \\tfrac{1}{2} \\end{pmatrix}$,\n\ncompute one IMEX RK step for $A(t)$ over a single time step $\\Delta t$ from the known concentration $A^n$ at time $t^n$. The step consists of two stages with implicit and explicit computations as defined by these coefficients. Take the parameters\n$A^n = 1.5 \\times 10^{-6}$, $C_{\\mathrm{tot}} = 2.0 \\times 10^{-6}$, $k_f = 3.0 \\times 10^{3}$, $k_b = 5.0$, and $\\Delta t = 1.0 \\times 10^{-2}$, where all concentrations are in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ and time is in $\\mathrm{s}$.\n\nDerive from first principles the stage equations implied by the scheme definition and mass-action kinetics, solve the implicit stages for the stage concentrations, evaluate the explicit contributions, and assemble the final update to obtain $A^{n+1}$. Express your final numerical answer for $A^{n+1}$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ and round your answer to six significant figures.",
            "solution": "The problem statement is found to be valid. It is scientifically grounded in mass-action kinetics and numerical analysis of stiff ordinary differential equations (ODEs), which is a standard topic in environmental modeling. The problem is well-posed, providing a complete and consistent set of data, equations, and numerical method specifications required to compute a unique solution. The language is objective and unambiguous. No flaws were detected.\n\nThe problem asks to compute a single time step of an Implicit-Explicit (IMEX) Runge-Kutta (RK) method for the concentration of species $A$, governed by the ODE:\n$$\n\\frac{dA}{dt} = -k_f A + k_b (C_{\\mathrm{tot}} - A)\n$$\nThe right-hand side is split into an implicit part, $f(A) = -k_f A$, and an explicit part, $g(A) = k_b (C_{\\mathrm{tot}} - A)$.\n\nThe IMEX RK scheme is a two-stage method defined by the given Butcher tableaux. For a system $y' = f(y) + g(y)$, the general stage equations for this type of Additive Runge-Kutta (ARK) method are:\n$$\nK_i = A^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} g(K_j) + \\Delta t \\sum_{j=1}^{i} \\tilde{a}_{ij} f(K_j)\n$$\nand the final update is:\n$$\nA^{n+1} = A^n + \\Delta t \\sum_{i=1}^{s} b_i g(K_i) + \\Delta t \\sum_{i=1}^{s} \\tilde{b}_i f(K_i)\n$$\nHere, $s=2$ is the number of stages. The coefficients $a_{ij}$ are from the explicit tableau $A$, and $\\tilde{a}_{ij}$ are from the implicit tableau $\\tilde{A}$.\n\nThe given coefficients are:\nImplicit: $\\tilde{A} = \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}$, $\\tilde{b} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix}$\nExplicit: $A = \\begin{pmatrix} 0 & 0 \\\\ \\frac{1}{2} & 0 \\end{pmatrix}$, $b = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix}$\n\nThe parameter values are:\n$A^n = 1.5 \\times 10^{-6} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n$C_{\\mathrm{tot}} = 2.0 \\times 10^{-6} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}$\n$k_f = 3.0 \\times 10^{3} \\, \\mathrm{s}^{-1}$\n$k_b = 5.0 \\, \\mathrm{s}^{-1}$\n$\\Delta t = 1.0 \\times 10^{-2} \\, \\mathrm{s}$\n\nWe now derive and solve the stage equations.\n\n**Stage 1 ($i=1$):**\nThe equation for the first stage $K_1$ is:\n$$\nK_1 = A^n + \\Delta t \\sum_{j=1}^{0} a_{1j} g(K_j) + \\Delta t \\sum_{j=1}^{1} \\tilde{a}_{1j} f(K_j)\n$$\nThe first sum is empty. From the tableaux, $\\tilde{a}_{11} = \\frac{1}{2}$.\n$$\nK_1 = A^n + \\Delta t \\tilde{a}_{11} f(K_1) = A^n + \\frac{\\Delta t}{2} f(K_1)\n$$\nSubstituting $f(K_1) = -k_f K_1$:\n$$\nK_1 = A^n - \\frac{\\Delta t k_f}{2} K_1\n$$\nThis is an implicit equation for $K_1$, which we solve algebraically:\n$$\nK_1 \\left(1 + \\frac{\\Delta t k_f}{2}\\right) = A^n \\implies K_1 = \\frac{A^n}{1 + \\frac{\\Delta t k_f}{2}}\n$$\nWe compute the value of the denominator:\n$$\n1 + \\frac{\\Delta t k_f}{2} = 1 + \\frac{(1.0 \\times 10^{-2}) \\cdot (3.0 \\times 10^{3})}{2} = 1 + \\frac{30}{2} = 1 + 15 = 16\n$$\nNow, we calculate $K_1$:\n$$\nK_1 = \\frac{1.5 \\times 10^{-6}}{16} = 0.09375 \\times 10^{-6} = 9.375 \\times 10^{-8} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n\n**Stage 2 ($i=2$):**\nThe equation for the second stage $K_2$ is:\n$$\nK_2 = A^n + \\Delta t \\sum_{j=1}^{1} a_{2j} g(K_j) + \\Delta t \\sum_{j=1}^{2} \\tilde{a}_{2j} f(K_j)\n$$\nFrom the tableaux, $a_{21} = \\frac{1}{2}$, $\\tilde{a}_{21} = \\frac{1}{2}$, and $\\tilde{a}_{22} = \\frac{1}{2}$.\n$$\nK_2 = A^n + \\Delta t \\, a_{21} g(K_1) + \\Delta t (\\tilde{a}_{21} f(K_1) + \\tilde{a}_{22} f(K_2))\n$$\n$$\nK_2 = A^n + \\frac{\\Delta t}{2} g(K_1) + \\frac{\\Delta t}{2} f(K_1) + \\frac{\\Delta t}{2} f(K_2)\n$$\nSubstituting $f(K_2) = -k_f K_2$:\n$$\nK_2 = A^n + \\frac{\\Delta t}{2} (g(K_1) + f(K_1)) - \\frac{\\Delta t k_f}{2} K_2\n$$\nSolving for $K_2$:\n$$\nK_2 \\left(1 + \\frac{\\Delta t k_f}{2}\\right) = A^n + \\frac{\\Delta t}{2} (g(K_1) + f(K_1))\n$$\n$$\nK_2 = \\frac{A^n + \\frac{\\Delta t}{2} (g(K_1) + f(K_1))}{1 + \\frac{\\Delta t k_f}{2}}\n$$\nWe need to compute $f(K_1)$ and $g(K_1)$:\n$$\nf(K_1) = -k_f K_1 = -(3.0 \\times 10^{3}) \\cdot (9.375 \\times 10^{-8}) = -2.8125 \\times 10^{-4}\n$$\n$$\ng(K_1) = k_b (C_{\\mathrm{tot}} - K_1) = 5.0 \\cdot (2.0 \\times 10^{-6} - 9.375 \\times 10^{-8}) = 5.0 \\cdot (1.90625 \\times 10^{-6}) = 9.53125 \\times 10^{-6}\n$$\nNow compute the numerator for $K_2$:\n$$\n\\frac{\\Delta t}{2} (g(K_1) + f(K_1)) = \\frac{1.0 \\times 10^{-2}}{2} (9.53125 \\times 10^{-6} - 2.8125 \\times 10^{-4}) \\\\\n= (5.0 \\times 10^{-3}) (9.53125 \\times 10^{-6} - 281.25 \\times 10^{-6}) \\\\\n= (5.0 \\times 10^{-3}) (-271.71875 \\times 10^{-6}) = -1.35859375 \\times 10^{-6}\n$$\n$$\nA^n + \\frac{\\Delta t}{2} (g(K_1) + f(K_1)) = 1.5 \\times 10^{-6} - 1.35859375 \\times 10^{-6} = 0.14140625 \\times 10^{-6}\n$$\nThe denominator is $16$. So, we find $K_2$:\n$$\nK_2 = \\frac{0.14140625 \\times 10^{-6}}{16} = 0.008837890625 \\times 10^{-6} = 8.837890625 \\times 10^{-9} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$\n\n**Final Update:**\nThe final concentration $A^{n+1}$ is given by:\n$$\nA^{n+1} = A^n + \\Delta t \\sum_{i=1}^{2} b_i g(K_i) + \\Delta t \\sum_{i=1}^{2} \\tilde{b}_i f(K_i)\n$$\nWith $b_1=b_2=\\frac{1}{2}$ and $\\tilde{b}_1=\\tilde{b}_2=\\frac{1}{2}$:\n$$\nA^{n+1} = A^n + \\frac{\\Delta t}{2} (g(K_1) + g(K_2)) + \\frac{\\Delta t}{2} (f(K_1) + f(K_2))\n$$\nWe have $f(K_1)$ and $g(K_1)$. We need to compute $f(K_2)$ and $g(K_2)$:\n$$\nf(K_2) = -k_f K_2 = -(3.0 \\times 10^{3}) \\cdot (8.837890625 \\times 10^{-9}) = -2.6513671875 \\times 10^{-5}\n$$\n$$\ng(K_2) = k_b(C_{\\mathrm{tot}} - K_2) = 5.0 \\cdot (2.0 \\times 10^{-6} - 8.837890625 \\times 10^{-9}) \\\\\n= 5.0 \\cdot (1.991162109375 \\times 10^{-6}) = 9.955810546875 \\times 10^{-6}\n$$\nNow, assemble the final update.\n$$\nA^{n+1} = A^n + \\frac{\\Delta t}{2} \\left[ (g(K_1)+f(K_1)) + (g(K_2)+f(K_2)) \\right]\n$$\nSum of explicit terms:\n$$\n\\frac{\\Delta t}{2} (g(K_1) + g(K_2)) = (5.0 \\times 10^{-3}) (9.53125 \\times 10^{-6} + 9.955810546875 \\times 10^{-6}) \\\\\n= (5.0 \\times 10^{-3}) (19.487060546875 \\times 10^{-6}) = 0.097435302734375 \\times 10^{-6}\n$$\nSum of implicit terms:\n$$\n\\frac{\\Delta t}{2} (f(K_1) + f(K_2)) = (5.0 \\times 10^{-3}) (-2.8125 \\times 10^{-4} - 2.6513671875 \\times 10^{-5}) \\\\\n= (5.0 \\times 10^{-3}) (-28.125 \\times 10^{-5} - 2.6513671875 \\times 10^{-5}) \\\\\n= (5.0 \\times 10^{-3}) (-30.7763671875 \\times 10^{-5}) = -1.538818359375 \\times 10^{-6}\n$$\nFinally, combine everything to get $A^{n+1}$:\n$$\nA^{n+1} = 1.5 \\times 10^{-6} + 0.097435302734375 \\times 10^{-6} - 1.538818359375 \\times 10^{-6} \\\\\nA^{n+1} = (1.5 + 0.097435302734375 - 1.538818359375) \\times 10^{-6} \\\\\nA^{n+1} = 0.058616943359375 \\times 10^{-6} = 5.8616943359375 \\times 10^{-8}\n$$\nThe problem requires the answer to be rounded to six significant figures.\n$$\nA^{n+1} \\approx 5.86169 \\times 10^{-8} \\, \\mathrm{mol}\\,\\mathrm{m}^{-3}\n$$",
            "answer": "$$\n\\boxed{5.86169 \\times 10^{-8}}\n$$"
        }
    ]
}