{
    "hands_on_practices": [
        {
            "introduction": "This exercise explores the fundamental nature of truncation error for finite difference schemes. By applying the central difference formula to a quadratic polynomial, you will demonstrate a key theoretical result: the error of a second-order scheme vanishes for functions where certain higher-order derivatives are zero . This practice builds essential intuition for how truncation error is intimately linked to the Taylor series expansion of the function being approximated.",
            "id": "2224247",
            "problem": "In numerical analysis, the first derivative of a sufficiently smooth function $f(x)$ can be approximated using the central difference formula, which is given by:\n$$D_h f(x) = \\frac{f(x+h) - f(x-h)}{2h}$$\nwhere $h$ is a small step size. The local truncation error of this approximation is defined as the difference between the true derivative and the approximation:\n$$T_h(x) = f'(x) - D_h f(x)$$\n\nConsider the specific quadratic polynomial $P(x) = \\frac{7}{2}x^2 - \\frac{11}{3}x + \\sqrt{5}$.\n\nWhat is the exact expression for the local truncation error $T_h(x)$ when the central difference formula is applied to this polynomial $P(x)$?\n\nA. $0$\n\nB. $-\\frac{7h^2}{6}$\n\nC. $\\frac{7h}{2}$\n\nD. $7h$\n\nE. $\\sqrt{5}$",
            "solution": "We are asked to compute the local truncation error $T_{h}(x)=f'(x)-D_{h}f(x)$ for the specific quadratic polynomial $P(x)=\\frac{7}{2}x^{2}-\\frac{11}{3}x+\\sqrt{5}$ using the central difference operator $D_{h}f(x)=\\frac{f(x+h)-f(x-h)}{2h}$.\n\nFirst, recall the Taylor expansion of a sufficiently smooth function about $x$:\n$$\nf(x+h)=f(x)+h f'(x)+\\frac{h^{2}}{2}f''(x)+\\frac{h^{3}}{6}f^{(3)}(x)+\\cdots,\n$$\n$$\nf(x-h)=f(x)-h f'(x)+\\frac{h^{2}}{2}f''(x)-\\frac{h^{3}}{6}f^{(3)}(x)+\\cdots.\n$$\nSubtracting gives\n$$\nf(x+h)-f(x-h)=2h f'(x)+\\frac{h^{3}}{3}f^{(3)}(x)+\\cdots,\n$$\nso\n$$\nD_{h}f(x)=\\frac{f(x+h)-f(x-h)}{2h}=f'(x)+\\frac{h^{2}}{6}f^{(3)}(x)+\\cdots.\n$$\nTherefore the local truncation error is\n$$\nT_{h}(x)=f'(x)-D_{h}f(x)=-\\frac{h^{2}}{6}f^{(3)}(x)+\\cdots.\n$$\nFor a quadratic polynomial $P(x)=\\frac{7}{2}x^{2}-\\frac{11}{3}x+\\sqrt{5}$, we have $P^{(3)}(x)=0$ identically. Hence all higher-order terms vanish and the central difference is exact:\n$$\nT_{h}(x)=0.\n$$\n\nAlternatively, we can verify directly. Compute the derivative:\n$$\nP'(x)=7x-\\frac{11}{3}.\n$$\nCompute the central difference:\n$$\nP(x+h)=\\frac{7}{2}(x+h)^{2}-\\frac{11}{3}(x+h)+\\sqrt{5}=\\frac{7}{2}x^{2}+7xh+\\frac{7}{2}h^{2}-\\frac{11}{3}x-\\frac{11}{3}h+\\sqrt{5},\n$$\n$$\nP(x-h)=\\frac{7}{2}(x-h)^{2}-\\frac{11}{3}(x-h)+\\sqrt{5}=\\frac{7}{2}x^{2}-7xh+\\frac{7}{2}h^{2}-\\frac{11}{3}x+\\frac{11}{3}h+\\sqrt{5}.\n$$\nSubtracting,\n$$\nP(x+h)-P(x-h)=14xh-\\frac{22}{3}h.\n$$\nDivide by $2h$:\n$$\nD_{h}P(x)=\\frac{P(x+h)-P(x-h)}{2h}=7x-\\frac{11}{3}=P'(x).\n$$\nThus\n$$\nT_{h}(x)=P'(x)-D_{h}P(x)=0.\n$$\nTherefore, the correct option is A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Building on the concept of structured truncation error, this practice introduces Richardson extrapolation, a powerful technique used throughout computational model verification. You will use hypothetical data from two grid resolutions to not only estimate the truncation error but also to compute a higher-order, more accurate solution . This exercise is a cornerstone of quantitative convergence analysis in environmental modeling, providing a method to improve results and assess their reliability.",
            "id": "3927311",
            "problem": "In a one-dimensional estuarine channel model governed by a steady advection–diffusion partial differential equation (PDE), a scalar diagnostic of interest, denoted by $J$, is computed from numerical solutions obtained with a second-order accurate spatial discretization on a uniform grid of spacing $\\Delta x$. Assume the method is consistent and that, in the asymptotic grid-refinement regime, the diagnostic satisfies an error expansion of the form $J(\\Delta x) = J^{\\ast} + \\text{TE}(\\Delta x)$, where $J^{\\ast}$ is the exact (continuum) diagnostic and the truncation error $\\text{TE}(\\Delta x)$ admits a smooth Taylor-like asymptotic series in even powers of $\\Delta x$ starting at order $\\Delta x^{2}$ due to second-order accuracy. Starting from the core definitions of consistency and order of accuracy, and using the asymptotic error expansion as a fundamental base, answer the following:\n1) Derive, by eliminating the leading-order truncation error term using two simulations at grid spacings $\\Delta x$ and $\\Delta x/2$, a closed-form expression for a Richardson-extrapolated estimator $J_{R}$ of $J^{\\ast}$ that achieves higher-order accuracy than the original second-order scheme.\n2) Show how the difference $J(\\Delta x/2) - J(\\Delta x)$ provides a leading-order estimator of the magnitude of the truncation error of the finer-grid diagnostic $J(\\Delta x/2)$, and derive the proportionality constant explicitly.\n3) A coastal ocean application yields the following numerically computed surface heat flux diagnostics (in watts per square meter) using the same second-order scheme at two grid spacings: $J(\\Delta x) = 1.372 \\times 10^{-3}$ and $J(\\Delta x/2) = 1.401 \\times 10^{-3}$. Using your derived formulas, compute the Richardson-extrapolated estimate $J_{R}$ and the leading-order absolute truncation error estimate for $J(\\Delta x/2)$. Round your final numeric values to four significant figures. Express the final answer in watts per square meter, and report it as a row vector $\\big[ J_{R}, \\widehat{E}_{\\Delta x/2} \\big]$.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, and self-contained. It presents a standard and formalizable problem in numerical analysis, specifically pertaining to error estimation and convergence acceleration via Richardson extrapolation for discretized partial differential equations. All provided information is consistent and sufficient for deriving a unique solution.\n\nThe core of the problem rests on the given asymptotic error expansion for a numerically computed diagnostic, $J(\\Delta x)$, obtained with a second-order accurate scheme. The expansion is stated to be a series in even powers of the grid spacing $\\Delta x$:\n$$\nJ(\\Delta x) = J^{\\ast} + c_{2}(\\Delta x)^2 + c_{4}(\\Delta x)^4 + c_{6}(\\Delta x)^6 + \\dots\n$$\nHere, $J^{\\ast}$ represents the exact value of the diagnostic in the continuum limit ($\\Delta x \\to 0$), and $c_{2}, c_{4}, c_{6}, \\dots$ are constants that are independent of $\\Delta x$. The term $c_{2}(\\Delta x)^2$ is the leading-order truncation error, consistent with a second-order accurate method.\n\n1) Derivation of the Richardson-extrapolated estimator $J_{R}$\n\nWe are given two numerical solutions, one computed with grid spacing $\\Delta x$ and another with a refined grid spacing of $\\Delta x/2$. We write the error expansion for both:\n$$\nJ(\\Delta x) = J^{\\ast} + c_{2}(\\Delta x)^2 + c_{4}(\\Delta x)^4 + \\mathcal{O}((\\Delta x)^6) \\quad (1)\n$$\n$$\nJ(\\frac{\\Delta x}{2}) = J^{\\ast} + c_{2}\\left(\\frac{\\Delta x}{2}\\right)^2 + c_{4}\\left(\\frac{\\Delta x}{2}\\right)^4 + \\mathcal{O}((\\Delta x)^6) = J^{\\ast} + \\frac{1}{4}c_{2}(\\Delta x)^2 + \\frac{1}{16}c_{4}(\\Delta x)^4 + \\mathcal{O}((\\Delta x)^6) \\quad (2)\n$$\nThe objective of Richardson extrapolation is to form a linear combination of $J(\\Delta x)$ and $J(\\Delta x/2)$ that eliminates the leading-order error term, $c_{2}(\\Delta x)^2$. To do this, we can multiply equation $(2)$ by $4$ to match the coefficient of the leading error term in equation $(1)$:\n$$\n4 J(\\frac{\\Delta x}{2}) = 4J^{\\ast} + c_{2}(\\Delta x)^2 + \\frac{4}{16}c_{4}(\\Delta x)^4 + \\mathcal{O}((\\Delta x)^6) = 4J^{\\ast} + c_{2}(\\Delta x)^2 + \\frac{1}{4}c_{4}(\\Delta x)^4 + \\mathcal{O}((\\Delta x)^6) \\quad (3)\n$$\nNow, we subtract equation $(1)$ from equation $(3)$:\n$$\n4 J(\\frac{\\Delta x}{2}) - J(\\Delta x) = (4J^{\\ast} - J^{\\ast}) + (c_{2}(\\Delta x)^2 - c_{2}(\\Delta x)^2) + (\\frac{1}{4}c_{4}(\\Delta x)^4 - c_{4}(\\Delta x)^4) + \\mathcal{O}((\\Delta x)^6)\n$$\n$$\n4 J(\\frac{\\Delta x}{2}) - J(\\Delta x) = 3J^{\\ast} - \\frac{3}{4}c_{4}(\\Delta x)^4 + \\mathcal{O}((\\Delta x)^6)\n$$\nSolving this algebraic equation for $J^{\\ast}$ gives:\n$$\nJ^{\\ast} = \\frac{4 J(\\frac{\\Delta x}{2}) - J(\\Delta x)}{3} + \\frac{1}{4}c_{4}(\\Delta x)^4 + \\mathcal{O}((\\Delta x)^6)\n$$\nThe Richardson-extrapolated estimator, $J_{R}$, is defined as the leading term of this expression, which provides a higher-order estimate of $J^{\\ast}$:\n$$\nJ_{R} = \\frac{4 J(\\frac{\\Delta x}{2}) - J(\\Delta x)}{3}\n$$\nThe error of this new estimator is $J_{R} - J^{\\ast} = -\\frac{1}{4}c_{4}(\\Delta x)^4 + \\mathcal{O}((\\Delta x)^6)$. Since the error is now proportional to $(\\Delta x)^4$, the estimator $J_{R}$ is fourth-order accurate, an improvement over the original second-order scheme.\n\n2) Derivation of the truncation error estimator for $J(\\Delta x/2)$\n\nThe goal is to estimate the truncation error of the finer-grid solution, $E_{\\Delta x/2} = J(\\Delta x/2) - J^{\\ast}$. The leading-order term of this error is $E_{\\Delta x/2} \\approx \\frac{1}{4}c_{2}(\\Delta x)^2$. We need to find an expression for this quantity using the observable difference between the two numerical solutions, $J(\\Delta x/2) - J(\\Delta x)$.\n\nLet us subtract equation $(2)$ from equation $(1)$, keeping only the leading-order error terms:\n$$\nJ(\\Delta x) - J(\\frac{\\Delta x}{2}) \\approx (J^{\\ast} + c_{2}(\\Delta x)^2) - (J^{\\ast} + \\frac{1}{4}c_{2}(\\Delta x)^2)\n$$\n$$\nJ(\\Delta x) - J(\\frac{\\Delta x}{2}) \\approx \\frac{3}{4}c_{2}(\\Delta x)^2\n$$\nThis allows us to estimate the unknown term $c_{2}(\\Delta x)^2$ from the computed values:\n$$\nc_{2}(\\Delta x)^2 \\approx \\frac{4}{3}\\left(J(\\Delta x) - J(\\frac{\\Delta x}{2})\\right)\n$$\nThe leading-order truncation error for the finer-grid diagnostic, $J(\\Delta x/2)$, is $E_{\\Delta x/2} \\approx \\frac{1}{4}c_{2}(\\Delta x)^2$. Substituting our estimate for $c_{2}(\\Delta x)^2$:\n$$\nE_{\\Delta x/2} \\approx \\frac{1}{4} \\left[ \\frac{4}{3}\\left(J(\\Delta x) - J(\\frac{\\Delta x}{2})\\right) \\right] = \\frac{1}{3}\\left(J(\\Delta x) - J(\\frac{\\Delta x}{2})\\right)\n$$\nThis expression provides a leading-order estimate for the signed truncation error of $J(\\Delta x/2)$. The problem asks for an estimator based on the difference $J(\\Delta x/2) - J(\\Delta x)$, which gives:\n$$\nE_{\\Delta x/2} \\approx -\\frac{1}{3}\\left(J(\\frac{\\Delta x}{2}) - J(\\Delta x)\\right)\n$$\nThe magnitude of the truncation error is therefore estimated as:\n$$\n|E_{\\Delta x/2}| \\approx \\frac{1}{3}\\left|J(\\frac{\\Delta x}{2}) - J(\\Delta x)\\right|\n$$\nThis shows that the difference $J(\\Delta x/2) - J(\\Delta x)$ is indeed a proxy for the truncation error of the fine-grid solution, and the proportionality constant relating its magnitude to the error magnitude is $1/3$.\n\n3) Numerical computation\n\nWe are given the following numerical values for the surface heat flux diagnostic:\n$$\nJ(\\Delta x) = 1.372 \\times 10^{-3} \\, \\text{W m}^{-2}\n$$\n$$\nJ(\\frac{\\Delta x}{2}) = 1.401 \\times 10^{-3} \\, \\text{W m}^{-2}\n$$\nFirst, we compute the Richardson-extrapolated estimate $J_{R}$ using the formula from part $(1)$:\n$$\nJ_{R} = \\frac{4 J(\\frac{\\Delta x}{2}) - J(\\Delta x)}{3} = \\frac{4(1.401 \\times 10^{-3}) - 1.372 \\times 10^{-3}}{3}\n$$\n$$\nJ_{R} = \\frac{(5.604 - 1.372) \\times 10^{-3}}{3} = \\frac{4.232 \\times 10^{-3}}{3} \\approx 1.410666... \\times 10^{-3}\n$$\nRounding to four significant figures, we get $J_{R} = 1.411 \\times 10^{-3}$.\n\nNext, we compute the leading-order absolute truncation error estimate for $J(\\Delta x/2)$, which we denote $\\widehat{E}_{\\Delta x/2}$, using the formula from part $(2)$:\n$$\n\\widehat{E}_{\\Delta x/2} = \\frac{\\left|J(\\frac{\\Delta x}{2}) - J(\\Delta x)\\right|}{3} = \\frac{\\left| (1.401 \\times 10^{-3}) - (1.372 \\times 10^{-3}) \\right|}{3}\n$$\n$$\n\\widehat{E}_{\\Delta x/2} = \\frac{|0.029 \\times 10^{-3}|}{3} = \\frac{0.029 \\times 10^{-3}}{3} \\approx 0.009666... \\times 10^{-3} = 9.666... \\times 10^{-6}\n$$\nRounding to four significant figures, we get $\\widehat{E}_{\\Delta x/2} = 9.667 \\times 10^{-6}$.\n\nThe final requested quantities, expressed in watts per square meter, are $J_R \\approx 1.411 \\times 10^{-3}$ and $\\widehat{E}_{\\Delta x/2} \\approx 9.667 \\times 10^{-6}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.411 \\times 10^{-3} & 9.667 \\times 10^{-6} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "This advanced practice operationalizes error estimation into a formal verification procedure widely used in computational science. By analyzing simulation results from three nested grids, you will learn to calculate the observed order of accuracy and the Grid Convergence Index (GCI), a standardized metric for reporting discretization uncertainty . This exercise simulates a key task in the development and validation of complex environmental and earth system models, ensuring the credibility of their numerical predictions.",
            "id": "3927276",
            "problem": "You are modeling an inert tracer concentration in a transport-diffusion simulation representative of environmental and earth system modeling. Consider a sequence of nested, structured grids with spacings $h_1$, $h_2$, $h_3$ ($h_1 < h_2 < h_3$) on which a scalar quantity $Q(h)$ is computed, where $Q(h)$ is a physically meaningful diagnostic such as the domain-mean tracer concentration expressed in kilograms per cubic meter ($\\mathrm{kg}\\,\\mathrm{m}^{-3}$). Assume the numerical method is in the asymptotic range so that the truncation error scales with grid spacing according to a power law: $$Q(h) = Q^\\ast + C\\,h^p + \\mathcal{O}\\!\\left(h^{p+1}\\right),$$ where $Q^\\ast$ is the grid-independent solution, $C$ is a constant depending on the method and solution regularity, and $p$ is the observed order of accuracy.\n\nFrom first principles, use the above scaling to:\n- Derive the observed order $p$ from three-grid data $(h_1,h_2,h_3)$ and $(Q_1,Q_2,Q_3)$, where $Q_i = Q(h_i)$, by eliminating the unknown constant $C$ and the unknown grid-independent value $Q^\\ast$.\n- Using the same scaling and a fixed safety factor $F_s = 1.25$ appropriate for three-grid, monotonic convergence studies, compute the Grid Convergence Index (GCI) for the fine–medium pair and the medium–coarse pair. The GCI should be reported as a dimensionless decimal (not a percentage) quantifying the estimated fractional uncertainty of the reported solution on the finer grid of the pair. Your program must treat the GCI for the fine–medium pair as $$\\mathrm{GCI}_{21} = F_s \\,\\frac{\\left|Q_2 - Q_1\\right|}{\\left|Q_1\\right|\\left(r_{21}^p - 1\\right)},$$ and similarly for the medium–coarse pair $$\\mathrm{GCI}_{32} = F_s \\,\\frac{\\left|Q_3 - Q_2\\right|}{\\left|Q_2\\right|\\left(r_{32}^p - 1\\right)},$$ where $r_{21} = h_2/h_1$ and $r_{32} = h_3/h_2$.\n\nYour program must implement a principled procedure to infer $p$ from the truncation error scaling using three-grid data. It must be robust to both positive and negative differences of $Q_i$ and must use absolute differences where appropriate to avoid sign ambiguity in the observed order. If $r_{21} \\neq r_{32}$, your program should solve the nonlinear equation implied by the scaling relationship rather than assuming a common refinement ratio.\n\nPhysical units and output requirements:\n- The inputs $Q_i$ must be interpreted as tracer concentrations in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and grid spacings $h_i$ must be in meters ($\\mathrm{m}$).\n- The outputs $p$, $\\mathrm{GCI}_{21}$, and $\\mathrm{GCI}_{32}$ are dimensionless. Report $\\mathrm{GCI}_{21}$ and $\\mathrm{GCI}_{32}$ as decimal fractions (not percentages).\n\nTest suite:\nUse the following five test cases, each defined by $(h_1,h_2,h_3)$ in meters and $(Q_1,Q_2,Q_3)$ in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$:\n1. Case $1$ (common refinement ratio $r=2$, monotonic convergence, quadratic truncation error): $h_1 = 0.01$, $h_2 = 0.02$, $h_3 = 0.04$; $Q_1 = 1.00005$, $Q_2 = 1.0002$, $Q_3 = 1.0008$.\n2. Case $2$ (common refinement ratio $r=2$, monotonic convergence, non-integer order): $h_1 = 0.02$, $h_2 = 0.04$, $h_3 = 0.08$; $Q_1 = 1.9994343146$, $Q_2 = 1.9984$, $Q_3 = 1.9954745166$.\n3. Case $3$ (common refinement ratio $r=2$, near-asymptotic with small higher-order contamination): $h_1 = 0.01$, $h_2 = 0.02$, $h_3 = 0.04$; $Q_1 = 0.80003005$, $Q_2 = 0.8001204$, $Q_3 = 0.8004832$.\n4. Case $4$ (common refinement ratio $r=2$, very small differences testing numerical robustness): $h_1 = 0.001$, $h_2 = 0.002$, $h_3 = 0.004$; $Q_1 = 1.5000001$, $Q_2 = 1.5000004$, $Q_3 = 1.5000016$.\n5. Case $5$ (unequal refinement ratios, monotonic convergence): $h_1 = 0.01$, $h_2 = 0.015$, $h_3 = 0.027$; $Q_1 = 0.7500159247$, $Q_2 = 0.7500388040$, $Q_3 = 0.7501413000$.\n\nFinal output format:\nYour program should produce a single line of output containing a comma-separated list of five inner lists, each inner list holding three floating-point numbers $[p,\\mathrm{GCI}_{21},\\mathrm{GCI}_{32}]$ for the corresponding test case. The overall format must be exactly:\n$$\\text{[}[p_1,\\mathrm{GCI}_{21,1},\\mathrm{GCI}_{32,1}], [p_2,\\mathrm{GCI}_{21,2},\\mathrm{GCI}_{32,2}], [p_3,\\mathrm{GCI}_{21,3},\\mathrm{GCI}_{32,3}], [p_4,\\mathrm{GCI}_{21,4},\\mathrm{GCI}_{32,4}], [p_5,\\mathrm{GCI}_{21,5},\\mathrm{GCI}_{32,5}]\\text{]}.$$\nAll numerical values must be printed as standard Python floating-point literals. No additional text should be printed.",
            "solution": "The user-provided problem statement has been analyzed and found to be valid. It is scientifically grounded in the principles of numerical analysis and verification and validation, specifically concerning grid convergence studies. The problem is well-posed, objective, and contains all necessary information to derive and compute the requested quantities.\n\nThe solution proceeds in two stages: first, a principled derivation of the formulas for the observed order of accuracy ($p$) and the Grid Convergence Index (GCI), and second, the implementation of these formulas in a Python script to solve the given test cases.\n\n### Derivation of the Observed Order of Accuracy ($p$)\n\nThe starting point is the assumed power-law scaling of the truncation error for a computed scalar quantity $Q(h)$ as a function of grid spacing $h$:\n$$Q(h) = Q^\\ast + C\\,h^p + \\mathcal{O}\\!\\left(h^{p+1}\\right)$$\nHere, $Q^\\ast$ is the exact, grid-independent solution, $C$ is a constant, and $p$ is the order of accuracy of the numerical method. Given three solutions $Q_1$, $Q_2$, and $Q_3$ computed on three grids with spacings $h_1$, $h_2$, and $h_3$ (where $h_1 < h_2 < h_3$), we can write a system of three equations by neglecting the higher-order terms $\\mathcal{O}(h^{p+1})$. This is a valid approximation when the grid is sufficiently refined to be in the asymptotic range.\n\n$$Q_1 \\approx Q^\\ast + C h_1^p \\quad (1)$$\n$$Q_2 \\approx Q^\\ast + C h_2^p \\quad (2)$$\n$$Q_3 \\approx Q^\\ast + C h_3^p \\quad (3)$$\n\nOur objective is to determine $p$ by eliminating the unknowns $Q^\\ast$ and $C$. First, we eliminate $Q^\\ast$ by subtracting consecutive equations:\n$$Q_2 - Q_1 = C (h_2^p - h_1^p) \\quad (4)$$\n$$Q_3 - Q_2 = C (h_3^p - h_2^p) \\quad (5)$$\n\nNext, we eliminate the constant $C$ by taking the ratio of equation ($5$) to equation ($4$). To ensure the ratio is well-defined and positive, particularly for monotonic convergence where the differences $(Q_2 - Q_1)$ and $(Q_3 - Q_2)$ have the same sign, we use absolute values as specified in the problem:\n$$\\frac{|Q_3 - Q_2|}{|Q_2 - Q_1|} = \\frac{|C (h_3^p - h_2^p)|}{|C (h_2^p - h_1^p)|} = \\frac{|h_3^p - h_2^p|}{|h_2^p - h_1^p|}$$\nSince $h_1 < h_2 < h_3$ and $p > 0$ for a converging method, the terms $(h_2^p - h_1^p)$ and $(h_3^p - h_2^p)$ are both positive. Thus, the absolute value signs on the right-hand side can be removed.\nLet's define the grid refinement ratios $r_{21} = h_2/h_1$ and $r_{32} = h_3/h_2$. The equation becomes:\n$$\\frac{|Q_3 - Q_2|}{|Q_2 - Q_1|} = \\frac{h_2^p(r_{32}^p - 1)}{h_1^p(r_{21}^p - 1)} = \\left(\\frac{h_2}{h_1}\\right)^p \\frac{r_{32}^p - 1}{r_{21}^p - 1} = r_{21}^p \\frac{r_{32}^p - 1}{r_{21}^p - 1}$$\n\nThis is the general equation for the observed order of accuracy $p$.\n\n**Special Case: Constant Refinement Ratio**\nIn many practical studies, the grid is refined by a constant factor, i.e., $r_{21} = r_{32} = r$. In this special case, the general equation simplifies significantly. Let $R = \\frac{|Q_3 - Q_2|}{|Q_2 - Q_1|}$.\n$$R = r^p \\frac{r^p - 1}{r^p - 1} = r^p$$\nWe can solve for $p$ by taking the natural logarithm of both sides:\n$$\\ln(R) = \\ln(r^p) = p \\ln(r)$$\n$$p = \\frac{\\ln(R)}{\\ln(r)} = \\frac{\\ln\\left(\\frac{|Q_3 - Q_2|}{|Q_2 - Q_1|}\\right)}{\\ln(r)}$$\n\n**General Case: Unequal Refinement Ratios**\nWhen $r_{21} \\neq r_{32}$, we must solve the general nonlinear equation for $p$:\n$$R = r_{21}^p \\frac{r_{32}^p - 1}{r_{21}^p - 1}$$\nThis equation is not analytically solvable for $p$ in a simple closed form. It must be solved numerically. We can rearrange it into a root-finding problem, $f(p) = 0$:\n$$f(p) = r_{21}^p (r_{32}^p - 1) - R (r_{21}^p - 1) = 0$$\nUsing $h_3 = r_{32}h_2 = r_{32}r_{21}h_1$, we can rewrite the terms with a common base:\n$$f(p) = (r_{21}r_{32})^p - r_{21}^p - R(r_{21}^p - 1) = \\left(\\frac{h_3}{h_1}\\right)^p - (1+R)\\left(\\frac{h_2}{h_1}\\right)^p + R = 0$$\nA numerical root-finding algorithm, such as Brent's method, can be applied to this function to find the value of $p$. A suitable search interval for $p$ (e.g., $[0.1, 8]$) is typically used, as common numerical methods have orders of accuracy in this range.\n\n### Calculation of the Grid Convergence Index (GCI)\n\nThe GCI is an estimate of the fractional numerical uncertainty in the solution. The problem provides the formulas to be used, which are standard in the field. With a fixed safety factor $F_s = 1.25$, the GCIs for the fine-medium grid pair ($1,2$) and the medium-coarse grid pair ($2,3$) are:\n$$\\mathrm{GCI}_{21} = F_s \\,\\frac{\\left|Q_2 - Q_1\\right|}{\\left|Q_1\\right|\\left(r_{21}^p - 1\\right)}$$\n$$\\mathrm{GCI}_{32} = F_s \\,\\frac{\\left|Q_3 - Q_2\\right|}{\\left|Q_2\\right|\\left(r_{32}^p - 1\\right)}$$\nOnce the order of accuracy $p$ is determined from the three-grid data, these indices can be calculated directly. The values are dimensionless and reported as decimal fractions.\n\n### Algorithmic Procedure\n\nThe computational procedure for each test case is as follows:\n1.  Given $(h_1, h_2, h_3)$ and $(Q_1, Q_2, Q_3)$, compute the grid refinement ratios $r_{21} = h_2/h_1$ and $r_{32} = h_3/h_2$.\n2.  Compute the ratio of the solution differences, $R = |Q_3 - Q_2|/|Q_2 - Q_1|$.\n3.  Compare $r_{21}$ and $r_{32}$.\n    - If they are equal (within a small numerical tolerance), calculate $p$ using the simplified logarithmic formula: $p = \\ln(R) / \\ln(r_{21})$.\n    - If they are unequal, solve the nonlinear equation $f(p) = (h_3/h_1)^p - (1+R)(h_2/h_1)^p + R = 0$ for $p$ using a numerical root-finding algorithm.\n4.  Using the computed value of $p$, calculate $\\mathrm{GCI}_{21}$ and $\\mathrm{GCI}_{32}$ using their respective formulas.\n5.  Return the triplet $[p, \\mathrm{GCI}_{21}, \\mathrm{GCI}_{32}]$.\nThis procedure is implemented for each of the five test cases provided.",
            "answer": "```\n[[2.0,6.249687515623219e-05,0.0002499500124975005],[1.500000000028249,0.0007808219198642289,0.0014885817887309534],[2.004456578499252,0.0001499587440409028,0.0005990264024317188],[2.0,6.249999375000039e-07,2.49999833333345e-06],[2.200000227181056,2.9734927063412573e-05,9.091176211181609e-05]]\n```"
        }
    ]
}