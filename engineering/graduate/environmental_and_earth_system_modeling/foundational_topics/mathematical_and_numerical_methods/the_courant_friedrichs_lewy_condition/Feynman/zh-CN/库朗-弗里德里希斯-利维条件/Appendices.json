{
    "hands_on_practices": [
        {
            "introduction": "一维线性平流方程是环境模型中描述物质输运的基础。这个练习  探讨了一种理想情况：当库朗数恰好为1时，一阶迎风格式的数值解会发生什么。通过分析这个特殊情况，我们可以直观地理解CFL条件的物理本质，即当数值依赖域与物理依赖域完全匹配时，数值方案能够精确地传播信息，而不会产生数值弥散。",
            "id": "2139538",
            "problem": "考虑一维线性平流方程，该方程模拟了某个量 $u$ 以恒定速度的输运过程。该方程由下式给出：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x, t)$ 是在位置 $x$ 和时间 $t$ 的输运量，$c$ 是一个恒定的正平流速度 ($c > 0$)。该方程在空间域 $x \\in (-\\infty, \\infty)$ 和时间 $t \\ge 0$ 上求解。\n\n在 $t=0$ 时的初始条件是一个定义明确的局部脉冲 $u(x, 0) = f(x)$，它仅在一个有限区间上非零。\n\n为了数值求解该方程，我们建立一个具有均匀空间步长 $\\Delta x$ 和均匀时间步长 $\\Delta t$ 的计算网格。网格点由 $x_j = j \\Delta x$ 和 $t_n = n \\Delta t$ 表示，其中 $j$ 是整数，$n$ 是非负整数。令 $U_j^n$ 表示 $u(x_j, t_n)$ 的数值近似值。\n\n数值解采用一阶迎风有限差分格式。给定正平流速度 $c>0$，该格式通过对时间导数使用向前差分、对空间导数使用向后差分进行离散化来定义：\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0\n$$\n特别地，我们选择网格步长 $\\Delta x$ 和时间步长 $\\Delta t$，使得定义为 $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ 的库朗数（Courant number）恰好等于 1。\n\n在系统演化 $N$ 个时间步长（其中 $N$ 是一个正整数）后，下列哪个陈述最能描述数值解的轮廓 $\\{U_j^N\\}_{j \\in \\mathbb{Z}}$ 与初始离散轮廓 $\\{U_j^0\\}_{j \\in \\mathbb{Z}}$ 之间的关系？\n\nA. 数值解在网格点上与精确解析解完全相同，表示初始轮廓的一次完美的、保持形状的平移。\n\nB. 脉冲的峰值减小，其基底变宽，表明存在数值耗散。\n\nC. 数值解中出现了虚假振荡，特别是在初始脉冲中梯度较大的区域附近。\n\nD. 数值解的量值无界增长，表明存在数值不稳定性。\n\nE. 脉冲发生了平移，但变得不对称，一侧比另一侧更陡峭。\n\nF. 脉冲保持在其初始位置的中心，但其振幅随时间衰减。",
            "solution": "连续问题是具有恒定正速度 $c>0$ 的线性平流方程，\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\n其初始条件 $u(x,0)=f(x)$ 是紧支集函数。根据特征线法，沿着满足 $\\frac{\\mathrm{d}x}{\\mathrm{d}t}=c$ 的曲线，解是恒定的。因此，精确解为\n$$\nu(x,t) = f(x - c t).\n$$\n\n在具有 $x_j=j \\Delta x$，$t_n=n \\Delta t$ 的均匀网格上，对于 $c>0$ 的一阶迎风格式为\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0.\n$$\n引入库朗数 $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ 并重新整理可得\n$$\nU_j^{n+1} = U_j^n - \\sigma \\left(U_j^n - U_{j-1}^n\\right) = (1-\\sigma) U_j^n + \\sigma U_{j-1}^n.\n$$\n当特别选择 $\\sigma=1$ 时，此更新方程简化为纯粹的移位算子\n$$\nU_j^{n+1} = U_{j-1}^n.\n$$\n将此恒等式迭代 $N$ 个时间步长，得到\n$$\nU_j^{N} = U_{j-1}^{N-1} = \\cdots = U_{j-N}^{0}.\n$$\n因此，离散轮廓被精确地向右平移了 $N$ 个网格单元，形状或振幅没有任何改变。\n\n为了与时间 $t_N = N \\Delta t$ 时网格点上的精确解进行比较，计算\n$$\nu(x_j, t_N) = f(x_j - c t_N) = f\\big(j \\Delta x - c N \\Delta t\\big).\n$$\n由于 $\\sigma= \\frac{c \\Delta t}{\\Delta x} = 1$，我们有 $c N \\Delta t = N \\Delta x$，因此\n$$\nu(x_j, t_N) = f\\big((j-N)\\Delta x\\big) = f(x_{j-N}).\n$$\n根据初始离散数据的定义，$U_{j-N}^{0} = f(x_{j-N})$，所以\n$$\nU_j^{N} = U_{j-N}^{0} = u(x_j, t_N).\n$$\n因此，在网格点上，数值解与解析解完全吻合，表示初始轮廓向右完美地、保持形状地平移了 $N$ 个单元。在这种情况下，数值耗散、虚假振荡、不稳定性、不对称性或静止衰减等效应均未发生。\n\n正确选项是 A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在真实的环境与地球系统中，如大气或海洋流动，非线性效应普遍存在，这意味着波速并非一个恒定的参数。这个练习  引入了无粘性伯格斯方程作为非线性平流问题的原型。它迫使我们思考如何在一个特征速度（在此为流体速度 $u$）随空间和时间变化的系统中应用CFL条件，这引导我们发展出一种更为动态和稳健的策略：根据每个时间步长上全域的最大波速来确定稳定的时间步长。",
            "id": "2139603",
            "problem": "一个计算工程师团队正在为一个长通道内的一维、无粘性、可压缩流体流动开发一个模拟程序。该流动的动力学由无粘性伯格斯方程（inviscid Burgers' equation）建模，这是一个基本的非线性偏微分方程（PDE）：\n$$ u_t + u u_x = 0 $$\n其中 $u(x,t)$ 是流体在位置 $x$ 和时间 $t$ 的速度。\n\n该团队计划在间距为 $\\Delta x$ 的均匀空间网格上，使用显式有限差分格式对该方程进行数值求解。该格式的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定。对于所使用的特定格式，该条件由下式给出：\n$$ \\frac{\\max_x |u(x, t)| \\Delta t}{\\Delta x} \\le 1 $$\n其中 $\\Delta t$ 是时间步长。这意味着对于每个时间步，$\\Delta t$ 的选择必须足够小，以满足基于该时刻整个空间域上存在的最大速度幅值的条件。\n\n该模拟在 $t=0$ 时刻，在域 $x \\in [-L, L]$ 上使用以下速度分布进行初始化：\n$$ u(x, 0) = A \\sin\\left(\\frac{\\pi x}{L}\\right) + B $$\n模拟的参数如下：\n- 通道半长, $L = 5.00 \\text{ m}$\n- 速度振幅, $A = 2.00 \\text{ m/s}$\n- 速度偏移, $B = 0.500 \\text{ m/s}$\n- 空间网格间距, $\\Delta x = 0.100 \\text{ m}$\n\n计算可用于模拟第一步（即从 $t=0$ 推进到 $t=\\Delta t$）的最大稳定时间步长 $\\Delta t_{max}$。答案以秒为单位，并保留三位有效数字。",
            "solution": "数值稳定性由 Courant-Friedrichs-Lewy 条件决定，对于此格式为\n$$\n\\frac{\\max_{x}|u(x,t)|\\,\\Delta t}{\\Delta x}\\leq 1.\n$$\n对于 $t=0$ 时的第一个时间步，这给出\n$$\n\\Delta t_{\\max}=\\frac{\\Delta x}{\\max_{x}|u(x,0)|}.\n$$\n初始条件是\n$$\nu(x,0)=A\\sin\\!\\left(\\frac{\\pi x}{L}\\right)+B,\\quad x\\in[-L,L].\n$$\n令 $s=\\sin\\!\\left(\\frac{\\pi x}{L}\\right)$，则在 $x\\in[-L,L]$ 上有 $s\\in[-1,1]$。定义\n$$\ng(s)=|A s+B|,\\quad s\\in[-1,1].\n$$\n由于 $g(s)$ 是 $s$ 的仿射函数的绝对值，所以它是凸函数，因此它在闭区间上的最大值在端点处取得。因此，\n$$\n\\max_{x\\in[-L,L]}|u(x,0)|=\\max_{s\\in[-1,1]}|A s+B|=\\max\\big(|A+B|,\\;|B-A|\\big).\n$$\n代入 $A=2.00$ 和 $B=0.500$，\n$$\n|A+B|=2.50,\\qquad |B-A|=1.50,\n$$\n因此\n$$\n\\max_{x}|u(x,0)|=2.50.\n$$\n当 $\\Delta x=0.100$ 时，最大稳定时间步长为\n$$\n\\Delta t_{\\max}=\\frac{0.100}{2.50}=0.0400,\n$$\n保留三位有效数字。",
            "answer": "$$\\boxed{0.0400}$$"
        },
        {
            "introduction": "冯·诺依曼稳定性分析等理论工具为我们预测数值误差的增长或衰减提供了数学依据，但亲眼见证这一过程会带来更深刻的理解。这个编码练习  提供了一个绝佳的机会，通过数值实验来验证稳定性理论。你将通过编写代码，模拟网格上最高波数（或奈奎斯特频率）模式的演化，并亲自量化其在不同库朗数下的放大因子，从而直观地观察到当CFL条件被违背时，数值不稳定性是如何戏剧性地发生的。",
            "id": "3922279",
            "problem": "考虑周期性域中被动示踪剂的一维线性平流，其模型为偏微分方程 $\\,\\partial \\phi/\\partial t + u\\,\\partial \\phi/\\partial x = 0\\,$，其中 $\\,\\phi(x,t)\\,$ 是示踪剂浓度，$\\,u\\,$ 是恒定的平流速度，空间域被离散为 $\\,N\\,$ 个网格点，均匀间距为 $\\,\\Delta x\\,$。Courant-Friedrichs-Lewy (CFL) 条件是一项稳定性要求，它通过无量纲数 $\\,C = u\\,\\Delta t/\\Delta x\\,$ 约束了时间步长 $\\,\\Delta t\\,$、网格间距 $\\,\\Delta x\\,$ 和特征速度 $\\,u\\,$ 之间的关系。\n\n当 $\\,u>0\\,$ 时，在周期性边界条件下，使用前向欧拉时间步进和一阶迎风空间差分，网格索引为 $\\,i\\,$、时间层级为 $\\,n\\,$ 的全离散更新公式为\n$$\n\\phi_i^{n+1} = \\phi_i^n - C\\left(\\phi_i^n - \\phi_{i-1}^n\\right),\n$$\n其中 $\\,C = u\\,\\Delta t/\\Delta x\\,$，且周期性意味着 $\\,\\phi_{-1}^n = \\phi_{N-1}^n\\,$。\n\n构建一个数值实验，将示踪剂初始化为网格上可分辨的最高波数模式，即对所有 $\\,i \\in \\{0,1,\\dots,N-1\\}\\,$，$\\,\\phi_i^0 = (-1)^i\\,$，然后使用上述格式将解推进指定的步数。在每一步，通过投影到 $\\,(-1)^i\\,$ 来计算该最高波数模式的标量振幅，方法如下：\n$$\nA^n = \\frac{1}{N}\\sum_{i=0}^{N-1} \\phi_i^n\\,(-1)^i.\n$$\n将每步放大因子定义为整个演化过程中绝对比值 $\\,|A^{n+1}/A^n|\\,$ 的几何平均值：\n$$\n\\mathcal{G} = \\left(\\prod_{n=0}^{n_{\\text{steps}}-1} \\left|\\frac{A^{n+1}}{A^n}\\right|\\right)^{1/n_{\\text{steps}}}.\n$$\n\n您的程序必须：\n- 实现上述带周期性边界的数值格式。\n- 初始化 $\\,\\phi_i^0 = (-1)^i\\,$。\n- 对每个测试用例，计算并返回每步放大因子 $\\,\\mathcal{G}\\,$，结果为浮点数，四舍五入到六位小数。\n\n使用物理上一致的单位：$\\,u\\,$ 单位为 $\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\\,$，$\\,\\Delta x\\,$ 单位为 $\\,\\mathrm{m}\\,$，$\\,\\Delta t\\,$ 单位为 $\\,\\mathrm{s}\\,$。在涉及波数-相位关系时，角度应理解为弧度。不涉及百分比。\n\n测试套件：\n- 用例 $\\,1\\,$ (超出稳定性阈值的增长)：$\\,N=64\\,$, $\\,\\Delta x = 100\\,\\mathrm{m}\\,$, $\\,u = 10\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta t = 12\\,\\mathrm{s}\\,$, $\\,n_{\\text{steps}} = 8\\,$. 这将得到 $\\,C = 1.2\\,$。\n- 用例 $\\,2\\,$ (稳定性的边界)：$\\,N=64\\,$, $\\,\\Delta x = 100\\,\\mathrm{m}\\,$, $\\,u = 10\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta t = 10\\,\\mathrm{s}\\,$, $\\,n_{\\text{steps}} = 8\\,$. 这将得到 $\\,C = 1.0\\,$。\n- 用例 $\\,3\\,$ (稳定且强衰减)：$\\,N=64\\,$, $\\,\\Delta x = 100\\,\\mathrm{m}\\,$, $\\,u = 10\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta t = 3\\,\\mathrm{s}\\,$, $\\,n_{\\text{steps}} = 8\\,$. 这将得到 $\\,C = 0.3\\,$。\n- 用例 $\\,4\\,$ (稳定且中度衰减)：$\\,N=64\\,$, $\\,\\Delta x = 100\\,\\mathrm{m}\\,$, $\\,u = 10\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\\,$, $\\,\\Delta t = 7.5\\,\\mathrm{s}\\,$, $\\,n_{\\text{steps}} = 8\\,$. 这将得到 $\\,C = 0.75\\,$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含四个测试用例的结果，格式为方括号括起来的逗号分隔列表，例如 $\\,\\texttt{[r_1,r_2,r_3,r_4]}\\,$, 其中每个 $\\,r_j\\,$ 是四舍五入到六位小数的每步放大因子 $\\,\\mathcal{G}\\,$。",
            "solution": "问题陈述已经过验证，被认为是**有效的**。它具有科学依据，问题定义明确，客观，并包含构建唯一、可验证解所需的所有必要信息。该问题描述了计算流体动力学中的一个标准数值实验，用于研究线性平流方程一阶迎风格式的稳定性。\n\n### 1. 理论分析：放大因子\n\n该问题通过分析数值格式对单个傅里叶模式的影响来研究其稳定性。离散更新方程由下式给出\n$$\n\\phi_i^{n+1} = \\phi_i^n - C\\left(\\phi_i^n - \\phi_{i-1}^n\\right)\n$$\n其中 $C = u\\,\\Delta t/\\Delta x$ 是 Courant 数。\n\n为了确定该格式的稳定性，我们使用 von Neumann 稳定性分析。我们考虑形式为 $\\phi_j^n = \\hat{\\phi}^n e^{i k x_j}$ 的单个傅里叶模式，其中 $k$ 是波数，$x_j = j\\Delta x$ 是网格点位置，$\\hat{\\phi}^n$ 是时间层级 $n$ 的复振幅。将其代入离散方程可得：\n$$\n\\hat{\\phi}^{n+1} e^{ikj\\Delta x} = \\hat{\\phi}^n e^{ikj\\Delta x} - C \\left( \\hat{\\phi}^n e^{ikj\\Delta x} - \\hat{\\phi}^n e^{ik(j-1)\\Delta x} \\right)\n$$\n放大因子 $G(k)$ 是连续时间步长中振幅的比值，即 $G(k) = \\hat{\\phi}^{n+1} / \\hat{\\phi}^n$。将方程两边同除以 $\\hat{\\phi}^n e^{ikj\\Delta x}$ 可得：\n$$\nG(k) = 1 - C(1 - e^{-ik\\Delta x})\n$$\n问题指定了初始条件 $\\phi_i^0 = (-1)^i$。这个特定模式对应于网格上可分辨的最高波数，通常称为奈奎斯特频率。它可以写成 $\\phi_i^0 = e^{i\\pi i}$，这意味着无量纲波数为 $k\\Delta x = \\pi$。\n\n将 $k\\Delta x = \\pi$ 代入放大因子表达式：\n$$\nG(k\\Delta x = \\pi) = 1 - C(1 - e^{-i\\pi}) = 1 - C(1 - (-1)) = 1 - 2C\n$$\n这表明对于特定模式 $\\phi_i^n = A^n (-1)^i$，下一个时间步的振幅由 $A^{n+1} = (1-2C) A^n$ 给出。因此，绝对振幅的比值在每个时间步都是恒定的：\n$$\n\\left|\\frac{A^{n+1}}{A^n}\\right| = |1 - 2C|\n$$\n问题将每步放大因子 $\\mathcal{G}$ 定义为在 $n_{\\text{steps}}$ 个步长内这些比值的几何平均值：\n$$\n\\mathcal{G} = \\left(\\prod_{n=0}^{n_{\\text{steps}}-1} \\left|\\frac{A^{n+1}}{A^n}\\right|\\right)^{1/n_{\\text{steps}}}\n$$\n由于该比值为恒定值 $|1 - 2C|$，所以几何平均值就是这个值：\n$$\n\\mathcal{G} = \\left( \\prod_{n=0}^{n_{\\text{steps}}-1} |1-2C| \\right)^{1/n_{\\text{steps}}} = \\left( (|1-2C|)^{n_{\\text{steps}}} \\right)^{1/n_{\\text{steps}}} = |1-2C|\n$$\n因此，问题中描述的数值实验对于每个测试用例，都应产生一个等于 $|1-2C|$ 的 $\\mathcal{G}$ 结果。\n\n### 2. 算法实现\n\n数值实验通过遵循所提供的离散方程和定义来实现。\n\n**初始化**：对于每个测试用例，我们给定网格大小 $N$、网格间距 $\\Delta x$、速度 $u$、时间步长 $\\Delta t$ 和步数 $n_{\\text{steps}}$。首先计算 Courant 数 $C = u\\,\\Delta t/\\Delta x$。初始化一个大小为 $N$ 的一维数组 `phi` 来表示 $t=0$ 时的示踪剂浓度，其值为 $\\phi_i^0 = (-1)^i$。\n\n**时间演化**：解在 $n_{\\text{steps}}$ 步的循环中向前推进。在每次迭代中，代表从时间层级 $n$ 到 $n+1$ 的一步：\n1.  当前状态 $\\phi^n$ 用于计算下一个状态 $\\phi^{n+1}$。更新方程 $\\phi_i^{n+1} = \\phi_i^n - C(\\phi_i^n - \\phi_{i-1}^n)$ 同时应用于所有网格点。这可以通过向量运算高效实现。项 $\\phi_{i-1}^n$ 需要访问相邻网格点的值。对于周期性域，$\\phi_{-1}^n = \\phi_{N-1}^n$。这种周期性移位可以由 `numpy.roll` 函数优雅地处理，该函数循环移位 `phi` 数组的元素。\n2.  在更新前计算最高波数模式的振幅 $A^n$，更新后计算 $A^{n+1}$。公式 $A^k = \\frac{1}{N}\\sum_{i=0}^{N-1} \\phi_i^k (-1)^i$ 的实现方式是状态向量 `phi` 与一个预先计算的、元素为 $(-1)^i$ 的投影向量进行点积，然后除以 $N$。\n3.  计算并存储绝对比值 $|A^{n+1}/A^n|$。\n\n**最终计算**：时间步进循环完成后，将每步放大因子 $\\mathcal{G}$ 计算为所有存储比值的几何平均值。计算方法是将这些比值的乘积取 $1/n_{\\text{steps}}$ 次方。由于此问题中 $A^{n+1}/A^n = 1-2C$ 关系的精确性，每个计算出的比值（在浮点精度范围内）将是相同的，几何平均值将等于此常数值。\n\n此过程直接实现了问题陈述中的定义，并作为对上述分析结果的数值验证。\n\n测试用例涵盖了格式不稳定 ($C > 1$)、临界稳定 ($C=1$) 和稳定 ($0  C  1$) 的情景，展示了放大因子在每种情况下的行为。\n-   用例 1 ($C=1.2$)：$\\mathcal{G} = |1 - 2.4| = 1.4$。不稳定增长。\n-   用例 2 ($C=1.0$)：$\\mathcal{G} = |1 - 2.0| = 1.0$。临界稳定，振幅无变化。\n-   用例 3 ($C=0.3$)：$\\mathcal{G} = |1 - 0.6| = 0.4$。稳定，强衰减。\n-   用例 4 ($C=0.75$)：$\\mathcal{G} = |1 - 1.5| = 0.5$。稳定，中度衰减。\n\n程序以数值方式计算这些值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical experiment problem for the 1D linear advection equation.\n\n    For each test case, it simulates the evolution of the highest-wavenumber mode\n    using a first-order upwind scheme and computes the per-step amplification factor.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, delta_x, u, delta_t, n_steps)\n        # Case 1 (growth beyond stability threshold)\n        (64, 100.0, 10.0, 12.0, 8),\n        # Case 2 (boundary of stability)\n        (64, 100.0, 10.0, 10.0, 8),\n        # Case 3 (stable with strong decay)\n        (64, 100.0, 10.0, 3.0, 8),\n        # Case 4 (stable with moderate decay)\n        (64, 100.0, 10.0, 7.5, 8),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, delta_x, u, delta_t, n_steps = case\n        \n        # Calculate the Courant number, C = u * dt / dx.\n        C = u * delta_t / delta_x\n        \n        # Initialize the tracer field phi for the highest resolvable wavenumber mode.\n        # phi_i^0 = (-1)^i\n        indices = np.arange(N)\n        phi = (-1.0)**indices\n        \n        # Define the projection vector (-1)^i for calculating the amplitude A^n.\n        projection_vector = (-1.0)**indices\n        \n        # Calculate the initial amplitude A^0.\n        # A^0 = (1/N) * sum(phi_i^0 * (-1)^i) = (1/N) * sum((-1)^i * (-1)^i)\n        #   = (1/N) * sum(1) = 1.0\n        # We calculate it numerically for completeness.\n        A_current = (1.0 / N) * np.dot(phi, projection_vector)\n\n        # List to store the per-step amplitude ratios |A^{n+1}/A^n|.\n        ratios = []\n        \n        # Main time-stepping loop.\n        for _ in range(n_steps):\n            # Store the current state phi^n.\n            phi_old = phi\n            \n            # Get phi_{i-1} for all i, applying periodic boundary condition.\n            # np.roll(phi_old, 1) shifts elements to the right, so the new element\n            # at index i is the old element from index i-1.\n            phi_prev = np.roll(phi_old, 1)\n            \n            # Update phi to phi^{n+1} using the first-order upwind scheme.\n            # phi_i^{n+1} = phi_i^n - C * (phi_i^n - phi_{i-1}^n)\n            phi = phi_old - C * (phi_old - phi_prev)\n            \n            # Calculate the new amplitude A^{n+1}.\n            A_next = (1.0 / N) * np.dot(phi, projection_vector)\n            \n            # Calculate the ratio of absolute amplitudes and store it.\n            # Since test cases do not result in C=0.5, A_current will not be zero,\n            # so direct division is safe.\n            ratio = np.abs(A_next / A_current)\n            ratios.append(ratio)\n            \n            # Update the amplitude for the next iteration.\n            A_current = A_next\n        \n        # Compute the per-step amplification factor G as the geometric mean of the ratios.\n        product_of_ratios = np.prod(ratios)\n        geo_mean = product_of_ratios**(1.0 / n_steps)\n        \n        results.append(geo_mean)\n\n    # Format the results to six decimal places and print in the required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}