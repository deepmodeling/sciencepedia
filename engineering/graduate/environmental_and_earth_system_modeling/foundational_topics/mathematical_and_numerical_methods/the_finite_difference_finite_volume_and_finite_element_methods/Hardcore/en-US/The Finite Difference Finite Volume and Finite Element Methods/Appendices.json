{
    "hands_on_practices": [
        {
            "introduction": "The Finite Difference Method (FDM) approximates derivatives directly on a grid, offering a straightforward way to discretize partial differential equations. However, not all plausible schemes are viable; some are inherently unstable, causing errors to grow exponentially. This exercise introduces the von Neumann stability analysis, a fundamental tool for diagnosing such instabilities by examining how the amplitude of Fourier modes evolves in time. By applying this analysis to the classic Forward-Time Centered-Space (FTCS) scheme for linear advection, you will uncover why this intuitive scheme fails and gain essential skills in ensuring the numerical integrity of a model .",
            "id": "3922982",
            "problem": "Consider the one-dimensional linear advection of a passive, conservative tracer in a straight, periodic channel, governed by the partial differential equation $u_{t} + a\\,u_{x} = 0$, where $u(x,t)$ is the tracer concentration and $a$ is a constant advection speed. On a uniform spatial grid with spacing $\\Delta x$ and discrete time step $\\Delta t$, approximate $u_{t}$ with the forward finite difference and $u_{x}$ with the centered finite difference to obtain the Forward-Time Centered-Space (FTCS) scheme. Assume periodic boundary conditions so that Fourier analysis is applicable. Perform a von Neumann stability analysis of the FTCS scheme, starting from the conservation law $u_{t} + a\\,u_{x} = 0$ and the definitions of the forward and centered finite differences, and proceed from first principles by:\n\n- Deriving the linear update relation for the spatial Fourier mode $e^{\\mathrm{i}k x}$.\n- Obtaining the amplification factor as a function of the dimensionless Courant number $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$ and the discrete phase $\\theta = k\\,\\Delta x$.\n- Identifying the instability condition by analyzing the magnitude of the amplification factor.\n\nReport, as your final answer, the maximum amplification factor per time step over all spatial Fourier modes, expressed purely as a symbolic function of the Courant number $\\nu$. Do not include units. No rounding is required.",
            "solution": "The governing conservation law is $u_{t} + a\\,u_{x} = 0$. On a uniform grid with $x_{j} = j\\,\\Delta x$ and times $t^{n} = n\\,\\Delta t$, the Forward-Time Centered-Space (FTCS) discretization replaces $u_{t}$ with the forward difference $(u_{j}^{n+1} - u_{j}^{n})/\\Delta t$ and $u_{x}$ with the centered difference $(u_{j+1}^{n} - u_{j-1}^{n})/(2\\,\\Delta x)$. Substituting these approximations into the conservation law gives\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\,\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = 0,\n$$\nwhich can be rearranged into the explicit update\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right).\n$$\nDefine the Courant number $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$. Then the update reads\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right).\n$$\nFor von Neumann stability analysis, consider a single Fourier mode on the periodic grid,\n$$\nu_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,x_{j}\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,j\\,\\theta\\right),\n$$\nwhere $k$ is the continuous wavenumber, $\\theta = k\\,\\Delta x$ is the discrete phase, and $\\hat{u}^{n}$ is the mode amplitude at time level $n$. Then\n$$\nu_{j+1}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,(j+1)\\,\\theta\\right) = \\exp(\\mathrm{i}\\,\\theta)\\,u_{j}^{n}, \\quad\nu_{j-1}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,(j-1)\\,\\theta\\right) = \\exp(-\\mathrm{i}\\,\\theta)\\,u_{j}^{n}.\n$$\nSubstitute these into the update:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{\\nu}{2}\\left(\\exp(\\mathrm{i}\\,\\theta)\\,u_{j}^{n} - \\exp(-\\mathrm{i}\\,\\theta)\\,u_{j}^{n}\\right).\n$$\nFactor out $u_{j}^{n}$:\n$$\nu_{j}^{n+1} = \\left[1 - \\frac{\\nu}{2}\\left(\\exp(\\mathrm{i}\\,\\theta) - \\exp(-\\mathrm{i}\\,\\theta)\\right)\\right]\\,u_{j}^{n}.\n$$\nUsing the identity $\\exp(\\mathrm{i}\\,\\theta) - \\exp(-\\mathrm{i}\\,\\theta) = 2\\,\\mathrm{i}\\,\\sin(\\theta)$, we obtain the amplification factor $G(\\theta)$ defined by $u_{j}^{n+1} = G(\\theta)\\,u_{j}^{n}$:\n$$\nG(\\theta) = 1 - \\mathrm{i}\\,\\nu\\,\\sin(\\theta).\n$$\nThe magnitude of the amplification factor is\n$$\n|G(\\theta)|^{2} = \\left(1\\right)^{2} + \\left(\\nu\\,\\sin(\\theta)\\right)^{2} = 1 + \\nu^{2}\\,\\sin^{2}(\\theta),\n$$\nso\n$$\n|G(\\theta)| = \\sqrt{1 + \\nu^{2}\\,\\sin^{2}(\\theta)}.\n$$\nFor stability in the sense of von Neumann, one requires $|G(\\theta)| \\leq 1$ for all $\\theta$. However, for any nonzero Courant number $\\nu \\neq 0$ and any nontrivial mode with $\\sin(\\theta) \\neq 0$, we have $|G(\\theta)|  1$. Thus the FTCS scheme for linear advection is unconditionally unstable: it exhibits amplification for all nontrivial Fourier modes whenever $\\nu \\neq 0$.\n\nTo report the maximum amplification per time step over all spatial Fourier modes, we take the supremum of $|G(\\theta)|$ over $\\theta \\in [0,\\pi]$. Because $|\\sin(\\theta)| \\leq 1$, the maximum occurs at $|\\sin(\\theta)| = 1$, yielding\n$$\n\\max_{\\theta}|G(\\theta)| = \\sqrt{1 + \\nu^{2}}.\n$$\nThis spectral radius of the amplification factor concisely characterizes the instability of the FTCS scheme for advection.",
            "answer": "$$\\boxed{\\sqrt{1 + \\nu^{2}}}$$"
        },
        {
            "introduction": "The Finite Volume Method (FVM) is founded on the integral form of conservation laws, making it exceptionally well-suited for problems involving shocks or discontinuities. The method's core lies in defining a consistent \"numerical flux\" at the interfaces between control volumes. This practice guides you through the construction of such a flux, contrasting a simple first-order upwind scheme with a more accurate Godunov-type flux derived from a local Riemann problem solution . This comparison is central to understanding the development of modern high-resolution schemes used in environmental and fluid dynamics modeling.",
            "id": "3922951",
            "problem": "Consider one-dimensional conservative transport of a passive tracer in an environmental flow modeled by the linear advection equation $q_{t} + (a q)_{x} = 0$ with constant velocity $a$. In a finite volume formulation on a uniform grid with cell centers $x_{i}$ and cell width $\\Delta x$, let the cell averages at a given time be $q_{i-1}$, $q_{i}$, and $q_{i+1}$ for three consecutive cells. You will construct a piecewise-linear reconstruction using the minmod limiter, form the left trace at the interface $x_{i+1/2}$, and then compute the numerical flux at $x_{i+1/2}$ using Godunovâ€™s exact Riemann solver for linear advection. For comparison, compute also the first-order upwind flux at the same interface.\n\nData are as follows: $a = 0.63\\,\\mathrm{m\\,s^{-1}}$, $\\Delta x = 1000\\,\\mathrm{m}$, $q_{i-1} = 0.657$, $q_{i} = 0.700$, and $q_{i+1} = 0.750$. Assume the reconstruction in cell $i$ is $q_{i}(x) = q_{i} + \\sigma_{i} (x - x_{i})$ with slope $\\sigma_{i}$ given by the minmod limiter acting on the one-sided slopes, that is, $\\sigma_{i} = \\mathrm{minmod}\\!\\left(\\frac{q_{i}-q_{i-1}}{\\Delta x}, \\frac{q_{i+1}-q_{i}}{\\Delta x}\\right)$, where $\\mathrm{minmod}(r,s)$ returns $0$ if $r s \\le 0$ and otherwise returns the argument with smaller absolute value.\n\nStarting from the conservation law and the definition of a Riemann problem for linear advection, derive the Godunov flux at $x_{i+1/2}$ in terms of the reconstructed left and right traces. Then, using the provided data, compute numerically:\n- the Godunov flux $F^{G}_{i+1/2}$, using the exact Riemann solution for linear advection,\n- the first-order upwind flux $F^{U}_{i+1/2}$, defined by $F^{U}_{i+1/2} = a\\, q_{i}$ for $a0$,\nand finally, the scalar difference $F^{G}_{i+1/2} - F^{U}_{i+1/2}$.\n\nExpress your final answer for $F^{G}_{i+1/2} - F^{U}_{i+1/2}$ in $\\mathrm{m\\,s^{-1}}$. Round your answer to five significant figures.",
            "solution": "The problem requires a series of calculations to determine the difference between a second-order Godunov flux and a first-order upwind flux for the linear advection equation.\n\nFirst, we establish the theoretical basis for the Godunov flux. The governing equation is a conservation law of the form $q_{t} + f(q)_{x} = 0$, where the flux function is $f(q) = aq$. Godunov's method computes the numerical flux at a cell interface, say $x_{i+1/2}$, by solving the Riemann problem defined by the reconstructed states to the left ($q_{i+1/2}^L$) and right ($q_{i+1/2}^R$) of the interface. The initial condition for this local Riemann problem is:\n$$\nq(x, t^n) = \n\\begin{cases} \nq_{i+1/2}^L  \\text{if } x  x_{i+1/2} \\\\\nq_{i+1/2}^R  \\text{if } x  x_{i+1/2} \n\\end{cases}\n$$\nThe exact solution to the linear advection equation $q_t + aq_x = 0$ is $q(x,t) = q_0(x-at)$, which describes a wave propagating with constant speed $a$. The solution to the Riemann problem is thus a contact discontinuity moving at speed $a$. The value of the solution at the interface location $x = x_{i+1/2}$ for time $tt^n$ depends on the sign of $a$.\n- If $a  0$, information propagates from left to right. The solution at the interface is the value from the left state: $q(x_{i+1/2}, t) = q_{i+1/2}^L$.\n- If $a  0$, information propagates from right to left. The solution at the interface is the value from the right state: $q(x_{i+1/2}, t) = q_{i+1/2}^R$.\n\nThe Godunov flux is $F^{G}_{i+1/2} = f(q(x_{i+1/2}, t))$. Since $f(q) = aq$ and the provided velocity is $a = 0.63\\,\\mathrm{m\\,s^{-1}}  0$, the Godunov flux is determined by the left state:\n$$F^{G}_{i+1/2} = a q_{i+1/2}^L$$\nThe left state $q_{i+1/2}^L$ is the value of the reconstructed solution in cell $i$ evaluated at the right cell boundary, $x_{i+1/2}$. The reconstruction in cell $i$ is given as $q_i(x) = q_i + \\sigma_i(x-x_i)$. The position of the right boundary is $x_{i+1/2} = x_i + \\frac{\\Delta x}{2}$. Therefore, the left trace is:\n$$q_{i+1/2}^L = q_i(x_i + \\frac{\\Delta x}{2}) = q_i + \\sigma_i \\left( (x_i + \\frac{\\Delta x}{2}) - x_i \\right) = q_i + \\sigma_i \\frac{\\Delta x}{2}$$\nThe slope $\\sigma_i$ is calculated using the minmod limiter on the centered-difference slopes derived from adjacent cells. Let the backward and forward slopes be $s_L = \\frac{q_i - q_{i-1}}{\\Delta x}$ and $s_R = \\frac{q_{i+1}-q_i}{\\Delta x}$, respectively. Then $\\sigma_i = \\mathrm{minmod}(s_L, s_R)$.\n\nWe now proceed with the numerical calculation using the given data:\n$a = 0.63$, $\\Delta x = 1000$, $q_{i-1} = 0.657$, $q_{i} = 0.700$, and $q_{i+1} = 0.750$.\n\n1.  Calculate the one-sided slopes for cell $i$:\n    $$s_L = \\frac{q_i - q_{i-1}}{\\Delta x} = \\frac{0.700 - 0.657}{1000} = \\frac{0.043}{1000} = 0.000043$$\n    $$s_R = \\frac{q_{i+1} - q_i}{\\Delta x} = \\frac{0.750 - 0.700}{1000} = \\frac{0.050}{1000} = 0.000050$$\n\n2.  Apply the minmod limiter to find the slope $\\sigma_i$:\n    Since $s_L = 0.000043  0$ and $s_R = 0.000050  0$, their product $s_L s_R$ is positive. The minmod function returns the argument with the smaller absolute value.\n    $$|s_L| = 0.000043  |s_R| = 0.000050$$\n    Thus, $\\sigma_i = s_L = 0.000043$.\n\n3.  Calculate the left trace $q_{i+1/2}^L$:\n    $$q_{i+1/2}^L = q_i + \\sigma_i \\frac{\\Delta x}{2} = 0.700 + (0.000043) \\frac{1000}{2} = 0.700 + (0.000043)(500)$$\n    $$q_{i+1/2}^L = 0.700 + 0.0215 = 0.7215$$\n\n4.  Calculate the Godunov flux $F^{G}_{i+1/2}$:\n    $$F^{G}_{i+1/2} = a q_{i+1/2}^L = (0.63)(0.7215) = 0.454545$$\n\n5.  Calculate the first-order upwind flux $F^{U}_{i+1/2}$:\n    The problem defines this flux for $a  0$ as $F^{U}_{i+1/2} = a q_{i}$.\n    $$F^{U}_{i+1/2} = (0.63)(0.700) = 0.441$$\n\n6.  Calculate the difference $F^{G}_{i+1/2} - F^{U}_{i+1/2}$:\n    $$F^{G}_{i+1/2} - F^{U}_{i+1/2} = 0.454545 - 0.441 = 0.013545$$\n\nThe problem asks for the result to be rounded to five significant figures. The calculated value $0.013545$ has exactly five significant figures (the leading zeros are not significant). Therefore, no rounding is necessary. The units are $\\mathrm{m\\,s^{-1}}$, as $a$ is in $\\mathrm{m\\,s^{-1}}$ and $q$ is dimensionless.",
            "answer": "$$\\boxed{0.013545}$$"
        },
        {
            "introduction": "The Finite Element Method (FEM) offers great flexibility for handling complex geometries by approximating the solution with piecewise polynomial functions over unstructured elements. This approach transforms a differential equation into a system of algebraic equations whose coefficients are derived from integrals over each element, forming the elemental \"mass\" and \"stiffness\" matrices. This exercise provides hands-on practice in calculating these fundamental matrix components for a simple triangular element, revealing the essential mechanics behind the assembly process in FEM .",
            "id": "3923008",
            "problem": "In a two-dimensional, homogeneous aquifer patch, the transient diffusion of a dissolved tracer with concentration $c(x,y,t)$ is modeled by the conservation law\n$$\n\\sigma \\,\\frac{\\partial c}{\\partial t} \\;=\\; \\nabla \\cdot \\left( \\kappa \\,\\nabla c \\right),\n$$\nwhere $\\sigma$ is a constant volumetric capacity coefficient and $\\kappa$ is a constant isotropic diffusivity. Consider a single linear triangular finite element in the Finite Element Method (FEM) with vertices at physical coordinates $(0,0)$, $(3,0)$, and $(0,4)$ in meters. Let $\\{N_1,N_2,N_3\\}$ be the linear Lagrange shape functions associated with nodes $1$, $2$, and $3$, respectively. Using the standard Galerkin procedure with test functions equal to the shape functions, the element mass matrix and stiffness matrix are defined by integrals over the element domain. Assume the coefficients $\\sigma = 5$ and $\\kappa = 3$ are uniform within the element.\n\nConstruct the consistent element mass matrix and stiffness matrix for this element. For the mass matrix, evaluate the integrals using an exact degree-$2$ Gaussian quadrature on triangles with three points located at barycentric coordinates $(\\frac{1}{6},\\frac{1}{6},\\frac{2}{3})$ and its cyclic permutations, each with weight $\\frac{1}{3}$, applied in the usual form where the integral of a function $f$ over the triangle is $A \\sum_{k=1}^{3} w_k f(\\boldsymbol{\\xi}_k)$ with $A$ the triangle area. For the stiffness matrix, use the definition based on gradients of the shape functions and evaluate the integral exactly.\n\nCompute the ratio\n$$\nQ \\;=\\; \\frac{M_{12}}{-K_{12}},\n$$\nwhere $M_{12}$ and $K_{12}$ denote the $(1,2)$ entries of the mass and stiffness matrices, respectively. Round your final numerical result for $Q$ to four significant figures. The ratio $Q$ is dimensionless; express your answer as a pure number.",
            "solution": "The problem asks for the ratio $Q = \\frac{M_{12}}{-K_{12}}$, where $M_{12}$ and $K_{12}$ are the $(1,2)$ entries of the element mass and stiffness matrices, respectively, for a linear triangular finite element. The governing partial differential equation is $\\sigma \\,\\frac{\\partial c}{\\partial t} = \\nabla \\cdot \\left( \\kappa \\,\\nabla c \\right)$.\n\nFirst, we define the geometry of the triangular element and its properties. The vertices are given as Node $1: (x_1, y_1) = (0,0)$, Node $2: (x_2, y_2) = (3,0)$, and Node $3: (x_3, y_3) = (0,4)$. The area of the triangle, $A$, can be computed using the determinant formula:\n$$\nA = \\frac{1}{2} \\left| \\det \\begin{pmatrix} x_1  y_1  1 \\\\ x_2  y_2  1 \\\\ x_3  y_3  1 \\end{pmatrix} \\right| = \\frac{1}{2} \\left| x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2) \\right|\n$$\nSubstituting the vertex coordinates:\n$$\nA = \\frac{1}{2} | 0(0-4) + 3(4-0) + 0(0-0) | = \\frac{1}{2} |12| = 6\n$$\n\nNext, we establish the linear Lagrange shape functions $N_i(x,y)$ for $i \\in \\{1,2,3\\}$. These functions are linear in $x$ and $y$ and have the property that $N_i(x_j, y_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. The shape functions can be expressed in terms of Cartesian coordinates $(x,y)$:\n$$\nN_1(x,y) = 1 - \\frac{x}{3} - \\frac{y}{4} \\\\\nN_2(x,y) = \\frac{x}{3} \\\\\nN_3(x,y) = \\frac{y}{4}\n$$\nThe gradients of these shape functions are constant over the element:\n$$\n\\nabla N_1 = \\left( \\frac{\\partial N_1}{\\partial x}, \\frac{\\partial N_1}{\\partial y} \\right) = \\left( -\\frac{1}{3}, -\\frac{1}{4} \\right) \\\\\n\\nabla N_2 = \\left( \\frac{\\partial N_2}{\\partial x}, \\frac{\\partial N_2}{\\partial y} \\right) = \\left( \\frac{1}{3}, 0 \\right) \\\\\n\\nabla N_3 = \\left( \\frac{\\partial N_3}{\\partial x}, \\frac{\\partial N_3}{\\partial y} \\right) = \\left( 0, \\frac{1}{4} \\right)\n$$\n\nThe element stiffness matrix, $K$, has entries defined by $K_{ij} = \\int_A \\kappa (\\nabla N_i \\cdot \\nabla N_j) \\, dA$. Since the diffusivity $\\kappa$ and the gradients $\\nabla N_i$ are constant over the element, the integral simplifies to:\n$$\nK_{ij} = \\kappa (\\nabla N_i \\cdot \\nabla N_j) \\int_A \\, dA = \\kappa A (\\nabla N_i \\cdot \\nabla N_j)\n$$\nWe need to compute the entry $K_{12}$. The dot product of the gradients is:\n$$\n\\nabla N_1 \\cdot \\nabla N_2 = \\left( -\\frac{1}{3} \\right) \\left( \\frac{1}{3} \\right) + \\left( -\\frac{1}{4} \\right) (0) = -\\frac{1}{9}\n$$\nWith $\\kappa = 3$ and $A=6$, the stiffness matrix entry $K_{12}$ is:\n$$\nK_{12} = (3)(6) \\left( -\\frac{1}{9} \\right) = 18 \\left( -\\frac{1}{9} \\right) = -2\n$$\n\nThe element mass matrix, $M$, has entries defined by $M_{ij} = \\int_A \\sigma N_i N_j \\, dA$. For linear elements, the exact analytical formula for the off-diagonal entries is $M_{ij} = \\sigma \\frac{A}{12}$ for $i \\ne j$.\nUsing this formula, we get:\n$$\nM_{12} = 5 \\times \\frac{6}{12} = 5 \\times 0.5 = 2.5\n$$\nThe problem specifies using a 3-point Gaussian quadrature rule, which is exact for quadratic polynomials. The integrand $\\sigma N_1 N_2$ is quadratic, so the result must be identical. Let's verify this. The quadrature formula is $\\int_A f(\\boldsymbol{\\xi}) \\, dA \\approx A \\sum_{k=1}^{3} w_k f(\\boldsymbol{\\xi}_k)$. The barycentric coordinates of the quadrature points are given as cyclic permutations of $(\\frac{2}{3}, \\frac{1}{6}, \\frac{1}{6})$, with weights $w_k = \\frac{1}{3}$. In barycentric coordinates, the shape functions are $N_1=L_1, N_2=L_2, N_3=L_3$.\n$$\nM_{12} = \\sigma \\int_A N_1 N_2 \\, dA \\approx \\sigma A \\sum_{k=1}^{3} w_k N_1(\\boldsymbol{\\xi}_k) N_2(\\boldsymbol{\\xi}_k)\n$$\nThe values of $N_1 N_2$ at the three points are:\nPoint 1 $(L_1,L_2,L_3) = (\\frac{2}{3}, \\frac{1}{6}, \\frac{1}{6})$: $N_1 N_2 = \\frac{2}{3} \\cdot \\frac{1}{6} = \\frac{1}{9}$.\nPoint 2 $(L_1,L_2,L_3) = (\\frac{1}{6}, \\frac{2}{3}, \\frac{1}{6})$: $N_1 N_2 = \\frac{1}{6} \\cdot \\frac{2}{3} = \\frac{1}{9}$.\nPoint 3 $(L_1,L_2,L_3) = (\\frac{1}{6}, \\frac{1}{6}, \\frac{2}{3})$: $N_1 N_2 = \\frac{1}{6} \\cdot \\frac{1}{6} = \\frac{1}{36}$.\nSumming these contributions:\n$$\nM_{12} \\approx (5)(6) \\left( \\frac{1}{3} \\right) \\left( \\frac{1}{9} + \\frac{1}{9} + \\frac{1}{36} \\right) = 10 \\left( \\frac{4}{36} + \\frac{4}{36} + \\frac{1}{36} \\right) = 10 \\left( \\frac{9}{36} \\right) = 10 \\left( \\frac{1}{4} \\right) = 2.5\n$$\nThe quadrature result confirms the exact value.\n\nFinally, we compute the ratio $Q$:\n$$\nQ = \\frac{M_{12}}{-K_{12}}\n$$\nSubstituting the calculated values $M_{12} = 2.5$ and $K_{12} = -2$:\n$$\nQ = \\frac{2.5}{-(-2)} = \\frac{2.5}{2} = 1.25\n$$\nThe problem requires the result to be rounded to four significant figures. This means we should express $1.25$ as $1.250$.",
            "answer": "$$\n\\boxed{1.250}\n$$"
        }
    ]
}