{
    "hands_on_practices": [
        {
            "introduction": "在将数值格式应用于复杂的地球系统模型之前，通过理论分析来理解其内在属性至关重要。一个强有力的工具是修正方程分析，它揭示了离散化过程引入的误差项。这项练习将通过对两种经典平流格式——一阶迎风格式和二阶Lax-Wendroff格式——进行修正方程分析，来实践这一核心技能 ()。通过推导，您将学会如何判断一个格式的精度，并识别其主导误差项是表现为耗散性的数值扩散（通常与偶数阶导数相关）还是导致相位错误的数值频散（与奇数阶导数相关），这是理解和预测数值模拟行为的基础。",
            "id": "3899299",
            "problem": "考虑在一个流速恒定为 $c>0$ 的直通道中的一维被动示踪剂平流，其由线性平流方程 $u_t + c\\,u_x = 0$ 控制，其中 $u(x,t)$ 是一个足够光滑的浓度场。设空间网格是均匀的，间距为 $\\Delta x$，时间步长为 $\\Delta t$，并定义 Courant–Friedrichs–Lewy (CFL) 数为 $C \\equiv c\\,\\Delta t/\\Delta x$。在该网格上考虑两种有限差分格式：针对 $c>0$ 的时间向前-空间迎风格式，由 $u_j^{n+1} = u_j^n - C\\left(u_j^n - u_{j-1}^n\\right)$ 给出；以及 Lax–Wendroff 格式，由 $u_j^{n+1} = u_j^n - \\frac{C}{2}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{C^2}{2}\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right)$ 给出。以关于 $(x_j,t^n)$ 的泰勒展开和控制方程 $u_t + c\\,u_x = 0$ 为基本依据，论证每种格式在空间和时间上的形式精度阶数，并将其修正方程中的主导项分类为耗散型（导致振幅衰减的偶数阶空间导数项）或色散型（导致相位误差的奇数阶空间导数项）。下列哪个陈述正确地描述了这两种格式？\n\nA. 时间向前-空间迎风格式是一阶精度的，其修正方程主导项是耗散型的；Lax–Wendroff 格式是二阶精度的，其修正方程主导项是色散型的。\n\nB. 时间向前-空间迎风格式是二阶精度的，其修正方程主导项是色散型的；Lax–Wendroff 格式是一阶精度的，其修正方程主导项是耗散型的。\n\nC. 两种格式都是一阶精度的，其修正方程主导项都是耗散型的。\n\nD. 时间向前-空间迎风格式是一阶精度的，其修正方程主导项是色散型的；Lax–Wendroff 格式是二阶精度的，其修正方程主导项是耗散型的。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **控制方程：** 被动示踪剂浓度 $u(x,t)$ 的一维线性平流方程为 $u_t + c\\,u_x = 0$，其中流速 $c>0$ 为常数。\n- **离散化：** 空间网格是均匀的，间距为 $\\Delta x$，时间步长为 $\\Delta t$。\n- **CFL 数：** Courant–Friedrichs–Lewy (CFL) 数定义为 $C \\equiv c\\,\\Delta t/\\Delta x$。\n- **格式 1 (时间向前-空间迎风，FTUS)：** 对于 $c>0$，格式为 $u_j^{n+1} = u_j^n - C\\left(u_j^n - u_{j-1}^n\\right)$。\n- **格式 2 (Lax–Wendroff, LW)：** 格式为 $u_j^{n+1} = u_j^n - \\frac{C}{2}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{C^2}{2}\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right)$。\n- **分析方法：** 分析需要使用关于 $(x_j, t^n)$ 的泰勒展开和控制方程来确定形式精度阶数，并将修正方程的主导项分类为耗散型（偶数阶空间导数）或色散型（奇数阶空间导数）。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于基本的线性平流方程以及用于求解该方程的两种最经典、研究最充分的有限差分格式（FTUS 和 Lax-Wendroff）。其分析方法，即使用泰勒级数推导修正方程，从而确定数值误差特性（耗散和色散），是偏微分方程数值分析领域的标准核心技术。该问题在科学上是合理的。\n- **适定性：** 该问题是适定的。它要求使用一种指定的、标准的分析程序来描述已知的数值格式。所有必要的定义和方程都已提供。问题明确，没有歧义，并能导出一个唯一的、可验证的结论。\n- **客观性：** 该问题以精确、客观的数学语言陈述。格式的定义和分析任务是清晰的，不容主观解释。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。这是偏微分方程数值分析中的一个标准练习。将按要求对每种格式进行分析以求解。\n\n### 修正方程的推导\n\n为了找到精度阶数和主导误差项的性质，我们为每种格式推导其修正方程。这是通过对有限差分方程中的每一项围绕点 $(x_j, t^n)$ 进行泰勒级数展开来实现的，其中 $u_j^n = u(x_j, t^n)$。我们将使用记法 $u_t = \\frac{\\partial u}{\\partial t}$，$u_x = \\frac{\\partial u}{\\partial x}$，$u_{tt} = \\frac{\\partial^2 u}{\\partial t^2}$，$u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$ 等，所有导数均在点 $(x_j, t^n)$ 处计算。\n\n根据控制方程 $u_t = -c u_x$，假设 $c$ 是常数且 $u$ 足够光滑，我们可以将高阶时间导数用空间导数表示：\n$u_{tt} = \\frac{\\partial}{\\partial t}(-c u_x) = -c \\frac{\\partial}{\\partial x}(u_t) = -c \\frac{\\partial}{\\partial x}(-c u_x) = c^2 u_{xx}$\n$u_{ttt} = \\frac{\\partial}{\\partial t}(c^2 u_{xx}) = c^2 \\frac{\\partial^2}{\\partial x^2}(u_t) = c^2 \\frac{\\partial^2}{\\partial x^2}(-c u_x) = -c^3 u_{xxx}$\n\n#### 时间向前-空间迎风 (FTUS) 格式的分析\n\nFTUS 格式为 $u_j^{n+1} = u_j^n - C(u_j^n - u_{j-1}^n)$。\n首先，我们将格式两边同除以 $\\Delta t$ 并代入 $C = c\\Delta t/\\Delta x$ 来重写该格式：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -\\frac{c \\Delta t}{\\Delta x \\Delta t} (u_j^n - u_{j-1}^n) = -c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} $$\n现在我们对两边进行泰勒级数展开。\n左侧 (LHS)：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{(u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + \\dots) - u}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + O((\\Delta t)^2) $$\n右侧 (RHS)：\n$$ -c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = -c \\frac{u - (u - \\Delta x u_x + \\frac{(\\Delta x)^2}{2}u_{xx} - \\dots)}{\\Delta x} = -c \\frac{\\Delta x u_x - \\frac{(\\Delta x)^2}{2}u_{xx} + \\dots}{\\Delta x} = -c u_x + \\frac{c\\Delta x}{2}u_{xx} + O((\\Delta x)^2) $$\n令LHS和RHS的展开式相等：\n$$ u_t + \\frac{\\Delta t}{2}u_{tt} + \\dots = -c u_x + \\frac{c\\Delta x}{2}u_{xx} + \\dots $$\n重新整理以匹配原始偏微分方程，我们得到修正方程：\n$$ u_t + c u_x = -\\frac{\\Delta t}{2}u_{tt} + \\frac{c\\Delta x}{2}u_{xx} + O((\\Delta x)^2, (\\Delta t)^2) $$\n代入 $u_{tt} = c^2 u_{xx}$：\n$$ u_t + c u_x = -\\frac{\\Delta t}{2}(c^2 u_{xx}) + \\frac{c\\Delta x}{2}u_{xx} + \\dots = \\left( \\frac{c\\Delta x}{2} - \\frac{c^2\\Delta t}{2} \\right) u_{xx} + \\dots $$\n提取公因式并使用 $C = c\\Delta t/\\Delta x$：\n$$ u_t + c u_x = \\frac{c\\Delta x}{2} \\left(1 - \\frac{c\\Delta t}{\\Delta x}\\right) u_{xx} + \\dots = \\frac{c\\Delta x}{2} (1 - C) u_{xx} + \\text{H.O.T.} $$\n截断误差是右侧的各项，其主导部分为 $O(\\Delta x, \\Delta t)$。因此，FTUS 格式在空间和时间上都是 **一阶精度** 的。主导误差项与 $u_{xx}$ 成正比，这是一个二阶（偶数阶）空间导数。该项的作用类似于一个扩散项，因此主导误差是 **耗散的**。\n\n#### Lax-Wendroff (LW) 格式的分析\n\nLW 格式为 $u_j^{n+1} = u_j^n - \\frac{C}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{C^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$。\n同样，我们将格式两边同除以 $\\Delta t$ 并代入 $C$ 来重写该格式：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -\\frac{c}{2\\Delta x}(u_{j+1}^n - u_{j-1}^n) + \\frac{c^2\\Delta t}{2(\\Delta x)^2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n) $$\n现在我们展开每一项。\nLHS：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{(\\Delta t)^2}{6}u_{ttt} + O((\\Delta t)^3) $$\nRHS 各项：\nRHS 第一项是 $-c u_x$ 的中心差分近似：\n$$ -\\frac{c}{2\\Delta x}(u_{j+1}^n - u_{j-1}^n) = -\\frac{c}{2\\Delta x}( (u+\\Delta x u_x + \\frac{(\\Delta x)^2}{2}u_{xx} + \\frac{(\\Delta x)^3}{6}u_{xxx}+\\dots) - (u-\\Delta x u_x + \\frac{(\\Delta x)^2}{2}u_{xx} - \\frac{(\\Delta x)^3}{6}u_{xxx}+\\dots) ) $$\n$$ = -\\frac{c}{2\\Delta x}(2\\Delta x u_x + \\frac{(\\Delta x)^3}{3}u_{xxx} + \\dots) = -c u_x - \\frac{c(\\Delta x)^2}{6}u_{xxx} + O((\\Delta x)^4) $$\nRHS 第二项与 $u_{xx}$ 的中心差分近似有关：\n$$ \\frac{c^2\\Delta t}{2(\\Delta x)^2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n) = \\frac{c^2\\Delta t}{2(\\Delta x)^2}((\\Delta x)^2 u_{xx} + \\frac{(\\Delta x)^4}{12}u_{xxxx}+\\dots) = \\frac{c^2\\Delta t}{2}u_{xx} + \\frac{c^2\\Delta t(\\Delta x)^2}{24}u_{xxxx} + \\dots $$\n组合展开式：\n$$ u_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{(\\Delta t)^2}{6}u_{ttt} + \\dots = -c u_x - \\frac{c(\\Delta x)^2}{6}u_{xxx} + \\frac{c^2\\Delta t}{2}u_{xx} + \\dots $$\n重新整理以形成修正方程：\n$$ u_t + c u_x = -\\frac{\\Delta t}{2}u_{tt} + \\frac{c^2\\Delta t}{2}u_{xx} - \\frac{(\\Delta t)^2}{6}u_{ttt} - \\frac{c(\\Delta x)^2}{6}u_{xxx} + \\text{H.O.T.} $$\n现在，代入时间导数：$u_{tt} = c^2 u_{xx}$ 和 $u_{ttt} = -c^3 u_{xxx}$。\n$$ u_t + c u_x = \\left(-\\frac{c^2\\Delta t}{2} + \\frac{c^2\\Delta t}{2}\\right)u_{xx} + \\left(\\frac{c^3(\\Delta t)^2}{6} - \\frac{c(\\Delta x)^2}{6}\\right)u_{xxx} + \\text{H.O.T.} $$\n含有 $u_{xx}$ 的项相互抵消，这是 Lax-Wendroff 格式的设计使然。主导误差项是与 $u_{xxx}$ 相关的那一项：\n$$ u_t + c u_x = -\\frac{c(\\Delta x)^2}{6}\\left(1 - \\frac{c^2(\\Delta t)^2}{(\\Delta x)^2}\\right)u_{xxx} + \\text{H.O.T.} = -\\frac{c(\\Delta x)^2}{6}(1 - C^2)u_{xxx} + \\text{H.O.T.} $$\n截断误差为 $O((\\Delta x)^2, (\\Delta t)^2)$，因此 Lax-Wendroff 格式是 **二阶精度** 的。主导误差项与 $u_{xxx}$ 成正比，这是一个三阶（奇数阶）空间导数。该项会引起相位误差，因此主导误差是 **色散的**。\n\n### 逐项分析选项\n\n根据推导：\n- **FTUS：** 一阶精度，主导误差是耗散的。\n- **Lax-Wendroff：** 二阶精度，主导误差是色散的。\n\n我们现在评估给定的选项：\n\n**A. 时间向前-空间迎风格式是一阶精度的，其修正方程主导项是耗散型的；Lax–Wendroff 格式是二阶精度的，其修正方程主导项是色散型的。**\n该陈述准确地反映了我们对两种格式的分析结果。\n**结论：正确。**\n\n**B. 时间向前-空间迎风格式是二阶精度的，其修正方程主导项是色散型的；Lax–Wendroff 格式是一阶精度的，其修正方程主导项是耗散型的。**\n该陈述错误地交换了两种格式的特性。\n**结论：错误。**\n\n**C. 两种格式都是一阶精度的，其修正方程主导项都是耗散型的。**\n该陈述是错误的，因为 Lax-Wendroff 格式是二阶精度的，并且其主导误差项是色散型的。\n**结论：错误。**\n\n**D. 时间向前-空间迎风格式是一阶精度的，其修正方程主导项是色散型的；Lax–Wendroff 格式是二阶精度的，其修正方程主导项是耗散型的。**\n该陈述错误地分类了两种格式主导误差项的性质。FTUS 是耗散的，不是色散的。Lax-Wendroff 是色散的，不是耗散的。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理论分析为我们预测数值误差的类型提供了框架，但通过实际模拟来观察这些误差的影响则能带来更深刻的直观理解。本练习将理论付诸实践，要求您模拟一个高斯脉冲在周期性区域中的平流过程。您将分别使用具有强烈数值扩散的一阶迎风格式和以数值频散为主的Lax-Wendroff格式，并在一周期后通过计算方差衰减和相位漂移来量化这两种截然不同的数值误差 ()。这项实践能够清晰地展示数值扩散如何使信号平滑衰减，而数值频散又如何导致信号变形和伪振荡。",
            "id": "3803225",
            "problem": "考虑一个被动示踪剂的一维线性平流，其由偏微分方程 $u_t + c u_x = 0$ 在长度为 $L$、速度为常数 $c$ 的周期性域上控制。在没有物理扩散的情况下，精确解会输运任何初始条件 $u(x,0)$，而不会改变其形状、总质量或空间方差。然而，离散数值格式会引入数值误差，这些误差可分解为两种效应：数值扩散（降低示踪剂波动方差的振幅阻尼）和数值频散（会移动或扭曲特征而不一定改变其振幅的相位误差）。您的任务是使用两种标准的显式格式，对高斯脉冲在整整一个平流周期 $T = L/c$ 内的这两种效应进行量化。\n\n实现一个程序，该程序：\n- 在具有 $N$ 个点、网格间距 $\\Delta x = L/N$ 的均匀周期性网格上表示解，时间步长 $\\Delta t$ 根据指定的 Courant–Friedrichs–Lewy 数 (CFL) $\\mathrm{C} = c \\Delta t / \\Delta x$ 选择。\n- 将示踪剂初始化为以 $x_0$ 为中心、标准差为 $\\sigma$ 的高斯脉冲，定义在 $[0,L)$ 上：\n$$\nu(x,0) = \\exp\\left(-\\frac{(d(x;x_0))^2}{2 \\sigma^2}\\right),\n$$\n其中 $d(x;x_0)$ 是圆 $[0,L)$ 上 $x$ 和 $x_0$ 之间的最小周期距离，因此 $d \\in \\left[-\\frac{L}{2},\\frac{L}{2}\\right]$。\n- 使用以下保守、周期性的有限差分更新规则之一，将示踪剂演化整整一个周期 $T = L/c$（空间用索引 $i \\in \\{0,\\dots,N-1\\}$ 离散化，时间层为 $n$）：\n    1. 一阶迎风格式（对于 $c \\ge 0$）：\n    $$\n    u_i^{n+1} = u_i^n - \\mathrm{C}\\,\\left(u_i^n - u_{i-1}^n\\right),\n    $$\n    使用周期性索引 $u_{-1}^n \\equiv u_{N-1}^n$。\n    2. Lax–Wendroff 格式（二阶）：\n    $$\n    u_i^{n+1} = u_i^n - \\frac{\\mathrm{C}}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right) + \\frac{\\mathrm{C}^2}{2}\\left(u_{i+1}^n - 2 u_i^n + u_{i-1}^n\\right),\n    $$\n    使用周期性索引。\n- 确保时间步数 $n_T$ 精确满足 $n_T \\Delta t = T$。对于下面的测试套件，通过选择 $\\mathrm{C}$ 使 $T/\\Delta t = N/\\mathrm{C}$ 为整数来保证这一点。\n- 通过在 $t=0$ 和 $t=T$ 之间，零均值示踪剂场的离散空间方差（每单位长度）的衰减来量化数值扩散。将时间 $t^n$ 的离散均值和方差定义为\n$$\n\\overline{u}^n = \\frac{1}{N} \\sum_{i=0}^{N-1} u_i^n, \\quad \\mathrm{Var}^n = \\frac{1}{N} \\sum_{i=0}^{N-1} \\left(u_i^n - \\overline{u}^n\\right)^2.\n$$\n报告比率\n$$\nR_{\\mathrm{var}} = \\frac{\\mathrm{Var}^{n_T}}{\\mathrm{Var}^{0}},\n$$\n如果存在数值扩散，该比率应小于 $1$；对于完全无扩散的演化，该比率等于 $1$。\n- 通过零均值示踪剂场的主导大尺度傅里叶模式在一个周期内的残余相移来量化数值频散。令 $\\widehat{U}_1^n$ 表示在时间 $t^n$，波数为 $k_1 = 2\\pi/L$（$k=1$ 模式）时零均值场的离散傅里叶系数，通过离散傅里叶变换的约定计算\n$$\n\\widehat{U}_k^n = \\sum_{j=0}^{N-1} \\left(u_j^n - \\overline{u}^n\\right) \\exp\\left(-\\mathrm{i}\\, \\frac{2\\pi k j}{N}\\right).\n$$\n对于任何整数空间傅里叶模式，精确的连续解在一个周期后没有净相位变化。因此，$k=1$ 模式的任何非零相位变化都是纯粹由数值引起的。定义包裹相位差\n$$\n\\Delta \\phi = \\mathrm{wrap}\\left(\\arg\\left(\\widehat{U}_1^{n_T}\\right) - \\arg\\left(\\widehat{U}_1^{0}\\right)\\right),\n$$\n其中 $\\mathrm{wrap}(\\theta)$ 将角度映射到 $(-\\pi,\\pi]$。将此相位差转换为以米为单位的等效空间相移\n$$\n\\Delta x_{\\mathrm{phase}} = -\\,\\frac{L}{2\\pi}\\,\\Delta \\phi,\n$$\n这是一周期后主导模式的残余空间位移。报告以米为单位的 $\\Delta x_{\\mathrm{phase}}$。\n\n您的程序必须为每个测试用例计算列表 $[R_{\\mathrm{var}}, \\Delta x_{\\mathrm{phase}}]$，并将所有测试用例的结果汇总到标准输出的一行中，格式为一个由方括号括起来的逗号分隔列表，其中每个元素本身是对应一个测试用例的两个浮点数列表。不应打印任何其他文本。\n\n所有物理量必须使用指定的单位处理：$L$ 以米 ($\\mathrm{m}$) 为单位，$c$ 以米/秒 ($\\mathrm{m/s}$) 为单位，$T$ 以秒 ($\\mathrm{s}$) 为单位，$\\Delta x_{\\mathrm{phase}}$ 以米 ($\\mathrm{m}$) 为单位。用于相位计算的内部角度必须是弧度。\n\n测试套件：\n实现下面的四个情况。对于每种情况，运行整整一个周期并报告 $[R_{\\mathrm{var}}, \\Delta x_{\\mathrm{phase}}]$。\n\n- 情况 A（一阶迎风格式，中等 $\\mathrm{C}$ 值）：$L = 1.0\\,\\mathrm{m}$，$N = 256$，$c = 1.0\\,\\mathrm{m/s}$，$\\mathrm{C} = 0.5$，$\\sigma = 0.05\\,L$，$x_0 = 0.3\\,L$。\n- 情况 B（Lax–Wendroff 格式，中等 $\\mathrm{C}$ 值）：$L = 1.0\\,\\mathrm{m}$，$N = 256$，$c = 1.0\\,\\mathrm{m/s}$，$\\mathrm{C} = 0.5$，$\\sigma = 0.05\\,L$，$x_0 = 0.3\\,L$。\n- 情况 C（一阶迎风格式，极限 $\\mathrm{C}$ 值）：$L = 1.0\\,\\mathrm{m}$，$N = 200$，$c = 1.0\\,\\mathrm{m/s}$，$\\mathrm{C} = 1.0$，$\\sigma = 0.08\\,L$，$x_0 = 0.4\\,L$。\n- 情况 D（Lax–Wendroff 格式，窄脉冲）：$L = 1.0\\,\\mathrm{m}$，$N = 256$，$c = 1.0\\,\\mathrm{m/s}$，$\\mathrm{C} = 0.5$，$\\sigma = 0.01\\,L$，$x_0 = 0.25\\,L$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个有四个元素的列表，每个元素都是一个按 $[R_{\\mathrm{var}}, \\Delta x_{\\mathrm{phase}}]$ 顺序排列的包含两个浮点数的列表，分别对应情况 A、B、C 和 D。例如：\n`[[r_A, s_A], [r_B, s_B], [r_C, s_C], [r_D, s_D]]`\n其中每个 `r` 和 `s` 都是一个浮点数。输出中不要包含单位；所有距离均默认为米，所有比率均为无量纲。",
            "solution": "该问题要求量化用于求解一维线性平流方程 $u_t + c u_x = 0$ 的两种有限差分格式的数值扩散和数值频散。该方程描述了在长度为 $L$ 的一维周期性域上，被动示踪剂浓度 $u(x,t)$ 以恒定速度 $c$ 的输运过程。精确解会平移初始示踪剂剖面 $u(x,0)$，而形状、振幅或方差均不发生任何变化。然而，数值格式会引入误差，这些误差表现为数值扩散（振幅的阻尼）和数值频散（导致形状失真的相位误差）。任务是在一个完整的平流周期 $T = L/c$ 之后，计算高斯初始条件下的这些误差。\n\n解决方案是通过首先离散化控制方程，实现指定的数值格式，然后对模拟的初始和最终状态应用明确定义的度量标准来制定的。\n\n**1. 离散化和模拟设置**\n\n连续域 $[0, L)$ 被离散化为 $N$ 个点的均匀网格，索引为 $i = 0, \\dots, N-1$。网格点位于 $x_i = i \\Delta x$，其中网格间距为 $\\Delta x = L/N$。时间被离散化为大小为 $\\Delta t$ 的步长。空间和时间离散化之间的关系由 Courant–Friedrichs–Lewy (CFL) 数控制，定义为 $\\mathrm{C} = c \\Delta t / \\Delta x$。为了所用显式格式的稳定性，该数值必须受到限制。\n\n模拟运行的总时长为 $T = L/c$，这对应于一个特征在周期性域上精确平流一圈所需的时间。总时间步数 $n_T$ 的选择使得 $n_T \\Delta t = T$。通过代入 $T$、$\\Delta t$ 和 $\\mathrm{C}$ 的定义，我们得到 $n_T = \\frac{L/c}{( \\mathrm{C} \\Delta x / c)} = \\frac{L}{\\mathrm{C} (L/N)} = N/\\mathrm{C}$。问题保证对于所有测试用例，$N/\\mathrm{C}$ 都是整数，从而确保模拟在一个周期时精确终止。\n\n**2. 初始条件**\n\n初始示踪剂分布是一个高斯脉冲，由以下公式给出：\n$$\nu(x,0) = \\exp\\left(-\\frac{(d(x;x_0))^2}{2 \\sigma^2}\\right)\n$$\n这里，$x_0$ 是脉冲的中心，$\\sigma$ 是其标准差，$d(x; x_0)$ 是任意点 $x$ 与中心 $x_0$ 之间的最小周期距离。该距离函数正确处理了周期性域的环绕特性，并定义在区间 $[-\\frac{L}{2}, \\frac{L}{2}]$ 上。在网格 $\\{x_i\\}$ 上的离散实现中，每个 $x_i$ 到 $x_0$ 的距离计算为 $d(x_i; x_0) = (x_i - x_0) - L \\cdot \\mathrm{round}((x_i - x_0)/L)$。这确保了高斯脉冲在圆形域上正确定位且对称。\n\n**3. 数值格式**\n\n离散示踪剂场 $u_i^n \\approx u(x_i, t^n)$ 的演化是使用两种显式、保守的有限差分格式计算的。通过对空间索引使用模运算来强制周期性，使得 $u_{i \\pm N}^n = u_i^n$。\n\n*   **一阶迎风格式：** 对于正速度 $c \\ge 0$，该格式由以下公式给出：\n    $$\n    u_i^{n+1} = u_i^n - \\mathrm{C}\\left(u_i^n - u_{i-1}^n\\right)\n    $$\n    该格式在空间和时间上都是一阶精度的。已知在 $0 \\le \\mathrm{C} \\le 1$ 时，该格式是数值稳定的。其主阶截断误差项与二阶空间导数成正比，起到扩散项的作用。因此，该格式具有高耗散性，导致陡峭的梯度被抹平，振幅随时间衰减。在 $\\mathrm{C}=1$ 的特殊情况下，该格式变为 $u_i^{n+1} = u_{i-1}^n$，这是网格上的一个精确位移算子。在这种情况下，离散解被无误差地输运。\n\n*   **Lax–Wendroff 格式：** 这是一种在空间和时间上均为二阶精度的格式：\n    $$\n    u_i^{n+1} = u_i^n - \\frac{\\mathrm{C}}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right) + \\frac{\\mathrm{C}^2}{2}\\left(u_{i+1}^n - 2 u_i^n + u_{i-1}^n\\right)\n    $$\n    Lax–Wendroff 格式在 $|\\mathrm{C}| \\le 1$ 时是稳定的。它的构造旨在消除二阶截断误差项，使其比迎风格式的扩散性显著降低。然而，其主导误差项与三阶空间导数成正比，这会引入频散误差。这些误差导致解的不同傅里叶分量以不正确的相速度传播，从而产生伪振荡，尤其是在陡峭特征附近。\n\n在实现中，这些更新规则在每个时间步都向量化地应用于整个解数组 $u^n$。像 $u_{i\\pm 1}^n$ 这样的项所需的周期性移位可以通过数组滚动操作高效处理。\n\n**4. 数值误差的量化**\n\n计算两个度量标准来量化一个周期 $T$ 后数值扩散和频散的影响。\n\n*   **数值扩散度量 ($R_{\\mathrm{var}}$)：** 数值扩散会阻尼示踪剂波动的振幅。这种效应通过测量解的空间方差的衰减来量化。在时间层 $n$ 的示踪剂场的离散均值和方差为：\n    $$\n    \\overline{u}^n = \\frac{1}{N} \\sum_{i=0}^{N-1} u_i^n, \\quad \\mathrm{Var}^n = \\frac{1}{N} \\sum_{i=0}^{N-1} \\left(u_i^n - \\overline{u}^n\\right)^2\n    $$\n    扩散度量是最终时间 $t^{n_T} = T$ 的方差与初始时间 $t=0$ 的方差之比：\n    $$\n    R_{\\mathrm{var}} = \\frac{\\mathrm{Var}^{n_T}}{\\mathrm{Var}^{0}}\n    $$\n    对于一个完美的、无扩散的格式，$R_{\\mathrm{var}} = 1$。数值扩散的存在导致 $R_{\\mathrm{var}} < 1$。\n\n*   **数值频散度量 ($\\Delta x_{\\mathrm{phase}}$)：** 数值频散导致不同波长的波以不正确的速度传播。这通过检查解的特定傅里叶模式的相位来分析。我们关注能适应域的最长波长模式，其波数为 $k_1 = 2\\pi/L$。该模式的复系数通过对零均值示踪剂场 $u_j^n - \\overline{u}^n$ 进行离散傅里叶变换 (DFT) 得到：\n    $$\n    \\widehat{U}_k^n = \\sum_{j=0}^{N-1} \\left(u_j^n - \\overline{u}^n\\right) \\exp\\left(-\\mathrm{i}\\, \\frac{2\\pi k j}{N}\\right)\n    $$\n    对于一个周期 $T=L/c$ 后的精确解，场会返回其原始状态，因此任何傅里叶系数的相位都应保持不变。任何数值相位误差都由 $k=1$ 模式 $\\widehat{U}_1^n$ 的最终相位与初始相位之差捕获。包裹相位差计算如下：\n    $$\n    \\Delta \\phi = \\mathrm{wrap}\\left(\\arg\\left(\\widehat{U}_1^{n_T}\\right) - \\arg\\left(\\widehat{U}_1^{0}\\right)\\right)\n    $$\n    其中 $\\mathrm{wrap}(\\theta)$ 函数将角度 $\\theta$ 映射到区间 $(-\\pi, \\pi]$。相位误差 $\\Delta \\phi$ 等效于一个错误的空间位移。$\\delta x$ 的空间位移会产生 $-k_1 \\delta x = - (2\\pi/L) \\delta x$ 的相位变化。因此，等效的空间相移为：\n    $$\n    \\Delta x_{\\mathrm{phase}} = -\\,\\frac{L}{2\\pi}\\,\\Delta \\phi\n    $$\n    该值表示示踪剂的主导大尺度特征在一个周期后的残余位移。一个非零的 $\\Delta x_{\\mathrm{phase}}$ 是对该格式累积频散误差的直接度量。\n\n**5. 算法实现**\n\n每个测试用例的算法流程如下：\n1.  初始化参数（$L$, $N$, $c$, $\\mathrm{C}$ 等）。\n2.  构建空间网格 $x_i$ 和初始高斯剖面 $u^0$。\n3.  计算初始方差 $\\mathrm{Var}^0$ 和初始相位 $\\arg(\\widehat{U}_1^0)$。\n4.  循环 $n_T = N/\\mathrm{C}$ 个时间步，在每一步应用所选的数值格式（迎风或 Lax-Wendroff）来更新解向量。\n5.  循环结束后，计算最终方差 $\\mathrm{Var}^{n_T}$ 和最终相位 $\\arg(\\widehat{U}_1^{n_T})$。\n6.  使用上述公式计算度量 $R_{\\mathrm{var}}$ 和 $\\Delta x_{\\mathrm{phase}}$。\n7.  存储结果对 $[R_{\\mathrm{var}}, \\Delta x_{\\mathrm{phase}}]$。\n\n对所有四个测试用例重复此过程，并将结果汇总到一个最终列表中以供输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the 1D advection problem.\n    \"\"\"\n\n    def solve_case(scheme, L, N, c, C, sigma_rel, x0_rel):\n        \"\"\"\n        Solves a single case of the 1D advection problem.\n\n        Args:\n            scheme (str): 'upwind' or 'lax-wendroff'.\n            L (float): Domain length in meters.\n            N (int): Number of grid points.\n            c (float): Advection velocity in m/s.\n            C (float): Courant number.\n            sigma_rel (float): Standard deviation as a fraction of L.\n            x0_rel (float): Initial pulse center as a fraction of L.\n\n        Returns:\n            list: A list containing [R_var, delta_x_phase].\n        \"\"\"\n        # 1. Setup simulation parameters\n        dx = L / N\n        T = L / c\n        n_T = int(round(N / C))\n        # dt = T / n_T # Equivalent to C * dx / c\n\n        sigma = sigma_rel * L\n        x0 = x0_rel * L\n        x = np.linspace(0, L, N, endpoint=False)\n\n        # 2. Set Initial Condition (Periodic Gaussian)\n        dist_x = x - x0\n        # Minimal periodic distance on the torus [0, L)\n        d = dist_x - L * np.round(dist_x / L)\n        u0 = np.exp(-(d**2) / (2 * sigma**2))\n\n        # 3. Analyze Initial State\n        var0 = np.var(u0)\n        u0_zm = u0 - np.mean(u0)\n        U_hat_0 = np.fft.fft(u0_zm)\n        # Phase of the k=1 mode\n        phi0 = np.angle(U_hat_0[1])\n\n        # 4. Time Evolution Loop\n        u_current = u0.copy()\n        if scheme == 'upwind':\n            for _ in range(n_T):\n                u_current = (1 - C) * u_current + C * np.roll(u_current, 1)\n        elif scheme == 'lax-wendroff':\n            for _ in range(n_T):\n                u_ip1 = np.roll(u_current, -1)\n                u_im1 = np.roll(u_current, 1)\n                term1 = -0.5 * C * (u_ip1 - u_im1)\n                term2 = 0.5 * C**2 * (u_ip1 - 2 * u_current + u_im1)\n                u_current = u_current + term1 + term2\n        else:\n            raise ValueError(f\"Unknown scheme: {scheme}\")\n\n        u_final = u_current\n\n        # 5. Analyze Final State\n        var_final = np.var(u_final)\n        u_final_zm = u_final - np.mean(u_final)\n        U_hat_nT = np.fft.fft(u_final_zm)\n        # Phase of the k=1 mode\n        phi_nT = np.angle(U_hat_nT[1])\n\n        # 6. Calculate Metrics\n        # Numerical Diffusion: Variance Ratio\n        R_var = var_final / var0 if var0 > 0 else 1.0\n\n        # Numerical Dispersion: Phase Shift\n        \n        # Wrap angle to (-pi, pi]\n        def wrap_angle(angle):\n            return (angle + np.pi) % (2 * np.pi) - np.pi\n\n        delta_phi_raw = phi_nT - phi0\n        delta_phi = wrap_angle(delta_phi_raw)\n\n        delta_x_phase = -L * delta_phi / (2 * np.pi)\n\n        return [R_var, delta_x_phase]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: first-order upwind, moderate C\n        {'scheme': 'upwind', 'L': 1.0, 'N': 256, 'c': 1.0, 'C': 0.5, 'sigma_rel': 0.05, 'x0_rel': 0.3},\n        # Case B: Lax-Wendroff, moderate C\n        {'scheme': 'lax-wendroff', 'L': 1.0, 'N': 256, 'c': 1.0, 'C': 0.5, 'sigma_rel': 0.05, 'x0_rel': 0.3},\n        # Case C: first-order upwind, limiting C\n        {'scheme': 'upwind', 'L': 1.0, 'N': 200, 'c': 1.0, 'C': 1.0, 'sigma_rel': 0.08, 'x0_rel': 0.4},\n        # Case D: Lax-Wendroff, narrow pulse\n        {'scheme': 'lax-wendroff', 'L': 1.0, 'N': 256, 'c': 1.0, 'C': 0.5, 'sigma_rel': 0.01, 'x0_rel': 0.25},\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = solve_case(**case_params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "冯·诺伊曼稳定性分析通过推导放大因子 $G(k)$ 来预测不同波长的数值误差，是评估数值格式性能的基石。本练习将引导您设计一个巧妙的数值实验，从“测量”而非“推导”的角度来确定放大因子的性质。您将通过在一个平流模型中初始化一个单一的余弦波，并演化一个时间步长，来直接计算该模式的振幅衰减，从而估算出数值放大因子的模 $|G(k)|$ ()。这个过程不仅能有力地验证理论分析的准确性，更重要的是，它展示了如何设计目标明确的数值实验来诊断和量化复杂模型中的数值误差。",
            "id": "3899290",
            "problem": "您的任务是为一维周期性线性平流模型设计并实现一个基于傅里叶的数值扩散诊断工具。其基本原理是一维线性平流方程，\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\n该方程定义在一个长度为 $L$ 的周期性域上，使用包含 $N$ 个点的均匀网格，网格间距为 $\\Delta x = L/N$。物理参数包括平流速度 $c$（单位：米/秒）和时间步长 $\\Delta t$（单位：秒）。对于单模初始条件，\n$$\nu(x,0) = \\cos(k x),\n$$\n其中波数为 $k$（单位：弧度/米），纯平流的精确连续解会保持振幅不变。这意味着在单个时间步后，数值计算出的振幅的任何衰减都源于数值扩散。该诊断工具应通过测量一个时间步 $\\Delta t$ 内离散傅里叶振幅的衰减，来估计数值放大因子的模，记为 $|G(k)|$。\n\n为了使该诊断在算法上具体且可测试，我们使用一阶迎风有限差分格式来近似平流方程（对于正平流速度 $c > 0$）：\n$$\nu_i^{n+1} = u_i^n - C \\left(u_i^n - u_{i-1}^n\\right),\n$$\n其中 $u_i^n$ 是网格索引 $i$ 和时间层 $n$ 处的离散解，$C = \\frac{c \\Delta t}{\\Delta x}$ 是 Courant-Friedrichs-Lewy (CFL) 数。强制施加周期性边界条件，使得 $u_{-1}^n$ 被解释为 $u_{N-1}^n$。将场初始化为\n$$\nu_i^0 = \\cos(k x_i), \\quad x_i = i \\Delta x, \\quad i = 0,1,\\dots,N-1,\n$$\n波数的选择与离散网格兼容：$k = \\frac{2\\pi m}{L}$，其中 $m$ 为整数模态指数，$m \\in \\{0,1,\\dots,N-1\\}$。\n\n通过计算一个时间步后模态 $m$ 处的离散傅里叶变换 (DFT) 系数的模与初始模的比值，来估计数值放大因子的模 $|G(k)|$。具体来说，令 $U_m^0$ 和 $U_m^1$ 分别表示从 $u_i^0$ 和 $u_i^1$ 得到的模态 $m$ 处的复数 DFT 系数（使用标准的未归一化 DFT）。然后计算\n$$\n|G(k)| = \\frac{\\left|U_m^1\\right|}{\\left|U_m^0\\right|}。\n$$\n在此，离散傅里叶变换 (DFT) 对于离散场 $\\{u_i\\}_{i=0}^{N-1}$ 的定义如下：\n$$\n\\hat{u}_m = \\sum_{i=0}^{N-1} u_i \\exp\\left(-\\mathrm{i} \\frac{2\\pi m i}{N}\\right),\n$$\n对于模态指数 $m$。诊断结果 $|G(k)|$ 是无量纲的，并且必须以浮点数形式报告。\n\n在所有测试用例中，使用以下物理上一致的共享参数：\n- 域长度 $L = 1000$ 米。\n- 网格点数 $N = 128$，因此 $\\Delta x = L/N$ 米。\n- 平流速度 $c = 10$ 米/秒。\n- 模态波数 $k = \\frac{2\\pi m}{L}$ 弧度/米，其中整数 $m$ 由每个测试用例指定。\n- 时间步长 $\\Delta t$ 由 Courant-Friedrichs-Lewy (CFL) 数 $C$ 决定，通过 $\\Delta t = C \\frac{\\Delta x}{c}$ 秒计算。\n\n您的程序必须：\n1. 对每个测试用例中指定的 $m$，初始化场 $u_i^0 = \\cos(k x_i)$。\n2. 使用带周期性边界条件的一阶迎风格式将场推进一个时间步。\n3. 计算初始场和推进后场的 DFT，并对指定的模态 $m$ 评估 $|G(k)|$。\n4. 汇总所有测试用例的结果，并生成一个包含浮点结果列表的单行输出。\n\n测试套件：\n- 用例 1 (正常路径，长波，中等稳定性)：$m = 1$, $C = 0.2$。\n- 用例 2 (中尺度波，一半 CFL)：$m = 32$, $C = 0.5$。\n- 用例 3 (近奈奎斯特波，接近稳定性边界的高 CFL)：$m = 63$, $C = 0.9$。\n- 用例 4 (零模态边界情况)：$m = 0$, $C = 0.7$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，例如，\n`[result_1,result_2,result_3,result_4]`。\n每个 `result_j` 必须是相应测试用例计算出的 $|G(k)|$ 的浮点值。最终答案不需要单位，因为 $|G(k)|$ 是无量纲的。",
            "solution": "该问题被评估为有效，因为它在科学上基于偏微分方程数值分析的原理，其设定良好，具有完整且一致的参数集，并以客观、正式的语言表述。任务是为一维线性平流模型实现一个数值扩散的诊断工具。\n\n控制方程是线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n该方程在一个长度为 $L$ 的周期性域上求解，使用一个包含 $N$ 个点的网格。空间网格点为 $x_i = i \\Delta x$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$，网格间距为 $\\Delta x = L/N$。\n\n数值格式为一阶迎风法，对于正平流速度 $c > 0$，该方法将方程离散化为：\n$$\nu_i^{n+1} = u_i^n - C (u_i^n - u_{i-1}^n)\n$$\n此处，$u_i^n$ 表示在网格点 $i$ 和时间层 $n$ 的解，而 $C = \\frac{c \\Delta t}{\\Delta x}$ 是 Courant-Friedrichs-Lewy (CFL) 数。时间步长为 $\\Delta t$。周期性边界条件意味着 $u_{-1}^n = u_{N-1}^n$。\n\n诊断过程包括以下步骤：\n\n1.  **参数计算**：对于每个由模态指数 $m$ 和 CFL 数 $C$ 指定的测试用例，我们首先计算必要的物理和数值参数。\n    -   网格间距：$\\Delta x = \\frac{L}{N} = \\frac{1000}{128} = 7.8125$ 米。\n    -   波数：$k = \\frac{2\\pi m}{L}$。这确保了初始波形在域上是周期的。\n    -   时间步长：$\\Delta t = C \\frac{\\Delta x}{c}$。这是从 CFL 数的定义推导出来的。\n\n2.  **初始化**：在时间 $t=0$（即时间层 $n=0$）时，用单模余弦波初始化模拟场：\n    $$\n    u_i^0 = \\cos(k x_i) = \\cos\\left(\\frac{2\\pi m}{L} \\cdot i \\Delta x\\right) = \\cos\\left(\\frac{2\\pi m i}{N}\\right)\n    $$\n    该离散场代表初始状态 $u(x,0)$。\n\n3.  **时间推进**：我们将解推进一个时间步长 $\\Delta t$，以获得时间层 $n=1$ 处的场，记为 $u_i^1$。这通过应用一次迎风格式来完成：\n    $$\n    u_i^1 = u_i^0 - C (u_i^0 - u_{i-1}^0)\n    $$\n    周期性边界条件通过将索引 $i-1$ 对 $N$ 取模来处理。对于 $i=0$，$u_{-1}^0$ 变为 $u_{N-1}^0$。\n\n4.  **傅里叶分析**：诊断的核心是比较时间步前后解的傅里叶谱。我们计算初始场 $u^0$ 和推进后的场 $u^1$ 的离散傅里叶变换 (DFT)。序列 $\\{v_i\\}_{i=0}^{N-1}$ 的 DFT 由下式给出：\n    $$\n    \\hat{v}_j = \\sum_{i=0}^{N-1} v_i \\exp\\left(-\\mathrm{i} \\frac{2\\pi j i}{N}\\right)\n    $$\n    令 $U_m^0$ 和 $U_m^1$ 分别为对应于初始场 $u_i^0$ 和 $u_i^1$ 的模态指数 $m$ 处的复数 DFT 系数。\n\n5.  **放大因子计算**：在波数 $k$ 处的数值放大因子的模，记为 $|G(k)|$，量化了由于数值格式导致的特定模态的振幅变化。它被估计为模态 $m$ 处 DFT 系数模的比值：\n    $$\n    |G(k)| = \\frac{|U_m^1|}{|U_m^0|}\n    $$\n    初始条件 $u_i^0 = \\cos\\left(\\frac{2\\pi m i}{N}\\right)$ 可以使用欧拉公式表示为 $\\frac{1}{2}\\left(e^{\\mathrm{i} \\frac{2\\pi m i}{N}} + e^{-\\mathrm{i} \\frac{2\\pi m i}{N}}\\right)$。其 DFT 的非零系数主要在模态指数 $m$ 和 $N-m$ 处（$N-m$ 是 $-m$ 在离散网格上的别名）。因此，对于 $m \\in \\{1, \\dots, N/2\\}$， $|U_m^0|$ 将不为零，从而确保该比值是良定义的。\n    \n    一个特殊情况是 $m=0$，对应于 $k=0$。初始条件为 $u_i^0 = \\cos(0) = 1$（对所有 $i$）。对于一个常数场，项 $(u_i^0 - u_{i-1}^0)$ 为零，因此 $u_i^1 = u_i^0$。因此，$U_0^1 = U_0^0$，我们期望 $|G(0)| = 1$ 精确成立。\n\n对每个测试用例，都遵循此过程来计算 $|G(k)|$ 的单个浮点值。最终输出是这些值的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the numerical amplification factor for the first-order upwind scheme\n    for a series of test cases based on a 1D linear advection model.\n    \"\"\"\n    \n    # Define shared physical and numerical parameters.\n    L = 1000.0  # Domain length in meters\n    N = 128     # Number of grid points\n    c = 10.0    # Advection speed in m/s\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (mode index m, CFL number C)\n    test_cases = [\n        (1, 0.2),   # Case 1: long wave, moderate stability\n        (32, 0.5),  # Case 2: mid-scale wave, half CFL\n        (63, 0.9),  # Case 3: near-Nyquist wave, high CFL\n        (0, 0.7),   # Case 4: zero mode boundary case\n    ]\n    \n    results = []\n    \n    # Calculate grid spacing (constant for all cases)\n    dx = L / N\n    \n    # Generate the spatial grid coordinates (constant for all cases)\n    x = np.arange(N) * dx\n    \n    for m, C in test_cases:\n        # Step 1: Calculate case-specific parameters\n        # Wavenumber k is implicitly handled via the mode index m and grid properties\n        # during initialization and DFT analysis.\n        # It can be explicitly calculated as:\n        # k = (2 * np.pi * m) / L\n        \n        # Step 2: Initialize the field u^0\n        # u_i^0 = cos(k * x_i) = cos( (2*pi*m/L) * (i*L/N) ) = cos(2*pi*m*i / N)\n        # Using arange(N) for indices i = 0, 1, ..., N-1\n        u0 = np.cos(2.0 * np.pi * m * np.arange(N) / N)\n        \n        # Step 3: Advance the field by one time step to get u^1\n        # The upwind scheme is u_i^{n+1} = u_i^n - C * (u_i^n - u_{i-1}^n).\n        # np.roll(u0, 1) shifts elements to the right, so u0[i] becomes u0[i-1],\n        # correctly implementing the periodic boundary condition.\n        u1 = u0 - C * (u0 - np.roll(u0, 1))\n        \n        # Step 4: Compute the Discrete Fourier Transforms (DFTs)\n        # numpy.fft.fft provides the unnormalized DFT as specified.\n        U0_coeffs = np.fft.fft(u0)\n        U1_coeffs = np.fft.fft(u1)\n        \n        # Extract the complex coefficient at the specified mode m\n        U0_m = U0_coeffs[m]\n        U1_m = U1_coeffs[m]\n        \n        # Step 5: Calculate the magnitude of the numerical amplification factor\n        # For m=0, u0 is a constant field, so |U0_m| is N != 0.\n        # For m > 0, cos(2*pi*m*i/N) is composed of two complex exponentials,\n        # so |U0_m| is N/2 != 0. Thus, division by zero is not an issue.\n        if np.abs(U0_m) == 0:\n            # This case should not be reached with the given initial conditions.\n            # If it were, it would imply the initial mode has zero amplitude,\n            # making the amplification factor undefined. We'd assign 1.0.\n            amp_factor = 1.0\n        else:\n            amp_factor = np.abs(U1_m) / np.abs(U0_m)\n            \n        results.append(amp_factor)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}