{
    "hands_on_practices": [
        {
            "introduction": "Before analyzing the subtleties of time step selection, it's essential to understand how numerical integrators are constructed. This practice guides you through the derivation of the classical fourth-order Runge-Kutta (RK4) method, a workhorse in many environmental models. By starting from its definition in the compact Butcher tableau format, you will connect the abstract coefficients to the concrete sequence of stage calculations, building a deep appreciation for the structure of this widely used scheme .",
            "id": "3920940",
            "problem": "Consider a lumped reservoir component in an Earth system model whose prognostic quantity $u(t)$ (for example, a spatially averaged tracer concentration) satisfies an Ordinary Differential Equation (ODE) initial value problem $u'(t) = f(u(t), t)$, with $u(t_0) = u_0$, where $f$ is sufficiently smooth in both arguments. Let $h > 0$ be a fixed time step and denote $t_n = t_0 + n h$ and $u_n \\approx u(t_n)$.\n\nStarting from the definition that a one-step method is constructed to approximate $u(t_{n+1})$ from $u(t_n)$ using evaluations of $f$ at appropriately shifted stage arguments $(u_n + \\text{increment}, t_n + \\text{shift})$, formulate an explicit $s$-stage Runge-Kutta (RK) method via its Butcher tableau whose coefficient matrix is strictly lower triangular. Use the requirement that the method, when applied to $u'(t) = f(u(t), t)$, matches the Taylor series of the exact solution $u(t_{n+1})$ through terms of order $h^4$ to identify a four-stage explicit Runge-Kutta method of fourth algebraic order.\n\nProvide the Butcher tableau for this four-stage method and, by explicitly constructing its stage evaluations, derive the one-step update formula for advancing $u_n$ to $u_{n+1}$ for the ODE $u' = f(u,t)$. Express the final update $u_{n+1}$ as a single closed-form analytic expression in terms of $u_n$, $t_n$, $h$, and nested evaluations of $f$ at the appropriate stage arguments, without introducing any intermediate symbols. No numerical rounding is required. Do not include units in your final expression.",
            "solution": "The problem statement is valid. It is a well-posed problem in the field of numerical analysis for ordinary differential equations, a topic central to environmental and earth system modeling. The problem is scientifically sound, objective, and contains all necessary information to derive the requested Runge-Kutta method.\n\nAn explicit $s$-stage Runge-Kutta (RK) method is a one-step numerical procedure for solving the initial value problem $u'(t) = f(u(t), t)$ with $u(t_0) = u_0$. The method approximates the solution at time $t_{n+1} = t_n + h$ using the value at $t_n$ as follows:\n$$u_{n+1} = u_n + h \\sum_{i=1}^{s} b_i k_i$$\nwhere the stage values $k_i$ are given by:\n$$k_i = f\\left(t_n + c_i h, u_n + h \\sum_{j=1}^{s} a_{ij} k_j\\right), \\quad i=1, \\dots, s$$\nAn RK method is explicit if the coefficient matrix $A = (a_{ij})$ is strictly lower triangular, meaning $a_{ij} = 0$ for $j \\geq i$. This ensures that the calculation of each stage $k_i$ depends only on the preceding stages $k_1, \\dots, k_{i-1}$, so they can be computed sequentially. For an explicit method, the stage equations become:\n$$k_i = f\\left(t_n + c_i h, u_n + h \\sum_{j=1}^{i-1} a_{ij} k_j\\right)$$\nFor such methods, it is conventional that $c_1 = 0$, which implies $k_1 = f(t_n, u_n)$. The coefficients of an RK method are compactly represented by a Butcher tableau:\n$$\n\\begin{array}{c|c}\n\\mathbf{c}  A \\\\\n\\hline\n \\mathbf{b}^T\n\\end{array}\n=\n\\begin{array}{c|cccc}\nc_1  a_{11}  a_{12}  \\dots  a_{1s} \\\\\nc_2  a_{21}  a_{22}  \\dots  a_{2s} \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\nc_s  a_{s1}  a_{s2}  \\dots  a_{ss} \\\\\n\\hline\n b_1  b_2  \\dots  b_s\n\\end{array}\n$$\nFor an explicit method, the matrix $A$ is strictly lower triangular. It is also a common simplifying assumption that $c_i = \\sum_{j=1}^{s} a_{ij} = \\sum_{j=1}^{i-1} a_{ij}$.\n\nThe order of accuracy of a method is determined by matching the Taylor series expansion of the numerical solution $u_{n+1}$ with that of the exact solution $u(t_{n+1})$ about the point $(t_n, u_n)$. The exact solution's Taylor expansion is:\n$$u(t_{n+1}) = u(t_n) + h u'(t_n) + \\frac{h^2}{2!} u''(t_n) + \\frac{h^3}{3!} u'''(t_n) + \\frac{h^4}{4!} u''''(t_n) + O(h^5)$$\nExpressing the derivatives of $u$ in terms of $f$ and its partial derivatives and comparing them to the expansion of the numerical scheme leads to a set of algebraic equations for the coefficients $a_{ij}$, $b_i$, and $c_i$. For a method to be of order $4$, these coefficients must satisfy $8$ conditions:\n1.  Order $1$: $\\sum_{i=1}^s b_i = 1$\n2.  Order $2$: $\\sum_{i=1}^s b_i c_i = \\frac{1}{2}$\n3.  Order $3$: $\\sum_{i=1}^s b_i c_i^2 = \\frac{1}{3}$\n4.  Order $3$: $\\sum_{i,j=1}^s b_i a_{ij} c_j = \\frac{1}{6}$\n5.  Order $4$: $\\sum_{i=1}^s b_i c_i^3 = \\frac{1}{4}$\n6.  Order $4$: $\\sum_{i,j=1}^s b_i c_i a_{ij} c_j = \\frac{1}{8}$\n7.  Order $4$: $\\sum_{i,j=1}^s b_i a_{ij} c_j^2 = \\frac{1}{12}$\n8.  Order $4$: $\\sum_{i,j,k=1}^s b_i a_{ij} a_{jk} c_k = \\frac{1}{24}$\n\nThe problem asks to identify a $4$-stage ($s=4$) explicit method of order $4$. A minimum of $4$ stages are required for an explicit method to achieve order $4$. There exists a family of such methods. The most widely known and used is the \"classical\" fourth-order Runge-Kutta method, which we will formulate. Its coefficients are a specific solution to the $8$ order conditions.\n\nThe Butcher tableau for the classical $4$-stage, $4^{th}$-order Runge-Kutta method is:\n$$\n\\begin{array}{c|cccc}\n0  0  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0  0 \\\\\n\\frac{1}{2}  0  \\frac{1}{2}  0  0 \\\\\n1  0  0  1  0 \\\\\n\\hline\n \\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}  \\frac{1}{6}\n\\end{array}\n$$\nThis tableau defines the coefficients:\n$c_1=0$, $c_2=\\frac{1}{2}$, $c_3=\\frac{1}{2}$, $c_4=1$.\n$b_1=\\frac{1}{6}$, $b_2=\\frac{1}{3}$, $b_3=\\frac{1}{3}$, $b_4=\\frac{1}{6}$.\n$A = \\begin{pmatrix} 0  0  0  0 \\\\ \\frac{1}{2}  0  0  0 \\\\ 0  \\frac{1}{2}  0  0 \\\\ 0  0  1  0 \\end{pmatrix}$, which is strictly lower triangular, confirming the method is explicit.\n\nUsing this tableau, we construct the stage evaluations for the ODE $u' = f(u,t)$:\nThe first stage $k_1$ is evaluated at $(t_n, u_n)$:\n$$k_1 = f(t_n + c_1 h, u_n) = f(t_n, u_n)$$\nThe second stage $k_2$ uses $k_1$ to take a half-step:\n$$k_2 = f(t_n + c_2 h, u_n + h a_{21} k_1) = f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2} k_1\\right)$$\nThe third stage $k_3$ uses $k_2$ to take another half-step from the initial point:\n$$k_3 = f(t_n + c_3 h, u_n + h(a_{31} k_1 + a_{32} k_2)) = f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2} k_2\\right)$$\nThe fourth stage $k_4$ uses $k_3$ to take a full step:\n$$k_4 = f(t_n + c_4 h, u_n + h(a_{41} k_1 + a_{42} k_2 + a_{43} k_3)) = f(t_n + h, u_n + h k_3)$$\nFinally, the update for $u_{n+1}$ is a weighted average of these stage derivatives:\n$$u_{n+1} = u_n + h(b_1 k_1 + b_2 k_2 + b_3 k_3 + b_4 k_4) = u_n + \\frac{h}{6}(k_1 + 2 k_2 + 2 k_3 + k_4)$$\nThe problem requires expressing $u_{n+1}$ as a single expression without intermediate symbols like $k_i$. This is achieved by substituting the definitions of the stages into one another and then into the final update formula. The resulting expression, while cumbersome, represents the computational algorithm in its entirety. This expression is provided in the final answer.",
            "answer": "$$\n\\boxed{u_n + \\frac{h}{6}\\left( f(t_n, u_n) + 2f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2}f(t_n, u_n)\\right) + 2f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2}f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2}f(t_n, u_n)\\right)\\right) + f\\left(t_n + h, u_n + hf\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2}f\\left(t_n + \\frac{h}{2}, u_n + \\frac{h}{2}f(t_n, u_n)\\right)\\right)\\right) \\right)}\n$$"
        },
        {
            "introduction": "We now shift from method construction to its application in a challenging physical scenario: a stiff system representing chemical reactions. This exercise explores how numerical methods can introduce unphysical oscillations, even when they are technically stable . You will compare the unconditionally stable Backward Euler method with the Crank-Nicolson scheme to derive a time-step constraint that guarantees a monotonic, physically plausible approach to equilibrium, a crucial consideration for modeling biogeochemical processes.",
            "id": "3921025",
            "problem": "An environmental one-box model for a reactive atmospheric tracer with concentration $C(t)$ is governed by a first-order production-loss balance, in which the production is constant with rate $S$ and the loss is linear with rate constant $k0$. The evolution equation is\n$$\n\\frac{dC}{dt} = S - k\\,C.\n$$\nThis ordinary differential equation represents a canonical stiff subproblem that appears after spatial discretization of transport-reaction equations in Earth system models. Consider discrete time levels $t^{n}$ and $t^{n+1}=t^{n}+\\Delta t$ with time step $\\Delta t0$. Define the equilibrium concentration $C^{\\ast}$ and the deviation (error) $e^{n}=C^{n}-C^{\\ast}$, where $C^{n}$ approximates $C(t^{n})$. For the Backward Euler method and the Crank–Nicolson method, form the one-step update for the deviation $e^{n}$ under the assumption that the only active process in the time step is the linear reaction described above.\n\nUsing only fundamental definitions of these time integrators and the governing equation, derive for each method the scalar amplification factor $g$ defined by $e^{n+1}=g\\,e^{n}$. Interpret monotonicity as the requirement that the discrete trajectory approaches $C^{\\ast}$ without overshoot for any initial sign of $e^{0}$, i.e., that $e^{n}$ does not change sign in time. Based on this, determine the largest permissible time step $\\Delta t_{\\max}$, as a function of $k$, that guarantees a monotonic approach to $C^{\\ast}$ for the Crank–Nicolson method. Express your final answer as a closed-form symbolic expression in terms of $k$ only, and do not include units.",
            "solution": "The problem is first validated and found to be a well-posed, scientifically sound problem in the numerical analysis of ordinary differential equations.\n\nFirst, we determine the equilibrium concentration $C^{\\ast}$ of the tracer. The equilibrium state is characterized by a time-invariant concentration, meaning $\\frac{dC}{dt} = 0$. Substituting this condition into the governing equation:\n$$\n0 = S - k\\,C^{\\ast}\n$$\nSolving for $C^{\\ast}$ yields:\n$$\nC^{\\ast} = \\frac{S}{k}\n$$\nGiven that $S$ is a constant rate and $k0$, the equilibrium concentration $C^{\\ast}$ is a positive constant.\n\nNext, we reformulate the governing equation in terms of the deviation from equilibrium, $e(t) = C(t) - C^{\\ast}$. The time derivative of the concentration is $\\frac{dC}{dt} = \\frac{d}{dt}(e(t) + C^{\\ast}) = \\frac{de}{dt}$, since $C^{\\ast}$ is a constant. Substituting $C(t) = e(t) + C^{\\ast}$ into the original ordinary differential equation (ODE):\n$$\n\\frac{de}{dt} = S - k(e(t) + C^{\\ast})\n$$\n$$\n\\frac{de}{dt} = S - k\\,e(t) - k\\,C^{\\ast}\n$$\nUsing the expression for the equilibrium concentration, $k\\,C^{\\ast} = k \\left(\\frac{S}{k}\\right) = S$. The equation for the deviation simplifies to a homogeneous linear ODE:\n$$\n\\frac{de}{dt} = -k\\,e(t)\n$$\nWe will now discretize this equation for the deviation $e(t)$ using the specified numerical schemes, where $e^n$ is the numerical approximation of $e(t^n)$.\n\nFor the Backward Euler method, the time derivative is approximated at the future time level $t^{n+1}$:\n$$\n\\frac{e^{n+1} - e^n}{\\Delta t} = -k\\,e^{n+1}\n$$\nTo find the one-step update, we solve for $e^{n+1}$:\n$$\ne^{n+1} - e^n = -k\\,\\Delta t\\,e^{n+1}\n$$\n$$\ne^{n+1} + k\\,\\Delta t\\,e^{n+1} = e^n\n$$\n$$\ne^{n+1}(1 + k\\,\\Delta t) = e^n\n$$\nThe update rule is thus $e^{n+1} = \\frac{1}{1 + k\\,\\Delta t} e^n$. The scalar amplification factor for the Backward Euler method, $g_{BE}$, is therefore:\n$$\ng_{BE} = \\frac{1}{1 + k\\,\\Delta t}\n$$\nSince $k0$ and $\\Delta t0$, we have $0  g_{BE}  1$. This implies that the Backward Euler method is always monotonic for this problem, regardless of the time step size.\n\nFor the Crank–Nicolson method, the right-hand side of the ODE is approximated as the average of its values at $t^n$ and $t^{n+1}$:\n$$\n\\frac{e^{n+1} - e^n}{\\Delta t} = \\frac{1}{2}(-k\\,e^n - k\\,e^{n+1})\n$$\nWe solve for $e^{n+1}$ to find the update rule:\n$$\ne^{n+1} - e^n = -\\frac{k\\,\\Delta t}{2}(e^n + e^{n+1})\n$$\n$$\ne^{n+1} + \\frac{k\\,\\Delta t}{2}e^{n+1} = e^n - \\frac{k\\,\\Delta t}{2}e^n\n$$\n$$\ne^{n+1}\\left(1 + \\frac{k\\,\\Delta t}{2}\\right) = e^n\\left(1 - \\frac{k\\,\\Delta t}{2}\\right)\n$$\nThe update rule is $e^{n+1} = \\frac{1 - k\\,\\Delta t/2}{1 + k\\,\\Delta t/2} e^n$. The scalar amplification factor for the Crank–Nicolson method, $g_{CN}$, is:\n$$\ng_{CN} = \\frac{1 - \\frac{k\\,\\Delta t}{2}}{1 + \\frac{k\\,\\Delta t}{2}}\n$$\nThe problem defines monotonicity as the requirement that the numerical solution approaches the equilibrium $C^{\\ast}$ without overshoot. This means that the sign of the deviation $e^n = C^n - C^{\\ast}$ must not change from one time step to the next. That is, for any $n$, $\\text{sign}(e^{n+1}) = \\text{sign}(e^n)$. Since $e^{n+1} = g_{CN}\\,e^n$, this condition is satisfied if and only if the amplification factor $g_{CN}$ is non-negative.\n$$\ng_{CN} \\ge 0\n$$\nSubstituting the expression for $g_{CN}$:\n$$\n\\frac{1 - \\frac{k\\,\\Delta t}{2}}{1 + \\frac{k\\,\\Delta t}{2}} \\ge 0\n$$\nThe denominator, $1 + \\frac{k\\,\\Delta t}{2}$, is strictly positive because $k > 0$ and $\\Delta t > 0$. Therefore, the inequality holds if and only if the numerator is non-negative:\n$$\n1 - \\frac{k\\,\\Delta t}{2} \\ge 0\n$$\nNow, we solve for $\\Delta t$:\n$$\n1 \\ge \\frac{k\\,\\Delta t}{2}\n$$\nMultiplying by $2$ gives:\n$$\n2 \\ge k\\,\\Delta t\n$$\nSince $k > 0$, we can divide by $k$ without reversing the inequality:\n$$\n\\Delta t \\le \\frac{2}{k}\n$$\nThis inequality provides the condition on the time step $\\Delta t$ to ensure a monotonic approach to equilibrium. The largest permissible time step, $\\Delta t_{\\max}$, is the maximum value of $\\Delta t$ that satisfies this condition.\n$$\n\\Delta t_{\\max} = \\frac{2}{k}\n$$",
            "answer": "$$\n\\boxed{\\frac{2}{k}}\n$$"
        },
        {
            "introduction": "Another critical challenge in Earth system modeling is the accurate simulation of wave phenomena, from gravity waves in the atmosphere to large-scale ocean dynamics. This practice delves into the concepts of numerical dispersion and dissipation—the phase and amplitude errors introduced by time discretization. By analyzing the performance of second- and fourth-order Runge-Kutta methods on an oscillatory test problem, you will quantify how higher-order schemes significantly reduce these errors, preserving the physical integrity of waves over long model integrations .",
            "id": "3921036",
            "problem": "In environmental and earth system modeling, oscillatory modes such as linearized inertia–gravity waves and barotropic modes often appear as locally harmonic components that satisfy a linear ordinary differential equation of the form $u'(t) = i \\,\\omega\\, u(t)$, where $u(t)$ is a complex-valued amplitude, $\\omega  0$ is a real angular frequency, and $i$ is the imaginary unit. When these modes are integrated in time, numerical dispersion (phase error) and numerical dissipation (amplitude error) can accumulate over many cycles and markedly affect forecasts and diagnostics of wave propagation, energy budgets, and phase coherence.\n\nConsider the test equation $u'(t) = i \\,\\omega\\, u(t)$ and let the numerical time step be $\\Delta t$, with the nondimensional step size $\\alpha = \\omega \\,\\Delta t$ assumed small ($\\alpha \\ll 1$), consistent with practical stability and accuracy constraints in atmosphere–ocean models. Let $M$ be a positive integer denoting the number of full periods integrated. The exact solution advances one step by the complex factor $\\exp(i\\,\\alpha)$, yielding unit magnitude and phase increment $\\alpha$ per step. A one-step explicit Runge–Kutta (RK) method advances one step by a method-specific complex amplification factor $R(\\alpha)$, leading to a per-step numerical phase increment $\\arg(R(\\alpha))$ and magnitude $|R(\\alpha)|$.\n\nUsing the standard explicit second-order Runge–Kutta (RK2, midpoint) method and the classical explicit fourth-order Runge–Kutta (RK4) method:\n- Derive the per-step numerical amplification factor $R(\\alpha)$ for each method applied to $u'(t) = i \\,\\omega\\, u(t)$.\n- From first principles, define numerical dispersion (phase error) and dissipation (amplitude error) per step relative to the exact evolution, and obtain their leading-order asymptotic expansions in powers of $\\alpha$ for both RK2 and RK4.\n- Accumulate these per-step errors over $M$ full periods. Let $m$ be the number of steps per period (so the total number of steps is $N = M\\,m$), and define the cumulative phase lag as the magnitude of the difference between the numerical total phase $N\\,\\arg(R(\\alpha))$ and the exact total phase $M \\cdot 2\\pi$.\n- Compute, simplify, and report the leading-order ratio (in the small-$\\alpha$ limit) of the magnitudes of the cumulative phase lags of RK2 to RK4 after $M$ periods. Express your final answer as a single closed-form analytic expression in terms of $\\omega$ and $\\Delta t$ only. No rounding is required. The final ratio is dimensionless.",
            "solution": "The problem requires an analysis of the numerical phase error for two different Runge-Kutta methods, RK2 (midpoint) and RK4 (classical), when applied to the oscillatory test equation $u'(t) = i \\omega u(t)$. The goal is to find the ratio of their cumulative phase lags over a large number of periods.\n\nLet the numerical solution at time $t_n$ be $u_n$. A single step of a one-step method can be written as $u_{n+1} = G(u_n, \\Delta t)$. For the linear equation $u' = \\lambda u$, this takes the form $u_{n+1} = R(\\lambda \\Delta t) u_n$, where $R(z)$ is the stability function of the method. For our problem, $\\lambda = i\\omega$, and we define the nondimensional step size as $\\alpha = \\omega \\Delta t$, so $z = i\\alpha$. The numerical amplification factor per step is $R(i\\alpha)$. The problem uses the notation $R(\\alpha)$ to denote this quantity.\n\nThe exact solution is $u(t) = u(0) \\exp(i\\omega t)$. After one time step $\\Delta t$, the exact solution is amplified by the factor $\\exp(i\\omega \\Delta t) = \\exp(i\\alpha)$. This factor has a magnitude of $1$ and a phase of $\\alpha$. The numerical solution is amplified by $R(i\\alpha)$, which has magnitude $|R(i\\alpha)|$ and phase $\\arg(R(i\\alpha))$. The per-step amplitude error is $|R(i\\alpha)| - 1$ and the per-step phase error is $\\arg(R(i\\alpha)) - \\alpha$.\n\nFirst, we derive the amplification factor $R(i\\alpha)$ for each method.\n\nFor a general Runge-Kutta method, the stability function for $u'=\\lambda u$ is given by $R(z) = 1 + z b^T (I - z A)^{-1} \\mathbb{1}$, where $A, b, c$ are the Butcher tableau coefficients and $z = \\lambda \\Delta t$. For an explicit RK method, $A$ is strictly lower triangular, and $(I-zA)^{-1}$ can be expanded as a finite series, resulting in a polynomial in $z$. For a method of order $p$, the stability function is $R(z) = \\sum_{k=0}^{p} \\frac{z^k}{k!}$ plus higher-order terms specific to the method. For many standard explicit methods, including midpoint and classical RK4, the stability function is exactly the Taylor polynomial of $\\exp(z)$ of degree $p$.\n\n**1. Second-Order Runge-Kutta (Midpoint) Method (RK2)**\n\nThe explicit midpoint method is a second-order method ($p=2$). Its stability function is given by the Taylor series of $\\exp(z)$ up to order $2$:\n$R_{\\text{RK2}}(z) = 1 + z + \\frac{z^2}{2!}$.\nSubstituting $z = i\\alpha = i\\omega\\Delta t$:\n$R_{\\text{RK2}}(i\\alpha) = 1 + (i\\alpha) + \\frac{(i\\alpha)^2}{2} = 1 + i\\alpha - \\frac{\\alpha^2}{2}$.\nTo find the per-step phase error, we compute the argument of this complex number. Let $R_{\\text{RK2}}(i\\alpha) = X_{\\text{RK2}} + iY_{\\text{RK2}}$, where $X_{\\text{RK2}} = 1 - \\frac{\\alpha^2}{2}$ and $Y_{\\text{RK2}} = \\alpha$.\nThe phase is $\\arg(R_{\\text{RK2}}(i\\alpha)) = \\arctan\\left(\\frac{Y_{\\text{RK2}}}{X_{\\text{RK2}}}\\right) = \\arctan\\left(\\frac{\\alpha}{1 - \\alpha^2/2}\\right)$.\nFor small $\\alpha$, we use the Taylor series expansion for $\\arctan(x) \\approx x - x^3/3 + \\dots$ and $(1-y)^{-1} \\approx 1+y+y^2+\\dots$.\nThe argument to arctan is $\\frac{\\alpha}{1-\\alpha^2/2} = \\alpha \\left(1 - \\frac{\\alpha^2}{2}\\right)^{-1} \\approx \\alpha \\left(1 + \\frac{\\alpha^2}{2}\\right) = \\alpha + \\frac{\\alpha^3}{2}$.\nSo, $\\arg(R_{\\text{RK2}}(i\\alpha)) \\approx \\arctan\\left(\\alpha + \\frac{\\alpha^3}{2}\\right) \\approx \\left(\\alpha + \\frac{\\alpha^3}{2}\\right) - \\frac{1}{3}\\left(\\alpha + \\frac{\\alpha^3}{2}\\right)^3 + \\dots$\n$\\arg(R_{\\text{RK2}}(i\\alpha)) \\approx \\alpha + \\frac{\\alpha^3}{2} - \\frac{\\alpha^3}{3} + O(\\alpha^5) = \\alpha + \\frac{\\alpha^3}{6} + O(\\alpha^5)$.\nThe per-step phase error for RK2, denoted $E_{\\phi, \\text{RK2}}$, is:\n$E_{\\phi, \\text{RK2}} = \\arg(R_{\\text{RK2}}(i\\alpha)) - \\alpha \\approx \\frac{\\alpha^3}{6}$.\n\n**2. Fourth-Order Runge-Kutta (Classical) Method (RK4)**\n\nThe classical RK4 method is a fourth-order method ($p=4$). Its stability function is the Taylor series of $\\exp(z)$ up to order $4$:\n$R_{\\text{RK4}}(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}$.\nSubstituting $z = i\\alpha$:\n$R_{\\text{RK4}}(i\\alpha) = 1 + (i\\alpha) + \\frac{(i\\alpha)^2}{2} + \\frac{(i\\alpha)^3}{6} + \\frac{(i\\alpha)^4}{24} = \\left(1 - \\frac{\\alpha^2}{2} + \\frac{\\alpha^4}{24}\\right) + i\\left(\\alpha - \\frac{\\alpha^3}{6}\\right)$.\nThe exact amplification factor is $\\exp(i\\alpha) = 1 + i\\alpha - \\frac{\\alpha^2}{2} - i\\frac{\\alpha^3}{6} + \\frac{\\alpha^4}{24} + i\\frac{\\alpha^5}{120} - \\dots$.\nThe difference between the numerical and exact amplification factors is:\n$R_{\\text{RK4}}(i\\alpha) - \\exp(i\\alpha) = -i\\frac{\\alpha^5}{120} + O(\\alpha^6)$.\nLet $R_{\\text{RK4}}(i\\alpha) = |R_{\\text{RK4}}|\\exp(i\\phi_{\\text{RK4}})$ and $\\exp(i\\alpha) = \\exp(i\\alpha)$.\n$\\frac{R_{\\text{RK4}}(i\\alpha)}{\\exp(i\\alpha)} = |R_{\\text{RK4}}|\\exp(i(\\phi_{\\text{RK4}}-\\alpha)) \\approx 1 - \\exp(-i\\alpha) \\frac{i\\alpha^5}{120}$.\nFor small $\\alpha$, $\\exp(-i\\alpha) \\approx 1$. Thus, $\\frac{R_{\\text{RK4}}(i\\alpha)}{\\exp(i\\alpha)} \\approx 1 - i\\frac{\\alpha^5}{120}$.\nFor a complex number $1 - i\\epsilon$ with small $\\epsilon$, the phase is approximately $-\\epsilon$.\nTherefore, the per-step phase error for RK4, $E_{\\phi, \\text{RK4}}$, is:\n$E_{\\phi, \\text{RK4}} = \\arg(R_{\\text{RK4}}(i\\alpha)) - \\alpha \\approx -\\frac{\\alpha^5}{120}$.\n\n**3. Cumulative Phase Lag and Ratio**\n\nThe problem states that we integrate for $M$ full periods. A single period of the exact solution is $T_p = 2\\pi/\\omega$.\nThe number of steps per period, $m$, is defined by $m \\Delta t = T_p = 2\\pi/\\omega$.\nSince $\\alpha = \\omega \\Delta t$, we have $\\Delta t = \\alpha/\\omega$. Substituting this into the previous equation gives $m (\\alpha/\\omega) = 2\\pi/\\omega$, which simplifies to $m\\alpha = 2\\pi$, or $m = 2\\pi/\\alpha$.\nThe total number of steps is $N = M m = M(2\\pi/\\alpha)$.\n\nThe cumulative phase lag is defined as the magnitude of the difference between the total numerical phase and the total exact phase, which is $M \\cdot 2\\pi$.\nThe total numerical phase is $N \\arg(R(i\\alpha))$. The total exact phase is $N\\alpha = M(2\\pi/\\alpha)\\alpha = M \\cdot 2\\pi$.\nThe cumulative phase lag, $L$, is therefore $L = |N \\arg(R(i\\alpha)) - M \\cdot 2\\pi| = |N \\arg(R(i\\alpha)) - N\\alpha| = N |\\arg(R(i\\alpha)) - \\alpha| = N |E_{\\phi}|$.\n\nFor RK2, the cumulative phase lag is:\n$L_{\\text{RK2}} = N |E_{\\phi, \\text{RK2}}| \\approx \\left(\\frac{2\\pi M}{\\alpha}\\right) \\left|\\frac{\\alpha^3}{6}\\right| = \\frac{2\\pi M \\alpha^2}{6} = \\frac{\\pi M \\alpha^2}{3}$.\n\nFor RK4, the cumulative phase lag is:\n$L_{\\text{RK4}} = N |E_{\\phi, \\text{RK4}}| \\approx \\left(\\frac{2\\pi M}{\\alpha}\\right) \\left|-\\frac{\\alpha^5}{120}\\right| = \\frac{2\\pi M \\alpha^4}{120} = \\frac{\\pi M \\alpha^4}{60}$.\n\nThe problem asks for the leading-order ratio of the magnitudes of the cumulative phase lags of RK2 to RK4.\nRatio $= \\frac{L_{\\text{RK2}}}{L_{\\text{RK4}}} = \\frac{\\pi M \\alpha^2 / 3}{\\pi M \\alpha^4 / 60} = \\frac{\\alpha^2}{3} \\cdot \\frac{60}{\\alpha^4} = \\frac{20}{\\alpha^2}$.\n\nFinally, we express the answer in terms of $\\omega$ and $\\Delta t$ by substituting $\\alpha = \\omega \\Delta t$:\nRatio $= \\frac{20}{(\\omega \\Delta t)^2}$.",
            "answer": "$$\n\\boxed{\\frac{20}{(\\omega \\Delta t)^{2}}}\n$$"
        }
    ]
}