{
    "hands_on_practices": [
        {
            "introduction": "本节练习为后续学习奠定基础。我们将从陆地碳循环的核心——单片叶片内部的光合作用生化过程——开始。通过应用著名的Farquhar、von Caemmerer和Berry（FvCB）模型，你将亲手计算碳同化速率，并判断限制这一关键过程的因素，从而对植物捕获大气$CO_2$的核心机制获得直观感受。",
            "id": "3921312",
            "problem": "考虑一片处于稳态的温带$\\text{C}_3$植物叶片，温度为$25\\,^{\\circ}\\mathrm{C}$，其净二氧化碳同化作用源于对二氧化碳的生物化学需求与线粒体呼吸之间的平衡。使用通常归因于 Farquhar、von Caemmerer 和 Berry 模型的$\\text{C}_3$光合作用的标准生物化学描述。两个生物化学限制因素是：\n- 由1,5-二磷酸核酮糖羧化/加氧酶 (Rubisco) 控制的羧化限制速率，该过程遵循二氧化碳的 Michaelis–Menten 动力学，并受到氧气的竞争性抑制。\n- 由支持1,5-二磷酸核酮糖再生的光驱动电子传递控制的电子传递限制速率，该过程遵循$\\text{C}_3$光合作用的经典化学计量关系。\n\n给定以下参数：\n- Rubisco 最大羧化能力 $V_{c\\max} = 70$ $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，\n- 有效电子传递速率 $J = 140$ $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，\n- 日间呼吸（光下线粒体呼吸） $R_{d} = 1.5$ $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，\n- 胞间二氧化碳分压 $C_{i} = 300$ $\\mu\\mathrm{bar}$，\n- 氧气分压 $O = 21000$ $\\mu\\mathrm{bar}$，\n- Rubisco 的 Michaelis–Menten 常数 $K_{c} = 404$ $\\mu\\mathrm{bar}$ 和 $K_{o} = 27800$ $\\mu\\mathrm{bar}$，\n- 无暗呼吸时的二氧化碳补偿点 $\\Gamma^{*} = 42$ $\\mu\\mathrm{bar}$。\n\n从上述生物化学模型所依据的基本定律和经过充分检验的公式出发：\n1. 推导 Rubisco 限制的总同化速率 $W_{c}$ 和电子传递限制的总同化速率 $W_{j}$ 的表达式，用 $V_{c\\max}$、$J$、$C_{i}$、$O$、$K_{c}$、$K_{o}$ 和 $\\Gamma^{*}$ 表示。\n2. 通过比较 $W_{c}$ 和 $W_{j}$ 来确定限制机制。将该机制编码为一个实数 $r$，其中 $r = 0$ 代表 Rubisco 限制，$r = 1$ 代表电子传递限制。\n3. 计算净同化速率 $A$，即相应的总速率减去 $R_{d}$。\n4. 使用第2步中的限制表达式，量化在指定 $C_{i}$ 下的瞬时敏感性 $\\partial A/\\partial C_{i}$。\n\n$A$ 的单位为 $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$，$\\partial A/\\partial C_{i}$ 的单位为 $\\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\\,\\mu\\mathrm{bar}^{-1}$。将 $A$ 和 $\\partial A/\\partial C_{i}$ 四舍五入到四位有效数字。将最终结果以行向量 $(A, \\partial A/\\partial C_{i}, r)$ 的形式报告。行向量中不包含单位。",
            "solution": "该问题陈述经评估具有科学依据、问题明确且客观。它基于 $\\text{C}_3$ 光合作用的标准 Farquhar、von Caemmerer 和 Berry (FvCB) 模型，该模型是植物生理学和生态系统建模的基石。所有必要的参数都以物理上现实的值和一致的单位给出，任务定义清晰。因此，该问题被认为是有效的，并应提供完整的解决方案。\n\n按要求分四个连续步骤进行求解。\n\n### 1. 推导 $W_c$ 和 $W_j$ 的表达式\n\n总同化速率被建模为两个限制速率的最小值：Rubisco 限制速率 ($W_c$) 和电子传递限制速率 ($W_j$)。\n\nRubisco 限制速率 $W_c$ 由 Rubisco 酶的羧化能力决定。其动力学由一个针对底物 $\\text{CO}_2$ (分压为 $C_i$) 的 Michaelis-Menten 方程描述，其中包含 $\\text{O}_2$ (分压为 $O$) 的竞争性抑制。光呼吸（消耗一部分固定碳）的净效应通过无无线粒体呼吸时的 $\\text{CO}_2$ 补偿点 $\\Gamma^*$ 纳入模型。羧化速率 $v_c$ 由下式给出：\n$$ v_c = \\frac{V_{c\\max} C_i}{C_i + K_c \\left(1 + \\frac{O}{K_o}\\right)} $$\n总同化速率 $W_c$ 通过将 $v_c$ 乘以因子 $(1 - \\Gamma^*/C_i)$ 来解释通过光呼吸途径释放的碳，从而得出标准表达式：\n$$ W_c = v_c \\left(1 - \\frac{\\Gamma^*}{C_i}\\right) = \\frac{V_{c\\max} (C_i - \\Gamma^*)}{C_i + K_c \\left(1 + \\frac{O}{K_o}\\right)} $$\n\n电子传递限制速率 $W_j$ 由 1,5-二磷酸核酮糖 (RuBP) 的再生速率决定，RuBP 的再生由光合作用的光依赖反应产生的 ATP 和 NADPH 驱动。有效电子传递速率给定为 $J$。根据 $\\text{C}_3$ 光合作用的经典化学计量学，总同化速率 $W_j$ 与 $J$、$C_i$ 和 $\\Gamma^*$ 相关。这种关系解释了电子在羧化和加氧途径之间的分配。电子传递限制的总同化速率的标准表达式为：\n$$ W_j = \\frac{J (C_i - \\Gamma^*)}{4(C_i + 2\\Gamma^*)} $$\n\n### 2. 确定限制机制\n\n为了确定起作用的限制过程，我们使用提供的参数计算 $W_c$ 和 $W_j$ 的数值：\n- $V_{c\\max} = 70 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n- $J = 140 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n- $C_i = 300 \\, \\mu\\mathrm{bar}$\n- $O = 21000 \\, \\mu\\mathrm{bar}$\n- $K_c = 404 \\, \\mu\\mathrm{bar}$\n- $K_o = 27800 \\, \\mu\\mathrm{bar}$\n- $\\Gamma^* = 42 \\, \\mu\\mathrm{bar}$\n\n首先，我们计算在有氧条件下羧化作用的有效 Michaelis-Menten 常数，我们称之为 $K_{eff}$：\n$$ K_{eff} = K_c \\left(1 + \\frac{O}{K_o}\\right) = 404 \\, \\mu\\mathrm{bar} \\left(1 + \\frac{21000 \\, \\mu\\mathrm{bar}}{27800 \\, \\mu\\mathrm{bar}}\\right) \\approx 404(1.755396) \\approx 709.18 \\, \\mu\\mathrm{bar} $$\n现在我们可以计算 $W_c$：\n$$ W_c = \\frac{V_{c\\max} (C_i - \\Gamma^*)}{C_i + K_{eff}} = \\frac{70 \\, (300 - 42)}{300 + 709.18} = \\frac{70 \\times 258}{1009.18} = \\frac{18060}{1009.18} \\approx 17.8956 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\n接下来，我们计算 $W_j$：\n$$ W_j = \\frac{J (C_i - \\Gamma^*)}{4(C_i + 2\\Gamma^*)} = \\frac{140 \\, (300 - 42)}{4(300 + 2 \\times 42)} = \\frac{140 \\times 258}{4(384)} = \\frac{36120}{1536} = 23.515625 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\n比较这两个速率，我们发现 $W_c \\approx 17.90 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 且 $W_j \\approx 23.52 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n由于 $W_c  W_j$，总同化速率受 Rubisco 活性限制。根据问题的编码方案，这对应于机制标识符 $r=0$。\n\n### 3. 计算净同化速率 $A$\n\n总同化速率 $A_g$ 是潜在速率的最小值：\n$$ A_g = \\min(W_c, W_j) = W_c \\approx 17.8956 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\n净同化速率 $A$ 是总速率减去光下线粒体呼吸速率 $R_d$：\n$$ A = A_g - R_d = 17.8956 - 1.5 = 16.3956 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\n四舍五入到四位有效数字，我们得到 $A = 16.40 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。\n\n### 4. 量化瞬时敏感性 $\\partial A/\\partial C_{i}$\n\n净同化速率对胞间 $\\text{CO}_2$ 的敏感性是偏导数 $\\partial A/\\partial C_i$。由于系统在指定的工作点是 Rubisco 限制的，所以 $A = W_c - R_d$。因此，导数为：\n$$ \\frac{\\partial A}{\\partial C_i} = \\frac{\\partial}{\\partial C_i} (W_c - R_d) = \\frac{\\partial W_c}{\\partial C_i} $$\n因为 $R_d$ 相对于 $C_i$ 是常数。我们使用商法则对 $W_c$ 的表达式关于 $C_i$求导。为简化起见，令 $K' = K_c(1 + O/K_o)$。\n$$ W_c = V_{c\\max} \\frac{C_i - \\Gamma^*}{C_i + K'} $$\n$$ \\frac{\\partial W_c}{\\partial C_i} = V_{c\\max} \\left[ \\frac{(1)(C_i + K') - (C_i - \\Gamma^*)(1)}{(C_i + K')^2} \\right] $$\n$$ \\frac{\\partial W_c}{\\partial C_i} = V_{c\\max} \\left[ \\frac{K' + \\Gamma^*}{(C_i + K')^2} \\right] = \\frac{V_{c\\max} \\left( K_c\\left(1 + \\frac{O}{K_o}\\right) + \\Gamma^* \\right)}{\\left( C_i + K_c\\left(1 + \\frac{O}{K_o}\\right) \\right)^2} $$\n代入数值：\n$$ \\frac{\\partial A}{\\partial C_i} = \\frac{70 \\, (709.18 + 42)}{(300 + 709.18)^2} = \\frac{70 \\times 751.18}{(1009.18)^2} = \\frac{52582.6}{1018443.9} \\approx 0.051629 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\\,\\mu\\mathrm{bar}^{-1} $$\n四舍五入到四位有效数字，我们得到 $\\partial A/\\partial C_i = 0.05163 \\, \\mu\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\\,\\mu\\mathrm{bar}^{-1}$。\n\n最终结果为包含计算值的行向量 $(A, \\partial A/\\partial C_{i}, r)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 16.40  0.05163  0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "一个生态系统远不止一片叶子。本节练习旨在解决一个关键挑战：如何将我们对叶片的理解扩展到整个植被冠层。你将实现并比较两种有影响力的模型——“大叶模型”和“双叶模型”——来理解冠层内的光分布如何产生非线性效应，以及为何通常需要更复杂的模型来准确估算生态系统总初级生产力（GPP）。",
            "id": "3921337",
            "problem": "考虑一个受直射和散射入射光影响的水平均质冠层。目标是分别使用双叶（阳叶和阴叶）方法和大叶方法计算冠层尺度的总初级生产力（GPP），然后量化两者之间的差异。假设所有光合作用和气孔参数在单位叶面积上是均匀的，并且温度固定在一个参考值，因此忽略了温度依赖性。您必须以每平方米每秒微摩尔二氧化碳（即 $\\mu\\mathrm{mol}\\ \\mathrm{CO}_2\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$）为单位给出结果。\n\n基本原理：\n- 比尔-朗伯衰减定律：对于一个叶面积指数（LAI）为 $L$、光合有效辐射（PAR）的单光束消光系数为 $k$ 的冠层，整个冠层吸收的入射PAR的分数为 $1 - e^{-kL}$。设冠层顶部的入射PAR为 $I_0$，通过散射比例 $f_d \\in [0,1]$ 分为直射光束和散射部分。则直射PAR为 $I_b = (1 - f_d) I_0$，散射PAR为 $I_d = f_d I_0$。冠层吸收的总PAR为 $I_{\\mathrm{abs,tot}} = (1 - e^{-kL})(I_b + I_d)$。\n- 双叶模型中阳叶-阴叶的划分：阳叶的叶面积指数为 $L_s = \\frac{1 - e^{-kL}}{k}$，阴叶的叶面积指数为 $L_{sh} = L - L_s$。单位叶面积（在所有叶片上平均）吸收的散射PAR等于 $I_{\\mathrm{diff,leaf}} = \\frac{(1 - e^{-kL}) I_d}{L}$。单位阳叶面积吸收的直射光束PAR等于 $I_{\\mathrm{beam,sun}} = \\frac{(1 - e^{-kL}) I_b}{L_s}$。因此，阳叶吸收的平均PAR为 $I_{\\mathrm{sun}} = I_{\\mathrm{diff,leaf}} + I_{\\mathrm{beam,sun}}$，阴叶吸收的平均PAR为 $I_{\\mathrm{sh}} = I_{\\mathrm{diff,leaf}}$。\n- 大叶近似：所有叶片被视为具有相同的单位叶面积吸收PAR，等于冠层平均值 $I_{\\mathrm{leaf,avg}} = \\frac{(1 - e^{-kL}) I_0}{L}$；冠层同化作用通过将单位叶面积的同化作用乘以 $L$ 得到。\n- 叶片尺度光合作用模型：使用广为接受的$\\text{C}_3$ Farquhar–von Caemmerer–Berry模型。定义单位叶面积在饱和光下的最大羧化能力 $V_{cmax}$，二氧化碳和氧气的米氏常数 $K_c$ 和 $K_o$，光呼吸补偿点 $\\Gamma^\\ast$，以及环境氧气浓度 $O$。设 $c_a$ 为环境二氧化碳浓度。受1,5-二磷酸核酮糖羧化酶/加氧酶（Rubisco）限制的速率为\n$$\nW_c(c_i) = V_{cmax} \\frac{c_i - \\Gamma^\\ast}{c_i + K_c \\left(1 + \\frac{O}{K_o}\\right)},\n$$\n受光限制的速率为\n$$\nW_j(c_i) = \\frac{J}{4} \\frac{c_i - \\Gamma^\\ast}{c_i + 2\\Gamma^\\ast},\n$$\n其中电子传递速率 $J$ 由非矩形双曲线给出\n$$\nJ = \\frac{\\alpha I_{\\mathrm{abs}} + J_{\\max} - \\sqrt{(\\alpha I_{\\mathrm{abs}} + J_{\\max})^2 - 4\\theta \\alpha I_{\\mathrm{abs}} J_{\\max}}}{2\\theta},\n$$\n其中量子产额为 $\\alpha$，曲率参数为 $\\theta$，最大电子传递速率为 $J_{\\max}$。在参考温度下，一个常见的经验关系是 $J_{\\max} = \\lambda V_{cmax}$，其中 $\\lambda$ 是一个标量。叶片暗呼吸速率为 $R_d = \\rho V_{cmax}$，其中 $\\rho$ 是一个标量。单位叶面积的净同化速率为 $A(c_i) = \\min(W_c, W_j) - R_d$。\n- 气孔导度闭合与扩散：使用Medlyn气孔导度模型，其中饱和水汽压差（VPD）$D$ 的单位是千帕（kPa），基线导度为 $g_0$，斜率参数为 $g_1$，\n$$\ng_s(A) = g_0 + 1.6\\left(1 + \\frac{g_1}{\\sqrt{D}}\\right)\\frac{A}{c_a},\n$$\n以及菲克扩散闭合方程\n$$\nA = \\frac{g_s(A)}{1.6}(c_a - c_i).\n$$\n求解满足该耦合系统的胞间二氧化碳浓度 $c_i$；在该 $c_i$ 下，恢复净同化速率 $A$ 和总同化速率 $W = \\min(W_c, W_j)$。只有非负值对GPP有贡献。\n\n目标：\n- 实现双叶模型的GPP为 $GPP_{2} = L_s W_{\\mathrm{sun}} + L_{sh} W_{\\mathrm{sh}}$，其中 $W_{\\mathrm{sun}}$ 和 $W_{\\mathrm{sh}}$ 分别是在 $I_{\\mathrm{sun}}$ 和 $I_{\\mathrm{sh}}$ 下计算的总同化速率。\n- 实现大叶模型的GPP为 $GPP_{B} = L W_{\\mathrm{big}}$，其中 $W_{\\mathrm{big}}$ 是在 $I_{\\mathrm{leaf,avg}}$ 下计算的总同化速率。\n- 通过归一化差异 $D_N = \\frac{GPP_{2} - GPP_{B}}{GPP_{B}}$ 来量化差异（当 $GPP_{B} > 0$ 时），并在 $GPP_{B} = 0$ 时定义 $D_N = 0$。\n\n所有案例在参考温度下使用的常数：\n- $K_c = 404.9\\ \\mu\\mathrm{mol}\\ \\mathrm{mol}^{-1}$， $K_o = 278400\\ \\mu\\mathrm{mol}\\ \\mathrm{mol}^{-1}$， $\\Gamma^\\ast = 42.75\\ \\mu\\mathrm{mol}\\ \\mathrm{mol}^{-1}$， $O = 209000\\ \\mu\\mathrm{mol}\\ \\mathrm{mol}^{-1}$。\n- $\\alpha = 0.24$， $\\theta = 0.7$， $\\lambda = 1.67$， $\\rho = 0.015$。\n\n每个测试案例的输入：\n- 叶面积指数 $L$（单位为 $\\mathrm{m}^2\\ \\mathrm{leaf}\\ \\mathrm{m}^{-2}\\ \\mathrm{ground}$，作为比值是无量纲的），消光系数 $k$（无量纲），入射PAR $I_0$（单位为 $\\mu\\mathrm{mol}\\ \\mathrm{photons}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$），散射比例 $f_d$（无量纲），单位叶面积的 $V_{cmax}$（单位为 $\\mu\\mathrm{mol}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$），Medlyn参数 $g_0$（单位叶面积，单位为 $\\mathrm{mol}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$），$g_1$（无量纲），饱和水汽压差 $D$（单位为 $\\mathrm{kPa}$），以及环境二氧化碳 $c_a$（单位为 $\\mu\\mathrm{mol}\\ \\mathrm{mol}^{-1}$）。\n\n需要实现的测试套件：\n- 案例1（基线，混合光）：$L = 3.0$，$k = 0.5$，$I_0 = 1200$，$f_d = 0.2$，$V_{cmax} = 60$，$g_0 = 0.01$，$g_1 = 9.0$，$D = 1.5$，$c_a = 400$。\n- 案例2（低光，高散射，潜在接近补偿点）：$L = 3.0$，$k = 0.5$，$I_0 = 50$，$f_d = 0.8$，$V_{cmax} = 60$，$g_0 = 0.01$，$g_1 = 9.0$，$D = 1.0$，$c_a = 400$。\n- 案例3（密集冠层，低消光）：$L = 6.0$，$k = 0.3$，$I_0 = 1500$，$f_d = 0.1$，$V_{cmax} = 45$，$g_0 = 0.01$，$g_1 = 6.0$，$D = 2.0$，$c_a = 400$。\n- 案例4（稀疏冠层，中等散射）：$L = 0.5$，$k = 0.7$，$I_0 = 1000$，$f_d = 0.5$，$V_{cmax} = 80$，$g_0 = 0.02$，$g_1 = 9.0$，$D = 0.5$，$c_a = 410$。\n\n每个测试案例的必需输出：\n- $GPP_{2}$，$GPP_{B}$ 和 $D_N$，前两者为实数，单位为 $\\mu\\mathrm{mol}\\ \\mathrm{CO}_2\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$，$D_N$ 为无量纲实数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试案例的所有结果，以逗号分隔列表的形式封装在方括号中，按测试案例排序，并且在每个测试案例内部按 $[GPP_{2}, GPP_{B}, D_N]$ 的顺序排列。即，总输出为 $[GPP_{2}^{(1)}, GPP_{B}^{(1)}, D_N^{(1)}, GPP_{2}^{(2)}, GPP_{B}^{(2)}, D_N^{(2)}, GPP_{2}^{(3)}, GPP_{B}^{(3)}, D_N^{(3)}, GPP_{2}^{(4)}, GPP_{B}^{(4)}, D_N^{(4)}]$。",
            "solution": "使用双叶模型和大叶模型计算冠层尺度总初级生产力（GPP）的问题，是陆地生态系统模拟领域一个定义明确且具有科学依据的练习。验证过程证实，问题陈述是自洽的，提供了所有必要的方程、常数和参数。所使用的物理和生化模型——包括比尔-朗伯光衰减、用于$\\text{C}_3$光合作用的Farquhar-von Caemmerer-Berry（FvCB）模型以及Medlyn气孔导度模型——都是该领域的标准模型。提供的参数和常数在现实范围内，单位系统虽然混合了摩尔和微摩尔量纲，但在仔细检查后是内部一致的。因此，该问题被认为是有效的，可以制定解决方案。\n\n问题的核心是确定在特定环境条件下叶片的总光合速率（$W$），这需要求解一个关于净同化速率（$A$）和胞间CO$_2$浓度（$c_i$）的耦合方程组。求解过程首先是构建一个函数来解决这个叶片尺度的问题，然后将其应用于双叶和大叶冠层方案的上下文中。\n\n### 1. 叶片级光合作用与气孔导度\n\n对于单片叶子，净同化速率 $A$ 由通过气孔的CO$_2$供应（需求）和光合生化过程消耗的CO$_2$（供给）之间的平衡决定。\n\n**生化供给：** CO$_2$的供给由光合作用驱动。净同化速率 $A$ 是总同化速率 $W$ 减去叶片暗呼吸 $R_d$。\n$$A_{\\text{supply}}(c_i) = W(c_i) - R_d$$\n总同化速率 $W(c_i)$ 是Rubisco限制速率（$W_c$）和光限制、RuBP再生限制速率（$W_j$）中的较小值。\n$$W(c_i) = \\min(W_c(c_i), W_j(c_i))$$\n这些速率由以下公式给出：\n$$W_c(c_i) = V_{cmax} \\frac{c_i - \\Gamma^\\ast}{c_i + K_c \\left(1 + \\frac{O}{K_o}\\right)}$$\n$$W_j(c_i) = \\frac{J}{4} \\frac{c_i - \\Gamma^\\ast}{c_i + 2\\Gamma^\\ast}$$\n电子传递速率 $J$ 取决于吸收的光合有效辐射（$I_{\\mathrm{abs}}$），并使用非矩形双曲线计算：\n$$J = \\frac{(\\alpha I_{\\mathrm{abs}} + J_{\\max}) - \\sqrt{(\\alpha I_{\\mathrm{abs}} + J_{\\max})^2 - 4\\theta \\alpha I_{\\mathrm{abs}} J_{\\max}}}{2\\theta}$$\n最大电子传递速率 $J_{\\max}$ 和暗呼吸 $R_d$ 与最大羧化能力 $V_{cmax}$ 成比例：\n$$J_{\\max} = \\lambda V_{cmax}$$\n$$R_d = \\rho V_{cmax}$$\n\n**扩散需求：** CO$_2$的需求由通过气孔的菲克扩散控制。通量 $A$ 与水蒸气气孔导度 $g_s$ 通过两个方程耦合：\n$$A = \\frac{g_s}{1.6}(c_a - c_i)$$\n$$g_s = g_0 + 1.6\\left(1 + \\frac{g_1}{\\sqrt{D}}\\right)\\frac{A}{c_a}$$\n将第二个方程代入第一个方程，可以解出作为 $c_i$ 函数的 $A$，代表需求侧：\n$$A = \\frac{1}{1.6} \\left( g_0 + 1.6\\left(1 + \\frac{g_1}{\\sqrt{D}}\\right)\\frac{A}{c_a} \\right) (c_a - c_i)$$\n$$A \\left( 1 - \\left(1 + \\frac{g_1}{\\sqrt{D}}\\right)\\frac{c_a - c_i}{c_a} \\right) = \\frac{g_0}{1.6}(c_a - c_i)$$\n因此，净同化的需求函数为：\n$$A_{\\text{demand}}(c_i) = \\frac{\\frac{g_0}{1.6}(c_a - c_i)}{1 - \\left(1 + \\frac{g_1}{\\sqrt{D}}\\right)\\frac{c_a - c_i}{c_a}}$$\n\n**求解工作点：** 通过令供给函数和需求函数相等来找到工作点（$c_i, A$）：$A_{\\text{supply}}(c_i) = A_{\\text{demand}}(c_i)$。这是一个关于 $c_i$ 的非线性方程，必须进行数值求解。我们寻找函数 $f(c_i) = A_{\\text{supply}}(c_i) - A_{\\text{demand}}(c_i)$ 的根。$c_i$ 的物理意义范围是 $[\\Gamma^\\ast, c_a]$。由于 $A_{\\text{supply}}$ 是 $c_i$ 的增函数，而 $A_{\\text{demand}}$ 是 $c_i$ 的减函数，因此在该区间内保证存在唯一根，可以使用诸如Brent-Dekker方法的数值求根算法高效地找到。一旦找到工作点 $c_i$，就可以计算相应的总同化速率 $W(c_i)$。为确保物理有效性，我们取 $W = \\max(0, \\min(W_c, W_j))$。\n\n### 2. 冠层尺度GPP计算\n\n将叶片级模型应用于两种不同的冠层方案。对于每个测试案例，我们首先计算必要的光和叶面积分配。\n\n**光和叶面积分配：**\n- 总入射PAR：$I_0$\n- 直射和散射分量：$I_b = (1 - f_d) I_0$，$I_d = f_d I_0$\n- 冠层吸收的光分数：$f_{\\mathrm{abs}} = 1 - e^{-kL}$\n- 阳叶叶面积指数：$L_s = \\frac{1 - e^{-kL}}{k} = \\frac{f_{\\mathrm{abs}}}{k}$\n- 阴叶叶面积指数：$L_{sh} = L - L_s$\n\n**双叶模型（$GPP_{2}$）：**\n冠层被分为阳叶和阴叶部分，每部分都有一个独特的平均吸收PAR。\n- 单位阴叶面积的平均吸收PAR：$I_{\\mathrm{sh}} = \\frac{f_{\\mathrm{abs}} I_d}{L}$\n- 单位阳叶面积的平均吸收PAR：$I_{\\mathrm{sun}} = \\frac{f_{\\mathrm{abs}} I_d}{L} + \\frac{f_{\\mathrm{abs}} I_b}{L_s}$\n叶片级求解器被调用两次：\n1.  使用 $I_{\\mathrm{abs}} = I_{\\mathrm{sun}}$ 计算阳叶的总同化速率 $W_{\\mathrm{sun}}$。\n2.  使用 $I_{\\mathrm{abs}} = I_{\\mathrm{sh}}$ 计算阴叶的总同化速率 $W_{\\mathrm{sh}}$。\n冠层总GPP是两种叶片类型贡献的总和，按其各自的面积指数加权：\n$$GPP_{2} = L_s W_{\\mathrm{sun}} + L_{sh} W_{\\mathrm{sh}}$$\n\n**大叶模型（$GPP_{B}$）：**\n冠层被视为一个单一的“大叶”。假设所有叶片接收相同的平均吸收PAR。\n- 单位叶面积的冠层平均吸收PAR：$I_{\\mathrm{leaf,avg}} = \\frac{f_{\\mathrm{abs}} I_0}{L}$\n叶片级求解器被调用一次，使用 $I_{\\mathrm{abs}} = I_{\\mathrm{leaf,avg}}$ 来找到平均总同化速率 $W_{\\mathrm{big}}$。\n冠层总GPP是该平均速率乘以总叶面积指数：\n$$GPP_{B} = L W_{\\mathrm{big}}$$\n\n**归一化差异（$D_N$）：**\n两种模型之间的相对差异量化为：\n$$D_N = \\begin{cases} \\frac{GPP_{2} - GPP_{B}}{GPP_{B}}  \\text{if } GPP_{B} > 0 \\\\ 0  \\text{if } GPP_{B} = 0 \\end{cases}$$\n\n### 3. 算法实现\n\n该算法在Python中实现，使用`numpy`提高数值效率，并使用`scipy.optimize.brentq`进行稳健的求根。一个主函数遍历问题陈述中提供的每个测试案例。对于每个案例，它执行光分配，为所需场景（阳叶、阴叶、大叶）调用叶片级求解器，计算$GPP_{2}$、$GPP_{B}$和$D_N$，并将这三个结果附加到一个列表中。最后，将所有结果的列表格式化为所需的单行字符串输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the terrestrial carbon cycle modeling problem for the given test cases.\n    \"\"\"\n    \n    # Constants provided in the problem statement\n    CONSTS = {\n        'Kc': 404.9,          # Michaelis-Menten constant for CO2 (umol/mol)\n        'Ko': 278400.0,       # Michaelis-Menten constant for O2 (umol/mol)\n        'Gamma_star': 42.75,  # Photorespiratory compensation point (umol/mol)\n        'O': 209000.0,        # Ambient O2 concentration (umol/mol)\n        'alpha': 0.24,        # Quantum yield (mol electrons / mol photons)\n        'theta': 0.7,         # Curvature parameter of the light response curve\n        'lambda_': 1.67,      # Ratio of Jmax to Vcmax\n        'rho': 0.015,         # Ratio of Rd to Vcmax\n    }\n\n    def solve_leaf_photo(I_abs, Vcmax, g0, g1, D, ca, consts):\n        \"\"\"\n        Calculates leaf-level gross assimilation for a given set of conditions.\n        \n        This function solves the coupled system of photosynthesis and stomatal\n        conductance equations to find the operating internal CO2 concentration (ci)\n        and the corresponding gross assimilation rate (W).\n\n        Returns:\n            W (float): Gross assimilation rate in umol CO2 m^-2 s^-1.\n        \"\"\"\n        if Vcmax == 0 or I_abs == 0:\n            return 0.0\n\n        Jmax = consts['lambda_'] * Vcmax\n        Rd = consts['rho'] * Vcmax\n\n        # Electron transport rate J (solution to a quadratic equation)\n        j_num = consts['alpha'] * I_abs + Jmax\n        j_den = 2.0 * consts['theta']\n        # Handle case where I_abs is very low to avoid sqrt of negative\n        discriminant_val = j_num**2 - 4.0 * consts['theta'] * consts['alpha'] * I_abs * Jmax\n        if discriminant_val  0:\n            discriminant_val = 0\n            \n        j_sqrt = np.sqrt(discriminant_val)\n        J = (j_num - j_sqrt) / j_den\n\n        # Define the residual function f(ci) = A_supply - A_demand for root finding\n        def root_func(ci):\n            # A_supply(ci): Net assimilation from biochemical supply\n            # Clamp ci to be no less than Gamma_star to avoid non-physical results\n            ci = max(ci, consts['Gamma_star'])\n\n            Wc = Vcmax * (ci - consts['Gamma_star']) / (ci + consts['Kc'] * (1.0 + consts['O'] / consts['Ko']))\n            Wj = (J / 4.0) * (ci - consts['Gamma_star']) / (ci + 2.0 * consts['Gamma_star'])\n            \n            W = np.min([Wc, Wj])\n            A_supply = W - Rd\n\n            # A_demand(ci): Net assimilation from stomatal/diffusion demand\n            if ca - ci  1e-9:\n                return A_supply\n            \n            demand_denominator = 1.0 - (1.0 + g1 / np.sqrt(D)) * (ca - ci) / ca\n            if demand_denominator = 1e-9:\n                A_demand = (g0 / 1.6) * (ca - ci) / 1e-9 # effectively a very large number\n            else:\n                A_demand = (g0 / 1.6) * (ca - ci) / demand_denominator\n            \n            return A_supply - A_demand\n\n        # Find the root ci using Brent's method\n        # The physical range for ci is (Gamma_star, ca)\n        try:\n            # Check if a solution exists in the interval\n            if root_func(consts['Gamma_star'] + 1e-6) * root_func(ca) = 0:\n                 ci_sol = brentq(root_func, consts['Gamma_star'] + 1e-6, ca)\n            else:\n                # If conditions are very poor (e.g., low light), A_supply may always be  A_demand\n                # or A_supply  0. In this case, stomata close and ci approaches ca.\n                 ci_sol = ca\n        except ValueError:\n            ci_sol = ca\n\n        # Recalculate gross assimilation W at the solved ci\n        ci_sol = max(ci_sol, consts['Gamma_star'])\n        Wc_sol = Vcmax * (ci_sol - consts['Gamma_star']) / (ci_sol + consts['Kc'] * (1.0 + consts['O'] / consts['Ko']))\n        Wj_sol = (J / 4.0) * (ci_sol - consts['Gamma_star']) / (ci_sol + 2.0 * consts['Gamma_star'])\n        W_sol = np.min([Wc_sol, Wj_sol])\n        \n        return max(0.0, W_sol)\n\n    # Test cases from the problem statement\n    test_cases = [\n        # L,    k,    I0,   fd, Vcmax,   g0,   g1,    D,   ca\n        (3.0,  0.5, 1200.0, 0.2, 60.0, 0.01,  9.0,  1.5, 400.0), # Case 1\n        (3.0,  0.5,   50.0, 0.8, 60.0, 0.01,  9.0,  1.0, 400.0), # Case 2\n        (6.0,  0.3, 1500.0, 0.1, 45.0, 0.01,  6.0,  2.0, 400.0), # Case 3\n        (0.5,  0.7, 1000.0, 0.5, 80.0, 0.02,  9.0,  0.5, 410.0), # Case 4\n    ]\n\n    all_results = []\n    for case in test_cases:\n        L, k, I0, fd, Vcmax, g0, g1, D, ca = case\n\n        # Light and Leaf Area partitioning\n        Ib = (1.0 - fd) * I0\n        Id = fd * I0\n        f_abs_canopy = 1.0 - np.exp(-k * L)\n\n        Ls = f_abs_canopy / k if k > 0 else L\n        Lsh = L - Ls\n        \n        # --- Two-Leaf Model ---\n        I_diff_leaf = (f_abs_canopy * Id) / L if L > 0 else 0.0\n        I_beam_sun  = (f_abs_canopy * Ib) / Ls if Ls > 0 else 0.0\n        \n        I_sun = I_diff_leaf + I_beam_sun\n        I_sh = I_diff_leaf\n\n        W_sun = solve_leaf_photo(I_sun, Vcmax, g0, g1, D, ca, CONSTS)\n        W_sh = solve_leaf_photo(I_sh, Vcmax, g0, g1, D, ca, CONSTS)\n        \n        GPP2 = Ls * W_sun + Lsh * W_sh\n\n        # --- Big-Leaf Model ---\n        I_leaf_avg = (f_abs_canopy * I0) / L if L > 0 else 0.0\n        W_big = solve_leaf_photo(I_leaf_avg, Vcmax, g0, g1, D, ca, CONSTS)\n        GPPB = L * W_big\n\n        # --- Normalized Difference ---\n        DN = (GPP2 - GPPB) / GPPB if GPPB > 1e-9 else 0.0\n        \n        all_results.extend([GPP2, GPPB, DN])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "碳被光合作用固定后，它会去向何方？最后的这项练习将探讨碳分配和分解的“下游”路径。利用一个仓室模型，你将追踪碳从光合作用产物（GPP）流入不同植物组织（叶、木）并最终进入土壤的过程。通过这个练习，你将学会如何运用线性系统理论来分析生态系统对变化的瞬时响应，并理解碳在不同库中的存留时间。",
            "id": "3921364",
            "problem": "考虑一个具有三个库的线性陆地碳循环模型：叶（$L$）、木（$W$）和土壤（$S$）。令 $\\mathbf{C}(t) = [C_L(t),C_W(t),C_S(t)]^\\top$ 表示碳储量，单位为千克碳每平方米（$\\mathrm{kg\\ C\\ m^{-2}}$）。该系统遵循质量守恒、一阶损失和凋落物引起的线性库间转移。具体假设如下：\n- 叶、木和土壤的一阶损失率分别为 $k_L$、$k_W$ 和 $k_S$，单位均为 $\\mathrm{s^{-1}}$。\n- 分数 $p_{LS}$ 和 $p_{WS}$，其中 $p_{LS} \\in [0,1]$ 是叶片损失中成为土壤输入的分数（剩余部分 $1-p_{LS}$ 通过呼吸作用返回大气），$p_{WS} \\in [0,1]$ 是木材损失中成为土壤输入的分数（剩余部分 $1-p_{WS}$ 通过呼吸作用返回大气）。\n- 一个外部输入向量 $\\mathbf{I}(t) = [I_L(t), I_W(t), I_S(t)]^\\top$，单位为 $\\mathrm{kg\\ C\\ m^{-2}\\ s^{-1}}$，代表对叶和木的光合分配以及外源土壤输入（例如，根系分泌物）。\n\n在这些假设下，状态空间模型为\n$$\n\\frac{d\\mathbf{C}}{dt} = \\mathbf{I}(t) - \\mathbf{A}\\,\\mathbf{C}(t),\n$$\n其中\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\nk_L  0  0 \\\\\n0  k_W  0 \\\\\n- p_{LS}\\,k_L  - p_{WS}\\,k_W  k_S\n\\end{bmatrix},\n$$\n因此\n$\n\\frac{dC_L}{dt} = I_L(t) - k_L C_L,\\ \n\\frac{dC_W}{dt} = I_W(t) - k_W C_W,\\ \n\\frac{dC_S}{dt} = I_S(t) + p_{LS} k_L C_L + p_{WS} k_W C_W - k_S C_S.\n$\n\n假设在 $t  0$ 时，系统在恒定的阶跃前输入 $\\mathbf{I}_{\\text{old}}$ 下处于稳态，因此 $\\mathbf{A}\\,\\mathbf{C}(0) = \\mathbf{I}_{\\text{old}}$。在 $t=0$ 时，叶输入经历一个幅度为 $\\Delta I_L$（单位为 $\\mathrm{kg\\ C\\ m^{-2}\\ s^{-1}}$）的阶跃增加，即\n$\nI_L(t) = I_{L,\\text{old}} + \\Delta I_L\\,u(t),\n$\n其中 $u(t)$ 是单位阶跃函数。木和土壤的输入保持不变，因此对于 $t \\ge 0$，$\\mathbf{I}_{\\text{new}} = [I_{L,\\text{old}} + \\Delta I_L,\\ I_{W,\\text{old}},\\ I_{S,\\text{old}}]^\\top$。\n\n任务：对于下面的每个测试用例，构建 $\\mathbf{A}$，计算满足 $\\mathbf{A}\\,\\mathbf{C}(0)=\\mathbf{I}_{\\text{old}}$ 的阶跃前稳态 $\\mathbf{C}(0)$，然后使用矩阵指数 $e^{-\\mathbf{A}t}$ 计算 $t \\ge 0$ 时的瞬态解 $\\mathbf{C}(t)$。报告在指定评估时间 $T$ 时的 $\\mathbf{C}(T)$。\n\n所有碳储量的输出均以 $\\mathrm{kg\\ C\\ m^{-2}}$ 为单位，四舍五入到六位小数。不涉及角度。不要使用百分号；任何分数都应表示为小数。\n\n测试套件（每个参数集在物理上都是合理的，并在适用时使用从天和年到秒的转换；使用 $1\\ \\mathrm{day} = 86{,}400\\ \\mathrm{s}$ 和 $1\\ \\mathrm{year} = 365\\times 86{,}400\\ \\mathrm{s}$）：\n1. 正常路径：\n   - $k_L = \\frac{1}{30\\ \\mathrm{days}}$，\n   - $k_W = \\frac{1}{5\\ \\mathrm{years}}$，\n   - $k_S = \\frac{1}{2\\ \\mathrm{years}}$，\n   - $p_{LS} = 0.7$， $p_{WS} = 0.9$，\n   - $\\mathbf{I}_{\\text{old}} = \\left[\\frac{0.004}{1\\ \\mathrm{day}},\\ \\frac{0.002}{1\\ \\mathrm{day}},\\ \\frac{0.0001}{1\\ \\mathrm{day}}\\right]$，\n   - $\\Delta I_L = \\frac{0.001}{1\\ \\mathrm{day}}$，\n   - $T = 7\\ \\mathrm{days}$。\n2. 零阶跃（边界一致性）：\n   - $k_L = \\frac{1}{30\\ \\mathrm{days}}$，\n   - $k_W = \\frac{1}{5\\ \\mathrm{years}}$，\n   - $k_S = \\frac{1}{2\\ \\mathrm{years}}$，\n   - $p_{LS} = 0.7$， $p_{WS} = 0.9$，\n   - $\\mathbf{I}_{\\text{old}} = \\left[\\frac{0.004}{1\\ \\mathrm{day}},\\ \\frac{0.002}{1\\ \\mathrm{day}},\\ \\frac{0.0001}{1\\ \\mathrm{day}}\\right]$，\n   - $\\Delta I_L = \\frac{0}{1\\ \\mathrm{day}}$，\n   - $T = 10\\ \\mathrm{days}$。\n3. 木材腐烂缓慢，无叶到土壤的转移，土壤周转快：\n   - $k_L = \\frac{1}{60\\ \\mathrm{days}}$，\n   - $k_W = \\frac{1}{50\\ \\mathrm{years}}$，\n   - $k_S = \\frac{1}{0.5\\ \\mathrm{years}}$，\n   - $p_{LS} = 0.0$， $p_{WS} = 0.6$，\n   - $\\mathbf{I}_{\\text{old}} = \\left[\\frac{0.003}{1\\ \\mathrm{day}},\\ \\frac{0.001}{1\\ \\mathrm{day}},\\ \\frac{0.0002}{1\\ \\mathrm{day}}\\right]$，\n   - $\\Delta I_L = \\frac{0.005}{1\\ \\mathrm{day}}$，\n   - $T = 20\\ \\mathrm{years}$。\n4. 瞬时评估（$T=0$）：\n   - $k_L = \\frac{1}{20\\ \\mathrm{days}}$，\n   - $k_W = \\frac{1}{10\\ \\mathrm{years}}$，\n   - $k_S = \\frac{1}{1\\ \\mathrm{year}}$，\n   - $p_{LS} = 0.5$， $p_{WS} = 0.8$，\n   - $\\mathbf{I}_{\\text{old}} = \\left[\\frac{0.006}{1\\ \\mathrm{day}},\\ \\frac{0.0025}{1\\ \\mathrm{day}},\\ \\frac{0.00015}{1\\ \\mathrm{day}}\\right]$，\n   - $\\Delta I_L = \\frac{0.001}{1\\ \\mathrm{day}}$，\n   - $T = 0\\ \\mathrm{days}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个项目是对应测试用例的列表 $[C_L(T),C_W(T),C_S(T)]$，每个数字四舍五入到六位小数（例如，$[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$）。",
            "solution": "用户提供的问题陈述是完整、自洽且有科学依据的。它描述了一个线性的三库陆地碳循环模型，这是环境和地球系统建模中的一个标准构造。控制方程是一个线性一阶常微分方程组，该方程组是适定的。参数和初始条件定义清晰，任务是线性系统分析中的一个标准练习。因此，该问题被认为是有效的，并将提供解决方案。\n\n系统的状态由碳储量向量 $\\mathbf{C}(t) = [C_L(t), C_W(t), C_S(t)]^\\top$ 描述，其中 $C_L$、$C_W$ 和 $C_S$ 分别代表叶、木和土壤库中的碳。动态由线性状态空间模型控制：\n$$\n\\frac{d\\mathbf{C}}{dt} = \\mathbf{I}(t) - \\mathbf{A}\\,\\mathbf{C}(t)\n$$\n其中 $\\mathbf{I}(t)$ 是外部碳输入向量，$\\mathbf{A}$ 是系统矩阵。对于 $t \\ge 0$，输入向量是恒定的，记为 $\\mathbf{I}_{\\text{new}}$。方程可以改写为：\n$$\n\\frac{d\\mathbf{C}}{dt} + \\mathbf{A}\\,\\mathbf{C}(t) = \\mathbf{I}_{\\text{new}}\n$$\n这是一个非齐次线性常微分方程组。解可以通过考虑与新稳态的偏差来找到。\n\n首先，我们确定初始条件 $\\mathbf{C}(0)$。问题陈述指出，对于 $t  0$，系统在恒定输入 $\\mathbf{I}_{\\text{old}}$ 下处于稳态。在稳态时，$\\frac{d\\mathbf{C}}{dt} = \\mathbf{0}$，这意味着：\n$$\n\\mathbf{A}\\,\\mathbf{C}(0) = \\mathbf{I}_{\\text{old}}\n$$\n系统矩阵 $\\mathbf{A}$ 由下式给出：\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\nk_L  0  0 \\\\\n0  k_W  0 \\\\\n- p_{LS}\\,k_L  - p_{WS}\\,k_W  k_S\n\\end{bmatrix}\n$$\n其行列式为 $\\det(\\mathbf{A}) = k_L k_W k_S$。由于损失率 $k_L$、$k_W$ 和 $k_S$ 是周转时间的倒数，它们是严格为正的。因此，$\\det(\\mathbf{A}) \\ne 0$，矩阵 $\\mathbf{A}$ 是可逆的。初始状态 $\\mathbf{C}(0)$ 由下式唯一确定：\n$$\n\\mathbf{C}(0) = \\mathbf{A}^{-1}\\mathbf{I}_{\\text{old}}\n$$\n接下来，我们定义新的稳态 $\\mathbf{C}_{\\text{new,ss}}$，当 $t \\to \\infty$ 时，系统将在新的恒定输入 $\\mathbf{I}_{\\text{new}}$ 下趋近于该状态。该状态也是通过将导数设为零来找到的：\n$$\n\\mathbf{A}\\,\\mathbf{C}_{\\text{new,ss}} = \\mathbf{I}_{\\text{new}} \\implies \\mathbf{C}_{\\text{new,ss}} = \\mathbf{A}^{-1}\\mathbf{I}_{\\text{new}}\n$$\n为了找到 $t \\ge 0$ 时的瞬态解，我们引入一个新变量 $\\mathbf{y}(t)$，表示状态与新平衡点的偏差：\n$$\n\\mathbf{y}(t) = \\mathbf{C}(t) - \\mathbf{C}_{\\text{new,ss}}\n$$\n时间导数为 $\\frac{d\\mathbf{y}}{dt} = \\frac{d\\mathbf{C}}{dt}$，因为 $\\mathbf{C}_{\\text{new,ss}}$ 是一个常数向量。将其代入控制方程：\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{I}_{\\text{new}} - \\mathbf{A}\\,\\mathbf{C}(t) = \\mathbf{A}\\,\\mathbf{C}_{\\text{new,ss}} - \\mathbf{A}\\,\\mathbf{C}(t) = -\\mathbf{A}(\\mathbf{C}(t) - \\mathbf{C}_{\\text{new,ss}})\n$$\n这简化为一个齐次线性微分方程：\n$$\n\\frac{d\\mathbf{y}}{dt} = -\\mathbf{A}\\,\\mathbf{y}(t)\n$$\n这个方程的解由矩阵指数给出：\n$$\n\\mathbf{y}(t) = e^{-\\mathbf{A}t} \\mathbf{y}(0)\n$$\n其中 $\\mathbf{y}(0) = \\mathbf{C}(0) - \\mathbf{C}_{\\text{new,ss}}$ 是初始偏差。代回 $\\mathbf{C}(t)$：\n$$\n\\mathbf{C}(t) - \\mathbf{C}_{\\text{new,ss}} = e^{-\\mathbf{A}t} (\\mathbf{C}(0) - \\mathbf{C}_{\\text{new,ss}})\n$$\n这就得到了 $t \\ge 0$ 时 $\\mathbf{C}(t)$ 的完整瞬态解：\n$$\n\\mathbf{C}(t) = \\mathbf{C}_{\\text{new,ss}} + e^{-\\mathbf{A}t} (\\mathbf{C}(0) - \\mathbf{C}_{\\text{new,ss}})\n$$\n为了实现每个测试用例的解，使用以下算法：\n1.  将所有给定的与时间相关的参数（$k_L$、$k_W$、$k_S$、$\\mathbf{I}_{\\text{old}}$、$\\Delta I_L$ 和 $T$）转换为国际单位制（SI）的基本单位，即秒（$\\mathrm{s}$）和千克碳每平方米每秒（$\\mathrm{kg\\ C\\ m^{-2}\\ s^{-1}}$）。转换因子为 $1\\ \\mathrm{day} = 86400\\ \\mathrm{s}$ 和 $1\\ \\mathrm{year} = 365 \\times 86400\\ \\mathrm{s}$。\n2.  构建矩阵 $\\mathbf{A}$、阶跃前输入向量 $\\mathbf{I}_{\\text{old}}$ 和阶跃后输入向量 $\\mathbf{I}_{\\text{new}} = [I_{L,\\text{old}} + \\Delta I_L, I_{W,\\text{old}}, I_{S,\\text{old}}]^\\top$。\n3.  计算 $\\mathbf{A}$ 的逆矩阵，记为 $\\mathbf{A}^{-1}$。\n4.  计算初始碳储量向量 $\\mathbf{C}(0) = \\mathbf{A}^{-1}\\mathbf{I}_{\\text{old}}$。\n5.  计算新稳态碳储量向量 $\\mathbf{C}_{\\text{new,ss}} = \\mathbf{A}^{-1}\\mathbf{I}_{\\text{new}}$。\n6.  计算矩阵指数 $e^{-\\mathbf{A}T}$，其中 $T$ 是以秒为单位的评估时间。\n7.  使用推导出的解公式计算最终碳储量向量 $\\mathbf{C}(T)$。\n8.  按要求将 $\\mathbf{C}(T)$ 的分量四舍五入到六位小数。\n\n此过程应用于问题陈述中提供的每个测试用例。矩阵指数 $e^{-\\mathbf{A}T}$ 使用 `scipy.linalg.expm` 函数进行数值计算，矩阵-向量运算由 `numpy` 库处理。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the terrestrial carbon cycle model for given test cases.\n    \"\"\"\n    DAY_S = 86400.0\n    YEAR_S = 365.0 * DAY_S\n\n    test_cases = [\n        {\n            \"kL_inv_time\": 30.0 * DAY_S, \"kW_inv_time\": 5.0 * YEAR_S, \"kS_inv_time\": 2.0 * YEAR_S,\n            \"pLS\": 0.7, \"pWS\": 0.9,\n            \"I_old_vals\": [0.004, 0.002, 0.0001], \"I_old_times\": [DAY_S, DAY_S, DAY_S],\n            \"dIL_val\": 0.001, \"dIL_time\": DAY_S,\n            \"T_val\": 7.0, \"T_unit\": DAY_S\n        },\n        {\n            \"kL_inv_time\": 30.0 * DAY_S, \"kW_inv_time\": 5.0 * YEAR_S, \"kS_inv_time\": 2.0 * YEAR_S,\n            \"pLS\": 0.7, \"pWS\": 0.9,\n            \"I_old_vals\": [0.004, 0.002, 0.0001], \"I_old_times\": [DAY_S, DAY_S, DAY_S],\n            \"dIL_val\": 0.0, \"dIL_time\": DAY_S,\n            \"T_val\": 10.0, \"T_unit\": DAY_S\n        },\n        {\n            \"kL_inv_time\": 60.0 * DAY_S, \"kW_inv_time\": 50.0 * YEAR_S, \"kS_inv_time\": 0.5 * YEAR_S,\n            \"pLS\": 0.0, \"pWS\": 0.6,\n            \"I_old_vals\": [0.003, 0.001, 0.0002], \"I_old_times\": [DAY_S, DAY_S, DAY_S],\n            \"dIL_val\": 0.005, \"dIL_time\": DAY_S,\n            \"T_val\": 20.0, \"T_unit\": YEAR_S\n        },\n        {\n            \"kL_inv_time\": 20.0 * DAY_S, \"kW_inv_time\": 10.0 * YEAR_S, \"kS_inv_time\": 1.0 * YEAR_S,\n            \"pLS\": 0.5, \"pWS\": 0.8,\n            \"I_old_vals\": [0.006, 0.0025, 0.00015], \"I_old_times\": [DAY_S, DAY_S, DAY_S],\n            \"dIL_val\": 0.001, \"dIL_time\": DAY_S,\n            \"T_val\": 0.0, \"T_unit\": DAY_S\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Convert all parameters to base SI units\n        kL = 1.0 / case[\"kL_inv_time\"]\n        kW = 1.0 / case[\"kW_inv_time\"]\n        kS = 1.0 / case[\"kS_inv_time\"]\n        pLS = case[\"pLS\"]\n        pWS = case[\"pWS\"]\n        T_s = case[\"T_val\"] * case[\"T_unit\"]\n\n        I_old_per_s = np.array([v / t for v, t in zip(case[\"I_old_vals\"], case[\"I_old_times\"])])\n        dIL_per_s = case[\"dIL_val\"] / case[\"dIL_time\"]\n\n        # 2. Construct matrices and vectors\n        A = np.array([\n            [kL, 0, 0],\n            [0, kW, 0],\n            [-pLS * kL, -pWS * kW, kS]\n        ])\n\n        I_old = I_old_per_s\n        I_new = I_old + np.array([dIL_per_s, 0, 0])\n\n        # 3. Calculate initial state C(0) and new steady state C_new_ss\n        A_inv = np.linalg.inv(A)\n        C0 = A_inv @ I_old\n        C_new_ss = A_inv @ I_new\n\n        # 4. Calculate the transient solution C(T)\n        if T_s == 0:\n            # At T=0, the state is still the initial state C(0)\n            CT = C0\n        else:\n            # General solution: C(t) = C_new_ss + exp(-A*t) * (C(0) - C_new_ss)\n            mat_exp = expm(-A * T_s)\n            CT = C_new_ss + mat_exp @ (C0 - C_new_ss)\n        \n        # 5. Round and store the result\n        rounded_CT = np.round(CT, 6).tolist()\n        results.append(rounded_CT)\n        \n    # Final print statement in the exact required format without extra spaces.\n    final_output_str = str(results).replace(\" \", \"\")\n    print(final_output_str)\n\n```"
        }
    ]
}