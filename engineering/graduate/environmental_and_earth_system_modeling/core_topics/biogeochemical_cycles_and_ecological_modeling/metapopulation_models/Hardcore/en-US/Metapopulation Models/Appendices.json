{
    "hands_on_practices": [
        {
            "introduction": "Understanding any dynamical system begins with identifying its points of equilibrium. This first practice focuses on the classic Levins model, the conceptual cornerstone of metapopulation theory. By solving for the steady states of the system, you will derive the fundamental threshold that separates regional extinction from long-term persistence, providing a clear mathematical basis for one of ecology's most important concepts. ",
            "id": "2508400",
            "problem": "Consider a large metapopulation consisting of $N \\gg 1$ equivalent habitat patches. Let $p(t)$ denote the fraction of occupied patches at time $t$. Assume that colonization is driven by propagule rain from occupied to empty patches and is proportional to the product of the fraction of occupied and empty patches, while local extinction is proportional to the fraction of occupied patches. Under these assumptions, the occupancy dynamics are captured by the ordinary differential equation\n$$\n\\frac{\\mathrm{d}p}{\\mathrm{d}t} \\;=\\; c\\,p\\,(1-p)\\;-\\;e\\,p,\n$$\nwhere $c0$ is a colonization parameter and $e0$ is a local extinction parameter. Work within the biologically feasible state space $p \\in [0,1]$.\n\nStarting from the core definitions of equilibria for dynamical systems and linear stability for one-dimensional flows, do the following:\n- Identify all equilibrium occupancies $p^{*}$ in the feasible interval by solving for the roots of the right-hand side of the differential equation.\n- Classify the local stability of each equilibrium by analyzing the sign of the derivative of the right-hand side with respect to $p$ at each equilibrium.\n- Interpret ecologically the meanings of the equilibria $p^{*}=0$ and any interior equilibrium you find, including the parameter conditions under which each equilibrium exists and is stable, and the nature of the threshold that separates metapopulation persistence from regional extinction. Your interpretation should explicitly connect colonization and extinction processes to the feasibility of the equilibria.\n\nReport the set of all equilibrium occupancies as a row vector of analytic expressions in terms of $c$ and $e$. Do not include units. If your answer contains constants, keep them symbolic.",
            "solution": "The problem requires a complete analysis of the equilibria and their stability for the Levins metapopulation model, followed by an ecological interpretation. We will proceed systematically.\n\nThe dynamical system is described by the ordinary differential equation for the fraction of occupied patches, $p(t)$:\n$$\n\\frac{\\mathrm{d}p}{\\mathrm{d}t} = f(p) = c\\,p\\,(1-p) - e\\,p\n$$\nwhere $c  0$ and $e  0$ are the colonization and extinction parameters, respectively. The state space is restricted to the biologically feasible interval $p \\in [0, 1]$.\n\nFirst, we identify the equilibrium points, denoted by $p^{*}$, by finding the roots of the equation $f(p^{*}) = 0$.\n$$\nc\\,p^{*}\\,(1-p^{*}) - e\\,p^{*} = 0\n$$\nWe can factor out the term $p^{*}$ from the expression:\n$$\np^{*} \\left[ c(1-p^{*}) - e \\right] = 0\n$$\nThis equation yields two possible solutions for the equilibrium occupancy.\n\nThe first equilibrium is trivial:\n$$\np_1^{*} = 0\n$$\nThis equilibrium represents a metapopulation that is extinct, with zero patches occupied. It is always within the feasible interval $[0, 1]$.\n\nThe second equilibrium is found by setting the second factor to zero:\n$$\nc(1-p_2^{*}) - e = 0\n$$\nSolving for $p_2^{*}$:\n$$\nc - c p_2^{*} = e\n$$\n$$\nc p_2^{*} = c - e\n$$\n$$\np_2^{*} = \\frac{c-e}{c} = 1 - \\frac{e}{c}\n$$\nThis is the non-trivial, or interior, equilibrium. For this equilibrium to be biologically meaningful, it must be positive, i.e., $p_2^{*}  0$. Since $c$ and $e$ are positive, this requires $1 - \\frac{e}{c}  0$, which simplifies to $c  e$. It must also satisfy $p_2^{*} \\le 1$, which is always true because $1 - \\frac{e}{c} \\le 1$ as $\\frac{e}{c} \\ge 0$. Therefore, the interior equilibrium $p_2^{*}$ exists within the biologically meaningful interval $(0, 1]$ if and only if $c  e$.\n\nNext, we classify the local stability of each equilibrium. This is determined by the sign of the derivative of $f(p)$ at the equilibrium point, $f'(p^{*})$. An equilibrium is locally stable if $f'(p^{*})  0$ and unstable if $f'(p^{*})  0$.\n\nFirst, we find the derivative of $f(p)$:\n$$\nf(p) = cp - cp^2 - ep\n$$\n$$\nf'(p) = \\frac{\\mathrm{d}f}{\\mathrm{d}p} = c - 2cp - e\n$$\n\nNow, we evaluate $f'(p)$ at each equilibrium.\n\nFor the trivial equilibrium $p_1^{*} = 0$:\n$$\nf'(0) = c - 2c(0) - e = c - e\n$$\nThe stability of $p_1^{*} = 0$ depends on the relative values of $c$ and $e$:\n- If $c  e$, then $f'(0)  0$, and the equilibrium $p_1^{*} = 0$ is stable.\n- If $c  e$, then $f'(0)  0$, and the equilibrium $p_1^{*} = 0$ is unstable.\n- If $c = e$, then $f'(0) = 0$, and linear stability analysis is inconclusive. In this case, the differential equation becomes $\\frac{\\mathrm{d}p}{\\mathrm{d}t} = -cp^2$. For any $p  0$, $\\frac{\\mathrm{d}p}{\\mathrm{d}t}  0$, meaning the system will always move towards $p=0$. Thus, the equilibrium at $p=0$ is stable.\n\nFor the interior equilibrium $p_2^{*} = 1 - \\frac{e}{c}$:\n$$\nf'(1 - \\frac{e}{c}) = c - 2c\\left(1 - \\frac{e}{c}\\right) - e\n$$\n$$\n= c - (2c - 2e) - e = c - 2c + 2e - e = e - c\n$$\nThe stability of $p_2^{*}$ is determined as follows:\n- This equilibrium is biologically meaningful only when $c  e$. In this case, $e - c  0$, which implies $f'(p_2^{*})  0$. Therefore, when it exists in the interval $(0, 1]$, the interior equilibrium $p_2^{*}$ is always stable.\n- If $c  e$, the equilibrium is negative ($p_2^{*}0$) and thus not ecologically relevant. Mathematically, it is unstable since $e-c  0$.\n\nThe ecological interpretation of these findings is as follows:\n\nThe equilibrium $p^{*} = 0$ represents the state of regional extinction, where the metapopulation has vanished from the patch network. This state is the sole stable outcome when the extinction rate parameter $e$ is greater than the colonization rate parameter $c$ ($e  c$). In this regime, any small population of occupied patches will decline to zero because the rate of loss of patches to extinction exceeds the rate of gain from colonization.\n\nThe equilibrium $p^{*} = 1 - \\frac{e}{c}$ represents a state of metapopulation persistence, where colonization and extinction processes are balanced, resulting in a stable, non-zero fraction of occupied patches. This state is only possible when the colonization rate parameter is greater than the extinction rate parameter ($c  e$). This condition, $c  e$, or equivalently $\\frac{c}{e}  1$, is the fundamental threshold for metapopulation viability. It dictates that for a metapopulation to persist, the rate of colonization must be sufficient to overcome the rate of local extinction. When this condition holds, the regional extinction state ($p^{*}=0$) becomes unstable, meaning any small introduction of occupied patches will lead to growth and establishment of the metapopulation, which will then approach the stable persistence equilibrium $p^{*} = 1 - \\frac{e}{c}$.\n\nThe transition that occurs at $c=e$ is a transcritical bifurcation. For $c  e$, the only stable equilibrium in the feasible domain is $p^{*}=0$. As $c$ increases past $e$, the $p^{*}=0$ equilibrium loses its stability, and a new stable equilibrium $p^{*} = 1 - \\frac{e}{c}$ emerges in the positive domain. This bifurcation critically separates the parameter space into two distinct regions: one where the metapopulation is doomed to extinction ($c \\le e$) and one where it can persist indefinitely ($c  e$). This threshold behavior is a classic and fundamental result of metapopulation theory.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  1 - \\frac{e}{c} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While the basic Levins model provides crucial insights, real ecosystems often exhibit more complex, non-linear dynamics. This computational exercise extends the model to include the critical real-world pressures of habitat destruction and the stabilizing influence of the rescue effect. Through numerical simulation, you will explore the phenomenon of hysteresis, discovering how an ecosystem may not return to its original state even after the stressor is removed—a profound concept known as a \"tipping point\" with major implications for conservation and management. ",
            "id": "2508438",
            "problem": "Consider a metapopulation with patch occupancy fraction $p$ evolving under the classical Levins metapopulation framework, modified to include habitat destruction and a rescue effect. The dynamics are modeled as an ordinary differential equation (ODE), with colonization and extinction processes constructed from first principles as follows.\n\nFundamental base. The Levins metapopulation theory describes the temporal change in the fraction of occupied patches $p$ as the difference between colonization and extinction. Colonization is proportional to the product of the fraction of occupied patches and the fraction of empty habitable patches. Extinction is proportional to the fraction of occupied patches, with the proportionality factor depending on ecological conditions such as habitat destruction and local rescue effects.\n\nModeling assumptions and definitions.\n- Let $h \\in [0,1)$ denote the fraction of patches rendered uninhabitable by habitat destruction. The habitable fraction is $(1 - h)$, and the maximum attainable occupancy is $p \\le (1 - h)$.\n- Let $c gt; 0$ be the colonization rate constant. The rate of colonization per unit time is $c \\, p \\, ((1 - h) - p)$, which is proportional to the fraction of occupied patches $p$ and the fraction of empty habitable patches $((1 - h) - p)$.\n- Let $e(h)$ be the extinction rate, which increases with habitat destruction $h$. Use the well-tested functional form $e(h) = e_{0} \\, (1 + a \\, h)$, where $e_{0} gt; 0$ is the baseline extinction rate and $a \\ge 0$ quantifies how habitat destruction increases extinction risk.\n- Incorporate a rescue effect: the effective extinction rate per occupied patch is reduced as local occupancy increases. Define the normalized occupancy among habitable patches as $x = p / (1 - h)$. Assume a second-order rescue effect $R(x) = (1 - r \\, x^{2})$ with $r \\in [0,1]$, so that $R(x)$ decreases extinction with the square of normalized occupancy. The effective extinction contribution is $e(h) \\, R(x) \\, p = e(h) \\, (1 - r \\, (p/(1 - h))^{2}) \\, p$.\n- The resulting ODE is\n$$\n\\frac{dp}{dt} = c \\, p \\, ((1 - h) - p) - e(h) \\, \\left( 1 - r \\, \\left(\\frac{p}{1 - h}\\right)^{2} \\right) \\, p,\n$$\nwith $e(h) = e_{0} \\, (1 + a \\, h)$, $h \\in [0,1)$, and $p \\in [0, 1 - h]$.\n\nQuestion. Analyze hysteresis under a gradual increase and subsequent decrease of habitat destruction $h$. Specifically, determine whether restoring habitat destruction $h$ to its original value recovers the original equilibrium occupancy $p^{*}$ when both an $h$-dependent extinction increase $e(h)$ and a rescue effect are present. To make this question testable and fully specified, proceed as follows:\n\n- Define the equilibrium at a fixed $h$ as any $p^{*}$ satisfying $dp/dt = 0$. In one dimension, a stable equilibrium $p^{*}$ additionally satisfies $d(dp/dt)/dp \\vert_{p^{*}} lt; 0$.\n- Implement a numerical protocol that mimics the ecological process of gradual habitat destruction and restoration:\n  1. Fix an initial habitat destruction $h_{0}$ and choose the starting occupancy condition $p(0) = (1 - h_{0})/2$. Evolve the ODE at fixed $h=h_{0}$ until it converges to a steady state. Denote the resulting equilibrium by $p^{*}_{\\text{baseline}}(h_{0})$.\n  2. Quasi-statically increase $h$ from $h_{0}$ to $h_{\\max}$ in steps of $\\Delta h$. At each $h$, evolve the ODE until convergence starting from the equilibrium at the previous $h$ value. This constructs the forward (increasing $h$) branch of equilibria.\n  3. Quasi-statically decrease $h$ from $h_{\\max}$ back to $h_{0}$ in the same step size $\\Delta h$. At each $h$, evolve the ODE until convergence starting from the equilibrium at the previous $h$ value. This constructs the backward (decreasing $h$) branch of equilibria.\n  4. At $h=h_{0}$ after the backward ramp, let the converged value be $p^{*}_{\\text{return}}(h_{0})$.\n  5. Determine whether the original equilibrium is recovered by evaluating the boolean\n     $$\n     \\left| p^{*}_{\\text{return}}(h_{0}) - p^{*}_{\\text{baseline}}(h_{0}) \\right| \\le \\delta,\n     $$\n     with a prescribed tolerance $\\delta$.\n- Use deterministic time integration for the ODE; any numerically consistent scheme is acceptable, such as the classical fourth-order Runge–Kutta method with sufficiently small time step and convergence criteria based on both the change in $p$ and the magnitude of $dp/dt$. There are no physical units in this problem; all quantities are unitless fractions in $[0,1]$. Express boolean results as either the word True or False (no percentage signs may appear anywhere; all proportions must be decimals).\n\nNumerical protocol details for implementation:\n- Use a fixed time step $\\Delta t = 0.1$ and integrate for up to $T_{\\max} = 500$ time units (i.e., at most $5000$ steps) per $h$ value. At each fixed $h$, stop early if both conditions hold for the last step: $\\lvert p_{n+1} - p_{n} \\rvert \\le 10^{-8}$ and $\\lvert dp/dt \\rvert \\le 10^{-8}$.\n- Clip $p$ at each time step to the feasible interval $[0, 1 - h]$ to enforce biological feasibility.\n- Use $\\delta = 10^{-3}$ for the final recovery comparison at $h_{0}$.\n\nTest suite. For each parameter set below, run the entire hysteresis protocol described above, and return a boolean indicating whether $p^{*}$ is recovered after restoring $h$ to $h_{0}$. Each test case is a $7$-tuple $(c, e_{0}, a, r, h_{0}, h_{\\max}, \\Delta h)$:\n- Case $1$: $(1.0, 0.2, 0.0, 0.0, 0.0, 0.6, 0.01)$.\n- Case $2$: $(1.0, 0.2, 2.5, 0.85, 0.0, 0.7, 0.01)$.\n- Case $3$: $(0.3, 0.4, 1.0, 0.9, 0.0, 0.6, 0.01)$.\n- Case $4$: $(1.0, 0.2, 0.2, 0.9, 0.0, 0.6, 0.01)$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[ \\text{True}, \\text{False}, \\text{True} ]$) in the order of the test suite above, where each entry is the boolean answer to “Does restoring $h$ to $h_{0}$ recover the original $p^{*}$ within tolerance $\\delta$?”",
            "solution": "The problem statement is a valid scientific question grounded in the established principles of theoretical ecology, specifically metapopulation dynamics. It is well-posed, objective, and provides a complete, unambiguous specification for a numerical experiment. No logical contradictions, scientific inaccuracies, or undefined terms are present. We shall proceed with the solution.\n\nThe problem requires an analysis of hysteresis in a modified Levins metapopulation model. The dynamics of the patch occupancy fraction, $p$, are governed by the ordinary differential equation (ODE):\n$$\n\\frac{dp}{dt} = c \\, p \\, ((1 - h) - p) - e(h) \\, \\left( 1 - r \\, \\left(\\frac{p}{1 - h}\\right)^{2} \\right) \\, p\n$$\nHere, $p \\in [0, 1-h]$ is the fraction of occupied patches, $h \\in [0,1)$ is the fraction of destroyed habitat, $c  0$ is the intrinsic colonization rate, and $r \\in [0,1]$ is the strength of the rescue effect. The extinction rate, $e(h) = e_{0} \\, (1 + a \\, h)$, increases with habitat destruction, where $e_{0}  0$ is the baseline rate and $a \\ge 0$ modulates the impact of $h$.\n\nThe core of the problem lies in the system's equilibrium states, which are solutions to $\\frac{dp}{dt} = 0$. These are the states where colonization and extinction are in balance. The equation for equilibria is:\n$$\np \\left[ c \\, ((1 - h) - p) - e(h) \\, \\left( 1 - r \\, \\left(\\frac{p}{1 - h}\\right)^{2} \\right) \\right] = 0\n$$\nOne trivial equilibrium is always $p^{*} = 0$, representing total extinction of the metapopulation. Non-trivial equilibria ($p^{*}  0$) are found by solving the expression in the brackets:\n$$\nc \\, (1 - h) - c \\, p = e(h) - \\frac{e(h) \\, r}{(1 - h)^2} p^2\n$$\nRearranging this gives a quadratic equation for $p$:\n$$\n\\left( \\frac{e(h) \\, r}{(1 - h)^2} \\right) p^2 - c \\, p + (c(1 - h) - e(h)) = 0\n$$\nThis quadratic equation can have zero, one, or two real roots for $p$ that are physically meaningful (i.e., in the interval $(0, 1 - h]$). The total number of equilibria, including the trivial one, can thus be up to three. The existence of multiple stable equilibria for the same value of the parameter $h$ is the necessary condition for hysteresis. When the system is bistable, its state depends not only on the current parameters but also on its history. A slow change in a parameter like $h$ can cause the system to follow one stable branch until it disappears at a bifurcation point (a \"tipping point\"), forcing a sudden transition to another, distant stable branch. When the parameter change is reversed, the system may not return along the same path, instead following the new branch until a different bifurcation point is reached. This phenomenon is hysteresis.\n\nThe problem prescribes a precise numerical protocol to detect such hysteresis. This protocol involves three main steps:\n1.  **Baseline Equilibrium:** For an initial habitat destruction level $h_{0}$, the ODE is integrated starting from $p(0) = (1 - h_{0})/2$ until a stable equilibrium $p^{*}_{\\text{baseline}}(h_{0})$ is reached.\n2.  **Forward Ramp:** The parameter $h$ is increased quasi-statically from $h_{0}$ to $h_{\\max}$ in small steps of $\\Delta h$. At each step, the equilibrium is found by integrating the ODE, using the equilibrium from the previous step as the new initial condition. This traces the system's path as habitat is destroyed.\n3.  **Backward Ramp:** From $h_{\\max}$, the parameter $h$ is decreased back to $h_{0}$ in the same manner. This traces the path during habitat restoration.\n\nThe final equilibrium at the end of the backward ramp, $p^{*}_{\\text{return}}(h_{0})$, is compared to the original baseline, $p^{*}_{\\text{baseline}}(h_{0})$. If they are different (within a tolerance $\\delta = 10^{-3}$), it indicates that the system did not recover its original state and hysteresis has occurred.\n\nTo implement this protocol, we design a program with the following components:\n- A function for the ODE's right-hand side, $\\frac{dp}{dt}$, which takes $p$, $h$, and the model parameters $(c, e_{0}, a, r)$ as input.\n- A numerical integrator. The classical fourth-order Runge-Kutta (RK4) method with a fixed time step $\\Delta t = 0.1$ is employed. After each integration step, the value of $p$ is clipped to the valid range $[0, 1 - h]$ to ensure biological realism and numerical stability.\n- An equilibrium solver function. This function iteratively applies the RK4 step for a given $h$ value, starting from an initial $p$, until convergence criteria are met: the change in $p$ per step, $\\lvert p_{n+1} - p_{n} \\rvert$, and the magnitude of the derivative, $\\lvert dp/dt \\rvert$, must both be below a tolerance of $10^{-8}$. A maximum integration time of $T_{\\max} = 500$ is enforced.\n- A main routine that orchestrates the entire hysteresis protocol for each test case specified in the problem statement. This routine manages the forward and backward ramps of $h$ and performs the final comparison to determine if the metapopulation has recovered.\n\nThe final boolean result for each case indicates whether $| p^{*}_{\\text{return}}(h_{0}) - p^{*}_{\\text{baseline}}(h_{0}) | \\le 10^{-3}$, which is recorded as `True` for recovery and `False` for hysteresis.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the hysteresis protocol for all test cases.\n    \"\"\"\n    test_cases = [\n        # (c, e0, a, r, h0, h_max, delta_h)\n        (1.0, 0.2, 0.0, 0.0, 0.0, 0.6, 0.01),\n        (1.0, 0.2, 2.5, 0.85, 0.0, 0.7, 0.01),\n        (0.3, 0.4, 1.0, 0.9, 0.0, 0.6, 0.01),\n        (1.0, 0.2, 0.2, 0.9, 0.0, 0.6, 0.01),\n    ]\n\n    results = []\n    for case in test_cases:\n        is_recovered = _run_hysteresis_protocol(*case)\n        results.append(is_recovered)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _dp_dt(p, h, c, e0, a, r):\n    \"\"\"\n    Calculates the right-hand side of the metapopulation ODE.\n    dp/dt = f(p, h, params)\n    \"\"\"\n    if h = 1.0:\n        return 0.0  # No habitable patches\n\n    e_h = e0 * (1.0 + a * h)\n    \n    colonization = c * p * ((1.0 - h) - p)\n    \n    # Rescue effect term requires p to be non-negative and h  1\n    # Normalized occupancy x = p / (1 - h)\n    # The term (1 - r*x^2) can be negative, which is physically valid\n    # representing extinction acceleration at very high occupancy (e.g. Allee effects)\n    extinction = e_h * (1.0 - r * (p / (1.0 - h))**2) * p if (1.0 - h)  1e-9 else e_h * p\n\n    return colonization - extinction\n\ndef _rk4_step(p, h, dt, c, e0, a, r):\n    \"\"\"\n    Performs one step of the fourth-order Runge-Kutta method.\n    \"\"\"\n    k1 = _dp_dt(p, h, c, e0, a, r)\n    k2 = _dp_dt(p + 0.5 * dt * k1, h, c, e0, a, r)\n    k3 = _dp_dt(p + 0.5 * dt * k2, h, c, e0, a, r)\n    k4 = _dp_dt(p + dt * k3, h, c, e0, a, r)\n    p_next = p + (dt / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n    \n    # Clip to enforce biological feasibility [0, 1-h]\n    p_next = max(0.0, min(p_next, 1.0 - h))\n    return p_next\n\ndef _solve_to_equilibrium(p_initial, h, c, e0, a, r):\n    \"\"\"\n    Integrates the ODE at a fixed h until equilibrium is reached.\n    \"\"\"\n    dt = 0.1\n    T_max = 500.0\n    max_steps = int(T_max / dt)\n    conv_tol = 1e-8\n\n    p_n = p_initial\n    for _ in range(max_steps):\n        p_n_plus_1 = _rk4_step(p_n, h, dt, c, e0, a, r)\n        \n        # Check for convergence\n        dp_val = _dp_dt(p_n_plus_1, h, c, e0, a, r)\n        if abs(p_n_plus_1 - p_n) = conv_tol and abs(dp_val) = conv_tol:\n            return p_n_plus_1\n        \n        p_n = p_n_plus_1\n        \n    return p_n\n\ndef _run_hysteresis_protocol(c, e0, a, r, h0, h_max, delta_h):\n    \"\"\"\n    Executes the full numerical protocol for a single test case.\n    \"\"\"\n    recovery_tol = 1e-3\n\n    # 1. Determine baseline equilibrium at h0\n    p_initial_baseline = (1.0 - h0) / 2.0\n    p_baseline = _solve_to_equilibrium(p_initial_baseline, h0, c, e0, a, r)\n\n    p_current = p_baseline\n\n    # 2. Forward ramp: increase h from h0 to h_max\n    # Use np.arange which excludes the endpoint, so add a small fraction to include h_max\n    h_values_forward = np.arange(h0 + delta_h, h_max + delta_h / 2.0, delta_h)\n    for h in h_values_forward:\n        p_current = _solve_to_equilibrium(p_current, h, c, e0, a, r)\n\n    # 3. Backward ramp: decrease h from h_max to h0\n    # The last p_current from the forward ramp is the starting point for the backward ramp.\n    h_values_backward = np.arange(h_max - delta_h, h0 - delta_h / 2.0, -delta_h)\n    for h in h_values_backward:\n        p_current = _solve_to_equilibrium(p_current, h, c, e0, a, r)\n        \n    p_return = _solve_to_equilibrium(p_current, h0, c, e0, a, r)\n\n    # 4. Check for recovery\n    is_recovered = abs(p_return - p_baseline) = recovery_tol\n    \n    return is_recovered\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "A theoretical model's true power is realized when it can be connected to empirical data. This final practice bridges the gap between theory and observation by tackling the essential task of parameter estimation. Using a hypothetical dataset of patch transitions, you will derive and apply the method of maximum likelihood to estimate the Levins model's core parameters, the colonization rate $c$ and extinction rate $e$, a foundational skill for any quantitative ecologist or environmental modeler. ",
            "id": "2508415",
            "problem": "In the classical Levins metapopulation framework, a large collection of habitat patches is assumed to be identical and well-mixed, with local colonization and extinction operating as a continuous-time process. Let $c$ denote the colonization rate parameter and $e$ denote the extinction rate parameter. Over a short time interval of length $\\Delta t$, assume the fraction of occupied patches is approximately constant and equal to the value observed at the beginning of the interval.\n\nConsider a system with $N$ identical patches. At the beginning of each of $K$ consecutive intervals of equal length $\\Delta t$, you measure the number of occupied and empty patches and the fraction occupied, and you also record, over each interval, the counts of colonizations and extinctions (i.e., transitions $0 \\to 1$ and $1 \\to 0$). Assume that over each interval $k$, given the observed fraction occupied $p_k$ at the interval start, each empty patch experiences colonization as a memoryless event with constant hazard $c\\,p_k$, and each occupied patch experiences extinction as a memoryless event with constant hazard $e$. Assume independence of patches conditional on $(c,e)$ and the starting state of each patch, and assume $\\Delta t$ is sufficiently small that the probability of multiple transitions within a single patch over one interval is negligible.\n\nYou observe the following data for $K=4$ intervals, each of length $\\Delta t = 0.25$ years, from a system with $N=200$ patches:\n- Interval $k=1$: start occupied $N_{1,1}=90$, start empty $N_{0,1}=110$, fraction occupied $p_1=0.45$, observed colonizations $Y_{01,1}=12$, observed extinctions $Y_{10,1}=8$.\n- Interval $k=2$: start occupied $N_{1,2}=95$, start empty $N_{0,2}=105$, fraction occupied $p_2=0.475$, observed colonizations $Y_{01,2}=14$, observed extinctions $Y_{10,2}=9$.\n- Interval $k=3$: start occupied $N_{1,3}=100$, start empty $N_{0,3}=100$, fraction occupied $p_3=0.50$, observed colonizations $Y_{01,3}=16$, observed extinctions $Y_{10,3}=10$.\n- Interval $k=4$: start occupied $N_{1,4}=98$, start empty $N_{0,4}=102$, fraction occupied $p_4=0.49$, observed colonizations $Y_{01,4}=15$, observed extinctions $Y_{10,4}=10$.\n\nStarting from the definitions of continuous-time hazard and the independence of patch histories, and without invoking any pre-derived estimation formulas, derive the maximum likelihood estimators for $c$ and $e$ under the rare-event limit appropriate for small $\\Delta t$ and large $N$. Then evaluate these estimators for the data above. Express your final numerical answers for $c$ and $e$ in units of per year, and round each to four significant figures. Provide your final answer as a single row vector $\\left(c\\ \\ e\\right)$.",
            "solution": "The problem is scientifically grounded, well-posed, and self-contained. The data provided is internally consistent. I will proceed to derive the maximum likelihood estimators for the colonization rate parameter $c$ and the extinction rate parameter $e$ from first principles, as stipulated.\n\nThe model assumes that patch dynamics follow a continuous-time Markov process. The state of a patch is either empty ($0$) or occupied ($1$).\n\nFor a single empty patch during interval $k$, the colonization process is memoryless with a constant hazard rate $\\lambda_{c,k} = c p_k$, where $p_k$ is the fraction of occupied patches at the start of interval $k$. The probability that this patch becomes colonized during a time interval of length $\\Delta t$ is given by:\n$$ P(\\text{colonization in } \\Delta t) = 1 - \\exp(-\\lambda_{c,k} \\Delta t) = 1 - \\exp(-c p_k \\Delta t) $$\nFor a single occupied patch, the extinction process is memoryless with a constant hazard rate $\\lambda_e = e$. The probability that this patch goes extinct during $\\Delta t$ is:\n$$ P(\\text{extinction in } \\Delta t) = 1 - \\exp(-\\lambda_e \\Delta t) = 1 - \\exp(-e \\Delta t) $$\nThe problem states that $\\Delta t$ is sufficiently small and $N$ is large, which corresponds to the \"rare-event limit.\" In this limit, the number of events (colonizations or extinctions) occurring in a large population of independent patches can be modeled as a Poisson process. The total number of colonizations, $Y_{01,k}$, among the $N_{0,k}$ initially empty patches in interval $k$ is a random variable following a Poisson distribution with mean $\\Lambda_{c,k}$:\n$$ \\Lambda_{c,k} = N_{0,k} \\times P(\\text{colonization in } \\Delta t) = N_{0,k} \\left[1 - \\exp(-c p_k \\Delta t)\\right] $$\nSimilarly, the total number of extinctions, $Y_{10,k}$, among the $N_{1,k}$ initially occupied patches in interval $k$ follows a Poisson distribution with mean $\\Lambda_{e,k}$:\n$$ \\Lambda_{e,k} = N_{1,k} \\times P(\\text{extinction in } \\Delta t) = N_{1,k} \\left[1 - \\exp(-e \\Delta t)\\right] $$\nThe small $\\Delta t$ assumption allows for the Taylor series approximation $1 - \\exp(-x) \\approx x$ for small $x$. Applying this, the means of the Poisson distributions become:\n$$ \\Lambda_{c,k} \\approx N_{0,k} (c p_k \\Delta t) $$\n$$ \\Lambda_{e,k} \\approx N_{1,k} (e \\Delta t) $$\nThe probability mass function for a Poisson random variable $Y$ with mean $\\Lambda$ is $P(Y=y) = \\frac{\\Lambda^y e^{-\\Lambda}}{y!}$.\nThe observations of colonizations and extinctions across the $K=4$ intervals are independent. Therefore, the total likelihood function $L(c, e)$ is the product of the probabilities of observing the data $(Y_{01,k}, Y_{10,k})$ for each interval $k=1, \\dots, K$.\n$$ L(c, e) = \\prod_{k=1}^{K} P(Y_{01,k}=y_{01,k} | c) \\times P(Y_{10,k}=y_{10,k} | e) $$\n$$ L(c, e) = \\prod_{k=1}^{K} \\left[ \\frac{(N_{0,k} c p_k \\Delta t)^{Y_{01,k}}}{Y_{01,k}!} \\exp(-N_{0,k} c p_k \\Delta t) \\right] \\times \\left[ \\frac{(N_{1,k} e \\Delta t)^{Y_{10,k}}}{Y_{10,k}!} \\exp(-N_{1,k} e \\Delta t) \\right] $$\nTo find the maximum likelihood estimators (MLEs), we maximize the log-likelihood function $\\ell(c, e) = \\ln L(c, e)$.\n$$ \\ell(c, e) = \\sum_{k=1}^{K} \\left[ Y_{01,k} \\ln(N_{0,k} c p_k \\Delta t) - \\ln(Y_{01,k}!) - N_{0,k} c p_k \\Delta t \\right] + \\sum_{k=1}^{K} \\left[ Y_{10,k} \\ln(N_{1,k} e \\Delta t) - \\ln(Y_{10,k}!) - N_{1,k} e \\Delta t \\right] $$\nThe log-likelihood function separates into two independent parts: one dependent on $c$, $\\ell_c(c)$, and one dependent on $e$, $\\ell_e(e)$.\n$$ \\ell_c(c) = \\sum_{k=1}^{K} \\left[ Y_{01,k} (\\ln(c) + \\ln(N_{0,k} p_k \\Delta t)) - N_{0,k} c p_k \\Delta t \\right] - \\sum_{k=1}^{K}\\ln(Y_{01,k}!) $$\n$$ \\ell_e(e) = \\sum_{k=1}^{K} \\left[ Y_{10,k} (\\ln(e) + \\ln(N_{1,k} \\Delta t)) - N_{1,k} e \\Delta t \\right] - \\sum_{k=1}^{K}\\ln(Y_{10,k}!) $$\nTo find the MLE $\\hat{c}$, we differentiate $\\ell_c(c)$ with respect to $c$ and set the derivative to zero.\n$$ \\frac{\\partial \\ell_c}{\\partial c} = \\sum_{k=1}^{K} \\left[ \\frac{Y_{01,k}}{c} - N_{0,k} p_k \\Delta t \\right] = 0 $$\n$$ \\frac{1}{c} \\sum_{k=1}^{K} Y_{01,k} = \\Delta t \\sum_{k=1}^{K} N_{0,k} p_k $$\nSolving for $c$ gives the MLE $\\hat{c}$:\n$$ \\hat{c} = \\frac{\\sum_{k=1}^{K} Y_{01,k}}{\\Delta t \\sum_{k=1}^{K} N_{0,k} p_k} $$\nSimilarly, for the MLE $\\hat{e}$, we differentiate $\\ell_e(e)$ with respect to $e$ and set the derivative to zero.\n$$ \\frac{\\partial \\ell_e}{\\partial e} = \\sum_{k=1}^{K} \\left[ \\frac{Y_{10,k}}{e} - N_{1,k} \\Delta t \\right] = 0 $$\n$$ \\frac{1}{e} \\sum_{k=1}^{K} Y_{10,k} = \\Delta t \\sum_{k=1}^{K} N_{1,k} $$\nSolving for $e$ gives the MLE $\\hat{e}$:\n$$ \\hat{e} = \\frac{\\sum_{k=1}^{K} Y_{10,k}}{\\Delta t \\sum_{k=1}^{K} N_{1,k}} $$\nNow, we evaluate these estimators using the provided data. We are given $\\Delta t = 0.25$ years.\n\nFirst, for $\\hat{c}$:\nThe total number of observed colonizations is:\n$$ \\sum_{k=1}^{4} Y_{01,k} = 12 + 14 + 16 + 15 = 57 $$\nThe denominator term requires computing the sum of products $N_{0,k} p_k$:\n$$ \\sum_{k=1}^{4} N_{0,k} p_k = (110 \\times 0.45) + (105 \\times 0.475) + (100 \\times 0.50) + (102 \\times 0.49) $$\n$$ \\sum_{k=1}^{4} N_{0,k} p_k = 49.5 + 49.875 + 50.0 + 49.98 = 199.355 $$\nSubstituting these values into the estimator for $c$:\n$$ \\hat{c} = \\frac{57}{0.25 \\times 199.355} = \\frac{57}{49.83875} \\approx 1.143763 $$\nRounding to four significant figures, $\\hat{c} \\approx 1.144$ per year.\n\nNext, for $\\hat{e}$:\nThe total number of observed extinctions is:\n$$ \\sum_{k=1}^{4} Y_{10,k} = 8 + 9 + 10 + 10 = 37 $$\nThe total number of occupied patch-intervals is:\n$$ \\sum_{k=1}^{4} N_{1,k} = 90 + 95 + 100 + 98 = 383 $$\nSubstituting these values into the estimator for $e$:\n$$ \\hat{e} = \\frac{37}{0.25 \\times 383} = \\frac{37}{95.75} \\approx 0.3864229 $$\nRounding to four significant figures, $\\hat{e} \\approx 0.3864$ per year.\n\nThe derived estimators represent the ratio of the total number of events to the total exposure, where exposure is defined appropriately for each process. This is a logical and standard result for rate estimation under these modeling assumptions.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.144  0.3864 \\end{pmatrix}}$$"
        }
    ]
}