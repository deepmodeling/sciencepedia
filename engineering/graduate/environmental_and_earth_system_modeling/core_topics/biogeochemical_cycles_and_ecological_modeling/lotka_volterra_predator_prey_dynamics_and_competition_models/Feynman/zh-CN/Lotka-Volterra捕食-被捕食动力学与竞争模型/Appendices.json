{
    "hands_on_practices": [
        {
            "introduction": "经典的Lotka-Volterra模型是一个有用的起点，但真实的生态系统更为复杂。本练习引入了两个至关重要的现实修正：代表资源限制的猎物逻辑斯谛增长，以及捕食者种内的竞争。寻找平衡点是分析任何动力系统的基本步骤，因为它们代表了种群数量不再变化的稳定状态。通过求解共存平衡点，您将练习分析更复杂、更现实的生态模型所需的代数技巧。",
            "id": "1067561",
            "problem": "Lotka-Volterra模型是数学生物学中的一个基础模型，用于描述捕食者-猎物相互作用的动态过程。一个更现实的扩展，称为Gause型模型，它为猎物引入了逻辑斯谛增长，并可进一步改进以包含捕食者间的种内竞争。\n\n考虑一个捕食者-猎物系统，其猎物种群为 $x(t)$，捕食者种群为 $y(t)$，由以下耦合微分方程组控制：\n$$\n\\frac{dx}{dt} = \\alpha x \\left(1 - \\frac{x}{K}\\right) - \\beta xy\n$$\n$$\n\\frac{dy}{dt} = \\delta xy - \\gamma y - \\eta y^2\n$$\n\n这里，所有参数均为正实数：\n- $\\alpha$：猎物的内禀增长率。\n- $K$：在没有捕食者的情况下，猎物的环境承载力。\n- $\\beta$：代表捕食率的参数。\n- $\\delta$：将消耗的猎物转化为新捕食者的效率。\n- $\\gamma$：捕食者的内禀死亡率。\n- $\\eta$：代表捕食者之间种内竞争强度的参数，使其增长呈逻辑斯谛形式。\n\n该系统拥有若干个平衡点，在这些点上两个种群的变化率均为零。其中一个点，“共存平衡点”$(x^*, y^*)$，对应于猎物和捕食者种群均为正的稳态。\n\n推导此共存平衡点下平衡猎物种群 $x^*$ 的表达式。",
            "solution": "1. 在平衡状态下，$\\frac{dx}{dt}=0$ 且 $\\frac{dy}{dt}=0$。方程组为\n$$\n\\frac{dx}{dt}=\\alpha x\\Bigl(1-\\frac{x}{K}\\Bigr)-\\beta x y=0,\n\\quad\n\\frac{dy}{dt}=\\delta x y-\\gamma y-\\eta y^2=0.\n$$\n2. 对于 $x^*>0, y^*>0$ 的共存平衡点 $(x^*,y^*)$，消去公因子：\n   由 $\\frac{dx}{dt}=0$ 得：\n   $$\\alpha\\Bigl(1-\\frac{x^*}{K}\\Bigr)-\\beta y^*=0\n   \\;\\implies\\;\n   y^*=\\frac{\\alpha}{\\beta}\\Bigl(1-\\frac{x^*}{K}\\Bigr)。$$\n   由 $\\frac{dy}{dt}=0$ 得：\n   $$\\delta x^*-\\gamma-\\eta y^*=0\n   \\;\\implies\\;\n   y^*=\\frac{\\delta x^*-\\gamma}{\\eta}。$$\n3. 令两个关于 $y^*$ 的表达式相等：\n$$\n\\frac{\\alpha}{\\beta}\\Bigl(1-\\frac{x^*}{K}\\Bigr)\n=\\frac{\\delta x^*-\\gamma}{\\eta}。\n$$\n4. 两边乘以 $\\beta\\eta$ 并重新整理：\n$$\n\\alpha\\eta\\Bigl(1-\\frac{x^*}{K}\\Bigr)\n=\\beta(\\delta x^*-\\gamma)\n\\;\\implies\\;\n\\alpha\\eta+\\beta\\gamma\n=x^*\\Bigl(\\frac{\\alpha\\eta}{K}+\\beta\\delta\\Bigr)。\n$$\n5. 解出 $x^*$：\n$$\nx^*=\\frac{\\alpha\\eta+\\beta\\gamma}{\\tfrac{\\alpha\\eta}{K}+\\beta\\delta}\n=\\frac{K(\\alpha\\eta+\\beta\\gamma)}{\\alpha\\eta+\\beta\\delta K}。\n$$",
            "answer": "$$\\boxed{\\frac{K(\\alpha\\eta+\\beta\\gamma)}{\\alpha\\eta+\\beta\\delta K}}$$"
        },
        {
            "introduction": "捕食-猎物模型中的相互作用项，即功能性反应，是模型的关键组成部分，通常必须通过经验数据来确定。本练习将指导您完成从实验数据中推导和拟合两种最常见的功能性反应模型的过程。这个练习展示了理论模型推导（源于时间预算等第一性原理）与统计推断（使用非线性最小二乘法和AIC等模型选择标准）之间的联系，这是一个连接理论与应用的核心建模工作流程。",
            "id": "3889896",
            "problem": "考虑一个实验室实验，其中单个捕食者暴露在不同密度的猎物中，并记录单位时间内每个捕食者消耗的猎物数量。在捕食者-猎物理论中，功能性反应量化了单个捕食者的消耗率如何依赖于猎物密度。您的任务是根据第一性原理推导、实现和拟合两种竞争的功能性反应模型，然后进行模型选择。\n\n从以下基本假设开始：\n\n- 捕食者与猎物之间的相遇发生为泊松过程，其相遇强度与猎物密度成正比。如果猎物密度为 $N$（单位：每个实验区域内的个体数），比例常数为 $a$（相遇系数，单位：每小时），那么单位时间内搜索期间的预期相遇次数与 $a N$ 成正比。\n- 每个被捕获的猎物需要固定的处理时间 $h$（单位：小时/猎物），这构成了时间预算约束：处理时间会占用搜索时间。\n- 在第一个模型中，假设在所有密度下，搜索率都与 $N$ 成正比，这与恒定的搜索效率以及没有学习或转换行为相一致。\n- 在第二个模型中，假设在低密度下存在一个加速的相遇机制，这与学习或转换行为相一致，使得有效相遇强度在低 $N$ 值时增长超过线性，但由于处理时间的限制，最终仍会饱和。\n\n根据这些假设，为两种模型推导单个捕食者的预期消耗率 $r(N)$（单位：猎物/捕食者/小时）作为 $N$、相遇系数 $a$ 和处理时间 $h$ 的函数表达式：\n\n- 模型 $M_2$（将作为“II 型”功能性反应的候选模型进行测试）。\n- 模型 $M_3$（将作为在低猎物密度下具有加速效应的“III 型”功能性反应的候选模型进行测试）。\n\n假设对 $r(N)$ 的观测存在独立的、方差未知的高斯测量误差，并使用非线性最小二乘法为每个模型估计参数 $a$ 和 $h$。为了进行模型比较，请在高斯误差假设下使用赤池信息准则（Akaike Information Criterion, AIC）。令残差平方和为 $\\mathrm{SSR} = \\sum_{i=1}^{n} \\left( r_i - r(N_i; a, h) \\right)^2$，其中 $n$ 是观测次数，$k$ 是自由参数的数量。使用\n$$\n\\mathrm{AIC} = n \\ln\\left(\\frac{\\mathrm{SSR}}{n}\\right) + 2 k,\n$$\n该公式适用于当误差方差未知并通过 $\\mathrm{SSR}/n$ 隐式估计时比较模型。选择具有较低 $\\mathrm{AIC}$ 值的模型。\n\n物理单位：猎物密度 $N$ 是一个计数（无量纲），时间单位为小时，消耗率 $r$ 的单位必须是 猎物/捕食者/小时。将每个数据集最终选择的模型报告为一个整数：如果 $M_2$ 的 $\\mathrm{AIC}$ 较低，则输出 $2$；如果 $M_3$ 的 $\\mathrm{AIC}$ 较低，则输出 $3$。\n\n测试套件：将两个模型拟合到以下四个数据集中的每一个。每个数据集提供猎物密度 $N$ 和观测到的消耗率 $r$（单位：猎物/捕食者/小时）。这些数据在科学上是合理的，并且与假设内部一致。\n\n- 数据集 $1$（中度饱和，无明显的低密度加速）：$N = [1,2,4,8,16,32,64]$，$r = [0.49,0.81,1.22,1.64,1.98,2.21,2.35]$。\n- 数据集 $2$（明显的低密度加速并伴有饱和）：$N = [1,2,4,8,16,32,64]$，$r = [0.076,0.261,0.675,1.117,1.336,1.404,1.423]$。\n- 数据集 $3$（包含零密度，在低 $N$ 值时有显著加速）：$N = [0,1,2,3,4,5]$，$r = [0.0,0.22,0.49,0.64,0.71,0.75]$。\n- 数据集 $4$（由于处理时间非常短而呈现近线性区间）：$N = [5,10,20,40]$，$r = [0.25,0.495,0.98,1.92]$。\n\n算法要求：\n\n- 对于每个数据集，使用有界非线性最小二乘算法，通过最小化 $\\mathrm{SSR}$ 来为两个模型估计参数 $(a, h)$，边界条件为 $a \\in (0, 10]$，$h \\in (0, 10]$。\n- 使用科学上合理的初始猜测值；算法应对不同数据集之间的差异具有鲁棒性。\n\n角度单位不适用。不得使用百分比；所有量都应表示为小数或分数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须包含四个整数，每个整数对应上面呈现顺序的一个数据集。例如，如果选择的模型是 $M_3$、$M_3$、$M_2$、$M_2$，输出应为 $[3,3,2,2]$。您的程序必须只打印这一行，不能有其他任何内容。",
            "solution": "用户希望我解决一个关于捕食者-猎物功能性反应的问题。我将首先验证该问题，如果问题有效，则继续进行解答。\n\n### 步骤 1：提取给定信息\n- **任务**：推导、实现、拟合和比较两种功能性反应模型，$M_2$ 和 $M_3$。\n- **假设**：\n    1. 捕食者与猎物之间的相遇遵循泊松过程。\n    2. 相遇强度与猎物密度 $N$ 成正比。比例常数为 $a$（相遇系数，单位：每小时）。\n    3. 每个被捕获的猎物需要固定的处理时间 $h$（单位：小时/猎物）。\n    4. 处理时间占用搜索时间（时间预算约束）。\n- **模型 $M_2$（II 型）假设**：在所有密度下，搜索率都与 $N$ 成正比。\n- **模型 $M_3$（III 型）假设**：在低密度下，有效相遇强度的增长超过与 $N$ 的线性关系。\n- **目标**：为两种模型推导单个捕食者的消耗率 $r(N)$ 作为 $N$、$a$ 和 $h$ 的函数表达式。\n- **统计方法**：\n    1. **拟合**：使用非线性最小二乘法，通过最小化残差平方和 $\\mathrm{SSR} = \\sum_{i=1}^{n} \\left( r_i - r(N_i; a, h) \\right)^2$ 来估计参数 $a$ 和 $h$。\n    2. **模型选择**：使用赤池信息准则 $\\mathrm{AIC} = n \\ln\\left(\\frac{\\mathrm{SSR}}{n}\\right) + 2 k$，其中 $k$ 是自由参数的数量。选择具有较低 AIC 的模型。\n- **参数约束**：$a \\in (0, 10]$ 和 $h \\in (0, 10]$。\n- **输出**：对于每个数据集，如果选择 $M_2$，则报告 $2$；如果选择 $M_3$，则报告 $3$。最终输出是包含四个整数的单行列表。\n- **数据集**：\n    - 数据集 $1$：$N = [1,2,4,8,16,32,64]$，$r = [0.49,0.81,1.22,1.64,1.98,2.21,2.35]$。\n    - 数据集 $2$：$N = [1,2,4,8,16,32,64]$，$r = [0.076,0.261,0.675,1.117,1.336,1.404,1.423]$。\n    - 数据集 $3$：$N = [0,1,2,3,4,5]$，$r = [0.0,0.22,0.49,0.64,0.71,0.75]$。\n    - 数据集 $4$：$N = [5,10,20,40]$，$r = [0.25,0.495,0.98,1.92]$。\n\n### 步骤 2：使用提取的给定信息进行验证\n1.  **科学依据**：该问题围绕 Lotka-Volterra 捕食者-猎物动态，特别是功能性反应部分，这是现代生态学的基石。从第一性原理（“圆盘方程”逻辑）的推导是一个经典练习。所用模型（II 型和 III 型）是标准且广泛使用的。这些假设在科学上是合理的。\n2.  **适定性**：该问题是适定的。它要求使用明确定义的统计标准，对拟合到给定数据集的两个特定模型进行比较。预期会得到一个唯一的解（一系列模型选择）。\n3.  **客观性**：该问题以精确、客观的语言陈述。提供了数据，并明确定义了数学和统计程序。没有主观性。\n4.  **未发现缺陷**：该问题不违反任何无效性标准。这是一个标准但全面的科学建模问题。它是完整的、一致的并且在科学上是合理的。\n\n### 步骤 3：结论与行动\n该问题有效。我将继续进行解答。\n\n任务是推导和比较两种用于描述捕食者消耗率的功能性反应模型，分别指定为 $M_2$ 和 $M_3$。两种模型的推导都源于一个时间预算约束。设 $T$ 为捕食者可用的总时间，该时间被划分为搜索时间 $T_s$ 和处理时间 $T_h$。\n\n$$T = T_s + T_h$$\n\n在时间 $T$ 内吃掉的猎物数量 $N_e$ 是消耗率 $r(N)$ 与总时间的乘积：$N_e = r(N)T$。总处理时间是被吃掉的猎物数量乘以每个猎物的处理时间 $h$：$T_h = N_e h = r(N)Th$。将此代入时间预算方程并求解 $T_s$ 可得：\n\n$$T_s = T - T_h = T - r(N)Th = T(1 - r(N)h)$$\n\n被吃掉的猎物数量 $N_e$ 也是搜索期间相遇的结果。它是搜索时间 $T_s$ 和我们记为 $f(N)$ 的瞬时相遇率的乘积。\n\n$$N_e = f(N) T_s$$\n\n结合 $N_e$ 和 $T_s$ 的表达式：\n\n$$r(N)T = f(N) [T(1 - r(N)h)]$$\n\n总时间 $T$ 被消去，我们可以解出 $r(N)$：\n\n$$r(N) = f(N) (1 - r(N)h)$$\n$$r(N) = f(N) - f(N)r(N)h$$\n$$r(N) (1 + f(N)h) = f(N)$$\n$$r(N) = \\frac{f(N)}{1 + f(N)h}$$\n\n这个通用公式被称为 Holling 的圆盘方程，构成了两种模型的基础。这两种模型的区别仅在于它们对瞬时相遇率 $f(N)$ 形式的假设不同。\n\n**模型 $M_2$（II 型功能性反应）的推导**\n对于这个模型，假设相遇率与猎物密度 $N$ 成正比。比例常数是相遇系数 $a$。\n$$f(N) = aN$$\n将此代入 $r(N)$ 的通用公式，得到 II 型功能性反应：\n$$r(N) = \\frac{aN}{1 + aNh}$$\n该函数随 $N$ 的增加而增加，但增速递减，当 $N \\rightarrow \\infty$ 时，渐近地趋向于最大消耗率 $1/h$，该最大值受处理时间 $h$ 的限制。参数 $a$ 代表攻击率或搜索效率，单位为 $1/\\text{时间}$。\n\n**模型 $M_3$（III 型功能性反应）的推导**\n对于这个模型，假设相遇率在低密度下是猎物密度的加速函数。这通常用于模拟捕食者学习或猎物转换等效应。能够捕捉这种加速效应并遵守问题约束（仅使用参数 $a$ 和 $h$）的最简单的 $f(N)$ 函数形式是二次关系：\n$$f(N) = aN^2$$\n将此代入 $r(N)$ 的通用公式，得到 S 型的 III 型功能性反应：\n$$r(N) = \\frac{aN^2}{1 + aN^2h}$$\n该函数有一个初始加速阶段（即单个猎物的消耗率 $r(N)/N$ 在低 $N$ 值时随 $N$ 增加而增加），然后减速并在相同的最大速率 $1/h$ 处饱和。需要注意的是，此模型中的参数 $a$ 与模型 $M_2$ 中的 $a$ 相比，具有不同的单位和解释（单位为 $1/(\\text{猎物} \\cdot \\text{时间})$）。\n\n**模型拟合与选择**\n对于每个数据集，我们必须为两个模型估计参数 $(a, h)$。这是通过使用有界非线性最小二乘算法，找到使残差平方和（SSR）最小化的参数值来实现的：\n$$\\mathrm{SSR} = \\sum_{i=1}^{n} (r_i - r(N_i; a, h))^2$$\n其中 $(N_i, r_i)$ 是观测数据点，$n$ 是观测次数。该优化受边界 $a \\in (0, 10]$ 和 $h \\in (0, 10]$ 的约束。\n\n拟合后，按照规定使用赤池信息准则（AIC）对两个模型进行比较：\n$$\\mathrm{AIC} = n \\ln\\left(\\frac{\\mathrm{SSR}}{n}\\right) + 2k$$\n对于 $M_2$ 和 $M_3$，估计的参数数量均为 $k=2$（对应 $a$ 和 $h$）。产生较低 AIC 值的模型被认为是更适合给定数据的模型，它平衡了拟合优度和模型复杂性。对四个数据集中的每一个重复此过程，并记录所选模型（$2$ 或 $3$）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\n# --- Model Definitions ---\n\ndef model_M2(N, a, h):\n    \"\"\"\n    Type II functional response model.\n    r(N) = a*N / (1 + a*N*h)\n    \"\"\"\n    N = np.asarray(N)\n    # To prevent division by zero or NaN if a=0 or h=0, though bounds should prevent this.\n    denominator = 1.0 + a * N * h\n    return (a * N) / denominator\n\ndef model_M3(N, a, h):\n    \"\"\"\n    Type III functional response model.\n    r(N) = a*N^2 / (1 + a*N^2*h)\n    \"\"\"\n    N = np.asarray(N)\n    N_squared = N**2\n    denominator = 1.0 + a * N_squared * h\n    return (a * N_squared) / denominator\n\n# --- Fitting and Selection ---\n\ndef calculate_ssr(params, model_func, N_data, r_data):\n    \"\"\"Calculates the Sum of Squared Residuals (SSR).\"\"\"\n    a, h = params\n    r_predicted = model_func(N_data, a, h)\n    residuals = r_predicted - r_data\n    return np.sum(residuals**2)\n\ndef fit_and_select_model(N_data, r_data):\n    \"\"\"\n    Fits both M2 and M3 to the data, calculates AIC, and selects the best model.\n    \"\"\"\n    # Convert data to numpy arrays\n    N_data = np.array(N_data, dtype=float)\n    r_data = np.array(r_data, dtype=float)\n\n    # Number of observations\n    n = len(N_data)\n    # Number of parameters\n    k = 2\n\n    # --- Parameter Estimation using Bounded Nonlinear Least Squares ---\n\n    # Common settings for the optimizer\n    # Initial guess for (a, h)\n    p0 = [0.5, 0.5]\n    # Bounds: a in (0, 10], h in (0, 10]. Use small positive for lower bound.\n    bounds = ([1e-9, 1e-9], [10.0, 10.0])\n\n    # Residual functions for least_squares\n    def residuals_M2(params, N, r):\n        return model_M2(N, params[0], params[1]) - r\n\n    def residuals_M3(params, N, r):\n        return model_M3(N, params[0], params[1]) - r\n\n    # Fit Model M2\n    res_M2 = least_squares(residuals_M2, p0, args=(N_data, r_data), bounds=bounds)\n    ssr_M2 = np.sum(res_M2.fun**2)\n\n    # Fit Model M3\n    res_M3 = least_squares(residuals_M3, p0, args=(N_data, r_data), bounds=bounds)\n    ssr_M3 = np.sum(res_M3.fun**2)\n\n    # --- Model Selection using AIC ---\n    # AIC = n * ln(SSR/n) + 2k\n    \n    # Check for SSR=0 to avoid log(0)\n    aic_M2 = np.inf\n    if ssr_M2 > 0:\n        aic_M2 = n * np.log(ssr_M2 / n) + 2 * k\n\n    aic_M3 = np.inf\n    if ssr_M3 > 0:\n        aic_M3 = n * np.log(ssr_M3 / n) + 2 * k\n\n    # Select the model with the lower AIC\n    if aic_M2 < aic_M3:\n        return 2\n    else:\n        return 3\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset 1\n        {'N': [1, 2, 4, 8, 16, 32, 64], 'r': [0.49, 0.81, 1.22, 1.64, 1.98, 2.21, 2.35]},\n        # Dataset 2\n        {'N': [1, 2, 4, 8, 16, 32, 64], 'r': [0.076, 0.261, 0.675, 1.117, 1.336, 1.404, 1.423]},\n        # Dataset 3\n        {'N': [0, 1, 2, 3, 4, 5], 'r': [0.0, 0.22, 0.49, 0.64, 0.71, 0.75]},\n        # Dataset 4\n        {'N': [5, 10, 20, 40], 'r': [0.25, 0.495, 0.98, 1.92]},\n    ]\n\n    results = []\n    for case in test_cases:\n        N_data = case['N']\n        r_data = case['r']\n        chosen_model = fit_and_select_model(N_data, r_data)\n        results.append(chosen_model)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一旦模型被构建且其参数被估计，下一步通常是模拟其随时间演变的行为。然而，数值方法的选择会极大地影响结果，特别是对于像Lotka-Volterra这样具有守恒量的系统。本问题探讨了“几何数值积分”的概念，将一种简单（但有缺陷）的方法（如显式欧拉法）与更好地尊重系统内在结构的结构保持方法（如辛积分或保能量积分）进行对比。理解这些数值问题对于生成可靠的长期模拟、避免产生由方法而非模型本身带来的伪影至关重要。",
            "id": "3889871",
            "problem": "考虑环境与地球系统建模中的经典洛特卡－沃尔泰拉（Lotka–Volterra）捕食者-猎物系统，\n$$\n\\frac{dx}{dt} = a x - b x y,\\qquad \\frac{dy}{dt} = -c y + d x y,\n$$\n参数 $a>0$, $b>0$, $c>0$ 和 $d>0$，其中 $x(t)>0$ 表示猎物密度，$y(t)>0$ 表示捕食者密度。已知共存平衡点 $(x^\\ast,y^\\ast) = \\left(\\frac{c}{d},\\,\\frac{a}{b}\\right)$ 是一个非线性中心，被一个光滑首次积分 $H(x,y)$ 的闭合水平集所包围，并且该向量场可以写成哈密顿形式，其斜对称结构矩阵为 $S(x,y)$，使得对于 $z=(x,y)$ 和 $S(z)^\\top = -S(z)$，有 $\\dot{z} = S(z)\\nabla H(z)$。设 $h>0$ 为固定时间步长。应用于该系统的显式欧拉法为\n$$\nx_{n+1} = x_n + h\\,(a x_n - b x_n y_n),\\qquad y_{n+1} = y_n + h\\,(-c y_n + d x_n y_n),\n$$\n而隐式中点法为\n$$\nx_{n+1} = x_n + h\\left(a \\frac{x_n + x_{n+1}}{2} - b \\frac{x_n + x_{n+1}}{2}\\,\\frac{y_n + y_{n+1}}{2}\\right),\n$$\n$$\ny_{n+1} = y_n + h\\left(-c \\frac{y_n + y_{n+1}}{2} + d \\frac{x_n + x_{n+1}}{2}\\,\\frac{y_n + y_{n+1}}{2}\\right).\n$$\n对于具有斜对称结构 $S(z)$ 的哈密顿系统，一种保能量的离散梯度法或平均向量场（AVF）法定义为\n$$\nz_{n+1} = z_n + h\\int_0^1 S\\big(z_n + s(z_{n+1}-z_n)\\big)\\,\\nabla H\\big(z_n + s(z_{n+1}-z_n)\\big)\\,ds,\n$$\n根据其构造，该方法满足 $H(z_{n+1}) = H(z_n)$。\n\n利用在 $(x^\\ast,y^\\ast)$ 附近线性化的第一性原理、哈密顿流的性质以及数值积分子的一致性，判断下列哪些陈述是正确的。选择所有适用项。\n\nA. 对于足够小的 $h$，显式欧拉法精确地保持首次积分 $H(x,y)$，并在 $(x^\\ast,y^\\ast)$ 周围产生没有长期漂移的数值闭合轨道。\n\nB. 在 $(x^\\ast,y^\\ast)$ 处，显式欧拉更新的线性化具有形式为 $1 \\pm i h \\omega$（其中 $\\omega>0$）的特征值，其模严格大于 $1$，这意味着存在伪外旋线。此外，$H$ 的泰勒展开表明 $H(x_{n+1},y_{n+1}) - H(x_n,y_n)$ 是 $O(h^2)$ 阶的，并且主项为正，而 AVF/离散梯度法能精确保持 $H$ 恒定，并将轨迹限制在单个水平集上。\n\nC. 应用于 $(x^\\ast,y^\\ast)$ 处的线性化时，隐式中点法的单步放大矩阵的特征值位于单位圆上，因此避免了振幅的数值增长或衰减；尽管对于非线性的洛特卡－沃尔泰拉系统，它不完全守恒 $H(x,y)$，但其辛结构确保了 $H$ 的误差有界，并且在长时间内没有系统性漂移。\n\nD. 因为对于连续向量场 $f$，有 $\\nabla H(x,y)\\cdot f(x,y) = 0$，所以任何一致的一阶方法，包括显式欧拉法，在长时间积分中都能在全局上以 $O(h^2)$ 的阶保持 $H$，因此不会引入跨越水平集的长期漂移。\n\nE. 由显式欧拉法在 $(x^\\ast,y^\\ast)$ 附近产生的伪螺旋现象完全是由浮点舍入误差引起的；在精确计算中，显式欧拉法将遵守首次积分，并对所有 $h$ 产生闭合的数值轨道。",
            "solution": "问题要求分析几种数值方法应用于洛特卡－沃尔泰拉捕食者-猎物系统时的行为。分析将首先围绕其共存平衡点对系统进行线性化，然后检验每个数值积分子的性质。\n\n洛特卡－沃尔泰拉系统由以下方程给出：\n$$\n\\frac{dx}{dt} = a x - b x y = f(x,y)\n$$\n$$\n\\frac{dy}{dt} = -c y + d x y = g(x,y)\n$$\n参数 $a, b, c, d$ 均为正。共存平衡点为 $(x^\\ast, y^\\ast) = \\left(\\frac{c}{d}, \\frac{a}{b}\\right)$。\n\n首先，我们围绕此平衡点对系统进行线性化。向量场的雅可比矩阵是：\n$$\nJ(x,y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x} & \\frac{\\partial f}{\\partial y} \\\\ \\frac{\\partial g}{\\partial x} & \\frac{\\partial g}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} a - by & -bx \\\\ dy & -c + dx \\end{pmatrix}\n$$\n在平衡点 $(x^\\ast, y^\\ast)$ 处计算雅可比矩阵：\n$$\nJ(x^\\ast, y^\\ast) = \\begin{pmatrix} a - b\\left(\\frac{a}{b}\\right) & -b\\left(\\frac{c}{d}\\right) \\\\ d\\left(\\frac{a}{b}\\right) & -c + d\\left(\\frac{c}{d}\\right) \\end{pmatrix} = \\begin{pmatrix} 0 & -\\frac{bc}{d} \\\\ \\frac{ad}{b} & 0 \\end{pmatrix}\n$$\n该矩阵的特征值 $\\lambda$ 满足特征方程 $\\det(J(x^\\ast, y^\\ast) - \\lambda I) = 0$：\n$$\n\\lambda^2 - (0) \\lambda + \\left(\\left(-\\frac{bc}{d}\\right)\\left(-\\frac{ad}{b}\\right)\\right) = 0 \\implies \\lambda^2 + ac = 0\n$$\n特征值为 $\\lambda_{1,2} = \\pm i\\sqrt{ac}$。由于特征值是纯虚数，该平衡点对于线性化系统是一个中心，对应于角频率为 $\\omega = \\sqrt{ac}$ 的振荡。这证实了问题陈述中关于连续系统在平衡点周围表现出闭合轨道的说法。\n\n问题陈述该系统拥有一个首次积分 $H(x,y)$，使得沿轨迹 $\\frac{dH}{dt} = 0$。该系统的标准首次积分是 $H(x,y) = dx - c\\ln x + by - a\\ln y$。\n\n现在，我们来分析这些数值方法。\n\n**选项A：对于足够小的 $h$，显式欧拉法精确地保持首次积分 $H(x,y)$，并在 $(x^\\ast,y^\\ast)$ 周围产生没有长期漂移的数值闭合轨道。**\n\n对于一般系统 $\\dot{z} = F(z)$，显式欧拉法的更新公式为 $z_{n+1} = z_n + h F(z_n)$。围绕不动点 $z^\\ast$ 对此更新进行线性化，我们得到 $\\delta z_{n+1} = \\delta z_n + h J(z^\\ast) \\delta z_n = (I + h J) \\delta z_n$。放大矩阵为 $G_{EE} = I + h J$。其特征值 $\\mu$ 决定了稳定性。如果 $\\lambda$ 是 $J$ 的一个特征值，那么 $\\mu = 1 + h\\lambda$ 就是 $G_{EE}$ 的一个特征值。\n使用 $\\lambda = \\pm i\\omega = \\pm i\\sqrt{ac}$，放大矩阵的特征值为：\n$$\n\\mu_{1,2} = 1 \\pm i h \\sqrt{ac}\n$$\n这些特征值的模为：\n$$\n|\\mu| = \\sqrt{1^2 + (h\\sqrt{ac})^2} = \\sqrt{1 + h^2 ac}\n$$\n由于 $a,c,h > 0$，我们有 $|\\mu| > 1$。模大于 $1$ 的放大因子意味着振荡的振幅在每一步都会增长。数值轨迹将不是闭合轨道，而是一条伪外旋线。这代表了向更高能级的长期漂移。该方法不保持 $H(x,y)$，即使在长时间内也无法近似保持，更不用说精确保持了。\n\n结论：**不正确**。\n\n**选项B：在 $(x^\\ast,y^\\ast)$ 处，显式欧拉更新的线性化具有形式为 $1 \\pm i h \\omega$（其中 $\\omega>0$）的特征值，其模严格大于 $1$，这意味着存在伪外旋线。此外，$H$ 的泰勒展开表明 $H(x_{n+1},y_{n+1}) - H(x_n,y_n)$ 是 $O(h^2)$ 阶的，并且主项为正，而 AVF/离散梯度法能精确保持 $H$ 恒定，并将轨迹限制在单个水平集上。**\n\n该陈述的第一部分证实了我们对选项 A 的分析：特征值为 $\\mu=1 \\pm ih\\omega$（其中 $\\omega=\\sqrt{ac}>0$），其模 $|\\mu| = \\sqrt{1+h^2ac} > 1$，这导致了伪外旋线。这部分是正确的。\n\n对于第二部分，让我们分析显式欧拉法一步中 $H$ 的变化，$z_{n+1} = z_n + h F(z_n)$，其中 $z=(x,y)$。\n将 $H(z_{n+1})$ 在 $z_n$ 附近进行泰勒展开，得到：\n$$\nH(z_{n+1}) = H(z_n + h F(z_n)) = H(z_n) + h \\nabla H(z_n) \\cdot F(z_n) + \\frac{h^2}{2} F(z_n)^T (\\nabla^2 H)(z_n) F(z_n) + O(h^3)\n$$\n连续动力学系统保持 $H$ 守恒，因此 $\\frac{dH}{dt} = \\nabla H \\cdot F = 0$。一阶项消失。每一步 $H$ 的变化为：\n$$\nH(z_{n+1}) - H(z_n) \\approx \\frac{h^2}{2} F(z_n)^T (\\nabla^2 H)(z_n) F(z_n)\n$$\n$H(x,y) = dx - c\\ln x + by - a\\ln y$ 的海森矩阵是：\n$$\n\\nabla^2 H(x,y) = \\begin{pmatrix} c/x^2 & 0 \\\\ 0 & a/y^2 \\end{pmatrix}\n$$\n由于 $a,c > 0$ 且我们考虑的是正象限 ($x,y > 0$) 内的轨迹，海森矩阵是正定矩阵。只要 $z_n$ 不是平衡点，向量场 $F(z_n)$ 就非零。因此，对于除平衡点外的任何点，二次型 $F^T (\\nabla^2 H) F$ 都是严格为正的。这意味着 $H(z_{n+1}) - H(z_n)$ 是 $O(h^2)$ 阶的，且主项为正。$H$ 的这种系统性增加证实了外旋现象。\n\n最后，问题陈述定义了 AVF/离散梯度法，并明确指出它“根据其构造满足 $H(z_{n+1}) = H(z_n)$”。因此，该方法能精确保持 $H$ 恒定，并将轨迹限制在 $H$ 的单个水平集上。这个陈述的所有部分都是正确的。\n\n结论：**正确**。\n\n**选项C：应用于 $(x^\\ast,y^\\ast)$ 处的线性化时，隐式中点法的单步放大矩阵的特征值位于单位圆上，因此避免了振幅的数值增长或衰减；尽管对于非线性的洛特卡－沃尔泰拉系统，它不完全守恒 $H(x,y)$，但其辛结构确保了 $H$ 的误差有界，并且在长时间内没有系统性漂移。**\n\n隐式中点法为 $z_{n+1} = z_n + h F\\left(\\frac{z_n+z_{n+1}}{2}\\right)$。围绕不动点 $z^\\ast$ 进行线性化：\n$$\n\\delta z_{n+1} = \\delta z_n + h J(z^\\ast) \\frac{\\delta z_n + \\delta z_{n+1}}{2}\n$$\n整理得到 $\\delta z_{n+1}$：\n$$\n\\left(I - \\frac{h}{2}J\\right) \\delta z_{n+1} = \\left(I + \\frac{h}{2}J\\right) \\delta z_n\n$$\n放大矩阵为 $G_{IM} = \\left(I - \\frac{h}{2}J\\right)^{-1} \\left(I + \\frac{h}{2}J\\right)$。这是 $\\frac{h}{2}J$ 的凯莱（Cayley）变换。$G_{IM}$ 的特征值 $\\mu$ 与 $J$ 的特征值 $\\lambda$ 通过 $\\mu = \\frac{1+h\\lambda/2}{1-h\\lambda/2}$ 相关。当 $\\lambda = \\pm i\\omega$ 时：\n$$\n\\mu = \\frac{1 \\pm i h\\omega/2}{1 \\mp i h\\omega/2}\n$$\n模为 $|\\mu| = \\frac{|1 \\pm i h\\omega/2|}{|1 \\mp i h\\omega/2|} = \\frac{\\sqrt{1+(h\\omega/2)^2}}{\\sqrt{1+(h\\omega/2)^2}} = 1$。特征值位于单位圆上，因此线性映射是稳定的，不表现出振幅的增长或衰减。这部分是正确的。\n\n隐式中点法是一种辛积分子。对于一般的哈密顿系统，辛积分子并不精确守恒哈密顿量 $H$。它们精确守恒一个邻近的“影子哈密顿量”$H_h$。洛特卡－沃尔泰拉系统的哈密顿量不是一个简单的二次型，对于这类哈密顿量，中点法不精确守恒 $H$。这部分是正确的。\n\n辛方法的主要好处是，因为它守恒一个影子哈密顿量 $H_h$（它接近于 $H$），原始哈密顿量的误差 $H(z_n) - H(z_0)$ 在指数级长的时间内保持有界。这防止了像显式欧拉法这样的非辛方法中出现的系统性能量漂移。这部分也是正确的。\n\n结论：**正确**。\n\n**选项D：因为对于连续向量场 $f$，有 $\\nabla H(x,y)\\cdot f(x,y) = 0$，所以任何一致的一阶方法，包括显式欧拉法，在长时间积分中都能在全局上以 $O(h^2)$ 的阶保持 $H$，因此不会引入跨越水平集的长期漂移。**\n\n这个陈述包含错误的推理。性质 $\\nabla H \\cdot f = 0$ 属于连续向量场。数值方法通常不继承这类守恒律。如选项 B 的分析所示，显式欧拉法单步中 $H$ 的变化是 $O(h^2)$，而不是零。这是守恒量的局部误差。在长时间积分 $T = N h$ 内，这些系统性为正的局部误差会累积。在时间 $T$ 后，$H$ 的全局误差大约是 $N \\times O(h^2) = (T/h) \\times O(h^2) = O(h T)$。因此，全局误差是 $O(h)$ 阶，而不是 $O(h^2)$ 阶。这种误差的累积正是导致长期漂移的原因。关于没有长期漂移的结论是错误的，显式欧拉法的伪外旋线证明了这一点。\n\n结论：**不正确**。\n\n**选项E：由显式欧拉法在 $(x^\\ast,y^\\ast)$ 附近产生的伪螺旋现象完全是由浮点舍入误差引起的；在精确计算中，显式欧拉法将遵守首次积分，并对所有 $h$ 产生闭合的数值轨道。**\n\n这个陈述错误地将显式欧拉法的失败归因于舍入误差。我们对放大矩阵特征值（$|\\mu| = \\sqrt{1 + h^2 ac} > 1$）的分析是在精确计算下进行的。这种不稳定性是显式欧拉算法应用于振荡或保守系统时固有的数学特性。即使使用无限精度算术，该方法也会产生螺旋轨迹。舍入误差是任何数值计算中的一个额外误差源，但不是造成这种特定行为的根本原因。\n\n结论：**不正确**。",
            "answer": "$$\\boxed{BC}$$"
        }
    ]
}