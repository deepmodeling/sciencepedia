{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing any dynamical system is to understand its long-term behavior by identifying its steady states, or equilibria. This exercise  moves beyond the classic Lotka-Volterra equations to a more realistic Gause-type model, which incorporates logistic growth for both prey and predators. By solving for the coexistence equilibrium, you will practice a foundational analytical skill essential for predicting whether populations can persist together and at what levels.",
            "id": "1067561",
            "problem": "The Lotka-Volterra model is a foundational model in mathematical biology describing the dynamics of predator-prey interactions. A more realistic extension, known as the Gause-type model, incorporates logistic growth for the prey and can be further refined to include intraspecific competition among predators.\n\nConsider a predator-prey system with prey population $x(t)$ and predator population $y(t)$, governed by the following coupled differential equations:\n$$\n\\frac{dx}{dt} = \\alpha x \\left(1 - \\frac{x}{K}\\right) - \\beta xy\n$$\n$$\n\\frac{dy}{dt} = \\delta xy - \\gamma y - \\eta y^2\n$$\n\nHere, the parameters are all positive real numbers:\n- $\\alpha$: the intrinsic growth rate of the prey.\n- $K$: the carrying capacity of the prey in the absence of predators.\n- $\\beta$: a parameter representing the rate of predation.\n- $\\delta$: the efficiency of converting consumed prey into new predators.\n- $\\gamma$: the intrinsic death rate of the predator.\n- $\\eta$: a parameter representing the intensity of intraspecific competition among predators, making their growth logistic.\n\nThis system possesses several equilibrium points, where both population rates of change are zero. One such point, the \"coexistence equilibrium\" $(x^*, y^*)$, corresponds to a steady state where both prey and predator populations are positive.\n\nDerive the expression for the equilibrium prey population, $x^*$, for this coexistence equilibrium.",
            "solution": "1. At equilibrium $\\frac{dx}{dt}=0$ and $\\frac{dy}{dt}=0$. The equations are\n$$\n\\frac{dx}{dt}=\\alpha x\\Bigl(1-\\frac{x}{K}\\Bigr)-\\beta x y=0,\n\\quad\n\\frac{dy}{dt}=\\delta x y-\\gamma y-\\eta y^2=0.\n$$\n2. For the coexistence equilibrium $(x^*,y^*)$ with $x^*0,y^*0$, divide out common factors:\n   From $\\frac{dx}{dt}=0$: \n   $$\\alpha\\Bigl(1-\\frac{x^*}{K}\\Bigr)-\\beta y^*=0\n   \\;\\implies\\;\n   y^*=\\frac{\\alpha}{\\beta}\\Bigl(1-\\frac{x^*}{K}\\Bigr).$$\n   From $\\frac{dy}{dt}=0$:\n   $$\\delta x^*-\\gamma-\\eta y^*=0\n   \\;\\implies\\;\n   y^*=\\frac{\\delta x^*-\\gamma}{\\eta}.$$\n3. Equate the two expressions for $y^*$:\n$$\n\\frac{\\alpha}{\\beta}\\Bigl(1-\\frac{x^*}{K}\\Bigr)\n=\\frac{\\delta x^*-\\gamma}{\\eta}.\n$$\n4. Multiply by $\\beta$ and rearrange:\n$$\n\\alpha\\Bigl(1-\\frac{x^*}{K}\\Bigr)\n=\\frac{\\beta\\delta}{\\eta}x^*-\\frac{\\beta\\gamma}{\\eta}\n\\;\\implies\\;\n\\alpha+\\frac{\\beta\\gamma}{\\eta}\n=x^*\\Bigl(\\frac{\\alpha}{K}+\\frac{\\beta\\delta}{\\eta}\\Bigr).\n$$\n5. Solve for $x^*$:\n$$\nx^*=\\frac{\\alpha+\\tfrac{\\beta\\gamma}{\\eta}}{\\tfrac{\\alpha}{K}+\\tfrac{\\beta\\delta}{\\eta}}\n=\\frac{K(\\alpha\\eta+\\beta\\gamma)}{\\alpha\\eta+\\beta\\delta K}.\n$$",
            "answer": "$$\\boxed{\\frac{K(\\alpha\\eta+\\beta\\gamma)}{\\alpha\\eta+\\beta\\delta K}}$$"
        },
        {
            "introduction": "Before attempting to fit a complex model to data, a critical theoretical question must be answered: can the model's parameters be uniquely determined from the available observations? This practice  introduces the crucial concept of structural identifiability, which addresses this very question. By using differential algebra to eliminate the unobserved predator population, you will determine which parameters of the Lotka-Volterra model can, in principle, be identified from observing the prey alone, providing deep insight into the limits of what can be learned from data.",
            "id": "3889880",
            "problem": "Consider the classical Lotka–Volterra predator–prey model for prey population $N(t)$ and predator population $P(t)$:\n$$\n\\frac{dN}{dt} = r\\,N - a\\,N\\,P, \\qquad \\frac{dP}{dt} = e\\,a\\,N\\,P - m\\,P,\n$$\nwhere $r0$ is the intrinsic growth rate of the prey, $a0$ is the attack rate, $e0$ is the conversion efficiency, and $m0$ is the predator mortality rate. Assume positive, unknown initial conditions $N(0)0$ and $P(0)0$, and suppose that the prey population $N(t)$ is observed continuously and without noise over an open time interval, while the predator population $P(t)$ is unobserved.\n\nDefine structural identifiability of parameters in this dynamical system context as a property of the mapping from parameters to the model’s output trajectory being one-to-one almost everywhere. Then, using first principles of differential algebraic elimination or an observability-rank-style argument based on Lie derivatives, eliminate the unobserved variable to derive an input–output relation involving only $N(t)$ and its time derivatives, together with the parameters $(r,a,e,m)$. From this relation, determine which of the parameters $(r,a,e,m)$ are structurally identifiable from observing only $N(t)$, and specify a minimal set of independent, structurally identifiable parameter combinations in terms of $(r,a,e,m)$.\n\nExpress your final answer as a single row matrix listing the minimal set of structurally identifiable quantities using symbolic expressions in terms of $(r,a,e,m)$. No numerical rounding is required.",
            "solution": "The problem asks for an analysis of the structural identifiability of the parameters in the classical Lotka-Volterra predator-prey model, given that only the prey population is observed.\n\nThe system is described by the following set of ordinary differential equations:\n$$ \\frac{dN}{dt} = r\\,N - a\\,N\\,P \\quad (1) $$\n$$ \\frac{dP}{dt} = e\\,a\\,N\\,P - m\\,P \\quad (2) $$\nwhere $N(t)$ represents the prey population and $P(t)$ represents the predator population. The parameters are the prey's intrinsic growth rate $r$, the predator's attack rate $a$, the predator's conversion efficiency $e$, and the predator's mortality rate $m$. All parameters are positive constants: $r0$, $a0$, $e0$, $m0$. The output of the system is the prey population, $y(t) = N(t)$, while the predator population $P(t)$ is an unobserved state.\n\nTo determine which parameters are structurally identifiable, we must first eliminate the unobserved state variable $P(t)$ from the system. This will yield a single higher-order differential equation, known as the input-output relation, involving only the observed variable $N(t)$ and its time derivatives. The coefficients of this equation will be functions of the original parameters $(r,a,e,m)$. Structural identifiability requires that this mapping from the original parameters to the coefficients be one-to-one.\n\nWe begin by using equation $(1)$ to express $P(t)$ in terms of $N(t)$ and its derivative. Let $\\dot{N}$ denote $\\frac{dN}{dt}$. Since $N(t)0$ (as per the problem statement and system dynamics for positive initial conditions) and $a0$, we can write:\n$$ a\\,N\\,P = r\\,N - \\dot{N} $$\n$$ P = \\frac{r\\,N - \\dot{N}}{a\\,N} = \\frac{r}{a} - \\frac{\\dot{N}}{a\\,N} \\quad (3) $$\n\nNext, we differentiate this expression for $P(t)$ with respect to time $t$. Let $\\ddot{N}$ denote $\\frac{d^2N}{dt^2}$.\n$$ \\dot{P} = \\frac{dP}{dt} = \\frac{d}{dt} \\left( \\frac{r}{a} - \\frac{1}{a}\\frac{\\dot{N}}{N} \\right) $$\nThe term $\\frac{r}{a}$ is constant, so its derivative is zero. Using the quotient rule for the second term:\n$$ \\dot{P} = -\\frac{1}{a} \\left( \\frac{\\ddot{N} \\cdot N - \\dot{N} \\cdot \\dot{N}}{N^2} \\right) = -\\frac{1}{a} \\left( \\frac{N\\ddot{N} - \\dot{N}^2}{N^2} \\right) = \\frac{\\dot{N}^2}{aN^2} - \\frac{\\ddot{N}}{aN} \\quad (4) $$\n\nNow we have expressions for both $P$ (equation $3$) and $\\dot{P}$ (equation $4$) in terms of $N$ and its derivatives. We substitute these into the second dynamic equation, equation $(2)$:\n$$ \\dot{P} = P(e\\,a\\,N - m) $$\n$$ \\frac{\\dot{N}^2}{aN^2} - \\frac{\\ddot{N}}{aN} = \\left( \\frac{rN - \\dot{N}}{aN} \\right) (e\\,a\\,N - m) $$\nTo clear the denominators, we multiply the entire equation by $aN^2$:\n$$ aN^2 \\left( \\frac{\\dot{N}^2}{aN^2} - \\frac{\\ddot{N}}{aN} \\right) = aN^2 \\left( \\frac{rN - \\dot{N}}{aN} \\right) (e\\,a\\,N - m) $$\n$$ \\dot{N}^2 - N\\ddot{N} = N(rN - \\dot{N})(e\\,a\\,N - m) $$\nExpanding the right-hand side of the equation:\n$$ \\dot{N}^2 - N\\ddot{N} = (rN^2 - N\\dot{N})(e\\,a\\,N - m) $$\n$$ \\dot{N}^2 - N\\ddot{N} = (rN^2)(e\\,a\\,N) + (rN^2)(-m) + (-N\\dot{N})(e\\,a\\,N) + (-N\\dot{N})(-m) $$\n$$ \\dot{N}^2 - N\\ddot{N} = r\\,e\\,a\\,N^3 - r\\,m\\,N^2 - e\\,a\\,N^2\\,\\dot{N} + m\\,N\\,\\dot{N} $$\nRearranging the terms to form a canonical differential equation set to zero, we obtain the input-output relation:\n$$ N\\ddot{N} - \\dot{N}^2 - (e\\,a)N^2\\,\\dot{N} + m\\,N\\,\\dot{N} + (r\\,e\\,a)N^3 - (r\\,m)N^2 = 0 \\quad (5) $$\n\nThe coefficients of the functionally independent terms in this equation (e.g., $N^2\\dot{N}$, $N\\dot{N}$, $N^3$, $N^2$) are determined by the system's dynamics and are therefore identifiable from observations of $N(t)$. Let's denote these identifiable coefficients as $C_i$:\n- Coefficient of $N^2\\dot{N}$: $C_1 = -e\\,a$\n- Coefficient of $N\\dot{N}$: $C_2 = m$\n- Coefficient of $N^3$: $C_3 = r\\,e\\,a$\n- Coefficient of $N^2$: $C_4 = -r\\,m$\n\nFrom this system of algebraic equations, we determine which of the original parameters $(r, a, e, m)$ can be solved for uniquely.\n1.  From $C_2 = m$, the parameter $m$ is uniquely determined. Thus, $m$ is structurally identifiable.\n2.  Using the value of $m$, from $C_4 = -r\\,m$, we can solve for $r$: $r = -\\frac{C_4}{m} = -\\frac{C_4}{C_2}$. Since $m0$, this gives a unique solution for $r$. Thus, $r$ is structurally identifiable.\n3.  From $C_1 = -e\\,a$, we can identify the product $e\\,a = -C_1$. However, we cannot separate $e$ and $a$. For any valid pair of values $(\\hat{e}, \\hat{a})$ that satisfies this equation, any other pair $(k\\hat{e}, \\hat{a}/k)$ for any $k0$ would also be a valid solution, producing the same observed dynamics of $N(t)$. Therefore, $e$ and $a$ are not individually structurally identifiable. Only their product, $e\\,a$, is identifiable.\n4.  The equation $C_3 = r\\,e\\,a$ serves as a consistency check. We must have $C_3 = r(e\\,a) = (-\\frac{C_4}{C_2})(-C_1) = \\frac{C_1C_4}{C_2}$, which implies $C_2C_3 = C_1C_4$. This dependency confirms that we only have three independent pieces of information from the four coefficients.\n\nIn conclusion, the parameters $r$ and $m$ are structurally identifiable, while $e$ and $a$ are not. The product $e\\,a$ is identifiable as a single combination. Therefore, a minimal set of independent, structurally identifiable quantities is $\\{r, m, e\\,a\\}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nr  m  ea\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "This final practice  simulates the complete workflow of a quantitative environmental scientist, bridging theory, computation, and statistical inference. You will derive two competing models for a key ecological process—the predator's functional response—based on first principles. Using the provided hypothetical datasets, which are designed to illustrate distinct ecological scenarios, you will then fit these models using nonlinear least squares and apply the Akaike Information Criterion ($AIC$) to select the model that best explains the data. This exercise provides invaluable hands-on experience in model development, parameter estimation, and formal model selection.",
            "id": "3889896",
            "problem": "Consider a laboratory experiment in which a single predator is exposed to varying prey densities and the number of prey consumed per predator per unit time is recorded. The functional response in predator-prey theory quantifies how the per-predator consumption rate depends on prey density. Your task is to derive, implement, and fit two competing functional response models from first principles, then perform model selection.\n\nStart from the following foundational assumptions:\n\n- Encounters between predator and prey occur as a Poisson process with an encounter intensity proportional to prey density. If prey density is $N$ (in individuals per experimental arena) and the proportionality constant is $a$ (encounter coefficient in per hour), then the expected encounters during searching per unit time is proportional to $a N$.\n- Each captured prey requires a fixed handling time $h$ (in hours per prey), which contributes to a time-budget constraint: handling displaces searching.\n- In the first model, assume the search rate is proportional to $N$ at all densities, consistent with a constant search efficiency and no learning or switching.\n- In the second model, assume an accelerating encounter regime at low densities, consistent with learning or switching, such that the effective encounter intensity grows more than linearly with $N$ at low $N$, while still saturating due to handling limitations.\n\nFrom these assumptions, derive expressions for the expected per-predator consumption rate $r(N)$ (in prey per predator per hour) as a function of $N$, the encounter coefficient $a$, and the handling time $h$, for both models:\n\n- Model $M_2$ (to be tested as a candidate for a \"Type II\" functional response).\n- Model $M_3$ (to be tested as a candidate for a \"Type III\" functional response with acceleration at low prey density).\n\nAssume independent Gaussian measurement error on $r(N)$ across observations with unknown variance and use nonlinear least squares to estimate parameters $a$ and $h$ for each model. For model comparison, use the Akaike Information Criterion (AIC) under the Gaussian error assumption. Let the sum of squared residuals be $\\mathrm{SSR} = \\sum_{i=1}^{n} \\left( r_i - r(N_i; a, h) \\right)^2$, where $n$ is the number of observations, and $k$ is the number of free parameters. Use\n$$\n\\mathrm{AIC} = n \\ln\\left(\\frac{\\mathrm{SSR}}{n}\\right) + 2 k,\n$$\nwhich is appropriate for comparing models when the error variance is not known and is estimated implicitly by $\\mathrm{SSR}/n$. Select the model with the lower $\\mathrm{AIC}$.\n\nPhysical units: prey density $N$ is a count (dimensionless), time is in hours, and the consumption rate $r$ must be in prey per predator per hour. Report the final chosen model for each dataset as an integer: output $2$ if $M_2$ has the lower $\\mathrm{AIC}$, and output $3$ if $M_3$ has the lower $\\mathrm{AIC}$.\n\nTest suite: Fit both models to each of the following four datasets. Each dataset provides prey densities $N$ and observed consumption rates $r$ (in prey per predator per hour). These data are scientifically plausible and internally consistent with the assumptions.\n\n- Dataset $1$ (moderate saturation, no apparent low-density acceleration): $N = [1,2,4,8,16,32,64]$, $r = [0.49,0.81,1.22,1.64,1.98,2.21,2.35]$.\n- Dataset $2$ (clear low-density acceleration with saturation): $N = [1,2,4,8,16,32,64]$, $r = [0.076,0.261,0.675,1.117,1.336,1.404,1.423]$.\n- Dataset $3$ (includes zero density, pronounced acceleration at low $N$): $N = [0,1,2,3,4,5]$, $r = [0.0,0.22,0.49,0.64,0.71,0.75]$.\n- Dataset $4$ (near-linear regime due to very short handling time): $N = [5,10,20,40]$, $r = [0.25,0.495,0.98,1.92]$.\n\nAlgorithmic requirements:\n\n- For each dataset, estimate parameters $(a, h)$ for both models by minimizing $\\mathrm{SSR}$ using a bounded nonlinear least squares algorithm with bounds $a \\in (0, 10]$, $h \\in (0, 10]$.\n- Use scientifically sensible initial guesses; the algorithm should be robust to differences among datasets.\n- Compute $\\mathrm{AIC}$ for each fitted model and select the model with lower $\\mathrm{AIC}$.\n\nAngle units are not applicable. Percentages must not be used; all quantities should be expressed as decimals or fractions.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain four integers, one for each dataset in the order presented above. For example, if the chosen models are $M_3$, $M_3$, $M_2$, $M_2$, the output should be $[3,3,2,2]$. Your program must print exactly this single line and nothing else.",
            "solution": "The user wants me to solve a problem on predator-prey functional responses. I will first validate the problem, then proceed to the solution if it is valid.\n\n### Step 1: Extract Givens\n- **Task**: Derive, implement, fit, and compare two functional response models, $M_2$ and $M_3$.\n- **Assumptions**:\n    1.  Encounters between predator and prey follow a Poisson process.\n    2.  The encounter intensity is proportional to prey density $N$. The proportionality constant is $a$ (encounter coefficient, per hour).\n    3.  Each captured prey requires a fixed handling time $h$ (hours per prey).\n    4.  Handling time displaces searching time (time-budget constraint).\n- **Model $M_2$ (Type II) Assumption**: The search rate is proportional to $N$ at all densities.\n- **Model $M_3$ (Type III) Assumption**: The effective encounter intensity grows more than linearly with $N$ at low densities.\n- **Objective**: Derive expressions for the per-predator consumption rate $r(N)$ as a function of $N$, $a$, and $h$ for both models.\n- **Statistical Method**:\n    1.  **Fitting**: Use nonlinear least squares to estimate parameters $a$ and $h$ by minimizing the sum of squared residuals, $\\mathrm{SSR} = \\sum_{i=1}^{n} \\left( r_i - r(N_i; a, h) \\right)^2$.\n    2.  **Model Selection**: Use the Akaike Information Criterion, $\\mathrm{AIC} = n \\ln\\left(\\frac{\\mathrm{SSR}}{n}\\right) + 2 k$, where $k$ is the number of free parameters. The model with the lower AIC is selected.\n- **Parameter Constraints**: $a \\in (0, 10]$ and $h \\in (0, 10]$.\n- **Output**: For each dataset, report $2$ if $M_2$ is selected, and $3$ if $M_3$ is selected. The final output is a single-line list of four integers.\n- **Datasets**:\n    - Dataset $1$: $N = [1,2,4,8,16,32,64]$, $r = [0.49,0.81,1.22,1.64,1.98,2.21,2.35]$.\n    - Dataset $2$: $N = [1,2,4,8,16,32,64]$, $r = [0.076,0.261,0.675,1.117,1.336,1.404,1.423]$.\n    - Dataset $3$: $N = [0,1,2,3,4,5]$, $r = [0.0,0.22,0.49,0.64,0.71,0.75]$.\n    - Dataset $4$: $N = [5,10,20,40]$, $r = [0.25,0.495,0.98,1.92]$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is centered on the Lotka-Volterra predator-prey dynamics, specifically the functional response component, which is a cornerstone of modern ecology. The derivation from first principles (the \"disc equation\" logic) is a classic exercise. The models (Type II and Type III) are standard and widely used. The assumptions are scientifically sound.\n2.  **Well-Posed**: The problem is well-posed. It asks for a comparison between two specific models fitted to given datasets using a clearly defined statistical criterion. A unique solution (a sequence of model choices) is expected.\n3.  **Objective**: The problem is stated in precise, objective language. The data is provided, and the mathematical and statistical procedures are explicitly defined. There is no subjectivity.\n4.  **No Flaws Found**: The problem does not violate any of the invalidity criteria. It is a standard, albeit comprehensive, scientific modeling problem. It is complete, consistent, and scientifically sound.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed with the solution.\n\nThe task is to derive and compare two functional response models, designated $M_2$ and $M_3$, for predator consumption rate. The derivation for both models stems from a time-budget constraint. Let $T$ be the total time available to a predator, which is partitioned into searching time, $T_s$, and handling time, $T_h$.\n\n$$T = T_s + T_h$$\n\nThe number of prey eaten, $N_e$, during time $T$ is the product of the consumption rate, $r(N)$, and the total time: $N_e = r(N)T$. The total handling time is the number of prey eaten multiplied by the handling time per prey, $h$: $T_h = N_e h = r(N)Th$. Substituting this into the time budget equation and solving for $T_s$ gives:\n\n$$T_s = T - T_h = T - r(N)Th = T(1 - r(N)h)$$\n\nThe number of prey eaten, $N_e$, is also the result of encounters during the search period. It is the product of the search time, $T_s$, and an instantaneous encounter rate, which we denote as $f(N)$.\n\n$$N_e = f(N) T_s$$\n\nCombining the expressions for $N_e$ and $T_s$:\n\n$$r(N)T = f(N) [T(1 - r(N)h)]$$\n\nThe total time $T$ cancels, and we can solve for $r(N)$:\n\n$$r(N) = f(N) (1 - r(N)h)$$\n$$r(N) = f(N) - f(N)r(N)h$$\n$$r(N) (1 + f(N)h) = f(N)$$\n$$r(N) = \\frac{f(N)}{1 + f(N)h}$$\n\nThis general formula, known as Holling's disc equation, forms the basis for both models. The models differ only in their assumption about the form of the instantaneous encounter rate, $f(N)$.\n\n**Derivation of Model $M_2$ (Type II Functional Response)**\nFor this model, the assumption is that the encounter rate is directly proportional to prey density, $N$. The proportionality constant is the encounter coefficient, $a$.\n$$f(N) = aN$$\nSubstituting this into the general formula for $r(N)$ yields the Type II functional response:\n$$r(N) = \\frac{aN}{1 + aNh}$$\nThis function increases with $N$ but at a decelerating rate, asymptotically approaching a maximum consumption rate of $1/h$ as $N \\rightarrow \\infty$, limited by the handling time $h$. The parameter $a$ represents the attack rate or search efficiency and has units of $1/\\text{time}$.\n\n**Derivation of Model $M_3$ (Type III Functional Response)**\nFor this model, the encounter rate is assumed to be an accelerating function of prey density at low densities. This is commonly used to model effects like predator learning or prey switching. The simplest functional form for $f(N)$ that captures this acceleration and adheres to the problem's constraint of using only parameters $a$ and $h$ is a quadratic relationship:\n$$f(N) = aN^2$$\nSubstituting this into the general formula for $r(N)$ yields a sigmoidal Type III functional response:\n$$r(N) = \\frac{aN^2}{1 + aN^2h}$$\nThis function has an initial accelerating phase (the consumption rate per prey, $r(N)/N$, increases with $N$ at low $N$) before it decelerates and saturates at the same maximum rate of $1/h$. It is important to note that the parameter $a$ in this model has different units and interpretation (units of $1/(\\text{prey} \\cdot \\text{time})$) compared to the $a$ in Model $M_2$.\n\n**Model Fitting and Selection**\nFor each dataset, we must estimate the parameters $(a, h)$ for both models. This is achieved by using a bounded nonlinear least squares algorithm to find the parameter values that minimize the Sum of Squared Residuals (SSR):\n$$\\mathrm{SSR} = \\sum_{i=1}^{n} (r_i - r(N_i; a, h))^2$$\nwhere $(N_i, r_i)$ are the observed data points and $n$ is the number of observations. The optimization is constrained with bounds $a \\in (0, 10]$ and $h \\in (0, 10]$.\n\nAfter fitting, the two models are compared using the Akaike Information Criterion (AIC), as specified:\n$$\\mathrm{AIC} = n \\ln\\left(\\frac{\\mathrm{SSR}}{n}\\right) + 2k$$\nFor both $M_2$ and $M_3$, the number of estimated parameters is $k=2$ (for $a$ and $h$). The model that yields the lower AIC value is considered the better fit for the given data, balancing goodness of fit with model complexity. The procedure is repeated for each of the four datasets, and the selected model ($2$ or $3$) is recorded.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\n# --- Model Definitions ---\n\ndef model_M2(N, a, h):\n    \"\"\"\n    Type II functional response model.\n    r(N) = a*N / (1 + a*N*h)\n    \"\"\"\n    N = np.asarray(N)\n    # To prevent division by zero or NaN if a=0 or h=0, though bounds should prevent this.\n    denominator = 1.0 + a * N * h\n    return (a * N) / denominator\n\ndef model_M3(N, a, h):\n    \"\"\"\n    Type III functional response model.\n    r(N) = a*N^2 / (1 + a*N^2*h)\n    \"\"\"\n    N = np.asarray(N)\n    N_squared = N**2\n    denominator = 1.0 + a * N_squared * h\n    return (a * N_squared) / denominator\n\n# --- Fitting and Selection ---\n\ndef calculate_ssr(params, model_func, N_data, r_data):\n    \"\"\"Calculates the Sum of Squared Residuals (SSR).\"\"\"\n    a, h = params\n    r_predicted = model_func(N_data, a, h)\n    residuals = r_predicted - r_data\n    return np.sum(residuals**2)\n\ndef fit_and_select_model(N_data, r_data):\n    \"\"\"\n    Fits both M2 and M3 to the data, calculates AIC, and selects the best model.\n    \"\"\"\n    # Convert data to numpy arrays\n    N_data = np.array(N_data, dtype=float)\n    r_data = np.array(r_data, dtype=float)\n\n    # Number of observations\n    n = len(N_data)\n    # Number of parameters\n    k = 2\n\n    # --- Parameter Estimation using Bounded Nonlinear Least Squares ---\n\n    # Common settings for the optimizer\n    # Initial guess for (a, h)\n    p0 = [0.5, 0.5]\n    # Bounds: a in (0, 10], h in (0, 10]. Use small positive for lower bound.\n    bounds = ([1e-9, 1e-9], [10.0, 10.0])\n\n    # Residual functions for least_squares\n    def residuals_M2(params, N, r):\n        return model_M2(N, params[0], params[1]) - r\n\n    def residuals_M3(params, N, r):\n        return model_M3(N, params[0], params[1]) - r\n\n    # Fit Model M2\n    res_M2 = least_squares(residuals_M2, p0, args=(N_data, r_data), bounds=bounds)\n    ssr_M2 = np.sum(res_M2.fun**2)\n\n    # Fit Model M3\n    res_M3 = least_squares(residuals_M3, p0, args=(N_data, r_data), bounds=bounds)\n    ssr_M3 = np.sum(res_M3.fun**2)\n\n    # --- Model Selection using AIC ---\n    # AIC = n * ln(SSR/n) + 2k\n    \n    # Check for SSR=0 to avoid log(0)\n    aic_M2 = np.inf\n    if ssr_M2 > 0:\n        aic_M2 = n * np.log(ssr_M2 / n) + 2 * k\n\n    aic_M3 = np.inf\n    if ssr_M3 > 0:\n        aic_M3 = n * np.log(ssr_M3 / n) + 2 * k\n\n    # Select the model with the lower AIC\n    if aic_M2  aic_M3:\n        return 2\n    else:\n        return 3\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset 1\n        {'N': [1, 2, 4, 8, 16, 32, 64], 'r': [0.49, 0.81, 1.22, 1.64, 1.98, 2.21, 2.35]},\n        # Dataset 2\n        {'N': [1, 2, 4, 8, 16, 32, 64], 'r': [0.076, 0.261, 0.675, 1.117, 1.336, 1.404, 1.423]},\n        # Dataset 3\n        {'N': [0, 1, 2, 3, 4, 5], 'r': [0.0, 0.22, 0.49, 0.64, 0.71, 0.75]},\n        # Dataset 4\n        {'N': [5, 10, 20, 40], 'r': [0.25, 0.495, 0.98, 1.92]},\n    ]\n\n    results = []\n    for case in test_cases:\n        N_data = case['N']\n        r_data = case['r']\n        chosen_model = fit_and_select_model(N_data, r_data)\n        results.append(chosen_model)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}