{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的混合坐标之前，理解其“父”坐标——纯西格玛（sigma）坐标的特性至关重要。这个练习  揭示了 $\\sigma$ 坐标与大气质量之间的基本关系，解释了为何它常被称为“质量坐标”。掌握这一概念将为您理解所有地形跟随压力坐标提供物理直觉。",
            "id": "3863963",
            "problem": "考虑一个在恒定重力加速度 $g$ 下的静力平衡大气，其垂直坐标为地形追随压力坐标 $\\sigma$，定义为 $\\sigma = p/p_{s}$，其中 $p$ 为压力，$p_{s}$ 为地表压力。在固定的水平位置 $(x_{0},y_{0})$ 和时间 $t_{0}$ 进行分析，因此在该时空点上，$p_{s}=p_{s}(x_{0},y_{0},t_{0})$ 是一个相对于 $\\sigma$ 变化而言的常数。\n\n仅从 $\\sigma$ 的定义和静力平衡关系出发，推导在固定点 $(x_{0},y_{0},t_{0})$ 的雅可比 $\\partial p/\\partial \\sigma$。然后，利用静力平衡关系，将跨越 $\\sigma$ 到 $\\sigma+\\Delta \\sigma$ 的薄层单位面积质量用 $p_{s}$、$g$ 和 $\\Delta \\sigma$ 表示。清晰地阐述你所推导的雅可比的物理意义，并用单位面积、单位 $\\sigma$ 厚度的气柱质量来解释。\n\n报告在固定点 $(x_{0},y_{0},t_{0})$ 计算得到的雅可比 $\\partial p/\\partial \\sigma$ 的解析表达式作为你的最终答案。无需四舍五入。最终答案中不要包含单位。",
            "solution": "该问题陈述被评估为有效，因为它科学地基于大气物理学的既定原理，问题设置良好，目标明确，信息充分，并使用了精确、客观的语言。该问题是大气模拟领域中的一个标准推导。\n\n根据问题陈述的要求，解答过程分为三个部分。首先，我们推导雅可比 $\\frac{\\partial p}{\\partial \\sigma}$。其次，我们推导厚度为 $\\Delta \\sigma$ 的气层的单位面积质量。第三，我们阐述雅可比的物理意义。\n\n**第一部分：雅可比 $\\frac{\\partial p}{\\partial \\sigma}$ 的推导**\n\n问题给出了地形追随压力坐标 $\\sigma$ 的定义：\n$$ \\sigma = \\frac{p}{p_s} $$\n其中 $p$ 是压力，$p_s$ 是地表压力。我们被要求在固定的水平位置 $(x_{0}, y_{0})$ 和时间 $t_{0}$ 处计算雅可比。在此特定点上，地表压力 $p_s = p_s(x_{0}, y_{0}, t_{0})$ 是一个相对于垂直坐标 $\\sigma$ 的常数。\n\n为了求得雅可比 $\\frac{\\partial p}{\\partial \\sigma}$，我们首先将 $p$ 表示为 $\\sigma$ 的函数。根据定义，我们可以写出：\n$$ p = \\sigma p_s $$\n现在，我们对 $p$ 求关于 $\\sigma$ 的偏导数。由于我们处于固定的水平位置和时间，因此在此微分中 $p_s$ 被视为常数。\n$$ \\frac{\\partial p}{\\partial \\sigma} = \\frac{\\partial}{\\partial \\sigma} (\\sigma p_s) $$\n应用微分法则，其中 $p_s$ 是常数：\n$$ \\frac{\\partial p}{\\partial \\sigma} = p_s \\frac{\\partial \\sigma}{\\partial \\sigma} = p_s \\cdot 1 $$\n因此，雅可比为：\n$$ \\frac{\\partial p}{\\partial \\sigma} = p_s $$\n\n**第二部分：薄层中的单位面积质量**\n\n第二个要求是使用静力平衡关系来求出薄大气层的单位面积质量。静力平衡方程将压力 $p$ 的变化与位势高度 $z$ 联系起来：\n$$ \\frac{dp}{dz} = -\\rho g $$\n其中 $\\rho$ 是空气密度，$g$ 是恒定的重力加速度。负号表示压力随高度增加而减小。\n\n考虑一个厚度为 $dz$、单位水平面积（$A=1$）的大气薄垂直切片。该切片的质量为 $dm = \\rho \\cdot dV = \\rho \\cdot (A \\cdot dz) = \\rho dz$。这是一个无穷薄层的单位面积质量。\n根据静力平衡方程，我们可以用压力微分 $dp$ 来表示这个单位面积质量：\n$$ \\rho dz = -\\frac{1}{g} dp $$\n因此，单位面积的质量微元为 $dM_A = -\\frac{1}{g} dp$。\n\n为了求出跨越从较低压力层 $p_1$ 到较高压力层 $p_2$（其中 $p_2  p_1$）的气层的单位面积质量 $\\Delta M_A$，我们对该表达式进行积分：\n$$ \\Delta M_A = \\int_{p_1}^{p_2} -\\frac{1}{g} dp = -\\frac{1}{g} [p]_{p_1}^{p_2} = -\\frac{1}{g}(p_2 - p_1) = \\frac{p_1 - p_2}{g} $$\n这个结果证实了一层气体的单位面积质量是该层两端的压力差除以 $g$。\n\n现在，我们将此应用于 $\\sigma$ 坐标系。问题要求计算跨越从 $\\sigma$ 到 $\\sigma + \\Delta\\sigma$ 的气层中的质量。在标准大气模型中，地表处 $\\sigma=1$（$p=p_s$），大气层顶端 $\\sigma \\to 0$（$p \\to 0$）。因此，$\\sigma$ 的增加对应于高度的降低和压力的增加。设该层由层面 $\\sigma_{lower} = \\sigma + \\Delta\\sigma$ 和 $\\sigma_{upper} = \\sigma$ 界定，其中 $\\Delta\\sigma$ 是一个小的正量。相应的压力为 $p_1 = p(\\sigma + \\Delta\\sigma)$ 和 $p_2 = p(\\sigma)$。\n\n使用我们的关系式 $p = \\sigma p_s$，我们有：\n$$ p_1 = (\\sigma + \\Delta\\sigma) p_s $$\n$$ p_2 = \\sigma p_s $$\n将这些代入 $\\Delta M_A$ 的表达式中：\n$$ \\Delta M_A = \\frac{(\\sigma + \\Delta\\sigma)p_s - \\sigma p_s}{g} = \\frac{\\sigma p_s + \\Delta\\sigma p_s - \\sigma p_s}{g} $$\n$$ \\Delta M_A = \\frac{p_s}{g} \\Delta\\sigma $$\n这就是所求的厚度为 $\\Delta\\sigma$ 的气层单位面积质量的表达式，用 $p_s$、$g$ 和 $\\Delta\\sigma$ 表示。\n\n**第三部分：雅可比的物理意义**\n\n雅可比 $\\frac{\\partial p}{\\partial \\sigma}$ 的物理意义可以通过联系上面推导出的两个结果来理解。\n从第二部分，我们发现厚度为 $\\Delta\\sigma$ 的气层中单位面积的质量为 $\\Delta M_A = \\frac{p_s}{g} \\Delta\\sigma$。\n我们可以将单位面积、单位 $\\sigma$ 厚度的质量定义为比率 $\\frac{\\Delta M_A}{\\Delta\\sigma}$。在 $\\Delta\\sigma \\to 0$ 的极限情况下，这变成一个导数：\n$$ \\frac{d M_A}{d\\sigma} = \\lim_{\\Delta\\sigma \\to 0} \\frac{\\Delta M_A}{\\Delta\\sigma} = \\frac{p_s}{g} $$\n这个量表示在 $\\sigma$ 坐标系中质量在垂直方向上的分布。值得注意的是，在 $\\sigma$ 空间中的这个质量“密度” $\\frac{p_s}{g}$ 是恒定的。这意味着在 $\\sigma$ 坐标中相等的间隔包含相等量的单位面积质量，这是 $\\sigma$ 坐标系的一个关键特征。\n\n现在，让我们将其与雅可比联系起来。我们发现雅可比是 $\\frac{\\partial p}{\\partial \\sigma} = p_s$。\n通过将 $p_s$ 代入单位 $\\sigma$ 质量的表达式中，我们得到一个直接关系：\n$$ \\frac{d M_A}{d\\sigma} = \\frac{1}{g} \\frac{\\partial p}{\\partial \\sigma} $$\n重新整理得到：\n$$ \\frac{\\partial p}{\\partial \\sigma} = g \\frac{d M_A}{d\\sigma} $$\n这个方程提供了一个清晰的物理释义。雅可比 $\\frac{\\partial p}{\\partial \\sigma}$ 描述了压力随垂直坐标 $\\sigma$ 的变化，它等于重力加速度 $g$ 乘以单位面积、单位 $\\sigma$ 厚度的气柱质量。\n\n此外，地表压力 $p_s$ 本身代表了单位面积上整个大气柱的总重量。单位面积上大气柱的总质量 $M_{total}$ 是 $M_{total} = p_s/g$。因此，雅可比 $\\frac{\\partial p}{\\partial \\sigma} = p_s$ 等于单位面积上大气的总重量。它的值决定了归一化压力坐标 $\\sigma$ 与大气中实际质量分布之间的比例关系。",
            "answer": "$$\\boxed{p_s}$$"
        },
        {
            "introduction": "基于质量坐标的概念，现代大气模型采用混合 $\\sigma$-压力系统，以结合近地表的地形跟随坐标和高空的纯压力坐标的优点。这项实践  提供了构建这样一个模型垂直网格的动手经验。您将推导界面压力和层厚度的公式，这是建立任何数值模拟的必要第一步。",
            "id": "3863962",
            "problem": "考虑一个用广义混合垂直压力坐标建模的静力平衡大气，其中独立的垂直坐标是一个无量纲变量 $\\eta$，它从大气层顶（TOA）的 $\\eta=0$ 处单调增加到地表的 $\\eta=1$ 处。地表气压为 $p_s$，它在水平方向上变化，但在本文所考虑的气柱内是恒定的。该模型将气柱离散化为 $N$ 个层，由 $N+1$ 个位于离散层级 $\\eta_{k\\pm 1/2}$（$k=1,\\dots,N$）的界面界定，其中 $\\eta_{1/2}=0$ 且 $\\eta_{N+1/2}=1$。\n\n从设计一个在静力平衡和水平变化地表气压下质量守恒的坐标所需的第一性原理出发，推导界面气压 $p_{k\\pm 1/2}$ 关于地表气压 $p_s$ 和一对与界面相关的系数的表达式，然后推导相应的层气压厚度 $\\Delta p_k$ 为界面气压之差。你的推导必须明确说明所使用的物理和数学约束。\n\n对于一个三层气柱（$N=3$），四个界面的混合系数规定如下：\n- 在大气层顶 (TOA)：$A_{1/2}=0\\,\\mathrm{Pa}$ 且 $B_{1/2}=0$，\n- 第一个内部界面：$A_{3/2}=2.0\\times 10^{3}\\,\\mathrm{Pa}$ 且 $B_{3/2}=0.06$，\n- 第二个内部界面：$A_{5/2}=1.4\\times 10^{4}\\,\\mathrm{Pa}$ 且 $B_{5/2}=0.35$，\n- 在地表：$A_{7/2}=0\\,\\mathrm{Pa}$ 且 $B_{7/2}=1$。\n\n假设气柱地表气压 $p_s=9.8\\times 10^{4}\\,\\mathrm{Pa}$。使用你推导出的公式，计算第二层的气压厚度 $\\Delta p_2$。以帕斯卡为单位给出你的最终数值答案。给出精确值，无需四舍五入。",
            "solution": "### 气压公式的推导\n\n广义混合垂直坐标的设计基于创建一个单调函数 $p(\\eta)$，该函数从高层大气中的纯压力坐标平滑过渡到地表附近的地形追随 sigma 坐标（$\\sigma = p/p_s$）。这使得坐标面在远离地形处是平的，从而最小化数值误差，同时在下边界仍然能追随地形。\n\n这样一个坐标系的一个广泛使用的公式将给定 $\\eta$ 层上的气压 $p$ 定义为一个基于压力的分量和一个基于地表气压的分量的线性组合。对于一个离散的界面层级 $\\eta_{k\\pm 1/2}$，其气压 $p_{k\\pm 1/2}$ 由下式给出：\n$$p_{k\\pm 1/2} = A_{k\\pm 1/2} + B_{k\\pm 1/2} p_s$$\n其中 $A_{k\\pm 1/2}$ 和 $B_{k\\pm 1/2}$ 是在该界面上定义的坐标系数。$A$ 系数的单位是压力，定义了坐标的纯压力部分，而无量纲的 $B$ 系数定义了 sigma 坐标部分。这就是界面气压的通用表达式。\n\n给定层 $k$ 的气压厚度，记为 $\\Delta p_k$，是界定该层的两个界面之间的气压差。根据问题的索引方式，层 $k$ 位于界面 $k-1/2$ 和界面 $k+1/2$ 之间。由于气压随着 $\\eta$ 的增加（从大气层顶向下）而增加，因此界面 $k+1/2$ 的气压大于 $k-1/2$ 处的气压。因此，气压厚度为：\n$$\\Delta p_k = p_{k+1/2} - p_{k-1/2}$$\n将界面气压的表达式代入此定义，得到：\n$$\\Delta p_k = (A_{k+1/2} + B_{k+1/2} p_s) - (A_{k-1/2} + B_{k-1/2} p_s)$$\n通过重新整理各项，我们得到层气压厚度的通用公式：\n$$\\Delta p_k = (A_{k+1/2} - A_{k-1/2}) + (B_{k+1/2} - B_{k-1/2}) p_s$$\n这些推导出的公式满足了问题的要求。\n\n### 层气压厚度 $\\Delta p_2$ 的计算\n\n问题要求计算第二层的气压厚度 $\\Delta p_2$。我们使用推导出的公式，并令 $k=2$：\n$$\\Delta p_2 = (A_{2+1/2} - A_{2-1/2}) + (B_{2+1/2} - B_{2-1/2}) p_s$$\n$$\\Delta p_2 = (A_{5/2} - A_{3/2}) + (B_{5/2} - B_{3/2}) p_s$$\n给定的系数和地表气压值为：\n- $p_s = 9.8\\times 10^{4}\\,\\mathrm{Pa}$\n- $A_{3/2} = 2.0\\times 10^{3}\\,\\mathrm{Pa}$\n- $B_{3/2} = 0.06$\n- $A_{5/2} = 1.4\\times 10^{4}\\,\\mathrm{Pa}$\n- $B_{5/2} = 0.35$\n\n首先，我们计算系数的差值：\n$$\\Delta A = A_{5/2} - A_{3/2} = 1.4\\times 10^{4}\\,\\mathrm{Pa} - 2.0\\times 10^{3}\\,\\mathrm{Pa} = 14000\\,\\mathrm{Pa} - 2000\\,\\mathrm{Pa} = 12000\\,\\mathrm{Pa}$$\n$$\\Delta B = B_{5/2} - B_{3/2} = 0.35 - 0.06 = 0.29$$\n现在，将这些差值和 $p_s$ 的值代入 $\\Delta p_2$ 的表达式中：\n$$\\Delta p_2 = 12000\\,\\mathrm{Pa} + (0.29) \\times (9.8\\times 10^{4}\\,\\mathrm{Pa})$$\n$$\\Delta p_2 = 12000\\,\\mathrm{Pa} + (0.29) \\times (98000\\,\\mathrm{Pa})$$\n$$\\Delta p_2 = 12000\\,\\mathrm{Pa} + 28420\\,\\mathrm{Pa}$$\n$$\\Delta p_2 = 40420\\,\\mathrm{Pa}$$\n第二层的气压厚度为 $40420\\,\\mathrm{Pa}$。",
            "answer": "$$\\boxed{40420}$$"
        },
        {
            "introduction": "虽然混合坐标功能强大，但其使用也引入了重大的数值挑战，尤其是在陡峭地形上。这个练习  深入探讨了最经典和最关键的问题之一：虚假的气压梯度力（PGF）误差。通过推导此误差的解析估计，您将深刻理解为何一个简单的数值实现会在静止的大气中产生人为的风，这对任何模型开发者或用户来说都是一个关键的见解。",
            "id": "3864018",
            "problem": "考虑一个在水平变化的地形上静止、流体静力平衡、水平均匀的大气。设几何高度为 $z$，水平坐标为 $x$，气压为 $p$。假设大气满足流体静力平衡 $ \\partial p / \\partial z = - \\rho g$（其中 $g$ 为重力加速度，$\\rho$ 为密度），并且真实大气状态在水平方向上是均匀的，即 $p$ 仅是 $z$ 的函数，因此 $ \\partial p / \\partial x \\big|_{z} = 0$。地面高程为 $z_{g}(x)$，地面气压为 $p_{s}(x) = p(z = z_{g}(x))$，它因地形而变化。\n\n模式的垂直坐标是混合气压坐标 $\\eta$，由广泛使用的映射 $p(\\eta, x) = A(\\eta) + B(\\eta) \\, p_{s}(x)$ 定义，其中 $A(\\eta)$ 和 $B(\\eta)$ 是给定的函数，满足在高空 $B(\\eta) \\to 0$ 且在近地面 $B(\\eta) \\to 1$。在此坐标系中，等 $\\eta$ 面上的水平气压梯度为 $ \\partial p / \\partial x \\big|_{\\eta}$，而等高面上的水平气压梯度通过链式法则与坐标变换后的梯度相关联。\n\n在一致的连续公式中，定义为 $- \\frac{1}{\\rho} \\nabla p$ 的气压梯度力 (PGF) 在此静止测试中产生零水平加速度，因为 $ \\partial p / \\partial x \\big|_{z} = 0$，其中 $ \\partial p / \\partial x \\big|_{\\eta}$ 与垂直度规项精确抵消。然而，假设一个数值实现在计算等 $\\eta$ 面上的水平 PGF 时，无意中忽略了实现这种抵消所需的垂直度规修正项。在小坡度条件和平滑场的假设下，推导由于此疏忽而产生的虚假水平加速度（即 PGF 误差）的主阶解析估计。\n\n你的推导必须从以下几点出发：\n- 流体静力平衡 $ \\partial p / \\partial z = - \\rho g$ 和 PGF 的定义 $- \\frac{1}{\\rho} \\nabla p$。\n- 在 $(x, z)$ 和 $(x, \\eta)$ 坐标系之间进行变换的链式法则。\n\n将最终的误差估计表示为单个闭合形式的表达式，用 $B(\\eta)$、地面气压的水平斜率 $ \\partial p_{s} / \\partial x$ 以及必要的热力学原始场来表示。不要引入任何经验调整常数，也不要假设除了在上述映射中的作用外，$A(\\eta)$ 或 $B(\\eta)$ 有任何特殊形式。你的最终答案必须是单个解析表达式。不需要进行数值评估。",
            "solution": "单位质量的气压梯度力 (PGF) 的水平分量由 $-\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x}$ 给出，其中偏导数是在恒定几何高度 $z$ 上计算的。问题指出，对于真实的大气状态，气压仅是高度的函数，这意味着 $\\frac{\\partial p}{\\partial x}\\big|_{z} = 0$。因此，真实的水平 PGF 为零，处于这种静止大气中的质点应经历零水平加速度。\n\n数值模式在混合坐标系 $(x, \\eta)$ 中运行。基于高度的坐标系 $(x, z)$ 和混合坐标系 $(x, \\eta)$ 中气压梯度之间的关系由偏导数的链式法则给出：\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{z} = \\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} + \\frac{\\partial p}{\\partial \\eta}\\bigg|_{x} \\frac{\\partial \\eta}{\\partial x}\\bigg|_{z}\n$$\n另一种更常见的变换是通过将 $p$ 视为 $x$ 和 $z$ 的函数，而 $z$ 又是 $x$ 和 $\\eta$ 的函数来找到的。这给出了：\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} = \\frac{\\partial p}{\\partial x}\\bigg|_{z} + \\frac{\\partial p}{\\partial z}\\bigg|_{x} \\frac{\\partial z}{\\partial x}\\bigg|_{\\eta}\n$$\n在连续公式中，正确的水平 PGF 可以使用 $\\eta$ 面上的梯度表示为：\n$$\n\\text{PGF}_x = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x}\\bigg|_{z} = -\\frac{1}{\\rho} \\left( \\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} - \\frac{\\partial z}{\\partial x}\\bigg|_{\\eta} \\frac{\\partial p}{\\partial z} \\right)\n$$\n问题指出，数值实现错误地只计算了第一项 $\\frac{\\partial p}{\\partial x}\\big|_{\\eta}$ 来计算 PGF，而忽略了作为垂直度规修正的第二项。因此，产生的虚假水平加速度 $a_{spurious}$ 为：\n$$\na_{spurious} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x}\\bigg|_{\\eta}\n$$\n为了找到该误差的解析表达式，我们必须计算 $\\frac{\\partial p}{\\partial x}\\big|_{\\eta}$。我们使用给定的混合气压坐标定义：\n$$\np(\\eta, x) = A(\\eta) + B(\\eta) \\, p_s(x)\n$$\n我们在保持 $\\eta$ 恒定的情况下，对该表达式关于 $x$ 求导。由于 $A(\\eta)$ 和 $B(\\eta)$ 仅是 $\\eta$ 的函数，因此在此偏微分中它们被视为常数。\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} = \\frac{\\partial}{\\partial x} \\left[ A(\\eta) + B(\\eta) \\, p_s(x) \\right] \\bigg|_{\\eta}\n$$\n应用求和法则以及 $\\frac{\\partial A(\\eta)}{\\partial x}\\big|_{\\eta} = 0$ 这一事实：\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} = 0 + \\frac{\\partial}{\\partial x} \\left[ B(\\eta) \\, p_s(x) \\right] \\bigg|_{\\eta}\n$$\n由于在 $\\eta$ 恒定时，$B(\\eta)$ 相对于 $x$ 是一个常数因子：\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} = B(\\eta) \\frac{\\partial p_s}{\\partial x}\n$$\n现在，我们将此结果代入我们的虚假加速度表达式中：\n$$\na_{spurious} = -\\frac{1}{\\rho} \\left( B(\\eta) \\frac{\\partial p_s}{\\partial x} \\right)\n$$\n这个表达式代表了由错误的 PGF 计算所产生的虚假水平加速度。它以给定的函数 $B(\\eta)$、地面气压的水平梯度 $\\frac{\\partial p_s}{\\partial x}$ 以及密度 $\\rho$（一个原始热力学场）来表示。这满足了问题的所有要求。\n\n这个结果凸显了地形跟随坐标模式中的一个关键问题：即使在没有实际作用力存在的静止大气中，对倾斜坐标面（$\\eta$ 面）上的气压梯度进行简单计算也会产生一个非零的、不符合物理规律的力。该力与依赖于地形的地面气压梯度成正比，并在垂直方向上受到函数 $B(\\eta)$ 的调制。",
            "answer": "$$\n\\boxed{-\\frac{1}{\\rho} B(\\eta) \\frac{\\partial p_{s}}{\\partial x}}\n$$"
        }
    ]
}