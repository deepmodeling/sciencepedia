## 引言
在构建能够模拟地球复杂气候系统的数值模型时，如何描述大气的垂直结构是一个基础而关键的选择。尽管几何高度看似最直观，但现代天气预报和气候模型几乎无一例外地采用了基于[大气压力](@entry_id:147632)的坐标系。这一选择的背后，蕴含着深刻的物理洞察和精巧的数学简化。[大气压力](@entry_id:147632)坐标系不仅是理论上的一个优美框架，更是驱动我们理解和预测大气行为的计算引擎的核心。

然而，从直观的几何世界过渡到抽象的压力世界并非没有挑战。虽然压力坐标系简化了动力学方程，但地球表面崎岖的地形却给这一理想化的框架带来了巨大的难题。本文旨在系统性地梳理[大气压力](@entry_id:147632)坐标系的理论、演进及其在实践中的应用，以解答为何以及如何使用这一关键工具。

在接下来的章节中，我们将开启一段从第一性原理到前沿应用的探索之旅。在“原理与机制”一章，我们将深入探讨将气压作为垂直坐标的理论依据，推导其在控制方程中的表达，并分析为克服地形挑战而设计的sigma坐标系与[混合坐标系](@entry_id:1126230)。随后，在“应用与跨学科联系”一章，我们将展示这些坐标系如何在[数值天气预报](@entry_id:191656)、气候诊断乃至[海洋学](@entry_id:149256)等领域发挥着不可或缺的作用。最后，“动手实践”部分将通过具体的计算问题，帮助读者将理论知识转化为解决实际问题的能力。让我们首先进入第一章，揭示压力坐标系背后的基本原理。

## 原理与机制

在上一章引言中，我们概述了在[地球系统模型](@entry_id:1124096)中采用不同[垂直坐标系](@entry_id:1133787)的动机。本章将深入探讨[大气环流模型](@entry_id:1125562)中应用最广泛的坐标系统——气压坐标系及其变体的基本原理与核心机制。我们将从第一性原理出发，推导气压作为垂直坐标的理论基础，阐述其在控制方程中的数学表达，分析其在处理地形时遇到的挑战，并最终介绍为解决这些挑战而设计的精巧方案，如sigma坐标系和[混合坐标系](@entry_id:1126230)。

### 将气压作为垂直坐标的理论基础

在直观上，几何高度（$z$坐标）似乎是描述大气垂直结构最自然的选择。然而，大气运动的驱动力，如气压[梯度力](@entry_id:166847)，直接与气压场相关。此外，大气的密度随高度呈指数级递减，这意味着在$z$坐标系中，单位垂直厚度所包含的大气质量在高层和低层差异巨大。这些因素促使科学家们寻找一种更符合大气动力学和[热力学](@entry_id:172368)特性的垂直坐标。气压（$p$）便是一个理想的候选者，但其作为坐标的合法性取决于一个关键前提：在任意给定的水平位置和时刻，气压必须是几何高度的[严格单调函数](@entry_id:158442)。

为了验证这一前提，我们需考察控制垂直运动的完整物理定律。[牛顿第二定律](@entry_id:274217)应用于垂直方向上的流体微元，其[动量方程](@entry_id:197225)为：
$$
\frac{Dw}{Dt} = -\frac{1}{\rho}\frac{\partial p}{\partial z} - g
$$
其中，$w$ 是几何高度坐标下的垂直速度，$D/Dt$ 是[物质导数](@entry_id:262900)，代表随流体微元移动的加速度，$\rho$ 是空气密度，$g$ 是[重力加速度](@entry_id:173411)。整理后可得[垂直气压梯度](@entry_id:1133794)：
$$
\frac{\partial p}{\partial z} = -\rho g - \rho \frac{Dw}{Dt} = -\rho g \left( 1 + \frac{1}{g} \frac{Dw}{Dt} \right)
$$
要使气压$p$成为高度$z$的严格单调递减函数，必须满足 $\partial p / \partial z  0$。由于$\rho > 0$且$g > 0$，这一条件等价于括号内的项为正，即 $1 + (1/g)(Dw/Dt) > 0$，或 $\frac{Dw}{Dt} > -g$。这意味着空气微元的总垂直加速度（如果向下）的量级必须小于[重力加速度](@entry_id:173411)$g$。

通过量纲分析，我们可以评估垂直加速度项的重要性。定义一个无量纲参数，类似于垂直[弗劳德数](@entry_id:271895)（Froude number），它代表了垂直[惯性力](@entry_id:169104)与重力之比：$\operatorname{Fr}_{v} = |\frac{Dw}{Dt}|/g$。对于大尺度天气系统，典型的垂直速度约为 $0.1 \, \mathrm{m\,s^{-1}}$，时间尺度约为 $10^4 \, \mathrm{s}$，因此垂直加速度的量级为 $10^{-5} \, \mathrm{m\,s^{-2}}$，$\operatorname{Fr}_{v}$ 约为 $10^{-6}$。在这种情况下，$\operatorname{Fr}_{v} \ll 1$，垂直加速度项 $\rho(Dw/Dt)$ 相对于重力项 $\rho g$ 可以忽略不计。此时，[垂直动量方程](@entry_id:1133792)简化为**[静力平衡](@entry_id:163498)**（hydrostatic balance）近似：
$$
\frac{\partial p}{\partial z} \approx -\rho g
$$
在[静力平衡](@entry_id:163498)的条件下，$\partial p / \partial z$ 始终为负，保证了气压是高度的[严格单调函数](@entry_id:158442)，从而确立了其作为有效垂直坐标的地位。然而，在某些强烈的非静力过程中，例如深对流、重力波破碎或爆炸性下击暴流中，垂直加速度的量级可能接近$g$，导致$\operatorname{Fr}_{v} \sim 1$。在这种情况下，$p(z)$的[单调性](@entry_id:143760)可能在局部和瞬时被破坏，使得任何基于气压的坐标系在该区域失效 。尽管如此，对于全球和区域尺度的大部分大气建模应用，[静力平衡近似](@entry_id:1126281)及其所保证的气压[单调性](@entry_id:143760)是高度有效的。

### 气压坐标系下的控制方程

一旦确立了气压作为有效的垂直坐标，我们就可以将大气控制方程从 $(x, y, z, t)$ [坐标系转换](@entry_id:263003)到 $(x, y, p, t)$ 坐标系。这一转换极大地简化了某些方程的形式，特别是质量连续性方程和气压[梯度力](@entry_id:166847)。

#### 质量连续性方程

在 $z$ 坐标系中，可压缩流体的质量[连续性方程](@entry_id:195013)为：
$$
\frac{\partial \rho}{\partial t} + \nabla_z \cdot (\rho \mathbf{u}) + \frac{\partial (\rho w)}{\partial z} = 0
$$
其中 $\mathbf{u}$ 是水平[速度矢量](@entry_id:269648)，$w$ 是 $z$ 坐标系下的垂直速度，$\nabla_z$ 是在等 $z$ 面上的水平散度算子。

要将其转换到 $p$ 坐标系，我们利用[静力平衡](@entry_id:163498)关系。在静力大气中，单位水平面积上、垂直厚度为 $dz$ 的气柱质量为 $dm = \rho \, dz$。利用[静力平衡](@entry_id:163498) $\partial p / \partial z = -\rho g$，我们得到 $dz = -dp/(\rho g)$。因此，气柱质量可以表示为 $dm = \rho (-dp/(\rho g)) = -dp/g$。这意味着在两个气压面 $p$ 和 $p+dp$ 之间，单位水平面积的大气质量为 $|-dp/g|$，它与密度 $\rho$ 无关。正是这一特性使得 $p$ 坐标系成为一种**质量坐标**。

通过严谨的坐标变换，并利用[静力平衡](@entry_id:163498)假设，可以证明质量连续性方程在 $p$ 坐标系中呈现出一种极其简洁的诊断形式 ：
$$
\nabla_p \cdot \mathbf{u} + \frac{\partial \omega}{\partial p} = 0
$$
这里的 $\nabla_p$ 表示在等压面上的水平散度。方程中不再出现密度 $\rho$ 或时间倾向项。新的垂直速度**omega** ($\omega$) 被定义为气块的总气压变化率，即物质导数 $\omega \equiv Dp/Dt$。这个方程的形式类似于[不可压缩流体的连续性方程](@entry_id:173361)，表明在等压坐标系中，水平质量通量的辐合（辐散）必须由垂直质量通量的变化来精确补偿。

值得注意的是，$p$ 坐标系下的垂直速度 $\omega$ 与 $z$ 坐标系下的 $w$ 并非简单的线性关系。它们之间的精确关系为：
$$
\omega = \frac{Dp}{Dt} = \left(\frac{\partial p}{\partial t}\right)_{z} + \mathbf{u} \cdot (\nabla_h p)_{z} + w \frac{\partial p}{\partial z}
$$
应用[静力平衡](@entry_id:163498)后，得到：
$$
\omega = \left(\frac{\partial p}{\partial t}\right)_{z} + \mathbf{u} \cdot (\nabla_h p)_{z} - \rho g w
$$
其中 $(\partial p/\partial t)_z$ 是在固定高度上的局地气压变化（例如[气压计](@entry_id:147792)的读数变化），$\mathbf{u} \cdot (\nabla_h p)_z$ 是水平气压平流。只有当这两个非绝热项可以忽略时，才近似有 $\omega \approx -\rho g w$。通常情况下，$\omega  0$ 对应于上升运动（气压减小），$\omega > 0$ 对应于下沉运动（气压增大）。

#### 气压[梯度力](@entry_id:166847)

在 $z$ 坐标系中，水平气压[梯度力](@entry_id:166847)（PGF）为 $-(1/\rho)\nabla_z p$。转换到 $p$ 坐标系后，PGF 变为 $-\nabla_p \Phi$，其中 $\Phi = gz$ 是位势。这一形式的优点是密度 $\rho$ 从表达式中消失了，从而避免了在计算 PGF 时需要知道密度，简化了数值计算。然而，这也带来了一个新的挑战：地形。在 $p$ 坐标系中，地球表面不再是一个坐标面，而是一个随空间和时间变化的复杂边界 $p=p_s(x,y,t)$，它会穿插切割等压坐标面，给边界条件的数值处理带来极大困难 。

### 地形挑战与Sigma坐标系

为了解决纯气压坐标系在处理地形方面的困难，N. A. Phillips 于1957年引入了**sigma坐标系**（$\sigma$-coordinate）。其核心思想是使用一个归一化的气压坐标，使得地表（和模式顶）成为一个坐标面。一个常见的定义是：
$$
\sigma = \frac{p}{p_s(x,y,t)}
$$
或更通用的形式，包含一个固定的模式顶气压 $p_t$ ：
$$
\sigma = \frac{p - p_t}{p_s(x,y,t) - p_t}
$$
在这个坐标系中，模式顶始终是 $\sigma=0$（假设$p=p_t$），地表始终是 $\sigma=1$（假设$p=p_s$）。地形的影响现在通过表面气压 $p_s(x,y,t)$ 完全融入到坐标系自身的定义中。由[静力平衡](@entry_id:163498)可知，地表气压是其上方整个气柱重量的体现：$p_s(x,y,t) = p_t + \int_{z_s(x,y)}^{z_{\text{top}}} \rho g \, dz$。因此，地形高度 $z_s$ 越高，其上方的气柱越短，表面气压 $p_s$ 就越低 。

Sigma坐标系作为一种质量[混合坐标](@entry_id:1126228)，继承了气压坐标在质量守恒方面的优良特性。在[静力平衡](@entry_id:163498)下，整个气柱的质量可以精确地表示为 $M = (p_s - p_t)/g$。由于模式的顶界和底界都是坐标面，垂直方向的质量通量在这些边界上为零。因此，当控制方程以[通量形式](@entry_id:273811)离散化时，全球积分的总质量可以达到[机器精度](@entry_id:756332)的守恒 。

### Sigma坐标系中的气压[梯度力](@entry_id:166847)误差

尽管sigma坐标系巧妙地解决了地形边界问题，但它也引入了一个严重的数值难题——**气压[梯度力](@entry_id:166847)误差**（Pressure Gradient Force error）。这个问题的根源在于，在有地形的区域，$\sigma$坐标面不再是水平的，而是倾斜的。

我们需要计算的物理量是等高面上的气压[梯度力](@entry_id:166847)，即 $-(1/\rho)\nabla_z p$ 或等价的 $-\nabla_p \Phi$。但在sigma坐标模型中，[数值导数](@entry_id:752781)是在倾斜的 $\sigma$ 面上计算的。利用链式法则，我们可以将 $z$ 坐标系下的PGF转换到 $\sigma$ 坐标系下。一个关键的变换关系是：
$$
(\nabla p)_z = (\nabla p)_\sigma - \frac{\partial p}{\partial \sigma} \frac{\partial \sigma}{\partial z} (\nabla z)_\sigma
$$
经过一系列推导，最终的PGF表达式可以写成两个主要部分的和 ：
$$
\text{PGF} = -\nabla_\sigma \Phi - \frac{RT}{p_s - p_t} \sigma \nabla p_s
$$
（这是一个简化的形式，用以说明问题）。在有陡峭地形的区域，表面气压梯度 $\nabla p_s$ 很大，导致 $\sigma$ 面也随之倾斜。结果是，上式右边的两项——位势在 $\sigma$ 面上的梯度和与地形坡度相关的“度规项”——都可能变得非常大，但它们的符号相反。真实的PGF往往是这两个大项相减后得到的一个很小的值。

在计算机的离散网格上，这两个大项都存在[截断误差](@entry_id:140949)。当两个巨大的、几乎相等的数值相减时，它们各自的微小计算误差会被放大，最终得到的差值（即PGF）可能会被这些误差严重污染，产生一个虚假的、不存在的力。这个**虚假气压[梯度力](@entry_id:166847)**会错误地驱动气流，尤其是在山区上空，可能导致模拟结果出现严重偏差，甚至数值不稳定 。

### 混合Sigma-气压坐标系

为了克服纯sigma坐标系的PGF误差问题，同时保留其在近地面处理地形的优势，现代大气模型普遍采用**混合sigma-气压坐标系**（hybrid sigma-pressure coordinate）。这种坐标系旨在实现一个平滑的过渡：在靠近地面的低层大气中，它表现得像一个sigma坐标；而在远离地形影响的高层大气中，它逐渐转变为一个纯气压坐标。

[混合坐标](@entry_id:1126228)的通用形式定义为 ：
$$
p(\eta, x, y, t) = A(\eta) + B(\eta) p_s(x, y, t)
$$
其中，$\eta$ 是新的[混合垂直坐标](@entry_id:1126250)（通常从顶部的0增加到底部的1），$A(\eta)$ 和 $B(\eta)$ 是预先设定的、只依赖于 $\eta$ 的平滑函数。这两个函数的设计是实现坐标过渡的关键：

*   **在高层（$\eta \to 0$）**：为了消除PGF误差，我们希望坐标面接近水平的等压面。这通过设定 $B(\eta) \to 0$ 来实现。此时，$p(\eta) \approx A(\eta)$，坐标面的气压不再依赖于地面气压 $p_s$，从而消除了地形引起的倾斜。
*   **在近地面（$\eta \to 1$）**：为了精确描述边界层过程，我们希望坐标面能贴合地形。这通过设定 $B(\eta) \to 1$ 和 $A(\eta) \to 0$ 来实现。此时，$p(\eta) \approx p_s$，坐标的行为与纯sigma坐标类似。

为了满足这些要求，函数 $A(\eta)$ 和 $B(\eta)$ 必须遵循特定的边界条件。假设模式顶为常数气压 $p_t$，则必须满足  ：
*   在模式顶（$\eta=0$）: $p(0) = p_t \implies A(0) + B(0)p_s = p_t$。为使此式对所有 $p_s$ 成立，必须有 $B(0)=0$ 和 $A(0)=p_t$。
*   在地表（$\eta=1$）: $p(1) = p_s \implies A(1) + B(1)p_s = p_s$。为使此式对所有 $p_s$ 成立，必须有 $B(1)=1$ 和 $A(1)=0$。

除了边界条件，函数的平滑性也至关重要。例如，为了进一步减小高层的PGF误差，通常要求 $B(\eta)$ 在 $\eta \to 0$ 时不仅趋于0，其导数也趋于0，即 $B'(0)=0$。这确保了坐标面坡度的垂直变化在高层也趋于平缓。一个满足这些条件的[简单函数](@entry_id:137521)选择是 $B(\eta) = \eta^3$，而一个简单的线性函数 $B(\eta) = \eta$ 则不满足 $B'(0)=0$ 的平滑性要求。此外，还需确保在任何高度，$\partial p / \partial \eta > 0$，以保证坐标的[单调性](@entry_id:143760)和非零的垂直层厚度 。通过这种精心设计，[混合坐标系](@entry_id:1126230)成功地在处理地形的便利性和减小高层[数值误差](@entry_id:635587)之间取得了有效的平衡。此外，通过对PGF项进行解析重构，例如引入位势或焓基变量，可以在离散化之前整合大的相反项，从而进一步减轻数值抵消误差 。

### [数值离散化](@entry_id:752782)与垂直交错网格

将连续的控制方程转化为可在计算机上求解的离散形式时，变量在网格上的布局——即**[网格交错](@entry_id:1125805)**（staggering）——对模型的精度和稳定性有深远影响。对于垂直方向，两种经典的交错方案是**[Lorenz网格](@entry_id:1127458)**和**[Charney-Phillips网格](@entry_id:1122314)** 。

*   **Lorenz交错网格**：将[热力学变量](@entry_id:160587)（如温度 $T$、位温 $\theta$）和水平动量（$u, v$）定义在模型层的中心（“整层”或“质量层”），而将垂直运动变量（如 $\omega$）和位势 $\Phi$ 定义在层的界面上（“半层”）。

*   **Charney-Phillips (C-P) [交错网格](@entry_id:1125805)**：将水平动量（$u, v$）保留在整层，但将决定静力关系的[热力学变量](@entry_id:160587)（如 $\theta$）移动到半层，与 $\Phi$ 和 $\omega$ 布置在一起。

这两种方案在离散[静力平衡](@entry_id:163498)和静力稳定度的表达上存在根本差异。在[Lorenz网格](@entry_id:1127458)中，一个模型层的位势厚度仅由该层自身的温度决定。这种[解耦](@entry_id:160890)结构会产生一个非物理的、高频的计算波模，即垂直温度廓线可能出现“锯齿状”的震荡，而这种震荡几乎不影响位势场，从而难以被模型的动力过程抑制。

相比之下，[Charney-Phillips网格](@entry_id:1122314)通过将 $\theta$ 放置在层结界面，天然地将相邻层在静力计算中耦合起来，从而有效抑制了上述计算波模。更重要的是，它为静力稳定度（通常用布伦特-维萨拉频率 $N^2$ 度量，$N^2 \propto \partial \theta / \partial z$）的计算提供了巨大优势。在C-P网格中，计算一个模型层的稳定度所需的位温垂直梯度，可以直接通过上下两个界面的 $\theta$ 值进行[中心差分](@entry_id:173198)，无需任何插值。而在[Lorenz网格](@entry_id:1127458)中，则需要对整层的 $\theta$ 值进行插值才能得到界面上的值，这会引入额外的误差。因此，Charney-Phillips[交错网格](@entry_id:1125805)能够更准确、更稳健地表示静力稳定度，这对于精确模拟重力[内波](@entry_id:261048)的传播等依赖于大气层结特性的现象至关重要 。

综上所述，从选择气压作为垂直坐标，到设计sigma和[混合坐标](@entry_id:1126228)以应对地形，再到通过交错网格优化数值离散，每一步都体现了大气建模中物理原理与数值方法之间的深刻互动。这些原理与机制共同构成了现代[地球系统模型](@entry_id:1124096)动力核心的基石。