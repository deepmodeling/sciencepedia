{
    "hands_on_practices": [
        {
            "introduction": "任何大气数值模型的第一步都是建立其离散的计算网格。本练习将引导你完成一个基础但至关重要的任务：在广义混合坐标系中，根据给定的系数和地表气压，计算模型中不同层次的界面气压和层内气压厚度。通过这个实践 ，你将掌握将连续的垂直坐标定义应用于离散化模型列中的核心技能。",
            "id": "3863962",
            "problem": "考虑一个静力平衡大气，其模型采用广义混合垂直气压坐标。其中，独立的垂直坐标是一个无量纲变量 $\\eta$，它从大气层顶 (TOA) 的 $\\eta=0$ 单调增加到地表的 $\\eta=1$。地表气压为 $p_s$，它在水平方向上变化，但在我们所考虑的气柱内是恒定的。该模型将气柱离散化为 $N$ 层，由 $N+1$ 个界面界定。这些界面位于离散层级 $\\eta_{k\\pm 1/2}$（其中 $k=1,\\dots,N$），且满足 $\\eta_{1/2}=0$ 和 $\\eta_{N+1/2}=1$。\n\n从设计一个在静力平衡和水平变化地表气压下保持质量守恒的坐标系所需的第一性原理出发，推导界面气压 $p_{k\\pm 1/2}$ 关于地表气压 $p_s$ 和一对与界面相关的系数的表达式，然后推导相应的层气压厚度 $\\Delta p_k$ 作为界面气压之差。您的推导必须明确说明所使用的物理和数学约束。\n\n对于一个三层气柱（$N=3$），四个界面的混合系数指定如下：\n- 在大气层顶：$A_{1/2}=0\\,\\mathrm{Pa}$ 且 $B_{1/2}=0$，\n- 第一个内部界面：$A_{3/2}=2.0\\times 10^{3}\\,\\mathrm{Pa}$ 且 $B_{3/2}=0.06$，\n- 第二个内部界面：$A_{5/2}=1.4\\times 10^{4}\\,\\mathrm{Pa}$ 且 $B_{5/2}=0.35$，\n- 在地表：$A_{7/2}=0\\,\\mathrm{Pa}$ 且 $B_{7/2}=1$。\n\n假设气柱地表气压 $p_s=9.8\\times 10^{4}\\,\\mathrm{Pa}$。使用您推导的公式，计算第二层的气压厚度 $\\Delta p_2$。以帕斯卡为单位给出您的最终数值答案。请给出精确值，无需四舍五入。",
            "solution": "在尝试任何解答之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 大气是静力平衡的。\n- 垂直坐标是广义混合气压坐标 $\\eta$，是无量纲的。\n- $\\eta$ 从大气层顶 (TOA) 的 $\\eta=0$ 单调增加到地表的 $\\eta=1$。\n- 地表气压为 $p_s$。\n- 模型气柱有 $N$ 层和 $N+1$ 个界面，位于层级 $\\eta_{k\\pm 1/2}$（其中 $k=1, \\dots, N$）。\n- 大气层顶界面：$\\eta_{1/2}=0$。\n- 地表界面：$\\eta_{N+1/2}=1$。\n- 对于 $N=3$ 的特定情况：\n    - 界面 $\\eta_{1/2}$：$A_{1/2}=0\\,\\mathrm{Pa}$，$B_{1/2}=0$。\n    - 界面 $\\eta_{3/2}$：$A_{3/2}=2.0\\times 10^{3}\\,\\mathrm{Pa}$，$B_{3/2}=0.06$。\n    - 界面 $\\eta_{5/2}$：$A_{5/2}=1.4\\times 10^{4}\\,\\mathrm{Pa}$，$B_{5/2}=0.35$。\n    - 界面 $\\eta_{7/2}$：$A_{7/2}=0\\,\\mathrm{Pa}$，$B_{7/2}=1$。\n- 对于数值计算，地表气压为 $p_s=9.8\\times 10^{4}\\,\\mathrm{Pa}$。\n- 任务是推导界面气压 $p_{k\\pm 1/2}$ 和层气压厚度 $\\Delta p_k$ 的表达式，然后计算给定情况下的 $\\Delta p_2$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于混合sigma-气压垂直坐标的概念，这是现代数值天气预报和气候模拟中的一项标准和基础技术。静力平衡假设是大尺度大气动力学的基石。该问题在科学上是合理的，并且在气象科学领域是公认的。\n- **适定性**：该问题提供了推导所需公式和计算特定值所必需的所有定义、系数和边界条件。它要求先推导再应用，从而得到一个唯一、稳定且有意义的解。\n- **客观性**：该问题以精确的技术语言陈述，没有任何主观或模棱两可的术语。\n- **一致性检查**：混合气压坐标的一般形式通过两组系数 $A(\\eta)$ 和 $B(\\eta)$ 将 $\\eta$ 层上的气压 $p$ 与地表气压 $p_s$ 联系起来。标准定义是 $p(\\eta) = A(\\eta) + B(\\eta)p_s$。我们来检查给定的边界条件。\n    - 在大气层顶，$\\eta_{1/2}=0$。期望的气压为 $p_{1/2}=0$（一个常见的简化）。使用给定的系数：$p_{1/2} = A_{1/2} + B_{1/2} p_s = 0 + 0 \\cdot p_s = 0$。这是一致的。\n    - 在地表，$\\eta_{N+1/2}=1$，对于 $N=3$ 则是 $\\eta_{7/2}=1$。期望的气压是地表气压 $p_s$。使用给定的系数：$p_{7/2} = A_{7/2} + B_{7/2}p_s = 0 + 1 \\cdot p_s = p_s$。这也是一致的。\n- 所有其他验证标准（例如，非平凡性、可验证性、现实性）都得到满足。所提供的系数和地表气压值在物理上是现实的。\n\n### 步骤 3：结论与行动\n问题被确定为 **有效**。将按要求提供解答。\n\n### 气压公式推导\n\n广义混合垂直坐标的设计基于创建一个单调函数 $p(\\eta)$，该函数从高层大气中的纯气压坐标平滑过渡到地表附近的地形追随sigma坐标（$\\sigma = p/p_s$）。这使得坐标面在远离地形处能够保持平坦，从而最小化数值误差，同时在下边界又能追随地形。\n\n这种坐标系的一个广泛使用的公式将给定 $\\eta$ 层上的气压 $p$ 定义为一个基于气压的分量和一个基于地表气压的分量的线性组合。对于一个离散的界面层级 $\\eta_{k\\pm 1/2}$，其气压 $p_{k\\pm 1/2}$ 由下式给出：\n$$p_{k\\pm 1/2} = A_{k\\pm 1/2} + B_{k\\pm 1/2} p_s$$\n其中 $A_{k\\pm 1/2}$ 和 $B_{k\\pm 1/2}$ 是在该界面上定义的坐标系数。系数 $A$ 具有气压单位，定义了坐标的纯气压部分，而无量纲的系数 $B$ 定义了sigma坐标部分。这就是界面气压的通用表达式。\n\n给定层 $k$ 的气压厚度，记为 $\\Delta p_k$，是界定该层的两个界面之间的气压差。根据问题的索引方式，第 $k$ 层位于界面 $k-1/2$ 和界面 $k+1/2$ 之间。由于气压随 $\\eta$ 的增加（从大气层顶向下）而增加，因此界面 $k+1/2$ 处的气压大于 $k-1/2$ 处的气压。因此，气压厚度为：\n$$\\Delta p_k = p_{k+1/2} - p_{k-1/2}$$\n将界面气压的表达式代入此定义，得到：\n$$\\Delta p_k = (A_{k+1/2} + B_{k+1/2} p_s) - (A_{k-1/2} + B_{k-1/2} p_s)$$\n通过重新整理各项，我们得到层气压厚度的通用公式：\n$$\\Delta p_k = (A_{k+1/2} - A_{k-1/2}) + (B_{k+1/2} - B_{k-1/2}) p_s$$\n这些推导出的公式满足了问题的要求。\n\n### 第二层气压厚度 $\\Delta p_2$ 的计算\n\n问题要求计算第二层的气压厚度 $\\Delta p_2$。我们使用 $k=2$ 的推导公式：\n$$\\Delta p_2 = (A_{2+1/2} - A_{2-1/2}) + (B_{2+1/2} - B_{2-1/2}) p_s$$\n$$\\Delta p_2 = (A_{5/2} - A_{3/2}) + (B_{5/2} - B_{3/2}) p_s$$\n给定的系数和地表气压值为：\n- $p_s = 9.8\\times 10^{4}\\,\\mathrm{Pa}$\n- $A_{3/2} = 2.0\\times 10^{3}\\,\\mathrm{Pa}$\n- $B_{3/2} = 0.06$\n- $A_{5/2} = 1.4\\times 10^{4}\\,\\mathrm{Pa}$\n- $B_{5/2} = 0.35$\n\n首先，我们计算系数的差值：\n$$\\Delta A = A_{5/2} - A_{3/2} = 1.4\\times 10^{4}\\,\\mathrm{Pa} - 2.0\\times 10^{3}\\,\\mathrm{Pa} = 14000\\,\\mathrm{Pa} - 2000\\,\\mathrm{Pa} = 12000\\,\\mathrm{Pa}$$\n$$\\Delta B = B_{5/2} - B_{3/2} = 0.35 - 0.06 = 0.29$$\n现在，将这些差值和 $p_s$ 的值代入 $\\Delta p_2$ 的表达式中：\n$$\\Delta p_2 = 12000\\,\\mathrm{Pa} + (0.29) \\times (9.8\\times 10^{4}\\,\\mathrm{Pa})$$\n$$\\Delta p_2 = 12000\\,\\mathrm{Pa} + (0.29) \\times (98000\\,\\mathrm{Pa})$$\n$$\\Delta p_2 = 12000\\,\\mathrm{Pa} + 28420\\,\\mathrm{Pa}$$\n$$\\Delta p_2 = 40420\\,\\mathrm{Pa}$$\n第二层的气压厚度是 $40420\\,\\mathrm{Pa}$。",
            "answer": "$$\\boxed{40420}$$"
        },
        {
            "introduction": "从复杂的混合坐标系回到其简化的前身——纯地形追随坐标（$ \\sigma $坐标），可以帮助我们揭示一个核心物理原理。本练习旨在通过推导坐标变换的雅可比行列式 $ \\partial p / \\partial \\sigma $ 来探索其物理内涵。这个推导  将揭示为什么 $ \\sigma $ 坐标系统本质上是一个质量坐标，以及它如何简化了模型中的质量守恒计算。",
            "id": "3863963",
            "problem": "考虑一个在恒定重力加速度 $g$ 下的静力平衡大气，其垂直坐标为地形跟随压力坐标 $\\sigma$，定义为 $\\sigma = p/p_{s}$，其中 $p$ 为气压，$p_{s}$ 为地面气压。在一个固定的水平位置 $(x_{0},y_{0})$ 和时间 $t_{0}$ 进行分析，因此 $p_{s}=p_{s}(x_{0},y_{0},t_{0})$ 在该时空点上是相对于 $\\sigma$ 变化的常数。\n\n仅从 $\\sigma$ 的定义和静力平衡关系出发，推导在固定位置 $(x_{0},y_{0},t_{0})$ 的雅可比式 $\\partial p/\\partial \\sigma$，然后利用静力平衡关系，用 $p_{s}$、$g$ 和 $\\Delta \\sigma$ 表示跨越 $\\sigma$ 到 $\\sigma+\\Delta \\sigma$ 的薄层的单位面积质量。清晰地阐明您所推导的雅可比式在单位面积气柱质量每单位 $\\sigma$ 厚度方面的物理意义。\n\n将在固定位置 $(x_{0},y_{0},t_{0})$ 求得的雅可比式 $\\partial p/\\partial \\sigma$ 的解析表达式作为您的最终答案。无需四舍五入。最终答案中不要包含单位。",
            "solution": "问题陈述被评估为有效，因为它在科学上基于大气物理学的既定原理，提法得当，目标明确，信息充分，并使用了精确、客观的语言。该问题是大气模拟领域的一个标准推导。\n\n解答过程按问题陈述的要求分为三个部分。首先，我们推导雅可比式 $\\frac{\\partial p}{\\partial \\sigma}$。其次，我们推导厚度为 $\\Delta \\sigma$ 的气层的单位面积质量。第三，我们阐明雅可比式的物理意义。\n\n**第一部分：推导雅可比式 $\\frac{\\partial p}{\\partial \\sigma}$**\n\n问题给出了地形跟随压力坐标 $\\sigma$ 的定义：\n$$ \\sigma = \\frac{p}{p_s} $$\n其中 $p$ 是气压，$p_s$ 是地面气压。我们被要求在固定的水平位置 $(x_{0}, y_{0})$ 和时间 $t_{0}$ 计算雅可比式。在该特定点，地面气压 $p_s = p_s(x_{0}, y_{0}, t_{0})$ 相对于垂直坐标 $\\sigma$ 是一个常数。\n\n为了求出雅可比式 $\\frac{\\partial p}{\\partial \\sigma}$，我们首先将 $p$ 表示为 $\\sigma$ 的函数。根据定义，我们可以写出：\n$$ p = \\sigma p_s $$\n现在，我们对 $p$ 求关于 $\\sigma$ 的偏导数。由于我们处于一个固定的水平位置和时间，因此在这个微分中，$p_s$ 被视为一个常数。\n$$ \\frac{\\partial p}{\\partial \\sigma} = \\frac{\\partial}{\\partial \\sigma} (\\sigma p_s) $$\n应用微分法则，其中 $p_s$ 是常数：\n$$ \\frac{\\partial p}{\\partial \\sigma} = p_s \\frac{\\partial \\sigma}{\\partial \\sigma} = p_s \\cdot 1 $$\n因此，雅可比式为：\n$$ \\frac{\\partial p}{\\partial \\sigma} = p_s $$\n\n**第二部分：薄层中的单位面积质量**\n\n第二个要求是利用静力平衡关系来求出薄大气层的单位面积质量。静力平衡方程将气压 $p$ 的变化与位势高度 $z$ 联系起来：\n$$ \\frac{dp}{dz} = -\\rho g $$\n其中 $\\rho$ 是空气密度，$g$ 是恒定的重力加速度。负号表示气压随高度增加而减小。\n\n考虑一个厚度为 $dz$、单位水平面积（$A=1$）的大气薄垂直切片。该切片的质量为 $dm = \\rho \\cdot dV = \\rho \\cdot (A \\cdot dz) = \\rho dz$。这是一个无限薄层的单位面积质量。\n从静力平衡方程，我们可以用气压微分 $dp$ 来表示这个单位面积质量：\n$$ \\rho dz = -\\frac{1}{g} dp $$\n因此，单位面积的质量微分为 $dM_A = -\\frac{1}{g} dp$。\n\n为了求出跨越某气压差的气层的单位面积质量 $\\Delta M_A$，我们对此表达式进行积分。对于一个由较高气压 $p_1$ 和较低气压 $p_2$（即 $p_1 > p_2$）界定的气层，其质量为：\n$$ \\Delta M_A = \\int_{p_2}^{p_1} \\frac{1}{g} dp = \\frac{p_1 - p_2}{g} $$\n这个结果证实了一个气层的单位面积质量是该层两端的压差除以 $g$。\n\n现在，我们将此应用于 $\\sigma$ 坐标系。问题要求计算从 $\\sigma$ 到 $\\sigma + \\Delta\\sigma$ 跨越的气层中的质量。在标准大气模型中，地面处 $\\sigma=1$（$p=p_s$），大气层顶 $\\sigma \\to 0$（$p \\to 0$）。因此，$\\sigma$ 的增加对应于高度的减少和气压的增加。设该层由层面 $\\sigma_{lower} = \\sigma + \\Delta\\sigma$ 和 $\\sigma_{upper} = \\sigma$ 界定，其中 $\\Delta\\sigma$ 是一个小的正量。对应的气压为 $p_1 = p(\\sigma + \\Delta\\sigma)$ 和 $p_2 = p(\\sigma)$。\n\n使用我们的关系式 $p = \\sigma p_s$，我们有：\n$$ p_1 = (\\sigma + \\Delta\\sigma) p_s $$\n$$ p_2 = \\sigma p_s $$\n将这些代入 $\\Delta M_A$ 的表达式中：\n$$ \\Delta M_A = \\frac{(\\sigma + \\Delta\\sigma)p_s - \\sigma p_s}{g} = \\frac{\\sigma p_s + \\Delta\\sigma p_s - \\sigma p_s}{g} $$\n$$ \\Delta M_A = \\frac{p_s}{g} \\Delta\\sigma $$\n这就是用 $p_s$，$g$ 和 $\\Delta\\sigma$ 表示的厚度为 $\\Delta\\sigma$ 的气层的单位面积质量的所求表达式。\n\n**第三部分：雅可比式的物理意义**\n\n雅可比式 $\\frac{\\partial p}{\\partial \\sigma}$ 的物理意义可以通过联系上面推导出的两个结果来理解。\n从第二部分，我们发现厚度为 $\\Delta\\sigma$ 的气层的单位面积质量为 $\\Delta M_A = \\frac{p_s}{g} \\Delta\\sigma$。\n我们可以将单位面积每单位 $\\sigma$ 厚度的质量定义为比率 $\\frac{\\Delta M_A}{\\Delta\\sigma}$。在 $\\Delta\\sigma \\to 0$ 的极限情况下，这变成了一个导数：\n$$ \\frac{d M_A}{d\\sigma} = \\lim_{\\Delta\\sigma \\to 0} \\frac{\\Delta M_A}{\\Delta\\sigma} = \\frac{p_s}{g} $$\n这个量代表了用 $\\sigma$ 坐标表示的垂直方向上的质量分布。值得注意的是，在 $\\sigma$ 空间中的这个质量“密度”$\\frac{p_s}{g}$ 是恒定的。这意味着在 $\\sigma$ 中的相等区间包含等量的单位面积质量，这是 $\\sigma$ 坐标系的一个关键特征。\n\n现在，让我们把它和雅可比式联系起来。我们发现雅可比式是 $\\frac{\\partial p}{\\partial \\sigma} = p_s$。\n通过将 $p_s$ 代入每单位 $\\sigma$ 质量的表达式中，我们得到一个直接关系：\n$$ \\frac{d M_A}{d\\sigma} = \\frac{1}{g} \\frac{\\partial p}{\\partial \\sigma} $$\n整理后得到：\n$$ \\frac{\\partial p}{\\partial \\sigma} = g \\frac{d M_A}{d\\sigma} $$\n这个方程提供了一个清晰的物理释义。雅可比式 $\\frac{\\partial p}{\\partial \\sigma}$ 描述了气压如何随垂直坐标 $\\sigma$ 变化，它等于重力加速度 $g$ 乘以单位面积气柱质量每单位 $\\sigma$ 厚度。\n\n此外，地面气压 $p_s$ 本身代表了单位面积大气柱的总重量。单位面积大气柱的总质量 $M_{total}$ 是 $M_{total} = p_s/g$。因此，雅可比式 $\\frac{\\partial p}{\\partial \\sigma} = p_s$ 等于单位面积大气的总重量。它的值决定了归一化的气压坐标 $\\sigma$ 和大气中实际质量分布之间的缩放关系。",
            "answer": "$$\\boxed{p_s}$$"
        },
        {
            "introduction": "尽管地形追随坐标在处理复杂地形方面具有优势，但它们也引入了独特的数值挑战。本高阶练习将深入探讨一个经典问题：在跨越地形的恒定坐标面上计算气压梯度力时所产生的伪（非物理）加速度。通过分析这个误差的来源 ，你将理解在坐标变换中正确处理度量项以保证物理守恒性的极端重要性。",
            "id": "3864018",
            "problem": "考虑在水平变化的地形上，一个静止、静力平衡且水平均匀的大气。设几何高度为 $z$，水平坐标为 $x$，气压为 $p$。假设大气满足静力平衡 $ \\partial p / \\partial z = - \\rho g$（其中 $g$ 为重力加速度，$\\rho$ 为密度），并且真实大气状态是水平均匀的，即 $p$ 仅是 $z$ 的函数，因此 $ \\partial p / \\partial x \\big|_{z} = 0$。地面高程为 $z_{g}(x)$，地面气压为 $p_{s}(x) = p(z = z_{g}(x))$，它因地形而变化。\n\n模式的垂直坐标是混合气压坐标 $\\eta$，它通过广泛使用的映射 $p(\\eta, x) = A(\\eta) + B(\\eta) \\, p_{s}(x)$ 定义，其中 $A(\\eta)$ 和 $B(\\eta)$ 是给定的函数，满足高层 $B(\\eta) \\to 0$ 且近地表 $B(\\eta) \\to 1$。在此坐标系中，恒定 $\\eta$ 面上的水平气压梯度为 $ \\partial p / \\partial x \\big|_{\\eta}$，而恒定高度面上的水平气压梯度通过链式法则与坐标变换后的梯度相关联。\n\n在一个一致的连续公式中，定义为 $- \\frac{1}{\\rho} \\nabla p$ 的气压梯度力 (PGF) 在此静止试验中产生零水平加速度，因为 $ \\partial p / \\partial x \\big|_{z} = 0$，其中 $ \\partial p / \\partial x \\big|_{\\eta}$ 和垂直度量项之间精确抵消。然而，假设一个数值实现在计算恒定 $\\eta$ 面上的水平 PGF 时，无意中忽略了实现这种抵消的垂直度量修正项。在小坡度条件和平滑场的假设下，推导由于此疏忽产生的虚假水平加速度（即PGF误差）的领先阶解析估计。\n\n你的推导必须从以下几点出发：\n- 静力平衡 $ \\partial p / \\partial z = - \\rho g$ 和 PGF 的定义 $- \\frac{1}{\\rho} \\nabla p$。\n- $(x, z)$ 和 $(x, \\eta)$ 之间的坐标变换的链式法则。\n\n将最终误差估计表示为关于 $B(\\eta)$、地面气压的水平斜率 $ \\partial p_{s} / \\partial x$ 以及必要的原始热力学场的单个闭式表达式。不要引入任何经验性调整常数，并且除了在上述映射中的作用外，不要对 $A(\\eta)$ 或 $B(\\eta)$ 的形式做任何特殊假设。你的最终答案必须是单个解析表达式。不需要进行数值评估。",
            "solution": "用户希望在特定的理想化条件下，推导混合坐标数值模式中因气压梯度力 (PGF) 计算不正确而产生的虚假水平加速度。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n-   大气：静止、静力平衡、水平均匀。\n-   坐标：几何高度 $z$，水平坐标 $x$，气压 $p$。\n-   静力平衡：$\\frac{\\partial p}{\\partial z} = -\\rho g$，其中 $g$ 为重力加速度，$\\rho$ 为密度。\n-   水平均匀性：$\\frac{\\partial p}{\\partial x} \\big|_{z} = 0$。\n-   地形：地面高程 $z_g(x)$。\n-   地面气压：$p_s(x) = p(z = z_g(x))$。\n-   模式垂直坐标：混合气压坐标 $\\eta$。\n-   坐标映射：$p(\\eta, x) = A(\\eta) + B(\\eta) p_s(x)$。\n-   混合坐标函数：$A(\\eta)$ 和 $B(\\eta)$ 是给定的函数；高层 $B(\\eta) \\to 0$ 且近地表 $B(\\eta) \\to 1$。\n-   数值误差：水平PGF计算为 $-\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} \\big|_{\\eta}$，忽略了垂直度量修正项。\n-   任务：推导由此产生的虚假水平加速度的领先阶解析估计。\n-   出发点：静力平衡、PGF的定义以及坐标变换的链式法则。\n-   最终表达式形式：用 $B(\\eta)$、$\\frac{\\partial p_s}{\\partial x}$ 和原始热力学场表示。\n\n**1.2. 依据标准验证**\n-   **科学基础：**该问题牢固地植根于大气动力学和数值模拟的基本原理。静力平衡、气压梯度力和混合坐标系等概念是气象学和气候科学中的标准内容。“地形上的气压梯度误差”是该领域一个经典且被充分理解的问题。该设置代表了数值方案的标准基准测试。\n-   **适定性：**该问题是适定的。它清晰地定义了物理状态、坐标系、计算误差的确切性质以及解的期望形式。所提供的信息足以推導出一个唯一的解析表达式。\n-   **客观性：**该问题以精确、客观、技术性的语言陈述，没有任何主观性或歧义。\n-   **完整性与一致性：**该问题是自洽且内部一致的。它提供了求解所需量所需的所有必要定义和物理定律（静力平衡、PGF定义、坐标映射）。\n-   **现实性与可行性：**该场景虽然是理想化的（静止大气），但却是用于诊断和理解大气模式中数值误差的标准且现实的测试案例。所描述的误差是一个具有历史意义的重要问题，它推动了更先进数值技术的发展。\n-   **结构与非平凡性：**该问题结构良好且非平凡。它要求在坐标变换的背景下正确应用微积分（链式法则）和物理原理（静力平衡），这是地球物理流体动力学的核心技能。\n\n**1.3. 结论与行动**\n该问题被认定为**有效**。这是一个地球物理流体动力学中的标准、适定问题，具有科学合理性和客观性。将提供一个完整的、有理有据的解法。\n\n### 步骤 2：虚假加速度的推导\n\n单位质量的气压梯度力 (PGF) 的水平分量由 $-\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x}$ 给出，其中偏导数是在恒定的几何高度 $z$ 上取的。问题陈述，对于真实的大气状态，气压仅是高度的函数，这意味着 $\\frac{\\partial p}{\\partial x}\\big|_{z} = 0$。因此，真实的水平PGF为零，处于这个静止大气中的粒子应该经历零水平加速度。\n\n数值模式在混合坐标系 $(x, \\eta)$ 中运行。基于高度的坐标系 $(x, z)$ 和混合坐标系 $(x, \\eta)$ 中气压梯度之间的关系由偏导数的链式法则给出：\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{z} = \\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} + \\frac{\\partial p}{\\partial \\eta}\\bigg|_{x} \\frac{\\partial \\eta}{\\partial x}\\bigg|_{z}\n$$\n另一种更常见的变换方式是，将 $p$ 视为 $x$ 和 $z$ 的函数，而 $z$ 又是 $x$ 和 $\\eta$ 的函数。这得到：\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} = \\frac{\\partial p}{\\partial x}\\bigg|_{z} + \\frac{\\partial p}{\\partial z}\\bigg|_{x} \\frac{\\partial z}{\\partial x}\\bigg|_{\\eta}\n$$\n在连续公式中，正确的水平PGF可以使用$\\eta$面上的梯度表示为：\n$$\n\\text{PGF}_x = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x}\\bigg|_{z} = -\\frac{1}{\\rho} \\left( \\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} - \\frac{\\partial z}{\\partial x}\\bigg|_{\\eta} \\frac{\\partial p}{\\partial z} \\right)\n$$\n问题陈述，数值实现错误地计算了 PGF，只包含了第一项 $\\frac{\\partial p}{\\partial x}\\big|_{\\eta}$，而忽略了第二项，即垂直度量修正项。因此，产生的虚假水平加速度 $a_{spurious}$ 为：\n$$\na_{spurious} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x}\\bigg|_{\\eta}\n$$\n为了找到这个误差的解析表达式，我们必须计算 $\\frac{\\partial p}{\\partial x}\\big|_{\\eta}$。我们使用给定的混合气压坐标定义：\n$$\np(\\eta, x) = A(\\eta) + B(\\eta) \\, p_s(x)\n$$\n我们在保持 $\\eta$ 不变的情况下，对这个表达式关于 $x$ 求导。由于 $A(\\eta)$ 和 $B(\\eta)$ 仅是 $\\eta$ 的函数，因此在这个偏微分中它们被当作常数处理。\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} = \\frac{\\partial}{\\partial x} \\left[ A(\\eta) + B(\\eta) \\, p_s(x) \\right] \\bigg|_{\\eta}\n$$\n应用求和法则以及 $\\frac{\\partial A(\\eta)}{\\partial x}\\big|_{\\eta} = 0$ 的事实：\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} = 0 + \\frac{\\partial}{\\partial x} \\left[ B(\\eta) \\, p_s(x) \\right] \\bigg|_{\\eta}\n$$\n因为在恒定 $\\eta$ 下，$B(\\eta)$ 是一个关于 $x$ 的常数因子：\n$$\n\\frac{\\partial p}{\\partial x}\\bigg|_{\\eta} = B(\\eta) \\frac{\\partial p_s}{\\partial x}\n$$\n现在，我们将这个结果代入我们的虚假加速度表达式中：\n$$\na_{spurious} = -\\frac{1}{\\rho} \\left( B(\\eta) \\frac{\\partial p_s}{\\partial x} \\right)\n$$\n这个表达式代表了由错误的PGF计算所产生的虚假水平加速度。它用给定的函数 $B(\\eta)$、地面气压的水平梯度 $\\frac{\\partial p_s}{\\partial x}$ 和密度 $\\rho$（一个原始热力学场）来表示。这满足了问题的所有要求。\n\n这一结果凸显了地形跟随坐标模式中的一个关键问题：即使在没有实际作用力存在的静止大气中，对倾斜坐标面（$\\eta$）上的气压梯度进行朴素计算也会产生一个非零的、不符合物理的力。这个力与依赖于地形的地面气壓梯度成正比，并在垂直方向上受到函数 $B(\\eta)$ 的调制。",
            "answer": "$$\n\\boxed{-\\frac{1}{\\rho} B(\\eta) \\frac{\\partial p_{s}}{\\partial x}}\n$$"
        }
    ]
}