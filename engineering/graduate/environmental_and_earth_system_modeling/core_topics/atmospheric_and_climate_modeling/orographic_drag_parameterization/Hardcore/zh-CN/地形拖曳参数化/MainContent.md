## 引言
在[地球系统模型](@entry_id:1124096)中，对地表复杂地形的精确表述是模拟真实[大气环流](@entry_id:1125564)的关键，然而，模型有限的分辨率使得大量中小尺度地形无法被直接解析。这些“次网格”地形对大气流动产生的拖曳效应——即地形拖曳——若被忽略，将导致模型出现严重的系统性偏差，例如平流层西风过强和地表风场失真。因此，发展精确的地形拖曳[参数化](@entry_id:265163)方案，以表征这些未解析过程的宏观效应，成为现代[数值天气预报](@entry_id:191656)和气候模拟领域的核心挑战之一。

本文旨在系统性地剖析地形拖曳[参数化](@entry_id:265163)的理论、实现与应用。读者将通过以下三个章节，构建一个从基本物理原理到模型实践应用的完整知识体系：

第一章，**原理与机制**，将深入探讨地形拖曳产生的两种核心物理过程：近地表的流动阻塞与形态拖曳，以及能够向上传播至平流层的地形[重力波拖曳](@entry_id:1125751)。理解这些机制是所有[参数化](@entry_id:265163)方案的基石。

第二章，**应用与交叉学科联系**，将展示这些理论如何转化为数值模型中的具体算法，并阐释地形拖曳在全球环流、[能量收支](@entry_id:201027)以及与云物理、[海洋学](@entry_id:149256)等其他学科的相互作用中所扮演的关键角色。

第三章，**动手实践**，提供了一系列从理论推导到编码实现的练习，旨在帮助读者将抽象概念转化为解决实际问题的能力。

我们将从地形拖曳的根本物理原理出发，为后续理解其在复杂[地球系统模型](@entry_id:1124096)中的应用奠定坚实的基础。

## 原理与机制

在[地球系统模型](@entry_id:1124096)中，由未解析地形引起的动量通量（即地形拖曳）的[参数化](@entry_id:265163)，是一个至关重要的组成部分。本章旨在深入阐述地形拖曳[参数化](@entry_id:265163)背后的核心物理原理与机制。我们将系统地剖析大气流动如何与复杂地形相互作用，并产生两种截然不同但又相互关联的拖曳效应：近地表的绕流与阻塞效应，以及向上传播的[重力波拖曳](@entry_id:1125751)。理解这些机制是构建精确且具有尺度感知能力的[参数化](@entry_id:265163)方案的基础。

### 地形拖曳的基本分类

当稳定分层的大气流经山脉时，它对大规模气流施加的净拖曳力可以分解为两个主要部分。这种分解对于在通用环流模型（GCM）中进行准确的[参数化](@entry_id:265163)至关重要，因为这两种机制在不同的动力学条件下占主导地位，并以不同的方式影响[大气环流](@entry_id:1125564) 。

1.  **低层拖曳（Low-Level Drag）**：这种拖曳主要源于近地表的 **形态拖曳（form drag）** 和 **流体阻塞（flow blocking）**。当气流的动能不足以使其爬升越过山脉时，部分低层气流会被阻塞和绕流。这种现象在山脉的[迎风](@entry_id:756372)坡和背风坡之间产生显著的气压差，从而对大气施加一个净的减速力。这种拖曳主要作用于大气边界层和对流层低层。

2.  **[重力波拖曳](@entry_id:1125751)（Gravity Wave Drag）**：当气流确实越过山脉时，地形会像水面上的石子一样，在稳定分层的大气中激发出所谓的 **地形重力波（orographic gravity waves）** 或 **[山地波](@entry_id:1128215)（mountain waves）**。这些波可以垂直向上传播，将水[平动](@entry_id:187700)量从低层输送到中层和高层大气。当这些波在高空破碎或被吸收时，它们携带的动量就被传递给背景气流，从而产生拖曳效应。这种机制能够将地表的影响遥远地传递到平流层甚至中间层。

由于真实大气条件（如风速、稳定度和风切变）在空间和时间上不断变化，且[次网格地形](@entry_id:1132604)本身具有复杂的光谱特性，导致阻塞和波传播状态时常共存。因此，一个完备的[参数化](@entry_id:265163)方案必须同时包含对这两种拖曳机制的描述 。

### 低层拖曳：形态阻力与流动阻塞

让我们首先关注在模型网格单元内部，由未解析的小尺度地形产生的形态拖曳。考虑一股稳定的平均风速为 $U$ 的气流，流向一个次网格尺度的障碍物（例如一座小山）。气流在迎风坡前减速，导致 streamlines（流线）被压缩，压力 $p$ 升高。在背风坡，气流加速，对于足够陡峭的斜坡，边界层可能会发生分离，形成一个低压的[湍流尾流](@entry_id:202019)区。

这种迎风坡的高压和背风坡的低压所形成的气压不对称性，会对地形本身产生一个沿气流方向的净压力，这就是拖曳力。根据牛顿第三定律，地形反过来对流体施加一个大小相等、方向相反的力，即一个与平均流向相反的动量汇。这个力，即 **形态拖曳**，可以通过对地形表面压力 $p$ 在气流方向上的分量进行面积分来量化 ：
$$
\mathbf{F}_{\text{drag}} = - \int_{\text{terrain}} p \mathbf{n} \cdot \hat{\mathbf{x}} \, \mathrm{d}S
$$
其中 $\mathbf{n}$ 是指向地形内部的[单位法向量](@entry_id:178851)，$\hat{\mathbf{x}}$ 是气流方向的[单位向量](@entry_id:165907)。当这个总力在整个网格单元上进行平均，并转化为对网格平均动量的影响时，它表现为一个负的倾向项 $\mathrm{d}U/\mathrm{d}t  0$，主要集中在近地表。

决定低层气流是被阻塞还是能够爬越山脉的关键[无量纲参数](@entry_id:169335)是 **[弗劳德数](@entry_id:271895)（Froude number）**：
$$
Fr = \frac{U}{N H}
$$
其中 $U$ 是上游风速，$N$ 是 **[布伦特-维萨拉频率](@entry_id:1121902)（Brunt–Väisälä frequency）**，它表征大气的稳定分层强度，$H$ 是地形的特征高度。弗劳德数代表了气流的[惯性力](@entry_id:169104)（动能）与由重力引起的[浮力](@entry_id:154088)恢复力（爬升所需的势能）之间的比率。

当 $Fr \lesssim 1$ 时，意味着气流的动能不足以完全克服稳定分层带来的势能垒。此时，低层气流倾向于被地形阻塞，在山前形成滞止区，并从侧面绕流。这种阻塞效应是形态拖曳产生的主要原因  。

### [重力波拖曳](@entry_id:1125751)的物理机制

与低层阻塞不同，[重力波拖曳](@entry_id:1125751)是一个涉及波的产生、传播和耗散的复杂过程。

#### 波的激发（Launch）

为了理解波的激发，我们可以考虑一个理想化的二维模型：在均匀风速 $U$ 和恒定稳定度 $N$ 的背景下，气流经过一个振幅为 $a$、水平波数为 $k$ 的正弦地形 $h(x) = a \cos(kx)$。根据线性理论，地形对气流的扰动可以被看作是下边界的一个垂直速度强迫。对于小振幅地形，这个条件可以在 $z=0$ 处线性化为 ：
$$
w(x, z=0) = U \frac{\mathrm{d}h}{\mathrm{d}x}
$$
其中 $w$ 是扰动垂直速度。这个边界条件激发了大气中的内在振荡，即地形重力波。线性化分析的有效性依赖于两个关键假设：地形坡度足够小（$|ak| \ll 1$），以及地形高度相对于一个内在的垂直尺度 $U/N$ 足够小（$aN/U \ll 1$）。

#### 波的[垂直传播](@entry_id:204688)

一旦被激发，这些波能否垂直向上传播，取决于它们的水平尺度与背景大气的特性。从线性化的Boussinesq方程组出发，可以推导出描述波垂直结构的 **泰勒-戈尔茨坦方程（Taylor-Goldstein equation）**。对于一个具有水平波数 $k$ 的单色波，其垂直结构由一个[二阶常微分方程](@entry_id:204212)决定：
$$
\frac{\mathrm{d}^2 \hat{w}}{\mathrm{d}z^2} + m^2(z) \hat{w} = 0
$$
其中 $\hat{w}(z)$ 是垂直速度的振幅，而 $m^2(z)$ 是垂直波数的平方。波能够垂直传播的条件是 $m^2(z)  0$，此时解是振荡的。如果 $m^2(z)  0$，解是指数衰减的，波被称为 **渐逝波（evanescent wave）**，无法有效向上传播动量。

$m^2(z)$ 由所谓的 **斯科勒参数（Scorer parameter）** $l^2(z)$ 和地形的水平波数 $k$ 决定：
$$
m^2(z) = l^2(z) - k^2
$$
对于一个背景风 $U(z)$ 和稳定度 $N(z)$ 随高度变化的更一般情况，斯科勒参数的完整形式为 ：
$$
l^2(z) = \frac{N^2(z)}{U^2(z)} - \frac{U''(z)}{U(z)}
$$
其中 $U''(z)$ 是背景风随高度的二阶导数（曲率）。因此，波的传播条件 $m^2(z) > 0$ 转化为 $k^2  l^2(z)$。这意味着，只有那些水平尺度足够大（即 $k$ 足够小）的地形扰动才能[激发能](@entry_id:190368)够垂直传播的重力波。相反，非常窄的山脉（$k$ 很大）倾向于产生被困在低层的渐逝波 。

当一个向上传播的波遇到一个 $m^2(z)$ 由正变负的区域，它就到达了一个 **转向层（turning level）**。在这种情况下，波会发生部分反射，只有一部分能量和动量能够“隧穿”这个渐逝层。透射系数 $T$ 近似为 ：
$$
T \approx \exp\left(-2 \int_{z_1}^{z_2} |m(z')| \, \mathrm{d}z'\right)
$$
其中 $[z_1, z_2]$ 是渐逝层的厚度。这种反射本身在无粘条件下是保守的，不直接产生拖曳，但它减少了到达更高层级的[动量通量](@entry_id:199796)。

#### 波的耗散与动量沉积

对于那些成功向上传播的波，它们携带的垂直方向的水平动量通量 $\tau(z) = \rho(z) \overline{u'w'}$（其中 $\rho$ 是大气密度，$u', w'$ 是扰动速度）在没有耗散的情况下是守恒的。然而，大气密度的指数递减意味着为了保持通量守恒，波的振幅必须随高度指数增长。这种振幅的增长最终会导致波变得不稳定而破碎，或者被背景流吸收。

主要的耗散机制有两种：

1.  **[临界层](@entry_id:187735)吸收（Critical Level Absorption）**：[临界层](@entry_id:187735)定义为波的水平相速度 $c$ 等于背景风速 $U(z)$ 的高度。对于固定的地形波，其相速度 $c=0$，因此[临界层](@entry_id:187735)发生在 $U(z_c) = 0$ 的高度。当波接近[临界层](@entry_id:187735)时，其内在频率 $\hat{\omega} = k(U(z)-c)$ 趋于零，导致垂直波数 $m$ 趋于无穷大，垂直波长趋于零。波的能量和动量在[临界层](@entry_id:187735)附近被高效地吸收，并传递给平均流，从而产生强烈的局部拖曳 。

2.  **饱和破碎（Saturation Breaking）**：随着波振幅因密度减小而增长，波本身引起的风切变和温度梯度会变得非常大。当波扰动足以使局地大气的稳定性（例如，由[梯度理查森数](@entry_id:276161) $Ri$ 衡量）低于某个临界值（通常 $Ri_c \approx 0.25$）时，就会触发[湍流](@entry_id:151300)和波破碎。这个过程称为 **饱和**，它限制了波的振幅，并将波的动量耗散到背景流中，同样产生拖曳 。

在[参数化](@entry_id:265163)方案中，波的[动量通量](@entry_id:199796)会一直向上传播，直到遇到这两种机制中的任何一种。实际的动量沉积高度 $z_*$ 将是饱和高度 $z_s$ 和[临界层](@entry_id:187735)高度 $z_c$ 中的较小者，即 $z_* = \min(z_s, z_c)$。这是因为波无法传播通过它遇到的第一个耗散层 。

### [参数化](@entry_id:265163)方案的构建与尺度感知

将上述物理原理整合到一个实际的[参数化](@entry_id:265163)方案中，需要一个系统的算法流程，并对模型的尺度有清晰的认识 。

#### 1. [次网格地形](@entry_id:1132604)的量化

[参数化](@entry_id:265163)的第一步是量化驱动拖曳的未解析地形。这需要从高分辨率的[数字高程模型](@entry_id:1123727)（DEM）中为每个粗网格单元提取统计特征。关键的 **[次网格地形](@entry_id:1132604)（SSO）指标** 包括 ：

-   **高程标准差 ($\sigma_h$)**：衡量地形的总体起伏程度。
-   **坡度方差 ($\sigma_{|\nabla h|}^2$)**：衡量地形的陡峭程度。
-   **各向异性 (Anisotropy)** 和 **山脊方向 (Ridge Orientation)**：描述地形是否存在优选方向（例如，连绵的山脉 vs. 孤立的山峰）。这些信息通常通过计算地形梯度的 **结构张量** $S = \overline{\nabla h (\nabla h)^\top}$ 并对其进行[特征值分解](@entry_id:272091)来获得。[最大特征值](@entry_id:1127078) $\lambda_1$ 对应的[特征向量](@entry_id:151813) $\mathbf{e}_1$ 指向坡度变化最剧烈的方向（即垂直于山脊），而各向异性比率（如 $\lambda_1/\lambda_2$）则量化了方向性。

#### 2. [参数化算法](@entry_id:272093)流程

一个典型的[重力波拖曳参数化](@entry_id:1125844)方案遵循以下步骤 ：

1.  **激发/发射 (Launch)**：在近[地表层](@entry_id:1132680)，根据SSO统计数据和该层的风速 $U_0$、稳定度 $N_0$，计算由地形激发的初始[动量通量](@entry_id:199796)谱。这个通量的大小和方向取决于风与地形的相对角度。
2.  **[垂直传播](@entry_id:204688) (Propagation)**：将[动量通量](@entry_id:199796)谱从模型的一层向上传播到下一层。在每一层，使用WKB理论，并检查传播条件 ($m^2  0$)。对于不满足条件的波分量，它们是渐逝的，其[动量通量](@entry_id:199796)不会被继续向上传播。
3.  **耗散/沉积 (Dissipation)**：在每一层，检查是否存在[临界层](@entry_id:187735) ($U(z) \approx 0$) 或是否达到饱和条件。如果任一条件满足，则认为相应波分量的动量通量在此处被吸收。
4.  **施加拖曳 (Tendency)**：被吸收的[动量通量](@entry_id:199796)在垂直方向上的散度（即通量随高度的变化率）就构成了对该层平均风场的拖曳力（一个负的动量倾向）。即 $\partial U / \partial t \propto - \partial \tau / \partial z$。

#### 3. 尺度感知能力（Scale Awareness）

一个先进的[参数化](@entry_id:265163)方案必须具备 **尺度感知能力**。这意味着[参数化](@entry_id:265163)的效应应该随着模型分辨率的变化而平滑地调整。当[地球系统模型](@entry_id:1124096)的分辨率提高时（即网格尺寸 $L$ 减小），更多的地形特征会被模型的动力核心直接解析。因此，由这些现在已被解析的地形所产生的拖曳力，也由模型直接计算得出。

为了避免重复计算这部分拖曳力，[参数化](@entry_id:265163)方案必须只考虑那些仍然未被解析的地形尺度。具体来说，[参数化](@entry_id:265163)所使用的SSO统计数据（如 $\sigma_h$）应该从一个经过与[模型分辨率](@entry_id:752082)相匹配的滤波器处理后的高程数据中计算得出。随着分辨率的提高，未解析的地形方差会减小，因此[参数化](@entry_id:265163)产生的拖曳力也应相应减小。这种平滑过渡确保了模型在不同分辨率下都能得到物理上一致的总拖曳力 。