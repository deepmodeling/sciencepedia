{
    "hands_on_practices": [
        {
            "introduction": "第一个练习为理解地形拖曳奠定了理论基础。通过推导经典静力山地波的垂直动量通量，您将建立一个关于大气流动如何与地形相互作用以产生拖曳的定量理解。这个基本推导  将诸如层结、风速和山脉形状等关键参数与最终的动量传递联系起来，而这正是所有拖曳参数化方案的物理基础。",
            "id": "3904231",
            "problem": "考虑一个二维、稳定、无粘的线性 Boussinesq 流，其具有均匀的背景风速 $U$，流经一个孤立的山脊。假设地形为小振幅，以便线性理论适用，并对内重力波采用静水近似。层结是均匀的，Brunt–Väisälä 频率（BVF）为 $N$，背景密度为 $\\rho$。设山脊由高度的单个单色傅里叶分量 $h(x)=H\\cos(kx)$ 表示，其中 $H$ 是高度振幅，$k=2\\pi/\\lambda$ 是与波长 $\\lambda$ 相关的水平波数。在下边界 $z=0$ 处，施加运动学边界条件，即垂直速度等于背景流对地形的平流。\n\n仅从具有静水力平衡、连续性和均匀层结的线性化、稳定、无粘的 Boussinesq 方程出发：\n- 连续性方程：对于平面波解 $\\propto \\exp(i(kx+mz))$，有 $ik\\,u' + im\\,w' = 0$\n- 静水力平衡：$\\partial p'/\\partial z = \\rho\\,b'$\n- 稳定浮力方程：$U\\,\\partial b'/\\partial x + N^{2} w' = 0$\n- 水平动量方程：$U\\,\\partial u'/\\partial x = -\\frac{1}{\\rho}\\,\\partial p'/\\partial x$\n以及在 $z=0$ 处地形边界条件：$w(x,0) = U\\,\\partial h/\\partial x$，\n\n推导由静水山地波携带的相位平均的水平动量垂直通量 $\\rho\\,\\overline{u'w'}$，并证明其对基本参数和地形振幅的依赖性。然后，对于以下具体情况：\n$\\rho = 0.9\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$U = 15\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$N = 0.012\\,\\mathrm{s}^{-1}$，$H = 300\\,\\mathrm{m}$，以及 $\\lambda = 20\\,\\mathrm{km}$，\n计算带符号的表面动量通量（一个应力），并以 $\\mathrm{N}\\,\\mathrm{m}^{-2}$ 为单位表示。将您的最终数值答案四舍五入到三位有效数字。",
            "solution": "用户要求我解决一个地球物理流体动力学中关于静水山地波的问题。\n\n### 第 1 步：提取已知条件\n问题提供了以下信息和控制方程：\n- 流是二维、稳定、无粘、线性和 Boussinesq 的。\n- 背景风速是均匀的，$U$。\n- 层结是均匀的，Brunt–Väisälä 频率为 $N$。\n- 背景密度为 $\\rho$。\n- 地形是单个单色山脊：$h(x) = H\\cos(kx)$，其中 $H$ 是高度振幅，$k=2\\pi/\\lambda$ 是水平波数。\n- 将使用静水近似。\n- 提供了控制线性化方程（以微分和傅里叶空间形式混合）：\n    - 平面波的连续性方程：$ik\\,u' + im\\,w' = 0$。\n    - 静水力平衡：$\\partial p'/\\partial z = \\rho\\,b'$。\n    - 稳态浮力方程：$U\\,\\partial b'/\\partial x + N^{2} w' = 0$。\n    - 水平动量方程：$U\\,\\partial u'/\\partial x = -\\frac{1}{\\rho}\\,\\partial p'/\\partial x$。\n- $z=0$ 处的下边界条件是运动学条件：$w(x,0) = U\\,\\partial h/\\partial x$。\n- 最终计算的具体数值：\n    - $\\rho = 0.9\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n    - $U = 15\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n    - $N = 0.012\\,\\mathrm{s}^{-1}$\n    - $H = 300\\,\\mathrm{m}$\n    - $\\lambda = 20\\,\\mathrm{km} = 2 \\times 10^4\\,\\mathrm{m}$\n\n### 第 2 步：使用提取的已知条件进行验证\n现在将验证问题陈述。\n1.  **科学依据**：该问题是线性山地波理论的一个经典教科书范例，这是大气动力学和环境流体力学中的一个基本课题。控制方程是静水近似下的标准线性化 Boussinesq 方程。物理设置是现实的，并作为理解地形拖曳的基础模型。该问题具有坚实的科学基础。\n2.  **适定性**：该问题是适定的。它提供了一套完整的控制方程和明确定义的边界条件。求解动量通量的要求是通过求解该系统得出的标准计算。为了获得唯一解，需要一个隐含的上边界条件（辐射条件），这是此类问题的标准做法，以确保波能从源（山脉）向高空传播。\n3.  **客观性**：语言精确、定量，没有任何主观性或偏见。\n4.  **完整性与一致性**：所提供的方程和条件是一致且充分的，足以推导出所要求的量。问题明确指出采用静水近似，这解决了使用哪组方程的任何模糊性。数值对于地球大气来说是物理上合理的。\n\n### 第 3 步：结论和行动\n问题是有效的。将提供一个完整的解答。\n\n### 动量通量的推导\n我们寻求相位平均的水平动量垂直通量，$\\mathcal{F}_M = \\rho\\,\\overline{u'w'}$。上划线表示在一个水平波长上的空间平均。扰动 $u'$（水平速度）和 $w'$（垂直速度）是给定线性系统的解。\n\n我们假设解的形式为 $f'(x,z) = \\Re\\{\\hat{f}(z)e^{ikx}\\}$，其中 $\\hat{f}(z)$ 是扰动变量 $f'$ 的复振幅。将此形式代入控制微分方程，得到一组关于复振幅的方程：\n1.  水平动量方程：$U(ik\\hat{u}) = -\\frac{1}{\\rho}(ik\\hat{p}) \\implies \\hat{p} = -\\rho U \\hat{u}$。\n2.  浮力方程：$U(ik\\hat{b}) + N^2\\hat{w} = 0 \\implies \\hat{b} = \\frac{iN^2}{Uk}\\hat{w}$。\n3.  静水力平衡：$\\frac{d\\hat{p}}{dz} = \\rho \\hat{b}$。\n4.  连续性方程：$ik\\hat{u} + \\frac{d\\hat{w}}{dz} = 0$。\n\n我们将这些方程组合起来，以找到一个关于 $\\hat{w}(z)$ 的单一控制方程。将水平动量方程 (1) 对 $z$ 求导得到 $\\frac{d\\hat{p}}{dz} = -\\rho U \\frac{d\\hat{u}}{dz}$。\n将此结果和浮力关系 (2) 代入静水方程 (3) 得到：\n$-\\rho U \\frac{d\\hat{u}}{dz} = \\rho \\left(\\frac{iN^2}{Uk}\\hat{w}\\right) \\implies \\frac{d\\hat{u}}{dz} = -\\frac{iN^2}{U^2k}\\hat{w}$。\n从连续性方程 (4)，我们有 $\\hat{u} = \\frac{i}{k}\\frac{d\\hat{w}}{dz}$。将此式对 $z$ 求导得到 $\\frac{d\\hat{u}}{dz} = \\frac{i}{k}\\frac{d^2\\hat{w}}{dz^2}$。\n令 $\\frac{d\\hat{u}}{dz}$ 的两个表达式相等：\n$\\frac{i}{k}\\frac{d^2\\hat{w}}{dz^2} = -\\frac{iN^2}{U^2k}\\hat{w}$。\n乘以 $k/i$ 将其简化为静水流的 Taylor-Goldstein 方程：\n$$\n\\frac{d^2\\hat{w}}{dz^2} + \\frac{N^2}{U^2}\\hat{w} = 0\n$$\n这是一个具有常系数的二阶常微分方程。设 $m^2 = (N/U)^2$。通解为 $\\hat{w}(z) = A e^{imz} + B e^{-imz}$。为了得到物理上有意义的解，波能必须向上（远离地形）传播。对于驻波（$U0$, $k0$），此辐射条件要求我们选择具有向上群速度的解，这对应于向下的相速度，意味着我们为垂直波数选择正根，$m = N/U$。因此解为 $\\hat{w}(z) = A e^{imz}$。\n\n常数 $A$ 由 $z=0$ 处的下边界条件决定：$w(x,0) = U \\frac{\\partial h}{\\partial x}$。\n给定 $h(x)=H\\cos(kx)$，我们有 $\\frac{\\partial h}{\\partial x} = -Hk\\sin(kx)$。\n所以，$w(x,0) = -UHk\\sin(kx)$。\n我们可以用复数形式写出：$w(x,0) = \\Re\\{iUHke^{ikx}\\}$。\n此外，从我们假设的解的形式，$w(x,0) = \\Re\\{\\hat{w}(0)e^{ikx}\\} = \\Re\\{Ae^{ikx}\\}$。\n比较这两个表达式，我们发现在边界处的振幅为：$A = \\hat{w}(0) = iUHk$。\n因此，垂直速度振幅的解是：\n$$\n\\hat{w}(z) = iUHk e^{imz}, \\quad \\text{其中 } m = \\frac{N}{U}\n$$\n接下来，我们使用连续性方程 $\\hat{u} = \\frac{i}{k}\\frac{d\\hat{w}}{dz}$ 来求水平速度振幅 $\\hat{u}(z)$：\n$\\frac{d\\hat{w}}{dz} = \\frac{d}{dz}(iUHk e^{imz}) = (iUHk)(im)e^{imz} = -UHkm e^{imz}$。\n代入 $m=N/U$：$\\frac{d\\hat{w}}{dz} = -UHk(N/U)e^{imz} = -NHk e^{imz}$。\n然后，$\\hat{u}(z) = \\frac{i}{k}(-NHk e^{imz}) = -iNH e^{imz}$。\n\n现在我们可以计算相位平均的动量通量。对于两个量 $a = \\Re\\{\\hat{a}e^{ikx}\\}$ 和 $b = \\Re\\{\\hat{b}e^{ikx}\\}$，它们乘积的相位平均是 $\\overline{ab} = \\frac{1}{2}\\Re\\{\\hat{a}\\hat{b}^*\\}$，其中 $\\hat{b}^*$ 是 $\\hat{b}$ 的复共轭。\n我们有 $\\hat{u}(z) = -iNH e^{imz}$ 和 $\\hat{w}(z) = iUHk e^{imz}$。\n$\\hat{w}$ 的复共轭是 $\\hat{w}^*(z) = -iUHk e^{-imz}$。\n乘积是：\n$\\hat{u}\\hat{w}^* = (-iNH e^{imz})(-iUHk e^{-imz}) = i^2 (NH)(UHk) e^{imz-imz} = -NUH^2k$。\n平均乘积 $\\overline{u'w'}$ 是：\n$$\n\\overline{u'w'} = \\frac{1}{2}\\Re\\{-NUH^2k\\} = -\\frac{1}{2}NUH^2k\n$$\n这个量与高度 $z$ 无关，这与无粘、稳定的流动相一致。水平动量的垂直通量是：\n$$\n\\mathcal{F}_M = \\rho\\,\\overline{u'w'} = -\\frac{1}{2}\\rho N U k H^2\n$$\n负号表示正（向东）动量的向下通量，它对山脉施加了拖曳力。\n\n### 数值计算\n我们被要求根据给定参数计算带符号的表面动量通量：\n- $\\rho = 0.9\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $U = 15\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- $N = 0.012\\,\\mathrm{s}^{-1}$\n- $H = 300\\,\\mathrm{m}$\n- $\\lambda = 20\\,\\mathrm{km} = 2 \\times 10^4\\,\\mathrm{m}$\n\n首先，我们计算水平波数 $k$：\n$$\nk = \\frac{2\\pi}{\\lambda} = \\frac{2\\pi}{2 \\times 10^4\\,\\mathrm{m}} = \\pi \\times 10^{-4}\\,\\mathrm{m}^{-1}\n$$\n现在，将这些值代入动量通量的表达式中：\n$$\n\\mathcal{F}_M = -\\frac{1}{2} (0.9\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}) (0.012\\,\\mathrm{s}^{-1}) (15\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) (\\pi \\times 10^{-4}\\,\\mathrm{m}^{-1}) (300\\,\\mathrm{m})^2\n$$\n$$\n\\mathcal{F}_M = - \\frac{1}{2} (0.9)(0.012)(15)(\\pi \\times 10^{-4})(9 \\times 10^4) \\,\\mathrm{N}\\,\\mathrm{m}^{-2}\n$$\n$10$ 的幂次相互抵消。我们剩下：\n$$\n\\mathcal{F}_M = - \\frac{1}{2} (0.9)(0.012)(15)(\\pi)(9)\n$$\n让我们计算这个数值乘积：\n$$\n0.5 \\times 0.9 \\times 0.012 \\times 15 \\times 9 = 0.729\n$$\n所以，动量通量是：\n$$\n\\mathcal{F}_M = -0.729\\pi \\,\\,\\mathrm{N}\\,\\mathrm{m}^{-2}\n$$\n使用 $\\pi \\approx 3.14159...$ 的值：\n$$\n\\mathcal{F}_M \\approx -0.729 \\times 3.14159 = -2.29022... \\,\\,\\mathrm{N}\\,\\mathrm{m}^{-2}\n$$\n四舍五入到三位有效数字，带符号的表面动量通量是 $-2.29\\,\\mathrm{N}\\,\\mathrm{m}^{-2}$。",
            "answer": "$$\\boxed{-2.29}$$"
        },
        {
            "introduction": "从理想化的理论，我们现在转向大气建模中的一个关键实践挑战。这个问题探讨了在耦合地表层方案与地形拖曳参数化方案时出现的“双重计算”问题。掌握在地表粗糙度摩擦和地形形态阻力之间划分拖曳的原则 ，对于防止虚假的动量汇并确保模型边界层的物理完整性至关重要。",
            "id": "3904247",
            "problem": "一个应用于山地地形的全球大气模型，采用了一套基于莫宁-奥布霍夫相似性理论（MOST）的地表层湍流动量通量方案，并额外使用了一套次网格地形拖曳参数化方案，该方案代表了由阻塞流和重力波辐射产生的形状阻力。考虑一个水平均匀、定常、中性的边界层，并关注大气最低层的平均顺流向动量收支。设 $z$ 表示高度，$\\rho$ 表示空气密度，$\\overline{u}(z)$ 表示平均风速，$\\tau_{turb}(z)$ 表示湍流切应力（其中 $\\tau_{turb}(z) = -\\rho\\,\\overline{u^{\\prime}w^{\\prime}}$），并设 $f_{oro}(z)$ 表示参数化的单位质量地形体力，其作用是使平均流减速。设 $z_b$ 是一个选定的混合高度，在此高度以上，次网格地形影响对于地表层动量收支而言可以忽略不计。MOST 使用一个有效粗糙度长度 $z_{0,eff}$ 将近地表应力与平均风速关联起来，该粗糙度长度可能包含也可能不包含形状阻力效应。\n\n从雷诺平均动量方程出发，在所述条件下对 $z \\in [0,z_b]$ 进行积分，证明为了避免湍流地表层方案和地形拖曳参数化方案之间的重复计算，需要对总动量汇的划分施加一个约束，该约束可以用应力和积分后的体力来表示。然后，陈述一个物理上一致的混合原则，用于确定近地表参数化地形拖曳的垂直分布，以确保在 $[0,z_b]$ 中诊断出的总动量汇与预期的表面摩擦力和形状阻力的组合相匹配。\n\n哪个选项最佳地陈述了正确的无重复计算约束和一致的混合原则？\n\nA. 通过将粗糙度长度设置为仅代表表面摩擦力，并在 $z_b$ 以上专门应用地形拖曳，来守恒总的向下动量通量，使得对于 $z \\ge z_b$，有 $\\tau_{tot}(z) = \\tau_{turb}(z) + \\tau_{oro}(z)$，并确保在地表 $\\tau_{turb}(0) = \\rho\\,C_{D,skin}\\,U^2$，其中 $C_{D,skin}$ 是表面摩擦阻力系数，$U$ 是近地表风速。\n\nB. 增大会影响粗糙度长度 $z_{0,eff}$，使其在 MOST 关系中包含次网格地形形状阻力，并且同时在最低层应用参数化的地形体力 $f_{oro}(z)$，同时调整大尺度气压梯度以维持动量守恒。\n\nC. 从 $z_{0,eff}$ 中移除形状阻力贡献，使得 MOST 应力仅代表表面摩擦力，并使用满足 $\\int_{0}^{z_b} w(z)\\,\\mathrm{d}z = 1$ 的归一化权重函数 $w(z)$ 将 $f_{oro}(z)$ 分布在 $z \\in [0,z_b]$ 上，同时强制满足 $\\tau_{tot}(0) = \\tau_{skin}(0) + \\int_{0}^{z_b} \\rho\\,f_{oro}(z)\\,\\mathrm{d}z$，其中 $\\tau_{skin}(0) = \\rho\\,C_{D,skin}\\,U^2$。\n\nD. 保留现有的 $z_{0,eff}$（可能包含形状阻力），并从解析的气压梯度项中减去参数化的地形拖曳趋势项，从而在不修改地表层应力公式的情况下保持净平均流趋势不变。\n\nE. 通过定义一个组合阻力系数 $C_{D,tot} = \\max\\!\\big(C_{D,turb},\\,C_{D,oro}\\big)$ 来进行混合，并仅在近地表应用两者中较大的一个，以防止动量汇的重复计算。",
            "solution": "## 问题验证\n\n### 步骤1：提取已知条件\n\n-   **系统：** 一个应用于山地地形的全球大气模型。\n-   **参数化方案：**\n    1.  基于莫宁-奥布霍夫相似性理论（MOST）的地表层湍流动量通量方案。\n    2.  用于形状阻力（阻塞流）和重力波辐射的次网格地形拖曳参数化方案。\n-   **条件：** 水平均匀、定常、中性边界层。\n-   **关注点：** 大气最低层（定义为 $z \\in [0,z_b]$ 层）的平均顺流向动量收支。\n-   **变量与定义：**\n    -   $z$：高度。\n    -   $\\rho$：空气密度。\n    -   $\\overline{u}(z)$：平均顺流向风速。\n    -   $\\tau_{turb}(z)$：湍流切应力，定义为 $\\tau_{turb}(z) = -\\rho\\,\\overline{u^{\\prime}w^{\\prime}}$。\n    -   $f_{oro}(z)$：参数化的单位质量地形体力，作用是使平均流减速。\n    -   $z_b$：一个混合高度，在此高度以上，次网格地形影响对于地表层动量收支被认为是可以忽略的。\n    -   $z_{0,eff}$：在 MOST 中使用的有效粗糙度长度，可能包含也可能不包含形状阻力效应。\n-   **任务：**\n    1.  从雷诺平均动量方程出发，在 $z \\in [0,z_b]$ 上积分，证明避免重复计算的必要性，即需要一个约束条件。\n    2.  陈述一个物理上一致的混合原则，用于在近地表分布 $f_{oro}(z)$。\n    3.  确定哪个选项最佳地陈述了该约束和原则。\n\n### 步骤2：使用提取的已知条件进行验证\n\n-   **科学依据充分：** 该问题牢固地植根于大气边界层物理和数值天气预报的既定物理学。雷诺平均方程、莫宁-奥布霍夫相似性理论以及次网格尺度过程（如地形拖曳）的参数化是现代大气模型的标准和关键组成部分。地表层方案和地形拖曳方案之间的“重复计算”问题是该领域一个有据可查且重要的问题。该设定在科学上是合理的。\n-   **问题定义明确：** 该问题提供了一个清晰的物理场景（定常、水平均匀、中性边界层），并要求推导一个物理一致性条件。简化到这种理想化状态，可以清晰地推导出有效参数化耦合策略必须满足的基本原则。一个明确的概念性解决方案是存在的，并且在各种业务模型中以不同形式实现。\n-   **客观性：** 语言是技术性的、精确的，没有歧义或主观性陈述。所有术语（$f_{oro}(z)$、$\\tau_{turb}(z)$、MOST）都是该学科的标准术语。\n\n### 步骤3：结论与行动\n\n问题陈述是**有效的**。它在科学上是合理的，问题定义明确，客观，并在大气模拟领域提出了一个有意义的问题。我将继续进行解答。\n\n## 推导与求解\n\n### 基于原理的推导\n\n该问题要求我们检查动量收支，以理解两种参数化方案之间的相互作用：地表层方案（MOST）和次网格地形拖曳方案。\n\n1.  **控制方程：** 在所指定的定常状态（$\\frac{\\partial}{\\partial t}=0$）和水平均匀条件下，平均顺流向动量 $\\overline{u}$ 的雷诺平均方程简化为大尺度气压梯度力（PGF）、湍流动量通量散度以及参数化地形拖曳力之间的平衡。单位体积的动量平衡方程为：\n\n    $$ 0 = \\text{PGF} + \\frac{\\partial \\tau_{turb}}{\\partial z} - \\rho f_{oro}(z) $$\n\n    在这里，$\\frac{\\partial \\tau_{turb}}{\\partial z}$ 是由湍流动量通量辐合产生的单位体积力，而 $\\rho f_{oro}(z)$ 是由地形拖曳参数化施加的单位体积体力。PGF 是维持流动以抵抗这些拖曳力的外力。\n\n2.  **重复计算问题：** 在复杂地形上，从大气到地球表面的总动量向下输送主要包含两种物理机制：\n    -   **表面摩擦力（$\\tau_{skin}$）：** 对小尺度地表元素（如植被、土壤、卵石）的粘性阻力和压差阻力。\n    -   **形状阻力（$\\tau_{form}$）：** 跨越未解析的山丘和山谷的净压差。\n\n    问题源于这些机制在模型中的表示方式：\n    -   MOST 方案使用一个有效粗糙度长度 $z_{0,eff}$ 来计算地表湍流应力 $\\tau_{turb}(0)$。如果该方案被调整以匹配在山区的观测总拖曳，那么 $z_{0,eff}$ 会变得非常大，并隐含地包含了形状阻力的效应。在这种情况下，$\\tau_{turb}(0) \\approx \\tau_{skin} + \\tau_{form}$。\n    -   地形拖曳参数化方案计算一个体力 $f_{oro}(z)$，它显式地代表了形状阻力（$\\tau_{form} = \\int_0^\\infty \\rho f_{oro}(z) \\, \\mathrm{d}z$）。\n\n    如果我们同时使用一个大的有效 $z_{0,eff}$ *并*应用显式的地形拖曳方案，形状阻力就会被计算两次，导致动量汇过大，并使模拟流场产生虚假的减速。\n\n3.  **无重复计算约束：** 为避免这种情况，参数化方案必须被划分。每个方案必须负责一个独特的物理过程。标准且物理上最一致的方法是：\n    -   MOST 方案应只代表表面摩擦力。这要求有效粗糙度长度 $z_{0,eff}$ 被设置为一个“表面”粗糙度长度 $z_{0,skin}$，它只表征小尺度的地表元素。通过这一改变，MOST 计算的地表湍流应力就成为表面摩擦力的代表：$\\tau_{turb}(0) = \\tau_{skin}(0)$。\n    -   地形拖曳方案应代表所有的形状阻力。\n\n    在这种划分下，地表的总动量汇 $\\tau_{tot}(0)$ 是两个方案输出的线性和。总汇是在地表界面作用的表面摩擦力，加上垂直积分的体力（也通过压力作用于地表）。关注 $z \\in [0, z_b]$ 层，由该层内现象贡献的总动量汇为：\n\n    $$ \\tau_{tot,[0,z_b]} = \\tau_{skin}(0) + \\int_{0}^{z_b} \\rho\\,f_{oro}(z)\\,\\mathrm{d}z $$\n\n    这个方程就是所要求的约束。它表明，诊断出的总汇是正确划分的分量之和：由地表层方案计算的表面摩擦力和由地形拖曳方案计算的形状阻力。\n\n4.  **混合原则：** 一个物理上一致的混合原则关注地形力 $f_{oro}(z)$ 的垂直分布。简单地将全部力施加在地表层之上（例如，对于 $z  z_b$）是一种可能但物理上不自然的选项，因为来自阻塞流的形状阻力在近地表最强。一个更通用且物理上更合理的方法是使用一个权重函数 $w(z)$ 将 $f_{oro}(z)$ 分布在一个垂直剖面上，包括在 $[0, z_b]$ 层内，使得 $f_{oro}(z)$ 的剖面能够反映其潜在的物理过程（例如，对于阻塞流，力在近地表最大）。关键是这种分布与上述划分的 MOST 方案相结合，通过求和各分量来确保总汇被正确计算。\n\n### 逐项分析选项\n\n**A. 通过将粗糙度长度设置为仅代表表面摩擦力，并在 $z_b$ 以上专门应用地形拖曳，来守恒总的向下动量通量，使得对于 $z \\ge z_b$，有 $\\tau_{tot}(z) = \\tau_{turb}(z) + \\tau_{oro}(z)$，并确保在地表 $\\tau_{turb}(0) = \\rho\\,C_{D,skin}\\,U^2$，其中 $C_{D,skin}$ 是表面摩擦阻力系数，$U$ 是近地表风速。**\n这个选项正确地指出了需要将粗糙度长度减小以仅代表表面摩擦力。然而，它的混合原则——*专门*在 $z_b$ 以上应用地形拖曳——是一个特定的、并非普遍适用或物理上最优的实现方式。来自阻塞流的形状阻力物理上发生在地表及其附近，因此将相应的全部力置于一个混合高度之上是一种人为的分离。\n**结论：不正确。** 虽然包含正确的元素，但它提出的混合原则作为一般规则在物理上是可疑的。\n\n**B. 增大会影响粗糙度长度 $z_{0,eff}$，使其在 MOST 关系中包含次网格地形形状阻力，并且同时在最低层应用参数化的地形体力 $f_{oro}(z)$，同时调整大尺度气压梯度以维持动量守恒。**\n这个选项明确描述了重复计算的问题（大的 $z_{0,eff}$ + 显式的 $f_{oro}$）。其提出的“解决方案”——调整 PGF——是一种非物理的修正，它掩盖了潜在的参数化缺陷，并会破坏模型的动力学。\n**结论：不正确。**\n\n**C. 从 $z_{0,eff}$ 中移除形状阻力贡献，使得 MOST 应力仅代表表面摩擦力，并使用满足 $\\int_{0}^{z_b} w(z)\\,\\mathrm{d}z = 1$ 的归一化权重函数 $w(z)$ 将 $f_{oro}(z)$ 分布在 $z \\in [0,z_b]$ 上，同时强制满足 $\\tau_{tot}(0) = \\tau_{skin}(0) + \\int_{0}^{z_b} \\rho\\,f_{oro}(z)\\,\\mathrm{d}z$，其中 $\\tau_{skin}(0) = \\rho\\,C_{D,skin}\\,U^2$。**\n这个选项正确地指出了所有关键方面。\n1.  **划分：** “从 $z_{0,eff}$ 中移除形状阻力贡献，使得 MOST 应力仅代表表面摩擦力。” 这是正确的首要步骤。\n2.  **混合：** “使用归一化权重函数将 $f_{oro}(z)$ 分布在 $z \\in [0,z_b]$ 上” 描述了一种通用且物理上合理的方式来施加形状阻力力。\n3.  **约束：** “强制满足 $\\tau_{tot}(0) = \\tau_{skin}(0) + \\int_{0}^{z_b} \\rho\\,f_{oro}(z)\\,\\mathrm{d}z$。” 这是总动量汇的正确数学表述，通过将来自 MOST 的正确划分的表面摩擦力和来自地形方案的显式形状阻力相加来实现。使用集总公式表示 $\\tau_{skin}(0)$ 也是合适的。\n**结论：正确。**\n\n**D. 保留现有的 $z_{0,eff}$（可能包含形状阻力），并从解析的气压梯度项中减去参数化的地形拖曳趋势项，从而在不修改地表层应力公式的情况下保持净平均流趋势不变。**\n与选项 B 类似，这描述了保留有缺陷的重复计算设置，并对动量方程中的另一个项应用临时的、非物理的修正。这将导致模型中错误的内力平衡。\n**结论：不正确。**\n\n**E. 通过定义一个组合阻力系数 $C_{D,tot} = \\max\\!\\big(C_{D,turb},\\,C_{D,oro}\\big)$ 来进行混合，并仅在近地表应用两者中较大的一个，以防止动量汇的重复计算。**\n这提出了一个错误的物理组合规则。表面摩擦力和形状阻力是并行的过程，它们的效果是可加的。使用 `max` 函数会任意丢弃其中一个阻力贡献，并且在两个机制都显著时会系统性地低估总拖曳。正确的运算符是求和，而不是取最大值。\n**结论：不正确。**",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "这最后一个综合性练习旨在挑战您弥合理论与实施之间的差距。您将从头开始构建一个简化的地形重力波拖曳参数化方案，融合垂直波传播、临界层和波破碎等概念。通过开发一个计算动量沉积垂直廓线的算法 ，您将获得宝贵的实践经验，深入了解业务化天气和气候模式核心的逻辑和机制。",
            "id": "3904213",
            "problem": "考虑在二维稳态山地波的线性 Boussinesq 近似下，垂直变化的真实大气中的地形拖曳参数化。给定一个层结廓线 $N(z)$、一个与水平波数矢量对齐的背景风廓线 $U(z)$，以及一组由水平波数 $k$ 和地形振幅 $h_0$ 表征的离散地形谱分量。从包含 (i) Boussinesq 连续性方程和动量方程，(ii) 二维稳态波的内重力波色散关系，以及 (iii) 缓变介质中波作用量守恒的基本理论出发，推导计算垂直波数 $m(z)$、水平动量的垂直通量（也称为 Eliassen-Palm 通量）和饱和判据所需的表达式。利用这些表达式，实现一个算法，将每个谱分量从下边界向上通过离散网格进行垂直传播，直到遇到波破碎（饱和）或临界层，并计算由此产生的动量沉积的垂直分布。\n\n算法要求如下：\n\n- 从基本定律和核心定义出发，推导由地形强迫的稳态内重力波垂直传播所需的控制关系。不要使用未从基本理论推导出的现成或简化公式。\n- 假设参考密度 $ \\rho_0 $ 为常数，并使用适用于山地波的 Boussinesq 框架的二维、无旋转、流体静力学一致的极限情况。\n- 在从 $z=0$ 到 $z=10{,}000$ 米、间距为 $1{,}000$ 米的均匀网格 $z_i$ 上实现垂直传播。在每个高度层，判断内重力波是否能够传播 ($m^2(z_i)  0$)，是否遇到转向层 ($m^2(z_i) \\le 0$)，是否根据一个有物理动机的非线性阈值达到饱和，或者是否遇到临界层（定义为当 $|U(z_i)|$ 低于一个小阈值导致内禀相速消失时）。\n- 对于每个具有参数 $k$ 和 $h_0$ 的谱分量，使用从基本理论推导出的适当关系，在下边界初始化水平动量的向上的垂直通量。在没有破碎或临界层的绝热传播假设下，该通量随高度守恒。当发生饱和（基于推导的非线性参数达到 1），或遇到临界层（基于 $|U(z)|$ 的阈值），或达到转向层（$m^2(z) \\le 0$）时，将剩余的向上通量在当前高度层局部沉积。将所有谱分量的动量沉积贡献相加以获得净垂直廓线。\n- 所有动量沉积值以牛顿每平方米（$\\mathrm{N}\\,\\mathrm{m}^{-2}$）为单位表示。对于最终的程序输出，将每个报告的浮点数四舍五入到六位小数。\n\n使用以下常数和测试套件。所有数学实体（符号、变量、函数和数字）都应根据其物理意义进行一致处理：\n\n- 参考密度：$ \\rho_0 = 1.0 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3} $。\n- 临界层阈值：$ U_{\\mathrm{crit}} = 0.5 \\,\\mathrm{m}\\,\\mathrm{s}^{-1} $。\n\n垂直网格：\n- 高度层位于 $z_i = 0, 1000, 2000, \\dots, 10000$ 米。\n\n测试套件（三种情况），每种情况由 $N(z)$、$U(z)$ 和一组离散谱分量 $\\{(k,h_0)\\}$ 定义：\n\n- 情况 A（导致可能饱和的单调切变）：\n  - 层结：对于所有 $z$，$N(z) = 0.01 \\,\\mathrm{s}^{-1}$。\n  - 风场：$U(z) = 10 + 1.2 \\times (z/1000) \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n  - 谱分量：$(k_1,h_{0,1}) = (5\\times 10^{-4}\\,\\mathrm{m}^{-1}, 200\\,\\mathrm{m})$，$(k_2,h_{0,2}) = (3\\times 10^{-4}\\,\\mathrm{m}^{-1}, 150\\,\\mathrm{m})$，$(k_3,h_{0,3}) = (8\\times 10^{-4}\\,\\mathrm{m}^{-1}, 100\\,\\mathrm{m})$。\n\n- 情况 B（因风随高度反转而产生的临界层）：\n  - 层结：对于所有 $z$，$N(z) = 0.01 \\,\\mathrm{s}^{-1}$。\n  - 风场：$U(z) = 12 - 3 \\times (z/1000) \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n  - 谱分量：$(k_1,h_{0,1}) = (4\\times 10^{-4}\\,\\mathrm{m}^{-1}, 150\\,\\mathrm{m})$，$(k_2,h_{0,2}) = (6\\times 10^{-4}\\,\\mathrm{m}^{-1}, 120\\,\\mathrm{m})$，$(k_3,h_{0,3}) = (3\\times 10^{-4}\\,\\mathrm{m}^{-1}, 200\\,\\mathrm{m})$。\n\n- 情况 C（层结减弱导致转向层）：\n  - 层结：$N(z) = 0.014 - 0.0008 \\times (z/1000) \\,\\mathrm{s}^{-1}$。\n  - 风场：对于所有 $z$，$U(z) = 15 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n  - 谱分量：$(k_1,h_{0,1}) = (7\\times 10^{-4}\\,\\mathrm{m}^{-1}, 120\\,\\mathrm{m})$，$(k_2,h_{0,2}) = (5\\times 10^{-4}\\,\\mathrm{m}^{-1}, 180\\,\\mathrm{m})$，$(k_3,h_{0,3}) = (9\\times 10^{-4}\\,\\mathrm{m}^{-1}, 80\\,\\mathrm{m})$。\n\n数值和物理处理指南：\n- 垂直波数 $m(z)$ 必须根据适用于具有水平对齐平均流的 Boussinesq 流体中的二维稳态内重力波的色散关系来确定。\n- 必须使用极化关系将垂直速度振幅与水平速度扰动联系起来，并计算水平动量的垂直通量。\n- 在没有破碎或临界层的情况下，使用波作用量守恒来推断振幅如何随 $z$ 演变，从而能够计算非线性参数及其饱和阈值。\n- 一旦饱和、遇到临界层或达到转向层，将剩余的向上通量沉积在当前高度层，并停止该谱分量的传播。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目对应一个测试用例，本身是一个包含 11 个浮点数的列表，代表在 11 个垂直高度层 $z_i$（从 $z=0$ 到 $z=10{,}000$ 米）上各自的净动量沉积，单位为 $\\mathrm{N}\\,\\mathrm{m}^{-2}$，并四舍五入到六位小数。例如：`[[x_0,x_1,...,x_{10}],[y_0,y_1,...,y_{10}],[z_0,z_1,...,z_{10}]]`。",
            "solution": "该问题要求推导并实现一个地形重力波拖曳模型。推导将从指定近似条件下的流体动力学基本方程开始。\n\n**1. 基本方程与线性化**\n\n我们从层结流体的二维、稳态、无旋转、无粘性 Boussinesq 方程组开始，围绕具有水平速度 $U(z)$ 和密度廓线 $\\bar{\\rho}(z)$ 的背景态进行线性化。扰动量为速度分量 $(u', w')$、压强 $p'$ 和密度 $\\rho'$。参考密度为常数 $\\rho_0$。\n\n线性化的动量方程为：\n$$ U \\frac{\\partial u'}{\\partial x} + w' \\frac{dU}{dz} = -\\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial x} \\quad (1) $$\n$$ U \\frac{\\partial w'}{\\partial x} = -\\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial z} - \\frac{\\rho' g}{\\rho_0} \\quad (2) $$\n连续性方程为：\n$$ \\frac{\\partial u'}{\\partial x} + \\frac{\\partial w'}{\\partial z} = 0 \\quad (3) $$\n热力学方程，代表流体质点密度的守恒，为：\n$$ U \\frac{\\partial \\rho'}{\\partial x} + w' \\frac{d\\bar{\\rho}}{dz} = 0 \\quad (4) $$\n我们通过 $N^2(z) = -\\frac{g}{\\rho_0}\\frac{d\\bar{\\rho}}{dz}$ 定义 Brunt-Väisälä 频率 $N$。利用此定义，方程 $(4)$ 变为：\n$$ U \\frac{\\partial}{\\partial x} \\left(-\\frac{\\rho' g}{\\rho_0}\\right) - w' N^2 = 0 \\quad (5) $$\n\n**2. Taylor-Goldstein 方程的推导**\n\n我们寻求形如 $\\psi'(x,z) = \\Re\\{\\hat{\\psi}(z) e^{ikx}\\}$ 的波状解，其中 $\\psi'$ 是任意扰动变量，$k$ 是水平波数。将此形式代入线性化方程组，得到关于复振幅 $\\hat{u}(z), \\hat{w}(z), \\hat{p}(z), \\hat{\\rho}(z)$ 的常微分方程组（ODEs）：\n$$ ikU\\hat{u} + \\hat{w}\\frac{dU}{dz} = -\\frac{ik}{\\rho_0}\\hat{p} \\quad (6) $$\n$$ ikU\\hat{w} = -\\frac{1}{\\rho_0}\\frac{d\\hat{p}}{dz} - \\frac{\\hat{\\rho}g}{\\rho_0} \\quad (7) $$\n$$ ik\\hat{u} + \\frac{d\\hat{w}}{dz} = 0 \\quad (8) $$\n$$ ikU\\left(-\\frac{\\hat{\\rho}g}{\\rho_0}\\right) - \\hat{w} N^2 = 0 \\quad (9) $$\n\n从 $(8)$ 式，我们用 $\\hat{w}$ 表示 $\\hat{u}$：$\\hat{u} = \\frac{i}{k}\\frac{d\\hat{w}}{dz}$。\n从 $(9)$ 式，我们用 $\\hat{w}$ 表示浮力项：$-\\frac{\\hat{\\rho}g}{\\rho_0} = \\frac{N^2}{ikU}\\hat{w}$。\n\n将 $\\hat{u}$ 代入 $(6)$ 式求解 $\\hat{p}$：\n$$ ikU\\left(\\frac{i}{k}\\frac{d\\hat{w}}{dz}\\right) + \\hat{w}\\frac{dU}{dz} = -\\frac{ik}{\\rho_0}\\hat{p} \\implies \\hat{p} = \\rho_0 \\left( \\frac{U}{k^2}\\frac{d\\hat{w}}{dz} - \\frac{i}{k}\\frac{dU}{dz}\\hat{w} \\right) $$\n现在，对 $\\hat{p}$ 求关于 $z$ 的导数，并将其与浮力项的表达式一同代入 $(7)$ 式：\n$$ ikU\\hat{w} = -\\frac{1}{\\rho_0} \\frac{d}{dz} \\left[ \\rho_0 \\left( \\frac{U}{k^2}\\frac{d\\hat{w}}{dz} - \\frac{i}{k}\\frac{dU}{dz}\\hat{w} \\right) \\right] + \\frac{N^2}{ikU}\\hat{w} $$\n展开导数并整理各项后，我们得到 Taylor-Goldstein 方程：\n$$ \\frac{d^2\\hat{w}}{dz^2} + \\left( \\frac{N^2}{U^2} - k^2 - \\frac{U_{zz}}{U} \\right) \\hat{w} = 0 $$\n其中 $U_{zz} = d^2U/dz^2$。\n\n**3. 垂直波数 $m(z)$**\n\n问题指定对“缓变介质”进行分析，这对应于 WKB 近似。在此极限下，涉及风廓线曲率的项 $U_{zz}/U$ 与其他项相比可以忽略不计。控制方程简化为：\n$$ \\frac{d^2\\hat{w}}{dz^2} + m^2(z)\\hat{w} = 0 $$\n这是一个具有空间变化频率的谐振子方程。局地垂直波数 $m(z)$ 定义为：\n$$ m^2(z) = \\frac{N(z)^2}{U(z)^2} - k^2 $$\n要使波在垂直方向上传播，其解必须在 $z$ 方向上是振荡的，这要求 $m^2(z)  0$。如果 $m^2(z) \\le 0$，解是衰减的，波无法传播。这个条件 $m^2(z) \\le 0$ 定义了一个**转向层**。\n\n**4. 水平动量的垂直通量**\n\n单位面积上水平动量的垂直通量由 $F_m = \\rho_0 \\overline{u'w'}$ 给出，其中上划线表示在一个波长上的水平平均。我们引入垂直质点位移 $\\eta'(x, z)$。对于小位移，垂直速度是位移的全导数：$w' = \\frac{D\\eta'}{Dt} = (\\frac{\\partial}{\\partial t} + U\\frac{\\partial}{\\partial x})\\eta'$。对于稳态波（$\\partial/\\partial t = 0$），这简化为 $w' = U\\frac{\\partial \\eta'}{\\partial x}$。对于单个傅里叶模式 $\\eta'(x,z) = \\Re\\{\\hat{\\eta}(z) e^{ikx}\\}$，我们有 $\\hat{w}(z) = ikU(z)\\hat{\\eta}(z)$。\n\n地表（$z=0$）的运动学边界条件迫使气流跟随地形 $h(x)$。因此，$\\eta'(x,0) = h(x)$。对于谱分量 $h(x) = h_0 \\cos(kx)$，地表位移的复振幅为 $\\hat{\\eta}(0) = h_0$。\n\n为了求得动量通量，我们需要将 $u'$ 和 $\\eta'$ 联系起来。结合连续性方程 $(3)$ 和 $w'$ 与 $\\eta'$ 之间的关系：\n$$ \\frac{\\partial u'}{\\partial x} = -\\frac{\\partial w'}{\\partial z} = -\\frac{\\partial}{\\partial z}\\left(U\\frac{\\partial \\eta'}{\\partial x}\\right) = -U\\frac{\\partial^2 \\eta'}{\\partial x \\partial z} - \\frac{dU}{dz}\\frac{\\partial \\eta'}{\\partial x} $$\n对 $x$ 积分得到 $u' = -U\\frac{\\partial \\eta'}{\\partial z} - \\frac{dU}{dz}\\eta'$。对于能量向上传播，$\\eta'$ 的垂直结构与 $e^{imz}$ 成正比。在 WKB 近似下（$\\partial_z \\gg \\frac{1}{U}\\frac{dU}{dz}$ 等），我们有 $\\frac{\\partial \\eta'}{\\partial z} \\approx im\\eta'$，从而得到 $\\hat{u} \\approx -imU\\hat{\\eta}$。\n\n动量通量则为：\n$F_m = \\rho_0 \\overline{u'w'} = \\frac{1}{2}\\rho_0 \\Re\\{\\hat{u}(ikU\\hat{\\eta})^*\\} = \\frac{1}{2}\\rho_0 \\Re\\{(-imU\\hat{\\eta})(-ikU\\hat{\\eta}^*)\\} = \\frac{1}{2}\\rho_0 \\Re\\{-mkU^2|\\hat{\\eta}|^2\\}$。\n$$ F_m(z) = -\\frac{1}{2} \\rho_0 m(z) k U(z)^2 |\\hat{\\eta}(z)|^2 $$\n负号表示水平动量的向下通量，这对应于对地表的拖曳力。对于从地面激发的向上传播的波，其在地表（$z=0$）的通量大小，记为 $J_0$，是：\n$$ J_0 = |F_m(0)| = \\frac{1}{2}\\rho_0 m_0 k U_0^2 h_0^2 $$\n其中 $U_0 = U(0)$，$N_0 = N(0)$，以及 $m_0 = \\sqrt{N_0^2/U_0^2 - k^2}$。\n对于一个稳态、无耗散的波，水平动量的垂直通量随高度守恒，即 $F_m(z) = F_m(0)$。因此，其大小 $J(z) = J_0$ 保持不变，直到波遇到临界层、转向层或破碎。\n\n**5. 饱和判据**\n\n当波的振幅变得过大，导致对流不稳定时，会发生波破碎（饱和）。这发生在总位温梯度 $\\partial\\theta/\\partial z$ 变为非正值时。这等效于浮力 $b = \\bar{b}(z)+b'(x,z)$ 满足条件 $\\partial b/\\partial z \\le 0$。起始判据为 $\\partial b'/\\partial z \\ge N^2$。\n\n从热力学方程 $(5)$，我们得到 $b' = -N^2\\eta'$。因此，饱和判据为：\n$$ \\frac{\\partial}{\\partial z}(-N^2 \\eta') \\ge N^2 \\implies -N^2 \\frac{\\partial \\eta'}{\\partial z} \\ge N^2 \\implies \\frac{\\partial \\eta'}{\\partial z} \\le -1 $$\n位移垂直梯度的振幅为 $|\\frac{\\partial \\eta'}{\\partial z}| \\approx |im\\eta'| = m|\\hat{\\eta}|$。因此，当非线性参数 $S(z) = m(z)|\\hat{\\eta}(z)|$ 达到单位量级的值时，发生饱和。我们将阈值设为 $S(z) \\ge 1$。\n\n为了计算 $S(z)$，我们从动量通量大小守恒中求出 $|\\hat{\\eta}(z)|$：$J_0 = \\frac{1}{2}\\rho_0 m(z) k U(z)^2 |\\hat{\\eta}(z)|^2$。\n$$ |\\hat{\\eta}(z)|^2 = \\frac{2 J_0}{\\rho_0 k m(z) U(z)^2} $$\n将此代入 $S(z)$ 的表达式：\n$$ S(z) = m(z) \\sqrt{\\frac{2 J_0}{\\rho_0 k m(z) U(z)^2}} = \\sqrt{\\frac{2 J_0 m(z)}{\\rho_0 k U(z)^2}} $$\n如果 $S(z_i) \\ge 1$，则认为波在高度层 $z_i$ 处破碎。\n\n**6. 算法步骤**\n\n计算动量沉积垂直廓线的算法如下。对于每种大气廓线情况：\n1. 初始化一个总沉积数组 $D[z_i]$，对所有网格层 $z_i$ 置零。\n2. 对于每个谱分量 $(k, h_0)$：\n   a. 计算背景态 $U_0=U(0)$，$N_0=N(0)$。\n   b. 计算地表垂直波数的平方：$m_0^2 = N_0^2/U_0^2 - k^2$。\n   c. 如果 $m_0^2 \\le 0$，波在源头是衰减的。动量通量 $J_0$ 为零。继续处理下一个分量。\n   d. 否则，计算地表向上动量通量的大小：$J_0 = \\frac{1}{2}\\rho_0 m_0 k U_0^2 h_0^2$。\n   e. 将此通量垂直传播。从高度层 $i=1$ 到顶层（$z_i = 1000, 2000, ..., 10000$ 米）进行迭代。\n      i. 在高度层 $z_i$ 处，计算 $U_i=U(z_i)$ 和 $N_i=N(z_i)$。\n      ii. **临界层检查：** 如果 $|U_i|  U_{\\mathrm{crit}}$，波被吸收。将 $J_0$ 加到该层的沉积中，$D[z_i] += J_0$，并终止此分量的传播（跳出垂直循环）。\n      iii. **转向层检查：** 计算 $m_i^2 = N_i^2/U_i^2 - k^2$。如果 $m_i^2 \\le 0$，波被反射/捕获。向上的通量终止。将 $J_0$ 加到 $D[z_i]$ 中并跳出循环。\n      iv. **饱和检查：** 如果波仍在传播，计算饱和参数 $S_i^2 = \\frac{2 J_0 m_i}{\\rho_0 k U_i^2}$，其中 $m_i=\\sqrt{m_i^2}$。如果 $S_i^2 \\ge 1$，波破碎。将 $J_0$ 加到 $D[z_i]$ 中并跳出循环。\n   f. 如果循环完成而未中断，波的动量通量会逃逸出模型域的顶部，不会被沉积。\n3. 最终数组 $D$ 代表该情况下的总动量沉积廓线。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes orographic gravity wave drag deposition profiles for given atmospheric conditions.\n    \"\"\"\n    # Define constants\n    rho_0 = 1.0  # kg/m^3\n    U_crit = 0.5  # m/s\n\n    # Define vertical grid\n    z_levels = np.linspace(0, 10000, 11)  # 0, 1000, ..., 10000 meters\n\n    # Define Test Suite\n    test_suite = {\n        \"A\": {\n            \"N_func\": lambda z: 0.01,\n            \"U_func\": lambda z: 10.0 + 1.2 * (z / 1000.0),\n            \"components\": [\n                (5e-4, 200.0),\n                (3e-4, 150.0),\n                (8e-4, 100.0),\n            ]\n        },\n        \"B\": {\n            \"N_func\": lambda z: 0.01,\n            \"U_func\": lambda z: 12.0 - 3.0 * (z / 1000.0),\n            \"components\": [\n                (4e-4, 150.0),\n                (6e-4, 120.0),\n                (3e-4, 200.0),\n            ]\n        },\n        \"C\": {\n            \"N_func\": lambda z: 0.014 - 0.0008 * (z / 1000.0),\n            \"U_func\": lambda z: 15.0,\n            \"components\": [\n                (7e-4, 120.0),\n                (5e-4, 180.0),\n                (9e-4, 80.0),\n            ]\n        }\n    }\n\n    all_results = []\n\n    for case_id in [\"A\", \"B\", \"C\"]:\n        case_data = test_suite[case_id]\n        N_func = case_data[\"N_func\"]\n        U_func = case_data[\"U_func\"]\n        components = case_data[\"components\"]\n\n        total_deposition = np.zeros(len(z_levels))\n\n        for k, h0 in components:\n            # 1. Initialization at the lower boundary (z=0)\n            z0 = z_levels[0]\n            U0 = U_func(z0)\n            N0 = N_func(z0)\n            \n            # Ensure U0 is not at a critical level for flux calculation\n            if abs(U0)  1e-9:\n                continue # No wave launched\n\n            m_squared_0 = (N0**2 / U0**2) - k**2\n\n            # Check if the wave is propagating at the surface\n            if m_squared_0 = 0:\n                # Evanescent wave, no upward flux\n                continue\n\n            m0 = np.sqrt(m_squared_0)\n            \n            # Calculate magnitude of momentum flux at the surface\n            J0 = 0.5 * rho_0 * k * m0 * (U0 * h0)**2\n            \n            # 2. Vertical Propagation\n            flux_deposited = False\n            for i in range(1, len(z_levels)):\n                zi = z_levels[i]\n                Ui = U_func(zi)\n                Ni = N_func(zi)\n                \n                # Check for critical level\n                if abs(Ui)  U_crit:\n                    total_deposition[i] += J0\n                    flux_deposited = True\n                    break\n\n                # Need to check for Ui being close to zero for m_squared_i calculation\n                if abs(Ui)  1e-9:\n                    total_deposition[i] += J0\n                    flux_deposited = True\n                    break\n                    \n                m_squared_i = (Ni**2 / Ui**2) - k**2\n\n                # Check for turning level\n                if m_squared_i = 0:\n                    total_deposition[i] += J0\n                    flux_deposited = True\n                    break\n                \n                mi = np.sqrt(m_squared_i)\n\n                # Check for saturation (wave breaking)\n                # Saturation criterion S^2 >= 1, where S^2 = (2 * J0 * m_i) / (rho_0 * k * U_i^2)\n                saturation_param_sq = (2.0 * J0 * mi) / (rho_0 * k * Ui**2)\n                if saturation_param_sq >= 1.0:\n                    total_deposition[i] += J0\n                    flux_deposited = True\n                    break\n            \n            # The problem implies that if a wave reaches the top without breaking,\n            # its momentum is not deposited in the specified domain.\n            \n        # Format results for the current case\n        case_results_rounded = [round(val, 6) for val in total_deposition]\n        all_results.append(case_results_rounded)\n    \n    # Format the final output string as specified\n    final_output = f\"[{','.join(str(res_list).replace(' ', '') for res_list in all_results)}]\"\n    # A bit more careful formatting to match the example\n    print(f'[[{\",\".join(f\"{x:.6f}\" for x in all_results[0])}],[{\",\".join(f\"{y:.6f}\" for y in all_results[1])}],[{\",\".join(f\"{z:.6f}\" for z in all_results[2])}]]')\n\nsolve()\n```"
        }
    ]
}