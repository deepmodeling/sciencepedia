{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any bulk microphysics scheme is the mathematical representation of the particle size distribution (PSD). Instead of tracking every single particle, these schemes predict the evolution of a few key bulk properties, or moments, of an assumed PSD form. This first practice invites you to work directly with the widely used three-parameter gamma distribution, deriving expressions for two of the most fundamental bulk quantities: the total number concentration ($N_r$) and the rainwater mixing ratio ($q_r$). By also exploring the sensitivity of these quantities to the distribution's parameters , you will gain a deeper appreciation for the sources of uncertainty in microphysical parameterizations.",
            "id": "3867735",
            "problem": "Consider a warm-rain bulk microphysics parameterization in which the raindrop population is described by a gamma-form drop size distribution (DSD). The DSD is given by $n(D) = N_{0} D^{\\mu} \\exp(-\\lambda D)$ for $D \\in [0,\\infty)$, where $D$ is the drop diameter, $N_{0}  0$ is the intercept parameter, $\\mu  -1$ is the shape parameter, and $\\lambda  0$ is the slope parameter. The single-drop mass is given by $m(D) = \\alpha D^{\\beta}$, with $\\alpha  0$ and $\\beta  0$ constant in the warm-rain regime. The total rain number concentration $N_{r}$ and rain water mixing ratio $q_{r}$ are defined by the integrals\n$$N_{r} = \\int_{0}^{\\infty} n(D)\\,\\mathrm{d}D,$$\n$$q_{r} = \\frac{1}{\\rho}\\int_{0}^{\\infty} m(D)\\,n(D)\\,\\mathrm{d}D,$$\nwhere $\\rho  0$ is the air density. Assume the integrals converge under the stated parameter constraints. Using only these definitions and standard integral identities, derive closed-form expressions for $N_{r}$ and $q_{r}$ in terms of $N_{0}$, $\\alpha$, $\\beta$, $\\mu$, $\\lambda$, and $\\rho$. Then, quantify sensitivity to the shape and slope parameters by deriving the following dimensionless sensitivities:\n$$S_{\\mu}(N_{r}) = \\frac{\\partial \\ln N_{r}}{\\partial \\mu}, \\quad S_{\\lambda}(N_{r}) = \\frac{\\partial \\ln N_{r}}{\\partial \\ln \\lambda},$$\n$$S_{\\mu}(q_{r}) = \\frac{\\partial \\ln q_{r}}{\\partial \\mu}, \\quad S_{\\lambda}(q_{r}) = \\frac{\\partial \\ln q_{r}}{\\partial \\ln \\lambda}.$$\nProvide your final answer as a single closed-form analytic expression containing all six quantities $\\{N_{r},\\,q_{r},\\,S_{\\mu}(N_{r}),\\,S_{\\lambda}(N_{r}),\\,S_{\\mu}(q_{r}),\\,S_{\\lambda}(q_{r})\\}$ arranged in a one-row matrix. No numerical substitution is required, and no rounding is needed. Do not include units in the final expression.",
            "solution": "The problem will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- Drop Size Distribution (DSD): $n(D) = N_{0} D^{\\mu} \\exp(-\\lambda D)$ for $D \\in [0,\\infty)$.\n- DSD parameters: $N_{0}  0$ (intercept), $\\mu  -1$ (shape), $\\lambda  0$ (slope).\n- Single-drop mass: $m(D) = \\alpha D^{\\beta}$, with $\\alpha  0$ and $\\beta  0$.\n- Total rain number concentration: $N_{r} = \\int_{0}^{\\infty} n(D)\\,\\mathrm{d}D$.\n- Rain water mixing ratio: $q_{r} = \\frac{1}{\\rho}\\int_{0}^{\\infty} m(D)\\,n(D)\\,\\mathrm{d}D$.\n- Air density: $\\rho  0$.\n- Constraint: The integrals are assumed to converge.\n- Required outputs: Closed-form expressions for $N_{r}$, $q_{r}$, and four dimensionless sensitivities: $S_{\\mu}(N_{r}) = \\frac{\\partial \\ln N_{r}}{\\partial \\mu}$, $S_{\\lambda}(N_{r}) = \\frac{\\partial \\ln N_{r}}{\\partial \\ln \\lambda}$, $S_{\\mu}(q_{r}) = \\frac{\\partial \\ln q_{r}}{\\partial \\mu}$, and $S_{\\lambda}(q_{r}) = \\frac{\\partial \\ln q_{r}}{\\partial \\ln \\lambda}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in cloud microphysics. The gamma distribution is a standard model for raindrop size distributions. The definitions for number concentration and water mixing ratio are standard integral moments of the DSD. The mass-diameter relationship is physically based. All aspects conform to established principles in atmospheric science.\n- **Well-Posed**: The problem is clearly defined. It provides all necessary functions, parameters, and definitions to derive the required quantities. The constraints on the parameters ($\\mu  -1$, $\\lambda  0$, $\\beta  0$) ensure that the gamma function and the related integrals are well-defined and convergent, as stated. The existence of a unique, stable solution is guaranteed.\n- **Objective**: The problem is stated using precise mathematical language and objective physical definitions. There are no subjective or ambiguous terms.\n- **No Other Flaws**: The problem is complete, consistent, and scientifically feasible within the context of a theoretical model. It is not trivial, as it requires knowledge of integral calculus, specifically the gamma function and its derivatives.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will now be derived.\n\n### Derivation of $N_{r}$ and $q_{r}$\nThe core of this problem relies on the definition of the gamma function, $\\Gamma(z)$, through Euler's integral of the second kind:\n$$ \\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} \\exp(-t) \\,\\mathrm{d}t $$\nA useful variant of this identity is obtained by the substitution $t = kx$, which gives:\n$$ \\int_{0}^{\\infty} x^{z-1} \\exp(-kx) \\,\\mathrm{d}x = \\frac{\\Gamma(z)}{k^{z}} $$\nThis identity will be used to solve the integrals for $N_{r}$ and $q_{r}$.\n\n**1. Expression for Total Number Concentration, $N_{r}$**\nThe total number concentration is defined as:\n$$ N_{r} = \\int_{0}^{\\infty} n(D)\\,\\mathrm{d}D = \\int_{0}^{\\infty} N_{0} D^{\\mu} \\exp(-\\lambda D)\\,\\mathrm{d}D $$\nWe can factor out the constant $N_{0}$:\n$$ N_{r} = N_{0} \\int_{0}^{\\infty} D^{\\mu} \\exp(-\\lambda D)\\,\\mathrm{d}D $$\nThis integral matches the form $\\int_{0}^{\\infty} x^{z-1} \\exp(-kx) \\,\\mathrm{d}x$ with $x=D$, $z-1=\\mu$ (so $z=\\mu+1$), and $k=\\lambda$. The condition $\\mu  -1$ ensures that $z = \\mu+1  0$, for which the gamma function is defined. Applying the identity, we get:\n$$ N_{r} = N_{0} \\frac{\\Gamma(\\mu+1)}{\\lambda^{\\mu+1}} $$\n\n**2. Expression for Rain Water Mixing Ratio, $q_{r}$**\nThe rain water mixing ratio is defined as:\n$$ q_{r} = \\frac{1}{\\rho}\\int_{0}^{\\infty} m(D)\\,n(D)\\,\\mathrm{d}D = \\frac{1}{\\rho}\\int_{0}^{\\infty} (\\alpha D^{\\beta})(N_{0} D^{\\mu} \\exp(-\\lambda D))\\,\\mathrm{d}D $$\nCombining terms and factoring out constants:\n$$ q_{r} = \\frac{\\alpha N_{0}}{\\rho} \\int_{0}^{\\infty} D^{\\mu+\\beta} \\exp(-\\lambda D)\\,\\mathrm{d}D $$\nThis integral also matches the general form with $x=D$, $z-1=\\mu+\\beta$ (so $z=\\mu+\\beta+1$), and $k=\\lambda$. Since $\\mu  -1$ and $\\beta  0$, we have $z=\\mu+\\beta+1  0$. Applying the identity yields:\n$$ q_{r} = \\frac{\\alpha N_{0}}{\\rho} \\frac{\\Gamma(\\mu+\\beta+1)}{\\lambda^{\\mu+\\beta+1}} $$\n\n### Derivation of Dimensionless Sensitivities\nTo find the sensitivities, we first compute the natural logarithm of $N_r$ and $q_r$. We will need the digamma function, $\\psi(z)$, which is defined as the logarithmic derivative of the gamma function: $\\psi(z) = \\frac{\\mathrm{d}}{\\mathrm{d}z}\\ln\\Gamma(z) = \\frac{\\Gamma'(z)}{\\Gamma(z)}$.\n\n**1. Sensitivities of $N_{r}$**\nFirst, take the natural logarithm of $N_{r}$:\n$$ \\ln N_{r} = \\ln \\left(N_{0} \\frac{\\Gamma(\\mu+1)}{\\lambda^{\\mu+1}}\\right) = \\ln N_{0} + \\ln\\Gamma(\\mu+1) - (\\mu+1)\\ln\\lambda $$\nNow we can compute the sensitivities.\nFor $S_{\\mu}(N_r)$:\n$$ S_{\\mu}(N_{r}) = \\frac{\\partial \\ln N_{r}}{\\partial \\mu} = \\frac{\\partial}{\\partial \\mu} [\\ln N_{0} + \\ln\\Gamma(\\mu+1) - (\\mu+1)\\ln\\lambda] $$\n$$ S_{\\mu}(N_{r}) = 0 + \\frac{\\Gamma'(\\mu+1)}{\\Gamma(\\mu+1)} \\cdot \\frac{\\partial(\\mu+1)}{\\partial \\mu} - \\ln\\lambda \\cdot \\frac{\\partial(\\mu+1)}{\\partial \\mu} = \\psi(\\mu+1) - \\ln\\lambda $$\nFor $S_{\\lambda}(N_r)$:\nThe sensitivity to $\\ln\\lambda$ can be computed using the chain rule: $\\frac{\\partial f}{\\partial \\ln x} = x \\frac{\\partial f}{\\partial x}$.\n$$ S_{\\lambda}(N_{r}) = \\frac{\\partial \\ln N_{r}}{\\partial \\ln \\lambda} = \\lambda \\frac{\\partial \\ln N_{r}}{\\partial \\lambda} = \\lambda \\frac{\\partial}{\\partial \\lambda} [\\ln N_{0} + \\ln\\Gamma(\\mu+1) - (\\mu+1)\\ln\\lambda] $$\n$$ S_{\\lambda}(N_{r}) = \\lambda \\left[ 0 + 0 - (\\mu+1)\\frac{1}{\\lambda} \\right] = -(\\mu+1) $$\n\n**2. Sensitivities of $q_{r}$**\nFirst, take the natural logarithm of $q_{r}$:\n$$ \\ln q_{r} = \\ln \\left(\\frac{\\alpha N_{0}}{\\rho} \\frac{\\Gamma(\\mu+\\beta+1)}{\\lambda^{\\mu+\\beta+1}}\\right) = \\ln\\left(\\frac{\\alpha N_{0}}{\\rho}\\right) + \\ln\\Gamma(\\mu+\\beta+1) - (\\mu+\\beta+1)\\ln\\lambda $$\nNow we can compute the sensitivities.\nFor $S_{\\mu}(q_r)$:\n$$ S_{\\mu}(q_{r}) = \\frac{\\partial \\ln q_{r}}{\\partial \\mu} = \\frac{\\partial}{\\partial \\mu} [\\ln\\left(\\frac{\\alpha N_{0}}{\\rho}\\right) + \\ln\\Gamma(\\mu+\\beta+1) - (\\mu+\\beta+1)\\ln\\lambda] $$\n$$ S_{\\mu}(q_{r}) = 0 + \\frac{\\Gamma'(\\mu+\\beta+1)}{\\Gamma(\\mu+\\beta+1)} \\cdot \\frac{\\partial(\\mu+\\beta+1)}{\\partial \\mu} - \\ln\\lambda \\cdot \\frac{\\partial(\\mu+\\beta+1)}{\\partial \\mu} = \\psi(\\mu+\\beta+1) - \\ln\\lambda $$\nFor $S_{\\lambda}(q_r)$:\n$$ S_{\\lambda}(q_{r}) = \\frac{\\partial \\ln q_{r}}{\\partial \\ln \\lambda} = \\lambda \\frac{\\partial \\ln q_{r}}{\\partial \\lambda} = \\lambda \\frac{\\partial}{\\partial \\lambda} [\\ln\\left(\\frac{\\alpha N_{0}}{\\rho}\\right) + \\ln\\Gamma(\\mu+\\beta+1) - (\\mu+\\beta+1)\\ln\\lambda] $$\n$$ S_{\\lambda}(q_{r}) = \\lambda \\left[ 0 + 0 - (\\mu+\\beta+1)\\frac{1}{\\lambda} \\right] = -(\\mu+\\beta+1) $$\n\nSummary of results:\n1. $N_{r} = N_{0} \\frac{\\Gamma(\\mu+1)}{\\lambda^{\\mu+1}}$\n2. $q_{r} = \\frac{\\alpha N_{0}}{\\rho} \\frac{\\Gamma(\\mu+\\beta+1)}{\\lambda^{\\mu+\\beta+1}}$\n3. $S_{\\mu}(N_{r}) = \\psi(\\mu+1) - \\ln\\lambda$\n4. $S_{\\lambda}(N_{r}) = -(\\mu+1)$\n5. $S_{\\mu}(q_{r}) = \\psi(\\mu+\\beta+1) - \\ln\\lambda$\n6. $S_{\\lambda}(q_{r}) = -(\\mu+\\beta+1)$\n\nThese six expressions will be assembled into a single one-row matrix as requested.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} N_{0} \\frac{\\Gamma(\\mu+1)}{\\lambda^{\\mu+1}}  \\frac{\\alpha N_{0}}{\\rho} \\frac{\\Gamma(\\mu+\\beta+1)}{\\lambda^{\\mu+\\beta+1}}  \\psi(\\mu+1) - \\ln\\lambda  -(\\mu+1)  \\psi(\\mu+\\beta+1) - \\ln\\lambda  -(\\mu+\\beta+1) \\end{pmatrix} } $$"
        },
        {
            "introduction": "Having explored the statistical representation of hydrometeors, we now turn to one of the most critical dynamic processes: the exchange of mass between water vapor and liquid cloud water. In atmospheric models, this is handled by a procedure known as saturation adjustment, which brings supersaturated or subsaturated air parcels back toward equilibrium. This exercise challenges you to derive the governing system for saturation adjustment from first principles, namely the conservation of total water and moist enthalpy . This fundamental practice illuminates the direct link between latent heat release during phase change and the resulting change in air temperature.",
            "id": "3867671",
            "problem": "Consider a warm-rain, one-moment bulk microphysics saturation-adjustment step applied to a single, well-mixed atmospheric grid cell at fixed pressure. The prognostic variables before adjustment are the water vapor mass mixing ratio $q_v$ (kilogram of vapor per kilogram of moist air), the cloud-liquid water mass mixing ratio $q_c$ (kilogram of liquid per kilogram of moist air), and the temperature $T$ (Kelvin). The saturation adjustment instantaneously relaxes the thermodynamic state to a saturated or subsaturated equilibrium by exchanging mass between $q_v$ and $q_c$ while conserving total water and moist enthalpy.\n\nAssume the following foundational principles and closures:\n- Conservation of total water: $q_t = q_v + q_c$ is invariant through the adjustment.\n- Conservation of moist enthalpy in the warm (ice-free) phase: $h = c_{pd}\\,T + L_v\\,q_v$ is invariant, where $c_{pd}$ is the specific heat of dry air at constant pressure and $L_v$ is the latent heat of vaporization, treated as constant.\n- The saturation vapor pressure $e_s(T)$ over liquid water follows the integrated Clausius–Clapeyron relation with constant $L_v$: \n$$\ne_s(T) \\;=\\; e_{s0}\\,\\exp\\!\\Bigg[\\frac{L_v}{R_v}\\Bigg(\\frac{1}{T_0}-\\frac{1}{T}\\Bigg)\\Bigg],\n$$\nwhere $e_{s0}$ is the saturation vapor pressure at reference temperature $T_0$ and $R_v$ is the specific gas constant for water vapor.\n- The saturation water vapor mixing ratio at pressure $p$ is \n$$\nq_{vs}(T,p) \\;=\\; \\epsilon\\,\\frac{e_s(T)}{p - e_s(T)},\n$$\nwith $\\epsilon = R_d/R_v$ and $R_d$ the specific gas constant for dry air.\n\nStarting from these principles, and without invoking any pre-derived saturation-adjustment formulas, perform the following:\n\n1. Derive the nonlinear system that determines the post-adjustment state $(T',\\,q_v',\\,q_c')$ given the pre-adjustment $(q_v,\\,q_c,\\,T)$ and fixed pressure $p$. Your system must be written in terms of conservation of $q_t$ and $h$, together with the thermodynamic saturation constraint that applies when liquid is present after adjustment. Clearly distinguish the cases that arise depending on whether the post-adjustment state is saturated with liquid present or subsaturated with all liquid evaporated.\n\n2. For the specific initial state and constants\n$$\nT \\;=\\; 283 \\text{ K},\\quad p \\;=\\; 9.0000\\times 10^{4} \\text{ Pa},\\quad q_v \\;=\\; 0.0120,\\quad q_c \\;=\\; 0,\n$$\nand\n$$\nc_{pd} \\;=\\; 1004 \\text{ J kg}^{-1}\\text{ K}^{-1},\\quad L_v \\;=\\; 2.500\\times 10^{6} \\text{ J kg}^{-1},\\quad R_v \\;=\\; 461 \\text{ J kg}^{-1}\\text{ K}^{-1},\\quad \\epsilon \\;=\\; 0.622,\n$$\n$$\ne_{s0} \\;=\\; 611.2 \\text{ Pa},\\quad T_0 \\;=\\; 273.15 \\text{ K},\n$$\nuse your nonlinear system to determine the adjusted temperature $T'$ that satisfies enthalpy conservation and the appropriate vapor–liquid thermodynamic constraint. Round your answer to four significant figures. Express the final temperature in Kelvin.\n\nYour derivation must make explicit how the latent heat release or absorption associated with phase change couples into the temperature tendency through the enthalpy constraint. The final reported answer must be a single numerical value for $T'$ as specified above.",
            "solution": "The problem is divided into two parts: First, the derivation of the governing equations for a saturation adjustment process, and second, the application of these equations to find a final adjusted temperature for a specific initial state.\n\n### Part 1: Derivation of the Nonlinear System\n\nLet the initial state of the atmospheric grid cell be described by temperature $T$, water vapor mass mixing ratio $q_v$, and cloud-liquid water mass mixing ratio $q_c$. The pressure $p$ is held constant. The saturation adjustment process results in a final state $(T', q_v', q_c')$.\n\nThe process is governed by two fundamental conservation principles:\n\n1.  **Conservation of Total Water:** The total water mass mixing ratio, $q_t$, which is the sum of vapor and liquid phases, is conserved.\n    $$q_t = q_v + q_c = q_v' + q_c'$$\n\n2.  **Conservation of Moist Enthalpy:** The moist enthalpy, $h$, as defined in the problem, is also conserved.\n    $$h = c_{pd}T + L_v q_v = c_{pd}T' + L_v q_v'$$\n\nFrom the enthalpy conservation equation, we can isolate the relationship between the change in temperature and the change in water vapor.\n$$c_{pd}(T' - T) = L_v q_v - L_v q_v' = L_v(q_v - q_v')$$\nThis equation explicitly demonstrates the coupling between latent heat exchange and temperature. Condensation, where vapor is converted to liquid, implies $q_v'  q_v$, which leads to a release of latent heat and an increase in temperature, $T'  T$. Conversely, evaporation ($q_v'  q_v$) consumes latent heat, causing cooling ($T'  T$).\n\nThe final state of the system depends on whether it is saturated or subsaturated. This leads to two distinct cases. The condition for saturation is that the water vapor mixing ratio equals the saturation water vapor mixing ratio, $q_{vs}(T,p)$, which is a function of temperature and pressure.\n\n**Case 1: Subsaturated Final State**\nThis scenario occurs if the final state contains no liquid water, i.e., $q_c' = 0$. This can happen if an initially subsaturated parcel with some cloud water evaporates all of it, but remains subsaturated.\nIf $q_c' = 0$, then from total water conservation, the final vapor mixing ratio is equal to the total water mixing ratio:\n$$q_v' = q_t = q_v + q_c$$\nThe final temperature $T'$ is determined by enthalpy conservation:\n$$c_{pd}T' + L_v(q_v + q_c) = c_{pd}T + L_v q_v$$\n$$T' = T - \\frac{L_v q_c}{c_{pd}}$$\nThis final state is physically consistent only if the parcel is indeed subsaturated, meaning:\n$$q_v' \\le q_{vs}(T', p) \\quad \\text{or} \\quad q_t \\le q_{vs}\\left(T - \\frac{L_v q_c}{c_{pd}}, p\\right)$$\nIf this condition is not met, it implies that saturation is reached before all cloud water evaporates, and the system must be treated under Case 2. If the initial state has $q_c=0$ and is not supersaturated ($q_v \\le q_{vs}(T,p)$), no adjustment occurs, and $(T', q_v', q_c') = (T, q_v, q_c)$.\n\n**Case 2: Saturated Final State**\nThis scenario occurs if the final state contains some amount of liquid water, $q_c' \\ge 0$. This is the result if the initial parcel is supersaturated ($q_v  q_{vs}(T,p)$), or if it is initially subsaturated but has enough cloud water to reach saturation upon partial evaporation. The defining constraint for this case is that the final vapor mixing ratio is exactly the saturation value at the final temperature:\n$$q_v' = q_{vs}(T', p)$$\nThe system of equations governing the final state $(T', q_v', q_c')$ is:\n1.  $q_v' + q_c' = q_t$\n2.  $c_{pd}T' + L_v q_v' = h$\n3.  $q_v' = q_{vs}(T', p) = \\epsilon \\frac{e_s(T')}{p - e_s(T')}$, with $e_s(T') = e_{s0}\\exp\\left[\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T'}\\right)\\right]$\n\nTo solve for the final temperature $T'$, we can reduce this to a single nonlinear equation. From the enthalpy conservation equation (2), we express $q_v'$ in terms of $T'$:\n$$q_v' =  q_v + \\frac{c_{pd}}{L_v}(T-T')$$\nEquating this with the saturation constraint (3), we get a single nonlinear equation for the unknown final temperature $T'$:\n$$q_v + \\frac{c_{pd}}{L_v}(T-T') = q_{vs}(T', p)$$\nThis is a transcendental equation that must be solved for $T'$. Once $T'$ is found, $q_v'$ is computed from the saturation constraint, and $q_c'$ is found from water conservation: $q_c' = q_t - q_v'$.\n\n### Part 2: Numerical Solution\n\nWe are given the initial state and constants:\n-   $T = 283 \\text{ K}$\n-   $p = 9.0000 \\times 10^{4} \\text{ Pa}$\n-   $q_v = 0.0120$\n-   $q_c = 0$\n-   $c_{pd} = 1004 \\text{ J kg}^{-1}\\text{ K}^{-1}$\n-   $L_v = 2.500 \\times 10^{6} \\text{ J kg}^{-1}$\n-   $R_v = 461 \\text{ J kg}^{-1}\\text{K}^{-1}$\n-   $\\epsilon = 0.622$\n-   $e_{s0} = 611.2 \\text{ Pa}$\n-   $T_0 = 273.15 \\text{ K}$\n\nFirst, we must determine if the initial state is supersaturated. We calculate the saturation vapor pressure $e_s$ at the initial temperature $T = 283 \\text{ K}$.\nThe exponent in the Clausius-Clapeyron equation is:\n$$\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right) = \\frac{2.500 \\times 10^{6}}{461}\\left(\\frac{1}{273.15} - \\frac{1}{283}\\right) \\approx 5422.993 \\times (0.003660955 - 0.003533569) \\approx 0.69095$$\nSo, the saturation vapor pressure is:\n$$e_s(283 \\text{ K}) = 611.2 \\text{ Pa} \\times \\exp(0.69095) \\approx 611.2 \\text{ Pa} \\times 1.9956 \\approx 1220.0 \\text{ Pa}$$\nNext, we calculate the saturation water vapor mixing ratio $q_{vs}$ at this temperature and the given pressure $p = 9.0000 \\times 10^4 \\text{ Pa}$.\n$$q_{vs}(283 \\text{ K}, 90000 \\text{ Pa}) = \\epsilon \\frac{e_s(T)}{p - e_s(T)} \\approx 0.622 \\times \\frac{1220.0}{90000 - 1220.0} \\approx 0.622 \\times \\frac{1220.0}{88780} \\approx 0.008547$$\nComparing the initial water vapor mixing ratio $q_v = 0.0120$ to the saturation value $q_{vs} \\approx 0.00855$, we find that $q_v  q_{vs}$. The parcel is supersaturated.\n\nSince the parcel is supersaturated, condensation will occur, and the final state must be saturated (Case 2). We must solve the nonlinear equation for $T'$:\n$$f(T') = q_v + \\frac{c_{pd}}{L_v}(T - T') - q_{vs}(T', p) = 0$$\nSubstituting the given values:\n$$f(T') = 0.0120 + \\frac{1004}{2.500 \\times 10^{6}}(283 - T') - q_{vs}(T', 9.0000 \\times 10^4) = 0$$\n$$f(T') = 0.0120 + 4.016 \\times 10^{-4}(283 - T') - 0.622 \\frac{e_s(T')}{9.0000 \\times 10^4 - e_s(T')} = 0$$\nThis equation must be solved numerically for $T'$. We expect $T'  T = 283 \\text{ K}$ because condensation releases latent heat. We can search for the root of $f(T')$.\n\nLet's test $T' = 286.2 \\text{ K}$:\n$e_s(286.2 \\text{ K}) = 611.2 \\exp\\left[5422.99\\left(\\frac{1}{273.15} - \\frac{1}{286.2}\\right)\\right] \\approx 1510.4 \\text{ Pa}$\n$q_{vs}(286.2 \\text{ K}) \\approx 0.622 \\frac{1510.4}{90000 - 1510.4} \\approx 0.010616$\n$f(286.2) \\approx 0.0120 + 4.016 \\times 10^{-4}(283 - 286.2) - 0.010616$\n$f(286.2) \\approx 0.0120 - 0.001285 - 0.010616 = +0.000099$\n\nLet's test $T' = 286.3 \\text{ K}$:\n$e_s(286.3 \\text{ K}) = 611.2 \\exp\\left[5422.99\\left(\\frac{1}{273.15} - \\frac{1}{286.3}\\right)\\right] \\approx 1520.4 \\text{ Pa}$\n$q_{vs}(286.3 \\text{ K}) \\approx 0.622 \\frac{1520.4}{90000 - 1520.4} \\approx 0.010688$\n$f(286.3) \\approx 0.0120 + 4.016 \\times 10^{-4}(283 - 286.3) - 0.010688$\n$f(286.3) \\approx 0.0120 - 0.001325 - 0.010688 = -0.000013$\n\nSince $f(286.2)  0$ and $f(286.3)  0$, the root $T'$ lies between $286.2 \\text{ K}$ and $286.3 \\text{ K}$. Linear interpolation suggests the root is much closer to $286.3 \\text{ K}$. More precise calculation gives $T' \\approx 286.288 \\text{ K}$.\n\nThe problem requires rounding the answer to four significant figures.\n$$T' \\approx 286.288 \\text{ K} \\rightarrow 286.3 \\text{ K}$$",
            "answer": "$$\\boxed{286.3}$$"
        },
        {
            "introduction": "A physical parameterization is only as good as its numerical implementation within a model. Physical processes can introduce constraints that dictate how the model must be run to ensure a stable and realistic solution. In this final practice, we examine the process of sedimentation—the falling of hydrometeors due to gravity—which is modeled as a vertical advection problem . You will apply the famous Courant-Friedrichs-Lewy (CFL) stability condition to determine the maximum allowable time step, a crucial skill for understanding the computational trade-offs inherent in atmospheric modeling.",
            "id": "3867742",
            "problem": "In a one-dimensional vertical column model used for cloud microphysics parameterization, the sedimentation tendency of a hydrometeor mass mixing ratio is treated as an advective flux with a constant downward terminal fall speed within each hydrometeor category over a single model time step. For an explicit time-stepping implementation with a first-order upwind spatial flux, consider a configuration with a vertically stretched grid: from $z=0$ to $z=2 \\ \\mathrm{km}$, the layer thickness is $\\Delta z = 50 \\ \\mathrm{m}$, and above $z=2 \\ \\mathrm{km}$ up to $z=10 \\ \\mathrm{km}$, the layer thickness is $\\Delta z = 250 \\ \\mathrm{m}$. The model large time step is $\\Delta t = 60 \\ \\mathrm{s}$. Observations and the bulk microphysics fall-speed parameterization indicate a maximum hydrometeor terminal velocity across the column of $V_{\\text{max}} = 8 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$ for the sedimenting category over the current time step.\n\nAssume an explicit Euler time integration and a first-order upwind flux formulation for the sedimentation operator applied to a passive scalar representative of a hydrometeor mass mixing ratio. The Courant-Friedrichs-Lewy (CFL) number is defined, for a given layer of thickness $\\Delta z$, as $C = V_{\\text{max}} \\Delta t / \\Delta z$.\n\nUsing first principles of conservation and stability analysis for linear advection, evaluate the relevant non-dimensional Courant number for the most restrictive layer and determine the minimum integer number of equal substeps $N$ into which the large time step $\\Delta t$ must be subdivided, such that the per-substep implementation of the sedimentation operator is numerically stable everywhere in the column. Report only the minimum integer number $N$. No rounding by significant figures is required because $N$ is an integer.",
            "solution": "The problem requires determining the minimum integer number of substeps, $N$, needed to ensure the numerical stability of a sedimentation scheme in a cloud microphysics model. The sedimentation of the hydrometeor mass mixing ratio, $q$, is modeled as a one-dimensional vertical advection process.\n\nLet $z$ be the vertical coordinate, positive upwards. The sedimentation process is characterized by a downward terminal fall speed, $V_f$, which is a positive value. The velocity of the hydrometeors is therefore $v_z = -V_f$. The governing partial differential equation for this process is the 1D advection equation:\n$$\n\\frac{\\partial q}{\\partial t} + v_z \\frac{\\partial q}{\\partial z} = 0 \\implies \\frac{\\partial q}{\\partial t} - V_f \\frac{\\partial q}{\\partial z} = 0\n$$\n\nThe problem specifies a numerical solution using an explicit Euler method for time integration and a first-order upwind scheme for the spatial flux. Let's discretize the equation. Let $q_j^n$ be the value of the mixing ratio in grid cell $j$ at time step $n$. The grid cells are indexed such that $j$ increases with $z$. The time step for the integration is a substep $\\Delta t'$, and the thickness of a grid layer is $\\Delta z_j$.\n\nThe time derivative is approximated by a forward difference (explicit Euler):\n$$\n\\frac{\\partial q}{\\partial t} \\approx \\frac{q_j^{n+1} - q_j^n}{\\Delta t'}\n$$\n\nFor the spatial derivative, the first-order upwind scheme uses information from the direction the flow is coming from. Since the velocity is negative ($v_z  0$), the flow is downward, from cell $j+1$ to cell $j$. Therefore, the \"upwind\" value is at cell $j+1$. A finite volume discretization of the advective flux divergence, $-\\frac{\\partial (v_z q)}{\\partial z}$, for cell $j$ is commonly used.\nThe time rate of change of $q_j$ is given by the net flux into the cell:\n$$\n\\frac{dq_j}{dt} = -\\frac{F_{j+1/2} - F_{j-1/2}}{\\Delta z_j}\n$$\nwhere $F_{j+1/2}$ is the flux at the interface between cells $j$ and $j+1$. For first-order upwinding with a negative velocity $v_z = -V_f$, the flux is determined by the \"upwind\" cell, which is the cell above.\nFlux at the top interface of cell $j$: $F_{j+1/2} = v_z q_{j+1} = -V_f q_{j+1}$.\nFlux at the bottom interface of cell $j$: $F_{j-1/2} = v_z q_{j} = -V_f q_{j}$.\nSubstituting these into the flux-divergence form:\n$$\n\\frac{dq_j}{dt} = - \\frac{(-V_f q_{j+1}) - (-V_f q_j)}{\\Delta z_j} = -V_f \\frac{q_j - q_{j+1}}{\\Delta z_j}\n$$\nCombining with the explicit Euler time-stepping:\n$$\n\\frac{q_j^{n+1} - q_j^n}{\\Delta t'} = -V_f \\frac{q_j^n - q_{j+1}^n}{\\Delta z_j}\n$$\nRearranging to solve for $q_j^{n+1}$:\n$$\nq_j^{n+1} = q_j^n - \\frac{V_f \\Delta t'}{\\Delta z_j} (q_j^n - q_{j+1}^n)\n$$\nLet's define the Courant number for the substep as $C' = \\frac{V_f \\Delta t'}{\\Delta z_j}$.\n$$\nq_j^{n+1} = q_j^n - C'(q_j^n - q_{j+1}^n) = (1 - C')q_j^n + C'q_{j+1}^n\n$$\nFor this numerical scheme to be stable, the solution must not amplify spuriously over time. A sufficient condition for stability (and for ensuring non-negative values of $q$, which is physically required for a mixing ratio) is that the coefficients of $q_j^n$ and $q_{j+1}^n$ in the update equation are non-negative.\n1. $C' \\ge 0$: This is satisfied, as $V_f$, $\\Delta t'$, and $\\Delta z_j$ are all positive.\n2. $1 - C' \\ge 0 \\implies C' \\le 1$.\n\nThis leads to the Courant-Friedrichs-Lewy (CFL) stability condition for this specific scheme:\n$$\nC' = \\frac{V_f \\Delta t'}{\\Delta z_j} \\le 1\n$$\nThis condition must hold for all grid layers $j$ and for any possible fall speed $V_f$. To ensure stability everywhere in the column, we must consider the most restrictive case, which involves the maximum fall speed, $V_{\\text{max}}$, and the minimum grid spacing, $\\Delta z_{\\text{min}}$. The stability criterion for the entire system is:\n$$\n\\frac{V_{\\text{max}} \\Delta t'}{\\Delta z_{\\text{min}}} \\le 1\n$$\nThe problem states that the large model time step, $\\Delta t = 60 \\ \\mathrm{s}$, is to be subdivided into $N$ equal substeps. The duration of each substep is $\\Delta t' = \\frac{\\Delta t}{N}$. Substituting this into the stability criterion:\n$$\n\\frac{V_{\\text{max}} (\\Delta t / N)}{\\Delta z_{\\text{min}}} \\le 1\n$$\nWe need to find the minimum integer $N$ that satisfies this inequality. Rearranging for $N$:\n$$\nN \\ge \\frac{V_{\\text{max}} \\Delta t}{\\Delta z_{\\text{min}}}\n$$\nThe term on the right-hand side is the maximum Courant number, $C_{\\text{max}}$, that would be realized if the large time step $\\Delta t$ were used directly.\n\nFrom the problem statement, we have:\n- Maximum terminal velocity, $V_{\\text{max}} = 8 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$.\n- Large time step, $\\Delta t = 60 \\ \\mathrm{s}$.\n- The grid has two different layer thicknesses: $\\Delta z = 50 \\ \\mathrm{m}$ and $\\Delta z = 250 \\ \\mathrm{m}$.\n\nThe minimum layer thickness is $\\Delta z_{\\text{min}} = 50 \\ \\mathrm{m}$. This is the layer that is most restrictive for numerical stability.\n\nNow we calculate the value of the right-hand side:\n$$\nC_{\\text{max}} = \\frac{V_{\\text{max}} \\Delta t}{\\Delta z_{\\text{min}}} = \\frac{(8 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}) \\times (60 \\ \\mathrm{s})}{50 \\ \\mathrm{m}} = \\frac{480}{50} = 9.6\n$$\nThe condition on $N$ is therefore:\n$$\nN \\ge 9.6\n$$\nSince $N$ must be an integer (as it represents the number of substeps), we must find the smallest integer that satisfies this condition. This is achieved by taking the ceiling of $9.6$.\n$$\nN_{\\text{min}} = \\lceil 9.6 \\rceil = 10\n$$\nThus, the large time step $\\Delta t$ must be subdivided into a minimum of $10$ equal substeps to ensure the sedimentation operator is numerically stable throughout the entire vertical column.",
            "answer": "$$\\boxed{10}$$"
        }
    ]
}