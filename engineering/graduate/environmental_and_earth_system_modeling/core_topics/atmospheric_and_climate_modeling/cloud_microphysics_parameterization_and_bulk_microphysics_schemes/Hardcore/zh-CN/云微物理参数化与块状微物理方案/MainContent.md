## 引言
云是地球气候系统中最复杂多变且至关重要的组成部分，它们调控着地球的能量平衡和[水循环](@entry_id:144834)。然而，驱动云生消演变的微物理过程——如云滴的凝结、碰撞和冰晶的形成——发生在微米到毫米的尺度上，远小于[地球系统模型](@entry_id:1124096)的典型网格尺寸。如何在计算资源有限的情况下，准确地在宏观模型中表示这些微观过程，是现代大气科学面临的核心挑战之一。这就是[云微物理参数化](@entry_id:1122518)方案的用武之地。

本文旨在系统性地剖析[云微物理参数化](@entry_id:1122518)中的主流方法——体相（bulk）微物理方案。我们将带领读者深入理解这些方案如何将复杂的物理现象简化为可计算的数学表达式，以及它们在现代科学研究中的广泛应用。

在接下来的内容中，读者将首先在“原理与机制”一章中学习体相方案的基本概念，包括其如何使用粒子尺度[分布的矩](@entry_id:156454)来描述云，以及如何[参数化](@entry_id:265163)关键的暖雨和冰相过程。随后，“应用与跨学科联系”一章将展示这些方案在天气预报、气候模拟、[气溶胶-云相互作用](@entry_id:1120855)以及遥感数据对比等领域的实际应用和前沿进展。最后，“动手实践”部分将提供具体的计算练习，以加深对理论知识的理解。

现在，让我们从第一部分开始，深入探讨这些[参数化](@entry_id:265163)方案的内部工作原理与基本机制。

## 原理与机制

继上一章对云微物理过程及其在[地球系统模型](@entry_id:1124096)中重要性的宏观介绍之后，本章将深入探讨[云微物理参数化](@entry_id:1122518)方案的核心——“体相（bulk）”微物理方案的内部工作原理与基本机制。我们将从描述云中[水凝物](@entry_id:1126277)粒子群的基本方法出发，逐步揭示体相方案如何通过一系列巧妙的近似与[参数化](@entry_id:265163)，以计算上可行的成本，来模拟复杂而精细的微物理过程。我们将探讨这些方案如何定义和预测不同的[水凝物](@entry_id:1126277)类别，如何表示它们之间的转化，以及在与模式的动力学和[热力学](@entry_id:172368)核心耦合时所面临的挑战。

### 微物理[表示的核](@entry_id:202190)心分野：bin方案与bulk方案

要在数值模型中表示云，核心挑战在于如何描述数量庞大、大小各异的云滴、冰晶等[水凝物](@entry_id:1126277)粒子。这些粒子构成的群体，其统计特征由 **粒子尺度分布（Particle Size Distribution, PSD）** $n(D)$ 来描述，其中 $n(D)dD$ 表示单位体积空气中，直径在 $[D, D+dD]$ 范围内的粒子数量。几乎所有的微物理过程——如凝结/蒸发、碰撞-合并、沉降——的速率都深刻地依赖于PSD的详细形态。因此，如何表示和预报 $n(D)$ 的演变，是微物理方案设计的根本出发点。目前主要存在两大类方法：bin方案和bulk方案。

**bin微物理方案**，或称档次方案，是对PSD最直接的[数值近似](@entry_id:161970)。它将整个粒子尺度谱分割成一系列离散的尺寸“档”（bins），然后为每个档预报粒子数浓度或质量。例如，它可以预报直径在10-20微米、20-30微米等范围内的粒子数量。在这种框架下，物理过程的计算是显式的：

*   **碰撞-合并**：通过求解所谓的 **动力学收集方程（Kinetic Collection Equation, KCE）**，显式计算任意两个档次之间的粒子碰撞频率，并将合并后的新粒子分配到其对应质量的更大档次中。
*   **凝结增长**：该过程在尺度空间中表现为一种“平流”，即粒子因水汽凝结而逐渐长大，从而从一个档次“流向”下一个更大的档次。bin方案通过求解尺度空间中的[连续性方程](@entry_id:195013)来显式计算这一通量。
*   **沉降**：由于不同大小的粒子具有不同的 **[终端下落速度](@entry_id:1132946)** $v_t(D)$，bin方案会为每个档次分别计算其沉降通量，然后加总得到总通量。

尽管bin方案因其对PSD的精细解析而被视为“准精确”的基准，但其计算成本极为高昂，通常需要数十个甚至更多的档次，每个档次都需要独立的[预报方程](@entry_id:1130221)和复杂的跨档次相互作用计算，这使得它们难以在长期的气候模拟或业务天气预报中广泛应用。

**体相（bulk）微物理方案** 则采取了完全不同的策略，旨在实现[计算效率](@entry_id:270255)与物理真实性之间的平衡。它放弃了对PSD详细形状的追踪，转而只预报其几个低阶的 **矩（moments）**。一个分布的 $k$ 阶矩定义为 $M_k = \int_0^\infty D^k n(D) dD$。通过这种方式，复杂的PSD函数被简化为几个宏观的体相量。这是所有体相方案的基石。

### 体相方案的语言：矩与预报变量

体相方案通过预报矩来描述[水凝物](@entry_id:1126277)群体的整体特征。其中，最低阶的几个矩具有明确的物理意义，构成了体相方案的“语言”。

对于任何一种[水凝物](@entry_id:1126277)（如云滴、雨滴），我们最关心的两个宏观属性是它的 **数浓度（number concentration）** $N_x$（单位体积空气中的粒子总数）和 **质量混合比（mass mixing ratio）** $q_x$（单位质量湿空气中的[水凝物](@entry_id:1126277)质量）。这两个量与PSD的矩直接相关。

*   **数浓度 ($N_x$)**: 根据其定义，数浓度是PSD在整个尺度谱上的积分，这恰好是PSD的 **零阶矩 ($M_0$)**。
    $N_x = \int_0^\infty n_x(D) dD = M_0$

*   **质量混合比 ($q_x$)**: 假设粒子是密度为 $\rho_w$ 的球体，单个粒子的质量为 $m(D) = (\pi \rho_w / 6) D^3$。单位体积空气中的总液水含量 $L_x$ 就是对所有粒子的质量进行积分：
    $L_x = \int_0^\infty m(D) n_x(D) dD = \frac{\pi \rho_w}{6} \int_0^\infty D^3 n_x(D) dD = \frac{\pi \rho_w}{6} M_3$
    质量[混合比](@entry_id:1127970) $q_x$ 是液水含量 $L_x$ 除以空气密度 $\rho_{air}$ 得到的，因此 $q_x$ 与PSD的 **三阶矩 ($M_3$)** 成正比。

此外，其他[高阶矩](@entry_id:266936)也与其他可观测物理量相关。例如，**雷达[反射率](@entry_id:172768)因子** $Z$ 与六阶矩 $M_6$ 成正比，因为它是粒子直径六次方的总和。

基于预报哪些矩，体相方案可以被分为不同复杂度的类别 ：

*   **单矩（1M）方案**：这是最简单的形式，对每种[水凝物](@entry_id:1126277)只预报一个矩。出于模式中水量守恒和能量守恒的核心要求，这个被预报的量几乎总是质量[混合比](@entry_id:1127970) $q_x$（与$M_3$相关）。数浓度 $N_x$（$M_0$）则必须通过诊断关系（例如，假设其为常数或依赖于温度）或经验公式来估算。

*   **双矩（2M）方案**：为了更真实地模拟PSD的演变，[双矩方案](@entry_id:1123945)为每种[水凝物](@entry_id:1126277)预报两个独立的矩。最常见的选择是质量混合比 $q_x$ ($M_3$) 和数浓度 $N_x$ ($M_0$)。预报这两个量使得方案能够独立地改变粒子的平均尺寸（例如，通过 $M_3/M_0$ 的比值来体现），这对于准确模拟成核（增加$N_x$）、蒸发和碰撞-合并（守恒$q_x$但减少$N_x$）等过程至关重要。

*   **三矩（3M）方案**：更高级的方案会预报第三个矩，通常是为了更好地约束PSD的宽度或形状。例如，除了 $q_x$ 和 $N_x$，还可以预报雷达[反射率](@entry_id:172768)因子 $Z$（$M_6$）。这为PSD的形状提供了额外的自由度，使其能够更灵活地响应不同的物理过程。

### 闭合问题与PSD假定

体相方案的核心挑战在于所谓的 **“闭合问题”（closure problem）**。[预报方程](@entry_id:1130221)描述的是某个矩（如$M_3$）随时间的变化率，但这个变化率的表达式（例如，由碰撞-合并过程引起）往往依赖于更高阶的矩，甚至是整个未知的PSD函数 $n(D)$ 本身。例如，计算碰撞-合并过程对 $M_3$ 的贡献需要一个涉及 $n(D)$ 和 $n(D')$ 的双重积分。我们如何仅使用已知的低阶矩（如 $M_0$ 和 $M_3$）来估算这个复杂的积分呢？

解决方案是引入一个关键的近似：**假定PSD具有一个特定的[解析函数](@entry_id:139584)形式**。一旦假定了 $n(D)$ 的函数形状，其所有参数都可以用少数几个被预报的矩来表示。这样，任何关于 $n(D)$ 的复杂积分都可以被预先计算或表示为这些预报矩的[代数函数](@entry_id:187534)，从而使方程组“闭合”。

常用的PSD函数形式包括 ：

*   **[指数分布](@entry_id:273894)**：$n(D) = N_0 \exp(-\lambda D)$。这是最简单的形式，由截距 $N_0$ 和斜率 $\lambda$ 两个参数确定。它在描述某些降水过程（如Marshall-Palmer分布）时表现良好，但灵活性有限。对于一个[双矩方案](@entry_id:1123945)，已知 $M_0$ 和 $M_3$ 足以唯一确定 $N_0$ 和 $\lambda$。

*   **Gamma分布**：$n(D) = N_0 D^\mu \exp(-\lambda D)$。这是一个三参数分布，引入了一个 **[形状参数](@entry_id:270600)** $\mu$，它能更好地描述谱的曲率和在小粒子端的行为。由于只有两个预报矩（在2M方案中），必须对第三个参数（通常是$\mu$）做出假定，例如将其设为一个常数。这个分布形式因其灵活性而广泛用于表示雨滴谱。

*   **对数正态分布**：$n(D) = \frac{N_t}{\sqrt{2\pi}\sigma_g D} \exp\left[-\frac{(\ln D - \ln D_g)^2}{2\sigma_g^2}\right]$。该分布由总数浓度 $N_t$、几何平均直径 $D_g$ 和几何标准差 $\sigma_g$ 描述。从物理上看，云滴的初始增长主要通过凝结过程，这是一个[乘性](@entry_id:187940)过程（增长率与现有表面积相关），根据中心极限定理，多个独立的乘性过程的叠加会趋向于一个对数正态分布。因此，对数正态分布被认为是描述云滴谱的理想选择。

通过选择合适的PSD函数形式，并利用预报的矩来确定其参数，体相方案就构建了一个完整的、自洽的框架，用于估算所有微物理过程的速率。

### 微物理过程的[参数化](@entry_id:265163)

有了矩和假定PSD这两个工具，我们现在可以具体看看各种关键微物理过程是如何在体相方案中被[参数化](@entry_id:265163)表示的。

#### 暖雨过程

暖雨过程主要涉及液态水滴之间的相互作用，核心是碰撞-合并。

**1. 随机收集方程（SCE）的近似**

从第一性原理出发，粒子群的碰撞-合并演变由 **随机收集方程（Stochastic Collection Equation, SCE）** 描述。该方程包含一个 **增益项**（两个较小液滴$D'$和$D''$合并形成一个液滴$D$）和一个 **损失项**（液滴$D$与任何其他液滴碰撞而消失）。

$$ \frac{\partial n(D,t)}{\partial t} = \frac{1}{2} \int_{0}^{\infty}\int_{0}^{\infty} K(D',D'') n(D') n(D'') \delta(m(D)-m(D')-m(D'')) dD'dD'' - n(D,t) \int_{0}^{\infty} K(D,D') n(D') dD' $$

这里的 $1/2$ 因子是为了避免在积分中重复计算相同的碰撞对。体相方案的目标就是用预报矩来近似这个方程中的积分项。例如，总数浓度的变化率（即总碰撞率）可以近似为：

$$ \frac{dM_0}{dt} = -\frac{1}{2} \int_{0}^{\infty}\int_{0}^{\infty} K(D,D') n(D) n(D') dD dD' \approx -\frac{1}{2} \overline{K} M_0^2 $$

其中 $\overline{K}$ 是一个用假定PSD形状加权平均得到的 **有效核函数**。通过这种方式，复杂的积分运算被转化为简单的矩间代数关系。

**2. [自动转化与碰并](@entry_id:1121258)**

在体相方案中，SCE的效应被分解为几个关键的质量传递过程，其中最重要的是 **[自动转化](@entry_id:1121257)（autoconversion）** 和 **[碰并](@entry_id:1122642)（accretion）**。这两个过程描述了云水向雨水的转化。

*   **自动转化**：这是暖雨过程的起始步骤，定义为 **云滴与云滴** 碰撞合并，形成第一个雨滴的过程。在模式中，云滴和雨滴通常由一个尺寸阈值（如半径 $r_t \approx 40 \, \mu\text{m}$）来区分。当两个云滴（尺寸均小于 $r_t$）合并后产生的新液滴尺寸大于 $r_t$ 时，[自动转化](@entry_id:1121257)就发生了。这个过程在云滴谱通过凝结增长而展宽，出现足够多的“大”云滴（半径 $15-25 \, \mu\text{m}$）后才变得显著，因为它们之间开始有足够的相对下落速度差。在[参数化](@entry_id:265163)形式上，自动转化率通常强烈地[非线性依赖](@entry_id:265776)于云水含量 $q_c$（例如，$\propto q_c^2$ 或更高次幂）。

*   **[碰并](@entry_id:1122642)**：一旦通过自动转化形成了初始的雨滴（尺寸大于 $r_t$），它们会因为具有显著的下落速度而高效地“扫过”并收集路径上的云滴。这个 **雨滴[碰并](@entry_id:1122642)云滴** 的过程称为碰并。[碰并](@entry_id:1122642)是暖雨增长的主要机制，一旦雨滴形成，它通常比自动转化快得多。其[参数化](@entry_id:265163)形式通常与云水含量 $q_c$ 和雨水含量 $q_r$ 的乘积成正比（$\propto q_c q_r$）。

#### 冰相过程

冰相微物理比暖雨过程复杂得多，因为它涉及多种冰相粒子（冰晶、雪、霰、雹等），它们具有非球形的复杂形状和变化的密度。

**1. 质量-尺度关系**

为了处理冰相粒子的复杂性，体相方案引入了 **质量-尺度关系**，通常表示为幂律形式 $m(D) = \alpha D^\beta$。这里的 $D$ 是粒子的最大尺度或特征尺度，系数 $\alpha$ 和指数 $\beta$ 则依赖于粒子类型。这些关系通常基于几何理想化和观测数据。

*   **云冰（Cloud Ice）**：初始形成的小冰晶通常被理想化为薄板状或柱状。例如，如果将其视为一个厚度恒定、直径为 $D$ 的圆盘，其质量将与 $D^2$ 成正比（即 $\beta=2$）。

*   **雪（Snow）**：雪花是冰晶的聚合体，结构蓬松，包含大量空气。因此，它通常被理想化为具有较低 **体密度**（bulk density, 如 $\rho_s \sim 100 \, \text{kg m}^{-3}$）的球体。在这种情况下，其质量与 $D^3$ 成正比（$\beta=3$），但 prefactor $\alpha$ 中包含了这个较低的密度。

*   **霰（Graupel）**：霰是经过严重 **淞附（riming）**——即冰晶收集过冷云滴并冻结——形成的粒子。它比雪更致密（如 $\rho_g \sim 400 \, \text{kg m}^{-3}$），通常也被当作球体处理（$\beta=3$），但具有比雪更大的 $\alpha$ 值。

这种质量-尺度关系是连接冰相粒子[混合比](@entry_id:1127970)（三阶矩）和其几何尺寸的关键。

**2. 类别转化**

现代的体相方案使用基于物理过程的判据来处理不同冰相粒子类别之间的转化，而不仅仅依赖于温度。

*   **从雪到霰的转化**：这一转化标志着粒子增长机制从以冰晶聚合为主转变为以淞附为主。一个先进的方案可能会追踪雪粒子的 **淞附[质量分数](@entry_id:161575)**（rime mass fraction, $f_r$），即淞附收集的质量占总质量的比例。当淞附过程的速率超过[聚合速率](@entry_id:194106)，并且 $f_r$ 和粒子的体密度 $\rho_p$ 都超过了某个阈值（例如，$f_r \ge 0.5$ 且 $\rho_p \ge 400 \, \text{kg m}^{-3}$）时，就触发从雪到霰的转化。

*   **从霰到雹的转化**：雹被定义为尺寸巨大、密度接近纯冰的粒子。因此，从霰到雹的转化通常由尺寸和密度双重阈值控制。例如，当一个霰粒子的平均直径超过 $5 \, \text{mm}$ 且其体密度超过 $700 \, \text{kg m}^{-3}$ 时，它就被重分类为雹。

*   **从云冰到雪的转化**：小的云冰晶通过 **聚合（aggregation）**——相互碰撞并黏合在一起——形成更大的雪花。这个过程在体相方案中被[参数化](@entry_id:265163)，实现从云冰类别到雪类别的质量和数量的转移，同时保证总[质量守恒](@entry_id:204015)。

### 与模式的耦合：挑战与解决方案

微物理方案并非孤立运行，它必须与模式的动力学和[热力学](@entry_id:172368)核心紧密耦合，这带来了两个主要的数值和物理挑战：热力学一致性和数值稳定性。

#### 热力学一致性：[饱和度调整](@entry_id:1131227)

云微物理过程中，相变（凝结/蒸发）的物理时间尺度极快，通常在秒级（$\tau_c \approx 1 \, \text{s}$）。然而，大气模式的时间步长 $\Delta t$ 通常要长得多（数十秒到数分钟）。如果在一个时间步长内，动力学过程（如绝热抬升）导致了过饱和，而微物理过程的响应却要等到下一个时间步长，这将导致非物理的、持续存在的巨大过饱和。

为了解决这个问题，许多模式采用了 **“[饱和度调整](@entry_id:1131227)”（saturation adjustment）** 的方法。这是一种诊断性步骤，其核心思想是：既然相变如此之快，我们可以假定在每个时间步长结束时，水汽和云水达到了[准平衡](@entry_id:1130431)状态，即空气恢复到饱和状态。这个调整过程必须遵循两个基本守恒定律：

1.  **总水量守恒**：从水汽转移到云水（或反之）的质量必须相等。$q_t = q_v + q_l = \text{const}$。
2.  **湿焓守恒**：在一个绝热[等压过程](@entry_id:140349)中，湿焓 $h = c_p T + L_v q_v$ 是守恒的。这意味着凝结释放的潜热必须用于加热空气。

将这两个守恒定律与最终状态的饱和条件 $q_v^f = q_{vs}(T_f)$ 结合，会得到一个关于最终温度 $T_f$ 和水汽 $q_v^f$ 的耦合非线性方程组。求解这个方程组可以确保在一个时间步长内，相变导致的质量和能量变化是一致和瞬时完成的，从而避免了非物理的过饱和累积。

#### [数值稳定性](@entry_id:175146)：刚性问题

微物理过程的另一个显著特征是其 **时间尺度的巨大差异**。正如前面提到的，凝结/蒸发过程的特征时间尺度约为1秒，而自动转化、沉降等过程的时间尺度则可能长达成百上千秒。描述这种具有极大分离时间尺度的[微分](@entry_id:158422)方程系统，在数学上被称为 **“刚性”（stiff）** 系统。

这种刚性给数值求解带来了巨大挑战。对于一个常微分方程组 $\frac{d\mathbf{y}}{dt} = f(t, \mathbf{y})$，其刚性体现在其雅可比矩阵的特征值具有相差悬殊的负实部。系统的数值稳定性，特别是对于简单的 **[显式时间积分](@entry_id:165797)方案**（如前向欧拉法），是由具有最大绝对值的特征值决定的，也就是由系统中最快的过程（此处为凝结，$\tau_c \approx 1\text{ s}$）所控制。这意味着，为了保持数值稳定，时间步长 $\Delta t$ 必须小于这个最快的时间尺度（$\Delta t \lesssim 1 \text{ s}$）。

然而，我们关心的云的整体演化是由那些慢得多的过程（如[自动转化](@entry_id:1121257)、沉降）驱动的，其时间尺度是上千秒。如果为了稳定而被迫使用极小的时间步长，那么模拟整个云的生命周期将变得计算成本高昂，不切实际。这就是刚性问题的核心困境：稳定性要求极小的时间步，而精度和效率则希望使用与慢过程相匹配的较大时间步。为了应对这一挑战，模式开发者必须采用更复杂的数值方法，如 **隐式或半[隐式时间积分](@entry_id:171761)方案**、**[时间分裂](@entry_id:1133185)（time-splitting）** 或 **子步长（sub-stepping）** 方法，这些方法能够以较大的时间步长稳定地处理[刚性系统](@entry_id:146021)。