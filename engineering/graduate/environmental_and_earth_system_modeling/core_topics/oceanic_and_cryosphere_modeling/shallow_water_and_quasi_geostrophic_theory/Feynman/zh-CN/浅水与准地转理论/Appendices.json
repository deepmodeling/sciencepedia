{
    "hands_on_practices": [
        {
            "introduction": "准地转理论通过关注一个守恒量——位涡（PV），极大地简化了复杂的大尺度流体动力学。掌握此理论的第一步是理解如何为大尺度流动简化完整的位涡表达式。本练习  将引导您完成此基本推导，揭示相对涡度和层厚度扰动如何共同构成准地转位涡异常。",
            "id": "4048393",
            "problem": "考虑一个与中纬度$\\beta$平面上的地转适应相关的单层旋转浅水系统，其科里奥利参数为 $f(y) = f_{0} + \\beta y$，平均层厚为常数$H$，自由面位移为$\\eta(x,y,t)$，水平速度分量为$u(x,y,t)$和$v(x,y,t)$。相对涡度定义为 $\\zeta(x,y,t) = \\partial v/\\partial x - \\partial u/\\partial y$。在无摩擦、无扩散、无底地形的流动中，物质守恒的位涡（PV）由 $q(x,y,t) = \\dfrac{\\zeta(x,y,t) + f(y)}{H + \\eta(x,y,t)}$ 给出。\n\n假设一个静止的参考态，其中 $u = 0$，$v = 0$，$\\eta = 0$，并围绕此状态定义小扰动 $\\zeta'(x,y,t)$ 和 $\\eta'(x,y,t)$，使得 $\\zeta = \\zeta'$ 且 $\\eta = \\eta'$。围绕此静止态对位涡 $q$ 进行线性化，仅保留扰动的一阶项，并将得到的一阶位涡异常 $q'$ 完全用 $\\zeta'$、$\\eta'$、$H$ 和 $f_{0}$ 表示。将 $f_{0}$ 视为参考纬度处的常数科里奥利参数，且不包含 $f(y)$ 的经向平流。您的最终答案必须是 $q'$ 的一个单一闭式解析表达式，用 $\\zeta'$、$\\eta'$、$H$ 和 $f_{0}$ 表示。",
            "solution": "用户希望我求出单层旋转浅水系统中位涡（PV）异常的一阶近似。\n\n### 步骤1：问题验证\n\n首先，我将验证问题陈述。\n\n#### 步骤1.1：提取已知条件\n- **系统：** 中纬度$\\beta$平面上的单层旋转浅水系统。\n- **科里奥利参数：** $f(y) = f_{0} + \\beta y$。\n- **平均层厚：** $H$（常数）。\n- **自由面位移：** $\\eta(x,y,t)$。\n- **速度分量：** $u(x,y,t)$ 和 $v(x,y,t)$。\n- **相对涡度：** $\\zeta(x,y,t) = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$。\n- **位涡（PV）：** $q(x,y,t) = \\dfrac{\\zeta(x,y,t) + f(y)}{H + \\eta(x,y,t)}$。\n- **参考态：** 静止状态，定义为 $u = 0$，$v = 0$，$\\eta = 0$。\n- **扰动：** 围绕静止态的小扰动用撇号表示，因此总涡度为 $\\zeta = \\zeta'$，总表面位移为 $\\eta = \\eta'$。\n- **任务：** 围绕静止态对位涡 $q$ 进行线性化，并求出一阶位涡异常 $q'$ 的表达式。\n- **约束：** $q'$ 的最终表达式必须只用 $\\zeta'$、$\\eta'$、$H$ 和 $f_{0}$ 表示。问题还指出，“将 $f_{0}$ 视为参考纬度处的常数科里奥利参数，且不包含 $f(y)$ 的经向平流。”\n\n#### 步骤1.2：使用提取的已知条件进行验证\n该问题定义明确，植根于地球物理流体动力学的基本原理。所描述的模型（旋转浅水方程）、位涡的定义以及线性化过程都是该领域的标准概念。\n\n- **科学依据：** 该问题在科学上是合理的。它涉及线性化位涡的推导，这是准地转理论的基石。\n- **适定性与一致性：** 乍一看，该问题似乎有一个微小的内部矛盾：它设置在$\\beta$平面上（其中$f$随纬度$y$变化），但要求的最终答案却与$\\beta$和$y$无关。然而，这并非缺陷。在准地转位涡的标准推导中，人们在已经是扰动场一阶的项（如包含$\\eta$的“拉伸”项）中将科里奥利参数 $f(y)$ 近似为 $f_0$。$f$随$y$的变化（$\\beta$效应）被保留在背景位涡梯度中，该梯度控制着波动动力学，但问题只要求位涡异常本身的表达式，而不是其演化方程。问题的约束引导用户做出这个特定的、标准的近似。因此，在这个标准解释下，问题是适定的且内部一致的。\n- **客观性与清晰性：** 该问题使用精确、客观的科学语言，并清晰地定义了所有术语。\n\n#### 步骤1.3：结论与行动\n问题被判定为**有效**。我将继续推导解决方案。\n\n### 步骤2：解决方案推导\n\n浅水系统的位涡（PV）由下式给出：\n$$q(x,y,t) = \\frac{\\zeta(x,y,t) + f(y)}{H + \\eta(x,y,t)}$$\n在$\\beta$平面上，科里奥利参数为 $f(y) = f_{0} + \\beta y$。\n\n系统在静止参考态（$\\bar{u}=0$, $\\bar{v}=0$, $\\bar{\\eta}=0$）附近进行分析。这意味着参考态的相对涡度也为零，$\\bar{\\zeta}=0$。这个参考态的位涡，记为$\\bar{q}$，是纬度$y$的函数：\n$$\\bar{q}(y) = \\frac{\\bar{\\zeta} + f(y)}{H + \\bar{\\eta}} = \\frac{0 + f_{0} + \\beta y}{H} = \\frac{f_{0} + \\beta y}{H}$$\n\n总位涡$q$可以分解为背景位涡和扰动位涡（异常）$q'$之和：\n$$q(x,y,t) = \\bar{q}(y) + q'(x,y,t)$$\n因此，位涡异常为 $q' = q - \\bar{q}$。鉴于扰动被定义为 $\\zeta = \\zeta'$ 和 $\\eta = \\eta'$，我们可以写出 $q'$ 的表达式：\n$$q' = \\frac{\\zeta' + f(y)}{H + \\eta'} - \\frac{f(y)}{H}$$\n代入 $f(y) = f_0 + \\beta y$：\n$$q' = \\frac{\\zeta' + f_{0} + \\beta y}{H + \\eta'} - \\frac{f_{0} + \\beta y}{H}$$\n为了合并各项，我们进行通分：\n$$q' = \\frac{H(\\zeta' + f_{0} + \\beta y) - (H + \\eta')(f_{0} + \\beta y)}{H(H + \\eta')}$$\n展开分子：\n$$q' = \\frac{H\\zeta' + H(f_{0} + \\beta y) - H(f_{0} + \\beta y) - \\eta'(f_{0} + \\beta y)}{H(H + \\eta')}$$\n化简分子得到位涡异常的精确表达式：\n$$q' = \\frac{H\\zeta' - (f_{0} + \\beta y)\\eta'}{H^2 + H\\eta'}$$\n\n下一步是对此表达式进行线性化，只保留小扰动 $\\zeta'$ 和 $\\eta'$ 的一阶项。我们可以重写分母，并对小的 $x = \\eta'/H$ 使用泰勒展开 $(1+x)^{-1} \\approx 1-x$：\n$$q' = \\frac{H\\zeta' - (f_{0} + \\beta y)\\eta'}{H^2(1 + \\eta'/H)} \\approx \\left(\\frac{\\zeta'}{H} - \\frac{(f_{0} + \\beta y)\\eta'}{H^2}\\right) \\left(1 - \\frac{\\eta'}{H}\\right)$$\n展开乘积：\n$$q' \\approx \\frac{\\zeta'}{H} - \\frac{\\zeta'\\eta'}{H^2} - \\frac{(f_{0} + \\beta y)\\eta'}{H^2} + \\frac{(f_{0} + \\beta y)(\\eta')^2}{H^3}$$\n我们舍弃扰动的二阶及更高阶项。$\\frac{\\zeta'\\eta'}{H^2}$ 和 $\\frac{(f_{0} + \\beta y)(\\eta')^2}{H^3}$ 这两项是二阶的，应被忽略。因此，线性化的位涡异常为：\n$$q' \\approx \\frac{\\zeta'}{H} - \\frac{(f_{0} + \\beta y)\\eta'}{H^2}$$\n\n最后，我们必须应用约束条件，即 $q'$ 的最终表达式仅依赖于 $\\zeta'$、$\\eta'$、$H$ 和 $f_{0}$。这要求我们处理 $(f_{0} + \\beta y)\\eta'$ 这一项。该项可以写为 $f_0 \\eta' + \\beta y \\eta'$。在准地转标度分析中，与 $f_0 \\eta'$ 相比，$\\beta y \\eta'$ 项被认为是高阶修正项，因为对于感兴趣的长度尺度，比率 $\\beta y/f_0$ 通常很小。因此，在此框架内一个标准且一致的近似是，在已经乘以像 $\\eta'$ 这样的一阶扰动项的项中，用 $f_0$ 替换 $f(y) = f_0 + \\beta y$。这正是问题陈述引导我们去做的。\n\n应用此近似 $(f_0 + \\beta y)\\eta' \\approx f_0 \\eta'$，我们得到一阶位涡异常的最终表达式：\n$$q' = \\frac{\\zeta'}{H} - \\frac{f_{0}\\eta'}{H^2}$$\n该结果满足问题的所有条件。它表示准地转近似下浅水位涡异常的线性化形式。",
            "answer": "$$\\boxed{\\frac{\\zeta'}{H} - \\frac{f_{0} \\eta'}{H^{2}}}$$"
        },
        {
            "introduction": "准地转理论的一个核心原则是“可反演性原理”：即知道位涡的分布就能确定整个流场（速度和压力）。本练习  将此原理转化为一个具体的计算任务。您将开发一个谱方法求解器来反演准地转位涡方程，这项技术是现代地球物理流体动力学建模的核心。",
            "id": "3911751",
            "problem": "考虑一个单层准地转 (QG) 流，其位于边长为 $L_x = L_y = 2\\pi$ 的双周期正方形区域上。其基本原理包括小罗斯贝数标度下的旋转浅水方程、科里奥利力与气压梯度力之间的地转平衡，以及位涡 (PV) 定义为绝对涡度与层厚度之比。在 QG 标度下，地转速度由流函数 $\\psi(x,y)$ 通过 $\\mathbf{u}_g = (-\\partial \\psi/\\partial y, \\partial \\psi/\\partial x)$ 表示，而 QG 位涡异常 $q'(x,y)$ 是 $\\psi(x,y)$ 的一个线性函数，涉及最高二阶的空间导数。在双周期区域上，当控制线性算子在周期函数空间上可逆时，从 $q'(x,y)$ 到 $\\psi(x,y)$ 的反演是适定的。\n\n您的任务是：\n1. 从旋转浅水动量和连续性方程、地转平衡 $f_0 \\hat{\\mathbf{z}} \\times \\mathbf{u}_g = -g' \\nabla \\eta$、PV 的定义 $Q = (\\zeta + f_0)/h$，以及通过质量守恒与 $\\psi$ 相关的小振幅自由面位移 $\\eta$ 出发，推导单层情况下的 QG 位涡异常，将其表示为作用于 $\\psi(x,y)$ 的线性算子。证明在给定 $q'(x,y)$ 的情况下，$\\psi(x,y)$ 的反演问题可简化为求解一个常系数椭圆型偏微分方程，其形式如下\n$$\n\\left(\\nabla^2 - \\frac{1}{L_d^2}\\right)\\psi(x,y) = q'(x,y),\n$$\n其中 $L_d$ 是罗斯贝变形半径，$\\nabla^2$ 是二维拉普拉斯算子。阐述该算子在双周期区域上可逆的条件，并讨论当 $L_d \\to \\infty$（正压极限）时的特殊情况。在此情况下，方程简化为泊松方程 $\\nabla^2 \\psi(x,y) = q'(x,y)$，且相容性要求 $q'(x,y)$ 的空间平均值为零。\n\n2. 设计一个算法，在双周期区域中使用离散傅里叶变换 (DFT)（也称为快速傅里叶变换, FFT）来反演 $q'(x,y)$ 以获得 $\\psi(x,y)$。明确推导谱空间中的代数关系，该关系允许从 $q'$ 的傅里叶系数求解 $\\psi$ 的傅里叶系数，并注意处理泊松方程情况下的零波数模态。然后，描述如何重构 $\\psi(x,y)$，以及如何通过从 $\\psi(x,y)$ 重构 PV 异常 $q'_{\\text{rec}}(x,y)$ 并将其与原始的 $q'(x,y)$ 进行比较来验证反演。\n\n3. 在一个程序中实现该算法，使用 $N_x = N_y = 64$ 个网格点、$L_x = L_y = 2\\pi$，以及以下包含 PV 异常和变形半径的测试套件：\n   - 测试案例 A（理想情况）：$L_d = 1.0$ 且\n     $$\n     q'_A(x,y) = \\cos(x) + \\cos(y).\n     $$\n   - 测试案例 B（正压极限，零均值异常）：$L_d \\to \\infty$ 且\n     $$\n     q'_B(x,y) = \\sin(2x) + \\sin(3y).\n     $$\n     在此，算法必须根据相容性条件一致地处理零波数模态。\n   - 测试案例 C（亥姆霍兹情况下的零波数反演）：$L_d = 0.5$ 且\n     $$\n     q'_C(x,y) = 2.0,\n     $$\n     一个空间均匀的异常。\n\n对于每个测试案例，计算地转流函数 $\\psi(x,y)$，在有限 $L_d$ 情况下重构 PV 异常\n$$\nq'_{\\text{rec}}(x,y) = \\nabla^2 \\psi(x,y) - \\frac{\\psi(x,y)}{L_d^2}\n$$\n，在正压极限下重构 $q'_{\\text{rec}}(x,y) = \\nabla^2 \\psi(x,y)$，并以浮点数形式报告最大绝对差\n$$\nE = \\max_{x,y} \\left| q'_{\\text{rec}}(x,y) - q'(x,y) \\right|\n$$\n。\n\n所有量均为无量纲，因此不需要物理单位。您的程序应生成单行输出，其中包含三个测试案例的结果，格式为用方括号括起来的逗号分隔列表（例如 $[E_A,E_B,E_C]$）。",
            "solution": "详细解法分为三部分呈现：首先，从基本原理推导控制偏微分方程；其次，设计求解该方程的谱方法算法；第三，给出数值测试案例的实现细节。\n\n### 第一部分：准地转位涡方程的推导\n\n我们从恒定密度单层流体的旋转浅水方程开始，并采用准地转 (QG) 近似假设。动量和连续性方程为：\n$$\n\\frac{D\\mathbf{u}}{Dt} + f_0 \\hat{\\mathbf{z}} \\times \\mathbf{u} = -g' \\nabla \\eta\n$$\n$$\n\\frac{D h}{Dt} + h (\\nabla \\cdot \\mathbf{u}) = 0\n$$\n其中 $\\mathbf{u}$ 是水平速度矢量，$f_0$ 是常数科里奥利参数，$\\hat{\\mathbf{z}}$ 是垂直方向的单位矢量，$g'$ 是折合重力，$\\eta$ 是相对于平均高度 $H$ 的自由面位移，而 $h = H + \\eta$ 是总流体深度。\n\n在 QG 近似下，罗斯贝数很小，这意味着流动在主导阶上处于地转平衡状态。该平衡存在于科里奥利力与气压梯度力之间：\n$$\nf_0 \\hat{\\mathbf{z}} \\times \\mathbf{u}_g = -g' \\nabla \\eta\n$$\n其中 $\\mathbf{u}_g$ 是地转速度。我们引入一个流函数 $\\psi(x,y)$，使得 $\\mathbf{u}_g = (-\\partial \\psi/\\partial y, \\partial \\psi/\\partial x)$。将其代入地转平衡方程可得：\n$$\nf_0 \\hat{\\mathbf{z}} \\times \\left(-\\frac{\\partial \\psi}{\\partial y}, \\frac{\\partial \\psi}{\\partial x}\\right) = \\left(f_0 \\frac{\\partial \\psi}{\\partial x}, f_0 \\frac{\\partial \\psi}{\\partial y}\\right) = f_0 \\nabla \\psi\n$$\n将其与 $-g' \\nabla \\eta$ 比较，我们发现 $f_0 \\nabla \\psi = g' \\nabla \\eta$。积分后得到流函数与自由面位移之间的关系：\n$$\n\\eta = \\frac{f_0}{g'} \\psi\n$$\n其中任何积分常数都可以被吸收到 $\\psi$ 的定义中。\n\n接下来，我们考虑位涡 (PV)，其定义为 $Q = (\\zeta + f_0)/h$，其中 $\\zeta = \\hat{\\mathbf{z}} \\cdot (\\nabla \\times \\mathbf{u})$ 是相对涡度。在 QG 框架下，$\\zeta$ 由地转涡度 $\\zeta_g = \\nabla \\times \\mathbf{u}_g = \\nabla^2 \\psi$ 来近似。流体深度为 $h = H + \\eta$。对于小振幅位移，$\\eta \\ll H$，我们可以对 PV 表达式进行线性化：\n$$\nQ = \\frac{\\zeta_g + f_0}{H + \\eta} = \\frac{f_0(1 + \\zeta_g/f_0)}{H(1 + \\eta/H)} \\approx \\frac{f_0}{H} (1 + \\frac{\\zeta_g}{f_0}) (1 - \\frac{\\eta}{H}) \\approx \\frac{f_0}{H} \\left(1 + \\frac{\\zeta_g}{f_0} - \\frac{\\eta}{H}\\right)\n$$\n平均 PV 为 $Q_0 = f_0/H$。因此，PV 异常 $Q' = Q - Q_0$ 为：\n$$\nQ' \\approx \\frac{f_0}{H} \\left(\\frac{\\zeta_g}{f_0} - \\frac{\\eta}{H}\\right) = \\frac{\\zeta_g}{H} - \\frac{f_0 \\eta}{H^2}\n$$\nQG 位涡异常，通常表示为 $q'$，定义为 $q' = H Q'$：\n$$\nq' = \\zeta_g - \\frac{f_0}{H} \\eta\n$$\n代入 $\\zeta_g = \\nabla^2 \\psi$ 和 $\\eta = (f_0/g') \\psi$：\n$$\nq'(x,y) = \\nabla^2 \\psi(x,y) - \\frac{f_0^2}{g'H} \\psi(x,y)\n$$\n我们将 $(f_0^2 / (g'H))^{-1/2}$ 项识别为内部罗斯贝变形半径，$L_d = \\sqrt{g'H}/f_0$。因此，关联 QG 位涡异常 $q'$ 与流函数 $\\psi$ 的方程是一个亥姆霍兹方程：\n$$\n\\left(\\nabla^2 - \\frac{1}{L_d^2}\\right)\\psi(x,y) = q'(x,y)\n$$\n该方程代表了 QG 理论中的“可反演性原理”：给定 PV 异常 $q'$ 的分布，就可以求出相应的流函数 $\\psi$，进而得到整个速度场和压力场。\n\n要使该算子 $L = \\nabla^2 - 1/L_d^2$ 在双周期区域上可逆，其特征值不能为零。我们使用区域 $[0, 2\\pi] \\times [0, 2\\pi]$ 上函数的傅里叶级数表示来分析这个问题。一个特征函数的形式为 $e^{i(kx+ly)}$，其中 $k$ 和 $l$ 是整数波数。应用该算子：\n$$\nL e^{i(kx+ly)} = (\\nabla^2 - 1/L_d^2) e^{i(kx+ly)} = (-(k^2+l^2) - 1/L_d^2) e^{i(kx+ly)}\n$$\n特征值为 $\\lambda_{k,l} = -(k^2+l^2+1/L_d^2)$。\n如果 $L_d$ 是有限的，则 $1/L_d^2 > 0$。由于 $k^2+l^2 \\ge 0$，和 $k^2+l^2+1/L_d^2$ 总是严格为正。因此，所有特征值 $\\lambda_{k,l}$ 都严格为负且非零。该算子是可逆的，对于任何给定的 $q'$ 都存在唯一解 $\\psi$。\n\n在 $L_d \\to \\infty$ 的特殊正压极限下，项 $1/L_d^2$ 消失，方程变为泊松方程：\n$$\n\\nabla^2 \\psi(x,y) = q'(x,y)\n$$\n算子 $L = \\nabla^2$ 的特征值为 $\\lambda_{k,l} = -(k^2+l^2)$。对于零波数模态 $(k,l)=(0,0)$，特征值为 $\\lambda_{0,0} = 0$。这表明该算子不可逆。解存在的唯一条件是右端项 $q'$ 与算子伴随的零空间正交。对于周期区域上的自伴拉普拉斯算子，这意味着 $q'$ 必须与张成零空间的常数函数正交。这个正交条件就是相容性条件：$q'$ 的空间平均值必须为零。\n$$\n\\langle q' \\rangle = \\frac{1}{(2\\pi)^2} \\int_0^{2\\pi} \\int_0^{2\\pi} q'(x,y) \\,dx\\,dy = 0\n$$\n如果满足此条件，则解 $\\psi$ 存在，但不是唯一的：如果 $\\psi_0$ 是一个解，那么对于任意常数 $C$，$\\psi_0 + C$ 也是一个解。通常通过要求 $\\psi$ 的空间平均值为零来确保唯一性。\n\n### 第二部分：谱反演算法\n\nQG PV 方程的反演可以利用离散傅里叶变换 (DFT) 在谱空间中高效执行，DFT 通常通过快速傅里叶变换 (FFT) 实现。对于离散化到 $N_x \\times N_y$ 网格上的双周期区域 $[0, 2\\pi] \\times [0, 2\\pi]$，算法如下：\n\n1.  **正变换**：给定网格上的 PV 异常 $q'(x_j, y_m)$，计算其二维 DFT 以获得其傅里叶系数 $\\hat{q}'_{k,l}$：\n    $$\n    \\hat{q}'_{k,l} = \\mathcal{F}(q') = \\sum_{j=0}^{N_x-1} \\sum_{m=0}^{N_y-1} q'(x_j, y_m) e^{-i(kx_j + ly_m)}\n    $$\n2.  **代数反演**：偏微分方程 $(\\nabla^2 - 1/L_d^2)\\psi = q'$ 在傅里叶空间中转换为一个代数方程。周期区域上拉普拉斯算子的傅里叶变换对应于乘以 $-(k^2+l^2)$，其中 $k$ 和 $l$ 是整数波数。\n    $$\n    (-(k^2 + l^2) - \\frac{1}{L_d^2}) \\hat{\\psi}_{k,l} = \\hat{q}'_{k,l}\n    $$\n    然后通过除法求得流函数的傅里叶系数 $\\hat{\\psi}_{k,l}$：\n    $$\n    \\hat{\\psi}_{k,l} = \\frac{\\hat{q}'_{k,l}}{-(k^2 + l^2 + 1/L_d^2)}\n    $$\n    -   对于有限的变形半径 $L_d$（亥姆霍兹情况），分母永远不为零，因此对所有波数对 $(k,l)$ 执行此除法。\n    -   对于正压极限 $L_d \\to \\infty$（泊松情况），分母变为 $-(k^2+l^2)$，对于零波数模态 $(k,l)=(0,0)$，该值为零。相容性条件确保 $\\hat{q}'_{0,0}$（即 $q'$ 的平均值）也为零。这导致 $0/0$ 的形式。为确保唯一解，我们强制要求流函数的平均值为零，这等同于将其零波数傅里叶系数设为零：$\\hat{\\psi}_{0,0} = 0$。\n\n3.  **逆变换**：通过对其系数应用二维逆 DFT，在物理空间中重构流函数 $\\psi(x_j, y_m)$：\n    $$\n    \\psi(x_j, y_m) = \\mathcal{F}^{-1}(\\hat{\\psi}) = \\frac{1}{N_x N_y} \\sum_{k=0}^{N_x-1} \\sum_{l=0}^{N_y-1} \\hat{\\psi}_{k,l} e^{i(kx_j + ly_m)}\n    $$\n4.  **验证**：为了验证反演，我们从计算出的流函数 $\\psi$ 中重构 PV 异常 $q'_{\\text{rec}}$，并将其与原始的 $q'$ 进行比较。最好在谱空间中进行此操作以避免有限差分误差。\n    -   计算重构 PV 的傅里叶系数：\n        $$\n        \\hat{q}'_{\\text{rec},k,l} = (-(k^2+l^2) - 1/L_d^2)\\hat{\\psi}_{k,l}\n        $$\n    -   根据构造，$\\hat{q}'_{\\text{rec},k,l}$ 应与原始的 $\\hat{q}'_{k,l}$ 在浮点精度范围内相同。\n    -   应用逆 DFT 得到 $q'_{\\text{rec}}(x,y) = \\mathcal{F}^{-1}(\\hat{q}'_{\\text{rec}})$。\n    -   计算最大绝对误差：\n        $$\n        E = \\max_{j,m} | q'_{\\text{rec}}(x_j, y_m) - q'(x_j, y_m) |\n        $$\n\n### 第三部分：测试案例的实现\n\n该算法在一个 $L_x = L_y = 2\\pi$ 的区域上实现，网格点数为 $N_x = N_y = 64$。整数波数 $k$ 和 $l$ 的范围是从 $-32$ 到 $31$。使用这些波数的二维网格来构建微分算子的谱表示。该算法应用于三个指定的测试案例：\n-   **案例 A ($L_d=1.0$, $q'_A = \\cos x + \\cos y$)**：标准的亥姆霍兹反演。强迫项由波数 $(k,l) = (\\pm 1, 0)$ 和 $(0, \\pm 1)$ 组成。\n-   **案例 B ($L_d=\\infty$, $q'_B = \\sin(2x) + \\sin(3y)$)**：泊松反演。强迫项均值为零，满足相容性条件。零波数模态 $\\hat{\\psi}_{0,0}$ 被设为零。\n-   **案例 C ($L_d=0.5$, $q'_C = 2.0$)**：亥姆霍兹反演，其中强迫项为常数，对应于零波数模态 $(k,l)=(0,0)$。这测试了当 $L_d$ 有限时对平均分量的非奇异处理。\n\n以下 Python 代码实现了此过程，并计算了每个案例的重构误差 $E$。",
            "answer": "```python\nimport numpy as np\nfrom scipy import fft\n\ndef solve_qg_inversion(q_prime, Ld, N, L):\n    \"\"\"\n    Inverts the QG PV equation using spectral methods.\n\n    Args:\n        q_prime (np.ndarray): 2D array of the QG PV anomaly.\n        Ld (float): Rossby deformation radius. Use np.inf for the barotropic limit.\n        N (int): Number of grid points in each dimension.\n        L (float): Domain size in each dimension.\n\n    Returns:\n        float: The maximum absolute reconstruction error.\n    \"\"\"\n    # 1. Fourier transform the PV anomaly\n    q_hat = fft.fft2(q_prime)\n\n    # 2. Set up wavenumber grid\n    # For a domain of size L=2*pi, the wavenumbers are integers.\n    # fft.fftfreq(N) * N gives the integer wavenumbers [0, 1, ..., N/2-1, -N/2, ..., -1]\n    k = fft.fftfreq(N) * N\n    l = fft.fftfreq(N) * N\n    K, L_grid = np.meshgrid(k, l)\n\n    # 3. Construct the spectral operator\n    # The operator is -(k^2 + l^2) - 1/Ld^2\n    is_barotropic = np.isinf(Ld)\n    if is_barotropic:\n        # Barotropic (Poisson) case: Ld -> inf\n        spectral_op = -(K**2 + L_grid**2)\n    else:\n        # Baroclinic (Helmholtz) case\n        spectral_op = -(K**2 + L_grid**2) - 1.0/Ld**2\n\n    # 4. Solve for the streamfunction in spectral space\n    psi_hat = np.zeros_like(q_hat, dtype=complex)\n    \n    # Handle the zero-wavenumber mode for the Poisson case\n    if is_barotropic:\n        # Check compatibility condition (mean q' should be zero)\n        # q_hat[0, 0] is proportional to the mean. It should be numerically zero.\n        if np.abs(q_hat[0, 0]) > 1e-9:\n             # This case is not hit by the problem spec but is good practice\n            raise ValueError(\"Incompatible forcing for Poisson equation: mean is non-zero.\")\n\n        # For k=l=0, the operator is 0. We set psi_hat[0,0]=0 for a unique solution.\n        # For all other wavenumbers, the operator is non-zero.\n        non_zero_k = spectral_op != 0\n        psi_hat[non_zero_k] = q_hat[non_zero_k] / spectral_op[non_zero_k]\n        psi_hat[0, 0] = 0.0 + 0.0j # Enforce zero mean for psi\n    else:\n        # For the Helmholtz case, the operator is never zero.\n        psi_hat = q_hat / spectral_op\n\n    # 5. Reconstruct the PV anomaly to validate the inversion\n    q_rec_hat = spectral_op * psi_hat\n    \n    # In the barotropic case, q_hat[0,0] was already checked to be zero, and\n    # psi_hat[0,0] was set to zero, so spectral_op[0,0]*psi_hat[0,0] = 0*0 = 0.\n    # This correctly reproduces q_hat[0,0].\n\n    # 6. Transform back to physical space\n    q_rec = fft.ifft2(q_rec_hat)\n\n    # 7. Calculate the maximum absolute difference\n    # The result of ifft2 should be real since the original data was real\n    # and the operations preserve conjugacy. We take .real to discard\n    # negligible imaginary parts from floating-point inaccuracies.\n    error = np.max(np.abs(q_rec.real - q_prime))\n    \n    return error\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    # Common parameters\n    N = 64\n    L = 2.0 * np.pi\n    \n    # Grid setup\n    x = np.linspace(0, L, N, endpoint=False)\n    y = np.linspace(0, L, N, endpoint=False)\n    X, Y = np.meshgrid(x, y)\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case A: Helmholtz, happy path\n        {\n            \"name\": \"A\",\n            \"Ld\": 1.0,\n            \"q_prime_func\": lambda x, y: np.cos(x) + np.cos(y)\n        },\n        # Case B: Poisson, barotropic limit\n        {\n            \"name\": \"B\",\n            \"Ld\": np.inf,\n            \"q_prime_func\": lambda x, y: np.sin(2*x) + np.sin(3*y)\n        },\n        # Case C: Helmholtz, zero-wavenumber forcing\n        {\n            \"name\": \"C\",\n            \"Ld\": 0.5,\n            \"q_prime_func\": lambda x, y: 2.0 + 0*x  # Ensure it is a 2D array\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Ld = case[\"Ld\"]\n        q_prime = case[\"q_prime_func\"](X, Y)\n        \n        error = solve_qg_inversion(q_prime, Ld, N, L)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实世界的大气和海洋流动具有垂直结构。本练习  将我们的分析扩展到一个双层模型，这是斜压流体的一个简单而强大的表示。您将学习如何将流动分解为其正压（深度平均）和斜压（垂直切变）分量，这是理解如天气系统生成等斜压不稳定现象的关键一步。",
            "id": "4047766",
            "problem": "考虑一个用于大尺度大气流动的、在beta平面上的双层准地转（QG）模型，该模型满足 Boussinesq 近似、静力平衡和地转平衡。设上层和下层的平均厚度分别为 $H_{1}$ 和 $H_{2}$，存在一个内部界面位移 $\\eta(x,y,t)$，使得厚度异常满足 $h_{1}' = -\\eta$ 和 $h_{2}' = \\eta$。科里奥利参数为 $f = f_{0} + \\beta y$，其中 $f_{0}$ 是一个常数，$\\beta$ 是经向梯度。折合重力定义为 $g' = g\\,(\\rho_{2} - \\rho_{1})/\\rho_{0}$，其中 $g$ 是重力加速度，$\\rho_{1}$ 和 $\\rho_{2}$ 是层密度，$\\rho_{0}$ 是一个常数参考密度。每层的地转流函数为 $\\psi_{j}(x,y,t)$，水平速度由 $\\boldsymbol{u}_{j} = \\left(-\\partial \\psi_{j}/\\partial y,\\,\\partial \\psi_{j}/\\partial x\\right)$ 给出，其中 $j \\in \\{1,2\\}$。\n\n仅从分层浅水系统中的基本平衡和位涡守恒出发，并利用跨内部界面的压力连续性以及静力-地转耦合，推导准地转位涡的正压和斜压分量，并用正压和斜压模态流函数表示。将正压模态流函数定义为质量加权平均 $ \\psi_{B} = \\dfrac{H_{1}\\,\\psi_{1} + H_{2}\\,\\psi_{2}}{H_{1}+H_{2}} $，斜压模态流函数定义为 $ \\psi_{C} = \\psi_{1} - \\psi_{2} $。根据层结和层厚度，确定斜压变形半径 $L_{D}$。\n\n然后，对于以下参数集和流函数，数值计算正压和斜压准地转位涡异常以及 $L_{D}$：\n- $f_{0} = 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}$，$\\beta = 1.6 \\times 10^{-11}\\ \\mathrm{m}^{-1}\\ \\mathrm{s}^{-1}$，\n- $H_{1} = 500\\ \\mathrm{m}$， $H_{2} = 3500\\ \\mathrm{m}$，\n- $g' = 0.02\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$，\n- $\\psi_{1}(x,y) = A_{1}\\,\\cos(k x)\\,\\cos(l y)$，其中 $A_{1} = 1.0 \\times 10^{4}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$，\n- $\\psi_{2}(x,y) = A_{2}\\,\\cos(k x)\\,\\cos(l y)$，其中 $A_{2} = 0.50 \\times 10^{4}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$，\n- $k = \\dfrac{2\\pi}{10^{6}\\ \\mathrm{m}}$，$l = \\dfrac{2\\pi}{2 \\times 10^{6}\\ \\mathrm{m}}$。\n\n计算点 $(x,y) = (0,0)$ 处的正压和斜压准地转位涡异常，并根据给定的层结和厚度计算 $L_{D}$。将位涡异常以 $\\mathrm{s}^{-1}$ 为单位表示，将 $L_{D}$ 以 $\\mathrm{km}$ 为单位表示。将最终报告的数值四舍五入到四位有效数字。你的最终答案必须是一个单行向量，按顺序包含正压准地转位涡异常、斜压准地转位涡异常和 $L_{D}$。",
            "solution": "用户希望我解决一个地球物理流体动力学问题。\n\n**1. 问题验证**\n\n首先，我必须验证问题陈述。\n\n**步骤 1：提取已知条件**\n- **模型：** beta平面上的双层准地转（QG）模型，Boussinesq 近似，静力平衡，地转平衡。\n- **层：** 上层厚度 $H_{1}$，下层厚度 $H_{2}$。\n- **界面：** 位移 $\\eta(x,y,t)$；厚度异常 $h_{1}' = -\\eta$ 和 $h_{2}' = \\eta$。\n- **科里奥利参数：** $f = f_{0} + \\beta y$，其中 $f_{0}$ 和 $\\beta$ 为常数。\n- **重力：** 折合重力 $g' = g\\,(\\rho_{2} - \\rho_{1})/\\rho_{0}$。\n- **运动学：** 地转流函数 $\\psi_{j}$，水平速度 $\\boldsymbol{u}_{j} = \\left(-\\partial \\psi_{j}/\\partial y,\\,\\partial \\psi_{j}/\\partial x\\right)$，其中 $j \\in \\{1,2\\}$。\n- **模态定义：**\n  - 正压流函数：$ \\psi_{B} = \\dfrac{H_{1}\\,\\psi_{1} + H_{2}\\,\\psi_{2}}{H_{1}+H_{2}} $\n  - 斜压流函数：$ \\psi_{C} = \\psi_{1} - \\psi_{2} $\n- **数值参数：**\n  - $f_{0} = 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}$\n  - $\\beta = 1.6 \\times 10^{-11}\\ \\mathrm{m}^{-1}\\ \\mathrm{s}^{-1}$\n  - $H_{1} = 500\\ \\mathrm{m}$\n  - $H_{2} = 3500\\ \\mathrm{m}$\n  - $g' = 0.02\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$\n  - $\\psi_{1}(x,y) = A_{1}\\,\\cos(k x)\\,\\cos(l y)$，其中 $A_{1} = 1.0 \\times 10^{4}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$\n  - $\\psi_{2}(x,y) = A_{2}\\,\\cos(k x)\\,\\cos(l y)$，其中 $A_{2} = 0.50 \\times 10^{4}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$\n  - $k = \\dfrac{2\\pi}{10^{6}\\ \\mathrm{m}}$\n  - $l = \\dfrac{2\\pi}{2 \\times 10^{6}\\ \\mathrm{m}}$\n- **求值点：** $(x,y) = (0,0)$。\n- **要求输出：** 在 $(0,0)$ 处的正压准地转位涡异常，在 $(0,0)$ 处的斜压准地转位涡异常，以及 $L_{D}$。数值需四舍五入到四位有效数字，PV 单位为 $\\mathrm{s}^{-1}$，$L_D$ 单位为 $\\mathrm{km}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是准地转动力学理论中的一个标准练习，该理论是气象学和海洋学的基础框架。所有概念和方程都是公认的。\n- **适定性：** 该问题提供了推导和后续计算所需的完整定义、方程和参数集。目标明确。存在唯一解。\n- **客观性：** 语言正式、精确，没有任何主观性。\n- **缺陷检查清单：** 该问题不违反任何无效性标准。它科学合理、可形式化、完整、现实、适定、非平凡且可验证。\n\n**步骤 3：结论与行动**\n问题有效。我将进行完整的推导和求解。\n\n**2. 准地转位涡（PV）的推导**\n\n浅水系统中单层 $j$ 的位涡守恒由下式给出：\n$$\n\\frac{D_{j}}{Dt}\\left(\\frac{\\zeta_{j} + f}{h_{j}}\\right) = 0\n$$\n其中 $\\zeta_{j} = \\nabla^2\\psi_{j}$ 是相对涡度，$h_{j}$ 是层厚度。对于准地转近似，我们假设扰动是围绕静止状态的小扰动。层厚度为 $h_{j} = H_{j} + h_{j}'$，其中 $H_{j}$ 是较大的平均厚度，且 $|h_{j}'| \\ll H_{j}$。相对涡度也假定为小量，即 $|\\zeta_{j}| \\ll f_{0}$。位涡表达式被线性化为：\n$$\n\\frac{\\zeta_{j} + f}{H_{j} + h_{j}'} = \\frac{\\zeta_{j} + f_0 + \\beta y}{H_{j}}\\left(1 + \\frac{h_{j}'}{H_{j}}\\right)^{-1} \\approx \\frac{1}{H_{j}}\\left(\\zeta_{j} + f_0 + \\beta y\\right)\\left(1 - \\frac{h_{j}'}{H_{j}}\\right) \\approx \\frac{1}{H_{j}}\\left(\\zeta_{j} + f_0 + \\beta y - f_0 \\frac{h_{j}'}{H_{j}}\\right)\n$$\n准地转位涡定义为 $q_{j} = \\zeta_{j} + f + \\frac{f_{0}}{H_{j}}h_{j}'$。在准地转近似下，平流由地转风引起，守恒定律变为 $(\\frac{\\partial}{\\partial t} + \\boldsymbol{u}_{j} \\cdot \\nabla)q_{j} = 0$。\n\n接下来，我们必须将厚度扰动 $h_{j}'$ 与流函数联系起来。问题陈述 $h_{1}' = -\\eta$ 和 $h_{2}' = \\eta$。界面位移 $\\eta$ 与压力场有关。在 Boussinesq 近似下，地转关系为 $\\boldsymbol{u}_{j} = \\frac{1}{\\rho_{0}f_{0}}\\hat{\\boldsymbol{k}}\\times\\nabla p_{j}$，这意味着 $\\psi_{j} = p_{j}/(\\rho_{0}f_{0})$。跨越界面 $z=\\eta$ 的静力平衡意味着两层之间的压力差与折合重力 $g'$ 相关。\n$$\np_{2} - p_{1} = \\rho_{0}g'\\eta\n$$\n取水平梯度并代入压力的地转关系：\n$$\n\\nabla p_{2} - \\nabla p_{1} = \\rho_{0}g'\\nabla\\eta\n$$\n$$\n\\rho_{0}f_{0}(\\hat{\\boldsymbol{k}}\\times\\boldsymbol{u}_{2} - \\hat{\\boldsymbol{k}}\\times\\boldsymbol{u}_{1}) = \\rho_{0}g'\\nabla\\eta\n$$\n代入 $\\boldsymbol{u}_{j} = \\hat{\\boldsymbol{k}}\\times\\nabla\\psi_{j}$ 并使用向量恒等式 $\\hat{\\boldsymbol{k}}\\times(\\hat{\\boldsymbol{k}}\\times\\boldsymbol{A}) = -\\boldsymbol{A}$：\n$$\nf_{0}(-\\nabla\\psi_{2} - (-\\nabla\\psi_{1})) = g'\\nabla\\eta\n$$\n$$\nf_{0}\\nabla(\\psi_{1} - \\psi_{2}) = g'\\nabla\\eta\n$$\n积分得到 $f_{0}(\\psi_{1} - \\psi_{2}) = g'\\eta$，其中任何空间均匀的积分常数都可以被吸收到流函数的定义中。因此，界面位移为：\n$$\n\\eta = \\frac{f_{0}}{g'}(\\psi_{1} - \\psi_{2})\n$$\n我们将其代入各层的准地转位涡表达式中：\n$$\nq_{1} = \\nabla^2\\psi_{1} + f - \\frac{f_{0}}{H_{1}}\\frac{f_{0}}{g'}(\\psi_{1} - \\psi_{2}) = \\nabla^2\\psi_{1} + f - \\frac{f_{0}^{2}}{g'H_{1}}(\\psi_{1} - \\psi_{2})\n$$\n$$\nq_{2} = \\nabla^2\\psi_{2} + f + \\frac{f_{0}}{H_{2}}\\frac{f_{0}}{g'}(\\psi_{1} - \\psi_{2}) = \\nabla^2\\psi_{2} + f + \\frac{f_{0}^{2}}{g'H_{2}}(\\psi_{1} - \\psi_{2})\n$$\n\n**3. 正压和斜压模态**\n\n正压和斜压模态是由层变量的线性组合形成的。令 $H = H_{1} + H_{2}$。\n正压位涡是层位涡的质量加权平均：\n$$\nq_{B} = \\frac{H_{1}q_{1} + H_{2}q_{2}}{H} = \\frac{1}{H} \\left[ H_{1}\\left(\\nabla^2\\psi_{1} + f - \\frac{f_{0}^{2}}{g'H_{1}}\\psi_{C}\\right) + H_{2}\\left(\\nabla^2\\psi_{2} + f + \\frac{f_{0}^{2}}{g'H_{2}}\\psi_{C}\\right) \\right]\n$$\n其中 $\\psi_{C} = \\psi_{1} - \\psi_{2}$ 是斜压流函数。\n$$\nq_{B} = \\frac{1}{H}\\left[\\nabla^2(H_{1}\\psi_{1} + H_{2}\\psi_{2}) + (H_{1}+H_{2})f - \\frac{f_{0}^{2}}{g'}\\psi_{C} + \\frac{f_{0}^{2}}{g'}\\psi_{C} \\right] = \\nabla^2\\left(\\frac{H_{1}\\psi_{1} + H_{2}\\psi_{2}}{H}\\right) + f\n$$\n使用正压流函数的定义 $\\psi_{B} = (H_{1}\\psi_{1} + H_{2}\\psi_{2})/H$，我们得到：\n$$\nq_{B} = \\nabla^2\\psi_{B} + f\n$$\n斜压位涡是层位涡之差：\n$$\nq_{C} = q_{1} - q_{2} = \\left(\\nabla^2\\psi_{1} + f - \\frac{f_{0}^{2}}{g'H_{1}}\\psi_{C}\\right) - \\left(\\nabla^2\\psi_{2} + f + \\frac{f_{0}^{2}}{g'H_{2}}\\psi_{C}\\right)\n$$\n$$\nq_{C} = \\nabla^2(\\psi_{1} - \\psi_{2}) - \\left(\\frac{f_{0}^{2}}{g'H_{1}} + \\frac{f_{0}^{2}}{g'H_{2}}\\right)(\\psi_{1} - \\psi_{2})\n$$\n$$\nq_{C} = \\nabla^2\\psi_{C} - \\frac{f_{0}^{2}}{g'}\\left(\\frac{H_{1}+H_{2}}{H_{1}H_{2}}\\right)\\psi_{C}\n$$\n该表达式定义了斜压变形半径 $L_{D}$，使得 $L_{D}^{-2} = \\frac{f_{0}^{2}(H_{1}+H_{2})}{g'H_{1}H_{2}}$。\n$$\nq_{C} = \\nabla^2\\psi_{C} - \\frac{1}{L_{D}^{2}}\\psi_{C}\n$$\n准地转位涡异常是 $q_B$ 和 $q_C$ 中依赖于流函数的部分：\n正压异常：$q'_{B} = \\nabla^2\\psi_{B}$。\n斜压异常：$q'_{C} = \\nabla^2\\psi_{C} - \\frac{1}{L_{D}^{2}}\\psi_{C}$。\n\n**4. 数值计算**\n\n**4.1. 斜压变形半径，$L_{D}$**\n首先，我们根据其定义计算 $L_{D}$：\n$$\nL_{D}^{2} = \\frac{g'H_{1}H_{2}}{f_{0}^{2}(H_{1}+H_{2})} = \\frac{(0.02\\ \\mathrm{m}\\ \\mathrm{s}^{-2})(500\\ \\mathrm{m})(3500\\ \\mathrm{m})}{(1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1})^{2}(500\\ \\mathrm{m} + 3500\\ \\mathrm{m})}\n$$\n$$\nL_{D}^{2} = \\frac{35000\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-2}}{(1.0 \\times 10^{-8}\\ \\mathrm{s}^{-2})(4000\\ \\mathrm{m})} = \\frac{35000}{4.0 \\times 10^{-5}}\\ \\mathrm{m}^{2} = 8.75 \\times 10^{8}\\ \\mathrm{m}^{2}\n$$\n$$\nL_{D} = \\sqrt{8.75 \\times 10^{8}}\\ \\mathrm{m} \\approx 29580.4\\ \\mathrm{m}\n$$\n转换为公里并四舍五入到四位有效数字：\n$$\nL_{D} \\approx 29.58\\ \\mathrm{km}\n$$\n\n**4.2. 流函数模态及其拉普拉斯算子**\n流函数为 $\\psi_{1}(x,y) = A_{1}\\cos(kx)\\cos(ly)$ 和 $\\psi_{2}(x,y) = A_{2}\\cos(kx)\\cos(ly)$。\n令 $C(x,y) = \\cos(kx)\\cos(ly)$。\n正压流函数为 $\\psi_{B} = A_{B}C(x,y)$，其中：\n$$\nA_{B} = \\frac{H_{1}A_{1} + H_{2}A_{2}}{H_{1} + H_{2}} = \\frac{(500)(1.0 \\times 10^{4}) + (3500)(0.5 \\times 10^{4})}{4000} = \\frac{5.0 \\times 10^{6} + 1.75 \\times 10^{7}}{4000} = \\frac{2.25 \\times 10^{7}}{4000}\n$$\n$$\nA_{B} = 5625\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1} = 5.625 \\times 10^{3}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}\n$$\n斜压流函数为 $\\psi_{C} = A_{C}C(x,y)$，其中：\n$$\nA_{C} = A_{1} - A_{2} = 1.0 \\times 10^{4} - 0.5 \\times 10^{4} = 0.5 \\times 10^{4}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}\n$$\n函数 $\\psi(x,y) = A \\cos(kx)\\cos(ly)$ 的拉普拉斯算子为：\n$$\n\\nabla^2\\psi = \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac{\\partial^2 \\psi}{\\partial y^2} = -k^{2}A\\cos(kx)\\cos(ly) - l^{2}A\\cos(kx)\\cos(ly) = -(k^{2}+l^{2})\\psi\n$$\n我们需要在点 $(x,y)=(0,0)$ 处计算位涡异常，在该点 $C(0,0)=1$，因此 $\\psi(0,0)=A$ 且 $\\nabla^2\\psi(0,0) = -(k^2+l^2)A$。\n我们来计算 $k^2+l^2$：\n$$\nk = \\frac{2\\pi}{10^{6}}\\ \\mathrm{m}^{-1}, \\quad l = \\frac{2\\pi}{2 \\times 10^{6}} = \\frac{\\pi}{10^{6}}\\ \\mathrm{m}^{-1}\n$$\n$$\nk^{2}+l^{2} = \\left(\\frac{2\\pi}{10^{6}}\\right)^{2} + \\left(\\frac{\\pi}{10^{6}}\\right)^{2} = \\frac{4\\pi^{2}}{10^{12}} + \\frac{\\pi^{2}}{10^{12}} = \\frac{5\\pi^{2}}{10^{12}}\\ \\mathrm{m}^{-2} \\approx 4.9348 \\times 10^{-11}\\ \\mathrm{m}^{-2}\n$$\n\n**4.3. 位涡异常值**\n在 $(0,0)$ 处的正压位涡异常为：\n$$\nq'_{B}(0,0) = \\nabla^2\\psi_{B}|_{(0,0)} = -(k^{2}+l^{2})A_{B} \\approx -(4.9348 \\times 10^{-11}\\ \\mathrm{m}^{-2})(5.625 \\times 10^{3}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1})\n$$\n$$\nq'_{B}(0,0) \\approx -2.7758 \\times 10^{-7}\\ \\mathrm{s}^{-1}\n$$\n四舍五入到四位有效数字，$q'_{B}(0,0) = -2.776 \\times 10^{-7}\\ \\mathrm{s}^{-1}$。\n\n在 $(0,0)$ 处的斜压位涡异常为：\n$$\nq'_{C}(0,0) = (\\nabla^2\\psi_{C} - \\frac{1}{L_{D}^{2}}\\psi_{C})|_{(0,0)} = -(k^{2}+l^{2} + \\frac{1}{L_{D}^{2}})A_{C}\n$$\n我们有 $1/L_{D}^{2} = 1/(8.75 \\times 10^{8}\\ \\mathrm{m}^{2}) \\approx 1.14286 \\times 10^{-9}\\ \\mathrm{m}^{-2}$。\n$$\nk^{2}+l^{2} + \\frac{1}{L_{D}^{2}} \\approx 4.9348 \\times 10^{-11}\\ \\mathrm{m}^{-2} + 1.14286 \\times 10^{-9}\\ \\mathrm{m}^{-2} = (0.049348 + 1.14286) \\times 10^{-9}\\ \\mathrm{m}^{-2} \\approx 1.19221 \\times 10^{-9}\\ \\mathrm{m}^{-2}\n$$\n$$\nq'_{C}(0,0) \\approx -(1.19221 \\times 10^{-9}\\ \\mathrm{m}^{-2})(0.5 \\times 10^{4}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1})\n$$\n$$\nq'_{C}(0,0) \\approx -0.596105 \\times 10^{-5}\\ \\mathrm{s}^{-1} = -5.96105 \\times 10^{-6}\\ \\mathrm{s}^{-1}\n$$\n四舍五入到四位有效数字，$q'_{C}(0,0) = -5.961 \\times 10^{-6}\\ \\mathrm{s}^{-1}$。\n\n最终结果是：\n- 正压位涡异常：$-2.776 \\times 10^{-7}\\ \\mathrm{s}^{-1}$\n- 斜压位涡异常：$-5.961 \\times 10^{-6}\\ \\mathrm{s}^{-1}$\n- 斜压变形半径：$29.58\\ \\mathrm{km}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -2.776 \\times 10^{-7} & -5.961 \\times 10^{-6} & 29.58 \\end{pmatrix}}\n$$"
        }
    ]
}