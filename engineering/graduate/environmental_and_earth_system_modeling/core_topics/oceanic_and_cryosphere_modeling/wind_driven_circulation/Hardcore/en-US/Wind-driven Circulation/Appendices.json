{
    "hands_on_practices": [
        {
            "introduction": "The Sverdrup balance is a fundamental relationship in physical oceanography, linking wind forcing to the interior ocean's meridional transport. Before we apply this powerful equation, a crucial first step is to ensure its physical and mathematical consistency. This foundational exercise guides you through a dimensional analysis of both sides of the Sverdrup balance, confirming that the advection of planetary vorticity ($\\beta V$) and the wind stress curl term are dimensionally equivalent, solidifying your understanding of the forces at play. ",
            "id": "3932825",
            "problem": "In the context of large-scale wind-driven ocean circulation, consider the meridional gradient of the Coriolis parameter and a depth-integrated meridional transport, as well as the vertical component of the horizontal curl of the wind stress scaled by a constant reference density. Begin from the following fundamental definitions and facts:\n- The Coriolis parameter is defined by $f = 2 \\Omega \\sin \\varphi$, where $\\Omega$ is the Earth's rotation rate with dimension $\\mathrm{s}^{-1}$ and $\\varphi$ is latitude (dimensionless). The meridional gradient is $\\beta = \\partial f / \\partial y$ with $y$ a meridional coordinate of dimension $\\mathrm{m}$.\n- The meridional transport $V$ is the vertical integral of the meridional velocity $v$ over depth $z$, i.e., $V = \\int v \\, \\mathrm{d}z$, where $v$ has dimension $\\mathrm{m}\\,\\mathrm{s}^{-1}$ and $z$ has dimension $\\mathrm{m}$.\n- Wind stress $\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ is the force per unit area exerted by the atmosphere on the ocean surface, with dimension $\\mathrm{N}\\,\\mathrm{m}^{-2}$; recall from Newton's second law that $\\mathrm{N} = \\mathrm{kg}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$.\n- The vertical component of the horizontal curl is $\\operatorname{curl}_z \\boldsymbol{\\tau} = \\partial \\tau_y / \\partial x - \\partial \\tau_x / \\partial y$, where the partial derivatives with respect to $x$ and $y$ each contribute a factor of inverse length $\\mathrm{m}^{-1}$ in dimensional analysis.\n- The constant reference density $\\rho_0$ has dimension $\\mathrm{kg}\\,\\mathrm{m}^{-3}$.\n\nUsing only these foundations, determine the International System of Units (SI) base-unit power vector for each of the two constructed quantities, $\\beta V$ and $(\\operatorname{curl}_z \\boldsymbol{\\tau}) / \\rho_0$, and verify that they are identical. Report the common SI base-unit power vector ordered as $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s})$ as a single row matrix. No numerical values are required, and no rounding is needed. Do not include units in your final boxed answer; provide only the integer exponents corresponding to $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s})$.",
            "solution": "The problem requires a dimensional analysis of two quantities central to the Sverdrup balance in wind-driven ocean circulation: the planetary vorticity advection term, $\\beta V$, and the wind stress curl term, $(\\operatorname{curl}_z \\boldsymbol{\\tau}) / \\rho_0$. The objective is to determine the SI base-unit power vector for each quantity and verify their identity. We will use the fundamental dimensions of mass ($M$), length ($L$), and time ($T$), which correspond to the SI base units kilogram ($\\mathrm{kg}$), meter ($\\mathrm{m}$), and second ($\\mathrm{s}$), respectively.\n\nFirst, we analyze the term $\\beta V$. This requires finding the dimensions of $\\beta$ and $V$ separately.\n\nThe meridional gradient of the Coriolis parameter is $\\beta = \\partial f / \\partial y$. The dimensions of $\\beta$, denoted as $[\\beta]$, are the dimensions of $f$ divided by the dimensions of $y$.\nThe Coriolis parameter $f$ is given by $f = 2 \\Omega \\sin \\varphi$.\n- The factor of $2$ is a dimensionless number.\n- The Earth's rotation rate $\\Omega$ is given to have dimensions of inverse time, so $[\\Omega] = T^{-1}$.\n- The latitude $\\varphi$ and its sine, $\\sin \\varphi$, are dimensionless quantities.\nTherefore, the dimensions of the Coriolis parameter are $[f] = T^{-1}$.\nThe meridional coordinate $y$ is a length, so $[y] = L$.\nCombining these, the dimensions of $\\beta$ are:\n$$ [\\beta] = \\frac{[f]}{[y]} = \\frac{T^{-1}}{L} = L^{-1} T^{-1} $$\n\nNext, we find the dimensions of the meridional transport $V$. The definition is $V = \\int v \\, \\mathrm{d}z$. The dimensions of an integral are the product of the dimensions of the integrand and the differential.\n- The meridional velocity $v$ has dimensions of length per time, so $[v] = L T^{-1}$.\n- The depth coordinate $z$ is a length, so the differential $\\mathrm{d}z$ also has dimensions of length, $[\\mathrm{d}z] = L$.\nThe dimensions of the meridional transport $V$ are therefore:\n$$ [V] = [v] [z] = (L T^{-1}) (L) = L^2 T^{-1} $$\n\nNow, we can find the dimensions of the product $\\beta V$:\n$$ [\\beta V] = [\\beta] [V] = (L^{-1} T^{-1}) (L^2 T^{-1}) = L^{(-1+2)} T^{(-1-1)} = L^1 T^{-2} $$\nIn terms of base SI units $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s})$, the corresponding dimensions are $M^0 L^1 T^{-2}$. This gives the power vector $(0, 1, -2)$.\n\nSecond, we analyze the term $(\\operatorname{curl}_z \\boldsymbol{\\tau}) / \\rho_0$. We first determine the dimensions of the numerator, $\\operatorname{curl}_z \\boldsymbol{\\tau}$.\n\nThe wind stress $\\boldsymbol{\\tau}$ is a force per unit area, given with dimensions of $\\mathrm{N}\\,\\mathrm{m}^{-2}$.\n- The Newton ($\\mathrm{N}$) is a unit of force, which from Newton's second law ($F=ma$) has dimensions of mass times acceleration. So, $[\\mathrm{N}] = M L T^{-2}$.\n- Area has dimensions of $L^2$.\nTherefore, the dimensions of wind stress are:\n$$ [\\boldsymbol{\\tau}] = \\frac{M L T^{-2}}{L^2} = M L^{-1} T^{-2} $$\n\nThe vertical component of the horizontal curl of the wind stress is $\\operatorname{curl}_z \\boldsymbol{\\tau} = \\partial \\tau_y / \\partial x - \\partial \\tau_x / \\partial y$. The differentiation with respect to a spatial coordinate ($x$ or $y$) introduces a dimension of inverse length, $L^{-1}$.\nThe dimensions of $\\operatorname{curl}_z \\boldsymbol{\\tau}$ are thus:\n$$ [\\operatorname{curl}_z \\boldsymbol{\\tau}] = \\frac{[\\boldsymbol{\\tau}]}{L} = \\frac{M L^{-1} T^{-2}}{L} = M L^{-2} T^{-2} $$\n\nNext, we consider the denominator, the reference density $\\rho_0$.\n- Density is mass per unit volume. Volume has dimensions of $L^3$.\nThe dimensions of $\\rho_0$ are given as $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, which corresponds to:\n$$ [\\rho_0] = M L^{-3} $$\n\nFinally, we combine the dimensions of the numerator and denominator to find the dimensions of the entire expression:\n$$ \\left[\\frac{\\operatorname{curl}_z \\boldsymbol{\\tau}}{\\rho_0}\\right] = \\frac{[\\operatorname{curl}_z \\boldsymbol{\\tau}]}{[\\rho_0]} = \\frac{M L^{-2} T^{-2}}{M L^{-3}} = M^{(1-1)} L^{(-2 - (-3))} T^{-2} = M^0 L^1 T^{-2} $$\nIn terms of base SI units $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s})$, this corresponds to dimensions $M^0 L^1 T^{-2}$. This gives the power vector $(0, 1, -2)$.\n\nBoth quantities, $\\beta V$ and $(\\operatorname{curl}_z \\boldsymbol{\\tau}) / \\rho_0$, have dimensions of $L T^{-2}$, which are the dimensions of acceleration. The dimensional analysis confirms that they are identical, consistent with the physical law known as the Sverdrup balance. The common SI base-unit power vector, ordered as $(\\mathrm{kg}, \\mathrm{m}, \\mathrm{s})$, is $(0, 1, -2)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1  -2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having established the dimensional validity of the Sverdrup balance, we now turn to the forcing term: the wind stress curl. This practice provides a tangible, albeit idealized, wind field over a rectangular ocean basin. By calculating the curl of this field, you will learn to connect a specific atmospheric pattern to the resulting regions of poleward and equatorward flow in the ocean interior, a key skill for interpreting ocean circulation patterns. ",
            "id": "3932888",
            "problem": "Consider a midlatitude rectangular ocean domain with horizontal coordinates $x \\in [0,W]$ and $y \\in [0,L]$, where $W$ and $L$ are positive constants denoting the zonal and meridional extents, respectively. The sea-surface wind stress vector field is specified by the components $ \\tau_{x}(x,y) = \\tau_{0} \\sin\\!\\left( \\frac{2\\pi y}{L} \\right)$ and $ \\tau_{y}(x,y) = \\alpha \\tau_{0} \\cos\\!\\left( \\frac{2\\pi x}{W} \\right)$, where $\\tau_{0}  0$ is a constant amplitude and $\\alpha$ is a dimensionless constant that modulates the zonal asymmetry of the stress pattern. \n\n(a) Starting from the definition of the vertical component of the two-dimensional curl of a horizontal vector field, compute the wind stress curl $ \\left( \\nabla \\times \\boldsymbol{\\tau} \\right)_{z} $, expressed explicitly in terms of $x$, $y$, $W$, $L$, $\\tau_{0}$, and $\\alpha$. Your answer must be an analytic expression. Express the wind stress curl in units of Newton per cubic meter ($\\mathrm{N\\,m^{-3}}$).\n\n(b) Using the steady, large-scale, linear, vertically integrated vorticity balance for a homogeneous interior ocean on a beta plane, and neglecting nonlinear advection, lateral viscosity, and time dependence, derive the qualitative relationship between the sign of the wind stress curl and the sign of the interior meridional geostrophic transport. Interpret the spatial distribution of positive and negative wind stress curl for the given wind pattern, and explain where the interior transport is poleward versus equatorward under Northern Hemisphere conditions. Do not invoke any pre-stated formulas; begin from the rotating, hydrostatic, Boussinesq momentum equations, the geostrophic balance, and the definition of the curl, and proceed by taking appropriate derivatives and vertical integration to obtain the vorticity balance. \n\nThe final reported answer should be the analytic expression for the wind stress curl derived in part (a). No rounding is required.",
            "solution": "### Part (a): Computation of the Wind Stress Curl\n\nThe wind stress vector is given by $\\boldsymbol{\\tau} = \\tau_x \\hat{\\mathbf{i}} + \\tau_y \\hat{\\mathbf{j}}$, where $\\hat{\\mathbf{i}}$ and $\\hat{\\mathbf{j}}$ are the unit vectors in the zonal ($x$) and meridional ($y$) directions, respectively. The vertical component of the curl of this two-dimensional horizontal vector field in Cartesian coordinates is defined as:\n$$\n(\\nabla \\times \\boldsymbol{\\tau})_z = \\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\n$$\nThe given components of the wind stress are:\n$$\n\\tau_x(x,y) = \\tau_{0} \\sin\\left( \\frac{2\\pi y}{L} \\right)\n$$\n$$\n\\tau_y(x,y) = \\alpha \\tau_{0} \\cos\\left( \\frac{2\\pi x}{W} \\right)\n$$\nFirst, we compute the partial derivative of $\\tau_y$ with respect to $x$:\n$$\n\\frac{\\partial \\tau_y}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\alpha \\tau_{0} \\cos\\left( \\frac{2\\pi x}{W} \\right) \\right] = \\alpha \\tau_{0} \\left[ -\\sin\\left( \\frac{2\\pi x}{W} \\right) \\cdot \\frac{d}{dx}\\left(\\frac{2\\pi x}{W}\\right) \\right] = -\\frac{2\\pi \\alpha \\tau_{0}}{W} \\sin\\left( \\frac{2\\pi x}{W} \\right)\n$$\nNext, we compute the partial derivative of $\\tau_x$ with respect to $y$:\n$$\n\\frac{\\partial \\tau_x}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ \\tau_{0} \\sin\\left( \\frac{2\\pi y}{L} \\right) \\right] = \\tau_{0} \\left[ \\cos\\left( \\frac{2\\pi y}{L} \\right) \\cdot \\frac{d}{dy}\\left(\\frac{2\\pi y}{L}\\right) \\right] = \\frac{2\\pi \\tau_{0}}{L} \\cos\\left( \\frac{2\\pi y}{L} \\right)\n$$\nSubstituting these partial derivatives into the definition of the curl gives:\n$$\n(\\nabla \\times \\boldsymbol{\\tau})_z = -\\frac{2\\pi \\alpha \\tau_{0}}{W} \\sin\\left( \\frac{2\\pi x}{W} \\right) - \\frac{2\\pi \\tau_{0}}{L} \\cos\\left( \\frac{2\\pi y}{L} \\right)\n$$\nThis expression can be rearranged by factoring out the common term $-2\\pi \\tau_0$:\n$$\n(\\nabla \\times \\boldsymbol{\\tau})_z = -2\\pi \\tau_{0} \\left[ \\frac{\\alpha}{W} \\sin\\left( \\frac{2\\pi x}{W} \\right) + \\frac{1}{L} \\cos\\left( \\frac{2\\pi y}{L} \\right) \\right]\n$$\nRegarding the units, the wind stress $\\boldsymbol{\\tau}$ has units of force per area, $\\mathrm{N\\,m^{-2}}$. The curl operation involves differentiation with respect to spatial coordinates ($x$, $y$), which have units of length, $\\mathrm{m}$. Therefore, the units of the wind stress curl are $(\\mathrm{N\\,m^{-2}})/\\mathrm{m} = \\mathrm{N\\,m^{-3}}$, as requested.\n\n### Part (b): Relationship between Wind Stress Curl and Meridional Transport\n\nWe begin with the horizontal momentum equations for a rotating fluid on a beta-plane under the Boussinesq approximation, neglecting nonlinear advection, lateral viscosity, and time dependence (steady state):\n$$\n-fv = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x} + \\frac{1}{\\rho_0} \\frac{\\partial \\mathcal{T}_x}{\\partial z} \\quad (1)\n$$\n$$\nfu = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial y} + \\frac{1}{\\rho_0} \\frac{\\partial \\mathcal{T}_y}{\\partial z} \\quad (2)\n$$\nHere, $(u, v)$ are the zonal and meridional velocity components, $f$ is the Coriolis parameter, $\\rho_0$ is a constant reference density, $p$ is the pressure, and $(\\mathcal{T}_x, \\mathcal{T}_y)$ are the internal turbulent shear stresses. The hydrostatic balance holds in the vertical.\n\nIn the ocean interior, away from the surface and bottom boundary layers, frictional effects are negligible. The momentum balance simplifies to the geostrophic balance:\n$$\n-fv_g = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x}\n$$\n$$\nfu_g = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial y}\n$$\nwhere $(u_g, v_g)$ are the geostrophic velocities.\n\nTo relate the interior flow to the surface wind stress, we vertically integrate the full momentum equations (1) and (2) from the sea floor at $z = -H$ to the sea surface at $z = \\eta \\approx 0$. Let $U = \\int_{-H}^{0} u \\, dz$ and $V = \\int_{-H}^{0} v \\, dz$ be the zonal and meridional volume transports per unit width. Integrating (1) and (2) gives:\n$$\n-fV = -\\frac{1}{\\rho_0} \\frac{\\partial P}{\\partial x} + \\frac{1}{\\rho_0} [\\mathcal{T}_x(z=0) - \\mathcal{T}_x(z=-H)]\n$$\n$$\nfU = -\\frac{1}{\\rho_0} \\frac{\\partial P}{\\partial y} + \\frac{1}{\\rho_0} [\\mathcal{T}_y(z=0) - \\mathcal{T}_y(z=-H)]\n$$\nwhere $P = \\int_{-H}^{0} p \\, dz$ is the integrated pressure. The turbulent stress at the sea surface is the wind stress, so $\\mathcal{T}(z=0) = \\boldsymbol{\\tau}$. The problem implicitly asks to neglect bottom friction, so the stress at the sea floor is zero, $\\mathcal{T}(z=-H) = 0$. The integrated momentum equations thus become:\n$$\n-fV = -\\frac{1}{\\rho_0} \\frac{\\partial P}{\\partial x} + \\frac{\\tau_x}{\\rho_0} \\quad (3)\n$$\n$$\nfU = -\\frac{1}{\\rho_0} \\frac{\\partial P}{\\partial y} + \\frac{\\tau_y}{\\rho_0} \\quad (4)\n$$\nTo form the vorticity balance, we take the curl of the transport equations. We calculate $\\frac{\\partial}{\\partial x}(4) - \\frac{\\partial}{\\partial y}(3)$:\n$$\n\\frac{\\partial(fU)}{\\partial x} - \\frac{\\partial(-fV)}{\\partial y} = -\\frac{1}{\\rho_0} \\frac{\\partial^2 P}{\\partial x \\partial y} + \\frac{1}{\\rho_0} \\frac{\\partial \\tau_y}{\\partial x} - \\left( -\\frac{1}{\\rho_0} \\frac{\\partial^2 P}{\\partial y \\partial x} + \\frac{1}{\\rho_0} \\frac{\\partial \\tau_x}{\\partial y} \\right)\n$$\nThe pressure terms cancel due to the commutativity of partial derivatives ($\\frac{\\partial^2 P}{\\partial x \\partial y} = \\frac{\\partial^2 P}{\\partial y \\partial x}$). The equation simplifies to:\n$$\n\\frac{\\partial(fU)}{\\partial x} + \\frac{\\partial(fV)}{\\partial y} = \\frac{1}{\\rho_0} \\left( \\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y} \\right)\n$$\nThe right-hand side is $\\frac{1}{\\rho_0} (\\nabla \\times \\boldsymbol{\\tau})_z$. We expand the left-hand side:\n$$\nf\\left(\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y}\\right) + U\\frac{\\partial f}{\\partial x} + V\\frac{\\partial f}{\\partial y} = \\frac{1}{\\rho_0} (\\nabla \\times \\boldsymbol{\\tau})_z\n$$\nFor large-scale, steady, incompressible flow, the vertically integrated continuity equation is $\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} = 0$. The beta-plane approximation states that $f$ varies linearly with latitude $y$, so $f \\approx f_0 + \\beta y$, where $\\beta = \\frac{df}{dy}$ is a constant. This means $\\frac{\\partial f}{\\partial x} = 0$ and $\\frac{\\partial f}{\\partial y} = \\beta$. The equation reduces to:\n$$\n\\beta V = \\frac{1}{\\rho_0} (\\nabla \\times \\boldsymbol{\\tau})_z\n$$\nThis is the Sverdrup balance. Since the total transport $V$ is dominated by the interior geostrophic transport $V_g$, we can write $V \\approx V_g$. Thus:\n$$\nV_g \\approx \\frac{1}{\\beta \\rho_0} (\\nabla \\times \\boldsymbol{\\tau})_z\n$$\nIn the Northern Hemisphere, the Coriolis parameter increases with latitude, so $\\beta  0$. The reference density $\\rho_0$ is also positive. Therefore, the sign of the meridional geostrophic transport $V_g$ is directly proportional to the sign of the wind stress curl $(\\nabla \\times \\boldsymbol{\\tau})_z$.\n- **Qualitative Relationship**: $\\mathrm{sgn}(V_g) = \\mathrm{sgn}((\\nabla \\times \\boldsymbol{\\tau})_z)$.\n- **Interpretation**: Positive wind stress curl ($(\\nabla \\times \\boldsymbol{\\tau})_z  0$) drives poleward interior transport ($V_g  0$). Negative wind stress curl ($(\\nabla \\times \\boldsymbol{\\tau})_z  0$) drives equatorward interior transport ($V_g  0$).\n\n**Spatial Distribution for the Given Wind Pattern**:\nThe wind stress curl is $(\\nabla \\times \\boldsymbol{\\tau})_z = -2\\pi \\tau_{0} \\left[ \\frac{\\alpha}{W} \\sin\\left( \\frac{2\\pi x}{W} \\right) + \\frac{1}{L} \\cos\\left( \\frac{2\\pi y}{L} \\right) \\right]$. The sign of the curl, and hence the direction of meridional transport, depends on the sign of the term in the brackets.\n- The term $\\frac{1}{L} \\cos\\left( \\frac{2\\pi y}{L} \\right)$ is positive for $y \\in [0, L/4) \\cup (3L/4, L]$ and negative for $y \\in (L/4, 3L/4)$. This term alone would produce a negative curl (equatorward flow) in the northernmost and southernmost quarters of the basin, and a positive curl (poleward flow) in the central half of the basin.\n- The term $\\frac{\\alpha}{W} \\sin\\left( \\frac{2\\pi x}{W} \\right)$ is positive in the eastern half of the basin ($x \\in (0, W/2)$) and negative in the western half ($x \\in (W/2, W)$), assuming $\\alpha  0$. This term alone would produce a negative curl (equatorward flow) in the eastern half and a positive curl (poleward flow) in the western half.\n- The total pattern is a superposition of these two effects. For example, in the central-western part of the domain ($x$ in western half, $y$ near $L/2$), both terms in the bracket are negative, making the curl positive and driving poleward transport. In the southeastern part ($x$ in eastern half, $y$ near $0$), both terms in the bracket are positive, making the curl negative and driving equatorward transport. The domain is thus divided into regions of poleward and equatorward flow, setting up a complex pattern of multiple ocean gyres.",
            "answer": "$$\n\\boxed{-2\\pi \\tau_{0} \\left( \\frac{\\alpha}{W} \\sin\\left( \\frac{2\\pi x}{W} \\right) + \\frac{1}{L} \\cos\\left( \\frac{2\\pi y}{L} \\right) \\right)}\n$$"
        },
        {
            "introduction": "Theory becomes most powerful when it can explain and predict real-world phenomena. This final practice moves from idealized scenarios to a practical application using climatological data. You will apply the Sverdrup relation to numerically integrate the interior ocean transport across an entire basin and compare your result with measured transport in a western boundary current, directly testing a cornerstone prediction of wind-driven circulation theory. ",
            "id": "3932892",
            "problem": "A developer is asked to compute the basin-integrated interior meridional volume transport across a given latitude implied by wind forcing and compare its magnitude to a measured western boundary current transport, both expressed in Sverdrup (Sv). The computation must be derived from first principles appropriate to large-scale wind-driven circulation under steady, linear, geostrophic-hydrostatic approximations on a rotating sphere. Begin from the horizontally integrated momentum equations and their vorticity form, adopting the assumptions of a steady state, negligible nonlinear relative vorticity advection and bottom stress in the interior, and wind stress applied at the surface. Do not use any shortcut formulas beyond the standard definitions of planetary parameters and kinematic conversions. The program must numerically integrate the interior meridional transport density along longitude to obtain the total transport across the latitude.\n\nUse the following fundamental and well-tested facts and definitions:\n- Earth radius $R = 6.371 \\times 10^{6}$ meters.\n- Earth rotation rate $\\Omega = 7.2921 \\times 10^{-5}$ radians per second.\n- Ocean reference density $\\rho_0 = 1025$ kilograms per cubic meter.\n- The meridional derivative of the Coriolis parameter (\"planetary vorticity gradient\") at latitude $\\phi$ is $\\beta(\\phi) = \\dfrac{2 \\Omega \\cos \\phi}{R}$, where $\\phi$ is in radians.\n- Longitude $\\lambda$ is given in degrees; convert differences to meters at latitude $\\phi$ via $dx = R \\cos \\phi \\, \\Delta \\lambda \\, \\dfrac{\\pi}{180}$.\n- One Sverdrup (Sv) equals $10^{6}$ cubic meters per second.\n\nTask:\n1. For each test case, you are given a latitude $\\phi$ in degrees, a sequence of longitudes $\\{\\lambda_i\\}$ in degrees from the eastern boundary to the western boundary, and a colocated sequence of climatological wind stress curl values $\\{\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_i\\}$ in $\\mathrm{N}/\\mathrm{m}^{3}$ along that latitude. Treat the given sequence as samples at the specified longitudes.\n2. Starting from a steady, depth-integrated vorticity balance for a rotating, stratified ocean under geostrophic and hydrostatic approximations with surface wind stress forcing, derive the interior meridional transport density and numerically integrate it zonally using the trapezoidal rule to obtain the signed basin-integrated transport across the latitude, expressed in $\\mathrm{Sv}$. Use the sign convention that positive transport is northward in the Northern Hemisphere and southward in the Southern Hemisphere dictated by the sign of the wind stress curl term through the derived relation.\n3. Compare the magnitude of the computed interior transport to the provided measured western boundary current transport (in $\\mathrm{Sv}$) for each test case, and report the absolute difference in $\\mathrm{Sv}$.\n4. All angle inputs are in degrees; convert latitude to radians for trigonometric functions. Express the final differences in $\\mathrm{Sv}$ rounded to three decimal places.\n\nTest suite (four cases):\n- Case A (Atlantic, mid-latitude Northern Hemisphere):\n  - Latitude $\\phi = 26$ degrees.\n  - Longitudes $\\{\\lambda_i\\} = [0, -10, -20, -35, -50, -60]$ degrees.\n  - Wind stress curl $\\{\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_i\\} = [-0.6 \\times 10^{-7}, -0.8 \\times 10^{-7}, -1.1 \\times 10^{-7}, -1.2 \\times 10^{-7}, -0.9 \\times 10^{-7}, -0.7 \\times 10^{-7}]$ $\\mathrm{N}/\\mathrm{m}^{3}$.\n  - Measured western boundary current transport $= 27.3$ $\\mathrm{Sv}$.\n- Case B (control, zero wind stress curl):\n  - Latitude $\\phi = 30$ degrees.\n  - Longitudes $\\{\\lambda_i\\} = [0, -30]$ degrees.\n  - Wind stress curl $\\{\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_i\\} = [0.0, 0.0]$ $\\mathrm{N}/\\mathrm{m}^{3}$.\n  - Measured western boundary current transport $= 0.0$ $\\mathrm{Sv}$.\n- Case C (Pacific, higher latitude Northern Hemisphere with sign changes in curl):\n  - Latitude $\\phi = 40$ degrees.\n  - Longitudes $\\{\\lambda_i\\} = [100, 80, 60, 40, 20, 0, -20]$ degrees.\n  - Wind stress curl $\\{\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_i\\} = [0.1 \\times 10^{-7}, 0.05 \\times 10^{-7}, -0.05 \\times 10^{-7}, -0.15 \\times 10^{-7}, -0.2 \\times 10^{-7}, -0.1 \\times 10^{-7}, 0.0]$ $\\mathrm{N}/\\mathrm{m}^{3}$.\n  - Measured western boundary current transport $= 37.9$ $\\mathrm{Sv}$.\n- Case D (Indian Ocean, Southern Hemisphere):\n  - Latitude $\\phi = -20$ degrees.\n  - Longitudes $\\{\\lambda_i\\} = [60, 40, 20, 0, -20]$ degrees.\n  - Wind stress curl $\\{\\left(\\nabla \\times \\boldsymbol{\\tau}\\right)_i\\} = [0.05 \\times 10^{-7}, 0.07 \\times 10^{-7}, 0.09 \\times 10^{-7}, 0.08 \\times 10^{-7}, 0.06 \\times 10^{-7}]$ $\\mathrm{N}/\\mathrm{m}^{3}$.\n  - Measured western boundary current transport $= 28.0$ $\\mathrm{Sv}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$), where each $result_i$ is the absolute difference between the magnitude of the computed interior transport and the provided measured western boundary current transport for the $i$-th case, in $\\mathrm{Sv}$, rounded to three decimal places.",
            "solution": "**Derivation of the Sverdrup Balance**\n\nThe Sverdrup balance describes the steady, large-scale, wind-driven circulation in the ocean interior, away from boundary layers. The derivation begins with the horizontal momentum equations for an incompressible fluid on a rotating sphere, under the geostrophic and hydrostatic approximations. For a steady state ($\\partial / \\partial t = 0$), and neglecting nonlinear advection and lateral friction, the equations are:\n\n$$\n-f v = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial x} + \\frac{1}{\\rho_0} \\frac{\\partial \\tau_x}{\\partial z} \\\\\nf u = -\\frac{1}{\\rho_0} \\frac{\\partial p}{\\partial y} + \\frac{1}{\\rho_0} \\frac{\\partial \\tau_y}{\\partial z}\n$$\n\nHere, $u$ and $v$ are the zonal (east-west) and meridional (north-south) velocity components, respectively. The coordinates $x$ and $y$ point eastward and northward. $p$ is the pressure, $\\rho_0$ is the constant reference density of seawater, and $\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ is the horizontal stress vector. The Coriolis parameter is $f = 2\\Omega\\sin\\phi$, where $\\Omega$ is Earth's rotation rate and $\\phi$ is the latitude.\n\nWe vertically integrate these equations from the sea floor at $z = -H(x, y)$ to the sea surface at $z = 0$. Let $U = \\int_{-H}^{0} u \\, dz$ and $V = \\int_{-H}^{0} v \\, dz$ be the zonal and meridional volume transports per unit width (units of $\\mathrm{m}^2/\\mathrm{s}$).\n\nIntegrating the momentum equations yields:\n\n$$\n-f V = -\\frac{1}{\\rho_0} \\int_{-H}^{0} \\frac{\\partial p}{\\partial x} dz + \\frac{1}{\\rho_0} \\left[ \\tau_x \\right]_{-H}^{0} \\\\\nf U = -\\frac{1}{\\rho_0} \\int_{-H}^{0} \\frac{\\partial p}{\\partial y} dz + \\frac{1}{\\rho_0} \\left[ \\tau_y \\right]_{-H}^{0}\n$$\n\nThe stress at the surface ($z=0$) is the wind stress, $\\boldsymbol{\\tau}^w = (\\tau_x^w, \\tau_y^w)$. The problem states we can neglect bottom stress in the ocean interior, so the stress at $z=-H$ is zero. The equations become:\n\n$$\n-f V = -\\frac{1}{\\rho_0} \\int_{-H}^{0} \\frac{\\partial p}{\\partial x} dz + \\frac{\\tau_x^w}{\\rho_0} \\\\\nf U = -\\frac{1}{\\rho_0} \\int_{-H}^{0} \\frac{\\partial p}{\\partial y} dz + \\frac{\\tau_y^w}{\\rho_0}\n$$\n\nTo obtain the vorticity equation, we take the curl of this depth-integrated system, i.e., we compute $\\frac{\\partial}{\\partial x}(\\text{y-equation}) - \\frac{\\partial}{\\partial y}(\\text{x-equation})$:\n\n$$\n\\frac{\\partial}{\\partial x}(f U) - \\frac{\\partial}{\\partial y}(-f V) = -\\frac{1}{\\rho_0} \\frac{\\partial}{\\partial x} \\left( \\int_{-H}^{0} \\frac{\\partial p}{\\partial y} dz \\right) + \\frac{1}{\\rho_0} \\frac{\\partial}{\\partial y} \\left( \\int_{-H}^{0} \\frac{\\partial p}{\\partial x} dz \\right) + \\frac{1}{\\rho_0} \\left( \\frac{\\partial \\tau_y^w}{\\partial x} - \\frac{\\partial \\tau_x^w}{\\partial y} \\right)\n$$\n\nAssuming pressure is sufficiently smooth, the order of differentiation and integration can be swapped, and the pressure terms cancel: $\\frac{\\partial^2 p}{\\partial x \\partial y} = \\frac{\\partial^2 p}{\\partial y \\partial x}$. The right-hand side simplifies to the vertical component of the wind stress curl, $(\\nabla \\times \\boldsymbol{\\tau}^w)_z = \\frac{\\partial \\tau_y^w}{\\partial x} - \\frac{\\partial \\tau_x^w}{\\partial y}$, divided by $\\rho_0$.\n\nThe left-hand side is expanded as:\n$$\n\\frac{\\partial(fU)}{\\partial x} + \\frac{\\partial(fV)}{\\partial y} = f \\left( \\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} \\right) + U \\frac{\\partial f}{\\partial x} + V \\frac{\\partial f}{\\partial y}\n$$\n\nThe depth-integrated continuity equation for an incompressible fluid is $\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} = 0$, so the first term vanishes. Using the beta-plane approximation, the Coriolis parameter $f$ is considered a function of latitude $y$ only, so $\\frac{\\partial f}{\\partial x} = 0$. The meridional gradient of $f$ is defined as the planetary vorticity gradient, $\\beta = \\frac{df}{dy}$. The problem provides the spherical coordinate form, $\\beta(\\phi) = \\frac{2\\Omega\\cos\\phi}{R}$, where $R$ is Earth's radius. The left side thus simplifies to $\\beta V$.\n\nCombining the simplified terms, we arrive at the Sverdrup relation:\n$$\n\\beta V = \\frac{1}{\\rho_0} (\\nabla \\times \\boldsymbol{\\tau}^w)_z\n$$\nThis equation states that the meridional transport per unit width, $V$, is directly proportional to the local vertical component of the wind stress curl. We can solve for $V$, which we identify as the meridional transport density:\n$$\nV(x, y) = \\frac{1}{\\rho_0 \\beta(y)} (\\nabla \\times \\boldsymbol{\\tau}^w)_z(x, y)\n$$\n\nTo find the total interior meridional transport across a latitude line, $M_y$, we must integrate $V$ zonally across the entire basin, from the eastern boundary ($x_E$) to the western boundary ($x_W$):\n$$\nM_y = \\int_{x_E}^{x_W} V(x) dx = \\int_{x_E}^{x_W} \\frac{1}{\\rho_0 \\beta} (\\nabla \\times \\boldsymbol{\\tau}^w)_z dx\n$$\nThe theory of wind-driven gyres posits that this broad, slow interior flow is returned in a narrow, fast-flowing western boundary current. For mass to be conserved, the transport of the western boundary current, $M_{WBC}$, must balance the interior transport: $M_y + M_{WBC} = 0$, which implies $|M_y| = |M_{WBC}|$. This problem tests this theoretical equivalence by comparing the magnitude of the calculated interior transport, $|M_y|$, with the measured transport of a western boundary current.\n\n**Numerical Computation**\n\nFor each test case at a fixed latitude $\\phi$:\n1.  The planetary vorticity gradient $\\beta = \\frac{2\\Omega\\cos\\phi}{R}$ is calculated. Note that $\\phi$ must be in radians for the cosine function. Since $-90^\\circ  \\phi  90^\\circ$, $\\cos\\phi  0$, and thus $\\beta$ is always positive.\n2.  The integrand, the meridional transport density $V_i = \\frac{1}{\\rho_0 \\beta} (\\nabla \\times \\boldsymbol{\\tau})_i$, is computed for each longitude point $i$.\n3.  The zonal-coordinate positions, $x_i$, are calculated from the longitudes $\\lambda_i$ (in degrees) using a cylindrical projection at latitude $\\phi$: $x_i = R \\cos\\phi \\cdot (\\lambda_i \\cdot \\frac{\\pi}{180})$. This converts the angular positions to metric distances along the latitude line.\n4s. The total interior transport $M_y$ (in $\\mathrm{m}^3/\\mathrm{s}$) is computed by numerically integrating $V(x)$ with respect to $x$ using the trapezoidal rule, `numpy.trapz(V, x)`, which operates on the discrete sets $\\{V_i\\}$ and $\\{x_i\\}$. The longitudes are provided from east to west, so the array of $x_i$ values will be monotonically decreasing. The `trapz` function correctly handles this.\n5.  The computed transport is converted from $\\mathrm{m}^3/\\mathrm{s}$ to Sverdrups (Sv) by dividing by $10^6$.\n6.  The final result is the absolute difference between the magnitude of this computed transport and the provided measured western boundary current transport, $| |M_{y, \\text{computed}}| - M_{WBC, \\text{measured}} |$, rounded to three decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Sverdrup interior transport, compares it to measured western\n    boundary current transport, and reports the absolute difference.\n    \"\"\"\n    # Define physical constants.\n    R_EARTH = 6.371e6  # Earth radius in meters\n    OMEGA = 7.2921e-5  # Earth rotation rate in radians per second\n    RHO_0 = 1025.0     # Reference ocean density in kilograms per cubic meter\n    SV_CONVERSION = 1e6 # Conversion factor from m^3/s to Sverdrups (Sv)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"case_id\": \"A\",\n            \"phi_deg\": 26.0,\n            \"lons_deg\": np.array([0, -10, -20, -35, -50, -60]),\n            \"curl_tau\": np.array([-0.6e-7, -0.8e-7, -1.1e-7, -1.2e-7, -0.9e-7, -0.7e-7]),\n            \"measured_transport_sv\": 27.3\n        },\n        {\n            \"case_id\": \"B\",\n            \"phi_deg\": 30.0,\n            \"lons_deg\": np.array([0, -30]),\n            \"curl_tau\": np.array([0.0, 0.0]),\n            \"measured_transport_sv\": 0.0\n        },\n        {\n            \"case_id\": \"C\",\n            \"phi_deg\": 40.0,\n            \"lons_deg\": np.array([100, 80, 60, 40, 20, 0, -20]),\n            \"curl_tau\": np.array([0.1e-7, 0.05e-7, -0.05e-7, -0.15e-7, -0.2e-7, -0.1e-7, 0.0]),\n            \"measured_transport_sv\": 37.9\n        },\n        {\n            \"case_id\": \"D\",\n            \"phi_deg\": -20.0,\n            \"lons_deg\": np.array([60, 40, 20, 0, -20]),\n            \"curl_tau\": np.array([0.05e-7, 0.07e-7, 0.09e-7, 0.08e-7, 0.06e-7]),\n            \"measured_transport_sv\": 28.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        phi_deg = case[\"phi_deg\"]\n        lons_deg = case[\"lons_deg\"]\n        curl_tau = case[\"curl_tau\"]\n        measured_sv = case[\"measured_transport_sv\"]\n\n        # 1. Convert latitude from degrees to radians for trigonometric functions.\n        phi_rad = np.deg2rad(phi_deg)\n\n        # 2. Calculate the planetary vorticity gradient (beta).\n        # beta = (2 * Omega * cos(phi)) / R\n        beta = (2.0 * OMEGA * np.cos(phi_rad)) / R_EARTH\n\n        # 3. Calculate the meridional transport density V (in m^2/s) from Sverdrup relation.\n        # V = (1 / (rho_0 * beta)) * curl_tau_z\n        meridional_transport_density = (1.0 / (RHO_0 * beta)) * curl_tau\n\n        # 4. Convert longitudes (degrees) to zonal distance x (meters) at the given latitude.\n        # This creates the x-coordinates for the numerical integration.\n        # x = R * cos(phi) * lambda_rad\n        x_coords_m = R_EARTH * np.cos(phi_rad) * np.deg2rad(lons_deg)\n\n        # 5. Integrate transport density V along x using the trapezoidal rule to get total transport.\n        # The longitudes are given from east to west, so x_coords_m is a decreasing array.\n        # np.trapz correctly computes the signed integral for a non-monotonic coordinate array.\n        computed_transport_m3s = np.trapz(meridional_transport_density, x_coords_m)\n\n        # 6. Convert computed transport from m^3/s to Sverdrups (Sv).\n        computed_transport_sv = computed_transport_m3s / SV_CONVERSION\n\n        # 7. Compare the magnitude of the computed transport to the measured transport.\n        # The Sverdrup balance implies |M_interior| = |M_WBC|. We test this.\n        magnitude_computed_sv = np.abs(computed_transport_sv)\n        \n        # 8. Calculate the absolute difference and round to three decimal places.\n        absolute_difference = np.abs(magnitude_computed_sv - measured_sv)\n        results.append(round(absolute_difference, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}