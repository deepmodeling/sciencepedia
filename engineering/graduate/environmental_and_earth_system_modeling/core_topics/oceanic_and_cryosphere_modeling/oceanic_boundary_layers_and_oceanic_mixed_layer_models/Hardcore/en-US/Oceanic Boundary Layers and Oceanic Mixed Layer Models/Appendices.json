{
    "hands_on_practices": [
        {
            "introduction": "Understanding the oceanic mixed layer begins with its dynamic response to surface wind forcing. This exercise explores the fundamental balance between wind stress, the Coriolis effect, and friction within a simplified \"slab\" model. By solving for the time evolution of the mixed layer velocity, you will observe the classic spin-up of Ekman currents and the generation of inertial oscillations, providing a foundational understanding of how momentum is transferred from the atmosphere to the ocean. ",
            "id": "3901374",
            "problem": "Consider a horizontally homogeneous, one-layer slab mixed layer of thickness $h$ and density $\\rho$, initially at rest. A spatially uniform wind stress $\\boldsymbol{\\tau} = (\\tau_x,\\tau_y)$ is suddenly applied at time $t=0$ and remains constant thereafter. The depth-averaged horizontal velocity $(u(t),v(t))$ in the slab evolves under Newton’s second law with linear Coriolis acceleration and linear Rayleigh damping. Neglect barotropic and baroclinic horizontal pressure gradients and horizontal advection. The governing equations are the depth-averaged momentum equations:\n$$\n\\rho h \\,\\frac{du}{dt} - \\rho h \\, f \\, v = \\tau_x - \\rho h \\, r \\, u,\\qquad\n\\rho h \\,\\frac{dv}{dt} + \\rho h \\, f \\, u = \\tau_y - \\rho h \\, r \\, v,\n$$\nfor $t \\ge 0$ with initial conditions $u(0)=0$ and $v(0)=0$. Here $f$ is the Coriolis parameter, and $r$ is a linear damping coefficient with units of inverse time.\n\nTasks:\n- Starting only from the above equations and the stated assumptions, derive a mathematically explicit expression for the time-dependent solution $(u(t),v(t))$ for $t \\ge 0$ under a step wind stress forcing.\n- Design an algorithm that evaluates $(u(t),v(t))$ for given $(\\rho,h,f,r,\\tau_x,\\tau_y,t)$.\n\nImplementation requirements:\n- Implement your algorithm as a complete program that, without any external input, computes $(u(t),v(t))$ for each of the parameter sets listed in the test suite below.\n- Express the final velocity components in meters per second (m s$^{-1}$), and round each component to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list $[u,v]$ with no spaces. For example, the overall output format must be of the form $[[u_1,v_1],[u_2,v_2],\\dots]$ using the rounded values.\n\nPhysical units:\n- Use $\\rho$ in kg m$^{-3}$, $h$ in m, $f$ in s$^{-1}$, $r$ in s$^{-1}$, $(\\tau_x,\\tau_y)$ in N m$^{-2}$, $t$ in s, and $(u,v)$ in m s$^{-1}$.\n\nTest suite (each bullet is one test case; compute $(u(t),v(t))$ at the given $t$):\n- Case $1$ (Northern Hemisphere, moderate damping, zonal wind): $\\rho = 1025$ kg m$^{-3}$, $h = 50$ m, $f = 1\\times 10^{-4}$ s$^{-1}$, $r = 2\\times 10^{-5}$ s$^{-1}$, $\\tau_x = 0.1$ N m$^{-2}$, $\\tau_y = 0.0$ N m$^{-2}$, $t = 172800$ s.\n- Case $2$ (Southern Hemisphere, moderate damping, zonal wind): same as Case $1$ except $f = -1\\times 10^{-4}$ s$^{-1}$.\n- Case $3$ (No damping, half inertial period after onset): $\\rho = 1025$ kg m$^{-3}$, $h = 50$ m, $f = 1\\times 10^{-4}$ s$^{-1}$, $r = 0$ s$^{-1}$, $\\tau_x = 0.1$ N m$^{-2}$, $\\tau_y = 0.0$ N m$^{-2}$, $t = \\pi/|f|$ s.\n- Case $4$ (Strong damping, long time): $\\rho = 1025$ kg m$^{-3}$, $h = 50$ m, $f = 1\\times 10^{-4}$ s$^{-1}$, $r = 2\\times 10^{-4}$ s$^{-1}$, $\\tau_x = 0.1$ N m$^{-2}$, $\\tau_y = 0.0$ N m$^{-2}$, $t = 432000$ s.\n- Case $5$ (Zero wind stress): $\\rho = 1025$ kg m$^{-3}$, $h = 50$ m, $f = 1\\times 10^{-4}$ s$^{-1}$, $r = 2\\times 10^{-5}$ s$^{-1}$, $\\tau_x = 0.0$ N m$^{-2}$, $\\tau_y = 0.0$ N m$^{-2}$, $t = 100000$ s.\n- Case $6$ (Oblique wind, weak damping, mid-latitude $f$): $\\rho = 1025$ kg m$^{-3}$, $h = 30$ m, $f = 7.5\\times 10^{-5}$ s$^{-1}$, $r = 1\\times 10^{-5}$ s$^{-1}$, $\\tau_x = 0.1$ N m$^{-2}$, $\\tau_y = 0.1$ N m$^{-2}$, $t = 86400$ s.\n\nYour program must implement your derived formula and produce the single required line:\n- A list with $6$ elements, each element being a two-element list $[u,v]$ corresponding to Cases $1$ through $6$, with each number rounded to $6$ decimal places and no spaces anywhere in the line.",
            "solution": "The problem is to find the time-dependent velocity $(u(t), v(t))$ of an oceanic mixed layer slab, governed by a set of linear ordinary differential equations (ODEs), and to implement this solution numerically for a given set of test cases.\n\nThe validation of the problem statement is as follows.\n**Step 1: Extract Givens**\n- Governing Equations:\n$$\n\\rho h \\,\\frac{du}{dt} - \\rho h \\, f \\, v = \\tau_x - \\rho h \\, r \\, u\n$$\n$$\n\\rho h \\,\\frac{dv}{dt} + \\rho h \\, f \\, u = \\tau_y - \\rho h \\, r \\, v\n$$\n- Variables: Depth-averaged horizontal velocity components $(u(t),v(t))$.\n- Parameters: $\\rho$ (density), $h$ (slab thickness), $f$ (Coriolis parameter), $r$ (linear damping coefficient), $\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ (wind stress).\n- Domain: $t \\ge 0$.\n- Initial Conditions: $u(0)=0$, $v(0)=0$.\n- Assumptions: Horizontally homogeneous slab, initially at rest, forced by a spatially uniform wind stress applied at $t=0$ and constant thereafter. Neglects pressure gradients and advection.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes a slab model of the oceanic mixed layer, often called the Ekman slab model. This is a fundamental and well-established simplification in physical oceanography, directly derived from Newton's second law applied to a fluid parcel under wind, Coriolis, and frictional forces. It is scientifically sound.\n- **Well-Posed**: The problem is an initial value problem for a system of two linear, first-order, non-homogeneous ODEs with constant coefficients. Given the initial conditions $u(0)=0$ and $v(0)=0$, a unique, stable, and meaningful solution is guaranteed to exist for all $t \\ge 0$.\n- **Objective**: The problem is stated using precise mathematical formalism and objective physical quantities. There is no ambiguity or subjective language.\n- All other validation criteria are met. The problem is not incomplete, contradictory, unrealistic, ill-posed, or trivial.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full, reasoned solution will be provided.\n\n**Derivation of the Solution**\nThe governing equations can be simplified by dividing by the constant term $\\rho h$:\n$$\n\\frac{du}{dt} - f v = \\frac{\\tau_x}{\\rho h} - r u \\\\\n\\frac{dv}{dt} + f u = \\frac{\\tau_y}{\\rho h} - r v\n$$\nRearranging terms, we get a standard system of linear ODEs:\n$$\n\\frac{du}{dt} + r u - f v = \\frac{\\tau_x}{\\rho h} \\\\\n\\frac{dv}{dt} + f u + r v = \\frac{\\tau_y}{\\rho h}\n$$\nThis system can be elegantly solved by introducing a complex velocity $W(t) = u(t) + i v(t)$ and a complex forcing term $T = \\frac{\\tau_x}{\\rho h} + i \\frac{\\tau_y}{\\rho h}$. We multiply the second equation by $i$ and add it to the first:\n$$\n\\left(\\frac{du}{dt} + i\\frac{dv}{dt}\\right) + (r u + i r v) + (i f u - f v) = \\frac{\\tau_x}{\\rho h} + i \\frac{\\tau_y}{\\rho h}\n$$\nRecognizing the terms: $\\fracdW}{dt} = \\frac{du}{dt} + i\\frac{dv}{dt}$, $rW = r u + i r v$, and $i f W = i f(u+iv) = i f u - f v$. The equation simplifies to a single first-order linear ODE in the complex variable $W$:\n$$\n\\frac{dW}{dt} + (r+if)W = T\n$$\nThe initial conditions are $u(0)=0$ and $v(0)=0$, which implies $W(0) = 0$. This is a standard ODE of the form $y' + Py = Q$, where $P = r+if$ and $Q = T$ are constants. The solution is found using an integrating factor $\\mu(t) = e^{\\int P dt} = e^{(r+if)t}$. The general solution is:\n$$\nW(t) = \\frac{Q}{P} + C e^{-Pt}\n$$\nUsing the initial condition $W(0)=0$, we find the constant of integration $C$:\n$$\nW(0) = 0 = \\frac{T}{r+if} + C \\implies C = -\\frac{T}{r+if}\n$$\nThus, the specific solution for $W(t)$ is:\n$$\nW(t) = \\frac{T}{r+if} \\left(1 - e^{-(r+if)t}\\right)\n$$\nThis is the complete solution in complex form. To find $u(t)$ and $v(t)$, we must separate this expression into its real and imaginary parts.\n\nLet's define the complex steady-state velocity $W_\\infty$ as the velocity as $t \\to \\infty$ (assuming $r0$):\n$$\nW_\\infty = \\lim_{t\\to\\infty} W(t) = \\frac{T}{r+if}\n$$\nLet's\nexpress $W_\\infty$ in terms of its real and imaginary parts, $W_\\infty = U_\\infty + iV_\\infty$.\n$$\nW_\\infty = \\frac{\\frac{1}{\\rho h}(\\tau_x + i\\tau_y)}{r+if} = \\frac{\\tau_x + i\\tau_y}{\\rho h} \\frac{r-if}{r^2+f^2} = \\frac{(r\\tau_x+f\\tau_y) + i(r\\tau_y-f\\tau_x)}{\\rho h (r^2+f^2)}\n$$\nFrom this, we identify the real and imaginary components of the steady-state solution:\n$$\nU_\\infty = \\frac{r\\tau_x + f\\tau_y}{\\rho h (r^2+f^2)}\n$$\n$$\nV_\\infty = \\frac{r\\tau_y - f\\tau_x}{\\rho h (r^2+f^2)}\n$$\nNow, substitute $W_\\infty$ back into the time-dependent solution for $W(t)$:\n$$\nW(t) = W_\\infty \\left(1 - e^{-rt}e^{-ift}\\right)\n$$\nUsing Euler's formula, $e^{-ift} = \\cos(ft) - i\\sin(ft)$, we expand the expression:\n$$\nW(t) = (U_\\infty + iV_\\infty) \\left(1 - e^{-rt}(\\cos(ft) - i\\sin(ft))\\right)\n$$\n$$\nW(t) = (U_\\infty + iV_\\infty) \\left( (1 - e^{-rt}\\cos(ft)) + i(e^{-rt}\\sin(ft)) \\right)\n$$\nTo find $u(t) = \\text{Re}[W(t)]$ and $v(t) = \\text{Im}[W(t)]$, we multiply the complex numbers:\n$$\nu(t) = U_\\infty(1 - e^{-rt}\\cos(ft)) - V_\\infty(e^{-rt}\\sin(ft))\n$$\n$$\nv(t) = V_\\infty(1 - e^{-rt}\\cos(ft)) + U_\\infty(e^{-rt}\\sin(ft))\n$$\nThese expressions can be rearranged to highlight the structure of the solution, which is a steady-state component and a transient, decaying inertial oscillation:\n$$\nu(t) = U_\\infty - e^{-rt} (U_\\infty \\cos(ft) + V_\\infty \\sin(ft))\n$$\n$$\nv(t) = V_\\infty - e^{-rt} (V_\\infty \\cos(ft) - U_\\infty \\sin(ft))\n$$\nThese are the final, explicit mathematical expressions for the velocity components $u(t)$ and $v(t)$. Note that these formulas are valid for all given test cases, including the case where $r=0$ (provided $f \\neq 0$, which is true for all cases).\n\n**Algorithm Design**\nThe algorithm to compute $(u(t), v(t))$ is a direct implementation of the derived formulas:\n1.  For a given set of parameters $(\\rho, h, f, r, \\tau_x, \\tau_y, t)$:\n2.  Calculate the denominator term $D = \\rho h (r^2 + f^2)$. This term is non-zero for all test cases.\n3.  Calculate the steady-state velocity components $U_\\infty$ and $V_\\infty$:\n    - $U_\\infty = (r\\tau_x + f\\tau_y) / D$\n    - $V_\\infty = (r\\tau_y - f\\tau_x) / D$\n4.  Calculate the time-dependent terms:\n    - Exponential decay: $E = e^{-rt}$\n    - Oscillatory terms: $C_f = \\cos(ft)$, $S_f = \\sin(ft)$\n5.  Combine these to find the final velocities $u(t)$ and $v(t)$:\n    - $u(t) = U_\\infty - E (U_\\infty C_f + V_\\infty S_f)$\n    - $v(t) = V_\\infty - E (V_\\infty C_f - U_\\infty S_f)$\n6.  Round the calculated $u(t)$ and $v(t)$ to $6$ decimal places as required.\n\nThis algorithm will be implemented in Python for each of the test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the velocity of an oceanic mixed layer for a series of test cases.\n    \"\"\"\n\n    # Test suite: (rho, h, f, r, tau_x, tau_y, t)\n    # Units: kg m^-3, m, s^-1, s^-1, N m^-2, N m^-2, s\n    test_cases = [\n        # Case 1: Northern Hemisphere, moderate damping, zonal wind\n        (1025.0, 50.0, 1e-4, 2e-5, 0.1, 0.0, 172800.0),\n        # Case 2: Southern Hemisphere, moderate damping, zonal wind\n        (1025.0, 50.0, -1e-4, 2e-5, 0.1, 0.0, 172800.0),\n        # Case 3: No damping, half inertial period after onset\n        (1025.0, 50.0, 1e-4, 0.0, 0.1, 0.0, np.pi / 1e-4),\n        # Case 4: Strong damping, long time\n        (1025.0, 50.0, 1e-4, 2e-4, 0.1, 0.0, 432000.0),\n        # Case 5: Zero wind stress\n        (1025.0, 50.0, 1e-4, 2e-5, 0.0, 0.0, 100000.0),\n        # Case 6: Oblique wind, weak damping, mid-latitude f\n        (1025.0, 30.0, 7.5e-5, 1e-5, 0.1, 0.1, 86400.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho, h, f, r, tau_x, tau_y, t = case\n\n        # The analytical solution for the velocity components (u(t), v(t)) is derived\n        # from the complex velocity W(t) = u(t) + i*v(t), which follows:\n        # dW/dt + (r + i*f)W = (tau_x + i*tau_y) / (rho*h)\n        # The solution with initial condition W(0) = 0 is:\n        # W(t) = W_inf * (1 - exp(-(r + i*f)*t))\n        # where W_inf = U_inf + i*V_inf is the steady-state solution.\n        \n        # Denominator for steady-state solution\n        # This is guaranteed to be non-zero for all test cases.\n        den = rho * h * (r**2 + f**2)\n\n        # Steady-state velocity components (U_inf, V_inf)\n        U_inf = (r * tau_x + f * tau_y) / den\n        V_inf = (r * tau_y - f * tau_x) / den\n\n        # Time-dependent terms\n        exp_term = np.exp(-r * t)\n        cos_ft = np.cos(f * t)\n        sin_ft = np.sin(f * t)\n        \n        # Full time-dependent solution for u(t) and v(t)\n        # u(t) = U_inf - exp(-r*t) * (U_inf * cos(f*t) + V_inf * sin(f*t))\n        # v(t) = V_inf - exp(-r*t) * (V_inf * cos(f*t) - U_inf * sin(f*t))\n        u = U_inf - exp_term * (U_inf * cos_ft + V_inf * sin_ft)\n        v = V_inf - exp_term * (V_inf * cos_ft - U_inf * sin_ft)\n\n        # Round results to 6 decimal places as required\n        u_rounded = round(u, 6)\n        v_rounded = round(v, 6)\n        \n        results.append(f\"[{u_rounded},{v_rounded}]\")\n\n    # Format the final output string to match the required format: [[u1,v1],[u2,v2],...]\n    output_string = f\"[{','.join(results)}]\"\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "After examining the dynamic response, we turn to the thermodynamic budget, starting with its primary driver: solar radiation. The assumption of surface-only heating is often too simple for accurate modeling; in reality, shortwave radiation penetrates and is absorbed over a depth, a process dependent on water clarity. This practice demonstrates how to model this vertical distribution using a standard two-band exponential decay model, highlighting how water optical properties are critical for determining the thermal structure of the upper ocean. ",
            "id": "3901342",
            "problem": "An oceanic mixed layer model partitions the downwelling net shortwave irradiance immediately below the ocean surface, denoted by $Q_{\\mathrm{sw},0}$, into two spectral bands that obey Beer–Lambert exponential attenuation. In a horizontally homogeneous, temporally steady, plane-parallel ocean column with no internal shortwave sources and negligible internal reflection, assume the following fundamental laws and definitions:\n- For each spectral band $i \\in \\{1,2\\}$, the downwelling irradiance $I_{i}(z)$ satisfies the Beer–Lambert law $\\,\\mathrm{d}I_{i}/\\mathrm{d}z = -\\kappa_{i} I_{i}\\,$, with solution $I_{i}(z) = I_{i}(0)\\,\\exp(-z/\\lambda_{i})$, where $\\lambda_{i} = 1/\\kappa_{i}$ is the band-dependent attenuation depth.\n- The band partition at the surface is $I_{1}(0) = a\\,Q_{\\mathrm{sw},0}$ and $I_{2}(0) = (1-a)\\,Q_{\\mathrm{sw},0}$, where $a \\in (0,1)$.\n\nLet the mixed layer depth be $H$. The fraction of $Q_{\\mathrm{sw},0}$ absorbed within the mixed layer is defined as the ratio of the net shortwave energy absorbed between $z=0$ and $z=H$ to $Q_{\\mathrm{sw},0}$.\n\nTwo water types are considered, each represented by a distinct pair of attenuation depths while keeping the same band partition:\n- Clear open-ocean water: $a = 0.6$, $\\lambda_{1} = 20\\,\\mathrm{m}$, $\\lambda_{2} = 0.5\\,\\mathrm{m}$.\n- Turbid coastal water: $a = 0.6$, $\\lambda_{1} = 6\\,\\mathrm{m}$, $\\lambda_{2} = 0.5\\,\\mathrm{m}$.\n\nUsing only the principles above, derive the expression for the absorbed fraction in terms of $a$, $\\lambda_{1}$, $\\lambda_{2}$, and $H$, then evaluate it for $H = 40\\,\\mathrm{m}$ for both water types, and finally compute the difference $\\Delta F = F_{\\mathrm{turbid}} - F_{\\mathrm{clear}}$.\n\nExpress the final answer as a dimensionless decimal number and round to four significant figures. Do not use a percent sign.",
            "solution": "The physical basis is the Beer–Lambert law for attenuation of downwelling irradiance in a homogeneous medium without internal sources. For band $i \\in \\{1,2\\}$, with attenuation depth $\\lambda_{i}$ and surface value $I_{i}(0)$, the solution is\n$$\nI_{i}(z) = I_{i}(0)\\,\\exp\\!\\left(-\\frac{z}{\\lambda_{i}}\\right).\n$$\nThe volumetric absorption in an infinitesimal slab is the negative vertical divergence of downwelling irradiance, which for a one-dimensional column equals $-\\mathrm{d}I/\\mathrm{d}z$. The total absorbed shortwave between $z=0$ and $z=H$ is therefore, for each band $i$,\n$$\nA_{i}(0,H) = \\int_{0}^{H}\\left(-\\frac{\\mathrm{d}I_{i}}{\\mathrm{d}z}\\right)\\,\\mathrm{d}z = I_{i}(0) - I_{i}(H) = I_{i}(0)\\left[1 - \\exp\\!\\left(-\\frac{H}{\\lambda_{i}}\\right)\\right].\n$$\nSumming over the two bands and normalizing by $Q_{\\mathrm{sw},0}$ yields the absorbed fraction within the mixed layer:\n$$\nF(H) \\equiv \\frac{A_{1}(0,H) + A_{2}(0,H)}{Q_{\\mathrm{sw},0}} \n= \\frac{I_{1}(0)\\left[1 - \\exp\\!\\left(-\\frac{H}{\\lambda_{1}}\\right)\\right] + I_{2}(0)\\left[1 - \\exp\\!\\left(-\\frac{H}{\\lambda_{2}}\\right)\\right]}{Q_{\\mathrm{sw},0}}.\n$$\nUsing $I_{1}(0) = a\\,Q_{\\mathrm{sw},0}$ and $I_{2}(0) = (1-a)\\,Q_{\\mathrm{sw},0}$ gives\n$$\nF(H) = a\\left[1 - \\exp\\!\\left(-\\frac{H}{\\lambda_{1}}\\right)\\right] + (1-a)\\left[1 - \\exp\\!\\left(-\\frac{H}{\\lambda_{2}}\\right)\\right].\n$$\nThis can be written equivalently as\n$$\nF(H) = 1 - \\left[a\\,\\exp\\!\\left(-\\frac{H}{\\lambda_{1}}\\right) + (1-a)\\,\\exp\\!\\left(-\\frac{H}{\\lambda_{2}}\\right)\\right].\n$$\n\nWe now evaluate for $H = 40\\,\\mathrm{m}$.\n\nClear open-ocean water has $a = 0.6$, $\\lambda_{1} = 20\\,\\mathrm{m}$, $\\lambda_{2} = 0.5\\,\\mathrm{m}$. Thus\n$$\nF_{\\mathrm{clear}} = 1 - \\left[0.6\\,\\exp\\!\\left(-\\frac{40}{20}\\right) + 0.4\\,\\exp\\!\\left(-\\frac{40}{0.5}\\right)\\right] \n= 1 - \\left[0.6\\,\\exp(-2) + 0.4\\,\\exp(-80)\\right].\n$$\nNumerically, $\\exp(-2)$ is approximately $0.1353352832$, and $\\exp(-80)$ is approximately $1.804851\\times 10^{-35}$, so\n$$\nF_{\\mathrm{clear}} \\approx 1 - \\left[0.6 \\times 0.1353352832 + 0.4 \\times 1.804851\\times 10^{-35}\\right] \n\\approx 1 - 0.0812011699 \\approx 0.9187988301.\n$$\n\nTurbid coastal water has $a = 0.6$, $\\lambda_{1} = 6\\,\\mathrm{m}$, $\\lambda_{2} = 0.5\\,\\mathrm{m}$. Thus\n$$\nF_{\\mathrm{turbid}} = 1 - \\left[0.6\\,\\exp\\!\\left(-\\frac{40}{6}\\right) + 0.4\\,\\exp\\!\\left(-\\frac{40}{0.5}\\right)\\right] \n= 1 - \\left[0.6\\,\\exp\\!\\left(-\\frac{20}{3}\\right) + 0.4\\,\\exp(-80)\\right].\n$$\nNumerically, $\\exp(-20/3)$ is approximately $0.00127263380134$, and again $\\exp(-80)$ is negligible, so\n$$\nF_{\\mathrm{turbid}} \\approx 1 - \\left[0.6 \\times 0.00127263380134\\right] \\approx 1 - 0.000763580280804 \\approx 0.9992364197.\n$$\n\nThe requested difference is\n$$\n\\Delta F = F_{\\mathrm{turbid}} - F_{\\mathrm{clear}} \\approx 0.9992364197 - 0.9187988301 \\approx 0.0804375896.\n$$\nRounding to four significant figures yields\n$$\n\\Delta F \\approx 0.08044.\n$$\nThis dimensionless number represents the additional fraction of $Q_{\\mathrm{sw},0}$ absorbed within $H = 40\\,\\mathrm{m}$ in turbid coastal water relative to clear open-ocean water under the stated two-band Beer–Lambert model.",
            "answer": "$$\\boxed{0.08044}$$"
        },
        {
            "introduction": "This final practice synthesizes the concepts of dynamic and thermodynamic forcing into a comprehensive analysis of the mixed layer heat budget, a task central to both observational oceanography and model development. You will assemble a complete budget by accounting for surface heat fluxes, horizontal advection, and entrainment, and then use this framework to infer the contribution of unresolved turbulent processes as a budget residual. This exercise provides practical experience in diagnosing physical processes from data and using a \"residual analysis\" to guide the parameterization of sub-grid scale mixing, a key skill for any environmental modeler. ",
            "id": "3901401",
            "problem": "Construct a program that, given observed and estimated quantities for the oceanic Mixed Layer Depth (MLD), assembles the vertically integrated mixed layer temperature budget and infers the contribution of unresolved turbulent mixing as a residual. The program must then estimate an implied eddy diffusivity at the base of the mixed layer by assuming a Fickian closure for the vertical turbulent heat flux across the interface between the mixed layer and the stratified ocean below. The derivation must start from conservation of heat for a control volume with thickness equal to the Mixed Layer Depth (MLD), and assume constant seawater density and specific heat capacity over the mixed layer. The program must implement the budget using the following physically based terms: net surface heat flux, horizontal advection of mixed layer temperature, entrainment across the base of the mixed layer, and a residual that is interpreted as the net turbulent mixing contribution across the base. The program must compute, for each test case, two outputs: the residual turbulent mixing tendency in temperature units and the implied eddy diffusivity at the mixed layer base.\n\nUse the following physical constants in your program: seawater density $\\rho = 1025\\,\\mathrm{kg/m^3}$ and specific heat capacity $c_p = 3990\\,\\mathrm{J/(kg\\cdot K)}$.\n\nModel assumptions and definitions:\n- Let $h$ denote the Mixed Layer Depth (MLD) in $\\mathrm{m}$ and $T_m$ the horizontally averaged mixed layer temperature in $\\mathrm{K}$.\n- Let $Q_{net}$ denote the net surface heat flux in $\\mathrm{W/m^2}$, defined positive downward into the ocean.\n- Let $\\mathbf{u} = (u_x,u_y)$ denote the horizontal current in the mixed layer in $\\mathrm{m/s}$, and $\\nabla T_m = (\\partial T_m/\\partial x,\\partial T_m/\\partial y)$ the horizontal temperature gradient in $\\mathrm{K/m}$. The horizontal advection tendency is represented by $-\\mathbf{u}\\cdot\\nabla T_m$ in $\\mathrm{K/s}$.\n- Let $w_e$ denote the entrainment velocity at the base of the mixed layer in $\\mathrm{m/s}$, defined positive when the mixed layer deepens into the colder stratified layer. The entrainment tendency is represented by $(w_e/h)(T_b - T_m)$ in $\\mathrm{K/s}$, where $T_b$ is the temperature just below the base of the mixed layer in $\\mathrm{K}$.\n- The residual turbulent mixing tendency $M$ in $\\mathrm{K/s}$ is defined as the component of $\\mathrm{d}T_m/\\mathrm{d}t$ not explained by the sum of the explicitly represented budget terms.\n- Assume that the net turbulent heat flux into the mixed layer across its base can be represented by a Fickian closure $F_b = -\\rho c_p K_v \\partial T/\\partial z\\big|_{z=-h}$, where $K_v$ is an eddy diffusivity in $\\mathrm{m^2/s}$, $z$ is the vertical coordinate positive upward, and $\\partial T/\\partial z\\big|_{z=-h}$ is approximated as $(T_m - T_b)/\\delta$ with $\\delta$ an interface thickness in $\\mathrm{m}$.\n\nYour program must compute, for each test case:\n1. The residual turbulent mixing tendency $M$ in $\\mathrm{K/s}$ inferred from the temperature budget.\n2. The implied eddy diffusivity $K_v$ in $\\mathrm{m^2/s}$ at the base of the mixed layer under the above closure assumption.\n\nRequired units:\n- All input quantities must be interpreted in their given physical units.\n- Output $M$ must be expressed in $\\mathrm{K/s}$.\n- Output $K_v$ must be expressed in $\\mathrm{m^2/s}$.\n\nTest suite:\nProvide results for the following parameter sets, each specified as a tuple $(h, \\mathrm{d}T_m/\\mathrm{d}t, Q_{net}, u_x, u_y, \\partial T_m/\\partial x, \\partial T_m/\\partial y, w_e, T_m, T_b, \\delta)$ with units as defined above.\n- Case 1 (general summer conditions with weak cooling): $(h=25\\,\\mathrm{m}, \\mathrm{d}T_m/\\mathrm{d}t=-1.35\\times 10^{-6}\\,\\mathrm{K/s}, Q_{net}=150\\,\\mathrm{W/m^2}, u_x=0.15\\,\\mathrm{m/s}, u_y=0.05\\,\\mathrm{m/s}, \\partial T_m/\\partial x=2\\times 10^{-5}\\,\\mathrm{K/m}, \\partial T_m/\\partial y=-1\\times 10^{-5}\\,\\mathrm{K/m}, w_e=8\\times 10^{-6}\\,\\mathrm{m/s}, T_m=293.5\\,\\mathrm{K}, T_b=292.8\\,\\mathrm{K}, \\delta=2.0\\,\\mathrm{m})$.\n- Case 2 (entrainment-only cooling, no surface flux or advection): $(h=50\\,\\mathrm{m}, \\mathrm{d}T_m/\\mathrm{d}t=-1.0\\times 10^{-7}\\,\\mathrm{K/s}, Q_{net}=0\\,\\mathrm{W/m^2}, u_x=0.0\\,\\mathrm{m/s}, u_y=0.0\\,\\mathrm{m/s}, \\partial T_m/\\partial x=1\\times 10^{-5}\\,\\mathrm{K/m}, \\partial T_m/\\partial y=1\\times 10^{-5}\\,\\mathrm{K/m}, w_e=1.0\\times 10^{-5}\\,\\mathrm{m/s}, T_m=291.0\\,\\mathrm{K}, T_b=290.5\\,\\mathrm{K}, \\delta=1.0\\,\\mathrm{m})$.\n- Case 3 (shallow mixed layer with strong surface cooling, warming advection, and shoaling): $(h=15\\,\\mathrm{m}, \\mathrm{d}T_m/\\mathrm{d}t=-1.5\\times 10^{-6}\\,\\mathrm{K/s}, Q_{net}=-200\\,\\mathrm{W/m^2}, u_x=0.05\\,\\mathrm{m/s}, u_y=-0.03\\,\\mathrm{m/s}, \\partial T_m/\\partial x=-3\\times 10^{-5}\\,\\mathrm{K/m}, \\partial T_m/\\partial y=2\\times 10^{-5}\\,\\mathrm{K/m}, w_e=-5\\times 10^{-6}\\,\\mathrm{m/s}, T_m=296.0\\,\\mathrm{K}, T_b=295.0\\,\\mathrm{K}, \\delta=1.5\\,\\mathrm{m})$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, each inner list containing two floats $[M, K_v]$ in the order of the test suite above, enclosed in square brackets. For example: $[[M_1,K_{v,1}],[M_2,K_{v,2}],[M_3,K_{v,3}]]$.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique solution. It represents a standard exercise in oceanic physics concerning the mixed layer heat budget.\n\nThe solution is derived from the principle of conservation of heat applied to a slab model of the oceanic mixed layer. The model assumes a layer of uniform temperature $T_m$ and thickness $h$ overlying a stratified ocean. The total rate of change of the mixed layer temperature, $\\mathrm{d}T_m/\\mathrm{d}t$, is governed by the sum of several physical processes that add or remove heat from this layer. The governing budget equation is:\n\n$$\n\\frac{\\mathrm{d}T_m}{\\mathrm{d}t} = (\\text{Surface Heating}) + (\\text{Horizontal Advection}) + (\\text{Entrainment}) + (\\text{Residual Mixing})\n$$\n\nEach term represents a temperature tendency in units of $\\mathrm{K/s}$. We will formulate each term based on the problem's definitions and physical principles.\n\n1.  **Surface Heating Tendency**: The net surface heat flux, $Q_{net}$ (in $\\mathrm{W/m^2}$ or $\\mathrm{J/s \\cdot m^2}$), is absorbed by a column of water of height $h$. The heat capacity of this column per unit area is $\\rho c_p h$ (in $\\mathrm{J/m^2 \\cdot K}$), where $\\rho$ is the seawater density and $c_p$ is the specific heat capacity. The temperature tendency due to surface flux is thus:\n    $$\n    \\text{Surface Heating} = \\frac{Q_{net}}{\\rho c_p h}\n    $$\n\n2.  **Horizontal Advection Tendency**: This term represents the temperature change due to the movement of water with a different temperature horizontally into the region of interest. It is given by the dot product of the velocity vector $\\mathbf{u}$ and the temperature gradient vector $\\nabla T_m$. As per the problem's definition:\n    $$\n    \\text{Horizontal Advection} = -\\mathbf{u} \\cdot \\nabla T_m = -(u_x \\frac{\\partial T_m}{\\partial x} + u_y \\frac{\\partial T_m}{\\partial y})\n    $$\n\n3.  **Entrainment Tendency**: This term accounts for the temperature change caused by the deepening or shoaling of the mixed layer. When the mixed layer deepens ($w_e  0$), it entrains colder water from the thermocline below. The problem explicitly defines this tendency as:\n    $$\n    \\text{Entrainment} = \\frac{w_e}{h}(T_b - T_m)\n    $$\n    where $T_b$ is the temperature just below the mixed layer base. This formulation applies for both deepening ($w_e  0$) and shoaling ($w_e  0$).\n\n4.  **Residual Mixing Tendency ($M$)**: This term, $M$, represents all other unresolved processes, which are interpreted as the effect of turbulent mixing across the base of the mixed layer. It is calculated as the residual required to close the heat budget.\n\nCombining these terms, the full budget equation is:\n$$\n\\frac{\\mathrm{d}T_m}{\\mathrm{d}t} = \\frac{Q_{net}}{\\rho c_p h} - (u_x \\frac{\\partial T_m}{\\partial x} + u_y \\frac{\\partial T_m}{\\partial y}) + \\frac{w_e}{h}(T_b - T_m) + M\n$$\n\nTo find the first required output, we rearrange this equation to solve for $M$:\n$$\nM = \\frac{\\mathrm{d}T_m}{\\mathrm{d}t} - \\frac{Q_{net}}{\\rho c_p h} + (u_x \\frac{\\partial T_m}{\\partial x} + u_y \\frac{\\partial T_m}{\\partial y}) - \\frac{w_e}{h}(T_b - T_m)\n$$\n\nThe second part of the problem is to infer an eddy diffusivity, $K_v$, from this residual tendency. The tendency $M$ is assumed to be caused by a net vertical turbulent heat flux, $F_b$, at the base of the mixed layer ($z=-h$). The relationship between a flux at the boundary and the resulting temperature tendency in the layer is:\n$$\nM = \\frac{F_b}{\\rho c_p h}\n$$\nThe problem specifies a Fickian closure for this flux, which states that the flux is proportional to the local temperature gradient:\n$$\nF_b = -\\rho c_p K_v \\frac{\\partial T}{\\partial z}\\bigg|_{z=-h}\n$$\nThe vertical temperature gradient at the interface is approximated as:\n$$\n\\frac{\\partial T}{\\partial z}\\bigg|_{z=-h} \\approx \\frac{T_m - T_b}{\\delta}\n$$\nwhere $\\delta$ is the thickness of the interface.\n\nSubstituting the flux closure and gradient approximation into the equation for $M$:\n$$\nM = \\frac{1}{\\rho c_p h} \\left( -\\rho c_p K_v \\frac{T_m - T_b}{\\delta} \\right) = -K_v \\frac{T_m - T_b}{h \\delta}\n$$\nTo find the second required output, we solve for $K_v$:\n$$\nK_v = - M \\frac{h \\delta}{T_m - T_b}\n$$\nA physically meaningful diffusivity $K_v$ must be non-negative. Since $h0$, $\\delta0$, and typically $T_m  T_b$, this requires the residual tendency $M$ to be non-positive ($M \\le 0$). A negative $M$ corresponds to cooling of the mixed layer by turbulent mixing of colder water from below, which is physically expected. A calculated positive $M$ would imply an unphysical negative $K_v$, indicating that the model and data are inconsistent with a simple downgradient turbulent flux. The program will compute the value of $K_v$ according to the formula, regardless of its sign.\n\nThe constants provided are $\\rho = 1025\\,\\mathrm{kg/m^3}$ and $c_p = 3990\\,\\mathrm{J/(kg\\cdot K)}$. These values, along with the derived equations for $M$ and $K_v$, will be implemented in the program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the residual turbulent mixing tendency and implied eddy diffusivity\n    for the oceanic mixed layer based on a heat budget.\n    \"\"\"\n    \n    # Physical constants\n    RHO = 1025.0  # Seawater density in kg/m^3\n    CP = 3990.0   # Specific heat capacity of seawater in J/(kg*K)\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (h, dTm/dt, Qnet, ux, uy, dTm/dx, dTm/dy, we, Tm, Tb, delta)\n    test_cases = [\n        # Case 1: General summer conditions with weak cooling\n        (25.0, -1.35e-6, 150.0, 0.15, 0.05, 2.0e-5, -1.0e-5, 8.0e-6, 293.5, 292.8, 2.0),\n        # Case 2: Entrainment-only cooling, no surface flux or advection\n        (50.0, -1.0e-7, 0.0, 0.0, 0.0, 1.0e-5, 1.0e-5, 1.0e-5, 291.0, 290.5, 1.0),\n        # Case 3: Shallow mixed layer with strong surface cooling, warming advection, and shoaling\n        (15.0, -1.5e-6, -200.0, 0.05, -0.03, -3.0e-5, 2.0e-5, -5.0e-6, 296.0, 295.0, 1.5)\n    ]\n\n    results = []\n    for case in test_cases:\n        h, dTm_dt, Q_net, u_x, u_y, dT_dx, dT_dy, w_e, T_m, T_b, delta = case\n\n        # 1. Calculate the tendency terms for the heat budget.\n        # The total budget is: dTm/dt = S + A + E + M\n        # where S is surface flux, A is advection, E is entrainment, M is residual mixing.\n        \n        # Surface heating tendency (K/s)\n        # S = Q_net / (rho * cp * h)\n        surface_flux_tendency = Q_net / (RHO * CP * h)\n\n        # Horizontal advection tendency (K/s)\n        # A = - (u_x * dT_dx + u_y * dT_dy)\n        advection_tendency = - (u_x * dT_dx + u_y * dT_dy)\n\n        # Entrainment tendency (K/s)\n        # E = (w_e / h) * (T_b - T_m)\n        if h == 0:\n            entrainment_tendency = 0.0\n        else:\n            entrainment_tendency = (w_e / h) * (T_b - T_m)\n\n        # 2. Calculate the residual turbulent mixing tendency M (K/s)\n        # M = dTm/dt - S - A - E\n        M = dTm_dt - surface_flux_tendency - advection_tendency - entrainment_tendency\n        \n        # 3. Calculate the implied eddy diffusivity Kv (m^2/s)\n        # M = -Kv * (Tm - Tb) / (h * delta) = Kv = -M * h * delta / (Tm - Tb)\n        temp_diff = T_m - T_b\n        if temp_diff == 0:\n            # If M is non-zero, Kv is infinite. If M is zero, Kv is indeterminate.\n            # In either case, represents a pathological condition.\n            if M == 0:\n                K_v = 0.0 # Indeterminate, but 0 is a reasonable default\n            else:\n                K_v = np.inf\n        else:\n            K_v = -M * h * delta / temp_diff\n            \n        results.append([M, K_v])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list is used.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}