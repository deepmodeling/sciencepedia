{
    "hands_on_practices": [
        {
            "introduction": "风生流是上层海洋环流的基本组成部分。平板模型为混合层对风应力的动力学响应提供了最简洁的描述。本练习将引导你从第一性原理出发，推导并实现一个埃克曼流随时间演化的模型。通过求解速度，你将能直接观察到惯性振荡和稳态埃克曼漂流的建立等关键现象，这对于理解风能如何传递给海洋至关重要。",
            "id": "3901374",
            "problem": "考虑一个厚度为 $h$、密度为 $\\rho$ 的水平均质单层板状混合层，初始状态为静止。在时间 $t=0$ 时，一个空间均匀的风应力 $\\boldsymbol{\\tau} = (\\tau_x,\\tau_y)$ 突然施加，并在此后保持恒定。该板层中的垂向平均水平速度 $(u(t),v(t))$ 在线性科里奥利加速度和线性瑞利阻尼的作用下，遵循牛顿第二定律演变。忽略正压和斜压水平压力梯度以及水平平流。控制方程为垂向平均的动量方程：\n$$\n\\rho h \\,\\frac{du}{dt} - \\rho h \\, f \\, v = \\tau_x - \\rho h \\, r \\, u,\\qquad\n\\rho h \\,\\frac{dv}{dt} + \\rho h \\, f \\, u = \\tau_y - \\rho h \\, r \\, v,\n$$\n对于 $t \\ge 0$，初始条件为 $u(0)=0$ 和 $v(0)=0$。此处，$f$ 是科里奥利参数，$r$ 是一个线性阻尼系数，单位为时间的倒数。\n\n任务：\n- 仅从上述方程和所述假设出发，推导在阶跃风应力强迫下，对于 $t \\ge 0$ 的随时间变化的解 $(u(t),v(t))$ 的数学显式表达式。\n- 设计一个算法，用于根据给定的 $(\\rho,h,f,r,\\tau_x,\\tau_y,t)$ 计算 $(u(t),v(t))$。\n\n实现要求：\n- 将您的算法实现为一个完整的程序，该程序无需任何外部输入，即可为下面测试套件中列出的每个参数集计算 $(u(t),v(t))$。\n- 将最终速度分量以米每秒 (m s$^{-1}$) 表示，并将每个分量四舍五入到$6$位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个双元素列表 $[u,v]$，不含空格。例如，整体输出格式必须是使用四舍五入值的 $[[u_1,v_1],[u_2,v_2],\\dots]$ 形式。\n\n物理单位：\n- 使用 $\\rho$ 单位 kg m$^{-3}$，$h$ 单位 m，$f$ 单位 s$^{-1}$，$r$ 单位 s$^{-1}$，$(\\tau_x,\\tau_y)$ 单位 N m$^{-2}$，$t$ 单位 s，以及 $(u,v)$ 单位 m s$^{-1}$。\n\n测试套件（每个项目符号为一个测试用例；计算在给定时间 $t$ 时的 $(u(t),v(t))$）：\n- 案例$1$（北半球，中等阻尼，纬向风）：$\\rho = 1025$ kg m$^{-3}$, $h = 50$ m, $f = 1\\times 10^{-4}$ s$^{-1}$, $r = 2\\times 10^{-5}$ s$^{-1}$, $\\tau_x = 0.1$ N m$^{-2}$, $\\tau_y = 0.0$ N m$^{-2}$, $t = 172800$ s。\n- 案例$2$（南半球，中等阻尼，纬向风）：与案例$1$相同，除了 $f = -1\\times 10^{-4}$ s$^{-1}$。\n- 案例$3$（无阻尼，起始后半个惯性周期）：$\\rho = 1025$ kg m$^{-3}$, $h = 50$ m, $f = 1\\times 10^{-4}$ s$^{-1}$, $r = 0$ s$^{-1}$, $\\tau_x = 0.1$ N m$^{-2}$, $\\tau_y = 0.0$ N m$^{-2}$, $t = \\pi/|f|$ s。\n- 案例$4$（强阻尼，长时间）：$\\rho = 1025$ kg m$^{-3}$, $h = 50$ m, $f = 1\\times 10^{-4}$ s$^{-1}$, $r = 2\\times 10^{-4}$ s$^{-1}$, $\\tau_x = 0.1$ N m$^{-2}$, $\\tau_y = 0.0$ N m$^{-2}$, $t = 432000$ s。\n- 案例$5$（零风应力）：$\\rho = 1025$ kg m$^{-3}$, $h = 50$ m, $f = 1\\times 10^{-4}$ s$^{-1}$, $r = 2\\times 10^{-5}$ s$^{-1}$, $\\tau_x = 0.0$ N m$^{-2}$, $\\tau_y = 0.0$ N m$^{-2}$, $t = 100000$ s。\n- 案例$6$（斜风，弱阻尼，中纬度 f）：$\\rho = 1025$ kg m$^{-3}$, $h = 30$ m, $f = 7.5\\times 10^{-5}$ s$^{-1}$, $r = 1\\times 10^{-5}$ s$^{-1}$, $\\tau_x = 0.1$ N m$^{-2}$, $\\tau_y = 0.1$ N m$^{-2}$, $t = 86400$ s。\n\n您的程序必须实现您推导的公式，并生成所需的单行输出：\n- 一个包含 $6$ 个元素的列表，每个元素是对应于案例1到6的双元素列表 $[u,v]$，每个数字四舍五入到$6$位小数，并且行中任何地方都没有空格。",
            "solution": "问题是要求解由一组线性常微分方程（ODE）控制的海洋混合层板的随时间变化的速度 $(u(t), v(t))$，并针对一组给定的测试用例对该解进行数值实现。\n\n对问题陈述的验证如下。\n**第一步：提取已知条件**\n- 控制方程：\n$$\n\\rho h \\,\\frac{du}{dt} - \\rho h \\, f \\, v = \\tau_x - \\rho h \\, r \\, u\n$$\n$$\n\\rho h \\,\\frac{dv}{dt} + \\rho h \\, f \\, u = \\tau_y - \\rho h \\, r \\, v\n$$\n- 变量：垂向平均的水平速度分量 $(u(t),v(t))$。\n- 参数：$\\rho$ (密度)，$h$ (板层厚度)，$f$ (科里奥利参数)，$r$ (线性阻尼系数)，$\\boldsymbol{\\tau} = (\\tau_x, \\tau_y)$ (风应力)。\n- 定义域：$t \\ge 0$。\n- 初始条件：$u(0)=0$，$v(0)=0$。\n- 假设：水平均质的板层，初始静止，受 $t=0$ 时施加并此后恒定的空间均匀风应力强迫。忽略压力梯度和平流。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了海洋混合层的板状模型，通常称为 Ekman 板状模型。这是物理海洋学中一个基础且公认的简化模型，直接从 Newton 第二定律应用于受风、科里奥利力和摩擦力作用的流体质点推导而来。它在科学上是合理的。\n- **适定性**：该问题是一个由两个线性、一阶、常系数非齐次常微分方程组构成的初值问题。给定初始条件 $u(0)=0$ 和 $v(0)=0$，保证对所有 $t \\ge 0$ 都存在唯一、稳定且有意义的解。\n- **客观性**：该问题使用精确的数学形式和客观的物理量进行陈述。没有模棱两可或主观性语言。\n所有其他验证标准均已满足。该问题并非不完整、矛盾、不切实际、不适定或微不足道。\n\n**第三步：结论与行动**\n问题是有效的。将提供一个完整的、有理有据的解答。\n\n**解的推导**\n通过除以常数项 $\\rho h$，可以简化控制方程：\n$$\n\\frac{du}{dt} - f v = \\frac{\\tau_x}{\\rho h} - r u \\\\\n\\frac{dv}{dt} + f u = \\frac{\\tau_y}{\\rho h} - r v\n$$\n整理各项，我们得到一个标准的线性常微分方程组：\n$$\n\\frac{du}{dt} + r u - f v = \\frac{\\tau_x}{\\rho h} \\\\\n\\frac{dv}{dt} + f u + r v = \\frac{\\tau_y}{\\rho h}\n$$\n这个方程组可以通过引入复速度 $W(t) = u(t) + i v(t)$ 和复强迫项 $T = \\frac{\\tau_x}{\\rho h} + i \\frac{\\tau_y}{\\rho h}$ 来巧妙地求解。我们将第二个方程乘以 $i$ 并加到第一个方程上：\n$$\n\\left(\\frac{du}{dt} + i\\frac{dv}{dt}\\right) + (r u + i r v) + (i f u - f v) = \\frac{\\tau_x}{\\rho h} + i \\frac{\\tau_y}{\\rho h}\n$$\n识别各项：$\\frac{dW}{dt} = \\frac{du}{dt} + i\\frac{dv}{dt}$，$rW = r u + i r v$，以及 $i f W = i f(u+iv) = i f u - f v$。方程简化为关于复变量 $W$ 的单个一阶线性常微分方程：\n$$\n\\frac{dW}{dt} + (r+if)W = T\n$$\n初始条件为 $u(0)=0$ 和 $v(0)=0$，这意味着 $W(0) = 0$。这是一个标准形式为 $y' + Py = Q$ 的常微分方程，其中 $P = r+if$ 和 $Q = T$ 是常数。解可以通过使用积分因子 $\\mu(t) = e^{\\int P dt} = e^{(r+if)t}$ 求得。通解为：\n$$\nW(t) = \\frac{Q}{P} + C e^{-Pt}\n$$\n使用初始条件 $W(0)=0$，我们求出积分常数 $C$：\n$$\nW(0) = 0 = \\frac{T}{r+if} + C \\implies C = -\\frac{T}{r+if}\n$$\n因此，$W(t)$ 的特解是：\n$$\nW(t) = \\frac{T}{r+if} \\left(1 - e^{-(r+if)t}\\right)\n$$\n这是复数形式的完整解。为了求得 $u(t)$ 和 $v(t)$，我们必须将此表达式分离为实部和虚部。\n\n让我们将复稳态速度 $W_\\infty$ 定义为当 $t \\to \\infty$ 时的速度（假设 $r0$）：\n$$\nW_\\infty = \\lim_{t\\to\\infty} W(t) = \\frac{T}{r+if}\n$$\n让我们用其实部和虚部来表示 $W_\\infty$，$W_\\infty = U_\\infty + iV_\\infty$。\n$$\nW_\\infty = \\frac{\\frac{1}{\\rho h}(\\tau_x + i\\tau_y)}{r+if} = \\frac{\\tau_x + i\\tau_y}{\\rho h} \\frac{r-if}{r^2+f^2} = \\frac{(r\\tau_x+f\\tau_y) + i(r\\tau_y-f\\tau_x)}{\\rho h (r^2+f^2)}\n$$\n由此，我们确定稳态解的实部和虚部分量：\n$$\nU_\\infty = \\frac{r\\tau_x + f\\tau_y}{\\rho h (r^2+f^2)}\n$$\n$$\nV_\\infty = \\frac{r\\tau_y - f\\tau_x}{\\rho h (r^2+f^2)}\n$$\n现在，将 $W_\\infty$ 代回到 $W(t)$ 的时变解中：\n$$\nW(t) = W_\\infty \\left(1 - e^{-rt}e^{-ift}\\right)\n$$\n使用 Euler 公式，$e^{-ift} = \\cos(ft) - i\\sin(ft)$，我们展开表达式：\n$$\nW(t) = (U_\\infty + iV_\\infty) \\left(1 - e^{-rt}(\\cos(ft) - i\\sin(ft))\\right)\n$$\n$$\nW(t) = (U_\\infty + iV_\\infty) \\left( (1 - e^{-rt}\\cos(ft)) + i(e^{-rt}\\sin(ft)) \\right)\n$$\n为了求得 $u(t) = \\text{Re}[W(t)]$ 和 $v(t) = \\text{Im}[W(t)]$，我们将复数相乘：\n$$\nu(t) = U_\\infty(1 - e^{-rt}\\cos(ft)) - V_\\infty(e^{-rt}\\sin(ft))\n$$\n$$\nv(t) = V_\\infty(1 - e^{-rt}\\cos(ft)) + U_\\infty(e^{-rt}\\sin(ft))\n$$\n这些表达式可以重新排列，以突出解的结构，即一个稳态分量和一个瞬态的、衰减的惯性振荡：\n$$\nu(t) = U_\\infty - e^{-rt} (U_\\infty \\cos(ft) + V_\\infty \\sin(ft))\n$$\n$$\nv(t) = V_\\infty - e^{-rt} (V_\\infty \\cos(ft) - U_\\infty \\sin(ft))\n$$\n这些是速度分量 $u(t)$ 和 $v(t)$ 的最终显式数学表达式。请注意，这些公式对所有给定的测试用例都有效，包括 $r=0$ 的情况（前提是 $f \\neq 0$，这对所有案例都成立）。\n\n**算法设计**\n计算 $(u(t), v(t))$ 的算法是所推导公式的直接实现：\n1.  对于给定的一组参数 $(\\rho, h, f, r, \\tau_x, \\tau_y, t)$:\n2.  计算分母项 $D = \\rho h (r^2 + f^2)$。对于所有测试用例，该项均不为零。\n3.  计算稳态速度分量 $U_\\infty$ 和 $V_\\infty$：\n    - $U_\\infty = (r\\tau_x + f\\tau_y) / D$\n    - $V_\\infty = (r\\tau_y - f\\tau_x) / D$\n4.  计算时变项：\n    - 指数衰减： $E = e^{-rt}$\n    - 振荡项： $C_f = \\cos(ft)$, $S_f = \\sin(ft)$\n5.  组合这些项以求得最终速度 $u(t)$ 和 $v(t)$：\n    - $u(t) = U_\\infty - E (U_\\infty C_f + V_\\infty S_f)$\n    - $v(t) = V_\\infty - E (V_\\infty C_f - U_\\infty S_f)$\n6.  按要求将计算出的 $u(t)$ 和 $v(t)$ 四舍五入到6位小数。\n\n此算法将用 Python 为每个提供的测试用例实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the velocity of an oceanic mixed layer for a series of test cases.\n    \"\"\"\n\n    # Test suite: (rho, h, f, r, tau_x, tau_y, t)\n    # Units: kg m^-3, m, s^-1, s^-1, N m^-2, N m^-2, s\n    test_cases = [\n        # Case 1: Northern Hemisphere, moderate damping, zonal wind\n        (1025.0, 50.0, 1e-4, 2e-5, 0.1, 0.0, 172800.0),\n        # Case 2: Southern Hemisphere, moderate damping, zonal wind\n        (1025.0, 50.0, -1e-4, 2e-5, 0.1, 0.0, 172800.0),\n        # Case 3: No damping, half inertial period after onset\n        (1025.0, 50.0, 1e-4, 0.0, 0.1, 0.0, np.pi / 1e-4),\n        # Case 4: Strong damping, long time\n        (1025.0, 50.0, 1e-4, 2e-4, 0.1, 0.0, 432000.0),\n        # Case 5: Zero wind stress\n        (1025.0, 50.0, 1e-4, 2e-5, 0.0, 0.0, 100000.0),\n        # Case 6: Oblique wind, weak damping, mid-latitude f\n        (1025.0, 30.0, 7.5e-5, 1e-5, 0.1, 0.1, 86400.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho, h, f, r, tau_x, tau_y, t = case\n\n        # The analytical solution for the velocity components (u(t), v(t)) is derived\n        # from the complex velocity W(t) = u(t) + i*v(t), which follows:\n        # dW/dt + (r + i*f)W = (tau_x + i*tau_y) / (rho*h)\n        # The solution with initial condition W(0) = 0 is:\n        # W(t) = W_inf * (1 - exp(-(r + i*f)*t))\n        # where W_inf = U_inf + i*V_inf is the steady-state solution.\n        \n        # Denominator for steady-state solution\n        # This is guaranteed to be non-zero for all test cases.\n        den = rho * h * (r**2 + f**2)\n\n        # Steady-state velocity components (U_inf, V_inf)\n        U_inf = (r * tau_x + f * tau_y) / den\n        V_inf = (r * tau_y - f * tau_x) / den\n\n        # Time-dependent terms\n        exp_term = np.exp(-r * t)\n        cos_ft = np.cos(f * t)\n        sin_ft = np.sin(f * t)\n        \n        # Full time-dependent solution for u(t) and v(t)\n        # u(t) = U_inf - exp(-r*t) * (U_inf * cos(f*t) + V_inf * sin(f*t))\n        # v(t) = V_inf - exp(-r*t) * (V_inf * cos(f*t) - U_inf * sin(f*t))\n        u = U_inf - exp_term * (U_inf * cos_ft + V_inf * sin_ft)\n        v = V_inf - exp_term * (V_inf * cos_ft - U_inf * sin_ft)\n\n        # Round results to 6 decimal places as required\n        u_rounded = round(u, 6)\n        v_rounded = round(v, 6)\n        \n        results.append(f\"[{u_rounded},{v_rounded}]\")\n\n    # Format the final output string to match the required format: [[u1,v1],[u2,v2],...]\n    output_string = f\"[{','.join(results)}]\"\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "太阳辐射的垂直分布是海洋热结构的主要驱动力，也是混合层模型中的一个关键强迫项。能量的吸收方式很大程度上取决于水的清澈度。本练习将重点应用比尔-朗伯定律到一个常见的双波段短波辐射模型中。通过比较清澈和混浊水体的情况，你将量化光学特性如何控制上层海洋的加热廓线，这对物理和生物海洋模型都至关重要。",
            "id": "3901342",
            "problem": "一个海洋混合层模型将紧邻海洋表面下方的向下净短波辐照度（表示为 $Q_{\\mathrm{sw},0}$）划分为两个光谱带，这两个光谱带均遵循比尔-朗伯指数衰减定律。在一个水平均一、时间上稳定、没有内部短波源且内部反射可忽略不计的平面平行海洋水柱中，假设以下基本定律和定义：\n- 对于每个光谱带 $i \\in \\{1,2\\}$，向下辐照度 $I_{i}(z)$ 满足比尔-朗伯定律 $\\,\\mathrm{d}I_{i}/\\mathrm{d}z = -\\kappa_{i} I_{i}\\,$，其解为 $I_{i}(z) = I_{i}(0)\\,\\exp(-z/\\lambda_{i})$，其中 $\\lambda_{i} = 1/\\kappa_{i}$ 是与波段相关的衰减深度。\n- 在表面的波段划分为 $I_{1}(0) = a\\,Q_{\\mathrm{sw},0}$ 和 $I_{2}(0) = (1-a)\\,Q_{\\mathrm{sw},0}$，其中 $a \\in (0,1)$。\n\n设混合层深度为 $H$。在混合层内被吸收的 $Q_{\\mathrm{sw},0}$ 的分数定义为在 $z=0$ 和 $z=H$ 之间吸收的净短波能量与 $Q_{\\mathrm{sw},0}$ 的比值。\n\n考虑两种水体类型，每种类型由一对不同的衰减深度表示，同时保持相同的波段划分：\n- 清澈的开阔大洋水体：$a = 0.6$，$\\lambda_{1} = 20\\,\\mathrm{m}$，$\\lambda_{2} = 0.5\\,\\mathrm{m}$。\n- 浑浊的近岸水体：$a = 0.6$，$\\lambda_{1} = 6\\,\\mathrm{m}$，$\\lambda_{2} = 0.5\\,\\mathrm{m}$。\n\n仅使用上述原理，推导出用 $a$、$\\lambda_{1}$、$\\lambda_{2}$ 和 $H$ 表示的吸收分数的表达式，然后对两种水体类型，计算当 $H = 40\\,\\mathrm{m}$ 时的值，最后计算差值 $\\Delta F = F_{\\mathrm{turbid}} - F_{\\mathrm{clear}}$。\n\n将最终答案表示为一个无量纲的小数，并四舍五入到四位有效数字。不要使用百分号。",
            "solution": "其物理基础是在没有内部源的均质介质中向下辐照度衰减的比尔-朗伯定律。对于波段 $i \\in \\{1,2\\}$，其衰减深度为 $\\lambda_{i}$，表面值为 $I_{i}(0)$，解为\n$$\nI_{i}(z) = I_{i}(0)\\,\\exp\\!\\left(-\\frac{z}{\\lambda_{i}}\\right).\n$$\n在一个无穷小层中的体积吸收是向下辐照度的负垂直散度，对于一维水柱，这等于 $-\\mathrm{d}I/\\mathrm{d}z$。因此，在 $z=0$ 和 $z=H$ 之间，每个波段 $i$ 总吸收的短波能量为\n$$\nA_{i}(0,H) = \\int_{0}^{H}\\left(-\\frac{\\mathrm{d}I_{i}}{\\mathrm{d}z}\\right)\\,\\mathrm{d}z = I_{i}(0) - I_{i}(H) = I_{i}(0)\\left[1 - \\exp\\!\\left(-\\frac{H}{\\lambda_{i}}\\right)\\right].\n$$\n对两个波段求和并用 $Q_{\\mathrm{sw},0}$ 进行归一化，得到混合层内的吸收分数：\n$$\nF(H) \\equiv \\frac{A_{1}(0,H) + A_{2}(0,H)}{Q_{\\mathrm{sw},0}} \n= \\frac{I_{1}(0)\\left[1 - \\exp\\!\\left(-\\frac{H}{\\lambda_{1}}\\right)\\right] + I_{2}(0)\\left[1 - \\exp\\!\\left(-\\frac{H}{\\lambda_{2}}\\right)\\right]}{Q_{\\mathrm{sw},0}}.\n$$\n使用 $I_{1}(0) = a\\,Q_{\\mathrm{sw},0}$ 和 $I_{2}(0) = (1-a)\\,Q_{\\mathrm{sw},0}$ 得出\n$$\nF(H) = a\\left[1 - \\exp\\!\\left(-\\frac{H}{\\lambda_{1}}\\right)\\right] + (1-a)\\left[1 - \\exp\\!\\left(-\\frac{H}{\\lambda_{2}}\\right)\\right].\n$$\n这可以等价地写为\n$$\nF(H) = 1 - \\left[a\\,\\exp\\!\\left(-\\frac{H}{\\lambda_{1}}\\right) + (1-a)\\,\\exp\\!\\left(-\\frac{H}{\\lambda_{2}}\\right)\\right].\n$$\n\n现在我们计算 $H = 40\\,\\mathrm{m}$ 时的值。\n\n清澈的开阔大洋水体有 $a = 0.6$，$\\lambda_{1} = 20\\,\\mathrm{m}$，$\\lambda_{2} = 0.5\\,\\mathrm{m}$。因此\n$$\nF_{\\mathrm{clear}} = 1 - \\left[0.6\\,\\exp\\!\\left(-\\frac{40}{20}\\right) + 0.4\\,\\exp\\!\\left(-\\frac{40}{0.5}\\right)\\right] \n= 1 - \\left[0.6\\,\\exp(-2) + 0.4\\,\\exp(-80)\\right].\n$$\n数值上，$\\exp(-2)$ 约等于 $0.1353352832$，而 $\\exp(-80)$ 约等于 $1.804851\\times 10^{-35}$，所以\n$$\nF_{\\mathrm{clear}} \\approx 1 - \\left[0.6 \\times 0.1353352832 + 0.4 \\times 1.804851\\times 10^{-35}\\right] \n\\approx 1 - 0.0812011699 \\approx 0.9187988301.\n$$\n\n浑浊的近岸水体有 $a = 0.6$，$\\lambda_{1} = 6\\,\\mathrm{m}$，$\\lambda_{2} = 0.5\\,\\mathrm{m}$。因此\n$$\nF_{\\mathrm{turbid}} = 1 - \\left[0.6\\,\\exp\\!\\left(-\\frac{40}{6}\\right) + 0.4\\,\\exp\\!\\left(-\\frac{40}{0.5}\\right)\\right] \n= 1 - \\left[0.6\\,\\exp\\!\\left(-\\frac{20}{3}\\right) + 0.4\\,\\exp(-80)\\right].\n$$\n数值上，$\\exp(-20/3)$ 约等于 $0.00127263380134$，而 $\\exp(-80)$ 同样可以忽略不计，所以\n$$\nF_{\\mathrm{turbid}} \\approx 1 - \\left[0.6 \\times 0.00127263380134\\right] \\approx 1 - 0.000763580280804 \\approx 0.9992364197.\n$$\n\n所求的差值为\n$$\n\\Delta F = F_{\\mathrm{turbid}} - F_{\\mathrm{clear}} \\approx 0.9992364197 - 0.9187988301 \\approx 0.0804375896.\n$$\n四舍五入到四位有效数字得出\n$$\n\\Delta F \\approx 0.08044.\n$$\n这个无量纲数表示，在所述的双波段比尔-朗伯模型下，浑浊近岸水体相对于清澈开阔大洋水体，在 $H = 40\\,\\mathrm{m}$ 深度内额外吸收的 $Q_{\\mathrm{sw},0}$ 的分数。",
            "answer": "$$\\boxed{0.08044}$$"
        },
        {
            "introduction": "要理解混合层温度的演变，就需要厘清所有热量的源和汇。在实践中，我们常常利用观测数据来构建热量收支，并推断那些难以直接测量的过程，例如湍流混合。本练习将让你扮演数据分析师的角色，利用一组给定的“观测数据”来闭合混合层的热量收支。通过计算残差，你将量化未解析的湍流过程的贡献，并估算出一个关键参数——涡动扩散系数$K_v$。这种做法对于诊断海洋模型的性能和解释实地数据至关重要。",
            "id": "3901401",
            "problem": "构建一个程序，根据观测和估算的海洋混合层深度 (MLD) 的量值，建立垂直积分的混合层温度收支，并以残差形式推断未解析的湍流混合的贡献。程序必须接着通过假设在混合层与下方层化海洋之间的界面上的垂直湍流热通量满足菲克闭合（Fickian closure），来估算混合层底部的隐含涡动扩散系数。推导必须从一个厚度等于混合层深度 (MLD) 的控制体积的热量守恒定律开始，并假设混合层内的海水密度和比热容为常数。程序必须使用以下基于物理的项来实现收支计算：净表面热通量、混合层温度的水平平流、跨越混合层底部的夹卷，以及一个被解释为跨越底部的净湍流混合贡献的残差项。程序必须为每个测试用例计算两个输出：以温度单位表示的残差湍流混合趋势，以及混合层底部的隐含涡动扩散系数。\n\n在你的程序中使用以下物理常数：海水密度 $\\rho = 1025\\,\\mathrm{kg/m^3}$ 和比热容 $c_p = 3990\\,\\mathrm{J/(kg\\cdot K)}$。\n\n模型假设与定义：\n- 令 $h$ 表示混合层深度 (MLD)，单位为 $\\mathrm{m}$；$T_m$ 表示水平平均的混合层温度，单位为 $\\mathrm{K}$。\n- 令 $Q_{net}$ 表示净表面热通量，单位为 $\\mathrm{W/m^2}$，定义向下进入海洋为正。\n- 令 $\\mathbf{u} = (u_x,u_y)$ 表示混合层中的水平流速，单位为 $\\mathrm{m/s}$；$\\nabla T_m = (\\partial T_m/\\partial x,\\partial T_m/\\partial y)$ 表示水平温度梯度，单位为 $\\mathrm{K/m}$。水平平流趋势由 $-\\mathbf{u}\\cdot\\nabla T_m$ 表示，单位为 $\\mathrm{K/s}$。\n- 令 $w_e$ 表示混合层底部的夹卷速度，单位为 $\\mathrm{m/s}$，定义当混合层向下方较冷的层化层加深时为正。夹卷趋势由 $(w_e/h)(T_b - T_m)$ 表示，单位为 $\\mathrm{K/s}$，其中 $T_b$ 是混合层底部正下方的温度，单位为 $\\mathrm{K}$。\n- 残差湍流混合趋势 $M$ (单位 $\\mathrm{K/s}$) 定义为 $\\mathrm{d}T_m/\\mathrm{d}t$ 中无法由明确表示的收支项之和解释的分量。\n- 假设跨越混合层底部进入混合层的净湍流热通量可以由菲克闭合 $F_b = -\\rho c_p K_v \\partial T/\\partial z\\big|_{z=-h}$ 表示，其中 $K_v$ 是涡动扩散系数，单位为 $\\mathrm{m^2/s}$，$z$是垂直坐标，向上为正，并且 $\\partial T/\\partial z\\big|_{z=-h}$ 近似为 $(T_m - T_b)/\\delta$，其中 $\\delta$ 是界面厚度，单位为 $\\mathrm{m}$。\n\n你的程序必须为每个测试用例计算：\n1. 从温度收支中推断出的残差湍流混合趋势 $M$，单位为 $\\mathrm{K/s}$。\n2. 在上述闭合假设下，混合层底部的隐含涡动扩散系数 $K_v$，单位为 $\\mathrm{m^2/s}$。\n\n要求单位：\n- 所有输入量必须以其给定的物理单位进行解释。\n- 输出 $M$ 必须以 $\\mathrm{K/s}$ 表示。\n- 输出 $K_v$ 必须以 $\\mathrm{m^2/s}$ 表示。\n\n测试套件：\n为以下参数集提供结果，每个参数集指定为一个元组 $(h, \\mathrm{d}T_m/\\mathrm{d}t, Q_{net}, u_x, u_y, \\partial T_m/\\partial x, \\partial T_m/\\partial y, w_e, T_m, T_b, \\delta)$，单位如上定义。\n- 用例 1（夏季普遍情况，弱冷却）：$(h=25\\,\\mathrm{m},\\ \\mathrm{d}T_m/\\mathrm{d}t=-1.35\\times 10^{-6}\\,\\mathrm{K/s},\\ Q_{net}=150\\,\\mathrm{W/m^2},\\ u_x=0.15\\,\\mathrm{m/s},\\ u_y=0.05\\,\\mathrm{m/s},\\ \\partial T_m/\\partial x=2\\times 10^{-5}\\,\\mathrm{K/m},\\ \\partial T_m/\\partial y=-1\\times 10^{-5}\\,\\mathrm{K/m},\\ w_e=8\\times 10^{-6}\\,\\mathrm{m/s},\\ T_m=293.5\\,\\mathrm{K},\\ T_b=292.8\\,\\mathrm{K},\\ \\delta=2.0\\,\\mathrm{m})$。\n- 用例 2（仅夹卷冷却，无表面通量或平流）：$(h=50\\,\\mathrm{m},\\ \\mathrm{d}T_m/\\mathrm{d}t=-1.0\\times 10^{-7}\\,\\mathrm{K/s},\\ Q_{net}=0\\,\\mathrm{W/m^2},\\ u_x=0.0\\,\\mathrm{m/s},\\ u_y=0.0\\,\\mathrm{m/s},\\ \\partial T_m/\\partial x=1\\times 10^{-5}\\,\\mathrm{K/m},\\ \\partial T_m/\\partial y=1\\times 10^{-5}\\,\\mathrm{K/m},\\ w_e=1.0\\times 10^{-5}\\,\\mathrm{m/s},\\ T_m=291.0\\,\\mathrm{K},\\ T_b=290.5\\,\\mathrm{K},\\ \\delta=1.0\\,\\mathrm{m})$。\n- 用例 3（浅混合层，强表面冷却、增温平流和浅化）：$(h=15\\,\\mathrm{m},\\ \\mathrm{d}T_m/\\mathrm{d}t=-1.5\\times 10^{-6}\\,\\mathrm{K/s},\\ Q_{net}=-200\\,\\mathrm{W/m^2},\\ u_x=0.05\\,\\mathrm{m/s},\\ u_y=-0.03\\,\\mathrm{m/s},\\ \\partial T_m/\\partial x=-3\\times 10^{-5}\\,\\mathrm{K/m},\\ \\partial T_m/\\partial y=2\\times 10^{-5}\\,\\mathrm{K/m},\\ w_e=-5\\times 10^{-6}\\,\\mathrm{m/s},\\ T_m=296.0\\,\\mathrm{K},\\ T_b=295.0\\,\\mathrm{K},\\ \\delta=1.5\\,\\mathrm{m})$。\n\n最终输出格式：\n你的程序应生成单行输出，包含一个以逗号分隔的列表的列表，每个内部列表包含两个浮点数 $[M, K_v]$，按上述测试套件的顺序排列，并用方括号括起来。例如：$[[M_1,K_{v,1}],[M_2,K_{v,2}],[M_3,K_{v,3}]]$。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确、客观，并且包含了推导出唯一解所需的所有必要信息。它代表了海洋物理学中关于混合层热量收支的一个标准练习。\n\n解答源于将热量守恒原理应用于海洋混合层的板模型。该模型假设在层化海洋之上有一层温度均匀为 $T_m$、厚度为 $h$ 的水层。混合层总温度变化率 $\\mathrm{d}T_m/\\mathrm{d}t$ 由向该层增加或移除热量的几个物理过程的总和决定。控制收支方程为：\n\n$$\n\\frac{\\mathrm{d}T_m}{\\mathrm{d}t} = (\\text{表面加热}) + (\\text{水平平流}) + (\\text{夹卷}) + (\\text{残差混合})\n$$\n\n每一项都代表一个以 $\\mathrm{K/s}$ 为单位的温度趋势。我们将根据问题的定义和物理原理来构建每一项。\n\n1.  **表面加热趋势**：净表面热通量 $Q_{net}$ (单位 $\\mathrm{W/m^2}$ 或 $\\mathrm{J/s \\cdot m^2}$) 被一个高度为 $h$ 的水柱所吸收。该水柱单位面积的热容量为 $\\rho c_p h$ (单位 $\\mathrm{J/m^2 \\cdot K}$)，其中 $\\rho$ 是海水密度，$c_p$ 是比热容。因此，由表面通量引起的温度趋势为：\n    $$\n    \\text{表面加热} = \\frac{Q_{net}}{\\rho c_p h}\n    $$\n\n2.  **水平平流趋势**：该项表示由于具有不同温度的海水水平移入目标区域而引起的温度变化。它由速度矢量 $\\mathbf{u}$ 和温度梯度矢量 $\\nabla T_m$ 的点积给出。根据问题的定义：\n    $$\n    \\text{水平平流} = -\\mathbf{u} \\cdot \\nabla T_m = -(u_x \\frac{\\partial T_m}{\\partial x} + u_y \\frac{\\partial T_m}{\\partial y})\n    $$\n\n3.  **夹卷趋势**：该项说明了由混合层加深或变浅引起的温度变化。当混合层加深（$w_e  0$）时，它会从下方的温跃层夹卷较冷的海水。问题明确地将此趋势定义为：\n    $$\n    \\text{Entrainment} = \\frac{w_e}{h}(T_b - T_m)\n    $$\n    其中 $T_b$ 是混合层底部正下方的温度。此公式适用于加深（$w_e  0$）和变浅（$w_e  0$）两种情况。\n\n4.  **残差混合趋势 ($M$)**：该项 $M$ 代表所有其他未解析的过程，这些过程被解释为跨越混合层底部的湍流混合效应。它作为闭合热量收支所需的残差来計算。\n\n结合这些项，完整的收支方程为：\n$$\n\\frac{\\mathrm{d}T_m}{\\mathrm{d}t} = \\frac{Q_{net}}{\\rho c_p h} - (u_x \\frac{\\partial T_m}{\\partial x} + u_y \\frac{\\partial T_m}{\\partial y}) + \\frac{w_e}{h}(T_b - T_m) + M\n$$\n\n为了找到第一个要求的输出，我们重排此方程以求解 $M$：\n$$\nM = \\frac{\\mathrm{d}T_m}{\\mathrm{d}t} - \\frac{Q_{net}}{\\rho c_p h} + (u_x \\frac{\\partial T_m}{\\partial x} + u_y \\frac{\\partial T_m}{\\partial y}) - \\frac{w_e}{h}(T_b - T_m)\n$$\n\n问题的第二部分是从这个残差趋势中推断出涡动扩散系数 $K_v$。假设趋势 $M$ 是由混合层底部（$z=-h$）的净垂直湍流热通量 $F_b$ 引起的。边界上的通量与层内产生的温度趋势之间的关系是：\n$$\nM = \\frac{F_b}{\\rho c_p h}\n$$\n问题为该通量指定了一个菲克闭合，该闭合表明通量与局部温度梯度成正比：\n$$\nF_b = -\\rho c_p K_v \\frac{\\partial T}{\\partial z}\\bigg|_{z=-h}\n$$\n界面处的垂直温度梯度近似为：\n$$\n\\frac{\\partial T}{\\partial z}\\bigg|_{z=-h} \\approx \\frac{T_m - T_b}{\\delta}\n$$\n其中 $\\delta$ 是界面的厚度。\n\n将通量闭合和梯度近似代入 $M$ 的方程中：\n$$\nM = \\frac{1}{\\rho c_p h} \\left( -\\rho c_p K_v \\frac{T_m - T_b}{\\delta} \\right) = -K_v \\frac{T_m - T_b}{h \\delta}\n$$\n为了找到第二个要求的输出，我们求解 $K_v$：\n$$\nK_v = - M \\frac{h \\delta}{T_m - T_b}\n$$\n一个具有物理意义的扩散系数 $K_v$ 必须为非负值。由于 $h0$、$\\delta0$ 且通常 $T_m  T_b$，这要求残差趋势 $M$ 为非正值（$M \\le 0$）。负的 $M$ 对应于混合层因与下方较冷海水发生湍流混合而冷却，这在物理上是符合预期的。一个计算出的正 $M$ 将意味着一个不符合物理的负 $K_v$，表明模型和数据与简单的顺梯度湍流热通量不一致。程序将根据公式计算 $K_v$ 的值，无论其正负。\n\n提供的常数是 $\\rho = 1025\\,\\mathrm{kg/m^3}$ 和 $c_p = 3990\\,\\mathrm{J/(kg\\cdot K)}$。这些值以及推导出的 $M$ 和 $K_v$ 的方程将在程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the residual turbulent mixing tendency and implied eddy diffusivity\n    for the oceanic mixed layer based on a heat budget.\n    \"\"\"\n    \n    # Physical constants\n    RHO = 1025.0  # Seawater density in kg/m^3\n    CP = 3990.0   # Specific heat capacity of seawater in J/(kg*K)\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (h, dTm/dt, Qnet, ux, uy, dTm/dx, dTm/dy, we, Tm, Tb, delta)\n    test_cases = [\n        # Case 1: General summer conditions with weak cooling\n        (25.0, -1.35e-6, 150.0, 0.15, 0.05, 2.0e-5, -1.0e-5, 8.0e-6, 293.5, 292.8, 2.0),\n        # Case 2: Entrainment-only cooling, no surface flux or advection\n        (50.0, -1.0e-7, 0.0, 0.0, 0.0, 1.0e-5, 1.0e-5, 1.0e-5, 291.0, 290.5, 1.0),\n        # Case 3: Shallow mixed layer with strong surface cooling, warming advection, and shoaling\n        (15.0, -1.5e-6, -200.0, 0.05, -0.03, -3.0e-5, 2.0e-5, -5.0e-6, 296.0, 295.0, 1.5)\n    ]\n\n    results = []\n    for case in test_cases:\n        h, dTm_dt, Q_net, u_x, u_y, dT_dx, dT_dy, w_e, T_m, T_b, delta = case\n\n        # 1. Calculate the tendency terms for the heat budget.\n        # The total budget is: dTm/dt = S + A + E + M\n        # where S is surface flux, A is advection, E is entrainment, M is residual mixing.\n        \n        # Surface heating tendency (K/s)\n        # S = Q_net / (rho * cp * h)\n        surface_flux_tendency = Q_net / (RHO * CP * h)\n\n        # Horizontal advection tendency (K/s)\n        # A = - (u_x * dT_dx + u_y * dT_dy)\n        advection_tendency = - (u_x * dT_dx + u_y * dT_dy)\n\n        # Entrainment tendency (K/s)\n        # E = (w_e / h) * (T_b - T_m)\n        if h == 0:\n            entrainment_tendency = 0.0\n        else:\n            entrainment_tendency = (w_e / h) * (T_b - T_m)\n\n        # 2. Calculate the residual turbulent mixing tendency M (K/s)\n        # M = dTm/dt - S - A - E\n        M = dTm_dt - surface_flux_tendency - advection_tendency - entrainment_tendency\n        \n        # 3. Calculate the implied eddy diffusivity Kv (m^2/s)\n        # M = -Kv * (Tm - Tb) / (h * delta) => Kv = -M * h * delta / (Tm - Tb)\n        temp_diff = T_m - T_b\n        if temp_diff == 0:\n            # If M is non-zero, Kv is infinite. If M is zero, Kv is indeterminate.\n            # In either case, represents a pathological condition.\n            if M == 0:\n                K_v = 0.0 # Indeterminate, but 0 is a reasonable default\n            else:\n                K_v = np.inf\n        else:\n            K_v = -M * h * delta / temp_diff\n            \n        results.append([M, K_v])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list is used.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}