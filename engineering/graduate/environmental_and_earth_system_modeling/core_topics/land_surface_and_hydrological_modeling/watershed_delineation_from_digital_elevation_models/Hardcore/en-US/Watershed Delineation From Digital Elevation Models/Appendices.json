{
    "hands_on_practices": [
        {
            "introduction": "The foundation of all DEM-based hydrological modeling is the flow direction algorithm, which determines the path water will take across the landscape. This first practice exercise takes you back to basics, applying the classic eight-direction (D8) algorithm to a small grid of elevation data . By manually calculating the steepest downslope path for each cell, you will gain a concrete understanding of how planimetric distance and elevation drop combine to define flow and will encounter the common issue of tie-cases, which require explicit rules in real-world software.",
            "id": "3930970",
            "problem": "Consider a square raster Digital Elevation Model (DEM) patch of size $3 \\times 3$ cells with uniform cell width $L$ and elevations given (in meters above a datum) by the following matrix, where the center cell is at row $2$, column $2$:\n$$\n\\begin{pmatrix}\n90 & 95 & 90 \\\\\n95 & 100 & 95 \\\\\n92 & 95 & 92\n\\end{pmatrix}.\n$$\nAssume $L = 30\\,\\mathrm{m}$, and that planimetric neighbor distances are $d_{\\text{cardinal}} = L$ for cardinal neighbors and $d_{\\text{diagonal}} = \\sqrt{2}\\,L$ for diagonal neighbors. Use the eight-direction (D8) algorithm, defined as follows: for a cell $i$ with elevation $z_i$, the candidate downslope direction to a neighbor $j$ is chosen by maximizing the local slope\n$$\ns_{i \\to j} = \\frac{z_i - z_j}{d_{ij}},\n$$\nover all neighboring cells $j$ within the DEM patch, subject to $z_i \\ge z_j$ (downslope or flat). If $s_{i \\to j} = 0$ for all neighbors $j$ or $z_i < z_j$ for all neighbors $j$, the cell is a pit or flat and has no unique downslope direction without depression-handling. A tie case is defined as the occurrence of two or more distinct neighbors $j$ with exactly equal maximal $s_{i \\to j}$ among the admissible neighbors.\n\nApply the above definition to compute the D8 flow directions for the center cell and each of its $8$ neighbors, restricting attention to neighbors that lie within the $3 \\times 3$ patch (ignore any out-of-patch cells). Then, identify and count the number of tie cases that require explicit resolution among these $9$ cells. Report as your final answer the total number of tie cases in the patch. Express your final answer as an integer; no rounding is required.",
            "solution": "### Step 1: Extract Givens\n- A $3 \\times 3$ square raster Digital Elevation Model (DEM).\n- Cell width $L = 30\\,\\mathrm{m}$.\n- Elevation matrix $Z$:\n$$\nZ = \\begin{pmatrix}\n90 & 95 & 90 \\\\\n95 & 100 & 95 \\\\\n92 & 95 & 92\n\\end{pmatrix}\n$$\n- Planimetric neighbor distances: $d_{\\text{cardinal}} = L$ and $d_{\\text{diagonal}} = \\sqrt{2}\\,L$.\n- D8 algorithm rule: choose the downslope direction to a neighbor $j$ from a cell $i$ by maximizing the slope $s_{i \\to j} = \\frac{z_i - z_j}{d_{ij}}$, subject to the condition that flow is downslope or flat, i.e., $z_i \\ge z_j$.\n- Definition of a pit or flat: a cell where $s_{i \\to j} = 0$ for all neighbors $j$ or $z_i < z_j$ for all neighbors $j$.\n- Definition of a tie case: Two or more distinct neighbors $j$ have the same maximal slope $s_{i \\to j}$ among all admissible neighbors.\n- Task: Compute flow directions for all $9$ cells, considering only neighbors within the $3 \\times 3$ patch, and count the total number of tie cases.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the D8 flow direction algorithm, a fundamental and widely used method in hydrology and geographic information science (GIS) for modeling surface water flow from DEMs. The setup is a standard, textbook-style exercise. The principles are scientifically sound.\n- **Well-Posed**: The problem is self-contained. It provides all necessary data (elevation grid, cell size, distance definitions) and a precise, unambiguous algorithm for determining flow direction and identifying ties. The boundary condition (restricting neighbors to within the patch) is clearly stated. A unique integer solution exists.\n- **Objective**: The problem is stated in precise, quantitative, and objective language, free of any subjective or speculative content.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, and objective. There are no identifiable flaws. A solution will be derived.\n\nThe solution proceeds by systematically analyzing each of the $9$ cells in the DEM patch. Let a cell be denoted by its row and column index $(r, c)$, and its elevation by $z_{rc}$. The cell width is $L = 30\\,\\mathrm{m}$. The slope to a neighbor is given by $s = \\frac{\\Delta z}{d}$, where $\\Delta z$ is the elevation drop and $d$ is the distance. For cardinal neighbors, $d=L$. For diagonal neighbors, $d=\\sqrt{2}L$. We seek to maximize this slope for each cell, considering only neighbors with $z_j \\le z_i$.\n\nLet us analyze each cell:\n\n**Cell (1,1): $z_{11} = 90$**\nNeighbors within the patch are $(1,2)$, $(2,1)$, and $(2,2)$, with elevations $z_{12}=95$, $z_{21}=95$, and $z_{22}=100$. All neighbors have a higher elevation ($z_j > z_{11}$). According to the problem definition, this cell is a pit. There are no admissible downslope or flat neighbors, so a tie case is not possible.\nNumber of tie cases for $(1,1)$: $0$.\n\n**Cell (1,2): $z_{12} = 95$**\nAdmissible neighbors $j$ (where $z_j \\le 95$) are:\n- $(1,1)$: $z_{11}=90$. Cardinal. $s_{12 \\to 11} = \\frac{95 - 90}{L} = \\frac{5}{L}$.\n- $(1,3)$: $z_{13}=90$. Cardinal. $s_{12 \\to 13} = \\frac{95 - 90}{L} = \\frac{5}{L}$.\n- $(2,1)$: $z_{21}=95$. Diagonal. $s_{12 \\to 21} = \\frac{95 - 95}{\\sqrt{2}L} = 0$.\n- $(2,3)$: $z_{23}=95$. Diagonal. $s_{12 \\to 23} = \\frac{95 - 95}{\\sqrt{2}L} = 0$.\nThe maximum slope is $\\frac{5}{L}$. This slope occurs for two distinct neighbors: $(1,1)$ and $(1,3)$. This constitutes a tie case.\nNumber of tie cases for $(1,2)$: $1$.\n\n**Cell (1,3): $z_{13} = 90$**\nNeighbors within the patch are $(1,2)$, $(2,2)$, and $(2,3)$, with elevations $z_{12}=95$, $z_{22}=100$, and $z_{23}=95$. All neighbors are higher. This is a pit.\nNumber of tie cases for $(1,3)$: $0$.\n\n**Cell (2,1): $z_{21} = 95$**\nAdmissible neighbors $j$ (where $z_j \\le 95$) are:\n- $(1,1)$: $z_{11}=90$. Cardinal. $s_{21 \\to 11} = \\frac{95 - 90}{L} = \\frac{5}{L}$.\n- $(3,1)$: $z_{31}=92$. Cardinal. $s_{21 \\to 31} = \\frac{95 - 92}{L} = \\frac{3}{L}$.\n- $(1,2)$: $z_{12}=95$. Diagonal. $s_{21 \\to 12} = \\frac{95 - 95}{\\sqrt{2}L} = 0$.\n- $(3,2)$: $z_{32}=95$. Diagonal. $s_{21 \\to 32} = \\frac{95 - 95}{\\sqrt{2}L} = 0$.\nThe maximum slope is $\\frac{5}{L}$, which corresponds to a unique neighbor, $(1,1)$. No tie case occurs.\nNumber of tie cases for $(2,1)$: $0$.\n\n**Cell (2,2): $z_{22} = 100$**\nAll $8$ neighbors are at lower elevations and are thus admissible.\n- Cardinal neighbors ($d=L$): $(1,2)$, $(2,1)$, $(2,3)$, $(3,2)$. All have $z=95$. The slope is $s = \\frac{100 - 95}{L} = \\frac{5}{L}$ for all four.\n- Diagonal neighbors ($d=\\sqrt{2}L$):\n  - $(1,1)$, $z_{11}=90$: $s = \\frac{100 - 90}{\\sqrt{2}L} = \\frac{10}{\\sqrt{2}L} = \\frac{5\\sqrt{2}}{L}$.\n  - $(1,3)$, $z_{13}=90$: $s = \\frac{100 - 90}{\\sqrt{2}L} = \\frac{10}{\\sqrt{2}L} = \\frac{5\\sqrt{2}}{L}$.\n  - $(3,1)$, $z_{31}=92$: $s = \\frac{100 - 92}{\\sqrt{2}L} = \\frac{8}{\\sqrt{2}L} = \\frac{4\\sqrt{2}}{L}$.\n  - $(3,3)$, $z_{33}=92$: $s = \\frac{100 - 92}{\\sqrt{2}L} = \\frac{8}{\\sqrt{2}L} = \\frac{4\\sqrt{2}}{L}$.\nTo compare the slopes, we compare the values $\\frac{5}{L}$, $\\frac{5\\sqrt{2}}{L}$, and $\\frac{4\\sqrt{2}}{L}$. Since $\\sqrt{2} \\approx 1.414$, we have $5\\sqrt{2} \\approx 7.07$ and $4\\sqrt{2} \\approx 5.66$. The maximum slope is $\\frac{5\\sqrt{2}}{L}$. This slope occurs for two distinct neighbors: $(1,1)$ and $(1,3)$. This is a tie case.\nNumber of tie cases for $(2,2)$: $1$.\n\n**Cell (2,3): $z_{23} = 95$**\nAdmissible neighbors $j$ (where $z_j \\le 95$) are:\n- $(1,3)$: $z_{13}=90$. Cardinal. $s_{23 \\to 13} = \\frac{95 - 90}{L} = \\frac{5}{L}$.\n- $(3,3)$: $z_{33}=92$. Cardinal. $s_{23 \\to 33} = \\frac{95 - 92}{L} = \\frac{3}{L}$.\n- $(1,2)$: $z_{12}=95$. Diagonal. $s_{23 \\to 12} = \\frac{95 - 95}{\\sqrt{2}L} = 0$.\n- $(3,2)$: $z_{32}=95$. Diagonal. $s_{23 \\to 32} = \\frac{95 - 95}{\\sqrt{2}L} = 0$.\nThe maximum slope is $\\frac{5}{L}$, which corresponds to a unique neighbor, $(1,3)$. No tie case occurs.\nNumber of tie cases for $(2,3)$: $0$.\n\n**Cell (3,1): $z_{31} = 92$**\nNeighbors within the patch are $(2,1)$, $(2,2)$, and $(3,2)$, with elevations $z_{21}=95$, $z_{22}=100$, and $z_{32}=95$. All neighbors are higher. This is a pit.\nNumber of tie cases for $(3,1)$: $0$.\n\n**Cell (3,2): $z_{32} = 95$**\nAdmissible neighbors $j$ (where $z_j \\le 95$) are:\n- $(3,1)$: $z_{31}=92$. Cardinal. $s_{32 \\to 31} = \\frac{95 - 92}{L} = \\frac{3}{L}$.\n- $(3,3)$: $z_{33}=92$. Cardinal. $s_{32 \\to 33} = \\frac{95 - 92}{L} = \\frac{3}{L}$.\n- $(2,1)$: $z_{21}=95$. Diagonal. $s_{32 \\to 21} = \\frac{95 - 95}{\\sqrt{2}L} = 0$.\n- $(2,3)$: $z_{23}=95$. Diagonal. $s_{32 \\to 23} = \\frac{95 - 95}{\\sqrt{2}L} = 0$.\nThe maximum slope is $\\frac{3}{L}$. This slope occurs for two distinct neighbors: $(3,1)$ and $(3,3)$. This constitutes a tie case.\nNumber of tie cases for $(3,2)$: $1$.\n\n**Cell (3,3): $z_{33} = 92$**\nNeighbors within the patch are $(2,2)$, $(2,3)$, and $(3,2)$, with elevations $z_{22}=100$, $z_{23}=95$, and $z_{32}=95$. All neighbors are higher. This is a pit.\nNumber of tie cases for $(3,3)$: $0$.\n\n**Total Count**\nSumming the number of tie cases from all $9$ cells:\nTotal ties = $0 + 1 + 0 + 0 + 1 + 0 + 0 + 1 + 0 = 3$.\nThe total number of tie cases in the patch is $3$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "Raw Digital Elevation Models are seldom perfect; they often contain spurious pits and depressions that can act as artificial sinks, halting flow routing and disrupting watershed delineation. This exercise moves from idealized surfaces to this more realistic scenario, challenging you to identify both single-cell pits and larger multi-cell depressions within a sample DEM . More importantly, it introduces a practical workflow for classifying these features as either spurious artifacts to be removed or true hydrographic features to be preserved, using criteria based on DEM uncertainty and auxiliary geographic data.",
            "id": "3931009",
            "problem": "Consider a raster Digital Elevation Model (DEM) represented on a regular grid of $5 \\times 5$ cells with square cell size $c = 30\\,\\mathrm{m}$. Let the DEM elevation at grid location $(i,j)$ (row $i$, column $j$; $i,j \\in \\{1,2,3,4,5\\}$) be denoted by $z(i,j)$ in meters above a datum. The DEM values are:\n$$\n\\begin{bmatrix}\n120 & 118 & 117 & 90 & 119 \\\\\n119 & 117 & 116 & 92 & 118 \\\\\n118 & 115 & 110 & 111 & 116 \\\\\n115 & 100 & 100 & 112 & 115 \\\\\n114 & 100 & 100 & 113 & 114 \\\\\n\\end{bmatrix}\n$$\nAssume eight-direction (D8) flow on the raster, where the eight-neighborhood $N_8(p)$ of a cell $p$ consists of its adjacent and diagonal neighbors. A single-cell pit is a cell $p$ such that for all $q \\in N_8(p)$, $z(q) > z(p)$. A multi-cell depression is a maximal connected set $S$ (connected under $N_8$) for which all cells on its external boundary $\\partial S$ are strictly higher than the minimum elevation inside $S$, that is, $\\min_{b \\in \\partial S} z(b) > \\min_{s \\in S} z(s)$. The spill elevation $z_s(S)$ of a depression $S$ is defined as $z_s(S) = \\min_{b \\in \\partial S} z(b)$, and its fill depth (depression depth) is $d(S) = z_s(S) - \\min_{s \\in S} z(s)$. For a single-cell pit $p$, define $z_s(\\{p\\}) = \\min_{q \\in N_8(p)} z(q)$ and $d(\\{p\\}) = z_s(\\{p\\}) - z(p)$.\n\nAssume the DEM has a vertical uncertainty (one-sigma) of $\\sigma_z = 1\\,\\mathrm{m}$. A hydrologic enforcement policy classifies a depression $S$ as spurious if $d(S) < 3\\sigma_z$ and $S$ is not coincident with an external hydrographic feature; otherwise, it is classified as true (to be preserved). An auxiliary hydrographic dataset provides a lake polygon that exactly overlaps the four-cell block $\\{(4,2),(4,3),(5,2),(5,3)\\}$.\n\nBased on the definitions and the given policy, identify all pits (including any multi-cell depressions) in the grid and classify each as spurious or true. Choose the option that correctly lists the pit set(s) and their classification.\n\nA. Pits are $\\{(1,4)\\}$ classified spurious, and $\\{(4,2),(4,3),(5,2),(5,3)\\}$ classified true.\n\nB. Pits are $\\{(1,4)\\}$ classified true (because $z(1,4)$ is far lower than its neighbors), and $\\{(4,2),(4,3),(5,2),(5,3)\\}$ classified true.\n\nC. Pits are $\\{(1,4),(2,4)\\}$ classified spurious, and $\\{(4,2),(4,3),(5,2),(5,3)\\}$ classified spurious (because equal-elevation flats cannot be true depressions).\n\nD. The only pit is $\\{(4,2),(4,3),(5,2),(5,3)\\}$ classified true; $\\{(1,4)\\}$ is not a pit because it spills at $z=92\\,\\mathrm{m}$.",
            "solution": "The user has provided a problem concerning the identification and classification of pits and depressions in a Digital Elevation Model (DEM).\n\n### Problem Validation\nThe problem statement is evaluated for validity.\n\n**Step 1: Extract Givens**\n- **DEM Grid**: A $5 \\times 5$ regular grid with cell size $c = 30\\,\\mathrm{m}$.\n- **Grid Indexing**: $(i,j)$ for row $i$, column $j$, where $i,j \\in \\{1,2,3,4,5\\}$.\n- **Elevation Data $z(i,j)$**:\n$$\n\\begin{bmatrix}\n120 & 118 & 117 & 90 & 119 \\\\\n119 & 117 & 116 & 92 & 118 \\\\\n118 & 115 & 110 & 111 & 116 \\\\\n115 & 100 & 100 & 112 & 115 \\\\\n114 & 100 & 100 & 113 & 114 \\\\\n\\end{bmatrix}\\,\\mathrm{m}\n$$\n- **Flow Model**: Eight-direction (D8) using the $N_8$ neighborhood.\n- **Single-Cell Pit Definition**: Cell $p$ is a pit if $z(q) > z(p)$ for all neighbors $q \\in N_8(p)$.\n- **Multi-Cell Depression Definition**: A maximal connected set $S$ where the minimum elevation on its external boundary is strictly greater than the minimum elevation within the set: $\\min_{b \\in \\partial S} z(b) > \\min_{s \\in S} z(s)$.\n- **Spill Elevation and Fill Depth Definitions**:\n  - For a depression $S$: $z_s(S) = \\min_{b \\in \\partial S} z(b)$ and $d(S) = z_s(S) - \\min_{s \\in S} z(s)$.\n  - For a single-cell pit $p$: $z_s(\\{p\\}) = \\min_{q \\in N_8(p)} z(q)$ and $d(\\{p\\}) = z_s(\\{p\\}) - z(p)$.\n- **Vertical Uncertainty**: $\\sigma_z = 1\\,\\mathrm{m}$.\n- **Classification Policy**: A depression $S$ is \"spurious\" if $d(S) < 3\\sigma_z$ and it does not coincide with an external hydrographic feature. Otherwise, it is \"true\".\n- **Hydrographic Data**: A lake polygon exactly overlaps the cell block $\\{(4,2),(4,3),(5,2),(5,3)\\}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in standard hydrological and GIS principles for DEM analysis. The definitions provided for pits, depressions, spill elevation, and depth are consistent with established literature. The inclusion of DEM uncertainty and ancillary hydrographic data for classification represents a common, practical workflow. The problem is well-posed, with all necessary data and definitions provided to reach a unique, verifiable solution. There are no contradictions, ambiguities, or factual errors.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\n### Derivation of Solution\n\nThe solution proceeds by first identifying all pits and depressions in the DEM, then calculating their properties, and finally classifying them according to the given policy.\n\n**1. Identification of Pits and Depressions**\n\nWe must systematically scan the grid for cells or groups of cells that satisfy the definitions of a pit or depression. A pit is a cell that is a strict local minimum with respect to its $N_8$ neighbors.\n\n- **Scanning for Single-Cell Pits:**\n  We examine each cell. A cell $p$ is a pit if $z(q) > z(p)$ for all its neighbors $q$.\n  - Consider cell $p_1 = (1,4)$ with elevation $z(1,4) = 90\\,\\mathrm{m}$. Its neighbors and their elevations are:\n    $z(1,3) = 117\\,\\mathrm{m}$\n    $z(1,5) = 119\\,\\mathrm{m}$\n    $z(2,3) = 116\\,\\mathrm{m}$\n    $z(2,4) = 92\\,\\mathrm{m}$\n    $z(2,5) = 118\\,\\mathrm{m}$\n    Since all neighbor elevations are strictly greater than $90\\,\\mathrm{m}$, the cell $(1,4)$ is a single-cell pit. Let's denote this depression as $S_1 = \\{(1,4)\\}$.\n  - No other cell is a single-cell pit. For any other cell, at least one neighbor has an equal or lower elevation.\n\n- **Scanning for Multi-Cell Depressions:**\n  A multi-cell depression often involves a flat area. We observe a flat area of $100\\,\\mathrm{m}$ elevation at cells $\\{(4,2), (4,3), (5,2), (5,3)\\}$. Let's test if this set forms a depression. Let $S_2 = \\{(4,2), (4,3), (5,2), (5,3)\\}$.\n  - The minimum elevation within this set is $\\min_{s \\in S_2} z(s) = 100\\,\\mathrm{m}$.\n  - The external boundary $\\partial S_2$ consists of all cells not in $S_2$ that are neighbors to any cell in $S_2$. These are:\n    $\\partial S_2 = \\{(3,1), (3,2), (3,3), (3,4), (4,1), (4,4), (5,1), (5,4)\\}$.\n  - The elevations of the boundary cells are:\n    $z(3,1) = 118\\,\\mathrm{m}$, $z(3,2) = 115\\,\\mathrm{m}$, $z(3,3) = 110\\,\\mathrm{m}$, $z(3,4) = 111\\,\\mathrm{m}$,\n    $z(4,1) = 115\\,\\mathrm{m}$, $z(4,4) = 112\\,\\mathrm{m}$,\n    $z(5,1) = 114\\,\\mathrm{m}$, $z(5,4) = 113\\,\\mathrm{m}$.\n  - The minimum elevation on the boundary is $\\min_{b \\in \\partial S_2} z(b) = z(3,3) = 110\\,\\mathrm{m}$.\n  - We check the depression condition: $\\min_{b \\in \\partial S_2} z(b) > \\min_{s \\in S_2} z(s)$. This gives $110\\,\\mathrm{m} > 100\\,\\mathrm{m}$, which is true.\n  - The set $S_2$ is connected and no other adjacent cells have an elevation of $100\\,\\mathrm{m}$, so it is a maximal connected set. Therefore, $S_2$ is a multi-cell depression.\n\nThere are two depressions in the DEM: $S_1 = \\{(1,4)\\}$ and $S_2 = \\{(4,2),(4,3),(5,2),(5,3)\\}$.\n\n**2. Classification of Depressions**\n\nThe policy states a depression $S$ is \"spurious\" if its fill depth $d(S) < 3\\sigma_z$ AND it does not coincide with a hydrographic feature. Given $\\sigma_z = 1\\,\\mathrm{m}$, the threshold is $3\\sigma_z = 3\\,\\mathrm{m}$. Otherwise, the depression is \"true\".\n\n- **Classification of $S_1 = \\{(1,4)\\}$**:\n  - The spill elevation is $z_s(S_1) = \\min_{q \\in N_8(1,4)} z(q) = z(2,4) = 92\\,\\mathrm{m}$.\n  - The fill depth is $d(S_1) = z_s(S_1) - z(1,4) = 92\\,\\mathrm{m} - 90\\,\\mathrm{m} = 2\\,\\mathrm{m}$.\n  - We check the conditions for being spurious:\n    1. Is $d(S_1) < 3\\,\\mathrm{m}$? Yes, $2\\,\\mathrm{m} < 3\\,\\mathrm{m}$.\n    2. Is $S_1$ coincident with the hydrographic feature? No, the lake is at $\\{(4,2),(4,3),(5,2),(5,3)\\}$.\n  - Both conditions are met. Thus, $S_1$ is classified as **spurious**.\n\n- **Classification of $S_2 = \\{(4,2),(4,3),(5,2),(5,3)\\}$**:\n  - The spill elevation is $z_s(S_2) = \\min_{b \\in \\partial S_2} z(b) = z(3,3) = 110\\,\\mathrm{m}$.\n  - The fill depth is $d(S_2) = z_s(S_2) - \\min_{s \\in S_2} z(s) = 110\\,\\mathrm{m} - 100\\,\\mathrm{m} = 10\\,\\mathrm{m}$.\n  - We check the conditions for being spurious. A depression is \"true\" if either condition fails.\n    1. Is $d(S_2) < 3\\,\\mathrm{m}$? No, $10\\,\\mathrm{m} \\ge 3\\,\\mathrm{m}$.\n  - Since the first condition for being spurious fails, the depression must be classified as **true**. Furthermore, the problem states that $S_2$ is coincident with a lake polygon, which is the second reason it must be classified as true.\n\n**Conclusion of Derivation:**\nThe DEM contains two depressions:\n1.  A single-cell pit at $\\{(1,4)\\}$, which is classified as **spurious**.\n2.  A multi-cell depression at $\\{(4,2),(4,3),(5,2),(5,3)\\}$, which is classified as **true**.\n\n### Option-by-Option Analysis\n\n- **A. Pits are $\\{(1,4)\\}$ classified spurious, and $\\{(4,2),(4,3),(5,2),(5,3)\\}$ classified true.**\n  This option correctly identifies both depressions and their respective classifications as derived above.\n  **Verdict: Correct.**\n\n- **B. Pits are $\\{(1,4)\\}$ classified true (because $z(1,4)$ is far lower than its neighbors), and $\\{(4,2),(4,3),(5,2),(5,3)\\}$ classified true.**\n  This option incorrectly classifies the pit at $\\{(1,4)\\}$ as true. The classification must follow the given policy, not a subjective assessment. Its fill depth of $2\\,\\mathrm{m}$ is below the $3\\,\\mathrm{m}$ threshold, and it is not supported by hydrographic data.\n  **Verdict: Incorrect.**\n\n- **C. Pits are $\\{(1,4),(2,4)\\}$ classified spurious, and $\\{(4,2),(4,3),(5,2),(5,3)\\}$ classified spurious (because equal-elevation flats cannot be true depressions).**\n  This option makes two errors. First, it incorrectly includes cell $(2,4)$ in the first pit; $(2,4)$ is the spill point, not part of the pit itself. Second, it incorrectly classifies the second depression as spurious and provides a baseless reason. The definition provided explicitly allows for multi-cell depressions, which can be flats, and our calculation confirmed this depression is deep enough to be considered \"true\".\n  **Verdict: Incorrect.**\n\n- **D. The only pit is $\\{(4,2),(4,3),(5,2),(5,3)\\}$ classified true; $\\{(1,4)\\}$ is not a pit because it spills at $z=92\\,\\mathrm{m}$.**\n  This option incorrectly claims that $\\{(1,4)\\}$ is not a pit. It perfectly matches the definition of a single-cell pit. A pit's existence is defined by its local topography (being a local minimum), while its spill point determines its depth. The statement confuses the definition of a pit with its properties relevant to filling.\n  **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once a stream network has been extracted from a hydrologically-corrected DEM, we can begin to analyze its structure and complexity. This final practice focuses on quantitative geomorphology by asking you to apply two of the most common stream ordering systems—Strahler and Shreve—to a predefined network topology . By calculating both the hierarchical Strahler order and the additive Shreve magnitude for each link, you will see how different classification schemes reveal distinct aspects of network structure, culminating in a comparison of their informational content using Shannon entropy.",
            "id": "3931003",
            "problem": "A Digital Elevation Model (DEM) has been hydrologically conditioned (pit removal and enforcement of monotonic flow), and flow routing has been computed using the eight-direction (D8) method. The extracted drainage network is represented as a directed acyclic graph of stream links, where each link connects either a headwater to its first confluence or a confluence to the next confluence or the outlet. Assume all confluences are binary (exactly two incoming links).\n\nThe network topology consists of $11$ links $\\{\\ell_1,\\ell_2,\\dots,\\ell_{11}\\}$ arranged as follows:\n- Headwater links: $\\ell_1, \\ell_2, \\ell_3, \\ell_4, \\ell_5, \\ell_6$.\n- Confluences:\n  - Node $X_1$: $\\ell_1$ and $\\ell_2$ merge to form downstream link $\\ell_7$.\n  - Node $X_2$: $\\ell_3$ and $\\ell_4$ merge to form downstream link $\\ell_8$.\n  - Node $X_3$: $\\ell_7$ and $\\ell_8$ merge to form downstream link $\\ell_9$.\n  - Node $X_4$: $\\ell_5$ and $\\ell_6$ merge to form downstream link $\\ell_{10}$.\n  - Node $X_5$: $\\ell_9$ and $\\ell_{10}$ merge to form downstream link $\\ell_{11}$, which drains to the outlet.\n\nUsing only core definitions, proceed as follows:\n- Define the Strahler stream order $S(\\ell)$ recursively: each headwater link has $S=1$; at a confluence of two upstream links with orders $s_1$ and $s_2$, the downstream link’s order is $\\max(s_1,s_2)$ if $s_1 \\neq s_2$, and $\\max(s_1,s_2)+1$ if $s_1=s_2$.\n- Define the Shreve stream magnitude $M(\\ell)$ recursively: each headwater link has $M=1$; at a confluence of two upstream links with magnitudes $m_1$ and $m_2$, the downstream link’s magnitude is $m_1+m_2$.\n\nCompute $S(\\ell)$ and $M(\\ell)$ for all links $\\ell \\in \\{\\ell_1,\\dots,\\ell_{11}\\}$. Then form two empirical discrete distributions over links:\n- $P_S$ is the distribution of Strahler orders over links, i.e., the probability mass function on the set of distinct Strahler orders observed, with probability of an order value equal to its relative frequency across the $11$ links.\n- $P_M$ is the distribution of Shreve magnitudes over links, i.e., the probability mass function on the set of distinct Shreve magnitudes observed, with probability of a magnitude value equal to its relative frequency across the $11$ links.\n\nUsing Shannon entropy with natural logarithms, $H(P) = -\\sum_i p_i \\ln p_i$, compute the entropy difference\n$$\\Delta H \\equiv H(P_M) - H(P_S).$$\nExpress the final answer as an exact expression in natural units (nats). No numerical rounding is required.",
            "solution": "The user-provided problem has been analyzed and validated. All givens are listed verbatim: a Digital Elevation Model (DEM) is hydrologically conditioned, flow routing is by the eight-direction (D8) method, the network is a directed acyclic graph of stream links, and all confluences are binary. The network has $11$ links $\\{\\ell_1, \\ell_2, \\dots, \\ell_{11}\\}$. The headwater links are $\\ell_1, \\ell_2, \\ell_3, \\ell_4, \\ell_5, \\ell_6$. The five confluences are: Node $X_1$: $\\ell_1$ and $\\ell_2$ merge to form $\\ell_7$. Node $X_2$: $\\ell_3$ and $\\ell_4$ merge to form $\\ell_8$. Node $X_3$: $\\ell_7$ and $\\ell_8$ merge to form $\\ell_9$. Node $X_4$: $\\ell_5$ and $\\ell_6$ merge to form $\\ell_{10}$. Node $X_5$: $\\ell_9$ and $\\ell_{10}$ merge to form $\\ell_{11}$. The problem provides recursive definitions for Strahler stream order $S(\\ell)$ and Shreve stream magnitude $M(\\ell)$. The task is to compute $S(\\ell)$ and $M(\\ell)$ for all links, form two empirical discrete probability distributions $P_S$ and $P_M$ over the set of $11$ links, and compute the entropy difference $\\Delta H = H(P_M) - H(P_S)$ using Shannon entropy with natural logarithms, $H(P) = -\\sum_i p_i \\ln p_i$.\n\nThe problem is scientifically grounded in hydrology and geomorphology, is mathematically well-posed with all necessary information provided, and is formulated using objective, unambiguous language. It does not violate any of the invalidity criteria. Therefore, the problem is deemed valid and a full solution is warranted.\n\nThe solution proceeds in three stages:\n1.  Calculation of Strahler orders and Shreve magnitudes for all links.\n2.  Construction of the probability distributions $P_S$ and $P_M$.\n3.  Calculation of the entropy difference $\\Delta H$.\n\nFirst, we compute the Strahler stream order $S(\\ell)$ for each link, starting from the headwaters and moving downstream.\n-   The headwater links are $\\ell_1, \\ell_2, \\ell_3, \\ell_4, \\ell_5, \\ell_6$. By definition, their Strahler orders are all $1$.\n    $S(\\ell_1)=1, S(\\ell_2)=1, S(\\ell_3)=1, S(\\ell_4)=1, S(\\ell_5)=1, S(\\ell_6)=1$.\n-   At confluence $X_1$, links $\\ell_1$ and $\\ell_2$ merge. Since $S(\\ell_1) = S(\\ell_2) = 1$, the downstream link $\\ell_7$ has order $S(\\ell_7) = S(\\ell_1) + 1 = 1+1=2$.\n-   At confluence $X_2$, links $\\ell_3$ and $\\ell_4$ merge. Since $S(\\ell_3) = S(\\ell_4) = 1$, the downstream link $\\ell_8$ has order $S(\\ell_8) = S(\\ell_3) + 1 = 1+1=2$.\n-   At confluence $X_4$, links $\\ell_5$ and $\\ell_6$ merge. Since $S(\\ell_5) = S(\\ell_6) = 1$, the downstream link $\\ell_{10}$ has order $S(\\ell_{10}) = S(\\ell_5) + 1 = 1+1=2$.\n-   At confluence $X_3$, links $\\ell_7$ and $\\ell_8$ merge. Since $S(\\ell_7) = S(\\ell_8) = 2$, the downstream link $\\ell_9$ has order $S(\\ell_9) = S(\\ell_7) + 1 = 2+1=3$.\n-   At confluence $X_5$, links $\\ell_9$ and $\\ell_{10}$ merge. Since $S(\\ell_9) = 3$ and $S(\\ell_{10}) = 2$, the orders are unequal. The downstream link $\\ell_{11}$ has order $S(\\ell_{11}) = \\max(S(\\ell_9), S(\\ell_{10})) = \\max(3, 2) = 3$.\nThe complete set of Strahler orders for the $11$ links is: $\\{1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3\\}$.\n\nSecond, we compute the Shreve stream magnitude $M(\\ell)$ for each link.\n-   The headwater links have Shreve magnitudes of $1$ by definition.\n    $M(\\ell_1)=1, M(\\ell_2)=1, M(\\ell_3)=1, M(\\ell_4)=1, M(\\ell_5)=1, M(\\ell_6)=1$.\n-   At confluence $X_1$, the downstream magnitude is the sum of upstream magnitudes: $M(\\ell_7) = M(\\ell_1) + M(\\ell_2) = 1+1=2$.\n-   At confluence $X_2$: $M(\\ell_8) = M(\\ell_3) + M(\\ell_4) = 1+1=2$.\n-   At confluence $X_4$: $M(\\ell_{10}) = M(\\ell_5) + M(\\ell_6) = 1+1=2$.\n-   At confluence $X_3$: $M(\\ell_9) = M(\\ell_7) + M(\\ell_8) = 2+2=4$.\n-   At confluence $X_5$: $M(\\ell_{11}) = M(\\ell_9) + M(\\ell_{10}) = 4+2=6$.\nThe complete set of Shreve magnitudes for the $11$ links is: $\\{1, 1, 1, 1, 1, 1, 2, 2, 2, 4, 6\\}$.\n\nNext, we construct the empirical probability distributions. The total number of links is $N=11$.\nThe distribution of Strahler orders, $P_S$, is determined by the frequencies of the order values $\\{1, 2, 3\\}$.\n-   Number of links with $S=1$: $n_1 = 6$. Probability $p_S(1) = \\frac{6}{11}$.\n-   Number of links with $S=2$: $n_2 = 3$. Probability $p_S(2) = \\frac{3}{11}$.\n-   Number of links with $S=3$: $n_3 = 2$. Probability $p_S(3) = \\frac{2}{11}$.\nThe distribution $P_S$ is $\\{(1, \\frac{6}{11}), (2, \\frac{3}{11}), (3, \\frac{2}{11})\\}$.\n\nThe distribution of Shreve magnitudes, $P_M$, is determined by the frequencies of the magnitude values $\\{1, 2, 4, 6\\}$.\n-   Number of links with $M=1$: $n'_1 = 6$. Probability $p_M(1) = \\frac{6}{11}$.\n-   Number of links with $M=2$: $n'_2 = 3$. Probability $p_M(2) = \\frac{3}{11}$.\n-   Number of links with $M=4$: $n'_3 = 1$. Probability $p_M(4) = \\frac{1}{11}$.\n-   Number of links with $M=6$: $n'_4 = 1$. Probability $p_M(6) = \\frac{1}{11}$.\nThe distribution $P_M$ is $\\{(1, \\frac{6}{11}), (2, \\frac{3}{11}), (4, \\frac{1}{11}), (6, \\frac{1}{11})\\}$.\n\nFinally, we compute the Shannon entropy for each distribution and their difference, $\\Delta H = H(P_M) - H(P_S)$.\nThe entropy for $P_S$ is:\n$$H(P_S) = -\\sum_{s \\in \\{1,2,3\\}} p_S(s) \\ln(p_S(s)) = - \\left( \\frac{6}{11} \\ln\\left(\\frac{6}{11}\\right) + \\frac{3}{11} \\ln\\left(\\frac{3}{11}\\right) + \\frac{2}{11} \\ln\\left(\\frac{2}{11}\\right) \\right)$$\nThe entropy for $P_M$ is:\n$$H(P_M) = -\\sum_{m \\in \\{1,2,4,6\\}} p_M(m) \\ln(p_M(m)) = - \\left( \\frac{6}{11} \\ln\\left(\\frac{6}{11}\\right) + \\frac{3}{11} \\ln\\left(\\frac{3}{11}\\right) + \\frac{1}{11} \\ln\\left(\\frac{1}{11}\\right) + \\frac{1}{11} \\ln\\left(\\frac{1}{11}\\right) \\right)$$\nNow, we compute the difference $\\Delta H = H(P_M) - H(P_S)$. Notice that the first two terms in the sums for $H(P_S)$ and $H(P_M)$ are identical.\n\\begin{align*}\n\\Delta H &= H(P_M) - H(P_S) \\\\\n&= \\left[ - \\left( \\frac{6}{11} \\ln\\frac{6}{11} + \\frac{3}{11} \\ln\\frac{3}{11} + \\frac{2}{11} \\ln\\frac{1}{11} \\right) \\right] - \\left[ - \\left( \\frac{6}{11} \\ln\\frac{6}{11} + \\frac{3}{11} \\ln\\frac{3}{11} + \\frac{2}{11} \\ln\\frac{2}{11} \\right) \\right] \\\\\n&= - \\left( \\frac{2}{11} \\ln\\frac{1}{11} \\right) + \\left( \\frac{2}{11} \\ln\\frac{2}{11} \\right) \\\\\n&= \\frac{2}{11} \\left( \\ln\\frac{2}{11} - \\ln\\frac{1}{11} \\right)\n\\end{align*}\nUsing the logarithm property $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$ \\Delta H = \\frac{2}{11} \\ln\\left(\\frac{2/11}{1/11}\\right) = \\frac{2}{11} \\ln(2) $$\nThis is the final exact expression for the entropy difference in nats.",
            "answer": "$$\\boxed{\\frac{2}{11}\\ln(2)}$$"
        }
    ]
}