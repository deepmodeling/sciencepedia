{
    "hands_on_practices": [
        {
            "introduction": "本练习至关重要，它将指导你推导彭曼-蒙特斯（Penman-Monteith）方程，这是生态水文学和气候模拟的基石。通过这个练习，你将深入理解可用能量是如何分配为感热通量和潜热通量的，以及这种分配如何受到大气需求和地表特征的控制。",
            "id": "3887828",
            "problem": "在稳定的正午条件下，一个均一的植被地表具有净辐射 $R_n$ 和地表热通量 $G$，因此可用能量为 $R_n - G$。湍流感热通量 $H$ 和潜热通量 $\\lambda E$ 使地表能量平衡闭合。从适用于陆-气交换的环境与地球系统模拟的基本原理出发，推导潜热通量作为可用能量、水汽压差和传输阻力的函数。具体而言，从地表能量平衡方程 $R_n - G = H + \\lambda E$、通量-梯度关系式 $H = \\rho_a c_p (T_s - T_a)/r_a$ 和线性化的水汽压差 $e_s(T_s) - e_a \\approx \\Delta (T_s - T_a) + \\mathrm{VPD}$ 出发，并使用干湿表常数 $\\gamma$ 的定义将水汽传输与能量联系起来。假设空气密度和比热恒定，并且水汽通过串联的空气动力学阻力和地表阻力的传输采用单路径阻力表示法。\n\n给定以下观测和热物理量：\n- 可用能量 $R_n - G = 300\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$，\n- 水汽压差 $\\mathrm{VPD} = 1\\ \\mathrm{kPa}$，\n- 饱和水汽压曲线的斜率 $\\Delta = 0.2\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1}$，\n- 干湿表常数 $\\gamma = 0.066\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1}$，\n- 空气动力学阻力 $r_a = 20\\ \\mathrm{s}\\ \\mathrm{m}^{-1}$，\n- 地表阻力 $r_s = 100\\ \\mathrm{s}\\ \\mathrm{m}^{-1}$，\n- 空气密度 $\\rho_a = 1.2\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$，\n- 定压空气比热 $c_p = 1005\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$，\n\n计算潜热通量 $\\lambda E$ 和鲍恩比 $\\beta$，其中 $\\beta = H/(\\lambda E)$。将 $\\lambda E$ 以 $\\mathrm{W}\\ \\mathrm{m}^{-2}$ 为单位表示，鲍恩比表示为无量纲小数。将两个量都四舍五入到四位有效数字。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、提法恰当且内容完整。所提供的信息涉及地表能量平衡，这是环境物理学和陆面模拟中的一个基本概念。控制方程是标准的通量-梯度关系式，所提供的常数在物理上是现实的。该问题要求推导该领域的基石——Penman-Monteith方程，并进行后续计算。变量、常数和单位在量纲上是一致的。因此，该问题被认为是有效的，有必要给出完整解答。\n\n推导从所提供的基本原理开始。目标是求出潜热通量 $\\lambda E$ 作为实测大气变量和地表特性的函数，从而消去未测量的地表温度 $T_s$。\n\n控制方程如下：\n1. 地表能量平衡方程，它将可用能量 ($R_n - G$) 划分为湍流通量：\n$$R_n - G = H + \\lambda E$$\n其中 $R_n$ 是净辐射，$G$ 是地表热通量，$H$ 是感热通量，$\\lambda E$ 是潜热通量。\n\n2. 感热通量的整体空气动力学公式，一种通量-梯度关系：\n$$H = \\rho_a c_p \\frac{T_s - T_a}{r_a}$$\n其中 $\\rho_a$ 是空气密度，$c_p$ 是定压空气比热，$T_s$ 是地表温度，$T_a$ 是空气温度，$r_a$ 是热量传输的空气动力学阻力。\n\n3. 潜热通量的整体空气动力学公式，它使用干湿表常数 $\\gamma$ 将水汽传输与能量传输联系起来：\n$$\\lambda E = \\frac{\\rho_a c_p}{\\gamma} \\frac{e_s(T_s) - e_a}{r_a + r_s}$$\n其中 $e_s(T_s)$ 是地表温度下的饱和水汽压，$e_a$ 是空气的实际水汽压，$r_s$ 是地表（或冠层）对水汽传输的阻力，总的水汽传输阻力是空气动力学阻力和地表阻力的串联之和，$r_a + r_s$。\n\n4. 地表与空气之间饱和水汽压差的克劳修斯-克拉佩龙关系的线性化形式：\n$$e_s(T_s) - e_a \\approx \\Delta (T_s - T_a) + (e_s(T_a) - e_a)$$\n其中 $\\Delta$ 是气温下（$T_a$ 处的 $de_s/dT$）饱和水汽压曲线的斜率，$e_s(T_a) - e_a$ 是水汽压差，记为 $\\mathrm{VPD}$。方程变为：\n$$e_s(T_s) - e_a = \\Delta (T_s - T_a) + \\mathrm{VPD}$$\n\n推导过程通过消去未知的地-气温差 $T_s - T_a$ 来进行。从感热通量方程 (2) 中，我们分离出 $T_s - T_a$：\n$$T_s - T_a = \\frac{H r_a}{\\rho_a c_p}$$\n\n将这个关于 $T_s - T_a$ 的表达式代入线性化的水汽压方程 (4)：\n$$e_s(T_s) - e_a = \\Delta \\left(\\frac{H r_a}{\\rho_a c_p}\\right) + \\mathrm{VPD}$$\n\n现在，将这个关于水汽压差 $e_s(T_s) - e_a$ 的表达式代入潜热通量方程 (3)：\n$$\\lambda E = \\frac{\\rho_a c_p}{\\gamma (r_a + r_s)} \\left[ \\Delta \\frac{H r_a}{\\rho_a c_p} + \\mathrm{VPD} \\right]$$\n展开前一项，我们得到：\n$$\\lambda E = \\frac{\\Delta H r_a}{\\gamma (r_a + r_s)} + \\frac{\\rho_a c_p \\mathrm{VPD}}{\\gamma (r_a + r_s)}$$\n\n此时，我们得到一个包含两个未知数 $\\lambda E$ 和 $H$ 的方程。我们使用能量平衡方程 (1) 来消去 $H$。从 (1) 可得 $H = (R_n - G) - \\lambda E$。将此式代入 $H$：\n$$\\lambda E = \\frac{\\Delta r_a ((R_n - G) - \\lambda E)}{\\gamma (r_a + r_s)} + \\frac{\\rho_a c_p \\mathrm{VPD}}{\\gamma (r_a + r_s)}$$\n\n为了解出 $\\lambda E$，我们首先将所有包含 $\\lambda E$ 的项合并到方程的一边：\n$$\\lambda E + \\frac{\\Delta r_a \\lambda E}{\\gamma (r_a + r_s)} = \\frac{\\Delta r_a (R_n - G)}{\\gamma (r_a + r_s)} + \\frac{\\rho_a c_p \\mathrm{VPD}}{\\gamma (r_a + r_s)}$$\n\n提取公因式 $\\lambda E$：\n$$\\lambda E \\left( 1 + \\frac{\\Delta r_a}{\\gamma (r_a + r_s)} \\right) = \\frac{\\Delta r_a (R_n - G) + \\rho_a c_p \\mathrm{VPD}}{\\gamma (r_a + r_s)}$$\n\n合并左侧括号内的项：\n$$\\lambda E \\left( \\frac{\\gamma (r_a + r_s) + \\Delta r_a}{\\gamma (r_a + r_s)} \\right) = \\frac{\\Delta r_a (R_n - G) + \\rho_a c_p \\mathrm{VPD}}{\\gamma (r_a + r_s)}$$\n\n消去两边的公分母 $\\gamma (r_a + r_s)$ 得到：\n$$\\lambda E (\\gamma (r_a + r_s) + \\Delta r_a) = \\Delta r_a (R_n - G) + \\rho_a c_p \\mathrm{VPD}$$\n\n最后，分离出 $\\lambda E$ 得到：\n$$\\lambda E = \\frac{\\Delta r_a (R_n - G) + \\rho_a c_p \\mathrm{VPD}}{\\gamma (r_a + r_s) + \\Delta r_a}$$\n这个方程是Penman-Monteith方程的一种形式。为方便计算，我们可以将分子和分母同除以 $r_a$：\n$$\\lambda E = \\frac{\\Delta (R_n - G) + \\frac{\\rho_a c_p \\mathrm{VPD}}{r_a}}{\\Delta + \\gamma \\left(1 + \\frac{r_s}{r_a}\\right)}$$\n\n现在，我们使用所提供的数据计算 $\\lambda E$ 的数值：\n- 可用能量 $R_n - G = 300\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$\n- 水汽压差 $\\mathrm{VPD} = 1\\ \\mathrm{kPa}$\n- 饱和水汽压曲线的斜率 $\\Delta = 0.2\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1}$\n- 干湿表常数 $\\gamma = 0.066\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1}$\n- 空气动力学阻力 $r_a = 20\\ \\mathrm{s}\\ \\mathrm{m}^{-1}$\n- 地表阻力 $r_s = 100\\ \\mathrm{s}\\ \\mathrm{m}^{-1}$\n- 空气密度 $\\rho_a = 1.2\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$\n- 空气比热 $c_p = 1005\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$\n\n首先，我们计算方程的各个组成部分：\n项 $\\frac{\\rho_a c_p}{r_a}$：\n$$\\frac{\\rho_a c_p}{r_a} = \\frac{1.2\\ \\mathrm{kg}\\ \\mathrm{m}^{-3} \\times 1005\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}}{20\\ \\mathrm{s}\\ \\mathrm{m}^{-1}} = \\frac{1206\\ \\mathrm{J}\\ \\mathrm{m}^{-3}\\ \\mathrm{K}^{-1}}{20\\ \\mathrm{s}\\ \\mathrm{m}^{-1}} = 60.3\\ \\mathrm{W}\\ \\mathrm{m}^{-2}\\ \\mathrm{K}^{-1}$$\n阻力比 $\\frac{r_s}{r_a}$：\n$$\\frac{r_s}{r_a} = \\frac{100\\ \\mathrm{s}\\ \\mathrm{m}^{-1}}{20\\ \\mathrm{s}\\ \\mathrm{m}^{-1}} = 5$$\n\n现在，将这些值代入Penman-Monteith方程。分子是：\n$$\\text{Numerator} = \\Delta (R_n - G) + \\frac{\\rho_a c_p}{r_a} \\mathrm{VPD} = (0.2\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1})(300\\ \\mathrm{W}\\ \\mathrm{m}^{-2}) + (60.3\\ \\mathrm{W}\\ \\mathrm{m}^{-2}\\ \\mathrm{K}^{-1})(1\\ \\mathrm{kPa}) = 60 + 60.3 = 120.3\\ \\mathrm{W}\\ \\mathrm{m}^{-2}\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1}$$\n分母是：\n$$\\text{Denominator} = \\Delta + \\gamma \\left(1 + \\frac{r_s}{r_a}\\right) = 0.2\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1} + (0.066\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1})(1 + 5) = 0.2 + 0.066 \\times 6 = 0.2 + 0.396 = 0.596\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1}$$\n\n潜热通量 $\\lambda E$ 是分子与分母的比值：\n$$\\lambda E = \\frac{120.3\\ \\mathrm{W}\\ \\mathrm{m}^{-2}\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1}}{0.596\\ \\mathrm{kPa}\\ \\mathrm{K}^{-1}} \\approx 201.845637...\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$$\n四舍五入到四位有效数字，$\\lambda E = 201.8\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$。\n\n接下来，我们计算鲍恩比，$\\beta = \\frac{H}{\\lambda E}$。首先，我们从能量平衡方程中求出感热通量 $H$：\n$$H = (R_n - G) - \\lambda E = 300\\ \\mathrm{W}\\ \\mathrm{m}^{-2} - 201.845637...\\ \\mathrm{W}\\ \\mathrm{m}^{-2} = 98.154362...\\ \\mathrm{W}\\ \\mathrm{m}^{-2}$$\n现在，鲍恩比是：\n$$\\beta = \\frac{98.154362...}{201.845637...} \\approx 0.486283...$$\n四舍五入到四位有效数字，$\\beta = 0.4863$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n201.8  0.4863\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理解了大气通量之后，我们将注意力转向地下。本练习探讨地表能量平衡中的储能项——土壤热通量的动态变化。通过分析土壤水分变化如何影响其热特性和热传输，你将深入了解地表的热惯性及其对日温度循环的影响。",
            "id": "3887833",
            "problem": "一个半无限、均质的壤土柱占据 $z \\ge 0$ 的空间，并初始处于热平衡状态。一场降雨事件后，体积含水量立即从干燥状态 $\\theta_{1} = 0.10$ 增加到较湿润的状态 $\\theta_{2} = 0.35$。土壤孔隙度为 $n = 0.45$，矿物质密度为 $\\rho_{m} = 2650 \\text{ kg m}^{-3}$，矿物质比热为 $c_{m} = 800 \\text{ J kg}^{-1} \\text{ K}^{-1}$，水的密度为 $\\rho_{w} = 1000 \\text{ kg m}^{-3}$，水的比热为 $c_{w} = 4186 \\text{ J kg}^{-1} \\text{ K}^{-1}$。干热导率为 $k_{\\text{dry}} = 0.25 \\text{ W m}^{-1} \\text{ K}^{-1}$，饱和热导率为 $k_{\\text{sat}} = 2.5 \\text{ W m}^{-1} \\text{ K}^{-1}$。热导率 $k(\\theta)$ 遵循针对未冻结细质地土壤的 Johansen 公式，其中 Kersten 数 $K_{e} = \\log_{10}(S) + 1$，而 $S = \\theta / n$，因此 $k(\\theta) = k_{\\text{dry}} + K_{e} \\bigl(k_{\\text{sat}} - k_{\\text{dry}}\\bigr)$。体积热容（单位体积的质量比热容乘以密度）为 $C(\\theta) = (1 - n)\\,\\rho_{m} c_{m} + \\theta \\,\\rho_{w} c_{w}$，热扩散率为 $D(\\theta) = k(\\theta) / C(\\theta)$。\n\n在 $z=0$ 处的地表温度受日振荡 $T(0,t) = T_{0} + T_{a} \\cos(\\omega t)$ 的驱动，振幅为 $T_{a} = 10 \\text{ K}$，周期为 $P = 86400 \\text{ s}$，角频率为 $\\omega = 2\\pi / P$。假设一维热传导由热方程 $\\partial T / \\partial t = D\\,\\partial^{2} T / \\partial z^{2}$ 控制，且当 $z \\to \\infty$ 时 $T(z,t)$ 保持有界。土壤热通量（$G$）由傅里叶定律定义：$G(z,t) = -k\\,\\partial T / \\partial z$。\n\n从这些控制关系和定义出发，推导在正弦驱动下 $z=0$ 处地表土壤热通量 $G$ 的振幅（用 $T_{a}$, $k$, $D$, 和 $\\omega$ 表示），并利用给定的属性模型量化降雨引起的 $\\theta$ 增加如何改变 $D$ 和 $G$ 的日振幅。计算与 $\\theta_{2} = 0.35$ 对应的雨后地表土壤热通量 $G$ 的振幅。\n\n将雨后振幅的最终数值答案以 $\\text{W m}^{-2}$ 为单位表示，并四舍五入到三位有效数字。",
            "solution": "用户提供的问题陈述将经过验证过程。\n\n### 步骤1：提取给定条件\n- **范围：** 半无限、均质的壤土柱，$z \\ge 0$。\n- **初始状态：** 热平衡。\n- **体积含水量：** 初始 $\\theta_{1} = 0.10$，雨后 $\\theta_{2} = 0.35$。\n- **土壤属性：**\n    - 孔隙度：$n = 0.45$。\n    - 矿物质密度：$\\rho_{m} = 2650 \\text{ kg m}^{-3}$。\n    - 矿物质比热：$c_{m} = 800 \\text{ J kg}^{-1} \\text{ K}^{-1}$。\n    - 水密度：$\\rho_{w} = 1000 \\text{ kg m}^{-3}$。\n    - 水比热：$c_{w} = 4186 \\text{ J kg}^{-1} \\text{ K}^{-1}$。\n- **热属性模型：**\n    - 干热导率：$k_{\\text{dry}} = 0.25 \\text{ W m}^{-1} \\text{ K}^{-1}$。\n    - 饱和热导率：$k_{\\text{sat}} = 2.5 \\text{ W m}^{-1} \\text{ K}^{-1}$。\n    - 热导率 $k(\\theta)$: $k(\\theta) = k_{\\text{dry}} + K_{e} \\bigl(k_{\\text{sat}} - k_{\\text{dry}}\\bigr)$。\n    - Kersten 数 $K_{e}$: $K_{e} = \\log_{10}(S) + 1$，其中 $S = \\theta / n$。\n    - 体积热容 $C(\\theta)$: $C(\\theta) = (1 - n)\\,\\rho_{m} c_{m} + \\theta \\,\\rho_{w} c_{w}$。\n    - 热扩散率 $D(\\theta)$: $D(\\theta) = k(\\theta) / C(\\theta)$。\n- **控制方程与条件：**\n    - 热方程：$\\partial T / \\partial t = D\\,\\partial^{2} T / \\partial z^{2}$。\n    - 地表驱动：$T(0,t) = T_{0} + T_{a} \\cos(\\omega t)$。\n    - 驱动振幅：$T_{a} = 10 \\text{ K}$。\n    - 驱动周期：$P = 86400 \\text{ s}$。\n    - 角频率：$\\omega = 2\\pi / P$。\n    - 边界条件：当 $z \\to \\infty$ 时，$T(z,t)$ 有界。\n- **定义：** 土壤热通量 $G(z,t) = -k\\,\\partial T / \\partial z$。\n- **任务：**\n    1. 推导 $z=0$ 处地表土壤热通量 $G$ 的振幅（用 $T_{a}$, $k$, $D$, 和 $\\omega$ 表示）。\n    2. 量化降雨如何改变 $D$ 和 $G$ 的振幅。\n    3. 计算 $\\theta_{2} = 0.35$ 时雨后 $G$ 的振幅。\n    4. 将最终答案四舍五入到三位有效数字。\n\n### 步骤2：使用提取的给定条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据：** 该问题基于热传递的基本原理，特别是一维热传导方程和傅里叶定律。提供的土壤热属性随含水量变化的模型（用于 $k$ 的 Johansen/Kersten 模型，用于 $C$ 的混合模型）是标准模型，在土壤物理学和环境建模中广泛使用。所有物理常数和参数都在实际范围内。\n- **适定性：** 该问题为半无限域提供了一个定义明确的偏微分方程，并带有适当的边界条件（$z=0$ 处的狄利克雷条件，$z \\to \\infty$ 处的有界性条件）。这构成了一个经典的、可解的数学物理问题，具有唯一且稳定的解。计算所需的所有数据均已提供。\n- **客观性：** 问题以精确、定量且无偏见的技术语言陈述。\n- **结论：** 该问题科学上合理，适定，且不存在任何指定的无效性缺陷。\n\n### 步骤3：裁定与行动\n问题有效。将提供完整解答。\n\n### 解答\n该问题要求推导地表土壤热通量的振幅，然后计算其在指定的雨后土壤湿度条件下的值。\n\n**1. 土壤热通量振幅的推导**\n\n控制性一维热方程为：\n$$\n\\frac{\\partial T}{\\partial t} = D \\frac{\\partial^2 T}{\\partial z^2}\n$$\n地表温度受正弦振荡驱动。我们可以将温度表示为平均值 $T_0$ 和一个振荡部分的总和。关注振荡部分并使用复数表示法，地表边界条件为 $\\tilde{T}(0,t) = T_a \\exp(i\\omega t)$。我们寻求形式为 $\\tilde{T}(z,t) = f(z) \\exp(i\\omega t)$ 的解。将其代入热方程，得到关于 $f(z)$ 的常微分方程：\n$$\ni\\omega f(z) = D \\frac{d^2 f}{dz^2} \\implies \\frac{d^2 f}{dz^2} = \\frac{i\\omega}{D} f(z)\n$$\n通解为 $f(z) = A \\exp(\\lambda z) + B \\exp(-\\lambda z)$，其中 $\\lambda^2 = i\\omega/D$。\n我们计算 $\\lambda$：\n$$\n\\lambda = \\sqrt{\\frac{i\\omega}{D}} = \\sqrt{\\frac{\\omega}{D}} \\sqrt{i} = \\sqrt{\\frac{\\omega}{D}} \\exp(i\\pi/4) = \\sqrt{\\frac{\\omega}{D}} \\left(\\cos\\frac{\\pi}{4} + i\\sin\\frac{\\pi}{4}\\right) = \\sqrt{\\frac{\\omega}{2D}}(1+i)\n$$\n复温度的解为 $\\tilde{T}(z,t) = \\left[A \\exp(\\lambda z) + B \\exp(-\\lambda z)\\right] \\exp(i\\omega t)$。当 $z \\to \\infty$ 时温度保持有界的边界条件要求指数增长项的系数 $A$ 为零。因此，$\\tilde{T}(z,t) = B \\exp(-\\lambda z) \\exp(i\\omega t)$。\n在地表 $z=0$ 处，我们有 $\\tilde{T}(0,t) = B \\exp(i\\omega t)$。与边界条件 $\\tilde{T}(0,t) = T_a \\exp(i\\omega t)$ 比较，我们得到 $B=T_a$。复温度分布为：\n$$\n\\tilde{T}(z,t) = T_a \\exp(-\\lambda z) \\exp(i\\omega t) = T_a \\exp\\left(-\\sqrt{\\frac{\\omega}{2D}}(1+i)z\\right) \\exp(i\\omega t)\n$$\n实际温度是其实部，$T(z,t) = T_0 + \\text{Re}[\\tilde{T}(z,t)]$：\n$$\nT(z,t) = T_0 + T_a \\exp\\left(-\\sqrt{\\frac{\\omega}{2D}}z\\right) \\cos\\left(\\omega t - \\sqrt{\\frac{\\omega}{2D}}z\\right)\n$$\n土壤热通量由傅里叶定律给出，$G(z,t) = -k \\frac{\\partial T}{\\partial z}$。让我们从复数形式计算梯度，$\\frac{\\partial \\tilde{T}}{\\partial z} = - \\lambda T_a \\exp(-\\lambda z) \\exp(i\\omega t) = -\\lambda \\tilde{T}(z,t)$。\n复热通量为 $\\tilde{G}(z,t) = -k \\frac{\\partial \\tilde{T}}{\\partial z} = k \\lambda \\tilde{T}(z,t)$。\n在地表（$z=0$）处：\n$$\n\\tilde{G}(0,t) = k\\lambda \\tilde{T}(0,t) = k \\sqrt{\\frac{\\omega}{2D}}(1+i) T_a \\exp(i\\omega t)\n$$\n地表热通量的振幅 $G_a$ 是复振幅 $k \\lambda T_a$ 的模：\n$$\nG_a = \\left| k T_a \\sqrt{\\frac{\\omega}{2D}}(1+i) \\right| = k T_a \\sqrt{\\frac{\\omega}{2D}} |1+i| = k T_a \\sqrt{\\frac{\\omega}{2D}} \\sqrt{1^2+1^2} = k T_a \\sqrt{\\frac{\\omega}{2D}} \\sqrt{2}\n$$\n$$\nG_a = k T_a \\sqrt{\\frac{\\omega}{D}}\n$$\n这也可以用热导纳 $\\sqrt{kC}$ 来表示，即 $G_a = T_a \\sqrt{kC\\omega}$，因为 $D=k/C$。这完成了任务的第一部分。\n\n**2. 雨后属性和通量振幅的计算**\n\n我们需要计算雨后条件 $\\theta_2 = 0.35$ 下的通量振幅 $G_a$。这涉及到计算热属性 $C(\\theta_2)$ 和 $k(\\theta_2)$。\n\n**a. 角频率 $\\omega$**\n周期为 $P = 86400 \\text{ s}$。\n$$\n\\omega = \\frac{2\\pi}{P} = \\frac{2\\pi}{86400} \\text{ s}^{-1} \\approx 7.2722 \\times 10^{-5} \\text{ s}^{-1}\n$$\n\n**b. 体积热容 $C(\\theta_2)$**\n使用给定公式 $C(\\theta) = (1 - n)\\rho_m c_m + \\theta \\rho_w c_w$ 以及 $\\theta_2 = 0.35$：\n$$\nC(\\theta_2) = (1 - 0.45)(2650 \\text{ kg m}^{-3})(800 \\text{ J kg}^{-1} \\text{ K}^{-1}) + (0.35)(1000 \\text{ kg m}^{-3})(4186 \\text{ J kg}^{-1} \\text{ K}^{-1})\n$$\n$$\nC(\\theta_2) = (0.55)(2120000) + (0.35)(4186000) \\text{ J m}^{-3} \\text{ K}^{-1}\n$$\n$$\nC(\\theta_2) = 1166000 + 1465100 = 2631100 \\text{ J m}^{-3} \\text{ K}^{-1}\n$$\n\n**c. 热导率 $k(\\theta_2)$**\n首先，我们求饱和度 $S_2 = \\theta_2 / n$：\n$$\nS_2 = \\frac{0.35}{0.45} = \\frac{7}{9}\n$$\n接下来，我们计算 Kersten 数 $K_{e,2} = \\log_{10}(S_2) + 1$：\n$$\nK_{e,2} = \\log_{10}\\left(\\frac{7}{9}\\right) + 1 \\approx -0.10914856 + 1 = 0.89085144\n$$\n现在，我们使用 Johansen 模型 $k(\\theta) = k_{\\text{dry}} + K_{e} (k_{\\text{sat}} - k_{\\text{dry}})$：\n$$\nk(\\theta_2) = 0.25 \\text{ W m}^{-1} \\text{ K}^{-1} + (0.89085144) (2.5 - 0.25) \\text{ W m}^{-1} \\text{ K}^{-1}\n$$\n$$\nk(\\theta_2) = 0.25 + (0.89085144)(2.25) \\approx 0.25 + 2.00441574 = 2.25441574 \\text{ W m}^{-1} \\text{ K}^{-1}\n$$\n含水量的增加显著提高了热容 $C$ 和热导率 $k$。这导致了更高的热扩散率 $D=k/C \\approx 8.568 \\times 10^{-7} \\text{ m}^2\\text{s}^{-1}$，以及至关重要的，更大的热导纳 $\\sqrt{kC}$。\n\n**d. 地表土壤热通量振幅 $G_a$**\n现在我们将计算出的值代入推导出的公式 $G_a = T_a \\sqrt{k(\\theta_2) C(\\theta_2) \\omega}$：\n$$\nG_a = (10 \\text{ K}) \\sqrt{(2.25441574 \\text{ W m}^{-1} \\text{ K}^{-1}) (2631100 \\text{ J m}^{-3} \\text{ K}^{-1}) \\left(\\frac{2\\pi}{86400} \\text{ s}^{-1}\\right)}\n$$\n平方根内的项是热导纳的平方与角频率的乘积：\n$$\nk C \\omega \\approx (2.25441574)(2631100)\\left(\\frac{2\\pi}{86400}\\right) \\approx 5931320.15 \\times 7.2722 \\times 10^{-5} \\approx 431.309 \\text{ W}^2 \\text{m}^{-4} \\text{K}^{-2}\n$$\n取平方根并乘以 $T_a$：\n$$\nG_a \\approx 10 \\times \\sqrt{431.309} \\approx 10 \\times 20.7680 \\text{ W m}^{-2} \\approx 207.68 \\text{ W m}^{-2}\n$$\n根据要求将结果四舍五入到三位有效数字：\n$$\nG_a \\approx 208 \\text{ W m}^{-2}\n$$",
            "answer": "$$\n\\boxed{208}\n$$"
        },
        {
            "introduction": "在掌握了理论模型后，任何建模者都面临一个关键问题：我们能否从测量数据中唯一地确定模型的参数？这个高级计算练习直面彭曼-蒙特斯方程的参数可识别性挑战。你将使用一种强大的诊断技术来评估地表阻抗和空气动力学阻抗是否可以被区分开来，这是模型校准和验证中的一个至关重要的步骤。",
            "id": "3887824",
            "problem": "您的任务是设计并实现一个使用共线性诊断的计算可识别性分析，以确定在地表能量平衡框架内，地表（气孔）阻力 $r_s$ 和空气动力学阻力 $r_a$ 是否可以根据可用的通量和气象数据被同时估算。该分析必须基于第一性原理。\n\n从以下基本原理出发：\n\n- 地表能量守恒：$R_n - G = H + LE$，其中 $R_n$ 是净辐射，$G$ 是地表热通量，$H$ 是感热通量，$LE$ 是潜热通量。所有通量的单位均为 $\\mathrm{W\\,m^{-2}}$。\n- 潜热通量的 Penman–Monteith 公式（一个经过充分检验、广泛使用的公式）：\n  $$ LE = \\frac{\\Delta (R_n - G) + \\rho c_p \\frac{D}{r_a}}{\\Delta + \\gamma \\left(1 + \\frac{r_s}{r_a}\\right)} $$\n  其中 $\\Delta$ 是饱和水汽压曲线相对于气温的斜率，$\\rho$ 是空气密度，$c_p$ 是空气的定压比热容，$D$ 是水汽压亏绌，$\\gamma$ 是干湿表常数。\n- 饱和水汽压 $e_s(T)$ 作为摄氏温度 $T$ 的函数（Tetens 公式，单位为帕斯卡）：\n  $$ e_s(T) = 610.78 \\exp\\!\\left(\\frac{17.2694\\,T}{T + 237.3}\\right) \\quad [\\mathrm{Pa}] $$\n- 饱和水汽压曲线的斜率：\n  $$ \\Delta(T) = \\frac{d e_s}{d T} = e_s(T) \\cdot \\frac{17.2694 \\cdot 237.3}{(T + 237.3)^2} \\quad [\\mathrm{Pa\\,K^{-1}}] $$\n- 水汽压亏绌 $D$（单位为帕斯卡）由相对湿度 $\\mathrm{RH}$（无量纲小数）和饱和水汽压 $e_s(T)$ 计算得出：\n  $$ D = \\left(1 - \\mathrm{RH}\\right) e_s(T) \\quad [\\mathrm{Pa}] $$\n- 干湿表常数 $\\gamma$（单位为 $\\mathrm{Pa\\,K^{-1}}$）由定压比热容 $c_p$（单位为 $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$）、大气压 $P$（单位为 $\\mathrm{Pa}$）和蒸发潜热 $L_v$（单位为 $\\mathrm{J\\,kg^{-1}}$）计算得出：\n  $$ \\gamma = \\frac{c_p\\, P}{0.622\\, L_v} \\quad [\\mathrm{Pa\\,K^{-1}}] $$\n- 空气密度 $\\rho$（单位为 $\\mathrm{kg\\,m^{-3}}$）根据理想气体定律，使用干空气比气体常数 $R_d$（单位为 $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$）和绝对温度 $T_K$（单位为 $\\mathrm{K}$）计算得出：\n  $$ \\rho = \\frac{P}{R_d\\, T_K} \\quad [\\mathrm{kg\\,m^{-3}}] \\quad \\text{其中} \\quad T_K = T + 273.15 $$\n\n您的目标是通过构建和分析 $LE$ 相对于这些参数在多个时间步长上的敏感度（雅可比）矩阵，来评估两个参数 $r_s$ 和 $r_a$ 的同步可识别性。请遵循以下步骤：\n\n- 对于每个时间步 $i$，设 $LE_i$ 是使用该时刻的气象输入，通过 Penman–Monteith 方程计算出的模型输出。设 $p = [r_s, r_a]^T$ 为参数向量，并假定在给定案例中其不随时间变化。\n- 从 Penman–Monteith 公式中符号化地计算偏导数 $\\frac{\\partial LE_i}{\\partial r_s}$ 和 $\\frac{\\partial LE_i}{\\partial r_a}$，并在标称参数值处对它们进行求值。\n- 构建一个无量纲的相对敏感度矩阵 $S$，其行由时间索引，包含两列，定义如下：\n  $$ S_{i,1} = \\frac{r_s}{LE_i}\\,\\frac{\\partial LE_i}{\\partial r_s}, \\quad S_{i,2} = \\frac{r_a}{LE_i}\\,\\frac{\\partial LE_i}{\\partial r_a} $$\n  排除任何 $|LE_i|$ 实际为零的时间步 $i$（以避免除以零）。为此，将绝对值小于 $10^{-6}\\,\\mathrm{W\\,m^{-2}}$ 的值视为零。\n- 通过奇异值分解（SVD）诊断共线性：计算 $S$ 的奇异值 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$，并报告条件数\n  $$ \\kappa = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}。$$\n  大的 $\\kappa$ 值表示参数敏感度之间存在共线性，因此可识别性差；小的 $\\kappa$ 值表示可识别性好。如果有效时间步少于两个，或者 $\\sigma_{\\min}$ 在数值上为零，则报告 $\\kappa = \\infty$。\n- 将最终输出（条件数）表示为无量纲浮点数。\n\n整个过程中使用的常数和单位：\n- 使用 $c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$P = 101325\\,\\mathrm{Pa}$，$L_v = 2.45 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$，$R_d = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 使用以下单位：$T$ 单位为摄氏度，$\\mathrm{RH}$ 为 $[0,1]$ 范围内的无量纲小数，$R_n$ 和 $G$ 单位为 $\\mathrm{W\\,m^{-2}}$，$r_s$ 和 $r_a$ 单位为 $\\mathrm{s\\,m^{-1}}$。所有计算出的通量单位均为 $\\mathrm{W\\,m^{-2}}$，所有压力单位均为 $\\mathrm{Pa}$。\n\n测试套件：\n为以下四个多时间步案例实施分析。在每个案例中，使用提供的标称参数值 $(r_s, r_a)$ 来评估敏感度。对于所有数组，第 $j$ 个元素对应于时间步 $j$。\n\n- 案例 A（充分激励，典型的日间变化）：\n  - $T$（摄氏度）：$\\{20, 22, 24, 26, 28, 30, 25, 27, 29, 31, 23, 21\\}$。\n  - $\\mathrm{RH}$（无量纲）：$\\{0.4, 0.35, 0.3, 0.45, 0.5, 0.55, 0.6, 0.65, 0.5, 0.45, 0.4, 0.35\\}$。\n  - $R_n$（$\\mathrm{W\\,m^{-2}}$）：$\\{600, 650, 700, 550, 500, 450, 400, 350, 300, 250, 200, 150\\}$。\n  - $G$（$\\mathrm{W\\,m^{-2}}$）：$\\{50, 60, 70, 40, 30, 25, 20, 15, 10, 10, 5, 5\\}$。\n  - 标称参数：$r_s = 120\\,\\mathrm{s\\,m^{-1}}$，$r_a = 50\\,\\mathrm{s\\,m^{-1}}$。\n\n- 案例 B（近饱和空气，水汽压亏绌极小）：\n  - $T$（摄氏度）：$\\{20, 21, 20.5, 21.5, 20.8, 21.2, 20.3, 21.1, 20.7, 21.4\\}$。\n  - $\\mathrm{RH}$（无量纲）：$\\{0.95, 0.97, 0.96, 0.95, 0.98, 0.97, 0.96, 0.99, 0.95, 0.96\\}$。\n  - $R_n$（$\\mathrm{W\\,m^{-2}}$）：$\\{600, 580, 590, 610, 605, 595, 600, 590, 610, 600\\}$。\n  - $G$（$\\mathrm{W\\,m^{-2}}$）：$\\{50, 50, 50, 50, 50, 50, 50, 50, 50, 50\\}$。\n  - 标称参数：$r_s = 150\\,\\mathrm{s\\,m^{-1}}$，$r_a = 60\\,\\mathrm{s\\,m^{-1}}$。\n\n- 案例 C（有效能量弱，低辐射条件）：\n  - $T$（摄氏度）：$\\{15, 16, 15.5, 16.5, 15.2, 16.2, 15.1, 16.1\\}$。\n  - $\\mathrm{RH}$（无量纲）：$\\{0.5, 0.55, 0.6, 0.65, 0.6, 0.55, 0.5, 0.45\\}$。\n  - $R_n$（$\\mathrm{W\\,m^{-2}}$）：$\\{30, 25, 20, 15, 10, 5, 0, 10\\}$。\n  - $G$（$\\mathrm{W\\,m^{-2}}$）：$\\{20, 15, 10, 10, 8, 5, 5, 8\\}$。\n  - 标称参数：$r_s = 100\\,\\mathrm{s\\,m^{-1}}$，$r_a = 30\\,\\mathrm{s\\,m^{-1}}$。\n\n- 案例 D（水汽压亏绌与有效能量之间的人为比例关系）：\n  - $T$（摄氏度）：$\\{25, 26, 27, 28, 29, 30, 31, 32\\}$。\n  - $R_n$（$\\mathrm{W\\,m^{-2}}$）：$\\{400, 450, 500, 350, 300, 250, 200, 150\\}$。\n  - $G$（$\\mathrm{W\\,m^{-2}}$）：$\\{50, 50, 50, 40, 40, 30, 20, 10\\}$。\n  - 定义一个比例常数 $c = 4$（单位为 $\\mathrm{Pa\\,(\\mathrm{W\\,m^{-2}})^{-1}}$），并为每个时间步 $i$ 构建 $D_i = c \\cdot \\left(R_{n,i} - G_i\\right)$，然后通过 $\\mathrm{RH}_i = 1 - D_i / e_s(T_i)$ 计算 $\\mathrm{RH}_i$。使用这些 $\\mathrm{RH}_i$ 值进行分析。\n  - 标称参数：$r_s = 120\\,\\mathrm{s\\,m^{-1}}$，$r_a = 50\\,\\mathrm{s\\,m^{-1}}$。\n\n编程要求：\n\n- 实施该分析并为每个案例计算条件数 $\\kappa$。如果在筛选后有效时间步少于两个，或者最小奇异值在数值上为零，则为该案例报告 $\\kappa = \\infty$。\n- 必须严格按照上文规定的数值和物理常数进行计算。\n- 不涉及角度单位；不需要任何角度单位。\n- 最终输出格式：您的程序应生成单行输出，其中包含案例 A、B、C 和 D 的条件数（按此顺序排列），四舍五入到 $6$ 位小数，并以逗号分隔的列表形式包含在方括号中（例如，$\\left[\\kappa_A,\\kappa_B,\\kappa_C,\\kappa_D\\right]$）。这些值是无量纲的。\n\n您的解决方案必须是一个完整的、可运行的程序，从头开始执行所有计算，无需任何用户输入或外部数据。",
            "solution": "该问题要求在 Penman-Monteith 地表能量平衡模型框架内，对地表阻力 $r_s$ 和空气动力学阻力 $r_a$ 参数执行计算可识别性分析。该分析基于对模型敏感度矩阵的共线性诊断。\n\n### 1. 可识别性分析原理\n\n参数可识别性评估的是模型的参数是否可以从可用数据中被唯一确定。一种常见的方法是敏感度分析。如果模型输出对两个不同参数变化的敏感度相似，那么就很难区分它们各自的影响，从而导致可识别性差。这被称为参数共线性。\n\n我们构建一个敏感度矩阵 $S$，其列是在一系列测量（时间步）中，模型输出（潜热通量 $LE$）对每个参数（$r_s$ 和 $r_a$）的敏感度。$S$ 的列之间的共线性表明参数无法被独立识别。这种共线性可以通过矩阵 $S$ 的条件数 $\\kappa$ 来量化，该条件数从其奇异值分解（SVD）中获得。高条件数表示强共线性，即可识别性差。\n\n### 2. 模型公式\n\n分析的核心是用于计算潜热通量（$LE$，单位 $\\mathrm{W\\,m^{-2}}$）的 Penman-Monteith 方程：\n$$ LE = \\frac{\\Delta (R_n - G) + \\rho c_p \\frac{D}{r_a}}{\\Delta + \\gamma \\left(1 + \\frac{r_s}{r_a}\\right)} $$\n其中待识别的参数为 $p = [r_s, r_a]^T$。其他变量和常数定义如下：\n- $R_n$：净辐射（$\\mathrm{W\\,m^{-2}}$）\n- $G$：地表热通量（$\\mathrm{W\\,m^{-2}}$）\n- $\\Delta$：饱和水汽压曲线的斜率（$\\mathrm{Pa\\,K^{-1}}$）\n- $\\rho$：空气密度（$\\mathrm{kg\\,m^{-3}}$）\n- $c_p$：空气定压比热容（$1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$）\n- $D$：水汽压亏绌（$\\mathrm{Pa}$）\n- $\\gamma$：干湿表常数（$\\mathrm{Pa\\,K^{-1}}$）\n- $r_s$：地表阻力（$\\mathrm{s\\,m^{-1}}$）\n- $r_a$：空气动力学阻力（$\\mathrm{s\\,m^{-1}}$）\n\n这些量是根据气象数据，使用以下标准关系式确定的：\n- 温度为 $T$（单位 $^{\\circ}\\mathrm{C}$）时的饱和水汽压：\n  $$ e_s(T) = 610.78 \\exp\\left(\\frac{17.2694\\,T}{T + 237.3}\\right) $$\n- 饱和水汽压曲线的斜率：\n  $$ \\Delta(T) = \\frac{d e_s}{d T} = e_s(T) \\cdot \\frac{17.2694 \\cdot 237.3}{(T + 237.3)^2} $$\n- 由相对湿度 $\\mathrm{RH}$（小数）计算的水汽压亏绌：\n  $$ D = (1 - \\mathrm{RH}) e_s(T) $$\n- 根据理想气体定律计算的空气密度，其中绝对温度 $T_K = T + 273.15$：\n  $$ \\rho = \\frac{P}{R_d\\, T_K} $$\n- 干湿表常数：\n  $$ \\gamma = \\frac{c_p\\, P}{0.622\\, L_v} $$\n所用常数为：大气压 $P = 101325\\,\\mathrm{Pa}$，干空气比气体常数 $R_d = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，以及蒸发潜热 $L_v = 2.45 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$。\n\n### 3. 敏感度矩阵构建\n\n为了分析可识别性，我们计算 $LE$ 相对于 $r_s$ 和 $r_a$ 的偏导数。为清晰起见，我们将 $LE$ 方程重写为分子 $N$ 和分母 $M$ 的比值形式：\n$$ LE = \\frac{N(r_a)}{M(r_s, r_a)} = \\frac{\\Delta (R_n - G) + \\rho c_p D r_a^{-1}}{\\Delta + \\gamma + \\gamma r_s r_a^{-1}} $$\n\n**相对于 $r_s$ 的偏导数**：\n参数 $r_s$ 仅出现在分母 $M$ 中。\n$$ \\frac{\\partial M}{\\partial r_s} = \\frac{\\partial}{\\partial r_s} \\left(\\Delta + \\gamma + \\gamma r_s r_a^{-1}\\right) = \\gamma r_a^{-1} $$\n使用商法则，我们得到：\n$$ \\frac{\\partial LE}{\\partial r_s} = -\\frac{N}{M^2} \\frac{\\partial M}{\\partial r_s} = -\\frac{LE}{M} (\\gamma r_a^{-1}) = -\\frac{LE}{\\Delta + \\gamma(1 + r_s/r_a)} \\frac{\\gamma}{r_a} $$\n\n**相对于 $r_a$ 的偏导数**：\n参数 $r_a$ 同时出现在 $N$ 和 $M$ 中。\n$$ \\frac{\\partial N}{\\partial r_a} = -\\rho c_p D r_a^{-2} $$\n$$ \\frac{\\partial M}{\\partial r_a} = -\\gamma r_s r_a^{-2} $$\n应用商法则 $\\frac{d}{dx}(\\frac{u}{v}) = \\frac{u'v - uv'}{v^2}$：\n$$ \\frac{\\partial LE}{\\partial r_a} = \\frac{1}{M^2} \\left[ \\left(-\\rho c_p D r_a^{-2}\\right)M - N\\left(-\\gamma r_s r_a^{-2}\\right) \\right] $$\n$$ \\frac{\\partial LE}{\\partial r_a} = \\frac{r_a^{-2}}{M^2} \\left[ \\gamma r_s N - \\rho c_p D M \\right] $$\n代入 $N$ 和 $M$ 的表达式并化简，分子变为：\n$$ \\gamma r_s \\left(\\Delta (R_n-G) + \\rho c_p D r_a^{-1}\\right) - \\rho c_p D \\left(\\Delta + \\gamma + \\gamma r_s r_a^{-1}\\right) = \\gamma r_s \\Delta (R_n-G) - \\rho c_p D (\\Delta + \\gamma) $$\n因此，偏导数为：\n$$ \\frac{\\partial LE}{\\partial r_a} = \\frac{\\gamma r_s \\Delta (R_n-G) - \\rho c_p D (\\Delta + \\gamma)}{r_a^2 \\left(\\Delta + \\gamma(1 + r_s/r_a)\\right)^2} $$\n\n问题要求构建一个无量纲的相对敏感度矩阵 $S$，其中对于每个时间步 $i$，其元素为：\n$$ S_{i,1} = \\frac{r_s}{LE_i}\\,\\frac{\\partial LE_i}{\\partial r_s}, \\quad S_{i,2} = \\frac{r_a}{LE_i}\\,\\frac{\\partial LE_i}{\\partial r_a} $$\n任何 $|LE_i|  10^{-6}\\,\\mathrm{W\\,m^{-2}}$ 的时间步 $i$ 都被排除。\n\n### 4. 共线性诊断与算法\n\n通过计算矩阵 $S$ 的条件数 $\\kappa$ 来诊断可识别性。\n1.  **构建 $S$**：对于给定案例，遍历每个时间步。计算所有气象驱动因子，然后使用标称参数值计算 $LE_i$。如果 $|LE_i| \\ge 10^{-6}$，则计算偏导数和敏感度矩阵的相应行 $(S_{i,1}, S_{i,2})$。\n2.  **筛选与检查**：收集所有有效行以构成矩阵 $S$。如果有效行数少于 2，则矩阵是欠定的，我们设定 $\\kappa = \\infty$。\n3.  **SVD**：对 $S$ 执行奇异值分解，以获得其奇异值 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge 0$。对于我们的 $m \\times 2$ 矩阵，我们关心的是两个奇异值 $\\sigma_{\\max} = \\sigma_1$ 和 $\\sigma_{\\min} = \\sigma_2$。\n4.  **条件数**：条件数是最大奇异值与最小奇异值的比值：\n    $$ \\kappa = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} $$\n    如果 $\\sigma_{\\min}$ 在数值上为零（例如，低于某个小的机器精度阈值），则矩阵是秩亏的，表示完全共线性。在这种情况下，$\\kappa = \\infty$。\n\n小的 $\\kappa$（接近 1）意味着 $S$ 的列接近正交，参数 $r_s$ 和 $r_a$ 具有良好的可识别性。大的 $\\kappa$ 意味着列接近平行（共线性），参数的可识别性差。以下程序为四个给定的测试案例实现了此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs computational identifiability analysis for the Penman-Monteith equation\n    parameters rs and ra for four different meteorological cases.\n    \"\"\"\n\n    # Define physical and numerical constants as per the problem statement\n    c_p = 1004.0  # J kg^-1 K^-1\n    P = 101325.0  # Pa\n    L_v = 2.45e6  # J kg^-1\n    R_d = 287.0  # J kg^-1 K^-1\n    le_threshold = 1.0e-6 # W m^-2\n\n    # Test suite from the problem statement\n    test_cases = {\n        \"A\": {\n            \"T\": np.array([20, 22, 24, 26, 28, 30, 25, 27, 29, 31, 23, 21]),\n            \"RH\": np.array([0.4, 0.35, 0.3, 0.45, 0.5, 0.55, 0.6, 0.65, 0.5, 0.45, 0.4, 0.35]),\n            \"Rn\": np.array([600, 650, 700, 550, 500, 450, 400, 350, 300, 250, 200, 150]),\n            \"G\": np.array([50, 60, 70, 40, 30, 25, 20, 15, 10, 10, 5, 5]),\n            \"params\": {\"rs\": 120.0, \"ra\": 50.0}\n        },\n        \"B\": {\n            \"T\": np.array([20, 21, 20.5, 21.5, 20.8, 21.2, 20.3, 21.1, 20.7, 21.4]),\n            \"RH\": np.array([0.95, 0.97, 0.96, 0.95, 0.98, 0.97, 0.96, 0.99, 0.95, 0.96]),\n            \"Rn\": np.array([600, 580, 590, 610, 605, 595, 600, 590, 610, 600]),\n            \"G\": np.array([50, 50, 50, 50, 50, 50, 50, 50, 50, 50]),\n            \"params\": {\"rs\": 150.0, \"ra\": 60.0}\n        },\n        \"C\": {\n            \"T\": np.array([15, 16, 15.5, 16.5, 15.2, 16.2, 15.1, 16.1]),\n            \"RH\": np.array([0.5, 0.55, 0.6, 0.65, 0.6, 0.55, 0.5, 0.45]),\n            \"Rn\": np.array([30, 25, 20, 15, 10, 5, 0, 10]),\n            \"G\": np.array([20, 15, 10, 10, 8, 5, 5, 8]),\n            \"params\": {\"rs\": 100.0, \"ra\": 30.0}\n        },\n        \"D\": {\n            \"T\": np.array([25, 26, 27, 28, 29, 30, 31, 32]),\n            \"RH\": None, # To be computed\n            \"Rn\": np.array([400, 450, 500, 350, 300, 250, 200, 150]),\n            \"G\": np.array([50, 50, 50, 40, 40, 30, 20, 10]),\n            \"params\": {\"rs\": 120.0, \"ra\": 50.0}\n        }\n    }\n\n    # Calculate constant gamma\n    gamma = (c_p * P) / (0.622 * L_v)\n\n    results = []\n\n    for case_name in [\"A\", \"B\", \"C\", \"D\"]:\n        case_data = test_cases[case_name]\n        T_celsius = case_data[\"T\"]\n        RH = case_data[\"RH\"]\n        Rn = case_data[\"Rn\"]\n        G = case_data[\"G\"]\n        rs = case_data[\"params\"][\"rs\"]\n        ra = case_data[\"params\"][\"ra\"]\n\n        # Calculate auxiliary variables for all time steps\n        T_kelvin = T_celsius + 273.15\n        es = 610.78 * np.exp((17.2694 * T_celsius) / (T_celsius + 237.3))\n        Delta = es * (17.2694 * 237.3) / ((T_celsius + 237.3)**2)\n        rho = P / (R_d * T_kelvin)\n        A = Rn - G # Available energy\n\n        # Special handling for Case D\n        if case_name == \"D\":\n            c = 4.0\n            D = c * A\n            RH = 1.0 - D / es\n        else:\n            D = (1.0 - RH) * es\n\n        S_list = []\n        for i in range(len(T_celsius)):\n            # Numerator and denominator of Penman-Monteith equation\n            N = Delta[i] * A[i] + rho[i] * c_p * D[i] / ra\n            M = Delta[i] + gamma * (1.0 + rs / ra)\n\n            # Avoid division by zero in M\n            if abs(M)  1e-15:\n                continue\n\n            LE = N / M\n            \n            # Filter time steps with near-zero LE\n            if abs(LE)  le_threshold:\n                continue\n            \n            # Partial derivative w.r.t rs\n            dLE_drs = - (LE / M) * (gamma / ra)\n            \n            # Partial derivative w.r.t ra\n            dLE_dra_num = gamma * rs * Delta[i] * A[i] - rho[i] * c_p * D[i] * (Delta[i] + gamma)\n            dLE_dra = dLE_dra_num / (ra**2 * M**2)\n\n            # Relative sensitivities\n            S_i1 = (rs / LE) * dLE_drs\n            S_i2 = (ra / LE) * dLE_dra\n            \n            S_list.append([S_i1, S_i2])\n            \n        # Perform SVD and calculate condition number\n        if len(S_list)  2:\n            kappa = np.inf\n        else:\n            S = np.array(S_list)\n            try:\n                singular_values = np.linalg.svd(S, compute_uv=False)\n                sigma_max = singular_values[0]\n                sigma_min = singular_values[1] # Matrix has 2 columns\n                \n                if sigma_min  1e-15: # Numerically zero\n                    kappa = np.inf\n                else:\n                    kappa = sigma_max / sigma_min\n            except np.linalg.LinAlgError:\n                kappa = np.inf\n        \n        results.append(kappa)\n\n    # Format and print the final result\n    print(f\"[{','.join(f'{r:.6f}' if r != np.inf else 'inf' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}