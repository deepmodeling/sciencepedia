{
    "hands_on_practices": [
        {
            "introduction": "像Green-Ampt这样的入渗模型依赖于代表物理土壤特性的参数。本练习将演示如何直接从标准的土壤核心样本测量中推导出一个关键参数——湿润锋前后的体积含水量变化量（$\\Delta\\theta$）。通过将具体的现场数据与抽象的模型变量联系起来，您将更深入地理解入渗模型的物理基础。",
            "id": "3885489",
            "problem": "像格林-安普特（Green-Ampt）入渗模型这样的锋面近似法，将降雨入渗到均质土壤的过程概念化为一个双区域问题：锋前是一个初始非饱和区，其体积含水量为 $\\theta_{i}$；锋后是一个完全湿润区。在忽略空气滞留的假设下，湿润区被视为完全饱和。使用控制体分析和跨越湿潤锋面的质量守恒，锋面两侧的体积含水量变化量 $\\Delta \\theta$ 定义为湿润区含水量与初始含水量之差。\n\n考虑一个从均质表层土中采集的田间土芯样品，在一次入渗事件中，湿润锋面将保持在该土层内。该样品是使用已知内部容积的不锈钢环刀采集的。获得了以下测量数据：\n- 土芯体积 $V_{\\text{core}} = 100.0\\,\\text{cm}^{3}$，\n- 湿重 $m_{\\text{wet}} = 164.2\\,\\text{g}$，\n- 烘干重 $m_{\\text{dry}} = 149.3\\,\\text{g}$，\n- 水的密度 $\\rho_{w} = 1.000\\,\\text{g}\\,\\text{cm}^{-3}$，\n- 土壤颗粒密度（比重瓶法测得）$\\rho_{s} = 2.650\\,\\text{g}\\,\\text{cm}^{-3}$。\n\n从体积含水量和孔隙度的基本定义以及湿润锋后完全饱和的假设出发，推导出一个用可测量量表示的 $\\Delta \\theta$ 的解析表达式。然后，利用所给数据计算 $\\Delta \\theta$ 的值。明确说明所做的任何理想化假设。将最终的 $\\Delta \\theta$ 四舍五入至四位有效数字。将最终结果表示为无量纲的小数。最终答案中不要包含单位。\n\n时域反射法（TDR）和重量法是估算 $\\theta_{i}$ 的常用方法；此处，请使用所提供的重量法样品测量值来计算初始体积含水量 $\\theta_{i}$。",
            "solution": "格林-安普特（Green-Ampt）入渗概念模型依赖于一个清晰的湿润锋面，它将初始非饱和区与饱和（或近饱和）区隔开。其基本原理是应用于代表性基本体积的质量守恒定律以及土壤性质的本构定义：\n- 体积含水量 $\\theta$ 定义为单位总体积土壤中所含水的体积，\n- 孔隙度 $\\phi$ 是孔隙所占总体积的比例，\n- 在完全饱和且忽略空气滞留的情况下，饱和体积含水量等于孔隙度。\n\n我们分两步进行：首先从定义和假设推导出 $\\Delta \\theta$，然后根据现场测量值计算 $\\theta_{i}$ 和 $\\phi$。\n\n1. 定义与控制体分析。\n考虑一个随湿润锋面移动的控制体 $V$。锋前，体积含水量为 $\\theta_{i}$。锋后，在完全饱和条件下，体积含水量为 $\\theta_{s}$。跨越锋面的含水量跃变为\n$$\n\\Delta \\theta = \\theta_{s} - \\theta_{i}.\n$$\n假设锋后空气滞留可忽略不计且完全饱和，\n$$\n\\theta_{s} \\approx \\phi,\n$$\n其中 $\\phi$ 是孔隙度。因此，目标解析表达式为\n$$\n\\Delta \\theta = \\phi - \\theta_{i}.\n$$\n我们现在用可测量的量来表示 $\\phi$ 和 $\\theta_{i}$。\n\n2. 从容重和颗粒密度计算孔隙度。\n孔隙度 $\\phi$ 可由固体体积和孔隙体积的体积平均得到：\n$$\n\\phi = 1 - \\frac{\\rho_{b}}{\\rho_{s}},\n$$\n其中 $\\rho_{b}$ 是容重（单位总体积的干土质量），$\\rho_{s}$ 是颗粒密度（单位固体体积的固体质量）。容重由烘干重和土芯体积计算得出：\n$$\n\\rho_{b} = \\frac{m_{\\text{dry}}}{V_{\\text{core}}}.\n$$\n使用所给数据，\n$$\n\\rho_{b} = \\frac{149.3\\,\\text{g}}{100.0\\,\\text{cm}^{3}} = 1.493\\,\\text{g}\\,\\text{cm}^{-3}.\n$$\n因此，\n$$\n\\phi = 1 - \\frac{1.493}{2.650} = 1 - \\frac{1493}{2650} = 1 - 0.563396226415094 \\approx 0.436603773584906.\n$$\n\n3. 从重量法采样计算初始体积含水量。\n初始体积含水量 $\\theta_{i}$ 是样品中水的体积与样品总体积之比：\n$$\n\\theta_{i} = \\frac{V_{w}}{V_{\\text{core}}} = \\frac{m_{w}/\\rho_{w}}{V_{\\text{core}}},\n$$\n其中 $m_{w} = m_{\\text{wet}} - m_{\\text{dry}}$ 是样品中水的质量，$\\rho_{w}$ 是水的密度。计算 $m_{w}$：\n$$\nm_{w} = 164.2 - 149.3 = 14.9\\,\\text{g}.\n$$\n假设 $\\rho_{w} = 1.000\\,\\text{g}\\,\\text{cm}^{-3}$，\n$$\nV_{w} = \\frac{14.9\\,\\text{g}}{1.000\\,\\text{g}\\,\\text{cm}^{-3}} = 14.9\\,\\text{cm}^{3}.\n$$\n因此，\n$$\n\\theta_{i} = \\frac{14.9}{100.0} = 0.149.\n$$\n\n4. 计算 $\\Delta \\theta$。\n综合以上结果：\n$$\n\\Delta \\theta = \\phi - \\theta_{i} \\approx 0.436603773584906 - 0.149 = 0.287603773584906.\n$$\n\n明确说明的理想化假设：\n- 湿润锋面是清晰的，分隔了含水量均匀的不同区域。\n- 忽略了空气滞留；湿润区被视为完全饱和，因此有 $\\theta_{s} \\approx \\phi$。\n- 在田间条件下，水的密度取为 $\\rho_{w} = 1.000\\,\\text{g}\\,\\text{cm}^{-3}$。\n- 在湿润锋面所及深度内，土层是均质的。\n\n按要求四舍五入至四位有效数字：\n$$\n\\Delta \\theta \\approx 0.2876.\n$$\n这是一个无量纲的小数。",
            "answer": "$$\\boxed{0.2876}$$"
        },
        {
            "introduction": "敏感性分析是一种强大的建模技术，用于探究模型输出如何响应输入参数的变化。本练习要求您研究积水时间（$t_p$）对饱和导水率（$K_s$）的敏感性。此分析不仅仅是数学推演，它揭示了当降雨强度接近土壤入渗能力时系统行为的临界特性，这是预测径流生成的关键概念。",
            "id": "3885470",
            "problem": "一个均质的深厚土壤剖面，受到速率为 $i$ (长度/时间) 的空间均匀、强度恒定的降雨。土壤的初始体积含水量均匀为 $\\theta_{i}$，其入渗过程由 Green-Ampt (GA) 入渗模型控制。在 GA 模型中，时间 $t$ 时的入渗能力取决于累积入渗量 $F(t)$，这是通过一个移动湿润锋近似来实现的，其中一个陡峭的湿润锋将上方的饱和土壤与下方的初始干燥土壤分开。设饱和导水率为 $K_{s}$ (长度/时间)，湿润锋毛管吸力水头为 $\\psi_{f}$ (长度)，锋面上的含水量跃变为 $\\Delta \\theta = \\theta_{s} - \\theta_{i}$ (无量纲)，其中 $\\theta_{s}$ 为饱和含水量。积水是指当降雨率超过入渗能力时地表开始积水的现象；在积水之前，入渗率等于降雨率。\n\n从 GA 入渗能力关系式和积水前的水量平衡出发，推导积水时间 $t_{p}$ 作为 $K_{s}$、$\\psi_{f}$、$\\Delta \\theta$ 和 $i$ 的函数的解析表达式。然后，通过计算偏导数 $\\partial t_{p} / \\partial K_{s}$，来计算积水时间对饱和导水率的敏感性。最后，在降雨强度略大于饱和导水率的情况下，即 $i = K_{s} + \\varepsilon$ 且 $\\varepsilon  0$ 和 $\\varepsilon \\ll K_{s}$，解释 $\\partial t_{p} / \\partial K_{s}$ 的符号和大小，并评论该敏感性如何随 $\\varepsilon$ 变化。\n\n将您的最终答案表示为 $\\partial t_{p}/\\partial K_{s}$ 的单个闭式解析表达式。不得代入数值，最终方框内的表达式不应包含单位。在您的解题过程中，使用基本量纲说明 $\\partial t_{p}/\\partial K_{s}$ 的量纲形式。",
            "solution": "首先，我们推导积水时间 $t_{p}$ 的表达式。根据Green-Ampt 模型，入渗能力 $f_{p}$ 作为累积入渗量 $F(t)$ 的函数，由下式给出：\n$$f_{p}(t) = K_{s} \\left( 1 + \\frac{\\psi_{f} \\Delta\\theta}{F(t)} \\right)$$\n其中 $K_{s}$ 是饱和导水率，$\\psi_{f}$ 是湿润锋毛管吸力水头，$\\Delta\\theta$ 是湿润锋两侧的体积含水量变化。\n\n在积水之前，即时间 $t  t_{p}$ 时，土壤可以吸收所有进入的降雨。因此，入渗率 $f(t)$ 等于恒定的降雨强度 $i$。\n$$f(t) = i, \\quad \\text{当 } t  t_{p}$$\n积水前任意时刻 $t$ 的累积入渗量是入渗率的积分：\n$$F(t) = \\int_{0}^{t} f(\\tau) d\\tau = \\int_{0}^{t} i d\\tau = it$$\n当降雨强度 $i$ 等于土壤的入渗能力 $f_{p}(t_{p})$ 时，积水在时间 $t_{p}$ 发生。由于 $f_{p}$ 随着 $F(t)$ 的增加从无穷大减小并渐近于 $K_{s}$，因此该条件只有在 $i > K_{s}$ 时才可能成立。在积水发生的瞬间，我们有：\n$$i = f_{p}(t_{p})$$\n积水时的累积入渗量 $F(t_{p})$ 由下式给出：\n$$F(t_{p}) = i t_{p}$$\n将 $F(t_{p})$ 的这个表达式代入积水时的 Green-Ampt 入渗能力方程，得到：\n$$i = K_{s} \\left( 1 + \\frac{\\psi_{f} \\Delta\\theta}{F(t_{p})} \\right) = K_{s} \\left( 1 + \\frac{\\psi_{f} \\Delta\\theta}{i t_{p}} \\right)$$\n我们现在求解这个方程以得到积水时间 $t_{p}$：\n$$\\frac{i}{K_{s}} = 1 + \\frac{\\psi_{f} \\Delta\\theta}{i t_{p}}$$\n$$\\frac{i}{K_{s}} - 1 = \\frac{\\psi_{f} \\Delta\\theta}{i t_{p}}$$\n$$\\frac{i - K_{s}}{K_{s}} = \\frac{\\psi_{f} \\Delta\\theta}{i t_{p}}$$\n$$t_{p} = \\frac{K_{s} \\psi_{f} \\Delta\\theta}{i(i - K_{s})}$$\n这就是积水时间的解析表达式。\n\n第二，我们通过计算偏导数 $\\partial t_{p} / \\partial K_{s}$ 来计算积水时间对饱和导水率的敏感性。我们将 $i$、$\\psi_{f}$ 和 $\\Delta\\theta$ 视为常数。为清晰起见，我们将常数项组合在一起：\n$$t_{p}(K_{s}) = \\left( \\frac{\\psi_{f} \\Delta\\theta}{i} \\right) \\left( \\frac{K_{s}}{i - K_{s}} \\right)$$\n使用微分法的商法则 $\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^{2}}$，其中 $u=K_{s}$，$v=i-K_{s}$：\n$$\\frac{\\partial}{\\partial K_{s}} \\left( \\frac{K_{s}}{i - K_{s}} \\right) = \\frac{\\left(\\frac{\\partial K_{s}}{\\partial K_{s}}\\right)(i - K_{s}) - K_{s}\\left(\\frac{\\partial(i-K_{s})}{\\partial K_{s}}\\right)}{(i - K_{s})^{2}}$$\n$$\\frac{\\partial}{\\partial K_{s}} \\left( \\frac{K_{s}}{i - K_{s}} \\right) = \\frac{(1)(i - K_{s}) - K_{s}(-1)}{(i - K_{s})^{2}} = \\frac{i - K_{s} + K_{s}}{(i - K_{s})^{2}} = \\frac{i}{(i - K_{s})^{2}}$$\n将此结果代回敏感性的表达式中，得到：\n$$\\frac{\\partial t_{p}}{\\partial K_{s}} = \\left( \\frac{\\psi_{f} \\Delta\\theta}{i} \\right) \\left( \\frac{i}{(i - K_{s})^{2}} \\right)$$\n$$\\frac{\\partial t_{p}}{\\partial K_{s}} = \\frac{\\psi_{f} \\Delta\\theta}{(i - K_{s})^{2}}$$\n这就是敏感性的最终解析表达式。\n\n$\\partial t_{p} / \\partial K_{s}$ 的量纲形式可以由时间 ($T$) 和长度 ($L$) 的基本量纲确定。\n$$[\\frac{\\partial t_{p}}{\\partial K_{s}}] = \\frac{[t_{p}]}{[K_{s}]} = \\frac{T}{L T^{-1}} = L^{-1} T^{2}$$\n\n第三，我们针对特定情境 $i = K_{s} + \\varepsilon$（其中 $\\varepsilon > 0$ 且 $\\varepsilon \\ll K_{s}$）来解释该敏感性的符号和大小。\n$\\partial t_{p} / \\partial K_{s}$ 的符号由其各组成部分决定。吸力水头 $\\psi_{f}$ 是一个正量 ($L$)，对于初始非饱和土壤，含水量差异 $\\Delta\\theta = \\theta_s - \\theta_i$ 是正的，而分母 $(i - K_{s})^{2}$ 是一个平方项，因此（对于 $i \\neq K_{s}$）为正。因此，$\\partial t_{p} / \\partial K_{s}$ 严格为正。这意味着增加饱和导水率会增加积水时间，这在物理上是直观的：能够更有效地传输水分的土壤，需要更长的时间才会被给定的降雨率所淹没。\n\n为了分析其大小，我们将 $i = K_{s} + \\varepsilon$ 代入敏感性表达式中：\n$$\\frac{\\partial t_{p}}{\\partial K_{s}} = \\frac{\\psi_{f} \\Delta\\theta}{((K_{s} + \\varepsilon) - K_{s})^{2}} = \\frac{\\psi_{f} \\Delta\\theta}{\\varepsilon^{2}}$$\n这个结果表明，积水时间对饱和导水率变化的敏感性与 $\\varepsilon^{-2}$ 成比例。随着降雨强度 $i$ 接近饱和导水率 $K_{s}$（即，当 $\\varepsilon \\to 0^{+}$ 时），敏感性变得极大。这表明在阈值 $i=K_{s}$ 附近存在一种临界行为。在这种情况下， $K_{s}$ 的一个非常小的变化会导致积水时间 $t_{p}$ 发生不成比例的巨大变化。例如，$K_{s}$ 的微小增加会急剧减小“超额”降雨率 $\\varepsilon = i - K_{s}$，这反过来又会大大延迟积水的发生。",
            "answer": "$$\\boxed{\\frac{\\psi_{f} \\Delta\\theta}{(i - K_{s})^{2}}}$$"
        },
        {
            "introduction": "虽然解析解能提供深刻见解，但许多实际建模问题需要借助数值方法。Green-Ampt模型在发生地表积水后的阶段，其累积入渗量由一个无法直接求解的隐式方程描述。本动手编码练习将指导您实现牛顿-拉夫逊（Newton-Raphson）算法来求解此方程，从而掌握应用数值技术解决复杂环境模型的基本技能。",
            "id": "3885467",
            "problem": "考虑在具有陡峭湿润锋的 Green-Ampt 模型下，水入渗到均质土柱中。在地表积水发生于时间 $t_p$、累积入渗量为 $F_p$ 之后，于更晚的时间 $t$ 的累积入渗量 $F$ 满足一个形如下式的隐式关系\n$$\ng(F) = (F - F_p) - \\psi_f \\Delta \\theta \\,\\ln\\left(\\frac{F + \\psi_f \\Delta \\theta}{F_p + \\psi_f \\Delta \\theta}\\right) - K_s (t - t_p) = 0,\n$$\n其中 $F$ 和 $F_p$ 是以米为单位表示的累积入渗量，$\\psi_f$ 是以米为单位表示的湿润锋毛管吸力水头，$\\Delta \\theta$ 是定义为 $\\Delta \\theta = \\theta_s - \\theta_i$ 的含水量亏缺（无量纲），$K_s$ 是以米/秒为单位表示的饱和导水率，以及 $t - t_p$ 是以秒为单位表示的自积水以来的时间。从多孔介质中一维垂直流的连续性经典概念和达西定律，以及 Green-Ampt 陡峭锋理想化出发，上述隐式关系是通过平衡积分通量和湿润锋势贡献得出的；然而，除了给定的隐式形式外，您不应使用任何快捷公式。\n\n您的任务是实现一个鲁棒的牛顿-拉夫逊算法来求解 $g(F) = 0$ 以得到 $F$，该算法需在物理上可接受的条件下（$F \\ge 0$, $\\psi_f > 0$, $\\Delta \\theta > 0$, $K_s > 0$, $t \\ge t_p$）运行。通过显式求导 $g'(F)$ 并用它来构建牛顿步长，从而推导出所需的更新规则。基于残差和步长容差建立合理的收敛准则，并包含保障措施以维持物理可行性（例如，对数定义域约束 $F + \\psi_f \\Delta \\theta > 0$ 和 $F$ 的非负性）。当 $t = t_p$ 时，物理上正确的解是 $F = F_p$；将此视为一个精确的边界条件。\n\n用代码实现该算法，并将其应用于以下测试套件。所有参数值对于积水条件下的浅层入渗都是科学上合理的。对于每种情况，以米为单位表示最终的累积入渗量 $F$，并四舍五入到六位小数。\n\n- 情况 1：$F_p = 0.01$, $\\psi_f = 0.25$, $\\Delta \\theta = 0.35$, $K_s = 1\\times 10^{-6}$, $t - t_p = 3600$。\n- 情况 2（边界情况）：$F_p = 0.015$, $\\psi_f = 0.20$, $\\Delta \\theta = 0.30$, $K_s = 1\\times 10^{-6}$, $t - t_p = 0$。\n- 情况 3：$F_p = 0.005$, $\\psi_f = 0.40$, $\\Delta \\theta = 0.50$, $K_s = 5\\times 10^{-7}$, $t - t_p = 7200$。\n- 情况 4（接近饱和的初始土壤）：$F_p = 0.0$, $\\psi_f = 0.10$, $\\Delta \\theta = 0.05$, $K_s = 2\\times 10^{-6}$, $t - t_p = 1000$。\n- 情况 5（积水后长时间）：$F_p = 0.01$, $\\psi_f = 0.20$, $\\Delta \\theta = 0.25$, $K_s = 1\\times 10^{-5}$, $t - t_p = 86400$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[0.123456,0.234567,0.345678,0.456789,0.567890]$），每个条目是对应情况下计算出的 $F$ 值，单位为米，并四舍五入到六位小数。\n\n除了编写求解器代码外，还需从第一性原理推导牛顿-拉夫逊更新规则，并讨论数学上合理的收敛准则（残差容差、步长容差、由 $g'(F)$ 的符号决定的单调性和唯一性），以及为确保迭代保持在物理上可接受的域内而需要采取的保障措施，如区间限定或步长阻尼。不要引入任何未由给定隐式关系所暗示的无关公式。",
            "solution": "为了求解积水后累积入渗量 $F$ 的隐式方程 $g(F)=0$，我们采用牛顿-拉夫逊方法。该方法通过迭代逼近根，其更新规则为：\n$$F_{k+1} = F_k - \\frac{g(F_k)}{g'(F_k)}$$\n其中 $F_k$ 是第 $k$ 次迭代的估计值，$g'(F)$ 是 $g(F)$ 对 $F$ 的一阶导数。\n\n### 算法推导与分析\n\n**1. $g(F)$ 的导数**\n为了实现该算法，我们必须首先计算 $g'(F)$。设常数项 $C = \\psi_f \\Delta \\theta$。函数 $g(F)$ 可写为：\n$$g(F) = F - F_p - C \\left[ \\ln(F + C) - \\ln(F_p + C) \\right] - K_s (t - t_p)$$\n对 $F$ 求导，我们将 $F_p$, $C$, $K_s$, $t$ 和 $t_p$ 视为常数：\n$$g'(F) = \\frac{d}{dF} \\left( F - F_p - C \\ln(F + C) + C \\ln(F_p + C) - K_s (t - t_p) \\right)$$\n$$g'(F) = 1 - 0 - C \\cdot \\frac{1}{F+C} + 0 - 0 = 1 - \\frac{C}{F+C}$$\n$$g'(F) = \\frac{(F + C) - C}{F + C} = \\frac{F}{F + C}$$\n代回 $C = \\psi_f \\Delta \\theta$，导数为：\n$$g'(F) = \\frac{F}{F + \\psi_f \\Delta \\theta}$$\n\n**2. 函数性质与收敛性**\n- **单调性**：物理约束为 $\\psi_f > 0$ 和 $\\Delta\\theta > 0$，因此 $\\psi_f \\Delta\\theta > 0$。为了发生入渗，我们必须有 $F \\ge F_p \\ge 0$。只要 $F > 0$，$g'(F)$ 的分子和分母都为正，这意味着 $g'(F) > 0$。严格为正的一阶导数意味着 $g(F)$ 是 $F$ 在 $F > 0$ 时的单调递增函数。这个性质至关重要，因为它保证了如果根存在，则它是唯一的。\n- **凸性**：我们考察二阶导数 $g''(F)$：\n$$g''(F) = \\frac{d}{dF}\\left(\\frac{F}{F + C}\\right) = \\frac{1 \\cdot (F+C) - F \\cdot 1}{(F+C)^2} = \\frac{C}{(F+C)^2} = \\frac{\\psi_f \\Delta \\theta}{(F + \\psi_f \\Delta \\theta)^2}$$\n由于 $\\psi_f \\Delta \\theta > 0$ 且分母是平方项，$g''(F) > 0$ 对所有有效的 $F$ 均成立。这意味着函数 $g(F)$ 是严格凸的（上凹）。此性质确保了在任何一点的切线都位于函数曲线下方，这有利于牛顿-拉夫逊方法的收敛，特别是当从一个大于真根的初始猜测值开始时。\n\n**3. 初始猜测值 ($F_0$)**\n一个好的初始猜测值能提高收敛速度和稳定性。\n- **对于 $F_p > 0$**：积水时的初始入渗速率为 $f(t_p) = K_s \\left(1 + \\frac{\\psi_f \\Delta \\theta}{F_p}\\right)$。一阶欧拉线性外插为时间 $t$ 时的 $F$ 提供了一个合理的初始猜测值：\n  $$F_0 = F_p + f(t_p) \\cdot (t-t_p) = F_p + K_s \\left(1 + \\frac{\\psi_f \\Delta \\theta}{F_p}\\right) (t - t_p)$$\n  这个猜测值通常是一个高估值，将 $F_0$ 置于根的右侧，这对于凸函数是理想的。\n- **对于 $F_p = 0$**：上述公式是奇异的。对于入渗到初始即积水的干燥土壤，早期行为由吸渗率主导。累积入渗量近似为 $F \\approx \\sqrt{2 K_s \\psi_f \\Delta \\theta (t - t_p)}$。这提供了一个极好的初始猜测值：\n  $$F_0 = \\sqrt{2 (\\psi_f \\Delta \\theta) K_s (t - t_p)}$$\n\n**4. 收敛准则与实现细节**\n- **边界条件**：如果 $t - t_p = 0$，解为 $F = F_p$，无需迭代。\n- **收敛准则**：当函数残差 $|g(F_k)|$ 或步长 $|F_{k+1} - F_k|$ 小于预设容差时，迭代终止。同时设置最大迭代次数以防死循环。\n- **保障措施**：为保证迭代过程中的物理解（$F_k > F_p \\ge 0$），如果牛顿步长导致解超出物理域，可以采用步长减半（回溯）的方法进行修正，直至新的估计值位于有效域内。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the Green-Ampt infiltration problem for a suite of test cases.\n    \"\"\"\n\n    def solve_green_ampt_newton(Fp, psi_f, delta_theta, Ks, dt):\n        \"\"\"\n        Solves for cumulative infiltration F using the Newton-Raphson method.\n\n        Args:\n            Fp (float): Cumulative infiltration at ponding (m).\n            psi_f (float): Wetting front capillary suction head (m).\n            delta_theta (float): Moisture deficit (-).\n            Ks (float): Saturated hydraulic conductivity (m/s).\n            dt (float): Time since ponding, t - tp (s).\n\n        Returns:\n            float: Cumulative infiltration F (m).\n        \"\"\"\n        # Handle the boundary condition: at the moment of ponding, F = Fp.\n        if dt == 0:\n            return Fp\n\n        # Define constants and convergence parameters\n        C = psi_f * delta_theta\n        Kdt = Ks * dt\n        max_iter = 100\n        tol_res = 1e-12  # Residual tolerance for g(F)\n        tol_step = 1e-12 # Step-size tolerance for F\n\n        # --- Set up a physically-based initial guess (F_k) ---\n        if Fp > 0:\n            # For Fp > 0, use a first-order Euler extrapolation.\n            # This estimate is typically an upper bound, ideal for Newton's method on a convex function.\n            f_p = Ks * (1 + C / Fp)\n            F_k = Fp + f_p * dt\n        else: # Fp == 0\n            # For Fp == 0, the Euler formula is singular. Use the short-time sorptivity approximation.\n            # This expression is derived from the early-time behavior of the Green-Ampt model.\n            arg = 2 * C * Kdt\n            if arg  0: # Should not happen with valid physical parameters\n                arg = 0\n            F_k = np.sqrt(arg)\n\n        # To avoid division by zero if initial guess is exactly Fp==0\n        if F_k == Fp:\n            F_k = Fp + tol_step \n            \n        # --- Newton-Raphson Iteration ---\n        for _ in range(max_iter):\n            # Define g(F_k) and its derivative g'(F_k)\n            # g(F) = (F - Fp) - C * ln((F + C) / (Fp + C)) - Kdt = 0\n            # g'(F) = F / (F + C)\n            \n            # Check for domain validity of the logarithm\n            log_arg_num = F_k + C\n            log_arg_den = Fp + C\n            if log_arg_num = 0 or log_arg_den = 0:\n                # This should not be reached with proper safeguards, but is here for robustness\n                break\n\n            g_F = (F_k - Fp) - C * np.log(log_arg_num / log_arg_den) - Kdt\n\n            # Check for convergence based on residual\n            if abs(g_F)  tol_res:\n                break\n\n            gp_F = F_k / (F_k + C)\n\n            # Avoid division by zero if F_k is near 0 (can happen if Fp=0)\n            if abs(gp_F)  1e-12:\n                # Derivative is zero, method cannot proceed\n                break \n\n            # Calculate Newton step\n            delta_F = g_F / gp_F\n            F_next = F_k - delta_F\n\n            # --- Safeguard: Step Halving (Backtracking) ---\n            # Ensure the next iterate remains in the physical domain (F > Fp).\n            # The lower bound is Fp (or 0 if Fp=0).\n            lower_bound = Fp if Fp > 0 else 0\n            \n            # If the step overshoots into the non-physical domain, halve it.\n            # Given the function's convexity and good initial guess, this is mainly a safety measure.\n            while F_next = lower_bound:\n                delta_F /= 2.0\n                F_next = F_k - delta_F\n\n            # Check for convergence based on step size\n            if abs(F_next - F_k)  tol_step:\n                F_k = F_next\n                break\n            \n            F_k = F_next\n\n        return F_k\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (Fp, psi_f, delta_theta, Ks, t - tp)\n        (0.01, 0.25, 0.35, 1e-6, 3600),\n        (0.015, 0.20, 0.30, 1e-6, 0),\n        (0.005, 0.40, 0.50, 5e-7, 7200),\n        (0.0, 0.10, 0.05, 2e-6, 1000),\n        (0.01, 0.20, 0.25, 1e-5, 86400),\n    ]\n\n    results = []\n    for params in test_cases:\n        Fp, psi_f, d_theta, Ks, dt = params\n        F_result = solve_green_ampt_newton(Fp, psi_f, d_theta, Ks, dt)\n        results.append(F_result)\n\n    # Format results to six decimal places, ensuring trailing zeros are kept.\n    formatted_results = [\"{:.6f}\".format(r) for r in results]\n\n    # Format the final output string exactly as specified\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}