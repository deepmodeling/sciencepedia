{
    "hands_on_practices": [
        {
            "introduction": "我们将从最简单的湖泊概念模型——单个、完全混合的箱式模型——开始。这个练习旨在建立质量守恒的基本原则，这是所有环境模型的基石。通过推导溶质的稳态浓度，你将学习如何平衡输入、输出和内部反应，并理解水力停留时间这一关键概念的作用。",
            "id": "3887460",
            "problem": "一个混合均匀（零维）的湖泊可以被表示为一个单室，其中进入的溶质在整个水体中瞬时混合。考虑一个体积恒为 $V$ 的湖泊，其入水体积流量恒为 $Q$，入水溶质浓度为 $C_{\\mathrm{in}}$。出水体积流量等于入水流量，均为 $Q$，以确保水体体积恒定。溶质经历一级衰减，速率常数为 $k$（单位：每秒）。假设性质恒定且驱动力稳定。\n\n使用湖中溶质的质量守恒原理，推导稳态湖水溶质浓度的表达式，用 $V$、$Q$、$k$ 和 $C_{\\mathrm{in}}$ 表示。然后，使用以下参数值计算稳态浓度：\n- $V = 1.8 \\times 10^{9}\\ \\mathrm{m^{3}}$，\n- $Q = 150\\ \\mathrm{m^{3}\\ s^{-1}}$，\n- $k = 8.0 \\times 10^{-7}\\ \\mathrm{s^{-1}}$，\n- $C_{\\mathrm{in}} = 3.5\\ \\mathrm{mg\\ L^{-1}}$。\n\n将最终浓度以 $\\mathrm{mg\\ L^{-1}}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "题目要求推导一个混合均匀湖泊中稳态溶质浓度的表达式，并根据给定的一组参数进行数值计算。这个问题具有科学依据，提法明确，且是客观的。它是质量守恒原理的一个标准应用，通常被建模为连续搅拌釜反应器（CSTR）。所提供的数据是一致的，并且足以得到唯一解。\n\n首先，我们建立湖中溶质的质量平衡方程。质量守恒原理指出，控制体积内物质质量的变化率等于质量流入速率减去质量流出速率，再加上由反应引起的质量生成或消耗速率。\n\n设 $C(t)$ 为时刻 $t$ 湖中的溶质浓度，$V$ 为湖泊的恒定体积。湖中溶质的总质量为 $M(t) = V C(t)$。该质量的变化率为 $\\frac{dM}{dt}$。由于 $V$ 是常数，这等价于 $V \\frac{dC}{dt}$。\n\n质量平衡可以表示为：\n$$\n\\frac{dM}{dt} = (\\text{质量流入速率}) - (\\text{质量流出速率}) - (\\text{质量衰减速率})\n$$\n\n各项定义如下：\n1.  质量流入速率：水以体积流量 $Q$ 进入湖泊，溶质浓度为 $C_{\\mathrm{in}}$。质量流入速率为 $Q C_{\\mathrm{in}}$。\n2.  质量流出速率：湖泊是混合均匀的，因此流出水中的溶质浓度与湖内浓度 $C(t)$ 相同。质量流出速率为 $Q C(t)$。\n3.  质量衰减速率：溶质经历一级衰减过程，速率常数为 $k$。衰减速率与湖中存在的溶质总质量 $M(t)$ 成正比。质量衰减速率为 $k M(t) = k V C(t)$。\n\n将这些项代入质量平衡方程，得到湖中溶质浓度的控制常微分方程：\n$$\nV \\frac{dC}{dt} = Q C_{\\mathrm{in}} - Q C(t) - k V C(t)\n$$\n\n题目要求的是稳态浓度，我们将其记为 $C_{ss}$。在稳态下，湖中的浓度是恒定的，意味着其随时间的变化率为零。因此，我们令 $\\frac{dC}{dt} = 0$。将 $C(t) = C_{ss}$ 代入方程得到：\n$$\n0 = Q C_{\\mathrm{in}} - Q C_{ss} - k V C_{ss}\n$$\n\n现在我们可以用代数方法求解 $C_{ss}$：\n$$\nQ C_{ss} + k V C_{ss} = Q C_{\\mathrm{in}}\n$$\n从左侧提出公因子 $C_{ss}$：\n$$\nC_{ss} (Q + k V) = Q C_{\\mathrm{in}}\n$$\n分离出 $C_{ss}$，得到稳态浓度的一般表达式：\n$$\nC_{ss} = \\frac{Q C_{\\mathrm{in}}}{Q + k V}\n$$\n这也可以写成：\n$$\nC_{ss} = C_{\\mathrm{in}} \\left( \\frac{Q}{Q + k V} \\right)\n$$\n\n接下来，我们使用给定的数值来计算这个表达式：\n- $V = 1.8 \\times 10^{9}\\ \\mathrm{m^{3}}$\n- $Q = 150\\ \\mathrm{m^{3}\\ s^{-1}}$\n- $k = 8.0 \\times 10^{-7}\\ \\mathrm{s^{-1}}$\n- $C_{\\mathrm{in}} = 3.5\\ \\mathrm{mg\\ L^{-1}}$\n\n$Q$ 的单位（$\\mathrm{m^{3}\\ s^{-1}}$）和 $k V$ 的单位（$\\mathrm{s^{-1}} \\cdot \\mathrm{m^{3}} = \\mathrm{m^{3}\\ s^{-1}}$）是一致的。比值 $\\frac{Q}{Q + k V}$ 是无量纲的，所以 $C_{ss}$ 的单位将与 $C_{\\mathrm{in}}$ 的单位相同，即 $\\mathrm{mg\\ L^{-1}}$。\n\n首先，我们计算 $k V$ 这一项：\n$$\nk V = (8.0 \\times 10^{-7}\\ \\mathrm{s^{-1}}) \\times (1.8 \\times 10^{9}\\ \\mathrm{m^{3}}) = 1440\\ \\mathrm{m^{3}\\ s^{-1}}\n$$\n现在，我们计算分母 $(Q + k V)$：\n$$\nQ + k V = 150\\ \\mathrm{m^{3}\\ s^{-1}} + 1440\\ \\mathrm{m^{3}\\ s^{-1}} = 1590\\ \\mathrm{m^{3}\\ s^{-1}}\n$$\n最后，我们将这些值代入 $C_{ss}$ 的表达式中：\n$$\nC_{ss} = \\frac{150\\ \\mathrm{m^{3}\\ s^{-1}}}{1590\\ \\mathrm{m^{3}\\ s^{-1}}} \\times 3.5\\ \\mathrm{mg\\ L^{-1}}\n$$\n$$\nC_{ss} = \\frac{150}{1590} \\times 3.5\\ \\mathrm{mg\\ L^{-1}} \\approx 0.09433962 \\times 3.5\\ \\mathrm{mg\\ L^{-1}}\n$$\n$$\nC_{ss} \\approx 0.33018867\\ \\mathrm{mg\\ L^{-1}}\n$$\n题目要求答案四舍五入到四位有效数字。第五位有效数字是 $8$，所以我们将第四位数字向上舍入。\n$$\nC_{ss} \\approx 0.3302\\ \\mathrm{mg\\ L^{-1}}\n$$",
            "answer": "$$\\boxed{0.3302}$$"
        },
        {
            "introduction": "真实的湖泊并非均匀的箱体；它们具有垂直结构，这主要是由太阳能的吸收方式驱动的。本练习将从零维视角转向一维视角，运用比尔-朗伯定律模拟不同波长的光如何随深度衰减。你将推导垂直加热廓线，并计算由此引起的表层水温变化，这是理解湖泊热力分层的关键过程。",
            "id": "3887410",
            "problem": "一个小型贫营养湖泊的水面受到下行的短波太阳辐射照射。将入射光谱视为两个波段，其能量随深度通过与光谱相关的漫射衰减系数呈指数衰减。仅从一维垂直水柱中的能量守恒和比尔-朗伯定律出发，推导体积短波加热廓线 $Q_{SW}(z)$，然后通过深度积分计算其对充分混合的表层水温趋势的贡献。\n\n假设以下科学上合理的情景和参数：\n- 当地正午时，水面上方的下行短波通量为 $I_{0} = 250\\,\\mathrm{W\\,m^{-2}}$。\n- 在弱风条件下，水面的镜面反射率（反照率）为 $\\alpha = 0.06$，因此水面下方的净短波通量为 $I(0^{+}) = (1 - \\alpha) I_{0}$。\n- 两个光谱波段划分了水面下方的入射通量：蓝绿波段，其比例为 $f_{b} = 0.6$，漫射衰减系数为 $K_{b} = 0.25\\,\\mathrm{m^{-1}}$；以及红-近红外波段，其比例为 $f_{r} = 0.4$，漫射衰减系数为 $K_{r} = 2.5\\,\\mathrm{m^{-1}}$。这些比例满足 $f_{b} + f_{r} = 1$。\n- 正午时，湖泊有一个深度为 $h = 6\\,\\mathrm{m}$ 的均匀混合层，其密度为 $\\rho = 1000\\,\\mathrm{kg\\,m^{-3}}$，比热容为 $c_{p} = 4182\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 忽略长波辐射、感热和潜热通量以及任何侧向过程；将衰减系数视为有效属性，其考虑了每个波段中的吸收和散射损失。\n\n任务：\n1. 对每个波段使用比尔-朗伯定律，并结合薄层中的能量守恒，推导体积短波加热廓线 $Q_{SW}(z)$（单位为 $\\mathrm{W\\,m^{-3}}$）作为深度 $z \\ge 0$ 的函数表达式。\n2. 将 $Q_{SW}(z)$ 从 $z = 0$ 到 $z = h$ 积分，以获得输入到混合层的面热量 $H_{ML}$（单位为 $\\mathrm{W\\,m^{-2}}$）。\n3. 使用热力学第一定律形式的充分混合层热方程，将 $H_{ML}$ 转换为混合层的温度趋势 $\\partial T/\\partial t$。\n\n以 $\\mathrm{K\\,day^{-1}}$ 为单位表示您的最终答案。将最终答案四舍五入到三位有效数字。",
            "solution": "题目要求推导湖泊混合层因吸收短波太阳辐射而产生的温度趋势。整个过程始于能量守恒和辐射传输的基本原理，特别是比尔-朗伯定律。我们得到了一个用于太阳光谱的双波段模型。\n\n设 $z$ 为水面以下的深度，其中 $z=0$ 在水面，并向下增加。水面上方的下行短波辐照度（通量）为 $I_0$。一部分比例 $\\alpha$（反照率）被反射，因此水面正下方的净通量为 $I(0^+) = (1-\\alpha)I_0$。该净通量被分为两个光谱波段：比例为 $f_b$ 的蓝绿波段和比例为 $f_r$ 的红-近红外波段，其中 $f_b+f_r=1$。\n\n每个波段在水面正下方的初始通量为：\n$$I_b(0) = f_b I(0^+) = f_b (1-\\alpha) I_0$$\n$$I_r(0) = f_r I(0^+) = f_r (1-\\alpha) I_0$$\n\n根据比尔-朗伯定律，每个波段的辐照度随深度呈指数递减。各自的漫射衰减系数为 $K_b$ 和 $K_r$。在深度 $z$ 处，每个波段的辐照度由下式给出：\n$$I_b(z) = I_b(0) \\exp(-K_b z)$$\n$$I_r(z) = I_r(0) \\exp(-K_r z)$$\n\n在深度 $z$ 处的总下行短波辐照度是两个波段辐照度之和：\n$$I(z) = I_b(z) + I_r(z) = f_b (1-\\alpha) I_0 \\exp(-K_b z) + f_r (1-\\alpha) I_0 \\exp(-K_r z)$$\n$$I(z) = (1-\\alpha) I_0 \\left[ f_b \\exp(-K_b z) + f_r \\exp(-K_r z) \\right]$$\n\n**任务1：推导体积短波加热廓线 $Q_{SW}(z)$**\n\n体积加热率 $Q_{SW}(z)$ 是单位体积的能量吸收率。在一维垂直水柱中，能量守恒定律规定，局部加热率等于能量通量（辐照度）的负散度。对于垂直通量 $I(z)$，这由 $Q_{SW}(z) = -\\frac{dI(z)}{dz}$ 给出。\n\n我们计算 $I(z)$ 对 $z$ 的导数：\n$$\\frac{dI(z)}{dz} = \\frac{d}{dz} \\left( (1-\\alpha) I_0 \\left[ f_b \\exp(-K_b z) + f_r \\exp(-K_r z) \\right] \\right)$$\n$$\\frac{dI(z)}{dz} = (1-\\alpha) I_0 \\left[ f_b (-K_b) \\exp(-K_b z) + f_r (-K_r) \\exp(-K_r z) \\right]$$\n$$\\frac{dI(z)}{dz} = -(1-\\alpha) I_0 \\left[ f_b K_b \\exp(-K_b z) + f_r K_r \\exp(-K_r z) \\right]$$\n\n因此，体积加热廓线为：\n$$Q_{SW}(z) = -\\frac{dI(z)}{dz} = (1-\\alpha) I_0 \\left( f_b K_b \\exp(-K_b z) + f_r K_r \\exp(-K_r z) \\right)$$\n该表达式的单位为 $\\mathrm{W\\,m^{-3}}$，符合要求。\n\n**任务2：积分 $Q_{SW}(z)$ 以获得输入混合层的面热量 $H_{ML}$**\n\n在从 $z=0$ 到 $z=h$ 的混合层内，每单位面积吸收的总热量由 $Q_{SW}(z)$ 在此深度范围内的积分给出。\n$$H_{ML} = \\int_{0}^{h} Q_{SW}(z) dz$$\n代入 $Q_{SW}(z)$ 的表达式：\n$$H_{ML} = \\int_{0}^{h} (1-\\alpha) I_0 \\left( f_b K_b \\exp(-K_b z) + f_r K_r \\exp(-K_r z) \\right) dz$$\n我们可以逐项积分：\n$$H_{ML} = (1-\\alpha) I_0 \\left[ \\int_{0}^{h} f_b K_b \\exp(-K_b z) dz + \\int_{0}^{h} f_r K_r \\exp(-K_r z) dz \\right]$$\n$$H_{ML} = (1-\\alpha) I_0 \\left[ f_b K_b \\left( -\\frac{1}{K_b} \\exp(-K_b z) \\right)_{0}^{h} + f_r K_r \\left( -\\frac{1}{K_r} \\exp(-K_r z) \\right)_{0}^{h} \\right]$$\n$$H_{ML} = (1-\\alpha) I_0 \\left[ -f_b (\\exp(-K_b h) - \\exp(0)) - f_r (\\exp(-K_r h) - \\exp(0)) \\right]$$\n$$H_{ML} = (1-\\alpha) I_0 \\left[ f_b(1 - \\exp(-K_b h)) + f_r(1 - \\exp(-K_r h)) \\right]$$\n在物理上，$H_{ML}$ 表示进入混合层的净辐照度通量，即顶部（$z=0$）进入的通量与底部（$z=h$）流出的通量之差，即 $H_{ML} = I(0^+) - I(h)$。由于 $f_b+f_r=1$，我们推导的表达式与此解释一致。\n\n**任务3：将 $H_{ML}$ 转换为温度趋势 $\\frac{\\partial T}{\\partial t}$**\n\n对于深度为 $h$、密度为 $\\rho$、比热容为 $c_p$ 的充分混合层，单位面积热含量的变化可以与净热通量相关联。单位面积的总热含量为 $U = \\rho c_p T h$。热含量的变化率为 $\\frac{dU}{dt} = \\rho c_p h \\frac{\\partial T}{\\partial t}$。将其与来自短波辐射的净热输入 $H_{ML}$（因为忽略了所有其他通量）相等，我们得到：\n$$\\rho c_p h \\frac{\\partial T}{\\partial t} = H_{ML}$$\n求解温度趋势 $\\frac{\\partial T}{\\partial t}$：\n$$\\frac{\\partial T}{\\partial t} = \\frac{H_{ML}}{\\rho c_p h}$$\n代入 $H_{ML}$ 的表达式：\n$$\\frac{\\partial T}{\\partial t} = \\frac{(1-\\alpha) I_0 \\left[ f_b(1 - \\exp(-K_b h)) + f_r(1 - \\exp(-K_r h)) \\right]}{\\rho c_p h}$$\n\n现在我们代入给定的数值：\n$I_0 = 250\\,\\mathrm{W\\,m^{-2}}$\n$\\alpha = 0.06$\n$f_b = 0.6$, $K_b = 0.25\\,\\mathrm{m^{-1}}$\n$f_r = 0.4$, $K_r = 2.5\\,\\mathrm{m^{-1}}$\n$h = 6\\,\\mathrm{m}$\n$\\rho = 1000\\,\\mathrm{kg\\,m^{-3}}$\n$c_p = 4182\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n\n首先，计算指数函数的参数：\n$$K_b h = (0.25\\,\\mathrm{m^{-1}})(6\\,\\mathrm{m}) = 1.5$$\n$$K_r h = (2.5\\,\\mathrm{m^{-1}})(6\\,\\mathrm{m}) = 15$$\n\n接下来，计算混合层内吸收的总分数：\n$$f_b(1 - \\exp(-K_b h)) + f_r(1 - \\exp(-K_r h)) = 0.6(1 - \\exp(-1.5)) + 0.4(1 - \\exp(-15))$$\n$$\\approx 0.6(1 - 0.22313) + 0.4(1 - 3.059 \\times 10^{-7})$$\n$$\\approx 0.6(0.77687) + 0.4(0.999999694) \\approx 0.466122 + 0.39999988 \\approx 0.86612$$\n\n现在，计算 $H_{ML}$：\n$$H_{ML} = (1 - 0.06) \\times 250\\,\\mathrm{W\\,m^{-2}} \\times 0.86612$$\n$$H_{ML} = 0.94 \\times 250\\,\\mathrm{W\\,m^{-2}} \\times 0.86612 = 235\\,\\mathrm{W\\,m^{-2}} \\times 0.86612 \\approx 203.5382\\,\\mathrm{W\\,m^{-2}}$$\n\n接下来，计算分母中的热惯性项：\n$$\\rho c_p h = (1000\\,\\mathrm{kg\\,m^{-3}}) (4182\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}) (6\\,\\mathrm{m}) = 25092000\\,\\mathrm{J\\,m^{-2}\\,K^{-1}}$$\n\n计算以 $\\mathrm{K\\,s^{-1}}$ 为单位的温度趋势：\n$$\\frac{\\partial T}{\\partial t} = \\frac{203.5382\\,\\mathrm{W\\,m^{-2}}}{25092000\\,\\mathrm{J\\,m^{-2}\\,K^{-1}}} \\approx 8.1116 \\times 10^{-6}\\,\\mathrm{K\\,s^{-1}}$$\n注意 $1\\,\\mathrm{W} = 1\\,\\mathrm{J\\,s^{-1}}$，所以单位是一致的。\n\n最后，将温度趋势转换为 $\\mathrm{K\\,day^{-1}}$。一天有 $24 \\times 60 \\times 60 = 86400$ 秒。\n$$\\frac{\\partial T}{\\partial t} (\\mathrm{K\\,day^{-1}}) = (8.1116 \\times 10^{-6}\\,\\mathrm{K\\,s^{-1}}) \\times (86400\\,\\mathrm{s\\,day^{-1}})$$\n$$\\frac{\\partial T}{\\partial t} \\approx 0.70084\\,\\mathrm{K\\,day^{-1}}$$\n\n将最终答案四舍五入到三位有效数字，我们得到 $0.701\\,\\mathrm{K\\,day^{-1}}$。",
            "answer": "$$\\boxed{0.701}$$"
        },
        {
            "introduction": "这项综合性练习将挑战你将质量平衡和光依赖过程等概念整合到一个动态的生态系统模型中。你将通过编程实现一个数值模型，以模拟浮游植物和营养盐的季节性循环，其中还包括了自我遮蔽等反馈机制。这个练习将引导你从解析解过渡到计算建模，让你亲手构建和分析一个能够预测复杂生态行为的模型。",
            "id": "3887481",
            "problem": "一个分层水库的充分混合表层被建模为一个控制体积，其状态变量在深度上是均匀的。浮游植物生物量的季节性周期由质量守恒和沿垂直方向的光衰减决定。基于第一性原理推导一个确定性算法来模拟浮游植物生物量和溶解无机氮的年度周期，然后实施该算法以量化对混合层深度和浮游动物摄食率的敏感性。程序必须按照下文的精确描述为指定的测试用例生成输出。\n\n基本原理：\n- 控制体积中的质量守恒意味着状态变量的变化率等于源项之和减去汇项之和。如果 $X(t)$ 是深度为 $h$ 的混合层中的一个浓度，那么 $dX/dt$ 由体积归一化的通量决定。\n- 比尔-朗伯定律指出，向下辐照度随深度呈指数衰减：$I(z,t) = I_0(t)\\exp\\left(-k\\,z\\right)$，其中 $I_0(t)$ 是表面的入射辐照度，$k$ 是总光衰减系数。\n- 浮游植物的生长受到光和营养物可利用性的限制，使用饱和函数表示：实际生长速率是最大生长速率与光和营养物限制函数的乘积。\n\n模型构建：\n- 设 $P(t)$ 为浮游植物生物量浓度，单位为 $\\mathrm{mg\\,N\\,m^{-3}}$，$N(t)$ 为溶解无机氮浓度，单位为 $\\mathrm{mg\\,N\\,m^{-3}}$。混合层深度为 $h$，单位为 $\\mathrm{m}$。\n- 总光衰减为 $k(t) = k_w + k_P P(t)$，其中 $k_w$ 是由水引起的背景光衰减，单位为 $\\mathrm{m^{-1}}$，$k_P$ 是单位生物量的光衰减，单位为 $\\mathrm{m^2\\,(\\mathrm{mg\\,N})^{-1}}$。\n- 混合层中浮游植物经历的深度平均辐照度是 $I(z,t)$ 在 $z \\in [0,h]$ 上的垂直平均值：\n$$\nJ(t) = \\frac{1}{h}\\int_{0}^{h} I_0(t)\\, e^{-k(t)\\,z}\\, dz = \\frac{I_0(t)}{k(t)\\,h}\\left(1 - e^{-k(t)\\,h}\\right),\n$$\n$J(t)$ 的单位是 $\\mathrm{mol\\,photons\\,m^{-2}\\,d^{-1}}$。\n- 光限制为 $f_I(t) = \\dfrac{J(t)}{J(t)+I_k}$，其中 $I_k$ 是光半饱和常数，单位为 $\\mathrm{mol\\,photons\\,m^{-2}\\,d^{-1}}$。\n- 营养物限制为 $f_N(t) = \\dfrac{N(t)}{N(t)+K_N}$，其中 $K_N$ 是营养物半饱和常数，单位为 $\\mathrm{mg\\,N\\,m^{-3}}$。\n- 实际浮游植物生长速率为 $\\mu(t) = \\mu_{\\max} f_I(t) f_N(t)$，其中 $\\mu_{\\max}$ 的单位是 $\\mathrm{d^{-1}}$。\n- 浮游植物的损失包括非摄食性死亡/呼吸 $m$（单位 $\\mathrm{d^{-1}}$）和浮游动物摄食 $g$（单位 $\\mathrm{d^{-1}}$）。\n- 非摄食性损失的一部分（比例为 $r_m$）和摄食损失的一部分（比例为 $r_g$）会瞬间再矿化为溶解无机氮；剩余部分则从混合层中损失（例如，输出）。\n- 溶解无机氮有外部面源负荷 $L_{\\mathrm{areal}}(t)$，单位为 $\\mathrm{mg\\,N\\,m^{-2}\\,d^{-1}}$，产生体积输入 $L_{\\mathrm{vol}}(t) = \\dfrac{L_{\\mathrm{areal}}(t)}{h}$，单位为 $\\mathrm{mg\\,N\\,m^{-3}\\,d^{-1}}$。溶解无机氮也通过一级过程（例如，反硝化作用）从混合层中去除，速率为 $k_{N,\\mathrm{loss}}$，单位为 $\\mathrm{d^{-1}}$。\n\n控制方程（充分混合的常微分方程）：\n$$\n\\frac{dP}{dt} = \\mu(t) P(t) - m\\,P(t) - g\\,P(t),\n$$\n$$\n\\frac{dN}{dt} = L_{\\mathrm{vol}}(t) - \\mu(t) P(t) + r_m\\,m\\,P(t) + r_g\\,g\\,P(t) - k_{N,\\mathrm{loss}}\\,N(t).\n$$\n\n季节性强迫：\n- 表面辐照度表示为周期 $T = 365$ 天的正弦函数：\n$$\nI_0(t) = I_{\\mathrm{mean}}\\left[1 + a_I \\sin\\left(\\frac{2\\pi t}{T}\\right)\\right],\n$$\n其中 $I_{\\mathrm{mean}}$ 是年平均辐照度，单位为 $\\mathrm{mol\\,photons\\,m^{-2}\\,d^{-1}}$，$a_I$ 是无量纲振幅；通过在零处截断来强制 $I_0(t) \\ge 0$。\n- 外部营养物负荷表示为一个基线加上一个春季脉冲：\n$$\nL_{\\mathrm{areal}}(t) = L_0 + L_p \\exp\\left(-\\frac{(t - t_p)^2}{2\\sigma^2}\\right),\n$$\n其中 $L_0$ 和 $L_p$ 的单位为 $\\mathrm{mg\\,N\\,m^{-2}\\,d^{-1}}$，$t_p$ 的单位为 $\\mathrm{d}$，$\\sigma$ 的单位为 $\\mathrm{d}$。\n\n数值实现要求：\n- 使用固定的时间步长 $\\Delta t$（单位 $\\mathrm{d}$）和显式欧拉更新方法，对系统进行 $T=365$ 天的积分。强制非负性：$P(t) \\ge 0$ 和 $N(t) \\ge 0$。\n- 通过对每天内的子日步长进行平均，计算 $P(t)$ 的日平均值。从日平均值中提取年平均生物量、年峰值生物量以及峰值生物量出现的年积日。\n- 生物量输出以 $\\mathrm{mg\\,N\\,m^{-3}}$ 为单位，四舍五入到三位小数。峰值年积日表示为 $[1,365]$ 范围内的整数。\n\n参数值：\n- 生长与限制：\n  - $\\mu_{\\max} = 1.2\\,\\mathrm{d^{-1}}$,\n  - $I_k = 30\\,\\mathrm{mol\\,photons\\,m^{-2}\\,d^{-1}}$,\n  - $K_N = 5\\,\\mathrm{mg\\,N\\,m^{-3}}$。\n- 损失过程：\n  - $m = 0.05\\,\\mathrm{d^{-1}}$,\n  - $r_m = 0.5$,\n  - $r_g = 0.3$,\n  - $k_{N,\\mathrm{loss}} = 0.02\\,\\mathrm{d^{-1}}$。\n- 光衰减：\n  - $k_w = 0.5\\,\\mathrm{m^{-1}}$,\n  - $k_P = 0.02\\,\\mathrm{m^2\\,(\\mathrm{mg\\,N})^{-1}}$。\n- 强迫：\n  - $I_{\\mathrm{mean}} = 35\\,\\mathrm{mol\\,photons\\,m^{-2}\\,d^{-1}}$,\n  - $a_I = 0.8$,\n  - $L_0 = 50\\,\\mathrm{mg\\,N\\,m^{-2}\\,d^{-1}}$,\n  - $L_p = 150\\,\\mathrm{mg\\,N\\,m^{-2}\\,d^{-1}}$,\n  - $t_p = 100\\,\\mathrm{d}$,\n  - $\\sigma = 20\\,\\mathrm{d}$。\n- 初始条件：\n  - $P(0) = 0.1\\,\\mathrm{mg\\,N\\,m^{-3}}$,\n  - $N(0) = 50\\,\\mathrm{mg\\,N\\,m^{-3}}$。\n- 时间步长：\n  - $\\Delta t = 0.25\\,\\mathrm{d}$。\n\n测试套件：\n评估对混合层深度 $h$ 和摄食率 $g$ 的敏感性，共五个案例，每个案例使用上述参数运行一年。\n- 案例 1：$h = 5\\,\\mathrm{m}$，$g = 0.1\\,\\mathrm{d^{-1}}$。\n- 案例 2：$h = 20\\,\\mathrm{m}$，$g = 0.1\\,\\mathrm{d^{-1}}$。\n- 案例 3：$h = 5\\,\\mathrm{m}$，$g = 0.4\\,\\mathrm{d^{-1}}$。\n- 案例 4：$h = 30\\,\\mathrm{m}$，$g = 0.05\\,\\mathrm{d^{-1}}$。\n- 案例 5：$h = 3\\,\\mathrm{m}$，$g = 0.0\\,\\mathrm{d^{-1}}$。\n\n每个测试用例的必需输出：\n- 年峰值浮游植物生物量 $P_{\\mathrm{peak}}$，单位 $\\mathrm{mg\\,N\\,m^{-3}}$，四舍五入到三位小数。\n- 年平均浮游植物生物量 $\\overline{P}$，单位 $\\mathrm{mg\\,N\\,m^{-3}}$，四舍五入到三位小数。\n- 日均 $P$ 达到 $P_{\\mathrm{peak}}$ 时的年积日 $t_{\\mathrm{peak}}$（$[1,365]$ 范围内的整数）。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个由列表组成的列表，以逗号分隔，每个子列表对应一个测试用例，并按 $[P_{\\mathrm{peak}}, \\overline{P}, t_{\\mathrm{peak}}]$ 的顺序排列。例如：$[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$。",
            "solution": "该问题要求开发一个确定性算法，以模拟水库混合层中浮游植物和营养物的年度动态，并使用该算法评估对混合层深度和摄食压力的敏感性。该解决方案基于质量守恒、光和营养物限制的生物生长以及微分方程的数值积分等原理。\n\n**1. 控制原理与模型构建**\n\n模型的核心是应用于深度为 $h$ 的充分混合控制体积的**质量守恒**原理。对于任何浓度为 $C(t)$ 的状态变量，其变化率是所有源项和汇项之和并按体积进行归一化。由此产生一个常微分方程（ODE）组。\n\n状态变量是浮游植物生物量浓度 $P(t)$ 和溶解无机氮浓度 $N(t)$，单位均为 $\\mathrm{mg\\,N\\,m^{-3}}$。\n\n浮游植物 $P(t)$ 的 ODE 为：\n$$\n\\frac{dP}{dt} = (\\text{生长}) - (\\text{死亡}) - (\\text{摄食})\n$$\n$$\n\\frac{dP}{dt} = \\mu(t) P(t) - m\\,P(t) - g\\,P(t)\n$$\n这里，$\\mu(t)$ 是比生长速率（$\\mathrm{d^{-1}}$），$m$ 是非摄食性死亡率（$\\mathrm{d^{-1}}$），$g$ 是摄食率（$\\mathrm{d^{-1}}$）。\n\n溶解无机氮 $N(t)$ 的 ODE 为：\n$$\n\\frac{dN}{dt} = (\\text{外部负荷}) - (\\text{浮游植物吸收}) + (\\text{再矿化}) - (\\text{其他损失})\n$$\n$$\n\\frac{dN}{dt} = L_{\\mathrm{vol}}(t) - \\mu(t) P(t) + r_m\\,m\\,P(t) + r_g\\,g\\,P(t) - k_{N,\\mathrm{loss}}\\,N(t)\n$$\n这里，$L_{\\mathrm{vol}}(t)$ 是体积外部氮负荷（$\\mathrm{mg\\,N\\,m^{-3}\\,d^{-1}}$），$r_m$ 和 $r_g$ 是死亡和摄食损失中被再矿化的无量纲比例，$k_{N,\\mathrm{loss}}$ 是氮的一级损失速率常数（$\\mathrm{d^{-1}}$）。\n\n**2. 生物地球化学过程建模**\n\nODE 中的各项是基于已建立的原理定义的：\n\n- **浮游植物生长 ($\\mu(t)$)：** 生长受到光和营养物的共同限制。实际生长速率 $\\mu(t)$ 是最大潜在速率 $\\mu_{\\max}$ 与光限制因子 $f_I(t)$ 和营养物限制因子 $f_N(t)$（均为无量纲）的乘积。\n$$\n\\mu(t) = \\mu_{\\max} f_I(t) f_N(t)\n$$\n- **光限制 ($f_I(t)$)：** 该项基于**比尔-朗伯定律**，该定律描述了光随深度 $z$ 的指数衰减。向下辐照度为 $I(z,t) = I_0(t)\\exp(-k(t)z)$，其中 $I_0(t)$ 是表面辐照度。总衰减系数 $k(t)$ 包括背景部分 $k_w$ 和由浮游植物自遮蔽引起的部分 $k_P P(t)$，因此 $k(t) = k_w + k_P P(t)$。生长速率取决于浮游植物在深度为 $h$ 的混合层中移动时所经历的深度平均辐照度 $J(t)$：\n$$\nJ(t) = \\frac{1}{h}\\int_{0}^{h} I(z,t)\\, dz = \\frac{1}{h}\\int_{0}^{h} I_0(t)\\, e^{-k(t)\\,z}\\, dz = \\frac{I_0(t)}{k(t)\\,h}\\left(1 - e^{-k(t)\\,h}\\right)\n$$\n光限制因子 $f_I(t)$ 遵循 **Michaelis-Menten**（或 Monod）饱和函数：\n$$\nf_I(t) = \\frac{J(t)}{J(t)+I_k}\n$$\n其中 $I_k$ 是光的半饱和常数。\n\n- **营养物限制 ($f_N(t)$)：** 类似地，营养物限制遵循一个基于溶解无机氮浓度 $N(t)$ 的 Michaelis-Menten 函数：\n$$\nf_N(t) = \\frac{N(t)}{N(t)+K_N}\n$$\n其中 $K_N$ 是氮吸收的半饱和常数。\n\n- **外部强迫：** 模型由季节性环境变化驱动。表面辐照度 $I_0(t)$ 被建模为周期为 $T=365$ 天的截断正弦波。面源营养物负荷 $L_{\\mathrm{areal}}(t)$ 被建模为一个恒定基线 $L_0$ 加上一个以第 $t_p$ 天为中心的高斯分布的春季脉冲。然后，体积负荷为 $L_{\\mathrm{vol}}(t) = L_{\\mathrm{areal}}(t)/h$。\n\n**3. 算法设计：数值积分**\n\n这个耦合的非线性 ODE 系统没有通用的解析解，因此需要采用数值方法。该算法使用**显式欧拉法**进行时间积分，这是一种直接的近似求解技术。\n\n- **时间离散化：** 连续时间域 $[0, T]$ 被离散化为有限数量的大小为 $\\Delta t$ 的步长。系统的状态在时间点 $t_i = i \\cdot \\Delta t$ 进行计算。\n\n- **显式欧拉更新：** 对于形式为 $\\frac{dY}{dt} = F(Y, t)$ 的 ODE，下一个时间步的值 $Y_{i+1}$ 从当前值 $Y_i$ 近似为：\n$$\nY_{i+1} \\approx Y_i + \\Delta t \\cdot F(Y_i, t_i)\n$$\n将此应用于我们的系统，浮游植物 ($P$) 和氮 ($N$) 从时间步 $i$ 到 $i+1$ 的更新规则是：\n$$\nP_{i+1} = P_i + \\Delta t \\cdot \\left( (\\mu(t_i) - m - g)P_i \\right)\n$$\n$$\nN_{i+1} = N_i + \\Delta t \\cdot \\left( L_{\\mathrm{vol}}(t_i) - \\mu(t_i)P_i + r_m m P_i + r_g g P_i - k_{N,\\mathrm{loss}}N_i \\right)\n$$\n其中 $\\mu(t_i)$ 和 $L_{\\mathrm{vol}}(t_i)$ 是使用时间 $t_i$ 时的状态变量 $P_i$ 和 $N_i$ 计算的。模拟从指定的初始条件 $P_0 = P(0)$ 和 $N_0 = N(0)$ 开始。\n\n- **模拟循环：** 算法流程如下：\n    1. 初始化参数、初始条件 ($P_0, N_0$) 和时间 $t=0$。\n    2. 创建数组以存储 $P(t)$ 和 $N(t)$ 的时间序列。\n    3. 循环所需的步数（从 $t=0$ 到 $t=365$）：\n        a. 计算当前时间 $t_i$。\n        b. 计算外部强迫 $I_0(t_i)$ 和 $L_{\\mathrm{vol}}(t_i)$。\n        c. 基于当前状态 $(P_i, N_i)$ 计算速率和限制因子（$\\mu(t_i)$ 等）。\n        d. 计算导数 $dP/dt$ 和 $dN/dt$。\n        e. 使用欧拉公式将状态变量更新为 $(P_{i+1}, N_{i+1})$。\n        f. 强制物理非负性：$P_{i+1} = \\max(0, P_{i+1})$ 和 $N_{i+1} = \\max(0, N_{i+1})$。\n        g. 存储新值并增加时间。\n\n**4. 后处理与输出生成**\n\n- **日平均计算：** 问题指定时间步长 $\\Delta t = 0.25$ 天，导致每天有 $1/\\Delta t = 4$ 个模拟步长。原始的子日时间序列 $P(t)$ 被聚合成一个包含 365 个日平均值的序列。对于每一天 $d \\in [1, 365]$，日平均值是该天内 4 个模拟值的平均值。\n- **指标计算：** 从包含 365 个元素的日均浮游植物时间序列中，计算所需的输出指标：\n    - **年峰值生物量 ($P_{\\mathrm{peak}}$)：** 日均序列中的最大值。\n    - **年平均生物量 ($\\overline{P}$)：** 日均序列的算术平均值。\n    - **峰值日 ($t_{\\mathrm{peak}}$)：** 峰值生物量出现的年积日（作为从 1 到 365 的整数）。\n- **最终输出：** 对于由一对 $(h,g)$ 值定义的每个测试用例，算法计算三元组 $[P_{\\mathrm{peak}}, \\overline{P}, t_{\\mathrm{peak}}]$，将生物量值四舍五入到三位小数，并按照规定将所有测试用例的结果格式化为单行输出。",
            "answer": "[[25.688,14.078,140],[6.014,3.585,163],[14.996,8.237,138],[9.684,5.819,168],[44.887,24.085,145]]"
        }
    ]
}