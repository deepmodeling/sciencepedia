## 引言
土壤水分是地球表层系统中的关键变量，深刻影响着水文循环、[生态系统功能](@entry_id:192182)和气候模式。准确预测其在土壤中的动态变化，对于水资源管理、农业生产和环境变化研究至关重要。然而，土壤内部的水分运动是一个受重力、[毛细作用](@entry_id:136869)和[复杂介质](@entry_id:164088)特性共同控制的高度[非线性](@entry_id:637147)过程，要对其进行定量描述，必须依赖于一个坚实的物理和数学框架。

本文旨在系统地构建并阐释这一框架的核心——[理查兹方程](@entry_id:1131022)。我们将分三个章节引导读者全面掌握这一理论及其应用。在“原理与机制”一章中，我们将从基本物理量出发，推导出[理查兹方程](@entry_id:1131022)，并深入探讨闭合方程所需的关键[本构关系](@entry_id:186508)。接下来的“应用与跨学科联系”一章将展示该方程如何作为一种强大工具，应用于解决水文学、生态学和[生物地球化学](@entry_id:152189)等领域的实际问题，并探讨其背后的建模哲学。最后，在“动手实践”一章中，读者将通过一系列精心设计的编程练习，将理论知识转化为解决具体问题的数值模型，从而巩固所学。

## 原理与机制

本章深入探讨了控制非饱和[多孔介质](@entry_id:154591)中水分运动的核心物理原理和数学公式。我们将从描述土壤含水状态的基本变量入手，逐步构建驱动水流的物理定律，最终推导出描述[非饱和流](@entry_id:756345)动的核心方程——[理查兹方程](@entry_id:1131022)。此外，我们还将探讨闭合该方程所需的[本构关系](@entry_id:186508)，并分析其数学特性与物理内涵。

### 描述可[变饱和介质](@entry_id:1133717)的基本[状态变量](@entry_id:138790)

为了在宏观尺度上描述多孔介质（如土壤）的性质，我们引入了**代表性单元体 (Representative Elementary Volume, REV)** 的概念。REV是一个足够大的体积，其平均性质（如孔隙度）能够稳定地代表整个介质的宏观特性，但又足够小，可以被视为空间中的一个点。

在REV的框架下，我们定义了几个关键的状态变量来量化土壤中的水分含量。

首先是**孔隙度 (porosity)**，符号为 $n$，定义为孔隙体积 $V_p$ 与土壤总体积 $V_t$ 之比：
$$
n = \frac{V_p}{V_t}
$$
孔隙度是一个无量纲的量，表示土壤中可被流体（水或空气）占据的空间比例。

其次是**体积含水量 (volumetric water content)**，符号为 $\theta$，定义为液态水体积 $V_w$ 与土壤总体积 $V_t$ 之比：
$$
\theta = \frac{V_w}{V_t}
$$
$\theta$ 同样是一个无量纲的量，它直接表示单位体积土壤中含有多少体积的水。

另一个相关的量是**饱和度 (saturation)**，符号为 $S_w$，它表示孔隙空间被水占据的比例：
$$
S_w = \frac{V_w}{V_p}
$$
这三个基本量之间存在一个简单的恒等关系。通过将 $\theta$ 和 $S_w$ 的定义式进行组合，我们可以得到：
$$
\theta = \frac{V_w}{V_t} = \frac{V_w}{V_p} \frac{V_p}{V_t} = S_w n
$$
这个关系 $\theta = n S_w$ 是理解[土壤水分动态](@entry_id:1131881)的基础 。

在实际的土壤中，含水量 $\theta$ 并非在 $0$ 和 $n$ 之间自由变化。当土壤极度干燥时，由于强大的吸附力和[毛细作用](@entry_id:136869)，仍有一部分水被束缚在土壤颗粒表面和极细小的孔隙中，这部分水在常规水力梯度下几乎不流动。我们将这部分含水量的下限称为**残余体积含水量 (residual volumetric water content)**，记为 $\theta_r$。相应地，当土壤完全被水充满时，其含水量达到最大值，称为**饱和体积含水量 (saturated volumetric water content)**，记为 $\theta_s$。在理想情况下，假设没有截留空气，$\theta_s$ 等于孔隙度 $n$。因此，在水力学上活跃的水分含量范围是 $[\theta_r, \theta_s]$。

为了方便地将不同土壤的持水特性进行归一化比较和建模，我们引入了**有效饱和度 (effective saturation)**，符号为 $S_e$。它将实际的体积含水量 $\theta$ 线性地映射到 $[0, 1]$ 区间：
$$
S_e = \frac{\theta - \theta_r}{\theta_s - \theta_r}
$$
当 $\theta = \theta_r$ 时，$S_e = 0$；当 $\theta = \theta_s$ 时，$S_e = 1$。这个定义也可以反写为 $\theta = \theta_r + (\theta_s - \theta_r) S_e$。有效饱和度是构建土壤水分本构关系（将在后续章节讨论）中的一个核心变量 。

### 水流驱动力：水头

流体的运动是由[势能梯度](@entry_id:167095)驱动的，水从高势能区域流向低势能区域。在土壤水动力学中，我们通常使用单位重量流体的[机械能](@entry_id:162989)来表示这种势能，这个量被称为**总水头 (total hydraulic head)**，符号为 $h$。总[水头](@entry_id:750444)由两个主要部分组成：由压力贡献的**[压力水头](@entry_id:141368) (pressure head)** 和由重力贡献的**位置水头 (elevation head)**。

[压力水头](@entry_id:141368) $\psi$ 定义为**表压 (gauge pressure)** $p$（即相对于大气压的压力）与水的单位重量 $\rho g$ 之比，其中 $\rho$ 是水的密度，$g$ 是重力加速度：
$$
\psi = \frac{p}{\rho g}
$$
在[饱和区](@entry_id:262273)域（如地下水位以下），水压大于大气压，因此 $\psi > 0$。然而，在[非饱和区](@entry_id:1133681)域（[包气带](@entry_id:1133681)），由于毛细作用，水被置于张力之下，其压力低于大气压，因此 $p  0$，导致 $\psi  0$。这个负的[压力水头](@entry_id:141368)通常被称为**基质势 (matric potential)** 或**吸力水头 (suction head)**。

位置[水头](@entry_id:750444) $z$ 就是某一点相对于一个任意选定的基准面的垂直高程。因此，总水头可以写为：
$$
h = \psi + z
$$

坐标系的选择对于[水头](@entry_id:750444)和通量的具体表达式至关重要。在水文学和[土壤物理学](@entry_id:1131887)中，存在两种常见的约定 ：
1.  **水文学约定 (Hydrology Convention)**：通常将垂直坐标 $z$ 定义为**向上为正**。在这种约定下，位置水头就是 $z$ 本身。因此，总[水头](@entry_id:750444)为 $h = \psi + z$。一维垂直方向（$z$ 方向）的向上通量 $q_z$ 由总水头梯度 $\frac{\partial h}{\partial z} = \frac{\partial \psi}{\partial z} + 1$ 驱动。
2.  **[土壤物理学](@entry_id:1131887)约定 (Soil Physics Convention)**：通常将垂直坐标 $z_d$ 定义为从土壤表面**向下为正**。如果我们将基准面设在土壤表面，那么一个深度为 $z_d$ 的点其高程为 $-z_d$。因此，总[水头](@entry_id:750444)为 $h = \psi - z_d$。有时为了处理正数，会定义吸力 $s = -\psi  0$。总[水头](@entry_id:750444)则表示为 $h = -s - z_d$。一维垂直方向（$d$ 方向）的向下通量 $q_d$ 由总[水头](@entry_id:750444)梯度 $\frac{\partial h}{\partial z_d} = \frac{\partial \psi}{\partial z_d} - 1 = -\frac{\partial s}{\partial z_d} - 1$ 驱动。

这两种约定在物理上是等价的，只是数学表达形式不同。理解并保持所选约定的一致性对于正确建立和求解模型至关重要。例如，在向下为正的坐标系中，当水流主要由重力驱动时（压力梯度可忽略，$\frac{\partial s}{\partial z_d} \approx 0$），这种状态称为**单[位梯度](@entry_id:261486)流 (unit-gradient flow)**，此时向下的通量近似等于[水力传导](@entry_id:165048)度 。

### 运动定律：可[变饱和流](@entry_id:1133716)的达西-白金汉定律

描述[多孔介质](@entry_id:154591)中流体运动的基本定律是达西定律的推广，即**达西-白金汉定律 (Darcy-Buckingham law)**。在讨论这个定律之前，我们必须区分两种不同的“速度”。

在孔隙尺度上，水分子以一个复杂的、随空间变化的真实速度 $\mathbf{u}(\mathbf{x})$ 流动。在REV尺度上，我们定义一个**孔隙平均流速 (average pore velocity)** $\mathbf{v}_{\text{avg}}$，它是水流通过实际被水占据的孔隙[横截面](@entry_id:154995) $A_w$ 的平均速度。然而，在宏观模型中，我们更关心的是通过整个土壤[横截面](@entry_id:154995)（包括固体和孔隙）的总流量。因此，我们定义了**达西通量 (Darcy flux)** 或**[比流量](@entry_id:1132070) (specific discharge)** $\mathbf{q}$，它是单位总[横截面](@entry_id:154995)积 $A$ 的[体积流量](@entry_id:265771)。

这两个速度尺度之间的关系可以通过它们的定义推导出来 。总的[体积流量](@entry_id:265771) $Q_w$ 可以表示为 $Q_w = qA$ 或 $Q_w = v_{\text{avg}}A_w$。而水占据的面积 $A_w$ 是总面积 $A$ 中孔隙部分（$nA$）被水充满的比例（$S_w$），即 $A_w = n S_w A = \theta A$。联立这些关系，我们得到：
$$
q A = v_{\text{avg}} (\theta A) \implies \mathbf{q} = \theta \mathbf{v}_{\text{avg}}
$$
这个关系被称为**杜普伊-福希海默关系 (Dupuit-Forchheimer relationship)**。它明确指出，达西通量 $\mathbf{q}$ 是一个**[表观速度](@entry_id:152020) (superficial velocity)**，其大小总是小于真实的孔隙平均流速，因为流体被迫通过一个比总面积小得多的[截面](@entry_id:154995)。

达西-白金汉定律指出，达西通量 $\mathbf{q}$ 与总水头 $h$ 的梯度成正比，方向相反：
$$
\mathbf{q} = -K \nabla h
$$
比例系数 $K$ 是**[水力传导](@entry_id:165048)度 (hydraulic conductivity)**，它衡量了多孔介质输送水的能力。在非饱和条件下，随着含水量 $\theta$ 的降低，可供水流动的路径减少且变得更加曲折，因此[水力传导](@entry_id:165048)度 $K$ 不是一个常数，而是 $\theta$（或等价地，$\psi$）的强函数，即 $K(\theta)$ 或 $K(\psi)$。

许多土壤（如沉积岩）在不同方向上具有不同的渗透性，这种性质称为**各向异性 (anisotropy)**。在这种情况下，[水力传导](@entry_id:165048)度必须用一个[二阶张量](@entry_id:199780) $\mathbf{K}$ 来表示 。达西-白金汉定律写为：
$$
\mathbf{q} = -\mathbf{K}(\psi) \nabla h
$$
**[水力传导](@entry_id:165048)度张量 $\mathbf{K}$** 是一个 $3 \times 3$ 的矩阵，它将[水头](@entry_id:750444)[梯度向量](@entry_id:141180) $\nabla h$ 映射到达西通量向量 $\mathbf{q}$。基于[热力学](@entry_id:172368)第二定律（流动过程耗散能量）和昂萨格倒易关系，$\mathbf{K}$ 必须是**对称 (symmetric)** 且**正定 (positive definite)** 的。它的分量单位是长度/时间（如 $m/s$）。

各向异性的一个重要后果是，水流方向 $\mathbf{q}$ 通常与水头梯度方向 $-\nabla h$ **不平行**。水流会被“偏转”到导水性更强的方向。例如，在具有倾斜层理的沉积物中，即使在纯粹的垂直[重力梯度](@entry_id:181198)下，水流也会产生一个沿着导水性更强的层理方向的侧向分量 。如果一个介质的层理（主导水方向）与[全局坐标系](@entry_id:171029) $\{x,z\}$ 成 $\theta$ 角，并且其沿层理和平行层理的主传导度分别为 $K_{\parallel}$ 和 $K_{\perp}$，那么在[全局坐标系](@entry_id:171029)中的传导度张量可以通过[坐标旋转](@entry_id:164444)变换得到：
$$
\mathbf{K}(\psi) = \mathbf{R}(\theta) \begin{pmatrix} K_{\parallel}(\psi)  0 \\ 0  K_{\perp}(\psi) \end{pmatrix} \mathbf{R}(\theta)^{\top}
$$
其中 $\mathbf{R}(\theta)$ 是一个标准的[二维旋转矩阵](@entry_id:154975)。这种[张量表示法](@entry_id:272140)对于在[地球系统模型](@entry_id:1124096)中准确模拟复杂地质构造中的水流至关重要。

### 守恒定律：[连续性方程](@entry_id:195013)

任何输运过程都必须遵守质量守恒定律。对于一个固定的REV，其中水的质量随时间的变化率必须等于进出该体积的净质量通量，加上内部的任何质量源或汇。假设水的密度 $\rho$ 恒定（不可压缩流体），质量守恒可以简化为[体积守恒](@entry_id:276587)。

考虑一个任意的控制体积，其内部水的总体积为 $\int \theta dV$。其随时间的变化率等于穿过其边界的净通量和内部源/汇 $q$（单位体积的源/汇率，单位为 $T^{-1}$）的总和。利用[高斯散度定理](@entry_id:188065)，我们可以将边界上的[通量积分](@entry_id:138365)转换成体积内的散度积分，从而得到局部（点尺度）的[微分形式](@entry_id:146747)的**连续性方程 (continuity equation)** ：
$$
\frac{\partial \theta}{\partial t} + \nabla \cdot \mathbf{q} = q
$$
在这个方程中：
- $\frac{\partial \theta}{\partial t}$ 是**储水变化项**，表示单位体积土壤中水分含量的[瞬时变化率](@entry_id:141382)。
- $\nabla \cdot \mathbf{q}$ 是**通量散度项**。正的散度表示从某点流出的水量多于流入的水量，导致该点储水减少。
- $q$ 是**源/汇项**。按照惯例，$q  0$ 表示源（如人工灌溉），它会增加储水量；$q  0$ 表示汇（如植物根系吸水），它会减少储水量。

### [理查兹方程](@entry_id:1131022)：综合与闭合

将达西-白金汉定律 $\mathbf{q} = -K(\psi) \nabla (\psi + z)$ 代入[连续性方程](@entry_id:195013)，我们就得到了一个描述可变饱和[多孔介质](@entry_id:154591)中水分运动的单一[偏微分](@entry_id:194612)方程。忽略源/汇项，我们得到：
$$
\frac{\partial \theta}{\partial t} - \nabla \cdot [K(\psi) \nabla (\psi + z)] = 0
$$
这个方程通常被称为**[理查兹方程](@entry_id:1131022) (Richards' equation)** 的“混合形式”，因为它同时包含了两个未知变量：体积含水量 $\theta$ 和[压力水头](@entry_id:141368) $\psi$。为了求解这个方程，我们必须找到一个额外的信息来“闭合”这个系统，即建立 $\theta$ 和 $\psi$ 之间的关系。

这个闭合关系来自于一个关键的物理假设：**局部热力学平衡 (Local Thermodynamic Equilibrium, LTE)** 。该假设认为，在REV尺度上，尽管宏观上存在流动和不平衡，但在微观的孔隙尺度上，水、气、固三相的界面能够足够快地调整以达到局部平衡。这种平衡意味着，在任何时刻和任何地点，介质的含水量（或饱和度）是其毛细压力（与 $\psi$ 直接相关）的唯一函数。这个函数关系正是我们通过实验（通常在准静态条件下）测量的。

因此，LTE假设允许我们写出**[本构关系](@entry_id:186508) (constitutive relationships)**：
$$
\theta = \theta(\psi) \quad \text{和} \quad K = K(\psi)
$$
第一个关系式 $\theta(\psi)$ 被称为**土壤[持水曲线](@entry_id:1133972) (Soil Water Retention Curve, SWRC)**。有了这个关系，我们就可以利用[链式法则](@entry_id:190743)将储水变化项表示为 $\psi$ 的函数：
$$
\frac{\partial \theta}{\partial t} = \frac{d\theta}{d\psi} \frac{\partial \psi}{\partial t} = C(\psi) \frac{\partial \psi}{\partial t}
$$
其中 $C(\psi) = \frac{d\theta}{d\psi}$ 被称为**比水容量 (specific moisture capacity)**，它表示[压力水头](@entry_id:141368)单位变化所引起的含水量变化。

将此代入混合形式的[理查兹方程](@entry_id:1131022)，我们便得到了完全以[压力水头](@entry_id:141368) $\psi$ 为唯一未知变量的“$\psi$-基形式”的[理查兹方程](@entry_id:1131022)：
$$
C(\psi) \frac{\partial \psi}{\partial t} - \nabla \cdot [K(\psi) \nabla (\psi + z)] = q
$$
这个方程，连同适当的初始条件和边界条件，构成了一个完整的数学问题，可以用来预测和模拟土壤水分的动态。需要强调的是，若没有LTE假设，$\theta$ 和 $\psi$ 之间就不存在唯一的函数关系，它们的联系可能依赖于变化速率（动态效应）或其他内部变量，从而导致上述标准[理查兹方程](@entry_id:1131022)失效。

### 本构关系：表征土壤水力特性

[理查兹方程](@entry_id:1131022)的求解严重依赖于两个关键的本构关系：土壤[持水曲线](@entry_id:1133972) $\theta(\psi)$ 和非饱和[水力传导](@entry_id:165048)度函数 $K(\psi)$。这些关系是特定土壤的内在属性，必须通过实验测量或经验模型来确定。

#### 土壤[持水曲线](@entry_id:1133972) (SWRC): $\theta(\psi)$

SWRC描述了在平衡状态下，土壤能保持多少水分（$\theta$）与施加的吸力（$-\psi$）之间的关系。这种关系并非一一对应，而是表现出显著的**滞后现象 (hysteresis)**，即在相同的基质势下，排水过程（变干）中的含水量高于吸水过程（变湿）中的含水量。

滞后现象的孔隙尺度机理主要有两个 ：
1.  **[墨水瓶效应](@entry_id:750657) (Ink-bottle effect)**：这是由孔隙几何形状的不均匀性引起的。想象一个由较粗的孔隙体连接着较细的孔隙喉道组成的“墨水瓶”结构。在排水时，空气必须克服通过最窄喉道所需的高毛细压力才能进入并排空孔隙体。而在吸水时，水从任何方向进入，一旦毛细压力降到足以让水进入较粗的孔隙体时，整个孔隙就会迅速被填充。由于控制排水的喉道半径 $r_t$ 小于控制吸水的孔隙体半径 $r_b$，导致排水所需的吸力远大于吸水所需的吸力。
2.  **[接触角滞后](@entry_id:148697) (Contact angle hysteresis)**：水-固-气三相接触线的接触角在前进（吸水）时（前进角 $\theta_A$）和后退（排水）时（后退角 $\theta_R$）是不同的，通常 $\theta_A  \theta_R$。根据[杨-拉普拉斯方程](@entry_id:138854)，这也会导致排水和吸水过程中的[毛细压力](@entry_id:155511)不同，从而加剧了滞后环的宽度。

在实践中，SWRC通常用[参数化](@entry_id:265163)的经验模型来描述。其中最广泛使用的是 **van Genuchten 模型**。其表达式通常写为：
$$
\theta(\psi) = \theta_r + (\theta_s - \theta_r) \left[ 1 + (\alpha|\psi|)^n \right]^{-m}
$$
这个模型中的参数具有明确的物理意义 ：
- $\theta_r$ 和 $\theta_s$ 分别是残余和饱和体积含水量，定义了曲线的下限和上限。
- $\alpha$ 是一个与进气吸力相关的参数，单位为长度的倒数 ($L^{-1}$)。$1/\alpha$ 近似代表了最大孔隙开始排水时的[压力水头](@entry_id:141368)值。$\alpha$ 值越大，土壤越容易失水（如砂土）。
- $n$ 是一个无量纲的[形状参数](@entry_id:270600) ($n  1$)，反映了孔径分布的均匀性。$n$ 值越大，曲线越陡峭，表示[孔径](@entry_id:172936)分布越窄（如均质砂土）；$n$ 值越小，曲线越平缓，表示孔径分布越宽（如黏土）。
- $m$ 是另一个[形状参数](@entry_id:270600)，通常为了获得[水力传导](@entry_id:165048)度的解析解而施加约束，令其与 $n$ 相关，最常见的约束是 $m = 1 - 1/n$。

#### 非饱和[水力传导](@entry_id:165048)度函数: $K(\psi)$

非饱和[水力传导](@entry_id:165048)度 $K$ 随着土壤变干而急剧下降，其值可以跨越多个数量级。这是因为随着含水量减少，大孔隙首先排空，水流被迫通过更小、更曲折的路径，有效流通面积和[路径连通性](@entry_id:142695)都大大降低。

预测 $K(\psi)$ 的模型通常基于孔隙束理论，将土壤[持水曲线](@entry_id:1133972)的信息与统计模型相结合。**Mualem-van Genuchten 模型** 就是这样一个典范，它将 Mualem (1976) 的传导度积分模型与 van Genuchten 的[持水曲线](@entry_id:1133972)相结合。在施加 $m = 1 - 1/n$ 的约束后，可以得到一个解析表达式：
$$
K(S_e) = K_s S_e^l \left[ 1 - \left(1 - S_e^{1/m}\right)^m \right]^2
$$
其中，$S_e$ 是有效饱和度。这个模型中的参数解释如下 ：
- $K_s$ 是**饱和[水力传导](@entry_id:165048)度 (saturated hydraulic conductivity)**，即土壤完全饱和时的传导度。它是一个独立的、可测量的宏观参数。
- $l$ 是一个经验性的**孔隙连通性/曲折度参数 (pore connectivity/tortuosity parameter)**。它修正了随着饱和度下降，水流路径变得更加曲折和不连通所带来的额外传导度损失。Mualem 建议的通用值为 $l = 0.5$。
- $m$（以及与之相关的 $n$）是来自[持水曲线](@entry_id:1133972)的[形状参数](@entry_id:270600)，主要反映了孔径分布。它通过影响积分模型的权重来间接影响传导度曲线的形状，但其直接物理意义并非曲折度。

### 数学特性与物理内涵

[理查兹方程](@entry_id:1131022)是一个**退化的[非线性](@entry_id:637147)[抛物型偏微分方程](@entry_id:168935) (degenerate nonlinear parabolic PDE)** 。

- **[非线性](@entry_id:637147) (Nonlinear)**：它的系数 $C(\psi)$ 和 $K(\psi)$ 都依赖于待求解的变量 $\psi$ 本身。这意味着，例如，两个解的叠加不再是方程的解。这种[非线性](@entry_id:637147)导致了许多复杂的行为，如形成尖锐的湿润锋。

- **抛物型 (Parabolic)**：方程的结构（包含时间的一阶偏导和空间的二阶偏导）类似于[热传导方程](@entry_id:194763)，属于扩散型方程。这决定了其解的平滑特性和信息的[传播方式](@entry_id:900807)。

- **退化 (Degenerate)**：方程的抛物特性在某些条件下会“退化”或丧失。当时间导数项的系数 $C(\psi)$ 或空间导数项的系数 $K(\psi)$ 趋于零时，就会发生退化。
    1.  当土壤变得极度干燥时（$\psi \to -\infty$），$K(\psi) \to 0$。此时，方程的扩散项消失，其行为不再是扩散性的。
    2.  当土壤处于极度干燥（$\theta \to \theta_r$）或完全饱和（$\theta = \theta_s$）状态时，含水量 $\theta$ 对[压力水头](@entry_id:141368) $\psi$ 的变化不再敏感，因此比水容量 $C(\psi) = d\theta/d\psi \to 0$。此时，时间导数项消失，方程从抛物型转变为椭圆型。

这种退化特性给[理查兹方程](@entry_id:1131022)的数值求解带来了巨大挑战。在饱和-非饱和界面或干湿锋面处，方程的数学性质发生剧变，需要特别设计的数值方法来保证解的稳定性和准确性。