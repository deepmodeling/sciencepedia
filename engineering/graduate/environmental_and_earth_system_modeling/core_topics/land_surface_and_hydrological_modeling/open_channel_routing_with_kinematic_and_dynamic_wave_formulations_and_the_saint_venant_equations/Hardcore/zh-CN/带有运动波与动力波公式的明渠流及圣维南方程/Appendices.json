{
    "hands_on_practices": [
        {
            "introduction": "模拟明渠水流的第一步是表征系统的当前状态。像弗劳德数 ($Fr$) 这样的关键无量纲数决定了水流状态（缓流或急流），而这个状态又决定了信息（如洪水波或下游闸门变化）传播的基本性质。本练习将现场测量的简单计算与一个深刻的概念选择联系起来：是简化模型（运动波）适用，还是需要动力学波动方程的完整物理机制 。",
            "id": "3902848",
            "problem": "一个横截面为矩形的直棱柱形明渠输送着非恒定流，该流动由一维浅水方程（即圣维南方程）建模。渠宽 $b = 30\\,\\mathrm{m}$，底坡 $S_{0} = 0.0015$。渠床糙率由曼宁系数 $n = 0.035$ 表征。在某一特定横截面，一次测量活动得出过水断面面积 $A = 120\\,\\mathrm{m^{2}}$，流量 $Q = 336\\,\\mathrm{m^{3}\\,s^{-1}}$。取重力加速度 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$。\n\n从浅水自由表面流的质量和动量平衡以及作为圣维南方程基础的静水压强假设出发，确定所测状态下的平均流速 $U$ 和弗劳德数 $\\mathrm{Fr}$。然后，利用圣维南方程的特征结构和从流量-面积关系曲线推导的运动波近似，推断您计算出的 $\\mathrm{Fr}$ 对长波波速以及在使用 (i) 运动波和 (ii) 完整动力波公式的演进模型中信息传播方向的影响。\n\n报告 $U$（单位为 $\\mathrm{m\\,s^{-1}}$）和无量纲的 $\\mathrm{Fr}$。两者均保留四位有效数字。",
            "solution": "问题验证如下。\n\n### 步骤 1：提取已知条件\n-   渠道类型：横截面为矩形的直棱柱形明渠。\n-   渠宽：$b = 30\\,\\mathrm{m}$。\n-   底坡：$S_{0} = 0.0015$。\n-   曼宁系数：$n = 0.035$。\n-   过水断面面积：$A = 120\\,\\mathrm{m^{2}}$。\n-   流量：$Q = 336\\,\\mathrm{m^{3}\\,s^{-1}}$。\n-   重力加速度：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法得当且客观。它基于一维明渠流中公认的圣维南方程，这是环境和地球系统建模的基石。所有术语均为流体动力学和水文学中的标准术语。所提供的数据是自洽且一致的，可以直接计算所要求的量并进行有意义的物理解释。该问题不违反任何基本原理，不基于错误前提，也没有任何歧义。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n平均流速 $U$ 定义为通过某一横截面的总流量 $Q$ 除以该横截面的过水面积 $A$。\n$$\nU = \\frac{Q}{A}\n$$\n代入给定值：\n$$\nU = \\frac{336\\,\\mathrm{m^{3}\\,s^{-1}}}{120\\,\\mathrm{m^{2}}} = 2.8\\,\\mathrm{m\\,s^{-1}}\n$$\n\n对于宽度为 $b$ 的矩形渠道，过水断面面积 $A$ 与水深 $y$ 的关系为 $A = by$。因此，我们可以计算水深：\n$$\ny = \\frac{A}{b} = \\frac{120\\,\\mathrm{m^{2}}}{30\\,\\mathrm{m}} = 4.0\\,\\mathrm{m}\n$$\n\n弗劳德数 $\\mathrm{Fr}$ 是一个表征流态的无量纲参数。对于矩形渠道，它是平均流速 $U$ 与微小重力波的波速 $\\sqrt{gy}$ 之比。\n$$\n\\mathrm{Fr} = \\frac{U}{\\sqrt{gy}}\n$$\n代入计算出的 $U$ 和 $y$ 值以及给定的 $g$ 值：\n$$\n\\mathrm{Fr} = \\frac{2.8\\,\\mathrm{m\\,s^{-1}}}{\\sqrt{(9.81\\,\\mathrm{m\\,s^{-2}})(4.0\\,\\mathrm{m})}} = \\frac{2.8}{\\sqrt{39.24}} \\approx 0.44699\n$$\n保留四位有效数字，我们得到 $U = 2.800\\,\\mathrm{m\\,s^{-1}}$ 和 $\\mathrm{Fr} = 0.4470$。\n\n由于 $\\mathrm{Fr}  1$，该水流被归类为缓流。我们现在分析这对演进模型中信息传播的影响。\n\n用于明渠非恒定流的一维圣维南方程是一个由两个偏微分方程组成的系统，分别代表质量守恒和动量守恒：\n$$\n\\frac{\\partial A}{\\partial t} + \\frac{\\partial Q}{\\partial x} = 0 \\quad \\text{(连续性方程)}\n$$\n$$\n\\frac{\\partial Q}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\beta \\frac{Q^2}{A}\\right) + gA\\frac{\\partial y}{\\partial x} = gA(S_0 - S_f) \\quad \\text{(动量方程)}\n$$\n其中 $x$ 是纵向坐标，$t$ 是时间，$S_f$ 是摩阻坡降，$\\beta$ 是动量修正系数（假定为 $1$）。\n\n**i) 对完整动力波公式的影响**\n\n圣维南方程构成一个双曲型系统。在此类系统中，信息沿着 $x$-$t$ 平面上的特征线传播。传播速度，即波速，由系统雅可比矩阵的特征值给出。对于圣维南方程，这些特征波速为：\n$$\nc = U \\pm \\sqrt{g\\frac{A}{T}}\n$$\n其中 $T$ 是渠道的水面宽度。对于矩形渠道，$T = b$，因此 $\\sqrt{gA/T}$ 项简化为 $\\sqrt{gy}$，即浅水重力波的波速。因此，两个特征速度为：\n$$\nc = U \\pm \\sqrt{gy}\n$$\n弗劳德数为 $\\mathrm{Fr} = U / \\sqrt{gy}$。\n我们的计算得出 $\\mathrm{Fr} \\approx 0.4470  1$，对应于缓流。在这种流态下，平均流速 $U$ 小于重力波波速 $\\sqrt{gy}$。\n两个特征速度是：\n1.  $c_1 = U + \\sqrt{gy} > 0$：这代表一个向下游传播的波。\n2.  $c_2 = U - \\sqrt{gy}  0$：由于 $U  \\sqrt{gy}$，这代表一个向上游传播的波。\n\n因此，对于完整动力波模型，水流的缓流性质 ($\\mathrm{Fr}  1$) 意味着信息（例如，水位变化的影响）会**同时向上游和下游传播**。这对于模拟下游控制（如水坝、堰或潮汐影响）引起的回水效应等现象至关重要，因为在这些现象中，下游条件会影响上游的水流剖面。\n\n**ii) 对运动波公式的影响**\n\n运动波模型是圣维南方程的简化形式，其中动量方程通过忽略局部加速度、对流加速度和压力项而简化。这使得摩阻坡降与底坡之间达到平衡，$S_f = S_0$。这一假设意味着流量和过水面积（或水深）之间存在一种唯一的、单值的关系，$Q=Q(A)$，即流量关系曲线。例如，使用曼宁方程：\n$$\nQ = \\frac{1}{n} A R_h^{2/3} S_0^{1/2}\n$$\n其中 $R_h$ 是水力半径。\n\n运动波模型由连续性方程与此流量关系曲线组合而成：\n$$\n\\frac{\\partial A}{\\partial t} + \\frac{\\partial Q(A)}{\\partial x} = 0\n$$\n使用链式法则，$\\frac{\\partial Q}{\\partial x} = \\frac{dQ}{dA} \\frac{\\partial A}{\\partial x}$，我们得到：\n$$\n\\frac{\\partial A}{\\partial t} + \\frac{dQ}{dA} \\frac{\\partial A}{\\partial x} = 0\n$$\n这是一个描述 $A$ 演变的一阶波动方程。它只有一个特征波速，即运动波波速 $c_k$：\n$$\nc_k = \\frac{dQ}{dA}\n$$\n由于对于下游水流，$Q$ 和 $A$ 都是正值，它们之间的关系是单调的，因此导数 $c_k = dQ/dA$ 总是正的。这意味着运动波**只能向下游方向传播**。\n\n我们计算出的弗劳德数小于 1 在这里具有深远的影响。虽然真实的物理系统（由动力波模型描述）支持双向信息流动，但运动波近似本质上禁止任何上游传播。无论水流是缓流（$\\mathrm{Fr}  1$）还是急流（$\\mathrm{Fr} > 1$），运动波模型总是将扰动向下游传递。这使得运动波模型在需要捕捉任何下游控制影响的情况下，不适用于当前案例，因为它无法表示向上游传播的特征 $c_2 = U - \\sqrt{gy}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.800  0.4470 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在选择了物理控制模型（例如动力学波）之后，我们必须将其转化为数值格式，这涉及到离散化方法的关键选择。数值解的稳定性和准确性与空间和时间步长（$\\Delta x$, $\\Delta t$）并非相互独立。著名的 Courant–Friedrichs–Lewy (CFL) 条件将这些参数与系统中的物理波速联系起来，从而在计算成本和保真度之间产生了核心的权衡 。",
            "id": "3902836",
            "problem": "一个一维明渠洪水演进模型被配置用于一个宽度为 $B$、底坡为 $S_0$、糙率由曼宁公式表示的棱柱形矩形渠道。其控制方程为一维圣维南（浅水）方程，包括质量守恒和动量平衡，用横截面积 $A(x,t)$、流量 $Q(x,t)$、水深 $h(x,t)$ 和平均流速 $u(x,t)$ 作为空间 $x$ 和时间 $t$ 的函数来表示。一个亚临界洪水波在河段中进行演算，其水深变化范围为 $h \\in [h_{\\min},h_{\\max}]$，流速范围为 $u \\in [u_{\\min},u_{\\max}]$。模型采用空间离散化（网格间距 $\\Delta x$）和时间离散化（时间步长 $\\Delta t$），可选择使用显式求解器或隐式求解器，以及运动波或动力波公式（动力波公式保留惯性项和压力梯度项，而运动波公式忽略它们并假设局部均匀流受阻力控制）。\n\n从第一性原理出发——即圣维南方程的双曲特性、与信息传播相关的特征速度的存在，以及为保证稳定性，数值依赖域必须包含物理依赖域的要求——推理 $\\Delta t$ 和 $\\Delta x$ 的选择如何影响洪水演进的稳定性、准确性（包括振幅和相位保真度）和计算成本。在你的推理中，考虑亚临界流如何意味着存在不同的特征速度，显式求解器与隐式求解器在稳定性约束上的差异，以及运动波近似相对于完整动力波如何改变传播物理过程。你不得使用或引用任何预先推导的稳定性或误差条件；相反，应引用控制方程的结构及其特征的定性行为。\n\n在为此类模拟选择 $\\Delta t$ 和 $\\Delta x$ 时，哪个选项最好地描述了稳定性、准确性和计算成本之间的正确权衡？\n\nA. 减小 $\\Delta x$ 通常会提高空间准确性，但会收紧显式动力波格式的稳定性约束，因为信息沿特征线传播，数值步长必须能解析这些路径。因此，当 $\\Delta x$ 缩小时，显式格式需要更小的 $\\Delta t$，这会增加时间步数和总成本，大约与 $1/\\Delta x$ 呈超线性关系；隐式格式放宽了对 $\\Delta t$ 的稳定性限制，但每步成本更高，并且如果 $\\Delta t$ 选择过大，可能会引入额外的数值耗散。运动波公式由于其传播物理过程更简单（仅有类平流特征），在相同的 $\\Delta x$ 下，其稳定性约束通常比动力波更宽松，但代价是牺牲了对快速变化的瞬态过程的物理准确性。\n\nB. 洪水演进的稳定性仅由摩擦阻尼控制，因此在显式动力波格式中，无论 $\\Delta t$ 如何，减小 $\\Delta x$ 总会增加稳定性。隐式格式是无条件稳定的，即使 $\\Delta t$ 很大，也不会出现数值扩散或相位误差。\n\nC. 显式动力波格式的计算成本仅与 $1/\\Delta x$ 呈线性关系，因为在细化网格时可以保持时间步长 $\\Delta t$ 不变。动力波公式每时间步的成本总是比运动波低，因为它能更有效地解析重力波，且准确性仅由 $\\Delta t$ 控制，而不由 $\\Delta x$ 控制。\n\nD. 选择更大的 $\\Delta t$ 总是通过平滑数值噪声来提高准确性，并且只要 $\\Delta x$ 足够小，显式格式就保持稳定；动力波公式没有超出运动波公式的额外稳定性限制，因为在亚临界流中两者具有相同的特征速度。\n\n选择唯一的最佳选项。",
            "solution": "用于棱柱形明渠的一维圣维南方程构成了一个双曲型偏微分方程组。在均匀亚临界基流周围进行线性化后，该系统拥有两个具有不同速度的特征线，在物理上对应于信息的顺流和逆流传播。在动力波公式中，这些特征线与由平均流速 $u(x,t)$ 引起的平流效应和与自由表面压力梯度相关的重力波效应相关联；在亚临界条件下，产生的特征速度是不同的且不为零。相比之下，运动波公式忽略了惯性项和压力梯度项，将传播物理过程简化为单一的类平流特征，其速度取决于阻力定律下的流量-面积关系。\n\n对于应用于双曲系统的显式时间积分格式的数值稳定性，Courant–Friedrichs–Lewy (CFL) 原则要求每一步的数值依赖域必须包含物理依赖域。虽然我们不引用预先推导的公式，但其定性含义是，相对于网格间距 $\\Delta x$ 和存在的最大特征速度，时间步长 $\\Delta t$ 必须足够小，以便格式能够充分追踪信息传播。如果 $\\Delta x$ 减小而 $\\Delta t$ 保持不变，信息在每个数值步长内相对于单元格尺寸可以传播的路径长度会增加；如果每个特征路径长度上的单元格数量变得很大，显式格式可能会失去稳定性，除非相应地减小 $\\Delta t$。\n\n准确性涉及空间截断误差和时间截断误差。减小 $\\Delta x$ 会降低空间截断误差，提高对陡峭梯度和振幅的分辨率，并减少与波状解的粗糙离散化相关的相位误差。然而，对于显式格式，减小 $\\Delta x$ 会收紧对 $\\Delta t$ 的稳定性要求，从而增加模拟给定物理时长所需的时间步数，这会增加计算成本。显式方法的总操作次数通常与空间单元格数和时间步数的乘积成比例。如果网格被细化，使得单元格数量与 $1/\\Delta x$ 成比例，并且为了在存在有限特征速度的情况下保持稳定性，时间步长也必须大致与 $\\Delta x$ 成比例地减小，那么对于固定的模拟时长，总成本大约与 $1/\\Delta x^2$ 成比例，即与 $1/\\Delta x$ 呈超线性关系。\n\n相反，隐式格式允许使用大得多的 $\\Delta t$，因为其稳定性不受限于在每个显式更新中匹配数值和物理依赖域的需求。然而，隐式格式每步的计算成本更高，因为它需要在每一步求解整个网格上的耦合代数方程组（通常是非线性的）。此外，采用非常大的 $\\Delta t$ 会降低准确性：过大的时间步长会导致波传播中的数值耗散和相位滞后，即使格式保持稳定。\n\n关于模型物理，动力波公式包括重力波效应，这引入了额外的（通常更快的）特征传播，相对于纯平流而言。因此，对于相同的 $\\Delta x$，显式动力波格式比运动波格式有更严格的稳定性要求。运动波公式虽然在固定的 $\\Delta x$ 下通常允许更大的 $\\Delta t$，但牺牲了表示快速瞬变、回水效应和向上游传播信号的保真度，而这些在变水位流的洪水演进中可能很重要。\n\n我们现在评估每个选项：\n\nA. 该选项指出，减小 $\\Delta x$ 会提高空间准确性，但会收紧显式动力波格式的稳定性约束，因为信息沿特征线传播，数值步长必须能解析这些路径。它进一步指出，当 $\\Delta x$ 缩小时，显式格式需要更小的 $\\Delta t$，这会增加时间步数和总成本，大约与 $1/\\Delta x$ 呈超线性关系。它补充说，隐式格式放宽了对 $\\Delta t$ 的稳定性限制，但每步成本更高，并且如果 $\\Delta t$ 选择过大，可能会引入数值耗散。最后，它注意到运动波公式由于其传播物理过程更简单，其稳定性约束通常比动力波更宽松（在相同的 $\\Delta x$ 下），但代价是牺牲了对快速变化的瞬态过程的物理准确性。所有这些陈述都与控制方程的双曲性质、Courant–Friedrichs–Lewy 原则的定性含义、隐式与显式积分的权衡以及运动波和动力波公式之间的差异相一致。结论：正确。\n\nB. 该选项声称稳定性仅由摩擦阻尼控制，并且在显式动力波格式中，无论 $\\Delta t$ 如何，减小 $\\Delta x$ 总会增加稳定性。它还断言隐式格式是无条件稳定的，并且即使 $\\Delta t$ 很大，也不会出现数值扩散或相位误差。这两个说法都是不正确的。双曲系统的稳定性不仅由摩擦力决定；特征传播速度是核心，并且显式格式确实需要 $\\Delta t$ 随着 $\\Delta x$ 的减小而减小以保持稳定性。隐式格式虽然对于大的 $\\Delta t$ 通常是稳定的，但当 $\\Delta t$ 过大时，会表现出数值扩散和相位误差。结论：不正确。\n\nC. 该选项断言显式动力波格式的计算成本仅与 $1/\\Delta x$ 呈线性关系，因为在细化网格时可以保持 $\\Delta t$ 不变。它进一步声称动力波每时间步的成本总是比运动波低，并且准确性仅由 $\\Delta t$ 控制。这些陈述与显式格式必须随着 $\\Delta x$ 的缩小而减小 $\\Delta t$ 以解析特征传播的要求相矛盾。由于保留了惯性项和压力梯度项以及更复杂的通量计算，动力波公式每步的成本通常比运动波更高。准确性取决于 $\\Delta x$ 和 $\\Delta t$ 两者。结论：不正确。\n\nD. 该选项假设选择更大的 $\\Delta t$ 总是通过平滑数值噪声来提高准确性，并且只要 $\\Delta x$ 足够小，显式格式就保持稳定。它还声称动力波没有超出运动波的额外稳定性限制，因为在亚临界流中两者具有相同的特征速度。这些说法是错误的。更大的 $\\Delta t$ 通常会通过增加时间截断误差和数值耗散来降低准确性；显式稳定性约束取决于 $\\Delta t$ 与 $\\Delta x$ 的比率以及特征速度，而不仅仅取决于 $\\Delta x$。动力波包括重力波传播，这施加了比运动波更严格的稳定性约束。结论：不正确。\n\n因此，选项 A 是唯一的最佳选择。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一个能够运行的模型不一定是一个正确的模型，最基本的检验之一是模型是否遵守质量等基本物理量的守恒定律。连续性方程的积分形式为诊断质量平衡误差提供了完美的工具。存储体积的变化与随时间累积的净通量之间的任何差异都指向数值实现中的错误，例如边界条件或源项的离散化问题 。",
            "id": "3902839",
            "problem": "要求您设计并实现一个诊断程序，用于诊断由圣维南方程控制的一维明渠演算模拟中的累积质量平衡误差。重点在于代表棱柱形河段的控制体上的积分形式连续性关系，以及源项和边界条件的离散化如何影响质量守恒。\n\n从第一性原理出发，考虑一维明渠流的圣维南连续性方程，\n$$\n\\frac{\\partial A(x,t)}{\\partial t} + \\frac{\\partial Q(x,t)}{\\partial x} = q_\\ell(x,t),\n$$\n其中 $A(x,t)$ 是湿横截面积（单位为 $\\mathrm{m^2}$），$Q(x,t)$ 是流量（单位为 $\\mathrm{m^3\\,s^{-1}}$），$q_\\ell(x,t)$ 是单位长度的侧向入流（单位为 $\\mathrm{m^2\\,s^{-1}}$）。在一个跨越 $x \\in [0,L]$ 的固定控制体上积分，以获得全局连续性（水量平衡）关系，\n$$\n\\frac{\\mathrm{d}V(t)}{\\mathrm{d}t} = Q_{\\mathrm{in}}(t) - Q_{\\mathrm{out}}(t) + Q_{\\ell,\\mathrm{tot}}(t),\n$$\n其中 $V(t)=\\int_0^L A(x,t)\\,\\mathrm{d}x$ 是控制体蓄水量（单位为 $\\mathrm{m^3}$），$Q_{\\mathrm{in}}(t)=Q(0,t)$ 是上游流量（单位为 $\\mathrm{m^3\\,s^{-1}}$），$Q_{\\mathrm{out}}(t)=Q(L,t)$ 是下游流量（单位为 $\\mathrm{m^3\\,s^{-1}}$），$Q_{\\ell,\\mathrm{tot}}(t)=\\int_0^L q_\\ell(x,t)\\,\\mathrm{d}x$ 是河段的总侧向入流（单位为 $\\mathrm{m^3\\,s^{-1}}$）。\n\n将截至时间 $t_N$ 的累积体积偏差定义为\n$$\n\\mathcal{E}(t_N) = V(t_N) - V(t_0) - \\int_{t_0}^{t_N}\\big(Q_{\\mathrm{in}}(t) - Q_{\\mathrm{out}}(t) + Q_{\\ell,\\mathrm{tot}}(t)\\big)\\,\\mathrm{d}t,\n$$\n当积分形式的连续性关系精确满足时，该偏差为零。在数值模型中，源项 $Q_{\\ell,\\mathrm{tot}}(t)$ 的时间离散误差以及边界条件 $Q_{\\mathrm{out}}(t)$ 的施加或报告误差会导致 $\\mathcal{E}(t_N)\\neq 0$。\n\n您必须实现一个程序，给定离散时间 $t_n=t_0+n\\,\\Delta t$ 下的时间序列数组 $V(t_n)$、$Q_{\\mathrm{in}}(t_n)$、$Q_{\\mathrm{out}}(t_n)$ 和 $Q_{\\ell,\\mathrm{tot}}(t_n)$，使用对通量项的二阶精度梯形时间积分来计算累积体积偏差。具体来说，您的程序应计算\n$$\n\\widehat{\\mathcal{E}} = V(t_N) - V(t_0) - \\int_{t_0}^{t_N} \\widehat{F}(t)\\,\\mathrm{d}t,\\quad \\widehat{F}(t):=Q_{\\mathrm{in}}(t)-Q_{\\mathrm{out}}(t)+Q_{\\ell,\\mathrm{tot}}(t),\n$$\n其中积分使用给定的离散样本通过梯形法则进行近似。\n\n使用以下测试套件，该套件指定了 $N+1$ 个采样时间 $t_n=t_0+n\\,\\Delta t$（其中 $n\\in\\{0,1,\\dots,N\\}$），并提供三种情景来探究不同的误差来源：\n\n- 通用时间网格：\n  - $t_0 = 0\\,\\mathrm{s}$，\n  - $\\Delta t = 300\\,\\mathrm{s}$，\n  - $N = 24$，\n  - $t_N = N\\,\\Delta t = 7200\\,\\mathrm{s}$。\n\n- 通用解析定义（用于生成输入数组）：\n  - 上游流量：\n    $$\n    Q_{\\mathrm{in}}(t) = Q_0 + A\\,\\sin^2\\!\\Big(\\frac{\\pi t}{P}\\Big),\n    $$\n    其中 $Q_0=5\\,\\mathrm{m^3\\,s^{-1}}$，$A=3\\,\\mathrm{m^3\\,s^{-1}}$，周期 $P=7200\\,\\mathrm{s}$。\n  - 总侧向入流：\n    $$\n    Q_{\\ell,\\mathrm{tot}}(t) = B + C\\,\\cos\\!\\Big(\\frac{2\\pi t}{P}\\Big),\n    $$\n    其中 $B=1\\,\\mathrm{m^3\\,s^{-1}}$ 且 $C=0.5\\,\\mathrm{m^3\\,s^{-1}}$。\n  - 蓄水量：\n    $$\n    V(t) = V_0 + S\\,\\sin\\!\\Big(\\frac{2\\pi t}{P}\\Big),\n    $$\n    其中 $V_0=10000\\,\\mathrm{m^3}$ 且 $S=500\\,\\mathrm{m^3}$。\n  - 下游流量由精确的全局连续性定义：\n    $$\n    Q_{\\mathrm{out}}(t) = Q_{\\mathrm{in}}(t) + Q_{\\ell,\\mathrm{tot}}(t) - \\frac{\\mathrm{d}V(t)}{\\mathrm{d}t},\\quad \\frac{\\mathrm{d}V}{\\mathrm{d}t}=\\frac{2\\pi S}{P}\\cos\\!\\Big(\\frac{2\\pi t}{P}\\Big).\n    $$\n\n- 情景 A（与精确连续性一致的参考动态解）：\n  - 使用从上述解析定义中采样得到的数组 $Q_{\\mathrm{in}}(t_n)$、$Q_{\\ell,\\mathrm{tot}}(t_n)$、$Q_{\\mathrm{out}}(t_n)$ 和 $V(t_n)$，不作任何修改。\n\n- 情景 B（模拟一阶格式的显式时间源项和通量更新）：\n  - 使用与上面相同的 $Q_{\\mathrm{in}}(t_n)$、$Q_{\\ell,\\mathrm{tot}}(t_n)$ 和 $Q_{\\mathrm{out}}(t_n)$ 样本。\n  - 通过显式欧拉更新构建模型报告的蓄水序列 $\\widetilde{V}(t_n)$\n    $$\n    \\widetilde{V}(t_0)=V(t_0),\\quad \\widetilde{V}(t_n)=\\widetilde{V}(t_{n-1}) + \\Delta t\\,\\Big(Q_{\\mathrm{in}}(t_{n-1}) - Q_{\\mathrm{out}}(t_{n-1}) + Q_{\\ell,\\mathrm{tot}}(t_{n-1})\\Big)\\quad \\text{for } n\\in\\{1,\\dots,N\\}.\n    $$\n  - 在梯形积分中使用 $\\widetilde{V}(t_n)$ 和原始通量数组计算偏差。\n\n- 情景 C（下游边界的边界条件报告不一致）：\n  - 使用与情景 A 中相同的 $Q_{\\mathrm{in}}(t_n)$、$Q_{\\ell,\\mathrm{tot}}(t_n)$ 和 $V(t_n)$。\n  - 通过在中间点索引 $k=N/2$ 处引入单步报告误差，定义一个扰动后的下游流量序列 $\\widehat{Q}_{\\mathrm{out}}(t_n)$：\n    $$\n    \\widehat{Q}_{\\mathrm{out}}(t_n)=\n    \\begin{cases}\n    Q_{\\mathrm{out}}(t_n) - \\delta, \\text{if } n=k,\\\\\n    Q_{\\mathrm{out}}(t_n), \\text{otherwise},\n    \\end{cases}\n    $$\n    其中 $\\delta=0.5\\,\\mathrm{m^3\\,s^{-1}}$ 且 $k=12$。\n  - 使用 $V(t_n)$ 以及 $Q_{\\mathrm{in}}(t_n)$、$\\widehat{Q}_{\\mathrm{out}}(t_n)$ 和 $Q_{\\ell,\\mathrm{tot}}(t_n)$ 计算偏差。\n\n您的程序必须：\n- 根据上述定义，以国际单位制 (SI) 构建 $t_n$、$Q_{\\mathrm{in}}(t_n)$、$Q_{\\ell,\\mathrm{tot}}(t_n)$、$Q_{\\mathrm{out}}(t_n)$、$V(t_n)$ 的数组。\n- 对于每种情景（A、B、C），使用梯形法则计算 $\\widehat{F}(t)$ 的时间积分，从而计算累积偏差 $\\widehat{\\mathcal{E}}$（单位为 $\\mathrm{m^3}$）。\n- 以 $\\mathrm{m^3}$ 为单位表示最终答案，并四舍五入到三位小数。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含情景 A、B 和 C 的三个偏差值，格式为方括号内以逗号分隔的列表（例如 $[e_A,e_B,e_C]$），其中每个 $e_\\cdot$ 是一个以 $\\mathrm{m^3}$ 为单位、四舍五入到三位小数的浮点数。\n\n该测试套件探究了：\n- 一个精确符合的通用情况（情景 A），\n- 由于源和边界通量的显式时间步进而导致的离散化引起的蓄水不一致性（情景 B），\n- 一个局限于单个时间层级的边界条件报告误差（情景 C）。\n\n您的结果必须是可复现和自包含的，无需任何外部输入。输出必须严格遵循指定的单行格式。",
            "solution": "所提出的问题是数值分析在环境与地球系统建模，特别是在明渠水力学领域应用的一个有效练习。它以圣维南方程为科学基础，在数学上是适定的，并且没有歧义或矛盾。所有必要的数据、方程和数值步骤都已明确定义。因此，我们可以进行完整的求解。\n\n此问题的基本原理是在一个确定的控制体内质量守恒，或者对于像水这样的不可压缩流体而言，等效于体积守恒。对于长度为 $L$ 的河段中的一维明渠流，积分形式的连续性方程指出，河段中蓄水体积的变化率 $V(t)$ 必须等于净入流率。这表示为：\n$$\n\\frac{\\mathrm{d}V(t)}{\\mathrm{d}t} = Q_{\\mathrm{in}}(t) - Q_{\\mathrm{out}}(t) + Q_{\\ell,\\mathrm{tot}}(t)\n$$\n这里，$Q_{\\mathrm{in}}(t)$ 是上游边界（$x=0$）的流量，$Q_{\\mathrm{out}}(t)$ 是下游边界（$x=L$）的流量，$Q_{\\ell,\\mathrm{tot}}(t)$ 是沿河段分布的总侧向入流。我们将进入控制体的净通量定义为 $\\widehat{F}(t) = Q_{\\mathrm{in}}(t) - Q_{\\mathrm{out}}(t) + Q_{\\ell,\\mathrm{tot}}(t)$。那么，控制方程就是简单的 $\\frac{\\mathrm{d}V(t)}{\\mathrm{d}t} = \\widehat{F}(t)$。\n\n在时间区间 $[t_0, t_N]$ 上对该关系进行积分，得到蓄水量的精确累积变化：\n$$\n\\int_{t_0}^{t_N} \\frac{\\mathrm{d}V(t)}{\\mathrm{d}t} \\, \\mathrm{d}t = V(t_N) - V(t_0) = \\int_{t_0}^{t_N} \\widehat{F}(t) \\, \\mathrm{d}t\n$$\n在数值模拟中，量 $V(t)$ 和 $\\widehat{F}(t)$ 仅在离散时间步 $t_n = t_0 + n\\,\\Delta t$ 上已知。累积体积偏差 $\\widehat{\\mathcal{E}}$ 的定义是为了衡量数值解在多大程度上违反了这种积分平衡：\n$$\n\\widehat{\\mathcal{E}}(t_N) = \\big(V(t_N) - V(t_0)\\big) - \\int_{t_0}^{t_N} \\widehat{F}(t) \\, \\mathrm{d}t\n$$\n一个非零的 $\\widehat{\\mathcal{E}}$ 值表明，模型报告的蓄水量变化与其报告的时间积分边界和源通量不一致。我们的任务是为三种情景计算这个偏差。积分项将使用二阶精度的梯形法则进行数值近似。对于一个在离散时间 $t_n$ 上以恒定步长 $\\Delta t$ 采样的函数 $\\widehat{F}(t)$，其积分近似为：\n$$\n\\int_{t_0}^{t_N} \\widehat{F}(t) \\, \\mathrm{d}t \\approx \\sum_{n=1}^{N} \\frac{\\widehat{F}(t_{n-1}) + \\widehat{F}(t_n)}{2} \\Delta t = \\Delta t \\left( \\frac{\\widehat{F}(t_0)}{2} + \\sum_{n=1}^{N-1} \\widehat{F}(t_n) + \\frac{\\widehat{F}(t_N)}{2} \\right)\n$$\n我们现在将对每种情景进行分步处理。\n\n首先，我们生成基础的时间序列数据。我们为 $n \\in \\{0, 1, \\dots, 24\\}$ 建立一个时间网格 $t_n$，其中 $t_0=0\\,\\mathrm{s}$ 且 $\\Delta t = 300\\,\\mathrm{s}$。使用提供的解析函数，我们生成上游入流 $Q_{\\mathrm{in}}(t_n)$、总侧向入流 $Q_{\\ell,\\mathrm{tot}}(t_n)$、蓄水体积 $V(t_n)$ 及其时间导数 $\\frac{\\mathrm{d}V}{\\mathrm{d}t}(t_n)$ 的离散数组。然后构建下游出流 $Q_{\\mathrm{out}}(t_n)$，使其在每个离散时间点都满足连续体积平衡方程，从而确保净通量数组 $\\widehat{F}(t_n) = Q_{\\mathrm{in}}(t_n) - Q_{\\mathrm{out}}(t_n) + Q_{\\ell,\\mathrm{tot}}(t_n)$ 与 $\\frac{\\mathrm{d}V}{\\mathrm{d}t}(t_n)$ 的数组逐点相同。\n\n**情景 A：参考动态解**\n此情景用作基准。蓄水量 $V(t_n)$ 和通量 $Q_{\\mathrm{in}}(t_n)$、$Q_{\\mathrm{out}}(t_n)$、$Q_{\\ell,\\mathrm{tot}}(t_n)$ 的输入数据数组都与底层的连续方程相互一致。偏差计算如下：\n$$\n\\widehat{\\mathcal{E}}_A = \\big(V(t_N) - V(t_0)\\big) - \\int_{t_0}^{t_N} \\widehat{F}(t) \\, \\mathrm{d}t\n$$\n从 $V(t)$ 的解析定义可知，蓄水量变化为 $V(t_N) - V(t_0) = V(7200) - V(0) = (V_0 + S\\sin(2\\pi)) - (V_0+S\\sin(0)) = 0$。精确积分 $\\int_{t_0}^{t_N} \\widehat{F}(t) \\, \\mathrm{d}t = \\int_{0}^{P} \\frac{\\mathrm{d}V}{\\mathrm{d}t} \\, \\mathrm{d}t$ 也为零。因此，计算出的偏差 $\\widehat{\\mathcal{E}}_A$ 将仅因梯形法则应用于函数 $\\widehat{F}(t)$ 时的固有误差而非零。这个值衡量了我们诊断工具的“噪声基底”。\n\n**情景 B：显式时间源项**\n此情景模拟了数值模型中质量平衡误差的一个常见来源：用于更新状态变量的时间积分格式与用于计算通量的格式不匹配。这里，使用一阶显式欧拉方法生成一个新的蓄水量数组 $\\widetilde{V}(t_n)$：\n$$\n\\widetilde{V}(t_0)=V(t_0),\\quad \\widetilde{V}(t_n)=\\widetilde{V}(t_{n-1}) + \\Delta t\\,\\widehat{F}(t_{n-1})\\quad \\text{for } n\\in\\{1,\\dots,N\\}\n$$\n然后使用这个新的蓄水序列计算偏差，而通量积分仍使用二阶梯形法则对原始通量数据进行计算：\n$$\n\\widehat{\\mathcal{E}}_B = \\big(\\widetilde{V}(t_N) - \\widetilde{V}(t_0)\\big) - \\int_{t_0}^{t_N} \\widehat{F}(t) \\, \\mathrm{d}t\n$$\n蓄水量的变化是 $\\widetilde{V}(t_N) - \\widetilde{V}(t_0) = \\Delta t \\sum_{n=0}^{N-1} \\widehat{F}(t_n)$，这是一个矩形（左点）法则积分。偏差 $\\widehat{\\mathcal{E}}_B$ 是这个一阶积分近似与二阶梯形近似之间的差值。一个简单的分析表明，这个差值为 $\\frac{\\Delta t}{2}(\\widehat{F}(t_0) - \\widehat{F}(t_N))$。鉴于我们的问题恰好跨越了周期函数 $\\widehat{F}(t)$ 的一个周期（$t_N=P$），我们有 $\\widehat{F}(t_0)=\\widehat{F}(t_N)$。因此，我们预测 $\\widehat{\\mathcal{E}}_B$ 将精确为零。\n\n**情景 C：边界条件报告不一致**\n此情景测试诊断程序对边界条件数据中孤立误差的敏感性。通过假设报告值为 $\\widehat{Q}_{\\mathrm{out}}(t_k) = Q_{\\mathrm{out}}(t_k) - \\delta$（其中 $\\delta=0.5\\,\\mathrm{m^3\\,s^{-1}}$），在单个时间步 $t_k=t_{12}$ 处对下游流量数组进行扰动。这种错误可能源于模型输出或数据同化中的一个程序错误。偏差是使用原始蓄水数组 $V(t_n)$ 但使用由扰动后的出流 $\\widehat{Q}_{\\mathrm{out}}(t_n)$ 派生出的新净通量 $\\widehat{F}_C(t)$ 来计算的。\n$$\n\\widehat{\\mathcal{E}}_C = \\big(V(t_N) - V(t_0)\\big) - \\int_{t_0}^{t_N} \\widehat{F}_C(t) \\, \\mathrm{d}t\n$$\n蓄水量变化 $V(t_N) - V(t_0)$ 仍然为零。通量数组中的扰动仅发生在索引 $k=12$ 处。梯形法则求和仅在两个相邻区间 $[t_{11}, t_{12}]$ 和 $[t_{12}, t_{13}]$ 受到影响。积分通量的总变化为 $\\frac{\\Delta t}{2}\\delta + \\frac{\\Delta t}{2}\\delta = \\delta\\Delta t$。因此，积分项增加了 $\\delta \\Delta t = 0.5 \\times 300 = 150\\,\\mathrm{m^3}$。因此，预测的偏差为 $\\widehat{\\mathcal{E}}_C = \\widehat{\\mathcal{E}}_A - \\delta\\Delta t$。这演示了一个局部化的通量报告误差如何导致一个显著的、可量化的累积质量平衡误差。\n\n实现将遵循这些原则，使用数值库精确地执行所概述的数组操作和梯形积分。",
            "answer": "$$\n\\boxed{[-0.000,0.000,-150.000]}\n$$"
        }
    ]
}