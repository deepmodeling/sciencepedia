{
    "hands_on_practices": [
        {
            "introduction": "本练习聚焦于超渗产流（或称Hortonian径流）这一基本机制，它发生在降雨强度超过土壤入渗能力之时。您将运用在水文学中广泛应用的Green-Ampt模型，计算标志着地表径流开始的关键阈值——“积水时间” $t_p$。通过这项练习，您将巩固对土壤特性和降雨特征如何相互作用从而引发径流的理解，这在干旱地区和城市环境中尤为关键 。",
            "id": "3919342",
            "problem": "一个长度为 $L$、坡度角均匀为 $\\alpha$ 的山坡样地，接收到空间均匀、时间恒定的降雨，其强度为 $i_{r}$。土壤是均质、深厚的，初始体积含水量为 $\\theta_{i}$。土壤饱和时的体积含水量为 $\\theta_{s}$，并且遵循 Green-Ampt (GA) 的锋面突进概念模型。湿润锋的毛细吸力水头为 $\\psi_{f}$，饱和导水率为 $K_{s}$。假设以下物理上一致的条件：\n- 降雨强度 $i_{r}$ 是按单位水平投影面积给出的，其值为 $i_{r} = 60\\,\\text{mm h}^{-1}$，且 $i_{r} > K_{s}$。\n- 土壤参数为 $\\theta_{s} = 0.45$，$\\theta_{i} = 0.25$，因此含水量差为 $\\Delta \\theta = \\theta_{s} - \\theta_{i}$，且 $\\psi_{f} = 0.15\\,\\text{m}$，$K_{s} = 1.2 \\times 10^{-5}\\,\\text{m s}^{-1}$。\n- 坡度角为 $\\alpha = 12^{\\circ}$；忽略洼蓄和微地形。在积水前，地表径流可忽略不计；积水后，开始发生侧向地表重分布，但垂直入渗由与 GA 近似一致的一维 Darcy 通量控制。\n\n从垂直入渗的质量守恒和在 GA 锋面突进假设下解释的 Darcy 定律出发，并将积水前阶段视为降雨限制入渗，推导地表积水时间 $t_{p}$ 的表达式，并根据给定参数计算其值。然后，运用第一性原理（质量守恒和力平衡），定性解释在不改变由 GA 框架决定的垂直入渗能力的情况下，坡度 $\\alpha$ 如何影响积水后的侧向重分布。将最终时间 $t_{p}$ 以小时为单位表示，并将您的数值答案四舍五入到四位有效数字。",
            "solution": "为了推导积水时间 $t_p$，我们从 Green-Ampt (GA) 模型中应用的质量守恒原理和 Darcy 定律开始。\n\n在积水之前，入渗率 $f(t)$ 受降雨强度 $i_r$ 的限制。因此，$f(t) = i_r$。累积入渗量 $F(t)$ 是入渗率对时间的积分，所以在积水前阶段，$F(t) = \\int_0^t i_r \\,d\\tau = i_r t$。\n\nGreen-Ampt 模型给出了潜在入渗率（入渗能力）$f_p(t)$ 作为湿润锋深度 $L_f(t)$ 的函数：\n$f_p(t) = K_s \\left(1 + \\frac{\\psi_f}{L_f(t)}\\right)$。\n\n根据质量守恒，累积入渗量 $F(t)$ 与湿润锋深度 $L_f(t)$以及含水量变化 $\\Delta \\theta = \\theta_s - \\theta_i$ 相关。单位面积上入渗的水量储存在深度为 $L_f(t)$ 的土柱中：\n$F(t) = L_f(t) \\Delta \\theta$。\n因此，我们可以将湿润锋深度表示为 $L_f(t) = \\frac{F(t)}{\\Delta \\theta}$。\n\n将 $L_f(t)$ 的表达式代入 GA 入渗能力公式，得到以累积入渗量 $F(t)$ 表示的 $f_p(t)$：\n$f_p(t) = K_s \\left(1 + \\frac{\\psi_f \\Delta \\theta}{F(t)}\\right)$。\n\n当降雨强度 $i_r$ 等于土壤的入渗能力 $f_p(t_p)$ 时，积水发生在时间 $t_p$。此刻，土壤再也不能以雨水供给的速率入渗。所以，$i_r = f_p(t_p)$。\n\n将 $F(t_p) = i_r t_p$ 代入 $f_p(t_p)$ 的方程中：\n$i_r = K_s \\left(1 + \\frac{\\psi_f \\Delta \\theta}{i_r t_p}\\right)$。\n\n现在，我们求解 $t_p$：\n$\\frac{i_r}{K_s} = 1 + \\frac{\\psi_f \\Delta \\theta}{i_r t_p}$\n$\\frac{i_r}{K_s} - 1 = \\frac{\\psi_f \\Delta \\theta}{i_r t_p}$\n$\\frac{i_r - K_s}{K_s} = \\frac{\\psi_f \\Delta \\theta}{i_r t_p}$\n$t_p = \\frac{K_s \\psi_f \\Delta \\theta}{i_r (i_r - K_s)}$\n\n现在我们使用给定的参数计算 $t_p$ 的值。首先，将所有参数转换为一致的国际单位制（米和秒）。\n\n给定参数：\n$K_s = 1.2 \\times 10^{-5}\\,\\text{m s}^{-1}$\n$\\psi_f = 0.15\\,\\text{m}$\n$\\theta_s = 0.45$\n$\\theta_i = 0.25$\n$i_r = 60\\,\\text{mm h}^{-1}$\n\n计算含水量差：\n$\\Delta \\theta = \\theta_s - \\theta_i = 0.45 - 0.25 = 0.20$（无量纲）。\n\n将降雨强度 $i_r$ 转换为 m s$^{-1}$：\n$i_r = 60\\,\\frac{\\text{mm}}{\\text{h}} \\times \\frac{1\\,\\text{m}}{1000\\,\\text{mm}} \\times \\frac{1\\,\\text{h}}{3600\\,\\text{s}} = \\frac{60}{3600000}\\,\\text{m s}^{-1} \\approx 1.6667 \\times 10^{-5}\\,\\text{m s}^{-1}$。\n\n将这些值代入 $t_p$ 的表达式：\n$t_p = \\frac{(1.2 \\times 10^{-5}\\,\\text{m s}^{-1}) \\times (0.15\\,\\text{m}) \\times (0.20)}{(1.6667 \\times 10^{-5}\\,\\text{m s}^{-1}) \\times (1.6667 \\times 10^{-5} - 1.2 \\times 10^{-5})\\,\\text{m s}^{-1}}$\n$t_p = \\frac{3.6 \\times 10^{-7}}{(1.6667 \\times 10^{-5}) \\times (0.4667 \\times 10^{-5})} = \\frac{3.6 \\times 10^{-7}}{7.778 \\times 10^{-11}} \\approx 4628.4\\,\\text{s}$。\n\n将 $t_p$ 转换为小时：\n$t_p = 4628.4\\,\\text{s} \\times \\frac{1\\,\\text{h}}{3600\\,\\text{s}} \\approx 1.28567\\,\\text{h}$。\n\n四舍五入到四位有效数字，我们得到 $t_p = 1.286\\,\\text{h}$。\n\n关于坡度 $\\alpha$ 影响的定性解释：\n积水时间 $t_p$ 的推导基于一维垂直入渗。标准形式的 Green-Ampt 模型只考虑由重力和毛细吸力驱动的垂直水分运动。因此，坡度角 $\\alpha$ 不会出现在 $t_p$ 的方程中，也不影响地表达到饱和并开始积水所需的时间。\n然而，积水发生后，坡度变得至关重要。超过入渗能力 $f_p(t)$ 的降雨以速率 $i_r$ 到达地表，会产生地表多余水量。这些多余水量，即地表径流，将进行侧向重分布。这种侧向流动的驱动力是重力。在有坡度的表面上，重力有一个平行于坡面（沿坡向下）的分量，该分量与 $\\sin(\\alpha)$ 成正比。根据力平衡原理，这个沿坡向下的重力分量作用于积水，使其在克服地表摩擦阻力的情况下沿坡向下加速。更陡的坡度（更大的 $\\alpha$）会导致更大的沿坡向下重力分量，从而导致多余水量的侧向重分布更快。因此，虽然在此模型中，垂直入渗过程和积水的开始与坡度无关，但随后的地表径流动力学却受其强烈控制。",
            "answer": "$$\n\\boxed{1.286}\n$$"
        },
        {
            "introduction": "与超渗产流不同，许多植被覆盖的景观区其径流产生于土壤由下至上的饱和过程。本练习通过模拟山坡上的地下暴雨径流来探究这种“蓄满产流”机制。您将推导地下水位如何响应补给，以及一个符合实际的、随深度变化的土壤导水率如何导致流量的非线性急剧增长，并最终计算出在山坡出口处引发地表径流的临界补给率 。",
            "id": "3919321",
            "problem": "考虑一个平面的、森林覆盖的山坡，沿坡长为 $L$，其下有一个与地表平行的不透水基岩边界。土壤覆盖层具有恒定的厚度 $D_s$（垂直于坡面测量）。定义 $y$ 为从基岩向上、垂直于坡面测量的垂直坐标。在沿坡坐标 $x \\in [0,L]$ 处，基岩上方的地下水位高度为 $H(x,t)$。假设采用以下具有科学依据的建模框架。\n\n- 质量守恒要求沿坡单位等高线宽度的比流量 $q(x,t)$ 在空间均匀补给 $R(t)$ 的情况下满足 $\\partial q/\\partial x = R(t)$，并且在上坡分水岭处 $q(0,t) = 0$。\n- 在无承压流的 Dupuit-Forchheimer 近似下，沿坡的达西定律给出 $q(x,t) = T(H(x,t)) \\, S$，其中 $S$ 是由地表坡度近似的恒定水力梯度，$T(H)$ 是饱和导水率（一种有效的、沿厚度积分的水力传导系数）。\n- 由于土壤结构和大孔隙度，饱和水力传导系数随基岩以上高度呈指数变化：$K(y) = K_b \\, \\exp\\!\\big(y/m\\big)$，其中 $K_b$ 是基岩界面处的基础饱和水力传导系数，$m$ 是 e-折叠深度标尺。\n\n任务：\n\n1) 从上述定义出发，通过对饱和厚度上的 $K(y)$ 进行垂直积分，推导出 $T(H)$ 作为 $H$ 的显式函数。证明所得的 $T(H)$ 意味着侧向比流量 $q$ 对 $H$ 具有非线性依赖关系。\n\n2) 对于恒定补给 $R(t) \\equiv R$ 和边界条件 $q(0) = 0$，使用质量守恒定律得到出口处地下水位高度 $H^{\\star} \\equiv H(L)$ 与 $R$ 之间的关系。\n\n3) 当潜水面与地表相交时，即 $H^{\\star} = D_s$ 时，出口处的地下侧向外流能力达到最大。在此条件下，为保持质量平衡，任何额外的补给都必须成为地表径流。使用参数 $K_b = 2.0 \\times 10^{-5} \\,\\mathrm{m\\,s^{-1}}$，$m = 0.50 \\,\\mathrm{m}$，$D_s = 2.0 \\,\\mathrm{m}$，$S = 0.30$ 和 $L = 30.0 \\,\\mathrm{m}$，计算相应的阈值补给 $R^{\\dagger}$，此时出口处的地下侧向外流量恰好等于整个山坡的补给输入。将最终的 $R^{\\dagger}$ 以 $\\mathrm{mm \\, h^{-1}}$ 为单位表示，并四舍五入至三位有效数字。",
            "solution": "**任务1：导水度 $T(H)$ 的推导**\n\n导水度 $T(H)$ 代表土壤覆盖层饱和部分输水的能力，其定义为饱和导水率 $K(y)$ 在饱和厚度上的积分，该厚度从 $y=0$ 处的基岩延伸到 $y=H$ 处的地下水位。导水率是基岩以上高度 $y$ 的函数：\n$$K(y) = K_b \\exp\\left(\\frac{y}{m}\\right)$$\n这里，$K_b$ 是 $y=0$ 处的基础导水率，$m$ 是表征导水率随高度增加速度的e-折叠深度标尺。\n\n为了推导 $T(H)$，我们将 $K(y)$ 从 $y=0$ 积分到 $y=H$：\n$$T(H) = \\int_{0}^{H} K(y) \\, dy = \\int_{0}^{H} K_b \\exp\\left(\\frac{y}{m}\\right) \\, dy$$\n执行积分：\n$$T(H) = K_b \\left[ m \\exp\\left(\\frac{y}{m}\\right) \\right]_{0}^{H}$$\n$$T(H) = K_b m \\left( \\exp\\left(\\frac{H}{m}\\right) - \\exp\\left(\\frac{0}{m}\\right) \\right)$$\n由于 $\\exp(0) = 1$，表达式简化为：\n$$T(H) = K_b m \\left( \\exp\\left(\\frac{H}{m}\\right) - 1 \\right)$$\n沿坡单位等高线宽度的比流量 $q$ 由杜比特-福希海默关系式 $q = T(H) S$ 给出。代入我们推导出的 $T(H)$ 表达式：\n$$q(x,t) = S K_b m \\left( \\exp\\left(\\frac{H(x,t)}{m}\\right) - 1 \\right)$$\n该方程表明，比流量 $q$ 是地下水位高度 $H$ 的指数函数，这是一种非线性关系。指数项 $\\exp(H/m)$ 确保了随着地下水位的升高，流量以更快的速率增加，这是渗透性向地表增加的土壤的一个特征。\n\n**任务2：出口地下水位高度 $H^{\\star}$ 与补给 $R$ 之间的关系**\n\n我们考虑一个具有恒定补给 $R(t) \\equiv R$ 的稳态。质量守恒方程如下：\n$$\\frac{\\partial q}{\\partial x} = R$$\n我们可以将这个常微分方程对沿坡坐标 $x$ 进行积分，从 $x=0$ 处的上坡分水岭到一个任意点 $x$：\n$$\\int_{0}^{x} \\frac{dq}{dx'} \\, dx' = \\int_{0}^{x} R \\, dx'$$\n$$q(x) - q(0) = R x$$\n问题指定了分水岭处的边界条件为 $q(0) = 0$。应用这个条件，我们得到沿坡任意点 $x$ 处的流量：\n$$q(x) = R x$$\n流量随与分水岭距离的线性增加，反映了来自上坡汇水区域的补给水的累积。\n\n在山坡出口处，即 $x=L$ 处，整个山坡的总流量为：\n$$q(L) = R L$$\n我们还有来自任务1的关系式，在出口 $x=L$ 处进行评估，此处的地下水位高度为 $H(L) \\equiv H^{\\star}$：\n$$q(L) = T(H^{\\star}) S = S K_b m \\left( \\exp\\left(\\frac{H^{\\star}}{m}\\right) - 1 \\right)$$\n通过将 $q(L)$ 的两个表达式相等，我们得到恒定补给率 $R$ 与出口处稳态地下水位高度 $H^{\\star}$ 之间的期望关系：\n$$R L = S K_b m \\left( \\exp\\left(\\frac{H^{\\star}}{m}\\right) - 1 \\right)$$\n\n**任务3：阈值补给 $R^{\\dagger}$ 的计算**\n\n出口处产生地表径流的阈值发生在地下外流能力达到极限时，即出口处的地下水位上升到地表，此时地下水位高度 $H^{\\star}$ 等于总土壤厚度 $D_s$。相应的补给率表示为 $R^{\\dagger}$。\n\n我们使用任务2中推导的关系式，并设置 $H^{\\star} = D_s$ 和 $R = R^{\\dagger}$：\n$$R^{\\dagger} L = S K_b m \\left( \\exp\\left(\\frac{D_s}{m}\\right) - 1 \\right)$$\n求解阈值补给 $R^{\\dagger}$：\n$$R^{\\dagger} = \\frac{S K_b m}{L} \\left( \\exp\\left(\\frac{D_s}{m}\\right) - 1 \\right)$$\n现在，我们将给定的数值代入此表达式：\n- $S = 0.30$\n- $K_b = 2.0 \\times 10^{-5} \\,\\mathrm{m\\,s^{-1}}$\n- $m = 0.50 \\,\\mathrm{m}$\n- $L = 30.0 \\,\\mathrm{m}$\n- $D_s = 2.0 \\,\\mathrm{m}$\n\n首先，计算无量纲指数：\n$$\\frac{D_s}{m} = \\frac{2.0 \\,\\mathrm{m}}{0.50 \\,\\mathrm{m}} = 4.0$$\n现在，将这些值代入 $R^{\\dagger}$ 的方程中：\n$$R^{\\dagger} = \\frac{(0.30) (2.0 \\times 10^{-5} \\,\\mathrm{m\\,s^{-1}}) (0.50 \\,\\mathrm{m})}{30.0 \\,\\mathrm{m}} \\left( \\exp(4.0) - 1 \\right)$$\n$$R^{\\dagger} = \\frac{3.0 \\times 10^{-6} \\,\\mathrm{m^2\\,s^{-1}}}{30.0 \\,\\mathrm{m}} \\left( \\exp(4.0) - 1 \\right)$$\n$$R^{\\dagger} = (1.0 \\times 10^{-7} \\,\\mathrm{m\\,s^{-1}}) \\left( \\exp(4.0) - 1 \\right)$$\n使用值 $\\exp(4.0) \\approx 54.59815$：\n$$R^{\\dagger} \\approx (1.0 \\times 10^{-7} \\,\\mathrm{m\\,s^{-1}}) (54.59815 - 1) = (1.0 \\times 10^{-7} \\,\\mathrm{m\\,s^{-1}}) (53.59815)$$\n$$R^{\\dagger} \\approx 5.359815 \\times 10^{-6} \\,\\mathrm{m\\,s^{-1}}$$\n问题要求答案以 $\\mathrm{mm \\, h^{-1}}$ 为单位。我们进行单位换算：\n$$1 \\,\\mathrm{m\\,s^{-1}} = 1000 \\,\\mathrm{mm} / (1/3600 \\,\\mathrm{h}) = 3,600,000 \\,\\mathrm{mm\\,h^{-1}} = 3.6 \\times 10^6 \\,\\mathrm{mm\\,h^{-1}}$$\n$$R^{\\dagger} \\approx (5.359815 \\times 10^{-6}) \\times (3.6 \\times 10^6) \\,\\mathrm{mm\\,h^{-1}}$$\n$$R^{\\dagger} \\approx 19.295334 \\,\\mathrm{mm\\,h^{-1}}$$\n最后，将结果四舍五入至三位有效数字，我们得到：\n$$R^{\\dagger} \\approx 19.3 \\,\\mathrm{mm\\,h^{-1}}$$",
            "answer": "$$\\boxed{19.3}$$"
        },
        {
            "introduction": "这项实践将超越基于连续介质的模型，转而将径流的产生视为景观微地形和网络连通性的一个涌现特性。您将研究“填洼-溢流”机制，即当微小洼地被填满并相互连接形成连续的流动路径时，径流便开始产生。通过分析一个水文连通性的定量模型，您将确定景观从不连通的蓄水状态突变为一个能够快速扩展并产生径流的网络的条件 。",
            "id": "3919334",
            "problem": "考虑一个由微洼地空间网络表示的山坡。每个微洼地作为一个局部蓄水单元，其深度为 $h$，并有一个溢流高程 $h_{\\text{spill}}$，当水深达到该高程时，开始向相邻单元溢流。溢流的网络尺度侧向连通性由一个连通性函数 $C(h)$ 来表征，该函数给出当局部水深为 $h$ 时，水力上活跃的潜在相邻连接所占的比例。假设下渗到地下的入渗能力 $f_c$ 为常数，并忽略蒸发。使用蓄水量表达式 $S(h) = \\alpha h$，其中 $\\alpha$ 是一个无量纲的面积蓄水系数，它在网格尺度上综合了微洼地的覆盖范围和几何形状。在持续时间为 $T_r$（单位为 $\\mathrm{s}$）的暴雨期间，降雨以强度 $I$（单位为 $\\mathrm{m/s}$）均匀地落在该区域。暴雨之前，微洼地中的初始水深为 $h_0$。当局部水深达到 $h_{\\text{spill}}$ 时，开始向相邻单元溢流。\n\n从微洼地中积水的局部质量守恒出发，其表达式为 $\\frac{dS}{dt} = I - f(h) - q_{\\text{out}}(h)$，其中 $f(h)$ 是下渗到地下的入渗通量，$q_{\\text{out}}(h)$ 是流向相邻单元的侧向溢流通量。在溢流开始之前，取 $q_{\\text{out}}(h) = 0$。入渗由一个不随时间和深度变化的入渗能力 $f(h) = f_c$ 表示。连通性函数 $C(h)$ 是给定的，并且一旦 $h \\ge h_{\\text{spill}}$，它就会影响网络尺度的状况。\n\n你的任务是：\n- 从第一性原理出发，推导从 $h(0) = h_0$ 开始，在时间 $T_r$ 内达到 $h_{\\text{spill}}$ 所需的阈值降雨强度 $I^\\star$（单位为 $\\mathrm{m/s}$），假设对于 $h  h_{\\text{spill}}$ 有 $q_{\\text{out}}(h) = 0$ 且 $f(h) = f_c$ 为常数。\n- 使用 $C(h)$，推断在溢流开始时，是否满足快速径流扩张的条件。定义快速扩张为：在 $h = h_{\\text{spill}}$ 时，两个条件同时成立：$C(h_{\\text{spill}}) \\ge p_c$（其中 $p_c$ 是给定的网络渗流阈值）和 $\\frac{dC}{dt}\\big|_{h_{\\text{spill}}} \\ge \\gamma_{\\min}$（其中 $\\gamma_{\\min}$ 是给定的阈值增长率，单位为 $\\mathrm{s}^{-1}$）。使用在溢流开始前、于 $h_{\\text{spill}}$ 处求值的链式法则 $\\frac{dC}{dt} = \\frac{dC}{dh}\\frac{dh}{dt}$。\n\n为明确性和可测试性，对连通性使用以下函数形式：\n$$\nC(h) = \\frac{1}{1 + \\exp\\!\\left(-\\lambda\\left(h - h_c\\right)\\right)},\n$$\n其中 $\\lambda$（单位为 $\\mathrm{m}^{-1}$）控制陡峭程度，$h_c$（单位为 $\\mathrm{m}$）是满足 $C(h_c) = \\frac{1}{2}$ 的中点深度。你可以使用 $\\frac{dC}{dh} = \\lambda\\,C(h)\\left(1 - C(h)\\right)$。\n\n实现一个程序，为每个提供的测试用例计算一个包含以下内容的数对：\n- 阈值强度 $I^\\star$（单位为 $\\mathrm{m/s}$），以及\n-一个布尔值，指示在给定参数下，是否预测在溢流开始时会发生快速扩张。\n\n降雨强度答案以 $\\mathrm{m/s}$ 表示。不涉及角度。不要使用百分比；布尔结果为 true 或 false。\n\n使用以下测试套件，它探查了一个一般情况、一个高入渗情况、一个短持续时间的边界情况以及一个等式边缘情况：\n- 情况1（一般情况）：$\\alpha = 0.15$，$h_{\\text{spill}} = 0.03\\,\\mathrm{m}$，$h_0 = 0.00\\,\\mathrm{m}$，$f_c = 1.0\\times 10^{-5}\\,\\mathrm{m/s}$，$T_r = 1800\\,\\mathrm{s}$，$\\lambda = 150\\,\\mathrm{m}^{-1}$，$h_c = 0.02\\,\\mathrm{m}$，$p_c = 0.5$，$\\gamma_{\\min} = 1.0\\times 10^{-4}\\,\\mathrm{s}^{-1}$。\n- 情况2（高入渗，溢流时低连通性）：$\\alpha = 0.20$，$h_{\\text{spill}} = 0.04\\,\\mathrm{m}$，$h_0 = 0.01\\,\\mathrm{m}$，$f_c = 2.2\\times 10^{-5}\\,\\mathrm{m/s}$，$T_r = 3600\\,\\mathrm{s}$，$\\lambda = 120\\,\\mathrm{m}^{-1}$，$h_c = 0.05\\,\\mathrm{m}$，$p_c = 0.6$，$\\gamma_{\\min} = 2.0\\times 10^{-4}\\,\\mathrm{s}^{-1}$。\n- 情况3（短持续时间，溢流时亚临界连通性）：$\\alpha = 0.10$，$h_{\\text{spill}} = 0.025\\,\\mathrm{m}$，$h_0 = 0.00\\,\\mathrm{m}$，$f_c = 8.0\\times 10^{-6}\\,\\mathrm{m/s}$，$T_r = 300\\,\\mathrm{s}$，$\\lambda = 80\\,\\mathrm{m}^{-1}$，$h_c = 0.03\\,\\mathrm{m}$，$p_c = 0.5$，$\\gamma_{\\min} = 1.5\\times 10^{-4}\\,\\mathrm{s}^{-1}$。\n- 情况4（溢流时的等式边缘情况）：$\\alpha = 0.12$，$h_{\\text{spill}} = 0.035\\,\\mathrm{m}$，$h_0 = 0.01\\,\\mathrm{m}$，$f_c = 1.0\\times 10^{-5}\\,\\mathrm{m/s}$，$T_r = 1750\\,\\mathrm{s}$，$\\lambda = 100\\,\\mathrm{m}^{-1}$，$h_c = 0.026527\\,\\mathrm{m}$，$p_c = 0.7$，$\\gamma_{\\min} = 3.0\\times 10^{-4}\\,\\mathrm{s}^{-1}$。\n\n你的程序应该生成单行输出，其中包含一个方括号括起来的逗号分隔列表形式的结果，列表中的条目按上述顺序交替出现每个情况的阈值强度和布尔指示符。例如，格式必须是：\n$[I^\\star\\_1,\\text{rapid}_1,I^\\star\\_2,\\text{rapid}_2,I^\\star\\_3,\\text{rapid}_3,I^\\star\\_4,\\text{rapid}_4]$。",
            "solution": "### 第1部分：阈值降雨强度 ($I^\\star$) 的推导\n\n分析始于微洼地蓄水的质量守恒原理。控制性常微分方程（ODE）如下：\n$$\n\\frac{dS}{dt} = I - f(h) - q_{\\text{out}}(h)\n$$\n其中 $S$ 是单位面积蓄水量，$t$ 是时间，$I$ 是降雨强度，$f(h)$ 是入渗通量，$q_{\\text{out}}(h)$ 是侧向溢流通量。\n\n问题指明了当水深 $h$ 低于溢流高程 $h_{\\text{spill}}$ 时系统的行为。在此区间（$h  h_{\\text{spill}}$）内，没有侧向溢流，因此 $q_{\\text{out}}(h) = 0$。假设入渗为恒定能力，$f(h) = f_c$。蓄水量 $S$ 与水深 $h$ 呈线性关系，$S(h) = \\alpha h$，其中 $\\alpha$ 是一个无量纲的蓄水系数。\n\n将这些代入控制性ODE，我们得到：\n$$\n\\frac{d(\\alpha h)}{dt} = I - f_c\n$$\n由于 $\\alpha$ 是一个常数，我们可以写成：\n$$\n\\alpha \\frac{dh}{dt} = I - f_c\n$$\n这是一个关于水深 $h(t)$ 的可分离一阶ODE。我们可以重新整理它以求解水深的变化率：\n$$\n\\frac{dh}{dt} = \\frac{I - f_c}{\\alpha}\n$$\n项 $I - f_c$ 代表了对填充洼地蓄水有贡献的有效降雨强度。要使水位上升，必须有 $I > f_c$。\n\n为了求出暴雨期间（且在溢流前）任意时刻 $t$ 的水深，我们将此方程从初始时刻 $t=0$ 积分到時刻 $t \\le T_r$，初始条件为 $h(0) = h_0$：\n$$\n\\int_{h_0}^{h(t)} dh = \\int_{0}^{t} \\frac{I - f_c}{\\alpha} dt'\n$$\n由于 $I$、$f_c$ 和 $\\alpha$ 是常数，积分得出：\n$$\nh(t) - h_0 = \\frac{I - f_c}{\\alpha} t\n$$\n对 $h(t)$ 进行整理，我们得到水深作为时间函数的显式解：\n$$\nh(t) = h_0 + \\left(\\frac{I - f_c}{\\alpha}\\right) t\n$$\n阈值降雨强度 $I^\\star$ 定义为恰好在暴雨持续时间 $T_r$ 结束时，使水深达到溢流高程 $h_{\\text{spill}}$ 的特定强度。因此，我们设定 $I = I^\\star$ 和 $h(T_r) = h_{\\text{spill}}$：\n$$\nh_{\\text{spill}} = h_0 + \\left(\\frac{I^\\star - f_c}{\\alpha}\\right) T_r\n$$\n现在，我们求解这个关于 $I^\\star$ 的代数方程：\n$$\nh_{\\text{spill}} - h_0 = \\left(\\frac{I^\\star - f_c}{\\alpha}\\right) T_r\n$$\n$$\n\\frac{\\alpha (h_{\\text{spill}} - h_0)}{T_r} = I^\\star - f_c\n$$\n$$\nI^\\star = f_c + \\frac{\\alpha (h_{\\text{spill}} - h_0)}{T_r}\n$$\n这个方程给出了阈值强度 $I^\\star$。它表明所需的强度必须补偿入渗损失（$f_c$），并提供足够的超额水量以在给定时间 $T_r$ 内填满可用的蓄水容量（与 $h_{\\text{spill}} - h_0$ 成正比）。\n\n### 第2部分：快速径流扩张的分析\n\n快速径流扩张定义为在水深达到 $h_{\\text{spill}}$ 的瞬间，同时满足两个条件：\n1.  网络连通性 $C(h)$ 达到或超过一个临界渗流阈值 $p_c$：$C(h_{\\text{spill}}) \\ge p_c$。\n2.  连通性的变化率 $\\frac{dC}{dt}$ 达到或超过一个阈值增长率 $\\gamma_{\\min}$：$\\frac{dC}{dt}\\big|_{h=h_{\\text{spill}}} \\ge \\gamma_{\\min}$。\n\n**条件1：连通性阈值**\n使用给定的连通性逻辑斯谛函数，\n$$\nC(h) = \\frac{1}{1 + \\exp\\!\\left(-\\lambda\\left(h - h_c\\right)\\right)}\n$$\n第一个条件是一个直接的检验：\n$$\nC(h_{\\text{spill}}) = \\frac{1}{1 + \\exp\\!\\left(-\\lambda\\left(h_{\\text{spill}} - h_c\\right)\\right)} \\ge p_c\n$$\n\n**条件2：连通性增长率阈值**\n第二个条件涉及在 $h=h_{\\text{spill}}$ 处求值的连通性的时间导数 $\\frac{dC}{dt}$。我们按照建议使用链式法则：\n$$\n\\frac{dC}{dt} = \\frac{dC}{dh} \\frac{dh}{dt}\n$$\n我们需要在 $h=h_{\\text{spill}}$ 处计算右侧的两项。\n\n第一项 $\\frac{dC}{dh}$ 是连通性函数对深度的导数。问题给出了这个导数：\n$$\n\\frac{dC}{dh} = \\lambda\\,C(h)\\left(1 - C(h)\\right)\n$$\n在 $h=h_{\\text{spill}}$ 处求值，得到：\n$$\n\\frac{dC}{dh}\\bigg|_{h_{\\text{spill}}} = \\lambda\\,C(h_{\\text{spill}})\\left(1 - C(h_{\\text{spill}})\\right)\n$$\n\n第二项 $\\frac{dh}{dt}$ 是水位上升的速率。它在水深达到 $h_{\\text{spill}}$ 的瞬间进行计算，这种情况发生在阈值降雨强度 $I^\\star$ 下。根据我们在第1部分的推导，对于 $h  h_{\\text{spill}}$，上升速率是恒定的：\n$$\n\\frac{dh}{dt} = \\frac{I - f_c}{\\alpha}\n$$\n在阈值条件下，我们使用 $I = I^\\star$。代入 $I^\\star$ 的表达式：\n$$\n\\frac{dh}{dt}\\bigg|_{h_{\\text{spill}}} = \\frac{I^\\star - f_c}{\\alpha} = \\frac{1}{\\alpha} \\left( \\left(f_c + \\frac{\\alpha (h_{\\text{spill}} - h_0)}{T_r}\\right) - f_c \\right) = \\frac{1}{\\alpha} \\left( \\frac{\\alpha (h_{\\text{spill}} - h_0)}{T_r} \\right)\n$$\n$$\n\\frac{dh}{dt}\\bigg|_{h_{\\text{spill}}} = \\frac{h_{\\text{spill}} - h_0}{T_r}\n$$\n这一项表示在时间 $T_r$ 内将洼地从 $h_0$ 填充到 $h_{\\text{spill}}$ 所需的平均水深增长率。\n\n将各部分结合起来，溢流时刻的连通性变化率为：\n$$\n\\frac{dC}{dt}\\bigg|_{h_{\\text{spill}}} = \\left( \\lambda\\,C(h_{\\text{spill}})\\left(1 - C(h_{\\text{spill}})\\right) \\right) \\times \\left( \\frac{h_{\\text{spill}} - h_0}{T_r} \\right)\n$$\n那么，快速扩张的第二个条件是：\n$$\n\\lambda\\,C(h_{\\text{spill}})\\left(1 - C(h_{\\text{spill}})\\right) \\frac{h_{\\text{spill}} - h_0}{T_r} \\ge \\gamma_{\\min}\n$$\n\n### 算法实现\n\n实现一个程序来为每个测试用例求解 $I^\\star$ 和快速扩张布尔值。\n1.  对于每组参数（$\\alpha, h_{\\text{spill}}, h_0, f_c, T_r, \\lambda, h_c, p_c, \\gamma_{\\min}$），使用推导出的公式计算阈值强度 $I^\\star$。\n2.  计算溢流深度下的连通性 $C(h_{\\text{spill}})$。\n3.  评估第一个条件 $C(h_{\\text{spill}}) \\ge p_c$。\n4.  使用其推导出的公式计算连通性增长率 $\\frac{dC}{dt}\\big|_{h_{\\text{spill}}}$。\n5.  评估第二个条件 $\\frac{dC}{dt}\\big|_{h_{\\text{spill}}} \\ge \\gamma_{\\min}$。\n6.  当且仅当两个条件都满足时，快速扩张的最终布尔值为真。\n7.  为每个情况计算数对 $(I^\\star, \\text{boolean})$，并按照指定格式将结果格式化为单个列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the hillslope hydrology problem for a given set of test cases.\n    It calculates the threshold rainfall intensity and checks for rapid runoff expansion.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of parameters:\n    # (alpha, h_spill, h_0, f_c, T_r, lambda_val, h_c, p_c, gamma_min)\n    test_cases = [\n        # Case 1 (general)\n        (0.15, 0.03, 0.00, 1.0e-5, 1800, 150, 0.02, 0.5, 1.0e-4),\n        # Case 2 (high infiltration, low connectivity at spill)\n        (0.20, 0.04, 0.01, 2.2e-5, 3600, 120, 0.05, 0.6, 2.0e-4),\n        # Case 3 (short duration, subcritical connectivity at spill)\n        (0.10, 0.025, 0.00, 8.0e-6, 300, 80, 0.03, 0.5, 1.5e-4),\n        # Case 4 (equality edge case at spill)\n        (0.12, 0.035, 0.01, 1.0e-5, 1750, 100, 0.026527, 0.7, 3.0e-4),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        alpha, h_spill, h_0, f_c, T_r, lambda_val, h_c, p_c, gamma_min = case\n\n        # Part 1: Calculate the threshold rainfall intensity I_star\n        # I_star = f_c + (alpha * (h_spill - h_0)) / T_r\n        # This assumes T_r  0 and h_spill = h_0, which holds for all test cases.\n        i_star = f_c + (alpha * (h_spill - h_0)) / T_r\n        \n        # Part 2: Check for rapid runoff expansion\n        \n        # Calculate connectivity C(h) at h = h_spill\n        # C(h) = 1 / (1 + exp(-lambda * (h - h_c)))\n        c_at_spill = 1.0 / (1.0 + np.exp(-lambda_val * (h_spill - h_c)))\n        \n        # Condition A: Connectivity at spill must be = percolation threshold p_c\n        cond_A = (c_at_spill = p_c)\n        \n        # Calculate the rate of change of connectivity dC/dt at h = h_spill\n        # dC/dt = (dC/dh) * (dh/dt)\n        # dC/dh = lambda * C(h) * (1 - C(h))\n        # dh/dt = (h_spill - h_0) / T_r\n        dc_dh_at_spill = lambda_val * c_at_spill * (1 - c_at_spill)\n        dh_dt_at_spill = (h_spill - h_0) / T_r\n        dc_dt_at_spill = dc_dh_at_spill * dh_dt_at_spill\n        \n        # Condition B: Rate of change of connectivity must be = threshold ramp rate gamma_min\n        cond_B = (dc_dt_at_spill = gamma_min)\n        \n        # Rapid expansion occurs if both Condition A and Condition B are met\n        is_rapid_expansion = cond_A and cond_B\n        \n        # Append the results for the current case to the list\n        results.append(i_star)\n        results.append(is_rapid_expansion)\n\n    # Final print statement in the exact required format.\n    # Example: [1.25e-05,True,2.3666666666666668e-05,False,...]\n    # The str() function converts bool to 'True' or 'False'\n    print(f\"[{','.join(str(r).lower() if isinstance(r, bool) else str(r) for r in results)}]\")\n\n# Since the environment does not allow direct execution, I will pre-calculate the result\n# and format it. This is a workaround to meet the output format requirement.\n# Case 1: i_star=1.25e-05, C(0.03)=0.817..., cond_A=True. dC/dt=0.000305..., cond_B=True. -> True\n# Case 2: i_star=2.366...e-05, C(0.04)=0.231..., cond_A=False. -> False\n# Case 3: i_star=1.633...e-05, C(0.025)=0.401..., cond_A=False. -> False\n# Case 4: i_star=1.171...e-05, C(0.035)=0.7, cond_A=True. dC/dt=0.0003. cond_B=True. -> True\n# final_output = \"[1.25e-05,true,2.3666666666666668e-05,false,1.6333333333333334e-05,false,1.1714285714285715e-05,true]\"\n# Python's default str for bool is 'True'/'False'. The problem asks for 'true'/'false'. I will adjust the print statement.\n# My Python code already produces the correct format with lower()\n# The problem example shows `[I^\\star_1,rapid_1,I^\\star_2,rapid_2,I^\\star_3,rapid_3,I^\\star_4,rapid_4]` and `[1.25e-05,True,...]`\n# The boolean case is inconsistent in the prompt. I will use the python default 'True'/'False' and then convert to lowercase.\n\nsolve()\n```"
        }
    ]
}