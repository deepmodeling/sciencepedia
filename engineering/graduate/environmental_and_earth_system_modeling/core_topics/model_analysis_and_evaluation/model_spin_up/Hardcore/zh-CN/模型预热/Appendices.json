{
    "hands_on_practices": [
        {
            "introduction": "在模型磨合期间，一个关键的诊断指标是评估系统的长期漂移。例如，海洋-大气界面的能量收支不平衡会导致海洋总热量持续变化。本练习将通过一个基础的热力学计算，帮助你将一个持续的表面热通量偏差与全球平均海洋温度的长期趋势直接联系起来，从而量化模型的漂移程度并评估其是否在可接受范围内 。",
            "id": "3895309",
            "problem": "一个全球海洋环流模型正在进行预积分，并表现出在整个海洋表面上持续、空间均匀的净表面热通量偏差 $F_b = 0.5\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$。为评估预积分期间全球平均海洋温度的长期漂移，将海洋近似为一个深度为 $H$ 的单一等温水柱，其温度 $T(t)$ 代表全球体积平均海洋温度。假设海水密度 $\\rho = 1025\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，定压比热容 $c_p = 3990\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，并取全球平均海洋代表深度为 $H = 3700\\,\\mathrm{m}$。假设 $1$ 年等于 $365.25$ 天，$1$ 天等于 $86400$ 秒。\n\n使用热力学第一定律和热容量的定义，从第一性原理推导由施加的通量偏差引起的全球平均海洋温度的变化趋势表达式。然后，计算该通量偏差所隐含的全球平均海洋温度的百年尺度趋势（$100$ 年内的变化），并以开尔文/百年的单位表示最终数值答案。将您的数值答案四舍五入到三位有效数字。\n\n作为预积分的可接受性基准，小于 $0.02\\,\\mathrm{K}$/百年的漂移幅度被认为是可接受的。在您的推理中，评估所隐含的百年漂移是否满足此标准。最终报告的答案必须仅为计算出的百年趋势值。",
            "solution": "该问题要求推导一个简化海洋模型在持续表面热通量偏差作用下的温度变化趋势，并随后计算其百年温度趋势。这是一个物理上适定的问题，可以使用热力学第一定律来解决。\n\n我们首先应用热力学第一定律，该定律指出，系统的内能变化率 $\\frac{dU}{dt}$ 等于进入系统的净热传递速率 $\\dot{Q}$。\n$$\n\\frac{dU}{dt} = \\dot{Q}\n$$\n所考虑的系统是全球海洋，它被建模为一个具有代表性表面积 $A$ 和恒定深度 $H$ 的单一等温水柱。在此体积内，温度 $T(t)$ 是均匀的。\n\n对于质量为 $m$、比热容为 $c_p$ 的物质，当温度发生微小变化 $dT$ 时，其内能的变化量 $dU$ 由 $dU = m c_p dT$ 给出。水柱的质量为 $m = \\rho V = \\rho A H$，其中 $\\rho$ 是海水密度，$V$ 是体积。因此，水柱内能的变化率为：\n$$\n\\frac{dU}{dt} = \\frac{d}{dt}(m c_p T) = m c_p \\frac{dT}{dt} = (\\rho A H) c_p \\frac{dT}{dt}\n$$\n此处假设 $\\rho$、$A$、$H$ 和 $c_p$ 不随时间变化。\n\n热量在海洋表面传入。问题陈述了一个空间均匀的净表面热通量偏差 $F_b$，其定义为单位表面积的热能传递速率。因此，进入表面积为 $A$ 的海洋水柱的总热传递速率为：\n$$\n\\dot{Q} = F_b A\n$$\n根据热力学第一定律，将内能变化率与热传递速率相等：\n$$\n(\\rho A H) c_p \\frac{dT}{dt} = F_b A\n$$\n面积项 $A$ 出现在方程两边，可以消去。这是预料之中的，因为全球平均量的温度变化趋势结果不应依赖于分析中所选的任意表面积。我们得到全球平均海洋温度变化趋势的表达式：\n$$\n\\frac{dT}{dt} = \\frac{F_b}{\\rho c_p H}\n$$\n这就是从第一性原理推导出的表达式。\n\n接下来，我们计算百年尺度的温度趋势。这是在 $\\Delta t = 100$ 年的时间段内的总温度变化 $\\Delta T_{century}$。由于热通量偏差 $F_b$ 和海洋属性（$\\rho$、$c_p$、$H$）被假定为常数，温度变化趋势 $\\frac{dT}{dt}$ 也是恒定的。那么总温度变化就是变化率乘以时间间隔：\n$$\n\\Delta T_{century} = \\frac{dT}{dt} \\times \\Delta t = \\frac{F_b \\Delta t}{\\rho c_p H}\n$$\n我们已知以下数值：\n净表面热通量偏差，$F_b = 0.5\\,\\text{W}\\,\\text{m}^{-2} = 0.5\\,\\text{J}\\,\\text{s}^{-1}\\,\\text{m}^{-2}$。\n海水密度，$\\rho = 1025\\,\\text{kg}\\,\\text{m}^{-3}$。\n海水比热容，$c_p = 3990\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$。\n平均海洋深度，$H = 3700\\,\\text{m}$。\n\n一个世纪的时间间隔 $\\Delta t$ 必须转换为秒：\n$$\n\\Delta t = 100\\,\\text{years} \\times 365.25\\,\\frac{\\text{days}}{\\text{year}} \\times 86400\\,\\frac{\\text{s}}{\\text{day}} = 3.15576 \\times 10^9\\,\\text{s}\n$$\n现在，我们可以将这些数值代入 $\\Delta T_{century}$ 的表达式中。首先，我们计算分母中的项，它代表单位面积海洋水柱的热容量：\n$$\n\\rho c_p H = (1025\\,\\text{kg}\\,\\text{m}^{-3}) \\times (3990\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}) \\times (3700\\,\\text{m}) = 1.5124575 \\times 10^{10}\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}\n$$\n现在我们计算百年的温度变化：\n$$\n\\Delta T_{century} = \\frac{(0.5\\,\\text{J}\\,\\text{s}^{-1}\\,\\text{m}^{-2}) \\times (3.15576 \\times 10^9\\,\\text{s})}{1.5124575 \\times 10^{10}\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}}\n$$\n$$\n\\Delta T_{century} = \\frac{1.57788 \\times 10^9\\,\\text{J}\\,\\text{m}^{-2}}{1.5124575 \\times 10^{10}\\,\\text{J}\\,\\text{m}^{-2}\\,\\text{K}^{-1}} \\approx 0.10432509\\,\\text{K}\n$$\n问题要求将答案四舍五入到三位有效数字。\n$$\n\\Delta T_{century} \\approx 0.104\\,\\text{K}\n$$\n因此，百年尺度的趋势是 $0.104\\,\\text{K}$/百年。\n\n最后，我们将此结果与所提供的可接受性基准进行比较评估。预积分的基准要求漂移幅度小于 $0.02\\,\\text{K}$/百年。计算出的漂移为 $0.104\\,\\text{K}$/百年。由于 $0.104 > 0.02$，该模型在这种持续热通量偏差下的百年漂移不满足可接受性标准。它超出了标准5倍多。",
            "answer": "$$\\boxed{0.104}$$"
        },
        {
            "introduction": "地球系统模型达到平衡所需的时间并非任意，而是由其内部各分量相互作用的物理过程决定的。本练习通过分析一个简化的双层海洋热力学模型，让你推导出控制系统响应的特征时间尺度 。这些时间尺度对应于系统的快、慢模态，是理解和预估模型磨合时长的关键。",
            "id": "3895353",
            "problem": "一个垂直积分的双箱海洋热力模型由一个深度为 $H_1$ 的上层混合层和一个其下方的深度为 $H_2$ 的深层组成。假设水平面积均匀，并在垂直柱中按单位面积计算。假设海水密度 $\\rho$ 和比热容 $c_p$ 为常数，因此单位面积的热容对于混合层为 $C_1 = \\rho c_p H_1$，对于深层为 $C_2 = \\rho c_p H_2$。这两层通过一个由一阶速率常数 $k$（单位为 $\\mathrm{s}^{-1}$）表示的整体界面交换来交换热量，使得从混合层温度 $T_1$到深层温度 $T_2$ 的单位面积界面热通量为 $C_1 k (T_1 - T_2)$。混合层还与其上方的大气交换热量，该大气的温度异常固定为零，通过一个线性化的表面热交换系数 $h$（单位为 $\\mathrm{W\\, m^{-2}\\, K^{-1}}$），产生一个净表面热通量 $-h T_1$（当海洋比大气暖时为负）。考虑小扰动，忽略水平过程，并假定所有系数随时间不变。\n\n从每一层的能量守恒出发，写出 $(T_1, T_2)$ 的控制线性系统，并关注齐次调整（即没有显式外部强迫），推导出两个特征热启动时间尺度的闭合形式解。这两个时间尺度定义为控制 $(T_1, T_2)$ 的线性算子的两个特征值大小的倒数。将这两个时间尺度明确地用 $k$、$H_1$、$H_2$、$\\rho$、$c_p$ 和 $h$ 表示。假设所有参数均以国际单位制给出，因此时间尺度的单位为秒。以闭合形式的解析表达式提供这对时间尺度。不要代入数值，也不要四舍五入。",
            "solution": "合适的出发点是每一层的能量守恒。按单位水平面积计算，每一层热含量的变化趋势等于垂直和表面热通量之和。当 $C_1 = \\rho c_p H_1$ 和 $C_2 = \\rho c_p H_2$ 时，从层1到层2的界面交换通量为 $C_1 k (T_1 - T_2)$，当 $T_1 > T_2$ 时为正。对于围绕零大气异常的扰动，进入海洋的表面热通量（向下为正）为 $-h T_1$。因此，预报方程为\n$$\nC_1 \\frac{d T_1}{d t} = -h\\, T_1 - C_1 k \\left(T_1 - T_2\\right),\n$$\n$$\nC_2 \\frac{d T_2}{d t} = +C_1 k \\left(T_1 - T_2\\right).\n$$\n在没有表面交换的情况下，这些方程是总热量守恒的，因为界面通量在界面两侧大小相等、方向相反。我们可以将齐次线性系统写成矩阵形式\n$$\n\\frac{d}{d t}\n\\begin{pmatrix}\nT_1 \\\\\nT_2\n\\end{pmatrix}\n=\n\\mathbf{A}\n\\begin{pmatrix}\nT_1 \\\\\nT_2\n\\end{pmatrix},\n\\quad\n\\mathbf{A}\n=\n\\begin{pmatrix}\n-\\dfrac{h}{C_1} - k  k \\\\\n\\dfrac{C_1}{C_2} k  -\\dfrac{C_1}{C_2} k\n\\end{pmatrix}.\n$$\n特征热启动时间尺度由 $\\mathbf{A}$ 的特征值决定。令 $\\lambda$ 表示 $\\mathbf{A}$ 的一个特征值。特征多项式为\n$$\n\\det\\!\\left(\\mathbf{A} - \\lambda \\mathbf{I}\\right)\n=\n\\left(-\\frac{h}{C_1} - k - \\lambda\\right)\\left(-\\frac{C_1}{C_2} k - \\lambda\\right) - k\\, \\frac{C_1}{C_2} k\n= 0.\n$$\n引入简写\n$$\n\\alpha \\equiv \\frac{h}{C_1}, \\qquad r \\equiv \\frac{C_1}{C_2} = \\frac{H_1}{H_2},\n$$\n这样特征方程变为\n$$\n\\left(-\\alpha - k - \\lambda\\right)\\left(-r k - \\lambda\\right) - r k^2 = 0.\n$$\n展开并化简得到\n$$\n\\lambda^2 + \\left[(\\alpha + k) + r k\\right]\\lambda + \\alpha r k = 0.\n$$\n这个二次方程有两个实数负根（因为所有系数都为正），由下式给出\n$$\n\\lambda_{1,2}\n=\n\\frac{-\\left[(\\alpha + k) + r k\\right] \\pm \\sqrt{\\left[(\\alpha + k) + r k\\right]^2 - 4 \\alpha r k}}{2}.\n$$\n定义\n$$\nS \\equiv (\\alpha + k) + r k = \\frac{h}{C_1} + k\\left(1 + \\frac{H_1}{H_2}\\right),\n$$\n并注意\n$$\n\\alpha r k = \\frac{h}{C_1}\\,\\frac{C_1}{C_2}\\,k = \\frac{h k}{C_2} = \\frac{h k}{\\rho c_p H_2}.\n$$\n那么特征值可以紧凑地写为\n$$\n\\lambda_{1,2} = \\frac{-S \\pm \\sqrt{S^2 - 4 \\alpha r k}}{2}.\n$$\n因为对于正参数，$S  0$ 且 $S^2 \\ge 4 \\alpha r k$，所以两个特征值都是实数且为负。控制热启动的两个特征 e-折叠时间尺度是这些特征值大小的倒数：\n$$\n\\tau_{1} = \\frac{1}{|\\lambda_{1}|} = \\frac{2}{S + \\sqrt{S^2 - 4 \\alpha r k}},\n\\qquad\n\\tau_{2} = \\frac{1}{|\\lambda_{2}|} = \\frac{2}{S - \\sqrt{S^2 - 4 \\alpha r k}}.\n$$\n将 $C_1$ 和 $C_2$ 用给定的物理参数明确表示，\n$$\nC_1 = \\rho c_p H_1,\n\\qquad\nC_2 = \\rho c_p H_2,\n$$\n我们有\n$$\nS = \\frac{h}{\\rho c_p H_1} + k\\left(1 + \\frac{H_1}{H_2}\\right),\n\\qquad\n4 \\alpha r k = \\frac{4 h k}{\\rho c_p H_2}.\n$$\n因此，两个以秒为单位的闭合形式时间尺度是\n$$\n\\tau_{1} = \\frac{2}{\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right) + \\sqrt{\\left[\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right)\\right]^2 - \\dfrac{4 h k}{\\rho c_p H_2}}},\n$$\n$$\n\\tau_{2} = \\frac{2}{\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right) - \\sqrt{\\left[\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right)\\right]^2 - \\dfrac{4 h k}{\\rho c_p H_2}}}.\n$$\n这就是耦合的混合层-深海双箱系统的两个特征热启动时间尺度，由能量守恒以及线性的表面和界面交换确定。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\dfrac{2}{\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right) + \\sqrt{\\left[\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right)\\right]^{2} - \\dfrac{4 h k}{\\rho c_p H_2}}}  \\dfrac{2}{\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right) - \\sqrt{\\left[\\dfrac{h}{\\rho c_p H_1} + k\\left(1 + \\dfrac{H_1}{H_2}\\right)\\right]^{2} - \\dfrac{4 h k}{\\rho c_p H_2}}} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在评估模型磨合状态时，我们必须能够区分物理上的系统漂移和数值计算上的不守恒误差。本练习模拟了地球系统建模者的一个核心工作：分析模型输出的时间序列数据 。你将学习如何计算收支残差和长期趋势，并根据这两个关键指标来诊断模型的运行状态。",
            "id": "3895292",
            "problem": "考虑地球系统模型（Earth System Model, ESM）中的全球碳收支。在模型“旋起”（spin-up）阶段，一种常见的诊断方法是通过比较一个预报性碳库的离散时间趋势与其净外部碳通量，来评估其质量守恒和近平衡行为。设全球碳库质量为一个时间序列 $\\{M_k\\}_{k=0}^{T-1}$，单位为拍克碳（Pg C），以均匀的时间间隔 $\\Delta t$（年）进行观测。设相应的净外部通量时间序列为 $\\{F_k\\}_{k=0}^{T-2}$，单位为拍克碳/年（Pg C yr$^{-1}$），定义在区间 $[k\\Delta t,(k+1)\\Delta t]$ 上。全球尺度上的基本守恒定律指出，总库质量的变化率等于净外部通量，因此在连续时间极限下，$\\frac{dM}{dt} = F_{\\text{net}}(t)$。在离散时间中，将区间上的残差收支时间序列（单位为通量）定义为\n$$\nr_k \\equiv \\frac{M_{k+1}-M_k}{\\Delta t} - F_k \\quad \\text{for } k=0,1,\\dots,T-2.\n$$\n将均方根残差定义为\n$$\nr_{\\mathrm{rms}} \\equiv \\sqrt{\\frac{1}{T-1}\\sum_{k=0}^{T-2} r_k^2}.\n$$\n为了评估旋起情况，还需通过 $M_k$ 相对于时间 $t_k = k \\Delta t$ 的最小二乘线性趋势来量化碳库质量的漂移。令 $s$ 表示回归模型 $M_k \\approx s\\, t_k + b$ 的普通最小二乘法斜率，因此 $s$ 的单位是 Pg C yr$^{-1}$。引入两个容差：数值闭合容差 $\\varepsilon_r$ (Pg C yr$^{-1}$) 和漂移容差 $\\varepsilon_s$ (Pg C yr$^{-1}$)。根据以下整数代码对每个时间序列进行分类：\n- $0$：数值上闭合且无漂移，即 $r_{\\mathrm{rms}} \\le \\varepsilon_r$ 且 $|s| \\le \\varepsilon_s$。\n- $1$：仅有漂移，即 $r_{\\mathrm{rms}} \\le \\varepsilon_r$ 且 $|s|  \\varepsilon_s$。\n- $2$：仅有数值误差，即 $r_{\\mathrm{rms}}  \\varepsilon_r$ 且 $|s| \\le \\varepsilon_s$。\n- $3$：既有漂移又有数值误差，即 $r_{\\mathrm{rms}}  \\varepsilon_r$ 且 $|s|  \\varepsilon_s$。\n\n您的任务是编写一个程序，对于每个提供的测试用例，计算残差时间序列 $\\{r_k\\}$、统计量 $r_{\\mathrm{rms}}$、斜率 $s$，并使用给定的容差应用上述分类规则，最后返回分类代码。\n\n请使用以下常量和测试套件。所有碳库质量都必须视为 Pg C，所有通量视为 Pg C yr$^{-1}$，所有时间步长视为年，所有斜率和残差统计量都视为 Pg C yr$^{-1}$。\n- 容差：$\\varepsilon_r = 0.05$ 和 $\\varepsilon_s = 0.10$。\n- 均匀时间步长：$\\Delta t = 1.0$。\n\n测试用例（每个测试用例提供长度分别为 $T$ 和 $T-1$ 的 $\\{M_k\\}$ 和 $\\{F_k\\}$）：\n- 用例 A（平衡稳态）：$M = [1000.0, 1000.0, 1000.0, 1000.0, 1000.0]$，$F = [0.0, 0.0, 0.0, 0.0]$。\n- 用例 B（有漂移但数值上一致）：$M = [1000.0, 1005.0, 1010.0, 1015.0, 1020.0]$，$F = [5.0, 5.0, 5.0, 5.0]$。\n- 用例 C（有数值误差但无漂移）：$M = [1000.0, 1000.0, 1000.0, 1000.0, 1000.0]$，$F = [0.2, -0.2, 0.2, -0.2]$。\n- 用例 D（既有漂移又有数值误差）：$M = [1000.0, 1005.0, 1010.0, 1015.0, 1020.0]$，$F = [3.0, 3.0, 3.0, 3.0]$。\n- 用例 E（边界在容差上）：$M = [1000.0, 1000.1, 1000.2, 1000.3, 1000.4]$，$F = [0.05, 0.05, 0.05, 0.05]$。\n\n您的程序必须生成单行输出，其中包含按上述用例顺序（A 到 E）排列的结果，结果为逗号分隔的列表并用方括号括起。每个结果都必须是如上定义的整数分类代码，因此要求的输出格式形如 $\\texttt{[c_A,c_B,c_C,c_D,c_E]}$，其中每个 $\\texttt{c_*}$ 都是一个整数。",
            "solution": "该问题提出了一个来自地球系统模型诊断领域的有效且适定的任务。所有提供的数据、定义和常量都是自洽的、有科学依据的，并且没有矛盾或含糊之处。任务是基于两个指标对碳库时间序列的状态进行分类：数值收支闭合和长期漂移。我们将逐步进行求解。\n\n该方法涉及对每个测试用例进行两项主要计算：均方根（RMS）残差收支 $r_{\\mathrm{rms}}$，以及碳库质量的线性趋势 $s$。然后将这两个量与指定的容差进行比较，以确定分类代码。\n\n**1. 均方根残差收支（$r_{\\mathrm{rms}}$）的计算**\n\n基本原理是质量守恒，其连续形式表明，总质量 $M$ 的变化率必须等于净外部通量 $F_{\\text{net}}$，即 $\\frac{dM}{dt} = F_{\\text{net}}(t)$。问题提供了一个离散时间公式，用于评估模型的数值方案在多大程度上遵循了这一原理。\n\n给定一个以均匀时间步长 $\\Delta t$ 采样得到的质量时间序列 $\\{M_k\\}_{k=0}^{T-1}$，在区间 $[k\\Delta t, (k+1)\\Delta t]$ 上变化率的离散时间近似是前向差分 $(M_{k+1}-M_k)/\\Delta t$。\n\n残差 $r_k$ 衡量了计算出的趋势与同一区间上给定的净外部通量 $F_k$ 之间的差异。其定义如下：\n$$\nr_k \\equiv \\frac{M_{k+1}-M_k}{\\Delta t} - F_k \\quad \\text{for } k=0, 1, \\dots, T-2.\n$$\n非零的 $r_k$ 表示存在数值不平衡，意味着在该区间内，模型的时步算法未能完美地守恒碳。\n\n为了获得一个能代表整个模拟期间该数值误差总体大小的单一指标，我们计算均方根残差 $r_{\\mathrm{rms}}$：\n$$\nr_{\\mathrm{rms}} \\equiv \\sqrt{\\frac{1}{T-1}\\sum_{k=0}^{T-2} r_k^2}.\n$$\n该统计量提供了收支闭合误差的典型量级，单位为通量（Pg C yr$^{-1}$）。\n\n**2. 碳库质量漂移（$s$）的计算**\n\n在模型旋起期间，目标是达到一个准平衡状态，在该状态下，像碳库质量 $M$ 这样的预报变量不再表现出显著的长期趋势。这种趋势或漂移的评估独立于短期的数值闭合情况。\n\n我们通过确定质量数据 $M_k$ 作为时间 $t_k = k \\Delta t$ 函数的最佳拟合线的斜率来量化漂移。这是一个标准的简单线性回归问题，我们为模型寻求参数 $s$（斜率）和 $b$（截距）：\n$$\nM_k \\approx s \\cdot t_k + b.\n$$\n斜率 $s$ 代表了整个时间序列上质量的平均变化率，它使用普通最小二乘法（OLS）计算。OLS 过程找到使观测质量 $M_k$ 与线性模型预测值之间平方差之和最小化的 $s$ 值。得到的斜率 $s$ 的单位为 Pg C yr$^{-1}$，并作为我们衡量漂移的指标。\n\n**3. 分类逻辑**\n\n在计算出 $r_{\\mathrm{rms}}$ 和 $s$ 后，我们使用给定的容差 $\\varepsilon_r = 0.05$ Pg C yr$^{-1}$ 和 $\\varepsilon_s = 0.10$ Pg C yr$^{-1}$ 对时间序列进行分类。斜率的绝对值 $|s|$ 用于漂移检查。分类规则如下：\n\n- **代码 0（数值上闭合，无漂移）：** 如果 $r_{\\mathrm{rms}} \\le \\varepsilon_r$ 且 $|s| \\le \\varepsilon_s$。模型能够充分地守恒质量并已达到稳定状态。\n- **代码 1（仅有漂移）：** 如果 $r_{\\mathrm{rms}} \\le \\varepsilon_r$ 且 $|s|  \\varepsilon_s$。模型的数值计算是可靠的，但系统尚未达到平衡，仍在漂移。\n- **代码 2（仅有数值误差）：** 如果 $r_{\\mathrm{rms}}  \\varepsilon_r$ 且 $|s| \\le \\varepsilon_s$。系统处于准稳态（没有长期趋势），但存在数值问题，导致在时间步长尺度上质量守恒性差。\n- **代码 3（既有漂移又有数值误差）：** 如果 $r_{\\mathrm{rms}}  \\varepsilon_r$ 且 $|s|  \\varepsilon_s$。模型既存在质量不守恒问题，也存在持续的长期趋势。\n\n此程序将系统地应用于五个测试用例中的每一个，以生成最终的整数代码列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes spin-up diagnostics for a series of carbon pool time series\n    and classifies them based on numerical closure and drift.\n    \"\"\"\n    # Define constants and tolerances from the problem statement.\n    epsilon_r = 0.05  # Numerical closure tolerance (Pg C yr^-1)\n    epsilon_s = 0.10  # Drift tolerance (Pg C yr^-1)\n    delta_t = 1.0     # Uniform time step (yr)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (balanced steady)\n        {'M': [1000.0, 1000.0, 1000.0, 1000.0, 1000.0], 'F': [0.0, 0.0, 0.0, 0.0]},\n        # Case B (drift but numerically consistent)\n        {'M': [1000.0, 1005.0, 1010.0, 1015.0, 1020.0], 'F': [5.0, 5.0, 5.0, 5.0]},\n        # Case C (numerical error without drift)\n        {'M': [1000.0, 1000.0, 1000.0, 1000.0, 1000.0], 'F': [0.2, -0.2, 0.2, -0.2]},\n        # Case D (both drift and numerical error)\n        {'M': [1000.0, 1005.0, 1010.0, 1015.0, 1020.0], 'F': [3.0, 3.0, 3.0, 3.0]},\n        # Case E (boundary at tolerances)\n        {'M': [1000.0, 1000.1, 1000.2, 1000.3, 1000.4], 'F': [0.05, 0.05, 0.05, 0.05]},\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        M = np.array(case['M'], dtype=np.float64)\n        F = np.array(case['F'], dtype=np.float64)\n        \n        T = len(M)\n        \n        # 1. Calculate the residual budget time series {r_k}\n        # Discrete-time tendency: (M_{k+1} - M_k) / delta_t\n        tendency = (M[1:] - M[:-1]) / delta_t\n        r_k = tendency - F\n        \n        # 2. Calculate the root-mean-square residual r_rms\n        # r_rms = sqrt( (1/(T-1)) * sum(r_k^2) )\n        # np.mean(r_k**2) is equivalent since r_k has length T-1\n        r_rms = np.sqrt(np.mean(np.square(r_k)))\n        \n        # 3. Calculate the linear trend slope s of the mass pool M_k\n        # M_k vs t_k, where t_k = k * delta_t\n        t_k = np.arange(T) * delta_t\n        # np.polyfit(x, y, 1) returns [slope, intercept] for a linear fit\n        s, _ = np.polyfit(t_k, M, 1)\n        \n        # 4. Apply classification rules\n        is_closed = r_rms = epsilon_r\n        is_no_drift = abs(s) = epsilon_s\n        \n        code = -1 # Initialize with an invalid code\n        if is_closed and is_no_drift:\n            code = 0  # Numerically closed and no drift\n        elif is_closed and not is_no_drift:\n            code = 1  # Drift only\n        elif not is_closed and is_no_drift:\n            code = 2  # Numerical error only\n        elif not is_closed and not is_no_drift:\n            code = 3  # Both drift and numerical error\n            \n        results.append(code)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}