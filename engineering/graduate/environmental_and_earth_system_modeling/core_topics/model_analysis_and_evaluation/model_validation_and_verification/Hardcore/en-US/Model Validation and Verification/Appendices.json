{
    "hands_on_practices": [
        {
            "introduction": "Before a model's physical realism can be validated against observations, we must first perform the foundational step of code verification: ensuring the software correctly solves the mathematical equations it is designed to represent. This practice introduces the gold-standard method for this task through a grid refinement study. By implementing numerical schemes for a simple transport equation and applying Richardson extrapolation, you will learn to compute the observed order of accuracy, a quantitative measure of how well the code converges to the true solution as the grid resolution increases, without needing the exact solution for comparison .",
            "id": "3896009",
            "problem": "You are asked to design and implement a self-contained computational study to verify spatial discretizations for a one-dimensional linear transport equation via grid refinement and Richardson extrapolation, and to compute the observed order of accuracy. Begin from the governing equation and core definitions. Then derive algorithmic steps to compute differences across multiple grids and estimate the convergence rate.\n\nConsider the one-dimensional linear advection (transport) equation with periodic boundary conditions:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0,\n$$\non the spatial domain $[0, L]$ with $L = 1$ (meters), and constant advection velocity $c = 1$ (meters per second). Use an initial condition\n$$\nu(x, 0) = \\sin(2\\pi x) + \\frac{1}{2}\\cos(4\\pi x),\n$$\nwhich is smooth and periodic over $[0, L]$. Evolve the solution to a final time $T = 0.2$ (seconds). The exact solution is given by\n$$\nu_{\\mathrm{exact}}(x, t) = u(x - ct \\bmod L, 0),\n$$\nwhich follows from the invariance of the shape under translation for constant advection.\n\nFrom the fundamental base:\n- Conservation of advected quantity implies discrete flux differences as the driver of temporal changes.\n- The Courant–Friedrichs–Lewy (CFL) condition ensures stability for explicit schemes; use a fixed $ \\mathrm{CFL} $ number with $0 < \\mathrm{CFL} \\le 1$.\n- On a uniform grid with $N$ points, grid spacing $h = L/N$, and time step $\\Delta t$ chosen to satisfy $c \\Delta t / h = \\nu$ (a chosen $ \\mathrm{CFL} $ number), construct consistent finite difference updates.\n\nImplement two spatial schemes:\n1. A first-order upwind scheme for $c > 0$, using forward Euler in time and upwind differences for space.\n2. A second-order Lax–Wendroff scheme, using a two-term Taylor expansion in time and centered differences in space.\n\nDefine a grid refinement study over triplets of grids with sizes $(N_1, N_2, N_3)$ such that the refinement factor $r$ satisfies $N_2 = r N_1$ and $N_3 = r N_2$, where $r$ is an integer. For each scheme, compute numerical solutions $u_{h_1}$, $u_{h_2}$, and $u_{h_3}$ at $t = T$ on these grids. Construct a restriction operator from fine to coarse grids by sampling every $r$-th point so that discrete comparisons occur at shared locations. Use the discrete $L^2$ norm with physical weighting to measure differences; for a grid with spacing $h$, the discrete $L^2$ norm of a vector $v$ is\n$$\n\\| v \\|_{2,h} = \\sqrt{ h \\sum_{i=1}^{N} v_i^2 }.\n$$\n\nUnder asymptotic grid convergence with error scaling $\\| u_h - u_{\\mathrm{exact}} \\|_{2,h} \\approx C h^p$ for some constant $C$ and observed order $p$, Richardson extrapolation yields that the ratio of successive solution differences computed on appropriately restricted grids is directly connected to $p$ via the refinement factor $r$. Use this relationship to derive the observed order $p$ from three grids for each test case, without using the exact solution. All computations must be performed in double precision floats.\n\nUse $L$ in meters, $c$ in meters per second, and $T$ in seconds. No physical quantity in the final answers requires unit reporting since the observed order of accuracy $p$ is dimensionless.\n\nTest Suite:\n- Case $1$: First-order upwind, $(N_1, N_2, N_3) = (64, 128, 256)$, $r = 2$, $L = 1$, $c = 1$, $T = 0.2$, $\\mathrm{CFL} = 0.5$.\n- Case $2$: Second-order Lax–Wendroff, $(N_1, N_2, N_3) = (64, 128, 256)$, $r = 2$, $L = 1$, $c = 1$, $T = 0.2$, $\\mathrm{CFL} = 0.5$.\n- Case $3$: First-order upwind (coarser grids, a boundary case), $(N_1, N_2, N_3) = (16, 32, 64)$, $r = 2$, $L = 1$, $c = 1$, $T = 0.2$, $\\mathrm{CFL} = 0.5$.\n- Case $4$: Second-order Lax–Wendroff (finer grids, approaching asymptotic regime), $(N_1, N_2, N_3) = (128, 256, 512)$, $r = 2$, $L = 1$, $c = 1$, $T = 0.2$, $\\mathrm{CFL} = 0.5$.\n\nYour program must:\n- Discretize the problem according to the specified scheme and parameters.\n- Integrate to time $T$ using the chosen $ \\mathrm{CFL} $ number.\n- For each case, compute the observed order $p$ using Richardson extrapolation from the three solutions on multiple meshes, via differences restricted to a shared grid as described above.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[p_1, p_2, p_3, p_4]$). Each $p_i$ must be a float. No other text must be printed.\n\nThe final output has no physical units because the observed order of accuracy $p$ is dimensionless. Angles, if any, should be in radians, but none are used. Percentages must not be used anywhere; all ratios must be expressed as decimals. The output must be reproducible with no external input or files.",
            "solution": "The objective of this study is to computationally verify the theoretical order of accuracy, $p$, for two distinct finite difference schemes applied to the one-dimensional linear advection equation. This verification is performed via a grid refinement study. The observed order of accuracy is calculated using Richardson extrapolation applied to numerical solutions from a triplet of successively refined grids. This method allows for the estimation of $p$ without requiring access to the exact analytical solution.\n\nThe governing partial differential equation (PDE) is the linear advection equation on a spatial domain $x \\in [0, L]$:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\nHere, $u(x, t)$ represents the advected quantity, $c$ is the constant advection velocity, and the system is subject to periodic boundary conditions, $u(0, t) = u(L, t)$. The problem specifies the physical parameters as $L=1$ m, $c=1$ m/s, and a final integration time of $T=0.2$ s. The simulation begins from a smooth, periodic initial condition:\n$$\nu(x, 0) = \\sin(2\\pi x) + \\frac{1}{2}\\cos(4\\pi x)\n$$\nThe spatial domain is discretized into $N$ uniform cells of width $h = L/N$, with grid points located at $x_i = i h$ for $i = 0, 1, \\dots, N-1$. The numerical solution at grid point $i$ and time step $n$ is denoted by $u_i^n$, which approximates the exact solution $u(x_i, n\\Delta t)$. The time step $\\Delta t$ is determined by fixing the Courant–Friedrichs–Lewy (CFL) number, $\\nu = c \\Delta t / h$. For the stability of the explicit schemes employed, it is necessary that $\\nu \\le 1$. In this study, we use a target CFL number $\\nu_{\\text{target}} = 0.5$. The number of time steps is set to $N_t = \\lceil T/( \\nu_{\\text{target}} h / c) \\rceil$, and the time step is then adjusted to $\\Delta t = T/N_t$. This procedure ensures that the final time $T$ is reached precisely and that the effective CFL number $\\nu = c \\Delta t / h \\le \\nu_{\\text{target}}$.\n\nTwo numerical schemes are implemented for the spatial discretization.\n\n**1. First-Order Upwind Scheme:**\nFor a positive advection velocity $c > 0$, the \"upwind\" direction corresponds to the negative $x$-direction. The spatial derivative is approximated using a first-order backward difference:\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_i^n \\approx \\frac{u_i^n - u_{i-1}^n}{h}\n$$\nDiscretizing the PDE using the forward Euler method for the temporal derivative, $\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = -c \\left(\\frac{\\partial u}{\\partial x}\\right)_i^n$, we derive the update formula:\n$$\nu_i^{n+1} = u_i^n - \\frac{c \\Delta t}{h} (u_i^n - u_{i-1}^n) = u_i^n - \\nu (u_i^n - u_{i-1}^n)\n$$\nThe periodic boundary condition implies that for $i=0$, the value $u_{-1}^n$ is taken as $u_{N-1}^n$. This scheme is theoretically first-order accurate in both space and time, so we expect $p \\approx 1$.\n\n**2. Second-Order Lax–Wendroff Scheme:**\nTo achieve second-order accuracy, we begin with a second-order Taylor series expansion in time:\n$$\nu(x, t+\\Delta t) = u(x,t) + \\Delta t \\frac{\\partial u}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 u}{\\partial t^2} + O((\\Delta t)^3)\n$$\nFrom the governing PDE, we can substitute the time derivatives with spatial derivatives: $\\frac{\\partial u}{\\partial t} = -c \\frac{\\partial u}{\\partial x}$ and, by extension, $\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}$. This transforms the Taylor expansion into:\n$$\nu(x, t+\\Delta t) = u(x,t) - c \\Delta t \\frac{\\partial u}{\\partial x} + \\frac{c^2 (\\Delta t)^2}{2} \\frac{\\partial^2 u}{\\partial x^2} + O((\\Delta t)^3)\n$$\nWe then discretize the spatial derivatives using second-order centered difference approximations:\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_i^n \\approx \\frac{u_{i+1}^n - u_{i-1}^n}{2h} \\quad \\text{and} \\quad \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i^n \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2}\n$$\nSubstituting these approximations into the expansion and using the definition $\\nu = c \\Delta t/h$, we obtain the Lax-Wendroff update formula:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\nu}{2}(u_{i+1}^n - u_{i-1}^n) + \\frac{\\nu^2}{2}(u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\nThis scheme is second-order accurate in both space and time, and thus we expect $p \\approx 2$.\n\n**Verification via Richardson Extrapolation:**\nTo determine the observed order of accuracy $p$, we assume that the error in a numerical solution $u_h$ on a grid with spacing $h$ behaves asymptotically as $\\| u_h - u_{\\mathrm{exact}} \\|_{2,h} \\approx K h^p$ for some constant $K$.\n\nWe use solutions on three grids of sizes $N_1$, $N_2 = r N_1$, and $N_3 = r N_2 = r^2 N_1$, with corresponding grid spacings $h_1 = L/N_1$, $h_2 = h_1/r$, and $h_3 = h_1/r^2$. Let the numerical solutions on these grids at time $T$ be $u_1$, $u_2$, and $u_3$. To compare them, we restrict the solutions from the finer grids onto the coarsest grid ($N_1$ points) by sampling. Let $f_1 = u_1$, $f_2$ be the solution $u_2$ restricted by taking every $r$-th point, and $f_3$ be the solution $u_3$ restricted by taking every $(r^2)$-th point.\n\nThe error of each solution, evaluated on the common coarse grid, is approximately $f_k(x) - u_{\\mathrm{exact}}(x) \\approx C(x) h_k^p$. The differences between consecutive solutions are then:\n$$\nf_2(x) - f_1(x) \\approx C(x) (h_2^p - h_1^p) = C(x) h_1^p (r^{-p} - 1)\n$$\n$$\nf_3(x) - f_2(x) \\approx C(x) (h_3^p - h_2^p) = C(x) h_2^p (r^{-p} - 1) = C(x) (h_1/r)^p (r^{-p} - 1)\n$$\nWe compute the discrete $L^2$ norm of these difference vectors on the coarse grid, defined as $\\|v\\|_{2,h_1} = \\sqrt{h_1 \\sum_i v_i^2}$. Let $D_{21} = \\|f_2 - f_1\\|_{2,h_1}$ and $D_{32} = \\|f_3 - f_2\\|_{2,h_1}$. The ratio of these norms is:\n$$\n\\frac{D_{21}}{D_{32}} \\approx \\frac{\\|C(x) h_1^p (r^{-p} - 1)\\|_{2,h_1}}{\\|C(x) (h_1/r)^p (r^{-p} - 1)\\|_{2,h_1}} = \\frac{h_1^p}{(h_1/r)^p} = r^p\n$$\nSolving for $p$ yields the formula for the observed order of accuracy:\n$$\np = \\frac{\\log(D_{21} / D_{32})}{\\log(r)}\n$$\nThis algorithm is implemented in double-precision floating-point arithmetic to compute $p$ for each test case specified in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef u_initial(x, L):\n    \"\"\"\n    Computes the initial condition u(x, 0) for the advection equation.\n    \"\"\"\n    return np.sin(2 * np.pi * x / L) + 0.5 * np.cos(4 * np.pi * x / L)\n\ndef upwind_step(u, nu):\n    \"\"\"\n    Performs one time step of the first-order upwind scheme.\n    u_i^{n+1} = u_i^n - nu * (u_i^n - u_{i-1}^n)\n    \"\"\"\n    u_prev = np.roll(u, 1)  # Periodicity handled by np.roll\n    return u - nu * (u - u_prev)\n\ndef lax_wendroff_step(u, nu):\n    \"\"\"\n    Performs one time step of the second-order Lax-Wendroff scheme.\n    u_i^{n+1} = u_i^n - nu/2 * (u_{i+1}^n - u_{i-1}^n) + nu^2/2 * (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n    \"\"\"\n    u_prev = np.roll(u, 1)   # u_{i-1}\n    u_next = np.roll(u, -1)  # u_{i+1}\n    term1 = -0.5 * nu * (u_next - u_prev)\n    term2 = 0.5 * nu**2 * (u_next - 2 * u + u_prev)\n    return u + term1 + term2\n\ndef solve_pde(N, L, c, T, cfl, scheme_name):\n    \"\"\"\n    Solves the 1D linear advection equation until time T.\n    \n    Returns the numerical solution u at final time T.\n    \"\"\"\n    h = L / N\n    # Ideal dt to match the CFL target\n    dt_ideal = cfl * h / c\n    # Calculate number of steps to reach T, then adjust dt to hit T exactly.\n    n_steps = int(np.ceil(T / dt_ideal))\n    dt = T / n_steps\n    # The effective CFL number nu will be <= the target cfl.\n    nu = c * dt / h\n    \n    # Define the grid, excluding the endpoint L due to periodicity\n    x = np.linspace(0, L, N, endpoint=False)\n    u = u_initial(x, L)\n\n    if scheme_name == 'upwind':\n        step_func = upwind_step\n    elif scheme_name == 'lax_wendroff':\n        step_func = lax_wendroff_step\n    else:\n        raise ValueError(f\"Unknown scheme: {scheme_name}\")\n\n    for _ in range(n_steps):\n        u = step_func(u, nu)\n    \n    return u\n\ndef l2_norm(v, h):\n    \"\"\"\n    Computes the discrete L2 norm: sqrt(h * sum(v_i^2)).\n    \"\"\"\n    return np.sqrt(h * np.sum(v**2))\n\ndef compute_order_of_accuracy(case):\n    \"\"\"\n    Computes the observed order of accuracy p from a grid refinement study.\n    \"\"\"\n    scheme, N_tuple, r, L, c, T, cfl = case\n    N1, N2, N3 = N_tuple\n\n    # 1. Solve the PDE on the three grids\n    u1 = solve_pde(N1, L, c, T, cfl, scheme)\n    u2 = solve_pde(N2, L, c, T, cfl, scheme)\n    u3 = solve_pde(N3, L, c, T, cfl, scheme)\n\n    # 2. Restrict solutions from fine grids to the coarsest grid\n    u2_on_1 = u2[::r]\n    u3_on_1 = u3[::(r*r)]\n    \n    # 3. Compute difference vectors on the coarse grid\n    diff_21 = u2_on_1 - u1\n    diff_32 = u3_on_1 - u2_on_1\n    \n    # 4. Compute L2 norms of the differences using the coarse grid spacing h1\n    h1 = L / N1\n    norm_21 = l2_norm(diff_21, h1)\n    norm_32 = l2_norm(diff_32, h1)\n    \n    # 5. Calculate the observed order of accuracy p\n    # Handle potential for norm_32 being zero to avoid division by zero or log(0)\n    if norm_32 == 0.0:\n        return np.nan  # p is undefined or infinite\n\n    ratio = norm_21 / norm_32\n    \n    # If ratio is non-positive, log is undefined. This can happen if not in\n    # the asymptotic regime or with oscillating convergence.\n    if ratio <= 0:\n        return np.nan\n        \n    p = np.log(ratio) / np.log(r)\n    return p\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (scheme_name, (N1, N2, N3), refinement_factor r, L, c, T, CFL)\n    test_cases = [\n        ('upwind', (64, 128, 256), 2, 1.0, 1.0, 0.2, 0.5),\n        ('lax_wendroff', (64, 128, 256), 2, 1.0, 1.0, 0.2, 0.5),\n        ('upwind', (16, 32, 64), 2, 1.0, 1.0, 0.2, 0.5),\n        ('lax_wendroff', (128, 256, 512), 2, 1.0, 1.0, 0.2, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        p = compute_order_of_accuracy(case)\n        results.append(p)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Complex Earth System Models possess components with long memory, such as deep oceans and ice sheets, requiring a lengthy \"spin-up\" period to reach a stable, statistically-stationary state. Meaningful validation against climate data is only possible after the model's initial transients have decayed. This exercise demonstrates a principled approach to estimating the necessary spin-up time by analyzing the linearized dynamics of a model near its equilibrium, a process essential for designing and interpreting long-term model simulations . You will use eigenvalue analysis of the system's Jacobian matrix to identify the slowest-decaying modes of variability that govern the equilibration timescale.",
            "id": "3895979",
            "problem": "Consider an Earth System Model (ESM) undergoing spin-up, where validation of the model requires that initial transients decay sufficiently so that diagnostic quantities can be meaningfully compared to observations. Near a statistically steady reference state, let the prognostic state-vector anomaly $\\mathbf{y}(t) = \\mathbf{x}(t) - \\mathbf{x}^{\\ast}$ be governed by a linearized system derived from the tangent linear approximation,\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{J}\\,\\mathbf{y},\n$$\nwhere $\\mathbf{J}$ is the Jacobian matrix of the nonlinear tendency evaluated at $\\mathbf{x}^{\\ast}$. Suppose\n$$\n\\mathbf{J} = \n\\begin{pmatrix}\n-0.3 & 0.1 & 0 \\\\\n0.2 & -0.5 & 0 \\\\\n0 & 0 & -0.07\n\\end{pmatrix}\n\\quad \\text{day}^{-1},\n$$\nand the initial anomaly is\n$$\n\\mathbf{y}(0) = \n\\begin{pmatrix}\n0.03 \\\\\n-0.02 \\\\\n0.50\n\\end{pmatrix}.\n$$\nA common spin-up criterion for validation is that the anomaly norm be below a fixed tolerance, here imposed as the Euclidean norm threshold\n$$\n\\|\\mathbf{y}(t)\\|_{2} \\leq \\varepsilon,\n\\quad \\text{with} \\quad\n\\varepsilon = 10^{-3}.\n$$\nUsing eigenvalue analysis of the Jacobian $\\mathbf{J}$ and starting from first principles of linear systems and matrix exponentials, derive a principled estimate for the spin-up time based on the decay of initial transients. Then, compute the spin-up time for the system above that guarantees the criterion $\\|\\mathbf{y}(t)\\|_{2} \\leq \\varepsilon$ is satisfied under the conservative assumption that the slowest decaying eigenmode with nonzero projection sets the time scale. Round your answer to three significant figures. Express the spin-up time in days.",
            "solution": "The problem is to determine the spin-up time for a linearized Earth System Model (ESM) by finding the time $t$ required for the Euclidean norm of the state-vector anomaly, $\\|\\mathbf{y}(t)\\|_{2}$, to fall below a given threshold $\\varepsilon$.\n\nThe problem is governed by the linear system of ordinary differential equations:\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{J}\\,\\mathbf{y}\n$$\nwith the initial condition $\\mathbf{y}(0)$. The formal solution to this initial value problem is given by:\n$$\n\\mathbf{y}(t) = \\exp(\\mathbf{J}t)\\mathbf{y}(0)\n$$\nwhere $\\exp(\\mathbf{J}t)$ is the matrix exponential.\n\nTo analyze the behavior of $\\mathbf{y}(t)$, we decompose the solution in terms of the eigenvalues and eigenvectors of the Jacobian matrix $\\mathbf{J}$. If $\\mathbf{J}$ is diagonalizable, with eigenvalues $\\lambda_i$ and corresponding eigenvectors $\\mathbf{v}_i$, we can express the initial condition $\\mathbf{y}(0)$ as a linear combination of these eigenvectors:\n$$\n\\mathbf{y}(0) = \\sum_{i=1}^{n} c_i \\mathbf{v}_i\n$$\nwhere $c_i$ are scalar coefficients. The solution at time $t$ is then given by:\n$$\n\\mathbf{y}(t) = \\sum_{i=1}^{n} c_i \\exp(\\lambda_i t) \\mathbf{v}_i\n$$\nThe eigenvalues $\\lambda_i$ determine the temporal evolution of each mode. For a stable system approaching a steady state, the real parts of all eigenvalues must be negative, $\\text{Re}(\\lambda_i) < 0$. The rate of decay of each mode is given by $|\\text{Re}(\\lambda_i)|$. The \"slowest decaying eigenmode\" is the one corresponding to the eigenvalue $\\lambda_s$ with the smallest non-zero absolute real part, i.e., $\\lambda_s = \\arg \\min_{\\lambda_i} \\{|\\text{Re}(\\lambda_i)| : \\text{Re}(\\lambda_i) < 0\\}$. For large times $t$, the term corresponding to this eigenvalue will dominate the sum, as all other terms will have decayed more rapidly.\n\nFirst, we must find the eigenvalues of the given Jacobian matrix:\n$$\n\\mathbf{J} = \n\\begin{pmatrix}\n-0.3 & 0.1 & 0 \\\\\n0.2 & -0.5 & 0 \\\\\n0 & 0 & -0.07\n\\end{pmatrix}\n$$\nThe matrix $\\mathbf{J}$ is block-diagonal, which simplifies the eigenvalue problem. The eigenvalues are the eigenvalues of the diagonal blocks.\nOne block is the scalar $-0.07$, so one eigenvalue is immediately identified as:\n$$\n\\lambda_3 = -0.07\n$$\nThe other block is the $2 \\times 2$ matrix:\n$$\n\\mathbf{J}_{12} = \n\\begin{pmatrix}\n-0.3 & 0.1 \\\\\n0.2 & -0.5\n\\end{pmatrix}\n$$\nThe eigenvalues of this block are the roots of the characteristic equation $\\det(\\mathbf{J}_{12} - \\lambda\\mathbf{I}) = 0$.\n$$\n(-0.3 - \\lambda)(-0.5 - \\lambda) - (0.1)(0.2) = 0\n$$\n$$\n\\lambda^2 + 0.8\\lambda + 0.15 - 0.02 = 0\n$$\n$$\n\\lambda^2 + 0.8\\lambda + 0.13 = 0\n$$\nUsing the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\n\\lambda = \\frac{-0.8 \\pm \\sqrt{0.8^2 - 4(1)(0.13)}}{2} = \\frac{-0.8 \\pm \\sqrt{0.64 - 0.52}}{2} = \\frac{-0.8 \\pm \\sqrt{0.12}}{2}\n$$\n$$\n\\lambda = -0.4 \\pm \\sqrt{\\frac{0.12}{4}} = -0.4 \\pm \\sqrt{0.03}\n$$\nSo the other two eigenvalues are:\n$$\n\\lambda_1 = -0.4 - \\sqrt{0.03} \\approx -0.5732\n$$\n$$\n\\lambda_2 = -0.4 + \\sqrt{0.03} \\approx -0.2268\n$$\nThe three eigenvalues of $\\mathbf{J}$ are all real and negative:\n$\\lambda_1 \\approx -0.5732$, $\\lambda_2 \\approx -0.2268$, and $\\lambda_3 = -0.07$.\n\nThe slowest decaying mode corresponds to the eigenvalue with the smallest magnitude:\n$$\n|\\lambda_1| \\approx 0.5732 \\quad \\text{day}^{-1}\n$$\n$$\n|\\lambda_2| \\approx 0.2268 \\quad \\text{day}^{-1}\n$$\n$$\n|\\lambda_3| = 0.07 \\quad \\text{day}^{-1}\n$$\nThe slowest mode is associated with $\\lambda_3 = -0.07 \\, \\text{day}^{-1}$.\n\nThe problem requires that this mode have a \"nonzero projection\". The block-diagonal structure means the system is decoupled. The state $\\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix}$ evolves independently of $y_3$. The eigenvector corresponding to $\\lambda_3 = -0.07$ is in the direction of the third coordinate axis, i.e., $\\mathbf{v}_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$. The projection of the initial condition $\\mathbf{y}(0)$ onto this mode is simply its third component.\nGiven $\\mathbf{y}(0) = \\begin{pmatrix} 0.03 \\\\ -0.02 \\\\ 0.50 \\end{pmatrix}$, the third component is $y_3(0) = 0.50$. Since this is non-zero, the slowest mode is excited.\n\nThe solution for the third component is:\n$$\ny_3(t) = y_3(0) \\exp(\\lambda_3 t) = 0.50 \\exp(-0.07 t)\n$$\nThe solution for the other two components, $\\mathbf{y}_{12}(t) = \\begin{pmatrix} y_1(t) \\\\ y_2(t) \\end{pmatrix}$, decays according to $\\exp(\\lambda_1 t)$ and $\\exp(\\lambda_2 t)$. Since $|\\lambda_1|$ and $|\\lambda_2|$ are both significantly larger than $|\\lambda_3|$, the $\\mathbf{y}_{12}$ components will decay to zero much faster than the $y_3$ component.\nFor calculating the spin-up time, we are interested in the behavior at large $t$, where the slowest mode dominates the dynamics. Therefore, we can approximate the state vector as:\n$$\n\\mathbf{y}(t) \\approx \\begin{pmatrix} 0 \\\\ 0 \\\\ y_3(t) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0.50 \\exp(-0.07 t) \\end{pmatrix}\n$$\nThe spin-up criterion is $\\|\\mathbf{y}(t)\\|_{2} \\leq \\varepsilon$, with $\\varepsilon = 10^{-3}$. We apply this to our approximation to find the time $t_{spinup}$ that guarantees the condition is met under the specified assumption.\n$$\n\\|\\mathbf{y}(t_{spinup})\\|_{2} \\approx \\left\\| \\begin{pmatrix} 0 \\\\ 0 \\\\ 0.50 \\exp(-0.07 t_{spinup}) \\end{pmatrix} \\right\\|_{2} = 0.50 \\exp(-0.07 t_{spinup})\n$$\nWe set this equal to the threshold $\\varepsilon$:\n$$\n0.50 \\exp(-0.07 t_{spinup}) = 10^{-3}\n$$\nNow, we solve for $t_{spinup}$:\n$$\n\\exp(-0.07 t_{spinup}) = \\frac{10^{-3}}{0.50} = 2 \\times 10^{-3}\n$$\nTaking the natural logarithm of both sides:\n$$\n-0.07 t_{spinup} = \\ln(2 \\times 10^{-3})\n$$\n$$\nt_{spinup} = -\\frac{\\ln(2 \\times 10^{-3})}{0.07}\n$$\nNow we compute the numerical value:\n$$\nt_{spinup} = -\\frac{\\ln(0.002)}{0.07} \\approx -\\frac{-6.214608}{0.07} \\approx 88.78011 \\ldots\n$$\nRounding the answer to three significant figures, we get:\n$$\nt_{spinup} \\approx 88.8 \\, \\text{days}\n$$\nThis is the estimated time required for the norm of the transient anomaly to decay below the specified tolerance, based on the dynamics of the slowest excited mode.",
            "answer": "$$\\boxed{88.8}$$"
        },
        {
            "introduction": "Modern environmental forecasting is increasingly probabilistic, providing a range of possible outcomes rather than a single deterministic prediction. Evaluating these forecasts requires more than a simple error metric; we need to understand the nature of their performance. This practice delves into the Murphy decomposition of the Brier score, a powerful framework that partitions forecast skill into three interpretable components: reliability (is the forecast statistically consistent?), resolution (does the forecast separate events from non-events?), and uncertainty (what is the inherent variability of the system?) . By working through a concrete example, you will develop the skills to perform a sophisticated validation that reveals the deeper strengths and weaknesses of a probabilistic forecast system.",
            "id": "3896013",
            "problem": "A hydrometeorological prediction system issues daily probabilistic forecasts for the binary event “region-mean precipitation exceeds $20$ millimeters.” Over a season of $N = 750$ forecast–verification pairs, the system’s issued probabilities take on five discrete values and the corresponding observations are summarized by the following forecast bins. For bin $k$ with issued probability $f_k$, let $n_k$ be the number of forecasts in the bin and let $e_k$ be the number of times the event occurred in that bin. The data are:\n- Bin $1$: $f_1 = 0.05$, $n_1 = 120$, $e_1 = 6$.\n- Bin $2$: $f_2 = 0.15$, $n_2 = 150$, $e_2 = 30$.\n- Bin $3$: $f_3 = 0.35$, $n_3 = 200$, $e_3 = 70$.\n- Bin $4$: $f_4 = 0.55$, $n_4 = 180$, $e_4 = 99$.\n- Bin $5$: $f_5 = 0.75$, $n_5 = 100$, $e_5 = 80$.\n\nStarting from the definition of the Brier Score (BS) for a probabilistic forecast of a binary outcome, $BS \\equiv \\frac{1}{N}\\sum_{i=1}^{N} \\left( f_i - Y_i \\right)^2$, where $Y_i \\in \\{0,1\\}$ is the verifying outcome indicator for case $i$ and $f_i \\in [0,1]$ is the issued probability, derive the Murphy decomposition that partitions $BS$ into three interpretable components associated with the binning scheme above. Use only fundamental probabilistic identities such as the law of total expectation and conditional means, and state clearly how each component reflects reliability, resolution, and uncertainty in the forecasts relative to the observed outcomes.\n\nThen, using the five bins provided, compute the sample estimates of the three components. Define the empirical event rate in bin $k$ as $o_k \\equiv \\frac{e_k}{n_k}$ and the overall base rate as $\\bar{o} \\equiv \\frac{1}{N}\\sum_{k=1}^{5} e_k$. Treat each $f_k$ as the mean forecast within its bin. Round each of the three component values to four significant figures and express them as dimensionless numbers. Report your final answer in the order: reliability, resolution, uncertainty.",
            "solution": "The Brier Score (BS) for a probabilistic forecast of a binary event is defined as the mean squared error between the forecast probability and the binary verifying outcome, namely\n$$\nBS \\equiv \\frac{1}{N} \\sum_{i=1}^{N} \\left( f_i - Y_i \\right)^2,\n$$\nwhere $Y_i \\in \\{0,1\\}$ and $f_i \\in [0,1]$. To connect BS to reliability, resolution, and uncertainty, we begin from two foundational tools: the law of total expectation and conditional means with respect to a partition of the sample into forecast bins. Let the sample be partitioned into $K$ bins indexed by $k \\in \\{1,\\dots,K\\}$, with bin $k$ containing $n_k$ cases, weight $w_k \\equiv \\frac{n_k}{N}$, issued probability $f_k$ (assumed constant within the bin), and empirical event rate\n$$\no_k \\equiv \\frac{1}{n_k} \\sum_{i \\in \\text{bin }k} Y_i.\n$$\nLet $\\bar{o} \\equiv \\frac{1}{N} \\sum_{i=1}^{N} Y_i$ denote the overall base rate (climatological probability).\n\nWe seek a decomposition of $BS$ into three terms. Write the squared error for case $i$ assigned to bin $k$ as\n$$\n\\left( f_k - Y_i \\right)^2 = \\left( f_k - o_k + o_k - \\bar{o} + \\bar{o} - Y_i \\right)^2.\n$$\nExpanding the square and then averaging within bin $k$ and subsequently across bins will produce cross terms whose bin-averages vanish due to the definitions of $o_k$ and $\\bar{o}$. Specifically, within bin $k$,\n$$\n\\frac{1}{n_k} \\sum_{i \\in \\text{bin }k} \\left( \\bar{o} - Y_i \\right) = \\bar{o} - o_k,\n$$\nand\n$$\n\\frac{1}{n_k} \\sum_{i \\in \\text{bin }k} \\left( \\bar{o} - Y_i \\right)^2 = \\underbrace{o_k(1 - o_k)}_{\\text{bin outcome variance}} + \\left( o_k - \\bar{o} \\right)^2,\n$$\nby the identity $\\operatorname{Var}(Y \\mid \\text{bin }k) = o_k(1 - o_k)$ and the law of total variance. Using these identities, after expanding and regrouping, the bin-mean squared error becomes\n$$\n\\frac{1}{n_k} \\sum_{i \\in \\text{bin }k} \\left( f_k - Y_i \\right)^2\n= \\underbrace{\\left( f_k - o_k \\right)^2}_{\\text{reliability contribution}}\n+ \\underbrace{\\left( o_k - \\bar{o} \\right)^2}_{\\text{resolution contribution}}\n+ \\underbrace{o_k(1 - o_k)}_{\\text{uncertainty contribution}}\n- \\underbrace{\\left( o_k - \\bar{o} \\right)^2}_{\\text{cancelled by regrouping}},\n$$\nand, upon careful combination of terms across bins using $w_k = \\frac{n_k}{N}$ and the identity\n$$\n\\sum_{k=1}^{K} w_k \\, o_k(1 - o_k) = \\bar{o}(1 - \\bar{o}) - \\sum_{k=1}^{K} w_k \\left( o_k - \\bar{o} \\right)^2,\n$$\nwe arrive at the Murphy decomposition:\n$$\nBS = \\underbrace{\\sum_{k=1}^{K} w_k \\left( f_k - o_k \\right)^2}_{\\text{Reliability}}\n\\;-\\;\n\\underbrace{\\sum_{k=1}^{K} w_k \\left( o_k - \\bar{o} \\right)^2}_{\\text{Resolution}}\n\\;+\\;\n\\underbrace{\\bar{o}(1 - \\bar{o})}_{\\text{Uncertainty}}.\n$$\nInterpretation:\n- Reliability quantifies the consistency of issued probabilities with empirical frequencies; it is small when $f_k \\approx o_k$ in all bins.\n- Resolution quantifies the degree to which empirical frequencies vary across bins away from the climatological base rate $\\bar{o}$; it is large when bins separate cases with very different $o_k$.\n- Uncertainty quantifies the inherent variability of the binary outcome and equals the variance of a Bernoulli random variable with success probability $\\bar{o}$.\n\nWe now compute each component using the provided data.\n\nStep 1: Compute $o_k$, $w_k$, and $\\bar{o}$.\nGiven $(n_k, e_k)$:\n- Bin $1$: $o_1 = \\frac{6}{120} = \\frac{1}{20} = 0.05$, $w_1 = \\frac{120}{750} = \\frac{4}{25}$.\n- Bin $2$: $o_2 = \\frac{30}{150} = \\frac{1}{5} = 0.2$, $w_2 = \\frac{150}{750} = \\frac{1}{5}$.\n- Bin $3$: $o_3 = \\frac{70}{200} = \\frac{7}{20} = 0.35$, $w_3 = \\frac{200}{750} = \\frac{4}{15}$.\n- Bin $4$: $o_4 = \\frac{99}{180} = \\frac{11}{20} = 0.55$, $w_4 = \\frac{180}{750} = \\frac{6}{25}$.\n- Bin $5$: $o_5 = \\frac{80}{100} = \\frac{4}{5} = 0.8$, $w_5 = \\frac{100}{750} = \\frac{2}{15}$.\nOverall base rate:\n$$\n\\bar{o} = \\frac{e_1 + e_2 + e_3 + e_4 + e_5}{N} = \\frac{6 + 30 + 70 + 99 + 80}{750} = \\frac{285}{750} = \\frac{19}{50} = 0.38.\n$$\n\nStep 2: Reliability component,\n$$\n\\text{Reliability} = \\sum_{k=1}^{5} w_k \\left( f_k - o_k \\right)^2.\n$$\nBin-by-bin differences:\n- Bin $1$: $f_1 - o_1 = 0.05 - 0.05 = 0$, contribution $0$.\n- Bin $2$: $f_2 - o_2 = 0.15 - 0.2 = -0.05$, squared $= 0.0025 = \\frac{1}{400}$, weighted by $w_2 = \\frac{1}{5}$ gives $\\frac{1}{2000}$.\n- Bin $3$: $f_3 - o_3 = 0$, contribution $0$.\n- Bin $4$: $f_4 - o_4 = 0$, contribution $0$.\n- Bin $5$: $f_5 - o_5 = 0.75 - 0.8 = -0.05$, squared $= 0.0025 = \\frac{1}{400}$, weighted by $w_5 = \\frac{2}{15}$ gives $\\frac{1}{3000}$.\nSumming,\n$$\n\\text{Reliability} = \\frac{1}{2000} + \\frac{1}{3000} = \\frac{1}{1200} \\approx 0.000833\\overline{3}.\n$$\n\nStep 3: Resolution component,\n$$\n\\text{Resolution} = \\sum_{k=1}^{5} w_k \\left( o_k - \\bar{o} \\right)^2.\n$$\nCompute differences and squares:\n- Bin $1$: $o_1 - \\bar{o} = \\frac{1}{20} - \\frac{19}{50} = -\\frac{33}{100}$, square $= \\frac{1089}{10000}$, weighted by $w_1 = \\frac{4}{25}$ gives $\\frac{1089}{62500}$.\n- Bin $2$: $o_2 - \\bar{o} = \\frac{1}{5} - \\frac{19}{50} = -\\frac{9}{50}$, square $= \\frac{81}{2500}$, weighted by $w_2 = \\frac{1}{5}$ gives $\\frac{81}{12500}$.\n- Bin $3$: $o_3 - \\bar{o} = \\frac{7}{20} - \\frac{19}{50} = -\\frac{3}{100}$, square $= \\frac{9}{10000}$, weighted by $w_3 = \\frac{4}{15}$ gives $\\frac{6}{25000}$.\n- Bin $4$: $o_4 - \\bar{o} = \\frac{11}{20} - \\frac{19}{50} = \\frac{17}{100}$, square $= \\frac{289}{10000}$, weighted by $w_4 = \\frac{6}{25}$ gives $\\frac{867}{125000}$.\n- Bin $5$: $o_5 - \\bar{o} = \\frac{4}{5} - \\frac{19}{50} = \\frac{21}{50}$, square $= \\frac{441}{2500}$, weighted by $w_5 = \\frac{2}{15}$ gives $\\frac{147}{6250}$.\nSumming to a common denominator $125000$:\n$$\n\\text{Resolution} = \\frac{2178 + 810 + 30 + 867 + 2940}{125000} = \\frac{6825}{125000} = \\frac{273}{5000} = 0.0546.\n$$\n\nStep 4: Uncertainty component,\n$$\n\\text{Uncertainty} = \\bar{o} \\left( 1 - \\bar{o} \\right) = \\frac{19}{50} \\cdot \\frac{31}{50} = \\frac{589}{2500} = 0.2356.\n$$\n\nOptional verification: The decomposition implies $BS = \\text{Reliability} - \\text{Resolution} + \\text{Uncertainty}$. Using the exact fractions,\n$$\nBS = \\frac{1}{1200} - \\frac{273}{5000} + \\frac{589}{2500} = \\frac{1091}{6000} \\approx 0.181833\\ldots,\n$$\nwhich is consistent with directly averaging $\\left( f_i - Y_i \\right)^2$ across the sample when grouped into bins.\n\nFinally, rounding each component to four significant figures and expressing values as dimensionless numbers:\n- Reliability: $\\frac{1}{1200} \\approx 8.333 \\times 10^{-4}$.\n- Resolution: $\\frac{273}{5000} = 5.460 \\times 10^{-2}$.\n- Uncertainty: $\\frac{589}{2500} = 2.356 \\times 10^{-1}$.\n\nReport the final answer in the order: reliability, resolution, uncertainty.",
            "answer": "$$\\boxed{\\begin{pmatrix}8.333 \\times 10^{-4} & 5.460 \\times 10^{-2} & 2.356 \\times 10^{-1}\\end{pmatrix}}$$"
        }
    ]
}