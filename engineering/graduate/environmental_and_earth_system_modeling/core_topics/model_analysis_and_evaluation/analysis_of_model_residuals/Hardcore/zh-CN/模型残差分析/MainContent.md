## 引言
在科学与工程建模的广阔领域中，任何模型都只是对复杂现实的一种近似。因此，理解模型预测与真实观测之间的差异——即模型残差——是评估模型性能、诊断其缺陷并最终推动科学认知进步的核心环节。对模型残差的系统性分析，远不止是计算一个简单的[误差指标](@entry_id:173250)；它是一门诊断的艺术，能揭示出模型结构、[参数化](@entry_id:265163)方案乃至我们对系统基本假设的深层问题。

诸如[决定系数](@entry_id:900023)（R²）或均方根误差（RMSE）等单一的全局性能指标虽然有用，但往往会掩盖模型在特定条件下的系统性失效。一个看似“良好”的模型可能在关键情景下做出严重错误的预测。本文旨在解决这一知识差距，展示如何通过深入剖析残差，超越这些表面指标，从而获得对模型行为更全面、更具批判性的理解。

为实现这一目标，本文将引导您完成一次从理论到实践的完整旅程。在“原理与机制”一章中，我们将奠定[残差分析](@entry_id:191495)的统计学基础，并介绍核心的诊断工具。接着，在“应用与跨学科联系”一章中，我们将通过来自[地球科学](@entry_id:749876)、化学和工程等领域的真实案例，展示这些工具的强大威力。最后，在“动手实践”部分，您将有机会通过具体的编程练习，将所学知识付诸实践。

通过这一结构化的学习路径，您将掌握一套不可或缺的技能，学会如何让模型的“错误”开口说话，从而将它们转化为改进模型和深化理解的宝贵线索。让我们从[残差分析](@entry_id:191495)最根本的原理与机制开始。

## 原理与机制

模型残差，即观测值与模型预测值之间的差异，是评估和改进环境与[地球系统模型](@entry_id:1124096)的基石。对残差的系统分析不仅揭示了模型的预测性能，更重要的是，它为我们提供了一个窗口，以探查模型结构、[参数化](@entry_id:265163)方案以及我们对系统基本假设的有效性。本章将深入探讨[残差分析](@entry_id:191495)的核心原理与机制，从基本定义出发，逐步深入到高级诊断技术。

### 残差的基本原理

在最基础的层面上，一个模型残差 $r_i$ 被定义为第 $i$ 次观测值 $y_i$ 与其对应的模型预测值 $\hat{y}_i$ 之间的差：

$r_i = y_i - \hat{y}_i$

这个简单的差值构成了所有后续分析的起点。然而，要真正理解[残差分析](@entry_id:191495)的力量，我们必须超越这个算术定义，并将其置于[统计推断](@entry_id:172747)和科学哲学的框架内。

一个理想的、完美捕捉了系统内在确定性动态的模型，其预测误差应该仅仅反映系统中不可预测的随机成分。在[系统辨识](@entry_id:201290)理论中，这些不可预测的成分被称为“新息”（innovations），通常用 $e_t$ 表示。一个正确指定的模型，其残差序列 $r_t$ 在统计上应该与真实的[新息序列](@entry_id:181232) $e_t$ 无法区分，表现为一组均值为零、无序列相关性且与模型输入无关的[随机变量](@entry_id:195330)——即“[白噪声](@entry_id:145248)”。因此，[残差分析](@entry_id:191495)的根本目标是检验模型的残差序列是否“像”[白噪声](@entry_id:145248)。任何偏离[白噪声](@entry_id:145248)特性的系统性结构，都表明模型未能完全捕捉数据的生成过程。

这一视角将模型验证的过程定义为一种**证伪（falsification）**而非“证实（verification）”。当我们对残差进行一系列统计检验（例如，检验其[自相关](@entry_id:138991)性或与输入的[互相关性](@entry_id:188177)）时，我们的目的不是证明模型是“正确”的。实际上，我们永远无法证明一个模型是绝对正确的。相反，我们试图寻找证据来**反驳**模型及其背后的一系列假设（即复合[零假设](@entry_id:265441)，包括模型结构、[噪声模型](@entry_id:752540)等）。如果一个或多个检验在统计上显著，我们就拒绝了该复合[零假设](@entry_id:265441)，即我们已经证伪了当前的模型设定。如果所有检验都未能拒绝零假设，我们不能说模型已被“证实”，而只能说它在当前检验下“尚未被证伪” 。这种审慎的、基于证伪的思维方式是严谨科学建模的核心。

### 用残差量化模型性能

尽管[残差分析](@entry_id:191495)的最终目的是诊断模型缺陷，但其最直接的应用是量化模型的整体预测性能。描述残差序列分布的各种统计量构成了评估模型优劣的标准指标。

#### 从范数到误差度量

我们可以将整个残差序列视为一个 $n$ 维向量 $\mathbf{r} \in \mathbb{R}^n$。这个向量的“大小”或范数，为我们提供了衡量模型总体误差的自然方式。

**[均方根误差 (RMSE)](@entry_id:1131101)** 是最常用的度量之一，它与向量的[欧几里得范数](@entry_id:172687)（$L_2$ 范数）直接相关。$L_2$ 范数定义为 $\|\mathbf{r}\|_2 = \sqrt{\sum_{i=1}^n r_i^2}$。通过对 $L_2$ 范数的平方进行归一化（除以[样本量](@entry_id:910360) $n$）并取平方根，我们便得到 RMSE：

$\mathrm{RMSE} = \sqrt{\frac{1}{n} \sum_{i=1}^{n} r_i^2} = \frac{1}{\sqrt{n}} \|\mathbf{r}\|_2$

RMSE 对较大的误差给予了不成比例的惩罚，这在许多应用中是合意的特性。

**平均[绝对误差](@entry_id:139354) (MAE)** 提供了另一种度量方式，它与[曼哈顿范数](@entry_id:143036)（$L_1$ 范数）相关。$L_1$ 范数定义为 $\|\mathbf{r}\|_1 = \sum_{i=1}^n |r_i|$。MAE 就是对 $L_1$ 范数进行简单归一化：

$\mathrm{MAE} = \frac{1}{n} \sum_{i=1}^{n} |r_i| = \frac{1}{n} \|\mathbf{r}\|_1$

与 RMSE 相比，MAE 对所有误差的权重是均等的，因此对异常值不那么敏感。

在许多[环境建模](@entry_id:1124562)应用中，并非所有观测数据都具有相同的可靠性或重要性。例如，来自不同仪器的观测可能具有不同的[误差方差](@entry_id:636041)，或者在对全球模型进行评估时，不同网格单元的面积可能不同。在这种情况下，使用加权指标更为合适。**加权[均方根误差](@entry_id:170440) (wRMSE)** 引入了权重 $w_i > 0$。这与加权[欧几里得范数](@entry_id:172687) $\|\mathbf{W}\mathbf{r}\|_2$ 相关，其中 $\mathbf{W}$ 是一个权重矩阵。如果权重是独立的，我们可以定义一个对角权重矩阵 $\mathbf{W} = \mathrm{diag}(\sqrt{w_1}, \dots, \sqrt{w_n})$。此时，wRMSE 可以表示为 ：

$\mathrm{wRMSE}(w) = \sqrt{\frac{\sum_{i=1}^{n} w_i r_i^2}{\sum_{i=1}^{n} w_i}} = \frac{\|\mathbf{W} \mathbf{r}\|_2}{\sqrt{\sum_{i=1}^{n} w_i}}$

一个常见的权重选择是观测误差方差的倒数，$w_i = 1/\sigma_i^2$，这使得方差较小（更可信）的观测在评估中占有更大的[比重](@entry_id:184864)。

#### [概率基础](@entry_id:187304)：[似然](@entry_id:167119)与[最小二乘法](@entry_id:137100)

为什么平方误差（如 RMSE）在[模型校准](@entry_id:146456)和评估中占据如此中心的位置？答案深植于概率论，特别是最大似然估计（Maximum Likelihood Estimation, MLE）的原理。

假设模型的残差 $r_i$ 是[独立同分布](@entry_id:169067)的（i.i.d.），且服从均值为零、方差为 $\sigma^2$ 的高斯（正态）分布，即 $r_i \sim \mathcal{N}(0, \sigma^2)$。在这种情况下，整个数据集的对数似然函数 $\ell$ 可以写成 ：

$\ell(\theta, \sigma^2) = -\frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln(\sigma^2) - \frac{1}{2\sigma^2}\sum_{i=1}^n r_i(\theta)^2$

其中 $\theta$ 是模型的参数。为了找到参数 $\theta$ 的[最大似然估计](@entry_id:142509)，我们需要最大化这个表达式。观察上式可以发现，前两项与 $\theta$ 无关。因此，最大化 $\ell(\theta, \sigma^2)$ 等价于最小化最后一项，即[残差平方和](@entry_id:174395) $\sum_{i=1}^n r_i(\theta)^2$。这正是**[普通最小二乘法](@entry_id:137121) (Ordinary Least Squares, OLS)** 的[目标函数](@entry_id:267263)。因此，在高斯误差假设下，[最小二乘估计](@entry_id:262764)就是[最大似然估计](@entry_id:142509)。

这个深刻的联系可以进一步扩展。
- 如果残差是独立的但具有已知的不同方差 $\sigma_i^2$（异方差性），最大化高斯[似然](@entry_id:167119)等价于最小化加权[残差[平方](@entry_id:174395)和](@entry_id:161049) $\sum_{i=1}^n \frac{r_i^2}{\sigma_i^2}$。这正是**[加权最小二乘法](@entry_id:177517) (Weighted Least Squares, WLS)** 。
- 如果[残差向量](@entry_id:165091) $\mathbf{r}$ 在时间上是自相关的，其[协方差矩阵](@entry_id:139155)为 $\Sigma$，那么最大化多元高斯[似然](@entry_id:167119)则等价于最小化二次型 $\mathbf{r}^\top \Sigma^{-1} \mathbf{r}$。这正是**[广义最小二乘法](@entry_id:272590) (Generalized Least Squares, GLS)** 。

### 诊断模型误设：核心假设的检验

[残差分析](@entry_id:191495)的核心任务是诊断模型的误设（misspecification），即检验模型是否违背了其底层的统计假设。对于许多标准模型（如线性回归），这些假设是通过[高斯-马尔可夫定理](@entry_id:138437)来形式化的，它规定了 OLS 估计器成为最佳线性[无偏估计](@entry_id:756289)器（BLUE）的条件。这些条件，即便在更复杂的[非线性模型](@entry_id:276864)中，也为[残差分析](@entry_id:191495)提供了黄金标准。

主要有三大核心假设，我们可以通过残差来检验它们 ：
1.  **零条件均值**: $\mathbb{E}[\varepsilon_t \mid \mathbf{X}] = 0$。这意味着误差的[期望值](@entry_id:150961)为零，且与所有预测变量无关。换言之，模型不存在系统性偏差。
2.  **[同方差性](@entry_id:634679)**: $\mathrm{Var}(\varepsilon_t \mid \mathbf{X}) = \sigma^2$。这意味着误差的方差是恒定的，不随预测变量或预测值的变化而变化。
3.  **无自相关**: $\mathrm{Cov}(\varepsilon_t, \varepsilon_s \mid \mathbf{X}) = 0$ 对于 $t \neq s$。这意味着不同观测的误差项之间是相互独立的。

在环境建模中，对这些假设的违背往往有明确的物理意义：
- **违反零条件均值**: 典型例子是一个流域径流模型，其预测变量仅包含降水和温度。如果模型残差在雨季系统性地为正，在旱季系统性地为负，这表明模型未能捕捉到与季节相关的过程（如地下水位的变化），从而违反了零条件均值假设 。
- **违反[同方差性](@entry_id:634679)（异方差性）**: 在一个模拟河流[泥沙输运](@entry_id:1131379)的模型中，如果预测流量越大，残差的散布范围也越大，这表明误差的方差随系统状态而变化。高流量事件本身具有更大的不确定性，这是一种典型的[异方差性](@entry_id:895761) 。
- **违反无[自相关](@entry_id:138991)**: 在一个每日气温预报模型中，如果今天的正残差（即模型低估）使得明天的残差也更可能为正，这表明残差中存在正的滞后-1[自相关](@entry_id:138991)。这可能是由于模型未能完全捕捉到大气的“[热惯性](@entry_id:147003)”等持续性过程 。

#### 系统性误差：偏差与条件偏差

对零条件均值假设的深入研究引出了**偏差（Bias）** 的概念。模型的**总体偏差**是所有残差的平均值，其大样本极限为 $E[r]$。然而，一个接近于零的总体偏差可能具有误导性，因为它可能掩盖了在不同条件下方向相反但幅度巨大的系统性误差。

这便引出了**条件偏差（Conditional Bias）** 的概念，即在给定某个[协变](@entry_id:634097)量 $z$ 的条件下残差的[期望值](@entry_id:150961) $E[r \mid z]$。例如，在一个区域空气质量预报系统中，我们可以分析残差与[行星边界层](@entry_id:187799)高度（PBLH）的关系 。假设我们发现，在低PBLH（$z=\ell$，污染物易积聚）条件下，模型的条件偏差为正（$E[r \mid z=\ell] = 4\,\mu\mathrm{g}/\mathrm{m}^3$），表明模型倾向于**低估**污染浓度；而在高PBLH（$z=h$，污染物易扩散）条件下，条件偏差为负（$E[r \mid z=h] = -6\,\mu\mathrm{g}/\mathrm{m}^3$），表明模型倾向于**高估**污染浓度。

这种模式具有重要的环境意义：模型在最危险的污染事件（低PBLH）期间未能发出足够的警报，而在清洁条件下又过于保守。这揭示了模型在处理不同大气混合状态时存在根本性的缺陷。

根据[全期望定律](@entry_id:265946)，总体偏差是所有条件偏差的加权平均，权重为相应条件的发生概率：
$E[r] = E[r \mid z=\ell] \mathbb{P}(z=\ell) + E[r \mid z=h] \mathbb{P}(z=h)$
使用上述数值和假设的概率 $\mathbb{P}(z=\ell)=0.7$ 和 $\mathbb{P}(z=h)=0.3$，总体偏差为 $4 \times 0.7 + (-6) \times 0.3 = 1.0\,\mu\mathrm{g}/\mathrm{m}^3$。这个微小的正偏差掩盖了两个方向相反且幅度更大的条件偏差。这也说明，即使模型内部的物理过程（决定了条件偏差）保持不变，气候变化等因素导致协变量 $z$ 的分布发生改变（例如，低PBLH天气增多），模型的总体偏差也会发生变化 。

### [残差分析](@entry_id:191495)的实用工具

诊断上述模型缺陷需要一套[标准化](@entry_id:637219)的实用工具，包括图形诊断和形式化的假设检验。

#### 图形诊断方法

图形方法提供了对残差行为最直观的洞察。
- **残差 vs. 拟合值图**: 这是最重要和最常用的诊断图。它将每个残差 $e_i$ 与其对应的拟合值 $\hat{Y}_i$ 绘制在一起。一个表现良好的模型，其[残差图](@entry_id:169585)应该像一条围绕零水平线随机散布的点带，没有任何可辨别的模式。
    - **[非线性](@entry_id:637147)**: 如果点带呈现出系统性的弯曲（如U形或倒U形），这表明模型的均值结构存在问题，即违反了线性假设。这通常意味着需要对预测变量进行[非线性变换](@entry_id:636115)（如平方项）或加入交互项 。
    - **异方差性**: 如果点带的垂直宽度（即残差的散布范围）随着拟合值的增加而系统性地变宽或变窄，形成“喇叭形”，这表明[误差方差](@entry_id:636041)不是恒定的，违反了[同方差性](@entry_id:634679)假设 。

- **正态 Q-Q 图**: 该图用于检验残差的[正态性假设](@entry_id:170614)。它将标准化的残差分位数与[标准正态分布](@entry_id:184509)的理论分位数进行比较。如果残差确实服从正态分布，那么图上的点将大致落在一条45度直线上。
    - **重尾/轻尾**: 如果残差分布的尾部比正态分布更“重”（即极端值更多），[Q-Q图](@entry_id:174944)的两端会偏离直线，形成一个对称的“S”形。
    - **偏度**: 如果残差分布是倾斜的（不对称），点会以一种弯曲的方式偏离直线。例如，[右偏分布](@entry_id:275398)会导致图的右上端向上弯曲 。

- **标度-位置图 (Scale-Location Plot)**: 该图更直接地用于诊断[异方差性](@entry_id:895761)。它绘制了[标准化残差](@entry_id:634169)绝对值的平方根 $\sqrt{|r_i|}$ 与拟合值 $\hat{Y}_i$ 的关系。如果[同方差性](@entry_id:634679)假设成立，图上的点应该随机散布，且趋势线应大致水平。如果趋势线有明显的上升或下降趋势，则表明存在[异方差性](@entry_id:895761) 。

#### 形式化假设检验

除了图形诊断，我们还可以使用形式化的统计检验来获得关于假设违背的定量证据。
- **[正态性检验](@entry_id:921142)**: **Shapiro-Wilk 检验** 是一种常用的检验方法，其[零假设](@entry_id:265441) $H_0$ 是残差服从正态分布。如果 p 值小于预设的[显著性水平](@entry_id:902699) $\alpha$（如 $0.05$），则拒绝 $H_0$，认为有证据表明残差不是正态分布的 。

- **异方差性检验**: **Breusch-Pagan (BP) 检验** 用于检验[异方差性](@entry_id:895761)。其零假设 $H_0$ 是残差的方差是恒定的（[同方差性](@entry_id:634679)）。该检验通过将残差的平方对预测变量进行辅助回归来构造一个统计量。同样，一个小的 p 值表明有证据拒绝 $H_0$，即存在异方差性 。

- **[自相关检验](@entry_id:637651)**: **Durbin-Watson (DW) 检验** 专门用于检验残差中是否存在一阶自相关。其[零假设](@entry_id:265441) $H_0$ 是残差没有一阶自相关。DW 统计量的值域约为 0 到 4。
    - 如果 $DW \approx 2$，则表明没有一阶[自相关](@entry_id:138991)。
    - 如果 $DW$ 显著小于 2（例如，小于 $1.5$），则表明存在正[自相关](@entry_id:138991)。
    - 如果 $DW$ 显著大于 2（例如，大于 $2.5$），则表明存在负自相关。
    在一个环境时间序列模型（如河流硝酸盐浓度模型）的分析中，得到 $DW = 1.25$ 强烈暗示模型残差中存在正的序列相关性，表明模型未能捕捉到系统的某些动态记忆 。

### [残差分析](@entry_id:191495)的高级主题

在掌握了基本诊断工具后，我们可以探索一些更高级的概念，这些概念在处理复杂的[地球系统模型](@entry_id:1124096)时至关重要。

#### [线性模型](@entry_id:178302)中的[杠杆值](@entry_id:172567)与影响力

在[线性回归](@entry_id:142318)模型 $\mathbf{y} = X \beta + \varepsilon$ 中，我们不仅关心残差的大小，还关心每个数据点对[模型拟合](@entry_id:265652)的“影响力”。这种影响力可以通过**[帽子矩阵](@entry_id:174084) (hat matrix)** $H = X(X^\top X)^{-1}X^\top$ 来量化。[帽子矩阵](@entry_id:174084)将观测向量 $\mathbf{y}$ 映射到拟合向量 $\hat{\mathbf{y}} = H\mathbf{y}$。

[帽子矩阵](@entry_id:174084)的对角[线元](@entry_id:196833)素 $h_{ii}$ 被称为**[杠杆值](@entry_id:172567) (leverage)**。[杠杆值](@entry_id:172567) $h_{ii}$ 度量了第 $i$ 个观测的预测变量 $\mathbf{x}_i$ 离所有预测变量均值的“距离”。一个高[杠杆值](@entry_id:172567)的点（即预测变量空间中的“异[常点](@entry_id:164624)”）有潜力对回归线产生巨大影响。[杠杆值](@entry_id:172567)具有一些重要属性：它介于 0 和 1 之间（$0 \le h_{ii} \le 1$），且所有[杠杆值](@entry_id:172567)的总和等于模型中参数的数量 $p$（包括截距），即 $\sum h_{ii} = \mathrm{tr}(H) = p$ 。

[杠杆值](@entry_id:172567)的一个关键作用是它决定了残差的方差。对于一个 OLS 模型，第 $i$ 个残差的方差为 $\mathrm{Var}(r_i) = \sigma^2(1-h_{ii})$ 。这意味着高[杠杆值](@entry_id:172567)的点，其对应的残差方差会更小。为了在比较不同点的残差时考虑到这一点，我们通常使用**[学生化残差](@entry_id:636292) (studentized residuals)**，$t_i = \frac{r_i}{\hat{\sigma}\sqrt{1-h_{ii}}}$，它通过[杠杆值](@entry_id:172567)对残差进行了标准化。

然而，一个高[杠杆值](@entry_id:172567)的点只有在它同时拥有一个大残差时，才真正具有高**影响力 (influence)**。**[库克距离](@entry_id:175103) (Cook's distance)** $D_i$ 是一个综合衡量第 $i$ 个数据点影响力的指标，它同时考虑了[杠杆值](@entry_id:172567)和残差的大小。一个简洁的计算公式将 $D_i$ 与[学生化残差](@entry_id:636292)和[杠杆值](@entry_id:172567)联系起来 ：
$D_i = \frac{t_i^2}{p} \frac{h_{ii}}{1-h_{ii}}$

识别并检查具有高[库克距离](@entry_id:175103)的点是诊断模型稳健性的重要步骤。

#### [误差分解](@entry_id:636944)：随机不确定性 vs. 认知不确定性

在复杂的环境模型中，观测与预测之间的差异（即残差）并非铁板一块，而是由多种来源的误差混合而成。一个更精细的生成模型框架将观测值 $y_t$ 分解为 ：

$y_t = f(x_t; \theta) + \delta(x_t) + \eta_t$

这里的 $f(x_t; \theta)$ 是我们模型的确定性预测部分，而误差被分解为：
- **观测误差 ($\eta_t$)**: 由测量仪器或过程的内在随机性引起。这是一种**随机不确定性 (aleatory uncertainty)**，原则上无法通过改进模型来消除，但可以通过[重复测量](@entry_id:896842)来降低其对均值估计的影响。
- **结构性差异 ($\delta(x_t)$)**: 代表了模型形式本身的错误，即我们的模型 $f$ 与真实物理过程之间的系统性偏差。这是一种**认知不确定性 (epistemic uncertainty)**，原则上可以通过获取更多知识、改进模型物理过程来减少。

在这种框架下，我们之前定义的残差 $r_t = y_t - f(x_t; \theta)$ 实际上是 $\delta(x_t) + \eta_t$ 的总和。这意味着简单的[残差分析](@entry_id:191495)混淆了这两种性质截然不同的误差。通过精心设计的实验，例如在相同条件下进行[重复测量](@entry_id:896842)，我们可以估计[观测误差](@entry_id:752871) $\eta_t$ 的方差，因为此时结构性差异 $\delta(x_t)$ 是一个固定的偏差 。在残差中检测到的任何系统性结构（如与[协变](@entry_id:634097)量相关或存在自相关）通常归因于认知不确定性项 $\delta(x_t)$。

值得注意的是，模型本身也可能包含随机项，如状态演化方程中的**[过程噪声](@entry_id:270644) ($\epsilon_t$)**。这个误差源与上述两者都不同，它影响的是系统状态的演化。要区分[过程噪声](@entry_id:270644) $\epsilon_t$ 与结构性差异 $\delta(x_t)$，通常需要更高级的、基于数据同化（如卡尔曼滤波）的诊断，通过分析“一步预测新息”来实现 。

#### 残差的非平稳性

在处理[时间[序列数](@entry_id:262935)据](@entry_id:636380)时，一个关键假设是残差过程是**平稳的 (stationary)**，即其统计特性（如均值和方差）不随时间变化。残差的非平稳性是模型误设的一个强烈信号。

一个常见的非平稳性来源是忽略了一个随时间变化的重要的外部驱动因素。例如，在一个水文模型中，如果忽略了一个重要的气候模态指数（如太平洋年代际振荡，PDO），而该指数在研究期间发生了持续的**状态转换 (regime shift)**，那么模型的残差很可能会表现出[非平稳性](@entry_id:180513) 。
- **均值非平稳**: 如果该气候模态对径流有一个附加效应，那么在模态转换前后，残差的均值会发生一个阶跃式的变化。这直接违反了均值恒定的[平稳性假设](@entry_id:272270)。正确的处理方法是将该气候指数作为预测变量纳入模型，而不是对残差进行差分等治标不治本的操作 。
- **方差非平稳**: 不同的气候状态可能不仅影响径流的均值，还影响其变率。例如，某个气候状态可能与更极端的降水事件相关，导致模型的预测误差方差更大。这种随状态变化的方差（异方差性）同样构成了[非平稳性](@entry_id:180513)。在这种情况下，应采用能够处理异方差性的方法（如[广义最小二乘法](@entry_id:272590) GLS）来对模型进行估计，以获得可靠的参数和不确定性量化 。

#### 时空残差

对于全球或[区域气候模型](@entry_id:1130797)等空间扩展系统，残差场 $R(\mathbf{s}, t)$ 是一个时空过程，其中 $\mathbf{s}$ 是空间位置，$t$ 是时间。分析这类残差需要时空统计学的工具，其中一个核心概念是[时空协方差](@entry_id:1132006)函数 $C(h, \tau)$，它描述了空间距离为 $h$、时间间隔为 $\tau$ 的两个点上残差之间的相关性。

一个关键的结构性假设是**可分离性 (separability)**。一个可分离的[协方差模型](@entry_id:165727)可以写成一个纯空间协方差函数 $C_s(h)$ 和一个纯时间[协方差函数](@entry_id:265031) $C_t(\tau)$ 的乘积：

$C(h, \tau) = C_s(h) C_t(\tau)$

可[分离模型](@entry_id:201289)在计算上非常方便，但它施加了一个很强的假设：空间相关性的结构不随时间变化，反之亦然。在许多物理过程中，这个假设并不成立（例如，风会使得[空间相关性](@entry_id:203497)在顺风向和逆风向不对称，这种时空交互作用就是不可分离的）。

我们可以通过一些诊断来检验可分离性假设是否被数据[证伪](@entry_id:260896) ：
- **[协方差比](@entry_id:164366)率**: 如果模型是可分离的，那么比率 $C(h, \tau)/C(h, 0)$ 应该等于 $C_t(\tau)/C_t(0)$，这是一个只与 $\tau$ 有关而与空间滞后 $h$ 无关的常数。因此，如果从数据中估计的这个比率随 $h$ 变化，则可分离性被[证伪](@entry_id:260896)。
- **[相干性分析](@entry_id:1122609)**: 相[干性](@entry_id:900268)是频域中的相关性度量。对于一个可分离过程，任意两个固定空间位置上的时间序列之间的相[干性](@entry_id:900268)应该不随频率 $\omega$ 变化。如果观测到的相[干性](@entry_id:900268)谱不是平坦的，则可分离性被[证伪](@entry_id:260896)。

对时空残差结构的正确理解和建模，对于气候模型的偏差校正和不确定性量化至关重要。