{
    "hands_on_practices": [
        {
            "introduction": "This exercise gets to the heart of numerical stiffness using a simple, yet powerful, model of first-order decay. By comparing the behavior of the explicit Forward Euler and implicit Backward Euler methods, you will directly observe why stiff systems demand specialized numerical treatment. This practice is foundational for understanding the stability limitations of explicit methods and the advantages of implicit ones .",
            "id": "3916079",
            "problem": "A simplified but representative stiff process in environmental and earth system modeling is the first-order decay of a highly reactive dissolved species in a well-mixed control volume. Let the concentration be modeled by the ordinary differential equation $y'(t) = -1000\\,y(t)$ with an initial condition $y(0) = y_{0}$, where the large decay coefficient models a fast chemical sink relative to advective or diffusive transport. Consider two widely used time-stepping methods for initial value problems: the Forward Euler method and the Backward Euler method. Using only the definitions of these methods as one-step discretizations of $y'(t)$, derive the linear one-step update for each method when applied to this equation, and thereby obtain the one-step amplification factor $g(\\Delta t)$ such that $y_{n+1} = g(\\Delta t)\\,y_{n}$ for each method. Evaluate the magnitude of the amplification factor, $|g(\\Delta t)|$, for each method at the two time steps $\\Delta t = 0.001$ and $\\Delta t = 1$. Interpret the implications of these values for stiffness-related error dynamics and stability, discussing how each method behaves for these step sizes in the context of fast decay typical of stiff environmental subsystems. Provide your final answer as a single row matrix containing the four exact values $|g_{\\text{FE}}(0.001)|$, $|g_{\\text{BE}}(0.001)|$, $|g_{\\text{FE}}(1)|$, and $|g_{\\text{BE}}(1)|$ in this order, without units and without rounding.",
            "solution": "The validity of the problem statement is first assessed.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: The concentration $y(t)$ is modeled by the ordinary differential equation (ODE) $y'(t) = -1000\\,y(t)$.\n-   **Initial Condition**: $y(0) = y_{0}$.\n-   **Numerical Methods**: Forward Euler and Backward Euler.\n-   **Task 1**: Derive the one-step update for each method.\n-   **Task 2**: Find the one-step amplification factor $g(\\Delta t)$ such that $y_{n+1} = g(\\Delta t)\\,y_{n}$ for each method.\n-   **Task 3**: Evaluate $|g(\\Delta t)|$ for each method at $\\Delta t = 0.001$ and $\\Delta t = 1$.\n-   **Task 4**: Interpret the results in the context of stiffness, error dynamics, and stability.\n-   **Answer Format**: A single row matrix containing the four exact values: $|g_{\\text{FE}}(0.001)|$, $|g_{\\text{BE}}(0.001)|$, $|g_{\\text{FE}}(1)|$, and $|g_{\\text{BE}}(1)|$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It poses a standard question from the field of numerical analysis for differential equations, specifically using Dahlquist's test equation, $y'(t) = \\lambda y(t)$ with $\\lambda = -1000$, to analyze the stability of basic numerical integrators. This is a canonical problem for illustrating the concept of stiffness in ODEs. The context provided, a fast chemical sink in an environmental model, is a realistic and appropriate application. The problem is well-posed, with all necessary information provided to derive a unique, meaningful solution. The terminology is precise and objective. The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe given ordinary differential equation is a linear, first-order, homogeneous equation with a constant coefficient:\n$$y'(t) = -1000\\,y(t)$$\nLet $y_n$ be the numerical approximation of the solution $y(t_n)$ at time $t_n = n \\Delta t$, where $\\Delta t$ is the time step. The general form of the ODE is $y'(t) = f(t, y(t))$, where for this problem, $f(t, y) = -1000 y$.\n\n**1. Forward Euler Method**\n\nThe Forward Euler (FE) method is an explicit one-step method defined by the recurrence relation:\n$$y_{n+1} = y_n + \\Delta t\\,f(t_n, y_n)$$\nSubstituting the given function $f(t_n, y_n) = -1000\\,y_n$ into the FE formula yields:\n$$y_{n+1} = y_n + \\Delta t (-1000\\,y_n)$$\nFactoring out $y_n$ gives the one-step update rule:\n$$y_{n+1} = (1 - 1000\\,\\Delta t)\\,y_n$$\nBy comparing this to the form $y_{n+1} = g(\\Delta t)\\,y_n$, we identify the amplification factor for the Forward Euler method, $g_{\\text{FE}}(\\Delta t)$, as:\n$$g_{\\text{FE}}(\\Delta t) = 1 - 1000\\,\\Delta t$$\n\n**2. Backward Euler Method**\n\nThe Backward Euler (BE) method is an implicit one-step method defined by the recurrence relation:\n$$y_{n+1} = y_n + \\Delta t\\,f(t_{n+1}, y_{n+1})$$\nNote that the function $f$ is evaluated at the future time step $t_{n+1}$. Substituting the given function $f(t_{n+1}, y_{n+1}) = -1000\\,y_{n+1}$ into the BE formula yields:\n$$y_{n+1} = y_n + \\Delta t (-1000\\,y_{n+1})$$\nThis is an equation for the unknown $y_{n+1}$. We must solve for it algebraically:\n$$y_{n+1} + 1000\\,\\Delta t\\,y_{n+1} = y_n$$\n$$y_{n+1}(1 + 1000\\,\\Delta t) = y_n$$\n$$y_{n+1} = \\frac{1}{1 + 1000\\,\\Delta t}\\,y_n$$\nBy comparing this to the form $y_{n+1} = g(\\Delta t)\\,y_n$, we identify the amplification factor for the Backward Euler method, $g_{\\text{BE}}(\\Delta t)$, as:\n$$g_{\\text{BE}}(\\Delta t) = \\frac{1}{1 + 1000\\,\\Delta t}$$\n\n**3. Evaluation of Amplification Factors**\n\nWe now evaluate the magnitude of the amplification factor, $|g(\\Delta t)|$, for each method at the specified time steps.\n\n**Case 1: $\\Delta t = 0.001$**\n\n-   For Forward Euler:\n    $$g_{\\text{FE}}(0.001) = 1 - 1000(0.001) = 1 - 1 = 0$$\n    $$|g_{\\text{FE}}(0.001)| = |0| = 0$$\n-   For Backward Euler:\n    $$g_{\\text{BE}}(0.001) = \\frac{1}{1 + 1000(0.001)} = \\frac{1}{1 + 1} = \\frac{1}{2}$$\n    $$|g_{\\text{BE}}(0.001)| = \\left|\\frac{1}{2}\\right| = \\frac{1}{2}$$\n\n**Case 2: $\\Delta t = 1$**\n\n-   For Forward Euler:\n    $$g_{\\text{FE}}(1) = 1 - 1000(1) = -999$$\n    $$|g_{\\text{FE}}(1)| = |-999| = 999$$\n-   For Backward Euler:\n    $$g_{\\text{BE}}(1) = \\frac{1}{1 + 1000(1)} = \\frac{1}{1001}$$\n    $$|g_{\\text{BE}}(1)| = \\left|\\frac{1}{1001}\\right| = \\frac{1}{1001}$$\n\n**4. Interpretation and Implications for Stiffness**\n\nThe true solution to $y'(t) = -1000\\,y(t)$ is $y(t) = y_0 \\exp(-1000 t)$, which decays rapidly to zero. A numerically stable method should produce a solution that also decays, meaning the magnitude of the numerical solution should not increase. This requires that the amplification factor's magnitude be less than or equal to one: $|g(\\Delta t)| \\leq 1$.\n\n-   **Forward Euler (Explicit Method)**:\n    The stability condition is $|g_{\\text{FE}}(\\Delta t)| = |1 - 1000\\,\\Delta t| \\leq 1$. This inequality holds only if $-1 \\leq 1 - 1000\\,\\Delta t \\leq 1$, which simplifies to $0 \\leq \\Delta t \\leq \\frac{2}{1000} = 0.002$. The stability of the FE method is therefore conditional on the time step.\n    -   At $\\Delta t = 0.001$, the condition is met. $|g_{\\text{FE}}(0.001)| = 0 \\leq 1$, so the method is stable. It is, in fact, so dissipative that it damps the solution to zero in a single step.\n    -   At $\\Delta t = 1$, the condition is violated. $|g_{\\text{FE}}(1)| = 999 \\gg 1$. The method is violently unstable. Each step amplifies the previous value by a factor of $-999$, leading to catastrophic error growth with sign oscillations, a hallmark of numerical instability for stiff systems.\n\n-   **Backward Euler (Implicit Method)**:\n    The stability condition is $|g_{\\text{BE}}(\\Delta t)| = |\\frac{1}{1 + 1000\\,\\Delta t}| \\leq 1$. Since $\\Delta t  0$, the denominator $1 + 1000\\,\\Delta t$ is always greater than $1$. Therefore, $0  g_{\\text{BE}}(\\Delta t)  1$ for all $\\Delta t  0$. The magnitude is always less than $1$. The BE method is unconditionally stable for this problem (a property known as A-stability).\n    -   At $\\Delta t = 0.001$, $|g_{\\text{BE}}(0.001)| = 1/2  1$. The method is stable and produces a decaying solution.\n    -   At $\\Delta t = 1$, $|g_{\\text{BE}}(1)| = 1/1001  1$. The method remains stable, even with a time step that is orders of magnitude larger than the characteristic time scale of the decay ($1/1000\\,s$).\n\n**Conclusion on Stiffness**: This problem exemplifies stiffness. The fast decay process (with characteristic time $1/1000\\,s$) imposes a severe stability constraint on the explicit Forward Euler method ($\\Delta t \\leq 0.002\\,s$), even if we are interested in system dynamics over much longer time scales. The implicit Backward Euler method, being unconditionally stable, is not subject to this constraint and can take large time steps, making it far more efficient for integrating stiff systems like those common in environmental modeling where chemical, physical, and biological processes occur on vastly different timescales.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{1}{2}  999  \\frac{1}{1001}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Real-world environmental systems involve multiple processes—like advection, diffusion, and reaction—each with its own characteristic timescale. This practice guides you through a systematic analysis of these timescales to diagnose numerical stiffness in a 1D river transport model. By calculating dimensionless quantities like the Péclet number ($Pe$) and Damköhler number ($Da$), you will learn to quantify the separation of scales that defines a stiff problem .",
            "id": "3916074",
            "problem": "Consider one-dimensional transport of a reactive tracer in a straight river reach of length $L$ with spatial coordinate $x \\in [0,L]$. The tracer is transported by advection at mean velocity $u$, spreads by molecular diffusion with coefficient $D$, and decays by a first-order reaction with rate constant $k$. Neglecting sources and sinks other than decay, the conservation of mass leads to an advection–diffusion–reaction balance that, upon spatial discretization on a uniform grid with spacing $\\Delta x$, yields a semi-discrete system of ordinary differential equations for the nodal concentrations. \n\nUsing fundamental definitions of characteristic times at the reach scale $L$—the advective time $\\tau_{a}$ as the time to advect across $L$, the diffusive time $\\tau_{d}$ as the time for molecular diffusion to traverse $L$, and the reactive time $\\tau_{r}$ as the e-folding decay time—define the Péclet number (Pe) as the ratio of the diffusive to advective times at scale $L$ and the Damköhler number (Da) as the ratio of the advective to reactive times at scale $L$. Then, analyze the stiffness of the semi-discrete system at the grid scale by comparing the fastest reactive time to the slowest grid-scale transport time. \n\nGiven $u=0.1$ m s$^{-1}$, $D=10^{-5}$ m$^{2}$ s$^{-1}$, $L=100$ m, $k=1$ s$^{-1}$, and $\\Delta x = 1$ m:\n- Compute $\\mathrm{Pe}$ and $\\mathrm{Da}$ from first principles using the characteristic-time definitions above.\n- Evaluate grid-scale characteristic times for advection and diffusion using $\\Delta x$ in place of $L$, and determine the stiffness ratio $\\mathcal{R} = \\tau_{\\max}/\\tau_{\\min}$ among the set $\\{\\tau_{a,\\mathrm{grid}}, \\tau_{d,\\mathrm{grid}}, \\tau_{r}\\}$. For the purpose of this problem, classify the semi-discrete system as stiff if $\\mathcal{R} \\geq 10^{3}$ and not stiff otherwise.\n- Report your result as a row matrix containing the three dimensionless entries $\\mathrm{Pe}$, $\\mathrm{Da}$, and $S$, where $S=1$ if the semi-discrete system is stiff under the above criterion and $S=0$ otherwise.\n\nExpress the final answer exactly, without rounding, and do not include units in the reported matrix.",
            "solution": "The problem statement has been validated and found to be scientifically grounded, well-posed, and objective. It provides a clear, self-contained set of definitions and data to perform a standard analysis of characteristic time scales and numerical stiffness in the context of an advection-diffusion-reaction system. All necessary information is present, and there are no contradictions or ambiguities. The problem is valid, and the solution proceeds as follows.\n\nThe problem requires the computation of two dimensionless numbers, the Péclet number ($\\mathrm{Pe}$) and the Damköhler number ($\\mathrm{Da}$), and an assessment of system stiffness based on a defined ratio of characteristic times. The solution is structured in two parts: first, the calculation of $\\mathrm{Pe}$ and $\\mathrm{Da}$ at the reach scale $L$; second, the stiffness analysis at the grid scale $\\Delta x$.\n\nFirst, we define and compute the characteristic times at the reach scale, $L = 100$ m, using the given parameters: advection velocity $u = 0.1$ m s$^{-1}$, diffusion coefficient $D = 10^{-5}$ m$^2$ s$^{-1}$, and reaction rate constant $k = 1$ s$^{-1}$.\n\nThe advective time, $\\tau_a$, is the time taken to traverse the length $L$ at velocity $u$:\n$$\n\\tau_a = \\frac{L}{u} = \\frac{100 \\text{ m}}{0.1 \\text{ m s}^{-1}} = 1000 \\text{ s}\n$$\nThe diffusive time, $\\tau_d$, is the characteristic time for diffusion to act over the length scale $L$. Based on dimensional analysis ($L^2 \\sim Dt$), this is:\n$$\n\\tau_d = \\frac{L^2}{D} = \\frac{(100 \\text{ m})^2}{10^{-5} \\text{ m}^2 \\text{s}^{-1}} = \\frac{10^4}{10^{-5}} \\text{ s} = 10^9 \\text{ s}\n$$\nThe reactive time, $\\tau_r$, is the e-folding time for the first-order decay process, which is the reciprocal of the rate constant $k$:\n$$\n\\tau_r = \\frac{1}{k} = \\frac{1}{1 \\text{ s}^{-1}} = 1 \\text{ s}\n$$\nThe problem defines the Péclet number, $\\mathrm{Pe}$, as the ratio of the diffusive time to the advective time at scale $L$.\n$$\n\\mathrm{Pe} = \\frac{\\tau_d}{\\tau_a} = \\frac{10^9 \\text{ s}}{1000 \\text{ s}} = 10^6\n$$\nThis result can be verified using the standard formula for the Péclet number, $\\mathrm{Pe} = uL/D$:\n$$\n\\mathrm{Pe} = \\frac{uL}{D} = \\frac{(0.1 \\text{ m s}^{-1})(100 \\text{ m})}{10^{-5} \\text{ m}^2 \\text{s}^{-1}} = \\frac{10}{10^{-5}} = 10^6\n$$\nThe Damköhler number, $\\mathrm{Da}$, is defined as the ratio of the advective time to the reactive time at scale $L$.\n$$\n\\mathrm{Da} = \\frac{\\tau_a}{\\tau_r} = \\frac{1000 \\text{ s}}{1 \\text{ s}} = 1000 = 10^3\n$$\nThis can be verified using the corresponding standard formula $\\mathrm{Da} = kL/u$:\n$$\n\\mathrm{Da} = \\frac{kL}{u} = \\frac{(1 \\text{ s}^{-1})(100 \\text{ m})}{0.1 \\text{ m s}^{-1}} = 1000 = 10^3\n$$\nThe calculated values are $\\mathrm{Pe} = 10^6$ and $\\mathrm{Da} = 10^3$.\n\nSecond, we analyze the stiffness of the semi-discrete system by comparing characteristic times at the grid scale, $\\Delta x = 1$ m. The set of times to consider is $\\{\\tau_{a,\\mathrm{grid}}, \\tau_{d,\\mathrm{grid}}, \\tau_{r}\\}$.\n\nThe grid-scale advective time, $\\tau_{a,\\mathrm{grid}}$, is the time to advect across one grid cell of size $\\Delta x$:\n$$\n\\tau_{a,\\mathrm{grid}} = \\frac{\\Delta x}{u} = \\frac{1 \\text{ m}}{0.1 \\text{ m s}^{-1}} = 10 \\text{ s}\n$$\nThe grid-scale diffusive time, $\\tau_{d,\\mathrm{grid}}$, is the characteristic time for diffusion to act across one grid cell:\n$$\n\\tau_{d,\\mathrm{grid}} = \\frac{(\\Delta x)^2}{D} = \\frac{(1 \\text{ m})^2}{10^{-5} \\text{ m}^2 \\text{s}^{-1}} = 10^5 \\text{ s}\n$$\nThe reactive time, $\\tau_r$, is an intrinsic property of the chemical reaction and does not depend on the spatial scale. Thus, it remains $\\tau_r = 1$ s.\n\nThe set of characteristic times governing the dynamics of the semi-discrete ODE system is therefore $\\{10 \\text{ s}, 10^5 \\text{ s}, 1 \\text{ s}\\}$.\n\nStiffness arises from a wide separation of time scales. We quantify this using the stiffness ratio $\\mathcal{R}$, defined as the ratio of the maximum to the minimum time in this set.\n$$\n\\tau_{\\min} = \\min\\{10 \\text{ s}, 10^5 \\text{ s}, 1 \\text{ s}\\} = 1 \\text{ s} \\quad (\\text{from reaction})\n$$\n$$\n\\tau_{\\max} = \\max\\{10 \\text{ s}, 10^5 \\text{ s}, 1 \\text{ s}\\} = 10^5 \\text{ s} \\quad (\\text{from grid-scale diffusion})\n$$\n$$\n\\mathcal{R} = \\frac{\\tau_{\\max}}{\\tau_{\\min}} = \\frac{10^5 \\text{ s}}{1 \\text{ s}} = 10^5\n$$\nThe problem provides a criterion to classify the system as stiff: $\\mathcal{R} \\geq 10^3$. In our case, $10^5 \\geq 10^3$. This condition is satisfied. Therefore, the semi-discrete system is considered stiff. According to the problem's instructions, this corresponds to a stiffness indicator $S = 1$.\n\nThe final result is to be reported as a row matrix containing the three dimensionless entries: $\\mathrm{Pe}$, $\\mathrm{Da}$, and $S$.\nThe values are:\n$\\mathrm{Pe} = 10^6$\n$\\mathrm{Da} = 10^3$\n$S = 1$\nThe resulting matrix is $[10^6, 10^3, 1]$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 \\times 10^6  1 \\times 10^3  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A numerically stable solution is not always a physically realistic one, especially in advection-dominated transport problems common in environmental science. This exercise demonstrates how centered-difference schemes, even when used implicitly, can produce non-physical oscillations, and explores how to diagnose this issue using the grid Péclet number. You will then investigate practical remedies, such as upwinding or adding artificial diffusion, to ensure a monotone and physically meaningful solution .",
            "id": "3916099",
            "problem": "Consider one-dimensional reactive solute transport in a saturated homogeneous porous medium governed by the advection–diffusion–reaction conservation law\n$$\n\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 C}{\\partial x^2} \\;-\\; k\\,C,\n$$\nwhere $C(x,t)$ is the aqueous concentration, $v$ is the pore-water velocity, $D$ is the hydrodynamic dispersion coefficient (assume purely molecular diffusion for this problem), and $k$ is a first-order decay rate. The domain is semi-infinite $x \\ge 0$. The initial and boundary conditions are a quiescent initial condition and a unit step inflow:\n$$\nC(x,0)=0 \\quad \\text{for all } x\\ge 0, \\qquad C(0,t)=1 \\quad \\text{for all } t0.\n$$\nYou discretize space uniformly with grid spacing $\\Delta x$ and advance in time with step $\\Delta t$ using the fully implicit (backward Euler) method. For spatial derivatives you use second-order centered differences for both the first derivative (advection term) and the second derivative (diffusion term). At each time step, this produces a tridiagonal linear system for the interior unknowns $C_i^{n+1}$.\n\nUsing only the conservation law above and standard centered-difference formulas, carry out the following:\n\n- Derive the discrete tridiagonal stencil at an interior node $i$ for the fully implicit scheme, identifying the three coefficients multiplying $C_{i-1}^{n+1}$, $C_i^{n+1}$, and $C_{i+1}^{n+1}$ on the left-hand side.\n- Using the discrete maximum principle and the theory of monotone matrices (in particular, the requirement that the coefficient matrix be an $M$-matrix with nonpositive off-diagonal entries), determine the inequality on $v$, $D$, and $\\Delta x$ under which the centered scheme is monotone and thus free of spurious overshoots at the advancing front.\n- With the physical and numerical parameters\n$$\nv = 7.2 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1},\\quad D = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1},\\quad k = 2.0\\ \\mathrm{s}^{-1},\\quad \\Delta x = 2.5 \\times 10^{-3}\\ \\mathrm{m},\\quad \\Delta t = 5.0 \\times 10^{-1}\\ \\mathrm{s},\n$$\nexplain briefly why the fully implicit centered scheme can generate overshoots at the leading edge of the front, despite unconditional linear stability in time.\n- Propose two monotonicity-preserving modifications: (i) a change to the advection discretization, and (ii) an additive increase $D_{\\text{art}}$ to the diffusion such that the centered scheme becomes monotone. Then, compute the minimum $D_{\\text{art}}$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$) required to guarantee monotonicity of the centered scheme on this grid.\n\nExpress your final numerical answer for $D_{\\text{art}}$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$, rounded to three significant figures. The final answer must be a single real number.",
            "solution": "The problem asks for an analysis of a numerical scheme for the one-dimensional advection-diffusion-reaction equation. The process involves deriving the discrete equations, analyzing their properties for monotonicity, and applying the results to a specific set of parameters to identify and correct potential numerical artifacts.\n\nThe governing partial differential equation (PDE) is:\n$$\n\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} \\;=\\; D\\,\\frac{\\partial^2 C}{\\partial x^2} \\;-\\; k\\,C\n$$\nThe numerical scheme uses a fully implicit (backward Euler) method for time integration and second-order centered differences for the spatial derivatives. Let $C_i^n$ be the numerical approximation of the concentration $C(x,t)$ at spatial node $x_i = i\\Delta x$ and time $t_n = n\\Delta t$.\n\nThe discrete approximations for the terms in the PDE at grid point $(i, n+1)$ are:\nTime derivative:\n$$ \\frac{\\partial C}{\\partial t} \\approx \\frac{C_i^{n+1} - C_i^n}{\\Delta t} $$\nAdvection term (centered difference):\n$$ v\\,\\frac{\\partial C}{\\partial x} \\approx v \\left( \\frac{C_{i+1}^{n+1} - C_{i-1}^{n+1}}{2 \\Delta x} \\right) $$\nDiffusion term (centered difference):\n$$ D\\,\\frac{\\partial^2 C}{\\partial x^2} \\approx D \\left( \\frac{C_{i+1}^{n+1} - 2C_i^{n+1} + C_{i-1}^{n+1}}{(\\Delta x)^2} \\right) $$\nReaction term:\n$$ -k\\,C \\approx -k\\,C_i^{n+1} $$\nSubstituting these into the governing PDE yields the fully discrete equation:\n$$\n\\frac{C_i^{n+1} - C_i^n}{\\Delta t} + v \\left( \\frac{C_{i+1}^{n+1} - C_{i-1}^{n+1}}{2 \\Delta x} \\right) = D \\left( \\frac{C_{i+1}^{n+1} - 2C_i^{n+1} + C_{i-1}^{n+1}}{(\\Delta x)^2} \\right) - k C_i^{n+1}\n$$\n\n**Derivation of the Tridiagonal Stencil**\nTo derive the stencil, we rearrange the equation to group all terms at the new time level $n+1$ on the left-hand side (LHS) and terms at the old time level $n$ on the right-hand side (RHS).\n$$\n\\frac{C_i^{n+1}}{\\Delta t} + v \\frac{C_{i+1}^{n+1}}{2 \\Delta x} - v \\frac{C_{i-1}^{n+1}}{2 \\Delta x} - D \\frac{C_{i+1}^{n+1}}{(\\Delta x)^2} + 2D \\frac{C_i^{n+1}}{(\\Delta x)^2} - D \\frac{C_{i-1}^{n+1}}{(\\Delta x)^2} + k C_i^{n+1} = \\frac{C_i^n}{\\Delta t}\n$$\nCollecting terms for $C_{i-1}^{n+1}$, $C_i^{n+1}$, and $C_{i+1}^{n+1}$ on the LHS:\n$$\n\\left( -\\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2} \\right) C_{i-1}^{n+1} + \\left( \\frac{1}{\\Delta t} + \\frac{2D}{(\\Delta x)^2} + k \\right) C_i^{n+1} + \\left( \\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2} \\right) C_{i+1}^{n+1} = \\frac{C_i^n}{\\Delta t}\n$$\nThe three coefficients of the tridiagonal stencil at an interior node $i$ are:\n- Coefficient of $C_{i-1}^{n+1}$: $a_{i-1} = -\\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2}$\n- Coefficient of $C_i^{n+1}$: $a_i = \\frac{1}{\\Delta t} + \\frac{2D}{(\\Delta x)^2} + k$\n- Coefficient of $C_{i+1}^{n+1}$: $a_{i+1} = \\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2}$\n\n**Monotonicity Condition**\nFor the numerical solution to be free of spurious oscillations (i.e., to satisfy a discrete maximum principle), the coefficient matrix of the linear system must be an M-matrix. A sufficient condition for a tridiagonal matrix to be an M-matrix is that its diagonal entries are positive and its off-diagonal entries are non-positive.\nThe diagonal entry, $a_i = \\frac{1}{\\Delta t} + \\frac{2D}{(\\Delta x)^2} + k$, is always positive for $\\Delta t  0$, $D \\ge 0$, and $k \\ge 0$.\nThe off-diagonal entries must be non-positive:\n$1.$ $a_{i-1} \\le 0 \\implies -\\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2} \\le 0 \\implies \\frac{v}{2\\Delta x} + \\frac{D}{(\\Delta x)^2} \\ge 0$. Assuming $v0$, this condition is always met.\n$2.$ $a_{i+1} \\le 0 \\implies \\frac{v}{2 \\Delta x} - \\frac{D}{(\\Delta x)^2} \\le 0 \\implies \\frac{v}{2 \\Delta x} \\le \\frac{D}{(\\Delta x)^2}$.\nMultiplying by $2(\\Delta x)^2 / D$ (assuming $D0$), we get:\n$$\n\\frac{v \\Delta x}{D} \\le 2\n$$\nThis inequality defines the grid Péclet number, $Pe_{\\Delta x} = \\frac{v \\Delta x}{D}$. The condition for monotonicity is $Pe_{\\Delta x} \\le 2$.\n\n**Analysis of the Scheme with Given Parameters**\nThe physical and numerical parameters are given as:\n$v = 7.2 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$D = 1.0 \\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$\n$\\Delta x = 2.5 \\times 10^{-3}\\ \\mathrm{m}$\n\nWe calculate the grid Péclet number:\n$$\nPe_{\\Delta x} = \\frac{v \\Delta x}{D} = \\frac{(7.2 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1})(2.5 \\times 10^{-3}\\ \\mathrm{m})}{1.0 \\times 10^{-9}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}} = \\frac{1.8 \\times 10^{-6}}{1.0 \\times 10^{-9}} = 1800\n$$\nSince $Pe_{\\Delta x} = 1800 \\gg 2$, the monotonicity condition is severely violated. This means the off-diagonal matrix entry corresponding to the coefficient of $C_{i+1}^{n+1}$ is positive, so the matrix is not an M-matrix. Consequently, the discrete maximum principle is not satisfied. The fully implicit scheme is unconditionally stable (A-stable), meaning numerical errors will not grow unboundedly in time. However, stability does not guarantee the absence of non-physical oscillations (overshoots and undershoots), particularly near sharp gradients like the advancing front. The large Péclet number indicates strong advection dominance at the grid scale, which, when coupled with a centered difference approximation for the advection term, is the cause of these spurious oscillations.\n\n**Monotonicity-Preserving Modifications**\n\n(i) **Change Advection Discretization**: A standard way to restore monotonicity is to replace the centered difference scheme for advection with a first-order upwind scheme. Since velocity $v  0$, we use a backward difference: $\\frac{\\partial C}{\\partial x} \\approx \\frac{C_i^{n+1} - C_{i-1}^{n+1}}{\\Delta x}$. This makes the off-diagonal coefficients unconditionally non-positive, ensuring the matrix is an M-matrix and the scheme is monotone, at the cost of introducing numerical diffusion which may excessively smear sharp fronts.\n\n(ii) **Additive Artificial Diffusion**: Another approach is to retain the centered scheme but add sufficient a-priori artificial diffusion, $D_{\\text{art}}$, to satisfy the monotonicity condition. We replace the physical diffusion $D$ with an effective diffusion $D_{\\text{eff}} = D + D_{\\text{art}}$. The monotonicity condition becomes:\n$$\n\\frac{v \\Delta x}{D_{\\text{eff}}} \\le 2 \\implies \\frac{v \\Delta x}{D + D_{\\text{art}}} \\le 2\n$$\nTo find the minimum required artificial diffusion, we set the condition to equality:\n$$\n\\frac{v \\Delta x}{D + D_{\\text{art}}} = 2\n$$\nSolving for $D_{\\text{art}}$:\n$$\nD + D_{\\text{art}} = \\frac{v \\Delta x}{2}\n$$\n$$\nD_{\\text{art}} = \\frac{v \\Delta x}{2} - D\n$$\nSubstituting the given numerical values:\n$$\nD_{\\text{art}} = \\frac{(7.2 \\times 10^{-4}) \\times (2.5 \\times 10^{-3})}{2} - (1.0 \\times 10^{-9})\n$$\n$$\nD_{\\text{art}} = \\frac{1.8 \\times 10^{-6}}{2} - 1.0 \\times 10^{-9}\n$$\n$$\nD_{\\text{art}} = 9.0 \\times 10^{-7} - 1.0 \\times 10^{-9}\n$$\n$$\nD_{\\text{art}} = 900 \\times 10^{-9} - 1.0 \\times 10^{-9} = 899 \\times 10^{-9}\n$$\n$$\nD_{\\text{art}} = 8.99 \\times 10^{-7}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}\n$$\nThis is the minimum value of artificial diffusion required to make the centered scheme monotone for the given grid. Rounding to three significant figures, the value is $8.99 \\times 10^{-7}\\ \\mathrm{m}^2\\,\\mathrm{s}^{-1}$.",
            "answer": "$$\\boxed{8.99 \\times 10^{-7}}$$"
        }
    ]
}