{
    "hands_on_practices": [
        {
            "introduction": "在耦合气候与地球系统建模中，准确量化地球能量收支的扰动是核心任务。此练习将指导您分析火山爆发等事件如何通过平流层气溶胶影响辐射平衡。您将亲手计算短波（冷却）和长波（增温）效应，从而深入理解辐射强迫的基本物理原理。",
            "id": "3872114",
            "problem": "一次大型火山喷发后，形成了一个全球均匀的平流层硫酸盐气溶胶层，对地球的辐射收支产生了类似皮纳图博火山喷发后的扰动。假设大气是充分混合的平行平面大气，其中有一个光学薄的平流层气溶胶层，其特征为短波（可见光）光学厚度 $\\tau_{s}$、单次散射反照率 $\\omega_{0}$ 和散射不对称因子 $g$。该气溶胶层在热红外波段也进行弱吸收和发射，这可以近似为一个灰色长波光学厚度 $\\tau_{L}$，它通过一个常数因子 $\\eta$ 与 $\\tau_{s}$ 成正比。\n\n采用以下物理上合理的参数：\n- 太阳常数 $S_{0} = 1361 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$，行星基准反照率 $A_{0} = 0.29$。\n- 气溶胶短波特性：$\\tau_{s} = 0.15$，$\\omega_{0} = 0.98$， $g = 0.70$。\n- 长波耦合：$\\tau_{L} = \\eta \\, \\tau_{s}$，其中 $\\eta = 0.06$，气溶胶层温度 $T_{a} = 220 \\ \\mathrm{K}$。\n- 斯特藩-玻尔兹曼常数 $\\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\ \\mathrm{K}^{-4}$。\n\n使用以下适用于地球系统的基本依据和假设：\n- 比尔-朗伯定律在光学薄极限（$\\tau \\ll 1$）下：光束的一阶分数衰减与 $\\tau$ 成正比。\n- 短波中的单次散射近似：每次散射事件中向空间的反向散射分数可近似为 $(1 - g)/2$，单位路径上发生散射事件的概率为 $\\omega_{0} \\tau_{s}$。\n- 大气层顶 (TOA) 的能量平衡：在未受扰动状态下，向外长波辐射 (OLR) 等于吸收的短波辐射，因此来自气溶胶层下方的向上长波通量为 $F_{u} = (1 - A_{0}) \\, S_{0}/4$。\n- 在长波波段，光学薄的气溶胶层具有约等于 $\\tau_{L}$ 的半球发射率；其向上的热发射为 $\\tau_{L} \\sigma T_{a}^{4}$，并且它吸收了来自下方的向上长波通量 $F_{u}$ 的 $\\tau_{L}$ 部分。\n\n定义大气层顶的辐射扰动 $\\Delta F$，对于向下的净通量变化（即，向外辐射减少或向内辐射增加）其值为正。从这些基础出发，推导出短波扰动 $\\Delta F_{\\mathrm{SW}}$ 和长波扰动 $\\Delta F_{\\mathrm{LW}}$ 的表达式，然后计算净扰动\n$$\n\\Delta F_{\\mathrm{net}} = \\Delta F_{\\mathrm{SW}} + \\Delta F_{\\mathrm{LW}}.\n$$\n将 $\\Delta F_{\\mathrm{net}}$ 的最终数值答案四舍五入到四位有效数字，并以 $\\mathrm{W} \\ \\mathrm{m}^{-2}$ 为单位表示。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取给定条件\n- 太阳常数：$S_{0} = 1361 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$\n- 行星基准反照率：$A_{0} = 0.29$\n- 气溶胶短波光学厚度：$\\tau_{s} = 0.15$\n- 气溶胶单次散射反照率：$\\omega_{0} = 0.98$\n- 气溶胶散射不对称因子：$g = 0.70$\n- 长波光学厚度关系：$\\tau_{L} = \\eta \\, \\tau_{s}$\n- 长波耦合常数：$\\eta = 0.06$\n- 气溶胶层温度：$T_{a} = 220 \\ \\mathrm{K}$\n- 斯特藩-玻尔兹曼常数：$\\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\ \\mathrm{K}^{-4}$\n- 假设（比尔-朗伯）：光学薄极限（$\\tau \\ll 1$），分数衰减与 $\\tau$ 成正比。\n- 假设（短波）：单次散射近似。每次散射事件的反向散射分数为 $(1 - g)/2$。每单位路径发生散射事件的概率为 $\\omega_{0} \\tau_{s}$。\n- 假设（能量平衡）：来自气溶胶层下方的向上长波通量为 $F_{u} = (1 - A_{0}) \\, S_{0}/4$。\n- 假设（长波）：气溶胶半球发射率 $\\epsilon_{a} \\approx \\tau_L$。向上发射为 $\\tau_{L} \\sigma T_{a}^{4}$。吸收的向上通量的分数为 $\\tau_L$。\n- 定义：大气层顶的净辐射扰动为 $\\Delta F_{\\mathrm{net}} = \\Delta F_{\\mathrm{SW}} + \\Delta F_{\\mathrm{LW}}$，其中 $\\Delta F$ 对于向下的净通量变化（增温）为正。\n- 要求：计算 $\\Delta F_{\\mathrm{net}}$ 并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学依据充分**：该问题在大气辐射和气候科学原理方面有充分的根据。该情景描述了火山气溶胶的辐射强迫，这是一个公认的现象。光学厚度、单次散射反照率、不对称因子和斯特藩-玻尔兹曼定律的使用是辐射传输的基础。所提供的参数对于像皮纳图博火山这样的大型喷发是物理上现实的。\n- **提法恰当**：问题提供了推导唯一数值解所需的所有必要数据和一套清晰的简化假设。目标被明确陈述。\n- **客观性**：问题以精确、定量和无偏见的语言陈述。\n\n### 步骤3：结论与行动\n问题是有效的。它在科学上是合理的、自洽的并且提法恰当。将基于所提供的框架推导解决方案。\n\n大气层顶 (TOA) 的总辐射扰动 $\\Delta F_{\\mathrm{net}}$ 是短波扰动 ($\\Delta F_{\\mathrm{SW}}$) 和长波扰动 ($\\Delta F_{\\mathrm{LW}}$) 的总和。我们将分别计算每个分量。扰动被定义为当净通量向下变化时（增温效应）为正。\n\n首先，我们计算短波辐射扰动 $\\Delta F_{\\mathrm{SW}}$。这种扰动是由气溶胶层将入射的太阳辐射散射回太空造成的，这增加了行星反照率。出射短波辐射的净增加对应于负扰动。大气层顶的全球平均入射太阳通量为 $\\frac{S_{0}}{4}$。\n根据问题的单次散射近似，由气溶胶层散射回太空的入射辐射分数是散射事件概率与散射辐射被导向向上的半球（反向散射）的分数的乘积。\n光子被散射的概率由散射光学厚度 $\\omega_{0}\\tau_{s}$ 给出。\n被导向回太空的散射辐射分数近似为反向散射分数 $\\frac{1-g}{2}$。\n因此，由于气溶胶层而在大气层顶产生的额外出射短波通量为：\n$$\n\\Delta F_{\\mathrm{SW, out}} = \\left(\\frac{S_{0}}{4}\\right) \\omega_{0} \\tau_{s} \\left(\\frac{1-g}{2}\\right)\n$$\n短波扰动 $\\Delta F_{\\mathrm{SW}}$ 是净向下通量的变化，因此它是出射通量变化的负值。\n$$\n\\Delta F_{\\mathrm{SW}} = - \\Delta F_{\\mathrm{SW, out}} = - \\left(\\frac{S_{0}}{4}\\right) \\omega_{0} \\tau_{s} \\left(\\frac{1-g}{2}\\right)\n$$\n代入给定值：\n$S_{0} = 1361 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$，$\\omega_{0} = 0.98$，$\\tau_{s} = 0.15$，以及 $g = 0.70$。\n$$\n\\Delta F_{\\mathrm{SW}} = - \\left(\\frac{1361}{4}\\right) \\times 0.98 \\times 0.15 \\times \\left(\\frac{1 - 0.70}{2}\\right)\n$$\n$$\n\\Delta F_{\\mathrm{SW}} = - (340.25) \\times 0.98 \\times 0.15 \\times \\left(\\frac{0.30}{2}\\right)\n$$\n$$\n\\Delta F_{\\mathrm{SW}} = - (340.25) \\times 0.98 \\times 0.15 \\times 0.15\n$$\n$$\n\\Delta F_{\\mathrm{SW}} = -7.5025125 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}\n$$\n\n接下来，我们计算长波辐射扰动 $\\Delta F_{\\mathrm{LW}}$。这种扰动源于气溶胶层吸收和发射热红外辐射。扰动是向外长波辐射 (OLR) 变化的负值。\n两个效应改变了OLR：\n1. 气溶胶层吸收了来自下方更暖的地球-对流层系统的部分向上长波辐射，从而减少了OLR。这代表了增温效应。\n2. 气溶胶层本身以其自身的（低温）温度向太空向上发射长波辐射，增加了OLR。这代表了降温效应。\n\n来自该层下方的向上长波通量由 $F_{u} = (1-A_{0}) \\frac{S_{0}}{4}$ 给出。该层吸收的此通量的分数为 $\\tau_{L}$，因此OLR的减少量为 $\\tau_{L}F_{u}$。\n来自气溶胶层的向上发射由 $\\epsilon_{a} \\sigma T_{a}^{4}$ 给出。假设发射率 $\\epsilon_{a}$ 等于长波光学厚度 $\\tau_{L}$，则该发射为 $\\tau_{L} \\sigma T_{a}^{4}$。\nOLR的净变化是新的发射减去吸收的通量：\n$$\n\\Delta \\mathrm{OLR} = \\tau_{L} \\sigma T_{a}^{4} - \\tau_{L} F_{u}\n$$\n长波扰动为 $\\Delta F_{\\mathrm{LW}} = - \\Delta \\mathrm{OLR}$。\n$$\n\\Delta F_{\\mathrm{LW}} = - (\\tau_{L} \\sigma T_{a}^{4} - \\tau_{L} F_{u}) = \\tau_{L} F_{u} - \\tau_{L} \\sigma T_{a}^{4} = \\tau_{L} (F_{u} - \\sigma T_{a}^{4})\n$$\n代入 $F_u$ 的表达式：\n$$\n\\Delta F_{\\mathrm{LW}} = \\tau_{L} \\left( (1-A_{0})\\frac{S_{0}}{4} - \\sigma T_{a}^{4} \\right)\n$$\n我们首先计算长波光学厚度 $\\tau_L$：\n$\\tau_L = \\eta \\tau_s = 0.06 \\times 0.15 = 0.009$。\n现在将所有值代入 $\\Delta F_{\\mathrm{LW}}$ 的表达式中：\n$A_{0} = 0.29$，$S_{0} = 1361 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$，$\\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\ \\mathrm{K}^{-4}$，以及 $T_{a} = 220 \\ \\mathrm{K}$。\n$$\nF_{u} = (1-0.29) \\times \\frac{1361}{4} = 0.71 \\times 340.25 = 241.5775 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}\n$$\n$$\n\\sigma T_{a}^{4} = (5.670374419 \\times 10^{-8}) \\times (220)^{4} \\approx 132.846 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}\n$$\n$$\n\\Delta F_{\\mathrm{LW}} = 0.009 \\times (241.5775 - 132.846) = 0.009 \\times 108.7315 \\approx 0.9785835 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}\n$$\n这个正值表示长波辐射被捕获所产生的增温效应。\n\n最后，我们通过将短波和长波分量相加来计算净辐射扰动 $\\Delta F_{\\mathrm{net}}$。\n$$\n\\Delta F_{\\mathrm{net}} = \\Delta F_{\\mathrm{SW}} + \\Delta F_{\\mathrm{LW}}\n$$\n$$\n\\Delta F_{\\mathrm{net}} = -7.5025125 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} + 0.9785835 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} = -6.523929 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Delta F_{\\mathrm{net}} \\approx -6.524 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}\n$$\n净效应是强烈的冷却，因为短波反射效应主导了长波温室效应，这是平流层中大型硫酸盐气溶胶层的典型特征。",
            "answer": "$$\n\\boxed{-6.524}\n$$"
        },
        {
            "introduction": "地球系统模型必须对无法显式解析的次网格尺度过程进行参数化，海洋中的涡旋混合便是一个关键例子。本练习将探讨沿密度面（等密度面）和跨密度面（跨密度面）混合之间的关键差异，并揭示其对海洋层结的深远影响。通过此实践，您将理解著名的 Gent–McWilliams (GM) 参数化背后的物理思想，这是现代海洋模型的重要基石。",
            "id": "3872106",
            "problem": "考虑在Boussinesq近似下，层化海洋中被动标量 $T(\\mathbf{x},t)$ 的示踪物平流扩散方程，由以下守恒律给出\n$$\n\\frac{\\partial T}{\\partial t} + \\mathbf{u}\\cdot\\nabla T = \\nabla\\cdot\\left(\\mathbf{K}\\,\\nabla T\\right),\n$$\n其中 $\\mathbf{u}(\\mathbf{x},t)$ 是速度场，$\\mathbf{K}$ 是代表次网格混合的对称正定扩散张量。在稳定层化的海洋中，湍流混合具有强烈的各向异性：沿密度面（等密度面）的扩散要大于跨越密度面的扩散。在二维 $(x,z)$ 切片中，设 $\\mathbf{e}_s$ 表示等密度面的切向单位向量，$\\mathbf{e}_n$ 表示等密度面的法向单位向量。各向异性扩散张量可以在等密度面-法向基中表示为\n$$\n\\mathbf{K} = K_i\\,\\mathbf{e}_s\\mathbf{e}_s^{\\top} + K_d\\,\\mathbf{e}_n\\mathbf{e}_n^{\\top},\n$$\n其中 $K_i$ 是等密度面扩散率，$K_d$ 是跨密度面扩散率。在此理想化分析中，假设等密度面斜率（在 $(x,z)$ 平面内）$s = \\mathrm{d}z/\\mathrm{d}x$ 在空间和时间上为常数，并设 $H$ 为水柱深度。\n\n从平流扩散方程和上述各向异性扩散表示出发，完成以下任务：\n\n1. 仅使用基本守恒形式和Fick扩散定义，推导当扩散张量与恒定等密度面斜率 $s$ 对齐时，作用于纯垂直示踪物梯度 $\\partial T/\\partial z$ 的有效一维垂直扩散系数 $K_{\\mathrm{eff}}$。通过将 $\\mathbf{K}$ 投影到垂直方向，用 $K_i$、$K_d$ 和 $s$ 表示 $K_{\\mathrm{eff}}$。\n\n2. 考虑深度为 $H$ 的水柱中 $T(z,t)$ 的一维垂直扩散问题，在 $z=0$ 和 $z=H$ 处具有无通量（Neumann）边界条件，并且没有平均垂直平流（$w=0$）。从扩散方程和分离变量法出发，推导最低非平凡垂直模态的e折衰减时间尺度 $\\tau$ 作为 $H$ 和垂直扩散系数的函数。用 $K_{\\mathrm{eff}}$ 表示结果。\n\n3. 在中尺度涡的Gent–McWilliams参数化中，涡致输运被表示为与等密度面相切且不直接增加跨密度面混合的平流通量。从示踪物收支的角度解释，为什么这意味着示踪物扩散的跨密度面分量仍然由 $K_d$ 而非 $K_i$ 控制，因此第2部分中计算的e折衰减时间尺度应仅通过将垂直扩散率设置为其跨密度面值来获得。\n\n4. 实现一个程序，对于下面列出的每个测试用例，计算两个e折衰减时间尺度（以年为单位，1年定义为365天）：(a) 使用第1部分中垂直投影的各向异性扩散 $K_{\\mathrm{eff}}$ 获得的时间尺度 $\\tau_{\\mathrm{rot}}$；(b) 仅使用 $K_d$ 获得的时间尺度 $\\tau_{\\mathrm{GM}}$（代表第3部分中的Gent–McWilliams原理）。你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，数值按 $[\\tau_{\\mathrm{rot},1},\\tau_{\\mathrm{GM},1},\\tau_{\\mathrm{rot},2},\\tau_{\\mathrm{GM},2},\\dots]$ 的顺序排列。所有时间都以小数形式的年表示。\n\n使用以下科学上合理的参数值测试套件，涵盖典型、边界和边缘情况。必须遵守所有物理单位：$H$ 的单位是米， $K_i$ 和 $K_d$ 的单位是 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$，$s$ 是无量纲的。\n\n- 案例 1：$H=1000$, $K_i=1000$, $K_d=10^{-5}$, $s=10^{-3}$。\n- 案例 2：$H=1000$, $K_i=1000$, $K_d=10^{-5}$, $s=0$。\n- 案例 3：$H=4000$, $K_i=1000$, $K_d=10^{-5}$, $s=10^{-2}$。\n- 案例 4：$H=2000$, $K_i=100$, $K_d=10^{-5}$, $s=2\\times 10^{-3}$。\n- 案例 5：$H=1000$, $K_i=0$, $K_d=10^{-5}$, $s=10^{-3}$。\n\n您的程序不得读取任何输入，必须直接根据这些案例计算并打印所需的输出。",
            "solution": "该问题是有效的，因为它科学地基于物理海洋学的既定原则，是自洽的，并且是适定的。我们按步骤进行解答。\n\n### 第1部分：有效垂直扩散系数 $K_{\\mathrm{eff}}$ 的推导\n\n示踪物 $T$ 的扩散通量由Fick定律给出，$\\mathbf{F} = -\\mathbf{K}\\,\\nabla T$，其中 $\\mathbf{K}$ 是扩散张量。我们关心的是该通量的垂直分量 $F_z$，它是由纯垂直的示踪物梯度 $\\nabla T = \\frac{\\partial T}{\\partial z}\\mathbf{e}_z$ 引起的，其中 $\\mathbf{e}_z$ 是垂直方向的单位向量。\n\n垂直通量是总通量向量在垂直方向上的投影：\n$$\nF_z = \\mathbf{e}_z \\cdot \\mathbf{F} = \\mathbf{e}_z \\cdot (-\\mathbf{K}\\,\\nabla T)\n$$\n代入 $\\nabla T = \\frac{\\partial T}{\\partial z}\\mathbf{e}_z$：\n$$\nF_z = -\\left(\\mathbf{e}_z \\cdot \\mathbf{K} \\left(\\frac{\\partial T}{\\partial z}\\mathbf{e}_z\\right)\\right) = -\\left(\\mathbf{e}_z \\cdot \\mathbf{K}\\,\\mathbf{e}_z\\right) \\frac{\\partial T}{\\partial z}\n$$\n有效一维垂直扩散系数 $K_{\\mathrm{eff}}$ 由关系式 $F_z = -K_{\\mathrm{eff}}\\frac{\\partial T}{\\partial z}$ 定义。将其与上述表达式进行比较，我们确定：\n$$\nK_{\\mathrm{eff}} = \\mathbf{e}_z \\cdot \\mathbf{K}\\,\\mathbf{e}_z\n$$\n这是张量 $\\mathbf{K}$ 在笛卡尔 $(x,z)$ 基中的分量 $K_{zz}$。我们已知 $\\mathbf{K}$ 在等密度面-跨密度面基中的表达式：\n$$\n\\mathbf{K} = K_i\\,\\mathbf{e}_s\\mathbf{e}_s^{\\top} + K_d\\,\\mathbf{e}_n\\mathbf{e}_n^{\\top}\n$$\n其中 $K_i$ 是等密度面（沿坡）扩散率，$K_d$ 是跨密度面（跨坡）扩散率。为了求得 $K_{\\mathrm{eff}}$，我们必须用笛卡尔坐标表示基向量 $\\mathbf{e}_s$ 和 $\\mathbf{e}_n$，然后进行点积运算。\n\n等密度面由常数斜率 $s = \\mathrm{d}z/\\mathrm{d}x$ 定义。与该斜率相切的向量与 $(\\Delta x, \\Delta z) = (1, s)$ 成正比。相应的单位切向量 $\\mathbf{e}_s$ 是：\n$$\n\\mathbf{e}_s = \\frac{1}{\\sqrt{1^2 + s^2}}(1, s) = \\frac{1}{\\sqrt{1+s^2}}(\\mathbf{e}_x + s\\mathbf{e}_z)\n$$\n与等密度面垂直的法向量与 $(1, s)$ 正交，例如 $(-s, 1)$，因为它们的点积是 $(1, s) \\cdot (-s, 1) = -s + s = 0$。相应的单位法向量 $\\mathbf{e}_n$ 是：\n$$\n\\mathbf{e}_n = \\frac{1}{\\sqrt{(-s)^2 + 1^2}}(-s, 1) = \\frac{1}{\\sqrt{1+s^2}}(-s\\mathbf{e}_x + \\mathbf{e}_z)\n$$\n现在我们可以计算 $K_{\\mathrm{eff}}$：\n$$\nK_{\\mathrm{eff}} = \\mathbf{e}_z \\cdot (K_i\\,\\mathbf{e}_s\\mathbf{e}_s^{\\top} + K_d\\,\\mathbf{e}_n\\mathbf{e}_n^{\\top}) \\mathbf{e}_z = K_i (\\mathbf{e}_z \\cdot \\mathbf{e}_s)^2 + K_d (\\mathbf{e}_z \\cdot \\mathbf{e}_n)^2\n$$\n我们从向量定义中求出点积：\n$$\n\\mathbf{e}_z \\cdot \\mathbf{e}_s = \\mathbf{e}_z \\cdot \\left(\\frac{\\mathbf{e}_x + s\\mathbf{e}_z}{\\sqrt{1+s^2}}\\right) = \\frac{s}{\\sqrt{1+s^2}}\n$$\n$$\n\\mathbf{e}_z \\cdot \\mathbf{e}_n = \\mathbf{e}_z \\cdot \\left(\\frac{-s\\mathbf{e}_x + \\mathbf{e}_z}{\\sqrt{1+s^2}}\\right) = \\frac{1}{\\sqrt{1+s^2}}\n$$\n将这些代入 $K_{\\mathrm{eff}}$ 的表达式中：\n$$\nK_{\\mathrm{eff}} = K_i \\left(\\frac{s}{\\sqrt{1+s^2}}\\right)^2 + K_d \\left(\\frac{1}{\\sqrt{1+s^2}}\\right)^2 = \\frac{K_i s^2}{1+s^2} + \\frac{K_d}{1+s^2}\n$$\n因此，有效垂直扩散系数的最终表达式为：\n$$\nK_{\\mathrm{eff}} = \\frac{K_i s^2 + K_d}{1+s^2}\n$$\n\n### 第2部分：e折衰减时间尺度的推导\n\n我们考虑示踪物浓度 $T(z,t)$ 的一维垂直扩散问题：\n$$\n\\frac{\\partial T}{\\partial t} = K \\frac{\\partial^2 T}{\\partial z^2}\n$$\n其中 $K$ 是一个常数垂直扩散率。区域为 $z \\in [0, H]$，边界条件为无通量：\n$$\n\\frac{\\partial T}{\\partial z}(0, t) = 0 \\quad \\text{和} \\quad \\frac{\\partial T}{\\partial z}(H, t) = 0\n$$\n我们使用分离变量法，假设解的形式为 $T(z,t) = Z(z)\\Theta(t)$。代入偏微分方程得到：\n$$\nZ(z)\\frac{d\\Theta}{dt} = K \\Theta(t)\\frac{d^2Z}{dz^2} \\implies \\frac{1}{K\\Theta}\\frac{d\\Theta}{dt} = \\frac{1}{Z}\\frac{d^2Z}{dz^2}\n$$\n由于左边只依赖于 $t$，右边只依赖于 $z$，所以两边都必须等于一个常数，对于衰减解，我们将其记为 $-\\lambda^2$。\n\n时间方程是 $\\frac{d\\Theta}{dt} = -K\\lambda^2 \\Theta$，其解为 $\\Theta(t) = \\Theta_0 e^{-K\\lambda^2 t}$。e折衰减时间尺度为 $\\tau = 1/(K\\lambda^2)$。\n\n空间方程是 $\\frac{d^2Z}{dz^2} + \\lambda^2 Z = 0$，其通解为 $Z(z) = A \\cos(\\lambda z) + B \\sin(\\lambda z)$。我们应用边界条件来求解特征值 $\\lambda$。\n导数是 $Z'(z) = -A\\lambda \\sin(\\lambda z) + B\\lambda \\cos(\\lambda z)$。\n在 $z=0$ 处：$Z'(0) = B\\lambda = 0$。对于非平凡解，$\\lambda \\neq 0$，所以必须有 $B=0$。现在解为 $Z(z) = A \\cos(\\lambda z)$。\n在 $z=H$ 处：$Z'(H) = -A\\lambda \\sin(\\lambda H) = 0$。对于非平凡解，$A \\neq 0$ 且 $\\lambda \\neq 0$，所以我们要求 $\\sin(\\lambda H) = 0$。当 $\\lambda H = n\\pi$（其中 $n=0, 1, 2, \\dots$ 为整数）时，此条件满足。\n特征值为 $\\lambda_n = \\frac{n\\pi}{H}$。\n\n$n=0$ 模态对应于 $\\lambda_0 = 0$，得到一个恒定的空间分布 $Z(z) = A$。该模态不随时间衰减，代表平均示踪物浓度。最低的非平凡衰减模态对应于 $n=1$，它具有最长的e折衰减时间尺度。对于该模态，特征值为 $\\lambda_1 = \\pi/H$。\n\n最低非平凡模态的e折衰减时间尺度为：\n$$\n\\tau = \\frac{1}{K\\lambda_1^2} = \\frac{1}{K(\\pi/H)^2} = \\frac{H^2}{K\\pi^2}\n$$\n根据要求，用有效垂直扩散率 $K_{\\mathrm{eff}}$ 表示的时间尺度为：\n$$\n\\tau = \\frac{H^2}{K_{\\mathrm{eff}}\\pi^2}\n$$\n\n### 第3部分：Gent-McWilliams时间尺度的原理\n\nGent-McWilliams（GM）参数化通过一个涡致平流速度 $\\mathbf{u}^*$ 来表示中尺度涡的影响，该速度被构造为纯粹与等密度面相切。示踪物输运方程包含此项：$\\frac{\\partial T}{\\partial t} + (\\mathbf{u}+\\mathbf{u}^*)\\cdot\\nabla T = \\nabla\\cdot(\\mathbf{K}\\,\\nabla T)$。\n\nGM原理的核心在于*搅动*和*混合*之间的物理区别。\n1.  **搅动**：涡致速度 $\\mathbf{u}^*$ 沿等密度面搅动示踪物属性。这个过程使沿这些表面的示踪物浓度均匀化，但不会*跨越*这些表面输运任何示踪物。因此，它不会改变水团的体积属性（例如，它不能使高密度水变得密度更低）。这是一个绝热过程。\n2.  **混合**：真正的垂直混合，会导致大尺度垂直层化和水团属性的改变，需要跨密度面输运——即跨越等密度面的输运。在这个模型中，唯一能够实现跨密度面输运的过程是由张量 $\\mathbf{K}$ 表示的显式扩散。该扩散垂直于等密度面的分量由跨密度面扩散率 $K_d$ 控制。\n\n在第1部分中推导出的有效扩散率 $K_{\\mathrm{eff}} = (K_i s^2 + K_d)/(1+s^2)$ 是一个数学投影。$K_i s^2$ 项源于将非常迅速的*沿等密度面*搅动投影到垂直轴上。虽然这在局部产生了较大的有效垂直通量，但它并不代表大体积水团的净转化。海盆尺度垂直示踪物剖面的长期演变最终受到最慢过程的限制，即示踪物跨越密度面的物理输运。这个速率限制步骤由微小的跨密度面扩散率 $K_d$ 控制。\n\n因此，从示踪物收支和水团转化的角度来看，大尺度垂直结构衰减的相关时间尺度由跨密度面混合速率决定。垂直扩散率应简单地取为 $K=K_d$，而不是几何增强的 $K_{\\mathrm{eff}}$。相应的e折衰减时间尺度是 $\\tau_{\\mathrm{GM}} = H^2/(K_d\\pi^2)$。\n\n### 第4部分：实现公式\n\n程序将为每个案例计算两个时间尺度：\n1.  使用旋转（垂直投影）的扩散张量获得的时间尺度 $\\tau_{\\mathrm{rot}}$，其中有效垂直扩散率为 $K = K_{\\mathrm{eff}}$。\n$$\n\\tau_{\\mathrm{rot}} = \\frac{H^2}{K_{\\mathrm{eff}}\\pi^2} = \\frac{H^2 (1+s^2)}{(K_i s^2 + K_d)\\pi^2}\n$$\n2.  使用Gent-McWilliams原理获得的时间尺度 $\\tau_{\\mathrm{GM}}$，其中有效垂直扩散率就是跨密度面扩散率 $K = K_d$。\n$$\n\\tau_{\\mathrm{GM}} = \\frac{H^2}{K_d\\pi^2}\n$$\n所有以秒计算的时间尺度都将通过除以一个365天年份中的秒数（即 $365 \\times 24 \\times 60 \\times 60 = 31,536,000$）来转换为年。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes tracer diffusion e-folding timescales for different oceanographic scenarios.\n    \"\"\"\n\n    # Test cases: (H, Ki, Kd, s)\n    # H in meters\n    # Ki, Kd in m^2/s\n    # s is dimensionless\n    test_cases = [\n        (1000.0, 1000.0, 1.0e-5, 1.0e-3),\n        (1000.0, 1000.0, 1.0e-5, 0.0),\n        (4000.0, 1000.0, 1.0e-5, 1.0e-2),\n        (2000.0, 100.0, 1.0e-5, 2.0e-3),\n        (1000.0, 0.0, 1.0e-5, 1.0e-3),\n    ]\n\n    # Conversion factor from seconds to years (1 year = 365 days)\n    seconds_per_year = 365.0 * 24.0 * 3600.0\n\n    results = []\n    for case in test_cases:\n        H, Ki, Kd, s = case\n\n        # Part 1: Calculate the effective vertical diffusion coefficient K_eff\n        # K_eff = (Ki * s^2 + Kd) / (1 + s^2)\n        s_sq = s**2\n        K_eff = (Ki * s_sq + Kd) / (1.0 + s_sq)\n\n        # Part 2: Calculate the e-folding timescales using derived formulas\n        # tau = H^2 / (K * pi^2)\n\n        # Timescale (a): tau_rot using K_eff\n        # This represents the timescale based on the geometric projection of the\n        # full anisotropic diffusion tensor onto the vertical.\n        tau_rot_seconds = (H**2) / (K_eff * np.pi**2)\n        tau_rot_years = tau_rot_seconds / seconds_per_year\n\n        # Timescale (b): tau_GM using Kd\n        # This represents the timescale based on the Gent-McWilliams physical\n        # argument that diapycnal mixing is the rate-limiting step.\n        tau_gm_seconds = (H**2) / (Kd * np.pi**2)\n        tau_gm_years = tau_gm_seconds / seconds_per_year\n        \n        results.append(tau_rot_years)\n        results.append(tau_gm_years)\n\n    # Format the final output as a comma-separated list within brackets.\n    # The map(str, ...) ensures all numbers are converted to their string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "所有地球系统模型的核心都是求解质量、能量和动量等守恒律的数值方法。本练习让您亲手构建一个基本的数值模块——用于示踪物平流的守恒型有限体积格式。您将学习如何在离散计算中处理不同的物理边界条件，并验证该格式最重要的特性：质量守恒。",
            "id": "3872160",
            "problem": "您的任务是为交错网格上的一维示踪剂平流构建一个通量形式的有限体积离散化方案，并展示在多种科学上真实的边界条件下的离散守恒性。从被动示踪剂的质量守恒原理出发，设计一个数值上稳定且守恒的算法。目标是实现一个方案，其中单元平均示踪剂浓度通过面心通量的散度进行更新，并验证离散的全局质量收支变化在浮点精度范围内等于时间积分的净边界通量。\n\n从以下基本基础开始：\n- 由给定速度 $u(x,t)$ 平流的被动示踪剂浓度 $C(x,t)$ 的一维守恒律为 $ \\frac{\\partial C}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(u C\\right) = 0 $。\n- 单元 $i$ 的有限体积控制体积为 $[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$，宽度为 $\\Delta x$，其单元平均值 $C_i(t)$ 定义为 $ C_i(t) = \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} C(x,t)\\,dx $。\n- 在交错网格上，速度定义在单元面 $x_{j}$（$j=0,\\dots,N$），而示踪剂浓度以单元为中心在 $x_i$（$i=0,\\dots,N-1$）处定义。跨面的通量使用面心速度和迎风选择的示踪剂，以确保数值稳定性，同时保持守恒性。\n\n您的实现必须：\n- 在面 $j=0,\\dots,N$ 处构建面通量 $F_j = u_j \\, C^{\\mathrm{upwind}}_j$，其中 $C^{\\mathrm{upwind}}_j$ 是根据 $u_j$ 的符号确定的适当的迎风单元中心示踪剂。\n- 在时间步长 $\\Delta t$ 内使用通量散度更新单元平均值。\n- 以与物理释义一致的方式应用边界条件：\n    - 周期性边界：包裹索引，使左边界与最右侧单元相连，反之亦然。\n    - 闭合壁边界：在两个边界上施加零法向通量。\n    - 入流-出流边界：在每个边界上，如果流体进入域内，则使用规定的入流示踪剂浓度；如果流体离开，则使用内部迎风值。\n- 通过计算质量收支残差来跟踪和验证离散全局守恒性，该残差定义为\n  $$ R = \\left[ M(T) - M(0) \\right] - \\int_0^T \\left(F_0(t) - F_N(t)\\right) \\, A \\, dt, $$\n  其中 $M(t) = \\sum_{i=0}^{N-1} C_i(t) \\, \\Delta x \\, A$ 是在时间 $t$ 时域内的总示踪剂质量，$A$ 是横截面积，$F_0(t)$ 和 $F_N(t)$ 分别是通过左右边界的通量。在常数 $\\Delta t$ 的离散时间下，这变为\n  $$ R = \\left[ M^{n_{\\mathrm{end}}} - M^{0} \\right] - \\Delta t \\, A \\sum_{n=0}^{n_{\\mathrm{end}}-1} \\left(F_0^n - F_N^n\\right). $$\n  使用 $A=1\\,\\mathrm{m}^2$。\n\n物理和数值单位：\n- 域长度 $L$ 以米（$\\mathrm{m}$）为单位。\n- 速度 $u$ 以米每秒（$\\mathrm{m/s}$）为单位。\n- 时间步长 $\\Delta t$ 和总时间 $T=n_{\\mathrm{end}} \\Delta t$ 以秒（$\\mathrm{s}$）为单位。\n- 示踪剂浓度 $C$ 以千克每立方米（$\\mathrm{kg/m^3}$）为单位。\n- 质量 $M$ 和残差 $R$ 以千克（$\\mathrm{kg}$）为单位。\n- 不使用角度。\n\n设计选择：\n- 基于 $u_j$ 的符号，为 $C^{\\mathrm{upwind}}_j$ 使用显式迎风通量。\n- 确保在提供的测试中，Courant数 $ \\mathcal{C} = \\frac{|u| \\Delta t}{\\Delta x} $ 小于或等于 $1$。\n\n测试套件：\n使用以下参数集实现并运行离散化。对于每种情况，计算残差 $R$（单位为千克）并报告它。\n\n- 情况1（周期性，非零速度）：\n  - $L = 1000\\,\\mathrm{m}$，$N = 100$，均匀速度 $u = 1\\,\\mathrm{m/s}$，$\\Delta t = 5\\,\\mathrm{s}$，$n_{\\mathrm{end}} = 20$。\n  - 边界条件：周期性。\n  - 初始条件：$ C(x,0) = 1 + 0.5 \\sin\\left( \\frac{2\\pi x}{L} \\right) $。\n\n- 情况2（闭合壁，非零速度）：\n  - $L = 100\\,\\mathrm{m}$，$N = 50$，均匀速度 $u = 2\\,\\mathrm{m/s}$，$\\Delta t = 0.5\\,\\mathrm{s}$，$n_{\\mathrm{end}} = 25$。\n  - 边界条件：闭合壁（在 $x=0$ 和 $x=L$ 处法向通量为零）。\n  - 初始条件：$ C(x,0) = \\exp\\left( -\\frac{\\left(x - L/3\\right)^2}{2 \\sigma^2} \\right) $，其中 $ \\sigma = L/20 $。\n\n- 情况3（入流-出流，正速度）：\n  - $L = 200\\,\\mathrm{m}$，$N = 100$，均匀速度 $u = 0.5\\,\\mathrm{m/s}$，$\\Delta t = 2\\,\\mathrm{s}$，$n_{\\mathrm{end}} = 50$。\n  - 边界条件：入流-出流，规定入流浓度：左入流 $ C_{\\mathrm{in,L}} = 2\\,\\mathrm{kg/m^3} $，右入流 $ C_{\\mathrm{in,R}} = 0.5\\,\\mathrm{kg/m^3} $。\n  - 初始条件：$ C(x,0) = 0 $。\n\n- 情况4（入流-出流，负速度）：\n  - $L = 300\\,\\mathrm{m}$，$N = 60$，均匀速度 $u = -0.8\\,\\mathrm{m/s}$，$\\Delta t = 3\\,\\mathrm{s}$，$n_{\\mathrm{end}} = 30$。\n  - 边界条件：入流-出流，规定入流浓度：左入流 $ C_{\\mathrm{in,L}} = 0.7\\,\\mathrm{kg/m^3} $，右入流 $ C_{\\mathrm{in,R}} = 3\\,\\mathrm{kg/m^3} $。\n  - 初始条件：$ C(x,0) = 1 $。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含四个残差 $[R_1,R_2,R_3,R_4]$，格式为用方括号括起来的逗号分隔列表。\n- 每个残差必须是十进制浮点数，以千克为单位，使用科学记数法表示，并保留六位有效数字，例如 $[1.234567\\mathrm{e}{-08},-2.345678\\mathrm{e}{-10},\\dots]$。",
            "solution": "该问题要求在交错网格上构建并验证一个用于示踪剂平流方程的一维、显式、迎风有限体积格式。任务是为三种不同的边界条件（周期性、闭合壁和入流-出流）实现此格式，并验证离散实现能够守恒总示踪剂质量。\n\n其基本原理是被动示踪剂的守恒，其浓度为 $C(x,t)$，由速度场 $u(x,t)$ 平流，由一维连续性方程描述：\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{\\partial}{\\partial x}(uC) = 0\n$$\n在这里，项 $F(x,t) = u(x,t)C(x,t)$ 代表示踪剂的平流通量。\n\n为了推导数值格式，我们采用有限体积法，该方法基于守恒律的积分形式。我们将方程在一个控制体积（或单元）$i$ 上积分，该单元跨越空间区间 $[x_{i-1/2}, x_{i+1/2}]$，宽度为 $\\Delta x$。\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial C}{\\partial t} \\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial F}{\\partial x} \\,dx = 0\n$$\n使用莱布尼茨积分法则和微积分基本定理，上式变为：\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} C \\,dx + \\left[ F(x_{i+1/2},t) - F(x_{i-1/2},t) \\right] = 0\n$$\n我们将单元平均浓度定义为 $C_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} C(x,t) \\,dx$。问题指定了一个交错网格，其中示踪剂浓度 $C_i$ 定义在单元中心，速度 $u_j$ 定义在单元面。$x_{i+1/2}$ 处的面用索引 $j=i+1$ 表示，$x_{i-1/2}$ 处的面用索引 $j=i$ 表示。单元 $i$ 的半离散方程则为：\n$$\n\\frac{d C_i}{dt} = -\\frac{1}{\\Delta x} \\left( F_{i+1} - F_i \\right)\n$$\n使用步长为 $\\Delta t$ 的显式前向欧拉格式进行时间离散，得到全离散更新方程：\n$$\nC_i^{n+1} = C_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1}^n - F_i^n \\right)\n$$\n其中上标 $n$ 表示时间层 $t = n\\Delta t$。\n\n关键步骤是定义面通量 $F_j^n$。为保证稳定性，我们使用一阶迎风格式。用于计算面通量的示踪剂浓度取自该面的“迎风”单元，即流体来源的单元。给定面 $j$ 上的速度 $u_j$，迎风通量为：\n$$\nF_j^n = u_j \\, C_{j}^{\\mathrm{upwind}, n} = \\begin{cases} u_j C_{j-1}^n & \\text{if } u_j > 0 \\\\ u_j C_j^n & \\text{if } u_j < 0 \\\\ 0 & \\text{if } u_j = 0 \\end{cases}\n$$\n此公式适用于内部面 $j \\in \\{1, \\dots, N-1\\}$。对于边界面 $j=0$ 和 $j=N$，通量由指定的边界条件决定。\n\n1.  **周期性边界条件**：域是环绕的，使得单元 $i=-1$ 等效于单元 $i=N-1$，单元 $i=N$ 等效于单元 $i=0$。\n    -   在左边界（面 $j=0$）：如果 $u_0 > 0$，迎风单元是 $C_{-1}$，即 $C_{N-1}$。因此，$F_0^n = u_0 C_{N-1}^n$。如果 $u_0 < 0$，迎风单元是 $C_0$，所以 $F_0^n = u_0 C_0^n$。\n    -   在右边界（面 $j=N$）：如果 $u_N > 0$，迎风单元是 $C_{N-1}$，所以 $F_N^n = u_N C_{N-1}^n$。如果 $u_N < 0$，迎风单元是 $C_N$，即 $C_0$。因此，$F_N^n = u_N C_0^n$。\n\n2.  **闭合壁边界条件**：此条件在域边界上施加零法向通量。\n    -   在左边界（面 $j=0$）：$F_0^n = 0$。\n    -   在右边界（面 $j=N$）：$F_N^n = 0$。\n\n3.  **入流-出流边界条件**：通量取决于相对于域的流动方向。\n    -   在左边界（面 $j=0$）：如果 $u_0 > 0$（入流），则使用规定的浓度 $C_{\\mathrm{in,L}}$，所以 $F_0^n = u_0 C_{\\mathrm{in,L}}$。如果 $u_0 < 0$（出流），通量由内部浓度决定，$F_0^n = u_0 C_0^n$。\n    -   在右边界（面 $j=N$）：如果 $u_N > 0$（出流），通量由内部决定，$F_N^n = u_N C_{N-1}^n$。如果 $u_N < 0$（入流），则使用规定的浓度 $C_{\\mathrm{in,R}}$，所以 $F_N^n = u_N C_{\\mathrm{in,R}}$。\n\n任务的核心是验证离散质量守恒。在时间步 $n$ 时域内的总质量是 $M^n = A \\sum_{i=0}^{N-1} C_i^n \\Delta x$。守恒原理规定，一段时间内总质量的变化必须等于跨边界的净通量的时间积分。离散质量平衡残差 $R$ 在守恒成立时定义为零：\n$$\nR = \\left( M^{n_{\\mathrm{end}}} - M^0 \\right) - \\Delta t \\, A \\sum_{n=0}^{n_{\\mathrm{end}}-1} \\left( F_0^n - F_N^n \\right)\n$$\n一个正确实现的守恒格式将产生一个量级在浮点机器精度范围内的残差 $R$。数值实现将为四个指定的测试用例计算此残差。对于每个用例，确认Courant数 $\\mathcal{C} = \\frac{|u|\\Delta t}{\\Delta x}$ 小于或等于1，以确保显式时间步进格式的稳定性。",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(params):\n    \"\"\"\n    运行单个一维平流模拟并计算质量守恒残差。\n    \"\"\"\n    L = params['L']\n    N = params['N']\n    u_val = params['u']\n    dt = params['dt']\n    n_end = params['n_end']\n    bc_type = params['bc_type']\n    ic_func = params['ic_func']\n    bc_params = params.get('bc_params', {})\n    \n    # Grid and constants\n    dx = L / N\n    A = 1.0  # Cross-sectional area in m^2\n\n    # Check Courant stability condition\n    courant_number = abs(u_val) * dt / dx\n    if courant_number > 1.0:\n        # This is a check; the problem statement assures this is not violated.\n        raise ValueError(f\"Courant number {courant_number} > 1, simulation will be unstable.\")\n\n    # Staggered grid setup\n    x_centers = (np.arange(N) + 0.5) * dx\n    u = np.full(N + 1, u_val) # Velocities at N+1 faces\n\n    # Initial condition and mass\n    C = ic_func(x_centers, L, N)\n    M_initial = np.sum(C) * dx * A\n    \n    total_net_bdy_flux_integral = 0.0\n\n    # Time-stepping loop\n    for _ in range(n_end):\n        F = np.zeros(N + 1) # Fluxes at N+1 faces\n\n        # Interior fluxes (faces j=1 to N-1)\n        # Compact upwind formulation\n        u_val_pos = max(u_val, 0.0)\n        u_val_neg = min(u_val, 0.0)\n        F[1:N] = u_val_pos * C[:-1] + u_val_neg * C[1:]\n\n        # Boundary fluxes (faces j=0 and j=N)\n        if bc_type == 'periodic':\n            F[0] = u_val_pos * C[N-1] + u_val_neg * C[0]\n            F[N] = u_val_pos * C[N-1] + u_val_neg * C[0]\n        elif bc_type == 'closed_wall':\n            F[0] = 0.0\n            F[N] = 0.0\n        elif bc_type == 'inflow_outflow':\n            C_in_L = bc_params['C_in_L']\n            C_in_R = bc_params['C_in_R']\n            # Left boundary (j=0)\n            F[0] = u_val_pos * C_in_L + u_val_neg * C[0]\n            # Right boundary (j=N)\n            F[N] = u_val_pos * C[N-1] + u_val_neg * C_in_R\n\n        # Accumulate the time integral of net boundary flux\n        total_net_bdy_flux_integral += (F[0] - F[N]) * A * dt\n\n        # Update concentrations for all cells\n        C += -(dt / dx) * (F[1:] - F[:-1])\n\n    # Final mass\n    M_final = np.sum(C) * dx * A\n\n    # Calculate residual\n    residual = (M_final - M_initial) - total_net_bdy_flux_integral\n    return residual\n\ndef solve():\n    \"\"\"\n    定义测试用例，运行模拟并打印结果。\n    \"\"\"\n    test_cases = [\n        { # Case 1: Periodic\n            'L': 1000.0, 'N': 100, 'u': 1.0, 'dt': 5.0, 'n_end': 20,\n            'bc_type': 'periodic',\n            'ic_func': lambda x, L, N: 1.0 + 0.5 * np.sin(2 * np.pi * x / L)\n        },\n        { # Case 2: Closed-wall\n            'L': 100.0, 'N': 50, 'u': 2.0, 'dt': 0.5, 'n_end': 25,\n            'bc_type': 'closed_wall',\n            'ic_func': lambda x, L, N: np.exp(-(x - L/3.0)**2 / (2 * (L/20.0)**2))\n        },\n        { # Case 3: Inflow-Outflow, u > 0\n            'L': 200.0, 'N': 100, 'u': 0.5, 'dt': 2.0, 'n_end': 50,\n            'bc_type': 'inflow_outflow',\n            'ic_func': lambda x, L, N: np.zeros(N),\n            'bc_params': {'C_in_L': 2.0, 'C_in_R': 0.5}\n        },\n        { # Case 4: Inflow-Outflow, u  0\n            'L': 300.0, 'N': 60, 'u': -0.8, 'dt': 3.0, 'n_end': 30,\n            'bc_type': 'inflow_outflow',\n            'ic_func': lambda x, L, N: np.ones(N),\n            'bc_params': {'C_in_L': 0.7, 'C_in_R': 3.0}\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        residual = run_simulation(params)\n        results.append(residual)\n\n    # Format output as specified: one digit before '.', six after, scientific notation\n    formatted_results = [f\"{r:.6e}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}