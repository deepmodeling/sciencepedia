{
    "hands_on_practices": [
        {
            "introduction": "能量平衡模型（EBM）是理解气候临界点的基石。这个练习将指导你通过解析推导，揭示由于冰盖与地球反射率（反照率）之间的强正反馈，地球如何可能存在于多种稳定状态（例如，无冰的“暖地球”与完全冰封的“雪球地球”）。通过这项实践，你将掌握将物理概念转化为数学模型并分析其平衡结构的基本技能。",
            "id": "3865675",
            "problem": "考虑一个包含冰-反照率反馈的简化零维能量平衡模型 (EBM) 用于气候系统。吸收的短波通量被建模为 $S \\left(1 - \\alpha(f)\\right)$，其中 $S$ 是有效日照（太阳强迫），$\\alpha(f)$ 是取决于冰覆盖分数 $f \\in [0,1]$ 的行星反照率。假设存在两个特征反照率，$\\alpha_{i}$ 代表冰，$\\alpha_{o}$ 代表开阔洋面，满足 $0 < \\alpha_{o} < \\alpha_{i} < 1$，并且遵循线性混合法则 $\\alpha(f) = \\alpha_{i} f + \\alpha_{o} \\left(1 - f\\right)$。出射长波辐射被参数化为 $A + B T$，其中 $A > 0$ 且 $B > 0$，$T$ 是全球平均表面温度。该形式源于对参考气候状态下的斯特藩-玻尔兹曼定律（Stefan–Boltzmann law）的线性化。\n\n在平衡状态下，施加全球能量平衡 $S \\left(1 - \\alpha(f)\\right) = A + B T$ 以及一个基于两个特征温度 $T_{i} < T_{o}$ 的光滑冰分数本构关系，这两个温度分别代表大范围结冰的开始和海冰的消失。具体来说，假设采用以下斜坡闭合关系\n$$\nf(T) = \n\\begin{cases}\n1, & T \\le T_{i}, \\\\\n\\dfrac{T_{o} - T}{T_{o} - T_{i}}, & T_{i} < T < T_{o}, \\\\\n0, & T \\ge T_{o},\n\\end{cases}\n$$\n其中 $D \\equiv T_{o} - T_{i} > 0$。在内部区域 $T_{i} < T < T_{o}$，平衡冰分数 $f$ 必须满足自洽条件 $f = \\dfrac{T_{o} - T}{D}$ 以及能量平衡方程。在饱和区域，$f=0$（无冰）和 $f=1$（冰封）是稳定平衡的候选状态，前提是它们与相应的温度阈值一致。\n\n从能量平衡方程和给定的本构关系出发，推导内部平衡冰分数 $f^{*}(S)$ 作为 $S$ 的函数的闭式解析表达式（用 $A$, $B$, $T_{i}$, $T_{o}$, $\\alpha_{i}$ 和 $\\alpha_{o}$ 表示结果）。然后，确定日照阈值 $S_{+}$ 和 $S_{-}$，使得：\n- 对于 $S \\ge S_{+}$，无冰状态 $f=0$ 与 $T \\ge T_{o}$ 一致，并且是一个稳定平衡；\n- 对于 $S \\le S_{-}$，冰封状态 $f=1$ 与 $T \\le T_{i}$ 一致，并且是一个稳定平衡。\n\n你的推导必须从能量平衡和上述定义开始，清晰地展示所有步骤和假设。最终答案必须以符号形式表示。将最终答案以行矩阵的形式提供，依次包含 $f^{*}(S)$ 的表达式、$S_{-}$ 的表达式和 $S_{+}$ 的表达式。不需要进行数值计算，最终答案中不应包含任何单位。",
            "solution": "该问题要求针对一个零维能量平衡模型 (EBM)，推导内部平衡冰分数 $f^{*}(S)$ 以及日照阈值 $S_{+}$ 和 $S_{-}$。分析从所提供的基本方程开始。\n\n该系统在平衡状态下由两个核心方程定义：\n1.  能量平衡方程：$S \\left(1 - \\alpha(f)\\right) = A + B T$。\n2.  冰分数 $f$ 作为温度 $T$ 函数的本构关系。\n\n反照率 $\\alpha(f)$ 是冰反照率 $\\alpha_{i}$ 和洋面反照率 $\\alpha_{o}$ 的线性混合：\n$$ \\alpha(f) = \\alpha_{i} f + \\alpha_{o} (1 - f) = \\alpha_{o} + (\\alpha_{i} - \\alpha_{o})f $$\n让我们定义反照率差 $\\Delta\\alpha = \\alpha_{i} - \\alpha_{o}$。根据问题的约束条件 $0 < \\alpha_{o} < \\alpha_{i} < 1$，我们有 $\\Delta\\alpha > 0$。于是反照率函数为 $\\alpha(f) = \\alpha_{o} + f \\Delta\\alpha$。\n\n冰分数 $f(T)$ 是一个分段线性函数。我们首先关注内部平衡，它存在于温度范围 $T_{i} < T < T_{o}$ 内。在此区域内，冰分数由下式给出：\n$$ f(T) = \\frac{T_{o} - T}{T_{o} - T_{i}} $$\n让我们定义温度范围 $D \\equiv T_{o} - T_{i}$。由于 $T_{o} > T_{i}$，我们有 $D > 0$。该关系变为 $f = \\frac{T_{o} - T}{D}$。\n\n**1. 内部平衡冰分数 $f^{*}(S)$ 的推导**\n\n为了求出作为太阳强迫 $S$ 函数的平衡冰分数 $f^{*}(S)$，我们需要通过消去 $T$ 来解关于 $f$ 的方程组。\n从冰分数关系式中，我们可以将温度 $T$ 表示为 $f$ 的函数：\n$$ T = T_{o} - f D = T_{o} - f(T_{o} - T_{i}) $$\n现在，我们将 $\\alpha(f)$ 的表达式和 $T(f)$ 的表达式都代入能量平衡方程：\n$$ S \\left(1 - \\left[\\alpha_{o} + f \\Delta\\alpha\\right]\\right) = A + B \\left[T_{o} - f D\\right] $$\n$$ S(1 - \\alpha_{o}) - S f \\Delta\\alpha = A + B T_{o} - B f D $$\n这是一个关于 $f$ 的线性方程。我们可以通过将所有包含 $f$ 的项移到一边来解出 $f$：\n$$ B f D - S f \\Delta\\alpha = A + B T_{o} - S(1 - \\alpha_{o}) $$\n$$ f (B D - S \\Delta\\alpha) = A + B T_{o} - S(1 - \\alpha_{o}) $$\n解出 $f$，我们得到内部平衡冰分数 $f^{*}(S)$ 的表达式：\n$$ f^{*}(S) = \\frac{A + B T_{o} - S(1 - \\alpha_{o})}{B D - S \\Delta\\alpha} $$\n将 $D$ 和 $\\Delta\\alpha$ 的定义代回，得到以主要参数表示的表达式：\n$$ f^{*}(S) = \\frac{A + B T_{o} - S(1 - \\alpha_{o})}{B(T_{o} - T_{i}) - S(\\alpha_{i} - \\alpha_{o})} $$\n该解仅在 $f \\in (0,1)$ 时具有物理意义，这也定义了此内部平衡存在的 $S$ 的范围。\n\n**2. 阈值 $S_{+}$ 的推导**\n\n阈值 $S_{+}$ 对应于使无冰状态（$f=0$）成为一个一致、稳定平衡所需的最小日照。无冰状态的条件是 $T \\ge T_{o}$。\n首先，我们求出无冰状态（$f=0$）下的平衡温度 $T_{f=0}$。此时，反照率为 $\\alpha(0) = \\alpha_{o}$。能量平衡方程变为：\n$$ S(1 - \\alpha_{o}) = A + B T_{f=0} $$\n解出 $T_{f=0}$：\n$$ T_{f=0} = \\frac{S(1 - \\alpha_{o}) - A}{B} $$\n阈值 $S_{+}$ 是使该温度恰好等于结冰上限温度 $T_{o}$ 时的 $S$ 值。这标志着无冰状态变得自洽的点。\n$$ T_{o} = \\frac{S_{+}(1 - \\alpha_{o}) - A}{B} $$\n我们解出 $S_{+}$：\n$$ B T_{o} = S_{+}(1 - \\alpha_{o}) - A $$\n$$ S_{+}(1 - \\alpha_{o}) = A + B T_{o} $$\n$$ S_{+} = \\frac{A + B T_{o}}{1 - \\alpha_{o}} $$\n对于任何 $S \\ge S_{+}$，温度 $T_{f=0}$ 将大于或等于 $T_{o}$，使得无冰状态成为一个有效平衡。这个点也对应于 $f^{*}(S)$ 变为 $0$ 的分岔点。\n\n**3. 阈值 $S_{-}$ 的推导**\n\n阈值 $S_{-}$ 对应于使完全冰封状态（$f=1$）成为一个一致、稳定平衡的最大日照。冰封状态的条件是 $T \\le T_{i}$。\n首先，我们求出冰封状态（$f=1$）下的平衡温度 $T_{f=1}$。此时，反照率为 $\\alpha(1) = \\alpha_{i}$。能量平衡方程变为：\n$$ S(1 - \\alpha_{i}) = A + B T_{f=1} $$\n解出 $T_{f=1}$：\n$$ T_{f=1} = \\frac{S(1 - \\alpha_{i}) - A}{B} $$\n阈值 $S_{-}$ 是使该温度恰好等于冰稳定性下限温度 $T_{i}$ 时的 $S$ 值。\n$$ T_{i} = \\frac{S_{-}(1 - \\alpha_{i}) - A}{B} $$\n我们解出 $S_{-}$：\n$$ B T_{i} = S_{-}(1 - \\alpha_{i}) - A $$\n$$ S_{-}(1 - \\alpha_{i}) = A + B T_{i} $$\n$$ S_{-} = \\frac{A + B T_{i}}{1 - \\alpha_{i}} $$\n对于任何 $S \\le S_{-}$，温度 $T_{f=1}$ 将小于或等于 $T_{i}$，使得冰封状态成为一个有效平衡。这个点对应于 $f^{*}(S)$ 变为 $1$ 的分岔点。\n\n所要求的三个表达式是：\n1.  内部平衡冰分数： $f^{*}(S) = \\dfrac{A + B T_{o} - S(1 - \\alpha_{o})}{B(T_{o} - T_{i}) - S(\\alpha_{i} - \\alpha_{o})}$\n2.  冰封阈值： $S_{-} = \\dfrac{A + B T_{i}}{1 - \\alpha_{i}}$\n3.  无冰阈值： $S_{+} = \\dfrac{A + B T_{o}}{1 - \\alpha_{o}}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\dfrac{A + B T_{o} - S(1 - \\alpha_{o})}{B(T_{o} - T_{i}) - S(\\alpha_{i} - \\alpha_{o})} & \\dfrac{A + B T_{i}}{1 - \\alpha_{i}} & \\dfrac{A + B T_{o}}{1 - \\alpha_{o}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "现在，我们将焦点从全球能量平衡转向海洋动力学。Stommel类型的盒模型是一个简化但功能强大的工具，用于研究温盐环流（THC）的稳定性。本练习要求你分析一个带有非光滑非线性（绝对值函数）的系统，以找到其平衡分支，并确定可能导致环流灾难性崩溃的淡水强迫临界阈值——这是一个经典的鞍结分岔的例子。",
            "id": "3865564",
            "problem": "考虑一个简化的温盐环流（THC）双箱模型，其中盆地间的盐度差由单个无量纲标量 $S(t)$ 表示，净淡水强迫差异由无量纲控制参数 $F$ 表示。流量大小被视为与由给定的热强迫和可变的盐强迫产生的密度差成线性正比，即 $q = a - b S$，其中 $a > 0$ 和 $b > 0$ 是无量纲常数，分别代表按比例缩放的热驱动和盐收缩。在盐度差的盐平衡中，平流作用以与流量大小乘以盐度差成正比的速率输出盐度，此外还有一个线性的混合项。由此得到的无量纲演化方程为\n$$\n\\frac{dS}{dt} \\;=\\; F \\;-\\; \\big(|\\,a - b S\\,| + \\delta\\big)\\,S,\n$$\n其中 $\\delta > 0$ 是一个无量纲混合参数。该公式是基于双箱框架中的盐质量守恒和固定热强迫下密度的线性状态方程推导得出的，其中平流交换取决于密度驱动流的大小。\n\n任务：\n1. 从盐质量守恒原理和线性关系 $q = a - b S$ 出发，推导 $S$ 的平衡条件，并分段求出在 $S \\le a/b$ 和 $S \\ge a/b$ 两个区间内的平衡分支 $S^{*}(F)$。\n2. 推导平衡点处的雅可比导数（即方程右侧对 $S$ 的导数），并用其符号来判断平衡分支的局部线性稳定性。用 $a$、$b$ 和 $\\delta$ 明确说明每个分支的稳定性。\n3. 使用典型参数值 $a = 1$，$b = 1$ 和 $\\delta = 0.2$，计算该系统中发生鞍结（折叠）分岔时的临界淡水强迫 $F_{c}$。\n\n将 $F_{c}$ 的最终答案表示为一个无量纲数。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题陈述是关于一个代表气候子系统的简化动力系统分岔分析的有效练习。该模型是物理海洋学中一个成熟的概念工具（Stommel型箱式模型）。方程定义清晰，参数已指定，任务在数学上是精确的。该问题是自洽的，有科学依据且适定的。\n\n无量纲盐度差 $S(t)$ 的演化方程由下式给出\n$$\n\\frac{dS}{dt} = F - \\big(|\\,a - b S\\,| + \\delta\\big)\\,S\n$$\n其中 $F$、$a$、$b$ 和 $\\delta$ 是正的无量纲参数。\n\n### 任务1：平衡分支\n\n通过将时间导数设为零，即 $\\frac{dS}{dt} = 0$，可以找到平衡态，记为 $S^*$。这得出了平衡条件：\n$$\nF = \\big(|\\,a - b S^*\\,| + \\delta\\big)\\,S^*\n$$\n绝对值项要求我们根据 $a - bS$ 的符号，在两个独立的区间内分析该系统。\n\n**区间1：$S \\le \\frac{a}{b}$**\n\n在此区间内，$a - bS \\ge 0$，因此 $|a - bS| = a - bS$。平衡条件变为：\n$$\nF = (a - bS^* + \\delta)S^*\n$$\n将其重新整理成关于 $S^*$ 的标准二次型，得到：\n$$\nb(S^*)^2 - (a + \\delta)S^* + F = 0\n$$\n我们使用二次方程求根公式求解 $S^*$：\n$$\nS^*(F) = \\frac{(a + \\delta) \\pm \\sqrt{(a + \\delta)^2 - 4bF}}{2b}\n$$\n只要判别式非负，即 $(a + \\delta)^2 - 4bF \\ge 0$，这些解就是实数，这意味着 $F \\le \\frac{(a + \\delta)^2}{4b}$。这在此区间内给出了两个平衡分支，我们将其记为 $S^{*}_{+}$ 和 $S^{*}_{-}$。\n\n**区间2：$S \\ge \\frac{a}{b}$**\n\n在此区间内，$a - bS \\le 0$，因此 $|a - bS| = -(a - bS) = bS - a$。平衡条件变为：\n$$\nF = (bS^* - a + \\delta)S^*\n$$\n将其重新整理成关于 $S^*$ 的二次型，得到：\n$$\nb(S^*)^2 - (a - \\delta)S^* - F = 0\n$$\n使用二次方程求根公式求解 $S^*$：\n$$\nS^*(F) = \\frac{(a - \\delta) \\pm \\sqrt{(a - \\delta)^2 + 4bF}}{2b}\n$$\n由于 $b > 0$，$F > 0$，平方根下的项总是正的，并且大于 $(a - \\delta)^2$。因此，$\\sqrt{(a - \\delta)^2 + 4bF} > |a - \\delta|$。带有负号的根 $\\frac{(a - \\delta) - \\sqrt{\\dots}}{2b}$ 总是负的。由于 $S$ 代表盐度差，它在物理上被约束为非负值。因此，我们只保留正根，它在此区间内定义了一个单一的平衡分支：\n$$\nS^{**}(F) = \\frac{(a - \\delta) + \\sqrt{(a - \\delta)^2 + 4bF}}{2b}\n$$\n该分支在 $S^{**}(F) \\ge \\frac{a}{b}$ 的 $F$ 值下有效。\n\n### 任务2：稳定性分析\n\n平衡点 $S^*$ 的局部线性稳定性由在 $S^*$ 处计算的雅可比导数 $J = \\frac{df}{dS}$ 的符号决定，其中 $f(S) = F - \\big(|\\,a - b S\\,| + \\delta\\big)\\,S$。如果 $J < 0$，平衡是稳定的；如果 $J > 0$，则是不稳定的。\n\n**区间1：$S < \\frac{a}{b}$**\n\n这里，$f(S) = F - (a + \\delta)S + bS^2$。雅可比导数为：\n$$\nJ(S) = \\frac{df}{dS} = - (a + \\delta) + 2bS\n$$\n对于下分支 $S^{*}_{-} = \\frac{(a + \\delta) - \\sqrt{(a + \\delta)^2 - 4bF}}{2b}$：\n$$\nJ(S^{*}_{-}) = -(a + \\delta) + 2b \\left( \\frac{(a + \\delta) - \\sqrt{(a + \\delta)^2 - 4bF}}{2b} \\right) = - \\sqrt{(a + \\delta)^2 - 4bF}\n$$\n对于 $F < \\frac{(a + \\delta)^2}{4b}$，平方根下的项是正的，因此 $J(S^{*}_{-}) < 0$。所以，下分支 $S^{*}_{-}$ 是**稳定的**。\n\n对于上分支 $S^{*}_{+} = \\frac{(a + \\delta) + \\sqrt{(a + \\delta)^2 - 4bF}}{2b}$：\n$$\nJ(S^{*}_{+}) = -(a + \\delta) + 2b \\left( \\frac{(a + \\delta) + \\sqrt{(a + \\delta)^2 - 4bF}}{2b} \\right) = + \\sqrt{(a + \\delta)^2 - 4bF}\n$$\n对于 $F < \\frac{(a + \\delta)^2}{4b}$，$J(S^{*}_{+}) > 0$。因此，这个中间分支 $S^{*}_{+}$ 是**不稳定的**。\n\n**区间2：$S > \\frac{a}{b}$**\n\n这里，$f(S) = F + (a - \\delta)S - bS^2$。雅可比导数为：\n$$\nJ(S) = \\frac{df}{dS} = (a - \\delta) - 2bS\n$$\n对于平衡分支 $S^{**} = \\frac{(a - \\delta) + \\sqrt{(a - \\delta)^2 + 4bF}}{2b}$：\n$$\nJ(S^{**}) = (a - \\delta) - 2b \\left( \\frac{(a - \\delta) + \\sqrt{(a - \\delta)^2 + 4bF}}{2b} \\right) = - \\sqrt{(a - \\delta)^2 + 4bF}\n$$\n由于 $b > 0$，$F>0$，且参数都是实数，平方根下的项总是正的。因此，$J(S^{**}) < 0$。分支 $S^{**}$ 是**稳定的**。\n\n### 任务3：鞍结分岔的临界强迫\n\n当一个稳定平衡点和一个不稳定平衡点合并并湮灭时，会发生鞍结（或折叠）分岔。在此模型中，这对应于稳定分支 $S^{*}_{-}$ 和不稳定分支 $S^{*}_{+}$ 合并的点。在数学上，当区间1的二次方程的两个不同实根合并成一个实根时，会发生这种情况。这发生在二次方程的判别式为零时：\n$$\n(a + \\delta)^2 - 4bF = 0\n$$\n这个条件定义了临界淡水强迫 $F_c$：\n$$\nF_c = \\frac{(a + \\delta)^2}{4b}\n$$\n这也是雅可比导数为零的点，$J(S^{*}_{\\pm}) = 0$，这是鞍结分岔的一般条件。分岔点处的 $S$ 值为 $S_c = \\frac{a+\\delta}{2b}$。为了使这成为区间1内的一个有效分岔点，我们必须有 $S_c \\le a/b$，这意味着 $a+\\delta \\le 2a$，或 $\\delta \\le a$。给定参数 $a=1$ 和 $\\delta=0.2$，此条件得到满足。\n\n现在我们将给定的典型参数值 $a = 1$、$b = 1$ 和 $\\delta = 0.2$ 代入 $F_c$ 的表达式中：\n$$\nF_c = \\frac{(1 + 0.2)^2}{4 \\times 1} = \\frac{(1.2)^2}{4} = \\frac{1.44}{4} = 0.36\n$$\n问题要求将答案四舍五入到四位有效数字。\n\n$F_c = 0.3600$。",
            "answer": "$$\n\\boxed{0.3600}\n$$"
        },
        {
            "introduction": "理解分岔的存在是一回事，但量化其对现实世界的影响则更为关键。本练习将从解析建模转向计算分析，通过一个数值方法来展示接近临界点的一个重要后果：可预报性的丧失。你将通过编写程序来求解变分方程——这是敏感性分析的一项关键技术——来揭示微小的不确定性（无论来自初始条件还是模型参数）在分岔点附近如何被急剧放大，从而使长期预测变得极其困难。",
            "id": "3865520",
            "problem": "考虑一个无量纲化的一维气候子系统，该系统被建模为一个具有鞍结分岔范式(normal form)的常微分方程（ODE）。设状态变量为 $x$，控制参数为 $\\mu$。系统根据以下方程演化\n$$\n\\frac{dx}{dt} = f(x,\\mu) = \\mu - x^2,\n$$\n初始条件为 $x(0) = x_0$。对于 $\\mu > 0$，系统在 $x^\\star = \\sqrt{\\mu}$ 处有一个稳定平衡点，分岔（双曲稳定性的丧失）发生在 $\\mu = 0$ 处。\n\n在分岔点附近，由于对初始条件和参数不确定性的敏感性增加，预报技巧会下降。您的任务是通过计算 $x_0$ 和 $\\mu$ 的微小不确定性如何传播到 $x(T)$ 的不确定性中，来量化在有限预报时域内的这种下降。其中 $T$ 是预报时效。使用以下基本原理：\n- 流映射 $\\Phi_T(x_0,\\mu)$ 由初始值问题在 $t = T$ 时的解 $x(t)$ 定义。\n- 对于独立来源的一阶不确定性传播理论指出，假设不确定性很小，预报量的方差等于每个来源的方差通过流映射的敏感性平方传播后的总和。\n\n设 $\\sigma_{x_0}^2$ 为 $x_0$ 不确定性的方差，$\\sigma_{\\mu}^2$ 为 $\\mu$ 不确定性的方差。将预报时效为 $T$ 时的预报技巧指数 $S$ 定义为\n$$\nS = \\frac{1}{1 + \\frac{V_f}{V_0}},\n$$\n其中 $V_f$ 是通过一阶传播计算出的在时间 $T$ 的预报方差，而 $V_0 = \\sigma_{x_0}^2 + \\sigma_{\\mu}^2$ 是基线方差。预报技巧 $S$ 是无量纲的。相对于 $V_0$，较大的 $V_f$ 意味着较小的 $S$。\n\n开发一个完整的程序，该程序能够：\n1. 通过求解从 ODE 和流映射定义中导出的适当的变分方程，计算系统 $\\frac{dx}{dt} = \\mu - x^2$ 的流映射 $\\Phi_T(x_0,\\mu)$ 以及在指定的 $(x_0,\\mu)$ 处的敏感性 $\\frac{\\partial \\Phi_T}{\\partial x_0}$ 和 $\\frac{\\partial \\Phi_T}{\\partial \\mu}$。\n2. 使用这些敏感性计算预报方差\n$$\nV_f = \\left(\\frac{\\partial \\Phi_T}{\\partial x_0}\\right)^2 \\sigma_{x_0}^2 + \\left(\\frac{\\partial \\Phi_T}{\\partial \\mu}\\right)^2 \\sigma_{\\mu}^2,\n$$\n假设 $x_0$ 和 $\\mu$ 的不确定性是独立的，并且足够小以致一阶传播有效。\n3. 对每个测试用例返回预报技巧指数 $S$。\n\n此问题中的所有变量都是无量纲的，预报时效为 $T = 5$。对每个测试用例，使用 $x_0 = \\sqrt{\\max(\\mu, 0)}$。使用 $\\sigma_{x_0} = 1 \\times 10^{-3}$ 和 $\\sigma_{\\mu} = 1 \\times 10^{-3}$。\n\n测试组：\n- 用例 1：$\\mu = 0.5$（远离分岔点；稳定平衡点定义明确）。\n- 用例 2：$\\mu = 0.1$（更接近分岔点）。\n- 用例 3：$\\mu = 0.01$（非常接近分岔点）。\n- 用例 4：$\\mu = 0.0$（在分岔点上；非双曲平衡点）。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[s_1,s_2,s_3,s_4]$，其中每个 $s_i$ 是对应案例的预报技巧指数 $S$（浮点数）。",
            "solution": "问题陈述已经过严格评估，并被确定为有效。它在科学上基于动力系统理论和分岔分析，特别是使用了鞍结分岔的范式。该问题是适定的，为得到唯一且有意义的解提供了所有必要的数据和定义。语言客观精确，设置内部一致且无事实错误。\n\n任务是为由常微分方程（ODE） $\\frac{dx}{dt} = \\mu - x^2$ 描述的简单气候子系统模型计算预报技巧指数 $S$。该指数用于量化在分岔点 $\\mu=0$ 附近预报技巧的下降程度。S 的计算取决于预报方差 $V_f$，$V_f$ 是通过将状态 $x_0$ 和参数 $\\mu$ 的初始不确定性在预报时域 $T$ 内传播来确定的。这种传播需要计算最终状态 $x(T)$ 相对于 $x_0$ 和 $\\mu$ 的敏感性。\n\n设流映射为 $\\Phi_T(x_0, \\mu) = x(T)$，其中 $x(t)$ 是初始值问题的解。敏感性是该映射的偏导数，特别是在特定点 $(x_0, \\mu)$ 处求值的 $\\frac{\\partial \\Phi_T}{\\partial x_0}$ 和 $\\frac{\\partial \\Phi_T}{\\partial \\mu}$。这些敏感性可以通过与原始 ODE 联立求解一个变分方程组来找到。\n\n设 $S_{x_0}(t) = \\frac{\\partial x(t)}{\\partial x_0}$ 和 $S_{\\mu}(t) = \\frac{\\partial x(t)}{\\partial \\mu}$。我们通过对原始 ODE $\\frac{dx}{dt} = \\mu - x^2$ 分别关于 $x_0$ 和 $\\mu$ 求导，来推导这些敏感性的控制方程。\n\n关于初始条件的敏感性 $S_{x_0}$：\n$$\n\\frac{d}{dt} S_{x_0} = \\frac{d}{dt} \\left( \\frac{\\partial x}{\\partial x_0} \\right) = \\frac{\\partial}{\\partial x_0} \\left( \\frac{dx}{dt} \\right) = \\frac{\\partial}{\\partial x_0} (\\mu - x^2)\n$$\n使用链式法则，$\\frac{\\partial f(x,\\mu)}{\\partial x_0} = \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial x_0}$，我们得到：\n$$\n\\frac{dS_{x_0}}{dt} = (-2x) S_{x_0}\n$$\n初始条件通过对 $x(0) = x_0$ 关于 $x_0$ 求导得到：\n$$\nS_{x_0}(0) = \\frac{\\partial x(0)}{\\partial x_0} = \\frac{\\partial x_0}{\\partial x_0} = 1\n$$\n\n关于参数的敏感性 $S_{\\mu}$：\n$$\n\\frac{d}{dt} S_{\\mu} = \\frac{d}{dt} \\left( \\frac{\\partial x}{\\partial \\mu} \\right) = \\frac{\\partial}{\\partial \\mu} \\left( \\frac{dx}{dt} \\right) = \\frac{\\partial}{\\partial \\mu} (\\mu - x^2)\n$$\n使用链式法则，$\\frac{\\partial f(x,\\mu)}{\\partial \\mu} = \\frac{\\partial f}{\\partial \\mu} + \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial \\mu}$，我们得到：\n$$\n\\frac{dS_{\\mu}}{dt} = 1 + (-2x) S_{\\mu}\n$$\n初始条件通过对 $x(0) = x_0$ 关于 $\\mu$ 求导得到。在计算偏导数 $\\frac{\\partial \\Phi_T}{\\partial \\mu}$ 时，初始条件 $x_0$ 被视为一个独立变量。因此：\n$$\nS_{\\mu}(0) = \\frac{\\partial x(0)}{\\partial \\mu} = \\frac{\\partial x_0}{\\partial \\mu} = 0\n$$\n\n我们必须求解以下从 $t=0$到 $t=T=5$ 的三个耦合 ODE 组成的方程组：\n设状态向量为 $y(t) = [y_0(t), y_1(t), y_2(t)]^T \\equiv [x(t), S_{x_0}(t), S_{\\mu}(t)]^T$。\n$$\n\\frac{dy}{dt} =\n\\begin{pmatrix}\n\\mu - y_0^2 \\\\\n-2 y_0 y_1 \\\\\n1 - 2 y_0 y_2\n\\end{pmatrix}\n$$\n对于每个测试用例，参数 $\\mu$ 是给定的。轨迹的初始条件指定为 $x_0 = \\sqrt{\\max(\\mu, 0)}$。这意味着对于 $\\mu > 0$，我们在稳定平衡点 $x^\\star = \\sqrt{\\mu}$ 处开始每次模拟；对于 $\\mu = 0$，我们在非双曲平衡点 $x^\\star=0$ 处开始。因此，对于任何测试用例，轨迹都是平凡的：对所有 $t$，都有 $x(t) = x_0$。虽然这使得变分方程可以得到解析解，但问题所要求的数值解是一种更通用的方法，我们将予以实现。该系统的初始向量为：\n$$\ny(0) = [x_0, 1, 0]^T\n$$\n将系统积分到 $T=5$ 后，最终状态向量为 $y(T) = [\\Phi_T, \\frac{\\partial \\Phi_T}{\\partial x_0}, \\frac{\\partial \\Phi_T}{\\partial \\mu}]^T$。\n\n计算出敏感性后，我们计算预报方差 $V_f$ 和预报技巧指数 $S$。问题提供了 $\\sigma_{x_0} = 1 \\times 10^{-3}$ 和 $\\sigma_{\\mu} = 1 \\times 10^{-3}$，因此方差为 $\\sigma_{x_0}^2 = 1 \\times 10^{-6}$ 和 $\\sigma_{\\mu}^2 = 1 \\times 10^{-6}$。\n\n基线方差为 $V_0 = \\sigma_{x_0}^2 + \\sigma_{\\mu}^2 = 2 \\times 10^{-6}$。\n预报方差为 $V_f = \\left(\\frac{\\partial \\Phi_T}{\\partial x_0}\\right)^2 \\sigma_{x_0}^2 + \\left(\\frac{\\partial \\Phi_T}{\\partial \\mu}\\right)^2 \\sigma_{\\mu}^2$。\n预报技巧指数为 $S = \\frac{1}{1 + V_f/V_0}$。\n\n每个测试用例的步骤如下：\n1.  设置 $\\mu$ 的值。\n2.  计算初始状态 $x_0 = \\sqrt{\\max(\\mu, 0)}$。\n3.  定义初始向量 $y(0) = [x_0, 1, 0]^T$。\n4.  对从 $t=0$ 到 $t=T=5$ 的 ODE 系统进行数值求解。\n5.  从 $t=T$ 的解中提取敏感性 $S_{x_0}(T)$ 和 $S_{\\mu}(T)$。\n6.  计算 $V_f$，然后计算 $S$。\n\n对测试组中的每个 $\\mu$ 值重复此过程。结果表明，随着 $\\mu$ 接近分岔点 0，敏感性 $\\frac{\\partial \\Phi_T}{\\partial \\mu}$ 会显著增长，导致更大的预报方差 $V_f$ 和相应更低的预报技巧 $S$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the forecast skill index for a simple climate model near a\n    saddle-node bifurcation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases_mu = [0.5, 0.1, 0.01, 0.0]\n\n    # Define constants\n    T = 5.0  # Forecast lead time\n    sigma_x0 = 1e-3  # Uncertainty in initial condition\n    sigma_mu = 1e-3  # Uncertainty in parameter\n    \n    var_x0 = sigma_x0**2\n    var_mu = sigma_mu**2\n    V0 = var_x0 + var_mu  # Baseline variance\n\n    def system_ode(t, y, mu):\n        \"\"\"\n        Defines the system of coupled ODEs for the state and its sensitivities.\n        \n        Args:\n            t (float): Time.\n            y (np.ndarray): State vector [x, S_x0, S_mu].\n            mu (float): Control parameter.\n            \n        Returns:\n            np.ndarray: Derivatives [dx/dt, dS_x0/dt, dS_mu/dt].\n        \"\"\"\n        x, S_x0, S_mu = y\n        \n        # Original ODE\n        dx_dt = mu - x**2\n        \n        # Variational equation for sensitivity to x0\n        dS_x0_dt = -2.0 * x * S_x0\n        \n        # Variational equation for sensitivity to mu\n        dS_mu_dt = 1.0 - 2.0 * x * S_mu\n        \n        return np.array([dx_dt, dS_x0_dt, dS_mu_dt])\n\n    results = []\n    for mu in test_cases_mu:\n        # 1. Determine initial condition for the state variable\n        # The problem specifies starting at the equilibrium point.\n        x0 = np.sqrt(np.maximum(mu, 0))\n        \n        # 2. Set the initial vector for the full system [x, S_x0, S_mu]\n        # S_x0(0) = d(x(0))/d(x0) = 1\n        # S_mu(0) = d(x(0))/d(mu) = 0 (partial derivative)\n        y0 = np.array([x0, 1.0, 0.0])\n        \n        # 3. Solve the system of ODEs\n        # We use a high-precision solver to handle stiffness near the bifurcation\n        sol = solve_ivp(\n            fun=system_ode,\n            t_span=[0, T],\n            y0=y0,\n            args=(mu,),\n            method='RK45',\n            rtol=1e-9,\n            atol=1e-12\n        )\n        \n        # 4. Extract sensitivities at the final time T\n        y_T = sol.y[:, -1]\n        # x_T = y_T[0]  # Not needed for skill index calculation\n        S_x0_T = y_T[1]\n        S_mu_T = y_T[2]\n        \n        # 5. Compute the forecast variance Vf\n        Vf = (S_x0_T**2) * var_x0 + (S_mu_T**2) * var_mu\n        \n        # 6. Compute the forecast skill index S\n        S = 1.0 / (1.0 + Vf / V0)\n        \n        results.append(S)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}