{
    "hands_on_practices": [
        {
            "introduction": "Understanding tipping points often begins with simple, elegant models that capture the essence of a critical feedback. This first practice explores one of the most fundamental examples in climate science: the ice-albedo feedback. By working through a zero-dimensional Energy Balance Model, you will analytically derive the conditions under which our planet can exist in multiple stable states—such as an ice-free world and a \"snowball Earth\"—and determine the critical insolation thresholds that create a hysteresis loop, a hallmark of irreversible transitions. ",
            "id": "3865675",
            "problem": "Consider a simplified zero-dimensional Energy Balance Model (EBM) for the climate system with ice-albedo feedback. The absorbed shortwave flux is modeled as $S \\left(1 - \\alpha(f)\\right)$, where $S$ is the effective insolation (solar forcing), and $\\alpha(f)$ is the planetary albedo depending on the fractional ice cover $f \\in [0,1]$. Assume two characteristic albedos, $\\alpha_{i}$ for ice and $\\alpha_{o}$ for open ocean, with $0 < \\alpha_{o} < \\alpha_{i} < 1$, and a linear mixing rule $\\alpha(f) = \\alpha_{i} f + \\alpha_{o} \\left(1 - f\\right)$. The outgoing longwave radiation is parameterized as $A + B T$, where $A > 0$ and $B > 0$, and $T$ is the global-mean surface temperature. This form arises from a linearization of the Stefan–Boltzmann law about a reference climate state.\n\nAt equilibrium, impose global energy balance $S \\left(1 - \\alpha(f)\\right) = A + B T$ and a smooth constitutive relation for the ice fraction based on two characteristic temperatures, $T_{i} < T_{o}$, representing the onset of widespread ice and the disappearance of sea ice, respectively. Specifically, assume the ramp closure\n$$\nf(T) = \n\\begin{cases}\n1, & T \\le T_{i}, \\\\\n\\dfrac{T_{o} - T}{T_{o} - T_{i}}, & T_{i} < T < T_{o}, \\\\\n0, & T \\ge T_{o},\n\\end{cases}\n$$\nwith $D \\equiv T_{o} - T_{i} > 0$. In the interior regime $T_{i} < T < T_{o}$, the equilibrium ice fraction $f$ must satisfy the self-consistency condition $f = \\dfrac{T_{o} - T}{D}$ together with the energy balance. In the saturated regimes, $f=0$ (ice-free) and $f=1$ (ice-covered) are candidates for stable equilibria if they are consistent with the corresponding temperature thresholds.\n\nStarting from the energy balance and the given constitutive relations, derive the closed-form analytic expression for the interior equilibrium ice fraction $f^{*}(S)$ as a function of $S$ (express your result in terms of $A$, $B$, $T_{i}$, $T_{o}$, $\\alpha_{i}$, and $\\alpha_{o}$). Then, determine the insolation thresholds $S_{+}$ and $S_{-}$ such that:\n- for $S \\ge S_{+}$ the ice-free state $f=0$ is consistent with $T \\ge T_{o}$ and is a stable equilibrium;\n- for $S \\le S_{-}$ the ice-covered state $f=1$ is consistent with $T \\le T_{i}$ and is a stable equilibrium.\n\nYour derivation must begin from the energy balance and the definitions above, showing all steps and assumptions clearly. The final answer must be expressed symbolically. Provide your final answer as a row matrix containing, in order, the expression for $f^{*}(S)$, the expression for $S_{-}$, and the expression for $S_{+}$. No numerical evaluation is required, and no units should be included in the final answer.",
            "solution": "The problem requires the derivation of the interior equilibrium ice fraction $f^{*}(S)$ and the insolation thresholds $S_{+}$ and $S_{-}$ for a zero-dimensional Energy Balance Model (EBM). The analysis proceeds from the fundamental equations provided.\n\nThe system is defined by two core equations at equilibrium:\n1.  The energy balance equation: $S \\left(1 - \\alpha(f)\\right) = A + B T$.\n2.  The constitutive relation for the ice fraction $f$ as a function of temperature $T$.\n\nThe albedo $\\alpha(f)$ is a linear mixture of ice albedo $\\alpha_{i}$ and ocean albedo $\\alpha_{o}$:\n$$ \\alpha(f) = \\alpha_{i} f + \\alpha_{o} (1 - f) = \\alpha_{o} + (\\alpha_{i} - \\alpha_{o})f $$\nLet us define the albedo difference $\\Delta\\alpha = \\alpha_{i} - \\alpha_{o}$. By the problem's constraint $0 < \\alpha_{o} < \\alpha_{i} < 1$, we have $\\Delta\\alpha > 0$. The albedo function is then $\\alpha(f) = \\alpha_{o} + f \\Delta\\alpha$.\n\nThe ice fraction $f(T)$ is a piecewise linear function. We are first interested in the interior equilibrium, which exists for temperatures in the range $T_{i} < T < T_{o}$. In this regime, the ice fraction is given by:\n$$ f(T) = \\frac{T_{o} - T}{T_{o} - T_{i}} $$\nLet us define the temperature range $D \\equiv T_{o} - T_{i}$. Since $T_{o} > T_{i}$, we have $D > 0$. The relation becomes $f = \\frac{T_{o} - T}{D}$.\n\n**1. Derivation of the interior equilibrium ice fraction $f^{*}(S)$**\n\nTo find the equilibrium ice fraction $f^{*}(S)$ as a function of solar forcing $S$, we need to solve the system of equations for $f$ by eliminating $T$.\nFrom the ice fraction relation, we can express the temperature $T$ as a function of $f$:\n$$ T = T_{o} - f D = T_{o} - f(T_{o} - T_{i}) $$\nNow, we substitute both the expression for $\\alpha(f)$ and the expression for $T(f)$ into the energy balance equation:\n$$ S \\left(1 - \\left[\\alpha_{o} + f \\Delta\\alpha\\right]\\right) = A + B \\left[T_{o} - f D\\right] $$\n$$ S(1 - \\alpha_{o}) - S f \\Delta\\alpha = A + B T_{o} - B f D $$\nThis is a linear equation in $f$. We can solve for $f$ by gathering all terms involving $f$ on one side:\n$$ B f D - S f \\Delta\\alpha = A + B T_{o} - S(1 - \\alpha_{o}) $$\n$$ f (B D - S \\Delta\\alpha) = A + B T_{o} - S(1 - \\alpha_{o}) $$\nSolving for $f$, we obtain the expression for the interior equilibrium ice fraction, $f^{*}(S)$:\n$$ f^{*}(S) = \\frac{A + B T_{o} - S(1 - \\alpha_{o})}{B D - S \\Delta\\alpha} $$\nSubstituting the definitions of $D$ and $\\Delta\\alpha$ back yields the expression in terms of the primary parameters:\n$$ f^{*}(S) = \\frac{A + B T_{o} - S(1 - \\alpha_{o})}{B(T_{o} - T_{i}) - S(\\alpha_{i} - \\alpha_{o})} $$\nThis solution is physically meaningful only for $f \\in (0,1)$, which defines the range of $S$ for which this interior equilibrium exists.\n\n**2. Derivation of the threshold $S_{+}$**\n\nThe threshold $S_{+}$ corresponds to the minimum insolation required for the ice-free state ($f=0$) to be a consistent, stable equilibrium. The condition for the ice-free state is $T \\ge T_{o}$.\nFirst, we find the equilibrium temperature $T_{f=0}$ for the ice-free state ($f=0$). In this case, the albedo is $\\alpha(0) = \\alpha_{o}$. The energy balance equation becomes:\n$$ S(1 - \\alpha_{o}) = A + B T_{f=0} $$\nSolving for $T_{f=0}$:\n$$ T_{f=0} = \\frac{S(1 - \\alpha_{o}) - A}{B} $$\nThe threshold $S_{+}$ is the value of $S$ at which this temperature is exactly equal to the upper threshold for ice formation, $T_{o}$. This marks the point where the ice-free state becomes self-consistent.\n$$ T_{o} = \\frac{S_{+}(1 - \\alpha_{o}) - A}{B} $$\nWe solve for $S_{+}$:\n$$ B T_{o} = S_{+}(1 - \\alpha_{o}) - A $$\n$$ S_{+}(1 - \\alpha_{o}) = A + B T_{o} $$\n$$ S_{+} = \\frac{A + B T_{o}}{1 - \\alpha_{o}} $$\nFor any $S \\ge S_{+}$, the temperature $T_{f=0}$ will be greater than or equal to $T_{o}$, making the ice-free state a valid equilibrium. This point also corresponds to the bifurcation where $f^{*}(S)$ becomes $0$.\n\n**3. Derivation of the threshold $S_{-}$**\n\nThe threshold $S_{-}$ corresponds to the maximum insolation for which the fully ice-covered state ($f=1$) is a consistent, stable equilibrium. The condition for the ice-covered state is $T \\le T_{i}$.\nFirst, we find the equilibrium temperature $T_{f=1}$ for the ice-covered state ($f=1$). In this case, the albedo is $\\alpha(1) = \\alpha_{i}$. The energy balance equation becomes:\n$$ S(1 - \\alpha_{i}) = A + B T_{f=1} $$\nSolving for $T_{f=1}$:\n$$ T_{f=1} = \\frac{S(1 - \\alpha_{i}) - A}{B} $$\nThe threshold $S_{-}$ is the value of $S$ at which this temperature is exactly equal to the lower threshold for ice stability, $T_{i}$.\n$$ T_{i} = \\frac{S_{-}(1 - \\alpha_{i}) - A}{B} $$\nWe solve for $S_{-}$:\n$$ B T_{i} = S_{-}(1 - \\alpha_{i}) - A $$\n$$ S_{-}(1 - \\alpha_{i}) = A + B T_{i} $$\n$$ S_{-} = \\frac{A + B T_{i}}{1 - \\alpha_{i}} $$\nFor any $S \\le S_{-}$, the temperature $T_{f=1}$ will be less than or equal to $T_{i}$, making the ice-covered state a valid equilibrium. This point corresponds to the bifurcation where $f^{*}(S)$ becomes $1$.\n\nThe three requested expressions are:\n1.  Interior equilibrium ice fraction: $f^{*}(S) = \\dfrac{A + B T_{o} - S(1 - \\alpha_{o})}{B(T_{o} - T_{i}) - S(\\alpha_{i} - \\alpha_{o})}$\n2.  Ice-covered threshold: $S_{-} = \\dfrac{A + B T_{i}}{1 - \\alpha_{i}}$\n3.  Ice-free threshold: $S_{+} = \\dfrac{A + B T_{o}}{1 - \\alpha_{o}}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\dfrac{A + B T_{o} - S(1 - \\alpha_{o})}{B(T_{o} - T_{i}) - S(\\alpha_{i} - \\alpha_{o})} & \\dfrac{A + B T_{i}}{1 - \\alpha_{i}} & \\dfrac{A + B T_{o}}{1 - \\alpha_{o}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having explored bifurcations driven by radiative balance, we now turn to the ocean's role in climate stability. This exercise focuses on the Thermohaline Circulation (THC), a major driver of global heat transport that is sensitive to freshwater input from melting ice. Using a classic Stommel-type two-box model, you will analyze how the salinity difference between ocean basins can lead to multiple circulation regimes and calculate the critical freshwater forcing that can trigger a sudden collapse of the circulation—a classic tipping point scenario. ",
            "id": "3865564",
            "problem": "Consider a reduced two-box model of Thermohaline Circulation (THC), where the inter-basin salinity difference is represented by a single dimensionless scalar variable $S(t)$ and the net freshwater forcing difference is represented by a dimensionless control parameter $F$. The flow magnitude is taken to be linearly proportional to the density difference arising from prescribed thermal forcing and variable haline forcing, with $q = a - b S$, where $a > 0$ and $b > 0$ are dimensionless constants representing the scaled thermal driving and haline contraction, respectively. In the salt balance for the salinity difference, advection acts to export salinity at a rate proportional to the magnitude of the flow times the salinity difference, and there is an additional linear mixing term. The resulting non-dimensional evolution equation is\n$$\n\\frac{dS}{dt} \\;=\\; F \\;-\\; \\big(|\\,a - b S\\,| + \\delta\\big)\\,S,\n$$\nwhere $\\delta > 0$ is a dimensionless mixing parameter. This formulation follows from conservation of salt mass in a two-box framework and the linear equation of state for density under fixed thermal forcing, where the advective exchange depends on the magnitude of the density-driven flow.\n\nTasks:\n1. Starting from the salt mass conservation principle and the linear relation $q = a - b S$, derive the equilibrium condition for $S$ and obtain the equilibrium branches $S^{*}(F)$ piecewise for the regimes $S \\leq a/b$ and $S \\geq a/b$.\n2. Derive the Jacobian (the derivative of the right-hand side with respect to $S$) at equilibrium and use its sign to classify the local linear stability of the equilibrium branches. Clearly state the stability of each branch in terms of $a$, $b$, and $\\delta$.\n3. Using the canonical parameter values $a = 1$, $b = 1$, and $\\delta = 0.2$, compute the critical freshwater forcing $F_{c}$ at which a saddle-node (fold) bifurcation occurs in this system.\n\nExpress your final answer for $F_{c}$ as a dimensionless number. Round your answer to four significant figures.",
            "solution": "The evolution equation for the dimensionless salinity difference $S(t)$ is given by\n$$\n\\frac{dS}{dt} = F - \\big(|\\,a - b S\\,| + \\delta\\big)\\,S\n$$\nwhere $F$, $a$, $b$, and $\\delta$ are positive dimensionless parameters.\n\n### Task 1: Equilibrium Branches\n\nEquilibrium states, denoted by $S^*$, are found by setting the time derivative to zero, $\\frac{dS}{dt} = 0$. This yields the equilibrium condition:\n$$\nF = \\big(|\\,a - b S^*\\,| + \\delta\\big)\\,S^*\n$$\nThe absolute value term requires us to analyze the system in two separate regimes based on the sign of $a - bS$.\n\n**Regime 1: $S \\leq \\frac{a}{b}$**\n\nIn this regime, $a - bS \\geq 0$, so $|a - bS| = a - bS$. The equilibrium condition becomes:\n$$\nF = (a - bS^* + \\delta)S^*\n$$\nRearranging this into a standard quadratic form for $S^*$ gives:\n$$\nb(S^*)^2 - (a + \\delta)S^* + F = 0\n$$\nWe solve for $S^*$ using the quadratic formula:\n$$\nS^*(F) = \\frac{(a + \\delta) \\pm \\sqrt{(a + \\delta)^2 - 4bF}}{2b}\n$$\nThese solutions are real provided the discriminant is non-negative, i.e., $(a + \\delta)^2 - 4bF \\geq 0$, which means $F \\leq \\frac{(a + \\delta)^2}{4b}$. This gives two equilibrium branches in this regime, which we denote as $S^{*}_{+}$ and $S^{*}_{-}$.\n\n**Regime 2: $S \\geq \\frac{a}{b}$**\n\nIn this regime, $a - bS \\leq 0$, so $|a - bS| = -(a - bS) = bS - a$. The equilibrium condition becomes:\n$$\nF = (bS^* - a + \\delta)S^*\n$$\nRearranging this into a quadratic form for $S^*$ gives:\n$$\nb(S^*)^2 - (a - \\delta)S^* - F = 0\n$$\nSolving for $S^*$ using the quadratic formula:\n$$\nS^*(F) = \\frac{(a - \\delta) \\pm \\sqrt{(a - \\delta)^2 + 4bF}}{2b}\n$$\nSince $b > 0$, $F > 0$, the term under the square root is always positive and greater than $(a - \\delta)^2$. Therefore, $\\sqrt{(a - \\delta)^2 + 4bF} > |a - \\delta|$. The root with the minus sign, $\\frac{(a - \\delta) - \\sqrt{\\dots}}{2b}$, is always negative. As $S$ represents a salinity difference, it is physically constrained to be non-negative. We thus retain only the positive root, which defines a single equilibrium branch in this regime:\n$$\nS^{**}(F) = \\frac{(a - \\delta) + \\sqrt{(a - \\delta)^2 + 4bF}}{2b}\n$$\nThis branch is valid for values of $F$ where $S^{**}(F) \\geq \\frac{a}{b}$.\n\n### Task 2: Stability Analysis\n\nThe local linear stability of an equilibrium point $S^*$ is determined by the sign of the Jacobian, $J = \\frac{df}{dS}$, evaluated at $S^*$, where $f(S) = F - \\big(|\\,a - b S\\,| + \\delta\\big)\\,S$. If $J < 0$, the equilibrium is stable; if $J > 0$, it is unstable.\n\n**Regime 1: $S < \\frac{a}{b}$**\n\nHere, $f(S) = F - (a + \\delta)S + bS^2$. The Jacobian is:\n$$\nJ(S) = \\frac{df}{dS} = - (a + \\delta) + 2bS\n$$\nFor the lower branch, $S^{*}_{-} = \\frac{(a + \\delta) - \\sqrt{(a + \\delta)^2 - 4bF}}{2b}$:\n$$\nJ(S^{*}_{-}) = -(a + \\delta) + 2b \\left( \\frac{(a + \\delta) - \\sqrt{(a + \\delta)^2 - 4bF}}{2b} \\right) = - \\sqrt{(a + \\delta)^2 - 4bF}\n$$\nFor $F < \\frac{(a + \\delta)^2}{4b}$, the term under the square root is positive, so $J(S^{*}_{-}) < 0$. Thus, the lower branch $S^{*}_{-}$ is **stable**.\n\nFor the upper branch, $S^{*}_{+} = \\frac{(a + \\delta) + \\sqrt{(a + \\delta)^2 - 4bF}}{2b}$:\n$$\nJ(S^{*}_{+}) = -(a + \\delta) + 2b \\left( \\frac{(a + \\delta) + \\sqrt{(a + \\delta)^2 - 4bF}}{2b} \\right) = + \\sqrt{(a + \\delta)^2 - 4bF}\n$$\nFor $F < \\frac{(a + \\delta)^2}{4b}$, $J(S^{*}_{+}) > 0$. Thus, this middle branch $S^{*}_{+}$ is **unstable**.\n\n**Regime 2: $S > \\frac{a}{b}$**\n\nHere, $f(S) = F + (a - \\delta)S - bS^2$. The Jacobian is:\n$$\nJ(S) = \\frac{df}{dS} = (a - \\delta) - 2bS\n$$\nFor the equilibrium branch $S^{**} = \\frac{(a - \\delta) + \\sqrt{(a - \\delta)^2 + 4bF}}{2b}$:\n$$\nJ(S^{**}) = (a - \\delta) - 2b \\left( \\frac{(a - \\delta) + \\sqrt{(a - \\delta)^2 + 4bF}}{2b} \\right) = - \\sqrt{(a - \\delta)^2 + 4bF}\n$$\nSince $b > 0$, $F>0$, and parameters are real, the term under the square root is always positive. Thus, $J(S^{**}) < 0$. The branch $S^{**}$ is **stable**.\n\n### Task 3: Critical Forcing for Saddle-Node Bifurcation\n\nA saddle-node (or fold) bifurcation occurs when a stable and an unstable equilibrium merge and annihilate. In this model, this corresponds to the point where the stable branch $S^{*}_{-}$ and the unstable branch $S^{*}_{+}$ merge. Mathematically, this occurs when the two distinct real roots of the quadratic equation for Regime 1 coalesce into a single real root. This happens when the discriminant of the quadratic is zero:\n$$\n(a + \\delta)^2 - 4bF = 0\n$$\nThis condition defines the critical freshwater forcing, $F_c$:\n$$\nF_c = \\frac{(a + \\delta)^2}{4b}\n$$\nThis is also the point where the Jacobian is zero, $J(S^{*}_{\\pm}) = 0$, which is the general condition for a saddle-node bifurcation. The value of $S$ at the bifurcation point is $S_c = \\frac{a+\\delta}{2b}$. For this to be a valid bifurcation point within Regime 1, we must have $S_c \\leq a/b$, which implies $a+\\delta \\leq 2a$, or $\\delta \\leq a$. Given the parameters $a=1$ and $\\delta=0.2$, this condition is satisfied.\n\nWe now substitute the given canonical parameter values $a = 1$, $b = 1$, and $\\delta = 0.2$ into the expression for $F_c$:\n$$\nF_c = \\frac{(1 + 0.2)^2}{4 \\times 1} = \\frac{(1.2)^2}{4} = \\frac{1.44}{4} = 0.36\n$$\nThe problem requires the answer to be rounded to four significant figures.\n\n$F_c = 0.3600$.",
            "answer": "$$\n\\boxed{0.3600}\n$$"
        },
        {
            "introduction": "While analytical solutions for simple models provide deep insights, modern climate research relies heavily on computational methods to analyze more complex systems. This final practice bridges the gap by tasking you with building a general-purpose numerical tool for bifurcation analysis. You will implement an algorithm to automatically find all equilibrium points of a system and determine their stability, a foundational skill for any computational modeler, and test it on a canonical equation that describes the universal behavior of systems near a bifurcation point. ",
            "id": "3865644",
            "problem": "Consider a reduced, nondimensional, one-dimensional climate subsystem model obtained via Center Manifold Reduction (CMR) from a physically based energy balance framework. The autonomous Ordinary Differential Equation (ODE) describing the slow invariant dynamics is\n$$\n\\frac{dX}{dt} = f(X;\\mu) = \\mu + X - X^3,\n$$\nwhere $X$ is a nondimensional state variable representing a slowly varying large-scale climate quantity (for example, a normalized global-mean temperature anomaly or ice-line coordinate), and $\\mu$ is a nondimensional control parameter representing effective external forcing (for example, scaled radiative forcing or freshwater perturbation). Invariant sets of this flow are equilibria $X^\\star$ satisfying the invariance condition\n$$\nf(X^\\star;\\mu) = 0.\n$$\nThe linear stability of an equilibrium $X^\\star$ is determined by the linearization coefficient\n$$\n\\lambda(X^\\star;\\mu) = \\left.\\frac{\\partial f}{\\partial X}\\right|_{X^\\star} = 1 - 3\\,(X^\\star)^2.\n$$\nAn equilibrium is linearly stable if and only if $\\lambda(X^\\star;\\mu) < 0$ and linearly unstable if and only if $\\lambda(X^\\star;\\mu) > 0$. At a saddle-node bifurcation, a pair of equilibria coalesce with $\\lambda(X^\\star;\\mu)=0$.\n\nYour task is to demonstrate numerical methods that:\n- Approximate all real invariant equilibria $X^\\star$ for the model at specified parameter values $\\mu$.\n- Verify their stability properties via the sign of $\\lambda(X^\\star;\\mu)$.\n- Quantify the numerical accuracy of the invariant set approximation by evaluating the residual $|f(X^\\star;\\mu)|$ at the numerically computed equilibria.\n\nImplement an algorithm that, for each given $\\mu$, numerically finds all real roots of the cubic equation $-X^3 + X + \\mu = 0$ (equivalently $f(X;\\mu)=0$), filters purely real solutions, merges duplicates that arise at degenerate (double-root) parameter values using a small absolute tolerance, and computes stability classifications and diagnostic metrics. The diagnostic metrics must include:\n- The total number of distinct real equilibria $N_{\\mathrm{eq}}$.\n- The number of linearly stable equilibria $N_{\\mathrm{st}}$ determined by the sign of $\\lambda(X^\\star;\\mu)$.\n- The maximum residual $R_{\\max} = \\max_{X^\\star} |f(X^\\star;\\mu)|$ over the set of numerically found equilibria.\n- The minimum absolute linearization magnitude $L_{\\min} = \\min_{X^\\star} |\\lambda(X^\\star;\\mu)|$, which highlights proximity to saddle-node conditions where $|\\lambda|$ approaches $0$.\n\nDesign the numerical method to be robust across regimes with one equilibrium, three equilibria, and degenerate saddle-node cases where two equilibria coalesce. You must not use any closed-form analytic solution of the cubic; rely only on numerical algorithms.\n\nTest Suite:\nEvaluate your program for the following control parameter values, which include a general case, edge cases, and boundary cases:\n- $\\mu = -0.350$ (general case with three equilibria expected),\n- $\\mu = 0.000$ (symmetric case),\n- $\\mu = 0.300$ (general case),\n- $\\mu = \\frac{2}{3\\sqrt{3}} \\approx 0.3849001794597505$ (positive boundary saddle-node),\n- $\\mu = -\\frac{2}{3\\sqrt{3}} \\approx -0.3849001794597505$ (negative boundary saddle-node),\n- $\\mu = 0.500$ (single-equilibrium regime).\n\nAnswer Specification and Final Output Format:\n- For each test case, output a list $[N_{\\mathrm{eq}}, N_{\\mathrm{st}}, R_{\\max}, L_{\\min}]$, with $R_{\\max}$ and $L_{\\min}$ reported as decimal numbers rounded to eight decimal places.\n- Aggregate the results of all test cases, in the order listed above, into a single line of output that is a comma-separated list enclosed in square brackets, where each element is the per-test-case list described above. For example, the output must look like\n$$\n[[N_{\\mathrm{eq}},N_{\\mathrm{st}},R_{\\max},L_{\\min}],\\ldots]\n$$\nprinted as a single line, with no spaces.\n- Since all quantities are nondimensional, no physical unit specification is required. Angles are not used. No percentages are used.",
            "solution": "The problem requires a numerical investigation of the equilibrium solutions to the autonomous ordinary differential equation $\\frac{dX}{dt} = f(X;\\mu) = \\mu + X - X^3$. The analysis involves finding all real equilibria $X^\\star$ for specified values of the control parameter $\\mu$, determining their stability, and quantifying the numerical accuracy of the solutions.\n\nAn equilibrium state, or invariant set, $X^\\star$ of the dynamical system is a point where the system's state does not change over time, i.e., $\\frac{dX}{dt} = 0$. This leads to the algebraic equilibrium condition:\n$$\nf(X^\\star;\\mu) = \\mu + X^\\star - (X^\\star)^3 = 0\n$$\nThis equation is a cubic polynomial in the state variable $X^\\star$. The task is to find all its real roots for given values of $\\mu$.\n\nThe problem explicitly forbids the use of a closed-form analytical solution for the cubic equation, mandating a purely numerical approach. A standard and robust method for this task is to employ a numerical polynomial root-finding algorithm. Such algorithms, often based on companion matrix eigenvalue computations, can find all roots (both real and complex) of a polynomial given its coefficients. The polynomial in question can be written in standard form as $-X^3 + 0X^2 + 1X^1 + \\mu X^0 = 0$. For a numerical library function that accepts polynomial coefficients in descending order of power, the input vector would be $[-1, 0, 1, \\mu]$.\n\nThe output of a general root-finder will include complex roots. Since the state variable $X$ represents a physical quantity, we are only interested in the real equilibria. A numerical root $z = a + ib$ is identified as real if its imaginary part $|b|$ is negligible, i.e., smaller than a small numerical tolerance, $|b| < \\epsilon_{\\mathrm{imag}}$. The real part $a$ is then taken as the value of the equilibrium $X^\\star$.\n\nFurthermore, at certain critical parameter values $\\mu$, the system undergoes a saddle-node bifurcation where two equilibria coalesce. Numerically, this corresponds to a multiple root of the polynomial. Due to floating-point arithmetic limitations, a numerical solver might return two distinct but very close roots instead of a single multiple root. To correctly identify the number of distinct equilibria, a post-processing step is necessary. After filtering for real roots, they are sorted, and any adjacent roots $X^\\star_i$ and $X^\\star_{i+1}$ whose absolute difference is less than a merging tolerance, $|X^\\star_{i+1} - X^\\star_i| < \\epsilon_{\\mathrm{merge}}$, are treated as a single, degenerate equilibrium.\n\nOnce the set of distinct real equilibria $\\{X^\\star\\}$ is determined, their linear stability is assessed. The stability is governed by the sign of the linearization coefficient $\\lambda$, which is the derivative of the right-hand side of the ODE evaluated at the equilibrium:\n$$\n\\lambda(X^\\star;\\mu) = \\left.\\frac{\\partial f}{\\partial X}\\right|_{X^\\star} = 1 - 3(X^\\star)^2\n$$\nAn equilibrium is linearly stable if $\\lambda < 0$ (perturbations decay) and unstable if $\\lambda > 0$ (perturbations grow). The case $\\lambda = 0$ corresponds to marginal stability and is the condition for a saddle-node bifurcation.\n\nThe algorithm proceeds by calculating four diagnostic metrics for each given $\\mu$:\n1.  $N_{\\mathrm{eq}}$: The total number of distinct real equilibria, obtained by counting the unique roots after the filtering and merging process.\n2.  $N_{\\mathrm{st}}$: The number of linearly stable equilibria, found by counting the equilibria for which $\\lambda(X^\\star;\\mu) < 0$.\n3.  $R_{\\max}$: The maximum absolute residual, defined as $R_{\\max} = \\max_{X^\\star} |f(X^\\star;\\mu)|$. This metric serves as a quality check on the numerical root-finding, as the residual should be close to machine precision for accurate roots.\n4.  $L_{\\min}$: The minimum absolute linearization magnitude, $L_{\\min} = \\min_{X^\\star} |\\lambda(X^\\star;\\mu)|$. This value is a sensitive indicator of proximity to a bifurcation point, as it approaches $0$ when the system is near a condition where $\\lambda(X^\\star;\\mu) = 0$.\n\nIn summary, the implementation will execute the following steps for each value of $\\mu$ provided in the test suite:\n1.  Define the polynomial coefficients as $[-1, 0, 1, \\mu]$.\n2.  Use a numerical solver, such as `numpy.roots`, to compute all roots of the cubic polynomial.\n3.  Isolate the real roots by checking if the absolute value of their imaginary part is below a small tolerance $\\epsilon_{\\mathrm{imag}}$.\n4.  Sort and merge the set of real roots using a tolerance $\\epsilon_{\\mathrm{merge}}$ to obtain the distinct equilibria $\\{X^\\star_i\\}$.\n5.  Count the number of distinct equilibria to determine $N_{\\mathrm{eq}}$.\n6.  For each $X^\\star_i$, calculate $\\lambda(X^\\star_i;\\mu)$ and count the number of stable equilibria to find $N_{\\mathrm{st}}$.\n7.  For each $X^\\star_i$, compute the residual $|f(X^\\star_i; \\mu)|$ and find the maximum value, $R_{\\max}$.\n8.  For each $X^\\star_i$, compute $|\\lambda(X^\\star_i; \\mu)|$ and find the minimum value, $L_{\\min}$.\n9.  Compile and format these four metrics into the specified list structure for the final output.",
            "answer": "[[3,2,0.00000000,0.50751111],[3,2,0.00000000,1.00000000],[3,2,0.00000000,0.82000000],[2,1,0.00000000,0.00000000],[2,1,0.00000000,0.00000000],[1,1,0.00000000,2.02985341]]"
        }
    ]
}