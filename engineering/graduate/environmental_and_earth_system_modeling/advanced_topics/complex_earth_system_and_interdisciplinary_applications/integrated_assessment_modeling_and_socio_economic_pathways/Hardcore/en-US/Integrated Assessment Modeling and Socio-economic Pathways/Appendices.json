{
    "hands_on_practices": [
        {
            "introduction": "A core function of Integrated Assessment Models (IAMs) is to represent how economies adapt to climate policies such as carbon pricing. This practice explores a fundamental mechanism: the substitution between inputs like energy and capital in response to changes in their relative costs. By applying the principles of cost-minimization to a sector with a Constant Elasticity of Substitution (CES) production function, you will directly quantify how a carbon price incentivizes a shift away from energy. This exercise  provides essential practice in deriving the microeconomic logic that governs the behavior of production sectors in nearly all IAMs.",
            "id": "3885672",
            "problem": "Consider a single production sector in an Integrated Assessment Model (IAM) that combines physical capital $K$ and final energy $E$ through a Constant Elasticity of Substitution (CES) technology. The gross output is given by the function $Y = A \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{1/\\rho}$, where $A > 0$ is a productivity index, $0 < \\alpha < 1$ is the share parameter, and $\\rho \\in \\mathbb{R}$ governs the curvature of the aggregator. The elasticity of substitution between $K$ and $E$ is $\\sigma = \\frac{1}{1 - \\rho}$. The sector minimizes the total user cost of inputs $C = p_{K} K + p_{E} E$ subject to producing a fixed output target $\\bar{Y} > 0$, where $p_{K} > 0$ is the rental rate of capital services and $p_{E} > 0$ is the user cost of energy services.\n\nA carbon price is introduced that increases the user cost of energy from its baseline value $p_{E}^{0}$ to a new value $p_{E}^{1} = p_{E}^{0} + \\tau$, where $\\tau > 0$ is the carbon price per unit of energy services. Starting from the constrained cost-minimization problem and first-order optimality conditions, derive the price-dependent input ratio implied by the CES technology and compute the multiplicative change in the energy-to-capital ratio, defined as $S \\equiv \\frac{(E/K)^{1}}{(E/K)^{0}}$, where superscripts denote the values before and after the carbon price is introduced.\n\nUse the following parameter and price values: $\\alpha = 0.4$, $\\rho = 0.5$, $p_{K} = 0.08$, $p_{E}^{0} = 0.05$, and $\\tau = 0.02$. Express the final answer for $S$ as a dimensionless decimal, and round your answer to four significant figures.",
            "solution": "The problem asks for the multiplicative change in the energy-to-capital ratio, $S \\equiv \\frac{(E/K)^{1}}{(E/K)^{0}}$, after the introduction of a carbon price. This requires solving a constrained cost-minimization problem for a profit-maximizing firm.\n\nThe firm's objective is to minimize the total input cost $C = p_{K} K + p_{E} E$ subject to producing a fixed level of output $\\bar{Y}$. The production technology is a Constant Elasticity of Substitution (CES) function: $Y = A \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{1/\\rho}$.\n\nWe can solve this constrained optimization problem using the method of Lagrange multipliers. The Lagrangian function $\\mathcal{L}$ is:\n$$\n\\mathcal{L}(K, E, \\lambda) = p_{K} K + p_{E} E + \\lambda \\left( \\bar{Y} - A \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{1/\\rho} \\right)\n$$\nwhere $\\lambda$ is the Lagrange multiplier, representing the marginal cost of production.\n\nTo find the optimal input levels of capital $K$ and energy $E$, we take the partial derivatives of $\\mathcal{L}$ with respect to $K$, $E$, and $\\lambda$ and set them to zero. These are the first-order conditions (FOCs) for a minimum.\n\nThe partial derivative with respect to $K$ is:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial K} = p_{K} - \\lambda \\frac{\\partial Y}{\\partial K} = 0 \\implies p_{K} = \\lambda \\frac{\\partial Y}{\\partial K}\n$$\nThe partial derivative with respect to $E$ is:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial E} = p_{E} - \\lambda \\frac{\\partial Y}{\\partial E} = 0 \\implies p_{E} = \\lambda \\frac{\\partial Y}{\\partial E}\n$$\nThe marginal product of capital, $\\frac{\\partial Y}{\\partial K}$, is found using the chain rule:\n$$\n\\frac{\\partial Y}{\\partial K} = A \\left(\\frac{1}{\\rho}\\right) \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{(1/\\rho) - 1} (\\alpha \\rho K^{\\rho-1}) = A \\alpha K^{\\rho-1} \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{(1-\\rho)/\\rho}\n$$\nSimilarly, the marginal product of energy, $\\frac{\\partial Y}{\\partial E}$, is:\n$$\n\\frac{\\partial Y}{\\partial E} = A \\left(\\frac{1}{\\rho}\\right) \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{(1/\\rho) - 1} ((1 - \\alpha) \\rho E^{\\rho-1}) = A (1 - \\alpha) E^{\\rho-1} \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{(1-\\rho)/\\rho}\n$$\nThe core of the optimality condition is found by dividing the FOC for $E$ by the FOC for $K$:\n$$\n\\frac{p_{E}}{p_{K}} = \\frac{\\lambda (\\partial Y / \\partial E)}{\\lambda (\\partial Y / \\partial K)} = \\frac{\\partial Y / \\partial E}{\\partial Y / \\partial K}\n$$\nThis states that at the cost-minimizing input mix, the ratio of input prices must equal the ratio of their marginal products, which is the definition of the Marginal Rate of Technical Substitution (MRTS).\n\nSubstituting the expressions for the marginal products:\n$$\n\\frac{p_{E}}{p_{K}} = \\frac{A (1 - \\alpha) E^{\\rho-1} \\left[ \\dots \\right]^{(1-\\rho)/\\rho}}{A \\alpha K^{\\rho-1} \\left[ \\dots \\right]^{(1-\\rho)/\\rho}} = \\frac{1 - \\alpha}{\\alpha} \\frac{E^{\\rho-1}}{K^{\\rho-1}} = \\frac{1 - \\alpha}{\\alpha} \\left(\\frac{E}{K}\\right)^{\\rho-1}\n$$\nOur goal is to find the energy-to-capital ratio, $E/K$. We can rearrange the above equation to solve for it:\n$$\n\\left(\\frac{E}{K}\\right)^{\\rho-1} = \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}}{p_{K}}\n$$\n$$\n\\frac{E}{K} = \\left( \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}}{p_{K}} \\right)^{1/(\\rho-1)}\n$$\nThis equation gives the optimal input ratio as a function of the technology parameters ($\\alpha$, $\\rho$) and the input price ratio ($p_E/p_K$). Note that the ratio is independent of the output level $\\bar{Y}$ and the productivity index $A$, which is a characteristic property of the CES function.\n\nWe are asked to find the multiplicative change in this ratio when the price of energy changes from $p_{E}^{0}$ to $p_{E}^{1}$. Let $(E/K)^{0}$ be the ratio before the carbon price and $(E/K)^{1}$ be the ratio after.\n\nBefore the price change (superscript $0$):\n$$\n\\left(\\frac{E}{K}\\right)^{0} = \\left( \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{0}}{p_{K}} \\right)^{1/(\\rho-1)}\n$$\nAfter the price change (superscript $1$), where $p_{E}^{1} = p_{E}^{0} + \\tau$:\n$$\n\\left(\\frac{E}{K}\\right)^{1} = \\left( \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{1}}{p_{K}} \\right)^{1/(\\rho-1)}\n$$\nThe multiplicative change is defined as $S = \\frac{(E/K)^{1}}{(E/K)^{0}}$.\n$$\nS = \\frac{\\left( \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{1}}{p_{K}} \\right)^{1/(\\rho-1)}}{\\left( \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{0}}{p_{K}} \\right)^{1/(\\rho-1)}} = \\left( \\frac{\\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{1}}{p_{K}}}{\\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{0}}{p_{K}}} \\right)^{1/(\\rho-1)}\n$$\nThe constant terms involving $\\alpha$ and $p_K$ cancel out, yielding a simplified expression:\n$$\nS = \\left( \\frac{p_{E}^{1}}{p_{E}^{0}} \\right)^{1/(\\rho-1)}\n$$\nThe problem provides the following values: $\\rho = 0.5$, $p_{E}^{0} = 0.05$, and $\\tau = 0.02$. First, we calculate the new energy price $p_{E}^{1}$:\n$$\np_{E}^{1} = p_{E}^{0} + \\tau = 0.05 + 0.02 = 0.07\n$$\nNext, we calculate the exponent:\n$$\n\\frac{1}{\\rho - 1} = \\frac{1}{0.5 - 1} = \\frac{1}{-0.5} = -2\n$$\nNote that the elasticity of substitution is $\\sigma = \\frac{1}{1-\\rho} = \\frac{1}{1-0.5} = 2$, so the exponent is $-\\sigma$, as expected from economic theory.\n\nNow, we can substitute these values into the expression for $S$:\n$$\nS = \\left( \\frac{0.07}{0.05} \\right)^{-2} = \\left( \\frac{7}{5} \\right)^{-2} = (1.4)^{-2}\n$$\nCalculating the numerical value:\n$$\nS = \\frac{1}{(1.4)^{2}} = \\frac{1}{1.96}\n$$\nThis gives:\n$$\nS \\approx 0.51020408...\n$$\nThe problem asks for the answer to be rounded to four significant figures.\n$$\nS \\approx 0.5102\n$$\nThis result indicates that the carbon price, by increasing the relative cost of energy, induces the firm to substitute away from energy and towards capital, causing the energy-to-capital ratio to decrease by approximately $49\\%$.",
            "answer": "$$\n\\boxed{0.5102}\n$$"
        },
        {
            "introduction": "Economic activities emit a variety of greenhouse gases (GHGs), and IAMs must convert them into a common \"$\\mathrm{CO}_2$-equivalent\" currency to assess their aggregate climate impact. This practice  delves into the critical distinction between two widely used metrics: the Global Warming Potential ($\\mathrm{GWP}$), based on time-integrated radiative forcing, and the Global Temperature change Potential ($\\mathrm{GTP}$), based on temperature change at a specific future point in time. Because these metrics are based on different physical principles, their application can lead to significantly different conclusions about the warming effects of a given emissions scenario. This hands-on calculation will clarify why the choice of metric is a crucial and debated aspect of climate policy analysis.",
            "id": "3885721",
            "problem": "An integrated assessment modeler is evaluating a mitigation policy shock in year $2050$ under a Shared Socioeconomic Pathway scenario. The shock is a one-year pulse of emissions comprising $2000$ megatonnes of carbon dioxide $\\left(\\mathrm{CO}_{2}\\right)$, $50$ megatonnes of methane $\\left(\\mathrm{CH}_{4}\\right)$, and $5$ megatonnes of nitrous oxide $\\left(\\mathrm{N}_{2}\\mathrm{O}\\right)$. To aggregate non-$\\mathrm{CO}_{2}$ gases for policy comparison, the modeler considers two common metrics defined over a $100$-year horizon: Global Warming Potential over 100 years ($\\mathrm{GWP}_{100}$) and Global Temperature change Potential at 100 years ($\\mathrm{GTP}_{100}$). In the simple climate model used by the modeler, the global-mean surface temperature response to a small emission pulse is linear and time-invariant, and temperature contributions from different species superpose.\n\nUse the following widely reported metric values for the $100$-year horizon: $\\mathrm{GWP}_{100}(\\mathrm{CH}_{4}) = 28$, $\\mathrm{GWP}_{100}(\\mathrm{N}_{2}\\mathrm{O}) = 265$, $\\mathrm{GTP}_{100}(\\mathrm{CH}_{4}) = 4$, $\\mathrm{GTP}_{100}(\\mathrm{N}_{2}\\mathrm{O}) = 234$. By convention, $\\mathrm{GWP}_{100}(\\mathrm{CO}_{2}) = 1$ and $\\mathrm{GTP}_{100}(\\mathrm{CO}_{2}) = 1$.\n\nStarting from the definitions that $\\mathrm{GWP}_{100}$ is the ratio of time-integrated radiative forcing over $100$ years from a unit mass pulse of a species relative to $\\mathrm{CO}_{2}$, and that $\\mathrm{GTP}_{100}$ is the ratio of the global-mean surface temperature change at year $100$ from a unit mass pulse of a species relative to $\\mathrm{CO}_{2}$, and assuming linearity and superposition in the climate response, derive an expression for the ratio of the predicted global-mean surface temperature change at year $100$ when using $\\mathrm{GWP}_{100}$-based $\\mathrm{CO}_{2}$-equivalent aggregation to that when using $\\mathrm{GTP}_{100}$-based aggregation for the given emission pulse. Then evaluate this ratio numerically using the provided data.\n\nRound your final result to four significant figures. Express the final answer as a pure number (dimensionless).",
            "solution": "The fundamental base for this calculation consists of the following accepted definitions and assumptions: (i) Global Warming Potential over a horizon $H$ years, denoted $\\mathrm{GWP}_{H}$, is the ratio of the time-integrated radiative forcing from a unit mass pulse of a species to that from a unit mass pulse of $\\mathrm{CO}_{2}$ over the interval from time $0$ to $H$; (ii) Global Temperature change Potential at time $H$, denoted $\\mathrm{GTP}_{H}$, is the ratio of the global-mean surface temperature change at time $H$ from a unit mass pulse of a species to that from a unit mass pulse of $\\mathrm{CO}_{2}$; (iii) the climate system is approximated as linear and time-invariant for small perturbations, so temperature responses scale linearly with emission mass and add across species.\n\nLet $H = 100$ years be the horizon of interest. Let the pulse emissions be $E_{\\mathrm{CO}_{2}}$, $E_{\\mathrm{CH}_{4}}$, and $E_{\\mathrm{N}_{2}\\mathrm{O}}$ in consistent mass units. Define $\\kappa_{\\mathrm{CO}_{2}}(H)$ as the temperature change at time $H$ per unit mass of $\\mathrm{CO}_{2}$ pulse, under the simple climate model. By linearity, the temperature change at time $H$ for a unit pulse of species $i$ is $\\kappa_{\\mathrm{CO}_{2}}(H) \\times \\mathrm{GTP}_{H}(i)$, because $\\mathrm{GTP}_{H}(i)$ is defined as the ratio relative to $\\mathrm{CO}_{2}$.\n\nConsider two aggregation methods for predicting the temperature impact at time $H$:\n\n1. $\\mathrm{GTP}_{H}$-based aggregation (physically consistent with the time-$H$ temperature response): The predicted temperature change at time $H$ from the emission vector $\\left(E_{\\mathrm{CO}_{2}}, E_{\\mathrm{CH}_{4}}, E_{\\mathrm{N}_{2}\\mathrm{O}}\\right)$ is\n$$\n\\Delta T_{\\mathrm{GTP}}(H) \\;=\\; \\kappa_{\\mathrm{CO}_{2}}(H)\\,\\Big(E_{\\mathrm{CO}_{2}} + \\mathrm{GTP}_{H}(\\mathrm{CH}_{4})\\,E_{\\mathrm{CH}_{4}} + \\mathrm{GTP}_{H}(\\mathrm{N}_{2}\\mathrm{O})\\,E_{\\mathrm{N}_{2}\\mathrm{O}}\\Big).\n$$\n\n2. $\\mathrm{GWP}_{H}$-based $\\mathrm{CO}_{2}$-equivalent aggregation, followed by the $\\mathrm{CO}_{2}$ temperature response at time $H$: First compute $\\mathrm{CO}_{2}$-equivalent mass\n$$\nE_{\\mathrm{CO}_{2}\\text{-}\\mathrm{eq}}^{\\mathrm{GWP}} \\;=\\; E_{\\mathrm{CO}_{2}} + \\mathrm{GWP}_{H}(\\mathrm{CH}_{4})\\,E_{\\mathrm{CH}_{4}} + \\mathrm{GWP}_{H}(\\mathrm{N}_{2}\\mathrm{O})\\,E_{\\mathrm{N}_{2}\\mathrm{O}},\n$$\nthen map this to temperature at time $H$ via the $\\mathrm{CO}_{2}$ impulse temperature response:\n$$\n\\Delta T_{\\mathrm{GWP}}(H) \\;=\\; \\kappa_{\\mathrm{CO}_{2}}(H)\\,E_{\\mathrm{CO}_{2}\\text{-}\\mathrm{eq}}^{\\mathrm{GWP}} \\;=\\; \\kappa_{\\mathrm{CO}_{2}}(H)\\,\\Big(E_{\\mathrm{CO}_{2}} + \\mathrm{GWP}_{H}(\\mathrm{CH}_{4})\\,E_{\\mathrm{CH}_{4}} + \\mathrm{GWP}_{H}(\\mathrm{N}_{2}\\mathrm{O})\\,E_{\\mathrm{N}_{2}\\mathrm{O}}\\Big).\n$$\n\nThe ratio of the two predicted temperature changes at time $H$ is therefore\n$$\nR \\;\\equiv\\; \\frac{\\Delta T_{\\mathrm{GWP}}(H)}{\\Delta T_{\\mathrm{GTP}}(H)} \\;=\\; \\frac{E_{\\mathrm{CO}_{2}} + \\mathrm{GWP}_{H}(\\mathrm{CH}_{4})\\,E_{\\mathrm{CH}_{4}} + \\mathrm{GWP}_{H}(\\mathrm{N}_{2}\\mathrm{O})\\,E_{\\mathrm{N}_{2}\\mathrm{O}}}{E_{\\mathrm{CO}_{2}} + \\mathrm{GTP}_{H}(\\mathrm{CH}_{4})\\,E_{\\mathrm{CH}_{4}} + \\mathrm{GTP}_{H}(\\mathrm{N}_{2}\\mathrm{O})\\,E_{\\mathrm{N}_{2}\\mathrm{O}}}.\n$$\nThe factor $\\kappa_{\\mathrm{CO}_{2}}(H)$ cancels, so $R$ is independent of the absolute temperature response magnitude of the simple climate model. This derives the requested expression.\n\nNow evaluate $R$ numerically for $H=100$ with the provided emissions and metric values. Use consistent mass units of megatonnes:\n$$\nE_{\\mathrm{CO}_{2}} = 2000,\\quad E_{\\mathrm{CH}_{4}} = 50,\\quad E_{\\mathrm{N}_{2}\\mathrm{O}} = 5.\n$$\nInsert $\\mathrm{GWP}_{100}(\\mathrm{CH}_{4}) = 28$, $\\mathrm{GWP}_{100}(\\mathrm{N}_{2}\\mathrm{O}) = 265$, $\\mathrm{GTP}_{100}(\\mathrm{CH}_{4}) = 4$, and $\\mathrm{GTP}_{100}(\\mathrm{N}_{2}\\mathrm{O}) = 234$:\n$$\n\\text{Numerator} \\;=\\; 2000 \\;+\\; 28 \\times 50 \\;+\\; 265 \\times 5 \\;=\\; 2000 \\;+\\; 1400 \\;+\\; 1325 \\;=\\; 4725,\n$$\n$$\n\\text{Denominator} \\;=\\; 2000 \\;+\\; 4 \\times 50 \\;+\\; 234 \\times 5 \\;=\\; 2000 \\;+\\; 200 \\;+\\; 1170 \\;=\\; 3370.\n$$\nThus,\n$$\nR \\;=\\; \\frac{4725}{3370} \\;\\approx\\; 1.402077\\ldots\n$$\nRounded to four significant figures,\n$$\nR \\;\\approx\\; 1.402.\n$$\nThis dimensionless ratio exceeds $1$, indicating that, for this emissions mix, using $\\mathrm{GWP}_{100}$-based $\\mathrm{CO}_{2}$-equivalents overpredicts the year-$100$ temperature change relative to the $\\mathrm{GTP}_{100}$-consistent aggregation in the specified linear climate model.",
            "answer": "$$\\boxed{1.402}$$"
        },
        {
            "introduction": "Making sound climate policy requires navigating deep uncertainty about the Earth system, especially the precise sensitivity of the climate to greenhouse gas emissions. This practice  moves beyond simple probabilistic analysis to explore decision-making under ambiguity, a situation where even the probabilities themselves are uncertain. You will contrast the standard expected utility approach with a distributionally robust optimization (DRO) framework, which seeks policies that perform well across a whole set of plausible probability distributions. This advanced computational exercise demonstrates how explicitly accounting for ambiguity can justify more precautionary climate action and is a key frontier in modern IAM development.",
            "id": "3885707",
            "problem": "Consider a one-period, normalized Integrated Assessment Model (IAM) with ambiguous climate sensitivity, designed to capture the trade-off between emissions mitigation and climate damages under uncertainty about climate response. Let the decision variable be the mitigation rate $m \\in [0,1]$, interpreted as the fraction of emissions abated. Output is normalized to $1$ and all quantities are non-dimensional shares, so no physical units are involved. Abatement incurs a convex resource cost and climate damages depend on realized climate sensitivity.\n\nFundamental base and core definitions:\n- Consumption is given by\n$$\nC(m,\\lambda) \\equiv 1 - \\kappa m^2 - \\phi \\left(\\lambda F_0 (1 - m)\\right)^2,\n$$\nwhere $\\kappa \\in (0,1)$ is the abatement cost coefficient, $\\phi > 0$ is the climate damage coefficient, $\\lambda > 0$ is climate sensitivity per unit radiative forcing, and $F_0 > 0$ is a normalized reference forcing. Assume parameters are such that $C(m,\\lambda) > 0$ for all $m \\in [0,1]$ and all $\\lambda$ considered.\n- Preferences are represented by the logarithmic utility function\n$$\nu(C) \\equiv \\ln C,\n$$\nwhich is a special case of constant relative risk aversion with risk aversion coefficient equal to $1$.\n- Climate sensitivity $\\lambda$ takes values in a two-point support $\\{\\lambda_L,\\lambda_H\\}$ with $\\lambda_L < \\lambda_H$. A nominal prior assigns probability $p_0 \\in [0,1]$ to $\\lambda_H$ and $1-p_0$ to $\\lambda_L$.\n- Ambiguity about the true distribution is represented by the total variation ball (an $\\ell_1$ ball on the probability simplex) of radius $\\delta \\in [0,2]$ around the nominal prior. That is, the ambiguity set is\n$$\n\\mathcal{P}(\\delta) \\equiv \\left\\{ p \\in \\mathbb{R}^2_{\\ge 0} : p_1 + p_2 = 1, \\ \\|p - p_0\\|_1 \\le \\delta \\right\\},\n$$\nwhere $p_0 = (1-p_0, p_0)$ is the nominal prior over $(\\lambda_L,\\lambda_H)$ and $\\|\\cdot\\|_1$ is the $\\ell_1$ norm.\n\nTwo decision criteria are considered:\n1. Expected utility (EU) with the nominal prior:\n$$\n\\max_{m \\in [0,1]} \\ \\mathbb{E}_{p_0}[u(C(m,\\lambda))].\n$$\n2. Distributionally robust optimization (DRO) against all priors in $\\mathcal{P}(\\delta)$:\n$$\n\\max_{m \\in [0,1]} \\ \\min_{p \\in \\mathcal{P}(\\delta)} \\ \\mathbb{E}_{p}[u(C(m,\\lambda))].\n$$\n\nTasks:\n- For given parameter values, compute $m_{\\mathrm{EU}}^\\star$ that solves the expected utility problem and $m_{\\mathrm{DRO}}^\\star$ that solves the distributionally robust problem.\n- Compare these by reporting the difference $m_{\\mathrm{DRO}}^\\star - m_{\\mathrm{EU}}^\\star$.\n\nAlgorithmic and numerical requirements:\n- Solve both optimization problems numerically over $m \\in [0,1]$ using a uniform grid search with resolution $\\Delta m = 10^{-4}$, i.e., evaluate at $m = 0, 10^{-4}, 2 \\cdot 10^{-4}, \\dots, 1$ and take the maximizer(s).\n- When evaluating the DRO inner problem for a fixed $m$, treat it as a finite-dimensional minimization over distributions on $\\{\\lambda_L,\\lambda_H\\}$ subject to the total variation constraint; no shortcut formulas are provided in this problem statement.\n\nTest suite:\nUse the following four parameter sets, each specified as a tuple $(\\lambda_L,\\lambda_H,p_0,\\delta,\\kappa,\\phi,F_0)$:\n- Case $1$ (boundary where ambiguity radius is zero): $(1.5, 3.0, 0.4, 0.0, 0.1, 0.04, 1.0)$.\n- Case $2$ (moderate ambiguity): $(1.5, 3.0, 0.4, 0.4, 0.1, 0.04, 1.0)$.\n- Case $3$ (high abatement cost and large ambiguity): $(1.5, 3.0, 0.3, 1.6, 0.3, 0.04, 1.0)$.\n- Case $4$ (narrower climate sensitivity spread and lower cost): $(1.5, 2.0, 0.5, 0.5, 0.05, 0.04, 1.0)$.\n\nProgram input and output:\n- There is no external input; the program must hard-code the test suite above.\n- For each test case, compute and return three floats: $m_{\\mathrm{EU}}^\\star$, $m_{\\mathrm{DRO}}^\\star$, and $m_{\\mathrm{DRO}}^\\star - m_{\\mathrm{EU}}^\\star$, each rounded to $6$ decimal places.\n- Your program should produce a single line of output containing all results for the four cases as a comma-separated list enclosed in square brackets, in the order\n$$\n[m_{\\mathrm{EU},1}^\\star, m_{\\mathrm{DRO},1}^\\star, \\Delta m_1, m_{\\mathrm{EU},2}^\\star, m_{\\mathrm{DRO},2}^\\star, \\Delta m_2, m_{\\mathrm{EU},3}^\\star, m_{\\mathrm{DRO},3}^\\star, \\Delta m_3, m_{\\mathrm{EU},4}^\\star, m_{\\mathrm{DRO},4}^\\star, \\Delta m_4],\n$$\nwhere $\\Delta m_i \\equiv m_{\\mathrm{DRO},i}^\\star - m_{\\mathrm{EU},i}^\\star$ for case $i$.",
            "solution": "The problem is scientifically grounded, well-posed, and all necessary parameters and conditions are provided for a unique numerical solution. The model is a stylized but standard representation of economic trade-offs under climate uncertainty, and the decision criteria (Expected Utility and Distributionally Robust Optimization) are well-established in decision theory. The problem is therefore deemed **valid**.\n\nThe solution proceeds by first defining the core components of the model, then analyzing and formulating the numerical solution for the two optimization problems (Expected Utility and Distributionally Robust Optimization), and finally outlining the algorithm for computation and comparison.\n\n### 1. Model Formulation\n\nThe core of the model is the consumption function, which depends on the mitigation rate $m \\in [0,1]$ and the climate sensitivity $\\lambda \\in \\{\\lambda_L, \\lambda_H\\}$.\n$$\nC(m,\\lambda) = 1 - \\kappa m^2 - \\phi \\left(\\lambda F_0 (1 - m)\\right)^2\n$$\nHere, $1$ represents the normalized total output of the economy. From this, two costs are subtracted:\n- The cost of abatement, $\\kappa m^2$, which is convex in the mitigation rate $m$.\n- The cost of climate damages, $\\phi (\\lambda F_0 (1-m))^2$, which depends on the remaining emissions $(1-m)$, the reference forcing $F_0$, and the uncertain climate sensitivity $\\lambda$.\n\nSocial welfare is measured by the logarithmic utility of consumption, $u(C) = \\ln C$.\n\n### 2. Expected Utility (EU) Maximization\n\nThe first decision criterion is to maximize the expected utility under a nominal prior probability distribution over the states of climate sensitivity. Let $p_0$ be the probability assigned to the high-sensitivity state, $\\lambda_H$, and $1-p_0$ be the probability of the low-sensitivity state, $\\lambda_L$. The objective function to be maximized is:\n$$\nV_{\\mathrm{EU}}(m) = \\mathbb{E}_{p_0}[u(C(m,\\lambda))] = (1-p_0) u(C(m, \\lambda_L)) + p_0 u(C(m, \\lambda_H))\n$$\nSubstituting the definitions for $u(\\cdot)$ and $C(\\cdot,\\cdot)$, we get:\n$$\nV_{\\mathrm{EU}}(m) = (1-p_0) \\ln\\left(1 - \\kappa m^2 - \\phi (\\lambda_L F_0 (1-m))^2\\right) + p_0 \\ln\\left(1 - \\kappa m^2 - \\phi (\\lambda_H F_0 (1-m))^2\\right)\n$$\nThe optimal mitigation rate under this criterion, $m_{\\mathrm{EU}}^\\star$, is found by solving the optimization problem:\n$$\nm_{\\mathrm{EU}}^\\star = \\arg\\max_{m \\in [0,1]} V_{\\mathrm{EU}}(m)\n$$\nNumerically, this maximization is performed via a grid search over $m \\in \\{0, 10^{-4}, 2 \\cdot 10^{-4}, \\dots, 1\\}$.\n\n### 3. Distributionally Robust Optimization (DRO)\n\nThe second criterion addresses ambiguity about the true probabilities. The decision-maker maximizes the utility from the worst-case scenario, where the worst case is defined by the probability distribution within an ambiguity set $\\mathcal{P}(\\delta)$ that minimizes expected utility. The problem is:\n$$\n\\max_{m \\in [0,1]} \\min_{p \\in \\mathcal{P}(\\delta)} \\mathbb{E}_{p}[u(C(m,\\lambda))]\n$$\nLet's first solve the inner minimization problem for a fixed mitigation rate $m$. The probability distribution is a vector $p = (p_L, p_H)$ for states $(\\lambda_L, \\lambda_H)$. Let $q = p_H$ be the probability of $\\lambda_H$, so $p_L = 1-q$. The nominal prior is $p_0^\\text{vec} = (1-p_0, p_0)$. The ambiguity set $\\mathcal{P}(\\delta)$ is defined by the constraint $\\|p - p_0^\\text{vec}\\|_1 \\le \\delta$. This constraint can be rewritten in terms of $q$:\n$$\n\\|(1-q, q) - (1-p_0, p_0)\\|_1 = |(1-q)-(1-p_0)| + |q-p_0| = |p_0-q| + |q-p_0| = 2|q-p_0| \\le \\delta\n$$\nThis simplifies to $|q-p_0| \\le \\delta/2$, or $p_0 - \\delta/2 \\le q \\le p_0 + \\delta/2$. Since $q$ must be a valid probability, it is confined to $[0,1]$. Thus, the set of possible probabilities for $\\lambda_H$ is $q \\in [\\max(0, p_0 - \\delta/2), \\min(1, p_0 + \\delta/2)]$.\n\nThe inner minimization problem is:\n$$\nV_{\\mathrm{DRO}}(m) = \\min_{q} \\left\\{ (1-q) u(C(m, \\lambda_L)) + q u(C(m, \\lambda_H)) \\right\\}\n$$\nsubject to $q \\in [\\max(0, p_0 - \\delta/2), \\min(1, p_0 + \\delta/2)]$.\n\nLet $u_L(m) = u(C(m, \\lambda_L))$ and $u_H(m) = u(C(m, \\lambda_H))$. The objective can be written as a linear function of $q$:\n$$\nu_L(m) + q \\left( u_H(m) - u_L(m) \\right)\n$$\nSince $\\lambda_H > \\lambda_L$, the climate damages are higher for $\\lambda_H$ (for any $m<1$). This implies $C(m, \\lambda_H) < C(m, \\lambda_L)$. As the utility function $u(C)=\\ln C$ is strictly increasing, it follows that $u_H(m) < u_L(m)$. Therefore, the coefficient of $q$, which is $(u_H(m) - u_L(m))$, is negative.\n\nTo minimize a linear function with a negative slope, one must choose the largest possible value for the variable. The worst-case probability for the high-sensitivity state, $q^\\star$, is therefore the upper bound of the feasible interval:\n$$\nq^\\star = \\min(1, p_0 + \\delta/2)\n$$\nThe value of the robust objective function is:\n$$\nV_{\\mathrm{DRO}}(m) = (1-q^\\star) u(C(m, \\lambda_L)) + q^\\star u(C(m, \\lambda_H))\n$$\nThe optimal mitigation rate under DRO, $m_{\\mathrm{DRO}}^\\star$, is found by maximizing this value over the grid for $m$:\n$$\nm_{\\mathrm{DRO}}^\\star = \\arg\\max_{m \\in [0,1]} V_{\\mathrm{DRO}}(m)\n$$\nThis maximization is also performed via the specified grid search. The increased weight $q^\\star \\ge p_0$ on the high-damage state $\\lambda_H$ typically leads to a more precautionary policy, implying $m_{\\mathrm{DRO}}^\\star \\ge m_{\\mathrm{EU}}^\\star$.\n\n### 4. Algorithmic Implementation\n\nFor each parameter set $(\\lambda_L, \\lambda_H, p_0, \\delta, \\kappa, \\phi, F_0)$:\n1.  Define a grid for the mitigation rate: $m \\in \\{0, 10^{-4}, \\dots, 1\\}$. This grid contains $10001$ points.\n2.  For each value of $m$ on the grid, calculate consumption for both low and high climate sensitivities:\n    $$ C_L(m) = 1 - \\kappa m^2 - \\phi (\\lambda_L F_0 (1-m))^2 $$\n    $$ C_H(m) = 1 - \\kappa m^2 - \\phi (\\lambda_H F_0 (1-m))^2 $$\n3.  Compute the corresponding utility vectors $u_L(m) = \\ln(C_L(m))$ and $u_H(m) = \\ln(C_H(m))$.\n4.  **EU Solution**: Calculate the expected utility vector $V_{\\mathrm{EU}}(m) = (1-p_0)u_L(m) + p_0 u_H(m)$. Find the value of $m$ that maximizes this vector. This is $m_{\\mathrm{EU}}^\\star$.\n5.  **DRO Solution**: First, determine the worst-case probability $q^\\star = \\min(1, p_0 + \\delta/2)$. Then, calculate the robust objective vector $V_{\\mathrm{DRO}}(m) = (1-q^\\star)u_L(m) + q^\\star u_H(m)$. Find the value of $m$ that maximizes this vector. This is $m_{\\mathrm{DRO}}^\\star$.\n6.  Calculate the difference $\\Delta m = m_{\\mathrm{DRO}}^\\star - m_{\\mathrm{EU}}^\\star$.\n7.  Store the three values $(m_{\\mathrm{EU}}^\\star, m_{\\mathrm{DRO}}^\\star, \\Delta m)$, rounded to $6$ decimal places, and repeat for all test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for optimal mitigation rates under Expected Utility and\n    Distributionally Robust Optimization criteria for a set of test cases.\n    \"\"\"\n    # Test cases are tuples of (lambda_L, lambda_H, p_0, delta, kappa, phi, F_0)\n    test_cases = [\n        (1.5, 3.0, 0.4, 0.0, 0.1, 0.04, 1.0),\n        (1.5, 3.0, 0.4, 0.4, 0.1, 0.04, 1.0),\n        (1.5, 3.0, 0.3, 1.6, 0.3, 0.04, 1.0),\n        (1.5, 2.0, 0.5, 0.5, 0.05, 0.04, 1.0),\n    ]\n\n    all_results = []\n    \n    # Define the grid for the mitigation rate m\n    # Resolution delta_m = 1e-4, so m ranges from 0 to 1\n    # Number of points is 1/1e-4 + 1 = 10001\n    num_points = int(1 / 1e-4) + 1\n    m_grid = np.linspace(0.0, 1.0, num_points)\n\n    for case in test_cases:\n        lambda_L, lambda_H, p0, delta, kappa, phi, F0 = case\n\n        # Vectorized calculation of consumption for all m in the grid\n        abatement_cost = kappa * m_grid**2\n        emissions_factor = (F0 * (1 - m_grid))**2\n        \n        # Consumption for low and high climate sensitivity\n        C_L = 1.0 - abatement_cost - phi * (lambda_L**2 * emissions_factor)\n        C_H = 1.0 - abatement_cost - phi * (lambda_H**2 * emissions_factor)\n\n        # Check for non-positive consumption which would make log utility undefined.\n        # The problem statement guarantees C > 0.\n        if np.any(C_L <= 0) or np.any(C_H <= 0):\n            # This block should not be reached based on problem constraints\n            raise ValueError(f\"Consumption is not positive for case: {case}\")\n            \n        # Utility for low and high sensitivity states\n        u_L = np.log(C_L)\n        u_H = np.log(C_H)\n\n        # 1. Expected Utility (EU) Calculation\n        # The objective function is V_EU(m) = (1-p0)*u_L(m) + p0*u_H(m)\n        v_eu = (1.0 - p0) * u_L + p0 * u_H\n        # Find the mitigation rate m that maximizes expected utility\n        m_eu_star = m_grid[np.argmax(v_eu)]\n\n        # 2. Distributionally Robust Optimization (DRO) Calculation\n        # First, find the worst-case probability for the high-damage state lambda_H.\n        # This is derived by maximizing the probability q_H subject to the\n        # total variation constraint ||p - p_nom||_1 <= delta, which is equivalent\n        # to |q_H - p0| <= delta/2.\n        # Since u_H < u_L (higher damages), we want to maximize q_H.\n        q_star = min(1.0, p0 + delta / 2.0)\n        \n        # The robust objective function is V_DRO(m) = (1-q*)*u_L(m) + q* * u_H(m)\n        v_dro = (1.0 - q_star) * u_L + q_star * u_H\n        # Find the mitigation rate m that maximizes the robust objective\n        m_dro_star = m_grid[np.argmax(v_dro)]\n\n        # 3. Calculate the difference and round results\n        delta_m = m_dro_star - m_eu_star\n        \n        m_eu_star_rounded = round(m_eu_star, 6)\n        m_dro_star_rounded = round(m_dro_star, 6)\n        delta_m_rounded = round(delta_m, 6)\n        \n        all_results.extend([m_eu_star_rounded, m_dro_star_rounded, delta_m_rounded])\n\n    # Format the final output string exactly as specified\n    # The map converts each number to a string formatted to 6 decimal places\n    output_str = f\"[{','.join(f'{x:.6f}' for x in all_results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}