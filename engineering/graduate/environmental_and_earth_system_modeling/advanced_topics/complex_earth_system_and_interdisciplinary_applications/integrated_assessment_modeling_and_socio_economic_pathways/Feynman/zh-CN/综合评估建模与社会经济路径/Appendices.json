{
    "hands_on_practices": [
        {
            "introduction": "综合评估模型 (IAM) 的基础在于捕捉经济系统对气候政策的响应。其核心机制是当投入要素的相对价格发生变化时，企业能够在不同要素（如资本和能源）之间进行替代。本练习  提供了一个实践机会，通过使用现代经济模型中的重要工具——恒定替代弹性 (CES) 生产函数，来量化碳定价如何激励生产者从能源转向资本，从而深入理解这一基本原理。",
            "id": "3885672",
            "problem": "考虑一个综合评估模型 (IAM) 中的单一生产部门，该部门通过恒定替代弹性 (CES) 技术将物质资本 $K$ 和最终能源 $E$ 相结合。总产出由函数 $Y = A \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{1/\\rho}$ 给出，其中 $A > 0$ 是生产率指数，$0  \\alpha  1$ 是份额参数，$\\rho \\in \\mathbb{R}$ 控制聚合器的曲率。$K$ 和 $E$ 之间的替代弹性为 $\\sigma = \\frac{1}{1 - \\rho}$。该部门在生产固定产出目标 $\\bar{Y}  0$ 的约束下，最小化总投入的使用者成本 $C = p_{K} K + p_{E} E$，其中 $p_{K}  0$ 是资本服务的租赁率，$p_{E}  0$ 是能源服务的使用者成本。\n\n引入碳价格，使能源的使用者成本从基准值 $p_{E}^{0}$ 增加到新值 $p_{E}^{1} = p_{E}^{0} + \\tau$，其中 $\\tau  0$ 是每单位能源服务的碳价格。从约束成本最小化问题和一阶最优性条件出发，推导由CES技术所蕴含的、依赖于价格的投入比率，并计算能源-资本比率的乘数变化，该变化定义为 $S \\equiv \\frac{(E/K)^{1}}{(E/K)^{0}}$，其中上标表示引入碳价格前后的值。\n\n使用以下参数和价格值：$\\alpha = 0.4$，$\\rho = 0.5$，$p_{K} = 0.08$，$p_{E}^{0} = 0.05$ 以及 $\\tau = 0.02$。将 $S$ 的最终答案表示为无量纲的小数，并四舍五入到四位有效数字。",
            "solution": "问题要求计算引入碳价格后，能源-资本比率的乘数变化 $S \\equiv \\frac{(E/K)^{1}}{(E/K)^{0}}$。这需要为一个利润最大化的企业求解一个约束成本最小化问题。\n\n企业的目标是在生产固定产出水平 $\\bar{Y}$ 的约束下，最小化总投入成本 $C = p_{K} K + p_{E} E$。生产技术是恒定替代弹性 (CES) 函数：$Y = A \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{1/\\rho}$。\n\n我们可以使用拉格朗日乘子法来解决这个约束优化问题。拉格朗日函数 $\\mathcal{L}$ 是：\n$$\n\\mathcal{L}(K, E, \\lambda) = p_{K} K + p_{E} E + \\lambda \\left( \\bar{Y} - A \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{1/\\rho} \\right)\n$$\n其中 $\\lambda$ 是拉格朗日乘子，代表生产的边际成本。\n\n为了找到资本 $K$ 和能源 $E$ 的最优投入水平，我们将 $\\mathcal{L}$ 分别对 $K$、$E$ 和 $\\lambda$ 求偏导数，并令它们为零。这些是最小化的一阶条件 (FOCs)。\n\n关于 $K$ 的偏导数是：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial K} = p_{K} - \\lambda \\frac{\\partial Y}{\\partial K} = 0 \\implies p_{K} = \\lambda \\frac{\\partial Y}{\\partial K}\n$$\n关于 $E$ 的偏导数是：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial E} = p_{E} - \\lambda \\frac{\\partial Y}{\\partial E} = 0 \\implies p_{E} = \\lambda \\frac{\\partial Y}{\\partial E}\n$$\n资本的边际产量 $\\frac{\\partial Y}{\\partial K}$，使用链式法则求得：\n$$\n\\frac{\\partial Y}{\\partial K} = A \\left(\\frac{1}{\\rho}\\right) \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{(1/\\rho) - 1} (\\alpha \\rho K^{\\rho-1}) = A \\alpha K^{\\rho-1} \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{(1-\\rho)/\\rho}\n$$\n类似地，能源的边际产量 $\\frac{\\partial Y}{\\partial E}$ 是：\n$$\n\\frac{\\partial Y}{\\partial E} = A \\left(\\frac{1}{\\rho}\\right) \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{(1/\\rho) - 1} ((1 - \\alpha) \\rho E^{\\rho-1}) = A (1 - \\alpha) E^{\\rho-1} \\left[ \\alpha K^{\\rho} + (1 - \\alpha) E^{\\rho} \\right]^{(1-\\rho)/\\rho}\n$$\n最优性条件的核心可以通过将关于 $E$ 的一阶条件除以关于 $K$ 的一阶条件得到：\n$$\n\\frac{p_{E}}{p_{K}} = \\frac{\\lambda (\\partial Y / \\partial E)}{\\lambda (\\partial Y / \\partial K)} = \\frac{\\partial Y / \\partial E}{\\partial Y / \\partial K}\n$$\n这表明，在成本最小化的投入组合中，投入价格的比率必须等于其边际产量的比率，这就是边际技术替代率 (MRTS) 的定义。\n\n代入边际产量的表达式：\n$$\n\\frac{p_{E}}{p_{K}} = \\frac{A (1 - \\alpha) E^{\\rho-1} \\left[ \\dots \\right]^{(1-\\rho)/\\rho}}{A \\alpha K^{\\rho-1} \\left[ \\dots \\right]^{(1-\\rho)/\\rho}} = \\frac{1 - \\alpha}{\\alpha} \\frac{E^{\\rho-1}}{K^{\\rho-1}} = \\frac{1 - \\alpha}{\\alpha} \\left(\\frac{E}{K}\\right)^{\\rho-1}\n$$\n我们的目标是求出能源-资本比率 $E/K$。我们可以重排上述方程来求解它：\n$$\n\\left(\\frac{E}{K}\\right)^{\\rho-1} = \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}}{p_{K}}\n$$\n$$\n\\frac{E}{K} = \\left( \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}}{p_{K}} \\right)^{1/(\\rho-1)}\n$$\n该方程给出了最优投入比率，作为技术参数（$\\alpha$, $\\rho$）和投入价格比率（$p_E/p_K$）的函数。注意，该比率与产出水平 $\\bar{Y}$ 和生产率指数 $A$ 无关，这是CES函数的一个特性。\n\n我们被要求计算当能源价格从 $p_{E}^{0}$ 变为 $p_{E}^{1}$ 时，该比率的乘数变化。设 $(E/K)^{0}$ 为碳价格引入前的比率，$(E/K)^{1}$ 为引入后的比率。\n\n价格变化前（上标为 $0$）：\n$$\n\\left(\\frac{E}{K}\\right)^{0} = \\left( \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{0}}{p_{K}} \\right)^{1/(\\rho-1)}\n$$\n价格变化后（上标为 $1$），其中 $p_{E}^{1} = p_{E}^{0} + \\tau$：\n$$\n\\left(\\frac{E}{K}\\right)^{1} = \\left( \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{1}}{p_{K}} \\right)^{1/(\\rho-1)}\n$$\n乘数变化定义为 $S = \\frac{(E/K)^{1}}{(E/K)^{0}}$。\n$$\nS = \\frac{\\left( \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{1}}{p_{K}} \\right)^{1/(\\rho-1)}}{\\left( \\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{0}}{p_{K}} \\right)^{1/(\\rho-1)}} = \\left( \\frac{\\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{1}}{p_{K}}}{\\frac{\\alpha}{1 - \\alpha} \\frac{p_{E}^{0}}{p_{K}}} \\right)^{1/(\\rho-1)}\n$$\n包含 $\\alpha$ 和 $p_K$ 的常数项相互抵消，得到一个简化表达式：\n$$\nS = \\left( \\frac{p_{E}^{1}}{p_{E}^{0}} \\right)^{1/(\\rho-1)}\n$$\n问题提供了以下数值：$\\rho = 0.5$，$p_{E}^{0} = 0.05$ 以及 $\\tau = 0.02$。首先，我们计算新的能源价格 $p_{E}^{1}$：\n$$\np_{E}^{1} = p_{E}^{0} + \\tau = 0.05 + 0.02 = 0.07\n$$\n接下来，我们计算指数：\n$$\n\\frac{1}{\\rho - 1} = \\frac{1}{0.5 - 1} = \\frac{1}{-0.5} = -2\n$$\n注意，替代弹性为 $\\sigma = \\frac{1}{1-\\rho} = \\frac{1}{1-0.5} = 2$，因此指数为 $-\\sigma$，这与经济学理论的预期相符。\n\n现在，我们可以将这些值代入 $S$ 的表达式中：\n$$\nS = \\left( \\frac{0.07}{0.05} \\right)^{-2} = \\left( \\frac{7}{5} \\right)^{-2} = (1.4)^{-2}\n$$\n计算数值：\n$$\nS = \\frac{1}{(1.4)^{2}} = \\frac{1}{1.96}\n$$\n这得出：\n$$\nS \\approx 0.51020408...\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nS \\approx 0.5102\n$$\n这一结果表明，碳价格通过提高能源的相对成本，促使企业从能源转向资本进行替代，导致能源-资本比率下降约 $49\\%$。",
            "answer": "$$\n\\boxed{0.5102}\n$$"
        },
        {
            "introduction": "为了制定连贯的气候政策，我们必须能够比较各种温室气体的影响，而这些气体具有不同的大气寿命和辐射效率。诸如全球变暖潜能值 (GWP) 和全球温度变化潜能值 (GTP) 等指标充当“汇率”，将非二氧化碳气体的排放量换算为二氧化碳当量。本练习  深入探讨了这些指标之间的关键差异，揭示了指标的选择如何显著改变对某一排放情景气候影响的评估，这一区别具有深远的政策意义。",
            "id": "3885721",
            "problem": "一位综合评估建模师正在评估共享社会经济路径（Shared Socioeconomic Pathway）情景下，$2050$ 年的一项减缓政策冲击。该冲击是一次为期一年的脉冲式排放，包括 $2000$ 兆吨二氧化碳 $\\text{CO}_2$、$50$ 兆吨甲烷 $\\text{CH}_4$ 和 $5$ 兆吨一氧化二氮 $\\text{N}_2\\text{O}$。为了汇总非-$\\text{CO}_2$ 气体以进行政策比较，建模师考虑了在 $100$ 年时间范围内定义的两个常用指标：$100$ 年全球变暖潜能值（Global Warming Potential (GWP)$_{100}$）和 $100$ 年全球温度变化潜能值（Global Temperature change Potential (GTP)$_{100}$）。在建模师使用的简单气候模型中，全球平均地表温度对小规模排放脉冲的响应是线性的且不随时间变化，并且不同物种的温度贡献可以叠加。\n\n使用以下广泛报道的 $100$ 年时间范围的指标值：$\\mathrm{GWP}_{100}(\\mathrm{CH}_{4}) = 28$，$\\mathrm{GWP}_{100}(\\mathrm{N}_{2}\\mathrm{O}) = 265$，$\\mathrm{GTP}_{100}(\\mathrm{CH}_{4}) = 4$，$\\mathrm{GTP}_{100}(\\mathrm{N}_{2}\\mathrm{O}) = 234$。按照惯例，$\\mathrm{GWP}_{100}(\\text{CO}_2) = 1$ 且 $\\mathrm{GTP}_{100}(\\text{CO}_2) = 1$。\n\n从以下定义出发：$\\mathrm{GWP}_{100}$ 是指单位质量脉冲的某物种在 $100$ 年内的时间积分辐射强迫与 $\\text{CO}_2$ 的比值；$\\mathrm{GTP}_{100}$ 是指单位质量脉冲的某物种在第 $100$ 年引起的全球平均地表温度变化与 $\\text{CO}_2$ 的比值。并假设气候响应具有线性和叠加性，推导一个表达式，表示对于给定的排放脉冲，使用基于 $\\mathrm{GWP}_{100}$ 的 $\\text{CO}_2$ 当量汇总法预测的第 $100$ 年全球平均地表温度变化与使用基于 $\\mathrm{GTP}_{100}$ 的汇总法预测的变化之比。然后使用所提供的数据对该比率进行数值计算。\n\n将最终结果四舍五入到四位有效数字。最终答案以纯数（无量纲）形式表示。",
            "solution": "此计算的基本依据包括以下公认的定义和假设：(i) 在 $H$ 年时间范围内的全球变暖潜能值，记为 $\\mathrm{GWP}_{H}$，是指从时间 $0$ 到 $H$ 的区间内，单位质量脉冲的某物种产生的时间积分辐射强迫与单位质量脉冲的 $\\text{CO}_2$ 产生的时间积分辐射强迫之比；(ii) 在时间 $H$ 的全球温度变化潜能值，记为 $\\mathrm{GTP}_{H}$，是指在时间 $H$ 时，单位质量脉冲的某物种引起的全球平均地表温度变化与单位质量脉冲的 $\\text{CO}_2$ 引起的温度变化之比；(iii) 对于小扰动，气候系统近似为线性的且不随时间变化，因此温度响应与排放质量成线性比例，并可在不同物种间叠加。\n\n令 $H = 100$ 年为我们关心的时间范围。令脉冲排放量为 $E_{\\text{CO}_{2}}$、$E_{\\text{CH}_{4}}$ 和 $E_{\\text{N}_{2}\\text{O}}$，单位为一致的质量单位。在简单气候模型下，定义 $\\kappa_{\\text{CO}_{2}}(H)$ 为单位质量 $\\text{CO}_2$ 脉冲在时间 $H$ 引起的温度变化。根据线性关系，物种 $i$ 的单位脉冲在时间 $H$ 引起的温度变化为 $\\kappa_{\\text{CO}_{2}}(H) \\times \\mathrm{GTP}_{H}(i)$，因为 $\\mathrm{GTP}_{H}(i)$ 的定义就是相对于 $\\text{CO}_2$ 的比率。\n\n考虑两种用于预测时间 $H$ 温度影响的汇总方法：\n\n1. 基于 $\\mathrm{GTP}_{H}$ 的汇总法（与时间 $H$ 的温度响应在物理上一致）：由排放向量 $\\left(E_{\\text{CO}_{2}}, E_{\\text{CH}_{4}}, E_{\\text{N}_{2}\\text{O}}\\right)$ 引起的在时间 $H$ 的预测温度变化为\n$$\n\\Delta T_{\\mathrm{GTP}}(H) \\;=\\; \\kappa_{\\text{CO}_{2}}(H)\\,\\Big(E_{\\text{CO}_{2}} + \\mathrm{GTP}_{H}(\\mathrm{CH}_{4})\\,E_{\\text{CH}_{4}} + \\mathrm{GTP}_{H}(\\mathrm{N}_{2}\\mathrm{O})\\,E_{\\text{N}_{2}\\text{O}}\\Big).\n$$\n\n2. 基于 $\\mathrm{GWP}_{H}$ 的 $\\text{CO}_2$ 当量汇总法，然后计算在时间 $H$ 的 $\\text{CO}_2$ 温度响应：首先计算 $\\text{CO}_2$ 当量质量\n$$\nE_{\\text{CO}_{2}\\text{-}\\mathrm{eq}}^{\\mathrm{GWP}} \\;=\\; E_{\\text{CO}_{2}} + \\mathrm{GWP}_{H}(\\mathrm{CH}_{4})\\,E_{\\text{CH}_{4}} + \\mathrm{GWP}_{H}(\\mathrm{N}_{2}\\mathrm{O})\\,E_{\\text{N}_{2}\\text{O}},\n$$\n然后通过 $\\text{CO}_2$ 脉冲温度响应将其映射到时间 $H$ 的温度：\n$$\n\\Delta T_{\\mathrm{GWP}}(H) \\;=\\; \\kappa_{\\text{CO}_{2}}(H)\\,E_{\\text{CO}_{2}\\text{-}\\mathrm{eq}}^{\\mathrm{GWP}} \\;=\\; \\kappa_{\\text{CO}_{2}}(H)\\,\\Big(E_{\\text{CO}_{2}} + \\mathrm{GWP}_{H}(\\mathrm{CH}_{4})\\,E_{\\text{CH}_{4}} + \\mathrm{GWP}_{H}(\\mathrm{N}_{2}\\mathrm{O})\\,E_{\\text{N}_{2}\\text{O}}\\Big).\n$$\n\n因此，在时间 $H$ 的两个预测温度变化之比为\n$$\nR \\;\\equiv\\; \\frac{\\Delta T_{\\mathrm{GWP}}(H)}{\\Delta T_{\\mathrm{GTP}}(H)} \\;=\\; \\frac{E_{\\text{CO}_{2}} + \\mathrm{GWP}_{H}(\\mathrm{CH}_{4})\\,E_{\\text{CH}_{4}} + \\mathrm{GWP}_{H}(\\mathrm{N}_{2}\\mathrm{O})\\,E_{\\text{N}_{2}\\text{O}}}{E_{\\text{CO}_{2}} + \\mathrm{GTP}_{H}(\\mathrm{CH}_{4})\\,E_{\\text{CH}_{4}} + \\mathrm{GTP}_{H}(\\mathrm{N}_{2}\\mathrm{O})\\,E_{\\text{N}_{2}\\text{O}}}.\n$$\n因子 $\\kappa_{\\text{CO}_{2}}(H)$ 被消去，因此 $R$ 与简单气候模型的绝对温度响应幅度无关。这就推导出了所要求的表达式。\n\n现在，对于 $H=100$，使用提供的排放量和指标值对 $R$ 进行数值计算。使用一致的质量单位兆吨：\n$$\nE_{\\text{CO}_{2}} = 2000,\\quad E_{\\text{CH}_{4}} = 50,\\quad E_{\\text{N}_{2}\\text{O}} = 5.\n$$\n代入 $\\mathrm{GWP}_{100}(\\mathrm{CH}_{4}) = 28$，$\\mathrm{GWP}_{100}(\\mathrm{N}_{2}\\mathrm{O}) = 265$，$\\mathrm{GTP}_{100}(\\mathrm{CH}_{4}) = 4$ 和 $\\mathrm{GTP}_{100}(\\mathrm{N}_{2}\\mathrm{O}) = 234$：\n$$\n\\text{分子} \\;=\\; 2000 \\;+\\; 28 \\times 50 \\;+\\; 265 \\times 5 \\;=\\; 2000 \\;+\\; 1400 \\;+\\; 1325 \\;=\\; 4725,\n$$\n$$\n\\text{分母} \\;=\\; 2000 \\;+\\; 4 \\times 50 \\;+\\; 234 \\times 5 \\;=\\; 2000 \\;+\\; 200 \\;+\\; 1170 \\;=\\; 3370.\n$$\n因此，\n$$\nR \\;=\\; \\frac{4725}{3370} \\;\\approx\\; 1.402077\\ldots\n$$\n四舍五入到四位有效数字，\n$$\nR \\;\\approx\\; 1.402.\n$$\n这个无量纲比率超过 $1$，表明对于这种排放混合，在指定的线性气候模型中，使用基于 $\\mathrm{GWP}_{100}$ 的 $\\text{CO}_2$ 当量会高估相对于与 $\\mathrm{GTP}_{100}$ 一致的汇总法的第 $100$ 年温度变化。",
            "answer": "$$\\boxed{1.402}$$"
        },
        {
            "introduction": "气候建模面临的最大挑战之一是在“深度不确定性”下制定决策，即我们对地球气候敏感性等关键结果缺乏精确的概率分布。本练习超越了标准的风险分析（期望效用理论），探索了分布鲁棒优化（DRO）——一个在面对模糊性时做出审慎决策的强大框架。通过在两种框架下求解最优减排政策 ，您将直接洞察到，承认我们对概率的不确定性本身就可以成为采取更积极气候行动的理由。",
            "id": "3885707",
            "problem": "考虑一个具有模糊气候敏感性的单周期、标准化综合评估模型（IAM），旨在捕捉在气候响应不确定的情况下，减排与气候损害之间的权衡。设决策变量为减排率 $m \\in [0,1]$，解释为减排的排放比例。产出被标准化为 $1$，所有量均为无量纲的份额，因此不涉及物理单位。减排会产生凸性资源成本，而气候损害取决于实现的气候敏感性。\n\n基本和核心定义：\n- 消费由下式给出\n$$\nC(m,\\lambda) \\equiv 1 - \\kappa m^2 - \\phi \\left(\\lambda F_0 (1 - m)\\right)^2,\n$$\n其中 $\\kappa \\in (0,1)$ 是减排成本系数，$\\phi  0$ 是气候损害系数，$\\lambda  0$ 是单位辐射强迫的气候敏感性，而 $F_0  0$ 是一个标准化的参考强迫。假设参数使得对于所有 $m \\in [0,1]$ 和所有考虑的 $\\lambda$，都有 $C(m,\\lambda)  0$。\n- 偏好由对数效用函数表示\n$$\nu(C) \\equiv \\ln C,\n$$\n这是恒定相对风险厌恶的一个特例，风险厌恶系数等于 $1$。\n- 气候敏感性 $\\lambda$ 在一个两点支撑集 $\\{\\lambda_L,\\lambda_H\\}$ 中取值，其中 $\\lambda_L  \\lambda_H$。一个名义先验为 $\\lambda_H$ 分配概率 $p_0 \\in [0,1]$，为 $\\lambda_L$ 分配概率 $1-p_0$。\n- 关于真实分布的模糊性由总变差球（概率单纯形上的 $\\ell_1$ 球）表示，其半径为 $\\delta \\in [0,2]$，围绕名义先验。也就是说，模糊集是\n$$\n\\mathcal{P}(\\delta) \\equiv \\left\\{ p \\in \\mathbb{R}^2_{\\ge 0} : p_1 + p_2 = 1, \\ \\|p - p_0\\|_1 \\le \\delta \\right\\},\n$$\n其中 $p_0 = (1-p_0, p_0)$ 是关于 $(\\lambda_L,\\lambda_H)$ 的名义先验，$\\|\\cdot\\|_1$ 是 $\\ell_1$ 范数。\n\n考虑两种决策准则：\n1. 使用名义先验的期望效用（EU）：\n$$\n\\max_{m \\in [0,1]} \\ \\mathbb{E}_{p_0}[u(C(m,\\lambda))].\n$$\n2. 针对 $\\mathcal{P}(\\delta)$ 中所有先验的分布鲁棒优化（DRO）：\n$$\n\\max_{m \\in [0,1]} \\ \\min_{p \\in \\mathcal{P}(\\delta)} \\ \\mathbb{E}_{p}[u(C(m,\\lambda))].\n$$\n\n任务：\n- 对于给定的参数值，计算求解期望效用问题的 $m_{\\mathrm{EU}}^\\star$ 和求解分布鲁棒问题的 $m_{\\mathrm{DRO}}^\\star$。\n- 通过报告差异 $m_{\\mathrm{DRO}}^\\star - m_{\\mathrm{EU}}^\\star$ 来比较它们。\n\n算法和数值要求：\n- 使用分辨率为 $\\Delta m = 10^{-4}$ 的均匀网格搜索，在 $m \\in [0,1]$ 上数值求解这两个优化问题，即在 $m = 0, 10^{-4}, 2 \\cdot 10^{-4}, \\dots, 1$ 处进行评估并取最大化者。\n- 当为固定的 $m$ 评估 DRO 内部问题时，将其视为在总变差约束下对 $\\{\\lambda_L,\\lambda_H\\}$ 上分布的有限维最小化问题；本问题陈述中未提供快捷公式。\n\n测试套件：\n使用以下四个参数集，每个参数集指定为一个元组 $(\\lambda_L,\\lambda_H,p_0,\\delta,\\kappa,\\phi,F_0)$：\n- 案例 1（模糊半径为零的边界情况）：$(1.5, 3.0, 0.4, 0.0, 0.1, 0.04, 1.0)$。\n- 案例 2（中等模糊性）：$(1.5, 3.0, 0.4, 0.4, 0.1, 0.04, 1.0)$。\n- 案例 3（高减排成本和大的模糊性）：$(1.5, 3.0, 0.3, 1.6, 0.3, 0.04, 1.0)$。\n- 案例 4（较窄的气候敏感性范围和较低的成本）：$(1.5, 2.0, 0.5, 0.5, 0.05, 0.04, 1.0)$。\n\n程序输入和输出：\n- 没有外部输入；程序必须硬编码上述测试套件。\n- 对于每个测试用例，计算并返回三个浮点数：$m_{\\mathrm{EU}}^\\star$、$m_{\\mathrm{DRO}}^\\star$ 和 $m_{\\mathrm{DRO}}^\\star - m_{\\mathrm{EU}}^\\star$，每个都四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含四个案例的所有结果，格式为方括号内以逗号分隔的列表，顺序如下\n$$\n[m_{\\mathrm{EU},1}^\\star, m_{\\mathrm{DRO},1}^\\star, \\Delta m_1, m_{\\mathrm{EU},2}^\\star, m_{\\mathrm{DRO},2}^\\star, \\Delta m_2, m_{\\mathrm{EU},3}^\\star, m_{\\mathrm{DRO},3}^\\star, \\Delta m_3, m_{\\mathrm{EU},4}^\\star, m_{\\mathrm{DRO},4}^\\star, \\Delta m_4],\n$$\n其中 $\\Delta m_i \\equiv m_{\\mathrm{DRO},i}^\\star - m_{\\mathrm{EU},i}^\\star$ 为案例 $i$ 的结果。",
            "solution": "该问题具有科学依据，提法恰当，并且为获得唯一的数值解提供了所有必要的参数和条件。该模型是气候不确定性下经济权衡的一种程式化但标准的表示，其决策准则（期望效用和分布鲁棒优化）在决策论中是公认的。因此，该问题被认为是**有效的**。\n\n解决方案首先定义模型的核心组成部分，然后分析和构建两个优化问题（期望效用和分布鲁棒优化）的数值解法，最后概述用于计算和比较的算法。\n\n### 1. 模型构建\n\n模型的核心是消费函数，它取决于减排率 $m \\in [0,1]$ 和气候敏感性 $\\lambda \\in \\{\\lambda_L, \\lambda_H\\}$。\n$$\nC(m,\\lambda) = 1 - \\kappa m^2 - \\phi \\left(\\lambda F_0 (1 - m)\\right)^2\n$$\n在这里，$1$ 代表经济的标准化总产出。从中减去两项成本：\n- 减排成本 $\\kappa m^2$，它在减排率 $m$ 上是凸的。\n- 气候损害成本 $\\phi (\\lambda F_0 (1-m))^2$，它取决于剩余排放量 $(1-m)$、参考强迫 $F_0$ 和不确定的气候敏感性 $\\lambda$。\n\n社会福利通过消费的对数效用 $u(C) = \\ln C$ 来衡量。\n\n### 2. 期望效用（EU）最大化\n\n第一个决策准则是，在气候敏感性状态的名义先验概率分布下，最大化期望效用。设 $p_0$ 是分配给高敏感性状态 $\\lambda_H$ 的概率，而 $1-p_0$ 是分配给低敏感性状态 $\\lambda_L$ 的概率。需要最大化的目标函数是：\n$$\nV_{\\mathrm{EU}}(m) = \\mathbb{E}_{p_0}[u(C(m,\\lambda))] = (1-p_0) u(C(m, \\lambda_L)) + p_0 u(C(m, \\lambda_H))\n$$\n代入 $u(\\cdot)$ 和 $C(\\cdot,\\cdot)$ 的定义，我们得到：\n$$\nV_{\\mathrm{EU}}(m) = (1-p_0) \\ln\\left(1 - \\kappa m^2 - \\phi (\\lambda_L F_0 (1-m))^2\\right) + p_0 \\ln\\left(1 - \\kappa m^2 - \\phi (\\lambda_H F_0 (1-m))^2\\right)\n$$\n在此准则下的最优减排率 $m_{\\mathrm{EU}}^\\star$ 通过求解以下优化问题得到：\n$$\nm_{\\mathrm{EU}}^\\star = \\arg\\max_{m \\in [0,1]} V_{\\mathrm{EU}}(m)\n$$\n在数值上，此最大化通过对 $m \\in \\{0, 10^{-4}, 2 \\cdot 10^{-4}, \\dots, 1\\}$ 进行网格搜索来执行。\n\n### 3. 分布鲁棒优化（DRO）\n\n第二个准则处理关于真实概率的模糊性。决策者从最坏情况场景中最大化效用，其中最坏情况由模糊集 $\\mathcal{P}(\\delta)$ 内使期望效用最小化的概率分布定义。该问题是：\n$$\n\\max_{m \\in [0,1]} \\min_{p \\in \\mathcal{P}(\\delta)} \\mathbb{E}_{p}[u(C(m,\\lambda))]\n$$\n让我们首先为固定的减排率 $m$ 求解内部最小化问题。概率分布是状态 $(\\lambda_L, \\lambda_H)$ 的一个向量 $p = (p_L, p_H)$。设 $q = p_H$ 为 $\\lambda_H$ 的概率，因此 $p_L = 1-q$。名义先验是 $p_0^\\text{vec} = (1-p_0, p_0)$。模糊集 $\\mathcal{P}(\\delta)$ 由约束 $\\|p - p_0^\\text{vec}\\|_1 \\le \\delta$ 定义。此约束可以根据 $q$ 重写：\n$$\n\\|(1-q, q) - (1-p_0, p_0)\\|_1 = |(1-q)-(1-p_0)| + |q-p_0| = |p_0-q| + |q-p_0| = 2|q-p_0| \\le \\delta\n$$\n这简化为 $|q-p_0| \\le \\delta/2$，即 $p_0 - \\delta/2 \\le q \\le p_0 + \\delta/2$。由于 $q$ 必须是有效的概率，它被限制在 $[0,1]$ 内。因此，$\\lambda_H$ 的可能概率集合是 $q \\in [\\max(0, p_0 - \\delta/2), \\min(1, p_0 + \\delta/2)]$。\n\n内部最小化问题是：\n$$\nV_{\\mathrm{DRO}}(m) = \\min_{q} \\left\\{ (1-q) u(C(m, \\lambda_L)) + q u(C(m, \\lambda_H)) \\right\\}\n$$\n约束条件为 $q \\in [\\max(0, p_0 - \\delta/2), \\min(1, p_0 + \\delta/2)]$。\n\n设 $u_L(m) = u(C(m, \\lambda_L))$ 和 $u_H(m) = u(C(m, \\lambda_H))$。目标可以写成 $q$ 的线性函数：\n$$\nu_L(m) + q \\left( u_H(m) - u_L(m) \\right)\n$$\n由于 $\\lambda_H > \\lambda_L$，对于 $\\lambda_H$（对任何 $m1$），气候损害更高。这意味着 $C(m, \\lambda_H)  C(m, \\lambda_L)$。由于效用函数 $u(C)=\\ln C$ 是严格递增的，因此 $u_H(m)  u_L(m)$。因此，$q$ 的系数 $(u_H(m) - u_L(m))$ 是负的。\n\n要最小化一个具有负斜率的线性函数，必须为变量选择可能的最大值。因此，高敏感性状态的最坏情况概率 $q^\\star$ 是可行区间的上界：\n$$\nq^\\star = \\min(1, p_0 + \\delta/2)\n$$\n鲁棒目标函数的值为：\n$$\nV_{\\mathrm{DRO}}(m) = (1-q^\\star) u(C(m, \\lambda_L)) + q^\\star u(C(m, \\lambda_H))\n$$\n在 DRO 下的最优减排率 $m_{\\mathrm{DRO}}^\\star$ 通过在 $m$ 的网格上最大化此值来找到：\n$$\nm_{\\mathrm{DRO}}^\\star = \\arg\\max_{m \\in [0,1]} V_{\\mathrm{DRO}}(m)\n$$\n此最大化也通过指定的网格搜索执行。对高损害状态 $\\lambda_H$ 的权重增加 $q^\\star \\ge p_0$ 通常会导致更具预防性的政策，意味着 $m_{\\mathrm{DRO}}^\\star \\ge m_{\\mathrm{EU}}^\\star$。\n\n### 4. 算法实现\n\n对于每个参数集 $(\\lambda_L, \\lambda_H, p_0, \\delta, \\kappa, \\phi, F_0)$：\n1.  为减排率定义一个网格：$m \\in \\{0, 10^{-4}, \\dots, 1\\}$。此网格包含 $10001$ 个点。\n2.  对于网格上的每个 $m$ 值，计算低气候敏感性和高气候敏感性下的消费：\n    $$ C_L(m) = 1 - \\kappa m^2 - \\phi (\\lambda_L F_0 (1-m))^2 $$\n    $$ C_H(m) = 1 - \\kappa m^2 - \\phi (\\lambda_H F_0 (1-m))^2 $$\n3.  计算相应的效用向量 $u_L(m) = \\ln(C_L(m))$ 和 $u_H(m) = \\ln(C_H(m))$。\n4.  **期望效用（EU）解**：计算期望效用向量 $V_{\\mathrm{EU}}(m) = (1-p_0)u_L(m) + p_0 u_H(m)$。找到使该向量最大化的 $m$ 值。这就是 $m_{\\mathrm{EU}}^\\star$。\n5.  **分布鲁棒优化（DRO）解**：首先，确定最坏情况概率 $q^\\star = \\min(1, p_0 + \\delta/2)$。然后，计算鲁棒目标向量 $V_{\\mathrm{DRO}}(m) = (1-q^\\star)u_L(m) + q^\\star u_H(m)$。找到使该向量最大化的 $m$ 值。这就是 $m_{\\mathrm{DRO}}^\\star$。\n6.  计算差值 $\\Delta m = m_{\\mathrm{DRO}}^\\star - m_{\\mathrm{EU}}^\\star$。\n7.  存储这三个值 $(m_{\\mathrm{EU}}^\\star, m_{\\mathrm{DRO}}^\\star, \\Delta m)$，四舍五入到6位小数，并对所有测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for optimal mitigation rates under Expected Utility and\n    Distributionally Robust Optimization criteria for a set of test cases.\n    \"\"\"\n    # Test cases are tuples of (lambda_L, lambda_H, p_0, delta, kappa, phi, F_0)\n    test_cases = [\n        (1.5, 3.0, 0.4, 0.0, 0.1, 0.04, 1.0),\n        (1.5, 3.0, 0.4, 0.4, 0.1, 0.04, 1.0),\n        (1.5, 3.0, 0.3, 1.6, 0.3, 0.04, 1.0),\n        (1.5, 2.0, 0.5, 0.5, 0.05, 0.04, 1.0),\n    ]\n\n    all_results = []\n    \n    # Define the grid for the mitigation rate m\n    # Resolution delta_m = 1e-4, so m ranges from 0 to 1\n    # Number of points is 1/1e-4 + 1 = 10001\n    num_points = int(1 / 1e-4) + 1\n    m_grid = np.linspace(0.0, 1.0, num_points)\n\n    for case in test_cases:\n        lambda_L, lambda_H, p0, delta, kappa, phi, F0 = case\n\n        # Vectorized calculation of consumption for all m in the grid\n        abatement_cost = kappa * m_grid**2\n        emissions_factor = (F0 * (1 - m_grid))**2\n        \n        # Consumption for low and high climate sensitivity\n        C_L = 1.0 - abatement_cost - phi * (lambda_L**2 * emissions_factor)\n        C_H = 1.0 - abatement_cost - phi * (lambda_H**2 * emissions_factor)\n\n        # Check for non-positive consumption which would make log utility undefined.\n        # The problem statement guarantees C  0.\n        if np.any(C_L = 0) or np.any(C_H = 0):\n            # This block should not be reached based on problem constraints\n            raise ValueError(f\"Consumption is not positive for case: {case}\")\n            \n        # Utility for low and high sensitivity states\n        u_L = np.log(C_L)\n        u_H = np.log(C_H)\n\n        # 1. Expected Utility (EU) Calculation\n        # The objective function is V_EU(m) = (1-p0)*u_L(m) + p0*u_H(m)\n        v_eu = (1.0 - p0) * u_L + p0 * u_H\n        # Find the mitigation rate m that maximizes expected utility\n        m_eu_star = m_grid[np.argmax(v_eu)]\n\n        # 2. Distributionally Robust Optimization (DRO) Calculation\n        # First, find the worst-case probability for the high-damage state lambda_H.\n        # This is derived by maximizing the probability q_H subject to the\n        # total variation constraint ||p - p_nom||_1 = delta, which is equivalent\n        # to |q_H - p0| = delta/2.\n        # Since u_H  u_L (higher damages), we want to maximize q_H.\n        q_star = min(1.0, p0 + delta / 2.0)\n        \n        # The robust objective function is V_DRO(m) = (1-q*)*u_L(m) + q* * u_H(m)\n        v_dro = (1.0 - q_star) * u_L + q_star * u_H\n        # Find the mitigation rate m that maximizes the robust objective\n        m_dro_star = m_grid[np.argmax(v_dro)]\n\n        # 3. Calculate the difference and round results\n        delta_m = m_dro_star - m_eu_star\n        \n        m_eu_star_rounded = round(m_eu_star, 6)\n        m_dro_star_rounded = round(m_dro_star, 6)\n        delta_m_rounded = round(delta_m, 6)\n        \n        all_results.extend([m_eu_star_rounded, m_dro_star_rounded, delta_m_rounded])\n\n    # Format the final output string exactly as specified\n    # The map converts each number to a string formatted to 6 decimal places\n    output_str = f\"[{','.join(f'{x:.6f}' for x in all_results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}