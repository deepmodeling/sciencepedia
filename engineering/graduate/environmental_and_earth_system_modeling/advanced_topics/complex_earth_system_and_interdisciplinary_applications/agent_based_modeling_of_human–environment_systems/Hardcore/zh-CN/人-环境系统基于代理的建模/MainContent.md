## 引言
人类与环境系统本质上是复杂的适应性系统，其特点是存在大量的异质性行为体、[非线性](@entry_id:637147)动态、反馈循环和[跨尺度](@entry_id:754544)的相互作用。理解这些系统的行为，并预测它们对政策干预或外部变化的响应，是当代科学面临的重大挑战。传统的宏观模型往往难以捕捉驱动系统演化的微观[异质性](@entry_id:275678)和局部交互，从而在解释和预测“涌现”出的系统级现象时存在局限性。

本文旨在系统性地介绍多[主体建模](@entry_id:195154)（Agent-Based Modeling, ABM），一种强大的“自下而上”的计算方法，它为应对上述挑战提供了独特的视角。通过明确地模拟单个主体（如个人、家庭、公司）的决策和行为，以及它们在特定环境（空间或网络）中的交互，ABM能够探索微观机制如何共同产生我们所关心的宏观模式。本文旨在填补理论知识与实际应用之间的鸿沟，为读者提供一个关于ABM方法论的坚实框架。

在接下来的章节中，我们将踏上一段从理论到实践的旅程。第一章“原理与机制”将深入剖析构成ABM的基石，从其作为形式化动力系统的定义，到主体的异质性、决策规则、学习机制以及交互结构。第二章“应用与跨学科联系”将通过一系列来自自然资源管理、土地利用科学、流行病学和气候政策等领域的实例，展示ABM作为一种“虚拟实验室”的强大功能。最后，在“动手实践”部分，读者将有机会通过具体的编程练习，将所学概念付诸实践。通过这一结构化的学习路径，本文将引导您掌握使用ABM来理解和管理我们这个相互关联的复杂世界的核心技能。

## 原理与机制

在介绍性章节之后，我们现在深入探讨构建人类—环境系统多主体模型（Agent-Based Models, ABM）的核心原理与关键机制。本章旨在为读者提供一个坚实的基础，理解 ABM 作为一种形式化建模方法的独特之处，并掌握其关键组成部分——主体、环境、交互与适应——是如何被定义和实现的。我们将从基本定义出发，逐步剖析模型构建中的核心概念，包括主体的异质性、决策过程、学习机制、时空交互结构，以及将人类系统与物理环境模型进行耦合时的基本要求。最终，我们将探讨 ABM 的标志性特征——涌现现象，并讨论确保模型研究科学严谨性的方法论基础。

### 作为形式化动力系统的多主体模型

从根本上说，一个多主体模型是一个在联合[状态空间](@entry_id:160914)上定义的离散时间或连续时间的[随机动力系统](@entry_id:262512)。这个联合[状态空间](@entry_id:160914) $X$ 由所有主体的状态和环境的状态共同构成。形式上，如果系统中有 $N$ 个主体，每个主体 $i$ 在时间 $t$ 的状态为 $x_i(t)$，其[状态空间](@entry_id:160914)为 $\mathcal{X}_i$，环境的状态为 $e(t)$，其[状态空间](@entry_id:160914)为 $\mathcal{E}$，那么整个系统的[状态空间](@entry_id:160914)就是 $X = (\prod_{i=1}^N \mathcal{X}_i) \times \mathcal{E}$。

系统的演化由一套规则驱动，这些规则规定了状态如何随时间变化。在ABM中，这些规则是“自下而上”定义的，作用于单个主体层面：

1.  **主体层面的演化**：每个主体 $i$ 的状态更新是随机的，其决策取决于自身当前状态 $x_i(t)$、其局部交互邻域的信息 $\mathcal{N}_i(t)$（例如，其邻居的状态）以及环境状态 $e(t)$。这可以用一个主体层面的转移核（transition kernel）来形式化地表示：$P_i(\mathrm{d}x_i(t+\Delta t) | x_i(t), \mathcal{N}_i(t), e(t); \theta_i)$。其中 $\theta_i$ 代表主体 $i$ 的一组参数。在连续时间模型中，这种转变则由相应的风险率（hazard rates）$\lambda_{i\ell}(x_i(t), \mathcal{N}_i(t), e(t))$ 决定，其中 $\ell$ 代表不同的事件类型。

2.  **环境层面的演化**：环境的状态更新则取决于其自身先前的状态 $e(t)$、所有主体的集体行为 $\{x_i(t)\}_{i=1}^N$ 以及外部的生物物理通量 $\xi(t)$。这可以表示为一个环境[更新函数](@entry_id:275392)：$e(t+\Delta t) = H(e(t), \{x_i(t)\}_{i=1}^N, \xi(t); \phi)$，其中 $\phi$ 是环境模型的参数。

这种将系统状态分解为异质、离散决策者（主体）和与之耦合的环境的做法，是ABM与其他建模范式的主要区别。

-   **与[系统动力学](@entry_id:136288)（System Dynamics, SD）的区别**：[系统动力学](@entry_id:136288)模型关注的是高度聚合的**存量**（stocks）和**流量**（flows），其动态通常由[常微分方程](@entry_id:147024)（ODEs）或[差分方程](@entry_id:262177)描述，例如 $\dot{S}_k(t) = G_k(S(t), t; \theta)$。SD模型在宏观层面运作，它通过反馈循环来捕捉系统的行为，但不直接表示单个、异质的行为者。试图从一个ABM精确推导出低维的SD模型（即对所有主体进行加总）通常是不可行的，除非在非常严格的假设下（如线性规则、完全混合的交互）。一般而言，由于主体行为的[非线性](@entry_id:637147)、[异质性](@entry_id:275678)和复杂的交互结构，宏观方程的推导会面临“[矩封闭](@entry_id:199308)”（moment closure）问题，即低阶矩（如均值）的动态会依赖于更高阶的矩（如方差和相关性）。因此，ABM和SD在数学上并不等价；ABM的核心优势之一正是能够捕捉在宏观聚合模型中丢失的关键微观[异质性](@entry_id:275678)与交互作用。

-   **与[偏微分](@entry_id:194612)方程（Partial Differential Equations, PDE）的区别**：PDE模型，如 $\partial_t u + \nabla \cdot \mathbf{J} = q$，描述的是连续**场**（fields）$u(\mathbf{r},t)$ 的时空演化，它基于局部守恒定律和[本构关系](@entry_id:186508)（constitutive relations）。PDE将系统视为一个连续介质，而ABM则将其视为离散、自治实体的集合。尽管在某些特定情况下，某些PDE可以作为特定类型的多主体模型（如相互作用的[粒子系统](@entry_id:180557)）在特定极限（如流[体力](@entry_id:174230)学极限）下的结果，但这两种框架在概念和数学上是截然不同的。

当一个ABM的微观规则（即$P_i$和$H$）编码了**局部交互**、**异质性**和**适应性学习**，并且这些微观机制通过[非线性反馈](@entry_id:180335)能够产生在宏观层面可观察到的、非预设的模式时，该ABM就成为了一个**[复杂适应系统](@entry_id:893720)（Complex Adaptive System, CAS）**的实例。

### 主体的剖析：状态、特质与类型的[异质性](@entry_id:275678)

在多主体模型中，**[异质性](@entry_id:275678)**（heterogeneity）——即主体之间的差异——是产生复杂行为的关键驱动力。为了精确地描述这些差异，我们将主体的属性分为三类 ：

-   **状态（State）**：描述主体随时间变化的属性。例如，一个农户主体的财富、其土地的位置、或其对某种风险的感知水平。这些都是动态变量。

-   **特质（Trait）**：描述主体固定不变的、[参数化](@entry_id:265163)的属性。这些特质通常定义了主体的决策规则。例如，在一个资源收获模型中，一个农户的收获努力参数 $\alpha_i$ 或其停止收获的资源阈值 $\theta_i$ 都是特质。

-   **类型（Type）**：描述主体所属的、具有不同决策规则功能形式的分类。例如，一个模型中可能包含两种主体类型：“小农户”和“公司”。小农户可能使用基于阈值的收获规则，而公司可能使用基于利润最大化的比例收获规则。类型差异代表了行为逻辑上的根本不同。

理解[异质性](@entry_id:275678)的来源也至关重要。我们可以将其区分为**内在异质性**（intrinsic heterogeneity）和**外在[异质性](@entry_id:275678)**（extrinsic heterogeneity）。

-   **内在异质性**指主体自身的差异，包括主体间特质（如不同的风险偏好、技能水平）和类型（如不同的社会群体）的差异。
-   **外在[异质性](@entry_id:275678)**指主体外部环境或交互结构的差异。这包括环境属性的差异（如不同地块的土壤肥力或[承载力](@entry_id:746747) $K_j$）或社会[网络结构](@entry_id:265673)的差异（如某些主体比其他主体拥有更多的社会联系）。

这两种[异质性](@entry_id:275678)对涌现出的宏观模式有着截然不同的影响。考虑一个资源收获模型，其中一群具有不同收获阈值 $\theta_i$ 的农户在一个具有不同[承载力](@entry_id:746747) $K_j$ 的地块网络上活动。

-   **内在异质性的作用**：如果农户的收获阈值 $\theta_i$ 是异质的（例如，遵循某个概率分布），那么总体的收获压力将不再是一个尖锐的[阶跃函数](@entry_id:159192)。相反，随着资源水平的提高，越来越多的农户会越过他们的个人阈值并开始收获。这使得总收获量成为资源水平的一个**平滑**函数。因此，内在[异质性](@entry_id:275678)通常通过“平均效应”来平滑宏观响应，减弱个体层面规则的尖锐性。

-   **外在[异质性](@entry_id:275678)的作用**：如果环境的[承载力](@entry_id:746747) $K_j$ 或资源再生率 $r_j$ 是异质的，那么即使所有主体的行为规则都相同，不同地块的生态动态也会不同。每个地块的[稳态](@entry_id:139253)资源水平 $R_j^*$ 将取决于其特定的 $K_j$ 和 $r_j$ 值。这种外在[异质性](@entry_id:275678)可能导致整个系统出现**多模态**的[稳态分布](@entry_id:149079)，即一些地块维持在较高的资源水平，而另一些则可能因为局部收获压力超过了其较低的[承载力](@entry_id:746747)而崩溃。这还可以导致**空间聚集性的崩溃**，即环境脆弱性较高的区域集中出现资源枯竭。

### 主体的决策：从完全理性到启发式方法

在为人类[系统建模](@entry_id:197208)时，一个核心问题是：主体如何做出决策？传统的经济学理论通常假设主体是完全理性的，即在拥有完全信息和无限计算能力的情况下，最大化其**期望效用（Expected Utility）**。例如，一个农户在选择种植策略 $a$ 时，会解决优化问题 $\max_{a \in \mathcal{A}} \mathbb{E}_{\pi(s)}[U(a,s)]$，其中 $U(a,s)$ 是在环境状态 $s$ 下采取行动 $a$ 的效用，$\pi(s)$ 是环境状态的概率分布。

然而，诺贝尔奖得主 [Herbert Simon](@entry_id:1126017) 提出的**有限理性（Bounded Rationality）**理论为ABM中的主体决策提供了更符合现实的基础。该理论认为，真实世界中的决策者面临着三重限制：
1.  **有限的信息**：他们通常不知道确切的概率分布 $\pi(s)$。
2.  **有限的认知能力**：他们无法执行复杂的优化计算。
3.  **信息与计算的成本**：搜寻和评估备选方案需要时间和精力。

由于这些限制，主体并不寻求“最优”解，而是依赖于**[启发式方法](@entry_id:637904)（Heuristics）**——即一些简单、高效的“[经验法则](@entry_id:262201)”或心智捷径——来做出“足够好”的决策。

**满足（Satisficing）**是一种经典的启发式方法。一个采用满足策略的主体不会评估所有可能的选项，而是会设定一个**期望水平（aspiration level）** $\tau_t$。然后，它会按顺序评估备选方案，一旦找到第一个能够达到或超过其期望水平的方案，就立即停止搜索并选择该方案。这个决策过程可以形式化为：按顺序评估行动 $a$，当首次发现一个行动其估计效用 $\hat{U}_t(a) \ge \tau_t$ 时，就选择这个 $a$ 并停止搜索。

更进一步，这个期望水平本身也可以是适应性的。一个常见的、符合心理学现实的机制是，期望水平会根据过去的经验进行调整。例如，主体可能会通过强化学习的方式更新其期望水平，使其向最近实现的效用靠拢。这可以用一个[指数平滑](@entry_id:749182)公式来表示：
$$ \tau_{t+1} = (1 - \lambda)\,\tau_t + \lambda\,U(a_t, s_t) $$
其中 $U(a_t, s_t)$ 是在时间 $t$ 选择行动 $a_t$ 后实际获得的效用，$\lambda \in (0,1)$ 是一个[学习率](@entry_id:140210)，决定了新经验在更新期望水平时的权重。这种机制捕捉了主体如何通过经验调整其满意标准，是模拟现实人类决策的一个强大工具。

### 适应与学习的机制

主体的行为不是一成不变的；它们会通过学习和适应来应对变化的环境和新的信息。在ABM中，我们可以实现多种适应机制，它们在学习来源、作用范围和时间尺度上有所不同。

1.  **强化学习（Reinforcement Learning, RL）**：这是一种**个体学习**机制，主体通过自身的“试错”经验来学习。在一个马尔可夫决策过程（MDP）框架中，主体在状态 $s_t$ 下采取行动 $a_t$，获得奖励 $r_t$，并据此更新其内部的策略或价值函数（例如，一个估计在特定状态下采取特定行动的长期价值的 $Q$ 函数）。RL的核心在于解决**信用[分配问题](@entry_id:174209)**，即将最终的奖励归因于导致它的行动序列。这个过程发生在主体内部，时间尺度与决策同步。

2.  **社会学习（Social Learning）**：这是一种**向他人学习**的机制。主体通过观察其社交网络中邻居的行为、策略或收益来调整自己的行为。它通常涉及模仿或效仿那些看起来更成功的同伴。与RL不同，社会学习通常不涉及复杂的内部信用分配；主体只是简单地采纳“对别人有效”的策略。这种机制的实现需要定义一个社交[网络结构](@entry_id:265673)、一个观察协议（能观察到什么信息）以及一个模仿规则（如“模仿最成功的邻居”）。社会学习是信息在社会系统中传播的关键途径。

3.  **[演化适应](@entry_id:151186)（Evolutionary Adaptation）**：这是一个**群体层面**的过程，类似于生物演化。在一个主体群体中，存在着各种可遗传的策略。主体的成功（通常由其累积收益或“[适应度](@entry_id:154711)”衡量）决定了其“繁殖”的可能性，即其策略被传递给下一“代”主体的机会。这个过程通常伴随着**变异**（引入新策略）和**选择**（高[适应度](@entry_id:154711)策略的频率增加）。演化的单位是策略或基因型，变化发生在策略在群体中的[频率分布](@entry_id:176998)上，其时间尺度通常是“代际”的，比单个决策的尺度要长得多。

这三种机制并非相互排斥，一个复杂的ABM可以同时包含多种学习方式，以更全面地捕捉人类适应行为的丰富性。

### 交互的结构：空间与网络

主体并非孤立存在，它们在特定的环境中进行交互。这个“环境”既可以是地理空间，也可以是社会网络空间。ABM的强大之处在于能够明确地表示这些交互结构。

#### 地理空间与邻域

在模拟[土地利用变化](@entry_id:1127057)、资源管理或污染扩散等问题时，地理空间的表示至关重要。两种主要的表示方法是**栅格（Raster）**和**矢量（Vector）**。

-   **栅格表示**：将空间划分为规则的网格单元（如正方形或六边形）。每个主体占据一个或多个单元。这种表示方法简单、计算高效，特别适合模拟连续场的[扩散过程](@entry_id:268015)。
-   **矢量表示**：使用点、线和多边形来表示地理特征。例如，土地可以被表示为具有不同形状和大小的多边形地块。这种方法能更精确地表示不规则的地理边界（如行政区、农田），但计算上可能更复杂。

在栅格空间中，主体的局部交互取决于**邻域（neighborhood）**的定义。最常见的两种是：
-   **[冯·诺依曼邻域](@entry_id:1133909)（von Neumann neighborhood）**：包括共享边的四个正交方向的邻居。
-   **[摩尔邻域](@entry_id:1128159)（Moore neighborhood）**：包括共享边或顶点的所有八个邻居。

邻域的定义直接影响交互的范围和动态。例如，一个主体的预期交互次数在[摩尔邻域](@entry_id:1128159)（$8p$）中是在[冯·诺依曼邻域](@entry_id:1133909)（$4p$）中的两倍，其中 $p$ 是与每个邻居发生交互的概率。更重要的是，它影响着扩散等空间过程的性质。在方形栅格上，[摩尔邻域](@entry_id:1128159)允许对角线方向的移动，这使得随机游走的运动更具**各向同性**（isotropy），即在不同方向上的运动属性更均匀。可以证明，一个在[摩尔邻域](@entry_id:1128159)上进行随机游走的主体，其[有效扩散系数](@entry_id:1124178)是在[冯·诺依曼邻域](@entry_id:1133909)上的**1.5倍**。

#### 社会[网络拓扑](@entry_id:141407)

除了地理邻近性，人类交互更多地由社会关系决定。这些关系可以被建模为**社会网络（social network）**，其中节点是主体，边代表交互关系（如友谊、信息交流、影响力）。网络拓扑结构极大地影响着信息、行为或规范的扩散方式。 常见的[网络拓扑](@entry_id:141407)包括：

-   **规则格点（Lattice）**：如环形或二维网格，所有[节点度](@entry_id:1128744)数相同。具有高聚类和长平均路径长度的特点。
-   **[随机网络](@entry_id:263277)（Random network）**：如Erdős-Rényi（ER）模型，节点间的连接以[固定概率](@entry_id:178551)随机产生。度分布近似为泊松分布，聚类低，平均路径长度短。
-   **小世界网络（Small-world network）**：如[Watts-Strogatz模型](@entry_id:141694)，介于规则格点和[随机网络](@entry_id:263277)之间。它具有像规则格点一样的高聚类特性，同时又像随机网络一样具有很短的平均路径长度。
-   **[无标度网络](@entry_id:137799)（Scale-free network）**：如[Barabási-Albert模型](@entry_id:147434)，度分布遵循幂律分布 $P(k) \propto k^{-\gamma}$。其显著特征是存在少数度数极高的“**中心节点**”（hubs）。

网络拓扑对[扩散过程](@entry_id:268015)的影响取决于扩散本身的性质。我们可以区分两种主要类型：

-   **简单蔓延（Simple contagion）**：类似于[疾病传播](@entry_id:170042)（如[SIS模型](@entry_id:264678)），单个接触就足以引发传播。这种过程的传播能力对网络的**[度异质性](@entry_id:1123508)**高度敏感。在度分布方差越大的网络中，传播阈值越低。特别是在[无标度网络](@entry_id:137799)中，由于中心节点的存在，其二阶矩 $\langle k^2 \rangle$ 在网络规模 $N \to \infty$ 且 $2 \lt \gamma \le 3$ 时会发散，导致传播阈值趋近于零。这意味着任何微小的传播率都可能导致全局爆发。

-   **复杂蔓延（Complex contagion）**：传播需要来自多个源的社会强化，即一个主体需要有多个邻居采纳了某种行为后才会跟进。这种过程的传播能力对网络的**聚类**特性高度敏感。高聚类的网络（如小世界网络）能够为行为的传播提供必要的局部强化环境，因此比同等平均度数的低聚类网络（如[随机网络](@entry_id:263277)）更容易引发全局性的行为瀑布。

### 耦合人类与环境系统

在人类—环境[系统建模](@entry_id:197208)中，一个核心挑战是如何将代表人类行为的ABM与代表物理过程（如水文、气候、生态）的模型进行**耦合（coupling）**。耦合的严谨性直接关系到整个模型的有效性。

耦合方式可以分为两种：

-   **[单向耦合](@entry_id:752919)（One-way coupling）**：信息只在一个方向上流动。通常是物理模型为ABM提供环境状态信息（如土壤湿度、气温），ABM根据这些信息做出决策，但这些决策结果**不**反馈给物理模型去影响其后续演化。这种方式适用于人类活动对环境的反馈影响可以忽略不计的场景，或者用于探索“如果……会怎样”的纯[情景分析](@entry_id:1131292)。

-   **[双向耦合](@entry_id:178809)（Two-way coupling）**：信息在两个模型之间双向流动。物理模型的状态影响ABM的决策，而这些决策（如灌溉取水量、土地利用变化）又作为边界条件或源汇项反馈给物理模型，从而改变环境的未来状态。这种方式能够捕捉人类与环境系统之间相互作用的**反馈循环**，是理解系统[共同演化](@entry_id:151915)的关键。

在进行双向耦合时，必须确保物理守恒定律在模型接口处得到严格遵守，以避免人为地产生或消灭物质与能量。

-   **质量守恒（Mass consistency）**：ABM中由人类活动产生的物质流，必须在物理模型的质量平衡方程中得到精确核算。例如，如果ABM计算出一个总的灌溉取水量 $W(t)$，那么这个量必须作为物理模型中土壤水储量 $S(t)$ [演化方程](@entry_id:268137)的一个汇项（即减项）出现。在一个耦合时间步 $\Delta t$ 内，必须满足积分形式的质量平衡：
    $$ S(t+\Delta t)-S(t)=\int_t^{t+\Delta t}\big(I(\tau)-E(\tau)-Q(\tau)-W(\tau)\big)\,\mathrm{d}\tau $$
    其中 $I, E, Q$ 分别为入渗、[蒸散](@entry_id:180694)和径流。任何在接口处的插值或聚合操作都必须是守恒的。

-   **能量守恒（Energy consistency）**：类似的，与物质流相关的能量流也必须保持一致。一个关键的例子是蒸散发。蒸散发既是一个水的质量通量 $E(t)$，也是一个能量通量，即[潜热通量](@entry_id:1127093) $LE(t)$。两者通过[汽化潜热](@entry_id:142174) $L_v$ 严格关联：$LE(t) = L_v E(t)$。如果ABM中的人类活动（如灌溉）改变了地表水分可利用性，从而影响了蒸散发率 $E(t)$，那么这个变化必须一致地反映在潜热通量 $LE(t)$ 上，进而影响地表能量平衡（$R_n = H + LE + G$）中其他通量（如感热通量 $H$ 和[地表热通量](@entry_id:1125826) $G$）的分配。

### [涌现现象](@entry_id:145138)

多[主体建模](@entry_id:195154)最引人入胜的特征是**涌现（Emergence）**。涌现是指在宏观层面出现的、稳定的、非平凡的模式、结构或规律，而这些规律并未在微观层面的主体规则中被明确指定。它们是从大量主体遵循简单局部规则进行交互的过程中“自下而上”产生的。

在科学哲学和[复杂性科学](@entry_id:191994)中，涌现被区分为两种类型：

-   **弱涌现（Weak Emergence）**：宏观模式**附随（supervene）**于微观状态，意味着宏观状态完全由微观状态及其动态规则所决定。原则上，宏观行为是可以通过微观规则计算或推导出来的，即使在实践中这种推导可能极其困难，甚至需要通过模拟一步步地运行才能得知结果（即“[计算不可约性](@entry_id:270849)”）。所有基于算法的[计算模型](@entry_id:637456)，包括ABM，所展现的涌现都属于弱涌现。

-   **强涌现（Strong Emergence）**：宏观模式具有[本体论](@entry_id:909103)上的新颖性，拥有无法还原到微观层面解释的、全新的因果力量，甚至可以“向下因果”（downward causation）地影响微观组分。这构成了对微观层面因果[闭合性](@entry_id:1122501)的违背。强涌现是一个极具争议的哲学概念，在[计算模型](@entry_id:637456)中通常不被认为可能发生。

既然ABM展示的是弱涌现，那么科学上的任务是识别出那些有意义的、非琐碎的涌现模式。一个宏观规律被认为是显著的涌现现象，通常需要满足以下标准：

-   **鲁棒性（Robustness）**：模式在初始条件、模型参数或随机噪声有微小扰动的情况下依然能够稳定存在。
-   **[有限尺寸标度](@entry_id:142952)（Finite-size scaling）**：随着主体数量 $N$ 的增加，模式变得更加清晰，统计涨落减小。在 $N \to \infty$ 的极限下，宏观动态可能收敛到一个低维的确定性方程。
-   **[置换不变性](@entry_id:753356)（Permutation invariance）**：[宏观可观测量](@entry_id:751601)（如平均值）不依赖于主体的具体身份标签。
-   **算法/预测压缩（Algorithmic/predictive compression）**：对宏观行为的描述远比描述整个微观轨迹要简单得多。例如，用一个宏观[稳态](@entry_id:139253)值来描述系统，远比记录每个主体在每一时刻的状态要简洁。

### 方法论基础：模拟与实验

最后，我们将探讨支撑ABM作为一种科学工具的两个关键方法论问题：模拟的执行机制和实验的设计与有效性。

#### 模拟动力学：调度机制

在离散时间的ABM中，主体是按什么顺序更新其状态的？这个问题由**调度（scheduling）**机制决定，不同的调度方式可能导致截然不同的模型行为，甚至产生非物理的“计算假象”（numerical artifacts）。

-   **同步调度（Synchronous updating）**：在一个时间步内，所有主体都基于时间 $t$ 的同一个旧状态来计算它们的下一步行动，然后所有行动被“同时”施加，产生时间 $t+\Delta t$ 的新状态。这种方式简单直观，但可能导致[资源竞争](@entry_id:191325)中的逻辑问题。例如，如果一个单位的资源同时被两个主体看到并决定获取，同步调度会导致资源被重复计算，产生负的资源量。

-   **异步调度（Asynchronous updating）**：在一个时间步内，主体按一定顺序逐一更新。每个主体在决策时，都会看到已经被更新过的最新系统状态。这避免了同步调度中的“同时性”问题。更新顺序可以是**确定性的**（如按主体ID顺序），但这可能引入系统性偏差（排在前面的主体总是有优先权）；也可以是**随机的**（如每一步都随机打乱顺序），这可以消除偏差，但引入了额外的随机性。

-   **事件驱动调度（Event-driven scheduling）**：这种方式放弃了固定的时间步 $\Delta t$，转而将时间视为连续的。每个主体或每个潜在的行动都与一个“事件时钟”相关联（例如，一个指数分布的等待时间）。模拟直接跳到下一个最近的事件发生的时间点。这种方法从根本上解决了同时性问题（两个事件在连续时间上恰好同时发生的概率为零），能够最精确地表示行动的因果序列，但实现起来可能更复杂。

#### 科学有效性：[可复现性](@entry_id:151299)与[实验设计](@entry_id:142447)

为了使ABM研究成为一项严谨的科学活动，我们必须关注其结果的有效性和可靠性。

-   **[可复现性](@entry_id:151299)（Reproducibility）**与**可复制性（Replicability）**：这两个概念对于计算科学至关重要。
    -   **可复现性**指的是，给定**相同的代码、相同的输入数据和参数、以及相同的[伪随机数](@entry_id:196427)种子**，能够得到完全相同的数值结果。这是计算实验的基本要求。
    -   **可复制性**指的是，由一个**独立的团队，使用独立的模型代码**，遵循原始研究的[实验设计](@entry_id:142447)和理论假设，能够得到与原始发现**统计上一致**的结论。这是验证科学发现稳健性的更高标准。

-   **[实验设计](@entry_id:142447)（Experimental Design）**：由于ABM通常涉及多个参数，且可能包含随机性，系统性地探索参数空间对于理解模型行为至关重要。常用的[实验设计](@entry_id:142447)方法包括：
    -   **全[因子设计](@entry_id:921332)（Full Factorial Design）**：测试所有参数水平的所有可能组合。这种方法能够全面地估计参数的**主效应**和**交互效应**。例如，对于两个参数，一个有2个水平，一个有3个水平，全[因子设计](@entry_id:921332)需要 $2 \times 3 = 6$ 组参数组合。
    -   **[拉丁超立方抽样](@entry_id:751167)（Latin Hypercube Sampling, LHS）**：一种分层的随机抽样方法，旨在高效地覆盖高维参数空间。对于 $N$ 个样本，LHS确保在每个参数的一维投影上，其取值范围的每个等概率区间内都恰好有一个样本点。这保证了在每个维度上的边缘分布都是均匀的，是一种比简单[随机抽样](@entry_id:175193)更具空间填充性的高效探索策略。

通过审慎地选择调度机制、严谨地设计计算实验，并清晰地区分[可复现性](@entry_id:151299)与可复制性，我们可以大大增强多主体模型作为探索和理解复杂人类—环境系统工具的科学价值。