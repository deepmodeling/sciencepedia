## 引言
随着全球城市化进程的加速，城市不仅成为人类活动和经济发展的中心，也形成了独特的气候环境，其中最显著的现象便是“[城市热岛效应](@entry_id:169038)”。这种局地气候变化对能源消耗、空气质量和居民健康构成了严峻挑战。为了科学地理解并应对这些挑战，我们亟需能够精确描述城市-大气系统相互作用的物理模型。

本文旨在填补这一知识空白，系统性地介绍[城市冠层模型](@entry_id:1133642)（Urban Canopy Models, UCMs）——一个旨在量化城市复杂下垫面如何改变其与大气之间能量和水分交换的核心理论框架。文章致力于解答一个根本性问题：我们如何将城市独特的建筑形态、材料属性和人类活动，转化为可预测的物理参数，并将其整合到天气和气候模型中？

为此，我们将通过三个层次递进的章节来展开讨论。首先，在“原理与机制”一章中，我们将深入剖析[城市能量平衡](@entry_id:1133646)的基本定律，并揭示[城市冠层模型](@entry_id:1133642)的内部工作机制。接下来，在“应用与跨学科联系”一章，我们将展示这些理论模型如何应用于可持续城市设计、气候变化减缓以及环境公平性评估等现实议题。最后，“动手实践”部分将提供具体的计算练习，帮助读者将理论知识转化为实践技能。

让我们从这一切的基础开始，深入探索支配[城市气候](@entry_id:184294)的物理原理与关键机制。

## 原理与机制

本章旨在系统阐述[城市冠层模型](@entry_id:1133642)（Urban Canopy Models, UCMs）背后的核心物理原理与关键机制。我们将从城市系统能量平衡的基本定律出发，深入探讨城市独特的几何形态如何从根本上改变其与大气的辐射和[湍流](@entry_id:151300)交换过程。随后，我们将详细解析[城市冠层模型](@entry_id:1133642)的内部结构及其关键分量的[参数化](@entry_id:265163)方案，最终阐明这些模型如何作为大气模式的下边界，与更大尺度的气象过程相互耦合。

### 城市[表面能量平衡](@entry_id:188222)（USEB）

任何地表与大气的相互作用都受能量守恒定律的支配。对于城市环境，这一基本原则体现为城市[表面能量平衡](@entry_id:188222)（Urban Surface Energy Balance, USEB）。我们可以通过定义一个包含城市建筑（屋顶、墙壁、道路等）固体结构的控制体来推导此[平衡方程](@entry_id:172166)。根据热力学第一定律，控制体内部能量的变化率等于进出其边界的净[能量通量](@entry_id:266056)。

由此，我们可以建立城市[表面能量平衡](@entry_id:188222)方程，其[标准形式](@entry_id:153058)为：

$Q^{\ast} + Q_A = Q_H + Q_E + \Delta Q_S$

在该方程中，各项的物理意义和符号惯例至关重要 ：

*   **净全波辐射 ($Q^{\ast}$)**：这是城市表面与环境之间所有[辐射交换](@entry_id:150522)的总和。它包括净短波辐射（入射太阳辐射减去反射部分）和净长波辐射（吸收的来自大气和周围表面的长波辐射减去自身发射的长波辐射）。按照气象学惯例，$Q^{\ast}$ 为正值时，表示地表有净的能量增益（即能量输入控制体）。

*   **[湍流](@entry_id:151300)显热通量 ($Q_H$)**：这是由温差驱动的、通过空气[湍流](@entry_id:151300)运动在城市表面和冠层空气之间传递的热量。惯例上，$Q_H$ 为正值时，表示热量从地表输送至空气中，是地表的能量损失项。

*   **[湍流](@entry_id:151300)[潜热通量](@entry_id:1127093) ($Q_E$)**：这部分[能量通量](@entry_id:266056)与城市表面的水[相变过程](@entry_id:147919)有关，主要是蒸发和凝结。蒸发需要消耗能量（蒸发潜热），从而冷却地表；而凝结则会释放能量，加热地表。惯例上，$Q_E$ 为正值时，对应于蒸发过程，代表地表的能量损失。

*   **净储存热通量 ($\Delta Q_S$)**：该项代表城市固体结构（如混凝土、沥青）内部能量的变化率。在白天，城市材料吸收并储存热量，$\Delta Q_S$ 为正值，表现为材料升温。在夜间，储存的热量被释放出来，$\Delta Q_S$ 为负值，表现为材料降温。这是城市区别于许多自然表面的一个关键特征。

*   **[人为热通量](@entry_id:1121055) ($Q_A$)**：此项代表由人类活动直接或间接释放到城市环境中的热量，例如交通工具尾气、建筑物供暖和空调系统排热、工业生产过程以及人体代谢散热等。它通常作为城市系统的额外能量源，因此在方程中为正值。

值得注意的是，在某些特定的控制体定义下，如  中仅包含固体结构的控制体，[人为热](@entry_id:200323)交换可能表现为穿过墙壁或屋顶的传导（如空调系统向建筑内部抽热），此时其符号定义需依据具体的能量流向而定。然而，在考虑整个城市冠层系统（包括空气）时，$Q_A$ 通常指代释放到冠层空气中的热量。

### 能量分配的比较：城市与自然植被表面

城市[表面能量平衡](@entry_id:188222)的独特性，通过与自然植被表面的对比可以得到更清晰的体现。一个关键的区别在于能量在显热通量 ($Q_H$) 和[潜热通量](@entry_id:1127093) ($Q_E$) 之间的分配方式，这通常用 **波恩比（Bowen ratio, $B = Q_H / Q_E$）** 来量化。

城市表面由于大部分由不透水的材料构成，水分可用于蒸发的量非常有限，导致 $Q_E$ 很小。因此，城市的波恩比通常很高（例如，$B > 2$）。相比之下，水分充足的植被表面通过[蒸腾作用](@entry_id:136237)可以耗散大量能量，使得 $Q_E$ 占主导地位，其波恩比通常很低（例如，$B  0.5$）。

这种分配上的差异对地表温度有着深远的影响。考虑一个典型的夏日午后情景，假设城市和植被表面接收到相同的[净辐射](@entry_id:1128562) $Q^{\ast} = 500\,\mathrm{W\,m^{-2}}$ 。

*   对于一个 **城市表面** （假设 $B_u = 5$，[热储](@entry_id:143608)量 $\Delta Q_{S,u} = 100\,\mathrm{W\,m^{-2}}$），可用于[湍流](@entry_id:151300)交换的能量为 $Q^{\ast} - \Delta Q_{S,u} = 400\,\mathrm{W\,m^{-2}}$。这部分能量将被分配为 $Q_{H,u} \approx 333\,\mathrm{W\,m^{-2}}$ 和 $Q_{E,u} \approx 67\,\mathrm{W\,m^{-2}}$。高额的显热通量需要一个显著的表面-空气温差来驱动，计算可得温差约为 $13.8\,\mathrm{K}$。

*   对于一个 **水分充足的植被表面** （假设 $B_v = 0.3$，[土壤热通量](@entry_id:1131878) $G_v = 50\,\mathrm{W\,m^{-2}}$），可用于[湍流](@entry_id:151300)交换的能量为 $Q^{\ast} - G_v = 450\,\mathrm{W\,m^{-2}}$。由于波恩比很低，大部分能量通过潜热形式耗散，分配为 $Q_{H,v} \approx 104\,\mathrm{W\,m^{-2}}$ 和 $Q_{E,v} \approx 346\,\mathrm{W\,m^{-2}}$。相对较小的显热通量仅需约 $8.6\,\mathrm{K}$ 的表面-空气温差。

计算结果表明，在这种条件下，城市表面温度将比植被表面高出约 $5.2\,\mathrm{K}$。这一差异清晰地揭示了[城市热岛效应](@entry_id:169038)的一个核心物理机制：由于蒸发冷却作用受限，[净辐射](@entry_id:1128562)能量被迫更多地转化为显热，从而显著推高了城市的地表温度 。此外，城市材料巨大的热容量（体现为较大的 $\Delta Q_S$）也扮演着重要角色，它在白天吸收热量，延缓了午后最高温的出现，并在夜间释放热量，减缓了降温速率，加剧了夜间的热岛效应。

### 城市形态对能量交换的影响

城市并非平坦的均质表面，其三维结构——由建筑和街道构成的复杂几何形态——深刻地改变了能量交换的过程。城市[形态学](@entry_id:273085)参数，如 **峡谷高宽比 ($\lambda = H/W$，其中 $H$ 为建筑高度，$W$ 为街道宽度)** 和 **建筑平面[面积分](@entry_id:275394)数 ($\lambda_p$)**，是量化这种影响的关键指标 。

#### [辐射交换](@entry_id:150522)与城市几何学

城市峡谷的几何结构通过两种主要方式调制辐射收支：**辐射捕获** 和 **天空视角因子** 的改变。

首先，在短波辐射方面，城市峡谷结构增强了 **辐射捕获（radiation trapping）** 效应。当[太阳辐射](@entry_id:181918)进入峡谷后，一部分被地表反射。在深而窄的峡谷中（即高 $\lambda$ 值），被反射的光子更有可能撞击到对面的墙壁而不是直接逃逸回天空。每一次额外的反射都伴随着部分能量的吸收。这种多次反射过程导致整个城市系统的 **有效[反照率](@entry_id:188373) ($\alpha_{eff}$)** 低于构成其表面的材料（如混凝土、沥青）的固有[反照率](@entry_id:188373)。因此，增加高宽比 $\lambda$ 会降低有效[反照率](@entry_id:188373)，从而增加城市对太阳辐射的总吸收量 。

其次，在长波辐射方面，峡谷几何结构改变了每个表面的 **天空视角因子 ($\Psi_s$)**。天空视角因子定义了一个表面所能“看到”天空的半球空间比例。在峡谷内部，一个表面的 $\Psi_s$ 远小于1，因为大部分天空被相邻的建筑墙体遮挡。在夜间，天空是一个有效的辐射[冷源](@entry_id:139417)，而周围的建筑墙体则相对温暖。较小的天空视角因子意味着表面向寒冷天空的净长波[辐射损失](@entry_id:1130499)减少，同时从温暖的相邻墙面接收到更多的长波辐射。这种效应显著减缓了夜间的冷却速率。我们可以通过对一个城市表面单元 $i$ 的净长波辐射进行精确推导来理解这一点 。其吸收的有效下行长波辐射 $L_{\downarrow,\text{eff},i}$ 不仅包括来自天空的部分 ($F_{i\to \text{sky}}\,L_{\text{sky}}$)，还包括来自周围其他表面 $j$ 的辐射贡献 ($\sum_{j} F_{i\to j}\,\epsilon_j \sigma T_j^4$)，其中 $F$ 是视角因子。

为了将这些发生在各个表面（屋顶、墙壁、道路）上的复杂[辐射交换](@entry_id:150522)过程整合为整个城市网格的平均通量，我们需要进行尺度上推（upscaling）。网格尺度的净辐射 $Q^{\ast}$ （单位：$\mathrm{W\,m^{-2}}$，基于平面面积）是通过对每个表面类型 $i$ 的净辐射通量密度 $R^{\ast}_i$（单位：$\mathrm{W\,m^{-2}}$，基于该表面自身面积）进行面积加权求和得到的 。其计算公式为：

$Q^{\ast} = f_r R^{\ast}_r + f_g R^{\ast}_g + \Lambda_w R^{\ast}_w$

其中，$f_r$ 和 $f_g$ 分别是屋顶和道路的平面[面积分](@entry_id:275394)数，而 $\Lambda_w$ 是 **墙体面积指数**（单位平面面积上的墙体总面积）。这个指数通常大于1，反映了城市表面的三维特性。通过这个公式，模型的计算结果从微观的表面单元尺度被整合为宏观的网格平均值。

#### [湍流](@entry_id:151300)交换与城市几何学

城市的三维形态同样是影响其与大气间[湍流](@entry_id:151300)交换效率的关键因素。这种影响主要通过改变地表的空气动力学特性来实现。

城市建筑群作为大型粗糙元，对大气流动产生显著的拖曳作用。这种作用可以通过两个[空气动力学](@entry_id:193011)参数来描述：**零平面位移高度 ($d$)** 和 **[空气动力学](@entry_id:193011)粗糙度长度 ($z_0$)**。$d$ 可以理解为气流感觉到的“有效”地表高度，而 $z_0$ 则量化了地表对气流产生[湍流](@entry_id:151300)扰动的能力。一般而言，更高、更密集的建筑布局（即更大的 $\lambda$ 和 $\lambda_p$）会导致 $d$ 和 $z_0$ 的值增加，意味着地表在空气动力学上更为“粗糙”。

根据 **[Monin-Obukhov相似性理论](@entry_id:1128126)（MOST）**，在中性层结条件下，近地层风速廓线遵循对数律。对于给定的参考高度上的风速，更粗糙的表面（即更大的 $d$ 和 $z_0$）会产生更强的[湍流混合](@entry_id:202591)，这表现为更大的 **摩擦速度 ($u_*$)**。[摩擦速度](@entry_id:267882)是衡量[湍流强度](@entry_id:1133493)和动量输送效率的指标。因此，更粗糙的城市形态会增强[湍流](@entry_id:151300)交换，从而影响 $Q_H$ 和 $Q_E$ 的大小 。

在城市峡谷内部，风场结构也极为复杂。当气流垂直于街道轴线（即横穿峡谷）时，会在[迎风](@entry_id:756372)侧建筑的顶部发生气流分离，形成一个跨越峡谷顶部的剪切层。这个剪切层通过[湍流](@entry_id:151300)卷吸作用，驱动峡谷内部的空气形成一个稳定的大尺度环流——即 **主涡旋（primary vortex）**。这个涡旋的形态和强度与峡谷的高宽比 $\lambda$ 密切相关，形成了不同的流态 ：
*   **孤立粗糙元[流态](@entry_id:152820)（$\lambda \lesssim 0.5$）**：峡谷较浅，气流可以在峡谷底部再附着，未能形成稳定的峡谷尺度涡旋。
*   **尾流干涉[流态](@entry_id:152820)（$0.5 \lesssim \lambda \lesssim 1$）**：峡谷深度适中，形成一个涡旋，但其与下游建筑的相互作用较强，可能不稳定。
*   **掠流流态（$\lambda \gtrsim 1$）**：峡谷很深，顶部[剪切层](@entry_id:274623)像桥梁一样跨过峡谷，内部形成一个稳定而孤立的涡旋，与上方气流的直接交换减弱。

这些[内部流动](@entry_id:155636)机理为[城市冠层模型](@entry_id:1133642)中[参数化](@entry_id:265163)峡谷内风速和[湍流](@entry_id:151300)交换提供了物理基础。

### 模拟[城市能量平衡](@entry_id:1133646)：[城市冠层模型](@entry_id:1133642)（UCM）

为了在天气和气候模型中再现上述复杂的物理过程，研究人员开发了[城市冠层模型](@entry_id:1133642)（UCMs）。这些模型将城市下垫面[参数化](@entry_id:265163)，以计算其与大气的能量和水分交换。

#### 单层[城市冠层模型](@entry_id:1133642)（SLUCM）的核心结构

单层[城市冠层模型](@entry_id:1133642)（Single-Layer Urban Canopy Model, SLUCM）是一种广泛应用的UCM。它将城市网格简化为一个具有代表性几何形状的二维街道峡谷，包含屋顶、墙壁和道路三个基本表面类型，以及一个被视为均匀混合的峡谷空气体。

一个典型的SLUCM通过求解一组耦合的[微分](@entry_id:158422)方程来预测系统的状态演变。其核心 **预报变量** 通常包括 ：
*   三个表面的温度：屋顶温度 $T_{rf}$、墙壁温度 $T_w$ 和道路温度 $T_r$。
*   峡谷空气的温度 $T_c$。
*   峡谷内特征风速 $U_c$。

这些变量的控制方程源于对每个组分（各表面和峡谷空气）应用[能量和动量守恒](@entry_id:193044)定律。例如：
*   **[表面能量平衡](@entry_id:188222)方程**：对于每个表面 $s$（如屋顶），其温度变化率由以下各项决定：
    $C_s \frac{dT_s}{dt} = R_{n,s} - H_s - G_s + Q_{A,s}$
    其中 $C_s$ 是表面的热容量，$R_{n,s}$ 是该表面的净辐射，$H_s$ 是与相邻空气的显热交换，$G_s$ 是向下方材料传导的热通量（即储存项），$Q_{A,s}$ 是施加在该表面的任何[人为热](@entry_id:200323)源。$H_s$ 的计算需要区分表面类型：屋顶与上层大气交换，而墙壁和道路则与峡谷空气交换。

*   **峡谷空气能量平衡方程**：峡谷空气的温度变化取决于从墙壁和道路获得的显热、与上层大气的热量交换以及释放到峡谷空气中的[人为热](@entry_id:200323)：
    $C_a \frac{dT_c}{dt} = H_r + H_w - H_{\mathrm{ex}} + Q_{A,c}$
    其中 $H_r$ 和 $H_w$ 分别是来自道路和墙壁的显热通量，$H_{\mathrm{ex}}$ 是峡谷空气与上层大气在屋顶高度的交换通量。

通过这样一套方程组，SLUCM能够动态地模拟城市冠层内部的热力学过程，并计算出与大气交换的总通量。

#### 基底热储存（$\Delta Q_S$）的模拟

基底[热储](@entry_id:143608)存项 $\Delta Q_S$（或 $G_s$）的准确模拟对捕捉城市[热力学](@entry_id:172368)行为的日循环特征至关重要。主要有两种方法 ：

1.  **多层扩散方案（Multi-layer Diffusion Schemes）**：这是一种基于物理的方法，它将建筑材料（如墙壁、道路）在垂直方向上离散为多个层次，并数值求解一维[热传导方程](@entry_id:194763) $\frac{\partial T}{\partial t} = \kappa \frac{\partial^2 T}{\partial z^2}$（其中 $\kappa$ 是[热扩散率](@entry_id:144337)）。这种方法能够物理地再现热浪在材料中传播时的 **振幅衰减** 和 **[相位延迟](@entry_id:186355)**。热浪的[穿透深度](@entry_id:136478)由 **[热穿透深度](@entry_id:150743) ($\delta = \sqrt{2\kappa/\omega}$)** 决定，其中 $\omega$ 是强迫频率（如日循环频率）。

2.  **力-恢复法（Force-Restore Methods）**：这是一种计算上更经济的经验方法。它不直接求解[热传导方程](@entry_id:194763)，而是用一个或两个预报温度来代表整个基底。例如，一个简单的力-恢复法模型通过一个“恢复项”来模拟深层材料对表层温度的约束作用，以此来体现基底的热惯性。通过对特定频率（如日循环）进行校准，力-恢复法可以有效地模拟出与多层扩散方案相似的表面温度响应。例如，对于一个半无限固体，在[谐波](@entry_id:181533)热通量强迫下，表面温度会滞后于热通量 $\pi/4$ (或45度) 的相位。这个特性，以及 **热导纳（thermal admittance, $\sqrt{k \rho c \omega}$）** 的概念，可以用来校准力-恢复法的参数。

#### UCM与大气模型的耦合

UCM本身只是一个地表模型，它的价值在于作为更大尺度的大气模型（如WRF）的下边界条件。然而，这种耦合并非简单地将两者连接起来。

城市粗糙元的存在，使得冠层上方的气流在一个被称为 **城市粗糙度子层（urban roughness sublayer, RSL）** 的区域内具有高度的空间非均匀性。在这个层内，由时均流场空间偏差引起的 **离散应力（dispersive stress）** 与传统的[湍流](@entry_id:151300)雷诺应力同样重要。而经典的大气边界层理论——[Monin-Obukhov相似性理论](@entry_id:1128126)（MOST）——其基本假设（如水平均匀性、通量定常）在RSL中并不成立。只有在更高的高度，即所谓的 **混合高度（blending height, $z_b$）** 之上，由各个建筑物产生的尾流充分混合，气流才恢复水平均匀性，MOST才开始适用 。$z_b$ 的高度通常是平均建筑高度 $H$ 的2到5倍。

因此，UCM与大气模型的耦合必须在物理上保持一致。这是一个双向交换过程 ：

*   **从大气模型到UCM**：大气模型向UCM提供其最低模式层的气象强迫条件，包括下行的短波和长波辐射 ($S^\downarrow, L^\downarrow$)、风速、气温和湿度。

*   **从UCM到大气模型**：UCM计算完毕后，将响应反馈给大气模型。这包括：
    *   **[辐射通量](@entry_id:151732)**：上行短波辐射（由有效[反照率](@entry_id:188373)决定）和上行长波辐射（由各表面温度决定），用于大气辐射收支的闭合。
    *   **[湍流通量](@entry_id:1133513)**：总的显热通量 $Q_H$ 和潜热通量 $Q_E$，作为大气最低层的热量和水分源/汇项。
    *   **[动量通量](@entry_id:199796)**：通常以[摩擦速度](@entry_id:267882) $u_*$ 或动量应力 $\tau$ 的形式提供。
    *   **空气动力学参数**：有效的粗糙度长度 $z_0$、零平面位移高度 $d$ 以及热量粗糙度长度 $z_{0h}$ 等，供大气模型的边界层方案使用。

通过这种精细的、基于物理的耦合，UCM使得天气和气候模型能够更真实地模拟城市对其上空大气的影响，从而提高了对城市热岛、空气污染、局地环流等现象的预报和研究能力。