{
    "hands_on_practices": [
        {
            "introduction": "准确地核算能量是任何气候或天气模型的基石。本练习将实践计算水在经历相变（例如结冰）过程中的总焓变，通过引入随温度变化的比热容，我们得以超越中学物理中简化的计算方法。这项练习旨在帮助你建立对模型在相变过程中如何追踪能量收支的基础理解。",
            "id": "3906261",
            "problem": "在地球系统模型的水凝物热力学中，水的相变和温度变化的能量收支通过比焓进行追踪。考虑一个包含 $m=1\\,\\mathrm{kg}$ 纯水的水块，其压力为 $1\\,\\mathrm{bar}$，初始温度为 $T_i=5\\,^{\\circ}\\mathrm{C}$，通过在 $T_m=0\\,^{\\circ}\\mathrm{C}$ 的平衡冻结过程冷却至 $T_f=-5\\,^{\\circ}\\mathrm{C}$。在恒定压力下，比焓的变化是通过对随温度变化的定压比热容进行积分，并计入相变时的熔化潜热来获得的。假设在 $T_m$ 附近的窄区间内，液态水和冰的随温度变化的比热由下式给出\n$$c_{p,\\mathrm{liq}}(T)=\\alpha_0+\\alpha_1\\left(T-273.15\\,\\mathrm{K}\\right),\\quad c_{p,\\mathrm{ice}}(T)=\\beta_0+\\beta_1\\left(T-273.15\\,\\mathrm{K}\\right),$$\n其中 $\\alpha_0=4.217\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$，$\\alpha_1=-1.5\\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}$，$\\beta_0=2.090\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$，以及 $\\beta_1=8.0\\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}$。取在 $1\\,\\mathrm{bar}$ 压力下，$T_m$ 时的熔化潜热（熔点处的焓跃变）为 $L_f=334\\,\\mathrm{kJ\\,kg^{-1}}$。\n\n以定压比热容和熔化潜热的定义为基本依据，通过将液态水在 $T_m$ 以上的感热冷却、在 $T_m$ 的潜热以及冰在 $T_m$ 以下的感热冷却相加，计算将水块从 $T_i$ 冷却并冻结到 $T_f$ 所需移除的总能量。以 $\\mathrm{kJ}$ 为单位表示最终能量，并将您的答案四舍五入到四位有效数字。",
            "solution": "### 解答\n将水块从初始温度 $T_i$ 冷却到最终温度 $T_f$，并在熔点温度 $T_m$ 发生相变，所需移除的总能量是三个组成部分之和：\n1.  将液态水从 $T_i$ 冷却到 $T_m$ 所移除的感热，记为 $\\Delta Q_1$。\n2.  在 $T_m$ 将液体冻结成冰所移除的潜热，记为 $\\Delta Q_2$。\n3.  将冰从 $T_m$ 冷却到 $T_f$ 所移除的感热，记为 $\\Delta Q_3$。\n\n移除的总能量为 $\\Delta Q = \\Delta Q_1 + \\Delta Q_2 + \\Delta Q_3$。在恒定压力下，质量为 $m$ 的物质在温度变化过程中移除的热量由比热容 $c_p(T)$ 的积分给出。\n\n首先，转换温度单位，并注意比热表达式中的参考温度 $T_m=273.15\\,\\mathrm{K}$。\n$T_i = 5\\,^{\\circ}\\mathrm{C} = 278.15\\,\\mathrm{K}$\n$T_m = 0\\,^{\\circ}\\mathrm{C} = 273.15\\,\\mathrm{K}$\n$T_f = -5\\,^{\\circ}\\mathrm{C} = 268.15\\,\\mathrm{K}$\n\n1.  **从液态水中移除的感热 ($\\Delta Q_1$)**：\n将液态水从 $T_i$ 冷却到 $T_m$ 时移除的能量是：\n$$ \\Delta Q_1 = m \\int_{T_m}^{T_i} c_{p,\\mathrm{liq}}(T) dT = m \\int_{T_m}^{T_i} \\left[ \\alpha_0 + \\alpha_1(T - T_m) \\right] dT $$\n进行积分：\n$$ \\Delta Q_1 = m \\left[ \\alpha_0 T + \\alpha_1 \\left( \\frac{T^2}{2} - T_m T \\right) \\right]_{T_m}^{T_i} $$\n$$ \\Delta Q_1 = m \\left( \\alpha_0 (T_i - T_m) + \\frac{\\alpha_1}{2} (T_i^2 - T_m^2) - \\alpha_1 T_m (T_i - T_m) \\right) $$\n$$ \\Delta Q_1 = m (T_i - T_m) \\left( \\alpha_0 + \\frac{\\alpha_1}{2} (T_i + T_m) - \\alpha_1 T_m \\right) = m (T_i - T_m) \\left( \\alpha_0 + \\frac{\\alpha_1}{2} (T_i - T_m) \\right) $$\n代入数值：$m = 1\\,\\mathrm{kg}$, $T_i - T_m = 5\\,\\mathrm{K}$, $\\alpha_0 = 4.217\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$, $\\alpha_1 = -1.5 \\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}$。\n$$ \\Delta Q_1 = (1\\,\\mathrm{kg}) \\times (5\\,\\mathrm{K}) \\times \\left( 4.217\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}} + \\frac{-1.5 \\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}}{2} (5\\,\\mathrm{K}) \\right) $$\n$$ \\Delta Q_1 = 5 \\times ( 4.217 - 0.00375 ) \\,\\mathrm{kJ} = 5 \\times 4.21325 \\,\\mathrm{kJ} = 21.06625\\,\\mathrm{kJ} $$\n\n2.  **冻结过程中移除的潜热 ($\\Delta Q_2$)**：\n在恒温 $T_m$ 下相变过程中移除的能量是质量与比熔化潜热 $L_f$ 的乘积。\n$$ \\Delta Q_2 = m L_f = (1\\,\\mathrm{kg}) \\times (334\\,\\mathrm{kJ\\,kg^{-1}}) = 334\\,\\mathrm{kJ} $$\n\n3.  **从冰中移除的感热 ($\\Delta Q_3$)**：\n将冰从 $T_m$ 冷却到 $T_f$ 时移除的能量是：\n$$ \\Delta Q_3 = m \\int_{T_f}^{T_m} c_{p,\\mathrm{ice}}(T) dT = m \\int_{T_f}^{T_m} \\left[ \\beta_0 + \\beta_1(T - T_m) \\right] dT $$\n进行积分：\n$$ \\Delta Q_3 = m \\left[ \\beta_0 T + \\beta_1 \\left( \\frac{T^2}{2} - T_m T \\right) \\right]_{T_f}^{T_m} $$\n$$ \\Delta Q_3 = m \\left( \\beta_0 (T_m - T_f) - \\frac{\\beta_1}{2} (T_m^2 - 2T_m T_f + T_f^2) \\right) = m \\left( \\beta_0 (T_m - T_f) - \\frac{\\beta_1}{2} (T_m - T_f)^2 \\right) $$\n代入数值：$m = 1\\,\\mathrm{kg}$, $T_m - T_f = 5\\,\\mathrm{K}$, $\\beta_0 = 2.090\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$, $\\beta_1 = 8.0 \\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}$。\n$$ \\Delta Q_3 = (1\\,\\mathrm{kg}) \\times \\left( (2.090\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}) (5\\,\\mathrm{K}) - \\frac{8.0 \\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}}{2} (5\\,\\mathrm{K})^2 \\right) $$\n$$ \\Delta Q_3 = ( 10.45 - 4.0 \\times 10^{-3} \\times 25 ) \\,\\mathrm{kJ} $$\n$$ \\Delta Q_3 = ( 10.45 - 0.1 ) \\,\\mathrm{kJ} = 10.35\\,\\mathrm{kJ} $$\n\n4.  **移除的总能量 ($\\Delta Q$)**：\n$$ \\Delta Q = \\Delta Q_1 + \\Delta Q_2 + \\Delta Q_3 = 21.06625\\,\\mathrm{kJ} + 334\\,\\mathrm{kJ} + 10.35\\,\\mathrm{kJ} = 365.41625\\,\\mathrm{kJ} $$\n四舍五入到四位有效数字：\n$$ \\Delta Q \\approx 365.4\\,\\mathrm{kJ} $$",
            "answer": "$$\n\\boxed{365.4}\n$$"
        },
        {
            "introduction": "为了节约计算成本，真实世界的模型常常采用简化处理。本练习将探讨一种常见的简化方法：将潜热视为常数。通过从第一性原理推导潜热随温度变化的表达式，并将其与常数值进行比较，你将能够量化这种假设所引入的误差，从而学习模型评估中的一项关键技能，并理解模型准确性与计算效率之间的权衡。",
            "id": "3906259",
            "problem": "考虑一个数值大气柱模型中的干空气块，其中水的相变引起的潜热加热是参数化的。该空气块经历的相变过程被假定在短时间内是局部等压的。汽化潜热（表示为 $L_v$）和熔化潜热（表示为 $L_f$）是关联焓变与相变的热力学量。\n\n使用以下基本依据推导与温度相关的潜热：\n\n1. 相变的潜热是两相的比焓之差。对于汽化，$L_v(T) = h_v(T) - h_l(T)$；对于熔化，$L_f(T) = h_l(T) - h_i(T)$，其中 $h_v$、$h_l$ 和 $h_i$ 分别是水蒸气、液态水和冰的比焓，而 $T$ 是温度。\n2. 定压比热定义为 $c_p = \\left(\\frac{\\partial h}{\\partial T}\\right)_p$。假设在所关注的温度范围内，$c_{p,v}$、$c_{p,l}$ 和 $c_{p,i}$ 相对于 $T$ 是常数。\n3. 热力学第一定律（空气块的能量守恒）将加热率与焓变联系起来。对于以单位质量速率 $\\dot{q}$ 发生的相变，单位质量的潜热加热率为 $H(T) = L(T)\\,\\dot{q}$，其中 $L(T)$ 是适用于该相变路径的潜热，$\\dot{q}$ 是水蒸气质量分数转化为凝结相的速率，单位为 $\\mathrm{s^{-1}}$。\n\n假设以下科学上合理的常数和参考值：\n- 参考温度 $T_0 = 273.15\\,\\mathrm{K}$。\n- 在 $T_0$ 时的汽化潜热：$L_v(T_0) = 2.500\\times 10^6\\,\\mathrm{J\\,kg^{-1}}$。\n- 在 $T_0$ 时的熔化潜热：$L_f(T_0) = 3.340\\times 10^5\\,\\mathrm{J\\,kg^{-1}}$。\n- 定压比热（在 $-40\\,^\\circ\\mathrm{C}$ 到 $40\\,^\\circ\\mathrm{C}$ 范围内视为常数）：$c_{p,v} = 1850\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$c_{p,l} = 4181\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$c_{p,i} = 2106\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n\n微物理路径的建模假设：\n- 对于温度 $T \\ge T_0$，凝结产生液态水，潜热加热使用 $L_v(T)$。\n- 对于温度 $T  T_0$，凝华直接从水蒸气产生冰，潜热加热使用升华潜热 $L_s(T) = L_v(T) + L_f(T)$。\n\n一个常见的建模简化是将 $L_v$ 和 $L_f$ 视为与温度无关的常数，使用 $L_v(T) \\approx L_v(T_0)$ 和 $L_f(T) \\approx L_f(T_0)$，因此恒定的升华潜热为 $L_s^{\\mathrm{const}} = L_v(T_0) + L_f(T_0)$。\n\n任务：\n- 仅使用上述基本依据，在比热在给定范围内与温度无关的假设下，推导出 $L_v(T)$ 和 $L_f(T)$ 作为 $T$ 的函数表达式。\n- 对于下面的每个测试用例，计算单位质量潜热加热率的绝对误差 $E_a = \\left|H_{\\mathrm{const}}(T) - H(T)\\right|$（单位为 $\\mathrm{W\\,kg^{-1}}$），其中 $H_{\\mathrm{const}}(T)$ 是用恒定潜热计算的加热率，$H(T)$ 是用与温度相关的潜热计算的加热率。同时计算相对误差 $E_f = \\frac{H_{\\mathrm{const}}(T) - H(T)}{H(T)}$（以小数表示）。如果 $H(T) = 0$，则定义 $E_f = 0$。\n\n测试组：\n- 情况1：温度 $T = -40\\,^\\circ\\mathrm{C}$，凝结速率 $\\dot{q} = 2.0\\times 10^{-5}\\,\\mathrm{s^{-1}}$。\n- 情况2：温度 $T = -5\\,^\\circ\\mathrm{C}$，凝结速率 $\\dot{q} = 5.0\\times 10^{-5}\\,\\mathrm{s^{-1}}$。\n- 情况3：温度 $T = 0\\,^\\circ\\mathrm{C}$，凝结速率 $\\dot{q} = 1.0\\times 10^{-4}\\,\\mathrm{s^{-1}}$。\n- 情况4：温度 $T = 20\\,^\\circ\\mathrm{C}$，凝结速率 $\\dot{q} = 1.5\\times 10^{-4}\\,\\mathrm{s^{-1}}$。\n- 情况5：温度 $T = 40\\,^\\circ\\mathrm{C}$，凝结速率 $\\dot{q} = 1.0\\times 10^{-5}\\,\\mathrm{s^{-1}}$。\n- 情况6（边界情况）：温度 $T = 10\\,^\\circ\\mathrm{C}$，凝结速率 $\\dot{q} = 0\\,\\mathrm{s^{-1}}$。\n\n将绝对误差以 $\\mathrm{W\\,kg^{-1}}$ 表示，相对误差以小数表示。您的程序应生成一行输出，包含一个用方括号括起来的逗号分隔列表，其中每个条目是一个双元素列表 $[E_a,E_f]$，按顺序对应于测试用例（例如，`[[x_1,y_1],[x_2,y_2],\\dots]`）。输入中的温度单位为摄氏度，但所有热力学计算必须以开尔文进行。",
            "solution": "### 求解过程\n\n求解过程分两部分进行：首先，推导与温度相关的潜热；其次，应用这些推导出的公式计算每个测试用例所需的误差度量。为保证热力学上的一致性，所有温度都必须以开尔文处理。\n\n**第 1 部分：与温度相关的潜热的推导**\n\n推导基于所提供的基本定义。相变潜热对温度的依赖关系可以通过对其定义相对于温度求导来找到。\n\n对于汽化潜热 $L_v(T) = h_v(T) - h_l(T)$，我们对其在恒定压力 $p$ 下相对于温度 $T$ 求导：\n$$\n\\frac{d L_v}{d T} = \\left(\\frac{\\partial h_v}{\\partial T}\\right)_p - \\left(\\frac{\\partial h_l}{\\partial T}\\right)_p\n$$\n根据定义，定压比热为 $c_p = \\left(\\frac{\\partial h}{\\partial T}\\right)_p$。将其代入方程得到：\n$$\n\\frac{d L_v}{d T} = c_{p,v} - c_{p,l}\n$$\n鉴于 $c_{p,v}$ 和 $c_{p,l}$ 被假定为常数，我们可以将这个常微分方程从参考温度 $T_0$ 积分到任意温度 $T$：\n$$\n\\int_{L_v(T_0)}^{L_v(T)} dL'_v = \\int_{T_0}^{T} (c_{p,v} - c_{p,l}) dT'\n$$\n$$\nL_v(T) - L_v(T_0) = (c_{p,v} - c_{p,l}) (T - T_0)\n$$\n这给出了与温度相关的汽化潜热的表达式：\n$$\nL_v(T) = L_v(T_0) + (c_{p,v} - c_{p,l})(T - T_0)\n$$\n对熔化潜热 $L_f(T) = h_l(T) - h_i(T)$ 进行类似的推导：\n$$\n\\frac{d L_f}{d T} = \\left(\\frac{\\partial h_l}{\\partial T}\\right)_p - \\left(\\frac{\\partial h_i}{\\partial T}\\right)_p = c_{p,l} - c_{p,i}\n$$\n从 $T_0$ 积分到 $T$：\n$$\nL_f(T) - L_f(T_0) = (c_{p,l} - c_{p,i}) (T - T_0)\n$$\n因此，与温度相关的熔化潜热的表达式为：\n$$\nL_f(T) = L_f(T_0) + (c_{p,l} - c_{p,i})(T - T_0)\n$$\n对于温度 $T  T_0$，问题指定了凝华，这涉及到升华潜热 $L_s(T)$。这是汽化潜热和熔化潜热之和：\n$$\nL_s(T) = L_v(T) + L_f(T)\n$$\n代入推导出的与温度相关的表达式：\n$$\nL_s(T) = [L_v(T_0) + (c_{p,v} - c_{p,l})(T - T_0)] + [L_f(T_0) + (c_{p,l} - c_{p,i})(T - T_0)]\n$$\n$$\nL_s(T) = (L_v(T_0) + L_f(T_0)) + (c_{p,v} - c_{p,l} + c_{p,l} - c_{p,i})(T - T_0)\n$$\n$$\nL_s(T) = L_s(T_0) + (c_{p,v} - c_{p,i})(T - T_0)\n$$\n其中 $L_s(T_0) = L_v(T_0) + L_f(T_0)$。\n\n**第 2 部分：测试用例的误差度量计算**\n\n对于每个测试用例，我们将温度从摄氏度（$T_C$）转换为开尔文（$T$），根据温度确定适当的潜热公式，计算加热率，最后计算误差。\n\n设 $\\Delta T = T - T_0$。\n与温度相关的加热率为 $H(T) = L(T)\\dot{q}$，恒定近似加热率为 $H_{\\mathrm{const}}(T) = L^{\\mathrm{const}}\\dot{q}$。误差为 $E_a = \\left| (L^{\\mathrm{const}} - L(T))\\dot{q} \\right|$ 和 $E_f = (L^{\\mathrm{const}} - L(T)) / L(T)$（对于 $\\dot{q} \\neq 0$）。\n\n常数为：\n- $T_0 = 273.15\\,\\mathrm{K}$\n- $L_v(T_0) = 2.500 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$\n- $L_f(T_0) = 3.340 \\times 10^5\\,\\mathrm{J\\,kg^{-1}}$\n- $L_s^{\\mathrm{const}} = L_v(T_0) + L_f(T_0) = 2.834 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$\n- $\\Delta c_{vl} = c_{p,v} - c_{p,l} = 1850 - 4181 = -2331\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- $\\Delta c_{vi} = c_{p,v} - c_{p,i} = 1850 - 2106 = -256\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n\n每个用例的步骤如下：\n1.  **情况 1: $T_C = -40\\,^\\circ\\mathrm{C}$，$\\dot{q} = 2.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$**\n    $T = 233.15\\,\\mathrm{K}$，因此 $\\Delta T = -40\\,\\mathrm{K}$。由于 $T  T_0$，我们使用升华。\n    $L(T) = L_s(T) = L_s^{\\mathrm{const}} + \\Delta c_{vi} \\Delta T = 2.834 \\times 10^6 + (-256)(-40) = 2844240\\,\\mathrm{J\\,kg^{-1}}$。\n    $L^{\\mathrm{const}} = L_s^{\\mathrm{const}} = 2.834 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$。\n    $H(T) = 2844240 \\times 2.0 \\times 10^{-5} = 56.8848\\,\\mathrm{W\\,kg^{-1}}$。\n    $H_{\\mathrm{const}}(T) = 2.834 \\times 10^6 \\times 2.0 \\times 10^{-5} = 56.68\\,\\mathrm{W\\,kg^{-1}}$。\n    $E_a = |56.68 - 56.8848| = 0.2048\\,\\mathrm{W\\,kg^{-1}}$。\n    $E_f = (56.68 - 56.8848) / 56.8848 \\approx -0.0035999$。\n\n2.  **情况 2: $T_C = -5\\,^\\circ\\mathrm{C}$，$\\dot{q} = 5.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$**\n    $T = 268.15\\,\\mathrm{K}$，因此 $\\Delta T = -5\\,\\mathrm{K}$。由于 $T  T_0$，我们使用升华。\n    $L(T) = L_s(T) = 2.834 \\times 10^6 + (-256)(-5) = 2835280\\,\\mathrm{J\\,kg^{-1}}$。\n    $L^{\\mathrm{const}} = 2.834 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$。\n    $H(T) = 2835280 \\times 5.0 \\times 10^{-5} = 141.764\\,\\mathrm{W\\,kg^{-1}}$。\n    $H_{\\mathrm{const}}(T) = 2.834 \\times 10^6 \\times 5.0 \\times 10^{-5} = 141.7\\,\\mathrm{W\\,kg^{-1}}$。\n    $E_a = |141.7 - 141.764| = 0.064\\,\\mathrm{W\\,kg^{-1}}$。\n    $E_f = (141.7 - 141.764) / 141.764 \\approx -0.0004514$。\n\n3.  **情况 3: $T_C = 0\\,^\\circ\\mathrm{C}$，$\\dot{q} = 1.0 \\times 10^{-4}\\,\\mathrm{s^{-1}}$**\n    $T = 273.15\\,\\mathrm{K} = T_0$，因此 $\\Delta T = 0\\,\\mathrm{K}$。由于 $T \\ge T_0$，我们使用凝结。\n    $L(T) = L_v(T) = L_v(T_0) + \\Delta c_{vl} (0) = L_v(T_0)$。\n    $L^{\\mathrm{const}} = L_v(T_0)$。\n    这里，$L(T) = L^{\\mathrm{const}}$，所以 $E_a = 0.0\\,\\mathrm{W\\,kg^{-1}}$ 且 $E_f = 0.0$。\n\n4.  **情况 4: $T_C = 20\\,^\\circ\\mathrm{C}$，$\\dot{q} = 1.5 \\times 10^{-4}\\,\\mathrm{s^{-1}}$**\n    $T = 293.15\\,\\mathrm{K}$，因此 $\\Delta T = 20\\,\\mathrm{K}$。由于 $T > T_0$，我们使用凝结。\n    $L(T) = L_v(T) = 2.500 \\times 10^6 + (-2331)(20) = 2453380\\,\\mathrm{J\\,kg^{-1}}$。\n    $L^{\\mathrm{const}} = L_v(T_0) = 2.500 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$。\n    $H(T) = 2453380 \\times 1.5 \\times 10^{-4} = 368.007\\,\\mathrm{W\\,kg^{-1}}$。\n    $H_{\\mathrm{const}}(T) = 2.500 \\times 10^6 \\times 1.5 \\times 10^{-4} = 375\\,\\mathrm{W\\,kg^{-1}}$。\n    $E_a = |375 - 368.007| = 6.993\\,\\mathrm{W\\,kg^{-1}}$。\n    $E_f = (375 - 368.007) / 368.007 \\approx 0.0189996$。\n\n5.  **情况 5: $T_C = 40\\,^\\circ\\mathrm{C}$，$\\dot{q} = 1.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$**\n    $T = 313.15\\,\\mathrm{K}$，因此 $\\Delta T = 40\\,\\mathrm{K}$。由于 $T > T_0$，我们使用凝结。\n    $L(T) = L_v(T) = 2.500 \\times 10^6 + (-2331)(40) = 2406760\\,\\mathrm{J\\,kg^{-1}}$。\n    $L^{\\mathrm{const}} = 2.500 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$。\n    $H(T) = 2406760 \\times 1.0 \\times 10^{-5} = 24.0676\\,\\mathrm{W\\,kg^{-1}}$。\n    $H_{\\mathrm{const}}(T) = 2.500 \\times 10^6 \\times 1.0 \\times 10^{-5} = 25\\,\\mathrm{W\\,kg^{-1}}$。\n    $E_a = |25 - 24.0676| = 0.9324\\,\\mathrm{W\\,kg^{-1}}$。\n    $E_f = (25 - 24.0676) / 24.0676 \\approx 0.038740$。\n\n6.  **情况 6: $T_C = 10\\,^\\circ\\mathrm{C}$，$\\dot{q} = 0\\,\\mathrm{s^{-1}}$**\n    由于 $\\dot{q} = 0$， $H(T)$ 和 $H_{\\mathrm{const}}(T)$ 均为零。\n    $E_a = |0 - 0| = 0.0\\,\\mathrm{W\\,kg^{-1}}$。\n    根据问题对 $H(T)=0$ 的定义，$E_f = 0.0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the absolute and fractional errors in latent heating rate\n    when using constant vs. temperature-dependent latent heats.\n    \"\"\"\n    # Define thermodynamic constants and reference values from the problem statement.\n    T_0 = 273.15  # Reference temperature in Kelvin\n    L_v_T0 = 2.500e6  # Latent heat of vaporization at T_0 [J/kg]\n    L_f_T0 = 3.340e5   # Latent heat of fusion at T_0 [J/kg]\n    c_pv = 1850.0  # Specific heat of water vapor [J/kg/K]\n    c_pl = 4181.0  # Specific heat of liquid water [J/kg/K]\n    c_pi = 2106.0  # Specific heat of ice [J/kg/K]\n\n    # Pre-compute derived constants for efficiency and clarity.\n    # Constant latent heat of sublimation\n    L_s_const = L_v_T0 + L_f_T0\n    # Difference in specific heats for vaporization (Kirchhoff's law slope)\n    dc_vl = c_pv - c_pl\n    # Difference in specific heats for sublimation (Kirchhoff's law slope)\n    dc_vi = c_pv - c_pi\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Temperature in Celsius, condensation rate in 1/s)\n    test_cases = [\n        (-40.0, 2.0e-5),\n        (-5.0, 5.0e-5),\n        (0.0, 1.0e-4),\n        (20.0, 1.5e-4),\n        (40.0, 1.0e-5),\n        (10.0, 0.0),\n    ]\n\n    results = []\n    for T_C, q_dot in test_cases:\n        # Convert temperature to Kelvin for thermodynamic calculations.\n        T_K = T_C + T_0\n        delta_T = T_K - T_0\n\n        # Handle the trivial case where there is no phase change.\n        if q_dot == 0.0:\n            E_a = 0.0\n            E_f = 0.0\n            results.append([E_a, E_f])\n            continue\n\n        # Determine the phase change pathway and calculate latent heats.\n        if T_K >= T_0:\n            # Pathway: Condensation (vapor to liquid)\n            # Constant latent heat is L_v at T_0.\n            L_const = L_v_T0\n            # Temperature-dependent latent heat of vaporization.\n            L_T = L_v_T0 + dc_vl * delta_T\n        else:  # T_K  T_0\n            # Pathway: Deposition (vapor to ice)\n            # Constant latent heat is L_s at T_0.\n            L_const = L_s_const\n            # Temperature-dependent latent heat of sublimation.\n            L_T = L_s_const + dc_vi * delta_T\n\n        # Calculate heating rates for both models.\n        H_T = L_T * q_dot\n        H_const = L_const * q_dot\n\n        # Compute the absolute error.\n        E_a = abs(H_const - H_T)\n        \n        # Compute the fractional error, with the specified condition for H(T) = 0.\n        # Note: Since we check q_dot == 0 earlier, H_T will not be zero unless L_T is zero,\n        # which is not physically possible in this model. This check is for robustness.\n        if H_T == 0.0:\n            E_f = 0.0\n        else:\n            E_f = (H_const - H_T) / H_T\n\n        results.append([E_a, E_f])\n\n    # Final print statement in the exact required format '[[ Ea1,Ef1 ],[ Ea2,Ef2 ],...]'.\n    # The str() function on a list will produce the '[item1, item2]' format needed.\n    # The outer f-string and join method assemble the complete payload.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在分析了热力学性质之后，我们将着手构建一个完整的模型组件。本练习将指导你构建一个饱和调整方案，这是大气模型中用于通过形成云来消除过饱和状态的核心算法。它要求你将热力学原理（湿焓守恒）与数值方法（求根）相结合，以创建一个自洽且物理上准确的凝结过程模型。",
            "id": "3906229",
            "problem": "您的任务是实现一个在环境和地球系统建模中用于定压下水相变的饱和调整算法。该算法必须将温度 $T$ 和水汽比湿 $q_v$ 更新到一个饱和状态，此过程通过凝结量为 $\\Delta q_c$ 的液态水来实现，使得最终状态满足饱和条件并保持湿焓守恒。该算法必须从第一性原理推导，并实现为一个完整的、可运行的程序。\n\n需要使用的基本核心定义：\n- 大气是干空气、水汽和液态水的混合物。总水比湿为 $q_t = q_v + q_c$，在凝结过程中守恒，因此 $\\Delta q_c = -\\Delta q_v$ 且 $\\Delta q_t = 0$。\n- 理想气体定律在固定总压 $p$ 下关联了分压和混合比。\n- 具有恒定汽化潜热 $L_v$ 的 Clausius–Clapeyron 关系式给出了作为温度函数的饱和水汽压，\n  $$ e_s(T) = e_0 \\exp\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right), $$\n  其中 $e_0$ 是参考温度 $T_0$ 下的饱和水汽压，$R_v$ 是水汽的气体常数。\n- 在压力 $p$ 下的饱和比湿 $q_{v,\\mathrm{sat}}(T)$ 是从饱和水汽混合比 $r_{v,\\mathrm{sat}}(T)$ 以及比湿和混合比之间的关系得到的。当 $\\varepsilon = R_d / R_v$ 时，有\n  $$ r_{v,\\mathrm{sat}}(T) = \\frac{\\varepsilon\\, e_s(T)}{p - e_s(T)}, \\quad q_{v,\\mathrm{sat}}(T) = \\frac{r_{v,\\mathrm{sat}}(T)}{1 + r_{v,\\mathrm{sat}}(T)} = \\frac{\\varepsilon\\, e_s(T)}{p - (1 - \\varepsilon)\\, e_s(T)}, $$\n  其中 $R_d$ 是干空气的气体常数。\n- 湿焓（每单位质量湿空气）建模为\n  $$ h_m = c_{p,m}(q_v,q_t)\\, T + L_v\\, q_v, $$\n  其中 $c_{p,m}(q_v,q_t)$ 是由下式定义的湿混合物的有效比热容\n  $$ c_{p,m}(q_v,q_t) = (1 - q_t)\\, c_{p,d} + q_v\\, c_{p,v} + (q_t - q_v)\\, c_{p,\\ell}, $$\n  其中 $c_{p,d}$、$c_{p,v}$ 和 $c_{p,\\ell}$ 分别是干空气、水汽和液态水的定压比热。在所考虑的温度范围内，汽化潜热 $L_v$ 被视为常数。\n\n目标状态和约束：\n- 给定初始状态 $(T, p, q_v, q_c)$，算法必须找到一个最终状态 $(T^\\ast, q_v^\\ast, q_c^\\ast)$，使得：\n  1. 定压下的饱和： $$ q_v^\\ast = q_{v,\\mathrm{sat}}(T^\\ast). $$\n  2. 湿焓守恒： $$ c_{p,m}(q_v^\\ast,q_t)\\, T^\\ast + L_v\\, q_v^\\ast = c_{p,m}(q_v,q_t)\\, T + L_v\\, q_v, $$\n     其中 $q_t = q_v + q_c$ 是不变量。\n  3. 凝结物更新： $$ \\Delta q_c = q_c^\\ast - q_c = q_v - q_v^\\ast, $$\n     其中 $$ q_c^\\ast = q_t - q_v^\\ast. $$\n\n求根问题：\n- 结合这些约束，形成一个关于未知数 $T^\\ast$ 的单一标量方程：\n  $$ f(T^\\ast) = c_{p,m}(q_{v,\\mathrm{sat}}(T^\\ast),q_t)\\, T^\\ast + L_v\\, q_{v,\\mathrm{sat}}(T^\\ast) - \\left[c_{p,m}(q_v,q_t)\\, T + L_v\\, q_v\\right] = 0. $$\n- 如果初始状态已经处于或低于饱和状态，即 $q_v \\le q_{v,\\mathrm{sat}}(T)$，则没有凝结发生，最终状态为 $(T^\\ast,q_v^\\ast,q_c^\\ast)=(T,q_v,q_c)$，且 $\\Delta q_c = 0$。\n\n常数和单位：\n- 在算法中使用以下国际单位制 (SI) 常数，并将它们视为固定值：\n  - $c_{p,d} = 1004\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n  - $c_{p,v} = 1860\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n  - $c_{p,\\ell} = 4186\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n  - $L_v = 2.5\\times 10^6\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}$,\n  - $R_d = 287.05\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n  - $R_v = 461.5\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n  - $\\varepsilon = R_d / R_v$,\n  - $T_0 = 273.15\\, \\mathrm{K}$,\n  - $e_0 = 611.2\\, \\mathrm{Pa}$.\n- 输入和输出所需的单位：\n  - 温度必须以开尔文 ($\\mathrm{K}$) 表示。\n  - 压力必须以帕斯卡 ($\\mathrm{Pa}$) 表示。\n  - 比湿 $q_v$、$q_c$ 和 $\\Delta q_c$ 必须表示为无量纲的质量分数（无单位小数）。\n\n算法要求：\n- 当初始状态是过饱和时，实现一个稳健的一维求根器（例如，二分法）来找到满足 $f(T^\\ast)=0$ 的 $T^\\ast$。\n- 确保根的区间界定在科学上是一致的：使用初始温度 $T$ 作为下界，并增加上界直到 $q_{v,\\mathrm{sat}}(T_{\\mathrm{hi}}) \\ge q_v$。\n- 强制要求 $\\Delta q_c \\ge 0$；在未饱和情况下报告 $\\Delta q_c$ 为 $0$。\n- 数值输出必须四舍五入到六位小数。\n\n测试套件：\n提供以下测试用例以验证各种情况（理想路径、未饱和、近饱和边界、包含预先存在的云水以及低压效应）。每个测试用例是一个元组 $(p, T, q_v, q_c)$：\n- 案例 1： $(p = 90000\\, \\mathrm{Pa},\\, T = 285\\, \\mathrm{K},\\, q_v = 0.018,\\, q_c = 0.0)$。\n- 案例 2： $(p = 100000\\, \\mathrm{Pa},\\, T = 298\\, \\mathrm{K},\\, q_v = 0.010,\\, q_c = 0.0)$。\n- 案例 3： $(p = 80000\\, \\mathrm{Pa},\\, T = 273.15\\, \\mathrm{K},\\, q_v = 0.00476,\\, q_c = 0.0)$。\n- 案例 4： $(p = 70000\\, \\mathrm{Pa},\\, T = 265\\, \\mathrm{K},\\, q_v = 0.002,\\, q_c = 0.001)$。\n- 案例 5： $(p = 95000\\, \\mathrm{Pa},\\, T = 280\\, \\mathrm{K},\\, q_v = 0.012,\\, q_c = 0.005)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个内部列表包含三个浮点数 $[T^\\ast, q_v^\\ast, \\Delta q_c]$，使用指定的单位并四舍五入到六位小数。例如：\n  $$ \\texttt{[[T1,qv1,dqc1],[T2,qv2,dqc2],\\dots]} $$",
            "solution": "该问题在科学上基于大气热力学原理，特别是在定压相变过程中的湿焓和总水守恒。该问题是适定的，提供了所有必要的常数、定义和一个需要求解的明确的目标函数。约束条件是自洽的，并且所要求的数值方法是此类问题的标准方法。\n\n目标是开发一个饱和调整算法。给定一个湿空气块的初始状态，由其温度 $T$、压力 $p$、水汽比湿 $q_v$ 和液态水比湿 $q_c$ 定义，算法必须确定最终的平衡状态 $(T^\\ast, q_v^\\ast, q_c^\\ast)$，该状态是饱和的，并且同时守恒总水和湿焓。\n\n首先，我们建立问题中定义的控制物理原理和方程。作为温度 $T$ 函数的饱和水汽压 $e_s$ 由 Clausius-Clapeyron 关系式给出：\n$$ e_s(T) = e_0 \\exp\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right) $$\n由此，可以推导出在给定温度 $T$ 和压力 $p$ 下的饱和比湿 $q_{v,\\mathrm{sat}}$：\n$$ q_{v,\\mathrm{sat}}(T, p) = \\frac{\\varepsilon\\, e_s(T)}{p - (1 - \\varepsilon)\\, e_s(T)} $$\n其中 $\\varepsilon = R_d / R_v$ 是干空气和水汽的气体常数之比。\n\n在凝结过程中，每单位质量湿空气的湿焓 $h_m$ 是守恒的。初始焓 $h_{m, \\text{initial}}$ 为：\n$$ h_{m, \\text{initial}} = c_{p,m}(q_v, q_t)\\, T + L_v\\, q_v $$\n在温度 $T^\\ast$ 和比湿 $q_v^\\ast$ 下的最终焓 $h_{m, \\text{final}}$ 为：\n$$ h_{m, \\text{final}} = c_{p,m}(q_v^\\ast, q_t)\\, T^\\ast + L_v\\, q_v^\\ast $$\n混合物的有效比热容 $c_{p,m}$ 是含水量的函数：\n$$ c_{p,m}(q_v, q_t) = (1 - q_t)\\, c_{p,d} + q_v\\, c_{p,v} + (q_t - q_v)\\, c_{p,\\ell} $$\n总水比湿 $q_t = q_v + q_c$ 是守恒的，因为凝结只将水汽转化为液体。\n\n问题的核心在于找到同时满足两个条件的最终温度 $T^\\ast$：\n1.  **饱和**：最终状态必须是饱和的，因此 $q_v^\\ast = q_{v,\\mathrm{sat}}(T^\\ast, p)$。\n2.  **焓守恒**：$h_{m, \\text{final}} = h_{m, \\text{initial}}$。\n\n将饱和条件代入焓守恒方程，得到一个关于未知最终温度 $T^\\ast$ 的单一非线性标量方程：\n$$ c_{p,m}(q_{v,\\mathrm{sat}}(T^\\ast, p), q_t)\\, T^\\ast + L_v\\, q_{v,\\mathrm{sat}}(T^\\ast, p) = h_{m, \\text{initial}} $$\n这可以表示为求函数 $f(T^\\ast)$ 的根：\n$$ f(T^\\ast) = \\left[c_{p,m}(q_{v,\\mathrm{sat}}(T^\\ast, p), q_t)\\, T^\\ast + L_v\\, q_{v,\\mathrm{sat}}(T^\\ast, p)\\right] - h_{m, \\text{initial}} = 0 $$\n方括号中的项代表在温度 $T^\\ast$ 下饱和气块的焓。分析表明 $f(T^\\ast)$ 是 $T^\\ast$ 的单调递增函数，这保证了如果解存在，则解是唯一的。\n\n算法流程首先评估初始状态。我们计算初始温度下的饱和比湿 $q_{v, \\text{sat}}(T, p)$。\n- 如果 $q_v \\le q_{v, \\text{sat}}(T, p)$，则气块是未饱和或恰好饱和的。没有凝结发生。最终状态与初始状态相同，$(T^\\ast, q_v^\\ast) = (T, q_v)$，并且新凝结物的量 $\\Delta q_c$ 为 $0$。\n- 如果 $q_v > q_{v, \\text{sat}}(T, p)$，则气块是过饱和的。需要调整到一个新的饱和平衡状态。由于凝结释放潜热 ($L_v$)，温度会升高，因此 $T^\\ast > T$。我们必须找到 $f(T^\\ast) = 0$ 的根。\n\n对于过饱和情况，采用数值求根方法。问题建议使用二分法算法，这需要对根进行区间界定。一个科学上一致的区间是：\n- **下界 ($T_{lo}$)**：初始温度 $T$。在此温度下，$f(T) = (q_{v,\\mathrm{sat}}(T) - q_v) [L_v + T(c_{p,v} - c_{p,\\ell})]$。由于 $q_v > q_{v,\\mathrm{sat}}(T)$，第一项为负。对于典型的大气温度，第二项 $[L_v + T(c_{p,v} - c_{p,\\ell})]$ 为正。因此，$f(T)  0$。\n- **上界 ($T_{hi}$)**：一个足够高的温度以确保 $f(T_{hi}) > 0$。如果我们找到一个 $T_{hi}$，使得即使在初始水汽量下气块也变为未饱和，即 $q_{v,\\mathrm{sat}}(T_{hi}, p) \\ge q_v$，则该条件得到满足。从 $T$ 开始的迭代搜索可以建立这个界限。\n\n当根 $T^\\ast$ 被限定在 $[T_{lo}, T_{hi}]$ 区间内时，可以应用二分法以期望的精度找到 $T^\\ast$。一旦 $T^\\ast$ 已知，就可以计算最终的状态变量：\n- 最终水汽比湿：$q_v^\\ast = q_{v, \\text{sat}}(T^\\ast, p)$。\n- 凝结水量：$\\Delta q_c = q_v - q_v^\\ast$。\n- 最终液态水比湿：$q_c^\\ast = q_c + \\Delta q_c$。\n\n该实现将包括用于计算物理量（$e_s, q_{v,\\mathrm{sat}}, c_{p,m}, h_m$）的函数、一个二分法求解器以及一个主程序，用于根据此逻辑处理指定的测试用例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a saturation adjustment algorithm for atmospheric water phase changes.\n    \"\"\"\n    # Define physical constants in SI units\n    CPD = 1004.0  # J/kg/K, specific heat of dry air\n    CPV = 1860.0  # J/kg/K, specific heat of water vapor\n    CPL = 4186.0  # J/kg/K, specific heat of liquid water\n    LV = 2.5e6    # J/kg, latent heat of vaporization\n    RD = 287.05   # J/kg/K, gas constant for dry air\n    RV = 461.5    # J/kg/K, gas constant for water vapor\n    EPS = RD / RV # Ratio of gas constants\n    T0 = 273.15   # K, reference temperature for Clausius-Clapeyron\n    E0 = 611.2    # Pa, saturation vapor pressure at T0\n\n    def e_s(T):\n        \"\"\"Calculates saturation vapor pressure (Pa) using the Clausius-Clapeyron eq.\"\"\"\n        return E0 * np.exp((LV / RV) * (1.0 / T0 - 1.0 / T))\n\n    def q_vsat(T, p):\n        \"\"\"Calculates saturation specific humidity (dimensionless).\"\"\"\n        es_T = e_s(T)\n        denominator = p - (1.0 - EPS) * es_T\n        if denominator == 0:\n            # Handle physically unrealistic pressure/temp where p ~= e_s\n            return np.inf\n        return (EPS * es_T) / denominator\n\n    def c_pm(qv, qt):\n        \"\"\"Calculates moist specific heat capacity (J/kg/K).\"\"\"\n        return (1.0 - qt) * CPD + qv * CPV + (qt - qv) * CPL\n\n    def h_m(T, qv, qt):\n        \"\"\"Calculates moist enthalpy (J/kg).\"\"\"\n        return c_pm(qv, qt) * T + LV * qv\n\n    def bisection(f, a, b, tol=1e-9):\n        \"\"\"\n        A robust bisection root-finding algorithm.\n        Finds a root of f(x) = 0 in the interval [a, b].\n        \"\"\"\n        fa = f(a)\n        fb = f(b)\n        if fa * fb >= 0:\n            if abs(fa)  tol: return a\n            if abs(fb)  tol: return b\n            raise ValueError(\"Root not bracketed or function has same sign at endpoints.\")\n\n        while (b - a) > tol:\n            c = (a + b) / 2.0\n            fc = f(c)\n            if abs(fc)  tol:\n                return c\n            if fa * fc  0:\n                b = c\n            else:\n                a = c\n                fa = fc\n        return (a + b) / 2.0\n\n    test_cases = [\n        (90000.0, 285.0, 0.018, 0.0),\n        (100000.0, 298.0, 0.010, 0.0),\n        (80000.0, 273.15, 0.00476, 0.0),\n        (70000.0, 265.0, 0.002, 0.001),\n        (95000.0, 280.0, 0.012, 0.005),\n    ]\n\n    results = []\n    for p, T, qv, qc in test_cases:\n        qv_sat_initial = q_vsat(T, p)\n\n        if qv = qv_sat_initial:\n            # Parcel is unsaturated or just saturated: no condensation occurs.\n            T_star = T\n            qv_star = qv\n            delta_qc = 0.0\n        else:\n            # Parcel is supersaturated: perform saturation adjustment.\n            qt = qv + qc\n            h_initial = h_m(T, qv, qt)\n\n            # Define the objective function f(T*) = h_final(T*) - h_initial = 0\n            def root_function(T_new):\n                qv_sat_new = q_vsat(T_new, p)\n                h_new = h_m(T_new, qv_sat_new, qt)\n                return h_new - h_initial\n\n            # Establish a bracket [T_lo, T_hi] for the root T*.\n            # T* > T because latent heat is released.\n            T_lo = T\n            \n            # Find an upper bound T_hi where f(T_hi) > 0.\n            # This is guaranteed if q_vsat(T_hi) > qv.\n            T_hi = T + 0.1  # Start search slightly above T\n            while q_vsat(T_hi, p)  qv:\n                T_hi += 1.0\n\n            # Find the root T_star using bisection.\n            T_star = bisection(root_function, T_lo, T_hi)\n\n            # Calculate final state variables.\n            qv_star = q_vsat(T_star, p)\n            delta_qc = qv - qv_star\n\n        results.append([round(T_star, 6), round(qv_star, 6), round(delta_qc, 6)])\n\n    # Format the final output string to exactly match the problem specification,\n    # specifically ensuring no spaces within the list structures.\n    formatted_results = [','.join(map(str, res)) for res in results]\n    print(f\"[[{'],['.join(formatted_results)}]]\")\n\nsolve()\n```"
        }
    ]
}