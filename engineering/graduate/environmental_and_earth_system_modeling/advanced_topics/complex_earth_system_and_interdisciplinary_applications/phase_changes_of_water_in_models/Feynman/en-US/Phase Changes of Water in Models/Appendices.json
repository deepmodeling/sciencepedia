{
    "hands_on_practices": [
        {
            "introduction": "This first exercise returns to the fundamental thermodynamics governing phase changes. Before we can model these complex processes, we must be able to accurately calculate the total energy budget associated with changing a substance's temperature and phase. By computing the energy required to cool and freeze a parcel of water, you will reinforce your understanding of the distinction between sensible heat (related to temperature change) and latent heat (related to phase change), which is a cornerstone of all climate and weather models. ",
            "id": "3906261",
            "problem": "In an Earth system model’s hydrometeor thermodynamics, the energy budget for phase changes and temperature changes of water is tracked via specific enthalpy. Consider a parcel containing $m=1\\,\\mathrm{kg}$ of pure water at a pressure of $1\\,\\mathrm{bar}$, initially at $T_i=5\\,^{\\circ}\\mathrm{C}$, cooled to $T_f=-5\\,^{\\circ}\\mathrm{C}$ through equilibrium freezing at $T_m=0\\,^{\\circ}\\mathrm{C}$. Under constant pressure, the change in specific enthalpy is obtained by integrating the temperature-dependent specific heat capacity at constant pressure and by including the latent heat of fusion at the phase transition. Assume temperature-dependent specific heats for liquid water and ice over the narrow interval around $T_m$ given by\n$$c_{p,\\mathrm{liq}}(T)=\\alpha_0+\\alpha_1\\left(T-273.15\\,\\mathrm{K}\\right),\\quad c_{p,\\mathrm{ice}}(T)=\\beta_0+\\beta_1\\left(T-273.15\\,\\mathrm{K}\\right),$$\nwith $\\alpha_0=4.217\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$, $\\alpha_1=-1.5\\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}$, $\\beta_0=2.090\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$, and $\\beta_1=8.0\\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}$. Take the latent heat of fusion (the enthalpy jump at the melting point) as $L_f=334\\,\\mathrm{kJ\\,kg^{-1}}$ at $T_m$ under $1\\,\\mathrm{bar}$.\n\nUsing the definition of specific heat capacity at constant pressure and the latent heat of fusion as fundamental bases, compute the total energy removed to cool and freeze the parcel from $T_i$ to $T_f$ by summing the sensible cooling of liquid above $T_m$, the latent heat at $T_m$, and the sensible cooling of ice below $T_m$. Express the final energy in $\\mathrm{kJ}$ and round your answer to four significant figures.",
            "solution": "The user wants me to validate and solve a thermodynamics problem.\n\n### Step 1: Extract Givens\n-   Mass of water parcel: $m=1\\,\\mathrm{kg}$\n-   Constant pressure: $P=1\\,\\mathrm{bar}$\n-   Initial temperature: $T_i=5\\,^{\\circ}\\mathrm{C}$\n-   Final temperature: $T_f=-5\\,^{\\circ}\\mathrm{C}$\n-   Melting temperature: $T_m=0\\,^{\\circ}\\mathrm{C}$\n-   Specific heat of liquid water: $c_{p,\\mathrm{liq}}(T)=\\alpha_0+\\alpha_1\\left(T-273.15\\,\\mathrm{K}\\right)$\n-   Constant for liquid water specific heat: $\\alpha_0=4.217\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$\n-   Constant for liquid water specific heat: $\\alpha_1=-1.5\\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}$\n-   Specific heat of ice: $c_{p,\\mathrm{ice}}(T)=\\beta_0+\\beta_1\\left(T-273.15\\,\\mathrm{K}\\right)$\n-   Constant for ice specific heat: $\\beta_0=2.090\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$\n-   Constant for ice specific heat: $\\beta_1=8.0\\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}$\n-   Latent heat of fusion at $T_m$: $L_f=334\\,\\mathrm{kJ\\,kg^{-1}}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is a standard thermodynamics problem involving heat transfer during a temperature change and a phase transition. The given values for the specific heats and latent heat of fusion of water are physically realistic. The problem provides all necessary information and is internally consistent. No flaws are detected.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution\nThe total energy removed to cool the water parcel from an initial temperature $T_i$ to a final temperature $T_f$, with a phase change at the melting temperature $T_m$, is the sum of three components:\n1.  The sensible heat removed to cool the liquid water from $T_i$ to $T_m$. Let's call this $\\Delta Q_1$.\n2.  The latent heat removed to freeze the liquid into ice at $T_m$. Let's call this $\\Delta Q_2$.\n3.  The sensible heat removed to cool the ice from $T_m$ to $T_f$. Let's call this $\\Delta Q_3$.\n\nThe total energy removed is $\\Delta Q = \\Delta Q_1 + \\Delta Q_2 + \\Delta Q_3$.\nThe fundamental definition of the heat removed during a temperature change at constant pressure for a mass $m$ is given by the integral of the specific heat capacity $c_p(T)$:\n$\\Delta Q = m \\int_{T_{final}}^{T_{initial}} c_p(T) dT$.\n\nFirst, we convert the temperatures from Celsius to Kelvin:\n$T_i = 5\\,^{\\circ}\\mathrm{C} = 5 + 273.15 = 278.15\\,\\mathrm{K}$\n$T_m = 0\\,^{\\circ}\\mathrm{C} = 0 + 273.15 = 273.15\\,\\mathrm{K}$\n$T_f = -5\\,^{\\circ}\\mathrm{C} = -5 + 273.15 = 268.15\\,\\mathrm{K}$\nNote that the specific heat expressions are given in terms of $(T-273.15\\,\\mathrm{K})$, which is convenient.\n\n1.  **Sensible heat removed from liquid water ($\\Delta Q_1$)**:\nThe energy removed when cooling the liquid water from $T_i$ to $T_m$ is:\n$$ \\Delta Q_1 = m \\int_{T_m}^{T_i} c_{p,\\mathrm{liq}}(T) dT $$\nSubstituting the given expression for $c_{p,\\mathrm{liq}}(T)$:\n$$ \\Delta Q_1 = m \\int_{T_m}^{T_i} \\left[ \\alpha_0 + \\alpha_1(T - T_m) \\right] dT $$\nLet's perform the integration:\n$$ \\Delta Q_1 = m \\left[ \\alpha_0 T + \\alpha_1 \\left( \\frac{T^2}{2} - T_m T \\right) \\right]_{T_m}^{T_i} $$\n$$ \\Delta Q_1 = m \\left\\{ \\left( \\alpha_0 T_i + \\frac{\\alpha_1}{2} T_i^2 - \\alpha_1 T_m T_i \\right) - \\left( \\alpha_0 T_m + \\frac{\\alpha_1}{2} T_m^2 - \\alpha_1 T_m^2 \\right) \\right\\} $$\n$$ \\Delta Q_1 = m \\left\\{ \\alpha_0 (T_i - T_m) + \\frac{\\alpha_1}{2} (T_i^2 - T_m^2) - \\alpha_1 T_m (T_i - T_m) \\right\\} $$\n$$ \\Delta Q_1 = m (T_i - T_m) \\left\\{ \\alpha_0 + \\frac{\\alpha_1}{2} (T_i + T_m) - \\alpha_1 T_m \\right\\} $$\n$$ \\Delta Q_1 = m (T_i - T_m) \\left\\{ \\alpha_0 + \\frac{\\alpha_1}{2} (T_i - T_m) \\right\\} $$\nWe have $m = 1\\,\\mathrm{kg}$, $T_i - T_m = 278.15\\,\\mathrm{K} - 273.15\\,\\mathrm{K} = 5\\,\\mathrm{K}$, $\\alpha_0 = 4.217\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$, and $\\alpha_1 = -1.5 \\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}$.\n$$ \\Delta Q_1 = (1\\,\\mathrm{kg}) \\left( (5\\,\\mathrm{K}) \\left\\{ 4.217\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}} + \\frac{-1.5 \\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}}{2} (5\\,\\mathrm{K}) \\right\\} \\right) $$\n$$ \\Delta Q_1 = 5 \\times \\{ 4.217 - 0.75 \\times 10^{-3} \\times 5 \\} \\,\\mathrm{kJ} $$\n$$ \\Delta Q_1 = 5 \\times \\{ 4.217 - 0.00375 \\} \\,\\mathrm{kJ} = 5 \\times 4.21325 \\,\\mathrm{kJ} = 21.06625\\,\\mathrm{kJ} $$\n\n2.  **Latent heat removed during freezing ($\\Delta Q_2$)**:\nThe energy removed during the phase change at constant temperature $T_m$ is the product of the mass and the specific latent heat of fusion $L_f$.\n$$ \\Delta Q_2 = m L_f $$\nWith $m = 1\\,\\mathrm{kg}$ and $L_f = 334\\,\\mathrm{kJ\\,kg^{-1}}$:\n$$ \\Delta Q_2 = (1\\,\\mathrm{kg}) \\times (334\\,\\mathrm{kJ\\,kg^{-1}}) = 334\\,\\mathrm{kJ} $$\n\n3.  **Sensible heat removed from ice ($\\Delta Q_3$)**:\nThe energy removed when cooling the ice from $T_m$ to $T_f$ is:\n$$ \\Delta Q_3 = m \\int_{T_f}^{T_m} c_{p,\\mathrm{ice}}(T) dT $$\nSubstituting the given expression for $c_{p,\\mathrm{ice}}(T)$:\n$$ \\Delta Q_3 = m \\int_{T_f}^{T_m} \\left[ \\beta_0 + \\beta_1(T - T_m) \\right] dT $$\nThe integral has the same form as for the liquid. We integrate from $T_f$ to $T_m$:\n$$ \\Delta Q_3 = m \\left[ \\beta_0 (T_m - T_f) + \\frac{\\beta_1}{2} (T_m - T_f)^2 \\right] $$\nThis formula is incorrect. The correct calculation, analogous to the liquid, is:\n$$ \\Delta Q_3 = m (T_m - T_f) \\left\\{ \\beta_0 + \\frac{\\beta_1}{2} (T_m + T_f - 2T_m) \\right\\} = m(T_m - T_f) \\left\\{ \\beta_0 + \\frac{\\beta_1}{2} (T_f - T_m) \\right\\} $$\nLet's use the integration result directly.\n$$ \\Delta Q_3 = m \\left[ \\beta_0 T + \\beta_1 \\left( \\frac{T^2}{2} - T_m T \\right) \\right]_{T_f}^{T_m} $$\n$$ \\Delta Q_3 = m \\left\\{ \\left( \\beta_0 T_m - \\frac{\\beta_1}{2} T_m^2 \\right) - \\left( \\beta_0 T_f + \\frac{\\beta_1}{2} T_f^2 - \\beta_1 T_m T_f \\right) \\right\\} $$\n$$ \\Delta Q_3 = m \\left\\{ \\beta_0 (T_m - T_f) - \\frac{\\beta_1}{2} (T_m^2 - 2 T_m T_f + T_f^2) \\right\\} $$\n$$ \\Delta Q_3 = m \\left\\{ \\beta_0 (T_m - T_f) - \\frac{\\beta_1}{2} (T_m - T_f)^2 \\right\\} $$\nWe have $m = 1\\,\\mathrm{kg}$, $T_m - T_f = 273.15\\,\\mathrm{K} - 268.15\\,\\mathrm{K} = 5\\,\\mathrm{K}$, $\\beta_0 = 2.090\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}$, and $\\beta_1 = 8.0 \\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}$.\n$$ \\Delta Q_3 = (1\\,\\mathrm{kg}) \\left\\{ (2.090\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-1}}) (5\\,\\mathrm{K}) - \\frac{8.0 \\times 10^{-3}\\,\\mathrm{kJ\\,kg^{-1}\\,K^{-2}}}{2} (5\\,\\mathrm{K})^2 \\right\\} $$\n$$ \\Delta Q_3 = \\{ 10.45 - 4.0 \\times 10^{-3} \\times 25 \\} \\,\\mathrm{kJ} $$\n$$ \\Delta Q_3 = \\{ 10.45 - 0.1 \\} \\,\\mathrm{kJ} = 10.35\\,\\mathrm{kJ} $$\n\n4.  **Total energy removed ($\\Delta Q$)**:\nThe total energy removed is the sum of the three components:\n$$ \\Delta Q = \\Delta Q_1 + \\Delta Q_2 + \\Delta Q_3 $$\n$$ \\Delta Q = 21.06625\\,\\mathrm{kJ} + 334\\,\\mathrm{kJ} + 10.35\\,\\mathrm{kJ} $$\n$$ \\Delta Q = 365.41625\\,\\mathrm{kJ} $$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\Delta Q \\approx 365.4\\,\\mathrm{kJ} $$",
            "answer": "$$\n\\boxed{365.4}\n$$"
        },
        {
            "introduction": "Earth system models must balance physical realism with computational feasibility, often leading to simplifying assumptions. This practice explores one such common simplification: treating the latent heats of vaporization and sublimation as constants. You will first derive the temperature dependency of latent heat from first principles via Kirchhoff's law and then implement a program to quantify the error this simplification introduces into a model's latent heating calculations, providing critical insight into model fidelity. ",
            "id": "3906259",
            "problem": "Consider a dry air parcel in a numerical atmospheric column model where the latent heating due to phase changes of water is parameterized. The parcel undergoes phase change processes that are assumed to be locally isobaric over short timescales. The latent heat of vaporization, denoted $L_v$, and the latent heat of fusion, denoted $L_f$, are thermodynamic quantities that relate enthalpy changes to phase transitions.\n\nUse the following fundamental base to derive temperature-dependent latent heats:\n\n1. The latent heat for a phase transition is the difference in specific enthalpies of the two phases. For vaporization, $L_v(T) = h_v(T) - h_l(T)$, and for fusion, $L_f(T) = h_l(T) - h_i(T)$, where $h_v$, $h_l$, and $h_i$ are the specific enthalpies of water vapor, liquid water, and ice, respectively, and $T$ is temperature.\n2. The specific heat at constant pressure is defined as $c_p = \\left(\\frac{\\partial h}{\\partial T}\\right)_p$. Assume that $c_{p,v}$, $c_{p,l}$, and $c_{p,i}$ are constant with respect to $T$ over the temperature range of interest.\n3. The First Law of Thermodynamics (energy conservation for a parcel) connects heating rates to enthalpy changes. For a phase change occurring at rate $\\dot{q}$ per unit mass, the latent heating rate per unit mass is $H(T) = L(T)\\,\\dot{q}$, where $L(T)$ is the latent heat appropriate to the phase change pathway and $\\dot{q}$ is the rate of conversion of water vapor mass fraction into condensed phase in $\\mathrm{s^{-1}}$.\n\nAssume the following scientifically plausible constants and reference values:\n- Reference temperature $T_0 = 273.15\\,\\mathrm{K}$.\n- Latent heat of vaporization at $T_0$: $L_v(T_0) = 2.500\\times 10^6\\,\\mathrm{J\\,kg^{-1}}$.\n- Latent heat of fusion at $T_0$: $L_f(T_0) = 3.340\\times 10^5\\,\\mathrm{J\\,kg^{-1}}$.\n- Specific heats at constant pressure (taken as constant in the range $-40\\,^\\circ\\mathrm{C}$ to $40\\,^\\circ\\mathrm{C}$): $c_{p,v} = 1850\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $c_{p,l} = 4181\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $c_{p,i} = 2106\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n\nModeling assumptions for the microphysical pathway:\n- For temperatures $T \\ge T_0$, condensation produces liquid water, and the latent heating uses $L_v(T)$.\n- For temperatures $T < T_0$, deposition produces ice directly from vapor, and the latent heating uses the latent heat of sublimation $L_s(T) = L_v(T) + L_f(T)$.\n\nA common modeling simplification treats $L_v$ and $L_f$ as constants independent of temperature, using $L_v(T) \\approx L_v(T_0)$ and $L_f(T) \\approx L_f(T_0)$, so the constant sublimation latent heat is $L_s^{\\mathrm{const}} = L_v(T_0) + L_f(T_0)$.\n\nTask:\n- Using only the fundamental base above, derive expressions for $L_v(T)$ and $L_f(T)$ as functions of $T$ under the assumption of temperature-independent specific heats over the given range.\n- For each test case below, compute the absolute error in the latent heating rate per unit mass, $E_a = \\left|H_{\\mathrm{const}}(T) - H(T)\\right|$, in $\\mathrm{W\\,kg^{-1}}$, where $H_{\\mathrm{const}}(T)$ is the heating rate computed with constant latent heats and $H(T)$ is the heating rate computed with temperature-dependent latent heats. Also compute the fractional error $E_f = \\frac{H_{\\mathrm{const}}(T) - H(T)}{H(T)}$ as a decimal. If $H(T) = 0$, define $E_f = 0$.\n\nTest suite:\n- Case $1$: Temperature $T = -40\\,^\\circ\\mathrm{C}$, condensation rate $\\dot{q} = 2.0\\times 10^{-5}\\,\\mathrm{s^{-1}}$.\n- Case $2$: Temperature $T = -5\\,^\\circ\\mathrm{C}$, condensation rate $\\dot{q} = 5.0\\times 10^{-5}\\,\\mathrm{s^{-1}}$.\n- Case $3$: Temperature $T = 0\\,^\\circ\\mathrm{C}$, condensation rate $\\dot{q} = 1.0\\times 10^{-4}\\,\\mathrm{s^{-1}}$.\n- Case $4$: Temperature $T = 20\\,^\\circ\\mathrm{C}$, condensation rate $\\dot{q} = 1.5\\times 10^{-4}\\,\\mathrm{s^{-1}}$.\n- Case $5$: Temperature $T = 40\\,^\\circ\\mathrm{C}$, condensation rate $\\dot{q} = 1.0\\times 10^{-5}\\,\\mathrm{s^{-1}}$.\n- Case $6$ (edge case): Temperature $T = 10\\,^\\circ\\mathrm{C}$, condensation rate $\\dot{q} = 0\\,\\mathrm{s^{-1}}$.\n\nExpress absolute errors in $\\mathrm{W\\,kg^{-1}}$ and fractional errors as decimals. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is a two-element list $[E_a,E_f]$ corresponding to the test cases in order (for example, $[[x_1,y_1],[x_2,y_2],\\dots]$). Temperatures in the input are in degrees Celsius, but all thermodynamic calculations must be carried out in Kelvin.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n### Step 1: Extract Givens\n- **Definitions**:\n  - Latent heat of vaporization: $L_v(T) = h_v(T) - h_l(T)$.\n  - Latent heat of fusion: $L_f(T) = h_l(T) - h_i(T)$.\n  - Specific heat at constant pressure: $c_p = \\left(\\frac{\\partial h}{\\partial T}\\right)_p$.\n- **Assumptions**:\n  - Phase changes are locally isobaric.\n  - Specific heats $c_{p,v}$, $c_{p,l}$, and $c_{p,i}$ are constant with respect to temperature $T$.\n- **Formulas**:\n  - Latent heating rate per unit mass: $H(T) = L(T)\\,\\dot{q}$.\n- **Constants and Reference Values**:\n  - Reference temperature: $T_0 = 273.15\\,\\mathrm{K}$.\n  - Latent heat of vaporization at $T_0$: $L_v(T_0) = 2.500\\times 10^6\\,\\mathrm{J\\,kg^{-1}}$.\n  - Latent heat of fusion at $T_0$: $L_f(T_0) = 3.340\\times 10^5\\,\\mathrm{J\\,kg^{-1}}$.\n  - Specific heat of water vapor: $c_{p,v} = 1850\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n  - Specific heat of liquid water: $c_{p,l} = 4181\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n  - Specific heat of ice: $c_{p,i} = 2106\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n- **Modeling Pathway Conditions**:\n  - For $T \\ge T_0$: Condensation occurs, latent heating uses $L_v(T)$.\n  - For $T < T_0$: Deposition occurs, latent heating uses a latent heat of sublimation $L_s(T) = L_v(T) + L_f(T)$.\n- **Modeling Simplification (for comparison)**:\n  - Constant latent heat approximation: $L_v(T) \\approx L_v(T_0)$ and $L_f(T) \\approx L_f(T_0)$.\n  - Constant latent heat of sublimation: $L_s^{\\mathrm{const}} = L_v(T_0) + L_f(T_0)$.\n- **Task**:\n  - Derive expressions for $L_v(T)$ and $L_f(T)$.\n  - For each test case, compute absolute error $E_a = \\left|H_{\\mathrm{const}}(T) - H(T)\\right|$ and fractional error $E_f = \\frac{H_{\\mathrm{const}}(T) - H(T)}{H(T)}$. If $H(T) = 0$, $E_f = 0$.\n- **Test Cases**:\n  - Case 1: $T = -40\\,^\\circ\\mathrm{C}$, $\\dot{q} = 2.0\\times 10^{-5}\\,\\mathrm{s^{-1}}$.\n  - Case 2: $T = -5\\,^\\circ\\mathrm{C}$, $\\dot{q} = 5.0\\times 10^{-5}\\,\\mathrm{s^{-1}}$.\n  - Case 3: $T = 0\\,^\\circ\\mathrm{C}$, $\\dot{q} = 1.0\\times 10^{-4}\\,\\mathrm{s^{-1}}$.\n  - Case 4: $T = 20\\,^\\circ\\mathrm{C}$, $\\dot{q} = 1.5\\times 10^{-4}\\,\\mathrm{s^{-1}}$.\n  - Case 5: $T = 40\\,^\\circ\\mathrm{C}$, $\\dot{q} = 1.0\\times 10^{-5}\\,\\mathrm{s^{-1}}$.\n  - Case 6: $T = 10\\,^\\circ\\mathrm{C}$, $\\dot{q} = 0\\,\\mathrm{s^{-1}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in fundamental thermodynamics, specifically the definitions of enthalpy, latent heat, and specific heat. The derivation required is a direct application of Kirchhoff's law of thermochemistry. The supplied constants are physically realistic values for water. The problem is well-posed, providing all necessary information, clearly defined conditions, and unambiguous objectives. The structure is logical, and a unique, stable solution exists for each test case. There are no contradictions, ambiguities, or scientifically unsound premises.\n\n### Step 3: Verdict and Action\nThe problem is valid and can be solved as stated.\n\n### Solution\n\nThe solution proceeds in two parts: first, the derivation of the temperature-dependent latent heats, and second, the application of these derived formulas to calculate the requested error metrics for each test case. All temperatures must be handled in Kelvin for thermodynamic consistency.\n\n**Part 1: Derivation of Temperature-Dependent Latent Heats**\n\nThe derivation is based on the fundamental definitions provided. The temperature dependence of the latent heat of a phase transition is found by differentiating its definition with respect to temperature.\n\nFor the latent heat of vaporization, $L_v(T) = h_v(T) - h_l(T)$, we differentiate with respect to temperature $T$ at constant pressure $p$:\n$$\n\\frac{d L_v}{d T} = \\left(\\frac{\\partial h_v}{\\partial T}\\right)_p - \\left(\\frac{\\partial h_l}{\\partial T}\\right)_p\n$$\nBy definition, the specific heat at constant pressure is $c_p = \\left(\\frac{\\partial h}{\\partial T}\\right)_p$. Substituting this into the equation yields:\n$$\n\\frac{d L_v}{d T} = c_{p,v} - c_{p,l}\n$$\nGiven that $c_{p,v}$ and $c_{p,l}$ are assumed to be constant, we can integrate this ordinary differential equation from the reference temperature $T_0$ to an arbitrary temperature $T$:\n$$\n\\int_{L_v(T_0)}^{L_v(T)} dL'_v = \\int_{T_0}^{T} (c_{p,v} - c_{p,l}) dT'\n$$\n$$\nL_v(T) - L_v(T_0) = (c_{p,v} - c_{p,l}) (T - T_0)\n$$\nThis gives the expression for the temperature-dependent latent heat of vaporization:\n$$\nL_v(T) = L_v(T_0) + (c_{p,v} - c_{p,l})(T - T_0)\n$$\nA parallel derivation is performed for the latent heat of fusion, $L_f(T) = h_l(T) - h_i(T)$:\n$$\n\\frac{d L_f}{d T} = \\left(\\frac{\\partial h_l}{\\partial T}\\right)_p - \\left(\\frac{\\partial h_i}{\\partial T}\\right)_p = c_{p,l} - c_{p,i}\n$$\nIntegrating from $T_0$ to $T$:\n$$\nL_f(T) - L_f(T_0) = (c_{p,l} - c_{p,i}) (T - T_0)\n$$\nThus, the expression for the temperature-dependent latent heat of fusion is:\n$$\nL_f(T) = L_f(T_0) + (c_{p,l} - c_{p,i})(T - T_0)\n$$\nFor temperatures $T < T_0$, the problem specifies deposition, which involves the latent heat of sublimation, $L_s(T)$. This is the sum of the latent heats of vaporization and fusion:\n$$\nL_s(T) = L_v(T) + L_f(T)\n$$\nSubstituting the derived temperature-dependent expressions:\n$$\nL_s(T) = [L_v(T_0) + (c_{p,v} - c_{p,l})(T - T_0)] + [L_f(T_0) + (c_{p,l} - c_{p,i})(T - T_0)]\n$$\n$$\nL_s(T) = (L_v(T_0) + L_f(T_0)) + (c_{p,v} - c_{p,l} + c_{p,l} - c_{p,i})(T - T_0)\n$$\n$$\nL_s(T) = L_s(T_0) + (c_{p,v} - c_{p,i})(T - T_0)\n$$\nwhere $L_s(T_0) = L_v(T_0) + L_f(T_0)$.\n\n**Part 2: Calculation of Error Metrics for Test Cases**\n\nFor each test case, we convert the temperature from degrees Celsius ($T_C$) to Kelvin ($T$), determine the appropriate latent heat formula based on the temperature, calculate the heating rates, and finally compute the errors.\n\nLet $\\Delta T = T - T_0$.\nThe temperature-dependent heating rate is $H(T) = L(T)\\dot{q}$, and the constant-approximation heating rate is $H_{\\mathrm{const}}(T) = L^{\\mathrm{const}}\\dot{q}$. The errors are $E_a = \\left| (L^{\\mathrm{const}} - L(T))\\dot{q} \\right|$ and $E_f = (L^{\\mathrm{const}} - L(T)) / L(T)$ for $\\dot{q} \\neq 0$.\n\nThe constants are:\n- $T_0 = 273.15\\,\\mathrm{K}$\n- $L_v(T_0) = 2.500 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$\n- $L_f(T_0) = 3.340 \\times 10^5\\,\\mathrm{J\\,kg^{-1}}$\n- $L_s^{\\mathrm{const}} = L_v(T_0) + L_f(T_0) = 2.834 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$\n- $\\Delta c_{vl} = c_{p,v} - c_{p,l} = 1850 - 4181 = -2331\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- $\\Delta c_{vi} = c_{p,v} - c_{p,i} = 1850 - 2106 = -256\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n\nThe procedure for each case is as follows:\n1.  **Case 1: $T_C = -40\\,^\\circ\\mathrm{C}$, $\\dot{q} = 2.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$**\n    $T = 233.15\\,\\mathrm{K}$, so $\\Delta T = -40\\,\\mathrm{K}$. Since $T < T_0$, we use sublimation.\n    $L(T) = L_s(T) = L_s^{\\mathrm{const}} + \\Delta c_{vi} \\Delta T = 2.834 \\times 10^6 + (-256)(-40) = 2844240\\,\\mathrm{J\\,kg^{-1}}$.\n    $L^{\\mathrm{const}} = L_s^{\\mathrm{const}} = 2.834 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$.\n    $H(T) = 2844240 \\times 2.0 \\times 10^{-5} = 56.8848\\,\\mathrm{W\\,kg^{-1}}$.\n    $H_{\\mathrm{const}}(T) = 2.834 \\times 10^6 \\times 2.0 \\times 10^{-5} = 56.68\\,\\mathrm{W\\,kg^{-1}}$.\n    $E_a = |56.68 - 56.8848| = 0.2048\\,\\mathrm{W\\,kg^{-1}}$.\n    $E_f = (56.68 - 56.8848) / 56.8848 \\approx -0.0035999$.\n\n2.  **Case 2: $T_C = -5\\,^\\circ\\mathrm{C}$, $\\dot{q} = 5.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$**\n    $T = 268.15\\,\\mathrm{K}$, so $\\Delta T = -5\\,\\mathrm{K}$. Since $T < T_0$, we use sublimation.\n    $L(T) = L_s(T) = 2.834 \\times 10^6 + (-256)(-5) = 2835280\\,\\mathrm{J\\,kg^{-1}}$.\n    $L^{\\mathrm{const}} = 2.834 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$.\n    $H(T) = 2835280 \\times 5.0 \\times 10^{-5} = 141.764\\,\\mathrm{W\\,kg^{-1}}$.\n    $H_{\\mathrm{const}}(T) = 2.834 \\times 10^6 \\times 5.0 \\times 10^{-5} = 141.7\\,\\mathrm{W\\,kg^{-1}}$.\n    $E_a = |141.7 - 141.764| = 0.064\\,\\mathrm{W\\,kg^{-1}}$.\n    $E_f = (141.7 - 141.764) / 141.764 \\approx -0.0004514$.\n\n3.  **Case 3: $T_C = 0\\,^\\circ\\mathrm{C}$, $\\dot{q} = 1.0 \\times 10^{-4}\\,\\mathrm{s^{-1}}$**\n    $T = 273.15\\,\\mathrm{K} = T_0$, so $\\Delta T = 0\\,\\mathrm{K}$. Since $T \\ge T_0$, we use condensation.\n    $L(T) = L_v(T) = L_v(T_0) + \\Delta c_{vl} (0) = L_v(T_0)$.\n    $L^{\\mathrm{const}} = L_v(T_0)$.\n    Here, $L(T) = L^{\\mathrm{const}}$, so $E_a = 0.0\\,\\mathrm{W\\,kg^{-1}}$ and $E_f = 0.0$.\n\n4.  **Case 4: $T_C = 20\\,^\\circ\\mathrm{C}$, $\\dot{q} = 1.5 \\times 10^{-4}\\,\\mathrm{s^{-1}}$**\n    $T = 293.15\\,\\mathrm{K}$, so $\\Delta T = 20\\,\\mathrm{K}$. Since $T > T_0$, we use condensation.\n    $L(T) = L_v(T) = 2.500 \\times 10^6 + (-2331)(20) = 2453380\\,\\mathrm{J\\,kg^{-1}}$.\n    $L^{\\mathrm{const}} = L_v(T_0) = 2.500 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$.\n    $H(T) = 2453380 \\times 1.5 \\times 10^{-4} = 368.007\\,\\mathrm{W\\,kg^{-1}}$.\n    $H_{\\mathrm{const}}(T) = 2.500 \\times 10^6 \\times 1.5 \\times 10^{-4} = 375\\,\\mathrm{W\\,kg^{-1}}$.\n    $E_a = |375 - 368.007| = 6.993\\,\\mathrm{W\\,kg^{-1}}$.\n    $E_f = (375 - 368.007) / 368.007 \\approx 0.0189996$.\n\n5.  **Case 5: $T_C = 40\\,^\\circ\\mathrm{C}$, $\\dot{q} = 1.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$**\n    $T = 313.15\\,\\mathrm{K}$, so $\\Delta T = 40\\,\\mathrm{K}$. Since $T > T_0$, we use condensation.\n    $L(T) = L_v(T) = 2.500 \\times 10^6 + (-2331)(40) = 2406760\\,\\mathrm{J\\,kg^{-1}}$.\n    $L^{\\mathrm{const}} = 2.500 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$.\n    $H(T) = 2406760 \\times 1.0 \\times 10^{-5} = 24.0676\\,\\mathrm{W\\,kg^{-1}}$.\n    $H_{\\mathrm{const}}(T) = 2.500 \\times 10^6 \\times 1.0 \\times 10^{-5} = 25\\,\\mathrm{W\\,kg^{-1}}$.\n    $E_a = |25 - 24.0676| = 0.9324\\,\\mathrm{W\\,kg^{-1}}$.\n    $E_f = (25 - 24.0676) / 24.0676 \\approx 0.038740$.\n\n6.  **Case 6: $T_C = 10\\,^\\circ\\mathrm{C}$, $\\dot{q} = 0\\,\\mathrm{s^{-1}}$**\n    Since $\\dot{q} = 0$, both $H(T)$ and $H_{\\mathrm{const}}(T)$ are zero.\n    $E_a = |0 - 0| = 0.0\\,\\mathrm{W\\,kg^{-1}}$.\n    By the problem's definition for $H(T)=0$, $E_f = 0.0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the absolute and fractional errors in latent heating rate\n    when using constant vs. temperature-dependent latent heats.\n    \"\"\"\n    # Define thermodynamic constants and reference values from the problem statement.\n    T_0 = 273.15  # Reference temperature in Kelvin\n    L_v_T0 = 2.500e6  # Latent heat of vaporization at T_0 [J/kg]\n    L_f_T0 = 3.340e5   # Latent heat of fusion at T_0 [J/kg]\n    c_pv = 1850.0  # Specific heat of water vapor [J/kg/K]\n    c_pl = 4181.0  # Specific heat of liquid water [J/kg/K]\n    c_pi = 2106.0  # Specific heat of ice [J/kg/K]\n\n    # Pre-compute derived constants for efficiency and clarity.\n    # Constant latent heat of sublimation\n    L_s_const = L_v_T0 + L_f_T0\n    # Difference in specific heats for vaporization (Kirchhoff's law slope)\n    dc_vl = c_pv - c_pl\n    # Difference in specific heats for sublimation (Kirchhoff's law slope)\n    dc_vi = c_pv - c_pi\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Temperature in Celsius, condensation rate in 1/s)\n    test_cases = [\n        (-40.0, 2.0e-5),\n        (-5.0, 5.0e-5),\n        (0.0, 1.0e-4),\n        (20.0, 1.5e-4),\n        (40.0, 1.0e-5),\n        (10.0, 0.0),\n    ]\n\n    results = []\n    for T_C, q_dot in test_cases:\n        # Convert temperature to Kelvin for thermodynamic calculations.\n        T_K = T_C + T_0\n        delta_T = T_K - T_0\n\n        # Handle the trivial case where there is no phase change.\n        if q_dot == 0.0:\n            E_a = 0.0\n            E_f = 0.0\n            results.append([E_a, E_f])\n            continue\n\n        # Determine the phase change pathway and calculate latent heats.\n        if T_K >= T_0:\n            # Pathway: Condensation (vapor to liquid)\n            # Constant latent heat is L_v at T_0.\n            L_const = L_v_T0\n            # Temperature-dependent latent heat of vaporization.\n            L_T = L_v_T0 + dc_vl * delta_T\n        else:  # T_K  T_0\n            # Pathway: Deposition (vapor to ice)\n            # Constant latent heat is L_s at T_0.\n            L_const = L_s_const\n            # Temperature-dependent latent heat of sublimation.\n            L_T = L_s_const + dc_vi * delta_T\n\n        # Calculate heating rates for both models.\n        H_T = L_T * q_dot\n        H_const = L_const * q_dot\n\n        # Compute the absolute error.\n        E_a = abs(H_const - H_T)\n        \n        # Compute the fractional error, with the specified condition for H(T) = 0.\n        # Note: Since we check q_dot == 0 earlier, H_T will not be zero unless L_T is zero,\n        # which is not physically possible in this model. This check is for robustness.\n        if H_T == 0.0:\n            E_f = 0.0\n        else:\n            E_f = (H_const - H_T) / H_T\n\n        results.append([E_a, E_f])\n\n    # Final print statement in the exact required format '[[ Ea1,Ef1 ],[ Ea2,Ef2 ],...]'.\n    # The str() function on a list will produce the '[item1, item2]' format needed.\n    # The outer f-string and join method assemble the complete payload.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This final exercise brings together the preceding concepts to build a core component of an atmospheric model: a saturation adjustment scheme. When a model grid cell becomes supersaturated, this algorithm must adjust the temperature and water vapor content back to a saturated state, forming cloud water while rigorously conserving moist enthalpy. This practice challenges you to implement a physically consistent scheme by solving a nonlinear equation, a task that lies at the heart of modern numerical weather and climate prediction. ",
            "id": "3906229",
            "problem": "You are tasked with implementing a saturation adjustment algorithm used in environmental and earth system modeling for phase changes of water at fixed pressure. The algorithm must update the temperature $T$ and the water vapor specific humidity $q_v$ to a saturated state by condensing liquid water with amount $\\Delta q_c$ such that the final state satisfies saturation and conserves moist enthalpy. The algorithm must be derived from first principles and must be implemented as a complete, runnable program.\n\nFundamental base and core definitions to be used:\n- The atmosphere is a mixture of dry air, water vapor, and liquid water. The total water specific humidity is $q_t = q_v + q_c$, which is conserved by condensation, so $\\Delta q_c = -\\Delta q_v$ and $\\Delta q_t = 0$.\n- The Ideal Gas Law relates partial pressures and mixing ratios under a fixed total pressure $p$.\n- The Clausius–Clapeyron relation with constant latent heat of vaporization $L_v$ gives the saturation vapor pressure as a function of temperature,\n  $$ e_s(T) = e_0 \\exp\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right), $$\n  where $e_0$ is the saturation vapor pressure at a reference temperature $T_0$, and $R_v$ is the gas constant for water vapor.\n- The saturation specific humidity $q_{v,\\mathrm{sat}}(T)$ at pressure $p$ is obtained from the mixing ratio of saturated vapor $r_{v,\\mathrm{sat}}(T)$ and the relationship between specific humidity and mixing ratio. With $\\varepsilon = R_d / R_v$, one has\n  $$ r_{v,\\mathrm{sat}}(T) = \\frac{\\varepsilon\\, e_s(T)}{p - e_s(T)}, \\quad q_{v,\\mathrm{sat}}(T) = \\frac{r_{v,\\mathrm{sat}}(T)}{1 + r_{v,\\mathrm{sat}}(T)} = \\frac{\\varepsilon\\, e_s(T)}{p - (1 - \\varepsilon)\\, e_s(T)}, $$\n  where $R_d$ is the gas constant for dry air.\n- The moist enthalpy (per unit mass of moist air) is modeled as\n  $$ h_m = c_{p,m}(q_v,q_t)\\, T + L_v\\, q_v, $$\n  where $c_{p,m}(q_v,q_t)$ is the effective specific heat capacity of the moist mixture defined by\n  $$ c_{p,m}(q_v,q_t) = (1 - q_t)\\, c_{p,d} + q_v\\, c_{p,v} + (q_t - q_v)\\, c_{p,\\ell}, $$\n  with $c_{p,d}$, $c_{p,v}$, and $c_{p,\\ell}$ the constant specific heats of dry air, water vapor, and liquid water, respectively. The latent heat of vaporization $L_v$ is treated as constant in the temperature range considered.\n\nTarget state and constraints:\n- Given an initial state $(T, p, q_v, q_c)$, the algorithm must find a final state $(T^\\ast, q_v^\\ast, q_c^\\ast)$ such that:\n  1. Saturation at fixed pressure: $$ q_v^\\ast = q_{v,\\mathrm{sat}}(T^\\ast). $$\n  2. Moist enthalpy conservation: $$ c_{p,m}(q_v^\\ast,q_t)\\, T^\\ast + L_v\\, q_v^\\ast = c_{p,m}(q_v,q_t)\\, T + L_v\\, q_v, $$\n     where $q_t = q_v + q_c$ is invariant.\n  3. Condensate update: $$ \\Delta q_c = q_c^\\ast - q_c = q_v - q_v^\\ast, $$\n     with $$ q_c^\\ast = q_t - q_v^\\ast. $$\n\nThe root-finding problem:\n- Combine the constraints to form a single scalar equation in the unknown $T^\\ast$:\n  $$ f(T^\\ast) = c_{p,m}(q_{v,\\mathrm{sat}}(T^\\ast),q_t)\\, T^\\ast + L_v\\, q_{v,\\mathrm{sat}}(T^\\ast) - \\left[c_{p,m}(q_v,q_t)\\, T + L_v\\, q_v\\right] = 0. $$\n- If the initial state is already at or below saturation, i.e., $q_v \\le q_{v,\\mathrm{sat}}(T)$, then no condensation occurs and the final state is $(T^\\ast,q_v^\\ast,q_c^\\ast)=(T,q_v,q_c)$ with $\\Delta q_c = 0$.\n\nConstants and units:\n- Use the following constants in International System of Units (SI) and treat them as fixed in the algorithm:\n  - $c_{p,d} = 1004\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n  - $c_{p,v} = 1860\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n  - $c_{p,\\ell} = 4186\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n  - $L_v = 2.5\\times 10^6\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}$,\n  - $R_d = 287.05\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n  - $R_v = 461.5\\, \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n  - $\\varepsilon = R_d / R_v$,\n  - $T_0 = 273.15\\, \\mathrm{K}$,\n  - $e_0 = 611.2\\, \\mathrm{Pa}$.\n- Required units for inputs and outputs:\n  - Temperature must be expressed in Kelvin ($\\mathrm{K}$).\n  - Pressure must be expressed in Pascal ($\\mathrm{Pa}$).\n  - Specific humidities $q_v$, $q_c$, and $\\Delta q_c$ must be expressed as dimensionless mass fractions (unitless decimals).\n\nAlgorithmic requirements:\n- Implement a robust one-dimensional root solver (for example, bisection) that finds $T^\\ast$ satisfying $f(T^\\ast)=0$ when the initial state is supersaturated.\n- Ensure bracketing for the root is scientifically consistent: use the initial temperature $T$ as the lower bound and increase the upper bound until $q_{v,\\mathrm{sat}}(T_{\\mathrm{hi}}) \\ge q_v$.\n- Enforce that $\\Delta q_c \\ge 0$; report $\\Delta q_c$ as $0$ in unsaturated cases.\n- Numerical outputs must be rounded to six decimal places.\n\nTest suite:\nProvide the following test cases to validate various regimes (happy path, unsaturated, near-saturation boundary, inclusion of pre-existing cloud water, and low-pressure effects). Each test case is a tuple $(p, T, q_v, q_c)$:\n- Case $1$: $(p = 90000\\, \\mathrm{Pa},\\, T = 285\\, \\mathrm{K},\\, q_v = 0.018,\\, q_c = 0.0)$.\n- Case $2$: $(p = 100000\\, \\mathrm{Pa},\\, T = 298\\, \\mathrm{K},\\, q_v = 0.010,\\, q_c = 0.0)$.\n- Case $3$: $(p = 80000\\, \\mathrm{Pa},\\, T = 273.15\\, \\mathrm{K},\\, q_v = 0.00476,\\, q_c = 0.0)$.\n- Case $4$: $(p = 70000\\, \\mathrm{Pa},\\, T = 265\\, \\mathrm{K},\\, q_v = 0.002,\\, q_c = 0.001)$.\n- Case $5$: $(p = 95000\\, \\mathrm{Pa},\\, T = 280\\, \\mathrm{K},\\, q_v = 0.012,\\, q_c = 0.005)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, with each inner list containing three floats $[T^\\ast, q_v^\\ast, \\Delta q_c]$ in the specified units and rounded to six decimal places. For example:\n  $$ \\texttt{[[T1,qv1,dqc1],[T2,qv2,dqc2],\\dots]} $$",
            "solution": "The posed problem is valid. It is scientifically grounded in the principles of atmospheric thermodynamics, specifically the conservation of moist enthalpy and total water during phase changes at constant pressure. The problem is well-posed, providing all necessary constants, definitions, and a clear objective function to be solved. The constraints are self-consistent, and the required numerical method is standard for this class of problem.\n\nThe objective is to develop a saturation adjustment algorithm. Given an initial state of a parcel of moist air defined by its temperature $T$, pressure $p$, water vapor specific humidity $q_v$, and liquid water specific humidity $q_c$, the algorithm must determine the final equilibrium state $(T^\\ast, q_v^\\ast, q_c^\\ast)$ that is saturated and conserves both total water and moist enthalpy.\n\nFirst, we establish the governing physical principles and equations as defined in the problem. The saturation vapor pressure $e_s$ as a function of temperature $T$ is given by the Clausius-Clapeyron relation:\n$$ e_s(T) = e_0 \\exp\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right) $$\nFrom this, the saturation specific humidity $q_{v,\\mathrm{sat}}$ at a given temperature $T$ and pressure $p$ is derived:\n$$ q_{v,\\mathrm{sat}}(T, p) = \\frac{\\varepsilon\\, e_s(T)}{p - (1 - \\varepsilon)\\, e_s(T)} $$\nwhere $\\varepsilon = R_d / R_v$ is the ratio of gas constants for dry air and water vapor.\n\nThe moist enthalpy per unit mass of moist air, $h_m$, is conserved during the condensation process. The initial enthalpy $h_{m, \\text{initial}}$ is:\n$$ h_{m, \\text{initial}} = c_{p,m}(q_v, q_t)\\, T + L_v\\, q_v $$\nThe final enthalpy $h_{m, \\text{final}}$ at temperature $T^\\ast$ and specific humidity $q_v^\\ast$ is:\n$$ h_{m, \\text{final}} = c_{p,m}(q_v^\\ast, q_t)\\, T^\\ast + L_v\\, q_v^\\ast $$\nThe effective specific heat capacity of the mixture, $c_{p,m}$, is a function of the water content:\n$$ c_{p,m}(q_v, q_t) = (1 - q_t)\\, c_{p,d} + q_v\\, c_{p,v} + (q_t - q_v)\\, c_{p,\\ell} $$\nTotal water specific humidity $q_t = q_v + q_c$ is conserved, as condensation only converts vapor to liquid.\n\nThe core of the problem lies in finding the final temperature $T^\\ast$ that satisfies two conditions simultaneously:\n1.  **Saturation**: The final state must be saturated, so $q_v^\\ast = q_{v,\\mathrm{sat}}(T^\\ast, p)$.\n2.  **Enthalpy Conservation**: $h_{m, \\text{final}} = h_{m, \\text{initial}}$.\n\nSubstituting the saturation condition into the enthalpy conservation equation yields a single nonlinear scalar equation for the unknown final temperature $T^\\ast$:\n$$ c_{p,m}(q_{v,\\mathrm{sat}}(T^\\ast, p), q_t)\\, T^\\ast + L_v\\, q_{v,\\mathrm{sat}}(T^\\ast, p) = h_{m, \\text{initial}} $$\nThis can be expressed as finding the root of the function $f(T^\\ast)$:\n$$ f(T^\\ast) = \\left[c_{p,m}(q_{v,\\mathrm{sat}}(T^\\ast, p), q_t)\\, T^\\ast + L_v\\, q_{v,\\mathrm{sat}}(T^\\ast, p)\\right] - h_{m, \\text{initial}} = 0 $$\nThe term in the square brackets represents the enthalpy of a saturated parcel at temperature $T^\\ast$. Analysis shows that $f(T^\\ast)$ is a monotonically increasing function of $T^\\ast$, which guarantees that if a solution exists, it is unique.\n\nThe algorithmic procedure begins by assessing the initial state. We calculate the saturation specific humidity at the initial temperature, $q_{v, \\text{sat}}(T, p)$.\n- If $q_v \\le q_{v, \\text{sat}}(T, p)$, the parcel is unsaturated or exactly saturated. No condensation occurs. The final state is identical to the initial state, $(T^\\ast, q_v^\\ast) = (T, q_v)$, and the amount of new condensate, $\\Delta q_c$, is $0$.\n- If $q_v  q_{v, \\text{sat}}(T, p)$, the parcel is supersaturated. An adjustment to a new saturated equilibrium is necessary. The release of latent heat ($L_v$) due to condensation will raise the temperature, so $T^\\ast  T$. We must find the root of $f(T^\\ast) = 0$.\n\nFor supersaturated cases, a numerical root-finding method is employed. The problem suggests a bisection algorithm, which requires bracketing the root. A scientifically consistent bracket is:\n- **Lower Bound ($T_{lo}$)**: The initial temperature $T$. At this temperature, $f(T) = (q_{v,\\mathrm{sat}}(T) - q_v) [L_v + T(c_{p,v} - c_{p,\\ell})]$. Since $q_v  q_{v,\\mathrm{sat}}(T)$, the first term is negative. The second term, $[L_v + T(c_{p,v} - c_{p,\\ell})]$, is positive for typical atmospheric temperatures. Thus, $f(T)  0$.\n- **Upper Bound ($T_{hi}$)**: A temperature high enough to ensure $f(T_{hi})  0$. Such a condition is met if we find a $T_{hi}$ where the parcel would be unsaturated even with the initial amount of vapor, i.e., $q_{v,\\mathrm{sat}}(T_{hi}, p) \\ge q_v$. An iterative search starting from $T$ can establish this bound.\n\nWith the root $T^\\ast$ bracketed in $[T_{lo}, T_{hi}]$, the bisection method can be applied to find $T^\\ast$ to a desired precision. Once $T^\\ast$ is known, the final state variables are calculated:\n- Final water vapor specific humidity: $q_v^\\ast = q_{v, \\text{sat}}(T^\\ast, p)$.\n- Amount of condensed water: $\\Delta q_c = q_v - q_v^\\ast$.\n- Final liquid water specific humidity: $q_c^\\ast = q_c + \\Delta q_c$.\n\nThe implementation will consist of functions for the physical quantities ($e_s, q_{v,\\mathrm{sat}}, c_{p,m}, h_m$), a bisection solver, and a main routine to process the specified test cases according to this logic.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a saturation adjustment algorithm for atmospheric water phase changes.\n    \"\"\"\n    # Define physical constants in SI units\n    CPD = 1004.0  # J/kg/K, specific heat of dry air\n    CPV = 1860.0  # J/kg/K, specific heat of water vapor\n    CPL = 4186.0  # J/kg/K, specific heat of liquid water\n    LV = 2.5e6    # J/kg, latent heat of vaporization\n    RD = 287.05   # J/kg/K, gas constant for dry air\n    RV = 461.5    # J/kg/K, gas constant for water vapor\n    EPS = RD / RV # Ratio of gas constants\n    T0 = 273.15   # K, reference temperature for Clausius-Clapeyron\n    E0 = 611.2    # Pa, saturation vapor pressure at T0\n\n    def e_s(T):\n        \"\"\"Calculates saturation vapor pressure (Pa) using the Clausius-Clapeyron eq.\"\"\"\n        return E0 * np.exp((LV / RV) * (1.0 / T0 - 1.0 / T))\n\n    def q_vsat(T, p):\n        \"\"\"Calculates saturation specific humidity (dimensionless).\"\"\"\n        es_T = e_s(T)\n        denominator = p - (1.0 - EPS) * es_T\n        if denominator = 0:\n            # Handle physically unrealistic pressure/temp where p = e_s\n            return np.inf\n        return (EPS * es_T) / denominator\n\n    def c_pm(qv, qt):\n        \"\"\"Calculates moist specific heat capacity (J/kg/K).\"\"\"\n        return (1.0 - qt) * CPD + qv * CPV + (qt - qv) * CPL\n\n    def h_m(T, qv, qt):\n        \"\"\"Calculates moist enthalpy (J/kg).\"\"\"\n        return c_pm(qv, qt) * T + LV * qv\n\n    def bisection(f, a, b, tol=1e-9):\n        \"\"\"\n        A robust bisection root-finding algorithm.\n        Finds a root of f(x) = 0 in the interval [a, b].\n        \"\"\"\n        fa = f(a)\n        fb = f(b)\n        if fa * fb >= 0:\n            # This case should be prevented by the bracketing logic.\n            if abs(fa)  tol: return a\n            if abs(fb)  tol: return b\n            raise ValueError(\"Root not bracketed or function has same sign at endpoints.\")\n\n        while (b - a) > tol:\n            c = (a + b) / 2.0\n            fc = f(c)\n            if abs(fc)  tol:\n                return c\n            if fa * fc  0:\n                b = c\n            else:\n                a = c\n                fa = fc\n        return (a + b) / 2.0\n\n    test_cases = [\n        (90000.0, 285.0, 0.018, 0.0),\n        (100000.0, 298.0, 0.010, 0.0),\n        (80000.0, 273.15, 0.00476, 0.0),\n        (70000.0, 265.0, 0.002, 0.001),\n        (95000.0, 280.0, 0.012, 0.005),\n    ]\n\n    results = []\n    for p, T, qv, qc in test_cases:\n        qv_sat_initial = q_vsat(T, p)\n\n        if qv = qv_sat_initial:\n            # Parcel is unsaturated or just saturated: no condensation occurs.\n            T_star = T\n            qv_star = qv\n            delta_qc = 0.0\n        else:\n            # Parcel is supersaturated: perform saturation adjustment.\n            qt = qv + qc\n            h_initial = h_m(T, qv, qt)\n\n            # Define the objective function f(T*) = h_final(T*) - h_initial = 0\n            def root_function(T_new):\n                qv_sat_new = q_vsat(T_new, p)\n                h_new = h_m(T_new, qv_sat_new, qt)\n                return h_new - h_initial\n\n            # Establish a bracket [T_lo, T_hi] for the root T*.\n            # T* > T because latent heat is released.\n            T_lo = T\n            \n            # Find an upper bound T_hi where f(T_hi) > 0.\n            # This is guaranteed if q_vsat(T_hi) > qv.\n            T_hi = T + 0.1  # Start search slightly above T\n            while q_vsat(T_hi, p)  qv:\n                T_hi += 1.0\n\n            # Find the root T_star using bisection.\n            T_star = bisection(root_function, T_lo, T_hi)\n\n            # Calculate final state variables.\n            qv_star = q_vsat(T_star, p)\n            delta_qc = qv - qv_star\n\n        results.append([round(T_star, 6), round(qv_star, 6), round(delta_qc, 6)])\n\n    # Format the final output string to exactly match the problem specification,\n    # specifically ensuring no spaces within the list structures.\n    formatted_results = [','.join(map(str, res)) for res in results]\n    print(f\"[[{'],['.join(formatted_results)}]]\")\n\nsolve()\n```"
        }
    ]
}