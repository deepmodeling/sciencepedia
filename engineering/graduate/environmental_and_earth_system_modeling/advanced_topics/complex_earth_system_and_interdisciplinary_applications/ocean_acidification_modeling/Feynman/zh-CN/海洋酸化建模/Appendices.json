{
    "hands_on_practices": [
        {
            "introduction": "从理论到实践，我们的第一个练习将解决海洋碳酸盐系统模型的核心问题。我们将实现一个数值模型，从总碱度（TA）和溶解无机碳（DIC）这两个主控变量出发，计算海洋酸化的关键指标，如 $pH$ 和 $p\\mathrm{CO_2}$。该练习旨在培养应用复杂的经验公式，并使用数值求根技术求解系统控制性非线性方程的基本技能 。",
            "id": "3900680",
            "problem": "海水中的碳酸盐化学可以通过质量守恒、电中性（电荷平衡）和化学平衡等基本定律来建模。您需要根据给定的温度、盐度和压力，使用广泛接受的海水平衡常数，通过总碱度 (TA) 和溶解无机碳 (DIC) 来计算海水的酸度（量化为氢离子浓度的以10为底的负对数 $pH = -\\log_{10}([H^+])$）和二氧化碳分压 $p\\mathrm{CO_2}$。\n\n基本关系如下。溶解无机碳 (DIC) 分布于水合二氧化碳（$[CO_2]$，其中包括 $[H_2CO_3]$）、碳酸氢根（$[HCO_3^-]$）和碳酸根（$[CO_3^{2-}]$）之间，因此质量守恒给出\n$$\n\\mathrm{DIC} = [CO_2] + [HCO_3^-] + [CO_3^{2-}].\n$$\n海水中碳酸系统的化学平衡由两个解离步骤控制，其平衡常数为 $K_1$ 和 $K_2$：\n$$\nK_1 = \\frac{[H^+][HCO_3^-]}{[CO_2]}, \\qquad K_2 = \\frac{[H^+][CO_3^{2-}]}{[HCO_3^-]}.\n$$\n由此，对于给定的氢离子浓度 $[H^+]$，物种分布可以以 $\\mathrm{DIC}$ 的形式写为：\n$$\n\\alpha_0 = 1,\\quad \\alpha_1 = \\frac{K_1}{[H^+]},\\quad \\alpha_2 = \\frac{K_1 K_2}{[H^+]^2},\\quad\n[CO_2] = \\frac{\\mathrm{DIC}}{\\alpha_0 + \\alpha_1 + \\alpha_2},\\quad\n[HCO_3^-] = \\frac{\\mathrm{DIC}\\,\\alpha_1}{\\alpha_0 + \\alpha_1 + \\alpha_2},\\quad\n[CO_3^{2-}] = \\frac{\\mathrm{DIC}\\,\\alpha_2}{\\alpha_0 + \\alpha_1 + \\alpha_2}.\n$$\n总碱度 (TA) 由电中性条件定义，对于本问题，必须包括来自碳酸盐系统、硼酸盐、水的自电离和自由质子的主要贡献，表示为：\n$$\n\\mathrm{TA} = [HCO_3^-] + 2[CO_3^{2-}] + [B(OH)_4^-] + [OH^-] - [H^+],\n$$\n其中硼酸盐碱度 $[B(OH)_4^-]$ 可通过硼酸解离常数 $K_B$ 和总硼浓度 $B_T$ 得出：\n$$\n[B(OH)_4^-] = B_T \\frac{K_B}{K_B + [H^+]},\n$$\n水的自电离给出：\n$$\n[OH^-] = \\frac{K_W}{[H^+]}.\n$$\n亨利定律通过溶解度常数 $K_0$ 将水中的二氧化碳与其分压关联起来：\n$$\np\\mathrm{CO_2} = \\frac{[CO_2]}{K_0}.\n$$\n常数 $K_1$、$K_2$、$K_B$、$K_W$ 和 $K_0$ 取决于温度和盐度。请使用以下经过充分检验的公式，其中温度 $T$ 以开尔文为单位，盐度 $S$ 为实用盐度（无量纲），并通过使用表层压力下的这些 $K$ 值来处理压力依赖性。在总pH标度下，碳酸平衡的 $pK$ 值由 Lueker 等人对 Mehrbach 的数据重新拟合给出：\n$$\npK_1 = \\frac{3633.86}{T} - 61.2172 + 9.6777\\ln T - 0.011555\\,S + 0.0001152\\,S^2,\n$$\n$$\npK_2 = \\frac{471.78}{T} + 25.9290 - 3.16967\\ln T - 0.01781\\,S + 0.0001122\\,S^2,\n$$\n其中 $K_1 = 10^{-pK_1}$，$K_2 = 10^{-pK_2}$。在总pH标度下，硼酸常数 $K_B$（由 Dickson 提出）为：\n$$\n\\ln K_B = \\frac{-8966.90 - 2890.53\\sqrt{S} - 77.942\\,S + 1.728\\,S^{3/2} - 0.0996\\,S^2}{T}\n+ 148.0248 + 137.1942\\sqrt{S} + 1.62142\\,S\n- \\left(24.4344 + 25.085\\sqrt{S} + 0.2474\\,S\\right)\\ln T + 0.053105\\sqrt{S}\\,T,\n$$\n水的离子积 $K_W$（由 Millero 提出）为：\n$$\n\\ln K_W = \\frac{-13847.26}{T} + 148.9652 - 23.6521\\ln T + \\sqrt{S}\\left(\\frac{118.67}{T} - 5.977 + 1.0495\\ln T\\right) - 0.01615\\,S.\n$$\n使用 $K_B = \\exp(\\ln K_B)$ 和 $K_W = \\exp(\\ln K_W)$ 将对数转换为线性常数。二氧化碳的溶解度 $K_0$（由 Weiss 提出）为：\n$$\n\\ln K_0 = A_1 + A_2\\left(\\frac{100}{T}\\right) + A_3 \\ln\\left(\\frac{T}{100}\\right) + S\\left(B_1 + B_2 \\frac{T}{100} + B_3 \\left(\\frac{T}{100}\\right)^2\\right),\n$$\n其中 $A_1 = -58.0931$, $A_2 = 90.5069$, $A_3 = 22.2940$, $B_1 = 0.027766$, $B_2 = -0.025888$, $B_3 = 0.0050578$，$K_0 = \\exp(\\ln K_0)$。总硼浓度为 $B_T = 0.0004157\\,(S/35)$，单位为摩尔/千克海水。\n\n对于每个测试用例，您必须使用上述定义和给定的 $\\mathrm{DIC}$，通过寻找以下方程的唯一根来求解关于 $[H^+]$ 的非线性电荷平衡方程：\n$$\nf([H^+]) \\equiv \\mathrm{TA} - \\left([HCO_3^-] + 2[CO_3^{2-}] + [B(OH)_4^-] + [OH^-] - [H^+]\\right) = 0,\n$$\n然后根据亨利定律计算 $pH = -\\log_{10}([H^+])$ 和 $p\\mathrm{CO_2}$。计算中，将单位为微当量/千克的 $\\mathrm{TA}$ 和单位为微摩尔/千克的 $\\mathrm{DIC}$ 都乘以 $10^{-6}$ 转换为摩尔/千克。温度以摄氏度给出，必须加上 273.15 转换为开尔文。压力以分巴给出；对于本问题的测试套件，所有压力均为 0 分巴，因此平衡常数在表层压力下进行评估。\n\n将 $pH$ 表示为无量纲量，四舍五入到四位小数。将 $p\\mathrm{CO_2}$ 以微大气压为单位表示，四舍五入到一位小数，使用 $1\\,\\mathrm{atm} = 10^6\\,\\mu\\mathrm{atm}$。每个测试用例的最终输出必须是一个包含两个浮点数的列表 $[pH, p\\mathrm{CO_2}]$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例对应一个双元素列表，并按下述顺序排列。例如，输出格式必须类似于 $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$。\n\n测试套件（请严格使用这些参数集）：\n- 案例1（一般情况）：$T = 25$ 摄氏度, $S = 35$, 压力 $= 0$ 分巴, $\\mathrm{TA} = 2300$ 微当量/千克, $\\mathrm{DIC} = 2000$ 微摩尔/千克。\n- 案例2（冷表层水）：$T = 2$ 摄氏度, $S = 35$, 压力 $= 0$ 分巴, $\\mathrm{TA} = 2300$ 微当量/千克, $\\mathrm{DIC} = 2000$ 微摩尔/千克。\n- 案例3（暖、高盐度, $\\mathrm{DIC} \\approx \\mathrm{TA}$）：$T = 30$ 摄氏度, $S = 38$, 压力 $= 0$ 分巴, $\\mathrm{TA} = 2300$ 微当量/千克, $\\mathrm{DIC} = 2300$ 微摩尔/千克。\n- 案例4（低盐度，高 $\\mathrm{DIC}$）：$T = 15$ 摄氏度, $S = 30$, 压力 $= 0$ 分巴, $\\mathrm{TA} = 2000$ 微当量/千克, $\\mathrm{DIC} = 2200$ 微摩尔/千克。\n- 案例5（高碱度、低 $\\mathrm{DIC}$ 的边界情况）：$T = 25$ 摄氏度, $S = 35$, 压力 $= 0$ 分巴, $\\mathrm{TA} = 2400$ 微当量/千克, $\\mathrm{DIC} = 1800$ 微摩尔/千克。\n\n您的程序必须计算上述五个案例的结果，并严格按照以下格式打印单行输出：\n$$\n[[pH_1,p\\mathrm{CO_2}_1],[pH_2,p\\mathrm{CO_2}_2],[pH_3,p\\mathrm{CO_2}_3],[pH_4,p\\mathrm{CO_2}_4],[pH_5,p\\mathrm{CO_2}_5]].\n$$",
            "solution": "该问题要求从四个关键输入参数：总碱度（$\\mathrm{TA}$）、溶解无机碳（$\\mathrm{DIC}$）、温度（$T$）和盐度（$S$）计算海水酸度（$pH$）和二氧化碳分压（$p\\mathrm{CO_2}$）。压力给定为零分巴，对应于表层条件。这是化学海洋学中的一个经典问题，其解决方案依赖于求解控制海洋碳酸盐系统的方程组。\n\n分析过程被构建为一个数值求根问题。问题的核心是电荷平衡方程，它由总碱度的公式表示。我们的目标是找到满足给定 $\\mathrm{TA}$ 和 $\\mathrm{DIC}$ 条件下该方程的氢离子浓度 $[H^+]$。一旦 $[H^+]$ 被确定，所有其他量，包括 $pH$ 和 $p\\mathrm{CO_2}$，就可以直接计算出来。\n\n对于每个测试用例，解决方案通过以下步骤序列实现：\n\n1.  **初始化和单位转换**：处理输入参数。将以摄氏度为单位的温度转换为开尔文绝对温标（$T_K = T_C + 273.15$）。将以微单位（分别为 $\\mu\\mathrm{eq/kg}$ 和 $\\mu\\mathrm{mol/kg}$）给出的总碱度和溶解无机碳乘以 $10^{-6}$，转换为它们的基本单位摩尔/千克海水（$\\mathrm{mol/kg}$）。\n\n2.  **计算平衡常数和溶解度常数**：碳酸盐系统、硼酸盐系统和水的自电离的化学平衡高度依赖于温度和盐度。对于每组 ($T, S$)，使用指定的经验公式计算以下常数：\n    -   碳酸的第一和第二解离常数 $K_1$ 和 $K_2$，根据 $pK_1$ 和 $pK_2$ 的关系式（Lueker 等人重新拟合）。注意 $K = 10^{-pK}$。\n    -   硼酸的解离常数 $K_B$，根据其 $\\ln K_B$ 公式（Dickson）。\n    -   水的离子积 $K_W$，根据其 $\\ln K_W$ 公式（Millero）。\n    -   $\\mathrm{CO_2}$ 的溶解度 $K_0$，根据其 $\\ln K_0$ 公式（Weiss）。\n    -   对于以自然对数（$\\ln K$）给出的常数，通过 $K = \\exp(\\ln K)$ 找到线性值。\n    -   总硼浓度 $B_T$ 随盐度线性变化，也计算为 $B_T = 0.0004157 \\cdot (S/35)$。\n\n3.  **定义求根函数**：中心任务是求解 $[H^+]$。这是通过找到残差函数 $f([H^+])$ 的根来实现的，该函数表示给定的 $\\mathrm{TA}$ 与根据化学物种浓度计算出的 TA 之间的差异：\n    $$\n    f([H^+]) = \\mathrm{TA}_{\\text{given}} - \\mathrm{TA}_{\\text{calculated}}([H^+]) = 0\n    $$\n    计算出的碱度 $\\mathrm{TA}_{\\text{calculated}}$ 定义为：\n    $$\n    \\mathrm{TA}_{\\text{calculated}} = [HCO_3^-] + 2[CO_3^{2-}] + [B(OH)_4^-] + [OH^-] - [H^+]\n    $$\n    此表达式中的每个浓度项都是 $[H^+]$ 和先前计算的常数的函数：\n    -   碳酸盐物种（$[HCO_3^-]$、$[CO_3^{2-}]$）用 $\\mathrm{DIC}$、$[H^+]$、$K_1$ 和 $K_2$ 表示。为了提高数值稳定性，表达式被重新整理为：\n        $$[HCO_3^-] = \\mathrm{DIC} \\frac{K_1 [H^+]}{[H^+]^2 + K_1 [H^+] + K_1 K_2}$$\n        $$[CO_3^{2-}] = \\mathrm{DIC} \\frac{K_1 K_2}{[H^+]^2 + K_1 [H^+] + K_1 K_2}$$\n    -   硼酸盐物种由下式给出：$[B(OH)_4^-] = B_T \\frac{K_B}{K_B + [H^+]}$\n    -   氢氧根浓度为：$[OH^-] = K_W / [H^+]$\n\n4.  **$[H^+]$的数值解**：非线性方程 $f([H^+]) = 0$ 使用数值求根算法求解。Brent 方法（`scipy.optimize.brentq`）是一个绝佳的选择，因为它鲁棒且高效，前提是提供一个函数值变号的区间。对于海洋碳酸盐系统，函数 $f([H^+])$ 是单调的。一个合适的 $[H^+]$ 搜索区间是从 $10^{-9}$ 到 $10^{-6}$ $\\mathrm{mol/kg}$，这对应于 9 到 6 的 $pH$ 范围，能够安全地包含所有可能的海洋条件。\n\n5.  **最终量的计算**：在找到氢离子浓度的唯一解 $[H^+]_{sol}$ 后：\n    -   $pH$ 使用其定义计算：$pH = -\\log_{10}([H^+]_{sol})$。\n    -   水中二氧化碳的浓度 $[CO_2]$ 使用确定的 $[H^+]_{sol}$ 计算：\n        $$[CO_2] = \\mathrm{DIC} \\frac{[H^+]_{sol}^2}{[H^+]_{sol}^2 + K_1 [H^+]_{sol} + K_1 K_2}$$\n    -   然后从亨利定律找到 $\\mathrm{CO_2}$ 的分压：$p\\mathrm{CO_2} = [CO_2] / K_0$。结果最初以大气压为单位，通过乘以 $10^6$ 转换为微大气压。\n\n6.  **输出格式化**：每个测试用例最终计算出的 $pH$ 和 $p\\mathrm{CO_2}$ 值分别四舍五入到四位和一位小数，并格式化为指定的列表结构。对所有提供的测试用例重复此过程，以生成完整的最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes pH and pCO2 for seawater from Total Alkalinity, Dissolved Inorganic Carbon,\n    temperature, and salinity, based on standard oceanographic chemical models.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (general case)\n        (25, 35, 2300, 2000),\n        # Case 2 (cold surface water)\n        (2, 35, 2300, 2000),\n        # Case 3 (warm, high salinity, DIC ≈ TA)\n        (30, 38, 2300, 2300),\n        # Case 4 (lower salinity, higher DIC)\n        (15, 30, 2000, 2200),\n        # Case 5 (boundary with higher alkalinity and lower DIC)\n        (25, 35, 2400, 1800),\n    ]\n\n    def calculate_parameters(T_C, S):\n        \"\"\"\n        Calculates all temperature- and salinity-dependent equilibrium constants.\n        T_C: Temperature in degrees Celsius\n        S: Salinity in Practical Salinity Scale (dimensionless)\n        \"\"\"\n        T = T_C + 273.15  # Temperature in Kelvin\n        sqrt_S = np.sqrt(S)\n        ln_T = np.log(T)\n\n        # K1, K2 from Lueker et al. (2000)\n        pK1 = 3633.86/T - 61.2172 + 9.67770 * ln_T - 0.011555 * S + 0.0001152 * S**2\n        K1 = 10**(-pK1)\n\n        pK2 = 471.78/T + 25.9290 - 3.16967 * ln_T - 0.01781 * S + 0.0001122 * S**2\n        K2 = 10**(-pK2)\n\n        # KB from Dickson (1990)\n        ln_KB_num = (\n            -8966.90 - 2890.53 * sqrt_S - 77.942 * S + 1.728 * S**1.5 - 0.0996 * S**2\n        )\n        ln_KB = (\n            ln_KB_num / T\n            + 148.0248 + 137.1942 * sqrt_S + 1.62142 * S\n            - (24.4344 + 25.085 * sqrt_S + 0.2474 * S) * ln_T\n            + 0.053105 * sqrt_S * T\n        )\n        KB = np.exp(ln_KB)\n\n        # KW from Millero (1995)\n        ln_KW = (\n            148.9652 - 13847.26/T - 23.6521 * ln_T\n            + sqrt_S * (118.67/T - 5.977 + 1.0495 * ln_T)\n            - 0.01615 * S\n        )\n        KW = np.exp(ln_KW)\n\n        # K0 from Weiss (1974)\n        A1, A2, A3 = -58.0931, 90.5069, 22.2940\n        B1, B2, B3 = 0.027766, -0.025888, 0.0050578\n        T100 = T / 100.0\n        ln_K0 = (\n            A1 + A2 * (100.0/T) + A3 * np.log(T100)\n            + S * (B1 + B2 * T100 + B3 * T100**2)\n        )\n        K0 = np.exp(ln_K0)\n\n        # Total Boron (Uppstrom, 1974)\n        BT = 0.0004157 * (S / 35.0)\n\n        return {'K1': K1, 'K2': K2, 'KB': KB, 'KW': KW, 'K0': K0, 'BT': BT}\n\n    def alkalinity_residual(H, TA, DIC, params):\n        \"\"\"\n        Calculates the residual of the total alkalinity equation.\n        f(H) = TA_given - TA_calculated(H)\n        H: Hydrogen ion concentration [mol/kg]\n        TA: Total Alkalinity [mol/kg]\n        DIC: Dissolved Inorganic Carbon [mol/kg]\n        params: Dictionary of equilibrium constants and BT\n        \"\"\"\n        K1, K2, KB, KW, BT = params['K1'], params['K2'], params['KB'], params['KW'], params['BT']\n\n        # Numerically stable denominator for carbonate species\n        carb_denom = H**2 + K1 * H + K1 * K2\n\n        HCO3 = DIC * (K1 * H / carb_denom)\n        CO3 = DIC * (K1 * K2 / carb_denom)\n        BOH4 = BT * KB / (KB + H)\n        OH = KW / H\n        \n        # Note: the H term is subtracted as per the TA definition\n        TA_calc = HCO3 + 2 * CO3 + BOH4 + OH - H\n        \n        return TA - TA_calc\n\n    results = []\n    for case in test_cases:\n        T_C, S, TA_micro, DIC_micro = case\n        \n        # Convert units from micro- to base units\n        TA = TA_micro * 1e-6\n        DIC = DIC_micro * 1e-6\n\n        # Step 1: Calculate all T/S-dependent parameters\n        params = calculate_parameters(T_C, S)\n\n        # Step 2: Solve for H+ concentration using a root-finder\n        # The bracketing interval [1e-9, 1e-6] corresponds to a pH of [9, 6]\n        H_sol = brentq(alkalinity_residual, 1e-9, 1e-6, args=(TA, DIC, params))\n\n        # Step 3: Calculate final quantities\n        pH = -np.log10(H_sol)\n\n        # Calculate [CO2]\n        carb_denom = H_sol**2 + params['K1'] * H_sol + params['K1'] * params['K2']\n        CO2_aq = DIC * (H_sol**2 / carb_denom)\n\n        # Calculate pCO2\n        pCO2_atm = CO2_aq / params['K0']\n        pCO2_muatm = pCO2_atm * 1e6\n        \n        # Step 4: Round and store results\n        results.append([round(pH, 4), round(pCO2_muatm, 1)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "任何模型预测的可靠性都取决于其输入参数的准确性。下一个练习通过一阶微扰分析，引入了模型敏感性这一关键概念。通过研究在总碱度和溶解无机碳固定的约束下，$\\mathrm{CO_2}$ 溶解度常数 ($K_0$) 的微小误差如何传递到计算出的 $p\\mathrm{CO_2}$，你将更深入地理解误差传播以及碳酸盐系统各组分间的内在联系 。",
            "id": "3900716",
            "problem": "在一个固定温度、盐度和压力的海水碳酸盐系统模型中，预测的二氧化碳分压 $p\\mathrm{CO_2}$ 是根据测量的总碱度 (TA) 和溶解无机碳 (DIC) 来确定的。设总碱度表示为 $A_T$，溶解无机碳表示为 $C_T$。考虑由一级和二级解离常数 $K_1$ 和 $K_2$、水的自递质解离 $K_W$ 以及诸如硼酸盐（总硼浓度为 $B_T$，平衡常数为 $K_B$）等次要酸碱体系控制的标准水合二氧化碳 ($\\mathrm{CO_2^\\ast}$)-碳酸氢盐-碳酸盐平衡。水合二氧化碳浓度 $[\\mathrm{CO_2^\\ast}]$ 等于溶解的分子二氧化碳和碳酸浓度之和。海-气分配由亨利定律给出，溶解度为 $K_0$，因此有 $[\\mathrm{CO_2^\\ast}] = K_0\\,p\\mathrm{CO_2}$。\n\n假设 $A_T$ 和 $C_T$ 保持固定，温度和盐度也固定，因此 $K_0, K_1, K_2, K_W$ 和 $K_B$ 相对于组分变化是常数，并且来自磷酸盐和硅酸盐等营养盐的贡献可以忽略不计。碳酸盐形态满足质量作用和电荷平衡，其中\n$$\nC_T \\;=\\; [\\mathrm{CO_2^\\ast}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}],\n$$\n以及\n$$\nA_T \\;=\\; [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + \\frac{B_T K_B}{K_B + [\\mathrm{H^+}]} + \\frac{K_W}{[\\mathrm{H^+}]} - [\\mathrm{H^+}],\n$$\n其中 $[\\mathrm{H^+}]$ 通过平衡关系决定所有物种的浓度，并且所有常数都独立于 $K_0$。\n\n对预测的 $p\\mathrm{CO_2}$ 进行关于 $K_0$ 的一个小的相对微扰 $\\epsilon$ 的一阶微扰分析，即令 $K_0 \\mapsto K_0(1+\\epsilon)$ 且 $|\\epsilon|\\ll 1$，同时保持 $A_T$ 和 $C_T$ 固定。根据上述控制定义和约束证明每一步，用 $\\epsilon$ 推导一阶分数变化 $\\delta p\\mathrm{CO_2}/p\\mathrm{CO_2}$，然后计算当 $\\epsilon = 0.02$ 时的结果。\n\n将最终结果表示为单个无量纲十进制数。不要使用百分号。无需进行取整，写成有限小数即可。",
            "solution": "该问题要求在总碱度（$A_T$）和总溶解无机碳（$C_T$）固定的条件下，对亨利定律常数 $K_0$ 的一个微小扰动如何影响计算出的 $p\\mathrm{CO_2}$ 进行一阶微扰分析。\n\n1.  **系统状态的确定**：在给定的温度、盐度和压力下，海水碳酸盐系统的化学状态（即所有溶解物质的浓度，包括 $[\\mathrm{H^+}]$、$[\\mathrm{CO_2^\\ast}]$、$[\\mathrm{HCO_3^-}]$、$[\\mathrm{CO_3^{2-}}]$ 等）完全由两个主控变量（此处为 $A_T$ 和 $C_T$）以及相关的平衡常数（$K_1, K_2, K_B, K_W$ 等）唯一确定。\n\n2.  **核心约束**：问题的关键约束是 $A_T$ 和 $C_T$ 保持不变。此外，问题明确指出，平衡常数 $K_1, K_2, K_B, K_W$ 等独立于 $K_0$。\n\n3.  **微扰的影响**：当 $K_0$ 受到微扰时（$K_0 \\to K_0(1+\\epsilon)$），由于 $A_T$ 和 $C_T$ 不变，并且决定水相化学平衡的其他所有常数也不变，因此整个水相化学平衡系统并未受到影响。这意味着，所有水相中物质的浓度都必须保持不变。特别地，氢离子浓度 $[\\mathrm{H^+}]$ 和水合二氧化碳浓度 $[\\mathrm{CO_2^\\ast}]$ 均保持不变。我们可以表示为 $\\delta[\\mathrm{CO_2^\\ast}] = 0$。\n\n4.  **应用亨利定律**：亨利定律将水相浓度与气相分压联系起来：$[\\mathrm{CO_2^\\ast}] = K_0\\,p\\mathrm{CO_2}$。我们可以对该方程进行全微分：\n    $$\n    d[\\mathrm{CO_2^\\ast}] = p\\mathrm{CO_2}\\,dK_0 + K_0\\,d(p\\mathrm{CO_2})\n    $$\n    根据第3点的结论，在我们的微扰下，$d[\\mathrm{CO_2^\\ast}] = 0$。因此：\n    $$\n    0 = p\\mathrm{CO_2}\\,dK_0 + K_0\\,d(p\\mathrm{CO_2})\n    $$\n\n5.  **推导分数变化**：整理上式，我们得到：\n    $$\n    K_0\\,d(p\\mathrm{CO_2}) = -p\\mathrm{CO_2}\\,dK_0\n    $$\n    将两边同时除以 $K_0\\,p\\mathrm{CO_2}$（假设它们不为零，这在物理上是成立的），我们得到分数变化之间的关系：\n    $$\n    \\frac{d(p\\mathrm{CO_2})}{p\\mathrm{CO_2}} = -\\frac{dK_0}{K_0}\n    $$\n\n6.  **计算结果**：对于一阶小微扰，我们可以将微分形式替换为差分形式 $\\delta$。给定 $K_0$ 的微扰是 $K_0 \\to K_0(1+\\epsilon)$，因此 $\\delta K_0 = K_0(1+\\epsilon) - K_0 = K_0\\epsilon$。$K_0$ 的分数变化是 $\\frac{\\delta K_0}{K_0} = \\epsilon$。\n    因此，$p\\mathrm{CO_2}$ 的一阶分数变化为：\n    $$\n    \\frac{\\delta p\\mathrm{CO_2}}{p\\mathrm{CO_2}} = -\\epsilon\n    $$\n    当 $\\epsilon = 0.02$ 时，所求的分数变化为 $-0.02$。\n\n这个结果直观地表明，在 $A_T$ 和 $C_T$ 固定的系统中，为了维持水相中二氧化碳浓度不变，二氧化碳分压必须与溶解度常数成反比变化。",
            "answer": "$$\n\\boxed{-0.02}\n$$"
        },
        {
            "introduction": "我们的模型常常依赖于一个简化假设，即化学反应是瞬时完成的。最后一个练习将通过探索碳酸盐系统中的一个关键反应——$\\mathrm{CO_2}$ 水合作用的动力学，来审视这一观点。你将推导并实现一个弛豫模型，以量化其与瞬时平衡假设的偏差，从而深入了解这些反应的时间尺度以及动力学限制在何种条件下会变得重要 。",
            "id": "3900695",
            "problem": "考虑与海洋酸化模型相关的水中二氧化碳水合作用。基元反应是溶解的二氧化碳可逆水合为碳酸，写作 $\\mathrm{CO_2(aq)} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{H_2CO_3}$。假设水活度基本恒定，该反应可以用准一级动力学来建模，其正向速率常数为$k_f$，逆向速率常数为$k_r$，单位均为 $\\mathrm{s^{-1}}$。令$C(t)$表示溶解二氧化碳的浓度，单位为 $\\mathrm{mol\\ kg^{-1}}$，$H(t)$表示碳酸的浓度，单位为 $\\mathrm{mol\\ kg^{-1}}$。在短时间尺度上，忽略与大气的任何交换以及碳酸的任何酸碱离解。在这些假设下，总水合碳 $C_t = C(t) + H(t)$ 是守恒的。使用质量作用定律和$C_t$守恒，建立控制常微分方程（常微分方程(ODE)指涉及单个自变量的函数及其导数的微分方程），并推导出一个用$k_f$、$k_r$、$C_t$和初始条件$H(0) = H_0$表示的$H(t)$的弛豫表达式。\n\n将瞬时平衡假设定义为这样一个模型：对于所有$t  0$，它将$H(t)$设为等于平衡浓度$H_{\\mathrm{eq}}$，其中$H_{\\mathrm{eq}}$由比率$k_f/k_r$和守恒的$C_t$决定。通过无量纲相对偏差来量化动力学弛豫模型与瞬时平衡假设之间的差异：\n$$\n\\varepsilon(t) = \\frac{H_{\\mathrm{kin}}(t) - H_{\\mathrm{eq}}}{H_{\\mathrm{eq}}},\n$$\n其中$H_{\\mathrm{kin}}(t)$是弛豫ODE的解，$H_{\\mathrm{eq}}$是由速率常数所隐含的平衡值。\n\n编写一个完整的、可运行的程序，对于一组指定的测试用例，在每个用例的指定评估时间$T$计算$\\varepsilon(T)$。所有浓度单位必须为$\\mathrm{mol\\ kg^{-1}}$，所有速率常数单位为$\\mathrm{s^{-1}}$，所有时间单位为$\\mathrm{s}$。程序必须实现解析推导的弛豫解，且不得使用数值ODE求解器。\n\n测试组（每个用例为 $(k_f, k_r, C_t, H_0, T)$）：\n\n- 情况1：$(k_f = 0.03\\,\\mathrm{s^{-1}},\\ k_r = 23.0\\,\\mathrm{s^{-1}},\\ C_t = 1.0\\times 10^{-4}\\,\\mathrm{mol\\ kg^{-1}},\\ H_0 = 0\\,\\mathrm{mol\\ kg^{-1}},\\ T = 0.043478\\,\\mathrm{s})$；该评估时间约为弛豫时间尺度 $1/(k_f + k_r)$。\n- 情况2：$(k_f = 0.03\\,\\mathrm{s^{-1}},\\ k_r = 23.0\\,\\mathrm{s^{-1}},\\ C_t = 1.0\\times 10^{-4}\\,\\mathrm{mol\\ kg^{-1}},\\ H_0 = 0\\,\\mathrm{mol\\ kg^{-1}},\\ T = 60\\,\\mathrm{s})$；测试长时间极限。\n- 情况3：$(k_f = 0.03\\,\\mathrm{s^{-1}},\\ k_r = 23.0\\,\\mathrm{s^{-1}},\\ C_t = 1.0\\times 10^{-4}\\,\\mathrm{mol\\ kg^{-1}},\\ H_0 = 3.0\\times 10^{-7}\\,\\mathrm{mol\\ kg^{-1}},\\ T = 0.01\\,\\mathrm{s})$；测试相对于平衡状态的初始碳酸过饱和情况。\n- 情况4：$(k_f = 0.03\\,\\mathrm{s^{-1}},\\ k_r = 23.0\\,\\mathrm{s^{-1}},\\ C_t = 1.0\\times 10^{-4}\\,\\mathrm{mol\\ kg^{-1}},\\ H_0 = 0\\,\\mathrm{mol\\ kg^{-1}},\\ T = 0\\,\\mathrm{s})$；测试初始时间的边界条件。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序与给定用例的顺序一致，其中每个元素是该用例的$\\varepsilon(T)$的浮点值（例如，“$[x_1,x_2,x_3,x_4]$”）。",
            "solution": "该问题被评估为有效，因为它在科学上是合理的，问题表述清晰，并包含唯一解所需的所有必要信息。以下是完整的推导和解答。\n\n问题的核心是在一个封闭水系统中，对受可逆准一级反应 $\\mathrm{CO_2(aq)} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{H_2CO_3}$ 控制的碳酸浓度$H(t)$的时间演化进行建模。\n\n首先，我们建立$H(t)$的控制常微分方程。$H(t)$的变化速率是它由$\\mathrm{CO_2(aq)}$生成的速率减去它分解回$\\mathrm{CO_2(aq)}$的速率。根据给定准一级动力学的质量作用定律，这表示为：\n$$\n\\frac{dH(t)}{dt} = k_f C(t) - k_r H(t)\n$$\n其中$C(t)$是水中$\\mathrm{CO_2}$的浓度，$k_f$是正向速率常数，$k_r$是逆向速率常数。\n\n问题指出，总水合碳$C_t = C(t) + H(t)$是守恒的。我们可以利用这个守恒定律从速率方程中消去$C(t)$：\n$$\nC(t) = C_t - H(t)\n$$\n将此表达式代入速率方程得到：\n$$\n\\frac{dH}{dt} = k_f (C_t - H(t)) - k_r H(t)\n$$\n展开并合并含$H(t)$的项，我们得到：\n$$\n\\frac{dH}{dt} = k_f C_t - (k_f + k_r) H(t)\n$$\n这是一个一阶线性非齐次常微分方程。我们可以将其重排为标准形式 $\\frac{dy}{dt} + P(t)y = Q(t)$：\n$$\n\\frac{dH}{dt} + (k_f + k_r)H = k_f C_t\n$$\n该方程可以使用积分因子 $I(t) = e^{\\int (k_f + k_r) dt} = e^{(k_f + k_r)t}$ 来求解。将ODE乘以$I(t)$得到：\n$$\ne^{(k_f + k_r)t} \\frac{dH}{dt} + (k_f + k_r)e^{(k_f + k_r)t} H = k_f C_t e^{(k_f + k_r)t}\n$$\n左边是乘积$H(t)e^{(k_f + k_r)t}$的导数：\n$$\n\\frac{d}{dt} \\left( H(t) e^{(k_f + k_r)t} \\right) = k_f C_t e^{(k_f + k_r)t}\n$$\n对两边关于时间$t$积分：\n$$\nH(t) e^{(k_f + k_r)t} = \\int k_f C_t e^{(k_f + k_r)t} dt = \\frac{k_f C_t}{k_f + k_r} e^{(k_f + k_r)t} + A\n$$\n其中$A$是积分常数。通过除以$e^{(k_f + k_r)t}$来解出$H(t)$：\n$$\nH(t) = \\frac{k_f C_t}{k_f + k_r} + A e^{-(k_f + k_r)t}\n$$\n积分常数$A$由初始条件$H(0) = H_0$确定：\n$$\nH_0 = \\frac{k_f C_t}{k_f + k_r} + A e^0 \\implies A = H_0 - \\frac{k_f C_t}{k_f + k_r}\n$$\n将$A$代回通解，得到动力学模型的特解，我们将其记为$H_{\\mathrm{kin}}(t)$：\n$$\nH_{\\mathrm{kin}}(t) = \\frac{k_f C_t}{k_f + k_r} + \\left(H_0 - \\frac{k_f C_t}{k_f + k_r}\\right)e^{-(k_f + k_r)t}\n$$\n接下来，我们确定平衡浓度$H_{\\mathrm{eq}}$。在平衡状态下，净反应速率为零，即$\\frac{dH}{dt} = 0$。由ODE可得：\n$$\n0 = k_f C_t - (k_f + k_r) H_{\\mathrm{eq}}\n$$\n解出$H_{\\mathrm{eq}}$：\n$$\nH_{\\mathrm{eq}} = \\frac{k_f C_t}{k_f + k_r}\n$$\n这个平衡值是$H(t)$在$t \\to \\infty$时趋近的浓度。通过在我们对$H_{\\mathrm{kin}}(t)$的解中识别出这一项，我们可以更紧凑地重写弛豫表达式：\n$$\nH_{\\mathrm{kin}}(t) = H_{\\mathrm{eq}} + (H_0 - H_{\\mathrm{eq}})e^{-(k_f + k_r)t}\n$$\n该表达式清楚地表明，浓度以特征弛豫时间$\\tau = 1/(k_f + k_r)$从其初始值$H_0$弛豫到其最终平衡值$H_{\\mathrm{eq}}$。\n\n最后，我们推导无量纲相对偏差$\\varepsilon(t)$的表达式：\n$$\n\\varepsilon(t) = \\frac{H_{\\mathrm{kin}}(t) - H_{\\mathrm{eq}}}{H_{\\mathrm{eq}}}\n$$\n代入推导出的$H_{\\mathrm{kin}}(t)$的弛豫表达式：\n$$\n\\varepsilon(t) = \\frac{\\left(H_{\\mathrm{eq}} + (H_0 - H_{\\mathrm{eq}})e^{-(k_f + k_r)t}\\right) - H_{\\mathrm{eq}}}{H_{\\mathrm{eq}}}\n$$\n$$\n\\varepsilon(t) = \\frac{(H_0 - H_{\\mathrm{eq}})e^{-(k_f + k_r)t}}{H_{\\mathrm{eq}}} = \\left(\\frac{H_0}{H_{\\mathrm{eq}}} - 1\\right)e^{-(k_f + k_r)t}\n$$\n将$H_{\\mathrm{eq}}$的公式代入前置因子，可以得到一个在实现时可能很有用的等价形式：\n$$\n\\frac{H_0}{H_{\\mathrm{eq}}} - 1 = \\frac{H_0}{\\frac{k_f C_t}{k_f + k_r}} - 1 = \\frac{H_0(k_f+k_r)}{k_f C_t} - 1\n$$\n因此，要实现的最终解析表达式是：\n$$\n\\varepsilon(t) = \\left(\\frac{H_0(k_f+k_r)}{k_f C_t} - 1\\right)e^{-(k_f + k_r)t}\n$$\n此表达式将用于计算每个测试用例所需的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the relative deviation epsilon(T) for a set of test cases\n    modeling CO2 hydration kinetics.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (kf, kr, Ct, H0, T)\n    # kf: forward rate constant (s^-1)\n    # kr: reverse rate constant (s^-1)\n    # Ct: total hydrated carbon concentration (mol kg^-1)\n    # H0: initial carbonic acid concentration (mol kg^-1)\n    # T: evaluation time (s)\n    test_cases = [\n        # Case 1: T is the relaxation timescale\n        (0.03, 23.0, 1.0e-4, 0.0, 0.043478),\n        # Case 2: Long-time limit\n        (0.03, 23.0, 1.0e-4, 0.0, 60.0),\n        # Case 3: Initially supersaturated H2CO3\n        (0.03, 23.0, 1.0e-4, 3.0e-7, 0.01),\n        # Case 4: Initial time boundary condition\n        (0.03, 23.0, 1.0e-4, 0.0, 0.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        kf, kr, Ct, H0, T = case\n\n        # The derived analytical expression for the relative deviation epsilon(t) is:\n        # epsilon(t) = (H_kin(t) - H_eq) / H_eq\n        # where H_kin(t) = H_eq + (H0 - H_eq) * exp(-(kf + kr) * t)\n        # This simplifies to:\n        # epsilon(t) = ((H0 / H_eq) - 1) * exp(-(kf + kr) * t)\n\n        # 1. Calculate the sum of rate constants, which is the relaxation rate.\n        k_sum = kf + kr\n\n        # 2. Calculate the equilibrium concentration of carbonic acid, H_eq.\n        # H_eq = (kf * Ct) / (kf + kr).\n        # Based on the problem constraints, kf  0 and Ct  0, so H_eq  0.\n        # No division-by-zero risk for H_eq in the formula for epsilon.\n        H_eq = (kf * Ct) / k_sum\n\n        # 3. Calculate the kinetic concentration of carbonic acid at time T.\n        H_kin_T = H_eq + (H0 - H_eq) * np.exp(-k_sum * T)\n        \n        # 4. Calculate the relative deviation epsilon(T).\n        # It is numerically stable to use the simplified form to avoid two subtractions.\n        # epsilon_T = ((H0/H_eq) - 1.0) * np.exp(-1.0 * k_sum * T)\n        if H_eq == 0:\n            # This case should not happen with the given test data, but it's good practice.\n            # If H_eq is zero, and H_kin is also zero, the deviation is 0.\n            # If H_kin is not zero, the relative deviation is infinite.\n            epsilon_T = 0.0 if H_kin_T == 0 else float('inf')\n        else:\n            epsilon_T = (H_kin_T - H_eq) / H_eq\n        \n        results.append(epsilon_T)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}