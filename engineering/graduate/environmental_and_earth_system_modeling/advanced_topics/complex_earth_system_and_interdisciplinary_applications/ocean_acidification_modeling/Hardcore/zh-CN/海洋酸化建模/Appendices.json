{
    "hands_on_practices": [
        {
            "introduction": "在海洋酸化研究中，一项核心技能是根据少数几个可测量的“主变量”来确定海水碳酸盐系统的完整状态。本练习将指导您完成这一基本计算，即利用总碱度（$TA$）和溶解无机碳（$DIC$）这两个关键参数，通过求解一个非线性方程组来精确计算海水的 $pH$ 值和二氧化碳分压（$p\\mathrm{CO_2}$）。通过这项实践 ，您将掌握在海洋化学模型中实施和应用复杂经验公式的计算方法。",
            "id": "3900680",
            "problem": "海水中的碳酸盐水化学可以通过质量守恒、电中性（电荷平衡）和化学平衡的基本定律进行建模。你的任务是，在给定的温度、盐度和压力下，利用广泛接受的海水平衡常数，根据总碱度（TA）和溶解无机碳（DIC）计算海水的酸度（以氢离子浓度的负常用对数 $pH = -\\log_{10}([H^+])$ 量化）和二氧化碳分压 $p\\mathrm{CO_2}$。\n\n基本关系如下。溶解无机碳（DIC）分配在水合二氧化碳（$[\\mathrm{CO_2}]$，其中包括 $[\\mathrm{H_2CO_3}]$）、碳酸氢根（$[\\mathrm{HCO_3^-}]$）和碳酸根（$[\\mathrm{CO_3^{2-}}]$）之间，因此质量守恒给出\n$$\n\\mathrm{DIC} = [\\mathrm{CO_2}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}].\n$$\n海水中碳酸系统的化学平衡由两个解离步骤控制，其平衡常数分别为 $K_1$ 和 $K_2$：\n$$\nK_1 = \\frac{[H^+][\\mathrm{HCO_3^-}]}{[\\mathrm{CO_2}]}, \\qquad K_2 = \\frac{[H^+][\\mathrm{CO_3^{2-}}]}{[\\mathrm{HCO_3^-}]}.\n$$\n由此，对于给定的氢离子浓度 $[H^+]$，各种物质的分布可以用 $\\mathrm{DIC}$ 表示为\n$$\n\\alpha_0 = 1,\\quad \\alpha_1 = \\frac{K_1}{[H^+]},\\quad \\alpha_2 = \\frac{K_1 K_2}{[H^+]^2},\\quad\n[\\mathrm{CO_2}] = \\frac{\\mathrm{DIC}}{\\alpha_0 + \\alpha_1 + \\alpha_2},\\quad\n[\\mathrm{HCO_3^-}] = \\frac{\\mathrm{DIC}\\,\\alpha_1}{\\alpha_0 + \\alpha_1 + \\alpha_2},\\quad\n[\\mathrm{CO_3^{2-}}] = \\frac{\\mathrm{DIC}\\,\\alpha_2}{\\alpha_0 + \\alpha_1 + \\alpha_2}.\n$$\n总碱度（TA）由电中性条件定义，对于本问题，必须包括来自碳酸盐系统、硼酸盐、水的自电离以及自由质子的主要贡献，表示为\n$$\n\\mathrm{TA} = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{B(OH)_4^-}] + [\\mathrm{OH^-}] - [H^+],\n$$\n其中硼酸盐碱度 $[\\mathrm{B(OH)_4^-}]$ 由硼酸解离常数 $K_B$ 和总硼浓度 $B_T$ 通过以下公式得出\n$$\n[\\mathrm{B(OH)_4^-}] = B_T \\frac{K_B}{K_B + [H^+]},\n$$\n水的自电离给出\n$$\n[\\mathrm{OH^-}] = \\frac{K_W}{[H^+]}.\n$$\n亨利定律通过溶解度常数 $K_0$ 将水溶液中的二氧化碳与其分压联系起来：\n$$\np\\mathrm{CO_2} = \\frac{[\\mathrm{CO_2}]}{K_0}.\n$$\n常数 $K_1$、$K_2$、$K_B$、$K_W$ 和 $K_0$ 取决于温度和盐度。请使用以下经过充分检验的公式，其中温度 $T$ 的单位为开尔文，盐度 $S$ 的单位为实用盐度（无量纲），并通过使用这些在表层压力下的 $K$ 值来处理压力依赖性。在总pH标度下，碳酸平衡的 $pK$ 值由 Lueker 等人对 Mehrbach 的数据进行重新拟合后给出：\n$$\npK_1 = \\frac{3633.86}{T} - 61.2172 + 9.6777\\ln T - 0.011555\\,S + 0.0001152\\,S^2,\n$$\n$$\npK_2 = \\frac{471.78}{T} + 25.9290 - 3.16967\\ln T - 0.01781\\,S + 0.0001122\\,S^2,\n$$\n其中 $K_1 = 10^{-pK_1}$，$K_2 = 10^{-pK_2}$。在总pH标度下，硼酸常数 $K_B$ (Dickson) 为\n$$\n\\ln K_B = \\frac{-8966.90 - 2890.53\\sqrt{S} - 77.942\\,S + 1.728\\,S^{3/2} - 0.0996\\,S^2}{T}\n+ 148.0248 + 137.1942\\sqrt{S} + 1.62142\\,S\n- \\left(24.4344 + 25.085\\sqrt{S} + 0.2474\\,S\\right)\\ln T + 0.053105\\sqrt{S}\\,T,\n$$\n水的离子积 $K_W$ (Millero) 为\n$$\n\\ln K_W = \\frac{-13847.26}{T} + 148.9652 - 23.6521\\ln T + \\sqrt{S}\\left(\\frac{118.67}{T} - 5.977 + 1.0495\\ln T\\right) - 0.01615\\,S.\n$$\n使用 $K_B = \\exp(\\ln K_B)$ 和 $K_W = \\exp(\\ln K_W)$ 将对数转换为线性常数。二氧化碳的溶解度 $K_0$ (Weiss) 为\n$$\n\\ln K_0 = A_1 + A_2\\left(\\frac{100}{T}\\right) + A_3 \\ln\\left(\\frac{T}{100}\\right) + S\\left(B_1 + B_2 \\frac{T}{100} + B_3 \\left(\\frac{T}{100}\\right)^2\\right),\n$$\n其中 $A_1 = -58.0931$, $A_2 = 90.5069$, $A_3 = 22.2940$, $B_1 = 0.027766$, $B_2 = -0.025888$, $B_3 = 0.0050578$，且 $K_0 = \\exp(\\ln K_0)$。总硼浓度为 $B_T = 0.0004157\\,(S/35)$，单位为摩尔/千克海水。\n\n对于每个测试案例，你必须通过求解以下方程的唯一根来解出关于 $[H^+]$ 的非线性电荷平衡方程\n$$\nf([H^+]) \\equiv \\mathrm{TA} - \\left([\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{B(OH)_4^-}] + [\\mathrm{OH^-}] - [H^+]\\right) = 0,\n$$\n使用上述定义和给定的 $\\mathrm{DIC}$。然后计算 $pH$ 为 $-\\log_{10}([H^+])$，并根据亨利定律计算 $p\\mathrm{CO_2}$。在计算中，将 $\\mathrm{TA}$（单位：微当量/千克）和 $\\mathrm{DIC}$（单位：微摩尔/千克）处理；通过乘以 $10^{-6}$ 将两者都转换为摩尔/千克。温度以摄氏度给出，必须通过加上 $273.15$ 转换为开尔文。压力以分巴给出；对于本问题的测试套件，所有压力均为 $0$ 分巴，因此平衡常数在表层压力下进行评估。\n\n将 $pH$ 表示为无单位量，四舍五入到四位小数。将 $p\\mathrm{CO_2}$ 以微大气压表示，四舍五入到一位小数，使用 $1\\,\\mathrm{atm} = 10^6\\,\\mu\\mathrm{atm}$。每个测试案例的最终输出必须是一个包含两个浮点数的列表 $[pH, p\\mathrm{CO_2}]$。你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个测试案例对应一个双元素列表，并按下面给出的顺序排列。例如，输出格式必须类似于 $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$。\n\n测试套件（请精确使用这些参数集）：\n- 案例1（一般情况）：$T = 25$ 摄氏度, $S = 35$, 压力 $= 0$ 分巴, $\\mathrm{TA} = 2300$ 微当量/千克, $\\mathrm{DIC} = 2000$ 微摩尔/千克。\n- 案例2（寒冷的表层水）：$T = 2$ 摄氏度, $S = 35$, 压力 $= 0$ 分巴, $\\mathrm{TA} = 2300$ 微当量/千克, $\\mathrm{DIC} = 2000$ 微摩尔/千克。\n- 案例3（温暖、高盐度、$\\mathrm{DIC} \\approx \\mathrm{TA}$）：$T = 30$ 摄氏度, $S = 38$, 压力 $= 0$ 分巴, $\\mathrm{TA} = 2300$ 微当量/千克, $\\mathrm{DIC} = 2300$ 微摩尔/千克。\n- 案例4（较低盐度、较高$\\mathrm{DIC}$）：$T = 15$ 摄氏度, $S = 30$, 压力 $= 0$ 分巴, $\\mathrm{TA} = 2000$ 微当量/千克, $\\mathrm{DIC} = 2200$ 微摩尔/千克。\n- 案例5（较高碱度和较低$\\mathrm{DIC}$的边界情况）：$T = 25$ 摄氏度, $S = 35$, 压力 $= 0$ 分巴, $\\mathrm{TA} = 2400$ 微当量/千克, $\\mathrm{DIC} = 1800$ 微摩尔/千克。\n\n你的程序必须计算上述五个案例的结果，并以如下确切格式打印单行输出\n$$\n[[pH_1,p\\mathrm{CO_2}_1],[pH_2,p\\mathrm{CO_2}_2],[pH_3,p\\mathrm{CO_2}_3],[pH_4,p\\mathrm{CO_2}_4],[pH_5,p\\mathrm{CO_2}_5]].\n$$",
            "solution": "该问题要求从四个关键输入参数计算海水酸度（$pH$）和二氧化碳分压（$p\\mathrm{CO_2}$）：总碱度（$\\mathrm{TA}$）、溶解无机碳（$\\mathrm{DIC}$）、温度（$T$）和盐度（$S$）。压力给定为零分巴，对应于表层条件。这是化学海洋学中的一个经典问题，其解决方案依赖于求解控制海洋碳酸盐系统的方程组。\n\n分析过程被构建为一个数值求根问题。问题的核心是电荷平衡方程，由总碱度的公式表示。我们的目标是找到满足给定 $\\mathrm{TA}$ 和 $\\mathrm{DIC}$ 条件下该方程的氢离子浓度 $[H^+]$。一旦确定了 $[H^+]$，所有其他量，包括 $pH$ 和 $p\\mathrm{CO_2}$，都可以直接计算出来。\n\n对于每个测试案例，通过以下步骤序列实现解决方案：\n\n1.  **初始化与单位转换**：处理输入参数。将以摄氏度为单位的温度转换为开尔文绝对温标（$T_K = T_C + 273.15$）。将以微单位（分别为 $\\mu\\mathrm{eq/kg}$ 和 $\\mu\\mathrm{mol/kg}$）给出的总碱度和溶解无机碳，通过乘以 $10^{-6}$ 转换为其基本单位摩尔/千克海水（$\\mathrm{mol/kg}$）。\n\n2.  **平衡常数和溶解度常数的计算**：碳酸盐系统、硼酸盐系统和水的自电离的化学平衡高度依赖于温度和盐度。对于每组 ($T, S$)，使用指定的经验公式计算以下常数：\n    -   碳酸的第一和第二解离常数 $K_1$ 和 $K_2$，根据 $pK_1$ 和 $pK_2$ 的关系式（Lueker 等人重新拟合）。注意 $K = 10^{-pK}$。\n    -   硼酸的解离常数 $K_B$，根据其 $\\ln K_B$ 公式（Dickson）。\n    -   水的离子积 $K_W$，根据其 $\\ln K_W$ 公式（Millero）。\n    -   $\\mathrm{CO_2}$ 的溶解度 $K_0$，根据其 $\\ln K_0$ 公式（Weiss）。\n    -   对于以自然对数（$\\ln K$）给出的常数，通过 $K = \\exp(\\ln K)$ 求得其线性值。\n    -   总硼浓度 $B_T$ 随盐度线性变化，也计算为 $B_T = 0.0004157 \\cdot (S/35)$。\n\n3.  **定义求根函数**：中心任务是求解 $[H^+]$。这通过找到残差函数 $f([H^+])$ 的根来实现，该函数表示给定的 $\\mathrm{TA}$ 与根据化学物质浓度计算出的 TA 之间的差值：\n    $$\n    f([H^+]) = \\mathrm{TA}_{\\text{given}} - \\mathrm{TA}_{\\text{calculated}}([H^+]) = 0\n    $$\n    计算出的碱度 $\\mathrm{TA}_{\\text{calculated}}$ 定义为：\n    $$\n    \\mathrm{TA}_{\\text{calculated}} = [\\mathrm{HCO_3^-}] + 2[\\mathrm{CO_3^{2-}}] + [\\mathrm{B(OH)_4^-}] + [\\mathrm{OH^-}] - [H^+]\n    $$\n    此表达式中的每个浓度项都是 $[H^+]$ 和先前计算出的常数的函数：\n    -   碳酸盐物质（$[\\mathrm{HCO_3^-}]$、$[\\mathrm{CO_3^{2-}}]$）用 $\\mathrm{DIC}$、$[H^+]$、$K_1$ 和 $K_2$ 表示。为提高数值稳定性，表达式重新整理为：\n        $$[\\mathrm{HCO_3^-}] = \\mathrm{DIC} \\frac{K_1 [H^+]}{[H^+]^2 + K_1 [H^+] + K_1 K_2}$$\n        $$[\\mathrm{CO_3^{2-}}] = \\mathrm{DIC} \\frac{K_1 K_2}{[H^+]^2 + K_1 [H^+] + K_1 K_2}$$\n    -   硼酸盐物质由以下公式给出：$[\\mathrm{B(OH)_4^-}] = B_T \\frac{K_B}{K_B + [H^+]}$\n    -   氢氧根浓度为：$[\\mathrm{OH^-}] = K_W / [H^+]$\n\n4.  **$[H^+]$ 的数值解**：非线性方程 $f([H^+]) = 0$ 使用数值求根算法求解。Brent 方法（`scipy.optimize.brentq`）是一个极好的选择，因为它既稳健又高效，只要提供一个函数变号的区间。对于海洋碳酸盐系统，函数 $f([H^+])$ 是单调的。一个合适的 $[H^+]$ 搜索区间是 $10^{-9}$ 到 $10^{-6}$ $\\mathrm{mol/kg}$，这对应于 $9$ 到 $6$ 的 $pH$ 范围，可以安全地涵盖所有可能的海洋条件。\n\n5.  **最终量的计算**：在找到氢离子浓度的唯一解 $[H^+]_{sol}$ 后：\n    -   使用其定义计算 $pH$：$pH = -\\log_{10}([H^+]_{sol})$。\n    -   使用已确定的 $[H^+]_{sol}$ 计算水合二氧化碳的浓度 $[\\mathrm{CO_2}]$：\n        $$[\\mathrm{CO_2}] = \\mathrm{DIC} \\frac{[H^+]_{sol}^2}{[H^+]_{sol}^2 + K_1 [H^+]_{sol} + K_1 K_2}$$\n    -   然后根据亨利定律求得 $\\mathrm{CO_2}$ 的分压：$p\\mathrm{CO_2} = [\\mathrm{CO_2}] / K_0$。结果最初以大气压为单位，通过乘以 $10^6$ 转换为微大气压。\n\n6.  **输出格式化**：每个测试案例最终计算出的 $pH$ 和 $p\\mathrm{CO_2}$ 值分别四舍五入到四位和一位小数，并格式化为指定的列表结构。对所有提供的测试案例重复此过程，以生成完整的最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes pH and pCO2 for seawater from Total Alkalinity, Dissolved Inorganic Carbon,\n    temperature, and salinity, based on standard oceanographic chemical models.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (general case)\n        (25, 35, 2300, 2000),\n        # Case 2 (cold surface water)\n        (2, 35, 2300, 2000),\n        # Case 3 (warm, high salinity, DIC ≈ TA)\n        (30, 38, 2300, 2300),\n        # Case 4 (lower salinity, higher DIC)\n        (15, 30, 2000, 2200),\n        # Case 5 (boundary with higher alkalinity and lower DIC)\n        (25, 35, 2400, 1800),\n    ]\n\n    def calculate_parameters(T_C, S):\n        \"\"\"\n        Calculates all temperature- and salinity-dependent equilibrium constants.\n        T_C: Temperature in degrees Celsius\n        S: Salinity in Practical Salinity Scale (dimensionless)\n        \"\"\"\n        T = T_C + 273.15  # Temperature in Kelvin\n        sqrt_S = np.sqrt(S)\n        ln_T = np.log(T)\n\n        # K1, K2 from Lueker et al. (2000)\n        pK1 = 3633.86/T - 61.2172 + 9.67770 * ln_T - 0.011555 * S + 0.0001152 * S**2\n        K1 = 10**(-pK1)\n\n        pK2 = 471.78/T + 25.9290 - 3.16967 * ln_T - 0.01781 * S + 0.0001122 * S**2\n        K2 = 10**(-pK2)\n\n        # KB from Dickson (1990)\n        ln_KB_num = (\n            -8966.90 - 2890.53 * sqrt_S - 77.942 * S + 1.728 * S**1.5 - 0.0996 * S**2\n        )\n        ln_KB = (\n            ln_KB_num / T\n            + 148.0248 + 137.1942 * sqrt_S + 1.62142 * S\n            - (24.4344 + 25.085 * sqrt_S + 0.2474 * S) * ln_T\n            + 0.053105 * sqrt_S * T\n        )\n        KB = np.exp(ln_KB)\n\n        # KW from Millero (1995)\n        ln_KW = (\n            148.9652 - 13847.26/T - 23.6521 * ln_T\n            + sqrt_S * (118.67/T - 5.977 + 1.0495 * ln_T)\n            - 0.01615 * S\n        )\n        KW = np.exp(ln_KW)\n\n        # K0 from Weiss (1974)\n        A1, A2, A3 = -58.0931, 90.5069, 22.2940\n        B1, B2, B3 = 0.027766, -0.025888, 0.0050578\n        T100 = T / 100.0\n        ln_K0 = (\n            A1 + A2 * (100.0/T) + A3 * np.log(T100)\n            + S * (B1 + B2 * T100 + B3 * T100**2)\n        )\n        K0 = np.exp(ln_K0)\n\n        # Total Boron (Uppstrom, 1974)\n        BT = 0.0004157 * (S / 35.0)\n\n        return {'K1': K1, 'K2': K2, 'KB': KB, 'KW': KW, 'K0': K0, 'BT': BT}\n\n    def alkalinity_residual(H, TA, DIC, params):\n        \"\"\"\n        Calculates the residual of the total alkalinity equation.\n        f(H) = TA_given - TA_calculated(H)\n        H: Hydrogen ion concentration [mol/kg]\n        TA: Total Alkalinity [mol/kg]\n        DIC: Dissolved Inorganic Carbon [mol/kg]\n        params: Dictionary of equilibrium constants and BT\n        \"\"\"\n        K1, K2, KB, KW, BT = params['K1'], params['K2'], params['KB'], params['KW'], params['BT']\n\n        # Numerically stable denominator for carbonate species\n        carb_denom = H**2 + K1 * H + K1 * K2\n\n        HCO3 = DIC * (K1 * H / carb_denom)\n        CO3 = DIC * (K1 * K2 / carb_denom)\n        BOH4 = BT * KB / (KB + H)\n        OH = KW / H\n        \n        # Note: the H term is subtracted as per the TA definition\n        TA_calc = HCO3 + 2 * CO3 + BOH4 + OH - H\n        \n        return TA - TA_calc\n\n    results = []\n    for case in test_cases:\n        T_C, S, TA_micro, DIC_micro = case\n        \n        # Convert units from micro- to base units\n        TA = TA_micro * 1e-6\n        DIC = DIC_micro * 1e-6\n\n        # Step 1: Calculate all T/S-dependent parameters\n        params = calculate_parameters(T_C, S)\n\n        # Step 2: Solve for H+ concentration using a root-finder\n        # The bracketing interval [1e-9, 1e-6] corresponds to a pH of [9, 6]\n        H_sol = brentq(alkalinity_residual, 1e-9, 1e-6, args=(TA, DIC, params))\n\n        # Step 3: Calculate final quantities\n        pH = -np.log10(H_sol)\n\n        # Calculate [CO2]\n        carb_denom = H_sol**2 + params['K1'] * H_sol + params['K1'] * params['K2']\n        CO2_aq = DIC * (H_sol**2 / carb_denom)\n\n        # Calculate pCO2\n        pCO2_atm = CO2_aq / params['K0']\n        pCO2_muatm = pCO2_atm * 1e6\n        \n        # Step 4: Round and store results\n        results.append([round(pH, 4), round(pCO2_muatm, 1)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "总碱度（$TA$）是海洋缓冲酸化能力的关键指标，但它的来源是什么？这项实践将我们的视角从海洋内部扩展到陆海相互作用的宏观尺度。我们将从化学计量学的基本原理出发，推导陆地上的碳酸盐和硅酸盐风化过程如何产生碱度，并分析强酸如何消耗碱度 。通过结合真实的河流化学数据和流量，您将学会量化河流向沿海海洋输送的碱度通量，这对于理解和模拟全球碳循环至关重要。",
            "id": "3900641",
            "problem": "一条大型温带河流流经一个混合的碳酸盐-硅酸盐流域，并将溶解的离子输送到近岸海洋，从而通过改变总碱度（TA）来调节海水的缓冲能力。从质量和电荷守恒出发，并仅使用化学计量风化反应，推导在碳酸驱动的反应下，碳酸盐风化和硅酸盐风化对河流TA的贡献表达式，并说明强酸阴离子如何减少输出到海洋的净TA。然后，使用此推导和以下流量加权平均数据，估算该流域尺度的年TA通量。\n\n假设和基本原理：\n- 总碱度（TA）定义为水中质子受体超过质子给体的量，在近中性pH下，其主要贡献者是风化作用产生的碳酸盐体系碱。\n- 必须保持电中性，并且化学计量系数在风化反应中平衡质量和电荷。\n- 碳酸对碳酸盐的风化产生二价阳离子和碳酸氢根；碳酸对硅酸盐的风化产生单价或二价阳离子、碳酸氢根和溶解硅；强酸（如硫酸）的风化产生不产生TA的强酸阴离子。\n- 在这些离子强度下，活度系数近似为1；在所述pH下，硼酸盐、磷酸盐和有机酸对TA的贡献可以忽略不计。\n\n以经典的碳酸风化反应为起点，确定对于碳酸盐和硅酸盐来源，每释放一摩尔阳离子会产生多少当量的TA，并利用电中性原理将净TA与溶解离子的电荷联系起来。然后，利用阳离子来源的混合信息，将总TA生成量分配给碳酸盐风化和硅酸盐风化，并减去强酸阴离子的电荷，以获得输送到海洋的净TA。\n\n给定数据（流量加权平均值）：\n- 二价阳离子：$[\\mathrm{Ca}^{2+}] = 0.90\\ \\mathrm{mmol}\\ \\mathrm{L}^{-1}$，$[\\mathrm{Mg}^{2+}] = 0.45\\ \\mathrm{mmol}\\ \\mathrm{L}^{-1}$。\n- 单价阳离子：$[\\mathrm{Na}^{+}] = 0.70\\ \\mathrm{mmol}\\ \\mathrm{L}^{-1}$，$[\\mathrm{K}^{+}] = 0.12\\ \\mathrm{mmol}\\ \\mathrm{L}^{-1}$。\n- 强酸阴离子：$[\\mathrm{Cl}^{-}] = 0.65\\ \\mathrm{mmol}\\ \\mathrm{L}^{-1}$，$[\\mathrm{SO}_{4}^{2-}] = 0.35\\ \\mathrm{mmol}\\ \\mathrm{L}^{-1}$，$[\\mathrm{NO}_{3}^{-}] = 0.04\\ \\mathrm{mmol}\\ \\mathrm{L}^{-1}$。\n- 锶同位素混合表明，溶解的二价阳离子 $([\\mathrm{Ca}^{2+}] + [\\mathrm{Mg}^{2+}])$ 中有 $f_{\\mathrm{carb}} = 0.60$ 的部分来源于碳酸盐风化，其余部分来源于硅酸盐风化。\n- 平均流量为 $Q = 3000\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-1}$，在平均周期内假定为稳定值。\n- 采用 $1\\ \\mathrm{year} = 3.1536 \\times 10^{7}\\ \\mathrm{s}$ 和 $1\\ \\mathrm{Tmol} = 10^{12}\\ \\mathrm{mol}$。\n\n任务：\n1. 仅使用平衡的风化反应和电中性原理，推导在碳酸作用下，碳酸盐风化与硅酸盐风化每摩尔阳离子产生的总碱度当量数，并证明由碳酸驱动的总碱度生成量可以表示为阳离子电荷的正贡献项，而强酸阴离子对净TA贡献一个负项。\n2. 使用给定的 $f_{\\mathrm{carb}}$，将以 $\\mathrm{meq}\\ \\mathrm{L}^{-1}$ 为单位表示的总碱度生成量在碳酸盐风化和硅酸盐风化之间进行分配，然后减去强酸阴离子的电荷，以获得输送到海洋的净TA浓度。\n3. 通过将净TA浓度与流量相结合，计算河流输出的年TA通量，以太摩尔/年（teramoles per year）为单位表示。\n\n将最终的年总碱度通量以 $\\mathrm{Tmol}\\ \\mathrm{yr}^{-1}$ 为单位表示。将您的答案四舍五入到三位有效数字。",
            "solution": "该问题被评估为有效，因为它科学地基于地球化学的既定原则，问题提出得当，数据充分且一致，陈述客观。任务要求从基本原则进行逻辑推导，然后进行定量应用，这是环境科学中一个标准且不简单的练习。\n\n### 第1部分：总碱度（TA）生成的推导\n\n在近中性pH的天然水体中，总碱度（TA）可近似为碳酸氢根的浓度，因为根据问题陈述的假设，其他贡献者可以忽略不计：$TA \\approx [\\mathrm{HCO}_3^{-}]$。TA的单位通常是当量/升，因此我们考虑电荷贡献。\n\n**碳酸对碳酸盐的风化：**\n一种通用碳酸盐矿物（如方解石 $\\mathrm{CaCO}_3$）被碳酸（$\\mathrm{H}_2\\mathrm{CO}_3$）风化的反应是：\n$$ \\mathrm{CaCO}_3(s) + \\mathrm{H}_2\\mathrm{CO}_3(aq) \\rightarrow \\mathrm{Ca}^{2+}(aq) + 2\\mathrm{HCO}_3^{-}(aq) $$\n根据这个化学计量关系，$1$ 摩尔 $\\mathrm{CaCO}_3$ 的溶解产生 $1$ 摩尔 $\\mathrm{Ca}^{2+}$ 和 $2$ 摩尔 $\\mathrm{HCO}_3^{-}$。总碱度的增加量为 $\\Delta TA = 2 \\Delta[\\mathrm{Ca}^{2+}]$。由于阳离子的电荷为 $z=+2$，这个反应每释放 $2$ 当量的阳离子电荷，就会产生 $2$ 当量的碱度。因此，对于碳酸盐风化，释放 $1$ 当量的阳离子电荷对应于生成 $1$ 当量的TA。\n\n**碳酸对硅酸盐的风化：**\n硅酸盐矿物的风化也消耗碳酸并产生阳离子和碳酸氢根。\n对于含单价阳离子的硅酸盐，如钠长石（$\\mathrm{NaAlSi}_3\\mathrm{O}_8$）：\n$$ 2\\mathrm{NaAlSi}_3\\mathrm{O}_8(s) + 2\\mathrm{H}_2\\mathrm{CO}_3(aq) + 9\\mathrm{H}_2\\mathrm{O}(l) \\rightarrow 2\\mathrm{Na}^{+}(aq) + 2\\mathrm{HCO}_3^{-}(aq) + \\mathrm{Al}_2\\mathrm{Si}_2\\mathrm{O}_5(\\mathrm{OH})_4(s) + 4\\mathrm{H}_4\\mathrm{SiO}_4(aq) $$\n在这里，每产生 $2$ 摩尔 $\\mathrm{HCO}_3^{-}$ 就会释放 $2$ 摩尔 $\\mathrm{Na}^{+}$。TA的生成量为 $\\Delta TA = \\Delta[\\mathrm{Na}^{+}]$。由于电荷为 $z=+1$，释放 $1$ 当量的阳离子电荷对应于 $1$ 当量的TA。\n\n对于含二价阳离子的硅酸盐，如钙长石（$\\mathrm{CaAl}_2\\mathrm{Si}_2\\mathrm{O}_8$）：\n$$ \\mathrm{CaAl}_2\\mathrm{Si}_2\\mathrm{O}_8(s) + 2\\mathrm{H}_2\\mathrm{CO}_3(aq) + \\mathrm{H}_2\\mathrm{O}(l) \\rightarrow \\mathrm{Ca}^{2+}(aq) + 2\\mathrm{HCO}_3^{-}(aq) + \\mathrm{Al}_2\\mathrm{Si}_2\\mathrm{O}_5(\\mathrm{OH})_4(s) $$\n在这里，每产生 $2$ 摩尔 $\\mathrm{HCO}_3^{-}$ 就会释放 $1$ 摩尔 $\\mathrm{Ca}^{2+}$。TA的生成量为 $\\Delta TA = 2 \\Delta[\\mathrm{Ca}^{2+}]$。与碳酸盐风化一样，$2$ 当量的阳离子电荷对应于 $2$ 当量的TA。\n\n在所有碳酸驱动的风化案例中，产生的总碱度（$TA_{gross}$），以电荷当量计，等于从矿物中释放的碱性阳离子电荷的总和。\n$$ TA_{gross} = \\sum z_i [C_i] = 2[\\mathrm{Ca}^{2+}] + 2[\\mathrm{Mg}^{2+}] + [\\mathrm{Na}^{+}] + [\\mathrm{K}^{+}] $$\n\n**强酸风化：**\n当强酸（如硫酸 $\\mathrm{H}_2\\mathrm{SO}_4$）风化矿物时，不产生净碱度。例如，对于方解石：\n$$ \\mathrm{CaCO}_3(s) + \\mathrm{H}_2\\mathrm{SO}_4(aq) \\rightarrow \\mathrm{Ca}^{2+}(aq) + \\mathrm{SO}_4^{2-}(aq) + \\mathrm{H}_2\\mathrm{CO}_3(aq) $$\n阳离子 $\\mathrm{Ca}^{2+}$ 被释放，但伴随它的是强酸阴离子（$\\mathrm{SO}_4^{2-}$）而不是碳酸氢根。强酸阴离子对碱度没有贡献。因此，由强酸风化释放的阳离子对净TA通量没有贡献。\n\n**净TA的电中性推导：**\n电中性原理要求溶液中正电荷的总和等于负电荷的总和。对于河流中的主要离子：\n$$ (2[\\mathrm{Ca}^{2+}] + 2[\\mathrm{Mg}^{2+}] + [\\mathrm{Na}^{+}] + [\\mathrm{K}^{+}]) + [\\mathrm{H}^{+}] = ([\\mathrm{HCO}_3^{-}] + 2[\\mathrm{CO}_3^{2-}]) + ([\\mathrm{Cl}^{-}] + 2[\\mathrm{SO}_4^{2-}] + [\\mathrm{NO}_3^{-}]) + [\\mathrm{OH}^{-}] $$\n将总碱度定义为 $TA = [\\mathrm{HCO}_3^{-}] + 2[\\mathrm{CO}_3^{2-}] + [\\mathrm{OH}^{-}] - [\\mathrm{H}^{+}]$，我们可以重新排列电荷平衡方程来求解 $TA$：\n$$ TA = (2[\\mathrm{Ca}^{2+}] + 2[\\mathrm{Mg}^{2+}] + [\\mathrm{Na}^{+}] + [\\mathrm{K}^{+}]) - ([\\mathrm{Cl}^{-}] + 2[\\mathrm{SO}_4^{2-}] + [\\mathrm{NO}_3^{-}]) $$\n这个方程表明，净总碱度（$TA_{net}$）是风化产生的总碱度（正的阳离子电荷项）减去强酸阴离子的电荷贡献（负项），这代表了被强酸“消耗”的碱度。\n\n### 第2部分：净TA浓度的计算\n\n首先，我们计算总碱度生成量 $TA_{gross}$，即碱性阳离子的总电荷。浓度以 $\\mathrm{mmol}\\ \\mathrm{L}^{-1}$ 给出，因此结果的单位将是毫当量/升（$\\mathrm{meq}\\ \\mathrm{L}^{-1}$）。\n$$ TA_{gross} = 2[\\mathrm{Ca}^{2+}] + 2[\\mathrm{Mg}^{2+}] + [\\mathrm{Na}^{+}] + [\\mathrm{K}^{+}] $$\n$$ TA_{gross} = 2(0.90) + 2(0.45) + (0.70) + (0.12) = 1.80 + 0.90 + 0.70 + 0.12 = 3.52\\ \\mathrm{meq}\\ \\mathrm{L}^{-1} $$\n现在，我们将这个总TA生成量在碳酸盐和硅酸盐来源之间进行分配。\n二价阳离子的总浓度为 $[\\mathrm{Ca}^{2+}] + [\\mathrm{Mg}^{2+}] = 0.90 + 0.45 = 1.35\\ \\mathrm{mmol}\\ \\mathrm{L}^{-1}$。\n它们的总电荷贡献为 $2 \\times 1.35 = 2.70\\ \\mathrm{meq}\\ \\mathrm{L}^{-1}$。\n来自碳酸盐风化的比例为 $f_{\\mathrm{carb}} = 0.60$。\n由碳酸盐风化生成的TA，$TA_{carb}$，是来自碳酸盐来源的二价阳离子部分的电荷：\n$$ TA_{carb} = f_{\\mathrm{carb}} \\times (2([\\mathrm{Ca}^{2+}] + [\\mathrm{Mg}^{2+}])) = 0.60 \\times 2.70\\ \\mathrm{meq}\\ \\mathrm{L}^{-1} = 1.62\\ \\mathrm{meq}\\ \\mathrm{L}^{-1} $$\n由硅酸盐风化生成的TA，$TA_{sil}$，是来自硅酸盐来源的二价阳离子和所有单价阳离子的TA之和：\n$$ TA_{sil} = (1 - f_{\\mathrm{carb}}) \\times (2([\\mathrm{Ca}^{2+}] + [\\mathrm{Mg}^{2+}])) + ([\\mathrm{Na}^{+}] + [\\mathrm{K}^{+}]) $$\n$$ TA_{sil} = (1 - 0.60) \\times 2.70\\ \\mathrm{meq}\\ \\mathrm{L}^{-1} + (0.70 + 0.12)\\ \\mathrm{meq}\\ \\mathrm{L}^{-1} $$\n$$ TA_{sil} = 0.40 \\times 2.70 + 0.82 = 1.08 + 0.82 = 1.90\\ \\mathrm{meq}\\ \\mathrm{L}^{-1} $$\n总和 $TA_{carb} + TA_{sil} = 1.62 + 1.90 = 3.52\\ \\mathrm{meq}\\ \\mathrm{L}^{-1}$，与 $TA_{gross}$ 相符。\n\n接下来，我们计算强酸阴离子的电荷，$[SAA]$：\n$$ [SAA] = [\\mathrm{Cl}^{-}] + 2[\\mathrm{SO}_{4}^{2-}] + [\\mathrm{NO}_{3}^{-}] $$\n$$ [SAA] = 0.65 + 2(0.35) + 0.04 = 0.65 + 0.70 + 0.04 = 1.39\\ \\mathrm{meq}\\ \\mathrm{L}^{-1} $$\n最后，我们计算输送到海洋的净TA浓度：\n$$ TA_{net} = TA_{gross} - [SAA] $$\n$$ TA_{net} = 3.52\\ \\mathrm{meq}\\ \\mathrm{L}^{-1} - 1.39\\ \\mathrm{meq}\\ \\mathrm{L}^{-1} = 2.13\\ \\mathrm{meq}\\ \\mathrm{L}^{-1} $$\n\n### 第3部分：年TA通量的计算\n\n年通量是净TA浓度与年水流量的乘积。我们必须确保单位一致。\n净TA浓度为 $TA_{net} = 2.13\\ \\mathrm{meq}\\ \\mathrm{L}^{-1}$。由于TA是以当量来衡量的，这相当于每升 $2.13$ 毫摩尔的电荷当量。我们可以将其写为 $2.13 \\times 10^{-3}\\ \\mathrm{mol}\\ \\mathrm{L}^{-1}$。\n我们将其转换为摩尔/立方米（$\\mathrm{mol}\\ \\mathrm{m}^{-3}$）：\n$$ TA_{net} = 2.13 \\times 10^{-3} \\frac{\\mathrm{mol}}{\\mathrm{L}} \\times \\frac{1000\\ \\mathrm{L}}{1\\ \\mathrm{m}^{3}} = 2.13\\ \\mathrm{mol}\\ \\mathrm{m}^{-3} $$\n平均流量为 $Q = 3000\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-1}$。\n以摩尔/秒为单位的瞬时通量为：\n$$ \\text{Flux}_{\\mathrm{s}} = TA_{net} \\times Q = 2.13\\ \\mathrm{mol}\\ \\mathrm{m}^{-3} \\times 3000\\ \\mathrm{m}^{3}\\ \\mathrm{s}^{-1} = 6390\\ \\mathrm{mol}\\ \\mathrm{s}^{-1} $$\n为了求得年通量，我们使用年秒转换因子：$1\\ \\mathrm{year} = 3.1536 \\times 10^{7}\\ \\mathrm{s}$。\n$$ \\text{Flux}_{\\mathrm{yr}} = 6390\\ \\frac{\\mathrm{mol}}{\\mathrm{s}} \\times 3.1536 \\times 10^{7}\\ \\frac{\\mathrm{s}}{\\mathrm{yr}} \\approx 2.0151 \\times 10^{11}\\ \\mathrm{mol}\\ \\mathrm{yr}^{-1} $$\n问题要求答案以太摩尔/年（$\\mathrm{Tmol}\\ \\mathrm{yr}^{-1}$）为单位，其中 $1\\ \\mathrm{Tmol} = 10^{12}\\ \\mathrm{mol}$。\n$$ \\text{Flux}_{\\mathrm{Tmol}} = \\frac{2.0151 \\times 10^{11}\\ \\mathrm{mol}\\ \\mathrm{yr}^{-1}}{10^{12}\\ \\mathrm{mol}\\ \\mathrm{Tmol}^{-1}} \\approx 0.20151\\ \\mathrm{Tmol}\\ \\mathrm{yr}^{-1} $$\n四舍五入到三位有效数字，年TA通量为 $0.202\\ \\mathrm{Tmol}\\ \\mathrm{yr}^{-1}$。",
            "answer": "$$\\boxed{0.202}$$"
        },
        {
            "introduction": "大多数碳酸盐系统模型都基于一个核心假设：化学反应瞬时达到平衡。然而，在动态变化的真实环境中，反应速率是否足够快？本练习将深入探讨这一基本假设，重点关注二氧化碳（$\\mathrm{CO_2}$）水合反应的动力学过程 。您将推导出一个描述系统如何从初始状态弛豫到平衡的数学模型，并计算其特征时间尺度，从而能够定量评估在何种条件下瞬时平衡假设是合理的，以及何时必须考虑反应动力学。",
            "id": "3900695",
            "problem": "考虑与海洋酸化模型相关的水合二氧化碳水化反应。基本反应是溶解的二氧化碳可逆水化生成碳酸，写作 $\\mathrm{CO_2(aq)} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{H_2CO_3}$。假设水的活度基本恒定，该反应可用伪一级动力学模型来描述，其正向速率常数为 $k_f$，逆向速率常数为 $k_r$，单位均为 $\\mathrm{s^{-1}}$。令 $C(t)$ 表示溶解二氧化碳的浓度，单位为 $\\mathrm{mol\\ kg^{-1}}$；$H(t)$ 表示碳酸的浓度，单位为 $\\mathrm{mol\\ kg^{-1}}$。在短时间尺度上，忽略与大气的任何交换以及碳酸的任何酸碱离解。在这些假设下，总水合碳 $C_t = C(t) + H(t)$ 是守恒的。使用质量作用定律和 $C_t$ 守恒，建立控制常微分方程（常微分方程(ODE)指涉及单个自变量的函数及其导数的微分方程），并推导 $H(t)$ 关于 $k_f$、$k_r$、$C_t$ 和初始条件 $H(0) = H_0$ 的弛豫表达式。\n\n将瞬时平衡假设定义为这样一个模型：对于所有 $t  0$，该模型将 $H(t)$ 设为等于平衡浓度 $H_{\\mathrm{eq}}$，其中 $H_{\\mathrm{eq}}$ 由比率 $k_f/k_r$ 和守恒的 $C_t$ 决定。通过无量纲相对偏差来量化动力学弛豫模型与瞬时平衡假设之间的差异\n$$\n\\varepsilon(t) = \\frac{H_{\\mathrm{kin}}(t) - H_{\\mathrm{eq}}}{H_{\\mathrm{eq}}},\n$$\n其中 $H_{\\mathrm{kin}}(t)$ 是弛豫ODE的解，$H_{\\mathrm{eq}}$ 是由速率常数所隐含的平衡值。\n\n编写一个完整的、可运行的程序，该程序针对一组指定的测试用例，计算每个用例在指定评估时间 $T$ 的 $\\varepsilon(T)$。所有浓度单位必须为 $\\mathrm{mol\\ kg^{-1}}$，所有速率常数单位为 $\\mathrm{s^{-1}}$，所有时间单位为 $\\mathrm{s}$。程序必须实现解析推导的弛豫解，并且不得使用数值ODE求解器。\n\n测试套件（每个用例为 $(k_f, k_r, C_t, H_0, T)$）：\n\n- 用例 1：$(k_f = 0.03\\,\\mathrm{s^{-1}},\\ k_r = 23.0\\,\\mathrm{s^{-1}},\\ C_t = 1.0\\times 10^{-4}\\,\\mathrm{mol\\ kg^{-1}},\\ H_0 = 0\\,\\mathrm{mol\\ kg^{-1}},\\ T = 0.043478\\,\\mathrm{s})$；此评估时间约等于弛豫时间尺度 $1/(k_f + k_r)$。\n- 用例 2：$(k_f = 0.03\\,\\mathrm{s^{-1}},\\ k_r = 23.0\\,\\mathrm{s^{-1}},\\ C_t = 1.0\\times 10^{-4}\\,\\mathrm{mol\\ kg^{-1}},\\ H_0 = 0\\,\\mathrm{mol\\ kg^{-1}},\\ T = 60\\,\\mathrm{s})$；此用例测试长时间极限。\n- 用例 3：$(k_f = 0.03\\,\\mathrm{s^{-1}},\\ k_r = 23.0\\,\\mathrm{s^{-1}},\\ C_t = 1.0\\times 10^{-4}\\,\\mathrm{mol\\ kg^{-1}},\\ H_0 = 3.0\\times 10^{-7}\\,\\mathrm{mol\\ kg^{-1}},\\ T = 0.01\\,\\mathrm{s})$；此用例测试相对于平衡初始过饱和的碳酸。\n- 用例 4：$(k_f = 0.03\\,\\mathrm{s^{-1}},\\ k_r = 23.0\\,\\mathrm{s^{-1}},\\ C_t = 1.0\\times 10^{-4}\\,\\mathrm{mol\\ kg^{-1}},\\ H_0 = 0\\,\\mathrm{mol\\ kg^{-1}},\\ T = 0\\,\\mathrm{s})$；此用例测试初始时间的边界条件。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，结果顺序与给定用例的顺序一致，其中每个元素是该用例的 $\\varepsilon(T)$ 的浮点值（例如，“$[x_1,x_2,x_3,x_4]$”）。",
            "solution": "该问题被评估为有效，因为它在科学上是合理的，问题提法清晰，并包含唯一解所需的所有必要信息。以下是完整的推导和解答。\n\n问题的核心是在一个封闭水系统中，对由可逆伪一级反应 $\\mathrm{CO_2(aq)} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{H_2CO_3}$ 控制的碳酸浓度 $H(t)$ 的时间演化进行建模。\n\n首先，我们建立 $H(t)$ 的控制常微分方程。$H(t)$ 的变化率等于它从 $\\mathrm{CO_2(aq)}$ 生成的速率减去它分解回 $\\mathrm{CO_2(aq)}$ 的速率。根据给定伪一级动力学的质量作用定律，这可以表示为：\n$$\n\\frac{dH(t)}{dt} = k_f C(t) - k_r H(t)\n$$\n其中 $C(t)$ 是水合 $\\mathrm{CO_2}$ 的浓度，$k_f$ 是正向速率常数，$k_r$ 是逆向速率常数。\n\n问题陈述，总水合碳 $C_t = C(t) + H(t)$ 是守恒的。我们可以利用这个守恒定律从速率方程中消除 $C(t)$：\n$$\nC(t) = C_t - H(t)\n$$\n将此表达式代入速率方程，得到：\n$$\n\\frac{dH}{dt} = k_f (C_t - H(t)) - k_r H(t)\n$$\n展开并合并包含 $H(t)$ 的项，我们得到：\n$$\n\\frac{dH}{dt} = k_f C_t - (k_f + k_r) H(t)\n$$\n这是一个一阶线性非齐次常微分方程。我们可以将其重排为标准形式 $\\frac{dy}{dt} + P(t)y = Q(t)$：\n$$\n\\frac{dH}{dt} + (k_f + k_r)H = k_f C_t\n$$\n该方程可以使用积分因子 $I(t) = e^{\\int (k_f + k_r) dt} = e^{(k_f + k_r)t}$ 求解。将 ODE 乘以 $I(t)$ 得：\n$$\ne^{(k_f + k_r)t} \\frac{dH}{dt} + (k_f + k_r)e^{(k_f + k_r)t} H = k_f C_t e^{(k_f + k_r)t}\n$$\n左侧是乘积 $H(t)e^{(k_f + k_r)t}$ 的导数：\n$$\n\\frac{d}{dt} \\left( H(t) e^{(k_f + k_r)t} \\right) = k_f C_t e^{(k_f + k_r)t}\n$$\n对两边关于时间 $t$ 积分：\n$$\nH(t) e^{(k_f + k_r)t} = \\int k_f C_t e^{(k_f + k_r)t} dt = \\frac{k_f C_t}{k_f + k_r} e^{(k_f + k_r)t} + A\n$$\n其中 $A$ 是积分常数。通过除以 $e^{(k_f + k_r)t}$ 来求解 $H(t)$：\n$$\nH(t) = \\frac{k_f C_t}{k_f + k_r} + A e^{-(k_f + k_r)t}\n$$\n积分常数 $A$ 由初始条件 $H(0) = H_0$ 决定：\n$$\nH_0 = \\frac{k_f C_t}{k_f + k_r} + A e^0 \\implies A = H_0 - \\frac{k_f C_t}{k_f + k_r}\n$$\n将 $A$ 代回通解，得到动力学模型的特解，我们将其记为 $H_{\\mathrm{kin}}(t)$：\n$$\nH_{\\mathrm{kin}}(t) = \\frac{k_f C_t}{k_f + k_r} + \\left(H_0 - \\frac{k_f C_t}{k_f + k_r}\\right)e^{-(k_f + k_r)t}\n$$\n接下来，我们确定平衡浓度 $H_{\\mathrm{eq}}$。在平衡状态下，净反应速率为零，即 $\\frac{dH}{dt} = 0$。由 ODE 可得：\n$$\n0 = k_f C_t - (k_f + k_r) H_{\\mathrm{eq}}\n$$\n求解 $H_{\\mathrm{eq}}$：\n$$\nH_{\\mathrm{eq}} = \\frac{k_f C_t}{k_f + k_r}\n$$\n这个平衡值是 $H(t)$ 在 $t \\to \\infty$ 时趋近的浓度。通过在我们对 $H_{\\mathrm{kin}}(t)$ 的解中识别出这一项，我们可以更紧凑地重写弛豫表达式：\n$$\nH_{\\mathrm{kin}}(t) = H_{\\mathrm{eq}} + (H_0 - H_{\\mathrm{eq}})e^{-(k_f + k_r)t}\n$$\n此表达式清楚地显示了浓度从其初始值 $H_0$ 弛豫到其最终平衡值 $H_{\\mathrm{eq}}$ 的过程，其特征弛豫时间为 $\\tau = 1/(k_f + k_r)$。\n\n最后，我们推导无量纲相对偏差 $\\varepsilon(t)$ 的表达式：\n$$\n\\varepsilon(t) = \\frac{H_{\\mathrm{kin}}(t) - H_{\\mathrm{eq}}}{H_{\\mathrm{eq}}}\n$$\n代入推导出的 $H_{\\mathrm{kin}}(t)$ 的弛豫表达式：\n$$\n\\varepsilon(t) = \\frac{\\left(H_{\\mathrm{eq}} + (H_0 - H_{\\mathrm{eq}})e^{-(k_f + k_r)t}\\right) - H_{\\mathrm{eq}}}{H_{\\mathrm{eq}}}\n$$\n$$\n\\varepsilon(t) = \\frac{(H_0 - H_{\\mathrm{eq}})e^{-(k_f + k_r)t}}{H_{\\mathrm{eq}}} = \\left(\\frac{H_0}{H_{\\mathrm{eq}}} - 1\\right)e^{-(k_f + k_r)t}\n$$\n将 $H_{\\mathrm{eq}}$ 的公式代入前置因子，得到一个等价形式，这在实现时可能很有用：\n$$\n\\frac{H_0}{H_{\\mathrm{eq}}} - 1 = \\frac{H_0}{\\frac{k_f C_t}{k_f + k_r}} - 1 = \\frac{H_0(k_f+k_r)}{k_f C_t} - 1\n$$\n因此，最终需要实现的解析表达式是：\n$$\n\\varepsilon(t) = \\left(\\frac{H_0(k_f+k_r)}{k_f C_t} - 1\\right)e^{-(k_f + k_r)t}\n$$\n此表达式将用于计算每个测试用例所需的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the relative deviation epsilon(T) for a set of test cases\n    modeling CO2 hydration kinetics.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (kf, kr, Ct, H0, T)\n    # kf: forward rate constant (s^-1)\n    # kr: reverse rate constant (s^-1)\n    # Ct: total hydrated carbon concentration (mol kg^-1)\n    # H0: initial carbonic acid concentration (mol kg^-1)\n    # T: evaluation time (s)\n    test_cases = [\n        # Case 1: T is the relaxation timescale\n        (0.03, 23.0, 1.0e-4, 0.0, 0.043478),\n        # Case 2: Long-time limit\n        (0.03, 23.0, 1.0e-4, 0.0, 60.0),\n        # Case 3: Initially supersaturated H2CO3\n        (0.03, 23.0, 1.0e-4, 3.0e-7, 0.01),\n        # Case 4: Initial time boundary condition\n        (0.03, 23.0, 1.0e-4, 0.0, 0.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        kf, kr, Ct, H0, T = case\n\n        # The derived analytical expression for the relative deviation epsilon(t) is:\n        # epsilon(t) = (H_kin(t) - H_eq) / H_eq\n        # where H_kin(t) = H_eq + (H0 - H_eq) * exp(-(kf + kr) * t)\n        # This simplifies to:\n        # epsilon(t) = ((H0 / H_eq) - 1) * exp(-(kf + kr) * t)\n\n        # 1. Calculate the sum of rate constants, which is the relaxation rate.\n        k_sum = kf + kr\n\n        # 2. Calculate the equilibrium concentration of carbonic acid, H_eq.\n        # H_eq = (kf * Ct) / (kf + kr).\n        # Based on the problem constraints, kf  0 and Ct  0, so H_eq  0.\n        # No division-by-zero risk for H_eq in the formula for epsilon.\n        H_eq = (kf * Ct) / k_sum\n\n        # 3. Calculate the kinetic concentration of carbonic acid at time T.\n        H_kin_T = H_eq + (H0 - H_eq) * np.exp(-k_sum * T)\n        \n        # 4. Calculate the relative deviation epsilon(T).\n        # It is numerically stable to use the simplified form to avoid two subtractions.\n        # epsilon_T = ((H0/H_eq) - 1.0) * np.exp(-1.0 * k_sum * T)\n        epsilon_T = (H_kin_T - H_eq) / H_eq\n        \n        results.append(epsilon_T)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}