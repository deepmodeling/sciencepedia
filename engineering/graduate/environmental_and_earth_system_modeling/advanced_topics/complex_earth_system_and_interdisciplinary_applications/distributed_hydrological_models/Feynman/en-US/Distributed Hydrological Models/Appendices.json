{
    "hands_on_practices": [
        {
            "introduction": "The fundamental unit of any distributed hydrological model is the computational cell, which acts as a control volume where water fluxes are balanced. This exercise explores the core principle of mass conservation within such a cell, treating its storage as a simple dynamical system. By analyzing the conditions under which water storage reaches a stable equilibrium under constant forcings, you will gain foundational insight into model behavior, stability, and the relationship between parameters and hydrological states .",
            "id": "3874841",
            "problem": "Consider a single computational cell in a distributed hydrological model for an environmental and earth system modeling application. The vertically integrated water storage, denoted by $S(t)$, evolves according to conservation of mass as the difference between time-invariant precipitation input $P$, time-invariant evapotranspiration (ET) loss $ET$, and the sum of two storage-dependent fluxes: a lateral discharge $Q(S)$ to the channel network and a recharge or percolation loss $R(S)$ to the deep subsurface. The governing equation is the ordinary differential equation for $S(t)$ obtained from mass conservation principles: the rate of change of storage equals inflows minus outflows.\n\nAssume a parameterization consistent with linear reservoir theory for lateral discharge and a nonlinear storage-dependent drainage for recharge:\n- $Q(S) = k_{1} S$ with $k_{1} > 0$,\n- $R(S) = k_{2} S^{2}$ with $k_{2} > 0$.\n\nStarting from the fundamental definition of steady state ($\\mathrm{d}S/\\mathrm{d}t = 0$), derive the condition for the existence of a physically admissible steady-state storage $S^{*} \\geq 0$ under the time-invariant forcings $P$ and $ET$, and establish uniqueness of $S^{*}$ in terms of the parameters $P$, $ET$, $k_{1}$, and $k_{2}$. Then analyze the local asymptotic stability of $S^{*}$ by linearizing the storage dynamics around $S^{*}$ and stating the stability condition in terms of the derivative of the net flux with respect to $S$.\n\nFinally, for the parameter values $P = 6\\ \\mathrm{mm\\,day^{-1}}$, $ET = 2\\ \\mathrm{mm\\,day^{-1}}$, $k_{1} = 0.1\\ \\mathrm{day^{-1}}$, and $k_{2} = 0.005\\ \\mathrm{mm^{-1}\\,day^{-1}}$, compute the steady-state storage $S^{*}$. Express the final storage in millimeters and round your answer to four significant figures.",
            "solution": "The starting point is the conservation of mass for a control volume representing a single computational cell. The vertically integrated water storage $S(t)$ obeys\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = P - ET - Q(S) - R(S),\n$$\nwhere $P$ and $ET$ are time-invariant precipitation and evapotranspiration (ET) fluxes, respectively, and $Q(S)$ and $R(S)$ are storage-dependent losses to lateral discharge and deep recharge.\n\nUnder the given parameterizations $Q(S) = k_{1} S$ and $R(S) = k_{2} S^{2}$ with $k_{1} > 0$ and $k_{2} > 0$, the dynamical system can be written as\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = P - ET - k_{1} S - k_{2} S^{2}.\n$$\n\nA steady state $S^{*}$ is defined by the condition\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t}\\bigg|_{S=S^{*}} = 0,\n$$\nwhich yields the algebraic balance\n$$\n0 = P - ET - k_{1} S^{*} - k_{2} S^{*2}.\n$$\nRearranging gives the quadratic equation in $S^{*}$:\n$$\nk_{2} S^{*2} + k_{1} S^{*} - (P - ET) = 0.\n$$\n\nExistence and uniqueness of a physically admissible steady state:\n- Consider $P - ET$. If $P - ET < 0$, then for any $S \\geq 0$,\n$$\nP - ET - k_{1} S - k_{2} S^{2} \\leq P - ET < 0,\n$$\nand the steady-state equation cannot be satisfied for any $S^{*} \\geq 0$; hence, no physically admissible steady state exists.\n- If $P - ET = 0$, the quadratic becomes $k_{2} S^{*2} + k_{1} S^{*} = 0$, whose nonnegative solutions are $S^{*} = 0$ and $S^{*} = -k_{1}/k_{2} < 0$; the only physically admissible steady state is $S^{*} = 0$, which is unique in the nonnegative domain.\n- If $P - ET > 0$, the quadratic has discriminant\n$$\n\\Delta = k_{1}^{2} + 4 k_{2} (P - ET) > 0,\n$$\nand two real roots\n$$\nS^{*}_{\\pm} = \\frac{-k_{1} \\pm \\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)}}{2 k_{2}}.\n$$\nSince $k_{2} > 0$ and $\\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)} > k_{1}$, it follows that $S^{*}_{+} > 0$ and $S^{*}_{-} < 0$. Therefore, there is exactly one physically admissible (nonnegative) root,\n$$\nS^{*} = \\frac{-k_{1} + \\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)}}{2 k_{2}},\n$$\nwhich establishes uniqueness in the physically meaningful domain $S^{*} \\geq 0$.\n\nLocal asymptotic stability:\nDefine the net flux function\n$$\nf(S) = P - ET - k_{1} S - k_{2} S^{2}.\n$$\nA steady state $S^{*}$ is locally asymptotically stable if the linearized system around $S^{*}$ has a negative growth rate, i.e., if\n$$\nf'(S^{*}) < 0.\n$$\nCompute the derivative:\n$$\nf'(S) = -k_{1} - 2 k_{2} S.\n$$\nFor any $S^{*} \\geq 0$ with $k_{1} > 0$ and $k_{2} > 0$, we have\n$$\nf'(S^{*}) = -k_{1} - 2 k_{2} S^{*} < 0.\n$$\nThus, any physically admissible steady state in this model class is locally asymptotically stable.\n\nNumerical evaluation:\nGiven $P = 6\\ \\mathrm{mm\\,day^{-1}}$, $ET = 2\\ \\mathrm{mm\\,day^{-1}}$, $k_{1} = 0.1\\ \\mathrm{day^{-1}}$, and $k_{2} = 0.005\\ \\mathrm{mm^{-1}\\,day^{-1}}$, first confirm $P - ET > 0$:\n$$\nP - ET = 6 - 2 = 4.\n$$\nCompute the discriminant:\n$$\nk_{1}^{2} + 4 k_{2} (P - ET) = (0.1)^{2} + 4 \\cdot 0.005 \\cdot 4 = 0.01 + 0.08 = 0.09.\n$$\nThen\n$$\n\\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)} = \\sqrt{0.09} = 0.3.\n$$\nCompute $S^{*}$:\n$$\nS^{*} = \\frac{-0.1 + 0.3}{2 \\cdot 0.005} = \\frac{0.2}{0.01} = 20.\n$$\nExpressed in millimeters and rounded to four significant figures, the steady-state storage is $20.00$ mm.",
            "answer": "$$\\boxed{20.00}$$"
        },
        {
            "introduction": "A primary function of a hydrological model is to partition rainfall into different pathways, a critical step for predicting both floods and water availability. This practice delves into the physics of Hortonian, or infiltration-excess, runoff, one of the primary mechanisms for surface flow generation. Using the foundational Green-Ampt model, you will derive and calculate the \"ponding time,\" the moment when rainfall intensity overwhelms the soil's capacity to absorb water, marking the onset of runoff .",
            "id": "3874885",
            "problem": "A single square grid cell in a distributed hydrological model is represented as a vertically homogeneous, initially unsaturated soil column. Assume one-dimensional (1D) vertical flow and the sharp wetting front hypothesis with a saturated layer above the wetting front (the Green-Ampt infiltration assumption). Rain falls uniformly over the cell at constant intensity $i_{0}$ starting at time $t=0$, with negligible surface ponding head before runoff begins. Hortonian (infiltration-excess) runoff commences at the ponding time $t_{p}$, defined implicitly as the first time that the rainfall intensity exceeds the infiltration capacity of the soil surface.\n\nYou are given:\n- Saturated hydraulic conductivity $K_{s} = 2.0 \\times 10^{-6}\\ \\mathrm{m\\,s^{-1}}$.\n- Saturated volumetric water content $\\theta_{s} = 0.45$.\n- Initial volumetric water content $\\theta_{i} = 0.20$.\n- Wetting front suction head $\\Psi_{f} = 0.11\\ \\mathrm{m}$.\n- Constant rainfall intensity $i_{0} = 3.6 \\times 10^{-6}\\ \\mathrm{m\\,s^{-1}}$.\n\nStarting from Darcy’s law and conservation of mass under a sharp wetting front, derive the condition that defines the infiltration capacity in terms of the cumulative infiltration and then determine the closed-form expression for the ponding time $t_{p}$ in this setting. Compute the numerical value of $t_{p}$ using the data provided. Express your final answer in minutes and round to three significant figures.",
            "solution": "The physical setting is one-dimensional (1D) vertical infiltration into a homogeneous soil. The fundamental starting points are:\n- Darcy’s law for vertical flow, $q = -K_{s}\\,\\frac{\\partial H}{\\partial z}$, where $q$ is the Darcy flux (positive downward), $K_{s}$ is the saturated hydraulic conductivity, and $H$ is hydraulic head.\n- Conservation of mass across a sharp wetting front: the cumulative infiltration $F(t)$ equals the increase in water storage within the wetted depth $Z_{f}(t)$, i.e., $F(t) = \\Delta \\theta\\, Z_{f}(t)$, where $\\Delta \\theta = \\theta_{s} - \\theta_{i}$.\n\nUnder the Green-Ampt sharp wetting front assumption, there is a saturated layer from the surface to the wetting front at depth $Z_{f}$. Let the ponded head at the surface prior to runoff be negligible, so the pressure head at the surface is $h_{s} \\approx 0$. The pressure head immediately ahead of the wetting front is $h_{w} = -\\Psi_{f}$, where $\\Psi_{f} > 0$ is the magnitude of the suction head at the wetting front. Taking the elevation difference between the surface and the front as $Z_{f}$, the head difference across the layer is\n$$\nH_{s} - H_{w} = (h_{s} + z_{s}) - (h_{w} + z_{w}) = h_{s} + \\Psi_{f} + (z_{s} - z_{w}) \\approx \\Psi_{f} + Z_{f},\n$$\nsince $h_{s} \\approx 0$ and $z_{s} - z_{w} = Z_{f}$. Approximating the hydraulic gradient as the head drop over the thickness $Z_{f}$, Darcy’s law yields the infiltration capacity (maximum possible downward flux under these conditions):\n$$\nf = K_{s}\\left( \\frac{H_{s} - H_{w}}{Z_{f}} \\right) \\approx K_{s}\\left( 1 + \\frac{\\Psi_{f}}{Z_{f}} \\right).\n$$\nBy conservation of mass with the sharp front, the cumulative infiltration $F$ and wetting front depth $Z_{f}$ are related by\n$$\nF = \\Delta \\theta\\, Z_{f} \\quad \\Longrightarrow \\quad Z_{f} = \\frac{F}{\\Delta \\theta}.\n$$\nSubstituting this into the expression for $f$ gives the infiltration capacity as a function of cumulative infiltration:\n$$\nf(F) = K_{s}\\left( 1 + \\frac{\\Psi_{f}\\, \\Delta \\theta}{F} \\right).\n$$\n\nBefore ponding, there is no surface storage; the infiltration rate equals the rainfall intensity, so the cumulative infiltration up to time $t$ is\n$$\nF(t) = \\int_{0}^{t} i_{0}\\, \\mathrm{d}t = i_{0}\\, t,\n$$\nsince $i_{0}$ is constant. Ponding begins when the rainfall intensity first equals the infiltration capacity, i.e.,\n$$\ni_{0} = f(F(t_{p})) = K_{s}\\left( 1 + \\frac{\\Psi_{f}\\, \\Delta \\theta}{F(t_{p})} \\right).\n$$\nSolving for $F(t_{p})$,\n$$\n\\frac{i_{0}}{K_{s}} - 1 = \\frac{\\Psi_{f}\\, \\Delta \\theta}{F(t_{p})}\n\\quad \\Longrightarrow \\quad\nF(t_{p}) = \\frac{\\Psi_{f}\\, \\Delta \\theta\\, K_{s}}{i_{0} - K_{s}}.\n$$\nBut $F(t_{p}) = i_{0}\\, t_{p}$, hence the ponding time is\n$$\nt_{p} = \\frac{F(t_{p})}{i_{0}} = \\frac{\\Psi_{f}\\, \\Delta \\theta\\, K_{s}}{i_{0}\\,(i_{0} - K_{s})}.\n$$\n\nNow substitute the given data. First compute the moisture increment:\n$$\n\\Delta \\theta = \\theta_{s} - \\theta_{i} = 0.45 - 0.20 = 0.25.\n$$\nCompute the numerator:\n$$\n\\Psi_{f}\\, \\Delta \\theta\\, K_{s} = \\left(0.11\\ \\mathrm{m}\\right)\\left(0.25\\right)\\left(2.0 \\times 10^{-6}\\ \\mathrm{m\\,s^{-1}}\\right) = 5.5 \\times 10^{-8}\\ \\mathrm{m^{2}\\,s^{-1}}.\n$$\nCompute the denominator:\n$$\ni_{0}\\,(i_{0} - K_{s}) = \\left(3.6 \\times 10^{-6}\\ \\mathrm{m\\,s^{-1}}\\right)\\left(3.6 \\times 10^{-6} - 2.0 \\times 10^{-6}\\right)\\ \\mathrm{m\\,s^{-1}} \\\\\n= \\left(3.6 \\times 10^{-6}\\right)\\left(1.6 \\times 10^{-6}\\right)\\ \\mathrm{m^{2}\\,s^{-2}} = 5.76 \\times 10^{-12}\\ \\mathrm{m^{2}\\,s^{-2}}.\n$$\nThus,\n$$\nt_{p} = \\frac{5.5 \\times 10^{-8}}{5.76 \\times 10^{-12}}\\ \\mathrm{s} = 9.548611\\ldots \\times 10^{3}\\ \\mathrm{s}.\n$$\nConvert seconds to minutes:\n$$\nt_{p,\\ \\mathrm{min}} = \\frac{9.548611\\ldots \\times 10^{3}}{60}\\ \\mathrm{min} = 1.59143\\ldots \\times 10^{2}\\ \\mathrm{min}.\n$$\nRounded to three significant figures, the ponding time is\n$$\nt_{p,\\ \\mathrm{min}} = 1.59 \\times 10^{2}\\ \\mathrm{min}.\n$$",
            "answer": "$$\\boxed{1.59 \\times 10^{2}}$$"
        },
        {
            "introduction": "Distributed models are powerful because they can represent spatial heterogeneity, but this raises the question of how much detail is truly necessary. This exercise uses statistical theory to quantify the error introduced by a common simplification: treating a variable rainfall field as spatially uniform. By analyzing the interaction between a nonlinear runoff function and a statistically described rainfall field, you will see why simply using the average rainfall can lead to significant biases in predicted watershed runoff .",
            "id": "3874849",
            "problem": "Consider a distributed hydrological model for a watershed of area $A$ that partitions the domain into infinitesimal elements indexed by location $\\mathbf{x} \\in A$. Let the spatially heterogeneous rainfall field be denoted by $P(\\mathbf{x})$, with $P(\\mathbf{x}) > 0$ everywhere. The pixel-level instantaneous runoff response is described by a nonlinear function $Q(P) = a P^{b}$, where $a > 0$ and $b > 0$ are constants characterizing the hydrologic response of the landscape.\n\nAssume the following scientifically grounded conditions:\n- The watershed is large enough and sufficiently ergodic that spatial averages of functions of $P(\\mathbf{x})$ converge to ensemble expectations $\\mathbb{E}[\\cdot]$ taken with respect to the stationary distribution of $P(\\mathbf{x})$.\n- The rainfall field $P(\\mathbf{x})$ is lognormally distributed across the watershed, in the sense that $\\ln P(\\mathbf{x})$ is Gaussian with mean $\\mu$ and variance $\\sigma^{2}$, identically and independently distributed at the pixel scale. That is, $\\ln P(\\mathbf{x}) \\sim \\mathcal{N}(\\mu, \\sigma^{2})$, so $P(\\mathbf{x})$ has a lognormal distribution with parameters $(\\mu, \\sigma^{2})$.\n\nDefine the following quantities:\n- The true distributed mean runoff (obtained by applying $Q(\\cdot)$ pointwise and then averaging) is\n$$\\overline{Q}_{\\mathrm{true}} = \\lim_{|A|\\to\\infty}\\frac{1}{|A|}\\int_{A} Q(P(\\mathbf{x}))\\,\\mathrm{d}\\mathbf{x} = \\mathbb{E}[Q(P)] = \\mathbb{E}[a P^{b}].$$\n- The uniform-rainfall mean runoff approximation (obtained by replacing the heterogeneous rainfall field with its spatial mean and then applying $Q(\\cdot)$) is\n$$\\overline{Q}_{\\mathrm{unif}} = Q\\big(\\mathbb{E}[P]\\big) = a\\big(\\mathbb{E}[P]\\big)^{b}.$$\n\nStarting from the definitions of spatial averaging and expectations, and using only fundamental properties of the lognormal distribution and the fact that expectations of functions are given by integrals against the probability density function, derive the closed-form analytic expression for the fractional error in mean runoff introduced by treating the heterogeneous rainfall field as uniform:\n$${\\varepsilon} = \\frac{\\overline{Q}_{\\mathrm{unif}} - \\overline{Q}_{\\mathrm{true}}}{\\overline{Q}_{\\mathrm{true}}}.$$\n\nExpress your final answer as a single simplified symbolic expression in terms of $a$, $b$, $\\mu$, and $\\sigma^{2}$. No numerical substitution is required. The fractional error ${\\varepsilon}$ is dimensionless; no units are required. Provide the final answer as a closed-form analytic expression.",
            "solution": "The problem requires the derivation of the fractional error, $\\varepsilon$, which arises from approximating the mean runoff from a spatially heterogeneous rainfall field with the runoff calculated from the mean rainfall. The fractional error is defined as:\n$${\\varepsilon} = \\frac{\\overline{Q}_{\\mathrm{unif}} - \\overline{Q}_{\\mathrm{true}}}{\\overline{Q}_{\\mathrm{true}}} = \\frac{\\overline{Q}_{\\mathrm{unif}}}{\\overline{Q}_{\\mathrm{true}}} - 1$$\nTo find $\\varepsilon$, we must first derive expressions for the true mean runoff, $\\overline{Q}_{\\mathrm{true}}$, and the uniform-rainfall approximation, $\\overline{Q}_{\\mathrm{unif}}$.\n\nThe problem states that the rainfall intensity $P(\\mathbf{x})$ follows a lognormal distribution, such that if we define a random variable $P$ representing the rainfall at an arbitrary point, then $\\ln P$ is normally distributed with mean $\\mu$ and variance $\\sigma^{2}$. Let $X = \\ln P$, so $X \\sim \\mathcal{N}(\\mu, \\sigma^{2})$. Consequently, $P = \\exp(X)$. The runoff response is given by the nonlinear function $Q(P) = aP^b$.\n\nFirst, we compute the true distributed mean runoff, $\\overline{Q}_{\\mathrm{true}}$. This is the spatial average of the runoff function, which, by the ergodicity assumption, is equal to the expectation of $Q(P)$.\n$$\\overline{Q}_{\\mathrm{true}} = \\mathbb{E}[Q(P)] = \\mathbb{E}[aP^{b}]$$\nSince $a$ is a constant, we can write:\n$$\\overline{Q}_{\\mathrm{true}} = a\\mathbb{E}[P^{b}]$$\nTo compute the expectation $\\mathbb{E}[P^{b}]$, we substitute $P = \\exp(X)$:\n$$\\mathbb{E}[P^{b}] = \\mathbb{E}[(\\exp(X))^{b}] = \\mathbb{E}[\\exp(bX)]$$\nThis expression is the moment-generating function (MGF) of the normal random variable $X \\sim \\mathcal{N}(\\mu, \\sigma^{2})$, evaluated at $t=b$. The MGF of a normal random variable is given by $M_X(t) = \\exp(\\mu t + \\frac{1}{2}\\sigma^2 t^2)$.\nEvaluating this at $t=b$, we find the $b$-th moment of the lognormal distribution:\n$$\\mathbb{E}[P^{b}] = M_X(b) = \\exp\\left(b\\mu + \\frac{1}{2}b^{2}\\sigma^{2}\\right)$$\nSubstituting this back into the expression for $\\overline{Q}_{\\mathrm{true}}$ yields:\n$$\\overline{Q}_{\\mathrm{true}} = a \\exp\\left(b\\mu + \\frac{1}{2}b^{2}\\sigma^{2}\\right)$$\n\nNext, we compute the uniform-rainfall mean runoff approximation, $\\overline{Q}_{\\mathrm{unif}}$. This is found by applying the runoff function $Q$ to the mean rainfall, $\\mathbb{E}[P]$.\n$$\\overline{Q}_{\\mathrm{unif}} = Q(\\mathbb{E}[P]) = a\\left(\\mathbb{E}[P]\\right)^{b}$$\nWe first need to find the mean of the rainfall, $\\mathbb{E}[P]$. This is the first moment of the lognormal distribution, which can be found by setting $b=1$ in our previous moment calculation:\n$$\\mathbb{E}[P] = \\mathbb{E}[P^1] = M_X(1) = \\exp\\left(\\mu(1) + \\frac{1}{2}\\sigma^2 (1)^2\\right) = \\exp\\left(\\mu + \\frac{1}{2}\\sigma^{2}\\right)$$\nNow, we substitute this mean value into the expression for $\\overline{Q}_{\\mathrm{unif}}$:\n$$\\overline{Q}_{\\mathrm{unif}} = a\\left(\\exp\\left(\\mu + \\frac{1}{2}\\sigma^{2}\\right)\\right)^{b}$$\nUsing the power rule for exponentials, $(e^x)^y = e^{xy}$, we simplify this to:\n$$\\overline{Q}_{\\mathrm{unif}} = a \\exp\\left(b\\left(\\mu + \\frac{1}{2}\\sigma^{2}\\right)\\right) = a \\exp\\left(b\\mu + \\frac{1}{2}b\\sigma^{2}\\right)$$\n\nWith the expressions for $\\overline{Q}_{\\mathrm{true}}$ and $\\overline{Q}_{\\mathrm{unif}}$, we can now calculate the fractional error $\\varepsilon$.\n$${\\varepsilon} = \\frac{\\overline{Q}_{\\mathrm{unif}}}{\\overline{Q}_{\\mathrm{true}}} - 1 = \\frac{a \\exp\\left(b\\mu + \\frac{1}{2}b\\sigma^{2}\\right)}{a \\exp\\left(b\\mu + \\frac{1}{2}b^{2}\\sigma^{2}\\right)} - 1$$\nThe constant $a$ cancels out. We combine the exponentials using the rule $e^x/e^y = e^{x-y}$:\n$${\\varepsilon} = \\exp\\left(\\left(b\\mu + \\frac{1}{2}b\\sigma^{2}\\right) - \\left(b\\mu + \\frac{1}{2}b^{2}\\sigma^{2}\\right)\\right) - 1$$\nThe term $b\\mu$ cancels in the exponent:\n$${\\varepsilon} = \\exp\\left(\\frac{1}{2}b\\sigma^{2} - \\frac{1}{2}b^{2}\\sigma^{2}\\right) - 1$$\nFactoring out the common term $\\frac{1}{2}\\sigma^2$ from the exponent gives the final simplified expression:\n$${\\varepsilon} = \\exp\\left(\\frac{1}{2}\\sigma^2(b - b^2)\\right) - 1$$\nThis is the closed-form analytic expression for the fractional error, expressed in terms of the runoff nonlinearity parameter $b$ and the variance of the log-rainfall $\\sigma^2$.",
            "answer": "$$\\boxed{\\exp\\left(\\frac{1}{2}(b-b^2)\\sigma^2\\right) - 1}$$"
        }
    ]
}