{
    "hands_on_practices": [
        {
            "introduction": "分布式水文模型的核心是单个计算网格，它可被视为一个基本的控制体。在模拟整个流域的复杂水文过程之前，我们必须首先理解这个基本单元如何响应降水等输入，以及其蓄水和产流的动态行为。本练习将引导你分析单个网格单元的质量平衡，并推导其在恒定输入条件下的“稳态”条件。通过求解稳态蓄水量 $S^*$ 并分析其稳定性，你将掌握诊断模型长期行为和参数敏感性的基本技能。",
            "id": "3874841",
            "problem": "考虑一个用于环境和地球系统建模应用的分布式水文模型中的单个计算单元。垂直积分蓄水量，记为 $S(t)$，其演变遵循质量守恒定律，即等于不随时间变化的降水输入 $P$ 与不随时间变化的蒸散（ET）损失 $ET$ 之差，再减去两个与蓄水量相关的通量之和：一个是排向河网的侧向径流 $Q(S)$，另一个是向深层地下补给或下渗的损失 $R(S)$。控制方程是根据质量守恒原理得到的关于 $S(t)$ 的常微分方程：蓄水量的变化率等于流入量减去流出量。\n\n假设侧向径流的参数化与线性水库理论一致，而补给的参数化为非线性的、依赖于蓄水量的排水：\n- $Q(S) = k_{1} S$，$k_{1} > 0$，\n- $R(S) = k_{2} S^{2}$，$k_{2} > 0$。\n\n从稳态的基本定义（$\\mathrm{d}S/\\mathrm{d}t = 0$）出发，推导在不随时间变化的强迫 $P$ 和 $ET$ 下，存在一个物理上可接受的稳态蓄水量 $S^{*} \\geq 0$ 的条件，并根据参数 $P$、$ET$、$k_{1}$ 和 $k_{2}$ 确定 $S^{*}$ 的唯一性。然后，通过在 $S^{*}$ 附近对蓄水动态进行线性化，分析 $S^{*}$ 的局部渐近稳定性，并用净通量对 $S$ 的导数来表述稳定性条件。\n\n最后，给定参数值 $P = 6$ mm day$^{-1}$，$ET = 2$ mm day$^{-1}$，$k_{1} = 0.1$ day$^{-1}$ 以及 $k_{2} = 0.005$ mm$^{-1}$ day$^{-1}$，计算稳态蓄水量 $S^{*}$。最终蓄水量以毫米为单位表示，并四舍五入到四位有效数字。",
            "solution": "出发点是代表单个计算单元的控制体的质量守恒。垂直积分蓄水量 $S(t)$ 遵循\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = P - ET - Q(S) - R(S),\n$$\n其中 $P$ 和 $ET$ 分别是不随时间变化的降水和蒸散（ET）通量，$Q(S)$ 和 $R(S)$ 是依赖于蓄水量的侧向径流和深层补给损失。\n\n在给定的参数化 $Q(S) = k_{1} S$ 和 $R(S) = k_{2} S^{2}$（其中 $k_{1} > 0$ 且 $k_{2} > 0$）下，该动力系统可写为\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = P - ET - k_{1} S - k_{2} S^{2}.\n$$\n\n稳态 $S^{*}$ 由条件定义\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t}\\bigg|_{S=S^{*}} = 0,\n$$\n这产生代数平衡方程\n$$\n0 = P - ET - k_{1} S^{*} - k_{2} S^{*2}.\n$$\n整理后得到关于 $S^{*}$ 的二次方程：\n$$\nk_{2} S^{*2} + k_{1} S^{*} - (P - ET) = 0.\n$$\n\n物理上可接受的稳态的存在性与唯一性：\n- 考虑 $P - ET$。如果 $P - ET  0$，那么对于任何 $S \\geq 0$，\n$$\nP - ET - k_{1} S - k_{2} S^{2} \\leq P - ET  0,\n$$\n稳态方程对于任何 $S^{*} \\geq 0$ 都无法满足；因此，不存在物理上可接受的稳态。\n- 如果 $P - ET = 0$，二次方程变为 $k_{2} S^{*2} + k_{1} S^{*} = 0$，其非负解为 $S^{*} = 0$ 和 $S^{*} = -k_{1}/k_{2}  0$；唯一物理上可接受的稳态是 $S^{*} = 0$，它在非负域中是唯一的。\n- 如果 $P - ET > 0$，二次方程的判别式为\n$$\n\\Delta = k_{1}^{2} + 4 k_{2} (P - ET) > 0,\n$$\n有两个实数根\n$$\nS^{*}_{\\pm} = \\frac{-k_{1} \\pm \\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)}}{2 k_{2}}.\n$$\n由于 $k_{2} > 0$ 且 $\\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)} > k_{1}$，可得 $S^{*}_{+} > 0$ 且 $S^{*}_{-}  0$。因此，恰好有一个物理上可接受的（非负）根，\n$$\nS^{*} = \\frac{-k_{1} + \\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)}}{2 k_{2}},\n$$\n这就在物理上有意义的域 $S^{*} \\geq 0$ 中确立了唯一性。\n\n局部渐近稳定性：\n定义净通量函数\n$$\nf(S) = P - ET - k_{1} S - k_{2} S^{2}.\n$$\n如果围绕 $S^{*}$ 的线性化系统具有负增长率，即如果\n$$\nf'(S^{*})  0.\n$$\n则稳态 $S^{*}$ 是局部渐近稳定的。\n计算导数：\n$$\nf'(S) = -k_{1} - 2 k_{2} S.\n$$\n对于任何 $S^{*} \\geq 0$ 以及 $k_{1} > 0$ 和 $k_{2} > 0$，我们有\n$$\nf'(S^{*}) = -k_{1} - 2 k_{2} S^{*}  0.\n$$\n因此，该模型类别中任何物理上可接受的稳态都是局部渐近稳定的。\n\n数值计算：\n给定 $P = 6$ mm day$^{-1}$，$ET = 2$ mm day$^{-1}$，$k_{1} = 0.1$ day$^{-1}$，以及 $k_{2} = 0.005$ mm$^{-1}$ day$^{-1}$，首先确认 $P - ET > 0$：\n$$\nP - ET = 6 - 2 = 4.\n$$\n计算判别式：\n$$\nk_{1}^{2} + 4 k_{2} (P - ET) = (0.1)^{2} + 4 \\cdot 0.005 \\cdot 4 = 0.01 + 0.08 = 0.09.\n$$\n则\n$$\n\\sqrt{k_{1}^{2} + 4 k_{2} (P - ET)} = \\sqrt{0.09} = 0.3.\n$$\n计算 $S^{*}$：\n$$\nS^{*} = \\frac{-0.1 + 0.3}{2 \\cdot 0.005} = \\frac{0.2}{0.01} = 20.\n$$\n以毫米表示并四舍五入到四位有效数字，稳态蓄水量为 $20.00$ mm。",
            "answer": "$$\\boxed{20.00}$$"
        },
        {
            "introduction": "分布式模型的一个关键功能是准确划分降雨如何转化为入渗和地表径流。这个过程的物理真实性直接决定了模型对洪水事件的预测能力。本练习将深入探讨霍顿（Hortonian）产流机制，这是一种当降雨强度超过土壤入渗能力时发生的径流形式。你将应用经典的、基于物理的格林-安普特（Green-Ampt）入渗模型来计算产流开始的“积水时间”，从而加深对降雨强度、土壤性质和径流响应之间相互作用的理解。",
            "id": "3874885",
            "problem": "在分布式水文模型中，单个方形网格单元被表示为一个垂直均质的、初始非饱和的土柱。假设存在一维（1D）垂直流动和陡峭湿润锋假说，即在湿润锋上方有一个饱和层（Green-Ampt入渗假说）。从时间 $t=0$ 开始，降雨以恒定强度 $i_{0}$ 均匀地落在该单元上，在径流开始前，地表积水水头可忽略不计。霍顿（超渗）径流在积水时间 $t_{p}$ 开始，该时间被隐式定义为降雨强度首次超过土壤表面入渗能力的时刻。\n\n给定：\n- 饱和导水率 $K_{s} = 2.0 \\times 10^{-6}\\ \\mathrm{m\\,s^{-1}}$。\n- 饱和体积含水量 $\\theta_{s} = 0.45$。\n- 初始体积含水量 $\\theta_{i} = 0.20$。\n- 湿润锋吸力水头 $\\Psi_{f} = 0.11\\ \\mathrm{m}$。\n- 恒定降雨强度 $i_{0} = 3.6 \\times 10^{-6}\\ \\mathrm{m\\,s^{-1}}$。\n\n从达西定律和陡峭湿润锋下的质量守恒出发，推导出用累积入渗量定义入渗能力的条件，然后确定在此设定下积水时间 $t_{p}$ 的闭式表达式。使用所提供的数据计算 $t_{p}$ 的数值。以分钟为单位表示最终答案，并四舍五入到三位有效数字。",
            "solution": "物理情景是一维（1D）垂直入渗到一个均质土壤中。基本出发点是：\n- 垂直流的达西定律，$q = -K_{s}\\,\\frac{\\partial H}{\\partial z}$，其中 $q$ 是达西通量（向下为正），$K_{s}$ 是饱和导水率，$H$ 是水力水头。\n- 陡峭湿润锋上的质量守恒：累积入渗量 $F(t)$ 等于湿润深度 $Z_{f}(t)$ 内的储水量增量，即 $F(t) = \\Delta \\theta\\, Z_{f}(t)$，其中 $\\Delta \\theta = \\theta_{s} - \\theta_{i}$。\n\n在Green-Ampt陡峭湿润锋假说下，从地表到深度为 $Z_{f}$ 的湿润锋之间存在一个饱和层。设径流发生前的地表积水水头可忽略不计，因此地表压力水头为 $h_{s} \\approx 0$。紧邻湿润锋前方的压力水头为 $h_{w} = -\\Psi_{f}$，其中 $\\Psi_{f} > 0$ 是湿润锋处吸力水头的大小。取地表与湿润锋之间的高程差为 $Z_{f}$，则该层两端的水头差为\n$$\nH_{s} - H_{w} = (h_{s} + z_{s}) - (h_{w} + z_{w}) = h_{s} + \\Psi_{f} + (z_{s} - z_{w}) \\approx \\Psi_{f} + Z_{f},\n$$\n因为 $h_{s} \\approx 0$ 且 $z_{s} - z_{w} = Z_{f}$。将水力梯度近似为厚度 $Z_{f}$ 上的水头降，达西定律得出入渗能力（在这些条件下可能的最大向下通量）：\n$$\nf = K_{s}\\left( \\frac{H_{s} - H_{w}}{Z_{f}} \\right) \\approx K_{s}\\left( 1 + \\frac{\\Psi_{f}}{Z_{f}} \\right).\n$$\n根据陡峭湿润锋的质量守恒，累积入渗量 $F$ 和湿润锋深度 $Z_{f}$ 的关系为\n$$\nF = \\Delta \\theta\\, Z_{f} \\quad \\Longrightarrow \\quad Z_{f} = \\frac{F}{\\Delta \\theta}.\n$$\n将此代入 $f$ 的表达式，得到作为累积入渗量函数的入渗能力：\n$$\nf(F) = K_{s}\\left( 1 + \\frac{\\Psi_{f}\\, \\Delta \\theta}{F} \\right).\n$$\n\n在积水之前，没有地表蓄水；入渗率等于降雨强度，因此到时间 $t$ 的累积入渗量为\n$$\nF(t) = \\int_{0}^{t} i_{0}\\, \\mathrm{d}t = i_{0}\\, t,\n$$\n因为 $i_{0}$ 是恒定的。当降雨强度首次等于入渗能力时，积水开始，即：\n$$\ni_{0} = f(F(t_{p})) = K_{s}\\left( 1 + \\frac{\\Psi_{f}\\, \\Delta \\theta}{F(t_{p})} \\right).\n$$\n求解 $F(t_{p})$，\n$$\n\\frac{i_{0}}{K_{s}} - 1 = \\frac{\\Psi_{f}\\, \\Delta \\theta}{F(t_{p})}\n\\quad \\Longrightarrow \\quad\nF(t_{p}) = \\frac{\\Psi_{f}\\, \\Delta \\theta\\, K_{s}}{i_{0} - K_{s}}.\n$$\n但 $F(t_{p}) = i_{0}\\, t_{p}$，因此积水时间为\n$$\nt_{p} = \\frac{F(t_{p})}{i_{0}} = \\frac{\\Psi_{f}\\, \\Delta \\theta\\, K_{s}}{i_{0}\\,(i_{0} - K_{s})}.\n$$\n\n现在代入给定数据。首先计算含水量增量：\n$$\n\\Delta \\theta = \\theta_{s} - \\theta_{i} = 0.45 - 0.20 = 0.25.\n$$\n计算分子：\n$$\n\\Psi_{f}\\, \\Delta \\theta\\, K_{s} = \\left(0.11\\ \\mathrm{m}\\right)\\left(0.25\\right)\\left(2.0 \\times 10^{-6}\\ \\mathrm{m\\,s^{-1}}\\right) = 5.5 \\times 10^{-8}\\ \\mathrm{m^{2}\\,s^{-1}}.\n$$\n计算分母：\n$$\ni_{0}\\,(i_{0} - K_{s}) = \\left(3.6 \\times 10^{-6}\\ \\mathrm{m\\,s^{-1}}\\right)\\left(3.6 \\times 10^{-6} - 2.0 \\times 10^{-6}\\right)\\ \\mathrm{m\\,s^{-1}} \\\\\n= \\left(3.6 \\times 10^{-6}\\right)\\left(1.6 \\times 10^{-6}\\right)\\ \\mathrm{m^{2}\\,s^{-2}} = 5.76 \\times 10^{-12}\\ \\mathrm{m^{2}\\,s^{-2}}.\n$$\n因此，\n$$\nt_{p} = \\frac{5.5 \\times 10^{-8}}{5.76 \\times 10^{-12}}\\ \\mathrm{s} = 9.548611\\ldots \\times 10^{3}\\ \\mathrm{s}.\n$$\n将秒转换为分钟：\n$$\nt_{p,\\ \\mathrm{min}} = \\frac{9.548611\\ldots \\times 10^{3}}{60}\\ \\mathrm{min} = 1.59143\\ldots \\times 10^{2}\\ \\mathrm{min}.\n$$\n四舍五入到三位有效数字，积水时间为\n$$\nt_{p,\\ \\mathrm{min}} = 1.59 \\times 10^{2}\\ \\mathrm{min}.\n$$",
            "answer": "$$\\boxed{1.59 \\times 10^{2}}$$"
        },
        {
            "introduction": "从单个网格的概念扩展到整个地貌单元是分布式建模的关键一步。本练习将带你从单个点扩展到一个一维的山坡系统，模拟地下水在其中的饱和侧向流。你将应用杜比特-福希海默（Dupuit-Forchheimer）近似，这是一个描述浅层地下水流动的经典理论，来求解稳态地下水位剖面。通过解决这个描述空间连通性的边值问题（BVP），你将体验从单个单元的常微分方程（ODE）到描述空间系统的偏微分方程（在此简化为BVP）的过渡，这是构建和理解真实分布式模型的重要实践。",
            "id": "3874816",
            "problem": "您的任务是使用 Dupuit-Forchheimer (DF) 近似计算一维山坡上的稳态地下水位剖面。从适用于分布式水文模型的基本原理出发：饱和流质量守恒和达西定律。在 DF 近似下，单位宽度的侧向流量由 $q(x) = -K(x)\\,h(x)\\,\\dfrac{dh}{dx}$ 给出，其中 $K(x)$ 是水力传导系数，$h(x)$ 是地下水位高出不透水基底的高度，$x$ 是坡下坐标。质量守恒要求 $\\dfrac{dq}{dx} = R(x)$，其中 $R(x)$ 是补给速率。结合这些陈述，得到稳态的控制性边值问题 (BVP)：\n$$\n\\frac{d}{dx}\\left(K(x)\\,h(x)\\,\\frac{dh}{dx}\\right) = -R(x),\n$$\n其边界条件与山坡情况一致：在上坡分水岭 $x=0$ 处，对称性要求无流量条件 $\\dfrac{dh}{dx}(0)=0$；在坡下出口 $x=L$ 处，地下水位等于指定水位 $h(L)=h_{\\mathrm{out}}$。在 $x\\in[0,L]$ 上，所有物理量必须保持非负且有限。\n\n您的程序必须针对以下 $K(x)$ 和 $R(x)$ 的参数化测试套件，对该 BVP 进行数值求解。对每个测试用例，计算并返回两个量：中点处的地下水位高程 $h(L/2)$（以米 (m) 为单位）和出口单位宽度流量 $q(L)$（以平方米/秒 (m$^2$/s) 为单位），两者均为浮点数。\n\n使用以下科学上真实且内部一致的测试套件。所有距离单位为米 (m)，时间单位为秒 (s)。水力传导系数 $K$ 的单位为米/秒 (m/s)，补给 $R$ 的单位为米/秒 (m/s)，水头 $h$ 的单位为米 (m)。\n\n- 测试用例 1 (恒定水力传导系数和恒定补给)：\n  - $L = 100$ m\n  - $K(x) = K_0$，$K_0 = 1.0 \\times 10^{-5}$ m/s\n  - $R(x) = R_0$，$R_0 = 1.0 \\times 10^{-8}$ m/s\n  - $h_{\\mathrm{out}} = 1.0$ m\n\n- 测试用例 2 (指数变化的水力传导系数和恒定补给)：\n  - $L = 200$ m\n  - $K(x) = K_0 \\exp\\!\\left(\\beta\\,\\frac{x}{L}\\right)$，$K_0 = 5.0 \\times 10^{-6}$ m/s，$\\beta = 2.0$\n  - $R(x) = R_0$，$R_0 = 5.0 \\times 10^{-9}$ m/s\n  - $h_{\\mathrm{out}} = 0.5$ m\n\n- 测试用例 3 (恒定水力传导系数和线性递减的补给)：\n  - $L = 150$ m\n  - $K(x) = K_0$，$K_0 = 1.0 \\times 10^{-5}$ m/s\n  - $R(x) = R_0\\left(1 - \\gamma\\,\\frac{x}{L}\\right)$，$R_0 = 1.0 \\times 10^{-8}$ m/s，$\\gamma = 0.8$\n  - $h_{\\mathrm{out}} = 0.3$ m\n\n- 测试用例 4 (零补给的边界情况)：\n  - $L = 100$ m\n  - $K(x) = K_0$，$K_0 = 1.0 \\times 10^{-5}$ m/s\n  - $R(x) = 0$\n  - $h_{\\mathrm{out}} = 0.7$ m\n\n您的程序必须：\n- 仅使用 DF 近似和质量守恒作为基础来建立 $h(x)$ 的 BVP，不得调用问题陈述中的简化公式。\n- 对每个测试用例，在 $x \\in [0,L]$ 上对 BVP 进行数值求解，确保 $h(x)$ 保持为正，且解满足边界条件。\n- 对每个测试用例，计算 $h(L/2)$（单位：米 (m)）和 $q(L) = -K(L)\\,h(L)\\,\\dfrac{dh}{dx}\\big|_{x=L}$（单位：平方米/秒 (m$^2$/s)）。\n- 输出一行，包含汇总结果，格式为方括号内的逗号分隔列表。列表必须按测试用例排序，每个测试用例先包含 $h(L/2)$ 再包含 $q(L)$，最终格式为：\n$[h_1(L/2),q_1(L),h_2(L/2),q_2(L),h_3(L/2),q_3(L),h_4(L/2),q_4(L)]$。\n\n不允许外部输入；程序必须是自包含的，并按规定格式生成单行输出。数值必须是指定单位的浮点数。",
            "solution": "所呈现的问题陈述具有科学依据、是适定的且内部一致。它描述了一个基于 Dupuit-Forchheimer 近似的经典山坡水文学边值问题。所有参数、边界条件和所需输出都已明确定义。该问题是有效的，并允许严格求解。\n\n求解过程首先从所述基本原理出发，建立控制性常微分方程 (ODE)，然后在给定边界条件下对其进行求解。\n\n基本原理是经 Dupuit-Forchheimer 近似调整后用于计算单位宽度流量 $q(x)$ 的达西定律，以及稳态质量守恒方程：\n$$\nq(x) = -K(x)\\,h(x)\\,\\frac{dh}{dx} \\quad \\text{(Darcy-Forchheimer)}\n$$\n$$\n\\frac{dq}{dx} = R(x) \\quad \\text{(质量守恒)}\n$$\n此处，$h(x)$ 是饱和厚度（地下水位高出不透水基底的高度），$x$ 是从分水岭开始的水平坐标，$K(x)$ 是水力传导系数，$R(x)$ 是净补给速率。\n\n将 $q(x)$ 的表达式代入质量守恒方程，得到关于地下水位高度 $h(x)$ 的控制性二阶非线性边值问题 (BVP)：\n$$\n\\frac{d}{dx}\\left(-K(x)\\,h(x)\\,\\frac{dh}{dx}\\right) = R(x)\n$$\n$$\n\\frac{d}{dx}\\left(K(x)\\,h(x)\\,\\frac{dh}{dx}\\right) = -R(x)\n$$\n此方程需在域 $x \\in [0, L]$ 上求解，并满足以下边界条件：\n1.  上坡分水岭 ($x=0$) 处的无流量条件：$\\dfrac{dh}{dx}(0) = 0$。\n2.  坡下出口 ($x=L$) 处的指定地下水位高度：$h(L) = h_{\\mathrm{out}}$。\n\n为求解此 BVP，我们引入变量替换，定义 $y(x) = \\frac{1}{2}h(x)^2$。$y(x)$ 的导数为 $\\frac{dy}{dx} = h(x)\\frac{dh}{dx}$。将其代入控制性 ODE 可使其线性化：\n$$\n\\frac{d}{dx}\\left(K(x)\\,\\frac{dy}{dx}\\right) = -R(x)\n$$\n边界条件也相应转换：\n1.  $\\dfrac{dh}{dx}(0) = 0 \\implies \\dfrac{dy}{dx}(0) = h(0)\\dfrac{dh}{dx}(0) = 0$。\n2.  $h(L) = h_{\\mathrm{out}} \\implies y(L) = \\frac{1}{2}h_{\\mathrm{out}}^2$。\n\n我们也可以用 $y(x)$ 来表示流量 $q(x)$：\n$$\nq(x) = -K(x)\\,h(x)\\,\\frac{dh}{dx} = -K(x)\\,\\frac{dy}{dx}\n$$\n将质量守恒方程 $\\frac{dq}{dx} = R(x)$ 从分水岭 $x=0$ 处积分到任意位置 $x$：\n$$\n\\int_0^x \\frac{dq}{d\\xi}\\,d\\xi = \\int_0^x R(\\xi)\\,d\\xi\n$$\n$$\nq(x) - q(0) = \\int_0^x R(\\xi)\\,d\\xi\n$$\n无流量边界条件 $\\frac{dh}{dx}(0) = 0$ 意味着 $q(0) = -K(0)h(0)\\frac{dh}{dx}(0) = 0$。因此，任意点 $x$ 处的流量是上坡方向的总补给量：\n$$\nq(x) = \\int_0^x R(\\xi)\\,d\\xi\n$$\n这提供了一种直接计算所需出口流量 $q(L)$ 的方法，即在整个山坡长度 $[0, L]$ 上对补给函数 $R(x)$ 进行积分。对于给定的测试用例，积分 $\\mathcal{R}(x) = \\int_0^x R(\\xi)\\,d\\xi$ 可以解析计算：\n- 用例 1 和 2 ($R(x)=R_0$)：$\\mathcal{R}(x) = R_0 x$\n- 用例 3 ($R(x)=R_0(1-\\gamma x/L)$)：$\\mathcal{R}(x) = R_0(x - \\frac{\\gamma x^2}{2L})$\n- 用例 4 ($R(x)=0$)：$\\mathcal{R}(x) = 0$\n\n现在，我们求解 $h(x)$。根据 $q(x) = -K(x)\\frac{dy}{dx}$ 和 $q(x) = \\mathcal{R}(x)$，我们有：\n$$\n\\frac{dy}{dx} = -\\frac{q(x)}{K(x)}\n$$\n为求得 $y(x)$，我们使用 $x=L$ 处的边界条件，将此表达式从 $x$ 积分到 $L$：\n$$\n\\int_x^L \\frac{dy}{d\\zeta}\\,d\\zeta = \\int_x^L -\\frac{q(\\zeta)}{K(\\zeta)}\\,d\\zeta\n$$\n$$\ny(L) - y(x) = -\\int_x^L \\frac{q(\\zeta)}{K(\\zeta)}\\,d\\zeta\n$$\n代入 $y(x) = \\frac{1}{2}h(x)^2$ 和 $y(L) = \\frac{1}{2}h_{\\mathrm{out}}^2$：\n$$\n\\frac{1}{2}h_{\\mathrm{out}}^2 - \\frac{1}{2}h(x)^2 = -\\int_x^L \\frac{q(\\zeta)}{K(\\zeta)}\\,d\\zeta\n$$\n求解 $h(x)^2$ 可得：\n$$\nh(x)^2 = h_{\\mathrm{out}}^2 + 2\\int_x^L \\frac{q(\\zeta)}{K(\\zeta)}\\,d\\zeta\n$$\n最后，取平方根，并确保满足物理约束 $h(x) \\geq 0$：\n$$\nh(x) = \\sqrt{h_{\\mathrm{out}}^2 + 2\\int_x^L \\frac{\\mathcal{R}(\\zeta)}{K(\\zeta)}\\,d\\zeta}\n$$\n此表达式允许计算任意点处的 $h(x)$。我们需要 $h(L/2)$，可以通过在上述公式中设置 $x=L/2$ 来找到。为保证通用性和稳健性，该积分使用数值积分（具体为 `scipy.integrate.quad`）进行计算。\n\n每个测试用例的计算步骤如下：\n1. 定义水力传导系数 $K(x)$ 和解析积分后的补给 $\\mathcal{R}(x) = q(x)$ 的函数。\n2. 通过计算 $\\mathcal{R}(L)$ 来计算出口流量 $q(L)$。\n3. 定义被积函数 $f(\\zeta) = \\frac{\\mathcal{R}(\\zeta)}{K(\\zeta)}$。\n4. 计算定积分 $I = \\int_{L/2}^L f(\\zeta)\\,d\\zeta$。\n5. 计算中点处的地下水位高度 $h(L/2) = \\sqrt{h_{\\mathrm{out}}^2 + 2I}$。\n6. 存储每个用例的结果 ($h(L/2)$, $q(L)$) 并格式化最终输出。\n此过程在以下程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the Dupuit-Forchheimer BVP for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (constant conductivity and constant recharge)\n        {\n            \"L\": 100.0,\n            \"params\": {\"K0\": 1.0e-5, \"R0\": 1.0e-8},\n            \"h_out\": 1.0,\n            \"case_id\": 1\n        },\n        # Test case 2 (exponentially varying conductivity and constant recharge)\n        {\n            \"L\": 200.0,\n            \"params\": {\"K0\": 5.0e-6, \"R0\": 5.0e-9, \"beta\": 2.0},\n            \"h_out\": 0.5,\n            \"case_id\": 2\n        },\n        # Test case 3 (constant conductivity and linearly decreasing recharge)\n        {\n            \"L\": 150.0,\n            \"params\": {\"K0\": 1.0e-5, \"R0\": 1.0e-8, \"gamma\": 0.8},\n            \"h_out\": 0.3,\n            \"case_id\": 3\n        },\n        # Test case 4 (edge case with zero recharge)\n        {\n            \"L\": 100.0,\n            \"params\": {\"K0\": 1.0e-5, \"R0\": 0.0},\n            \"h_out\": 0.7,\n            \"case_id\": 4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        L = case[\"L\"]\n        h_out = case[\"h_out\"]\n        params = case[\"params\"]\n\n        K_func = None\n        q_analytic_func = None\n\n        if case[\"case_id\"] == 1:\n            K0 = params[\"K0\"]\n            R0 = params[\"R0\"]\n            K_func = lambda x: K0\n            # Analytically integrated recharge: q(x) = integral from 0 to x of R0 d(xi) = R0*x\n            q_analytic_func = lambda x: R0 * x\n        \n        elif case[\"case_id\"] == 2:\n            K0 = params[\"K0\"]\n            R0 = params[\"R0\"]\n            beta = params[\"beta\"]\n            K_func = lambda x: K0 * np.exp(beta * x / L)\n            # Analytically integrated recharge: q(x) = integral from 0 to x of R0 d(xi) = R0*x\n            q_analytic_func = lambda x: R0 * x\n            \n        elif case[\"case_id\"] == 3:\n            K0 = params[\"K0\"]\n            R0 = params[\"R0\"]\n            gamma = params[\"gamma\"]\n            K_func = lambda x: K0\n            # Analytically integrated recharge: q(x) = integral from 0 to x of R0*(1-gamma*xi/L) d(xi)\n            q_analytic_func = lambda x: R0 * (x - (gamma * x**2) / (2 * L))\n\n        elif case[\"case_id\"] == 4:\n            K0 = params[\"K0\"]\n            R0 = params[\"R0\"]\n            K_func = lambda x: K0\n            # q(x) = 0 since R(x) = 0\n            q_analytic_func = lambda x: 0.0\n\n        # Calculate outlet discharge q(L)\n        q_L = q_analytic_func(L)\n        \n        # Calculate h(L/2)\n        # h(x)^2 = h_out^2 + 2 * integral from x to L of (q(zeta)/K(zeta)) d(zeta)\n        # Define the integrand for the h calculation\n        integrand = lambda zeta: q_analytic_func(zeta) / K_func(zeta)\n        \n        # Numerically integrate from L/2 to L\n        integral_val, _ = quad(integrand, L / 2.0, L)\n        \n        # Calculate h(L/2)\n        h_sq_mid = h_out**2 + 2 * integral_val\n        # h must be non-negative. The physics of the problem ensures h_sq_mid >= 0.\n        h_mid = np.sqrt(h_sq_mid)\n        \n        results.append(h_mid)\n        results.append(q_L)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}