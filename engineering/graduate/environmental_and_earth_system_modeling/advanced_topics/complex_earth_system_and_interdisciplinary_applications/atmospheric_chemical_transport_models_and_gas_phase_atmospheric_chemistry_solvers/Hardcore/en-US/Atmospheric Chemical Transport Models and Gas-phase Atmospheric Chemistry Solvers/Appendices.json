{
    "hands_on_practices": [
        {
            "introduction": "To appreciate the unique challenges of atmospheric chemistry, we first explore the concept of \"stiffness.\" This hands-on calculation demonstrates how a simple, reversible reaction can lead to a stiff system of ordinary differential equations, where different processes operate on vastly different timescales. By deriving the analytical solution and analyzing the stability of a basic numerical method, you will discover why specialized implicit solvers are indispensable for accurately and efficiently modeling atmospheric chemical kinetics.",
            "id": "3863627",
            "problem": "Consider a single grid cell of a Chemical Transport Model (CTM) solved by the Method of Lines (MOL) approach, in which vertical and horizontal transport have been turned off for the duration of a stiff chemical interconversion test. Two gas-phase species, denoted by $A$ and $B$, interconvert reversibly via the reactions $A \\to B$ and $B \\to A$ with first-order rate constants $k_{1}$ and $k_{2}$, respectively, assumed constant in time under fixed thermodynamic conditions. Let $[A](t)$ and $[B](t)$ denote the number concentrations in molecules per cubic centimeter as functions of time $t$. Under the law of mass action and assuming a well-mixed box with no sources, sinks, or transport, the governing system of Ordinary Differential Equations (ODEs) is\n$$\n\\frac{d[A]}{dt} \\;=\\; -\\,k_{1}\\,[A] \\;+\\; k_{2}\\,[B], \\qquad\n\\frac{d[B]}{dt} \\;=\\; k_{1}\\,[A] \\;-\\; k_{2}\\,[B].\n$$\nYou are asked to proceed from foundational principles and produce an analytic solution suitable for assessing the accuracy and stiffness handling of explicit and implicit one-step solvers applied to this system. Specifically:\n\n1) Starting from the ODE system above and using only fundamental properties of linear systems, derive closed-form analytic expressions for $[A](t)$ and $[B](t)$ for arbitrary nonnegative initial concentrations $[A](0)=A_{0}$ and $[B](0)=B_{0}$ and arbitrary positive constants $k_{1}$ and $k_{2}$. Your derivation should make explicit use of conservation properties and the eigenstructure of the linear operator governing the dynamics.\n\n2) Using the analytic eigenvalues of the linear system, derive the explicit Euler method’s linear stability condition. From this, determine the maximum stable time step $\\Delta t_{\\max}$ that ensures $|1+\\Delta t\\,\\lambda|<1$ for all eigenvalues $\\lambda$ of the Jacobian of the right-hand side. Then, for the concrete case $k_{1}=500~\\text{s}^{-1}$ and $k_{2}=0.5~\\text{s}^{-1}$, compute the numerical value of $\\Delta t_{\\max}$.\n\nExpress your final numerical time step in seconds and round your answer to four significant figures.",
            "solution": "The problem is first validated to be self-contained, scientifically grounded, and well-posed. The provided system of Ordinary Differential Equations (ODEs) is a standard representation of first-order reversible chemical kinetics. The tasks involve a standard analytical solution procedure using linear algebra and a classical stability analysis of a numerical method, both of which are fundamental topics in applied mathematics and computational science. The problem is valid.\n\n**Part 1: Derivation of the Analytic Solution**\n\nThe governing system of ODEs is:\n$$ \\frac{d[A]}{dt} = -k_{1}[A] + k_{2}[B] $$\n$$ \\frac{d[B]}{dt} = k_{1}[A] - k_{2}[B] $$\nThis can be written in matrix form. Let the concentration vector be $\\mathbf{c}(t) = \\begin{pmatrix} [A](t) \\\\ [B](t) \\end{pmatrix}$. The system is then $\\frac{d\\mathbf{c}}{dt} = \\mathbf{K}\\mathbf{c}$, where $\\mathbf{K}$ is the rate matrix:\n$$ \\mathbf{K} = \\begin{pmatrix} -k_{1} & k_{2} \\\\ k_{1} & -k_{2} \\end{pmatrix} $$\nThe initial condition is $\\mathbf{c}(0) = \\begin{pmatrix} [A](0) \\\\ [B](0) \\end{pmatrix} = \\begin{pmatrix} A_{0} \\\\ B_{0} \\end{pmatrix}$.\n\nA key property of this system is the conservation of total concentration. Summing the two ODEs gives:\n$$ \\frac{d}{dt}([A] + [B]) = (-k_{1}[A] + k_{2}[B]) + (k_{1}[A] - k_{2}[B]) = 0 $$\nIntegrating this equation yields $[A](t) + [B](t) = \\text{constant}$. Using the initial conditions, we find the constant is $A_{0} + B_{0}$. Let $C_{\\text{tot}} = A_{0} + B_{0}$.\n\nTo solve the system using its eigenstructure, we find the eigenvalues and eigenvectors of the matrix $\\mathbf{K}$. The eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(\\mathbf{K} - \\lambda\\mathbf{I}) = 0$:\n$$ \\det\\begin{pmatrix} -k_{1} - \\lambda & k_{2} \\\\ k_{1} & -k_{2} - \\lambda \\end{pmatrix} = 0 $$\n$$ (-k_{1} - \\lambda)(-k_{2} - \\lambda) - (k_{1})(k_{2}) = 0 $$\n$$ \\lambda^{2} + (k_{1} + k_{2})\\lambda + k_{1}k_{2} - k_{1}k_{2} = 0 $$\n$$ \\lambda^{2} + (k_{1} + k_{2})\\lambda = 0 $$\n$$ \\lambda(\\lambda + k_{1} + k_{2}) = 0 $$\nThe eigenvalues are $\\lambda_1 = 0$ and $\\lambda_2 = -(k_{1} + k_{2})$.\n\nNext, we find the corresponding eigenvectors $\\mathbf{v}$ by solving $(\\mathbf{K} - \\lambda\\mathbf{I})\\mathbf{v} = \\mathbf{0}$.\n\nFor $\\lambda_1 = 0$:\n$$ \\begin{pmatrix} -k_{1} & k_{2} \\\\ k_{1} & -k_{2} \\end{pmatrix} \\begin{pmatrix} v_{11} \\\\ v_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\nThis gives the equation $-k_{1}v_{11} + k_{2}v_{12} = 0$, or $v_{12} = \\frac{k_{1}}{k_{2}}v_{11}$. A possible eigenvector is $\\mathbf{v}_1 = \\begin{pmatrix} k_{2} \\\\ k_{1} \\end{pmatrix}$. This eigenvector corresponds to the steady state or equilibrium.\n\nFor $\\lambda_2 = -(k_{1} + k_{2})$:\n$$ \\begin{pmatrix} -k_{1} - (-(k_{1} + k_{2})) & k_{2} \\\\ k_{1} & -k_{2} - (-(k_{1} + k_{2})) \\end{pmatrix} \\begin{pmatrix} v_{21} \\\\ v_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n$$ \\begin{pmatrix} k_{2} & k_{2} \\\\ k_{1} & k_{1} \\end{pmatrix} \\begin{pmatrix} v_{21} \\\\ v_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\nThis gives the equation $k_{2}v_{21} + k_{2}v_{22} = 0$, or $v_{21} = -v_{22}$. A possible eigenvector is $\\mathbf{v}_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$. This eigenvector represents the transient deviation from equilibrium.\n\nThe general solution is a linear combination of the eigenmodes:\n$$ \\mathbf{c}(t) = c_{1}e^{\\lambda_1 t}\\mathbf{v}_1 + c_{2}e^{\\lambda_2 t}\\mathbf{v}_2 = c_{1} \\begin{pmatrix} k_{2} \\\\ k_{1} \\end{pmatrix} + c_{2}e^{-(k_{1}+k_{2})t} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\nWe use the initial conditions at $t=0$ to find the coefficients $c_{1}$ and $c_{2}$:\n$$ \\begin{pmatrix} A_{0} \\\\ B_{0} \\end{pmatrix} = c_{1} \\begin{pmatrix} k_{2} \\\\ k_{1} \\end{pmatrix} + c_{2} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\nThis leads to a system of linear equations for $c_1$ and $c_2$:\n1) $A_{0} = c_{1}k_{2} + c_{2}$\n2) $B_{0} = c_{1}k_{1} - c_{2}$\nAdding the two equations: $A_{0} + B_{0} = c_{1}(k_{1} + k_{2})$, which gives $c_{1} = \\frac{A_{0} + B_{0}}{k_{1} + k_{2}}$.\nSubstituting $c_{1}$ into the first equation: $c_{2} = A_{0} - c_{1}k_{2} = A_{0} - \\frac{(A_{0} + B_{0})k_{2}}{k_{1} + k_{2}} = \\frac{A_{0}(k_{1} + k_{2}) - (A_{0} + B_{0})k_{2}}{k_{1} + k_{2}} = \\frac{A_{0}k_{1} - B_{0}k_{2}}{k_{1} + k_{2}}$.\n\nSubstituting $c_1$ and $c_2$ back into the general solution, we obtain the closed-form analytic expressions for $[A](t)$ and $[B](t)$:\n$$ [A](t) = c_{1}k_{2} + c_{2}e^{-(k_{1}+k_{2})t} = \\left(\\frac{A_{0} + B_{0}}{k_{1} + k_{2}}\\right)k_{2} + \\left(\\frac{A_{0}k_{1} - B_{0}k_{2}}{k_{1} + k_{2}}\\right) e^{-(k_{1}+k_{2})t} $$\n$$ [B](t) = c_{1}k_{1} - c_{2}e^{-(k_{1}+k_{2})t} = \\left(\\frac{A_{0} + B_{0}}{k_{1} + k_{2}}\\right)k_{1} - \\left(\\frac{A_{0}k_{1} - B_{0}k_{2}}{k_{1} + k_{2}}\\right) e^{-(k_{1}+k_{2})t} $$\nThese expressions can be rearranged to show the equilibrium and transient parts more clearly:\n$$ [A](t) = \\frac{k_{2}C_{\\text{tot}}}{k_{1}+k_{2}} + \\left( A_{0} - \\frac{k_{2}C_{\\text{tot}}}{k_{1}+k_{2}} \\right) e^{-(k_{1}+k_{2})t} $$\n$$ [B](t) = \\frac{k_{1}C_{\\text{tot}}}{k_{1}+k_{2}} + \\left( B_{0} - \\frac{k_{1}C_{\\text{tot}}}{k_{1}+k_{2}} \\right) e^{-(k_{1}+k_{2})t} $$\n\n**Part 2: Stability Analysis of the Explicit Euler Method**\n\nThe explicit Euler method applied to the system $\\frac{d\\mathbf{c}}{dt} = \\mathbf{f}(\\mathbf{c})$ is given by $\\mathbf{c}_{n+1} = \\mathbf{c}_{n} + \\Delta t \\mathbf{f}(\\mathbf{c}_{n})$. For our linear system, $\\mathbf{f}(\\mathbf{c}) = \\mathbf{K}\\mathbf{c}$, so the scheme is:\n$$ \\mathbf{c}_{n+1} = \\mathbf{c}_{n} + \\Delta t \\mathbf{K}\\mathbf{c}_{n} = (\\mathbf{I} + \\Delta t \\mathbf{K})\\mathbf{c}_{n} $$\nLinear stability requires that the eigenvalues of the amplification matrix $\\mathbf{G} = \\mathbf{I} + \\Delta t \\mathbf{K}$ do not exceed $1$ in magnitude. The eigenvalues of $\\mathbf{G}$ are given by $1 + \\Delta t \\lambda$, where $\\lambda$ are the eigenvalues of $\\mathbf{K}$. The Jacobian of the right-hand side is simply the matrix $\\mathbf{K}$ itself, as the system is linear.\n\nThe stability condition is $|1 + \\Delta t \\lambda| \\le 1$ for all eigenvalues $\\lambda$ of the Jacobian. The problem specifies a strict inequality, $|1 + \\Delta t \\lambda| < 1$, to ensure errors decay.\nThe eigenvalues of the Jacobian are $\\lambda_1 = 0$ and $\\lambda_2 = -(k_{1} + k_{2})$.\n\nFor $\\lambda_1 = 0$:\nThe condition is $|1 + \\Delta t \\cdot 0| = |1| = 1$. This satisfies the non-strict condition $|1+\\Delta t\\lambda_1|\\le 1$, but not the strict one. However, this mode is associated with the conserved quantity and does not grow or decay, so it does not cause instability for any $\\Delta t > 0$. The stability is governed by the stiffest (most negative) eigenvalue.\n\nFor $\\lambda_2 = -(k_{1} + k_{2})$:\nThe condition is $|1 + \\Delta t (-(k_{1} + k_{2}))| < 1$.\n$$ |1 - \\Delta t (k_{1} + k_{2})| < 1 $$\nThis is equivalent to the inequality:\n$$ -1 < 1 - \\Delta t (k_{1} + k_{2}) < 1 $$\nWe analyze the two parts of the inequality:\n1) $1 - \\Delta t (k_{1} + k_{2}) < 1 \\implies -\\Delta t (k_{1} + k_{2}) < 0$. Since $\\Delta t > 0$ and $k_{1}, k_{2}$ are positive, this is always true.\n2) $-1 < 1 - \\Delta t (k_{1} + k_{2}) \\implies \\Delta t (k_{1} + k_{2}) < 2 \\implies \\Delta t < \\frac{2}{k_{1} + k_{2}}$.\n\nThe stability of the method is thus constrained by the stiffest mode, corresponding to $\\lambda_2$. The maximum stable time step is:\n$$ \\Delta t_{\\max} = \\frac{2}{k_{1} + k_{2}} $$\n\nNow, we compute the numerical value for $k_{1} = 500~\\text{s}^{-1}$ and $k_{2} = 0.5~\\text{s}^{-1}$.\n$$ \\Delta t_{\\max} = \\frac{2}{500~\\text{s}^{-1} + 0.5~\\text{s}^{-1}} = \\frac{2}{500.5}~\\text{s} $$\n$$ \\Delta t_{\\max} \\approx 0.00399600399...~\\text{s} $$\nRounding to four significant figures, we get:\n$$ \\Delta t_{\\max} = 0.003996~\\text{s} $$\nIn scientific notation, this is $3.996 \\times 10^{-3}~\\text{s}$.\nThe severe restriction on the time step is a direct consequence of the stiffness of the system, where the fast timescale $\\tau_{fast} = (k_1+k_2)^{-1} \\approx 1/500.5~\\text{s}$ dictates the stability of the explicit method, even if the user is only interested in the slow evolution towards equilibrium, which occurs on the timescale $\\tau_{slow} \\sim k_2^{-1} = 2~\\text{s}$.",
            "answer": "$$\\boxed{3.996 \\times 10^{-3}}$$"
        },
        {
            "introduction": "Having established the need for stiff solvers, we now turn to a critical component of their implementation: the Jacobian matrix. This matrix quantifies how the rate of change of each chemical species is affected by every other species, revealing the complex web of feedback loops within the chemical system. In this practice, you will derive the Jacobian for the foundational photostationary state mechanism involving ozone and nitrogen oxides, gaining fundamental insight into the structure that governs the stability and dynamics of atmospheric chemistry.",
            "id": "3863642",
            "problem": "Consider a zero-dimensional chemical box model representative of a grid cell in an atmospheric chemical transport model (CTM), focusing on the gas-phase photostationary subsystem involving ozone and nitrogen oxides. Assume constant temperature and pressure over the solver time step, such that the number densities of molecular oxygen and the third body are constant. The chemical mechanism is limited to the following reactions:\n1. $NO + O_{3} \\to NO_{2} + O_{2}$,\n2. $NO_{2} + h\\nu \\to NO + O$,\n3. $O + O_{2} + M \\to O_{3} + M$.\n\nAssume the Law of Mass Action holds for bimolecular and termolecular reactions, and treat the photolysis frequency as constant over the time step. Define the species concentration vector as $\\mathbf{x} = \\big([O_{3}], [NO], [NO_{2}], [O]\\big)$, and let the rate coefficients be $k_{1}$ for the $NO + O_{3}$ reaction, $J$ for the $NO_{2}$ photolysis, and $k_{3}$ for the $O + O_{2} + M$ recombination. The concentrations $[O_{2}]$ and $[M]$ are constants determined by the background atmosphere.\n\nStarting from the fundamental principles of mass conservation and the Law of Mass Action, derive the system of ordinary differential equations for $\\mathbf{x}$ that represent the net chemical production minus loss for each species. Then, compute the Jacobian matrix $\\mathbf{J} = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{x}}$ of the chemical tendency vector $\\mathbf{f}(\\mathbf{x})$, where $\\mathbf{f}(\\mathbf{x})$ is the right-hand side of the ordinary differential equations. Identify the sign pattern of each Jacobian entry in terms of production and loss couplings implied by the mechanism.\n\nProvide, as your final answer, the full $4 \\times 4$ Jacobian matrix written as an analytic expression in terms of $k_{1}$, $J$, $k_{3}$, $[O_{2}]$, $[M]$, $[O_{3}]$, and $[NO]$, ordered according to $\\mathbf{x} = \\big([O_{3}], [NO], [NO_{2}], [O]\\big)$. Express the final answer exactly; do not round. Do not include units in the final answer.",
            "solution": "The problem is first validated against the required criteria.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n-   **Model**: Zero-dimensional chemical box model.\n-   **System**: Gas-phase photostationary subsystem involving ozone ($O_{3}$), nitric oxide ($NO$), nitrogen dioxide ($NO_{2}$), and atomic oxygen ($O$).\n-   **Reactions**:\n    1.  $NO + O_{3} \\to NO_{2} + O_{2}$ with rate coefficient $k_{1}$.\n    2.  $NO_{2} + h\\nu \\to NO + O$ with photolysis frequency $J$.\n    3.  $O + O_{2} + M \\to O_{3} + M$ with rate coefficient $k_{3}$.\n-   **Assumptions**: Law of Mass Action holds; temperature and pressure are constant.\n-   **Constants**: Rate coefficients $k_{1}$ and $k_{3}$; photolysis frequency $J$; number densities $[O_{2}]$ and $[M]$.\n-   **Species Vector**: $\\mathbf{x} = \\big([O_{3}], [NO], [NO_{2}], [O]\\big)$.\n-   **Task**: \n    1. Derive the system of ordinary differential equations (ODEs), $\\frac{d\\mathbf{x}}{dt} = \\mathbf{f}(\\mathbf{x})$.\n    2. Compute the Jacobian matrix $\\mathbf{J} = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{x}}$.\n    3. Provide the full $4 \\times 4$ Jacobian matrix as the final answer.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Groundedness**: The problem describes the core chemical reactions of the photostationary state for tropospheric and stratospheric ozone, a fundamental concept in atmospheric chemistry. The use of the Law of Mass Action is standard for modeling chemical kinetics. The problem is scientifically sound.\n-   **Well-Posedness**: The problem clearly defines the chemical system and asks for the derivation of the governing kinetic equations and their Jacobian. This is a standard and well-defined mathematical task with a unique solution.\n-   **Objectivity**: The problem statement is expressed in precise, unbiased, and standard scientific language.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. We may proceed to the solution.\n\n**Derivation of the Solution**\n\nThe rate of change for the concentration of each species is determined by the sum of the rates of reactions that produce it minus the sum of the rates of reactions that consume it. The rates of the three reactions, based on the Law of Mass Action, are:\n-   Rate of reaction 1: $R_{1} = k_{1} [NO] [O_{3}]$\n-   Rate of reaction 2: $R_{2} = J [NO_{2}]$\n-   Rate of reaction 3: $R_{3} = k_{3} [O] [O_{2}] [M]$\n\nUsing these rate expressions, we can write the system of ordinary differential equations (ODEs) for the net rate of change of each species in the vector $\\mathbf{x} = \\big([O_{3}], [NO], [NO_{2}], [O]\\big)$.\n\n1.  **For $[O_{3}]$**: Ozone is produced in reaction 3 and consumed in reaction 1.\n    $$ \\frac{d[O_{3}]}{dt} = R_{3} - R_{1} = k_{3} [O] [O_{2}] [M] - k_{1} [NO] [O_{3}] $$\n\n2.  **For $[NO]$**: Nitric oxide is produced in reaction 2 and consumed in reaction 1.\n    $$ \\frac{d[NO]}{dt} = R_{2} - R_{1} = J [NO_{2}] - k_{1} [NO] [O_{3}] $$\n\n3.  **For $[NO_{2}]$**: Nitrogen dioxide is produced in reaction 1 and consumed in reaction 2.\n    $$ \\frac{d[NO_{2}]}{dt} = R_{1} - R_{2} = k_{1} [NO] [O_{3}] - J [NO_{2}] $$\n\n4.  **For $[O]$**: Atomic oxygen is produced in reaction 2 and consumed in reaction 3.\n    $$ \\frac{d[O]}{dt} = R_{2} - R_{3} = J [NO_{2}] - k_{3} [O] [O_{2}] [M] $$\n\nThis system of ODEs defines the chemical tendency vector $\\mathbf{f}(\\mathbf{x}) = \\frac{d\\mathbf{x}}{dt}$. Let $x_{1}=[O_{3}]$, $x_{2}=[NO]$, $x_{3}=[NO_{2}]$, and $x_{4}=[O]$. The components of $\\mathbf{f}(\\mathbf{x})$ are:\n$$\nf_{1}(\\mathbf{x}) = k_{3} x_{4} [O_{2}] [M] - k_{1} x_{2} x_{1} \\\\\nf_{2}(\\mathbf{x}) = J x_{3} - k_{1} x_{2} x_{1} \\\\\nf_{3}(\\mathbf{x}) = k_{1} x_{2} x_{1} - J x_{3} \\\\\nf_{4}(\\mathbf{x}) = J x_{3} - k_{3} x_{4} [O_{2}] [M]\n$$\n\nThe Jacobian matrix $\\mathbf{J}$ is a $4 \\times 4$ matrix where each element $J_{ij}$ is the partial derivative of the $i$-th rate function with respect to the $j$-th species concentration, $J_{ij} = \\frac{\\partial f_{i}}{\\partial x_{j}}$. We compute these partial derivatives.\n\n**Row 1 of $\\mathbf{J}$ (Derivatives of $f_{1}$):**\n-   $J_{11} = \\frac{\\partial f_{1}}{\\partial [O_{3}]} = \\frac{\\partial}{\\partial x_{1}}(k_{3} x_{4} [O_{2}] [M] - k_{1} x_{2} x_{1}) = -k_{1} x_{2} = -k_{1} [NO]$\n-   $J_{12} = \\frac{\\partial f_{1}}{\\partial [NO]} = \\frac{\\partial}{\\partial x_{2}}(k_{3} x_{4} [O_{2}] [M] - k_{1} x_{2} x_{1}) = -k_{1} x_{1} = -k_{1} [O_{3}]$\n-   $J_{13} = \\frac{\\partial f_{1}}{\\partial [NO_{2}]} = \\frac{\\partial}{\\partial x_{3}}(k_{3} x_{4} [O_{2}] [M] - k_{1} x_{2} x_{1}) = 0$\n-   $J_{14} = \\frac{\\partial f_{1}}{\\partial [O]} = \\frac{\\partial}{\\partial x_{4}}(k_{3} x_{4} [O_{2}] [M] - k_{1} x_{2} x_{1}) = k_{3} [O_{2}] [M]$\n\n**Row 2 of $\\mathbf{J}$ (Derivatives of $f_{2}$):**\n-   $J_{21} = \\frac{\\partial f_{2}}{\\partial [O_{3}]} = \\frac{\\partial}{\\partial x_{1}}(J x_{3} - k_{1} x_{2} x_{1}) = -k_{1} x_{2} = -k_{1} [NO]$\n-   $J_{22} = \\frac{\\partial f_{2}}{\\partial [NO]} = \\frac{\\partial}{\\partial x_{2}}(J x_{3} - k_{1} x_{2} x_{1}) = -k_{1} x_{1} = -k_{1} [O_{3}]$\n-   $J_{23} = \\frac{\\partial f_{2}}{\\partial [NO_{2}]} = \\frac{\\partial}{\\partial x_{3}}(J x_{3} - k_{1} x_{2} x_{1}) = J$\n-   $J_{24} = \\frac{\\partial f_{2}}{\\partial [O]} = \\frac{\\partial}{\\partial x_{4}}(J x_{3} - k_{1} x_{2} x_{1}) = 0$\n\n**Row 3 of $\\mathbf{J}$ (Derivatives of $f_{3}$):**\n-   $J_{31} = \\frac{\\partial f_{3}}{\\partial [O_{3}]} = \\frac{\\partial}{\\partial x_{1}}(k_{1} x_{2} x_{1} - J x_{3}) = k_{1} x_{2} = k_{1} [NO]$\n-   $J_{32} = \\frac{\\partial f_{3}}{\\partial [NO]} = \\frac{\\partial}{\\partial x_{2}}(k_{1} x_{2} x_{1} - J x_{3}) = k_{1} x_{1} = k_{1} [O_{3}]$\n-   $J_{33} = \\frac{\\partial f_{3}}{\\partial [NO_{2}]} = \\frac{\\partial}{\\partial x_{3}}(k_{1} x_{2} x_{1} - J x_{3}) = -J$\n-   $J_{34} = \\frac{\\partial f_{3}}{\\partial [O]} = \\frac{\\partial}{\\partial x_{4}}(k_{1} x_{2} x_{1} - J x_{3}) = 0$\n\n**Row 4 of $\\mathbf{J}$ (Derivatives of $f_{4}$):**\n-   $J_{41} = \\frac{\\partial f_{4}}{\\partial [O_{3}]} = \\frac{\\partial}{\\partial x_{1}}(J x_{3} - k_{3} x_{4} [O_{2}] [M]) = 0$\n-   $J_{42} = \\frac{\\partial f_{4}}{\\partial [NO]} = \\frac{\\partial}{\\partial x_{2}}(J x_{3} - k_{3} x_{4} [O_{2}] [M]) = 0$\n-   $J_{43} = \\frac{\\partial f_{4}}{\\partial [NO_{2}]} = \\frac{\\partial}{\\partial x_{3}}(J x_{3} - k_{3} x_{4} [O_{2}] [M]) = J$\n-   $J_{44} = \\frac{\\partial f_{4}}{\\partial [O]} = \\frac{\\partial}{\\partial x_{4}}(J x_{3} - k_{3} x_{4} [O_{2}] [M]) = -k_{3} [O_{2}] [M]$\n\nThe diagonal elements of the Jacobian, $J_{ii}$, represent the feedback of a species on its own rate of change. All diagonal elements are negative, indicating that an increase in any species' concentration enhances its own net destruction rate. This is characteristic of a stable chemical system and is a crucial property for the stability of numerical solvers used in CTMs. The off-diagonal elements, $J_{ij}$ for $i \\neq j$, represent the chemical coupling between species. A positive $J_{ij}$ means species $j$ produces species $i$, while a negative value means species $j$ consumes species $i$. For example, $J_{14} = k_{3}[O_{2}][M] > 0$ shows that an increase in atomic oxygen, $[O]$, leads to an increase in the production rate of ozone, $[O_{3}]$. Conversely, $J_{12} = -k_{1}[O_{3}] < 0$ shows that an increase in nitric oxide, $[NO]$, increases the loss rate of ozone.\n\nAssembling the elements gives the final Jacobian matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-k_{1} [NO] & -k_{1} [O_{3}] & 0 & k_{3} [O_{2}] [M] \\\\\n-k_{1} [NO] & -k_{1} [O_{3}] & J & 0 \\\\\nk_{1} [NO] & k_{1} [O_{3}] & -J & 0 \\\\\n0 & 0 & J & -k_{3} [O_{2}] [M]\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Finally, we place the chemical solver into the larger context of an atmospheric chemical transport model (CTM), where chemical transformations occur simultaneously with physical transport processes like advection. CTMs typically handle this complexity using \"operator splitting,\" which solves the chemistry and transport steps separately over small time increments. This exercise delves into the accuracy of a widely used second-order technique known as Strang splitting, allowing you to analytically quantify the error introduced by this essential numerical approximation.",
            "id": "3863578",
            "problem": "Consider the one-dimensional ($1$-D) advection–reaction partial differential equation (PDE)\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)\\,c,\n$$\non a periodic domain $x \\in [0,1)$ with constant advection velocity $u$ and spatially varying first-order loss rate $k(x)$. The initial condition is $c(x,0)=c_0(x)$. Let $c_{\\mathrm{unsplit}}(x,\\Delta t)$ denote the exact solution obtained by integrating the coupled advection–reaction system without operator splitting over a single time step $\\Delta t$, and $c_{\\mathrm{Strang}}(x,\\Delta t)$ denote the Strang-split approximation over the same time step using the canonical composition “half reaction, full advection, half reaction.” The computational gas-phase chemistry context is linear here, with the reaction treated as a local ordinary differential equation (ODE) $c'=-k(x)\\,c$ and advection as a pure translation by the velocity $u$. Assume periodic boundary conditions and smooth $k(x)$ and $c_0(x)$.\n\nStarting only from:\n- the method of characteristics for linear advection,\n- the local-in-space solution of the linear ODE $c'=-k(x)\\,c$ at fixed $x$,\n- the definition of Strang splitting (second-order composition of sub-operators: reaction–advection–reaction with time fractions $\\Delta t/2$, $\\Delta t$, $\\Delta t/2$),\nderive an explicit, closed-form expression for $c_{\\mathrm{unsplit}}(x,\\Delta t)$ and for $c_{\\mathrm{Strang}}(x,\\Delta t)$ in terms of $c_0$, $k$, $u$, $x$, and $\\Delta t$ on the periodic domain, without invoking any shortcut formulas. Then, using these expressions, quantify the pointwise difference $|c_{\\mathrm{Strang}}(x,\\Delta t)-c_{\\mathrm{unsplit}}(x,\\Delta t)|$ and show that the local-in-time error scales as $O(\\Delta t^3)$ for smooth $k(x)$, by connecting the Strang composition to the trapezoidal approximation of a time integral along characteristics.\n\nYou must implement a program that evaluates this single-step local error over a uniform grid in $x$ for the following specific, smooth and periodic choices:\n- Domain: $x \\in [0,1)$, periodic.\n- Initial condition: $c_0(x)=1 + 0.5 \\sin(2\\pi x) + 0.25 \\cos(4\\pi x)$.\n- Spatially varying loss rate: $k(x)=k_0 + k_1 \\sin(2\\pi x)$.\n- Advection velocity: $u$ is a constant.\n\nYour program must:\n- Use a high-resolution uniform grid in $x$ to approximate the supremum norm of the local error $e(\\Delta t)=\\|c_{\\mathrm{Strang}}(\\cdot,\\Delta t)-c_{\\mathrm{unsplit}}(\\cdot,\\Delta t)\\|_{\\infty}$ over one time step.\n- For each test, report the normalized quantity $e(\\Delta t)/\\Delta t^3$ as a floating-point number.\n\nImplement closed-form evaluations of both $c_{\\mathrm{unsplit}}$ and $c_{\\mathrm{Strang}}$ using only the fundamental derivations outlined above. Do not use any numerical time integration; only evaluate the derived formulas. Handle periodicity analytically through the periodic trigonometric definitions.\n\nTest suite. Run five tests that cover a general case, refinement for scaling, and edge cases:\n- Test $1$: $\\Delta t=0.2$, $u=0.7$, $k_0=1.0$, $k_1=0.5$.\n- Test $2$: $\\Delta t=0.1$, $u=0.7$, $k_0=1.0$, $k_1=0.5$.\n- Test $3$: $\\Delta t=0.05$, $u=0.7$, $k_0=1.0$, $k_1=0.5$.\n- Test $4$ (edge, commuting operators): $\\Delta t=0.2$, $u=0.7$, $k_0=1.0$, $k_1=0.0$.\n- Test $5$ (edge, no advection): $\\Delta t=0.2$, $u=0.0$, $k_0=1.0$, $k_1=0.5$.\n\nAll quantities are dimensionless. For each test, compute $e(\\Delta t)/\\Delta t^3$ using a sufficiently fine grid in $x$ so that the reported values reflect the theoretical $\\Delta t^3$ scaling. Round each reported value to $10$ significant digits.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the tests above. For example, it should look like\n$[r_1,r_2,r_3,r_4,r_5]$\nwhere each $r_i$ is the rounded floating-point value for the corresponding test.",
            "solution": "The user wants to validate and solve a problem concerning the error analysis of Strang splitting for a one-dimensional advection-reaction partial differential equation (PDE).\n\n### Step 1: Extract Givens\n\n- **PDE:** $\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)\\,c$\n- **Domain:** $x \\in [0,1)$, periodic.\n- **Initial Condition:** $c(x,0) = c_0(x)$.\n- **Advection Velocity:** $u$ is a constant.\n- **Reaction Rate:** $k(x)$ is a spatially varying first-order loss rate.\n- **Exact Solution:** $c_{\\mathrm{unsplit}}(x,\\Delta t)$ is the exact solution over one time step $\\Delta t$.\n- **Approximate Solution:** $c_{\\mathrm{Strang}}(x,\\Delta t)$ is the Strang-split approximation over $\\Delta t$, using the composition: half reaction ($\\Delta t/2$), full advection ($\\Delta t$), half reaction ($\\Delta t/2$).\n- **Sub-problems:** The reaction is a local ODE $c'=-k(x)\\,c$, and advection is a pure translation.\n- **Task 1 (Derivation):** Derive explicit, closed-form expressions for $c_{\\mathrm{unsplit}}(x,\\Delta t)$ and $c_{\\mathrm{Strang}}(x,\\Delta t)$.\n- **Task 2 (Error Analysis):** Using the derived expressions, show that the local-in-time pointwise error $|c_{\\mathrm{Strang}}(x,\\Delta t)-c_{\\mathrm{unsplit}}(x,\\Delta t)|$ is $O(\\Delta t^3)$ for smooth $k(x)$ by connecting the approximation to the trapezoidal rule.\n- **Task 3 (Implementation):** Implement a program to compute the normalized supremum norm of the local error, $e(\\Delta t)/\\Delta t^3 = \\|c_{\\mathrm{Strang}}(\\cdot,\\Delta t)-c_{\\mathrm{unsplit}}(\\cdot,\\Delta t)\\|_{\\infty} / \\Delta t^3$.\n- **Specific Functions:**\n    - $c_0(x)=1 + 0.5 \\sin(2\\pi x) + 0.25 \\cos(4\\pi x)$\n    - $k(x)=k_0 + k_1 \\sin(2\\pi x)$\n- **Test Suite:**\n    - Test 1: $\\Delta t=0.2$, $u=0.7$, $k_0=1.0$, $k_1=0.5$.\n    - Test 2: $\\Delta t=0.1$, $u=0.7$, $k_0=1.0$, $k_1=0.5$.\n    - Test 3: $\\Delta t=0.05$, $u=0.7$, $k_0=1.0$, $k_1=0.5$.\n    - Test 4: $\\Delta t=0.2$, $u=0.7$, $k_0=1.0$, $k_1=0.0$.\n    - Test 5: $\\Delta t=0.2$, $u=0.0$, $k_0=1.0$, $k_1=0.5$.\n- **Output Format:** A comma-separated list of the 5 test results, rounded to $10$ significant digits, enclosed in square brackets.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded:** The problem is a standard exercise in the numerical analysis of PDEs, specifically focusing on operator splitting methods (Strang splitting), which are widely used in computational physics and chemistry. The advection-reaction equation is a fundamental model in transport phenomena. All concepts are well-established in mathematics and computational science.\n- **Well-Posed:** The problem is well-posed. The PDE with a given smooth initial condition and periodic boundary conditions has a unique, stable solution. The task is to derive and compare this exact solution to a standard numerical approximation. The parameters are fully specified.\n- **Objective:** The problem is stated using precise mathematical and computational language. There are no subjective or ambiguous terms.\n- **Completeness:** The problem is self-contained and provides all necessary information (equations, definitions, parameters, and specific functions) to perform the derivation and implementation.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-defined task in computational science that requires both analytical derivation and numerical implementation. I will now proceed with the solution.\n\n### Derivation and Analysis\n\nThe governing PDE is a linear, first-order advection-reaction equation:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)c\n$$\nWe are asked to find the exact solution and the Strang-split approximation over a single time step $\\Delta t$.\n\n#### 1. Exact Unsplit Solution, $c_{\\mathrm{unsplit}}(x, \\Delta t)$\n\nWe use the method of characteristics. The characteristic curves $x(t)$ are defined by the advection velocity:\n$$\n\\frac{dx}{dt} = u\n$$\nIntegrating this gives the characteristic lines $x(t) = x_{\\text{start}} + ut$. A point $x$ at time $t$ originated from the position $x_{\\text{start}} = x - ut$.\n\nAlong a characteristic, the total derivative of $c(x(t), t)$ with respect to time is:\n$$\n\\frac{dc}{dt} = \\frac{\\partial c}{\\partial t} + \\frac{dx}{dt}\\frac{\\partial c}{\\partial x} = \\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x}\n$$\nSubstituting this into the PDE, we obtain an ordinary differential equation (ODE) for $c$ along the characteristic:\n$$\n\\frac{dc}{dt} = -k(x(t))c\n$$\nTo find the solution at a point $(x, \\Delta t)$, we consider the characteristic that passes through this point. This characteristic originated at position $x_0 = x - u\\Delta t$ at time $t=0$. The initial value for the ODE is $c(0) = c(x_0, 0) = c_0(x_0)$.\n\nThe equation along the characteristic is $\\frac{dc}{dt} = -k(x_0+ut)c$. Integrating this ODE from $t=0$ to $t=\\Delta t$ gives:\n$$\nc(x, \\Delta t) = c_0(x_0) \\exp\\left( -\\int_0^{\\Delta t} k(x_0 + u\\tau) d\\tau \\right)\n$$\nSubstituting $x_0 = x - u\\Delta t$, we get:\n$$\nc(x, \\Delta t) = c_0(x - u\\Delta t) \\exp\\left( -\\int_0^{\\Delta t} k(x - u\\Delta t + u\\tau) d\\tau \\right)\n$$\nTo simplify the integral, we perform a change of variable. Let $s = x - u\\Delta t + u\\tau$. Then $ds = u d\\tau$, and the integration limits for $s$ are from $x - u\\Delta t$ (at $\\tau=0$) to $x$ (at $\\tau=\\Delta t$).\nAssuming $u \\neq 0$, the integral becomes:\n$$\n\\int_{x-u\\Delta t}^{x} k(s) \\frac{ds}{u} = \\frac{1}{u} \\int_{x-u\\Delta t}^{x} k(s) ds\n$$\nThus, the exact solution is:\n$$\nc_{\\mathrm{unsplit}}(x, \\Delta t) = c_0(x - u\\Delta t) \\exp\\left( -\\frac{1}{u} \\int_{x-u\\Delta t}^{x} k(s) ds \\right) \\quad (\\text{for } u \\neq 0)\n$$\nFor the special case $u=0$, the PDE simplifies to $\\frac{\\partial c}{\\partial t} = -k(x)c$. For each fixed $x$, this is a simple ODE with solution $c(x, t) = c(x,0) \\exp(-k(x)t)$. Therefore:\n$$\nc_{\\mathrm{unsplit}}(x, \\Delta t) = c_0(x) \\exp(-k(x)\\Delta t) \\quad (\\text{for } u = 0)\n$$\n\n#### 2. Strang Splitting Solution, $c_{\\mathrm{Strang}}(x, \\Delta t)$\n\nStrang splitting approximates the solution by sequentially applying the operators for reaction and advection. The sequence is: half a step of reaction, a full step of advection, and another half a step of reaction.\n\n**Step 1: First half reaction step ($\\Delta t/2$):**\nSolve $\\frac{\\partial c}{\\partial t} = -k(x)c$ for a duration $\\Delta t/2$ starting from $c_0(x)$.\n$$ c_1(x) = c_0(x) \\exp\\left(-k(x) \\frac{\\Delta t}{2}\\right) $$\n\n**Step 2: Full advection step ($\\Delta t$):**\nSolve $\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0$ for a duration $\\Delta t$ starting from $c_1(x)$. This is pure advection, which translates the solution profile.\n$$ c_2(x) = c_1(x - u\\Delta t) = c_0(x - u\\Delta t) \\exp\\left(-k(x - u\\Delta t) \\frac{\\Delta t}{2}\\right) $$\n\n**Step 3: Second half reaction step ($\\Delta t/2$):**\nSolve $\\frac{\\partial c}{\\partial t} = -k(x)c$ for a duration $\\Delta t/2$ starting from $c_2(x)$.\n$$ c_{\\mathrm{Strang}}(x, \\Delta t) = c_2(x) \\exp\\left(-k(x) \\frac{\\Delta t}{2}\\right) $$\nSubstituting the expression for $c_2(x)$:\n$$ c_{\\mathrm{Strang}}(x, \\Delta t) = \\left[ c_0(x - u\\Delta t) \\exp\\left(-k(x - u\\Delta t) \\frac{\\Delta t}{2}\\right) \\right] \\exp\\left(-k(x) \\frac{\\Delta t}{2}\\right) $$\nCombining the exponential terms, we arrive at the closed-form expression for the Strang-split solution:\n$$\nc_{\\mathrm{Strang}}(x, \\Delta t) = c_0(x - u\\Delta t) \\exp\\left( -\\frac{\\Delta t}{2} \\left[k(x) + k(x - u\\Delta t)\\right] \\right)\n$$\nNote that if $u=0$, this correctly reduces to $c_0(x)\\exp(-k(x)\\Delta t)$, which matches the exact solution for the no-advection case.\n\n#### 3. Error Analysis and Connection to Trapezoidal Rule\n\nWe now analyze the local pointwise error $|c_{\\mathrm{Strang}}(x,\\Delta t) - c_{\\mathrm{unsplit}}(x,\\Delta t)|$. Both expressions share the pre-factor $c_0(x-u\\Delta t)$. The difference arises from the arguments of the exponential terms.\n\nFor the exact solution, the argument is $-I_{\\mathrm{exact}} = -\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds$.\nFor the Strang-split solution, the argument is $-I_{\\mathrm{Strang}} = -\\frac{\\Delta t}{2} [k(x) + k(x-u\\Delta t)]$.\n\nLet's examine the term $I_{\\mathrm{Strang}}$. It can be rewritten as:\n$$\nI_{\\mathrm{Strang}} = \\frac{x - (x-u\\Delta t)}{u} \\frac{k(x) + k(x-u\\Delta t)}{2}\n$$\nThis is precisely the trapezoidal rule approximation for the integral $\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds$. The error of the trapezoidal rule for an integral $\\int_a^b f(s)ds$ is given by $-\\frac{(b-a)^3}{12}f''(\\xi)$ for some $\\xi \\in [a,b]$.\n\nApplying this to our integral term $I_{\\mathrm{exact}}$ (with $f(s)=k(s)$, $b=x$, $a=x-u\\Delta t$), we get:\n$$\n\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds = \\frac{\\Delta t}{2} [k(x) + k(x-u\\Delta t)] - \\frac{1}{u} \\frac{(u\\Delta t)^3}{12} k''(\\xi)\n$$\nfor some $\\xi \\in [x-u\\Delta t, x]$. Thus,\n$$\nI_{\\mathrm{exact}} = I_{\\mathrm{Strang}} - \\frac{u^2 \\Delta t^3}{12} k''(\\xi)\n$$\nThe difference between the solutions is:\n$$\nc_{\\mathrm{Strang}} - c_{\\mathrm{unsplit}} = c_0(x-u\\Delta t) \\left[ \\exp(-I_{\\mathrm{Strang}}) - \\exp(-I_{\\mathrm{exact}}) \\right]\n$$\n$$\n= c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\left[ 1 - \\exp(I_{\\mathrm{Strang}} - I_{\\mathrm{exact}}) \\right]\n$$\n$$\n= c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\left[ 1 - \\exp\\left(\\frac{u^2 \\Delta t^3}{12} k''(\\xi)\\right) \\right]\n$$\nFor small $\\Delta t$, the argument of the inner exponential is small. Using the Taylor expansion $\\exp(z) \\approx 1+z$ for small $z$:\n$$\nc_{\\mathrm{Strang}} - c_{\\mathrm{unsplit}} \\approx c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\left[ 1 - \\left(1 + \\frac{u^2 \\Delta t^3}{12} k''(\\xi)\\right) \\right]\n$$\n$$\n= -c_0(x-u\\Delta t) \\exp(-I_{\\mathrm{Strang}}) \\frac{u^2 \\Delta t^3}{12} k''(\\xi)\n$$\nAs $\\Delta t \\to 0$, $I_{\\mathrm{Strang}} \\to 0$ and $\\xi \\to x$. The leading term of the error becomes:\n$$\nc_{\\mathrm{Strang}}(x, \\Delta t) - c_{\\mathrm{unsplit}}(x, \\Delta t) = -c_0(x) \\frac{u^2 k''(x)}{12} \\Delta t^3 + O(\\Delta t^4)\n$$\nThis shows that the local pointwise error is of order $O(\\Delta t^3)$, provided that $k(x)$ is at least twice differentiable, which is true for the given smooth, periodic function $k(x)$.\n\n#### 4. Explicit Formulas for Implementation\n\nFor the given $k(x) = k_0 + k_1 \\sin(2\\pi x)$, we need the definite integral for the exact solution. The antiderivative is:\n$$\nK(s) = \\int k(s) ds = \\int (k_0 + k_1 \\sin(2\\pi s)) ds = k_0 s - \\frac{k_1}{2\\pi} \\cos(2\\pi s)\n$$\nThe integral term in the exponent of $c_{\\mathrm{unsplit}}$ is:\n$$\n\\frac{1}{u}\\int_{x-u\\Delta t}^{x} k(s) ds = \\frac{1}{u}[K(x) - K(x-u\\Delta t)] = k_0 \\Delta t - \\frac{k_1}{2\\pi u} [\\cos(2\\pi x) - \\cos(2\\pi(x-u\\Delta t))]\n$$\nSo the argument of the exponential in $c_{\\mathrm{unsplit}}$ for $u \\neq 0$ is:\n$$\n\\arg_{\\mathrm{unsplit}} = -k_0 \\Delta t + \\frac{k_1}{2\\pi u} [\\cos(2\\pi x) - \\cos(2\\pi(x-u\\Delta t))]\n$$\n\nThe argument for $c_{\\mathrm{Strang}}$ using the given $k(x)$ is:\n$$\n\\arg_{\\mathrm{Strang}} = -\\frac{\\Delta t}{2} [ (k_0+k_1\\sin(2\\pi x)) + (k_0+k_1\\sin(2\\pi(x-u\\Delta t))) ]\n$$\n$$\n= -\\Delta t \\left( k_0 + \\frac{k_1}{2} [\\sin(2\\pi x) + \\sin(2\\pi(x-u\\Delta t))] \\right)\n$$\nThese explicit formulas will be used in the implementation.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the normalized local error of Strang splitting for an\n    advection-reaction equation over one time step.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (dt, u, k0, k1)\n        (0.2, 0.7, 1.0, 0.5),\n        (0.1, 0.7, 1.0, 0.5),\n        (0.05, 0.7, 1.0, 0.5),\n        (0.2, 0.7, 1.0, 0.0),\n        (0.2, 0.0, 1.0, 0.5),\n    ]\n\n    results = []\n    \n    # Use a high-resolution grid to minimize spatial discretization error.\n    # N=2**14 = 16384\n    N = 16384\n    x = np.linspace(0, 1, N, endpoint=False)\n\n    # Define initial condition and reaction rate functions.\n    # The functions are vectorized for numpy arrays.\n    def c0_func(x_val):\n        return 1.0 + 0.5 * np.sin(2 * np.pi * x_val) + 0.25 * np.cos(4 * np.pi * x_val)\n\n    def k_func(x_val, k0, k1):\n        return k0 + k1 * np.sin(2 * np.pi * x_val)\n\n    for dt, u, k0, k1 in test_cases:\n        # Characteristic departure point. Periodicity is handled by trigonometric functions.\n        x_prime = x - u * dt\n        \n        # Evaluate initial condition at departure points.\n        c0_at_x_prime = c0_func(x_prime)\n        \n        # --- Calculate Strang Splitting Solution ---\n        # Evaluate k at current and departure points.\n        k_at_x = k_func(x, k0, k1)\n        k_at_x_prime = k_func(x_prime, k0, k1)\n        \n        # Argument of the exponent for the Strang solution\n        exp_arg_strang = -0.5 * dt * (k_at_x + k_at_x_prime)\n        c_strang = c0_at_x_prime * np.exp(exp_arg_strang)\n\n        # --- Calculate Exact Unsplit Solution ---\n        if u == 0.0:\n            # Handle the no-advection case (u=0) separately.\n            # Here, the solution is purely local reaction.\n            c0_at_x = c0_func(x)\n            exp_arg_unsplit = -k_at_x * dt\n            c_unsplit = c0_at_x * np.exp(exp_arg_unsplit)\n        else:\n            # Handle the general advection-reaction case (u!=0).\n            # Use the derived formula for the integrated exponent.\n            cos_term = np.cos(2 * np.pi * x) - np.cos(2 * np.pi * x_prime)\n            exp_arg_unsplit = -k0 * dt + (k1 / (2 * np.pi * u)) * cos_term\n            c_unsplit = c0_at_x_prime * np.exp(exp_arg_unsplit)\n            \n        # --- Calculate Normalized Error ---\n        # Supremum norm of the pointwise difference\n        sup_norm_error = np.max(np.abs(c_strang - c_unsplit))\n        \n        # Normalize by dt^3 to observe O(dt^3) scaling\n        # For commuting cases (Test 4 & 5), the error is theoretically zero.\n        if dt == 0.0:\n            norm_error = 0.0\n        else:\n            norm_error = sup_norm_error / (dt**3)\n            \n        # Round the result to 10 significant digits as specified.\n        # The formatting string \"{:.10g}\" handles significant figures correctly.\n        # It's converted back to a float for the final list.\n        rounded_result = float(f\"{norm_error:.10g}\")\n        results.append(rounded_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}