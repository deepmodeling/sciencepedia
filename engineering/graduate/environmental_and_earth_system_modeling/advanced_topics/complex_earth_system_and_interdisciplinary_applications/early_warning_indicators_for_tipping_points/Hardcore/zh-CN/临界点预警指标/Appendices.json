{
    "hands_on_practices": [
        {
            "introduction": "理论是实践的基石。为了深入理解临界点预警指标的根源，我们首先从最典型的动态系统模型——鞍结分岔（saddle-node bifurcation）的正规形式（normal form）入手。这个练习将引导你通过基础的线性稳定性分析，揭示系统在接近临界点时“临界慢化”（critical slowing down）这一核心现象的内在机制，并从数学上推导出它如何直接导致可观测的预警信号，如自相关性的增加。通过解决这个问题 ()，你将清晰地看到系统恢复率的衰减与一阶自相关函数 $ \\rho(\\Delta t) $ 的上升之间的直接联系。",
            "id": "3876409",
            "problem": "考虑应用于环境临界点模型的动力系统理论中的典型鞍结（折叠）范式，\n$$\\frac{dx}{dt}=\\mu - x^{2},$$\n其中 $x$ 是一个标量系统状态，$\\mu$ 是一个代表外部强迫的缓慢变化的控制参数。当地球系统组成部分中的一个稳定态因参数变化而消失时，这个一维确定性系统被广泛用作突变的原型。\n\n(a) 使用基本的线性稳定性分析，找出该确定性系统的所有平衡点（作为 $\\mu$ 的函数）并确定它们的稳定性。\n\n(b) 假设由于外部强迫，$\\mu(t)$ 随时间缓慢单调变化，$\\mu(t)=\\mu_{0}-\\varepsilon t$，其中 $\\mu_{0}>0$ 且 $0  \\varepsilon \\ll 1$ 是一个小的斜坡速率。从 $t\\ll 0$ 时的稳定平衡点开始，从第一性原理出发，解释当 $\\mu(t)$ 经过 $0$ 时为何会出现类似滞后的稳定性延迟丧失（动态分岔延迟），以及这为何与环境和地球系统建模中的预警指标相关。\n\n(c) 为了与预警指标联系起来，引入弱环境噪声并考虑随机微分方程（SDE）\n$$dx=\\left(\\mu - x^{2}\\right)dt+\\sigma\\,dW_{t},$$\n其中 $\\sigma>0$ 是噪声振幅，$W_{t}$ 是一个标准的维纳过程（布朗运动），因此 $dW_{t}$ 代表具有独立平稳增量的高斯白噪声。对于固定的 $\\mu>0$，围绕稳定平衡点 $x^{\\star}(\\mu)$ 线性化此SDE，并求得涨落的平稳滞后-$\\Delta t$ 自相关，其定义为\n$$\\rho(\\Delta t)=\\frac{\\mathbb{E}\\left[(x(t)-\\mathbb{E}x(t))\\,(x(t+\\Delta t)-\\mathbb{E}x(t))\\right]}{\\operatorname{Var}(x(t))},$$\n在线性化动力学下。将最终答案表示为关于 $\\mu$ 和 $\\Delta t$ 的精确解析表达式。无需四舍五入。自相关是无量纲的；不要包含单位。",
            "solution": "该问题具有科学依据，提法恰当，并提供了所有必要信息。它代表了对一个典型的临界点模型的标准分析。因此，该问题被认为是有效的。\n\n(a) 为了找出系统 $\\frac{dx}{dt}=\\mu - x^{2}$ 的平衡点，我们将变化率设为零：\n$$\n\\frac{dx}{dt} = 0 \\implies \\mu - x^{2} = 0\n$$\n这得到 $x^{2} = \\mu$。令平衡点用 $x^{\\star}$ 表示。\n\n-   如果 $\\mu > 0$，存在两个不同的实平衡点：$x^{\\star}_{1} = \\sqrt{\\mu}$ 和 $x^{\\star}_{2} = -\\sqrt{\\mu}$。\n-   如果 $\\mu = 0$，在 $x^{\\star} = 0$ 处有一个唯一的平衡点。\n-   如果 $\\mu  0$，不存在实平衡点，因为对于实数 $x$，$x^{2}$ 不能为负。\n\n为了确定这些平衡点的稳定性，我们使用线性稳定性分析。令 $f(x) = \\mu - x^{2}$。稳定性由在平衡点 $x^{\\star}$ 处计算的特征值 $\\lambda = \\frac{df}{dx}$ 的符号决定。其导数为：\n$$\n\\frac{df}{dx} = -2x\n$$\n我们对 $\\mu>0$ 的情况，在每个平衡点处计算这个导数：\n\n-   对于平衡点 $x^{\\star}_{1} = \\sqrt{\\mu}$：\n    $$\n    \\lambda_{1} = \\left.\\frac{df}{dx}\\right|_{x=\\sqrt{\\mu}} = -2\\sqrt{\\mu}\n    $$\n    由于 $\\mu > 0$，$\\sqrt{\\mu}$ 是实数且为正，所以 $\\lambda_{1}  0$。具有负实特征值的平衡点是稳定的。因此，$x^{\\star}_{1} = \\sqrt{\\mu}$ 是一个稳定平衡点。\n\n-   对于平衡点 $x^{\\star}_{2} = -\\sqrt{\\mu}$：\n    $$\n    \\lambda_{2} = \\left.\\frac{df}{dx}\\right|_{x=-\\sqrt{\\mu}} = -2(-\\sqrt{\\mu}) = 2\\sqrt{\\mu}\n    $$\n    由于 $\\mu > 0$，$\\lambda_{2} > 0$。具有正实特征值的平衡点是不稳定的。因此，$x^{\\star}_{2} = -\\sqrt{\\mu}$ 是一个不稳定平衡点。\n\n在 $\\mu=0$ 时，两个平衡点合并。此时，$\\lambda = -2(0) = 0$。这是一个非双曲平衡点，线性稳定性分析无法得出结论。这个点 $\\mu=0$ 是一个鞍结（或折叠）分岔的位置，在此处稳定和不稳定的平衡点碰撞并湮灭。\n\n(b) 类似滞后的稳定性延迟丧失，也称为动态分岔延迟，发生在控制参数以有限速率通过一个分岔点时。\n\n考虑系统从 $t \\ll 0$ 时的稳定平衡点 $x(t) = \\sqrt{\\mu(t)} = \\sqrt{\\mu_{0}-\\varepsilon t}$（对于 $\\mu(t)>0$）开始。随着时间 $t$ 增加，参数 $\\mu(t)$ 缓慢减小。在 $t_{c} = \\mu_{0}/\\varepsilon$ 时，参数 $\\mu$ 穿过零。在这一确切时刻，静态分岔发生：位于 $x^{\\star}=0$ 的稳定平衡点不复存在。对于任何 $t > t_{c}$，$\\mu(t)$ 变为负数。在这种情况下，控制方程为 $\\frac{dx}{dt} = \\mu(t) - x^{2}$。由于 $\\mu(t)  0$ 且 $-x^{2} \\le 0$，等式右侧对所有 $x$ 严格为负。这意味着 $\\frac{dx}{dt}  0$，状态 $x(t)$ 必须无限减小（在这个简单模型中，趋向于 $-\\infty$）。\n\n延迟的产生是因为变化率不是瞬时的。在 $t_{c}$ 发生分岔后，状态 $x(t)$ 接近于 $0$，而 $\\mu(t)$ 是一个小的负数。例如，在时间 $t = t_{c} + \\delta t$（其中 $\\delta t$ 是一个小的正数），$\\mu(t) = -\\varepsilon \\delta t$。运动方程为 $\\frac{dx}{dt} = -\\varepsilon\\delta t - x^{2}$。由于 $x$ 接近 $0$，$\\frac{dx}{dt}$ 是一个小的负数。因此，状态 $x(t)$ 开始非常缓慢地偏离 $x=0$。它不会“跳”到一个新的状态。这种轨迹在现已消失的平衡点“幽灵”附近的徘徊就是动态分岔延迟。系统的状态滞后于其潜在稳定性结构的变化。斜坡速率 $\\varepsilon$ 越小，漂移越慢，延迟时间越长。\n\n这一现象与预警指标（EWS）至关重要。EWS，如方差或自相关性的上升，是基于“临界慢化”——即系统从扰动中恢复的速率在接近分岔点时会减慢。恢复速率由 $|\\lambda_{1}| = 2\\sqrt{\\mu}$ 给出，当 $\\mu \\to 0^{+}$ 时，该速率趋于 $0$。动态分岔延迟是这种临界慢化的直接后果。系统变得如此迟缓，以至于无法跟上变化的环境（变化的 $\\mu$）。这揭示的危险在于，实际的临界点（$\\mu=0$）可能在系统状态发生任何剧烈的、可观测到的变化之前就已经被越过。观察者可能认为系统仍处于安全状态，而实际上潜在的稳定性已经丧失，一个巨大的、不可逆的转变只是被延迟了，但现在已不可避免。\n\n(c) 给定随机微分方程（SDE）：\n$$\ndx = (\\mu - x^{2})dt + \\sigma dW_{t}\n$$\n对于固定的 $\\mu > 0$，稳定平衡点是 $x^{\\star} = \\sqrt{\\mu}$。我们通过考虑小的涨落 $y(t) = x(t) - x^{\\star}$ 来围绕此平衡点线性化系统。这也意味着 $dx = dy$。漂移项 $f(x) = \\mu - x^{2}$ 通过在 $x^{\\star}$ 周围的一阶泰勒展开来近似：\n$$\nf(x) \\approx f(x^{\\star}) + f'(x^{\\star})(x - x^{\\star})\n$$\n我们知道 $f(x^{\\star}) = \\mu - (x^{\\star})^{2} = \\mu - \\mu = 0$。导数为 $f'(x) = -2x$，所以 $f'(x^{\\star}) = -2x^{\\star} = -2\\sqrt{\\mu}$。将这些代入展开式得到：\n$$\nf(x) \\approx 0 + (-2\\sqrt{\\mu})y(t) = -2\\sqrt{\\mu}y(t)\n$$\n因此，涨落 $y(t)$ 的线性化SDE为：\n$$\ndy = -2\\sqrt{\\mu} y dt + \\sigma dW_{t}\n$$\n这是一般形式为 $dy = -\\theta y dt + \\sigma dW_{t}$ 的 Ornstein-Uhlenbeck (OU) 过程的方程，其弛豫速率为 $\\theta = 2\\sqrt{\\mu}$。\n\nOU过程的平稳解是一个均值为零的高斯过程，$\\mathbb{E}[y(t)]=0$。这意味着 $\\mathbb{E}[x(t)] = x^{\\star}$。涨落被定义为与均值的偏差，因此 $x(t) - \\mathbb{E}[x(t)] = x(t) - x^{\\star} = y(t)$。\n\n平稳滞后-$\\Delta t$ 自相关函数 $\\rho(\\Delta t)$ 定义为：\n$$\n\\rho(\\Delta t) = \\frac{\\mathbb{E}\\left[(x(t)-\\mathbb{E}x(t))\\,(x(t+\\Delta t)-\\mathbb{E}x(t))\\right]}{\\operatorname{Var}(x(t))} = \\frac{\\mathbb{E}[y(t)y(t+\\Delta t)]}{\\operatorname{Var}(y(t))}\n$$\n分子是 $y(t)$ 的自协方差。对于一个平稳的OU过程，其自协方差函数由 $\\operatorname{Cov}(y(t), y(t+\\Delta t)) = \\operatorname{Var}(y(t))\\exp(-\\theta |\\Delta t|)$ 给出。假设 $\\Delta t \\ge 0$，则为 $\\operatorname{Var}(y(t))\\exp(-\\theta \\Delta t)$。\n\n将此代入 $\\rho(\\Delta t)$ 的表达式中：\n$$\n\\rho(\\Delta t) = \\frac{\\operatorname{Var}(y(t))\\exp(-\\theta \\Delta t)}{\\operatorname{Var}(y(t))} = \\exp(-\\theta \\Delta t)\n$$\n最后，我们将 $\\theta = 2\\sqrt{\\mu}$ 的值代回表达式中：\n$$\n\\rho(\\Delta t) = \\exp(-2\\sqrt{\\mu} \\Delta t)\n$$\n该表达式表明，当系统接近临界点（$\\mu \\to 0^{+}$）时，指数趋于 $0$，对于任何固定的滞后 $\\Delta t$，自相关 $\\rho(\\Delta t)$ 趋于 $1$。这种不断增加的自相关性是一个关键的预警信号。",
            "answer": "$$\\boxed{\\exp(-2\\sqrt{\\mu}\\Delta t)}$$"
        },
        {
            "introduction": "掌握了理论基础后，下一步是将其应用于实际数据分析中。这个动手编程练习 () 旨在让你将理论知识转化为具体的计算技能。你将实现一种计算预警指标的标准方法：移动窗口分析（moving-window analysis），在一个模拟接近临界点的合成时间序列上，计算其自相关系数（以 AR(1) 模型的系数 $ \\phi $ 为代表）和方差的变化趋势。这项练习不仅能加深你对临界慢化现象的理解，还能为你提供处理真实世界时间序列、从中提取预警信号所必需的核心编程能力。",
            "id": "3876395",
            "problem": "给定一个去趋势化的标量时间序列数据，该数据被假设正在接近一个由分岔引起的系统状态转变。一个早期预警指标是滞后-$1$ 阶自相关和方差的逐步增加，这可以通过对一个自回归1阶模型进行移动窗口拟合，并对指标趋势进行推断来评估。从自回归 (AR) 模型的定义出发，考虑由 $x_t = \\phi x_{t-1} + \\epsilon_t$ 定义的 AR 1阶过程，其中 $t \\in \\{1,2,\\ldots,N-1\\}$，$x_t$ 是去趋势化的标量状态，$\\phi$ 是 AR 系数，$\\epsilon_t$ 是一个零均值噪声序列。假设噪声是独立同分布的，并且时间序列在去趋势化后均值为零。使用普通最小二乘法 (OLS) 作为参数估计的原则，并使用每个窗口内的无偏样本方差作为变异性的度量，您的任务是实现一个完整的程序，该程序：\n\n- 将序列分割成固定长度的重叠窗口，按固定步长前进，并对每个窗口进行如下操作：\n  - 通过最小化窗口段上的单步预测误差平方和，计算 AR 1阶系数 $\\phi$。\n  - 计算窗口段内的无偏样本方差。\n- 将窗口时间坐标定义为每个窗口的中心索引，并使用最小二乘拟合计算 $\\phi$ 的窗口估计值相对于窗口中心时间的线性趋势斜率，以及窗口方差相对于窗口中心时间的线性趋势斜率。\n- 对于每个测试用例，返回一个包含两个浮点数的列表：$\\phi$ 的斜率和方差在所有窗口中心上的斜率。\n\n基本依据和假设：\n- 自回归 (AR) 定义：对于一个截距为零的去趋势化序列，$x_t = \\phi x_{t-1} + \\epsilon_t$，其中 $\\epsilon_t$ 是零均值噪声。\n- 普通最小二乘法 (OLS)：参数估计值使窗口上的 $\\sum_t (x_t - \\phi x_{t-1})^2$ 最小化。\n- 无偏样本方差：对于长度为 $W$ 的窗口，$\\mathrm{Var}(x) = \\frac{1}{W-1} \\sum_{i=1}^W (x_i - \\bar{x})^2$。\n- 线性趋势斜率：对于配对数据 $(t_i, y_i)$，OLS 斜率是最佳线性拟合 $y = a + b t$ 中乘以 $t$ 的系数，等价于 $b = \\frac{\\sum_i (t_i - \\bar{t})(y_i - \\bar{y})}{\\sum_i (t_i - \\bar{t})^2}$。\n\n要求：\n- 严格按照描述实现该过程。\n- 使用线性斜率作为 $\\phi$ 和方差趋势的量化指标。\n- 如果一个窗口产生退化的 AR 拟合（例如，如果窗口内 $\\sum x_{t-1}^2 = 0$），则将该窗口的 $\\phi$ 估计值定义为 $0$。\n- 输入的时间序列由程序内部使用具有指定种子的可复现伪随机噪声生成。\n- 不涉及物理单位；所有输出均为无量纲实数。\n- 不使用角度。\n- 将所有输出表示为原始浮点数，除标准双精度外没有舍入要求。\n\n测试套件：\n实现四个具有以下参数的测试用例。在所有情况下，将初始状态设置为 $x_0 = 0$，并使用标准差为 $\\sigma$ 的独立高斯噪声 $\\epsilon_t \\sim \\mathcal{N}(0, \\sigma^2)$。当 $\\phi$ 随时间变化时，对于 $t \\in \\{0,1,\\ldots,N-1\\}$，设置 $\\phi_t = \\phi_{\\mathrm{start}} + (\\phi_{\\mathrm{end}} - \\phi_{\\mathrm{start}})\\cdot \\frac{t}{N-1}$，并模拟 $x_t = \\phi_t x_{t-1} + \\epsilon_t$。\n\n- 用例 $1$（稳定基线）：\n  - 序列长度 $N = 500$\n  - 恒定 $\\phi = 0.2$\n  - 噪声标准差 $\\sigma = 1.0$\n  - 窗口长度 $W = 50$\n  - 步长 $S = 10$\n  - 随机种子 $s = 42$\n- 用例 $2$（持久性增加，接近临界点）：\n  - 序列长度 $N = 500$\n  - $\\phi$ 从 $\\phi_{\\mathrm{start}} = 0.2$ 线性增加到 $\\phi_{\\mathrm{end}} = 0.95$\n  - 噪声标准差 $\\sigma = 1.0$\n  - 窗口长度 $W = 50$\n  - 步长 $S = 10$\n  - 随机种子 $s = 43$\n- 用例 $3$（窗口数量少的边界条件）：\n  - 序列长度 $N = 60$\n  - $\\phi$ 从 $\\phi_{\\mathrm{start}} = 0.5$ 线性增加到 $\\phi_{\\mathrm{end}} = 0.9$\n  - 噪声标准差 $\\sigma = 1.0$\n  - 窗口长度 $W = 50$\n  - 步长 $S = 5$\n  - 随机种子 $s = 44$\n- 用例 $4$（接近白噪声）：\n  - 序列长度 $N = 500$\n  - 恒定 $\\phi = 0.0$\n  - 噪声标准差 $\\sigma = 1.0$\n  - 窗口长度 $W = 50$\n  - 步长 $S = 10$\n  - 随机种子 $s = 45$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个元素对应一个测试用例，并且本身必须是一个包含两个浮点数的列表，顺序为 $[\\phi \\text{ 的斜率}, \\text{方差的斜率}]$。例如，输出格式必须与 $[[a_1,b_1],[a_2,b_2],[a_3,b_3],[a_4,b_4]]$ 完全一样，其中每个 $a_i$ 和 $b_i$ 都是浮点数。",
            "solution": "该问题定义明确，具有科学依据，并为获得唯一、可验证的解决方案提供了所有必要信息。我们将逐步推导并实现指定的过程。目标是通过分析移动窗口内滞后1阶自相关系数和方差的行为，计算标量时间序列中潜在的分岔引起的系统状态转变的趋势指标。\n\n分析的核心是基于一个1阶自回归模型（$\\text{AR}(1)$）。对于一个去趋势化的零均值时间序列 $x_t$，该模型定义如下：\n$$x_t = \\phi x_{t-1} + \\epsilon_t$$\n其中 $t \\in \\{1, 2, \\ldots, N-1\\}$ 是时间索引，$\\phi$ 是滞后1阶自回归系数，$\\epsilon_t$ 是一系列独立同分布的零均值噪声项。\n\n分析包括三个主要阶段：将时间序列分割成窗口；估计每个窗口内的 $\\phi$ 和方差；以及量化这些估计值的时间趋势。\n\n**1. 时间序列分割和加窗**\n\n给定的总长度为 $N$ 的时间序列被分割成固定长度 $W$ 的重叠窗口。窗口以固定的步长 $S$ 沿序列前进。第一个窗口的起始索引是 $0$。后续窗口从索引 $S, 2S, 3S, \\ldots$ 开始。只要窗口完全包含在序列内，该过程就继续。因此，任何窗口的起始索引 $i$ 必须满足条件 $i + W \\le N$。因此，起始索引的序列为 $i_k = k \\cdot S$，其中 $k = 0, 1, 2, \\ldots$ 且 $kS \\le N - W$。对于每个窗口，我们将计算两个统计量：$\\text{AR}(1)$ 系数和无偏样本方差。\n\n**2. 各窗口参数估计**\n\n让我们考虑一个由数据点 $\\{x_i, x_{i+1}, \\ldots, x_{i+W-1}\\}$ 组成的单一窗口。\n\n**2.1. AR(1) 系数 ($\\phi$) 估计**\n\n系数 $\\phi$ 使用普通最小二乘法 (OLS) 原理进行估计。我们寻求使窗口内单步预测的残差平方和 $L(\\phi)$ 最小化的 $\\phi$ 值。在此窗口内用于拟合模型 $x_t = \\phi x_{t-1} + \\epsilon_t$ 的可用数据由 $W-1$ 个形式为 $(x_{t-1}, x_t)$ 的数据对组成，其中 $t$ 的范围从 $i+1$ 到 $i+W-1$。\n\n残差平方和为：\n$$L(\\phi) = \\sum_{t=i+1}^{i+W-1} (x_t - \\phi x_{t-1})^2$$\n为了找到最小值，我们计算 $L(\\phi)$ 关于 $\\phi$ 的导数并将其设为零：\n$$\\frac{d L}{d \\phi} = \\frac{d}{d \\phi} \\sum_{t=i+1}^{i+W-1} (x_t^2 - 2\\phi x_t x_{t-1} + \\phi^2 x_{t-1}^2) = \\sum_{t=i+1}^{i+W-1} (-2 x_t x_{t-1} + 2\\phi x_{t-1}^2) = 0$$\n求解 $\\phi$：\n$$2 \\phi \\sum_{t=i+1}^{i+W-1} x_{t-1}^2 = 2 \\sum_{t=i+1}^{i+W-1} x_t x_{t-1}$$\n这得出了窗口的 OLS 估计值 $\\hat{\\phi}$：\n$$\\hat{\\phi} = \\frac{\\sum_{t=i+1}^{i+W-1} x_t x_{t-1}}{\\sum_{t=i+1}^{i+W-1} x_{t-1}^2}$$\n按照规定，如果分母 $\\sum x_{t-1}^2$ 为零，这表明用于拟合的窗口段内回归量没有变化，则估计值 $\\hat{\\phi}$ 定义为 $0$。\n\n**2.2. 无偏样本方差估计**\n\n计算窗口内数据点 $\\{x_i, x_{i+1}, \\ldots, x_{i+W-1}\\}$ 的无偏样本方差。首先，计算 $W$ 个数据点的样本均值 $\\bar{x}_{\\text{win}}$：\n$$\\bar{x}_{\\text{win}} = \\frac{1}{W} \\sum_{j=i}^{i+W-1} x_j$$\n然后，无偏样本方差 $\\widehat{\\mathrm{Var}}(x)$ 由下式给出：\n$$\\widehat{\\mathrm{Var}}(x) = \\frac{1}{W-1} \\sum_{j=i}^{i+W-1} (x_j - \\bar{x}_{\\text{win}})^2$$\n分母 $W-1$ 体现了从样本中无偏估计总体方差的 Bessel 校正。\n\n**3. 指标时间序列的趋势分析**\n\n处理完所有窗口后，我们得到两个新的时间序列：一个是 $\\phi$ 的估计值序列，另一个是方差的估计值序列。为了分析它们的趋势，我们首先为每个估计值分配一个时间坐标。问题指定使用窗口的中心索引作为其时间坐标。对于一个从索引 $i$ 开始、长度为 $W$ 的窗口，其时间坐标 $t_{\\text{center}}$ 是：\n$$t_{\\text{center}} = i + \\frac{W-1}{2}$$\n设窗口时间中心的序列为 $\\{t_1, t_2, \\ldots, t_M\\}$，相应的指标估计值（$\\hat{\\phi}$ 或 $\\widehat{\\mathrm{Var}}$）为 $\\{y_1, y_2, \\ldots, y_M\\}$，其中 $M$ 是窗口的总数。\n\n为了量化趋势，我们对指标 $y$ 关于时间 $t$ 进行线性回归，拟合模型 $y_k = a + b t_k$。斜率 $b$ 代表线性趋势。根据 OLS，斜率的公式是：\n$$b = \\frac{\\sum_{k=1}^M (t_k - \\bar{t})(y_k - \\bar{y})}{\\sum_{k=1}^M (t_k - \\bar{t})^2}$$\n其中 $\\bar{t} = \\frac{1}{M}\\sum_{k=1}^M t_k$ 和 $\\bar{y} = \\frac{1}{M}\\sum_{k=1}^M y_k$ 分别是时间坐标和指标值的样本均值。该公式等价于 $t$ 和 $y$ 的样本协方差与 $t$ 的样本方差之比。这个斜率 $b$ 将分别对 $\\hat{\\phi}$ 序列和 $\\widehat{\\mathrm{Var}}(x)$ 序列进行计算。\n\n这个完整的程序为每个测试用例提供了两个所需的输出：滞后1阶自相关系数的斜率和方差的斜率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_slope(t, y):\n    \"\"\"\n    Computes the slope of a linear regression of y on t using OLS.\n    \"\"\"\n    n = len(t)\n    if n  2:\n        return 0.0\n    \n    t_mean = np.mean(t)\n    y_mean = np.mean(y)\n    \n    numerator = np.sum((t - t_mean) * (y - y_mean))\n    denominator = np.sum((t - t_mean)**2)\n    \n    if denominator == 0:\n        return 0.0\n        \n    return numerator / denominator\n\ndef analyze_time_series(N, phi_params, sigma, W, S, seed):\n    \"\"\"\n    Generates an AR(1) time series and computes the slopes of EWI trends.\n    \n    Args:\n        N (int): Series length.\n        phi_params (float or tuple): Constant phi or (start, end) for varying phi.\n        sigma (float): Noise standard deviation.\n        W (int): Window length.\n        S (int): Step size.\n        seed (int): Random seed.\n\n    Returns:\n        list: A list containing [slope_phi, slope_var].\n    \"\"\"\n    # 1. Generate the time series\n    rng = np.random.default_rng(seed)\n    x = np.zeros(N)\n    noise = rng.normal(loc=0.0, scale=sigma, size=N)\n    \n    if isinstance(phi_params, tuple):\n        phi_start, phi_end = phi_params\n        # phi_t is used to evolve x from t-1 to t\n        phi_vec = np.linspace(phi_start, phi_end, N)\n    else:\n        phi_vec = np.full(N, phi_params)\n\n    # Initial state x_0 = 0 is set by np.zeros\n    for t in range(1, N):\n        x[t] = phi_vec[t] * x[t-1] + noise[t]\n\n    # 2. Compute windowed statistics\n    t_centers = []\n    phi_estimates = []\n    var_estimates = []\n\n    for i in range(0, N - W + 1, S):\n        window = x[i : i + W]\n        \n        # Estimate phi using OLS for x_t = phi * x_{t-1}\n        # The regressors are x_0, ..., x_{W-2} and responses x_1, ..., x_{W-1}\n        # within the window.\n        X_reg = window[:-1]\n        y_reg = window[1:]\n        \n        sum_X_sq = np.dot(X_reg, X_reg)\n        if sum_X_sq == 0:\n            phi_hat = 0.0\n        else:\n            phi_hat = np.dot(X_reg, y_reg) / sum_X_sq\n        \n        # Estimate unbiased sample variance for the entire window\n        var_hat = np.var(window, ddof=1)\n        \n        # Define window time coordinate as the center index\n        t_center = i + (W - 1) / 2.0\n        \n        phi_estimates.append(phi_hat)\n        var_estimates.append(var_hat)\n        t_centers.append(t_center)\n\n    # 3. Calculate trend slopes\n    t_centers_arr = np.array(t_centers)\n    phi_estimates_arr = np.array(phi_estimates)\n    var_estimates_arr = np.array(var_estimates)\n\n    slope_phi = calculate_slope(t_centers_arr, phi_estimates_arr)\n    slope_var = calculate_slope(t_centers_arr, var_estimates_arr)\n    \n    return [slope_phi, slope_var]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (stable baseline)\n        {'N': 500, 'phi_params': 0.2, 'sigma': 1.0, 'W': 50, 'S': 10, 'seed': 42},\n        # Case 2 (approaching tipping)\n        {'N': 500, 'phi_params': (0.2, 0.95), 'sigma': 1.0, 'W': 50, 'S': 10, 'seed': 43},\n        # Case 3 (boundary condition)\n        {'N': 60, 'phi_params': (0.5, 0.9), 'sigma': 1.0, 'W': 50, 'S': 5, 'seed': 44},\n        # Case 4 (near white noise)\n        {'N': 500, 'phi_params': 0.0, 'sigma': 1.0, 'W': 50, 'S': 10, 'seed': 45},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_time_series(\n            N=case['N'],\n            phi_params=case['phi_params'],\n            sigma=case['sigma'],\n            W=case['W'],\n            S=case['S'],\n            seed=case['seed']\n        )\n        results.append(result)\n\n    # Format the output string exactly as required\n    inner_parts = [f\"[{r[0]},{r[1]}]\" for r in results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在真实的预警系统中，我们通常会监测多个指标，并且需要权衡“误报”和“漏报”这两种不同错误的代价。这个高级练习 () 将引导你从信号检测转向决策制定。它要求你运用贝叶斯决策理论，为一个包含方差、自相关和偏度三个指标的预警系统设计一个最优的线性复合指标 $ w^{\\top} X $ 和决策阈值 $ t $。通过这个练习，你将学会如何整合多个充满噪声的信号，并根据误报（false alarm）与漏报（missed tipping）的非对称成本来优化决策规则，这对于构建可操作的环境管理与风险预警系统至关重要。",
            "id": "3876399",
            "problem": "一个气候监测项目追踪一个亚寒带湖泊系统中潜在临界转变的三个早期预警指标：方差增加、滞后-$1$自相关增加以及偏度变化。设指标向量为 $X \\in \\mathbb{R}^{3}$，其中 $X = (V, R, S)^{\\top}$。假设一个二元状态变量 $Y \\in \\{0,1\\}$，其中 $Y=0$ 表示稳定（非临界）状态，而 $Y=1$ 表示临界前状态。在给定 $Y$ 的条件下，假设 $X$ 服从一个在两类之间具有相等协方差的多元正态分布：\n$$\nX \\mid Y=y \\sim \\mathcal{N}(\\mu_{y}, \\Sigma), \\quad y \\in \\{0,1\\}。\n$$\n假设类条件均值和公共协方差为\n$$\n\\mu_{0} = \\begin{pmatrix} 1.0 \\\\ 0.3 \\\\ 0.0 \\end{pmatrix}, \\quad\n\\mu_{1} = \\begin{pmatrix} 1.5 \\\\ 0.6 \\\\ 0.2 \\end{pmatrix}, \\quad\n\\Sigma = \\begin{pmatrix}\n0.09  0.03  0.00 \\\\\n0.03  0.04  0.01 \\\\\n0.00  0.01  0.02\n\\end{pmatrix}。\n$$\n处于临界前状态的先验概率为 $\\pi_{1} = 0.05$，因此 $\\pi_{0} = 1 - \\pi_{1} = 0.95$。一个操作决策规则是，如果一个综合得分 $S = w^{\\top} X$ 超过阈值 $t$，则发出警报。误报（当 $Y=0$ 时宣布为临界前状态）的损失为 $C_{\\mathrm{FA}} = 1$，漏报（当 $Y=1$ 时未能宣布）的损失为 $C_{\\mathrm{MISS}} = 10$。\n\n从贝叶斯决策理论和高斯类条件模型出发，推导出在这些非对称成本下最小化期望损失的最优线性组合 $w$ 的方向。因为当 $t$ 作相应调整时，期望损失对于 $w$ 的正向缩放是不变的，所以施加归一化约束 $w^{\\top} \\Sigma w = 1$（$Y=0$ 条件下 $S$ 的单位方差）以确保唯一性。然后计算以下各项的精确闭式表达式：\n- 在归一化 $w^{\\top} \\Sigma w = 1$ 下的最优权重向量 $w^{\\star}$，以及\n- 使用给定的 $\\pi_{1}$、$C_{\\mathrm{FA}}$ 和 $C_{\\mathrm{MISS}}$ 来最小化期望损失的相应最优决策阈值 $t^{\\star}$。\n\n将你的最终答案报告为一个单行向量，包含 $w^{\\star}$ 的三个分量，后跟 $t^{\\star}$，不带单位。无需四舍五入；提供精确表达式。",
            "solution": "用户希望我为一个二元分类问题找到最优权重向量 $w^{\\star}$ 和决策阈值 $t^{\\star}$，以使线性分类器的期望损失最小化。\n\n### 步骤 1：问题验证\n\n**1.1. 提取的已知条件：**\n- 指标向量：$X = (V, R, S)^{\\top} \\in \\mathbb{R}^{3}$。\n- 状态变量：$Y \\in \\{0, 1\\}$，其中 $Y=0$ 是稳定状态， $Y=1$ 是临界前状态。\n- 类条件分布：$X \\mid Y=y \\sim \\mathcal{N}(\\mu_{y}, \\Sigma)$ 对于 $y \\in \\{0,1\\}$。\n- 类条件均值：\n$$ \\mu_{0} = \\begin{pmatrix} 1.0 \\\\ 0.3 \\\\ 0.0 \\end{pmatrix}, \\quad \\mu_{1} = \\begin{pmatrix} 1.5 \\\\ 0.6 \\\\ 0.2 \\end{pmatrix} $$\n- 公共协方差矩阵：\n$$ \\Sigma = \\begin{pmatrix} 0.09  0.03  0.00 \\\\ 0.03  0.04  0.01 \\\\ 0.00  0.01  0.02 \\end{pmatrix} $$\n- 先验概率：$\\pi_{1} = P(Y=1) = 0.05$，所以 $\\pi_{0} = P(Y=0) = 1 - 0.05 = 0.95$。\n- 决策规则：如果综合得分 $S = w^{\\top} X$ 超过阈值 $t$，则发出警报（分类为 $Y=1$）。\n- 损失值：误报 $C_{\\mathrm{FA}} = 1$（当真实值为 $Y=0$ 时预测为 $Y=1$ 的成本），漏报 $C_{\\mathrm{MISS}} = 10$（当真实值为 $Y=1$ 时预测为 $Y=0$ 的成本）。正确分类没有损失。\n- 归一化约束：$w^{\\top} \\Sigma w = 1$。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题基于统计决策理论及其在复杂系统临界点早期预警信号中的应用，这是环境科学和生态学中一个有效且重要的课题。使用方差、自相关和偏度作为指标在文献中已有充分的论证。\n- **良定性：** 该问题是贝叶斯决策理论在高斯判别分析中的标准应用。目标是找到一个最优的线性分类器，这是一个定义明确的数学问题。公共协方差矩阵的假设导致了线性的决策边界。提供的协方差矩阵是对称的。其顺序主子式为 $0.09  0$，$(0.09)(0.04) - (0.03)^2 = 0.0027  0$，以及 $\\det(\\Sigma) = 0.000045  0$。由于它们都为正，$\\Sigma$ 是正定的，因此是一个有效的协方差矩阵。归一化约束确保了权重向量 $w$ 的唯一解。\n- **客观性：** 该问题使用精确的数学和统计语言陈述，没有歧义或主观论断。\n- **完整性与一致性：** 所有必要的参数（$\\mu_0, \\mu_1, \\Sigma, \\pi_0, \\pi_1, C_{\\mathrm{FA}}, C_{\\mathrm{MISS}}$）都已提供，并且没有内部矛盾。\n\n**1.3. 结论：**\n问题是有效的。\n\n### 步骤 2：最优分类器的推导\n\n目标是最小化期望损失，也称为贝叶斯风险。决策规则是将观测值 $X=x$ 分类到导致最小期望后验损失的类别。\n如果将观测值分类为 $Y=1$ 的期望损失小于将其分类为 $Y=0$ 的期望损失，我们就将其分类为 $Y=1$。\n行动“预测 $Y=1$”的期望损失：$L_1(x) = C_0 p(Y=0|x) = C_{\\mathrm{FA}} p(Y=0|x)$\n行动“预测 $Y=0$”的期望损失：$L_0(x) = C_1 p(Y=1|x) = C_{\\mathrm{MISS}} p(Y=1|x)$\n我们判定 $Y=1$ 如果 $L_1(x)  L_0(x)$，这意味着 $C_{\\mathrm{FA}} p(Y=0|x)  C_{\\mathrm{MISS}} p(Y=1|x)$。\n\n使用贝叶斯定理，$p(Y=y|x) = \\frac{p(x|Y=y)\\pi_y}{p(x)}$，不等式变为：\n$$ C_{\\mathrm{FA}} \\frac{p(x|Y=0)\\pi_0}{p(x)}  C_{\\mathrm{MISS}} \\frac{p(x|Y=1)\\pi_1}{p(x)} $$\n这简化为似然比检验：\n$$ \\frac{p(x|Y=1)}{p(x|Y=0)} > \\frac{C_{\\mathrm{FA}}\\pi_0}{C_{\\mathrm{MISS}}\\pi_1} = \\tau $$\n对于具有公共协方差 $\\Sigma$ 的多元高斯分布，似然比为：\n$$ \\frac{\\exp(-\\frac{1}{2}(x-\\mu_1)^\\top \\Sigma^{-1} (x-\\mu_1))}{\\exp(-\\frac{1}{2}(x-\\mu_0)^\\top \\Sigma^{-1} (x-\\mu_0))} = \\exp\\left(\\frac{1}{2}\\left[(x-\\mu_0)^\\top \\Sigma^{-1} (x-\\mu_0) - (x-\\mu_1)^\\top \\Sigma^{-1} (x-\\mu_1)\\right]\\right) $$\n对决策规则取自然对数：\n$$ \\frac{1}{2}\\left[(x-\\mu_0)^\\top \\Sigma^{-1} (x-\\mu_0) - (x-\\mu_1)^\\top \\Sigma^{-1} (x-\\mu_1)\\right] > \\ln(\\tau) $$\n展开二次型并化简，包含 $x^\\top \\Sigma^{-1} x$ 的项会消掉：\n$$ x^\\top\\Sigma^{-1}\\mu_1 - \\frac{1}{2}\\mu_1^\\top\\Sigma^{-1}\\mu_1 - (x^\\top\\Sigma^{-1}\\mu_0 - \\frac{1}{2}\\mu_0^\\top\\Sigma^{-1}\\mu_0) > \\ln(\\tau) $$\n$$ x^\\top\\Sigma^{-1}(\\mu_1 - \\mu_0) > \\ln(\\tau) + \\frac{1}{2}(\\mu_1^\\top\\Sigma^{-1}\\mu_1 - \\mu_0^\\top\\Sigma^{-1}\\mu_0) $$\n这个表达式是线性判别式 $w^{\\top}x > t'$ 的形式。因此，最优权重向量的方向与 $\\Sigma^{-1}(\\mu_1 - \\mu_0)$ 成正比。\n设 $w^{\\star} = k \\Sigma^{-1}(\\mu_1 - \\mu_0)$，其中 $k > 0$ 是某个标量。\n\n归一化约束是 $w^{\\star \\top} \\Sigma w^{\\star} = 1$。代入 $w^{\\star}$ 的表达式：\n$$ (k \\Sigma^{-1}(\\mu_1 - \\mu_0))^\\top \\Sigma (k \\Sigma^{-1}(\\mu_1 - \\mu_0)) = 1 $$\n$$ k^2 (\\mu_1 - \\mu_0)^\\top (\\Sigma^{-1})^\\top \\Sigma \\Sigma^{-1} (\\mu_1 - \\mu_0) = 1 $$\n因为 $\\Sigma$ 是对称的，所以 $\\Sigma^{-1}$ 也是对称的，即 $(\\Sigma^{-1})^\\top = \\Sigma^{-1}$。\n$$ k^2 (\\mu_1 - \\mu_0)^\\top \\Sigma^{-1} (\\mu_1 - \\mu_0) = 1 $$\n项 $(\\mu_1 - \\mu_0)^\\top \\Sigma^{-1} (\\mu_1 - \\mu_0)$ 是均值之间的马氏距离的平方，记为 $\\Delta^2$。\n$$ k^2 \\Delta^2 = 1 \\implies k = \\frac{1}{\\Delta} = \\frac{1}{\\sqrt{(\\mu_1 - \\mu_0)^\\top \\Sigma^{-1} (\\mu_1 - \\mu_0)}} $$\n最优权重向量是 $w^{\\star} = \\frac{1}{\\Delta} \\Sigma^{-1}(\\mu_1 - \\mu_0)$。\n\n最优阈值 $t^{\\star}$ 对应于决策不等式的右侧，并乘以 $k$：\n$$ w^{\\star \\top}x > t^{\\star} \\implies k(\\mu_1 - \\mu_0)^\\top\\Sigma^{-1}x > t^{\\star} $$\n与推导出的不等式比较，我们有：\n$$ t^{\\star} = k \\left[ \\ln(\\tau) + \\frac{1}{2}(\\mu_1^\\top\\Sigma^{-1}\\mu_1 - \\mu_0^\\top\\Sigma^{-1}\\mu_0) \\right] $$\n第二项可以重写为 $\\frac{1}{2}(\\mu_1 - \\mu_0)^\\top \\Sigma^{-1} (\\mu_1 + \\mu_0)$。\n\n### 步骤 3：参数计算\n\n首先，我们计算必要的数值。\n$\\delta = \\mu_1 - \\mu_0 = \\begin{pmatrix} 1.5 \\\\ 0.6 \\\\ 0.2 \\end{pmatrix} - \\begin{pmatrix} 1.0 \\\\ 0.3 \\\\ 0.0 \\end{pmatrix} = \\begin{pmatrix} 0.5 \\\\ 0.3 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 3/10 \\\\ 1/5 \\end{pmatrix}$。\n\n协方差矩阵 $\\Sigma$ 的逆：\n$\\det(\\Sigma) = 0.000045 = 45 \\times 10^{-6}$。\n$$ \\Sigma^{-1} = \\frac{1}{0.000045} \\begin{pmatrix} 0.0007  -0.0006  0.0003 \\\\ -0.0006  0.0018  -0.0009 \\\\ 0.0003  -0.0009  0.0027 \\end{pmatrix} = \\frac{100}{45} \\begin{pmatrix} 7  -6  3 \\\\ -6  18  -9 \\\\ 3  -9  27 \\end{pmatrix} = \\frac{20}{9} \\begin{pmatrix} 7  -6  3 \\\\ -6  18  -9 \\\\ 3  -9  27 \\end{pmatrix} $$\n\n未归一化的权重方向向量 $w_{dir} = \\Sigma^{-1}\\delta$：\n$$ w_{dir} = \\frac{20}{9} \\begin{pmatrix} 7  -6  3 \\\\ -6  18  -9 \\\\ 3  -9  27 \\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ 3/10 \\\\ 1/5 \\end{pmatrix} = \\frac{20}{9} \\begin{pmatrix} 7/2 - 18/10 + 3/5 \\\\ -3 + 54/10 - 9/5 \\\\ 3/2 - 27/10 + 27/5 \\end{pmatrix} = \\frac{20}{9} \\begin{pmatrix} 23/10 \\\\ 6/10 \\\\ 42/10 \\end{pmatrix} = \\frac{2}{9} \\begin{pmatrix} 23 \\\\ 6 \\\\ 42 \\end{pmatrix} $$\n\n接下来，我们计算马氏距离的平方 $\\Delta^2 = \\delta^\\top w_{dir}$：\n$$ \\Delta^2 = \\begin{pmatrix} 1/2  3/10  1/5 \\end{pmatrix} \\frac{2}{9} \\begin{pmatrix} 23 \\\\ 6 \\\\ 42 \\end{pmatrix} = \\frac{2}{9} \\left( \\frac{23}{2} + \\frac{18}{10} + \\frac{42}{5} \\right) = \\frac{2}{9} \\left( \\frac{115+18+84}{10} \\right) = \\frac{2}{9} \\frac{217}{10} = \\frac{217}{45} $$\n\n归一化常数是 $k = 1/\\Delta = \\sqrt{45/217}$。\n最优权重向量 $w^{\\star} = k w_{dir}$：\n$$ w^{\\star} = \\sqrt{\\frac{45}{217}} \\frac{2}{9} \\begin{pmatrix} 23 \\\\ 6 \\\\ 42 \\end{pmatrix} = \\frac{3\\sqrt{5}}{\\sqrt{217}} \\frac{2}{9} \\begin{pmatrix} 23 \\\\ 6 \\\\ 42 \\end{pmatrix} = \\frac{2\\sqrt{5}}{3\\sqrt{217}} \\begin{pmatrix} 23 \\\\ 6 \\\\ 42 \\end{pmatrix} $$\n$w^{\\star}$ 的分量是：\n$w_1^{\\star} = \\frac{46\\sqrt{5}}{3\\sqrt{217}}$，\n$w_2^{\\star} = \\frac{12\\sqrt{5}}{3\\sqrt{217}} = \\frac{4\\sqrt{5}}{\\sqrt{217}}$，\n$w_3^{\\star} = \\frac{84\\sqrt{5}}{3\\sqrt{217}} = \\frac{28\\sqrt{5}}{\\sqrt{217}}$。\n为了呈现时保持公分母：$w_2^{\\star} = \\frac{12\\sqrt{5}}{3\\sqrt{217}}$，$w_3^{\\star} = \\frac{84\\sqrt{5}}{3\\sqrt{217}}$。\n\n现在，我们计算阈值 $t^{\\star}$。首先，是成本-先验比率 $\\tau$：\n$$ \\tau = \\frac{C_{\\mathrm{FA}}\\pi_0}{C_{\\mathrm{MISS}}\\pi_1} = \\frac{1 \\cdot 0.95}{10 \\cdot 0.05} = \\frac{0.95}{0.50} = 1.9 = \\frac{19}{10} $$\n接下来，我们计算项 $\\frac{1}{2}(\\mu_1 - \\mu_0)^\\top \\Sigma^{-1} (\\mu_1 + \\mu_0) = \\frac{1}{2} \\delta^\\top \\Sigma^{-1} (\\mu_1+\\mu_0) = \\frac{1}{2} w_{dir}^\\top (\\mu_1+\\mu_0)$。\n$\\mu_1+\\mu_0 = \\begin{pmatrix} 2.5 \\\\ 0.9 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} 5/2 \\\\ 9/10 \\\\ 1/5 \\end{pmatrix}$。\n$$ w_{dir}^\\top (\\mu_1+\\mu_0) = \\frac{2}{9} \\begin{pmatrix} 23  6  42 \\end{pmatrix} \\begin{pmatrix} 5/2 \\\\ 9/10 \\\\ 1/5 \\end{pmatrix} = \\frac{2}{9} \\left( \\frac{115}{2} + \\frac{54}{10} + \\frac{42}{5} \\right) = \\frac{2}{9} \\frac{713}{10} = \\frac{713}{45} $$\n所以该项是 $\\frac{1}{2} \\frac{713}{45} = \\frac{713}{90}$。\n最后，我们组合成阈值 $t^{\\star}$：\n$$ t^{\\star} = k \\left( \\ln(\\tau) + \\frac{713}{90} \\right) = \\sqrt{\\frac{45}{217}} \\left( \\ln\\left(\\frac{19}{10}\\right) + \\frac{713}{90} \\right) $$\n\n最终答案需要 $w^{\\star}$ 的三个分量和 $t^{\\star}$ 的值。\n$w_1^{\\star} = \\frac{46\\sqrt{5}}{3\\sqrt{217}}$\n$w_2^{\\star} = \\frac{4\\sqrt{5}}{\\sqrt{217}}$\n$w_3^{\\star} = \\frac{28\\sqrt{5}}{\\sqrt{217}}$\n$t^{\\star} = \\sqrt{\\frac{45}{217}} \\left( \\ln\\left(\\frac{19}{10}\\right) + \\frac{713}{90} \\right)$\n我们可以将分母有理化以便最终呈现，但可能不会更简洁。例如，$\\frac{\\sqrt{5}}{\\sqrt{217}} = \\frac{\\sqrt{1085}}{217}$。我们还是保持分母带根号的形式，因为它更紧凑。\n\n因此，最终的分量是：\n$w_1^{\\star} = \\frac{46\\sqrt{5}}{3\\sqrt{217}}$，$w_2^{\\star} = \\frac{4\\sqrt{5}}{\\sqrt{217}}$，$w_3^{\\star} = \\frac{28\\sqrt{5}}{\\sqrt{217}}$，$t^{\\star} = \\sqrt{\\frac{45}{217}} \\left( \\ln\\left(\\frac{19}{10}\\right) + \\frac{713}{90} \\right)$。\n这些是所要求的精确的闭式表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{46\\sqrt{5}}{3\\sqrt{217}}  \\frac{4\\sqrt{5}}{\\sqrt{217}}  \\frac{28\\sqrt{5}}{\\sqrt{217}}  \\sqrt{\\frac{45}{217}} \\left( \\ln\\left(\\frac{19}{10}\\right) + \\frac{713}{90} \\right)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}