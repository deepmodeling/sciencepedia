{
    "hands_on_practices": [
        {
            "introduction": "本章节的第一个实践练习将介绍干沉降建模的基石：串联电阻模型。通过这个练习，你将学习如何将大气湍流输送、近地面准层流边界层传递以及地表吸收这三个过程整合到一个简洁的框架中，并推导出总的沉降速率 $V_d$。掌握这一基础模型对于理解污染物如何从大气中移除至关重要 。",
            "id": "3875144",
            "problem": "一个含有臭氧的气块，在稳态、白天的对流不稳定条件下，被输送到一个水平均匀的植被表面上。假设在地表层内没有臭氧的化学产生或损失，因此垂直湍流通量不随高度变化。设参考高度处的臭氧浓度为 $C_{r}$，并将恒定的向下通量表示为 $F$（向下为正）。在大叶模型下，参考高度与地表内的最终汇之间存在三个串联的交换路径：穿越湍流地表层的空气动力学路径、邻近地表的准层流子层，以及代表冠层和地面汇的地表吸收路径。对每个路径，定义一个阻力，其值为该路径上的浓度降与通过该路径的通量之比，即空气动力学路径的阻力为 $r_{a}$，准层流路径的阻力为 $r_{b}$，地表吸收路径的阻力为 $r_{c}$，单位为 $\\mathrm{s\\,m^{-1}}$。沉降速率 $V_{d}$ 由通量-浓度关系 $F = V_{d}\\,C_{r}$ 定义。使用稳态质量守恒和上述阻力定义，推导一个用 $r_{a}$、$r_{b}$ 和 $r_{c}$ 表示 $V_{d}$ 的表达式，然后对臭氧用 $r_{a}=30\\,\\mathrm{s\\,m^{-1}}$、$r_{b}=10\\,\\mathrm{s\\,m^{-1}}$ 和 $r_{c}=100\\,\\mathrm{s\\,m^{-1}}$ 进行求值。将您的数值结果四舍五入到三位有效数字，并以 $\\mathrm{mm\\,s^{-1}}$ 为单位表示最终的沉降速率。根据给定的值和所述的不稳定条件，简要说明哪个阻力控制着 $V_{d}$ 的大小，并解释原因。",
            "solution": "该问题要求使用串联阻力模型推导和评估臭氧的沉降速率 $V_d$。该模型将沉降过程概念化为一系列输送和吸收路径，每个路径都有一个相关的阻力。沉降的总阻力是串联排列的各个路径阻力之和，类似于电阻的串联。\n\n设 $C_r$ 为参考高度处的臭氧浓度。设 $C_s$ 为湍流地表层和准层流子层界面处的臭氧浓度。设 $C_0$ 为有效表面处，即吸收发生前的臭氧浓度。臭氧的最终汇在地表元素（例如，气孔、土壤）内部，那里的浓度假定为零。在所述的稳态假设下，向下通量 $F$ 在各层中是恒定的。\n\n每个路径的阻力定义为该路径上的浓度降与通量之比。我们可以为这三个串联的路径写出如下关系：\n$1$. 湍流地表层的空气动力学阻力 $r_a$：\n$$F = \\frac{C_r - C_s}{r_a}$$\n这意味着该层的浓度降为 $\\Delta C_a = C_r - C_s = F r_a$。\n\n$2$. 准层流子层阻力 $r_b$：\n$$F = \\frac{C_s - C_0}{r_b}$$\n这意味着该层的浓度降为 $\\Delta C_b = C_s - C_0 = F r_b$。\n\n$3$. 地表吸收阻力 $r_c$，它涵盖了所有冠层和地面的汇过程：\n$$F = \\frac{C_0 - 0}{r_c} = \\frac{C_0}{r_c}$$\n这意味着地表界面的浓度降为 $\\Delta C_c = C_0 = F r_c$。\n\n从参考高度到最终汇（浓度为零）的总浓度降为 $C_r - 0 = C_r$。由于路径是串联的，这个总浓度降是各个浓度降之和：\n$$C_r = (C_r - C_s) + (C_s - C_0) + C_0$$\n代入用通量和阻力表示的表达式：\n$$C_r = F r_a + F r_b + F r_c$$\n提取公因子，即恒定通量 $F$：\n$$C_r = F (r_a + r_b + r_c)$$\n问题通过关系式 $F = V_d C_r$ 定义了沉降速率 $V_d$。我们可以将这个定义代入上面的方程：\n$$C_r = (V_d C_r) (r_a + r_b + r_c)$$\n假设浓度 $C_r$ 不为零，我们可以方程两边同时除以 $C_r$ 来求解 $V_d$：\n$$V_d = \\frac{1}{r_a + r_b + r_c}$$\n这就是用三个阻力表示沉降速率的推导表达式。\n\n接下来，我们使用给定的数值来评估这个表达式：$r_a = 30\\,\\mathrm{s\\,m^{-1}}$，$r_b = 10\\,\\mathrm{s\\,m^{-1}}$，以及 $r_c = 100\\,\\mathrm{s\\,m^{-1}}$。\n总阻力 $R_{\\text{tot}}$ 是各个阻力之和：\n$$R_{\\text{tot}} = r_a + r_b + r_c = 30\\,\\mathrm{s\\,m^{-1}} + 10\\,\\mathrm{s\\,m^{-1}} + 100\\,\\mathrm{s\\,m^{-1}} = 140\\,\\mathrm{s\\,m^{-1}}$$\n沉降速率是总阻力的倒数：\n$$V_d = \\frac{1}{140}\\,\\mathrm{m\\,s^{-1}}$$\n为了进行数值计算并以要求的单位 $\\mathrm{mm\\,s^{-1}}$ 表示，我们进行计算和单位转换。已知 $1\\,\\mathrm{m} = 1000\\,\\mathrm{mm}$：\n$$V_d = \\left(\\frac{1}{140}\\right) \\mathrm{m\\,s^{-1}} \\times \\frac{1000\\,\\mathrm{mm}}{1\\,\\mathrm{m}} = \\frac{1000}{140}\\,\\mathrm{mm\\,s^{-1}} = \\frac{100}{14}\\,\\mathrm{mm\\,s^{-1}} = \\frac{50}{7}\\,\\mathrm{mm\\,s^{-1}}$$\n作为小数，这大约是 $7.142857...\\,\\mathrm{mm\\,s^{-1}}$。四舍五入到三位有效数字，得到：\n$$V_d \\approx 7.14\\,\\mathrm{mm\\,s^{-1}}$$\n\n最后，我们必须确定哪个阻力控制着 $V_d$ 的大小。沉降速率 $V_d$ 与总阻力 $R_{\\text{tot}} = r_a + r_b + r_c$ 成反比。因此，$V_d$ 的大小受 $R_{\\text{tot}}$ 大小的限制。和式中值最大的项对总和的贡献最大，因此成为整个过程的主要瓶颈或“控制性阻力”。\n给定值 $r_a=30\\,\\mathrm{s\\,m^{-1}}$，$r_b=10\\,\\mathrm{s\\,m^{-1}}$ 和 $r_c=100\\,\\mathrm{s\\,m^{-1}}$，地表吸收阻力 $r_c$ 是迄今为止最大的分量。它占总阻力的 $100/140 \\approx 71.4\\%$。因此，地表吸收阻力 $r_c$ 控制着沉降速率 $V_d$ 的大小。对流不稳定条件促进了强烈的湍流混合，这导致了相对较小的空气动力学阻力 $r_a$，进一步强调了由 $r_c$ 所包含的地表过程的控制作用。",
            "answer": "$$\\boxed{7.14}$$"
        },
        {
            "introduction": "在掌握了总体的电阻模型之后，这个练习将深入探讨其中一个最关键且复杂的组分：冠层表面阻力 $r_c$。你将通过此实践学习如何将叶片尺度的生物物理过程（如气孔和角质层的吸收）升尺度到整个植被冠层，这是生态系统和地球系统建模中的一项核心技能。这个练习清晰地展示了如何从微观机理出发，构建宏观模型的参数化方案 。",
            "id": "3875166",
            "problem": "一个水平均质、高冠层的落叶林在正午条件下的臭氧干沉降过程，使用电阻网络框架进行建模。叶面积指数 (LAI) 为单面叶面积指数，等于 $L = 5.0$。报告的叶片尺度水蒸气摩尔导度为：气孔路径的导度 $g_{s,w} = 0.25 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}$，角质层路径的导度 $g_{cu,w} = 0.010 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}$。假设两条路径内的传输均为扩散限制，并取在所述条件下空气中的二元分子扩散系数为 $D_{\\mathrm{H_2O}} = 2.50 \\times 10^{-5} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$ 和 $D_{\\mathrm{O_3}} = 1.50 \\times 10^{-5} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$。空气温度和压力分别为 $T = 298 \\ \\mathrm{K}$ 和 $P = 1.013 \\times 10^{5} \\ \\mathrm{Pa}$。冠层上方的空气动力学阻力为 $r_{a} = 20 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}$，冠层顶部的准层流边界层阻力为 $r_{b} = 10 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}$。在此环境下，对于臭氧而言，地表上方的重力沉降和空气中的化学损失可以忽略不计。\n\n从扩散中的基本通量-梯度关系、理想气体定律以及电阻和导度的串并联组合出发，通过将所给的水蒸气导度适当地转换为臭氧的导度，将单位从摩尔单位转换为速度单位，并从叶片尺度放大到冠层尺度，来推导臭氧的冠层表面阻力 $r_{c}$。然后利用电阻网络求出臭氧的干沉降速率 $V_{d}$。\n\n以 $\\mathrm{s} \\ \\mathrm{m}^{-1}$ 为单位报告 $r_{c}$，以 $\\mathrm{cm} \\ \\mathrm{s}^{-1}$ 为单位报告 $V_{d}$。将 $r_{c}$ 和 $V_{d}$ 均四舍五入至三位有效数字。最终答案必须以单行两个数字的形式给出，$r_{c}$ 在前，$V_{d}$ 在后。",
            "solution": "该问题要求基于一个落叶林的电阻网络模型，计算臭氧的冠层表面阻力 $r_c$ 和干沉降速率 $V_d$。求解过程首先将叶片尺度的水蒸气导度转换为臭氧的导度，然后放大到冠层水平，转换单位，最后组合各项阻力以求得沉降速率。\n\n首先，我们建立气体导度与其分子扩散系数之间的关系。对于一个受限于通过固定几何结构（如气孔）的分子扩散的传输过程，摩尔导度 $g$ 与气体的分子扩散系数 $D$ 成正比。所提供的叶片尺度水蒸气导度，$g_{s,w}$（气孔）和 $g_{cu,w}$（角质层），可以使用臭氧和水蒸气的分子扩散系数之比，即 $D_{\\mathrm{O_3}}$ 与 $D_{\\mathrm{H_2O}}$ 的比值，转换为它们对应的臭氧导度 $g_{s, \\mathrm{O_3}}$ 和 $g_{cu, \\mathrm{O_3}}$。\n\n扩散系数之比为：\n$$\n\\frac{D_{\\mathrm{O_3}}}{D_{\\mathrm{H_2O}}} = \\frac{1.50 \\times 10^{-5} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}}{2.50 \\times 10^{-5} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}} = 0.6\n$$\n利用这个比值，我们转换摩尔导度：\n臭氧的气孔导度为：\n$$\ng_{s, \\mathrm{O_3}} = g_{s,w} \\times \\frac{D_{\\mathrm{O_3}}}{D_{\\mathrm{H_2O}}} = (0.25 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}) \\times 0.6 = 0.15 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}\n$$\n臭氧的角质层导度为：\n$$\ng_{cu, \\mathrm{O_3}} = g_{cu,w} \\times \\frac{D_{\\mathrm{O_3}}}{D_{\\mathrm{H_2O}}} = (0.010 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}) \\times 0.6 = 0.006 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}\n$$\n这些导度是单位单面叶面积的导度。\n\n接下来，我们确定臭氧的总叶片尺度导度。气孔路径和角质层路径是叶片表面臭氧的并联汇。因此，它们的导度相加得到总叶片导度 $g_{leaf, \\mathrm{O_3}}$：\n$$\ng_{leaf, \\mathrm{O_3}} = g_{s, \\mathrm{O_3}} + g_{cu, \\mathrm{O_3}} = 0.15 + 0.006 = 0.156 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}\n$$\n\n这个叶片尺度的导度必须放大到冠层水平。这通过将叶片尺度导度乘以叶面积指数 $L=5.0$ 来实现。这样可以得到单位地面面积的总冠层摩尔导度 $G_{c,m}$：\n$$\nG_{c,m} = g_{leaf, \\mathrm{O_3}} \\times L = (0.156 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}) \\times 5.0 = 0.78 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}\n$$\n\n问题要求阻力的单位为速度单位（$\\mathrm{s} \\ \\mathrm{m}^{-1}$），因此我们必须将摩尔导度 $G_{c,m}$（它将摩尔通量与摩尔分数梯度关联起来）转换为速度单位的导度 $G_{c,v}$（它将摩尔通量与摩尔浓度梯度关联起来）。其关系为 $G_{c,v} = G_{c,m} / C_{air}$，其中 $C_{air}$ 是空气的摩尔密度。使用理想气体定律 $P = C_{air}RT$，我们得到 $C_{air} = P/(RT)$。所给的常数是空气压力 $P = 1.013 \\times 10^{5} \\ \\mathrm{Pa}$，空气温度 $T = 298 \\ \\mathrm{K}$，以及普适气体常数 $R = 8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$。\n\n冠层阻力 $r_c$ 是速度单位下冠层导数的倒数（$r_c = 1/G_{c,v}$）。结合这些关系，我们得到：\n$$\nr_c = \\frac{1}{G_{c,v}} = \\frac{C_{air}}{G_{c,m}} = \\frac{P}{R T G_{c,m}}\n$$\n代入数值：\n$$\nr_c = \\frac{1.013 \\times 10^{5} \\ \\mathrm{Pa}}{(8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1})(298 \\ \\mathrm{K})(0.78 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1})} \\approx 52.419 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}\n$$\n四舍五入到三位有效数字，冠层表面阻力为 $r_c = 52.4 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}$。\n\n最后，我们计算干沉降速率 $V_d$。在串联电阻模型中，总沉降阻力 $r_{tot}$ 是空气动力学阻力（$r_a$）、准层流边界层阻力（$r_b$）和冠层表面阻力（$r_c$）之和：\n$$\nr_{tot} = r_a + r_b + r_c\n$$\n使用给定的值 $r_a = 20 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}$ 和 $r_b = 10 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}$，以及我们计算出的 $r_c$ 值：\n$$\nr_{tot} = 20 \\ \\mathrm{s} \\ \\mathrm{m}^{-1} + 10 \\ \\mathrm{s} \\ \\mathrm{m}^{-1} + 52.419 \\ \\mathrm{s} \\ \\mathrm{m}^{-1} = 82.419 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}\n$$\n\n干沉降速率 $V_d$ 定义为总阻力的倒数：\n$$\nV_d = \\frac{1}{r_{tot}} = \\frac{1}{82.419 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}} \\approx 0.012133 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n问题要求 $V_d$ 的单位是 $\\mathrm{cm} \\ \\mathrm{s}^{-1}$。我们进行单位换算：\n$$\nV_d = 0.012133 \\ \\mathrm{m} \\ \\mathrm{s}^{-1} \\times \\frac{100 \\ \\mathrm{cm}}{1 \\ \\mathrm{m}} \\approx 1.2133 \\ \\mathrm{cm} \\ \\mathrm{s}^{-1}\n$$\n四舍五入到三位有效数字，干沉降速率为 $V_d = 1.21 \\ \\mathrm{cm} \\ \\mathrm{s}^{-1}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 52.4  1.21 \\end{pmatrix}}$$"
        },
        {
            "introduction": "为了完整地构建沉降模型，我们最后一个练习聚焦于空气动力学阻力 $r_a$ 的计算。这个练习将沉降模型与基础的微气象学理论联系起来，展示了大气稳定度如何通过影响湍流混合来改变物质的输送效率。通过基于莫宁-奥布霍夫相似理论编写一个数值计算程序，你将获得宝贵的建模实践经验，并深刻理解大气物理过程在沉降模型中的作用 。",
            "id": "3875157",
            "problem": "您正在使用莫宁-奥布霍夫相似性理论的近地表层框架来模拟近地表干沉降。对于大气地表层中的被动标量，粗糙度长度 $z_0$ 和测量高度 $z$ 之间的空气动力学阻力 $r_a$ 由通量-梯度关系和涡动扩散系数 $K_h(z)$ 定义。假设以下基本基础和参数化方案，所有这些都在微气象学中经过了充分检验：\n\n- 摩擦速度 $u_\\* > 0$ 已知。\n- 冯·卡门常数为 $\\kappa = 0.4$。\n- 奥布霍夫长度 $L$ 是有限的，可以是正值（稳定）、负值（不稳定）或绝对值非常大（近中性）。\n- 无量纲稳定度参数为 $\\zeta = z/L$。\n- 地表层中热量的涡动扩散系数（此处用作被动标量的代理）为 $K_h(z) = \\dfrac{\\kappa\\,u_\\*\\,z}{\\phi_h(\\zeta)}$。\n- 热量的无量纲梯度函数 $\\phi_h(\\zeta)$ 遵循 Businger–Dyer 公式：\n  - 稳定层结 ($\\zeta \\ge 0$): $\\phi_h(\\zeta) = 1 + 5\\,\\zeta$。\n  - 不稳定层结 ($\\zeta  0$): $\\phi_h(\\zeta) = \\left(1 - 16\\,\\zeta\\right)^{-1/2}$。\n\n从通量-梯度关系和作为涡动扩散系数倒数的垂直积分的空气动力学阻力定义出发，推导一个与上述参数化方案一致的 $r_a$ 表达式。您的推导必须从涡动扩散系数和通量-梯度关系的基本定义开始，并且不得调用任何预先记忆的 $r_a$ 简化公式。然后，实现一个数值算法，通过使用指定的 $\\phi_h(\\zeta)$ 计算从 $z_0$ 到 $z$ 的所需垂直积分来计算 $r_a$。\n\n科学和数值要求：\n\n- 将 $r_a$ 的积分视为自变量 $s$ 在 $z_0$ 到 $z$ 范围内的积分，其中被积函数内的 $\\zeta = s/L$。\n- 如果 $|L|$ 非常大（近中性），则该公式必须平滑地回归到中性极限，此时 $\\phi_h(0) = 1$。\n- 将最终的空气动力学阻力 $r_a$ 以秒/米（$\\mathrm{s}\\,\\mathrm{m}^{-1}$）为单位表示，并四舍五入到六位小数。\n\n基于您推导的积分和指定的 $\\phi_h(\\zeta)$，从第一性原理出发，讨论 $r_a$ 对奥布霍夫长度 $L$ 的敏感性，说明在 $u_\\*$, $z$ 和 $z_0$ 保持不变的情况下，$L$ 的变化如何影响 $r_a$ 的大小。\n\n将您的解决方案实现为一个完整的、可运行的程序，为以下测试套件计算 $r_a$。每个测试用例提供 $(u_\\*, z, z_0, L)$，单位为 $(\\mathrm{m}\\,\\mathrm{s}^{-1}, \\mathrm{m}, \\mathrm{m}, \\mathrm{m})$：\n\n- 测试用例 1 (中度稳定，正常路径): $u_\\* = 0.4$, $z = 10$, $z_0 = 0.1$, $L = 100$。\n- 测试用例 2 (中度不稳定): $u_\\* = 0.4$, $z = 10$, $z_0 = 0.1$, $L = -50$。\n- 测试用例 3 (近中性参考): $u_\\* = 0.4$, $z = 10$, $z_0 = 0.1$, $L = 10^9$。\n- 测试用例 4 (小 $z - z_0$ 边界情况): $u_\\* = 0.3$, $z = 0.2$, $z_0 = 0.1$, $L = 50$。\n- 测试用例 5 (强不稳定，低摩擦速度): $u_\\* = 0.1$, $z = 2$, $z_0 = 0.05$, $L = -20$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目是相应测试用例的 $r_a$ 值，单位为 $\\mathrm{s}\\,\\mathrm{m}^{-1}$，并四舍五入到六位小数（例如，$[r_{a,1},r_{a,2},r_{a,3},r_{a,4},r_{a,5}]$）。",
            "solution": "推导始于大气地表层中被动标量（例如，位温）的地表层通量-梯度关系。设垂直湍流通量用 $F$ 表示，在地表层中假定其随高度保持不变。通量-梯度关系表述为\n$$\nF = - K_h(z)\\,\\frac{\\partial \\chi}{\\partial z},\n$$\n其中 $K_h(z)$ 是热量的涡动扩散系数（此处用作标量扩散系数），$\\chi$ 代表标量。从地表（由粗糙度长度 $z_0$ 表示）到高度 $z$ 的空气动力学阻力 $r_a$ 通过以下关系定义：\n$$\nF = \\frac{\\chi(z) - \\chi_0}{r_a},\n$$\n其中 $\\chi_0$ 是代表性的地表标量值。结合这些表达式并从 $z_0$ 到 $z$ 进行积分，得到\n$$\n\\frac{\\chi(z) - \\chi_0}{F} = \\int_{z_0}^{z} \\frac{1}{K_h(s)}\\,\\mathrm{d}s,\n$$\n因此，空气动力学阻力为\n$$\nr_a = \\int_{z_0}^{z} \\frac{1}{K_h(s)}\\,\\mathrm{d}s.\n$$\n\n在莫宁-奥布霍夫相似性理论中，地表层热量的涡动扩散系数参数化为\n$$\nK_h(s) = \\frac{\\kappa\\,u_\\*\\,s}{\\phi_h(\\zeta)},\n$$\n其中 $\\kappa$ 是冯·卡门常数，$u_\\*$ 是摩擦速度，$s$ 是高度变量（此处使用以避免与积分上限 $z$ 混淆），$\\zeta = s/L$ 是无量纲稳定度参数，$L$ 是奥布霍夫长度。将此参数化方案代入 $r_a$ 的积分中，得到\n$$\nr_a = \\int_{z_0}^{z} \\frac{\\phi_h\\!\\left(\\frac{s}{L}\\right)}{\\kappa\\,u_\\*\\,s}\\,\\mathrm{d}s.\n$$\n\n函数 $\\phi_h(\\zeta)$ 由 Businger–Dyer 公式指定：\n- 对于稳定层结 ($\\zeta \\ge 0$)，\n$$\n\\phi_h(\\zeta) = 1 + 5\\,\\zeta.\n$$\n- 对于不稳定层结 ($\\zeta  0$)，\n$$\n\\phi_h(\\zeta) = \\left(1 - 16\\,\\zeta\\right)^{-1/2}.\n$$\n\n该积分是与给定参数化方案一致的空气动力学阻力的基本表达式。在某些情况下可以进行解析求解，但通常需要进行数值求解。我们强调两种极限情况：\n\n- 中性极限：当 $|L| \\to \\infty$ 时，$\\zeta \\to 0$ 且 $\\phi_h(0) \\to 1$，因此\n$$\nr_a \\to \\int_{z_0}^{z} \\frac{1}{\\kappa\\,u_\\*\\,s}\\,\\mathrm{d}s = \\frac{1}{\\kappa\\,u_\\*}\\,\\ln\\!\\left(\\frac{z}{z_0}\\right).\n$$\n\n- 稳定情况 ($\\zeta \\ge 0$)：当 $\\phi_h(\\zeta) = 1 + 5\\,\\zeta = 1 + 5\\,\\frac{s}{L}$ 时，被积函数变为\n$$\n\\frac{\\phi_h\\!\\left(\\frac{s}{L}\\right)}{\\kappa\\,u_\\*\\,s} = \\frac{1}{\\kappa\\,u_\\*\\,s} + \\frac{5}{\\kappa\\,u_\\*\\,L},\n$$\n积分结果为\n$$\nr_a = \\frac{1}{\\kappa\\,u_\\*}\\,\\ln\\!\\left(\\frac{z}{z_0}\\right) + \\frac{5}{\\kappa\\,u_\\*\\,L}\\,(z - z_0).\n$$\n这明确显示了在稳定层结下，除了中性值之外所产生的额外阻力。\n\n对于不稳定层结，当 $\\phi_h(\\zeta) = \\left(1 - 16\\,\\zeta\\right)^{-1/2}$ 时，所得积分如果直接写成上述形式，则不能简化为关于 $s$ 的简单初等函数，因此采用数值方法进行求解既方便又稳健。\n\n算法设计：\n\n- 根据指定的分段 Businger–Dyer 形式定义函数 $\\phi_h(\\zeta)$。\n- 对于给定的 $(u_\\*, z, z_0, L)$，定义被积函数\n$$\nI(s; u_\\*, L) = \\frac{\\phi_h\\!\\left(\\frac{s}{L}\\right)}{\\kappa\\,u_\\*\\,s},\n$$\n并计算\n$$\nr_a(u_\\*, z, z_0, L) = \\int_{z_0}^{z} I(s; u_\\*, L)\\,\\mathrm{d}s.\n$$\n- 使用自适应求积方法实现数值积分。对于大的 $|L|$（近中性），数值计算结果会平滑地逼近中性结果；严格来说不需要特殊处理，但在实践中可以对极大的 $|L|$ 设置上限，以避免不必要的舍入误差。\n\n对 $L$ 的敏感性：\n\n通过检查被积函数可以理解 $r_a$ 对 $L$ 的敏感性：\n$$\nI(s; u_\\*, L) = \\frac{\\phi_h\\!\\left(\\frac{s}{L}\\right)}{\\kappa\\,u_\\*\\,s}.\n$$\n- 稳定层结 ($L > 0$) 会在给定 $s$ 的情况下增加 $\\zeta$ 并使 $\\phi_h(\\zeta)$ 大于 1，从而与中性情况相比增加了 $I(s)$，并因此增加了相对于中性值的 $r_a$。从稳定的解析表达式\n$$\nr_a = \\frac{1}{\\kappa\\,u_\\*}\\,\\ln\\!\\left(\\frac{z}{z_0}\\right) + \\frac{5}{\\kappa\\,u_\\*\\,L}\\,(z - z_0),\n$$\n关于 $L$ 的偏导数为\n$$\n\\frac{\\partial r_a}{\\partial L} = -\\frac{5}{\\kappa\\,u_\\*\\,L^2}\\,(z - z_0)  0 \\quad \\text{for } L > 0,\n$$\n这表明随着 $L$ 的增加（稳定性减弱，趋向中性），$r_a$ 会向中性值减小。\n\n- 不稳定层结 ($L  0$) 导致 $\\zeta  0$ 和 $\\phi_h(\\zeta)  1$，与中性情况相比，这会减小 $I(s)$，从而将 $r_a$ 减小到中性值以下。随着 $|L|$ 的减小（不稳定性更强），由于湍流混合增强，这种效应会加剧，从而产生逐渐减小的 $r_a$。\n\n- 近中性 ($|L| \\to \\infty$) 导致 $\\phi_h(\\zeta) \\to 1$，并恢复到中性对数形式。因此，通常存在以下大小关系：\n$$\nr_a(L>0) > r_a(|L| \\to \\infty) > r_a(L0)\n$$\n对于固定的 $u_\\*$、$z$ 和 $z_0$。\n\n实现说明：\n\n- 使用 $\\kappa = 0.4$ 并以高精度容差进行数值积分计算。\n- 按要求将每个结果四舍五入到六位小数。\n- 为测试用例生成指定的单行输出，格式为以逗号分隔的列表，表示以 $\\mathrm{s}\\,\\mathrm{m}^{-1}$ 为单位的 $r_a$：\n  - $(u_\\*, z, z_0, L) = (0.4, 10, 0.1, 100)$,\n  - $(u_\\*, z, z_0, L) = (0.4, 10, 0.1, -50)$,\n  - $(u_\\*, z, z_0, L) = (0.4, 10, 0.1, 10^9)$,\n  - $(u_\\*, z, z_0, L) = (0.3, 0.2, 0.1, 50)$,\n  - $(u_\\*, z, z_0, L) = (0.1, 2, 0.05, -20)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\nKAPPA = 0.4  # von Kármán constant\n\ndef phi_h(zeta: float) - float:\n    \"\"\"\n    Businger-Dyer stability function for heat:\n    - Stable (zeta = 0): phi_h = 1 + 5*zeta\n    - Unstable (zeta  0): phi_h = (1 - 16*zeta)^(-0.5)\n    \"\"\"\n    if zeta = 0.0:\n        return 1.0 + 5.0 * zeta\n    else:\n        return (1.0 - 16.0 * zeta) ** (-0.5)\n\ndef integrand(s: float, u_star: float, L: float) - float:\n    \"\"\"\n    Integrand for aerodynamic resistance:\n    I(s) = phi_h(s/L) / (kappa * u_star * s)\n    Handles near-neutral by evaluating directly; for very large |L|, zeta ~ 0.\n    \"\"\"\n    # Avoid division by zero; s is always = z0  0 per test suite.\n    if np.isinf(L):\n        ph = 1.0\n    else:\n        # For extremely large |L|, zeta ~ 0 - phi_h ~ 1; but compute directly\n        zeta = s / L\n        # For very large L, zeta may underflow to 0 in float; phi_h(0) = 1\n        # Keep robust: if |zeta|  1e-12, treat as neutral.\n        if abs(zeta)  1e-12:\n            ph = 1.0\n        else:\n            ph = phi_h(zeta)\n    return ph / (KAPPA * u_star * s)\n\ndef aerodynamic_resistance(u_star: float, z: float, z0: float, L: float) - float:\n    \"\"\"\n    Compute r_a by numerically integrating integrand from z0 to z.\n    \"\"\"\n    # Ensure valid input\n    if u_star = 0.0:\n        raise ValueError(\"u_star must be positive.\")\n    if z = z0:\n        # Zero or negative layer thickness yields zero resistance increment\n        # Here we handle z == z0 explicitly\n        return 0.0\n\n    # Integrate using adaptive quadrature\n    # Use absolute and relative tolerances for robust accuracy\n    result, _ = quad(integrand, z0, z, args=(u_star, L), epsabs=1e-10, epsrel=1e-10, limit=200)\n    return result\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (u_star [m/s], z [m], z0 [m], L [m])\n    test_cases = [\n        (0.4, 10.0, 0.1, 100.0),         # Moderately stable, happy path\n        (0.4, 10.0, 0.1, -50.0),         # Moderately unstable\n        (0.4, 10.0, 0.1, 1.0e9),         # Near-neutral (large L)\n        (0.3, 0.2, 0.1, 50.0),           # Small z - z0 boundary case\n        (0.1, 2.0, 0.05, -20.0),         # Strongly unstable, low u_star\n    ]\n\n    results = []\n    for u_star, z, z0, L in test_cases:\n        ra = aerodynamic_resistance(u_star, z, z0, L)\n        # Round to six decimal places as required\n        results.append(f\"{ra:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}