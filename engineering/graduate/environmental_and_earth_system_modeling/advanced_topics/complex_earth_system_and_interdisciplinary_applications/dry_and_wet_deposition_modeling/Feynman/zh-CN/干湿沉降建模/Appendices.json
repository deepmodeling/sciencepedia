{
    "hands_on_practices": [
        {
            "introduction": "干沉降建模通常始于一个强大而直观的类比：电阻串联模型。该模型将污染物从大气传输到地表的复杂过程简化为一系列独立的步骤，包括湍流输运、准层流边界层扩散和地表吸收，每个步骤都由一个相应的“阻力”来表征。本练习将通过一个典型的臭氧沉降场景，帮助你建立这个基础框架，推导总沉降速率与各部分阻力之间的关系，并学会识别整个过程中的关键限制环节 。",
            "id": "3875144",
            "problem": "一个含有臭氧的气块，在稳态、白天的对流不稳定条件下，被输送到一个水平均匀的植被表面上。假设在地表层内没有臭氧的化学产生或损失，因此垂直湍流通量随高度保持不变。设参考高度处的臭氧浓度为$C_{r}$，并将恒定的向下的通量表示为$F$（向下为正）。在大叶模型下，参考高度与地表内的最终汇之间存在三个串联的交换路径：跨越湍流地表层的空气动力学路径、邻近地表的准层流子层，以及代表冠层和地面汇的地表吸收路径。对于每个路径，将阻力定义为该路径上的浓度降与通过它的通量之比，即空气动力学路径的阻力为$r_{a}$，准层流路径的阻力为$r_{b}$，地表吸收路径的阻力为$r_{c}$，单位为$\\mathrm{s\\,m^{-1}}$。沉降速率$V_{d}$由通量-浓度关系$F = V_{d}\\,C_{r}$定义。利用稳态质量守恒和上述阻力定义，推导出用$r_{a}$、$r_{b}$和$r_{c}$表示的$V_{d}$的表达式，然后对臭氧进行计算，其中$r_{a}=30\\,\\mathrm{s\\,m^{-1}}$，$r_{b}=10\\,\\mathrm{s\\,m^{-1}}$，$r_{c}=100\\,\\mathrm{s\\,m^{-1}}$。将您的数值结果四舍五入到三位有效数字，并以$\\mathrm{mm\\,s^{-1}}$为单位表示最终的沉降速率。根据给定值和所述的不稳定条件，简要说明哪个阻力控制着$V_{d}$的大小及其原因。",
            "solution": "该问题要求使用串联阻力模型推导和计算臭氧的沉降速率$V_d$。该模型将沉降过程概念化为一系列输送和吸收路径，每个路径都有一个相关的阻力。沉降的总阻力是串联排列的各路径独立阻力的总和，类似于电阻串联。\n\n设$C_r$为参考高度处的臭氧浓度。设$C_s$为湍流地表层与准层流子层界面处的臭氧浓度。设$C_0$为有效表面处，即吸收发生前的臭氧浓度。臭氧的最终汇在地表元素（如气孔、土壤）内部，其浓度假定为零。在所述的稳态假设下，向下的通量$F$在所有层中都是恒定的。\n\n每个路径的阻力定义为该路径上的浓度降与通量之比。我们可以为这三个串联路径写出如下关系：\n$1$. 湍流地表层的空气动力学阻力$r_a$：\n$$F = \\frac{C_r - C_s}{r_a}$$\n这意味着该层的浓度降为 $\\Delta C_a = C_r - C_s = F r_a$。\n\n$2$. 准层流子层阻力$r_b$：\n$$F = \\frac{C_s - C_0}{r_b}$$\n这意味着该层的浓度降为 $\\Delta C_b = C_s - C_0 = F r_b$。\n\n$3$. 地表吸收阻力$r_c$，它包括了所有冠层和地面的汇过程：\n$$F = \\frac{C_0 - 0}{r_c} = \\frac{C_0}{r_c}$$\n这意味着跨越地表界面的浓度降为 $\\Delta C_c = C_0 = F r_c$。\n\n从参考高度到最终汇（浓度为零）的总浓度降为 $C_r - 0 = C_r$。由于这些路径是串联的，这个总浓度降是各个浓度降的总和：\n$$C_r = (C_r - C_s) + (C_s - C_0) + C_0$$\n代入以通量和阻力表示的表达式：\n$$C_r = F r_a + F r_b + F r_c$$\n提取公因子，即恒定通量$F$：\n$$C_r = F (r_a + r_b + r_c)$$\n问题通过关系式 $F = V_d C_r$ 定义了沉降速率$V_d$。我们可以将这个定义代入上面的方程：\n$$C_r = (V_d C_r) (r_a + r_b + r_c)$$\n假设浓度$C_r$不为零，我们可以将方程两边同除以$C_r$来求解$V_d$：\n$$V_d = \\frac{1}{r_a + r_b + r_c}$$\n这就是用三个阻力表示的沉降速率的推导表达式。\n\n接下来，我们使用给定的数值计算这个表达式：$r_a = 30\\,\\mathrm{s\\,m^{-1}}$，$r_b = 10\\,\\mathrm{s\\,m^{-1}}$，$r_c = 100\\,\\mathrm{s\\,m^{-1}}$。\n总阻力$R_{\\text{tot}}$是各个独立阻力的和：\n$$R_{\\text{tot}} = r_a + r_b + r_c = 30\\,\\mathrm{s\\,m^{-1}} + 10\\,\\mathrm{s\\,m^{-1}} + 100\\,\\mathrm{s\\,m^{-1}} = 140\\,\\mathrm{s\\,m^{-1}}$$\n沉降速率是总阻力的倒数：\n$$V_d = \\frac{1}{140}\\,\\mathrm{m\\,s^{-1}}$$\n为了进行数值计算并以要求的单位$\\mathrm{mm\\,s^{-1}}$表示，我们进行计算和单位转换。已知$1\\,\\mathrm{m} = 1000\\,\\mathrm{mm}$：\n$$V_d = \\left(\\frac{1}{140}\\right) \\mathrm{m\\,s^{-1}} \\times \\frac{1000\\,\\mathrm{mm}}{1\\,\\mathrm{m}} = \\frac{1000}{140}\\,\\mathrm{mm\\,s^{-1}} = \\frac{100}{14}\\,\\mathrm{mm\\,s^{-1}} = \\frac{50}{7}\\,\\mathrm{mm\\,s^{-1}}$$\n小数形式约为$7.142857...\\,\\mathrm{mm\\,s^{-1}}$。四舍五入到三位有效数字，得到：\n$$V_d \\approx 7.14\\,\\mathrm{mm\\,s^{-1}}$$\n\n最后，我们必须确定哪个阻力控制着$V_d$的大小。沉降速率$V_d$与总阻力$R_{\\text{tot}} = r_a + r_b + r_c$成反比。因此，$V_d$的大小受$R_{\\text{tot}}$大小的限制。求和项中值最大的项对总和的贡献最大，因此成为整个过程的主要瓶颈或“控制性阻力”。\n给定值$r_a=30\\,\\mathrm{s\\,m^{-1}}$，$r_b=10\\,\\mathrm{s\\,m^{-1}}$，$r_c=100\\,\\mathrm{s\\,m^{-1}}$，地表吸收阻力$r_c$是目前为止最大的组成部分。它占总阻力的$100/140 \\approx 71.4\\%$。因此，地表吸收阻力$r_c$控制着沉降速率$V_d$的大小。对流不稳定的条件促进了强烈的湍流混合，导致空气动力学阻力$r_a$相对较小，这进一步强调了由$r_c$所包含的地表过程的控制作用。",
            "answer": "$$\\boxed{7.14}$$"
        },
        {
            "introduction": "在掌握了基础的“大叶”电阻模型后，下一步是深入探究模型中最复杂的组成部分之一：地表阻力 $r_c$。这一项并非一个简单的常数，而是代表了植被冠层复杂的生物物理过程，例如通过叶片气孔的吸收和角质层的沉降。本练习将指导你如何从叶片尺度的生理参数出发，通过考虑不同气体分子扩散速率的差异，并利用叶面积指数（LAI）进行升尺度计算，从而构建一个更具机理性的冠层地表阻力模型 。",
            "id": "3875166",
            "problem": "一个在正午条件下的水平均质高冠阔叶林，使用臭氧干沉降的电阻网络框架进行建模。叶面积指数 (LAI) 为单面，等于 $L = 5.0$。报告的叶片尺度水蒸气摩尔导度为：气孔通道的导度 $g_{s,w} = 0.25 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}$，角质层通道的导度 $g_{cu,w} = 0.010 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}$。假设两个通道内的传输均为扩散限制，并取所述条件下空气中的二元分子扩散系数为 $D_{\\mathrm{H_2O}} = 2.50 \\times 10^{-5} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$ 和 $D_{\\mathrm{O_3}} = 1.50 \\times 10^{-5} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}$。空气温度为 $T = 298 \\ \\mathrm{K}$，压力为 $P = 1.013 \\times 10^{5} \\ \\mathrm{Pa}$。冠层上方的空气动力学阻力为 $r_{a} = 20 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}$，冠层顶部的准层流边界层阻力为 $r_{b} = 10 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}$。在此环境下，臭氧的重力沉降和地表上方的空中化学损失可忽略不计。\n\n从扩散的基本通量-梯度关系、理想气体定律以及阻力和导度的串并联组合出发，通过将所给的水蒸气导度适当转换为臭氧导度，将单位从摩尔单位转换为速度单位，并从叶片尺度放大到冠层尺度，推导出臭氧的冠层表面阻力 $r_{c}$。然后利用电阻网络求出臭氧的干沉降速率 $V_{d}$。\n\n以 $\\mathrm{s} \\ \\mathrm{m}^{-1}$ 为单位报告 $r_{c}$，以 $\\mathrm{cm} \\ \\mathrm{s}^{-1}$ 为单位报告 $V_{d}$。将 $r_{c}$ 和 $V_{d}$ 均四舍五入至三位有效数字。最终答案必须以单行两个数字的形式给出，$r_{c}$ 在前，$V_{d}$ 在后。",
            "solution": "问题要求基于一个阔叶林的电阻网络模型，计算臭氧的冠层表面阻力 $r_c$ 和干沉降速率 $V_d$。求解过程首先将叶片尺度的水蒸气导度转换为臭氧导度，然后放大到冠层水平，转换单位，最后组合各项阻力以求得沉降速率。\n\n首先，我们建立气体导度与其分子扩散系数之间的关系。对于一个受限于通过固定几何形状（如气孔）的分子扩散的传输过程，摩尔导度 $g$ 与该气体的分子扩散系数 $D$ 成正比。所提供的叶片尺度水蒸气导度 $g_{s,w}$（气孔）和 $g_{cu,w}$（角质层）可以通过使用它们的分子扩散系数比率，转换为对应的臭氧导度 $g_{s, \\mathrm{O_3}}$ 和 $g_{cu, \\mathrm{O_3}}$。扩散系数 $D_{\\mathrm{O_3}}$ 和 $D_{\\mathrm{H_2O}}$ 的比值：\n\n扩散系数的比率为：\n$$\n\\frac{D_{\\mathrm{O_3}}}{D_{\\mathrm{H_2O}}} = \\frac{1.50 \\times 10^{-5} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}}{2.50 \\times 10^{-5} \\ \\mathrm{m}^{2} \\ \\mathrm{s}^{-1}} = 0.6\n$$\n使用该比率，我们转换摩尔导度：\n臭氧的气孔导度为：\n$$\ng_{s, \\mathrm{O_3}} = g_{s,w} \\times \\frac{D_{\\mathrm{O_3}}}{D_{\\mathrm{H_2O}}} = (0.25 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}) \\times 0.6 = 0.15 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}\n$$\n臭氧的角质层导度为：\n$$\ng_{cu, \\mathrm{O_3}} = g_{cu,w} \\times \\frac{D_{\\mathrm{O_3}}}{D_{\\mathrm{H_2O}}} = (0.010 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}) \\times 0.6 = 0.006 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}\n$$\n这些导度是单位单面叶面积的导度。\n\n接下来，我们确定臭氧的总叶片尺度导度。气孔和角质层通道是叶片表面臭氧的并联汇。因此，它们的导度相加得到总叶片导度 $g_{leaf, \\mathrm{O_3}}$：\n$$\ng_{leaf, \\mathrm{O_3}} = g_{s, \\mathrm{O_3}} + g_{cu, \\mathrm{O_3}} = 0.15 + 0.006 = 0.156 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}\n$$\n\n必须将此叶片尺度导度放大到冠层水平。这通过将叶片尺度导度乘以叶面积指数 $L=5.0$ 来实现。这样可以得到以摩尔为单位的总冠层导度 $G_{c,m}$（单位地表面积）：\n$$\nG_{c,m} = g_{leaf, \\mathrm{O_3}} \\times L = (0.156 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}) \\times 5.0 = 0.78 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1}\n$$\n\n问题要求阻力以速度单位（$\\mathrm{s} \\ \\mathrm{m}^{-1}$）表示，因此我们必须将摩尔导度 $G_{c,m}$（它将摩尔通量与摩尔分数梯度联系起来）转换为速度单位的导度 $G_{c,v}$（它将摩尔通量与摩尔浓度梯度联系起来）。其关系为 $G_{c,v} = G_{c,m} / C_{air}$，其中 $C_{air}$ 是空气的摩尔密度。使用理想气体定律 $P = C_{air}RT$，我们得到 $C_{air} = P/(RT)$。提供的常数包括气压 $P = 1.013 \\times 10^{5} \\ \\mathrm{Pa}$、气温 $T = 298 \\ \\mathrm{K}$ 和普适气体常数 $R = 8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$。\n\n冠层阻力 $r_c$ 是以速度为单位的冠层导度的倒数（$r_c = 1/G_{c,v}$）。结合这些关系，我们得到：\n$$\nr_c = \\frac{1}{G_{c,v}} = \\frac{C_{air}}{G_{c,m}} = \\frac{P}{R T G_{c,m}}\n$$\n代入数值：\n$$\nr_c = \\frac{1.013 \\times 10^{5} \\ \\mathrm{Pa}}{(8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1})(298 \\ \\mathrm{K})(0.78 \\ \\mathrm{mol} \\ \\mathrm{m}^{-2} \\ \\mathrm{s}^{-1})} \\approx 52.419 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}\n$$\n四舍五入到三位有效数字，冠层表面阻力为 $r_c = 52.4 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}$。\n\n最后，我们计算干沉降速率 $V_d$。在串联电阻模型中，总沉降阻力 $r_{tot}$ 是空气动力学阻力（$r_a$）、准层流边界层阻力（$r_b$）和冠层表面阻力（$r_c$）之和：\n$$\nr_{tot} = r_a + r_b + r_c\n$$\n使用给定值 $r_a = 20 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}$ 和 $r_b = 10 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}$，以及我们计算出的 $r_c$ 值：\n$$\nr_{tot} = 20 \\ \\mathrm{s} \\ \\mathrm{m}^{-1} + 10 \\ \\mathrm{s} \\ \\mathrm{m}^{-1} + 52.419 \\ \\mathrm{s} \\ \\mathrm{m}^{-1} = 82.419 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}\n$$\n\n干沉降速率 $V_d$ 定义为总阻力的倒数：\n$$\nV_d = \\frac{1}{r_{tot}} = \\frac{1}{82.419 \\ \\mathrm{s} \\ \\mathrm{m}^{-1}} \\approx 0.012133 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n问题要求 $V_d$ 以 $\\mathrm{cm} \\ \\mathrm{s}^{-1}$ 为单位。我们进行单位转换：\n$$\nV_d = 0.012133 \\ \\mathrm{m} \\ \\mathrm{s}^{-1} \\times \\frac{100 \\ \\mathrm{cm}}{1 \\ \\mathrm{m}} \\approx 1.2133 \\ \\mathrm{cm} \\ \\mathrm{s}^{-1}\n$$\n四舍五入到三位有效数字，干沉降速率为 $V_d = 1.21 \\ \\mathrm{cm} \\ \\mathrm{s}^{-1}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 52.4  1.21 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在详细解析了地表过程之后，我们现在将目光转向大气传输路径本身，即空气动力学阻力 $r_a$。该阻力的大小取决于大气近地表的湍流混合强度，而湍流强度又受到风速和大气稳定度的共同控制。本高级练习将引入微气象学中的莫宁-奥布霍夫相似理论（Monin-Obukhov Similarity Theory），要求你从最基本的通量-梯度关系出发，推导并以编程方式计算在不同大气稳定度条件下（从稳定到不稳定）的空气动力学阻力，从而将沉降模型与真实的大气物理过程紧密联系起来 。",
            "id": "3875157",
            "problem": "您正在使用莫宁-奥布霍夫（Monin–Obukhov）相似性理论的地表层框架来模拟近地表干沉降。在大气地表层中，一个被动标量在粗糙度长度 $z_0$ 和测量高度 $z$ 之间的空气动力学阻力 $r_a$ 是由通量-梯度关系和涡动扩散率 $K_h(z)$ 定义的。假设以下基本基础和参数化方案，所有这些都在微气象学中得到了充分的检验：\n\n- 摩擦速度 $u_\\* > 0$ 是给定的。\n- 冯·卡门（von Kármán）常数为 $\\kappa = 0.4$。\n- 奥布霍夫（Obukhov）长度 $L$ 是有限的，并且可以是正值（稳定）、负值（不稳定）或绝对值非常大（近中性）。\n- 无量纲稳定性参数为 $\\zeta = z/L$。\n- 地表层中的热量涡动扩散率（在此用作被动标量的代理）为 $K_h(z) = \\dfrac{\\kappa\\,u_\\*\\,z}{\\phi_h(\\zeta)}$。\n- 热量的无量纲梯度函数 $\\phi_h(\\zeta)$ 遵循 Businger–Dyer 公式：\n  - 稳定层结（$\\zeta \\ge 0$）：$\\phi_h(\\zeta) = 1 + 5\\,\\zeta$。\n  - 不稳定层结（$\\zeta  0$）：$\\phi_h(\\zeta) = \\left(1 - 16\\,\\zeta\\right)^{-1/2}$。\n\n从通量-梯度关系以及空气动力学阻力是涡动扩散率倒数的垂直积分这一定义出发，推导出一个与上述参数化方案一致的 $r_a$ 表达式。您的推导必须从涡动扩散率和通量-梯度关系的基本定义开始，并且过程中不得引用任何预先记下的 $r_a$ 简化公式。然后，实现一个数值算法，通过使用指定的 $\\phi_h(\\zeta)$ 计算从 $z_0$ 到 $z$ 的所需垂直积分来求出 $r_a$。\n\n科学和数值要求：\n\n- 将 $r_a$ 的积分视为自变量 $s$ 从 $z_0$ 到 $z$ 的积分，其中被积函数内的 $\\zeta = s/L$。\n- 如果 $|L|$ 非常大（近中性），则该公式必须平滑地回归到中性极限，此时 $\\phi_h(0) = 1$。\n- 将最终的空气动力学阻力 $r_a$ 以秒/米（$\\mathrm{s}\\,\\mathrm{m}^{-1}$）为单位表示，并四舍五入到六位小数。\n\n从第一性原理出发，根据您推导的积分和指定的 $\\phi_h(\\zeta)$，讨论 $r_a$ 对奥布霍夫长度 $L$ 的敏感性，并说明在 $u_\\*$, $z$ 和 $z_0$ 保持不变的情况下，$L$ 的变化如何影响 $r_a$ 的大小。\n\n将您的解决方案实现为一个完整的、可运行的程序，为以下测试套件计算 $r_a$。每个测试用例提供 $(u_\\*, z, z_0, L)$，单位为 $(\\mathrm{m}\\,\\mathrm{s}^{-1}, \\mathrm{m}, \\mathrm{m}, \\mathrm{m})$：\n\n- 测试用例1（中等稳定，常规路径）：$u_\\* = 0.4$, $z = 10$, $z_0 = 0.1$, $L = 100$。\n- 测试用例2（中等不稳定）：$u_\\* = 0.4$, $z = 10$, $z_0 = 0.1$, $L = -50$。\n- 测试用例3（近中性参考）：$u_\\* = 0.4$, $z = 10$, $z_0 = 0.1$, $L = 10^9$。\n- 测试用例4（$z - z_0$ 很小的边界情况）：$u_\\* = 0.3$, $z = 0.2$, $z_0 = 0.1$, $L = 50$。\n- 测试用例5（低摩擦速度下的强不稳定）：$u_\\* = 0.1$, $z = 2$, $z_0 = 0.05$, $L = -20$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的每个条目是对应测试用例的 $r_a$ 值，单位为 $\\mathrm{s}\\,\\mathrm{m}^{-1}$，并四舍五入到六位小数（例如，$[r_{a,1},r_{a,2},r_{a,3},r_{a,4},r_{a,5}]$）。",
            "solution": "推导从大气地表层中被动标量（例如，位温）的地表层通量-梯度关系开始。设垂直湍流通量用 $F$ 表示，在地表层中，它被视为不随高度变化的常数。通量-梯度关系表述为\n$$\nF = - K_h(z)\\,\\frac{\\partial \\chi}{\\partial z},\n$$\n其中 $K_h(z)$ 是热量涡动扩散率（在此用作标量扩散率），$\\chi$ 代表该标量。从地表（由粗糙度长度 $z_0$ 代表）到高度 $z$ 的空气动力学阻力 $r_a$ 通过以下关系定义：\n$$\nF = \\frac{\\chi(z) - \\chi_0}{r_a},\n$$\n其中 $\\chi_0$ 是代表性的地表标量值。结合这些表达式并从 $z_0$ 到 $z$ 进行积分，得到\n$$\n\\frac{\\chi(z) - \\chi_0}{F} = \\int_{z_0}^{z} \\frac{1}{K_h(s)}\\,\\mathrm{d}s,\n$$\n因此空气动力学阻力为\n$$\nr_a = \\int_{z_0}^{z} \\frac{1}{K_h(s)}\\,\\mathrm{d}s.\n$$\n\n在莫宁-奥布霍夫相似性理论中，地表层的热量涡动扩散率参数化为\n$$\nK_h(s) = \\frac{\\kappa\\,u_\\*\\,s}{\\phi_h(\\zeta)},\n$$\n其中 $\\kappa$ 是冯·卡门常数，$u_\\*$ 是摩擦速度，$s$ 是高度变量（在此使用以避免与积分上限 $z$ 混淆），$\\zeta = s/L$ 是无量纲稳定性参数，$L$ 是奥布霍夫长度。将此参数化代入 $r_a$ 的积分中，得到\n$$\nr_a = \\int_{z_0}^{z} \\frac{\\phi_h\\!\\left(\\frac{s}{L}\\right)}{\\kappa\\,u_\\*\\,s}\\,\\mathrm{d}s.\n$$\n\n函数 $\\phi_h(\\zeta)$ 由 Businger–Dyer 公式指定：\n- 对于稳定层结（$\\zeta \\ge 0$），\n$$\n\\phi_h(\\zeta) = 1 + 5\\,\\zeta.\n$$\n- 对于不稳定层结（$\\zeta  0$），\n$$\n\\phi_h(\\zeta) = \\left(1 - 16\\,\\zeta\\right)^{-1/2}.\n$$\n\n该积分是与给定参数化方案一致的空气动力学阻力的基本表达式。在某些情况下它可以解析求解，或在一般情况下进行数值求解。我们重点介绍两种极限情况：\n\n- 中性极限：当 $|L| \\to \\infty$ 时，$\\zeta \\to 0$ 且 $\\phi_h(0) \\to 1$，因此\n$$\nr_a \\to \\int_{z_0}^{z} \\frac{1}{\\kappa\\,u_\\*\\,s}\\,\\mathrm{d}s = \\frac{1}{\\kappa\\,u_\\*}\\,\\ln\\!\\left(\\frac{z}{z_0}\\right).\n$$\n\n- 稳定情况（$\\zeta \\ge 0$）：当 $\\phi_h(\\zeta) = 1 + 5\\,\\zeta = 1 + 5\\,\\frac{s}{L}$ 时，被积函数变为\n$$\n\\frac{\\phi_h\\!\\left(\\frac{s}{L}\\right)}{\\kappa\\,u_\\*\\,s} = \\frac{1}{\\kappa\\,u_\\*\\,s} + \\frac{5}{\\kappa\\,u_\\*\\,L},\n$$\n积分后得到\n$$\nr_a = \\frac{1}{\\kappa\\,u_\\*}\\,\\ln\\!\\left(\\frac{z}{z_0}\\right) + \\frac{5}{\\kappa\\,u_\\*\\,L}\\,(z - z_0).\n$$\n这明确地显示了在稳定层结下，除了中性值之外所产生的额外阻力。\n\n对于不稳定层结，当直接以上述形式书写时，使用 $\\phi_h(\\zeta) = \\left(1 - 16\\,\\zeta\\right)^{-1/2}$ 所得的积分不能简化为关于 $s$ 的简单初等函数，因此通过数值方法求解既方便又稳健。\n\n算法设计：\n\n- 根据指定的分段 Businger–Dyer 形式定义函数 $\\phi_h(\\zeta)$。\n- 对于给定的 $(u_\\*, z, z_0, L)$，定义被积函数\n$$\nI(s; u_\\*, L) = \\frac{\\phi_h\\!\\left(\\frac{s}{L}\\right)}{\\kappa\\,u_\\*\\,s},\n$$\n并计算\n$$\nr_a(u_\\*, z, z_0, L) = \\int_{z_0}^{z} I(s; u_\\*, L)\\,\\mathrm{d}s.\n$$\n- 使用自适应求积方法实现数值积分。对于大的 $|L|$（近中性），数值计算会平滑地逼近中性结果；严格来说不需要特殊处理，但在实践中可以为极大 $|L|$ 设置上限，以避免不必要的舍入误差效应。\n\n$L$ 的敏感性：\n\n通过检查被积函数可以理解 $r_a$ 对 $L$ 的敏感性：\n$$\nI(s; u_\\*, L) = \\frac{\\phi_h\\!\\left(\\frac{s}{L}\\right)}{\\kappa\\,u_\\*\\,s}.\n$$\n- 稳定层结 ($L > 0$) 对于给定的 $s$ 会增加 $\\zeta$ 并使 $\\phi_h(\\zeta)$ 高于 1，从而与中性情况相比增加了 $I(s)$，并因此增加了相对于中性值的 $r_a$。从稳定的解析表达式\n$$\nr_a = \\frac{1}{\\kappa\\,u_\\*}\\,\\ln\\!\\left(\\frac{z}{z_0}\\right) + \\frac{5}{\\kappa\\,u_\\*\\,L}\\,(z - z_0),\n$$\n关于 $L$ 的偏导数为\n$$\n\\frac{\\partial r_a}{\\partial L} = -\\frac{5}{\\kappa\\,u_\\*\\,L^2}\\,(z - z_0)  0 \\quad \\text{for } L > 0,\n$$\n这表明随着 $L$ 的增加（稳定性减弱，趋向中性），$r_a$ 会减小并趋向于中性值。\n\n- 不稳定层结 ($L  0$) 导致 $\\zeta  0$ 和 $\\phi_h(\\zeta)  1$，与中性情况相比，这会减小 $I(s)$，因此将 $r_a$ 减小到中性值以下。随着 $|L|$ 减小（不稳定性更强），这种效应会增强，由于湍流混合的增强，会产生逐渐减小的 $r_a$。\n\n- 近中性（$|L| \\to \\infty$）导致 $\\phi_h(\\zeta) \\to 1$ 并恢复到中性对数形式。因此，在 $u_\\*$, $z$ 和 $z_0$ 固定的情况下，大小关系通常为：\n$$\nr_a(L>0) > r_a(|L| \\to \\infty) > r_a(L0)\n$$\n\n实现说明：\n\n- 使用 $\\kappa = 0.4$，并以高精度容差进行数值积分。\n- 按要求将每个结果四舍五入到六位小数。\n- 为测试用例生成最终的单行输出，采用指定的逗号分隔列表格式，表示单位为 $\\mathrm{s}\\,\\mathrm{m}^{-1}$ 的 $r_a$：\n  - $(u_\\*, z, z_0, L) = (0.4, 10, 0.1, 100)$,\n  - $(u_\\*, z, z_0, L) = (0.4, 10, 0.1, -50)$,\n  - $(u_\\*, z, z_0, L) = (0.4, 10, 0.1, 10^9)$,\n  - $(u_\\*, z, z_0, L) = (0.3, 0.2, 0.1, 50)$,\n  - $(u_\\*, z, z_0, L) = (0.1, 2, 0.05, -20)$。\n\n实现代码：\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\nKAPPA = 0.4  # von Kármán constant\n\ndef phi_h(zeta: float) -> float:\n    \"\"\"\n    Businger-Dyer stability function for heat:\n    - Stable (zeta >= 0): phi_h = 1 + 5*zeta\n    - Unstable (zeta  0): phi_h = (1 - 16*zeta)^(-1/2)\n    \"\"\"\n    if zeta >= 0.0:\n        return 1.0 + 5.0 * zeta\n    else:\n        return (1.0 - 16.0 * zeta) ** (-0.5)\n\ndef integrand(s: float, u_star: float, L: float) -> float:\n    \"\"\"\n    Integrand for aerodynamic resistance:\n    I(s) = phi_h(s/L) / (kappa * u_star * s)\n    Handles near-neutral by evaluating directly; for very large |L|, zeta ~ 0.\n    \"\"\"\n    # Avoid division by zero; s is always >= z0 > 0 per test suite.\n    if np.isinf(L):\n        ph = 1.0\n    else:\n        # For extremely large |L|, zeta ~ 0 -> phi_h ~ 1; but compute directly\n        zeta = s / L\n        # For very large L, zeta may underflow to 0 in float; phi_h(0) = 1\n        # Keep robust: if |zeta|  1e-12, treat as neutral.\n        if abs(zeta)  1e-12:\n            ph = 1.0\n        else:\n            ph = phi_h(zeta)\n    return ph / (KAPPA * u_star * s)\n\ndef aerodynamic_resistance(u_star: float, z: float, z0: float, L: float) -> float:\n    \"\"\"\n    Compute r_a by numerically integrating integrand from z0 to z.\n    \"\"\"\n    # Ensure valid input\n    if u_star = 0.0:\n        raise ValueError(\"u_star must be positive.\")\n    if z = z0:\n        # Zero or negative layer thickness yields zero resistance increment\n        # Here we handle z == z0 explicitly\n        return 0.0\n\n    # Integrate using adaptive quadrature\n    # Use absolute and relative tolerances for robust accuracy\n    result, _ = quad(integrand, z0, z, args=(u_star, L), epsabs=1e-10, epsrel=1e-10, limit=200)\n    return result\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (u_star [m/s], z [m], z0 [m], L [m])\n    test_cases = [\n        (0.4, 10.0, 0.1, 100.0),         # Moderately stable, happy path\n        (0.4, 10.0, 0.1, -50.0),         # Moderately unstable\n        (0.4, 10.0, 0.1, 1.0e9),         # Near-neutral (large L)\n        (0.3, 0.2, 0.1, 50.0),           # Small z - z0 boundary case\n        (0.1, 2.0, 0.05, -20.0),         # Strongly unstable, low u_star\n    ]\n\n    results = []\n    for u_star, z, z0, L in test_cases:\n        ra = aerodynamic_resistance(u_star, z, z0, L)\n        # Round to six decimal places as required\n        results.append(f\"{ra:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```",
            "answer": "```\n[31.876054,21.050302,28.782333,5.790930,5.244349]\n```"
        }
    ]
}