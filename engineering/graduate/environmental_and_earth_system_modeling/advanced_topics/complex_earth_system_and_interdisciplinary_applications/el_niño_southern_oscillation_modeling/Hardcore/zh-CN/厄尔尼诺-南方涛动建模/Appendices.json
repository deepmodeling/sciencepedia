{
    "hands_on_practices": [
        {
            "introduction": "简化模型，如双变量的充放电振子模型，是理解ENSO核心反馈机制的有力工具。本练习聚焦于通过线性稳定性分析，揭示ENSO系统的基本振荡特性以及关键变量（如海表温度和暖水体积）之间的相位关系。这是一种分析动力系统的经典方法，有助于建立对ENSO循环物理本质的直观理解。",
            "id": "3877807",
            "problem": "厄尔尼诺-南方涛动（ENSO）的简化动力学描述可以通过混合层热量收支和赤道质量连续性来建立，从而耦合海表温度（SST）异常和上层海洋暖水体积（WWV）异常。请考虑以下具有物理动机的步骤：\n\n- 从混合层热量收支开始，其异常形式可表示为 $\\rho c_{p} h \\,\\frac{dT'}{dt} = Q'_{\\text{net}} - \\rho c_{p} w' \\Gamma$，其中 $\\rho$ 是海水密度，$c_{p}$ 是比热容，$h$ 是混合层深度，$T'$ 是SST异常，$Q'_{\\text{net}}$ 是净表面热通量异常，$w'$ 是上升流异常，而 $\\Gamma$ 是由温跃层决定的垂直温度梯度。将 $Q'_{\\text{net}}$ 参数化为由表面通量反馈引起的线性阻尼 $- \\Lambda_{T} T'$，并通过热带太平洋海盆的大尺度连续性将 $w'$ 与温跃层位移异常关联起来，而温跃层位移异常又与WWV异常 $W'$ 成正比。\n\n- 对于WWV的变化趋势，使用赤道质量连续性将风应力驱动的辐散和辐合与暖水池的充放联系起来。将该趋势参数化为一个线性释放项 $- \\Lambda_{W} W'$ 加上一个通过大气耦合与SST异常成正比的风应力强迫项，得到 $- \\chi T'$。\n\n在适当的情况下进行线性化并通过 $\\rho c_{p} h$ 进行无量纲化，可得到关于SST异常 $T'(t)$ 和WWV异常 $W'(t)$ 的典型双变量线性系统：\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\nT' \\\\\nW'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n- a  b \\\\\n- d  - c\n\\end{pmatrix}\n\\begin{pmatrix}\nT' \\\\\nW'\n\\end{pmatrix},\n$$\n其中 $a > 0$ 代表有效热阻尼，$b > 0$ 代表通过温跃层对上升流的反馈，SST倾向对WWV异常的敏感性，$c > 0$ 代表WWV的释放，而 $d > 0$ 代表通过Bjerknes耦合，由SST异常产生的风应力驱动的WWV倾向的强度。\n\n假设参数值对于热带太平洋在观测上和模型上都是合理的：$a = 0.8 \\ \\text{yr}^{-1}$，$b = 1.2 \\ \\text{yr}^{-1}$，$c = 0.7 \\ \\text{yr}^{-1}$，以及 $d = 1.6 \\ \\text{yr}^{-1}$。令 $\\lambda$ 表示虚部为正的特征值，$v = (v_{T}, v_{W})^{\\top}$ 为其对应的特征向量，且归一化使得 $v_{T} = 1$。利用特征结构推断解的振荡分量中 $W'$ 和 $T'$ 之间的相位超前-滞后关系。具体来说，如果 $T'(t)$ 和 $W'(t)$ 的演变分别与 $\\Re\\{v_{T} \\exp(\\lambda t)\\}$ 和 $\\Re\\{v_{W} \\exp(\\lambda t)\\}$ 成比例，那么 $W'$ 相对于 $T'$ 的相位超前角 $\\phi$ 由 $v_{W}/v_{T}$ 的辐角给出。\n\n计算特征值和相应的特征向量 $v$（其中 $v_{T} = 1$），然后确定 $W'$ 相对于 $T'$ 的相位超前角 $\\phi$（以弧度为单位）。你的最终答案 $\\phi$ 应以弧度表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求对一个厄尔尼诺-南方涛动（ENSO）的简化充放电振子模型进行线性稳定性分析。该模型由一个包含两个耦合线性常微分方程的系统描述，用于描述海表温度（SST）异常 $T'$ 和暖水体积（WWV）异常 $W'$ 的演变。\n\n**问题验证**\n\n**步骤1：提取已知信息**\n- **常微分方程组**:\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\nT' \\\\\nW'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-a  b \\\\\n-d  -c\n\\end{pmatrix}\n\\begin{pmatrix}\nT' \\\\\nW'\n\\end{pmatrix}\n$$\n- **参数**: $a > 0$, $b > 0$, $c > 0$, $d > 0$。\n- **参数值**: $a = 0.8 \\ \\text{yr}^{-1}$, $b = 1.2 \\ \\text{yr}^{-1}$, $c = 0.7 \\ \\text{yr}^{-1}$, $d = 1.6 \\ \\text{yr}^{-1}$。\n- **特征值**: $\\lambda$ 表示虚部为正的特征值。\n- **特征向量**: $v = (v_{T}, v_{W})^{\\top}$ 是与 $\\lambda$ 相关的特征向量。\n- **归一化**: 特征向量被归一化，使得 $v_{T} = 1$。\n- **相位超前定义**: $W'$ 相对于 $T'$ 的相位超前角 $\\phi$ 由 $v_{W}/v_{T}$ 的辐角给出。\n- **任务**: 计算特征值、特征向量 $v$ 和相位超前角 $\\phi$（以弧度为单位），并四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知信息进行验证**\n- **科学基础**: 该问题描述了一个简化的线性双变量厄尔尼诺-南方涛动模型，这是气候动力学中一个公认的课题，被称为“充电-放电振子”模型。所述参数值据称是合理的。该模型是理解ENSO基本动力学的标准工具。它在科学上是合理的。\n- **适定性**: 该问题是一个标准的 $2\\times2$ 矩阵的特征值问题。参数已完全指定，目标清晰明确。对于特征值和指定的特征向量存在唯一解。该问题是适定的。\n- **客观性**: 语言是正式和技术性的，没有任何主观或偏颇的陈述。\n\n**步骤3：结论和行动**\n问题是有效的。我将继续解答。\n\n**解题过程**\n\n该动力学系统由矩阵方程 $\\frac{d\\mathbf{x}}{dt} = A\\mathbf{x}$ 描述，其中 $\\mathbf{x} = \\begin{pmatrix} T' \\\\ W' \\end{pmatrix}$，矩阵 $A$ 由下式给出：\n$$\nA = \\begin{pmatrix} -a  b \\\\ -d  -c \\end{pmatrix}\n$$\n代入给定的参数值 $a = 0.8$, $b = 1.2$, $c = 0.7$, $d = 1.6$：\n$$\nA = \\begin{pmatrix} -0.8  1.2 \\\\ -1.6  -0.7 \\end{pmatrix}\n$$\n矩阵 $A$ 的特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的解，其中 $I$ 是单位矩阵。\n$$\n\\det\\begin{pmatrix} -0.8 - \\lambda  1.2 \\\\ -1.6  -0.7 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-0.8 - \\lambda)(-0.7 - \\lambda) - (1.2)(-1.6) = 0\n$$\n$$\n\\lambda^2 + 0.7\\lambda + 0.8\\lambda + (0.8)(0.7) + (1.2)(1.6) = 0\n$$\n$$\n\\lambda^2 + 1.5\\lambda + 0.56 + 1.92 = 0\n$$\n$$\n\\lambda^2 + 1.5\\lambda + 2.48 = 0\n$$\n我们使用二次方程求根公式 $\\lambda = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 来解这个关于 $\\lambda$ 的二次方程，其中系数为 $A=1$, $B=1.5$, $C=2.48$：\n$$\n\\lambda = \\frac{-1.5 \\pm \\sqrt{(1.5)^2 - 4(1)(2.48)}}{2} = \\frac{-1.5 \\pm \\sqrt{2.25 - 9.92}}{2} = \\frac{-1.5 \\pm \\sqrt{-7.67}}{2}\n$$\n特征值是一对共轭复数：\n$$\n\\lambda = -\\frac{1.5}{2} \\pm i\\frac{\\sqrt{7.67}}{2} = -0.75 \\pm i\\frac{\\sqrt{7.67}}{2}\n$$\n问题指定使用虚部为正的特征值 $\\lambda$：\n$$\n\\lambda = -0.75 + i\\frac{\\sqrt{7.67}}{2}\n$$\n接下来，我们通过求解方程 $(A - \\lambda I)v = 0$ 来求此 $\\lambda$ 对应的特征向量 $v = \\begin{pmatrix} v_T \\\\ v_W \\end{pmatrix}$。\n$$\n\\begin{pmatrix} -0.8 - \\lambda  1.2 \\\\ -1.6  -0.7 - \\lambda \\end{pmatrix} \\begin{pmatrix} v_T \\\\ v_W \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n从矩阵方程的第一行，我们有：\n$$\n(-0.8 - \\lambda)v_T + 1.2v_W = 0\n$$\n问题要求将特征向量归一化，使其第一个分量 $v_T=1$。代入此条件：\n$$\n(-0.8 - \\lambda) + 1.2v_W = 0 \\implies v_W = \\frac{0.8 + \\lambda}{1.2}\n$$\n现在，我们代入 $\\lambda$ 的表达式：\n$$\nv_W = \\frac{0.8 + \\left(-0.75 + i\\frac{\\sqrt{7.67}}{2}\\right)}{1.2} = \\frac{0.05 + i\\frac{\\sqrt{7.67}}{2}}{1.2}\n$$\n$$\nv_W = \\frac{0.05}{1.2} + i\\frac{\\sqrt{7.67}}{2.4}\n$$\n因此，特征向量是 $v = \\begin{pmatrix} 1 \\\\ \\frac{0.05}{1.2} + i\\frac{\\sqrt{7.67}}{2.4} \\end{pmatrix}$。\n\n$W'$ 相对于 $T'$ 的相位超前角 $\\phi$ 由比值 $\\frac{v_W}{v_T}$ 的辐角给出。由于 $v_T = 1$，这简化为 $\\phi = \\arg(v_W)$。\n复数 $v_W$ 可以写作 $x + iy$，其中 $x = \\frac{0.05}{1.2}$ 且 $y = \\frac{\\sqrt{7.67}}{2.4}$。$x$ 和 $y$ 均为正数，因此角 $\\phi$ 位于第一象限，并由 $\\arctan(\\frac{y}{x})$ 给出。\n$$\n\\phi = \\arctan\\left(\\frac{\\frac{\\sqrt{7.67}}{2.4}}{\\frac{0.05}{1.2}}\\right) = \\arctan\\left(\\frac{\\sqrt{7.67}}{2.4} \\cdot \\frac{1.2}{0.05}\\right)\n$$\n$$\n\\phi = \\arctan\\left(\\frac{\\sqrt{7.67}}{2 \\cdot 0.05}\\right) = \\arctan\\left(\\frac{\\sqrt{7.67}}{0.1}\\right) = \\arctan(10\\sqrt{7.67})\n$$\n为获得最终数值答案，我们以弧度计算此值：\n$$\n\\phi \\approx \\arctan(10 \\times 2.7694765) = \\arctan(27.694765)\n$$\n$$\n\\phi \\approx 1.5346850 \\text{ rad}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\n\\phi \\approx 1.535 \\text{ rad}\n$$",
            "answer": "$$\\boxed{1.535}$$"
        },
        {
            "introduction": "为了捕捉ENSO更真实的特征，我们需要超越简单的箱式模型，考虑其空间结构。本练习采用一个四变量模型，该模型解析了赤道太平洋的东西向结构。通过计算该系统的主导特征模态，您将学习如何解读ENSO事件的空间形态，并量化关键物理反馈（如Bjerknes反馈）的强度与一致性。",
            "id": "3877832",
            "problem": "给定一个线性的、中等复杂度的厄尔尼诺-南方涛动 (ENSO) 模型，旨在捕捉由海-气耦合反馈引起的主导动力模态。状态向量包含三个赤道太平洋区域的海表温度（SST）异常和一个温跃层深度异常：$\\mathbf{x} = [T_W, T_C, T_E, h]^\\top$，其中 $T_W$、$T_C$ 和 $T_E$ 分别是西、中、东赤道太平洋的海表温度异常，$h$ 是东太平洋的温跃层深度异常。所有倾向项均以每月为单位表示，时间以月为单位。Bjerknes 反馈由一个全海盆范围的纬向风应力异常 $\\tau$ 表示，它根据 $\\tau = c_C T_C + c_E T_E$ 瞬时响应中、东太平洋区域的海表温度异常，其中 $c_C$ 和 $c_E$ 是耦合系数。该系统在气候平均态附近进行线性化，并考虑了牛顿阻尼和线性上升流效应。控制方程为\n\n$$\n\\frac{dT_W}{dt} = -\\mu_W T_W + \\lambda_W h + \\rho_W \\tau,\n$$\n$$\n\\frac{dT_C}{dt} = -\\mu_C T_C + \\lambda_C h + \\rho_C \\tau,\n$$\n$$\n\\frac{dT_E}{dt} = -\\mu_E T_E + \\lambda_E h + \\rho_E \\tau,\n$$\n$$\n\\frac{dh}{dt} = -\\nu h + \\kappa \\tau,\n$$\n\n其中所有系数均为常数。参数 $\\mu_W$、$\\mu_C$ 和 $\\mu_E$ 是 SST 阻尼率 (月$^{-1}$)，$\\lambda_W$、$\\lambda_C$ 和 $\\lambda_E$ 是 SST 对温跃层变化的敏感度 (月$^{-1}$)，$\\rho_W$、$\\rho_C$ 和 $\\rho_E$ 是 SST 对风应力的敏感度 (月$^{-1}$)，$\\nu$ 是温跃层阻尼率 (月$^{-1}$)，$\\kappa$ 是温跃层深度对风应力的敏感度 (月$^{-1}$)。该模型可以写成矩阵形式 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{A}\\mathbf{x}$，其中\n\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\n-\\mu_W  \\rho_W c_C  \\rho_W c_E  \\lambda_W \\\\\n0  -\\mu_C + \\rho_C c_C  \\rho_C c_E  \\lambda_C \\\\\n0  \\rho_E c_C  -\\mu_E + \\rho_E c_E  \\lambda_E \\\\\n0  \\kappa c_C  \\kappa c_E  -\\nu \\\\\n\\end{bmatrix}.\n$$\n\n您的任务是，对给定的参数集，计算矩阵 $\\mathbf{A}$ 的主导（最不稳定）特征值及其关联的特征向量，根据 Bjerknes 反馈回路解释该模态的空间型，并生成一份可量化的摘要。主导特征值是具有最大实部的特征值 $\\lambda_{\\max}$。如果主导特征值是复数，其虚部表示一个角频率，单位为弧度/月。关联的特征向量可能是复数；对于空间型解释，您必须使用归一化特征向量的实部。\n\n归一化要求：设 $\\mathbf{v}$ 为 $\\lambda_{\\max}$ 的特征向量。计算其复数范数 $\\|\\mathbf{v}\\|_2 = \\sqrt{\\sum_i |v_i|^2}$ 并将归一化特征向量实部模式定义为 $\\hat{\\mathbf{v}} = \\mathrm{Re}(\\mathbf{v}) / \\|\\mathbf{v}\\|_2$。$\\hat{\\mathbf{v}}$ 的分量对应于 $[v_W, v_C, v_E, v_h]$。\n\n反馈解释指标：\n- 将模态上的风应力投影定义为 $\\tau^\\star = c_C v_C + c_E v_E$，使用 $\\hat{\\mathbf{v}}$ 的分量。\n- 将东向集中指数定义为 $R = \\frac{|v_E|}{|v_W| + |v_C| + \\epsilon}$，其中 $\\epsilon = 10^{-12}$ 以避免除以零。\n- 将 Bjerknes 一致性布尔值 $B$ 定义为真，如果 $v_E \\cdot \\tau^\\star > 0$ 和 $v_h \\cdot \\tau^\\star > 0$ 同时成立，否则为假。\n\n单位：\n- 所有速率（$\\mu_W$, $\\mu_C$, $\\mu_E$, $\\nu$, $\\lambda_W$, $\\lambda_C$, $\\lambda_E$, $\\rho_W$, $\\rho_C$, $\\rho_E$, $\\kappa$）的单位均为月$^{-1}$。\n- 主导特征值的实部应以月$^{-1}$为单位报告。\n- 主导特征值的虚部（如果有）应以弧度/月为单位报告。\n\n角度单位要求：以弧度/月为单位报告主导特征值的虚部。\n\n测试套件：\n为以下参数集计算输出：\n\n- 情况 A（中等正反馈，预期为阻尼振荡）：$\\mu_W = 0.5$，$\\mu_C = 0.45$，$\\mu_E = 0.4$，$\\nu = 0.35$，$\\lambda_W = 0.2$，$\\lambda_C = 0.3$，$\\lambda_E = 0.5$，$\\rho_W = 0.1$，$\\rho_C = 0.2$，$\\rho_E = 0.3$，$c_C = 0.8$，$c_E = 1.0$，$\\kappa = 0.6$。\n- 情况 B（接近临界反馈，可能为弱不稳定或近中性振荡）：$\\mu_W = 0.45$，$\\mu_C = 0.4$，$\\mu_E = 0.35$，$\\nu = 0.3$，$\\lambda_W = 0.25$，$\\lambda_C = 0.35$，$\\lambda_E = 0.6$，$\\rho_W = 0.15$，$\\rho_C = 0.25$，$\\rho_E = 0.4$，$c_C = 0.9$，$c_E = 1.2$，$\\kappa = 1.0$。\n- 情况 C（无 Bjerknes 反馈，纯阻尼动力学）：$\\mu_W = 0.5$，$\\mu_C = 0.5$，$\\mu_E = 0.5$，$\\nu = 0.4$，$\\lambda_W = 0.2$，$\\lambda_C = 0.2$，$\\lambda_E = 0.2$，$\\rho_W = 0.1$，$\\rho_C = 0.1$，$\\rho_E = 0.1$，$c_C = 0.0$，$c_E = 0.0$，$\\kappa = 0.5$。\n\n必需的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是一个方括号括起来的逗号分隔列表，按顺序包含以下八个条目：$[\\mathrm{Re}(\\lambda_{\\max}), \\mathrm{Im}(\\lambda_{\\max}), v_W, v_C, v_E, v_h, R, B]$。这里 $B$ 必须是布尔值。例如，输出应类似于 $[[\\ldots],[\\ldots],[\\ldots]]$ 的单行格式。\n\n不允许用户输入或外部数据；所有参数值均已在上方指定，并且必须嵌入程序中。程序必须计算矩阵，找到主导特征对，归一化特征向量，计算 $\\tau^\\star$，计算 $R$，评估 $B$，并以所描述的精确格式打印最终结果。所有数值结果必须是浮点数，$B$ 必须是布尔值。根据模型时间单位的定义，主导特征值的实部以月$^{-1}$表示，虚部以弧度/月表示。",
            "solution": "该问题要求对一个简化的厄尔尼诺-南方涛动 (ENSO) 模型进行线性稳定性分析。该模型的动力学由一个包含四个线性常微分方程的系统描述，该系统可以表示为矩阵形式 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{A}\\mathbf{x}$。状态向量 $\\mathbf{x} = [T_W, T_C, T_E, h]^\\top$ 表示西（$T_W$）、中（$T_C$）和东（$T_E$）赤道太平洋的海表温度（SST）异常，以及东太平洋的温跃层深度异常（$h$）。\n\n此类系统的解是形如 $\\mathbf{x}(t) = \\mathbf{v} e^{\\lambda t}$ 的模态的叠加，其中 $(\\lambda, \\mathbf{v})$ 是矩阵 $\\mathbf{A}$ 的一个特征对（特征值和对应的特征向量）。系统的长期行为由“主导模态”决定，该模态对应于具有最大实部的特征值，记为 $\\lambda_{\\max}$。实部 $\\mathrm{Re}(\\lambda_{\\max})$ 决定了该模态的增长率。如果 $\\mathrm{Re}(\\lambda_{\\max}) > 0$，则该模态不稳定并呈指数增长，代表厄尔尼诺或拉尼娜事件的发展。如果 $\\mathrm{Re}(\\lambda_{\\max}) < 0$，则该模态是稳定的并会衰减。虚部 $\\mathrm{Im}(\\lambda_{\\max})$ 表示模态的振荡角频率，其周期为 $T = 2\\pi / |\\mathrm{Im}(\\lambda_{\\max})|$ 个月。\n\n任务的核心是为三个不同的物理参数集构建 $4 \\times 4$ 的系统矩阵 $\\mathbf{A}$，然后计算其主导特征对。矩阵 $\\mathbf{A}$ 由下式给出：\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\n-\\mu_W  \\rho_W c_C  \\rho_W c_E  \\lambda_W \\\\\n0  -\\mu_C + \\rho_C c_C  \\rho_C c_E  \\lambda_C \\\\\n0  \\rho_E c_C  -\\mu_E + \\rho_E c_E  \\lambda_E \\\\\n0  \\kappa c_C  \\kappa c_E  -\\nu \\\\\n\\end{bmatrix}\n$$\n其中参数代表各种物理过程，例如阻尼（$\\mu_i, \\nu$）、温跃层-SST 相互作用（$\\lambda_i$）以及风驱动的反馈（$\\rho_i, c_i, \\kappa$）。所有速率的单位都是月$^{-1}$。\n\n每个参数情况的计算过程如下：\n1.  通过代入给定的参数值来构建矩阵 $\\mathbf{A}$。这些参数是：$\\mu_W, \\mu_C, \\mu_E, \\nu, \\lambda_W, \\lambda_C, \\lambda_E, \\rho_W, \\rho_C, \\rho_E, c_C, c_E, \\kappa$。\n2.  求解特征值问题 $\\mathbf{A}\\mathbf{v} = \\lambda\\mathbf{v}$，以找到所有四个特征值 $\\lambda_i$ 及其对应的特征向量 $\\mathbf{v}_i$。这是一个标准的数值线性代数任务。\n3.  通过找到具有最大实部的特征值来识别主导特征值 $\\lambda_{\\max}$。对应的特征向量是 $\\mathbf{v}$。特征值和特征向量可以是复数值。\n4.  模态的空间型源自领导特征向量的实部。根据规定，该模式 $\\hat{\\mathbf{v}}$ 是通过将 $\\mathbf{v}$ 的实部用 $\\mathbf{v}$ 的复数 L2 范数进行归一化得到的：\n    $$\n    \\hat{\\mathbf{v}} = \\frac{\\mathrm{Re}(\\mathbf{v})}{\\|\\mathbf{v}\\|_2} = \\frac{\\mathrm{Re}(\\mathbf{v})}{\\sqrt{\\sum_{i=1}^4 |v_i|^2}}\n    $$\n    $\\hat{\\mathbf{v}}$ 的分量表示为 $[v_W, v_C, v_E, v_h]^\\top$。这些分量代表了主导模态中四个状态变量异常的相对强度和符号。\n5.  计算派生指标以解释模态内的物理反馈：\n    - 与模态空间型相关的风应力异常投影为 $\\tau^\\star = c_C v_C + c_E v_E$。\n    - 东向集中指数 $R = \\frac{|v_E|}{|v_W| + |v_C| + \\epsilon}$（其中 $\\epsilon = 10^{-12}$），量化了 SST 异常型在东太平洋集中的程度。\n    - 评估 Bjerknes 一致性布尔值 $B$。如果 $v_E \\cdot \\tau^\\star > 0$ 和 $v_h \\cdot \\tau^\\star > 0$ 同时成立，则为 `True`，否则为 `False`。这个条件验证了风异常 $\\tau^\\star$ 是否会放大东太平洋的 SST 异常（$v_E$）和东太平洋的温跃层深度异常（$v_h$），这是真实气候系统中 Bjerknes 反馈回路的本质。正的 $v_E \\cdot \\tau^\\star$ 表示风驱动的增温加强了东太平洋现有的暖 SST 异常。正的 $v_h \\cdot \\tau^\\star$ 表示风驱动的温跃层加深（正的 $h$ 异常）与风应力相关联，这为进一步的海表增温创造了前提条件。\n\n对所提供的三个测试用例中的每一个都执行此完整过程，并将结果汇总成指定的最终输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the leading eigenmode and derived metrics for a simplified ENSO model\n    for three given parameter sets.\n    \"\"\"\n\n    test_cases = [\n        # Case A (moderate positive feedback, damped oscillation expected)\n        {\n            'name': 'A',\n            'params': {\n                'mu_W': 0.5, 'mu_C': 0.45, 'mu_E': 0.4, 'nu': 0.35,\n                'lambda_W': 0.2, 'lambda_C': 0.3, 'lambda_E': 0.5,\n                'rho_W': 0.1, 'rho_C': 0.2, 'rho_E': 0.3,\n                'c_C': 0.8, 'c_E': 1.0, 'kappa': 0.6\n            }\n        },\n        # Case B (near-critical feedback, weakly unstable or nearly neutral oscillation possible)\n        {\n            'name': 'B',\n            'params': {\n                'mu_W': 0.45, 'mu_C': 0.4, 'mu_E': 0.35, 'nu': 0.3,\n                'lambda_W': 0.25, 'lambda_C': 0.35, 'lambda_E': 0.6,\n                'rho_W': 0.15, 'rho_C': 0.25, 'rho_E': 0.4,\n                'c_C': 0.9, 'c_E': 1.2, 'kappa': 1.0\n            }\n        },\n        # Case C (no Bjerknes feedback, purely damped dynamics)\n        {\n            'name': 'C',\n            'params': {\n                'mu_W': 0.5, 'mu_C': 0.5, 'mu_E': 0.5, 'nu': 0.4,\n                'lambda_W': 0.2, 'lambda_C': 0.2, 'lambda_E': 0.2,\n                'rho_W': 0.1, 'rho_C': 0.1, 'rho_E': 0.1,\n                'c_C': 0.0, 'c_E': 0.0, 'kappa': 0.5\n            }\n        }\n    ]\n\n    results = []\n    epsilon = 1e-12\n\n    for case in test_cases:\n        p = case['params']\n\n        # Construct the 4x4 matrix A\n        A = np.array([\n            [-p['mu_W'], p['rho_W'] * p['c_C'], p['rho_W'] * p['c_E'], p['lambda_W']],\n            [0, -p['mu_C'] + p['rho_C'] * p['c_C'], p['rho_C'] * p['c_E'], p['lambda_C']],\n            [0, p['rho_E'] * p['c_C'], -p['mu_E'] + p['rho_E'] * p['c_E'], p['lambda_E']],\n            [0, p['kappa'] * p['c_C'], p['kappa'] * p['c_E'], -p['nu']]\n        ])\n\n        # Compute eigenvalues and eigenvectors\n        eigenvalues, eigenvectors = np.linalg.eig(A)\n\n        # Find the index of the leading eigenvalue (largest real part)\n        idx_leading = np.argmax(eigenvalues.real)\n        \n        # Extract the leading eigenvalue and eigenvector\n        lambda_max = eigenvalues[idx_leading]\n        v_leading = eigenvectors[:, idx_leading]\n\n        # Normalize the leading eigenvector as specified\n        norm_v = np.linalg.norm(v_leading)\n        \n        # Check for zero norm, though unlikely for a non-zero eigenvector\n        if norm_v  epsilon:\n            v_hat = np.zeros(4)\n        else:\n            v_hat = v_leading.real / norm_v\n\n        v_W, v_C, v_E, v_h = v_hat[0], v_hat[1], v_hat[2], v_hat[3]\n\n        # Compute feedback interpretation metrics\n        tau_star = p['c_C'] * v_C + p['c_E'] * v_E\n        \n        R = abs(v_E) / (abs(v_W) + abs(v_C) + epsilon)\n        \n        B = bool((v_E * tau_star > 0) and (v_h * tau_star > 0))\n\n        # Collect results for this case\n        case_result = [\n            lambda_max.real,\n            lambda_max.imag,\n            v_W,\n            v_C,\n            v_E,\n            v_h,\n            R,\n            B\n        ]\n        results.append(case_result)\n\n    # Format the final output string as specified\n    # The str() of a list automatically includes brackets and commas.\n    # We join these string representations of lists with commas.\n    # Finally, we enclose the whole thing in brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "完整的ENSO耦合模型需要同时描述海洋和大气的行为。这项高级实践任务要求您从头开始，实现吉尔（Gill）模型的数值解，这是一个理解热带大气如何响应海表温度异常的经典理论框架。本练习将为您提供离散化和求解偏微分方程的实践经验，这是环境系统建模的一项核心技能。",
            "id": "3877771",
            "problem": "考虑用于厄尔尼诺-南方涛动 (ENSO) 建模的、赤道$\\beta$平面上的典范线性定常Gill型大气模型。令 $(x,y)$ 表示以米为单位的笛卡尔坐标，其中 $y=0$ 位于赤道；令 $(u(x,y), v(x,y))$ 为水平风异常（单位：米/秒）；令 $\\phi(x,y)$ 为位势异常（单位：平方米/平方秒）。受非绝热加热 $Q(x,y)$ (单位：平方米/立方秒) 驱动，包含Rayleigh摩擦和Newtonian冷却的定常线性化浅水方程组为\n$$\n\\partial_x \\phi + r\\,u - \\beta\\,y\\,v = 0,\n$$\n$$\n\\partial_y \\phi + r\\,v + \\beta\\,y\\,u = 0,\n$$\n$$\nc^2\\left(\\partial_x u + \\partial_y v\\right) + \\alpha\\,\\phi = Q(x,y),\n$$\n其中 $c$ 为重力波速（$gH$ 的平方根），$\\beta$ 为赤道处科里奥利参数的经向梯度，$r$ 为线性Rayleigh摩擦率，$\\alpha$ 为线性Newtonian冷却率。\n\n假设一个矩形双周期域，$x \\in [-L_x/2, L_x/2)$ 和 $y \\in [-L_y/2, L_y/2)$，其中 $L_x = 1.2 \\times 10^7$，$L_y = 8.0 \\times 10^6$，该域由一个包含 $N_x = 97$ 和 $N_y = 65$ 个点的均匀网格离散化。对 $\\partial_x$ 和 $\\partial_y$ 使用二阶中心有限差分，并在两个方向上进行周期性环绕处理。使用参数值 $c = 44$，$\\beta = 2.3 \\times 10^{-11}$，$r = 2.0 \\times 10^{-6}$，以及 $\\alpha = 2.0 \\times 10^{-6}$，所有率的单位为 1/秒，速度单位为米/秒。空气密度 $\\rho_{\\text{air}} = 1.2$ 千克/立方米，中性拖曳系数 $C_d = 1.3 \\times 10^{-3}$。\n\n通过一个线性关系将非绝热加热 $Q(x,y)$ 与给定的海表温度 (SST) 异常 $T'(x,y)$ (开尔文) 联系起来\n$$\nQ(x,y) = \\gamma\\,T'(x,y),\n$$\n其中 $\\gamma = 1.0 \\times 10^{-5}$，单位为平方米/立方秒/开尔文。将 $T'(x,y)$ 指定为一个二维高斯异常\n$$\nT'(x,y) = A\\,\\exp\\left(-\\frac{(x-x_0)^2}{2 L_x'^2} - \\frac{(y-y_0)^2}{2 L_y'^2}\\right),\n$$\n其振幅为 $A$ (开尔文)，纬向半宽为 $L_x'$ (米)，经向半宽为 $L_y'$ (米)，中心为 $(x_0,y_0)$ (米)。\n\n通过求解得到的线性系统，计算每个给定的 $Q(x,y)$ 所对应的定常解 $(u(x,y), v(x,y), \\phi(x,y))$。然后，构建与围绕指定背景风 $\\mathbf{U}_b = (U_b, V_b)$ 的整体空气动力学动量通量一阶一致的线性化风应力异常 $\\boldsymbol{\\tau}'(x,y)$：\n$$\n\\boldsymbol{\\tau}(\\mathbf{U}) = \\rho_{\\text{air}}\\,C_d\\,\\|\\mathbf{U}\\|\\,\\mathbf{U}, \\quad \\mathbf{U} = \\mathbf{U}_b + \\mathbf{u}',\n$$\n线性化为\n$$\n\\boldsymbol{\\tau}' = \\rho_{\\text{air}}\\,C_d\\left(\\|\\mathbf{U}_b\\|\\,\\mathbf{u}' + \\frac{\\mathbf{U}_b \\cdot \\mathbf{u}'}{\\|\\mathbf{U}_b\\|}\\,\\mathbf{U}_b\\right),\n$$\n其中 $\\mathbf{u}' = (u,v)$。使用 $U_b = -6$ 和 $V_b = 0$ (单位：米/秒)。根据 $\\boldsymbol{\\tau}'$，计算在由 $\\{|y| \\le 5.0 \\times 10^5\\}$ 定义的赤道带上的区域平均纬向风应力异常：\n$$\n\\overline{\\tau_x'} = \\frac{1}{\\mathcal{A}}\\iint_{\\{|y| \\le 5.0 \\times 10^5\\}} \\tau_x'(x,y)\\,dx\\,dy,\n$$\n通过对选定网格单元进行简单算术平均来近似。\n\n使用以下测试套件，确保每个参数都以国际单位制 (SI) 单位进行解释：\n- 案例1 (典范赤道增温)：$A = 2$, $L_x' = 1.5 \\times 10^6$, $L_y' = 5.0 \\times 10^5$, $x_0 = 0$, $y_0 = 0$。\n- 案例2 (无强迫边界情况)：$A = 0$, $L_x' = 1.0 \\times 10^6$, $L_y' = 5.0 \\times 10^5$, $x_0 = 0$, $y_0 = 0$。\n- 案例3 (赤道外增温)：$A = 2$, $L_x' = 1.0 \\times 10^6$, $L_y' = 6.0 \\times 10^5$, $x_0 = 1.0 \\times 10^6$, $y_0 = 1.0 \\times 10^6$。\n\n您的程序必须：\n- 对给定的域和参数，构造并分解一次线性系统，然后对每个右端项 $Q(x,y)$ 进行求解。\n- 计算每种情况下以平方米/牛顿为单位的 $\\overline{\\tau_x'}$，表示为浮点数。\n- 生成单行输出，其中包含一个以逗号分隔并用方括号括起来的结果列表 (例如，$[r_1,r_2,r_3]$)，其中 $r_i$ 是案例 $i$ 的区域平均纬向风应力异常 $\\overline{\\tau_x'}$。\n\n所有物理量必须以国际单位制 (SI) 单位处理和报告，任何角度量 (如果出现) 必须以弧度为单位。最终输出必须是单位为牛顿/平方米 (N/m$^2$) 的浮点数。",
            "solution": "该问题是有效的。这是一个位于计算地球物理流体动力学领域、适定且有科学依据的问题。它要求在赤道$\\beta$平面上对定常线性化浅水方程进行数值求解，这是一个用于研究大气对海表温度异常（例如与厄尔尼诺-南方涛动 (ENSO) 相关的异常）响应的经典模型。\n\n求解过程分为以下几个步骤：\n1.  使用有限差分法将连续的控制偏微分方程 (PDE) 离散化为线性代数方程组。\n2.  构建相应的稀疏线性系统矩阵 $\\mathbf{M}$ 和右端项 (RHS) 向量 $\\mathbf{b}$。\n3.  高效求解线性系统 $\\mathbf{M}\\mathbf{z}=\\mathbf{b}$，以获得包含风场和位势异常离散场的状态向量 $\\mathbf{z}$。\n4.  对解进行后处理，以计算所需的诊断量，即区域平均纬向风应力异常 $\\overline{\\tau_x'}$。\n\n**1. 域和变量的离散化**\n\n该模型定义在一个双周期矩形域上，$x \\in [-L_x/2, L_x/2)$ 和 $y \\in [-L_y/2, L_y/2)$，其中 $L_x = 1.2 \\times 10^7$ 米，$L_y = 8.0 \\times 10^6$ 米。该域使用一个 $N_x = 97 \\times N_y = 65$ 点的均匀网格进行离散化。网格间距为 $\\Delta x = L_x / N_x$ 和 $\\Delta y = L_y / N_y$。网格点坐标 $(x_i, y_j)$ 定义为：\n$$\nx_i = - \\frac{L_x}{2} + i \\cdot \\Delta x, \\quad \\text{for } i = 0, 1, \\dots, N_x-1\n$$\n$$\ny_j = - \\frac{L_y}{2} + j \\cdot \\Delta y, \\quad \\text{for } j = 0, 1, \\dots, N_y-1\n$$\n三个未知场，即纬向风异常 $u(x,y)$、经向风异常 $v(x,y)$ 和位势异常 $\\phi(x,y)$，在这些网格点上被离散化，记为 $u_{ij}$、$v_{ij}$ 和 $\\phi_{ij}$。未知数的总数为 $N = 3 N_x N_y$。这些未知数被组织成一个长度为 $N$ 的单一状态向量 $\\mathbf{z}$。我们采用一种按网格点对变量进行分组的映射方式。一个网格点 $(i,j)$ 被映射到一个线性索引 $p = j N_x + i$。与该点对应的状态向量分量则位于索引 $3p$ (对于 $u_{ij}$)、$3p+1$ (对于 $v_{ij}$) 和 $3p+2$ (对于 $\\phi_{ij}$) 处。\n\n**2. 有限差分近似**\n\n偏导数使用二阶中心差分进行近似。对于一个通用场 $f(x,y)$，在网格点 $(i,j)$ 的导数为：\n$$\n(\\partial_x f)_{ij} \\approx \\frac{f_{i+1, j} - f_{i-1, j}}{2 \\Delta x}\n$$\n$$\n(\\partial_y f)_{ij} \\approx \\frac{f_{i, j+1} - f_{i, j-1}}{2 \\Delta y}\n$$\n周期性边界条件通过对索引取模 $N_x$ 和 $N_y$ 来处理。例如，索引 $i+1$ 变为 $(i+1) \\pmod{N_x}$，而 $i-1$ 变为 $(i-1+N_x) \\pmod{N_x}$。\n\n将此离散化应用于每个网格点 $(i,j)$ 上的三个控制方程，得到一个包含 $N$ 个线性代数方程的系统：\n$$\n\\frac{\\phi_{i+1,j} - \\phi_{i-1,j}}{2 \\Delta x} + r u_{ij} - \\beta y_j v_{ij} = 0\n$$\n$$\n\\frac{\\phi_{i,j+1} - \\phi_{i,j-1}}{2 \\Delta y} + r v_{ij} + \\beta y_j u_{ij} = 0\n$$\n$$\nc^2 \\left( \\frac{u_{i+1,j} - u_{i-1,j}}{2 \\Delta x} + \\frac{v_{i,j+1} - v_{i,j-1}}{2 \\Delta y} \\right) + \\alpha \\phi_{ij} = Q_{ij}\n$$\n其中 $Q_{ij} = Q(x_i, y_j)$ 是在网格点上给定的非绝热加热。\n\n**3. 线性系统的构建**\n\n该方程组可以写成矩阵形式 $\\mathbf{M}\\mathbf{z} = \\mathbf{b}$。矩阵 $\\mathbf{M}$ 是一个大小为 $N \\times N$ 的大型稀疏矩阵。其元素由离散化方程中的系数确定。对于每个线性索引为 $p=jN_x+i$ 的网格点 $(i,j)$，我们可以识别出与该点上三个方程相对应的 $\\mathbf{M}$ 的非零项。具体来说，对于行 $3p$、$3p+1$ 和 $3p+2$：\n- 第一个方程（纬向动量）将 $u_{ij}$ 和 $v_{ij}$（在索引 $p$ 处）与 $\\phi_{i\\pm 1, j}$（在相邻索引处）联系起来。\n- 第二个方程（经向动量）将 $u_{ij}$ 和 $v_{ij}$（在索引 $p$ 处）与 $\\phi_{i, j\\pm 1}$ 联系起来。\n- 第三个方程（热力学）将 $\\phi_{ij}$（在索引 $p$ 处）与 $u_{i\\pm 1, j}$ 和 $v_{i, j\\pm 1}$ 联系起来。\n\n通过遍历所有网格点 $(i,j)$ 并根据这些连接关系填充相应的条目来构建矩阵 $\\mathbf{M}$。由于系数 $r, \\alpha, \\beta, c$ 和网格是固定的，因此矩阵 $\\mathbf{M}$ 对所有测试案例都是相同的。\n\n右端项向量 $\\mathbf{b}$ 的长度为 $N$。每个网格点的前两个方程的右端项为 $0$。只有第三个方程有非零的强迫项。因此，对于每个网格点 $p=jN_x+i$，$\\mathbf{b}$ 中的条目为 $(0, 0, Q_{ij})$。\n\n**4. 求解方法**\n\n为了针对多种强迫情景高效地求解该系统，我们首先计算矩阵 $\\mathbf{M}$ 的 LU 分解。这是一个计算密集型步骤，但只需执行一次。为此，我们使用 `scipy.sparse.linalg.splu` 函数，该函数针对稀疏矩阵进行了优化。\n\n对于指定的三个测试案例中的每一个：\n1.  使用给定的高斯形式在网格上计算 SST 异常场 $T'(x,y)$。\n2.  计算非绝热加热场 $Q(x,y) = \\gamma T'(x,y)$。\n3.  从 $Q_{ij}$ 值构建右端项向量 $\\mathbf{b}$。\n4.  使用预先计算的 LU 分解求解线性系统 $\\mathbf{M}\\mathbf{z}=\\mathbf{b}$ 以得到 $\\mathbf{z}$。这是一个快速的代入步骤。\n5.  将得到的状态向量 $\\mathbf{z}$ 重塑为二维场 $u_{ij}$、$v_{ij}$ 和 $\\phi_{ij}$。\n\n**5. 诊断量的计算**\n\n获得解场后，计算最终的诊断量。\n1.  计算线性化的纬向风应力异常 $\\tau_x'(x,y)$。背景风为 $\\mathbf{U}_b = (U_b, V_b) = (-6, 0)$ 米/秒。线性化公式为：\n    $$\n    \\boldsymbol{\\tau}' = \\rho_{\\text{air}}\\,C_d\\left(\\|\\mathbf{U}_b\\|\\,\\mathbf{u}' + \\frac{\\mathbf{U}_b \\cdot \\mathbf{u}'}{\\|\\mathbf{U}_b\\|}\\,\\mathbf{U}_b\\right)\n    $$\n    当 $\\mathbf{u}'=(u,v)$ 时，该式简化为：\n    $$\n    \\tau_x' = \\rho_{\\text{air}}\\,C_d\\left( |U_b| u + \\frac{U_b u}{|U_b|} U_b \\right) = \\rho_{\\text{air}}\\,C_d (6u + \\frac{-6u}{6}(-6)) = 12 \\rho_{\\text{air}} C_d u\n    $$\n    使用解 $u_{ij}$ 为所有网格点计算场 $\\tau_x'_{ij}$。\n\n2.  区域平均纬向风应力异常 $\\overline{\\tau_x'}$ 在由 $\\{|y| \\le 5.0 \\times 10^5 \\text{ m}\\}$ 定义的赤道带上计算。根据问题陈述，这通过对所有 $y$ 坐标 $y_j$ 落在此带内的网格单元 $(i,j)$ 上的 $\\tau_x'_{ij}$ 进行简单算术平均来近似。首先识别出满足 $|y_j| \\le 5.0 \\times 10^5 \\text{ m}$ 的经向索引 $j$ 的集合，然后对所有 $i$ 和这些选定的 $j$ 取平均值。\n\n对三个测试案例中的每一个重复此过程，得到 $\\overline{\\tau_x'}$ 的三个值，这些值构成了最终结果。对于案例2，其中强迫振幅 $A=0$，加热 $Q=0$，导致 $(u,v,\\phi)$ 的解为零，因此 $\\overline{\\tau_x'}=0$，这可作为对数值框架的分析验证。",
            "answer": "```python\nimport numpy as np\nimport scipy.sparse\nimport scipy.sparse.linalg\n\ndef solve():\n    \"\"\"\n    Solves the steady linearized shallow-water equations for the Gill-type model.\n    \"\"\"\n    #\n    # === 1. Define Constants and Grid ===\n    #\n    \n    # Domain and Grid\n    Lx = 1.2e7  # m\n    Ly = 8.0e6  # m\n    Nx = 97\n    Ny = 65\n\n    # Physical Parameters (all in SI units)\n    c = 44.0          # m/s\n    beta = 2.3e-11    # 1/(m*s)\n    r = 2.0e-6        # 1/s\n    alpha = 2.0e-6    # 1/s\n    rho_air = 1.2     # kg/m^3\n    Cd = 1.3e-3       # dimensionless\n    gamma = 1.0e-5    # m^2/(s^3*K)\n    Ub = -6.0         # m/s\n    Vb = 0.0          # m/s\n\n    # Grid setup\n    dx = Lx / Nx\n    dy = Ly / Ny\n    x = -Lx/2 + np.arange(Nx) * dx\n    y = -Ly/2 + np.arange(Ny) * dy\n    X, Y = np.meshgrid(x, y)\n\n    total_vars = 3 * Nx * Ny\n    \n    #\n    # === 2. Construct the Linear System Matrix M ===\n    #\n    \n    # Use LIL format for efficient construction\n    M = scipy.sparse.lil_matrix((total_vars, total_vars), dtype=float)\n\n    # Coefficients for finite difference operators\n    inv_2dx = 1.0 / (2.0 * dx)\n    inv_2dy = 1.0 / (2.0 * dy)\n    c2_inv_2dx = c**2 * inv_2dx\n    c2_inv_2dy = c**2 * inv_2dy\n    \n    for j in range(Ny):\n        for i in range(Nx):\n            p = j * Nx + i # Linear index for grid point (i,j)\n            \n            # Neighbor indices with periodic wrap-around\n            ip1 = (i + 1) % Nx\n            im1 = (i - 1 + Nx) % Nx\n            jp1 = (j + 1) % Ny\n            jm1 = (j - 1 + Ny) % Ny\n\n            p_ip1 = j * Nx + ip1\n            p_im1 = j * Nx + im1\n            p_jp1 = jp1 * Nx + i\n            p_jm1 = jm1 * Nx + i\n\n            # Equation 1: Zonal momentum (row = 3*p)\n            M[3*p, 3*p] = r               # r*u\n            M[3*p, 3*p+1] = -beta * y[j]    # -beta*y*v\n            M[3*p, 3*p_ip1+2] = inv_2dx   # d/dx phi\n            M[3*p, 3*p_im1+2] = -inv_2dx  # d/dx phi\n            \n            # Equation 2: Meridional momentum (row = 3*p + 1)\n            M[3*p+1, 3*p] = beta * y[j]     # beta*y*u\n            M[3*p+1, 3*p+1] = r             # r*v\n            M[3*p+1, 3*p_jp1+2] = inv_2dy   # d/dy phi\n            M[3*p+1, 3*p_jm1+2] = -inv_2dy  # d/dy phi\n\n            # Equation 3: Thermodynamics (row = 3*p + 2)\n            M[3*p+2, 3*p_ip1] = c2_inv_2dx   # c^2*d/dx u\n            M[3*p+2, 3*p_im1] = -c2_inv_2dx  # c^2*d/dx u\n            M[3*p+2, 3*p_jp1+1] = c2_inv_2dy  # c^2*d/dy v\n            M[3*p+2, 3*p_jm1+1] = -c2_inv_2dy # c^2*d/dy v\n            M[3*p+2, 3*p+2] = alpha         # alpha*phi\n\n    # Convert to CSC format for efficient factorization and solving\n    M_csc = M.tocsc()\n    \n    #\n    # === 3. LU Factorize the Matrix ===\n    #\n    \n    lu_factor = scipy.sparse.linalg.splu(M_csc)\n    \n    #\n    # === 4. Define Test Cases and Solve ===\n    #\n    \n    test_cases = [\n        {'A': 2.0, 'Lx_prime': 1.5e6, 'Ly_prime': 5.0e5, 'x0': 0.0, 'y0': 0.0},\n        {'A': 0.0, 'Lx_prime': 1.0e6, 'Ly_prime': 5.0e5, 'x0': 0.0, 'y0': 0.0},\n        {'A': 2.0, 'Lx_prime': 1.0e6, 'Ly_prime': 6.0e5, 'x0': 1.0e6, 'y0': 1.0e6},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        A = case['A']\n        Lx_prime = case['Lx_prime']\n        Ly_prime = case['Ly_prime']\n        x0 = case['x0']\n        y0 = case['y0']\n\n        # Construct RHS vector b\n        if A == 0.0:\n            Q = np.zeros((Ny, Nx))\n        else:\n            T_prime = A * np.exp(-((X - x0)**2 / (2 * Lx_prime**2)) - ((Y - y0)**2 / (2 * Ly_prime**2)))\n            Q = gamma * T_prime\n\n        b = np.zeros(total_vars)\n        b[2::3] = Q.flatten()\n\n        # Solve the system\n        z = lu_factor.solve(b)\n        \n        # Reshape solution vector to 2D fields\n        u = z[0::3].reshape((Ny, Nx))\n        # v = z[1::3].reshape((Ny, Nx)) # v is not needed for tau_x'\n        \n        #\n        # === 5. Compute Diagnostic: Mean Zonal Wind Stress Anomaly ===\n        #\n        \n        # Formula: tau_x' = 12 * rho_air * Cd * u\n        tau_x_prime = 12.0 * rho_air * Cd * u\n        \n        # Define equatorial band and find corresponding grid indices\n        y_band_limit = 5.0e5\n        band_indices = np.where(np.abs(y) = y_band_limit)[0]\n        \n        # Calculate the arithmetic mean over the selected grid cells\n        if len(band_indices) > 0:\n            tau_x_mean = np.mean(tau_x_prime[band_indices, :])\n        else:\n            tau_x_mean = 0.0 # Should not happen with this grid\n        \n        results.append(tau_x_mean)\n\n    #\n    # === 6. Format and Print Output ===\n    #\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}