{
    "hands_on_practices": [
        {
            "introduction": "To understand the rhythmic nature of El Niño, we can distill the complex ocean-atmosphere system into a simple conceptual model. This exercise explores the canonical two-variable recharge oscillator, which captures the essential interplay between sea surface temperature ($T'$) and upper-ocean warm water volume ($W'$). By analyzing the eigenvalues of this system, you will uncover the fundamental phase relationship that governs the ENSO cycle, a critical piece of physical intuition for both theory and prediction. ",
            "id": "3877807",
            "problem": "A reduced dynamical description of the El Niño–Southern Oscillation (ENSO) can be built from the mixed-layer heat budget and equatorial mass continuity to couple Sea Surface Temperature (SST) anomalies and upper-ocean Warm Water Volume (WWV) anomalies. Consider the following physically motivated steps:\n\n- Begin with the mixed-layer heat budget, which in anomaly form can be expressed as $\\rho c_{p} h \\,\\frac{dT'}{dt} = Q'_{\\text{net}} - \\rho c_{p} w' \\Gamma$, where $\\rho$ is seawater density, $c_{p}$ is specific heat capacity, $h$ is mixed-layer depth, $T'$ is the SST anomaly, $Q'_{\\text{net}}$ is the net surface heat flux anomaly, $w'$ is the upwelling anomaly, and $\\Gamma$ is the vertical temperature gradient set by the thermocline. Parameterize $Q'_{\\text{net}}$ as a linear damping $- \\Lambda_{T} T'$ due to surface flux feedbacks, and relate $w'$ to thermocline displacement anomalies that are proportional to WWV anomalies $W'$ via large-scale continuity over the tropical Pacific basin.\n\n- For the WWV tendency, use equatorial mass continuity linking wind stress–forced divergence and convergence with recharge–discharge of the warm water pool. Parameterize the tendency as a linear discharge $- \\Lambda_{W} W'$ plus wind stress forcing that is proportional to the SST anomaly via atmospheric coupling, giving a term $- \\chi T'$.\n\nLinearizing and nondimensionalizing by $\\rho c_{p} h$ where appropriate leads to the canonical two-variable linear system for the SST anomaly $T'(t)$ and WWV anomaly $W'(t)$:\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\nT' \\\\\nW'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n- a & b \\\\\n- d & - c\n\\end{pmatrix}\n\\begin{pmatrix}\nT' \\\\\nW'\n\\end{pmatrix},\n$$\nwhere $a > 0$ represents effective thermal damping, $b > 0$ represents the sensitivity of SST tendency to WWV anomalies through thermocline feedback on upwelling, $c > 0$ represents WWV discharge, and $d > 0$ represents the strength of wind stress–forced WWV tendency generated by SST anomalies via Bjerknes coupling.\n\nAssume parameter values that are observationally and modeling-wise plausible for the tropical Pacific: $a = 0.8 \\ \\text{yr}^{-1}$, $b = 1.2 \\ \\text{yr}^{-1}$, $c = 0.7 \\ \\text{yr}^{-1}$, and $d = 1.6 \\ \\text{yr}^{-1}$. Let $\\lambda$ denote the eigenvalue with positive imaginary part and $v = (v_{T}, v_{W})^{\\top}$ its associated eigenvector normalized so that $v_{T} = 1$. Use the eigenstructure to infer the phase lead–lag between $W'$ and $T'$ in the oscillatory component of the solution. Specifically, if $T'(t)$ and $W'(t)$ evolve proportionally to $\\Re\\{v_{T} \\exp(\\lambda t)\\}$ and $\\Re\\{v_{W} \\exp(\\lambda t)\\}$, the phase lead angle $\\phi$ of $W'$ relative to $T'$ is given by the argument of $v_{W}/v_{T}$.\n\nCompute the eigenvalues and the corresponding eigenvector $v$ (with $v_{T} = 1$), and then determine the phase lead angle $\\phi$ of $W'$ relative to $T'$ in radians. Express your final answer for $\\phi$ in radians and round your answer to four significant figures.",
            "solution": "The user wants me to solve a problem related to a simplified model of the El Niño-Southern Oscillation (ENSO).\n\nHere's my plan:\n1.  **Validate the problem statement.**\n    *   **Step 1: Extract Givens.** I will list all the equations, parameters, and definitions provided in the problem description.\n    *   **Step 2: Validate Using Extracted Givens.** I will check the problem for scientific soundness, self-consistency, and well-posedness. The problem describes a canonical model in climate science (the delayed oscillator model or a variant thereof), so it should be scientifically grounded. The parameters are given, and the task is clearly defined. It seems valid.\n2.  **Solve the problem if valid.**\n    *   The core of the problem is to analyze a 2x2 linear system of ordinary differential equations.\n    *   The system is given by $\\frac{d}{dt} \\mathbf{x} = A \\mathbf{x}$, where $\\mathbf{x} = (T', W')^T$ and $A = \\begin{pmatrix} -a & b \\\\ -d & -c \\end{pmatrix}$.\n    *   The parameters are given: $a = 0.8$, $b = 1.2$, $c = 0.7$, and $d = 1.6$. All have units of $\\text{yr}^{-1}$.\n    *   The task is to:\n        1.  Compute the eigenvalues of the matrix $A$.\n        2.  Identify the eigenvalue $\\lambda$ with a positive imaginary part.\n        3.  Find the corresponding eigenvector $v = (v_T, v_W)^T$.\n        4.  Normalize the eigenvector so that its first component, $v_T$, is equal to 1.\n        5.  The problem states that the phase lead angle $\\phi$ of $W'$ relative to $T'$ is the argument of the ratio $v_W / v_T$. Since $v_T = 1$, this simplifies to $\\phi = \\arg(v_W)$.\n        6.  Calculate $\\phi$ in radians and round to four significant figures.\n\n### Step-by-step Solution Execution:\n\n**1. Define the Matrix A:**\nThe matrix is $A = \\begin{pmatrix} -a & b \\\\ -d & -c \\end{pmatrix}$.\nSubstitute the given values:\n$a = 0.8$\n$b = 1.2$\n$c = 0.7$\n$d = 1.6$\nSo, $A = \\begin{pmatrix} -0.8 & 1.2 \\\\ -1.6 & -0.7 \\end{pmatrix}$.\n\n**2. Calculate the Eigenvalues:**\nThe eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(A - \\lambda I) = 0$.\n$\\det \\begin{pmatrix} -0.8 - \\lambda & 1.2 \\\\ -1.6 & -0.7 - \\lambda \\end{pmatrix} = 0$\n$(-0.8 - \\lambda)(-0.7 - \\lambda) - (1.2)(-1.6) = 0$\n$\\lambda^2 + 0.7\\lambda + 0.8\\lambda + (0.8)(0.7) + (1.2)(1.6) = 0$\n$\\lambda^2 + 1.5\\lambda + 0.56 + 1.92 = 0$\n$\\lambda^2 + 1.5\\lambda + 2.48 = 0$\n\nThis is a quadratic equation of the form $Ax^2 + Bx + C = 0$, with solutions $\\lambda = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$.\nHere, $A=1$, $B=1.5$, $C=2.48$.\n$\\lambda = \\frac{-1.5 \\pm \\sqrt{1.5^2 - 4(1)(2.48)}}{2(1)}$\n$\\lambda = \\frac{-1.5 \\pm \\sqrt{2.25 - 9.92}}{2}$\n$\\lambda = \\frac{-1.5 \\pm \\sqrt{-7.67}}{2}$\n$\\lambda = \\frac{-1.5 \\pm i\\sqrt{7.67}}{2}$\n$\\lambda = -0.75 \\pm i \\frac{\\sqrt{7.67}}{2}$\n\nThe problem asks for the eigenvalue $\\lambda$ with the positive imaginary part.\nSo, $\\lambda = -0.75 + i \\frac{\\sqrt{7.67}}{2}$.\nLet's calculate the numerical value of the imaginary part:\n$\\sqrt{7.67} \\approx 2.7694765$\n$\\frac{\\sqrt{7.67}}{2} \\approx 1.3847382$\nSo, $\\lambda \\approx -0.75 + 1.3847i$.\n\n**3. Find the Corresponding Eigenvector:**\nWe need to solve $(A - \\lambda I)v = 0$ for the eigenvector $v = (v_T, v_W)^T$.\n$A - \\lambda I = \\begin{pmatrix} -0.8 - \\lambda & 1.2 \\\\ -1.6 & -0.7 - \\lambda \\end{pmatrix}$\nLet's use the first row of the matrix equation $(A - \\lambda I)v = 0$:\n$(-0.8 - \\lambda)v_T + 1.2 v_W = 0$\n\nThe problem requires normalization such that $v_T = 1$.\nSo, $(-0.8 - \\lambda)(1) + 1.2 v_W = 0$.\n$1.2 v_W = 0.8 + \\lambda$.\n$v_W = \\frac{0.8 + \\lambda}{1.2}$.\n\nNow, substitute the value of $\\lambda = -0.75 + i \\frac{\\sqrt{7.67}}{2}$.\n$v_W = \\frac{0.8 + (-0.75 + i \\frac{\\sqrt{7.67}}{2})}{1.2}$\n$v_W = \\frac{0.05 + i \\frac{\\sqrt{7.67}}{2}}{1.2}$\n$v_W = \\frac{0.05}{1.2} + i \\frac{\\sqrt{7.67}}{2.4}$\n\nLet's compute the numerical values for the real and imaginary parts of $v_W$.\nReal part: $\\Re(v_W) = \\frac{0.05}{1.2} = \\frac{5}{120} = \\frac{1}{24} \\approx 0.041666...$\nImaginary part: $\\Im(v_W) = \\frac{\\sqrt{7.67}}{2.4} \\approx \\frac{2.7694765}{2.4} \\approx 1.1539485$\n\nSo, $v_W \\approx 0.041667 + 1.153949i$.\nThe eigenvector is $v = \\begin{pmatrix} 1 \\\\ \\frac{0.05}{1.2} + i \\frac{\\sqrt{7.67}}{2.4} \\end{pmatrix}$.\n\nLet's double-check using the second row of $(A - \\lambda I)v = 0$.\n$-1.6 v_T + (-0.7 - \\lambda) v_W = 0$.\nWith $v_T = 1$:\n$-1.6 + (-0.7 - \\lambda) v_W = 0$.\n$v_W = \\frac{1.6}{-0.7 - \\lambda}$.\nSubstitute $\\lambda = -0.75 + i \\frac{\\sqrt{7.67}}{2}$:\n$v_W = \\frac{1.6}{-0.7 - (-0.75 + i \\frac{\\sqrt{7.67}}{2})} = \\frac{1.6}{0.05 - i \\frac{\\sqrt{7.67}}{2}}$.\nTo simplify, multiply numerator and denominator by the conjugate of the denominator:\n$v_W = \\frac{1.6}{0.05 - i \\frac{\\sqrt{7.67}}{2}} \\times \\frac{0.05 + i \\frac{\\sqrt{7.67}}{2}}{0.05 + i \\frac{\\sqrt{7.67}}{2}}$\nDenominator: $(0.05)^2 + (\\frac{\\sqrt{7.67}}{2})^2 = 0.0025 + \\frac{7.67}{4} = 0.0025 + 1.9175 = 1.92$.\nNumerator: $1.6(0.05 + i \\frac{\\sqrt{7.67}}{2}) = 0.08 + i \\frac{1.6\\sqrt{7.67}}{2} = 0.08 + i (0.8)\\sqrt{7.67}$.\n\nWait, there is a discrepancy. Let me recheck the calculations.\n\nLet's go back to $v_W = \\frac{0.8 + \\lambda}{1.2}$.\n$\\lambda = -0.75 + i \\frac{\\sqrt{7.67}}{2}$.\n$v_W = \\frac{0.8 - 0.75 + i \\frac{\\sqrt{7.67}}{2}}{1.2} = \\frac{0.05 + i \\frac{\\sqrt{7.67}}{2}}{1.2}$.\nThis seems correct.\n\nLet's recheck the denominator of the second method.\nDenominator was $1.6(-d) \\times 1.2(b)$. Wait, no.\nThe characteristic polynomial was $\\lambda^2 - (\\text{tr } A)\\lambda + (\\det A) = 0$.\n$\\text{tr } A = -a - c = -0.8 - 0.7 = -1.5$.\n$\\det A = (-a)(-c) - (b)(-d) = ac + bd = (0.8)(0.7) + (1.2)(1.6) = 0.56 + 1.92 = 2.48$.\nSo, $\\lambda^2 + 1.5\\lambda + 2.48 = 0$. This is correct.\n\nLet's check the calculation of $v_W$ from the second row again.\n$v_W = \\frac{1.6}{-(0.7 + \\lambda)}$.\nLet's see the numerator from the first row calculation: $0.8 + \\lambda$.\nLet's see the denominator from the first row calculation: $1.2$.\nLet's see the numerator from the second row calculation: $1.6$.\nLet's see the denominator from the second row calculation: $-(0.7 + \\lambda)$.\n\nSo we are checking if $\\frac{0.8 + \\lambda}{1.2} = \\frac{1.6}{-(0.7 + \\lambda)}$.\nThis is equivalent to checking if $-(0.8+\\lambda)(0.7+\\lambda) = (1.2)(1.6)$.\n$-(\\lambda^2 + 1.5\\lambda + 0.56) = 1.92$.\nFrom the characteristic equation, $\\lambda^2 + 1.5\\lambda + 2.48 = 0$, we have $\\lambda^2 + 1.5\\lambda = -2.48$.\nSubstitute this into the check:\n$-(-2.48 + 0.56) = -(-1.92) = 1.92$.\nThe other side is $(1.2)(1.6) = 1.92$.\nSo, $1.92 = 1.92$. The two expressions for $v_W$ are indeed consistent. My numerical calculation must have had an error before.\n\nLet me recalculate the second form:\n$v_W = \\frac{1.6}{0.05 - i \\frac{\\sqrt{7.67}}{2}}$\nDenominator magnitude squared: $(0.05)^2 + (\\frac{\\sqrt{7.67}}{2})^2 = 0.0025 + 7.67/4 = 0.0025 + 1.9175 = 1.92$.\n$v_W = \\frac{1.6 (0.05 + i \\frac{\\sqrt{7.67}}{2})}{1.92} = \\frac{0.08 + i \\frac{1.6\\sqrt{7.67}}{2}}{1.92} = \\frac{0.08}{1.92} + i \\frac{0.8\\sqrt{7.67}}{1.92}$.\n$\\frac{0.08}{1.92} = \\frac{8}{192} = \\frac{1}{24}$. This matches the real part from the first calculation.\n$\\frac{0.8}{1.92} = \\frac{80}{192} = \\frac{10}{24} = \\frac{5}{12}$.\nSo the imaginary part is $\\frac{5}{12}\\sqrt{7.67}$.\n\nLet's check the first form's imaginary part again.\n$\\Im(v_W) = \\frac{\\sqrt{7.67}}{2.4} = \\frac{\\sqrt{7.67}}{12/5} = \\frac{5\\sqrt{7.67}}{12}$.\nAh, I see. What I calculated before was $\\frac{\\sqrt{7.67}}{2.4}$ and what I got from the second form was $\\frac{0.8\\sqrt{7.67}}{1.92}$.\n$\\frac{0.8}{1.92} = \\frac{80}{192} = \\frac{16 \\times 5}{16 \\times 12} = \\frac{5}{12}$.\nThe imaginary part is $\\frac{5}{12}\\sqrt{7.67}$.\nMy first calculation was: $\\Im(v_W) = \\frac{\\sqrt{7.67}}{2.4} = \\frac{\\sqrt{7.67}}{12/5} = \\frac{5\\sqrt{7.67}}{12}$. This is correct.\nSo both methods give:\n$v_W = \\frac{1}{24} + i \\frac{5\\sqrt{7.67}}{12}$.\n\nSo, my first method numerical calculation was fine, I was just confused during the sanity check.\n$v_W = \\frac{0.05}{1.2} + i \\frac{\\sqrt{7.67}}{2.4} = \\frac{1}{24} + i \\frac{\\sqrt{7.67}}{2.4}$.\n\nNow I can proceed.\n\n**4. Determine the phase lead angle $\\phi$:**\nThe problem states that $\\phi$ is the argument of $v_W/v_T$.\nSince $v_T=1$, $\\phi = \\arg(v_W)$.\nWe have $v_W = x + iy$, where $x = \\frac{1}{24}$ and $y = \\frac{\\sqrt{7.67}}{2.4}$.\nThe argument $\\phi$ is given by $\\arctan(y/x)$.\n$\\phi = \\arctan\\left(\\frac{\\frac{\\sqrt{7.67}}{2.4}}{\\frac{1}{24}}\\right) = \\arctan\\left(\\frac{\\sqrt{7.67}}{2.4} \\times 24\\right) = \\arctan(10\\sqrt{7.67})$.\n\nLet's calculate the value.\n$\\sqrt{7.67} \\approx 2.7694765$.\n$10\\sqrt{7.67} \\approx 27.694765$.\n$\\phi = \\arctan(27.694765)$.\nThe calculator should be in radians mode.\n$\\phi \\approx 1.534685$ radians.\n\nThe problem asks to round the answer to four significant figures.\n$\\phi \\approx 1.535$.\n\nLet's re-read the problem to ensure I've followed all instructions.\n- \"eigenvalue $\\lambda$ with positive imaginary part\": Done.\n- \"eigenvector normalized so that $v_T = 1$\": Done.\n- \"phase lead angle $\\phi$ ... is given by the argument of $v_W/v_T$\": Done.\n- \"Compute ... and then determine ... $\\phi$ ... in radians\": Done.\n- \"round your answer to four significant figures\": Done.\n\nThe phase angle is expected to be close to $\\pi/2 \\approx 1.57$ radians, which corresponds to a quarter-period lead. Let's see if this makes sense physically.\nThe system is a damped oscillator. The SST anomaly ($T'$) and WWV anomaly ($W'$) are expected to oscillate.\nEquation for $T'$: $\\frac{dT'}{dt} = -aT' + bW'$. The rate of change of temperature is driven by $W'$.\nEquation for $W'$: $\\frac{dW'}{dt} = -cW' - dT'$. The rate of change of warm water volume is driven by $-T'$.\nThis structure resembles a simple harmonic oscillator if we ignore the damping terms:\n$\\frac{dT'}{dt} \\approx bW'$\n$\\frac{dW'}{dt} \\approx -dT'$\nDifferentiating the first equation gives $\\frac{d^2T'}{dt^2} \\approx b \\frac{dW'}{dt} \\approx b(-dT') = -bdT'$.\nThis is $\\frac{d^2T'}{dt^2} + bdT' = 0$, the equation for simple harmonic motion with angular frequency $\\omega = \\sqrt{bd}$.\nIn this undamped system, $W' \\approx \\frac{1}{b}\\frac{dT'}{dt}$. If $T' \\sim \\cos(\\omega t)$, then $\\frac{dT'}{dt} \\sim -\\sin(\\omega t)$, so $W'$ is proportional to $-\\sin(\\omega t) = \\cos(\\omega t + \\pi/2)$. This means $W'$ leads $T'$ by $\\pi/2$.\nOur calculated phase lead is $\\phi \\approx 1.535$ radians. $\\pi/2 \\approx 1.5708$ radians. The result is very close to $\\pi/2$, which makes perfect physical sense. The damping terms slightly modify this phase relationship. The real part of $v_W$ is small and positive, which means the phase is slightly less than $\\pi/2$. This is consistent with my calculation.\n\nI will now structure the final output according to the rules.\nThe final answer must be a single number, rounded to four significant figures.\nThe final answer is $1.535$.\nThe problem is valid.\nI will write the solution and then the final answer in the required XML format.\nI will double-check all mandatory LaTeX formatting rules.\n- all mathematical entities in LaTeX: yes\n- no markdown headers: yes\n- symbolic reasoning: yes, until the final numerical evaluation\n- final answer box: single number, exact form unless required otherwise (rounding is required here), no units. ok.\n- all other specific LaTeX rules (pmatrix, frac, ^, exp, ln, etc.): I used `\\arctan` and `\\sqrt`. The result is a single number, so `pmatrix` is not needed for the final answer.\n\nI am confident in my process and result.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- **System of ODEs**:\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\nT' \\\\\nW'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-a & b \\\\\n-d & -c\n\\end{pmatrix}\n\\begin{pmatrix}\nT' \\\\\nW'\n\\end{pmatrix}\n$$\n- **Parameters**: $a > 0$, $b > 0$, $c > 0$, $d > 0$.\n- **Parameter Values**: $a = 0.8 \\ \\text{yr}^{-1}$, $b = 1.2 \\ \\text{yr}^{-1}$, $c = 0.7 \\ \\text{yr}^{-1}$, $d = 1.6 \\ \\text{yr}^{-1}$.\n- **Eigenvalue**: $\\lambda$ denotes the eigenvalue with a positive imaginary part.\n- **Eigenvector**: $v = (v_{T}, v_{W})^{\\top}$ is the eigenvector associated with $\\lambda$.\n- **Normalization**: The eigenvector is normalized so that $v_{T} = 1$.\n- **Phase Lead Definition**: The phase lead angle $\\phi$ of $W'$ relative to $T'$ is given by the argument of $v_{W}/v_{T}$.\n- **Task**: Compute the eigenvalues, the eigenvector $v$, and the phase lead angle $\\phi$ in radians, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes a simplified, linear two-variable model of the El Niño-Southern Oscillation, a well-established topic in climate dynamics known as a recharge oscillator model. The parameter values are stated to be plausible. The model is a standard tool for understanding the basic dynamics of ENSO. It is scientifically sound.\n- **Well-Posed**: The problem is a standard eigenvalue problem for a $2\\times2$ matrix. The parameters are fully specified, and the objectives are clear and unambiguous. A unique solution for the eigenvalues and the specified eigenvector exists. The question is well-posed.\n- **Objective**: The language is formal and technical, free from any subjective or biased statements.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the solution.\n\n**Solution**\n\nThe dynamical system is described by the matrix equation $\\frac{d\\mathbf{x}}{dt} = A\\mathbf{x}$, where $\\mathbf{x} = \\begin{pmatrix} T' \\\\ W' \\end{pmatrix}$ and the matrix $A$ is given by:\n$$\nA = \\begin{pmatrix} -a & b \\\\ -d & -c \\end{pmatrix}\n$$\nSubstituting the given parameter values $a = 0.8$, $b = 1.2$, $c = 0.7$, and $d = 1.6$:\n$$\nA = \\begin{pmatrix} -0.8 & 1.2 \\\\ -1.6 & -0.7 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of the matrix $A$ are the solutions to the characteristic equation $\\det(A - \\lambda I) = 0$, where $I$ is the identity matrix.\n$$\n\\det\\begin{pmatrix} -0.8 - \\lambda & 1.2 \\\\ -1.6 & -0.7 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-0.8 - \\lambda)(-0.7 - \\lambda) - (1.2)(-1.6) = 0\n$$\n$$\n\\lambda^2 + 0.7\\lambda + 0.8\\lambda + (0.8)(0.7) + (1.2)(1.6) = 0\n$$\n$$\n\\lambda^2 + 1.5\\lambda + 0.56 + 1.92 = 0\n$$\n$$\n\\lambda^2 + 1.5\\lambda + 2.48 = 0\n$$\nWe solve this quadratic equation for $\\lambda$ using the quadratic formula, $\\lambda = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$, with coefficients $A=1$, $B=1.5$, and $C=2.48$:\n$$\n\\lambda = \\frac{-1.5 \\pm \\sqrt{(1.5)^2 - 4(1)(2.48)}}{2} = \\frac{-1.5 \\pm \\sqrt{2.25 - 9.92}}{2} = \\frac{-1.5 \\pm \\sqrt{-7.67}}{2}\n$$\nThe eigenvalues are a complex conjugate pair:\n$$\n\\lambda = -\\frac{1.5}{2} \\pm i\\frac{\\sqrt{7.67}}{2} = -0.75 \\pm i\\frac{\\sqrt{7.67}}{2}\n$$\nThe problem specifies using the eigenvalue $\\lambda$ with the positive imaginary part:\n$$\n\\lambda = -0.75 + i\\frac{\\sqrt{7.67}}{2}\n$$\nNext, we find the eigenvector $v = \\begin{pmatrix} v_T \\\\ v_W \\end{pmatrix}$ corresponding to this $\\lambda$ by solving the equation $(A - \\lambda I)v = 0$.\n$$\n\\begin{pmatrix} -0.8 - \\lambda & 1.2 \\\\ -1.6 & -0.7 - \\lambda \\end{pmatrix} \\begin{pmatrix} v_T \\\\ v_W \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nFrom the first row of the matrix equation, we have:\n$$\n(-0.8 - \\lambda)v_T + 1.2v_W = 0\n$$\nThe problem requires normalizing the eigenvector such that its first component $v_T = 1$. Substituting this condition:\n$$\n(-0.8 - \\lambda) + 1.2v_W = 0 \\implies v_W = \\frac{0.8 + \\lambda}{1.2}\n$$\nNow, we substitute the expression for $\\lambda$:\n$$\nv_W = \\frac{0.8 + \\left(-0.75 + i\\frac{\\sqrt{7.67}}{2}\\right)}{1.2} = \\frac{0.05 + i\\frac{\\sqrt{7.67}}{2}}{1.2}\n$$\n$$\nv_W = \\frac{0.05}{1.2} + i\\frac{\\sqrt{7.67}}{2.4}\n$$\nThe eigenvector is thus $v = \\begin{pmatrix} 1 \\\\ \\frac{0.05}{1.2} + i\\frac{\\sqrt{7.67}}{2.4} \\end{pmatrix}$.\n\nThe phase lead angle $\\phi$ of $W'$ relative to $T'$ is given by the argument of the ratio $\\frac{v_W}{v_T}$. Since $v_T = 1$, this simplifies to $\\phi = \\arg(v_W)$.\nThe complex number $v_W$ can be written as $x + iy$, where $x = \\frac{0.05}{1.2}$ and $y = \\frac{\\sqrt{7.67}}{2.4}$. Both $x$ and $y$ are positive, so the angle $\\phi$ lies in the first quadrant and is given by $\\arctan(\\frac{y}{x})$.\n$$\n\\phi = \\arctan\\left(\\frac{\\frac{\\sqrt{7.67}}{2.4}}{\\frac{0.05}{1.2}}\\right) = \\arctan\\left(\\frac{\\sqrt{7.67}}{2.4} \\cdot \\frac{1.2}{0.05}\\right)\n$$\n$$\n\\phi = \\arctan\\left(\\frac{\\sqrt{7.67}}{2 \\cdot 0.05}\\right) = \\arctan\\left(\\frac{\\sqrt{7.67}}{0.1}\\right) = \\arctan(10\\sqrt{7.67})\n$$\nTo obtain the final numerical answer, we compute this value in radians:\n$$\n\\phi \\approx \\arctan(10 \\times 2.7694765) = \\arctan(27.694765)\n$$\n$$\n\\phi \\approx 1.5346850 \\text{ rad}\n$$\nRounding the result to four significant figures as requested:\n$$\n\\phi \\approx 1.535 \\text{ rad}\n$$",
            "answer": "$$\\boxed{1.535}$$"
        },
        {
            "introduction": "While simple oscillators reveal the \"why\" of ENSO's existence, understanding its real-world impacts requires accounting for spatial patterns. This practice advances to an intermediate-complexity model that distinguishes between the western, central, and eastern Pacific, providing a more realistic representation of the coupled system. Through a linear stability analysis, you will not only identify the dominant mode of variability but also learn to use diagnostic metrics to interpret its spatial structure and confirm its consistency with the physical Bjerknes feedback mechanism. ",
            "id": "3877832",
            "problem": "You are given a linear, intermediate-complexity model of El Niño-Southern Oscillation (ENSO), intended to capture the leading dynamical mode arising from coupled ocean-atmosphere feedbacks. The state vector comprises three equatorial Pacific region Sea Surface Temperature (SST) anomalies and one thermocline depth anomaly: $\\mathbf{x} = [T_W, T_C, T_E, h]^\\top$, where $T_W$, $T_C$, and $T_E$ are the SST anomalies for western, central, and eastern equatorial Pacific, respectively, and $h$ is the eastern Pacific thermocline depth anomaly. All tendencies are expressed per month, and time is measured in months. The Bjerknes feedback is represented by a basin-wide zonal wind stress anomaly $\\tau$ that responds instantaneously to SST anomalies in the central and eastern regions according to $\\tau = c_C T_C + c_E T_E$, where $c_C$ and $c_E$ are coupling coefficients. The system is linearized around the climatological mean, with Newtonian damping and linear upwelling effects. The governing equations are\n$$\n\\frac{dT_W}{dt} = -\\mu_W T_W + \\lambda_W h + \\rho_W \\tau,\n$$\n$$\n\\frac{dT_C}{dt} = -\\mu_C T_C + \\lambda_C h + \\rho_C \\tau,\n$$\n$$\n\\frac{dT_E}{dt} = -\\mu_E T_E + \\lambda_E h + \\rho_E \\tau,\n$$\n$$\n\\frac{dh}{dt} = -\\nu h + \\kappa \\tau,\n$$\nwhere all coefficients are constants. The parameters $\\mu_W$, $\\mu_C$, and $\\mu_E$ are SST damping rates (inverse months), $\\lambda_W$, $\\lambda_C$, and $\\lambda_E$ are sensitivities of SST to thermocline changes (inverse months), $\\rho_W$, $\\rho_C$, and $\\rho_E$ are sensitivities of SST to wind stress (inverse months), $\\nu$ is the thermocline damping rate (inverse months), and $\\kappa$ is the sensitivity of thermocline depth to wind stress (inverse months). The model can be written in matrix form as $\\frac{d\\mathbf{x}}{dt} = \\mathbf{A}\\mathbf{x}$, with\n\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\n-\\mu_W & \\rho_W c_C & \\rho_W c_E & \\lambda_W \\\\\n0 & -\\mu_C + \\rho_C c_C & \\rho_C c_E & \\lambda_C \\\\\n0 & \\rho_E c_C & -\\mu_E + \\rho_E c_E & \\lambda_E \\\\\n0 & \\kappa c_C & \\kappa c_E & -\\nu \\\\\n\\end{bmatrix}.\n$$\n\nYour task is to compute, for specified parameter sets, the leading (most unstable) eigenvalue and its associated eigenvector of $\\mathbf{A}$, interpret the spatial pattern of the mode in terms of the Bjerknes feedback loop, and produce a quantifiable summary. The leading eigenvalue is the eigenvalue $\\lambda_{\\max}$ with the largest real part. If the leading eigenvalue is complex, its imaginary part represents an angular frequency in radians per month. The associated eigenvector may be complex; for the spatial interpretation you must use the real part of the normalized eigenvector.\n\nNormalization requirement: Let $\\mathbf{v}$ be the eigenvector for $\\lambda_{\\max}$. Compute its complex norm $\\|\\mathbf{v}\\|_2 = \\sqrt{\\sum_i |v_i|^2}$ and define the normalized eigenvector real-part pattern as $\\hat{\\mathbf{v}} = \\mathrm{Re}(\\mathbf{v}) / \\|\\mathbf{v}\\|_2$. The components of $\\hat{\\mathbf{v}}$ correspond to $[v_W, v_C, v_E, v_h]$.\n\nFeedback interpretation metrics:\n- Define the wind stress projection on the mode as $\\tau^\\star = c_C v_C + c_E v_E$ using the components of $\\hat{\\mathbf{v}}$.\n- Define the eastward-focus index as $R = \\frac{|v_E|}{|v_W| + |v_C| + \\epsilon}$ with $\\epsilon = 10^{-12}$ to avoid division by zero.\n- Define the Bjerknes-consistency boolean $B$ to be true if both $v_E \\cdot \\tau^\\star > 0$ and $v_h \\cdot \\tau^\\star > 0$, and false otherwise.\n\nUnits:\n- All rates ($\\mu_W$, $\\mu_C$, $\\mu_E$, $\\nu$, $\\lambda_W$, $\\lambda_C$, $\\lambda_E$, $\\rho_W$, $\\rho_C$, $\\rho_E$, $\\kappa$) are in inverse months.\n- The leading eigenvalue real part should be reported in inverse months.\n- The leading eigenvalue imaginary part (if any) should be reported in radians per month.\n\nAngle unit requirement: Report the imaginary part of the leading eigenvalue in radians per month.\n\nTest suite:\nCompute the outputs for the following parameter sets:\n\n- Case A (moderate positive feedback, damped oscillation expected): $\\mu_W = 0.5$, $\\mu_C = 0.45$, $\\mu_E = 0.4$, $\\nu = 0.35$, $\\lambda_W = 0.2$, $\\lambda_C = 0.3$, $\\lambda_E = 0.5$, $\\rho_W = 0.1$, $\\rho_C = 0.2$, $\\rho_E = 0.3$, $c_C = 0.8$, $c_E = 1.0$, $\\kappa = 0.6$.\n- Case B (near-critical feedback, weakly unstable or nearly neutral oscillation possible): $\\mu_W = 0.45$, $\\mu_C = 0.4$, $\\mu_E = 0.35$, $\\nu = 0.3$, $\\lambda_W = 0.25$, $\\lambda_C = 0.35$, $\\lambda_E = 0.6$, $\\rho_W = 0.15$, $\\rho_C = 0.25$, $\\rho_E = 0.4$, $c_C = 0.9$, $c_E = 1.2$, $\\kappa = 1.0$.\n- Case C (no Bjerknes feedback, purely damped dynamics): $\\mu_W = 0.5$, $\\mu_C = 0.5$, $\\mu_E = 0.5$, $\\nu = 0.4$, $\\lambda_W = 0.2$, $\\lambda_C = 0.2$, $\\lambda_E = 0.2$, $\\rho_W = 0.1$, $\\rho_C = 0.1$, $\\rho_E = 0.1$, $c_C = 0.0$, $c_E = 0.0$, $\\kappa = 0.5$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result must be a bracket-enclosed comma-separated list with the following eight entries in order: $[\\mathrm{Re}(\\lambda_{\\max}), \\mathrm{Im}(\\lambda_{\\max}), v_W, v_C, v_E, v_h, R, B]$. Here $B$ must be a boolean. For example, the output should resemble $[[\\ldots],[\\ldots],[\\ldots]]$ as a single line.\n\nNo user input or external data is permitted; all parameter values are specified above and must be embedded in the program. The program must compute the matrices, find the leading eigenpairs, normalize the eigenvectors, compute $\\tau^\\star$, compute $R$, evaluate $B$, and print the final results in the exact format described. All numeric results must be floats, and $B$ must be a boolean value. Express the leading eigenvalue real parts in inverse months and imaginary parts in radians per month, as defined by the model time unit.",
            "solution": "The problem requires a linear stability analysis of a simplified model for the El Niño-Southern Oscillation (ENSO). The model's dynamics are described by a system of four linear ordinary differential equations, which can be expressed in matrix form as $\\frac{d\\mathbf{x}}{dt} = \\mathbf{A}\\mathbf{x}$. The state vector $\\mathbf{x} = [T_W, T_C, T_E, h]^\\top$ represents anomalies in sea surface temperature (SST) in the western ($T_W$), central ($T_C$), and eastern ($T_E$) equatorial Pacific, and the thermocline depth anomaly ($h$) in the east.\n\nThe solution to such a system is a superposition of modes of the form $\\mathbf{x}(t) = \\mathbf{v} e^{\\lambda t}$, where $(\\lambda, \\mathbf{v})$ is an eigenpair (eigenvalue and corresponding eigenvector) of the matrix $\\mathbf{A}$. The long-term behavior of the system is governed by the \"leading mode,\" which corresponds to the eigenvalue with the largest real part, denoted $\\lambda_{\\max}$. The real part, $\\mathrm{Re}(\\lambda_{\\max})$, determines the growth rate of this mode. If $\\mathrm{Re}(\\lambda_{\\max}) > 0$, the mode is unstable and grows exponentially, representing the development of an El Niño or La Niña event. If $\\mathrm{Re}(\\lambda_{\\max}) < 0$, the mode is stable and decays. The imaginary part, $\\mathrm{Im}(\\lambda_{\\max})$, represents the angular frequency of oscillation of the mode, with a period of $T = 2\\pi / |\\mathrm{Im}(\\lambda_{\\max})|$ months.\n\nThe core of the task is to construct the $4 \\times 4$ system matrix $\\mathbf{A}$ for three different sets of physical parameters and then compute its leading eigenpair. The matrix $\\mathbf{A}$ is given by:\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\n-\\mu_W & \\rho_W c_C & \\rho_W c_E & \\lambda_W \\\\\n0 & -\\mu_C + \\rho_C c_C & \\rho_C c_E & \\lambda_C \\\\\n0 & \\rho_E c_C & -\\mu_E + \\rho_E c_E & \\lambda_E \\\\\n0 & \\kappa c_C & \\kappa c_E & -\\nu \\\\\n\\end{bmatrix}\n$$\nwhere the parameters represent various physical processes such as damping ($\\mu_i, \\nu$), thermocline-SST interaction ($\\lambda_i$), and wind-driven feedbacks ($\\rho_i, c_i, \\kappa$). All rates are in units of inverse months.\n\nThe computational procedure for each parameter case is as follows:\n1.  Construct the matrix $\\mathbf{A}$ by substituting the given parameter values. The parameters are: $\\mu_W, \\mu_C, \\mu_E, \\nu, \\lambda_W, \\lambda_C, \\lambda_E, \\rho_W, \\rho_C, \\rho_E, c_C, c_E, \\kappa$.\n2.  Solve the eigenvalue problem $\\mathbf{A}\\mathbf{v} = \\lambda\\mathbf{v}$ to find all four eigenvalues $\\lambda_i$ and their corresponding eigenvectors $\\mathbf{v}_i$. This is a standard numerical linear algebra task.\n3.  Identify the leading eigenvalue $\\lambda_{\\max}$ by finding the eigenvalue with the largest real part. The corresponding eigenvector is $\\mathbf{v}$. The eigenvalues and eigenvectors can be complex-valued.\n4.  The spatial pattern of the mode is derived from the real part of the leading eigenvector. As specified, this pattern, $\\hat{\\mathbf{v}}$, is obtained by normalizing the real part of $\\mathbf{v}$ by the complex L2-norm of $\\mathbf{v}$:\n    $$\n    \\hat{\\mathbf{v}} = \\frac{\\mathrm{Re}(\\mathbf{v})}{\\|\\mathbf{v}\\|_2} = \\frac{\\mathrm{Re}(\\mathbf{v})}{\\sqrt{\\sum_{i=1}^4 |v_i|^2}}\n    $$\n    The components of $\\hat{\\mathbf{v}}$ are denoted $[v_W, v_C, v_E, v_h]^\\top$. These represent the relative strengths and signs of the anomalies in the four state variables for the dominant mode.\n5.  Compute the derived metrics to interpret the physical feedbacks within the mode:\n    - The wind stress anomaly associated with the mode's spatial pattern is projected as $\\tau^\\star = c_C v_C + c_E v_E$.\n    - The eastward-focus index, $R = \\frac{|v_E|}{|v_W| + |v_C| + \\epsilon}$ (with $\\epsilon = 10^{-12}$), quantifies the extent to which the SST anomaly pattern is concentrated in the eastern Pacific.\n    - The Bjerknes-consistency boolean, $B$, is evaluated. It is `True` if both $v_E \\cdot \\tau^\\star > 0$ and $v_h \\cdot \\tau^\\star > 0$, and `False` otherwise. This condition verifies that the wind anomaly $\\tau^\\star$ acts to amplify both the eastern SST anomaly ($v_E$) and the eastern thermocline depth anomaly ($v_h$), which is the essence of the Bjerknes feedback loop in the real climate system. A positive $v_E \\cdot \\tau^\\star$ indicates wind-driven warming reinforces an existing warm SST anomaly in the east. A positive $v_h \\cdot \\tau^\\star$ indicates wind-driven thermocline deepening (a positive $h$ anomaly) is associated with the wind stress, which preconditions for further sea surface warming.\n\nThis entire procedure is implemented for each of the three provided test cases, and the results are aggregated into the specified final output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the leading eigenmode and derived metrics for a simplified ENSO model\n    for three given parameter sets.\n    \"\"\"\n\n    test_cases = [\n        # Case A (moderate positive feedback, damped oscillation expected)\n        {\n            'name': 'A',\n            'params': {\n                'mu_W': 0.5, 'mu_C': 0.45, 'mu_E': 0.4, 'nu': 0.35,\n                'lambda_W': 0.2, 'lambda_C': 0.3, 'lambda_E': 0.5,\n                'rho_W': 0.1, 'rho_C': 0.2, 'rho_E': 0.3,\n                'c_C': 0.8, 'c_E': 1.0, 'kappa': 0.6\n            }\n        },\n        # Case B (near-critical feedback, weakly unstable or nearly neutral oscillation possible)\n        {\n            'name': 'B',\n            'params': {\n                'mu_W': 0.45, 'mu_C': 0.4, 'mu_E': 0.35, 'nu': 0.3,\n                'lambda_W': 0.25, 'lambda_C': 0.35, 'lambda_E': 0.6,\n                'rho_W': 0.15, 'rho_C': 0.25, 'rho_E': 0.4,\n                'c_C': 0.9, 'c_E': 1.2, 'kappa': 1.0\n            }\n        },\n        # Case C (no Bjerknes feedback, purely damped dynamics)\n        {\n            'name': 'C',\n            'params': {\n                'mu_W': 0.5, 'mu_C': 0.5, 'mu_E': 0.5, 'nu': 0.4,\n                'lambda_W': 0.2, 'lambda_C': 0.2, 'lambda_E': 0.2,\n                'rho_W': 0.1, 'rho_C': 0.1, 'rho_E': 0.1,\n                'c_C': 0.0, 'c_E': 0.0, 'kappa': 0.5\n            }\n        }\n    ]\n\n    results = []\n    epsilon = 1e-12\n\n    for case in test_cases:\n        p = case['params']\n\n        # Construct the 4x4 matrix A\n        A = np.array([\n            [-p['mu_W'], p['rho_W'] * p['c_C'], p['rho_W'] * p['c_E'], p['lambda_W']],\n            [0, -p['mu_C'] + p['rho_C'] * p['c_C'], p['rho_C'] * p['c_E'], p['lambda_C']],\n            [0, p['rho_E'] * p['c_C'], -p['mu_E'] + p['rho_E'] * p['c_E'], p['lambda_E']],\n            [0, p['kappa'] * p['c_C'], p['kappa'] * p['c_E'], -p['nu']]\n        ])\n\n        # Compute eigenvalues and eigenvectors\n        eigenvalues, eigenvectors = np.linalg.eig(A)\n\n        # Find the index of the leading eigenvalue (largest real part)\n        idx_leading = np.argmax(eigenvalues.real)\n        \n        # Extract the leading eigenvalue and eigenvector\n        lambda_max = eigenvalues[idx_leading]\n        v_leading = eigenvectors[:, idx_leading]\n\n        # Normalize the leading eigenvector as specified\n        norm_v = np.linalg.norm(v_leading)\n        \n        # Check for zero norm, though unlikely for a non-zero eigenvector\n        if norm_v  epsilon:\n            v_hat = np.zeros(4)\n        else:\n            v_hat = v_leading.real / norm_v\n\n        v_W, v_C, v_E, v_h = v_hat[0], v_hat[1], v_hat[2], v_hat[3]\n\n        # Compute feedback interpretation metrics\n        tau_star = p['c_C'] * v_C + p['c_E'] * v_E\n        \n        R = abs(v_E) / (abs(v_W) + abs(v_C) + epsilon)\n        \n        B = bool((v_E * tau_star > 0) and (v_h * tau_star > 0))\n\n        # Collect results for this case\n        case_result = [\n            lambda_max.real,\n            lambda_max.imag,\n            v_W,\n            v_C,\n            v_E,\n            v_h,\n            R,\n            B\n        ]\n        results.append(case_result)\n\n    # Format the final output string as specified\n    # The str() of a list automatically includes brackets and commas.\n    # We join these string representations of lists with commas.\n    # Finally, we enclose the whole thing in brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The Bjerknes feedback at the heart of ENSO requires the atmosphere to respond to ocean temperature anomalies. This practice provides hands-on experience in modeling that response by implementing the classic Gill model, which describes how tropical winds are generated by a prescribed heating pattern. By discretizing the shallow-water equations and solving the resulting linear system, you will build a core component of a coupled model from first principles and compute the resulting wind stress anomalies that drive the ocean. ",
            "id": "3877771",
            "problem": "Consider the canonical linear steady Gill-type atmospheric model on an equatorial $\\beta$-plane used for El Niño-Southern Oscillation (ENSO) modeling. Let $(x,y)$ denote Cartesian coordinates measured in meters with $y=0$ at the equator, and let $(u(x,y), v(x,y))$ be the horizontal wind anomalies (meters per second), and $\\phi(x,y)$ be the geopotential anomaly (square meters per square second). The steady linearized shallow-water equations with Rayleigh friction and Newtonian cooling, forced by diabatic heating $Q(x,y)$ (square meters per cubic second), are\n$$\n\\partial_x \\phi + r\\,u - \\beta\\,y\\,v = 0,\n$$\n$$\n\\partial_y \\phi + r\\,v + \\beta\\,y\\,u = 0,\n$$\n$$\nc^2\\left(\\partial_x u + \\partial_y v\\right) + \\alpha\\,\\phi = Q(x,y),\n$$\nwhere $c$ is the gravity wave speed (square root of $gH$), $\\beta$ is the meridional gradient of the Coriolis parameter at the equator, $r$ is a linear Rayleigh friction rate, and $\\alpha$ is a linear Newtonian cooling rate.\n\nAssume a rectangular doubly-periodic domain with $x \\in [-L_x/2, L_x/2)$ and $y \\in [-L_y/2, L_y/2)$, where $L_x = 1.2 \\times 10^7$ and $L_y = 8.0 \\times 10^6$, discretized by a uniform grid with $N_x = 97$ and $N_y = 65$ points. Use second-order central finite differences for $\\partial_x$ and $\\partial_y$ with periodic wrap-around in both directions. Use the parameter values $c = 44$, $\\beta = 2.3 \\times 10^{-11}$, $r = 2.0 \\times 10^{-6}$, and $\\alpha = 2.0 \\times 10^{-6}$, with all rates in per second and speeds in meters per second. The air density is $\\rho_{\\text{air}} = 1.2$ kilograms per cubic meter and the neutral drag coefficient is $C_d = 1.3 \\times 10^{-3}$.\n\nLink the diabatic heating $Q(x,y)$ to the prescribed Sea Surface Temperature (SST) anomaly $T'(x,y)$ (Kelvin) through a linear relation\n$$\nQ(x,y) = \\gamma\\,T'(x,y),\n$$\nwhere $\\gamma = 1.0 \\times 10^{-5}$ is in square meters per cubic second per Kelvin. Prescribe $T'(x,y)$ as a two-dimensional Gaussian anomaly\n$$\nT'(x,y) = A\\,\\exp\\left(-\\frac{(x-x_0)^2}{2 L_x'^2} - \\frac{(y-y_0)^2}{2 L_y'^2}\\right),\n$$\nwith amplitude $A$ (Kelvin), zonal half-width $L_x'$ (meters), meridional half-width $L_y'$ (meters), and center $(x_0,y_0)$ (meters).\n\nCompute the steady solution $(u(x,y), v(x,y), \\phi(x,y))$ for each prescribed $Q(x,y)$ by solving the resulting linear system. Then form the linearized wind stress anomalies $\\boldsymbol{\\tau}'(x,y)$ (Newtons per square meter) that are first-order consistent with the bulk aerodynamic momentum flux about a specified background wind $\\mathbf{U}_b = (U_b, V_b)$:\n$$\n\\boldsymbol{\\tau}(\\mathbf{U}) = \\rho_{\\text{air}}\\,C_d\\,\\|\\mathbf{U}\\|\\,\\mathbf{U}, \\quad \\mathbf{U} = \\mathbf{U}_b + \\mathbf{u}',\n$$\nlinearized to\n$$\n\\boldsymbol{\\tau}' = \\rho_{\\text{air}}\\,C_d\\left(\\|\\mathbf{U}_b\\|\\,\\mathbf{u}' + \\frac{\\mathbf{U}_b \\cdot \\mathbf{u}'}{\\|\\mathbf{U}_b\\|}\\,\\mathbf{U}_b\\right),\n$$\nwhere $\\mathbf{u}' = (u,v)$. Use $U_b = -6$ and $V_b = 0$ in meters per second. From $\\boldsymbol{\\tau}'$, compute the area-mean zonal wind stress anomaly over the equatorial band defined by $\\{|y| \\le 5.0 \\times 10^5\\}$:\n$$\n\\overline{\\tau_x'} = \\frac{1}{\\mathcal{A}}\\iint_{\\{|y| \\le 5.0 \\times 10^5\\}} \\tau_x'(x,y)\\,dx\\,dy,\n$$\napproximated by the simple arithmetic mean over the selected grid cells.\n\nUse the following test suite, ensuring each parameter is interpreted in SI units:\n- Case $1$ (canonical equatorial warming): $A = 2$, $L_x' = 1.5 \\times 10^6$, $L_y' = 5.0 \\times 10^5$, $x_0 = 0$, $y_0 = 0$.\n- Case $2$ (no forcing boundary case): $A = 0$, $L_x' = 1.0 \\times 10^6$, $L_y' = 5.0 \\times 10^5$, $x_0 = 0$, $y_0 = 0$.\n- Case $3$ (off-equatorial warming): $A = 2$, $L_x' = 1.0 \\times 10^6$, $L_y' = 6.0 \\times 10^5$, $x_0 = 1.0 \\times 10^6$, $y_0 = 1.0 \\times 10^6$.\n\nYour program must:\n- Construct and factor the linear system once for the given domain and parameters, then solve for each right-hand side $Q(x,y)$.\n- Compute $\\overline{\\tau_x'}$ for each case in Newtons per square meter, expressed as floating-point numbers.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3]$), where $r_i$ is the area-mean zonal wind stress anomaly $\\overline{\\tau_x'}$ for Case $i$.\n\nAll physical quantities must be handled and reported in SI units, and any angle quantities, if they appear, must be in radians. The final outputs must be floating-point numbers in Newtons per square meter ($\\text{N/m}^2$).",
            "solution": "The problem is valid. It is a well-posed, scientifically-grounded problem in computational geophysical fluid dynamics. It requires the numerical solution of the steady, linearized shallow-water equations on an equatorial $\\beta$-plane, a classic model used to study the atmospheric response to sea surface temperature anomalies, such as those associated with the El Niño-Southern Oscillation (ENSO).\n\nThe solution proceeds in several steps:\n1.  Discretization of the continuous governing partial differential equations (PDEs) into a system of linear algebraic equations using a finite difference method.\n2.  Construction of the corresponding sparse linear system matrix $\\mathbf{M}$ and right-hand side (RHS) vector $\\mathbf{b}$.\n3.  Efficient solution of the linear system $\\mathbf{M}\\mathbf{z}=\\mathbf{b}$ for the state vector $\\mathbf{z}$ which contains the discretized fields of wind and geopotential anomalies.\n4.  Post-processing of the solution to compute the required diagnostic quantity, the area-averaged zonal wind stress anomaly $\\overline{\\tau_x'}$.\n\n**1. Discretization of the Domain and Variables**\n\nThe model is defined on a doubly-periodic rectangular domain, $x \\in [-L_x/2, L_x/2)$ and $y \\in [-L_y/2, L_y/2)$, with $L_x = 1.2 \\times 10^7$ m and $L_y = 8.0 \\times 10^6$ m. This domain is discretized using a uniform grid of $N_x = 97 \\times N_y = 65$ points. The grid spacings are $\\Delta x = L_x / N_x$ and $\\Delta y = L_y / N_y$. The grid point coordinates $(x_i, y_j)$ are defined as:\n$$\nx_i = - \\frac{L_x}{2} + i \\cdot \\Delta x, \\quad \\text{for } i = 0, 1, \\dots, N_x-1\n$$\n$$\ny_j = - \\frac{L_y}{2} + j \\cdot \\Delta y, \\quad \\text{for } j = 0, 1, \\dots, N_y-1\n$$\nThe three unknown fields, zonal wind anomaly $u(x,y)$, meridional wind anomaly $v(x,y)$, and geopotential anomaly $\\phi(x,y)$, are discretized at these grid points, denoted as $u_{ij}$, $v_{ij}$, and $\\phi_{ij}$. The total number of unknowns is $N = 3 N_x N_y$. These unknowns are organized into a single state vector $\\mathbf{z}$ of length $N$. We adopt a mapping where variables are grouped by grid point. A grid point $(i,j)$ is mapped to a linear index $p = j N_x + i$. The components of the state vector corresponding to this point are then at indices $3p$ (for $u_{ij}$), $3p+1$ (for $v_{ij}$), and $3p+2$ (for $\\phi_{ij}$).\n\n**2. Finite Difference Approximation**\n\nThe partial derivatives are approximated using second-order central differences. For a generic field $f(x,y)$, the derivatives at grid point $(i,j)$ are:\n$$\n(\\partial_x f)_{ij} \\approx \\frac{f_{i+1, j} - f_{i-1, j}}{2 \\Delta x}\n$$\n$$\n(\\partial_y f)_{ij} \\approx \\frac{f_{i, j+1} - f_{i, j-1}}{2 \\Delta y}\n$$\nThe periodic boundary conditions are handled by taking indices modulo $N_x$ and $N_y$. For instance, the index $i+1$ becomes $(i+1) \\pmod{N_x}$ and $i-1$ becomes $(i-1+N_x) \\pmod{N_x}$.\n\nApplying this discretization to the three governing equations at each grid point $(i,j)$ yields a system of $N$ linear algebraic equations:\n$$\n\\frac{\\phi_{i+1,j} - \\phi_{i-1,j}}{2 \\Delta x} + r u_{ij} - \\beta y_j v_{ij} = 0\n$$\n$$\n\\frac{\\phi_{i,j+1} - \\phi_{i,j-1}}{2 \\Delta y} + r v_{ij} + \\beta y_j u_{ij} = 0\n$$\n$$\nc^2 \\left( \\frac{u_{i+1,j} - u_{i-1,j}}{2 \\Delta x} + \\frac{v_{i,j+1} - v_{i,j-1}}{2 \\Delta y} \\right) + \\alpha \\phi_{ij} = Q_{ij}\n$$\nwhere $Q_{ij} = Q(x_i, y_j)$ is the prescribed diabatic heating at the grid point.\n\n**3. Construction of the Linear System**\n\nThe system of equations can be written in matrix form as $\\mathbf{M}\\mathbf{z} = \\mathbf{b}$. The matrix $\\mathbf{M}$ is a large, sparse matrix of size $N \\times N$. Its elements are determined by the coefficients in the discretized equations. For each grid point $(i,j)$, with linear index $p=jN_x+i$, we can identify the non-zero entries of $\\mathbf{M}$ that correspond to the three equations at that point. Specifically, for rows $3p$, $3p+1$, and $3p+2$:\n- The first equation (zonal momentum) links $u_{ij}$ and $v_{ij}$ (at index $p$) to $\\phi_{i\\pm 1, j}$ (at neighboring indices).\n- The second equation (meridional momentum) links $u_{ij}$ and $v_{ij}$ (at index $p$) to $\\phi_{i, j\\pm 1}$.\n- The third equation (thermodynamics) links $\\phi_{ij}$ (at index $p$) to $u_{i\\pm 1, j}$ and $v_{i, j\\pm 1}$.\n\nThe matrix $\\mathbf{M}$ is constructed by iterating through all grid points $(i,j)$ and populating the corresponding entries based on these connections. Since the coefficients $r, \\alpha, \\beta, c$ and the grid are fixed, matrix $\\mathbf{M}$ is the same for all test cases.\n\nThe RHS vector $\\mathbf{b}$ has length $N$. The first two equations for each grid point have a RHS of $0$. Only the third equation has a non-zero forcing term. Thus, for each grid point $p=jN_x+i$, the entries in $\\mathbf{b}$ are $(0, 0, Q_{ij})$.\n\n**4. Solution Methodology**\n\nTo solve the system efficiently for multiple forcing scenarios, we first compute the LU factorization of the matrix $\\mathbf{M}$. This is a computationally intensive step but only needs to be performed once. We use the `scipy.sparse.linalg.splu` function for this purpose, which is optimized for sparse matrices.\n\nFor each of the three test cases specified:\n1.  The SST anomaly field $T'(x,y)$ is computed on the grid using its given Gaussian form.\n2.  The diabatic heating field $Q(x,y) = \\gamma T'(x,y)$ is calculated.\n3.  The RHS vector $\\mathbf{b}$ is constructed from the $Q_{ij}$ values.\n4.  The linear system $\\mathbf{M}\\mathbf{z}=\\mathbf{b}$ is solved for $\\mathbf{z}$ using the pre-computed LU factorization. This is a fast substitution step.\n5.  The resulting state vector $\\mathbf{z}$ is reshaped into the 2D fields $u_{ij}$, $v_{ij}$, and $\\phi_{ij}$.\n\n**5. Calculation of the Diagnostic Quantity**\n\nWith the solution fields obtained, the final diagnostic quantity is computed.\n1.  The linearized zonal wind stress anomaly $\\tau_x'(x,y)$ is calculated. The background wind is $\\mathbf{U}_b = (U_b, V_b) = (-6, 0)$ m/s. The linearized formula is:\n    $$\n    \\boldsymbol{\\tau}' = \\rho_{\\text{air}}\\,C_d\\left(\\|\\mathbf{U}_b\\|\\,\\mathbf{u}' + \\frac{\\mathbf{U}_b \\cdot \\mathbf{u}'}{\\|\\mathbf{U}_b\\|}\\,\\mathbf{U}_b\\right)\n    $$\n    With $\\mathbf{u}'=(u,v)$, this simplifies to:\n    $$\n    \\tau_x' = \\rho_{\\text{air}}\\,C_d\\left( |U_b| u + \\frac{U_b u}{|U_b|} U_b \\right) = \\rho_{\\text{air}}\\,C_d (6u + \\frac{-6u}{6}(-6)) = 12 \\rho_{\\text{air}} C_d u\n    $$\n    The field $\\tau_x'_{ij}$ is computed for all grid points using the solution $u_{ij}$.\n\n2.  The area-mean zonal wind stress anomaly, $\\overline{\\tau_x'}$, is computed over the equatorial band defined by $\\{|y| \\le 5.0 \\times 10^5 \\text{ m}\\}$. As per the problem statement, this is approximated by the simple arithmetic mean of $\\tau_x'_{ij}$ over all grid cells $(i,j)$ whose $y$-coordinate $y_j$ falls within this band. The set of meridional indices $j$ satisfying $|y_j| \\le 5.0 \\times 10^5 \\text{ m}$ is identified, and the mean is taken over all $i$ and these selected $j$.\n\nThis procedure is repeated for each of the three test cases, yielding three values for $\\overline{\\tau_x'}$ which constitute the final result. For Case 2, where the forcing amplitude $A=0$, the heating $Q=0$, leading to a zero solution for $(u,v,\\phi)$ and thus $\\overline{\\tau_x'}=0$, which serves as a analytical verification of the numerical framework.",
            "answer": "```python\nimport numpy as np\nimport scipy.sparse\nimport scipy.sparse.linalg\n\ndef solve():\n    \"\"\"\n    Solves the steady linearized shallow-water equations for the Gill-type model.\n    \"\"\"\n    #\n    # === 1. Define Constants and Grid ===\n    #\n    \n    # Domain and Grid\n    Lx = 1.2e7  # m\n    Ly = 8.0e6  # m\n    Nx = 97\n    Ny = 65\n\n    # Physical Parameters (all in SI units)\n    c = 44.0          # m/s\n    beta = 2.3e-11    # 1/(m*s)\n    r = 2.0e-6        # 1/s\n    alpha = 2.0e-6    # 1/s\n    rho_air = 1.2     # kg/m^3\n    Cd = 1.3e-3       # dimensionless\n    gamma = 1.0e-5    # m^2/(s^3*K)\n    Ub = -6.0         # m/s\n    Vb = 0.0          # m/s\n\n    # Grid setup\n    dx = Lx / Nx\n    dy = Ly / Ny\n    x = -Lx/2 + np.arange(Nx) * dx\n    y = -Ly/2 + np.arange(Ny) * dy\n    X, Y = np.meshgrid(x, y)\n\n    total_vars = 3 * Nx * Ny\n    \n    #\n    # === 2. Construct the Linear System Matrix M ===\n    #\n    \n    # Use LIL format for efficient construction\n    M = scipy.sparse.lil_matrix((total_vars, total_vars), dtype=float)\n\n    # Coefficients for finite difference operators\n    inv_2dx = 1.0 / (2.0 * dx)\n    inv_2dy = 1.0 / (2.0 * dy)\n    c2_inv_2dx = c**2 * inv_2dx\n    c2_inv_2dy = c**2 * inv_2dy\n    \n    for j in range(Ny):\n        for i in range(Nx):\n            p = j * Nx + i # Linear index for grid point (i,j)\n            \n            # Neighbor indices with periodic wrap-around\n            ip1 = (i + 1) % Nx\n            im1 = (i - 1 + Nx) % Nx\n            jp1 = (j + 1) % Ny\n            jm1 = (j - 1 + Ny) % Ny\n\n            p_ip1 = j * Nx + ip1\n            p_im1 = j * Nx + im1\n            p_jp1 = jp1 * Nx + i\n            p_jm1 = jm1 * Nx + i\n\n            # Equation 1: Zonal momentum (row = 3*p)\n            M[3*p, 3*p] = r               # r*u\n            M[3*p, 3*p+1] = -beta * y[j]    # -beta*y*v\n            M[3*p, 3*p_ip1+2] = inv_2dx   # d/dx phi\n            M[3*p, 3*p_im1+2] = -inv_2dx  # d/dx phi\n            \n            # Equation 2: Meridional momentum (row = 3*p + 1)\n            M[3*p+1, 3*p] = beta * y[j]     # beta*y*u\n            M[3*p+1, 3*p+1] = r             # r*v\n            M[3*p+1, 3*p_jp1+2] = inv_2dy   # d/dy phi\n            M[3*p+1, 3*p_jm1+2] = -inv_2dy  # d/dy phi\n\n            # Equation 3: Thermodynamics (row = 3*p + 2)\n            M[3*p+2, 3*p_ip1] = c2_inv_2dx   # c^2*d/dx u\n            M[3*p+2, 3*p_im1] = -c2_inv_2dx  # c^2*d/dx u\n            M[3*p+2, 3*p_jp1+1] = c2_inv_2dy  # c^2*d/dy v\n            M[3*p+2, 3*p_jm1+1] = -c2_inv_2dy # c^2*d/dy v\n            M[3*p+2, 3*p+2] = alpha         # alpha*phi\n\n    # Convert to CSC format for efficient factorization and solving\n    M_csc = M.tocsc()\n    \n    #\n    # === 3. LU Factorize the Matrix ===\n    #\n    \n    lu_factor = scipy.sparse.linalg.splu(M_csc)\n    \n    #\n    # === 4. Define Test Cases and Solve ===\n    #\n    \n    test_cases = [\n        {'A': 2.0, 'Lx_prime': 1.5e6, 'Ly_prime': 5.0e5, 'x0': 0.0, 'y0': 0.0},\n        {'A': 0.0, 'Lx_prime': 1.0e6, 'Ly_prime': 5.0e5, 'x0': 0.0, 'y0': 0.0},\n        {'A': 2.0, 'Lx_prime': 1.0e6, 'Ly_prime': 6.0e5, 'x0': 1.0e6, 'y0': 1.0e6},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        A = case['A']\n        Lx_prime = case['Lx_prime']\n        Ly_prime = case['Ly_prime']\n        x0 = case['x0']\n        y0 = case['y0']\n\n        # Construct RHS vector b\n        if A == 0.0:\n            Q = np.zeros((Ny, Nx))\n        else:\n            T_prime = A * np.exp(-((X - x0)**2 / (2 * Lx_prime**2)) - ((Y - y0)**2 / (2 * Ly_prime**2)))\n            Q = gamma * T_prime\n\n        b = np.zeros(total_vars)\n        b[2::3] = Q.flatten()\n\n        # Solve the system\n        z = lu_factor.solve(b)\n        \n        # Reshape solution vector to 2D fields\n        u = z[0::3].reshape((Ny, Nx))\n        # v = z[1::3].reshape((Ny, Nx)) # v is not needed for tau_x'\n        \n        #\n        # === 5. Compute Diagnostic: Mean Zonal Wind Stress Anomaly ===\n        #\n        \n        # Formula: tau_x' = 12 * rho_air * Cd * u\n        tau_x_prime = 12.0 * rho_air * Cd * u\n        \n        # Define equatorial band and find corresponding grid indices\n        y_band_limit = 5.0e5\n        band_indices = np.where(np.abs(y) = y_band_limit)[0]\n        \n        # Calculate the arithmetic mean over the selected grid cells\n        if len(band_indices) > 0:\n            tau_x_mean = np.mean(tau_x_prime[band_indices, :])\n        else:\n            tau_x_mean = 0.0 # Should not happen with this grid\n        \n        results.append(tau_x_mean)\n\n    #\n    # === 6. Format and Print Output ===\n    #\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}