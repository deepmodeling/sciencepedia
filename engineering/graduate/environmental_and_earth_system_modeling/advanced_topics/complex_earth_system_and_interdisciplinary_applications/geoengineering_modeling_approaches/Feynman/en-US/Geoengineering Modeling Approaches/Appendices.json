{
    "hands_on_practices": [
        {
            "introduction": "The first step in evaluating any Carbon Dioxide Removal (CDR) strategy is to understand its effect on the global carbon cycle. This exercise provides practice in building and solving a simplified \"box model\" of atmospheric $\\mathrm{CO_2}$ concentration. By translating a physical scenario—involving sustained carbon removal, leakage, and natural sink saturation—into a solvable differential equation, you will develop fundamental skills in analytical climate modeling and directly quantify the radiative impact of a geoengineering intervention .",
            "id": "3882593",
            "problem": "A single-box atmospheric carbon dioxide model is used to evaluate a sustained carbon dioxide removal intervention with leakage and time-varying terrestrial uptake saturation. Let $C(t)$ denote the globally averaged atmospheric $\\text{CO}_2$ concentration in parts per million (ppm), and let $C_0$ denote a fixed preindustrial reference concentration. Starting from conservation of carbon mass for the atmospheric box, assume:\n- There are no anthropogenic emissions after $t=0$.\n- A sustained carbon dioxide removal program extracts $\\text{CO}_2$ from the atmosphere at rate $R(t)=R_0$ (in ppm per year), but a constant fraction $\\ell$ leaks back rapidly, so the effective permanent removal is $(1-\\ell) R_0$.\n- Natural terrestrial uptake relaxes $C(t)$ toward $C_0$ according to a linearized flux $-k(t)\\,[C(t)-C_0]$ that declines over time due to saturation, with $k(t)=\\dfrac{k_0}{1+t/\\tau_s}$.\n\nThus the atmospheric mass balance for $t \\ge 0$ is\n$$\n\\frac{dC}{dt} \\;=\\; -\\,(1-\\ell)\\,R_0 \\;-\\; k(t)\\,\\bigl[C(t)-C_0\\bigr],\n$$\nwith initial condition $C(0)=C_i$. The instantaneous top-of-atmosphere radiative forcing associated with the concentration pathway is taken as the well-tested logarithmic relation\n$$\nF(t) \\;=\\; \\alpha \\,\\ln\\!\\left(\\frac{C(t)}{C_0}\\right).\n$$\n\nUsing only these assumptions, derive $C(t)$ analytically and compute $F(T)$ at $T=100$ years for the parameter set\n- $C_0=280\\ \\text{ppm}$,\n- $C_i=415\\ \\text{ppm}$,\n- $R_0=1.5\\ \\text{ppm}\\ \\text{yr}^{-1}$,\n- $\\ell = 0.20$,\n- $k_0=0.020\\ \\text{yr}^{-1}$,\n- $\\tau_s=50\\ \\text{yr}$,\n- $\\alpha=5.35\\ \\text{W}\\ \\text{m}^{-2}$.\n\nRound your final numerical answer for $F(T)$ to four significant figures. Express the final value in $\\text{W}\\ \\text{m}^{-2}$.",
            "solution": "The problem is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- Governing differential equation for atmospheric $\\text{CO}_2$ concentration $C(t)$: $\\frac{dC}{dt} = -(1-\\ell)R_0 - k(t)[C(t)-C_0]$\n- Time-dependent natural uptake rate: $k(t) = \\frac{k_0}{1+t/\\tau_s}$\n- Initial condition: $C(0) = C_i$\n- Radiative forcing formula: $F(t) = \\alpha \\ln(\\frac{C(t)}{C_0})$\n- Target time for evaluation: $T = 100$ years\n- Parameter values:\n  - $C_0=280\\ \\text{ppm}$\n  - $C_i=415\\ \\text{ppm}$\n  - $R_0=1.5\\ \\text{ppm}\\ \\text{yr}^{-1}$\n  - $\\ell = 0.20$\n  - $k_0=0.020\\ \\text{yr}^{-1}$\n  - $\\tau_s=50\\ \\text{yr}$\n  - $\\alpha=5.35\\ \\text{W}\\ \\text{m}^{-2}$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem uses a single-box model, a standard simplification in climate science for illustrating fundamental dynamics. The mass balance equation correctly accounts for sources and sinks. The sink term, representing relaxation to a preindustrial state, is a valid linearization. Its time-dependent coefficient $k(t)$ is a plausible, albeit simple, way to model the saturation of terrestrial carbon sinks. The logarithmic formula for radiative forcing is a well-established empirical relationship used extensively in climate modeling (e.g., by the IPCC). All parameter values are physically realistic.\n- **Well-Posed**: The problem is an initial value problem for a first-order linear ordinary differential equation. The coefficient functions are continuous for $t \\ge 0$. Standard existence and uniqueness theorems guarantee that a unique solution $C(t)$ exists.\n- **Objective**: The problem is stated in precise mathematical and physical terms, free of ambiguity or subjective claims.\n- **Completeness**: All necessary constants, functional forms, and the initial condition are provided to solve for $C(t)$ and subsequently $F(T)$.\n- **Consistency**: There are no internal contradictions in the provided data or equations. The units are consistent.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, and self-contained. It is deemed **valid**. A full solution will be derived.\n\nThe governing equation is a first-order linear ordinary differential equation:\n$$ \\frac{dC}{dt} = -(1-\\ell)R_0 - k(t)[C(t)-C_0] $$\nWe can rearrange this into the standard form $\\frac{dy}{dt} + P(t)y = Q(t)$. Let us define a new variable $y(t) = C(t) - C_0$. Then $\\frac{dy}{dt} = \\frac{dC}{dt}$. Substituting this into the equation gives:\n$$ \\frac{dy}{dt} = -(1-\\ell)R_0 - k(t)y(t) $$\n$$ \\frac{dy}{dt} + k(t)y(t) = -(1-\\ell)R_0 $$\nThis is a linear ODE for $y(t)$ with the initial condition $y(0) = C(0) - C_0 = C_i - C_0$. The equation is solved using an integrating factor, $I(t)$, defined as:\n$$ I(t) = \\exp\\left(\\int k(t) dt\\right) $$\nFirst, we compute the integral of $k(t) = \\frac{k_0}{1+t/\\tau_s}$:\n$$ \\int k(t) dt = \\int \\frac{k_0}{1+t/\\tau_s} dt $$\nUsing the substitution $u = 1 + t/\\tau_s$, we have $du = \\frac{1}{\\tau_s}dt$, so $dt = \\tau_s du$.\n$$ \\int \\frac{k_0}{u} \\tau_s du = k_0 \\tau_s \\int \\frac{1}{u} du = k_0 \\tau_s \\ln(u) = k_0 \\tau_s \\ln\\left(1+\\frac{t}{\\tau_s}\\right) $$\nThe integrating factor is therefore:\n$$ I(t) = \\exp\\left(k_0 \\tau_s \\ln\\left(1+\\frac{t}{\\tau_s}\\right)\\right) = \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} $$\nThe solution for $y(t)$ is given by:\n$$ y(t) = \\frac{1}{I(t)}\\left[\\int I(t) Q(t) dt + \\mathcal{K}\\right] $$\nwhere $Q(t) = -(1-\\ell)R_0$ is a constant and $\\mathcal{K}$ is the constant of integration.\n$$ y(t) I(t) = \\int -(1-\\ell)R_0 \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} dt + \\mathcal{K} $$\nWe evaluate the integral:\n$$ \\int \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} dt = \\tau_s \\int u^{k_0 \\tau_s} du = \\frac{\\tau_s}{k_0 \\tau_s+1} u^{k_0 \\tau_s+1} = \\frac{\\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s+1} $$\nSubstituting this back, we get:\n$$ y(t)\\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s} = - (1-\\ell)R_0 \\frac{\\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right)^{k_0 \\tau_s+1} + \\mathcal{K} $$\nSolving for $y(t)$:\n$$ y(t) = - \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right) + \\mathcal{K} \\left(1+\\frac{t}{\\tau_s}\\right)^{-k_0 \\tau_s} $$\nWe find $\\mathcal{K}$ using the initial condition $y(0) = C_i - C_0$. At $t=0$:\n$$ C_i - C_0 = - \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} (1) + \\mathcal{K} (1) $$\n$$ \\mathcal{K} = (C_i - C_0) + \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} $$\nSubstituting $\\mathcal{K}$ back into the solution for $y(t)$ and then finding $C(t) = y(t) + C_0$:\n$$ C(t) = C_0 - \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} \\left(1+\\frac{t}{\\tau_s}\\right) + \\left[ (C_i - C_0) + \\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} \\right] \\left(1+\\frac{t}{\\tau_s}\\right)^{-k_0 \\tau_s} $$\nNow we substitute the numerical values to find $C(T)$ for $T=100\\ \\text{yr}$.\nFirst, calculate the composite parameters:\n- The exponent term: $k_0 \\tau_s = (0.020\\ \\text{yr}^{-1})(50\\ \\text{yr}) = 1$.\n- The effective removal rate term: $(1-\\ell)R_0 = (1-0.20)(1.5\\ \\text{ppm yr}^{-1}) = (0.80)(1.5\\ \\text{ppm yr}^{-1}) = 1.2\\ \\text{ppm yr}^{-1}$.\n- The coefficient term: $\\frac{(1-\\ell)R_0 \\tau_s}{k_0 \\tau_s+1} = \\frac{(1.2\\ \\text{ppm yr}^{-1})(50\\ \\text{yr})}{1+1} = \\frac{60\\ \\text{ppm}}{2} = 30\\ \\text{ppm}$.\n- The initial anomaly: $C_i - C_0 = 415\\ \\text{ppm} - 280\\ \\text{ppm} = 135\\ \\text{ppm}$.\n- The time term argument at $t=T=100$: $1+\\frac{T}{\\tau_s} = 1+\\frac{100\\ \\text{yr}}{50\\ \\text{yr}} = 1+2 = 3$.\n\nSubstitute these into the analytical solution for $C(t)$ at $t=T$:\n$$ C(100) = 280\\ \\text{ppm} - 30\\ \\text{ppm} \\times (3) + \\left[ 135\\ \\text{ppm} + 30\\ \\text{ppm} \\right] \\times (3)^{-1} $$\n$$ C(100) = 280 - 90 + (165) \\times \\frac{1}{3} $$\n$$ C(100) = 190 + 55 = 245\\ \\text{ppm} $$\nThe concentration at $T=100$ years is $C(100) = 245\\ \\text{ppm}$.\n\nFinally, we compute the radiative forcing $F(T)$ at $T=100$ years:\n$$ F(T) = \\alpha \\ln\\left(\\frac{C(T)}{C_0}\\right) $$\n$$ F(100) = 5.35\\ \\text{W}\\ \\text{m}^{-2} \\times \\ln\\left(\\frac{245}{280}\\right) $$\nThe fraction simplifies to $\\frac{245}{280} = \\frac{7 \\times 35}{8 \\times 35} = \\frac{7}{8} = 0.875$.\n$$ F(100) = 5.35 \\times \\ln(0.875) $$\n$$ F(100) \\approx 5.35 \\times (-0.13353139) \\approx -0.71441794\\ \\text{W}\\ \\text{m}^{-2} $$\nRounding to four significant figures, we get:\n$$ F(100) \\approx -0.7144\\ \\text{W}\\ \\text{m}^{-2} $$",
            "answer": "$$\n\\boxed{-0.7144}\n$$"
        },
        {
            "introduction": "While simple models are useful, much of modern climate science involves analyzing the output of complex Earth System Models. This practice introduces a cornerstone diagnostic technique known as Gregory regression, which is used to estimate a forcing's true impact (Effective Radiative Forcing, $F$) and the climate's overall sensitivity ($\\lambda$). By implementing this method from first principles, you will gain hands-on experience in a critical data analysis workflow that bridges theoretical energy balance concepts with practical model evaluation .",
            "id": "3882625",
            "problem": "You are modeling the radiative impact of a geoengineering perturbation using the Gregory regression framework. The global conservation of energy at the top-of-atmosphere dictates that the net top-of-atmosphere flux anomaly satisfies the relationship\n$$\nN = F - \\lambda\\,T + \\varepsilon,\n$$\nwhere $N$ is the net top-of-atmosphere flux anomaly in $\\text{W m}^{-2}$, $F$ is the Effective Radiative Forcing (ERF) in $\\text{W m}^{-2}$, $\\lambda$ is the net climate feedback parameter in $\\text{W m}^{-2} \\text{ K}^{-1}$, $T$ is the global-mean surface air temperature anomaly in $\\mathrm{K}$, and $\\varepsilon$ represents internal variability and model residuals. A basic and widely used estimation method is the Gregory regression, which fits a straight line to $N$ as a function of $T$ using Ordinary Least Squares (OLS), and interprets the intercept as the ERF $F$ and the slope as $-\\lambda$.\n\nTask:\n1) Starting from the definitions of $N$, $F$, and $\\lambda$ and the global energy balance expressed above, derive the OLS estimators for the intercept and slope of the linear relationship between $N$ and $T$ by minimizing the sum of squared residuals. Show how to extract estimates $\\hat{F}$ and $\\hat{\\lambda}$ from the fitted intercept and slope, making clear the physical meaning of the sign convention.\n2) Implement a program that, given paired samples $\\{(T_i,N_i)\\}_{i=1}^{n}$ for several test cases, estimates $\\hat{F}$ (in $\\text{W m}^{-2}$) and $\\hat{\\lambda}$ (in $\\text{W m}^{-2} \\text{ K}^{-1}$) via OLS, and then computes the implied equilibrium temperature anomaly estimate $\\hat{T}_{\\mathrm{eq}} = \\hat{F}/\\hat{\\lambda}$ (in $\\mathrm{K}$) for a step forcing within the same one-box energy balance framework.\n3) All outputs must be expressed in the specified physical units, but your program must output only the numbers without unit symbols. Round each reported value to $3$ decimals.\n\nUse the following test suite of prescribed, paired datasets $(T_i,N_i)$ with $i=1,\\dots,n$ as lists. Each list entry is a real number. Units are $\\mathrm{K}$ for $T$ and $\\text{W m}^{-2}$ for $N$.\n\n- Test case $1$ (noise-free reference):\n  $$\n  T = [0.0,\\,0.5,\\,1.0,\\,1.5,\\,2.0],\\quad\n  N = [4.0,\\,3.5,\\,3.0,\\,2.5,\\,2.0].\n  $$\n- Test case $2$ (moderate variability):\n  $$\n  T = [0.1,\\,0.3,\\,0.7,\\,1.2,\\,1.8],\\quad\n  N = [3.63,\\,3.31,\\,2.88,\\,2.22,\\,1.54].\n  $$\n- Test case $3$ (near-zero forcing with small variability):\n  $$\n  T = [-0.1,\\,0.0,\\,0.1,\\,0.2,\\,0.3],\\quad\n  N = [0.35,\\,0.2,\\,0.07,\\,-0.11,\\,-0.25].\n  $$\n- Test case $4$ (low variance in $T$; numerically delicate):\n  $$\n  T = [1.00,\\,1.01,\\,0.99,\\,1.02,\\,0.98],\\quad\n  N = [1.702,\\,1.691,\\,1.708,\\,1.686,\\,1.715].\n  $$\n\nFor each test case, compute and report the triplet $[\\hat{F},\\hat{\\lambda},\\hat{T}_{\\mathrm{eq}}]$, each rounded to $3$ decimals. Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, ordered by test case and flattened in sequence, that is\n$$\n[\\hat{F}_1,\\hat{\\lambda}_1,\\hat{T}_{\\mathrm{eq},1},\\hat{F}_2,\\hat{\\lambda}_2,\\hat{T}_{\\mathrm{eq},2},\\hat{F}_3,\\hat{\\lambda}_3,\\hat{T}_{\\mathrm{eq},3},\\hat{F}_4,\\hat{\\lambda}_4,\\hat{T}_{\\mathrm{eq},4}].\n$$\n\nConstraints and expectations:\n- You must use Ordinary Least Squares (OLS) to fit a line to $N$ as a function of $T$ for each test case. Do not use any prepackaged regression outside of the permitted libraries; implement the OLS solution from first principles using sample means and sums.\n- Ensure numerical robustness by handling the potential case of extremely small variance in $T$; if the variance of $T$ is exactly zero, the regression is undefined. The provided test cases avoid exactly zero variance.\n- Angle units are not required. No percentages are involved.\n- Results must be floats. The final output format is exactly a single line with the flattened list as specified above.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of climate modeling, specifically the Gregory regression method for estimating radiative forcing and climate feedbacks from an energy balance model. The problem is well-posed, providing all necessary data and mathematical definitions for a unique solution via Ordinary Least Squares (OLS) regression. The language is objective and the requirements are unambiguous.\n\nThe problem requires the derivation and implementation of OLS estimators for a linear model describing the top-of-atmosphere energy balance.\n\n**1. Derivation of OLS Estimators and Physical Interpretation**\n\nThe governing physical relationship is given by the energy balance equation:\n$$\nN = F - \\lambda T + \\varepsilon\n$$\nwhere $N$ is the net top-of-atmosphere flux anomaly, $T$ is the global-mean surface air temperature anomaly, $F$ is the Effective Radiative Forcing (ERF), $\\lambda$ is the net climate feedback parameter, and $\\varepsilon$ represents unforced internal variability and model residuals.\n\nWe are tasked with fitting a linear model to a set of data points $\\{(T_i, N_i)\\}_{i=1}^{n}$ of the form:\n$$\nN_i = \\beta_0 + \\beta_1 T_i + e_i\n$$\nHere, $\\beta_0$ and $\\beta_1$ are the intercept and slope coefficients of the regression line, and $e_i$ are the residuals, which are the differences between the observed values $N_i$ and the values predicted by the model, $\\hat{N}_i = \\beta_0 + \\beta_1 T_i$.\n\nThe method of Ordinary Least Squares (OLS) determines the values of the coefficients, denoted $\\hat{\\beta}_0$ and $\\hat{\\beta}_1$, that minimize the sum of squared residuals (SSR). The SSR, as a function of $\\beta_0$ and $\\beta_1$, is:\n$$\nS(\\beta_0, \\beta_1) = \\sum_{i=1}^{n} e_i^2 = \\sum_{i=1}^{n} (N_i - (\\beta_0 + \\beta_1 T_i))^2\n$$\nTo find the minimum of $S$, we take the partial derivatives with respect to $\\beta_0$ and $\\beta_1$ and set them to zero.\n\nFirst, with respect to $\\beta_0$:\n$$\n\\frac{\\partial S}{\\partial \\beta_0} = \\sum_{i=1}^{n} 2 (N_i - \\beta_0 - \\beta_1 T_i)(-1) = 0\n$$\n$$\n\\sum_{i=1}^{n} (N_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 T_i) = 0\n$$\n$$\n\\sum_{i=1}^{n} N_i - n \\hat{\\beta}_0 - \\hat{\\beta}_1 \\sum_{i=1}^{n} T_i = 0\n$$\nDividing by the number of data points, $n$, we obtain a relationship involving the sample means, $\\bar{T} = \\frac{1}{n} \\sum T_i$ and $\\bar{N} = \\frac{1}{n} \\sum N_i$:\n$$\n\\bar{N} - \\hat{\\beta}_0 - \\hat{\\beta}_1 \\bar{T} = 0\n$$\nThis gives an expression for the intercept estimator $\\hat{\\beta}_0$:\n$$\n\\hat{\\beta}_0 = \\bar{N} - \\hat{\\beta}_1 \\bar{T}\n$$\nThis result shows that the regression line must pass through the point of means $(\\bar{T}, \\bar{N})$.\n\nNext, with respect to $\\beta_1$:\n$$\n\\frac{\\partial S}{\\partial \\beta_1} = \\sum_{i=1}^{n} 2 (N_i - \\beta_0 - \\beta_1 T_i)(-T_i) = 0\n$$\n$$\n\\sum_{i=1}^{n} T_i (N_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 T_i) = 0\n$$\nSubstitute the expression for $\\hat{\\beta}_0 = \\bar{N} - \\hat{\\beta}_1 \\bar{T}$ into this equation:\n$$\n\\sum_{i=1}^{n} T_i (N_i - (\\bar{N} - \\hat{\\beta}_1 \\bar{T}) - \\hat{\\beta}_1 T_i) = 0\n$$\n$$\n\\sum_{i=1}^{n} T_i ((N_i - \\bar{N}) - \\hat{\\beta}_1 (T_i - \\bar{T})) = 0\n$$\n$$\n\\sum_{i=1}^{n} T_i (N_i - \\bar{N}) - \\hat{\\beta}_1 \\sum_{i=1}^{n} T_i (T_i - \\bar{T}) = 0\n$$\nThe sums can be simplified by recognizing their relationship to sample covariance and variance. The term $\\sum_{i=1}^{n} (T_i - \\bar{T})(X_i - \\bar{X})$ for any variable $X$ can be written as $\\sum T_i(X_i - \\bar{X}) - \\bar{T}\\sum(X_i - \\bar{X})$. Since $\\sum(X_i - \\bar{X}) = 0$, this simplifies to $\\sum T_i(X_i - \\bar{X})$. Applying this to our equation gives:\n$$\n\\sum_{i=1}^{n} (T_i - \\bar{T})(N_i - \\bar{N}) - \\hat{\\beta}_1 \\sum_{i=1}^{n} (T_i - \\bar{T})^2 = 0\n$$\nSolving for the slope estimator $\\hat{\\beta}_1$:\n$$\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^{n} (T_i - \\bar{T})(N_i - \\bar{N})}{\\sum_{i=1}^{n} (T_i - \\bar{T})^2}\n$$\nThis is the well-known formula for the OLS slope estimator, which is the ratio of the sample covariance of $T$ and $N$ to the sample variance of $T$.\n\nNow, we relate these statistical estimators to the physical parameters of the climate model. By comparing the regression model $N = \\beta_0 + \\beta_1 T$ with the physical model $N = F - \\lambda T$, we can make the following identifications:\n- The intercept $\\beta_0$ corresponds to the Effective Radiative Forcing, $F$. Thus, the estimator for $F$ is $\\hat{F} = \\hat{\\beta}_0$. Physically, this is the net radiation imbalance ($N$) at the moment the forcing is applied, before any temperature change has occurred ($T=0$).\n- The slope $\\beta_1$ corresponds to $-\\lambda$. Thus, the estimator for $\\lambda$ is $\\hat{\\lambda} = -\\hat{\\beta}_1$. The parameter $\\lambda$ represents the net effect of all climate feedbacks. A stable climate system is characterized by negative feedbacks, meaning that as the temperature $T$ increases, the net radiation flux $N$ decreases (more energy is radiated to space), which counteracts the initial warming. Therefore, for a stable system, $\\lambda > 0$, which implies that the slope of $N$ versus $T$ must be negative, i.e., $\\beta_1  0$.\n\nFinally, the equilibrium temperature anomaly, $T_{\\mathrm{eq}}$, is the temperature change the system would reach if it were allowed to equilibrate to a constant forcing $F$. At equilibrium, the temperature is no longer changing, and the net energy flux anomaly at the top of the atmosphere must be zero ($N=0$). Setting $N=0$ in the idealized energy balance equation gives:\n$$\n0 = F - \\lambda T_{\\mathrm{eq}}\n$$\nSolving for $T_{\\mathrm{eq}}$ yields:\n$$\nT_{\\mathrm{eq}} = \\frac{F}{\\lambda}\n$$\nThe estimated equilibrium temperature anomaly, $\\hat{T}_{\\mathrm{eq}}$, is computed using the estimated parameters:\n$$\n\\hat{T}_{\\mathrm{eq}} = \\frac{\\hat{F}}{\\hat{\\lambda}}\n$$\nThis value is well-defined provided $\\hat{\\lambda} \\neq 0$.\n\n**2. Implementation Strategy**\n\nThe program will implement the derived formulas for $\\hat{\\beta}_1$, $\\hat{\\beta}_0$, $\\hat{F}$, $\\hat{\\lambda}$, and $\\hat{T}_{\\mathrm{eq}}$. For each test case dataset $(T_i, N_i)$:\n1.  Compute the sample means $\\bar{T}$ and $\\bar{N}$.\n2.  Compute the term $\\sum_{i=1}^{n} (T_i - \\bar{T})^2$, which is proportional to the variance of $T$. As a safeguard for numerical robustness, one should check that this term is not zero, as division by zero would render the slope undefined.\n3.  Compute the term $\\sum_{i=1}^{n} (T_i - \\bar{T})(N_i - \\bar{N})$, which is proportional to the covariance of $T$ and $N$.\n4.  Calculate the slope estimator $\\hat{\\beta}_1$ using the formula derived above.\n5.  Calculate the intercept estimator $\\hat{\\beta}_0 = \\bar{N} - \\hat{\\beta}_1 \\bar{T}$.\n6.  Determine the physical parameter estimates: $\\hat{F} = \\hat{\\beta}_0$ and $\\hat{\\lambda} = -\\hat{\\beta}_1$.\n7.  Calculate the estimated equilibrium temperature anomaly $\\hat{T}_{\\mathrm{eq}} = \\hat{F} / \\hat{\\lambda}$. A check for $\\hat{\\lambda} \\approx 0$ is prudent.\n8.  Round the resulting triplet $[\\hat{F}, \\hat{\\lambda}, \\hat{T}_{\\mathrm{eq}}]$ to $3$ decimal places and store them.\n9.  After processing all test cases, format the collected results into the specified single-line string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Gregory regression on paired temperature and flux anomaly data\n    to estimate Effective Radiative Forcing (F), climate feedback parameter (lambda),\n    and equilibrium temperature anomaly (T_eq).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (noise-free reference)\n        (\n            [0.0, 0.5, 1.0, 1.5, 2.0],  # T data\n            [4.0, 3.5, 3.0, 2.5, 2.0]   # N data\n        ),\n        # Test case 2 (moderate variability)\n        (\n            [0.1, 0.3, 0.7, 1.2, 1.8],\n            [3.63, 3.31, 2.88, 2.22, 1.54]\n        ),\n        # Test case 3 (near-zero forcing with small variability)\n        (\n            [-0.1, 0.0, 0.1, 0.2, 0.3],\n            [0.35, 0.2, 0.07, -0.11, -0.25]\n        ),\n        # Test case 4 (low variance in T; numerically delicate)\n        (\n            [1.00, 1.01, 0.99, 1.02, 0.98],\n            [1.702, 1.691, 1.708, 1.686, 1.715]\n        )\n    ]\n\n    results = []\n    \n    for T_list, N_list in test_cases:\n        T = np.array(T_list, dtype=np.float64)\n        N = np.array(N_list, dtype=np.float64)\n\n        if T.shape[0]  2:\n            # Not enough data for regression, though not expected in this problem\n            # Push NaN or handle appropriately if this could occur\n            continue\n\n        # Step 1: Compute sample means\n        T_mean = np.mean(T)\n        N_mean = np.mean(N)\n\n        # Step 2: Compute terms for OLS estimators from first principles\n        # Numerator for slope: sum of cross-products of deviations\n        # Denominator for slope: sum of squared deviations for the independent variable\n        cov_tn_sum = np.sum((T - T_mean) * (N - N_mean))\n        var_t_sum = np.sum((T - T_mean)**2)\n\n        # Numerical robustness check\n        # A variance of exactly zero makes the slope undefined.\n        if np.isclose(var_t_sum, 0.0):\n            # This case is not expected based on problem description\n            # but is good practice to handle.\n            # We can't determine unique parameters.\n            F_hat, lambda_hat, T_eq_hat = np.nan, np.nan, np.nan\n        else:\n            # Step 3: Calculate OLS coefficients (beta_1_hat and beta_0_hat)\n            beta_1_hat = cov_tn_sum / var_t_sum\n            beta_0_hat = N_mean - beta_1_hat * T_mean\n\n            # Step 4: Map OLS coefficients to physical parameters\n            # F_hat is the intercept\n            F_hat = beta_0_hat\n            # lambda_hat is the negative of the slope\n            lambda_hat = -beta_1_hat\n            \n            # Step 5: Compute equilibrium temperature anomaly\n            # Check for non-zero feedback parameter to avoid division by zero\n            if np.isclose(lambda_hat, 0.0):\n                T_eq_hat = np.inf if F_hat  0 else (-np.inf if F_hat  0 else np.nan)\n            else:\n                T_eq_hat = F_hat / lambda_hat\n        \n        # Step 6: Round results to 3 decimal places\n        F_hat_rounded = round(F_hat, 3)\n        lambda_hat_rounded = round(lambda_hat, 3)\n        T_eq_hat_rounded = round(T_eq_hat, 3)\n        \n        results.extend([F_hat_rounded, lambda_hat_rounded, T_eq_hat_rounded])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{v:.3f}' for v in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Evaluating geoengineering goes beyond global averages; it requires assessing impacts on the extreme weather events that most affect society. This advanced practice explores how Solar Radiation Management (SRM) might alter temperature extremes using the powerful framework of Generalized Extreme Value (GEV) theory. By modeling how the distribution of yearly maximum temperatures responds to a change in the mean climate state, you will learn how to quantify shifts in the frequency and intensity of high-impact events, a key skill for comprehensive risk assessment .",
            "id": "3882601",
            "problem": "You are asked to implement a program to quantify the sensitivity of extremes to Solar Radiation Management (SRM) by computing changes in the distribution of daily maximum temperature using a Generalized Extreme Value (GEV) fit conditioned on modeled mean-state changes. The problem must be solved from first principles of Extreme Value Theory (EVT), starting from the Fisher–Tippett–Gnedenko theorem and the formal definition of the GEV distribution, and must not rely on shortcut formulas provided here. The analysis should be framed around block maxima of daily maximum temperature, treating yearly maxima as the blocks. For a given baseline GEV parameterization and a modeled mean-state temperature change due to SRM, define a conditioning for the GEV parameters in which the location parameter shifts linearly with the mean-state change and the scale parameter changes log-linearly, while keeping the shape parameter unchanged. Specifically, the conditioned parameters should be constructed as follows: the conditioned location parameter is $\\,\\mu(\\Delta)\\,$, the conditioned scale parameter is $\\,\\sigma(\\Delta)\\,$, and the conditioned shape parameter is $\\,\\xi\\,$, where $\\,\\Delta\\,$ denotes the modeled mean-state change in daily mean temperature due to SRM. The program must compute, for each test case:\n1. The baseline $m$-year return level of yearly maxima in Kelvin (K).\n2. The SRM-conditioned $m$-year return level in Kelvin (K).\n3. The change in return level in Kelvin (K), defined as the SRM-conditioned return level minus the baseline return level.\n4. The change in exceedance probability above a given threshold $T$ in the baseline and SRM-conditioned climates, expressed as a decimal (not a percentage), defined as the SRM-conditioned exceedance probability minus the baseline exceedance probability.\n\nYour derivation and implementation must be based only on the following foundational starting points:\n- The Fisher–Tippett–Gnedenko theorem, which asserts that block maxima of independent and identically distributed samples converge (under suitable normalization) to a Generalized Extreme Value (GEV) distribution.\n- The formal definition of a GEV distribution and its cumulative distribution function, including the limiting Gumbel case.\n- The concept of return levels as quantiles associated with a specified exceedance probability per block.\n\nConditioning on mean-state change must obey physical and statistical constraints: the scale parameter must remain strictly positive, and the support of the GEV distribution must be respected when computing probabilities and quantiles. If an input threshold lies outside the support of the distribution, the exceedance probability must be treated consistently with the distribution's support.\n\nImplement the following conditioning in your program:\n- The conditioned location parameter is $\\,\\mu(\\Delta) = \\mu_0 + \\alpha\\,\\Delta\\,$.\n- The conditioned scale parameter is $\\,\\sigma(\\Delta) = \\sigma_0\\,\\exp(\\beta\\,\\Delta)\\,$.\n- The shape parameter is constant $\\,\\xi\\,$ across baseline and SRM-conditioned climates.\n\nAll computations must use Kelvin (K) for temperature. All probabilities must be expressed as decimals. Angles are not involved in this problem.\n\nTest Suite (each case is a tuple of $(\\mu_0,\\sigma_0,\\xi,\\alpha,\\beta,\\Delta,T,m)$):\n- Case 1 (positive shape, SRM cooling, moderate variance): $(303.0,\\,2.0,\\,0.1,\\,0.8,\\,0.05,\\,-1.5,\\,305.0,\\,50)$.\n- Case 2 (Gumbel limit, neutral SRM): $(300.0,\\,3.0,\\,0.0,\\,1.0,\\,0.0,\\,0.0,\\,306.0,\\,100)$.\n- Case 3 (negative shape with finite upper bound, SRM cooling, threshold beyond support): $(310.0,\\,5.0,\\,-0.2,\\,0.5,\\,-0.02,\\,-2.0,\\,340.0,\\,100)$.\n- Case 4 (weakly positive shape, SRM warming scenario to test sensitivity direction): $(295.0,\\,1.5,\\,0.05,\\,0.7,\\,0.1,\\,1.0,\\,296.5,\\,20)$.\n\nYour program must:\n- For each test case, compute the baseline $m$-year return level in K, the SRM-conditioned $m$-year return level in K, the change in return level in K, and the change in exceedance probability above threshold $T$ (decimal).\n- Implement the limiting case when $\\,\\xi \\to 0\\,$ (Gumbel) consistently.\n- Enforce the GEV support constraints when computing exceedance probabilities and return levels; if a threshold $\\,T\\,$ lies outside support, use the appropriate limiting probability (zero exceedance if $\\,T\\,$ exceeds the upper bound for negative shape; full exceedance if $\\,T\\,$ lies below the lower bound for positive shape).\n- Use $\\,m > 1\\,$ for return period calculations.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, append in order the four values:\n$[\\text{RL}_{\\text{base}},\\,\\text{RL}_{\\text{SRM}},\\,\\Delta\\text{RL},\\,\\Delta P]$,\nflattened across all cases. Concretely, the output must be:\n$[\\text{RL}_{\\text{base},1},\\text{RL}_{\\text{SRM},1},\\Delta\\text{RL}_1,\\Delta P_1,\\text{RL}_{\\text{base},2},\\text{RL}_{\\text{SRM},2},\\Delta\\text{RL}_2,\\Delta P_2,\\text{RL}_{\\text{base},3},\\text{RL}_{\\text{SRM},3},\\Delta\\text{RL}_3,\\Delta P_3,\\text{RL}_{\\text{base},4},\\text{RL}_{\\text{SRM},4},\\Delta\\text{RL}_4,\\Delta P_4]$.\nAll return levels must be in Kelvin (K), and all probability differences must be decimals. The program must be self-contained and must not read input or write files.",
            "solution": "The problem requires the implementation of a program to quantify the sensitivity of temperature extremes to Solar Radiation Management (SRM) using a non-stationary Generalized Extreme Value (GEV) modeling framework. This involves computing changes in return levels and exceedance probabilities based on a specified conditioning of GEV parameters on mean-state temperature changes. The solution must be derived from the fundamental principles of Extreme Value Theory (EVT).\n\nThe validation process confirms that the problem is scientifically grounded, well-posed, and objective. It is rooted in standard statistical climatology practices, provides all necessary data and relationships, and is free from ambiguity or contradiction. We may therefore proceed with a formal derivation and solution.\n\n**1. Foundational Principles: The Generalized Extreme Value (GEV) Distribution**\n\nThe theoretical basis for this problem is the Fisher–Tippett–Gnedenko theorem, a cornerstone of Extreme Value Theory. The theorem states that for a sequence of independent and identically distributed (i.i.d.) random variables, the distribution of their block maxima (e.g., yearly maximum temperatures) converges to a member of the Generalized Extreme Value (GEV) family of distributions, under appropriate linear normalization.\n\nLet $X$ denote the yearly maximum temperature. The cumulative distribution function (CDF), $F(x)$, of the GEV distribution is given by:\n$$\nF(x; \\mu, \\sigma, \\xi) = \\exp \\left( -\\left[1 + \\xi \\left(\\frac{x - \\mu}{\\sigma}\\right)\\right]^{-1/\\xi} \\right)\n$$\nThis expression is valid for shape parameter $\\xi \\neq 0$. The parameters are the location $\\mu \\in \\mathbb{R}$, scale $\\sigma > 0$, and shape $\\xi \\in \\mathbb{R}$. The term within the brackets, $1 + \\xi \\left(\\frac{x - \\mu}{\\sigma}\\right)$, must be positive, which defines the support of the distribution:\n-   For $\\xi > 0$ (Fréchet case), the support is $x \\ge \\mu - \\frac{\\sigma}{\\xi}$ (a heavy-tailed distribution with a lower bound).\n-   For $\\xi  0$ (Weibull case), the support is $x \\le \\mu - \\frac{\\sigma}{\\xi}$ (a distribution with a finite upper bound).\n\nIn the limit as $\\xi \\to 0$, the GEV distribution converges to the Gumbel distribution (Type I extreme value distribution). The CDF for the Gumbel case is derived by taking the limit:\n$$\nF(x; \\mu, \\sigma, 0) = \\lim_{\\xi \\to 0} \\exp \\left( -\\left[1 + \\xi \\left(\\frac{x - \\mu}{\\sigma}\\right)\\right]^{-1/\\xi} \\right) = \\exp \\left( -\\exp \\left( -\\frac{x - \\mu}{\\sigma} \\right) \\right)\n$$\nFor $\\xi=0$, the support is the entire real line, $(-\\infty, \\infty)$.\n\n**2. Calculation of Exceedance Probability**\n\nThe exceedance probability, $P(X > T)$, is the probability that the annual maximum temperature $X$ exceeds a given threshold $T$. It is calculated using the survival function, $S(T) = 1 - F(T)$.\n\nFor $\\xi \\neq 0$:\n$$\nP(X > T) = 1 - \\exp \\left( -\\left[1 + \\xi \\left(\\frac{T - \\mu}{\\sigma}\\right)\\right]^{-1/\\xi} \\right)\n$$\nFor $\\xi = 0$:\n$$\nP(X > T) = 1 - \\exp \\left( -\\exp \\left( -\\frac{T - \\mu}{\\sigma} \\right) \\right)\n$$\nThe support constraints must be strictly enforced. Let $y_{arg} = 1 + \\xi \\left(\\frac{T - \\mu}{\\sigma}\\right)$.\n- If $\\xi > 0$ and $y_{arg} \\le 0$ (i.e., $T \\le \\mu - \\sigma/\\xi$), the threshold $T$ is below or at the distribution's lower bound. The probability of exceeding it is $1$.\n- If $\\xi  0$ and $y_{arg} \\le 0$ (i.e., $T \\ge \\mu - \\sigma/\\xi$), the threshold $T$ is above or at the distribution's upper bound. The probability of exceeding it is $0$.\n\n**3. Calculation of Return Level**\n\nThe $m$-year return level, denoted $RL_m$, is the temperature value that is expected to be equaled or exceeded on average once every $m$ years. The probability of exceedance in any given year is therefore $p = 1/m$. This value is determined by finding the quantile of the GEV distribution corresponding to a cumulative probability of $F(RL_m) = 1-p = 1 - 1/m$. We derive this by inverting the CDF.\n\nFor $\\xi \\neq 0$:\nLet $F(x) = 1 - p$.\n$$\n\\exp \\left( -\\left[1 + \\xi \\left(\\frac{x - \\mu}{\\sigma}\\right)\\right]^{-1/\\xi} \\right) = 1 - p\n$$\n$$\n-\\left[1 + \\xi \\left(\\frac{x - \\mu}{\\sigma}\\right)\\right]^{-1/\\xi} = \\ln(1 - p)\n$$\n$$\n1 + \\xi \\left(\\frac{x - \\mu}{\\sigma}\\right) = [-\\ln(1 - p)]^{-\\xi}\n$$\n$$\nx = \\mu + \\frac{\\sigma}{\\xi} \\left( [-\\ln(1 - p)]^{-\\xi} - 1 \\right)\n$$\nSubstituting $p = 1/m$, the $m$-year return level is:\n$$\nRL_m = \\mu + \\sigma \\frac{\\left(-\\ln\\left(1 - \\frac{1}{m}\\right)\\right)^{-\\xi} - 1}{\\xi}\n$$\n\nFor $\\xi = 0$ (Gumbel case):\nLet $F(x) = 1 - p$.\n$$\n\\exp \\left( -\\exp \\left( -\\frac{x - \\mu}{\\sigma} \\right) \\right) = 1 - p\n$$\n$$\n-\\exp \\left( -\\frac{x - \\mu}{\\sigma} \\right) = \\ln(1 - p)\n$$\n$$\n-\\frac{x - \\mu}{\\sigma} = \\ln(-\\ln(1 - p))\n$$\n$$\nx = \\mu - \\sigma \\ln(-\\ln(1 - p))\n$$\nSubstituting $p = 1/m$, the $m$-year return level is:\n$$\nRL_m = \\mu - \\sigma \\ln\\left(-\\ln\\left(1 - \\frac{1}{m}\\right)\\right)\n$$\n\n**4. Parameter Conditioning on Mean-State Change**\n\nThe problem defines a non-stationary model where GEV parameters are functions of the mean-state temperature change, $\\Delta$.\n- The baseline climate is described by parameters $(\\mu_0, \\sigma_0, \\xi)$.\n- The SRM-conditioned climate is described by parameters $(\\mu(\\Delta), \\sigma(\\Delta), \\xi)$, where:\n  - $\\mu(\\Delta) = \\mu_0 + \\alpha\\Delta$\n  - $\\sigma(\\Delta) = \\sigma_0 \\exp(\\beta\\Delta)$\n  - $\\xi$ remains constant.\nSince $\\sigma_0 > 0$ and the exponential function is always positive, the conditioned scale parameter $\\sigma(\\Delta)$ remains strictly positive, which is a required property.\n\n**5. Computational Procedure**\n\nFor each test case $(\\mu_0, \\sigma_0, \\xi, \\alpha, \\beta, \\Delta, T, m)$, the following quantities are computed:\n\n1.  **Parameters**:\n    -   Baseline: $\\mu_{base} = \\mu_0, \\sigma_{base} = \\sigma_0, \\xi_{base} = \\xi$.\n    -   SRM-conditioned: $\\mu_{SRM} = \\mu_0 + \\alpha\\Delta, \\sigma_{SRM} = \\sigma_0 \\exp(\\beta\\Delta), \\xi_{SRM} = \\xi$.\n\n2.  **Return Levels**:\n    -   Baseline Return Level: $RL_{base} = \\text{GEV_Quantile}(\\mu_{base}, \\sigma_{base}, \\xi_{base}, m)$.\n    -   SRM-conditioned Return Level: $RL_{SRM} = \\text{GEV_Quantile}(\\mu_{SRM}, \\sigma_{SRM}, \\xi_{SRM}, m)$.\n    -   Change in Return Level: $\\Delta RL = RL_{SRM} - RL_{base}$.\n\n3.  **Exceedance Probabilities**:\n    -   Baseline Exceedance Probability: $P_{base} = P(X > T | \\mu_{base}, \\sigma_{base}, \\xi_{base})$.\n    -   SRM-conditioned Exceedance Probability: $P_{SRM} = P(X > T | \\mu_{SRM}, \\sigma_{SRM}, \\xi_{SRM})$.\n    -   Change in Exceedance Probability: $\\Delta P = P_{SRM} - P_{base}$.\n\nThese calculations will be implemented in a Python program, carefully handling the special case $\\xi=0$ and the support constraints of the GEV distribution.",
            "answer": "```python\nimport numpy as np\n\ndef gev_quantile(m: float, mu: float, sigma: float, xi: float) - float:\n    \"\"\"\n    Computes the m-year return level (quantile) for a GEV distribution.\n\n    Args:\n        m (float): The return period in years (m  1).\n        mu (float): The location parameter.\n        sigma (float): The scale parameter (sigma  0).\n        xi (float): The shape parameter.\n\n    Returns:\n        float: The m-year return level.\n    \"\"\"\n    if m = 1:\n        raise ValueError(\"Return period m must be greater than 1.\")\n        \n    prob_exceed = 1.0 / m\n    # Term is -ln(1-p) which is -ln(1 - 1/m)\n    neg_log_cum_prob = -np.log(1.0 - prob_exceed)\n\n    # Use a small tolerance for floating point comparison to handle the Gumbel case\n    if abs(xi)  1e-9:\n        # Gumbel quantile function (xi - 0 limit)\n        return mu - sigma * np.log(neg_log_cum_prob)\n    else:\n        # GEV quantile function (xi != 0)\n        return mu + sigma * (np.power(neg_log_cum_prob, -xi) - 1.0) / xi\n\ndef gev_exceedance_prob(T: float, mu: float, sigma: float, xi: float) - float:\n    \"\"\"\n    Computes the exceedance probability P(X  T) for a GEV distribution.\n\n    Args:\n        T (float): The temperature threshold.\n        mu (float): The location parameter.\n        sigma (float): The scale parameter (sigma  0).\n        xi (float): The shape parameter.\n\n    Returns:\n        float: The exceedance probability.\n    \"\"\"\n    # Check for Gumbel case\n    if abs(xi)  1e-9:\n        z = (T - mu) / sigma\n        cdf = np.exp(-np.exp(-z))\n        return 1.0 - cdf\n\n    # GEV case (xi != 0)\n    arg = 1.0 + xi * (T - mu) / sigma\n\n    # Enforce support constraints\n    if arg = 0:\n        if xi  0:  # T is below or at the lower bound\n            return 1.0\n        else:  # xi  0, T is above or at the upper bound\n            return 0.0\n    \n    cdf = np.exp(-np.power(arg, -1.0 / xi))\n    return 1.0 - cdf\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and compute the required outputs.\n    \"\"\"\n    # Test Suite: (mu0, sigma0, xi, alpha, beta, Delta, T, m)\n    test_cases = [\n        (303.0, 2.0, 0.1, 0.8, 0.05, -1.5, 305.0, 50),\n        (300.0, 3.0, 0.0, 1.0, 0.0, 0.0, 306.0, 100),\n        (310.0, 5.0, -0.2, 0.5, -0.02, -2.0, 340.0, 100),\n        (295.0, 1.5, 0.05, 0.7, 0.1, 1.0, 296.5, 20),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        mu0, sigma0, xi, alpha, beta, delta, T, m = case\n\n        # 1. Baseline climate parameters\n        mu_base = mu0\n        sigma_base = sigma0\n        xi_base = xi\n\n        # 2. SRM-conditioned climate parameters\n        mu_srm = mu0 + alpha * delta\n        sigma_srm = sigma0 * np.exp(beta * delta)\n        xi_srm = xi\n\n        # 3. Compute return levels\n        rl_base = gev_quantile(m, mu_base, sigma_base, xi_base)\n        rl_srm = gev_quantile(m, mu_srm, sigma_srm, xi_srm)\n        delta_rl = rl_srm - rl_base\n\n        # 4. Compute exceedance probabilities\n        p_base = gev_exceedance_prob(T, mu_base, sigma_base, xi_base)\n        p_srm = gev_exceedance_prob(T, mu_srm, sigma_srm, xi_srm)\n        delta_p = p_srm - p_base\n\n        results.extend([rl_base, rl_srm, delta_rl, delta_p])\n\n    # Format the final output string\n    output_str = \"[\" + \",\".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}