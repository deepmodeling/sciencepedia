{
    "hands_on_practices": [
        {
            "introduction": "理论为我们提供了理想化的起点。我们如何将多个模型的输出组合起来，以获得最准确的单一预测？这项练习将引导你完成反方差加权法（inverse-variance weighting）的基本推导，该方法在模型无偏且相互独立的情况下，能够最小化均方误差（mean squared error）。理解这个推导至关重要，因为它构成了更复杂加权方案的基础。",
            "id": "3897949",
            "problem": "考虑在环境与地球系统模拟背景下，对季节性流域平均降水异常进行的多模式集合 (MME) 预报。设未知的真实异常为一个标量，记为 $y$。假设有 $K$ 个独立的数值模型为同一目标 $y$ 生成了标量预测因子 $X_{1}, X_{2}, \\dots, X_{K}$。每个预测因子对 $y$ 都是无偏的，即 $\\mathbb{E}[X_{i}] = y$，并且具有有限方差 $\\operatorname{Var}(X_{i}-y) = \\sigma_{i}^{2}$。定义一个线性集合估计量 $\\hat{y} = \\sum_{i=1}^{K} w_{i} X_{i}$，并满足归一化约束 $\\sum_{i=1}^{K} w_{i} = 1$，以在单个预测因子无偏的条件下保持集合估计的无偏性。\n\n从均方误差的定义出发，推导在上述假设条件下使期望平方误差 $\\mathbb{E}\\left[(\\hat{y} - y)^{2}\\right]$ 最小化的权重 $w_{i}$。你的推导必须使用第一性原理：均方误差的定义、模型误差的独立性以及归一化约束。请清楚地论证该优化问题的凸性及解的唯一性。\n\n然后，将你推导出的公式应用于以下针对 $K=4$ 个独立模型的、基于科学上真实的后报得到的方差（以 $\\text{mm}^{2}$ 为单位表示季节性异常）：\n$$\\sigma_{1}^{2} = 1,\\quad \\sigma_{2}^{2} = 4,\\quad \\sigma_{3}^{2} = 9,\\quad \\sigma_{4}^{2} = 16.$$\n计算该集合估计量的归一化权重 $w_{1}, w_{2}, w_{3}, w_{4}$。将权重表示为无量纲数，并将其各自四舍五入到四位有效数字。\n\n最后，解释在何种条件下，所推导的权重在最小化均方误差的意义上是最优的，并阐明如果模型误差不是独立的，而是具有一个已知的正定协方差矩阵，该解将如何推广。\n\n最终答案必须是针对给定数值方差计算出的权重向量。",
            "solution": "我们从集合估计量 $\\hat{y} = \\sum_{i=1}^{K} w_{i} X_{i}$ 的定义以及归一化约束 $\\sum_{i=1}^{K} w_{i} = 1$ 开始。由于每个预测因子都是无偏的，即 $\\mathbb{E}[X_{i}] = y$，因此当 $\\sum_{i=1}^{K} w_{i} = 1$ 时，集合估计量是无偏的，因为\n$$\n\\mathbb{E}[\\hat{y}] = \\mathbb{E}\\left[\\sum_{i=1}^{K} w_{i} X_{i}\\right] = \\sum_{i=1}^{K} w_{i} \\mathbb{E}[X_{i}] = \\sum_{i=1}^{K} w_{i} y = y.\n$$\n定义单个误差为 $e_{i} = X_{i} - y$。根据假设，$\\mathbb{E}[e_{i}] = 0$ 且 $\\operatorname{Var}(e_{i}) = \\sigma_{i}^{2}$，并且误差 $\\{e_{i}\\}$ 是相互独立的。集合误差为\n$$\n\\hat{y} - y = \\sum_{i=1}^{K} w_{i} X_{i} - y = \\sum_{i=1}^{K} w_{i} (y + e_{i}) - y = \\sum_{i=1}^{K} w_{i} e_{i}.\n$$\n$\\hat{y}$ 的均方误差是\n$$\n\\mathbb{E}\\left[(\\hat{y} - y)^{2}\\right] = \\mathbb{E}\\left[\\left(\\sum_{i=1}^{K} w_{i} e_{i}\\right)^{2}\\right].\n$$\n因为 $\\mathbb{E}[e_{i}] = 0$，$\\mathbb{E}\\left[(\\hat{y} - y)^{2}\\right]$ 等于集合误差的方差：\n$$\n\\operatorname{Var}\\left(\\sum_{i=1}^{K} w_{i} e_{i}\\right) = \\sum_{i=1}^{K} w_{i}^{2} \\operatorname{Var}(e_{i}) + 2 \\sum_{1 \\leq i  j \\leq K} w_{i} w_{j} \\operatorname{Cov}(e_{i}, e_{j}).\n$$\n在独立性假设下，对于 $i \\neq j$ 有 $\\operatorname{Cov}(e_{i}, e_{j}) = 0$，所以\n$$\n\\mathbb{E}\\left[(\\hat{y} - y)^{2}\\right] = \\sum_{i=1}^{K} w_{i}^{2} \\sigma_{i}^{2}.\n$$\n因此，优化问题是\n$$\n\\min_{w_{1},\\dots,w_{K}} \\sum_{i=1}^{K} w_{i}^{2} \\sigma_{i}^{2} \\quad \\text{subject to} \\quad \\sum_{i=1}^{K} w_{i} = 1.\n$$\n这是一个凸二次规划问题，因为目标函数是一个二次型，其 Hessian 矩阵为 $\\mathbf{H} = 2 \\operatorname{diag}(\\sigma_{1}^{2}, \\dots, \\sigma_{K}^{2})$，并且由于每个 $\\sigma_{i}^{2}  0$，该矩阵是正定的。因此，满足线性等式约束的任何驻点都是唯一的全局极小值点。\n\n我们使用拉格朗日乘子法求解。定义拉格朗日函数\n$$\n\\mathcal{L}(w_{1}, \\dots, w_{K}, \\lambda) = \\sum_{i=1}^{K} w_{i}^{2} \\sigma_{i}^{2} - \\lambda\\left(\\sum_{i=1}^{K} w_{i} - 1\\right).\n$$\n将偏导数设为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial w_{i}} = 2 w_{i} \\sigma_{i}^{2} - \\lambda = 0 \\quad \\Rightarrow \\quad w_{i} = \\frac{\\lambda}{2 \\sigma_{i}^{2}} \\quad \\text{for each } i,\n$$\n以及\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left(\\sum_{i=1}^{K} w_{i} - 1\\right) = 0 \\quad \\Rightarrow \\quad \\sum_{i=1}^{K} w_{i} = 1.\n$$\n将 $w_{i}$ 代入约束条件：\n$$\n\\sum_{i=1}^{K} \\frac{\\lambda}{2 \\sigma_{i}^{2}} = 1 \\quad \\Rightarrow \\quad \\frac{\\lambda}{2} \\sum_{i=1}^{K} \\frac{1}{\\sigma_{i}^{2}} = 1 \\quad \\Rightarrow \\quad \\lambda = \\frac{2}{\\sum_{j=1}^{K} \\sigma_{j}^{-2}}.\n$$\n因此，\n$$\nw_{i} = \\frac{\\lambda}{2 \\sigma_{i}^{2}} = \\frac{\\sigma_{i}^{-2}}{\\sum_{j=1}^{K} \\sigma_{j}^{-2}}.\n$$\n因此，最优权重与逆方差成正比，并经过归一化使其总和为一：\n$$\nw_{i} \\propto \\sigma_{i}^{-2}, \\quad \\text{with} \\quad w_{i} = \\frac{\\sigma_{i}^{-2}}{\\sum_{j=1}^{K} \\sigma_{j}^{-2}}.\n$$\n唯一性源于前面提到的严格凸性。\n\n将此公式应用于给定的数值方差 $\\sigma_{1}^{2} = 1$, $\\sigma_{2}^{2} = 4$, $\\sigma_{3}^{2} = 9$, $\\sigma_{4}^{2} = 16$。计算逆方差：\n$$\n\\sigma_{1}^{-2} = 1,\\quad \\sigma_{2}^{-2} = \\frac{1}{4},\\quad \\sigma_{3}^{-2} = \\frac{1}{9},\\quad \\sigma_{4}^{-2} = \\frac{1}{16}.\n$$\n逆方差之和：\n$$\nS = 1 + \\frac{1}{4} + \\frac{1}{9} + \\frac{1}{16} = \\frac{144 + 36 + 16 + 9}{144} = \\frac{205}{144}.\n$$\n归一化权重：\n$$\nw_{1} = \\frac{1}{S} = \\frac{144}{205},\\quad\nw_{2} = \\frac{\\frac{1}{4}}{S} = \\frac{36}{205},\\quad\nw_{3} = \\frac{\\frac{1}{9}}{S} = \\frac{16}{205},\\quad\nw_{4} = \\frac{\\frac{1}{16}}{S} = \\frac{9}{205}.\n$$\n转换为小数形式，并将每个值四舍五入到四位有效数字：\n$$\nw_{1} \\approx 0.702439024 \\to 0.7024,\\quad\nw_{2} \\approx 0.175609756 \\to 0.1756,\\quad\nw_{3} \\approx 0.078048780 \\to 0.07805,\\quad\nw_{4} \\approx 0.043902439 \\to 0.04390.\n$$\n\n最优性条件：逆方差归一化权重在以下条件下最小化 $\\mathbb{E}\\left[(\\hat{y} - y)^{2}\\right]$：\n- 各个预测因子是无偏的，即 $\\mathbb{E}[X_{i}] = y$，因此通过 $\\sum_{i} w_{i} = 1$ 可以使集合估计也无偏。\n- 误差 $e_{i} = X_{i} - y$ 是相互独立的，因此集合方差简化为 $\\sum_{i} w_{i}^{2} \\sigma_{i}^{2}$，没有交叉项。\n- 方差 $\\sigma_{i}^{2}$ 被正确指定（或可被一致估计），且为正。\n- 目标是均方误差；没有施加其他损失函数或约束。\n\n如果误差是相关的，其协方差矩阵 $\\boldsymbol{\\Sigma} = \\operatorname{Cov}(\\mathbf{e})$ 已知且正定，其中 $\\mathbf{e} = (e_{1},\\dots,e_{K})^{\\top}$，那么集合均方误差 (MSE) 变为\n$$\n\\mathbb{E}\\left[(\\hat{y} - y)^{2}\\right] = \\operatorname{Var}\\left(\\sum_{i=1}^{K} w_{i} e_{i}\\right) = \\mathbf{w}^{\\top} \\boldsymbol{\\Sigma} \\mathbf{w},\n$$\n其中 $\\mathbf{w} = (w_{1},\\dots,w_{K})^{\\top}$，无偏性约束为 $\\mathbf{1}^{\\top} \\mathbf{w} = 1$，$\\mathbf{1}$ 是全1向量。通过拉格朗日乘子法求解该约束二次规划问题，可得到唯一的极小值点，从而得出广义逆协方差权重\n$$\n\\mathbf{w}^{\\star} = \\frac{\\boldsymbol{\\Sigma}^{-1} \\mathbf{1}}{\\mathbf{1}^{\\top} \\boldsymbol{\\Sigma}^{-1} \\mathbf{1}},\n$$\n当 $\\boldsymbol{\\Sigma}$ 是对角矩阵（即误差独立）时，此公式简化为上面推导的逆方差公式。在 Gauss–Markov 假设下，这些权重是最佳线性无偏估计量 (BLUE)；对于均方误差最优性而言，并不要求正态性，只需要有限二阶矩和给定的协方差结构。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.7024  0.1756  0.07805  0.04390\\end{pmatrix}}$$"
        },
        {
            "introduction": "前一个练习中的最优权重取决于真实的模型误差方差，而这在实践中是未知的。我们必须根据数据来估计它们，但这个过程很容易出错，尤其是在样本量有限的情况下。这项练习探讨了“过拟合”（overfitting）背后的统计机制——即充满噪声的性能评估如何导致不稳定和不可靠的集合权重，并研究了正则化（regularization）如何提供一种解决方案。",
            "id": "3897954",
            "problem": "考虑一个环境与地球系统建模中的多模型集成，其中有 $K$ 个确定性模型 $\\{M_1,\\dots,M_K\\}$。对于一个包含 $n$ 个独立目标 $\\{y_i\\}_{i=1}^n$ 的验证集，每个模型 $M_m$ 产生预测值 $\\{\\hat{y}_i^{(m)}\\}_{i=1}^n$ 和误差 $e_i^{(m)} = y_i - \\hat{y}_i^{(m)}$。假设每个模型内的误差是独立同分布的，服从均值为零、方差为 $\\sigma_m^2$ 的高斯分布，并且在模型间是独立的。将在验证集上通过 $n$ 折交叉验证 (CV) 计算得到的模型 $m$ 的均方根误差 (RMSE) 定义为 $\\widehat{\\mathrm{RMSE}}_m = \\sqrt{\\frac{1}{n}\\sum_{i=1}^n (e_i^{(m)})^2}$，并令 $s_m^2 = \\widehat{\\mathrm{RMSE}}_m^2$ 表示均方误差估计。考虑基于性能的集成权重 $w_m$，其与 $s_m^2$ 成反比，并归一化到单纯形上：$\\tilde{w}_m = \\frac{1/s_m^2}{\\sum_{j=1}^K 1/s_j^2}$，其中 $\\tilde{w}_m \\ge 0$ 且 $\\sum_{m=1}^K \\tilde{w}_m = 1$。\n\n从上述定义和高斯误差的标准分布结果出发，推导 $\\mathbb{E}[1/s_m^2]$ 和 $\\mathrm{Var}(1/s_m^2)$ 关于 $n$ 和 $\\sigma_m^2$ 的表达式，并用这些表达式解释为什么当 $n$ 很小时，基于逆 CV RMSE 的权重会导致过拟合。特别地，考虑 $K=3$，真实方差为 $\\sigma_1^2 = 1$、$\\sigma_2^2 = 1.44$ 和 $\\sigma_3^2 = 2.25$，且 $n=10$ 的情况。量化 $1/s_1^2$ 的变异系数，并（使用关于卡方随机变量比率的分布推断）论证，纯粹由于抽样变异性，模型2获得比模型1更大权重的概率是不可忽略的。\n\n哪个选项为小 $n$ 时的过拟合机制提供了正确的解释，同时提供了一个数学上可辩护的、能够稳定权重的正则化策略，并包括对其方差缩减效应的推导？\n\nA. 用留一法交叉验证替换 $n$ 折交叉验证，并保持 $w_m \\propto 1/\\widehat{\\mathrm{RMSE}}_m^2$。因为留一法使用了最大可能的训练集，它消除了 $1/s_m^2$ 中的偏差，从而在 $n$ 很小时移除了过拟合。\n\nB. 求解一个带 $L_1$ 惩罚项的约束优化问题：最小化 $\\sum_{m=1}^K w_m s_m^2 + \\lambda \\sum_{m=1}^K |w_m|$，约束条件为 $w_m \\ge 0$ 和 $\\sum_{m=1}^K w_m = 1$。$L_1$ 惩罚项会诱导 $w_m$ 的稀疏性，因此在 $n$ 很小时能减少方差和过拟合。\n\nC. 使用向等权重的凸向收缩：定义 $\\tilde{w}_m = \\frac{1/s_m^2}{\\sum_{j=1}^K 1/s_j^2}$ 和 $w_m(\\lambda) = (1-\\lambda)\\frac{1}{K} + \\lambda \\tilde{w}_m$，其中 $0 \\le \\lambda \\le 1$，通过嵌套交叉验证选择 $\\lambda$。从 $\\mathbb{E}[1/s_m^2]$ 和 $\\mathrm{Var}(1/s_m^2)$ 出发，证明小 $n$ 会增大 $\\tilde{w}_m$ 的方差，并推导出 $\\mathrm{Var}(w_m(\\lambda)) = \\lambda^2 \\mathrm{Var}(\\tilde{w}_m)$，这在 $\\lambda  1$ 时能稳定权重。\n\nD. 通过定义 $w_m^{(\\alpha)} \\propto \\frac{1}{s_m^2 + \\alpha}$ 为 RMSE 添加 Tikhonov 正则化，其中为每个模型设置 $\\alpha = 2\\sigma_m^4/n$，这恰好抵消了 $s_m^2$ 的抽样方差，使得 $w_m^{(\\alpha)}$ 即使在 $n$ 很小时也是无偏且无方差的。",
            "solution": "用户要求对问题陈述进行严格验证，然后对所提供的选项进行全面推导和评估。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- $K$ 个确定性模型的集成：$\\{M_1, \\dots, M_K\\}$。\n- $n$ 个独立目标的验证集：$\\{y_i\\}_{i=1}^n$。\n- 模型 $M_m$ 的预测：$\\{\\hat{y}_i^{(m)}\\}_{i=1}^n$。\n- 误差：$e_i^{(m)} = y_i - \\hat{y}_i^{(m)}$。\n- 误差分布：对于固定的模型 $m$，误差 $e_i^{(m)}$ 是独立同分布 (i.i.d.) 的，服从均值为零、方差为 $\\sigma_m^2$ 的高斯分布，即 $e_i^{(m)} \\sim N(0, \\sigma_m^2)$。\n- 误差独立性：误差在模型间是独立的。\n- 均方根误差 (RMSE) 估计：$\\widehat{\\mathrm{RMSE}}_m = \\sqrt{\\frac{1}{n}\\sum_{i=1}^n (e_i^{(m)})^2}$。\n- 均方误差 (MSE) 估计：$s_m^2 = \\widehat{\\mathrm{RMSE}}_m^2 = \\frac{1}{n}\\sum_{i=1}^n (e_i^{(m)})^2$。\n- 集成权重定义：$\\tilde{w}_m = \\frac{1/s_m^2}{\\sum_{j=1}^K 1/s_j^2}$，其中 $\\tilde{w}_m \\ge 0$ 且 $\\sum_{m=1}^K \\tilde{w}_m = 1$。\n- 用于分析的具体案例：$K=3$, $\\sigma_1^2 = 1$, $\\sigma_2^2 = 1.44$, $\\sigma_3^2 = 2.25$, 以及 $n=10$。\n- 任务是推导 $\\mathbb{E}[1/s_m^2]$ 和 $\\mathrm{Var}(1/s_m^2)$，解释小 $n$ 时的过拟合现象，量化给定案例下的不稳定性，然后评估选项。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述具有科学依据、提法恰当且客观。它根植于标准统计理论，并应用于建模中常见的集成加权问题。所有术语都有数学定义。假设（i.i.d. 高斯误差，模型间独立）是在此背景下标准的简化假设。\n\n有一个轻微的术语模糊：“在验证集上通过 $n$ 折交叉验证 (CV) 计算”。通常，人们直接在验证集上计算误差度量，而不在其上*进一步*执行 CV 过程。$n$ 折 CV（或更准确地说，留一法 CV）是从单个数据集中生成样本外误差的过程。然而，这个模糊性被所提供的显式公式解决了：$s_m^2 = \\frac{1}{n}\\sum_{i=1}^n (e_i^{(m)})^2$。这是在一组 $n$ 个误差项上计算均方误差的标准定义。我们将根据这个明确的数学定义进行，将短语“在验证集上”解释为指定 $e_i^{(m)}$ 是该数据集上的误差。\n\n该问题在计算上和理论上都是可行的，没有违反任何科学或逻辑原则。\n\n**步骤 3：结论与行动**\n问题是**有效的**。我们继续进行解答。\n\n**推导与分析**\n\n**1. $s_m^2$ 的分布及 $1/s_m^2$ 的矩**\n给定模型 $m$ 的误差 $e_i^{(m)}$ 是 i.i.d. $N(0, \\sigma_m^2)$，则标准化误差 $z_i^{(m)} = e_i^{(m)} / \\sigma_m$ 是 i.i.d. $N(0, 1)$。这些值的平方 $(z_i^{(m)})^2$ 是 i.i.d. 的自由度为1的卡方随机变量 $\\chi^2(1)$。\n\n$n$ 个这样的独立变量之和服从自由度为 $n$ 的卡方分布：\n$$ \\sum_{i=1}^n \\left(\\frac{e_i^{(m)}}{\\sigma_m}\\right)^2 \\sim \\chi^2(n) $$\n估计的均方误差为 $s_m^2 = \\frac{1}{n} \\sum_{i=1}^n (e_i^{(m)})^2$。我们可以将平方和重写为 $n s_m^2$。将其代入前面的表达式得到：\n$$ \\frac{n s_m^2}{\\sigma_m^2} \\sim \\chi^2(n) $$\n令随机变量 $X = \\frac{n s_m^2}{\\sigma_m^2}$。我们关心的是 $1/s_m^2$ 的矩。根据上述关系，$s_m^2 = \\frac{\\sigma_m^2}{n} X$，这意味着 $1/s_m^2 = \\frac{n}{\\sigma_m^2} X^{-1}$。\n\n随机变量 $X$ 服从 $\\chi^2(n)$ 分布。其倒数 $X^{-1}$ 的矩与逆伽马分布的矩相关。$X^{-1}$ 的 $k$ 阶矩为 $\\mathbb{E}[X^{-k}] = \\frac{\\Gamma(n/2 - k)}{\\Gamma(n/2) 2^k}$，前提是 $n/2  k$。\n\n对于 $1/s_m^2$ 的期望，我们需要 $\\mathbb{E}[X^{-1}]$。使用 $k=1$：\n$$ \\mathbb{E}[X^{-1}] = \\frac{\\Gamma(n/2 - 1)}{\\Gamma(n/2) \\cdot 2} = \\frac{\\Gamma(n/2 - 1)}{(n/2-1)\\Gamma(n/2 - 1) \\cdot 2} = \\frac{1}{n-2} \\quad (\\text{对于 } n2) $$\n因此，$1/s_m^2$ 的期望是：\n$$ \\mathbb{E}\\left[\\frac{1}{s_m^2}\\right] = \\frac{n}{\\sigma_m^2} \\mathbb{E}[X^{-1}] = \\frac{n}{\\sigma_m^2} \\frac{1}{n-2} = \\frac{n}{n-2} \\frac{1}{\\sigma_m^2} $$\n\n对于 $1/s_m^2$ 的方差，我们首先需要二阶矩，$\\mathbb{E}[(1/s_m^2)^2] = (\\frac{n}{\\sigma_m^2})^2 \\mathbb{E}[X^{-2}]$。使用 $k=2$：\n$$ \\mathbb{E}[X^{-2}] = \\frac{\\Gamma(n/2 - 2)}{\\Gamma(n/2) \\cdot 2^2} = \\frac{\\Gamma(n/2 - 2)}{(n/2-1)(n/2-2)\\Gamma(n/2-2) \\cdot 4} = \\frac{1}{(n-2)(n-4)} \\quad (\\text{对于 } n4) $$\n所以，二阶矩是：\n$$ \\mathbb{E}\\left[\\left(\\frac{1}{s_m^2}\\right)^2\\right] = \\left(\\frac{n}{\\sigma_m^2}\\right)^2 \\frac{1}{(n-2)(n-4)} = \\frac{n^2}{(n-2)(n-4)} \\frac{1}{\\sigma_m^4} $$\n方差是 $\\mathrm{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2$：\n$$ \\mathrm{Var}\\left(\\frac{1}{s_m^2}\\right) = \\frac{n^2}{(n-2)(n-4)\\sigma_m^4} - \\left(\\frac{n}{(n-2)\\sigma_m^2}\\right)^2 = \\frac{n^2}{\\sigma_m^4} \\left( \\frac{1}{(n-2)(n-4)} - \\frac{1}{(n-2)^2} \\right) $$\n$$ \\mathrm{Var}\\left(\\frac{1}{s_m^2}\\right) = \\frac{n^2}{\\sigma_m^4(n-2)^2} \\left( \\frac{n-2}{n-4} - 1 \\right) = \\frac{n^2}{\\sigma_m^4(n-2)^2} \\left( \\frac{(n-2)-(n-4)}{n-4} \\right) = \\frac{2n^2}{(n-2)^2(n-4)\\sigma_m^4} $$\n这个表达式对于 $n  4$ 是有效的。\n\n**2. 小 $n$ 时的过拟合**\n推导出的矩揭示了小 $n$ 时的两个关键问题：\n- **偏差：** $\\mathbb{E}[1/s_m^2] = \\frac{n}{n-2} \\frac{1}{\\sigma_m^2}$。因子 $\\frac{n}{n-2}$ 大于1，意味着 $1/s_m^2$ 是真实逆方差 $1/\\sigma_m^2$ 的有偏估计量，并且对于小 $n$ 这种偏差很严重（对于 $n=2$ 是无限的）。\n- **方差：** $\\mathrm{Var}(1/s_m^2)$ 的分母中有一个因子 $(n-4)$，这导致对于小 $n$ 方差极大（当 $n \\to 4^+$ 时趋于无穷大）。\n\n高方差意味着估计值 $1/s_m^2$ 噪声很大，并且可能与其期望值有很大偏差。由于权重 $\\tilde{w}_m$ 与 $1/s_m^2$ 成正比，一个真实性能较差（$\\sigma_m^2$ 较大）的模型，可能在一个小验证集上偶然产生了一个小的 $s_m^2$，从而获得一个不应有的大权重。这是一种过拟合：权重被调整以适应小验证集中的随机噪声，而不是真实的潜在模型技能。\n\n**3. 量化特定案例下的不稳定性**\n给定 $K=3$, $n=10$, $\\sigma_1^2=1$, $\\sigma_2^2=1.44$。\n我们计算 $1/s_1^2$ 的变异系数 (CV)：$\\mathrm{CV} = \\frac{\\sqrt{\\mathrm{Var}(1/s_1^2)}}{\\mathbb{E}[1/s_1^2]}$。\n$$ \\mathbb{E}[1/s_1^2] = \\frac{10}{10-2} \\frac{1}{1} = \\frac{10}{8} = 1.25 $$\n$$ \\mathrm{Var}(1/s_1^2) = \\frac{2(10^2)}{(10-2)^2(10-4)} \\frac{1}{1^2} = \\frac{200}{8^2 \\cdot 6} = \\frac{200}{384} = \\frac{25}{48} $$\n$$ \\mathrm{CV}(1/s_1^2) = \\frac{\\sqrt{25/48}}{1.25} = \\frac{5/\\sqrt{48}}{5/4} = \\frac{4}{\\sqrt{48}} = \\frac{4}{4\\sqrt{3}} = \\frac{1}{\\sqrt{3}} \\approx 0.577 $$\n大约 $57.7\\%$ 的变异系数是极高的，表明存在巨大的抽样变异性。\n\n接下来，我们论证性能较差的模型2获得比模型1更大权重的概率是不可忽略的。这对应于事件 $\\tilde{w}_2  \\tilde{w}_1$，等价于 $1/s_2^2  1/s_1^2$，或 $s_1^2  s_2^2$。\n我们知道 $\\frac{n s_1^2}{\\sigma_1^2} \\sim \\chi^2(n)$ 和 $\\frac{n s_2^2}{\\sigma_2^2} \\sim \\chi^2(n)$ 并且它们是独立的。设 $X_1$ 和 $X_2$ 是独立的 $\\chi^2(n)$ 随机变量。那么 $s_1^2 = \\frac{\\sigma_1^2}{n} X_1$ 和 $s_2^2 = \\frac{\\sigma_2^2}{n} X_2$。\n条件 $s_1^2  s_2^2$ 变为 $\\frac{\\sigma_1^2}{n} X_1  \\frac{\\sigma_2^2}{n} X_2$，可以简化为 $\\frac{X_1}{X_2}  \\frac{\\sigma_2^2}{\\sigma_1^2}$。\n两个独立的、各自除以其自由度 $n$ 的 $\\chi^2$ 变量之比服从自由度为 $(n, n)$ 的 F 分布。所以，$\\frac{X_1/n}{X_2/n} = \\frac{X_1}{X_2} \\sim F(n, n)$。\n我们需要计算 $P(F(10, 10)  \\frac{1.44}{1}) = P(F(10, 10)  1.44)$。\n$F(10, 10)$ 分布的中位数是 $1$。均值是 $n/(n-2) = 1.25$。由于 $1.44$ 离均值不远，我们预计会有一个相当大的概率。标准的统计表或软件显示 $F(10, 10)$ 的75百分位数大约是 $1.53$。因为 $1.44  1.53$，所以概率 $P(F(10, 10)  1.44)$ 大于 $0.25$。精确计算得出大约为 $0.26$。$26\\%$ 的概率当然是不可忽略的。\n\n**逐项分析选项**\n\n**A. 用留一法交叉验证替换 $n$ 折交叉验证，并保持 $w_m \\propto 1/\\widehat{\\mathrm{RMSE}}_m^2$。因为留一法使用了最大可能的训练集，它消除了 $1/s_m^2$ 中的偏差，从而在 $n$ 很小时移除了过拟合。**\n留一法交叉验证 (LOOCV) 已知可以提供对真实预测误差的近似无偏估计，但估计本身通常具有高方差。这里的根本问题是在小样本上性能估计（及其倒数）的高方差，这导致权重不稳定。LOOCV 并没有解决这个高方差问题。事实上，由于 $n$ 个训练集之间的高度相关性，LOOCV 误差估计的方差可能比使用较小 $k$ 的 $k$ 折 CV 更高。声称它“消除了 $1/s_m^2$ 中的偏差”是不正确的；偏差来自于非线性的倒数函数，这并未被移除。声称它“移除了过拟合”是错误的夸大。\n**结论：不正确。**\n\n**B. 求解一个带 $L_1$ 惩罚项的约束优化问题：最小化 $\\sum_{m=1}^K w_m s_m^2 + \\lambda \\sum_{m=1}^K |w_m|$，约束条件为 $w_m \\ge 0$ 和 $\\sum_{m=1}^K w_m = 1$。$L_1$ 惩罚项会诱导 $w_m$ 的稀疏性，因此在 $n$ 很小时能减少方差和过拟合。**\n这个提法根本上是有缺陷的。约束条件 $w_m \\ge 0$ 和 $\\sum_{m=1}^K w_m = 1$ 意味着 $\\sum_{m=1}^K |w_m| = \\sum_{m=1}^K w_m = 1$。因此，惩罚项 $\\lambda \\sum |w_m|$ 只是一个常数 $\\lambda$。向目标函数添加一个常数不会改变解。问题简化为在单纯形上最小化 $\\sum_{m=1}^K w_m s_m^2$。这个线性规划的解是将所有权重（$w_m=1$）分配给具有最小 $s_m^2$ 的模型，而其他所有模型的权重为零。这种“赢者通吃”的方法是对验证集过拟合的最极端形式，并表现出最大方差，与所期望的稳定化效果完全相反。\n**结论：不正确。**\n\n**C. 使用向等权重的凸向收缩：定义 $\\tilde{w}_m = \\frac{1/s_m^2}{\\sum_{j=1}^K 1/s_j^2}$ 和 $w_m(\\lambda) = (1-\\lambda)\\frac{1}{K} + \\lambda \\tilde{w}_m$，其中 $0 \\le \\lambda \\le 1$，通过嵌套交叉验证选择 $\\lambda$。从 $\\mathbb{E}[1/s_m^2]$ 和 $\\mathrm{Var}(1/s_m^2)$ 出发，证明小 $n$ 会增大 $\\tilde{w}_m$ 的方差，并推导出 $\\mathrm{Var}(w_m(\\lambda)) = \\lambda^2 \\mathrm{Var}(\\tilde{w}_m)$，这在 $\\lambda  1$ 时能稳定权重。**\n该选项正确地指出了问题所在：小 $n$ 会增大由数据驱动的权重 $\\tilde{w}_m$ 的方差。提出的解决方案是一种标准且有效的正则化技术：将高方差的估计值 $\\tilde{w}_m$ 向一个稳定的、低方差的目标（等权重，$1/K$）收缩。参数 $\\lambda$ 控制收缩的量。收缩后估计量方差的推导是正确的。对于一个常数 $\\lambda$，$\\mathrm{Var}(w_m(\\lambda)) = \\mathrm{Var}((1-\\lambda)\\frac{1}{K} + \\lambda \\tilde{w}_m)$。由于 $(1-\\lambda)\\frac{1}{K}$ 是一个常数，这简化为 $\\mathrm{Var}(\\lambda \\tilde{w}_m) = \\lambda^2 \\mathrm{Var}(\\tilde{w}_m)$。由于 $0 \\le \\lambda  1$，因子 $\\lambda^2$ 小于1，这证明了权重的方差得到了保证的缩减。这解决了不稳定的核心问题。通过嵌套交叉验证来选择 $\\lambda$ 是找到良好偏差-方差权衡的恰当程序。\n**结论：正确。**\n\n**D. 通过定义 $w_m^{(\\alpha)} \\propto \\frac{1}{s_m^2 + \\alpha}$ 为 RMSE 添加 Tikhonov 正则化，其中为每个模型设置 $\\alpha = 2\\sigma_m^4/n$，这恰好抵消了 $s_m^2$ 的抽样方差，使得 $w_m^{(\\alpha)}$ 即使在 $n$ 很小时也是无偏且无方差的。**\n该选项提出了一种正则化形式（阻尼逆），这是一个有效的想法。然而，它的声明是不正确和夸大的。首先，提出的 $\\alpha$ 值依赖于真实的方差 $\\sigma_m^2$，这在实践中是未知的。其次，虽然 $\\alpha = \\frac{2\\sigma_m^4}{n}$ 确实等于 $\\mathrm{Var}(s_m^2)$，但将其加到分母上并不会使得到的 $1/\\sigma_m^2$ 的估计量变为无偏。由于非线性变换，$\\mathbb{E}[1/(s_m^2 + \\alpha)] \\neq 1/(\\mathbb{E}[s_m^2] + \\alpha)$，并且通常不等于 $1/\\sigma_m^2$。第三，声称得到的权重是“无方差的”是明显错误的。权重 $w_m^{(\\alpha)}$ 仍然是随机变量 $s_m^2$ 的函数，所以它必须有非零方差。正则化减少了方差，但没有消除它。\n**结论：不正确。**",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "在开发了不同的加权方案——从简单平均到复杂的、基于性能的方法——之后，一个关键问题随之而来：某个方案在统计上是否优于另一个？由于预报误差中存在时间自相关等因素，简单地比较平均得分可能会产生误导。这个编程练习将演示如何实现配对块自举检验（paired block bootstrap test），这是一种在时间序列预报评估中进行假设检验的强大而稳健的方法。",
            "id": "3897964",
            "problem": "在环境与地球系统建模中，给定两种相互竞争的集合加权方案，您需要根据连续分级概率评分 (CRPS) 来评估其中一种方案是否显著优于另一种。根据定义，对于一个累积分布函数为 $F(z)$ 的概率预报和一个实际观测值 $y$，连续分级概率评分 (CRPS) 是积分 $$\\mathrm{CRPS}(F,y) = \\int_{-\\infty}^{\\infty} \\left(F(z) - \\mathbb{1}\\{z \\ge y\\}\\right)^2 \\, \\mathrm{d}z,$$ 其物理单位与预报量的单位相同。$\\mathrm{CRPS}$ 值越低，表示概率预报效果越好。在本问题中，每日和每种方案的 CRPS 值已经计算好；您无需从 $F$ 和 $y$ 计算 CRPS。\n\n您必须构建一个配对块自举法假设检验，以评估在指定时期内，考虑到时间自相关的情况下，集合加权方案 $A$ 是否显著优于方案 $B$。假设有一个由 $t \\in \\{1,2,\\dots,N\\}$ 索引的 $N$ 天序列。设 $C^{A}_t$ 和 $C^{B}_t$ 分别表示方案 $A$ 和方案 $B$ 的每日 CRPS 值。定义配对日改善量 $$d_t = C^{B}_t - C^{A}_t,$$ 当方案 $A$ 在第 $t$ 天的 CRPS 低于方案 $B$ 时，该值为正。推断目标是平均改善量 $$\\mu_d = \\mathbb{E}[d_t].$$ 您需要检验单侧假设 $$H_0: \\mu_d \\le 0 \\quad \\text{versus} \\quad H_1: \\mu_d  0,$$ 其中，拒绝原假设意味着支持方案 $A$ 显著优于方案 $B$。\n\n为保持科学真实性，请使用块自举法来处理 $\\{d_t\\}$ 中的自相关。将时间序列划分为长度为 $L$ 天的不重叠连续块；如果 $L$ 不能整除 $N$，最后一个块可能会短一些。设样本均值为 $$\\bar{d} = \\frac{1}{N} \\sum_{t=1}^N d_t.$$ 通过对差值进行中心化，在原假设下创建一个均值为零的序列：$$r_t = d_t - \\bar{d}.$$ 对于每个自举复制 $i \\in \\{1,2,\\dots,R\\}$，从原始块集合中有放回地抽取块，将抽取的 $\\{r_t\\}$ 块连接起来，直到达到至少 $N$ 个元素，然后截断为 $N$ 个元素，并计算复制均值 $\\bar{r}^{*(i)}$。那么，$H_0: \\mu_d \\le 0$ 的一个近似单侧 p 值为 $$p = \\frac{1}{R} \\sum_{i=1}^R \\mathbb{1}\\left\\{\\bar{r}^{*(i)} \\ge \\bar{d}\\right\\}.$$ 对于选定的显著性水平 $\\alpha \\in (0,1)$，如果 $p  \\alpha$，则判定方案 $A$ 显著优于方案 $B$。\n\n您必须在一个完整的、可运行的程序中实现此检验。该程序必须为每个测试用例生成合成但科学上合理的每日 CRPS 序列，并使用自回归过程来模拟时间自相关。具体来说，对于每个测试用例：\n- 生成一个基准一阶自回归过程 $\\{X_t\\}$ (AR(1))，其参数为 $\\phi \\in (-1, 1)$，高斯新息的标准差为 $\\sigma$，即 $$X_t = \\phi X_{t-1} + \\epsilon_t, \\quad \\epsilon_t \\sim \\mathcal{N}(0, \\sigma_t^2),$$ 其中 $X_0 = 0$，且 $\\sigma_t = \\sigma$ 为常数，或为指定的分段常数异方差序列。\n- 生成特定于方案的误差 $\\{E^A_t\\}$ 和 $\\{E^B_t\\}$，它们是独立的 AR(1) 过程，具有固定参数 $\\phi_s = 0.4$ 和固定标准差为 $\\sigma_s = 0.08$ 的高斯新息，除非另有说明。\n- 构建每日 CRPS 值 $$C^{B}_t = \\beta + X_t + E^B_t, \\qquad C^{A}_t = \\beta + X_t + E^A_t - \\Delta,$$ 其中 $\\beta = 1.0$ 确保非负性，然后通过将因噪声产生的任何负值替换为 $0$ 来强制执行非负性。量 $\\Delta$ 表示方案 $A$ 相对于方案 $B$ 的预期改善量；正的 $\\Delta$ 意味着 $A$ 倾向于比 $B$ 有更低的 CRPS。\n\n然后，您必须应用上述配对块自举法检验来计算 p 值 $p$，并为每个测试用例返回一个布尔决策，指示是否 $p  \\alpha$。\n\n角度单位不适用。CRPS 的物理单位是预报量的单位，但最终输出是布尔值，因此无量纲。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3]”）。\n\n使用以下测试套件，每个套件由 $(N, \\phi, \\sigma, \\Delta, L, R, \\alpha, \\text{seed}, \\text{heteroskedastic})$ 指定，其中 heteroskedastic 表示 $\\sigma_t$ 是否如指定的那样随时间变化：\n- 案例 1 (一般“顺利”路径): $(N = 180, \\phi = 0.6, \\sigma = 0.2, \\Delta = 0.15, L = 10, R = 5000, \\alpha = 0.05, \\text{seed} = 123, \\text{heteroskedastic} = \\text{False})$。\n- 案例 2 (边界情况，独立日): $(N = 180, \\phi = 0.0, \\sigma = 0.25, \\Delta = 0.0, L = 1, R = 3000, \\alpha = 0.05, \\text{seed} = 456, \\text{heteroskedastic} = \\text{False})$。\n- 案例 3 (不可整除的块长度，小样本): $(N = 23, \\phi = 0.7, \\sigma = 0.3, \\Delta = 0.10, L = 10, R = 5000, \\alpha = 0.05, \\text{seed} = 321, \\text{heteroskedastic} = \\text{False})$。\n- 案例 4 (效果相反，方案 $A$ 更差): $(N = 120, \\phi = 0.5, \\sigma = 0.25, \\Delta = -0.10, L = 7, R = 4000, \\alpha = 0.05, \\text{seed} = 789, \\text{heteroskedastic} = \\text{False})$。\n- 案例 5 (异方差自相关): $(N = 240, \\phi = 0.6, \\sigma = 0.1 \\text{ for } t \\le N/2 \\text{ and } \\sigma = 0.3 \\text{ for } t  N/2, \\Delta = 0.12, L = 12, R = 6000, \\alpha = 0.05, \\text{seed} = 2024, \\text{heteroskedastic} = \\text{True})$。\n\n对于每个案例，根据上述规则使用指定的参数生成 $\\{C^{A}_t\\}$ 和 $\\{C^{B}_t\\}$，计算配对差值 $\\{d_t\\}$，执行配对块自举法检验，并返回一个布尔值，指示方案 $A$ 是否在水平 $\\alpha$ 上显著优于方案 $B$。\n\n您的程序应生成单行输出，其中包含与五个案例相对应的五个布尔值的列表，按案例 1 到案例 5 的顺序排列，格式为用方括号括起来的逗号分隔列表，例如“[True,False,True,False,True]”。",
            "solution": "问题陈述已经过分析，被认为是有效的。它具有科学依据，提法明确，客观，并包含构建唯一且可验证解决方案所需的所有必要信息。所描述的方法——应用于模拟时间序列数据的配对块自举法假设检验——是统计气候学和环境科学中一种标准且适当的技术，用于在考虑时间自相关的情况下比较模型或预报的性能。用于数据生成和统计检验的所有参数都已明确提供。\n\n目标是实现一个配对块自举法假设检验，以确定一个表示为方案 $A$ 的预报集合加权方案是否比竞争方案 $B$ 提供了统计上显著的改善。性能指标是连续分级概率评分 (CRPS)，其中较低的值表示更好的性能。方案 $A$ 相对于方案 $B$ 在第 $t$ 天的改善量由差值 $d_t = C^B_t - C^A_t$ 来衡量，其中 $C^A_t$ 和 $C^B_t$ 分别是各自的 CRPS 值。$d_t$ 的正值表示方案 $A$ 在那一天表现更好。\n\n核心推断任务是检验关于真实平均改善量 $\\mu_d = \\mathbb{E}[d_t]$ 的单侧假设：\n$$H_0: \\mu_d \\le 0 \\quad \\text{(方案 A 不优于方案 B)}$$\n$$H_1: \\mu_d  0 \\quad \\text{(方案 A 显著优于方案 B)}$$\n\n解决方案分为三个主要阶段：合成数据生成、块自举法检验的实现，以及基于计算出的 p 值的最终决策。\n\n**1. 合成数据生成**\n\n为了创建一个现实的测试平台，我们首先为 $N$ 天生成合成的每日 CRPS 时间序列 $\\{C^A_t\\}$ 和 $\\{C^B_t\\}$。这个过程模拟了真实世界环境数据的特征，特别是时间自相关。\n\n每日 CRPS 值的构建如下：\n$$C^{B}_t = \\beta + X_t + E^B_t$$\n$$C^{A}_t = \\beta + X_t + E^A_t - \\Delta$$\n\n这里，$\\beta = 1.0$ 是一个基准 CRPS 值，确保评分通常为正。$\\{X_t\\}$ 代表一个影响两种方案的共同潜在环境过程。它被建模为一个一阶自回归 (AR(1)) 过程：\n$$X_t = \\phi X_{t-1} + \\epsilon_t, \\quad \\text{with } X_0 = 0$$\n其中 $\\phi$ 是自相关参数，$\\epsilon_t$ 是高斯新息，$\\epsilon_t \\sim \\mathcal{N}(0, \\sigma_t^2)$。标准差 $\\sigma_t$ 可以是常数，也可以随时间变化（异方差性）。\n\n$\\{E^A_t\\}$ 和 $\\{E^B_t\\}$ 是独立的、特定于方案的误差项，同样被建模为具有固定参数 $\\phi_s = 0.4$ 和新息标准差 $\\sigma_s = 0.08$ 的 AR(1) 过程。\n\n参数 $\\Delta$ 代表方案 $A$ 相对于方案 $B$ 的系统性改善。如果 $\\Delta  0$，则方案 $A$ 被设计为平均具有更低的 CRPS。每日差值的期望值为 $\\mathbb{E}[d_t] = \\mathbb{E}[C^B_t - C^A_t] = \\mathbb{E}[(\\beta + X_t + E^B_t) - (\\beta + X_t + E^A_t - \\Delta)] = \\Delta$。因此，检验 $\\mu_d  0$ 等价于检验 $\\Delta  0$。\n\n最后，由于 CRPS 值不能为负，任何生成的小于 $0$ 的值都将被设置为 $0$。\n\n**2. 配对块自举法检验**\n\n采用块自举法是因为每日差值序列 $d_t = C^B_t - C^A_t = (E^B_t - E^A_t) + \\Delta$ 继承了 AR(1) 误差项的时间自相关性。该方法通过重采样连续观测块而非单个数据点来保持依赖结构。\n\n步骤如下：\n- **计算观测统计量**：计算每日差值的样本均值 $\\bar{d} = \\frac{1}{N} \\sum_{t=1}^N d_t$。这是我们对 $\\mu_d$ 的最佳估计。\n- **中心化数据**：为了模拟原假设 ($H_0: \\mu_d = 0$)，我们创建一个重中心化序列 $r_t = d_t - \\bar{d}$。该序列的样本均值恰好为 $0$，并保留了原始 $\\{d_t\\}$ 序列的自相关结构。\n- **形成数据块**：将重中心化序列 $\\{r_t\\}$ 划分为长度为 $L$ 的不重叠块。如果 $N$ 不能被 $L$ 整除，最后一个块会更短。\n- **自举重采样**：对于 $R$ 个自举复制中的每一个：1. 通过从原始块集合中有放回地抽样，创建一个长度至少为 $N$ 的新时间序列。需要抽取的块数为 $\\lceil N/L \\rceil$。2. 将连接得到的序列截断为原始长度 $N$。3. 计算该自举复制序列的均值 $\\bar{r}^{*(i)}$。此过程生成了原假设下均值的经验抽样分布。\n\n**3. P 值计算与决策**\n\n单侧 p 值是自举均值 $\\bar{r}^{*(i)}$ 中等于或比观测样本均值 $\\bar{d}$ 更极端的比例。对于我们的备择假设 $H_1: \\mu_d  0$，这表示为：\n$$p = \\frac{1}{R} \\sum_{i=1}^R \\mathbb{1}\\left\\{\\bar{r}^{*(i)} \\ge \\bar{d}\\right\\}$$\n其中 $\\mathbb{1}\\{\\cdot\\}$ 是指示函数。这个 p 值表示在真实改善量实际为零的情况下，观测到等于或大于 $\\bar{d}$ 的平均改善量的概率。\n\n最终决策是通过将 p 值与预定义的显著性水平 $\\alpha$ 进行比较得出的。如果 $p  \\alpha$，我们拒绝原假设 $H_0$，并得出结论：方案 $A$ 相对于方案 $B$ 有统计上显著的改善。否则，我们不拒绝 $H_0$。将对每个测试用例使用指定的参数实施这整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef generate_ar1(n_samples: int, phi: float, sigma_vec: np.ndarray, rng: np.random.Generator) - np.ndarray:\n    \"\"\"\n    Generates a first-order autoregressive (AR(1)) time series.\n    X_t = phi * X_{t-1} + innovation_t\n    \"\"\"\n    if n_samples == 0:\n        return np.array([])\n    \n    innovations = rng.normal(0, sigma_vec, n_samples)\n    x = np.zeros(n_samples)\n    # Per problem statement X_0 = 0, so the first term is just the first innovation\n    x[0] = innovations[0]\n    for t in range(1, n_samples):\n        x[t] = phi * x[t-1] + innovations[t]\n    return x\n\ndef perform_bootstrap_test(case_params):\n    \"\"\"\n    Generates synthetic data and performs the paired block bootstrap test for a single case.\n    \"\"\"\n    N, phi, sigma, Delta, L, R, alpha, seed, heteroskedastic = case_params\n\n    rng = np.random.default_rng(seed)\n\n    # 1. Generate synthetic CRPS data\n    # Define baseline AR(1) process standard deviation\n    if heteroskedastic:\n        # Case 5 specifics: sigma=0.1 for first half, 0.3 for second half\n        sigma_t = np.full(N, sigma) \n        sigma_t[N//2:] = 0.3\n    else:\n        sigma_t = np.full(N, sigma)\n\n    X_t = generate_ar1(N, phi, sigma_t, rng)\n\n    # Define scheme-specific AR(1) errors\n    phi_s = 0.4\n    sigma_s = 0.08\n    sigma_s_vec = np.full(N, sigma_s)\n    E_A_t = generate_ar1(N, phi_s, sigma_s_vec, rng)\n    E_B_t = generate_ar1(N, phi_s, sigma_s_vec, rng)\n\n    # Construct CRPS values\n    beta = 1.0\n    C_B_t = beta + X_t + E_B_t\n    C_A_t = beta + X_t + E_A_t - Delta\n    \n    # Enforce non-negativity of CRPS\n    C_A_t = np.maximum(0, C_A_t)\n    C_B_t = np.maximum(0, C_B_t)\n\n    # 2. Implement the Paired Block Bootstrap Test\n    d_t = C_B_t - C_A_t\n    \n    if N == 0:\n        return False\n\n    d_bar = np.mean(d_t)\n    \n    # Center the series to simulate the null hypothesis (mean = 0)\n    r_t = d_t - d_bar\n\n    # Partition the centered series into non-overlapping blocks\n    # np.array_split handles non-divisible lengths correctly\n    split_indices = np.arange(L, N, L)\n    blocks = np.array_split(r_t, split_indices)\n\n    # Perform bootstrap resampling\n    bootstrap_means = np.zeros(R)\n    num_blocks_to_sample = int(np.ceil(N / L))\n    \n    for i in range(R):\n        # Sample block indices with replacement\n        block_indices = rng.choice(len(blocks), size=num_blocks_to_sample, replace=True)\n        \n        # Concatenate sampled blocks and truncate to length N\n        bootstrap_series = np.concatenate([blocks[j] for j in block_indices])[:N]\n        \n        # Compute mean of the bootstrap replicate\n        bootstrap_means[i] = np.mean(bootstrap_series)\n\n    # 3. Calculate p-value and determine significance\n    # p = proportion of bootstrap means >= observed mean\n    p_value = np.mean(bootstrap_means >= d_bar)\n    \n    return p_value  alpha\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (N, phi, sigma, Delta, L, R, alpha, seed, heteroskedastic)\n        (180, 0.6, 0.2, 0.15, 10, 5000, 0.05, 123, False),\n        (180, 0.0, 0.25, 0.0, 1, 3000, 0.05, 456, False),\n        (23, 0.7, 0.3, 0.10, 10, 5000, 0.05, 321, False),\n        (120, 0.5, 0.25, -0.10, 7, 4000, 0.05, 789, False),\n        (240, 0.6, 0.1, 0.12, 12, 6000, 0.05, 2024, True)\n    ]\n\n    results = []\n    for case in test_cases:\n        result = perform_bootstrap_test(case)\n        results.append(str(result))\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}