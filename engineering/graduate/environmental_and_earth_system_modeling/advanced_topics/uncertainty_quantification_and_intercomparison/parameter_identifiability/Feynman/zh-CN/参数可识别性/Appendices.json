{
    "hands_on_practices": [
        {
            "introduction": "此练习为参数可辨识性分析奠定了基础。通过一个简单的线性模型，我们来探讨结构不可辨识性的核心问题，即即便在理想的无噪声数据条件下，模型参数也无法被唯一确定。这个练习将揭示参数组合（如乘积 $\\theta_1\\theta_2$）如何掩盖单个参数的真实值，并演示如何通过重参数化来解决这一问题。",
            "id": "3904624",
            "problem": "一个环境监测站使用集总线性输入-输出关系来测量径流对降雨的响应。设测量输出为 $y(t)$，已知外源输入为 $u(t)$，其中 $t$ 表示时间。分析师使用的模型是\n$$\ny(t) \\;=\\; \\theta_{1}\\,\\theta_{2}\\,u(t),\n$$\n其中 $\\theta_{1}$ 代表有效径流系数，$\\theta_{2}$ 代表来自仪器的校准增益，两者都假定随时间保持不变。在 $N$ 个不同的时间 $\\{t_{i}\\}_{i=1}^{N}$ 进行测量，记录的数据遵循\n$$\ny_{i} \\;=\\; \\theta_{1}\\,\\theta_{2}\\,u(t_{i}) \\;+\\; \\varepsilon_{i}, \\quad i \\in \\{1,\\dots,N\\},\n$$\n其中 $\\varepsilon_{i}$ 是独立同分布的零均值高斯噪声，方差为 $\\sigma^{2}$。\n\n从参数估计中结构可辨识性的第一性原理出发，并使用以下定义：在理想无噪声条件和已知输入下，如果输入-输出映射相对于某个参数（或参数的函数）是一对一的，则该参数（或参数的函数）是结构可辨识的。请完成以下任务：\n\n- 解释在该模型和输入下，$\\theta_{1}$ 和 $\\theta_{2}$ 是否各自结构可辨识，并使用参数到输出映射的单射性来证明你的结论。\n- 在高斯假设下，使用灵敏度矩阵和费雪信息矩阵（Fisher Information Matrix, FIM）来评估 $(\\theta_{1},\\theta_{2})$ 的信息含量的秩属性，并与标量重参数化进行比较。明确构建灵敏度向量并展示其最终的秩。\n- 提出一种重参数化方案，将模型表示为单个结构可辨识参数 $\\phi$ 的形式，并写出重参数化后的模型。通过证明对于非平凡输入，从 $\\phi$ 到输出的映射是一对一的，来证明为什么 $\\phi$ 是结构可辨识的。\n- 以 $\\theta_{1}$ 和 $\\theta_{2}$ 的闭式表达式明确给出单个可辨识参数 $\\phi$。\n\n你的最终答案必须仅为 $\\phi$ 的闭式表达式。最终答案中不要包含任何单位。除了 $\\phi$ 的单个表达式外，不要提供任何不等式或方程式作为最终答案。",
            "solution": "问题陈述的有效性得到确认。该问题具有科学依据、提法恰当且客观，是系统辨识和参数估计中的一个标准问题。所有必要信息均已提供，问题没有矛盾或含糊之处。\n\n该问题要求分析线性模型 $y(t) = \\theta_{1}\\theta_{2}u(t)$ 中参数的结构可辨识性。结构可辨识性关注的是模型参数是否能从完美的、无噪声的输入-输出数据中唯一确定。\n\n分析将按要求分三个阶段进行：首先，使用单射性的定义评估 $\\theta_{1}$ 和 $\\theta_{2}$ 的个体可辨识性；其次，使用灵敏度矩阵和费雪信息矩阵（FIM）分析信息含量；第三，提出并证明将模型重参数化为单个可辨识参数的方案。\n\n**1. $\\theta_{1}$ 和 $\\theta_{2}$ 的个体结构可辨识性**\n\n结构可辨识性是在理想的无噪声数据条件下评估的，即对所有 $i$ 都有 $\\varepsilon_{i} = 0$。该模型由输入-输出映射 $y(t) = f(\\boldsymbol{\\theta}, u(t))$ 给出，其中参数向量为 $\\boldsymbol{\\theta} = (\\theta_{1}, \\theta_{2})$。如果对于给定的已知非平凡输入 $u(t)$，从参数到输出的映射是一对一的（单射的），则参数是结构可辨识的。\n\n让我们测试单射性。假设我们有两个不同的参数向量 $\\boldsymbol{\\theta} = (\\theta_{1}, \\theta_{2})$ 和 $\\boldsymbol{\\theta}' = (\\theta'_{1}, \\theta'_{2})$。我们检查观察到相同的输出，$y(t, \\boldsymbol{\\theta}) = y(t, \\boldsymbol{\\theta}')$ 对所有 $t$ 成立，是否必然意味着 $\\boldsymbol{\\theta} = \\boldsymbol{\\theta}'$。条件 $y(t, \\boldsymbol{\\theta}) = y(t, \\boldsymbol{\\theta}')$ 可转换为：\n$$\n\\theta_{1}\\theta_{2}u(t) = \\theta'_{1}\\theta'_{2}u(t)\n$$\n对于非平凡输入，存在至少一个时间 $t$ 使得 $u(t) \\neq 0$。在这样的时间点，我们可以除以 $u(t)$ 得到：\n$$\n\\theta_{1}\\theta_{2} = \\theta'_{1}\\theta'_{2}\n$$\n这个方程表明，模型输出仅依赖于参数的乘积 $\\theta_{1}\\theta_{2}$。它不要求 $\\theta_{1} = \\theta'_{1}$ 和 $\\theta_{2} = \\theta'_{2}$。对于任何给定的参数对 $(\\theta_{1}, \\theta_{2})$，可以找到无限多对其他参数 $(\\theta'_{1}, \\theta'_{2})$，它们产生相同的乘积，从而产生相同的模型输出。例如，如果 $\\boldsymbol{\\theta} = (2, 3)$，乘积是 $6$。另一个参数向量 $\\boldsymbol{\\theta}' = (1.5, 4)$ 的乘积也是 $6$。由于 $\\boldsymbol{\\theta} \\neq \\boldsymbol{\\theta}'$ 但 $y(t, \\boldsymbol{\\theta}) = y(t, \\boldsymbol{\\theta}')$，从参数向量 $\\boldsymbol{\\theta}$ 到输出 $y(t)$ 的映射不是单射的。因此，参数 $\\theta_{1}$ 和 $\\theta_{2}$ 不是各自结构可辨识的。只有函数组合 $\\theta_{1}\\theta_{2}$ 是可辨识的。\n\n**2. 灵敏度矩阵和费雪信息矩阵（FIM）分析**\n\n这种不可辨识性也可以通过分析灵敏度矩阵和费雪信息矩阵（FIM）的秩来证明。无噪声输出 $y(t)$ 相对于参数的灵敏度表示输出如何随每个参数的无穷小变化而变化。在时间 $t$，参数向量 $\\boldsymbol{\\theta} = (\\theta_{1}, \\theta_{2})$ 的灵敏度向量是：\n$$\n\\mathbf{s}(t) = \\begin{pmatrix} \\frac{\\partial y(t)}{\\partial \\theta_{1}} & \\frac{\\partial y(t)}{\\partial \\theta_{2}} \\end{pmatrix}\n$$\n计算 $y(t) = \\theta_{1}\\theta_{2}u(t)$ 的偏导数：\n$$\n\\frac{\\partial y(t)}{\\partial \\theta_{1}} = \\theta_{2}u(t)\n$$\n$$\n\\frac{\\partial y(t)}{\\partial \\theta_{2}} = \\theta_{1}u(t)\n$$\n所以，灵敏度向量是 $\\mathbf{s}(t) = \\begin{pmatrix} \\theta_{2}u(t) & \\theta_{1}u(t) \\end{pmatrix}$。\n\n灵敏度矩阵 $\\mathbf{J}$ 是通过将这 $N$ 个测量时间 $\\{t_{i}\\}_{i=1}^{N}$ 的灵敏度向量堆叠而成的：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial y_{1}}{\\partial \\theta_{1}} & \\frac{\\partial y_{1}}{\\partial \\theta_{2}} \\\\ \\vdots & \\vdots \\\\ \\frac{\\partial y_{N}}{\\partial \\theta_{1}} & \\frac{\\partial y_{N}}{\\partial \\theta_{2}} \\end{pmatrix} = \\begin{pmatrix} \\theta_{2}u(t_{1}) & \\theta_{1}u(t_{1}) \\\\ \\vdots & \\vdots \\\\ \\theta_{2}u(t_{N}) & \\theta_{1}u(t_{N}) \\end{pmatrix}\n$$\n$\\mathbf{J}$ 的第一列是向量 $\\theta_{2}\\mathbf{u}$，第二列是 $\\theta_{1}\\mathbf{u}$，其中 $\\mathbf{u} = (u(t_{1}), \\dots, u(t_{N}))^{T}$。假设 $\\theta_{1}$ 和 $\\theta_{2}$ 非零，则第二列是第一列的标量倍数：$(\\text{第 2 列}) = \\frac{\\theta_{1}}{\\theta_{2}} (\\text{第 1 列})$。$\\mathbf{J}$ 的列是线性相关的。因此，只要输入向量 $\\mathbf{u}$ 不是零向量，灵敏度矩阵 $\\mathbf{J}$ 的秩为 $1$。秩 $1$ 小于参数数量（$2$），这表明结构不可辨识。\n\n在独立同分布高斯噪声的假设下，费雪信息矩阵（FIM）由 $\\mathbf{F} = \\frac{1}{\\sigma^{2}}\\mathbf{J}^{T}\\mathbf{J}$ 给出。FIM 是一个 $2 \\times 2$ 矩阵：\n$$\n\\mathbf{F} = \\frac{1}{\\sigma^{2}} \\begin{pmatrix} \\theta_{2}u(t_{1}) & \\dots & \\theta_{2}u(t_{N}) \\\\ \\theta_{1}u(t_{1}) & \\dots & \\theta_{1}u(t_{N}) \\end{pmatrix} \\begin{pmatrix} \\theta_{2}u(t_{1}) & \\theta_{1}u(t_{1}) \\\\ \\vdots & \\vdots \\\\ \\theta_{2}u(t_{N}) & \\theta_{1}u(t_{N}) \\end{pmatrix}\n$$\n$$\n\\mathbf{F} = \\frac{1}{\\sigma^{2}} \\begin{pmatrix} \\sum_{i=1}^{N} (\\theta_{2}u(t_{i}))^{2} & \\sum_{i=1}^{N} (\\theta_{2}u(t_{i}))(\\theta_{1}u(t_{i})) \\\\ \\sum_{i=1}^{N} (\\theta_{1}u(t_{i}))(\\theta_{2}u(t_{i})) & \\sum_{i=1}^{N} (\\theta_{1}u(t_{i}))^{2} \\end{pmatrix}\n$$\n提出参数和输入的求和项：\n$$\n\\mathbf{F} = \\frac{\\sum_{i=1}^{N} u(t_{i})^{2}}{\\sigma^{2}} \\begin{pmatrix} \\theta_{2}^{2} & \\theta_{1}\\theta_{2} \\\\ \\theta_{1}\\theta_{2} & \\theta_{1}^{2} \\end{pmatrix}\n$$\nFIM的秩由其矩阵分量的秩决定。该矩阵的行列式为 $\\det(\\begin{pmatrix} \\theta_{2}^{2} & \\theta_{1}\\theta_{2} \\\\ \\theta_{1}\\theta_{2} & \\theta_{1}^{2} \\end{pmatrix}) = (\\theta_{2}^{2})(\\theta_{1}^{2}) - (\\theta_{1}\\theta_{2})(\\theta_{1}\\theta_{2}) = 0$。行列式为零的矩阵是奇异矩阵。由于FIM不是零矩阵（假设输入非平凡且参数非零），其秩为 $1$。秩亏的FIM证实了参数 $\\theta_1$ 和 $\\theta_2$ 不能被唯一估计。\n\n**3. 重参数化与论证**\n\n上述分析表明，虽然 $\\theta_{1}$ 和 $\\theta_{2}$ 不是各自可辨识的，但它们的乘积是可辨识的。这提示我们可以将模型重参数化，用一个单一的可辨识参数来表示。让我们定义一个新参数 $\\phi$ 作为原始参数的乘积：\n$$\n\\phi = \\theta_{1}\\theta_{2}\n$$\n重参数化后的模型是：\n$$\ny(t) = \\phi u(t)\n$$\n为了证明 $\\phi$ 是结构可辨识的，我们再次诉诸一对一映射的定义。让我们考虑两个不同的参数值 $\\phi$ 和 $\\phi'$。如果它们对于一个给定的非平凡输入 $u(t)$ 产生相同的输出，我们有：\n$$\n\\phi u(t) = \\phi' u(t)\n$$\n对于非平凡输入，存在一个时间 $t$ 使得 $u(t) \\neq 0$。此时，我们可以除以 $u(t)$ 得到：\n$$\n\\phi = \\phi'\n$$\n这表明如果两个参数值产生相同的输出，那么这两个参数值必须相同。从参数 $\\phi$ 到输出 $y(t)$ 的映射是单射的。因此，$\\phi$ 是结构可辨识的。\n\n单个可辨识参数 $\\phi$ 通过重参数化所用的定义，明确地以 $\\theta_{1}$ 和 $\\theta_{2}$ 的闭式表达式给出。",
            "answer": "$$\\boxed{\\theta_{1}\\theta_{2}}$$"
        },
        {
            "introduction": "本练习将可辨识性分析从理论推向实践。即使一个模型在结构上是可辨识的，我们估计其参数的能力也极大地依赖于实验设计。通过对不同采样时间方案下的费雪信息矩阵 (Fisher Information Matrix) 进行数值分析，我们可以量化数据收集策略如何影响参数的不确定性和相关性，从而深入理解实践可辨识性 。",
            "id": "3904602",
            "problem": "考虑一个单输出环境过程的确定性、无噪声均值响应模型，由 $y(t;\\boldsymbol{\\theta}) = \\theta_1 \\exp(-\\theta_2 t)$ 给出，其中 $\\boldsymbol{\\theta} = (\\theta_1,\\theta_2)$ 是未知的无量纲参数，$t$ 是一个无量纲的非负采样时间。假设在采样时间 $t_i$ 的测量值受到零均值、方差为 $\\sigma^2$ 的独立同分布加性高斯噪声的干扰。假定以下基础：在方差为 $\\sigma^2$ 的独立高斯噪声和均值响应 $\\mu_i(\\boldsymbol{\\theta}) = y(t_i;\\boldsymbol{\\theta})$ 的条件下，$\\boldsymbol{\\theta}$ 的费雪信息矩阵 (FIM) 等于对数似然函数的负海森矩阵的期望，这等价于得分函数外积的期望。该矩阵可以通过均值响应关于 $\\boldsymbol{\\theta}$ 的雅可比矩阵计算得出。可辨识性是在一个标称 $\\boldsymbol{\\theta}$ 值处使用 FIM进行局部评估的：在 $\\boldsymbol{\\theta}$ 处的局部结构可辨识性要求 FIM 是满秩的。数值可辨識性和精度可以通过谱条件数以及由克拉默-拉奥下界 (CRLB)（即 FIM 存在时的逆矩阵）导出的参数相关性来进一步评估。\n\n任务：编写一个程序，对于每个指定的采样设计 $\\{t_i\\}$，在标称参数 $\\boldsymbol{\\theta} = (\\theta_1,\\theta_2)$ 和噪声水平 $\\sigma^2$ 下，数值计算以下内容：\n- $2 \\times 2$ 费雪信息矩阵。\n- 使用奇异值分解 (SVD) 及其奇异值阈值 $\\tau = 10^{-10}$ 计算其数值秩。\n- 其谱条件数 $\\kappa_2$，定义为当矩阵满秩时最大奇异值与最小奇异值之比；如果矩阵是奇异的（数值秩小于 $2$），则报告为 $+\\infty$。\n- 一个布尔值 $b_{\\text{ident}}$，用于指示局部可辨识性，定义为 $\\text{rank}(\\text{FIM}) = 2$。\n- 从 CRLB 获得的 $\\theta_1$ 和 $\\theta_2$ 之间的绝对参数相关性，即如果 $\\mathbf{C} = \\text{FIM}^{-1}$ 存在，则 $\\rho = \\left|\\mathbf{C}_{12}\\right|/\\sqrt{\\mathbf{C}_{11}\\mathbf{C}_{22}}$；如果 $\\text{FIM}$ 是奇异的，则报告 $\\rho = \\text{NaN}$。\n\n你的程序必须使用以下固定的标称值和测试套件。所有量均为无量纲。\n- 标称参数：$\\theta_1 = 1.5$, $\\theta_2 = 0.4$。\n- 噪声方差：$\\sigma^2 = 0.01$。\n- 奇异值阈值：$\\tau = 10^{-10}$。\n- 采样时间设计测试套件：\n  1. $\\{t_i\\} = (0, 0, 0, 0, 0)$。\n  2. $\\{t_i\\} = (0, 1, 2, 3, 4, 5)$。\n  3. $\\{t_i\\} = (5, 5, 5, 5)$。\n  4. $\\{t_i\\} = (0, 0.01, 0.02, 0.03, 0.04)$。\n  5. $\\{t_i\\} = (0, 5, 10, 15, 20)$。\n\n数值与格式要求：\n- 使用在指定 $\\boldsymbol{\\theta}$ 和给定采样时间下评估的均值响应关于 $\\boldsymbol{\\theta}$ 的雅可比矩阵来计算 FIM。\n- 使用 SVD 和阈值 $\\tau = 10^{-10}$ 确定数值秩。\n- 如果 FIM 是奇异的，则将谱条件数报告为 $+\\infty$；否则报告其有限值。\n- 如果 FIM 是奇异的，则将绝对相关性报告为 $\\text{NaN}$；否则报告从 FIM 的逆矩阵计算出的有限值。\n- 在打印前，将所有有限浮点数输出（条件数和绝对相关性）四舍五入到 $6$ 位小数。布尔值必须精确地为 True 或 False。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表。每个测试用例贡献一个形式为 $[\\text{rank}, \\kappa_2, b_{\\text{ident}}, \\rho]$ 的列表。例如：$[[2,123.456789,True,0.123456],[\\dots],\\dots]$。如果条件数为无穷大，必须显示为 $inf$。如果相关性未定义，必须显示为 $nan$。\n\n程序必须是自包含的，且不得读取任何输入。它必须计算上述测试套件的结果，并打印所需的单行输出。预期的输出仅为数值和布爾值；不涉及物理单位。",
            "solution": "这个问题是有效的，因为它具有科学依据、自成体系且定义明确。它提出了一个针对常见指数衰减模型的参数估计和可辨識性分析的标准任务。所有必需的数据、常数和定义都已提供，并且没有内部矛盾或含糊之处。\n\n解决方案首先推导必要的数学表达式，然后概述为每个采样设计计算所要求数量的算法。\n\n**1. 模型、参数和雅可比矩阵**\n\n确定性均值响应模型由下式给出：\n$$\ny(t; \\boldsymbol{\\theta}) = \\theta_1 \\exp(-\\theta_2 t)\n$$\n其中参数向量为 $\\boldsymbol{\\theta} = (\\theta_1, \\theta_2)^T$。\n\n参数可辨識性通过检查模型输出 $y$ 对参数 $\\boldsymbol{\\theta}$ 变化的敏感度来评估。这种敏感度由模型响应的雅可比矩阵 $\\mathbf{J}$ 捕获，其元素是模型函数关于每个参数的偏导数，并在每个采样时间 $t_i$进行评估。\n\n偏导数如下：\n$$\n\\frac{\\partial y}{\\partial \\theta_1} = \\exp(-\\theta_2 t)\n$$\n$$\n\\frac{\\partial y}{\\partial \\theta_2} = \\theta_1 \\frac{\\partial}{\\partial \\theta_2}(\\exp(-\\theta_2 t)) = \\theta_1 (\\exp(-\\theta_2 t))(-t) = -t \\theta_1 \\exp(-\\theta_2 t)\n$$\n\n对于一组 $N$ 个采样时间 $\\{t_1, t_2, \\ldots, t_N\\}$，雅可比矩阵是一个 $N \\times 2$ 矩阵，其中第 $i$ 行是响应在时间 $t_i$ 的梯度：\n$$\n\\mathbf{J}(\\boldsymbol{\\theta}) =\n\\begin{pmatrix}\n\\frac{\\partial y(t_1; \\boldsymbol{\\theta})}{\\partial \\theta_1} & \\frac{\\partial y(t_1; \\boldsymbol{\\theta})}{\\partial \\theta_2} \\\\\n\\frac{\\partial y(t_2; \\boldsymbol{\\theta})}{\\partial \\theta_1} & \\frac{\\partial y(t_2; \\boldsymbol{\\theta})}{\\partial \\theta_2} \\\\\n\\vdots & \\vdots \\\\\n\\frac{\\partial y(t_N; \\boldsymbol{\\theta})}{\\partial \\theta_1} & \\frac{\\partial y(t_N; \\boldsymbol{\\theta})}{\\partial \\theta_2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\exp(-\\theta_2 t_1) & -t_1 \\theta_1 \\exp(-\\theta_2 t_1) \\\\\n\\exp(-\\theta_2 t_2) & -t_2 \\theta_1 \\exp(-\\theta_2 t_2) \\\\\n\\vdots & \\vdots \\\\\n\\exp(-\\theta_2 t_N) & -t_N \\theta_1 \\exp(-\\theta_2 t_N)\n\\end{pmatrix}\n$$\n\n**2. 费雪信息矩阵 (FIM)**\n\n对于方差为 $\\sigma^2$ 的独立同分布加性高斯噪声，费雪信息矩阵 (FIM) 由下式给出：\n$$\n\\text{FIM}(\\boldsymbol{\\theta}) = \\frac{1}{\\sigma^2} \\mathbf{J}(\\boldsymbol{\\theta})^T \\mathbf{J}(\\boldsymbol{\\theta})\n$$\nFIM 是一个 $2 \\times 2$ 的对称半正定矩阵。乘积 $\\mathbf{J}^T \\mathbf{J}$ 是：\n$$\n\\mathbf{J}^T \\mathbf{J} = \\begin{pmatrix}\n\\sum_{i=1}^N \\left(\\frac{\\partial y_i}{\\partial \\theta_1}\\right)^2 & \\sum_{i=1}^N \\frac{\\partial y_i}{\\partial \\theta_1}\\frac{\\partial y_i}{\\partial \\theta_2} \\\\\n\\sum_{i=1}^N \\frac{\\partial y_i}{\\partial \\theta_1}\\frac{\\partial y_i}{\\partial \\theta_2} & \\sum_{i=1}^N \\left(\\frac{\\partial y_i}{\\partial \\theta_2}\\right)^2\n\\end{pmatrix}\n$$\n代入偏导数，我们得到 $\\mathbf{J}^T \\mathbf{J}$ 的元素：\n$$\n(\\mathbf{J}^T \\mathbf{J})_{11} = \\sum_{i=1}^N \\exp(-2\\theta_2 t_i)\n$$\n$$\n(\\mathbf{J}^T \\mathbf{J})_{12} = (\\mathbf{J}^T \\mathbf{J})_{21} = \\sum_{i=1}^N (\\exp(-\\theta_2 t_i))(-t_i \\theta_1 \\exp(-\\theta_2 t_i)) = -\\theta_1 \\sum_{i=1}^N t_i \\exp(-2\\theta_2 t_i)\n$$\n$$\n(\\mathbf{J}^T \\mathbf{J})_{22} = \\sum_{i=1}^N (-t_i \\theta_1 \\exp(-\\theta_2 t_i))^2 = \\theta_1^2 \\sum_{i=1}^N t_i^2 \\exp(-2\\theta_2 t_i)\n$$\n\n**3. 可辨识性分析**\n\n在标称参数值 $\\boldsymbol{\\theta} = (1.5, 0.4)$ 和噪声方差 $\\sigma^2 = 0.01$ 下评估 FIM 的属性，可以对可辨识性进行全面评估。\n\n*   **局部结构可辨識性与秩**：参数 $\\theta_1$ 和 $\\theta_2$ 是局部结构可辨識的，当且仅当 FIM 是非奇异的，即它具有满秩。对于这个 $2 \\times 2$ 矩阵，满秩为 $\\text{rank}(\\text{FIM}) = 2$。秩小于 $2$ 意味着雅可比矩阵的列是线性相关的，这意味着一个参数的变化可以被另一个参数的变化完全抵消，使得它们从数据中无法区分。如果 $\\text{rank}(\\text{FIM}) = 2$，布尔值 $b_{\\text{ident}}$ 为 `True`，否则为 `False`。数值秩通过计算 FIM 大于小阈值 $\\tau = 10^{-10}$ 的奇异值数量来确定。\n\n*   **数值可辨識性与条件数**：谱条件数 $\\kappa_2$ 衡量线性系统解对数据扰动的敏感性。对于 FIM 而言，大的条件数表示矩阵接近奇异，参数估计问题是病态的。它定义为最大奇异值与最小奇异值之比 ($s_{max}/s_{min}$)。如果 FIM 被确定为奇异的 ($s_{min} \\le \\tau$)，则条件数被视为无穷大。\n\n*   **参数相关性与克拉默-拉奥下界**：如果 FIM 可逆，其逆矩阵 $\\mathbf{C} = \\text{FIM}^{-1}$ 就是克拉默-拉奥下界 (CRLB) 矩阵。该矩阵为 $\\boldsymbol{\\theta}$ 的任何无偏估计量的方差提供了一个下界。对角元素 $\\mathbf{C}_{11}$ 和 $\\mathbf{C}_{22}$ 分别是 $\\theta_1$ 和 $\\theta_2$ 估计值的最小可能方差。非对角元素 $\\mathbf{C}_{12}$ 代表估计值之间的协方差。绝对参数相关性 $\\rho$ 计算如下：\n    $$\n    \\rho = \\frac{|\\mathbf{C}_{12}|}{\\sqrt{\\mathbf{C}_{11}\\mathbf{C}_{22}}}\n    $$\n    接近 $1$ 的 $\\rho$ 值表示参数估计值之间存在高度相关性，使得独立估计它们变得困难。如果 FIM 是奇异的，则其逆矩阵不存在，相关性未定义（报告为 NaN）。\n\n**4. 算法实现**\n\n对于每个采样时间测试用例 $\\{t_i\\}$：\n1.  定义标称参数 $\\theta_1 = 1.5$、$\\theta_2 = 0.4$ 和噪声方差 $\\sigma^2 = 0.01$。\n2.  通过在每个 $t_i$ 处评估其列来构建 $N \\times 2$ 的雅可比矩阵 $\\mathbf{J}$。\n3.  使用 $\\text{FIM} = (\\mathbf{J}^T \\mathbf{J}) / \\sigma^2$ 计算 FIM。\n4.  对 FIM 执行奇异值分解 (SVD) 以获得其奇异值 $s_1 \\ge s_2$。\n5.  将数值秩确定为大于 $\\tau = 10^{-10}$ 的奇异值数量。\n6.  如果秩为 $2$，则将 $b_{\\text{ident}}$ 设置为 `True`，否则设置为 `False`。\n7.  如果 $b_{\\text{ident}}$ 为 `True`：\n    a. 计算条件数 $\\kappa_2 = s_1 / s_2$。\n    b. 对 FIM求逆以得到 CRLB 矩阵 $\\mathbf{C} = \\text{FIM}^{-1}$。\n    c. 计算绝对相关性 $\\rho = |\\mathbf{C}_{0,1}| / \\sqrt{\\mathbf{C}_{0,0} \\mathbf{C}_{1,1}}$（使用 0-基索引）。\n8.  如果 $b_{\\text{ident}}$ 为 `False`：\n    a. 将 $\\kappa_2$ 设置为无穷大。\n    b. 将 $\\rho$ 设置为 NaN。\n9.  存储当前测试用例的结果四元组 $[\\text{rank}, \\kappa_2, b_{\\text{ident}}, \\rho]$。\n10. 处理完所有测试用例后，将收集的结果格式化为指定的字符串格式，将浮点数四舍五入到 6 位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes identifiability metrics for an exponential decay model\n    for a suite of sampling time designs.\n    \"\"\"\n    # Fixed nominal values and constants\n    THETA_NOM = (1.5, 0.4)    # (theta1, theta2)\n    SIGMA2 = 0.01             # Noise variance\n    TAU = 1e-10               # Singular value threshold for rank\n\n    # Test suite of sampling time designs\n    test_cases = [\n        (0, 0, 0, 0, 0),\n        (0, 1, 2, 3, 4, 5),\n        (5, 5, 5, 5),\n        (0, 0.01, 0.02, 0.03, 0.04),\n        (0, 5, 10, 15, 20),\n    ]\n\n    # List to store formatted string results for each case\n    results_str_list = []\n\n    for t_samples in test_cases:\n        t = np.array(t_samples, dtype=float)\n        theta1, theta2 = THETA_NOM\n\n        # 1. Construct the Jacobian matrix J\n        # Column 1: partial derivative with respect to theta1\n        j_col1 = np.exp(-theta2 * t)\n        # Column 2: partial derivative with respect to theta2\n        j_col2 = -t * theta1 * np.exp(-theta2 * t)\n\n        J = np.stack((j_col1, j_col2), axis=-1)\n\n        # 2. Compute the Fisher Information Matrix (FIM)\n        FIM = (1 / SIGMA2) * (J.T @ J)\n\n        # 3. Perform SVD to get singular values\n        # svd returns sorted singular values by default\n        try:\n            singular_values = np.linalg.svd(FIM, compute_uv=False)\n        except np.linalg.LinAlgError:\n            singular_values = np.array([0.0, 0.0]) # Should not happen for J^T J\n\n        s_max = singular_values[0] if len(singular_values) > 0 else 0.0\n        s_min = singular_values[-1] if len(singular_values) > 1 else 0.0\n\n        # 4. Compute rank, identifiability, condition number, and correlation\n        rank = np.sum(singular_values > TAU)\n        b_ident = (rank == 2)\n\n        if b_ident:\n            kappa = s_max / s_min\n            # Compute CRLB = FIM inverse\n            try:\n                CRLB = np.linalg.inv(FIM)\n                c11, c22 = CRLB[0, 0], CRLB[1, 1]\n                c12 = CRLB[0, 1]\n                \n                # Handle potential floating point issues where c11 or c22 are non-positive\n                if c11 <= 0 or c22 <= 0:\n                    rho = np.nan\n                else:\n                    rho = np.abs(c12) / np.sqrt(c11 * c22)\n\n            except np.linalg.LinAlgError:\n                # Should not be reached if b_ident is True, but for robustness\n                kappa = np.inf\n                rho = np.nan\n                b_ident = False\n                rank = np.sum(singular_values > TAU) # re-calculate rank based on SVD\n        else:\n            kappa = np.inf\n            rho = np.nan\n\n        # 5. Format the results for the current test case\n        formatted_res = []\n        formatted_res.append(str(rank))\n\n        if kappa == np.inf:\n            formatted_res.append(\"inf\")\n        else:\n            formatted_res.append(f\"{kappa:.6f}\")\n\n        formatted_res.append(str(b_ident))\n        \n        if np.isnan(rho):\n            formatted_res.append(\"nan\")\n        else:\n            formatted_res.append(f\"{rho:.6f}\")\n        \n        results_str_list.append(f\"[{','.join(formatted_res)}]\")\n\n    # 6. Final print statement in the exact required format\n    final_output = f\"[{','.join(results_str_list)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "此高级练习旨在解决复杂系统建模中常见的“粗疏模型”(sloppy model) 挑战。我们运用费雪信息矩阵的特征分析这一强大技术，来区分参数空间中被数据良好约束的“刚性”方向和约束较差的“粗疏”方向。通过这项练习，您将掌握一种系统性的模型降维方法，从而专注于估计那些能够被数据有效揭示的参数组合 。",
            "id": "3904551",
            "problem": "考虑一个在环境与地球系统建模中用于解释大气二氧化碳时间序列的线性化单箱碳循环模型。该箱代表大气碳储量，其通量由三个未知参数参数化：光合吸收敏感性 $a$、异养呼吸速率系数 $b$ 和侧向输出系数 $c$。在标称轨迹附近的小扰动下，模型预测的观测向量 $\\mathbf{y} \\in \\mathbb{R}^{n}$ 可以在参数向量 $\\boldsymbol{\\theta} = (a, b, c)$ 周围通过一阶泰勒展开近似为 $\\mathbf{y}(\\boldsymbol{\\theta}) \\approx \\mathbf{y}(\\boldsymbol{\\theta}_{0}) + \\mathbf{S}(\\boldsymbol{\\theta} - \\boldsymbol{\\theta}_{0})$，其中 $\\mathbf{S} \\in \\mathbb{R}^{n \\times 3}$ 是灵敏度矩阵，其第$i$列包含模型输出对第$i$个参数的偏导数。假设每个分量上都存在方差为 $\\sigma^{2}$ 的附加独立高斯观测噪声。在此设定下，与高斯误差下的参数 $\\boldsymbol{\\theta}$ 相关联的费雪信息矩阵 (FIM) $\\mathbf{F}$ 由 $\\mathbf{F} = \\sigma^{-2} \\mathbf{S}^{\\top} \\mathbf{S}$ 给出。\n\n一次数据同化实验为有序参数向量 $(a, b, c)$ 产生了如下的对称半正定费雪信息矩阵：\n$$\n\\mathbf{F} = \n\\begin{pmatrix}\n100 & 95 & 0 \\\\\n95 & 100 & 0 \\\\\n0 & 0 & 0.01\n\\end{pmatrix}.\n$$\n假设噪声方差为 $\\sigma^{2} = 1$，因此上述矩阵已经被 $\\sigma^{-2}$ 缩放。根据曲率准则定义一个可识别性阈值：仅保留那些其对应FIM特征值至少为 $\\tau = 10$ 的参数方向。利用基于似然的推断和特征分析的基本原理，通过投影到FIM的可识别子空间上来确定一个约简参数集。具体来说，计算与阈值 $\\tau$ 所指示的可识别方向相关联的 $(a, b, c)$ 的单位范数线性组合向量。将您的最终答案表示为一个乘以 $(a, b, c)$ 的系数行向量，精确书写，无需四舍五入。此向量无需物理单位。最终答案必须是单一的解析表达式。",
            "solution": "我们从环境与地球系统建模中高斯观测误差下的参数估计的标准假设开始。模型在标称参数向量 $\\boldsymbol{\\theta}_{0}$ 周围进行线性化，使得观测向量 $\\mathbf{y}(\\boldsymbol{\\theta})$ 通过灵敏度矩阵 $\\mathbf{S}$ 近似地线性依赖于 $\\boldsymbol{\\theta}$。在方差为 $\\sigma^{2}$ 的独立高斯误差下，$\\boldsymbol{\\theta}$ 的对数似然函数（不计加法常数）为\n$$\n\\mathcal{L}(\\boldsymbol{\\theta}) = -\\frac{1}{2 \\sigma^{2}} \\|\\mathbf{y}_{\\text{obs}} - \\mathbf{y}(\\boldsymbol{\\theta})\\|^{2},\n$$\n并且在 $\\boldsymbol{\\theta}_{0}$ 处的负对数似然函数的曲率由费雪信息矩阵决定，对于线性化模型，该矩阵为\n$$\n\\mathbf{F} = \\sigma^{-2} \\mathbf{S}^{\\top} \\mathbf{S}.\n$$\n费雪信息矩阵 $\\mathbf{F}$ 是对称半正定的。其特征值和特征向量编码了局部可识别性：大特征值对应于参数空间中对数似然函数具有高曲率的方向（刚性方向），而小特征值对应于具有低曲率的方向（松弛方向）。在实践中，可以使用一个阈值 $\\tau$ 来区分可识别和不可识别的方向：保留其特征值满足 $\\lambda \\ge \\tau$ 的特征向量。\n\n我们已知\n$$\n\\mathbf{F} =\n\\begin{pmatrix}\n100 & 95 & 0 \\\\\n95 & 100 & 0 \\\\\n0 & 0 & 0.01\n\\end{pmatrix},\n$$\n其中 $\\sigma^{2} = 1$，因此不需要进一步的缩放。为了进行特征分析，注意到 $\\mathbf{F}$ 对于第三个参数 $c$ 是块对角矩阵；左上角的 $2 \\times 2$ 块耦合了 $a$ 和 $b$，而第三个参数 $c$ 是解耦的，其对角线元素是一个小值 $0.01$。\n\n首先，分析这个 $2 \\times 2$ 的块：\n$$\n\\mathbf{B} = \n\\begin{pmatrix}\n100 & 95 \\\\\n95 & 100\n\\end{pmatrix}.\n$$\n$\\mathbf{B}$ 的特征值通过求解下式获得\n$$\n\\det(\\mathbf{B} - \\lambda \\mathbf{I}) = 0,\n$$\n这得到\n$$\n\\det\\!\\begin{pmatrix}\n100 - \\lambda & 95 \\\\\n95 & 100 - \\lambda\n\\end{pmatrix}\n= (100 - \\lambda)^{2} - 95^{2} = 0.\n$$\n因此，\n$$\n(100 - \\lambda)^{2} = 95^{2} \\quad \\Rightarrow \\quad 100 - \\lambda = \\pm 95,\n$$\n得到\n$$\n\\lambda_{1} = 100 + 95 = 195, \\quad \\lambda_{2} = 100 - 95 = 5.\n$$\n$\\mathbf{B}$ 对应的特征向量可以如下求得。对于 $\\lambda_{1} = 195$，\n$$\n(\\mathbf{B} - 195 \\mathbf{I}) \\mathbf{v} = \\mathbf{0} \\quad \\Rightarrow \\quad\n\\begin{pmatrix}\n-95 & 95 \\\\\n95 & -95\n\\end{pmatrix}\n\\begin{pmatrix}\nv_{a} \\\\\nv_{b}\n\\end{pmatrix}\n= \n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}.\n$$\n这得到 $-95 v_{a} + 95 v_{b} = 0$，所以 $v_{a} = v_{b}$。一个代表性的特征向量是 $(1, 1)$；在 $(a, b)$ 子空间中对应的单位范数向量是 $(1/\\sqrt{2}, 1/\\sqrt{2})$。\n\n对于 $\\lambda_{2} = 5$，\n$$\n(\\mathbf{B} - 5 \\mathbf{I}) \\mathbf{v} = \\mathbf{0} \\quad \\Rightarrow \\quad\n\\begin{pmatrix}\n95 & 95 \\\\\n95 & 95\n\\end{pmatrix}\n\\begin{pmatrix}\nv_{a} \\\\\nv_{b}\n\\end{pmatrix}\n= \n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}.\n$$\n这得到 $95 v_{a} + 95 v_{b} = 0$，所以 $v_{a} = -v_{b}$。一个代表性的特征向量是 $(1, -1)$；在 $(a, b)$ 子空间中对应的单位范数向量是 $(1/\\sqrt{2}, -1/\\sqrt{2})$。\n\n完整的 $3 \\times 3$ 矩阵 $\\mathbf{F}$ 在此基础上增加了第三个参数 $c$。由于涉及 $c$ 的非对角线项为 $0$，因此可以通过在前两个特征向量的 $c$ 分量上附加 $0$ 并使用 $c$ 的标准基向量，将特征值和特征向量扩展到三维。因此，$\\mathbf{F}$ 的特征值为\n$$\n\\lambda_{1} = 195, \\quad \\lambda_{2} = 5, \\quad \\lambda_{3} = 0.01,\n$$\n其相关的单位范数特征向量为\n$$\n\\mathbf{v}_{1} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{v}_{2} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{v}_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n\n应用可识别性阈值 $\\tau = 10$。我们评估每个特征值：\n- $\\lambda_{1} = 195 \\ge 10$：由 $\\mathbf{v}_{1}$ 张成的方向是可识别的（刚性）。\n- $\\lambda_{2} = 5  10$：由 $\\mathbf{v}_{2}$ 张成的方向是松弛的，不予保留。\n- $\\lambda_{3} = 0.01  10$：由 $\\mathbf{v}_{3}$ 张成的方向是松弛的，不予保留。\n\n因此，可识别子空间是一维的，由 $\\mathbf{v}_{1}$ 张成。通过将 $(a, b, c)$ 投影到这个可识别方向上，可以得到一个约简参数集，即一个单一的可识别参数线性组合。所要求的输出是与保留方向相关联的 $(a, b, c)$ 的单位范数线性组合向量，表示为系数的行向量。即\n$$\n\\begin{pmatrix} \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\end{pmatrix}.\n$$\n\n选择的理由如下。在高斯误差下，费雪信息矩阵编码了参数空间中负对数似然函数的局部曲率。大于阈值 $\\tau$ 的特征值表示相对于噪声具有足够高曲率的方向，这意味着参数具有有限精度下的可估计性，并受到数据的有意义约束。在这里，只有沿着 $\\mathbf{v}_{1}$ 的 $a$ 和 $b$ 的对称组合是可识别的，而 $a$ 和 $b$ 的反对称组合以及参数 $c$ 是松弛的，这与一个松弛参数化模型一致，其中许多方向受到很差的约束。约简参数集保留了唯一的刚性组合，通过移除不可识别的方向来提高鲁棒性。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0\\end{pmatrix}}$$"
        }
    ]
}