{
    "hands_on_practices": [
        {
            "introduction": "在模型比较研究中，将多个模型的输出融合成一个单一、更优的预测是一项核心任务。简单地对所有模型取平均值是一种常见做法，但这忽略了不同模型可能具有不同的误差特性和相互关联。本练习将引导你通过最小化均方误差来推导并计算最优的集合权重，这是一种基于模型误差协方差来提升预测技巧的基本方法。",
            "id": "3895017",
            "problem": "在一项多模式集合（MME）的模式比对研究中，有 $3$ 个独立的模拟中心为同一个地球物理量 $Y$（例如，全球平均地表温度异常）提供了年平均预测值 $\\{Y_{k}\\}_{k=1}^{3}$。假设每个模型对 $Y$ 都是独立无偏的，即模式误差 $e_{k} \\equiv Y_{k}-Y$ 对每个 $k$ 都满足 $\\mathbb{E}[e_{k}] = 0$。设模式误差向量为 $e \\equiv (e_{1},e_{2},e_{3})^{\\top}$，其协方差矩阵 $\\Sigma \\equiv \\mathbb{C}\\mathrm{ov}(e)$ 可从一个长的、准稳态的验证数据集中得知。需要构造一个带有权重 $w \\equiv (w_{1},w_{2},w_{3})^{\\top}$ 的线性集合估计量 $\\hat{Y} \\equiv \\sum_{k=1}^{3} w_{k} Y_{k}$，使其在约束条件 $\\sum_{k=1}^{3} w_{k} = 1$ 下，最小化期望平方误差 $\\mathbb{E}\\!\\left[\\left(\\sum_{k=1}^{3} w_{k} Y_{k} - Y\\right)^{2}\\right]$。\n\n请仅从期望、方差和协方差的定义出发，并使用多元微积分中的拉格朗日乘子法，推导出约束极小值点 $w$ 的符号形式。然后，对于科学上合理的误差协方差矩阵\n$$\n\\Sigma \\;=\\;\n\\begin{pmatrix}\n4  1  1 \\\\\n1  3  0 \\\\\n1  0  2\n\\end{pmatrix},\n$$\n计算精确的集合权重 $w$。最终的权重向量需用精确有理数表示。无需四舍五入。权重是无量纲的。",
            "solution": "用户希望通过在归一化约束下最小化期望平方误差，来找到线性集合估计量的最优权重。\n\n### 步骤 1：问题验证\n根据指定标准分析问题陈述。\n\n**提取的已知条件：**\n- 关于真实量 $Y$ 的一组 $3$ 个模式预测值 $\\{Y_k\\}_{k=1}^3$。\n- 模式误差定义：$e_k \\equiv Y_k - Y$。\n- 无偏模式假设：对于 $k \\in \\{1, 2, 3\\}$，$\\mathbb{E}[e_k] = 0$。\n- 误差向量：$e = (e_1, e_2, e_3)^\\top$。\n- 误差协方差矩阵：$\\Sigma \\equiv \\mathbb{C}\\mathrm{ov}(e)$。\n- 线性集合估计量：$\\hat{Y} \\equiv \\sum_{k=1}^3 w_k Y_k$。\n- 权重向量：$w = (w_1, w_2, w_3)^\\top$。\n- 要最小化的目标函数：$J(w) = \\mathbb{E}[(\\hat{Y} - Y)^2]$。\n- 约束条件：$\\sum_{k=1}^3 w_k = 1$。\n- 具体的协方差矩阵：\n$$\n\\Sigma =\n\\begin{pmatrix}\n4  1  1 \\\\\n1  3  0 \\\\\n1  0  2\n\\end{pmatrix}\n$$\n- 任务是首先使用拉格朗日乘子法推导最优权重 $w$ 的符号表达式，然后为给定的 $\\Sigma$ 计算其精确数值。\n\n**使用提取的已知条件进行验证：**\n1.  **科学依据：** 该问题是统计预报和数据同化中的一个标准、基本的任务，尤其是在气候科学和气象学中。对加权集合最小化均方误差（MSE）是提高预报技巧的一种公认方法。给定的协方差矩阵 $\\Sigma$ 是对称的。要成为一个有效的协方差矩阵，它还必须是半正定的。我们使用西尔维斯特准则 (Sylvester's criterion) 对顺序主子式进行正定性检验：\n    - $\\det(M_1) = 4 > 0$。\n    - $\\det(M_2) = \\det\\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} = (4)(3) - (1)(1) = 11 > 0$。\n    - $\\det(M_3) = \\det(\\Sigma) = 4(3 \\cdot 2 - 0 \\cdot 0) - 1(1 \\cdot 2 - 0 \\cdot 1) + 1(1 \\cdot 0 - 3 \\cdot 1) = 24 - 2 - 3 = 19 > 0$。\n    由于所有顺序主子式都为正，矩阵 $\\Sigma$ 是正定的，这是非退化随机变量协方差矩阵的一个有效属性。该问题在科学上是合理的。\n2.  **适定性：** 该问题是适定的。它涉及在线性约束下最小化一个凸二次函数（$w^\\top \\Sigma w$，其中 $\\Sigma$ 是正定的）。这种结构保证了唯一最小值的存在。\n3.  **目标：** 问题使用精确、无歧义的数学语言陈述。\n4.  **完整性和一致性：** 问题提供了所有必要信息（目标函数、约束、定义、具体矩阵），并且不包含内部矛盾。\n\n**结论：** 问题有效。\n\n### 步骤 2：最优权重的符号推导\n\n首先，我们将目标函数，即期望平方误差 $J(w)$，用权重向量 $w$ 和协方差矩阵 $\\Sigma$ 来表示。\n集合估计量的误差是 $\\hat{Y} - Y$。\n$$\n\\hat{Y} - Y = \\sum_{k=1}^{3} w_k Y_k - Y\n$$\n使用约束条件 $\\sum_{k=1}^{3} w_k = 1$，我们可以将 $Y$ 写为 $Y \\left(\\sum_{k=1}^{3} w_k\\right) = \\sum_{k=1}^{3} w_k Y$。\n将此代入集合误差的表达式中：\n$$\n\\hat{Y} - Y = \\sum_{k=1}^{3} w_k Y_k - \\sum_{k=1}^{3} w_k Y = \\sum_{k=1}^{3} w_k (Y_k - Y) = \\sum_{k=1}^{3} w_k e_k\n$$\n用向量表示法，这可以写成 $w^\\top e$，其中 $w = (w_1, w_2, w_3)^\\top$，$e = (e_1, e_2, e_3)^\\top$。\n\n要最小化的目标函数是期望平方误差，由于期望误差为零，它也就是集合误差的方差：\n$$\nJ(w) = \\mathbb{E}[(\\hat{Y} - Y)^2] = \\mathbb{E}[(w^\\top e)^2]\n$$\n由于 $w^\\top e$ 是一个标量，它的平方是 $(w^\\top e)(w^\\top e) = (w^\\top e)(e^\\top w) = w^\\top e e^\\top w$。\n权重 $w$ 是确定性的，所以我们可以将它们移到期望符号的外面：\n$$\nJ(w) = w^\\top \\mathbb{E}[e e^\\top] w\n$$\n误差向量 $e$ 的协方差矩阵定义为 $\\Sigma = \\mathbb{C}\\mathrm{ov}(e) = \\mathbb{E}[(e - \\mathbb{E}[e])(e - \\mathbb{E}[e])^\\top]$。鉴于模型是无偏的，对所有 $k$ 都有 $\\mathbb{E}[e_k] = 0$，这意味着 $\\mathbb{E}[e] = \\mathbf{0}$。因此，协方差矩阵简化为 $\\Sigma = \\mathbb{E}[e e^\\top]$。\n因此，目标函数是关于 $w$ 的二次型：\n$$\nJ(w) = w^\\top \\Sigma w\n$$\n我们需要在约束条件 $\\sum_{k=1}^3 w_k = 1$ 下最小化 $J(w)$。用向量形式表示，约束条件是 $\\mathbf{1}^\\top w = 1$，其中 $\\mathbf{1}$ 是一个全为1的列向量，$\\mathbf{1} = (1, 1, 1)^\\top$。\n\n我们使用拉格朗日乘子法。拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(w, \\lambda) = J(w) - \\lambda (\\mathbf{1}^\\top w - 1) = w^\\top \\Sigma w - \\lambda (\\mathbf{1}^\\top w - 1)\n$$\n为了找到最小值，我们将 $\\mathcal{L}$ 对 $w$ 的梯度设为零：\n$$\n\\nabla_w \\mathcal{L} = \\nabla_w (w^\\top \\Sigma w) - \\nabla_w (\\lambda \\mathbf{1}^\\top w) = \\mathbf{0}\n$$\n使用标准的矩阵微积分恒等式，并注意到 $\\Sigma$ 是对称的，有 $\\nabla_w (w^\\top \\Sigma w) = 2 \\Sigma w$。导数 $\\nabla_w (\\lambda \\mathbf{1}^\\top w) = \\lambda \\mathbf{1}$。\n该条件变为：\n$$\n2 \\Sigma w - \\lambda \\mathbf{1} = \\mathbf{0} \\quad \\implies \\quad \\Sigma w = \\frac{\\lambda}{2} \\mathbf{1}\n$$\n由于 $\\Sigma$ 是正定的，它是可逆的。我们可以解出 $w$：\n$$\nw = \\frac{\\lambda}{2} \\Sigma^{-1} \\mathbf{1}\n$$\n为了求出拉格朗日乘子 $\\lambda$，我们应用约束条件 $\\mathbf{1}^\\top w = 1$：\n$$\n\\mathbf{1}^\\top \\left( \\frac{\\lambda}{2} \\Sigma^{-1} \\mathbf{1} \\right) = 1 \\quad \\implies \\quad \\frac{\\lambda}{2} (\\mathbf{1}^\\top \\Sigma^{-1} \\mathbf{1}) = 1\n$$\n解出项 $\\frac{\\lambda}{2}$：\n$$\n\\frac{\\lambda}{2} = \\frac{1}{\\mathbf{1}^\\top \\Sigma^{-1} \\mathbf{1}}\n$$\n将此代回 $w$ 的表达式，得到最优权重的符号解：\n$$\nw = \\frac{\\Sigma^{-1} \\mathbf{1}}{\\mathbf{1}^\\top \\Sigma^{-1} \\mathbf{1}}\n$$\n\n### 步骤 3：对给定的协方差矩阵进行数值计算\n\n我们得到给定的协方差矩阵：\n$$\n\\Sigma =\n\\begin{pmatrix}\n4  1  1 \\\\\n1  3  0 \\\\\n1  0  2\n\\end{pmatrix}\n$$\n首先，我们计算 $\\Sigma$ 的逆矩阵。在验证步骤中已算出其行列式为 $\\det(\\Sigma) = 19$。逆矩阵为 $\\Sigma^{-1} = \\frac{1}{\\det(\\Sigma)} \\text{adj}(\\Sigma)$。伴随矩阵 $\\text{adj}(\\Sigma)$ 是代数余子式矩阵的转置。\n\n代数余子式为：\n$C_{11} = (3)(2) - (0)(0) = 6$\n$C_{12} = -((1)(2) - (0)(1)) = -2$\n$C_{13} = (1)(0) - (3)(1) = -3$\n$C_{21} = -((1)(2) - (1)(0)) = -2$\n$C_{22} = (4)(2) - (1)(1) = 7$\n$C_{23} = -((4)(0) - (1)(1)) = 1$\n$C_{31} = (1)(0) - (1)(3) = -3$\n$C_{32} = -((4)(0) - (1)(1)) = 1$\n$C_{33} = (4)(3) - (1)(1) = 11$\n\n代数余子式矩阵是 $\\text{C} = \\begin{pmatrix} 6  -2  -3 \\\\ -2  7  1 \\\\ -3  1  11 \\end{pmatrix}$。由于 $\\Sigma$ 是对称的，其代数余子式矩阵也是对称的，所以 $\\text{adj}(\\Sigma) = C^\\top = C$。\n逆矩阵为：\n$$\n\\Sigma^{-1} = \\frac{1}{19}\n\\begin{pmatrix}\n6  -2  -3 \\\\\n-2  7  1 \\\\\n-3  1  11\n\\end{pmatrix}\n$$\n接下来，我们计算权重公式的分子 $\\Sigma^{-1} \\mathbf{1}$：\n$$\n\\Sigma^{-1} \\mathbf{1} = \\frac{1}{19}\n\\begin{pmatrix}\n6  -2  -3 \\\\\n-2  7  1 \\\\\n-3  1  11\n\\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n= \\frac{1}{19}\n\\begin{pmatrix}\n6 - 2 - 3 \\\\\n-2 + 7 + 1 \\\\\n-3 + 1 + 11\n\\end{pmatrix}\n= \\frac{1}{19}\n\\begin{pmatrix}\n1 \\\\\n6 \\\\\n9\n\\end{pmatrix}\n$$\n接着，我们计算分母 $\\mathbf{1}^\\top \\Sigma^{-1} \\mathbf{1}$。这是我们刚刚计算出的向量的各分量之和：\n$$\n\\mathbf{1}^\\top \\Sigma^{-1} \\mathbf{1} = \\frac{1}{19} (1 + 6 + 9) = \\frac{16}{19}\n$$\n最后，我们计算权重向量 $w$：\n$$\nw = \\frac{\\Sigma^{-1} \\mathbf{1}}{\\mathbf{1}^\\top \\Sigma^{-1} \\mathbf{1}} = \\frac{\\frac{1}{19} \\begin{pmatrix} 1 \\\\ 6 \\\\ 9 \\end{pmatrix}}{\\frac{16}{19}} = \\frac{1}{16} \\begin{pmatrix} 1 \\\\ 6 \\\\ 9 \\end{pmatrix}\n$$\n所以各个权重为：\n$$\nw_1 = \\frac{1}{16}\n$$\n$$\nw_2 = \\frac{6}{16} = \\frac{3}{8}\n$$\n$$\nw_3 = \\frac{9}{16}\n$$\n最终的权重向量是 $w = (1/16, 3/8, 9/16)^\\top$。我们可以验证权重之和为 $1$：$\\frac{1}{16} + \\frac{6}{16} + \\frac{9}{16} = \\frac{16}{16} = 1$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{16}  \\frac{3}{8}  \\frac{9}{16} \\end{pmatrix}}$$"
        },
        {
            "introduction": "一个多模型集合的价值并不仅仅取决于其包含的模型数量。由于模型间可能共享代码、物理参数化方案或开发历史，它们的误差往往是相关的，这导致了信息冗余。本练习介绍“有效样本量” ($N_{\\text{eff}}$) 的概念，它通过量化模型间的相关性，为我们提供了一个比名义模型数量更真实的集合信息含量的度量。",
            "id": "3895076",
            "problem": "考虑耦合模式比较计划 (CMIP) 中的一个多模式集合，该集合由 $N=6$ 个气候模式组成，这些模式根据共享的动力核心和参数化选择被分为两个结构族，每族包含 $3$ 个模式。令 $X_i$ 表示模式 $i$ 的标准化年平均近地表温度异常，其中标准化确保对所有 $i$ 都有 $\\operatorname{Var}(X_i)=1$。假设存在以下具有科学动机的因子结构：对于族 $A$ 中的模式，\n$$\nX_i = \\sqrt{0.3}\\,C + \\sqrt{0.5}\\,G_A + \\sqrt{0.2}\\,\\varepsilon_i,\n$$\n对于族 $B$ 中的模式，\n$$\nX_j = \\sqrt{0.3}\\,C + \\sqrt{0.5}\\,G_B + \\sqrt{0.2}\\,\\varepsilon_j,\n$$\n其中 $C$、$G_A$、$G_B$ 和所有 $\\varepsilon_i$ 相互独立，各自具有零均值和单位方差，并且族 $A$ 和族 $B$ 是不相交的索引集，每个集合的大小为 $3$。该构造意味着跨模式的相关矩阵 $\\boldsymbol{R}=\\{\\rho_{ij}\\}$ 为，\n$$\n\\boldsymbol{R} = \\begin{pmatrix}\n1  0.8  0.8  0.3  0.3  0.3 \\\\\n0.8  1  0.8  0.3  0.3  0.3 \\\\\n0.8  0.8  1  0.3  0.3  0.3 \\\\\n0.3  0.3  0.3  1  0.8  0.8 \\\\\n0.3  0.3  0.3  0.8  1  0.8 \\\\\n0.3  0.3  0.3  0.8  0.8  1\n\\end{pmatrix}.\n$$\n从第一性原理出发——即根据协方差和相关性定义相关随机变量均值的方差——将有效样本量 $N_{\\text{eff}}$ 定义为满足以下条件的唯一数值：相关情况下集合均值的方差等于 $N_{\\text{eff}}$ 个独立的、单位方差的抽样均值的方差。推导 $N_{\\text{eff}}$ 关于 $\\{\\rho_{ij}\\}$ 和 $N$ 的闭式解析表达式，然后计算给定 $\\boldsymbol{R}$ 的 $N_{\\text{eff}}$。将您的最终数值答案四舍五入到四位有效数字。报告一个无量纲数。在您的推理中，在模式比较研究和集合平均的背景下，解释 $N_{\\text{eff}}$ 相对于实际集合大小 $N$ 的值。",
            "solution": "首先验证问题，以确保其具有科学依据、提法恰当且完整。\n\n### 步骤1：提取给定条件\n- 集合大小：$N=6$。\n- 族数量：$2$。\n- 每族的大小（族 $A$ 和族 $B$）：$3$。\n- 模式输出变量：$X_i$，标准化后其方差为 $\\operatorname{Var}(X_i)=1$。\n- 族 $A$ 的因子模型 ($i \\in A$)：$X_i = \\sqrt{0.3}\\,C + \\sqrt{0.5}\\,G_A + \\sqrt{0.2}\\,\\varepsilon_i$。\n- 族 $B$ 的因子模型 ($j \\in B$)：$X_j = \\sqrt{0.3}\\,C + \\sqrt{0.5}\\,G_B + \\sqrt{0.2}\\,\\varepsilon_j$。\n- 潜在因子 $C, G_A, G_B, \\varepsilon_k$ 相互独立，具有零均值和单位方差。\n- 给定的相关矩阵 $\\boldsymbol{R}=\\{\\rho_{ij}\\}$ 为：\n$$\n\\boldsymbol{R} = \\begin{pmatrix}\n1  0.8  0.8  0.3  0.3  0.3 \\\\\n0.8  1  0.8  0.3  0.3  0.3 \\\\\n0.8  0.8  1  0.3  0.3  0.3 \\\\\n0.3  0.3  0.3  1  0.8  0.8 \\\\\n0.3  0.3  0.3  0.8  1  0.8 \\\\\n0.3  0.3  0.3  0.8  0.8  1\n\\end{pmatrix}\n$$\n- 有效样本量 $N_{\\text{eff}}$ 的定义：$N$ 个相关变量的集合均值的方差等同于 $N_{\\text{eff}}$ 个假设的独立、单位方差变量的均值的方差。\n\n### 步骤2：使用提取的给定条件进行验证\n该问题具有科学依据，使用标准因子模型来表示多模式集合中的依赖关系，这是气候科学中的常见做法。有效样本量的概念是处理相关数据的一个公认的统计工具。该问题提法恰当，提供了清晰的定义和所有必要的数据。验证了所提供因子模型和相关矩阵的数学一致性。对于同在族 $A$ 中的 $i \\neq j$，$\\rho_{ij} = \\operatorname{Cov}(X_i, X_j) = (\\sqrt{0.3})^2 \\operatorname{Var}(C) + (\\sqrt{0.5})^2 \\operatorname{Var}(G_A) = 0.3 + 0.5 = 0.8$。对于 $i \\in A$ 和 $j \\in B$，$\\rho_{ij} = \\operatorname{Cov}(X_i, X_j) = (\\sqrt{0.3})^2 \\operatorname{Var}(C) = 0.3$。方差为 $\\operatorname{Var}(X_i) = (\\sqrt{0.3})^2 + (\\sqrt{0.5})^2 + (\\sqrt{0.2})^2 = 0.3 + 0.5 + 0.2 = 1.0$。所有值都一致。\n\n### 步骤3：结论和行动\n问题有效。将提供完整解答。\n\n### 有效样本量公式的推导\n令 $\\bar{X}$ 为 $N$ 个模式输出 $X_i$ 的集合均值：\n$$\n\\bar{X} = \\frac{1}{N} \\sum_{i=1}^{N} X_i\n$$\n集合均值的方差 $\\operatorname{Var}(\\bar{X})$ 由下式给出：\n$$\n\\operatorname{Var}(\\bar{X}) = \\operatorname{Var}\\left(\\frac{1}{N} \\sum_{i=1}^{N} X_i\\right) = \\frac{1}{N^2} \\operatorname{Var}\\left(\\sum_{i=1}^{N} X_i\\right)\n$$\n随机变量之和的方差是其协方差矩阵中所有元素的总和：\n$$\n\\operatorname{Var}\\left(\\sum_{i=1}^{N} X_i\\right) = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\operatorname{Cov}(X_i, X_j)\n$$\n由于每个 $X_i$ 都被标准化为单位方差，所以 $\\operatorname{Var}(X_i) = 1$。协方差通过 $\\operatorname{Cov}(X_i, X_j) = \\rho_{ij} \\sqrt{\\operatorname{Var}(X_i)\\operatorname{Var}(X_j)}$ 与相关性 $\\rho_{ij}$ 相关。在单位方差下，我们有 $\\operatorname{Cov}(X_i, X_j) = \\rho_{ij}$。\n将此代入均值方差的表达式中：\n$$\n\\operatorname{Var}(\\bar{X}) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\rho_{ij}\n$$\n问题通过将此方差等同于 $N_{\\text{eff}}$ 个独立的、单位方差的抽样均值的方差来定义有效样本量 $N_{\\text{eff}}$。对于一个大小为 $N_{\\text{eff}}$ 的独立同分布变量 $Y_k$ 的样本，其中 $\\operatorname{Var}(Y_k)=1$，其均值 $\\bar{Y}$ 的方差为 $\\operatorname{Var}(\\bar{Y}) = \\frac{1}{N_{\\text{eff}}}$。\n将两个均值方差的表达式相等：\n$$\n\\frac{1}{N_{\\text{eff}}} = \\frac{1}{N^2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\rho_{ij}\n$$\n求解 $N_{\\text{eff}}$ 得到通用的闭式表达式：\n$$\nN_{\\text{eff}} = \\frac{N^2}{\\sum_{i=1}^{N} \\sum_{j=1}^{N} \\rho_{ij}}\n$$\n该表达式将有效样本量与名义样本量 $N$ 以及相关矩阵 $\\boldsymbol{R}$ 中所有元素的总和联系起来。\n\n### 对给定集合的计算\n给定 $N=6$ 和相关矩阵 $\\boldsymbol{R}$。第一步是计算其所有元素的总和，$\\sum_{i=1}^{6} \\sum_{j=1}^{6} \\rho_{ij}$。\n该矩阵具有分块结构。我们来计算每个分块中元素的总和。\n对应于族 $A$ 的左上角 $3 \\times 3$ 分块有 $3$ 个对角元素等于 $1$，以及 $3 \\times 2 = 6$ 个非对角元素等于 $0.8$。其元素的总和是：\n$$\n\\text{Sum}_A = 3 \\times 1 + 6 \\times 0.8 = 3 + 4.8 = 7.8\n$$\n族 $B$ 的右下角 $3 \\times 3$ 分块在结构和总和上是相同的：\n$$\n\\text{Sum}_B = 3 \\times 1 + 6 \\times 0.8 = 3 + 4.8 = 7.8\n$$\n右上角的 $3 \\times 3$ 非对角分块表示族 $A$ 和族 $B$ 之间的相关性。所有 $3 \\times 3 = 9$ 个元素都等于 $0.3$。其元素的总和是：\n$$\n\\text{Sum}_{AB} = 9 \\times 0.3 = 2.7\n$$\n左下角分块是其转置，具有相同的总和：\n$$\n\\text{Sum}_{BA} = 9 \\times 0.3 = 2.7\n$$\n$\\boldsymbol{R}$ 中所有元素的总和是这四个分块总和的和：\n$$\n\\sum_{i=1}^{6} \\sum_{j=1}^{6} \\rho_{ij} = \\text{Sum}_A + \\text{Sum}_B + \\text{Sum}_{AB} + \\text{Sum}_{BA} = 7.8 + 7.8 + 2.7 + 2.7 = 15.6 + 5.4 = 21.0\n$$\n现在我们可以使用推导出的公式和 $N=6$ 来计算 $N_{\\text{eff}}$：\n$$\nN_{\\text{eff}} = \\frac{N^2}{\\sum_{i,j} \\rho_{ij}} = \\frac{6^2}{21.0} = \\frac{36}{21} = \\frac{12}{7}\n$$\n为了获得四舍五入到四位有效数字的数值：\n$$\nN_{\\text{eff}} = \\frac{12}{7} \\approx 1.7142857... \\approx 1.714\n$$\n\n### 解释\n模式集合的实际大小是 $N=6$。计算出的有效样本量是 $N_{\\text{eff}} \\approx 1.714$。$N_{\\text{eff}}  N$ 这一事实是模式输出之间存在正相关的直接结果。其解释是，在降低集合均值方差方面，这个由 $6$ 个相关模式组成的集合所提供的信息量，与一个由大约 $1.714$ 个独立模式组成的、规模小得多的假设集合相同。\n从 $6$ 大幅减少到 $1.714$ 突显了集合内部的强冗余性，这是由高族内相关性 ($\\rho=0.8$) 和非零的族间相关性 ($\\rho=0.3$) 驱动的。在像 CMIP 这样的模式比较研究背景下，这一结果表明，如果模式不是独立的，仅仅增加集合中模式的数量并不会线性增加对集合均值的置信度。共享的开发历史、代码和物理参数化导致了相关的误差和偏差，而有效样本量的概念正是对这种相关性进行量化。它强调了对于稳健的集合预报和不确定性量化而言，模式多样性比仅仅增加模式数量更为重要。",
            "answer": "$$\n\\boxed{1.714}\n$$"
        },
        {
            "introduction": "模型预测的不确定性源于多个方面，包括模型结构差异、参数选择和内部变率。为了深入理解和改进模型，区分这些不确定性的来源至关重要。本练习将应用嵌套方差分析 (ANOVA) 框架，这是一个强大的统计工具，能够将总预测方差定量地分解为归因于不同来源（如结构、参数）的独立分量。",
            "id": "3895089",
            "problem": "在一项关于年平均近地表气温偏差的模型比对研究中，每个结构模型（具有不同的动力核心和物理套件）都与多个校准参数集配对，并且每个参数集都在多个初始条件下作为集合运行。令 $Y_{ijk}$ 表示来自结构（模型）$i \\in \\{1,\\dots,a\\}$、嵌套在结构 $i$ 中的参数集 $j \\in \\{1,\\dots,b\\}$ 以及集合成员 $k \\in \\{1,\\dots,r\\}$ 的偏差（单位：开尔文）。假设采用分层线性混合效应模型\n$$\nY_{ijk} \\;=\\; \\mu \\;+\\; S_{i} \\;+\\; P_{j(i)} \\;+\\; \\varepsilon_{k(ij)},\n$$\n其中随机效应 $S_{i} \\sim \\mathcal{N}(0,\\sigma_{\\text{struct}}^{2})$、$P_{j(i)} \\sim \\mathcal{N}(0,\\sigma_{\\text{param}}^{2})$ 和 $\\varepsilon_{k(ij)} \\sim \\mathcal{N}(0,\\sigma_{\\varepsilon}^{2})$ 是相互独立的。该设计是平衡的，有 $a$ 个结构，每个结构有 $b$ 个参数集，每个参数集有 $r$ 个集合成员。方差分析（ANOVA）分解是嵌套的：首先是结构，然后是结构内的参数，最后是残差（跨初始条件的内部变率）。\n\n仅从模型定义、随机效应的可加性和独立性，以及平衡嵌套设计的方差分析（ANOVA）平方和与均方的定义出发，推导各层级均方的期望表达式，并使用矩估计法获得 $\\sigma_{\\text{struct}}^{2}$ 和 $\\sigma_{\\text{param}}^{2}$ 关于观测均方的无偏估计量。\n\n然后，对于一个具有 $a=4$，$b=3$ 和 $r=5$ 的平衡试验，观测到的ANOVA平方和如下：\n- 结构间平方和 $SS_{\\text{struct}} = 67.5$（平方开尔文, $\\text{K}^2$），\n- 结构内参数间平方和 $SS_{\\text{param}(\\text{struct})} = 36.0$（$\\text{K}^2$），\n- 残差（参数集内）平方和 $SS_{\\varepsilon} = 96.0$（$\\text{K}^2$）。\n\n使用你推导的表达式计算无偏估计值 $\\hat{\\sigma}_{\\text{struct}}^{2}$ 和 $\\hat{\\sigma}_{\\text{param}}^{2}$。将每个估计值四舍五入到三位有效数字。以平方开尔文（$\\text{K}^2$）表示你的最终估计值。以有序对 $(\\hat{\\sigma}_{\\text{struct}}^{2}, \\hat{\\sigma}_{\\text{param}}^{2})$ 的形式报告你的最终答案。",
            "solution": "该问题是有效的，因为它在科学上基于标准的统计理论（线性混合效应模型和方差分析），问题提法恰当，有足够的信息得到唯一解，并且用客观、正式的语言表述。\n\n该问题需要一个两部分的解答：首先，在嵌套随机效应模型中推导方差分量的无偏估计量；其次，将这些估计量应用于给定的数据集。\n\n**第1部分：估计量的推导**\n\n指定的分层线性混合效应模型为：\n$$\nY_{ijk} \\;=\\; \\mu \\;+\\; S_{i} \\;+\\; P_{j(i)} \\;+\\; \\varepsilon_{k(ij)}\n$$\n适用于结构 $i \\in \\{1,\\dots,a\\}$，嵌套在结构 $i$ 中的参数集 $j \\in \\{1,\\dots,b\\}$，以及集合成员 $k \\in \\{1,\\dots,r\\}$。各项为：\n- $\\mu$：一个固定的总均值。\n- $S_{i}$：结构 $i$ 的随机效应，其中 $S_{i} \\sim \\mathcal{N}(0, \\sigma_{\\text{struct}}^{2})$。\n- $P_{j(i)}$：结构 $i$ 内参数集 $j$ 的随机效应，其中 $P_{j(i)} \\sim \\mathcal{N}(0, \\sigma_{\\text{param}}^{2})$。\n- $\\varepsilon_{k(ij)}$：结构 $i$ 内参数集 $j$ 的成员 $k$ 的随机残差，其中 $\\varepsilon_{k(ij)} \\sim \\mathcal{N}(0, \\sigma_{\\varepsilon}^{2})$。\n所有随机效应都假定为相互独立。该设计是平衡的。\n\n我们定义不同聚合水平上的均值：\n- 结构 $i$ 内参数集 $j$ 的均值：$\\bar{Y}_{ij\\bullet} = \\frac{1}{r} \\sum_{k=1}^{r} Y_{ijk}$\n- 结构 $i$ 的均值：$\\bar{Y}_{i\\bullet\\bullet} = \\frac{1}{b} \\sum_{j=1}^{b} \\bar{Y}_{ij\\bullet} = \\frac{1}{br} \\sum_{j=1}^{b} \\sum_{k=1}^{r} Y_{ijk}$\n- 总均值：$\\bar{Y}_{\\bullet\\bullet\\bullet} = \\frac{1}{a} \\sum_{i=1}^{a} \\bar{Y}_{i\\bullet\\bullet} = \\frac{1}{abr} \\sum_{i=1}^{a} \\sum_{j=1}^{b} \\sum_{k=1}^{r} Y_{ijk}$\n\n平衡嵌套方差分析的平方和（SS）为：\n- 结构间：$SS_{\\text{struct}} = br \\sum_{i=1}^{a} (\\bar{Y}_{i\\bullet\\bullet} - \\bar{Y}_{\\bullet\\bullet\\bullet})^2$\n- 结构内参数间：$SS_{\\text{param}(\\text{struct})} = r \\sum_{i=1}^{a} \\sum_{j=1}^{b} (\\bar{Y}_{ij\\bullet} - \\bar{Y}_{i\\bullet\\bullet})^2$\n- 残差（参数集内）：$SS_{\\varepsilon} = \\sum_{i=1}^{a} \\sum_{j=1}^{b} \\sum_{k=1}^{r} (Y_{ijk} - \\bar{Y}_{ij\\bullet})^2$\n\n相应的自由度（df）为：\n- $df_{\\text{struct}} = a - 1$\n- $df_{\\text{param}(\\text{struct})} = a(b - 1)$\n- $df_{\\varepsilon} = ab(r - 1)$\n\n均方（MS）是平方和除以其自由度：\n- $MS_{\\text{struct}} = \\frac{SS_{\\text{struct}}}{a - 1}$\n- $MS_{\\text{param}(\\text{struct})} = \\frac{SS_{\\text{param}(\\text{struct})}}{a(b - 1)}$\n- $MS_{\\varepsilon} = \\frac{SS_{\\varepsilon}}{ab(r - 1)}$\n\n为求得矩估计法的估计量，我们首先推导每个均方的期望（EMS）。我们使用以下性质：对于任何均值为 $\\mu_X$、方差为 $\\sigma_X^2$ 的随机变量 $X$，有 $E[X^2] = \\text{Var}(X) + (E[X])^2 = \\sigma_X^2 + \\mu_X^2$。由于我们所有的随机效应均值为0，所以 $E[S_i^2] = \\sigma_{\\text{struct}}^2$，$E[P_{j(i)}^2] = \\sigma_{\\text{param}}^2$，以及 $E[\\varepsilon_{k(ij)}^2] = \\sigma_{\\varepsilon}^2$。\n\n**1. $MS_{\\varepsilon}$ 的期望**\n$$\nE[MS_{\\varepsilon}] = E\\left[\\frac{SS_{\\varepsilon}}{ab(r - 1)}\\right] = \\frac{1}{ab(r - 1)} E\\left[\\sum_{i,j,k} (Y_{ijk} - \\bar{Y}_{ij\\bullet})^2\\right]\n$$\n将模型代入各项：\n$Y_{ijk} - \\bar{Y}_{ij\\bullet} = (\\mu + S_i + P_{j(i)} + \\varepsilon_{k(ij)}) - (\\mu + S_i + P_{j(i)} + \\bar{\\varepsilon}_{ij\\bullet}) = \\varepsilon_{k(ij)} - \\bar{\\varepsilon}_{ij\\bullet}$。\n对于固定的 $(i,j)$，和 $\\sum_{k=1}^{r} (\\varepsilon_{k(ij)} - \\bar{\\varepsilon}_{ij\\bullet})^2$ 是 $\\varepsilon_{k(ij)}$ 样本方差的 $(r-1)$ 倍。样本方差的期望是总体方差 $\\sigma_{\\varepsilon}^2$。\n$$\nE\\left[\\sum_{k=1}^{r} (\\varepsilon_{k(ij)} - \\bar{\\varepsilon}_{ij\\bullet})^2\\right] = (r-1)\\sigma_{\\varepsilon}^2\n$$\n对所有 $i$ 和 $j$ 求和：\n$$\nE[SS_{\\varepsilon}] = \\sum_{i=1}^{a} \\sum_{j=1}^{b} (r-1)\\sigma_{\\varepsilon}^2 = ab(r-1)\\sigma_{\\varepsilon}^2\n$$\n因此，\n$$\nE[MS_{\\varepsilon}] = \\frac{ab(r-1)\\sigma_{\\varepsilon}^2}{ab(r-1)} = \\sigma_{\\varepsilon}^2\n$$\n\n**2. $MS_{\\text{param}(\\text{struct})}$ 的期望**\n$$\nE[MS_{\\text{param}(\\text{struct})}] = \\frac{1}{a(b-1)} E\\left[r \\sum_{i,j} (\\bar{Y}_{ij\\bullet} - \\bar{Y}_{i\\bullet\\bullet})^2\\right]\n$$\n均值之差为：\n$\\bar{Y}_{ij\\bullet} - \\bar{Y}_{i\\bullet\\bullet} = (P_{j(i)} - \\bar{P}_{i\\bullet}) + (\\bar{\\varepsilon}_{ij\\bullet} - \\bar{\\varepsilon}_{i\\bullet\\bullet})$，其中 $\\bar{P}_{i\\bullet} = \\frac{1}{b}\\sum_j P_{j(i)}$，而 $\\bar{\\varepsilon}_{ij\\bullet}, \\bar{\\varepsilon}_{i\\bullet\\bullet}$ 是相应的误差均值。由于独立性，交叉乘积的期望为0。\n$$\nE[(\\bar{Y}_{ij\\bullet} - \\bar{Y}_{i\\bullet\\bullet})^2] = E[(P_{j(i)} - \\bar{P}_{i\\bullet})^2] + E[(\\bar{\\varepsilon}_{ij\\bullet} - \\bar{\\varepsilon}_{i\\bullet\\bullet})^2]\n$$\n和 $\\sum_{j=1}^{b} (P_{j(i)} - \\bar{P}_{i\\bullet})^2$ 的期望为 $(b-1)\\sigma_{\\text{param}}^2$。\n和 $\\sum_{j=1}^{b} (\\bar{\\varepsilon}_{ij\\bullet} - \\bar{\\varepsilon}_{i\\bullet\\bullet})^2$ 的期望为 $(b-1)\\text{Var}(\\bar{\\varepsilon}_{ij\\bullet}) = (b-1)\\frac{\\sigma_{\\varepsilon}^2}{r}$。\n对 $i$ 求和：\n$$\nE\\left[SS_{\\text{param}(\\text{struct})}\\right] = r \\sum_{i=1}^{a} \\left( (b-1)\\sigma_{\\text{param}}^2 + (b-1)\\frac{\\sigma_{\\varepsilon}^2}{r} \\right) = a(b-1)(r\\sigma_{\\text{param}}^2 + \\sigma_{\\varepsilon}^2)\n$$\n因此，\n$$\nE[MS_{\\text{param}(\\text{struct})}] = \\frac{a(b-1)(r\\sigma_{\\text{param}}^2 + \\sigma_{\\varepsilon}^2)}{a(b-1)} = r\\sigma_{\\text{param}}^2 + \\sigma_{\\varepsilon}^2\n$$\n\n**3. $MS_{\\text{struct}}$ 的期望**\n$$\nE[MS_{\\text{struct}}] = \\frac{1}{a-1} E\\left[br \\sum_{i} (\\bar{Y}_{i\\bullet\\bullet} - \\bar{Y}_{\\bullet\\bullet\\bullet})^2\\right]\n$$\n均值之差为：\n$\\bar{Y}_{i\\bullet\\bullet} - \\bar{Y}_{\\bullet\\bullet\\bullet} = (S_i - \\bar{S}_{\\bullet}) + (\\bar{P}_{i\\bullet} - \\bar{P}_{\\bullet\\bullet}) + (\\bar{\\varepsilon}_{i\\bullet\\bullet} - \\bar{\\varepsilon}_{\\bullet\\bullet\\bullet})$。\n再次利用独立性，平方和的期望是各项平方的期望之和。\n和 $\\sum_{i=1}^{a} (S_i - \\bar{S}_{\\bullet})^2$ 的期望为 $(a-1)\\sigma_{\\text{struct}}^2$。\n和 $\\sum_{i=1}^{a} (\\bar{P}_{i\\bullet} - \\bar{P}_{\\bullet\\bullet})^2$ 的期望为 $(a-1)\\text{Var}(\\bar{P}_{i\\bullet}) = (a-1)\\frac{\\sigma_{\\text{param}}^2}{b}$。\n和 $\\sum_{i=1}^{a} (\\bar{\\varepsilon}_{i\\bullet\\bullet} - \\bar{\\varepsilon}_{\\bullet\\bullet\\bullet})^2$ 的期望为 $(a-1)\\text{Var}(\\bar{\\varepsilon}_{i\\bullet\\bullet}) = (a-1)\\frac{\\sigma_{\\varepsilon}^2}{br}$。\n所以，\n$$\nE[SS_{\\text{struct}}] = br \\left( (a-1)\\sigma_{\\text{struct}}^2 + (a-1)\\frac{\\sigma_{\\text{param}}^2}{b} + (a-1)\\frac{\\sigma_{\\varepsilon}^2}{br} \\right) = (a-1)(br\\sigma_{\\text{struct}}^2 + r\\sigma_{\\text{param}}^2 + \\sigma_{\\varepsilon}^2)\n$$\n因此，\n$$\nE[MS_{\\text{struct}}] = br\\sigma_{\\text{struct}}^2 + r\\sigma_{\\text{param}}^2 + \\sigma_{\\varepsilon}^2\n$$\n\n**矩估计法估计量**\n我们将观测到的均方与其期望相等：\n1) $MS_{\\text{struct}} = br\\hat{\\sigma}_{\\text{struct}}^2 + r\\hat{\\sigma}_{\\text{param}}^2 + \\hat{\\sigma}_{\\varepsilon}^2$\n2) $MS_{\\text{param}(\\text{struct})} = r\\hat{\\sigma}_{\\text{param}}^2 + \\hat{\\sigma}_{\\varepsilon}^2$\n3) $MS_{\\varepsilon} = \\hat{\\sigma}_{\\varepsilon}^2$\n\n通过回代法求解此方程组：\n由(3)可知，$\\sigma_{\\varepsilon}^2$ 的估计量为 $\\hat{\\sigma}_{\\varepsilon}^2 = MS_{\\varepsilon}$。\n代入(2)求 $\\hat{\\sigma}_{\\text{param}}^2$：\n$$\nMS_{\\text{param}(\\text{struct})} = r\\hat{\\sigma}_{\\text{param}}^2 + MS_{\\varepsilon} \\implies \\hat{\\sigma}_{\\text{param}}^2 = \\frac{MS_{\\text{param}(\\text{struct})} - MS_{\\varepsilon}}{r}\n$$\n将(2)代入(1)求 $\\hat{\\sigma}_{\\text{struct}}^2$：\n$$\nMS_{\\text{struct}} = br\\hat{\\sigma}_{\\text{struct}}^2 + MS_{\\text{param}(\\text{struct})} \\implies \\hat{\\sigma}_{\\text{struct}}^2 = \\frac{MS_{\\text{struct}} - MS_{\\text{param}(\\text{struct})}}{br}\n$$\n这些就是方差分量的无偏估计量。\n\n**第2部分：数值计算**\n\n对于一个平衡试验，我们有以下给定值：\n- 结构数量：$a=4$\n- 每个结构的参数集数量：$b=3$\n- 每个参数集的集合成员数量：$r=5$\n- 结构间平方和：$SS_{\\text{struct}} = 67.5 \\, \\text{K}^2$\n- 结构内参数间平方和：$SS_{\\text{param}(\\text{struct})} = 36.0 \\, \\text{K}^2$\n- 残差平方和：$SS_{\\varepsilon} = 96.0 \\, \\text{K}^2$\n\n首先，计算自由度：\n- $df_{\\text{struct}} = a - 1 = 4 - 1 = 3$\n- $df_{\\text{param}(\\text{struct})} = a(b - 1) = 4(3 - 1) = 8$\n- $df_{\\varepsilon} = ab(r - 1) = 4 \\times 3 \\times (5 - 1) = 12 \\times 4 = 48$\n\n接下来，计算观测到的均方：\n- $MS_{\\text{struct}} = \\frac{SS_{\\text{struct}}}{df_{\\text{struct}}} = \\frac{67.5}{3} = 22.5 \\, \\text{K}^2$\n- $MS_{\\text{param}(\\text{struct})} = \\frac{SS_{\\text{param}(\\text{struct})}}{df_{\\text{param}(\\text{struct})}} = \\frac{36.0}{8} = 4.5 \\, \\text{K}^2$\n- $MS_{\\varepsilon} = \\frac{SS_{\\varepsilon}}{df_{\\varepsilon}} = \\frac{96.0}{48} = 2.0 \\, \\text{K}^2$\n\n现在，使用推导出的估计量公式计算方差分量：\n- 对于 $\\sigma_{\\text{struct}}^{2}$：\n$$\n\\hat{\\sigma}_{\\text{struct}}^{2} = \\frac{MS_{\\text{struct}} - MS_{\\text{param}(\\text{struct})}}{br} = \\frac{22.5 - 4.5}{3 \\times 5} = \\frac{18.0}{15} = 1.2 \\, \\text{K}^2\n$$\n- 对于 $\\sigma_{\\text{param}}^{2}$：\n$$\n\\hat{\\sigma}_{\\text{param}}^{2} = \\frac{MS_{\\text{param}(\\text{struct})} - MS_{\\varepsilon}}{r} = \\frac{4.5 - 2.0}{5} = \\frac{2.5}{5} = 0.5 \\, \\text{K}^2\n$$\n问题要求将每个估计值四舍五入到三位有效数字。\n- $\\hat{\\sigma}_{\\text{struct}}^{2} = 1.2$ 变为 $1.20$。\n- $\\hat{\\sigma}_{\\text{param}}^{2} = 0.5$ 变为 $0.500$。\n\n最终答案为有序对 $(\\hat{\\sigma}_{\\text{struct}}^{2}, \\hat{\\sigma}_{\\text{param}}^{2})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.20  0.500\n\\end{pmatrix}\n}\n$$"
        }
    ]
}