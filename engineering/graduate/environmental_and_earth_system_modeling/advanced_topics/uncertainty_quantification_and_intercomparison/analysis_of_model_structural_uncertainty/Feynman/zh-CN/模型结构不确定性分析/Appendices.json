{
    "hands_on_practices": [
        {
            "introduction": "一个能完美拟合观测数据的模型未必是一个好模型。本练习探讨了“统计充分性”（模型的残差满足统计假设）与“机理充分性”（模型遵循基本物理原理，如质量守恒）之间的关键区别。通过一个假设但现实的水文情景 ，您将学会超越统计性能，从结构完整性的角度批判性地评估模型，这是环境建模中的一项基本技能。",
            "id": "3862495",
            "problem": "一位环境水文学家正在为一个源头汇水区评估一个简约的日降雨-径流模型。该模型根据 $Q_t = \\theta P_t + \\phi Q_{t-1}$ 将降水映射为径流，并具有最少的状态，其中 $Q_t$ 是第 $t$ 天的径流，$P_t$ 是第 $t$ 天的降水，$\\theta, \\phi$ 是使用 $t=1,\\dots,N$ 的训练期数据通过普通最小二乘法率定的恒定参数。对训练期内残差 $r_t = Q_t^{\\text{obs}} - Q_t^{\\text{mod}}$ 的诊断报告显示，$E[r_t] \\approx 0$ 且对于 $k \\ge 1$ 有 $\\operatorname{Cov}(r_t,r_{t-k}) \\approx 0$，$r_t$ 的经验分布与一个轻尾、对称的分布一致。在一个独立的为期 $5$ 天的暴雨序列中，获得了以下汇总测量值和预测值：$\\sum_{t=1}^{5} P_t = 120 \\ \\text{mm}$，$\\sum_{t=1}^{5} \\text{ET}_t = 10 \\ \\text{mm}$，以及 $\\sum_{t=1}^{5} Q_t^{\\text{mod}} = 130 \\ \\text{mm}$，其中 $\\text{ET}_t$ 是第 $t$ 天的蒸散发。独立的土壤湿度观测表明，汇水区最初是干燥的，蓄水量可忽略不计，$S_0 \\approx 0 \\ \\text{mm}$，事件后增加到 $S_5 \\approx 10 \\ \\text{mm}$。假设在这 $5$ 天内侧向地下水交换可忽略不计，且通量和蓄量为非负值。\n\n使用汇水区尺度的控制体水均衡基本原理，结合模型适切性的标准定义，评估该模型的适切性。选择最能正确区分机理适切性与统计适切性，并根据观测结果对模型提出最科学合理批判的选项。\n\nA. 机理适切性要求与守恒定律及物理上可接受的状态和通量约束保持一致；统计适切性要求关于扰动和残差的概率假设不与数据相矛盾。因为 $\\sum_{t=1}^{5} Q_t^{\\text{mod}} > \\sum_{t=1}^{5} P_t - \\sum_{t=1}^{5} \\text{ET}_t + (S_5 - S_0)$，该模型违反了水均衡，因此不具有机理适切性，尽管残差诊断表明其具有统计适切性。一种补救方法是引入一个显式的蓄水状态 $S_t$ 和受非负性及质量守恒约束的通量参数化，而不是仅仅依赖于 $\\theta, \\phi$。\n\nB. 当拟合指标良好且残差呈现白噪声时，统计适切性即意味着机理适切性；因此，考虑到采样窗口较小，观测到的质量不均衡是可以接受的。最合适的补救方法是在率定过程中增加洪峰流量的权重，以进一步减小残差平方和。\n\nC. 机理适切性主要关乎回归中的参数显著性；由于 $\\theta$ 和 $\\phi$ 显著不为零，该模型具有机理适切性。明显的质量不均衡差异可能是采样噪声，可以在不进行结构性修改的情况下忽略。\n\nD. 机理适切性指的是参数估计值在不同数据集间的不变性；由于 $\\theta$ 可以被约束为小于1，向下缩放降水量（偏差校正）将在不引入蓄水状态的情况下恢复水均衡，同时保持简约性。\n\nE. 通过使用自回归移动平均(ARMA)过程对残差进行建模来吸收质量不均衡差异，可以满足机理适切性；在径流方程中增加一个ARMA(1,1)扰动项，可以消除对显式守恒约束的需求，从而纠正结构性问题。",
            "solution": "在尝试求解之前，对问题陈述的有效性进行评估。\n\n**步骤1：提取已知条件**\n- 模型方程：$Q_t = \\theta P_t + \\phi Q_{t-1}$，其中 $Q_t$ 是径流，$P_t$ 是降水，$\\theta, \\phi$ 是恒定参数。\n- 率定方法：在训练期 $t=1, \\dots, N$ 上使用普通最小二乘法(OLS)。\n- 残差定义：$r_t = Q_t^{\\text{obs}} - Q_t^{\\text{mod}}$。\n- 训练期的残差诊断：\n    - 残差均值：$E[r_t] \\approx 0$。\n    - 残差协方差：对于 $k \\ge 1$，有 $\\operatorname{Cov}(r_t, r_{t-k}) \\approx 0$。\n    - 残差分布：对称且轻尾。\n- 来自一个独立的为期 $5$ 天的暴雨序列的数据：\n    - 总降水量：$\\sum_{t=1}^{5} P_t = 120 \\ \\text{mm}$。\n    - 总蒸散发量：$\\sum_{t=1}^{5} \\text{ET}_t = 10 \\ \\text{mm}$。\n    - 总模拟径流量：$\\sum_{t=1}^{5} Q_t^{\\text{mod}} = 130 \\ \\text{mm}$。\n- 针对这 $5$ 天的独立蓄水观测：\n    - 初始蓄水量：$S_0 \\approx 0 \\ \\text{mm}$。\n    - 最终蓄水量：$S_5 \\approx 10 \\ \\text{mm}$。\n- 假设：\n    - 侧向地下水交换可忽略不计。\n    - 通量和蓄量为非负。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 问题基于水文建模的既定原则，特别是降雨-径流过程和质量守恒（水均衡）。模型形式是标准的线性时间序列模型（ARX类型），统计适切性和机理适切性的概念是环境建模领域的核心。\n- **良态性：** 问题提供了足够、一致的信息来进行水均衡计算，并将其与模型输出进行比较。问题要求进行批判性评估，所给数据足以满足此要求。\n- **客观性：** 问题陈述使用了精确、客观的术语和定量数据。没有主观或基于观点的陈述。\n- **完整性与一致性：** 进行第一性原理分析（水均衡）所需的所有数据均已提供。设置中没有内部矛盾。\n- **其他缺陷：** 该问题并非不切实际、病态、微不足道或无法验证。它提出了一个经典且重要的场景，即一个统计上拟合良好的模型在物理基础上失败了。\n\n**步骤3：结论与行动**\n问题陈述是**有效的**。它在科学上是合理的，定义明确且内部一致。我将继续进行求解。\n\n**从第一性原理推导**\n\n评估的核心在于区分两种类型的模型适切性：\n\n1.  **统计适切性**：评估模型关于随机部分（残差或误差）的假设是否得到数据的支持。问题指出，对于残差 $r_t = Q_t^{\\text{obs}} - Q_t^{\\text{mod}}$，诊断显示 $E[r_t] \\approx 0$ 且对于 $k \\ge 1$ 有 $\\operatorname{Cov}(r_t, r_{t-k}) \\approx 0$。这表明残差近似为一个零均值、不相关的序列（即“白噪声”）。关于对称、轻尾分布的附加信息进一步支持了普通最小二乘回归中通常做出的假设。因此，根据所提供的信息，该模型似乎是**统计上适切的**。\n\n2.  **机理（或物理）适切性**：评估模型是否遵守基本物理定律，如质量守恒，以及其他物理约束（例如，蓄水量或径流等量的非负性）。这里要考虑的主要定律是质量守恒，将其应用于汇水区这个控制体，时间范围为 $5$ 天。\n\n水均衡方程为：\n$$ \\text{输入} - \\text{输出} = \\text{蓄水量变化} $$\n在这 $5$ 天内，总降水量为 $\\sum P_t$，总径流量为 $\\sum Q_t$，总蒸散发量为 $\\sum \\text{ET}_t$。净地下水流被假定为可忽略不计。蓄水量的变化为 $\\Delta S = S_5 - S_0$。方程变为：\n$$ \\sum_{t=1}^{5} P_t - \\left( \\sum_{t=1}^{5} Q_t + \\sum_{t=1}^{5} \\text{ET}_t \\right) = S_5 - S_0 $$\n我们可以使用这个方程来确定，在给定观测到的降水、蒸散发和蓄水变化的情况下，为了满足水均衡，必须产生的总径流量 $\\sum Q_t^{\\text{wb}}$。\n$$ \\sum_{t=1}^{5} Q_t^{\\text{wb}} = \\sum_{t=1}^{5} P_t - \\sum_{t=1}^{5} \\text{ET}_t - (S_5 - S_0) $$\n代入给定值：\n$$ \\sum_{t=1}^{5} Q_t^{\\text{wb}} = 120 \\ \\text{mm} - 10 \\ \\text{mm} - (10 \\ \\text{mm} - 0 \\ \\text{mm}) $$\n$$ \\sum_{t=1}^{5} Q_t^{\\text{wb}} = 100 \\ \\text{mm} $$\n根据质量守恒原理和独立的观测结果，该时期的总径流量必须为 $100 \\ \\text{mm}$。\n\n现在，我们将这个受物理约束的结果与模型的预测进行比较：\n$$ \\sum_{t=1}^{5} Q_t^{\\text{mod}} = 130 \\ \\text{mm} $$\n模型的预测值 ($130 \\ \\text{mm}$) 显著超过了物理上允许的量 ($100 \\ \\text{mm}$)。该模型实际上“创造”了 $30 \\ \\text{mm}$ 的水，违反了质量守恒定律。\n$$ \\sum_{t=1}^{5} Q_t^{\\text{mod}} > \\sum_{t=1}^{5} Q_t^{\\text{wb}} $$\n因此，该模型**不具有机理适切性**。\n\n问题之所以出现，是因为模型结构 $Q_t = \\theta P_t + \\phi Q_{t-1}$ 是一个纯粹的统计关系，通过普通最小二乘法推导出来以最小化预测误差，没有任何内置约束来强制执行质量守恒。一个没有显式蓄水组成部分的模型无法保证其积分通量在物理上是一致的。\n\n**逐项分析**\n\n**A. 机理适切性要求与守恒定律及物理上可接受的状态和通量约束保持一致；统计适切性要求关于扰动和残差的概率假设不与数据相矛盾。因为 $\\sum_{t=1}^{5} Q_t^{\\text{mod}} > \\sum_{t=1}^{5} P_t - \\sum_{t=1}^{5} \\text{ET}_t + (S_5 - S_0)$，该模型违反了水均衡，因此不具有机理适切性，尽管残差诊断表明其具有统计适切性。一种补救方法是引入一个显式的蓄水状态 $S_t$ 和受非负性及质量守恒约束的通量参数化，而不是仅仅依赖于 $\\theta, \\phi$。**\n\n- 机理适切性和统计适切性的初始定义是精确和正确的。\n- 基于以上推导，模型在统计上适切但在机理上不适切的诊断是正确的。\n- 用于显示违规的不等式是 $\\sum Q_t^{\\text{mod}} > \\sum P_t - \\sum \\text{ET}_t + (S_5 - S_0)$，换算为 $130 > 120 - 10 + 10$，即 $130 > 120$。这个不等式是成立的，并证明了物理上的不均衡。最直接的违规陈述是 $\\sum Q_t^{\\text{mod}} \\neq \\sum P_t - \\sum \\text{ET}_t - (S_5 - S_0)$，即 $130 \\neq 100$。然而，选项中给出的不等式足以证明不一致性这一点。\n- 提议的补救措施——引入一个显式的蓄水状态以强制质量守恒——是解决此类模型结构错误的标准化且概念上正确的方法。\n- **结论：正确。**\n\n**B. 当拟合指标良好且残差呈现白噪声时，统计适切性即意味着机理适切性；因此，考虑到采样窗口较小，观测到的质量不均衡是可以接受的。最合适的补救方法是在率定过程中增加洪峰流量的权重，以进一步减小残差平方和。**\n\n- 前提“统计适切性意味着机理适切性”是根本错误的。一个模型可以有极好的统计拟合度，但在物理上却毫无意义。这个问题本身就是一个直接的反例。\n- 违反守恒定律是一个根本性缺陷，而不是一个可归因于采样窗口短的“可接受的”差异。\n- 提议的补救方法，即重新加权校准目标函数，是一种统计上的调整，并未解决潜在的机理结构缺陷。\n- **结论：错误。**\n\n**C. 机理适切性主要关乎回归中的参数显著性；由于 $\\theta$ 和 $\\phi$ 显著不为零，该模型具有机理适切性。明显的质量不均衡差异可能是采样噪声，可以在不进行结构性修改的情况下忽略。**\n\n- 这个选项错误地定义了机理适切性。它关乎对物理原则的遵守，而不是回归系数的统计显著性。\n- 该模型具有机理适切性的结论是错误的。\n- 30%的质量均衡误差（$130 \\ \\text{mm}$ 对比 $100 \\ \\text{mm}$）是一个系统性误差，而不是“采样噪声”，它指出了一个不应被忽略的关键模型缺陷。\n- **结论：错误。**\n\n**D. 机理适切性指的是参数估计值在不同数据集间的不变性；由于 $\\theta$ 可以被约束为小于1，向下缩放降水量（偏差校正）将在不引入蓄水状态的情况下恢复水均衡，同时保持简约性。**\n\n- 这个选项错误地定义了机理适切性。参数在不同数据集间的不变性是衡量模型鲁棒性或普适性的指标，而不是机理上的健全性。\n- 提议的补救方法，即对降水输入进行“偏差校正”，是一种临时的修复，它处理的是症状（质量不均衡）而不是病因（有缺陷的模型结构）。它错误地将责任归咎于输入数据，而不是模型的过程序列。核心问题是缺少一个蓄水组成部分。\n- **结论：错误。**\n\n**E. 通过使用自回归移动平均(ARMA)过程对残差进行建模来吸收质量不均衡差异，可以满足机理适切性；在径流方程中增加一个ARMA(1,1)扰动项，可以消除对显式守恒约束的需求，从而纠正结构性问题。**\n\n- 这个选项混淆了统计修复和机理修复。问题陈述中已说明残差是“白噪声”，因此从统计角度看，添加ARMA误差模型是不必要的。\n- 更重要的是，ARMA误差模型是描述噪声过程中自相关的统计工具。它对模型的确定性部分执行诸如质量守恒之类的物理定律毫无作用。它不能以物理上有意义的方式“吸收质量不均衡差异”或“纠正结构性问题”。\n- **结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "当面临多个相互竞争的模型时，我们如何选择“最佳”模型？本实践介绍了赤池信息准则（Akaike Information Criterion, AIC），这是一种广泛使用的度量标准，它通过权衡模型的拟合优度与复杂性来估计样本外预测性能。通过解决这个问题 ，您不仅将应用 AIC 来比较两个降水模型，还将从其信息论根源推导该准则，从而深入理解这一分析模型结构不确定性的核心工具。",
            "id": "3862427",
            "problem": "您正在一个流域尺度的日降水模拟任务中，量化模型结构的不确定性。两个结构不同的发生-强度模型通过最大似然法拟合到相同的 $n$ 个日观测数据上（$n$ 很大，因此大样本近似是合适的）。模型A是一个零膨胀伽马强度模型，其系数随季节变化，并使用一阶马尔可夫链来描述降水发生；模型B是一个更简单的零膨胀伽马模型，其尺度参数不随季节变化，且降水发生是独立的。模型A的自由参数数量为 $k_{A}=12$，模型B的自由参数数量为 $k_{B}=8$。最大化对数似然值分别为 $\\ln \\hat{L}_{A}=-12345.8$ 和 $\\ln \\hat{L}_{B}=-12352.1$。\n\n从赤池信息准则（Akaike Information Criterion, AIC）的解释出发，即AIC是拟合模型与数据生成过程之间预期Kullback–Leibler散度的两倍的一个渐近无偏估计量（相差一个对所有模型都相同的加性常数），并仅使用经过充分检验的最大似然估计量的大样本结果，完成以下任务：\n\n1. 推导在这种情况下适用于最大似然拟合的模型选择分数的表达式（大样本情况）。\n2. 使用该表达式，计算两个模型的选择分数、相对于最佳得分模型的AIC差值 $\\Delta_{i}$，以及两个模型的赤池权重（归一化模型似然）。\n3. 简要解释计算出的权重在预期样本外预测性能方面，对两种模型结构的相对支持意味着什么。\n\n为便于评分，请报告模型A的赤池权重作为您的最终数值答案，四舍五入到四位有效数字。最终答案应表示为纯小数，不带任何单位或百分号。",
            "solution": "该问题要求推导并应用赤池信息准则（AIC）来比较两个日降水统计模型。问题陈述的验证已确认其具有科学依据、问题提出得当，并包含完整解答所需的所有信息。\n\n解答将按要求分为三部分进行：\n1.  从信息论基础推导AIC公式。\n2.  计算两个模型的AIC分数、差值和赤池权重。\n3.  解释所得赤池权重。\n\n### 1. 赤池信息准则（AIC）的推导\n\n赤池信息准则（AIC）植根于Kullback-Leibler（K-L）散度的概念，K-L散度衡量了使用一个模型来近似真实的、潜在的数据生成过程时所损失的信息。\n\n设数据的真实、未知的概率分布用 $f(x)$ 表示。设一个候选统计模型由一族概率分布 $g(x|\\theta)$ 表示，该分布由一个包含 $k$ 个参数的向量 $\\theta$ 参数化。从真实过程 $f$ 到模型 $g$ 的K-L散度定义为：\n$$ D_{KL}(f || g(\\cdot|\\theta)) = \\int f(x) \\ln\\left(\\frac{f(x)}{g(x|\\theta)}\\right) dx $$\n这可以重写为：\n$$ D_{KL}(f || g(\\cdot|\\theta)) = E_f[\\ln(f(x))] - E_f[\\ln(g(x|\\theta))] $$\n其中 $E_f[\\cdot]$ 表示关于真实分布 $f(x)$ 的期望。\n\n我们在模型选择中的目标是选择使该K-L散度最小化的模型。由于 $E_f[\\ln(f(x))]$ 对于所有候选模型都是一个常数，因此最小化 $D_{KL}$ 等价于最大化模型的期望对数似然 $E_f[\\ln(g(x|\\theta))]$。\n\n在实践中，我们不知道模型的真实参数向量 $\\theta$；而是从一个包含 $n$ 个观测值 $y=\\{y_1, \\dots, y_n\\}$ 的数据集中，使用最大似然（ML）法来估计它，得到估计值 $\\hat{\\theta}(y)$。拟合模型 $g(x|\\hat{\\theta})$ 的质量由其在从同一真实分布 $f(x)$ 中抽取的新的、独立数据 $z$ 上的预期表现来评判。这个预期的样本外预测性能由 $E_z[\\ln(g(z|\\hat{\\theta}(y)))]$ 来衡量，其中期望是针对一个新的观测值 $z$。\n\n然而，最大似然估计 $\\hat{\\theta}(y)$ 是一个随机变量，因为它依赖于具体的数据集 $y$。因此，我们寻求估计一个对所有可能的训练数据集 $y$ 进行平均的量：\n$$ E_y[E_z[\\ln(g(z|\\hat{\\theta}(y)))]] $$\n这里，$E_y[\\cdot]$ 表示对所有从 $f(x)$ 中抽取的、大小为 $n$ 的可能数据集 $y$ 的期望。\n\n样本内的最大化对数似然 $\\ln L(\\hat{\\theta}) = \\sum_{i=1}^{n} \\ln g(y_i|\\hat{\\theta})$ 是这个目标量的 $n$ 倍的一个已知但有偏的估计量。Akaike 证明，对于大样本（$n \\to \\infty$）以及在最大似然估计的标准正则性条件下，这个乐观偏差（偏误）约等于自由参数的数量 $k$。具体来说：\n$$ E_y[\\ln L(\\hat{\\theta}(y))] \\approx n E_y[E_z[\\ln(g(z|\\hat{\\theta}(y)))]] + k $$\n重新整理这个式子，可以得到一个关于预期样本外对数似然（由 $n$ 缩放）的渐近无偏估计量：\n$$ n E_y[E_z[\\ln(g(z|\\hat{\\theta}(y)))]] \\approx E_y[\\ln L(\\hat{\\theta}(y))] - k $$\n在观测数据的尺度上，我们可以使用 $\\ln L(\\hat{\\theta}) - k$ 作为模型预测准确性的一个偏差校正度量（值越大越好）。\n\nAkaike 选择通过乘以 $-2$ 将他的准则定义在一个偏差尺度上（值越小越好）。这个选择将该准则与广义似然比检验联系起来。这就得到了赤池信息准则：\n$$ \\text{AIC} = -2\\ln L(\\hat{\\theta}) + 2k $$\n这个表达式是预期K-L散度两倍的一个渐近无偏估计量，它与真实值之间相差一个加性常数，该常数对于所有被比较的模型都是相同的，因此在计算差值时会被抵消。这就是要使用的模型选择分数。\n\n### 2. 分数、差值和权重的计算\n\n我们已知关于模型A和模型B的以下信息：\n- 模型A的最大化对数似然值：$\\ln \\hat{L}_A = -12345.8$\n- 模型A的参数数量：$k_A = 12$\n- 模型B的最大化对数似然值：$\\ln \\hat{L}_B = -12352.1$\n- 模型B的参数数量：$k_B = 8$\n\n使用推导出的AIC表达式，我们计算每个模型的分数。\n\n对于模型A：\n$$ \\text{AIC}_A = -2 \\ln \\hat{L}_A + 2 k_A = -2(-12345.8) + 2(12) = 24691.6 + 24 = 24715.6 $$\n\n对于模型B：\n$$ \\text{AIC}_B = -2 \\ln \\hat{L}_B + 2 k_B = -2(-12352.1) + 2(8) = 24704.2 + 16 = 24720.2 $$\n\n接下来，我们计算相对于得分最佳模型（即AIC分数最小的模型）的AIC差值 $\\Delta_i$。\n最小的AIC分数为 $\\text{AIC}_{\\min} = \\min(\\text{AIC}_A, \\text{AIC}_B) = \\min(24715.6, 24720.2) = 24715.6$，对应于模型A。\n\n模型A的AIC差值为：\n$$ \\Delta_A = \\text{AIC}_A - \\text{AIC}_{\\min} = 24715.6 - 24715.6 = 0 $$\n\n模型B的AIC差值为：\n$$ \\Delta_B = \\text{AIC}_B - \\text{AIC}_{\\min} = 24720.2 - 24715.6 = 4.6 $$\n\n最后，我们计算赤池权重 $w_i$。模型 $i$ 的权重被解释为，在K-L散度的意义上，它是该模型集合中最佳模型的概率。在一组包含 $R$ 个模型的集合中，模型 $i$ 的权重公式为：\n$$ w_i = \\frac{\\exp(-\\frac{1}{2}\\Delta_i)}{\\sum_{j=1}^{R} \\exp(-\\frac{1}{2}\\Delta_j)} $$\n\n在本例中，有 $R=2$ 个模型：\n模型A的权重（$w_A$）为：\n$$ w_A = \\frac{\\exp(-\\frac{1}{2}\\Delta_A)}{\\exp(-\\frac{1}{2}\\Delta_A) + \\exp(-\\frac{1}{2}\\Delta_B)} = \\frac{\\exp(-\\frac{0}{2})}{\\exp(-\\frac{0}{2}) + \\exp(-\\frac{4.6}{2})} = \\frac{\\exp(0)}{\\exp(0) + \\exp(-2.3)} = \\frac{1}{1 + \\exp(-2.3)} $$\n计算其数值：\n$$ w_A = \\frac{1}{1 + 0.1002588...} = \\frac{1}{1.1002588...} \\approx 0.908876 $$\n\n模型B的权重（$w_B$）为：\n$$ w_B = \\frac{\\exp(-\\frac{1}{2}\\Delta_B)}{\\exp(-\\frac{1}{2}\\Delta_A) + \\exp(-\\frac{1}{2}\\Delta_B)} = \\frac{\\exp(-2.3)}{1 + \\exp(-2.3)} \\approx 0.091124 $$\n作为检验，所有权重之和必须为1：$w_A + w_B = 0.908876 + 0.091124 = 1$。\n\n问题要求模型A的赤池权重，并四舍五入到四位有效数字。\n$$ w_A \\approx 0.9089 $$\n\n### 3. 赤池权重的解释\n\n赤池权重提供了在给定数据和候选模型集的情况下，对每个模型的相对支持程度的度量。权重 $w_i$ 可以被解释为当对新数据进行预测时，模型 $i$ 是平均表现最佳的模型的概率。\n\n在本例中，权重为 $w_A \\approx 0.909$ 和 $w_B \\approx 0.091$。这表明，模型A（具有随季节变化的系数和马尔可夫链的更复杂模型）比更简单的模型B得到了数据更强的支持。具体来说，据估计，模型A是两者中更好的预测模型的概率为 $90.9\\%$。\n\n证据比 $w_A / w_B \\approx 0.909 / 0.091 \\approx 9.99$ 表明，在最小化预期K-L散度（即提供更好的样本外预测性能）方面，模型A是更优模型的可能性大约是模型B的10倍。这一强有力的证据表明，模型A的额外复杂性（多出4个参数）是合理的，因为它在拟合优度上的显著改善超过了对其增加复杂性的惩罚。\n\n最终要求的答案是模型A的赤池权重的数值，四舍五入到四位有效数字。\n$$ w_A \\approx 0.9089 $$",
            "answer": "$$\\boxed{0.9089}$$"
        },
        {
            "introduction": "贝叶斯框架为模型比较提供了一种强大的替代方法，它通过量化数据支持一个模型结构相对于另一个模型结构的证据权重来进行评估。这种方法被概括在贝叶斯因子中，它计算了不同模型的边际似然之比。这个问题  提供了一个具体的练习，用于推导和计算两个竞争性水文模型的贝叶斯因子，促使您深入探究先验参数假设在模型证据评估中所扮演的关键角色。",
            "id": "3862433",
            "problem": "一个水文集水区在 $n=4$ 天内被观测。设径流异常为 $\\mathbf{y}=\\begin{pmatrix}2  0  -2  0\\end{pmatrix}^{\\top}$，降水异常为 $\\mathbf{P}=\\begin{pmatrix}1  -1  1  -1\\end{pmatrix}^{\\top}$，温度异常为 $\\mathbf{T}=\\begin{pmatrix}1  1  -1  -1\\end{pmatrix}^{\\top}$。考虑两种具有高斯误差的竞争性参数线性径流模型结构：\n- 模型 $\\mathcal{M}_{1}$: $\\mathbf{y}=\\beta_{0}\\mathbf{1}+\\beta_{P}\\mathbf{P}+\\beta_{T}\\mathbf{T}+\\boldsymbol{\\varepsilon}$，\n- 模型 $\\mathcal{M}_{2}$: $\\mathbf{y}=\\gamma_{0}\\mathbf{1}+\\gamma_{1}(\\mathbf{P}+\\mathbf{T})+\\gamma_{2}(\\mathbf{P}-\\mathbf{T})+\\boldsymbol{\\varepsilon}$，\n其中 $\\mathbf{1}=\\begin{pmatrix}1  1  1  1\\end{pmatrix}^{\\top}$ 且 $\\boldsymbol{\\varepsilon}\\sim\\mathcal{N}(\\mathbf{0},\\sigma^{2}\\mathbf{I})$，已知 $\\sigma^{2}=1$。参数先验是独立的高斯分布：对于 $\\mathcal{M}_{1}$，$\\boldsymbol{\\beta}\\sim\\mathcal{N}(\\mathbf{0},s^{2}\\mathbf{I})$；对于 $\\mathcal{M}_{2}$，$\\boldsymbol{\\gamma}\\sim\\mathcal{N}(\\mathbf{0},s^{2}\\mathbf{I})$，其中 $s^{2}=1$。\n\n从模型证据的定义 $p(\\mathbf{y}\\mid\\mathcal{M})=\\int p(\\mathbf{y}\\mid\\boldsymbol{\\theta},\\mathcal{M})\\,p(\\boldsymbol{\\theta}\\mid\\mathcal{M})\\,\\mathrm{d}\\boldsymbol{\\theta}$ 和多元高斯积分的标准性质出发，推导比较 $\\mathcal{M}_{1}$ 与 $\\mathcal{M}_{2}$ 的贝叶斯因子的解析表达式，该因子定义为它们证据的比值。然后，使用给定的 $\\mathbf{y}$、$\\mathbf{P}$ 和 $\\mathbf{T}$，在指定的先验和噪声方差下，精确计算该贝叶斯因子。\n\n此外，简要地用文字讨论贝叶斯因子如何依赖于先验方差尺度 $s^{2}$，考虑 $s^{2}\\to 0$ 和 $s^{2}\\to\\infty$ 的极限情况。此敏感性讨论无需数值输出。\n\n将贝叶斯因子表示为单个闭式解析表达式。它是无量纲的；不需要单位，也无需四舍五入。",
            "solution": "问题要求计算比较两个线性模型 $\\mathcal{M}_{1}$ 和 $\\mathcal{M}_{2}$ 的贝叶斯因子 $B_{12}$，并定性讨论其对先验方差 $s^2$ 的敏感性。贝叶斯因子定义为模型证据的比值，$B_{12} = p(\\mathbf{y}\\mid\\mathcal{M}_{1}) / p(\\mathbf{y}\\mid\\mathcal{M}_{2})$。\n\n模型证据，或稱边缘似然，由似然函数在参数 $\\boldsymbol{\\theta}$ 的先验分布上的积分给出：\n$$p(\\mathbf{y}\\mid\\mathcal{M})=\\int p(\\mathbf{y}\\mid\\boldsymbol{\\theta},\\mathcal{M})\\,p(\\boldsymbol{\\theta}\\mid\\mathcal{M})\\,\\mathrm{d}\\boldsymbol{\\theta}$$\n对于一个通用线性模型 $\\mathbf{y} = X\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$，其似然为高斯分布 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 \\mathbf{I})$，参数的先验为高斯分布 $\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\Sigma_0)$，其模型证据可以解析计算。似然函数为 $p(\\mathbf{y}\\mid\\boldsymbol{\\theta}) = (2\\pi\\sigma^2)^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^2}(\\mathbf{y}-X\\boldsymbol{\\theta})^\\top(\\mathbf{y}-X\\boldsymbol{\\theta})\\right)$，先验分布为 $p(\\boldsymbol{\\theta}) = (2\\pi)^{-k/2}|\\Sigma_0|^{-1/2} \\exp\\left(-\\frac{1}{2}(\\boldsymbol{\\theta}-\\boldsymbol{\\mu}_0)^\\top\\Sigma_0^{-1}(\\boldsymbol{\\theta}-\\boldsymbol{\\mu}_0)\\right)$，其中 $n$ 是观测数量，$k$ 是参数数量。\n\n所得积分的结果是已知的：\n$$p(\\mathbf{y}\\mid\\mathcal{M}) = (2\\pi)^{-n/2} |\\sigma^2\\mathbf{I} + X\\Sigma_0 X^\\top|^{-1/2} \\exp\\left(-\\frac{1}{2}(\\mathbf{y}-X\\boldsymbol{\\mu}_0)^\\top(\\sigma^2\\mathbf{I} + X\\Sigma_0 X^\\top)^{-1}(\\mathbf{y}-X\\boldsymbol{\\mu}_0)\\right)$$\n在本问题中，我们有 $\\boldsymbol{\\mu}_0 = \\mathbf{0}$，$\\Sigma_0 = s^2\\mathbf{I}$，$\\sigma^2=1$ 且 $s^2=1$。这简化了证据表达式。使用矩阵行列式引理 $|\\sigma^2\\mathbf{I}_n + X\\Sigma_0 X^\\top| = |\\Sigma_0||\\Sigma_0^{-1}+\\frac{1}{\\sigma^2}X^\\top X|(\\sigma^2)^n$ 和Woodbury矩阵恒等式，证据可以表示为一个涉及 $k \\times k$ 矩阵的、计算上更方便的形式：\n$$p(\\mathbf{y}\\mid\\mathcal{M}) = (2\\pi)^{-n/2} (\\sigma^2)^{-(n-k)/2} |s^2\\mathbf{I}|^{-1/2} |\\frac{1}{\\sigma^2}X^\\top X + \\frac{1}{s^2}\\mathbf{I}|^{-1/2} \\exp\\left(-\\frac{1}{2\\sigma^2}\\mathbf{y}^\\top\\mathbf{y} + \\frac{1}{2\\sigma^4}\\mathbf{y}^\\top X A_p^{-1} X^\\top\\mathbf{y}\\right)$$\n其中 $A_p = \\frac{1}{\\sigma^2}X^\\top X + \\frac{1}{s^2}\\mathbf{I}$ 是后验精度矩阵。\n\n对于贝叶斯因子 $B_{12} = p(\\mathbf{y}\\mid\\mathcal{M}_{1})/p(\\mathbf{y}\\mid\\mathcal{M}_{2})$，两个模型共有的项会抵消。由于两个模型的 $n, k, \\sigma^2$ 和 $s^2$ 都相同，贝叶斯因子的表达式简化为：\n$$B_{12} = \\frac{|A_{p1}|^{-1/2} \\exp\\left(+\\frac{1}{2}\\mathbf{y}^\\top X_1 A_{p1}^{-1} X_1^\\top\\mathbf{y}\\right)}{|A_{p2}|^{-1/2} \\exp\\left(+\\frac{1}{2}\\mathbf{y}^\\top X_2 A_{p2}^{-1} X_2^\\top\\mathbf{y}\\right)}$$\n注意我们已使用 $\\sigma^2=1$。项 $\\exp(-\\frac{1}{2}\\mathbf{y}^\\top\\mathbf{y})$ 也抵消了。给定 $s^2=1, \\sigma^2=1$，后验精度矩阵为 $A_{pi} = X_i^\\top X_i + \\mathbf{I}$，其中 $i=1,2$。\n\n首先，我们为两个模型定义数据和预测变量矩阵。\n数据：$\\mathbf{y}=\\begin{pmatrix}2  0  -2  0\\end{pmatrix}^{\\top}$。\n预测变量：$\\mathbf{1}=\\begin{pmatrix}1  1  1  1\\end{pmatrix}^{\\top}$，$\\mathbf{P}=\\begin{pmatrix}1  -1  1  -1\\end{pmatrix}^{\\top}$，$\\mathbf{T}=\\begin{pmatrix}1  1  -1  -1\\end{pmatrix}^{\\top}$。\n\n对于模型 $\\mathcal{M}_{1}: \\mathbf{y}=\\beta_{0}\\mathbf{1}+\\beta_{P}\\mathbf{P}+\\beta_{T}\\mathbf{T}+\\boldsymbol{\\varepsilon}$，设计矩阵 $X_1$ 为：\n$$X_1 = \\begin{pmatrix} \\mathbf{1}  \\mathbf{P}  \\mathbf{T} \\end{pmatrix} = \\begin{pmatrix} 1  1  1 \\\\ 1  -1  1 \\\\ 1  1  -1 \\\\ 1  -1  -1 \\end{pmatrix}$$\n$X_1$ 的列是正交的。我们计算 $X_1^\\top X_1$：\n$$ \\mathbf{1}^\\top\\mathbf{1} = 4, \\quad \\mathbf{P}^\\top\\mathbf{P} = 4, \\quad \\mathbf{T}^\\top\\mathbf{T} = 4, \\quad \\mathbf{1}^\\top\\mathbf{P}=0, \\quad \\mathbf{1}^\\top\\mathbf{T}=0, \\quad \\mathbf{P}^\\top\\mathbf{T}=0 $$\n所以，$X_1^\\top X_1 = 4\\mathbf{I}_3$。\n$\\mathcal{M}_{1}$ 的后验精度为 $A_{p1} = X_1^\\top X_1 + \\mathbf{I} = 4\\mathbf{I}_3 + \\mathbf{I}_3 = 5\\mathbf{I}_3$。\n行列式为 $|A_{p1}| = 5^3 = 125$。逆矩阵为 $A_{p1}^{-1} = \\frac{1}{5}\\mathbf{I}_3$。\n我们还需要 $X_1^\\top\\mathbf{y}$：\n$$ X_1^\\top\\mathbf{y} = \\begin{pmatrix} \\mathbf{1}^\\top\\mathbf{y} \\\\ \\mathbf{P}^\\top\\mathbf{y} \\\\ \\mathbf{T}^\\top\\mathbf{y} \\end{pmatrix} = \\begin{pmatrix} 2+0-2+0 \\\\ 2-0-2-0 \\\\ 2+0+2+0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 4 \\end{pmatrix} $$\n$\\mathcal{M}_{1}$ 的指数项为 $\\mathbf{y}^\\top X_1 A_{p1}^{-1} X_1^\\top\\mathbf{y} = (X_1^\\top\\mathbf{y})^\\top A_{p1}^{-1} (X_1^\\top\\mathbf{y}) = \\begin{pmatrix} 0  0  4 \\end{pmatrix} \\frac{1}{5}\\mathbf{I}_3 \\begin{pmatrix} 0 \\\\ 0 \\\\ 4 \\end{pmatrix} = \\frac{16}{5}$。\n\n对于模型 $\\mathcal{M}_{2}: \\mathbf{y}=\\gamma_{0}\\mathbf{1}+\\gamma_{1}(\\mathbf{P}+\\mathbf{T})+\\gamma_{2}(\\mathbf{P}-\\mathbf{T})+\\boldsymbol{\\varepsilon}$，我们定义新的预测变量：\n$\\mathbf{Z}_1 = \\mathbf{1}$，$\\mathbf{Z}_2 = \\mathbf{P}+\\mathbf{T} = \\begin{pmatrix}2  0  0  -2\\end{pmatrix}^\\top$，$\\mathbf{Z}_3 = \\mathbf{P}-\\mathbf{T} = \\begin{pmatrix}0  -2  2  0\\end{pmatrix}^\\top$。\n设计矩阵 $X_2$ 为：\n$$X_2 = \\begin{pmatrix} \\mathbf{Z}_1  \\mathbf{Z}_2  \\mathbf{Z}_3 \\end{pmatrix} = \\begin{pmatrix} 1  2  0 \\\\ 1  0  -2 \\\\ 1  0  2 \\\\ 1  -2  0 \\end{pmatrix}$$\n$X_2$ 的列也是正交的。我们计算 $X_2^\\top X_2$：\n$$ \\mathbf{Z}_1^\\top\\mathbf{Z}_1 = 4, \\quad \\mathbf{Z}_2^\\top\\mathbf{Z}_2 = 4+0+0+4=8, \\quad \\mathbf{Z}_3^\\top\\mathbf{Z}_3 = 0+4+4+0=8 $$\n所以，$X_2^\\top X_2 = \\text{diag}(4, 8, 8)$。\n$\\mathcal{M}_{2}$ 的后验精度为 $A_{p2} = X_2^\\top X_2 + \\mathbf{I} = \\text{diag}(4, 8, 8) + \\text{diag}(1, 1, 1) = \\text{diag}(5, 9, 9)$。\n行列式为 $|A_{p2}| = 5 \\times 9 \\times 9 = 405$。逆矩阵为 $A_{p2}^{-1} = \\text{diag}(\\frac{1}{5}, \\frac{1}{9}, \\frac{1}{9})$。\n我们需要 $X_2^\\top\\mathbf{y}$：\n$$ X_2^\\top\\mathbf{y} = \\begin{pmatrix} \\mathbf{Z}_1^\\top\\mathbf{y} \\\\ \\mathbf{Z}_2^\\top\\mathbf{y} \\\\ \\mathbf{Z}_3^\\top\\mathbf{y} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 4+0+0+0 \\\\ 0+0-4+0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 4 \\\\ -4 \\end{pmatrix} $$\n$\\mathcal{M}_{2}$ 的指数项为 $(X_2^\\top\\mathbf{y})^\\top A_{p2}^{-1} (X_2^\\top\\mathbf{y}) = \\begin{pmatrix} 0  4  -4 \\end{pmatrix} \\text{diag}(\\frac{1}{5}, \\frac{1}{9}, \\frac{1}{9}) \\begin{pmatrix} 0 \\\\ 4 \\\\ -4 \\end{pmatrix} = 0 + \\frac{16}{9} + \\frac{16}{9} = \\frac{32}{9}$。\n\n现在我们可以计算贝叶斯因子 $B_{12}$。我们首先需要每个模型的证据（忽略一个共同的常数 $C$，该常数包含 $\\exp(-\\frac{1}{2}\\mathbf{y}^\\top\\mathbf{y})$）：\n$$ p(\\mathbf{y} \\mid \\mathcal{M}_{1}) \\propto |A_{p1}|^{-1/2} \\exp\\left(\\frac{1}{2} \\cdot \\frac{16}{5}\\right) = (125)^{-1/2}\\exp\\left(\\frac{8}{5}\\right) = \\frac{1}{5\\sqrt{5}}\\exp\\left(\\frac{8}{5}\\right) $$\n$$ p(\\mathbf{y} \\mid \\mathcal{M}_{2}) \\propto |A_{p2}|^{-1/2} \\exp\\left(\\frac{1}{2} \\cdot \\frac{32}{9}\\right) = (405)^{-1/2}\\exp\\left(\\frac{16}{9}\\right) = \\frac{1}{\\sqrt{81 \\times 5}}\\exp\\left(\\frac{16}{9}\\right) = \\frac{1}{9\\sqrt{5}}\\exp\\left(\\frac{16}{9}\\right) $$\n等等，该项应该是 $-\\frac{1}{2} (\\mathbf{y}^\\top\\mathbf{y} - \\mathbf{y}^\\top X A^{-1} X^\\top \\mathbf{y})$。\n让我们仔细地重新开始比率的计算。\n$B_{12} = \\frac{|A_{p1}|^{-1/2}\\exp(-\\frac{1}{2}(\\mathbf{y}^\\top\\mathbf{y} - (X_1^\\top\\mathbf{y})^\\top A_{p1}^{-1} (X_1^\\top\\mathbf{y})))}{|A_{p2}|^{-1/2}\\exp(-\\frac{1}{2}(\\mathbf{y}^\\top\\mathbf{y} - (X_2^\\top\\mathbf{y})^\\top A_{p2}^{-1} (X_2^\\top\\mathbf{y})))}$。\n$\\exp(-\\frac{1}{2}\\mathbf{y}^\\top\\mathbf{y})$ 项抵消了。\n$$ B_{12} = \\frac{|A_{p1}|^{-1/2}}{|A_{p2}|^{-1/2}} \\exp\\left(\\frac{1}{2} \\left[ (X_1^\\top\\mathbf{y})^\\top A_{p1}^{-1} (X_1^\\top\\mathbf{y}) - (X_2^\\top\\mathbf{y})^\\top A_{p2}^{-1} (X_2^\\top\\mathbf{y}) \\right] \\right) $$\n$$ B_{12} = \\sqrt{\\frac{|A_{p2}|}{|A_{p1}|}} \\exp\\left(\\frac{1}{2} \\left[ \\frac{16}{5} - \\frac{32}{9} \\right] \\right) $$\n$$ B_{12} = \\sqrt{\\frac{405}{125}} \\exp\\left(\\frac{1}{2} \\left[ \\frac{144 - 160}{45} \\right] \\right) = \\sqrt{\\frac{81}{25}} \\exp\\left(\\frac{1}{2} \\left[ -\\frac{16}{45} \\right] \\right) $$\n$$ B_{12} = \\frac{9}{5} \\exp\\left(-\\frac{8}{45}\\right) $$\n\n关于对先验方差 $s^2$ 敏感性的讨论：\n贝叶斯因子提供了对两个模型在先验参数空间上积分后解释数据优劣的比较。先验方差 $s^2$ 控制了这个参数空间的宽度。\n1.  情况 $s^2 \\to 0$：这对应于参数（$\\beta_i$ 和 $\\gamma_i$）非常接近于 $0$ 的先验信念。在极限情况下，两个模型都简化为 $\\mathbf{y} = \\boldsymbol{\\varepsilon}$。两个模型的证据变得相同，因为它们做出相同的预测（均值为零）。此时的证据就是噪声模型下观测到 $\\mathbf{y}$ 的概率，$p(\\mathbf{y}) = \\mathcal{N}(\\mathbf{y} \\mid \\mathbf{0}, \\sigma^2\\mathbf{I})$。由于证据相同，它们的比值，即贝叶斯因子 $B_{12}$，必定趋近于 $1$。\n\n2.  情况 $s^2 \\to \\infty$：这对应于一个非常“无信息”或“模糊”的先验，即一个非常宽范围的参数值都被认为是合理的。在此极限下，贝叶斯因子不一定趋于 $1$ 或 $\\infty$。它通常会收敛到一个常数，这个常数反映了数据对一个模型结构相对于另一个模型结构的支持程度，并受到模型复杂度的惩罚。在这个具体问题中，两个模型代表了相同基础预测空间（$X_1$ 和 $X_2$ 的列空间是相同的）的不同参数化。因此，比较的重点在于两种参数化在此空间上引起的不同先验。模型 $\\mathcal{M}_{2}$ 中的预测变量（例如 $\\mathbf{P}+\\mathbf{T}$）比模型 $\\mathcal{M}_{1}$ 中的预测变量（例如 $\\mathbf{P}, \\mathbf{T}$）具有更大的范数。在使用各向同性先验 $\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{0}, s^2\\mathbf{I})$ 的情况下，预测变量尺度的这种差异与先验相互作用，即使在 $s^2$ 很大的情况下，也会偏好其中一个模型结构。数学分析表明，对于这个问题，$\\lim_{s^2 \\to \\infty} B_{12} = 2$。参数化的差异导致了对 $\\mathcal{M}_{1}$ 的持续偏好。",
            "answer": "$$\\boxed{\\frac{9}{5}\\exp\\left(-\\frac{8}{45}\\right)}$$"
        }
    ]
}