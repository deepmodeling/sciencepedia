{
    "hands_on_practices": [
        {
            "introduction": "数据同化的核心是贝叶斯推断问题：根据新的观测来更新我们对系统状态的认知。第一个实践练习将我们带入这一基本原理。通过为一个简单的线性高斯系统推导后验分布，您将亲身体验卡尔曼滤波分析方程如何直接从贝叶斯定理中产生，为后续所有内容奠定坚实的理论基础 。",
            "id": "3878363",
            "problem": "考虑一个代表环境和地球系统建模的线性高斯数据同化设置，其中一个二维状态向量 $x \\in \\mathbb{R}^{2}$ 表示两个子域的聚合属性（例如，两个子流域的水储量异常）。先验（背景）状态被建模为一个高斯随机变量 $x \\sim \\mathcal{N}(x_b, B)$，观测模型是线性的，\n$$\ny = H x + \\varepsilon,\n$$\n其中观测误差被建模为一个高斯随机变量 $\\varepsilon \\sim \\mathcal{N}(0, R)$，且在统计上与 $x$ 独立。假设有一个单一的标量观测，并采用以下基本要素的定义：\n- 先验均值 $x_b$ 和先验协方差 $B$ 是 $x$ 的高斯先验的均值和协方差。\n- 观测算子 $H$ 将状态 $x$ 映射到观测空间。\n- 观测误差协方差 $R$ 表征了测量值 $y$ 的不确定性。\n\n从贝叶斯公式 $p(x \\mid y) \\propto p(y \\mid x)\\, p(x)$ 出发，仅使用多元高斯分布的性质，通过对联合高斯密度的指数项进行配方，推导出后验分布 $p(x \\mid y)$ 并显式计算其均值 $x_a$ 和协方差 $A$。然后，使用以下具体的、科学上合理的配置，该配置模拟了对两个子域贡献之和的单一流域积分观测：\n- $x_b = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$，\n- $B = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$，\n- $H = \\begin{bmatrix} 1  1 \\end{bmatrix}$，\n- $R = \\begin{bmatrix} 0.25 \\end{bmatrix}$，\n- $y = 1.5$，\n\n计算精确的后验均值向量 $x_a$ 和后验协方差矩阵 $A$。报告你的最终数值（不要四舍五入）。将你的最终答案表示为一个单行矩阵，按顺序包含 $x_a$ 的两个分量，后随 $A$ 按行主序排列的四个元素。",
            "solution": "该问题被评估为 **有效**。它提出了一个在线性高斯框架下的标准、适定的贝叶斯数据同化问题。问题陈述具有科学依据，客观，并提供了一套完整且一致的给定条件，从而可以得到唯一且有意义的解。\n\n推导分两个阶段进行。首先，通过配方法推导出后验均值和协方差的一般解析表达式。其次，使用问题中提供的具体数值来计算这些表达式。\n\n**1. 后验均值和协方差的一般推导**\n\n分析始于后验概率密度函数 (PDF) $p(x \\mid y)$ 的贝叶斯公式：\n$$\np(x \\mid y) \\propto p(y \\mid x) p(x)\n$$\n其中 $p(x)$ 是先验 PDF，$p(y \\mid x)$ 是似然函数。\n\n状态向量 $x \\in \\mathbb{R}^{2}$ 的先验分布是高斯的，$x \\sim \\mathcal{N}(x_b, B)$，因此其 PDF 为：\n$$\np(x) \\propto \\exp\\left(-\\frac{1}{2}(x - x_b)^T B^{-1} (x - x_b)\\right)\n$$\n观测模型为 $y = Hx + \\varepsilon$，其中观测误差 $\\varepsilon$ 是一个独立的高斯随机变量，$\\varepsilon \\sim \\mathcal{N}(0, R)$。这意味着给定状态 $x$ 时，观测值 $y$ 的条件分布也是高斯的，$y \\mid x \\sim \\mathcal{N}(Hx, R)$。因此，似然函数为：\n$$\np(y \\mid x) \\propto \\exp\\left(-\\frac{1}{2}(y - Hx)^T R^{-1} (y - Hx)\\right)\n$$\n将先验和似然相乘，得到后验 PDF：\n$$\np(x \\mid y) \\propto \\exp\\left(-\\frac{1}{2}(x - x_b)^T B^{-1} (x - x_b) - \\frac{1}{2}(y - Hx)^T R^{-1} (y - Hx)\\right)\n$$\n后验分布也是高斯的，形式为 $p(x \\mid y) \\sim \\mathcal{N}(x_a, A)$，其 PDF 正比于 $\\exp\\left(-\\frac{1}{2}(x - x_a)^T A^{-1} (x - x_a)\\right)$。为了找到后验均值 $x_a$ 和协方差 $A$，我们分析后验 PDF 的指数部分，它是一个关于 $x$ 的二次代价函数，记为 $J(x)$：\n$$\nJ(x) = (x - x_b)^T B^{-1} (x - x_b) + (y - Hx)^T R^{-1} (y - Hx)\n$$\n我们展开 $J(x)$ 中的项：\n$$\nJ(x) = (x^T B^{-1} x - x^T B^{-1} x_b - x_b^T B^{-1} x + x_b^T B^{-1} x_b) + (x^T H^T R^{-1} H x - x^T H^T R^{-1} y - y^T R^{-1} H x + y^T R^{-1} y)\n$$\n利用逆协方差矩阵的对称性（$B^{-1} = (B^{-1})^T$, $R^{-1} = (R^{-1})^T$）以及像 $x_b^T B^{-1} x$ 这样的项是标量且等于其自身的转置，我们可以根据对 $x$ 的依赖性对各项进行分组：\n$$\nJ(x) = x^T(B^{-1} + H^T R^{-1} H)x - 2x^T(B^{-1} x_b + H^T R^{-1} y) + \\text{const}\n$$\n其中 `const` 包括所有不依赖于 $x$ 的项。将此 $J(x)$ 的表达式与一般高斯 PDF 的指数项进行比较，其形式为 $(x - x_a)^T A^{-1} (x - x_a) + \\text{const'}$。展开此目标形式得到：\n$$\n(x - x_a)^T A^{-1} (x - x_a) = x^T A^{-1} x - 2x^T A^{-1} x_a + x_a^T A^{-1} x_a\n$$\n通过匹配 $x$ 的二次项，我们确定后验协方差矩阵的逆 $A^{-1}$：\n$$\nA^{-1} = B^{-1} + H^T R^{-1} H\n$$\n通过匹配 $x$ 的线性项，我们找到后验均值 $x_a$ 的关系：\n$$\nA^{-1} x_a = B^{-1} x_b + H^T R^{-1} y\n$$\n解出 $x_a$ 得：\n$$\nx_a = A (B^{-1} x_b + H^T R^{-1} y)\n$$\n这些是后验协方差和均值的一般表达式。\n\n**2. 数值计算**\n\n现在我们将这些公式应用于给定的数值：\n- $x_b = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$\n- $B = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} = I_2$\n- $H = \\begin{bmatrix} 1  1 \\end{bmatrix}$\n- $R = \\begin{bmatrix} 0.25 \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{4} \\end{bmatrix}$\n- $y = 1.5 = \\frac{3}{2}$\n\n首先，我们计算必要的矩阵逆：\n- $B^{-1} = I_2^{-1} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$\n- $R^{-1} = \\begin{bmatrix} \\frac{1}{4} \\end{bmatrix}^{-1} = \\begin{bmatrix} 4 \\end{bmatrix}$\n\n接下来，我们计算后验协方差矩阵的逆 $A^{-1}$：\n$$\nA^{-1} = B^{-1} + H^T R^{-1} H = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} + \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} 4 \\end{bmatrix} \\begin{bmatrix} 1  1 \\end{bmatrix}\n$$\n$$\nA^{-1} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} + \\begin{bmatrix} 4  4 \\\\ 4  4 \\end{bmatrix} = \\begin{bmatrix} 5  4 \\\\ 4  5 \\end{bmatrix}\n$$\n后验协方差矩阵 $A$ 是 $A^{-1}$ 的逆。对于一个 $2 \\times 2$ 矩阵，其逆由 $\\frac{1}{ad-bc}\\begin{bsmallmatrix} d  -b \\\\ -c  a \\end{bsmallmatrix}$ 给出。\n$$\n\\det(A^{-1}) = (5)(5) - (4)(4) = 25 - 16 = 9\n$$\n$$\nA = (A^{-1})^{-1} = \\frac{1}{9} \\begin{bmatrix} 5  -4 \\\\ -4  5 \\end{bmatrix} = \\begin{bmatrix} \\frac{5}{9}  -\\frac{4}{9} \\\\ -\\frac{4}{9}  \\frac{5}{9} \\end{bmatrix}\n$$\n最后，我们计算后验均值向量 $x_a$：\n$$\nx_a = A (B^{-1} x_b + H^T R^{-1} y)\n$$\n首先，我们计算括号中的项：\n$$\nB^{-1} x_b + H^T R^{-1} y = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} 4 \\end{bmatrix} \\begin{bmatrix} \\frac{3}{2} \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} 6 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 6 \\\\ 6 \\end{bmatrix} = \\begin{bmatrix} 7 \\\\ 6 \\end{bmatrix}\n$$\n现在我们乘以 $A$ 得到 $x_a$：\n$$\nx_a = \\begin{bmatrix} \\frac{5}{9}  -\\frac{4}{9} \\\\ -\\frac{4}{9}  \\frac{5}{9} \\end{bmatrix} \\begin{bmatrix} 7 \\\\ 6 \\end{bmatrix} = \\begin{bmatrix} \\frac{5}{9}(7) - \\frac{4}{9}(6) \\\\ -\\frac{4}{9}(7) + \\frac{5}{9}(6) \\end{bmatrix} = \\begin{bmatrix} \\frac{35 - 24}{9} \\\\ \\frac{-28 + 30}{9} \\end{bmatrix} = \\begin{bmatrix} \\frac{11}{9} \\\\ \\frac{2}{9} \\end{bmatrix}\n$$\n后验均值为 $x_a = \\begin{bmatrix} \\frac{11}{9} \\\\ \\frac{2}{9} \\end{bmatrix}$，后验协方差为 $A = \\begin{bmatrix} \\frac{5}{9}  -\\frac{4}{9} \\\\ -\\frac{4}{9}  \\frac{5}{9} \\end{bmatrix}$。\n\n要求的最终答案是一个行矩阵，其中包含 $x_a$ 的分量，后随 $A$ 的行主序元素：$[x_{a,1}, x_{a,2}, A_{11}, A_{12}, A_{21}, A_{22}]$。\n这些值为：$\\frac{11}{9}$、$\\frac{2}{9}$、$\\frac{5}{9}$、$-\\frac{4}{9}$、$-\\frac{4}{9}$、$\\frac{5}{9}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{11}{9}  \\frac{2}{9}  \\frac{5}{9}  -\\frac{4}{9}  -\\frac{4}{9}  \\frac{5}{9} \\end{pmatrix} } $$"
        },
        {
            "introduction": "在用新数据校正了我们的状态估计之后，我们必须预测其随时间的演变。第二个练习聚焦于同化循环的预报步骤，演示状态估计（均值）及其相关不确定性（协方差）如何通过模型进行传播。掌握这种传播对于理解在任何序贯数据同化系统中，误差如何在两次观测之间增长和演变至关重要 。",
            "id": "3878311",
            "problem": "考虑一个针对三个海表温度异常状态分量的基于集合的数据同化循环，其状态由状态向量 $x \\in \\mathbb{R}^{3}$ 表示，分量单位为开尔文 ($\\mathrm{K}$)。在使用集合卡尔曼滤波器 (EnKF) 进行分析步骤后，分析状态被建模为一个高斯随机向量，其均值为 $ \\mu_{a} \\in \\mathbb{R}^{3} $，协方差为 $ P_{a} \\in \\mathbb{R}^{3 \\times 3} $。随后的预报步骤由一个带有加性模型误差的线性状态转移所控制，\n$$\nx_{f} = M x_{a} + \\eta,\n$$\n其中 $M \\in \\mathbb{R}^{3 \\times 3}$ 是一个已知的线性算子，模型误差 $\\eta$ 是一个与 $x_{a}$ 独立的零均值高斯随机向量，其协方差为 $Q \\in \\mathbb{R}^{3 \\times 3}$。\n\n现提供以下具体数值：\n$$\n\\mu_{a} = \\begin{pmatrix} 0.5 \\\\ -0.3 \\\\ 0.2 \\end{pmatrix} \\quad \\text{(in } \\mathrm{K} \\text{)},\n$$\n$$\nP_{a} = \\begin{pmatrix}\n0.20  0.05  0.02 \\\\\n0.05  0.25  -0.03 \\\\\n0.02  -0.03  0.15\n\\end{pmatrix} \\quad \\text{(in } \\mathrm{K}^{2} \\text{)},\n$$\n$$\nM = \\begin{pmatrix}\n0.90  0  0 \\\\\n0  0.85  0 \\\\\n0  0  0.80\n\\end{pmatrix},\n$$\n$$\nQ = \\begin{pmatrix}\n0.04  0.01  0 \\\\\n0.01  0.05  0.005 \\\\\n0  0.005  0.03\n\\end{pmatrix} \\quad \\text{(in } \\mathrm{K}^{2} \\text{)}.\n$$\n\n从高斯随机变量线性变换的基本定义以及期望和协方差的性质出发，推导上述模型所隐含的预报均值 $ \\mu_{f} $ 和预报协方差 $ P_{f} $。然后计算标量度量\n$$\nJ \\equiv \\| \\mu_{f} \\|_{2}^{2} + \\operatorname{tr}(P_{f}),\n$$\n其中 $ \\| \\cdot \\|_{2} $ 表示欧几里得范数，$ \\operatorname{tr}(\\cdot) $ 表示迹算子。以 $\\mathrm{K}^{2}$ 为单位表示 $J$，并将最终数值答案四舍五入到四位有效数字。",
            "solution": "预报状态 $x_f$ 是分析状态 $x_a$ 的线性变换加上一个加性噪声项 $\\eta$：\n$$\nx_f = M x_a + \\eta\n$$\n分析状态 $x_a$ 是一个随机向量，其均值为 $E[x_a] = \\mu_a$，协方差为 $\\text{Cov}(x_a) = P_a$。模型误差 $\\eta$ 是一个随机向量，其均值为 $E[\\eta] = 0$，协方差为 $\\text{Cov}(\\eta) = Q$。状态 $x_a$ 和误差 $\\eta$ 是独立的。\n\n首先，我们推导预报均值 $\\mu_f = E[x_f]$。利用期望算子的线性性：\n$$\n\\mu_f = E[M x_a + \\eta] = E[M x_a] + E[\\eta]\n$$\n由于 $M$ 是一个常数矩阵，$E[M x_a] = M E[x_a] = M \\mu_a$。已知模型误差是零均值的，所以 $E[\\eta]=0$。\n因此，预报均值为：\n$$\n\\mu_f = M \\mu_a\n$$\n代入给定的数值：\n$$\n\\mu_f = \\begin{pmatrix} 0.90  0  0 \\\\ 0  0.85  0 \\\\ 0  0  0.80 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ -0.3 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} (0.90)(0.5) \\\\ (0.85)(-0.3) \\\\ (0.80)(0.2) \\end{pmatrix} = \\begin{pmatrix} 0.45 \\\\ -0.255 \\\\ 0.16 \\end{pmatrix} \\, \\mathrm{K}\n$$\n\n接下来，我们推导预报协方差 $P_f = \\text{Cov}(x_f)$。协方差的定义是 $P_f = E[(x_f - \\mu_f)(x_f - \\mu_f)^T]$。\n代入 $x_f$ 和 $\\mu_f$ 的表达式：\n$$\nx_f - \\mu_f = (M x_a + \\eta) - (M \\mu_a) = M(x_a - \\mu_a) + \\eta\n$$\n所以，协方差变为：\n$$\nP_f = E[ (M(x_a - \\mu_a) + \\eta) (M(x_a - \\mu_a) + \\eta)^T ]\n$$\n展开乘积：\n$$\nP_f = E[ M(x_a - \\mu_a)(x_a - \\mu_a)^T M^T + M(x_a - \\mu_a)\\eta^T + \\eta(x_a - \\mu_a)^T M^T + \\eta\\eta^T ]\n$$\n根据期望的线性性，我们可以对每一项取期望：\n$$\nP_f = E[M(x_a - \\mu_a)(x_a - \\mu_a)^T M^T] + E[M(x_a - \\mu_a)\\eta^T] + E[\\eta(x_a - \\mu_a)^T M^T] + E[\\eta\\eta^T]\n$$\n第一项是 $M E[(x_a - \\mu_a)(x_a - \\mu_a)^T] M^T = M P_a M^T$。\n最后一项是 $E[\\eta\\eta^T] = E[(\\eta - 0)(\\eta - 0)^T] = Q$。\n中间的两项是互协方差项。因为 $x_a$ 和 $\\eta$ 是独立的，所以 $\\text{Cov}(x_a, \\eta) = E[(x_a - \\mu_a)(\\eta-0)^T] = E[x_a - \\mu_a]E[\\eta^T] = 0 \\cdot 0^T = 0$。因此，$E[M(x_a - \\mu_a)\\eta^T] = M \\text{Cov}(x_a, \\eta) = 0$ 且其转置 $E[\\eta(x_a - \\mu_a)^T M^T] = \\text{Cov}(\\eta, x_a)M^T=0$。\n这将预报协方差的表达式简化为：\n$$\nP_f = M P_a M^T + Q\n$$\n我们现在进行数值计算。首先，我们计算 $M P_a M^T$。由于 $M$ 是对角矩阵，$M^T=M$。\n$$\nM P_a M^T = \\begin{pmatrix} 0.9  0  0 \\\\ 0  0.85  0 \\\\ 0  0  0.8 \\end{pmatrix} \\begin{pmatrix} 0.20  0.05  0.02 \\\\ 0.05  0.25  -0.03 \\\\ 0.02  -0.03  0.15 \\end{pmatrix} \\begin{pmatrix} 0.9  0  0 \\\\ 0  0.85  0 \\\\ 0  0  0.8 \\end{pmatrix}\n$$\n$$\nM P_a M^T = \\begin{pmatrix} 0.9^2(0.20)  0.9(0.85)(0.05)  0.9(0.8)(0.02) \\\\ 0.85(0.9)(0.05)  0.85^2(0.25)  0.85(0.8)(-0.03) \\\\ 0.8(0.9)(0.02)  0.8(0.85)(-0.03)  0.8^2(0.15) \\end{pmatrix}\n$$\n$$\nM P_a M^T = \\begin{pmatrix} 0.81(0.20)  0.765(0.05)  0.72(0.02) \\\\ 0.765(0.05)  0.7225(0.25)  0.68(-0.03) \\\\ 0.72(0.02)  0.68(-0.03)  0.64(0.15) \\end{pmatrix} = \\begin{pmatrix} 0.162  0.03825  0.0144 \\\\ 0.03825  0.180625  -0.0204 \\\\ 0.0144  -0.0204  0.096 \\end{pmatrix}\n$$\n现在我们加上模型误差协方差 $Q$：\n$$\nP_f = \\begin{pmatrix} 0.162  0.03825  0.0144 \\\\ 0.03825  0.180625  -0.0204 \\\\ 0.0144  -0.0204  0.096 \\end{pmatrix} + \\begin{pmatrix} 0.04  0.01  0 \\\\ 0.01  0.05  0.005 \\\\ 0  0.005  0.03 \\end{pmatrix}\n$$\n$$\nP_f = \\begin{pmatrix} 0.202  0.04825  0.0144 \\\\ 0.04825  0.230625  -0.0154 \\\\ 0.0144  -0.0154  0.126 \\end{pmatrix} \\, \\mathrm{K}^2\n$$\n题目要求计算度量 $J = \\| \\mu_f \\|_2^2 + \\operatorname{tr}(P_f)$。\n首先，我们计算预报均值的欧几里得范数的平方：\n$$\n\\| \\mu_f \\|_2^2 = (0.45)^2 + (-0.255)^2 + (0.16)^2 = 0.2025 + 0.065025 + 0.0256 = 0.293125 \\, \\mathrm{K}^2\n$$\n接下来，我们计算预报协方差矩阵的迹：\n$$\n\\operatorname{tr}(P_f) = 0.202 + 0.230625 + 0.126 = 0.558625 \\, \\mathrm{K}^2\n$$\n最后，我们将这两个量相加得到 $J$：\n$$\nJ = 0.293125 + 0.558625 = 0.85175 \\, \\mathrm{K}^2\n$$\n题目要求最终答案四舍五入到四位有效数字。\n$$\nJ \\approx 0.8518 \\, \\mathrm{K}^2\n$$",
            "answer": "$$\n\\boxed{0.8518}\n$$"
        },
        {
            "introduction": "尽管经典卡尔曼滤波器提供了精确解，但其对巨大协方差矩阵的传播依赖在大型环境模型中通常计算上是不可行的。集合卡尔曼滤波器 (EnKF) 通过用有限的模式状态集合来近似统计量，提供了一种实用的解决方案。本练习提供了一个具体、分步的随机EnKF分析更新过程，阐释了如何使用集合来估计必要的统计数据并同化观测 。",
            "id": "3878336",
            "problem": "考虑一个一维环境状态变量，例如流域平均的土壤湿度异常，由一个集合 $\\{x_{b}^{(i)}\\}_{i=1}^{3} = \\{0.8, 1.0, 1.2\\}$ 表示，该集合近似于给定时间状态的高斯先验（背景）。一个单一的原位观测值 $y = 1.1$ 可用，其线性观测算子为 $H = 1$，观测误差建模为零均值高斯分布，方差为 $R = 0.2$。在线性高斯设定下，使用集合卡尔曼滤波器（EnKF）的随机公式，从贝叶斯线性高斯框架的第一性原理出发，推导分析更新。其中，分析均值和方差由卡尔曼更新得出，该更新以集合估计的先验统计量和扰动观测值表示。\n\n为确保随机 EnKF 更新的确定性，使用以下特定的观测扰动（每个扰动均独立地从方差为 $R$ 的零均值高斯分布中抽取）：$\\epsilon^{(1)} = 0.3$, $\\epsilon^{(2)} = -0.3$ 和 $\\epsilon^{(3)} = 0.0$，因此扰动观测值为 $y^{(i)} = y + \\epsilon^{(i)}$，其中 $i = 1,2,3$。使用无偏除数 $N-1$（其中 $N=3$）来处理集合样本方差。\n\n计算得到的分析集合成员，然后计算分析集合均值和分析集合样本方差。将最终答案表示为一个由分析均值和分析方差组成的对。不需要四舍五入，如果自然出现，可以表示为精确的有理数值。答案必须使用 LaTeX 的 $\\texttt{pmatrix}$ 格式报告为单行向量，其中的条目按 $\\{$分析均值$, $分析方差$\\}$ 的顺序排列，且不带单位。",
            "solution": "解答过程从线性高斯背景下的贝叶斯推断的第一性原理出发，这是卡尔曼滤波器以及引申出的集合卡尔曼滤波器的理论基础。\n\n在贝叶斯框架中，分析（后验）概率密度函数 $p(x|y)$ 与先验（背景）密度 $p(x)$ 和似然 $p(y|x)$ 的乘积成正比：\n$$p(x|y) \\propto p(y|x) p(x)$$\n对于线性高斯系统，先验是均值为 $\\mu_b$、方差为 $P_b$ 的高斯分布，记为 $\\mathcal{N}(x | \\mu_b, P_b)$。观测值 $y$ 通过线性算子 $H$ 与状态 $x$ 相关，并受到方差为 $R$ 的零均值高斯噪声的污染。因此，似然为 $p(y|x) = \\mathcal{N}(y | Hx, R)$。得到的后验分布也是高斯分布，$p(x|y) = \\mathcal{N}(x | \\mu_a, P_a)$，其分析均值 $\\mu_a$ 和分析方差 $P_a$ 由卡尔曼滤波器方程给出：\n$$\\mu_a = \\mu_b + K(y - H\\mu_b)$$\n$$P_a = (1 - KH)P_b$$\n其中卡尔曼增益 $K$ 为：\n$$K = P_b H^T (H P_b H^T + R)^{-1}$$\n\n集合卡尔曼滤波器（EnKF）使用预报集合 $\\{x_{b}^{(i)}\\}_{i=1}^{N}$ 的样本统计量来近似先验统计量 $\\mu_b$ 和 $P_b$。\n\n**步骤1：根据集合计算先验统计量**\n先验集合为 $\\{x_{b}^{(i)}\\}_{i=1}^{3} = \\{0.8, 1.0, 1.2\\}$。集合大小为 $N=3$。\n集合均值 $\\bar{x}_b$ 估计了先验均值 $\\mu_b$：\n$$\\bar{x}_b = \\frac{1}{N} \\sum_{i=1}^{N} x_b^{(i)} = \\frac{1}{3}(0.8 + 1.0 + 1.2) = \\frac{3.0}{3} = 1.0$$\n集合样本方差 $\\hat{P}_b$ 估计了先验方差 $P_b$。使用无偏除数 $N-1$：\n$$\\hat{P}_b = \\frac{1}{N-1} \\sum_{i=1}^{N} (x_b^{(i)} - \\bar{x}_b)^2 = \\frac{1}{2} \\left[ (0.8 - 1.0)^2 + (1.0 - 1.0)^2 + (1.2 - 1.0)^2 \\right]$$\n$$\\hat{P}_b = \\frac{1}{2} \\left[ (-0.2)^2 + 0^2 + (0.2)^2 \\right] = \\frac{1}{2} [0.04 + 0 + 0.04] = \\frac{0.08}{2} = 0.04$$\n\n**步骤2：计算集合卡尔曼增益**\n卡尔曼增益 $\\hat{K}$ 使用样本方差 $\\hat{P}_b$ 以及给定的观测算子 $H=1$ 和观测误差方差 $R=0.2$ 来计算：\n$$\\hat{K} = \\hat{P}_b H (H \\hat{P}_b H + R)^{-1} = \\frac{\\hat{P}_b}{H^2 \\hat{P}_b + R}$$\n$$\\hat{K} = \\frac{0.04}{1^2 \\cdot 0.04 + 0.2} = \\frac{0.04}{0.04 + 0.2} = \\frac{0.04}{0.24} = \\frac{4}{24} = \\frac{1}{6}$$\n\n**步骤3：更新每个集合成员**\n随机 EnKF 使用唯一的扰动观测值 $y^{(i)} = y + \\epsilon^{(i)}$ 来更新每个成员。第 $i$ 个成员的更新方程为：\n$$x_a^{(i)} = x_b^{(i)} + \\hat{K} (y^{(i)} - H x_b^{(i)})$$\n给定观测值 $y=1.1$ 和扰动 $\\{\\epsilon^{(i)}\\} = \\{0.3, -0.3, 0.0\\}$，扰动观测值为：\n$$y^{(1)} = 1.1 + 0.3 = 1.4$$\n$$y^{(2)} = 1.1 - 0.3 = 0.8$$\n$$y^{(3)} = 1.1 + 0.0 = 1.1$$\n现在我们更新每个成员，使用 $H=1$ 和 $\\hat{K}=1/6$：\n对于 $i=1$：\n$$x_a^{(1)} = x_b^{(1)} + \\hat{K} (y^{(1)} - x_b^{(1)}) = 0.8 + \\frac{1}{6}(1.4 - 0.8) = 0.8 + \\frac{0.6}{6} = 0.8 + 0.1 = 0.9$$\n对于 $i=2$：\n$$x_a^{(2)} = x_b^{(2)} + \\hat{K} (y^{(2)} - x_b^{(2)}) = 1.0 + \\frac{1}{6}(0.8 - 1.0) = 1.0 + \\frac{-0.2}{6} = 1.0 - \\frac{1}{30} = \\frac{29}{30}$$\n对于 $i=3$：\n$$x_a^{(3)} = x_b^{(3)} + \\hat{K} (y^{(3)} - x_b^{(3)}) = 1.2 + \\frac{1}{6}(1.1 - 1.2) = 1.2 + \\frac{-0.1}{6} = 1.2 - \\frac{1}{60} = \\frac{72}{60} - \\frac{1}{60} = \\frac{71}{60}$$\n得到的分析集合为 $\\{x_a^{(i)}\\} = \\{0.9, \\frac{29}{30}, \\frac{71}{60}\\}$。\n\n**步骤4：计算分析集合的均值和方差**\n分析均值 $\\bar{x}_a$ 是分析集合成员的平均值。为了计算它，我们将所有成员表示为以60为公分母的分数：$0.9 = \\frac{9}{10} = \\frac{54}{60}$，$\\frac{29}{30} = \\frac{58}{60}$。\n$$\\bar{x}_a = \\frac{1}{3} \\left( \\frac{54}{60} + \\frac{58}{60} + \\frac{71}{60} \\right) = \\frac{1}{3} \\left( \\frac{54 + 58 + 71}{60} \\right) = \\frac{1}{3} \\left( \\frac{183}{60} \\right) = \\frac{61}{60}$$\n分析样本方差 $\\hat{P}_a$ 从分析集合计算得出：\n$$\\hat{P}_a = \\frac{1}{N-1} \\sum_{i=1}^{N} (x_a^{(i)} - \\bar{x}_a)^2$$\n首先，计算与分析均值 $\\bar{x}_a = 61/60$ 的偏差：\n$$x_a^{(1)} - \\bar{x}_a = \\frac{54}{60} - \\frac{61}{60} = -\\frac{7}{60}$$\n$$x_a^{(2)} - \\bar{x}_a = \\frac{58}{60} - \\frac{61}{60} = -\\frac{3}{60}$$\n$$x_a^{(3)} - \\bar{x}_a = \\frac{71}{60} - \\frac{61}{60} = \\frac{10}{60}$$\n_偏差之和：$(-\\frac{7}{60}) + (-\\frac{3}{60}) + (\\frac{10}{60}) = 0$，符合预期。_\n现在，计算偏差的平方和：\n$$\\sum (x_a^{(i)} - \\bar{x}_a)^2 = \\left(-\\frac{7}{60}\\right)^2 + \\left(-\\frac{3}{60}\\right)^2 + \\left(\\frac{10}{60}\\right)^2$$\n$$= \\frac{49}{3600} + \\frac{9}{3600} + \\frac{100}{3600} = \\frac{49+9+100}{3600} = \\frac{158}{3600}$$\n最后，使用除数 $N-1=2$ 计算样本方差：\n$$\\hat{P}_a = \\frac{1}{2} \\left( \\frac{158}{3600} \\right) = \\frac{79}{3600}$$\n分析均值为 $\\frac{61}{60}$，分析方差为 $\\frac{79}{3600}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{61}{60}  \\frac{79}{3600}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}