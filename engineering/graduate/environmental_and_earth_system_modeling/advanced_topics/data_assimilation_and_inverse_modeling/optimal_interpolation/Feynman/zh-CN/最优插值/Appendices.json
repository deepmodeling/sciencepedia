{
    "hands_on_practices": [
        {
            "introduction": "最优插值通过结合模型的背景估计和新的观测，为减少不确定性提供了一种形式化的方法。这个基础练习将指导你完成分析误差方差的核心计算，该方差量化了估计场的后验不确定性。通过这个具体的例子，你将在一个真实的海洋学场景中，获得应用最佳线性无偏估计（BLUE）框架的实践经验。",
            "id": "3805220",
            "problem": "考虑一个表示海表温度异常的零均值、平稳高斯随机场，记为$x(\\mathbf{x})$，其各向同性协方差函数为$C(r) = \\sigma^{2}\\exp(-r/L)$，其中$r$是水平距离，$\\sigma^{2}$是先验方差，$L$是相关长度尺度。您希望使用线性客观分析（最优插值）在分析点$\\mathbf{x}_0$处估计$x(\\mathbf{x}_0)$，该方法是基于一组点观测构建的$x(\\mathbf{x}_0)$的最佳线性无偏估计。\n\n在位置$\\mathbf{x}_1$和$\\mathbf{x}_2$处，分别获得了同一异常场的两个独立标量观测$y_1$和$y_2$。每个观测都受到加性、独立、零均值的测量噪声的污染，其已知方差为$\\mathrm{Var}(\\epsilon_1) = r_1$和$\\mathrm{Var}(\\epsilon_2) = r_2$，且测量误差之间没有交叉协方差。假设误差与信号$x(\\mathbf{x})$不相关。\n\n给定以下科学上合理的参数：\n- 先验方差$\\sigma^{2} = 1.2$（单位$^{\\circ}\\mathrm{C}^{2}$）。\n- 相关长度$L = 60\\,\\mathrm{km}$。\n- 距分析点的距离：$r_1 = 30\\,\\mathrm{km}$和$r_2 = 60\\,\\mathrm{km}$。\n- 两个观测点之间的距离：$d_{12} = 90\\,\\mathrm{km}$。\n- 测量误差方差：$r_1 = r_2 = 0.09$（单位$^{\\circ}\\mathrm{C}^{2}$）。\n\n从带有加性测量噪声的高斯随机场的最佳线性无偏估计的定义出发，推导由最优插值产生的、在$\\mathbf{x}_0$点的后验分析误差方差的表达式，该表达式用先验协方差和数据协方差表示。然后，对上述给定的配置，数值计算该后验方差。请根据所述的协方差模型和距离，清楚地标明您计算的所有中间量（例如信号-数据协方差向量和数据协方差矩阵）。\n\n将您的最终答案表示为一个单位为$^{\\circ}\\mathrm{C}^{2}$的实数，并将结果四舍五入到四位有效数字。简要地物理解释该量，作为在同化两个观测后分析点的后验不确定性。",
            "solution": "该问题具有科学依据、是适定的、客观的，并包含足够的信息以得到唯一解。注意到符号$r_1$和$r_2$同时用于表示距离和误差方差，存在符号歧义；然而，从物理单位和上下文中可以清楚地看出其意图。为避免在推导中产生混淆，从分析点$\\mathbf{x}_0$到观测点$\\mathbf{x}_1$和$\\mathbf{x}_2$的距离将分别用$d_{01}$和$d_{02}$表示。测量误差方差将按照题目陈述用$r_1$和$r_2$表示。\n\n目标是求出在位置$\\mathbf{x}_0$的后验分析误差方差，记为$\\sigma_a^2$。对于作为最优插值（OI）基础的最佳线性无偏估计（BLUE），分析误差方差由以下表达式给出：\n$$\n\\sigma_a^2 = \\sigma_b^2 - \\mathbf{k}^T \\mathbf{C}_{yy}^{-1} \\mathbf{k}\n$$\n此处，$\\sigma_b^2$是分析点的先验（背景）误差方差，$\\mathbf{k}$是分析点真实状态与观测值之间的协方差向量，而$\\mathbf{C}_{yy}$是观测值的总协方差矩阵。\n\n我们现在来确定此方程的各个分量。\n\n1.  **先验方差 ($\\sigma_b^2$)**\n    分析点$\\mathbf{x}_0$处的先验方差即为场本身的方差，在零距离处计算得到，因为没有其他先验信息。\n    $$\n    \\sigma_b^2 = \\mathrm{Var}(x(\\mathbf{x}_0)) = C(0) = \\sigma^2 \\exp(-0/L) = \\sigma^2\n    $$\n    给定$\\sigma^2 = 1.2\\,^{\\circ}\\mathrm{C}^2$，我们有$\\sigma_b^2 = 1.2$。\n\n2.  **信号-数据协方差向量 ($\\mathbf{k}$)**\n    该向量包含分析点$x(\\mathbf{x}_0)$处的场真实值与每个观测值$y_1$和$y_2$之间的协方差。$\\mathbf{k}$的第$i$个元素是$k_i = \\mathrm{Cov}(x(\\mathbf{x}_0), y_i)$。\n    由于$y_i = x(\\mathbf{x}_i) + \\epsilon_i$且测量噪声$\\epsilon_i$与信号$x$不相关，这可以简化为：\n    $$\n    k_i = \\mathrm{Cov}(x(\\mathbf{x}_0), x(\\mathbf{x}_i) + \\epsilon_i) = \\mathrm{Cov}(x(\\mathbf{x}_0), x(\\mathbf{x}_i)) + \\mathrm{Cov}(x(\\mathbf{x}_0), \\epsilon_i) = C(d_{0i}) + 0\n    $$\n    其中$d_{0i}$是$\\mathbf{x}_0$和$\\mathbf{x}_i$之间的距离。因此向量$\\mathbf{k}$为：\n    $$\n    \\mathbf{k} = \\begin{pmatrix} C(d_{01}) \\\\ C(d_{02}) \\end{pmatrix} = \\begin{pmatrix} \\sigma^2 \\exp(-d_{01}/L) \\\\ \\sigma^2 \\exp(-d_{02}/L) \\end{pmatrix}\n    $$\n    使用给定值$d_{01} = 30\\,\\mathrm{km}$，$d_{02} = 60\\,\\mathrm{km}$，$L = 60\\,\\mathrm{km}$和$\\sigma^2 = 1.2$：\n    $$\n    k_1 = 1.2 \\exp(-30/60) = 1.2 \\exp(-0.5)\n    $$\n    $$\n    k_2 = 1.2 \\exp(-60/60) = 1.2 \\exp(-1)\n    $$\n    数值上，$k_1 \\approx 0.727837\\,^{\\circ}\\mathrm{C}^2$且$k_2 \\approx 0.441455\\,^{\\circ}\\mathrm{C}^2$。\n\n3.  **数据协方差矩阵 ($\\mathbf{C}_{yy}$)**\n    该矩阵表示观测向量$\\mathbf{y} = (y_1, y_2)^T$的总协方差。它是信号协方差矩阵$\\mathbf{C}_{xx}$和测量误差协方差矩阵$\\mathbf{R}$的和：\n    $$\n    \\mathbf{C}_{yy} = \\mathbf{C}_{xx} + \\mathbf{R}\n    $$\n    信号协方差矩阵的元素是$(\\mathbf{C}_{xx})_{ij} = \\mathrm{Cov}(x(\\mathbf{x}_i), x(\\mathbf{x}_j)) = C(d_{ij})$，其中$d_{ij}$是观测点$\\mathbf{x}_i$和$\\mathbf{x}_j$之间的距离。\n    $$\n    \\mathbf{C}_{xx} = \\begin{pmatrix} C(0)  C(d_{12}) \\\\ C(d_{21})  C(0) \\end{pmatrix} = \\begin{pmatrix} \\sigma^2  \\sigma^2 \\exp(-d_{12}/L) \\\\ \\sigma^2 \\exp(-d_{12}/L)  \\sigma^2 \\end{pmatrix}\n    $$\n    测量误差是独立的，所以它们的协方差矩阵$\\mathbf{R}$是对角矩阵：\n    $$\n    \\mathbf{R} = \\begin{pmatrix} \\mathrm{Var}(\\epsilon_1)  0 \\\\ 0  \\mathrm{Var}(\\epsilon_2) \\end{pmatrix} = \\begin{pmatrix} r_1  0 \\\\ 0  r_2 \\end{pmatrix}\n    $$\n    将这些结合起来得到：\n    $$\n    \\mathbf{C}_{yy} = \\begin{pmatrix} \\sigma^2 + r_1  \\sigma^2 \\exp(-d_{12}/L) \\\\ \\sigma^2 \\exp(-d_{12}/L)  \\sigma^2 + r_2 \\end{pmatrix}\n    $$\n    使用给定值$d_{12} = 90\\,\\mathrm{km}$，$L=60\\,\\mathrm{km}$，$\\sigma^2=1.2$和$r_1 = r_2 = 0.09$：\n    - 对角元素：$\\sigma^2 + r_1 = 1.2 + 0.09 = 1.29$。\n    - 非对角元素：$\\sigma^2 \\exp(-90/60) = 1.2 \\exp(-1.5)$。\n    所以，该矩阵为：\n    $$\n    \\mathbf{C}_{yy} = \\begin{pmatrix} 1.29  1.2 \\exp(-1.5) \\\\ 1.2 \\exp(-1.5)  1.29 \\end{pmatrix}\n    $$\n    数值上，$1.2 \\exp(-1.5) \\approx 0.267756$，所以$\\mathbf{C}_{yy} \\approx \\begin{pmatrix} 1.29  0.267756 \\\\ 0.267756  1.29 \\end{pmatrix}$。\n\n4.  **最终计算**\n    我们需要计算方差减小项$\\Delta\\sigma^2 = \\mathbf{k}^T \\mathbf{C}_{yy}^{-1} \\mathbf{k}$。\n    首先，我们求$2 \\times 2$矩阵$\\mathbf{C}_{yy}$的逆矩阵。\n    其行列式为$\\det(\\mathbf{C}_{yy}) = (1.29)^2 - (1.2 \\exp(-1.5))^2 = 1.6641 - (1.44 \\exp(-3))$。\n    $\\det(\\mathbf{C}_{yy}) \\approx 1.6641 - 1.44 \\times 0.049787 = 1.6641 - 0.071693 = 1.592407$。\n    其逆矩阵为：\n    $$\n    \\mathbf{C}_{yy}^{-1} = \\frac{1}{\\det(\\mathbf{C}_{yy})} \\begin{pmatrix} 1.29  -1.2 \\exp(-1.5) \\\\ -1.2 \\exp(-1.5)  1.29 \\end{pmatrix}\n    $$\n    二次型$\\Delta\\sigma^2 = \\mathbf{k}^T \\mathbf{C}_{yy}^{-1} \\mathbf{k}$为：\n    $$\n    \\Delta\\sigma^2 = \\frac{1}{\\det(\\mathbf{C}_{yy})} \\left[ 1.29(k_1^2 + k_2^2) - 2 \\cdot (1.2 \\exp(-1.5)) \\cdot k_1 k_2 \\right]\n    $$\n    代入$k_1$和$k_2$的表达式：\n    $k_1^2 = (1.2 \\exp(-0.5))^2 = 1.44 \\exp(-1)$\n    $k_2^2 = (1.2 \\exp(-1))^2 = 1.44 \\exp(-2)$\n    $k_1 k_2 = (1.2 \\exp(-0.5)) (1.2 \\exp(-1)) = 1.44 \\exp(-1.5)$\n    $\\Delta\\sigma^2$的分子：\n    $1.29 \\left( 1.44 \\exp(-1) + 1.44 \\exp(-2) \\right) - 2 \\cdot (1.2 \\exp(-1.5)) \\cdot (1.44 \\exp(-1.5))$\n    $= 1.8576 (\\exp(-1) + \\exp(-2)) - 3.456 \\exp(-3)$\n    使用数值：\n    $k_1 \\approx 0.727837$, $k_2 \\approx 0.441455$, $1.2 \\exp(-1.5) \\approx 0.267756$。\n    $k_1^2 \\approx 0.529727$, $k_2^2 \\approx 0.194883$。\n    $k_1 k_2 \\approx 0.321303$。\n    分子$\\approx 1.29(0.529727 + 0.194883) - 2(0.267756)(0.321303)$\n    $\\approx 1.29(0.724610) - 0.172061 \\approx 0.934747 - 0.172061 = 0.762686$。\n    $\\Delta\\sigma^2 \\approx \\frac{0.762686}{1.592407} \\approx 0.479002 \\,^{\\circ}\\mathrm{C}^2$。\n\n    最后，后验分析误差方差是：\n    $$\n    \\sigma_a^2 = \\sigma_b^2 - \\Delta\\sigma^2 \\approx 1.2 - 0.479002 = 0.720998 \\,^{\\circ}\\mathrm{C}^2\n    $$\n    四舍五入到四位有效数字，我们得到$\\sigma_a^2 = 0.7210 \\,^{\\circ}\\mathrm{C}^2$。\n\n该结果的物理解释是，分析点处海表温度异常的初始不确定性（由先验方差$\\sigma_b^2 = 1.2\\,^{\\circ}\\mathrm{C}^2$表示）通过同化两个观测而减小了。后验方差$\\sigma_a^2 \\approx 0.7210\\,^{\\circ}\\mathrm{C}^2$是最优估计的期望平方误差。它量化了在并入数据信息后剩余的不确定性。该值的平方根$\\sqrt{\\sigma_a^2} \\approx 0.849\\,^{\\circ}\\mathrm{C}$是最终分析的期望均方根误差。",
            "answer": "$$\n\\boxed{0.7210}\n$$"
        },
        {
            "introduction": "任何数据同化系统的性能都关键地取决于其统计假设的准确性，特别是误差方差。本练习探讨了一个关键的“假设”情景：当观测误差方差被低估时会发生什么？通过解析推导，你将揭示“过拟合”的概念，即系统对观测变得过度自信，导致分析结果看起来比实际更优。",
            "id": "3903515",
            "problem": "考虑一个用于环境和地球系统建模的一维数据同化场景，其中应用最优插值 (OI) 来估计一个地球物理标量状态$x$。设背景（先验）状态$x_{b}$是$x$的一个无偏估计量，其背景误差$x - x_{b}$被建模为一个零均值高斯随机变量，方差为$\\sigma_{b}^{2}$。从线性测量模型$y = x + \\varepsilon$中获得单个观测$y$，其中真实观测误差$\\varepsilon$是一个零均值高斯随机变量，方差为$\\sigma_{r}^{2}$，且与背景误差无关。OI 分析估计量采用线性形式$x_{a} = x_{b} + K(y - x_{b})$，其中增益$K$的选择是为了在假定的误差统计下最小化均方分析误差。\n\n假设数据同化系统低估了观测误差方差，并在构建增益时使用假定值$R_{\\text{assumed}} = \\alpha\\sigma_{r}^{2}$（其中$0  \\alpha  1$）而不是真实值$R_{\\text{true}} = \\sigma_{r}^{2}$。从高斯条件化和线性最小方差估计原理出发，完成以下任务：\n\n1. 在假定$R_{\\text{assumed}} = \\alpha\\sigma_{r}^{2}$下，推导最小化均方分析误差的 OI 增益$K(\\alpha)$，并证明$K(\\alpha)$随$\\alpha$的减小而增大。利用此结果证明，当$R$被低估时，分析增量$d \\equiv x_{a} - x_{b}$的期望平方大小比$R$正确时更大。\n\n2. 当增益使用低估的$R_{\\text{assumed}} = \\alpha\\sigma_{r}^{2}$计算，但现实世界遵循真实观测误差方差$R_{\\text{true}} = \\sigma_{r}^{2}$时，计算分析误差的真实方差$A(\\alpha) \\equiv \\operatorname{Var}(x_{a} - x)$。请用$\\sigma_{b}^{2}$、$\\sigma_{r}^{2}$和$\\alpha$表示$A(\\alpha)$。\n\n3. 在正确模型$R_{\\text{true}} = \\sigma_{r}^{2}$下，计算真实后验方差$A_{\\text{true}} \\equiv \\operatorname{Var}(x \\mid y)$。\n\n4. 定义过拟合因子为在低估的$R$下分析误差协方差的迹与真实后验方差之比，在本标量情况下，该比率简化为$\\gamma(\\alpha) \\equiv \\frac{A(\\alpha)}{A_{\\text{true}}}$。请提供$\\gamma(\\alpha)$作为$\\sigma_{b}^{2}$、$\\sigma_{r}^{2}$和$\\alpha$的函数的闭式解析表达式，并证明对于$0  \\alpha  1$，该值超过$1$。\n\n你的最终答案必须是$\\gamma(\\alpha)$的单个闭式表达式。不需要数值；由于最终答案是符号化且无量纲的，因此无需四舍五入。",
            "solution": "问题陈述已经过验证，被认为在线性估计理论和数据同化的标准框架内是合理、适定且有科学依据的。我们可以开始解题。\n\n分析状态$x_{a}$是背景状态$x_{b}$和观测$y$的线性组合。分析误差定义为$e_{a} \\equiv x_{a} - x$，其中$x$是真实状态。给定分析方程$x_{a} = x_{b} + K(y - x_{b})$。我们可以用背景误差$e_{b} \\equiv x_{b} - x$和观测误差$\\varepsilon \\equiv y - x$来表示分析误差。\n首先，重写新息项$y - x_{b}$：\n$$y - x_{b} = (x + \\varepsilon) - x_{b} = \\varepsilon - (x_{b} - x) = \\varepsilon - e_{b}$$\n现在将此代入$x_{a}$的表达式中：\n$$x_{a} = x_{b} + K(\\varepsilon - e_{b})$$\n分析误差则为：\n$$e_{a} = x_{a} - x = (x_{b} - x) + K(\\varepsilon - e_{b}) = e_{b} + K(\\varepsilon - e_{b}) = (1-K)e_{b} + K\\varepsilon$$\n背景误差和观测误差是给定的零均值随机变量，$E[e_{b}] = 0$和$E[\\varepsilon] = 0$。期望分析误差为：\n$$E[e_{a}] = E[(1-K)e_{b} + K\\varepsilon] = (1-K)E[e_{b}] + K E[\\varepsilon] = 0$$\n由于分析是无偏的，均方分析误差等于其方差，$\\operatorname{Var}(e_{a}) = E[e_{a}^{2}]$。由于误差$e_{b}$和$\\varepsilon$是独立的，$E[e_{b}\\varepsilon] = E[e_{b}]E[\\varepsilon]=0$。方差为：\n$$E[e_{a}^{2}] = E[((1-K)e_{b} + K\\varepsilon)^{2}] = (1-K)^{2}E[e_{b}^{2}] + K^{2}E[\\varepsilon^{2}] + 2K(1-K)E[e_{b}\\varepsilon]$$\n$$E[e_{a}^{2}] = (1-K)^{2}\\sigma_{b}^{2} + K^{2}\\sigma_{r}^{2}$$\n其中$\\sigma_{b}^{2} = \\operatorname{Var}(e_{b})$且$\\sigma_{r}^{2} = \\operatorname{Var}(\\varepsilon)$。\n\n### 第1部分：增益 $K(\\alpha)$ 和分析增量的推导\n\nOI 增益是通过在*假定*的误差统计下最小化均方分析误差来计算的。系统假定观测误差方差为$R_{\\text{assumed}} = \\alpha\\sigma_{r}^{2}$。因此，选择增益$K(\\alpha)$来最小化成本函数$J_{\\text{assumed}}(K)$：\n$$J_{\\text{assumed}}(K) = (1-K)^{2}\\sigma_{b}^{2} + K^{2}(\\alpha\\sigma_{r}^{2})$$\n为求最小值，我们对$K$求导并令结果为零：\n$$\\frac{dJ_{\\text{assumed}}}{dK} = -2(1-K)\\sigma_{b}^{2} + 2K(\\alpha\\sigma_{r}^{2}) = 0$$\n$$- \\sigma_{b}^{2} + K\\sigma_{b}^{2} + K\\alpha\\sigma_{r}^{2} = 0$$\n$$K(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}) = \\sigma_{b}^{2}$$\n这给出了增益$K(\\alpha)$的表达式：\n$$K(\\alpha) = \\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}}$$\n为证明$K(\\alpha)$随$\\alpha$减小而增大，我们考察其关于$\\alpha$的导数：\n$$\\frac{dK(\\alpha)}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\sigma_{b}^{2} (\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{-1} \\right) = -\\sigma_{b}^{2}(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{-2}(\\sigma_{r}^{2}) = -\\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}}$$\n由于$\\sigma_{b}^{2} > 0$且$\\sigma_{r}^{2} > 0$，对于$\\alpha>0$，导数$\\frac{dK(\\alpha)}{d\\alpha}$总是负的。因此，$K(\\alpha)$是$\\alpha$的一个严格递减函数。当$\\alpha$减小时（即观测更被信任），增益$K(\\alpha)$增大。\n\n分析增量为$d \\equiv x_{a} - x_{b} = K(\\alpha)(y - x_{b})$。增量的期望平方大小是$E[d^2]$。新息$y - x_{b}$的均值为零，其方差使用*真实*统计数据计算：\n$$\\operatorname{Var}(y-x_{b}) = \\operatorname{Var}(\\varepsilon - e_{b}) = \\operatorname{Var}(\\varepsilon) + \\operatorname{Var}(e_{b}) = \\sigma_{r}^{2} + \\sigma_{b}^{2}$$\n期望平方增量为：\n$$E[d^{2}] = E[(K(\\alpha)(y-x_{b}))^{2}] = K(\\alpha)^{2}E[(y-x_{b})^{2}] = K(\\alpha)^{2}(\\sigma_{r}^{2} + \\sigma_{b}^{2})$$\n由于$K(\\alpha)$是$\\alpha$的递减函数，所以$K(\\alpha)^{2}$也是$\\alpha$的递减函数。因此，$E[d^{2}]$是$\\alpha$的递减函数。低估$R$对应于使用$\\alpha  1$。因为$E[d^2]$是$\\alpha$的递减函数，所以对于$\\alpha  1$的$E[d^2]$值大于其在$\\alpha=1$（正确情况）时的值。这证明了当观测误差方差被低估时，分析增量的期望大小更大。\n\n### 第2部分：分析误差的真实方差 $A(\\alpha)$\n\n分析误差的真实方差$A(\\alpha) = \\operatorname{Var}(x_a - x)$是使用次优增益$K(\\alpha)$但使用*真实*误差方差$\\sigma_{b}^{2}$和$\\sigma_{r}^{2}$来计算的。\n根据我们最初的推导，分析误差方差的一般形式是$E[e_{a}^{2}] = (1-K)^{2}\\sigma_{b}^{2} + K^{2}\\sigma_{r}^{2}$。我们代入$K=K(\\alpha)$：\n$$A(\\alpha) = (1-K(\\alpha))^{2}\\sigma_{b}^{2} + K(\\alpha)^{2}\\sigma_{r}^{2}$$\n我们有$K(\\alpha) = \\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}}$和$1 - K(\\alpha) = \\frac{\\alpha\\sigma_{r}^{2}}{\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}}$。将这些代入$A(\\alpha)$的表达式中：\n$$A(\\alpha) = \\left(\\frac{\\alpha\\sigma_{r}^{2}}{\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}}\\right)^{2}\\sigma_{b}^{2} + \\left(\\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}}\\right)^{2}\\sigma_{r}^{2}$$\n$$A(\\alpha) = \\frac{\\alpha^{2}\\sigma_{r}^{4}\\sigma_{b}^{2} + \\sigma_{b}^{4}\\sigma_{r}^{2}}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}} = \\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}(\\alpha^{2}\\sigma_{r}^{2} + \\sigma_{b}^{2})}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}}$$\n\n### 第3部分：真实后验方差 $A_{\\text{true}}$\n\n真实后验方差$A_{\\text{true}} = \\operatorname{Var}(x \\mid y)$是可能的最小分析误差方差，当增益使用正确的观测误差方差（即$\\alpha=1$）计算时达到。我们可以通过计算$A(\\alpha)$在$\\alpha=1$处的值来找到$A_{\\text{true}}$。\n$$A_{\\text{true}} = A(1) = \\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}(1^{2}\\sigma_{r}^{2} + \\sigma_{b}^{2})}{(\\sigma_{b}^{2} + 1\\cdot\\sigma_{r}^{2})^{2}} = \\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}(\\sigma_{r}^{2} + \\sigma_{b}^{2})}{(\\sigma_{b}^{2} + \\sigma_{r}^{2})^{2}}$$\n$$A_{\\text{true}} = \\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}}{\\sigma_{b}^{2} + \\sigma_{r}^{2}}$$\n这是标量最优插值中分析误差方差的标准公式。\n\n### 第4部分：过拟合因子 $\\gamma(\\alpha)$\n\n过拟合因子定义为比率$\\gamma(\\alpha) \\equiv \\frac{A(\\alpha)}{A_{\\text{true}}}$。使用上面推导出的表达式：\n$$\\gamma(\\alpha) = \\frac{\\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}(\\sigma_{b}^{2} + \\alpha^{2}\\sigma_{r}^{2})}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}}}{\\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}}{\\sigma_{b}^{2} + \\sigma_{r}^{2}}}$$\n消去公因子$\\sigma_{b}^{2}\\sigma_{r}^{2}$：\n$$\\gamma(\\alpha) = \\frac{(\\sigma_{b}^{2} + \\alpha^{2}\\sigma_{r}^{2})(\\sigma_{b}^{2} + \\sigma_{r}^{2})}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}}$$\n这是所要求的$\\gamma(\\alpha)$的闭式表达式。\n\n为了证明对于$0  \\alpha  1$时$\\gamma(\\alpha) > 1$，我们必须证明以下不等式：\n$$\\frac{(\\sigma_{b}^{2} + \\alpha^{2}\\sigma_{r}^{2})(\\sigma_{b}^{2} + \\sigma_{r}^{2})}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}} > 1$$\n让我们定义一个无量纲的方差比$S = \\frac{\\sigma_{b}^{2}}{\\sigma_{r}^{2}}$。由于方差是正的，$S>0$。我们可以通过将分子和分母除以$\\sigma_r^4$来重写不等式：\n$$\\frac{(\\frac{\\sigma_{b}^{2}}{\\sigma_{r}^{2}} + \\alpha^{2})(\\frac{\\sigma_{b}^{2}}{\\sigma_{r}^{2}} + 1)}{(\\frac{\\sigma_{b}^{2}}{\\sigma_{r}^{2}} + \\alpha)^{2}} = \\frac{(S + \\alpha^{2})(S+1)}{(S+\\alpha)^{2}} > 1$$\n由于分母$(S+\\alpha)^{2}$为正，我们可以在不等式两边同乘以它而不改变不等式的方向：\n$$(S + \\alpha^{2})(S+1) > (S+\\alpha)^{2}$$\n展开两边：\n$$S^{2} + S + \\alpha^{2}S + \\alpha^{2} > S^{2} + 2\\alpha S + \\alpha^{2}$$\n两边减去$S^{2}+\\alpha^{2}$得到：\n$$S + \\alpha^{2}S > 2\\alpha S$$\n由于$S > 0$，我们可以除以$S$：\n$$1 + \\alpha^{2} > 2\\alpha$$\n整理各项得：\n$$1 - 2\\alpha + \\alpha^{2} > 0$$\n$$(1-\\alpha)^{2} > 0$$\n这个不等式对所有实数$\\alpha$都成立，除了$\\alpha=1$。问题指定了$0  \\alpha  1$，在这个范围内不等式$(1-\\alpha)^{2} > 0$严格成立。因此，对于$0  \\alpha  1$，$\\gamma(\\alpha) > 1$。这证实了低估观测误差方差会导致分析结果的真实准确性低于最优分析，这种现象被称为过拟合。",
            "answer": "$$\\boxed{\\frac{(\\sigma_{b}^{2} + \\sigma_{r}^{2})(\\sigma_{b}^{2} + \\alpha^{2}\\sigma_{r}^{2})}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}}}$$"
        },
        {
            "introduction": "虽然许多入门示例假设观测误差是独立的，但现实世界的测量数据通常表现出相关性，例如来自同一仪器的测量。这个高级练习要求你将最优插值框架扩展到处理非对角观测误差协方差矩阵。你将推导出误差相关性如何重新分配分析权重，从而更深入地理解最优插值如何智能地处理观测数据之间的冗余信息。",
            "id": "3903481",
            "problem": "考虑一个一维地球物理标量场$s(x)$（例如，海面盐度），其被建模为一个零均值、平稳高斯随机场，协方差函数为$C(r) = \\sigma_{s}^{2} \\exp(-|r|/L)$，其中$\\sigma_{s}^{2} > 0$是信号方差，$L > 0$是相关长度。在位置$x_{1} = x_{0} - d$和$x_{2} = x_{0} + 2d$（其中$d > 0$）处，有两个对$s(x)$的观测值$y_{1}$和$y_{2}$。每个观测值被建模为$y_{i} = s(x_{i}) + e_{i}$，其中观测误差$e_{1}$和$e_{2}$是零均值的联合高斯变量，其协方差矩阵为$R = \\sigma_{o}^{2} \\begin{pmatrix} 1  \\rho \\\\ \\rho  1 \\end{pmatrix}$，其中$\\sigma_{o}^{2} > 0$为已知，相关参数$\\rho \\in (-1,1)$。定义$a \\equiv \\exp(-d/L)$，因此$a \\in (0,1)$。\n\n我们希望使用最优插值（OI）方法，根据观测值来估计$s(x_{0})$。最优插值是在高斯假设下的线性、无偏、最小方差估计量。设估计量为$s_{a}(x_{0}) = w_{1} y_{1} + w_{2} y_{2}$，其中权重$w_{1}$和$w_{2}$需要从第一性原理确定。\n\n从联合高斯变量的线性、无偏、最小方差估计的定义出发，并利用给定的$s(x)$和观测误差的协方差模型，推导OI权重的闭合形式。然后，将你的推导应用于此几何结构和协方差模型，得到对较近观测点$x_{1} = x_{0} - d$的权重$w_{1}$的显式解析表达式，该表达式是$\\sigma_{s}^{2}$、$\\sigma_{o}^{2}$、$a$和$\\rho$的函数。在你的推导中，将总观测协方差视为观测值之间的信号协方差与观测误差协方差之和。\n\n你的最终答案必须是关于$\\sigma_{s}^{2}$、$\\sigma_{o}^{2}$、$a$和$\\rho$的$w_{1}(\\rho)$的单一闭合形式解析表达式。不需要进行数值计算。最终答案中不要提供任何讨论。在你的解题过程中，仔细解释$R$中的非对角项（即$\\rho \\neq 0$）如何通过协方差求逆过程重新分配邻近观测值之间的权重。最终表达式应不带单位。",
            "solution": "最优插值（OI）估计量是作为联合高斯变量的线性、无偏、最小方差估计量而产生的。设目标变量为$s(x_{0})$，观测向量为$\\boldsymbol{y} = \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix}$。在高斯假设下，任何线性估计量$s_{a}(x_{0}) = \\boldsymbol{w}^{\\top} \\boldsymbol{y}$的估计误差为$s(x_{0}) - s_{a}(x_{0})$，选择权重$\\boldsymbol{w}$以在无偏约束下最小化误差方差。由于$s(x)$是零均值且$e_{i}$是零均值，因此通过使$\\boldsymbol{w}$与观测值无关并依赖于交叉协方差，可以实现$s_{a}(x_{0})$的无偏性。对于联合高斯变量，线性最小方差估计的成熟结果给出了OI权重向量\n$$\n\\boldsymbol{w} \\;=\\; \\mathrm{Cov}\\big(s(x_{0}), \\boldsymbol{y}\\big) \\;\\mathrm{Cov}\\big(\\boldsymbol{y}, \\boldsymbol{y}\\big)^{-1}.\n$$\n我们现在根据给定的协方差模型计算这两个协方差矩阵。\n\n首先，信号协方差函数为$C(r) = \\sigma_{s}^{2} \\exp(-|r|/L)$。定义$a \\equiv \\exp(-d/L) \\in (0,1)$。目标与观测值之间的交叉协方差向量是\n$$\n\\mathrm{Cov}\\big(s(x_{0}), \\boldsymbol{y}\\big)\n\\;=\\;\n\\begin{pmatrix}\n\\mathrm{Cov}\\big(s(x_{0}), s(x_{1})\\big) \\\\\n\\mathrm{Cov}\\big(s(x_{0}), s(x_{2})\\big)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\sigma_{s}^{2} \\exp(-|x_{0}-x_{1}|/L) \\\\\n\\sigma_{s}^{2} \\exp(-|x_{0}-x_{2}|/L)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\sigma_{s}^{2} a \\\\\n\\sigma_{s}^{2} a^{2}\n\\end{pmatrix}.\n$$\n\n其次，观测值之间的协方差是$s(x_{1})$和$s(x_{2})$之间的信号协方差与观测误差协方差$R$之和：\n$$\n\\mathrm{Cov}\\big(\\boldsymbol{y}, \\boldsymbol{y}\\big)\n\\;=\\;\n\\mathrm{Cov}\\big(\\boldsymbol{s}, \\boldsymbol{s}\\big) + R,\n$$\n其中$\\boldsymbol{s} = \\begin{pmatrix} s(x_{1}) \\\\ s(x_{2}) \\end{pmatrix}$。观测值之间的信号协方差是\n$$\n\\mathrm{Cov}\\big(\\boldsymbol{s}, \\boldsymbol{s}\\big)\n=\n\\sigma_{s}^{2}\n\\begin{pmatrix}\n\\exp(0)  \\exp(-|x_{1}-x_{2}|/L) \\\\\n\\exp(-|x_{1}-x_{2}|/L)  \\exp(0)\n\\end{pmatrix}\n=\n\\sigma_{s}^{2}\n\\begin{pmatrix}\n1  a^{3} \\\\\na^{3}  1\n\\end{pmatrix}.\n$$\n观测误差协方差由题设给出\n$$\nR\n=\n\\sigma_{o}^{2}\n\\begin{pmatrix}\n1  \\rho \\\\\n\\rho  1\n\\end{pmatrix}.\n$$\n因此，总观测协方差为\n$$\n\\mathrm{Cov}\\big(\\boldsymbol{y}, \\boldsymbol{y}\\big)\n=\n\\begin{pmatrix}\n\\sigma_{s}^{2} + \\sigma_{o}^{2}  \\sigma_{s}^{2} a^{3} + \\sigma_{o}^{2} \\rho \\\\\n\\sigma_{s}^{2} a^{3} + \\sigma_{o}^{2} \\rho  \\sigma_{s}^{2} + \\sigma_{o}^{2}\n\\end{pmatrix}.\n$$\n引入简写\n$$\nA \\equiv \\sigma_{s}^{2} + \\sigma_{o}^{2},\n\\qquad\nB \\equiv \\sigma_{s}^{2} a^{3} + \\sigma_{o}^{2} \\rho.\n$$\n则\n$$\n\\mathrm{Cov}\\big(\\boldsymbol{y}, \\boldsymbol{y}\\big) = \\begin{pmatrix} A  B \\\\ B  A \\end{pmatrix}.\n$$\n这个对称$2 \\times 2$矩阵的逆是\n$$\n\\begin{pmatrix} A  B \\\\ B  A \\end{pmatrix}^{-1}\n=\n\\frac{1}{A^{2} - B^{2}}\n\\begin{pmatrix}\nA  -B \\\\\n- B  A\n\\end{pmatrix},\n$$\n此式在$A^{2} \\neq B^{2}$时有效，这一点在这里由$\\mathrm{Cov}\\big(\\boldsymbol{y}, \\boldsymbol{y}\\big)$在$\\rho \\in (-1,1)$和$a \\in (0,1)$且$\\sigma_{s}^{2} > 0, \\sigma_{o}^{2} > 0$条件下的正定性保证。\n\n组合得到OI权重向量，\n$$\n\\boldsymbol{w}\n=\n\\mathrm{Cov}\\big(s(x_{0}), \\boldsymbol{y}\\big)\n\\;\n\\mathrm{Cov}\\big(\\boldsymbol{y}, \\boldsymbol{y}\\big)^{-1}\n=\n\\begin{pmatrix} \\sigma_{s}^{2} a  \\sigma_{s}^{2} a^{2} \\end{pmatrix}\n\\frac{1}{A^{2} - B^{2}}\n\\begin{pmatrix}\nA  -B \\\\\n- B  A\n\\end{pmatrix}.\n$$\n因此，\n$$\nw_{1}\n=\n\\frac{1}{A^{2} - B^{2}}\n\\left(\n\\sigma_{s}^{2} a \\, A - \\sigma_{s}^{2} a^{2} \\, B\n\\right),\n\\qquad\nw_{2}\n=\n\\frac{1}{A^{2} - B^{2}}\n\\left(\n- \\sigma_{s}^{2} a \\, B + \\sigma_{s}^{2} a^{2} \\, A\n\\right).\n$$\n代入$A$和$B$，\n$$\nw_{1}(\\rho)\n=\n\\frac{\\sigma_{s}^{2} \\left[ a (\\sigma_{s}^{2} + \\sigma_{o}^{2}) - a^{2} (\\sigma_{s}^{2} a^{3} + \\sigma_{o}^{2} \\rho) \\right]}{(\\sigma_{s}^{2} + \\sigma_{o}^{2})^{2} - (\\sigma_{s}^{2} a^{3} + \\sigma_{o}^{2} \\rho)^{2}}.\n$$\n对分母进行因式分解通常很有启发性：\n$$\n(\\sigma_{s}^{2} + \\sigma_{o}^{2})^{2} - (\\sigma_{s}^{2} a^{3} + \\sigma_{o}^{2} \\rho)^{2}\n=\n\\left[\\sigma_{s}^{2}(1 - a^{3}) + \\sigma_{o}^{2}(1 - \\rho)\\right]\n\\left[\\sigma_{s}^{2}(1 + a^{3}) + \\sigma_{o}^{2}(1 + \\rho)\\right],\n$$\n并展开分子：\n$$\n\\sigma_{s}^{2} \\left[ a (\\sigma_{s}^{2} + \\sigma_{o}^{2}) - a^{2} (\\sigma_{s}^{2} a^{3} + \\sigma_{o}^{2} \\rho) \\right]\n=\n\\sigma_{s}^{2} \\left[ \\sigma_{s}^{2} (a - a^{5}) + \\sigma_{o}^{2} (a - a^{2} \\rho) \\right].\n$$\n因此，一个显式解析形式是\n$$\nw_{1}(\\rho)\n=\n\\frac{ \\sigma_{s}^{2} \\left[ \\sigma_{s}^{2} (a - a^{5}) + \\sigma_{o}^{2} (a - a^{2} \\rho) \\right] }{ \\left[\\sigma_{s}^{2}(1 - a^{3}) + \\sigma_{o}^{2}(1 - \\rho)\\right] \\left[\\sigma_{s}^{2}(1 + a^{3}) + \\sigma_{o}^{2}(1 + \\rho)\\right] }.\n$$\n\n关于非对角项如何重新分配邻近观测值权重的解释：由$\\rho$所表示的非对角误差协方差会同时修改$w_{1}(\\rho)$的分子和分母。项$\\rho$以加法形式出现在$B = \\sigma_{s}^{2} a^{3} + \\sigma_{o}^{2} \\rho$中，而$B$又进入$\\mathrm{Cov}\\big(\\boldsymbol{y}, \\boldsymbol{y}\\big)$的逆矩阵。随着$\\rho$的增加（正相关误差），$y_{1}$和$y_{2}$之间的有效冗余度增加，这会减少这对观测值的净独立信息含量。在分母中，因子$\\left[\\sigma_{s}^{2}(1 - a^{3}) + \\sigma_{o}^{2}(1 - \\rho)\\right]$随$\\rho$减小，而$\\left[\\sigma_{s}^{2}(1 + a^{3}) + \\sigma_{o}^{2}(1 + \\rho)\\right]$增加；其乘积呈非线性响应，反映了协方差矩阵条件数的变化。在分子中，项$\\sigma_{o}^{2}(a - a^{2} \\rho)$表明，较大的$\\rho$通过求逆耦合，直接从较远观测值对$w_{1}$的贡献中减去一部分$a^{2} \\sigma_{o}^{2} \\rho$。总的来说，对于$a \\in (0,1)$和典型的$\\sigma_{s}^{2}, \\sigma_{o}^{2} > 0$，增加$\\rho$倾向于将权重从将观测值视为独立的情况移开，通过偏向信息量更大（更近）的观测值$y_{1}$相对于信息量更少（更远）的观测值$y_{2}$来有效地重新分配权重，因为相关的误差降低了包含更远观测值的边际效益。相反，负的$\\rho$可以通过使误差部分抵消来增加组合信息含量，倾向于通过逆协方差耦合增加分配给第二个观测值的权重。这种重新分配完全由$R$中的非对角项介导，即通过$\\rho$如何进入$B$并因此进入$\\mathrm{Cov}\\big(\\boldsymbol{y}, \\boldsymbol{y}\\big)^{-1}$，从而将邻近观测值的权重耦合起来。",
            "answer": "$$\\boxed{\\frac{ \\sigma_{s}^{2} \\left[ \\sigma_{s}^{2} (a - a^{5}) + \\sigma_{o}^{2} (a - a^{2} \\rho) \\right] }{ \\left[\\sigma_{s}^{2}(1 - a^{3}) + \\sigma_{o}^{2}(1 - \\rho)\\right] \\left[\\sigma_{s}^{2}(1 + a^{3}) + \\sigma_{o}^{2}(1 + \\rho)\\right] }}$$"
        }
    ]
}