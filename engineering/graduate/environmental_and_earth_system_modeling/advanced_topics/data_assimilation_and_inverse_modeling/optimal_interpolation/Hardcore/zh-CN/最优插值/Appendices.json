{
    "hands_on_practices": [
        {
            "introduction": "第一个实践练习提供了最优插值框架的一个基础且循序渐进的应用。通过为一个给定的观测集和协方差模型计算分析误差方差，你将把核心的理论方程转化为一个可量化的不确定性减少的度量。这项练习  对于建立坚实的计算基础和理解观测如何增进我们对系统的认识至关重要。",
            "id": "3805220",
            "problem": "考虑一个代表海表温度异常的零均值、平稳高斯随机场，记为$x(\\mathbf{x})$，其各向同性协方差函数为$C(r) = \\sigma^{2}\\exp(-r/L)$，其中$r$是水平间隔，$\\sigma^{2}$是先验方差，$L$是相关长度尺度。您希望使用线性客观分析（最优插值）来估计分析位置$\\mathbf{x}_0$处的$x(\\mathbf{x}_0)$，该方法是根据一组点观测值构建的$x(\\mathbf{x}_0)$的最佳线性无偏估计。\n\n在位置$\\mathbf{x}_1$和$\\mathbf{x}_2$处，分别有两个对同一异常场的独立标量观测值$y_1$和$y_2$。每个观测值都受到加性的、独立的、零均值的测量噪声的污染，其已知方差为$\\mathrm{Var}(\\epsilon_1) = r_1$和$\\mathrm{Var}(\\epsilon_2) = r_2$，且测量误差之间无交叉协方差。假设误差与信号$x(\\mathbf{x})$不相关。\n\n给定以下科学上合理的参数：\n- 先验方差 $\\sigma^{2} = 1.2\\,^{\\circ}\\mathrm{C}^{2}$。\n- 相关长度 $L = 60\\,\\mathrm{km}$。\n- 距分析点的距离：$r_1 = 30\\,\\mathrm{km}$ 和 $r_2 = 60\\,\\mathrm{km}$。\n- 两个观测位置之间的间隔：$d_{12} = 90\\,\\mathrm{km}$。\n- 测量误差方差：$r_1 = r_2 = 0.09\\,^{\\circ}\\mathrm{C}^{2}$。\n\n从具有加性测量噪声的高斯随机场的最佳线性无偏估计的定义出发，推导由最优插值在$\\mathbf{x}_0$处产生的后验分析误差方差的表达式，用先验协方差和数据协方差表示。然后，根据给定的协方差模型和距离，对上述配置的后验方差进行数值计算。请清楚地指出您计算的所有中间量（例如信号-数据协方差向量和数据协方差矩阵）。\n\n将您的最终答案表示为 $^{\\circ}\\mathrm{C}^{2}$ 单位的单个实数，并将结果四舍五入到四位有效数字。简要地物理解释这个量，作为在同化两个观测值后，分析位置的后验不确定性。",
            "solution": "该问题具有科学依据，是适定的、客观的，并包含足够的信息以获得唯一解。注意到符号$r_1$和$r_2$既用于表示距离又用于表示误差方差，存在记法上的模糊性；然而，从物理单位和上下文中可以清楚地看出其意图。为防止推导过程中的混淆，从分析点$\\mathbf{x}_0$到观测点$\\mathbf{x}_1$和$\\mathbf{x}_2$的距离将分别用$d_{01}$和$d_{02}$表示。测量误差方差将按照问题陈述中的$r_1$和$r_2$表示。\n\n目标是求出在位置$\\mathbf{x}_0$的后验分析误差方差，记为$\\sigma_a^2$。对于作为最优插值（OI）基础的最佳线性无偏估计（BLUE），分析误差方差由以下表达式给出：\n$$\n\\sigma_a^2 = \\sigma_b^2 - \\mathbf{k}^\\top \\mathbf{C}_{yy}^{-1} \\mathbf{k}\n$$\n这里，$\\sigma_b^2$是分析位置的先验（背景）误差方差，$\\mathbf{k}$是分析位置的真实状态与观测值之间的协方差向量，$\\mathbf{C}_{yy}$是观测值的总协方差矩阵。\n\n我们现在将确定这个方程的每个组成部分。\n\n1.  **先验方差 ($\\sigma_b^2$)**\n    分析位置$\\mathbf{x}_0$的先验方差是场本身的方差，在零间隔处计算，因为没有其他先验信息。\n    $$\n    \\sigma_b^2 = \\mathrm{Var}(x(\\mathbf{x}_0)) = C(0) = \\sigma^2 \\exp(-0/L) = \\sigma^2\n    $$\n    给定$\\sigma^2 = 1.2\\,^{\\circ}\\mathrm{C}^2$，我们有$\\sigma_b^2 = 1.2$。\n\n2.  **信号-数据协方差向量 ($\\mathbf{k}$)**\n    该向量包含分析点$x(\\mathbf{x}_0)$的真实场值与每个观测值$y_1$和$y_2$之间的协方差。$\\mathbf{k}$的第$i$个元素是$k_i = \\mathrm{Cov}(x(\\mathbf{x}_0), y_i)$。\n    由于$y_i = x(\\mathbf{x}_i) + \\epsilon_i$且测量噪声$\\epsilon_i$与信号$x$不相关，这可以简化为：\n    $$\n    k_i = \\mathrm{Cov}(x(\\mathbf{x}_0), x(\\mathbf{x}_i) + \\epsilon_i) = \\mathrm{Cov}(x(\\mathbf{x}_0), x(\\mathbf{x}_i)) + \\mathrm{Cov}(x(\\mathbf{x}_0), \\epsilon_i) = C(d_{0i}) + 0\n    $$\n    其中$d_{0i}$是$\\mathbf{x}_0$和$\\mathbf{x}_i$之间的距离。因此，向量$\\mathbf{k}$是：\n    $$\n    \\mathbf{k} = \\begin{pmatrix} C(d_{01}) \\\\ C(d_{02}) \\end{pmatrix} = \\begin{pmatrix} \\sigma^2 \\exp(-d_{01}/L) \\\\ \\sigma^2 \\exp(-d_{02}/L) \\end{pmatrix}\n    $$\n    使用给定值$d_{01} = 30\\,\\mathrm{km}$，$d_{02} = 60\\,\\mathrm{km}$，$L = 60\\,\\mathrm{km}$，和$\\sigma^2 = 1.2$：\n    $$\n    k_1 = 1.2 \\exp(-30/60) = 1.2 \\exp(-0.5)\n    $$\n    $$\n    k_2 = 1.2 \\exp(-60/60) = 1.2 \\exp(-1)\n    $$\n    数值上，$k_1 \\approx 0.727837\\,^{\\circ}\\mathrm{C}^2$ 和 $k_2 \\approx 0.441455\\,^{\\circ}\\mathrm{C}^2$。\n\n3.  **数据协方差矩阵 ($\\mathbf{C}_{yy}$)**\n    该矩阵表示观测向量$\\mathbf{y} = (y_1, y_2)^\\top$的总协方差。它是信号协方差矩阵$\\mathbf{C}_{xx}$和测量误差协方差矩阵$\\mathbf{R}$之和：\n    $$\n    \\mathbf{C}_{yy} = \\mathbf{C}_{xx} + \\mathbf{R}\n    $$\n    信号协方差矩阵的元素是$(\\mathbf{C}_{xx})_{ij} = \\mathrm{Cov}(x(\\mathbf{x}_i), x(\\mathbf{x}_j)) = C(d_{ij})$，其中$d_{ij}$是观测点$\\mathbf{x}_i$和$\\mathbf{x}_j$之间的距离。\n    $$\n    \\mathbf{C}_{xx} = \\begin{pmatrix} C(0) & C(d_{12}) \\\\ C(d_{21}) & C(0) \\end{pmatrix} = \\begin{pmatrix} \\sigma^2 & \\sigma^2 \\exp(-d_{12}/L) \\\\ \\sigma^2 \\exp(-d_{12}/L) & \\sigma^2 \\end{pmatrix}\n    $$\n    测量误差是独立的，所以它们的协方差矩阵$\\mathbf{R}$是对角矩阵：\n    $$\n    \\mathbf{R} = \\begin{pmatrix} \\mathrm{Var}(\\epsilon_1) & 0 \\\\ 0 & \\mathrm{Var}(\\epsilon_2) \\end{pmatrix} = \\begin{pmatrix} r_1 & 0 \\\\ 0 & r_2 \\end{pmatrix}\n    $$\n    将它们结合起来得到：\n    $$\n    \\mathbf{C}_{yy} = \\begin{pmatrix} \\sigma^2 + r_1 & \\sigma^2 \\exp(-d_{12}/L) \\\\ \\sigma^2 \\exp(-d_{12}/L) & \\sigma^2 + r_2 \\end{pmatrix}\n    $$\n    使用给定值$d_{12} = 90\\,\\mathrm{km}$，$L=60\\,\\mathrm{km}$，$\\sigma^2=1.2$，和$r_1 = r_2 = 0.09$：\n    - 对角元素：$\\sigma^2 + r_1 = 1.2 + 0.09 = 1.29$。\n    - 非对角元素：$\\sigma^2 \\exp(-90/60) = 1.2 \\exp(-1.5)$。\n    所以，矩阵是：\n    $$\n    \\mathbf{C}_{yy} = \\begin{pmatrix} 1.29 & 1.2 \\exp(-1.5) \\\\ 1.2 \\exp(-1.5) & 1.29 \\end{pmatrix}\n    $$\n    数值上，$1.2 \\exp(-1.5) \\approx 0.267756$，所以 $\\mathbf{C}_{yy} \\approx \\begin{pmatrix} 1.29 & 0.267756 \\\\ 0.267756 & 1.29 \\end{pmatrix}$。\n\n4.  **最终计算**\n    我们需要计算方差减小项，$\\Delta\\sigma^2 = \\mathbf{k}^\\top \\mathbf{C}_{yy}^{-1} \\mathbf{k}$。\n    首先，我们求$2 \\times 2$矩阵$\\mathbf{C}_{yy}$的逆。\n    行列式为$\\det(\\mathbf{C}_{yy}) = (1.29)^2 - (1.2 \\exp(-1.5))^2 = 1.6641 - (1.44 \\exp(-3))$。\n    $\\det(\\mathbf{C}_{yy}) \\approx 1.6641 - 1.44 \\times 0.049787 = 1.6641 - 0.071693 = 1.592407$。\n    逆矩阵是：\n    $$\n    \\mathbf{C}_{yy}^{-1} = \\frac{1}{\\det(\\mathbf{C}_{yy})} \\begin{pmatrix} 1.29 & -1.2 \\exp(-1.5) \\\\ -1.2 \\exp(-1.5) & 1.29 \\end{pmatrix}\n    $$\n    二次型$\\Delta\\sigma^2 = \\mathbf{k}^\\top \\mathbf{C}_{yy}^{-1} \\mathbf{k}$是：\n    $$\n    \\Delta\\sigma^2 = \\frac{1}{\\det(\\mathbf{C}_{yy})} \\left[ 1.29(k_1^2 + k_2^2) - 2 \\cdot (1.2 \\exp(-1.5)) \\cdot k_1 k_2 \\right]\n    $$\n    代入$k_1$和$k_2$的表达式：\n    $k_1^2 = (1.2 \\exp(-0.5))^2 = 1.44 \\exp(-1)$\n    $k_2^2 = (1.2 \\exp(-1))^2 = 1.44 \\exp(-2)$\n    $k_1 k_2 = (1.2 \\exp(-0.5)) (1.2 \\exp(-1)) = 1.44 \\exp(-1.5)$\n    $\\Delta\\sigma^2$的分子：\n    $1.29 \\left( 1.44 \\exp(-1) + 1.44 \\exp(-2) \\right) - 2 \\cdot (1.2 \\exp(-1.5)) \\cdot (1.44 \\exp(-1.5))$\n    $= 1.29 \\cdot 1.44 (\\exp(-1) + \\exp(-2)) - 2 \\cdot 1.2 \\cdot 1.44 \\cdot \\exp(-3)$\n    $= 1.8576 (\\exp(-1) + \\exp(-2)) - 3.456 \\exp(-3)$\n    使用数值：\n    $k_1 \\approx 0.727837$, $k_2 \\approx 0.441455$, $1.2 \\exp(-1.5) \\approx 0.267756$。\n    $k_1^2 \\approx 0.529727$, $k_2^2 \\approx 0.194883$。\n    $k_1 k_2 \\approx 0.321303$。\n    分子 $\\approx 1.29(0.529727 + 0.194883) - 2(0.267756)(0.321303)$\n    $\\approx 1.29(0.724610) - 0.172061 \\approx 0.934747 - 0.172061 = 0.762686$。\n    $\\Delta\\sigma^2 \\approx \\frac{0.762686}{1.592407} \\approx 0.479002 \\,^{\\circ}\\mathrm{C}^2$。\n\n    最后，后验分析误差方差是：\n    $$\n    \\sigma_a^2 = \\sigma_b^2 - \\Delta\\sigma^2 \\approx 1.2 - 0.479002 = 0.720998 \\,^{\\circ}\\mathrm{C}^2\n    $$\n    四舍五入到四位有效数字，我们得到$\\sigma_a^2 = 0.7210 \\,^{\\circ}\\mathrm{C}^2$。\n\n该结果的物理解释是，通过同化两个观测值，分析位置处海表温度异常的初始不确定性（由先验方差$\\sigma_b^2 = 1.2\\,^{\\circ}\\mathrm{C}^2$表示）已经减小。后验方差$\\sigma_a^2 \\approx 0.7210\\,^{\\circ}\\mathrm{C}^2$是最优估计的期望平方误差。它量化了在吸收了数据信息后剩余的不确定性。该值的平方根$\\sqrt{\\sigma_a^2} \\approx 0.849\\,^{\\circ}\\mathrm{C}$是最终分析的期望均方根误差。",
            "answer": "$$\n\\boxed{0.7210}\n$$"
        },
        {
            "introduction": "最优插值的核心在于背景误差协方差模型，它决定了信息如何从观测点传播。这项实践  让你接触并使用在地球科学中广泛应用的、更为复杂的 Matérn 协方差函数。通过推导相关性结构并分析平滑度参数 $\\nu$ 的作用，你将更深刻地体会到协方差模型中的数学选择如何控制分析场的物理特性（例如平滑度）。",
            "id": "3903472",
            "problem": "一位分析员正在为一个二维地球物理标量场实施最优插值（OI），该场的背景误差被建模为一个二阶平稳各向同性的高斯随机场。背景误差协方差由 Matérn 类给出，\n$$\nC(r) \\;=\\; \\sigma_b^2 \\,\\frac{2^{\\,1-\\nu}}{\\Gamma(\\nu)}\\left(\\frac{r}{L}\\right)^{\\nu} K_{\\nu}\\!\\left(\\frac{r}{L}\\right),\n$$\n其中 $\\,\\sigma_b^2\\,$ 是背景误差方差，$\\,L\\,$ 是水平相关长度尺度，$\\,\\nu>0\\,$ 是平滑度参数，$\\,\\Gamma(\\cdot)\\,$ 是伽马函数，而 $\\,K_{\\nu}(\\cdot)\\,$ 是阶数为 $\\,\\nu\\,$ 的第二类修正贝塞尔函数。三个观测点的位置由下式给出\n$$\n\\boldsymbol{x}_1 = (0\\,L,\\,0\\,L), \\quad \\boldsymbol{x}_2 = (1\\,L,\\,0\\,L), \\quad \\boldsymbol{x}_3 = (2\\,L,\\,1\\,L),\n$$\n其笛卡尔坐标以长度尺度 $\\,L\\,$ 的单位表示。\n\n从平稳各向同性场的协方差和相关性定义出发，推导 $\\,3\\times 3\\,$ 背景误差相关矩阵 $\\,\\boldsymbol{\\rho}\\,$ 各元素的解析表达式，其中元素为 $\\,\\rho_{ij} = C(r_{ij})/C(0)\\,$，且 $\\,r_{ij} = \\|\\boldsymbol{x}_i - \\boldsymbol{x}_j\\|\\,$。然后，利用给定位置的几何关系，提供非对角线元素 $\\,\\rho_{13}\\,$ 仅以 $\\,\\nu\\,$ 表示的显式闭合形式表达式。\n\n最后，运用第一性原理和 Matérn 类的成熟性质，解释参数 $\\,\\nu\\,$ 如何控制背景误差场的平滑度以及相关函数的短程行为。你的最终数值或符号答案必须是 $\\,\\rho_{13}\\,$ 的单一解析表达式。不需要四舍五入，最终表达式中也不应包含任何物理单位。",
            "solution": "该问题具有科学依据、提法明确、客观，并包含推导唯一解所需的所有信息。因此，该问题被认定为有效。求解过程首先从给定的协方差函数推导出背景误差相关函数的一般形式，然后计算相关矩阵的特定元素 $\\rho_{13}$，最后解释平滑度参数 $\\nu$ 的作用。\n\n背景误差协方差函数 $C(r)$ 由 Matérn 类给出：\n$$\nC(r) = \\sigma_b^2 \\frac{2^{1-\\nu}}{\\Gamma(\\nu)}\\left(\\frac{r}{L}\\right)^{\\nu} K_{\\nu}\\left(\\frac{r}{L}\\right)\n$$\n其中 $r = \\|\\boldsymbol{x}_i - \\boldsymbol{x}_j\\|$ 是两点之间的欧几里得距离，$\\sigma_b^2$ 是背景误差方差， $L$ 是相关长度尺度，$\\nu$ 是平滑度参数，$\\Gamma(\\cdot)$ 是伽马函数，而 $K_{\\nu}(\\cdot)$ 是阶数为 $\\nu$ 的第二类修正贝塞尔函数。\n\n背景误差相关性 $\\rho(r)$ 定义为由方差归一化的协方差。方差是零距离处的协方差，即 $C(0)$。我们必须在 $r \\to 0$ 的极限下计算 $C(r)$。令 $z = r/L$。当 $r \\to 0$ 时，我们有 $z \\to 0$。对于小自变量 $z$ 和 $\\nu > 0$ 的情况，第二类修正贝塞尔函数的渐近行为由下式给出：\n$$\nK_{\\nu}(z) \\sim \\frac{\\Gamma(\\nu)}{2} \\left(\\frac{2}{z}\\right)^{\\nu} \\quad \\text{as } z \\to 0^{+}\n$$\n将此代入 $C(r)$ 的表达式中：\n$$\nC(0) = \\lim_{r \\to 0} C(r) = \\lim_{z \\to 0} \\left[ \\sigma_b^2 \\frac{2^{1-\\nu}}{\\Gamma(\\nu)} z^{\\nu} K_{\\nu}(z) \\right]\n$$\n$$\nC(0) = \\sigma_b^2 \\frac{2^{1-\\nu}}{\\Gamma(\\nu)} \\lim_{z \\to 0} \\left[ z^{\\nu} \\left( \\frac{\\Gamma(\\nu)}{2} \\left(\\frac{2}{z}\\right)^{\\nu} \\right) \\right]\n$$\n$$\nC(0) = \\sigma_b^2 \\frac{2^{1-\\nu}}{\\Gamma(\\nu)} \\frac{\\Gamma(\\nu)}{2} 2^{\\nu} \\lim_{z \\to 0} \\left[ z^{\\nu} z^{-\\nu} \\right]\n$$\n$$\nC(0) = \\sigma_b^2 \\cdot (2^{1-\\nu-1+\\nu}) \\cdot 1 = \\sigma_b^2 \\cdot 2^0 = \\sigma_b^2\n$$\n正如所预期的，零延迟下的协方差就是背景误差方差。因此，相关函数 $\\rho(r)$ 为：\n$$\n\\rho(r) = \\frac{C(r)}{C(0)} = \\frac{\\sigma_b^2 \\frac{2^{1-\\nu}}{\\Gamma(\\nu)}\\left(\\frac{r}{L}\\right)^{\\nu} K_{\\nu}\\left(\\frac{r}{L}\\right)}{\\sigma_b^2} = \\frac{2^{1-\\nu}}{\\Gamma(\\nu)}\\left(\\frac{r}{L}\\right)^{\\nu} K_{\\nu}\\left(\\frac{r}{L}\\right)\n$$\n背景误差相关矩阵 $\\boldsymbol{\\rho}$ 的元素由 $\\rho_{ij} = \\rho(r_{ij})$ 给出，其中 $r_{ij} = \\|\\boldsymbol{x}_i - \\boldsymbol{x}_j\\|$。观测点位置为 $\\boldsymbol{x}_1 = (0, 0)$、$\\boldsymbol{x}_2 = (L, 0)$ 和 $\\boldsymbol{x}_3 = (2L, L)$，为清晰起见，我们已将公共长度尺度 $L$ 提出，因为相关函数的自变量是无量纲距离 $r/L$。\n\n我们需要求解非对角线元素 $\\rho_{13}$。首先，我们计算距离 $r_{13}$：\n$$\n\\boldsymbol{x}_1 - \\boldsymbol{x}_3 = (0L - 2L, 0L - 1L) = (-2L, -L)\n$$\n$$\nr_{13} = \\|\\boldsymbol{x}_1 - \\boldsymbol{x}_3\\| = \\sqrt{(-2L)^2 + (-L)^2} = \\sqrt{4L^2 + L^2} = \\sqrt{5L^2} = L\\sqrt{5}\n$$\n无量纲距离为 $r_{13}/L = \\sqrt{5}$。我们将此代入相关函数 $\\rho(r)$ 的表达式中：\n$$\n\\rho_{13} = \\rho(L\\sqrt{5}) = \\frac{2^{1-\\nu}}{\\Gamma(\\nu)}\\left(\\frac{L\\sqrt{5}}{L}\\right)^{\\nu} K_{\\nu}\\left(\\frac{L\\sqrt{5}}{L}\\right)\n$$\n$$\n\\rho_{13} = \\frac{2^{1-\\nu}}{\\Gamma(\\nu)}\\left(\\sqrt{5}\\right)^{\\nu} K_{\\nu}\\left(\\sqrt{5}\\right)\n$$\n将 $(\\sqrt{5})^{\\nu}$ 表示为 $(5^{1/2})^{\\nu} = 5^{\\nu/2}$，我们得到 $\\rho_{13}$ 仅以 $\\nu$ 表示的最终闭合形式表达式：\n$$\n\\rho_{13} = \\frac{2^{1-\\nu} 5^{\\nu/2}}{\\Gamma(\\nu)} K_{\\nu}(\\sqrt{5})\n$$\n参数 $\\nu$ 同时控制随机场的平滑度及其相关函数的短程行为。\n\n首先，关于平滑度，$\\nu$ 直接控制背景误差场的均方可微性。一个具有 Matérn 协方差的随机场是 $k$ 次均方可微的当且仅当 $\\nu > k$。例如，如果 $0 < \\nu \\le 1$，该场是连续的但不是均方可微的，其样本路径看起来是粗糙的。特殊情况 $\\nu = 1/2$ 产生指数相关函数 $\\rho(r) = \\exp(-r/L)$，这与一个连续但处处不可微的过程（Ornstein–Uhlenbeck 过程）相关联。如果 $\\nu > 1$，该场至少是一次均方可微的，其实现也更平滑。当 $\\nu \\to \\infty$ 时，Matérn 相关函数（在对 $L$ 进行适当的重新标度后）收敛于高斯相关函数 $\\rho(r) = \\exp(-(r/L')^2)$，它代表一个具有非常平滑实现的无限均方可微（解析）场。\n\n其次，关于短程行为，$\\nu$ 的值决定了相关函数在原点（$r=0$）附近的形状。这与场的可微性有内在联系。该行为由 $\\rho(r)$ 在 $r=0$ 附近的泰勒级数展开来表征。\n对于 $0 < \\nu < 1$，相关函数在原点处有一个“尖点”，其主阶行为为 $\\rho(r) \\approx 1 - c_1(r/L)^{2\\nu}$，其中 $c_1 > 0$ 为某个常数。该函数在 $r=0$ 处不可微。\n对于 $\\nu = 1$，其行为是 $\\rho(r) \\approx 1 - c_2(r/L)^2 \\ln(r/L)$，这也导致了一个不可微点。\n对于 $\\nu > 1$，相关函数在原点处是二阶可微的。由于各向同性要求 $\\rho'(0)=0$，其展开是抛物线形式的：$\\rho(r) \\approx 1 + \\frac{1}{2}\\rho''(0)r^2 = 1 - c_3(r/L)^2$，其中 $c_3 > 0$ 为某个常数。没有尖点表明场更平滑。\n总之，更大的 $\\nu$ 意味着在原点处有更平滑的相关函数，这又对应于一个更平滑的随机场。",
            "answer": "$$\n\\boxed{\\frac{2^{1-\\nu} 5^{\\frac{\\nu}{2}}}{\\Gamma(\\nu)} K_{\\nu}(\\sqrt{5})}\n$$"
        },
        {
            "introduction": "一个强大的模型，其局限性也应被充分理解。这项高级实践  从应用转向批判性分析，旨在探究一个常见的实际问题——错误设定误差统计量——所带来的后果。你将通过分析证明，低估观测误差方差会导致“过拟合”，即分析结果表面上看起来比实际更优，这为我们提供了关于准确表征误差对于可靠数据同化的重要性的一堂关键课程。",
            "id": "3903515",
            "problem": "考虑一个用于环境与地球系统建模的一维数据同化场景，其中应用最优插值（OI）来估计一个地球物理标量状态 $x$。设背景（先验）状态 $x_{b}$ 是 $x$ 的一个无偏估计量，其背景误差 $x - x_{b}$ 被建模为一个方差为 $\\sigma_{b}^{2}$ 的零均值高斯随机变量。单个观测值 $y$ 来自线性测量模型 $y = x + \\varepsilon$，其中真实观测误差 $\\varepsilon$ 是一个方差为 $\\sigma_{r}^{2}$ 的零均值高斯变量，且与背景误差独立。OI分析估计量采用线性形式 $x_{a} = x_{b} + K\\,(y - x_{b})$，其中增益 $K$ 的选择是为了在假定的误差统计量下最小化均方分析误差。\n\n假设数据同化系统低估了观测误差方差，并在构建增益时使用假定值 $R_{\\text{assumed}} = \\alpha\\,\\sigma_{r}^{2}$（其中 $0 < \\alpha < 1$）而不是真实值 $R_{\\text{true}} = \\sigma_{r}^{2}$。从高斯条件化和线性最小方差估计原理出发，完成以下任务：\n\n1. 在假设 $R_{\\text{assumed}} = \\alpha\\,\\sigma_{r}^{2}$ 的条件下，推导使均方分析误差最小化的OI增益 $K(\\alpha)$，并证明 $K(\\alpha)$ 随 $\\alpha$ 的减小而增大。利用此结果证明，当 $R$ 被低估时，分析增量 $d \\equiv x_{a} - x_{b}$ 的期望平方大小比 $R$ 正确时更大。\n\n2. 当增益使用低估的 $R_{\\text{assumed}} = \\alpha\\,\\sigma_{r}^{2}$ 计算，但真实世界遵循真实观测误差方差 $R_{\\text{true}} = \\sigma_{r}^{2}$ 时，计算分析误差的真实方差 $A(\\alpha) \\equiv \\operatorname{Var}(x_{a} - x)$。将 $A(\\alpha)$ 用 $\\sigma_{b}^{2}$、$\\sigma_{r}^{2}$ 和 $\\alpha$ 表示。\n\n3. 在正确模型 $R_{\\text{true}} = \\sigma_{r}^{2}$ 下，计算真实后验方差 $A_{\\text{true}} \\equiv \\operatorname{Var}(x \\mid y)$。\n\n4. 将过拟合因子定义为在低估的 $R$ 下分析误差协方差的迹与真实后验方差的比值，在本标量情况下，该比值简化为 $\\gamma(\\alpha) \\equiv \\dfrac{A(\\alpha)}{A_{\\text{true}}}$。提供 $\\gamma(\\alpha)$ 作为 $\\sigma_{b}^{2}$、$\\sigma_{r}^{2}$ 和 $\\alpha$ 的函数的闭式解析表达式，并证明对于 $0 < \\alpha < 1$，该值超过1。\n\n你的最终答案必须是 $\\gamma(\\alpha)$ 的单个闭式表达式。不需要数值；由于最终答案是符号化且无量纲的，因此不需要四舍五入。",
            "solution": "问题陈述已经过验证，在在线性估计理论和数据同化的标准框架内被认为是合理、适定且有科学依据的。我们可以开始解题。\n\n分析状态 $x_{a}$ 是背景状态 $x_{b}$ 和观测 $y$ 的线性组合。分析误差定义为 $e_{a} \\equiv x_{a} - x$，其中 $x$ 是真实状态。给定分析方程 $x_{a} = x_{b} + K(y - x_{b})$。我们可以用背景误差 $e_{b} \\equiv x_{b} - x$ 和观测误差 $\\varepsilon \\equiv y - x$ 来表示分析误差。\n首先，重写新息项 $y - x_{b}$：\n$$y - x_{b} = (x + \\varepsilon) - x_{b} = \\varepsilon - (x_{b} - x) = \\varepsilon - e_{b}$$\n现在将此代入 $x_{a}$ 的表达式中：\n$$x_{a} = x_{b} + K(\\varepsilon - e_{b})$$\n那么分析误差为：\n$$e_{a} = x_{a} - x = (x_{b} - x) + K(\\varepsilon - e_{b}) = e_{b} + K(\\varepsilon - e_{b}) = (1-K)e_{b} + K\\varepsilon$$\n背景误差和观测误差是给定的零均值随机变量，$E[e_{b}] = 0$ 且 $E[\\varepsilon] = 0$。期望分析误差为：\n$$E[e_{a}] = E[(1-K)e_{b} + K\\varepsilon] = (1-K)E[e_{b}] + K E[\\varepsilon] = 0$$\n由于分析是无偏的，均方分析误差等于其方差，即 $\\operatorname{Var}(e_{a}) = E[e_{a}^{2}]$。由于误差 $e_{b}$ 和 $\\varepsilon$ 是独立的，所以 $E[e_{b}\\varepsilon] = E[e_{b}]E[\\varepsilon]=0$。方差为：\n$$E[e_{a}^{2}] = E[((1-K)e_{b} + K\\varepsilon)^{2}] = (1-K)^{2}E[e_{b}^{2}] + K^{2}E[\\varepsilon^{2}] + 2K(1-K)E[e_{b}\\varepsilon]$$\n$$E[e_{a}^{2}] = (1-K)^{2}\\sigma_{b}^{2} + K^{2}\\sigma_{r}^{2}$$\n其中 $\\sigma_{b}^{2} = \\operatorname{Var}(e_{b})$ 和 $\\sigma_{r}^{2} = \\operatorname{Var}(\\varepsilon)$。\n\n### 第1部分：增益 $K(\\alpha)$ 和分析增量的推导\n\nOI增益是通过在*假定*的误差统计量下最小化均方分析误差来计算的。系统假定观测误差方差为 $R_{\\text{assumed}} = \\alpha\\,\\sigma_{r}^{2}$。因此，选择增益 $K(\\alpha)$ 以最小化成本函数 $J_{\\text{assumed}}(K)$：\n$$J_{\\text{assumed}}(K) = (1-K)^{2}\\sigma_{b}^{2} + K^{2}(\\alpha\\sigma_{r}^{2})$$\n为求最小值，我们对 $K$ 求导并令结果为零：\n$$\\frac{dJ_{\\text{assumed}}}{dK} = -2(1-K)\\sigma_{b}^{2} + 2K(\\alpha\\sigma_{r}^{2}) = 0$$\n$$- \\sigma_{b}^{2} + K\\sigma_{b}^{2} + K\\alpha\\sigma_{r}^{2} = 0$$\n$$K(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}) = \\sigma_{b}^{2}$$\n这给出了增益 $K(\\alpha)$ 的表达式：\n$$K(\\alpha) = \\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}}$$\n为证明 $K(\\alpha)$ 随 $\\alpha$ 减小而增大，我们考察其关于 $\\alpha$ 的导数：\n$$\\frac{dK(\\alpha)}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\sigma_{b}^{2} (\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{-1} \\right) = -\\sigma_{b}^{2}(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{-2}(\\sigma_{r}^{2}) = -\\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}}$$\n由于 $\\sigma_{b}^{2} > 0$ 且 $\\sigma_{r}^{2} > 0$，导数 $\\frac{dK(\\alpha)}{d\\alpha}$ 对于 $\\alpha>0$ 总是负的。因此，$K(\\alpha)$ 是 $\\alpha$ 的一个严格递减函数。随着 $\\alpha$ 减小（即，观测被更加信任），增益 $K(\\alpha)$ 增大。\n\n分析增量为 $d \\equiv x_{a} - x_{b} = K(\\alpha)(y - x_{b})$。增量的期望平方大小是 $E[d^2]$。新息 $y - x_{b}$ 的均值为零，其方差使用*真实*统计量计算：\n$$\\operatorname{Var}(y-x_{b}) = \\operatorname{Var}(\\varepsilon - e_{b}) = \\operatorname{Var}(\\varepsilon) + \\operatorname{Var}(e_{b}) = \\sigma_{r}^{2} + \\sigma_{b}^{2}$$\n期望平方增量为：\n$$E[d^{2}] = E[(K(\\alpha)(y-x_{b}))^{2}] = K(\\alpha)^{2}E[(y-x_{b})^{2}] = K(\\alpha)^{2}(\\sigma_{r}^{2} + \\sigma_{b}^{2})$$\n由于 $K(\\alpha)$ 是 $\\alpha$ 的递减函数，所以 $K(\\alpha)^{2}$ 也是 $\\alpha$ 的递减函数。因此，$E[d^{2}]$ 是 $\\alpha$ 的递减函数。对 $R$ 的低估对应于使用 $\\alpha < 1$。因为 $E[d^2]$ 是 $\\alpha$ 的递减函数，所以当 $\\alpha < 1$ 时 $E[d^2]$ 的值大于其在 $\\alpha=1$（正确情况）时的值。这表明当观测误差方差被低估时，分析增量的期望大小更大。\n\n### 第2部分：分析误差的真实方差 $A(\\alpha)$\n\n分析误差的真实方差 $A(\\alpha) = \\operatorname{Var}(x_a - x)$，是使用次优增益 $K(\\alpha)$ 但采用*真实*误差方差 $\\sigma_{b}^{2}$ 和 $\\sigma_{r}^{2}$ 计算的。\n根据我们的初始推导，分析误差方差的一般形式为 $E[e_{a}^{2}] = (1-K)^{2}\\sigma_{b}^{2} + K^{2}\\sigma_{r}^{2}$。我们代入 $K=K(\\alpha)$：\n$$A(\\alpha) = (1-K(\\alpha))^{2}\\sigma_{b}^{2} + K(\\alpha)^{2}\\sigma_{r}^{2}$$\n我们有 $K(\\alpha) = \\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}}$ 和 $1 - K(\\alpha) = \\frac{\\alpha\\sigma_{r}^{2}}{\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}}$。将这些代入 $A(\\alpha)$ 的表达式中：\n$$A(\\alpha) = \\left(\\frac{\\alpha\\sigma_{r}^{2}}{\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}}\\right)^{2}\\sigma_{b}^{2} + \\left(\\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2}}\\right)^{2}\\sigma_{r}^{2}$$\n$$A(\\alpha) = \\frac{\\alpha^{2}\\sigma_{r}^{4}\\sigma_{b}^{2} + \\sigma_{b}^{4}\\sigma_{r}^{2}}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}} = \\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}(\\alpha^{2}\\sigma_{r}^{2} + \\sigma_{b}^{2})}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}}$$\n\n### 第3部分：真实后验方差 $A_{\\text{true}}$\n\n真实后验方差 $A_{\\text{true}} = \\operatorname{Var}(x \\mid y)$ 是最小可能的分析误差方差，当增益使用正确的观测误差方差（即 $\\alpha=1$）计算时达到。我们可以通过计算 $A(\\alpha)$ 在 $\\alpha=1$ 时的值来求得 $A_{\\text{true}}$。\n$$A_{\\text{true}} = A(1) = \\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}(1^{2}\\sigma_{r}^{2} + \\sigma_{b}^{2})}{(\\sigma_{b}^{2} + 1\\cdot\\sigma_{r}^{2})^{2}} = \\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}(\\sigma_{r}^{2} + \\sigma_{b}^{2})}{(\\sigma_{b}^{2} + \\sigma_{r}^{2})^{2}}$$\n$$A_{\\text{true}} = \\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}}{\\sigma_{b}^{2} + \\sigma_{r}^{2}}$$\n这是标量最优插值中分析误差方差的标准公式。\n\n### 第4部分：过拟合因子 $\\gamma(\\alpha)$\n\n过拟合因子定义为比率 $\\gamma(\\alpha) \\equiv \\frac{A(\\alpha)}{A_{\\text{true}}}$。使用上面推导的表达式：\n$$\\gamma(\\alpha) = \\frac{\\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}(\\sigma_{b}^{2} + \\alpha^{2}\\sigma_{r}^{2})}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}}}{\\frac{\\sigma_{b}^{2}\\sigma_{r}^{2}}{\\sigma_{b}^{2} + \\sigma_{r}^{2}}}$$\n消去公因子 $\\sigma_{b}^{2}\\sigma_{r}^{2}$：\n$$\\gamma(\\alpha) = \\frac{(\\sigma_{b}^{2} + \\alpha^{2}\\sigma_{r}^{2})(\\sigma_{b}^{2} + \\sigma_{r}^{2})}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}}$$\n这就是所求的 $\\gamma(\\alpha)$ 的闭式表达式。\n\n为了证明对于 $0 < \\alpha < 1$ 有 $\\gamma(\\alpha) > 1$，我们必须证明不等式：\n$$\\frac{(\\sigma_{b}^{2} + \\alpha^{2}\\sigma_{r}^{2})(\\sigma_{b}^{2} + \\sigma_{r}^{2})}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}} > 1$$\n让我们定义一个无量纲的方差比 $S = \\frac{\\sigma_{b}^{2}}{\\sigma_{r}^{2}}$。由于方差是正的，所以 $S>0$。我们可以通过将分子和分母同除以 $\\sigma_r^4$ 来重写该不等式：\n$$\\frac{(\\frac{\\sigma_{b}^{2}}{\\sigma_{r}^{2}} + \\alpha^{2})(\\frac{\\sigma_{b}^{2}}{\\sigma_{r}^{2}} + 1)}{(\\frac{\\sigma_{b}^{2}}{\\sigma_{r}^{2}} + \\alpha)^{2}} = \\frac{(S + \\alpha^{2})(S+1)}{(S+\\alpha)^{2}} > 1$$\n由于分母 $(S+\\alpha)^{2}$ 是正的，我们可以两边同乘以它而不改变不等号的方向：\n$$(S + \\alpha^{2})(S+1) > (S+\\alpha)^{2}$$\n展开两边：\n$$S^{2} + S + \\alpha^{2}S + \\alpha^{2} > S^{2} + 2\\alpha S + \\alpha^{2}$$\n两边减去 $S^{2}+\\alpha^{2}$ 得：\n$$S + \\alpha^{2}S > 2\\alpha S$$\n由于 $S > 0$，我们可以除以 $S$：\n$$1 + \\alpha^{2} > 2\\alpha$$\n整理各项得：\n$$1 - 2\\alpha + \\alpha^{2} > 0$$\n$$(1-\\alpha)^{2} > 0$$\n这个不等式对所有实数 $\\alpha$ 成立，除了 $\\alpha=1$。问题指定 $0 < \\alpha < 1$，在这个范围内不等式 $(1-\\alpha)^{2} > 0$ 严格成立。因此，对于 $0 < \\alpha < 1$ 有 $\\gamma(\\alpha) > 1$。这证实了低估观测误差方差会导致分析的真实准确性低于最优分析，这种现象称为过拟合。",
            "answer": "$$\\boxed{\\frac{(\\sigma_{b}^{2} + \\sigma_{r}^{2})(\\sigma_{b}^{2} + \\alpha^{2}\\sigma_{r}^{2})}{(\\sigma_{b}^{2} + \\alpha\\sigma_{r}^{2})^{2}}}$$"
        }
    ]
}