{
    "hands_on_practices": [
        {
            "introduction": "观测系统仿真实验（OSSE）的核心在于模拟观测过程，而前向算子（forward operator）是连接模型“真实”状态与模拟观测值的桥梁。本练习要求您为一个Argo浮标构建一个实际的前向算子，该算子需考虑仪器响应时间和空间平均等物理效应。掌握这一技能是构建任何OSSE系统的基础。",
            "id": "3805663",
            "problem": "您的任务是为计算海洋学中的观测系统模拟实验 (OSSEs) 设计并实现一个前向算子，该算子将一维海洋模型状态映射为类似于 Argo 剖面浮标温度测量的合成观测数据。该前向算子必须包含从模型网格到连续深度的垂直插值，并考虑仪器在上升轨迹上的测量响应特性。\n\n使用的基本假设和定义：\n- 观测系统模拟实验 (OSSE) 将观测表示为作用于模型状态的前向算子的输出，并加上潜在的测量和表示误差。前向算子以物理上一致的方式将状态变量映射到观测物理量。\n- Argo 剖面浮标以恒定的垂直速度在水体中上升，并使用具有有限响应时间的一阶传感器测量原位温度。因此，在给定深度报告的温度并非完美的瞬时样本，而是一个受浮标运动和传感器动力学影响的、经过垂直滤波的量。\n\n模型状态和海洋情景：\n- 考虑一个一维垂直模型，其深度坐标为 $z$（单位：米），其中 $z=0$ 对应于海面，增加的 $z$ 对应于更深的水域。\n- 合成“真实”海洋温度剖面定义在一个离散的模型网格上，$z$ 值从 $z_{\\min} = 0$ 到 $z_{\\max} = 2000$，均匀间距为 $\\Delta z = 20$ 米。温度场由下式给出\n$$\nT(z) = T_0 - \\Delta T \\cdot \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{z - z_0}{w}\\right)\\right),\n$$\n参数为 $T_0 = 20$ (摄氏度)，$\\Delta T = 16$ (摄氏度)，$z_0 = 300$ (米)，以及 $w = 80$ (米)。这代表了一个从温暖表层水到较冷深层水的真实温跃层过渡。\n\n测量响应和前向算子要求：\n- 在观测深度 $d$ 处的前向算子必须是根据一个有物理动机的测量核对 $T(z)$ 进行垂直滤波后的值。两个独立的物理效应对此核有贡献：\n  1. 一个对称的空间平均分量，由标准差为 $\\sigma_g$ (米) 的高斯核建模，\n  $$\n  G_\\sigma(z - d) = \\exp\\!\\left(-\\frac{(z - d)^2}{2\\sigma_g^2}\\right).\n  $$\n  2. 一个由时间常数为 $\\tau$ (秒) 和上升速度为 $v$ (米/秒) 的一阶传感器响应引起的单边指数分量。乘积 $L = v\\tau$ (米) 是特征垂直响应长度。对于上升的浮标，在深度 $d$ 处的测量值受到更深处 $z \\ge d$ 水体的影响，权重为\n  $$\n  E_L(z - d) = \n  \\begin{cases}\n  \\exp\\!\\left(-\\frac{z - d}{L}\\right), & z \\ge d, \\\\\n  0, & z  d.\n  \\end{cases}\n  $$\n- 在深度 $d$ 处的组合测量核是以下两者的乘积\n$$\nK(d, z) = G_\\sigma(z - d)\\,E_L(z - d),\n$$\n它必须在计算的有限域上进行归一化。\n- 在深度 $d$ 处的合成观测必须计算为 $T(z)$ 与 $K(d, z)$ 在 $z$ 上的归一化加权积分：\n$$\ny(d) = \\frac{\\int_{z_{\\min}}^{z_{\\max}} T(z)\\,K(d, z)\\,dz}{\\int_{z_{\\min}}^{z_{\\max}} K(d, z)\\,dz}.\n$$\n- 垂直插值：因为 $T(z)$ 定义在离散的模型层上，您的前向算子必须首先将 $T(z)$ 垂直插值到一个更精细的评估网格上，然后再应用核积分。使用分段线性插值在精细网格上生成 $T(z)$，该网格应能充分解析核函数。您可以选择一个精细网格间距 $\\delta z$（米）以确保数值精度。\n- 必须处理的极限情况：\n  - 如果 $\\tau = 0$，则 $L = 0$，指数分量退化为无滤波；核函数必须简化为仅高斯分量。如果此外 $\\sigma_g = 0$，核函数退化为狄拉克δ函数，前向算子简化为在 $d$ 处对 $T(z)$ 进行简单的线性插值。\n  - 如果 $\\sigma_g = 0$ 且 $\\tau  0$，核函数纯粹是由仪器响应引起的单边指数。\n\n数值单位和输出要求：\n- 深度单位为米。速度 $v$ 单位为米/秒。时间常数 $\\tau$ 单位为秒。温度必须以摄氏度计算并以十进制浮点数报告。\n- 本问题不涉及角度。\n- 本问题不涉及百分比。\n\n测试套件：\n实现您的程序，为以下参数集和观测深度计算合成观测。对于每个参数集，计算所有指定深度 $d_j$ 处的合成观测 $y(d_j)$，并将所有结果聚合到一个扁平列表中（按下列顺序列出）。\n\n1. 标准情况：中等仪器平滑。\n   - 上升速度 $v = 0.08$ (米/秒)，响应时间 $\\tau = 10$ (秒)，高斯宽度 $\\sigma_g = 2$ (米)，精细网格间距 $\\delta z = 1$ (米)，深度 $[50, 300, 1000]$ (米)。\n2. 近表层边界情况：纯指数核（无高斯）。\n   - 上升速度 $v = 0.06$ (米/秒)，响应时间 $\\tau = 30$ (秒)，高斯宽度 $\\sigma_g = 0$ (米)，精细网格间距 $\\delta z = 1$ (米)，深度 $[5]$ (米)。\n3. 退化核情况：纯插值（无平滑）。\n   - 上升速度 $v = 0.10$ (米/秒)，响应时间 $\\tau = 0$ (秒)，高斯宽度 $\\sigma_g = 0$ (米)，精细网格间距 $\\delta z = 1$ (米)，深度 $[123.4]$ (米)。\n4. 强平滑和近底层情况：组合高斯和指数，包括近域边界。\n   - 上升速度 $v = 0.08$ (米/秒)，响应时间 $\\tau = 60$ (秒)，高斯宽度 $\\sigma_g = 8$ (米)，精细网格间距 $\\delta z = 1$ (米)，深度 $[800, 1500, 1950]$ (米)。\n\n算法设计约束：\n- 您必须完全按照描述实现前向算子：将离散模型温度剖面 $T(z)$ 插值到精细网格，并在截断的域上数值评估归一化的核积分。在实际使用的域上对核进行重新归一化，以避免边界附近的偏差。\n- 根据物理推理，明确并一致地处理所有极限情况。\n- 不要使用任何外部数据；必须按原样使用提供的合成温度剖面和参数。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含所有计算出的合成观测值，以摄氏度表示，按照所有参数集所述的深度顺序聚合，作为一个逗号分隔的列表，并用方括号括起来（例如，$[y_1,y_2,\\dots,y_N]$）。每个值必须是十进制浮点数。不得打印任何其他文本。",
            "solution": "所呈现的问题陈述是有效的。它在科学上基于物理海洋学和仪器测量的原理，问题提法适定，提供了所有必要的信息和约束，并且其表述是客观的。任务是为观测系统模拟实验 (OSSE) 构建一个数值前向算子，这是一种在地球科学中用于评估观测系统潜在影响的标准技术。\n\n前向算子，表示为 $y(d)$，将模型状态——一个垂直温度剖面 $T(z)$——映射到指定深度 $d$ 的合成观测。这个过程模拟了上升的 Argo 剖面浮标所进行的测量，包含了空间平均和传感器时间响应的物理效应。\n\n该问题将通过按照提供的数学和算法规范实现前向算子来解决。步骤如下：\n1.  在离散模型网格上定义合成的“真实”海洋状态。\n2.  实现一个分段线性插值方案，以在更精细的计算网格上表示温度剖面。\n3.  通过组合其高斯和指数分量来构建测量核 $K(d, z)$，并仔细处理指定的极限情况。\n4.  通过数值计算插值后温度剖面与核的归一化加权积分来计算合成观测 $y(d)$。\n\n**1. 海洋模型状态**\n\n合成海洋由一个一维垂直温度剖面 $T(z)$ 描述，其中 $z$ 是深度（单位：米）。海面位于 $z=0$。 “真实”温度由以下函数给出：\n$$\nT(z) = T_0 - \\Delta T \\cdot \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{z - z_0}{w}\\right)\\right)\n$$\n提供的参数为 $T_0 = 20 \\,^{\\circ}\\mathrm{C}$，$\\Delta T = 16 \\,^{\\circ}\\mathrm{C}$，$z_0 = 300 \\, \\mathrm{m}$，以及 $w = 80 \\, \\mathrm{m}$。该函数模拟了一个温跃层，即一个以深度 $z_0$ 为中心的温度快速变化区域。\n\n这个连续剖面最初定义在一个离散的模型网格上，其深度 $z_m$ 从 $z_{\\min} = 0 \\, \\mathrm{m}$ 到 $z_{\\max} = 2000 \\, \\mathrm{m}$，均匀间距为 $\\Delta z = 20 \\, \\mathrm{m}$。\n\n**2. 前向算子和测量核**\n\n在观测深度 $d$ 处的合成观测 $y(d)$ 是温度剖面 $T(z)$ 经过测量核 $K(d, z)$ 滤波后的结果，数学上表示为一个归一化积分：\n$$\ny(d) = \\frac{\\int_{z_{\\min}}^{z_{\\max}} T(z)\\,K(d, z)\\,dz}{\\int_{z_{\\min}}^{z_{\\max}} K(d, z)\\,dz}\n$$\n通过在计算域 $[z_{\\min}, z_{\\max}]$ 上对核的积分进行归一化，对于防止偏差至关重要，特别是对于靠近域边界的观测，因为那里的核可能会被截断。\n\n核 $K(d, z)$ 是两个分量的乘积：\n$K(d, z) = G_\\sigma(z - d) \\cdot E_L(z - d)$。\n\n- 高斯分量 $G_\\sigma$ 模拟对称的空间平均：\n    $$\n    G_\\sigma(z - d) = \\exp\\!\\left(-\\frac{(z - d)^2}{2\\sigma_g^2}\\right)\n    $$\n    其中 $\\sigma_g$ 是标准差（单位：米）。\n\n- 单边指数分量 $E_L$ 模拟上升传感器的一阶响应：\n    $$\n    E_L(z - d) = \n    \\begin{cases}\n    \\exp\\!\\left(-\\frac{z - d}{L}\\right),  \\text{for } z \\ge d \\\\\n    0,  \\text{for } z  d\n    \\end{cases}\n    $$\n    这里，$L = v\\tau$ 是特征响应长度，其中 $v$ 是浮标的上升速度，$\\tau$ 是传感器的响应时间常数。该项反映了在深度 $d$ 处的测量受到浮标刚刚经过的更深水域 ($z \\ge d$) 的影响。\n\n**3. 数值实现**\n\n$y(d)$ 的连续积分通过数值方法近似。\n\n**步骤 A：插值到精细网格**\n模型仅在离散深度 $z_m$ 处提供温度值。为了精确地解析核函数，我们首先创建一个具有小间距 $\\delta z$（例如，$\\delta z = 1 \\, \\mathrm{m}$）的精细计算网格 $z_{fine}$。然后使用分段线性插值将温度剖面从粗糙模型网格插值到这个精细网格。这为精细网格上的每个点 $z_i$ 提供了高分辨率剖面 $T_{fine}(z_i)$。\n\n**步骤 B：核函数评估和极限情况**\n对于给定的观测深度 $d$，在精细网格的每个点 $z_i$ 处评估核 $K(d, z_i)$。实现必须正确处理规定的极限情况：\n- **一般情况 ($\\sigma_g > 0, \\tau > 0$)：** 计算高斯和指数分量并将它们相乘形成核。\n- **纯指数情况 ($\\sigma_g = 0, \\tau > 0$)：** 问题陈述指出核简化为指数分量 $E_L(z-d)$。这通过将高斯因子视为一来处理。\n- **纯高斯情况 ($\\sigma_g > 0, \\tau = 0$)：** 问题陈述指出指数分量退化为“无滤波”。这通过将指数因子视为一来处理。\n- **退化情况 ($\\sigma_g = 0, \\tau = 0$)：** 问题明确指出核退化为狄拉克δ函数，并且前向算子简化为在深度 $d$ 处对 $T(z)$ 进行简单的线性插值。这种情况必须单独处理，绕过核积分，直接从原始模型网格插值温度。\n\n**步骤 C：数值积分（加权平均）**\n归一化积分近似为在精细网格点 $z_i$ 上的离散加权和：\n$$\ny(d) \\approx \\frac{\\sum_{i} T_{fine}(z_i) \\cdot K(d, z_i) \\cdot \\delta z}{\\sum_{i} K(d, z_i) \\cdot \\delta z} = \\frac{\\sum_{i} T_{fine}(z_i) \\cdot K(d, z_i)}{\\sum_{i} K(d, z_i)}\n$$\n这等同于精细网格温度的加权平均，其中权重由核函数值给出。对每个所需的观测深度 $d$ 和每组参数 $(v, \\tau, \\sigma_g)$ 执行此计算。然后将结果按规定聚合到单个列表中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to compute synthetic observations for all test cases.\n    \"\"\"\n    \n    # Define model parameters as specified in the problem statement.\n    T0 = 20.0     # degrees Celsius\n    DT = 16.0     # degrees Celsius\n    z0 = 300.0    # meters\n    w = 80.0      # meters\n    z_min = 0.0   # meters\n    z_max = 2000.0 # meters\n    dz_model = 20.0 # meters\n\n    # Create the discrete model grid and compute the \"true\" temperature profile on it.\n    z_model = np.arange(z_min, z_max + dz_model, dz_model)\n    T_model = T0 - DT * 0.5 * (1 + np.tanh((z_model - z0) / w))\n    \n    # Define a reusable function for the forward operator.\n    def forward_operator(obs_depths, v, tau, sigma_g, dz_fine, z_model_grid, T_model_profile):\n        \"\"\"\n        Computes synthetic observations for a set of depths and parameters.\n\n        Args:\n            obs_depths (list): List of observation depths in meters.\n            v (float): Ascent speed in m/s.\n            tau (float): Sensor time constant in seconds.\n            sigma_g (float): Gaussian standard deviation in meters.\n            dz_fine (float): Fine-grid spacing in meters.\n            z_model_grid (np.ndarray): The model depth grid.\n            T_model_profile (np.ndarray): The temperature profile on the model grid.\n\n        Returns:\n            list: A list of computed synthetic observation values.\n        \"\"\"\n        \n        # Handle the degenerate case: pure interpolation (no smoothing)\n        if tau == 0.0 and sigma_g == 0.0:\n            # As per problem, this reduces to simple linear interpolation of T(z) at d.\n            return [np.interp(d, z_model_grid, T_model_profile) for d in obs_depths]\n\n        # Create the fine evaluation grid\n        z_fine = np.arange(z_model_grid[0], z_model_grid[-1] + dz_fine, dz_fine)\n        \n        # Interpolate the model temperature to the fine grid\n        T_fine = np.interp(z_fine, z_model_grid, T_model_profile)\n        \n        results = []\n        for d in obs_depths:\n            # Initialize kernel as an array of ones\n            kernel = np.ones_like(z_fine)\n            \n            # 1. Gaussian component\n            if sigma_g  0:\n                gaussian_term = np.exp(-((z_fine - d)**2) / (2 * sigma_g**2))\n                kernel *= gaussian_term\n            \n            # 2. Exponential component\n            if tau  0:\n                L = v * tau\n                if L  0: # Avoid division by zero if v=0\n                    exp_term = np.zeros_like(z_fine)\n                    # Apply for z = d, as per definition of E_L(z-d)\n                    mask = z_fine = d\n                    exp_term[mask] = np.exp(-(z_fine[mask] - d) / L)\n                    kernel *= exp_term\n                # if L=0 (from v=0, tau0), exp_term remains zero, effectively nullifying the signal, which is physically consistent.\n            \n            # Compute the normalized weighted average\n            numerator = np.sum(T_fine * kernel)\n            denominator = np.sum(kernel)\n            \n            # Avoid division by zero, though unlikely with the given parameters.\n            if denominator  0:\n                y_d = numerator / denominator\n            else:\n                # If kernel is zero everywhere, interpolate as a fallback.\n                y_d = np.interp(d, z_fine, T_fine)\n            \n            results.append(y_d)\n            \n        return results\n\n    # Test suite parameters\n    test_cases = [\n        # 1. Happy-path case: Moderate instrument smoothing.\n        {'v': 0.08, 'tau': 10, 'sigma_g': 2, 'dz_fine': 1, 'depths': [50, 300, 1000]},\n        # 2. Boundary near-surface case: Purely exponential kernel (no Gaussian).\n        {'v': 0.06, 'tau': 30, 'sigma_g': 0, 'dz_fine': 1, 'depths': [5]},\n        # 3. Degenerate kernel case: Pure interpolation (no smoothing).\n        {'v': 0.10, 'tau': 0, 'sigma_g': 0, 'dz_fine': 1, 'depths': [123.4]},\n        # 4. Strong smoothing and near-bottom case: Combined Gaussian and exponential.\n        {'v': 0.08, 'tau': 60, 'sigma_g': 8, 'dz_fine': 1, 'depths': [800, 1500, 1950]},\n    ]\n    \n    all_results = []\n    for case in test_cases:\n        results_for_case = forward_operator(\n            obs_depths=case['depths'], \n            v=case['v'], \n            tau=case['tau'], \n            sigma_g=case['sigma_g'],\n            dz_fine=case['dz_fine'],\n            z_model_grid=z_model, \n            T_model_profile=T_model\n        )\n        all_results.extend(results_for_case)\n\n    # Format the final output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "一个逼真的OSSE不仅需要模拟观测值本身，还需要精确地刻画其误差。本练习将引导您构建观测误差协方差矩阵$R$，它结合了不相关的仪器噪声和空间相关的代表性误差。通过使用物理原理（例如斜压变形半径）来为相关误差建模，您可以显着提高OSSE研究的可信度和现实意义。",
            "id": "3805690",
            "problem": "在观测系统模拟实验（OSSEs）的背景下，考虑一组位于 $x_1=0\\,\\mathrm{km}$、$x_2=20\\,\\mathrm{km}$ 和 $x_3=50\\,\\mathrm{km}$ 的一维沿轨海面高度观测点。该观测系统是一个沿轨卫星高度计，它对一个高分辨率海洋模型进行采样，其数据随后被稀疏化到一个更粗的分析网格上。总观测误差被建模为两个分量的和：一个是空间不相关的仪器噪声，其方差 $\\sigma^2$ 已知；另一个是由未解析、空间相关的中尺度变率引起的代表性误差。假设仪器噪声方差为 $\\sigma^2=4.0\\times 10^{-4}\\,\\mathrm{m}^2$，代表性误差协方差函数是各向同性的，由下式给出\n$$\nC(r)=\\sigma_r^2 \\exp\\!\\left(-\\frac{r}{L}\\right),\n$$\n其中代表性误差方差为 $\\sigma_r^2=2.5\\times 10^{-3}\\,\\mathrm{m}^2$，相关长度 $L$ 未知。\n\n在简化重力、第一斜压模框架下，利用相速度 $c$ 和科里奥利参数 $f$ 估算斜压变形半径 $R_1$，其中 $c=\\sqrt{g' H}$ 且 $R_1=c/f$。取简化重力 $g'=2.0\\times 10^{-2}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，上层厚度 $H=100\\,\\mathrm{m}$，中纬度科里奥利参数 $f=1.0\\times 10^{-4}\\,\\mathrm{s}^{-1}$。请从第一性原理出发，论证在此 OSSE 配置中，对于中尺度主导的代表性误差，将代表性相关长度 $L$ 设置为等于斜压变形半径 $R_1$ 为何是物理上合理的。\n\n然后，对于给定的观测位置，构建完整的 $3\\times 3$ 观测误差协方差矩阵 $R$，该矩阵结合了不相关的仪器噪声和相关的代表性误差。将 $R$ 的所有元素以 $\\mathrm{m}^2$ 为单位表示，并将每个元素四舍五入到四位有效数字。你的最终答案必须仅为矩阵 $R$。",
            "solution": "该问题被评估为有效。它在科学上基于物理海洋学和数据同化的原理，问题提法适定，信息充分，可得唯一解，并以客观、正式的语言陈述。求解过程分三个阶段：首先，计算斜压变形半径 $R_1$；其次，为将代表性误差相关长度 $L$ 等同于 $R_1$ 提供物理依据；第三，构建总观测误差协方差矩阵 $R$。\n\n阶段 1：计算斜压变形半径 $R_1$\n\n第一斜压 Rossby 变形半径 $R_1$ 定义为第一斜压模重力波相速度 $c$ 与科里奥利参数 $f$ 的比值。相速度 $c$ 由 $c=\\sqrt{g' H}$ 给出。已知条件为：\n- 简化重力 $g' = 2.0 \\times 10^{-2}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- 上层厚度 $H = 100\\,\\mathrm{m}$\n- 科里奥利参数 $f = 1.0 \\times 10^{-4}\\,\\mathrm{s}^{-1}$\n\n首先，我们计算相速度 $c$：\n$$\nc = \\sqrt{g' H} = \\sqrt{(2.0 \\times 10^{-2}\\,\\mathrm{m}\\,\\mathrm{s}^{-2}) \\times (100\\,\\mathrm{m})} = \\sqrt{2.0}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n接下来，我们计算变形半径 $R_1$：\n$$\nR_1 = \\frac{c}{f} = \\frac{\\sqrt{2.0}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{1.0 \\times 10^{-4}\\,\\mathrm{s}^{-1}} = \\sqrt{2.0} \\times 10^4\\,\\mathrm{m}\n$$\n为了在协方差计算中方便使用，我们将其转换为千米：\n$$\nR_1 = \\sqrt{2.0} \\times 10^4\\,\\mathrm{m} = 10\\sqrt{2}\\,\\mathrm{km} \\approx 14.14\\,\\mathrm{km}\n$$\n\n阶段 2：设置 $L = R_1$ 的物理依据\n\n问题指出，代表性误差源于未解析的中尺度变率。该误差分量量化了点观测值与代表更大面积或体积的粗分辨率模型状态变量值之间的差异。在 OSSE 的背景下，“真值”是一个解析了中尺度特征的高分辨率自然运行，而分析则在未解析这些特征的较粗网格上进行。\n\n在中纬度海洋中，数十至数百公里尺度上动能变率的主要形式与中尺度涡和弯流相关。控制这些特征大小的基本水平长度尺度是第一斜压 Rossby 变形半径 $R_1$。斜压不稳定性是产生中尺度涡的主要机制，在与 $R_1$ 成正比的波长处最为有效。由此产生的涡具有与 $R_1$ 同量级的特征半径，因此也具有相应的空间相干尺度。\n\n由于本问题中的代表性误差明确归因于未解析的中尺度变率，其统计特性，特别是其空间相关结构，必须反映该变率的物理特性。因此，误差场的相关长度尺度 $L$ 应与未解析特征的特征尺寸相对应。由于 $R_1$ 是这些中尺度涡的自然长度尺度，在海洋数据同化中，将代表性误差相关长度 $L$ 设置为等于第一斜压变形半径 $R_1$ 是一种成熟且物理上合理的做法。因此，我们设定 $L=R_1=10\\sqrt{2}\\,\\mathrm{km}$。\n\n阶段 3：构建观测误差协方差矩阵 $R$\n\n总观测误差协方差矩阵 $R$ 是仪器噪声协方差矩阵 $R_{instr}$ 和代表性误差协方差矩阵 $R_{rep}$ 的和：\n$$\nR = R_{instr} + R_{rep}\n$$\n观测位置为 $x_1=0\\,\\mathrm{km}$、$x_2=20\\,\\mathrm{km}$ 和 $x_3=50\\,\\mathrm{km}$。\n\n仪器噪声是空间不相关的，方差为 $\\sigma^2 = 4.0 \\times 10^{-4}\\,\\mathrm{m}^2$。其协方差矩阵是对角的：\n$$\nR_{instr} = \\sigma^2 I_3 = \\begin{pmatrix} \\sigma^2  0  0 \\\\ 0  \\sigma^2  0 \\\\ 0  0  \\sigma^2 \\end{pmatrix} = \\begin{pmatrix} 4.0 \\times 10^{-4}  0  0 \\\\ 0  4.0 \\times 10^{-4}  0 \\\\ 0  0  4.0 \\times 10^{-4} \\end{pmatrix}\\,\\mathrm{m}^2\n$$\n\n代表性误差是空间相关的。其协方差矩阵的元素 $(R_{rep})_{ij}$ 由协方差函数 $C(r_{ij}) = \\sigma_r^2 \\exp(-r_{ij}/L)$ 给出，其中 $r_{ij} = |x_i - x_j|$ 是观测点 $i$ 和 $j$ 之间的距离。我们有 $\\sigma_r^2 = 2.5 \\times 10^{-3}\\,\\mathrm{m}^2$ 和 $L=10\\sqrt{2}\\,\\mathrm{km}$。\n首先，我们计算以千米为单位的距离矩阵 $r_{ij}$：\n$$\nr_{12} = |x_1 - x_2| = |0 - 20| = 20\\,\\mathrm{km}\n$$\n$$\nr_{13} = |x_1 - x_3| = |0 - 50| = 50\\,\\mathrm{km}\n$$\n$$\nr_{23} = |x_2 - x_3| = |20 - 50| = 30\\,\\mathrm{km}\n$$\n根据对称性，$r_{ji}=r_{ij}$，且 $r_{ii}=0$。\n\n$R_{rep}$ 的对角元素是方差 $\\sigma_r^2$：\n$$\n(R_{rep})_{11} = (R_{rep})_{22} = (R_{rep})_{33} = C(0) = \\sigma_r^2 \\exp(0) = 2.5 \\times 10^{-3}\\,\\mathrm{m}^2\n$$\n非对角元素为：\n$$\n(R_{rep})_{12} = (R_{rep})_{21} = C(20) = (2.5 \\times 10^{-3}) \\exp\\left(-\\frac{20}{10\\sqrt{2}}\\right) = (2.5 \\times 10^{-3}) \\exp(-\\sqrt{2}) \\approx 6.07796 \\times 10^{-4}\\,\\mathrm{m}^2\n$$\n$$\n(R_{rep})_{13} = (R_{rep})_{31} = C(50) = (2.5 \\times 10^{-3}) \\exp\\left(-\\frac{50}{10\\sqrt{2}}\\right) = (2.5 \\times 10^{-3}) \\exp\\left(-\\frac{5}{\\sqrt{2}}\\right) \\approx 7.28601 \\times 10^{-5}\\,\\mathrm{m}^2\n$$\n$$\n(R_{rep})_{23} = (R_{rep})_{32} = C(30) = (2.5 \\times 10^{-3}) \\exp\\left(-\\frac{30}{10\\sqrt{2}}\\right) = (2.5 \\times 10^{-3}) \\exp\\left(-\\frac{3}{\\sqrt{2}}\\right) \\approx 2.99651 \\times 10^{-4}\\,\\mathrm{m}^2\n$$\n\n现在我们组合 $R_{instr}$ 和 $R_{rep}$ 以形成 $R$。元素 $R_{ij}$ 由 $R_{ij} = (R_{instr})_{ij} + (R_{rep})_{ij}$ 给出。\n对角元素为：\n$$\nR_{11} = R_{22} = R_{33} = \\sigma^2 + \\sigma_r^2 = (4.0 \\times 10^{-4}) + (2.5 \\times 10^{-3}) = (0.4 \\times 10^{-3}) + (2.5 \\times 10^{-3}) = 2.9 \\times 10^{-3}\\,\\mathrm{m}^2\n$$\n由于 $R_{instr}$ 是对角矩阵，非对角元素就是 $R_{rep}$ 的元素。将所有元素四舍五入到四位有效数字：\n$R_{11} = R_{22} = R_{33} = 2.900 \\times 10^{-3}\\,\\mathrm{m}^2$\n$R_{12} = R_{21} \\approx 6.078 \\times 10^{-4}\\,\\mathrm{m}^2$\n$R_{13} = R_{31} \\approx 7.286 \\times 10^{-5}\\,\\mathrm{m}^2$\n$R_{23} = R_{32} \\approx 2.997 \\times 10^{-4}\\,\\mathrm{m}^2$\n\n最终的观测误差协方差矩阵 $R$ 为：\n$$\nR = \\begin{pmatrix}\n2.900 \\times 10^{-3}  6.078 \\times 10^{-4}  7.286 \\times 10^{-5} \\\\\n6.078 \\times 10^{-4}  2.900 \\times 10^{-3}  2.997 \\times 10^{-4} \\\\\n7.286 \\times 10^{-5}  2.997 \\times 10^{-4}  2.900 \\times 10^{-3}\n\\end{pmatrix}\n$$\n所有元素的单位均为 $\\mathrm{m}^2$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.900 \\times 10^{-3}  6.078 \\times 10^{-4}  7.286 \\times 10^{-5} \\\\\n6.078 \\times 10^{-4}  2.900 \\times 10^{-3}  2.997 \\times 10^{-4} \\\\\n7.286 \\times 10^{-5}  2.997 \\times 10^{-4}  2.900 \\times 10^{-3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "OSSE的最终目标是量化观测系统带来的影响，即评估它在多大程度上减少了我们对地球系统状态估计的不确定性。本练习将前向算子($H$)、观测误差($R$)和先验知识($B$)整合在一起，通过数据同化计算后验（或称分析）误差协方差$P_{\\text{a}}$ 。这个结果直接衡量了所模拟的观测系统为我们知识提升所带来的价值。",
            "id": "3900301",
            "problem": "一个用于表示大尺度异常的双变量地球物理状态的观测系统模拟实验（OSSE）流程正在被构建和记录。该流程的模块及其记录的线性算子如下：\n\n- 自然运行和先验：未知状态为 $x \\in \\mathbb{R}^{2}$。先验（背景）是均值为 $0$ 且协方差为\n$$\nB = \\begin{pmatrix}\n4  1.2 \\\\\n1.2  9\n\\end{pmatrix}\n$$\n的高斯分布。\n\n- 观测模拟器：一个卫星正向算子通过以下方式将 $x$ 映射到观测空间：\n$$\nH = \\begin{pmatrix}\n1  0.5 \\\\\n0.2  1\n\\end{pmatrix}.\n$$\n原始测量值受到一个附加的、已知的常数偏差向量（该向量由一个已记录的偏差校正模块精确移除）以及均值为零、协方差为\n$$\nR = \\begin{pmatrix}\n1.0  0.3 \\\\\n0.3  2.25\n\\end{pmatrix}\n$$\n的高斯测量噪声 $v \\sim \\mathcal{N}(0,R)$ 的影响。\n\n- 质量控制和稀疏化：文档表明，两个通道都通过了质量控制，并未经稀疏化就被保留用于同化。\n\n- 数据同化：分析场是在与上述模块一致的高斯假设下，由线性最小方差估计器生成的。\n\n仅使用贝叶斯线性估计的基本原理和已记录的算子 $B$、$H$ 和 $R$，确定状态空间中的分析均方根误差（RMSE），其定义为 $\\sqrt{\\operatorname{tr}(P_{\\text{a}})/2}$，其中 $P_{\\text{a}}$ 是分析的后验误差协方差。将答案四舍五入到四位有效数字。将最终答案报告为一个无量纲数。",
            "solution": "该问题要求计算一个双变量线性估计问题的分析均方根误差（RMSE）。其框架是贝叶斯线性估计，其中状态的先验估计（背景场）通过观测信息进行更新，以产生后验估计（分析场）。\n\n背景状态向量 $x_b$ 被假定为一个随机变量，其均值为 $0$，先验误差协方差矩阵为 $B$。真实状态用 $x$ 表示。观测向量 $y$ 通过线性算子 $H$ 与真实状态相关联，并被一个均值为零、协方差矩阵为 $R$ 的附加高斯噪声 $v$ 所污染。观测模型为 $y = Hx + v$。\n\n分析状态 $x_a$ 是在给定背景 $x_b$ 和观测 $y$ 的情况下，$x$ 的最小方差估计。在所述的高斯假设下，给定观测 $y$ 的状态 $x$ 的后验概率分布也是高斯的。这个后验分布的均值是分析状态 $x_a$，其协方差是分析误差协方差矩阵 $P_a$。\n\n分析误差协方差 $P_a$ 由先验和观测精度矩阵（协方差的逆）之和的逆矩阵给出。这是线性最小方差估计理论中的一个标准结果，等价于卡尔曼滤波器中的协方差更新方程。公式是：\n$$\nP_a^{-1} = B^{-1} + H^T R^{-1} H\n$$\n我们将通过首先计算右侧的各项，将它们相加得到后验精度矩阵 $P_a^{-1}$，然后将结果求逆来计算 $P_a$。\n\n给定的矩阵是：\n$$\nB = \\begin{pmatrix} 4  1.2 \\\\ 1.2  9 \\end{pmatrix}, \\quad H = \\begin{pmatrix} 1  0.5 \\\\ 0.2  1 \\end{pmatrix}, \\quad R = \\begin{pmatrix} 1.0  0.3 \\\\ 0.3  2.25 \\end{pmatrix}\n$$\n为保持精度，我们将在适当的地方将小数值转换为分数：$1.2 = \\frac{6}{5}$，$0.5 = \\frac{1}{2}$，$0.2 = \\frac{1}{5}$，$0.3 = \\frac{3}{10}$，以及 $2.25 = \\frac{9}{4}$。\n\n首先，我们计算先验协方差矩阵 $B$ 的逆：\n$$\n\\det(B) = (4)(9) - (1.2)(1.2) = 36 - 1.44 = 34.56 = \\frac{864}{25}\n$$\n$$\nB^{-1} = \\frac{1}{34.56} \\begin{pmatrix} 9  -1.2 \\\\ -1.2  4 \\end{pmatrix} = \\frac{25}{864} \\begin{pmatrix} 9  -\\frac{6}{5} \\\\ -\\frac{6}{5}  4 \\end{pmatrix} = \\frac{1}{864} \\begin{pmatrix} 225  -30 \\\\ -30  100 \\end{pmatrix}\n$$\n\n接下来，我们计算观测误差协方差矩阵 $R$ 的逆：\n$$\n\\det(R) = (1.0)(2.25) - (0.3)(0.3) = 2.25 - 0.09 = 2.16 = \\frac{54}{25}\n$$\n$$\nR^{-1} = \\frac{1}{2.16} \\begin{pmatrix} 2.25  -0.3 \\\\ -0.3  1.0 \\end{pmatrix} = \\frac{25}{54} \\begin{pmatrix} \\frac{9}{4}  -\\frac{3}{10} \\\\ -\\frac{3}{10}  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{25}{54} \\frac{9}{4}  -\\frac{25}{54} \\frac{3}{10} \\\\ -\\frac{25}{54} \\frac{3}{10}  \\frac{25}{54} \\end{pmatrix} = \\begin{pmatrix} \\frac{25}{24}  -\\frac{5}{36} \\\\ -\\frac{5}{36}  \\frac{25}{54} \\end{pmatrix}\n$$\n\n现在我们计算 $H^T R^{-1} H$ 这一项。$H$ 的转置是 $H^T = \\begin{pmatrix} 1  0.2 \\\\ 0.5  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{5} \\\\ \\frac{1}{2}  1 \\end{pmatrix}$。\n$$\nH^T R^{-1} = \\begin{pmatrix} 1  \\frac{1}{5} \\\\ \\frac{1}{2}  1 \\end{pmatrix} \\begin{pmatrix} \\frac{25}{24}  -\\frac{5}{36} \\\\ -\\frac{5}{36}  \\frac{25}{54} \\end{pmatrix} = \\begin{pmatrix} \\frac{25}{24} - \\frac{1}{36}  -\\frac{5}{36} + \\frac{5}{54} \\\\ \\frac{25}{48} - \\frac{5}{36}  -\\frac{5}{72} + \\frac{25}{54} \\end{pmatrix} = \\begin{pmatrix} \\frac{73}{72}  -\\frac{5}{108} \\\\ \\frac{55}{144}  \\frac{85}{216} \\end{pmatrix}\n$$\n$$\nH^T R^{-1} H = \\begin{pmatrix} \\frac{73}{72}  -\\frac{5}{108} \\\\ \\frac{55}{144}  \\frac{85}{216} \\end{pmatrix} \\begin{pmatrix} 1  \\frac{1}{2} \\\\ \\frac{1}{5}  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{73}{72}-\\frac{1}{108}  \\frac{73}{144}-\\frac{5}{108} \\\\ \\frac{55}{144}+\\frac{17}{216}  \\frac{55}{288}+\\frac{85}{216} \\end{pmatrix} = \\begin{pmatrix} \\frac{217}{216}  \\frac{199}{432} \\\\ \\frac{199}{432}  \\frac{505}{864} \\end{pmatrix}\n$$\n为了方便相加，我们将该矩阵写成公分母为 $864$ 的形式：\n$$\nH^T R^{-1} H = \\frac{1}{864} \\begin{pmatrix} 868  398 \\\\ 398  505 \\end{pmatrix}\n$$\n\n现在我们将精度矩阵相加来求 $P_a^{-1}$：\n$$\nP_a^{-1} = B^{-1} + H^T R^{-1} H = \\frac{1}{864} \\begin{pmatrix} 225  -30 \\\\ -30  100 \\end{pmatrix} + \\frac{1}{864} \\begin{pmatrix} 868  398 \\\\ 398  505 \\end{pmatrix} = \\frac{1}{864} \\begin{pmatrix} 1093  368 \\\\ 368  605 \\end{pmatrix}\n$$\n\n为了求得 $P_a$，我们对 $P_a^{-1}$ 求逆：\n$$\n\\det(P_a^{-1}) = \\left(\\frac{1}{864}\\right)^2 \\left( (1093)(605) - (368)^2 \\right) = \\frac{661265 - 135424}{864^2} = \\frac{525841}{864^2}\n$$\n$$\nP_a = (P_a^{-1})^{-1} = \\frac{864^2}{525841} \\left( \\frac{1}{864} \\begin{pmatrix} 605  -368 \\\\ -368  1093 \\end{pmatrix} \\right) = \\frac{864}{525841} \\begin{pmatrix} 605  -368 \\\\ -368  1093 \\end{pmatrix}\n$$\n\n问题要求的是分析 RMSE，定义为 $\\sqrt{\\operatorname{tr}(P_{\\text{a}})/2}$。首先，我们计算 $P_a$ 的迹：\n$$\n\\operatorname{tr}(P_a) = \\frac{864}{525841} (605 + 1093) = \\frac{864 \\times 1698}{525841} = \\frac{1467072}{525841}\n$$\n\n最后，我们计算 RMSE：\n$$\n\\text{RMSE} = \\sqrt{\\frac{\\operatorname{tr}(P_a)}{2}} = \\sqrt{\\frac{1}{2} \\cdot \\frac{1467072}{525841}} = \\sqrt{\\frac{733536}{525841}}\n$$\n现在我们计算数值并四舍五入到四位有效数字：\n$$\n\\text{RMSE} \\approx \\sqrt{1.3949790...} \\approx 1.1811346...\n$$\n四舍五入到四位有效数字得到 $1.181$。",
            "answer": "$$\\boxed{1.181}$$"
        }
    ]
}