{
    "hands_on_practices": [
        {
            "introduction": "在构建任何数据驱动模型之前，我们可以利用物理定律来简化问题。本练习将展示量纲分析（物理学的一块基石）在降低模型输入空间复杂性方面的强大作用。通过应用白金汉 $\\Pi$ 定理，您将学习如何构建无量纲群，从而使您的模型更具泛化能力，且更不易受维度灾难的影响，这是构建稳健的混合模型的关键第一步 。",
            "id": "3884451",
            "problem": "正在构建一个混合物理-数据模型，以学习明渠流中糙底床上的悬移质输运规律。所学习的映射将由有量纲的预测变量 $(\\rho,\\nu,U,D,g)$ 构建，其中 $\\rho$ 是流体密度，$\\nu$ 是运动粘度，$U$ 是特征平均流速，$D$ 是特征泥沙粒径，$g$ 是重力加速度。该模型随后将在实验室和现场数据集上进行训练，这些数据集涵盖了广泛的 $U$、$D$、$\\nu$ 和 $g$ 值。为了改善外推性能并减小假设空间，学习组件的输入必须是无量纲的。\n\n仅使用量纲齐次性的基本原理和 Buckingham $\\Pi$ 定理，推导出一组可以由 $(\\rho,\\nu,U,D,g)$ 构成的最小独立无量纲输入群 $\\Pi_i$。通过求解使每个 $\\Pi_i$ 无量纲化的指数来显式地构建这些群，并论证 $\\rho$ 是否能进入由给定集合构成的任何无量纲输入中。然后，在不引用任何经验性泥沙输运公式的情况下，解释为什么用推导出的 $\\Pi_i$ 替代 $(\\rho,\\nu,U,D,g)$ 会降低混合物理-数据模型中的假设复杂性，并通过比较原始有量纲输入中的通用总次数为 $p$ 的多项式模型与 $\\Pi_i$ 中的总次数为 $p$ 的多项式模型的自由系数数量来量化这种降低。\n\n以单行矩阵形式给出独立 $\\Pi_i$ 的显式解析表达式作为最终答案。不需要进行数值计算，也无需四舍五入。最终答案中不要包含单位。",
            "solution": "问题陈述经评估是有效的，因为它在科学上基于量纲分析的原理，问题提法得当、客观且内部一致。它展示了 Buckingham $\\Pi$ 定理在一个环境建模相关问题上的标准而严谨的应用。\n\n任务是从与悬移质输运相关的 $n=5$ 个物理变量集合中推导出一组最小的独立无量纲群：流体密度 $\\rho$、运动粘度 $\\nu$、平均流速 $U$、泥沙粒径 $D$ 和重力加速度 $g$。涉及的基本量纲是质量 ($M$)、长度 ($L$) 和时间 ($T$)。\n\n首先，我们列出变量及其对应的量纲：\n1.  流体密度 $\\rho$：$[\\rho] = M L^{-3}$\n2.  运动粘度 $\\nu$：$[\\nu] = L^2 T^{-1}$\n3.  流速 $U$：$[U] = L T^{-1}$\n4.  粒径 $D$：$[D] = L$\n5.  重力加速度 $g$：$[g] = L T^{-2}$\n\nBuckingham $\\Pi$ 定理指出，$n$ 个变量之间的物理上有意义的关系可以表示为 $n-k$ 个独立无量纲群之间的关系，其中 $k$ 是描述这些变量所需的基本量纲的数量（即量纲矩阵的秩）。\n\n我们构造量纲矩阵，其中行对应基本量纲 ($M, L, T$)，列对应变量 ($\\rho, \\nu, U, D, g$)：\n$$\n\\begin{pmatrix}\n  \\rho  \\nu  U  D  g \\\\\nM  1  0  0  0  0 \\\\\nL  -3  2  1  1  1 \\\\\nT  0  -1  -1  0  -2\n\\end{pmatrix}\n$$\n该矩阵的秩 $k$ 是线性无关的行（或列）的数量。对应于质量 ($M$) 的第一行显然与其他行无关。对于量纲 $L, T$ 和变量 $\\nu, U$ 的子矩阵是 $\\begin{pmatrix} 2  1 \\\\ -1  -1 \\end{pmatrix}$，其行列式为 $(2)(-1) - (1)(-1) = -1 \\neq 0$。因此，最后两行也是线性无关的。该矩阵的秩为 $k=3$。\n\n根据 Buckingham $\\Pi$ 定理，独立无量纲群的数量是 $n - k = 5 - 3 = 2$。我们将其表示为 $\\Pi_1$ 和 $\\Pi_2$。\n\n问题询问流体密度 $\\rho$ 是否能成为由给定变量集构成的任何无量纲群的组成部分。假设一个通用的无量纲群 $\\Pi$ 由各变量的幂次乘积构成：\n$$ \\Pi = \\rho^{e_1} \\nu^{e_2} U^{e_3} D^{e_4} g^{e_5} $$\n为了使 $\\Pi$ 无量纲，其总的量纲必须是 $M^0 L^0 T^0$。我们可以写出量纲方程为：\n$$ [\\Pi] = (M L^{-3})^{e_1} (L^2 T^{-1})^{e_2} (L T^{-1})^{e_3} (L)^{e_4} (L T^{-2})^{e_5} = M^{e_1} L^{-3e_1+2e_2+e_3+e_4+e_5} T^{-e_2-e_3-2e_5} $$\n为了使其无量纲，每个基本量纲的指数必须为零。对于质量量纲 ($M$)，我们有：\n$$ e_1 = 0 $$\n这个结果证明，在该变量集构成的任何无量纲群中，$\\rho$ 的指数必须为零。因此，$\\rho$ 不能进入任何无量纲输入中。这是因为 $\\rho$ 是该集合中唯一带有质量量纲的变量，没有其他变量可以将其抵消，这是一个直接的推论。\n\n由于排除了 $\\rho$，问题简化为从剩余的 4 个变量 ($\\nu, U, D, g$) 中找出 2 个无量纲群，这些变量由 2 个基本量纲 ($L, T$) 描述。我们从该集合中选择 $k=2$ 个重复变量。一个有效的选择必须同时包含 $L$ 和 $T$，并且量纲上是独立的。我们选择 $U$ 和 $D$。\n- $[U] = L T^{-1}$\n- $[D] = L$\n对于 $\\{U, D\\}$ 的量纲矩阵是 $\\begin{pmatrix} 1  1 \\\\ -1  0 \\end{pmatrix}$，其行列式为 $1 \\neq 0$，证实了它们是一个有效的选择。\n\n现在我们用剩下的变量 $\\nu$ 和 $g$ 构成两个 $\\Pi$ 群。\n\n首先，我们用 $\\nu$ 构成 $\\Pi_1$：\n$$ \\Pi_1 = U^a D^b \\nu^1 $$\n量纲方程是：\n$$ [\\Pi_1] = (L T^{-1})^a (L)^b (L^2 T^{-1})^1 = L^{a+b+2} T^{-a-1} = L^0 T^0 $$\n令指数相等：\n- 对于 $T$：$-a-1 = 0 \\implies a = -1$\n- 对于 $L$：$a+b+2 = 0 \\implies -1+b+2 = 0 \\implies b = -1$\n这得到 $\\Pi_1 = U^{-1} D^{-1} \\nu = \\frac{\\nu}{UD}$。按照惯例，我们使用它的倒数，即颗粒雷诺数：\n$$ \\Pi_1 = \\frac{UD}{\\nu} $$\n其次，我们用 $g$ 构成 $\\Pi_2$：\n$$ \\Pi_2 = U^a D^b g^1 $$\n量纲方程是：\n$$ [\\Pi_2] = (L T^{-1})^a (L)^b (L T^{-2})^1 = L^{a+b+1} T^{-a-2} = L^0 T^0 $$\n令指数相等：\n- 对于 $T$：$-a-2 = 0 \\implies a = -2$\n- 对于 $L$：$a+b+1 = 0 \\implies -2+b+1 = 0 \\implies b = 1$\n这得到 $\\Pi_2 = U^{-2} D^{1} g = \\frac{gD}{U^2}$。按照惯例，我们使用它的倒数，即颗粒弗劳德数的平方：\n$$ \\Pi_2 = \\frac{U^2}{gD} $$\n因此，一组最小的独立无量纲输入群是 $\\{\\frac{UD}{\\nu}, \\frac{U^2}{gD}\\}$。\n\n在混合物理-数据模型中，用推导出的 $\\Pi_i$ 群替代原始有量纲输入 $(\\rho, \\nu, U, D, g)$ 会降低假设复杂性，原因有以下几点。其核心原理是量纲分析将物理定律（量纲齐次性原理）嵌入到问题的结构中。\n1.  **降维**：未知函数关系的搜索空间从一个 5 维的输入空间 $(\\rho, \\nu, U, D, g)$ 减少到一个 2 维的输入空间 $(\\Pi_1, \\Pi_2)$。这是一个极大的简化。在低维空间中工作的数据驱动模型不易受到“维度灾难”的影响，需要更少的数据来进行稳健的训练，并且计算效率更高。\n2.  **施加物理约束**：通过用无量纲群重新表述问题，我们强制所学习的模型遵守量纲齐次性原理。任何关于 $\\Pi_1$ 和 $\\Pi_2$ 的函数都将自动产生量纲正确的结果。这通过消除所有物理上不可能的函数形式来修剪假设空间，而一个在有量纲输入上操作的朴素模型则必须学会避免这些形式。\n3.  **增强泛化能力（相似性）**：无量纲群代表了物理效应的比率（例如，$Re$ 是惯性力与粘性力的比率）。动力相似性原理指出，如果两个具有不同量纲参数（$\\nu$、$U$、$D$ 等）的系统其对应的无量纲群相同，那么它们的行为将完全相同。一个在 $(\\Pi_1, \\Pi_2)$ 上训练的模型内在地学习了这个原理。它能够根据小型实验室水槽的数据准确预测大型河流的行为，只要它们共享相同的 $(\\Pi_1, \\Pi_2)$ 值，即使各自的量纲变量差异巨大。一个在原始有量纲变量上训练的模型会将这些视为完全独立的数据点，并且不能保证其能正确泛化。\n\n为了量化这种复杂性的降低，我们比较一个通用总次数为 $p$ 的多项式模型中的自由系数数量。对于一个包含 $d$ 个变量的此类模型，其系数数量 $N$ 由可重复组合的公式给出：$N(d, p) = \\binom{p+d}{d}$。\n- 对于原始有量纲输入的模型，我们有 $d_1 = 5$ 个变量 $(\\rho, \\nu, U, D, g)$。系数的数量是：\n  $$ N_1 = \\binom{p+5}{5} = \\frac{(p+5)(p+4)(p+3)(p+2)(p+1)}{120} $$\n  这个模型在物理上是朴素的，因为它没有在其项之间强制实现量纲一致性，但它代表了纯数据驱动模型将面临的复杂性。\n- 对于无量纲输入的模型，我们有 $d_2 = 2$ 个变量 $(\\Pi_1, \\Pi_2)$。系数的数量是：\n  $$ N_2 = \\binom{p+2}{2} = \\frac{(p+2)(p+1)}{2} $$\n在有量纲情况下，系数的数量以 $O(p^5)$ 的速度增长，而在无量纲情况下则以 $O(p^2)$ 的速度增长。例如，对于一个二次模型 ($p=2$)，有量纲模型有 $N_1 = \\binom{7}{5} = 21$ 个系数，而无量纲模型只有 $N_2 = \\binom{4}{2} = 6$ 个系数。自由参数数量的这种急剧减少使得模型更易于指定，更容易用可用数据进行约束，并且更不容易过拟合。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{UD}{\\nu}  \\frac{U^2}{gD}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "混合模型的一个关键优势是它们能够遵循基本的物理定律，例如质量守恒或能量守恒。本练习深入探讨了在模型训练过程中将全局积分守恒定律作为硬约束的机制。您将为守恒定律构建一个离散残差，并了解如何使用增广拉格朗日等方法来确保模型的预测在全局尺度上是物理一致的 。",
            "id": "3884400",
            "problem": "考虑一个被动示踪场 $c(\\mathbf{x},t)$，它在一个有界利普希茨域 $\\Omega \\subset \\mathbb{R}^{d}$ 中被一个已知速度场 $\\mathbf{u}(\\mathbf{x},t)$ 输运，并带有一个体积源项 $S(\\mathbf{x},t)$。该域的边界 $\\partial\\Omega$ 上的向外单位法向量为 $\\mathbf{n}$。该示踪场的控制性全局守恒律是：$\\Omega$ 内总质量的变化率加上穿过 $\\partial\\Omega$ 的净向外通量等于 $\\Omega$ 内部的总产量。这可以表示为积分平衡式：\n$$\n\\partial_{t}\\int_{\\Omega} c\\,d\\mathbf{x} \\;+\\; \\int_{\\partial\\Omega} c\\,\\mathbf{u}\\cdot\\mathbf{n}\\,ds \\;=\\; \\int_{\\Omega} S\\,d\\mathbf{x}.\n$$\n一个物理-数据混合模型使用参数化代理模型 $c_{\\theta}(\\mathbf{x},t)$ 来预测该示踪场，并且在训练期间必须将上述守恒律作为硬约束来强制执行。\n\n给定离散时间层 $t_{k}$ 和 $t_{k+1}$，时间步长为均匀的 $\\Delta t = t_{k+1}-t_{k}$。在每个时间 $t_{k}$ 和 $t_{k+1}$，域积分通过具有内部点 $\\{\\mathbf{x}_{i}\\}_{i=1}^{N}$ 和正权重 $\\{w_{i}\\}_{i=1}^{N}$ 的求积法进行近似；在 $t_{k+1}$ 的边界积分则通过具有边界求积点 $\\{\\mathbf{x}^{b}_{j}\\}_{j=1}^{M}$ 和正权重 $\\{w^{b}_{j}\\}_{j=1}^{M}$ 的求积法进行近似。记 $u_{n,j} \\equiv \\mathbf{u}(\\mathbf{x}^{b}_{j},t_{k+1})\\cdot\\mathbf{n}(\\mathbf{x}^{b}_{j})$。定义在 $t_{k+1}$ 处计算的域内总质量和边界通量的前向欧拉时间离散。\n\n任务：\n- 从上述全局守恒声明出发，使用给定的求积规则和对 $\\partial_{t}\\int_{\\Omega} c\\,d\\mathbf{x}$ 的前向欧拉近似，推导出一个离散残差 $g_{k+1}(\\theta)$，该残差用于度量在时间 $t_{k+1}$ 违反全局守恒律的程度。\n- 构建一个训练目标 $\\mathcal{J}(\\theta,\\lambda)$，除了一个通用数据保真项 $\\mathcal{L}_{\\text{data}}(\\theta)$ 和一个可选的正则化项 $\\mathcal{R}(\\theta)$ 外，通过拉格朗日乘子 $\\lambda$ 和一个系数为 $\\rho>0$ 的增广惩罚项，将约束 $g_{k+1}(\\theta)=0$ 作为硬约束强制执行。\n- 讨论一种在随机设置（其中求积点可能被子采样）中强制执行硬约束的数值稳定策略，阐述如何更新拉格朗日乘子和惩罚参数，以及如何减轻子采样带来的偏差。\n- 为了能够在不改变该步骤的 $\\theta$ 的情况下，在 $t_{k+1}$ 时精确满足守恒律，假设您仅在 $t_{k+1}$ 对代理预测应用一个附加的、空间均匀的校正 $\\beta_{k+1}$，使得校正后的场为 $c(\\mathbf{x},t_{k+1}) = c_{\\theta}(\\mathbf{x},t_{k+1}) + \\beta_{k+1}$，而在前一时间 $t_{k}$ 没有校正，即 $c(\\mathbf{x},t_{k}) = c_{\\theta}(\\mathbf{x},t_{k})$。\n  \n  引入以下简写形式\n  $$\n  \\tilde{M}_{k} \\equiv \\sum_{i=1}^{N} w_{i}\\,c_{\\theta}(\\mathbf{x}_{i},t_{k}),\\quad\n  \\tilde{M}_{k+1} \\equiv \\sum_{i=1}^{N} w_{i}\\,c_{\\theta}(\\mathbf{x}_{i},t_{k+1}),\\quad\n  \\tilde{F}_{k+1} \\equiv \\sum_{j=1}^{M} w^{b}_{j}\\,c_{\\theta}(\\mathbf{x}^{b}_{j},t_{k+1})\\,u_{n,j},\\quad\n  Q_{k+1} \\equiv \\sum_{i=1}^{N} w_{i}\\,S(\\mathbf{x}_{i},t_{k+1}),\n  $$\n  以及聚合的求积因子\n  $$\n  W \\equiv \\sum_{i=1}^{N} w_{i},\\qquad B \\equiv \\sum_{j=1}^{M} w^{b}_{j}\\,u_{n,j}.\n  $$\n  使用这些，写出校正后的残差 $g_{k+1}^{\\text{corr}}(\\beta_{k+1})$，并在 $W/\\Delta t + B \\neq 0$ 的条件下，确定强制 $g_{k+1}^{\\text{corr}}(\\beta_{k+1}) = 0$ 的唯一值 $\\beta_{k+1}$。请以 $\\tilde{M}_{k}$、$\\tilde{M}_{k+1}$、$\\tilde{F}_{k+1}$、$Q_{k+1}$、$W$、$B$ 和 $\\Delta t$ 的形式，提供一个单一、简化的符号表达式作为您的最终结果。不要进行数值计算，也不要在最终表达式中包含单位。",
            "solution": "该问题陈述是将数值方法和约束优化应用于物理-数据混合模型的一个有效练习。它在科学上是合理的、适定的且客观的。我们将按所呈现的顺序处理每个任务。\n\n该问题的基础是被动示踪场 $c(\\mathbf{x}, t)$ 在域 $\\Omega$ 中的守恒律的积分形式：\n$$\n\\partial_{t}\\int_{\\Omega} c\\,d\\mathbf{x} \\;+\\; \\int_{\\partial\\Omega} c\\,\\mathbf{u}\\cdot\\mathbf{n}\\,ds \\;=\\; \\int_{\\Omega} S\\,d\\mathbf{x}\n$$\n该方程表明，$\\Omega$ 中示踪场总质量的变化率，加上从边界 $\\partial\\Omega$ 净流出的质量通量，等于 $\\Omega$ 内源 $S$ 的总质量产生率。\n\n首先，我们推导离散残差 $g_{k+1}(\\theta)$。我们从使用在时间 $t_{k+1}$ 处的前向欧拉近似来离散化时间导数项开始：\n$$\n\\partial_{t}\\int_{\\Omega} c(\\mathbf{x}, t)\\,d\\mathbf{x} \\bigg|_{t=t_{k+1}} \\approx \\frac{1}{\\Delta t} \\left( \\int_{\\Omega} c(\\mathbf{x}, t_{k+1})\\,d\\mathbf{x} - \\int_{\\Omega} c(\\mathbf{x}, t_{k})\\,d\\mathbf{x} \\right)\n$$\n将此代入守恒律，并在 $t_{k+1}$ 处计算所有其他项，我们得到半离散方程：\n$$\n\\frac{1}{\\Delta t} \\left( \\int_{\\Omega} c(\\mathbf{x}, t_{k+1})\\,d\\mathbf{x} - \\int_{\\Omega} c(\\mathbf{x}, t_{k})\\,d\\mathbf{x} \\right) + \\int_{\\partial\\Omega} c(\\mathbf{x},t_{k+1})\\,\\mathbf{u}(\\mathbf{x},t_{k+1})\\cdot\\mathbf{n}\\,ds = \\int_{\\Omega} S(\\mathbf{x},t_{k+1})\\,d\\mathbf{x}\n$$\n接下来，我们引入参数化代理模型 $c_{\\theta}(\\mathbf{x}, t)$ 并应用指定的求积规则来近似积分。$\\Omega$ 上的域积分使用内部点 $\\{\\mathbf{x}_{i}\\}_{i=1}^{N}$ 和权重 $\\{w_{i}\\}_{i=1}^{N}$，$\\partial\\Omega$ 上的边界积分使用边界点 $\\{\\mathbf{x}^{b}_{j}\\}_{j=1}^{M}$ 和权重 $\\{w^{b}_{j}\\}_{j=1}^{M}$。这得到全离散方程：\n$$\n\\frac{1}{\\Delta t} \\left( \\sum_{i=1}^{N} w_{i}c_{\\theta}(\\mathbf{x}_{i}, t_{k+1}) - \\sum_{i=1}^{N} w_{i}c_{\\theta}(\\mathbf{x}_{i}, t_{k}) \\right) + \\sum_{j=1}^{M} w^{b}_{j}c_{\\theta}(\\mathbf{x}^{b}_{j}, t_{k+1})u_{n,j} = \\sum_{i=1}^{N} w_{i}S(\\mathbf{x}_{i}, t_{k+1})\n$$\n离散残差 $g_{k+1}(\\theta)$ 定义为该方程被违反的量。我们通过将所有项移到一边来得到它：\n$$\ng_{k+1}(\\theta) \\equiv \\frac{1}{\\Delta t} \\left( \\sum_{i=1}^{N} w_{i}c_{\\theta}(\\mathbf{x}_{i}, t_{k+1}) - \\sum_{i=1}^{N} w_{i}c_{\\theta}(\\mathbf{x}_{i}, t_{k}) \\right) + \\sum_{j=1}^{M} w^{b}_{j}c_{\\theta}(\\mathbf{x}^{b}_{j}, t_{k+1})u_{n,j} - \\sum_{i=1}^{N} w_{i}S(\\mathbf{x}_{i}, t_{k+1})\n$$\n目标是强制执行约束 $g_{k+1}(\\theta)=0$。\n\n第二，我们使用增广拉格朗日方法构建训练目标 $\\mathcal{J}(\\theta,\\lambda)$。该方法结合了一个用于强制执行约束的拉格朗日乘子项和一个用于提高数值稳定性的二次惩罚项。目标函数是数据保真损失 $\\mathcal{L}_{\\text{data}}(\\theta)$、一个可选的正则化项 $\\mathcal{R}(\\theta)$ 以及针对约束 $g_{k+1}(\\theta)=0$ 的增广拉格朗日项的总和。完整的目标是：\n$$\n\\mathcal{J}(\\theta,\\lambda) = \\mathcal{L}_{\\text{data}}(\\theta) + \\mathcal{R}(\\theta) + \\lambda \\, g_{k+1}(\\theta) + \\frac{\\rho}{2} [g_{k+1}(\\theta)]^{2}\n$$\n这里，$\\lambda$ 是与守恒约束相关联的拉格朗日乘子，$\\rho > 0$ 是惩罚参数。通过针对 $\\theta$ 最小化此目标，同时适当地更新 $\\lambda$ 和 $\\rho$，可以驱使残差 $g_{k+1}(\\theta)$ 趋于零。\n\n第三，我们讨论在随机训练设置中强制执行此硬约束的数值稳定策略。对求积点 $\\{\\mathbf{x}_i\\}$ 和 $\\{\\mathbf{x}_j^b\\}$进行子采样以形成小批量来估计数据损失 $\\mathcal{L}_{\\text{data}}(\\theta)$ 是标准做法。然而，使用相同的小批量来估计全局残差 $g_{k+1}(\\theta)$ 会带来重大挑战。残差的小批量估计将是真实全局残差的一个有噪声、有偏的估计量。强制小批量残差为零并不能保证全局守恒律得到满足。为了减轻这种情况，一个鲁棒的策略是解耦数据损失和约束残差的评估。数据损失 $\\mathcal{L}_{\\text{data}}(\\theta)$ 及其梯度可以在小批量上进行随机估计。然而，守恒残差 $g_{k+1}(\\theta)$ 是一个计算成本低的全局总和，应该在每个训练步骤或以较低的频率使用全部 $N$ 个和 $M$ 个求积点来计算。这确保了所强制执行的约束是真实的、无偏的全局守恒律。\n优化通过乘子法进行。在使用目标 $\\mathcal{J}(\\theta, \\lambda_m, \\rho_m)$ 对 $\\theta$ 进行一定数量的优化步骤后，更新拉格朗日乘子 $\\lambda$ 和惩罚参数 $\\rho$。标准的更新规则是：\n1. 拉格朗日乘子的更新：$\\lambda_{m+1} \\leftarrow \\lambda_m + \\rho_m \\, g_{k+1}(\\theta)$，其中 $\\theta$ 是内部优化步骤后的参数。这是拉格朗日量的对偶上升步。\n2. 惩罚参数的更新：如果收敛缓慢，自适应地增加 $\\rho$ 以更强地强制执行约束。例如，如果约束违反量 $|g_{k+1}(\\theta)|$ 没有按目标因子减少，则增加 $\\rho$：$\\rho_{m+1} \\leftarrow \\alpha \\rho_m$，其中因子 $\\alpha > 1$。否则，$\\rho_{m+1} \\leftarrow \\rho_m$。这改善了问题的条件数并加速了向可行解的收敛。\n\n第四，我们推导在时间 $t_{k+1}$ 精确强制执行离散守恒律的附加空间均匀校正 $\\beta_{k+1}$。在 $t_{k+1}$ 校正后的示踪场为 $c(\\mathbf{x}, t_{k+1}) = c_{\\theta}(\\mathbf{x}, t_{k+1}) + \\beta_{k+1}$，而在 $t_k$ 的场保持为 $c(\\mathbf{x}, t_{k}) = c_{\\theta}(\\mathbf{x}, t_k)$。我们必须找到 $\\beta_{k+1}$，使得校正后的残差 $g_{k+1}^{\\text{corr}}(\\beta_{k+1})$ 精确为零。\n\n使用所提供的简写形式，未校正的残差可以写为：\n$$\ng_{k+1}(\\theta) = \\frac{\\tilde{M}_{k+1} - \\tilde{M}_{k}}{\\Delta t} + \\tilde{F}_{k+1} - Q_{k+1}\n$$\n现在，我们计算校正后残差的各项。\n在 $t_{k+1}$ 时的校正后总质量为：\n$$\n\\sum_{i=1}^{N} w_{i} (c_{\\theta}(\\mathbf{x}_{i},t_{k+1}) + \\beta_{k+1}) = \\left(\\sum_{i=1}^{N} w_{i} c_{\\theta}(\\mathbf{x}_{i},t_{k+1})\\right) + \\beta_{k+1} \\left(\\sum_{i=1}^{N} w_{i}\\right) = \\tilde{M}_{k+1} + \\beta_{k+1}W\n$$\n在 $t_k$ 时的总质量不变：$\\tilde{M}_{k}$。\n在 $t_{k+1}$ 时的校正后总通量为：\n$$\n\\sum_{j=1}^{M} w^{b}_{j} (c_{\\theta}(\\mathbf{x}^{b}_{j},t_{k+1})+\\beta_{k+1}) u_{n,j} = \\left(\\sum_{j=1}^{M} w^{b}_{j}c_{\\theta}(\\mathbf{x}^{b}_{j},t_{k+1})u_{n,j}\\right) + \\beta_{k+1}\\left(\\sum_{j=1}^{M} w^{b}_{j}u_{n,j}\\right) = \\tilde{F}_{k+1} + \\beta_{k+1}B\n$$\n总源项 $Q_{k+1}$ 与 $c$ 无关，因此保持不变。\n因此，校正后的残差为：\n$$\ng_{k+1}^{\\text{corr}}(\\beta_{k+1}) = \\frac{(\\tilde{M}_{k+1} + \\beta_{k+1}W) - \\tilde{M}_{k}}{\\Delta t} + (\\tilde{F}_{k+1} + \\beta_{k+1}B) - Q_{k+1}\n$$\n我们强制 $g_{k+1}^{\\text{corr}}(\\beta_{k+1}) = 0$ 并求解 $\\beta_{k+1}$：\n$$\n\\frac{\\tilde{M}_{k+1} - \\tilde{M}_{k}}{\\Delta t} + \\frac{\\beta_{k+1}W}{\\Delta t} + \\tilde{F}_{k+1} + \\beta_{k+1}B - Q_{k+1} = 0\n$$\n将包含 $\\beta_{k+1}$ 的项组合在一起：\n$$\n\\beta_{k+1} \\left( \\frac{W}{\\Delta t} + B \\right) = - \\left( \\frac{\\tilde{M}_{k+1} - \\tilde{M}_{k}}{\\Delta t} + \\tilde{F}_{k+1} - Q_{k+1} \\right)\n$$\n右侧括号中的表达式是未校正的残差 $g_{k+1}(\\theta)$。\n$$\n\\beta_{k+1} \\left( \\frac{W + \\Delta t B}{\\Delta t} \\right) = - \\left( \\frac{(\\tilde{M}_{k+1} - \\tilde{M}_{k}) + \\Delta t \\tilde{F}_{k+1} - \\Delta t Q_{k+1}}{\\Delta t} \\right)\n$$\n假设 $\\Delta t \\neq 0$，我们可以简化为：\n$$\n\\beta_{k+1} (W + \\Delta t B) = - ((\\tilde{M}_{k+1} - \\tilde{M}_{k}) + \\Delta t \\tilde{F}_{k+1} - \\Delta t Q_{k+1})\n$$\n在分母不为零的条件下，即如条件 $W/\\Delta t + B \\neq 0$ 所述（这意味着 $W + \\Delta t B \\neq 0$），我们可以分离出 $\\beta_{k+1}$：\n$$\n\\beta_{k+1} = - \\frac{(\\tilde{M}_{k+1} - \\tilde{M}_{k}) + \\Delta t \\tilde{F}_{k+1} - \\Delta t Q_{k+1}}{W + \\Delta t B}\n$$\n为得到最终表达式，重新整理分子：\n$$\n\\beta_{k+1} = \\frac{\\tilde{M}_{k} - \\tilde{M}_{k+1} - \\Delta t \\tilde{F}_{k+1} + \\Delta t Q_{k+1}}{W + \\Delta t B}\n$$\n此表达式给出了必须在时间 $t_{k+1}$ 添加到代理预测上的唯一的空间均匀校正，以精确满足离散全局守恒律。",
            "answer": "$$\n\\boxed{\\frac{\\tilde{M}_{k} - \\tilde{M}_{k+1} - \\Delta t \\tilde{F}_{k+1} + \\Delta t Q_{k+1}}{W + \\Delta t B}}\n$$"
        },
        {
            "introduction": "对于由复杂的偏微分方程（PDE）控制的系统（例如流体流动），直接强制执行控制方程可能具有挑战性。这个动手编程练习介绍了弱形式或变分训练目标的概念，这是一种借鉴自有限元方法（FEM）的强大技术。您将为纳维-斯托克斯方程实现一个物理启发的损失函数，学习如何将偏微分方程残差投影到一组测试函数上，以确保模型的解在积分意义上与底层物理学保持一致 。",
            "id": "3884404",
            "problem": "考虑在单位正方形域 $\\Omega = [0,1]\\times[0,1]$ 上的不可压缩、稳态、无量纲的二维空间纳维-斯托克斯方程，其速度测试函数满足齐次狄利克雷边界条件，并以有限元法 (FEM; Finite Element Method) 的思想进行处理。令 $\\boldsymbol{u}(\\boldsymbol{x})$ 表示速度场，$p(\\boldsymbol{x})$ 表示压力，$\\nu$ 表示运动粘度（此处为无量纲），$\\boldsymbol{f}(\\boldsymbol{x})$ 表示彻体力（本任务中设为 $\\boldsymbol{0}$）。控制方程为线性动量平衡（连续介质的牛顿第二运动定律）和不可压缩流体的质量守恒：\n$$\n\\boldsymbol{u}\\cdot\\nabla\\boldsymbol{u} + \\nabla p - \\nu\\,\\Delta\\boldsymbol{u} = \\boldsymbol{f} = \\boldsymbol{0},\\quad \\nabla\\cdot\\boldsymbol{u} = 0,\n$$\n其中所有算子和量均采用标准数学符号，角度以弧度为单位，所有变量均为无量纲。\n\n本任务要求您以弱形式构建一个混合物理-数据训练目标，即将动量方程和连续性方程的残差投影到指定的测试函数空间上，此方法与有限元法保持一致。具体来说，使用在边界 $\\partial\\Omega$ 上为零的无散矢量值测试函数 $\\boldsymbol{w}_i$，从而在弱形式动量平衡中消去压力项，并对连续性方程使用标量值测试函数 $q_j$。训练目标应为残差投影的平方和：\n- 动量残差投影积分 $\\int_{\\Omega} \\boldsymbol{w}_i \\cdot \\left(\\boldsymbol{u}\\cdot\\nabla\\boldsymbol{u} - \\nu\\,\\Delta\\boldsymbol{u}\\right)\\,\\mathrm{d}\\boldsymbol{x}$，以及\n- 连续性残差投影积分 $\\int_{\\Omega} q_j\\,(\\nabla\\cdot\\boldsymbol{u})\\,\\mathrm{d}\\boldsymbol{x}$，\n并汇总为单个标量目标。所有积分必须在均匀网格上通过复合矩形法则进行数值计算。\n\n为使问题完全确定且可测试，请使用以下科学上一致的、固定的基函数和参数化选择：\n- 将速度场 $\\boldsymbol{u}(\\boldsymbol{x})$ 参数化为 $\\Omega$ 上四个非无散、光滑、边界消失的基场的线性组合：\n  $$\n  \\boldsymbol{u}(\\boldsymbol{x};\\boldsymbol{c}) = c_1\\,\\begin{bmatrix}\\sin^2(\\pi x)\\,\\sin^2(\\pi y)\\\\ 0\\end{bmatrix} + c_2\\,\\begin{bmatrix}0\\\\ \\sin^2(\\pi x)\\,\\sin^2(\\pi y)\\end{bmatrix} + c_3\\,\\begin{bmatrix}\\sin^2(2\\pi x)\\,\\sin^2(\\pi y)\\\\ 0\\end{bmatrix} + c_4\\,\\begin{bmatrix}0\\\\ \\sin^2(\\pi x)\\,\\sin^2(2\\pi y)\\end{bmatrix},\n  $$\n  其中 $\\boldsymbol{x}=[x,y]^\\top$，$\\boldsymbol{c}=[c_1,c_2,c_3,c_4]^\\top$，三角函数的参数以弧度为单位。所有量均为无量纲。\n- 选择三个无散、边界消失的矢量测试函数 $\\boldsymbol{w}_i(\\boldsymbol{x}) = [\\partial_y\\phi_i(\\boldsymbol{x}),\\, -\\partial_x\\phi_i(\\boldsymbol{x})]^\\top$，由流函数 $\\phi_i$ 构建如下：\n  $$\n  \\phi_1(x,y) = \\sin^2(\\pi x)\\,\\sin^2(\\pi y),\\quad \\phi_2(x,y) = \\sin^2(2\\pi x)\\,\\sin^2(\\pi y),\\quad \\phi_3(x,y) = \\sin^2(\\pi x)\\,\\sin^2(2\\pi y).\n  $$\n- 选择三个标量连续性测试函数 $q_j(x,y)$，使其与上述 $\\phi_j(x,y)$ 相同。\n- 设置 $\\boldsymbol{f}(\\boldsymbol{x})=\\boldsymbol{0}$。\n- 用 $N\\times N$ 个点的均匀张量积网格对 $\\Omega$ 进行离散化，其中 $N$ 为给定的正整数，网格间距为 $\\Delta x = 1/(N-1)$ 和 $\\Delta y = 1/(N-1)$。每个积分 $\\int_{\\Omega} g(x,y)\\,\\mathrm{d}\\boldsymbol{x}$ 都通过复合矩形法则 $I \\approx \\sum_{i=1}^{N}\\sum_{j=1}^{N} g(x_i,y_j)\\,\\Delta x\\,\\Delta y$ 来近似。\n\n您的程序必须：\n- 从第一性原理出发，推导与上述设置一致的弱形式投影，并使用基函数的精确解析空间导数实现所有项的数值计算。\n- 构建训练目标\n  $$\n  J(\\boldsymbol{c};\\nu,\\lambda) = \\sum_{i=1}^{3}\\left(\\int_{\\Omega} \\boldsymbol{w}_i \\cdot \\left(\\boldsymbol{u}\\cdot\\nabla\\boldsymbol{u} - \\nu\\,\\Delta\\boldsymbol{u}\\right)\\,\\mathrm{d}\\boldsymbol{x}\\right)^2 + \\lambda\\sum_{j=1}^{3}\\left(\\int_{\\Omega} q_j \\,(\\nabla\\cdot\\boldsymbol{u})\\,\\mathrm{d}\\boldsymbol{x}\\right)^2,\n  $$\n  其中 $\\lambda$ 是一个非负标量权重（无量纲），每个积分均按规定进行近似。所有三角函数中的角度必须解释为弧度。\n\n测试套件：\n为以下四组参数集评估 $J(\\boldsymbol{c};\\nu,\\lambda)$，以测试不同的体系和边界情况。所有量均为无量纲。\n- 情况 1：$\\nu = 0.1$，$\\lambda = 1.0$， $N=128$，$\\boldsymbol{c}=[0.0,0.0,0.0,0.0]^\\top$。\n- 情况 2：$\\nu = 0.1$，$\\lambda = 1.0$， $N=128$，$\\boldsymbol{c}=[0.2,0.0,0.0,0.0]^\\top$。\n- 情况 3：$\\nu = 1.0$，$\\lambda = 1.0$， $N=64$，$\\boldsymbol{c}=[0.2,0.2,0.0,0.0]^\\top$。\n- 情况 4：$\\nu = 0.01$，$\\lambda = 1.0$， $N=96$，$\\boldsymbol{c}=[0.1,0.05,0.08,0.02]^\\top$。\n\n答案规格：\n- 计算并返回所有四种情况下的目标值 $J$，结果为无量纲浮点数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$。将每个目标值表示为浮点数。不应打印其他任何文本。",
            "solution": "该问题要求为二维单位正方形域 $\\Omega = [0,1]\\times[0,1]$ 上的稳态、不可压缩纳维-斯托克斯方程构建并评估一个混合物理-数据训练目标，记为 $J(\\boldsymbol{c};\\nu,\\lambda)$。该过程在科学和数学上均被验证为合理，并制定了分步推导和数值实现方案。\n\n目标函数定义为动量方程和连续性方程的投影残差的平方和：\n$$\nJ(\\boldsymbol{c};\\nu,\\lambda) = \\sum_{i=1}^{3}\\left(\\int_{\\Omega} \\boldsymbol{w}_i \\cdot \\left(\\boldsymbol{u}\\cdot\\nabla\\boldsymbol{u} - \\nu\\,\\Delta\\boldsymbol{u}\\right)\\,\\mathrm{d}\\boldsymbol{x}\\right)^2 + \\lambda\\sum_{j=1}^{3}\\left(\\int_{\\Omega} q_j \\,(\\nabla\\cdot\\boldsymbol{u})\\,\\mathrm{d}\\boldsymbol{x}\\right)^2\n$$\n此处，$\\boldsymbol{u}$ 是由系数 $\\boldsymbol{c}$ 参数化的速度场，$\\nu$ 是运动粘度，$\\lambda$ 是一个权重因子，$\\boldsymbol{w}_i$ 是矢量测试函数，$q_j$ 是标量测试函数。彻体力 $\\boldsymbol{f}$ 为 $\\boldsymbol{0}$。通过选择满足 $\\nabla \\cdot \\boldsymbol{w}_i = 0$ 并在边界 $\\partial\\Omega$ 上为零的无散测试函数 $\\boldsymbol{w}_i$，压力项 $\\nabla p$ 从动量方程的弱形式中被消除，这允许使用恒等式 $\\int_{\\Omega} \\boldsymbol{w}_i \\cdot \\nabla p \\, \\mathrm{d}\\boldsymbol{x} = -\\int_{\\Omega} p (\\nabla \\cdot \\boldsymbol{w}_i) \\, \\mathrm{d}\\boldsymbol{x} = 0$。\n\n$J$ 的评估需要三个主要部分：参数化的速度场 $\\boldsymbol{u}$ 及其导数、定义的测试函数 $\\boldsymbol{w}_i$ 和 $q_j$，以及数值积分方案。\n\n首先，我们定义速度场 $\\boldsymbol{u}(\\boldsymbol{x};\\boldsymbol{c}) = [u(\\boldsymbol{x}), v(\\boldsymbol{x})]^\\top$，其中 $\\boldsymbol{x}=[x,y]^\\top$，系数为 $\\boldsymbol{c}=[c_1,c_2,c_3,c_4]^\\top$。它被给定为四个基场的线性组合：\n$$\n\\boldsymbol{u}(\\boldsymbol{x};\\boldsymbol{c}) = c_1\\,\\begin{bmatrix}\\sin^2(\\pi x)\\sin^2(\\pi y)\\\\ 0\\end{bmatrix} + c_2\\,\\begin{bmatrix}0\\\\ \\sin^2(\\pi x)\\sin^2(\\pi y)\\end{bmatrix} + c_3\\,\\begin{bmatrix}\\sin^2(2\\pi x)\\sin^2(\\pi y)\\\\ 0\\end{bmatrix} + c_4\\,\\begin{bmatrix}0\\\\ \\sin^2(\\pi x)\\sin^2(2\\pi y)\\end{bmatrix}\n$$\n分量 $u$ 和 $v$ 为：\n$$\nu(x,y) = \\left(c_1\\sin^2(\\pi x) + c_3\\sin^2(2\\pi x)\\right)\\sin^2(\\pi y)\n$$\n$$\nv(x,y) = \\sin^2(\\pi x)\\left(c_2\\sin^2(\\pi y) + c_4\\sin^2(2\\pi y)\\right)\n$$\n为了构建残差，我们需要散度 $\\nabla \\cdot \\boldsymbol{u}$、拉普拉斯算子 $\\Delta\\boldsymbol{u}$ 和对流项 $\\boldsymbol{u} \\cdot \\nabla\\boldsymbol{u}$。所需的偏导数使用法则 $(\\sin^2(k\\pi z))' = k\\pi\\sin(2k\\pi z)$ 和 $(\\sin^2(k\\pi z))'' = 2(k\\pi)^2\\cos(2k\\pi z)$ 求得。\n\n散度为 $\\nabla \\cdot \\boldsymbol{u} = \\partial_x u + \\partial_y v$：\n$$\n\\nabla \\cdot \\boldsymbol{u} = \\left(c_1\\pi\\sin(2\\pi x) + c_3 2\\pi\\sin(4\\pi x)\\right)\\sin^2(\\pi y) + \\sin^2(\\pi x)\\left(c_2\\pi\\sin(2\\pi y) + c_4 2\\pi\\sin(4\\pi y)\\right)\n$$\n这就构成了连续性方程的残差，$R_c = \\nabla \\cdot \\boldsymbol{u}$。\n\n动量方程的残差为 $\\boldsymbol{R}_m = \\boldsymbol{u}\\cdot\\nabla\\boldsymbol{u} - \\nu\\,\\Delta\\boldsymbol{u}$。\n对流项 $\\boldsymbol{u} \\cdot \\nabla \\boldsymbol{u}$ 有如下分量：\n$$\n(\\boldsymbol{u} \\cdot \\nabla \\boldsymbol{u})_x = u\\,\\partial_x u + v\\,\\partial_y u\n$$\n$$\n(\\boldsymbol{u} \\cdot \\nabla \\boldsymbol{u})_y = u\\,\\partial_x v + v\\,\\partial_y v\n$$\n拉普拉斯算子 $\\Delta \\boldsymbol{u} = [\\Delta u, \\Delta v]^\\top$ 有如下分量：\n$$\n\\Delta u = \\partial_{xx}u + \\partial_{yy}u\n$$\n$$\n\\Delta v = \\partial_{xx}v + \\partial_{yy}v\n$$\n所有这些项都是通过将微分法则应用于 $u$ 和 $v$ 的表达式推导出来的。\n\n其次，我们定义测试函数。标量测试函数 $q_j$ 与流函数 $\\phi_j$ 相同：\n$$\nq_1(x,y) = \\phi_1 = \\sin^2(\\pi x)\\sin^2(\\pi y)\n$$\n$$\nq_2(x,y) = \\phi_2 = \\sin^2(2\\pi x)\\sin^2(\\pi y)\n$$\n$$\nq_3(x,y) = \\phi_3 = \\sin^2(\\pi x)\\sin^2(2\\pi y)\n$$\n矢量测试函数 $\\boldsymbol{w}_i=[\\partial_y \\phi_i, -\\partial_x \\phi_i]^\\top$ 被构造成无散形式：\n$$\n\\boldsymbol{w}_1(x,y) = \\begin{bmatrix} \\pi\\sin^2(\\pi x)\\sin(2\\pi y) \\\\ -\\pi\\sin(2\\pi x)\\sin^2(\\pi y) \\end{bmatrix}\n$$\n$$\n\\boldsymbol{w}_2(x,y) = \\begin{bmatrix} \\pi\\sin^2(2\\pi x)\\sin(2\\pi y) \\\\ -2\\pi\\sin(4\\pi x)\\sin^2(\\pi y) \\end{bmatrix}\n$$\n$$\n\\boldsymbol{w}_3(x,y) = \\begin{bmatrix} 2\\pi\\sin^2(\\pi x)\\sin(4\\pi y) \\\\ -\\pi\\sin(2\\pi x)\\sin^2(2\\pi y) \\end{bmatrix}\n$$\n第三，我们定义数值积分。域 $\\Omega$ 被离散化为一个 $N \\times N$ 个点的均匀网格 $(x_i, y_j)$，其中 $x_i = (i-1)/(N-1)$ 且 $y_j = (j-1)/(N-1)$，对于 $i,j \\in \\{1,...,N\\}$。任何积分 $\\int_{\\Omega} g(\\boldsymbol{x})\\,\\mathrm{d}\\boldsymbol{x}$ 都通过复合矩形法则近似为：\n$$\nI \\approx \\sum_{i=1}^{N}\\sum_{j=1}^{N} g(x_i,y_j)\\,\\Delta x\\,\\Delta y\n$$\n其中 $\\Delta x = \\Delta y = 1/(N-1)$。\n\n每个测试用例 $(\\boldsymbol{c}, \\nu, \\lambda, N)$ 的计算流程如下：\n1. 生成 $N \\times N$ 的坐标网格 $(x_i, y_j)$。\n2. 在整个网格上评估基本三角函数及其导数。\n3. 结合这些来计算给定 $\\boldsymbol{c}$ 的 $\\boldsymbol{u}$ 场及其导数（$\\nabla\\cdot\\boldsymbol{u}$、$\\boldsymbol{u}\\cdot\\nabla\\boldsymbol{u}$、$\\Delta\\boldsymbol{u}$）。\n4. 计算网格上测试函数 $\\boldsymbol{w}_i$ 和 $q_j$ 的值。\n5. 对于每个 $i \\in \\{1,2,3\\}$，构建动量残差被积函数 $I_{m,i} = \\boldsymbol{w}_i \\cdot (\\boldsymbol{u}\\cdot\\nabla\\boldsymbol{u} - \\nu\\Delta\\boldsymbol{u})$ 并使用矩形法则计算其积分 $M_i$。\n6. 对于每个 $j \\in \\{1,2,3\\}$，构建连续性残差被积函数 $I_{c,j} = q_j(\\nabla\\cdot\\boldsymbol{u})$ 并使用矩形法则计算其积分 $C_j$。\n7. 计算最终目标值为 $J = \\sum_{i=1}^{3} (M_i)^2 + \\lambda \\sum_{j=1}^{3} (C_j)^2$。\n\n此流程对问题陈述中提供的四个测试用例中的每一个都进行了实现。",
            "answer": "[0.00000000,0.00006371,0.00002166,0.00020087]"
        }
    ]
}