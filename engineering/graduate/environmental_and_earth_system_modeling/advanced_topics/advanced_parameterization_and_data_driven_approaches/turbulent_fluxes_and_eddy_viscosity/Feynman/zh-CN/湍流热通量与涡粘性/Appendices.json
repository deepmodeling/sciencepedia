{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个练习将我们的理论探讨置于一个常见的真实场景中：从风速测量中估算关键的湍流参数。通过从第一性原理推导经典的对数风廓线，然后将其拟合到假设数据，您将计算出摩擦速度($u_*$)和涡粘性($K_m$)的垂直廓线。这项练习  对于理解在中性边界层中，地表特征和风切变如何共同决定湍流至关重要。",
            "id": "3927733",
            "problem": "在一个中性层结时期，观测到一个位于空气动力学粗糙地形上的水平均一的大气地表层。该地形的粗糙度长度已知为 $z_{0} = 0.03$ 米，零平面位移可忽略不计（即 $d = 0$）。在高度 $z = 2$ 米、$z = 10$ 米和 $z = 50$ 米处，测得的平均风速分别为 $U = 3.2$ 米/秒、$U = 7.1$ 米/秒和 $U = 12.6$ 米/秒。假设定常、水平均一且为常应力层。\n\n从以下基本原理出发：\n- 湍流动量通量（雷诺应力）和摩擦速度的定义，$\\tau = -\\rho \\overline{u' w'}$ 和 $u_{*} = \\left(\\frac{|\\tau|}{\\rho}\\right)^{1/2}$，\n- 动量的一阶 K-理论闭合，$\\overline{u' w'} = -K_{m} \\, \\frac{dU}{dz}$，\n- 中性层结下的 Prandtl 混合长度假说，混合长度 $l = \\kappa z$ 且关系式为 $K_{m} = l^{2} \\left| \\frac{dU}{dz} \\right|$，\n- von Kármán 常数 $\\kappa = 0.40$，\n\n从这些基础出发，推导中性地表层的平均风速廓线，并利用测量的风速数据和给定的 $z_{0}$ 来估计摩擦速度 $u_{*}$。然后，计算与您的推导一致的中性条件下的垂直涡黏性廓线 $K_{m}(z)$。\n\n考虑到采样变异性，三次测量不必精确地落在一条完美的对数廓线上，因此请使用统计上可靠的方法来估计 $u_{*}$；将对数廓线视为通过原点的、经过适当变量转换后的线性回归。\n\n在最终答案中，仅报告 $K_{m}(z)$ 作为 $z$ 的函数的表达式，其系数四舍五入至三位有效数字。将 $u_{*}$ 的单位表示为 米/秒，$K_{m}$ 的单位表示为 米$^{2}$/秒，$z$ 的单位为米。将 $u_{*}$ 和 $K_{m}(z)$ 中的系数四舍五入至三位有效数字。",
            "solution": "在指定的中性、定常和水平均一的大气地表层条件下，该问题需要分三部分求解。首先，我们必须从基本原理推导平均风速廓线。其次，我们必须使用提供的风速测量值来估计摩擦速度 $u_{*}$。第三，我们必须计算相应的垂直涡黏性廓线 $K_m(z)$。\n\n**第一部分：中性地表层平均风速廓线的推导**\n\n我们从提供的基本关系式开始。摩擦速度 $u_{*}$ 根据湍流动量通量（或雷诺应力）$\\tau = -\\rho \\overline{u' w'}$ 定义为：\n$$u_{*} = \\left(\\frac{|\\tau|}{\\rho}\\right)^{1/2}$$\n在地表层中，动量通量方向向下，所以 $\\overline{u' w'}$ 为负。因此，$|\\tau|/\\rho = -\\overline{u' w'}$。这得到：\n$$u_{*}^2 = - \\overline{u' w'}$$\n接着，我们使用雷诺应力的一阶 K-理论闭合：\n$$\\overline{u' w'} = -K_{m} \\frac{dU}{dz}$$\n其中 $K_{m}$ 是动量的涡黏性系数，$\\frac{dU}{dz}$ 是平均水平风速 $U$ 的垂直梯度。将此代入 $u_{*}^2$ 的表达式中，得到：\n$$u_{*}^2 = - \\left(-K_{m} \\frac{dU}{dz}\\right) = K_{m} \\frac{dU}{dz}$$\n问题要求我们使用中性边界层的 Prandtl 混合长度假说，其中混合长度 $l$ 由 $l = \\kappa z$ 给出。这里，$\\kappa$ 是 von Kármán 常数，$z$ 是离地面的高度。涡黏性系数 $K_m$ 通过混合长度关联为：\n$$K_{m} = l^{2} \\left| \\frac{dU}{dz} \\right|$$\n在地表层，风速随高度增加，所以 $\\frac{dU}{dz} > 0$。因此我们可以去掉绝对值符号：\n$$K_{m} = (\\kappa z)^2 \\frac{dU}{dz}$$\n将这个 $K_{m}$ 的表达式代入我们的 $u_{*}^2$ 方程中：\n$$u_{*}^2 = \\left( (\\kappa z)^2 \\frac{dU}{dz} \\right) \\frac{dU}{dz} = (\\kappa z)^2 \\left(\\frac{dU}{dz}\\right)^2$$\n对两边取平方根，并注意到 $u_{*}$、$\\kappa$、$z$ 和 $\\frac{dU}{dz}$ 均为正值，我们得到：\n$$u_{*} = \\kappa z \\frac{dU}{dz}$$\n这是一个关于 $U(z)$ 的一阶常微分方程。我们通过分离变量来求解它：\n$$dU = \\frac{u_{*}}{\\kappa} \\frac{dz}{z}$$\n对两边积分，得到风速廓线的一般形式：\n$$\\int dU = \\int \\frac{u_{*}}{\\kappa} \\frac{dz}{z} \\implies U(z) = \\frac{u_{*}}{\\kappa} \\ln(z) + C$$\n其中 $C$ 是积分常数。我们使用地表的边界条件来确定 $C$。空气动力学粗糙度长度 $z_{0}$ 定义为平均风速外推至零的高度。也就是说，$U(z_0) = 0$。应用这个条件（并使用给定的零平面位移 $d=0$）：\n$$0 = \\frac{u_{*}}{\\kappa} \\ln(z_{0}) + C \\implies C = - \\frac{u_{*}}{\\kappa} \\ln(z_{0})$$\n将这个 $C$ 的表达式代回 $U(z)$ 的方程，得到中性地表层对数风廓线的最终形式：\n$$U(z) = \\frac{u_{*}}{\\kappa} \\ln(z) - \\frac{u_{*}}{\\kappa} \\ln(z_{0}) = \\frac{u_{*}}{\\kappa} \\left( \\ln(z) - \\ln(z_{0}) \\right)$$\n$$U(z) = \\frac{u_{*}}{\\kappa} \\ln\\left(\\frac{z}{z_{0}}\\right)$$\n\n**第二部分：摩擦速度 $u_{*}$ 的估计**\n\n推导出的廓线 $U(z) = \\frac{u_{*}}{\\kappa} \\ln\\left(\\frac{z}{z_{0}}\\right)$ 可以整理成线性方程 $y = m x + b$ 的形式。通过设 $y = U(z)$ 和 $x = \\ln(z/z_0)$，方程变为 $y = (\\frac{u_{*}}{\\kappa})x$。这是一个通过原点 $(0,0)$ 的线性关系，其斜率为 $m = \\frac{u_{*}}{\\kappa}$。\n\n给定三个数据点 $(z, U)$：$(2\\text{ 米}, 3.2\\text{ 米/秒})$、$(10\\text{ 米}, 7.1\\text{ 米/秒})$ 和 $(50\\text{ 米}, 12.6\\text{ 米/秒})$。还给定 $z_{0} = 0.03$ 米和 $\\kappa = 0.40$。我们将这些数据点转换为用于线性回归的 $(x, y)$ 坐标：\n对于 $(z_1, U_1) = (2, 3.2)$：$x_1 = \\ln(2/0.03) \\approx 4.1997$，$y_1 = 3.2$。\n对于 $(z_2, U_2) = (10, 7.1)$：$x_2 = \\ln(10/0.03) \\approx 5.8092$，$y_2 = 7.1$。\n对于 $(z_3, U_3) = (50, 12.6)$：$x_3 = \\ln(50/0.03) \\approx 7.4186$，$y_3 = 12.6$。\n\n对于线性模型 $y = mx$（通过原点的回归），斜率 $m$ 的最小二乘估计由下式给出：\n$$m = \\frac{\\sum_{i=1}^{n} x_i y_i}{\\sum_{i=1}^{n} x_i^2}$$\n我们计算所需的总和：\n$$\\sum x_i y_i = (4.1997 \\times 3.2) + (5.8092 \\times 7.1) + (7.4186 \\times 12.6) \\approx 13.4390 + 41.2453 + 93.4744 = 148.1587$$\n$$\\sum x_i^2 = (4.1997)^2 + (5.8092)^2 + (7.4186)^2 \\approx 17.6375 + 33.7468 + 55.0356 = 106.4199$$\n斜率 $m$ 是：\n$$m = \\frac{148.1587}{106.4199} \\approx 1.3922$$\n从斜率，我们可以求出 $u_{*}$：\n$$m = \\frac{u_{*}}{\\kappa} \\implies u_{*} = m \\kappa$$\n$$u_{*} \\approx 1.3922 \\times 0.40 = 0.55688 \\text{ m s}^{-1}$$\n四舍五入到三位有效数字，估计的摩擦速度为 $u_{*} \\approx 0.557$ 米/秒。\n\n**第三部分：涡黏性廓线 $K_m(z)$ 的计算**\n\n我们从第一部分得到两个关键关系：\n1) $u_{*}^2 = K_{m} \\frac{dU}{dz}$\n2) $u_{*} = \\kappa z \\frac{dU}{dz}$\n从第二个关系式，我们可以将风切变表示为 $\\frac{dU}{dz} = \\frac{u_{*}}{\\kappa z}$。将此代入第一个关系式，得到：\n$$u_{*}^2 = K_{m} \\left(\\frac{u_{*}}{\\kappa z}\\right)$$\n解出 $K_{m}(z)$，我们发现：\n$$K_{m}(z) = \\frac{u_{*}^2 \\kappa z}{u_{*}} = u_{*} \\kappa z$$\n这表明在中性地表层中，涡黏性随高度线性增加。现在我们代入我们估计的 $u_{*}$ 值和给定的 $\\kappa$ 值，以求出此线性关系的系数。\n系数为 $u_{*} \\kappa$。\n系数 $= u_{*} \\kappa \\approx 0.55688 \\text{ 米/秒} \\times 0.40 = 0.222752 \\text{ 米/秒}$。\n将该系数四舍五入到三位有效数字得到 $0.223$ 米/秒。涡黏性廓线的最终表达式，其中 $z$ 的单位为米，$K_m$ 的单位为米$^2$/秒，是：\n$$K_{m}(z) = 0.223 z$$",
            "answer": "$$\\boxed{0.223 z}$$"
        },
        {
            "introduction": "虽然涡粘性描述了动量输送，但湍流也输送热量和水分等标量。下一个练习探讨了这些量是否以相同的效率被输送。通过利用同步测量的通量和梯度数据计算湍流普朗特数($Pr_t$)，您将能够量化稳定条件下动量和热量输送之间的差异 。这为我们提供了关键的物理洞察，解释了为何简单的输送类比可能会失效，这是精密环境模型中必须考虑的一个关键因素。",
            "id": "3927704",
            "problem": "在一个半干旱盆地上方，一个水平均匀的夜间大气表面层在30分钟的时间窗口内被观测为定常状态。在高度 $z=12\\,\\mathrm{m}$ 处，涡动协方差仪器报告了同时测得的湍流协方差和平均垂直梯度。雷诺分解 $u=\\overline{u}+u'$, $w=\\overline{w}+w'$, 和 $\\theta=\\overline{\\theta}+\\theta'$ 成立，且Boussinesq近似有效。测得的量为：\n- 顺流向动量通量协方差 $\\overline{w'u'}=-0.070\\,\\mathrm{m^2\\,s^{-2}}$，\n- 热通量协方差 $\\overline{w'\\theta'}=-0.015\\,\\mathrm{K\\,m\\,s^{-1}}$，\n- 平均顺流向切变 $\\partial \\overline{U}/\\partial z=0.090\\,\\mathrm{s^{-1}}$，\n- 平均位温梯度 $\\partial \\overline{\\Theta}/\\partial z=0.030\\,\\mathrm{K\\,m^{-1}}$。\n\n假设一个与涡粘性和涡扩散率假说一致的顺梯度闭合适用于雷诺平均的动量和标量输运，并且在测量高度处 $\\overline{w}=0$。从雷诺平均的平均动量和标量输运平衡方程以及顺梯度闭合的核心定义出发，推导湍流普朗特数（Turbulent Prandtl number ($Pr_t$)）的表达式，用测量的协方差和平均梯度表示。然后使用提供的测量值估算 $Pr_t$。在您的推导和估算中，清楚地说明符号约定以及测量的协方差如何与顺梯度输运相关联。最后，简要解释为什么估算的 $Pr_t$ 会因浮力效应和湍流各向异性而偏离1。在您的物理学解释中，如果需要，可使用 $g=9.81\\,\\mathrm{m\\,s^{-2}}$ 和一个代表性的参考位温 $\\Theta_0=300\\,\\mathrm{K}$。\n\n将您最终估算的 $Pr_t$ 数值表示为一个无量纲数，并四舍五入到三位有效数字。",
            "solution": "该问题要求根据一个定常、水平均匀的夜间大气表面层中的涡动协方差测量值，推导并估算湍流普朗特数 $Pr_t$。解答过程将首先建立基于湍流通量顺梯度闭合假说的理论框架，然后推导 $Pr_t$ 的表达式，计算其值，并最后提供物理解释。\n\n湍流建模中的基本挑战是闭合问题，它源于雷诺平均过程。平均动量和平均标量（如位温 $\\overline{\\Theta}$）的雷诺平均方程包含代表湍流通量的协方差项，这些项必须被参数化。问题指定了顺梯度闭合，也称为K-理论或涡粘性/涡扩散率模型。\n\n首先，我们来定义顺流向动量和热量的垂直湍流通量的顺梯度闭合。顺流向动量的垂直通量，即雷诺应力，被建模为与顺流向速度的平均垂直切变 $\\frac{\\partial \\overline{U}}{\\partial z}$ 成正比。\n该关系由涡粘性假说给出：\n$$\n\\overline{w'u'} = -K_m \\frac{\\partial \\overline{U}}{\\partial z}\n$$\n此处，$\\overline{w'u'}$ 是垂直速度脉动（$w'$）和顺流向速度脉动（$u'$）之间的协方差，代表顺流向动量的垂直湍流通量。$K_m$ 是动量的涡粘性系数，一个正定的湍流交换系数。负号确保了对于典型的边界层流，当速度随高度增加时（$\\frac{\\partial \\overline{U}}{\\partial z} > 0$），动量通量是向下的（$\\overline{w'u'}  0$），这代表了地面对气流的拖曳效应。给定的数据 $\\frac{\\partial \\overline{U}}{\\partial z} = 0.090\\,\\mathrm{s^{-1}} > 0$ 和 $\\overline{w'u'} = -0.070\\,\\mathrm{m^2\\,s^{-2}}  0$ 与此约定一致。\n\n类似地，垂直湍流热通量被建模为与位温的平均垂直梯度 $\\frac{\\partial \\overline{\\Theta}}{\\partial z}$ 成正比。\n该关系由涡扩散率假说给出：\n$$\n\\overline{w'\\theta'} = -K_h \\frac{\\partial \\overline{\\Theta}}{\\partial z}\n$$\n此处，$\\overline{w'\\theta'}$ 是垂直速度脉动（$w'$）和位温脉动（$\\theta'$）之间的协方差。$K_h$ 是热量的涡扩散率，也是一个正定系数。对于所描述的夜间稳定分层条件，地面比上方的空气冷，因此位温随高度增加（$\\frac{\\partial \\overline{\\Theta}}{\\partial z} > 0$）。这导致向下的热通量（$\\overline{w'\\theta'}  0$），因为热量从上方较暖的空气输送到下方较冷的地面。给定的数据 $\\frac{\\partial \\overline{\\Theta}}{\\partial z} = 0.030\\,\\mathrm{K\\,m^{-1}} > 0$ 和 $\\overline{w'\\theta'} = -0.015\\,\\mathrm{K\\,m\\,s^{-1}}  0$ 与此物理图像和符号约定一致。\n\n湍流普朗特数 $Pr_t$ 定义为动量的涡粘性系数与热量的涡扩散率之比：\n$$\nPr_t = \\frac{K_m}{K_h}\n$$\n这个无量纲数比较了湍涡输运动量与输运热量的效率。\n\n为了推导用测量量表示的 $Pr_t$ 表达式，我们首先重新整理顺梯度闭合方程，以求解 $K_m$ 和 $K_h$：\n$$\nK_m = - \\frac{\\overline{w'u'}}{\\partial \\overline{U}/\\partial z}\n$$\n$$\nK_h = - \\frac{\\overline{w'\\theta'}}{\\partial \\overline{\\Theta}/\\partial z}\n$$\n将这些表达式代入湍流普朗特数的定义中，得到：\n$$\nPr_t = \\frac{- \\frac{\\overline{w'u'}}{\\partial \\overline{U}/\\partial z}}{- \\frac{\\overline{w'\\theta'}}{\\partial \\overline{\\Theta}/\\partial z}} = \\left( \\frac{\\overline{w'u'}}{\\overline{w'\\theta'}} \\right) \\left( \\frac{\\partial \\overline{\\Theta}/\\partial z}{\\partial \\overline{U}/\\partial z} \\right)\n$$\n该表达式允许根据测得的湍流协方差和平均梯度直接计算 $Pr_t$。\n\n现在，我们将提供的数值代入这个推导出的表达式中：\n- $\\overline{w'u'} = -0.070\\,\\mathrm{m^2\\,s^{-2}}$\n- $\\overline{w'\\theta'} = -0.015\\,\\mathrm{K\\,m\\,s^{-1}}$\n- $\\frac{\\partial \\overline{U}}{\\partial z} = 0.090\\,\\mathrm{s^{-1}}$\n- $\\frac{\\partial \\overline{\\Theta}}{\\partial z} = 0.030\\,\\mathrm{K\\,m^{-1}}$\n\n计算如下：\n$$\nPr_t = \\left( \\frac{-0.070}{-0.015} \\right) \\left( \\frac{0.030}{0.090} \\right) = \\left( \\frac{70}{15} \\right) \\left( \\frac{30}{90} \\right) = \\left( \\frac{14}{3} \\right) \\left( \\frac{1}{3} \\right) = \\frac{14}{9} \\approx 1.5555...\n$$\n将结果四舍五入到三位有效数字，我们得到 $Pr_t \\approx 1.56$。\n\n最后，我们对这个结果进行解释。雷诺比拟假设湍流输运动量和标量的机制相同，预测 $Pr_t = 1$。这在中性分层流中通常是一个很好的近似。我们计算出的值 $Pr_t \\approx 1.56$ 显著大于1。这种偏差是稳定分层条件的特征，向下的热通量（$\\overline{w'\\theta'}  0$）和正的位温梯度（$\\frac{\\partial \\overline{\\Theta}}{\\partial z} > 0$）证实了这一点。\n\n在稳定分层中 $Pr_t > 1$ 的物理原因与浮力效应及由此产生的湍流各向异性有关：\n1.  **浮力阻尼**：在稳定分层中，一个垂直位移的流体质块会受到一个与其运动方向相反的恢复浮力。这个力会阻尼垂直方向的湍流脉动（$w'$）。由于像热量这样的标量的垂直输运主要由这些垂直运动完成（如通量项 $\\overline{w'\\theta'}$ 所示），热输运的效率被显著降低。\n2.  **各向异性与替代的动量输运机制**：动量是一个与压力场和速度相关的矢量，它可以通过受垂直速度阻尼影响较小的机制进行输运。在稳定分层中，可以生成内重力波。这些波可以通过压力-速度相关性（形阻）来输运动量，而这种机制不输运标量。因此，与标量输运（$K_h$）相比，动量输运（$K_m$）受稳定性的抑制程度较小。\n3.  **稳定度的定量度量**：稳定程度可以用梯度理查森数 $Ri_g$ 来量化：\n    $$\n    Ri_g = \\frac{\\frac{g}{\\Theta_0} \\frac{\\partial \\overline{\\Theta}}{\\partial z}}{\\left(\\frac{\\partial \\overline{U}}{\\partial z}\\right)^2}\n    $$\n    使用给定值 $g=9.81\\,\\mathrm{m\\,s^{-2}}$，$\\Theta_0=300\\,\\mathrm{K}$，$\\frac{\\partial \\overline{\\Theta}}{\\partial z}=0.030\\,\\mathrm{K\\,m^{-1}}$ 和 $\\frac{\\partial \\overline{U}}{\\partial z}=0.090\\,\\mathrm{s^{-1}}$：\n    $$\n    Ri_g = \\frac{\\frac{9.81}{300} \\times 0.030}{(0.090)^2} = \\frac{0.0327 \\times 0.030}{0.0081} = \\frac{0.000981}{0.0081} \\approx 0.121\n    $$\n    这个正值确认了稳定条件。当 $Ri_g$ 从零（中性）增加到正值时，经验函数和理论模型表明 $Pr_t$ 会增加，这反映了相对于动量输运，热输运的效率越来越低。在 $Ri_g \\approx 0.12$ 时计算出的 $Pr_t \\approx 1.56$ 与稳定边界层的野外观测实验和大涡模拟的结果一致。\n\n总而言之，估算的湍流普朗特数大于1，是因为夜间边界层的稳定分层相比于能够输运动量的机制（包括波状运动），更优先地抑制了负责垂直热输运的湍涡。",
            "answer": "$$\\boxed{1.56}$$"
        },
        {
            "introduction": "我们最后的练习旨在弥合物理理论与数值实现之间的鸿沟，这对于地球系统建模者来说是一项核心技能。这项练习  要求您将通量的抽象 K-理论表示与用于在模型中指定地表边界条件的实用总体空气动力学公式联系起来。通过在代码中实现这种联系，您将了解地表与大气之间的温度、湿度和风的差异是如何转化为驱动模型最底层通量的梯度的。",
            "id": "3927708",
            "problem": "在一个环境与地球系统模拟的背景下，您正在对大气表面层的一个一维垂直气柱进行建模。地表的下边界通过对平均场施加 Neumann 型边界条件来实现，其中动量、感热和潜热的湍流垂直通量通过带有涡动系数的顺梯度扩散来给定。任务是将涡动扩散边界条件与近地表整体空气动力学方法相联系，后者根据空气密度、近地表特征风速大小、输送系数和地表-大气差值来指定通量，然后计算所需的平均场表面梯度。\n\n使用的基本原理和定义：\n- Reynolds-Averaged Navier-Stokes (RANS) 框架定义了湍流协方差通量，这些通量可以通过顺梯度（涡动扩散率/粘性）参数化（K-理论）来闭合。\n- 设 $z$ 为垂直坐标，$z$ 向上增加，并定义向上通量为正。\n- 对于一个涡动扩散率为 $K_{\\phi}$ 的输送标量 $\\phi$，其在地表的湍流垂直通量与平均场的垂直梯度成正比。对于涡动粘性为 $K_{m}$ 的平均流向动量分量 $u$，其湍流垂直通量同样通过 $K_{m}$ 与其垂直梯度相关联。\n- 整体空气动力学方法使用恒定的输送系数来表示近地表的动量、感热和潜热通量，这些系数依赖于环境条件，但在本问题中被视为给定的常数。\n\n假设如下：\n- 空气密度 $\\rho$ 在近地表是已知且均匀的。\n- 近地表水平风分量为 $u$ 和 $v$，速率大小为 $|\\mathbf{U}| = \\sqrt{u^{2} + v^{2}}$。\n- 地表位温为 $\\theta_{s}$，近地表空气位温为 $\\theta_{a}$。\n- 地表比湿为 $q_{s}$，近地表空气比湿为 $q_{a}$。\n- 空气的定压比热容为 $c_{p}$，汽化潜热为 $L_{v}$。\n- 动量的涡动粘性为 $K_{m}$，热量和湿度的涡动扩散率分别为 $K_{h}$ 和 $K_{q}$。\n- 动量、热量和湿度的整体输送系数分别为 $C_{d}$、$C_{h}$ 和 $C_{q}$。\n- 使用的符号约定为：向上通量为正，$z$ 向上增加，作用在地表上的切应力向下。\n\n您的任务：\n1. 从顺梯度闭合和每种物理量的向上通量定义出发，根据所述的符号约定，推导在 $z = 0$ 处所需的地表梯度 $\\partial u/\\partial z$, $\\partial \\theta/\\partial z$ 和 $\\partial q/\\partial z$ 与动量、感热和潜热的整体空气动力学通量相关的表达式。\n2. 实现一个程序，为下方的每个测试用例计算：\n   - 所需的平均流向速度地表梯度 $\\partial u/\\partial z$，单位为 $\\mathrm{s}^{-1}$。\n   - 所需的位温地表梯度 $\\partial \\theta/\\partial z$，单位为 $\\mathrm{K}\\,\\mathrm{m}^{-1}$。\n   - 所需的比湿地表梯度 $\\partial q/\\partial z$，单位为 $\\mathrm{m}^{-1}$。\n\n每个测试用例的输入参数均以国际单位制 (SI) 给出，所有输出必须按规定以 SI 单位表示。每个测试用例中的所有系数均视为常数。本问题不涉及角度。\n\n测试组（每个元组为 $(\\rho, u, v, \\theta_{s}, \\theta_{a}, q_{s}, q_{a}, c_{p}, L_{v}, K_{m}, K_{h}, K_{q}, C_{d}, C_{h}, C_{q})$）：\n- 用例 A（典型中等风速，暖湿地表）：\n  - $(1.2, 5.0, 0.0, 305.0, 300.0, 0.018, 0.012, 1005.0, 2.5\\times 10^6, 0.5, 0.4, 0.4, 0.0013, 0.0011, 0.0011)$\n- 用例 B（静风，非零差值；零风速的边缘情况）：\n  - $(1.2, 0.0, 0.0, 302.0, 300.0, 0.015, 0.010, 1005.0, 2.5\\times 10^6, 0.5, 0.4, 0.4, 0.0013, 0.0011, 0.0011)$\n- 用例 C（来自负 $u$ 方向的强风，冷干地表；符号-应力测试）：\n  - $(1.2, -8.0, 0.0, 295.0, 300.0, 0.010, 0.012, 1005.0, 2.5\\times 10^6, 0.2, 0.1, 0.1, 0.0015, 0.0012, 0.0010)$\n- 用例 D（极小的涡动系数；大梯度；数值刚度边缘情况）：\n  - $(1.2, 12.0, 0.0, 310.0, 303.0, 0.020, 0.014, 1005.0, 2.5\\times 10^6, 1.0\\times 10^{-3}, 8.0\\times 10^{-4}, 8.0\\times 10^{-4}, 0.0020, 0.0015, 0.0014)$\n\n您的程序必须：\n- 为每个测试用例计算在 $z = 0$ 处的三个梯度。\n- 将结果汇总到一个 Python 列表中，该列表包含四个子列表（每个用例一个），每个子列表按 $[\\partial u/\\partial z, \\partial \\theta/\\partial z, \\partial q/\\partial z]$ 的顺序排列。\n- 生成单行输出，包含此列表，格式为用方括号括起来的逗号分隔列表（例如，\"[[a,b,c],[d,e,f],...]\"）。不要打印任何其他文本。\n- 所有计算出的梯度必须以上述单位表示，不带额外的单位注释，并且必须是数值浮点数。如果任何涡动系数 $K_{m}$、$K_{h}$ 或 $K_{q}$ 精确为零，则返回与浮点表示一致的非数字 (not-a-number) 标志作为相应的梯度。",
            "solution": "用户提供了一个环境与地球系统模拟领域的问题，具体涉及湍流地表通量的参数化。任务是联系两种常用方法——涡动扩散（K-理论）闭合方案和整体空气动力学公式——以推导并计算地表的平均速度、位温和比湿的垂直梯度。\n\n### 问题验证\n问题陈述已根据指定标准进行评估，并被确定为**有效**。它在科学上基于大气边界层物理学的原理，即 Reynolds-Averaged Navier-Stokes (RANS) 方程及相关的闭合方案。该问题是适定的，为获得唯一解提供了所有必要的数据和定义。使用的术语客观且为该领域的标准术语。测试用例中提供的数据在物理上是现实的。该问题代表了应用和统一物理模型的一个标准的、非平凡的练习。\n\n### 地表梯度的推导\n\n推导过程是通过将从顺梯度 K-理论中获得的湍流垂直通量表达式与从整体空气动力学方法中获得的表达式相等来完成的。符号约定规定坐标 $z$ 向上增加且向上通量为正。\n\n**1. 平均流向速度的梯度 ($\\partial u / \\partial z$)**\n\n$u$ 分量动量的湍流垂直通量 $F_{u}$ 是 Reynolds 应力分量 $\\rho \\overline{u'w'}$。我们可以使用两种参数化方法来表示此通量。\n\n*   **K-理论（顺梯度扩散）**：通量被参数化为与平均速度梯度的负值成正比。\n    $$F_{u} = -\\rho K_{m} \\frac{\\partial u}{\\partial z}$$\n    此处，$K_{m}$ 是动量的涡动粘性。一个正梯度 $\\partial u / \\partial z  0$（在地表边界层中很典型）导致一个负（向下）的动量通量，代表地面对流体的拖曳力。\n\n*   **整体空气动力学方法**：代表流体对地表拖曳力的地表应力向量由 $\\vec{\\tau}_{s} = \\rho C_{d} |\\mathbf{U}| \\mathbf{U}$ 给出。地面对流体施加的力是反作用力 $-\\vec{\\tau}_{s}$。这个单位面积上的力等于进入流体在地表的动量通量。该通量的 $x$ 分量是：\n    $$F_{u} = -\\rho C_{d} |\\mathbf{U}| u$$\n    其中 $|\\mathbf{U}| = \\sqrt{u^2 + v^2}$ 是近地表风速的大小，$C_d$ 是拖曳系数。\n\n*   **联立与求解**：通过将动量通量 $F_{u}$ 的两个表达式联立，我们可以求解速度梯度：\n    $$-\\rho K_{m} \\frac{\\partial u}{\\partial z} = -\\rho C_{d} |\\mathbf{U}| u$$\n    空气密度 $\\rho$ 被消去。\n    $$\\frac{\\partial u}{\\partial z} = \\frac{C_{d} |\\mathbf{U}| u}{K_{m}}$$\n\n**2. 位温的梯度 ($\\partial \\theta / \\partial z$)**\n\n向上的感热通量 $H$ 与运动学热通量 $\\overline{w'\\theta'}$ 通过 $H = \\rho c_{p} \\overline{w'\\theta'}$ 相关。\n\n*   **K-理论**：运动学通量被参数化为：\n    $$\\overline{w'\\theta'} = -K_{h} \\frac{\\partial \\theta}{\\partial z}$$\n    其中 $K_{h}$ 是热量的涡动扩散率。\n\n*   **整体空气动力学方法**：感热通量由以下公式给出：\n    $$H = \\rho c_{p} C_{h} |\\mathbf{U}| (\\theta_{s} - \\theta_{a})$$\n    其中 $C_{h}$ 是热量的整体输送系数，$(\\theta_{s} - \\theta_{a})$ 是地表-大气位温差。相应的运动学通量是：\n    $$\\overline{w'\\theta'} = C_{h} |\\mathbf{U}| (\\theta_{s} - \\theta_{a})$$\n\n*   **联立与求解**：我们将运动学通量 $\\overline{w'\\theta'}$ 的两个表达式联立：\n    $$-K_{h} \\frac{\\partial \\theta}{\\partial z} = C_{h} |\\mathbf{U}| (\\theta_{s} - \\theta_{a})$$\n    求解位温梯度得出：\n    $$\\frac{\\partial \\theta}{\\partial z} = -\\frac{C_{h} |\\mathbf{U}| (\\theta_{s} - \\theta_{a})}{K_{h}}$$\n\n**3. 比湿的梯度 ($\\partial q / \\partial z$)**\n\n向上的潜热通量 $E$ 与运动学湿度通量 $\\overline{w'q'}$ 通过 $E = \\rho L_{v} \\overline{w'q'}$ 相关。\n\n*   **K-理论**：运动学通量被参数化为：\n    $$\\overline{w'q'} = -K_{q} \\frac{\\partial q}{\\partial z}$$\n    其中 $K_{q}$ 是湿度的涡动扩散率。\n\n*   **整体空气动力学方法**：潜热通量由以下公式给出：\n    $$E = \\rho L_{v} C_{q} |\\mathbf{U}| (q_{s} - q_{a})$$\n    其中 $C_{q}$ 是湿度的整体输送系数，$(q_{s} - q_{a})$ 是地表-大气比湿差。相应的运动学通量是：\n    $$\\overline{w'q'} = C_{q} |\\mathbf{U}| (q_{s} - q_{a})$$\n\n*   **联立与求解**：我们将运动学通量 $\\overline{w'q'}$ 的两个表达式联立：\n    $$-K_{q} \\frac{\\partial q}{\\partial z} = C_{q} |\\mathbf{U}| (q_{s} - q_{a})$$\n    求解比湿梯度得出：\n    $$\\frac{\\partial q}{\\partial z} = -\\frac{C_{q} |\\mathbf{U}| (q_{s} - q_{a})}{K_{q}}$$\n\n### 特殊条件\n\n*   **静风**：如果 $|\\mathbf{U}| = 0$（即 $u=0$ 且 $v=0$），则推导出的表达式中所有分子都变为零。因此，所有三个梯度 $\\partial u / \\partial z$、$\\partial \\theta / \\partial z$ 和 $\\partial q / \\partial z$ 都等于 $0$。\n*   **零涡动扩散率**：如果任何涡动系数（$K_m$、$K_h$ 或 $K_q$）为零，相应的梯度计算将涉及除以零。根据规定，该梯度的结果应为一个非数字 (NaN) 值，这在实现中会得到适当处理。\n\n这些推导出的关系将被用于实现程序，以解决每个给定测试用例的梯度计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the surface gradients of mean streamwise velocity, potential temperature,\n    and specific humidity based on a connection between K-theory and bulk aerodynamic\n    flux parameterizations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (rho, u, v, theta_s, theta_a, q_s, q_a, c_p, L_v, K_m, K_h, K_q, C_d, C_h, C_q)\n    test_cases = [\n        # Case A (typical moderate wind, warm and moist surface)\n        (1.2, 5.0, 0.0, 305.0, 300.0, 0.018, 0.012, 1005.0, 2.5e6, 0.5, 0.4, 0.4, 0.0013, 0.0011, 0.0011),\n        # Case B (calm wind, nonzero contrasts; edge case for zero speed)\n        (1.2, 0.0, 0.0, 302.0, 300.0, 0.015, 0.010, 1005.0, 2.5e6, 0.5, 0.4, 0.4, 0.0013, 0.0011, 0.0011),\n        # Case C (strong wind from negative u direction, cool and dry surface; sign-stress test)\n        (1.2, -8.0, 0.0, 295.0, 300.0, 0.010, 0.012, 1005.0, 2.5e6, 0.2, 0.1, 0.1, 0.0015, 0.0012, 0.0010),\n        # Case D (very small eddy coefficients; large gradients; numerical stiffness edge case)\n        (1.2, 12.0, 0.0, 310.0, 303.0, 0.020, 0.014, 1005.0, 2.5e6, 1.0e-3, 8.0e-4, 8.0e-4, 0.0020, 0.0015, 0.0014),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case.\n        # Note: rho, c_p, and L_v are not needed for the final gradient calculations as they cancel out.\n        _rho, u, v, theta_s, theta_a, q_s, q_a, _cp, _Lv, K_m, K_h, K_q, C_d, C_h, C_q = case\n\n        # Calculate the magnitude of the near-surface wind speed.\n        U_mag = np.sqrt(u**2 + v**2)\n\n        # Calculate the surface gradient of mean streamwise velocity (du/dz).\n        # Formula: d(u)/dz = (C_d * |U| * u) / K_m\n        if K_m == 0.0:\n            grad_u = np.nan\n        else:\n            grad_u = (C_d * U_mag * u) / K_m\n\n        # Calculate the surface gradient of potential temperature (d(theta)/dz).\n        # Formula: d(theta)/dz = - (C_h * |U| * (theta_s - theta_a)) / K_h\n        if K_h == 0.0:\n            grad_theta = np.nan\n        else:\n            grad_theta = - (C_h * U_mag * (theta_s - theta_a)) / K_h\n\n        # Calculate the surface gradient of specific humidity (d(q)/dz).\n        # Formula: d(q)/dz = - (C_q * |U| * (q_s - q_a)) / K_q\n        if K_q == 0.0:\n            grad_q = np.nan\n        else:\n            grad_q = - (C_q * U_mag * (q_s - q_a)) / K_q\n        \n        results.append([grad_u, grad_theta, grad_q])\n\n    # Construct the final output string to precisely match the required format \"[[a,b,c],[d,e,f],...]\"\n    # without any spaces.\n    final_str_parts = []\n    for sublist in results:\n        sublist_str = f\"[{','.join(map(str, sublist))}]\"\n        final_str_parts.append(sublist_str)\n    \n    final_output = f\"[{','.join(final_str_parts)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}