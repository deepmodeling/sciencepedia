{
    "hands_on_practices": [
        {
            "introduction": "物理信息神经网络（PINN）的核心思想是通过损失函数将物理定律嵌入到神经网络的训练过程中。本练习 () 将引导您完成一项基础任务：为一个经典的一维平流方程构建复合损失函数。通过这个过程，您将学会如何将偏微分方程、初始条件和边界条件精确地转化为可优化的数学表达式。",
            "id": "2126319",
            "problem": "一个计算科学家团队正在开发一种物理信息神经网络 (PINN) 来求解一个偏微分方程。PINN 是一种神经网络，其损失函数包含一个惩罚其与控制物理定律偏差的项。\n\n具体问题是模拟一维平流方程，该方程描述了某个量的输运。其控制方程为：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x, t)$ 是所关注的量，$c$ 是一个恒定的正波速。解在由 $x \\in [X_0, X_1]$ 和 $t \\in [0, T]$ 定义的时空域上求解。\n\n神经网络，记作 $\\hat{u}(x, t; \\theta)$，近似真实解 $u(x, t)$。这里，$\\theta$ 代表网络中所有可训练的参数（权重和偏置）。目标是通过最小化总损失函数 $\\mathcal{L}(\\theta)$ 来找到最优参数 $\\theta$。\n\n总损失函数是三个组成部分的加权和：\n1.  **偏微分方程损失 ($\\mathcal{L}_{PDE}$)**: 在域内强制执行平流方程。\n2.  **初始条件损失 ($\\mathcal{L}_{IC}$)**: 强制执行系统在 $t=0$ 时的状态。\n3.  **边界条件损失 ($\\mathcal{L}_{BC}$)**: 强制执行在空间边界 $x=X_0$ 和 $x=X_1$ 上的行为。\n\n具体条件如下：\n-   **初始条件 (IC)**: 在 $t=0$ 时，分布廓形是一个高斯脉冲，由 $u(x, 0) = f(x) = A \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)$ 给出。\n-   **边界条件 (BC)**: 系统具有周期性边界，即对于所有 $t \\in [0, T]$，有 $u(X_0, t) = u(X_1, t)$。\n\n为了计算损失，在域内有限数量的点上进行采样：\n-   从域的内部 $(X_0, X_1) \\times (0, T]$ 采样一组 $N_r$ 个“残差”或“配置”点 $\\{ (x_i^r, t_i^r) \\}_{i=1}^{N_r}$。\n-   沿着初始时间线采样一组 $N_{ic}$ 个初始点 $\\{ (x_i^{ic}, 0) \\}_{i=1}^{N_{ic}}$。\n-   沿着时间域采样一组 $N_{bc}$ 个边界时间点 $\\{ t_i^{bc} \\}_{i=1}^{N_{bc}}$，用于在 $x=X_0$ 和 $x=X_1$ 处评估边界条件。\n\n每个组成部分的损失定义为均方误差。总损失函数由以下加权和给出：\n$$\n\\mathcal{L}(\\theta) = w_{PDE} \\mathcal{L}_{PDE} + w_{IC} \\mathcal{L}_{IC} + w_{BC} \\mathcal{L}_{BC}\n$$\n其中 $w_{PDE}$、$w_{IC}$ 和 $w_{BC}$ 是正常数权重。\n\n你的任务是写出总损失函数 $\\mathcal{L}(\\theta)$ 的完整数学表达式。你的表达式应该用神经网络近似 $\\hat{u}$ 及其偏导数、给定的参数和函数（$c, A, \\mu, \\sigma, X_0, X_1$）、采样点和权重来表示。",
            "solution": "目标是通过定义其三个组成部分来构建总损失函数 $\\mathcal{L}(\\theta)$：偏微分方程损失 $\\mathcal{L}_{PDE}$、初始条件损失 $\\mathcal{L}_{IC}$ 和边界条件损失 $\\mathcal{L}_{BC}$。\n\n首先，我们定义偏微分方程损失 $\\mathcal{L}_{PDE}$。该项衡量神经网络的输出 $\\hat{u}(x, t; \\theta)$ 满足控制平流方程的程度。我们首先定义偏微分方程残差 $R(x, t; \\theta)$，它是将近似解 $\\hat{u}$ 代入方程后得到的结果：\n$$\nR(x, t; \\theta) = \\frac{\\partial \\hat{u}}{\\partial t}(x, t; \\theta) + c \\frac{\\partial \\hat{u}}{\\partial x}(x, t; \\theta)\n$$\n偏微分方程损失是该残差在 $N_r$ 个配置点 $\\{ (x_i^r, t_i^r) \\}_{i=1}^{N_r}$ 上评估的均方误差。\n$$\n\\mathcal{L}_{PDE} = \\frac{1}{N_r} \\sum_{i=1}^{N_r} \\left( R(x_i^r, t_i^r; \\theta) \\right)^2 = \\frac{1}{N_r} \\sum_{i=1}^{N_r} \\left( \\frac{\\partial \\hat{u}}{\\partial t}(x_i^r, t_i^r; \\theta) + c \\frac{\\partial \\hat{u}}{\\partial x}(x_i^r, t_i^r; \\theta) \\right)^2\n$$\n\n其次，我们定义初始条件损失 $\\mathcal{L}_{IC}$。该项衡量网络在时间 $t=0$ 时的预测与真实初始条件 $u(x, 0) = f(x)$ 之间的差异。初始条件由 $f(x) = A \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$ 给出。该损失是 $\\hat{u}(x_i^{ic}, 0; \\theta)$ 与 $f(x_i^{ic})$ 在 $N_{ic}$ 个初始点上的均方误差。\n$$\n\\mathcal{L}_{IC} = \\frac{1}{N_{ic}} \\sum_{i=1}^{N_{ic}} \\left( \\hat{u}(x_i^{ic}, 0; \\theta) - f(x_i^{ic}) \\right)^2 = \\frac{1}{N_{ic}} \\sum_{i=1}^{N_{ic}} \\left( \\hat{u}(x_i^{ic}, 0; \\theta) - A \\exp\\left(-\\frac{(x_i^{ic} - \\mu)^2}{2\\sigma^2}\\right) \\right)^2\n$$\n\n第三，我们定义边界条件损失 $\\mathcal{L}_{BC}$。该项强制执行周期性边界条件 $u(X_0, t) = u(X_1, t)$。该损失是网络在两个边界上预测值之差的均方误差，该误差在 $N_{bc}$ 个采样时间点 $\\{ t_i^{bc} \\}_{i=1}^{N_{bc}}$ 上进行评估。\n$$\n\\mathcal{L}_{BC} = \\frac{1}{N_{bc}} \\sum_{i=1}^{N_{bc}} \\left( \\hat{u}(X_0, t_i^{bc}; \\theta) - \\hat{u}(X_1, t_i^{bc}; \\theta) \\right)^2\n$$\n\n最后，我们通过对这三个组成部分进行加权求和来构建总损失函数 $\\mathcal{L}(\\theta)$：\n$$\n\\mathcal{L}(\\theta) = w_{PDE} \\mathcal{L}_{PDE} + w_{IC} \\mathcal{L}_{IC} + w_{BC} \\mathcal{L}_{BC}\n$$\n代入每个组成部分的表达式，得到总损失函数的最终表达式：\n$$\n\\mathcal{L}(\\theta) = \\frac{w_{PDE}}{N_r} \\sum_{i=1}^{N_r} \\left( \\frac{\\partial \\hat{u}}{\\partial t}(x_i^r, t_i^r; \\theta) + c \\frac{\\partial \\hat{u}}{\\partial x}(x_i^r, t_i^r; \\theta) \\right)^2 + \\frac{w_{IC}}{N_{ic}} \\sum_{i=1}^{N_{ic}} \\left( \\hat{u}(x_i^{ic}, 0; \\theta) - A \\exp\\left(-\\frac{(x_i^{ic} - \\mu)^2}{2\\sigma^2}\\right) \\right)^2 + \\frac{w_{BC}}{N_{bc}} \\sum_{i=1}^{N_{bc}} \\left( \\hat{u}(X_0, t_i^{bc}; \\theta) - \\hat{u}(X_1, t_i^{bc}; \\theta) \\right)^2\n$$",
            "answer": "$$\\boxed{\\mathcal{L}(\\theta) = \\frac{w_{PDE}}{N_r} \\sum_{i=1}^{N_r} \\left( \\frac{\\partial \\hat{u}}{\\partial t}(x_i^r, t_i^r; \\theta) + c \\frac{\\partial \\hat{u}}{\\partial x}(x_i^r, t_i^r; \\theta) \\right)^2 + \\frac{w_{IC}}{N_{ic}} \\sum_{i=1}^{N_{ic}} \\left( \\hat{u}(x_i^{ic}, 0; \\theta) - A \\exp\\left(-\\frac{(x_i^{ic} - \\mu)^2}{2\\sigma^2}\\right) \\right)^2 + \\frac{w_{BC}}{N_{bc}} \\sum_{i=1}^{N_{bc}} \\left( \\hat{u}(X_0, t_i^{bc}; \\theta) - \\hat{u}(X_1, t_i^{bc}; \\theta) \\right)^2}$$"
        },
        {
            "introduction": "在定义了复合损失函数后，一个关键的实践挑战是如何平衡其不同分量的影响。这个思想实验 () 探讨了在权衡物理方程残差与边界条件损失时所涉及的取舍。通过诊断两个不同模型的行为，您将建立起对损失权重如何塑造最终解的直观理解，这对于调试和优化 PINN 至关重要。",
            "id": "2126325",
            "problem": "一名学生正在探索使用物理信息神经网络（PINN）来近似一个物理过程的解 $u(x, t)$。PINN 是一种经过训练以寻找给定偏微分方程（PDE）解函数的神经网络。训练过程涉及最小化一个复合损失函数 $\\mathcal{L}_{total}$，该函数确保网络的输出同时遵守控制性偏微分方程及其相关的边界和初始条件。\n\n具体问题是一维热方程：\n$$ \\frac{\\partial u}{\\partial t} - \\alpha \\frac{\\partial^2 u}{\\partial x^2} = 0 $$\n在空间域 $x \\in [0, 1]$ 和时间 $t \\ge 0$ 上。热扩散系数 $\\alpha$ 是一个正常数。初始条件由 $u(x, 0) = g(x)$ 给出，边界条件由 $u(0, t) = h_0(t)$ 和 $u(1, t) = h_1(t)$ 给出，其中 $g$、$h_0$ 和 $h_1$ 是已知函数。\n\nPINN 的总损失函数是三个分量的加权和：\n$$ \\mathcal{L}_{total} = \\lambda_{PDE} \\mathcal{L}_{PDE} + \\lambda_{BC} \\mathcal{L}_{BC} + \\lambda_{IC} \\mathcal{L}_{IC} $$\n其中：\n- $\\mathcal{L}_{PDE}$ 是一个损失项，用于衡量网络输出 $u(x,t)$ 在定义域内部满足热方程的程度。当 $\\frac{\\partial u}{\\partial t} - \\alpha \\frac{\\partial^2 u}{\\partial x^2}$ 接近于零时，该项很小。\n- $\\mathcal{L}_{BC}$ 是一个损失项，用于衡量在空间边界上的失配程度。当 $u(0, t)$ 接近 $h_0(t)$ 且 $u(1, t)$ 接近 $h_1(t)$ 时，该项很小。\n- $\\mathcal{L}_{IC}$ 是一个损失项，用于衡量在初始时刻的失配程度。当 $u(x, 0)$ 接近 $g(x)$ 时，该项很小。\n正常数 $\\lambda_{PDE}$、$\\lambda_{BC}$ 和 $\\lambda_{IC}$ 是用户定义的权重，用于控制训练期间每个损失分量的相对重要性。\n\n该学生通过选择不同的权重集训练了两个不同的模型，模型1和模型2。训练完成后，学生观察到以下现象：\n\n- **模型1**：得到的近似解 $u_1(x,t)$ 与初始条件和边界条件非常匹配。然而，PDE残差（定义为 $R_1(x,t) = \\left| \\frac{\\partial u_1}{\\partial t} - \\alpha \\frac{\\partial^2 u_1}{\\partial x^2} \\right|$）的图像显示，在定义域内部的大部分区域，其值很大且非零，这表明控制物理规律没有被很好地捕捉。\n- **模型2**：得到的近似解 $u_2(x,t)$ 产生极小的PDE残差，$R_2(x,t) = \\left| \\frac{\\partial u_2}{\\partial t} - \\alpha \\frac{\\partial^2 u_2}{\\partial x^2} \\right| \\approx 0$，贯穿整个定义域内部。然而，该解在边界处表现不佳，其中 $u_2(0,t)$ 和 $u_2(1,t)$ 显著偏离了要求的函数 $h_0(t)$ 和 $h_1(t)$。\n\n根据这些观察，下列哪个陈述最准确地描述了每个模型所使用的相对权重？符号 $A \\gg B$ 表示‘A 远大于 B’，而 $A \\ll B$ 表示‘A 远小于 B’。为简单起见，假设 $\\lambda_{BC}$ 和 $\\lambda_{IC}$ 具有相似的数量级，并根据它们对边界/初始条件的影响来统称它们。\n\nA. 模型1：$\\lambda_{PDE} \\ll \\lambda_{BC}$；模型2：$\\lambda_{PDE} \\gg \\lambda_{BC}$\n\nB. 模型1：$\\lambda_{PDE} \\gg \\lambda_{BC}$；模型2：$\\lambda_{PDE} \\ll \\lambda_{BC}$\n\nC. 模型1：$\\lambda_{PDE} \\approx \\lambda_{BC}$；模型2：$\\lambda_{PDE} \\gg \\lambda_{BC}$\n\nD. 模型1：$\\lambda_{PDE} \\ll \\lambda_{BC}$；模型2：$\\lambda_{PDE} \\approx \\lambda_{BC}$\n\nE. 两个模型可能都是在 $\\lambda_{PDE} \\approx \\lambda_{BC}$ 的情况下训练的，结果的差异是由于网络的随机初始化造成的。",
            "solution": "PINN 通过最小化加权和来进行训练：\n$$\n\\mathcal{L}_{total} = \\lambda_{PDE} \\mathcal{L}_{PDE} + \\lambda_{BC} \\mathcal{L}_{BC} + \\lambda_{IC} \\mathcal{L}_{IC},\n$$\n其中 $\\mathcal{L}_{PDE}$ 惩罚在内部违反热方程 $\\frac{\\partial u}{\\partial t} - \\alpha \\frac{\\partial^2 u}{\\partial x^2} = 0$ 的行为，而 $\\mathcal{L}_{BC}$、$\\mathcal{L}_{IC}$ 惩罚在边界和初始时刻的失配。优化过程平衡了加权梯度，因此在训练好的解中，主要贡献来自于权重较大的项：\n$$\n\\lambda_{PDE} \\nabla \\mathcal{L}_{PDE} + \\lambda_{BC} \\nabla \\mathcal{L}_{BC} + \\lambda_{IC} \\nabla \\mathcal{L}_{IC} \\approx 0.\n$$\n如果 $\\lambda_{PDE} \\ll \\lambda_{BC}$ 且 $\\lambda_{PDE} \\ll \\lambda_{IC}$，那么 $\\mathcal{L}_{BC}$ 和 $\\mathcal{L}_{IC}$ 的减小会优先于 $\\mathcal{L}_{PDE}$ 的减小；因此，模型将很好地匹配边界和初始条件，同时容忍内部较大的 PDE 残差。这与模型1的情况相符：边界/初始条件吻合得很好，但内部残差 $R_1(x,t) = \\left| \\frac{\\partial u_1}{\\partial t} - \\alpha \\frac{\\partial^2 u_1}{\\partial x^2} \\right|$ 很大。\n\n相反，如果 $\\lambda_{PDE} \\gg \\lambda_{BC}$ 且 $\\lambda_{PDE} \\gg \\lambda_{IC}$，优化过程会强烈惩罚内部的 PDE 违规，从而将 $\\mathcal{L}_{PDE}$（以及残差 $R_2(x,t)$）驱动到极小，同时允许显著的边界和初始失配。这与模型2的情况相符：内部 $R_2(x,t) \\approx 0$，但在 $x=0$ 和 $x=1$ 处与 $h_0(t)$ 和 $h_1(t)$ 的吻合度很差。\n\n由于问题说明将 $\\lambda_{BC}$ 和 $\\lambda_{IC}$ 视为可比较的，并统称其效果，定性结论可简化为：\n$$\n\\text{模型1：}\\lambda_{PDE} \\ll \\lambda_{BC}，\\qquad \\text{模型2：}\\lambda_{PDE} \\gg \\lambda_{BC}。\n$$\n在所有选项中，这正是选项 A。选项 B、C 和 D 颠倒或削弱了必要的主导关系，而选项 E 与两个模型中观察到的系统性、相反的行为相矛盾，这种行为用不同的权重来解释比用随机初始化来解释要好得多。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}