{
    "hands_on_practices": [
        {
            "introduction": "在多孔介质中，流体流动和溶质运移受到多种物理作用的复杂相互作用控制。通过量纲分析，我们可以将这些复杂的控制方程简化为几个关键的无量纲数，从而揭示主导的物理机制。本练习  旨在通过计算佩克莱数（$Pe$）、毛细管数（$Ca$）、邦德数（$Bo$）和雷诺数（$Re$），训练您快速判断特定非水相液体（NAPL）运移场景下，对流、扩散、黏性力、毛细管力和重力中哪一种起决定性作用，这是进行更复杂数值模拟前至关重要的第一步。",
            "id": "3927028",
            "problem": "考虑一个在均质、各向同性多孔介质中非水相液体（NAPL）输运的孔隙尺度情景。假设特征孔喉直径为 $d$，界面速度尺度为 $U$，NAPL的动力粘度为 $\\mu$，NAPL与水之间的界面张力为 $\\sigma$，水相与NAPL的密度差为 $\\Delta \\rho = \\rho_{\\text{water}} - \\rho_{\\text{NAPL}}$，输运溶质在NAPL中的分子扩散系数为 $D_m$，重力加速度为 $g$。NAPL的流体密度为 $\\rho$。您的任务是从第一性原理出发，推导出控制输运的相关无量纲群，然后对特定的测试案例进行数值评估。最后，使用明确的阈值标准对输运状态进行分类。\n\n使用的基本原理：\n- 移动流体中标量浓度质量守恒：被动标量 $C$ 的对流-扩散方程，其形式为对流和扩散之间的平衡。\n- 界面张力、重力和粘性应力作用下，孔隙尺度上不可压缩牛顿流体的动量平衡，通过调用特征尺度来构建各项的比率。\n\n通过对这些基本平衡方程进行适当的无量纲化，使用特征尺度 $(U,d)$ 识别并计算以下无量纲数：\n- 佩克莱数 $Pe$，量化标量输运中的对流与扩散。\n- 毛细管数 $Ca$，量化NAPL-水界面处的粘性应力与界面张力。\n- 邦德数 $Bo$，量化NAPL-水界面处的浮力（重力）与界面张力。\n- 雷诺数 $Re$，量化孔隙尺度流动中的惯性力与粘性应力。\n\n应用于每个测试案例的分类规则，表示为整数代码：\n- 对流-扩散状态代码 $A$：如果 $Pe  1$，则设置 $A=0$；如果 $Pe  10$，则设置 $A=1$；否则设置 $A=2$。\n- 重力-毛细管力主导代码 $F$：如果 $Bo  1$（毛细管力主导），则设置 $F=0$；否则设置 $F=1$（重力主导）。\n- 流动状态代码 $V$：如果 $Re \\le 1$（蠕动流/斯托克斯流），则设置 $V=0$；如果 $1  Re \\le 100$（惯性流），则设置 $V=1$；否则设置 $V=2$（湍流）。",
            "solution": "该问题被评估为有效。它在科学上基于流体动力学和质量输运的原理，信息完备、问题明确，并且表述客观。我们可以着手解决。\n\n任务是推导在孔隙尺度上控制非水相液体（NAPL）输运的相关无量纲群，然后对一组测试案例评估这些无量纲群。推导将基于质量和动量守恒基本控制方程的无量纲化。\n\n给定的特征尺度是用于长度的孔喉直径 $d$ 和用于速度的界面速度尺度 $U$。由此，我们可以定义一个特征时间尺度 $t_{char} = d/U$。\n\n无量纲变量定义如下：\n- 无量纲位置：$\\mathbf{x}^* = \\mathbf{x} / d$\n- 无量纲速度：$\\mathbf{u}^* = \\mathbf{u} / U$\n- 无量纲时间：$t^* = t / (d/U)$\n- 无量纲浓度：$C^* = C / C_0$（其中 $C_0$ 是参考浓度）\n- 无量纲压力：$p^* = p / P_{char}$（其中 $P_{char}$ 是待定的特征压力）\n\n**1. 佩克莱数 ($Pe$) 的推导**\n\n浓度为 $C$ 的被动标量溶质在NAPL内的输运由对流-扩散方程控制：\n$$\n\\frac{\\partial C}{\\partial t} + \\mathbf{u} \\cdot \\nabla C = D_m \\nabla^2 C\n$$\n将无量纲变量代入此方程：\n$$\n\\frac{\\partial (C_0 C^*)}{\\partial (t^* d/U)} + (U \\mathbf{u}^*) \\cdot \\left(\\frac{\\nabla^*}{d}\\right) (C_0 C^*) = D_m \\left(\\frac{\\nabla^{*2}}{d^2}\\right) (C_0 C^*)\n$$\n$$\n\\frac{U C_0}{d} \\frac{\\partial C^*}{\\partial t^*} + \\frac{U C_0}{d} (\\mathbf{u}^* \\cdot \\nabla^* C^*) = \\frac{D_m C_0}{d^2} \\nabla^{*2} C^*\n$$\n将整个方程除以对流输运项的系数 $\\frac{U C_0}{d}$：\n$$\n\\frac{\\partial C^*}{\\partial t^*} + \\mathbf{u}^* \\cdot \\nabla^* C^* = \\left(\\frac{D_m}{U d}\\right) \\nabla^{*2} C^*\n$$\n出现的无量纲群是扩散特征时间（$d^2/D_m$）与对流特征时间（$d/U$）之比。该群是佩克莱数的倒数。佩克莱数 $Pe$ 定义为对流输运速率与扩散输运速率之比：\n$$\nPe = \\frac{\\text{对流输运}}{\\text{扩散输运}} = \\frac{U d}{D_m}\n$$\n\n**2. 雷诺数 ($Re$) 的推导**\n\nNAPL的流动由不可压缩流体的纳维-斯托克斯方程所表达的动量平衡控制。我们考虑其稳态形式，并暂时忽略体力项：\n$$\n\\rho (\\mathbf{u} \\cdot \\nabla \\mathbf{u}) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u}\n$$\n左侧代表单位体积的惯性力，右侧各项分别代表单位体积的压力梯度和粘性力。\n对各项进行尺度分析：\n- 惯性项：$\\rho (\\mathbf{u} \\cdot \\nabla \\mathbf{u}) \\sim \\rho \\frac{U^2}{d}$\n- 粘性项：$\\mu \\nabla^2 \\mathbf{u} \\sim \\mu \\frac{U}{d^2}$\n\n雷诺数 $Re$ 是惯性力与粘性力之比：\n$$\nRe = \\frac{\\text{惯性力}}{\\text{粘性力}} = \\frac{\\rho U^2 / d}{\\mu U / d^2} = \\frac{\\rho U d}{\\mu}\n$$\n\n**3. 毛细管数 ($Ca$) 和邦德数 ($Bo$) 的推导**\n\n这些数产生于NAPL与周围水相界面上的力平衡。我们考虑作用在尺寸为 $d$ 的流体元上的粘性力、毛细管力（界面张力）和浮力（重力）的特征量级。\n\n- **粘性力 ($F_{visc}$):** 源于流动产生的剪切应力。应力为 $\\tau \\sim \\mu (U/d)$，作用于面积 $A \\sim d^2$。\n$$ F_{visc} \\sim \\left(\\mu \\frac{U}{d}\\right) d^2 = \\mu U d $$\n- **毛细管力 ($F_{cap}$):** 源于界面张力，其作用是最小化界面面积。此力沿接触线作用，$L \\sim d$。\n$$ F_{cap} \\sim \\sigma d $$\n- **浮力 ($F_{grav}$):** 源于重力场 $g$ 中密度差 $\\Delta\\rho$，作用于体积 $V \\sim d^3$。\n$$ F_{grav} \\sim (\\Delta\\rho \\cdot V) g \\sim \\Delta\\rho g d^3 $$\n\n**毛细管数** $Ca$ 量化了试图使界面变形的粘性力与抵抗变形的毛细管力之比。\n$$\nCa = \\frac{F_{visc}}{F_{cap}} = \\frac{\\mu U d}{\\sigma d} = \\frac{\\mu U}{\\sigma}\n$$\n\n**邦德数** $Bo$（也称艾特沃斯数）量化了浮力与毛细管力之比。它决定了流体界面的形状是由重力主导还是由界面张力主导。\n$$\nBo = \\frac{F_{grav}}{F_{cap}} = \\frac{\\Delta\\rho g d^3}{\\sigma d} = \\frac{\\Delta\\rho g d^2}{\\sigma}\n$$\n\n**公式总结**\n需要计算的四个无量纲数是：\n- 佩克莱数：$Pe = \\frac{U d}{D_m}$\n- 毛细管数：$Ca = \\frac{\\mu U}{\\sigma}$\n- 邦德数：$Bo = \\frac{\\Delta\\rho g d^2}{\\sigma}$\n- 雷诺数：$Re = \\frac{\\rho U d}{\\mu}$\n\n重力加速度常数为 $g = 9.81\\ \\mathrm{m/s^2}$。\n\n**数值评估与分类**\n\n现在我们将这些公式应用于五个测试案例，并使用给定的分类规则。\n\n**案例 1:** $U=1\\times 10^{-5}$, $d=0.5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$。\n- $Pe = \\frac{(1\\times 10^{-5})(0.5\\times 10^{-3})}{1\\times 10^{-9}} = 5.0$\n- $Ca = \\frac{(5\\times 10^{-3})(1\\times 10^{-5})}{0.03} \\approx 1.666... \\times 10^{-6}$\n- $Bo = \\frac{(300)(9.81)(0.5\\times 10^{-3})^2}{0.03} = 0.024525$\n- $Re = \\frac{(700)(1\\times 10^{-5})(0.5\\times 10^{-3})}{5\\times 10^{-3}} = 7.0\\times 10^{-4}$\n- 分类: $A=2$ ($1 \\le Pe \\le 10$), $F=0$ ($Bo  1$), $V=0$ ($Re \\le 1$)。\n\n**案例 2:** $U=2\\times 10^{-6}$, $d=0.5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$。\n- $Pe = \\frac{(2\\times 10^{-6})(0.5\\times 10^{-3})}{1\\times 10^{-9}} = 1.0$\n- $Ca = \\frac{(5\\times 10^{-3})(2\\times 10^{-6})}{0.03} \\approx 3.333... \\times 10^{-7}$\n- $Bo = \\frac{(300)(9.81)(0.5\\times 10^{-3})^2}{0.03} = 0.024525$\n- $Re = \\frac{(700)(2\\times 10^{-6})(0.5\\times 10^{-3})}{5\\times 10^{-3}} = 1.4\\times 10^{-4}$\n- 分类: $A=2$ ($1 \\le Pe \\le 10$), $F=0$ ($Bo  1$), $V=0$ ($Re \\le 1$)。\n\n**案例 3:** $U=1\\times 10^{-4}$, $d=5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$。\n- $Pe = \\frac{(1\\times 10^{-4})(5\\times 10^{-3})}{1\\times 10^{-9}} = 500.0$\n- $Ca = \\frac{(5\\times 10^{-3})(1\\times 10^{-4})}{0.03} \\approx 1.666... \\times 10^{-5}$\n- $Bo = \\frac{(300)(9.81)(5\\times 10^{-3})^2}{0.03} = 2.4525$\n- $Re = \\frac{(700)(1\\times 10^{-4})(5\\times 10^{-3})}{5\\times 10^{-3}} = 0.07$\n- 分类: $A=1$ ($Pe > 10$), $F=1$ ($Bo > 1$), $V=0$ ($Re \\le 1$)。\n\n**案例 4:** $U=1\\times 10^{-1}$, $d=2\\times 10^{-3}$, $\\mu=1\\times 10^{-3}$, $\\sigma=0.025$, $\\Delta \\rho=200$, $D_m=1\\times 10^{-9}$, $\\rho=800$。\n- $Pe = \\frac{(1\\times 10^{-1})(2\\times 10^{-3})}{1\\times 10^{-9}} = 200000.0$\n- $Ca = \\frac{(1\\times 10^{-3})(1\\times 10^{-1})}{0.025} = 0.004$\n- $Bo = \\frac{(200)(9.81)(2\\times 10^{-3})^2}{0.025} = 0.31392$\n- $Re = \\frac{(800)(1\\times 10^{-1})(2\\times 10^{-3})}{1\\times 10^{-3}} = 160.0$\n- 分类: $A=1$ ($Pe > 10$), $F=0$ ($Bo  1$), $V=2$ ($Re > 100$)。\n\n**案例 5:** $U=1.4285714285714285\\times 10^{-1}$, $d=0.5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$。注意 $U \\approx 1/7$。\n- $Pe = \\frac{(1/7)(0.5\\times 10^{-3})}{1\\times 10^{-9}} \\approx 71428.571...$\n- $Ca = \\frac{(5\\times 10^{-3})(1/7)}{0.03} \\approx 0.023809...$\n- $Bo = \\frac{(300)(9.81)(0.5\\times 10^{-3})^2}{0.03} = 0.024525$\n- $Re = \\frac{(700)(1/7)(0.5\\times 10^{-3})}{5\\times 10^{-3}} = 10.0$\n- 分类: $A=1$ ($Pe > 10$), $F=0$ ($Bo  1$), $V=1$ ($1  Re \\le 100$)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates dimensionless numbers (Pe, Ca, Bo, Re) for NAPL transport\n    and classifies the transport regime for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (U, d, mu, sigma, delta_rho, D_m, rho)\n    test_cases = [\n        (1e-5, 0.5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n        (2e-6, 0.5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n        (1e-4, 5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n        (1e-1, 2e-3, 1e-3, 0.025, 200, 1e-9, 800),\n        (1.4285714285714285e-1, 0.5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n    ]\n\n    g = 9.81  # Gravitational acceleration in m/s^2\n    \n    # Store the string representation of each case's result list\n    all_results_str = []\n\n    for case in test_cases:\n        U, d, mu, sigma, delta_rho, D_m, rho = case\n\n        # Calculate dimensionless numbers\n        Pe = (U * d) / D_m\n        Ca = (mu * U) / sigma\n        Bo = (delta_rho * g * d**2) / sigma\n        Re = (rho * U * d) / mu\n\n        # Classify advection-diffusion regime (A)\n        if Pe  1:\n            A = 0\n        elif Pe > 10:\n            A = 1\n        else:\n            A = 2\n\n        # Classify gravity-capillarity dominance (F)\n        if Bo  1:\n            F = 0\n        else:\n            F = 1\n\n        # Classify flow regime (V)\n        if Re = 1:\n            V = 0\n        elif 1  Re = 100:\n            V = 1\n        else:\n            V = 2\n\n        # Format the result list for the current case as a string\n        # Floats are formatted to exactly nine decimal places.\n        case_str = (\n            f\"[{Pe:.9f},{Ca:.9f},{Bo:.9f},\"\n            f\"{Re:.9f},{A},{F},{V}]\"\n        )\n        all_results_str.append(case_str)\n\n    # Final print statement in the exact required format.\n    # Join the individual result strings with commas and enclose in brackets.\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "当一种流体驱替另一种不相溶的流体时，其动态过程通常由Buckley-Leverett理论描述，该理论是多相流研究的基石。该理论预测了驱替前缘会形成一个饱和度激波（shock front），其传播速度和特性决定了驱替效率。本练习  将指导您从相渗透率和流体黏度的基本参数出发，推导分数流函数，并利用经典的Welge图解法思想来确定激波的饱和度及传播速度，从而深刻理解在无毛细管力影响的理想情况下，驱替过程的宏观表现。",
            "id": "3926990",
            "problem": "一个水平、均质的一维多孔柱初始被非水相液体 (NAPL) 和原生水饱和。在入口处注入水以恒定的总达西通量驱替 NAPL。假设流动为不可混溶、不可压缩的两相流，无重力影响，且孔隙度恒定。相对渗透率遵循具有残余饱和度的 Corey 型关系式。具体而言，设水饱和度为 $S_w$，残余（原生）水饱和度为 $S_{wr} = 0.20$，残余 NAPL 饱和度为 $S_{or} = 0.15$。定义有效水饱和度 $S_{we} = \\dfrac{S_w - S_{wr}}{1 - S_{wr} - S_{or}}$。相对渗透率为 $k_{rw} = k_{rw0}\\, S_{we}^{n_w}$ 和 $k_{rn} = k_{rn0}\\, (1 - S_{we})^{n_n}$，其中 $k_{rw0} = 0.70$, $k_{rn0} = 0.80$, $n_w = 3$, $n_n = 2$。水的粘度为 $\\mu_w = 1.0\\,\\mathrm{cP}$，NAPL 的粘度为 $\\mu_n = 5.0\\,\\mathrm{cP}$。孔隙度为 $\\varepsilon = 0.30$。恒定的总达西通量为 $u_t = 0.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$。初始水饱和度均匀为 $S_w(x,0) = S_{wr}$，入口处的注入水饱和度为 $S_{w,\\mathrm{inj}} = 1 - S_{or}$。\n\n从水相质量守恒、各相的达西定律以及由相迁移率构建的水相分流量 $f_w(S_w)$ 的定义出发，推导前缘激波条件并确定水驱替 NAPL 过程中的激波水饱和度 $S_{ws}$。然后计算无粘性情况（无毛细管扩散）下的激波（前缘）速度 $v_f$。接下来，考虑一个包含毛细管压力效应的模型，该模型产生了如下形式的饱和度方程的毛细管扩散正则化：\n$$\n\\varepsilon\\,\\frac{\\partial S_w}{\\partial t} + u_t\\,\\frac{\\partial f_w(S_w)}{\\partial x} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(D_c(S_w)\\,\\frac{\\partial S_w}{\\partial x}\\right),\n$$\n其中 $D_c(S_w) > 0$ 且足够小但非零。在相同的边界和初始条件下，评估所选的前缘速度相对于无粘性情况是否发生变化。\n\n选择唯一一个正确给出 $S_{ws}$ 的数值、$v_f$ 的数值以及针对毛细管扩散情况的正确比较陈述的选项。\n\n- A. $S_{ws} \\approx 0.576$，$v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且当两端状态固定时，增加毛细管扩散不会改变所选的前缘速度；它只会使前缘变得平滑。\n\n- B. $S_{ws} \\approx 0.578$（直接解释为有效饱和度），$v_f \\approx 0.477\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散会减慢前缘速度。\n\n- C. $S_{ws} \\approx 0.650$，$v_f \\approx 0.513\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散会按与增加的扩散通量成比例地降低速度。\n\n- D. $S_{ws} \\approx 0.576$，$v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，但毛细管扩散会增加前缘速度，因为扩散会叠加在平流上。\n\n- E. $S_{ws} \\approx 0.700$，$v_f \\approx 1.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散不影响速度。",
            "solution": "经评估，该问题陈述科学上合理、适定、客观且自洽。在 Buckley-Leverett 框架下分析两相不可混溶流所需的所有参数均已提供。因此，该问题是 **有效的**。\n\n求解过程分为三个部分：第一，推导激波水饱和度（$S_{ws}$）；第二，计算激波前缘速度（$v_f$）；第三，分析毛细管扩散对前缘速度的影响。\n\n**第一部分：确定激波水饱和度 ($S_{ws}$)**\n\n该流动由一维、不可混溶两相流的 Buckley-Leverett 理论控制。假设无重力且无毛细管压力（无粘性情况），水饱和度 $S_w$ 的控制方程是一个守恒律：\n$$\n\\varepsilon\\,\\frac{\\partial S_w}{\\partial t} + u_t\\,\\frac{\\partial f_w(S_w)}{\\partial x} = 0\n$$\n其中 $\\varepsilon$ 是孔隙度，$u_t$ 是恒定的总达西通量，$f_w(S_w)$ 是水相分流量。分流量函数定义为：\n$$\nf_w(S_w) = \\frac{u_w}{u_t} = \\frac{\\lambda_w}{\\lambda_w + \\lambda_n} = \\frac{k_{rw}/\\mu_w}{k_{rw}/\\mu_w + k_{rn}/\\mu_n} = \\frac{1}{1 + \\frac{\\mu_w}{\\mu_n}\\frac{k_{rn}}{k_{rw}}}\n$$\n此处，$\\lambda_w$ 和 $\\lambda_n$ 分别是水和 NAPL 的迁移率；$k_{rw}$ 和 $k_{rn}$ 是相对渗透率；$\\mu_w$ 和 $\\mu_n$ 是动力粘度。\n\n问题给出了 Corey 型相对渗透率作为有效水饱和度 $S_{we}$ 的函数：\n$$\nS_{we} = \\frac{S_w - S_{wr}}{1 - S_{wr} - S_{or}}\n$$\n$$\nk_{rw} = k_{rw0}\\, S_{we}^{n_w} \\quad \\text{和} \\quad k_{rn} = k_{rn0}\\, (1 - S_{we})^{n_n}\n$$\n给定的参数如下：\n- 残余水饱和度, $S_{wr} = 0.20$\n- 残余 NAPL 饱和度, $S_{or} = 0.15$\n- 水相相对渗透率参数: $k_{rw0} = 0.70$, $n_w = 3$\n- NAPL 相对渗透率参数: $k_{rn0} = 0.80$, $n_n = 2$\n- 水粘度, $\\mu_w = 1.0\\,\\mathrm{cP}$\n- NAPL 粘度, $\\mu_n = 5.0\\,\\mathrm{cP}$\n\n流动饱和度范围是 $1 - S_{wr} - S_{or} = 1 - 0.20 - 0.15 = 0.65$。有效饱和度为 $S_{we} = (S_w - 0.20) / 0.65$。粘度比为 $M = \\mu_n/\\mu_w = 5.0/1.0 = 5.0$。\n\n分流量函数变为：\n$$\nf_w(S_{we}) = \\frac{1}{1 + \\frac{1}{M} \\frac{k_{rn0}\\,(1-S_{we})^{n_n}}{k_{rw0}\\,S_{we}^{n_w}}} = \\frac{1}{1 + \\frac{1}{5.0} \\frac{0.80\\,(1-S_{we})^2}{0.70\\,S_{we}^3}} = \\frac{1}{1 + \\frac{8}{35} \\frac{(1-S_{we})^2}{S_{we}^3}}\n$$\n我们定义一个常数 $C = \\frac{k_{rn0}}{M k_{rw0}} = \\frac{0.80}{5.0 \\cdot 0.70} = \\frac{8}{35}$。分流量函数可以重写为：\n$$\nf_w(S_{we}) = \\frac{S_{we}^3}{S_{we}^3 + C(1-S_{we})^2}\n$$\n该问题描述了注入水驱替原生水（初始饱和度 $S_w(x,0) = S_{wr}$）的过程。这是一个黎曼问题。由于典型分流量曲线呈 S 形，会形成一个激波前缘。该激波连接了初始下游饱和度 $S_w^- = S_{wr}$ 和一个上游饱和度，即激波饱和度 $S_{ws}$。$S_{ws}$ 的值可以通过 Welge 图解法找到，该方法指出，从初始点 $(S_w^-, f_w(S_w^-))$ 到激波点 $(S_{ws}, f_w(S_{ws}))$ 的弦的斜率必须等于分流量曲线在 $S_{ws}$ 处的切线斜率。\n$$\n\\frac{f_w(S_{ws}) - f_w(S_w^-)}{S_{ws} - S_w^-} = \\frac{df_w}{dS_w}\\bigg|_{S_{ws}}\n$$\n初始饱和度为 $S_w^- = S_{wr}$，对应于 $S_{we}^- = 0$。在这一点，$k_{rw}(0) = 0$，因此 $f_w(S_{wr}) = 0$。该条件简化为：\n$$\n\\frac{f_w(S_{ws})}{S_{ws} - S_{wr}} = \\frac{df_w}{dS_w}\\bigg|_{S_{ws}}\n$$\n使用链式法则，$\\frac{df_w}{dS_w} = \\frac{df_w}{dS_{we}} \\frac{dS_{we}}{dS_w} = \\frac{df_w}{dS_{we}} \\frac{1}{1-S_{wr}-S_{or}}$。此外，$S_{ws} - S_{wr} = S_{wes}(1-S_{wr}-S_{or})$，其中 $S_{wes}$ 是有效激波饱和度。该条件变为：\n$$\n\\frac{f_w(S_{wes})}{S_{wes}(1-S_{wr}-S_{or})} = \\frac{1}{1-S_{wr}-S_{or}}\\frac{df_w}{dS_{we}}\\bigg|_{S_{wes}} \\implies \\frac{f_w(S_{wes})}{S_{wes}} = \\frac{df_w}{dS_{we}}\\bigg|_{S_{wes}}\n$$\n我们计算 $f_w(S_{we})$ 的导数：\n$$\n\\frac{df_w}{dS_{we}} = \\frac{d}{dS_{we}}\\left( \\frac{S_{we}^3}{S_{we}^3 + C(1-S_{we})^2} \\right) = \\frac{C S_{we}^2 (1-S_{we}) (3-S_{we})}{(S_{we}^3 + C(1-S_{we})^2)^2}\n$$\n应用切线条件 $\\frac{df_w}{dS_{we}} = \\frac{f_w}{S_{we}}$：\n$$\n\\frac{C S_{wes}^2 (1-S_{wes}) (3-S_{wes})}{(S_{wes}^3 + C(1-S_{wes})^2)^2} = \\frac{S_{wes}^3 / (S_{wes}^3 + C(1-S_{wes})^2)}{S_{wes}}\n$$\n对 $S_{wes} \\in (0,1)$ 进行简化，得到：\n$$\nC(1-S_{wes})(3-S_{wes}) = S_{wes}^3 + C(1-S_{wes})^2\n$$\n$$\nC(3 - 4S_{wes} + S_{wes}^2) = S_{wes}^3 + C(1 - 2S_{wes} + S_{wes}^2)\n$$\n$$\n3C - 4CS_{wes} = S_{wes}^3 + C - 2CS_{wes} \\implies S_{wes}^3 + 2CS_{wes} - 2C = 0\n$$\n代入 $C = 8/35$：\n$$\nS_{wes}^3 + \\frac{16}{35}S_{wes} - \\frac{16}{35} = 0\n$$\n对此三次方程在 $(0,1)$ 区间内进行数值求解，得到根 $S_{wes} \\approx 0.57775$。\n现在，我们将此有效饱和度转换回总水饱和度 $S_{ws}$：\n$$\nS_{ws} = S_{wr} + S_{wes}(1 - S_{wr} - S_{or}) = 0.20 + 0.57775 \\times 0.65 = 0.20 + 0.3755375\n$$\n$$\nS_{ws} \\approx 0.5755 \\approx 0.576\n$$\n\n**第二部分：计算激波前缘速度 ($v_f$)**\n\n饱和度不连续面（激波）的速度由 Rankine-Hugoniot 条件给出，该条件表示了跨越前缘的宏观质量平衡。激波速度 $v_f$ 是一个物理速度（不是达西通量），由以下公式给出：\n$$\nv_f = \\frac{u_t}{\\varepsilon} \\frac{\\Delta f_w}{\\Delta S_w} = \\frac{u_t}{\\varepsilon} \\frac{f_w(S_{ws}) - f_w(S_w^-)}{S_{ws} - S_w^-}\n$$\n由于 $f_w(S_w^-) = f_w(S_{wr}) = 0$，上式变为：\n$$\nv_f = \\frac{u_t}{\\varepsilon} \\frac{f_w(S_{ws})}{S_{ws} - S_{wr}} = \\frac{u_t}{\\varepsilon} \\frac{f_w(S_{wes})}{S_{wes}(1-S_{wr}-S_{or})}\n$$\n根据第一部分推导出的切线条件，我们知道 $S_{wes}^3 = 2C(1-S_{wes})$。我们可以用这个关系来简化 $f_w(S_{wes})$ 的表达式：\n$$\nf_w(S_{wes}) = \\frac{S_{wes}^3}{S_{wes}^3 + C(1-S_{wes})^2} = \\frac{2C(1-S_{wes})}{2C(1-S_{wes}) + C(1-S_{wes})^2} = \\frac{2}{2 + (1-S_{wes})} = \\frac{2}{3-S_{wes}}\n$$\n使用 $S_{wes} \\approx 0.57775$：\n$$\nf_w(S_{wes}) \\approx \\frac{2}{3 - 0.57775} = \\frac{2}{2.42225} \\approx 0.82568\n$$\n现在我们可以使用给定的值 $u_t = 0.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$ 和 $\\varepsilon = 0.30$ 来计算前缘速度 $v_f$：\n$$\nv_f = \\frac{0.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}}{0.30} \\frac{f_w(S_{ws})}{S_{ws} - 0.20} = \\frac{1}{3} \\frac{0.82568}{0.57554 - 0.20} = \\frac{1}{3} \\frac{0.82568}{0.37554} \\approx \\frac{1}{3} \\times 2.1986\n$$\n$$\nv_f \\approx 0.73287\\,\\mathrm{m}\\,\\mathrm{d}^{-1} \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}\n$$\n\n**第三部分：毛细管扩散的影响**\n\n问题引入了一个毛细管扩散项，将控制方程修改为：\n$$\n\\varepsilon\\,\\frac{\\partial S_w}{\\partial t} + u_t\\,\\frac{\\partial f_w(S_w)}{\\partial x} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(D_c(S_w)\\,\\frac{\\partial S_w}{\\partial x}\\right)\n$$\n这是一个抛物型平流-扩散方程。无粘性解中的激波被一个平滑的行波解 $S_w(x,t) = S_w(\\xi)$（其中 $\\xi = x - v_f t$）所替代。这个波的速度 $v_f$ 是通过将方程从上游 ($-\\infty$) 到下游 ($+\\infty$) 横跨波形剖面进行积分来确定的，在这些区域饱和度剖面是平坦的，连接着状态 $S_w^+$ 和 $S_w^-$。\n将方程从 $-\\infty$到 $+\\infty$ 对 $x$ 积分，并应用微积分基本定理，我们得到：\n$$\n\\frac{d}{dt} \\int_{-\\infty}^{\\infty} \\varepsilon S_w dx + u_t \\int_{-\\infty}^{\\infty} \\frac{\\partial f_w}{\\partial x} dx = \\int_{-\\infty}^{\\infty} \\frac{\\partial}{\\partial x}\\!\\left(D_c\\,\\frac{\\partial S_w}{\\partial x}\\right) dx\n$$\n在无穷域上对空间导数积分等于函数在边界处的值的差。设上游和下游状态分别为 $S_w^+$ 和 $S_w^-$。\n$$\n\\frac{d}{dt} (\\text{总水量}) + u_t [f_w(S_w^+) - f_w(S_w^-)] = \\left[ D_c \\frac{\\partial S_w}{\\partial x} \\right]_{-\\infty}^{+\\infty}\n$$\n由于远离前缘处饱和度剖面是平坦的，当 $x \\to \\pm\\infty$ 时，$\\frac{\\partial S_w}{\\partial x} \\to 0$。因此，毛细管扩散项对全局质量平衡的贡献为零。所得的速度由与无粘性情况相同的 Rankine-Hugoniot 跳跃条件确定。\n$$\nv_f = \\frac{u_t}{\\varepsilon} \\frac{f_w(S_w^+) - f_w(S_w^-)}{S_w^+ - S_w^-}\n$$\n对于前缘激波，连接的状态是 $S_w^- = S_{wr}$ 和 $S_w^+ = S_{ws}$。因此，前缘的速度不会因毛细管扩散项的存在而改变。该项的作用是正则化解，用一个物理上真实的、狭窄但平滑的过渡区来替代数学上的不连续面（激波）。\n\n**逐项分析**\n\n- **A. $S_{ws} \\approx 0.576$，$v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且当两端状态固定时，增加毛细管扩散不会改变所选的前缘速度；它只会使前缘变得平滑。**\n  - $S_{ws} \\approx 0.576$：这与我们的计算相符。**正确**。\n  - $v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$：这与我们的计算相符。**正确**。\n  - 毛细管扩散效应：速度不变且前缘平滑的推理与正则化守恒律的行波理论一致。**正确**。\n  - 综合判定：**正确**。\n\n- **B. $S_{ws} \\approx 0.578$（直接解释为有效饱和度），$v_f \\approx 0.477\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散会减慢前缘速度。**\n  - $S_{ws} \\approx 0.578$：这个数值是有效饱和度 $S_{wes}$ 的值，而不是总饱和度 $S_{ws}$。因此，该陈述本身在事实上是不正确的。**错误**。\n  - $v_f \\approx 0.477\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$：我们计算出的值为 $\\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$。**错误**。\n  - 毛细管扩散效应：关于它会减慢前缘速度的说法是错误的。**错误**。\n  - 综合判定：**错误**。\n\n- **C. $S_{ws} \\approx 0.650$，$v_f \\approx 0.513\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散会按与增加的扩散通量成比例地降低速度。**\n  - $S_{ws} \\approx 0.650$：这是流动饱和度范围的大小，而不是激波饱和度。**错误**。\n  - $v_f \\approx 0.513\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$：这与我们的计算不符。**错误**。\n  - 毛细管扩散效应：推理有缺陷。**错误**。\n  - 综合判定：**错误**。\n\n- **D. $S_{ws} \\approx 0.576$，$v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，但毛细管扩散会增加前缘速度，因为扩散会叠加在平流上。**\n  - $S_{ws} \\approx 0.576$：**正确**。\n  - $v_f \\approx 0.733\\,\\mathrm{m}\\,\\d^{-1}$：**正确**。\n  - 毛细管扩散效应：关于它会增加速度的说法是错误的。**错误**。\n  - 综合判定：**错误**。\n\n- **E. $S_{ws} \\approx 0.700$，$v_f \\approx 1.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散不影响速度。**\n  - $S_{ws} \\approx 0.700$：这与我们的计算不符。**错误**。\n  - $v_f \\approx 1.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$：这与我们的计算不符。**错误**。\n  - 毛细管扩散效应：虽然“不影响速度”的说法是正确的，但数值是错误的，使得整个选项无效。**错误**。\n\n根据详细分析，只有选项 A 同时提供了 $S_{ws}$ 和 $v_f$ 的正确数值，以及关于毛细管扩散作用的物理上正确的陈述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在非水相液体（NAPL）污染场地，即使在主要的驱替过程结束后，残留的NAPL仍会作为长期污染源，通过缓慢溶解进入地下水中。量化这一溶解过程的速率对于评估环境风险和设计修复方案至关重要。本练习  运用基于膜理论的传质模型，将微观尺度的界面通量与宏观尺度的污染源耗尽联系起来，让您亲手计算NAPL源区的寿命，从而具体地理解污染场地“长尾效应”的物理基础。",
            "id": "3927011",
            "problem": "一个饱和水的多孔介质中包含一个非水相液体（NAPL）源，其占据的主体区域体积为 $V_{\\text{src}}=1\\ \\mathrm{m}^{3}$。该NAPL与水相形成一个连续的界面。界面面积密度（单位多孔介质主体体积的界面面积）为 $a=200\\ \\mathrm{m}^{-1}$。由于润湿性限制，只有名义界面面积的一部分（比例为 $f_{\\text{wet}}=0.50$）与流动水有水力接触（即可用于质量传递）。流动水中的水相浓度在空间上是均匀的，为 $C=5\\ \\mathrm{mg/L}$，而与纯NAPL接触的平衡水相浓度为 $C^{*}=50\\ \\mathrm{mg/L}$。界面液相传质系数为 $k_{L}=1.0\\times 10^{-5}\\ \\mathrm{m/s}$。假设NAPL是一种纯化合物，密度为 $\\rho_{N}=800\\ \\mathrm{kg/m^{3}}$，并保持充分混合，因此其组分在溶解过程中不发生变化。进一步假设传质机制为稳态的、膜控制的，且界面通量在空间上是均匀的。\n\n从菲克第一定律和基于膜模型的传质系数的定义出发，推导出用跨越界面膜的梯度表示的界面溶解通量 $J$（单位面积单位时间的质量）的合适表达式，然后使用所给参数计算 $J$ 的值。利用质量守恒，将NAPL的耗尽过程处理为由 $-\\mathrm{d}M_{N}/\\mathrm{d}t=J\\,A_{\\text{eff}}$ 控制，其中 $M_{N}$ 是NAPL的质量，$A_{\\text{eff}}$ 是有效的水润湿界面面积。用 $a$、$f_{\\text{wet}}$ 和 $V_{\\text{src}}$ 表示 $A_{\\text{eff}}$，并计算在这些稳态条件下完全耗尽这 $1\\ \\mathrm{m}^{3}$ NAPL源所需的时间。\n\n报告：\n- 界面溶解通量 $J$，单位为 $\\mathrm{mg/(m^{2}\\ s)}$。\n- 耗尽时间，以天为单位。\n\n将您的数值答案四舍五入到四位有效数字。",
            "solution": "基本依据是菲克第一扩散定律。对于跨越界面旁厚度为 $\\delta$ 的静止液膜的一维输运，菲克第一定律指出摩尔或质量通量为\n$$\nj = -D\\,\\frac{\\partial C}{\\partial n},\n$$\n其中 $D$ 是分子扩散系数，$C$ 是浓度；$\\partial/\\partial n$ 表示垂直于界面的梯度。在膜近似下，稳态时穿过薄膜的浓度分布被认为是准线性的，因此\n$$\n\\frac{\\partial C}{\\partial n} \\approx \\frac{C - C^{*}}{\\delta},\n$$\n其中 $C^{*}$ 是NAPL-水界面处的界面平衡浓度，$C$ 是膜外的水相主体浓度。代入菲克第一定律得到\n$$\nj \\approx -D\\,\\frac{C - C^{*}}{\\delta} = \\frac{D}{\\delta}\\,(C^{*} - C).\n$$\n定义基于膜模型的液相传质系数 $k_{L} \\equiv D/\\delta$，可得到标准的界面传质关系式\n$$\nJ = k_{L}\\,(C^{*} - C),\n$$\n其中 $J$ 是单位界面面积的质量通量（当方向从NAPL指向水相时为正）。\n\n使用给定参数计算 $J$。首先计算浓度差。所给量的单位是 $\\mathrm{mg/L}$，但 $J$ 的计算要求单位与 $k_{L}$ 的单位 $\\mathrm{m/s}$ 保持一致，所以我们使用 $1\\ \\mathrm{L} = 10^{-3}\\ \\mathrm{m^{3}}$ 将 $\\mathrm{mg/L}$ 转换为 $\\mathrm{mg/m^{3}}$：\n$$\nC^{*} - C = (50 - 5)\\ \\mathrm{mg/L} = 45\\ \\mathrm{mg/L} = 45 \\times 10^{3}\\ \\mathrm{mg/m^{3}}.\n$$\n因此，\n$$\nJ = k_{L}\\,(C^{*} - C) = \\left(1.0 \\times 10^{-5}\\ \\mathrm{m/s}\\right)\\left(45 \\times 10^{3}\\ \\mathrm{mg/m^{3}}\\right) = 0.45\\ \\mathrm{mg/(m^{2}\\ s)}.\n$$\n\n接下来，计算有效界面面积。界面面积密度 $a$ 是单位多孔介质主体体积的界面面积。给定润湿分数 $f_{\\text{wet}}$ 和源区主体体积 $V_{\\text{src}}$，有效润湿面积为\n$$\nA_{\\text{eff}} = f_{\\text{wet}}\\;a\\;V_{\\text{src}}.\n$$\n使用 $f_{\\text{wet}}=0.50$，$a=200\\ \\mathrm{m^{-1}}$ 和 $V_{\\text{src}}=1\\ \\mathrm{m^{3}}$，\n$$\nA_{\\text{eff}} = 0.50 \\times 200\\ \\mathrm{m^{-1}} \\times 1\\ \\mathrm{m^{3}} = 100\\ \\mathrm{m^{2}}.\n$$\n\nNAPL的质量为\n$$\nM_{N} = \\rho_{N}\\,V_{\\text{src}} = 800\\ \\mathrm{kg/m^{3}} \\times 1\\ \\mathrm{m^{3}} = 800\\ \\mathrm{kg}.\n$$\n为了与 $J$ 的单位 $\\mathrm{mg/(m^{2}\\ s)}$ 保持一致，将 $M_{N}$ 转换为 $\\mathrm{mg}$：\n$$\nM_{N} = 800\\ \\mathrm{kg} \\times 10^{6}\\ \\mathrm{mg/kg} = 8.0 \\times 10^{8}\\ \\mathrm{mg}.\n$$\n\n在 $J$ 和 $A_{\\text{eff}}$ 恒定的稳态条件下，质量守恒给出了耗尽速率\n$$\n-\\frac{\\mathrm{d}M_{N}}{\\mathrm{d}t} = J\\,A_{\\text{eff}}.\n$$\n假设完全耗尽至 $M_{N}=0$，并对时间从 $t=0$ 到 $t=T$ 进行积分，\n$$\n\\int_{M_{N,0}}^{0} \\mathrm{d}M_{N} = - \\int_{0}^{T} J\\,A_{\\text{eff}}\\ \\mathrm{d}t\n\\quad\\Rightarrow\\quad\n- M_{N,0} = -J\\,A_{\\text{eff}}\\,T,\n$$\n所以\n$$\nT = \\frac{M_{N,0}}{J\\,A_{\\text{eff}}}.\n$$\n代入计算出的值：\n$$\nJ\\,A_{\\text{eff}} = 0.45\\ \\mathrm{mg/(m^{2}\\ s)} \\times 100\\ \\mathrm{m^{2}} = 45\\ \\mathrm{mg/s},\n$$\n以及\n$$\nT = \\frac{8.0 \\times 10^{8}\\ \\mathrm{mg}}{45\\ \\mathrm{mg/s}} = 1.777777\\ldots \\times 10^{7}\\ \\mathrm{s}.\n$$\n使用 $1\\ \\mathrm{day} = 86400\\ \\mathrm{s}$ 将秒转换为天：\n$$\nT_{\\text{days}} = \\frac{1.777777\\ldots \\times 10^{7}\\ \\mathrm{s}}{86400\\ \\mathrm{s/day}} \\approx 205.761\\ \\mathrm{days}.\n$$\n\n按照要求四舍五入到四位有效数字：\n- $J = 0.4500\\ \\mathrm{mg/(m^{2}\\ s)}$。\n- $T = 205.8\\ \\mathrm{days}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.4500  205.8\\end{pmatrix}}$$"
        }
    ]
}