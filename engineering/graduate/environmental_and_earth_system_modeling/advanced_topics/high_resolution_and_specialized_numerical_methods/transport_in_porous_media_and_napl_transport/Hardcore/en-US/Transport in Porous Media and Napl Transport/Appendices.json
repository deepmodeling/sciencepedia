{
    "hands_on_practices": [
        {
            "introduction": "Understanding the complex behavior of Non-Aqueous Phase Liquid (NAPL) transport begins with identifying the dominant physical forces at play. This practice guides you through deriving and calculating fundamental dimensionless numbers from first principles, which encapsulate the ratios of key forces like viscosity, inertia, gravity, and interfacial tension. By applying this scaling analysis , you will learn to classify the flow and transport regime, a critical skill for predicting NAPL movement and selecting appropriate modeling approaches.",
            "id": "3927028",
            "problem": "Consider a pore-scale scenario for transport of a Non-Aqueous Phase Liquid (NAPL) in a homogeneous, isotropic porous medium. Assume that the characteristic pore-throat diameter is $d$, the interfacial velocity scale is $U$, the dynamic viscosity of the NAPL is $\\mu$, the interfacial tension between NAPL and water is $\\sigma$, the density difference between the aqueous phase and NAPL is $\\Delta \\rho = \\rho_{\\text{water}} - \\rho_{\\text{NAPL}}$, the molecular diffusivity of the transported solute in the NAPL is $D_m$, and gravitational acceleration is $g$. The fluid density of the NAPL is $\\rho$. Your task is to derive from first principles the relevant dimensionless groups that control transport and then evaluate them numerically for specific test cases. Finally, classify the transport regime using explicit threshold criteria.\n\nFundamental base to use:\n- Mass conservation for a scalar concentration in a moving fluid: the advection–diffusion equation for a passive scalar $C$, with the form of a balance between advection and diffusion.\n- Momentum balance for an incompressible Newtonian fluid at the pore scale with interfacial tension, gravity, and viscous stresses, invoking the characteristic scales to form ratios of terms.\n\nFrom appropriate nondimensionalization of these fundamental balances, identify and compute the following dimensionless numbers using the characteristic scales $(U,d)$:\n- The Peclet number $Pe$ quantifying advection versus diffusion in the scalar transport.\n- The Capillary number $Ca$ quantifying viscous stress versus interfacial tension at the NAPL–water interface.\n- The Bond number $Bo$ quantifying buoyancy (gravity) versus interfacial tension at the NAPL–water interface.\n- The Reynolds number $Re$ quantifying inertia versus viscous stress in the pore-scale flow.\n\nClassification rules to apply to each test case, expressed as integer codes:\n- Advection–diffusion regime code $A$: set $A=0$ if $Pe1$, set $A=1$ if $Pe10$, otherwise set $A=2$.\n- Gravity–capillarity dominance code $F$: set $F=0$ if $Bo1$ (capillarity dominated), otherwise set $F=1$ (gravity dominated).\n- Flow regime code $V$: set $V=0$ if $Re\\le 1$ (creeping/Stokes flow), set $V=1$ if $1Re\\le 100$ (transitional), otherwise set $V=2$ (inertial).\n\nAll dimensionless numbers are to be reported as dimensionless floats with exactly nine digits after the decimal point. All classification codes are integers. Use $g=9.81\\ \\mathrm{m/s^2}$.\n\nTest suite:\nProvide results for the following five test cases. Each case is defined by $(U,d,\\mu,\\sigma,\\Delta \\rho,D_m,\\rho)$, with $U$ in $\\mathrm{m/s}$, $d$ in $\\mathrm{m}$, $\\mu$ in $\\mathrm{Pa\\ s}$, $\\sigma$ in $\\mathrm{N/m}$, $\\Delta \\rho$ and $\\rho$ in $\\mathrm{kg/m^3}$, and $D_m$ in $\\mathrm{m^2/s}$.\n1. $U=1\\times 10^{-5}$, $d=0.5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$.\n2. $U=2\\times 10^{-6}$, $d=0.5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$.\n3. $U=1\\times 10^{-4}$, $d=5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$.\n4. $U=1\\times 10^{-1}$, $d=2\\times 10^{-3}$, $\\mu=1\\times 10^{-3}$, $\\sigma=0.025$, $\\Delta \\rho=200$, $D_m=1\\times 10^{-9}$, $\\rho=800$.\n5. $U=1.4285714285714285\\times 10^{-1}$, $d=0.5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$.\n\nOutput specification:\n- For each test case, compute and return a list of seven values: $[Pe,Ca,Bo,Re,A,F,V]$ where the first four entries are floats (each with exactly nine digits after the decimal point) and the last three entries are integers according to the classification rules.\n- Your program should produce a single line of output containing the results for all five test cases as a comma-separated list of such lists, enclosed in square brackets, e.g., \"[[...],[...],[...],[...],[...]]\".",
            "solution": "The problem is evaluated as valid. It is scientifically grounded in the principles of fluid dynamics and mass transport, well-posed with all necessary information provided, and objective in its formulation. We can proceed with a solution.\n\nThe task is to derive the relevant dimensionless groups that govern the transport of a Non-Aqueous Phase Liquid (NAPL) at the pore scale and then evaluate these groups for a set of test cases. The derivation will be based on the nondimensionalization of the fundamental governing equations for mass and momentum conservation.\n\nThe characteristic scales given are the pore-throat diameter $d$ for length and the interfacial velocity scale $U$ for velocity. From these, we can define a characteristic time scale $t_{char} = d/U$.\n\nThe dimensionless variables are defined as follows:\n- Dimensionless position: $\\mathbf{x}^* = \\mathbf{x} / d$\n- Dimensionless velocity: $\\mathbf{u}^* = \\mathbf{u} / U$\n- Dimensionless time: $t^* = t / (d/U)$\n- Dimensionless concentration: $C^* = C / C_0$ (where $C_0$ is a reference concentration)\n- Dimensionless pressure: $p^* = p / P_{char}$ (where $P_{char}$ is a characteristic pressure to be determined)\n\n**1. Derivation of the Peclet Number ($Pe$)**\n\nThe transport of a passive scalar solute with concentration $C$ within the NAPL is governed by the advection-diffusion equation:\n$$\n\\frac{\\partial C}{\\partial t} + \\mathbf{u} \\cdot \\nabla C = D_m \\nabla^2 C\n$$\nSubstituting the dimensionless variables into this equation:\n$$\n\\frac{\\partial (C_0 C^*)}{\\partial (t^* d/U)} + (U \\mathbf{u}^*) \\cdot \\left(\\frac{\\nabla^*}{d}\\right) (C_0 C^*) = D_m \\left(\\frac{\\nabla^{*2}}{d^2}\\right) (C_0 C^*)\n$$\n$$\n\\frac{U C_0}{d} \\frac{\\partial C^*}{\\partial t^*} + \\frac{U C_0}{d} (\\mathbf{u}^* \\cdot \\nabla^* C^*) = \\frac{D_m C_0}{d^2} \\nabla^{*2} C^*\n$$\nDividing the entire equation by the advective transport term coefficient, $\\frac{U C_0}{d}$:\n$$\n\\frac{\\partial C^*}{\\partial t^*} + \\mathbf{u}^* \\cdot \\nabla^* C^* = \\left(\\frac{D_m}{U d}\\right) \\nabla^{*2} C^*\n$$\nThe dimensionless group that appears is the ratio of the characteristic time for diffusion ($d^2/D_m$) to the characteristic time for advection ($d/U$). This group is the inverse of the Peclet number. The Peclet number, $Pe$, is defined as the ratio of advective transport rate to diffusive transport rate:\n$$\nPe = \\frac{\\text{Advective transport}}{\\text{Diffusive transport}} = \\frac{U d}{D_m}\n$$\n\n**2. Derivation of the Reynolds Number ($Re$)**\n\nThe flow of the NAPL is governed by the momentum balance expressed by the Navier-Stokes equation for an incompressible fluid. We consider the steady-state form and neglect the body force term for now:\n$$\n\\rho (\\mathbf{u} \\cdot \\nabla \\mathbf{u}) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u}\n$$\nThe left side represents inertial forces per unit volume, and the terms on the right side represent pressure gradient and viscous forces per unit volume.\nScaling the terms:\n- Inertial term: $\\rho (\\mathbf{u} \\cdot \\nabla \\mathbf{u}) \\sim \\rho \\frac{U^2}{d}$\n- Viscous term: $\\mu \\nabla^2 \\mathbf{u} \\sim \\mu \\frac{U}{d^2}$\n\nThe Reynolds number, $Re$, is the ratio of inertial forces to viscous forces:\n$$\nRe = \\frac{\\text{Inertial forces}}{\\text{Viscous forces}} = \\frac{\\rho U^2 / d}{\\mu U / d^2} = \\frac{\\rho U d}{\\mu}\n$$\n\n**3. Derivation of the Capillary Number ($Ca$) and Bond Number ($Bo$)**\n\nThese numbers arise from the balance of forces at the interface between the NAPL and the surrounding aqueous phase. We consider the characteristic magnitudes of the viscous, capillary (interfacial tension), and buoyancy (gravity) forces acting on a fluid element of size $d$.\n\n- **Viscous force ($F_{visc}$):** Arises from the shear stress exerted by the flow. Stress is $\\tau \\sim \\mu (U/d)$, acting over an area $A \\sim d^2$.\n$$ F_{visc} \\sim \\left(\\mu \\frac{U}{d}\\right) d^2 = \\mu U d $$\n- **Capillary force ($F_{cap}$):** Arises from interfacial tension acting to minimize interfacial area. This force acts along the contact line, $L \\sim d$.\n$$ F_{cap} \\sim \\sigma d $$\n- **Buoyancy force ($F_{grav}$):** Arises from the density difference $\\Delta\\rho$ in a gravitational field $g$, acting on the volume $V \\sim d^3$.\n$$ F_{grav} \\sim (\\Delta\\rho \\cdot V) g \\sim \\Delta\\rho g d^3 $$\n\nThe **Capillary number**, $Ca$, quantifies the ratio of viscous forces seeking to deform the interface to capillary forces that resist deformation.\n$$\nCa = \\frac{F_{visc}}{F_{cap}} = \\frac{\\mu U d}{\\sigma d} = \\frac{\\mu U}{\\sigma}\n$$\n\nThe **Bond number**, $Bo$ (also known as the Eötvös number), quantifies the ratio of buoyancy forces to capillary forces. It determines whether the shape of the fluid interface is dominated by gravity or by interfacial tension.\n$$\nBo = \\frac{F_{grav}}{F_{cap}} = \\frac{\\Delta\\rho g d^3}{\\sigma d} = \\frac{\\Delta\\rho g d^2}{\\sigma}\n$$\n\n**Summary of Formulas**\nThe four dimensionless numbers to be calculated are:\n- Peclet number: $Pe = \\frac{U d}{D_m}$\n- Capillary number: $Ca = \\frac{\\mu U}{\\sigma}$\n- Bond number: $Bo = \\frac{\\Delta\\rho g d^2}{\\sigma}$\n- Reynolds number: $Re = \\frac{\\rho U d}{\\mu}$\n\nThe constant for gravitational acceleration is $g = 9.81\\ \\mathrm{m/s^2}$.\n\n**Numerical Evaluation and Classification**\n\nWe now apply these formulas to the five test cases and use the provided classification rules.\n\n**Case 1:** $U=1\\times 10^{-5}$, $d=0.5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$.\n- $Pe = \\frac{(1\\times 10^{-5})(0.5\\times 10^{-3})}{1\\times 10^{-9}} = 5.0$\n- $Ca = \\frac{(5\\times 10^{-3})(1\\times 10^{-5})}{0.03} \\approx 1.666... \\times 10^{-6}$\n- $Bo = \\frac{(300)(9.81)(0.5\\times 10^{-3})^2}{0.03} = 0.024525$\n- $Re = \\frac{(700)(1\\times 10^{-5})(0.5\\times 10^{-3})}{5\\times 10^{-3}} = 7.0\\times 10^{-4}$\n- Classification: $A=2$ ($1  Pe \\le 10$), $F=0$ ($Bo  1$), $V=0$ ($Re \\le 1$).\n\n**Case 2:** $U=2\\times 10^{-6}$, $d=0.5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$.\n- $Pe = \\frac{(2\\times 10^{-6})(0.5\\times 10^{-3})}{1\\times 10^{-9}} = 1.0$\n- $Ca = \\frac{(5\\times 10^{-3})(2\\times 10^{-6})}{0.03} \\approx 3.333... \\times 10^{-7}$\n- $Bo = \\frac{(300)(9.81)(0.5\\times 10^{-3})^2}{0.03} = 0.024525$\n- $Re = \\frac{(700)(2\\times 10^{-6})(0.5\\times 10^{-3})}{5\\times 10^{-3}} = 1.4\\times 10^{-4}$\n- Classification: $A=2$ (otherwise, since $Pe$ is not $1$), $F=0$ ($Bo  1$), $V=0$ ($Re \\le 1$).\n\n**Case 3:** $U=1\\times 10^{-4}$, $d=5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$.\n- $Pe = \\frac{(1\\times 10^{-4})(5\\times 10^{-3})}{1\\times 10^{-9}} = 500.0$\n- $Ca = \\frac{(5\\times 10^{-3})(1\\times 10^{-4})}{0.03} \\approx 1.666... \\times 10^{-5}$\n- $Bo = \\frac{(300)(9.81)(5\\times 10^{-3})^2}{0.03} = 2.4525$\n- $Re = \\frac{(700)(1\\times 10^{-4})(5\\times 10^{-3})}{5\\times 10^{-3}} = 0.07$\n- Classification: $A=1$ ($Pe  10$), $F=1$ ($Bo  1$), $V=0$ ($Re \\le 1$).\n\n**Case 4:** $U=1\\times 10^{-1}$, $d=2\\times 10^{-3}$, $\\mu=1\\times 10^{-3}$, $\\sigma=0.025$, $\\Delta \\rho=200$, $D_m=1\\times 10^{-9}$, $\\rho=800$.\n- $Pe = \\frac{(1\\times 10^{-1})(2\\times 10^{-3})}{1\\times 10^{-9}} = 200000.0$\n- $Ca = \\frac{(1\\times 10^{-3})(1\\times 10^{-1})}{0.025} = 0.004$\n- $Bo = \\frac{(200)(9.81)(2\\times 10^{-3})^2}{0.025} = 0.31392$\n- $Re = \\frac{(800)(1\\times 10^{-1})(2\\times 10^{-3})}{1\\times 10^{-3}} = 160.0$\n- Classification: $A=1$ ($Pe  10$), $F=0$ ($Bo  1$), $V=2$ (otherwise, since $Re  100$).\n\n**Case 5:** $U=1.4285714285714285\\times 10^{-1}$, $d=0.5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}$, $\\sigma=0.03$, $\\Delta \\rho=300$, $D_m=1\\times 10^{-9}$, $\\rho=700$. Note that $U=1/7$.\n- $Pe = \\frac{(1/7)(0.5\\times 10^{-3})}{1\\times 10^{-9}} \\approx 71428.571...$\n- $Ca = \\frac{(5\\times 10^{-3})(1/7)}{0.03} \\approx 0.023809...$\n- $Bo = \\frac{(300)(9.81)(0.5\\times 10^{-3})^2}{0.03} = 0.024525$\n- $Re = \\frac{(700)(1/7)(0.5\\times 10^{-3})}{5\\times 10^{-3}} = 10.0$\n- Classification: $A=1$ ($Pe  10$), $F=0$ ($Bo  1$), $V=1$ ($1  Re \\le 100$).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates dimensionless numbers (Pe, Ca, Bo, Re) for NAPL transport\n    and classifies the transport regime for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (U, d, mu, sigma, delta_rho, D_m, rho)\n    test_cases = [\n        (1e-5, 0.5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n        (2e-6, 0.5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n        (1e-4, 5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n        (1e-1, 2e-3, 1e-3, 0.025, 200, 1e-9, 800),\n        (1.4285714285714285e-1, 0.5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n    ]\n\n    g = 9.81  # Gravitational acceleration in m/s^2\n    \n    # Store the string representation of each case's result list\n    all_results_str = []\n\n    for case in test_cases:\n        U, d, mu, sigma, delta_rho, D_m, rho = case\n\n        # Calculate dimensionless numbers\n        Pe = (U * d) / D_m\n        Ca = (mu * U) / sigma\n        Bo = (delta_rho * g * d**2) / sigma\n        Re = (rho * U * d) / mu\n\n        # Classify advection-diffusion regime (A)\n        if Pe  1:\n            A = 0\n        elif Pe  10:\n            A = 1\n        else:\n            A = 2\n\n        # Classify gravity-capillarity dominance (F)\n        if Bo  1:\n            F = 0\n        else:\n            F = 1\n\n        # Classify flow regime (V)\n        if Re = 1:\n            V = 0\n        elif 1  Re = 100:\n            V = 1\n        else:\n            V = 2\n\n        # Format the result list for the current case as a string\n        # Floats are formatted to exactly nine decimal places.\n        case_str = (\n            f\"[{Pe:.9f},{Ca:.9f},{Bo:.9f},\"\n            f\"{Re:.9f},{A},{F},{V}]\"\n        )\n        all_results_str.append(case_str)\n\n    # Final print statement in the exact required format.\n    # Join the individual result strings with commas and enclose in brackets.\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once the governing forces are understood, we can model the dynamic process of one fluid displacing another within a porous medium. The Buckley-Leverett theory offers a classic analytical solution for this process, describing the formation and propagation of a saturation \"shock front\" based on the interplay between fluid viscosities and relative permeabilities. In this practice , you will apply this theory to calculate the shock front's saturation and velocity, gaining insight into the fundamental mechanics of immiscible displacement.",
            "id": "3926990",
            "problem": "A horizontal, homogeneous, one-dimensional porous column is initially saturated with a Non-Aqueous Phase Liquid (NAPL) and connate water. Water is injected at the inlet to displace NAPL at a constant total Darcy flux. Assume immiscible, incompressible two-phase flow, no gravity, and constant porosity. Relative permeabilities follow Corey-type relations with residual saturations. Specifically, let the water saturation be $S_w$, the residual (connate) water saturation be $S_{wr} = 0.20$, and the residual NAPL saturation be $S_{or} = 0.15$. Define the effective water saturation $S_{we} = \\dfrac{S_w - S_{wr}}{1 - S_{wr} - S_{or}}$. The relative permeabilities are $k_{rw} = k_{rw0}\\, S_{we}^{n_w}$ and $k_{rn} = k_{rn0}\\, (1 - S_{we})^{n_n}$ with $k_{rw0} = 0.70$, $k_{rn0} = 0.80$, $n_w = 3$, and $n_n = 2$. Water viscosity is $\\mu_w = 1.0\\,\\mathrm{cP}$ and NAPL viscosity is $\\mu_n = 5.0\\,\\mathrm{cP}$. The porosity is $\\varepsilon = 0.30$. The constant total Darcy flux is $u_t = 0.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$. The initial water saturation is uniform at $S_w(x,0) = S_{wr}$, and the injected water saturation at the inlet is $S_{w,\\mathrm{inj}} = 1 - S_{or}$.\n\nStarting from the water-phase mass conservation, Darcy’s law for each phase, and the definition of the water fractional flow $f_w(S_w)$ constructed from the phase mobilities, derive the leading shock condition and determine the shock water saturation $S_{ws}$ for the displacement of NAPL by water. Then compute the shock (front) velocity $v_f$ for the inviscid case (no capillary diffusion). Next, consider a model that includes capillary pressure effects yielding a capillary-diffusion regularization of the saturation equation of the form\n$$\n\\varepsilon\\,\\frac{\\partial S_w}{\\partial t} + u_t\\,\\frac{\\partial f_w(S_w)}{\\partial x} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(D_c(S_w)\\,\\frac{\\partial S_w}{\\partial x}\\right),\n$$\nwith $D_c(S_w) > 0$ and sufficiently small but nonzero. Under the same boundary and initial conditions, assess whether the selected front velocity changes relative to the inviscid case.\n\nChoose the single option that correctly gives the numerical value of $S_{ws}$, the numerical value of $v_f$, and the correct comparison statement for the capillary-diffusion case.\n\n- A. $S_{ws} \\approx 0.576$, $v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$, and adding capillary diffusion does not change the selected front velocity when end states are fixed; it only smooths the front.\n- B. $S_{ws} \\approx 0.578$ (interpreted directly as effective saturation), $v_f \\approx 0.477\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$, and capillary diffusion slows the front.\n- C. $S_{ws} \\approx 0.650$, $v_f \\approx 0.513\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$, and capillary diffusion reduces the speed in proportion to the added diffusive flux.\n- D. $S_{ws} \\approx 0.576$, $v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$, but capillary diffusion increases the front speed because diffusion adds to advection.\n- E. $S_{ws} \\approx 0.700$, $v_f \\approx 1.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$, and capillary diffusion does not affect the speed.",
            "solution": "The problem statement is evaluated to be scientifically sound, well-posed, objective, and self-contained. All necessary parameters for the analysis of two-phase immiscible flow under the Buckley-Leverett framework are provided. The problem is therefore **valid**.\n\nThe solution proceeds in three parts: first, the derivation of the shock water saturation ($S_{ws}$); second, the calculation of the shock front velocity ($v_f$); and third, the analysis of the effect of capillary diffusion on the front velocity.\n\n**Part 1: Determination of the Shock Water Saturation ($S_{ws}$)**\n\nThe flow is governed by the Buckley-Leverett theory for one-dimensional, immiscible two-phase flow. The governing equation for the water saturation $S_w$, assuming no gravity and no capillary pressure (inviscid case), is a conservation law:\n$$\n\\varepsilon\\,\\frac{\\partial S_w}{\\partial t} + u_t\\,\\frac{\\partial f_w(S_w)}{\\partial x} = 0\n$$\nwhere $\\varepsilon$ is the porosity, $u_t$ is the constant total Darcy flux, and $f_w(S_w)$ is the fractional flow of water. The fractional flow function is defined as:\n$$\nf_w(S_w) = \\frac{u_w}{u_t} = \\frac{\\lambda_w}{\\lambda_w + \\lambda_n} = \\frac{k_{rw}/\\mu_w}{k_{rw}/\\mu_w + k_{rn}/\\mu_n} = \\frac{1}{1 + \\frac{\\mu_w}{\\mu_n}\\frac{k_{rn}}{k_{rw}}}\n$$\nHere, $\\lambda_w$ and $\\lambda_n$ are the mobilities of water and NAPL, respectively; $k_{rw}$ and $k_{rn}$ are the relative permeabilities; and $\\mu_w$ and $\\mu_n$ are the dynamic viscosities.\n\nThe problem provides Corey-type relative permeabilities as functions of the effective water saturation $S_{we}$:\n$$\nS_{we} = \\frac{S_w - S_{wr}}{1 - S_{wr} - S_{or}}\n$$\n$$\nk_{rw} = k_{rw0}\\, S_{we}^{n_w} \\quad \\text{and} \\quad k_{rn} = k_{rn0}\\, (1 - S_{we})^{n_n}\n$$\nThe provided parameters are:\n- Residual water saturation, $S_{wr} = 0.20$\n- Residual NAPL saturation, $S_{or} = 0.15$\n- Water relative permeability parameters: $k_{rw0} = 0.70$, $n_w = 3$\n- NAPL relative permeability parameters: $k_{rn0} = 0.80$, $n_n = 2$\n- Water viscosity, $\\mu_w = 1.0\\,\\mathrm{cP}$\n- NAPL viscosity, $\\mu_n = 5.0\\,\\mathrm{cP}$\n\nThe mobile saturation range is $1 - S_{wr} - S_{or} = 1 - 0.20 - 0.15 = 0.65$. The effective saturation is $S_{we} = (S_w - 0.20) / 0.65$. The viscosity ratio is $M = \\mu_n/\\mu_w = 5.0/1.0 = 5.0$.\n\nThe fractional flow function becomes:\n$$\nf_w(S_{we}) = \\frac{1}{1 + \\frac{1}{M} \\frac{k_{rn0}\\,(1-S_{we})^{n_n}}{k_{rw0}\\,S_{we}^{n_w}}} = \\frac{1}{1 + \\frac{1}{5.0} \\frac{0.80\\,(1-S_{we})^2}{0.70\\,S_{we}^3}} = \\frac{1}{1 + \\frac{8}{35} \\frac{(1-S_{we})^2}{S_{we}^3}}\n$$\nLet's define a constant $C = \\frac{k_{rn0}}{M k_{rw0}} = \\frac{0.80}{5.0 \\cdot 0.70} = \\frac{8}{35}$. The fractional flow function can be rewritten as:\n$$\nf_w(S_{we}) = \\frac{S_{we}^3}{S_{we}^3 + C(1-S_{we})^2}\n$$\nThe problem describes the displacement of connate water (initial saturation $S_w(x,0) = S_{wr}$) by injected water. This is a Riemann problem. Due to the S-shape of the typical fractional flow curve, a shock front forms. The shock connects the initial downstream saturation, $S_w^- = S_{wr}$, to an upstream saturation, the shock saturation $S_{ws}$. The value of $S_{ws}$ is found via the Welge graphical construction, which states that the slope of the chord from the initial point $(S_w^-, f_w(S_w^-))$ to the shock point $(S_{ws}, f_w(S_{ws}))$ must be equal to the slope of the tangent to the fractional flow curve at $S_{ws}$.\n$$\n\\frac{f_w(S_{ws}) - f_w(S_w^-)}{S_{ws} - S_w^-} = \\frac{df_w}{dS_w}\\bigg|_{S_{ws}}\n$$\nThe initial saturation is $S_w^- = S_{wr}$, which corresponds to $S_{we}^- = 0$. At this point, $k_{rw}(0) = 0$, so $f_w(S_{wr}) = 0$. The condition simplifies to:\n$$\n\\frac{f_w(S_{ws})}{S_{ws} - S_{wr}} = \\frac{df_w}{dS_w}\\bigg|_{S_{ws}}\n$$\nUsing the chain rule, $\\frac{df_w}{dS_w} = \\frac{df_w}{dS_{we}} \\frac{dS_{we}}{dS_w} = \\frac{df_w}{dS_{we}} \\frac{1}{1-S_{wr}-S_{or}}$. Also, $S_{ws} - S_{wr} = S_{wes}(1-S_{wr}-S_{or})$, where $S_{wes}$ is the effective shock saturation. The condition becomes:\n$$\n\\frac{f_w(S_{wes})}{S_{wes}(1-S_{wr}-S_{or})} = \\frac{1}{1-S_{wr}-S_{or}}\\frac{df_w}{dS_{we}}\\bigg|_{S_{wes}} \\implies \\frac{f_w(S_{wes})}{S_{wes}} = \\frac{df_w}{dS_{we}}\\bigg|_{S_{wes}}\n$$\nWe compute the derivative of $f_w(S_{we})$:\n$$\n\\frac{df_w}{dS_{we}} = \\frac{d}{dS_{we}}\\left( \\frac{S_{we}^3}{S_{we}^3 + C(1-S_{we})^2} \\right) = \\frac{C S_{we}^2 (1-S_{we}) (3-S_{we})}{(S_{we}^3 + C(1-S_{we})^2)^2}\n$$\nApplying the tangency condition $\\frac{df_w}{dS_{we}} = \\frac{f_w}{S_{we}}$:\n$$\n\\frac{C S_{wes}^2 (1-S_{wes}) (3-S_{wes})}{(S_{wes}^3 + C(1-S_{wes})^2)^2} = \\frac{S_{wes}^3 / (S_{wes}^3 + C(1-S_{wes})^2)}{S_{wes}}\n$$\nSimplifying for $S_{wes} \\in (0,1)$ gives:\n$$\nC(1-S_{wes})(3-S_{wes}) = S_{wes}^3 + C(1-S_{wes})^2\n$$\n$$\nC(3 - 4S_{wes} + S_{wes}^2) = S_{wes}^3 + C(1 - 2S_{wes} + S_{wes}^2)\n$$\n$$\n3C - 4CS_{wes} = S_{wes}^3 + C - 2CS_{wes} \\implies S_{wes}^3 + 2CS_{wes} - 2C = 0\n$$\nSubstituting $C = 8/35$:\n$$\nS_{wes}^3 + \\frac{16}{35}S_{wes} - \\frac{16}{35} = 0\n$$\nSolving this cubic equation numerically for the root in $(0,1)$ yields $S_{wes} \\approx 0.57775$.\nNow, we convert this effective saturation back to the total water saturation $S_{ws}$:\n$$\nS_{ws} = S_{wr} + S_{wes}(1 - S_{wr} - S_{or}) = 0.20 + 0.57775 \\times 0.65 = 0.20 + 0.3755375\n$$\n$$\nS_{ws} \\approx 0.5755 \\approx 0.576\n$$\n\n**Part 2: Calculation of the Shock Front Velocity ($v_f$)**\n\nThe velocity of a saturation discontinuity (shock) is given by the Rankine-Hugoniot condition, which represents a macroscopic mass balance across the front. The shock velocity $v_f$ is a physical velocity (not Darcy flux) and is given by:\n$$\nv_f = \\frac{u_t}{\\varepsilon} \\frac{\\Delta f_w}{\\Delta S_w} = \\frac{u_t}{\\varepsilon} \\frac{f_w(S_{ws}) - f_w(S_w^-)}{S_{ws} - S_w^-}\n$$\nSince $f_w(S_w^-) = f_w(S_{wr}) = 0$, this is:\n$$\nv_f = \\frac{u_t}{\\varepsilon} \\frac{f_w(S_{ws})}{S_{ws} - S_{wr}} = \\frac{u_t}{\\varepsilon} \\frac{f_w(S_{wes})}{S_{wes}(1-S_{wr}-S_{or})}\n$$\nFrom the tangency condition derived in Part 1, we know $S_{wes}^3 = 2C(1-S_{wes})$. We can use this to simplify the expression for $f_w(S_{wes})$:\n$$\nf_w(S_{wes}) = \\frac{S_{wes}^3}{S_{wes}^3 + C(1-S_{wes})^2} = \\frac{2C(1-S_{wes})}{2C(1-S_{wes}) + C(1-S_{wes})^2} = \\frac{2}{2 + (1-S_{wes})} = \\frac{2}{3-S_{wes}}\n$$\nUsing $S_{wes} \\approx 0.57775$:\n$$\nf_w(S_{wes}) \\approx \\frac{2}{3 - 0.57775} = \\frac{2}{2.42225} \\approx 0.82568\n$$\nNow we can compute the front velocity $v_f$ using the provided values $u_t = 0.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$ and $\\varepsilon = 0.30$:\n$$\nv_f = \\frac{0.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}}{0.30} \\frac{f_w(S_{ws})}{S_{ws} - 0.20} = \\frac{1}{3} \\frac{0.82568}{0.57554 - 0.20} = \\frac{1}{3} \\frac{0.82568}{0.37554} \\approx \\frac{1}{3} \\times 2.1986\n$$\n$$\nv_f \\approx 0.73287\\,\\mathrm{m}\\,\\mathrm{d}^{-1} \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}\n$$\n\n**Part 3: Effect of Capillary Diffusion**\n\nThe problem introduces a capillary diffusion term, modifying the governing equation to:\n$$\n\\varepsilon\\,\\frac{\\partial S_w}{\\partial t} + u_t\\,\\frac{\\partial f_w(S_w)}{\\partial x} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(D_c(S_w)\\,\\frac{\\partial S_w}{\\partial x}\\right)\n$$\nThis is a parabolic advection-diffusion equation. A shock in the inviscid solution is replaced by a smooth traveling wave solution $S_w(x,t) = S_w(\\xi)$ with $\\xi = x - v_f t$. The velocity $v_f$ of this wave is determined by integrating the equation across the wave profile from upstream ($-\\infty$) to downstream ($+\\infty$), where the saturation profile is flat, connecting states $S_w^+$ and $S_w^-$.\nIntegrating the equation with respect to $x$ from $-\\infty$ to $+\\infty$ and applying the fundamental theorem of calculus, we obtain:\n$$\n\\frac{d}{dt} \\int_{-\\infty}^{\\infty} \\varepsilon S_w dx + u_t \\int_{-\\infty}^{\\infty} \\frac{\\partial f_w}{\\partial x} dx = \\int_{-\\infty}^{\\infty} \\frac{\\partial}{\\partial x}\\!\\left(D_c\\,\\frac{\\partial S_w}{\\partial x}\\right) dx\n$$\nThe integral of a spatial derivative over an infinite domain is the difference of the function at the boundaries. Let the upstream and downstream states be $S_w^+$ and $S_w^-$.\n$$\n\\frac{d}{dt} (\\text{Total Water}) + u_t [f_w(S_w^+) - f_w(S_w^-)] = \\left[ D_c \\frac{\\partial S_w}{\\partial x} \\right]_{-\\infty}^{+\\infty}\n$$\nSince the saturation profile is flat far away from the front, $\\frac{\\partial S_w}{\\partial x} \\to 0$ as $x \\to \\pm\\infty$. Thus, the capillary diffusion term contributes zero to the global mass balance. The resulting velocity is determined by the same Rankine-Hugoniot jump condition as in the inviscid case.\n$$\nv_f = \\frac{u_t}{\\varepsilon} \\frac{f_w(S_w^+) - f_w(S_w^-)}{S_w^+ - S_w^-}\n$$\nFor the leading shock, the connected states are $S_w^- = S_{wr}$ and $S_w^+ = S_{ws}$. Therefore, the speed of the front is not altered by the presence of the capillary diffusion term. The effect of this term is to regularize the solution, replacing the mathematical discontinuity (shock) with a physically realistic, narrow but smooth transition zone.\n\n**Option-by-Option Analysis**\n\n- **A. $S_{ws} \\approx 0.576$, $v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$, and adding capillary diffusion does not change the selected front velocity when end states are fixed; it only smooths the front.**\n  - $S_{ws} \\approx 0.576$: This matches our calculation. **Correct**.\n  - $v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$: This matches our calculation. **Correct**.\n  - Capillary diffusion effect: The reasoning that the velocity is unchanged and the front is smoothed is consistent with the theory of traveling waves for regularized conservation laws. **Correct**.\n  - Overall verdict: **Correct**.\n\n- **B. $S_{ws} \\approx 0.578$ (interpreted directly as effective saturation), $v_f \\approx 0.477\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$, and capillary diffusion slows the front.**\n  - $S_{ws} \\approx 0.578$: This is numerically the value for the effective saturation $S_{wes}$, not the total saturation $S_{ws}$. The statement is therefore factually incorrect as written. **Incorrect**.\n  - $v_f \\approx 0.477\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$: Our calculated value is $\\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$. **Incorrect**.\n  - Capillary diffusion effect: The statement that it slows the front is erroneous. **Incorrect**.\n  - Overall verdict: **Incorrect**.\n\n- **C. $S_{ws} \\approx 0.650$, $v_f \\approx 0.513\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$, and capillary diffusion reduces the speed in proportion to the added diffusive flux.**\n  - $S_{ws} \\approx 0.650$: This is the magnitude of the mobile saturation range, not the shock saturation. **Incorrect**.\n  - $v_f \\approx 0.513\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$: This does not match our calculation. **Incorrect**.\n  - Capillary diffusion effect: The reasoning is flawed. **Incorrect**.\n  - Overall verdict: **Incorrect**.\n\n- **D. $S_{ws} \\approx 0.576$, $v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$, but capillary diffusion increases the front speed because diffusion adds to advection.**\n  - $S_{ws} \\approx 0.576$: **Correct**.\n  - $v_f \\approx 0.733\\,\\mathrm{m}\\,\\d^{-1}$: **Correct**.\n  - Capillary diffusion effect: The statement that it increases the speed is false. **Incorrect**.\n  - Overall verdict: **Incorrect**.\n\n- **E. $S_{ws} \\approx 0.700$, $v_f \\approx 1.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$, and capillary diffusion does not affect the speed.**\n  - $S_{ws} \\approx 0.700$: This does not match our calculation. **Incorrect**.\n  - $v_f \\approx 1.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$: This does not match our calculation. **Incorrect**.\n  - Capillary diffusion effect: While the claim \"does not affect the speed\" is correct, the numerical values are wrong, making the entire option invalid. **Incorrect**.\n\nBased on the detailed analysis, only option A provides the correct numerical values for both $S_{ws}$ and $v_f$, along with a physically correct statement regarding the role of capillary diffusion.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Following primary migration, residual NAPL often remains trapped in the pore space, acting as a long-term source of contamination through slow dissolution into groundwater. This process is governed by mass transfer across the NAPL-water interface, a key mechanism in contaminant hydrogeology. This practice  allows you to quantify the dissolution flux and estimate the lifespan of a NAPL source, providing critical insights for assessing environmental risk and designing effective remediation strategies.",
            "id": "3927011",
            "problem": "A water-saturated porous medium contains a Non-Aqueous Phase Liquid (NAPL) source occupying a bulk region of volume $V_{\\text{src}}=1\\ \\mathrm{m}^{3}$. The NAPL forms a contiguous interface with the aqueous phase. The interfacial area density (interfacial area per bulk porous volume) is $a=200\\ \\mathrm{m}^{-1}$. Due to wettability constraints, only a fraction $f_{\\text{wet}}=0.50$ of the nominal interfacial area is in hydraulic contact with flowing water (i.e., available for mass transfer). The aqueous concentration in the mobile water is spatially uniform at $C=5\\ \\mathrm{mg/L}$, and the equilibrium aqueous concentration in contact with the pure NAPL is $C^{*}=50\\ \\mathrm{mg/L}$. The interfacial liquid-phase mass transfer coefficient is $k_{L}=1.0\\times 10^{-5}\\ \\mathrm{m/s}$. Assume the NAPL is a pure compound of density $\\rho_{N}=800\\ \\mathrm{kg/m^{3}}$ and remains well-mixed so that its composition does not change during dissolution. Further assume a steady, film-controlled mass transfer regime with a spatially uniform interfacial flux.\n\nStarting from Fick’s first law and the definition of a film-based mass transfer coefficient, derive the appropriate expression for the interfacial dissolution flux $J$ (mass per area per time) in terms of a gradient across an interfacial film and then evaluate $J$ using the provided parameters. Using conservation of mass, treat the NAPL depletion as governed by $-\\mathrm{d}M_{N}/\\mathrm{d}t=J\\,A_{\\text{eff}}$, where $M_{N}$ is the NAPL mass and $A_{\\text{eff}}$ is the effective water-wetted interfacial area. Express $A_{\\text{eff}}$ in terms of $a$, $f_{\\text{wet}}$, and $V_{\\text{src}}$, and compute the time to completely deplete the $1\\ \\mathrm{m}^{3}$ NAPL source under these steady conditions.\n\nReport:\n- The interfacial dissolution flux $J$ in $\\mathrm{mg/(m^{2}\\ s)}$.\n- The depletion time in days.\n\nRound your numerical answers to four significant figures.",
            "solution": "The fundamental base is Fick’s first law of diffusion. For one-dimensional transport across a stagnant liquid film of thickness $\\delta$ adjacent to an interface, Fick’s first law states the molar or mass flux is\n$$\nj = -D\\,\\frac{\\partial C}{\\partial n},\n$$\nwhere $D$ is the molecular diffusivity and $C$ is the concentration; $\\partial/\\partial n$ denotes the gradient normal to the interface. Under the film approximation, the concentration profile across the thin film is taken to be quasi-linear at steady state, so\n$$\n\\frac{\\partial C}{\\partial n} \\approx \\frac{C - C^{*}}{\\delta},\n$$\nwhere $C^{*}$ is the interfacial equilibrium concentration at the NAPL–water interface and $C$ is the bulk aqueous concentration outside the film. Substituting into Fick’s first law gives\n$$\nj \\approx -D\\,\\frac{C - C^{*}}{\\delta} = \\frac{D}{\\delta}\\,(C^{*} - C).\n$$\nDefining the film-based liquid-phase mass transfer coefficient $k_{L} \\equiv D/\\delta$ yields the standard interfacial mass transfer relationship\n$$\nJ = k_{L}\\,(C^{*} - C),\n$$\nwhere $J$ is the mass flux per unit interfacial area (positive when directed from the NAPL into the water phase).\n\nEvaluate $J$ using the given parameters. First compute the concentration difference. The quantities are provided in $\\mathrm{mg/L}$, but $J$ requires consistency with $k_{L}$ in $\\mathrm{m/s}$, so we convert $\\mathrm{mg/L}$ to $\\mathrm{mg/m^{3}}$ using $1\\ \\mathrm{L} = 10^{-3}\\ \\mathrm{m^{3}}$:\n$$\nC^{*} - C = (50 - 5)\\ \\mathrm{mg/L} = 45\\ \\mathrm{mg/L} = 45 \\times 10^{3}\\ \\mathrm{mg/m^{3}}.\n$$\nThus,\n$$\nJ = k_{L}\\,(C^{*} - C) = \\left(1.0 \\times 10^{-5}\\ \\mathrm{m/s}\\right)\\left(45 \\times 10^{3}\\ \\mathrm{mg/m^{3}}\\right) = 0.45\\ \\mathrm{mg/(m^{2}\\ s)}.\n$$\n\nNext, compute the effective interfacial area. The interfacial area density $a$ is the interfacial area per bulk porous volume. With a wetted fraction $f_{\\text{wet}}$ and a source-region bulk volume $V_{\\text{src}}$, the effective wetted area is\n$$\nA_{\\text{eff}} = f_{\\text{wet}}\\;a\\;V_{\\text{src}}.\n$$\nUsing $f_{\\text{wet}}=0.50$, $a=200\\ \\mathrm{m^{-1}}$, and $V_{\\text{src}}=1\\ \\mathrm{m^{3}}$,\n$$\nA_{\\text{eff}} = 0.50 \\times 200\\ \\mathrm{m^{-1}} \\times 1\\ \\mathrm{m^{3}} = 100\\ \\mathrm{m^{2}}.\n$$\n\nThe NAPL mass is\n$$\nM_{N} = \\rho_{N}\\,V_{\\text{src}} = 800\\ \\mathrm{kg/m^{3}} \\times 1\\ \\mathrm{m^{3}} = 800\\ \\mathrm{kg}.\n$$\nTo be consistent with $J$ in $\\mathrm{mg/(m^{2}\\ s)}$, convert $M_{N}$ to $\\mathrm{mg}$:\n$$\nM_{N} = 800\\ \\mathrm{kg} \\times 10^{6}\\ \\mathrm{mg/kg} = 8.0 \\times 10^{8}\\ \\mathrm{mg}.\n$$\n\nUnder steady conditions with constant $J$ and $A_{\\text{eff}}$, conservation of mass gives the depletion rate\n$$\n-\\frac{\\mathrm{d}M_{N}}{\\mathrm{d}t} = J\\,A_{\\text{eff}}.\n$$\nAssuming complete depletion to $M_{N}=0$ and integrating in time from $t=0$ to $t=T$,\n$$\n\\int_{M_{N,0}}^{0} \\mathrm{d}M_{N} = - \\int_{0}^{T} J\\,A_{\\text{eff}}\\ \\mathrm{d}t\n\\quad\\Rightarrow\\quad\n- M_{N,0} = -J\\,A_{\\text{eff}}\\,T,\n$$\nso\n$$\nT = \\frac{M_{N,0}}{J\\,A_{\\text{eff}}}.\n$$\nSubstitute the computed values:\n$$\nJ\\,A_{\\text{eff}} = 0.45\\ \\mathrm{mg/(m^{2}\\ s)} \\times 100\\ \\mathrm{m^{2}} = 45\\ \\mathrm{mg/s},\n$$\nand\n$$\nT = \\frac{8.0 \\times 10^{8}\\ \\mathrm{mg}}{45\\ \\mathrm{mg/s}} = 1.777777\\ldots \\times 10^{7}\\ \\mathrm{s}.\n$$\nConvert seconds to days using $1\\ \\mathrm{day} = 86400\\ \\mathrm{s}$:\n$$\nT_{\\text{days}} = \\frac{1.777777\\ldots \\times 10^{7}\\ \\mathrm{s}}{86400\\ \\mathrm{s/day}} \\approx 205.761\\ \\mathrm{days}.\n$$\n\nApplying the instructed rounding to four significant figures:\n- $J = 0.4500\\ \\mathrm{mg/(m^{2}\\ s)}$.\n- $T = 205.8\\ \\mathrm{days}$.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.4500  205.8\\end{pmatrix}}$$"
        }
    ]
}