{
    "hands_on_practices": [
        {
            "introduction": "理解多孔介质中复杂的输运现象，首先需要识别其中相互竞争的关键物理作用力。无量纲数是实现这一目标的强大工具，它让我们无需解出完整的复杂方程就能对输运机制进行分类。这项练习  将训练您进行尺度分析的基本技能，这对于理论建模和实验设计都至关重要。",
            "id": "3927028",
            "problem": "考虑一个均质、各向同性多孔介质中非水相液体（NAPL）输运的孔隙尺度情景。假设特征孔喉直径为 $d$，界面速度标度为 $U$，NAPL的动力粘度为 $\\mu$，NAPL与水之间的界面张力为 $\\sigma$，水相与NAPL之间的密度差为 $\\Delta \\rho = \\rho_{\\text{water}} - \\rho_{\\text{NAPL}}$，被输运溶质在NAPL中的分子扩散系数为 $D_m$，重力加速度为 $g$。NAPL的流体密度为 $\\rho$。您的任务是从第一性原理出发，推导控制输运的相关无量纲数群，然后针对特定的测试案例对它们进行数值评估。最后，使用明确的阈值标准对输运状态进行分类。\n\n使用的基本原理：\n- 运动流体中标量浓度的质量守恒：被动标量 $C$ 的对流-扩散方程，形式为对流与扩散之间的平衡。\n- 在孔隙尺度下，不可压缩牛顿流体的动量平衡，考虑界面张力、重力和粘性应力，并利用特征尺度来构成各项的比率。\n\n通过对这些基本平衡方程进行适当的无量纲化，使用特征尺度 $(U,d)$ 识别并计算以下无量纲数：\n- 佩克莱数 $Pe$，量化标量输运中的对流与扩散之比。\n- 毛细管数 $Ca$，量化NAPL-水界面上粘性应力与界面张力之比。\n- 邦德数 $Bo$，量化NAPL-水界面上浮力（重力）与界面张力之比。\n- 雷诺数 $Re$，量化孔隙尺度流动中惯性与粘性应力之比。\n\n应用于每个测试案例的分类规则，以整数代码表示：\n- 对流-扩散状态代码 $A$：如果 $Pe  1$，则设 $A=0$；如果 $Pe  10$，则设 $A=1$；否则设 $A=2$。\n- 重力-毛细作用主导代码 $F$：如果 $Bo  1$（毛细作用主导），则设 $F=0$；否则设 $F=1$（重力主导）。\n- 流态代码 $V$：如果 $Re \\le 1$（蠕动/斯托克斯流），则设 $V=0$；如果 $1  Re \\le 100$（惯性流），则设 $V=1$；否则设 $V=2$（湍流）。\n\n将每个测试案例的结果表示为一个列表 `[Pe, Ca, Bo, Re, A, F, V]`，其中浮点数应四舍五入到9位小数。将所有五个案例的列表收集到一个最终列表中，并以所需的格式输出。\n\n**测试案例**\n以下是五个测试案例的参数（所有单位均为SI基本单位）：\n1.  $U=1\\times 10^{-5}, d=0.5\\times 10^{-3}, \\mu=5\\times 10^{-3}, \\sigma=0.03, \\Delta \\rho=300, D_m=1\\times 10^{-9}, \\rho=700$\n2.  $U=2\\times 10^{-6}, d=0.5\\times 10^{-3}, \\mu=5\\times 10^{-3}, \\sigma=0.03, \\Delta \\rho=300, D_m=1\\times 10^{-9}, \\rho=700$\n3.  $U=1\\times 10^{-4}, d=5\\times 10^{-3}, \\mu=5\\times 10^{-3}, \\sigma=0.03, \\Delta \\rho=300, D_m=1\\times 10^{-9}, \\rho=700$\n4.  $U=1\\times 10^{-1}, d=2\\times 10^{-3}, \\mu=1\\times 10^{-3}, \\sigma=0.025, \\Delta \\rho=200, D_m=1\\times 10^{-9}, \\rho=800$\n5.  $U \\approx 1/7, d=0.5\\times 10^{-3}, \\mu=5\\times 10^{-3}, \\sigma=0.03, \\Delta \\rho=300, D_m=1\\times 10^{-9}, \\rho=700$",
            "solution": "该问题被评估为有效。它在科学上基于流体动力学和质量输运原理，问题陈述清晰，提供了所有必要信息，并且表述客观。我们可以着手提供解决方案。\n\n任务是推导在孔隙尺度上控制非水相液体（NAPL）输运的相关无量纲数群，然后为一组测试案例评估这些数群。推导将基于质量和动量守恒基本控制方程的无量纲化。\n\n给定的特征尺度是长度的孔喉直径 $d$ 和速度的界面速度标度 $U$。由此，我们可以定义一个特征时间尺度 $t_{char} = d/U$。\n\n无量纲变量定义如下：\n- 无量纲位置：$\\mathbf{x}^* = \\mathbf{x} / d$\n- 无量纲速度：$\\mathbf{u}^* = \\mathbf{u} / U$\n- 无量纲时间：$t^* = t / (d/U)$\n- 无量纲浓度：$C^* = C / C_0$（其中 $C_0$ 是参考浓度）\n- 无量纲压力：$p^* = p / P_{char}$（其中 $P_{char}$ 是待定的特征压力）\n\n**1. 佩克莱数（$Pe$）的推导**\n\nNAPL内部浓度为 $C$ 的被动标量溶质的输运由对流-扩散方程控制：\n$$\n\\frac{\\partial C}{\\partial t} + \\mathbf{u} \\cdot \\nabla C = D_m \\nabla^2 C\n$$\n将无量纲变量代入此方程：\n$$\n\\frac{\\partial (C_0 C^*)}{\\partial (t^* d/U)} + (U \\mathbf{u}^*) \\cdot \\left(\\frac{\\nabla^*}{d}\\right) (C_0 C^*) = D_m \\left(\\frac{\\nabla^{*2}}{d^2}\\right) (C_0 C^*)\n$$\n$$\n\\frac{U C_0}{d} \\frac{\\partial C^*}{\\partial t^*} + \\frac{U C_0}{d} (\\mathbf{u}^* \\cdot \\nabla^* C^*) = \\frac{D_m C_0}{d^2} \\nabla^{*2} C^*\n$$\n将整个方程除以对流输运项的系数 $\\frac{U C_0}{d}$：\n$$\n\\frac{\\partial C^*}{\\partial t^*} + \\mathbf{u}^* \\cdot \\nabla^* C^* = \\left(\\frac{D_m}{U d}\\right) \\nabla^{*2} C^*\n$$\n出现的无量纲数群是扩散特征时间（$d^2/D_m$）与对流特征时间（$d/U$）之比。该数群是佩克莱数的倒数。佩克莱数 $Pe$ 定义为对流输运速率与扩散输运速率之比：\n$$\nPe = \\frac{\\text{对流输运}}{\\text{扩散输运}} = \\frac{U d}{D_m}\n$$\n\n**2. 雷诺数（$Re$）的推导**\n\nNAPL的流动由不可压缩流体的Navier-Stokes方程所表示的动量平衡控制。我们考虑稳态形式，并暂时忽略体力项：\n$$\n\\rho (\\mathbf{u} \\cdot \\nabla \\mathbf{u}) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u}\n$$\n左侧代表单位体积的惯性力，右侧的项代表单位体积的压力梯度和粘性力。\n对各项进行尺度分析：\n- 惯性项：$\\rho (\\mathbf{u} \\cdot \\nabla \\mathbf{u}) \\sim \\rho \\frac{U^2}{d}$\n- 粘性项：$\\mu \\nabla^2 \\mathbf{u} \\sim \\mu \\frac{U}{d^2}$\n\n雷诺数 $Re$ 是惯性力与粘性力之比：\n$$\nRe = \\frac{\\text{惯性力}}{\\text{粘性力}} = \\frac{\\rho U^2 / d}{\\mu U / d^2} = \\frac{\\rho U d}{\\mu}\n$$\n\n**3. 毛细管数（$Ca$）和邦德数（$Bo$）的推导**\n\n这些数产生于NAPL与周围水相界面的力平衡。我们考虑作用在尺寸为 $d$ 的流体元上的粘性力、毛细力（界面张力）和浮力（重力）的特征量级。\n\n- **粘性力（$F_{visc}$）：** 源于流动产生的剪切应力。应力为 $\\tau \\sim \\mu (U/d)$，作用于面积 $A \\sim d^2$。\n$$ F_{visc} \\sim \\left(\\mu \\frac{U}{d}\\right) d^2 = \\mu U d $$\n- **毛细力（$F_{cap}$）：** 源于界面张力，作用是使界面面积最小化。该力沿接触线作用，其长度 $L \\sim d$。\n$$ F_{cap} \\sim \\sigma d $$\n- **浮力（$F_{grav}$）：** 源于重力场 $g$ 中密度差 $\\Delta\\rho$，作用于体积 $V \\sim d^3$。\n$$ F_{grav} \\sim (\\Delta\\rho \\cdot V) g \\sim \\Delta\\rho g d^3 $$\n\n**毛细管数** $Ca$ 量化了试图使界面变形的粘性力与抵抗变形的毛细力之比。\n$$\nCa = \\frac{F_{visc}}{F_{cap}} = \\frac{\\mu U d}{\\sigma d} = \\frac{\\mu U}{\\sigma}\n$$\n\n**邦德数** $Bo$（也称为 Eötvös 数）量化了浮力与毛细力之比。它决定了流体界面的形状是由重力主导还是由界面张力主导。\n$$\nBo = \\frac{F_{grav}}{F_{cap}} = \\frac{\\Delta\\rho g d^3}{\\sigma d} = \\frac{\\Delta\\rho g d^2}{\\sigma}\n$$\n\n**公式总结**\n需要计算的四个无量纲数是：\n- 佩克莱数：$Pe = \\frac{U d}{D_m}$\n- 毛细管数：$Ca = \\frac{\\mu U}{\\sigma}$\n- 邦德数：$Bo = \\frac{\\Delta\\rho g d^2}{\\sigma}$\n- 雷诺数：$Re = \\frac{\\rho U d}{\\mu}$\n\n重力加速度常数为 $g = 9.81\\ \\mathrm{m/s^2}$。\n\n**数值评估与分类**\n\n我们现在将这些公式应用于五个测试案例，并使用提供的分类规则。\n\n**案例1：** $U=1\\times 10^{-5}$, $d=0.5\\times 10^{-3}$, $\\mu=5\\times 10^{-3}, \\sigma=0.03, \\Delta \\rho=300, D_m=1\\times 10^{-9}, \\rho=700$。\n- $Pe = \\frac{(1\\times 10^{-5})(0.5\\times 10^{-3})}{1\\times 10^{-9}} = 5.0$\n- $Ca = \\frac{(5\\times 10^{-3})(1\\times 10^{-5})}{0.03} \\approx 1.666... \\times 10^{-6}$\n- $Bo = \\frac{(300)(9.81)(0.5\\times 10^{-3})^2}{0.03} = 0.024525$\n- $Re = \\frac{(700)(1\\times 10^{-5})(0.5\\times 10^{-3})}{5\\times 10^{-3}} = 7.0\\times 10^{-4}$\n- 分类：$A=2$ ($1  Pe \\le 10$)，$F=0$ ($Bo  1$)，$V=0$ ($Re \\le 1$)。\n\n**案例2：** $U=2\\times 10^{-6}$, $d=0.5\\times 10^{-3}, \\mu=5\\times 10^{-3}, \\sigma=0.03, \\Delta \\rho=300, D_m=1\\times 10^{-9}, \\rho=700$。\n- $Pe = \\frac{(2\\times 10^{-6})(0.5\\times 10^{-3})}{1\\times 10^{-9}} = 1.0$\n- $Ca = \\frac{(5\\times 10^{-3})(2\\times 10^{-6})}{0.03} \\approx 3.333... \\times 10^{-7}$\n- $Bo = \\frac{(300)(9.81)(0.5\\times 10^{-3})^2}{0.03} = 0.024525$\n- $Re = \\frac{(700)(2\\times 10^{-6})(0.5\\times 10^{-3})}{5\\times 10^{-3}} = 1.4\\times 10^{-4}$\n- 分类：$A=2$ (由于 $Pe=1.0$，不满足 $Pe1$ 或 $Pe>10$)，$F=0$ ($Bo  1$)，$V=0$ ($Re \\le 1$)。\n\n**案例3：** $U=1\\times 10^{-4}$, $d=5\\times 10^{-3}, \\mu=5\\times 10^{-3}, \\sigma=0.03, \\Delta \\rho=300, D_m=1\\times 10^{-9}, \\rho=700$。\n- $Pe = \\frac{(1\\times 10^{-4})(5\\times 10^{-3})}{1\\times 10^{-9}} = 500.0$\n- $Ca = \\frac{(5\\times 10^{-3})(1\\times 10^{-4})}{0.03} \\approx 1.666... \\times 10^{-5}$\n- $Bo = \\frac{(300)(9.81)(5\\times 10^{-3})^2}{0.03} = 2.4525$\n- $Re = \\frac{(700)(1\\times 10^{-4})(5\\times 10^{-3})}{5\\times 10^{-3}} = 0.07$\n- 分类：$A=1$ ($Pe > 10$)，$F=1$ ($Bo > 1$)，$V=0$ ($Re \\le 1$)。\n\n**案例4：** $U=1\\times 10^{-1}$, $d=2\\times 10^{-3}, \\mu=1\\times 10^{-3}, \\sigma=0.025, \\Delta \\rho=200, D_m=1\\times 10^{-9}, \\rho=800$。\n- $Pe = \\frac{(1\\times 10^{-1})(2\\times 10^{-3})}{1\\times 10^{-9}} = 200000.0$\n- $Ca = \\frac{(1\\times 10^{-3})(1\\times 10^{-1})}{0.025} = 0.004$\n- $Bo = \\frac{(200)(9.81)(2\\times 10^{-3})^2}{0.025} = 0.31392$\n- $Re = \\frac{(800)(1\\times 10^{-1})(2\\times 10^{-3})}{1\\times 10^{-3}} = 160.0$\n- 分类：$A=1$ ($Pe > 10$)，$F=0$ ($Bo  1$)，$V=2$ ($Re > 100$)。\n\n**案例5：** $U=1.4285714285714285\\times 10^{-1}$, $d=0.5\\times 10^{-3}, \\mu=5\\times 10^{-3}, \\sigma=0.03, \\Delta \\rho=300, D_m=1\\times 10^{-9}, \\rho=700$。注意 $U \\approx 1/7$。\n- $Pe = \\frac{(1/7)(0.5\\times 10^{-3})}{1\\times 10^{-9}} \\approx 71428.571...$\n- $Ca = \\frac{(5\\times 10^{-3})(1/7)}{0.03} \\approx 0.023809...$\n- $Bo = \\frac{(300)(9.81)(0.5\\times 10^{-3})^2}{0.03} = 0.024525$\n- $Re = \\frac{(700)(1/7)(0.5\\times 10^{-3})}{5\\times 10^{-3}} = 10.0$\n- 分类：$A=1$ ($Pe > 10$)，$F=0$ ($Bo  1$)，$V=1$ ($1  Re \\le 100$)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates dimensionless numbers (Pe, Ca, Bo, Re) for NAPL transport\n    and classifies the transport regime for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (U, d, mu, sigma, delta_rho, D_m, rho)\n    test_cases = [\n        (1e-5, 0.5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n        (2e-6, 0.5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n        (1e-4, 5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n        (1e-1, 2e-3, 1e-3, 0.025, 200, 1e-9, 800),\n        (1.4285714285714285e-1, 0.5e-3, 5e-3, 0.03, 300, 1e-9, 700),\n    ]\n\n    g = 9.81  # Gravitational acceleration in m/s^2\n    \n    # Store the string representation of each case's result list\n    all_results_str = []\n\n    for case in test_cases:\n        U, d, mu, sigma, delta_rho, D_m, rho = case\n\n        # Calculate dimensionless numbers\n        Pe = (U * d) / D_m\n        Ca = (mu * U) / sigma\n        Bo = (delta_rho * g * d**2) / sigma\n        Re = (rho * U * d) / mu\n\n        # Classify advection-diffusion regime (A)\n        if Pe  1:\n            A = 0\n        elif Pe > 10:\n            A = 1\n        else:\n            A = 2\n\n        # Classify gravity-capillarity dominance (F)\n        if Bo  1:\n            F = 0\n        else:\n            F = 1\n\n        # Classify flow regime (V)\n        if Re = 1:\n            V = 0\n        elif 1  Re = 100:\n            V = 1\n        else:\n            V = 2\n\n        # Format the result list for the current case as a string\n        # Floats are formatted to exactly nine decimal places.\n        case_str = (\n            f\"[{Pe:.9f},{Ca:.9f},{Bo:.9f},\"\n            f\"{Re:.9f},{A},{F},{V}]\"\n        )\n        all_results_str.append(case_str)\n\n    # Final print statement in the exact required format.\n    # Join the individual result strings with commas and enclose in brackets.\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在理解了主导力的平衡之后，我们现在将注意力转向多相流体系统，其中流体间的界面至关重要。毛细管压力 $p_c$ 是跨越该界面的压力差，而润湿性是控制其行为的关键属性。这项练习  提供了一种具体、量化的方式来理解润湿性如何显著改变毛细作用力，并因此影响流体在多孔介质中的分布。",
            "id": "3927058",
            "problem": "一个均质的多孔砂岩被水和一种非水相液体（NAPL）饱和。考虑两个除润湿性外完全相同的岩心样品，其润湿性通过水相测量的Young–Dupré接触角来量化：样品 $1$ 的接触角为 $\\theta_1 = 20^\\circ$（亲水），样品 $2$ 的接触角为 $\\theta_2 = 100^\\circ$（亲NAPL）。两个样品都具有相同的固有渗透率 $k = 1.0 \\times 10^{-12}\\ \\text{m}^2$，并且处于相同的含水饱和度 $S_w$下，此时Leverett无量纲毛细管函数 $J(S_w)$ 的值为 $J(S_w) = 0.60$。水-NAPL的界面张力为 $\\sigma = 0.035\\ \\text{N m}^{-1}$。角度以度为单位测量。\n\n从一个基于物理基础的出发点，该基础包括弯曲界面上毛细管压力的拉普拉斯定律以及将代表性孔隙尺寸与渗透率联系起来的几何标度，推导宏观毛细管压力 $p_c$ 对 $\\sigma$、$\\theta$、$k$ 和 $J(S_w)$ 的函数依赖关系，并用它计算在指定的 $J(S_w)$ 下两个样品之间的差异 $\\Delta p_c = p_{c,1} - p_{c,2}$。将您的数值答案四舍五入到四位有效数字，并以千帕（kPa）表示最终结果。然后，定性地解释 $\\Delta p_c$ 的符号和大小如何反映在其他粘性驱动条件相同的情况下，两种润湿性状态之间驱替效率的差异。",
            "solution": "在尝试求解之前，将对问题进行验证。\n\n### 第1步：提取给定条件\n- 多孔介质：均质砂岩\n- 流体：水和非水相液体（NAPL）\n- 样品1：亲水，接触角为 $\\theta_1 = 20^\\circ$（通过水相测量）\n- 样品2：亲NAPL，接触角为 $\\theta_2 = 100^\\circ$（通过水相测量）\n- 两个样品的固有渗透率：$k = 1.0 \\times 10^{-12}\\ \\text{m}^2$\n- 两个样品的含水饱和度：$S_w$\n- 在 $S_w$ 下的Leverett无量纲毛细管函数值：$J(S_w) = 0.60$\n- 水-NAPL界面张力：$\\sigma = 0.035\\ \\text{N m}^{-1}$\n\n### 第2步：使用提取的给定条件进行验证\n该问题具有科学依据，提法恰当且客观。\n- **科学依据**：该问题基于多孔介质中两相流的基本原理，特别是毛细管压力、润湿性、渗透率和Leverett J函数的概念，这些在水文地质学、石油工程和环境工程中都是标准概念。所提供的值在物理上是现实的。\n- **提法恰当**：该问题提供了推导所要求的关系并计算所需值的所有必要数据。关键在于解释Leverett J函数的定义。问题指出，对于仅在润湿性上有所不同的两个样品，$J(S_w)$ 的值是相同的。这隐含地要求使用一个与接触角无关的J函数定义，从而将润湿性的影响归一化。这种解释使得问题自洽且唯一可解。\n- **客观性**：该问题以精确、定量的术语陈述，没有主观性或歧义。\n\n该问题被认为是有效的。\n\n### 第3步：结论和行动\n该问题有效。将提供解答。\n\n### 毛细管压力函数依赖关系的推导\n\n宏观毛细管压力 $p_c$ 定义为非水相（NAPL）和水相（水）之间的压力差：\n$$\np_c = p_{NAPL} - p_{water}\n$$\n在单个孔隙的微观尺度上，将其建模为毛细管，该压力差由杨-拉普拉斯方程描述：\n$$\np_c = \\frac{2\\sigma}{r_{int}}\n$$\n其中 $\\sigma$ 是界面张力，$r_{int}$ 是两种流体之间弯曲液面的曲率半径。曲率半径通过几何关系与代表性孔隙半径 $r_p$ 和接触角 $\\theta$ 相关联：\n$$\nr_{int} = \\frac{r_p}{\\cos\\theta}\n$$\n接触角 $\\theta$ 被指定为通过水相测量。将其代入杨-拉普拉斯方程得到：\n$$\np_c = \\frac{2\\sigma\\cos\\theta}{r_p}\n$$\n该方程描述了单个孔隙中的毛细管压力。为了将其提升到多孔介质的宏观尺度，我们必须将微观孔隙半径 $r_p$ 与宏观属性联系起来。固有渗透率 $k$ 的单位是面积（$L^2$），为孔隙空间提供了一个特征长度尺度 $\\sqrt{k}$。因此，我们可以假定代表性孔隙半径与该长度尺度成正比，$r_p \\propto \\sqrt{k}$。宏观毛细管压力则按以下方式缩放：\n$$\np_c \\propto \\frac{\\sigma\\cos\\theta}{\\sqrt{k}}\n$$\n对饱和度 $S_w$ 的依赖性，反映了在给定饱和度下被填充的孔隙尺寸分布，由一个无量纲函数，即Leverett J函数 $J(S_w)$ 来捕捉。将此函数作为无量纲比例因子并入，我们得到函数关系：\n$$\np_c(S_w) = J(S_w)\\frac{\\sigma\\cos\\theta}{\\sqrt{k}}\n$$\n该公式与问题陈述一致，因为它定义了一个仅依赖于孔隙几何形状和饱和度，而不依赖于流体性质（$\\sigma$）或润湿性（$\\theta$）的 $J(S_w)$，这解释了为什么在相同的 $S_w$ 下，两个样品的值是相同的。来自简单毛细管模型的因子 $2$ 被吸收到经验确定的 $J(S_w)$ 函数中。\n\n### 毛细管压力差的计算\n\n我们现在可以使用推导出的公式来计算每个样品的毛细管压力。\n\n对于样品1（亲水）：\n- $\\theta_1 = 20^\\circ$\n- 毛细管压力 $p_{c,1}$ 为：\n$$\np_{c,1} = J(S_w)\\frac{\\sigma\\cos\\theta_1}{\\sqrt{k}}\n$$\n预期值为正，因为 $\\theta_1  90^\\circ$，所以 $\\cos\\theta_1 > 0$。这表明 $p_{NAPL} > p_{water}$，这对于亲水介质中的非润湿流体（NAPL）是正确的。\n\n对于样品2（亲NAPL）：\n- $\\theta_2 = 100^\\circ$\n- 毛细管压力 $p_{c,2}$ 为：\n$$\np_{c,2} = J(S_w)\\frac{\\sigma\\cos\\theta_2}{\\sqrt{k}}\n$$\n预期值为负，因为 $\\theta_2 > 90^\\circ$，所以 $\\cos\\theta_2  0$。这表明 $p_{NAPL}  p_{water}$，这是正确的，因为NAPL现在是润湿相，毛细管力会倾向于将其吸入孔隙，这意味着水（现在是非润湿相）必须处于更高的压力下才能维持平衡。\n\n毛细管压力的差值 $\\Delta p_c$ 为：\n$$\n\\Delta p_c = p_{c,1} - p_{c,2} = J(S_w)\\frac{\\sigma\\cos\\theta_1}{\\sqrt{k}} - J(S_w)\\frac{\\sigma\\cos\\theta_2}{\\sqrt{k}}\n$$\n$$\n\\Delta p_c = J(S_w)\\frac{\\sigma}{\\sqrt{k}}(\\cos\\theta_1 - \\cos\\theta_2)\n$$\n代入给定值：\n- $J(S_w) = 0.60$\n- $\\sigma = 0.035\\ \\text{N m}^{-1}$\n- $k = 1.0 \\times 10^{-12}\\ \\text{m}^2 \\implies \\sqrt{k} = 1.0 \\times 10^{-6}\\ \\text{m}$\n- $\\theta_1 = 20^\\circ \\implies \\cos(20^\\circ) \\approx 0.9396926$\n- $\\theta_2 = 100^\\circ \\implies \\cos(100^\\circ) \\approx -0.1736482$\n$$\n\\Delta p_c = 0.60 \\times \\frac{0.035\\ \\text{N m}^{-1}}{1.0 \\times 10^{-6}\\ \\text{m}} \\times (\\cos(20^\\circ) - \\cos(100^\\circ))\n$$\n$$\n\\Delta p_c = (0.60 \\times 35000\\ \\text{Pa}) \\times (0.9396926 - (-0.1736482))\n$$\n$$\n\\Delta p_c = 21000\\ \\text{Pa} \\times (1.1133408)\n$$\n$$\n\\Delta p_c = 23380.1568\\ \\text{Pa}\n$$\n问题要求答案以千帕（kPa）为单位，并四舍五入到四位有效数字。\n$$\n\\Delta p_c = 23.3801568\\ \\text{kPa} \\approx 23.38\\ \\text{kPa}\n$$\n\n### 定性解释\n\n$\\Delta p_c$ 的符号为正，意味着 $p_{c,1} > p_{c,2}$。\n- $p_{c,1}$ 是一个大的正值（$p_{c,1} \\approx 19.73\\ \\text{kPa}$）。这代表了一个显著的毛细管屏障，在亲水样品1中，NAPL压力必须克服这个屏障才能驱替水。高的毛细管阻力阻碍了非润湿相（NAPL）进入孔隙。\n- $p_{c,2}$ 是一个负值（$p_{c,2} \\approx -3.65\\ \\text{kPa}$）。这表明在亲NAPL的样品2中，毛细管力有利于NAPL进入孔隙。NAPL作为润湿相，会自发地吸入多孔介质，有效地产生吸力。\n\n关于在相同粘性驱动（即相同的施加压力梯度）下的驱替效率：\n- 在亲水系统（样品1）中，施加的压力必须克服粘性阻力和强大的毛细管阻力（$p_{c,1} > 0$）。这导致了一个低效的驱替过程。NAPL倾向于通过最大、阻力最低的通道发生指进，绕过大量被毛细管力保持在较小孔隙中的水。这导致了低的驱替效率和高的残余水饱和度。\n- 在亲NAPL系统（样品2）中，毛细管力（$p_{c,2}  0$）有助于驱替过程。NAPL的自发渗吸帮助它侵入更广泛范围的孔隙尺寸，从而形成更稳定的活塞式驱替前缘。这导致在相同的粘性能量消耗下，驱替效率更高，残余水饱和度更低。\n\n$\\Delta p_c \\approx 23.38\\ \\text{kPa}$ 的巨大数值量化了两种润湿性状态之间毛细管屏障的显著差异。它代表了与亲NAPL系统相比，在亲水系统中用NAPL侵入以达到相同含水饱和度 $S_w$ 所需的额外压头。这直接转化为亲水情况下显著降低的驱替效率。",
            "answer": "$$\\boxed{23.38}$$"
        },
        {
            "introduction": "基于流体性质和多相相互作用的概念，我们现在进入一个动态情景：一种流体驱替另一种流体。Buckley-Leverett 理论是预测这种驱替前缘运移的基础模型。这项练习  将指导您计算前缘的移动速度和组分构成，这是地下水修复和提高石油采收率等应用建模中的一项关键技能。",
            "id": "3926990",
            "problem": "一个水平、均质的一维多孔介质柱，初始时被非水相液体 (NAPL) 和原生水饱和。在入口处注入水以恒定的总达西通量驱替 NAPL。假设为不混溶、不可压缩的两相流，忽略重力，且孔隙度恒定。相对渗透率遵循带有残余饱和度的 Corey 型关系。具体来说，设水饱和度为 $S_w$，残余（原生）水饱和度为 $S_{wr} = 0.20$，残余 NAPL 饱和度为 $S_{or} = 0.15$。定义有效水饱和度 $S_{we} = \\dfrac{S_w - S_{wr}}{1 - S_{wr} - S_{or}}$。相对渗透率为 $k_{rw} = k_{rw0}\\, S_{we}^{n_w}$ 和 $k_{rn} = k_{rn0}\\, (1 - S_{we})^{n_n}$，其中 $k_{rw0} = 0.70$，$k_{rn0} = 0.80$，$n_w = 3$，$n_n = 2$。水的粘度为 $\\mu_w = 1.0\\,\\mathrm{cP}$，NAPL 的粘度为 $\\mu_n = 5.0\\,\\mathrm{cP}$。孔隙度为 $\\phi = 0.30$。恒定的总达西通量为 $u_t = 0.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$。初始水饱和度均匀为 $S_w(x,0) = S_{wr}$，入口处注入的水饱和度为 $S_{w,\\mathrm{inj}} = 1 - S_{or}$。\n\n从水相质量守恒、各相的达西定律以及由相流度构建的水相分流量 $f_w(S_w)$ 的定义出发，推导前缘激波条件，并确定水驱替 NAPL 过程中的激波水饱和度 $S_{ws}$。然后，计算无粘性情况（无毛细管扩散）下的激波（前缘）速度 $v_f$。接下来，考虑一个包含毛细管压力效应的模型，该模型会产生饱和度方程的毛细管扩散正则化，形式如下\n$$\n\\phi\\,\\frac{\\partial S_w}{\\partial t} + u_t\\,\\frac{\\partial f_w(S_w)}{\\partial x} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(D_c(S_w)\\,\\frac{\\partial S_w}{\\partial x}\\right),\n$$\n其中 $D_c(S_w)  0$ 且足够小但不为零。在相同的边界和初始条件下，评估所选的前缘速度相对于无粘性情况是否发生变化。\n\n选择唯一一个正确给出 $S_{ws}$ 的数值、$v_f$ 的数值以及关于毛细管扩散情况的正确比较陈述的选项。\n\n- A. $S_{ws} \\approx 0.576$，$v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且当两端状态固定时，增加毛细管扩散不会改变所选的前缘速度；它只会使前缘变得平滑。\n- B. $S_{ws} \\approx 0.578$（直接解释为有效饱和度），$v_f \\approx 0.477\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散会减慢前缘。\n- C. $S_{ws} \\approx 0.650$，$v_f \\approx 0.513\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散会按与增加的扩散通量成比例地降低速度。\n- D. $S_{ws} \\approx 0.576$，$v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，但毛细管扩散会增加前缘速度，因为扩散作用叠加在平流作用之上。\n- E. $S_{ws} \\approx 0.700$，$v_f \\approx 1.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散不影响速度。",
            "solution": "问题陈述经评估是科学合理的、适定的、客观的且自洽的。分析 Buckley-Leverett 框架下的两相不混溶流所需的所有参数均已提供。因此，该问题是**有效的**。\n\n求解过程分为三部分：首先，推导激波水饱和度 ($S_{ws}$)；其次，计算激波前缘速度 ($v_f$)；第三，分析毛细管扩散对前缘速度的影响。\n\n**第一部分：确定激波水饱和度 ($S_{ws}$)**\n\n该流动由一维不混溶两相流的 Buckley-Leverett 理论控制。假设没有重力且没有毛细管压力（无粘性情况），控制水饱和度 $S_w$ 的方程是一个守恒定律：\n$$\n\\phi\\,\\frac{\\partial S_w}{\\partial t} + u_t\\,\\frac{\\partial f_w(S_w)}{\\partial x} = 0\n$$\n其中 $\\phi$ 是孔隙度，$u_t$ 是恒定的总达西通量，$f_w(S_w)$ 是水的分流量。分流量函数定义为：\n$$\nf_w(S_w) = \\frac{u_w}{u_t} = \\frac{\\lambda_w}{\\lambda_w + \\lambda_n} = \\frac{k_{rw}/\\mu_w}{k_{rw}/\\mu_w + k_{rn}/\\mu_n} = \\frac{1}{1 + \\frac{\\mu_w}{\\mu_n}\\frac{k_{rn}}{k_{rw}}}\n$$\n这里，$\\lambda_w$ 和 $\\lambda_n$ 分别是水和 NAPL 的流度；$k_{rw}$ 和 $k_{rn}$ 是相对渗透率；$\\mu_w$ 和 $\\mu_n$ 是动力粘度。\n\n问题提供了作为有效水饱和度 $S_{we}$ 函数的 Corey 型相对渗透率：\n$$\nS_{we} = \\frac{S_w - S_{wr}}{1 - S_{wr} - S_{or}}\n$$\n$$\nk_{rw} = k_{rw0}\\, S_{we}^{n_w} \\quad \\text{和} \\quad k_{rn} = k_{rn0}\\, (1 - S_{we})^{n_n}\n$$\n给定的参数是：\n- 残余水饱和度，$S_{wr} = 0.20$\n- 残余 NAPL 饱和度，$S_{or} = 0.15$\n- 水相相对渗透率参数：$k_{rw0} = 0.70$，$n_w = 3$\n- NAPL 相对渗透率参数：$k_{rn0} = 0.80$，$n_n = 2$\n- 水粘度，$\\mu_w = 1.0\\,\\mathrm{cP}$\n- NAPL 粘度，$\\mu_n = 5.0\\,\\mathrm{cP}$\n\n可动饱和度范围是 $1 - S_{wr} - S_{or} = 1 - 0.20 - 0.15 = 0.65$。有效饱和度是 $S_{we} = (S_w - 0.20) / 0.65$。粘度比是 $M = \\mu_n/\\mu_w = 5.0/1.0 = 5.0$。\n\n分流量函数变为：\n$$\nf_w(S_{we}) = \\frac{1}{1 + \\frac{1}{M} \\frac{k_{rn0}\\,(1-S_{we})^{n_n}}{k_{rw0}\\,S_{we}^{n_w}}} = \\frac{1}{1 + \\frac{1}{5.0} \\frac{0.80\\,(1-S_{we})^2}{0.70\\,S_{we}^3}} = \\frac{1}{1 + \\frac{8}{35} \\frac{(1-S_{we})^2}{S_{we}^3}}\n$$\n我们定义一个常数 $C = \\frac{k_{rn0}}{M k_{rw0}} = \\frac{0.80}{5.0 \\cdot 0.70} = \\frac{8}{35}$。分流量函数可以重写为：\n$$\nf_w(S_{we}) = \\frac{S_{we}^3}{S_{we}^3 + C(1-S_{we})^2}\n$$\n该问题描述了注入水驱替原生水（初始饱和度 $S_w(x,0) = S_{wr}$）的过程。这是一个黎曼问题 (Riemann problem)。由于典型分流量曲线的 S 形特征，会形成一个激波前缘。该激波连接了初始下游饱和度 $S_w^- = S_{wr}$ 和一个上游饱和度，即激波饱和度 $S_{ws}$。$S_{ws}$ 的值可以通过 Welge 图解法找到，该方法指出，从初始点 $(S_w^-, f_w(S_w^-))$ 到激波点 $(S_{ws}, f_w(S_{ws}))$ 的弦线斜率必须等于分流量曲线在 $S_{ws}$ 处的切线斜率。\n$$\n\\frac{f_w(S_{ws}) - f_w(S_w^-)}{S_{ws} - S_w^-} = \\frac{df_w}{dS_w}\\bigg|_{S_{ws}}\n$$\n初始饱和度为 $S_w^- = S_{wr}$，对应于 $S_{we}^- = 0$。在这一点，$k_{rw}(0) = 0$，所以 $f_w(S_{wr}) = 0$。该条件简化为：\n$$\n\\frac{f_w(S_{ws})}{S_{ws} - S_{wr}} = \\frac{df_w}{dS_w}\\bigg|_{S_{ws}}\n$$\n使用链式法则，$\\frac{df_w}{dS_w} = \\frac{df_w}{dS_{we}} \\frac{dS_{we}}{dS_w} = \\frac{df_w}{dS_{we}} \\frac{1}{1-S_{wr}-S_{or}}$。此外，$S_{ws} - S_{wr} = S_{wes}(1-S_{wr}-S_{or})$，其中 $S_{wes}$ 是有效激波饱和度。该条件变为：\n$$\n\\frac{f_w(S_{wes})}{S_{wes}(1-S_{wr}-S_{or})} = \\frac{1}{1-S_{wr}-S_{or}}\\frac{df_w}{dS_{we}}\\bigg|_{S_{wes}} \\implies \\frac{f_w(S_{wes})}{S_{wes}} = \\frac{df_w}{dS_{we}}\\bigg|_{S_{wes}}\n$$\n我们计算 $f_w(S_{we})$ 的导数：\n$$\n\\frac{df_w}{dS_{we}} = \\frac{d}{dS_{we}}\\left( \\frac{S_{we}^3}{S_{we}^3 + C(1-S_{we})^2} \\right) = \\frac{C S_{we}^2 (1-S_{we}) (3-S_{we})}{(S_{we}^3 + C(1-S_{we})^2)^2}\n$$\n应用切线条件 $\\frac{df_w}{dS_{we}} = \\frac{f_w}{S_{we}}$：\n$$\n\\frac{C S_{wes}^2 (1-S_{wes}) (3-S_{wes})}{(S_{wes}^3 + C(1-S_{wes})^2)^2} = \\frac{S_{wes}^3 / (S_{wes}^3 + C(1-S_{wes})^2)}{S_{wes}}\n$$\n对于 $S_{wes} \\in (0,1)$ 进行简化，得到：\n$$\nC(1-S_{wes})(3-S_{wes}) = S_{wes}^3 + C(1-S_{wes})^2\n$$\n$$\nC(3 - 4S_{wes} + S_{wes}^2) = S_{wes}^3 + C(1 - 2S_{wes} + S_{wes}^2)\n$$\n$$\n3C - 4CS_{wes} = S_{wes}^3 + C - 2CS_{wes} \\implies S_{wes}^3 + 2CS_{wes} - 2C = 0\n$$\n代入 $C = 8/35$：\n$$\nS_{wes}^3 + \\frac{16}{35}S_{wes} - \\frac{16}{35} = 0\n$$\n对此三次方程进行数值求解，得到在 $(0,1)$ 区间内的根为 $S_{wes} \\approx 0.57775$。\n现在，我们将此有效饱和度转换回总水饱和度 $S_{ws}$：\n$$\nS_{ws} = S_{wr} + S_{wes}(1 - S_{wr} - S_{or}) = 0.20 + 0.57775 \\times 0.65 = 0.20 + 0.3755375\n$$\n$$\nS_{ws} \\approx 0.5755 \\approx 0.576\n$$\n\n**第二部分：计算激波前缘速度 ($v_f$)**\n\n饱和度间断（激波）的速度由 Rankine-Hugoniot 条件给出，该条件表示跨越前缘的宏观质量平衡。激波速度 $v_f$ 是一个物理速度（不是达西通量），由下式给出：\n$$\nv_f = \\frac{u_t}{\\phi} \\frac{\\Delta f_w}{\\Delta S_w} = \\frac{u_t}{\\phi} \\frac{f_w(S_{ws}) - f_w(S_w^-)}{S_{ws} - S_w^-}\n$$\n由于 $f_w(S_w^-) = f_w(S_{wr}) = 0$，上式变为：\n$$\nv_f = \\frac{u_t}{\\phi} \\frac{f_w(S_{ws})}{S_{ws} - S_{wr}} = \\frac{u_t}{\\phi} \\frac{f_w(S_{wes})}{S_{wes}(1-S_{wr}-S_{or})}\n$$\n根据第一部分推导的切线条件，我们知道 $S_{wes}^3 = 2C(1-S_{wes})$。我们可以用它来简化 $f_w(S_{wes})$ 的表达式：\n$$\nf_w(S_{wes}) = \\frac{S_{wes}^3}{S_{wes}^3 + C(1-S_{wes})^2} = \\frac{2C(1-S_{wes})}{2C(1-S_{wes}) + C(1-S_{wes})^2} = \\frac{2}{2 + (1-S_{wes})} = \\frac{2}{3-S_{wes}}\n$$\n使用 $S_{wes} \\approx 0.57775$：\n$$\nf_w(S_{wes}) \\approx \\frac{2}{3 - 0.57775} = \\frac{2}{2.42225} \\approx 0.82568\n$$\n现在我们可以使用给定的值 $u_t = 0.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$ 和 $\\phi = 0.30$ 来计算前缘速度 $v_f$：\n$$\nv_f = \\frac{0.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}}{0.30} \\frac{f_w(S_{ws})}{S_{ws} - 0.20} = \\frac{1}{3} \\frac{0.82568}{0.57554 - 0.20} = \\frac{1}{3} \\frac{0.82568}{0.37554} \\approx \\frac{1}{3} \\times 2.1986\n$$\n$$\nv_f \\approx 0.73287\\,\\mathrm{m}\\,\\mathrm{d}^{-1} \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}\n$$\n\n**第三部分：毛细管扩散的影响**\n\n问题引入了一个毛细管扩散项，将控制方程修改为：\n$$\n\\phi\\,\\frac{\\partial S_w}{\\partial t} + u_t\\,\\frac{\\partial f_w(S_w)}{\\partial x} \\;=\\; \\frac{\\partial}{\\partial x}\\!\\left(D_c(S_w)\\,\\frac{\\partial S_w}{\\partial x}\\right)\n$$\n这是一个抛物线型的平流-扩散方程。无粘性解中的激波被一个光滑的行波解 $S_w(x,t) = S_w(\\xi)$（其中 $\\xi = x - v_f t$）所替代。此波的速度 $v_f$ 是通过对波剖面从上游 ($-\\infty$) 到下游 ($+\\infty$) 积分方程来确定的，在这些区域饱和度剖面是平坦的，连接着状态 $S_w^+$ 和 $S_w^-$。\n将方程对 $x$ 从 $-\\infty$ 到 $+\\infty$ 积分，并应用微积分基本定理，我们得到：\n$$\n\\frac{d}{dt} \\int_{-\\infty}^{\\infty} \\phi S_w dx + u_t \\int_{-\\infty}^{\\infty} \\frac{\\partial f_w}{\\partial x} dx = \\int_{-\\infty}^{\\infty} \\frac{\\partial}{\\partial x}\\!\\left(D_c\\,\\frac{\\partial S_w}{\\partial x}\\right) dx\n$$\n空间导数在无限域上的积分等于函数在边界处的值的差。设上游和下游状态分别为 $S_w^+$ 和 $S_w^-$。\n$$\n\\frac{d}{dt} (\\text{总水量}) + u_t [f_w(S_w^+) - f_w(S_w^-)] = \\left[ D_c \\frac{\\partial S_w}{\\partial x} \\right]_{-\\infty}^{+\\infty}\n$$\n由于饱和度剖面在远离前缘处是平坦的，当 $x \\to \\pm\\infty$ 时 $\\frac{\\partial S_w}{\\partial x} \\to 0$。因此，毛细管扩散项对全局质量平衡的贡献为零。最终的速度由与无粘性情况相同的 Rankine-Hugoniot 跳跃条件确定。\n$$\nv_f = \\frac{u_t}{\\phi} \\frac{f_w(S_w^+) - f_w(S_w^-)}{S_w^+ - S_w^-}\n$$\n对于前缘激波，连接的状态是 $S_w^- = S_{wr}$ 和 $S_w^+ = S_{ws}$。因此，前缘的速度不受毛细管扩散项存在的影响。该项的作用是使解正则化，用一个物理上真实、狭窄但光滑的过渡区取代数学上的不连续性（激波）。\n\n**逐项分析**\n\n- **A. $S_{ws} \\approx 0.576$，$v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且当两端状态固定时，增加毛细管扩散不会改变所选的前缘速度；它只会使前缘变得平滑。**\n  - $S_{ws} \\approx 0.576$：这与我们的计算相符。**正确**。\n  - $v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$：这与我们的计算相符。**正确**。\n  - 毛细管扩散效应：速度不变且前缘平滑的推理与正则化守恒定律的行波理论一致。**正确**。\n  - 总体结论：**正确**。\n\n- **B. $S_{ws} \\approx 0.578$（直接解释为有效饱和度），$v_f \\approx 0.477\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散会减慢前缘。**\n  - $S_{ws} \\approx 0.578$：这在数值上是有效饱和度 $S_{wes}$ 的值，而不是总饱和度 $S_{ws}$ 的值。因此，该陈述本身在事实上是不正确的。**不正确**。\n  - $v_f \\approx 0.477\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$：我们计算出的值是 $\\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$。**不正确**。\n  - 毛细管扩散效应：其减慢前缘的说法是错误的。**不正确**。\n  - 总体结论：**不正确**。\n\n- **C. $S_{ws} \\approx 0.650$，$v_f \\approx 0.513\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散会按与增加的扩散通量成比例地降低速度。**\n  - $S_{ws} \\approx 0.650$：这是可动饱和度范围的大小，而不是激波饱和度。**不正确**。\n  - $v_f \\approx 0.513\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$：这与我们的计算不符。**不正确**。\n  - 毛细管扩散效应：推理存在缺陷。**不正确**。\n  - 总体结论：**不正确**。\n\n- **D. $S_{ws} \\approx 0.576$，$v_f \\approx 0.733\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，但毛细管扩散会增加前缘速度，因为扩散作用叠加在平流作用之上。**\n  - $S_{ws} \\approx 0.576$：**正确**。\n  - $v_f \\approx 0.733\\,\\mathrm{m}\\,\\d^{-1}$：**正确**。\n  - 毛细管扩散效应：其增加速度的说法是错误的。**不正确**。\n  - 总体结论：**不正确**。\n\n- **E. $S_{ws} \\approx 0.700$，$v_f \\approx 1.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$，并且毛细管扩散不影响速度。**\n  - $S_{ws} \\approx 0.700$：这与我们的计算不符。**不正确**。\n  - $v_f \\approx 1.10\\,\\mathrm{m}\\,\\mathrm{d}^{-1}$：这与我们的计算不符。**不正确**。\n  - 毛细管扩散效应：虽然“不影响速度”的说法是正确的，但数值是错误的，导致整个选项无效。**不正确**。\n\n基于详细分析，只有选项 A 同时提供了 $S_{ws}$ 和 $v_f$ 的正确数值，以及关于毛细管扩散作用的物理上正确的陈述。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}