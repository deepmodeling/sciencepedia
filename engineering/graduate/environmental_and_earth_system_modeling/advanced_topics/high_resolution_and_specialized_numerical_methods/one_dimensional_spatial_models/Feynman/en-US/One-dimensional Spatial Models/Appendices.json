{
    "hands_on_practices": [
        {
            "introduction": "Understanding how to construct an analytical solution to a foundational transport problem is the first step toward building more complex models. This exercise walks you through solving the one-dimensional steady-state diffusion equation with a constant internal source, a scenario common in geochemical and ecological systems. By deriving the exact concentration profile, you will gain a direct, physical intuition for how the curvature of the profile is directly controlled by the balance between the source/sink strength $S$ and the material's diffusivity $K$ .",
            "id": "3902380",
            "problem": "A researcher is modeling the steady-state, one-dimensional concentration profile of a dissolved constituent in a saturated soil column of length $L$ under purely diffusive transport and uniform internal production. Let $x \\in [0,L]$ denote depth measured from the top boundary. The concentration field is $c(x)$, the effective diffusivity is a constant $K0$, and the volumetric production rate is a spatially uniform constant $S$ (positive $S$ denotes net internal production). The diffusive flux is governed by Fick's first law $J(x) = -K\\,\\partial_x c(x)$, and local mass conservation is described by the continuity equation $\\partial_t c(x,t) + \\partial_x J(x,t) = S(x,t)$. At steady state, the governing equation reduces to $0 = \\partial_x\\!\\big(K\\,\\partial_x c(x)\\big) + S$ on the interval $[0,L]$, with Dirichlet boundary conditions $c(0)=c_{0}$ and $c(L)=c_{L}$, where $c_{0}$ and $c_{L}$ are prescribed constants.\n\nStarting only from these laws and definitions, derive the closed-form expression for the steady-state concentration $c(x)$ on $[0,L]$ for constant $K$ and uniform $S$ subject to the given boundary conditions. Then, determine the curvature $\\partial_{xx} c(x)$ and explain, in words, how its sign and magnitude relate to the sign and magnitude of $S$ and the value of $K$.\n\nReport your final answer as a single symbolic expression for $c(x)$ in terms of $x$, $L$, $K$, $S$, $c_{0}$, and $c_{L}$. Do not include units in your final answer.",
            "solution": "The problem statement is evaluated and determined to be valid. It is a well-posed, scientifically grounded boundary value problem derived from the fundamental principles of mass conservation and Fickian diffusion. The problem is self-contained, with all necessary parameters and conditions provided for a unique solution.\n\nThe starting point is the steady-state, one-dimensional reaction-diffusion equation provided:\n$$0 = \\partial_x\\!\\big(K\\,\\partial_x c(x)\\big) + S$$\nThe domain is $x \\in [0,L]$. The problem states that the effective diffusivity $K$ and the volumetric production rate $S$ are constants. Since $K$ is a constant, it can be factored out of the spatial derivative, yielding:\n$$K\\,\\partial_{xx} c(x) + S = 0$$\nwhere $\\partial_{xx} c(x)$ is the second derivative of $c(x)$ with respect to $x$. This is a second-order, linear, non-homogeneous ordinary differential equation. We can rearrange it to isolate the second derivative:\n$$\\partial_{xx} c(x) = -\\frac{S}{K}$$\nTo find the concentration profile $c(x)$, we integrate this equation twice with respect to $x$. The first integration gives the concentration gradient, $\\partial_x c(x)$:\n$$\\partial_x c(x) = \\int \\left(-\\frac{S}{K}\\right) dx = -\\frac{S}{K}x + A$$\nwhere $A$ is the first constant of integration. Integrating a second time yields the general solution for the concentration profile $c(x)$:\n$$c(x) = \\int \\left(-\\frac{S}{K}x + A\\right) dx = -\\frac{S}{2K}x^2 + Ax + B$$\nwhere $B$ is the second constant of integration.\n\nThe constants $A$ and $B$ are determined by applying the specified Dirichlet boundary conditions: $c(0) = c_0$ and $c(L) = c_L$.\n\nFirst, apply the condition at $x=0$:\n$$c(0) = c_0 = -\\frac{S}{2K}(0)^2 + A(0) + B$$\nThis immediately gives $B = c_0$. The solution becomes:\n$$c(x) = -\\frac{S}{2K}x^2 + Ax + c_0$$\nNext, apply the condition at $x=L$:\n$$c(L) = c_L = -\\frac{S}{2K}L^2 + AL + c_0$$\nWe now solve this equation for the constant $A$:\n$$AL = c_L - c_0 + \\frac{S}{2K}L^2$$\n$$A = \\frac{c_L - c_0}{L} + \\frac{SL}{2K}$$\nNow, we substitute the expressions for $A$ and $B$ back into the general solution for $c(x)$:\n$$c(x) = -\\frac{S}{2K}x^2 + \\left(\\frac{c_L - c_0}{L} + \\frac{SL}{2K}\\right)x + c_0$$\nFor clarity and interpretation, this expression can be rearranged. We can group the terms involving $S$:\n$$c(x) = c_0 + \\frac{c_L - c_0}{L}x + \\frac{SL}{2K}x - \\frac{S}{2K}x^2$$\nFactoring out common terms yields the final closed-form expression for the steady-state concentration profile:\n$$c(x) = c_0 + (c_L - c_0)\\frac{x}{L} + \\frac{S}{2K}(Lx - x^2)$$\nThis solution is physically interpretable as the superposition of a linear concentration profile (the solution for pure diffusion with $S=0$) and a parabolic profile resulting from the internal source/sink term $S$.\n\nThe second part of the problem asks for the curvature, $\\partial_{xx} c(x)$, and its interpretation. From our initial rearrangement of the governing equation, we have already found the curvature:\n$$\\partial_{xx} c(x) = -\\frac{S}{K}$$\nThe interpretation of this result is as follows:\n\nThe curvature of the concentration profile is constant throughout the domain and is determined by the ratio of the net production rate $S$ to the diffusivity $K$.\n\n1.  **Sign of Curvature**: The sign is determined by the sign of $-S$, since $K$ is strictly positive ($K0$).\n    -   If $S  0$ (net internal production), the curvature $\\partial_{xx} c(x)$ is negative. This means the concentration profile $c(x)$ is concave down (i.e., it \"bulges\" upward). Physically, this indicates that the concentration is being produced everywhere in the domain, causing it to increase in the interior relative to the boundary values. Diffusion then transports this excess constituent toward the boundaries, which act as relative sinks.\n    -   If $S  0$ (net internal consumption or sink), the curvature $\\partial_{xx} c(x)$ is positive. This means the concentration profile $c(x)$ is concave up (i.e., it \"sags\" downward). Physically, the constituent is being removed everywhere, causing the concentration to be depleted in the interior. Diffusion then drives a flux from the higher-concentration boundaries toward the interior to compensate for the loss.\n    -   If $S=0$ (no net production/sink), the curvature is zero, and the profile $c(x)$ is a straight line, representing a purely diffusive equilibrium between the two boundaries.\n\n2.  **Magnitude of Curvature**: The magnitude is $|\\partial_{xx} c(x)| = \\frac{|S|}{K}$.\n    -   The magnitude is directly proportional to the magnitude of the production/consumption rate, $|S|$. A larger $|S|$ means a stronger source or sink, which results in a more pronounced \"bulge\" or \"sag\" in the concentration profile, hence a larger magnitude of curvature.\n    -   The magnitude is inversely proportional to the diffusivity $K$. A lower diffusivity $K$ means that diffusive transport is less efficient at smoothing out concentration gradients. Therefore, for a given $S$, a lower $K$ will allow the concentration to build up (or be depleted) to a greater extent in the interior, resulting in a profile with a larger magnitude of curvature. Conversely, a very high diffusivity quickly homogenizes the constituent, leading to a profile that is nearly linear (curvature close to zero).",
            "answer": "$$\\boxed{c_0 + (c_L - c_0)\\frac{x}{L} + \\frac{S}{2K}(Lx - x^2)}$$"
        },
        {
            "introduction": "While analytical solutions provide exact insights, most real-world environmental models rely on numerical methods, which are approximations and can introduce their own non-physical behaviors. This practice uses Taylor series analysis to reveal the 'modified equation' that a first-order upwind scheme for advection actually solves, allowing you to derive the artificial 'numerical diffusion' term . Understanding this concept is critical for interpreting numerical model results and recognizing the trade-offs between computational simplicity and physical accuracy.",
            "id": "3902379",
            "problem": "Consider a one-dimensional conservative tracer $C(x,t)$ being advected with a constant velocity $u$ along a uniform channel, represented by the linear advection equation $\\partial C / \\partial t + u \\, \\partial C / \\partial x = 0$. The spatial domain is discretized on a uniform grid with spacing $\\Delta x$, and the spatial derivative is approximated using a first-order upwind finite difference (donor-cell) scheme, consistent with the sign of $u$. Treat the spatial discretization in a semi-discrete sense (method of lines), meaning that time remains continuous.\n\nStarting only from the continuous advection equation, the definition of the first-order upwind approximation to the spatial derivative, and standard Taylor series expansions for smooth $C(x,t)$, derive the leading-order modified partial differential equation that the semi-discrete upwind scheme solves. From this, identify and quantify the effective numerical diffusion coefficient $D_{\\text{num}}$ that arises due to the first-order upwind discretization in one dimension.\n\nExplain how $D_{\\text{num}}$ scales with the advective speed $u$ and the grid spacing $\\Delta x$, and justify the sign and magnitude of $D_{\\text{num}}$ based on your derivation.\n\nProvide your final result for $D_{\\text{num}}$ as a single closed-form analytic expression in terms of $u$ and $\\Delta x$.",
            "solution": "The problem requires the derivation of the effective numerical diffusion coefficient, $D_{\\text{num}}$, that arises from a first-order upwind spatial discretization of the one-dimensional linear advection equation. This will be accomplished using modified equation analysis, which involves replacing the discrete finite difference operators with their Taylor series expansions to reveal the partial differential equation that the numerical scheme actually solves.\n\nThe governing continuous equation for a conservative tracer $C(x,t)$ with constant advection velocity $u$ is given as:\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = 0\n$$\nThis equation can be rearranged to express the time evolution of $C$:\n$$\n\\frac{\\partial C}{\\partial t} = -u \\frac{\\partial C}{\\partial x}\n$$\nIn a semi-discrete (method of lines) approach, the spatial derivatives are discretized, but time remains continuous. Let the spatial domain be discretized into a uniform grid with points $x_j = j \\Delta x$, where $j$ is an integer index and $\\Delta x$ is the constant grid spacing. Let $C_j(t)$ denote the tracer concentration at grid point $x_j$ and time $t$, i.e., $C_j(t) \\equiv C(x_j, t)$.\n\nThe semi-discrete form of the advection equation is:\n$$\n\\frac{d C_j}{d t} = -u \\left( \\frac{\\partial C}{\\partial x} \\right)_{j}\n$$\nwhere $\\left( \\frac{\\partial C}{\\partial x} \\right)_{j}$ represents the finite difference approximation of the spatial derivative at grid point $j$. The problem specifies a first-order upwind (or donor-cell) scheme. The form of this scheme depends on the sign of the velocity $u$.\n\nCase 1: $u  0$\nFor a positive velocity, the flow is from left to right. The \"upwind\" or \"donor\" information comes from the cell at index $j-1$. The spatial derivative is approximated by a first-order backward difference:\n$$\n\\left( \\frac{\\partial C}{\\partial x} \\right)_{j} \\approx \\frac{C_j - C_{j-1}}{\\Delta x}\n$$\nSubstituting this into the semi-discrete equation gives the numerical scheme for $u0$:\n$$\n\\frac{d C_j}{d t} = -u \\frac{C_j(t) - C_{j-1}(t)}{\\Delta x}\n$$\nTo perform the modified equation analysis, we express the term $C_{j-1}(t)$ using a Taylor series expansion around the point $x_j$:\n$$\nC_{j-1}(t) = C(x_j - \\Delta x, t) = C(x_j, t) - \\Delta x \\frac{\\partial C}{\\partial x}\\bigg|_{j} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 C}{\\partial x^2}\\bigg|_{j} - \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 C}{\\partial x^3}\\bigg|_{j} + \\mathcal{O}((\\Delta x)^4)\n$$\nwhere all partial derivatives are evaluated at $(x_j, t)$. Substituting this expansion into the numerical scheme:\n$$\n\\frac{d C_j}{d t} = -u \\frac{1}{\\Delta x} \\left( C_j - \\left[ C_j - \\Delta x \\frac{\\partial C}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2} - \\mathcal{O}((\\Delta x)^3) \\right] \\right)\n$$\nSimplifying the expression inside the parentheses:\n$$\n\\frac{d C_j}{d t} = -u \\frac{1}{\\Delta x} \\left( \\Delta x \\frac{\\partial C}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}((\\Delta x)^3) \\right)\n$$\nDistributing the factor $-u/\\Delta x$:\n$$\n\\frac{d C_j}{d t} = -u \\frac{\\partial C}{\\partial x} + \\frac{u \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} - \\mathcal{O}((\\Delta x)^2)\n$$\nBy replacing the discrete notation $C_j(t)$ on the left-hand side with the continuous function $C(x,t)$ and its exact time derivative $\\frac{\\partial C}{\\partial t}$ at the point $(x_j, t)$, we obtain the modified partial differential equation that the scheme solves, up to the leading-order error term:\n$$\n\\frac{\\partial C}{\\partial t} = -u \\frac{\\partial C}{\\partial x} + \\frac{u \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2}\n$$\nRearranging this to match the structure of the original advection-diffusion equation:\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = \\frac{u \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2}\n$$\nThe original PDE had a zero on the right-hand side. The numerical scheme introduces an artificial second-derivative term, which is characteristic of a diffusion process. This term is known as the numerical diffusion or numerical dissipation term. By comparing this modified equation to the standard advection-diffusion equation, $\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^2 C}{\\partial x^2}$, we can identify the effective numerical diffusion coefficient for $u  0$ as:\n$$\nD_{\\text{num}} = \\frac{u \\Delta x}{2}\n$$\n\nCase 2: $u  0$\nFor a negative velocity, the flow is from right to left, and the \"upwind\" information comes from the cell at index $j+1$. The spatial derivative is approximated by a first-order forward difference:\n$$\n\\left( \\frac{\\partial C}{\\partial x} \\right)_{j} \\approx \\frac{C_{j+1} - C_j}{\\Delta x}\n$$\nThe numerical scheme for $u0$ is:\n$$\n\\frac{d C_j}{d t} = -u \\frac{C_{j+1}(t) - C_j(t)}{\\Delta x}\n$$\nThe Taylor series expansion for $C_{j+1}(t)$ around $x_j$ is:\n$$\nC_{j+1}(t) = C(x_j + \\Delta x, t) = C_j + \\Delta x \\frac{\\partial C}{\\partial x}\\bigg|_{j} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 C}{\\partial x^2}\\bigg|_{j} + \\mathcal{O}((\\Delta x)^3)\n$$\nSubstituting this into the scheme:\n$$\n\\frac{d C_j}{d t} = -u \\frac{1}{\\Delta x} \\left( \\left[ C_j + \\Delta x \\frac{\\partial C}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}((\\Delta x)^3) \\right] - C_j \\right)\n$$\nSimplifying gives:\n$$\n\\frac{d C_j}{d t} = -u \\left( \\frac{\\partial C}{\\partial x} + \\frac{\\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}((\\Delta x)^2) \\right)\n$$\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = -\\frac{u \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2}\n$$\nIn this case, the numerical diffusion coefficient is $D_{\\text{num}} = -\\frac{u \\Delta x}{2}$. Since $u$ is negative, $D_{\\text{num}}$ remains a positive quantity.\n\nGeneral Result:\nCombining both cases, the numerical diffusion coefficient for the first-order upwind scheme can be expressed using the absolute value of the velocity:\n$$\nD_{\\text{num}} = \\frac{|u| \\Delta x}{2}\n$$\nThe units of $D_{\\text{num}}$ are correctly given by the product of the units of velocity ($\\mathrm{m\\,s^{-1}}$) and grid spacing ($\\mathrm{m}$), resulting in $\\mathrm{m^2\\,s^{-1}}$, which are the units of a diffusion coefficient.\n\nJustification and Scaling:\nThe derived expression shows that the numerical diffusion $D_{\\text{num}}$ scales linearly with the magnitude of the advective speed, $|u|$, and the grid spacing, $\\Delta x$. This implies that numerical diffusion is more pronounced for faster flows and for coarser grid resolutions. To reduce this artificial diffusion, one must refine the grid (decrease $\\Delta x$).\nThe sign of $D_{\\text{num}}$ is always non-negative since $|u| \\geq 0$ and $\\Delta x  0$. This is crucial. A positive diffusion coefficient correctly represents a dissipative process, where concentration gradients are smoothed out, which is the observed behavior of the first-order upwind scheme. A negative coefficient would imply anti-diffusion, an unstable process where small perturbations would grow unboundedly, which is not characteristic of this scheme.\nThe magnitude $\\frac{|u| \\Delta x}{2}$ originates directly from the leading-order truncation error of the first-order finite difference approximation of the first derivative, $\\frac{\\partial C}{\\partial x}$. The error is of order $\\mathcal{O}(\\Delta x)$ and manifests as a second-derivative term in the modified equation, with a proportionality constant that includes the factor $\\frac{1}{2!}$ from the Taylor series expansion. This leading-order error term is what makes the scheme \"first-order\" accurate in space, and it is responsible for the scheme's diffusive nature.\nThe final closed-form expression for the numerical diffusion coefficient is therefore $\\frac{|u|\\Delta x}{2}$.",
            "answer": "$$\n\\boxed{\\frac{|u| \\Delta x}{2}}\n$$"
        },
        {
            "introduction": "After discovering that numerical schemes can introduce artifacts like numerical diffusion, a critical question arises: how can we be certain our code is solving the intended equations correctly? This exercise introduces the Method of Manufactured Solutions (MMS), a rigorous and indispensable technique for code verification in computational science. By forcing a chosen analytical function to be the solution, you will derive the necessary source term and learn the formal procedure for confirming that your code achieves its theoretical order of accuracy .",
            "id": "3902346",
            "problem": "A reactive tracer with concentration $u(x,t)$ in a one-dimensional spatial domain is governed by conservation of mass with advection, diffusion, and linear reaction. From the conservation principle, the rate of change of mass in a control volume equals the net flux into the volume plus sources and sinks. Modeling advective transport with a constant speed $c0$, Fickian diffusion with a constant diffusivity $\\kappa0$, and a linear first-order removal with rate $r \\ge 0$, the governing equation can be written as\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = \\kappa \\frac{\\partial^{2} u}{\\partial x^{2}} - r u + S(x,t),\n$$\nwhere $S(x,t)$ is an externally imposed source term. Using the Method of Manufactured Solutions (MMS), choose the manufactured solution\n$$\nu(x,t) = \\exp(\\sigma t)\\,\\sin(\\omega x) + \\exp(-2\\sigma t)\\,\\cos(2\\omega x),\n$$\nwith constants $\\sigma0$ and $\\omega0$, on the spatial domain $x \\in \\left[0,\\frac{2\\pi}{\\omega}\\right]$ with periodic boundary conditions and for $t \\ge 0$. \n\nTasks:\n- Derive the source term $S(x,t)$ that makes the given $u(x,t)$ satisfy the governing equation for arbitrary constants $c0$, $\\kappa0$, $r \\ge 0$, $\\sigma0$, and $\\omega0$.\n- Briefly describe, starting from the conservation law and definitions of error norms, how this manufactured solution and source can be used to verify the accuracy and observed order of a numerical code that discretizes the advection-diffusion-reaction equation.\n\nAnswer specification: Express $S(x,t)$ as a single closed-form analytic expression in terms of $x$, $t$, $c$, $\\kappa$, $r$, $\\sigma$, and $\\omega$. Do not provide numerical values and do not include any units in the final answer.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n### Step 1: Extract Givens\n- **Governing Equation:** The concentration $u(x,t)$ is governed by the one-dimensional advection-diffusion-reaction equation:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = \\kappa \\frac{\\partial^{2} u}{\\partial x^{2}} - r u + S(x,t)\n$$\n- **Manufactured Solution:** The prescribed solution form is:\n$$\nu(x,t) = \\exp(\\sigma t)\\,\\sin(\\omega x) + \\exp(-2\\sigma t)\\,\\cos(2\\omega x)\n$$\n- **Constants:** The constants are defined as $c0$, $\\kappa0$, $r \\ge 0$, $\\sigma0$, and $\\omega0$.\n- **Domain and Boundary Conditions:** The spatial domain is $x \\in \\left[0, \\frac{2\\pi}{\\omega}\\right]$ with periodic boundary conditions. The temporal domain is $t \\ge 0$.\n- **Tasks:**\n  1. Derive the source term $S(x,t)$ that satisfies the governing equation for the given $u(x,t)$.\n  2. Describe how this manufactured solution and source term can be used for numerical code verification, starting from the conservation law and error norms.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation against the established criteria.\n- **Scientifically Grounded:** The problem is based on the advection-diffusion-reaction equation, a fundamental and well-established model in physics, chemistry, and engineering. The Method of Manufactured Solutions (MMS) is a standard, rigorous technique for the verification of numerical codes. The problem is scientifically sound.\n- **Well-Posed:** The task is to determine the source term $S(x,t)$ that makes a given function $u(x,t)$ an exact solution to the PDE. This is a direct substitution and algebraic manipulation problem, not a problem of solving the PDE for an unknown $u(x,t)$. A unique expression for $S(x,t)$ is guaranteed to exist.\n- **Objective:** The problem is stated using precise, unambiguous mathematical language.\n- **Consistency and Completeness:** All required information (governing equation, manufactured solution, domain, constants) is provided. The manufactured solution's periodicity on the domain $x \\in \\left[0, \\frac{2\\pi}{\\omega}\\right]$ is readily verifiable. For $u(x,t)$, we have $u(0, t) = \\exp(-2\\sigma t)$ and $u(\\frac{2\\pi}{\\omega}, t) = \\exp(\\sigma t)\\sin(2\\pi) + \\exp(-2\\sigma t)\\cos(4\\pi) = \\exp(-2\\sigma t)$, confirming periodicity of the function value. The derivatives are likewise periodic. The problem is internally consistent and complete.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, objective, and self-consistent. It is deemed **valid**. A solution will be provided.\n\n### Derivation of the Source Term $S(x,t)$\n\nTo find the source term $S(x,t)$, we rearrange the governing equation to solve for $S(x,t)$:\n$$\nS(x,t) = \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} - \\kappa \\frac{\\partial^{2} u}{\\partial x^{2}} + r u\n$$\nWe must compute the partial derivatives of the manufactured solution $u(x,t) = \\exp(\\sigma t)\\,\\sin(\\omega x) + \\exp(-2\\sigma t)\\,\\cos(2\\omega x)$.\n\nThe partial derivative with respect to time $t$ is:\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\exp(\\sigma t)\\sin(\\omega x) + \\exp(-2\\sigma t)\\cos(2\\omega x) \\right] = \\sigma \\exp(\\sigma t)\\sin(\\omega x) - 2\\sigma \\exp(-2\\sigma t)\\cos(2\\omega x)\n$$\n\nThe first partial derivative with respect to space $x$ is:\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\exp(\\sigma t)\\sin(\\omega x) + \\exp(-2\\sigma t)\\cos(2\\omega x) \\right] = \\omega \\exp(\\sigma t)\\cos(\\omega x) - 2\\omega \\exp(-2\\sigma t)\\sin(2\\omega x)\n$$\n\nThe second partial derivative with respect to space $x$ is:\n$$\n\\frac{\\partial^{2} u}{\\partial x^{2}} = \\frac{\\partial}{\\partial x} \\left[ \\omega \\exp(\\sigma t)\\cos(\\omega x) - 2\\omega \\exp(-2\\sigma t)\\sin(2\\omega x) \\right] = -\\omega^{2} \\exp(\\sigma t)\\sin(\\omega x) - 4\\omega^{2} \\exp(-2\\sigma t)\\cos(2\\omega x)\n$$\n\nNow, we substitute these derivatives into the expression for $S(x,t)$:\n$$\nS(x,t) = \\left( \\sigma \\exp(\\sigma t)\\sin(\\omega x) - 2\\sigma \\exp(-2\\sigma t)\\cos(2\\omega x) \\right) + c \\left( \\omega \\exp(\\sigma t)\\cos(\\omega x) - 2\\omega \\exp(-2\\sigma t)\\sin(2\\omega x) \\right) - \\kappa \\left( -\\omega^{2} \\exp(\\sigma t)\\sin(\\omega x) - 4\\omega^{2} \\exp(-2\\sigma t)\\cos(2\\omega x) \\right) + r \\left( \\exp(\\sigma t)\\sin(\\omega x) + \\exp(-2\\sigma t)\\cos(2\\omega x) \\right)\n$$\nTo simplify, we collect terms based on their trigonometric and exponential factors.\n\nTerms proportional to $\\exp(\\sigma t)\\sin(\\omega x)$:\n$$\n\\sigma \\exp(\\sigma t)\\sin(\\omega x) + \\kappa\\omega^{2} \\exp(\\sigma t)\\sin(\\omega x) + r \\exp(\\sigma t)\\sin(\\omega x) = (\\sigma + r + \\kappa\\omega^{2}) \\exp(\\sigma t)\\sin(\\omega x)\n$$\n\nTerms proportional to $\\exp(\\sigma t)\\cos(\\omega x)$:\n$$\nc\\omega \\exp(\\sigma t)\\cos(\\omega x)\n$$\n\nTerms proportional to $\\exp(-2\\sigma t)\\cos(2\\omega x)$:\n$$\n-2\\sigma \\exp(-2\\sigma t)\\cos(2\\omega x) + 4\\kappa\\omega^{2} \\exp(-2\\sigma t)\\cos(2\\omega x) + r \\exp(-2\\sigma t)\\cos(2\\omega x) = (r - 2\\sigma + 4\\kappa\\omega^{2}) \\exp(-2\\sigma t)\\cos(2\\omega x)\n$$\n\nTerms proportional to $\\exp(-2\\sigma t)\\sin(2\\omega x)$:\n$$\n-2c\\omega \\exp(-2\\sigma t)\\sin(2\\omega x)\n$$\n\nCombining these groups yields the final expression for the source term $S(x,t)$:\n$$\nS(x,t) = (\\sigma + r + \\kappa\\omega^{2}) \\exp(\\sigma t)\\sin(\\omega x) + c\\omega \\exp(\\sigma t)\\cos(\\omega x) + (r - 2\\sigma + 4\\kappa\\omega^{2}) \\exp(-2\\sigma t)\\cos(2\\omega x) - 2c\\omega \\exp(-2\\sigma t)\\sin(2\\omega x)\n$$\n\n### Code Verification Procedure\n\nThe Method of Manufactured Solutions (MMS) provides a framework for verifying that a numerical code correctly solves the intended governing equations to the expected order of accuracy. The procedure, starting from the conservation law, is as follows:\nA numerical code implements a discretized version of the conservation law. For a control volume $[x_i, x_{i+1}]$, the integral form of the law is discretized to produce a system of algebraic equations for the numerical solution $u_h(x_j, t_n)$ at discrete points in space $x_j$ and time $t_n$.\n\n1.  **Problem Setup:** The numerical solver is configured to solve the problem $\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = \\kappa \\frac{\\partial^{2} u}{\\partial x^{2}} - r u + S(x,t)$ on the domain $x \\in \\left[0,\\frac{2\\pi}{\\omega}\\right]$ for $t \\ge 0$. The source term $S(x,t)$ used is the exact expression derived above. The initial condition for the simulation is taken from the manufactured solution at $t=0$, i.e., $u_h(x_j, 0) = u(x_j, 0) = \\sin(\\omega x_j) + \\cos(2\\omega x_j)$. Periodic boundary conditions are applied.\n\n2.  **Error Calculation:** The numerical simulation is run up to a final time $T$. The error $e_h(x, T)$ is defined as the difference between the numerical solution $u_h(x,T)$ and the exact manufactured solution $u(x,T)$: $e_h(x, T) = u_h(x, T) - u(x, T)$. To quantify the magnitude of this error field, an error norm is computed. A common choice is the $L_2$ norm, defined as:\n    $$\n    \\|e_h(T)\\|_{2} = \\sqrt{\\int_{0}^{2\\pi/\\omega} |u_h(x, T) - u(x, T)|^2 dx}\n    $$\n    In a discrete setting, this integral is approximated by a sum over the grid points, for example, $\\|e_h(T)\\|_{2} \\approx \\sqrt{\\Delta x \\sum_j |u_h(x_j, T) - u(x_j, T)|^2}$, where $\\Delta x$ is the grid spacing.\n\n3.  **Order of Accuracy Study:** To verify the code's convergence rate, a grid refinement study is performed. The simulation is executed on a sequence of progressively finer grids with characteristic spacings $h_k$ (e.g., $h_1, h_2 = h_1/2, h_3 = h_1/4, \\dots$). For each grid $k$, the error norm $E_k = \\|e_{h_k}(T)\\|_{2}$ is calculated.\n\n4.  **Verification:** For a numerical method with a theoretical order of accuracy $p$, the error is expected to behave as $E_k \\approx C h_k^p$ for some constant $C$ as $h_k \\to 0$. The observed order of accuracy, $p_{obs}$, can be computed between two successive refinements (e.g., $h_k$ and $h_{k+1} = h_k/q$, where $q$ is the refinement factor, often $q=2$):\n    $$\n    p_{obs} = \\frac{\\ln(E_k / E_{k+1})}{\\ln(h_k / h_{k+1})} = \\frac{\\ln(E_k / E_{k+1})}{\\ln(q)}\n    $$\n    If the computed $p_{obs}$ approaches the theoretical order $p$ as the grid is refined, it provides strong evidence that the code is free of significant errors and correctly implements the discretized conservation law.",
            "answer": "$$\n\\boxed{(\\sigma + r + \\kappa\\omega^{2}) \\exp(\\sigma t)\\sin(\\omega x) + c\\omega \\exp(\\sigma t)\\cos(\\omega x) + (r - 2\\sigma + 4\\kappa\\omega^{2}) \\exp(-2\\sigma t)\\cos(2\\omega x) - 2c\\omega \\exp(-2\\sigma t)\\sin(2\\omega x)}\n$$"
        }
    ]
}