{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础情景开始：稳态扩散穿过多层介质。这在地球科学（如土壤分层）和工程学（如复合材料）中非常普遍。在构建数值模型之前，理解精确的解析解至关重要。 这个练习要求你运用质量守恒和菲克定律等基本原理，推导出材料界面上的连续性条件，并求解通过整个系统的通量。这项实践有助于建立关于不同材料属性如何控制物质输运的物理直觉。",
            "id": "3902377",
            "problem": "考虑一个占据 $0 \\leq x \\leq L$ 空间的一维分层环境柱，其中一种惰性示踪剂在没有源、汇、平流或反应的情况下进行分子扩散。示踪剂浓度表示为 $c(x)$，有效扩散系数由以下分段常数函数给出\n$$\nK(x) = \\begin{cases}\nK_{1},  0 \\leq x  x_{0} \\\\\nK_{2},  x_{0} \\leq x \\leq L\n\\end{cases}\n$$\n其中 $K_{1} > 0$，$K_{2} > 0$，材料界面位于 $x = x_{0}$ 处，且 $0  x_{0}  L$。边界条件为狄利克雷（Dirichlet）条件：$c(0) = c_{0}$ 和 $c(L) = c_{L}$，其中 $c_{0}$ 和 $c_{L}$ 是给定的常数。假设界面没有储存或反应能力，也不引起平衡分配；介质在 $x=x_{0}$ 处是完全粘合的。\n\n仅从一维的质量守恒和菲克第一扩散定律出发，推导在 $x = x_{0}$ 处示踪剂浓度 $c(x)$ 和扩散通量的物理上正确的界面连续性条件。然后，求解稳态边值问题，以获得每层中的示踪剂浓度以及沿正 $x$ 方向的恒定稳态扩散通量。\n\n你最终报告的量必须是恒定稳态扩散通量 $J$，以一个单一的闭式代数表达式表示，用 $K_{1}$、$K_{2}$、$x_{0}$、$L$、$c_{0}$ 和 $c_{L}$ 表示。通量应使用国际单位制（SI），与 $K$ 的单位 $\\mathrm{m^2\\,s^{-1}}$ 和 $c$ 的单位 $\\mathrm{mol\\,m^{-3}}$ 保持一致（因此 $J$ 的单位为 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$），但最终的方框答案中不要包含单位。没有提供数值；无需四舍五入。仅报告 $J$ 作为你的最终答案。",
            "solution": "用户提供了一个来自输运现象领域的、阐述清晰的题目，具体涉及稳态菲克扩散通过一维复合介质的问题。根据指定标准对问题陈述的验证证实了其科学合理性、一致性和完整性。该问题是一个经典的边值问题，存在唯一、稳定且有意义的解。因此，我将进行完整的推导。\n\n该问题要求推导界面条件，求解稳态扩散方程，并得出稳态扩散通量 $J$ 的最终表达式。\n\n**1. 界面连续性条件的推导**\n\n推导从质量守恒基本原理开始。在一维系统中，对于浓度为 $c(x, t)$ 的惰性示踪剂，在控制体积 $[x_a, x_b]$ 上的质量守恒积分形式为：\n$$\n\\frac{d}{dt} \\int_{x_a}^{x_b} c(x, t) \\, dx = J(x_a, t) - J(x_b, t)\n$$\n其中 $J(x, t)$ 是扩散通量。在本问题中，系统处于稳态，因此 $\\frac{\\partial c}{\\partial t} = 0$，这意味着左侧为零。\n$$\nJ(x_a) - J(x_b) = 0 \\implies J(x_a) = J(x_b)\n$$\n这表明，在稳态且无源/汇的介质中，任意两点 $x_a$ 和 $x_b$ 之间的通量是恒定的。为了正式确定界面 $x=x_0$ 处的条件，我们考虑一个在 $\\epsilon \\to 0$ 时无限小的控制体积 $[x_0 - \\epsilon, x_0 + \\epsilon]$。守恒定律规定，进入 $x_0 - \\epsilon$ 处的通量必须等于流出 $x_0 + \\epsilon$ 处的通量，因为假设界面本身没有储存或反应能力。这得出了第一个界面条件：通量的连续性。\n$$\nJ(x_0^-) = J(x_0^+)\n$$\n菲克第一定律将通量定义为 $J(x) = -K(x) \\frac{dc}{dx}$。将此应用于我们的条件可得：\n$$\n-K_1 \\left. \\frac{dc}{dx} \\right|_{x=x_0^-} = -K_2 \\left. \\frac{dc}{dx} \\right|_{x=x_0^+}\n$$\n第二个界面条件涉及浓度本身。问题指明界面“不引起平衡分配”且介质“完全粘合”。在扩散的背景下，这意味着示踪剂的化学势在界面上是连续的。对于浓度与化学势成正比的稀疏物质，这直接意味着浓度在界面处必须是连续的。不等于1的分配系数会导致不连续性。在此，这些条件意味着分配系数为1。\n$$\nc(x_0^-) = c(x_0^+)\n$$\n这两个条件，即通量连续性和浓度连续性，是本问题中物理上正确的界面条件。\n\n**2. 稳态边值问题的求解**\n\n在稳态且无源/汇的情况下，一维扩散方程为：\n$$\n\\frac{d}{dx} \\left( -K(x) \\frac{dc}{dx} \\right) = 0\n$$\n根据质量守恒，该方程意味着扩散通量 $J = -K(x) \\frac{dc}{dx}$ 在整个域 $0  x  L$ 内是一个常数。设此恒定通量为 $J$。\n\n我们分别在每一层中求解该方程。\n\n对于第一层，$0 \\leq x  x_0$，扩散系数为 $K_1$。\n$$\n-K_1 \\frac{dc_1}{dx} = J\n$$\n对 $x$ 积分，得到浓度分布 $c_1(x)$：\n$$\nc_1(x) = -\\frac{J}{K_1}x + A_1\n$$\n其中 $A_1$ 是一个积分常数。我们应用 $x=0$ 处的边界条件，即 $c(0) = c_0$：\n$$\nc_1(0) = c_0 = -\\frac{J}{K_1}(0) + A_1 \\implies A_1 = c_0\n$$\n因此，第一层中的浓度分布为：\n$$\nc_1(x) = c_0 - \\frac{J}{K_1}x\n$$\n\n对于第二层，$x_0 \\leq x \\leq L$，扩散系数为 $K_2$。\n$$\n-K_2 \\frac{dc_2}{dx} = J\n$$\n对 $x$ 积分，得到浓度分布 $c_2(x)$：\n$$\nc_2(x) = -\\frac{J}{K_2}x + A_2\n$$\n其中 $A_2$ 是一个积分常数。我们应用 $x=L$ 处的边界条件，即 $c(L) = c_L$：\n$$\nc_2(L) = c_L = -\\frac{J}{K_2}L + A_2 \\implies A_2 = c_L + \\frac{J L}{K_2}\n$$\n将 $A_2$ 代回 $c_2(x)$ 的表达式中：\n$$\nc_2(x) = -\\frac{J}{K_2}x + c_L + \\frac{J L}{K_2} = c_L + \\frac{J}{K_2}(L-x)\n$$\n\n**3. 恒定通量 $J$ 的确定**\n\n我们现在得到了每一层中浓度的表达式，两者都用未知常数通量 $J$ 表示。为了求出 $J$，我们应用 $x=x_0$ 处的浓度连续性界面条件：\n$$\nc_1(x_0) = c_2(x_0)\n$$\n代入 $c_1(x)$ 和 $c_2(x)$ 的表达式：\n$$\nc_0 - \\frac{J x_0}{K_1} = c_L + \\frac{J(L-x_0)}{K_2}\n$$\n现在，我们必须求解这个方程以得到 $J$。我们首先重新排列各项，将所有含 $J$ 的项归到一边：\n$$\nc_0 - c_L = \\frac{J x_0}{K_1} + \\frac{J(L-x_0)}{K_2}\n$$\n提出 $J$：\n$$\nc_0 - c_L = J \\left( \\frac{x_0}{K_1} + \\frac{L-x_0}{K_2} \\right)\n$$\n括号中的项表示总的扩散阻力，它是两层串联阻力之和。我们现在可以分离出 $J$：\n$$\nJ = \\frac{c_0 - c_L}{\\frac{x_0}{K_1} + \\frac{L-x_0}{K_2}}\n$$\n为了获得所需的单一闭式代数表达式，我们通过通分来简化分母，公分母为 $K_1 K_2$：\n$$\n\\frac{x_0}{K_1} + \\frac{L-x_0}{K_2} = \\frac{x_0 K_2}{K_1 K_2} + \\frac{(L-x_0) K_1}{K_1 K_2} = \\frac{x_0 K_2 + (L-x_0) K_1}{K_1 K_2}\n$$\n分母可以展开并重新排列为 $L K_1 + x_0(K_2 - K_1)$。将此代回 $J$ 的表达式：\n$$\nJ = \\frac{c_0 - c_L}{\\frac{L K_1 + x_0(K_2 - K_1)}{K_1 K_2}}\n$$\n最后，将分母中的分数倒置，得到稳态扩散通量 $J$ 的最终表达式：\n$$\nJ = \\frac{K_1 K_2 (c_0 - c_L)}{L K_1 + x_0(K_2 - K_1)}\n$$\n此表达式给出了沿正 $x$ 方向的通量，与其通过菲克定律的定义一致。如果 $c_0 > c_L$，通量 $J$ 为正，符合预期。",
            "answer": "$$\\boxed{\\frac{K_{1} K_{2} (c_{0} - c_{L})}{L K_{1} + x_{0}(K_{2} - K_{1})}}$$"
        },
        {
            "introduction": "在上一个解析问题的基础上，我们现在转向构建一个数值模型。有限体积法 (Finite Volume Method, FVM) 因其内在的守恒性而成为一个强大的工具。 这个练习挑战你为同样的分层介质问题构建一个简单的 FVM 离散格式，并探索如何正确表示不同材料界面处的通量。你将会发现，这一过程自然而然地引出了对导水率进行调和平均的概念，这是精确模拟非均质系统的关键技术。",
            "id": "3902348",
            "problem": "考虑在水平方向 $x$ 上，通过总长度为 $L=L_1+L_2$ 的分层土柱的稳态、饱和、一维地下水流。水力传导系数 $K(x)$ 是分段常数，当 $0 \\leq x  L_1$ 时，$K(x)=K_1$；当 $L_1 \\leq x \\leq L$ 时，$K(x)=K_2$。水头 $h(x)$ 满足质量守恒和达西定律。在左端和右端施加狄利克雷边界条件 $h(0)=H_L$ 和 $h(L)=H_R$。没有体积源或汇。土柱具有均匀的横截面积。\n\n从质量守恒和达西定律的积分形式出发，为双控制体网格构建一个单元中心有限体积法 (FVM)。该网格将未知水头置于两层的中点，并引入三个面：左边界表面、位于 $x=L_1$ 的内部界面以及右边界表面。通过在每个半单元距离上近似水头梯度，来强制内部界面处的通量连续性和边界面处的一致通量。证明所得到的表面表示对应于在半单元距离上传导系数的调和平均，并能保持穿过不连续界面的物理上正确的通量。\n\n然后，使用您构建的格式，根据以下参数计算通过土柱的稳态达西通量 $q$：\n- $L_1=15~\\text{m}$ 和 $L_2=35~\\text{m}$，\n- $K_1=2.5 \\times 10^{-5}~\\mathrm{m\\,s^{-1}}$ 和 $K_2=7.0 \\times 10^{-7}~\\mathrm{m\\,s^{-1}}$，\n- $H_L=12~\\text{m}$ 和 $H_R=11~\\text{m}$。\n\n将您的数值答案四舍五入到四位有效数字。以 $\\mathrm{m\\,s^{-1}}$ 为单位表示最终的达西通量。",
            "solution": "首先验证问题，以确保其具有科学依据、适定且客观。\n\n### 步骤1：提取已知条件\n- **控制物理**：由质量守恒和达西定律控制的稳态、饱和、一维地下水流。\n- **域**：一个总长度为 $L=L_1+L_2$ 的分层土柱，位于水平方向 $x$ 上，从 $x=0$ 到 $x=L$。\n- **水力传导系数**：$K(x)$ 是分段常数：当 $0 \\leq x  L_1$ 时，$K(x)=K_1$；当 $L_1 \\leq x \\leq L$ 时，$K(x)=K_2$。\n- **边界条件**：狄利克雷条件为 $h(0)=H_L$ 和 $h(L)=H_R$。\n- **源/汇**：无体积源或汇。\n- **几何形状**：均匀的横截面积。\n- **FVM 设置**：采用双控制体网格的单元中心有限体积法 (FVM)。\n  - 未知水头位于两层的中点：节点 $P_1$ 位于 $x_1 = L_1/2$ 处，水头为 $h_1$；节点 $P_2$ 位于 $x_2 = L_1 + L_2/2$ 处，水头为 $h_2$。\n  - 定义了三个面：位于 $x=0$ 的左边界表面，位于 $x=L_1$ 的内部界面，以及位于 $x=L$ 的右边界表面。\n- **近似规则**：在每个半单元距离上近似水头梯度，以强制通量连续性和一致的边界通量。\n- **计算参数**：\n  - $L_1 = 15~\\text{m}$， $L_2 = 35~\\text{m}$\n  - $K_1 = 2.5 \\times 10^{-5}~\\mathrm{m\\,s^{-1}}$， $K_2 = 7.0 \\times 10^{-7}~\\mathrm{m\\,s^{-1}}$\n  - $H_L = 12~\\text{m}$， $H_R = 11~\\text{m}$\n- **要求输出**：\n  1. 证明表面表示对应于传导系数的调和平均。\n  2. 计算稳态达西通量 $q$ 并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于达西定律和质量守恒原理，这是水文地质学和多孔介质流的基础。这是环境模拟中的一个经典问题。其前提具有科学合理性。\n- **适定性**：该问题描述了一个具有两个狄利克雷边界条件的稳态、一维二阶常微分方程。这构成了一个具有唯一稳定解的适定边值问题。\n- **客观性**：该问题使用精确、无歧义的科学语言陈述。\n- **完整性和一致性**：所有必要的数据（$L_1, L_2, K_1, K_2, H_L, H_R$）、边界条件和物理原理都已提供。定义和约束是自洽的。参数在物理上是现实的。未发现任何缺陷。\n\n### 步骤3：结论与行动\n问题被认为是**有效的**。将提供完整解答。\n\n### 解答推导\n在多孔介质中，无源汇的稳态一维流动的控制方程是通过结合达西定律 $q = -K(x) \\frac{dh}{dx}$ 和质量守恒定律 $\\frac{dq}{dx}=0$ 推导出来的。这得到：\n$$ \\frac{d}{dx}\\left(-K(x)\\frac{dh}{dx}\\right) = 0 $$\n将此方程从任意点 $a$ 积分到任意点 $b$ 可知，通量 $q(x) = -K(x)\\frac{dh}{dx}$ 在整个域内是常数。设这个常数通量为 $q$。\n\n现在我们构建指定的单元中心有限体积法。该域被离散为两个控制体。\n- 控制体1 (CV1) 与位于 $x_1 = L_1/2$ 的节点 $P_1$ 相关联。其表面位于 $x=0$ (西面, $w$) 和 $x=L_1$ (东面, $i$) 。\n- 控制体2 (CV2) 与位于 $x_2 = L_1 + L_2/2$ 的节点 $P_2$ 相关联。其表面位于 $x=L_1$ (西面, $i$) 和 $x=L=L_1+L_2$ (东面, $e$) 。\n\n有限体积法需要在各表面上近似通量。问题指定这些通量是通过在“半单元距离”（即从单元中心到表面的距离）上近似水头梯度来确定的。\n\n**左边界表面 ($x=0$) 处的通量**\nCV1西面处的通量 $q_w$ 是使用边界处的水头 $h(0)=H_L$ 和节点 $P_1$ 处的水头 $h_1=h(x_1)$ 来近似的。距离为 $\\delta x_{w1} = x_1 - 0 = L_1/2$。传导系数为 $K_1$。\n$$ q_w = -K_1 \\frac{h_1 - H_L}{x_1 - 0} = -K_1 \\frac{h_1 - H_L}{L_1/2} $$\n\n**右边界表面 ($x=L$) 处的通量**\nCV2东面处的通量 $q_e$ 是使用节点 $P_2$ 处的水头 $h_2=h(x_2)$ 和边界处的水头 $h(L)=H_R$ 来近似的。距离为 $\\delta x_{2e} = L - x_2 = (L_1+L_2) - (L_1+L_2/2) = L_2/2$。传导系数为 $K_2$。\n$$ q_e = -K_2 \\frac{H_R - h_2}{L - x_2} = -K_2 \\frac{H_R - h_2}{L_2/2} $$\n\n**内部界面 ($x=L_1$) 处的通量**\n在界面处，传导系数是不连续的。我们通过使用界面处的未知水头 $h_i = h(L_1)$ 来定义通量，从而强制通量连续。\n从左侧（在 $K_1$ 域内）接近界面的通量为：\n$$ q_{i^-} = -K_1 \\frac{h_i - h_1}{L_1 - x_1} = -K_1 \\frac{h_i - h_1}{L_1/2} $$\n从右侧（在 $K_2$ 域内）离开界面的通量为：\n$$ q_{i^+} = -K_2 \\frac{h_2 - h_i}{x_2 - L_1} = -K_2 \\frac{h_2 - h_i}{L_2/2} $$\n强制通量连续 $q_i = q_{i^-} = q_{i^+}$，我们可以解出 $h_i$：\n$$ K_1 \\frac{h_i - h_1}{L_1/2} = K_2 \\frac{h_2 - h_i}{L_2/2} \\implies h_i \\left( \\frac{2K_1}{L_1} + \\frac{2K_2}{L_2} \\right) = h_1 \\frac{2K_1}{L_1} + h_2 \\frac{2K_2}{L_2} $$\n$$ h_i = \\frac{\\frac{K_1}{L_1}h_1 + \\frac{K_2}{L_2}h_2}{\\frac{K_1}{L_1} + \\frac{K_2}{L_2}} $$\n将 $h_i$ 代回 $q_i$ 的表达式中（例如 $q_{i^-}$）：\n$$ q_i = -K_1 \\frac{2}{L_1} \\left( \\frac{\\frac{K_1}{L_1}h_1 + \\frac{K_2}{L_2}h_2}{\\frac{K_1}{L_1} + \\frac{K_2}{L_2}} - h_1 \\right) = -\\frac{2K_1}{L_1} \\frac{\\frac{K_2}{L_2}(h_2 - h_1)}{\\frac{K_1L_2 + K_2L_1}{L_1L_2}} = -\\frac{2K_1K_2(h_2-h_1)}{K_1L_2 + K_2L_1} $$\n这个表达式可以重新排列以突出其结构：\n$$ q_i = -\\frac{h_2 - h_1}{\\frac{K_1L_2 + K_2L_1}{2K_1K_2}} = -\\frac{h_2 - h_1}{\\frac{L_2}{2K_2} + \\frac{L_1}{2K_1}} $$\n节点 $P_1$ 和 $P_2$ 之间的距离是 $\\Delta x_{12} = x_2 - x_1 = (L_1+L_2/2) - L_1/2 = L_1/2 + L_2/2$。如果我们将通量写为 $q_i = -K_{eff} \\frac{h_2 - h_1}{\\Delta x_{12}}$，那么节点之间的有效传导系数 $K_{eff}$ 为：\n$$ K_{eff} = \\frac{\\Delta x_{12}}{\\frac{L_1/2}{K_1} + \\frac{L_2/2}{K_2}} = \\frac{L_1/2 + L_2/2}{\\frac{L_1/2}{K_1} + \\frac{L_2/2}{K_2}} $$\n这是传导系数 $K_1$ 和 $K_2$ 的调和平均，由它们各自从单元中心到界面的“半单元距离”（$L_1/2$ 和 $L_2/2$）加权。这证实了问题陈述的第一部分。该方法正确地保持了流经串联材料的物理特性，其中阻力（长度/传导系数）是相加的。\n\n**求解常数通量, $q$**\n由于是稳态流，通量在各处都是恒定的：$q = q_w = q_i = q_e$。我们可以用 $q$ 来表示每一段的水头降：\n1. $H_L - h_1 = q \\frac{L_1/2}{K_1}$\n2. $h_1 - h_2 = q \\left( \\frac{L_1/2}{K_1} + \\frac{L_2/2}{K_2} \\right)$\n3. $h_2 - H_R = q \\frac{L_2/2}{K_2}$\n总水头降是各段水头降的总和：\n$$ H_L - H_R = (H_L - h_1) + (h_1 - h_2) + (h_2 - H_R) $$\n代入以 $q$ 表示的表达式：\n$$ H_L - H_R = q \\frac{L_1/2}{K_1} + q \\left( \\frac{L_1/2}{K_1} + \\frac{L_2/2}{K_2} \\right) + q \\frac{L_2/2}{K_2} $$\n$$ H_L - H_R = q \\left( \\frac{L_1/2 + L_1/2}{K_1} + \\frac{L_2/2 + L_2/2}{K_2} \\right) $$\n$$ H_L - H_R = q \\left( \\frac{L_1}{K_1} + \\frac{L_2}{K_2} \\right) $$\n这个FVM格式精确地再现了著名的一维稳态流通过串联层的解析解。达西通量为：\n$$ q = \\frac{H_L - H_R}{\\frac{L_1}{K_1} + \\frac{L_2}{K_2}} $$\n\n**数值计算**\n我们代入给定的参数值：\n- $L_1 = 15~\\text{m}$\n- $L_2 = 35~\\text{m}$\n- $K_1 = 2.5 \\times 10^{-5}~\\mathrm{m\\,s^{-1}}$\n- $K_2 = 7.0 \\times 10^{-7}~\\mathrm{m\\,s^{-1}}$\n- $H_L = 12~\\text{m}$\n- $H_R = 11~\\text{m}$\n\n首先，计算两层的水力阻力：\n$$ R_1 = \\frac{L_1}{K_1} = \\frac{15~\\text{m}}{2.5 \\times 10^{-5}~\\mathrm{m\\,s^{-1}}} = 600000~\\text{s} = 6.0 \\times 10^{5}~\\text{s} $$\n$$ R_2 = \\frac{L_2}{K_2} = \\frac{35~\\text{m}}{7.0 \\times 10^{-7}~\\mathrm{m\\,s^{-1}}} = 50000000~\\text{s} = 5.0 \\times 10^{7}~\\text{s} $$\n总阻力为 $R_{total} = R_1 + R_2$：\n$$ R_{total} = (6.0 \\times 10^{5} + 5.0 \\times 10^{7})~\\text{s} = (0.06 \\times 10^{7} + 5.0 \\times 10^{7})~\\text{s} = 5.06 \\times 10^{7}~\\text{s} $$\n总水头降为 $\\Delta H = H_L - H_R$：\n$$ \\Delta H = 12~\\text{m} - 11~\\text{m} = 1~\\text{m} $$\n最后，计算达西通量 $q$：\n$$ q = \\frac{\\Delta H}{R_{total}} = \\frac{1~\\text{m}}{5.06 \\times 10^{7}~\\text{s}} \\approx 1.97628458 \\times 10^{-8}~\\mathrm{m\\,s^{-1}} $$\n四舍五入到四位有效数字：\n$$ q \\approx 1.976 \\times 10^{-8}~\\mathrm{m\\,s^{-1}} $$",
            "answer": "$$\\boxed{1.976 \\times 10^{-8}}$$"
        },
        {
            "introduction": "目前为止，我们处理的都是扩散问题。当我们加入平流 (即物质随流体运动而被输运) 时，新的数值挑战便会出现。 这项实践将研究广泛使用的一阶迎风格式，并揭示其一个隐藏的缺陷：数值扩散。通过泰勒级数分析，你将推导出该格式实际求解的“修正方程”，并量化其引入的人为扩散效应，这种效应在模拟中有时会掩盖真实的物理扩散。这项技能对于批判性地评估数值模型的结果至关重要。",
            "id": "3902379",
            "problem": "考虑一个一维保守示踪剂 $C(x,t)$ 在均匀通道中以恒定速度 $u$ 平流，由线性平流方程 $\\partial C / \\partial t + u \\, \\partial C / \\partial x = 0$ 表示。空间域在间距为 $\\Delta x$ 的均匀网格上进行离散化，空间导数使用与 $u$ 符号一致的一阶迎风有限差分（施主单元）格式进行近似。以半离散的方式（线方法）处理空间离散化，即时间保持连续。\n\n仅从连续平流方程、空间导数的一阶迎风近似定义以及光滑函数 $C(x,t)$ 的标准泰勒级数展开出发，推导半离散迎风格式所求解的主阶修正偏微分方程。由此，识别并量化由于一维一阶迎风离散化而产生的有效数值扩散系数 $D_{\\text{num}}$。\n\n解释 $D_{\\text{num}}$ 如何随平流速度 $u$ 和网格间距 $\\Delta x$ 变化，并根据你的推导论证 $D_{\\text{num}}$ 的符号和大小。\n\n以 $u$ 和 $\\Delta x$ 的单个闭式解析表达式形式给出 $D_{\\text{num}}$ 的最终结果。最终答案以 $\\mathrm{m^2\\,s^{-1}}$ 为单位表示。无需四舍五入。",
            "solution": "该问题要求推导由一维线性平流方程的一阶迎风空间离散化产生的有效数值扩散系数 $D_{\\text{num}}$。这将通过修正方程分析来完成，该方法涉及将离散的有限差分算子替换为其泰勒级数展开，以揭示数值格式实际求解的偏微分方程。\n\n具有恒定平流速度 $u$ 的保守示踪剂 $C(x,t)$ 的控制连续方程如下：\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = 0\n$$\n该方程可以重新排列以表示 $C$ 的时间演化：\n$$\n\\frac{\\partial C}{\\partial t} = -u \\frac{\\partial C}{\\partial x}\n$$\n在半离散（线方法）方法中，空间导数被离散化，但时间保持连续。设空间域被离散化为一个均匀网格，其上的点为 $x_j = j \\Delta x$，其中 $j$ 是一个整数索引，$\\Delta x$ 是恒定的网格间距。设 $C_j(t)$ 表示网格点 $x_j$ 和时间 $t$ 处的示踪剂浓度，即 $C_j(t) \\equiv C(x_j, t)$。\n\n平流方程的半离散形式为：\n$$\n\\frac{d C_j}{d t} = -u \\left( \\frac{\\partial C}{\\partial x} \\right)_{j}\n$$\n其中 $\\left( \\frac{\\partial C}{\\partial x} \\right)_{j}$ 表示在网格点 $j$ 处空间导数的有限差分近似。问题指定了使用一阶迎风（或施主单元）格式。该格式的形式取决于速度 $u$ 的符号。\n\n情况1：$u > 0$\n对于正速度，流动方向是从左到右。“迎风”或“施主”信息来自索引为 $j-1$ 的单元。空间导数由一阶后向差分近似：\n$$\n\\left( \\frac{\\partial C}{\\partial x} \\right)_{j} \\approx \\frac{C_j - C_{j-1}}{\\Delta x}\n$$\n将此代入半离散方程，得到 $u>0$ 时的数值格式：\n$$\n\\frac{d C_j}{d t} = -u \\frac{C_j(t) - C_{j-1}(t)}{\\Delta x}\n$$\n为了进行修正方程分析，我们使用在点 $x_j$ 附近的泰勒级数展开来表示项 $C_{j-1}(t)$：\n$$\nC_{j-1}(t) = C(x_j - \\Delta x, t) = C(x_j, t) - \\Delta x \\frac{\\partial C}{\\partial x}\\bigg|_{j} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 C}{\\partial x^2}\\bigg|_{j} - \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 C}{\\partial x^3}\\bigg|_{j} + \\mathcal{O}((\\Delta x)^4)\n$$\n其中所有偏导数都在 $(x_j, t)$ 处求值。将此展开式代入数值格式：\n$$\n\\frac{d C_j}{d t} = -u \\frac{1}{\\Delta x} \\left( C_j - \\left[ C_j - \\Delta x \\frac{\\partial C}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2} - \\mathcal{O}((\\Delta x)^3) \\right] \\right)\n$$\n简化括号内的表达式：\n$$\n\\frac{d C_j}{d t} = -u \\frac{1}{\\Delta x} \\left( \\Delta x \\frac{\\partial C}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}((\\Delta x)^3) \\right)\n$$\n分配因子 $-u/\\Delta x$：\n$$\n\\frac{d C_j}{d t} = -u \\frac{\\partial C}{\\partial x} + \\frac{u \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} - \\mathcal{O}((\\Delta x)^2)\n$$\n通过将左侧的离散符号 $C_j(t)$ 替换为连续函数 $C(x,t)$ 及其在点 $(x_j, t)$ 处的精确时间导数 $\\frac{\\partial C}{\\partial t}$，我们得到了该格式所求解的修正偏微分方程，直至主阶误差项：\n$$\n\\frac{\\partial C}{\\partial t} = -u \\frac{\\partial C}{\\partial x} + \\frac{u \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2}\n$$\n重新排列此方程，使其与原始的平流-扩散方程结构相匹配：\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = \\frac{u \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2}\n$$\n原始的偏微分方程右侧为零。数值格式引入了一个人为的二阶导数项，这是扩散过程的特征。该项被称为数值扩散或数值耗散项。通过将此修正方程与标准的平流-扩散方程 $\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^2 C}{\\partial x^2}$ 进行比较，我们可以确定当 $u > 0$ 时，有效数值扩散系数为：\n$$\nD_{\\text{num}} = \\frac{u \\Delta x}{2}\n$$\n\n情况2：$u  0$\n对于负速度，流动方向是从右到左，“迎风”信息来自索引为 $j+1$ 的单元。空间导数由一阶前向差分近似：\n$$\n\\left( \\frac{\\partial C}{\\partial x} \\right)_{j} \\approx \\frac{C_{j+1} - C_j}{\\Delta x}\n$$\n$u0$ 时的数值格式为：\n$$\n\\frac{d C_j}{d t} = -u \\frac{C_{j+1}(t) - C_j(t)}{\\Delta x}\n$$\n$C_{j+1}(t)$ 在 $x_j$ 附近的泰勒级数展开为：\n$$\nC_{j+1}(t) = C(x_j + \\Delta x, t) = C_j + \\Delta x \\frac{\\partial C}{\\partial x}\\bigg|_{j} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 C}{\\partial x^2}\\bigg|_{j} + \\mathcal{O}((\\Delta x)^3)\n$$\n将此代入格式中：\n$$\n\\frac{d C_j}{d t} = -u \\frac{1}{\\Delta x} \\left( \\left[ C_j + \\Delta x \\frac{\\partial C}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}((\\Delta x)^3) \\right] - C_j \\right)\n$$\n简化后得到：\n$$\n\\frac{d C_j}{d t} = -u \\left( \\frac{\\partial C}{\\partial x} + \\frac{\\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}((\\Delta x)^2) \\right)\n$$\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = -\\frac{u \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2}\n$$\n在这种情况下，数值扩散系数为 $D_{\\text{num}} = -\\frac{u \\Delta x}{2}$。由于 $u$ 是负数，$D_{\\text{num}}$ 仍然是一个正量。\n\n一般结果：\n综合两种情况，一阶迎风格式的数值扩散系数可以用速度的绝对值表示：\n$$\nD_{\\text{num}} = \\frac{|u| \\Delta x}{2}\n$$\n$D_{\\text{num}}$ 的单位由速度单位（$\\mathrm{m\\,s^{-1}}$）和网格间距单位（$\\mathrm{m}$）的乘积正确给出，结果为 $\\mathrm{m^2\\,s^{-1}}$，这是扩散系数的单位。\n\n论证与尺度关系：\n推导出的表达式表明，数值扩散 $D_{\\text{num}}$ 与平流速度的大小 $|u|$ 和网格间距 $\\Delta x$ 呈线性关系。这意味着对于更快的流动和更粗的网格分辨率，数值扩散更为显著。为了减少这种人为扩散，必须细化网格（减小 $\\Delta x$）。\n$D_{\\text{num}}$ 的符号始终为非负，因为 $|u| \\geq 0$ 且 $\\Delta x > 0$。这一点至关重要。正的扩散系数正确地表示了一个耗散过程，其中浓度梯度被平滑掉，这是一阶迎风格式所观察到的行为。负系数将意味着反扩散，这是一个不稳定的过程，其中小扰动会无界增长，而这不是该格式的特征。\n数值大小 $\\frac{|u| \\Delta x}{2}$ 直接源于一阶导数 $\\frac{\\partial C}{\\partial x}$ 的一阶有限差分近似的主阶截断误差。该误差是 $\\mathcal{O}(\\Delta x)$ 阶的，并在修正方程中表现为一个二阶导数项，其比例常数包含了来自泰勒级数展开的因子 $\\frac{1}{2!}$。正是这个主阶误差项使得该格式在空间上具有“一阶”精度，并且是该格式扩散性质的根源。\n因此，数值扩散系数的最终闭式表达式为 $\\frac{|u|\\Delta x}{2}$。",
            "answer": "$$\n\\boxed{\\frac{|u| \\Delta x}{2}}\n$$"
        }
    ]
}