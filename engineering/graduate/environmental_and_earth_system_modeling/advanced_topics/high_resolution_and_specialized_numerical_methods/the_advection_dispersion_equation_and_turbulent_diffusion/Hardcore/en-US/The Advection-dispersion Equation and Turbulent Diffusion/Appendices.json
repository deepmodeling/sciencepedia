{
    "hands_on_practices": [
        {
            "introduction": "This first practice serves as a foundational exercise in analyzing transport phenomena. By deriving and solving the one-dimensional, steady-state advection-dispersion equation for a channel with a constant source and first-order decay, you will build a solid understanding of how fundamental processes—advection, diffusion, sources, and sinks—interact to establish a concentration profile. This problem  emphasizes the crucial role of boundary conditions and introduces the concept of a characteristic length scale, $L_k$, which elegantly describes the balance between diffusion and reaction processes.",
            "id": "3921736",
            "problem": "A tracer with concentration field $c(x,t)$ evolves in a one-dimensional, well-mixed channel of length $L$ with constant, uniform flow speed $u0$ in the positive $x$-direction, constant turbulent diffusivity $D0$, spatially uniform volumetric source $S_{0}0$ (with units of mass per volume per time), and first-order decay at rate $k0$. The channel boundaries at $x=0$ and $x=L$ are perfect sinks (Dirichlet boundaries). At steady state, the concentration does not change in time. Starting from conservation of mass over a differential control volume and the definitions of advective and diffusive fluxes, derive the governing steady-state ordinary differential equation for $c(x)$, impose the boundary conditions, and solve for the unique steady-state concentration profile. Define the decay-diffusion length scale $L_{k} = \\sqrt{D/k}$ and express your final result to make the dependence on $L_{k}$ explicit.\n\nYour final answer must be a single, exact, closed-form analytic expression for $c(x)$ as a function of $x$, $L$, $u$, $D$, $k$, $S_{0}$, and $L_{k}$. Do not include any undetermined constants. Report only this expression as your final answer. No numerical evaluation or rounding is required. For interpretation, briefly explain in your working how $L_{k}$ sets the spatial scale of boundary influence in the profile, but this interpretation should not appear in the final answer.",
            "solution": "The user wants to find the steady-state concentration profile $c(x)$ for a tracer in a one-dimensional channel.\n\n### Step 1: Problem Validation\n\n**Extracted Givens:**\n- Concentration field: $c(x,t)$\n- Channel length: $L$\n- Flow speed: constant, uniform $u0$\n- Turbulent diffusivity: constant, $D0$\n- Volumetric source: spatially uniform, $S_00$ (mass per volume per time)\n- Decay rate: first-order, $k0$\n- Boundary conditions: $c(0,t)=0$ and $c(L,t)=0$ (perfect sinks, Dirichlet)\n- Condition: steady state, $\\frac{\\partial c}{\\partial t} = 0$, so $c=c(x)$\n- Definition: Decay-diffusion length scale, $L_k = \\sqrt{D/k}$\n\n**Validation using Extracted Givens:**\n1.  **Scientifically Grounded:** The problem describes contaminant transport using the one-dimensional advection-diffusion-reaction equation, a fundamental and widely used model in environmental science, hydrology, and chemical engineering. All parameters ($u, D, S_0, k$) have clear physical meanings and are defined as positive constants, which is physically realistic.\n2.  **Well-Posed:** The problem provides a second-order linear ordinary differential equation with two specified boundary conditions (Dirichlet). This constitutes a well-posed boundary value problem, which is expected to have a unique and stable solution.\n3.  **Objective:** The problem is stated using precise, standard scientific terminology. There are no subjective or ambiguous statements.\n4.  **Complete and Consistent:** All necessary parameters and conditions to derive and solve the governing equation are provided. There are no contradictions in the setup.\n5.  **Not Trivial or Pseudo-Profound:** The problem requires the derivation and solution of a second-order non-homogeneous ODE, which is a standard but non-trivial exercise in mathematical physics and engineering. The structure requires careful application of principles, not just rote calculation.\n\n**Verdict and Action:**\nThe problem is scientifically sound, well-posed, objective, and complete. It is a valid problem. I will proceed with the solution.\n\n### Step 2: Derivation of the Governing Equation\n\nWe begin with the principle of mass conservation for the tracer concentration $c(x,t)$ in a differential control volume of length $\\Delta x$ and cross-sectional area $A$. The rate of change of mass in the control volume is equal to the net flux into the volume plus the net rate of production within the volume.\n$$\n\\frac{d}{dt} \\int_{x}^{x+\\Delta x} c(x',t) A \\,dx' = J(x,t)A - J(x+\\Delta x, t)A + \\int_{x}^{x+\\Delta x} (S_0 - kc(x',t)) A \\,dx'\n$$\nHere, $J(x,t)$ is the total flux of the tracer (mass per area per time). Dividing by $A\\Delta x$ and taking the limit as $\\Delta x \\to 0$, we obtain the one-dimensional conservation law in differential form:\n$$\n\\frac{\\partial c}{\\partial t} = -\\frac{\\partial J}{\\partial x} + S_0 - kc\n$$\nThe total flux $J$ is the sum of the advective flux, $J_{adv} = uc$, and the diffusive flux, which is given by Fick's first law, $J_{diff} = -D \\frac{\\partial c}{\\partial x}$. Thus, the total flux is:\n$$\nJ = uc - D \\frac{\\partial c}{\\partial x}\n$$\nSubstituting this expression for $J$ into the conservation law gives the advection-diffusion-reaction equation:\n$$\n\\frac{\\partial c}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left(uc - D \\frac{\\partial c}{\\partial x}\\right) + S_0 - kc\n$$\nSince the flow speed $u$ and diffusivity $D$ are constant, this simplifies to:\n$$\n\\frac{\\partial c}{\\partial t} = -u \\frac{\\partial c}{\\partial x} + D \\frac{\\partial^2 c}{\\partial x^2} + S_0 - kc\n$$\nThe problem asks for the steady-state solution, for which $\\frac{\\partial c}{\\partial t} = 0$. This yields the governing steady-state ordinary differential equation (ODE) for $c(x)$:\n$$\nD \\frac{d^2 c}{dx^2} - u \\frac{d c}{dx} - kc + S_0 = 0\n$$\n\n### Step 3: Solution of the Ordinary Differential Equation\n\nThe equation is a second-order, linear, non-homogeneous ODE with constant coefficients. We can write it in the standard form:\n$$\n\\frac{d^2 c}{dx^2} - \\frac{u}{D} \\frac{d c}{dx} - \\frac{k}{D} c = -\\frac{S_0}{D}\n$$\nThe general solution $c(x)$ is the sum of a particular solution $c_p(x)$ and the general solution to the homogeneous equation $c_h(x)$.\n\n**Particular Solution ($c_p$)**:\nSince the non-homogeneous term $-\\frac{S_0}{D}$ is a constant, we assume a constant particular solution $c_p(x) = C_p$. Substituting into the ODE:\n$$\n0 - 0 - \\frac{k}{D} C_p = -\\frac{S_0}{D} \\implies C_p = \\frac{S_0}{k}\n$$\nSo, the particular solution is $c_p(x) = \\frac{S_0}{k}$.\n\n**Homogeneous Solution ($c_h$)**:\nThe homogeneous equation is:\n$$\n\\frac{d^2 c_h}{dx^2} - \\frac{u}{D} \\frac{d c_h}{dx} - \\frac{k}{D} c_h = 0\n$$\nThe characteristic equation is $r^2 - \\frac{u}{D} r - \\frac{k}{D} = 0$. The roots $r_{1,2}$ are:\n$$\nr_{1,2} = \\frac{\\frac{u}{D} \\pm \\sqrt{\\left(\\frac{u}{D}\\right)^2 - 4(1)\\left(-\\frac{k}{D}\\right)}}{2} = \\frac{u}{2D} \\pm \\sqrt{\\left(\\frac{u}{2D}\\right)^2 + \\frac{k}{D}}\n$$\nTo simplify the expression and incorporate the decay-diffusion length scale $L_k = \\sqrt{D/k}$, we define two parameters:\n$$\np = \\frac{u}{2D} \\quad \\text{and} \\quad q = \\sqrt{\\left(\\frac{u}{2D}\\right)^2 + \\frac{k}{D}} = \\sqrt{p^2 + \\frac{1}{L_k^2}}\n$$\nThe roots are $r_1 = p+q$ and $r_2 = p-q$. The homogeneous solution can be written as:\n$$\nc_h(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x} = e^{px} (C_1 e^{qx} + C_2 e^{-qx})\n$$\nAn equivalent and more convenient form uses hyperbolic functions:\n$$\nc_h(x) = e^{px} (A \\cosh(qx) + B \\sinh(qx))\n$$\n\n**General Solution**:\nThe general solution is $c(x) = c_h(x) + c_p(x)$:\n$$\nc(x) = e^{px} (A \\cosh(qx) + B \\sinh(qx)) + \\frac{S_0}{k}\n$$\n\n### Step 4: Application of Boundary Conditions\n\nThe coefficients $A$ and $B$ are determined by the boundary conditions $c(0) = 0$ and $c(L) = 0$.\n\n1.  At $x=0$:\n    $c(0) = e^{0} (A \\cosh(0) + B \\sinh(0)) + \\frac{S_0}{k} = 0$\n    $A \\cdot 1 + B \\cdot 0 + \\frac{S_0}{k} = 0 \\implies A = -\\frac{S_0}{k}$\n\n2.  At $x=L$:\n    $c(L) = e^{pL} (A \\cosh(qL) + B \\sinh(qL)) + \\frac{S_0}{k} = 0$\n    $e^{pL} \\left(-\\frac{S_0}{k} \\cosh(qL) + B \\sinh(qL)\\right) = -\\frac{S_0}{k}$\n    $-\\frac{S_0}{k} \\cosh(qL) + B \\sinh(qL) = -\\frac{S_0}{k} e^{-pL}$\n    $B \\sinh(qL) = \\frac{S_0}{k} \\cosh(qL) - \\frac{S_0}{k} e^{-pL}$\n    $B = \\frac{S_0}{k} \\frac{\\cosh(qL) - e^{-pL}}{\\sinh(qL)}$\n\n### Step 5: Final Expression for the Concentration Profile\n\nSubstituting the expressions for $A$ and $B$ back into the general solution:\n$$\nc(x) = e^{px} \\left(-\\frac{S_0}{k} \\cosh(qx) + \\frac{S_0}{k} \\frac{\\cosh(qL) - e^{-pL}}{\\sinh(qL)} \\sinh(qx)\\right) + \\frac{S_0}{k}\n$$\n$$\nc(x) = \\frac{S_0}{k} \\left[ 1 + e^{px} \\left(-\\cosh(qx) + \\frac{\\cosh(qL) - e^{-pL}}{\\sinh(qL)} \\sinh(qx)\\right) \\right]\n$$\nTo simplify, we find a common denominator $\\sinh(qL)$:\n$$\nc(x) = \\frac{S_0}{k} \\left[ 1 - \\frac{e^{px}}{\\sinh(qL)} \\left(\\sinh(qL)\\cosh(qx) - (\\cosh(qL) - e^{-pL})\\sinh(qx)\\right) \\right]\n$$\n$$\nc(x) = \\frac{S_0}{k} \\left[ 1 - \\frac{e^{px}}{\\sinh(qL)} \\left(\\sinh(qL)\\cosh(qx) - \\cosh(qL)\\sinh(qx) + e^{-pL}\\sinh(qx)\\right) \\right]\n$$\nUsing the hyperbolic identity $\\sinh(a-b) = \\sinh(a)\\cosh(b) - \\cosh(a)\\sinh(b)$, we have $\\sinh(qL-qx) = \\sinh(q(L-x))$.\n$$\nc(x) = \\frac{S_0}{k} \\left[ 1 - \\frac{e^{px}}{\\sinh(qL)} \\left(\\sinh(q(L-x)) + e^{-pL}\\sinh(qx)\\right) \\right]\n$$\nFinally, substituting back $p=u/(2D)$:\n$$\nc(x) = \\frac{S_0}{k} \\left[ 1 - \\frac{\\exp\\left(\\frac{ux}{2D}\\right)}{\\sinh(qL)} \\left( \\sinh(q(L-x)) + \\exp\\left(-\\frac{uL}{2D}\\right)\\sinh(qx) \\right) \\right]\n$$\nwhere $q = \\sqrt{\\left(\\frac{u}{2D}\\right)^2 + \\frac{1}{L_k^2}}$. This is the final steady-state concentration profile.\n\n### Interpretation of $L_k$\n\nThe decay-diffusion length scale $L_k = \\sqrt{D/k}$ represents the characteristic distance over which concentration gradients, created by boundary conditions, are smoothed out by diffusion before the tracer is removed by the first-order decay process. In the absence of advection ($u=0$), the governing equation simplifies to $D\\frac{d^2c}{dx^2} - kc = -S_0$, or $\\frac{d^2c}{dx^2} - \\frac{1}{L_k^2}c = -\\frac{S_0}{D}$. The solution involves terms like $\\cosh(x/L_k)$ and $\\sinh(x/L_k)$, clearly showing that $L_k$ sets the spatial scale over which the solution adjusts from the a value of zero at the boundaries towards the equilibrium concentration $S_0/k$ in the interior. When advection is present, this fundamental scale is modified by the flow, resulting in the combined parameter $q = \\sqrt{(u/2D)^2 + 1/L_k^2}$, but $L_k$ remains the key parameter that defines the balance between diffusion and reaction. The influence of the \"perfect sink\" boundaries at $x=0$ and $x=L$ penetrates into the channel over a distance related to $L_k$, creating \"boundary layers\" in the concentration profile.",
            "answer": "$$\n\\boxed{\\frac{S_{0}}{k} \\left( 1 - \\frac{\\exp\\left(\\frac{ux}{2D}\\right)}{\\sinh\\left(L\\sqrt{\\left(\\frac{u}{2D}\\right)^{2} + \\frac{1}{L_{k}^{2}}}\\right)} \\left( \\sinh\\left((L-x)\\sqrt{\\left(\\frac{u}{2D}\\right)^{2} + \\frac{1}{L_{k}^{2}}}\\right) + \\exp\\left(-\\frac{uL}{2D}\\right)\\sinh\\left(x\\sqrt{\\left(\\frac{u}{2D}\\right)^{2} + \\frac{1}{L_{k}^{2}}}\\right) \\right) \\right)}\n$$"
        },
        {
            "introduction": "Building upon the one-dimensional case, this exercise  extends our analysis to a more realistic two-dimensional scenario involving anisotropic diffusion. In many environmental systems, turbulent mixing is not uniform in all directions, necessitating the use of a diffusivity tensor, $\\mathbf{D}$. This problem guides you through the process of diagonalizing this tensor to find its principal axes, a powerful technique that simplifies the governing equation and reveals the underlying structure of the transport process, showing how a pollutant cloud evolves into an ellipse aligned with the directions of maximum and minimum diffusion.",
            "id": "3921698",
            "problem": "Consider a horizontally homogeneous atmospheric surface layer of constant mixing height $H$ in which a passive scalar is transported by a uniform mean wind and turbulent diffusion. Let the depth-integrated areal concentration be $C(\\mathbf{x}, t)$ with $\\mathbf{x} = (x, y)$ denoting horizontal position. Assume the following:\n- The turbulent diffusivity tensor $\\mathbf{D}$ is symmetric positive-definite and spatially uniform.\n- The mean wind $\\mathbf{U}$ is spatially uniform and constant in time.\n- The scalar is passive, and the flux obeys a Fickian closure.\n\nA point release of total mass $M$ occurs instantaneously at the origin at time $t = 0$, and vertical mixing is assumed fast and uniform within the mixing height $H$, so that the three-dimensional volume concentration $c_{v}(\\mathbf{x}, t)$ is related to the areal concentration by $c_{v}(\\mathbf{x}, t) = C(\\mathbf{x}, t)/H$. There are no boundaries (an unbounded plane), and no sources or sinks after the impulse release.\n\nStarting from local mass conservation and the Fickian flux closure, perform the following:\n1. Write down the governing equation for $C(\\mathbf{x}, t)$ as a consequence of mass conservation and flux closure in terms of $\\mathbf{U}$ and $\\mathbf{D}$.\n2. Prove that because $\\mathbf{D}$ is symmetric positive-definite, there exists an orthogonal rotation $\\mathbf{R}$ that diagonalizes $\\mathbf{D}$, and show that in the rotated principal-coordinate system the diffusion operator reduces to decoupled second derivatives along principal directions.\n3. Use the coordinate rotation and an appropriate change of variables to remove advection and solve analytically for $C(\\mathbf{x}, t)$ given the impulse initial condition. Give your solution as a closed-form analytic expression in the original coordinates, and articulate why the solution is an anisotropic Gaussian whose level sets are ellipses aligned with the principal directions of $\\mathbf{D}$.\n\nThen, for the specific parameter values\n- $\\mathbf{U} = (0.5, -0.2)\\ \\mathrm{m\\,s^{-1}}$,\n- $\\mathbf{D} = \\begin{pmatrix} 1.2  0.3 \\\\ 0.3  0.8 \\end{pmatrix}\\ \\mathrm{m^{2}\\,s^{-1}}$,\n- $M = 5\\ \\mathrm{kg}$,\n- $H = 100\\ \\mathrm{m}$,\n- evaluation point $\\mathbf{x}^{\\ast} = (200, -100)\\ \\mathrm{m}$,\n- evaluation time $t^{\\ast} = 600\\ \\mathrm{s}$,\n\nevaluate the volume concentration $c_{v}(\\mathbf{x}^{\\ast}, t^{\\ast})$ at that point and time. Express the final concentration in $\\mathrm{mg\\,m^{-3}}$. Round your answer to $4$ significant figures.",
            "solution": "The problem is assessed as valid as it is scientifically grounded, well-posed, and objective. It is a standard problem in transport phenomena that is self-contained and free of contradictions.\n\nThe solution process will follow the three parts outlined in the problem statement, followed by a numerical evaluation.\n\n**1. Governing Equation Derivation**\n\nThe principle of local mass conservation for the depth-integrated areal concentration $C(\\mathbf{x}, t)$ in two dimensions is expressed by the continuity equation:\n$$\n\\frac{\\partial C}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0\n$$\nwhere $\\mathbf{x} = (x, y)$, $\\nabla = (\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})$ is the horizontal gradient operator, and $\\mathbf{J}$ is the total horizontal flux vector of the scalar.\n\nThe total flux $\\mathbf{J}$ is the sum of the advective flux due to the mean wind and the diffusive flux due to turbulence.\nThe advective flux is given by $\\mathbf{J}_{\\text{adv}} = C\\mathbf{U}$, where $\\mathbf{U}$ is the uniform mean wind vector.\nThe turbulent diffusive flux, according to the Fickian closure, is given by $\\mathbf{J}_{\\text{diff}} = -\\mathbf{D} \\nabla C$, where $\\mathbf{D}$ is the turbulent diffusivity tensor.\n\nThe total flux is therefore:\n$$\n\\mathbf{J} = C\\mathbf{U} - \\mathbf{D} \\nabla C\n$$\n\nSubstituting this into the conservation equation gives:\n$$\n\\frac{\\partial C}{\\partial t} + \\nabla \\cdot (C\\mathbf{U} - \\mathbf{D} \\nabla C) = 0\n$$\nWe can expand the divergence term:\n$$\n\\nabla \\cdot (C\\mathbf{U} - \\mathbf{D} \\nabla C) = \\nabla \\cdot (C\\mathbf{U}) - \\nabla \\cdot (\\mathbf{D} \\nabla C)\n$$\nFor the advective part, using the product rule for divergence: $\\nabla \\cdot (C\\mathbf{U}) = (\\nabla C) \\cdot \\mathbf{U} + C(\\nabla \\cdot \\mathbf{U})$. Since the mean wind $\\mathbf{U}$ is given as spatially uniform, its divergence is zero: $\\nabla \\cdot \\mathbf{U} = 0$. Thus, the term simplifies to $\\nabla \\cdot (C\\mathbf{U}) = \\mathbf{U} \\cdot \\nabla C$.\n\nFor the diffusive part, the operator is $\\nabla \\cdot (\\mathbf{D} \\nabla C)$. In component form, this is $\\sum_{i} \\frac{\\partial}{\\partial x_i} \\left( \\sum_{j} D_{ij} \\frac{\\partial C}{\\partial x_j} \\right)$. Since the diffusivity tensor $\\mathbf{D}$ is also given as spatially uniform, its components $D_{ij}$ are constants and can be pulled out of the outer differentiation, yielding $\\sum_{i,j} D_{ij} \\frac{\\partial^2 C}{\\partial x_i \\partial x_j}$.\n\nCombining these results, the governing advection-dispersion equation for $C(\\mathbf{x}, t)$ is:\n$$\n\\frac{\\partial C}{\\partial t} + \\mathbf{U} \\cdot \\nabla C = \\sum_{i,j} D_{ij} \\frac{\\partial^2 C}{\\partial x_i \\partial x_j}\n$$\nThis can also be written in vector notation as $\\frac{\\partial C}{\\partial t} + \\mathbf{U} \\cdot \\nabla C = \\nabla \\cdot (\\mathbf{D} \\nabla C)$.\n\n**2. Diagonalization of the Diffusivity Tensor**\n\nThe diffusivity tensor $\\mathbf{D}$ is given as a symmetric, positive-definite matrix. The spectral theorem of linear algebra states that any real symmetric matrix can be diagonalized by an orthogonal matrix. Specifically, there exists an orthogonal matrix $\\mathbf{R}$ (whose columns are the orthonormal eigenvectors of $\\mathbf{D}$) and a diagonal matrix $\\mathbf{D}'$ (whose entries are the corresponding eigenvalues of $\\mathbf{D}$) such that:\n$$\n\\mathbf{D} = \\mathbf{R} \\mathbf{D}' \\mathbf{R}^T\n$$\nwhere $\\mathbf{R}^T \\mathbf{R} = \\mathbf{R} \\mathbf{R}^T = \\mathbf{I}$, the identity matrix. Since $\\mathbf{D}$ is positive-definite, its eigenvalues $\\lambda_1, \\lambda_2$ (the diagonal elements of $\\mathbf{D}'$) are all positive.\n\nLet us introduce a new coordinate system $\\mathbf{x}' = (x', y')$ which is a rotation of the original system $\\mathbf{x} = (x, y)$. This rotation aligns the new coordinate axes with the principal axes (eigenvectors) of $\\mathbf{D}$. The transformation is given by $\\mathbf{x}' = \\mathbf{R}^T \\mathbf{x}$. The inverse transformation is $\\mathbf{x} = \\mathbf{R} \\mathbf{x}'$.\n\nWe must transform the diffusion operator $\\sum_{i,j} D_{ij} \\frac{\\partial^2 C}{\\partial x_i \\partial x_j}$ into the new coordinates. The chain rule for partial derivatives gives the relationship between the gradient operators: $\\nabla_{\\mathbf{x}} = \\mathbf{R} \\nabla_{\\mathbf{x}'}$. The second partial derivatives transform as:\n$$\n\\frac{\\partial^2 C}{\\partial x_i \\partial x_j} = \\sum_{k,l} \\frac{\\partial x'_k}{\\partial x_i} \\frac{\\partial x'_l}{\\partial x_j} \\frac{\\partial^2 C}{\\partial x'_k \\partial x'_l} = \\sum_{k,l} (R^T)_{ki} (R^T)_{lj} \\frac{\\partial^2 C}{\\partial x'_k \\partial x'_l}\n$$\nSubstituting this into the diffusion operator:\n$$\n\\sum_{i,j} D_{ij} \\frac{\\partial^2 C}{\\partial x_i \\partial x_j} = \\sum_{i,j} D_{ij} \\left( \\sum_{k,l} (R^T)_{ki} (R^T)_{lj} \\frac{\\partial^2 C}{\\partial x'_k \\partial x'_l} \\right)\n$$\nRearranging the order of summation:\n$$\n= \\sum_{k,l} \\left( \\sum_{i,j} (R^T)_{ki} D_{ij} R_{jl} \\right) \\frac{\\partial^2 C}{\\partial x'_k \\partial x'_l}\n$$\nThe term in parentheses is the $(k,l)$-th element of the matrix product $\\mathbf{R}^T \\mathbf{D} \\mathbf{R}$. From the diagonalization of $\\mathbf{D}$, we know $\\mathbf{R}^T \\mathbf{D} \\mathbf{R} = \\mathbf{D}'$. Since $\\mathbf{D}'$ is a diagonal matrix with diagonal entries $\\lambda_1, \\lambda_2$, its $(k,l)$-th element is $\\lambda_k \\delta_{kl}$ (where $\\delta_{kl}$ is the Kronecker delta).\n\nThe diffusion operator thus simplifies to:\n$$\n\\sum_{k,l} (\\lambda_k \\delta_{kl}) \\frac{\\partial^2 C}{\\partial x'_k \\partial x'_l} = \\sum_{k} \\lambda_k \\frac{\\partial^2 C}{\\partial (x'_k)^2} = \\lambda_1 \\frac{\\partial^2 C}{\\partial (x')^2} + \\lambda_2 \\frac{\\partial^2 C}{\\partial (y')^2}\n$$\nThis demonstrates that in the rotated principal-coordinate system, the diffusion operator decouples into a sum of second derivatives along the principal directions, with diffusivities equal to the eigenvalues of $\\mathbf{D}$.\n\n**3. Analytical Solution**\n\nTo solve the governing PDE, we employ two transformations. First, we transform to a moving frame of reference to eliminate the advection term. Let $\\mathbf{x}'' = \\mathbf{x} - \\mathbf{U}t$. Let $C(\\mathbf{x}, t) = C'(\\mathbf{x}'', t)$. The partial derivatives transform as:\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\partial C'}{\\partial t} - \\mathbf{U} \\cdot \\nabla_{\\mathbf{x}''}C' \\quad \\text{and} \\quad \\nabla_{\\mathbf{x}}C = \\nabla_{\\mathbf{x}''}C'\n$$\nSubstituting these into the PDE gives:\n$$\n\\left(\\frac{\\partial C'}{\\partial t} - \\mathbf{U} \\cdot \\nabla_{\\mathbf{x}''}C' \\right) + \\mathbf{U} \\cdot \\nabla_{\\mathbf{x}''}C' = \\nabla_{\\mathbf{x}''} \\cdot (\\mathbf{D} \\nabla_{\\mathbf{x}''} C')\n$$\nThis simplifies to a pure diffusion equation in the moving frame:\n$$\n\\frac{\\partial C'}{\\partial t} = \\nabla_{\\mathbf{x}''} \\cdot (\\mathbf{D} \\nabla_{\\mathbf{x}''} C')\n$$\nNext, we apply the rotation of coordinates from Part 2. In the rotated, moving frame $\\mathbf{x}' = \\mathbf{R}^T \\mathbf{x}''$, the PDE becomes:\n$$\n\\frac{\\partial C'}{\\partial t} = \\lambda_1 \\frac{\\partial^2 C'}{\\partial (x')^2} + \\lambda_2 \\frac{\\partial^2 C'}{\\partial (y')^2}\n$$\nThe initial condition is an instantaneous point release of mass $M$ at the origin at $t=0$, which can be represented by a Dirac delta function: $C(\\mathbf{x}, 0) = M \\delta(\\mathbf{x})$. In the transformed coordinates, this remains $C'(\\mathbf{x}', 0) = M \\delta(\\mathbf{x}')$.\n\nThe solution to this decoupled 2D diffusion equation is the product of two 1D Gaussian kernels:\n$$\nC'(x', y', t) = \\frac{M}{\\sqrt{4\\pi\\lambda_1 t}\\sqrt{4\\pi\\lambda_2 t}} \\exp\\left(-\\frac{(x')^2}{4\\lambda_1 t} - \\frac{(y')^2}{4\\lambda_2 t}\\right)\n$$\n$$\nC'(x', y', t) = \\frac{M}{4\\pi t \\sqrt{\\lambda_1 \\lambda_2}} \\exp\\left(-\\frac{1}{4t}\\left(\\frac{(x')^2}{\\lambda_1} + \\frac{(y')^2}{\\lambda_2}\\right)\\right)\n$$\nThe term in the exponent can be expressed in matrix form as $\\frac{1}{4t}(\\mathbf{x}')^T (\\mathbf{D}')^{-1} \\mathbf{x}'$.\nWe know that $\\lambda_1 \\lambda_2 = \\det(\\mathbf{D}')$, and since $\\det(\\mathbf{D}) = \\det(\\mathbf{R}\\mathbf{D}'\\mathbf{R}^T) = \\det(\\mathbf{D}')$, we have $\\sqrt{\\lambda_1\\lambda_2} = \\sqrt{\\det(\\mathbf{D})}$.\n\nTo obtain the solution in the original coordinates, we transform back.\nThe quadratic form in the exponent is $(\\mathbf{x}')^T (\\mathbf{D}')^{-1} \\mathbf{x}'$. We use $\\mathbf{x}' = \\mathbf{R}^T(\\mathbf{x}-\\mathbf{U}t)$ and $(\\mathbf{D}')^{-1} = \\mathbf{R}^T \\mathbf{D}^{-1} \\mathbf{R}$.\n$$\n(\\mathbf{x}')^T (\\mathbf{D}')^{-1} \\mathbf{x}' = [(\\mathbf{x}-\\mathbf{U}t)^T \\mathbf{R}] [\\mathbf{R}^T \\mathbf{D}^{-1} \\mathbf{R}] [\\mathbf{R}^T(\\mathbf{x}-\\mathbf{U}t)]\n$$\n$$\n= (\\mathbf{x}-\\mathbf{U}t)^T (\\mathbf{R}\\mathbf{R}^T) \\mathbf{D}^{-1} (\\mathbf{R}\\mathbf{R}^T) (\\mathbf{x}-\\mathbf{U}t) = (\\mathbf{x}-\\mathbf{U}t)^T \\mathbf{D}^{-1} (\\mathbf{x}-\\mathbf{U}t)\n$$\nThus, the final analytical solution for $C(\\mathbf{x}, t)$ is:\n$$\nC(\\mathbf{x}, t) = \\frac{M}{4\\pi t \\sqrt{\\det(\\mathbf{D})}} \\exp\\left( -\\frac{(\\mathbf{x} - \\mathbf{U}t)^T \\mathbf{D}^{-1} (\\mathbf{x} - \\mathbf{U}t)}{4t} \\right)\n$$\nThis solution represents an anisotropic Gaussian distribution. Its peak (mean) is located at $\\mathbf{x} = \\mathbf{U}t$, which confirms that the center of mass of the scalar cloud advects with the mean wind. The spread of the cloud is determined by the term in the exponent. The level sets of $C$ (contours of constant concentration) are defined by $(\\mathbf{x} - \\mathbf{U}t)^T \\mathbf{D}^{-1} (\\mathbf{x} - \\mathbf{U}t) = \\text{constant}$. Since $\\mathbf{D}$ is symmetric positive-definite, so is its inverse $\\mathbf{D}^{-1}$. A quadratic form $\\mathbf{v}^T \\mathbf{A} \\mathbf{v} = \\text{constant}$ with a symmetric positive-definite matrix $\\mathbf{A}$ defines an ellipse. The axes of these ellipses are oriented along the eigenvectors of $\\mathbf{D}^{-1}$, which are the same as the eigenvectors of $\\mathbf{D}$. Therefore, the solution describes an elliptical cloud of scalar, centered at $\\mathbf{U}t$, whose principal axes are aligned with the principal directions of the diffusivity tensor $\\mathbf{D}$.\n\n**Numerical Evaluation**\n\nWe are asked to evaluate the volume concentration $c_{v}(\\mathbf{x}^{\\ast}, t^{\\ast}) = C(\\mathbf{x}^{\\ast}, t^{\\ast})/H$ for the given parameters.\n- $\\mathbf{U} = (0.5, -0.2)^T\\ \\mathrm{m\\,s^{-1}}$, $\\mathbf{D} = \\begin{pmatrix} 1.2  0.3 \\\\ 0.3  0.8 \\end{pmatrix}\\ \\mathrm{m^{2}\\,s^{-1}}$\n- $M = 5\\ \\mathrm{kg} = 5 \\times 10^6 \\ \\mathrm{mg}$, $H = 100\\ \\mathrm{m}$\n- $\\mathbf{x}^{\\ast} = (200, -100)^T\\ \\mathrm{m}$, $t^{\\ast} = 600\\ \\mathrm{s}$\n\nFirst, calculate the vector difference in the exponent:\n$$\n\\mathbf{x}^{\\ast} - \\mathbf{U}t^{\\ast} = \\begin{pmatrix} 200 \\\\ -100 \\end{pmatrix} - \\begin{pmatrix} 0.5 \\\\ -0.2 \\end{pmatrix} (600) = \\begin{pmatrix} 200 - 300 \\\\ -100 - (-120) \\end{pmatrix} = \\begin{pmatrix} -100 \\\\ 20 \\end{pmatrix}\\ \\mathrm{m}\n$$\nNext, we need $\\det(\\mathbf{D})$ and $\\mathbf{D}^{-1}$:\n$$\n\\det(\\mathbf{D}) = (1.2)(0.8) - (0.3)(0.3) = 0.96 - 0.09 = 0.87\\ \\mathrm{m^4 s^{-2}}\n$$\n$$\n\\mathbf{D}^{-1} = \\frac{1}{0.87} \\begin{pmatrix} 0.8  -0.3 \\\\ -0.3  1.2 \\end{pmatrix}\\ \\mathrm{s\\, m^{-2}}\n$$\nNow, compute the quadratic form in the exponent, which we denote as $Q$:\n$$\nQ = (\\mathbf{x}^{\\ast} - \\mathbf{U}t^{\\ast})^T \\mathbf{D}^{-1} (\\mathbf{x}^{\\ast} - \\mathbf{U}t^{\\ast})\n$$\n$$\nQ = \\begin{pmatrix} -100  20 \\end{pmatrix} \\frac{1}{0.87} \\begin{pmatrix} 0.8  -0.3 \\\\ -0.3  1.2 \\end{pmatrix} \\begin{pmatrix} -100 \\\\ 20 \\end{pmatrix}\n$$\n$$\nQ = \\frac{1}{0.87} \\begin{pmatrix} -100  20 \\end{pmatrix} \\begin{pmatrix} -80 - 6 \\\\ 30 + 24 \\end{pmatrix} = \\frac{1}{0.87} \\begin{pmatrix} -100  20 \\end{pmatrix} \\begin{pmatrix} -86 \\\\ 54 \\end{pmatrix}\n$$\n$$\nQ = \\frac{1}{0.87} ((-100)(-86) + (20)(54)) = \\frac{8600 + 1080}{0.87} = \\frac{9680}{0.87}\\ \\mathrm{s}\n$$\nThe argument of the exponential function is $-\\frac{Q}{4t^{\\ast}}$:\n$$\n-\\frac{Q}{4t^{\\ast}} = -\\frac{9680 / 0.87}{4 \\times 600} = -\\frac{9680}{0.87 \\times 2400} = -\\frac{9680}{2088} = -\\frac{1210}{261}\n$$\nNow we compute $C(\\mathbf{x}^{\\ast}, t^{\\ast})$:\n$$\nC(\\mathbf{x}^{\\ast}, t^{\\ast}) = \\frac{M}{4\\pi t^{\\ast} \\sqrt{\\det(\\mathbf{D})}} \\exp\\left(-\\frac{1210}{261}\\right)\n$$\n$$\nC(\\mathbf{x}^{\\ast}, t^{\\ast}) = \\frac{5}{4\\pi (600) \\sqrt{0.87}} \\exp\\left(-\\frac{1210}{261}\\right) \\ \\mathrm{kg\\, m^{-2}}\n$$\nFinally, the volume concentration $c_{v}$ in $\\mathrm{mg\\, m^{-3}}$ is:\n$$\nc_v(\\mathbf{x}^{\\ast}, t^{\\ast}) = \\frac{C(\\mathbf{x}^{\\ast}, t^{\\ast})}{H} \\times 10^6 \\ \\mathrm{mg\\, kg^{-1}}\n$$\n$$\nc_v = \\frac{5 \\times 10^6}{100 \\times 4\\pi (600) \\sqrt{0.87}} \\exp\\left(-\\frac{1210}{261}\\right) \\ \\mathrm{mg\\, m^{-3}}\n$$\n$$\nc_v = \\frac{5 \\times 10^6}{240000 \\pi \\sqrt{0.87}} \\exp\\left(-\\frac{1210}{261}\\right) = \\frac{50}{2.4 \\pi \\sqrt{0.87}} \\exp\\left(-\\frac{1210}{261}\\right)\n$$\n$$\nc_v = \\frac{125}{6 \\pi \\sqrt{0.87}} \\exp\\left(-\\frac{1210}{261}\\right)\n$$\nNow, we evaluate this expression numerically:\n$$\n\\exp\\left(-\\frac{1210}{261}\\right) \\approx \\exp(-4.6360153) \\approx 0.00969680\n$$\n$$\n\\frac{125}{6 \\pi \\sqrt{0.87}} \\approx \\frac{125}{6 \\times 3.14159265 \\times 0.9327379} \\approx \\frac{125}{17.58762} \\approx 7.10730\n$$\n$$\nc_v \\approx 7.10730 \\times 0.00969680 \\approx 0.068918 \\ \\mathrm{mg\\, m^{-3}}\n$$\nRounding to $4$ significant figures, the result is $0.06892 \\ \\mathrm{mg\\, m^{-3}}$. In standard scientific notation this is $6.892 \\times 10^{-2}$.",
            "answer": "$$\\boxed{6.892 \\times 10^{-2}}$$"
        },
        {
            "introduction": "While analytical solutions provide invaluable insight, most real-world applications of the advection-dispersion equation require numerical methods. This computational practice  serves as a critical introduction to the challenges and nuances of discretizing the governing equations. By implementing and comparing central-differencing and upwind schemes for the advection term, you will directly observe the emergence of non-physical oscillations when advection dominates diffusion—a classic numerical instability tied to the cell Péclet number, $\\mathrm{Pe}_h$. This exercise demonstrates why careful choice of numerical schemes is paramount for obtaining physically meaningful results in computational fluid dynamics.",
            "id": "3921699",
            "problem": "Consider the one-dimensional steady advection-dispersion equation for a passive scalar concentration $C(x)$ under constant mean velocity $u$ and constant turbulent diffusivity $K_T$ (also called eddy diffusivity), derived from conservation of mass for a passive scalar in a homogeneous flow:\n$$\nu\\,\\frac{dC}{dx} \\;=\\; K_T\\,\\frac{d^2 C}{dx^2},\n$$\non the domain $x \\in [0,L]$, subject to Dirichlet boundary conditions $C(0) = C_{\\text{left}}$ and $C(L) = C_{\\text{right}}$. Assume uniform grid spacing $h = L/(N-1)$ with $N$ grid points.\n\nYour task is to demonstrate, by construction and computation, how central differencing of the advection term can produce spurious oscillations at high cell Péclet number and to propose a remedy via upwinding.\n\nYou must proceed from first principles as follows:\n- Start from the conservation form above and construct a linear system for the interior grid points using two alternative discretizations of the advection term:\n  1. Central differencing for the first derivative $dC/dx$ at interior nodes.\n  2. First-order upwind differencing for $dC/dx$ that respects the flow direction (use the sign of $u$ to choose backward or forward differencing).\n- Discretize the diffusive term $d^2 C/dx^2$ with a second-order central difference at interior nodes.\n- Assemble a tridiagonal linear system for each discretization and solve for the interior concentrations; impose the Dirichlet boundary conditions at the endpoints exactly.\n- Define the cell Péclet number (Péclet number per cell) as\n$$\n\\mathrm{Pe}_h \\;=\\; \\frac{|u|\\,h}{K_T}.\n$$\n\nDefine a quantitative measure of spurious oscillations relative to the physically expected monotone profile between $C_{\\text{left}}$ and $C_{\\text{right}}$ (for the parameters below, take $C_{\\text{left}}  C_{\\text{right}}$ so the physically correct solution is monotonically decreasing from left to right):\n- Monotonicity flag $M$: $M = \\text{True}$ if the discrete solution is nonincreasing, i.e., $C_{i+1} \\le C_i$ for all interior differences to within a numerical tolerance of $10^{-10}$, and $M = \\text{False}$ otherwise.\n- Oscillation amplitude $A$ (in $\\mathrm{kg}/\\mathrm{m}^3$): $A = \\max\\{0,\\,\\max_i (C_{i+1} - C_i)\\}$, the largest upward jump between adjacent nodes, which is zero for a nonincreasing sequence and strictly positive when spurious oscillations occur.\n\nImplement both schemes (central and upwind), compute $M$ and $A$ for each scheme, and report the cell Péclet number $\\mathrm{Pe}_h$.\n\nUse the following scientifically plausible test suite, with all inputs in International System of Units (SI):\n- Test case $1$ (diffusion-dominated \"happy path\"): $L = 1\\,\\mathrm{m}$, $N = 50$, $u = 0.2\\,\\mathrm{m/s}$, $K_T = 0.05\\,\\mathrm{m}^2/\\mathrm{s}$, $C_{\\text{left}} = 1\\,\\mathrm{kg}/\\mathrm{m}^3$, $C_{\\text{right}} = 0\\,\\mathrm{kg}/\\mathrm{m}^3$.\n- Test case $2$ (moderately advection-dominated): $L = 1\\,\\mathrm{m}$, $N = 50$, $u = 2.0\\,\\mathrm{m/s}$, $K_T = 0.01\\,\\mathrm{m}^2/\\mathrm{s}$, $C_{\\text{left}} = 1\\,\\mathrm{kg}/\\mathrm{m}^3$, $C_{\\text{right}} = 0\\,\\mathrm{kg}/\\mathrm{m}^3$.\n- Test case $3$ (strongly advection-dominated, large $\\mathrm{Pe}_h$): $L = 1\\,\\mathrm{m}$, $N = 50$, $u = 10.0\\,\\mathrm{m/s}$, $K_T = 0.001\\,\\mathrm{m}^2/\\mathrm{s}$, $C_{\\text{left}} = 1\\,\\mathrm{kg}/\\mathrm{m}^3$, $C_{\\text{right}} = 0\\,\\mathrm{kg}/\\mathrm{m}^3$.\n- Test case $4$ (reverse flow direction and coarse grid edge case): $L = 1\\,\\mathrm{m}$, $N = 10$, $u = -2.0\\,\\mathrm{m/s}$, $K_T = 0.01\\,\\mathrm{m}^2/\\mathrm{s}$, $C_{\\text{left}} = 1\\,\\mathrm{kg}/\\mathrm{m}^3$, $C_{\\text{right}} = 0\\,\\mathrm{kg}/\\mathrm{m}^3$.\n\nFor each test case, compute and return the list\n$$\n[\\mathrm{Pe}_h,\\, M_{\\text{central}},\\, M_{\\text{upwind}},\\, A_{\\text{central}},\\, A_{\\text{upwind}}],\n$$\nwhere $\\mathrm{Pe}_h$ is dimensionless, $M_{\\text{central}}$ and $M_{\\text{upwind}}$ are booleans, and $A_{\\text{central}}$ and $A_{\\text{upwind}}$ are floats in $\\mathrm{kg}/\\mathrm{m}^3$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one inner list per test case in the order above. For example,\n$[[r_1],[r_2],[r_3],[r_4]]$,\nwhere $[r_k]$ is the list of five values specified for test case $k$.\n\nNo user input is permitted; hard-code the test suite above.",
            "solution": "The user wants me to solve a problem related to the one-dimensional steady advection-dispersion equation.\n\n### Problem Validation\n\nI will first validate the problem statement according to the specified procedure.\n\n#### Step 1: Extract Givens\n\n-   **Governing Equation**: The one-dimensional steady advection-dispersion equation for a passive scalar concentration $C(x)$ is given by:\n    $$u\\,\\frac{dC}{dx} \\;=\\; K_T\\,\\frac{d^2 C}{dx^2}$$\n    where $u$ is the constant mean velocity and $K_T$ is the constant turbulent diffusivity.\n-   **Domain**: $x \\in [0,L]$.\n-   **Boundary Conditions**: Dirichlet conditions $C(0) = C_{\\text{left}}$ and $C(L) = C_{\\text{right}}$.\n-   **Grid Discretization**: Uniform grid with $N$ points and spacing $h = L/(N-1)$.\n-   **Task**:\n    1.  Discretize the equation for interior grid points using two schemes for the advection term ($dC/dx$):\n        -   Scheme A: Central differencing.\n        -   Scheme B: First-order upwind differencing (respecting the sign of $u$).\n    2.  Use a second-order central difference for the diffusive term ($d^2 C/dx^2$) in both schemes.\n    3.  Assemble and solve the resulting tridiagonal linear system for each scheme.\n-   **Definitions**:\n    -   Cell Péclet Number: $\\mathrm{Pe}_h = \\frac{|u|\\,h}{K_T}$.\n    -   Monotonicity Flag $M$: A boolean. $M = \\text{True}$ if the solution is nonincreasing ($C_{i+1} \\le C_i$ for all adjacent nodes, within a tolerance of $10^{-10}$), and $M = \\text{False}$ otherwise. This is based on the premise that for the chosen boundary conditions ($C_{\\text{left}}  C_{\\text{right}}$), the physical solution is monotonically decreasing.\n    -   Oscillation Amplitude $A$: A float in $\\mathrm{kg}/\\mathrm{m}^3$. $A = \\max\\{0,\\,\\max_i (C_{i+1} - C_i)\\}$.\n-   **Test Suite (all in SI units)**:\n    -   Test case 1: $L = 1$, $N = 50$, $u = 0.2$, $K_T = 0.05$, $C_{\\text{left}} = 1$, $C_{\\text{right}} = 0$.\n    -   Test case 2: $L = 1$, $N = 50$, $u = 2.0$, $K_T = 0.01$, $C_{\\text{left}} = 1$, $C_{\\text{right}} = 0$.\n    -   Test case 3: $L = 1$, $N = 50$, $u = 10.0$, $K_T = 0.001$, $C_{\\text{left}} = 1$, $C_{\\text{right}} = 0$.\n    -   Test case 4: $L = 1$, $N = 10$, $u = -2.0$, $K_T = 0.01$, $C_{\\text{left}} = 1$, $C_{\\text{right}} = 0$.\n-   **Required Output**: For each test case, a list of five values: $[\\mathrm{Pe}_h,\\, M_{\\text{central}},\\, M_{\\text{upwind}},\\, A_{\\text{central}},\\, A_{\\text{upwind}}]$.\n\n#### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem is based on the standard advection-dispersion equation, a fundamental concept in transport phenomena, fluid dynamics, and environmental science. The numerical methods proposed (central and upwind differencing) are standard techniques for discretizing this equation. The cell Péclet number is a standard dimensionless group used to characterize the relative importance of advection to diffusion and to predict the stability of numerical schemes. The premise that central differencing can fail for $\\mathrm{Pe}_h  2$ is a well-established result in numerical fluid dynamics. The parameters are scientifically plausible.\n-   **Well-Posed**: The problem is a boundary value problem for a second-order linear ordinary differential equation. With Dirichlet boundary conditions at both ends, the problem is well-posed and has a unique analytical solution. The numerical problem involves solving a linear system, which is also well-posed, particularly for the upwind scheme which guarantees a diagonally dominant matrix.\n-   **Objective**: The problem is stated in precise, mathematical language. It requires a purely computational demonstration based on objective, quantitative metrics ($M$ and $A$).\n-   **Completeness and Consistency**: The problem provides all necessary data and definitions to construct and solve the linear systems and compute the required metrics. The governing equation, boundary conditions, discretization methods, and test parameters are all explicitly defined. The initial concern about the monotonicity for case 4 (with $u  0$) was resolved by examining the analytical solution, which confirms that the solution profile is indeed monotonically decreasing even with negative velocity, given the specified boundary conditions $C(0)  C(L)$. Thus, the definitions of metrics $M$ and $A$ are consistent and meaningful for all test cases.\n\nThe problem is free of the listed invalidity flaws. It is a standard, well-posed problem in computational fluid dynamics.\n\n#### Step 3: Verdict and Action\n\nThe problem is **valid**. I will proceed with the solution.\n\n### Solution\n\nThe task is to solve the one-dimensional steady advection-dispersion equation and analyze the numerical solution's behavior for two different discretization schemes for the advection term. The governing equation is:\n$$ K_T\\,\\frac{d^2 C}{dx^2} - u\\,\\frac{dC}{dx} = 0 $$\nLet the grid points be $x_i = (i-1)h$ for $i=1, \\dots, N$, where $h = L/(N-1)$. The concentration at these points is denoted by $C_i = C(x_i)$. The boundary values are known: $C_1 = C_{\\text{left}}$ and $C_N = C_{\\text{right}}$. We need to find the concentrations $C_2, \\dots, C_{N-1}$ at the $N-2$ interior points.\n\nAt any interior node $x_i$, we discretize the derivatives. The second-order central difference for the diffusive term is:\n$$ \\frac{d^2 C}{dx^2}\\bigg|_{x_i} \\approx \\frac{C_{i+1} - 2C_i + C_{i-1}}{h^2} $$\n\n#### 1. Central Differencing Scheme\n\nThe advection term is discretized using a second-order central difference:\n$$ \\frac{dC}{dx}\\bigg|_{x_i} \\approx \\frac{C_{i+1} - C_{i-1}}{2h} $$\nSubstituting these into the governing equation gives:\n$$ K_T \\left(\\frac{C_{i+1} - 2C_i + C_{i-1}}{h^2}\\right) - u \\left(\\frac{C_{i+1} - C_{i-1}}{2h}\\right) = 0 $$\nMultiplying by $h^2$ and rearranging terms to group by $C_j$:\n$$ (K_T + \\frac{uh}{2})C_{i-1} - 2K_T C_i + (K_T - \\frac{uh}{2})C_{i+1} = 0 $$\nThis equation holds for each interior node $i = 2, \\dots, N-1$. This forms a system of $N-2$ linear equations for the $N-2$ unknown interior concentrations. The structure is tridiagonal:\n$$ a_i C_{i-1} + b_i C_i + c_i C_{i+1} = 0 $$\nwhere $a_i = K_T + \\frac{uh}{2}$, $b_i = -2K_T$, and $c_i = K_T - \\frac{uh}{2}$.\n\nThe well-known stability condition for this scheme to avoid oscillations is that the cell Péclet number $\\mathrm{Pe}_h = |u|h/K_T$ must be less than or equal to $2$. If $\\mathrm{Pe}_h  2$, the coefficient $c_i$ (for $u0$) or $a_i$ (for $u0$) becomes negative, which can lead to non-physical oscillations, as the matrix of the linear system is no longer guaranteed to be an M-matrix.\n\n#### 2. First-Order Upwind Scheme\n\nThis scheme uses a one-sided difference for the advection term, chosen based on the direction of flow (the sign of $u$).\n-   **If $u  0$ (flow from left to right):** Use a backward difference, as information is coming from the upstream node $i-1$.\n    $$ \\frac{dC}{dx}\\bigg|_{x_i} \\approx \\frac{C_i - C_{i-1}}{h} $$\n    The discretized equation becomes:\n    $$ K_T \\left(\\frac{C_{i+1} - 2C_i + C_{i-1}}{h^2}\\right) - u \\left(\\frac{C_i - C_{i-1}}{h}\\right) = 0 $$\n    Grouping terms:\n    $$ (K_T + uh)C_{i-1} - (2K_T + uh)C_i + K_T C_{i+1} = 0 $$\n    The coefficients are $a_i = K_T + uh$, $b_i = -(2K_T + uh)$, and $c_i = K_T$.\n-   **If $u  0$ (flow from right to left):** Use a forward difference, as information comes from the upstream node $i+1$.\n    $$ \\frac{dC}{dx}\\bigg|_{x_i} \\approx \\frac{C_{i+1} - C_i}{h} $$\n    The discretized equation becomes:\n    $$ K_T \\left(\\frac{C_{i+1} - 2C_i + C_{i-1}}{h^2}\\right) - u \\left(\\frac{C_{i+1} - C_i}{h}\\right) = 0 $$\n    Grouping terms:\n    $$ K_T C_{i-1} - (2K_T - uh)C_i + (K_T - uh)C_{i+1} = 0 $$\n    The coefficients are $a_i = K_T$, $b_i = -(2K_T - uh)$, and $c_i = K_T - uh$.\n-   **If $u = 0$**: The advection term vanishes, and both schemes reduce to the pure diffusion equation.\n\nThe upwind scheme is unconditionally stable and will not produce spurious oscillations, though it is only first-order accurate and introduces numerical diffusion.\n\n#### 3. Assembling and Solving the Linear System\n\nFor both schemes, we have a system of $N-2$ linear equations of the form $a C_{i-1} + b C_i + c C_{i+1} = 0$ for $i=2, \\dots, N-1$. We must incorporate the boundary conditions.\n-   For the first interior node ($i=2$): $a C_1 + b C_2 + c C_3 = 0$. Since $C_1 = C_{\\text{left}}$ is known, we move this term to the right-hand side: $b C_2 + c C_3 = -a C_{\\text{left}}$.\n-   For the last interior node ($i=N-1$): $a C_{N-2} + b C_{N-1} + c C_N = 0$. Since $C_N = C_{\\text{right}}$ is known, we have: $a C_{N-2} + b C_{N-1} = -c C_{\\text{right}}$.\n\nThis forms a tridiagonal linear system $\\mathbf{A} \\mathbf{C}_{\\text{int}} = \\mathbf{d}$, where $\\mathbf{C}_{\\text{int}} = [C_2, \\dots, C_{N-1}]^T$ is the vector of unknowns. The matrix $\\mathbf{A}$ has diagonals formed by the coefficients $a, b, c$, and the right-hand side vector $\\mathbf{d}$ contains the boundary terms. This system can be solved using a standard linear algebra library routine.\n\n#### 4. Computing the Metrics\n\nOnce the full concentration vector $\\mathbf{C} = [C_1, \\dots, C_N]^T$ is obtained, the required metrics are computed:\n-   $\\mathrm{Pe}_h = |u|h/K_T$.\n-   $M$: The monotonicity flag is set to `True` if $C_{i+1} - C_i \\le 10^{-10}$ for all $i=1, \\dots, N-1$.\n-   $A$: The oscillation amplitude is calculated as $\\max(0, \\max(C_{i+1} - C_i))$ over all $i=1, \\dots, N-1$.\n\nThe following code implements this procedure for the given test cases.",
            "answer": "[[0.08163265306122448, True, True, 0.0, 0.0],[4.081632653061224, False, True, 0.03846153846153843, 0.0],[204.0816326530612, False, True, 0.5, 0.0],[22.22222222222222, False, True, 1.2500000000000009, 0.0]]"
        }
    ]
}