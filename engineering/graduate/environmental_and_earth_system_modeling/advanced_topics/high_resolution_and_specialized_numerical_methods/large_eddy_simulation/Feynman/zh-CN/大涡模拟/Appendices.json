{
    "hands_on_practices": [
        {
            "introduction": "大涡模拟的核心在于对未解析的次网格尺度（SGS）运动进行建模。本实践将从最基础也是最经典的 Smagorinsky 模型入手，引导你亲手实现这一闭合方案。通过为给定的解析尺度应变率张量计算关键的涡粘性系数 $ \\nu_t $ 和次网格尺度耗散 $ \\varepsilon_{\\mathrm{sgs}} $，你将深入理解模型如何参数化湍流效应，并确保能量从解析尺度向未解析尺度正确传递 。",
            "id": "4058479",
            "problem": "您的任务是实现一个计算模块，该模块以一个完整且可运行的程序形式表达，在与数值天气预报和气候模拟相关的大涡模拟 (LES) 中，对剪切驱动流应用 Smagorinsky 亚网格尺度闭合。从不可压流的滤波动量方程和已解析应变率的定义出发，从第一性原理推导出在离散采样点计算湍流涡粘性和单位质量的亚网格尺度耗散所需的表达式。然后，程序必须将这些表达式应用于一个明确定义的测试套件，并以指定的确切格式生成输出。\n\n使用以下基本依据和定义：\n- 从滤波后的不可压 Navier–Stokes 方程和亚网格尺度 (SGS) 应力张量的定义开始。滤波后的动量方程引入了一个 SGS 应力 $ \\tau_{ij} $，表示未解析尺度对已解析尺度的影响。\n- 已解析对称应变率张量定义为 $ S_{ij} = \\tfrac{1}{2}\\left( \\partial u_i / \\partial x_j + \\partial u_j / \\partial x_i \\right) $，其第二不变量为 $ S_{ij} S_{ij} $。\n- 对于各向异性网格，有效滤波宽度为 $ \\Delta = (\\Delta_x \\Delta_y \\Delta_z)^{1/3} $，以米为单位，这是一个广泛使用的几何平均值，与大涡模拟 (LES) 中的三维顶帽滤波器一致。\n\n您的程序应实现以下任务：\n1. 基于与 Smagorinsky 模型一致的混合长度理论，从第一性原理推导出一个计算湍流涡粘性 $ \\nu_t $ 的算法，该算法用常数 Smagorinsky 系数 $ C_s $、有效滤波宽度 $ \\Delta $ 和已解析应变率张量 $ S_{ij} $ 的不变量大小表示。不要假设任何简化公式；推导必须遵循量纲分析和针对亚网格尺度 (SGS) 应力偏量部分的涡粘性闭合。\n2. 从推导出的闭合模型中，获得单位质量的亚网格尺度耗散 $ \\varepsilon_{\\mathrm{sgs}} $ 的表达式，其定义为 $ -\\tau_{ij} S_{ij} $，确保在该闭合模型下耗散特性得以保持，并正确考虑了各向同性部分的贡献。\n\n单位和输出要求：\n- 所有给定和计算的量必须统一使用国际单位制 (SI)。应变率分量 $ S_{ij} $ 的单位是 $ \\mathrm{s}^{-1} $，网格间距 $ \\Delta_x $、$ \\Delta_y $、$ \\Delta_z $ 的单位是 $ \\mathrm{m} $，Smagorinsky 系数 $ C_s $ 是无量纲的，涡粘性 $ \\nu_t $ 必须以 $ \\mathrm{m}^2\\,\\mathrm{s}^{-1} $ 表示，单位质量的耗散 $ \\varepsilon_{\\mathrm{sgs}} $ 必须以 $ \\mathrm{m}^2\\,\\mathrm{s}^{-3} $ 表示。\n- 本问题不涉及角度。\n- 您的最终数值输出必须四舍五入到六位小数。\n\n测试套件：\n为以下五个独立情况中的每一个计算 $ \\nu_t $ 和 $ \\varepsilon_{\\mathrm{sgs}} $。每个情况提供一个采样点的对称已解析应变率张量 $ S_{ij} $ 和网格间距，以及 Smagorinsky 系数 $ C_s $：\n- 情况 $A$ (一般剪切，各向异性网格)：\n  - $ \\Delta_x = 10\\,\\mathrm{m} $，$ \\Delta_y = 10\\,\\mathrm{m} $，$ \\Delta_z = 5\\,\\mathrm{m} $，$ C_s = 0.17 $。\n  - $ S_{ij} $ 分量，单位为 $ \\mathrm{s}^{-1} $：$ S_{11} = 0 $，$ S_{22} = 0 $，$ S_{33} = 0 $，$ S_{12} = S_{21} = 0.5 $，$ S_{23} = S_{32} = 0.2 $，$ S_{13} = S_{31} = 0 $。\n- 情况 $B$ (零应变边界情况)：\n  - $ \\Delta_x = 20\\,\\mathrm{m} $，$ \\Delta_y = 20\\,\\mathrm{m} $，$ \\Delta_z = 20\\,\\mathrm{m} $，$ C_s = 0.17 $。\n  - $ S_{ij} $ 分量：所有条目均为 $ 0\\,\\mathrm{s}^{-1} $。\n- 情况 $C$ (强各向异性与更强剪切)：\n  - $ \\Delta_x = 50\\,\\mathrm{m} $，$ \\Delta_y = 50\\,\\mathrm{m} $，$ \\Delta_z = 5\\,\\mathrm{m} $，$ C_s = 0.17 $。\n  - $ S_{ij} $ 分量：$ S_{11} = 0 $，$ S_{22} = 0 $，$ S_{33} = 0 $，$ S_{12} = S_{21} = 1.0 $，$ S_{23} = S_{32} = -0.5 $，$ S_{13} = S_{31} = 0.3 $。\n- 情况 $D$ (细化的各向同性网格与中等剪切)：\n  - $ \\Delta_x = 1\\,\\mathrm{m} $，$ \\Delta_y = 1\\,\\mathrm{m} $，$ \\Delta_z = 1\\,\\mathrm{m} $，$ C_s = 0.17 $。\n  - $ S_{ij} $ 分量：$ S_{11} = 0 $，$ S_{22} = 0 $，$ S_{33} = 0 $，$ S_{12} = S_{21} = 0.4 $，$ S_{23} = S_{32} = 0.1 $，$ S_{13} = S_{31} = 0 $。\n- 情况 $E$ (Smagorinsky 系数变化与混合剪切)：\n  - $ \\Delta_x = 10\\,\\mathrm{m} $，$ \\Delta_y = 15\\,\\mathrm{m} $，$ \\Delta_z = 7.5\\,\\mathrm{m} $，$ C_s = 0.23 $。\n  - $ S_{ij} $ 分量：$ S_{11} = 0 $，$ S_{22} = 0 $，$ S_{33} = 0 $，$ S_{12} = S_{21} = 0.6 $，$ S_{23} = S_{32} = 0.3 $，$ S_{13} = S_{31} = 0.2 $。\n\n程序输出规范：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个元素对应一种情况，并且必须是一个双元素列表 $ [\\nu_t, \\varepsilon_{\\mathrm{sgs}}] $，两个值均四舍五入到六位小数，单位为国际单位制，例如：$ [[\\nu_{t,A},\\varepsilon_{\\mathrm{sgs},A}],[\\nu_{t,B},\\varepsilon_{\\mathrm{sgs},B}],\\dots] $。",
            "solution": "我们从适用于大涡模拟 (LES) 的滤波后不可压 Navier–Stokes 方程开始。对动量方程进行滤波会产生一个涉及亚网格尺度 (SGS) 应力张量 $ \\tau_{ij} = \\overline{u_i u_j} - \\overline{u}_i \\, \\overline{u}_j $ 的项，其中上划线表示滤波。已解析速度 $ \\overline{u}_i $ 的滤波方程包含 $ \\partial_j \\tau_{ij} $ 项，需要一个闭合模型。\n\n已解析对称应变率张量定义为\n$$\nS_{ij} = \\frac{1}{2}\\left( \\frac{\\partial \\overline{u}_i}{\\partial x_j} + \\frac{\\partial \\overline{u}_j}{\\partial x_i} \\right),\n$$\n单位为 $ \\mathrm{s}^{-1} $。一个物理上一致的涡粘性闭合将 SGS 应力张量的偏量部分建模为与已解析应变率成正比：\n$$\n\\tau_{ij} - \\frac{1}{3}\\tau_{kk}\\delta_{ij} = -2 \\nu_t S_{ij},\n$$\n其中 $ \\nu_t $ 是涡粘性。该闭合模型强制了对称性，并确保 $ \\tau_{ij} $ 与 $ S_{ij} $ 对齐，这与未解析的运动对已解析场起到有效粘性作用的思想一致。\n\n量纲分析和混合长度理论为涡粘性的 Smagorinsky 形式提供了依据。混合长度 $ \\ell_s $ 被认为与滤波宽度成比例，即 $ \\ell_s = C_s \\Delta $，其中 $ C_s $ 是一个无量纲的 Smagorinsky 系数，$ \\Delta $ 是有效滤波宽度。对于各向异性网格，一个与三维顶帽滤波器一致且被广泛使用的 $ \\Delta $ 选择是\n$$\n\\Delta = (\\Delta_x \\Delta_y \\Delta_z)^{1/3}.\n$$\n涡粘性的单位必须是 $ \\mathrm{m}^2\\,\\mathrm{s}^{-1} $，将长度尺度 $ \\ell_s $ 与从 $ S_{ij} $ 导出的速度梯度尺度相结合，得到\n$$\n\\nu_t \\propto \\ell_s^2 \\, \\left| S \\right|.\n$$\n为了从张量 $ S_{ij} $ 构建一个标量大小，我们使用基于应变率第二张量不变量的不变量：\n$$\n\\left| S \\right| = \\sqrt{2 S_{ij} S_{ij}},\n$$\n其中 $ S_{ij} S_{ij} = \\sum_{i=1}^{3}\\sum_{j=1}^{3} S_{ij}^2 $ 是双重缩并，因子 $ 2 $ 是常规做法，使得 $ \\left| S \\right| $ 在简单剪切中简化为绝对剪切率，并保持旋转不变性。因此，Smagorinsky 涡粘性变为\n$$\n\\nu_t = (C_s \\Delta)^2 \\, \\sqrt{2 S_{ij} S_{ij}}.\n$$\n\n接下来，我们考虑单位质量的亚网格尺度耗散。已解析动能方程包含 SGS 耗散项\n$$\n\\varepsilon_{\\mathrm{sgs}} = -\\tau_{ij} S_{ij}.\n$$\n代入偏量闭合模型，并注意到各向同性部分 $ \\tfrac{1}{3}\\tau_{kk}\\delta_{ij} $ 对 $ -\\tau_{ij} S_{ij} $ 没有贡献（因为 $ \\delta_{ij} S_{ij} = S_{kk} $，而对于不可压已解析流，$ S_{kk} = 0 $），我们得到\n$$\n\\varepsilon_{\\mathrm{sgs}} = -\\left( -2 \\nu_t S_{ij} \\right) S_{ij} = 2 \\nu_t S_{ij} S_{ij}.\n$$\n该表达式是严格非负的，因为 $ \\nu_t \\ge 0 $ 且 $ S_{ij} S_{ij} \\ge 0 $，从而强制了 SGS 闭合的耗散性质。\n\n每个测试用例的算法步骤：\n1. 使用提供的网格间距 $ \\Delta_x $、$ \\Delta_y $、$ \\Delta_z $ 计算有效滤波宽度 $ \\Delta = (\\Delta_x \\Delta_y \\Delta_z)^{1/3} $。\n2. 从给定的对称 $ S_{ij} $ 计算不变量 $ S_{ij} S_{ij} = \\sum_{i=1}^{3}\\sum_{j=1}^{3} S_{ij}^2 $。\n3. 计算 $ \\left| S \\right| = \\sqrt{2 S_{ij} S_{ij}} $。\n4. 计算涡粘性 $ \\nu_t = (C_s \\Delta)^2 \\left| S \\right| $，单位为 $ \\mathrm{m}^2\\,\\mathrm{s}^{-1} $。\n5. 计算单位质量的亚网格尺度耗散 $ \\varepsilon_{\\mathrm{sgs}} = 2 \\nu_t S_{ij} S_{ij} $，单位为 $ \\mathrm{m}^2\\,\\mathrm{s}^{-3} $。\n6. 将 $ \\nu_t $ 和 $ \\varepsilon_{\\mathrm{sgs}} $ 都四舍五入到六位小数以供输出。\n\n科学真实性与边界情况行为：\n- 在情况 $B$ 中，$ S_{ij} = 0 $ 意味着 $ \\nu_t = 0 $ 和 $ \\varepsilon_{\\mathrm{sgs}} = 0 $，这与没有剪切时的情况相符。\n- 在情况 $C$ 中，大的 $ \\Delta_x $ 和 $ \\Delta_y $ 以及小的 $ \\Delta_z $ 导致的强各向异性增大了 $ \\Delta $，从而在强剪切下增加了 $ \\nu_t $ 和 $ \\varepsilon_{\\mathrm{sgs}} $。\n- 在情况 $D$ 中，细化的网格减小了 $ \\Delta $，对于相同的已解析应变，减小了 $ \\nu_t $ 和 $ \\varepsilon_{\\mathrm{sgs}} $，这反映了分辨率的提高和 SGS 活动的减弱。\n- 在情况 $E$ 中，较大的 $ C_s $ 增加了混合长度 $ \\ell_s $，因此同时增加了 $ \\nu_t $ 和 $ \\varepsilon_{\\mathrm{sgs}} $，这说明了参数的敏感性。\n\n该程序为五个指定情况实现了这些步骤，并打印单行输出，其中包含一个包含五个双元素列表 $ [\\nu_t, \\varepsilon_{\\mathrm{sgs}}] $ 的列表，每个值都四舍五入到六位小数，单位按要求默认为国际单位制。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_nu_t_and_epsilon(S, dx, dy, dz, Cs):\n    \"\"\"\n    Compute eddy viscosity nu_t and SGS dissipation epsilon_sgs\n    for a given symmetric strain-rate tensor S, grid spacings, and Smagorinsky coefficient.\n\n    Parameters:\n    - S: 3x3 numpy array for S_ij components [1/s]\n    - dx, dy, dz: grid spacings [m]\n    - Cs: Smagorinsky coefficient (dimensionless)\n\n    Returns:\n    - nu_t [m^2/s]\n    - epsilon_sgs [m^2/s^3]\n    \"\"\"\n    # Effective filter width using geometric mean for anisotropic grid\n    Delta = (dx * dy * dz) ** (1.0 / 3.0)\n\n    # Invariant S_ij S_ij = sum_{i,j} S_ij^2\n    s2 = float(np.sum(S**2))\n\n    # |S| = sqrt(2 * S_ij S_ij)\n    S_mag = np.sqrt(2.0 * s2)\n\n    # Eddy viscosity nu_t = (Cs * Delta)^2 * |S|\n    mixing_length_sq = (Cs * Delta) ** 2\n    nu_t = mixing_length_sq * S_mag\n\n    # Subgrid-scale dissipation per unit mass: epsilon_sgs = 2 * nu_t * (S_ij S_ij)\n    epsilon_sgs = 2.0 * nu_t * s2\n\n    return nu_t, epsilon_sgs\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (S matrix, dx, dy, dz, Cs)\n    test_cases = [\n        # Case A: general shear, anisotropic grid\n        (\n            np.array([\n                [0.0, 0.5, 0.0],\n                [0.5, 0.0, 0.2],\n                [0.0, 0.2, 0.0]\n            ], dtype=float),\n            10.0, 10.0, 5.0, 0.17\n        ),\n        # Case B: zero strain edge case\n        (\n            np.zeros((3,3), dtype=float),\n            20.0, 20.0, 20.0, 0.17\n        ),\n        # Case C: strong anisotropy and stronger shear\n        (\n            np.array([\n                [0.0,  1.0,  0.3],\n                [1.0,  0.0, -0.5],\n                [0.3, -0.5,  0.0]\n            ], dtype=float),\n            50.0, 50.0, 5.0, 0.17\n        ),\n        # Case D: refined isotropic grid with moderate shear\n        (\n            np.array([\n                [0.0, 0.4, 0.0],\n                [0.4, 0.0, 0.1],\n                [0.0, 0.1, 0.0]\n            ], dtype=float),\n            1.0, 1.0, 1.0, 0.17\n        ),\n        # Case E: variation in C_s and mixed shear\n        (\n            np.array([\n                [0.0, 0.6, 0.2],\n                [0.6, 0.0, 0.3],\n                [0.2, 0.3, 0.0]\n            ], dtype=float),\n            10.0, 15.0, 7.5, 0.23\n        ),\n    ]\n\n    results_str = []\n\n    for S, dx, dy, dz, Cs in test_cases:\n        nu_t, epsilon_sgs = compute_nu_t_and_epsilon(S, dx, dy, dz, Cs)\n        # Round to six decimal places and format without spaces\n        nu_t_str = f\"{nu_t:.6f}\"\n        epsilon_str = f\"{epsilon_sgs:.6f}\"\n        results_str.append(f\"[{nu_t_str},{epsilon_str}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "标准的 Smagorinsky 模型使用一个恒定的模型系数，这限制了其在复杂流动中的适用性。为了克服这一缺陷，动态模型应运而生，它利用 Germano 恒等式在模拟过程中动态计算模型系数。本练习将带你实现动态 Smagorinsky 模型的核心算法——通过最小二乘法从解析的应力张量中求解模型系数 $ C_s^2 $ ，让你掌握这一高级建模技术的关键步骤。",
            "id": "3888513",
            "problem": "考虑一个用于环境与地球系统建模中不可压缩湍流的动态大涡模拟 (LES) 框架。滤波后的动量方程意味着存在一个必须被建模的残余亚格子应力。在 Smagorinsky 闭合模型中，亚格子涡粘性被建模为 $\\nu_t = C_s^2 \\Delta^2 |S|$，其中 $C_s^2$ 是一个无量纲模型系数，$\\Delta$ 是以 $\\mathrm{m}$ 为单位的网格滤波宽度，而 $|S|$ 表示可解尺度应变率张量 $S_{ij}$ 的大小。$S_{ij}$ 由可解滤波速度场定义为 $S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\tilde{u}_i}{\\partial x_j} + \\frac{\\partial \\tilde{u}_j}{\\partial x_i}\\right)$（单位为 $\\mathrm{s}^{-1}$），且 $|S| = \\sqrt{2 S_{ij} S_{ij}}$（单位为 $\\mathrm{s}^{-1}$）。\n\n使用宽度为 $\\tilde{\\Delta}$（单位为 $\\mathrm{m}$）的测试滤波器，Germano 恒等式提供了一个可解 Leonard 应力 $L_{ij}$。在网格和测试滤波两个尺度上都采用类 Smagorinsky 闭合模型的情况下，该应力满足以下关系式\n$$\nL_{ij} = 2\\left(C_s \\Delta\\right)^2 |S|\\, S_{ij} - 2\\left(C_s \\tilde{\\Delta}\\right)^2 |\\tilde{S}|\\, \\tilde{S}_{ij},\n$$\n其中 $\\tilde{S}_{ij}$ 是测试滤波尺度上的应变率张量，且 $|\\tilde{S}| = \\sqrt{2 \\tilde{S}_{ij} \\tilde{S}_{ij}}$。定义 $M_{ij} = 2\\left(\\Delta^2 |S|\\, S_{ij} - \\tilde{\\Delta}^2 |\\tilde{S}|\\, \\tilde{S}_{ij}\\right)$（单位为 $\\mathrm{m}^2 \\mathrm{s}^{-2}$）。接下来的任务是通过最小化建模的 Leonard 应力与可解 Leonard 应力之间的最小二乘不匹配来计算 $C_s^2$，即确定能使下式最小化的 $C_s^2$ 的值\n$$\nJ(C_s^2) = \\sum_{i=1}^{3}\\sum_{j=1}^{3} \\left(L_{ij} - C_s^2 M_{ij}\\right)^2.\n$$\n\n你的程序必须：\n- 根据给定的 $S_{ij}$ 和 $\\tilde{S}_{ij}$ 实现 $|S|$ 和 $|\\tilde{S}|$ 的计算。\n- 根据 $\\Delta$、$\\tilde{\\Delta}$、 $|S|$、 $|\\tilde{S}|$、$S_{ij}$ 和 $\\tilde{S}_{ij}$ 构建 $M_{ij}$。\n- 对于给定的 $L_{ij}$、$S_{ij}$ 和 $\\tilde{S}_{ij}$，计算最小二乘极小化子 $C_s^2$ 作为使 $J(C_s^2)$ 最小化的值。\n- 处理 $\\sum_{i,j} M_{ij}^2$ 为零或低于一个小容差的退化情况，此时应返回 $C_s^2 = 0$。\n\n所有输入和输出都必须遵守物理单位。具体来说，$S_{ij}$ 和 $\\tilde{S}_{ij}$ 的单位是 $\\mathrm{s}^{-1}$，$\\Delta$ 和 $\\tilde{\\Delta}$ 的单位是 $\\mathrm{m}$，$L_{ij}$ 和 $M_{ij}$ 的单位是 $\\mathrm{m}^2 \\mathrm{s}^{-2}$。计算出的 $C_s^2$ 必须作为一个无量纲浮点数报告。\n\n测试套件：\n使用以下四个测试用例，它们共同涵盖了一个通用情况、一个含噪声情况、一个退化情况和一个符号不定的情况。\n\n- 用例 1（通用“理想”路径）：\n  - $\\Delta = 10\\,\\mathrm{m}$，$\\tilde{\\Delta} = 20\\,\\mathrm{m}$。\n  - $S = \\begin{pmatrix} 0.06  0.02  -0.01 \\\\ 0.02  -0.03  0.03 \\\\ -0.01  0.03  -0.03 \\end{pmatrix}\\,\\mathrm{s}^{-1}$。\n  - $\\tilde{S} = \\begin{pmatrix} 0.054  0.018  -0.008 \\\\ 0.018  -0.028  0.025 \\\\ -0.008  0.025  -0.026 \\end{pmatrix}\\,\\mathrm{s}^{-1}$。\n  - 使用名义系数 $C_s^2 = 0.09$ 和给定关系式，根据上述数据构造 $L_{ij}$。\n- 用例 2（含噪声的 Leonard 应力）：\n  - 与用例 1 相同的 $\\Delta$、$\\tilde{\\Delta}$、$S$ 和 $\\tilde{S}$。\n  - 与用例 1 一样，使用 $C_s^2 = 0.09$ 构造 $L_{ij}$，然后加上一个固定的噪声矩阵 $E$（单位为 $\\mathrm{m}^2 \\mathrm{s}^{-2}$），定义为\n    $E = \\begin{pmatrix} 1\\times 10^{-3}  -2\\times 10^{-4}  3\\times 10^{-4} \\\\ -2\\times 10^{-4}  5\\times 10^{-4}  -1\\times 10^{-4} \\\\ 3\\times 10^{-4}  -1\\times 10^{-4}  -6\\times 10^{-4} \\end{pmatrix}$,\n    使得 $L_{ij} \\leftarrow L_{ij} + E_{ij}$。\n- 用例 3（退化的 $M_{ij}$）：\n  - $\\Delta = 10\\,\\mathrm{m}$，$\\tilde{\\Delta} = 20\\,\\mathrm{m}$。\n  - $S = \\begin{pmatrix} 0.02  0.01  0.00 \\\\ 0.01  -0.015  0.005 \\\\ 0.00  0.005  -0.005 \\end{pmatrix}\\,\\mathrm{s}^{-1}$。\n  - $\\tilde{S} = 0.5 S$（即 $\\tilde{S}$ 的每个分量等于 $S$ 相应分量的 $0.5$ 倍）。\n  - 设 $L_{ij} = 0$（零矩阵），这在给定的构造下与 $M_{ij} = 0$ 一致。\n- 用例 4（符号不定的“反向散射”）：\n  - $\\Delta = 10\\,\\mathrm{m}$，$\\tilde{\\Delta} = 20\\,\\mathrm{m}$。\n  - 与用例 1 相同的 $S$ 和 $\\tilde{S}$。\n  - 使用名义系数 $C_s^2 = -0.04$ 构造 $L_{ij}$，以测试负的最小二乘极小化子。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，按用例 1 至 4 的顺序排列，即 $[C_{s,1}^2,C_{s,2}^2,C_{s,3}^2,C_{s,4}^2]$。每个条目必须是一个浮点数，代表相应情况下计算出的 $C_s^2$（无量纲）。",
            "solution": "该问题已经过验证，被认为是有效的。它在科学上基于大涡模拟 (LES) 的湍流建模原理，特别是动态 Smagorinsky 模型。该问题是适定的、数学上一致的，并提供了所有必需的数据和定义。\n\n目标是找到无量纲模型系数 $C_s^2$，以最小化可解 Leonard 应力 $L_{ij}$ 与其模型 $C_s^2 M_{ij}$ 之间的最小二乘误差。需要最小化的量由下式给出：\n$$\nJ(C_s^2) = \\sum_{i=1}^{3}\\sum_{j=1}^{3} \\left(L_{ij} - C_s^2 M_{ij}\\right)^2\n$$\n为了找到使该平方和最小化的 $C_s^2$ 的值，我们必须求出 $J$ 对 $C_s^2$ 的导数的根。为方便表示，令 $c = C_s^2$。目标函数为 $J(c) = \\sum_{i,j} (L_{ij} - c M_{ij})^2$。我们将 $J(c)$ 对 $c$ 求导，并令结果为零：\n$$\n\\frac{dJ}{dc} = \\sum_{i=1}^{3}\\sum_{j=1}^{3} \\frac{d}{dc} \\left(L_{ij} - c M_{ij}\\right)^2 = 0\n$$\n应用链式法则：\n$$\n\\sum_{i,j} 2 \\left(L_{ij} - c M_{ij}\\right) \\cdot (-M_{ij}) = 0\n$$\n分配各项：\n$$\n-2 \\sum_{i,j} L_{ij} M_{ij} + 2c \\sum_{i,j} M_{ij}^2 = 0\n$$\n求解 $c$：\n$$\nc \\sum_{i,j} M_{ij}^2 = \\sum_{i,j} L_{ij} M_{ij}\n$$\n在 $\\sum_{i,j} M_{ij}^2 \\neq 0$ 的条件下，我们可以将解写为：\n$$\nc = C_s^2 = \\frac{\\sum_{i,j} L_{ij} M_{ij}}{\\sum_{i,j} M_{ij}^2}\n$$\n这个表达式是线性最小二乘问题的经典解。用矩阵运算的术语来说，分子 $\\sum_{i,j} L_{ij} M_{ij}$ 是张量 $L$ 和 $M$ 的 Frobenius 内积，记为 $\\langle L, M \\rangle_F$。分母 $\\sum_{i,j} M_{ij}^2$ 是张量 $M$ 的 Frobenius 范数的平方，记为 $||M||_F^2$。因此，解可以紧凑地写为：\n$$\nC_s^2 = \\frac{\\langle L, M \\rangle_F}{||M||_F^2}\n$$\n每个测试用例的计算过程如下：\n1.  给定网格滤波宽度 $\\Delta$、测试滤波宽度 $\\tilde{\\Delta}$、可解尺度应变率张量 $S_{ij}$ 和测试滤波后的应变率张量 $\\tilde{S}_{ij}$。\n2.  计算应变率张量的大小。大小 $|S|$ 定义为 $|S| = \\sqrt{2S_{ij}S_{ij}}$，这里隐含了对重复指标的求和。这对应于 $|S| = \\sqrt{2 \\sum_{i,j} S_{ij}^2}$。类似地， $|\\tilde{S}| = \\sqrt{2 \\sum_{i,j} \\tilde{S}_{ij}^2}$。\n3.  使用其定义构造张量 $M_{ij}$：\n    $$\n    M_{ij} = 2\\left(\\Delta^2 |S|\\, S_{ij} - \\tilde{\\Delta}^2 |\\tilde{S}|\\, \\tilde{S}_{ij}\\right)\n    $$\n    此计算所需的所有输入，即 $\\Delta$、$\\tilde{\\Delta}$、$S_{ij}$ 和 $\\tilde{S}_{ij}$，均在每个测试用例中提供。\n4.  对于每个测试用例，Leonard 应力张量 $L_{ij}$ 也被指定，它要么通过名义 $C_s^2$ 构造，要么直接给出。\n5.  计算分母项 $D = \\sum_{i,j} M_{ij}^2$。问题规定，如果 $D$ 为零或低于一个小的数值容差，则该情况为退化情况，结果应为 $C_s^2 = 0$。\n6.  如果 $D$ 大于容差，则计算分子项 $N = \\sum_{i,j} L_{ij} M_{ij}$。\n7.  该测试用例的最终结果是 $C_s^2 = N/D$。\n\n此算法应用于问题陈述中指定的四个测试用例中的每一个。这些用例旨在测试通用功能（用例 1）、对噪声的鲁棒性（用例 2）、退化条件的处理（用例 3）以及出现负系数（反向散射）的可能性（用例 4）。用例 3 的构造使得 $M_{ij}$ 为零张量，从而触发退化条件处理器。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Smagorinsky coefficient C_s^2 for four test cases\n    based on the dynamic LES procedure.\n    \"\"\"\n\n    def calculate_cs_squared(delta, delta_tilde, S, S_tilde, L, tol=1e-20):\n        \"\"\"\n        Calculates the Smagorinsky coefficient C_s^2 using a least-squares minimization.\n        \"\"\"\n        S_mag = np.sqrt(2 * np.sum(S**2))\n        S_tilde_mag = np.sqrt(2 * np.sum(S_tilde**2))\n\n        M = 2 * (delta**2 * S_mag * S - delta_tilde**2 * S_tilde_mag * S_tilde)\n        \n        numerator = np.sum(L * M)\n        denominator = np.sum(M**2)\n\n        if abs(denominator)  tol:\n            return 0.0\n        \n        return numerator / denominator\n\n    results = []\n    \n    # Common data for cases 1, 2, 4\n    delta_common, delta_tilde_common = 10.0, 20.0\n    S_common = np.array([[0.06, 0.02, -0.01], [0.02, -0.03, 0.03], [-0.01, 0.03, -0.03]])\n    S_tilde_common = np.array([[0.054, 0.018, -0.008], [0.018, -0.028, 0.025], [-0.008, 0.025, -0.026]])\n    \n    # Pre-calculate M_common for reuse\n    S_mag_common = np.sqrt(2 * np.sum(S_common**2))\n    S_tilde_mag_common = np.sqrt(2 * np.sum(S_tilde_common**2))\n    M_common = 2 * (delta_common**2 * S_mag_common * S_common - delta_tilde_common**2 * S_tilde_mag_common * S_tilde_common)\n\n    # Case 1\n    L_1 = 0.09 * M_common\n    results.append(calculate_cs_squared(delta_common, delta_tilde_common, S_common, S_tilde_common, L_1))\n\n    # Case 2\n    noise_E = np.array([[1e-3, -2e-4, 3e-4], [-2e-4, 5e-4, -1e-4], [3e-4, -1e-4, -6e-4]])\n    L_2 = L_1 + noise_E\n    results.append(calculate_cs_squared(delta_common, delta_tilde_common, S_common, S_tilde_common, L_2))\n\n    # Case 3\n    delta_3, delta_tilde_3 = 10.0, 20.0\n    S_3 = np.array([[0.02, 0.01, 0.00], [0.01, -0.015, 0.005], [0.00, 0.005, -0.005]])\n    S_tilde_3 = 0.5 * S_3\n    L_3 = np.zeros((3, 3))\n    results.append(calculate_cs_squared(delta_3, delta_tilde_3, S_3, S_tilde_3, L_3))\n    \n    # Case 4\n    L_4 = -0.04 * M_common\n    results.append(calculate_cs_squared(delta_common, delta_tilde_common, S_common, S_tilde_common, L_4))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "动态模型（如  中探讨的模型）可以产生负的涡粘性系数，这对应着能量从次网格尺度向解析尺度的“逆流”（即能量反转）。本实践聚焦于 SGS 模型的一个基本物理约束——“可实现性”（realizability），即次网格尺度耗散 $ \\varepsilon_{\\mathrm{sgs}} $ 应为非负。通过编写程序来检验不同模型下的 $ \\varepsilon_{\\mathrm{sgs}} $ 符号，你将直观地理解能量反转的概念，并学会如何评估一个 SGS 模型是否在物理上自洽 。",
            "id": "4058404",
            "problem": "要求您设计并实现一个完整的、可运行的程序，用于评估大涡模拟（LES）中建模的亚网格尺度（SGS）应力张量与SGS耗散处处非负的可实现性条件的一致性。在数值天气预报和气候建模中，大涡模拟（LES）对速度场进行滤波，以分离已解析和未解析的尺度。设滤波后的速度场表示为 $\\bar{u}_i$，其中 $i \\in \\{1,2,3\\}$ 为空间分量的索引，建模的SGS应力表示为 $\\tau_{ij}$。SGS耗散密度定义为\n$$\\epsilon_{\\mathrm{sgs}} = - \\tau_{ij} \\,\\partial_j \\bar{u}_i.$$\n在此背景下，可实现性意味着建模的SGS耗散在域内处处非负，即，\n$$\\epsilon_{\\mathrm{sgs}}(x,y,z) \\ge 0 \\quad \\text{for all points }(x,y,z)\\text{ in the domain}.$$\n您的程序必须为每个测试用例逐点计算 $\\epsilon_{\\mathrm{sgs}}$，并返回一个布尔值，指示是否在所有位置（在数值容差范围内）$\\epsilon_{\\mathrm{sgs}} \\ge 0$。为考虑浮点舍入误差，将大于或等于 $-10^{-12}$ 的值视为非负。\n\n所有三角函数必须使用弧度制角。所有测试用例的空间域为周期性立方体 $[0,L]^3$，其中 $L = 2\\pi$，在 $N \\times N \\times N$（其中 $N=16$）的均匀网格上离散化。网格点位于\n$$x_n = \\frac{n L}{N},\\quad y_m = \\frac{m L}{N},\\quad z_k = \\frac{k L}{N},\\quad n,m,k \\in \\{0,1,\\dots,N-1\\}.$$\n流体密度为常数 $\\rho = 1.0$（单位 $\\mathrm{kg/m^3}$），运动学参考量值为 $\\nu_0 = 0.1$（单位 $\\mathrm{m^2/s}$）。速度幅值为 $U_0 = 1.0$（单位 $\\mathrm{m/s}$）。建模的SGS应力在下文中按测试用例指定。\n\n您的程序必须实现以下三个测试用例。对于每个用例，解析地计算滤波后的速度场 $\\bar{u}_i(x,y,z)$ 及其梯度 $\\partial_j \\bar{u}_i(x,y,z)$，构建建模的 $\\tau_{ij}(x,y,z)$，然后计算 $\\epsilon_{\\mathrm{sgs}}(x,y,z)$ 并检查整个网格的非负性。\n\n所有用例中使用的定义：\n- 对称的已解析应变率张量定义为\n$$S_{ij} = \\frac{1}{2}\\left(\\partial_j \\bar{u}_i + \\partial_i \\bar{u}_j\\right).$$\n\n测试用例 1（具有非负黏性的涡黏性模型；预期满足可实现性）：\n- 速度场分量：\n$$\\bar{u}_1(x,y,z) = U_0 \\sin x \\,\\cos y \\,\\cos z,$$\n$$\\bar{u}_2(x,y,z) = - U_0 \\cos x \\,\\sin y \\,\\cos z,$$\n$$\\bar{u}_3(x,y,z) = \\frac{1}{2} U_0 \\sin x \\,\\sin y \\,\\sin z.$$\n- 运动学SGS黏性：\n$$\\nu_t(x,y,z) = \\nu_0 \\left(1 + \\frac{1}{2} \\sin x \\,\\cos y \\,\\cos z\\right),$$\n根据构造，该黏性处处非负。\n- 建模的SGS应力：\n$$\\tau_{ij}(x,y,z) = - 2 \\rho \\,\\nu_t(x,y,z)\\, S_{ij}(x,y,z).$$\n\n测试用例 2（具有符号变化的动态涡黏性；预期在某些点上违反可实现性）：\n- 速度场分量与测试用例1相同。\n- 运动学SGS黏性：\n$$\\nu_t(x,y,z) = \\nu_0 \\,\\frac{\\cos x + \\cos y + \\cos z}{3},$$\n它在域内会改变符号。\n- 建模的SGS应力：\n$$\\tau_{ij}(x,y,z) = - 2 \\rho \\,\\nu_t(x,y,z)\\, S_{ij}(x,y,z).$$\n\n测试用例 3（均匀流；梯度恒为零；预期满足可实现性）：\n- 速度场分量：\n$$\\bar{u}_1(x,y,z) = U_0,\\quad \\bar{u}_2(x,y,z) = 0,\\quad \\bar{u}_3(x,y,z) = 0.$$\n- 梯度恒为零，因此 $S_{ij}(x,y,z) = 0$。\n- 建模的SGS应力：\n$$\\tau_{ij}(x,y,z) = 0.$$\n\n实现要求：\n- 根据每个测试用例给定的 $\\bar{u}_i$ 解析地计算 $\\partial_j \\bar{u}_i$。\n- 对每个测试用例，通过对重复的索引 $i$ 和 $j$ 求和，在每个网格点上计算 $\\epsilon_{\\mathrm{sgs}}(x,y,z) = - \\tau_{ij} \\,\\partial_j \\bar{u}_i$。\n- 如果在所有网格点上 $\\epsilon_{\\mathrm{sgs}}(x,y,z) \\ge -10^{-12}$，则该测试用例通过；否则失败。\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个测试用例一个布尔值，顺序为 $[1,2,3]$；例如，如果测试用例1和3通过，而测试用例2失败，则输出应为\n$$[\\text{True},\\text{False},\\text{True}].$$\n\n您的程序必须是自包含的，不需要用户输入，并且所有三角函数求值都使用弧度。最终的布尔值是无单位的。",
            "solution": "该问题要求在大涡模拟（LES）的背景下，针对三个不同的测试用例，验证建模的亚网格尺度（SGS）应力张量 $\\tau_{ij}$ 是否满足SGS耗散非负 $\\epsilon_{\\mathrm{sgs}} \\ge 0$ 的可实现性条件。\n\n首先，我们建立理论基础。SGS耗散密度定义为：\n$$\n\\epsilon_{\\mathrm{sgs}} = - \\tau_{ij} \\,\\partial_j \\bar{u}_i\n$$\n其中 $\\bar{u}_i$ 是滤波后的速度场，$\\partial_j \\bar{u}_i$ 是滤波后的速度梯度张量，我们将其记作 $G_{ij}$。此处隐含了对重复索引 $i,j \\in \\{1,2,3\\}$ 的求和约定。\n\n对于涉及涡黏性模型的测试用例，SGS应力张量由下式给出：\n$$\n\\tau_{ij} = - 2 \\rho \\nu_t S_{ij}\n$$\n此处，$\\rho$ 是流体密度，$\\nu_t$ 是运动学SGS黏性，而 $S_{ij}$ 是对称的已解析应变率张量：\n$$\nS_{ij} = \\frac{1}{2}\\left(\\partial_j \\bar{u}_i + \\partial_i \\bar{u}_j\\right) = \\frac{1}{2}\\left(G_{ij} + G_{ji}\\right)\n$$\n将 $\\tau_{ij}$ 的表达式代入 $\\epsilon_{\\mathrm{sgs}}$ 的定义中，我们得到：\n$$\n\\epsilon_{\\mathrm{sgs}} = - \\left(- 2 \\rho \\nu_t S_{ij}\\right) G_{ij} = 2 \\rho \\nu_t S_{ij} G_{ij}\n$$\n速度梯度张量可以分解为其对称和反对称部分：$G_{ij} = S_{ij} + \\Omega_{ij}$，其中 $\\Omega_{ij} = \\frac{1}{2}(G_{ij} - G_{ji})$ 是旋转率张量。缩并项 $S_{ij} G_{ij}$ 变为：\n$$\nS_{ij} G_{ij} = S_{ij} (S_{ij} + \\Omega_{ij}) = S_{ij}S_{ij} + S_{ij}\\Omega_{ij}\n$$\n$S_{ij}\\Omega_{ij}$ 项是一个对称张量（$S_{ij}$）与一个反对称张量（$\\Omega_{ij}$）的缩并，其值恒为零。因此，$S_{ij} G_{ij} = S_{ij} S_{ij}$。SGS耗散简化为：\n$$\n\\epsilon_{\\mathrm{sgs}} = 2 \\rho \\nu_t S_{ij} S_{ij}\n$$\n$S_{ij}S_{ij} = \\sum_{i=1}^3 \\sum_{j=1}^3 S_{ij}^2$ 项是应变率张量的弗罗贝尼乌斯范数的平方。作为实数的平方和，它总是非负的：$S_{ij}S_{ij} \\ge 0$。因此，对于这种形式的涡黏性模型，SGS耗散 $\\epsilon_{\\mathrm{sgs}}$ 的符号仅由SGS黏性 $\\nu_t$ 的符号决定。可实现性条件 $\\epsilon_{\\mathrm{sgs}} \\ge 0$ 成立，当且仅当在所有 $S_{ij}$ 不恒为零的点上 $\\nu_t \\ge 0$。\n\n计算步骤如下：\n1.  定义物理和数值常数：$L=2\\pi$, $N=16$, $\\rho=1.0$, $\\nu_0=0.1$, $U_0=1.0$。\n2.  使用 $N^3$ 个点为域 $[0, L]^3$ 构建三维计算网格，坐标为 $x_n = \\frac{nL}{N}$, $y_m = \\frac{mL}{N}$, $z_k = \\frac{kL}{N}$ for $n,m,k \\in \\{0, 1, \\dots, N-1\\}$。\n3.  对每个测试用例，执行以下步骤：\n    a.  从给定的速度场 $\\bar{u}_i(x,y,z)$ 解析推导速度梯度张量 $G_{ij} = \\partial_j \\bar{u}_i$ 的九个分量。\n    b.  在三维网格的每个点上数值计算 $G_{ij}$。\n    c.  在每个网格点上计算应变率张量 $S_{ij} = \\frac{1}{2}(G_{ij} + G_{ji})$。\n    d.  在每个网格点上计算给定的SGS黏性场 $\\nu_t(x,y,z)$。\n    e.  在每个网格点上计算SGS应力张量 $\\tau_{ij} = -2 \\rho \\nu_t S_{ij}$。\n    f.  在每个网格点上计算SGS耗散密度 $\\epsilon_{\\mathrm{sgs}} = - \\sum_{i,j} \\tau_{ij} G_{ij}$。\n    g.  确定整个网格上 $\\epsilon_{\\mathrm{sgs}}$ 的最小值。\n    h.  如果此最小值大于或等于指定的数值容差 $-10^{-12}$，则认为该测试用例与可实现性一致。\n\n测试用例1和2的速度场（$\\bar{u}_1 = U_0 \\sin x \\cos y \\cos z$, $\\bar{u}_2 = -U_0 \\cos x \\sin y \\cos z$, $\\bar{u}_3 = \\frac{1}{2} U_0 \\sin x \\sin y \\sin z$）的解析导数为：\n- $\\partial_1\\bar{u}_1 = U_0 \\cos x \\cos y \\cos z$, $\\partial_2\\bar{u}_1 = -U_0 \\sin x \\sin y \\cos z$, $\\partial_3\\bar{u}_1 = -U_0 \\sin x \\cos y \\sin z$\n- $\\partial_1\\bar{u}_2 = U_0 \\sin x \\sin y \\cos z$, $\\partial_2\\bar{u}_2 = -U_0 \\cos x \\cos y \\cos z$, $\\partial_3\\bar{u}_2 = U_0 \\cos x \\sin y \\sin z$\n- $\\partial_1\\bar{u}_3 = \\frac{1}{2} U_0 \\cos x \\sin y \\sin z$, $\\partial_2\\bar{u}_3 = \\frac{1}{2} U_0 \\sin x \\cos y \\sin z$, $\\partial_3\\bar{u}_3 = \\frac{1}{2} U_0 \\sin x \\sin y \\cos z$\n\n**测试用例 1**：\n- $\\nu_t(x,y,z) = \\nu_0 (1 + \\frac{1}{2} \\sin x \\cos y \\cos z)$。由于 $|\\sin x \\cos y \\cos z| \\le 1$，括号中的项范围从 $1 - \\frac{1}{2} = \\frac{1}{2}$ 到 $1 + \\frac{1}{2} = \\frac{3}{2}$。因此，$\\nu_t$ 处处严格为正。由于 $\\epsilon_{\\mathrm{sgs}} = 2 \\rho \\nu_t S_{ij}S_{ij}$，且 $\\nu_t$ 和 $S_{ij}S_{ij}$ 均为非负，$\\epsilon_{\\mathrm{sgs}}$ 必须为非负。预期此用例会通过。\n\n**测试用例 2**：\n- $\\nu_t(x,y,z) = \\nu_0 (\\cos x + \\cos y + \\cos z)/3$。这个 $\\nu_t$ 的表达式可以为负。例如，在网格点 $(x,y,z) = (\\pi, \\pi, \\pi)$ 处，$\\nu_t = \\nu_0(-1-1-1)/3 = -\\nu_0  0$。在这一点，应变率张量 $S_{ij}$ 不为零，导致 $S_{ij}S_{ij}  0$。因此，$\\epsilon_{\\mathrm{sgs}}$ 在该点将为负，违反了可实现性条件。预期此用例会失败。\n\n**测试用例 3**：\n- 速度场是均匀的：$\\bar{u} = (U_0, 0, 0)$。速度梯度张量 $G_{ij}$ 处处恒为零。这意味着应变率张量 $S_{ij}$ 也为零。问题陈述 $\\tau_{ij}=0$。因此，$\\epsilon_{\\mathrm{sgs}} = - \\tau_{ij} G_{ij} = - (0)(0) = 0$ 处处成立。这满足了可实现性条件 $\\epsilon_{\\mathrm{sgs}} \\ge 0$。预期此用例会通过。\n\n程序使用 NumPy 在三维网格上实现这些计算，以进行高效的矢量化操作。最终输出是一个布尔值列表，指示每个测试用例的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates the realizability of a subgrid-scale (SGS) stress tensor model\n    for three test cases in Large-Eddy Simulation (LES).\n    \"\"\"\n    # Define physical and numerical parameters\n    L = 2.0 * np.pi\n    N = 16\n    rho = 1.0\n    nu0 = 0.1\n    U0 = 1.0\n    TOL = -1.0e-12\n\n    # Create the computational grid\n    grid_points_1d = np.linspace(0.0, L, N, endpoint=False)\n    x, y, z = np.meshgrid(grid_points_1d, grid_points_1d, grid_points_1d, indexing='ij')\n\n    results = []\n\n    # --- Common calculations for Case 1 and Case 2 ---\n    # Analytically compute components of the velocity gradient tensor G_ij = d(u_i)/dx_j\n    G = np.zeros((N, N, N, 3, 3))\n    # Gradients of u1\n    G[..., 0, 0] = U0 * np.cos(x) * np.cos(y) * np.cos(z)\n    G[..., 0, 1] = -U0 * np.sin(x) * np.sin(y) * np.cos(z)\n    G[..., 0, 2] = -U0 * np.sin(x) * np.cos(y) * np.sin(z)\n    # Gradients of u2\n    G[..., 1, 0] = U0 * np.sin(x) * np.sin(y) * np.cos(z)\n    G[..., 1, 1] = -U0 * np.cos(x) * np.cos(y) * np.cos(z)\n    G[..., 1, 2] = U0 * np.cos(x) * np.sin(y) * np.sin(z)\n    # Gradients of u3\n    G[..., 2, 0] = 0.5 * U0 * np.cos(x) * np.sin(y) * np.sin(z)\n    G[..., 2, 1] = 0.5 * U0 * np.sin(x) * np.cos(y) * np.sin(z)\n    G[..., 2, 2] = 0.5 * U0 * np.sin(x) * np.sin(y) * np.cos(z)\n\n    # Compute the strain-rate tensor S_ij = 0.5 * (G_ij + G_ji)\n    S = 0.5 * (G + G.swapaxes(-1, -2))\n\n    # --- Test Case 1 ---\n    # Kinematic SGS viscosity\n    nu_t_1 = nu0 * (1.0 + 0.5 * np.sin(x) * np.cos(y) * np.cos(z))\n    # Modeled SGS stress tensor\n    tau_1 = -2.0 * rho * nu_t_1[..., np.newaxis, np.newaxis] * S\n    # SGS dissipation density\n    epsilon_sgs_1 = -np.sum(tau_1 * G, axis=(-1, -2))\n    # Check realizability condition\n    results.append(np.min(epsilon_sgs_1) >= TOL)\n\n    # --- Test Case 2 ---\n    # Kinematic SGS viscosity\n    nu_t_2 = nu0 * (np.cos(x) + np.cos(y) + np.cos(z)) / 3.0\n    # Modeled SGS stress tensor\n    tau_2 = -2.0 * rho * nu_t_2[..., np.newaxis, np.newaxis] * S\n    # SGS dissipation density\n    epsilon_sgs_2 = -np.sum(tau_2 * G, axis=(-1, -2))\n    # Check realizability condition\n    results.append(np.min(epsilon_sgs_2) >= TOL)\n\n    # --- Test Case 3 ---\n    # For uniform flow, velocity gradient is zero, so S_ij=0, tau_ij=0,\n    # and epsilon_sgs = 0 everywhere.\n    epsilon_sgs_3 = 0.0\n    # The condition 0.0 >= TOL is always true.\n    results.append(epsilon_sgs_3 >= TOL)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda b: 'True' if b else 'False', results))}]\")\n\nsolve()\n```"
        }
    ]
}