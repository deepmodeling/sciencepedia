## 引言
大涡模拟（Large-eddy Simulation, LES）是现代计算流体力学中一种用于研究和预测[湍流](@entry_id:151300)现象的强大数值工具。在自然界和工程应用中，从[大气环流](@entry_id:1125564)到飞行器绕流，[湍流](@entry_id:151300)无处不在，其多尺度的非定常特性对系统的行为起着决定性作用。然而，[精确模拟](@entry_id:749142)这些流动极具挑战性。[直接数值模拟](@entry_id:149543)（DNS）虽能解析所有尺度，但计算成本过高，仅限于低雷诺数；而[雷诺平均](@entry_id:754341)模拟（RANS）虽计算经济，却以牺牲所有瞬态[湍流](@entry_id:151300)结构信息为代价。

大涡模拟正是在计算可行性与物理保真度之间取得精妙平衡的关键技术。它直面了高雷诺数湍流模拟的核心难题：如何以可接受的计算资源捕获对系统演化至关重要的非定常大尺度涡结构。LES通过一种系统性的[尺度分离](@entry_id:270204)方法，直接计算这些能量主导的大尺度运动，同时将其余小尺度运动的统计效应进行建模，从而在揭示[复杂流动](@entry_id:747569)现象方面展现出无与伦比的优势。

本文旨在为读者提供一个关于大涡模拟的全面而深入的理解。在第一章“原理与机制”中，我们将奠定LES的理论基石，从[湍流](@entry_id:151300)的物理图像出发，详细阐述滤波操作、亚格子应力以及核心的闭合模型。接着，在第二章“应用与跨学科联系”中，我们将跨出理论的范畴，探索LES在从大气科学、地球物理到[航空航天工程](@entry_id:268503)等不同学科中的广泛应用，展示其解决实际问题的强大能力。最后，在“动手实践”部分，我们将通过具体的编程练习，将理论知识转化为实践技能，加深对关键模型和概念的理解。通过这一系列的学习，读者将不仅掌握LES的技术细节，更能领会其作为一种科学研究范式的深刻内涵。

## 原理与机制

在深入探讨大涡模拟（Large-eddy Simulation, LES）的具体应用之前，我们必须首先掌握其赖以建立的基本原理和核心机制。本章旨在系统性地阐述LES的理论基础，从[湍流](@entry_id:151300)的物理图像出发，通过滤波操作将问题形式化，进而引出亚格子尺度（subgrid-scale, SGS）模型的概念与构建，最终覆盖LES在不同物理情境下的高级建模思想。

### [湍流](@entry_id:151300)的尺度分离思想

[湍流](@entry_id:151300)的一个标志性特征是其跨越多个数量级的尺度范围。能量通过大尺度的非定常涡旋从平均流中提取，然后通过一系列越来越小的涡旋逐级向下传递，最终在最小的尺度上（即**吉尔莫戈洛夫尺度**，Kolmogorov scale）因分子粘性而耗散为热。这一过程被称为**能量串级**。在高雷诺数的均匀[各向同性湍流](@entry_id:199323)中，吉尔莫戈洛夫（Kolmogorov）的经典理论（K41理论）为这一过程提供了深刻的物理图像。

能量在不同尺度间的分布可以通过**能量谱** $E(k)$ 来描述，其中 $k$ 是波数，代表尺度的倒数。能量谱在一个广阔的波数区间内，即**[惯性子区](@entry_id:273327)**（inertial subrange），展现出普适的[标度律](@entry_id:266186)。该区域位于大尺度的能量输入尺度 $L$（对应波数 $k_L \approx 2\pi/L$）和极小的耗散尺度 $\eta$（对应波数 $k_\eta \approx 1/\eta$）之间。在[惯性子区](@entry_id:273327)中，能量传递过程仅依赖于能量耗散率 $\varepsilon$，而不受大尺度强迫和微观粘性的直接影响。通过量纲分析可得，能量谱遵循著名的 $k^{-5/3}$ 律：

$$
E(k) \propto \varepsilon^{2/3} k^{-5/3}
$$

这一普适规律暗示，小尺度[湍流](@entry_id:151300)运动在统计上比大尺度运动更加简单和普适。大尺度涡旋的结构和演化强烈依赖于具体的流动构型（如边界条件和强迫），具有各向异性和非定常性，携带了大部分的动能。相比之下，[惯性子区](@entry_id:273327)内的小尺度涡旋则趋向于统计上的各向同性，其主要作用是将能量向下传递。

LES的核心思想正是利用了[湍流](@entry_id:151300)的这种尺度依赖特性。它旨在直接解析计算那些对动量和[标量输运](@entry_id:150360)起主导作用的、与具体流动问题相关的**大尺度涡**，同时通过一个**亚格子尺度（SGS）模型**来描述那些更具普适性、但因计算[资源限制](@entry_id:192963)而无法解析的**小尺度涡**的统计效应 。这种方法与**直接数值模拟**（Direct Numerical Simulation, DNS）和**[雷诺平均](@entry_id:754341)模拟**（Reynolds-Averaged Navier-Stokes, RANS）形成了鲜明对比。DNS需要解析从最大到最小的所有[湍流](@entry_id:151300)尺度，其计算量随雷诺数的急剧增加而变得不可行；而RANS则通过时间或系综平均，对所有尺度的[湍流](@entry_id:151300)脉动进行建模，从而失去了关于大尺度非定常涡结构的所有信息。LES在计算成本和信息保真度之间取得了有效的平衡，对于需要解析瞬态[湍流](@entry_id:151300)结构的[高雷诺数流](@entry_id:1126089)动（如大气边界层）尤为重要 。

### 滤波操作：尺度分离的形式化

为了在数学上精确地定义“大尺度”和“小尺度”，LES引入了**滤波**（filtering）操作。对于任意一个流场变量 $\phi(\mathbf{x}, t)$，其**滤波后**（或称**可解尺度**）的场 $\bar{\phi}$ 定义为该场与一个滤波核函数 $G$ 的卷积：

$$
\bar{\phi}(\mathbf{x}) = \int_{\mathbb{R}^3} G(\mathbf{x}-\mathbf{r}; \Delta) \phi(\mathbf{r}) \, \mathrm{d}\mathbf{r}
$$

其中 $\Delta$ 是**滤波宽度**（filter width），表征了分离大小尺度的特征长度。**亚格子尺度**（SGS）场 $\phi'$ 则定义为原始场与滤波场的差值：$\phi' = \phi - \bar{\phi}$。

在傅里叶空间中，滤波操作变得更为直观。根据[卷积定理](@entry_id:264711)，滤波在傅里叶空间中等价于乘积：

$$
\hat{\bar{\phi}}(\mathbf{k}) = \hat{G}(\mathbf{k}; \Delta) \hat{\phi}(\mathbf{k})
$$

这里 $\hat{\phi}$ 和 $\hat{G}$ 分别是 $\phi$ 和 $G$ 的傅里叶变换。理想情况下，我们希望滤波器能够完美地分离尺度，即保留所有波数小于某个**截止波数**（cutoff wavenumber）$k_c$ 的模态，并完全去除所有波数大于 $k_c$ 的模态。这种理想的滤波器被称为**尖锐[谱滤波](@entry_id:755173)器**（sharp spectral filter），其傅里叶变换为一个[阶跃函数](@entry_id:159192)：

$$
\hat{G}(\mathbf{k}; \Delta) =
\begin{cases}
1  \text{if } |\mathbf{k}| \le k_c \\
0  \text{if } |\mathbf{k}| > k_c
\end{cases}
$$

其中 $k_c$ 通常与滤波宽度成反比，例如 $k_c = \pi/\Delta$。这种滤波器是一个[幂等算子](@entry_id:276377)（即 $\hat{G}^2 = \hat{G}$），意味着对一个场进行两次滤波与一次滤波的效果相同，它扮演着向可解尺度空间投影的角色 。然而，在物理空间中，尖锐[谱滤波](@entry_id:755173)器对应一个非局域的 sinc 函数，这在实际计算中难以实现。因此，实际的LES中常采用物理空间局域的滤波器，如[高斯滤波器](@entry_id:899026)或箱式滤波器，它们的傅里叶变换是平滑衰减的，导致可解尺度与亚格子尺度在谱空间存在一定的重叠。

在大多数LES实践中，滤波是**隐式**的，由[计算网格](@entry_id:168560)本身提供。根据[奈奎斯特采样定理](@entry_id:268107)，一个[空间分辨率](@entry_id:904633)为 $\Delta x$ 的网格最多只能表示波长不小于 $2\Delta x$ 的波动。这等效于一个截止波数为 $k_c = \pi/\Delta x$ 的低通滤波。因此，滤波宽度 $\Delta$ 通常被认为与网格尺度相当，例如，对于各向异性网格，一个常见的选择是取网格单元体积的立方根，即 $\Delta = (\Delta x \Delta y \Delta z)^{1/3}$  。在这种视角下，LES的目标就是解析所有波数小于 $k_c$ 的运动，并对波数大于 $k_c$ 的运动的效应进行建模。总动能 $K = \int_0^\infty E(k)\,\mathrm{d}k$ 也因此被划分为可解尺度动能 $K_{\mathrm{res}} = \int_0^{k_c} E(k)\,\mathrm{d}k$ 和亚格子尺度动能 $K_{\mathrm{sgs}} = \int_{k_c}^\infty E(k)\,\mathrm{d}k$ 。

### 滤波后的控制方程与闭合问题

将滤波操作应用于[不可压缩流](@entry_id:140301)动的[Navier-Stokes](@entry_id:276387)方程，我们得到可解尺度场的控制方程。以[动量方程](@entry_id:197225)为例，对流项 $\nabla \cdot (\mathbf{u} \otimes \mathbf{u})$ 经过滤波后变为 $\nabla \cdot (\overline{\mathbf{u} \otimes \mathbf{u}})$。由于滤波和[非线性](@entry_id:637147)乘积运算通常不可交换，即 $\overline{u_i u_j} \neq \bar{u}_i \bar{u}_j$，导致滤波后的方程中出现了一个无法直接用可解尺度变量表示的未知项。

这个未知项被重新整理并定义为**亚格子尺度[应力张量](@entry_id:148973)**（SGS stress tensor），记作 $\tau_{ij}$：

$$
\tau_{ij} = \overline{u_i u_j} - \bar{u}_i \bar{u}_j
$$

这个张量代表了未解析的小尺度运动通过[动量输运](@entry_id:139628)对已解析的大尺度运动产生的影响。由于我们没有关于亚格子速度场 $u'_i$ 的信息，$\tau_{ij}$ 是未知的，必须通过一个模型将其与已知的可解尺度场 $\bar{u}_i$ 联系起来。这便是LES的核心问题——**闭合问题**（closure problem） 。从能量的角度看，$\tau_{ij}$ 与可解尺度[应变率张量](@entry_id:266108) $\bar{S}_{ij}$ 的乘积项 $-\tau_{ij}\bar{S}_{ij}$ 代表了能量从可解尺度向亚格子尺度的[传递率](@entry_id:756124)，即跨越截止波数 $k_c$ 的谱[能量通量](@entry_id:266056)。SGS模型的主要任务就是正确地模拟这个能量的抽取过程，以避免能量在可解尺度的末端（即高波数区域）发生非物理的堆积 。

在讨论SGS模型之前，有必要对 $\tau_{ij}$ 进行更深入的分解。通过将 $u_i = \bar{u}_i + u'_i$ 代入 $\tau_{ij}$ 的定义，可以将其分解为三个部分，即**Germano分解**：

$$
\tau_{ij} = L_{ij} + C_{ij} + R_{ij}
$$

其中：
- **Leonard应力**：$L_{ij} = \overline{\bar{u}_i \bar{u}_j} - \bar{u}_i \bar{u}_j$。它表示可解尺度场自身相互作用产生的应力，由于滤波操作的[非交换性](@entry_id:153545)而产生。
- **交叉应力**（Cross stress）：$C_{ij} = \overline{\bar{u}_i u'_j + u'_i \bar{u}_j}$。它表示可解尺度与亚格子尺度之间的相互作用。
- **亚格子[雷诺应力](@entry_id:263788)**（Subgrid Reynolds stress）：$R_{ij} = \overline{u'_i u'_j}$。它表示亚格子尺度自身的相互作用。

在这个分解中，只有Leonard应力 $L_{ij}$ 是可以根据已知的可解场 $\bar{u}_i$ 和已知的滤波算子直接计算的。交叉应力和亚格子雷诺应力都依赖于未知的亚格子速度 $u'_i$，因此是不可直接计算的，必须被建模。这个分解对于理解和构建更高级的[SGS模型](@entry_id:754720)（如混合模型和动态模型）至关重要 。

### 亚格子尺度应力的建模

SGS模型的目标是提供一个关于 $\tau_{ij}$ 的近似表达式，使其能够正确地代表亚格子尺度对可解尺度的影响，尤其是能量耗散。

#### 涡粘模型

最流行的一类[SGS模型](@entry_id:754720)是**涡粘模型**（eddy-viscosity models）。这类模型借鉴了分子粘性的思想，假设[SGS应力](@entry_id:1131521)的各向异性部分与可解尺度的应变率张量 $\bar{S}_{ij} = \frac{1}{2}(\partial \bar{u}_i/\partial x_j + \partial \bar{u}_j/\partial x_i)$ 成正比：

$$
\tau_{ij} - \frac{1}{3}\tau_{kk}\delta_{ij} = -2\nu_t \bar{S}_{ij}
$$

这里，$\nu_t$ 被称为**涡粘性系数**（eddy viscosity），它不是流体的物理属性，而是一个用于描述亚格子尺度[湍流混合](@entry_id:202591)效应的参数。

经典的**[Smagorinsky模型](@entry_id:276289)**是第一个也是最著名的涡粘模型。它通过量纲分析和[局部平衡假设](@entry_id:182180)（即亚格子能量的产生与耗散在局部达到平衡）得到 $\nu_t$ 的表达式：

$$
\nu_t = (C_s \Delta)^2 |\bar{S}|
$$

其中 $|\bar{S}| = \sqrt{2 \bar{S}_{ij} \bar{S}_{ij}}$ 是可解尺度应变率张量大小的度量，$C_s$ 是一个无量纲的**Smagorinsky系数**。这个模型物理意义清晰：在[应变率](@entry_id:154778)大的区域（[湍流](@entry_id:151300)活动剧烈），涡粘性也大，从而耗散更多的能量。模型中的 $\nu_t$ 依赖于滤波尺度 $\Delta$ 和局部流场状态 $|\bar{S}|$，这与作为流体固有属性的分子粘性 $\nu$ 有着本质区别。在典型的大气边界层LES中，由模型计算出的 $\nu_t$ 通常比空气的分子粘性 $\nu$ 大好几个数量级，这凸显了[湍流混合](@entry_id:202591)输运远强于[分子输运](@entry_id:195239)的事实。例如，对于一个典型的中性[大气边界层](@entry_id:1121182)LES设置（$C_s = 0.17$, $\Delta = 50\,\mathrm{m}$, $|\bar{S}| = 0.02\,\mathrm{s}^{-1}$），计算出的涡粘性 $\nu_t \approx 1.45\,\mathrm{m}^2\mathrm{s}^{-1}$，而空气的分子运动粘度 $\nu \approx 1.5 \times 10^{-5}\,\mathrm{m}^2\mathrm{s}^{-1}$，两者相差近五个数量级 。

#### [标量通量](@entry_id:1131249)的建模

同样的概念可以推广到对标量（如温度、污染物浓度）的亚格子通量进行建模。对于一个滤波后的标量场 $\bar{\theta}$，其控制方程中会出现未知的**亚格子标量通量** $\phi_i = \overline{u_i \theta} - \bar{u}_i \bar{\theta}$。同样采用梯度输运假设，该通量可被建模为：

$$
\phi_i = -\kappa_t \frac{\partial \bar{\theta}}{\partial x_i}
$$

其中 $\kappa_t$ 是**涡扩散系数**（eddy diffusivity）。$\kappa_t$ 通常通过涡粘性系数 $\nu_t$ 和一个无量纲的**湍流普朗特数**（turbulent Prandtl number）$Pr_t$ 来确定：

$$
\kappa_t = \frac{\nu_t}{Pr_t}
$$

$Pr_t = \nu_t / \kappa_t$ 的物理意义是动量的涡扩散效率与热量（或标量）的涡扩散效率之比。与Smagorinsky系数不同，$Pr_t$ 并非一个[普适常数](@entry_id:165600)，它强烈依赖于流动的稳定性。根据大气边界层的经验观测：
- **中性层结**下，[湍流](@entry_id:151300)由切变产生，$Pr_t \approx 0.7 - 0.9$，表明[标量输运](@entry_id:150360)效率略高于动量。
- **不稳定层结**（对流条件）下，[浮力](@entry_id:154088)驱动的热泡或羽流极大地增强了热量的垂直输运，而对[动量输运](@entry_id:139628)的增强相对较弱，因此 $\kappa_t$ 相对 $\nu_t$ 增大，$Pr_t$ 减小。
- **稳定层结**下，[浮力](@entry_id:154088)抑制垂直运动，这种抑制对热量输运的影响比对动量输运更强，导致 $\kappa_t$ 相对 $\nu_t$ 减小，$Pr_t$ 增大，有时会远大于1。

在模型应用中，根据这些物理规律选择合适的 $Pr_t$ 值至关重要。例如，在一个给定 $\nu_t = 5\,\mathrm{m^2s^{-1}}$ 和垂直位温梯度 $\partial_z \bar{\theta} = -10^{-2}\,\mathrm{K m^{-1}}$（不稳定条件）的算例中，使用中性参考值 $Pr_t = 0.8$，可以计算出向上的（正的）亚格子热通量 $\phi_z = -(\nu_t/Pr_t)\partial_z \bar{\theta} = +6.25 \times 10^{-2}\,\mathrm{K m s^{-1}}$，这与从暖到冷的物理输运方向一致 。

### 高级建模概念

#### 动态模型

[Smagorinsky模型](@entry_id:276289)的一个主要缺点是需要预先指定系数 $C_s$。这个系数在理论上对于不同的流动类型应取不同值。**动态模型**（dynamic procedure）通过在模拟过程中利用流场自身的信息来动态地确定模型系数，从而克服了这一局限性。

动态模型的核心是在原有的网格滤波（尺度 $\Delta$）之上，再引入一个更粗的**测试滤波**（test filter），其滤波宽度为 $\tilde{\Delta}$，且 $\tilde{\Delta} > \Delta$（通常取 $\tilde{\Delta} = 2\Delta$）。通过**[Germano恒等式](@entry_id:749887)**，可以建立起网格尺度上的Leonard应力 $L_{ij}$、网格尺度上的[SGS应力](@entry_id:1131521) $\tau_{ij}$ 和测试尺度上的[SGS应力](@entry_id:1131521) $T_{ij}$ 之间的精确关系。然后，假设[Smagorinsky模型](@entry_id:276289)在这两个尺度（$\Delta$ 和 $\tilde{\Delta}$）上都成立且具有相同的系数 $C$，就可以建立一个关于 $C$ 的代数方程，并求解得到随空间和时间变化的 $C(\mathbf{x}, t)$ 。

动态模型能够自动适应流动的局部特性：在层流或近壁面区域，它会自然地预测出很小的 $C$ 值，从而减少模型的耗散；在[湍流](@entry_id:151300)核心区，它能给出合适的 $C$ 值。此外，动态模型还允许 $C$ 值为负，这对应于**能量反向输运**（backscatter），即能量从小尺度向大尺度的回传，这是一个真实的物理现象，而标准的[Smagorinsky模型](@entry_id:276289)无法描述 。

测试滤波宽度的选择是一个权衡过程。如果 $\tilde{\Delta}/\Delta$ 太接近1，求解 $C$ 的方程会变得病态，因为两个尺度上的信息差异太小。反之，如果 $\tilde{\Delta}/\Delta$ 过大，则两个尺度相距太远，它们之间的[湍流](@entry_id:151300)结构可能不再相似，破坏了模型系数在两个尺度上相同的核心假设。实践中，$\tilde{\Delta}/\Delta = 2$ 被证明是一个在稳定性和物理保真度之间的良好折中 。

#### [可压缩流](@entry_id:747589)与[Favre滤波](@entry_id:749251)

当处理[可压缩流](@entry_id:747589)（如考虑密度变化的声学或高马赫数流动）时，标准的滤波操作会带来额外的复杂性。对[可压缩Navier-Stokes](@entry_id:747591)方程进行标准滤波后，会产生诸如 $\overline{\rho' u'_i}$ 等多项密度与速度的亚格子相关项，使得闭合问题变得异常复杂。

为了简化方程，**[Favre滤波](@entry_id:749251)**（或称**密度加权滤波**）被广泛采用。一个变量 $f$ 的[Favre滤波](@entry_id:749251)被定义为：

$$
\tilde{f} = \frac{\overline{\rho f}}{\bar{\rho}}
$$

其中 $\rho$ 是密度。采用[Favre滤波](@entry_id:749251)后，可解尺度的连续性方程和动量方程的形式与不可压缩情况下的方程非常相似。例如，滤波后的[连续性方程](@entry_id:195013)可以写成 $\frac{\partial \bar{\rho}}{\partial t} + \nabla \cdot (\bar{\rho} \tilde{\mathbf{u}}) = 0$，形式上没有出现亚格子项。动量方程中的[SGS应力](@entry_id:1131521)项也变为更简洁的形式 $\tilde{\tau}_{ij} = \widetilde{u_i u_j} - \tilde{u}_i \tilde{u}_j$。这极大地简化了SGS模型的构建和实现  。在密度变化不显著的情况下（如[低马赫数流动](@entry_id:751506)），[Favre滤波](@entry_id:749251)自然地退化为标准滤波，即 $\tilde{f} \approx \bar{f}$ 。

#### 滤波与[微分](@entry_id:158422)的[交换性](@entry_id:140240)

在推导滤波后的方程时，我们通常假设滤波与[微分算子](@entry_id:140145)可以交换顺序，即 $\overline{\nabla f} = \nabla \bar{f}$。然而，这一性质并非无条件成立。在连续的数学形式下，只有当滤波[核函数](@entry_id:145324) $G$ 不随空间位置变化（即**平移不变**，translation-invariant），且在无边界或周期性边界的域中，这种[交换性](@entry_id:140240)才精确成立。[平移不变性](@entry_id:195885)要求滤波宽度 $\Delta$ 必须是常数。

在离散的[计算网格](@entry_id:168560)上，相应的条件是：网格必须是**均匀**的，并且滤波和[微分](@entry_id:158422)的离散算子（例如，差分格式的模板系数）在空间上是固定的。在这些条件下，算子是平移不变的，可以用[循环矩阵](@entry_id:143620)表示，从而保证了[交换性](@entry_id:140240)。

在许多实际的大气或工程应用中，例如使用随地形变化的坐标系或非均匀网格时，这些条件无法满足。此时，滤波与[微分](@entry_id:158422)不再交换，会产生一个**交换误差项**（commutation error）。在严谨的LES formulation中，这个误差项也必须被考虑或建模，否则会引入形式上的不一致性 。