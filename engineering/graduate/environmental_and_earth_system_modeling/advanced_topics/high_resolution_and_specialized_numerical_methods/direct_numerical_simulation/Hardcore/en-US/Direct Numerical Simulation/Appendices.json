{
    "hands_on_practices": [
        {
            "introduction": "To perform a successful Direct Numerical Simulation, one must first determine the immense range of spatial and temporal scales present in a turbulent flow. This practice bridges theory and application by using the foundational principles of Kolmogorov's turbulence theory to estimate the smallest scales of motion—the Kolmogorov microscales—that must be resolved. By working through this exercise , you will gain a concrete understanding of how large-scale flow characteristics dictate the required grid spacing and time step for a DNS.",
            "id": "3874580",
            "problem": "A research team is preparing a Direct Numerical Simulation (DNS) of homogeneous, isotropic turbulence representative of small-scale ocean mixing. The fluid is seawater with kinematic viscosity $\\nu = 1.0 \\times 10^{-6} \\, \\text{m}^2/\\text{s}$. The large-scale root-mean-square velocity $U = 0.2 \\, \\text{m/s}$ and integral length scale $L = 0.5 \\, \\text{m}$, respectively. Assume a statistically steady, high Reynolds number flow so that a forward energy cascade is well established. \n\nStarting from the incompressible Navier–Stokes equations and the kinetic energy balance, and invoking Kolmogorov similarity for the inertial cascade, derive the scaling of the mean dissipation rate $\\varepsilon$ at the large scale in terms of $U$ and $L$, then use dimensional analysis to obtain expressions for the Kolmogorov microscales: the Kolmogorov length scale $\\eta$, time scale $\\tau_{\\eta}$, and velocity scale $u_{\\eta}$, expressed in terms of $\\nu$ and $\\varepsilon$. For the DNS resolution criteria, impose the constraints that the grid spacing $\\Delta x$ resolves the Kolmogorov length and the time step $\\Delta t$ resolves the Kolmogorov time with a safety factor $c=1$, that is, set $\\Delta x = c\\,\\eta$ and $\\Delta t = c\\,\\tau_{\\eta}$ with $c=1$.\n\nUsing the given $U$, $L$, and $\\nu$, compute numerical values for $\\eta$, $\\tau_{\\eta}$, $u_{\\eta}$, $\\Delta x$, and $\\Delta t$. Round each value to four significant figures. Express $\\eta$ and $\\Delta x$ in meters, $\\tau_{\\eta}$ and $\\Delta t$ in seconds, and $u_{\\eta}$ in meters per second. The final answer must be a single row matrix containing these five numbers in the order $(\\eta, \\tau_{\\eta}, u_{\\eta}, \\Delta x, \\Delta t)$.",
            "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, and objective. It presents a standard problem in the theory of turbulence and its numerical simulation, providing all necessary information for a unique solution.\n\nThe problem requires a two-part derivation followed by a numerical calculation. First, we derive the scaling for the mean turbulent kinetic energy dissipation rate, $\\varepsilon$. Second, we derive the expressions for the Kolmogorov microscales. Finally, we compute the numerical values for these scales and the corresponding DNS grid parameters.\n\nThe starting point is the energy balance in statistically steady, homogeneous turbulence. The rate of production of turbulent kinetic energy per unit mass, $P$, at the large, energy-containing scales of motion must balance the rate of viscous dissipation, $\\varepsilon$, at the small, dissipative scales. This is expressed as $P = \\varepsilon$. The production rate $P$ is determined by the dynamics of the large eddies. The characteristic velocity of these eddies is the root-mean-square velocity, $U$, and their characteristic size is the integral length scale, $L$. The characteristic time scale for the large eddies, known as the eddy turnover time, is $T_L \\sim L/U$. The kinetic energy per unit mass at these scales is of the order $k \\sim U^2$. The rate at which this energy is transferred down the cascade is the energy divided by the characteristic time, so $P \\sim k/T_L$. Substituting the scalings for $k$ and $T_L$ gives the production rate scaling:\n$$ P \\sim \\frac{U^2}{L/U} = \\frac{U^3}{L} $$\nIn the statistically steady state, this production rate is equal to the dissipation rate, $\\varepsilon$. Therefore, the scaling for the mean dissipation rate is:\n$$ \\varepsilon \\propto \\frac{U^3}{L} $$\nFor order-of-magnitude estimates, we assume the constant of proportionality is unity, yielding $\\varepsilon \\approx \\frac{U^3}{L}$.\n\nNext, we use dimensional analysis to derive the Kolmogorov microscales. According to Kolmogorov's first similarity hypothesis, the small-scale turbulent motions are universally and uniquely determined by the dissipation rate $\\varepsilon$ and the kinematic viscosity $\\nu$. Their dimensions are $[\\varepsilon] = L^2 T^{-3}$ and $[\\nu] = L^2 T^{-1}$.\n\n1.  The Kolmogorov length scale, $\\eta$, is found by combining $\\varepsilon$ and $\\nu$ to obtain a quantity with dimensions of length, $[L]$. We set $\\eta = \\varepsilon^a \\nu^b$. In terms of dimensions:\n    $$ [L]^1 [T]^0 = (L^2 T^{-3})^a (L^2 T^{-1})^b = L^{2a+2b} T^{-3a-b} $$\n    This leads to a system of linear equations for the exponents $a$ and $b$:\n    $$ \\begin{cases} 2a + 2b = 1 \\\\ -3a - b = 0 \\end{cases} $$\n    From the second equation, $b = -3a$. Substituting into the first equation gives $2a + 2(-3a) = 1$, which simplifies to $-4a = 1$, so $a = -1/4$. Consequently, $b = -3(-1/4) = 3/4$. The expression for the Kolmogorov length scale is:\n    $$ \\eta = \\varepsilon^{-1/4} \\nu^{3/4} = \\left(\\frac{\\nu^3}{\\varepsilon}\\right)^{1/4} $$\n\n2.  The Kolmogorov time scale, $\\tau_{\\eta}$, is found by forming a quantity with dimensions of time, $[T]$. We set $\\tau_{\\eta} = \\varepsilon^a \\nu^b$.\n    $$ [L]^0 [T]^1 = L^{2a+2b} T^{-3a-b} $$\n    This gives the system:\n    $$ \\begin{cases} 2a + 2b = 0 \\\\ -3a - b = 1 \\end{cases} $$\n    From the first equation, $b = -a$. Substituting into the second gives $-3a - (-a) = 1$, which simplifies to $-2a = 1$, so $a = -1/2$. Consequently, $b = 1/2$. The expression for the Kolmogorov time scale is:\n    $$ \\tau_{\\eta} = \\varepsilon^{-1/2} \\nu^{1/2} = \\left(\\frac{\\nu}{\\varepsilon}\\right)^{1/2} $$\n\n3.  The Kolmogorov velocity scale, $u_{\\eta}$, can be found dimensionally or simply by taking the ratio $u_{\\eta} = \\eta / \\tau_{\\eta}$. Using the latter:\n    $$ u_{\\eta} = \\frac{(\\nu^3/\\varepsilon)^{1/4}}{(\\nu/\\varepsilon)^{1/2}} = \\frac{\\nu^{3/4}\\varepsilon^{-1/4}}{\\nu^{1/2}\\varepsilon^{-1/2}} = \\nu^{3/4 - 1/2} \\varepsilon^{-1/4 - (-1/2)} = \\nu^{1/4} \\varepsilon^{1/4} $$\n    The expression for the Kolmogorov velocity scale is:\n    $$ u_{\\eta} = (\\nu\\varepsilon)^{1/4} $$\n\nNow, we compute the numerical values using the given data: $U = 0.2 \\, \\text{m/s}$, $L = 0.5 \\, \\text{m}$, and $\\nu = 1.0 \\times 10^{-6} \\, \\text{m}^2/\\text{s}$.\n\nFirst, we calculate the dissipation rate $\\varepsilon$:\n$$ \\varepsilon = \\frac{U^3}{L} = \\frac{(0.2 \\, \\text{m/s})^3}{0.5 \\, \\text{m}} = \\frac{0.008 \\, \\text{m}^3/\\text{s}^3}{0.5 \\, \\text{m}} = 0.016 \\, \\text{m}^2/\\text{s}^3 $$\n\nUsing this value for $\\varepsilon$ and the given $\\nu$, we compute the Kolmogorov scales:\n-   $\\eta = \\left(\\frac{\\nu^3}{\\varepsilon}\\right)^{1/4} = \\left(\\frac{(1.0 \\times 10^{-6})^3}{0.016}\\right)^{1/4} = \\left(\\frac{1.0 \\times 10^{-18}}{1.6 \\times 10^{-2}}\\right)^{1/4} = (6.25 \\times 10^{-17})^{1/4} \\approx 8.89552 \\times 10^{-5} \\, \\text{m}$.\n    Rounding to four significant figures, $\\eta \\approx 8.896 \\times 10^{-5} \\, \\text{m}$.\n-   $\\tau_{\\eta} = \\left(\\frac{\\nu}{\\varepsilon}\\right)^{1/2} = \\left(\\frac{1.0 \\times 10^{-6}}{0.016}\\right)^{1/2} = (6.25 \\times 10^{-5})^{1/2} \\approx 7.90569 \\times 10^{-3} \\, \\text{s}$.\n    Rounding to four significant figures, $\\tau_{\\eta} \\approx 7.906 \\times 10^{-3} \\, \\text{s}$.\n-   $u_{\\eta} = (\\nu\\varepsilon)^{1/4} = ((1.0 \\times 10^{-6})(0.016))^{1/4} = (1.6 \\times 10^{-8})^{1/4} \\approx 0.0112468 \\, \\text{m/s}$.\n    Rounding to four significant figures, $u_{\\eta} \\approx 0.01125 \\, \\text{m/s}$, which is $1.125 \\times 10^{-2} \\, \\text{m/s}$.\n\nFinally, we determine the DNS resolution parameters according to the problem constraints: $\\Delta x = c\\,\\eta$ and $\\Delta t = c\\,\\tau_{\\eta}$ with the safety factor $c=1$.\n-   Grid spacing: $\\Delta x = 1 \\times \\eta \\approx 8.896 \\times 10^{-5} \\, \\text{m}$.\n-   Time step: $\\Delta t = 1 \\times \\tau_{\\eta} \\approx 7.906 \\times 10^{-3} \\, \\text{s}$.\n\nThe five required numerical values, in the specified order $(\\eta, \\tau_{\\eta}, u_{\\eta}, \\Delta x, \\Delta t)$ and rounded to four significant figures, are: $(8.896 \\times 10^{-5}, 7.906 \\times 10^{-3}, 1.125 \\times 10^{-2}, 8.896 \\times 10^{-5}, 7.906 \\times 10^{-3})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8.896 \\times 10^{-5} & 7.906 \\times 10^{-3} & 1.125 \\times 10^{-2} & 8.896 \\times 10^{-5} & 7.906 \\times 10^{-3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "After determining the necessary resolution for a DNS, the next critical step is to assess its practical feasibility. This exercise  guides you through a \"back-of-the-envelope\" calculation to estimate the total computational resources—specifically memory and runtime—required for a simulation. This feasibility study provides a sobering, quantitative look at why DNS is often prohibitively expensive for high Reynolds number flows and powerfully motivates the development of alternative turbulence modeling strategies like Large Eddy Simulation (LES).",
            "id": "3874556",
            "problem": "Consider a turbulent mixing patch representative of an estuarine shear layer in water. The domain is a cube of side length $L = 1\\,\\text{m}$ with characteristic velocity $U = 0.1\\,\\text{m/s}$, and the kinematic viscosity of water is $\\nu = 1.0 \\times 10^{-6}\\,\\text{m}^2/\\text{s}$. The target Reynolds number is therefore $Re = UL/\\nu$. You wish to assess the feasibility of performing a Direct Numerical Simulation (DNS), defined as resolving all dynamically relevant scales down to the Kolmogorov microscales, starting from the following well-tested foundations: the energy dissipation rate scaling $\\varepsilon \\sim U^{3}/L$ and the Kolmogorov scales $\\eta = (\\nu^{3}/\\varepsilon)^{1/4}$ and $\\tau_{\\eta} = (\\nu/\\varepsilon)^{1/2}$. Assume an explicit time integrator constrained by an advective Courant–Friedrichs–Lewy (CFL) condition with CFL number $C_{\\mathrm{CFL}} = 0.5$, such that the stable time step scales as $\\Delta t \\approx C_{\\mathrm{CFL}}\\,\\eta/U$. The DNS will be advanced for a physical time horizon equal to $5$ large-eddy turnover times, where the turnover time is $T = L/U$.\n\nThe computational method is a standard finite-volume incompressible Navier–Stokes solver storing $12$ double-precision ($8$ bytes each) arrays per grid point (to account for three velocity components, pressure, and working arrays), giving an effective storage of $b_{\\mathrm{eff}} = 96\\,\\text{bytes}$ per grid point. The per time-step floating-point work is $C_{\\mathrm{op}} = 2000$ floating-point operations per grid point. You have access to a distributed-memory cluster of $16$ nodes, each with $256\\,\\text{GB}$ of memory, and a sustained per-node performance of $2.5 \\times 10^{12}$ floating-point operations per second. The total available wall-clock runtime budget is $48\\,\\text{h}$. Take $1\\,\\text{GB} = 10^{9}\\,\\text{bytes}$ and $1\\,\\text{TB} = 10^{12}\\,\\text{bytes}$ for memory conversion.\n\nUsing only the foundations and definitions above, proceed as follows:\n\n- Derive the Kolmogorov length scale $\\eta$ and use it as the DNS grid spacing, with the number of grid points estimated by $N \\approx (L/\\eta)^{3}$.\n- Determine the required memory $M_{\\mathrm{req}} = b_{\\mathrm{eff}} N$ and compare it to the available memory $M_{\\mathrm{avail}}$.\n- Using the CFL constraint, compute $\\Delta t$, the number of time steps $n_{\\mathrm{steps}}$ to reach the target horizon $5T$, and the total floating-point work $W_{\\mathrm{tot}} = C_{\\mathrm{op}} N n_{\\mathrm{steps}}$. Convert $W_{\\mathrm{tot}}$ to a required runtime $t_{\\mathrm{req}}$ using the cluster’s total sustained performance; compare to the available runtime $t_{\\mathrm{avail}}$.\n- Define the feasibility index $F$ as $F = \\min\\!\\left(M_{\\mathrm{avail}}/M_{\\mathrm{req}},\\; t_{\\mathrm{avail}}/t_{\\mathrm{req}}\\right)$ and compute its value.\n\nFinally, interpret the computed feasibility index $F$ physically and, in words, discuss the trade-offs relative to Large Eddy Simulation (LES), including how choosing a filter scale larger than $\\eta$ changes the grid, time-step, and total cost scaling with $Re$.\n\nReport the final feasibility index as a single dimensionless number. Round your answer to three significant figures.",
            "solution": "The problem statement is found to be valid. It is scientifically grounded in the principles of turbulence theory and computational fluid dynamics, well-posed, objective, and internally consistent. We can therefore proceed with the solution by following the prescribed steps.\n\nFirst, we calculate the characteristic dimensionless numbers and physical scales for the specified turbulent flow. The Reynolds number, $Re$, is a measure of the ratio of inertial forces to viscous forces:\n$$Re = \\frac{UL}{\\nu} = \\frac{(0.1\\,\\text{m/s})(1\\,\\text{m})}{1.0 \\times 10^{-6}\\,\\text{m}^2/\\text{s}} = 100,000 = 10^{5}$$\nThis is a high Reynolds number, confirming the flow is turbulent.\n\nNext, we estimate the mean rate of viscous dissipation of turbulent kinetic energy per unit mass, $\\varepsilon$. Using the provided scaling for high-Reynolds-number turbulence:\n$$\\varepsilon \\sim \\frac{U^{3}}{L} = \\frac{(0.1\\,\\text{m/s})^{3}}{1\\,\\text{m}} = 10^{-3}\\,\\text{m}^{2}/\\text{s}^{3}$$\n\nThe Direct Numerical Simulation (DNS) requires resolving the smallest scales of turbulence, the Kolmogorov microscales. The Kolmogorov length scale, $\\eta$, is the characteristic size of the smallest eddies where viscosity dominates and energy is dissipated into heat. It is calculated as:\n$$\\eta = \\left(\\frac{\\nu^{3}}{\\varepsilon}\\right)^{1/4} = \\left(\\frac{(1.0 \\times 10^{-6}\\,\\text{m}^2/\\text{s})^{3}}{10^{-3}\\,\\text{m}^{2}/\\text{s}^{3}}\\right)^{1/4} = \\left(\\frac{10^{-18}}{10^{-3}}\\right)^{1/4} = (10^{-15})^{1/4} = 10^{-3.75}\\,\\text{m}$$\n\nTo perform a DNS, the computational grid must have a spacing, $\\Delta x$, on the order of $\\eta$. Assuming an isotropic grid where $\\Delta x = \\Delta y = \\Delta z = \\eta$, the total number of grid points, $N$, required to fill the cubic domain of side length $L$ is:\n$$N \\approx \\left(\\frac{L}{\\eta}\\right)^{3} = \\left(\\frac{1\\,\\text{m}}{10^{-3.75}\\,\\text{m}}\\right)^{3} = (10^{3.75})^{3} = 10^{11.25}$$\n\nNow, we assess the computational resource requirements, starting with memory. The total required memory, $M_{\\mathrm{req}}$, is the product of the number of grid points and the effective storage per point, $b_{\\mathrm{eff}}$:\n$$M_{\\mathrm{req}} = b_{\\mathrm{eff}} N = (96\\,\\text{bytes}) \\times 10^{11.25} \\approx 96 \\times (1.77828 \\times 10^{11})\\,\\text{bytes} \\approx 1.7071 \\times 10^{13}\\,\\text{bytes}$$\nUsing the conversion $1\\,\\text{TB} = 10^{12}\\,\\text{bytes}$, this is approximately $17.07\\,\\text{TB}$.\n\nThe total available memory, $M_{\\mathrm{avail}}$, on the cluster is:\n$$M_{\\mathrm{avail}} = (\\text{Number of nodes}) \\times (\\text{Memory per node}) = 16 \\times 256\\,\\text{GB} = 4096\\,\\text{GB} = 4.096 \\times 10^{12}\\,\\text{bytes}$$\nThis is $4.096\\,\\text{TB}$. The ratio of available to required memory is:\n$$\\frac{M_{\\mathrm{avail}}}{M_{\\mathrm{req}}} = \\frac{4.096 \\times 10^{12}\\,\\text{bytes}}{1.7071 \\times 10^{13}\\,\\text{bytes}} \\approx 0.2399$$\n\nNext, we evaluate the computational time requirement. The simulation must run for a physical time of $5$ large-eddy turnover times. The large-eddy turnover time, $T$, is:\n$$T = \\frac{L}{U} = \\frac{1\\,\\text{m}}{0.1\\,\\text{m/s}} = 10\\,\\text{s}$$\nThe total simulation time horizon is $T_{\\mathrm{sim}} = 5T = 50\\,\\text{s}$.\n\nThe time step, $\\Delta t$, is constrained by the advective Courant–Friedrichs–Lewy (CFL) condition:\n$$\\Delta t \\approx C_{\\mathrm{CFL}}\\frac{\\eta}{U} = 0.5 \\times \\frac{10^{-3.75}\\,\\text{m}}{0.1\\,\\text{m/s}} = 5 \\times 10^{-3.75}\\,\\text{s}$$\nThe total number of time steps, $n_{\\mathrm{steps}}$, required to reach the time horizon is:\n$$n_{\\mathrm{steps}} = \\frac{T_{\\mathrm{sim}}}{\\Delta t} = \\frac{50\\,\\text{s}}{5 \\times 10^{-3.75}\\,\\text{s}} = 10 \\times 10^{3.75} = 10^{4.75}$$\n\nThe total floating-point work, $W_{\\mathrm{tot}}$, is the product of operations per grid point per time step, the number of grid points, and the number of time steps:\n$$W_{\\mathrm{tot}} = C_{\\mathrm{op}} N n_{\\mathrm{steps}} = (2000) \\times (10^{11.25}) \\times (10^{4.75}) = 2 \\times 10^{3} \\times 10^{16} = 2 \\times 10^{19}\\,\\text{FLOP}$$\n\nThe total sustained performance of the cluster, $P_{\\mathrm{tot}}$, is:\n$$P_{\\mathrm{tot}} = (\\text{Number of nodes}) \\times (\\text{Performance per node}) = 16 \\times (2.5 \\times 10^{12}\\,\\mathrm{FLOP/s}) = 40 \\times 10^{12}\\,\\mathrm{FLOP/s} = 4 \\times 10^{13}\\,\\mathrm{FLOP/s}$$\nThe required wall-clock time, $t_{\\mathrm{req}}$, is the total work divided by the total performance:\n$$t_{\\mathrm{req}} = \\frac{W_{\\mathrm{tot}}}{P_{\\mathrm{tot}}} = \\frac{2 \\times 10^{19}\\,\\text{FLOP}}{4 \\times 10^{13}\\,\\text{FLOP/s}} = 0.5 \\times 10^{6}\\,\\text{s}$$\nThe available wall-clock time, $t_{\\mathrm{avail}}$, is $48$ hours. We convert this to seconds:\n$$t_{\\mathrm{avail}} = 48\\,\\text{h} \\times \\frac{3600\\,\\text{s}}{1\\,\\text{h}} = 172,800\\,\\text{s} = 1.728 \\times 10^{5}\\,\\text{s}$$\nThe ratio of available to required time is:\n$$\\frac{t_{\\mathrm{avail}}}{t_{\\mathrm{req}}} = \\frac{1.728 \\times 10^{5}\\,\\text{s}}{0.5 \\times 10^{6}\\,\\text{s}} = 0.3456$$\n\nThe feasibility index, $F$, is the minimum of these two resource ratios:\n$$F = \\min\\!\\left(\\frac{M_{\\mathrm{avail}}}{M_{\\mathrm{req}}},\\; \\frac{t_{\\mathrm{avail}}}{t_{\\mathrm{req}}}\\right) = \\min(0.2399, 0.3456) \\approx 0.2399$$\nRounding to three significant figures, the feasibility index is $0.240$.\n\nA feasibility index $F < 1$ indicates that the simulation is not possible with the available resources. In this case, $F \\approx 0.240$ implies the project is severely under-resourced. The primary bottleneck is memory, as the available memory is only about $24\\%$ of what is required. The available compute time is about $35\\%$ of the required total. To make this DNS feasible, one would need a machine with at least $1/0.2399 \\approx 4.17$ times the memory and enough processing power to complete the run in the allotted time, which would require the total performance to also increase by a factor of $1/0.3456 \\approx 2.89$.\n\nThis high cost motivates alternative approaches like Large Eddy Simulation (LES). In DNS, the grid spacing must scale with the Kolmogorov scale, $\\Delta x_{\\mathrm{DNS}} \\sim \\eta \\sim Re^{-3/4}$, leading to a total number of grid points $N_{\\mathrm{DNS}} \\sim (L/\\eta)^3 \\sim Re^{9/4}$. The time step, based on the smallest eddy turnover, scales as $\\Delta t_{\\mathrm{DNS}} \\sim \\eta/u_{\\eta} \\sim Re^{-1/2}$ or, as assumed in this problem with a constant large-eddy velocity, $\\Delta t_{\\mathrm{DNS}} \\sim \\eta/U \\sim Re^{-3/4}$. This results in a total computational cost scaling as $W_{\\mathrm{DNS}} \\sim N_{\\mathrm{DNS}} \\times n_{\\mathrm{steps}} \\sim Re^{9/4} \\times Re^{3/4} = Re^{3}$. This explosive growth with $Re$ makes DNS impractical for most high-$Re$ flows. In LES, one chooses a filter scale $\\Delta$ (which becomes the effective grid spacing) such that $\\eta \\ll \\Delta \\ll L$. Only eddies larger than $\\Delta$ are resolved, while the effects of smaller, sub-grid scales are modeled. The number of grid points, $N_{\\mathrm{LES}} \\approx (L/\\Delta)^3$, is determined by the choice of $\\Delta$. If $\\Delta$ is chosen as a fixed fraction of $L$, $N_{\\mathrm{LES}}$ becomes independent of $Re$. The CFL-limited time step is now $\\Delta t_{\\mathrm{LES}} \\sim \\Delta/U$, which is also independent of $Re$ and much larger than $\\Delta t_{\\mathrm{DNS}}$. Consequently, the total cost of an LES, $W_{\\mathrm{LES}}$, scales much more weakly with $Re$ (ideally, it is independent of $Re$ for a fixed $\\Delta/L$). This drastic reduction in computational cost is the primary advantage of LES. The trade-off is the introduction of modeling error via the sub-grid scale model, which must accurately represent the energy transfer from resolved to unresolved scales. In contrast, DNS is free of modeling assumptions and is considered a numerically \"exact\" solution to the Navier-Stokes equations, limited only by discretization and round-off errors.",
            "answer": "$$\\boxed{0.240}$$"
        },
        {
            "introduction": "Given the staggering cost of DNS, it is natural to explore more efficient numerical strategies, such as refining the computational grid only in regions of high activity. This practice  delves into this advanced topic by examining the use of Adaptive Mesh Refinement (AMR) in the context of turbulence simulation. By analyzing this scenario, you will confront the strict definition of DNS—resolving all scales, everywhere, at all times—and learn why seemingly intelligent shortcuts can inadvertently introduce modeling errors, thereby violating the fundamental principles of the simulation approach.",
            "id": "3874570",
            "problem": "Consider a statistically steady, incompressible, homogeneous isotropic turbulence in a cubic, periodic domain of side length $L = 0.1\\,\\text{m}$ filled with water of kinematic viscosity $\\nu = 10^{-6}\\,\\text{m}^2/\\text{s}$. The mean turbulent kinetic energy dissipation rate is $\\varepsilon = 10^{-3}\\,\\text{m}^2/\\text{s}^3$. An Adaptive Mesh Refinement (AMR) simulation is proposed with a base grid spacing $\\Delta x_0 = 10^{-3}\\,\\text{m}$, a refinement ratio $r = 4$ per level, and a maximum of $\\ell_{\\max} = 2$ levels (so the finest spacing is $\\Delta x_f = \\Delta x_0 / r^{\\ell_{\\max}}$). Refinement is triggered by a vorticity threshold so that only the fraction $f_v = 0.2$ of the volume is covered by the finest level at any time.\n\nYou will assess whether this AMR configuration violates the principles of Direct Numerical Simulation (DNS), and whether adaptivity may still be used for passive scalar fronts under different Schmidt numbers. For this, use the following foundational facts:\n\n- The Kolmogorov length scale is $\\eta = \\left(\\nu^3/\\varepsilon\\right)^{1/4}$, and a necessary DNS resolution condition is that the largest resolved wavenumber $k_{\\max}$ satisfies $k_{\\max}\\,\\eta \\gtrsim 1$ throughout the domain at all times, where for a grid spacing $\\Delta x$ one may take $k_{\\max} \\approx \\pi/\\Delta x$.\n- The Batchelor scale for a passive scalar with Schmidt number $Sc$ is $\\eta_B = \\eta / \\sqrt{Sc}$, and DNS of the scalar requires $\\Delta x \\lesssim \\eta_B$ where scalar gradients are present.\n- For an inertial-range spectrum $E(k) = C\\,\\varepsilon^{2/3} k^{-5/3}$ between $k_0 \\approx 2\\pi/L$ and $k_\\eta \\approx 1/\\eta$, the fraction of kinetic energy residing at wavenumbers greater than a cutoff $k_c$ is approximately $\\left(k_0/k_c\\right)^{2/3}$ when $k_\\eta \\gg k_c \\gg k_0$.\n\nTasks:\n\n1. Compute the Kolmogorov scale $\\eta$, the corresponding $k_\\eta \\approx 1/\\eta$, and the nondimensional resolution indicators $k_{\\max,0}\\,\\eta$ and $k_{\\max,f}\\,\\eta$ for the base and finest AMR levels, where $k_{\\max,0} = \\pi/\\Delta x_0$ and $k_{\\max,f} = \\pi/\\Delta x_f$.\n\n2. Using $L = 0.1\\,\\text{m}$, estimate the inertial-range fraction of kinetic energy at wavenumbers greater than the base-level cutoff $k_{\\max,0}$ as $\\left(k_0/k_{\\max,0}\\right)^{2/3}$ with $k_0 = 2\\pi/L$. Then estimate the domain-averaged unresolved energy fraction if only the fraction $f_v = 0.2$ of the volume is refined to the finest level (assume the base-level unresolved fraction applies to the coarse fraction $1 - f_v$).\n\n3. For two passive scalars, one with $Sc_1 = 0.7$ and one with $Sc_2 = 700$, compute $\\eta_{B,1}$ and $\\eta_{B,2}$ and compare to $\\Delta x_f$ and $\\Delta x_0$ to assess whether the scalar fronts can be DNS-resolved by adaptivity in this AMR configuration and under what condition adaptivity is consistent with DNS for coupled velocity–scalar dynamics.\n\nBased on your calculations and first-principles reasoning, choose the correct statement:\n\nA. DNS is violated because coarse AMR levels have $k_{\\max}\\,\\eta < 1$, so unresolved velocity dynamics are implicitly filtered and dissipated like a subgrid model. Adaptivity is acceptable for passive scalar fronts only when the velocity field is DNS-resolved everywhere (i.e., $\\Delta x \\le \\eta$ across all levels), and the refined cells satisfy $\\Delta x \\le \\eta_B$ near the fronts; otherwise AMR corrupts scalar transport.\n\nB. DNS is not violated because the finest AMR level resolves $\\eta$ somewhere; coarse-to-fine refluxing conserves fluxes and eliminates implicit modeling. Adaptivity can always resolve scalar fronts even if $Sc \\gg 1$, because the Batchelor scale is larger than the Kolmogorov scale.\n\nC. DNS is violated only if the Courant–Friedrichs–Lewy (CFL) condition is broken; spatial resolution does not affect DNS validity. Adaptivity for scalar fronts is acceptable whenever $\\Delta t$ is sufficiently small, independent of $Sc$.\n\nD. DNS is violated on coarse levels if $k_{\\max}\\,\\eta < 1$, but this does not introduce implicit subgrid modeling—only local accuracy loss. Adaptivity for scalar fronts remains valid even when $\\Delta x_0 > \\eta$ if a refined band tracks the front; unresolved velocity away from the front does not affect scalar advection.",
            "solution": "The user has provided a problem concerning the validity of a Direct Numerical Simulation (DNS) in an Adaptive Mesh Refinement (AMR) framework. The task is to validate the problem statement and, if valid, perform a series of calculations to assess the simulation's adherence to DNS principles for both the velocity and passive scalar fields.\n\n### Problem Validation\n\nFirst, a meticulous validation of the problem statement is performed.\n\n**Step 1: Extract Givens**\n\nThe explicit data and definitions provided are:\n-   Flow characteristics: statistically steady, incompressible, homogeneous isotropic turbulence.\n-   Domain: cubic, periodic, side length $L = 0.1\\,\\text{m}$.\n-   Fluid properties: kinematic viscosity $\\nu = 10^{-6}\\,\\text{m}^2/\\text{s}$.\n-   Turbulence properties: mean turbulent kinetic energy dissipation rate $\\varepsilon = 10^{-3}\\,\\text{m}^2/\\text{s}^3$.\n-   AMR parameters:\n    -   Base grid spacing $\\Delta x_0 = 10^{-3}\\,\\text{m}$.\n    -   Refinement ratio $r = 4$.\n    -   Maximum refinement levels $\\ell_{\\max} = 2$.\n    -   Finest spacing $\\Delta x_f = \\Delta x_0 / r^{\\ell_{\\max}}$.\n    -   Refinement trigger: vorticity threshold.\n    -   Finest-level volume fraction $f_v = 0.2$.\n-   Key definitions and criteria:\n    -   Kolmogorov length scale: $\\eta = \\left(\\nu^3/\\varepsilon\\right)^{1/4}$.\n    -   DNS velocity resolution criterion: $k_{\\max}\\,\\eta \\gtrsim 1$, with $k_{\\max} \\approx \\pi/\\Delta x$.\n    -   Batchelor scale: $\\eta_B = \\eta / \\sqrt{Sc}$ for a passive scalar with Schmidt number $Sc$.\n    -   DNS scalar resolution criterion: $\\Delta x \\lesssim \\eta_B$ where scalar gradients are present.\n    -   Inertial-range energy fraction: fraction of kinetic energy for wavenumbers $> k_c$ is $\\approx (k_0/k_c)^{2/3}$ for $k_\\eta \\gg k_c \\gg k_0$, with $k_0 \\approx 2\\pi/L$ and $k_\\eta \\approx 1/\\eta$.\n-   Specific scalars for analysis: $Sc_1 = 0.7$ and $Sc_2 = 700$.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded:** The problem is firmly rooted in the classical theory of turbulence (Kolmogorov, Batchelor) and standard practices in computational fluid dynamics (DNS, AMR). The physical parameters are realistic for water. The definitions provided are standard and correct.\n-   **Well-Posed:** The problem provides all necessary data and clear, quantitative tasks. The final question is a logical deduction from the results of these tasks.\n-   **Objective:** The language is precise and technical. No subjective or opinion-based statements are present in the problem setup.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ambiguity. It presents a well-defined, verifiable, and non-trivial scenario for analysis.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The solution process will now proceed.\n\n### Solution Derivation\n\nThe derivation follows the three tasks specified in the problem statement.\n\n**Task 1: Kolmogorov Scale and Resolution Indicators**\n\nThe Kolmogorov length scale, $\\eta$, is calculated first:\n$$ \\eta = \\left(\\frac{\\nu^3}{\\varepsilon}\\right)^{1/4} = \\left(\\frac{(10^{-6}\\,\\text{m}^2/\\text{s})^3}{10^{-3}\\,\\text{m}^2/\\text{s}^3}\\right)^{1/4} = \\left(\\frac{10^{-18}}{10^{-3}}\\right)^{1/4}\\,\\text{m} = (10^{-15})^{1/4}\\,\\text{m} $$\n$$ \\eta = 10^{-3.75}\\,\\text{m} \\approx 1.778 \\times 10^{-4}\\,\\text{m} $$\nThe corresponding Kolmogorov wavenumber is $k_\\eta \\approx 1/\\eta \\approx 1/(1.778 \\times 10^{-4}\\,\\text{m}) \\approx 5624\\,\\text{m}^{-1}$.\n\nNext, we determine the grid spacings and the maximum resolved wavenumbers, $k_{\\max} \\approx \\pi/\\Delta x$.\n-   **Base level:**\n    -   Grid spacing: $\\Delta x_0 = 10^{-3}\\,\\text{m}$.\n    -   Maximum wavenumber: $k_{\\max,0} = \\pi/\\Delta x_0 = \\pi/(10^{-3}\\,\\text{m}) = 1000\\pi\\,\\text{m}^{-1} \\approx 3141.6\\,\\text{m}^{-1}$.\n-   **Finest level:**\n    -   Grid spacing: $\\Delta x_f = \\Delta x_0 / r^{\\ell_{\\max}} = 10^{-3}\\,\\text{m} / 4^2 = 10^{-3}\\,\\text{m} / 16 = 6.25 \\times 10^{-5}\\,\\text{m}$.\n    -   Maximum wavenumber: $k_{\\max,f} = \\pi/\\Delta x_f = \\pi/(6.25 \\times 10^{-5}\\,\\text{m}) = 16000\\pi\\,\\text{m}^{-1} \\approx 50265\\,\\text{m}^{-1}$.\n\nNow, we compute the nondimensional resolution indicator $k_{\\max}\\eta$ for each level.\n-   **Base level resolution:** $k_{\\max,0}\\,\\eta \\approx (3141.6\\,\\text{m}^{-1}) \\times (1.778 \\times 10^{-4}\\,\\text{m}) \\approx 0.559$.\n-   **Finest level resolution:** $k_{\\max,f}\\,\\eta \\approx (50265\\,\\text{m}^{-1}) \\times (1.778 \\times 10^{-4}\\,\\text{m}) \\approx 8.937$.\n\nThe DNS criterion requires $k_{\\max}\\eta \\gtrsim 1$. The base level, with $k_{\\max,0}\\eta \\approx 0.559 < 1$, fails to meet this condition. It does not resolve the Kolmogorov scale. The finest level, with $k_{\\max,f}\\eta \\approx 8.94 \\gg 1$, is sufficiently resolved for a DNS. Since $1 - f_v = 0.8$ or $80\\%$ of the domain is not resolved to the finest level and is thus under-resolved, the simulation as a whole cannot be considered a DNS.\n\n**Task 2: Unresolved Energy Fraction**\n\nThe fraction of kinetic energy at wavenumbers greater than the base-level cutoff $k_c = k_{\\max,0}$ is estimated using the provided inertial-range formula.\nThe large-eddy wavenumber is $k_0 = 2\\pi/L = 2\\pi/(0.1\\,\\text{m}) = 20\\pi\\,\\text{m}^{-1}$.\nThe cutoff wavenumber is $k_c = k_{\\max,0} = 1000\\pi\\,\\text{m}^{-1}$.\n\nThe fraction of unresolved energy on the coarse grid is:\n$$ \\left(\\frac{k_0}{k_{\\max,0}}\\right)^{2/3} = \\left(\\frac{20\\pi}{1000\\pi}\\right)^{2/3} = \\left(\\frac{1}{50}\\right)^{2/3} \\approx (0.02)^{2/3} \\approx 0.0737 $$\nThis means approximately $7.4\\%$ of the kinetic energy is unresolved on the coarse grid. In a true DNS, this fraction must be negligible.\n\nThe domain-averaged unresolved energy fraction is estimated by considering the volume fractions. The fraction of the volume at the coarse level is $1-f_v = 0.8$. The fraction at the fine level is $f_v = 0.2$. On the fine level, the resolution is adequate so the unresolved energy is assumed to be zero.\n$$ \\text{Avg. Unresolved Fraction} \\approx (1 - f_v) \\times \\left(\\frac{k_0}{k_{\\max,0}}\\right)^{2/3} + f_v \\times 0 $$\n$$ \\text{Avg. Unresolved Fraction} \\approx 0.8 \\times 0.0737 \\approx 0.059 $$\nApproximately $5.9\\%$ of the total kinetic energy is unresolved in the domain. A simulation that fails to resolve this amount of energy is not a DNS. The energy in these unresolved scales is artificially dissipated by the numerical scheme, which acts as an implicit subgrid-scale (SGS) model.\n\n**Task 3: Passive Scalar Resolution**\n\nThe resolution for passive scalars depends on the Batchelor scale, $\\eta_B = \\eta/\\sqrt{Sc}$.\n-   **Scalar 1: $Sc_1 = 0.7$**\n    $$ \\eta_{B,1} = \\frac{\\eta}{\\sqrt{0.7}} \\approx \\frac{1.778 \\times 10^{-4}\\,\\text{m}}{0.837} \\approx 2.125 \\times 10^{-4}\\,\\text{m} $$\n    For $Sc<1$, we have $\\eta_B > \\eta$. The scalar field is smoother than the velocity field.\n    -   Finest grid: $\\Delta x_f = 6.25 \\times 10^{-5}\\,\\text{m}$. Since $\\Delta x_f < \\eta_{B,1}$, the fine grid can resolve the scalar front.\n    -   However, the transport of the scalar field is governed by the velocity field. Since the velocity field is under-resolved on the coarse grid ($80\\%$ of the domain), the advection of the scalar is corrupted. Small-scale velocity structures that stretch and fold the scalar field are filtered out on the coarse grid. Therefore, even if the scalar dissipation scale is resolved locally, the simulation is not a DNS of the scalar transport because the advecting velocity field is not a DNS field.\n\n-   **Scalar 2: $Sc_2 = 700$**\n    $$ \\eta_{B,2} = \\frac{\\eta}{\\sqrt{700}} \\approx \\frac{1.778 \\times 10^{-4}\\,\\text{m}}{26.46} \\approx 6.72 \\times 10^{-6}\\,\\text{m} $$\n    For $Sc \\gg 1$, we have $\\eta_B \\ll \\eta$. The scalar field has much smaller structures than the velocity field.\n    -   Finest grid: $\\Delta x_f = 6.25 \\times 10^{-5}\\,\\text{m}$.\n    -   Comparison: $\\Delta x_f / \\eta_{B,2} \\approx (6.25 \\times 10^{-5}) / (6.72 \\times 10^{-6}) \\approx 9.3$.\n    The finest grid spacing is nearly an order of magnitude larger than the Batchelor scale. Thus, even the finest level of the AMR grid is incapable of resolving the scalar field structures for $Sc = 700$. A DNS is impossible under this configuration.\n\n**Conclusion on DNS Principles:**\nA defining feature of DNS is the complete resolution of all dynamically significant scales of motion, for all fields, everywhere in the domain and at all times. The proposed AMR setup violates this by having a coarse grid that does not resolve the Kolmogorov scale. This introduces implicit modeling, disqualifying it as a DNS. For coupled scalar-velocity problems, a DNS of the scalar requires a DNS of the velocity field.\n\n### Option-by-Option Analysis\n\n**A. DNS is violated because coarse AMR levels have $k_{\\max}\\,\\eta < 1$, so unresolved velocity dynamics are implicitly filtered and dissipated like a subgrid model. Adaptivity is acceptable for passive scalar fronts only when the velocity field is DNS-resolved everywhere (i.e., $\\Delta x \\le \\eta$ across all levels), and the refined cells satisfy $\\Delta x \\le \\eta_B$ near the fronts; otherwise AMR corrupts scalar transport.**\nThis statement is fully supported by the analysis.\n1.  The calculation $k_{\\max,0}\\eta \\approx 0.559 < 1$ confirms the coarse grid is under-resolved.\n2.  The non-negligible unresolved energy fraction implies the existence of an implicit SGS model via numerical dissipation.\n3.  The requirement for the velocity field to be fully resolved everywhere for a valid scalar DNS is a cornerstone of turbulence simulation theory. AMR can be used in a DNS context, but only if the *coarsest* level still satisfies the DNS resolution criteria. Adaptivity is then used to resolve even smaller scales (like $\\eta_B$ for high $Sc$) where they appear.\nThis statement is **Correct**.\n\n**B. DNS is not violated because the finest AMR level resolves $\\eta$ somewhere; coarse-to-fine refluxing conserves fluxes and eliminates implicit modeling. Adaptivity can always resolve scalar fronts even if $Sc \\gg 1$, because the Batchelor scale is larger than the Kolmogorov scale.**\nThis statement contains multiple falsehoods.\n1.  DNS requires resolution *everywhere*, not \"somewhere\".\n2.  Refluxing ensures conservation but does not create subgrid-scale information or eliminate the implicit filtering on the coarse grid.\n3.  For $Sc \\gg 1$, the Batchelor scale $\\eta_B = \\eta/\\sqrt{Sc}$ is *smaller* than the Kolmogorov scale, not larger.\nThis statement is **Incorrect**.\n\n**C. DNS is violated only if the Courant–Friedrichs–Lewy (CFL) condition is broken; spatial resolution does not affect DNS validity. Adaptivity for scalar fronts is acceptable whenever $\\Delta t$ is sufficiently small, independent of $Sc$.**\nThis statement incorrectly equates numerical stability with DNS fidelity.\n1.  DNS is defined by *spatial* resolution, not the CFL condition, which relates to temporal stability.\n2.  Resolving scalar fronts requires adequate *spatial* resolution ($\\Delta x \\lesssim \\eta_B$), which is strongly dependent on $Sc$. A small time step $\\Delta t$ cannot fix an inadequate spatial grid.\nThis statement is **Incorrect**.\n\n**D. DNS is violated on coarse levels if $k_{\\max}\\,\\eta < 1$, but this does not introduce implicit subgrid modeling—only local accuracy loss. Adaptivity for scalar fronts remains valid even when $\\Delta x_0 > \\eta$ if a refined band tracks the front; unresolved velocity away from the front does not affect scalar advection.**\nThis statement incorrectly minimizes the consequences of under-resolution.\n1.  Systematic removal of energy from unresolved scales by the numerical scheme is the definition of an implicit subgrid model. It is more than a \"local accuracy loss\"; it is a change in the physics being simulated.\n2.  Turbulent transport is non-local. Under-resolved velocity structures from coarse regions are advected and will contaminate the entire flow field, including the regions where the scalar front is being tracked. The assumption of locality is invalid.\nThis statement is **Incorrect**.\n\nFinal conclusion: Statement A is the only one that presents a scientifically and logically sound analysis of the problem.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}