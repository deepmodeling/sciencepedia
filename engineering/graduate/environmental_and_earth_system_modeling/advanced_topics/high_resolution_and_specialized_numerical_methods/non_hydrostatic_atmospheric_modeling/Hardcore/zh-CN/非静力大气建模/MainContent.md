## 引言
从猛烈的雷暴到翻越山脉时产生的[湍流](@entry_id:151300)，许多对天气和安全至关重要的大气现象都发生在[静力平衡](@entry_id:163498)假设不再成立的尺度上。非静力大气模型是理解、模拟和预测这些复杂过程不可或缺的科学工具。然而，传统的、计算效率更高的大尺度模型往往依赖[静力平衡近似](@entry_id:1126281)，这在面对强垂直运动时会产生显著偏差，留下了一片关键的认知空白。本文旨在系统性地填补这一空白，为读者构建一个关于非静力大气模型的完整知识框架。

在接下来的内容中，我们将开启一段从理论到实践的探索之旅。在“原理与机制”一章，我们将深入剖析[非静力模型](@entry_id:1128852)的物理基础和数学方程，揭示垂直加速度背后的核心驱动力，并探讨将这些方程转化为可靠数值代码所面临的挑战。随后，在“应用与交叉学科联系”一章，我们将展示这些模型在模拟真实世界现象（如热带[气旋](@entry_id:262310)、地形波、野火蔓延）中的强大能力，并阐明其与云物理、辐射等过程的深刻联系。最后，“动手实践”部分将通过具体的计算问题，帮助您将理论知识转化为解决实际问题的技能。

## 原理与机制

本章旨在深入探讨非静力大气模型的核心物理原理与数学机制。我们将从[静力平衡](@entry_id:163498)假设的局限性出发，阐明为何以及何时需要[非静力模型](@entry_id:1128852)。随后，我们将推导并剖析非静力流动的完整控制方程组，并特别关注驱动垂直运动的关键力学机制。最后，我们将讨论在将这些连续方程离散化以进行[数值模拟](@entry_id:146043)时所面临的独特挑战，以及为应对这些挑战而发展出的先进数值策略。

### [静力平衡](@entry_id:163498)的失效：为何需要[非静力模型](@entry_id:1128852)

大气科学中的许多大尺度现象，如全球环流和天气尺度系统，都可以通过**静力平衡近似（hydrostatic approximation）**得到精确描述。该近似假设在垂直方向上，向上的气压[梯度力](@entry_id:166847)与向下的重力精确平衡，从而忽略了空气块的垂直加速度。然而，当我们将目光投向更小尺度的现象时，这一基本假设便可能失效。

我们从垂直方向的动量方程出发来理解这一点，该方程是[牛顿第二定律](@entry_id:274217)在流体中的直接应用：
$$
\frac{Dw}{Dt} = \frac{\partial w}{\partial t} + u\frac{\partial w}{\partial x} + v\frac{\partial w}{\partial y} + w\frac{\partial w}{\partial z} = -\frac{1}{\rho}\frac{\partial p}{\partial z} - g
$$
其中，$w$ 是垂直速度，$p$ 是气压，$\rho$ 是密度，$g$ 是[重力加速度](@entry_id:173411)，而 $\frac{Dw}{Dt}$ 代表流体质点的[物质导数](@entry_id:262900)，即其总垂直加速度。静力平衡近似的核心就是假设左侧的垂直加速度项 $\frac{Dw}{Dt}$ 与右侧两个巨大的力（气压[梯度力](@entry_id:166847)和重力）相比可以忽略不计，即 $\frac{Dw}{Dt} \approx 0$。这使得[垂直动量方程](@entry_id:1133792)简化为一个诊断关系式：$\frac{\partial p}{\partial z} \approx -\rho g$。

那么，何时这个近似会失效呢？一个常见的误解是认为只有当垂直加速度的大小与重力加速度 $g$（约 $9.8 \, \mathrm{m\,s^{-2}}$）相当时，非静力效应才变得重要。然而，正确的判断标准远比这更为精妙。在大气中，背景气压[梯度力](@entry_id:166847)与重力几乎总是处于近乎完美的平衡状态。驱动垂直运动的，是这种平衡被破坏后产生的微小“净”力。因此，我们应该将垂直加速度与这些驱动力进行比较，而不是与重力本身比较。

让我们以一个典型的深对流云（如雷暴）为例进行尺度分析 。在这种天气系统中，典型的上升速度可达 $w \sim 10 \, \mathrm{m\,s^{-1}}$，其垂直尺度 $H \sim 10 \, \mathrm{km}$。我们可以估计垂直加速度的大小。其中，垂直平流项 $w \frac{\partial w}{\partial z}$ 的尺度约为 $W^2/H$，其中 $W$ 和 $H$ 分别是特征垂直速度和垂直长度尺度。代入数值，我们得到：
$$
\left| \frac{Dw}{Dt} \right| \sim \frac{W^2}{H} \approx \frac{(10 \, \mathrm{m\,s^{-1}})^2}{10^4 \, \mathrm{m}} = \frac{100}{10000} \, \mathrm{m\,s^{-2}} = 0.01 \, \mathrm{m\,s^{-2}}
$$
这个加速度虽然远小于 $g$，但它是否可以忽略，取决于它与驱动对流的**[浮力](@entry_id:154088)（buoyancy）**相比如何。[浮力](@entry_id:154088)是由于云内暖湿空气密度低于周围环境空气而产生的向上净力。在典型的深对流中，[浮力](@entry_id:154088)产生的加速度量级通常在 $10^{-2}$ 到 $10^{-1} \, \mathrm{m\,s^{-2}}$ 之间。显然，我们估算出的垂直加速度 $0.01 \, \mathrm{m\,s^{-2}}$ 与驱动运动的[浮力](@entry_id:154088)是同一量级。因此，在[深对流](@entry_id:1123472)这类现象中，垂直加速度是垂直[力平衡](@entry_id:267186)中的一个[主导项](@entry_id:167418)，绝不能忽略。这意味着，要准确模拟这类现象，必须使用**[非静力模型](@entry_id:1128852)（non-hydrostatic model）**。

我们可以使用一系列[无量纲数](@entry_id:260863)来更系统地判定不同物理过程的相对重要性 。在[分层流体](@entry_id:181098)中，**弗劳德数（Froude number）** $Fr = U/(NL)$（或在某些情况下用 $U/(NH)$ 定义）常被用来比较惯性力与[浮力](@entry_id:154088)（由[Brunt–Väisälä频率](@entry_id:1121902) $N$ 表征）的相对大小。其中 $U$ 是特征水平速度，$L$ 和 $H$ 分别是水平和垂直尺度。当 $Fr \ll 1$ 时，流动是“浅”的（$H \ll L$），垂直运动受到强烈的层结抑制，流动近似满足[静力平衡](@entry_id:163498)。当 $Fr \sim \mathcal{O}(1)$ 时，表明垂直加速度与[浮力](@entry_id:154088)相当，非静力效应变得至关重要。

通过一个更具体的尺度分析，我们可以推导出[静力平衡](@entry_id:163498)失效的[临界条件](@entry_id:201918) 。在许多非静力现象（如[山地波](@entry_id:1128215)和深对流）中，流动的水平和垂直尺度相当，即 $L \sim H$。在这种情况下，衡量非静力效应重要性的无量纲参数可简化为 $\delta \sim U^2/(N^2H^2)$。当 $\delta \sim 1$ 时，[静力平衡](@entry_id:163498)假设开始失效。这给出了一个[临界流](@entry_id:275258)速 $U_{\mathrm{crit}}$：
$$
U_{\mathrm{crit}} = NH
$$
对于典型的大气层结，$N \sim 0.01 \, \mathrm{s^{-1}}$，垂直尺度 $H \sim 10 \, \mathrm{km} = 10^4 \, \mathrm{m}$，我们得到的[临界速度](@entry_id:161155)为 $U_{\mathrm{crit}} \approx 100 \, \mathrm{m\,s^{-1}}$。这意味着当强风（如急流）与陡峭地形相互作用时，即使没有强烈的对流，也可能需要[非静力模型](@entry_id:1128852)来准确刻画。

### 非静力流动的控制方程与核心机制

既然已经确定了[非静力模型](@entry_id:1128852)在特定物理情境下的必要性，我们接下来将系统地阐述其数学框架。[非静力模型](@entry_id:1128852)的核心在于保留了完整的[垂直动量方程](@entry_id:1133792)。

一个可压缩、旋转大气中的完整非静力方程组，可以用**[通量形式](@entry_id:273811)（flux form）** 写出，这在数值模型中尤其重要，因为它确保了质量、动量和能量等守恒属性 。
- **[质量守恒](@entry_id:204015)（连续性方程）**:
$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \boldsymbol{v}) = 0
$$
- **动量守恒**:
$$
\frac{\partial (\rho \boldsymbol{v})}{\partial t} + \nabla \cdot (\rho \boldsymbol{v} \otimes \boldsymbol{v} + p \boldsymbol{I}) = - 2 \rho \,\boldsymbol{\Omega} \times \boldsymbol{v} - \rho \,\nabla \Phi + \nabla \cdot \boldsymbol{\tau}
$$
- **[热力学](@entry_id:172368)能量守恒 (以位温 $\theta$ 为例)**:
$$
\frac{\partial (\rho \theta)}{\partial t} + \nabla \cdot (\rho \theta \boldsymbol{v}) = \text{源/汇项}
$$
其中 $\boldsymbol{v}$ 是三维速度矢量，$\boldsymbol{I}$ 是单位张量，$\boldsymbol{\Omega}$ 是地球自转角速度矢量，$\Phi$ 是重力势，$\boldsymbol{\tau}$ 代表[粘性应力](@entry_id:261328)张量。这套方程与静力[原始方程](@entry_id:1130162)组的根本区别在于，它对三维动量 $\rho \boldsymbol{v}$（包括垂直分量）都进行预报，而不是用[静力平衡](@entry_id:163498)关系式来诊断垂直气压分布。

为了更深入地理解驱动垂直运动的机制，我们将物理场分解为一个随高度变化的**背景态（base state）**（用上划线表示）和一个**扰动（perturbation）**（用撇号表示），例如 $p = \bar{p}(z) + p'$ 。背景态被定义为满足[静力平衡](@entry_id:163498)，即 $\frac{d\bar{p}}{dz} = -\bar{\rho}g$。将这个分解代入[垂直动量方程](@entry_id:1133792)，经过一系列代数运算，并在线性化的假设下（即扰动远小于背景态），我们可以得到一个更具洞察力的方程形式：
$$
\frac{Dw}{Dt} \approx -\frac{1}{\bar{\rho}} \frac{\partial p'}{\partial z} + b
$$
这里的 $\bar{\rho}$ 是背景密度。这个方程清晰地揭示了驱动垂直加速度的两个核心力：**扰动气压[梯度力](@entry_id:166847)**（$-\frac{1}{\bar{\rho}} \frac{\partial p'}{\partial z}$）和**[浮力](@entry_id:154088)**（$b$）。

[浮力](@entry_id:154088) $b$ 是空气块与其周围环境之间密度差异的结果。根据[理想气体定律](@entry_id:146757)，密度与温度成反比，因此一个比环境更暖（密度更小）的空气块会受到向上的[浮力](@entry_id:154088)。在考虑水汽影响时，我们通常使用[虚位温](@entry_id:1133825) $\theta_v$。[浮力](@entry_id:154088)可以精确地定义为 ：
$$
b \equiv g \frac{\theta_v^{(p)} - \overline{\theta_v}}{\overline{\theta_v}} = g \frac{\theta_v'}{\overline{\theta_v}}
$$
其中 $\theta_v^{(p)}$ 是空气块的[虚位温](@entry_id:1133825)，$\overline{\theta_v}$ 是环境的[虚位温](@entry_id:1133825)。当空气块比环境暖（$\theta_v' > 0$）时，[浮力](@entry_id:154088)为正，产生向上的加速度。

扰动气压 $p'$ 的角色则更为微妙和关键。它并非一个独立的、由[热力学](@entry_id:172368)直接决定的量，而是一个**诊断量** 。它的存在是为了确保整个流体运动在任何时刻都满足[质量守恒](@entry_id:204015)（连续性）约束。当我们对整个[动量方程](@entry_id:197225)组求散度，并结合[连续性方程](@entry_id:195013)时，会得到一个关于扰动气压 $p'$ 的**椭圆型方程**（通常是泊松方程），其形式大致为：
$$
\nabla^2 p' = \text{源项(依赖于速度场和浮力场)}
$$
这是一个极其重要的结果。椭圆型方程的解在数学上具有“非局域性”，意味着在某一点的扰动气压 $p'$ 的值，取决于整个流场区域的状况。物理上，这意味着当流体某处开始辐合或辐散时，气压场会“瞬间”调整，产生一个扰动气压[梯度力](@entry_id:166847)，该力作用于整个流场，以重新组织速度场，从而确保[质量守恒](@entry_id:204015)。例如，在一个即将产生上升运动的区域下方，会形成一个高压扰动（$p'>0$），而在其上方则形成一个低压扰动（$p'<0$）。这种压力差（从高压指向低压）产生的向上扰动气压[梯度力](@entry_id:166847)，与[浮力](@entry_id:154088)一起共同驱动空气向上加速。同样，在一个即将产生下沉运动的区域上方，会形成一个高压扰动（$p'>0$），而在其下方则形成一个低压扰动（$p'<0$），这种[垂直气压梯度](@entry_id:1133794) $-\frac{\partial p'}{\partial z}$ 就会驱动空气向下加速。

### 声波、[近似方案](@entry_id:267451)与数值挑战

完整的可压缩非静力方程组虽然精确，但在数值求解上带来了巨大挑战。主要挑战源于该系统所能支持的波类型。通过对该方程组进行线性化分析，可以发现其解中包含**声波（acoustic waves）**，其[色散关系](@entry_id:140395)为 $\omega^2 = c_s^2 (k^2 + m^2)$，其中 $c_s$ 是声速（在低层大气中约 $340 \, \mathrm{m\,s^{-1}}$），$k$ 和 $m$ 分别是水平和垂直波数 。

声波的[传播速度](@entry_id:189384)非常快，远超天气系统中的风速。在采用**[显式时间积分](@entry_id:165797)（explicit time integration）**的数值模型中，必须满足**Courant–Friedrichs–Lewy (CFL) 稳定条件**。该条件要求在一个时间步长 $\Delta t$ 内，[信息传播](@entry_id:1126500)的距离不能超过一个网格距。对于声波而言，这意味着：
$$
\Delta t \lesssim \frac{\min(\Delta x, \Delta z)}{c_s}
$$
其中 $\Delta x$ 和 $\Delta z$ 分别是水平和垂直网格距。在典型的高分辨率[非静力模型](@entry_id:1128852)中，垂直网格距 $\Delta z$ 可能只有几十到几百米。这导致允许的[稳定时间步长](@entry_id:755325) $\Delta t$ 极短（通常小于1秒），使得模型的计算成本异常高昂  。

为了在保留非静力效应的同时规避声波带来的计算负担，研究者发展了一系列近似方程组，它们都属于**[低马赫数近似](@entry_id:1127479)**（即流速远小于声速）。
- **Boussinesq 近似**: 这是最严格的近似，适用于垂直尺度远小于密度[标高](@entry_id:263754)（$L_z \ll H_\rho$）的“浅”层大气。它假设背景密度为常数 $\rho_0$，并且只在乘以重力的[浮力](@entry_id:154088)项中考虑密度变化。其连续性方程简化为流场无辐散：$\nabla \cdot \boldsymbol{v} = 0$。这有效地滤除了声波。
- **滞弹性近似（Anelastic approximation）**: 这是一个稍弱的近似，适用于垂直尺度与密度[标高](@entry_id:263754)相当（$L_z \sim H_\rho$）的“深”层大气。它允许背景密度 $\rho_0(z)$ 随高度变化，但通过修改[连续性方程](@entry_id:195013)为 $\nabla \cdot (\rho_0(z) \boldsymbol{v}) = 0$ 来过滤声波。该方程不再意味着流场无辐散，而是将辐散与通过层结的垂直运动联系起来。

静力近似本身也可以被看作是一种过滤机制。通过用诊断性的[静力平衡](@entry_id:163498)关系取代预报性的[垂直动量方程](@entry_id:1133792)，它破坏了产生垂直声波传播所需的压力-加速度反馈回路，从而彻底滤除了[垂直传播](@entry_id:204688)的声波 。这解释了为什么静力模型的[计算效率](@entry_id:270255)远高于完全可压缩的[非静力模型](@entry_id:1128852)。

### 现代数值求解策略

尽管滞弹性等[近似方案](@entry_id:267451)在理论研究和某些模型中很有用，但现代主流的非静力气象模型（如WRF模式）通常选择求解完整的可压缩方程组。它们不通过物理近似来过滤声波，而是采用更复杂的**[数值时间积分](@entry_id:752837)方案**来克服声波带来的CFL限制。

#### 应对快速声波的[时间积分](@entry_id:267413)方案

这些方案的核心思想是将方程中的项分为“快”项（驱动声波和重力波的线性项，如气压梯度项和散度项）和“慢”项（主要是[非线性](@entry_id:637147)的平流项）。通过对快、慢项采用不同的处理方式，可以在保证数值稳定性的同时，使用一个由慢过程（如平流）决定的、更长的“天气”时间步长  。

- **半隐式方案（Semi-implicit）**: 该方案对驱动[快波](@entry_id:1124857)的线性项在时间上采用隐式离散，而对慢的[非线性](@entry_id:637147)项采用显式离散。[隐式格式](@entry_id:166484)在理论上是[无条件稳定](@entry_id:146281)的，因此[快波](@entry_id:1124857)的CFL限制被移除。这种方法通常需要在一个时间步内求解一个全局的椭圆型方程（如[亥姆霍兹方程](@entry_id:149977)），计算量较大但非常有效。

- **分裂显式方案（Split-explicit）**: 也称为[时间分裂](@entry_id:1133185)方案。它使用一个由慢过程决定的长步长 $\Delta t$ 来积分整个方程组。在每一个长步长内，只对[快波](@entry_id:1124857)项使用多个满足其自身[CFL条件](@entry_id:178032)的小步长 $\Delta \tau$ 进行显式积分（即“声学子循环”）。由于慢项的计算（通常是模型中最昂贵的部分）只在长步长上执行一次，因此总[计算效率](@entry_id:270255)得以大幅提升。

- **水平显式垂直隐式方案（HEVI）**: 这种方案特别针对[非静力模型](@entry_id:1128852)中最严格的垂直声波CFL限制。它对水平方向的项采用显式处理，而对垂直方向的项采用隐式处理。这移除了与垂直网格距 $\Delta z$ 相关的CFL限制，使得时间步长由水平网格距和声速决定，这通常比原始限制宽松得多。

- **隐式-显式方案（IMEX）**: 这是一类更广泛的、系统性的方法，它将刚性（stiff）的快项分配给一个隐式求解器，将非刚性（non-stiff）的慢项分配给一个显式求解器，并将两者耦合在一个统一的[高阶时间积分](@entry_id:750308)框架内（如IMEX-[Runge-Kutta](@entry_id:140452)）。

#### 地形处理与[坐标变换](@entry_id:172727)

真实的大气流动发生在复杂的地形之上。为了在数值模型中优雅地处理不规则的下边界，大多数模型采用了**地形追随坐标（terrain-following coordinates）** 。在这种坐标系中，垂直坐标 $\eta$ 被定义为随地形起伏的曲面。例如，一个常见的[混合坐标](@entry_id:1126228)定义为 $p(x,y,\eta,t) = A(\eta) + B(\eta) p_s(x,y,t)$，其中 $p_s$ 是地表气压。

[坐标变换](@entry_id:172727)虽然解决了下边界问题，但也引入了新的复杂性。根据[链式法则](@entry_id:190743)，原直角坐标系中的水平[梯度算子](@entry_id:1125719)，在新的曲面坐标系中会分解为沿坐标面的梯度和与坐标面坡度相关的垂直梯度项。例如，水平气压[梯度力](@entry_id:166847)变为：
$$
-\frac{1}{\rho}\left.\frac{\partial p}{\partial x}\right|_{z} = -\frac{1}{\rho}\left.\frac{\partial p}{\partial x}\right|_{\eta} + \frac{1}{\rho}\frac{\left.\partial z/\partial x\right|_{\eta}}{\partial z/\partial \eta} \frac{\partial p}{\partial \eta}
$$
在陡峭地形上（即坐标面坡度 $\left.\partial z/\partial x\right|_{\eta}$ 很大），右侧的两个项都会变得非常大，但它们的符号相反，其和（即真实的水平气压[梯度力](@entry_id:166847)）却很小。在数值计算中，两个大数相减以得到一个小数，极易产生巨大的**[截断误差](@entry_id:140949)**，即所谓的**气压[梯度力](@entry_id:166847)计算误差（pressure-gradient force error）** 。这种误差会产生虚假的加速度，即便在静止的大气中也会凭空制造出强烈的伪风和伪波。

为了解决这个问题，现代[非静力模型](@entry_id:1128852)致力于发展**守恒且均衡的（well-balanced）**离散格式 。一个“均衡”的格式，其核心思想是确保离散化的气压[梯度力](@entry_id:166847)算子能够精确地识别并平衡离散的[静力平衡](@entry_id:163498)态。换言之，当模型被初始化为一个静止的、满足[静力平衡](@entry_id:163498)的大气时，离散后的气压[梯度力](@entry_id:166847)项之和必须精确为零（达到[机器精度](@entry_id:756332)）。这通常通过确保计算气压[梯度力](@entry_id:166847)不同分量的离散算子之间具有内在的数学一致性来实现，例如，采用所谓的“静力重构”方法。维持这种均衡特性至关重要，因为它能从根本上阻止虚假环流的产生，确保模型在复杂地形上能够准确模拟由地形强迫产生的真实、微弱的[大气波](@entry_id:187993)动。