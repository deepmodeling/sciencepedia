{
    "hands_on_practices": [
        {
            "introduction": "何时需要非静力模型？此练习通过对一个典型中尺度对流系统进行量级分析，为这个问题提供了定量解答。通过估算垂直加速度与静力平衡中各项的相对大小，您将亲身体会为何在模拟强对流等现象时，必须使用完整的垂直动量方程。",
            "id": "3898934",
            "problem": "考虑一个深对流飑线，其最强的上升气流占据一个深度约为 $5$ km 的层。观测表明，其特征垂直速度量级为 $w \\sim 15$ m s$^{-1}$，在 $\\Delta z \\sim 5$ km 的垂直范围内，垂直压力扰动（相对于静水平衡基态）的量级为 $\\Delta p \\sim 2$ kPa。假设空气密度随高度近似恒定，为 $\\rho \\sim 1$ kg m$^{-3}$，重力加速度为 $g = 9.81$ m s$^{-2}$。在此尺度下，可以忽略粘性效应和垂直科里奥利力。\n\n从可压缩动量方程的垂直分量和基态的静水平衡出发，推导物质垂直加速度的尺度估计，并用它来量化其相对于单位质量的静水压力梯度的量级。具体来说，使用物质导数的量纲分析来估计特征物质垂直加速度，然后构建该加速度与单位质量的静水压力梯度量级之比 $\\varepsilon$。\n\n报告使用给定数据计算出的无量纲比值 $\\varepsilon$ 的数值。将您的答案四舍五入到三位有效数字。",
            "solution": "适当的出发点是可压缩动量方程的垂直分量，\n$$\n\\frac{D w}{D t} \\;=\\; -\\,\\frac{1}{\\rho}\\,\\frac{\\partial p}{\\partial z} \\;-\\; g \\;+\\; \\text{(粘性项和其他小项)}.\n$$\n静水平衡基态 $(p_0,\\rho_0)$ 满足\n$$\n\\frac{\\partial p_0}{\\partial z} \\;=\\; -\\,\\rho_0\\,g.\n$$\n将物理量分解为基态加扰动，即 $p = p_0 + p'$ 和 $\\rho = \\rho_0 + \\rho'$，然后减去静水平衡方程，得到扰动形式\n$$\n\\frac{D w}{D t} \\;=\\; -\\,\\frac{1}{\\rho}\\,\\frac{\\partial p'}{\\partial z} \\;-\\; g\\,\\frac{\\rho'}{\\rho} \\;+\\; \\text{(粘性项和其他小项)}.\n$$\n为了进行尺度估计，我们考虑一个特征垂直尺度 $L_z$ 和一个速度尺度 $w$。通过量纲分析，物质导数的尺度可表示为\n$$\n\\left|\\frac{D w}{D t}\\right| \\;\\sim\\; \\frac{w^2}{L_z},\n$$\n因为 $|\\partial w/\\partial z| \\sim w/L_z$，并且在强对流中，平流项 $w\\,\\partial w/\\partial z$ 在此尺度上主导了局地变化趋势。单位质量的静水压力梯度量级就是 $g$，因为在静水平衡中 $-(1/\\rho)\\,\\partial p_0/\\partial z = g$。\n\n因此，所求的无量纲比值为\n$$\n\\varepsilon \\;=\\; \\frac{\\text{特征物质垂直加速度}}{\\text{静水压力梯度加速度}} \\;\\sim\\; \\frac{w^2/L_z}{g} \\;=\\; \\frac{w^2}{g\\,L_z}.\n$$\n使用给定值 $w = 15$ m s$^{-1}$ 和 $L_z = \\Delta z = 5$ km $= 5000$ m，以及 $g = 9.81$ m s$^{-2}$，我们得到\n$$\n\\varepsilon \\;=\\; \\frac{(15)^2}{9.81 \\times 5000} \\;=\\; \\frac{225}{49050} \\;=\\; \\frac{1}{218} \\;\\approx\\; 0.004587\\ldots\n$$\n四舍五入到三位有效数字，结果是\n$$\n\\varepsilon \\;\\approx\\; 0.00459\n$$\n作为与非静力动力学相关的一致性检查，给定层内的压力扰动 $\\Delta p \\sim 2000$ Pa（在 $\\Delta z \\sim 5000$ m 范围内），意味着非静水压力梯度加速度的量级为\n$$\n\\left|\\frac{1}{\\rho}\\frac{\\Delta p}{\\Delta z}\\right| \\;\\sim\\; \\frac{2000}{1 \\times 5000} \\;=\\; 0.4 \\ \\text{m s}^{-2},\n$$\n这是 $g$ 的一个不可忽略的部分（约 $0.041$）。尽管物质垂直加速度与 $g$ 相比很小（$\\varepsilon \\approx 0.00459$），但它与非静水压力梯度加速度和浮力加速度的量级相同，而这些项必须保留才能捕捉观测到的垂直运动。这种尺度分析证明了非静力模拟的必要性，在非静力模拟中，垂直动量方程的求解不施加静水平衡的约束。",
            "answer": "$$\\boxed{0.00459}$$"
        },
        {
            "introduction": "建立一个稳定的数值模式是成功模拟的第一步，而这始于对时间步长的恰当选择。此练习将引导您应用 Courant-Friedrichs-Lewy (CFL) 稳定性准则，这是显式平流方案的核心数值约束。您将为一个具有不同水平和垂直分辨率的计算网格，计算出保证数值积分稳定的最大时间步长，这是非静力模型开发中的一项基本技能。",
            "id": "3898925",
            "problem": "一个用于可压缩流的非静力大气模型，在均匀网格上，通过水平和垂直方向上的显式平流来推进预报变量（例如，速度和位温）。考虑一个单一时间步，其中水平风速为 $U = 20\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，垂直速度为 $w = 5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，水平网格间距为 $\\Delta x = 1\\,\\mathrm{km}$，垂直网格间距为 $\\Delta z = 100\\,\\mathrm{m}$。平流算子通过单调迎风有限体积通量进行离散化，时间积分使用三阶强稳定保持龙格-库塔（SSP RK3）方法。假设采用非分裂更新方式，即同时应用水平和垂直平流通量。\n\n从线性平流的第一性原理以及显式方法的Courant–Friedrichs–Lewy (CFL) 稳定性要求出发，完成以下任务：\n\n- 根据时间步长 $\\Delta t$ 和给定参数，构建水平和垂直平流的无量纲Courant数。\n- 推导在二维情况下，对于采用单调空间通量和SSP RK3时间积分的非分裂显式平流更新，关于 $\\Delta t$ 的稳定性约束。\n- 使用推导出的约束，选择能同时满足水平和垂直平流稳定性的最大时间步长。\n\n以秒为单位表示最终的时间步长。最终答案必须是单一实数值。除精确算术外，不需要进行四舍五入。",
            "solution": "该问题要求计算一个使用特定数值方案求解的二维线性平流问题的最大稳定时间步长 $\\Delta t$。对于一个在二维域 $(x, z)$ 中，具有恒定速度 $U$ 和 $w$ 的守恒标量 $q$，其控制偏微分方程 (PDE) 为：\n$$\n\\frac{\\partial q}{\\partial t} + U \\frac{\\partial q}{\\partial x} + w \\frac{\\partial q}{\\partial z} = 0\n$$\n\n求解过程包括问题陈述中要求的三个步骤。\n\n首先，我们构建无量纲Courant数。Courant数表示在一维情况下，信息在单个时间步内穿过的网格单元的分数。对于水平 ($x$) 和垂直 ($z$) 方向，Courant数（分别表示为 $C_x$ 和 $C_z$）定义如下：\n$$\nC_x = \\frac{|U| \\Delta t}{\\Delta x}\n$$\n$$\nC_z = \\frac{|w| \\Delta t}{\\Delta z}\n$$\n其中，$\\Delta t$ 是时间步长， $|U|$ 和 $|w|$ 是平流速度的大小，$\\Delta x$ 和 $\\Delta z$ 是相应方向上的网格间距。\n\n其次，我们推导稳定性约束。平流方程显式时间积分方案的数值稳定性由Courant–Friedrichs–Lewy (CFL) 条件决定。该条件将时间步长 $\\Delta t$ 与网格间距和波传播速度联系起来。\n\n问题指定了“非分裂”更新，即水平和垂直平流被同时处理。空间离散化采用“单调迎风有限体积通量”。此类格式最简单和最基本的例子是一阶迎风格式。对于正速度 $U  0$ 和 $w  0$，在网格点 $(i, j)$ 处PDE的半离散形式为：\n$$\n\\frac{dq_{i,j}}{dt} = -\\frac{U}{\\Delta x}(q_{i,j} - q_{i-1,j}) - \\frac{w}{\\Delta z}(q_{i,j} - q_{i,j-1})\n$$\n如果该系统使用一阶向前欧拉法进行时间积分，则此二维、非分裂、一阶迎风格式的稳定性条件是个别Courant数之和：\n$$\nC_x + C_z \\le 1\n$$\n即\n$$\n\\frac{|U| \\Delta t}{\\Delta x} + \\frac{|w| \\Delta t}{\\Delta z} \\le 1\n$$\n问题指定使用三阶强稳定保持龙格-库塔 (SSP RK3) 方法进行时间积分。SSP方法的一个关键特性是，它们被设计用来在一个特定的时间步长约束下，保持向前欧拉法的稳定性（和单调性）。对于如此处所考虑的线性双曲问题，当使用如一阶迎风之类的单调格式进行离散化时，标准的三阶SSP RK方法的SSP系数为 $1$。这意味着SSP RK3格式稳定的充分必要条件是向前欧拉格式稳定。因此，SSP RK3和迎风空间格式组合的稳定性约束与向前欧拉法的CFL条件相同。由此推导出的稳定性约束为：\n$$\n\\frac{|U| \\Delta t}{\\Delta x} + \\frac{|w| \\Delta t}{\\Delta z} \\le 1\n$$\n\n第三，我们使用推导出的约束来找到最大稳定时间步长 $\\Delta t_{max}$。我们可以通过提出因子 $\\Delta t$ 来重新整理稳定性不等式：\n$$\n\\Delta t \\left( \\frac{|U|}{\\Delta x} + \\frac{|w|}{\\Delta z} \\right) \\le 1\n$$\n最大稳定时间步长对应于等式成立的情况：\n$$\n\\Delta t_{max} = \\frac{1}{\\frac{|U|}{\\Delta x} + \\frac{|w|}{\\Delta z}}\n$$\n现在我们将给定的数值代入此表达式。参数如下：\n- 水平风速: $U = 20\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- 垂直速度: $w = 5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- 水平网格间距: $\\Delta x = 1\\,\\mathrm{km} = 1000\\,\\mathrm{m}$\n- 垂直网格间距: $\\Delta z = 100\\,\\mathrm{m}$\n\n首先，我们计算分母中的各项：\n$$\n\\frac{|U|}{\\Delta x} = \\frac{20\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{1000\\,\\mathrm{m}} = 0.02\\,\\mathrm{s}^{-1}\n$$\n$$\n\\frac{|w|}{\\Delta z} = \\frac{5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{100\\,\\mathrm{m}} = 0.05\\,\\mathrm{s}^{-1}\n$$\n这些项的和为：\n$$\n\\frac{|U|}{\\Delta x} + \\frac{|w|}{\\Delta z} = 0.02\\,\\mathrm{s}^{-1} + 0.05\\,\\mathrm{s}^{-1} = 0.07\\,\\mathrm{s}^{-1}\n$$\n最后，我们计算最大稳定时间步长：\n$$\n\\Delta t_{max} = \\frac{1}{0.07\\,\\mathrm{s}^{-1}} = \\frac{1}{\\frac{7}{100}}\\,\\mathrm{s} = \\frac{100}{7}\\,\\mathrm{s}\n$$\n能同时满足水平和垂直平流稳定性的最大时间步长是 $\\frac{100}{7}$ 秒。",
            "answer": "$$\\boxed{\\frac{100}{7}}$$"
        },
        {
            "introduction": "在复杂地形上进行精确模拟是非静力模式面临的一大挑战，这通常需要使用地形追随坐标系。此练习揭示了一个经典的数值误差问题——虚假的气压梯度力，它可能在静止大气中人为地产生气流。通过推导此误差的来源，您将深刻理解为何必须采用“守恒平衡” (well-balanced) 的数值格式来确保模型在复杂地形上的准确性。",
            "id": "4068851",
            "problem": "考虑一个在陡峭地形上处于静止静力平衡状态的二维、干燥、可压缩、非静力大气。该静止状态满足静力平衡方程 $ \\frac{\\partial p}{\\partial z} = - \\rho g $，其中 $p$ 是气压，$\\rho$ 是密度，$z$ 是几何高度，$g$ 是重力加速度。地形高度由 $ z_{s}(x) = z_{0} + A \\sin\\!\\left(\\frac{2\\pi}{L} x\\right) $ 给出，其中 $z_{0}$、振幅 $A$ 和水平波长 $L$ 均为常数。垂直坐标为地形跟随 sigma 坐标 $ \\sigma \\in [0,1] $，其映射关系为\n$$\nz(\\sigma, x) = (1 - \\sigma)\\, z_{s}(x) + \\sigma\\, H,\n$$\n其中 $H$ 是一个恒定的模式层顶高度。在一个 sigma 坐标模式中，对水平气压梯度力的一个朴素实现是，在固定的 $ \\sigma $（而不是固定的几何高度 $z$）上对水平气压梯度进行离散化，因此在静力平衡的静止状态下，剩余水平加速度变为 $ a_{\\text{naive}} = - \\frac{1}{\\rho} \\left.\\frac{\\partial p}{\\partial x}\\right|_{\\sigma} $。\n\n从静力平衡方程和上述 sigma 坐标映射出发，推导出一个用 $ g $、$ \\sigma $ 和地形坡度 $ \\frac{d z_{s}}{d x} $ 表示的 $ a_{\\text{naive}} $ 的闭式表达式。然后，对于参数值 $ g = 9.81 \\ \\mathrm{m\\,s^{-2}} $，$ H = 12{,}000 \\ \\mathrm{m} $，$ z_{0} = 1{,}500 \\ \\mathrm{m} $，$ A = 1{,}000 \\ \\mathrm{m} $，$ L = 30{,}000 \\ \\mathrm{m} $，计算在 $ x = 0 $ 和 $ \\sigma = 0.25 $ 处的 $ a_{\\text{naive}} $。最后，从第一性原理出发解释，一个强制在固定几何高度 $z$ 上计算水平气压梯度（或等效地，添加适当的度量修正项）的良好平衡修正是如何减小静力平衡静止状态下的剩余加速度的。\n\n将 $ a_{\\text{naive}} $ 的数值结果四舍五入到四位有效数字。以 $ \\mathrm{m\\,s^{-2}} $ 为单位表示最终加速度。你的最终答案必须是一个实数。",
            "solution": "该问题要求推导和评估在地形跟随坐标系中，当气压梯度力被朴素计算时产生的一个虚假的水平加速度。它还要求解释在一个良好平衡的数值格式中如何修正这个误差。\n\n核心任务是推导朴素水平加速度的表达式，其定义为 $ a_{\\text{naive}} = - \\frac{1}{\\rho} \\left.\\frac{\\partial p}{\\partial x}\\right|_{\\sigma} $。项 $ \\left.\\frac{\\partial p}{\\partial x}\\right|_{\\sigma} $ 表示气压 $p$ 相对于水平坐标 $x$ 的偏导数，同时保持 sigma 坐标 $\\sigma$ 不变。\n\n为了将其与物理量联系起来，我们必须将导数从 $ (x, \\sigma) $ 坐标系转换到物理 $ (x, z) $ 坐标系。物理上，气压 $p$ 是 $x$ 和 $z$ 的函数，即 $ p(x, z) $。在 sigma 坐标系中，垂直坐标 $z$ 本身是 $x$ 和 $\\sigma$ 的函数，因此我们有 $ p(x, z(x, \\sigma)) $。使用多变量函数的链式法则，我们可以将 $p$ 在 $\\sigma$ 不变时对 $x$ 的偏导数表示为：\n$$\n\\left.\\frac{\\partial p}{\\partial x}\\right|_{\\sigma} = \\left.\\frac{\\partial p}{\\partial x}\\right|_{z} + \\frac{\\partial p}{\\partial z} \\left.\\frac{\\partial z}{\\partial x}\\right|_{\\sigma}\n$$\n问题指出，大气处于静止的静力平衡状态。在这种状态下，等几何高度（$z$）面上没有气压的水平变化。气压场仅依赖于垂直坐标，$ p = p(z) $。这意味着真实的水平气压梯度为零：\n$$\n\\left.\\frac{\\partial p}{\\partial x}\\right|_{z} = 0\n$$\n垂直气压梯度由静力平衡方程给出：\n$$\n\\frac{\\partial p}{\\partial z} = - \\rho g\n$$\n我们需要的最后一项是等 $\\sigma$ 面的坡度 $ \\left.\\frac{\\partial z}{\\partial x}\\right|_{\\sigma} $。我们通过对给定的坐标变换 $ z(\\sigma, x) = (1 - \\sigma)\\, z_{s}(x) + \\sigma\\, H $ 关于 $x$ 求导（同时保持 $\\sigma$ 不变）来找到它：\n$$\n\\left.\\frac{\\partial z}{\\partial x}\\right|_{\\sigma} = \\frac{\\partial}{\\partial x} \\left[ (1 - \\sigma)\\, z_{s}(x) + \\sigma\\, H \\right]\n$$\n由于 $\\sigma$ 和 $H$ 对于此微分是常数，我们得到：\n$$\n\\left.\\frac{\\partial z}{\\partial x}\\right|_{\\sigma} = (1 - \\sigma) \\frac{d z_{s}}{d x}\n$$\n现在我们将这三个分量代回链式法则表达式中：\n$$\n\\left.\\frac{\\partial p}{\\partial x}\\right|_{\\sigma} = 0 + (-\\rho g) \\left( (1 - \\sigma) \\frac{d z_{s}}{d x} \\right) = - \\rho g (1 - \\sigma) \\frac{d z_{s}}{d x}\n$$\n最后，我们将此结果代入 $ a_{\\text{naive}} $ 的定义中：\n$$\na_{\\text{naive}} = - \\frac{1}{\\rho} \\left[ - \\rho g (1 - \\sigma) \\frac{d z_{s}}{d x} \\right] = g (1 - \\sigma) \\frac{d z_{s}}{d x}\n$$\n这就是所要求的虚假加速度的闭式表达式。\n\n接下来，我们使用给定的参数在 $ x = 0 $ 和 $ \\sigma = 0.25 $ 处计算此表达式的值。地形高度为 $ z_{s}(x) = z_{0} + A \\sin\\!\\left(\\frac{2\\pi}{L} x\\right) $。首先，我们计算地形坡度 $ \\frac{d z_{s}}{d x} $：\n$$\n\\frac{d z_{s}}{d x} = \\frac{d}{dx} \\left[ z_{0} + A \\sin\\!\\left(\\frac{2\\pi}{L} x\\right) \\right] = A \\cos\\!\\left(\\frac{2\\pi}{L} x\\right) \\cdot \\frac{2\\pi}{L}\n$$\n计算在 $ x = 0 $ 处的坡度：\n$$\n\\left.\\frac{d z_{s}}{d x}\\right|_{x=0} = \\frac{2\\pi A}{L} \\cos(0) = \\frac{2\\pi A}{L}\n$$\n现在我们代入给定的数值：$ g = 9.81 \\ \\mathrm{m\\,s^{-2}} $，$ A = 1{,}000 \\ \\mathrm{m} $，和 $ L = 30{,}000 \\ \\mathrm{m} $：\n$$\n\\left.\\frac{d z_{s}}{d x}\\right|_{x=0} = \\frac{2\\pi (1000)}{30000} = \\frac{2\\pi}{30} = \\frac{\\pi}{15}\n$$\n这是一个无量纲量（坡度）。现在我们可以计算在 $ \\sigma = 0.25 $ 处的 $ a_{\\text{naive}} $：\n$$\na_{\\text{naive}} = g (1 - \\sigma) \\left.\\frac{d z_{s}}{d x}\\right|_{x=0} = (9.81) \\cdot (1 - 0.25) \\cdot \\left(\\frac{\\pi}{15}\\right)\n$$\n$$\na_{\\text{naive}} = (9.81) \\cdot (0.75) \\cdot \\left(\\frac{\\pi}{15}\\right) = (9.81) \\cdot \\frac{3}{4} \\cdot \\frac{\\pi}{15} = \\frac{9.81 \\pi}{20}\n$$\n计算数值：\n$$\na_{\\text{naive}} \\approx 1.54096119 \\dots \\ \\mathrm{m\\,s^{-2}}\n$$\n四舍五入到四位有效数字得到 $ 1.541 \\ \\mathrm{m\\,s^{-2}} $。\n\n最后，我们解释一个良好平衡的修正是如何校正这个虚假加速度的。\n误差的根本来源在于，朴素的计算 $ - \\frac{1}{\\rho} \\left.\\frac{\\partial p}{\\partial x}\\right|_{\\sigma} $ 并不代表真实的水平气压梯度力。真实的水平加速度由 $ a_x = - \\frac{1}{\\rho}\\left.\\frac{\\partial p}{\\partial x}\\right|_{z} $ 给出。在静止的静力平衡状态下，$ a_x = 0 $。朴素计算产生一个非零结果，是因为等 $\\sigma$ 面不是水平的，而是跟随地形。在有坡度的地形上沿着等 $\\sigma$ 面移动会涉及到几何高度 $z$ 的变化，这在静力平衡大气中意味着气压的变化。朴素的公式将这种气压变化误解为水平气压梯度。\n\n一个良好平衡的格式被设计用来正确地计算真实的水平气压梯度 $ \\left.\\frac{\\partial p}{\\partial x}\\right|_{z} $。从我们的链式法则展开式中，我们可以重新整理以解出此项：\n$$\n\\left.\\frac{\\partial p}{\\partial x}\\right|_{z} = \\left.\\frac{\\partial p}{\\partial x}\\right|_{\\sigma} - \\frac{\\partial p}{\\partial z} \\left.\\frac{\\partial z}{\\partial x}\\right|_{\\sigma}\n$$\n因此，良好平衡的水平加速度是：\n$$\na_x = - \\frac{1}{\\rho} \\left.\\frac{\\partial p}{\\partial x}\\right|_{z} = - \\frac{1}{\\rho} \\left( \\left.\\frac{\\partial p}{\\partial x}\\right|_{\\sigma} - \\frac{\\partial p}{\\partial z} \\left.\\frac{\\partial z}{\\partial x}\\right|_{\\sigma} \\right)\n$$\n将静力学关系 $ \\frac{\\partial p}{\\partial z} = - \\rho g $ 代入修正项，得到：\n$$\na_x = - \\frac{1}{\\rho} \\left.\\frac{\\partial p}{\\partial x}\\right|_{\\sigma} - g \\left.\\frac{\\partial z}{\\partial x}\\right|_{\\sigma}\n$$\n这个修正后的公式由两项组成：$\\sigma$ 面上的朴素气压梯度和一个解释该面坡度的度量修正项。对于静止状态，我们之前推导出 $ \\left.\\frac{\\partial p}{\\partial x}\\right|_{\\sigma} = -\\rho g (1-\\sigma)\\frac{dz_s}{dx} $ 和 $ \\left.\\frac{\\partial z}{\\partial x}\\right|_{\\sigma} = (1-\\sigma)\\frac{dz_s}{dx} $。将这些代入良好平衡的公式中，得到：\n$$\na_x = - \\frac{1}{\\rho} \\left( -\\rho g (1-\\sigma)\\frac{dz_s}{dx} \\right) - g \\left( (1-\\sigma)\\frac{dz_s}{dx} \\right)\n$$\n$$\na_x = g (1-\\sigma)\\frac{dz_s}{dx} - g (1-\\sigma)\\frac{dz_s}{dx} = 0\n$$\n因此，良好平衡的格式能正确地计算出静止状态下的加速度为零，因为两个大的、符号相反的项完全抵消了。一个良好平衡的数值模式的本质是以一种一致的方式对这两项进行离散化，以保持这种抵消特性，从而防止在地形上产生虚假流动。",
            "answer": "$$\\boxed{1.541}$$"
        }
    ]
}