{
    "hands_on_practices": [
        {
            "introduction": "理解流体的动能如何在滞止过程中转化为热能，是气体动力学的基石。第一个练习 () 将引导你推导理想气体中总温、静温和马赫数之间的基本关系。通过应用此公式并分析其在高超声速条件下的行为，你将为应对更复杂的场景打下坚实的基础。",
            "id": "4001053",
            "problem": "在无轴功的稳态、无粘、绝热可压缩流中，总比焓沿流线守恒。考虑将空气模拟为具有恒定热容和比热比 $\\gamma$ 的量热完全气体。自由来流的特征是静温 $T$ 和马赫数 $M$。\n\n从单位质量能量守恒和量热完全气体的比焓定义出发，推导一个联系静温 $T$、滞止（总）温度 $T_{t}$、流速 $V$ 和定压比热 $c_{p}$ 的关系式。然后，利用声速 $a$ 和 $a$ 的理想气体关系式，用 $M$ 消去 $V$。将无量纲滞止温度比 $T_{t}/T$ 纯粹用 $\\gamma$ 和 $M$ 表示。\n\n接下来，针对空气的特定情况，取 $\\gamma = 1.4$。对于一个具有代表性的高速平流层条件，$T = 220\\,\\mathrm{K}$，$M = 7$，计算相应的 $T_{t}$，并将结果四舍五入至四位有效数字，单位为 $\\mathrm{K}$。\n\n最后，通过求导 $\\mathrm{d}(T_{t}/T)/\\mathrm{d}M$ 来分析 $T_{t}/T$ 对 $M$ 的灵敏度，并确定其大 $M$ 渐近行为。找出精确的系数 $c$，使得当 $M \\to \\infty$ 时，对于 $\\gamma = 1.4$，有 $T_{t}/T \\sim c\\,M^{2}$。\n\n在最终的方框答案中，仅报告 $c$ 的精确值，形式为最简分数，不带单位。不要在方框答案中报告任何中间结果。",
            "solution": "该问题陈述在科学上是合理的、定义明确且客观的。它代表了可压缩气体动力学中的一个标准练习。我们将按顺序解决问题的每个部分来进行解答。\n\n分析始于稳态、绝热、无轴功或彻体力的流动的能量守恒。对于沿流线运动的单位质量流体，能量方程由下式给出：\n$$h + \\frac{1}{2}V^2 = \\text{常数}$$\n其中 $h$ 是比静焓，$V$ 是流速。此方程中的常数是总比焓，记为 $h_t$。总焓对应于流体被等熵地带至静止状态时所具有的焓。因此，\n$$h_t = h + \\frac{1}{2}V^2$$\n总温度，或称滞止温度 $T_t$，定义为与总焓 $h_t$ 相关联的温度。对于量热完全气体，比焓是温度的线性函数：$h = c_p T$，其中 $c_p$ 是定压比热，为一个常数。因此，我们可以写出 $h_t = c_p T_t$。将这些定义代入能量方程，得到第一个所求的关系式：\n$$c_p T_t = c_p T + \\frac{1}{2}V^2$$\n该方程联系了静温 $T$、滞止温度 $T_t$、流速 $V$ 和定压比热 $c_p$。\n\n接下来，我们用马赫数 $M$ 消去速度 $V$。马赫数定义为流速与当地声速 $a$之比：\n$$M = \\frac{V}{a} \\implies V = M a$$\n将此代入我们的能量关系式可得：\n$$c_p T_t = c_p T + \\frac{1}{2}(M a)^2 = c_p T + \\frac{1}{2}M^2 a^2$$\n为表达无量纲温度比 $T_t/T$，我们将整个方程除以 $c_p T$：\n$$\\frac{T_t}{T} = 1 + \\frac{M^2 a^2}{2 c_p T}$$\n对于理想气体，声速的平方由 $a^2 = \\gamma R T$ 给出，其中 $\\gamma$ 是比热比，$R$ 是比气体常数。代入这个 $a^2$ 的表达式：\n$$\\frac{T_t}{T} = 1 + \\frac{M^2 (\\gamma R T)}{2 c_p T} = 1 + \\left(\\frac{\\gamma R}{2 c_p}\\right) M^2$$\n对于理想气体，我们有热力学关系式 $c_p - c_v = R$，其中 $c_v$ 是定容比热。两边同除以 $c_p$ 得 $1 - c_v/c_p = R/c_p$。因为 $\\gamma = c_p/c_v$，所以 $c_v/c_p = 1/\\gamma$。因此：\n$$\\frac{R}{c_p} = 1 - \\frac{1}{\\gamma} = \\frac{\\gamma - 1}{\\gamma}$$\n将此代回温度比方程，得到期望的结果：\n$$\\frac{T_t}{T} = 1 + \\frac{\\gamma}{2}\\left(\\frac{\\gamma - 1}{\\gamma}\\right) M^2$$\n$$\\frac{T_t}{T} = 1 + \\frac{\\gamma - 1}{2} M^2$$\n这个基本方程联系了量热完全气体的滞止温度比、马赫数和比热比。\n\n现在我们针对空气的给定条件进行计算：$\\gamma = 1.4$，静温 $T = 220\\,\\mathrm{K}$，马赫数 $M = 7$。我们计算相应的滞止温度 $T_t$：\n$$T_t = T \\left( 1 + \\frac{\\gamma - 1}{2} M^2 \\right)$$\n$$T_t = 220 \\left( 1 + \\frac{1.4 - 1}{2} (7)^2 \\right)$$\n$$T_t = 220 \\left( 1 + \\frac{0.4}{2} (49) \\right)$$\n$$T_t = 220 \\left( 1 + (0.2)(49) \\right)$$\n$$T_t = 220 \\left( 1 + 9.8 \\right)$$\n$$T_t = 220 (10.8)$$\n$$T_t = 2376\\,\\mathrm{K}$$\n结果 $2376\\,\\mathrm{K}$ 已经有四位有效数字，因此无需进一步四舍五入。\n\n最后，我们分析温度比 $T_t/T$ 对马赫数 $M$ 的灵敏度，并确定其大 $M$ 的渐近行为。设函数 $f(M) = T_t/T = 1 + \\frac{\\gamma - 1}{2} M^2$。其灵敏度由对 $M$ 的导数给出：\n$$\\frac{\\mathrm{d}}{\\mathrm{d}M}\\left(\\frac{T_t}{T}\\right) = \\frac{\\mathrm{d}}{\\mathrm{d}M}\\left(1 + \\frac{\\gamma - 1}{2} M^2\\right)$$\n$$\\frac{\\mathrm{d}(T_t/T)}{\\mathrm{d}M} = 0 + \\frac{\\gamma - 1}{2} (2M) = (\\gamma - 1)M$$\n这表明滞止温度比对马赫数的灵敏度与 $M$ 呈线性关系。\n\n对于大 $M$ 的渐近行为，我们考虑 $M \\to \\infty$ 的极限。在表达式 $T_t/T = 1 + \\frac{\\gamma-1}{2}M^2$ 中，与 $M^2$ 成正比的项将主导常数项 $1$。因此，我们可以写出渐近关系：\n$$\\frac{T_t}{T} \\sim \\frac{\\gamma-1}{2} M^2 \\quad \\text{当} \\quad M \\to \\infty$$\n问题要求找出系数 $c$，使得 $T_t/T \\sim c\\,M^2$。通过与我们推导的渐近关系直接比较，我们确定系数 $c$ 为：\n$$c = \\frac{\\gamma-1}{2}$$\n对于空气，给定 $\\gamma = 1.4$。我们现在可以计算 $c$ 的精确值：\n$$c = \\frac{1.4 - 1}{2} = \\frac{0.4}{2} = 0.2$$\n按要求，我们将其表示为最简分数：\n$$c = 0.2 = \\frac{2}{10} = \\frac{1}{5}$$",
            "answer": "$$\\boxed{\\frac{1}{5}}$$"
        },
        {
            "introduction": "理想气体模型虽然实用，但也有其局限性，尤其是在高超声速飞行所产生的高温环境中。这个练习 () 将挑战你超越这一简化，通过比较“冻结流”和“化学平衡流”两种假设下的总温预测结果。这项对比不仅仅是学术练习，它揭示了热化学建模对工程设计（例如飞行器的热防护系统）的深远影响。",
            "id": "4001056",
            "problem": "一个马赫数 $M=10$、静温 $T_{\\infty}=300\\,\\mathrm{K}$ 的量热完全自由来流空气流进入一个高焓滞止区，在该区域内流动绝热减速至零速度，且无轴功。仅为了计算自由来流声速，自由来流被建模为理想气体，其比气体常数 $R=287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，自由来流状态下的比热比 $\\gamma_{\\infty}=1.4$。滞止（总）焓守恒，滞止（总）温度 $T_{t}$ 必须使用与温度相关的定压比热 $c_{p}(T)$ 从能量方程中确定。\n\n考虑滞止区中空气的两种热化学假设：\n- 冻结化学（组分固定）：使用替代混合物模型 $c_{p,f}(T)=A_{f}+B_{f}T$，其中 $A_{f}=950\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 且 $B_{f}=8.0\\times 10^{-2}\\,\\mathrm{J\\,kg^{-1}\\,K^{-2}}$。\n- 化学平衡（组分随温度调整）：使用替代混合物模型 $c_{p,e}(T)=A_{e}+B_{e}T$，其中 $A_{e}=900\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 且 $B_{e}=1.8\\times 10^{-1}\\,\\mathrm{J\\,kg^{-1}\\,K^{-2}}$。\n\n在两种情况下，取参考温度 $T_{\\mathrm{ref}}=300\\,\\mathrm{K}$，并通过 $h(T)-h(T_{\\mathrm{ref}})=\\int_{T_{\\mathrm{ref}}}^{T} c_{p}(\\theta)\\,\\mathrm{d}\\theta$ 定义比焓。假设自由来流静温等于参考温度，因此 $h(T_{\\infty})-h(T_{\\mathrm{ref}})=0$。\n\n仅从能量守恒和上述定义出发，计算差值 $\\Delta T_{t}=T_{t,f}-T_{t,e}$，其中 $T_{t,f}$ 和 $T_{t,e}$ 分别是在冻结和平衡假设下预测的滞止温度。然后，根据 $\\Delta T_{t}$ 的符号和大小，简要解释在高速计算流体动力学（CFD, Computational Fluid Dynamics）分析中，这对热防护系统尺寸设计的工程影响。将 $\\Delta T_{t}$ 的数值四舍五入到四位有效数字，并以 $\\mathrm{K}$ 为单位表示。你最终报告的答案必须仅为 $\\Delta T_{t}$ 的数值。",
            "solution": "经评估，该问题有效。\n\n已知条件如下：\n- 自由来流马赫数：$M=10$\n- 自由来流静温：$T_{\\infty}=300\\,\\mathrm{K}$\n- 流动条件：绝热减速至零速度，无轴功。\n- 自由来流理想气体性质（仅用于计算声速）：比气体常数 $R=287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，比热比 $\\gamma_{\\infty}=1.4$。\n- 滞止焓守恒。\n- 冻结化学的比热模型：$c_{p,f}(T)=A_{f}+B_{f}T$，其中 $A_{f}=950\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 且 $B_{f}=8.0\\times 10^{-2}\\,\\mathrm{J\\,kg^{-1}\\,K^{-2}}$。\n- 化学平衡的比热模型：$c_{p,e}(T)=A_{e}+B_{e}T$，其中 $A_{e}=900\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 且 $B_{e}=1.8\\times 10^{-1}\\,\\mathrm{J\\,kg^{-1}\\,K^{-2}}$。\n- 焓的参考温度：$T_{\\mathrm{ref}}=300\\,\\mathrm{K}$。\n- 焓的定义：$h(T)-h(T_{\\mathrm{ref}})=\\int_{T_{\\mathrm{ref}}}^{T} c_{p}(\\theta)\\,\\mathrm{d}\\theta$。\n- 自由来流温度假设：$T_{\\infty}=T_{\\mathrm{ref}}$。\n\n该问题具有科学依据，提法恰当且客观。它基于流体动力学中的能量守恒基本原理，这是航空航天工程和计算流体动力学（CFD）的核心课题。该问题比较了两种标准但简化的热化学模型（冻结流和平衡流），这是高温气体动力学中的一个经典练习。所提供的数据在量纲上是一致的，并且对于建立该问题是物理上合理的。问题清晰明确，并有唯一且有意义的解。\n\n解题过程从稳态开放系统的热力学第一定律出发，对于无轴功的绝热流动，该定律简化为总焓 $h_t$ 守恒。总焓定义为静焓 $h$ 和单位质量动能 $\\frac{1}{2}V^2$ 的和：\n$$h_t = h + \\frac{1}{2}V^2$$\n自由来流（下标 $\\infty$）和滞止区（速度为零）之间的总焓守恒意味着：\n$$h(T_t) + \\frac{1}{2}(0)^2 = h(T_{\\infty}) + \\frac{1}{2}V_{\\infty}^2$$\n其中 $T_t$ 是滞止（总）温度。整理得到：\n$$h(T_t) - h(T_{\\infty}) = \\frac{1}{2}V_{\\infty}^2$$\n问题陈述 $T_{\\infty} = T_{\\mathrm{ref}}$，所以 $h(T_{\\infty}) = h(T_{\\mathrm{ref}})$。方程变为：\n$$h(T_t) - h(T_{\\mathrm{ref}}) = \\frac{1}{2}V_{\\infty}^2$$\n使用所给的焓的积分定义：\n$$\\int_{T_{\\mathrm{ref}}}^{T_t} c_{p}(\\theta)\\,\\mathrm{d}\\theta = \\frac{1}{2}V_{\\infty}^2$$\n首先，我们计算右侧的动能项。自由来流速度 $V_{\\infty}$ 是马赫数 $M$ 和自由来流声速 $a_{\\infty}$ 的乘积。声速由 $a_{\\infty} = \\sqrt{\\gamma_{\\infty} R T_{\\infty}}$ 给出。\n$$\n\\frac{1}{2}V_{\\infty}^2 = \\frac{1}{2}(M a_{\\infty})^2 = \\frac{1}{2}M^2 (\\gamma_{\\infty} R T_{\\infty})\n$$\n代入给定值 $M=10$, $\\gamma_{\\infty}=1.4$, $R=287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 和 $T_{\\infty}=300\\,\\mathrm{K}$：\n$$\n\\frac{1}{2}V_{\\infty}^2 = \\frac{1}{2}(10)^2 (1.4)(287)(300) = 50 \\times 120540 = 6027000\\,\\mathrm{J\\,kg^{-1}}\n$$\n这个值表示使流动静止所需的比焓变化。\n\n现在，我们通过计算左侧的积分，为每种热化学模型求解滞止温度 $T_t$。\n\n情况1：冻结化学\n比热为 $c_{p,f}(T)=A_{f}+B_{f}T$。能量方程变为：\n$$\n\\int_{T_{\\mathrm{ref}}}^{T_{t,f}} (A_{f}+B_{f}\\theta)\\,\\mathrm{d}\\theta = \\frac{1}{2}V_{\\infty}^2\n$$\n$$\n\\left[ A_{f}\\theta + \\frac{1}{2}B_{f}\\theta^2 \\right]_{T_{\\mathrm{ref}}}^{T_{t,f}} = \\frac{1}{2}V_{\\infty}^2\n$$\n$$\n(A_{f}T_{t,f} + \\frac{1}{2}B_{f}T_{t,f}^2) - (A_{f}T_{\\mathrm{ref}} + \\frac{1}{2}B_{f}T_{\\mathrm{ref}}^2) = \\frac{1}{2}V_{\\infty}^2\n$$\n这是一个关于 $T_{t,f}$ 的二次方程：\n$$\n\\frac{1}{2}B_{f}T_{t,f}^2 + A_{f}T_{t,f} - \\left( \\frac{1}{2}V_{\\infty}^2 + A_{f}T_{\\mathrm{ref}} + \\frac{1}{2}B_{f}T_{\\mathrm{ref}}^2 \\right) = 0\n$$\n代入值 $A_f=950$, $B_f=0.08$, $T_{\\mathrm{ref}}=300$ 和 $\\frac{1}{2}V_{\\infty}^2=6027000$：\n$$\n\\frac{1}{2}(0.08)T_{t,f}^2 + 950T_{t,f} - (6027000 + 950(300) + \\frac{1}{2}(0.08)(300)^2) = 0\n$$\n$$\n0.04T_{t,f}^2 + 950T_{t,f} - (6027000 + 285000 + 3600) = 0\n$$\n$$\n0.04T_{t,f}^2 + 950T_{t,f} - 6315600 = 0\n$$\n使用二次公式 $T_{t,f} = \\frac{-b + \\sqrt{b^2-4ac}}{2a}$ 求解（取物理上有意义的正根）：\n$$\nT_{t,f} = \\frac{-950 + \\sqrt{950^2 - 4(0.04)(-6315600)}}{2(0.04)} = \\frac{-950 + \\sqrt{902500 + 1010496}}{0.08} = \\frac{-950 + \\sqrt{1912996}}{0.08} \\approx 5413.8875\\,\\mathrm{K}\n$$\n\n情况2：化学平衡\n比热为 $c_{p,e}(T)=A_{e}+B_{e}T$。能量方程具有相同的形式：\n$$\n\\frac{1}{2}B_{e}T_{t,e}^2 + A_{e}T_{t,e} - \\left( \\frac{1}{2}V_{\\infty}^2 + A_{e}T_{\\mathrm{ref}} + \\frac{1}{2}B_{e}T_{\\mathrm{ref}}^2 \\right) = 0\n$$\n代入值 $A_e=900$, $B_e=0.18$, $T_{\\mathrm{ref}}=300$ 和 $\\frac{1}{2}V_{\\infty}^2=6027000$：\n$$\n\\frac{1}{2}(0.18)T_{t,e}^2 + 900T_{t,e} - (6027000 + 900(300) + \\frac{1}{2}(0.18)(300)^2) = 0\n$$\n$$\n0.09T_{t,e}^2 + 900T_{t,e} - (6027000 + 270000 + 8100) = 0\n$$\n$$\n0.09T_{t,e}^2 + 900T_{t,e} - 6305100 = 0\n$$\n求解 $T_{t,e}$:\n$$\nT_{t,e} = \\frac{-900 + \\sqrt{900^2 - 4(0.09)(-6305100)}}{2(0.09)} = \\frac{-900 + \\sqrt{810000 + 2269836}}{0.18} = \\frac{-900 + \\sqrt{3079836}}{0.18} \\approx 4749.7008\\,\\mathrm{K}\n$$\n\n最后，我们计算差值 $\\Delta T_{t} = T_{t,f} - T_{t,e}$：\n$$\n\\Delta T_{t} = 5413.8875\\,\\mathrm{K} - 4749.7008\\,\\mathrm{K} = 664.1867\\,\\mathrm{K}\n$$\n按要求四舍五入到四位有效数字，我们得到 $\\Delta T_t = 664.2\\,\\mathrm{K}$。\n\n$\\Delta T_{t}$ 的正号表示冻结化学模型预测的滞止温度高于化学平衡模型。这是因为在平衡模型中，部分从动能转换而来的热能被吸热化学反应（例如，分子离解）所吸收，而这些反应在冻结模型中没有被考虑。这起到了能量汇的作用，有效地增加了气体混合物的比热。对于固定的焓增量（来自运动能），具有较高有效比热的气体将经历较小的温升。\n\n这对CFD中热防护系统（TPS）的尺寸设计具有重要的工程意义。滞止温度是驱动飞行器表面气动加热率的关键参数。假设冻结化学的CFD分析将比包含平衡化学效应的更物理准确的分析预测出高得多的壁温。这种对温度的过高预测将导致保守的设计，从而造成TPS过大、过重且成本更高。因此，准确的热化学建模对于高超声速飞行器的高效和安全设计至关重要。",
            "answer": "$$\n\\boxed{664.2}\n$$"
        },
        {
            "introduction": "在现代计算流体力学中，解析解十分罕见，而比热等物理属性通常是温度的复杂函数。最后一个练习 () 旨在通过让你开发一个稳健的数值求解器来计算总温，从而弥合理论与应用之间的差距。你将实现一个带有多重保障机制的牛顿法，这是任何CFD从业者都需掌握的核心技能，用以求解在真实模拟中出现的隐式能量方程。",
            "id": "4001068",
            "problem": "您的任务是设计并实现一个鲁棒的算法，用于在计算流体力学 (CFD) 环境中计算总温（驻点温度），记为 $T_t$。在此环境中，定压比热 $c_p(T)$ 随温度变化。该解决方案必须从适用于航空航天计算流体力学 (CFD) 的第一性原理推导得出，并且必须使用国际单位制 (SI单位) 表示。具体来说，您应使用沿流线的绝热、无轴功、定常流的基本能量关系式：总焓等于静焓加上单位质量动能。总温 $T_t$ 由焓的恒等式 $h(T_t) = h(T) + \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2$ 隐式定义，其中 $h(T)$ 是作为温度 $T$ 函数的热力学焓，$\\lVert \\mathbf{u} \\rVert$ 是速率。\n\n为使问题在计算上具体化，考虑一个干空气的热力学模型，其变比热 $c_p(T)$ 由一个关于参考温度 $T_0 = 300\\,\\mathrm{K}$ 的温度相关多项式给出。定义温差 $x = T - T_0$ 并令\n$$\nc_p(T) = a_0 + a_1 x + a_2 x^2 + a_3 x^3,\n$$\n其中常数（对于干空气，在 $100\\,\\mathrm{K}$ 到 $4000\\,\\mathrm{K}$ 的范围内物理上是合理的）为\n$$\na_0 = 1004.5\\,\\mathrm{\\tfrac{J}{kg\\,K}},\\quad a_1 = 0.1\\,\\mathrm{\\tfrac{J}{kg\\,K^2}},\\quad a_2 = -10^{-4}\\,\\mathrm{\\tfrac{J}{kg\\,K^3}},\\quad a_3 = 5\\times 10^{-8}\\,\\mathrm{\\tfrac{J}{kg\\,K^4}}.\n$$\n使用焓作为 $c_p(T)$ 的温度积分的定义：\n$$\nh(T) = h(T_0) + \\int_{T_0}^{T} c_p(\\tau)\\, d\\tau,\n$$\n为计算方便，设 $h(T_0) = 0$，这样就只需关心焓差。上述 $c_p(T)$ 对应的焓原函数为\n$$\nH(T) = a_0 x + \\tfrac{1}{2} a_1 x^2 + \\tfrac{1}{3} a_2 x^3 + \\tfrac{1}{4} a_3 x^4,\\quad x = T - T_0,\n$$\n因此，温度 $T$ 与给定静温 $T_s$ 之间的焓差为 $H(T) - H(T_s)$，定义 $T_t$ 的方程变为\n$$\nH(T_t) - H(T_s) - \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2 = 0.\n$$\n\n您的程序必须：\n- 为标量函数 $F(T) = H(T) - H(T_s) - \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2$ 实现一个求根算法，使用带有回溯线搜索的 Newton 迭代法，以确保每一步残差量级都稳健减小。Newton 方法所需的导数为 $F'(T) = \\dfrac{d H}{d T} = c_p(T)$。\n- 使用物理上有意义的界限 $T \\in [T_s, T_{\\max}]$（其中 $T_{\\max} = 4000\\,\\mathrm{K}$）来保护迭代过程，并在残差量级足够小或步长变得过小时终止 Newton 过程。\n- 如果回溯线搜索未能使残差减小，则包含一个后备的区间限定与二分法程序。利用 $c_p(T) > 0$ 所隐含的单调性来构造一个使 $F(T)$ 异号的区间 $[T_{\\text{low}}, T_{\\text{high}}]$，然后执行二分法直至收敛。\n- 使用初始猜测值 $T^{(0)} = T_s + \\dfrac{\\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2}{c_p(T_s)}$，并确保算法能优雅地处理速率 $\\lVert \\mathbf{u} \\rVert = 0$ 的边界情况。\n- 将 $\\lVert \\mathbf{u} \\rVert$ 计算为速度矢量分量的欧几里得范数。\n\n物理单位要求：\n- 温度 $T_s$ 和 $T_t$ 必须以 $\\mathrm{K}$ 为单位。\n- 速度分量必须以 $\\mathrm{m/s}$ 为单位，速率也以 $\\mathrm{m/s}$ 为单位计算。\n- 比热 $c_p(T)$ 和焓必须分别与 $\\mathrm{J/(kg\\,K)}$ 和 $\\mathrm{J/kg}$ 的单位保持一致。\n\n数值精度与输出：\n- 对于每个测试用例，返回计算出的总温 $T_t$，单位为 $\\mathrm{K}$，四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3]”），每个结果都是四舍五入后的浮点数。\n\n测试套件：\n使用以下测试用例，表示为元组 $(T_s,\\ \\mathbf{u})$，其中 $\\mathbf{u} = (u_x,u_y,u_z)$ 单位为 $\\mathrm{m/s}$，$T_s$ 单位为 $\\mathrm{K}$。\n1. $(300.0,\\ (300.0,\\ 0.0,\\ 0.0))$ — 典型的亚音速工况（“理想路径”）。\n2. $(300.0,\\ (0.0,\\ 0.0,\\ 0.0))$ — 速率为零的边界情况。\n3. $(1200.0,\\ (1000.0,\\ 0.0,\\ 0.0))$ — 高静温伴随显著速率。\n4. $(100.0,\\ (-200.0,\\ 200.0,\\ 0.0))$ — 低静温，速度分量有正有负。\n5. $(220.0,\\ (1500.0,\\ 0.0,\\ 0.0))$ — 低静温下的超音速工况。\n6. $(1800.0,\\ (2000.0,\\ -500.0,\\ 0.0))$ — 高静温伴随大速率，但在可行范围内。\n\n终止准则：\n- 残差容差：当 $\\lvert F(T) \\rvert \\le 10^{-6}\\,\\mathrm{J/kg}$ 时，判定为收敛。\n- 步长保护：如果回溯步长乘子降至 $10^{-8}$ 以下，则触发区间限定与二分法。\n- 最大 Newton 迭代次数：$50$。\n\n您的程序应生成单行输出，包含六个计算出的 $T_t$ 值，单位为 $\\mathrm{K}$，四舍五入到六位小数，格式为由方括号括起来的逗号分隔列表。",
            "solution": "确定总温是航空航天工程和计算流体力学中的一个基本参数，其核心是一个能量守恒问题。我们首先验证问题陈述本身，然后从第一性原理推导解决方案。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n-   **目标**：为具有随温度变化的定压比热 $c_p(T)$ 的流体计算总温（驻点温度）$T_t$。\n-   **控制原理**：对于绝热、无轴功的定常流，总焓是恒定的。这表示为 $h(T_t) = h(T) + \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2$，其中 $T$ 是静温，$\\lVert \\mathbf{u} \\rVert$ 是流体速率。\n-   **比热模型**：干空气的定压比热 $c_p(T)$ 由一个关于参考温度 $T_0 = 300\\,\\mathrm{K}$ 的变量 $x = T - T_0$ 的多项式给出：\n    $$c_p(T) = a_0 + a_1 x + a_2 x^2 + a_3 x^3$$\n-   **系数**：\n    -   $a_0 = 1004.5\\,\\mathrm{\\tfrac{J}{kg\\,K}}$\n    -   $a_1 = 0.1\\,\\mathrm{\\tfrac{J}{kg\\,K^2}}$\n    -   $a_2 = -10^{-4}\\,\\mathrm{\\tfrac{J}{kg\\,K^3}}$\n    -   $a_3 = 5\\times 10^{-8}\\,\\mathrm{\\tfrac{J}{kg\\,K^4}}$\n    -   据称该模型在 $T \\in [100\\,\\mathrm{K}, 4000\\,\\mathrm{K}]$ 范围内是合理的。\n-   **焓定义**：焓通过比热的积分定义，$h(T) = h(T_0) + \\int_{T_0}^{T} c_p(\\tau)\\, d\\tau$。为方便起见，设定参考焓 $h(T_0) = 0$。\n-   **焓原函数**：其积分形式为 $H(T) = a_0 x + \\tfrac{1}{2} a_1 x^2 + \\tfrac{1}{3} a_2 x^3 + \\tfrac{1}{4} a_3 x^4$，其中 $x = T - T_0$。\n-   **待解方程**：问题是找到函数 $F(T) = H(T) - H(T_s) - \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2 = 0$ 的根，其中 $T_s$ 是静温。\n-   **数值方法**：\n    1.  **主要方法**：带有回溯线搜索的 Newton 方法。\n    2.  **导数**：导数为 $F'(T) = c_p(T)$。\n    3.  **初始猜测值**：$T^{(0)} = T_s + \\dfrac{\\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2}{c_p(T_s)}$。\n    4.  **后备方法**：如果回溯失败，则采用区间限定与二分法。\n-   **约束与保护措施**：\n    -   迭代的物理界限：$T \\in [T_s, T_{\\max}]$，其中 $T_{\\max} = 4000\\,\\mathrm{K}$。\n    -   收敛的残差容差：$\\lvert F(T) \\rvert \\le 10^{-6}\\,\\mathrm{J/kg}$。\n    -   回溯的步长保护：如果步长乘子降至 $10^{-8}$ 以下，则触发二分法。\n    -   最大 Newton 迭代次数：$50$。\n-   **单位**：所有单位必须是国际单位制 (SI)：温度单位为开尔文（$\\mathrm{K}$），速度单位为米每秒（$\\mathrm{m/s}$），能量相关量的单位为焦耳（$\\mathrm{J}$）、千克（$\\mathrm{kg}$）等。\n-   **测试用例**：提供了六个特定的 $(T_s, \\mathbf{u})$ 用例。\n-   **输出格式**：单行逗号分隔的结果列表，四舍五入到六位小数，并用方括号括起来。\n\n**步骤2：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题基于应用于定常流动系统的热力学第一定律，特别是总焓的定义。$c_p(T)$ 的多项式表示是气体动力学中使用的标准且有效的经验模型。这些数值对于空气来说在物理上是合理的。该问题在根本上是可靠的。\n-   **适定性**：待解函数 $F(T) = H(T) - H(T_s) - \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2$ 对于物理上现实的温度是严格单调的。其导数是 $F'(T) = c_p(T)$，在指定的温度范围 $[100\\,\\mathrm{K}, 4000\\,\\mathrm{K}]$ 内保持为正。一个严格单调的函数最多只能有一个根。由于 $F(T_s) = -\\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2 \\le 0$ 且 $H(T)$ 是 $T$ 的单调递增函数，只要所需的焓升能在模型的有效温度范围内实现，就保证存在唯一的解 $T_t \\ge T_s$。该问题提供了所有必要的数据和鲁棒的数值策略，确保可以找到唯一且稳定的解。\n-   **客观性**：该问题的陈述完全客观，使用了精确的数学和物理定义，没有主观性语言或歧义。\n\n**步骤3：结论与行动**\n\n该问题具有科学依据，数学上适定，且陈述客观。因此，这是一个**有效**的问题。我们将继续进行解的推导和实现。\n\n### 基于原理的解决方案设计\n\n该问题的核心在于，在无轴功的定常、绝热流动中，沿流线移动的流体微元的能量守恒原理。能量方程的具体形式是总焓 $h_t$ 守恒。总焓是静（热力学）焓 $h$ 与单位质量动能 $\\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$ 的和。\n\n设流场中某点的静温为 $T_s$，速度矢量为 $\\mathbf{u}$。该点的静焓为 $h(T_s)$。总焓定义为：\n$$h_t = h(T_s) + \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$$\n总温 $T_t$ 定义为流体被等熵地带至静止时将达到的温度。这意味着它是对应于总焓的温度，即 $h(T_t) = h_t$。结合这些定义，我们得到控制关系式：\n$$h(T_t) = h(T_s) + \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$$\n该方程隐式地定义了总温 $T_t$。为了求解 $T_t$，我们必须有焓 $h(T)$ 的函数形式。\n\n根据热力学，比焓的微分变化由 $dh = c_p dT$ 给出，其中 $c_p$ 是定压比热。将其从参考温度 $T_0$ 积分到任意温度 $T$ 可得：\n$$h(T) - h(T_0) = \\int_{T_0}^{T} c_p(\\tau) d\\tau$$\n为计算方便，我们可以将参考焓 $h(T_0)$ 设为零，因为只有焓*差*具有物理意义。$T_t$ 的控制方程可以重写为：\n$$h(T_t) - h(T_s) = \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$$\n问题提供了一个围绕 $T_0 = 300\\,\\mathrm{K}$ 的 $c_p(T)$ 多项式模型。令 $x = T - T_0$，我们有：\n$$c_p(T) = a_0 + a_1 x + a_2 x^2 + a_3 x^3$$\n我们定义一个原函数 $H(T)$，使得 $H(T) = \\int_{T_0}^{T} c_p(\\tau) d\\tau$。将 $c_p$ 的多项式逐项对 $x$ 积分可得：\n$$H(T) = a_0 x + \\frac{1}{2} a_1 x^2 + \\frac{1}{3} a_2 x^3 + \\frac{1}{4} a_3 x^4$$\n根据这个定义，焓差即为 $h(T_t) - h(T_s) = H(T_t) - H(T_s)$。我们的控制方程变为：\n$$H(T_t) - H(T_s) = \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$$\n为了求解 $T_t$，我们构建一个求根问题。我们寻求满足以下条件的 $T$ 值：\n$$F(T) = H(T) - H(T_s) - \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2 = 0$$\n\n问题要求使用 Newton 方法进行数值求解。Newton 方法的迭代公式是：\n$$T^{(k+1)} = T^{(k)} - \\frac{F(T^{(k)})}{F'(T^{(k)})}$$\n其中 $T^{(k)}$ 是第 $k$ 次迭代时根的估计值。需要导数 $F'(T)$。将 $F(T)$ 对 $T$ 求导可得：\n$$F'(T) = \\frac{d}{dT} \\left( H(T) - H(T_s) - \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2 \\right) = \\frac{dH}{dT} = c_p(T)$$\n这为计算每一步 Newton 迭代所需的导数提供了一种直接的、非迭代的方法。\n\n一个巧妙的初始猜测值 $T^{(0)}$ 能显著改善收敛性。如果 $c_p$ 是一个常数，且等于其在静温下的值 $c_p(T_s)$，则积分将简化为 $h(T_t) - h(T_s) = c_p(T_s)(T_t - T_s)$。这将得到 $T_t$ 的一个显式解：$T_t = T_s + \\frac{\\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2}{c_p(T_s)}$。我们使用它作为我们的初始猜测值，因为它代表了一个有物理动机的一阶近似。\n\n为确保鲁棒性，算法包含了几个保护措施：\n1.  **回溯线搜索**：一个完整的 Newton 步长可能过于激进，可能越过根或导致发散。我们在更新规则中引入一个步长乘子 $\\alpha \\in (0, 1]$：$T^{(k+1)} = T^{(k)} - \\alpha \\frac{F(T^{(k)})}{F'(T^{(k)})}$。我们从 $\\alpha=1$ 开始，并相继减小它（例如，减半），直到残差量级获得充分减小，即 $|F(T^{(k+1)})|  |F(T^{(k)})|$，同时确保新的估计值保持在物理界限 $[T_s, T_{\\max}]$ 内。\n2.  **回退到二分法**：如果回溯线搜索失败（即 $\\alpha$ 变得小于预设容差），这表明 Newton 方法遇到了困难。我们就切换到更鲁棒但较慢的二分法。由于 $F'(T) = c_p(T) > 0$，$F(T)$ 是单调的。我们有一个可靠的区间 $[T_s, T_{\\max}]$，因为 $F(T_s) \\le 0$，并且对于所讨论的能量水平，我们可以验证 $F(T_{\\max}) > 0$。二分法通过重复地将该区间对半分割，同时保持根被限定在区间内，来保证收敛。\n3.  **边界情况**：如果速率 $\\lVert \\mathbf{u} \\rVert = 0$，则动能项为零。控制方程变为 $H(T_t) - H(T_s) = 0$。由于 $H(T)$ 的单调性，这直接意味着 $T_t = T_s$。算法被设计为能直接处理这种情况。\n\n因此，计算过程如下：\n1.  计算单位质量动能 $E_k = \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$。如果 $E_k = 0$，则返回 $T_s$。\n2.  计算 $H(T_s)$ 并定义目标函数 $F(T) = H(T) - H(T_s) - E_k$。\n3.  计算初始猜测值 $T^{(0)}$。\n4.  使用带回溯和物理界限的 Newton 方法进行迭代，并基于 $|F(T)|$ 检查收敛性。\n5.  如果 Newton 方法失败，则在区间 $[T_s, T_{\\max}]$ 上切换到二分法，并迭代直至收敛。\n6.  返回最终收敛的温度 $T_t$。\n\n这种混合方法结合了 Newton 方法在根附近的快速收敛性与二分法的保证收敛性，为这个具有物理动机的数值问题提供了一个鲁棒且高效的算法。",
            "answer": "[344.755495,300.0,1604.288219,139.756182,1205.748378,2816.324263]"
        }
    ]
}