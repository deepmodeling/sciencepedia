{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础但至关重要的情况开始：量热完全气体（calorically perfect gas）中的流动。这个练习将指导你从能量守恒基本方程出发，推导出总温度、静温和马赫数之间的经典关系。掌握这一推导过程是理解可压缩流动理论的基石，并为更复杂的分析奠定基础。",
            "id": "4001053",
            "problem": "在一个没有轴功的定常、无粘、绝热的可压缩流中，总比焓沿流线守恒。考虑将空气模拟为具有恒定热容和比热比 $\\gamma$ 的量热完全气体。自由来流的特征是静温 $T$ 和马赫数 $M$。\n\n从单位质量能量守恒和量热完全气体的比焓定义出发，推导静温 $T$、驻点（总）温度 $T_{t}$、流速 $V$ 和定压比热 $c_{p}$ 之间的关系。然后，利用声速 $a$ 及其理想气体关系式，消去 $V$ 并用 $M$ 表示。将无量纲驻点温度比 $T_{t}/T$ 完全用 $\\gamma$ 和 $M$ 表示。\n\n接下来，针对空气 ($\\gamma = 1.4$) 的情况进行计算。对于一个典型的高速平流层条件，$T = 220\\,\\mathrm{K}$ 且 $M = 7$，计算相应的 $T_{t}$，并将结果四舍五入到四位有效数字，以 $\\mathrm{K}$ 为单位表示。\n\n最后，通过求导数 $\\mathrm{d}(T_{t}/T)/\\mathrm{d}M$ 来分析 $T_{t}/T$ 对 $M$ 的敏感性，并确定其在大马赫数下的渐近行为。对于 $\\gamma = 1.4$ 的情况，确定精确系数 $c$，使得当 $M \\to \\infty$ 时，有 $T_{t}/T \\sim c\\,M^{2}$。\n\n在最终的方框答案中，仅以最简分数的形式报告 $c$ 的精确值，不带单位。不要在方框答案中报告任何中间结果。",
            "solution": "该问题陈述经核实具有科学依据、问题良定且客观。它是可压缩气体动力学中的一个标准练习。我们将按顺序解决问题的每个部分来进行求解。\n\n分析始于定常、绝热、无轴功或体积力的流动的能量守恒。对于沿流线运动的单位质量流体，其能量方程为：\n$$h + \\frac{1}{2}V^2 = \\text{constant}$$\n其中 $h$ 是比静焓，$V$ 是流速。此方程中的常数是总比焓，记为 $h_t$。总焓对应于流体被等熵地带到静止状态时所具有的焓。因此，\n$$h_t = h + \\frac{1}{2}V^2$$\n总温，或称驻点温度 $T_t$，被定义为与总焓 $h_t$ 相关联的温度。对于量热完全气体，比焓是温度的线性函数：$h = c_p T$，其中 $c_p$ 是定压比热，为一个常数。因此，我们可以写出 $h_t = c_p T_t$。将这些定义代入能量方程，得到第一个所要求的关系式：\n$$c_p T_t = c_p T + \\frac{1}{2}V^2$$\n该方程关联了静温 $T$、驻点温度 $T_t$、流速 $V$ 和定压比热 $c_p$。\n\n接下来，我们消去速度 $V$ 并用马赫数 $M$ 表示。马赫数定义为流速与当地声速 $a$ 之比：\n$$M = \\frac{V}{a} \\implies V = M a$$\n将此代入我们的能量关系式中，得到：\n$$c_p T_t = c_p T + \\frac{1}{2}(M a)^2 = c_p T + \\frac{1}{2}M^2 a^2$$\n为了表示无量纲温度比 $T_t/T$，我们将整个方程除以 $c_p T$：\n$$\\frac{T_t}{T} = 1 + \\frac{M^2 a^2}{2 c_p T}$$\n对于理想气体，声速的平方由 $a^2 = \\gamma R T$ 给出，其中 $\\gamma$ 是比热比，$R$ 是特定气体常数。代入这个 $a^2$ 的表达式：\n$$\\frac{T_t}{T} = 1 + \\frac{M^2 (\\gamma R T)}{2 c_p T} = 1 + \\left(\\frac{\\gamma R}{2 c_p}\\right) M^2$$\n对于理想气体，我们有热力学关系式 $c_p - c_v = R$，其中 $c_v$ 是定容比热。两边同除以 $c_p$ 得到 $1 - c_v/c_p = R/c_p$。由于 $\\gamma = c_p/c_v$，我们有 $c_v/c_p = 1/\\gamma$。因此：\n$$\\frac{R}{c_p} = 1 - \\frac{1}{\\gamma} = \\frac{\\gamma - 1}{\\gamma}$$\n将此代回温度比方程，得到期望的结果：\n$$\\frac{T_t}{T} = 1 + \\frac{\\gamma}{2}\\left(\\frac{\\gamma - 1}{\\gamma}\\right) M^2$$\n$$\\frac{T_t}{T} = 1 + \\frac{\\gamma - 1}{2} M^2$$\n这个基本方程关联了量热完全气体的驻点温度比、马赫数和比热比。\n\n现在我们针对给定的空气条件进行计算：$\\gamma = 1.4$，静温 $T = 220\\,\\mathrm{K}$，马赫数 $M = 7$。我们计算相应的驻点温度 $T_t$：\n$$T_t = T \\left( 1 + \\frac{\\gamma - 1}{2} M^2 \\right)$$\n$$T_t = 220 \\left( 1 + \\frac{1.4 - 1}{2} (7)^2 \\right)$$\n$$T_t = 220 \\left( 1 + \\frac{0.4}{2} (49) \\right)$$\n$$T_t = 220 \\left( 1 + (0.2)(49) \\right)$$\n$$T_t = 220 \\left( 1 + 9.8 \\right)$$\n$$T_t = 220 (10.8)$$\n$$T_t = 2376\\,\\mathrm{K}$$\n结果 $2376\\,\\mathrm{K}$ 已经有四位有效数字，因此无需进一步四舍五入。\n\n最后，我们分析温度比 $T_t/T$ 对马赫数 $M$ 的敏感性，并确定其在大 $M$ 值下的渐近行为。设函数 $f(M) = T_t/T = 1 + \\frac{\\gamma - 1}{2} M^2$。其敏感性由对 $M$ 的导数给出：\n$$\\frac{\\mathrm{d}}{\\mathrm{d}M}\\left(\\frac{T_t}{T}\\right) = \\frac{\\mathrm{d}}{\\mathrm{d}M}\\left(1 + \\frac{\\gamma - 1}{2} M^2\\right)$$\n$$\\frac{\\mathrm{d}(T_t/T)}{\\mathrm{d}M} = 0 + \\frac{\\gamma - 1}{2} (2M) = (\\gamma - 1)M$$\n这表明驻点温度比对马赫数的敏感性与 $M$ 呈线性关系。\n\n对于大 $M$ 值的渐近行为，我们考虑 $M \\to \\infty$ 的极限。在表达式 $T_t/T = 1 + \\frac{\\gamma-1}{2}M^2$ 中，与 $M^2$ 成正比的项主导了常数项 1。因此，我们可以写出渐近关系：\n$$\\frac{T_t}{T} \\sim \\frac{\\gamma-1}{2} M^2 \\quad \\text{as} \\quad M \\to \\infty$$\n问题要求找到系数 $c$，使得 $T_t/T \\sim c\\,M^2$。通过与我们推导出的渐近关系直接比较，我们确定系数 $c$ 为：\n$$c = \\frac{\\gamma-1}{2}$$\n对于空气，给定 $\\gamma = 1.4$。我们现在可以计算 $c$ 的精确值：\n$$c = \\frac{1.4 - 1}{2} = \\frac{0.4}{2} = 0.2$$\n按要求，我们将其表示为最简分数：\n$$c = 0.2 = \\frac{2}{10} = \\frac{1}{5}$$",
            "answer": "$$\\boxed{\\frac{1}{5}}$$"
        },
        {
            "introduction": "在高速飞行（尤其是高超声速）条件下，空气温度急剧升高，量热完全气体假设不再成立。本练习将探讨真实气体效应（real gas effects）的关键影响，通过对比“冻结流”（frozen flow）和“化学平衡流”（chemical equilibrium flow）两种模型，揭示化学反应如何改变滞止区的能量分布和最终温度。理解这种差异对于精确预测高超声速飞行器的气动热环境至关重要。",
            "id": "4001056",
            "problem": "马赫数 $M=10$、静温 $T_{\\infty}=300\\,\\mathrm{K}$ 的量热完全自由来流气流进入一个高焓驻点区，在该区域气流绝热减速至零速度，且无轴功输出。自由来流被建模为理想气体，其比气体常数 $R=287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，自由来流状态下的比热比 $\\gamma_{\\infty}=1.4$，这些参数仅用于计算自由来流声速。驻点（总）焓是守恒的，驻点（总）温度 $T_{t}$ 必须使用随温度变化的定压比热 $c_{p}(T)$ 从能量方程中确定。\n\n针对驻点区的空气，考虑了两种热化学假设：\n- 冻结化学（组分固定）：使用替代混合物模型 $c_{p,f}(T)=A_{f}+B_{f}T$，其中 $A_{f}=950\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$B_{f}=8.0\\times 10^{-2}\\,\\mathrm{J\\,kg^{-1}\\,K^{-2}}$。\n- 化学平衡（组分随温度调整）：使用替代混合物模型 $c_{p,e}(T)=A_{e}+B_{e}T$，其中 $A_{e}=900\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$B_{e}=1.8\\times 10^{-1}\\,\\mathrm{J\\,kg^{-1}\\,K^{-2}}$。\n\n在两种情况下，均取参考温度 $T_{\\mathrm{ref}}=300\\,\\mathrm{K}$，比焓定义为 $h(T)-h(T_{\\mathrm{ref}})=\\int_{T_{\\mathrm{ref}}}^{T} c_{p}(\\theta)\\,\\mathrm{d}\\theta$。假设自由来流静温等于参考温度，因此 $h(T_{\\infty})-h(T_{\\mathrm{ref}})=0$。\n\n仅从能量守恒和上述定义出发，计算差值 $\\Delta T_{t}=T_{t,f}-T_{t,e}$，其中 $T_{t,f}$ 和 $T_{t,e}$ 分别是在冻结和平衡假设下预测的驻点温度。然后，根据 $\\Delta T_{t}$ 的符号和大小，简要解释在高速计算流体力学（CFD, Computational Fluid Dynamics）分析中，这对热防护系统尺寸设计的工程影响。将您的 $\\Delta T_{t}$ 数值四舍五入到四位有效数字，并以 $\\mathrm{K}$ 为单位表示。您最终报告的答案必须仅为 $\\Delta T_{t}$ 的数值。",
            "solution": "经评估，此问题有效。\n\n已知条件如下：\n- 自由来流马赫数：$M=10$\n- 自由来流静温：$T_{\\infty}=300\\,\\mathrm{K}$\n- 流动条件：绝热减速至零速度，无轴功。\n- 自由来流理想气体性质（仅用于声速计算）：比气体常数 $R=287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，比热比 $\\gamma_{\\infty}=1.4$。\n- 驻点焓守恒。\n- 冻结化学的比热模型：$c_{p,f}(T)=A_{f}+B_{f}T$，其中 $A_{f}=950\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$B_{f}=8.0\\times 10^{-2}\\,\\mathrm{J\\,kg^{-1}\\,K^{-2}}$。\n- 化学平衡的比热模型：$c_{p,e}(T)=A_{e}+B_{e}T$，其中 $A_{e}=900\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$B_{e}=1.8\\times 10^{-1}\\,\\mathrm{J\\,kg^{-1}\\,K^{-2}}$。\n- 焓的参考温度：$T_{\\mathrm{ref}}=300\\,\\mathrm{K}$。\n- 焓的定义：$h(T)-h(T_{\\mathrm{ref}})=\\int_{T_{\\mathrm{ref}}}^{T} c_{p}(\\theta)\\,\\mathrm{d}\\theta$。\n- 自由来流温度假设：$T_{\\infty}=T_{\\mathrm{ref}}$。\n\n该问题具有科学依据、提法得当且客观。它基于流体动力学中的能量守恒基本原理，这是航空航天工程和计算流体力学（CFD）的核心课题。该问题比较了两种标准但简化的热化学模型（冻结流和平衡流），是高温气体动力学中的一个经典练习。所提供的数据在量纲上一致，并且在物理上对于建立问题是合理的。问题清晰明确，有唯一且有意义的解。\n\n解答过程从稳态开放系统的热力学第一定律开始，对于绝热且无轴功的流动，该定律简化为总焓 $h_t$ 守恒。总焓定义为静焓 $h$ 与单位质量动能 $\\frac{1}{2}V^2$ 之和：\n$$h_t = h + \\frac{1}{2}V^2$$\n自由来流（下标 $\\infty$）和驻点区（速度为零）之间的总焓守恒意味着：\n$$h(T_t) + \\frac{1}{2}(0)^2 = h(T_{\\infty}) + \\frac{1}{2}V_{\\infty}^2$$\n其中 $T_t$ 是驻点（总）温度。整理可得：\n$$h(T_t) - h(T_{\\infty}) = \\frac{1}{2}V_{\\infty}^2$$\n问题中说明 $T_{\\infty} = T_{\\mathrm{ref}}$，因此 $h(T_{\\infty}) = h(T_{\\mathrm{ref}})$。方程变为：\n$$h(T_t) - h(T_{\\mathrm{ref}}) = \\frac{1}{2}V_{\\infty}^2$$\n使用提供的焓的积分定义：\n$$\\int_{T_{\\mathrm{ref}}}^{T_t} c_{p}(\\theta)\\,\\mathrm{d}\\theta = \\frac{1}{2}V_{\\infty}^2$$\n首先，我们计算右侧的动能项。自由来流速度 $V_{\\infty}$ 是马赫数 $M$ 和自由来流声速 $a_{\\infty}$ 的乘积。声速由 $a_{\\infty} = \\sqrt{\\gamma_{\\infty} R T_{\\infty}}$ 给出。\n$$\n\\frac{1}{2}V_{\\infty}^2 = \\frac{1}{2}(M a_{\\infty})^2 = \\frac{1}{2}M^2 (\\gamma_{\\infty} R T_{\\infty})\n$$\n代入给定值 $M=10$，$\\gamma_{\\infty}=1.4$，$R=287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 和 $T_{\\infty}=300\\,\\mathrm{K}$：\n$$\n\\frac{1}{2}V_{\\infty}^2 = \\frac{1}{2}(10)^2 (1.4)(287)(300) = 50 \\times 120540 = 6027000\\,\\mathrm{J\\,kg^{-1}}\n$$\n该值表示使流动静止所需的比焓变化量。\n\n现在，我们通过计算左侧的积分，求解每种热化学模型下的驻点温度 $T_t$。\n\n情况1：冻结化学\n比热为 $c_{p,f}(T)=A_{f}+B_{f}T$。能量方程变为：\n$$\n\\int_{T_{\\mathrm{ref}}}^{T_{t,f}} (A_{f}+B_{f}\\theta)\\,\\mathrm{d}\\theta = \\frac{1}{2}V_{\\infty}^2\n$$\n$$\n\\left[ A_{f}\\theta + \\frac{1}{2}B_{f}\\theta^2 \\right]_{T_{\\mathrm{ref}}}^{T_{t,f}} = \\frac{1}{2}V_{\\infty}^2\n$$\n$$\n(A_{f}T_{t,f} + \\frac{1}{2}B_{f}T_{t,f}^2) - (A_{f}T_{\\mathrm{ref}} + \\frac{1}{2}B_{f}T_{\\mathrm{ref}}^2) = \\frac{1}{2}V_{\\infty}^2\n$$\n这是一个关于 $T_{t,f}$ 的二次方程：\n$$\n\\frac{1}{2}B_{f}T_{t,f}^2 + A_{f}T_{t,f} - \\left( \\frac{1}{2}V_{\\infty}^2 + A_{f}T_{\\mathrm{ref}} + \\frac{1}{2}B_{f}T_{\\mathrm{ref}}^2 \\right) = 0\n$$\n代入数值 $A_f=950$，$B_f=0.08$，$T_{\\mathrm{ref}}=300$ 和 $\\frac{1}{2}V_{\\infty}^2=6027000$：\n$$\n\\frac{1}{2}(0.08)T_{t,f}^2 + 950T_{t,f} - (6027000 + 950(300) + \\frac{1}{2}(0.08)(300)^2) = 0\n$$\n$$\n0.04T_{t,f}^2 + 950T_{t,f} - (6027000 + 285000 + 3600) = 0\n$$\n$$\n0.04T_{t,f}^2 + 950T_{t,f} - 6315600 = 0\n$$\n使用二次方程求根公式 $T_{t,f} = \\frac{-b + \\sqrt{b^2-4ac}}{2a}$ 求解（取物理上有意义的正根）：\n$$\nT_{t,f} = \\frac{-950 + \\sqrt{950^2 - 4(0.04)(-6315600)}}{2(0.04)} = \\frac{-950 + \\sqrt{902500 + 1010496}}{0.08} = \\frac{-950 + \\sqrt{1912996}}{0.08} \\approx 5413.8421\\,\\mathrm{K}\n$$\n\n情况2：化学平衡\n比热为 $c_{p,e}(T)=A_{e}+B_{e}T$。能量方程具有相同的形式：\n$$\n\\frac{1}{2}B_{e}T_{t,e}^2 + A_{e}T_{t,e} - \\left( \\frac{1}{2}V_{\\infty}^2 + A_{e}T_{\\mathrm{ref}} + \\frac{1}{2}B_{e}T_{\\mathrm{ref}}^2 \\right) = 0\n$$\n代入数值 $A_e=900$，$B_e=0.18$，$T_{\\mathrm{ref}}=300$ 和 $\\frac{1}{2}V_{\\infty}^2=6027000$：\n$$\n\\frac{1}{2}(0.18)T_{t,e}^2 + 900T_{t,e} - (6027000 + 900(300) + \\frac{1}{2}(0.18)(300)^2) = 0\n$$\n$$\n0.09T_{t,e}^2 + 900T_{t,e} - (6027000 + 270000 + 8100) = 0\n$$\n$$\n0.09T_{t,e}^2 + 900T_{t,e} - 6305100 = 0\n$$\n求解 $T_{t,e}$：\n$$\nT_{t,e} = \\frac{-900 + \\sqrt{900^2 - 4(0.09)(-6305100)}}{2(0.09)} = \\frac{-900 + \\sqrt{810000 + 2269836}}{0.18} = \\frac{-900 + \\sqrt{3079836}}{0.18} \\approx 4749.7008\\,\\mathrm{K}\n$$\n\n最后，我们计算差值 $\\Delta T_{t} = T_{t,f} - T_{t,e}$：\n$$\n\\Delta T_{t} = 5413.8421\\,\\mathrm{K} - 4749.7008\\,\\mathrm{K} = 664.1413\\,\\mathrm{K}\n$$\n按要求四舍五入到四位有效数字，我们得到 $\\Delta T_t = 664.1\\,\\mathrm{K}$。\n\n$\\Delta T_{t}$ 的正号表明，冻结化学模型预测的驻点温度高于化学平衡模型。这是因为在平衡模型中，一部分从动能转化而来的热能被吸热化学反应（例如，分子离解）吸收，而这些反应在冻结模型中没有被考虑。这起到了能量汇的作用，有效地增加了气体混合物的比热。对于一个固定的焓增量（来自运动能），具有更高有效比热的气体将经历较小的温升。\n\n这对于计算流体力学中热防护系统（TPS）的尺寸设计具有显著的工程影响。驻点温度是驱动飞行器表面气动加热率的关键参数。假设冻结化学的CFD分析会比包含平衡化学效应的更物理精确的分析预测出高得多的壁面温度。这种对温度的过高预测会导致保守的设计，从而造成TPS尺寸过大、更重且成本更高。因此，精确的热化学建模对于高超声速飞行器的高效和安全设计至关重要。",
            "answer": "$$\n\\boxed{664.1}\n$$"
        },
        {
            "introduction": "理论知识的最终目的是应用于实际计算。在现代CFD求解器中，流体的热力学属性通常是温度的复杂函数，无法再进行简单的解析求解。这个实践练习将理论与计算相结合，要求你设计并实现一个稳健的数值算法（包含牛顿迭代法），以求解变比热条件下的总温度。通过这个练习，你将亲身体验CFD代码如何处理复杂的热力学模型，从而将理论概念转化为强大的工程工具。",
            "id": "4001068",
            "problem": "您的任务是设计并实现一个鲁棒的算法，用于在定压比热 $c_p(T)$ 随温度变化的计算流体动力学 (CFD) 环境中，计算总温（滞止温度），记为 $T_t$。该解法必须源自适用于航空航天计算流体动力学 (CFD) 的第一性原理，并以国际单位制 (SI单位) 表示。具体而言，您应使用沿流线的绝热、无轴功、稳态流的基本能量关系：总焓等于静焓加上单位质量的动能。总温 $T_t$ 由焓恒等式 $h(T_t) = h(T) + \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2$ 隐式定义，其中 $h(T)$ 是作为温度 $T$ 函数的热力学焓，$\\lVert \\mathbf{u} \\rVert$ 是速率。\n\n为使问题在计算上具体化，考虑一个干空气的热力学模型，其可变比热 $c_p(T)$ 由一个关于参考温度 $T_0 = 300\\,\\mathrm{K}$ 的温度相关多项式给出。定义温差 $x = T - T_0$ 并令\n$$\nc_p(T) = a_0 + a_1 x + a_2 x^2 + a_3 x^3,\n$$\n其中常数（对于干空气，在 $100\\,\\mathrm{K}$ 到 $4000\\,\\mathrm{K}$ 的范围内物理上是合理的）\n$$\na_0 = 1004.5\\,\\mathrm{\\tfrac{J}{kg\\,K}},\\quad a_1 = 0.1\\,\\mathrm{\\tfrac{J}{kg\\,K^2}},\\quad a_2 = -10^{-4}\\,\\mathrm{\\tfrac{J}{kg\\,K^3}},\\quad a_3 = 5\\times 10^{-8}\\,\\mathrm{\\tfrac{J}{kg\\,K^4}}.\n$$\n使用焓的定义，即 $c_p(T)$ 的温度积分：\n$$\nh(T) = h(T_0) + \\int_{T_0}^{T} c_p(\\tau)\\, d\\tau,\n$$\n为计算方便，设置 $h(T_0) = 0$，这样就只有焓差有意义。上述 $c_p(T)$ 对应的焓原函数为\n$$\nH(T) = a_0 x + \\tfrac{1}{2} a_1 x^2 + \\tfrac{1}{3} a_2 x^3 + \\tfrac{1}{4} a_3 x^4,\\quad x = T - T_0,\n$$\n因此，$T$ 和给定静温 $T_s$ 之间的焓差为 $H(T) - H(T_s)$，定义 $T_t$ 的方程变为\n$$\nH(T_t) - H(T_s) - \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2 = 0.\n$$\n\n您的程序必须：\n- 为标量函数 $F(T) = H(T) - H(T_s) - \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2$ 实现一个求根算法，使用带有回溯线搜索的牛顿迭代法，以确保每一步残差的绝对值都能稳健地减小。牛顿法所需的导数为 $F'(T) = \\dfrac{d H}{d T} = c_p(T)$。\n- 用物理上有意义的界限 $T \\in [T_s, T_{\\max}]$（其中 $T_{\\max} = 4000\\,\\mathrm{K}$）来保护迭代过程，并在残差的绝对值足够小或步长变得过小时终止牛顿法过程。\n- 如果回溯线搜索未能使残差减小，则包含一个后备的区间套和二分法程序。利用 $c_p(T) > 0$ 所蕴含的单调性来构造一个使 $F(T)$ 具有相反符号的区间 $[T_{\\text{low}}, T_{\\text{high}}]$，然后执行二分法直到收敛。\n- 使用初始猜测值 $T^{(0)} = T_s + \\dfrac{\\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2}{c_p(T_s)}$，并确保算法能够平稳地处理边界情况 $\\lVert \\mathbf{u} \\rVert = 0$。\n- 将 $\\lVert \\mathbf{u} \\rVert$ 计算为速度矢量分量的欧几里得范数。\n\n物理单位要求：\n- 温度 $T_s$ 和 $T_t$ 必须以 $\\mathrm{K}$ 为单位。\n- 速度分量必须以 $\\mathrm{m/s}$ 为单位，速率也以 $\\mathrm{m/s}$ 为单位计算。\n- 比热 $c_p(T)$ 和焓必须分别与 $\\mathrm{J/(kg\\,K)}$ 和 $\\mathrm{J/kg}$ 的单位保持一致。\n\n数值精度和输出：\n- 对于每个测试用例，返回计算出的总温 $T_t$（单位为 $\\mathrm{K}$），四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，\"[result1,result2,result3]\"），每个结果都是四舍五入后的浮点数。\n\n测试套件：\n使用以下测试用例，表示为元组 $(T_s,\\ \\mathbf{u})$，其中 $\\mathbf{u} = (u_x,u_y,u_z)$ 的单位是 $\\mathrm{m/s}$，$T_s$ 的单位是 $\\mathrm{K}$。\n1. $(300.0,\\ (300.0,\\ 0.0,\\ 0.0))$ — 典型的亚音速条件（“理想路径”）。\n2. $(300.0,\\ (0.0,\\ 0.0,\\ 0.0))$ — 零速率的边界情况。\n3. $(1200.0,\\ (1000.0,\\ 0.0,\\ 0.0))$ — 高静温伴有显著速率。\n4. $(100.0,\\ (-200.0,\\ 200.0,\\ 0.0))$ — 低静温，速度分量符号混合。\n5. $(220.0,\\ (1500.0,\\ 0.0,\\ 0.0))$ — 低静温下的超音速条件。\n6. $(1800.0,\\ (2000.0,\\ -500.0,\\ 0.0))$ — 高静温伴有大速率，但在可行范围内。\n\n终止标准：\n- 残差容差：当 $\\lvert F(T) \\rvert \\le 10^{-6}\\,\\mathrm{J/kg}$ 时，宣告收敛。\n- 步长保护：如果回溯步长乘子低于 $10^{-8}$，则触发区间套和二分法。\n- 最大牛顿迭代次数：$50$。\n\n您的程序应生成单行输出，包含六个计算出的 $T_t$ 值（单位为 $\\mathrm{K}$），四舍五入到六位小数，格式化为方括号括起来的逗号分隔列表。",
            "solution": "确定总温是航空航天工程和计算流体动力学中的一个重要参数，其本质上是一个能量守恒问题。我们首先验证问题陈述本身，然后从第一性原理推导解决方案。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **目标**：为一种具有随温度变化的比热 $c_p(T)$ 的流体计算总温（滞止温度）$T_t$。\n-   **控制原理**：对于绝热、无轴功的稳态流，总焓是守恒的。这表示为 $h(T_t) = h(T) + \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2$，其中 $T$ 是静温，$\\lVert \\mathbf{u} \\rVert$ 是流体速率。\n-   **比热模型**：干空气的定压比热 $c_p(T)$ 由一个关于参考温度 $T_0 = 300\\,\\mathrm{K}$ 的 $x = T - T_0$ 的多项式给出：\n    $$c_p(T) = a_0 + a_1 x + a_2 x^2 + a_3 x^3$$\n-   **系数**：\n    -   $a_0 = 1004.5\\,\\mathrm{\\tfrac{J}{kg\\,K}}$\n    -   $a_1 = 0.1\\,\\mathrm{\\tfrac{J}{kg\\,K^2}}$\n    -   $a_2 = -10^{-4}\\,\\mathrm{\\tfrac{J}{kg\\,K^3}}$\n    -   $a_3 = 5\\times 10^{-8}\\,\\mathrm{\\tfrac{J}{kg\\,K^4}}$\n    -   该模型据称在 $T \\in [100\\,\\mathrm{K}, 4000\\,\\mathrm{K}]$ 范围内是物理上合理的。\n-   **焓的定义**：焓通过比热的积分定义，$h(T) = h(T_0) + \\int_{T_0}^{T} c_p(\\tau)\\, d\\tau$。为方便起见，设定参考焓 $h(T_0) = 0$。\n-   **焓原函数**：积分形式由 $H(T) = a_0 x + \\tfrac{1}{2} a_1 x^2 + \\tfrac{1}{3} a_2 x^3 + \\tfrac{1}{4} a_3 x^4$ 给出，其中 $x = T - T_0$。\n-   **待解方程**：问题是找到函数 $F(T) = H(T) - H(T_s) - \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2 = 0$ 的根，其中 $T_s$ 是静温。\n-   **数值方法**：\n    1.  **主要方法**：带回溯线搜索的牛顿法。\n    2.  **导数**：导数为 $F'(T) = c_p(T)$。\n    3.  **初始猜测值**：$T^{(0)} = T_s + \\dfrac{\\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2}{c_p(T_s)}$。\n    4.  **后备方法**：若回溯失败，则使用区间套和二分法。\n-   **约束与保护措施**：\n    -   迭代的物理界限：$T \\in [T_s, T_{\\max}]$，其中 $T_{\\max} = 4000\\,\\mathrm{K}$。\n    -   收敛的残差容差：$\\lvert F(T) \\rvert \\le 10^{-6}\\,\\mathrm{J/kg}$。\n    -   回溯的步长保护：如果步长乘子低于 $10^{-8}$，则触发二分法。\n    -   最大牛顿迭代次数：$50$。\n-   **单位**：所有单位必须是国际单位制：温度为开尔文 ($\\mathrm{K}$)，速度为米每秒 ($\\mathrm{m/s}$)，与能量相关的量以焦耳 ($\\mathrm{J}$)、千克 ($\\mathrm{kg}$) 等为单位。\n-   **测试用例**：提供了六个特定的 $(T_s, \\mathbf{u})$ 测试用例。\n-   **输出格式**：一个单行的、用逗号分隔的结果列表，四舍五入到六位小数，并用方括号括起来。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据充分**：该问题基于应用于稳态流动系统的热力学第一定律，特别是总焓的定义。$c_p(T)$ 的多项式表示是气体动力学中使用的标准且有效的经验模型。这些值对于空气来说在物理上是合理的。该问题根本上是合理的。\n-   **适定的**：待解函数 $F(T) = H(T) - H(T_s) - \\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2$ 对于物理上现实的温度是严格单调的。其导数是 $F'(T) = c_p(T)$，在指定的温度范围 $[100\\,\\mathrm{K}, 4000\\,\\mathrm{K}]$ 内保持为正。一个严格单调的函数最多只有一个根。由于 $F(T_s) = -\\tfrac{1}{2}\\lVert \\mathbf{u} \\rVert^2 \\le 0$ 并且 $H(T)$ 是 $T$ 的单调递增函数，只要所需的焓升可以在模型的有效温度范围内实现，就保证存在一个唯一的解 $T_t \\ge T_s$。该问题提供了所有必要的数据和鲁棒的数值策略，确保可以找到唯一且稳定的解。\n-   **客观性**：该问题以完全的客观性陈述，使用了精确的数学和物理定义，没有主观语言或歧义。\n\n**步骤 3：结论与行动**\n\n该问题具有科学依据，数学上适定，并且陈述客观。因此，这是一个**有效**的问题。我们将继续推导和实现解决方案。\n\n### 基于原理的解决方案设计\n\n这个问题的核心在于能量守恒原理，该原理适用于在稳态、绝热、无轴功的流动中沿流线运动的流体微团。能量方程的具体形式是总焓 $h_t$ 守恒。总焓是静（热力学）焓 $h$ 与单位质量动能 $\\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$ 之和。\n\n令 $T_s$ 为流场中某点的静温，$\\mathbf{u}$ 为该点的速度矢量。该点的静焓为 $h(T_s)$。总焓定义为：\n$$h_t = h(T_s) + \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$$\n总温 $T_t$ 定义为流体被等熵地减速至静止时将达到的温度。这意味着它是与总焓相对应的温度，即 $h(T_t) = h_t$。结合这些定义，我们得到控制关系：\n$$h(T_t) = h(T_s) + \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$$\n该方程隐式定义了总温 $T_t$。为了求解 $T_t$，我们必须有焓 $h(T)$ 的函数形式。\n\n根据热力学，比焓的微分变化由 $dh = c_p dT$ 给出，其中 $c_p$ 是定压比热。将其从参考温度 $T_0$ 积分到任意温度 $T$ 得：\n$$h(T) - h(T_0) = \\int_{T_0}^{T} c_p(\\tau) d\\tau$$\n为计算方便，我们可以设定参考焓 $h(T_0)$ 为零，因为只有焓*差*才具有物理意义。$T_t$ 的控制方程可以重写为：\n$$h(T_t) - h(T_s) = \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$$\n问题提供了一个以 $T_0 = 300\\,\\mathrm{K}$ 为中心的多项式模型来表示 $c_p(T)$。令 $x = T - T_0$，我们有：\n$$c_p(T) = a_0 + a_1 x + a_2 x^2 + a_3 x^3$$\n我们定义一个原函数 $H(T)$，使得 $H(T) = \\int_{T_0}^{T} c_p(\\tau) d\\tau$。将 $c_p$ 的多项式相对于 $x$ 逐项积分得到：\n$$H(T) = a_0 x + \\frac{1}{2} a_1 x^2 + \\frac{1}{3} a_2 x^3 + \\frac{1}{4} a_3 x^4$$\n根据这个定义，焓差就是 $h(T_t) - h(T_s) = H(T_t) - H(T_s)$。我们的控制方程变为：\n$$H(T_t) - H(T_s) = \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$$\n为了求解 $T_t$，我们构建一个求根问题。我们寻找满足以下条件的 $T$ 值：\n$$F(T) = H(T) - H(T_s) - \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2 = 0$$\n\n问题要求使用牛顿法进行数值求解。牛顿法的迭代公式是：\n$$T^{(k+1)} = T^{(k)} - \\frac{F(T^{(k)})}{F'(T^{(k)})}$$\n其中 $T^{(k)}$ 是第 $k$ 次迭代时根的估计值。需要求导数 $F'(T)$。将 $F(T)$ 对 $T$ 求导得到：\n$$F'(T) = \\frac{d}{dT} \\left( H(T) - H(T_s) - \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2 \\right) = \\frac{dH}{dT} = c_p(T)$$\n这为评估每个牛顿步骤所需的导数提供了一种直接的、非迭代的方法。\n\n一个精明的初始猜测值 $T^{(0)}$ 能显著改善收敛性。如果 $c_p$ 是常数且等于其在静温下的值 $c_p(T_s)$，积分将简化为 $h(T_t) - h(T_s) = c_p(T_s)(T_t - T_s)$。这将产生一个 $T_t$ 的显式解：$T_t = T_s + \\frac{\\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2}{c_p(T_s)}$。我们使用它作为初始猜测值，因为它代表了一个具有物理动机的一阶近似。\n\n为确保鲁棒性，算法集成了几个保护措施：\n1.  **回溯线搜索**：一个完整的牛顿步可能过于激进，可能会过冲根或导致发散。我们在更新规则中引入一个步长乘子 $\\alpha \\in (0, 1]$：$T^{(k+1)} = T^{(k)} - \\alpha \\frac{F(T^{(k)})}{F'(T^{(k)})}$。我们从 $\\alpha=1$ 开始，并相继减小它（例如，减半），直到残差的绝对值得到了充分的减小，即 $|F(T^{(k+1)})|  |F(T^{(k)})|$，同时确保新的估计值保持在物理界限 $[T_s, T_{\\max}]$ 内。\n2.  **回退到二分法**：如果回溯线搜索失败（即 $\\alpha$ 变得小于预设的容差），这表明牛顿法遇到了困难。我们便切换到更鲁棒但较慢的二分法。由于 $F'(T) = c_p(T) > 0$，$F(T)$ 是单调的。我们有一个可靠的区间 $[T_s, T_{\\max}]$，因为 $F(T_s) \\le 0$，并且对于所讨论的能量水平，我们可以验证 $F(T_{\\max}) > 0$。二分法通过重复地将该区间减半，同时保持根被包含在内，从而保证收敛。\n3.  **边界情况**：如果速率 $\\lVert \\mathbf{u} \\rVert = 0$，动能项为零。控制方程变为 $H(T_t) - H(T_s) = 0$。由于 $H(T)$ 的单调性，这直接意味着 $T_t = T_s$。算法被设计为可以直接处理这种情况。\n\n因此，计算过程如下：\n1.  计算单位质量的动能 $E_k = \\frac{1}{2}\\lVert \\mathbf{u} \\rVert^2$。如果 $E_k = 0$，则返回 $T_s$。\n2.  计算 $H(T_s)$ 并定义目标函数 $F(T) = H(T) - H(T_s) - E_k$。\n3.  计算初始猜测值 $T^{(0)}$。\n4.  使用带有回溯和物理界限的牛顿法进行迭代，并基于 $|F(T)|$ 检查收敛性。\n5.  如果牛顿法失败，则在区间 $[T_s, T_{\\max}]$ 上切换到二分法，并迭代直到收敛。\n6.  返回最终收敛的温度 $T_t$。\n\n这种混合方法将牛顿法在根附近的快速收敛性与二分法的保证收敛性相结合，为这个具有物理动机的数值问题提供了一个鲁棒且高效的算法。",
            "answer": "[344.757855,300.0,1658.26786,139.620023,1248.65349,3086.082264]"
        }
    ]
}