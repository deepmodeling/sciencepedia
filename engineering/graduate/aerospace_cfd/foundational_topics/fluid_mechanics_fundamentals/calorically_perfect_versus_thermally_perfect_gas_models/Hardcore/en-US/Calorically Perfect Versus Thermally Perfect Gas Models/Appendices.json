{
    "hands_on_practices": [
        {
            "introduction": "To accurately simulate high-speed flows where temperature variations are significant, we must move beyond the calorically perfect gas assumption. This exercise provides direct experience with the industry-standard NASA 7-coefficient polynomials, which are widely used in CFD to model the temperature-dependent properties of a thermally perfect gas. By working through this problem, you will not only learn how to compute key thermodynamic properties like specific heat $C_p(T)$ and enthalpy $h(T)$, but also verify that these complex empirical models are constructed to be fully consistent with fundamental thermodynamic laws, such as Mayer's relation, $C_p(T) - C_v(T) = R$ .",
            "id": "3946385",
            "problem": "A stationary, constant-composition, ideal-gas model is used for dry atmospheric air in a Computational Fluid Dynamics (CFD) context to compare the calorically perfect and thermally perfect gas assumptions. In a calorically perfect gas, the specific heats are constant, whereas in a thermally perfect gas, the specific heats depend on temperature due to internal mode excitation. Assume air is an ideal gas with temperature-dependent thermodynamic properties represented by the National Aeronautics and Space Administration (NASA) seven-coefficient polynomials over two temperature intervals and constant mixture molecular weight. Let the universal molar gas constant be $R_{\\mathrm{u}} = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$, and the mixture molar mass of air be $\\overline{M} = 2.896546 \\times 10^{-2} \\ \\mathrm{kg \\ mol^{-1}}$, so that the mass-specific gas constant is $R = R_{\\mathrm{u}} / \\overline{M}$.\n\nThe NASA polynomial coefficients for air are given for two temperature ranges:\n\nFor $200 \\le T \\le 1000 \\ \\mathrm{K}$ (low-temperature interval):\n- $a_{1}^{\\mathrm{L}} = 3.16826710$, $a_{2}^{\\mathrm{L}} = -1.63965942 \\times 10^{-3}$, $a_{3}^{\\mathrm{L}} = 2.21435474 \\times 10^{-6}$, $a_{4}^{\\mathrm{L}} = -1.53116000 \\times 10^{-9}$, $a_{5}^{\\mathrm{L}} = 4.65993000 \\times 10^{-13}$, $a_{6}^{\\mathrm{L}} = -1.24007897 \\times 10^{3}$, $a_{7}^{\\mathrm{L}} = 5.40484100$.\n\nFor $1000 < T \\le 6000 \\ \\mathrm{K}$ (high-temperature interval):\n- $a_{1}^{\\mathrm{H}} = 2.56942000$, $a_{2}^{\\mathrm{H}} = -8.59740900 \\times 10^{-5}$, $a_{3}^{\\mathrm{H}} = 4.19484589 \\times 10^{-8}$, $a_{4}^{\\mathrm{H}} = -1.00177799 \\times 10^{-11}$, $a_{5}^{\\mathrm{H}} = 1.22833691 \\times 10^{-15}$, $a_{6}^{\\mathrm{H}} = -1.35578163 \\times 10^{3}$, $a_{7}^{\\mathrm{H}} = 9.15344100$.\n\nUse the standard NASA seven-coefficient polynomial representation for thermally perfect ideal gases to:\n1. Derive expressions for the mass-specific heat at constant pressure $C_{p}(T)$, mass-specific enthalpy $h(T)$, and mass-specific entropy $s(T)$ based on the appropriate coefficient set for each temperature interval. Clearly state how you select the coefficient set at each temperature.\n2. Using the ideal-gas identity $h(T) = u(T) + R T$ and the definitions $C_{p}(T) = \\mathrm{d}h/\\mathrm{d}T$ and $C_{v}(T) = \\mathrm{d}u/\\mathrm{d}T$, derive $C_{p}(T) - C_{v}(T)$ and discuss its significance for calorically perfect versus thermally perfect gas models.\n3. Evaluate, at the temperatures $T \\in \\{300, 1000, 3000\\} \\ \\mathrm{K}$, the residual\n$$r(T) = \\left[C_{p}(T) - C_{v}(T)\\right] - R$$\nusing the thermally perfect model with the given coefficients and report the maximum absolute value over the set $\\{300, 1000, 3000\\}$.\n\nExpress the final reported maximum absolute residual in $\\mathrm{J \\ kg^{-1} \\ K^{-1}}$ and round your answer to four significant figures.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Model**: Stationary, constant-composition, ideal-gas model for dry atmospheric air.\n- **Comparison**: Calorically perfect vs. thermally perfect gas assumptions.\n- **Gas Properties**: Assumed to be an ideal gas with temperature-dependent properties given by NASA seven-coefficient polynomials.\n- **Constants**:\n  - Universal molar gas constant, $R_{\\mathrm{u}} = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$.\n  - Mixture molar mass of air, $\\overline{M} = 2.896546 \\times 10^{-2} \\ \\mathrm{kg \\ mol^{-1}}$.\n- **Derived Constant**: Mass-specific gas constant, $R = R_{\\mathrm{u}} / \\overline{M}$.\n- **NASA Coefficients (Low-Temperature, $200 \\le T \\le 1000 \\ \\mathrm{K}$)**:\n  - $a_{1}^{\\mathrm{L}} = 3.16826710$\n  - $a_{2}^{\\mathrm{L}} = -1.63965942 \\times 10^{-3}$\n  - $a_{3}^{\\mathrm{L}} = 2.21435474 \\times 10^{-6}$\n  - $a_{4}^{\\mathrm{L}} = -1.53116000 \\times 10^{-9}$\n  - $a_{5}^{\\mathrm{L}} = 4.65993000 \\times 10^{-13}$\n  - $a_{6}^{\\mathrm{L}} = -1.24007897 \\times 10^{3}$\n  - $a_{7}^{\\mathrm{L}} = 5.40484100$\n- **NASA Coefficients (High-Temperature, $1000 < T \\le 6000 \\ \\mathrm{K}$)**:\n  - $a_{1}^{\\mathrm{H}} = 2.56942000$\n  - $a_{2}^{\\mathrm{H}} = -8.59740900 \\times 10^{-5}$\n  - $a_{3}^{\\mathrm{H}} = 4.19484589 \\times 10^{-8}$\n  - $a_{4}^{\\mathrm{H}} = -1.00177799 \\times 10^{-11}$\n  - $a_{5}^{\\mathrm{H}} = 1.22833691 \\times 10^{-15}$\n  - $a_{6}^{\\mathrm{H}} = -1.35578163 \\times 10^{3}$\n  - $a_{7}^{\\mathrm{H}} = 9.15344100$\n- **Tasks**:\n  1. Derive expressions for mass-specific $C_{p}(T)$, $h(T)$, and $s(T)$.\n  2. Derive $C_{p}(T) - C_{v}(T)$ from specified identities and discuss its significance.\n  3. Evaluate the residual $r(T) = [C_{p}(T) - C_{v}(T)] - R$ at $T \\in \\{300, 1000, 3000\\} \\ \\mathrm{K}$ and report the maximum absolute value.\n- **Identities**: $h(T) = u(T) + R T$, $C_{p}(T) = \\mathrm{d}h/\\mathrm{d}T$, $C_{v}(T) = \\mathrm{d}u/\\mathrm{d}T$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientifically Grounded**: The problem is based on the ideal gas model and the NASA 7-coefficient polynomial representation for thermodynamic properties. These are standard, well-established models in thermodynamics and aerospace engineering. The values for $R_{\\mathrm{u}}$ and $\\overline{M}$ are standard and correct. The problem is scientifically sound.\n- **Well-Posed**: The tasks are clearly defined. The required inputs (coefficients, constants, temperatures) are all provided. The requested derivations and evaluation lead to a unique, meaningful solution.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language.\n- **Completeness and Consistency**: The problem is self-contained. The polynomial coefficients are provided for the relevant temperature ranges. The use of \"standard NASA seven-coefficient polynomial representation\" refers to a unique and well-known set of equations, making the problem unambiguous. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a well-posed problem grounded in established principles of thermodynamics and computational fluid dynamics. The solution process may proceed.\n\n---\n\n### Solution\n\nThe solution is developed by sequentially addressing the three tasks specified in the problem statement. First, the mass-specific gas constant for air is calculated as $R = R_{\\mathrm{u}} / \\overline{M}$.\n\n**1. Expressions for Thermodynamic Properties**\n\nThe standard NASA 7-coefficient polynomial formulation provides non-dimensional forms for molar specific heat capacity at constant pressure $(\\overline{C_{p}})$, molar enthalpy $(\\overline{h})$, and molar entropy $(\\overline{s})$. To obtain the mass-specific properties $C_{p}(T)$, $h(T)$, and $s(T)$, we use the mass-specific gas constant $R$.\n\nThe selection of the coefficient set depends on the temperature $T$. For a given temperature $T$, if $200 \\ \\mathrm{K} \\le T \\le 1000 \\ \\mathrm{K}$, the low-temperature coefficients $\\{ a_i^{\\mathrm{L}} \\}$ are used. If $1000 \\ \\mathrm{K} < T \\le 6000 \\ \\mathrm{K}$, the high-temperature coefficients $\\{ a_i^{\\mathrm{H}} \\}$ are used. Let $\\{a_i\\}$ represent the appropriate set for a given $T$.\n\nThe mass-specific heat at constant pressure, $C_{p}(T)$, is given by:\n$$ \\frac{C_p(T)}{R} = a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 $$\n$$ C_p(T) = R \\left( a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\right) $$\n\nThe mass-specific enthalpy, $h(T)$, is given by:\n$$ \\frac{h(T)}{RT} = a_1 + \\frac{a_2}{2} T + \\frac{a_3}{3} T^2 + \\frac{a_4}{4} T^3 + \\frac{a_5}{5} T^4 + \\frac{a_6}{T} $$\n$$ h(T) = RT \\left( a_1 + \\frac{a_2}{2} T + \\frac{a_3}{3} T^2 + \\frac{a_4}{4} T^3 + \\frac{a_5}{5} T^4 + \\frac{a_6}{T} \\right) = R \\left( a_1 T + \\frac{a_2}{2} T^2 + \\frac{a_3}{3} T^3 + \\frac{a_4}{4} T^4 + \\frac{a_5}{5} T^5 + a_6 \\right) $$\nThe forms for $C_p(T)$ and $h(T)$ are thermodynamically consistent, as $C_p(T) = \\mathrm{d}h/\\mathrm{d}T$.\n\nThe mass-specific entropy at standard pressure, $s(T)$, is given by:\n$$ \\frac{s(T)}{R} = a_1 \\ln(T) + a_2 T + \\frac{a_3}{2} T^2 + \\frac{a_4}{3} T^3 + \\frac{a_5}{4} T^4 + a_7 $$\n$$ s(T) = R \\left( a_1 \\ln(T) + a_2 T + \\frac{a_3}{2} T^2 + \\frac{a_4}{3} T^3 + \\frac{a_5}{4} T^4 + a_7 \\right) $$\n\n**2. Derivation of $C_{p}(T) - C_{v}(T)$**\n\nThis derivation begins with the definition of enthalpy for an ideal gas, which is provided:\n$$ h(T) = u(T) + RT $$\nHere, $u(T)$ is the mass-specific internal energy, and both $h$ and $u$ are functions of temperature only for an ideal gas. We differentiate this expression with respect to temperature $T$:\n$$ \\frac{\\mathrm{d}h(T)}{\\mathrm{d}T} = \\frac{\\mathrm{d}u(T)}{\\mathrm{d}T} + \\frac{\\mathrm{d}(RT)}{\\mathrm{d}T} $$\nSince $R$ is a constant, $\\mathrm{d}(RT)/\\mathrm{d}T = R$. The derivatives of enthalpy and internal energy are, by definition, the mass-specific heat capacities at constant pressure and constant volume, respectively:\n$$ C_p(T) = \\frac{\\mathrm{d}h(T)}{\\mathrm{d}T} \\quad \\text{and} \\quad C_v(T) = \\frac{\\mathrm{d}u(T)}{\\mathrm{d}T} $$\nSubstituting these definitions into the differentiated equation yields:\n$$ C_p(T) = C_v(T) + R $$\nRearranging this gives the desired relation:\n$$ C_p(T) - C_v(T) = R $$\nThis result is known as Mayer's relation for an ideal gas.\n\n**Significance:**\nThis relation is a fundamental consequence of the ideal gas model. Its significance in the context of the problem is that it holds true regardless of whether the gas is calorically perfect or thermally perfect.\n- For a **calorically perfect gas**, $C_p$ and $C_v$ are defined as constants. Their difference is necessarily the constant $R$.\n- For a **thermally perfect gas**, $C_p(T)$ and $C_v(T)$ are functions of temperature. However, their difference remains constant and equal to $R$. This is because the variation with temperature is the same for both specific heats. The physical reason is that for an ideal gas, internal energy and enthalpy changes are solely due to temperature changes, and the $p V$ term in enthalpy (here, $RT$) directly links the difference between $C_p$ and $C_v$ to the gas constant $R$. The NASA polynomial model is constructed to be consistent with this fundamental thermodynamic law.\n\n**3. Evaluation of the Residual $r(T)$**\n\nThe residual is defined as:\n$$ r(T) = [C_p(T) - C_v(T)] - R $$\nFrom the analytical derivation in Part 2, we established that for any ideal gas, including one described by the NASA polynomials, $C_p(T) - C_v(T) = R$.\n\nTo confirm this using the polynomial forms, we can derive an expression for $C_v(T)$ directly.\nFrom Part 2, $C_v(T) = C_p(T) - R$. Using the polynomial for $C_p(T)$ from Part 1:\n$$ C_v(T) = R \\left( a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\right) - R $$\n$$ C_v(T) = R \\left( (a_1 - 1) + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4 \\right) $$\nNow, let's substitute this expression for $C_v(T)$ and the one for $C_p(T)$ into the residual definition:\n$$ r(T) = \\left[ R \\left( \\sum_{i=1}^{5} a_i T^{i-1} \\right) - \\left( R \\left( \\sum_{i=1}^{5} a_i T^{i-1} \\right) - R \\right) \\right] - R $$\nSimplifying the expression in the brackets:\n$$ r(T) = [R - R] = 0 $$\nThis result is purely analytical and does not depend on the specific values of the coefficients $\\{a_i\\}$ or the temperature $T$. The structure of the NASA polynomial model is intentionally designed to be consistent with Mayer's relation, $C_p - C_v = R$. Therefore, the residual $r(T)$ is analytically equal to zero for all temperatures for which the ideal gas model is valid.\n\nConsequently, for the specified temperatures:\n- At $T = 300 \\ \\mathrm{K}$, $r(300) = 0 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$.\n- At $T = 1000 \\ \\mathrm{K}$, $r(1000) = 0 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$.\n- At $T = 3000 \\ \\mathrm{K}$, $r(3000) = 0 \\ \\mathrm{J \\ kg^{-1} \\ K^{-1}}$.\n\nThe maximum absolute value of the residual over the set $\\{300, 1000, 3000\\}$ is therefore exactly $0$.\nThe problem requests the answer to be rounded to four significant figures. An exact value of zero can be represented in this format as $0.0000$.",
            "answer": "$$\\boxed{0.0000}$$"
        },
        {
            "introduction": "Building on the definition of temperature-dependent properties, we now explore the consequences for fundamental fluid processes. The isentropic relations are a cornerstone of compressible flow theory, but the familiar expressions like $p/\\rho^{\\gamma} = \\text{constant}$ are valid only for a constant ratio of specific heats, $\\gamma$. This practice challenges you to derive the more general differential form of the isentropic pressure-density relation for a thermally perfect gas, where $\\gamma(T)$ varies with temperature . This derivation reveals how the local speed of sound changes and illustrates the mathematical challenges that arise when integrating these new relations, providing a deeper understanding of high-enthalpy gas dynamics.",
            "id": "3946443",
            "problem": "In high-enthalpy compressible flows relevant to Computational Fluid Dynamics (CFD), ideal gases are often modeled as thermally perfect, meaning that the equation of state is $p=\\rho R T$ with a constant specific gas constant $R$, but the specific heats $c_{p}(T)$ and $c_{v}(T)$ depend on temperature $T$ and satisfy $c_{p}(T)-c_{v}(T)=R$. Consider a single-phase, non-reacting, calorically imperfect but thermally perfect ideal gas undergoing a reversible adiabatic (isentropic) process.\n\n1) Starting from the fundamental ideal-gas relations and the Gibbs equation for a simple compressible substance, derive the differential isentropic relation between the normalized pressure change $dp/p$ and the normalized density change $d\\rho/\\rho$. Identify explicitly the temperature-dependent factor multiplying $d\\rho/\\rho$ in terms of $c_{p}(T)$ and $c_{v}(T)$, and interpret it physically.\n\n2) To make the implications of temperature-dependent specific heats concrete, adopt the heat-capacity model $c_{p}(T)=c_{p,0}+\\alpha T$ with constants $c_{p,0}>R$ and $\\alpha \\ge 0$, so that $c_{v}(T)=c_{v,0}+\\alpha T$ with $c_{v,0}=c_{p,0}-R>0$. For an isentropic change from a reference state $\\left(T_{1},\\rho_{1},p_{1}\\right)$ to a second state with known density $\\rho_{2}$, obtain a closed-form analytic expression for the pressure ratio $p_{2}/p_{1}$ in terms of $\\rho_{2}/\\rho_{1}$, $T_{1}$, $c_{v,0}$, $R$, and $\\alpha$. You may express your answer using special functions if needed. Assume $T_{1}>0$ and $\\rho_{1},\\rho_{2}>0$. Express the final answer as a single closed-form expression without units.",
            "solution": "The problem is assessed as valid, as it is scientifically grounded in the principles of thermodynamics, well-posed, and uses unambiguous, standard terminology. The setup is complete and internally consistent.\n\nThe problem is divided into two parts. The first part requires the derivation of a differential relation for an isentropic process in a thermally perfect gas. The second part requires the integration of this relation for a specific model of heat capacity.\n\n**Part 1: Derivation of the Differential Isentropic Relation**\n\nWe begin with the Gibbs equation for a simple compressible substance, expressed in terms of the specific internal energy $u$, temperature $T$, specific entropy $s$, pressure $p$, and specific volume $v = 1/\\rho$:\n$$T ds = du + p dv$$\nFor an ideal gas, the specific internal energy is a function of temperature only, so its differential is given by $du = c_v(T) dT$, where $c_v(T)$ is the specific heat at constant volume. For the reversible adiabatic (isentropic) process specified, the change in specific entropy is zero, $ds = 0$.\n\nSubstituting $ds = 0$ and $du = c_v(T) dT$ into the Gibbs equation yields:\n$$0 = c_v(T) dT + p dv$$\nThe specific volume $v$ is the reciprocal of density $\\rho$, so $v = 1/\\rho$. The differential is $dv = -1/\\rho^2 d\\rho$. Substituting this gives:\n$$c_v(T) dT - \\frac{p}{\\rho^2} d\\rho = 0$$\nThis equation relates the change in temperature $dT$ to the change in density $d\\rho$. To find a relation between pressure and density, we must eliminate the temperature variable using the ideal gas equation of state, $p = \\rho R T$. Differentiating the equation of state gives:\n$$dp = R(T d\\rho + \\rho dT) \\implies \\rho R dT = dp - R T d\\rho$$\nSolving for $dT$:\n$$dT = \\frac{1}{\\rho R} (dp - R T d\\rho)$$\nLet's use an alternative path starting from $c_v(T) dT + p dv = 0$. We can use the differential of the ideal gas law in the form $pv=RT$, which is $p dv + v dp = R dT$. Therefore, $dT = (p dv + v dp)/R$.\nSubstituting this expression for $dT$ into the energy equation:\n$$c_v(T)\\left(\\frac{p dv + v dp}{R}\\right) + p dv = 0$$\nMultiplying by $R$ and collecting terms:\n$$c_v(T)(p dv + v dp) + R p dv = 0$$\n$$(c_v(T) + R) p dv + c_v(T) v dp = 0$$\nFor an ideal gas, Mayer's relation holds: $c_p(T) - c_v(T) = R$, which means $c_p(T) = c_v(T) + R$. Substituting this into the equation:\n$$c_p(T) p dv + c_v(T) v dp = 0$$\nDividing the entire equation by $p v$:\n$$c_p(T) \\frac{dv}{v} + c_v(T) \\frac{dp}{p} = 0$$\nSubstituting $v = 1/\\rho$, we get $dv/v = -d\\rho/\\rho$:\n$$-c_p(T) \\frac{d\\rho}{\\rho} + c_v(T) \\frac{dp}{p} = 0$$\nRearranging to the desired form gives the differential isentropic relation between the normalized pressure change and the normalized density change:\n$$\\frac{dp}{p} = \\frac{c_p(T)}{c_v(T)} \\frac{d\\rho}{\\rho}$$\nThe factor multiplying $d\\rho/\\rho$ is explicitly $\\frac{c_p(T)}{c_v(T)}$. This factor is the ratio of specific heats, denoted by $\\gamma(T)$:\n$$\\gamma(T) = \\frac{c_p(T)}{c_v(T)}$$\nFor a calorically imperfect gas, this ratio is temperature-dependent.\n\nPhysically, this relation is directly connected to the speed of sound, $a$. The square of the speed of sound is defined thermodynamically as the rate of change of pressure with density at constant entropy, $a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$. From our derived relation, we find $\\left(\\frac{dp}{d\\rho}\\right)_s = \\gamma(T) \\frac{p}{\\rho}$. Using the ideal gas law $p/\\rho=RT$, this becomes $\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s = \\gamma(T) R T$. Thus, $a^2 = \\gamma(T) R T$, and the factor $\\gamma(T)$ is crucial for determining the local speed of sound in the gas.\n\n**Part 2: Integration for the Specific Heat Model**\n\nTo find the pressure ratio $p_2/p_1$, we must integrate the isentropic relations. It is more convenient to integrate a relation between temperature and density first. Starting from the equation $c_v(T) dT - (p/\\rho^2) d\\rho = 0$ derived in Part 1, we substitute $p = \\rho R T$:\n$$c_v(T) dT - \\frac{\\rho R T}{\\rho^2} d\\rho = 0$$\n$$c_v(T) dT = R T \\frac{d\\rho}{\\rho}$$\nSeparating variables, we get:\n$$\\frac{c_v(T)}{T} dT = R \\frac{d\\rho}{\\rho}$$\nWe are given the specific heat model $c_v(T) = c_{v,0} + \\alpha T$, with constants $c_{v,0} > 0$ and $\\alpha \\ge 0$. Substituting this model into the differential equation:\n$$\\frac{c_{v,0} + \\alpha T}{T} dT = R \\frac{d\\rho}{\\rho}$$\n$$\\left(\\frac{c_{v,0}}{T} + \\alpha\\right) dT = R \\frac{d\\rho}{\\rho}$$\nWe integrate this equation from the initial state $(T_1, \\rho_1)$ to the final state $(T_2, \\rho_2)$:\n$$\\int_{T_1}^{T_2} \\left(\\frac{c_{v,0}}{T} + \\alpha\\right) dT = \\int_{\\rho_1}^{\\rho_2} R \\frac{d\\rho}{\\rho}$$\nPerforming the integration yields:\n$$\\left[c_{v,0} \\ln(T) + \\alpha T\\right]_{T_1}^{T_2} = \\left[R \\ln(\\rho)\\right]_{\\rho_1}^{\\rho_2}$$\n$$c_{v,0} (\\ln(T_2) - \\ln(T_1)) + \\alpha (T_2 - T_1) = R (\\ln(\\rho_2) - \\ln(\\rho_1))$$\n$$c_{v,0} \\ln\\left(\\frac{T_2}{T_1}\\right) + \\alpha (T_2 - T_1) = R \\ln\\left(\\frac{\\rho_2}{\\rho_1}\\right)$$\nThis is a transcendental equation for the final temperature $T_2$. To find an explicit expression for $T_2$, we assume $\\alpha > 0$. The case $\\alpha=0$ corresponds to a calorically perfect gas and can be recovered as a limit. We rearrange the equation to solve for $T_2$:\n$$c_{v,0} \\ln(T_2) + \\alpha T_2 = c_{v,0} \\ln(T_1) + \\alpha T_1 + R \\ln\\left(\\frac{\\rho_2}{\\rho_1}\\right)$$\nTo solve this, we use the Lambert W function, which is defined by the relation $z = W(z) \\exp(W(z))$. To cast our equation into this form, we divide by $c_{v,0}$:\n$$\\ln(T_2) + \\frac{\\alpha}{c_{v,0}} T_2 = \\ln(T_1) + \\frac{\\alpha}{c_{v,0}} T_1 + \\frac{R}{c_{v,0}} \\ln\\left(\\frac{\\rho_2}{\\rho_1}\\right)$$\nLet $x = (\\alpha/c_{v,0}) T_2$. Then $T_2 = (c_{v,0}/\\alpha) x$. Substituting this:\n$$\\ln\\left(\\frac{c_{v,0}}{\\alpha} x\\right) + x = \\ln(T_1) + \\frac{\\alpha T_1}{c_{v,0}} + \\frac{R}{c_{v,0}} \\ln\\left(\\frac{\\rho_2}{\\rho_1}\\right)$$\n$$\\ln(x) + x + \\ln\\left(\\frac{c_{v,0}}{\\alpha}\\right) = \\ln(T_1) + \\frac{\\alpha T_1}{c_{v,0}} + \\ln\\left(\\left(\\frac{\\rho_2}{\\rho_1}\\right)^{R/c_{v,0}}\\right)$$\n$$\\ln(x) + x = \\ln(T_1) - \\ln\\left(\\frac{c_{v,0}}{\\alpha}\\right) + \\frac{\\alpha T_1}{c_{v,0}} + \\ln\\left(\\left(\\frac{\\rho_2}{\\rho_1}\\right)^{R/c_{v,0}}\\right)$$\nExponentiating both sides:\n$$x \\exp(x) = \\exp\\left( \\ln\\left(\\frac{\\alpha T_1}{c_{v,0}}\\right) + \\frac{\\alpha T_1}{c_{v,0}} + \\ln\\left(\\left(\\frac{\\rho_2}{\\rho_1}\\right)^{R/c_{v,0}}\\right) \\right)$$\n$$x \\exp(x) = \\frac{\\alpha T_1}{c_{v,0}} \\exp\\left(\\frac{\\alpha T_1}{c_{v,0}}\\right) \\left(\\frac{\\rho_2}{\\rho_1}\\right)^{R/c_{v,0}}$$\nBy the definition of the Lambert W function, $x$ is given by:\n$$x = W\\left( \\frac{\\alpha T_1}{c_{v,0}} \\exp\\left(\\frac{\\alpha T_1}{c_{v,0}}\\right) \\left(\\frac{\\rho_2}{\\rho_1}\\right)^{R/c_{v,0}} \\right)$$\nSubstituting back $x = (\\alpha/c_{v,0}) T_2$:\n$$\\frac{\\alpha}{c_{v,0}} T_2 = W\\left( \\frac{\\alpha T_1}{c_{v,0}} \\exp\\left(\\frac{\\alpha T_1}{c_{v,0}}\\right) \\left(\\frac{\\rho_2}{\\rho_1}\\right)^{R/c_{v,0}} \\right)$$\nSolving for $T_2$:\n$$T_2 = \\frac{c_{v,0}}{\\alpha} W\\left( \\frac{\\alpha T_1}{c_{v,0}} \\exp\\left(\\frac{\\alpha T_1}{c_{v,0}}\\right) \\left(\\frac{\\rho_2}{\\rho_1}\\right)^{R/c_{v,0}} \\right)$$\nThe pressure ratio is given by the ideal gas law:\n$$\\frac{p_2}{p_1} = \\frac{\\rho_2 R T_2}{\\rho_1 R T_1} = \\frac{\\rho_2}{\\rho_1} \\frac{T_2}{T_1}$$\nSubstituting the expression for $T_2$:\n$$\\frac{p_2}{p_1} = \\frac{\\rho_2}{\\rho_1} \\frac{1}{T_1} \\left[ \\frac{c_{v,0}}{\\alpha} W\\left( \\frac{\\alpha T_1}{c_{v,0}} \\exp\\left(\\frac{\\alpha T_1}{c_{v,0}}\\right) \\left(\\frac{\\rho_2}{\\rho_1}\\right)^{R/c_{v,0}} \\right) \\right]$$\nThis is the final closed-form expression for the pressure ratio for $\\alpha > 0$. In the limit $\\alpha \\to 0$, this expression correctly reduces to the calorically perfect gas relation $p_2/p_1 = (\\rho_2/\\rho_1)^{1+R/c_{v,0}}$.",
            "answer": "$$\n\\boxed{\n\\frac{\\rho_2}{\\rho_1} \\frac{c_{v,0}}{\\alpha T_1} W\\left( \\frac{\\alpha T_1}{c_{v,0}} \\exp\\left(\\frac{\\alpha T_1}{c_{v,0}}\\right) \\left(\\frac{\\rho_2}{\\rho_1}\\right)^{\\frac{R}{c_{v,0}}} \\right)\n}\n$$"
        },
        {
            "introduction": "The theoretical differences between gas models ultimately translate into concrete algorithmic changes within a CFD solver. This final practice bridges theory and implementation by focusing on a critical step in modern finite volume methods: the conversion of conservative variables to primitive variables. You will implement the conversion for both calorically and thermally perfect gas models, discovering firsthand why the latter requires a numerical root-finding procedure to determine temperature from internal energy . This coding exercise highlights the practical computational trade-offs involved in selecting a higher-fidelity gas model for your simulations.",
            "id": "3946469",
            "problem": "You are tasked with implementing conservative-to-primitive variable conversion for the compressible Euler equations in Computational Fluid Dynamics (CFD) for an ideal gas, carefully distinguishing the calorically perfect gas model from the thermally perfect gas model. Begin from the foundational definitions and laws, without shortcuts.\n\nThe conservative variables are mass density $\\rho$, momentum density vector $\\mathbf{m} = (m_x, m_y, m_z)$, and total energy density $\\rho E$. The primitive variables are mass density $\\rho$, velocity vector $\\mathbf{u}$, pressure $p$, and temperature $T$. The ideal gas law relates pressure to density and temperature by $p = \\rho R T$, where $R$ is the specific gas constant.\n\nThe specific total energy $E$ (energy per unit mass) is the sum of specific internal energy $e(T)$ and specific kinetic energy. The specific internal energy is defined by the integral\n$$\ne(T) = \\int_{0}^{T} C_v(\\theta)\\, d\\theta,\n$$\nwhere $C_v(T)$ is the temperature-dependent specific heat at constant volume. In a calorically perfect gas, $C_v(T)$ is constant; in a thermally perfect gas, $C_v(T)$ varies with temperature. From first principles, recovering $T$ from $\\rho E$ requires: computing $\\mathbf{u}$ from momentum and density, computing the specific total energy $E = (\\rho E)/\\rho$, computing specific kinetic energy $\\frac{1}{2} |\\mathbf{u}|^2$, obtaining the specific internal energy $e = E - \\frac{1}{2} |\\mathbf{u}|^2$, and then inverting $e(T)$ to find $T$. For a calorically perfect gas, this inversion is algebraic. For a thermally perfect gas, this inversion is a one-dimensional root-finding problem due to the integral definition and the functional form of $C_v(T)$.\n\nYour program must implement both models:\n- Calorically perfect gas with constant $C_v(T) = \\bar{C}_v$.\n- Thermally perfect gas with $C_v(T) = a + b T + c T^2$, with $a$, $b$, $c$ given.\n\nFor all computations, use:\n- Specific gas constant $R = 287$ J/(kg·K).\n- Calorically perfect constant $\\bar{C}_v = 718$ J/(kg·K).\n- Thermally perfect coefficients $a = 700$ J/(kg·K), $b = 0.1$ J/(kg·K$^2$), $c = 10^{-4}$ J/(kg·K$^3$).\n\nYou must:\n1. Derive the temperature $T$ from the conservative variables by first principles as explained above, for both the calorically perfect and thermally perfect gas models.\n2. Use a robust bracketed root-finding method to invert $e(T)$ for the thermally perfect gas model. Monotonicity of $e(T)$ over physically relevant temperatures ensures a unique solution.\n3. Compute the corresponding pressure via $p = \\rho R T$ internally (no need to output it).\n\nPhysical units:\n- Report all temperatures in Kelvin (K).\n- All velocities are in meters per second (m/s).\n- All densities are in kilograms per cubic meter (kg/m$^3$).\n- All energies are in joules per cubic meter (J/m$^3$) for $\\rho E$ and joules per kilogram (J/kg) for specific energies.\n\nTest Suite:\nImplement your solution for the following five test cases, each case provided as $(\\rho, m_x, m_y, m_z, \\rho E)$ with units $(\\mathrm{kg/m^3}, \\mathrm{kg/(m^2\\cdot s)}, \\mathrm{kg/(m^2\\cdot s)}, \\mathrm{kg/(m^2\\cdot s)}, \\mathrm{J/m^3})$. These cases span a range of physical regimes:\n- Case $1$ (happy path, moderate speed, high temperature target under thermally perfect model): $(\\rho, m_x, m_y, m_z, \\rho E) = (1.0, 300.0, 0.0, 0.0, 828333.3333333334)$.\n- Case $2$ (near-boundary with low temperature, nonzero kinetic energy): $(\\rho, m_x, m_y, m_z, \\rho E) = (0.5, 50.0, 0.0, 0.0, 6002.516666666667)$.\n- Case $3$ (high internal energy, zero velocity): $(\\rho, m_x, m_y, m_z, \\rho E) = (1.2, 0.0, 0.0, 0.0, 2239999.9999999995)$.\n- Case $4$ (multi-dimensional velocity, moderate internal energy): $(\\rho, m_x, m_y, m_z, \\rho E) = (0.8, 160.0, 120.0, 40.0, 513253.3333333334)$.\n- Case $5$ (kinetic-energy-dominated regime, moderate temperature): $(\\rho, m_x, m_y, m_z, \\rho E) = (1.225, 1225.0, 0.0, 0.0, 876365.0)$.\n\nOutput specification:\n- For each test case, compute two temperatures: first under the calorically perfect model, then under the thermally perfect model.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, flattened in the order\n$$\n[T_{cp}^{(1)}, T_{tp}^{(1)}, T_{cp}^{(2)}, T_{tp}^{(2)}, T_{cp}^{(3)}, T_{tp}^{(3)}, T_{cp}^{(4)}, T_{tp}^{(4)}, T_{cp}^{(5)}, T_{tp}^{(5)}],\n$$\nwhere $T_{cp}^{(i)}$ denotes the calorically perfect temperature for case $i$, and $T_{tp}^{(i)}$ denotes the thermally perfect temperature for case $i$. Express each temperature in Kelvin, as real-valued floats.",
            "solution": "The problem statement has been rigorously validated and is determined to be sound. It is scientifically grounded in the principles of thermodynamics and fluid mechanics, well-posed with a unique and stable solution path, and specified with objective, unambiguous data and instructions. The task is to implement a conservative-to-primitive variable conversion for the compressible Euler equations, specifically to compute temperature $T$ from the conservative state vector $(\\rho, m_x, m_y, m_z, \\rho E)$ for an ideal gas under two different models for specific heat: calorically perfect and thermally perfect.\n\nThe procedure begins with the calculation of specific internal energy, $e$, which is model-independent. The conservative variables are mass density $\\rho$, the momentum density vector $\\mathbf{m} = (\\rho u_x, \\rho u_y, \\rho u_z)$, and the total energy per unit volume $\\rho E$.\n\nFirst, the velocity vector $\\mathbf{u} = (u_x, u_y, u_z)$ is recovered from the momentum density and mass density:\n$$\n\\mathbf{u} = \\frac{\\mathbf{m}}{\\rho}\n$$\nThe specific kinetic energy, $e_k$, which is the kinetic energy per unit mass, is then calculated as:\n$$\ne_k = \\frac{1}{2} |\\mathbf{u}|^2 = \\frac{1}{2} (u_x^2 + u_y^2 + u_z^2)\n$$\nThe specific total energy, $E$ (total energy per unit mass), is found by dividing the total energy density by the mass density:\n$$\nE = \\frac{\\rho E}{\\rho}\n$$\nThe specific total energy is the sum of specific internal energy $e$ and specific kinetic energy $e_k$. Therefore, we can isolate the specific internal energy:\n$$\ne = E - e_k\n$$\nThis value of $e$ represents the portion of the total energy associated with the thermal state of the gas. The final step, finding the temperature $T$ from $e$, depends on the gas model.\n\n**Model 1: Calorically Perfect Gas**\n\nIn a calorically perfect gas, the specific heat at constant volume, $C_v$, is assumed to be a constant, denoted as $\\bar{C}_v$. The problem specifies $\\bar{C}_v = 718 \\, \\text{J/(kg·K)}$. The specific internal energy is defined as $e(T) = \\int_{0}^{T} C_v(\\theta) \\, d\\theta$. For this model, the integral becomes:\n$$\ne(T) = \\int_{0}^{T} \\bar{C}_v \\, d\\theta = \\bar{C}_v T\n$$\nInverting this linear relationship to find the temperature $T_{cp}$ is a simple algebraic operation:\n$$\nT_{cp} = \\frac{e}{\\bar{C}_v}\n$$\n\n**Model 2: Thermally Perfect Gas**\n\nIn a thermally perfect gas, $C_v$ is a function of temperature, $C_v(T)$. The problem provides a quadratic model: $C_v(T) = a + b T + c T^2$, with given coefficients $a = 700 \\, \\text{J/(kg·K)}$, $b = 0.1 \\, \\text{J/(kg·K}^2\\text{)}$, and $c = 10^{-4} \\, \\text{J/(kg·K}^3\\text{)}$. The specific internal energy is found by integrating this expression:\n$$\ne(T) = \\int_{0}^{T} (a + b \\theta + c \\theta^2) \\, d\\theta = a T + \\frac{b}{2} T^2 + \\frac{c}{3} T^3\n$$\nTo find the temperature $T_{tp}$ from a known value of $e$, we must solve the following cubic equation for $T$:\n$$\na T + \\frac{b}{2} T^2 + \\frac{c}{3} T^3 - e = 0\n$$\nThis is a one-dimensional root-finding problem. We define a function $f(T) = (a T + \\frac{b}{2} T^2 + \\frac{c}{3} T^3) - e$. We seek the root $T$ such that $f(T)=0$. The derivative of $e(T)$ with respect to $T$ is $e'(T) = C_v(T)$. Since the coefficients $a, b, c$ are positive, $C_v(T)$ is strictly positive for any physical temperature $T > 0$. This ensures that $e(T)$ is a strictly monotonic function, guaranteeing a unique positive root for any $e > 0$. A robust bracketed root-finding method, such as the Brent-Dekker method, is ideal for this task. We establish a search bracket $[T_{min}, T_{max}]$ (e.g., $[1 \\, \\text{K}, 10000 \\, \\text{K}]$) that is certain to contain the root and over which the function changes sign.\n\nThe implementation will process each test case by first calculating the specific internal energy $e$, then applying the distinct inversion formula for the calorically perfect model and the numerical root-finding procedure for the thermally perfect model. The results for all test cases are then collected and formatted as specified.",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Computes temperature from conservative variables for calorically and thermally\n    perfect gas models.\n    \"\"\"\n    # Define physical and model constants\n    R = 287.0  # Specific gas constant in J/(kg·K)\n    Cv_cp = 718.0  # Specific heat for calorically perfect gas in J/(kg·K)\n    a_tp = 700.0  # Coefficient a for thermally perfect C_v in J/(kg·K)\n    b_tp = 0.1  # Coefficient b for thermally perfect C_v in J/(kg·K^2)\n    c_tp = 1e-4  # Coefficient c for thermally perfect C_v in J/(kg·K^3)\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (rho, m_x, m_y, m_z, rhoE)\n    test_cases = [\n        (1.0, 300.0, 0.0, 0.0, 828333.3333333334),\n        (0.5, 50.0, 0.0, 0.0, 6002.516666666667),\n        (1.2, 0.0, 0.0, 0.0, 2239999.9999999995),\n        (0.8, 160.0, 120.0, 40.0, 513253.3333333334),\n        (1.225, 1225.0, 0.0, 0.0, 876365.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        rho, mx, my, mz, rhoE = case\n\n        # Step 1: Compute velocity vector components\n        ux = mx / rho\n        uy = my / rho\n        uz = mz / rho\n\n        # Step 2: Compute specific kinetic energy (per unit mass)\n        e_kinetic = 0.5 * (ux**2 + uy**2 + uz**2)\n\n        # Step 3: Compute specific total energy (per unit mass)\n        E_total = rhoE / rho\n\n        # Step 4: Compute specific internal energy (per unit mass)\n        e_internal = E_total - e_kinetic\n        \n        # Guard against non-physical negative internal energy, though not expected here.\n        if e_internal = 0:\n            T_cp = 0.0\n            T_tp = 0.0\n        else:\n            # --- Calorically Perfect Gas Model ---\n            # Invert e = Cv_cp * T to find temperature\n            T_cp = e_internal / Cv_cp\n\n            # --- Thermally Perfect Gas Model ---\n            # Define the function whose root we need to find: f(T) = e(T) - e_internal\n            def f_tp(T, e_target):\n                \"\"\"\n                Represents the equation e(T) - e_target = 0 for the thermally perfect gas.\n                e(T) = a*T + (b/2)*T^2 + (c/3)*T^3\n                \"\"\"\n                return (a_tp * T + (b_tp / 2.0) * T**2 + (c_tp / 3.0) * T**3) - e_target\n\n            # Set a wide bracket for the root-finding algorithm to ensure robustness.\n            # Physical temperatures are in Kelvin, so T > 0.\n            T_min_bracket = 1.0\n            T_max_bracket = 10000.0\n\n            # Use SciPy's Brent's method for robust and fast root-finding.\n            # The function e(T) is monotonic for T>0, so a unique root is guaranteed\n            # if the bracket contains it.\n            try:\n                T_tp = optimize.brentq(f_tp, T_min_bracket, T_max_bracket, args=(e_internal,))\n            except ValueError:\n                # This error occurs if f(a) and f(b) have the same sign, meaning\n                # the root is not bracketed. This is not expected for the given problem.\n                T_tp = float('nan')\n\n        results.extend([T_cp, T_tp])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}