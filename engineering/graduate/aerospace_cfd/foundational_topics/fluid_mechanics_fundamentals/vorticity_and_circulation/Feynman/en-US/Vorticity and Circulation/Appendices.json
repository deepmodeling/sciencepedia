{
    "hands_on_practices": [
        {
            "introduction": "To truly understand fluid motion, we must look beyond simple translation and appreciate the local deformation and rotation of fluid elements. This first practice provides a rigorous, first-principles derivation that dissects a velocity field into its core components. By working through this problem , you will demonstrate mathematically why vorticity arises exclusively from the anti-symmetric part of the velocity gradient tensor (the spin tensor), while the symmetric part (the rate-of-strain tensor) describes deformation without contributing to local rotation.",
            "id": "4005202",
            "problem": "Consider a three-dimensional, steady velocity field in free space, representative of a local model often used in Computational Fluid Dynamics (CFD), defined by the superposition of a rigid-body rotation and a uniform pure shear, \n$$\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{\\Omega} \\times \\boldsymbol{x} + \\boldsymbol{S}\\,\\boldsymbol{x},$$ \nwhere $\\boldsymbol{x} = (x,y,z)$, $\\boldsymbol{\\Omega}$ is a constant angular-velocity vector, and $\\boldsymbol{S}$ is a constant, symmetric second-order tensor with zero trace (a uniform pure shear, i.e., a deviatoric rate-of-strain). Using only the fundamental definition of vorticity as the curl of velocity, $$\\boldsymbol{\\omega} = \\nabla \\times \\boldsymbol{u},$$ derive the vorticity field $\\boldsymbol{\\omega}(\\boldsymbol{x})$ and demonstrate, from first principles, which portion of the velocity gradient contributes to $\\boldsymbol{\\omega}$ and which portion does not. Your derivation must explicitly show the role of the symmetry of the velocity-gradient components. Express your final result for $\\boldsymbol{\\omega}(\\boldsymbol{x})$ in closed form. The final answer should be a single analytic expression (no numerical rounding is required).",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It provides a complete and consistent setup for a standard problem in fluid kinematics. The problem is valid.\n\nThe vorticity field $\\boldsymbol{\\omega}(\\boldsymbol{x})$ is defined as the curl of the velocity field $\\boldsymbol{u}(\\boldsymbol{x})$:\n$$\n\\boldsymbol{\\omega} = \\nabla \\times \\boldsymbol{u}\n$$\nThe given velocity field is a superposition of a rigid-body rotation and a uniform pure shear:\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{\\Omega} \\times \\boldsymbol{x} + \\boldsymbol{S}\\,\\boldsymbol{x}\n$$\nwhere $\\boldsymbol{\\Omega}$ is a constant angular-velocity vector and $\\boldsymbol{S}$ is a constant, symmetric, second-order tensor with zero trace.\n\nBy the linearity of the curl operator, we can analyze the two terms of the velocity field separately:\n$$\n\\boldsymbol{\\omega} = \\nabla \\times (\\boldsymbol{\\Omega} \\times \\boldsymbol{x}) + \\nabla \\times (\\boldsymbol{S}\\,\\boldsymbol{x})\n$$\nWe will now evaluate each term from first principles.\n\nFirst, consider the rigid-body rotation term, $\\boldsymbol{u}_{rot} = \\boldsymbol{\\Omega} \\times \\boldsymbol{x}$. We can compute its curl using the vector calculus identity for the curl of a cross product, $\\nabla \\times (\\boldsymbol{A} \\times \\boldsymbol{B}) = \\boldsymbol{A}(\\nabla \\cdot \\boldsymbol{B}) - \\boldsymbol{B}(\\nabla \\cdot \\boldsymbol{A}) + (\\boldsymbol{B} \\cdot \\nabla)\\boldsymbol{A} - (\\boldsymbol{A} \\cdot \\nabla)\\boldsymbol{B}$. Let $\\boldsymbol{A} = \\boldsymbol{\\Omega}$ and $\\boldsymbol{B} = \\boldsymbol{x}$.\n\nGiven that $\\boldsymbol{\\Omega}$ is a constant vector, its spatial derivatives are zero:\n$$\n\\nabla \\cdot \\boldsymbol{\\Omega} = 0\n$$\n$$\n(\\boldsymbol{x} \\cdot \\nabla)\\boldsymbol{\\Omega} = \\boldsymbol{0}\n$$\nThe derivatives of the position vector $\\boldsymbol{x}$ are:\nThe divergence of $\\boldsymbol{x}$:\n$$\n\\nabla \\cdot \\boldsymbol{x} = \\frac{\\partial x}{\\partial x} + \\frac{\\partial y}{\\partial y} + \\frac{\\partial z}{\\partial z} = 1 + 1 + 1 = 3\n$$\nThe directional derivative of $\\boldsymbol{x}$ along $\\boldsymbol{\\Omega}$:\n$$\n(\\boldsymbol{\\Omega} \\cdot \\nabla)\\boldsymbol{x} = \\left(\\Omega_x \\frac{\\partial}{\\partial x} + \\Omega_y \\frac{\\partial}{\\partial y} + \\Omega_z \\frac{\\partial}{\\partial z}\\right)(x\\hat{\\boldsymbol{e}}_x + y\\hat{\\boldsymbol{e}}_y + z\\hat{\\boldsymbol{e}}_z) = \\Omega_x \\hat{\\boldsymbol{e}}_x + \\Omega_y \\hat{\\boldsymbol{e}}_y + \\Omega_z \\hat{\\boldsymbol{e}}_z = \\boldsymbol{\\Omega}\n$$\nSubstituting these results into the vector identity:\n$$\n\\nabla \\times (\\boldsymbol{\\Omega} \\times \\boldsymbol{x}) = \\boldsymbol{\\Omega}(3) - \\boldsymbol{x}(0) + \\boldsymbol{0} - \\boldsymbol{\\Omega} = 3\\boldsymbol{\\Omega} - \\boldsymbol{\\Omega} = 2\\boldsymbol{\\Omega}\n$$\n\nSecond, consider the pure shear term, $\\boldsymbol{u}_{shear} = \\boldsymbol{S}\\,\\boldsymbol{x}$. We will compute its curl, $\\nabla \\times (\\boldsymbol{S}\\,\\boldsymbol{x})$, using indicial notation. Let $\\boldsymbol{v} = \\boldsymbol{S}\\,\\boldsymbol{x}$. The $k$-th component of $\\boldsymbol{v}$ is given by $v_k = S_{km} x_m$, where Einstein summation over the index $m$ is implied. The $i$-th component of the curl of $\\boldsymbol{v}$ is:\n$$\n(\\nabla \\times \\boldsymbol{v})_i = \\epsilon_{ijk} \\frac{\\partial v_k}{\\partial x_j}\n$$\nwhere $\\epsilon_{ijk}$ is the Levi-Civita symbol. The partial derivative term is the velocity gradient for the shear flow:\n$$\n\\frac{\\partial v_k}{\\partial x_j} = \\frac{\\partial}{\\partial x_j}(S_{km} x_m) = S_{km} \\frac{\\partial x_m}{\\partial x_j} = S_{km} \\delta_{jm} = S_{kj}\n$$\nHere, $\\delta_{jm}$ is the Kronecker delta. Substituting this back into the expression for the curl component:\n$$\n(\\nabla \\times \\boldsymbol{v})_i = \\epsilon_{ijk} S_{kj}\n$$\nThe problem states that the tensor $\\boldsymbol{S}$ is symmetric, meaning $S_{kj} = S_{jk}$. The Levi-Civita symbol $\\epsilon_{ijk}$ is anti-symmetric with respect to an interchange of any two of its indices, specifically $\\epsilon_{ijk} = -\\epsilon_{ikj}$. A contracted product of a symmetric tensor and an anti-symmetric tensor over their corresponding indices is identically zero. To demonstrate this explicitly, we can rename the dummy summation indices $j$ and $k$:\n$$\n(\\nabla \\times \\boldsymbol{v})_i = \\epsilon_{ijk} S_{kj} = \\epsilon_{ikj} S_{jk}\n$$\nUsing the anti-symmetric property of $\\epsilon_{ikj} = -\\epsilon_{ijk}$ and the symmetric property of $S_{jk} = S_{kj}$:\n$$\n(\\nabla \\times \\boldsymbol{v})_i = (-\\epsilon_{ijk}) (S_{kj}) = -(\\epsilon_{ijk} S_{kj}) = -(\\nabla \\times \\boldsymbol{v})_i\n$$\nThe only way a quantity can be equal to its own negative, $C_i = -C_i$, is if the quantity is zero, $C_i = 0$. This holds for all components $i=1, 2, 3$. Therefore, the curl of the pure shear velocity component is the zero vector:\n$$\n\\nabla \\times (\\boldsymbol{S}\\,\\boldsymbol{x}) = \\boldsymbol{0}\n$$\n\nThe analysis above demonstrates which portion of the velocity gradient contributes to vorticity. The velocity gradient tensor, with components $L_{ij} = \\partial u_i / \\partial x_j$, can always be decomposed into a symmetric part, the rate-of-strain tensor $\\boldsymbol{E}$, and an anti-symmetric part, the spin (or vorticity) tensor $\\boldsymbol{W}$:\n$$\nL_{ij} = E_{ij} + W_{ij} = \\frac{1}{2}\\left(\\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i}\\right) + \\frac{1}{2}\\left(\\frac{\\partial u_i}{\\partial x_j} - \\frac{\\partial u_j}{\\partial x_i}\\right)\n$$\nThe vorticity vector $\\boldsymbol{\\omega}$ is related to the anti-symmetric part of the velocity gradient. Its components are $\\omega_k = \\epsilon_{kji} L_{ij}$. When we substitute the decomposition, the term involving the symmetric tensor $\\boldsymbol{E}$ vanishes due to the contraction with the anti-symmetric tensor $\\epsilon_{kji}$, i.e., $\\epsilon_{kji} E_{ij} = 0$. Thus, only the anti-symmetric part $\\boldsymbol{W}$ contributes to vorticity.\n\nFor the given velocity field $\\boldsymbol{u} = \\boldsymbol{\\Omega} \\times \\boldsymbol{x} + \\boldsymbol{S}\\,\\boldsymbol{x}$, the gradient of the first term, $\\boldsymbol{\\Omega} \\times \\boldsymbol{x}$, is a purely anti-symmetric tensor, which constitutes the spin tensor $\\boldsymbol{W}$ for this flow. The gradient of the second term, $\\boldsymbol{S}\\,\\boldsymbol{x}$, is the symmetric tensor $\\boldsymbol{S}$, which constitutes the rate-of-strain tensor $\\boldsymbol{E}$. Our derivation confirmed this principle: the curl of the part associated with the anti-symmetric gradient ($\\boldsymbol{\\Omega} \\times \\boldsymbol{x}$) is non-zero, while the curl of the part associated with the symmetric gradient ($\\boldsymbol{S}\\,\\boldsymbol{x}$) is zero.\n\nCombining the results for the two terms, the total vorticity field is:\n$$\n\\boldsymbol{\\omega}(\\boldsymbol{x}) = \\nabla \\times (\\boldsymbol{\\Omega} \\times \\boldsymbol{x}) + \\nabla \\times (\\boldsymbol{S}\\,\\boldsymbol{x}) = 2\\boldsymbol{\\Omega} + \\boldsymbol{0} = 2\\boldsymbol{\\Omega}\n$$\nThe vorticity field is constant and is equal to twice the angular-velocity vector defining the rigid-body rotation.",
            "answer": "$$\\boxed{2\\boldsymbol{\\Omega}}$$"
        },
        {
            "introduction": "While Cartesian coordinates provide a clean framework for theory, aerospace engineering problems often involve cylindrical or spherical geometries, from engine nacelles to missile bodies. This exercise  challenges you to apply the definition of vorticity to a complex, three-dimensional flow field expressed in cylindrical coordinates. Mastering this calculation is crucial for correctly analyzing and interpreting swirl, boundary layer development, and secondary flows in practical CFD simulations.",
            "id": "4005209",
            "problem": "A steady, three-dimensional velocity field in a cylindrical duct is given in cylindrical coordinates $(r,\\theta,z)$ by the components $u_{r}(r,\\theta,z)$, $u_{\\theta}(r,\\theta,z)$, and $u_{z}(r,\\theta,z)$ as\n$$\nu_{r}(r,\\theta,z) = A\\,r\\,z\\,\\exp(-\\alpha r), \\quad\nu_{\\theta}(r,\\theta,z) = B\\,r\\,\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta), \\quad\nu_{z}(r,\\theta,z) = D\\left(1 - \\exp(-\\alpha r)\\right) + E\\,r\\,\\cos(\\theta),\n$$\nwhere $A$, $B$, $C$, $D$, $E$, and $\\alpha$ are positive constants, $r0$, $\\theta \\in [0,2\\pi)$, and $z \\in \\mathbb{R}$, and $\\theta$ is measured in radians. Starting from the fundamental definition of vorticity as the curl of the velocity field in an orthogonal curvilinear coordinate system and the metric scale factors appropriate to cylindrical coordinates, compute the vorticity vector $\\boldsymbol{\\omega}(r,\\theta,z)$ explicitly. Present your final expression for $\\boldsymbol{\\omega}$ as a row matrix $[\\omega_{r},\\,\\omega_{\\theta},\\,\\omega_{z}]$. In your derivation, interpret the physical meaning of each component in terms of swirl about the axis, axial variation along $z$, and radial gradients across $r$. The final answer must be a single analytical expression; do not include units in the final answer.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information to proceed with a solution. The velocity field is given in cylindrical coordinates $(r,\\theta,z)$ as $\\mathbf{u} = u_r \\hat{\\mathbf{e}}_r + u_\\theta \\hat{\\mathbf{e}}_\\theta + u_z \\hat{\\mathbf{e}}_z$, with components:\n$$ u_{r}(r,\\theta,z) = A\\,r\\,z\\,\\exp(-\\alpha r) $$\n$$ u_{\\theta}(r,\\theta,z) = B\\,r\\,\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta) $$\n$$ u_{z}(r,\\theta,z) = D\\left(1 - \\exp(-\\alpha r)\\right) + E\\,r\\,\\cos(\\theta) $$\nwhere $A$, $B$, $C$, $D$, $E$, and $\\alpha$ are positive constants.\n\nThe vorticity vector, $\\boldsymbol{\\omega}$, is defined as the curl of the velocity field, $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u}$. In an orthogonal curvilinear coordinate system $(q_1, q_2, q_3)$ with scale factors $(h_1, h_2, h_3)$, the curl operator is given by:\n$$ \\nabla \\times \\mathbf{u} = \\frac{1}{h_1 h_2 h_3} \\begin{vmatrix} h_1 \\hat{\\mathbf{e}}_1  h_2 \\hat{\\mathbf{e}}_2  h_3 \\hat{\\mathbf{e}}_3 \\\\ \\frac{\\partial}{\\partial q_1}  \\frac{\\partial}{\\partial q_2}  \\frac{\\partial}{\\partial q_3} \\\\ h_1 u_1  h_2 u_2  h_3 u_3 \\end{vmatrix} $$\nFor cylindrical coordinates, we have $(q_1, q_2, q_3) = (r, \\theta, z)$ and the scale factors are $h_r=1$, $h_\\theta=r$, and $h_z=1$. Substituting these into the general formula yields the specific expression for the curl in cylindrical coordinates:\n$$ \\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u} = \\frac{1}{r} \\begin{vmatrix} \\hat{\\mathbf{e}}_r  r \\hat{\\mathbf{e}}_\\theta  \\hat{\\mathbf{e}}_z \\\\ \\frac{\\partial}{\\partial r}  \\frac{\\partial}{\\partial \\theta}  \\frac{\\partial}{\\partial z} \\\\ u_r  r u_\\theta  u_z \\end{vmatrix} $$\nExpanding the determinant gives the components of the vorticity vector $\\boldsymbol{\\omega} = \\omega_r \\hat{\\mathbf{e}}_r + \\omega_\\theta \\hat{\\mathbf{e}}_\\theta + \\omega_z \\hat{\\mathbf{e}}_z$:\n$$ \\omega_r = \\frac{1}{r}\\frac{\\partial u_z}{\\partial \\theta} - \\frac{\\partial u_\\theta}{\\partial z} $$\n$$ \\omega_\\theta = \\frac{\\partial u_r}{\\partial z} - \\frac{\\partial u_z}{\\partial r} $$\n$$ \\omega_z = \\frac{1}{r}\\left(\\frac{\\partial (r u_\\theta)}{\\partial r} - \\frac{\\partial u_r}{\\partial \\theta}\\right) $$\nWe will now compute each component explicitly.\n\n**Radial Vorticity Component ($\\omega_r$)**\nThe radial component of vorticity, $\\omega_r$, represents the local rate of fluid rotation about the radial axis $\\hat{\\mathbf{e}}_r$. It arises from shear in the $\\theta-z$ plane. The term $\\frac{1}{r}\\frac{\\partial u_z}{\\partial \\theta}$ represents vorticity generated by the azimuthal variation of the axial velocity, while the term $\\frac{\\partial u_\\theta}{\\partial z}$ represents vorticity generated by the axial variation of the swirl velocity.\nFirst, we compute the required partial derivatives:\n$$ \\frac{\\partial u_z}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left[ D\\left(1 - \\exp(-\\alpha r)\\right) + E\\,r\\,\\cos(\\theta) \\right] = -E\\,r\\,\\sin(\\theta) $$\n$$ \\frac{\\partial u_\\theta}{\\partial z} = \\frac{\\partial}{\\partial z} \\left[ B\\,r\\,\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta) \\right] = C\\,\\sin(\\theta) $$\nSubstituting these into the formula for $\\omega_r$:\n$$ \\omega_r = \\frac{1}{r}(-E\\,r\\,\\sin(\\theta)) - C\\,\\sin(\\theta) = -E\\,\\sin(\\theta) - C\\,\\sin(\\theta) $$\n$$ \\omega_r = -(C+E)\\sin(\\theta) $$\nThis result shows that the radial vorticity is generated by the combined effects of the axial variation of the secondary swirl component (related to $C$) and the azimuthal variation of the non-axisymmetric axial flow component (related to $E$).\n\n**Azimuthal Vorticity Component ($\\omega_\\theta$)**\nThe azimuthal component of vorticity, $\\omega_\\theta$, represents the local rate of fluid rotation about the tangential axis $\\hat{\\mathbf{e}}_\\theta$. It is created by shear in the $r-z$ plane. The term $\\frac{\\partial u_r}{\\partial z}$ corresponds to vorticity from the axial variation of the radial velocity, while $\\frac{\\partial u_z}{\\partial r}$ corresponds to vorticity from the radial gradient of the axial velocity, a characteristic feature of shear layers and boundary layers in duct flow.\nWe compute the necessary partial derivatives:\n$$ \\frac{\\partial u_r}{\\partial z} = \\frac{\\partial}{\\partial z} \\left[ A\\,r\\,z\\,\\exp(-\\alpha r) \\right] = A\\,r\\,\\exp(-\\alpha r) $$\n$$ \\frac{\\partial u_z}{\\partial r} = \\frac{\\partial}{\\partial r} \\left[ D\\left(1 - \\exp(-\\alpha r)\\right) + E\\,r\\,\\cos(\\theta) \\right] = D(-\\exp(-\\alpha r) \\cdot (-\\alpha)) + E\\cos(\\theta) = \\alpha D \\exp(-\\alpha r) + E\\cos(\\theta) $$\nSubstituting these expressions into the formula for $\\omega_\\theta$:\n$$ \\omega_\\theta = A\\,r\\,\\exp(-\\alpha r) - \\left( \\alpha D \\exp(-\\alpha r) + E\\cos(\\theta) \\right) $$\n$$ \\omega_\\theta = (A\\,r - \\alpha D)\\exp(-\\alpha r) - E\\cos(\\theta) $$\nThe azimuthal vorticity is thus composed of an axisymmetric part, driven by the interaction of radial flow expansion/contraction along $z$ (term $A$) and the radial shear of the primary axial flow (term $D$), and a non-axisymmetric part due to the radial shear of the secondary axial flow (term $E$).\n\n**Axial Vorticity Component ($\\omega_z$)**\nThe axial component of vorticity, $\\omega_z$, signifies the local rate of fluid rotation about the duct's central axis $\\hat{\\mathbf{e}}_z$, often referred to as \"swirl.\" It is generated by shear in the $r-\\theta$ plane. The term $\\frac{1}{r}\\frac{\\partial (r u_\\theta)}{\\partial r}$ is the dominant term for swirl, representing the radial gradient of circulation. The term $\\frac{1}{r}\\frac{\\partial u_r}{\\partial \\theta}$ represents swirl generated by azimuthal variations in the radial flow.\nWe compute the final set of partial derivatives:\n$$ r u_\\theta = r(B\\,r\\,\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta)) = B\\,r^2\\,\\exp(-\\alpha r) + C\\,r\\,z\\,\\sin(\\theta) $$\n$$ \\frac{\\partial (r u_\\theta)}{\\partial r} = \\frac{\\partial}{\\partial r} \\left[ B\\,r^2\\,\\exp(-\\alpha r) + C\\,r\\,z\\,\\sin(\\theta) \\right] = B\\left(2r\\exp(-\\alpha r) - \\alpha r^2\\exp(-\\alpha r)\\right) + C\\,z\\,\\sin(\\theta) $$\n$$ \\frac{\\partial (r u_\\theta)}{\\partial r} = B\\,r(2 - \\alpha r)\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta) $$\nThe second required derivative is:\n$$ \\frac{\\partial u_r}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left[ A\\,r\\,z\\,\\exp(-\\alpha r) \\right] = 0 $$\nSubstituting these results into the formula for $\\omega_z$:\n$$ \\omega_z = \\frac{1}{r} \\left( B\\,r(2 - \\alpha r)\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta) - 0 \\right) $$\n$$ \\omega_z = B(2 - \\alpha r)\\exp(-\\alpha r) + \\frac{C\\,z\\,\\sin(\\theta)}{r} $$\nThe axial vorticity has two contributions. The term $B(2 - \\alpha r)\\exp(-\\alpha r)$ arises from the primary axisymmetric swirl velocity. Near the axis ($r \\to 0$), this approaches $2B$, consistent with the vorticity of a solid-body rotation where $u_\\theta \\approx Br$. The term $\\frac{C\\,z\\,\\sin(\\theta)}{r}$ arises from the secondary, non-axisymmetric swirl component and introduces a complex spatial variation, becoming significant away from the plane $\\theta=0, \\pi$.\n\n**Final Vorticity Vector**\nCombining the components, the vorticity vector $\\boldsymbol{\\omega}(r,\\theta,z)$ is:\n$$ \\boldsymbol{\\omega} = -(C+E)\\sin(\\theta)\\,\\hat{\\mathbf{e}}_r + \\left((A\\,r - \\alpha D)\\exp(-\\alpha r) - E\\cos(\\theta)\\right)\\,\\hat{\\mathbf{e}}_\\theta + \\left(B(2 - \\alpha r)\\exp(-\\alpha r) + \\frac{C\\,z\\,\\sin(\\theta)}{r}\\right)\\,\\hat{\\mathbf{e}}_z $$\nAs requested, the final expression for $\\boldsymbol{\\omega}$ presented as a row matrix $[\\omega_r, \\omega_\\theta, \\omega_z]$ is:\n$$ \\begin{pmatrix} -(C+E)\\sin(\\theta)  (Ar - \\alpha D) \\exp(-\\alpha r) - E \\cos(\\theta)  B(2 - \\alpha r)\\exp(-\\alpha r) + \\frac{C z \\sin(\\theta)}{r} \\end{pmatrix} $$",
            "answer": "$$ \\boxed{\\begin{pmatrix} -(C+E)\\sin(\\theta)  (Ar - \\alpha D)\\exp(-\\alpha r) - E\\cos(\\theta)  B(2 - \\alpha r)\\exp(-\\alpha r) + \\frac{Cz\\sin(\\theta)}{r} \\end{pmatrix}} $$"
        },
        {
            "introduction": "The principles of fluid dynamics are continuous, but their implementation in CFD is inherently discrete. A fundamental test of any numerical scheme is its ability to preserve the integral theorems of vector calculus. This final practice  is a direct dive into this verification process, where you will implement and test a discrete version of Stokes' theorem. This exercise demonstrates how the integral of local vorticity over an area is equivalent to the circulation around its boundary, a concept that forms the basis for many vortex methods and ensures the physical consistency of numerical solutions.",
            "id": "4005206",
            "problem": "You are given a uniform Cartesian grid representing a two-dimensional velocity field for Computational Fluid Dynamics in aerospace applications. The velocity field is sampled at cell centers. Your task is to construct a numerical procedure to evaluate circulation around a discrete closed loop and compare the result to a surface integral of vorticity using a discrete form of Stokes theorem. The problem must be implemented as a complete, runnable program that outputs the required comparison for the test suite described below.\n\nDefinitions and context to use:\n- The velocity field is $\\mathbf{v}(x,y) = (v_x(x,y), v_y(x,y))$ with $v_x$ and $v_y$ specified at cell centers.\n- The circulation around a closed curve $\\mathcal{C}$ is defined as $\\Gamma = \\oint_{\\mathcal{C}} \\mathbf{v} \\cdot d\\mathbf{l}$, with units of square meters per second (m$^2$/s).\n- In two dimensions, the out-of-plane vorticity is defined as $\\omega_z = \\frac{\\partial v_y}{\\partial x} - \\frac{\\partial v_x}{\\partial y}$, with units of inverse seconds (1/s).\n- Stokes' theorem states, for a smooth field, that $\\Gamma = \\iint_{\\mathcal{S}} \\omega_z \\, dS$, where $\\mathcal{S}$ is any surface bounded by $\\mathcal{C}$.\n\nGrid model and loop specification:\n- Use a uniform grid with $N_x$ cells in the $x$-direction and $N_y$ cells in the $y$-direction.\n- Cell centers are at coordinates $x_i = (i + \\tfrac{1}{2}) \\, \\Delta x$ for $i = 0,1,\\ldots,N_x-1$ and $y_j = (j + \\tfrac{1}{2}) \\, \\Delta y$ for $j = 0,1,\\ldots,N_y-1$, where $\\Delta x$ and $\\Delta y$ are the uniform cell widths in meters.\n- A rectangular loop is defined by the index ranges $i \\in [i_0,i_1]$ and $j \\in [j_0,j_1]$ for the interior cells enclosed by the loop. The loop path $\\mathcal{C}$ runs along the faces surrounding this block of cells, oriented counterclockwise.\n\nNumerical requirements:\n1. Construct a discrete line integral approximation for $\\Gamma$ along the rectangle boundary using only cell-centered velocities. For a horizontal edge segment, approximate the tangential velocity component $v_x$ at the edge midpoint by the arithmetic mean of the two adjacent cell-centered values, and multiply by the segment length $\\Delta x$. For a vertical edge segment, approximate the tangential velocity component $v_y$ at the edge midpoint by the arithmetic mean of the two adjacent cell-centered values, and multiply by the segment length $\\Delta y$. Respect the counterclockwise orientation when accumulating contributions, with the bottom and right edges added and the top and left edges subtracted.\n2. Construct a discrete surface integral approximation for $\\Gamma$ by first computing $\\omega_z$ at each interior cell center using second-order central differences from neighboring cell-centered velocities, namely approximate $\\frac{\\partial v_y}{\\partial x}$ by a centered difference in $x$ and $\\frac{\\partial v_x}{\\partial y}$ by a centered difference in $y$, and then sum $\\omega_z \\, \\Delta x \\, \\Delta y$ over all cells inside the loop.\n3. For each case in the test suite, compute the absolute difference $|\\Gamma_{\\text{line}} - \\Gamma_{\\text{surface}}|$. Express results in square meters per second (m$^2$/s) as decimal numbers.\n\nFlow fields:\n- For each test case, the continuous velocity field is specified analytically and must be sampled at cell centers:\n  - Solid-body rotation: $v_x(x,y) = -\\Omega \\, y$, $v_y(x,y) = \\Omega \\, x$, where $\\Omega$ is the angular speed in radians per second. The vorticity is spatially uniform with $\\omega_z = 2 \\Omega$.\n  - Uniform shear: $v_x(x,y) = S \\, y$, $v_y(x,y) = 0$, where $S$ is the shear rate in inverse seconds. The vorticity is spatially uniform with $\\omega_z = -S$.\n  - Uniform flow: $v_x(x,y) = U$, $v_y(x,y) = 0$, where $U$ is the free-stream speed in meters per second. The vorticity is $\\omega_z = 0$.\n\nTest suite:\nImplement the following test cases. All indices are zero-based. Ensure that loops are strictly interior so that all required neighbor cell values exist for centered differences and edge-averaging.\n\n- Case 1 (happy path, solid-body rotation): $N_x = 21$, $N_y = 17$, $\\Delta x = 0.1$ m, $\\Delta y = 0.1$ m, $\\Omega = 2.0$ s$^{-1}$, loop indices $i_0 = 5$, $i_1 = 8$, $j_0 = 6$, $j_1 = 8$.\n- Case 2 (moderate rectangle, uniform shear): $N_x = 16$, $N_y = 16$, $\\Delta x = 0.2$ m, $\\Delta y = 0.2$ m, $S = 3.0$ s$^{-1}$, loop indices $i_0 = 5$, $i_1 = 6$, $j_0 = 5$, $j_1 = 6$.\n- Case 3 (larger aspect ratio loop, uniform flow): $N_x = 20$, $N_y = 20$, $\\Delta x = 0.5$ m, $\\Delta y = 0.5$ m, $U = 15.0$ m/s, loop indices $i_0 = 8$, $i_1 = 10$, $j_0 = 7$, $j_1 = 11$.\n- Case 4 (edge case, smallest loop, solid-body rotation): $N_x = 15$, $N_y = 15$, $\\Delta x = 0.05$ m, $\\Delta y = 0.05$ m, $\\Omega = 1.5$ s$^{-1}$, loop indices $i_0 = 7$, $i_1 = 7$, $j_0 = 7$, $j_1 = 7$.\n\nFinal output format:\nYour program should produce a single line of output containing the absolute differences for the four test cases, in m$^2$/s, as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4]$, where each $r_k$ is a decimal number. No additional text should be printed.",
            "solution": "The task is to numerically verify a discrete version of Stokes' theorem for several two-dimensional velocity fields. Stokes' theorem relates the circulation $\\Gamma$ of a vector field $\\mathbf{v}$ around a closed curve $\\mathcal{C}$ to the surface integral of the curl of the field over the surface $\\mathcal{S}$ bounded by $\\mathcal{C}$. In two dimensions, this is expressed as:\n$$\n\\Gamma = \\oint_{\\mathcal{C}} \\mathbf{v} \\cdot d\\mathbf{l} = \\iint_{\\mathcal{S}} (\\nabla \\times \\mathbf{v}) \\cdot d\\mathbf{S} = \\iint_{\\mathcal{S}} \\omega_z \\, dS\n$$\nwhere $\\omega_z = \\frac{\\partial v_y}{\\partial x} - \\frac{\\partial v_x}{\\partial y}$ is the out-of-plane component of the vorticity. We will compute discrete approximations for the line integral, $\\Gamma_{\\text{line}}$, and the surface integral, $\\Gamma_{\\text{surface}}$, and then evaluate their absolute difference.\n\nFirst, we establish the computational grid. The domain is discretized into a uniform Cartesian grid of $N_x \\times N_y$ cells, with respective cell widths $\\Delta x$ and $\\Delta y$. The velocity components, $v_x(x,y)$ and $v_y(x,y)$, are sampled at the center of each cell $(i, j)$, where $i \\in \\{0, 1, \\dots, N_x-1\\}$ and $j \\in \\{0, 1, \\dots, N_y-1\\}$. The coordinates of a cell center are given by $x_i = (i + \\frac{1}{2})\\Delta x$ and $y_j = (j + \\frac{1}{2})\\Delta y$. The provided analytical velocity fields are used to populate two $N_y \\times N_x$ arrays representing the discrete fields $v_{x,i,j}$ and $v_{y,i,j}$.\n\nNext, we formulate the discrete line integral, $\\Gamma_{\\text{line}}$. The integration path $\\mathcal{C}$ is a counterclockwise rectangular loop that encloses the block of interior cells defined by index ranges $i \\in [i_0, i_1]$ and $j \\in [j_0, j_1]$. The path follows the faces of these cells. The integral is approximated by summing the contributions from the four segments of the loop:\n$$\n\\Gamma_{\\text{line}} \\approx \\sum_{\\text{bottom}} (\\mathbf{v} \\cdot d\\mathbf{l}) + \\sum_{\\text{right}} (\\mathbf{v} \\cdot d\\mathbf{l}) + \\sum_{\\text{top}} (\\mathbf{v} \\cdot d\\mathbf{l}) + \\sum_{\\text{left}} (\\mathbf{v} \\cdot d\\mathbf{l})\n$$\nFor each segment, the tangential velocity is approximated at the midpoint of each cell face by the arithmetic mean of the velocities in the two adjacent cell centers. The path increments are $\\Delta x \\mathbf{i}$ (bottom), $\\Delta y \\mathbf{j}$ (right), $-\\Delta x \\mathbf{i}$ (top), and $-\\Delta y \\mathbf{j}$ (left). This leads to the following sum:\n$$\n\\Gamma_{\\text{line}} = \\Delta x \\sum_{i=i_0}^{i_1} \\left(\\frac{v_{x,i,j_0-1} + v_{x,i,j_0}}{2}\\right) + \\Delta y \\sum_{j=j_0}^{j_1} \\left(\\frac{v_{y,i_1,j} + v_{y,i_1+1,j}}{2}\\right) - \\Delta x \\sum_{i=i_0}^{i_1} \\left(\\frac{v_{x,i,j_1} + v_{x,i,j_1+1}}{2}\\right) - \\Delta y \\sum_{j=j_0}^{j_1} \\left(\\frac{v_{y,i_0-1,j} + v_{y,i_0,j}}{2}\\right)\n$$\nThe condition that the loop is \"strictly interior\" ensures that all cell indices used in this formula (e.g., $j_0-1$, $j_1+1$, $i_0-1$, $i_1+1$) are within the grid bounds.\n\nThen, we formulate the discrete surface integral, $\\Gamma_{\\text{surface}}$. The surface $\\mathcal{S}$ is the area covered by the interior cells of the loop. The integral is approximated by summing the vorticity contribution from each cell, multiplied by the cell area $\\Delta x \\Delta y$:\n$$\n\\Gamma_{\\text{surface}} = \\sum_{j=j_0}^{j_1} \\sum_{i=i_0}^{i_1} \\omega_{z,i,j} \\Delta x \\Delta y\n$$\nThe vorticity $\\omega_{z,i,j}$ at the center of cell $(i,j)$ is computed using second-order accurate central difference approximations for the partial derivatives:\n$$\n\\omega_{z,i,j} \\approx \\left(\\frac{\\partial v_y}{\\partial x}\\right)\\bigg|_{i,j} - \\left(\\frac{\\partial v_x}{\\partial y}\\right)\\bigg|_{i,j} \\approx \\frac{v_{y,i+1,j} - v_{y,i-1,j}}{2 \\Delta x} - \\frac{v_{x,i,j+1} - v_{x,i,j-1}}{2 \\Delta y}\n$$\nThis calculation also relies on the loop being strictly interior to ensure that neighbor cells at $i\\pm1$ and $j\\pm1$ are available.\n\nAn important theoretical point is that for this specific choice of centered differencing for vorticity and edge-midpoint averaging for circulation, the discrete form of Stokes' theorem holds exactly. The summation of the discrete vorticity over the interior area can be shown to telescope, resulting in a sum over the boundary that is identical to the expression for the discrete line integral. Therefore, we expect the calculated difference $|\\Gamma_{\\text{line}} - \\Gamma_{\\text{surface}}|$ to be zero, or a very small number attributable to floating-point precision errors.\n\nThe implementation will proceed by defining a function that takes a test case's parameters, generates the grid and velocity fields, computes $\\Gamma_{\\text{line}}$ and $\\Gamma_{\\text{surface}}$ according to the formulae above, and returns their absolute difference. This process is repeated for each case in the test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: Solid-body rotation\n        {'flow_type': 'solid_body', 'Nx': 21, 'Ny': 17, 'dx': 0.1, 'dy': 0.1, 'params': {'Omega': 2.0}, 'i0': 5, 'i1': 8, 'j0': 6, 'j1': 8},\n        # Case 2: Uniform shear\n        {'flow_type': 'shear', 'Nx': 16, 'Ny': 16, 'dx': 0.2, 'dy': 0.2, 'params': {'S': 3.0}, 'i0': 5, 'i1': 6, 'j0': 5, 'j1': 6},\n        # Case 3: Uniform flow\n        {'flow_type': 'uniform', 'Nx': 20, 'Ny': 20, 'dx': 0.5, 'dy': 0.5, 'params': {'U': 15.0}, 'i0': 8, 'i1': 10, 'j0': 7, 'j1': 11},\n        # Case 4: Smallest loop, solid-body rotation\n        {'flow_type': 'solid_body', 'Nx': 15, 'Ny': 15, 'dx': 0.05, 'dy': 0.05, 'params': {'Omega': 1.5}, 'i0': 7, 'i1': 7, 'j0': 7, 'j1': 7},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_difference(case)\n        results.append(f\"{result:.15e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_difference(case_params):\n    \"\"\"\n    Calculates the absolute difference between line and surface integral approximations\n    of circulation for a single test case.\n    \"\"\"\n    # Unpack parameters\n    Nx, Ny = case_params['Nx'], case_params['Ny']\n    dx, dy = case_params['dx'], case_params['dy']\n    i0, i1 = case_params['i0'], case_params['i1']\n    j0, j1 = case_params['j0'], case_params['j1']\n    flow_type = case_params['flow_type']\n    params = case_params['params']\n    \n    # Generate grid coordinates for cell centers\n    x_coords = (np.arange(Nx) + 0.5) * dx\n    y_coords = (np.arange(Ny) + 0.5) * dy\n    Y, X = np.meshgrid(y_coords, x_coords, indexing='ij') # Y is (Ny, Nx), X is (Ny, Nx)\n    \n    # Generate velocity fields based on flow type\n    # Numpy arrays are indexed (row, col) which corresponds to (j, i)\n    vx = np.zeros((Ny, Nx))\n    vy = np.zeros((Ny, Nx))\n    \n    if flow_type == 'solid_body':\n        Omega = params['Omega']\n        vx = -Omega * Y\n        vy = Omega * X\n    elif flow_type == 'shear':\n        S = params['S']\n        vx = S * Y\n        vy = np.zeros_like(X)\n    elif flow_type == 'uniform':\n        U = params['U']\n        vx = np.full_like(X, U)\n        vy = np.zeros_like(X)\n\n    # 1. Calculate the discrete line integral Gamma_line\n    gamma_line = 0.0\n    \n    # Bottom edge (path in +x direction)\n    for i in range(i0, i1 + 1):\n        vel_x_avg = 0.5 * (vx[j0 - 1, i] + vx[j0, i])\n        gamma_line += vel_x_avg * dx\n        \n    # Right edge (path in +y direction)\n    for j in range(j0, j1 + 1):\n        vel_y_avg = 0.5 * (vy[j, i1] + vy[j, i1 + 1])\n        gamma_line += vel_y_avg * dy\n        \n    # Top edge (path in -x direction)\n    for i in range(i0, i1 + 1):\n        vel_x_avg = 0.5 * (vx[j1, i] + vx[j1 + 1, i])\n        gamma_line -= vel_x_avg * dx\n        \n    # Left edge (path in -y direction)\n    for j in range(j0, j1 + 1):\n        vel_y_avg = 0.5 * (vy[j, i0 - 1] + vy[j, i0])\n        gamma_line -= vel_y_avg * dy\n\n    # 2. Calculate the discrete surface integral Gamma_surface\n    gamma_surface = 0.0\n    cell_area = dx * dy\n    \n    for j in range(j0, j1 + 1):\n        for i in range(i0, i1 + 1):\n            # Second-order central differences for vorticity\n            dvy_dx = (vy[j, i + 1] - vy[j, i - 1]) / (2.0 * dx)\n            dvx_dy = (vx[j + 1, i] - vx[j - 1, i]) / (2.0 * dy)\n            omega_z = dvy_dx - dvx_dy\n            gamma_surface += omega_z * cell_area\n\n    # 3. Compute absolute difference\n    return abs(gamma_line - gamma_surface)\n\n# The following line is the entry point for the execution.\n# It should not be removed or commented out.\nsolve()\n```"
        }
    ]
}