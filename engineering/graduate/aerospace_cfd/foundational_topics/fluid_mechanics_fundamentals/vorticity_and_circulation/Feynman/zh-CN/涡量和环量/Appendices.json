{
    "hands_on_practices": [
        {
            "introduction": "流体运动可以被分解为平移、变形和旋转。涡量（vorticity）正是用来精确描述流体微团局部旋转的物理量。这个练习旨在通过一个结合了刚体旋转和纯剪切的理想速度场，帮助您从第一性原理出发 ，理解速度梯度张量中对称部分（应变率）和反对称部分（旋转）如何分别影响流体的运动，并最终揭示涡量与流体角速度之间的根本联系。",
            "id": "4005202",
            "problem": "考虑自由空间中的一个三维稳态速度场，它代表了计算流体动力学（CFD）中常用的局部模型，由刚体旋转和均匀纯剪切叠加定义：\n$$\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{\\Omega} \\times \\boldsymbol{x} + \\boldsymbol{S}\\,\\boldsymbol{x},$$\n其中 $\\boldsymbol{x} = (x,y,z)$，$\\boldsymbol{\\Omega}$ 是一个恒定的角速度矢量，$\\boldsymbol{S}$ 是一个恒定的、对称的、迹为零的二阶张量（一个均匀纯剪切，即偏应变率）。仅使用涡量作为速度旋度的基本定义：\n$$\\boldsymbol{\\omega} = \\nabla \\times \\boldsymbol{u},$$\n推导出涡量场 $\\boldsymbol{\\omega}(\\boldsymbol{x})$，并从第一性原理出发，证明速度梯度的哪一部分对 $\\boldsymbol{\\omega}$ 有贡献，哪一部分没有。您的推导必须明确显示速度梯度分量对称性的作用。将 $\\boldsymbol{\\omega}(\\boldsymbol{x})$ 的最终结果以闭合形式表示。最终答案应为单个解析表达式（无需进行数值取整）。",
            "solution": "该问题陈述经评估具有科学依据、形式适定且客观。它为流体运动学中的一个标准问题提供了一个完整且一致的设定。该问题是有效的。\n\n涡量场 $\\boldsymbol{\\omega}(\\boldsymbol{x})$ 定义为速度场 $\\boldsymbol{u}(\\boldsymbol{x})$ 的旋度：\n$$\n\\boldsymbol{\\omega} = \\nabla \\times \\boldsymbol{u}\n$$\n给定的速度场是刚体旋转和均匀纯剪切的叠加：\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{\\Omega} \\times \\boldsymbol{x} + \\boldsymbol{S}\\,\\boldsymbol{x}\n$$\n其中 $\\boldsymbol{\\Omega}$ 是一个恒定的角速度矢量，$\\boldsymbol{S}$ 是一个恒定的、对称的、迹为零的二阶张量。\n\n根据旋度算子的线性性质，我们可以分别分析速度场的两个项：\n$$\n\\boldsymbol{\\omega} = \\nabla \\times (\\boldsymbol{\\Omega} \\times \\boldsymbol{x}) + \\nabla \\times (\\boldsymbol{S}\\,\\boldsymbol{x})\n$$\n我们现在将从第一性原理出发计算每一项。\n\n首先，考虑刚体旋转项 $\\boldsymbol{u}_{rot} = \\boldsymbol{\\Omega} \\times \\boldsymbol{x}$。我们可以使用矢量叉积的旋度的矢量微积分恒等式来计算其旋度：$\\nabla \\times (\\boldsymbol{A} \\times \\boldsymbol{B}) = \\boldsymbol{A}(\\nabla \\cdot \\boldsymbol{B}) - \\boldsymbol{B}(\\nabla \\cdot \\boldsymbol{A}) + (\\boldsymbol{B} \\cdot \\nabla)\\boldsymbol{A} - (\\boldsymbol{A} \\cdot \\nabla)\\boldsymbol{B}$。令 $\\boldsymbol{A} = \\boldsymbol{\\Omega}$ 且 $\\boldsymbol{B} = \\boldsymbol{x}$。\n\n鉴于 $\\boldsymbol{\\Omega}$ 是一个恒定矢量，其空间导数为零：\n$$\n\\nabla \\cdot \\boldsymbol{\\Omega} = 0\n$$\n$$\n(\\boldsymbol{x} \\cdot \\nabla)\\boldsymbol{\\Omega} = \\boldsymbol{0}\n$$\n位置矢量 $\\boldsymbol{x}$ 的导数是：\n$\\boldsymbol{x}$ 的散度：\n$$\n\\nabla \\cdot \\boldsymbol{x} = \\frac{\\partial x}{\\partial x} + \\frac{\\partial y}{\\partial y} + \\frac{\\partial z}{\\partial z} = 1 + 1 + 1 = 3\n$$\n$\\boldsymbol{x}$ 沿 $\\boldsymbol{\\Omega}$ 方向的方向导数：\n$$\n(\\boldsymbol{\\Omega} \\cdot \\nabla)\\boldsymbol{x} = \\left(\\Omega_x \\frac{\\partial}{\\partial x} + \\Omega_y \\frac{\\partial}{\\partial y} + \\Omega_z \\frac{\\partial}{\\partial z}\\right)(x\\hat{\\boldsymbol{e}}_x + y\\hat{\\boldsymbol{e}}_y + z\\hat{\\boldsymbol{e}}_z) = \\Omega_x \\hat{\\boldsymbol{e}}_x + \\Omega_y \\hat{\\boldsymbol{e}}_y + \\Omega_z \\hat{\\boldsymbol{e}}_z = \\boldsymbol{\\Omega}\n$$\n将这些结果代入矢量恒等式：\n$$\n\\nabla \\times (\\boldsymbol{\\Omega} \\times \\boldsymbol{x}) = \\boldsymbol{\\Omega}(3) - \\boldsymbol{x}(0) + \\boldsymbol{0} - \\boldsymbol{\\Omega} = 3\\boldsymbol{\\Omega} - \\boldsymbol{\\Omega} = 2\\boldsymbol{\\Omega}\n$$\n\n其次，考虑纯剪切项 $\\boldsymbol{u}_{shear} = \\boldsymbol{S}\\,\\boldsymbol{x}$。我们将使用指数表示法计算其旋度 $\\nabla \\times (\\boldsymbol{S}\\,\\boldsymbol{x})$。令 $\\boldsymbol{v} = \\boldsymbol{S}\\,\\boldsymbol{x}$。$\\boldsymbol{v}$ 的第 $k$ 个分量由 $v_k = S_{km} x_m$ 给出，这里对重复指标 $m$ 应用了爱因斯坦求和约定。$\\boldsymbol{v}$ 的旋度的第 $i$ 个分量是：\n$$\n(\\nabla \\times \\boldsymbol{v})_i = \\epsilon_{ijk} \\frac{\\partial v_k}{\\partial x_j}\n$$\n其中 $\\epsilon_{ijk}$ 是列维-奇维塔符号。偏导数项是剪切流的速度梯度：\n$$\n\\frac{\\partial v_k}{\\partial x_j} = \\frac{\\partial}{\\partial x_j}(S_{km} x_m) = S_{km} \\frac{\\partial x_m}{\\partial x_j} = S_{km} \\delta_{jm} = S_{kj}\n$$\n这里，$\\delta_{jm}$ 是克罗内克 δ 符号。将此代回旋度分量的表达式中：\n$$\n(\\nabla \\times \\boldsymbol{v})_i = \\epsilon_{ijk} S_{kj}\n$$\n问题陈述指出张量 $\\boldsymbol{S}$ 是对称的，即 $S_{kj} = S_{jk}$。列维-奇维塔符号 $\\epsilon_{ijk}$ 对于其任意两个指标的交换是反对称的，具体来说是 $\\epsilon_{ijk} = -\\epsilon_{ikj}$。一个对称张量和一个反对称张量在其对应指标上的缩并积恒为零。为了明确地证明这一点，我们可以重命名哑求和指标 $j$ 和 $k$：\n$$\n(\\nabla \\times \\boldsymbol{v})_i = \\epsilon_{ijk} S_{kj} = \\epsilon_{ikj} S_{jk}\n$$\n利用 $\\epsilon_{ikj} = -\\epsilon_{ijk}$ 的反对称性质和 $S_{jk} = S_{kj}$ 的对称性质：\n$$\n(\\nabla \\times \\boldsymbol{v})_i = (-\\epsilon_{ijk}) (S_{kj}) = -(\\epsilon_{ijk} S_{kj}) = -(\\nabla \\times \\boldsymbol{v})_i\n$$\n一个量等于其自身的负值（$C_i = -C_i$）的唯一可能是该量为零（$C_i = 0$）。这对所有分量 $i=1, 2, 3$ 都成立。因此，纯剪切速度分量的旋度是零矢量：\n$$\n\\nabla \\times (\\boldsymbol{S}\\,\\boldsymbol{x}) = \\boldsymbol{0}\n$$\n\n上述分析证明了速度梯度的哪一部分对涡量有贡献。速度梯度张量，其分量为 $L_{ij} = \\partial u_i / \\partial x_j$，总可以分解为一个对称部分，即应变率张量 $\\boldsymbol{E}$，和一个反对称部分，即旋转（或涡量）张量 $\\boldsymbol{W}$：\n$$\nL_{ij} = E_{ij} + W_{ij} = \\frac{1}{2}\\left(\\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i}\\right) + \\frac{1}{2}\\left(\\frac{\\partial u_i}{\\partial x_j} - \\frac{\\partial u_j}{\\partial x_i}\\right)\n$$\n涡量矢量 $\\boldsymbol{\\omega}$ 与速度梯度的反对称部分有关。其分量为 $\\omega_k = \\epsilon_{kji} L_{ij}$。当我们代入分解式时，涉及对称张量 $\\boldsymbol{E}$ 的项因与反对称张量 $\\epsilon_{kji}$ 的缩并而消失，即 $\\epsilon_{kji} E_{ij} = 0$。因此，只有反对称部分 $\\boldsymbol{W}$ 对涡量有贡献。\n\n对于给定的速度场 $\\boldsymbol{u} = \\boldsymbol{\\Omega} \\times \\boldsymbol{x} + \\boldsymbol{S}\\,\\boldsymbol{x}$，第一项 $\\boldsymbol{\\Omega} \\times \\boldsymbol{x}$ 的梯度是一个纯反对称张量，构成了该流动的旋转张量 $\\boldsymbol{W}$。第二项 $\\boldsymbol{S}\\,\\boldsymbol{x}$ 的梯度是对称张量 $\\boldsymbol{S}$，构成了应变率张量 $\\boldsymbol{E}$。我们的推导证实了这一原理：与反对称梯度相关的部分（$\\boldsymbol{\\Omega} \\times \\boldsymbol{x}$）的旋度非零，而与对称梯度相关的部分（$\\boldsymbol{S}\\,\\boldsymbol{x}$）的旋度为零。\n\n结合这两项的结果，总涡量场为：\n$$\n\\boldsymbol{\\omega}(\\boldsymbol{x}) = \\nabla \\times (\\boldsymbol{\\Omega} \\times \\boldsymbol{x}) + \\nabla \\times (\\boldsymbol{S}\\,\\boldsymbol{x}) = 2\\boldsymbol{\\Omega} + \\boldsymbol{0} = 2\\boldsymbol{\\Omega}\n$$\n涡量场是恒定的，等于定义刚体旋转的角速度矢量的两倍。",
            "answer": "$$\\boxed{2\\boldsymbol{\\Omega}}$$"
        },
        {
            "introduction": "从抽象的笛卡尔坐标系转向更具体的工程应用，许多航空航天问题（如管道流、叶轮机械）都涉及圆柱坐标系。在这些非笛卡尔坐标系中正确计算和物理解释涡量向量的各个分量是一项至关重要的技能。此练习将引导您在一个复杂的三维圆柱坐标速度场中 ，系统地计算涡量的径向、周向和轴向分量，并深入理解它们各自的物理意义。",
            "id": "4005209",
            "problem": "一个圆柱形管道中的稳态三维速度场在柱坐标系 $(r,\\theta,z)$ 中由分量 $u_{r}(r,\\theta,z)$、$u_{\\theta}(r,\\theta,z)$ 和 $u_{z}(r,\\theta,z)$ 给出如下：\n$$\nu_{r}(r,\\theta,z) = A\\,r\\,z\\,\\exp(-\\alpha r), \\quad\nu_{\\theta}(r,\\theta,z) = B\\,r\\,\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta), \\quad\nu_{z}(r,\\theta,z) = D\\left(1 - \\exp(-\\alpha r)\\right) + E\\,r\\,\\cos(\\theta),\n$$\n其中 $A$、$B$、$C$、$D$、$E$ 和 $\\alpha$ 是正常数，$r0$，$\\theta \\in [0,2\\pi)$，$z \\in \\mathbb{R}$，且 $\\theta$ 以弧度为单位。从涡量的基本定义（即在正交曲线坐标系中速度场的旋度）以及适用于柱坐标系的度量尺度因子出发，显式地计算涡量矢量 $\\boldsymbol{\\omega}(r,\\theta,z)$。将您得到的 $\\boldsymbol{\\omega}$ 最终表达式表示为行矩阵 $[\\omega_{r},\\,\\omega_{\\theta},\\,\\omega_{z}]$。在您的推导过程中，请根据绕轴的涡旋、沿 $z$ 轴的轴向变化以及沿 $r$ 的径向梯度来解释每个分量的物理意义。最终答案必须是单个解析表达式；最终答案中不应包含单位。",
            "solution": "该问题提法明确，具有科学依据，并包含进行求解所需的所有信息。速度场在柱坐标系 $(r,\\theta,z)$ 中表示为 $\\mathbf{u} = u_r \\hat{\\mathbf{e}}_r + u_\\theta \\hat{\\mathbf{e}}_\\theta + u_z \\hat{\\mathbf{e}}_z$，其分量为：\n$$ u_{r}(r,\\theta,z) = A\\,r\\,z\\,\\exp(-\\alpha r) $$\n$$ u_{\\theta}(r,\\theta,z) = B\\,r\\,\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta) $$\n$$ u_{z}(r,\\theta,z) = D\\left(1 - \\exp(-\\alpha r)\\right) + E\\,r\\,\\cos(\\theta) $$\n其中 $A$、$B$、$C$、$D$、$E$ 和 $\\alpha$ 是正常数。\n\n涡量矢量 $\\boldsymbol{\\omega}$ 定义为速度场的旋度，即 $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u}$。在具有尺度因子 $(h_1, h_2, h_3)$ 的正交曲线坐标系 $(q_1, q_2, q_3)$ 中，旋度算子由以下公式给出：\n$$ \\nabla \\times \\mathbf{u} = \\frac{1}{h_1 h_2 h_3} \\begin{vmatrix} h_1 \\hat{\\mathbf{e}}_1  h_2 \\hat{\\mathbf{e}}_2  h_3 \\hat{\\mathbf{e}}_3 \\\\ \\frac{\\partial}{\\partial q_1}  \\frac{\\partial}{\\partial q_2}  \\frac{\\partial}{\\partial q_3} \\\\ h_1 u_1  h_2 u_2  h_3 u_3 \\end{vmatrix} $$\n对于柱坐标系，我们有 $(q_1, q_2, q_3) = (r, \\theta, z)$，尺度因子为 $h_r=1$、$h_\\theta=r$ 和 $h_z=1$。将这些代入通用公式，即可得到柱坐标系中旋度的具体表达式：\n$$ \\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u} = \\frac{1}{r} \\begin{vmatrix} \\hat{\\mathbf{e}}_r  r \\hat{\\mathbf{e}}_\\theta  \\hat{\\mathbf{e}}_z \\\\ \\frac{\\partial}{\\partial r}  \\frac{\\partial}{\\partial \\theta}  \\frac{\\partial}{\\partial z} \\\\ u_r  r u_\\theta  u_z \\end{vmatrix} $$\n展开行列式，得到涡量矢量 $\\boldsymbol{\\omega} = \\omega_r \\hat{\\mathbf{e}}_r + \\omega_\\theta \\hat{\\mathbf{e}}_\\theta + \\omega_z \\hat{\\mathbf{e}}_z$ 的各个分量：\n$$ \\omega_r = \\frac{1}{r}\\frac{\\partial u_z}{\\partial \\theta} - \\frac{\\partial u_\\theta}{\\partial z} $$\n$$ \\omega_\\theta = \\frac{\\partial u_r}{\\partial z} - \\frac{\\partial u_z}{\\partial r} $$\n$$ \\omega_z = \\frac{1}{r}\\left(\\frac{\\partial (r u_\\theta)}{\\partial r} - \\frac{\\partial u_r}{\\partial \\theta}\\right) $$\n我们现在将显式地计算每个分量。\n\n**径向涡量分量 ($\\omega_r$)**\n涡量的径向分量 $\\omega_r$ 表示流体微团绕径向轴 $\\hat{\\mathbf{e}}_r$ 的局部旋转速率。它由 $\\theta-z$ 平面内的剪切引起。项 $\\frac{1}{r}\\frac{\\partial u_z}{\\partial \\theta}$ 表示由轴向速度的方位角变化产生的涡量，而项 $\\frac{\\partial u_\\theta}{\\partial z}$ 表示由涡旋速度的轴向变化产生的涡量。\n首先，我们计算所需的偏导数：\n$$ \\frac{\\partial u_z}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left[ D\\left(1 - \\exp(-\\alpha r)\\right) + E\\,r\\,\\cos(\\theta) \\right] = -E\\,r\\,\\sin(\\theta) $$\n$$ \\frac{\\partial u_\\theta}{\\partial z} = \\frac{\\partial}{\\partial z} \\left[ B\\,r\\,\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta) \\right] = C\\,\\sin(\\theta) $$\n将这些代入 $\\omega_r$ 的公式中：\n$$ \\omega_r = \\frac{1}{r}(-E\\,r\\,\\sin(\\theta)) - C\\,\\sin(\\theta) = -E\\,\\sin(\\theta) - C\\,\\sin(\\theta) $$\n$$ \\omega_r = -(C+E)\\sin(\\theta) $$\n该结果表明，径向涡量是由次级涡旋分量的轴向变化（与 $C$ 相关）和非轴对称轴向流分量的方位角变化（与 $E$ 相关）的联合效应产生的。\n\n**方位角涡量分量 ($\\omega_\\theta$)**\n涡量的方位角分量 $\\omega_\\theta$ 表示流体微团绕切向轴 $\\hat{\\mathbf{e}}_\\theta$ 的局部旋转速率。它由 $r-z$ 平面内的剪切产生。项 $\\frac{\\partial u_r}{\\partial z}$ 对应于径向速度的轴向变化产生的涡量，而 $\\frac{\\partial u_z}{\\partial r}$ 对应于轴向速度的径向梯度产生的涡量，后者是管道流中剪切层和边界层的一个典型特征。\n我们计算必要的偏导数：\n$$ \\frac{\\partial u_r}{\\partial z} = \\frac{\\partial}{\\partial z} \\left[ A\\,r\\,z\\,\\exp(-\\alpha r) \\right] = A\\,r\\,\\exp(-\\alpha r) $$\n$$ \\frac{\\partial u_z}{\\partial r} = \\frac{\\partial}{\\partial r} \\left[ D\\left(1 - \\exp(-\\alpha r)\\right) + E\\,r\\,\\cos(\\theta) \\right] = D(-\\exp(-\\alpha r) \\cdot (-\\alpha)) + E\\cos(\\theta) = \\alpha D \\exp(-\\alpha r) + E\\cos(\\theta) $$\n将这些表达式代入 $\\omega_\\theta$ 的公式中：\n$$ \\omega_\\theta = A\\,r\\,\\exp(-\\alpha r) - \\left( \\alpha D \\exp(-\\alpha r) + E\\cos(\\theta) \\right) $$\n$$ \\omega_\\theta = (A\\,r - \\alpha D)\\exp(-\\alpha r) - E\\cos(\\theta) $$\n因此，方位角涡量由一个轴对称部分和一个非轴对称部分组成。轴对称部分由沿 $z$ 轴的径向流动的扩张/收缩（$A$ 项）与主轴向流的径向剪切（$D$ 项）之间的相互作用驱动；非轴对称部分则由次级轴向流的径向剪切（$E$ 项）引起。\n\n**轴向涡量分量 ($\\omega_z$)**\n涡量的轴向分量 $\\omega_z$ 表示流体微团绕管道中心轴 $\\hat{\\mathbf{e}}_z$ 的局部旋转速率，通常称为“涡旋”。它由 $r-\\theta$ 平面内的剪切产生。项 $\\frac{1}{r}\\frac{\\partial (r u_\\theta)}{\\partial r}$ 是产生涡旋的主导项，表示环量的径向梯度。项 $\\frac{1}{r}\\frac{\\partial u_r}{\\partial \\theta}$ 表示由径向流的方位角变化产生的涡旋。\n我们计算最后一组偏导数：\n$$ r u_\\theta = r(B\\,r\\,\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta)) = B\\,r^2\\,\\exp(-\\alpha r) + C\\,r\\,z\\,\\sin(\\theta) $$\n$$ \\frac{\\partial (r u_\\theta)}{\\partial r} = \\frac{\\partial}{\\partial r} \\left[ B\\,r^2\\,\\exp(-\\alpha r) + C\\,r\\,z\\,\\sin(\\theta) \\right] = B\\left(2r\\exp(-\\alpha r) - \\alpha r^2\\exp(-\\alpha r)\\right) + C\\,z\\,\\sin(\\theta) $$\n$$ \\frac{\\partial (r u_\\theta)}{\\partial r} = B\\,r(2 - \\alpha r)\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta) $$\n第二个所需的导数是：\n$$ \\frac{\\partial u_r}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left[ A\\,r\\,z\\,\\exp(-\\alpha r) \\right] = 0 $$\n将这些结果代入 $\\omega_z$ 的公式中：\n$$ \\omega_z = \\frac{1}{r} \\left( B\\,r(2 - \\alpha r)\\exp(-\\alpha r) + C\\,z\\,\\sin(\\theta) - 0 \\right) $$\n$$ \\omega_z = B(2 - \\alpha r)\\exp(-\\alpha r) + \\frac{C\\,z\\,\\sin(\\theta)}{r} $$\n轴向涡量有两个贡献来源。项 $B(2 - \\alpha r)\\exp(-\\alpha r)$ 来自主轴对称涡旋速度。在轴线附近 ($r \\to 0$)，该项趋近于 $2B$，这与 $u_\\theta \\approx Br$ 的刚体旋转的涡量一致。项 $\\frac{C\\,z\\,\\sin(\\theta)}{r}$ 来自次级非轴对称涡旋分量，并引入了复杂的空间变化，在远离平面 $\\theta=0, \\pi$ 时变得显著。\n\n**最终涡量矢量**\n结合各分量，涡量矢量 $\\boldsymbol{\\omega}(r,\\theta,z)$ 为：\n$$ \\boldsymbol{\\omega} = -(C+E)\\sin(\\theta)\\,\\hat{\\mathbf{e}}_r + \\left((A\\,r - \\alpha D)\\exp(-\\alpha r) - E\\cos(\\theta)\\right)\\,\\hat{\\mathbf{e}}_\\theta + \\left(B(2 - \\alpha r)\\exp(-\\alpha r) + \\frac{C\\,z\\,\\sin(\\theta)}{r}\\right)\\,\\hat{\\mathbf{e}}_z $$\n按照要求，$\\boldsymbol{\\omega}$ 的最终表达式以行矩阵 $[\\omega_r, \\omega_\\theta, \\omega_z]$ 的形式表示为：\n$$ \\begin{pmatrix} -(C+E)\\sin(\\theta)  (Ar - \\alpha D) \\exp(-\\alpha r) - E \\cos(\\theta)  B(2 - \\alpha r)\\exp(-\\alpha r) + \\frac{C z \\sin(\\theta)}{r} \\end{pmatrix} $$",
            "answer": "$$ \\boxed{\\begin{pmatrix} -(C+E)\\sin(\\theta)  (Ar - \\alpha D)\\exp(-\\alpha r) - E\\cos(\\theta)  B(2 - \\alpha r)\\exp(-\\alpha r) + \\frac{Cz\\sin(\\theta)}{r} \\end{pmatrix}} $$"
        },
        {
            "introduction": "在计算流体动力学（CFD）中，我们将描述流体运动的连续偏微分方程离散化为代数方程组进行求解。这一过程的有效性取决于离散格式能否忠实地反映原始的物理和数学定律。这个练习将带您动手实践 ，通过编写程序来验证离散形式的斯托克斯定理，即环量（circulation）的线积分如何精确地等于涡量（vorticity）的面积分，从而建立起对数值方法基本守恒性和准确性的直观理解和信任。",
            "id": "4005206",
            "problem": "给定一个均匀的笛卡尔网格，该网格代表了航空航天应用中计算流体动力学的一个二维速度场。速度场在单元中心进行采样。您的任务是构建一个数值程序，以评估围绕离散闭合回路的环量，并使用斯托克斯定理的离散形式将结果与涡量的面积分进行比较。该问题必须实现为一个完整的、可运行的程序，该程序能为下述测试套件输出所需比较结果。\n\n使用的定义和背景：\n- 速度场为 $\\mathbf{v}(x,y) = (v_x(x,y), v_y(x,y))$，其中 $v_x$ 和 $v_y$ 在单元中心处指定。\n- 围绕闭合曲线 $\\mathcal{C}$ 的环量定义为 $\\Gamma = \\oint_{\\mathcal{C}} \\mathbf{v} \\cdot d\\mathbf{l}$，单位为平方米/秒 (m$^2$/s)。\n- 在二维情况下，平面外涡量定义为 $\\omega_z = \\frac{\\partial v_y}{\\partial x} - \\frac{\\partial v_x}{\\partial y}$，单位为秒的倒数 (1/s)。\n- 斯托克斯定理指出，对于光滑场，$\\Gamma = \\iint_{\\mathcal{S}} \\omega_z \\, dS$，其中 $\\mathcal{S}$ 是由 $\\mathcal{C}$ 界定的任意曲面。\n\n网格模型和回路规范：\n- 使用一个在 $x$ 方向有 $N_x$ 个单元、在 $y$ 方向有 $N_y$ 个单元的均匀网格。\n- 单元中心的坐标为 $x_i = (i + \\tfrac{1}{2}) \\, \\Delta x$（其中 $i = 0,1,\\ldots,N_x-1$）和 $y_j = (j + \\tfrac{1}{2}) \\, \\Delta y$（其中 $j = 0,1,\\ldots,N_y-1$），$\\Delta x$ 和 $\\Delta y$ 是均匀的单元宽度，单位为米。\n- 一个矩形回路由其包围的内部单元的索引范围 $i \\in [i_0,i_1]$ 和 $j \\in [j_0,j_1]$ 定义。回路路径 $\\mathcal{C}$ 沿着这个单元块周围的面，方向为逆时针。\n\n数值要求：\n1. 仅使用单元中心的速度，构建沿矩形边界的 $\\Gamma$ 的离散线积分近似。对于水平边段，通过两个相邻单元中心值的算术平均值来近似边中点处的切向速度分量 $v_x$，然后乘以边段长度 $\\Delta x$。对于垂直边段，通过两个相邻单元中心值的算术平均值来近似边中点处的切向速度分量 $v_y$，然后乘以边段长度 $\\Delta y$。在累加贡献时，请遵循逆时针方向，即底边和右边的贡献为正，顶边和左边的贡献为负。\n2. 构建 $\\Gamma$ 的离散面积分近似。首先使用相邻单元中心速度的二阶中心差分计算每个内部单元中心的 $\\omega_z$，即用 $x$ 方向的中心差分近似 $\\frac{\\partial v_y}{\\partial x}$，用 $y$ 方向的中心差分近似 $\\frac{\\partial v_x}{\\partial y}$，然后对回路内的所有单元求和 $\\omega_z \\, \\Delta x \\, \\Delta y$。\n3. 对于测试套件中的每个案例，计算绝对差 $|\\Gamma_{\\text{line}} - \\Gamma_{\\text{surface}}|$。结果以十进制数表示，单位为平方米/秒 (m$^2$/s)。\n\n流场：\n- 对于每个测试案例，连续速度场由解析式指定，且必须在单元中心进行采样：\n  - 刚体旋转：$v_x(x,y) = -\\Omega \\, y$, $v_y(x,y) = \\Omega \\, x$，其中 $\\Omega$ 是角速度，单位为弧度/秒。涡量在空间上是均匀的，为 $\\omega_z = 2 \\Omega$。\n  - 均匀剪切：$v_x(x,y) = S \\, y$, $v_y(x,y) = 0$，其中 $S$ 是剪切率，单位为秒的倒数。涡量在空间上是均匀的，为 $\\omega_z = -S$。\n  - 均匀流：$v_x(x,y) = U$, $v_y(x,y) = 0$，其中 $U$ 是自由流速度，单位为米/秒。涡量为 $\\omega_z = 0$。\n\n测试套件：\n实现以下测试案例。所有索引均为从零开始。确保回路严格位于内部，以便中心差分和边值平均所需的所有相邻单元值都存在。\n\n- 案例 1 (正常路径，刚体旋转)：$N_x = 21$, $N_y = 17$, $\\Delta x = 0.1$ m, $\\Delta y = 0.1$ m, $\\Omega = 2.0$ s$^{-1}$，回路索引 $i_0 = 5$, $i_1 = 8$, $j_0 = 6$, $j_1 = 8$。\n- 案例 2 (中等矩形，均匀剪切)：$N_x = 16$, $N_y = 16$, $\\Delta x = 0.2$ m, $\\Delta y = 0.2$ m, $S = 3.0$ s$^{-1}$，回路索引 $i_0 = 5$, $i_1 = 6$, $j_0 = 5$, $j_1 = 6$。\n- 案例 3 (大纵横比回路，均匀流)：$N_x = 20$, $N_y = 20$, $\\Delta x = 0.5$ m, $\\Delta y = 0.5$ m, $U = 15.0$ m/s，回路索引 $i_0 = 8$, $i_1 = 10$, $j_0 = 7$, $j_1 = 11$。\n- 案例 4 (边界情况，最小回路，刚体旋转)：$N_x = 15$, $N_y = 15$, $\\Delta x = 0.05$ m, $\\Delta y = 0.05$ m, $\\Omega = 1.5$ s$^{-1}$，回路索引 $i_0 = 7$, $i_1 = 7$, $j_0 = 7$, $j_1 = 7$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个测试案例的绝对差，单位为 m$^2$/s，形式为用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4]$，其中每个 $r_k$ 是一个十进制数。不应打印任何其他文本。",
            "solution": "任务是针对几个二维速度场，数值验证斯托克斯定理的离散版本。斯托克斯定理将矢量场 $\\mathbf{v}$ 围绕闭合曲线 $\\mathcal{C}$ 的环量 $\\Gamma$ 与该场在由 $\\mathcal{C}$ 界定的曲面 $\\mathcal{S}$ 上的旋度的面积分联系起来。在二维中，这表示为：\n$$\n\\Gamma = \\oint_{\\mathcal{C}} \\mathbf{v} \\cdot d\\mathbf{l} = \\iint_{\\mathcal{S}} (\\nabla \\times \\mathbf{v}) \\cdot d\\mathbf{S} = \\iint_{\\mathcal{S}} \\omega_z \\, dS\n$$\n其中 $\\omega_z = \\frac{\\partial v_y}{\\partial x} - \\frac{\\partial v_x}{\\partial y}$ 是涡量的平面外分量。我们将计算线积分 $\\Gamma_{\\text{line}}$ 和面积分 $\\Gamma_{\\text{surface}}$ 的离散近似，然后评估它们的绝对差。\n\n首先，我们建立计算网格。该域被离散化为 $N_x \\times N_y$ 个单元的均匀笛卡尔网格，相应的单元宽度为 $\\Delta x$ 和 $\\Delta y$。速度分量 $v_x(x,y)$ 和 $v_y(x,y)$ 在每个单元 $(i, j)$ 的中心进行采样，其中 $i \\in \\{0, 1, \\dots, N_x-1\\}$，$j \\in \\{0, 1, \\dots, N_y-1\\}$。单元中心的坐标由 $x_i = (i + \\frac{1}{2})\\Delta x$ 和 $y_j = (j + \\frac{1}{2})\\Delta y$ 给出。所提供的解析速度场用于填充两个 $N_y \\times N_x$ 数组，以表示离散场 $v_{x,i,j}$ 和 $v_{y,i,j}$。\n\n接下来，我们构建离散线积分 $\\Gamma_{\\text{line}}$。积分路径 $\\mathcal{C}$ 是一个逆时针方向的矩形回路，它包围了由索引范围 $i \\in [i_0, i_1]$ 和 $j \\in [j_0, j_1]$ 定义的内部单元块。路径沿着这些单元的面。该积分通过对回路四个段的贡献求和来近似：\n$$\n\\Gamma_{\\text{line}} \\approx \\sum_{\\text{bottom}} (\\mathbf{v} \\cdot d\\mathbf{l}) + \\sum_{\\text{right}} (\\mathbf{v} \\cdot d\\mathbf{l}) + \\sum_{\\text{top}} (\\mathbf{v} \\cdot d\\mathbf{l}) + \\sum_{\\text{left}} (\\mathbf{v} \\cdot d\\mathbf{l})\n$$\n对于每个段，每个单元面中点的切向速度由两个相邻单元中心速度的算术平均值来近似。路径增量为 $\\Delta x \\mathbf{i}$（底边）、$\\Delta y \\mathbf{j}$（右边）、$-\\Delta x \\mathbf{i}$（顶边）和 $-\\Delta y \\mathbf{j}$（左边）。这导致以下求和式：\n$$\n\\Gamma_{\\text{line}} = \\Delta x \\sum_{i=i_0}^{i_1} \\left(\\frac{v_{x,i,j_0-1} + v_{x,i,j_0}}{2}\\right) + \\Delta y \\sum_{j=j_0}^{j_1} \\left(\\frac{v_{y,i_1,j} + v_{y,i_1+1,j}}{2}\\right) - \\Delta x \\sum_{i=i_0}^{i_1} \\left(\\frac{v_{x,i,j_1} + v_{x,i,j_1+1}}{2}\\right) - \\Delta y \\sum_{j=j_0}^{j_1} \\left(\\frac{v_{y,i_0-1,j} + v_{y,i_0,j}}{2}\\right)\n$$\n“回路严格位于内部”的条件确保了此公式中使用的所有单元索引（例如，$j_0-1$、$j_1+1$、$i_0-1$、$i_1+1$）都在网格边界内。\n\n然后，我们构建离散面积分 $\\Gamma_{\\text{surface}}$。曲面 $\\mathcal{S}$ 是回路由内部单元所覆盖的区域。该积分通过将每个单元的涡量贡献乘以单元面积 $\\Delta x \\Delta y$ 后求和来近似：\n$$\n\\Gamma_{\\text{surface}} = \\sum_{j=j_0}^{j_1} \\sum_{i=i_0}^{i_1} \\omega_{z,i,j} \\Delta x \\Delta y\n$$\n单元 $(i,j)$ 中心的涡量 $\\omega_{z,i,j}$ 使用偏导数的二阶精度中心差分近似来计算：\n$$\n\\omega_{z,i,j} \\approx \\left(\\frac{\\partial v_y}{\\partial x}\\right)\\bigg|_{i,j} - \\left(\\frac{\\partial v_x}{\\partial y}\\right)\\bigg|_{i,j} \\approx \\frac{v_{y,i+1,j} - v_{y,i-1,j}}{2 \\Delta x} - \\frac{v_{x,i,j+1} - v_{x,i,j-1}}{2 \\Delta y}\n$$\n此计算同样依赖于回路严格位于内部，以确保在 $i\\pm1$ 和 $j\\pm1$ 处的相邻单元可用。\n\n一个重要的理论要点是，对于这种为涡量选择中心差分和为环量选择边中点平均的特定方法，斯托克斯定理的离散形式是精确成立的。可以证明，内部区域上离散涡量的求和会产生伸缩求和效应，其结果是边界上的一个求和，该求和与离散线积分的表达式完全相同。因此，我们预计计算出的差值 $|\\Gamma_{\\text{line}} - \\Gamma_{\\text{surface}}|$ 将为零，或是一个可归因于浮点精度误差的非常小的数。\n\n实现过程将通过定义一个函数来完成，该函数接收一个测试案例的参数，生成网格和速度场，根据上述公式计算 $\\Gamma_{\\text{line}}$ 和 $\\Gamma_{\\text{surface}}$，并返回它们的绝对差。对测试套件中的每个案例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # Case 1: Solid-body rotation\n        {'flow_type': 'solid_body', 'Nx': 21, 'Ny': 17, 'dx': 0.1, 'dy': 0.1, 'params': {'Omega': 2.0}, 'i0': 5, 'i1': 8, 'j0': 6, 'j1': 8},\n        # Case 2: Uniform shear\n        {'flow_type': 'shear', 'Nx': 16, 'Ny': 16, 'dx': 0.2, 'dy': 0.2, 'params': {'S': 3.0}, 'i0': 5, 'i1': 6, 'j0': 5, 'j1': 6},\n        # Case 3: Uniform flow\n        {'flow_type': 'uniform', 'Nx': 20, 'Ny': 20, 'dx': 0.5, 'dy': 0.5, 'params': {'U': 15.0}, 'i0': 8, 'i1': 10, 'j0': 7, 'j1': 11},\n        # Case 4: Smallest loop, solid-body rotation\n        {'flow_type': 'solid_body', 'Nx': 15, 'Ny': 15, 'dx': 0.05, 'dy': 0.05, 'params': {'Omega': 1.5}, 'i0': 7, 'i1': 7, 'j0': 7, 'j1': 7},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_difference(case)\n        results.append(f\"{result:.15e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_difference(case_params):\n    \"\"\"\n    Calculates the absolute difference between line and surface integral approximations\n    of circulation for a single test case.\n    \"\"\"\n    # Unpack parameters\n    Nx, Ny = case_params['Nx'], case_params['Ny']\n    dx, dy = case_params['dx'], case_params['dy']\n    i0, i1 = case_params['i0'], case_params['i1']\n    j0, j1 = case_params['j0'], case_params['j1']\n    flow_type = case_params['flow_type']\n    params = case_params['params']\n    \n    # Generate grid coordinates for cell centers\n    x_coords = (np.arange(Nx) + 0.5) * dx\n    y_coords = (np.arange(Ny) + 0.5) * dy\n    X, Y = np.meshgrid(x_coords, y_coords, indexing='xy') # X is (Nx, Ny) in shape, let's transpose\n    X = X.T # Now X and Y are (Ny, Nx)\n    Y = Y.T\n    \n    # Generate velocity fields based on flow type\n    # Numpy arrays are indexed (row, col) which corresponds to (j, i)\n    vx = np.zeros((Ny, Nx))\n    vy = np.zeros((Ny, Nx))\n    \n    if flow_type == 'solid_body':\n        Omega = params['Omega']\n        vx = -Omega * Y\n        vy = Omega * X\n    elif flow_type == 'shear':\n        S = params['S']\n        vx = S * Y\n        vy = np.zeros_like(X)\n    elif flow_type == 'uniform':\n        U = params['U']\n        vx = np.full_like(X, U)\n        vy = np.zeros_like(X)\n\n    # 1. Calculate the discrete line integral Gamma_line\n    gamma_line = 0.0\n    \n    # Bottom edge (path in +x direction)\n    for i in range(i0, i1 + 1):\n        vel_x_avg = 0.5 * (vx[j0 - 1, i] + vx[j0, i])\n        gamma_line += vel_x_avg * dx\n        \n    # Right edge (path in +y direction)\n    for j in range(j0, j1 + 1):\n        vel_y_avg = 0.5 * (vy[j, i1] + vy[j, i1 + 1])\n        gamma_line += vel_y_avg * dy\n        \n    # Top edge (path in -x direction)\n    for i in range(i0, i1 + 1):\n        vel_x_avg = 0.5 * (vx[j1, i] + vx[j1 + 1, i])\n        gamma_line -= vel_x_avg * dx\n        \n    # Left edge (path in -y direction)\n    for j in range(j0, j1 + 1):\n        vel_y_avg = 0.5 * (vy[j, i0 - 1] + vy[j, i0])\n        gamma_line -= vel_y_avg * dy\n\n    # 2. Calculate the discrete surface integral Gamma_surface\n    gamma_surface = 0.0\n    cell_area = dx * dy\n    \n    for j in range(j0, j1 + 1):\n        for i in range(i0, i1 + 1):\n            # Second-order central differences for vorticity\n            dvy_dx = (vy[j, i + 1] - vy[j, i - 1]) / (2.0 * dx)\n            dvx_dy = (vx[j + 1, i] - vx[j - 1, i]) / (2.0 * dy)\n            omega_z = dvy_dx - dvx_dy\n            gamma_surface += omega_z * cell_area\n\n    # 3. Compute absolute difference\n    return abs(gamma_line - gamma_surface)\n\nsolve()\n```"
        }
    ]
}