{
    "hands_on_practices": [
        {
            "introduction": "从欧拉描述过渡到拉格朗日描述是流体运动学中的一项基本技能。这个练习提供了一个经典的旋转流场，并要求你追踪一个流体质点的运动轨迹。通过求解质点运动的常微分方程，你将能够亲手推导出拉格朗日路径，从而深刻理解如何从一个固定的速度分布图（欧拉视场）预测单个质点随时间的运动历史（拉格朗日路径）。",
            "id": "1769254",
            "problem": "在一个微流控设备中，建立了一个稳定的二维流体流动以产生一个微型涡旋。该流场在$xy$平面上的欧拉速度场由$\\mathbf{v}(x, y) = -\\Omega y \\hat{i} + \\Omega x \\hat{j}$给出，其中$\\Omega$是一个正常数，代表流体类似刚体旋转的角频率，$\\hat{i}$和$\\hat{j}$分别是$x$和$y$方向上的单位矢量。一个小的、中性悬浮的粒子被释放到该流场中，并被假设为被动示踪剂，这意味着其速度始终与当地流体速度相同。在时间$t=0$时，粒子位于初始位置$(x_0, y_0) = (L, 0)$，其中$L$是一个正常数。\n\n确定该粒子的拉格朗日位置，由其坐标$(x(t), y(t))$表示，对于任意时间$t \\geq 0$。将答案表示为用$L$、$\\Omega$和$t$表示的$x(t)$和$y(t)$的函数对。",
            "solution": "因为该粒子是被动示踪剂，其速度等于当地流体速度。因此，其拉格朗日坐标满足方程组\n$$\\frac{dx}{dt}=-\\Omega y,\\qquad \\frac{dy}{dt}=\\Omega x,$$\n初始条件为$x(0)=L$和$y(0)=0$。\n\n将第一个方程对$t$求导，并用第二个方程消去$y$：\n$$\\frac{d^{2}x}{dt^{2}}=-\\Omega \\frac{dy}{dt}=-\\Omega(\\Omega x)=-\\Omega^{2}x.$$\n这是谐振子方程，其通解为\n$$x(t)=A\\cos(\\Omega t)+B\\sin(\\Omega t).$$\n应用$x(0)=L$可得$A=L$。接下来，计算$\\frac{dx}{dt}$：\n$$\\frac{dx}{dt}=-A\\Omega \\sin(\\Omega t)+B\\Omega \\cos(\\Omega t).$$\n使用$\\frac{dx}{dt}=-\\Omega y$和$y(0)=0$可得$\\frac{dx}{dt}\\big|_{t=0}=0$，因此\n$$0=\\frac{dx}{dt}\\big|_{t=0}=B\\Omega \\quad \\Rightarrow \\quad B=0.$$\n于是，\n$$x(t)=L\\cos(\\Omega t).$$\n根据$\\frac{dy}{dt}=\\Omega x$和$y(0)=0$，\n$$y(t)=\\int_{0}^{t}\\Omega x(s)\\,ds=\\int_{0}^{t}\\Omega L\\cos(\\Omega s)\\,ds=L\\sin(\\Omega t).$$\n直接检验表明$\\frac{dx}{dt}=-\\Omega y$和$\\frac{dy}{dt}=\\Omega x$均成立，因此解是一致的。\n\n因此，拉格朗日位置是$\\big(x(t),y(t)\\big)=\\big(L\\cos(\\Omega t),\\,L\\sin(\\Omega t)\\big)$。",
            "answer": "$$\\boxed{\\big(L\\cos(\\Omega t), L\\sin(\\Omega t)\\big)}$$"
        },
        {
            "introduction": "在欧拉框架下计算一个拉格朗日属性（如加速度）是连接这两种描述的关键。这个练习将引导你应用物质导数（material derivative）的概念，这是一个核心工具，它包含了速度场的局部时间变化和对流变化。通过计算一个稳定流场中质点的加速度，你将能更好地理解为什么即使在速度场不随时间改变的某一点，流经该点的质点仍然可以经历加速度。",
            "id": "1769241",
            "problem": "在一个用于流体操控的新型微机电系统 (MEMS) 的设计中，某个特定区域被设计成具有稳定的二维流体流动。在欧拉参照系中，该区域的速度场由方程 $\\mathbf{V}(x, y) = C(x\\hat{i} - y\\hat{j})$ 描述，其中 $C$ 是一个单位为 $\\text{s}^{-1}$ 的正常数。一个微小的、中性悬浮的粒子被流体携带运动。确定该粒子的加速度大小，并将其表示为其位置 $(x, y)$ 的函数。将你的答案表示为包含 $C$、$x$ 和 $y$ 的符号表达式。",
            "solution": "流动中的中性悬浮粒子跟随流体运动，因此其加速度等于速度场的物质（或随体）导数：\n$$\n\\mathbf{a}=\\frac{D\\mathbf{V}}{Dt}=\\frac{\\partial \\mathbf{V}}{\\partial t}+(\\mathbf{V}\\cdot\\nabla)\\mathbf{V}.\n$$\n该场是定常的，所以 $\\frac{\\partial \\mathbf{V}}{\\partial t}=0$。设 $\\mathbf{V}=(u,v)$，其中 $u=Cx$ 且 $v=-Cy$。那么对流加速度分量为\n$$\na_{x}=u\\frac{\\partial u}{\\partial x}+v\\frac{\\partial u}{\\partial y},\\qquad a_{y}=u\\frac{\\partial v}{\\partial x}+v\\frac{\\partial v}{\\partial y}.\n$$\n计算所需的偏导数：\n$$\n\\frac{\\partial u}{\\partial x}=C,\\quad \\frac{\\partial u}{\\partial y}=0,\\quad \\frac{\\partial v}{\\partial x}=0,\\quad \\frac{\\partial v}{\\partial y}=-C.\n$$\n因此，\n$$\na_{x}=(Cx)\\,C+(-Cy)\\,0=C^{2}x,\\qquad a_{y}=(Cx)\\,0+(-Cy)\\,(-C)=C^{2}y.\n$$\n因此加速度矢量为 $\\mathbf{a}=C^{2}(x\\hat{i} + y\\hat{j})$，其大小为\n$$\n|\\mathbf{a}|=\\sqrt{a_{x}^{2}+a_{y}^{2}}=\\sqrt{C^{4}(x^{2}+y^{2})}=C^{2}\\sqrt{x^{2}+y^{2}}.\n$$",
            "answer": "$$\\boxed{C^{2}\\sqrt{x^{2}+y^{2}}}$$"
        },
        {
            "introduction": "路径线（pathlines）和流线（streamlines）是流场可视化中两个至关重要的概念，但在非定常流中，它们通常是不同的。这个计算练习提供了一个绝佳的机会，通过编写代码来数值验证这一基本原理。你将通过比较定常流和非定常流中路径线与流线的差异，具体量化非定常效应如何导致这两种曲线的分离，这对于准确解读计算流体动力学（CFD）的瞬态模拟结果至关重要。",
            "id": "3957494",
            "problem": "考虑一个平面上的二维流场，其位置矢量为 $\\mathbf{x}(t) = \\left[x(t), y(t)\\right]^{\\top}$，速度场为 $\\mathbf{u}(\\mathbf{x}, t)$。在欧拉描述中，流场由作为空间位置 $\\mathbf{x}$ 和时间 $t$ 的函数的 $\\mathbf{u}(\\mathbf{x}, t)$ 指定。在拉格朗日描述中，质点运动由常微分方程 $d\\mathbf{x}/dt = \\mathbf{u}(\\mathbf{x}(t), t)$ 和给定的初始条件决定。迹线是流体质点的轨迹 $\\mathbf{x}(t)$，而固定时间 $t_0$ 的流线是一条曲线 $\\mathbf{y}(s)$，满足 $d\\mathbf{y}/ds = \\mathbf{u}(\\mathbf{y}(s), t_0)$ 且 $\\mathbf{y}(0) = \\mathbf{x}_0$。在定常流中，速度场不随时间变化。在弱非定常流中，速度场随时间变化，但其振幅相对于主导的定常分量较小。本问题要求你实现一个数值测试，以验证迹线和流线之间的关系，并使用计算流体动力学 (CFD) 原理量化弱非定常情况下的差异。\n\n你的任务是编写一个程序，为每个指定的测试用例执行以下步骤：\n- 将速度场 $\\mathbf{u}(\\mathbf{x}, t)$ 定义为平面刚体旋转或平面剪切流，并使用具有物理意义的参数和单位。\n- 从给定的初始位置 $\\mathbf{x}_0$ 出发，通过数值积分 $d\\mathbf{x}/dt = \\mathbf{u}(\\mathbf{x}(t), t)$ 从 $t = t_0$ 到 $t = t_0 + T$，计算一条迹线。\n- 从相同的初始位置 $\\mathbf{x}_0$ 出发，通过数值积分 $d\\mathbf{y}/ds = \\mathbf{u}(\\mathbf{y}(s), t_0)$ 从 $s = 0$ 到 $s = T$，计算时间 $t_0$ 处的欧拉流线。\n- 通过计算欧几里得距离 $\\Delta = \\left\\|\\mathbf{x}(t_0 + T) - \\mathbf{y}(T)\\right\\|$（单位为米），量化迹线与相应的时间冻结流线之间的差异。\n\n在测试套件中使用以下速度场和参数。所有位置必须以米为单位，时间以秒为单位，角速率以弧度/秒为单位，剪切率以1/秒为单位。速度场为：\n1. 平面刚体旋转：$\\mathbf{u}(\\mathbf{x}, t) = \\left[\\Omega(t)\\,y,\\; -\\Omega(t)\\,x\\right]^{\\top}$，其中\n   - 定常情况：$\\Omega(t) = \\Omega_0$，\n   - 弱非定常情况：$\\Omega(t) = \\Omega_0\\left(1 + \\varepsilon \\sin(\\omega t)\\right)$。\n2. 平面剪切流：$\\mathbf{u}(\\mathbf{x}, t) = \\left[a(t)\\,y,\\; 0\\right]^{\\top}$，其中\n   - 定常情况：$a(t) = a_0$，\n   - 弱非定常情况：$a(t) = a_0\\left(1 + \\varepsilon \\cos(\\omega t)\\right)$。\n\n使用合适的常微分方程求解器进行数值积分，并设置足够严格的容限，以便区分定常情况下的吻合与弱非定常情况下的差异。对于每个测试用例，计算 $\\Delta$ 作为以米为单位的浮点数。所有用例的初始时间均为 $t_0 = 0$。\n\n测试套件（每一项都是一个独立的测试用例）：\n- 用例 1（定常旋转，理想情况）：$\\Omega_0 = 2.0 \\text{ rad/s}$，$\\varepsilon = 0.0$，$\\omega = 0.0 \\text{ rad/s}$，$\\mathbf{x}_0 = (1.0, 0.0) \\text{ m}$，$T = 1.5 \\text{ s}$。\n- 用例 2（定常剪切）：$a_0 = 0.5 \\text{ s}^{-1}$，$\\varepsilon = 0.0$，$\\omega = 0.0 \\text{ rad/s}$，$\\mathbf{x}_0 = (0.5, 2.0) \\text{ m}$，$T = 2.0 \\text{ s}$。\n- 用例 3（弱非定常旋转）：$\\Omega_0 = 2.0 \\text{ rad/s}$，$\\varepsilon = 0.05$，$\\omega = 3.0 \\text{ rad/s}$，$\\mathbf{x}_0 = (1.0, 0.0) \\text{ m}$，$T = 1.5 \\text{ s}$。\n- 用例 4（弱非定常剪切）：$a_0 = 0.5 \\text{ s}^{-1}$，$\\varepsilon = 0.1$，$\\omega = 4.0 \\text{ rad/s}$，$\\mathbf{x}_0 = (0.5, 2.0) \\text{ m}$，$T = 2.0 \\text{ s}$。\n- 用例 5（驻点处的边界情况）：旋转流，$\\Omega_0 = 2.0 \\text{ rad/s}$，$\\varepsilon = 0.05$，$\\omega = 3.0 \\text{ rad/s}$，$\\mathbf{x}_0 = (0.0, 0.0) \\text{ m}$，$T = 2.0 \\text{ s}$。\n\n你的程序必须为每个用例计算 $\\Delta$，并生成一行输出，其中包含一个用方括号括起来的逗号分隔结果列表，单位为米，四舍五入到六位小数（例如，$\\left[\\Delta_1,\\Delta_2,\\Delta_3,\\Delta_4,\\Delta_5\\right]$）。不允许有其他输出。\n\n所有量都必须以其指定的单位进行处理，角度（如果内部使用）必须以弧度处理。数值方法应足够鲁棒和精确，以解析定常流中接近零的差异和弱非定常流中非零的差异。",
            "solution": "此问题要求对流体动力学中迹线与流线之间的关系进行数值验证，特别是在定常流和弱非定常流中。核心任务是计算遵循迹线的流体质点的最终坐标与在初始时刻 $t_0$ 冻结的相应流线终点之间的欧几里得距离 $\\Delta$。此计算将针对涉及刚体旋转和平面剪切流的五个不同用例进行。\n\n**1. 理论框架：迹线与流线**\n\n在流体力学中，流体的运动可以从两个角度来描述：拉格朗日和欧拉。\n\n**迹线**是一个拉格朗日概念。它表示单个流体质点随时间变化的实际轨迹。给定一个速度场 $\\mathbf{u}(\\mathbf{x}, t)$，质点的位置矢量 $\\mathbf{x}(t) = [x(t), y(t)]^{\\top}$ 由常微分方程组 (ODEs) 决定：\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{u}(\\mathbf{x}(t), t)\n$$\n初始条件为 $\\mathbf{x}(t_0) = \\mathbf{x}_0$。解 $\\mathbf{x}(t)$（对于 $t \\ge t_0$）描绘了迹线。\n\n**流线**是一个欧拉概念。在给定的时间瞬间 $t_0$，流线是一条在该时刻处处与速度矢量场相切的曲线。一条由变量 $s$ 参数化的流线是一条曲线 $\\mathbf{y}(s)$，它满足常微分方程：\n$$\n\\frac{d\\mathbf{y}}{ds} = \\mathbf{u}(\\mathbf{y}(s), t_0)\n$$\n初始条件为 $\\mathbf{y}(s=0) = \\mathbf{x}_0$。速度场 $\\mathbf{u}$ 仅在固定的时间 $t_0$ 进行评估，这有效地“冻结”了该瞬间的流场。\n\n根本区别源于速度场的时间依赖性：\n-   对于**定常流**，$\\mathbf{u}$ 与时间无关，即 $\\mathbf{u} = \\mathbf{u}(\\mathbf{x})$。在这种情况下，迹线和流线的控制方程在功能上是相同的：$d\\mathbf{x}/dt = \\mathbf{u}(\\mathbf{x})$ 和 $d\\mathbf{y}/ds = \\mathbf{u}(\\mathbf{y})$。因此，对于从 $\\mathbf{x}_0$ 开始的质点，其迹线与通过 $\\mathbf{x}_0$ 的流线是相同的。\n-   对于**非定常流**，$\\mathbf{u} = \\mathbf{u}(\\mathbf{x}, t)$，速度场随时间变化。质点的路径（迹线）由其遇到的不断变化的速度矢量决定。然而，流线是基于单一瞬间 $t_0$ 的速度场。随着时间推移到 $t > t_0$，速度场发生变化，质点的轨迹将偏离初始流线。差异 $\\Delta = \\left\\|\\mathbf{x}(t_0 + T) - \\mathbf{y}(T)\\right\\|$ 量化了这种偏离。\n\n**2. 数值方法**\n\n通过对每个测试用例的两个常微分方程组进行数值积分来解决此问题。\n-   **数值求解器**：我们采用 SciPy 库中的 `solve_ivp` 函数，它提供了鲁棒且精确的自适应步长的常微分方程求解器。为确保计算出的差异具有物理意义，而不是数值误差的假象，我们为积分设置了非常严格的误差容限：相对容限为 $10^{-12}$，绝对容限为 $10^{-12}$。\n-   **迹线计算**：对于每个用例，我们从 $\\mathbf{x}(t_0) = \\mathbf{x}_0$ 开始，在时间区间 $[t_0, t_0 + T]$ 上积分迹线常微分方程 $d\\mathbf{x}/dt = \\mathbf{u}(\\mathbf{x}, t)$。所有用例均使用 $t_0 = 0$。最终位置是 $\\mathbf{x}(T)$。\n-   **流线计算**：我们首先定义时间冻结的速度场 $\\mathbf{u}_{t_0}(\\mathbf{y}) = \\mathbf{u}(\\mathbf{y}, t_0)$。然后，我们从 $\\mathbf{y}(0) = \\mathbf{x}_0$ 开始，在参数 $s$ 的区间 $[0, T]$ 上积分流线常微分方程 $d\\mathbf{y}/ds = \\mathbf{u}_{t_0}(\\mathbf{y})$。最终位置是 $\\mathbf{y}(T)$。\n-   **差异计算**：最终差异计算为欧几里得距离 $\\Delta = \\left\\|\\mathbf{x}(T) - \\mathbf{y}(T)\\right\\|$。\n\n**3. 测试用例分析**\n\n该方法应用于五个指定的测试用例。所有用例的初始时间均为 $t_0 = 0$。\n\n-   **用例 1（定常旋转）**：$\\Omega(t) = \\Omega_0 = 2.0$。流是定常的。\n    -   迹线常微分方程：$d\\mathbf{x}/dt = [2.0y, -2.0x]^{\\top}$。\n    -   流线常微分方程：$d\\mathbf{y}/ds = [2.0y, -2.0x]^{\\top}$。\n    -   常微分方程组是相同的。预期的差异为 $\\Delta \\approx 0$，仅受数值精度的限制。\n\n-   **用例 2（定常剪切）**：$a(t) = a_0 = 0.5$。流是定常的。\n    -   迹线常微分方程：$d\\mathbf{x}/dt = [0.5y, 0]^{\\top}$。\n    -   流线常微分方程：$d\\mathbf{y}/ds = [0.5y, 0]^{\\top}$。\n    -   常微分方程组是相同的。预期的差异为 $\\Delta \\approx 0$。\n\n-   **用例 3（弱非定常旋转）**：$\\Omega(t) = 2.0(1 + 0.05 \\sin(3.0t))$。流是非定常的。\n    -   迹线常微分方程：$d\\mathbf{x}/dt = [2.0(1 + 0.05 \\sin(3.0t))y, -2.0(1 + 0.05 \\sin(3.0t))x]^{\\top}$。\n    -   流线常微分方程（在 $t_0=0$ 时）：$\\Omega(0) = 2.0$。方程为 $d\\mathbf{y}/ds = [2.0y, -2.0x]^{\\top}$。\n    -   由于迹线方程中存在时变系数 $\\Omega(t)$，两个常微分方程组是不同的。预期存在一个非零差异 $\\Delta > 0$。\n\n-   **用例 4（弱非定常剪切）**：$a(t) = 0.5(1 + 0.1 \\cos(4.0t))$。流是非定常的。\n    -   迹线常微分方程：$d\\mathbf{x}/dt = [0.5(1 + 0.1 \\cos(4.0t))y, 0]^{\\top}$。\n    -   流线常微分方程（在 $t_0=0$ 时）：$a(0) = 0.5(1 + 0.1) = 0.55$。方程为 $d\\mathbf{y}/ds = [0.55y, 0]^{\\top}$。\n    -   常微分方程组是不同的。预期存在一个非零差异 $\\Delta > 0$。\n\n-   **用例 5（驻点）**：初始位置为 $\\mathbf{x}_0 = (0.0, 0.0)$。\n    -   旋转速度场为 $\\mathbf{u}(\\mathbf{x}, t) = [\\Omega(t)y, -\\Omega(t)x]^{\\top}$。在原点 $\\mathbf{x}=(0,0)$，速度在所有时间 $t$ 均为 $\\mathbf{u}((0,0), t) = [0, 0]^{\\top}$。\n    -   迹线：由于 $\\mathbf{x}(0)=(0,0)$，速度始终为零，因此质点保持在原点。$\\mathbf{x}(T) = (0,0)$。\n    -   流线：由于 $\\mathbf{y}(0)=(0,0)$，冻结速度为零，因此流线不延伸。$\\mathbf{y}(T) = (0,0)$。\n    -   原点是该流场的一个不动点（驻点）。两个终点都是 $(0,0)$，因此差异为 $\\Delta = 0$。即使流是非定常的，这一点也成立。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the discrepancy between pathlines and streamlines for five test cases\n    of 2D steady and unsteady flows.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (steady rotation, happy path)\n        {'type': 'rotation', 'params': {'Omega0': 2.0, 'eps': 0.0, 'omega': 0.0}, 'x0': np.array([1.0, 0.0]), 'T': 1.5},\n        # Case 2 (steady shear)\n        {'type': 'shear', 'params': {'a0': 0.5, 'eps': 0.0, 'omega': 0.0}, 'x0': np.array([0.5, 2.0]), 'T': 2.0},\n        # Case 3 (weakly unsteady rotation)\n        {'type': 'rotation', 'params': {'Omega0': 2.0, 'eps': 0.05, 'omega': 3.0}, 'x0': np.array([1.0, 0.0]), 'T': 1.5},\n        # Case 4 (weakly unsteady shear)\n        {'type': 'shear', 'params': {'a0': 0.5, 'eps': 0.1, 'omega': 4.0}, 'x0': np.array([0.5, 2.0]), 'T': 2.0},\n        # Case 5 (edge case at a stagnation point)\n        {'type': 'rotation', 'params': {'Omega0': 2.0, 'eps': 0.05, 'omega': 3.0}, 'x0': np.array([0.0, 0.0]), 'T': 2.0},\n    ]\n\n    results = []\n    \n    # Set initial time and ODE solver tolerances\n    t0 = 0.0\n    atol = 1e-12\n    rtol = 1e-12\n\n    for case in test_cases:\n        T = case['T']\n        x0 = case['x0']\n        \n        # Define the ODE right-hand-side functions for pathline and streamline\n        if case['type'] == 'rotation':\n            p = case['params']\n            Omega0, eps, omega = p['Omega0'], p['eps'], p['omega']\n            \n            # Pathline: d(x,y)/dt = u(x,y,t)\n            def f_path(t, pos):\n                x, y = pos\n                Omega_t = Omega0 * (1.0 + eps * np.sin(omega * t))\n                return np.array([Omega_t * y, -Omega_t * x])\n            \n            # Streamline: d(x,y)/ds = u(x,y,t0)\n            Omega_t0 = Omega0 * (1.0 + eps * np.sin(omega * t0))\n            def f_stream(s, pos):\n                x, y = pos\n                return np.array([Omega_t0 * y, -Omega_t0 * x])\n\n        elif case['type'] == 'shear':\n            p = case['params']\n            a0, eps, omega = p['a0'], p['eps'], p['omega']\n            \n            # Pathline: d(x,y)/dt = u(x,y,t)\n            def f_path(t, pos):\n                x, y = pos\n                a_t = a0 * (1.0 + eps * np.cos(omega * t))\n                return np.array([a_t * y, 0.0])\n            \n            # Streamline: d(x,y)/ds = u(x,y,t0)\n            a_t0 = a0 * (1.0 + eps * np.cos(omega * t0))\n            def f_stream(s, pos):\n                x, y = pos\n                return np.array([a_t0 * y, 0.0])\n\n        # Integrate to find the pathline endpoint\n        sol_path = solve_ivp(\n            f_path, \n            [t0, t0 + T], \n            x0, \n            dense_output=False, \n            atol=atol, \n            rtol=rtol\n        )\n        x_final = sol_path.y[:, -1]\n\n        # Integrate to find the streamline endpoint\n        sol_stream = solve_ivp(\n            f_stream, \n            [0, T], \n            x0, \n            dense_output=False, \n            atol=atol, \n            rtol=rtol\n        )\n        y_final = sol_stream.y[:, -1]\n\n        # Compute the Euclidean distance (discrepancy)\n        discrepancy = np.linalg.norm(x_final - y_final)\n        results.append(discrepancy)\n\n    # Format the results to 6 decimal places and print in the required format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# solve() # The problem asks for the code, so it's included here.\n# The expected answer is the *output* of this code.\n```",
            "answer": "[0.000000,0.000000,0.088326,0.198007,0.000000]"
        }
    ]
}