{
    "hands_on_practices": [
        {
            "introduction": "牛顿本构关系是流体力学的基石，但它并非一个凭空出现的公式。本练习将引导你从最基本的物理原理——线性、标架无关性和各向同性——出发，一步步推导出三维笛卡尔坐标系下完整的粘性应力张量分量形式。通过这个过程，你将深刻理解这些基本假设是如何塑造我们描述流体行为的数学工具的。",
            "id": "3980287",
            "problem": "一种三维可压缩牛顿气体在航空航天计算流体动力学（CFD）求解器中建模，使用坐标为 $x$, $y$, $z$、速度分量为 $u(x,y,z,t)$, $v(x,y,z,t)$, $w(x,y,z,t)$ 的标准正交笛卡尔坐标系。偏黏性应力张量 $\\boldsymbol{\\tau}$ 定义为柯西应力在减去热力学压力贡献后剩余的部分。假设如下：从局部速度梯度到 $\\boldsymbol{\\tau}$ 的映射是线性的、坐标系无关的和各向同性的；动力黏度 $\\mu$ 是恒定的；且Stokes假设适用于简单气体。\n\n仅从这些原理和定义出发（不要假设任何专门的简化关系），推导黏性应力张量在三维笛卡尔坐标系下以速度梯度表示的分量形式。定义简写 $u_{x} \\equiv \\partial u/\\partial x$, $u_{y} \\equiv \\partial u/\\partial y$, $u_{z} \\equiv \\partial u/\\partial z$，对 $v$ 和 $w$ 也类似。按顺序依次列出 $\\tau_{xx}$, $\\tau_{yy}$, $\\tau_{zz}$, $\\tau_{xy}$, $\\tau_{xz}$, $\\tau_{yz}$。\n\n将最终结果表示为一个单行矩阵，其中包含这六个分量，并用 $\\mu$, $u_{x}$, $u_{y}$, $u_{z}$, $v_{x}$, $v_{y}$, $v_{z}$, $w_{x}$, $w_{y}$, $w_{z}$ 表示。无需进行数值计算或四舍五入。最终表达式中不包含单位。",
            "solution": "问题要求从基本原理出发，推导可压缩牛顿流体在三维笛卡尔坐标系下黏性应力张量 $\\boldsymbol{\\tau}$ 的分量形式。\n\n**第1步：问题验证**\n\n问题陈述已经过验证，被认为是具有科学依据、提法恰当、客观且完整的。这是连续介质流体动力学中的一个标准推导。提供了所有必要的假设：\n1.  流体是三维可压缩牛顿气体。\n2.  坐标系是标准正交笛卡尔坐标系 $(x,y,z)$，速度分量为 $(u,v,w)$。\n3.  偏黏性应力张量 $\\boldsymbol{\\tau}$ 定义为 $\\boldsymbol{\\tau} = \\boldsymbol{\\sigma} + p\\mathbf{I}$，其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量， $p$ 是热力学压力。\n4.  从局部速度梯度 $\\nabla \\mathbf{v}$ 到 $\\boldsymbol{\\tau}$ 的映射是线性的、坐标系无关的和各向同性的。\n5.  动力黏度 $\\mu$ 是恒定的。\n6.  Stokes假设适用于简单气体。\n\n问题有效，将推导其解。\n\n**第2步：从第一性原理推导**\n\n推导过程通过系统地应用给定假设来进行。\n\n**1. 线性与坐标系无关性**\n黏性应力张量 $\\tau_{ij}$ 与速度梯度张量 $L_{kl} = \\frac{\\partial v_k}{\\partial x_l}$ 之间最一般的线性关系为 $\\tau_{ij} = C_{ijkl} L_{kl}$，其中 $\\mathbf{C}$ 是一个四阶材料属性张量。\n\n坐标系无关性（或物质客观性）原理要求本构律独立于参考系的刚体运动。速度梯度张量 $\\mathbf{L}$ 可以分解为一个对称部分，即应变率张量 $\\mathbf{D}$，和一个反对称部分，即旋转率（或涡量）张量 $\\mathbf{W}$：\n$$ \\mathbf{L} = \\mathbf{D} + \\mathbf{W} $$\n其中\n$$ D_{ij} = \\frac{1}{2} \\left( \\frac{\\partial v_i}{\\partial x_j} + \\frac{\\partial v_j}{\\partial x_i} \\right) \\quad \\text{和} \\quad W_{ij} = \\frac{1}{2} \\left( \\frac{\\partial v_i}{\\partial x_j} - \\frac{\\partial v_j}{\\partial x_i} \\right) $$\n旋转率张量 $\\mathbf{W}$ 代表局部刚体旋转，在简单流体中不应引起应力。因此，黏性应力必须仅依赖于应变率张量 $\\mathbf{D}$。线性关系因此简化为从 $\\mathbf{D}$到 $\\boldsymbol{\\tau}$ 的映射：\n$$ \\tau_{ij} = K_{ijkl} D_{kl} $$\n其中 $\\mathbf{K}$ 是另一个四阶张量。\n\n**2. 各向同性**\n流体被假定为各向同性，意味着其材料属性与方向无关。这对张量 $\\mathbf{K}$ 施加了约束。对于各向同性材料，将一个对称二阶张量（$\\mathbf{D}$）映射到另一个对称二阶张量（$\\boldsymbol{\\tau}$）的最一般的四阶张量具有以下形式：\n$$ K_{ijkl} = \\lambda_v \\delta_{ij} \\delta_{kl} + \\mu (\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) $$\n其中 $\\lambda_v$ 和 $\\mu$ 是标量材料常数，$\\delta_{ij}$ 是克罗内克符号。将此代入应力-应变关系可得：\n$$ \\tau_{ij} = \\lambda_v \\delta_{ij} \\delta_{kl} D_{kl} + \\mu (\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) D_{kl} $$\n利用克罗内克符号的性质，$\\delta_{kl}D_{kl} = D_{kk} = \\text{tr}(\\mathbf{D})$，以及 $(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})D_{kl} = D_{ij} + D_{ji}$。由于 $\\mathbf{D}$ 是对称的（$D_{ij} = D_{ji}$），该项变为 $2D_{ij}$。因此关系简化为：\n$$ \\tau_{ij} = \\lambda_v (\\text{tr}(\\mathbf{D})) \\delta_{ij} + 2\\mu D_{ij} $$\n此处，$\\mu$ 被确定为动力（或剪切）黏度，$\\lambda_v$ 是第二黏性系数。项 $\\text{tr}(\\mathbf{D}) = D_{kk} = \\frac{\\partial v_k}{\\partial x_k} = \\nabla \\cdot \\mathbf{v}$ 代表体积膨胀率。\n\n**3. Stokes假设**\n该假设提供了两个黏性系数 $\\lambda_v$ 和 $\\mu$ 之间的关系。它源于对机械压力 $p_m$ 的考虑，机械压力是平均正应力的负值：$p_m = -\\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma})$。柯西应力张量为 $\\sigma_{ij} = -p\\delta_{ij} + \\tau_{ij}$。\n代入 $\\tau_{ij}$ 的表达式：\n$$ \\sigma_{ij} = -p\\delta_{ij} + \\lambda_v (\\nabla \\cdot \\mathbf{v}) \\delta_{ij} + 2\\mu D_{ij} $$\n柯西应力张量的迹为：\n$$ \\text{tr}(\\boldsymbol{\\sigma}) = \\sigma_{kk} = \\sum_{k=1}^{3} \\left( -p\\delta_{kk} + \\lambda_v (\\nabla \\cdot \\mathbf{v}) \\delta_{kk} + 2\\mu D_{kk} \\right) $$\n$$ \\text{tr}(\\boldsymbol{\\sigma}) = -3p + 3\\lambda_v (\\nabla \\cdot \\mathbf{v}) + 2\\mu (\\nabla \\cdot \\mathbf{v}) = -3p + (3\\lambda_v + 2\\mu)(\\nabla \\cdot \\mathbf{v}) $$\n平均正应力为 $\\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma}) = -p + \\left(\\lambda_v + \\frac{2}{3}\\mu\\right)(\\nabla \\cdot \\mathbf{v})$。量 $\\kappa = \\lambda_v + \\frac{2}{3}\\mu$ 是体积黏度，它将机械压力和热力学压力之间的差异与膨胀率联系起来。Stokes假设提出，对于简单的单原子气体（且该假设通常被更广泛地应用），体积黏度 $\\kappa$ 为零。\n$$ \\kappa = \\lambda_v + \\frac{2}{3}\\mu = 0 \\implies \\lambda_v = -\\frac{2}{3}\\mu $$\n将此结果代回 $\\boldsymbol{\\tau}$ 的本构关系：\n$$ \\tau_{ij} = -\\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{ij} + 2\\mu D_{ij} $$\n这就是满足Stokes假设的可压缩牛顿流体的本构关系。\n\n**4. 笛卡尔坐标系下的分量形式**\n我们现在使用速度场 $\\mathbf{v} = (u,v,w)$ 和坐标 $(x,y,z)$ 写出该张量方程的分量。使用简写符号 $u_x = \\partial u/\\partial x$ 等。\n速度的散度为：\n$$ \\nabla \\cdot \\mathbf{v} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = u_x + v_y + w_z $$\n应变率张量 $\\mathbf{D}$ 的分量为：\n$$ D_{xx} = u_x, \\quad D_{yy} = v_y, \\quad D_{zz} = w_z $$\n$$ D_{xy} = \\frac{1}{2}(u_y + v_x), \\quad D_{xz} = \\frac{1}{2}(u_z + w_x), \\quad D_{yz} = \\frac{1}{2}(v_z + w_y) $$\n\n$\\boldsymbol{\\tau}$ 的分量推导如下：\n\n**正应力 ($\\delta_{ij} = 1$):**\n- 对于 $\\tau_{xx}$ ($i=j=1$):\n  $$ \\tau_{xx} = 2\\mu D_{xx} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{11} = 2\\mu u_x - \\frac{2}{3}\\mu (u_x + v_y + w_z) $$\n- 对于 $\\tau_{yy}$ ($i=j=2$):\n  $$ \\tau_{yy} = 2\\mu D_{yy} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{22} = 2\\mu v_y - \\frac{2}{3}\\mu (u_x + v_y + w_z) $$\n- 对于 $\\tau_{zz}$ ($i=j=3$):\n  $$ \\tau_{zz} = 2\\mu D_{zz} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{33} = 2\\mu w_z - \\frac{2}{3}\\mu (u_x + v_y + w_z) $$\n\n**剪应力 ($\\delta_{ij} = 0$ for $i \\neq j$):**\n- 对于 $\\tau_{xy}$ ($i=1, j=2$):\n  $$ \\tau_{xy} = 2\\mu D_{xy} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{12} = 2\\mu \\left( \\frac{1}{2}(u_y + v_x) \\right) = \\mu(u_y + v_x) $$\n- 对于 $\\tau_{xz}$ ($i=1, j=3$):\n  $$ \\tau_{xz} = 2\\mu D_{xz} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{13} = 2\\mu \\left( \\frac{1}{2}(u_z + w_x) \\right) = \\mu(u_z + w_x) $$\n- 对于 $\\tau_{yz}$ ($i=2, j=3$):\n  $$ \\tau_{yz} = 2\\mu D_{yz} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{23} = 2\\mu \\left( \\frac{1}{2}(v_z + w_y) \\right) = \\mu(v_z + w_y) $$\n\n这六个分量按要求组合成一个单行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\mu u_x - \\frac{2}{3}\\mu(u_x + v_y + w_z)  2\\mu v_y - \\frac{2}{3}\\mu(u_x + v_y + w_z)  2\\mu w_z - \\frac{2}{3}\\mu(u_x + v_y + w_z)  \\mu(u_y + v_x)  \\mu(u_z + w_x)  \\mu(v_z + w_y)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在推导出广义的本构关系后，下一步是探究其中各项的物理意义及常用简化假设。本练习聚焦于第二粘性系数 $\\lambda$ 和著名的斯托克斯假设。通过对比在一个平面压缩流中采用与不采用该假设所产生的法向粘性应力，你将清晰地看到体积粘度是如何影响可压缩流动的，并理解斯托克斯假设的物理内涵及其适用范围。",
            "id": "3980264",
            "problem": "考虑一种三维、可压缩的牛顿流体，代表高速计算流体动力学（CFD）中的空气，其剪切粘度 $\\mu$ 为常数，并具有一个通用的第二（与体积相关的）粘性系数 $\\lambda$。该流体经历一个平面压缩过程，其特征速度场为 $\\mathbf{u} = \\alpha x\\,\\mathbf{e}_{x}$，其中 $\\alpha$ 是一个常数。从线性、标架无关、各向同性的牛顿本构假设和形变率张量的定义出发，推导在任意点笛卡尔坐标系下的法向粘性应力分量 $\\tau_{xx}$、$\\tau_{yy}$ 和 $\\tau_{zz}$ 的表达式。首先，在不引用斯托克斯假设的情况下进行推导。然后，在假设斯托克斯假设成立的情况下重复推导。清晰地阐述两组结果之间任何差异的物理诠释，并结合散度驱动的法向应力进行说明。将最终答案表示为单位为帕斯卡的符号解析表达式，并将其呈现为一个单行矩阵，其中按顺序包含不使用斯托克斯假设的三个法向粘性应力分量，以及使用斯托克斯假设的三个法向粘性应力分量。不需要进行数值近似，也无需四舍五入。",
            "solution": "该问题要求针对一个特定的可压缩牛顿流，在应用和不应用斯托克斯假设两种情况下，推导法向粘性应力分量。\n\n首先，我们建立线性、各向同性、可压缩牛顿流体的应力与应变率之间的基本关系。粘性应力张量 $\\underline{\\underline{\\tau}}$ 通过本构方程与形变率张量 $\\underline{\\underline{S}}$ 相关联：\n$$\n\\tau_{ij} = 2\\mu S_{ij} + \\lambda S_{kk} \\delta_{ij}\n$$\n此处，$\\tau_{ij}$ 表示粘性应力张量的分量，$\\mu$ 是恒定的剪切粘度，$\\lambda$ 是第二粘性系数。项 $\\delta_{ij}$ 是克罗内克符号，当 $i=j$ 时为 $1$，当 $i \\neq j$ 时为 $0$。项 $S_{kk}$ 是形变率张量的迹，即其对角分量的总和，$S_{kk} = S_{11} + S_{22} + S_{33}$。\n\n形变率张量 $\\underline{\\underline{S}}$ 根据速度场 $\\mathbf{u}$ 定义为：\n$$\nS_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right)\n$$\n其中 $u_i$ 是速度矢量 $\\mathbf{u}$ 的分量，$x_j$ 是笛卡尔坐标 ($x_1=x, x_2=y, x_3=z$)。\n\n问题给出的速度场为 $\\mathbf{u} = \\alpha x\\,\\mathbf{e}_{x}$。在笛卡尔坐标系中，其分量为：\n$$\nu_x = \\alpha x, \\quad u_y = 0, \\quad u_z = 0\n$$\n现在我们计算必要的速度梯度以确定 $\\underline{\\underline{S}}$ 的分量：\n$$\n\\frac{\\partial u_x}{\\partial x} = \\alpha\n$$\n所有其他梯度，如 $\\frac{\\partial u_x}{\\partial y}$、$\\frac{\\partial u_y}{\\partial x}$、$\\frac{\\partial u_y}{\\partial y}$ 等，均为零。\n\n利用这些梯度，我们计算形变率张量的分量：\n- $S_{xx} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_x}{\\partial x} \\right) = \\frac{1}{2}(\\alpha + \\alpha) = \\alpha$\n- $S_{yy} = \\frac{1}{2} \\left( \\frac{\\partial u_y}{\\partial y} + \\frac{\\partial u_y}{\\partial y} \\right) = \\frac{1}{2}(0 + 0) = 0$\n- $S_{zz} = \\frac{1}{2} \\left( \\frac{\\partial u_z}{\\partial z} + \\frac{\\partial u_z}{\\partial z} \\right) = \\frac{1}{2}(0 + 0) = 0$\n- 所有非对角分量 $S_{ij}$ (其中 $i \\neq j$) 也为零，因为相应的梯度为零。例如，$S_{xy} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\right) = \\frac{1}{2}(0 + 0) = 0$。\n\n形变率张量的迹为 $S_{kk} = S_{xx} + S_{yy} + S_{zz} = \\alpha + 0 + 0 = \\alpha$。注意，这等于速度场的散度，即 $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} + \\frac{\\partial u_z}{\\partial z} = \\alpha$。\n\n**不使用斯托克斯假设的推导**\n\n我们使用已计算出的 $\\underline{\\underline{S}}$ 分量和 $S_{kk} = \\alpha$，应用通用的本构方程 $\\tau_{ij} = 2\\mu S_{ij} + \\lambda S_{kk} \\delta_{ij}$。我们关心的是法向粘性应力分量 $\\tau_{xx}$、$\\tau_{yy}$ 和 $\\tau_{zz}$。\n\n- 对于 $\\tau_{xx}$ ($i=j=1$):\n$$\n\\tau_{xx} = 2\\mu S_{xx} + \\lambda S_{kk} \\delta_{11} = 2\\mu(\\alpha) + \\lambda(\\alpha)(1) = (2\\mu + \\lambda)\\alpha\n$$\n\n- 对于 $\\tau_{yy}$ ($i=j=2$):\n$$\n\\tau_{yy} = 2\\mu S_{yy} + \\lambda S_{kk} \\delta_{22} = 2\\mu(0) + \\lambda(\\alpha)(1) = \\lambda\\alpha\n$$\n\n- 对于 $\\tau_{zz}$ ($i=j=3$):\n$$\n\\tau_{zz} = 2\\mu S_{zz} + \\lambda S_{kk} \\delta_{33} = 2\\mu(0) + \\lambda(\\alpha)(1) = \\lambda\\alpha\n$$\n\n**使用斯托克斯假设的推导**\n\n斯托克斯假设提供了两个粘性系数 $\\lambda$ 和 $\\mu$ 之间的关系。该假设假定机械压力等于热力学压力，对于牛顿流体，这意味着满足条件 $3\\lambda + 2\\mu = 0$。由此得出：\n$$\n\\lambda = -\\frac{2}{3}\\mu\n$$\n这是一个常用于单原子气体的近似，但其普适性有限，尤其是在具有高压缩率或膨胀率的流中。\n\n将 $\\lambda = -\\frac{2}{3}\\mu$ 代入通用本构方程，得到其特殊形式：\n$$\n\\tau_{ij} = 2\\mu S_{ij} - \\frac{2}{3}\\mu S_{kk} \\delta_{ij}\n$$\n我们现在使用这个关系重新计算法向应力分量。\n\n- 对于 $\\tau_{xx}$ ($i=j=1$):\n$$\n\\tau_{xx} = 2\\mu S_{xx} - \\frac{2}{3}\\mu S_{kk} \\delta_{11} = 2\\mu(\\alpha) - \\frac{2}{3}\\mu(\\alpha)(1) = \\left(2 - \\frac{2}{3}\\right)\\mu\\alpha = \\frac{4}{3}\\mu\\alpha\n$$\n\n- 对于 $\\tau_{yy}$ ($i=j=2$):\n$$\n\\tau_{yy} = 2\\mu S_{yy} - \\frac{2}{3}\\mu S_{kk} \\delta_{22} = 2\\mu(0) - \\frac{2}{3}\\mu(\\alpha)(1) = -\\frac{2}{3}\\mu\\alpha\n$$\n\n- 对于 $\\tau_{zz}$ ($i=j=3$):\n$$\n\\tau_{zz} = 2\\mu S_{zz} - \\frac{2}{3}\\mu S_{kk} \\delta_{33} = 2\\mu(0) - \\frac{2}{3}\\mu(\\alpha)(1) = -\\frac{2}{3}\\mu\\alpha\n$$\n\n**物理解释**\n\n通用本构关系中的项 $\\lambda S_{kk} \\delta_{ij} = \\lambda (\\nabla \\cdot \\mathbf{u}) \\delta_{ij}$ 代表一种各向同性应力，它纯粹由流体体积的变化率（压缩或膨胀）引起。系数 $\\lambda$（或者更准确地说，体积粘度 $\\kappa = \\lambda + \\frac{2}{3}\\mu$）量化了流体对这种体积形变的阻力。\n\n在没有斯托克斯假设的情况下，尽管在 $y$ 和 $z$ 方向上没有应变率（$S_{yy}=S_{zz}=0$），但应力 $\\tau_{yy} = \\lambda\\alpha$ 和 $\\tau_{zz} = \\lambda\\alpha$ 依然存在。这些应力是流体体积膨胀率 $\\alpha = \\nabla \\cdot \\mathbf{u}$ 的直接结果。它们代表了流体抵抗膨胀或压缩的内在阻力，这一现象由第二粘性系数 $\\lambda$ 来表征。\n\n引用斯托克斯假设等同于假设体积粘度 $\\kappa = \\lambda + \\frac{2}{3}\\mu = 0$。这意味着流体对纯体积变化没有粘性阻力。在此假设下，粘性应力张量的迹恒为零：$\\tau_{kk} = \\tau_{xx}+\\tau_{yy}+\\tau_{zz} = \\frac{4}{3}\\mu\\alpha - \\frac{2}{3}\\mu\\alpha - \\frac{2}{3}\\mu\\alpha = 0$，这与理论结果 $\\tau_{kk} = (2\\mu+3\\lambda)S_{kk}$ 一致。非零应力 $\\tau_{yy} = -\\frac{2}{3}\\mu\\alpha$ 和 $\\tau_{zz} = -\\frac{2}{3}\\mu\\alpha$ 不再代表对膨胀的内在阻力。相反，它们表现为与剪切粘度 $\\mu$ 耦合的反作用应力，必须在横向方向上产生，以确保平均粘性法向应力为零，这是该假设人为强加的条件。在模拟具有强可压缩性效应的流动（例如涉及激波的流动）时，这一假设可能导致重大误差，因为在这些情况下，体积粘度具有重要的物理意义。\n\n最终结果被收集为一个单行矩阵，其中按指定顺序包含六个推导出的表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} (2\\mu + \\lambda)\\alpha  \\lambda\\alpha  \\lambda\\alpha  \\frac{4}{3}\\mu\\alpha  -\\frac{2}{3}\\mu\\alpha  -\\frac{2}{3}\\mu\\alpha \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理论的正确性最终需要通过计算实践来验证。在计算流体动力学（CFD）中，确保代码准确地求解了控制方程至关重要。本练习将向你介绍一种强大的代码验证技术——“人造解方法”（Method of Manufactured Solutions）。你将亲自应用牛顿本构关系来构造一个精确的测试用例，并用它来验证一个数值格式的收敛精度，这是任何CFD研究者都应掌握的核心技能。",
            "id": "3980326",
            "problem": "在航空航天计算流体动力学 (CFD) 的背景下，考虑一个二维、稳态、周期的牛顿流体流动。可压缩流体的牛顿本构关系指出，粘性应力张量 $\\boldsymbol{\\tau}$ 由 $\\boldsymbol{\\tau} = \\mu \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{T} \\right) - \\frac{2}{3} \\mu (\\nabla \\cdot \\mathbf{u}) \\mathbf{I}$ 给出，其中 $\\mu$ 是动力粘度，$\\mathbf{u}$ 是速度场，$\\mathbf{I}$ 是单位张量。对于无散速度场，与 $\\nabla \\cdot \\mathbf{u}$ 成正比的项消失，本构关系简化为 $\\boldsymbol{\\tau} = \\mu \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{T} \\right)$。\n\n您将使用“制造解方法”（Method of Manufactured Solutions）来验证离散粘性算子的二阶收敛性。从牛顿本构关系和矢量微积分恒等式的基本定义出发。设计算域为 $\\Omega = [0,1] \\times [0,1]$，在两个方向上均采用周期性边界条件。定义精确的速度场和粘度场为\n$$\n\\mathbf{u}(x,y) = \\begin{bmatrix}\n\\sin(2\\pi x)\\cos(2\\pi y) \\\\\n-\\cos(2\\pi x)\\sin(2\\pi y)\n\\end{bmatrix}, \\qquad\n\\mu(x,y) = \\mu_0 \\left[ 1 + \\alpha \\sin(2\\pi x)\\cos(2\\pi y) \\right],\n$$\n其中 $\\mu_0  0$ 是一个常数，$\\alpha$ 是一个控制 $\\mu(x,y)$ 空间变化的无量纲参数。\n\n设连续粘性算子定义为\n$$\n\\mathbf{L}[\\mathbf{u}] = \\nabla \\cdot \\boldsymbol{\\tau}, \\quad \\text{其中} \\quad \\boldsymbol{\\tau} = \\mu \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T \\right).\n$$\n通过 $\\mathbf{f}(x,y) = \\mathbf{L}[\\mathbf{u}(x,y)]$ 定义制造的强迫场 $\\mathbf{f}(x,y)$。从第一性原理出发，通过对给定场进行直接微分，推导 $\\mathbf{f}(x,y)$ 的分量 $f_1(x,y)$ 和 $f_2(x,y)$ 的闭式表达式。不要使用预先推导的矢量算子快捷公式；仅从上述定义和标准微分法则出发。\n\n使用二阶中心差分，在具有周期性边界的均匀 $N \\times N$ 网格上对 $\\mathbf{L}[\\mathbf{u}]$ 进行离散化。具体来说：\n- 使用网格点 $(x_i, y_j) = \\left( \\frac{i}{N}, \\frac{j}{N} \\right)$，其中 $i,j \\in \\{0,1,\\dots,N-1\\}$，网格间距为 $h = \\frac{1}{N}$。\n- 在周期性边界条件下，使用二阶中心差分计算所有空间导数。\n- 通过计算 $\\mu$ 和对称梯度，在网格点上构造 $\\boldsymbol{\\tau}$。\n- 使用二阶中心差分，将 $\\mathbf{L}_h[\\mathbf{u}]$ 计算为 $\\boldsymbol{\\tau}$ 的离散散度。\n\n构建离散残差场\n$$\n\\mathbf{r}_h = \\mathbf{L}_h[\\mathbf{u}] - \\mathbf{f},\n$$\n并测量离散 $L^2$ 误差范数\n$$\nE_h = \\left( \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} \\left[ r_{h,1}(x_i,y_j)^2 + r_{h,2}(x_i,y_j)^2 \\right] \\right)^{1/2} h,\n$$\n它是连续 $L^2$ 范数的一个近似。对于下面的每种情况，计算 $N \\in \\{16,32,64,128\\}$ 时的 $E_h$，并使用两个最精细的网格尺寸通过以下公式估算经验收敛阶 $p$：\n$$\np = \\frac{\\log(E_{h_1}/E_{h_2})}{\\log(h_1/h_2)},\n$$\n其中 $h_1 = \\frac{1}{64}$ 且 $h_2 = \\frac{1}{128}$。\n\n测试套件：\n- 情况 A（一般变化）：$\\mu_0 = 1$，$\\alpha = 0.3$。\n- 情况 B（恒定粘度边界情况）：$\\mu_0 = 1$，$\\alpha = 0$。\n- 情况 C（强变化边缘情况）：$\\mu_0 = 1$，$\\alpha = 0.9$。\n\n您的程序必须计算每种情况下的经验阶数 $p$，并生成一行输出，其中包含三个值 $[p_A,p_B,p_C]$，形式为方括号内用逗号分隔的列表。输出值为无量纲浮点数。不需要物理单位或角度。程序必须是自包含的，并且不得读取任何输入。",
            "solution": "该问题是有效的，因为它具有科学依据、自成体系且提法适定。该任务涉及为纳维-斯托克斯方程的粘性部分推导制造源项，并验证相应有限差分离散化的收敛阶，这是计算流体动力学（CFD）代码验证中的标准程序。所提供的速度场是无散的，这证明了使用不可压缩流体的简化本构关系是合理的。所有参数和函数都有明确的定义。\n\n解答分两个阶段进行。首先，从第一性原理推导制造源项 $\\mathbf{f}(x,y)$ 的解析表达式。其次，概述一个数值方案，用于离散化粘性算子，计算相对于精确源项的数值误差，并确定经验收敛阶。\n\n**1. 制造源项的解析推导**\n\n制造源项 $\\mathbf{f}$ 定义为连续粘性算子 $\\mathbf{L}[\\mathbf{u}]$ 作用于精确速度场 $\\mathbf{u}(x,y)$ 的结果。算子为 $\\mathbf{L}[\\mathbf{u}] = \\nabla \\cdot \\boldsymbol{\\tau}$，其中 $\\boldsymbol{\\tau} = \\mu \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T \\right)$。推导过程通过系统地计算每个分量来进行。\n\n设 $k=2\\pi$。速度场分量为 $u_1(x,y) = \\sin(kx)\\cos(ky)$ 和 $u_2(x,y) = -\\cos(kx)\\sin(ky)$。粘度场为 $\\mu(x,y) = \\mu_0 [1 + \\alpha u_1(x,y)]$。\n\n首先，我们计算速度梯度张量 $\\nabla \\mathbf{u}$：\n$$\n\\nabla \\mathbf{u} = \\begin{bmatrix}\n\\frac{\\partial u_1}{\\partial x}  \\frac{\\partial u_1}{\\partial y} \\\\\n\\frac{\\partial u_2}{\\partial x}  \\frac{\\partial u_2}{\\partial y}\n\\end{bmatrix}\n$$\n速度分量的偏导数是：\n$$\n\\frac{\\partial u_1}{\\partial x} = k \\cos(kx)\\cos(ky)\n$$\n$$\n\\frac{\\partial u_1}{\\partial y} = -k \\sin(kx)\\sin(ky)\n$$\n$$\n\\frac{\\partial u_2}{\\partial x} = k \\sin(kx)\\sin(ky)\n$$\n$$\n\\frac{\\partial u_2}{\\partial y} = -k \\cos(kx)\\cos(ky)\n$$\n速度场是无散的，因为 $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u_1}{\\partial x} + \\frac{\\partial u_2}{\\partial y} = k\\cos(kx)\\cos(ky) - k\\cos(kx)\\cos(ky) = 0$。\n\n速度梯度张量为：\n$$\n\\nabla \\mathbf{u} = k \\begin{bmatrix}\n\\cos(kx)\\cos(ky)  -\\sin(kx)\\sin(ky) \\\\\n\\sin(kx)\\sin(ky)  -\\cos(kx)\\cos(ky)\n\\end{bmatrix}\n$$\n接下来，我们构建张量 $\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T$：\n$$\n\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T = k \\begin{bmatrix}\n2\\cos(kx)\\cos(ky)  0 \\\\\n0  -2\\cos(kx)\\cos(ky)\n\\end{bmatrix}\n$$\n那么，粘性应力张量 $\\boldsymbol{\\tau}$ 为：\n$$\n\\boldsymbol{\\tau} = \\mu \\left(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T\\right) = 2k\\mu \\begin{bmatrix}\n\\cos(kx)\\cos(ky)  0 \\\\\n0  -\\cos(kx)\\cos(ky)\n\\end{bmatrix}\n$$\n应力张量的分量为 $\\tau_{11} = 2k\\mu\\cos(kx)\\cos(ky)$，$\\tau_{22} = -2k\\mu\\cos(kx)\\cos(ky) = -\\tau_{11}$，以及 $\\tau_{12} = \\tau_{21} = 0$。\n\n源项 $\\mathbf{f} = \\nabla \\cdot \\boldsymbol{\\tau}$ 的分量为 $f_1 = \\frac{\\partial \\tau_{11}}{\\partial x} + \\frac{\\partial \\tau_{12}}{\\partial y}$ 和 $f_2 = \\frac{\\partial \\tau_{21}}{\\partial x} + \\frac{\\partial \\tau_{22}}{\\partial y}$。由于非对角线项为零，这简化为 $f_1 = \\frac{\\partial \\tau_{11}}{\\partial x}$ 和 $f_2 = \\frac{\\partial \\tau_{22}}{\\partial y}$。\n\n我们现在计算这些偏导数。\n对于 $f_1 = \\frac{\\partial \\tau_{11}}{\\partial x}$：\n$$\n\\tau_{11} = 2k \\mu_0 [1 + \\alpha \\sin(kx)\\cos(ky)] \\cos(kx)\\cos(ky)\n= 2k\\mu_0 [\\cos(kx)\\cos(ky) + \\alpha \\sin(kx)\\cos(kx)\\cos^2(ky)]\n$$\n使用乘法法则和链式法则对 $x$ 求导：\n$$\nf_1 = \\frac{\\partial \\tau_{11}}{\\partial x} = 2k\\mu_0 \\left[ -k\\sin(kx)\\cos(ky) + \\alpha \\cos^2(ky) \\frac{\\partial}{\\partial x}(\\sin(kx)\\cos(kx)) \\right]\n$$\n由于 $\\frac{\\partial}{\\partial x}(\\sin(kx)\\cos(kx)) = \\frac{\\partial}{\\partial x}(\\frac{1}{2}\\sin(2kx)) = k\\cos(2kx)$，我们有：\n$$\nf_1(x,y) = 2k\\mu_0 [-k\\sin(kx)\\cos(ky) + \\alpha k \\cos(2kx)\\cos^2(ky)]\n$$\n代入 $k=2\\pi$：\n$$\nf_1(x,y) = 8\\pi^2\\mu_0 [-\\sin(2\\pi x)\\cos(2\\pi y) + \\alpha \\cos(4\\pi x)\\cos^2(2\\pi y)]\n$$\n对于 $f_2 = \\frac{\\partial \\tau_{22}}{\\partial y} = -\\frac{\\partial \\tau_{11}}{\\partial y}$：\n$$\n\\frac{\\partial \\tau_{11}}{\\partial y} = 2k\\mu_0 \\left[ \\frac{\\partial}{\\partial y}(\\cos(kx)\\cos(ky)) + \\alpha \\sin(kx)\\cos(kx) \\frac{\\partial}{\\partial y}(\\cos^2(ky)) \\right]\n$$\n$$\n\\frac{\\partial \\tau_{11}}{\\partial y} = 2k\\mu_0 [\\cos(kx)(-k\\sin(ky)) + \\alpha \\sin(kx)\\cos(kx)(2\\cos(ky)(-k\\sin(ky)))]\n$$\n$$\n\\frac{\\partial \\tau_{11}}{\\partial y} = -2k^2\\mu_0 [\\cos(kx)\\sin(ky) + \\alpha \\sin(kx)\\cos(kx)\\sin(2ky)]\n$$\n因此，$f_2 = -\\frac{\\partial \\tau_{11}}{\\partial y}$：\n$$\nf_2(x,y) = 2k^2\\mu_0 [\\cos(kx)\\sin(ky) + \\alpha \\sin(kx)\\cos(kx)\\sin(2ky)]\n$$\n代入 $k=2\\pi$ 并化简三角函数项：\n$$\nf_2(x,y) = 8\\pi^2\\mu_0 \\left[\\cos(2\\pi x)\\sin(2\\pi y) + \\frac{\\alpha}{2}\\sin(4\\pi x)\\sin(4\\pi y)\\right]\n$$\n这些 $f_1$ 和 $f_2$ 的解析表达式将用于计算网格上的精确源项。\n\n**2. 数值离散化与收敛性分析**\n\n连续域 $\\Omega = [0,1] \\times [0,1]$ 被离散化为 $N \\times N$ 点的均匀网格 $(x_i, y_j) = (ih, jh)$，其中 $h=1/N$ 且 $i, j \\in \\{0, 1, \\dots, N-1\\}$。所有空间导数都使用二阶中心差分格式进行近似，这适用于周期性边界条件。对于一个通用的网格函数 $g_{i,j}$，其离散导数为：\n$$\nD_x(g)_{i,j} = \\frac{g_{i+1,j} - g_{i-1,j}}{2h}, \\quad D_y(g)_{i,j} = \\frac{g_{i,j+1} - g_{i,j-1}}{2h}\n$$\n下标按周期性处理，例如 $g_{N,j} = g_{0,j}$ 和 $g_{-1,j} = g_{N-1,j}$。\n\n对于给定的网格尺寸 $N$，数值程序如下：\n1.  在所有网格点 $(x_i, y_j)$ 上计算精确的速度场 $u_1, u_2$ 和粘度 $\\mu$。\n2.  计算离散速度梯度分量：$D_x(u_1)$, $D_y(u_1)$, $D_x(u_2)$ 和 $D_y(u_2)$。\n3.  在每个网格点上构造离散应力张量分量：\n    $$ \\tau_{h,11} = \\mu (2 D_x(u_1)) $$\n    $$ \\tau_{h,12} = \\mu (D_y(u_1) + D_x(u_2)) $$\n    $$ \\tau_{h,22} = \\mu (2 D_y(u_2)) $$\n4.  通过取 $\\boldsymbol{\\tau}_h$ 的离散散度来计算离散粘性算子 $\\mathbf{L}_h[\\mathbf{u}]$：\n    $$ L_{h,1} = D_x(\\tau_{h,11}) + D_y(\\tau_{h,12}) $$\n    $$ L_{h,2} = D_x(\\tau_{h,12}) + D_y(\\tau_{h,22}) $$\n5.  根据推导出的解析表达式，在所有网格点上计算精确源项 $f_1, f_2$。\n6.  计算离散残差场 $\\mathbf{r}_h = \\mathbf{L}_h[\\mathbf{u}] - \\mathbf{f}$。\n7.  计算离散 $L^2$ 误差范数 $E_h$：\n    $$ E_h = \\left( \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} \\left[ r_{h,1}(x_i,y_j)^2 + r_{h,2}(x_i,y_j)^2 \\right] \\right)^{1/2} h $$\n对一系列加密的网格 $N \\in \\{16, 32, 64, 128\\}$ 重复此过程。经验收敛阶 $p$ 是根据两个最精细网格 ($N_1=64, N_2=128$) 上的误差，使用以下公式估算的：\n$$ p = \\frac{\\log(E_{h_1}/E_{h_2})}{\\log(h_1/h_2)} = \\frac{\\log(E_{64}/E_{128})}{\\log(2)} $$\n由于制造解是光滑的（解析的），并且离散化方案是二阶中心差分，因此预期的收敛阶为 $p=2$。该实现将针对三个指定的情况执行此程序。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the three test cases.\n    It computes the empirical order of convergence for each case and prints the results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.3),  # Case A\n        (1.0, 0.0),  # Case B\n        (1.0, 0.9),  # Case C\n    ]\n\n    results = []\n    for mu0, alpha in test_cases:\n        p = calculate_convergence_order(mu0, alpha)\n        results.append(p)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\n\ndef calculate_convergence_order(mu0, alpha):\n    \"\"\"\n    Calculates the empirical order of convergence for a given set of\n    physical parameters mu0 and alpha.\n    \"\"\"\n    grid_sizes = [16, 32, 64, 128]\n    errors = []\n\n    for N in grid_sizes:\n        h = 1.0 / N\n        \n        # 1. Create grid and evaluate exact fields\n        x = np.linspace(0.0, 1.0, N, endpoint=False)\n        xx, yy = np.meshgrid(x, x, indexing='ij')\n\n        k = 2.0 * np.pi\n        \n        # Exact velocity field\n        u1 = np.sin(k * xx) * np.cos(k * yy)\n        u2 = -np.cos(k * xx) * np.sin(k * yy)\n        \n        # Exact viscosity field\n        mu = mu0 * (1.0 + alpha * u1)\n        \n        # Exact manufactured forcing field f(x,y)\n        # f1(x,y) = 8*pi^2*mu0 * [-sin(2*pi*x)*cos(2*pi*y) + alpha*cos(4*pi*x)*cos^2(2*pi*y)]\n        term1_f1 = -np.sin(k * xx) * np.cos(k * yy)\n        term2_f1 = alpha * np.cos(2.0 * k * xx) * np.cos(k * yy)**2\n        f1 = 8.0 * np.pi**2 * mu0 * (term1_f1 + term2_f1)\n        \n        # f2(x,y) = 8*pi^2*mu0 * [cos(2*pi*x)*sin(2*pi*y) + (alpha/2)*sin(4*pi*x)*sin(4*pi*y)]\n        term1_f2 = np.cos(k * xx) * np.sin(k * yy)\n        term2_f2 = (alpha / 2.0) * np.sin(2.0 * k * xx) * np.sin(2.0 * k * yy)\n        f2 = 8.0 * np.pi**2 * mu0 * (term1_f2 + term2_f2)\n\n        # 2. Compute discrete viscous operator L_h[u]\n        \n        # Discrete derivatives using second-order central differences with periodic BCs\n        def central_diff_x(field):\n            return (np.roll(field, -1, axis=0) - np.roll(field, 1, axis=0)) / (2.0 * h)\n        \n        def central_diff_y(field):\n            return (np.roll(field, -1, axis=1) - np.roll(field, 1, axis=1)) / (2.0 * h)\n\n        # Discrete velocity gradient\n        du1_dx = central_diff_x(u1)\n        du1_dy = central_diff_y(u1)\n        du2_dx = central_diff_x(u2)\n        du2_dy = central_diff_y(u2)\n        \n        # Discrete stress tensor tau_h\n        tau_h_11 = mu * (2.0 * du1_dx)\n        tau_h_12 = mu * (du1_dy + du2_dx)\n        tau_h_22 = mu * (2.0 * du2_dy)\n        \n        # Discrete divergence of stress tensor -> L_h[u]\n        L_h_1 = central_diff_x(tau_h_11) + central_diff_y(tau_h_12)\n        L_h_2 = central_diff_x(tau_h_12) + central_diff_y(tau_h_22)\n        \n        # 3. Form discrete residual and compute L2 error norm\n        r_h_1 = L_h_1 - f1\n        r_h_2 = L_h_2 - f2\n        \n        # E_h = ||r_h||_L2 * h, where ||.||_L2 is the discrete L2 norm.\n        # The grid spacing h multiplication converts the sum into an integral approximation.\n        error_norm = np.sqrt(np.sum(r_h_1**2 + r_h_2**2)) * h\n        errors.append(error_norm)\n\n    # 4. Estimate empirical convergence order\n    # p = log(E_h1 / E_h2) / log(h1 / h2), where h1/h2 = 2\n    E_h1 = errors[2]  # N=64\n    E_h2 = errors[3]  # N=128\n    \n    p = np.log(E_h1 / E_h2) / np.log(2.0)\n    \n    return p\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}