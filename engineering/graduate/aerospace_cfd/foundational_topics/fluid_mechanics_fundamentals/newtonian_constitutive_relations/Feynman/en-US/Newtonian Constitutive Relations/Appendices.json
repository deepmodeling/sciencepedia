{
    "hands_on_practices": [
        {
            "introduction": "Understanding the Newtonian constitutive relation begins with its derivation from first principles. This foundational practice challenges you to construct the full viscous stress tensor for a compressible fluid, starting only from physical axioms like linearity, frame-indifference, and isotropy, along with the simplifying Stokes' hypothesis . Mastering this derivation provides a deep appreciation for the assumptions embedded in the Navier-Stokes equations used in nearly all conventional CFD solvers.",
            "id": "3980287",
            "problem": "A three-dimensional compressible Newtonian gas is modeled in an aerospace Computational Fluid Dynamics (CFD) solver using an orthonormal Cartesian frame with coordinates $x$, $y$, $z$ and velocity components $u(x,y,z,t)$, $v(x,y,z,t)$, $w(x,y,z,t)$. The deviatoric viscous stress tensor $\\boldsymbol{\\tau}$ is defined as the part of the Cauchy stress that remains after subtracting the thermodynamic pressure contribution. Assume the following: the mapping from the local velocity gradient to $\\boldsymbol{\\tau}$ is linear, frame-indifferent, and isotropic; the dynamic viscosity $\\mu$ is constant; and Stokesâ€™ hypothesis applies for a simple gas.\n\nStarting only from these principles and definitions (do not assume any specialized shortcut relations), derive the component form of the viscous stress tensor in three-dimensional Cartesian coordinates in terms of velocity gradients. Define the shorthand $u_{x} \\equiv \\partial u/\\partial x$, $u_{y} \\equiv \\partial u/\\partial y$, $u_{z} \\equiv \\partial u/\\partial z$, and similarly for $v$ and $w$. Enumerate $\\tau_{xx}$, $\\tau_{yy}$, $\\tau_{zz}$, $\\tau_{xy}$, $\\tau_{xz}$, $\\tau_{yz}$ in that order.\n\nExpress your final result as a single row matrix containing these six components in terms of $\\mu$, $u_{x}$, $u_{y}$, $u_{z}$, $v_{x}$, $v_{y}$, $v_{z}$, $w_{x}$, $w_{y}$, $w_{z}$. No numerical evaluation or rounding is required. Do not include units in your final expression.",
            "solution": "The problem requires the derivation of the component form of the viscous stress tensor, $\\boldsymbol{\\tau}$, for a compressible Newtonian fluid in three-dimensional Cartesian coordinates, starting from fundamental principles. The derivation proceeds by systematically applying the given assumptions.\n\n**1. Linearity and Frame Indifference**\nThe most general linear relationship between the viscous stress tensor $\\tau_{ij}$ and the velocity gradient tensor $L_{kl} = \\frac{\\partial v_k}{\\partial x_l}$ would be $\\tau_{ij} = C_{ijkl} L_{kl}$, where $\\mathbf{C}$ is a fourth-order tensor of material properties.\n\nThe principle of frame indifference (or material objectivity) requires that the constitutive law be independent of rigid body motions of the reference frame. The velocity gradient tensor $\\mathbf{L}$ can be decomposed into a symmetric part, the rate-of-strain tensor $\\mathbf{D}$, and an anti-symmetric part, the rate-of-rotation (or spin) tensor $\\mathbf{W}$:\n$$ \\mathbf{L} = \\mathbf{D} + \\mathbf{W} $$\nwhere\n$$ D_{ij} = \\frac{1}{2} \\left( \\frac{\\partial v_i}{\\partial x_j} + \\frac{\\partial v_j}{\\partial x_i} \\right) \\quad \\text{and} \\quad W_{ij} = \\frac{1}{2} \\left( \\frac{\\partial v_i}{\\partial x_j} - \\frac{\\partial v_j}{\\partial x_i} \\right) $$\nThe rate-of-rotation tensor $\\mathbf{W}$ represents local rigid body rotation, which should not induce stress in a simple fluid. Therefore, the viscous stress must depend only on the rate-of-strain tensor $\\mathbf{D}$. The linear relationship thus simplifies to a mapping from $\\mathbf{D}$ to $\\boldsymbol{\\tau}$:\n$$ \\tau_{ij} = K_{ijkl} D_{kl} $$\nwhere $\\mathbf{K}$ is another fourth-order tensor.\n\n**2. Isotropy**\nThe fluid is assumed to be isotropic, meaning its material properties are independent of direction. This imposes constraints on the tensor $\\mathbf{K}$. For an isotropic material, the most general fourth-order tensor that maps a symmetric second-order tensor ($\\mathbf{D}$) to another symmetric second-order tensor ($\\boldsymbol{\\tau}$) has the form:\n$$ K_{ijkl} = \\lambda \\delta_{ij} \\delta_{kl} + \\mu (\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) $$\nwhere $\\lambda$ and $\\mu$ are scalar material constants, and $\\delta_{ij}$ is the Kronecker delta. Substituting this into the stress-strain relation gives:\n$$ \\tau_{ij} = \\lambda \\delta_{ij} \\delta_{kl} D_{kl} + \\mu (\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) D_{kl} $$\nUsing the properties of the Kronecker delta, $\\delta_{kl}D_{kl} = D_{kk} = \\text{tr}(\\mathbf{D})$, and $(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})D_{kl} = D_{ij} + D_{ji}$. Since $\\mathbf{D}$ is symmetric ($D_{ij} = D_{ji}$), this term becomes $2D_{ij}$. The relation thus simplifies to:\n$$ \\tau_{ij} = \\lambda (\\text{tr}(\\mathbf{D})) \\delta_{ij} + 2\\mu D_{ij} $$\nHere, $\\mu$ is identified as the dynamic (or shear) viscosity, and $\\lambda$ is the second coefficient of viscosity. The term $\\text{tr}(\\mathbf{D}) = D_{kk} = \\frac{\\partial v_k}{\\partial x_k} = \\nabla \\cdot \\mathbf{v}$ represents the rate of volumetric dilatation.\n\n**3. Stokes' Hypothesis**\nThis hypothesis provides a relationship between the two viscosity coefficients, $\\lambda$ and $\\mu$. It arises from considering the mechanical pressure, $p_m$, which is the negative of the mean normal stress: $p_m = -\\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma})$. The Cauchy stress tensor is $\\sigma_{ij} = -p\\delta_{ij} + \\tau_{ij}$.\nSubstituting the expression for $\\tau_{ij}$:\n$$ \\sigma_{ij} = -p\\delta_{ij} + \\lambda (\\nabla \\cdot \\mathbf{v}) \\delta_{ij} + 2\\mu D_{ij} $$\nThe trace of the Cauchy stress tensor is:\n$$ \\text{tr}(\\boldsymbol{\\sigma}) = \\sigma_{kk} = \\sum_{k=1}^{3} \\left( -p\\delta_{kk} + \\lambda (\\nabla \\cdot \\mathbf{v}) \\delta_{kk} + 2\\mu D_{kk} \\right) $$\n$$ \\text{tr}(\\boldsymbol{\\sigma}) = -3p + 3\\lambda (\\nabla \\cdot \\mathbf{v}) + 2\\mu (\\nabla \\cdot \\mathbf{v}) = -3p + (3\\lambda + 2\\mu)(\\nabla \\cdot \\mathbf{v}) $$\nThe mean normal stress is $\\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma}) = -p + \\left(\\lambda + \\frac{2}{3}\\mu\\right)(\\nabla \\cdot \\mathbf{v})$. The quantity $\\kappa = \\lambda + \\frac{2}{3}\\mu$ is the bulk viscosity, which relates the difference between mechanical and thermodynamic pressure to the rate of expansion. Stokes' hypothesis posits that for a simple monatomic gas (and it is often applied more generally), the bulk viscosity $\\kappa$ is zero.\n$$ \\kappa = \\lambda + \\frac{2}{3}\\mu = 0 \\implies \\lambda = -\\frac{2}{3}\\mu $$\nSubstituting this result back into the constitutive relation for $\\boldsymbol{\\tau}$:\n$$ \\tau_{ij} = -\\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{ij} + 2\\mu D_{ij} $$\nThis is the constitutive relation for a compressible Newtonian fluid satisfying Stokes' hypothesis.\n\n**4. Component Form in Cartesian Coordinates**\nWe now write out the components of this tensor equation using the velocity field $\\mathbf{v} = (u,v,w)$ and coordinates $(x,y,z)$. The shorthand notation $u_x = \\partial u/\\partial x$, etc., is used.\nThe divergence of velocity is:\n$$ \\nabla \\cdot \\mathbf{v} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = u_x + v_y + w_z $$\nThe components of the rate-of-strain tensor $\\mathbf{D}$ are:\n$$ D_{xx} = u_x, \\quad D_{yy} = v_y, \\quad D_{zz} = w_z $$\n$$ D_{xy} = \\frac{1}{2}(u_y + v_x), \\quad D_{xz} = \\frac{1}{2}(u_z + w_x), \\quad D_{yz} = \\frac{1}{2}(v_z + w_y) $$\n\nThe components of $\\boldsymbol{\\tau}$ are derived as follows:\n\n**Normal Stresses ($\\delta_{ij} = 1$):**\n- For $\\tau_{xx}$ ($i=j=1$):\n  $$ \\tau_{xx} = 2\\mu D_{xx} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{11} = 2\\mu u_x - \\frac{2}{3}\\mu (u_x + v_y + w_z) $$\n- For $\\tau_{yy}$ ($i=j=2$):\n  $$ \\tau_{yy} = 2\\mu D_{yy} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{22} = 2\\mu v_y - \\frac{2}{3}\\mu (u_x + v_y + w_z) $$\n- For $\\tau_{zz}$ ($i=j=3$):\n  $$ \\tau_{zz} = 2\\mu D_{zz} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{33} = 2\\mu w_z - \\frac{2}{3}\\mu (u_x + v_y + w_z) $$\n\n**Shear Stresses ($\\delta_{ij} = 0$ for $i \\neq j$):**\n- For $\\tau_{xy}$ ($i=1, j=2$):\n  $$ \\tau_{xy} = 2\\mu D_{xy} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{12} = 2\\mu \\left( \\frac{1}{2}(u_y + v_x) \\right) = \\mu(u_y + v_x) $$\n- For $\\tau_{xz}$ ($i=1, j=3$):\n  $$ \\tau_{xz} = 2\\mu D_{xz} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{13} = 2\\mu \\left( \\frac{1}{2}(u_z + w_x) \\right) = \\mu(u_z + w_x) $$\n- For $\\tau_{yz}$ ($i=2, j=3$):\n  $$ \\tau_{yz} = 2\\mu D_{yz} - \\frac{2}{3}\\mu (\\nabla \\cdot \\mathbf{v}) \\delta_{23} = 2\\mu \\left( \\frac{1}{2}(v_z + w_y) \\right) = \\mu(v_z + w_y) $$\n\nThese six components are assembled into a single row matrix as requested.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\mu u_x - \\frac{2}{3}\\mu(u_x + v_y + w_z) & 2\\mu v_y - \\frac{2}{3}\\mu(u_x + v_y + w_z) & 2\\mu w_z - \\frac{2}{3}\\mu(u_x + v_y + w_z) & \\mu(u_y + v_x) & \\mu(u_z + w_x) & \\mu(v_z + w_y)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With the general form of the stress tensor established, the next step is to apply it to physically relevant flow fields. This practice involves calculating the normal stress components for an axisymmetric stagnation-point flow, a classic model for the region near the nose of a reentry vehicle or a pitot tube . This exercise will strengthen your skills in applying tensor calculus in cylindrical coordinates and interpreting the resulting stresses in a flow with significant extensional strain.",
            "id": "3980271",
            "problem": "In Computational Fluid Dynamics (CFD) for aerospace applications, consider a steady, axisymmetric stagnation flow of a compressible Newtonian fluid in cylindrical coordinates $(r,\\theta,z)$ with velocity components given by $u_{r}=-\\alpha r$, $u_{\\theta}=0$, and $u_{z}=2\\alpha z$, where $\\alpha>0$ is a constant characterizing the strain rate near a blunt nosetip. The fluid has constant dynamic viscosity $\\mu$ and constant bulk (second) viscosity $\\lambda$, and is under a uniform thermodynamic pressure $p$.\n\nStarting from the definition of the rate-of-deformation tensor $\\mathbf{D}$ as the symmetric part of the velocity gradient in cylindrical coordinates and the compressible Newtonian constitutive relation for the Cauchy stress tensor $\\boldsymbol{\\sigma}$, derive expressions for the trace $\\operatorname{tr}(\\mathbf{D})$ and the three normal Cauchy stress components $\\sigma_{rr}$, $\\sigma_{\\theta\\theta}$, and $\\sigma_{zz}$ in terms of $\\alpha$, $\\mu$, $\\lambda$, and $p$. Assume axisymmetry and no dependence on $\\theta$. Report your final results as a single row vector containing, in order, $\\operatorname{tr}(\\mathbf{D})$, $\\sigma_{rr}$, $\\sigma_{\\theta\\theta}$, and $\\sigma_{zz}$. No numerical evaluation or rounding is required, and no units should be included in the reported final vector.",
            "solution": "The solution requires calculating the trace of the rate-of-deformation tensor, $\\operatorname{tr}(\\mathbf{D})$, and the normal components of the Cauchy stress tensor, $\\sigma_{rr}$, $\\sigma_{\\theta\\theta}$, and $\\sigma_{zz}$.\n\n**Step 1: Compute the Rate-of-Deformation Tensor $\\mathbf{D}$**\n\nThe velocity field in cylindrical coordinates $(r, \\theta, z)$ is given as $\\mathbf{u} = u_r \\mathbf{e}_r + u_\\theta \\mathbf{e}_\\theta + u_z \\mathbf{e}_z$, where $u_r = -\\alpha r$, $u_\\theta = 0$, and $u_z = 2\\alpha z$.\n\nFirst, we compute the velocity gradient tensor, $\\nabla\\mathbf{u}$. In cylindrical coordinates, its components are:\n$$\n\\nabla\\mathbf{u} =\n\\begin{pmatrix}\n\\frac{\\partial u_r}{\\partial r} & \\frac{1}{r}\\left(\\frac{\\partial u_r}{\\partial \\theta} - u_\\theta\\right) & \\frac{\\partial u_r}{\\partial z} \\\\\n\\frac{\\partial u_\\theta}{\\partial r} & \\frac{1}{r}\\left(\\frac{\\partial u_\\theta}{\\partial \\theta} + u_r\\right) & \\frac{\\partial u_\\theta}{\\partial z} \\\\\n\\frac{\\partial u_z}{\\partial r} & \\frac{1}{r}\\frac{\\partial u_z}{\\partial \\theta} & \\frac{\\partial u_z}{\\partial z}\n\\end{pmatrix}\n$$\nCalculating the partial derivatives from the given velocity field:\n-   $\\frac{\\partial u_r}{\\partial r} = -\\alpha$\n-   $\\frac{1}{r}\\left(\\frac{\\partial u_r}{\\partial \\theta} - u_\\theta\\right) = \\frac{1}{r}(0 - 0) = 0$\n-   $\\frac{1}{r}\\left(\\frac{\\partial u_\\theta}{\\partial \\theta} + u_r\\right) = \\frac{1}{r}(0 - \\alpha r) = -\\alpha$\n-   $\\frac{\\partial u_z}{\\partial z} = 2\\alpha$\n-   All other derivatives are zero.\n\nSubstituting these into the matrix for $\\nabla\\mathbf{u}$:\n$$\n\\nabla\\mathbf{u} =\n\\begin{pmatrix}\n-\\alpha & 0 & 0 \\\\\n0 & -\\alpha & 0 \\\\\n0 & 0 & 2\\alpha\n\\end{pmatrix}\n$$\nThe rate-of-deformation tensor $\\mathbf{D}$ is the symmetric part of $\\nabla\\mathbf{u}$: $\\mathbf{D} = \\frac{1}{2} \\left( \\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T \\right)$. Since the calculated $\\nabla\\mathbf{u}$ is a diagonal matrix, it is already symmetric, meaning $\\mathbf{D} = \\nabla\\mathbf{u}$. Its components are $D_{rr} = -\\alpha$, $D_{\\theta\\theta} = -\\alpha$, and $D_{zz} = 2\\alpha$.\n\n**Step 2: Calculate the Trace of $\\mathbf{D}$**\n\nThe trace of $\\mathbf{D}$, which is also the divergence of the velocity field $\\nabla \\cdot \\mathbf{u}$, is the sum of its diagonal components:\n$$\n\\operatorname{tr}(\\mathbf{D}) = D_{rr} + D_{\\theta\\theta} + D_{zz} = (-\\alpha) + (-\\alpha) + (2\\alpha) = 0\n$$\nThe first required quantity is $\\operatorname{tr}(\\mathbf{D}) = 0$. This indicates that the flow field is incompressible (isochoric).\n\n**Step 3: Compute the Normal Cauchy Stress Components**\n\nThe constitutive relation for a compressible Newtonian fluid gives the Cauchy stress tensor $\\boldsymbol{\\sigma}$ as:\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\mu\\mathbf{D} + \\lambda(\\operatorname{tr}(\\mathbf{D}))\\mathbf{I}\n$$\nwhere $p$ is the thermodynamic pressure, $\\mu$ is the dynamic viscosity, and $\\lambda$ is the second viscosity. Since we found that $\\operatorname{tr}(\\mathbf{D}) = 0$, the equation simplifies significantly:\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + 2\\mu\\mathbf{D}\n$$\nThe second viscosity $\\lambda$ has no effect on the stress for this particular flow. The normal components of the stress tensor are the diagonal elements:\n$$\n\\sigma_{rr} = -p + 2\\mu D_{rr} = -p + 2\\mu(-\\alpha) = -p - 2\\mu\\alpha\n$$\n$$\n\\sigma_{\\theta\\theta} = -p + 2\\mu D_{\\theta\\theta} = -p + 2\\mu(-\\alpha) = -p - 2\\mu\\alpha\n$$\n$$\n\\sigma_{zz} = -p + 2\\mu D_{zz} = -p + 2\\mu(2\\alpha) = -p + 4\\mu\\alpha\n$$\n\n**Step 4: Assemble the Final Result**\nThe four required quantities, assembled into a row vector, are $\\operatorname{tr}(\\mathbf{D})$, $\\sigma_{rr}$, $\\sigma_{\\theta\\theta}$, and $\\sigma_{zz}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & -p - 2\\mu\\alpha & -p - 2\\mu\\alpha & -p + 4\\mu\\alpha\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "In computational fluid dynamics, it is not enough for equations to be correct on paper; they must also be implemented correctly in code. This exercise introduces a cornerstone of software verification, the Method of Manufactured Solutions, to test a numerical implementation of the viscous stress operator . By deriving an exact source term for a chosen velocity field and then assessing the convergence rate of a discrete solver, you will gain hands-on experience in the rigorous process of building trust in simulation tools.",
            "id": "3980326",
            "problem": "Consider a two-dimensional, steady, periodic flow of a Newtonian fluid in the context of Aerospace Computational Fluid Dynamics (CFD). The Newtonian constitutive relation for a compressible fluid states that the viscous stress tensor $\\boldsymbol{\\tau}$ is given by $\\boldsymbol{\\tau} = \\mu \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{T} \\right) - \\frac{2}{3} \\mu (\\nabla \\cdot \\mathbf{u}) \\mathbf{I}$, where $\\mu$ is the dynamic viscosity, $\\mathbf{u}$ is the velocity field, and $\\mathbf{I}$ is the identity tensor. For a divergence-free velocity field, the term proportional to $\\nabla \\cdot \\mathbf{u}$ vanishes, and the constitutive relation reduces to $\\boldsymbol{\\tau} = \\mu \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{T} \\right)$.\n\nYou will use the Method of Manufactured Solutions to verify the second-order convergence of the discrete viscous operator. Start from the fundamental definitions of the Newtonian constitutive relation and vector calculus identities. Let the computational domain be $\\Omega = [0,1] \\times [0,1]$ with periodic boundary conditions in both directions. Define the exact velocity and viscosity fields by\n$$\n\\mathbf{u}(x,y) = \\begin{bmatrix}\n\\sin(2\\pi x)\\cos(2\\pi y) \\\\\n-\\cos(2\\pi x)\\sin(2\\pi y)\n\\end{bmatrix}, \\qquad\n\\mu(x,y) = \\mu_0 \\left[ 1 + \\alpha \\sin(2\\pi x)\\cos(2\\pi y) \\right],\n$$\nwhere $\\mu_0 > 0$ is a constant and $\\alpha$ is a dimensionless parameter controlling the spatial variation of $\\mu(x,y)$.\n\nLet the continuous viscous operator be defined as\n$$\n\\mathbf{L}[\\mathbf{u}] = \\nabla \\cdot \\boldsymbol{\\tau}, \\quad \\text{with} \\quad \\boldsymbol{\\tau} = \\mu \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T \\right).\n$$\nDefine the manufactured forcing field $\\mathbf{f}(x,y)$ by $\\mathbf{f}(x,y) = \\mathbf{L}[\\mathbf{u}(x,y)]$. Derive, from first principles and by direct differentiation of the given fields, closed-form expressions for the components $f_1(x,y)$ and $f_2(x,y)$ of $\\mathbf{f}(x,y)$. Do not use pre-derived shortcut formulas for vector operators; proceed only from the definitions above and standard rules of differentiation.\n\nDiscretize $\\mathbf{L}[\\mathbf{u}]$ on a uniform $N \\times N$ grid with periodic boundaries using second-order central differences. Specifically:\n- Use grid points $(x_i, y_j) = \\left( \\frac{i}{N}, \\frac{j}{N} \\right)$ for $i,j \\in \\{0,1,\\dots,N-1\\}$ with grid spacing $h = \\frac{1}{N}$.\n- Compute all spatial derivatives with second-order central differences under periodic boundary conditions.\n- Construct $\\boldsymbol{\\tau}$ at grid points by evaluating $\\mu$ and the symmetric gradient.\n- Compute $\\mathbf{L}_h[\\mathbf{u}]$ as the discrete divergence of $\\boldsymbol{\\tau}$ using second-order central differences.\n\nForm the discrete residual field\n$$\n\\mathbf{r}_h = \\mathbf{L}_h[\\mathbf{u}] - \\mathbf{f},\n$$\nand measure the discrete $L^2$ error norm\n$$\nE_h = \\left( \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} \\left[ r_{h,1}(x_i,y_j)^2 + r_{h,2}(x_i,y_j)^2 \\right] \\right)^{1/2} h,\n$$\nwhich is an approximation to the continuous $L^2$ norm. For each case below, compute $E_h$ for $N \\in \\{16,32,64,128\\}$ and estimate the empirical convergence order $p$ using the two finest grid sizes via\n$$\np = \\frac{\\log(E_{h_1}/E_{h_2})}{\\log(h_1/h_2)},\n$$\nwith $h_1 = \\frac{1}{64}$ and $h_2 = \\frac{1}{128}$.\n\nTest Suite:\n- Case A (general variation): $\\mu_0 = 1$, $\\alpha = 0.3$.\n- Case B (constant viscosity boundary case): $\\mu_0 = 1$, $\\alpha = 0$.\n- Case C (strong variation edge case): $\\mu_0 = 1$, $\\alpha = 0.9$.\n\nYour program must compute the empirical order $p$ for each case and produce a single line of output containing the three values $[p_A,p_B,p_C]$ as a comma-separated list enclosed in square brackets. The output values are dimensionless floats. No physical units or angles are required. The program must be self-contained and must not read any input.",
            "solution": "The problem is valid as it is scientifically grounded, self-contained, and well-posed. The task involves deriving a manufactured source term for the viscous part of the Navier-Stokes equations and verifying the convergence order of a corresponding finite difference discretization, which is a standard procedure in computational fluid dynamics (CFD) code verification. The provided velocity field is divergence-free, justifying the use of the simplified constitutive relation for an incompressible fluid. All parameters and functions are well-defined.\n\nThe solution is developed in two stages. First, the analytical expression for the manufactured source term $\\mathbf{f}(x,y)$ is derived from first principles. Second, a numerical scheme is outlined to discretize the viscous operator, compute the numerical error against the exact source term, and determine the empirical order of convergence.\n\n**1. Analytical Derivation of the Manufactured Source Term**\n\nThe manufactured source term $\\mathbf{f}$ is defined as the action of the continuous viscous operator $\\mathbf{L}[\\mathbf{u}]$ on the exact velocity field $\\mathbf{u}(x,y)$. The operator is $\\mathbf{L}[\\mathbf{u}] = \\nabla \\cdot \\boldsymbol{\\tau}$, where $\\boldsymbol{\\tau} = \\mu \\left( \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T \\right)$. The derivation proceeds by calculating each component systematically.\n\nLet $k=2\\pi$. The velocity field components are $u_1(x,y) = \\sin(kx)\\cos(ky)$ and $u_2(x,y) = -\\cos(kx)\\sin(ky)$. The viscosity field is $\\mu(x,y) = \\mu_0 [1 + \\alpha u_1(x,y)]$.\n\nFirst, we compute the velocity gradient tensor, $\\nabla \\mathbf{u}$:\n$$\n\\nabla \\mathbf{u} = \\begin{bmatrix}\n\\frac{\\partial u_1}{\\partial x} & \\frac{\\partial u_1}{\\partial y} \\\\\n\\frac{\\partial u_2}{\\partial x} & \\frac{\\partial u_2}{\\partial y}\n\\end{bmatrix}\n$$\nThe partial derivatives of the velocity components are:\n$$\n\\frac{\\partial u_1}{\\partial x} = k \\cos(kx)\\cos(ky)\n$$\n$$\n\\frac{\\partial u_1}{\\partial y} = -k \\sin(kx)\\sin(ky)\n$$\n$$\n\\frac{\\partial u_2}{\\partial x} = k \\sin(kx)\\sin(ky)\n$$\n$$\n\\frac{\\partial u_2}{\\partial y} = -k \\cos(kx)\\cos(ky)\n$$\nThe velocity field is divergence-free, as $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u_1}{\\partial x} + \\frac{\\partial u_2}{\\partial y} = k\\cos(kx)\\cos(ky) - k\\cos(kx)\\cos(ky) = 0$.\n\nThe velocity gradient tensor is:\n$$\n\\nabla \\mathbf{u} = k \\begin{bmatrix}\n\\cos(kx)\\cos(ky) & -\\sin(kx)\\sin(ky) \\\\\n\\sin(kx)\\sin(ky) & -\\cos(kx)\\cos(ky)\n\\end{bmatrix}\n$$\nNext, we form the tensor $\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T$:\n$$\n\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T = k \\begin{bmatrix}\n2\\cos(kx)\\cos(ky) & 0 \\\\\n0 & -2\\cos(kx)\\cos(ky)\n\\end{bmatrix}\n$$\nThe viscous stress tensor $\\boldsymbol{\\tau}$ is then:\n$$\n\\boldsymbol{\\tau} = \\mu \\left(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T\\right) = 2k\\mu \\begin{bmatrix}\n\\cos(kx)\\cos(ky) & 0 \\\\\n0 & -\\cos(kx)\\cos(ky)\n\\end{bmatrix}\n$$\nThe components of the stress tensor are $\\tau_{11} = 2k\\mu\\cos(kx)\\cos(ky)$, $\\tau_{22} = -2k\\mu\\cos(kx)\\cos(ky) = -\\tau_{11}$, and $\\tau_{12} = \\tau_{21} = 0$.\n\nThe source term $\\mathbf{f} = \\nabla \\cdot \\boldsymbol{\\tau}$ has components $f_1 = \\frac{\\partial \\tau_{11}}{\\partial x} + \\frac{\\partial \\tau_{12}}{\\partial y}$ and $f_2 = \\frac{\\partial \\tau_{21}}{\\partial x} + \\frac{\\partial \\tau_{22}}{\\partial y}$. Since the off-diagonal terms are zero, this simplifies to $f_1 = \\frac{\\partial \\tau_{11}}{\\partial x}$ and $f_2 = \\frac{\\partial \\tau_{22}}{\\partial y}$.\n\nWe now compute these partial derivatives.\nFor $f_1 = \\frac{\\partial \\tau_{11}}{\\partial x}$:\n$$\n\\tau_{11} = 2k \\mu_0 [1 + \\alpha \\sin(kx)\\cos(ky)] \\cos(kx)\\cos(ky)\n= 2k\\mu_0 [\\cos(kx)\\cos(ky) + \\alpha \\sin(kx)\\cos(kx)\\cos^2(ky)]\n$$\nUsing the product rule and chain rule for differentiation with respect to $x$:\n$$\nf_1 = \\frac{\\partial \\tau_{11}}{\\partial x} = 2k\\mu_0 \\left[ -k\\sin(kx)\\cos(ky) + \\alpha \\cos^2(ky) \\frac{\\partial}{\\partial x}(\\sin(kx)\\cos(kx)) \\right]\n$$\nSince $\\frac{\\partial}{\\partial x}(\\sin(kx)\\cos(kx)) = \\frac{\\partial}{\\partial x}(\\frac{1}{2}\\sin(2kx)) = k\\cos(2kx)$, we have:\n$$\nf_1(x,y) = 2k\\mu_0 [-k\\sin(kx)\\cos(ky) + \\alpha k \\cos(2kx)\\cos^2(ky)]\n$$\nSubstituting $k=2\\pi$:\n$$\nf_1(x,y) = 8\\pi^2\\mu_0 [-\\sin(2\\pi x)\\cos(2\\pi y) + \\alpha \\cos(4\\pi x)\\cos^2(2\\pi y)]\n$$\nFor $f_2 = \\frac{\\partial \\tau_{22}}{\\partial y} = -\\frac{\\partial \\tau_{11}}{\\partial y}$:\n$$\n\\frac{\\partial \\tau_{11}}{\\partial y} = 2k\\mu_0 \\left[ \\frac{\\partial}{\\partial y}(\\cos(kx)\\cos(ky)) + \\alpha \\sin(kx)\\cos(kx) \\frac{\\partial}{\\partial y}(\\cos^2(ky)) \\right]\n$$\n$$\n\\frac{\\partial \\tau_{11}}{\\partial y} = 2k\\mu_0 [\\cos(kx)(-k\\sin(ky)) + \\alpha \\sin(kx)\\cos(kx)(2\\cos(ky)(-k\\sin(ky)))]\n$$\n$$\n\\frac{\\partial \\tau_{11}}{\\partial y} = -2k^2\\mu_0 [\\cos(kx)\\sin(ky) + \\alpha \\sin(kx)\\cos(kx)\\sin(2ky)]\n$$\nTherefore, $f_2 = -\\frac{\\partial \\tau_{11}}{\\partial y}$:\n$$\nf_2(x,y) = 2k^2\\mu_0 [\\cos(kx)\\sin(ky) + \\alpha \\sin(kx)\\cos(kx)\\sin(2ky)]\n$$\nSubstituting $k=2\\pi$ and simplifying the trigonometric term:\n$$\nf_2(x,y) = 8\\pi^2\\mu_0 \\left[\\cos(2\\pi x)\\sin(2\\pi y) + \\frac{\\alpha}{2}\\sin(4\\pi x)\\sin(4\\pi y)\\right]\n$$\nThese analytical expressions for $f_1$ and $f_2$ will be used to compute the exact source term on the grid.\n\n**2. Numerical Discretization and Convergence Analysis**\n\nThe continuous domain $\\Omega = [0,1] \\times [0,1]$ is discretized into a uniform grid of $N \\times N$ points, $(x_i, y_j) = (ih, jh)$, where $h=1/N$ and $i, j \\in \\{0, 1, \\dots, N-1\\}$. All spatial derivatives are approximated using second-order central difference schemes, which are suitable for the periodic boundary conditions. For a generic grid function $g_{i,j}$, the discrete derivatives are:\n$$\nD_x(g)_{i,j} = \\frac{g_{i+1,j} - g_{i-1,j}}{2h}, \\quad D_y(g)_{i,j} = \\frac{g_{i,j+1} - g_{i,j-1}}{2h}\n$$\nIndices are handled periodically, e.g., $g_{N,j} = g_{0,j}$ and $g_{-1,j} = g_{N-1,j}$.\n\nThe numerical procedure for a given grid size $N$ is as follows:\n1.  Evaluate the exact velocity fields $u_1, u_2$ and viscosity $\\mu$ at all grid points $(x_i, y_j)$.\n2.  Compute the discrete velocity gradient components: $D_x(u_1)$, $D_y(u_1)$, $D_x(u_2)$, and $D_y(u_2)$.\n3.  Construct the discrete stress tensor components at each grid point:\n    $$ \\tau_{h,11} = \\mu (2 D_x(u_1)) $$\n    $$ \\tau_{h,12} = \\mu (D_y(u_1) + D_x(u_2)) $$\n    $$ \\tau_{h,22} = \\mu (2 D_y(u_2)) $$\n4.  Compute the discrete viscous operator $\\mathbf{L}_h[\\mathbf{u}]$ by taking the discrete divergence of $\\boldsymbol{\\tau}_h$:\n    $$ L_{h,1} = D_x(\\tau_{h,11}) + D_y(\\tau_{h,12}) $$\n    $$ L_{h,2} = D_x(\\tau_{h,12}) + D_y(\\tau_{h,22}) $$\n5.  Evaluate the exact source terms $f_1, f_2$ from the derived analytical expressions at all grid points.\n6.  Calculate the discrete residual field $\\mathbf{r}_h = \\mathbf{L}_h[\\mathbf{u}] - \\mathbf{f}$.\n7.  Compute the discrete $L^2$ error norm $E_h$:\n    $$ E_h = \\left( \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} \\left[ r_{h,1}(x_i,y_j)^2 + r_{h,2}(x_i,y_j)^2 \\right] \\right)^{1/2} h $$\nThis procedure is repeated for a sequence of refining grids, $N \\in \\{16, 32, 64, 128\\}$. The empirical order of convergence, $p$, is estimated from the errors on the two finest grids ($N_1=64, N_2=128$) using the formula:\n$$ p = \\frac{\\log(E_{h_1}/E_{h_2})}{\\log(h_1/h_2)} = \\frac{\\log(E_{64}/E_{128})}{\\log(2)} $$\nSince the manufactured solution is smooth (analytic) and the discretization scheme is a second-order central difference, the expected order of convergence is $p=2$. The implementation will carry out this procedure for the three specified cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the three test cases.\n    It computes the empirical order of convergence for each case and prints the results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.3),  # Case A\n        (1.0, 0.0),  # Case B\n        (1.0, 0.9),  # Case C\n    ]\n\n    results = []\n    for mu0, alpha in test_cases:\n        p = calculate_convergence_order(mu0, alpha)\n        results.append(p)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\n\ndef calculate_convergence_order(mu0, alpha):\n    \"\"\"\n    Calculates the empirical order of convergence for a given set of\n    physical parameters mu0 and alpha.\n    \"\"\"\n    grid_sizes = [16, 32, 64, 128]\n    errors = []\n\n    for N in grid_sizes:\n        h = 1.0 / N\n        \n        # 1. Create grid and evaluate exact fields\n        x = np.linspace(0.0, 1.0, N, endpoint=False)\n        xx, yy = np.meshgrid(x, x, indexing='ij')\n\n        k = 2.0 * np.pi\n        \n        # Exact velocity field\n        u1 = np.sin(k * xx) * np.cos(k * yy)\n        u2 = -np.cos(k * xx) * np.sin(k * yy)\n        \n        # Exact viscosity field\n        mu = mu0 * (1.0 + alpha * u1)\n        \n        # Exact manufactured forcing field f(x,y)\n        # f1(x,y) = 8*pi^2*mu0 * [-sin(2*pi*x)*cos(2*pi*y) + alpha*cos(4*pi*x)*cos^2(2*pi*y)]\n        term1_f1 = -np.sin(k * xx) * np.cos(k * yy)\n        term2_f1 = alpha * np.cos(2.0 * k * xx) * np.cos(k * yy)**2\n        f1 = 8.0 * np.pi**2 * mu0 * (term1_f1 + term2_f1)\n        \n        # f2(x,y) = 8*pi^2*mu0 * [cos(2*pi*x)*sin(2*pi*y) + (alpha/2)*sin(4*pi*x)*sin(4*pi*y)]\n        term1_f2 = np.cos(k * xx) * np.sin(k * yy)\n        term2_f2 = (alpha / 2.0) * np.sin(2.0 * k * xx) * np.sin(2.0 * k * yy)\n        f2 = 8.0 * np.pi**2 * mu0 * (term1_f2 + term2_f2)\n\n        # 2. Compute discrete viscous operator L_h[u]\n        \n        # Discrete derivatives using second-order central differences with periodic BCs\n        def central_diff_x(field):\n            return (np.roll(field, -1, axis=0) - np.roll(field, 1, axis=0)) / (2.0 * h)\n        \n        def central_diff_y(field):\n            return (np.roll(field, -1, axis=1) - np.roll(field, 1, axis=1)) / (2.0 * h)\n\n        # Discrete velocity gradient\n        du1_dx = central_diff_x(u1)\n        du1_dy = central_diff_y(u1)\n        du2_dx = central_diff_x(u2)\n        du2_dy = central_diff_y(u2)\n        \n        # Discrete stress tensor tau_h\n        tau_h_11 = mu * (2.0 * du1_dx)\n        tau_h_12 = mu * (du1_dy + du2_dx)\n        tau_h_22 = mu * (2.0 * du2_dy)\n        \n        # Discrete divergence of stress tensor -> L_h[u]\n        L_h_1 = central_diff_x(tau_h_11) + central_diff_y(tau_h_12)\n        L_h_2 = central_diff_x(tau_h_12) + central_diff_y(tau_h_22)\n        \n        # 3. Form discrete residual and compute L2 error norm\n        r_h_1 = L_h_1 - f1\n        r_h_2 = L_h_2 - f2\n        \n        # E_h = ||r_h||_L2 * h, where ||.||_L2 is the discrete L2 norm.\n        # The grid spacing h multiplication converts the sum into an integral approximation.\n        error_norm = np.sqrt(np.sum(r_h_1**2 + r_h_2**2)) * h\n        errors.append(error_norm)\n\n    # 4. Estimate empirical convergence order\n    # p = log(E_h1 / E_h2) / log(h1 / h2), where h1/h2 = 2\n    E_h1 = errors[2]  # N=64\n    E_h2 = errors[3]  # N=128\n    \n    p = np.log(E_h1 / E_h2) / np.log(2.0)\n    \n    return p\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}