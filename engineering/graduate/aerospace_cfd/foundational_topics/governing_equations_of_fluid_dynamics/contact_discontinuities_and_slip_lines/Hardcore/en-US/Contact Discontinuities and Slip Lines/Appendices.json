{
    "hands_on_practices": [
        {
            "introduction": "The accurate simulation of contact discontinuities is a benchmark for any CFD solver, yet even the most fundamental numerical schemes can struggle. This exercise uses modified equation analysis to reveal a crucial concept: the truncation error of a simple first-order upwind scheme does not just reduce accuracy, it actively introduces a non-physical, dissipative term. By working through this problem , you will derive the effective numerical diffusion coefficient, providing a quantitative understanding of why sharp features get smeared and how this effect scales with grid size $\\Delta x$ and flow speed $|u|$.",
            "id": "3950570",
            "problem": "Consider a one-dimensional inviscid compressible flow governed by the Euler equations, containing a planar contact discontinuity aligned with the computational grid. For a contact discontinuity, the pressure and normal velocity are continuous across the interface, and only the density (or a passive scalar) exhibits a jump. In Computational Fluid Dynamics (CFD), the propagation of such a contact discontinuity through a uniform grid at constant normal velocity can be locally modeled by the scalar linear advection equation\n$$\n\\frac{\\partial q}{\\partial t} + \\frac{\\partial}{\\partial x}\\left( u\\, q \\right) = 0,\n$$\nwhere $q(x,t)$ represents the advected quantity (e.g., density for a contact wave), and $u$ is the constant normal advection speed. A similar local normal-advection description applies to a slip line in two-dimensional Euler flows, for which the discontinuity is in tangential velocity while the normal advection speed remains continuous.\n\nYou are to analyze the numerical diffusion introduced by a first-order Godunov finite volume method using upwind fluxes on a uniform grid of spacing $\\Delta x$. In its semi-discrete form (continuous time, discrete space), this method advances the cell averages $q_i(t)$ using an upwind numerical flux based on the exact solution of the linear Riemann problem.\n\nTasks:\n1) Starting from the scalar conservation law above, write the semi-discrete finite volume update for $q_i(t)$ on a uniform mesh using a first-order upwind Godunov flux for the case $u0$, and state the corresponding stencil for $u0$.\n\n2) Using a Taylor-series modified equation analysis about $x_i$, identify the leading-order dissipative term induced by this spatial discretization. Cast the resulting equivalent differential equation in the form\n$$\n\\frac{\\partial q}{\\partial t} + u\\,\\frac{\\partial q}{\\partial x} = D_{\\text{num}}\\,\\frac{\\partial^{2} q}{\\partial x^{2}} + \\text{higher-order terms},\n$$\nand determine the effective numerical diffusion coefficient $D_{\\text{num}}$ as a function of $\\Delta x$ and $u$.\n\n3) For a grid spacing $\\Delta x = 6.8 \\times 10^{-3}\\ \\text{m}$ and a normal contact speed $u = -315.4\\ \\text{m/s}$, compute the value of $D_{\\text{num}}$. Express the final diffusion coefficient in $\\text{m}^{2}\\!/\\text{s}$ and round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The provided problem statement describes the analysis of numerical diffusion for a first-order Godunov scheme applied to the linear advection equation, a standard and fundamental topic in computational fluid dynamics. The governing equation, the numerical method, the analysis technique (modified equation analysis), and all required parameters are clearly and correctly defined. The problem is a standard exercise in the numerical analysis of partial differential equations and contains no scientific flaws, ambiguities, or contradictions. The problem is therefore deemed valid and a full solution is warranted.\n\nThe problem is addressed in three parts as requested.\n\nPart 1: Semi-discrete finite volume update\n\nThe one-dimensional scalar conservation law is given by\n$$\n\\frac{\\partial q}{\\partial t} + \\frac{\\partial F(q)}{\\partial x} = 0,\n$$\nwhere the flux function is $F(q) = uq$ with $u$ being a constant advection speed.\n\nTo derive the semi-discrete finite volume scheme, we integrate the equation over a computational cell $i$, which spans the interval $[x_{i-1/2}, x_{i+1/2}]$. The width of this uniform cell is $\\Delta x = x_{i+1/2} - x_{i-1/2}$.\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial q}{\\partial t} \\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial F(q)}{\\partial x} \\,dx = 0\n$$\nThe cell average of $q$ in cell $i$ is defined as $q_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,t) \\,dx$. Assuming the grid is stationary, the first term becomes $\\frac{d}{dt} (\\Delta x q_i) = \\Delta x \\frac{dq_i}{dt}$. The second term is evaluated using the fundamental theorem of calculus:\n$$\n\\Delta x \\frac{dq_i}{dt} + F(q(x_{i+1/2}, t)) - F(q(x_{i-1/2}, t)) = 0\n$$\nIn a finite volume method, the exact fluxes at the cell interfaces, $F(q(x_{i\\pm1/2}, t))$, are replaced by numerical fluxes, denoted $\\hat{F}_{i\\pm1/2}$. The semi-discrete equation is then:\n$$\n\\frac{dq_i}{dt} = - \\frac{\\hat{F}_{i+1/2} - \\hat{F}_{i-1/2}}{\\Delta x}\n$$\nFor a first-order Godunov method, the numerical flux $\\hat{F}_{i+1/2}$ is determined by solving the Riemann problem at the interface $x_{i+1/2}$ with piecewise constant initial data $q_L = q_i$ and $q_R = q_{i+1}$. For the linear advection equation, the solution to the Riemann problem is a single contact wave moving with speed $u$. The value of $q$ along the interface line $x = x_{i+1/2}$ is determined by the direction of wave propagation.\nIf $u  0$, the wave propagates to the right, and the solution at the interface is the left state, $q_i$. The flux is $\\hat{F}_{i+1/2} = F(q_i) = uq_i$.\nIf $u  0$, the wave propagates to the left, and the solution at the interface is the right state, $q_{i+1}$. The flux is $\\hat{F}_{i+1/2} = F(q_{i+1}) = uq_{i+1}$.\nThis is the upwind flux selection rule.\n\nCase $u  0$:\nThe numerical fluxes are $\\hat{F}_{i+1/2} = uq_i$ and $\\hat{F}_{i-1/2} = uq_{i-1}$. Substituting these into the semi-discrete form gives:\n$$\n\\frac{dq_i}{dt} = - \\frac{u q_i - u q_{i-1}}{\\Delta x} = -u \\frac{q_i - q_{i-1}}{\\Delta x}\n$$\nThis scheme uses a backward-difference stencil involving cells $i-1$ and $i$.\n\nCase $u  0$:\nThe numerical fluxes are $\\hat{F}_{i+1/2} = uq_{i+1}$ and $\\hat{F}_{i-1/2} = uq_i$. Substituting these gives:\n$$\n\\frac{dq_i}{dt} = - \\frac{u q_{i+1} - u q_i}{\\Delta x} = -u \\frac{q_{i+1} - q_i}{\\Delta x}\n$$\nThis scheme uses a forward-difference stencil involving cells $i$ and $i+1$.\n\nPart 2: Modified equation analysis and numerical diffusion\n\nWe use Taylor-series expansion to find the partial differential equation that the semi-discrete scheme is actually solving. We replace the discrete cell averages $q_i$ with the continuous function $q(x_i, t)$ and its derivatives at a point $x_i$.\n\nFor $u  0$, the spatial discretization is $-u \\frac{q_i - q_{i-1}}{\\Delta x}$. We expand $q_{i-1} = q(x_i - \\Delta x, t)$ about $x_i$:\n$$\nq_{i-1} = q_i - \\Delta x \\frac{\\partial q}{\\partial x} \\bigg|_i + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 q}{\\partial x^2} \\bigg|_i - \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 q}{\\partial x^3} \\bigg|_i + O((\\Delta x)^4)\n$$\nSubstituting this into the semi-discrete equation:\n$$\n\\frac{dq_i}{dt} = -u \\frac{1}{\\Delta x} \\left(q_i - \\left[q_i - \\Delta x \\frac{\\partial q}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 q}{\\partial x^2} - \\dots \\right]\\right) \\bigg|_i\n$$\n$$\n\\frac{dq_i}{dt} = -u \\frac{1}{\\Delta x} \\left(\\Delta x \\frac{\\partial q}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 q}{\\partial x^2} + \\dots \\right) \\bigg|_i\n$$\n$$\n\\frac{\\partial q}{\\partial t} \\bigg|_i = -u \\frac{\\partial q}{\\partial x} \\bigg|_i + \\frac{u \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} \\bigg|_i + O((\\Delta x)^2)\n$$\nRearranging this modified equation to match the requested form:\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} = \\frac{u \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} + \\text{H.O.T.}\n$$\nThe leading-order error term is dissipative (an even-order derivative), and the numerical diffusion coefficient is $D_{\\text{num}} = \\frac{u \\Delta x}{2}$.\n\nFor $u  0$, the spatial discretization is $-u \\frac{q_{i+1} - q_i}{\\Delta x}$. We expand $q_{i+1} = q(x_i + \\Delta x, t)$ about $x_i$:\n$$\nq_{i+1} = q_i + \\Delta x \\frac{\\partial q}{\\partial x} \\bigg|_i + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 q}{\\partial x^2} \\bigg|_i + \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 q}{\\partial x^3} \\bigg|_i + O((\\Delta x)^4)\n$$\nSubstituting into the semi-discrete equation:\n$$\n\\frac{dq_i}{dt} = -u \\frac{1}{\\Delta x} \\left(\\left[q_i + \\Delta x \\frac{\\partial q}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 q}{\\partial x^2} + \\dots \\right] - q_i\\right) \\bigg|_i\n$$\n$$\n\\frac{dq_i}{dt} = -u \\left(\\frac{\\partial q}{\\partial x} + \\frac{\\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} + \\dots \\right) \\bigg|_i\n$$\n$$\n\\frac{\\partial q}{\\partial t} \\bigg|_i = -u \\frac{\\partial q}{\\partial x} \\bigg|_i - \\frac{u \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} \\bigg|_i + O((\\Delta x)^2)\n$$\nRearranging this modified equation:\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} = - \\frac{u \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} + \\text{H.O.T.}\n$$\nThe numerical diffusion coefficient is $D_{\\text{num}} = -\\frac{u \\Delta x}{2}$.\n\nBoth cases ($u  0$ and $u  0$) can be expressed by a single formula using the absolute value of $u$:\n$$\nD_{\\text{num}} = \\frac{|u| \\Delta x}{2}\n$$\nThis expression is always non-negative, which is a physical requirement for a diffusion coefficient, as diffusion is an irreversible, entropy-increasing process.\n\nPart 3: Numerical computation\n\nGiven the grid spacing $\\Delta x = 6.8 \\times 10^{-3}\\ \\text{m}$ and normal contact speed $u = -315.4\\ \\text{m/s}$.\nSince $u  0$, we use the formula $D_{\\text{num}} = -\\frac{u \\Delta x}{2}$, or the general form $D_{\\text{num}} = \\frac{|u| \\Delta x}{2}$.\n$$\nD_{\\text{num}} = \\frac{|-315.4\\ \\text{m/s}| \\times (6.8 \\times 10^{-3}\\ \\text{m})}{2}\n$$\n$$\nD_{\\text{num}} = \\frac{315.4 \\times 6.8 \\times 10^{-3}}{2}\\ \\frac{\\text{m}^2}{\\text{s}}\n$$\n$$\nD_{\\text{num}} = \\frac{2144.72 \\times 10^{-3}}{2}\\ \\frac{\\text{m}^2}{\\text{s}}\n$$\n$$\nD_{\\text{num}} = 1072.36 \\times 10^{-3}\\ \\frac{\\text{m}^2}{\\text{s}} = 1.07236\\ \\frac{\\text{m}^2}{\\text{s}}\n$$\nThe problem requires the answer to be rounded to four significant figures. The fifth significant digit is $3$, so we round down.\n$$\nD_{\\text{num}} \\approx 1.072\\ \\frac{\\text{m}^2}{\\text{s}}\n$$",
            "answer": "$$\n\\boxed{1.072}\n$$"
        },
        {
            "introduction": "While higher-order reconstruction methods are designed to combat the numerical diffusion seen in simpler schemes, they can introduce their own subtle but significant errors. This practice explores a classic pitfall where the non-linear relationship between conserved and primitive variables leads to unphysical results at contact discontinuities. You will demonstrate how linearly interpolating the specific total energy $E$ across a contact, where density $\\rho$ jumps but pressure $p$ should be constant, generates spurious pressure oscillations, and then derive a pressure-based correction to enforce the physical invariant .",
            "id": "3950585",
            "problem": "Consider the one-dimensional compressible Euler equations for a calorically perfect gas with ratio of specific heats $\\gamma$. Across a contact discontinuity aligned with the grid and normal to the $x$-axis, the exact solution satisfies the invariants that the normal velocity and pressure are constant while the density may jump. Let two adjacent control volumes in a finite-volume Computational Fluid Dynamics (CFD) discretization have cell-averaged left and right primitive states $(\\rho_{L}, u_{L}, p_{L})$ and $(\\rho_{R}, u_{R}, p_{R})$, respectively, with \n$$u_{L} = u_{R} = u_{0}, \\quad p_{L} = p_{R} = p_{0}, \\quad \\rho_{L} \\neq \\rho_{R}.$$\nAssume piecewise-linear reconstruction in the primitive set $\\{\\rho, u, E\\}$, where $E$ is the specific total energy. At a face located between the two cells, define an interpolation weight $\\alpha \\in (0,1)$ so that the reconstructed face values are\n$$\\rho_{f} = \\alpha \\rho_{L} + (1 - \\alpha) \\rho_{R}, \\quad u_{f} = \\alpha u_{L} + (1 - \\alpha) u_{R}, \\quad E_{f} = \\alpha E_{L} + (1 - \\alpha) E_{R}.$$\nUse the ideal-gas equation of state $p = (\\gamma - 1)\\rho e$ with $E = e + \\tfrac{1}{2} u^{2}$ to express $E_{L}$ and $E_{R}$ in terms of $(\\rho_{L}, u_{0}, p_{0})$ and $(\\rho_{R}, u_{0}, p_{0})$. Then:\n\n1) Starting only from the stated invariants of a contact and the ideal-gas equation of state, derive the reconstructed face pressure obtained by recovering pressure from $(\\rho_{f}, u_{f}, E_{f})$ as\n$$p_{f} = (\\gamma - 1)\\,\\rho_{f}\\left(E_{f} - \\tfrac{1}{2} u_{f}^{2}\\right).$$\nShow explicitly that $p_{f}$ generally differs from $p_{0}$ when $\\rho_{L} \\neq \\rho_{R}$, and simplify $p_{f}$ to a closed-form expression involving only $\\alpha$, $\\rho_{L}$, $\\rho_{R}$, and $p_{0}$.\n\n2) Propose a pressure-based correction that eliminates the spurious pressure variation at the face by reconstructing pressure instead of specific total energy. Derive an explicit expression for a corrected face specific total energy $E_{f}^{\\mathrm{corr}}$ that guarantees the recovered face pressure equals $p_{0}$ under the given contact conditions.\n\nProvide, as your final answer, the simplified closed-form expression from part (1) for $p_{f}$ as a function of $\\alpha$, $\\rho_{L}$, $\\rho_{R}$, and $p_{0}$. No numerical substitution is required. If you later evaluate it numerically, express pressure in Pascals.",
            "solution": "The problem is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Model:** One-dimensional compressible Euler equations.\n- **Gas Type:** Calorically perfect gas with ratio of specific heats $\\gamma$.\n- **Phenomenon:** Contact discontinuity normal to the $x$-axis.\n- **Exact Invariants:** Normal velocity and pressure are constant across the discontinuity. Density may jump.\n- **Discretization:** Finite-volume method.\n- **Cell-Averaged States:**\n  - Left: $(\\rho_{L}, u_{L}, p_{L})$\n  - Right: $(\\rho_{R}, u_{R}, p_{R})$\n- **Contact Conditions:**\n  - $u_{L} = u_{R} = u_{0}$\n  - $p_{L} = p_{R} = p_{0}$\n  - $\\rho_{L} \\neq \\rho_{R}$\n- **Reconstruction:** Piecewise-linear in the set $\\{\\rho, u, E\\}$, where $E$ is specific total energy.\n- **Face Interpolation:**\n  - Weight: $\\alpha \\in (0,1)$\n  - Reconstructed face values:\n    - $\\rho_{f} = \\alpha \\rho_{L} + (1 - \\alpha) \\rho_{R}$\n    - $u_{f} = \\alpha u_{L} + (1 - \\alpha) u_{R}$\n    - $E_{f} = \\alpha E_{L} + (1 - \\alpha) E_{R}$\n- **Equation of State:** $p = (\\gamma - 1)\\rho e$, where $e$ is specific internal energy.\n- **Total Energy Definition:** $E = e + \\tfrac{1}{2} u^{2}$.\n- **Task 1:** Derive the recovered face pressure $p_{f} = (\\gamma - 1)\\,\\rho_{f}(E_{f} - \\tfrac{1}{2} u_{f}^{2})$. Show $p_{f} \\neq p_{0}$ and simplify $p_{f}$ to a closed-form expression in terms of $\\alpha$, $\\rho_{L}$, $\\rho_{R}$, and $p_{0}$.\n- **Task 2:** Propose a pressure-based correction by deriving a corrected face specific total energy $E_{f}^{\\mathrm{corr}}$ that ensures the recovered face pressure is $p_{0}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It addresses a fundamental and well-known issue in the numerical solution of the Euler equations: the generation of spurious pressure oscillations at contact discontinuities when non-linear quantities like total energy are linearly interpolated. The setup is self-contained, lacking contradictions, and all terms are formally defined. The problem is a standard theoretical exercise in computational fluid dynamics and does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution\n\nThis problem investigates a numerical artifact arising from a common finite-volume reconstruction technique when applied to a contact discontinuity.\n\n**Part 1: Derivation of the Spurious Face Pressure**\n\nFirst, we express the specific total energy $E$ in terms of the primitive variables $(\\rho, u, p)$. The ideal-gas equation of state is $p = (\\gamma - 1)\\rho e$, which gives the specific internal energy as $e = \\frac{p}{(\\gamma - 1)\\rho}$. Substituting this into the definition of specific total energy, $E = e + \\frac{1}{2}u^2$, we get:\n$$E = \\frac{p}{(\\gamma - 1)\\rho} + \\frac{1}{2}u^2$$\nUsing this relationship, we find the specific total energies for the left and right cell-averaged states, subject to the given contact conditions $u_{L} = u_{R} = u_{0}$ and $p_{L} = p_{R} = p_{0}$:\n$$E_{L} = \\frac{p_{L}}{(\\gamma - 1)\\rho_{L}} + \\frac{1}{2}u_{L}^{2} = \\frac{p_{0}}{(\\gamma - 1)\\rho_{L}} + \\frac{1}{2}u_{0}^{2}$$\n$$E_{R} = \\frac{p_{R}}{(\\gamma - 1)\\rho_{R}} + \\frac{1}{2}u_{R}^{2} = \\frac{p_{0}}{(\\gamma - 1)\\rho_{R}} + \\frac{1}{2}u_{0}^{2}$$\nNext, we determine the reconstructed values at the cell face. The density $\\rho_{f}$ is given as:\n$$\\rho_{f} = \\alpha \\rho_{L} + (1 - \\alpha) \\rho_{R}$$\nThe face velocity $u_{f}$ is:\n$$u_{f} = \\alpha u_{L} + (1 - \\alpha) u_{R} = \\alpha u_{0} + (1 - \\alpha) u_{0} = u_{0}$$\nThe face specific total energy $E_{f}$ is obtained by interpolating $E_{L}$ and $E_{R}$:\n$$E_{f} = \\alpha E_{L} + (1 - \\alpha) E_{R}$$\nSubstituting the expressions for $E_{L}$ and $E_{R}$:\n$$E_{f} = \\alpha \\left( \\frac{p_{0}}{(\\gamma - 1)\\rho_{L}} + \\frac{1}{2}u_{0}^{2} \\right) + (1 - \\alpha) \\left( \\frac{p_{0}}{(\\gamma - 1)\\rho_{R}} + \\frac{1}{2}u_{0}^{2} \\right)$$\n$$E_{f} = \\frac{p_{0}}{\\gamma - 1} \\left( \\frac{\\alpha}{\\rho_{L}} + \\frac{1 - \\alpha}{\\rho_{R}} \\right) + \\left( \\alpha + 1 - \\alpha \\right) \\frac{1}{2}u_{0}^{2}$$\n$$E_{f} = \\frac{p_{0}}{\\gamma - 1} \\left( \\frac{\\alpha}{\\rho_{L}} + \\frac{1 - \\alpha}{\\rho_{R}} \\right) + \\frac{1}{2}u_{0}^{2}$$\nNow, we recover the face pressure $p_{f}$ from these reconstructed quantities using the formula $p_f = (\\gamma - 1)\\rho_f (E_f - \\frac{1}{2}u_f^2)$. We have $u_f = u_0$, so the specific kinetic energy term is $\\frac{1}{2}u_0^2$. The specific internal energy at the face is:\n$$e_{f} = E_{f} - \\frac{1}{2}u_{f}^{2} = E_{f} - \\frac{1}{2}u_{0}^{2} = \\frac{p_{0}}{\\gamma - 1} \\left( \\frac{\\alpha}{\\rho_{L}} + \\frac{1 - \\alpha}{\\rho_{R}} \\right)$$\nThe recovered face pressure $p_{f}$ is then:\n$$p_{f} = (\\gamma - 1)\\rho_{f} e_{f} = (\\gamma - 1) (\\alpha \\rho_{L} + (1 - \\alpha) \\rho_{R}) \\left[ \\frac{p_{0}}{\\gamma - 1} \\left( \\frac{\\alpha}{\\rho_{L}} + \\frac{1 - \\alpha}{\\rho_{R}} \\right) \\right]$$\nThe factor of $(\\gamma - 1)$ cancels, yielding the simplified closed-form expression for $p_{f}$:\n$$p_{f} = p_{0} \\left( \\alpha \\rho_{L} + (1 - \\alpha) \\rho_{R} \\right) \\left( \\frac{\\alpha}{\\rho_{L}} + \\frac{1 - \\alpha}{\\rho_{R}} \\right)$$\nTo show that $p_{f}$ generally differs from $p_{0}$, consider the term multiplying $p_{0}$. Let $x = \\rho_{L}$ and $y = \\rho_{R}$. For positive $x, y$ and weights $\\alpha \\in (0,1)$, the Cauchy-Schwarz inequality in Sedrakyan's form states that $(\\alpha x + (1-\\alpha)y)(\\frac{\\alpha}{x} + \\frac{1-\\alpha}{y}) \\ge 1$. Equality holds if and only if $x=y$. Since the problem states $\\rho_{L} \\neq \\rho_{R}$, the inequality is strict:\n$$\\left( \\alpha \\rho_{L} + (1 - \\alpha) \\rho_{R} \\right) \\left( \\frac{\\alpha}{\\rho_{L}} + \\frac{1 - \\alpha}{\\rho_{R}} \\right) > 1$$\nTherefore, $p_{f} > p_{0}$ whenever $\\rho_{L} \\neq \\rho_{R}$. This demonstrates that linearly interpolating the specific total energy generates a spurious pressure increase at the contact discontinuity, violating the physical invariant $p = constant$.\n\n**Part 2: Pressure-Based Correction**\n\nThe source of the error is the non-linear relationship between pressure and the interpolated quantities. To eliminate the spurious pressure, we must enforce the pressure-constancy condition at the face. We propose a correction where we define a new face specific total energy, $E_{f}^{\\mathrm{corr}}$, such that recovering the pressure from the set $(\\rho_f, u_f, E_f^{\\mathrm{corr}})$ yields exactly $p_0$.\n\nThe desired condition is:\n$$p_{0} = (\\gamma - 1) \\rho_{f} \\left( E_{f}^{\\mathrm{corr}} - \\frac{1}{2} u_{f}^{2} \\right)$$\nWe use the previously calculated values for $\\rho_{f}$ and $u_{f} = u_{0}$:\n$$p_{0} = (\\gamma - 1) (\\alpha \\rho_{L} + (1 - \\alpha) \\rho_{R}) \\left( E_{f}^{\\mathrm{corr}} - \\frac{1}{2} u_{0}^{2} \\right)$$\nWe can now algebraically solve for $E_{f}^{\\mathrm{corr}}$:\n$$E_{f}^{\\mathrm{corr}} - \\frac{1}{2} u_{0}^{2} = \\frac{p_{0}}{(\\gamma - 1) (\\alpha \\rho_{L} + (1 - \\alpha) \\rho_{R})}$$\nThis gives the explicit expression for the corrected face specific total energy:\n$$E_{f}^{\\mathrm{corr}} = \\frac{p_{0}}{(\\gamma - 1) (\\alpha \\rho_{L} + (1 - \\alpha) \\rho_{R})} + \\frac{1}{2} u_{0}^{2}$$\nBy using this $E_{f}^{\\mathrm{corr}}$ instead of the directly interpolated $E_{f}$, a numerical scheme can reconstruct the face state in a way that correctly preserves the constant pressure across the stationary contact discontinuity, thus avoiding the generation of spurious oscillations. This is conceptually equivalent to interpolating primitive variables like $(\\rho, u, p)$ and then reconstructing the conservative variables if needed.",
            "answer": "$$\\boxed{p_{0} \\left( \\alpha \\rho_{L} + (1 - \\alpha) \\rho_{R} \\right) \\left( \\frac{\\alpha}{\\rho_{L}} + \\frac{1 - \\alpha}{\\rho_{R}} \\right)}$$"
        },
        {
            "introduction": "Advanced CFD solvers often use hybrid schemes that apply different numerical treatments to shocks versus contacts, demanding a robust method to distinguish between them in complex, multidimensional flows. This exercise puts you in the role of a CFD developer tasked with designing such a discontinuity sensor. By analyzing the fundamental jump conditions, you will evaluate several candidate sensors and select the one that is properly scaled and, most importantly, adheres to the principles of Galilean and rotational invariance, ensuring its reliability regardless of the flow's orientation or the observer's frame of reference .",
            "id": "3950598",
            "problem": "A designer of a finite-volume solver for the compressible Euler equations in aerospace Computational Fluid Dynamics (CFD) needs a robust discontinuity sensor to distinguish contact discontinuities and slip lines from shocks in multidimensional flows. The solver advances face fluxes between neighboring control volumes denoted by a left state $\\boldsymbol{Q}_L$ and a right state $\\boldsymbol{Q}_R$, where $\\boldsymbol{Q} = (\\rho, \\rho u_x, \\rho u_y, \\rho u_z, \\rho E)$ and $(\\rho, \\boldsymbol{u}, p, E)$ are density, velocity, pressure, and total specific energy, respectively. The working fluid is a calorically perfect gas with specific heat ratio $\\gamma$. The sensor is allowed to depend on jumps across a face, denoted $[f] = f_R - f_L$, and must be consistent with the jump conditions implied by the governing laws.\n\nThe starting point is the compressible Euler equations in conservation form and the Rankine–Hugoniot jump conditions across a moving discontinuity with local unit normal $\\hat{\\boldsymbol{n}}$ and speed $s$:\n- Mass: $[\\rho (u_n - s)] = 0$, where $u_n = \\boldsymbol{u}\\cdot \\hat{\\boldsymbol{n}}$.\n- Normal momentum: $[p] + [\\rho (u_n - s) u_n] = 0$.\n- Tangential momentum: $[\\rho (u_n - s) u_t] = 0$, where $u_t$ is any component tangent to the discontinuity.\n- Total energy: $[\\rho (u_n - s) h_t] = 0$, with $h_t = h + \\tfrac{1}{2} \\|\\boldsymbol{u}\\|^2$ and $h$ the specific enthalpy.\n\nFor a contact discontinuity or slip line, these relations reduce to $[p] = 0$ and $[u_n] = 0$, while $[\\rho]$ and $[u_t]$ may be nonzero. For a shock, $[p] \\neq 0$ and $[u_n] \\neq 0$ with magnitudes comparable to acoustic scales. The designer wants a sensor built from thresholds on the absolute jumps $|[p]|$ and $|[u_n]|$ that is:\n- Galilean invariant under addition of uniform velocity,\n- Rotationally robust in multidimensional flows, and\n- Scaled to local thermodynamic and acoustic quantities to avoid unit dependence.\n\nAmong the following candidate sensors, select the one that correctly encodes these principles and will reliably classify contacts and slip lines versus shocks in multidimensional flows. Here $p_{\\mathrm{avg}} = \\tfrac{1}{2}(p_L + p_R)$, $\\rho_{\\mathrm{avg}} = \\tfrac{1}{2}(\\rho_L + \\rho_R)$, $a_{\\mathrm{avg}} = \\sqrt{\\gamma p_{\\mathrm{avg}}/\\rho_{\\mathrm{avg}}}$, and $\\hat{\\boldsymbol{n}}$ is the unit normal of the face between the two control volumes in the finite-volume mesh. Thresholds $\\varepsilon_p$, $\\varepsilon_u$, $\\varepsilon_\\rho$, and $\\varepsilon_t$ are small, solver-chosen positive constants independent of flow orientation.\n\nA. Define $u_{n,L} = \\boldsymbol{u}_L\\cdot \\hat{\\boldsymbol{n}}$, $u_{n,R} = \\boldsymbol{u}_R\\cdot \\hat{\\boldsymbol{n}}$, and $[u_n] = u_{n,R} - u_{n,L}$. Classify a face as a contact or slip line if $|[p]|/p_{\\mathrm{avg}}  \\varepsilon_p$ and $|[u_n]|/a_{\\mathrm{avg}}  \\varepsilon_u$, and additionally either $|[\\rho]|/\\rho_{\\mathrm{avg}}  \\varepsilon_\\rho$ or $|[u_t]|/a_{\\mathrm{avg}}  \\varepsilon_t$ for some unit tangent $\\hat{\\boldsymbol{t}} \\perp \\hat{\\boldsymbol{n}}$ with $[u_t] = (\\boldsymbol{u}_R - \\boldsymbol{u}_L)\\cdot \\hat{\\boldsymbol{t}}$. Otherwise, classify the face as a shock if $|[p]|/p_{\\mathrm{avg}} \\ge \\varepsilon_p$ or $|[u_n]|/a_{\\mathrm{avg}} \\ge \\varepsilon_u$; if neither condition is met and the additional check fails, classify as smooth.\n\nB. Use a pressure-only criterion aligned with the global $x$-axis: compute $[p]$ and classify a face as a contact if $|[p]|/p_{\\mathrm{avg}}  \\varepsilon_p$; otherwise classify as a shock.\n\nC. Use full velocity-magnitude differences: compute $[\\boldsymbol{u}] = \\boldsymbol{u}_R - \\boldsymbol{u}_L$ and classify a face as a contact if $\\|\\,[\\boldsymbol{u}]\\,\\|/a_{\\mathrm{avg}}  \\varepsilon_u$; otherwise classify as a shock.\n\nD. Use grid-aligned components with no projection: compute $[p]$, $[u_x]$, and $[u_y]$ in a two-dimensional mesh and classify a face as a contact if $|[p]|/p_{\\mathrm{avg}}  \\varepsilon_p$ and $\\max(|[u_x]|,|[u_y]|)/a_{\\mathrm{avg}}  \\varepsilon_u$; otherwise classify as a shock.\n\nSelect the best option and justify your choice based on the governing laws and the stated robustness requirements. Provide reasoning that connects the jump conditions to the proposed thresholds and discusses invariance and multidimensional orientation.",
            "solution": "The user has requested a critical validation of the problem statement, followed by a full derivation and evaluation of the provided options for designing a discontinuity sensor in a Computational Fluid Dynamics (CFD) solver.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Solver Type**: Finite-volume for compressible Euler equations.\n- **Goal**: Design a sensor to distinguish contact discontinuities and slip lines from shocks.\n- **States**: Left state $\\boldsymbol{Q}_L$, right state $\\boldsymbol{Q}_R$.\n- **State Vector**: $\\boldsymbol{Q} = (\\rho, \\rho u_x, \\rho u_y, \\rho u_z, \\rho E)$.\n- **Primitive Variables**: Density $\\rho$, velocity $\\boldsymbol{u}$, pressure $p$, total specific energy $E$.\n- **Fluid Properties**: Calorically perfect gas, specific heat ratio $\\gamma$.\n- **Jump Notation**: $[f] = f_R - f_L$.\n- **Rankine–Hugoniot Jump Conditions** (discontinuity with speed $s$ and normal $\\hat{\\boldsymbol{n}}$):\n    - Mass: $[\\rho (u_n - s)] = 0$, with $u_n = \\boldsymbol{u}\\cdot \\hat{\\boldsymbol{n}}$.\n    - Normal momentum: $[p] + [\\rho (u_n - s) u_n] = 0$.\n    - Tangential momentum: $[\\rho (u_n - s) u_t] = 0$.\n    - Total energy: $[\\rho (u_n - s) h_t] = 0$, with $h_t = h + \\tfrac{1}{2} \\|\\boldsymbol{u}\\|^2$.\n- **Discontinuity Properties**:\n    - Contact/Slip Line: $[p] = 0$ and $[u_n] = 0$. May have $[\\rho] \\neq 0$ and $[u_t] \\neq 0$.\n    - Shock: $[p] \\neq 0$ and $[u_n] \\neq 0$.\n- **Sensor Design Requirements**:\n    1.  Galilean invariant.\n    2.  Rotationally robust.\n    3.  Scaled to local thermodynamic and acoustic quantities.\n- **Definitions for Options**:\n    - $p_{\\mathrm{avg}} = \\tfrac{1}{2}(p_L + p_R)$.\n    - $\\rho_{\\mathrm{avg}} = \\tfrac{1}{2}(\\rho_L + \\rho_R)$.\n    - $a_{\\mathrm{avg}} = \\sqrt{\\gamma p_{\\mathrm{avg}}/\\rho_{\\mathrm{avg}}}$.\n    - $\\varepsilon_p$, $\\varepsilon_u$, $\\varepsilon_\\rho$, $\\varepsilon_t$ are small positive constants.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientific Grounding**: The problem is based on the fundamental principles of compressible fluid dynamics, namely the Euler equations and the Rankine-Hugoniot jump conditions. The definitions of shocks, contact discontinuities, and slip lines are standard and correct. All provided equations and definitions are physically and mathematically sound.\n- **Well-Posedness**: The problem is well-posed. It asks to select the best option from a given set based on clearly stated criteria (Galilean invariance, rotational robustness, proper scaling). These criteria allow for a definitive and objective evaluation of each option.\n- **Objectivity**: The language is technical, precise, and free of any subjective or ambiguous terms.\n- **Flaw Analysis**:\n    1.  **Scientific Unsoundness**: The problem statement is scientifically sound.\n    2.  **Non-Formalizable**: The requirements are formalizable and the topic is central to CFD.\n    3.  **Incomplete/Contradictory Setup**: The problem provides all necessary information to evaluate the options against the criteria.\n    4.  **Unrealistic/Infeasible**: The task of creating such a sensor is a real-world problem in numerical methods for fluid dynamics.\n    5.  **Ill-Posed**: The problem is well-structured for a unique selection.\n    6.  **Trivial/Tautological**: The problem requires a non-trivial understanding of invariance principles and the physics of discontinuities.\n    7.  **Outside Scientific Verifiability**: The properties of the proposed sensors can be mathematically verified.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The solution will now be derived.\n\n### Derivation of a Valid Sensor\n\nThe objective is to create a sensor that identifies a contact discontinuity or a slip line. According to the provided jump conditions, these features are uniquely defined by the continuity of pressure ($[p] = 0$) and the normal component of velocity ($[u_n] = 0$) across the discontinuity. In a numerical solver, these exact zeros are replaced by conditions that the absolute values of the jumps are smaller than some small thresholds.\n\nThe sensor must satisfy three critical requirements:\n\n1.  **Scaling**: The sensor should be non-dimensional to be independent of the system of units and to provide a relative measure of the jump's strength.\n    -   For the pressure jump, $[p]$, a natural scaling factor is the local pressure itself. The non-dimensional pressure jump is thus $|[p]| / p_{\\mathrm{avg}}$.\n    -   For the normal velocity jump, $[u_n]$, the characteristic velocity scale in compressible flow is the speed of sound, $a$. The non-dimensional velocity jump is thus $|[u_n]| / a_{\\mathrm{avg}}$.\n    A sensor checking $|[p]| / p_{\\mathrm{avg}}  \\varepsilon_p$ and $|[u_n]| / a_{\\mathrm{avg}}  \\varepsilon_u$ meets this requirement.\n\n2.  **Galilean Invariance**: The sensor's classification must be independent of any uniform velocity $\\boldsymbol{v}_0$ added to the system. Let the transformed velocity be $\\boldsymbol{u}' = \\boldsymbol{u} + \\boldsymbol{v}_0$.\n    -   Pressure $p$, density $\\rho$, and speed of sound $a$ are thermodynamic properties, independent of the inertial reference frame. Therefore, $[p]$, $p_{\\mathrm{avg}}$, and $a_{\\mathrm{avg}}$ are all Galilean invariant. The pressure condition is invariant.\n    -   The normal velocity transforms as $u_n' = \\boldsymbol{u}' \\cdot \\hat{\\boldsymbol{n}} = (\\boldsymbol{u} + \\boldsymbol{v}_0) \\cdot \\hat{\\boldsymbol{n}} = u_n + \\boldsymbol{v}_0 \\cdot \\hat{\\boldsymbol{n}}$.\n    -   The jump in the normal velocity is $[u_n]' = u_{n,R}' - u_{n,L}' = (u_{n,R} + \\boldsymbol{v}_0 \\cdot \\hat{\\boldsymbol{n}}) - (u_{n,L} + \\boldsymbol{v}_0 \\cdot \\hat{\\boldsymbol{n}}) = u_{n,R} - u_{n,L} = [u_n]$.\n    -   Since $[u_n]$ and $a_{\\mathrm{avg}}$ are both Galilean invariant, the condition $|[u_n]| / a_{\\mathrm{avg}}  \\varepsilon_u$ is also Galilean invariant.\n\n3.  **Rotational Robustness**: The sensor's output must not depend on the orientation of the coordinate system. This is achieved by using only scalar quantities or scalar invariants constructed from vectors and tensors (like dot products and magnitudes).\n    -   Pressure $[p]$, $p_{\\mathrm{avg}}$, and $a_{\\mathrm{avg}}$ are scalars and are inherently rotationally invariant.\n    -   The quantities $\\boldsymbol{u}$ and $\\hat{\\boldsymbol{n}}$ are vectors. The normal velocity $u_n = \\boldsymbol{u} \\cdot \\hat{\\boldsymbol{n}}$ is a scalar formed by their dot product. Its value is independent of the choice of coordinate axes. Consequently, the jump $[u_n]$ is a rotationally invariant scalar.\n    -   Therefore, any sensor based on $[p]$ and $[u_n]$ respects rotational robustness.\n\nA valid sensor must therefore be based on checking the magnitudes of the scaled, invariant quantities $|[p]|/p_{\\mathrm{avg}}$ and $|[u_n]|/a_{\\mathrm{avg}}$.\n\n### Option-by-Option Analysis\n\n**A. Classify a face as a contact or slip line if $|[p]|/p_{\\mathrm{avg}}  \\varepsilon_p$ and $|[u_n]|/a_{\\mathrm{avg}}  \\varepsilon_u$, ...**\n\nThis option proposes a sensor based on two primary conditions: $|[p]|/p_{\\mathrm{avg}}  \\varepsilon_p$ and $|[u_n]|/a_{\\mathrm{avg}}  \\varepsilon_u$.\n- **Scaling**: Correct. It uses dimensionless ratios scaled by local average pressure and sound speed.\n- **Galilean Invariance**: Correct. As derived above, both metrics are Galilean invariant.\n- **Rotational Robustness**: Correct. The use of the scalar pressure jump $[p]$ and the normal velocity component $u_n = \\boldsymbol{u} \\cdot \\hat{\\boldsymbol{n}}$ (a scalar product) ensures the sensor is independent of coordinate system orientation. The face normal $\\hat{\\boldsymbol{n}}$ is the physically correct direction to project upon.\n- **Completeness**: The logic is complete and sound. It correctly formulates the conditions for a contact/slip line ($[p]\\approx 0$ and $[u_n]\\approx 0$). The additional check for significant jumps in density ($|[\\rho]|/\\rho_{\\mathrm{avg}}  \\varepsilon_\\rho$) or tangential velocity ($|[u_t]|/a_{\\mathrm{avg}}  \\varepsilon_t$) provides a robust way to distinguish a true discontinuity from a smooth flow region where all jumps would be small. The classification logic for shocks and smooth regions is also consistent with the physics.\n\n**Verdict: Correct.**\n\n**B. Use a pressure-only criterion aligned with the global $x$-axis: compute $[p]$ and classify a face as a contact if $|[p]|/p_{\\mathrm{avg}}  \\varepsilon_p$; otherwise classify as a shock.**\n\nThis option is flawed for multiple reasons.\n- **Incompleteness**: It ignores the velocity jump condition $[u_n] = 0$. A weak shock can have a small pressure jump satisfying $|[p]|/p_{\\mathrm{avg}}  \\varepsilon_p$, but will have a non-zero normal velocity jump, $[u_n] \\neq 0$. This sensor would misclassify weak shocks as contacts.\n- **Ambiguity**: The phrase \"aligned with the global $x$-axis\" is nonsensical for a pressure criterion, as pressure is a scalar and has no alignment. This indicates a flawed conceptual basis.\n\n**Verdict: Incorrect.**\n\n**C. Use full velocity-magnitude differences: compute $[\\boldsymbol{u}] = \\boldsymbol{u}_R - \\boldsymbol{u}_L$ and classify a face as a contact if $\\|\\,[\\boldsymbol{u}]\\,\\|/a_{\\mathrm{avg}}  \\varepsilon_u$; otherwise classify as a shock.**\n\nThis option is physically incorrect and incomplete.\n- **Incompleteness**: It completely ignores the pressure jump condition $[p] = 0$. A flow can have a small velocity jump but a large pressure jump (e.g., a normal shock in a frame moving with the fluid ahead of it), which this sensor would misclassify.\n- **Physical Incorrectness**: The fundamental condition is on the *normal* velocity component, $[u_n] = 0$. For a slip line, the tangential velocity jump, $[\\boldsymbol{u}_t]$, can be large. The magnitude of the total velocity jump is $\\|\\,[\\boldsymbol{u}]\\,\\| = \\sqrt{[u_n]^2 + \\|\\,[\\boldsymbol{u}_t]\\,\\|^2}$. For a strong slip line, $[u_n] \\approx 0$ but $\\|\\,[\\boldsymbol{u}_t]\\,\\|$ is large, making $\\|\\,[\\boldsymbol{u}]\\,\\|$ large. This sensor would incorrectly classify a strong slip line as a shock.\n\n**Verdict: Incorrect.**\n\n**D. Use grid-aligned components with no projection: compute $[p]$, $[u_x]$, and $[u_y]$ in a two-dimensional mesh and classify a face as a contact if $|[p]|/p_{\\mathrm{avg}}  \\varepsilon_p$ and $\\max(|[u_x]|,|[u_y]|)/a_{\\mathrm{avg}}  \\varepsilon_u$; otherwise classify as a shock.**\n\nThis option fails the rotational robustness requirement.\n- **Lack of Rotational Robustness**: The sensor's behavior depends on the arbitrary orientation of the computational grid. The physically relevant quantities are the velocity components normal and tangential to the discontinuity, not the components along the grid axes ($x$, $y$). For a physical discontinuity oriented at an angle to the grid, the values of $[u_x]$ and $[u_y]$ will change upon rotation of the physical system, while the underlying physics remains the same. A robust sensor's output must be invariant to such rotations. For instance, a flow with a jump only in the $u_y$ component would be treated differently from the same flow rotated by $45^\\circ$, where both $[u_x]$ and $[u_y]$ would be non-zero. The use of grid-aligned components instead of projecting onto the face normal $\\hat{\\boldsymbol{n}}$ is a fundamental flaw.\n\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}