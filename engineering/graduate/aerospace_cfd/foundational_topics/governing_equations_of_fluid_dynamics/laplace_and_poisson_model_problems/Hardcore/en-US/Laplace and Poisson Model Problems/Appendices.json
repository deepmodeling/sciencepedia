{
    "hands_on_practices": [
        {
            "introduction": "Before venturing into complex numerical simulations, it is essential to master the analytical techniques that provide the theoretical foundation for elliptic problems. This practice provides a quintessential exercise in solving the Laplace equation on a simple domain using the method of separation of variables. By working through this problem , you will reinforce your understanding of Sturm-Liouville theory and the construction of solutions using eigenfunction expansions, a fundamental skill for interpreting and validating CFD results for potential flows or steady-state heat transfer.",
            "id": "3971038",
            "problem": "Consider a canonical model elliptic boundary-value problem that arises in Computational Fluid Dynamics (CFD) when analyzing elliptic operators used for pressure or potential correction in incompressible flow solvers, or when simplifying steady heat conduction in a thin plate. Let a rectangular domain be defined by $0  x  L$ and $0  y  H$. The scalar field $\\phi(x,y)$ is governed by the Laplace equation\n$$\n\\nabla^{2} \\phi \\equiv \\frac{\\partial^{2} \\phi}{\\partial x^{2}} + \\frac{\\partial^{2} \\phi}{\\partial y^{2}} = 0,\n$$\nwith homogeneous Dirichlet boundary conditions on three sides,\n$$\n\\phi(0,y) = 0,\\quad \\phi(L,y) = 0,\\quad \\phi(x,0) = 0,\n$$\nand a prescribed nonhomogeneous Dirichlet boundary condition on the fourth side,\n$$\n\\phi(x,H) = \\Phi_{0}\\,\\frac{x}{L},\n$$\nwhere $\\Phi_{0}$ is a constant amplitude. Assume $\\phi$ is the velocity potential measured in $\\mathrm{m^{2}/s}$ and the lengths $L$ and $H$ are measured in $\\mathrm{m}$. You will provide a symbolic expression for $\\phi(x,y)$; do not include units in the final boxed expression.\n\nStarting from fundamental principles, use separation of variables to construct the appropriate eigenfunctions that satisfy the homogeneous Dirichlet conditions, enforce the remaining boundary condition by expanding $\\phi(x,H)$ in the corresponding orthogonal basis, and derive the eigenfunction expansion coefficients from the given boundary data. Provide the final closed-form eigenfunction expansion for $\\phi(x,y)$ valid in $0  x  L$, $0  y  H$.",
            "solution": "The problem as stated is a well-posed, canonical elliptic boundary-value problem. It is scientifically grounded, self-contained, and free of contradictions. The governing equation is the Laplace equation, a fundamental PDE in mathematical physics, and the boundary conditions are clearly specified, making the problem solvable by standard methods. We may proceed with the solution.\n\nThe problem is to solve the two-dimensional Laplace equation for a scalar field $\\phi(x,y)$ on a rectangular domain,\n$$\n\\frac{\\partial^{2} \\phi}{\\partial x^{2}} + \\frac{\\partial^{2} \\phi}{\\partial y^{2}} = 0, \\quad \\text{for } 0  x  L, \\ 0  y  H\n$$\nsubject to the boundary conditions:\n$$\n\\phi(0,y) = 0 \\\\\n\\phi(L,y) = 0 \\\\\n\\phi(x,0) = 0 \\\\\n\\phi(x,H) = \\Phi_{0}\\,\\frac{x}{L}\n$$\n\nWe will use the method of separation of variables. We assume a solution of the form $\\phi(x,y) = X(x)Y(y)$. Substituting this into the Laplace equation gives:\n$$\nX''(x)Y(y) + X(x)Y''(y) = 0\n$$\nwhere primes denote differentiation with respect to the function's argument. For a non-trivial solution, we can divide by $X(x)Y(y)$ to separate the variables:\n$$\n\\frac{X''(x)}{X(x)} = -\\frac{Y''(y)}{Y(y)}\n$$\nSince the left side is a function of $x$ only and the right side is a function of $y$ only, both must be equal to a constant. We shall call this separation constant $-\\lambda$.\nThis yields two ordinary differential equations (ODEs):\n$$\nX''(x) + \\lambda X(x) = 0 \\\\\nY''(y) - \\lambda Y(y) = 0\n$$\n\nWe apply the homogeneous boundary conditions. Three of the four conditions are homogeneous.\nFrom $\\phi(0,y) = X(0)Y(y) = 0$, we require $X(0) = 0$ for a non-trivial solution.\nFrom $\\phi(L,y) = X(L)Y(y) = 0$, we require $X(L) = 0$.\nFrom $\\phi(x,0) = X(x)Y(0) = 0$, we require $Y(0) = 0$.\n\nFirst, we solve the Sturm-Liouville problem for $X(x)$ with the homogeneous boundary conditions:\n$$\nX''(x) + \\lambda X(x) = 0, \\quad X(0)=0, \\quad X(L)=0\n$$\nWe analyze the possible values of the eigenvalue $\\lambda$.\nCase 1: $\\lambda  0$. Let $\\lambda = -k^2$ for some $k  0$. The ODE becomes $X'' - k^2 X = 0$, with general solution $X(x) = A\\cosh(kx) + B\\sinh(kx)$. Applying the boundary conditions: $X(0) = A = 0$. Then $X(L) = B\\sinh(kL) = 0$. Since $L0$ and $k0$, $\\sinh(kL) \\neq 0$, so $B$ must be $0$. This leads to the trivial solution $X(x)=0$, so there are no negative eigenvalues.\nCase 2: $\\lambda = 0$. The ODE becomes $X'' = 0$, with general solution $X(x) = Ax + B$. Applying the boundary conditions: $X(0) = B = 0$. Then $X(L) = AL = 0$. Since $L \\neq 0$, $A$ must be $0$. This also leads to the trivial solution, so $\\lambda=0$ is not an eigenvalue.\nCase 3: $\\lambda  0$. Let $\\lambda = k^2$ for some $k  0$. The ODE is $X'' + k^2 X = 0$, with general solution $X(x) = A\\cos(kx) + B\\sin(kx)$. Applying the boundary conditions: $X(0) = A = 0$. Then $X(L) = B\\sin(kL) = 0$. For a non-trivial solution, we must have $B \\neq 0$, which requires $\\sin(kL)=0$. This condition is met when $kL = n\\pi$ for any integer $n$. Since $k  0$, we take $n = 1, 2, 3, \\ldots$.\nThe eigenvalues are therefore $\\lambda_n = k_n^2 = \\left(\\frac{n\\pi}{L}\\right)^2$ for $n=1, 2, 3, \\ldots$.\nThe corresponding eigenfunctions, up to a multiplicative constant, are $X_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$.\n\nNow we solve the ODE for $Y(y)$ using these eigenvalues:\n$$\nY''(y) - \\lambda_n Y(y) = 0 \\implies Y'' - \\left(\\frac{n\\pi}{L}\\right)^2 Y = 0\n$$\nThe general solution for $Y_n(y)$ is $Y_n(y) = C_n \\cosh\\left(\\frac{n\\pi y}{L}\\right) + D_n \\sinh\\left(\\frac{n\\pi y}{L}\\right)$.\nApplying the homogeneous boundary condition $Y(0)=0$:\n$$\nY_n(0) = C_n \\cosh(0) + D_n \\sinh(0) = C_n \\cdot 1 + D_n \\cdot 0 = C_n = 0\n$$\nThus, the solution for $Y_n(y)$ is of the form $Y_n(y) = D_n \\sinh\\left(\\frac{n\\pi y}{L}\\right)$.\n\nBy the principle of superposition, the general solution for $\\phi(x,y)$ is an infinite series of the product solutions $\\phi_n(x,y) = X_n(x)Y_n(y)$:\n$$\n\\phi(x,y) = \\sum_{n=1}^{\\infty} D_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sinh\\left(\\frac{n\\pi y}{L}\\right)\n$$\nwhere the coefficients $D_n$ are to be determined from the remaining nonhomogeneous boundary condition.\n\nWe apply the condition at $y=H$: $\\phi(x,H) = \\Phi_{0}\\frac{x}{L}$.\n$$\n\\Phi_{0}\\frac{x}{L} = \\sum_{n=1}^{\\infty} D_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sinh\\left(\\frac{n\\pi H}{L}\\right) = \\sum_{n=1}^{\\infty} b_n \\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\nThis is a Fourier sine series for the function $f(x) = \\Phi_{0}\\frac{x}{L}$ on the interval $[0, L]$. The coefficients $b_n = D_n \\sinh\\left(\\frac{n\\pi H}{L}\\right)$ are given by the standard formula:\n$$\nb_n = \\frac{2}{L} \\int_0^L f(x) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{2}{L} \\int_0^L \\left(\\Phi_{0}\\frac{x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx\n$$\n$$\nb_n = \\frac{2\\Phi_0}{L^2} \\int_0^L x \\sin\\left(\\frac{n\\pi x}{L}\\right) dx\n$$\nWe evaluate the integral using integration by parts, $\\int u \\, dv = uv - \\int v \\, du$, with $u=x$ and $dv = \\sin\\left(\\frac{n\\pi x}{L}\\right)dx$. This gives $du=dx$ and $v = -\\frac{L}{n\\pi}\\cos\\left(\\frac{n\\pi x}{L}\\right)$.\n$$\n\\int_0^L x \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\left[ -x \\frac{L}{n\\pi} \\cos\\left(\\frac{n\\pi x}{L}\\right) \\right]_0^L - \\int_0^L \\left(-\\frac{L}{n\\pi} \\cos\\left(\\frac{n\\pi x}{L}\\right)\\right) dx\n$$\n$$\n= \\left( -L \\frac{L}{n\\pi} \\cos(n\\pi) - 0 \\right) + \\frac{L}{n\\pi} \\int_0^L \\cos\\left(\\frac{n\\pi x}{L}\\right) dx\n$$\n$$\n= -\\frac{L^2}{n\\pi} (-1)^n + \\frac{L}{n\\pi} \\left[ \\frac{L}{n\\pi} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right]_0^L\n$$\n$$\n= \\frac{L^2}{n\\pi} (-1)^{n+1} + \\frac{L^2}{(n\\pi)^2} (\\sin(n\\pi) - \\sin(0)) = \\frac{L^2}{n\\pi} (-1)^{n+1}\n$$\nSubstituting this result back into the expression for $b_n$:\n$$\nb_n = \\frac{2\\Phi_0}{L^2} \\left(\\frac{L^2}{n\\pi} (-1)^{n+1}\\right) = \\frac{2\\Phi_0}{n\\pi} (-1)^{n+1}\n$$\nNow we solve for the coefficients $D_n$:\n$$\nD_n = \\frac{b_n}{\\sinh\\left(\\frac{n\\pi H}{L}\\right)} = \\frac{2\\Phi_0 (-1)^{n+1}}{n\\pi\\sinh\\left(\\frac{n\\pi H}{L}\\right)}\n$$\nFinally, substituting these coefficients back into the general solution for $\\phi(x,y)$, we obtain the complete eigenfunction expansion:\n$$\n\\phi(x,y) = \\sum_{n=1}^{\\infty} \\frac{2\\Phi_0 (-1)^{n+1}}{n\\pi\\sinh\\left(\\frac{n\\pi H}{L}\\right)} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sinh\\left(\\frac{n\\pi y}{L}\\right)\n$$\nThis can be written more tidily as:\n$$\n\\phi(x,y) = \\frac{2\\Phi_0}{\\pi} \\sum_{n=1}^{\\infty} \\frac{(-1)^{n+1}}{n} \\frac{\\sinh\\left(\\frac{n\\pi y}{L}\\right)}{\\sinh\\left(\\frac{n\\pi H}{L}\\right)} \\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\nThis expression is the final solution for the scalar field $\\phi(x,y)$ within the specified domain and boundary conditions.",
            "answer": "$$\\boxed{\\frac{2\\Phi_0}{\\pi} \\sum_{n=1}^{\\infty} \\frac{(-1)^{n+1}}{n} \\frac{\\sinh\\left(\\frac{n\\pi y}{L}\\right)}{\\sinh\\left(\\frac{n\\pi H}{L}\\right)} \\sin\\left(\\frac{n\\pi x}{L}\\right)}$$"
        },
        {
            "introduction": "Verifying that a complex scientific computing code is free of bugs is a formidable challenge, as exact analytical solutions are rarely available for realistic problems. The Method of Manufactured Solutions (MMS) is an indispensable tool in modern CFD for rigorously testing a code's implementation of a governing equation. This exercise  walks you through the core process of MMS: starting with a chosen \"manufactured\" solution, you will derive the corresponding source term, which can then be used to drive a numerical simulation and check if it recovers the manufactured solution to the expected order of accuracy.",
            "id": "3971042",
            "problem": "A common verification strategy in Computational Fluid Dynamics (CFD) for diffusion-type operators relevant to aerospace thermal analyses is the Method of Manufactured Solutions. Consider a dimensionless, steady, two-dimensional diffusion model on the unit square domain $\\Omega = [0,1] \\times [0,1]$ representative of in-plane heat conduction in a heterogeneous thermal protection system tile. The governing model problem for temperature $u(x,y)$ is the variable-coefficient Poisson equation in divergence form,\n$$\n-\\nabla \\cdot \\left( \\kappa(x,y) \\nabla u(x,y) \\right) = f(x,y),\n$$\nwhere $\\kappa(x,y)$ is a heterogeneous thermal conductivity field. Assume Dirichlet boundary data consistent with the exact manufactured solution specified below. You are tasked with constructing the source term $f(x,y)$ that makes the exact manufactured solution $u(x,y)$ satisfy the equation everywhere in $\\Omega$. This source term is to be used to verify second-order spatial accuracy of a chosen central-difference discretization.\n\nLet the heterogeneous conductivity be\n$$\n\\kappa(x,y) = 1 + \\alpha \\sin(\\pi x)\\cos(\\pi y),\n$$\nwith $0  \\alpha  1$ a fixed dimensionless parameter ensuring $\\kappa(x,y)  0$. Let the manufactured solution be\n$$\nu(x,y) = \\sin(2\\pi x)\\sin(3\\pi y) + \\exp(x+y).\n$$\n\nStarting from conservation of energy and Fourierâ€™s law (heat flux $\\mathbf{q} = -\\kappa \\nabla u$), and using the definition of divergence, derive the exact closed-form expression for $f(x,y)$ such that $u(x,y)$ satisfies\n$$\n-\\nabla \\cdot \\left( \\kappa(x,y) \\nabla u(x,y) \\right) = f(x,y).\n$$\n\nExpress your final answer as a single analytic expression in terms of $x$, $y$, $\\alpha$, and $\\pi$. No numerical approximation or rounding is required, and no physical units should be attached since the problem is nondimensional. Your final answer must be $f(x,y)$ only.",
            "solution": "The problem is valid and represents a standard application of the Method of Manufactured Solutions (MMS). The task is to find the source term $f(x,y)$ that corresponds to a given manufactured solution $u(x,y)$ and a variable conductivity $\\kappa(x,y)$ for the governing equation $-\\nabla \\cdot (\\kappa \\nabla u) = f$.\n\nThe source term is given by the left-hand side of the equation:\n$$ f(x,y) = -\\nabla \\cdot (\\kappa \\nabla u) $$\nUsing the product rule for divergence, this can be expanded as:\n$$ f(x,y) = -(\\nabla \\kappa \\cdot \\nabla u + \\kappa \\nabla^2 u) $$\nThis form is computationally advantageous as it separates the calculation into several distinct steps.\n\n**Given:**\n- Manufactured solution: $u(x,y) = \\sin(2\\pi x)\\sin(3\\pi y) + \\exp(x+y)$\n- Conductivity: $\\kappa(x,y) = 1 + \\alpha \\sin(\\pi x)\\cos(\\pi y)$\n\n**Step 1: Compute derivatives of the solution $u(x,y)$**\nFirst-order derivatives (the gradient $\\nabla u$):\n$$ \\frac{\\partial u}{\\partial x} = 2\\pi \\cos(2\\pi x)\\sin(3\\pi y) + \\exp(x+y) $$\n$$ \\frac{\\partial u}{\\partial y} = 3\\pi \\sin(2\\pi x)\\cos(3\\pi y) + \\exp(x+y) $$\nSecond-order derivatives:\n$$ \\frac{\\partial^2 u}{\\partial x^2} = -4\\pi^2 \\sin(2\\pi x)\\sin(3\\pi y) + \\exp(x+y) $$\n$$ \\frac{\\partial^2 u}{\\partial y^2} = -9\\pi^2 \\sin(2\\pi x)\\sin(3\\pi y) + \\exp(x+y) $$\nThe Laplacian of $u$ is the sum of the unmixed second derivatives:\n$$ \\nabla^2 u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = -13\\pi^2 \\sin(2\\pi x)\\sin(3\\pi y) + 2\\exp(x+y) $$\n\n**Step 2: Compute derivatives of the conductivity $\\kappa(x,y)$**\nThe gradient $\\nabla \\kappa$:\n$$ \\frac{\\partial \\kappa}{\\partial x} = \\alpha \\pi \\cos(\\pi x)\\cos(\\pi y) $$\n$$ \\frac{\\partial \\kappa}{\\partial y} = -\\alpha \\pi \\sin(\\pi x)\\sin(\\pi y) $$\n\n**Step 3: Assemble the terms for $f(x,y)$**\nWe now compute the two main parts of the expression for $-f(x,y)$.\n\nPart A: $\\kappa \\nabla^2 u$\n$$ \\kappa \\nabla^2 u = (1 + \\alpha \\sin(\\pi x)\\cos(\\pi y))(-13\\pi^2 \\sin(2\\pi x)\\sin(3\\pi y) + 2\\exp(x+y)) $$\n\nPart B: $\\nabla \\kappa \\cdot \\nabla u$\n$$ \\nabla \\kappa \\cdot \\nabla u = \\frac{\\partial \\kappa}{\\partial x}\\frac{\\partial u}{\\partial x} + \\frac{\\partial \\kappa}{\\partial y}\\frac{\\partial u}{\\partial y} $$\n$$ = (\\alpha \\pi \\cos(\\pi x)\\cos(\\pi y))(2\\pi \\cos(2\\pi x)\\sin(3\\pi y) + \\exp(x+y)) + (-\\alpha \\pi \\sin(\\pi x)\\sin(\\pi y))(3\\pi \\sin(2\\pi x)\\cos(3\\pi y) + \\exp(x+y)) $$\nGrouping the terms:\n$$ \\nabla \\kappa \\cdot \\nabla u = 2\\alpha\\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(2\\pi x)\\sin(3\\pi y) - 3\\alpha\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\sin(2\\pi x)\\cos(3\\pi y) + \\alpha\\pi e^{x+y}(\\cos(\\pi x)\\cos(\\pi y) - \\sin(\\pi x)\\sin(\\pi y)) $$\nUsing the trigonometric identity $\\cos(A+B) = \\cos A \\cos B - \\sin A \\sin B$, the exponential term simplifies:\n$$ \\nabla \\kappa \\cdot \\nabla u = 2\\alpha\\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(2\\pi x)\\sin(3\\pi y) - 3\\alpha\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\sin(2\\pi x)\\cos(3\\pi y) + \\alpha\\pi \\exp(x+y)\\cos(\\pi(x+y)) $$\n\n**Step 4: Sum the terms and apply the negative sign**\nNow, we sum Part A and Part B to get $\\nabla \\cdot (\\kappa \\nabla u)$ and then negate the result for $f(x,y)$.\n$$\n\\nabla \\cdot (\\kappa \\nabla u) = \\kappa \\nabla^2 u + \\nabla \\kappa \\cdot \\nabla u\n$$\n$$\n= \\left(-13\\pi^2 \\sin(2\\pi x)\\sin(3\\pi y) + 2\\exp(x+y)\\right) \\\\\n+ \\alpha \\sin(\\pi x)\\cos(\\pi y)\\left(-13\\pi^2 \\sin(2\\pi x)\\sin(3\\pi y) + 2\\exp(x+y)\\right) \\\\\n+ \\left(2\\alpha\\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(2\\pi x)\\sin(3\\pi y) - 3\\alpha\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\sin(2\\pi x)\\cos(3\\pi y) + \\alpha\\pi \\exp(x+y)\\cos(\\pi(x+y))\\right)\n$$\nThe source term $f(x,y) = -\\nabla \\cdot (\\kappa \\nabla u)$. Negating the expression above and grouping terms yields:\n$$\nf(x,y) = 13\\pi^2\\sin(2\\pi x)\\sin(3\\pi y) - 2\\exp(x+y) \\\\\n- \\alpha\\exp(x+y)\\left(2\\sin(\\pi x)\\cos(\\pi y) + \\pi\\cos(\\pi(x+y))\\right) \\\\\n- \\alpha\\pi^2 \\left( -13\\sin(\\pi x)\\cos(\\pi y)\\sin(2\\pi x)\\sin(3\\pi y) + 2\\cos(\\pi x)\\cos(\\pi y)\\cos(2\\pi x)\\sin(3\\pi y) - 3\\sin(\\pi x)\\sin(\\pi y)\\sin(2\\pi x)\\cos(3\\pi y) \\right)\n$$\nDistributing the final negative sign gives the expression in the final answer box.",
            "answer": "$$\n\\boxed{\n13\\pi^{2}\\sin(2\\pi x)\\sin(3\\pi y) - 2\\exp(x+y) - \\alpha\\exp(x+y)\\left(2\\sin(\\pi x)\\cos(\\pi y) + \\pi\\cos(\\pi(x+y))\\right) + \\alpha\\pi^{2}\\left(13\\sin(\\pi x)\\cos(\\pi y)\\sin(2\\pi x)\\sin(3\\pi y) - 2\\cos(\\pi x)\\cos(\\pi y)\\cos(2\\pi x)\\sin(3\\pi y) + 3\\sin(\\pi x)\\sin(\\pi y)\\sin(2\\pi x)\\cos(3\\pi y)\\right)\n}\n$$"
        },
        {
            "introduction": "A robust numerical method should not only converge to the correct solution but also respect the underlying physics, such as the maximum principle in diffusion problems, which states that extrema must occur on the boundaries. This principle is not always guaranteed by the discrete approximation, especially on low-quality computational meshes. This problem  provides a critical counterexample, demonstrating how a geometrically obtuse finite element mesh can lead to a violation of the conditions for a discrete maximum principle, offering a profound lesson on the interplay between mesh quality and the qualitative correctness of the numerical solution.",
            "id": "3971023",
            "problem": "Consider the homogeneous Laplace model problem for steady heat conduction in two spatial dimensions, a canonical diffusion-only benchmark in Computational Fluid Dynamics (CFD): find a scalar potential $u(\\mathbf{x})$ such that $-\\nabla \\cdot (k \\nabla u) = 0$ in a polygonal domain, with isotropic and constant conductivity $k=1$ and prescribed Dirichlet boundary data. Discretize the weak form by the Galerkin Finite Element Method (FEM) using continuous, piecewise linear (affine) shape functions on a conforming triangulation. Focus attention on an interior edge connecting two vertices $i$ and $j$ shared by exactly two adjacent triangles. Let the angles opposite this interior edge in the two triangles be denoted $\\alpha$ and $\\beta$, respectively.\n\nIn meshes that are close to orthogonal and acute, the resulting discrete operator has a stencil that satisfies the properties of a monotone matrix (often called an \"M-matrix\"), which ensures a Discrete Maximum Principle (DMP): interior extrema cannot exceed boundary extrema when there is no internal source. However, highly skewed or obtuse elements can break these properties.\n\nStarting from the weak form and the definition of the element stiffness entries as $a_{pq}^{(e)}=\\int_{\\Omega_e}\\nabla N_p \\cdot \\nabla N_q \\,\\mathrm{d}A$, where $N_p$ are the local linear shape functions on triangle $\\Omega_e$, derive the expression for the global off-diagonal stiffness entry $a_{ij}$ associated with the interior edge shared by the two triangles in terms of the angles $\\alpha$ and $\\beta$. Then, consider the specific highly skewed configuration with opposite angles $\\alpha=120^\\circ$ and $\\beta=80^\\circ$ and compute the numerical value of $a_{ij}$ for this edge. Based on its sign, briefly explain whether this coefficient violates the non-positivity requirement for off-diagonals in an M-matrix, thereby providing a counterexample to the DMP.\n\nExpress your final answer as the single real-valued number equal to $a_{ij}$ for the given angles. Round your answer to five significant figures. Angles are specified in degrees, and trigonometric functions must be evaluated consistently in radians or degrees as appropriate for exact values; the final reported number must be dimensionless.",
            "solution": "The problem is valid as it is scientifically grounded in the theory of the Finite Element Method (FEM) for elliptic partial differential equations, is well-posed, objective, and internally consistent.\n\nWe are asked to derive the expression for an off-diagonal entry of the global stiffness matrix, $a_{ij}$, for the Laplace equation discretized with linear finite elements, and then to evaluate it for a specific geometric configuration. The governing equation is the homogeneous Laplace equation with unit conductivity, $-\\nabla^2 u = 0$.\n\nThe Galerkin FEM formulation for this problem leads to a system of linear equations $\\mathbf{A}\\mathbf{u} = \\mathbf{f}$. The entries of the global stiffness matrix $\\mathbf{A}$ are given by $a_{pq} = \\int_{\\Omega} \\nabla N_p \\cdot \\nabla N_q \\, \\mathrm{d}A$, where $N_p$ and $N_q$ are the global, piecewise linear basis functions (also known as \"hat\" functions).\n\nThe entry $a_{ij}$ for $i \\neq j$ receives contributions only from elements that contain both nodes $i$ and $j$. In this problem, we consider an interior edge connecting vertices $i$ and $j$, which is shared by exactly two adjacent triangles, which we denote $\\Omega_1$ and $\\Omega_2$. The global stiffness entry is thus the sum of the local contributions from these two elements:\n$$a_{ij} = a_{ij}^{(1)} + a_{ij}^{(2)}$$\nwhere $a_{ij}^{(e)} = \\int_{\\Omega_e} \\nabla N_i \\cdot \\nabla N_j \\, \\mathrm{d}A$ for $e \\in \\{1, 2\\}$.\n\nWithin a single linear triangular element $\\Omega_e$, the basis functions $N_i$ and $N_j$ are linear, which implies their gradients $\\nabla N_i$ and $\\nabla N_j$ are constant vectors. The integral simplifies to:\n$$a_{ij}^{(e)} = (\\nabla N_i|_{\\Omega_e} \\cdot \\nabla N_j|_{\\Omega_e}) \\cdot \\text{Area}(\\Omega_e)$$\n\nA standard result in FEM theory provides a formula for the local stiffness matrix entries for a triangular element. For an off-diagonal entry corresponding to nodes $i$ and $j$, the contribution is related to the cotangent of the angle opposite the edge $(i, j)$. Let the vertices of a triangle be $i$, $j$, and $k$, and let $\\gamma_k$ be the interior angle at vertex $k$. The local stiffness entry is derived as follows:\nThe gradients of the linear basis functions (barycentric coordinates) $\\lambda_i$ and $\\lambda_j$ are given by $\\nabla \\lambda_i = \\frac{1}{2A}(\\mathbf{x}_k - \\mathbf{x}_j)^{\\perp}$ and $\\nabla \\lambda_j = \\frac{1}{2A}(\\mathbf{x}_i - \\mathbf{x}_k)^{\\perp}$, where $A$ is the triangle area and $\\mathbf{v}^{\\perp}$ is the vector $\\mathbf{v}$ rotated by $+90^\\circ$.\nThe dot product of the gradients is:\n$$\\nabla N_i \\cdot \\nabla N_j = \\frac{1}{4A^2} \\left( (\\mathbf{x}_k - \\mathbf{x}_j) \\cdot (\\mathbf{x}_i - \\mathbf{x}_k) \\right)$$\nThe vector dot product $(\\mathbf{x}_k - \\mathbf{x}_j) \\cdot (\\mathbf{x}_i - \\mathbf{x}_k)$ can be expressed as $-l_{jk} l_{ik} \\cos(\\gamma_k)$, where $l_{jk}$ and $l_{ik}$ are the lengths of the edges connecting to vertex $k$. The area of the triangle is $A = \\frac{1}{2} l_{jk} l_{ik} \\sin(\\gamma_k)$.\nSubstituting these into the expression for $a_{ij}^{(e)}$:\n$$a_{ij}^{(e)} = (\\nabla N_i \\cdot \\nabla N_j) A = \\frac{-l_{jk} l_{ik} \\cos(\\gamma_k)}{4A^2} A = \\frac{-l_{jk} l_{ik} \\cos(\\gamma_k)}{4A}$$\n$$a_{ij}^{(e)} = \\frac{-l_{jk} l_{ik} \\cos(\\gamma_k)}{4 \\left( \\frac{1}{2} l_{jk} l_{ik} \\sin(\\gamma_k) \\right)} = -\\frac{1}{2} \\frac{\\cos(\\gamma_k)}{\\sin(\\gamma_k)} = -\\frac{1}{2}\\cot(\\gamma_k)$$\n\nFor the first triangle, $\\Omega_1$, the angle opposite the edge $(i,j)$ is given as $\\alpha$. Thus, its contribution to the global stiffness entry is:\n$$a_{ij}^{(1)} = -\\frac{1}{2}\\cot(\\alpha)$$\nFor the second triangle, $\\Omega_2$, the angle opposite the edge $(i,j)$ is given as $\\beta$. Its contribution is:\n$$a_{ij}^{(2)} = -\\frac{1}{2}\\cot(\\beta)$$\nThe total global off-diagonal stiffness entry $a_{ij}$ is the sum of these two contributions:\n$$a_{ij} = a_{ij}^{(1)} + a_{ij}^{(2)} = -\\frac{1}{2}\\cot(\\alpha) - \\frac{1}{2}\\cot(\\beta) = -\\frac{1}{2}(\\cot(\\alpha) + \\cot(\\beta))$$\nThis is the general expression for the off-diagonal entry associated with an interior edge.\n\nNow, we must compute the numerical value for the specific case where $\\alpha = 120^\\circ$ and $\\beta = 80^\\circ$. The angles must be handled by the cotangent function, which typically operates in radians, but the values for standard degree measures are well-defined.\n$$a_{ij} = -\\frac{1}{2}(\\cot(120^\\circ) + \\cot(80^\\circ))$$\nWe evaluate the trigonometric functions:\n$\\cot(120^\\circ) = \\cot(180^\\circ - 60^\\circ) = -\\cot(60^\\circ) = -\\frac{1}{\\sqrt{3}} \\approx -0.57735027$\n$\\cot(80^\\circ) \\approx 0.17632698$\n\nSubstituting these values into the expression for $a_{ij}$:\n$$a_{ij} = -\\frac{1}{2}(-0.57735027 + 0.17632698)$$\n$$a_{ij} = -\\frac{1}{2}(-0.40102329)$$\n$$a_{ij} \\approx 0.200511645$$\n\nRounding the result to five significant figures gives:\n$$a_{ij} \\approx 0.20051$$\n\nFor the discrete operator to satisfy a Discrete Maximum Principle (DMP), the resulting system matrix is often required to be an M-matrix. A key property of an M-matrix (or more fundamentally, a Z-matrix) is that all its off-diagonal entries must be non-positive, i.e., $a_{ij} \\le 0$ for all $i \\neq j$.\nIn our case, the computed value is $a_{ij} \\approx 0.20051$, which is a positive number. This violates the non-positivity requirement for off-diagonal entries. This specific configuration, which involves an obtuse angle ($\\alpha = 120^\\circ > 90^\\circ$), provides a counterexample where the standard Galerkin FEM discretization does not produce an M-matrix, and therefore the DMP is not guaranteed. The condition for non-positivity, from our derived formula, is $\\cot(\\alpha) + \\cot(\\beta) \\ge 0$. This is guaranteed if $\\alpha + \\beta \\le 180^\\circ$ (the Delaunay condition), but it is violated here since $120^\\circ + 80^\\circ = 200^\\circ > 180^\\circ$.",
            "answer": "$$\\boxed{0.20051}$$"
        }
    ]
}