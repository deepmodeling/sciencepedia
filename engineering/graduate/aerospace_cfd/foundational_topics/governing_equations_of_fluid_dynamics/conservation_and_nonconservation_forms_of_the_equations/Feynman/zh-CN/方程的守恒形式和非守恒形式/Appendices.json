{
    "hands_on_practices": [
        {
            "introduction": "为什么守恒形式对于模拟包含激波的流动如此重要？这第一个练习将提供最直接和有力的答案。通过分析简单的一维伯格斯方程，你将分别从正确的积分守恒律和错误的非守恒形式推导激波的传播速度，从而直接量化后者引入的误差。这个练习构成了理解守恒离散格式在计算流体力学中不可或缺作用的理论基石。",
            "id": "3949772",
            "problem": "考虑一维无粘伯格斯方程，该方程是无粘可压缩欧拉方程中平流输运的标量模型，其守恒形式为 $u_{t} + \\partial_{x}\\left(\\frac{1}{2} u^{2}\\right) = 0$。在计算流体动力学 (CFD) 的背景下，对于黎曼初始数据 $u(x,0) = u_{L}$ (当 $x  0$) 和 $u(x,0) = u_{R}$ (当 $x  0$)，且 $u_{L}  u_{R}$ 时，会产生激波。\n\n1. 从积分守恒律和弱解的定义出发，通过将 Rankine–Hugoniot 分析从 $\\partial_{t}\\int_{x_{1}}^{x_{2}} u \\, dx + \\left[\\frac{1}{2}u^{2}\\right]_{x_{1}}^{x_{2}} = 0$ 推导出的跳跃条件应用于一个位于 $x_{s}(t)$ 的移动间断，来推导守恒形式伯格斯方程的激波速度 $s_{c}$。\n\n2. 现在考虑非守恒平流形式 $u_{t} + u \\, u_{x} = 0$ 在间距为 $\\Delta x$ 的均匀网格上的半离散有限体积离散化，它通过双线性形式近似单元界面上的非守恒乘积：\n$$\n\\frac{d u_{i}}{dt} + \\frac{1}{\\Delta x}\\left[\\widehat{a}_{i+\\frac{1}{2}}\\left(u_{i+1} - u_{i}\\right) - \\widehat{a}_{i-\\frac{1}{2}}\\left(u_{i} - u_{i-1}\\right)\\right] = 0, \n$$\n其中界面平流系数由有偏线性平均给出：\n$$\n\\widehat{a}_{i+\\frac{1}{2}} = \\alpha \\, u_{i} + \\left(1 - \\alpha\\right) u_{i+1}, \\quad \\text{with } \\alpha \\in [0,1].\n$$\n对位于常数状态 $u_{L}$ (左) 和 $u_{R}$ (右) 之间的网格界面上的单个移动间断，应用与非守恒乘积理论一致的跳跃条件分析，推导该非守恒格式预测的激波速度，记为 $s_{nc}$，作为 $\\alpha$，$u_{L}$ 和 $u_{R}$ 的函数。\n\n3. 使用第1部分和第2部分的结果，给出非守恒激波速度与守恒激波速度之间的差异 $s_{nc} - s_{c}$ 的闭式符号表达式，作为 $\\alpha$，$u_{L}$ 和 $u_{R}$ 的函数。将最终答案表示为单个解析表达式，无需进行数值计算。",
            "solution": "该问题分为三个部分。首先，我们推导一维无粘伯格斯方程守恒形式的激波速度。其次，我们推导一个特定的非守恒有限体积离散化的激波速度。第三，我们计算这两种速度之间的差值。\n\n第1部分：守恒激波速度 $s_{c}$ 的推导。\n一维无粘伯格斯方程的守恒形式由下式给出：\n$$ u_{t} + \\partial_{x}\\left( f(u) \\right) = 0, \\quad \\text{其中 } f(u) = \\frac{1}{2} u^{2} $$\n此守恒律在固定空间域 $[x_1, x_2]$ 上的积分形式为：\n$$ \\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx + f(u(x_2,t)) - f(u(x_1,t)) = 0 $$\n我们分析一个以单个间断（激波）形式存在的弱解，其以恒定速度 $s_{c}$ 传播。激波的位置是 $x_s(t) = s_{c}t$。给定黎曼初始数据，解是分段常数：\n$$ u(x,t) = \\begin{cases} u_{L}  \\text{if } x  x_s(t) \\\\ u_{R}  \\text{if } x  x_s(t) \\end{cases} $$\n设我们的控制体 $[x_1, x_2]$ 是固定的，使得激波最初在其中并在一段时间内保持在其中。我们可以计算该积分：\n$$ \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = \\int_{x_{1}}^{x_s(t)} u_{L} \\, dx + \\int_{x_s(t)}^{x_{2}} u_{R} \\, dx = u_{L}(x_s(t) - x_1) + u_{R}(x_2 - x_s(t)) $$\n现在，我们对此表达式关于时间 $t$ 求导。项 $u_L x_1$ 和 $u_R x_2$ 是常数，它们的导数为零。\n$$ \\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = u_{L} \\frac{dx_s}{dt} - u_{R} \\frac{dx_s}{dt} = (u_{L} - u_{R}) s_{c} $$\n积分守恒律中的通量项是 $f(u(x_1,t)) - f(u(x_2,t))$。由于 $x_1$ 在激波的左侧，$x_2$ 在右侧，我们有 $u(x_1,t) = u_{L}$ 和 $u(x_2,t) = u_{R}$。因此通量差为：\n$$ f(u_L) - f(u_R) = \\frac{1}{2}u_{L}^{2} - \\frac{1}{2}u_{R}^{2} $$\n将这些结果代回积分守恒律，我们得到：\n$$ (u_{L} - u_{R}) s_{c} + \\left( \\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2} \\right) = 0 $$\n这可以重排为标准的 Rankine-Hugoniot 跳跃条件 $s_{c}[u] = [f(u)]$，其中 $[q] = q_L - q_R$。\n$$ s_{c}(u_{L} - u_{R}) = f(u_{L}) - f(u_R) = \\frac{1}{2}u_{L}^{2} - \\frac{1}{2}u_{R}^{2} $$\n由于存在激波，$u_{L} \\neq u_{R}$，我们可以除以 $(u_L - u_R)$。\n$$ s_{c} = \\frac{\\frac{1}{2}(u_{L}^{2} - u_{R}^{2})}{u_{L} - u_{R}} = \\frac{\\frac{1}{2}(u_{L} - u_{R})(u_{L} + u_R)}{u_{L} - u_{R}} $$\n这就得到了守恒激波速度：\n$$ s_{c} = \\frac{1}{2}(u_{L} + u_{R}) $$\n\n第2部分：非守恒激波速度 $s_{nc}$ 的推导。\n给定方程的非守恒平流形式 $u_{t} + u u_{x} = 0$，离散为：\n$$ \\frac{d u_{i}}{dt} + \\frac{1}{\\Delta x}\\left[\\widehat{a}_{i+\\frac{1}{2}}\\left(u_{i+1} - u_{i}\\right) - \\widehat{a}_{i-\\frac{1}{2}}\\left(u_{i} - u_{i-1}\\right)\\right] = 0 $$\n其中界面平流系数 $\\widehat{a}_{i+\\frac{1}{2}} = \\alpha u_{i} + (1 - \\alpha) u_{i+1}$。\n乘积 $u u_x$ 是一个非守恒乘积。弱解，特别是间断的速度，取决于状态空间中从左状态到右状态所取的路径。非守恒方程的数值格式隐含地定义了这条路径，并因此定义了激波速度。在这种类有限体积格式中，项 $\\widehat{a}_{i+\\frac{1}{2}}$ 表示单元 $i$ 和单元 $i+1$ 之间界面上的数值平流速度。穿过该界面传播的间断的速度由这个数值定义的速度决定。\n对于位于界面 $i+\\frac{1}{2}$ 上的单个、清晰的间断，与非守恒乘积理论一致的跳跃条件分析将激波速度 $s_{nc}$ 等同于界面速度 $\\widehat{a}_{i+\\frac{1}{2}}$。该界面左右两边的状态分别为 $u_i = u_L$ 和 $u_{i+1} = u_R$。\n因此，该非守恒格式预测的激波速度为：\n$$ s_{nc} = \\widehat{a}_{i+\\frac{1}{2}} \\rvert_{u_i=u_L, u_{i+1}=u_R} $$\n代入 $\\widehat{a}_{i+\\frac{1}{2}}$ 的定义：\n$$ s_{nc} = \\alpha u_{L} + (1 - \\alpha) u_{R} $$\n这个结果表明，激波速度是左右状态的线性插值，其权重由参数 $\\alpha$ 控制。\n\n第3部分：非守恒与守恒激波速度之间的差异。\n现在我们使用前面部分推导出的表达式来计算差值 $s_{nc} - s_{c}$。\n$$ s_{nc} - s_{c} = \\left[ \\alpha u_{L} + (1 - \\alpha) u_{R} \\right] - \\left[ \\frac{1}{2}(u_{L} + u_{R}) \\right] $$\n我们将乘以 $u_L$ 和 $u_R$ 的项组合起来：\n$$ s_{nc} - s_{c} = \\left( \\alpha - \\frac{1}{2} \\right) u_{L} + \\left( 1 - \\alpha - \\frac{1}{2} \\right) u_{R} $$\n$$ s_{nc} - s_{c} = \\left( \\alpha - \\frac{1}{2} \\right) u_{L} + \\left( \\frac{1}{2} - \\alpha \\right) u_{R} $$\n提出公因子 $(\\alpha - \\frac{1}{2})$：\n$$ s_{nc} - s_{c} = \\left( \\alpha - \\frac{1}{2} \\right) u_{L} - \\left( \\alpha - \\frac{1}{2} \\right) u_{R} $$\n这就给出了差异的最终闭式表达式：\n$$ s_{nc} - s_{c} = \\left(\\alpha - \\frac{1}{2}\\right)(u_{L} - u_{R}) $$\n这个结果表明，只有当 $\\alpha = \\frac{1}{2}$ 时，非守恒格式才能得到正确的激波速度。对于 $\\alpha \\in [0,1]$ 中的任何其他值，该格式将产生以不正确速度传播的激波，其误差与激波强度 $(u_L - u_R)$ 和偏差参数 $\\alpha$ 成正比。",
            "answer": "$$ \\boxed{\\left(\\alpha - \\frac{1}{2}\\right)(u_{L} - u_{R})} $$"
        },
        {
            "introduction": "从理想化的一维方程过渡到在曲线坐标网格上的实际多维模拟，会引入一个新的挑战：几何本身。本练习将探讨“几何守恒律”（Geometric Conservation Law, GCL），这是一条关键原则，确保数值格式不会在非均匀网格上凭空制造质量、动量或能量。你将展示不一致的网格度量计算如何导致无法保持简单的均匀流场，然后构建正确的守恒公式。",
            "id": "3949765",
            "problem": "考虑在静态曲线网格上的二维可压缩欧拉方程，该网格由从计算坐标 $(\\xi,\\eta)$ 到物理坐标 $(x(\\xi,\\eta), y(\\xi,\\eta))$ 的光滑一一映射定义。设守恒变量为 $\\boldsymbol{Q} = (\\rho, \\rho u, \\rho v, \\rho E)^{\\top}$，其中 $\\rho$ 是密度，$u$ 和 $v$ 是速度分量，$E$ 是比总能。在笛卡尔坐标系中，质量守恒方程为 $\\partial \\rho/\\partial t + \\partial(\\rho u)/\\partial x + \\partial(\\rho v)/\\partial y = 0$。定义雅可比行列式 $J = x_{\\xi} y_{\\eta} - x_{\\eta} y_{\\xi}$，其中下标表示偏导数。\n\n在曲线网格上，连续性方程的守恒形式可以通过变量替换得到，并写为 $\\partial (J \\rho)/\\partial t + \\partial \\mathcal{F}^{\\xi}/\\partial \\xi + \\partial \\mathcal{F}^{\\eta}/\\partial \\eta = 0$，其中变换后的通量为 $\\mathcal{F}^{\\xi} = \\rho U^{\\xi}$ 和 $\\mathcal{F}^{\\eta} = \\rho U^{\\eta}$，逆变速度分量为 $U^{\\xi} = u \\, (J \\xi_{x}) + v \\, (J \\xi_{y})$ 和 $U^{\\eta} = u \\, (J \\eta_{x}) + v \\, (J \\eta_{y})$。这里，$J \\xi_{x}$、$J \\xi_{y}$、$J \\eta_{x}$ 和 $J \\eta_{y}$ 是雅可比加权的逆变度量分量。\n\n假设在均匀网格上存在均匀自由来流，其状态 $(\\rho_{\\infty}, u_{\\infty}, v_{\\infty}, E_{\\infty})$ 为常数，并使用作用于节点值的线性常系数算子 $D_{\\xi}$ 和 $D_{\\eta}$ 来离散化空间导数。假设度量是通过可能不同的算子 $\\widehat{D}_{\\xi}$ 和 $\\widehat{D}_{\\eta}$ 以及一个雅可比行列式 $\\widehat{J}$，利用类似链式法则的节点公式 $ \\xi_{x}^{\\mathrm{nc}} = (\\widehat{D}_{\\eta} y)/\\widehat{J}$、$\\xi_{y}^{\\mathrm{nc}} = -(\\widehat{D}_{\\eta} x)/\\widehat{J}$、$\\eta_{x}^{\\mathrm{nc}} = -(\\widehat{D}_{\\xi} y)/\\widehat{J}$ 和 $\\eta_{y}^{\\mathrm{nc}} = (\\widehat{D}_{\\xi} x)/\\widehat{J}$ 来进行非守恒计算的。变换后的通量散度随后被离散化为 $D_{\\xi}(\\rho_{\\infty} U^{\\xi}_{\\mathrm{nc}}) + D_{\\eta}(\\rho_{\\infty} U^{\\eta}_{\\mathrm{nc}})$，其中 $U^{\\xi}_{\\mathrm{nc}} = u_{\\infty} \\, (J \\xi_{x}^{\\mathrm{nc}}) + v_{\\infty} \\, (J \\xi_{y}^{\\mathrm{nc}})$ 且 $U^{\\eta}_{\\mathrm{nc}} = u_{\\infty} \\, (J \\eta_{x}^{\\mathrm{nc}}) + v_{\\infty} \\, (J \\eta_{y}^{\\mathrm{nc}})$。\n\n从物理守恒律和上述离散变换出发，推导在这种非守恒度量计算下，连续性方程的离散自由来流残差的表达式。明确展示该残差如何依赖于离散度量恒等式的失效以及 $D_{\\xi}, D_{\\eta}$ 和 $\\widehat{D}_{\\xi}, \\widehat{D}_{\\eta}$ 之间的不匹配，并解释为何这会导致丧失自由来流守恒性。\n\n然后，针对 $J \\xi_{x}$、$J \\xi_{y}$、$J \\eta_{x}$ 和 $J \\eta_{y}$，根据坐标函数以及与通量散度中使用的相同的离散算子 $D_{\\xi}$ 和 $D_{\\eta}$，提出一种严格守恒的度量计算方法，使得离散度量恒等式得到满足并且均匀自由来流得以保持。将您提出的守恒雅可比加权的逆变度量以单行矩阵的形式，按照 $(J \\xi_{x}, J \\xi_{y}, J \\eta_{x}, J \\eta_{y})$ 的顺序列出。最终答案必须是单个闭式解析表达式。无需单位。",
            "solution": "本问题探讨了在曲线网格上求解可压缩欧拉方程数值解时一个关键概念：自由来流守恒性。这一性质是几何守恒律（GCL）的一种具体表现，它要求数值格式能够精确地保持均匀流场，而均匀流场是连续控制方程的一个平凡解。若无法做到这一点，将会引入伪源项，从而污染整个数值解。此分析的关键在于坐标变换所产生的度量恒等式的离散模拟。\n\n首先，我们将分析给定的非守恒离散化，以推导自由来流残差。然后，基于此分析，我们将构造一个保证残差恒等于零的守恒度量计算方法。\n\n在物理笛卡尔坐标 $(x,y)$ 中，连续性方程由下式给出\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial(\\rho u)}{\\partial x} + \\frac{\\partial(\\rho v)}{\\partial y} = 0\n$$\n对于均匀自由来流，变量 $(\\rho_{\\infty}, u_{\\infty}, v_{\\infty})$ 在空间和时间上都是常数。因此，所有偏导数均为零，方程被平凡地满足。挑战在于如何确保这一性质在曲线网格上离散化后仍能保持。\n\n对于均匀自由来流，连续性方程空间导数项的离散形式表示为残差 $R$：\n$$\nR = D_{\\xi}(\\rho_{\\infty} U^{\\xi}_{\\mathrm{nc}}) + D_{\\eta}(\\rho_{\\infty} U^{\\eta}_{\\mathrm{nc}})\n$$\n其中 $D_{\\xi}$ 和 $D_{\\eta}$ 是用于通量散度的离散算子。由于自由来流状态 $(\\rho_{\\infty}, u_{\\infty}, v_{\\infty})$ 是常数，我们可以将其从离散算子中提取出来：\n$$\nR = \\rho_{\\infty} \\left[ D_{\\xi}(U^{\\xi}_{\\mathrm{nc}}) + D_{\\eta}(U^{\\eta}_{\\mathrm{nc}}) \\right]\n$$\n非守恒逆变速度由下式给出\n$$\nU^{\\xi}_{\\mathrm{nc}} = u_{\\infty} (J \\xi_{x})_{\\mathrm{nc}} + v_{\\infty} (J \\xi_{y})_{\\mathrm{nc}}\n$$\n$$\nU^{\\eta}_{\\mathrm{nc}} = u_{\\infty} (J \\eta_{x})_{\\mathrm{nc}} + v_{\\infty} (J \\eta_{y})_{\\mathrm{nc}}\n$$\n问题陈述以一种略微复杂的方式定义了非守恒度量。它定义了 $\\xi_{x}^{\\mathrm{nc}} = (\\widehat{D}_{\\eta} y)/\\widehat{J}$，然后在通量中使用了 $J \\xi_{x}^{\\mathrm{nc}}$ 这一项。这引入了一个模糊的雅可比行列式之比 $J/\\widehat{J}$。为进行易于处理的分析，我们将采用此问题的标准提法，即假设非守恒的雅可比加权度量是通过使用一组独立的算子 $\\widehat{D}_{\\xi}$ 和 $\\widehat{D}_{\\eta}$ 直接离散化连续恒等式 $J\\xi_x=y_\\eta$、$J\\xi_y=-x_\\eta$ 等来定义的。这些定义是：\n$$\n(J \\xi_{x})_{\\mathrm{nc}} = \\widehat{D}_{\\eta} y\n$$\n$$\n(J \\xi_{y})_{\\mathrm{nc}} = -\\widehat{D}_{\\eta} x\n$$\n$$\n(J \\eta_{x})_{\\mathrm{nc}} = -\\widehat{D}_{\\xi} y\n$$\n$$\n(J \\eta_{y})_{\\mathrm{nc}} = \\widehat{D}_{\\xi} x\n$$\n将这些定义代入残差 $R$ 的表达式中：\n$$\nR = \\rho_{\\infty} \\left[ D_{\\xi} \\left( u_{\\infty} (\\widehat{D}_{\\eta} y) + v_{\\infty} (-\\widehat{D}_{\\eta} x) \\right) + D_{\\eta} \\left( u_{\\infty} (-\\widehat{D}_{\\xi} y) + v_{\\infty} (\\widehat{D}_{\\xi} x) \\right) \\right]\n$$\n由于 $u_{\\infty}$ 和 $v_{\\infty}$ 是常数，它们也可以被提取出来：\n$$\nR = \\rho_{\\infty} u_{\\infty} \\left[ D_{\\xi}(\\widehat{D}_{\\eta} y) + D_{\\eta}(-\\widehat{D}_{\\xi} y) \\right] + \\rho_{\\infty} v_{\\infty} \\left[ D_{\\xi}(-\\widehat{D}_{\\eta} x) + D_{\\eta}(\\widehat{D}_{\\xi} x) \\right]\n$$\n整理各项，得到离散自由来流残差的最终表达式：\n$$\nR = \\rho_{\\infty} u_{\\infty} \\left( D_{\\xi} \\widehat{D}_{\\eta} y - D_{\\eta} \\widehat{D}_{\\xi} y \\right) - \\rho_{\\infty} v_{\\infty} \\left( D_{\\xi} \\widehat{D}_{\\eta} x - D_{\\eta} \\widehat{D}_{\\xi} x \\right)\n$$\n该残差通常不为零。从此表达式中可以明确看出，丧失自由来流守恒性主要有两个原因：\n1.  **离散算子不匹配**：该表达式涉及用于通量散度的算子 $D_{\\xi}$ 和 $D_{\\eta}$，以及用于度量计算的算子 $\\widehat{D}_{\\xi}$ 和 $\\widehat{D}_{\\eta}$。如果 $D_{\\xi} \\neq \\widehat{D}_{\\xi}$ 或 $D_{\\eta} \\neq \\widehat{D}_{\\eta}$，则没有数学依据可以期望各项相消。离散操作的应用不一致。\n2.  **离散度量恒等式失效**：即使算子匹配（即 $\\widehat{D}_{\\xi} = D_{\\xi}$ 且 $\\widehat{D}_{\\eta} = D_{\\eta}$），残差也变为 $R = \\rho_{\\infty} u_{\\infty} (D_{\\xi} D_{\\eta} - D_{\\eta} D_{\\xi})y - \\rho_{\\infty} v_{\\infty} (D_{\\xi} D_{\\eta} - D_{\\eta} D_{\\xi})x$。如果离散算子 $D_{\\xi}$ 和 $D_{\\eta}$ 不交换，即 $[D_{\\xi}, D_{\\eta}] \\equiv D_{\\xi}D_{\\eta} - D_{\\eta}D_{\\xi} \\neq 0$，则该表达式不为零。在连续情况下，相应的度量恒等式，例如 $\\partial_{\\xi}(y_{\\eta}) + \\partial_{\\eta}(-y_{\\xi}) = y_{\\eta\\xi} - y_{\\xi\\eta} = 0$，依赖于混合偏导数的相等性（Schwarz's theorem）。一般的离散差分算子是不可交换的，因此它们的离散模拟不会自动满足。这个非零残差充当了数值源项，违反了GCL。\n\n为确保自由来流守恒性，对于任何均匀自由来流状态 $(\\rho_{\\infty}, u_{\\infty}, v_{\\infty})$，残差 $R$ 必须恒等于零。这意味着残差表达式中 $u_{\\infty}$ 和 $v_{\\infty}$ 的系数必须独立为零。这要求雅可比加权的度量分量 $(J\\xi_x, J\\xi_y, J\\eta_x, J\\eta_y)$ 满足离散度量恒等式（或GCL）：\n$$\nD_{\\xi}(J\\xi_x) + D_{\\eta}(J\\eta_x) = 0\n$$\n$$\nD_{\\xi}(J\\xi_y) + D_{\\eta}(J\\eta_y) = 0\n$$\n关键步骤是以这样一种方式定义度量项，使得这些离散恒等式*通过构造*得到满足。这可以通过对度量计算和通量散度使用*相同*的离散算子 $D_{\\xi}$ 和 $D_{\\eta}$ 来实现。我们通过直接离散化连续关系 $J\\xi_x = y_{\\eta}$、$J\\xi_y = -x_{\\eta}$ 等，提出以下守恒度量计算方法：\n$$\n(J \\xi_x)_{\\mathrm{cons}} = D_{\\eta} y\n$$\n$$\n(J \\xi_y)_{\\mathrm{cons}} = -D_{\\eta} x\n$$\n$$\n(J \\eta_x)_{\\mathrm{cons}} = -D_{\\xi} y\n$$\n$$\n(J \\eta_y)_{\\mathrm{cons}} = D_{\\xi} x\n$$\n让我们将这些定义代入离散度量恒等式中以验证其有效性。\n对于第一个恒等式：\n$$\nD_{\\xi}((J\\xi_x)_{\\mathrm{cons}}) + D_{\\eta}((J\\eta_x)_{\\mathrm{cons}}) = D_{\\xi}(D_{\\eta} y) + D_{\\eta}(-D_{\\xi} y) = (D_{\\xi}D_{\\eta} - D_{\\eta}D_{\\xi})y\n$$\n对于第二个恒等式：\n$$\nD_{\\xi}((J\\xi_y)_{\\mathrm{cons}}) + D_{\\eta}((J\\eta_y)_{\\mathrm{cons}}) = D_{\\xi}(-D_{\\eta} x) + D_{\\eta}(D_{\\xi} x) = (-D_{\\xi}D_{\\eta} + D_{\\eta}D_{\\xi})x = -(D_{\\xi}D_{\\eta} - D_{\\eta}D_{\\xi})x\n$$\n当且仅当算子 $D_{\\xi}$ 和 $D_{\\eta}$ 可交换时，这些表达式为零。问题陈述中说明算子是“线性常系数”的，并作用于“均匀网格”上。设一个通用的1D线性常系数算子由模板 $c_k$ 定义：$D_{\\xi} f_{i,j} = \\sum_k c_k f_{i+k, j}$。类似地，$D_{\\eta} f_{i,j} = \\sum_l c'_l f_{i, j+l}$。依次应用这些算子：\n$$\n(D_{\\xi} D_{\\eta}) f_{i,j} = D_{\\xi} \\left( \\sum_l c'_l f_{i, j+l} \\right) = \\sum_k c_k \\left( \\sum_l c'_l f_{i+k, j+l} \\right) = \\sum_{k,l} c_k c'_l f_{i+k, j+l}\n$$\n$$\n(D_{\\eta} D_{\\xi}) f_{i,j} = D_{\\eta} \\left( \\sum_k c_k f_{i+k, j} \\right) = \\sum_l c'_l \\left( \\sum_k c_k f_{i+k, j+l} \\right) = \\sum_{k,l} c'_l c_k f_{i+k, j+l}\n$$\n由于标量乘法是可交换的（$c_k c'_l = c'_l c_k$），我们有 $D_{\\xi} D_{\\eta} = D_{\\eta} D_{\\xi}$。问题陈述中指定的条件保证了算子是可交换的。因此，所提出的度量定义满足离散度量恒等式，并确保自由来流残差恒等于零。这就是所要求的严格守恒的度量计算方法。\n\n因此，满足GCL的、所提出的雅可比加权的逆变度量分量，是通过将通量散度算子 $D_\\xi$ 和 $D_\\eta$ 应用于物理坐标函数 $x$ 和 $y$ 来得到的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nD_{\\eta} y  -D_{\\eta} x  -D_{\\xi} y  D_{\\xi} x\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "即使一个格式在形式上是守恒的，其数值通量函数中微妙的缺陷也可能导致灾难性的失败，例如在强激波模拟中出现的“痈现象”（carbuncle phenomenon）。本练习挑战你诊断这种数值不稳定性，并评估用于修复它的先进且仍然保持守恒的策略。通过探索多维耗散和鲁棒通量函数等修复方法，你将深入了解现代CFD中守恒性、数值耗散和稳定性之间复杂的相互作用。",
            "id": "3949779",
            "problem": "一个二维有限体积离散化方法被用于求解高超声速马赫数下钝体上的无粘流动。假设采用笛卡尔网格，单元格由 $(i,j)$ 索引，每个单元格内的状态为分段常数。守恒状态向量为 $\\boldsymbol{U} = [\\rho, \\rho u, \\rho v, \\rho E]^{\\top}$，其在 $x$ 方向的通量为 $\\boldsymbol{F}(\\boldsymbol{U})$，在 $y$ 方向的通量为 $\\boldsymbol{G}(\\boldsymbol{U})$。守恒形式的控制方程为\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} + \\frac{\\partial \\boldsymbol{G}(\\boldsymbol{U})}{\\partial y} = \\boldsymbol{0}.\n$$\n单元格 $(i,j)$ 的一个守恒有限体积更新格式为\n$$\n\\boldsymbol{U}_{i,j}^{n+1} = \\boldsymbol{U}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(\\widehat{\\boldsymbol{F}}_{i+\\frac{1}{2},j} - \\widehat{\\boldsymbol{F}}_{i-\\frac{1}{2},j}\\right) - \\frac{\\Delta t}{\\Delta y}\\left(\\widehat{\\boldsymbol{G}}_{i,j+\\frac{1}{2}} - \\widehat{\\boldsymbol{G}}_{i,j-\\frac{1}{2}}\\right),\n$$\n其中 $\\widehat{\\boldsymbol{F}}$ 和 $\\widehat{\\boldsymbol{G}}$ 是由局部左右状态构建的一致性数值通量。对于一个静止的、与网格对齐的激波，离散守恒性意味着激波速度和跳跃满足法向 $\\boldsymbol{n}$ 上的 Rankine–Hugoniot 条件：\n$$\ns\\,[\\boldsymbol{U}] = [\\boldsymbol{F}_n(\\boldsymbol{U})], \\quad \\boldsymbol{F}_n(\\boldsymbol{U}) = n_x\\,\\boldsymbol{F}(\\boldsymbol{U}) + n_y\\,\\boldsymbol{G}(\\boldsymbol{U}),\n$$\n其中 $[\\cdot]$ 表示跨激波的跳跃量，$s$ 表示激波速度。\n\n在实践中，某些近似黎曼求解器和限制器的选择会在强的、与网格对齐的激波附近产生“痈现象”(carbuncle phenomenon)：一种由横向耗散不足以及数值耗散与计算网格过度对齐引起的伪凸起和奇偶解耦。现要求您评估几种旨在改善痈现象，同时保持守恒性和正确激波传播的修正方案。\n\n以下哪种策略既是守恒的（即，它们保持了更新的离散散度形式以及 $\\widehat{\\boldsymbol{F}}$、$\\widehat{\\boldsymbol{G}}$ 的一致性），又已知能在强激波计算中减少痈现象？\n\nA. 用双波 Harten–Lax–van Leer (HLL 或 HLLE) 通量替换 Roe 型线性化通量，并通过旋转黎曼求解器对其进行增强，该求解器将耗散与根据 $\\nabla p$ 计算的局部激波法向 $\\boldsymbol{n}$ 对齐，从而在保持通量差分形式的同时增加横向耗散。\n\nB. 在通量更新之间，通过在动量方程中专门引入一个以单元为中心的人工压力扩散项作为源项，增加一个显式的压力光滑步骤，该项由激波传感器调节以抑制奇偶解耦。\n\nC. 仅在流向（平行于激波法向）应用总变差减小 (TVD) 限制器，而保持横向重构不受限制，不改变数值通量函数。\n\nD. 通过由完整特征结构构造的矩阵人工粘性来增强 Roe 型通量，在数值通量内部的 $x$ 和 $y$ 方向上增加与谱半径成正比的耗散项，其设计旨在与熵相容并通过修正的界面通量保持守恒性。\n\nE. 在激波区域引入低马赫数预处理，以修改特征速度并增加数值耗散，假设保持相同的通量差分形式。\n\n选择所有适用项。通过从方程的守恒形式、Rankine–Hugoniot 跳跃条件，以及在计算流体动力学 (CFD) 中近似黎曼求解器内痈现象产生和通过多维耗散被抑制的机理进行推理，来证明您的选择。",
            "solution": "用户提供了一个计算流体动力学 (CFD) 领域的问题，具体涉及可压缩欧拉方程的数值方法。任务是确定所提出的用于改善“痈现象”的策略中，哪些既是守恒的又是有效的。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **控制方程：** 二维可压缩欧拉方程的守恒形式：\n    $$\n    \\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} + \\frac{\\partial \\boldsymbol{G}(\\boldsymbol{U})}{\\partial y} = \\boldsymbol{0}.\n    $$\n-   **状态向量：** 守恒变量向量为 $\\boldsymbol{U} = [\\rho, \\rho u, \\rho v, \\rho E]^{\\top}$。\n-   **通量向量：** $\\boldsymbol{F}(\\boldsymbol{U})$ 是 $x$ 方向的通量，$\\boldsymbol{G}(\\boldsymbol{U})$ 是 $y$ 方向的通量。\n-   **流动场景：** 高超声速马赫数下钝体上的无粘流动。\n-   **离散化方法：** 笛卡尔网格上的有限体积法，单元格由 $(i,j)$ 索引，每个单元格内的状态为分段常数。\n-   **数值格式：** 一个守恒的有限体积更新格式：\n    $$\n    \\boldsymbol{U}_{i,j}^{n+1} = \\boldsymbol{U}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(\\widehat{\\boldsymbol{F}}_{i+\\frac{1}{2},j} - \\widehat{\\boldsymbol{F}}_{i-\\frac{1}{2},j}\\right) - \\frac{\\Delta t}{\\Delta y}\\left(\\widehat{\\boldsymbol{G}}_{i,j+\\frac{1}{2}} - \\widehat{\\boldsymbol{G}}_{i,j-\\frac{1}{2}}\\right).\n    $$\n-   **数值通量：** $\\widehat{\\boldsymbol{F}}$ 和 $\\widehat{\\boldsymbol{G}}$ 是一致性数值通量。\n-   **激波跳跃条件：** 对于静止的、与网格对齐的激波，离散守恒性意味着满足 Rankine–Hugoniot 条件：$s\\,[\\boldsymbol{U}] = [\\boldsymbol{F}_n(\\boldsymbol{U})]$，其中 $\\boldsymbol{F}_n(\\boldsymbol{U}) = n_x\\,\\boldsymbol{F}(\\boldsymbol{U}) + n_y\\,\\boldsymbol{G}(\\boldsymbolU)$。\n-   **数值伪影：** “痈现象”发生在强的、与网格对齐的激波附近。\n-   **伪影原因：** 横向耗散不足以及数值耗散与计算网格过度对齐。\n-   **评估标准：** 提出的修正方案必须既是守恒的，又能在减少痈现象方面有效。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据：** 问题陈述牢固地植根于 CFD 的既定理论和实践。欧拉方程、有限体积法、近似黎曼求解器、Rankine-Hugoniot 条件和痈现象都是该领域中标准的、有充分文献记载的课题。\n-   **适定性：** 这是一个适定问题。它要求根据两个具体标准（守恒性和对痈现象的有效性）评估五种不同的、描述清晰的数值策略。答案可以根据双曲守恒律数值分析的既有知识确定。\n-   **客观性：** 问题使用 CFD 中精确、客观和标准的术语进行阐述。没有主观或基于意见的陈述。\n\n问题构想没有违反任何无效性标准。它在科学上是合理的、适定的、客观的和完整的。它解决了一个在高速流模拟中真实存在的、不容忽视的数值问题。\n\n**步骤 3：结论与行动**\n\n问题陈述是 **有效的**。将提供完整解答。\n\n### 解答推导\n\n问题的核心是“痈现象”，这是一种数值不稳定性，表现为在捕捉到的本应光滑的激波波阵面上出现一个伪的、不符合物理的“疙瘩”或凸起。当强激波与计算网格完全对齐时，它会出现在某些激波捕捉格式中（特别是基于 Roe 近似黎曼求解器的格式）。根本原因在于，逐维应用的一维黎曼求解器未能在激波的横向方向上提供足够的耗散或耦合。对于与网格对齐的激波，数值耗散集中在网格法向方向，使得网格切向方向容易受到不稳定性的影响，特别是奇偶解耦。\n\n如果一个数值格式的更新可以写成问题陈述中提供的伸缩通量差分形式，那么它就是守恒的。这确保了整个区域内守恒量变化的总和仅由区域边界上的通量决定，从而正确地模拟了物理守恒律。对于界面上的数值通量 $\\widehat{\\boldsymbol{F}}(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$，守恒性要求其具有一致性，即 $\\widehat{\\boldsymbol{F}}(\\boldsymbol{U}, \\boldsymbol{U}) = \\boldsymbol{F}(\\boldsymbol{U})$。\n\n任务是根据两个标准评估每个选项：\n1.  **守恒性：** 该方法是否保持了离散守恒形式？\n2.  **有效性：** 该方法是否是已知的、针对痈现象的有效补救措施？\n\n### 逐项分析\n\n**A. 用双波 Harten–Lax–van Leer (HLL 或 HLLE) 通量替换 Roe 型线性化通量，并通过旋转黎曼求解器对其进行增强，该求解器将耗散与根据 $\\nabla p$ 计算的局部激波法向 $\\boldsymbol{n}$ 对齐，从而在保持通量差分形式的同时增加横向耗散。**\n\n-   **守恒性：** HLL 族通量在构造上是守恒的，因为它们直接从守恒律的积分形式导出，从而得到一致性的数值通量。旋转黎曼求解器通过将左右状态旋转到一个与局部特征（此处为根据 $\\nabla p$ 估计的激波法向）对齐的坐标系中，在这个旋转坐标系中求解一维黎曼问题，然后将得到的通量向量旋转回原始笛卡尔坐标系，来计算单元界面上的通量。这个过程在界面上仍然产生一个单一的通量向量 $\\widehat{\\boldsymbol{F}}_{i+1/2, j}$，它是相邻单元状态的函数。因此，有限体积更新的通量差分形式得以保持，该方法是守恒的。\n-   **有效性：** 这是一种经典且有效的治疗痈现象的方法。其根本病理在于黎曼求解器的一维性质及其与网格对齐的耗散。通过旋转求解器使其与物理上相关的激波法向（由 $\\nabla p$ 近似）对齐，该格式在与网格斜交的方向上引入了耗散。这在横向方向上提供了必要的耗散，从而抑制了不稳定性。与 Roe 求解器相比，HLL 型通量在处理强激波时固有的鲁棒性也有助于提高稳定性。\n-   **结论：** **正确**。\n\n**B. 在通量更新之间，通过在动量方程中专门引入一个以单元为中心的人工压力扩散项作为源项，增加一个显式的压力光滑步骤，该项由激波传感器调节以抑制奇偶解耦。**\n\n-   **守恒性：** 控制方程是一个系统：$\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\nabla \\cdot \\mathcal{F} = \\boldsymbol{0}$。一个守恒的离散化会保持这种结构。在更新的右侧添加一个源项，比如 $\\boldsymbol{S}$，使得 $\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\nabla \\cdot \\mathcal{F} = \\boldsymbol{S}$，会破坏守恒形式，除非 $\\boldsymbol{S}$ 本身可以写成某个通量的散度，而这里情况并非如此。*仅*在动量方程中添加一个扩散项，例如 $\\boldsymbol{S}_{mom} \\propto \\nabla^2 p$，而没有对能量方程做相应修改，会违反总能量守恒。物理定律是耦合的；数值格式必须尊重这种耦合才能保证守恒性。这个提议的修改是一个非守恒的“修复”。\n-   **有效性：** 这种压力光滑或人工粘性项被证明在抑制痈现象特征的振荡方面是有效的。通过平滑压力场，它直接对抗了奇偶解耦。然而，其非守恒性是一个主要缺点。\n-   **结论：** **错误**。该方法不守恒，而这是必需的标准。\n\n**C. 仅在流向（平行于激波法向）应用总变差减小 (TVD) 限制器，而保持横向重构不受限制，不改变数值通量函数。**\n\n-   **守恒性：** 斜率限制器的使用是重构步骤（例如，在 MUSCL 格式中）的一部分，用于确定单元界面上的状态 $\\boldsymbol{U}_L$ 和 $\\boldsymbol{U}_R$。然后计算数值通量函数 $\\widehat{\\boldsymbol{F}}(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$。无论限制重构如何执行，甚至在某个方向上省略，整个有限体积格式仍然保持守恒的通量差分形式。该方法是守恒的。\n-   **有效性：** 这个策略适得其反。TVD 限制器通过增加数值耗散来抑制振荡，这也是它们被使用的原因。痈现象是由横向耗散*不足*引起的。通过在横向方向上移除限制器（从而移除其相关的耗散），将会鼓励而不是抑制振荡的增长。这几乎肯定会加剧痈现象不稳定性。正确的方法是*增加*横向的耗散。\n-   **结论：** **错误**。该方法无效；它是有害的。\n\n**D. 通过由完整特征结构构造的矩阵人工粘性来增强 Roe 型通量，在数值通量内部的 $x$ 和 $y$ 方向上增加与谱半径成正比的耗散项，其设计旨在与熵相容并通过修正的界面通量保持守恒性。**\n\n-   **守恒性：** 矩阵人工粘性 (MAV) 被设计为直接并入数值通量的耗散项中。对于 Roe 求解器，通量为 $\\widehat{\\boldsymbol{F}} = \\frac{1}{2}(\\boldsymbol{F}_L + \\boldsymbol{F}_R) - \\frac{1}{2}|\\tilde{\\boldsymbol{A}}|(\\boldsymbol{U}_R - \\boldsymbol{U}_L)$。MAV 修改了耗散矩阵 $|\\tilde{\\boldsymbol{A}}|$。由于此修改完全包含在数值通量函数 $\\widehat{\\boldsymbol{F}}$ 内，而该函数仍然是左右状态的一致性函数，因此最终的有限体积格式是完全守恒的。\n-   **有效性：** 这是另一种先进且有效的治疗痈现象的技术。Roe 格式的失败之处在于，对于与网格对齐的激波，与线性退化的接触波和剪切波相关的耗散可能会消失。MAV 通过重新设计耗散矩阵 $|\\boldsymbol{A}|$ 来解决这个问题，以确保它保持正定，并为所有波族提供足够的阻尼，尤其是在横向方向。通过在所有方向上添加与谱半径（最大波速）成正比的耗散，它提供了一个多维的阻尼源，从而稳定了激波波阵面。\n-   **结论：** **正确**。\n\n**E. 在激波区域引入低马赫数预处理，以修改特征速度并增加数值耗散，假设保持相同的通量差分形式。**\n\n-   **守恒性：** 预处理格式修改了偏微分方程系统的时间导数项，例如 $\\boldsymbol{P}^{-1} \\partial_t \\boldsymbol{U} + \\nabla \\cdot \\mathcal{F} = 0$。虽然对于这类预处理系统存在守恒的离散化方法，但该方法本身的适用性是关键问题。\n-   **有效性：** 这个提议对于本问题在物理上和数值上都是无稽之谈。低马赫数预处理是专门为*低马赫数*（$M \\to 0$）流区开发的技术，在该流区流动近似不可压缩。在这种情况下，欧拉方程会变得刚性，因为声波速度远大于流速，导致严重的时间步长限制和精度损失。预处理通过重新调整系统特征值来缓解这种刚性。而本问题的情景是带有*强激波*的*高超声速马赫数*流动。在此处应用低马赫数技术是对该方法的根本性误用。它并非为强激波的高度可压缩流区设计，也对之无效。它会破坏波传播的物理特性。\n-   **结论：** **错误**。该方法完全不适用于指定的物理流区。\n\n### 总结\n\n根据分析，策略 A 和 D 都是守恒的，并且是已知的治疗痈现象的有效方法。它们都通过引入标准、与网格对齐的一维近似黎曼求解器中所缺失的必要的多维或横向耗散来起作用。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}