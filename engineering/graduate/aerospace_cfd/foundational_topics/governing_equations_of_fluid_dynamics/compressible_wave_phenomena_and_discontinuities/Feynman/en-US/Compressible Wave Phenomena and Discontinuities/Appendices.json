{
    "hands_on_practices": [
        {
            "introduction": "Understanding shock waves begins with the fundamental conservation laws. The Rankine-Hugoniot relations, which describe the jump in flow properties across a shock, are derived directly from the integral form of the Euler equations. This first practice focuses on the simplest of these, the conservation of mass, to determine one of the most important properties of a shock: its propagation speed, $s$. By applying the principle of mass flux continuity in a frame of reference moving with the shock, you will derive and apply the foundational formula for shock speed, a critical first step in analyzing any compressible discontinuity .",
            "id": "3948139",
            "problem": "A one-dimensional, planar compressive shock in a gas is modeled using the inviscid one-dimensional Euler equations, as is standard in Computational Fluid Dynamics (CFD). Consider a shock separating two uniform constant states, denoted by the left state $\\left(\\rho_{L}, u_{L}, p_{L}\\right)$ and the right state $\\left(\\rho_{R}, u_{R}, p_{R}\\right)$, where $\\rho$ is density, $u$ is the flow velocity in the laboratory frame, and $p$ is the thermodynamic pressure. The discontinuity (shock) propagates in the positive $x$-direction with an unknown shock speed $s$. The left state represents the upstream flow and the right state represents the downstream flow. Assume the discontinuity is planar and steady in the shock-attached frame, and that the flow is inviscid and adiabatic with no body forces.\n\nStarting from the integral form of conservation of mass across a moving discontinuity, use the fact that the mass flux $m$ normal to the shock is continuous and is given by $m = \\rho \\left(u - s\\right)$ on each side of the shock. Derive an explicit analytical expression for the shock speed $s$ in terms of $\\rho_{L}$, $u_{L}$, $\\rho_{R}$, and $u_{R}$ only. Then, evaluate $s$ for the following numerically specified left and right states:\n- $\\rho_{L} = 1.1~\\mathrm{kg/m^{3}}$, $u_{L} = 80~\\mathrm{m/s}$, $p_{L} = 1.00 \\times 10^{5}~\\mathrm{Pa}$,\n- $\\rho_{R} = 3.5~\\mathrm{kg/m^{3}}$, $u_{R} = 260~\\mathrm{m/s}$, $p_{R} = 1.51975 \\times 10^{5}~\\mathrm{Pa}$.\n\nExpress your final numerical answer for the shock speed in $\\mathrm{m/s}$ and round your answer to four significant figures. You must provide a single final number as your answer.",
            "solution": "The problem requires the derivation of an analytical expression for the shock speed, $s$, and its subsequent numerical evaluation. The derivation starts from the principle of mass conservation across a moving discontinuity.\n\nThe problem states that the mass flux, $m$, normal to the shock is continuous. The mass flux is defined in the laboratory frame relative to the moving shock as $m = \\rho(u-s)$, where $\\rho$ is the density, $u$ is the fluid velocity in the laboratory frame, and $s$ is the shock's propagation speed. The continuity of mass flux across the shock means that the value of $m$ is the same on the upstream (left, subscript $L$) and downstream (right, subscript $R$) sides of the discontinuity.\n\nThis gives the governing relation:\n$$m_{L} = m_{R}$$\nSubstituting the given expression for mass flux, we have:\n$$\\rho_{L} (u_{L} - s) = \\rho_{R} (u_{R} - s)$$\n\nThis equation is one of the Rankine-Hugoniot relations, specifically the one for mass conservation. To find an explicit expression for the shock speed $s$, we must rearrange this equation algebraically. First, we expand both sides of the equation:\n$$\\rho_{L} u_{L} - \\rho_{L} s = \\rho_{R} u_{R} - \\rho_{R} s$$\n\nNext, we gather all terms containing the unknown variable $s$ on one side of the equation and all other terms on the other side.\n$$\\rho_{R} s - \\rho_{L} s = \\rho_{R} u_{R} - \\rho_{L} u_{L}$$\n\nWe can factor out $s$ from the terms on the left-hand side:\n$$s (\\rho_{R} - \\rho_{L}) = \\rho_{R} u_{R} - \\rho_{L} u_{L}$$\n\nFinally, we isolate $s$ by dividing by the term $(\\rho_{R} - \\rho_{L})$. This is permissible as for a shock, there is a density jump, so $\\rho_{R} \\neq \\rho_{L}$. Specifically, for a compressive shock, $\\rho_{R} > \\rho_{L}$, so the denominator is non-zero.\n$$s = \\frac{\\rho_{R} u_{R} - \\rho_{L} u_{L}}{\\rho_{R} - \\rho_{L}}$$\n\nThis is the required explicit analytical expression for the shock speed $s$ in terms of $\\rho_{L}$, $u_{L}$, $\\rho_{R}$, and $u_{R}$. Note that the pressure values, $p_L$ and $p_R$, are not required for this specific derivation, as per the problem statement.\n\nNow, we evaluate this expression using the provided numerical values:\n- $\\rho_{L} = 1.1~\\mathrm{kg/m^{3}}$\n- $u_{L} = 80~\\mathrm{m/s}$\n- $\\rho_{R} = 3.5~\\mathrm{kg/m^{3}}$\n- $u_{R} = 260~\\mathrm{m/s}$\n\nWe first compute the numerator of the expression, which represents the difference in momentum flux, $\\rho u$:\n$$\\rho_{R} u_{R} - \\rho_{L} u_{L} = (3.5)(260) - (1.1)(80)$$\n$$\\rho_{R} u_{R} - \\rho_{L} u_{L} = 910 - 88 = 822~\\mathrm{kg/(m^2 \\cdot s)}$$\n\nNext, we compute the denominator, which is the change in density:\n$$\\rho_{R} - \\rho_{L} = 3.5 - 1.1 = 2.4~\\mathrm{kg/m^3}$$\n\nNow we can calculate the shock speed $s$:\n$$s = \\frac{822}{2.4} = 342.5~\\mathrm{m/s}$$\n\nThe problem requires the final answer to be rounded to four significant figures. The calculated value $342.5$ already has exactly four significant figures. Therefore, no further rounding is necessary.\nThe shock speed is $s = 342.5~\\mathrm{m/s}$. The positive sign indicates that the shock is propagating in the positive $x$-direction, consistent with the problem description.",
            "answer": "$$\\boxed{342.5}$$"
        },
        {
            "introduction": "Building on the concept of jump conditions, we now move to a more comprehensive problem: determining the full thermodynamic state downstream of a shock. This exercise introduces the \"shock-fitting\" technique, a classic approach in CFD where the shock is explicitly treated as a moving boundary separating two smooth regions of flow. You will derive the complete set of jump conditions for mass, momentum, and energy and implement them computationally to see how an upstream state $(p_1, T_1, u_1)$ is transformed into a downstream state $(p_2, T_2, u_2)$ by a shock moving at speed $V_s$. This practice is essential for translating the theoretical Rankine-Hugoniot relations into a practical tool for simulating flows with discontinuities .",
            "id": "3948183",
            "problem": "Consider a one-dimensional, planar shock-fitting formulation for inviscid, compressible, ideal-gas flow in the context of Computational Fluid Dynamics (CFD, Computational Fluid Dynamics). The shock is treated as a moving boundary with a specified normal speed, and the interior flow solutions on both sides are coupled by conservation laws across the discontinuity. Starting from the integral conservation statements for mass, momentum, and energy applied to a thin space-time control volume that straddles the discontinuity, derive the jump conditions that relate the states immediately upstream and downstream of the moving shock in the laboratory frame.\n\nYou must begin from a valid fundamental base: the integral form of the Euler equations (mass, momentum, and energy conservation) and the ideal-gas equation of state, expressed for a differential control surface whose boundary moves with a given normal speed. Do not use or assume any pre-derived jump relations as a shortcut in the derivation. Clarify how the shock kinematics enter the coupling, and how the normal component of the fluid velocity relative to the shock appears in the fluxes.\n\nOnce the jump conditions are derived, implement them in a program that, for each provided test case, takes the upstream thermodynamic state and normal velocity along with the shock-normal speed and returns the downstream thermodynamic state and velocity in the laboratory frame. Assume an ideal gas characterized by ratio of specific heats and specific gas constant. If the upstream normal Mach number relative to the shock is not strictly supersonic, treat the interface as a vanishing discontinuity and return the upstream state unchanged while still reporting the mass flux computed from the relative motion.\n\nDefine all variables in your derivation and implementation. Use the following conventions:\n- Let the upstream state be $(p_1, T_1, \\rho_1, u_1)$ where $p_1$ is pressure, $T_1$ is temperature, $\\rho_1$ is density, and $u_1$ is the fluid velocity normal to the shock, all measured in the laboratory frame.\n- Let the shock-normal speed be $V_s$ in the laboratory frame; positive $V_s$ means the shock moves in the positive normal direction.\n- Let the ratio of specific heats be $\\gamma$ and the specific gas constant be $R$.\n- Let the downstream state be $(p_2, T_2, \\rho_2, u_2)$ in the laboratory frame.\n- Let the mass flux per unit area crossing the shock be $\\dot{m}$ (signed), and the entropy change per unit mass be $\\Delta s = s_2 - s_1$.\n\nUnits and numerical requirements:\n- Pressures must be expressed in Pascals (Pa).\n- Temperatures must be expressed in Kelvin (K).\n- Densities must be expressed in kilograms per cubic meter (kg/m$^3$).\n- Velocities must be expressed in meters per second (m/s).\n- Entropy change must be expressed in Joules per kilogram-Kelvin (J/(kg·K)).\n- Mass flux per unit area must be expressed in kilograms per square meter-second (kg/(m$^2$·s)).\n- Use radians for any angles, although none are required in this one-dimensional setting.\n- Report all numerical outputs rounded to six decimal places.\n\nTest suite:\nFor all test cases, use $\\gamma = 1.4$ and $R = 287$ J/(kg·K). For each test case, compute and return the list $[p_2,\\ \\rho_2,\\ u_2,\\ \\Delta s,\\ \\dot{m}]$ in the specified units.\n\n- Test case 1 (happy path, moving shock forward):\n  - $p_1 = 101325$ Pa, $T_1 = 300$ K, $u_1 = 600$ m/s, $V_s = 100$ m/s.\n- Test case 2 (stationary shock, strong compression):\n  - $p_1 = 50000$ Pa, $T_1 = 250$ K, $u_1 = 800$ m/s, $V_s = 0$ m/s.\n- Test case 3 (shock moving upstream, moderate compression):\n  - $p_1 = 200000$ Pa, $T_1 = 350$ K, $u_1 = 500$ m/s, $V_s = -50$ m/s.\n- Test case 4 (near-sonic upstream relative to shock, weak compression):\n  - $p_1 = 90000$ Pa, $T_1 = 300$ K, $u_1 = 350$ m/s, $V_s = 0$ m/s.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case and must itself be a list in the form $[p_2,\\ \\rho_2,\\ u_2,\\ \\Delta s,\\ \\dot{m}]$ with all entries rounded to six decimal places, for example:\n$[[p_{2,1},\\rho_{2,1},u_{2,1},\\Delta s_1,\\dot{m}_1],[p_{2,2},\\rho_{2,2},u_{2,2},\\Delta s_2,\\dot{m}_2],\\ldots]$.",
            "solution": "We consider a one-dimensional, planar, inviscid, compressible flow of an ideal gas with a shock treated as a moving boundary. The coupling of interior solutions across the shock follows from the conservation laws applied to a thin control volume that straddles the discontinuity. Let the shock surface have a unit normal vector pointing from upstream side $1$ to downstream side $2$, and let the shock-normal speed in the laboratory frame be $V_s$. The fluid velocity normal to the shock on each side in the laboratory frame is $u_1$ and $u_2$, respectively. The thermodynamic states are $(p_1, T_1, \\rho_1)$ and $(p_2, T_2, \\rho_2)$, respectively. The gas is ideal with ratio of specific heats $\\gamma$ and specific gas constant $R$, and we denote the specific enthalpy by $h$ and the sound speed by $a = \\sqrt{\\gamma R T}$.\n\n1. Fundamental base: integral conservation laws for a moving control surface.\n\nDefine the jump operator across the shock as $[f] = f_2 - f_1$ for any quantity $f$ evaluated immediately downstream and upstream, respectively. Consider a thin pillbox control volume enclosing a portion of the shock surface, with its boundary moving with local speed $V_s$ along the normal. The integral forms of conservation laws for mass, momentum, and energy, applied to this control volume and letting the thickness tend to zero, lead to the following relations for an inviscid flow (neglecting body forces and heat conduction across an infinitesimally thin surface):\n\n- Mass conservation (continuity of normal mass flux relative to the moving surface):\n$$\n[\\rho (u_n - V_s)] = 0,\n$$\nwhere $u_n$ is the normal component of the fluid velocity in the laboratory frame.\n\n- Momentum conservation in the normal direction (balance of normal momentum flux and pressure):\n$$\n[\\rho (u_n - V_s) u_n + p] = 0.\n$$\n\n- Tangential momentum conservation for a planar, inviscid shock (no shear stress across an idealized shock and continuity of tangential velocity):\n$$\n[\\rho (u_n - V_s) u_t] = 0, \\quad \\text{and for a normal shock, } [u_t] = 0,\n$$\nwhere $u_t$ denotes the tangential component. In strictly one-dimensional normal shocks we have $u_t = 0$ on both sides.\n\n- Energy conservation (continuity of total enthalpy flux relative to the moving surface):\n$$\n\\left[ \\rho (u_n - V_s)\\left(h + \\tfrac{1}{2} u^2 \\right) \\right] = 0.\n$$\n\nThese relations hold regardless of the absolute shock speed in the laboratory frame; they are derived in the shock-attached sense by accounting for the moving boundary in the control surface term.\n\n2. Relative motion and the shock-attached interpretation.\n\nIntroduce the relative normal velocity with respect to the shock:\n$$\nw_1 = u_1 - V_s, \\quad w_2 = u_2 - V_s.\n$$\nThe mass conservation jump condition becomes\n$$\n\\rho_1 w_1 = \\rho_2 w_2 = \\dot{m},\n$$\nwhere $\\dot{m}$ is the mass flux per unit area crossing the shock (signed, positive in the downstream direction). The momentum condition in the normal direction reads\n$$\n\\rho_1 w_1 u_1 + p_1 = \\rho_2 w_2 u_2 + p_2,\n$$\nand the energy condition becomes\n$$\n\\rho_1 w_1 \\left(h_1 + \\tfrac{1}{2} u_1^2 \\right) = \\rho_2 w_2 \\left(h_2 + \\tfrac{1}{2} u_2^2 \\right).\n$$\nIn the shock-attached frame, the shock is stationary and the fluxes depend on $w_1$ and $w_2$ rather than $u_1$ and $u_2$. Using $u_i = V_s + w_i$, the momentum condition can be rewritten as\n$$\n\\rho_1 w_1 (V_s + w_1) + p_1 = \\rho_2 w_2 (V_s + w_2) + p_2.\n$$\nBecause $\\rho_1 w_1 = \\rho_2 w_2$, the terms with $V_s$ cancel, yielding the familiar stationary-shock momentum condition in terms of relative velocities:\n$$\np_2 - p_1 = \\dot{m} (w_1 - w_2).\n$$\nSimilarly, the energy condition reduces (after using the ideal-gas relation $h = c_p T$ with $c_p = \\gamma R / (\\gamma - 1)$ and algebraic manipulation) to the stationary-shock total enthalpy flux continuity in relative motion:\n$$\nh_1 + \\tfrac{1}{2} w_1^2 = h_2 + \\tfrac{1}{2} w_2^2.\n$$\n\n3. Jump conditions specialized to an ideal gas and normal shocks.\n\nFor an ideal gas, the equation of state is $p = \\rho R T$, and the sound speed is $a = \\sqrt{\\gamma R T}$. Define the upstream relative normal Mach number\n$$\nM_1 = \\frac{|w_1|}{a_1}, \\quad a_1 = \\sqrt{\\gamma R T_1}.\n$$\nFor a compressive normal shock, we require $M_1 > 1$. Under this condition, the Rankine–Hugoniot relations yield the classical downstream-to-upstream ratios in terms of $M_1$ and $\\gamma$:\n- Density ratio:\n$$\n\\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma + 1) M_1^2}{(\\gamma - 1) M_1^2 + 2}.\n$$\n- Pressure ratio:\n$$\n\\frac{p_2}{p_1} = 1 + \\frac{2 \\gamma}{\\gamma + 1} \\left(M_1^2 - 1\\right).\n$$\n- Temperature ratio follows from the ideal-gas law:\n$$\n\\frac{T_2}{T_1} = \\frac{p_2/p_1}{\\rho_2/\\rho_1}.\n$$\nMass conservation in relative motion provides\n$$\nw_2 = w_1 \\frac{\\rho_1}{\\rho_2},\n$$\nand the downstream laboratory-frame velocity is then\n$$\nu_2 = V_s + w_2.\n$$\nThe entropy change per unit mass across the shock is (for an ideal gas)\n$$\n\\Delta s = s_2 - s_1 = c_p \\ln\\left(\\frac{T_2}{T_1}\\right) - R \\ln\\left(\\frac{p_2}{p_1}\\right),\n$$\nwith $c_p = \\frac{\\gamma R}{\\gamma - 1}$.\n\nIf $M_1 \\leq 1$, a compressive normal shock cannot form. In a shock-fitting algorithm, the discontinuity degenerates. A consistent treatment in this limit is to return the upstream state unchanged: $p_2 = p_1$, $\\rho_2 = \\rho_1$, $T_2 = T_1$, and $u_2 = u_1$, with the entropy change set to $\\Delta s = 0$. The mass flux is still well-defined by relative motion:\n$$\n\\dot{m} = \\rho_1 w_1 = \\rho_1 (u_1 - V_s),\n$$\nwhich serves as a kinematic coupling quantity for interface motion even in the vanishing discontinuity limit.\n\n4. Algorithmic design for the program.\n\n- Input parameters per test case: $\\gamma$, $R$, $p_1$, $T_1$, $u_1$, $V_s$.\n- Compute the upstream density by the ideal-gas law:\n$$\n\\rho_1 = \\frac{p_1}{R T_1}.\n$$\n- Compute the upstream sound speed:\n$$\na_1 = \\sqrt{\\gamma R T_1}.\n$$\n- Compute the upstream relative normal velocity:\n$$\nw_1 = u_1 - V_s.\n$$\n- Compute the upstream relative Mach number:\n$$\nM_1 = \\frac{|w_1|}{a_1}.\n$$\n- If $M_1 \\leq 1$, set $p_2 = p_1$, $\\rho_2 = \\rho_1$, $T_2 = T_1$, $u_2 = u_1$, $\\Delta s = 0$, and $\\dot{m} = \\rho_1 w_1$.\n- If $M_1 > 1$, compute the downstream ratios via the jump conditions above, then:\n  - $\\rho_2 = \\rho_1 \\times (\\rho_2/\\rho_1)$,\n  - $p_2 = p_1 \\times (p_2/p_1)$,\n  - $T_2 = T_1 \\times (T_2/T_1)$,\n  - $w_2 = w_1 \\times (\\rho_1/\\rho_2)$,\n  - $u_2 = V_s + w_2$,\n  - $c_p = \\gamma R / (\\gamma - 1)$,\n  - $\\Delta s = c_p \\ln(T_2/T_1) - R \\ln(p_2/p_1)$,\n  - $\\dot{m} = \\rho_1 w_1$.\n\nFinally, report for each test case the list $[p_2,\\ \\rho_2,\\ u_2,\\ \\Delta s,\\ \\dot{m}]$, rounded to six decimal places, aggregated into a single bracketed list in the specified format.\n\nThis procedure embodies a shock-fitting approach: the shock is a moving boundary with speed $V_s$, the interior solutions on both sides are the Euler solutions constrained by the jump conditions, and the kinematic coupling occurs through the relative normal velocity $w$ and the mass flux $\\dot{m}$. The moving-boundary character enters only through $w = u - V_s$, and the downstream laboratory-frame velocity reconstruction $u_2 = V_s + w_2$ ensures consistency between the shock-attached analysis and the laboratory frame.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_downstream(gamma, R, p1, T1, u1, Vs, eps=1e-12):\n    \"\"\"\n    Compute downstream state for a 1D planar moving normal shock in an ideal gas.\n    Inputs:\n        gamma: ratio of specific heats\n        R: specific gas constant [J/(kg*K)]\n        p1: upstream pressure [Pa]\n        T1: upstream temperature [K]\n        u1: upstream normal velocity (lab frame) [m/s]\n        Vs: shock-normal speed (lab frame) [m/s]\n    Returns:\n        p2 [Pa], rho2 [kg/m^3], u2 [m/s], delta_s [J/(kg*K)], mflux [kg/(m^2*s)]\n    \"\"\"\n    # Upstream density and sound speed\n    rho1 = p1 / (R * T1)\n    a1 = np.sqrt(gamma * R * T1)\n\n    # Relative upstream velocity and Mach number\n    w1 = u1 - Vs\n    M1 = abs(w1) / a1 if a1 > 0 else 0.0\n\n    # Mass flux (signed)\n    mflux = rho1 * w1\n\n    if M1 = 1.0 + eps:\n        # Vanishing discontinuity: return upstream state unchanged, zero entropy change\n        p2 = p1\n        rho2 = rho1\n        # Downstream relative velocity equals upstream relative velocity; lab-frame velocity equals upstream\n        u2 = u1\n        delta_s = 0.0\n        return p2, rho2, u2, delta_s, mflux\n\n    # Rankine-Hugoniot relations for normal shock in ideal gas (in shock-attached relative motion)\n    M1sq = M1 * M1\n    rho_ratio = ((gamma + 1.0) * M1sq) / ((gamma - 1.0) * M1sq + 2.0)\n    p_ratio = 1.0 + (2.0 * gamma / (gamma + 1.0)) * (M1sq - 1.0)\n    # Temperature ratio from ideal gas\n    T_ratio = p_ratio / rho_ratio\n\n    rho2 = rho1 * rho_ratio\n    p2 = p1 * p_ratio\n    T2 = T1 * T_ratio\n\n    # Downstream relative velocity from mass conservation, then lab-frame velocity\n    w2 = w1 * (rho1 / rho2)\n    u2 = Vs + w2\n\n    # Entropy change across shock (ideal gas)\n    cp = gamma * R / (gamma - 1.0)\n    # Guard against any numerical issues (ensure positive ratios)\n    T_ratio_safe = max(T_ratio, eps)\n    p_ratio_safe = max(p_ratio, eps)\n    delta_s = cp * np.log(T_ratio_safe) - R * np.log(p_ratio_safe)\n\n    return p2, rho2, u2, delta_s, mflux\n\ndef solve():\n    # Define constants\n    gamma = 1.4\n    R = 287.0\n\n    # Define the test cases from the problem statement.\n    # Each case: (p1 [Pa], T1 [K], u1 [m/s], Vs [m/s])\n    test_cases = [\n        (101325.0, 300.0, 600.0, 100.0),   # Test case 1\n        (50000.0, 250.0, 800.0, 0.0),      # Test case 2\n        (200000.0, 350.0, 500.0, -50.0),   # Test case 3\n        (90000.0, 300.0, 350.0, 0.0),      # Test case 4\n    ]\n\n    results = []\n    for (p1, T1, u1, Vs) in test_cases:\n        p2, rho2, u2, delta_s, mflux = compute_downstream(gamma, R, p1, T1, u1, Vs)\n        # Round to six decimal places as required\n        res = [\n            float(f\"{p2:.6f}\"),\n            float(f\"{rho2:.6f}\"),\n            float(f\"{u2:.6f}\"),\n            float(f\"{delta_s:.6f}\"),\n            float(f\"{mflux:.6f}\")\n        ]\n        results.append(res)\n\n    # Format the output exactly as a single line with the list of lists\n    # Ensure consistent floating-point formatting\n    def format_list_of_lists(lol):\n        inner = []\n        for sub in lol:\n            inner.append(\"[\" + \",\".join(f\"{x:.6f}\" for x in sub) + \"]\")\n        return \"[\" + \",\".join(inner) + \"]\"\n\n    print(format_list_of_lists(results))\n\nsolve()\n```"
        },
        {
            "introduction": "While shock-fitting is powerful, many modern CFD codes use \"shock-capturing\" methods, where discontinuities are resolved automatically as part of the grid solution. This requires sophisticated numerical flux functions, and one of the most influential is the Roe solver. This advanced practice guides you through the construction of a Roe approximate Riemann solver, from the underlying theory of Roe-averaging to the eigen-decomposition of the flux Jacobian. You will learn how the system's wave structure, with its acoustic and entropy waves traveling at speeds $\\tilde{u} \\pm \\tilde{a}$ and $\\tilde{u}$, dictates the upwinding and numerical dissipation needed for a stable scheme. Implementing a Roe flux function is a cornerstone skill in computational gas dynamics, providing deep insight into the workings of modern finite-volume methods .",
            "id": "3948194",
            "problem": "You are tasked with constructing a Roe’s linearized Riemann solver for the one-dimensional compressible Euler equations of a perfect gas, and to use it to compute numerical fluxes across an interface for specified left and right states. The construction must start from the fundamental conservation laws and the perfect-gas equation of state, and proceed by deriving an appropriate linearization of the flux Jacobian at a Roe-averaged state. Specifically, you must:\n\n1. Begin from the one-dimensional Euler equations for mass, momentum, and energy conservation, with conserved variable vector $\\,\\mathbf{Q} = [\\rho,\\, \\rho u,\\, \\rho E]^\\top\\,$ and flux vector $\\,\\mathbf{F}(\\mathbf{Q}) = [\\rho u,\\, \\rho u^2 + p,\\, u(\\rho E + p)]^\\top\\,$, where $\\,\\rho\\,$ is density, $\\,u\\,$ is velocity, $\\,p\\,$ is pressure, and $\\,E\\,$ is the specific total energy. The perfect-gas equation of state is $\\,p = (\\gamma - 1)\\rho e\\,$, with specific internal energy $\\,e\\,$, and specific total energy $\\,E = e + \\tfrac{1}{2}u^2\\,$. Assume $\\,\\gamma > 1\\,$ constant.\n\n2. Define a Roe-averaged state by appropriately weighting the left and right states such that the Jacobian matrix $\\,\\tilde{\\mathbf{A}} = \\partial \\mathbf{F}/\\partial \\mathbf{Q}\\,$ evaluated at the Roe-averaged variables has a real eigenstructure with three distinct waves. The Roe-averaged variables must include a velocity $\\,\\tilde{u}\\,$, a total enthalpy $\\,\\tilde{H}\\,$, and a sound speed $\\,\\tilde{a}\\,$ derived consistently from the perfect-gas relations and the requirement that the linearization preserves the Rankine–Hugoniot jump conditions.\n\n3. Derive the eigenstructure (eigenvalues and right eigenvectors) of the Jacobian $\\,\\tilde{\\mathbf{A}}\\,$ at the Roe state. The eigenvalues must be identifiable as $\\,\\tilde{u} - \\tilde{a}\\,$, $\\,\\tilde{u}\\,$, and $\\,\\tilde{u} + \\tilde{a}\\,$, corresponding to left-going acoustic, contact (entropy), and right-going acoustic waves. Explain the upwinding mechanism: the sign of each eigenvalue determines the direction of information propagation for the corresponding characteristic family, and numerical dissipation must be constructed accordingly. Include an entropy fix that regularizes the dissipation near sonic points where an eigenvalue magnitude approaches zero.\n\n4. Using the derived Roe linearization and upwinding principle, implement a computational routine to evaluate the Roe numerical flux $\\,\\mathbf{F}_{\\text{Roe}}\\,$ at an interface given left and right primitive states $\\,(\\rho_L, u_L, p_L)\\,$ and $\\,(\\rho_R, u_R, p_R)\\,$ along with $\\,\\gamma\\,$. The output must be the numerical flux vector components $\\,\\mathbf{F}_{\\text{Roe}} = [F_{\\rho}, F_{\\rho u}, F_{\\rho E}]^\\top\\,$, where $\\,F_{\\rho}\\,$ is the mass flux in $\\mathrm{kg/(m^2\\cdot s)}$, $\\,F_{\\rho u}\\,$ is the momentum flux in $\\mathrm{N/m^2}$, and $\\,F_{\\rho E}\\,$ is the energy flux in $\\mathrm{W/m^2}$. All calculations must be in International System of Units (SI).\n\nYour program must evaluate the Roe numerical flux for the following test suite of cases (each case specifies $\\,\\rho_L\\,$ in $\\mathrm{kg/m^3}$, $\\,u_L\\,$ in $\\mathrm{m/s}$, $\\,p_L\\,$ in $\\mathrm{Pa}$, $\\,\\rho_R\\,$ in $\\mathrm{kg/m^3}$, $\\,u_R\\,$ in $\\mathrm{m/s}$, $\\,p_R\\,$ in $\\mathrm{Pa}$, and $\\,\\gamma\\,$ dimensionless):\n\n- Case 1 (Supersonic right-going, all eigenvalues positive): $\\,\\rho_L = 1.0\\,$, $\\,u_L = 800.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 0.8\\,$, $\\,u_R = 700.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- Case 2 (Transonic mixed, one acoustic family changes sign): $\\,\\rho_L = 1.0\\,$, $\\,u_L = 300.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 0.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- Case 3 (Strong pressure jump, stationary interface): $\\,\\rho_L = 5.0\\,$, $\\,u_L = 0.0\\,$, $\\,p_L = 500000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 0.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n- Case 4 (Contact discontinuity, equal pressure and velocity): $\\,\\rho_L = 2.0\\,$, $\\,u_L = 100.0\\,$, $\\,p_L = 100000.0\\,$; $\\,\\rho_R = 1.0\\,$, $\\,u_R = 100.0\\,$, $\\,p_R = 100000.0\\,$; $\\,\\gamma = 1.4\\,$.\n\nImplement an entropy fix that modifies the absolute value $\\,|\\lambda|\\,$ of any eigenvalue $\\,\\lambda\\,$ via the piecewise function $\\,\\phi(|\\lambda|) = |\\lambda|\\,$ if $\\,|\\lambda| \\ge \\delta\\,$ and $\\,\\phi(|\\lambda|) = \\tfrac{1}{2}\\left(\\tfrac{\\lambda^2}{\\delta} + \\delta\\right)\\,$ if $\\,|\\lambda|  \\delta\\,$, where $\\,\\delta = \\varepsilon \\tilde{a}\\,$ and $\\,\\varepsilon = 0.1\\,$. Use $\\,\\delta\\,$ with units of $\\mathrm{m/s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Represent each case’s flux vector as a sublist of three floats $[F_{\\rho}, F_{\\rho u}, F_{\\rho E}]$ with no spaces, and aggregate the four sublists into a single outer list. For example, the output format must be like $\\,[[f_{11},f_{12},f_{13}],[f_{21},f_{22},f_{23}],[f_{31},f_{32},f_{33}],[f_{41},f_{42},f_{43}]]\\,$, where each $\\,f_{ij}\\,$ is a float. The numerical values must be in the units specified above for mass, momentum, and energy fluxes, respectively.",
            "solution": "The task is to construct Roe's linearized Riemann solver for the one-dimensional compressible Euler equations and use it to compute the numerical flux at an interface for given left and right states. The derivation begins with the fundamental equations and proceeds to the final numerical flux formula, including the Roe-averaging procedure, eigenstructure analysis, and an entropy fix.\n\nThe one-dimensional Euler equations in conservation form are given by:\n$$\n\\frac{\\partial \\mathbf{Q}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0}\n$$\nwhere $\\mathbf{Q}$ is the vector of conserved variables and $\\mathbf{F}(\\mathbf{Q})$ is the flux vector:\n$$\n\\mathbf{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{Q}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{pmatrix}\n$$\nHere, $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E$ is the specific total energy. For a perfect gas, the pressure is related to the specific internal energy $e$ by the equation of state:\n$$\np = (\\gamma - 1)\\rho e\n$$\nwhere $\\gamma$ is the constant ratio of specific heats. The specific total energy $E$ is the sum of specific internal and kinetic energies:\n$$\nE = e + \\frac{1}{2}u^2\n$$\nFrom these relations, we can express pressure $p$ and total enthalpy $H$ in terms of primitive variables $(\\rho, u, p)$ or conserved variables $\\mathbf{Q}$:\n$$\np = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^2\\right)\n$$\n$$\nH = E + \\frac{p}{\\rho} = e + \\frac{1}{2}u^2 + \\frac{p}{\\rho} = \\frac{\\gamma p}{(\\gamma-1)\\rho} + \\frac{1}{2}u^2\n$$\n\nThe Roe solver is based on finding a matrix $\\tilde{\\mathbf{A}}(\\mathbf{Q}_L, \\mathbf{Q}_R)$ that is a consistent linearization of the flux Jacobian $\\mathbf{A}(\\mathbf{Q}) = \\partial\\mathbf{F}/\\partial\\mathbf{Q}$. This matrix must satisfy three properties:\n1.  It is hyperbolic for any states $\\mathbf{Q}_L, \\mathbf{Q}_R$, meaning it has a full set of real eigenvalues and linearly independent eigenvectors.\n2.  It is consistent with the Jacobian, i.e., $\\tilde{\\mathbf{A}}(\\mathbf{Q}, \\mathbf{Q}) = \\mathbf{A}(\\mathbf{Q})$.\n3.  It satisfies the Rankine-Hugoniot jump condition across a discontinuity: $\\mathbf{F}(\\mathbf{Q}_R) - \\mathbf{F}(\\mathbf{Q}_L) = \\tilde{\\mathbf{A}}(\\mathbf{Q}_R - \\mathbf{Q}_L)$.\n\nSuch a matrix can be constructed by evaluating the Jacobian $\\mathbf{A}(\\mathbf{Q})$ at a specially defined \"Roe-averaged\" state. For the Euler equations with a perfect gas, the Roe averages are:\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\nFrom the Roe-averaged total enthalpy $\\tilde{H}$ and velocity $\\tilde{u}$, we can define a consistent Roe-averaged sound speed $\\tilde{a}$:\n$$\n\\tilde{a}^2 = (\\gamma - 1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right)\n$$\nThe Roe matrix $\\tilde{\\mathbf{A}}$ is the flux Jacobian $\\mathbf{A}$ expressed in terms of primitive variables and evaluated at this Roe-averaged state $(\\tilde{u}, \\tilde{H}, \\tilde{a})$. The Jacobian matrix is:\n$$\n\\mathbf{A} = \\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}u^2  (3-\\gamma)u  \\gamma-1 \\\\ u\\left(\\frac{\\gamma-1}{2}u^2 - H\\right)  H - (\\gamma-1)u^2  \\gamma u \\end{pmatrix}\n$$\nEvaluating this at the Roe state gives $\\tilde{\\mathbf{A}} = \\mathbf{A}(\\tilde{u}, \\tilde{H})$.\n\nThe eigenstructure of $\\tilde{\\mathbf{A}}$ is central to the solver. The eigenvalues are:\n$$\n\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}, \\quad \\tilde{\\lambda}_2 = \\tilde{u}, \\quad \\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a}\n$$\nThese eigenvalues correspond to the speeds of a left-going acoustic wave, a contact (entropy) wave, and a right-going acoustic wave, respectively. The signs of these eigenvalues indicate the direction of information propagation for each characteristic family.\nThe corresponding right eigenvectors are:\n$$\n\\tilde{\\mathbf{k}}_1 = \\begin{pmatrix} 1 \\\\ \\tilde{u}-\\tilde{a} \\\\ \\tilde{H}-\\tilde{u}\\tilde{a} \\end{pmatrix}, \\quad \\tilde{\\mathbf{k}}_2 = \\begin{pmatrix} 1 \\\\ \\tilde{u} \\\\ \\frac{1}{2}\\tilde{u}^2 \\end{pmatrix}, \\quad \\tilde{\\mathbf{k}}_3 = \\begin{pmatrix} 1 \\\\ \\tilde{u}+\\tilde{a} \\\\ \\tilde{H}+\\tilde{u}\\tilde{a} \\end{pmatrix}\n$$\nThe jump in conserved variables, $\\Delta \\mathbf{Q} = \\mathbf{Q}_R - \\mathbf{Q}_L$, can be projected onto this eigenvector basis:\n$$\n\\Delta \\mathbf{Q} = \\sum_{i=1}^3 \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\nwhere $\\tilde{\\alpha}_i$ are the wave strengths. Solving this $3 \\times 3$ system for $\\tilde{\\alpha}_i$ yields:\n$$\n\\tilde{\\alpha}_2 = \\frac{\\gamma-1}{\\tilde{a}^2} \\left[ (\\tilde{H}-\\tilde{u}^2)\\Delta\\rho + \\tilde{u}\\Delta(\\rho u) - \\Delta(\\rho E) \\right]\n$$\n$$\n\\tilde{\\alpha}_1 = \\frac{1}{2} \\left[ (\\Delta\\rho - \\tilde{\\alpha}_2) + \\frac{\\tilde{u}\\Delta\\rho - \\Delta(\\rho u)}{\\tilde{a}} \\right]\n$$\n$$\n\\tilde{\\alpha}_3 = \\frac{1}{2} \\left[ (\\Delta\\rho - \\tilde{\\alpha}_2) - \\frac{\\tilde{u}\\Delta\\rho - \\Delta(\\rho u)}{\\tilde{a}} \\right]\n$$\nwhere $\\Delta\\rho = \\rho_R - \\rho_L$, $\\Delta(\\rho u) = (\\rho u)_R - (\\rho u)_L$, and $\\Delta(\\rho E) = (\\rho E)_R - (\\rho E)_L$.\n\nThe Roe numerical flux, $\\mathbf{F}_{\\text{Roe}}$, is a Godunov-type flux that incorporates upwinding based on the signs of the eigenvalues. It is calculated as the average of the left and right fluxes plus a dissipation term that accounts for the wave structure of the Riemann problem solution:\n$$\n\\mathbf{F}_{\\text{Roe}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{1}{2} |\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L)\n$$\nThe dissipation term $|\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L)$ is computed using the eigen-decomposition:\n$$\n|\\tilde{\\mathbf{A}}|(\\mathbf{Q}_R - \\mathbf{Q}_L) = \\sum_{i=1}^3 |\\tilde{\\lambda}_i| \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\nThis leads to the final expression for the Roe flux:\n$$\n\\mathbf{F}_{\\text{Roe}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{1}{2} \\sum_{i=1}^3 |\\tilde{\\lambda}_i| \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i\n$$\n\nA critical issue with the Roe solver is the failure to add sufficient dissipation for transonic rarefaction waves, where an eigenvalue $\\tilde{\\lambda}_i$ can pass through zero. This can lead to entropy-violating expansion shocks. To remedy this, an \"entropy fix\" is applied by modifying the absolute value function $|\\lambda|$. As specified, we replace $|\\lambda|$ with a function $\\phi(|\\lambda|)$:\n$$\n\\phi(|\\lambda|) = \\begin{cases} |\\lambda|  \\text{if } |\\lambda| \\ge \\delta \\\\ \\frac{1}{2}\\left(\\frac{\\lambda^2}{\\delta} + \\delta\\right)  \\text{if } |\\lambda|  \\delta \\end{cases}\n$$\nwhere $\\delta = \\varepsilon \\tilde{a}$ is a small positive threshold, with $\\varepsilon = 0.1$. The dissipation term is thus modified to $\\sum_{i=1}^3 \\phi(|\\tilde{\\lambda}_i|) \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i$, ensuring a strictly positive amount of dissipation at sonic points.\n\nThe computational procedure to find $\\mathbf{F}_{\\text{Roe}}$ given left/right primitive states $(\\rho_L, u_L, p_L)$, $(\\rho_R, u_R, p_R)$ and $\\gamma$ is:\n1.  Calculate derived quantities ($E_L, H_L, E_R, H_R$) and form the state vectors $\\mathbf{Q}_L, \\mathbf{Q}_R$ and flux vectors $\\mathbf{F}_L, \\mathbf{F}_R$.\n2.  Compute the Roe-averaged variables $\\tilde{u}$, $\\tilde{H}$, and $\\tilde{a}$.\n3.  Calculate the jumps in conserved variables $\\Delta\\rho$, $\\Delta(\\rho u)$, $\\Delta(\\rho E)$.\n4.  Determine the wave strengths $\\tilde{\\alpha}_1, \\tilde{\\alpha}_2, \\tilde{\\alpha}_3$.\n5.  Find the eigenvalues $\\tilde{\\lambda}_1, \\tilde{\\lambda}_2, \\tilde{\\lambda}_3$ and the right eigenvectors $\\tilde{\\mathbf{k}}_1, \\tilde{\\mathbf{k}}_2, \\tilde{\\mathbf{k}}_3$.\n6.  Apply the entropy fix to each $|\\tilde{\\lambda}_i|$ to get $\\phi(|\\tilde{\\lambda}_i|)$.\n7.  Compute the total dissipation vector by summing the contributions from each wave: $\\sum_{i=1}^3 \\phi(|\\tilde{\\lambda}_i|) \\tilde{\\alpha}_i \\tilde{\\mathbf{k}}_i$.\n8.  Assemble the final Roe flux vector $\\mathbf{F}_{\\text{Roe}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Constructs and applies Roe's linearized Riemann solver for the 1D Euler equations.\n    \"\"\"\n\n    def compute_roe_flux(rho_L, u_L, p_L, rho_R, u_R, p_R, gamma, epsilon=0.1):\n        \"\"\"\n        Computes the Roe numerical flux for the 1D Euler equations.\n\n        Args:\n            rho_L, u_L, p_L: Primitive variables (density, velocity, pressure) for the left state.\n            rho_R, u_R, p_R: Primitive variables for the right state.\n            gamma: Ratio of specific heats.\n            epsilon: Parameter for the entropy fix.\n\n        Returns:\n            A numpy array representing the Roe flux vector [F_rho, F_rho_u, F_rho_E].\n        \"\"\"\n        # 1. Compute derived quantities and state/flux vectors\n        # Left state\n        e_L = p_L / ((gamma - 1.0) * rho_L)\n        E_L = e_L + 0.5 * u_L**2\n        H_L = E_L + p_L / rho_L\n        Q_L = np.array([rho_L, rho_L * u_L, rho_L * E_L])\n        F_L = np.array([rho_L * u_L, rho_L * u_L**2 + p_L, u_L * (rho_L * E_L + p_L)])\n\n        # Right state\n        e_R = p_R / ((gamma - 1.0) * rho_R)\n        E_R = e_R + 0.5 * u_R**2\n        H_R = E_R + p_R / rho_R\n        Q_R = np.array([rho_R, rho_R * u_R, rho_R * E_R])\n        F_R = np.array([rho_R * u_R, rho_R * u_R**2 + p_R, u_R * (rho_R * E_R + p_R)])\n\n        # 2. Compute Roe-averaged state\n        sqrt_rho_L = np.sqrt(rho_L)\n        sqrt_rho_R = np.sqrt(rho_R)\n        \n        u_tilde = (sqrt_rho_L * u_L + sqrt_rho_R * u_R) / (sqrt_rho_L + sqrt_rho_R)\n        H_tilde = (sqrt_rho_L * H_L + sqrt_rho_R * H_R) / (sqrt_rho_L + sqrt_rho_R)\n        \n        # Handle potential for negative value due to floating point arithmetic\n        a_sq_tilde_val = (gamma - 1.0) * (H_tilde - 0.5 * u_tilde**2)\n        if a_sq_tilde_val  0:\n            # This case indicates unphysical input states for the perfect gas model.\n            # A more robust implementation might average sound speed directly.\n            # For well-posed problems, this should not occur.\n            # We take the average of squared sound speeds as a fallback.\n            a_L_sq = gamma * p_L / rho_L\n            a_R_sq = gamma * p_R / rho_R\n            a_sq_tilde = 0.5 * (a_L_sq + a_R_sq)\n        else:\n            a_sq_tilde = a_sq_tilde_val\n\n        a_tilde = np.sqrt(a_sq_tilde)\n\n        # 3. Compute jumps in conserved variables\n        delta_Q = Q_R - Q_L\n        delta_rho = delta_Q[0]\n        delta_rho_u = delta_Q[1]\n        delta_rho_E = delta_Q[2]\n        \n        # 4. Compute wave strengths\n        # Note: A direct implementation of the formulas can be sensitive to\n        # floating point errors, especially if a_tilde is small.\n        # This implementation follows the direct derivation.\n        \n        # Strength of the entropy wave (lambda = u_tilde)\n        alpha_2 = (gamma - 1.0) / a_sq_tilde * \\\n                  ((H_tilde - u_tilde**2) * delta_rho + u_tilde * delta_rho_u - delta_rho_E)\n        \n        # Strength of acoustic waves (lambda = u_tilde +- a_tilde)\n        term_in_paren = (u_tilde * delta_rho - delta_rho_u) / a_tilde\n        alpha_1 = 0.5 * (delta_rho - alpha_2 + term_in_paren)\n        alpha_3 = 0.5 * (delta_rho - alpha_2 - term_in_paren)\n\n        # Alternative for alpha_3 to reduce dependency\n        # alpha_3 = delta_rho - alpha_1 - alpha_2\n\n        # 5. Compute eigenvalues and eigenvectors\n        lambdas = np.array([u_tilde - a_tilde, u_tilde, u_tilde + a_tilde])\n        alphas = np.array([alpha_1, alpha_2, alpha_3])\n        \n        k1 = np.array([1.0, u_tilde - a_tilde, H_tilde - u_tilde * a_tilde])\n        k2 = np.array([1.0, u_tilde, 0.5 * u_tilde**2])\n        k3 = np.array([1.0, u_tilde + a_tilde, H_tilde + u_tilde * a_tilde])\n        \n        eigenvectors = [k1, k2, k3]\n\n        # 6. Apply entropy fix\n        delta = epsilon * a_tilde\n        phi_lambdas = np.zeros_like(lambdas)\n        for i, lam in enumerate(lambdas):\n            abs_lam = np.abs(lam)\n            if abs_lam  delta:\n                phi_lambdas[i] = 0.5 * (lam**2 / delta + delta)\n            else:\n                phi_lambdas[i] = abs_lam\n\n        # 7. Compute numerical dissipation term\n        dissipation = np.zeros(3)\n        for i in range(3):\n            dissipation += phi_lambdas[i] * alphas[i] * eigenvectors[i]\n\n        # 8. Assemble the final Roe flux\n        F_roe = 0.5 * (F_L + F_R) - 0.5 * dissipation\n        return F_roe\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Supersonic right-going\n        (1.0, 800.0, 100000.0, 0.8, 700.0, 100000.0, 1.4),\n        # Case 2: Transonic mixed\n        (1.0, 300.0, 100000.0, 1.0, 0.0, 100000.0, 1.4),\n        # Case 3: Strong pressure jump (Sod-like)\n        (5.0, 0.0, 500000.0, 1.0, 0.0, 100000.0, 1.4),\n        # Case 4: Contact discontinuity\n        (2.0, 100.0, 100000.0, 1.0, 100.0, 100000.0, 1.4),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_L, u_L, p_L, rho_R, u_R, p_R, gamma = case\n        flux_vector = compute_roe_flux(rho_L, u_L, p_L, rho_R, u_R, p_R, gamma)\n        results.append([flux_vector[0], flux_vector[1], flux_vector[2]])\n\n    # Final print statement in the exact required format.\n    # Format: [[f11,f12,f13],[f21,f22,f23],...]\n    sublist_strings = [f\"[{v[0]},{v[1]},{v[2]}]\" for v in results]\n    final_output = f\"[{','.join(sublist_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}