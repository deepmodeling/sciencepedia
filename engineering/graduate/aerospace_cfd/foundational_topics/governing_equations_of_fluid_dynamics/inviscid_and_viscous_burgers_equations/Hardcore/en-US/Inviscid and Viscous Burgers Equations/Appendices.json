{
    "hands_on_practices": [
        {
            "introduction": "The inviscid Burgers' equation, despite its simplicity, captures the essential mechanism of nonlinear wave steepening that leads to shock formation in fluid dynamics. This exercise provides foundational practice with the method of characteristics, a powerful tool for analyzing hyperbolic partial differential equations. By tracing the paths of fluid particles in the $(x,t)$ plane, you will determine the precise moment and location where a smooth initial wave profile first develops a \"gradient catastrophe,\" giving birth to a shock wave. ",
            "id": "3968933",
            "problem": "In one space dimension, consider the inviscid Burgers’ equation, widely used as a model nonlinear conservation law in Computational Fluid Dynamics (CFD): \n$$\n\\frac{\\partial u}{\\partial t} + u\\,\\frac{\\partial u}{\\partial x} = 0,\n$$\nposed on a spatially periodic domain of fundamental period $2\\pi/k$, with smooth initial condition \n$$\nu(x,0)=u_0(x)=A\\,\\sin(k x),\n$$\nwhere $A0$ and $k0$ are constants, and variables are nondimensional. Starting from the conservation-law framework and the method of characteristics, determine the earliest time of gradient catastrophe (shock formation) $t_s$ and the spatial location $x_s$ within one fundamental period where the first shock forms. Express your final answer as a row matrix $\\big[t_s,\\;x_s\\big]$ in terms of $A$ and $k$. Do not assume any pre-derived shock-time formula; justify each step from first principles of characteristics and invertibility of the Lagrangian-to-Eulerian mapping. No units are required, and no rounding is needed.",
            "solution": "The problem is to determine the shock formation time and location for the inviscid Burgers' equation with a sinusoidal initial condition. The validation process confirms that the problem statement is scientifically grounded, well-posed, and contains all necessary information for a unique solution.\n\nThe governing partial differential equation (PDE) is the inviscid Burgers' equation:\n$$\n\\frac{\\partial u}{\\partial t} + u\\,\\frac{\\partial u}{\\partial x} = 0\n$$\nThis equation is the non-conservative form of the conservation law $\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0$, where the flux function is $f(u) = \\frac{1}{2}u^2$. The given form is suitable for analysis using the method of characteristics.\n\nThe method of characteristics seeks curves in the $(x,t)$-plane along which the PDE reduces to an ordinary differential equation (ODE). The total derivative of $u(x(t), t)$ along such a curve is:\n$$\n\\frac{d u}{d t} = \\frac{\\partial u}{\\partial t} + \\frac{d x}{d t} \\frac{\\partial u}{\\partial x}\n$$\nComparing this with the Burgers' equation, we can see that if we define the characteristic curves by the ODE:\n$$\n\\frac{d x}{d t} = u\n$$\nthen along these curves, the value of $u$ is constant:\n$$\n\\frac{d u}{d t} = 0\n$$\nThese two ODEs form the system of characteristic equations. Let us introduce a Lagrangian coordinate $\\xi$, which labels a fluid particle by its initial position at time $t=0$. So, $x(0) = \\xi$.\n\nThe second characteristic equation, $\\frac{d u}{d t} = 0$, implies that $u$ is conserved along a characteristic. This means the value of $u$ for a fluid particle labeled by $\\xi$ is equal to its initial value for all time:\n$$\nu(x(t), t) = u(x(0), 0) = u_0(\\xi)\n$$\nSubstituting this into the first characteristic equation gives:\n$$\n\\frac{d x}{d t} = u_0(\\xi)\n$$\nSince $u_0(\\xi)$ is constant for a fixed particle (a fixed $\\xi$), we can integrate this equation with respect to time $t$, using the initial condition $x(0) = \\xi$:\n$$\n\\int_{\\xi}^{x} dx' = \\int_{0}^{t} u_0(\\xi) dt'\n$$\n$$\nx(t, \\xi) - \\xi = u_0(\\xi) t\n$$\nThis gives the equation for the characteristic lines in the $(x,t)$-plane:\n$$\nx = \\xi + u_0(\\xi) t\n$$\nThe solution $u(x,t)$ is implicitly defined by this equation and $u = u_0(\\xi)$. For the given initial condition, $u_0(x) = A\\,\\sin(k x)$, where $A0$ and $k0$, the solution is given by the parametric form:\n$$\nu(x,t) = A\\,\\sin(k \\xi)\n$$\n$$\nx = \\xi + (A\\,\\sin(k \\xi)) t\n$$\nThese characteristic lines are straight lines, but their slope in the $(x,t)$-plane, which is $1/u_0(\\xi)$, varies depending on the initial position $\\xi$.\n\nA shock, or a gradient catastrophe, occurs when these characteristic lines first intersect. At the point of intersection, the solution $u(x,t)$ would become multi-valued, which is physically impossible. Mathematically, this corresponds to the moment when the transformation from the Lagrangian coordinate $\\xi$ to the Eulerian coordinate $x$ ceases to be invertible for a fixed time $t$. The invertibility breaks down when the Jacobian of the transformation, $\\frac{\\partial x}{\\partial \\xi}$, becomes zero.\nLet us compute this derivative from the characteristic equation $x = \\xi + u_0(\\xi) t$:\n$$\n\\frac{\\partial x}{\\partial \\xi} = 1 + u_0'(\\xi) t\n$$\nwhere $u_0'(\\xi) = \\frac{d u_0}{d \\xi}$. A shock forms when $\\frac{\\partial x}{\\partial \\xi} = 0$, which implies:\n$$\n1 + u_0'(\\xi) t = 0\n$$\nFrom this, we can express the time $t$ at which a shock may form due to the particle initially at $\\xi$:\n$$\nt = -\\frac{1}{u_0'(\\xi)}\n$$\nSince time must be positive ($t0$), shocks can only form from particles at locations $\\xi$ where $u_0'(\\xi)  0$. The earliest time of shock formation, $t_s$, is the minimum of all such possible positive times:\n$$\nt_s = \\min_{\\xi \\mid u_0'(\\xi)0} \\left( -\\frac{1}{u_0'(\\xi)} \\right)\n$$\nThis is equivalent to finding the most negative value of $u_0'(\\xi)$:\n$$\nt_s = -\\frac{1}{\\min_{\\xi} (u_0'(\\xi))}\n$$\nLet's compute $u_0'(\\xi)$ for the given initial condition $u_0(\\xi) = A\\,\\sin(k \\xi)$:\n$$\nu_0'(\\xi) = \\frac{d}{d\\xi}(A\\,\\sin(k \\xi)) = Ak\\,\\cos(k \\xi)\n$$\nThe minimum value of $\\cos(k \\xi)$ is $-1$. Therefore, the minimum value of $u_0'(\\xi)$ is:\n$$\n\\min_{\\xi} (u_0'(\\xi)) = -Ak\n$$\nSubstituting this into the expression for $t_s$, we find the shock formation time:\n$$\nt_s = -\\frac{1}{-Ak} = \\frac{1}{Ak}\n$$\nNow we must find the spatial location $x_s$ where this first shock forms. The shock first appears at the Lagrangian coordinate(s) $\\xi_s$ where the derivative $u_0'(\\xi)$ is at its minimum. This occurs when:\n$$\nAk\\,\\cos(k \\xi_s) = -Ak \\implies \\cos(k \\xi_s) = -1\n$$\nThis condition is satisfied when $k \\xi_s = (2n+1)\\pi$ for any integer $n$. So, the set of initial particle positions that contribute to the first shock is:\n$$\n\\xi_s = \\frac{(2n+1)\\pi}{k}, \\quad n \\in \\mathbb{Z}\n$$\nThe spatial location $x_s$ is found by substituting $t_s$ and $\\xi_s$ into the characteristic line equation:\n$$\nx_s = \\xi_s + u_0(\\xi_s) t_s\n$$\nFirst, we evaluate $u_0(\\xi_s)$:\n$$\nu_0(\\xi_s) = A\\,\\sin(k \\xi_s) = A\\,\\sin\\left(k \\frac{(2n+1)\\pi}{k}\\right) = A\\,\\sin((2n+1)\\pi) = 0\n$$\nThis indicates that the particles contributing to the first shock are those initially at the zero-crossings of the sine wave where the slope is negative. Since $u_0(\\xi_s)=0$, the characteristic velocity for these particles is zero.\nSubstituting this result into the equation for $x_s$:\n$$\nx_s = \\xi_s + (0) \\cdot t_s = \\xi_s\n$$\nThus, the spatial locations of the first shock are:\n$$\nx_s = \\frac{(2n+1)\\pi}{k}\n$$\nThe problem asks for the location $x_s$ within one fundamental period of length $2\\pi/k$. We can choose the period to be the interval $[0, 2\\pi/k)$. For $n=0$, we get:\n$$\nx_s = \\frac{\\pi}{k}\n$$\nThis location lies within the specified interval $[0, 2\\pi/k)$. For other integer values of $n$, the locations are equivalent modulo $2\\pi/k$. For instance, for $n=1$, $x_s = 3\\pi/k$, which is equivalent to $\\pi/k$ in a periodic domain of period $2\\pi/k$. Thus, the unique location within one fundamental period is $\\pi/k$.\n\nThe earliest time of gradient catastrophe is $t_s = \\frac{1}{Ak}$ and the corresponding location is $x_s = \\frac{\\pi}{k}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{Ak}  \\frac{\\pi}{k} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While inviscid theory predicts infinitesimally thin shocks, real-world dissipative effects like viscosity regularize these discontinuities into smooth, structured layers. This exercise explores this regularization by seeking a traveling-wave solution to the viscous Burgers' equation. Transforming the partial differential equation into an ordinary differential equation in a moving frame allows for the derivation of the explicit analytical profile of a viscous shock, providing a bridge between the idealized discontinuity and its physical structure. ",
            "id": "3968930",
            "problem": "In computational fluid dynamics (CFD) for aerospace applications, the viscous Burgers’ equation is used as a canonical model for shock regularization by viscosity. Consider the viscous Burgers’ equation in conservation form\n$$\nu_{t}+\\partial_{x}\\!\\left(\\tfrac{1}{2}\\,u^{2}\\right)=\\nu\\,u_{xx},\n$$\nwhere $u=u(x,t)$ is a scalar velocity-like field, $x$ is the spatial coordinate, $t$ is time, and $\\nu0$ is a constant kinematic viscosity. A viscous traveling wave connects constant far-field states $u_{L}$ and $u_{R}$ with $u_{L}u_{R}$, propagating at an a priori unknown constant speed $s$. Assume a traveling-wave ansatz $u(x,t)=U(\\xi)$ with $\\xi=x-s\\,t$, and impose the far-field conditions\n$$\n\\lim_{\\xi\\to-\\infty}U(\\xi)=u_{L},\\qquad \\lim_{\\xi\\to+\\infty}U(\\xi)=u_{R},\n$$\ntogether with the physical requirements that $U$ is bounded and monotone. Starting only from the stated conservation law, the traveling-wave ansatz, and the far-field conditions, derive a first integral of the resulting ordinary differential equation and determine the propagation speed $s$ from consistency at both far fields. Then integrate the first-order separable ordinary differential equation to obtain the explicit closed-form traveling-wave profile. Fix the translational invariance by imposing the centering condition $U(0)=\\tfrac{1}{2}(u_{L}+u_{R})$.\n\nWhat is the explicit expression for $U(\\xi)$ in terms of $u_{L}$, $u_{R}$, $\\nu$, and $\\xi$? Your final answer must be a single closed-form analytic expression. Do not include units in your final answer.",
            "solution": "The user wants to find the explicit expression for a viscous traveling wave solution of the Burgers' equation.\n\n### Step 1: Problem Validation\n\nThe problem statement provides the following givens:\n- The viscous Burgers' equation in conservation form: $u_{t}+\\partial_{x}\\!\\left(\\tfrac{1}{2}\\,u^{2}\\right)=\\nu\\,u_{xx}$.\n- The traveling-wave ansatz: $u(x,t)=U(\\xi)$ with the coordinate transformation $\\xi=x-s\\,t$.\n- The far-field boundary conditions: $\\lim_{\\xi\\to-\\infty}U(\\xi)=u_{L}$ and $\\lim_{\\xi\\to+\\infty}U(\\xi)=u_{R}$.\n- A constraint on the far-field states: $u_{L}u_{R}$.\n- Physical requirements: The solution $U$ must be bounded and monotone.\n- A centering condition to fix translational invariance: $U(0)=\\tfrac{1}{2}(u_{L}+u_{R})$.\n\nThe problem is scientifically grounded, as the Burgers' equation is a fundamental model in fluid dynamics for studying the interplay between nonlinear advection and viscous diffusion. The task of finding a traveling wave solution is a standard and well-posed problem in the theory of nonlinear partial differential equations. The provided information is complete, consistent, and sufficient to determine a unique solution. Therefore, the problem is **valid**.\n\n### Step 2: Derivation of the Solution\n\nWe begin by substituting the traveling-wave ansatz $u(x,t)=U(\\xi)$, where $\\xi=x-s\\,t$, into the viscous Burgers' equation. The partial derivatives of $u$ with respect to $t$ and $x$ can be expressed in terms of ordinary derivatives of $U$ with respect to $\\xi$ using the chain rule:\n$u_{t} = \\frac{dU}{d\\xi}\\frac{\\partial\\xi}{\\partial t} = -s U'(\\xi)$\n$u_{x} = \\frac{dU}{d\\xi}\\frac{\\partial\\xi}{\\partial x} = U'(\\xi)$\nSo, the advective term becomes:\n$\\partial_{x}\\!\\left(\\tfrac{1}{2}\\,u^{2}\\right) = \\partial_{x}\\!\\left(\\tfrac{1}{2}\\,U(\\xi)^{2}\\right) = U(\\xi)U'(\\xi)$\nAnd the viscous term becomes:\n$\\nu\\,u_{xx} = \\nu\\,\\partial_{x}(U'(\\xi)) = \\nu\\,U''(\\xi)$\n\nSubstituting these expressions into the Burgers' equation yields the ordinary differential equation (ODE) for the wave profile $U(\\xi)$:\n$$\n-s U' + U U' = \\nu U''\n$$\nThis equation can be rewritten as:\n$$\n\\nu U'' = (U-s) U'\n$$\nThis is a second-order ODE, but it can be directly integrated once with respect to $\\xi$. Integrating both sides gives:\n$$\n\\int \\nu U'' \\,d\\xi = \\int (U-s) U' \\,d\\xi\n$$\nRecognizing that $U' \\, d\\xi = dU$, we can evaluate the integral on the right-hand side with respect to $U$:\n$$\n\\nu U' = \\int (U-s) \\,dU = \\frac{1}{2}U^2 - sU + C_1\n$$\nwhere $C_1$ is the first integration constant. This is the first integral of the ODE.\n\nNow, we must determine the constants $s$ and $C_1$ using the far-field conditions. As $\\xi \\to \\pm\\infty$, the profile $U(\\xi)$ approaches the constant states $u_L$ and $u_R$. The requirement that the solution is monotone and bounded implies that the profile becomes flat in the far field, meaning its derivative must vanish: $\\lim_{\\xi\\to\\pm\\infty} U'(\\xi) = 0$.\n\nApplying these conditions to the first integral:\n$1$. At $\\xi \\to -\\infty$, we have $U \\to u_L$ and $U' \\to 0$.\n$$\n\\nu(0) = \\frac{1}{2}u_L^2 - s u_L + C_1 \\quad \\implies \\quad C_1 = s u_L - \\frac{1}{2}u_L^2\n$$\n$2$. At $\\xi \\to +\\infty$, we have $U \\to u_R$ and $U' \\to 0$.\n$$\n\\nu(0) = \\frac{1}{2}u_R^2 - s u_R + C_1 \\quad \\implies \\quad C_1 = s u_R - \\frac{1}{2}u_R^2\n$$\nFor consistency, both expressions for $C_1$ must be equal. Equating them allows us to solve for the wave speed $s$:\n$$\ns u_L - \\frac{1}{2}u_L^2 = s u_R - \\frac{1}{2}u_R^2\n$$\n$$\ns(u_L - u_R) = \\frac{1}{2}(u_L^2 - u_R^2) = \\frac{1}{2}(u_L - u_R)(u_L + u_R)\n$$\nSince the problem states $u_L  u_R$, the term $(u_L - u_R)$ is non-zero and can be divided out, yielding the shock propagation speed:\n$$\ns = \\frac{1}{2}(u_L + u_R)\n$$\nThis is the celebrated Rankine-Hugoniot speed for a shock in the Burgers' equation. Now we can find $C_1$ by substituting $s$ back into either expression for $C_1$:\n$$\nC_1 = \\left(\\frac{u_L + u_R}{2}\\right)u_L - \\frac{1}{2}u_L^2 = \\frac{1}{2}u_L^2 + \\frac{1}{2}u_L u_R - \\frac{1}{2}u_L^2 = \\frac{1}{2}u_L u_R\n$$\nWith $s$ and $C_1$ determined, the first-order ODE for $U(\\xi)$ is:\n$$\n\\nu U' = \\frac{1}{2}U^2 - \\frac{1}{2}(u_L + u_R)U + \\frac{1}{2}u_L u_R\n$$\nThe quadratic on the right-hand side has roots $u_L$ and $u_R$, so it can be factored:\n$$\n\\nu U' = \\frac{1}{2}(U - u_L)(U - u_R)\n$$\nThis is a separable first-order ODE. We separate variables to integrate:\n$$\n\\frac{dU}{(U - u_L)(U - u_R)} = \\frac{1}{2\\nu} d\\xi\n$$\nWe use partial fraction decomposition for the left-hand side:\n$$\n\\frac{1}{(U - u_L)(U - u_R)} = \\frac{1}{u_L - u_R}\\left(\\frac{1}{U - u_L} - \\frac{1}{U - u_R}\\right)\n$$\nSubstituting this back and integrating both sides:\n$$\n\\frac{1}{u_L - u_R} \\int \\left(\\frac{1}{U - u_L} - \\frac{1}{U - u_R}\\right) dU = \\int \\frac{1}{2\\nu} d\\xi\n$$\n$$\n\\frac{1}{u_L - u_R} \\left( \\ln|U - u_L| - \\ln|U - u_R| \\right) = \\frac{\\xi}{2\\nu} + C_2\n$$\n$$\n\\ln\\left|\\frac{U - u_L}{U - u_R}\\right| = \\frac{u_L - u_R}{2\\nu}\\xi + C_3\n$$\nwhere $C_3 = (u_L - u_R)C_2$ is a new integration constant. The solution profile is monotone from $u_L$ to $u_R$, with $u_L  u_R$. Thus, for any finite $\\xi$, we have $u_R  U(\\xi)  u_L$. This implies $U - u_L  0$ and $U - u_R  0$. Therefore, the argument of the absolute value is negative, and we have:\n$$\n\\left|\\frac{U - u_L}{U - u_R}\\right| = -\\frac{U - u_L}{U - u_R} = \\frac{u_L - U}{U - u_R}\n$$\nThe equation becomes:\n$$\n\\ln\\left(\\frac{u_L - U}{U - u_R}\\right) = \\frac{u_L - u_R}{2\\nu}\\xi + C_3\n$$\nTo determine $C_3$, we apply the centering condition $U(0) = \\frac{1}{2}(u_L + u_R)$. Substituting $\\xi=0$:\n$$\n\\frac{u_L - U(0)}{U(0) - u_R} = \\frac{u_L - \\frac{1}{2}(u_L + u_R)}{\\frac{1}{2}(u_L + u_R) - u_R} = \\frac{\\frac{1}{2}(u_L - u_R)}{\\frac{1}{2}(u_L - u_R)} = 1\n$$\nPlugging this into the logarithmic equation at $\\xi=0$:\n$$\n\\ln(1) = 0 + C_3 \\quad \\implies \\quad C_3 = 0\n$$\nThe implicit solution is thus:\n$$\n\\ln\\left(\\frac{u_L - U}{U - u_R}\\right) = \\frac{u_L - u_R}{2\\nu}\\xi\n$$\nTo find the explicit form, we exponentiate both sides:\n$$\n\\frac{u_L - U}{U - u_R} = \\exp\\left(\\frac{u_L - u_R}{2\\nu}\\xi\\right)\n$$\nNow, we solve for $U(\\xi)$:\n$$\nu_L - U = (U - u_R) \\exp\\left(\\frac{u_L - u_R}{2\\nu}\\xi\\right)\n$$\n$$\nu_L + u_R \\exp\\left(\\frac{u_L - u_R}{2\\nu}\\xi\\right) = U \\left(1 + \\exp\\left(\\frac{u_L - u_R}{2\\nu}\\xi\\right)\\right)\n$$\n$$\nU(\\xi) = \\frac{u_L + u_R \\exp\\left(\\frac{u_L - u_R}{2\\nu}\\xi\\right)}{1 + \\exp\\left(\\frac{u_L - u_R}{2\\nu}\\xi\\right)}\n$$\nThis expression can be written more compactly using the hyperbolic tangent function. Let $\\bar{u} = \\frac{u_L+u_R}{2}$ and $\\Delta u = \\frac{u_L-u_R}{2}$, so that $u_L = \\bar{u}+\\Delta u$ and $u_R = \\bar{u}-\\Delta u$. The argument of the exponential is $\\frac{2\\Delta u}{2\\nu}\\xi = \\frac{\\Delta u}{\\nu}\\xi$.\n$$\nU(\\xi) = \\frac{(\\bar{u}+\\Delta u) + (\\bar{u}-\\Delta u)\\exp\\left(\\frac{\\Delta u}{\\nu}\\xi\\right)}{1 + \\exp\\left(\\frac{\\Delta u}{\\nu}\\xi\\right)} = \\frac{\\bar{u}\\left(1+\\exp\\left(\\frac{\\Delta u}{\\nu}\\xi\\right)\\right) + \\Delta u\\left(1-\\exp\\left(\\frac{\\Delta u}{\\nu}\\xi\\right)\\right)}{1 + \\exp\\left(\\frac{\\Delta u}{\\nu}\\xi\\right)}\n$$\n$$\nU(\\xi) = \\bar{u} + \\Delta u \\frac{1-\\exp\\left(\\frac{\\Delta u}{\\nu}\\xi\\right)}{1+\\exp\\left(\\frac{\\Delta u}{\\nu}\\xi\\right)}\n$$\nUsing the identity $\\tanh(z) = \\frac{\\exp(2z)-1}{\\exp(2z)+1}$, which implies $-\\tanh(z) = \\frac{1-\\exp(2z)}{1+\\exp(2z)}$, and setting $2z = \\frac{\\Delta u}{\\nu}\\xi$, we get $z=\\frac{\\Delta u}{2\\nu}\\xi$.\n$$\nU(\\xi) = \\bar{u} - \\Delta u \\tanh\\left(\\frac{\\Delta u}{2\\nu}\\xi\\right)\n$$\nSubstituting back the expressions for $\\bar{u}$ and $\\Delta u$:\n$$\nU(\\xi) = \\frac{u_L+u_R}{2} - \\frac{u_L-u_R}{2} \\tanh\\left(\\frac{(u_L-u_R)\\xi}{4\\nu}\\right)\n$$\nThis is the final closed-form analytic expression for the viscous shock profile.",
            "answer": "$$\\boxed{\\frac{u_{L}+u_{R}}{2} - \\frac{u_{L}-u_{R}}{2} \\tanh\\left(\\frac{(u_{L}-u_{R})\\xi}{4\\nu}\\right)}$$"
        },
        {
            "introduction": "Moving from analytical theory to practical simulation is a crucial step in computational fluid dynamics. This exercise guides you through the implementation of the Godunov scheme, a cornerstone of modern shock-capturing methods, for the Burgers' equation. You will first derive the exact numerical flux by solving the Riemann problem at cell interfaces, and then use this physically-grounded flux to build a finite volume code that can simulate the evolution of both inviscid shocks and viscous waves. ",
            "id": "3968903",
            "problem": "Consider the scalar conservation law form of the inviscid Burgers equation, which is a canonical model in Computational Fluid Dynamics (CFD): $$\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0,$$ where the physical flux function is $$f(u) = \\frac{1}{2}u^2.$$ In the viscous Burgers equation, the right-hand side includes a diffusion term: $$\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\frac{1}{2}u^2\\right) = \\nu \\frac{\\partial^2 u}{\\partial x^2},$$ where $$\\nu \\ge 0$$ is the kinematic viscosity. The Godunov finite volume scheme for the hyperbolic (inviscid) part updates the cell averages via interface numerical fluxes computed from exact Riemann problems posed between left and right states at each interface. For Burgers, the characteristic speed is $$a(u) = f'(u) = u,$$ and the exact Riemann solution has either a rarefaction or a shock. Starting from these fundamentals and the Rankine–Hugoniot condition for shocks, derive the exact Godunov numerical flux $$\\hat{f}(u_L,u_R)$$ as a function of the left and right states $$u_L$$ and $$u_R$$ at an interface. Then implement a one-step explicit finite volume update on a uniform periodic mesh that combines the convective Godunov numerical flux with a centered diffusive flux for the viscous term: $$F_d\\big|_{i+\\frac{1}{2}} = -\\nu \\frac{u_{i+1} - u_i}{\\Delta x},$$ so that the semi-discrete update is $$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(\\hat{f}\\big(u_i^n,u_{i+1}^n\\big) - \\hat{f}\\big(u_{i-1}^n,u_i^n\\big)\\right) - \\frac{\\Delta t}{\\Delta x}\\left(F_d\\big|_{i+\\frac{1}{2}} - F_d\\big|_{i-\\frac{1}{2}}\\right),$$ with periodic boundary conditions. Use a single forward Euler time step. No physical units are required because the problem is dimensionless.\n\nYour program must implement the exact Godunov numerical flux function $$\\hat{f}(u_L,u_R)$$ based on the Riemann solution structure for Burgers. Then, use it to: \n- Compute the numerical flux for the following ordered test pairs $$\\left(u_L,u_R\\right)$$:\n  1. $$\\left(-1.0,\\,2.0\\right)$$\n  2. $$\\left(2.0,\\,1.0\\right)$$\n  3. $$\\left(-2.0,\\,-3.0\\right)$$\n  4. $$\\left(0.0,\\,0.0\\right)$$\n  5. $$\\left(0.5,\\,1.5\\right)$$\n  6. $$\\left(-1.5,\\,-0.5\\right)$$\n- Perform one explicit finite volume update on a periodic mesh for both the inviscid and viscous cases using the same initial data:\n  - Number of cells: $$N = 5$$,\n  - Mesh spacing: $$\\Delta x = 0.1$$,\n  - Time step: $$\\Delta t = 0.02$$,\n  - Initial cell averages (in order of cell index): $$\\left[2.0,\\,-1.0,\\,0.5,\\,-0.5,\\,1.0\\right]$$,\n  - Inviscid case: $$\\nu = 0.0$$,\n  - Viscous case: $$\\nu = 0.05$$.\n\nDesign your implementation to be robust under periodic boundary conditions, and base the logic strictly on the conservation law, characteristics, and the Rankine–Hugoniot condition.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The entries must be, in order: the $$6$$ numerical flux values for the six pairs listed above (as $$6$$ floats), then the list of $$5$$ updated cell averages for the inviscid case, followed by the list of $$5$$ updated cell averages for the viscous case. For example, the output format should look like $$\\left[f_1,\\,f_2,\\,f_3,\\,f_4,\\,f_5,\\,f_6,\\,[u_0^{\\text{inv}},\\,u_1^{\\text{inv}},\\,u_2^{\\text{inv}},\\,u_3^{\\text{inv}},\\,u_4^{\\text{inv}}],\\,[u_0^{\\text{vis}},\\,u_1^{\\text{vis}},\\,u_2^{\\text{vis}},\\,u_3^{\\text{vis}},\\,u_4^{\\text{vis}}]\\right].$$ No spaces are required; a compact representation is acceptable.",
            "solution": "The problem is well-posed and scientifically sound, providing a complete set of parameters and clear objectives. We will proceed with the solution, which involves two main parts: first, the derivation and calculation of the exact Godunov numerical flux for the Burgers' equation, and second, the application of this flux within a one-step finite volume scheme for both an inviscid and a viscous case.\n\n### Part 1: Derivation of the Godunov Numerical Flux\n\nThe Godunov numerical flux, $\\hat{f}(u_L, u_R)$, at an interface between a left state $u_L$ and a right state $u_R$ is defined by the solution to the Riemann problem for the conservation law. The flux is given by $f(u(0,t))$, where $u(x,t)$ is the self-similar solution to the Riemann problem and $f(u) = \\frac{1}{2}u^2$ is the physical flux for the Burgers' equation. The state $u(0,t)$ is the value of the solution along the $x/t = 0$ axis in the solution's fan. The characteristic speed is $a(u) = f'(u) = u$.\n\nThe structure of the Riemann solution depends on the relative values of $u_L$ and $u_R$.\n\n**Case 1: Rarefaction Wave ($u_L  u_R$)**\nWhen $u_L  u_R$, the characteristics diverge, creating a continuous rarefaction fan. The solution is $u(x,t) = x/t$ for characteristic speeds between $u_L$ and $u_R$. The state at the interface, $u(0,t)$, depends on whether the $x/t=0$ ray falls within the range of characteristic speeds $[u_L, u_R]$.\n- If $0  u_L  u_R$, all characteristics move to the right. The state at $x=0$ is determined by the unperturbed left state, so $u(0,t) = u_L$. The numerical flux is $\\hat{f} = f(u_L)$.\n- If $u_L  u_R  0$, all characteristics move to the left. The state at $x=0$ is determined by the unperturbed right state, so $u(0,t) = u_R$. The numerical flux is $\\hat{f} = f(u_R)$.\n- If $u_L \\le 0 \\le u_R$, the characteristic with speed $0$ is part of the rarefaction fan. The state at the interface is $u(0,t)=0$. The numerical flux is $\\hat{f} = f(0) = 0$.\n\n**Case 2: Shock Wave ($u_L  u_R$)**\nWhen $u_L  u_R$, the characteristics collide, forming a discontinuous shock wave. The speed of this shock, $s$, is given by the Rankine-Hugoniot condition:\n$$ s = \\frac{f(u_L) - f(u_R)}{u_L - u_R} = \\frac{\\frac{1}{2}u_L^2 - \\frac{1}{2}u_R^2}{u_L - u_R} = \\frac{1}{2}(u_L + u_R) $$\nThe solution at the interface depends on the direction of shock propagation:\n- If $s  0$, the shock moves to the right, and the state at $x=0$ is $u_L$. The numerical flux is $\\hat{f} = f(u_L)$.\n- If $s  0$, the shock moves to the left, and the state at $x=0$ is $u_R$. The numerical flux is $\\hat{f} = f(u_R)$.\n- If $s = 0$, the shock is stationary. This implies $u_L = -u_R$, for which $f(u_L) = f(u_R)$. Thus, the flux is unambiguous. We adopt the convention that for $s \\ge 0$, the flux is $f(u_L)$.\n\n**Summary of the Godunov Flux Function $\\hat{f}(u_L, u_R)$:**\nLet $f(u) = \\frac{1}{2}u^2$.\n- If $u_L  u_R$: Let $s = \\frac{1}{2}(u_L + u_R)$. The flux is $f(u_L)$ if $s \\ge 0$, and $f(u_R)$ if $s  0$.\n- If $u_L \\le u_R$: The flux is $f(u_L)$ if $u_L \\ge 0$, $f(u_R)$ if $u_R \\le 0$, and $0$ if $u_L  0  u_R$.\n\n### Part 2: Calculation of Numerical Fluxes for Test Pairs\n\nUsing the derived logic for $\\hat{f}(u_L, u_R)$ and $f(u) = \\frac{1}{2}u^2$:\n1.  $(u_L, u_R) = (-1.0, 2.0)$: Rarefaction with $u_L  0  u_R$. $\\hat{f} = f(0) = 0.0$.\n2.  $(u_L, u_R) = (2.0, 1.0)$: Shock with $s = \\frac{1}{2}(2.0+1.0) = 1.5  0$. $\\hat{f} = f(u_L) = f(2.0) = \\frac{1}{2}(2.0)^2 = 2.0$.\n3.  $(u_L, u_R) = (-2.0, -3.0)$: Shock with $s=\\frac{1}{2}(-2.0-3.0) = -2.5  0$. $\\hat{f} = f(u_R) = f(-3.0) = \\frac{1}{2}(-3.0)^2 = 4.5$.\n4.  $(u_L, u_R) = (0.0, 0.0)$: Constant state. Condition $u_L \\le u_R$ applies, and $u_L \\ge 0$. $\\hat{f} = f(u_L) = f(0.0) = 0.0$.\n5.  $(u_L, u_R) = (0.5, 1.5)$: Rarefaction with $u_L  0$. $\\hat{f} = f(u_L) = f(0.5) = \\frac{1}{2}(0.5)^2 = 0.125$.\n6.  $(u_L, u_R) = (-1.5, -0.5)$: Rarefaction with $u_R  0$. $\\hat{f} = f(u_R) = f(-0.5) = \\frac{1}{2}(-0.5)^2 = 0.125$.\n\nThe calculated flux values are $[0.0, 2.0, 4.5, 0.0, 0.125, 0.125]$.\n\n### Part 3: One-Step Finite Volume Update\n\nThe finite volume update for cell $i$ is given by:\n$$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(\\hat{f}_{i+1/2} - \\hat{f}_{i-1/2}\\right) + \\frac{\\nu \\Delta t}{(\\Delta x)^2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n) $$\nwhere $\\hat{f}_{i+1/2} = \\hat{f}(u_i^n, u_{i+1}^n)$.\n**Parameters**: $N=5$, $\\Delta x=0.1$, $\\Delta t=0.02$. Initial data $u^n = [2.0, -1.0, 0.5, -0.5, 1.0]$.\nThe coefficients are $\\frac{\\Delta t}{\\Delta x} = \\frac{0.02}{0.1} = 0.2$ and $\\frac{\\nu \\Delta t}{(\\Delta x)^2} = \\frac{\\nu \\cdot 0.02}{(0.1)^2} = 2\\nu$.\nThe periodic boundary conditions mean $u_{-1}^n = u_4^n$ and $u_5^n = u_0^n$.\n\nFirst, we compute the interface fluxes $\\hat{f}_{i+1/2}$ for $i=0, \\dots, 4$:\n- $\\hat{f}_{0+1/2} = \\hat{f}(u_0, u_1) = \\hat{f}(2.0, -1.0)$: Shock, $s=0.50 \\Rightarrow \\hat{f}=f(2.0)=2.0$.\n- $\\hat{f}_{1+1/2} = \\hat{f}(u_1, u_2) = \\hat{f}(-1.0, 0.5)$: Rarefaction, $u_L0u_R \\Rightarrow \\hat{f}=f(0)=0.0$.\n- $\\hat{f}_{2+1/2} = \\hat{f}(u_2, u_3) = \\hat{f}(0.5, -0.5)$: Shock, $s=0 \\Rightarrow \\hat{f}=f(0.5)=0.125$.\n- $\\hat{f}_{3+1/2} = \\hat{f}(u_3, u_4) = \\hat{f}(-0.5, 1.0)$: Rarefaction, $u_L0u_R \\Rightarrow \\hat{f}=f(0)=0.0$.\n- $\\hat{f}_{4+1/2} = \\hat{f}(u_4, u_0) = \\hat{f}(1.0, 2.0)$: Rarefaction, $u_L0 \\Rightarrow \\hat{f}=f(1.0)=0.5$.\nThe flux at the left boundary of cell $0$ is $\\hat{f}_{-1/2} = \\hat{f}_{4+1/2} = 0.5$.\n\n**Inviscid Case ($\\nu=0.0$):**\nThe update is $u_i^{n+1} = u_i^n - 0.2(\\hat{f}_{i+1/2} - \\hat{f}_{i-1/2})$.\n- $i=0: u_0^{n+1} = 2.0 - 0.2(2.0 - 0.5) = 2.0 - 0.3 = 1.7$.\n- $i=1: u_1^{n+1} = -1.0 - 0.2(0.0 - 2.0) = -1.0 + 0.4 = -0.6$.\n- $i=2: u_2^{n+1} = 0.5 - 0.2(0.125 - 0.0) = 0.5 - 0.025 = 0.475$.\n- $i=3: u_3^{n+1} = -0.5 - 0.2(0.0 - 0.125) = -0.5 + 0.025 = -0.475$.\n- $i=4: u_4^{n+1} = 1.0 - 0.2(0.5 - 0.0) = 1.0 - 0.1 = 0.9$.\nResult for inviscid case: $u^{n+1}_{\\text{inv}} = [1.7, -0.6, 0.475, -0.475, 0.9]$.\n\n**Viscous Case ($\\nu=0.05$):**\nThe diffusive coefficient is $2\\nu = 2(0.05) = 0.1$. The update is $u_i^{n+1} = u_i^{\\text{inv}} + 0.1(u_{i+1}^n - 2u_i^n + u_{i-1}^n)$, where $u_i^{\\text{inv}}$ is the result from the inviscid update part.\n- $i=0: u_0^{n+1} = 1.7 + 0.1(u_1-2u_0+u_4) = 1.7 + 0.1(-1.0 - 2(2.0) + 1.0) = 1.7 - 0.4 = 1.3$.\n- $i=1: u_1^{n+1} = -0.6 + 0.1(u_2-2u_1+u_0) = -0.6 + 0.1(0.5 - 2(-1.0) + 2.0) = -0.6 + 0.45 = -0.15$.\n- $i=2: u_2^{n+1} = 0.475 + 0.1(u_3-2u_2+u_1) = 0.475 + 0.1(-0.5 - 2(0.5) - 1.0) = 0.475 - 0.25 = 0.225$.\n- $i=3: u_3^{n+1} = -0.475 + 0.1(u_4-2u_3+u_2) = -0.475 + 0.1(1.0 - 2(-0.5) + 0.5) = -0.475 + 0.25 = -0.225$.\n- $i=4: u_4^{n+1} = 0.9 + 0.1(u_0-2u_4+u_3) = 0.9 + 0.1(2.0 - 2(1.0) - 0.5) = 0.9 - 0.05 = 0.85$.\nResult for viscous case: $u^{n+1}_{\\text{vis}} = [1.3, -0.15, 0.225, -0.225, 0.85]$.\n\nFinal computed values are consistent with the problem statement's requirements.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the derivation and calculation for the Godunov scheme applied to\n    the Burgers' equation, for both inviscid and viscous cases.\n    \"\"\"\n\n    def godunov_flux(u_L, u_R):\n        \"\"\"\n        Computes the exact Godunov flux for the Burgers' equation f(u) = 0.5 * u^2.\n        The flux is determined by the solution of the Riemann problem at the interface.\n\n        Args:\n            u_L (float): State on the left of the interface.\n            u_R (float): State on the right of the interface.\n\n        Returns:\n            float: The numerical flux at the interface.\n        \"\"\"\n        # Physical flux function f(u) = 0.5 * u^2\n        f_L = 0.5 * u_L**2\n        f_R = 0.5 * u_R**2\n\n        if u_L  u_R:  # Shock wave\n            # Shock speed from Rankine-Hugoniot condition\n            s = 0.5 * (u_L + u_R)\n            if s = 0:\n                # Shock moves right or is stationary, state at interface is u_L\n                return f_L\n            else:\n                # Shock moves left, state at interface is u_R\n                return f_R\n        else:  # Rarefaction wave (or constant state u_L = u_R)\n            if u_L = 0:\n                # Entire fan moves right, state at interface is u_L\n                return f_L\n            elif u_R = 0:\n                # Entire fan moves left, state at interface is u_R\n                return f_R\n            else:  # u_L  0  u_R\n                # Fan contains the x/t=0 ray, state is 0\n                return 0.0\n\n    # Part 1: Compute numerical flux for the given test pairs\n    flux_test_cases = [\n        (-1.0, 2.0),\n        (2.0, 1.0),\n        (-2.0, -3.0),\n        (0.0, 0.0),\n        (0.5, 1.5),\n        (-1.5, -0.5),\n    ]\n    flux_results = [godunov_flux(uL, uR) for uL, uR in flux_test_cases]\n\n    # Part 2: Perform one explicit finite volume update\n    # Define simulation parameters\n    N = 5\n    dx = 0.1\n    dt = 0.02\n    u_initial = np.array([2.0, -1.0, 0.5, -0.5, 1.0])\n    nu_inv = 0.0  # Inviscid case\n    nu_vis = 0.05 # Viscous case\n\n    def fv_update_step(u_n, N_cells, dx_val, dt_val, nu_val):\n        \"\"\"\n        Performs a single explicit finite volume update step on a periodic mesh.\n        \"\"\"\n        u_np1 = np.zeros_like(u_n)\n        \n        # Precompute update coefficients\n        cfl_conv = dt_val / dx_val\n        cfl_diff = nu_val * dt_val / (dx_val**2)\n\n        for i in range(N_cells):\n            # Apply periodic boundary conditions using modulo arithmetic\n            i_minus_1 = (i - 1 + N_cells) % N_cells\n            i_plus_1 = (i + 1) % N_cells\n            \n            u_left = u_n[i_minus_1]\n            u_center = u_n[i]\n            u_right = u_n[i_plus_1]\n            \n            # Convective term update using Godunov fluxes\n            f_hat_right = godunov_flux(u_center, u_right)\n            f_hat_left = godunov_flux(u_left, u_center)\n            convective_update = -cfl_conv * (f_hat_right - f_hat_left)\n            \n            # Diffusive term update using centered differences\n            diffusive_update = cfl_diff * (u_right - 2 * u_center + u_left)\n            \n            # Combine terms for the full update\n            u_np1[i] = u_center + convective_update + diffusive_update\n            \n        return u_np1.tolist()\n\n    # Calculate final states for both cases\n    u_final_inv = fv_update_step(u_initial, N, dx, dt, nu_inv)\n    u_final_vis = fv_update_step(u_initial, N, dx, dt, nu_vis)\n\n    # Format the output string as per the problem specification\n    def format_list_compactly(data_list):\n        return f\"[{','.join(map(str, data_list))}]\"\n\n    flux_str = ','.join(map(str, flux_results))\n    u_inv_str = format_list_compactly(u_final_inv)\n    u_vis_str = format_list_compactly(u_final_vis)\n\n    final_output = f\"[{flux_str},{u_inv_str},{u_vis_str}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}