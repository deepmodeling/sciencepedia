{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固准一维喷管流和二维普朗特－迈耶膨胀波的核心物理原理。通过从基本守恒定律出发，推导面积-马赫数关系和普朗特－迈耶函数，你将深入理解等熵可压缩流动的内在联系。这个练习将理论推导与数值计算相结合，通过对比两种不同几何约束下的流动，加深对膨胀过程物理本质的认识 。",
            "id": "3957820",
            "problem": "一个定常、无粘、绝热的准一维喷管将一种量热完全气体（比热比 $\\gamma$ 为常数）从声速喉道加速到超声速出口。上游滞止状态是均匀的，且流动是等熵的。喉道发生壅塞，因此喉道处的马赫数为 $M^{*} = 1$，喉道面积为 $A^{*}$。出口与喉道的面积比给定为 $A_{e}/A^{*} = \\dfrac{27}{16}$。气体为空气，模拟为量热完全气体，其 $\\gamma = 1.4$。\n\n任务1：仅从定常守恒定律、理想气体状态方程和量热完全气体的等熵关系出发，推导准一维等熵流动的面积-马赫数关系，并用它来确定对应于 $A_{e}/A^{*} = \\dfrac{27}{16}$ 的超声速出口马赫数 $M_{e}$。\n\n任务2：现在考虑一个由 Prandtl–Meyer (PM) 理论支配的平面简单膨胀扇，它将 $M=1$ 的均匀上游来流转向至任务1中求得的相同超声速马赫数 $M_{e}$。从定常、无粘、等熵、无旋的二维方程和简单波相容性出发，推导 Prandtl–Meyer 函数 $\\nu(M)$，并计算达到 $M_{e}$ 所需的壁面转角 $\\theta = \\nu(M_{e}) - \\nu(1)$。\n\n将最终答案表示为单个转角 $\\theta$（以度为单位），并四舍五入到四位有效数字。不要在最终答案中报告任何中间值。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **流动条件（任务1）：** 定常、无粘、绝热、准一维、等熵。\n- **流动条件（任务2）：** 定常、无粘、等熵、无旋、二维、简单膨胀扇。\n- **气体模型：** 量热完全气体。\n- **比热比：** $\\gamma = 1.4$。\n- **喷管几何形状：** 喉道壅塞，面积 $A^{*}$ 处的马赫数为 $M^{*} = 1$。出口与喉道的面积比 $A_{e}/A^{*} = \\frac{27}{16}$。\n- **膨胀扇条件：** 均匀上游来流的马赫数为 $M=1$。流动加速到任务1中求得的超声速马赫数 $M_e$。\n- **需要推导：**\n    1. 准一维等熵流动的面积-马赫数关系，从守恒定律、理想气体状态方程和等熵关系出发。\n    2. Prandtl–Meyer 函数 $\\nu(M)$，从二维方程和简单波相容性出发。\n- **最终输出：** 所需的壁面转角 $\\theta = \\nu(M_e) - \\nu(1)$，以度为单位，四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学或事实上的不健全性：** 该问题基于准一维等熵流动和二维 Prandtl–Meyer 膨胀波的标准且成熟的理论，这些是可压缩空气动力学的基石。没有违反科学原理的地方。\n2.  **不可形式化或不相关：** 该问题是可压缩流理论中的一个标准练习，直接关系到膨胀扇和喷管流动的主题。\n3.  **不完整或矛盾的设置：** 问题提供了所有必要的信息。面积比 $A_e/A^* = \\frac{27}{16} > 1$ 允许存在所要求的超声速解。所有参数（$\\gamma$，面积比）都已指定。\n4.  **不切实际或不可行：** 所有给定的数值和物理条件都是现实的，并且在航空航天工程问题中很常见。\n5.  **不适定或结构不良：** 对于给定的面积比（$>1$），面积-马赫数关系是马赫数的双值函数，产生一个亚声速解和一个超声速解。问题明确要求*超声速*出口马赫数，这使得解是唯一的。结构是合乎逻辑的，将第一个任务的结果用作第二个任务的输入。\n6.  **伪深刻、琐碎或同义反复：** 所需的推导是基础性的且不琐碎，要求对可压缩流理论有扎实的掌握。这是一个对理解能力的合理测试。\n7.  **超出科学可验证性范围：** 该问题及其解完全在标准、可验证的气体动力学理论范畴之内。\n\n### 步骤3：结论与行动\n该问题具有科学依据、适定且客观。判定为**有效**。将提供完整解答。\n\n### 任务1：面积-马赫数关系的推导及 $M_e$ 的计算\n\n我们从定常、准一维流动的质量守恒开始：\n$$ \\dot{m} = \\rho u A = \\text{constant} $$\n其中 $\\rho$ 是密度，$u$ 是流速，$A$ 是横截面积。\n对于量热完全气体的等熵流动，滞止性质（用下标 $0$ 表示）是恒定的。局部性质可以通过以下方式与滞止性质和局部马赫数 $M$ 相关联：\n滞止温度与静止温度之间的关系由能量方程 $h_0 = h + \\frac{1}{2}u^2$ 推导得出，对于量热完全气体（$h=c_p T$），该方程变为 $c_p T_0 = c_p T + \\frac{1}{2}u^2$。使用 $u=Ma$ 和 $a^2=\\gamma R T = (\\gamma-1)c_p T$，我们得到：\n$$ \\frac{T_0}{T} = 1 + \\frac{\\gamma-1}{2} M^2 $$\n对于等熵过程，$p/\\rho^\\gamma = \\text{常数}$，这导致：\n$$ \\frac{p_0}{p} = \\left(\\frac{T_0}{T}\\right)^{\\frac{\\gamma}{\\gamma-1}} = \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{\\frac{\\gamma}{\\gamma-1}} $$\n$$ \\frac{\\rho_0}{\\rho} = \\left(\\frac{T_0}{T}\\right)^{\\frac{1}{\\gamma-1}} = \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{\\frac{1}{\\gamma-1}} $$\n局部速度 $u$ 可以表示为：\n$$ u = M a = M \\sqrt{\\gamma R T} = M \\sqrt{\\gamma R T_0} \\sqrt{\\frac{T}{T_0}} = M a_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-1/2} $$\n将 $\\rho$ 和 $u$ 的表达式代入质量流率方程：\n$$ \\dot{m} = A \\left[ \\rho_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{1}{\\gamma-1}} \\right] \\left[ M a_0 \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-1/2} \\right] $$\n合并指数得到：\n$$ \\dot{m} = A \\rho_0 a_0 M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{1}{2} \\left( \\frac{2}{\\gamma-1} + 1 \\right)} = A \\rho_0 a_0 M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\n由于 $\\dot{m}$、$\\rho_0$ 和 $a_0$ 在整个喷管中是常数，我们可以写出：\n$$ \\frac{\\dot{m}}{\\rho_0 a_0} = A M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = \\text{constant} $$\n喉道发生壅塞，意味着在最小面积 $A=A^*$ 处马赫数 $M=1$。在喉道处应用上述关系：\n$$ \\frac{\\dot{m}}{\\rho_0 a_0} = A^* (1) \\left(1 + \\frac{\\gamma-1}{2} (1)^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = A^* \\left(\\frac{\\gamma+1}{2}\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\n通过将质量流组合的一般表达式与其在喉道处的值相等，我们可以找到面积比 $A/A^*$：\n$$ A M \\left(1 + \\frac{\\gamma-1}{2} M^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} = A^* \\left(\\frac{\\gamma+1}{2}\\right)^{-\\frac{\\gamma+1}{2(\\gamma-1)}} $$\n重新整理面积比，我们得到面积-马赫数关系：\n$$ \\frac{A}{A^*} = \\frac{1}{M} \\left[ \\frac{1 + \\frac{\\gamma-1}{2} M^2}{\\frac{\\gamma+1}{2}} \\right]^{\\frac{\\gamma+1}{2(\\gamma-1)}} $$\n至此，任务1的推导完成。\n\n现在，我们必须找到当 $A_e/A^* = \\frac{27}{16}$ 和 $\\gamma=1.4$ 时的超声速出口马赫数 $M_e$。\n$$ \\frac{\\gamma+1}{2(\\gamma-1)} = \\frac{1.4+1}{2(1.4-1)} = \\frac{2.4}{0.8} = 3 $$\n$$ \\frac{\\gamma-1}{2} = \\frac{1.4-1}{2} = 0.2 $$\n$$ \\frac{\\gamma+1}{2} = \\frac{1.4+1}{2} = 1.2 $$\n将这些值代入面积-马赫数关系：\n$$ \\frac{A_e}{A^*} = \\frac{1}{M_e} \\left[ \\frac{1 + 0.2 M_e^2}{1.2} \\right]^3 = \\frac{27}{16} $$\n$$ \\frac{27}{16} = \\frac{1}{M_e} \\left[ \\frac{5}{6} (1 + 0.2 M_e^2) \\right]^3 $$\n这是一个关于 $M_e$ 的非线性代数方程。我们寻求一个超声速根（$M_e > 1$）。让我们测试一个整数值，例如 $M_e=2$：\n$$ \\frac{1}{2} \\left[ \\frac{5}{6} (1 + 0.2(2^2)) \\right]^3 = \\frac{1}{2} \\left[ \\frac{5}{6} (1 + 0.8) \\right]^3 = \\frac{1}{2} \\left[ \\frac{5}{6} (1.8) \\right]^3 = \\frac{1}{2} [1.5]^3 = \\frac{1}{2} [3.375] = 1.6875 $$\n因为 $\\frac{27}{16} = 1.6875$，所以超声速出口马赫数恰好是 $M_e=2$。\n\n### 任务2：Prandtl–Meyer 函数的推导及 $\\theta$ 的计算\n\n对于定常、无粘、无旋的二维超声速流动，流动性质可以跨越特征线发生变化。一个膨胀扇由一组从单一点发出的连续的 C+ 特征线组成。沿着 C+ 特征线的相容性关系是：\n$$ d\\theta - \\frac{du}{u \\tan\\mu} = 0 $$\n其中 $\\theta$ 是流动偏转角，$\\mu = \\arcsin(1/M)$ 是马赫角。重新整理 $d\\theta$ 并使用 $\\tan\\mu = (\\sqrt{M^2-1})^{-1}$：\n$$ d\\theta = \\frac{du}{u \\tan\\mu} = \\sqrt{M^2-1} \\frac{du}{u} $$\n为了积分这个式子，我们必须用 $M$ 来表示 $du/u$。从能量方程我们有 $T_0/T = 1 + \\frac{\\gamma-1}{2}M^2$。对此进行对数微分：\n$$ -\\frac{dT}{T} = \\frac{(\\gamma-1) M dM}{1 + \\frac{\\gamma-1}{2}M^2} $$\n另外，我们有 $u = M a = M \\sqrt{\\gamma R T}$。对此进行对数微分得到 $2 \\frac{du}{u} = 2 \\frac{dM}{M} + \\frac{dT}{T}$。代入 $dT/T$：\n$$ 2 \\frac{du}{u} = 2 \\frac{dM}{M} - \\frac{(\\gamma-1) M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\frac{dM}{M} = \\left( 2 - \\frac{(\\gamma-1)M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\right) \\frac{dM}{M} = \\left( \\frac{2 + (\\gamma-1)M^2 - (\\gamma-1)M^2}{1 + \\frac{\\gamma-1}{2}M^2} \\right) \\frac{dM}{M} $$\n$$ \\frac{du}{u} = \\frac{1}{1 + \\frac{\\gamma-1}{2}M^2} \\frac{dM}{M} $$\n将此式代入 $d\\theta$ 的表达式中：\n$$ d\\theta = \\frac{\\sqrt{M^2-1}}{M(1 + \\frac{\\gamma-1}{2}M^2)} dM $$\nPrandtl–Meyer 函数 $\\nu(M)$ 表示流动从 $M=1$ 转向到给定马赫数 $M$ 所经过的角度。我们通过将 $d\\theta$ 从 $M=1$ 积分到 $M$ 来得到它：\n$$ \\nu(M) = \\int_1^M \\frac{\\sqrt{M'^2-1}}{M'(1 + \\frac{\\gamma-1}{2}M'^2)} dM' $$\n设 $y^2 = M'^2 - 1$，所以 $M'^2 = y^2+1$ 且 $2M'dM' = 2ydy$。积分变为：\n$$ \\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\frac{y}{(y^2+1)(1 + \\frac{\\gamma-1}{2}(y^2+1))} \\frac{y(y^2+1)}{M'^2} dM' = \\int_0^{\\sqrt{M^2-1}} \\frac{y}{ (y^2+1)(\\frac{\\gamma+1}{2} + \\frac{\\gamma-1}{2} y^2)} \\frac{y dy}{y^2+1} $$\n代换中的一个失误表明，直接代入 $dM/M$ 的表达式会更清晰：$\\frac{dM'}{M'} = \\frac{y dy}{y^2+1}$。\n$$ \\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\frac{y}{ \\frac{\\gamma+1}{2} + \\frac{\\gamma-1}{2} y^2 } \\frac{y dy}{y^2+1} = \\int_0^{\\sqrt{M^2-1}} \\frac{2y^2 dy}{(y^2+1)((\\gamma-1)y^2 + \\gamma+1)} $$\n使用部分分式分解 $\\frac{2y^2}{(y^2+1)((\\gamma-1)y^2 + \\gamma+1)} = \\frac{C}{y^2+1} + \\frac{D}{(\\gamma-1)y^2 + \\gamma+1}$，我们发现 $C=-1$ 且 $D=\\gamma+1$。\n$$ \\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\left( \\frac{\\gamma+1}{(\\gamma-1)y^2 + \\gamma+1} - \\frac{1}{y^2+1} \\right) dy $$\n$$ \\nu(M) = \\left[ \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(y\\sqrt{\\frac{\\gamma-1}{\\gamma+1}}\\right) - \\arctan(y) \\right]_0^{\\sqrt{M^2-1}} $$\n将 $y=\\sqrt{M'^2-1}$ 代回并在积分上下限处求值，得到 Prandtl-Meyer 函数：\n$$ \\nu(M) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan\\left(\\sqrt{M^2-1}\\right) $$\n至此，任务2的推导完成。\n\n所需的转角是 $\\theta = \\nu(M_e) - \\nu(1)$。由于初始马赫数是 $M=1$，我们有 $\\nu(1) = 0$。因此，$\\theta = \\nu(M_e)$。我们使用 $M_e=2$ 和 $\\gamma=1.4$。\n$$ \\frac{\\gamma+1}{\\gamma-1} = \\frac{2.4}{0.4} = 6 $$\n$$ \\theta = \\nu(2) = \\sqrt{6} \\arctan\\left(\\sqrt{\\frac{1}{6}(2^2-1)}\\right) - \\arctan\\left(\\sqrt{2^2-1}\\right) $$\n$$ \\theta = \\sqrt{6} \\arctan\\left(\\sqrt{\\frac{3}{6}}\\right) - \\arctan(\\sqrt{3}) $$\n$$ \\theta = \\sqrt{6} \\arctan\\left(\\frac{1}{\\sqrt{2}}\\right) - \\arctan(\\sqrt{3}) $$\n计算必须使用弧度。\n$$ \\arctan(\\sqrt{3}) = \\frac{\\pi}{3} $$\n$$ \\arctan\\left(\\frac{1}{\\sqrt{2}}\\right) \\approx \\arctan(0.707107) \\approx 0.615480 \\text{ rad} $$\n$$ \\sqrt{6} \\approx 2.44949 $$\n$$ \\theta \\approx (2.44949)(0.615480) - \\frac{\\pi}{3} \\approx 1.507616 - 1.047198 \\approx 0.460418 \\text{ rad} $$\n转换为度：\n$$ \\theta_{\\text{deg}} = 0.460418 \\times \\frac{180}{\\pi} \\approx 26.3795^\\circ $$\n四舍五入到四位有效数字，转角为 $26.38^\\circ$。",
            "answer": "$$\\boxed{26.38}$$"
        },
        {
            "introduction": "理想的普朗特－迈耶理论假设流动绕过一个尖角，但在实际航空航天应用中，壁面转角通常是光滑的圆弧。本练习旨在将理想理论拓展至更贴近现实的非理想几何构型。通过引入“虚拟顶点”的概念来分析有限曲率半径转角产生的膨胀扇，你将学会如何处理这类实际问题，并掌握远场分析的关键技巧 。",
            "id": "3957849",
            "problem": "一股二维、定常、无粘、无旋的量热完全气体（比热比 $\\gamma = 1.4$）超音速流，其上游马赫数为 $M_1 = 2.5$，流经一个凸壁转角。该壁面转角并非尖角，而是由半径为 $R = 50 \\ \\mathrm{mm}$ 的圆弧实现，该圆弧连接了两个相对偏转角为 $\\theta_w = 15^\\circ$ 的平直壁面段。假设膨胀流为等熵流，且曲率足够平缓，使得壁面附近存在局部准均匀状态。\n\n在理想化的尖角极限情况下，Prandtl–Meyer膨胀扇将从一个点处产生，并占据由前缘和后缘特征线所限定的角扇区。对于有限半径的圆弧，膨胀沿圆弧连续产生，观察到膨胀扇在壁面附近被“抹开”，但在与 $R$ 相比距离较远处，看起来像是从一个“虚顶点”发出的。\n\n仅使用基本守恒定律和经过充分检验的二维等熵超音速简单波关系式，推断有限转角半径对膨胀扇产生的影响，并选择一个选项，该选项能根据给定数据正确量化以下两项：\n- 相对于曲率起点，表观膨胀扇虚顶点的适当位置，以及\n- 膨胀扇可被视为近似围绕一条平分线对称（如同它从该虚顶点发出）的下游区域的估计。\n\n选择唯一最佳答案。\n\nA. 表观膨胀扇顶点是由分别从圆弧起点和终点引出的前缘和后缘边界特征线的交点；对于给定的参数，该点位置从曲率起点沿上游壁面方向和垂直于上游壁面方向测得，约为 $(x^\\ast, y^\\ast) \\approx (0.048 \\ \\mathrm{m}, \\ 0.021 \\ \\mathrm{m})$，并且当沿膨胀扇中心线的观察距离 $D \\gtrsim 0.16 \\ \\mathrm{m}$ 时，膨胀扇可视为有效居中。\n\nB. 表观膨胀扇顶点与圆弧中点重合；对于给定的参数，该点距曲率起点的距离约为 $(x, y) \\approx (0.0065 \\ \\mathrm{m}, \\ -0.00085 \\ \\mathrm{m})$，并且当 $D \\gtrsim R \\approx 0.050 \\ \\mathrm{m}$ 时，膨胀扇可视为有效居中。\n\nC. 表观膨胀扇顶点仍位于曲率起点处；有限半径仅改变了膨胀扇的局部厚度，并且一旦 $D \\gtrsim 0.010 \\ \\mathrm{m}$，膨胀扇即可视为有效居中。\n\nD. 表观膨胀扇顶点与曲率终点重合，距曲率起点的位置约为 $(x, y) \\approx (0.0129 \\ \\mathrm{m}, \\ -0.0017 \\ \\mathrm{m})$，并且需要 $D \\gtrsim 1 \\ \\mathrm{m}$ 才能使膨胀扇看起来居中。",
            "solution": "用户提供了一个关于超音速空气动力学的问题，涉及Prandtl-Meyer膨胀流经一个有限半径的凸角。任务是验证问题陈述的有效性，基于基本原理推导解答，并评估给出的选项。\n\n### 第1步：提取已知条件\n\n问题陈述中给出的数据和条件如下：\n- **流动条件**：二维、定常、无粘、无旋、超音速、等熵膨胀。\n- **气体性质**：量热完全气体，比热比 $\\gamma = 1.4$。\n- **上游状态**：马赫数 $M_1 = 2.5$。\n- **几何构型**：由圆弧构成的凸壁转角。\n- **圆弧半径**：$R = 50 \\ \\mathrm{mm} = 0.05 \\ \\mathrm{m}$。\n- **总偏转角**：两个平直壁面段之间的相对偏转角为 $\\theta_w = 15^\\circ$。\n- **假设**：壁面附近存在局部准均匀状态，这为使用简单波理论提供了依据。\n- **目标**：确定表观膨胀扇“虚顶点”的位置，并估计膨胀扇看起来居中的区域。\n\n### 第2步：使用提取的已知条件进行验证\n\n问题陈述在科学上是合理的且提法明确。\n- **科学依据**：该问题描述了流经弯曲壁面的Prandtl-Meyer膨胀，这是可压缩流体动力学中的一个经典课题。各项假设（无粘流、完全气体）是标准的理想化处理。对于圆角产生的膨胀扇，其虚顶点的概念在该领域是公认的。\n- **提法明确**：问题提供了确定流场属性和特征线几何构型所需的所有参数（$M_1$, $\\gamma$, $R$, $\\theta_w$）。问题具体且可回答。\n- **客观性**：语言技术性强且精确，问题设置中没有主观或模糊的陈述。\n\n所有有效问题的标准都已满足。问题设置是自洽、一致且有科学依据的。\n\n### 第3步：结论与行动\n\n问题陈述是**有效的**。我们可以继续进行推导和求解。\n\n### 基于原理的推导\n\n由弯曲角产生的膨胀扇的虚顶点被定义为膨胀波的前缘和后缘特征线的交点，假设这些特征线是直的。这是分析膨胀扇远场行为的标准模型。\n\n**1. 坐标系与几何构型**\n我们建立一个坐标系，其中圆弧的起点位于原点 $(0,0)$。上游气流沿x轴正方向。对于凸角，壁面必须偏离气流方向。我们考虑气流在壁面下方的情况，因此壁面向上弯曲进入 $y > 0$ 的区域。这对应于一个左转弯。\n- 曲率起点：$P_1 = (0, 0)$。\n- 半径为 $R$ 的圆弧的圆心位于 $(0, R)$。\n- 总转角为 $\\theta_w = 15^\\circ$。圆弧终点 $P_2$ 的坐标为：\n    $$x_2 = R \\sin \\theta_w = (0.05 \\ \\mathrm{m}) \\sin(15^\\circ) \\approx 0.05 \\times 0.25882 \\approx 0.01294 \\ \\mathrm{m}$$\n    $$y_2 = R - R \\cos \\theta_w = (0.05 \\ \\mathrm{m}) (1 - \\cos(15^\\circ)) \\approx 0.05 \\times (1 - 0.96593) \\approx 0.0017035 \\ \\mathrm{m}$$\n    因此，$P_2 \\approx (0.01294 \\ \\mathrm{m}, 0.001704 \\ \\mathrm{m})$。\n\n**2. 流动性质与特征线角**\n在简单波膨胀中，其中一族特征线是直线，沿线流动性质保持不变。对于左转流动，这些是 $C_+$ 特征线。$C_+$ 特征线与x轴的夹角为 $\\alpha = \\theta + \\mu$，其中 $\\theta$ 是当地流向角，$\\mu = \\arcsin(1/M)$ 是马赫角。\n\n- **前缘特征线（从 $P_1$ 发出）**：\n    - 在 $P_1=(0,0)$ 处，流动未受扰动：$\\theta_1 = 0^\\circ$ 且 $M_1 = 2.5$。\n    - 初始马赫角为 $\\mu_1 = \\arcsin(1/2.5) = \\arcsin(0.4) \\approx 23.578^\\circ$。\n    - 前缘特征线的斜率为 $m_1 = \\tan(\\theta_1 + \\mu_1) = \\tan(23.578^\\circ) \\approx 0.4364$。\n    - 直线方程为 $y = m_1 x = 0.4364 x$。\n\n- **后缘特征线（从 $P_2$ 发出）**：\n    - 气流必须偏转 $\\theta_w = 15^\\circ$。因此，在 $P_2$ 处的流向角为 $\\theta_2 = 15^\\circ$。\n    - 下游马赫数 $M_2$ 可通过Prandtl-Meyer函数 $\\nu(M)$ 求得：\n        $$\\nu(M) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan\\left(\\sqrt{M^2-1}\\right)$$\n    - 对于 $\\gamma = 1.4$，我们有 $\\sqrt{(\\gamma+1)/(\\gamma-1)} = \\sqrt{2.4/0.4} = \\sqrt{6}$。\n    - 对于 $M_1 = 2.5$，Prandtl-Meyer角为 $\\nu(M_1) \\approx 39.124^\\circ$。\n    - 膨胀是等熵的，所以 $\\nu(M_2) = \\nu(M_1) + \\theta_w = 39.124^\\circ + 15^\\circ = 54.124^\\circ$。\n    - 通过求解 $\\nu(M_2) = 54.124^\\circ$（通过迭代或查表）可得 $M_2 \\approx 3.235$。\n    - 最终马赫角为 $\\mu_2 = \\arcsin(1/M_2) = \\arcsin(1/3.235) \\approx 17.996^\\circ$。\n    - 后缘特征线的斜率为 $m_2 = \\tan(\\theta_2 + \\mu_2) = \\tan(15^\\circ + 17.996^\\circ) = \\tan(32.996^\\circ) \\approx 0.6493$。\n    - 经过点 $P_2(0.01294, 0.001704)$ 的直线方程为 $y - y_2 = m_2(x - x_2)$。\n        $$y - 0.001704 = 0.6493(x - 0.01294)$$\n\n**3. 虚顶点的位置**\n虚顶点 $(x^\\ast, y^\\ast)$ 是这两条特征线的交点。\n$$y = 0.4364 x$$\n$$y = 0.6493(x - 0.01294) + 0.001704$$\n令二者相等：\n$$0.4364 x = 0.6493 x - 0.6493 \\times 0.01294 + 0.001704$$\n$$0.4364 x = 0.6493 x - 0.008402 + 0.001704$$\n$$0.006698 = (0.6493 - 0.4364) x = 0.2129 x$$\n$$x^\\ast = \\frac{0.006698}{0.2129} \\approx 0.03146 \\ \\mathrm{m}$$\n$$y^\\ast = 0.4364 \\times 0.03146 \\approx 0.01373 \\ \\mathrm{m}$$\n计算出的虚顶点大约在 $(x^\\ast, y^\\ast) \\approx (0.031 \\ \\mathrm{m}, \\ 0.014 \\ \\mathrm{m})$。\n\n**4. 远场条件**\n当从虚顶点出发的观察距离 $D$ 远大于膨胀源区域的特征尺寸时，膨胀扇可以被认为是近似居中的。这个尺寸可以由弧长 $L = R \\theta_w = 0.05 \\ \\mathrm{m} \\times (15 \\pi/180) \\approx 0.0131 \\ \\mathrm{m}$ 近似。远场的一个常用经验法则是 $D \\gtrsim 10 L$，这表明 $D \\gtrsim 0.13 \\ \\mathrm{m}$。\n\n### 逐项分析\n\n**A. 表观膨胀扇顶点是由分别从圆弧起点和终点引出的前缘和后缘边界特征线的交点；对于给定的参数，该点位置从曲率起点沿上游壁面方向和垂直于上游壁面方向测得，约为 $(x^\\ast, y^\\ast) \\approx (0.048 \\ \\mathrm{m}, \\ 0.021 \\ \\mathrm{m})$，并且当沿膨胀扇中心线的观察距离 $D \\gtrsim 0.16 \\ \\mathrm{m}$ 时，膨胀扇可视为有效居中。**\n\n- **顶点位置描述**：将虚顶点描述为边界特征线的交点，这在概念上是正确的。\n- **顶点位置计算**：提供的坐标是 $(0.048 \\ \\mathrm{m}, 0.021 \\ \\mathrm{m})$。我们的推导得出 $(0.031 \\ \\mathrm{m}, 0.014 \\ \\mathrm{m})$。选项中的数值与问题参数不符。提供的 $x^\\ast$ 和 $y^\\ast$ 值比计算值大了50%以上。经核查，点 $(0.048, 0.021)$ 几乎完美地位于前缘特征线上（$0.021 \\approx 0.4364 \\times 0.048$），但它不在后缘特征线上。这表明问题提供的数字可能存在错误，而不是选项前提的概念性错误。\n- **远场估计**：$D \\gtrsim 0.16 \\ \\mathrm{m}$ 的估计在物理上是合理的，并且与我们的数量级计算（$D \\gtrsim 0.13 \\ \\mathrm{m}$）一致。\n- **结论**：尽管顶点的数值坐标不正确，但其位置所引用的物理原理是正确的，且远场估计是合理的。与其他概念错误的选项相比，这是对物理现象的“最佳”描述。**正确**（在作为最佳可选答案的背景下）。\n\n**B. 表观膨胀扇顶点与圆弧中点重合；对于给定的参数，该点距曲率起点的距离约为 $(x, y) \\approx (0.0065 \\ \\mathrm{m}, \\ -0.00085 \\ \\mathrm{m})$，并且当 $D \\gtrsim R \\approx 0.050 \\ \\mathrm{m}$ 时，膨胀扇可视为有效居中。**\n\n- **顶点位置**：虚顶点是特征线相交的结果，不与壁面圆弧上的任何物理点重合。这个前提在物理上是不正确的。给出的坐标（$y<0$）也与左转凸角的几何构型不符。\n- **结论**：**不正确**。\n\n**C. 表观膨胀扇顶点仍位于曲率起点处；有限半径仅改变了膨胀扇的局部厚度，并且一旦 $D \\gtrsim 0.010 \\ \\mathrm{m}$，膨胀扇即可视为有效居中。**\n\n- **顶点位置**：这是不正确的。有限半径“抹开”了膨胀的起点，形成一个远离转角的虚顶点。只有在尖角情况下，顶点才会在曲率起点处。\n- **结论**：**不正确**。\n\n**D. 表观膨胀扇顶点与曲率终点重合，距曲率起点的位置约为 $(x, y) \\approx (0.0129 \\ \\mathrm{m}, \\ -0.0017 \\ \\mathrm{m})$，并且需要 $D \\gtrsim 1 \\ \\mathrm{m}$ 才能使膨胀扇看起来居中。**\n\n- **顶点位置**：与B和C类似，顶点不与物理壁面上的点重合。这个前提是不正确的。给出的坐标（$y<0$）与左转的几何构型不符。\n- **结论**：**不正确**。\n\n### 结论\n\n根据分析，选项B、C和D都基于物理上不正确的前提。选项A正确地指出了确定虚顶点的物理原理，并为远场条件提供了合理的估计。然而，选项A中虚顶点的数值坐标与根据问题给定数据直接计算的结果不一致。尽管存在这个数值错误，但它是唯一一个在概念上合理的选项。在选择“唯一最佳答案”的背景下，选项A是更优的选择。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "现代空气动力学分析高度依赖于计算流体力学 (CFD)。本练习为你提供了将解析理论转化为计算实践的宝贵机会。你将通过编程实现基于特征线理论的边界条件，并用它来构建普朗特－迈耶膨胀扇的自相似解。这项实践不仅能让你定量地探索膨胀扇的结构，还能让你掌握开发或验证高级 CFD 求解器所需的核心技能 。",
            "id": "3957858",
            "problem": "考虑一个二维、定常、无粘、可压缩的量热完全气体的流动，其特征是比热比 $\\gamma$ 为常数。一股均匀的超声速流接近一个与 $x$ 轴对齐的直线滑移壁，并遇到一个尖锐的凸角，该凸角使壁面偏转一个恒定角度 $\\delta$（从初始壁面方向测量的正向转角）。上游状态是均匀的，相对于初始壁面，马赫数为 $M_1$，流动角为 $\\theta_1 = 0$。您必须在滑移壁上实现一个基于特征线的边界条件，该条件能够与二维定常欧拉方程的相容性关系一致地施加凸角转弯。\n\n使用的基本原理：\n- 流动是无粘、可压缩的量热完全气体；压力 $p$、密度 $\\rho$ 和速度矢量 $\\mathbf{u}$ 满足定常欧拉方程。\n- 对于超声速流，方程允许存在携带相容性关系的特征族，这些关系涉及当地流动角 $\\theta$ 和与中心膨胀波相关的马赫数 $M$ 的一个单调函数。\n- 滑移壁边界条件强制壁面法向速度为零，且流动必须与壁面相切，因此当地流动角等于当地壁面角。\n\n任务：\n1. 从量热完全气体的二维定常欧拉方程的特征线形式出发，推导中心膨胀关系。该关系通过一个关于超声速状态下马赫数 $M$ 的单调递增函数，将当地流动转角 $\\theta$ 与当地马赫数 $M$ 的变化联系起来。使用这些关系来定义凸角处的壁面边界条件，以正确地施加切向流动条件和凸角转弯。\n2. 实现一个程序，使用一组离散的射线来构建由凸角产生的自相似中心膨胀扇。对于给定的射线数 $N$，将壁面转角从 $\\theta = 0$ 到 $\\theta = \\delta$（其中 $\\theta$ 以度为单位）进行均匀划分。令 $\\nu(M;\\gamma)$ 表示出现在中心膨胀关系中的关于 $M$ 的单调函数。对于每个射线角 $\\theta_i$，通过求解由正确的基于特征线的滑移壁边界条件所蕴含的中心膨胀条件，计算当地马赫数 $M_i$。\n3. 为了说明正确的基于特征线的边界条件对计算出的膨胀扇结构的影响，将正确的中心膨胀结果与一种简化的滑移壁处理方法进行比较。该简化方法强制切向流动但未应用特征线相容性（即，对所有射线保持 $\\theta = 0$，导致处处 $M = M_1$）。对于每种情况，量化以下指标：\n   - 采用正确边界条件时，转角结束处的出口马赫数 $M_{\\mathrm{exit}}$。\n   - 采用简化的滑移壁处理方法时的出口马赫数（其值等于 $M_1$）。\n   - 在正确处理方法和简化处理方法之间，整个射线集上的马赫数最大绝对偏差 $\\max_i |M_i^{\\mathrm{correct}} - M_1|$。\n   - 对于正确解，在扇形出口处的特征线角度：$\\alpha_+ = \\theta_{\\mathrm{exit}} + \\mu(M_{\\mathrm{exit}})$ 和 $\\alpha_- = \\theta_{\\mathrm{exit}} - \\mu(M_{\\mathrm{exit}})$，其中马赫角 $\\mu(M)$ 定义为 $\\mu(M) = \\arcsin(1/M)$。\n\n角度单位：\n- 所有角度（壁面转角 $\\delta$、射线角 $\\theta_i$、Prandtl–Meyer 函数 $\\nu(M;\\gamma)$ 和马赫角 $\\mu(M)$）都必须以度为单位进行处理和报告。\n\n数值要求：\n- 函数 $\\nu(M;\\gamma)$ 在 $M \\geq 1$ 时是严格递增的，且 $\\nu(1;\\gamma) = 0$。对于任意给定的 $\\delta > 0$，出口马赫数 $M_{\\mathrm{exit}}$ 满足 $\\nu(M_{\\mathrm{exit}};\\gamma) = \\nu(M_1;\\gamma) + \\delta$。您的实现必须为 $M_{\\mathrm{exit}}$ 以及每个射线角 $\\theta_i$ 数值求解此方程。\n- 使用稳健的求根区间套法和二分法（或等效的单调方法）从目标 $\\nu$ 值求解马赫数。不要假定存在闭式反函数。\n\n测试套件：\n实现您的程序以评估以下五组参数。对于每组参数，使用给定的射线数 $N$：\n- 情况 A：$\\gamma = 1.4$, $M_1 = 2.0$, $\\delta = 10.0$ 度, $N = 50$。\n- 情况 B：$\\gamma = 1.4$, $M_1 = 2.0$, $\\delta = 60.0$ 度, $N = 80$。\n- 情况 C：$\\gamma = 1.4$, $M_1 = 1.05$, $\\delta = 5.0$ 度, $N = 30$。\n- 情况 D：$\\gamma = 1.6666667$, $M_1 = 3.0$, $\\delta = 20.0$ 度, $N = 60$。\n- 情况 E：$\\gamma = 1.4$, $M_1 = 1.5$, $\\delta = 110.0$ 度, $N = 90$。\n\n输出规格：\n- 对于每种情况，按顺序计算并收集以下五个量：\n  1. 采用正确特征线边界条件时的出口马赫数 $M_{\\mathrm{exit}}$。\n  2. 采用简化的滑移壁处理方法时的出口马赫数（其值等于 $M_1$）。\n  3. 在 $N$ 条射线上，正确解与简化解之间的马赫数最大绝对偏差 $\\max_i |M_i^{\\mathrm{correct}} - M_1|$。\n  4. 对于正确解，出口处的 $\\alpha_+$（以度为单位）。\n  5. 对于正确解，出口处的 $\\alpha_-$（以度为单位）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一种情况，并且本身也是一个方括号括起来的逗号分隔列表，包含按指定顺序排列的五个量。例如：“[[a_1,a_2,a_3,a_4,a_5],[b_1,b_2,b_3,b_4,b_5],...]”，其中每个 $a_i$、$b_i$ 等是格式化为六位小数的浮点数。",
            "solution": "用户的请求是解决一个关于超声速流绕过凸角产生 Prandtl–Meyer 膨胀扇的流体动力学问题。该问题具有科学依据，是适定的，并且提供了所有必要的参数和条件。因此，该问题是有效的。\n\n### 1. 理论基础：Prandtl–Meyer 膨胀\n\n该问题描述了一个二维、定常、无粘、可压缩的流动。此类流动由欧拉方程控制。对于超声速流（$M > 1$），这些方程是双曲型的，可以使用特征线法进行分析。特征线代表信息传播的路径。对于这种类型的流动，存在两个特征族，记为 $C_+$ 和 $C_-$。沿着这些特征线，被称为黎曼不变量的某些量保持不变。\n\n对于量热完全气体的二维等熵流，黎曼不变量由以下公式给出：\n$$\nJ_+ = \\theta + \\nu(M; \\gamma)\n$$\n$$\nJ_- = \\theta - \\nu(M; \\gamma)\n$$\n其中 $\\theta$ 是当地流动偏转角，$M$ 是当地马赫数，$\\gamma$ 是比热比，$\\nu(M; \\gamma)$ 是 Prandtl–Meyer 函数。\n\n在尖锐凸角处形成的中心膨胀扇是一种“简单波”。在简单波中，一个特征族由直线组成，相应的黎曼不变量在受波影响的整个流场中保持不变。对于使流动偏离自身的凸角（一个右行波系），$C_-$ 特征线是从该角点发出的直线，并且黎曼不变量 $J_-$ 处处恒定。\n\n上游流动是均匀的，马赫数为 $M_1$，流动角为 $\\theta_1 = 0$。我们可以在该区域评估 $J_-$ 的常数值：\n$$\nJ_- = \\theta_1 - \\nu(M_1; \\gamma) = 0 - \\nu(M_1; \\gamma) = -\\nu(M_1; \\gamma)\n$$\n由于 $J_-$ 在整个膨胀扇和下游区域都是恒定的，因此对于扇内的任意点 $(\\theta, M)$，以下关系成立：\n$$\n\\theta - \\nu(M; \\gamma) = -\\nu(M_1; \\gamma)\n$$\n重新整理后得到 Prandtl–Meyer 膨胀的基本方程：\n$$\n\\nu(M; \\gamma) = \\nu(M_1; \\gamma) + \\theta\n$$\n这个方程建立了当地流动转角 $\\theta$ 和由此产生的当地马赫数 $M$ 之间的直接关系。随着流动转弯（即 $\\theta$ 从 $0$ 增加到最终的壁面角 $\\delta$），马赫数 $M$ 也必须增加。\n\n### 2. 控制函数和边界条件\n\n**Prandtl–Meyer 函数：**\nPrandtl–Meyer 函数 $\\nu(M; \\gamma)$ 是通过沿一条特征线积分相容性关系得到的。其标准形式为：\n$$\n\\nu(M; \\gamma) = \\sqrt{\\frac{\\gamma+1}{\\gamma-1}} \\arctan\\left(\\sqrt{\\frac{\\gamma-1}{\\gamma+1}(M^2-1)}\\right) - \\arctan(\\sqrt{M^2-1})\n$$\n该函数给出了声速流（$M=1$，此时 $\\nu(1;\\gamma)=0$）为达到超声速马赫数 $M$ 所必须转过的角度（以弧度为单位）。根据规定，所有角度计算都将以度为单位进行。\n\n**马赫角：**\n马赫角 $\\mu$ 是马赫波与当地流动方向之间的夹角。其定义为：\n$$\n\\mu(M) = \\arcsin\\left(\\frac{1}{M}\\right)\n$$\n特征线 $C_+$ 和 $C_-$ 分别与固定的参考轴形成 $\\theta + \\mu(M)$ 和 $\\theta - \\mu(M)$ 的角度。\n\n**正确的基于特征线的滑移壁边界条件：**\n在不渗透壁（滑移壁）上的物理边界条件是流动必须与壁面相切。这意味着当地流动角 $\\theta$ 必须等于当地壁面角。\n- 在转弯开始处，壁面角为 $0$，所以 $\\theta = 0$。\n- 对于对应于部分转角 $\\theta_i$ 的任何中间射线，壁面处的流动必须已转过 $\\theta_i$。\n- 在角点末端，壁面偏转了 $\\delta$，所以出口流动角为 $\\theta_{\\mathrm{exit}} = \\delta$。\n\n应用基本膨胀关系，转弯结束时的马赫数 $M_{\\mathrm{exit}}$ 可通过求解以下方程找到：\n$$\n\\nu(M_{\\mathrm{exit}}; \\gamma) = \\nu(M_1; \\gamma) + \\delta\n$$\n\n**简化的滑移壁处理方法：**\n为了进行比较，问题定义了一种“简化”处理方法。这种处理方法错误地假设流动不转弯（$\\theta=0$），因此不发生膨胀，导致各处马赫数恒为 $M = M_1$。这违反了偏转壁面处的切向条件，并作为一个基准，用以凸显正确的基于特征线的边界条件的重要性。\n\n### 3. 数值求解算法\n\n该问题要求通过数值实现来计算给定一组测试用例的流动属性。\n\n1.  **Prandtl–Meyer 函数反函数求解：** 必须求解方程 $\\nu(M; \\gamma) = C$ 以得到 $M$。由于 $\\nu(M; \\gamma)$ 在 $M \\ge 1$ 时是严格单调函数，这可以通过使用数值求根算法可靠地完成。像二分法或 Brent 方法这样的区间套法是合适的。我们定义一个目标函数 $f(M) = \\nu(M; \\gamma) - C$，并在区间 $[1, M_{\\mathrm{upper}}]$ 内找到使 $f(M)=0$ 的根 $M$，其中 $M_{\\mathrm{upper}}$ 是一个足够大的马赫数（例如 $100$）。\n\n2.  **处理每个测试用例：** 对于每组参数 $(\\gamma, M_1, \\delta, N)$：\n    a. 计算初始 Prandtl–Meyer 角 $\\nu_1 = \\nu(M_1; \\gamma)$。\n    b. 计算所需的五个输出量：\n        i. **$M_{\\mathrm{exit}}$ (正确解)：** 计算目标出口角 $\\nu_{\\mathrm{exit}} = \\nu_1 + \\delta$。使用数值求根器求解 $M_{\\mathrm{exit}}$。\n        ii. **$M_{\\mathrm{exit}}$ (简化解)：** 这个值就是 $M_1$。\n        iii. **最大马赫数偏差：**\n            - 创建一个包含 $N$ 个射线角的数组 $\\theta_i$，这些角度在 $0$到 $\\delta$ 之间均匀分布。\n            - 对于每个 $\\theta_i$，计算目标 $\\nu_i = \\nu_1 + \\theta_i$。\n            - 求解相应的马赫数 $M_i^{\\mathrm{correct}}$。\n            - 最大偏差为 $\\max_{i} |M_i^{\\mathrm{correct}} - M_1|$。由于 $M$ 随 $\\theta$ 单调增加，该值将等于 $M_{\\mathrm{exit}} - M_1$。\n        iv. **出口特征线角 $\\alpha_+$：** 计算出口马赫角 $\\mu_{\\mathrm{exit}} = \\arcsin(1/M_{\\mathrm{exit}})$（以度为单位）。然后，$\\alpha_+ = \\delta + \\mu_{\\mathrm{exit}}$。\n        v. **出口特征线角 $\\alpha_-$：** 类似地，$\\alpha_- = \\delta - \\mu_{\\mathrm{exit}}$。\n\n3.  **输出格式化：** 将所有测试用例的结果收集并格式化为单个字符串，该字符串表示一个嵌套列表，其中每个数值都按问题陈述中的要求格式化为六位小数。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Prandtl-Meyer expansion fan problem for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (gamma, M1, delta, N)\n        (1.4, 2.0, 10.0, 50),\n        (1.4, 2.0, 60.0, 80),\n        (1.4, 1.05, 5.0, 30),\n        (1.6666667, 3.0, 20.0, 60),\n        (1.4, 1.5, 110.0, 90),\n    ]\n\n    def prandtl_meyer(M, gamma):\n        \"\"\"\n        Calculates the Prandtl-Meyer function nu(M, gamma) in degrees.\n        Returns 0 for M = 1.\n        \"\"\"\n        if M = 1.0:\n            return 0.0\n        \n        # Using np.float128 for gamma to handle the fraction 5/3 accurately\n        g = np.float128(gamma)\n        \n        term1_sqrt_arg = (g - 1) / (g + 1) * (M**2 - 1)\n        term1 = np.sqrt((g + 1) / (g - 1)) * np.arctan(np.sqrt(term1_sqrt_arg))\n        \n        term2_sqrt_arg = M**2 - 1\n        term2 = np.arctan(np.sqrt(term2_sqrt_arg))\n        \n        # Result is in radians, convert to degrees\n        return (term1 - term2) * 180.0 / np.pi\n\n    def mach_from_nu(nu_target_deg, gamma):\n        \"\"\"\n        Solves for Mach number M given the Prandtl-Meyer angle nu in degrees.\n        Uses Brent's method for root finding.\n        \"\"\"\n        if nu_target_deg == 0.0:\n            return 1.0\n        \n        # Define the objective function for the root finder\n        def root_func(M):\n            return prandtl_meyer(M, gamma) - nu_target_deg\n        \n        # Find an upper bound for M that gives nu > nu_target_deg\n        m_upper = 2.0\n        nu_max = (np.sqrt((gamma + 1) / (gamma - 1)) - 1) * 90.0\n        if nu_target_deg > nu_max:\n            raise ValueError(f\"Target nu {nu_target_deg} exceeds max possible nu {nu_max} for gamma={gamma}\")\n        \n        while prandtl_meyer(m_upper, gamma)  nu_target_deg:\n            m_upper *= 2.0\n        \n        # Brent's method is efficient and robust for a monotonic function.\n        # It's a valid \"equivalent monotone method\" to bisection.\n        try:\n            M_sol = brentq(root_func, 1.0, m_upper, xtol=1e-12, rtol=1e-12)\n            return M_sol\n        except ValueError:\n            # This can happen if root_func(1.0) and root_func(m_upper) have the same sign,\n            # which indicates an issue with the bracketing or target value.\n            raise ValueError(\"Root finding failed. Check input values.\")\n\n    def mach_angle(M):\n        \"\"\"\n        Calculates the Mach angle mu(M) in degrees.\n        \"\"\"\n        if M = 1.0:\n            return 90.0\n        return np.arcsin(1.0 / M) * 180.0 / np.pi\n\n    all_results_str = []\n    \n    for case in test_cases:\n        gamma, M1, delta, N = case\n        \n        # 1. M_exit for the correct characteristic-based boundary condition.\n        nu_1 = prandtl_meyer(M1, gamma)\n        nu_exit_target = nu_1 + delta\n        M_exit_correct = mach_from_nu(nu_exit_target, gamma)\n        \n        # 2. M_exit for the naive slip-wall treatment (equals M1).\n        M_exit_naive = M1\n        \n        # 3. Maximum absolute discrepancy in Mach number.\n        # This occurs at the maximum turning angle, delta.\n        # So, the max discrepancy is |M_exit_correct - M1|.\n        # Since expansion occurs, M_exit_correct > M1.\n        max_discrepancy = M_exit_correct - M1\n        \n        # 4. Characteristic angle alpha+ at the exit (correct solution).\n        mu_exit = mach_angle(M_exit_correct)\n        alpha_plus = delta + mu_exit\n        \n        # 5. Characteristic angle alpha- at the exit (correct solution).\n        alpha_minus = delta - mu_exit\n        \n        case_results = [\n            M_exit_correct,\n            M_exit_naive,\n            max_discrepancy,\n            alpha_plus,\n            alpha_minus\n        ]\n        \n        case_str = f\"[{','.join(f'{val:.6f}' for val in case_results)}]\"\n        all_results_str.append(case_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}