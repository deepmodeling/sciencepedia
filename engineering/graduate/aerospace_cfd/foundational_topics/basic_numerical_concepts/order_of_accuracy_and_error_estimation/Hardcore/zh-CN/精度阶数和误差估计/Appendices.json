{
    "hands_on_practices": [
        {
            "introduction": "高阶精度格式是精确解析复杂流动结构（如边界层和激波）的关键。本练习将引导您完成构建高阶有限差分格式的基本过程，您将运用泰勒级数分析来确定一个四阶精度拉普拉斯算子的模板系数，并推导其主截断误差项 。这项核心技能对于开发和分析数值方法至关重要。",
            "id": "3982491",
            "problem": "航空航天计算流体动力学 (CFD) 模拟通常需要对粘性扩散算子进行高保真离散化，以控制数值耗散并解析薄边界层。考虑一个一维、足够光滑的函数 $u(x)$，它描述了层流边界层计算中沿一条线的流向速度分量，该函数定义在间距为 $h$、节点为 $x_i = x_0 + i h$ 的均匀网格上。您的任务是使用以 $x_i$ 为中心的对称5点模板，为一维拉普拉斯（二阶导数）算子构建一个四阶精度的有限差分近似。\n\n从函数 $u(x)$ 在点 $x_i$ 处关于点 $x_{i \\pm h}$ 和 $x_{i \\pm 2 h}$ 的泰勒级数展开出发，并强制其在主阶上与连续二阶导数算子相容，推导出能够得到 $u''(x_i)$ 四阶精度近似的唯一对称5点模板。然后，使用相同的泰勒展开框架，推导截断误差，并明确确定您的离散拉普拉斯算子的截断误差级数中乘以 $h^4 u^{(6)}(x_i)$ 项的系数。\n\n您最终报告的量必须是截断误差中乘以 $h^4 u^{(6)}(x_i)$ 的单个实值系数。将该系数表示为一个精确的有理数。不需要四舍五入。不要包含单位。",
            "solution": "问题要求推导二阶导数 $u''(x_i)$ 的一个四阶精度、对称的5点有限差分近似，并随后确定其截断误差中主项的系数。\n\n设均匀网格间距为 $h$。在节点 $x_i$ 处二阶导数的近似（我们记作 $L_h u_i$）是五个对称点 $x_{i-2}$、$x_{i-1}$、$x_i$、$x_{i+1}$ 和 $x_{i+2}$ 处函数值的线性组合。我们可以将此近似写为：\n$$\nL_h u_i = \\frac{1}{h^2} \\left[ c_{-2} u(x_{i-2}) + c_{-1} u(x_{i-1}) + c_0 u(x_i) + c_1 u(x_{i+1}) + c_2 u(x_{i+2}) \\right]\n$$\n对于对称模板，系数必须满足 $c_{-k} = c_k$。因此，我们有 $c_{-1} = c_1$ 和 $c_{-2} = c_2$。\n\n为了确定系数 $c_0$、$c_1$ 和 $c_2$，我们使用 $u(x)$ 在点 $x_i$ 附近的泰勒级数展开。对于一个足够光滑的函数 $u(x)$，我们有：\n$$\nu(x_{i+k}) = u(x_i + kh) = \\sum_{n=0}^{\\infty} \\frac{(kh)^n}{n!} u^{(n)}(x_i)\n$$\n其中 $u^{(n)}(x_i)$ 是 $u$ 在 $x_i$ 处的 $n$ 阶导数。\n\n将这些展开式代入 $L_h u_i$ 的公式中：\n$$\nL_h u_i = \\frac{1}{h^2} \\sum_{k=-2}^{2} c_k \\left( \\sum_{n=0}^{\\infty} \\frac{(kh)^n}{n!} u^{(n)}(x_i) \\right)\n$$\n通过交换求和顺序，我们得到：\n$$\nL_h u_i = \\sum_{n=0}^{\\infty} \\left[ \\frac{h^{n-2}}{n!} \\sum_{k=-2}^{2} c_k k^n \\right] u^{(n)}(x_i)\n$$\n我们希望我们的近似 $L_h u_i$ 等于 $u''(x_i)$，其误差阶为 $O(h^4)$。这意味着我们需要将展开式中的各项与表达式 $u''(x_i) + O(h^4)$ 进行匹配。\n\n对于 $n=0$：$u(x_i)$ 的系数必须为零。\n$$\n\\frac{h^{-2}}{0!} \\sum_{k=-2}^{2} c_k k^0 = \\frac{1}{h^2}(c_{-2} + c_{-1} + c_0 + c_1 + c_2) = 0 \\implies c_0 + 2c_1 + 2c_2 = 0\n$$\n\n对于 $n=1$：$u'(x_i)$ 的系数必须为零。\n$$\n\\frac{h^{-1}}{1!} \\sum_{k=-2}^{2} c_k k^1 = \\frac{1}{h}(c_1 - c_1 + 2c_2 - 2c_2) = 0\n$$\n由于对称性 $c_{-k}=c_k$，这一点自动满足。\n\n对于 $n=2$：$u''(x_i)$ 的系数必须为 $1$。\n$$\n\\frac{h^{0}}{2!} \\sum_{k=-2}^{2} c_k k^2 = \\frac{1}{2} (c_1(1)^2 + c_1(-1)^2 + c_2(2)^2 + c_2(-2)^2) = 1 \\implies \\frac{1}{2}(2c_1 + 8c_2) = 1 \\implies c_1 + 4c_2 = 1\n$$\n\n对于 $n=3$：由于对称性，$u'''(x_i)$ 的系数自动为零。\n$$\n\\frac{h^{1}}{3!} \\sum_{k=-2}^{2} c_k k^3 = \\frac{h}{6} (c_1(1)^3 + c_1(-1)^3 + c_2(2)^3 + c_2(-2)^3) = 0\n$$\n\n对于 $n=4$：为达到四阶精度，$h^2 u^{(4)}(x_i)$ 项的系数必须为零。\n$$\n\\frac{h^{2}}{4!} \\sum_{k=-2}^{2} c_k k^4 = \\frac{h^2}{24} (c_1(1)^4 + c_1(-1)^4 + c_2(2)^4 + c_2(-2)^4) = 0 \\implies \\frac{h^2}{24}(2c_1 + 32c_2) = 0 \\implies c_1 + 16c_2 = 0\n$$\n\n现在我们得到了一个关于 $c_1$ 和 $c_2$ 的线性方程组：\n1) $c_1 + 4c_2 = 1$\n2) $c_1 + 16c_2 = 0$\n\n将方程 (2) 减去方程 (1)：\n$$\n(c_1 + 16c_2) - (c_1 + 4c_2) = 0 - 1 \\implies 12c_2 = -1 \\implies c_2 = -\\frac{1}{12}\n$$\n将 $c_2$ 代回方程 (2)：\n$$\nc_1 + 16\\left(-\\frac{1}{12}\\right) = 0 \\implies c_1 - \\frac{16}{12} = 0 \\implies c_1 = \\frac{16}{12} = \\frac{4}{3}\n$$\n最后，我们从第一个条件中求出 $c_0$：\n$$\nc_0 = -2c_1 - 2c_2 = -2\\left(\\frac{4}{3}\\right) - 2\\left(-\\frac{1}{12}\\right) = -\\frac{8}{3} + \\frac{2}{12} = -\\frac{16}{6} + \\frac{1}{6} = -\\frac{15}{6} = -\\frac{5}{2}\n$$\n该有限差分近似为：\n$$\nL_h u_i = \\frac{1}{12h^2} \\left[ -u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2} \\right]\n$$\n\n截断误差 $\\tau$ 定义为 $\\tau = L_h u_i - u''(x_i)$。截断误差的主项对应于展开式中 $u''(x_i)$ 项之后的第一个非零项。对于 $n=3$、$n=4$ 和 $n=5$（根据对称性）的项均为零。主误差项来自 $n=6$。\n$$\n\\tau = \\left[ \\frac{h^{6-2}}{6!} \\sum_{k=-2}^{2} c_k k^6 \\right] u^{(6)}(x_i) + O(h^6)\n$$\n因此，乘以 $h^4 u^{(6)}(x_i)$ 的系数是：\n$$\nK = \\frac{1}{6!} \\sum_{k=-2}^{2} c_k k^6 = \\frac{1}{720} \\left[ c_{-2}(-2)^6 + c_{-1}(-1)^6 + c_1(1)^6 + c_2(2)^6 \\right]\n$$\n使用 $c_{-k}=c_k$：\n$$\nK = \\frac{1}{720} \\left[ 2c_1 (1)^6 + 2c_2 (2)^6 \\right] = \\frac{2c_1 + 128c_2}{720} = \\frac{c_1 + 64c_2}{360}\n$$\n代入推导出的 $c_1$ 和 $c_2$ 的值：\n$$\nc_1 = \\frac{4}{3} \\quad \\text{and} \\quad c_2 = -\\frac{1}{12}\n$$\n$$\nK = \\frac{\\frac{4}{3} + 64\\left(-\\frac{1}{12}\\right)}{360} = \\frac{\\frac{4}{3} - \\frac{64}{12}}{360} = \\frac{\\frac{4}{3} - \\frac{16}{3}}{360}\n$$\n$$\nK = \\frac{-\\frac{12}{3}}{360} = \\frac{-4}{360} = -\\frac{1}{90}\n$$\n因此，截断误差级数中乘以 $h^4 u^{(6)}(x_i)$ 项的系数是 $-\\frac{1}{90}$。",
            "answer": "$$ \\boxed{-\\frac{1}{90}} $$"
        },
        {
            "introduction": "仅仅知道误差的“阶数”是不够的，理解其物理表现同样重要。本练习利用傅里叶分析和修正波数的概念，将一个迎风格式的截断误差分解为数值耗散（影响波幅）和数值色散（影响相速）。这种分析方法能让您更深入地洞察数值格式在模拟波动现象时的具体行为。",
            "id": "3982496",
            "problem": "考虑均匀流中被动标量的一维线性平流，其控制方程为偏微分方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a > 0$ 为常数。在计算流体动力学 (CFD) 的半离散线方法 (MOL) 公式中，在间距为 $h$ 的均匀网格上，使用三阶迎风偏置后向差分算子（适用于 $a>0$）来近似空间导数：\n$$\n\\left(D u\\right)_{i} \\equiv \\frac{1}{h}\\left(\\frac{11}{6}\\,u_{i} - 3\\,u_{i-1} + \\frac{3}{2}\\,u_{i-2} - \\frac{1}{3}\\,u_{i-3}\\right).\n$$\n通过代入模 $u_{j} = \\exp\\!\\left(i k x_{j}\\right)$（其中 $x_{j} = j h$，$k$ 是物理波数）进行傅里叶（冯·诺依曼）分析，使得离散导数表示为 $D u_{j} = \\left(i\\,\\tilde{k}\\right) u_{j}$，这定义了修正波数 $\\tilde{k} = \\tilde{k}(k,h)$。利用在 $\\theta \\equiv k h$ 中的小参数展开，从 $\\tilde{k}$ 确定主阶数值耗散和数值色散。对于本问题，定义：\n- 数值耗散系数 $C_{d}$ 为修正波数虚部在小 $\\theta$ 展开中的主阶常数（与 $h$ 无关），\n$$\n\\mathrm{Im}\\!\\left(\\tilde{k}\\right) = C_{d}\\,k^{4} h^{3} + \\mathcal{O}\\!\\left(k^{6} h^{5}\\right).\n$$\n- 数值色散系数 $C_{p}$ 为修正波数实部与真实波数之差在小 $\\theta$ 展开中的主阶常数，\n$$\n\\mathrm{Re}\\!\\left(\\tilde{k}\\right) - k = C_{p}\\,k^{5} h^{4} + \\mathcal{O}\\!\\left(k^{7} h^{6}\\right).\n$$\n从上述离散算子和 $\\tilde{k}$ 的定义出发，推导这些系数，不要引用任何预先制表的离散符号。将您的最终答案表示为由精确分数组成的行矩阵 $\\begin{pmatrix}C_{d}  C_{p}\\end{pmatrix}$。无需四舍五入。在您的推导过程中，也请说明每种效应如何随 $h$ 缩放。",
            "solution": "该问题要求对于给定的空间一阶导数的三阶有限差分近似，确定其主阶数值耗散和色散系数，分别表示为 $C_d$ 和 $C_p$。分析是使用修正波数 $\\tilde{k}$ 的概念进行的。\n\n控制偏微分方程是一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $a > 0$ 是一个恒定的平流速度。在网格点 $x_i$ 处的空间导数 $u_x$ 由离散算子 $(D u)_i$ 近似：\n$$\n\\left(D u\\right)_{i} \\equiv \\frac{1}{h}\\left(\\frac{11}{6}\\,u_{i} - 3\\,u_{i-1} + \\frac{3}{2}\\,u_{i-2} - \\frac{1}{3}\\,u_{i-3}\\right)\n$$\n其中 $h$ 是均匀网格间距。\n\n为了进行傅里叶分析，我们考虑该算子对单个傅里叶模 $u_j = \\exp(i k x_j)$ 的作用，其中 $x_j=jh$，$k$ 是物理波数。修正波数 $\\tilde{k}$ 由以下关系定义：\n$$\nD u_{j} = \\left(i\\,\\tilde{k}\\right) u_{j}\n$$\n精确微分算子 $\\frac{\\partial}{\\partial x}$ 作用于此模，得到 $\\frac{\\partial}{\\partial x} \\exp(ikx) = (ik)\\exp(ikx)$。因此，$\\tilde{k}$ 可作为离散系统中波数 $k$ 的表示。$\\tilde{k}$ 与 $k$ 的任何偏差都表示数值误差。\n\n我们首先将傅里叶模代入离散算子。注意，对于任何整数 $m$，有 $u_{j-m} = \\exp(ik(j-m)h) = \\exp(ikjh) \\exp(-ikmh) = u_j \\exp(-imkh)$。令 $\\theta \\equiv kh$ 为无量纲波数。则 $u_{j-m} = u_j \\exp(-im\\theta)$。\n将算子 $D$ 应用于 $u_j$：\n$$\n\\begin{aligned}\nD u_{j} = \\frac{1}{h}\\left(\\frac{11}{6}\\,u_{j} - 3\\,u_{j-1} + \\frac{3}{2}\\,u_{j-2} - \\frac{1}{3}\\,u_{j-3}\\right) \\\\\n= \\frac{1}{h}\\left(\\frac{11}{6}\\,u_{j} - 3\\,u_{j}\\exp(-i\\theta) + \\frac{3}{2}\\,u_{j}\\exp(-i2\\theta) - \\frac{1}{3}\\,u_{j}\\exp(-i3\\theta)\\right) \\\\\n= \\frac{u_{j}}{h}\\left(\\frac{11}{6} - 3\\exp(-i\\theta) + \\frac{3}{2}\\exp(-i2\\theta) - \\frac{1}{3}\\exp(-i3\\theta)\\right)\n\\end{aligned}\n$$\n根据修正波数的定义，我们将其等同于 $(i\\,\\tilde{k}) u_{j}$：\n$$\n(i\\,\\tilde{k}) u_{j} = \\frac{u_{j}}{h}\\left(\\frac{11}{6} - 3\\exp(-i\\theta) + \\frac{3}{2}\\exp(-i2theta) - \\frac{1}{3}\\exp(-i3\\theta)\\right)\n$$\n求解 $\\tilde{k}$ 得：\n$$\n\\tilde{k} = \\frac{1}{ih}\\left(\\frac{11}{6} - 3\\exp(-i\\theta) + \\frac{3}{2}\\exp(-i2\\theta) - \\frac{1}{3}\\exp(-i3\\theta)\\right)\n$$\n这是修正波数的精确表达式。为了在固定网格间距 $h$ 下分析长波（小 $k$）的数值误差，我们对该表达式在小 $\\theta \\ll 1$ 时进行泰勒级数展开。我们使用指数函数的展开式 $\\exp(z) = \\sum_{n=0}^{\\infty} \\frac{z^n}{n!}$。我们需要展开到 $\\theta^5$ 项以捕捉主阶色散。\n$$\n\\exp(-im\\theta) = 1 - (im\\theta) - \\frac{(m\\theta)^2}{2} + i\\frac{(m\\theta)^3}{6} + \\frac{(m\\theta)^4}{24} - i\\frac{(m\\theta)^5}{120} + \\mathcal{O}(\\theta^6)\n$$\n令括号中的项为 $Z(\\theta) = \\frac{11}{6} - 3\\exp(-i\\theta) + \\frac{3}{2}\\exp(-i2\\theta) - \\frac{1}{3}\\exp(-i3\\theta)$。我们通过收集 $\\theta$ 的各次幂的系数来展开 $Z(\\theta)$。\n令 $Z(\\theta) = \\sum_{n=0}^{\\infty} A_n \\theta^n$。\n$A_0 = \\frac{11}{6} - 3 + \\frac{3}{2} - \\frac{1}{3} = \\frac{11 - 18 + 9 - 2}{6} = 0$。\n$A_1 \\theta = -3(-i\\theta) + \\frac{3}{2}(-i2\\theta) - \\frac{1}{3}(-i3\\theta) = (3i - 3i + i)\\theta = i\\theta$。\n$A_2 \\theta^2 = \\frac{1}{2!}(-3(-i\\theta)^2 + \\frac{3}{2}(-2i\\theta)^2 - \\frac{1}{3}(-3i\\theta)^2) = \\frac{-\\theta^2}{2}(3 - 6 + 3) = 0$。\n$A_3 \\theta^3 = \\frac{1}{3!}(-3(-i\\theta)^3 + \\frac{3}{2}(-2i\\theta)^3 - \\frac{1}{3}(-3i\\theta)^3) = \\frac{i\\theta^3}{6}(3 - 12 + 9) = 0$。\n$A_4 \\theta^4 = \\frac{1}{4!}(-3(-i\\theta)^4 + \\frac{3}{2}(-2i\\theta)^4 - \\frac{1}{3}(-3i\\theta)^4) = \\frac{\\theta^4}{24}(-3 + 24 - 27) = -\\frac{6\\theta^4}{24} = -\\frac{1}{4}\\theta^4$。\n$A_5 \\theta^5 = \\frac{1}{5!}(-3(-i\\theta)^5 + \\frac{3}{2}(-2i\\theta)^5 - \\frac{1}{3}(-3i\\theta)^5) = \\frac{-i\\theta^5}{120}(-3 + 48 - 81) = \\frac{36i\\theta^5}{120} = i\\frac{3}{10}\\theta^5$。\n因此，$Z(\\theta)$ 的展开式为：\n$$\nZ(\\theta) = i\\theta - \\frac{1}{4}\\theta^4 + i\\frac{3}{10}\\theta^5 + \\mathcal{O}(\\theta^6)\n$$\n现在我们将此代回 $\\tilde{k}$ 的表达式中：\n$$\n\\tilde{k} = \\frac{Z(\\theta)}{ih} = \\frac{1}{ih}\\left(i\\theta - \\frac{1}{4}\\theta^4 + i\\frac{3}{10}\\theta^5 + \\mathcal{O}(\\theta^7)\\right)\n$$\n注意，$Z(\\theta)$ 展开式中的下一个非零项是 $\\theta^7$ 阶，这与问题中对色散所陈述的阶数表示相符。\n$$\n\\tilde{k} = \\frac{\\theta}{h} + \\frac{i}{h}\\frac{\\theta^4}{4} - \\frac{1}{h}\\frac{3\\theta^5}{10} + \\mathcal{O}\\left(\\frac{\\theta^7}{h}\\right)\n$$\n代入 $\\theta=kh$：\n$$\n\\tilde{k} = \\frac{kh}{h} + i\\frac{(kh)^4}{4h} - \\frac{3(kh)^5}{10h} + \\mathcal{O}(k^7h^6) = k + i\\frac{1}{4}k^4h^3 - \\frac{3}{10}k^5h^4 + \\mathcal{O}(k^7h^6)\n$$\n我们现在分离 $\\tilde{k}$ 的实部和虚部。\n$\\tilde{k}$ 的虚部表示数值耗散（如果为正）或放大（如果为负）。\n$$\n\\mathrm{Im}(\\tilde{k}) = \\frac{1}{4}k^4h^3 + \\mathcal{O}(k^6h^5)\n$$\n由于系数为正，这对应于数值耗散。与给定形式 $\\mathrm{Im}(\\tilde{k}) = C_{d}\\,k^{4} h^{3} + \\mathcal{O}(k^{6} h^{5})$ 进行比较，我们确定数值耗散系数为：\n$$\nC_d = \\frac{1}{4}\n$$\n主阶耗散误差随网格间距 $h$ 按 $h^3$ 比例缩放。\n\n$\\tilde{k}$ 的实部与波传播速度有关。与真实波数 $k$ 的偏差 $\\mathrm{Re}(\\tilde{k}) - k$ 表示数值色散。\n$$\n\\mathrm{Re}(\\tilde{k}) = k - \\frac{3}{10}k^5h^4 + \\mathcal{O}(k^7h^6)\n$$\n因此，色散误差为：\n$$\n\\mathrm{Re}(\\tilde{k}) - k = -\\frac{3}{10}k^5h^4 + \\mathcal{O}(k^7h^6)\n$$\n与给定形式 $\\mathrm{Re}(\\tilde{k}) - k = C_{p}\\,k^{5} h^{4} + \\mathcal{O}(k^{7} h^{6})$ 进行比较，我们确定数值色散系数为：\n$$\nC_p = -\\frac{3}{10}\n$$\n主阶色散误差随网格间距 $h$ 按 $h^4$ 比例缩放。负号表示对于长波，数值相速度小于真实相速度。\n\n所求系数为 $C_d = \\frac{1}{4}$ 和 $C_p = -\\frac{3}{10}$。\n最终答案需表示为行矩阵。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{4}  -\\frac{3}{10} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在计算流体力学中，误差不仅来源于解的导数的近似，也可能源于对几何本身的近似处理。本练习通过一个计算实验，清晰地展示了当几何度量项（如网格单元的面积或体积）的离散精度低于求解格式的精度时，将如何导致整体精度的下降 。这一实践旨在揭示并验证几何守恒律（Geometric Conservation Law, GCL）的重要性，这是在曲线坐标系下进行高精度模拟时必须遵守的关键原则。",
            "id": "3982485",
            "problem": "在计算流体力学（CFD）的背景下，考虑一个定义在柱面上的标量场。设该物理表面由角坐标 $\\theta$ 和轴向坐标 $z$ 参数化。该圆柱体具有名义半径 $R_0$，并受到一个光滑正弦变化的扰动。物理映射 $\\mathbf{x}(\\theta,z)$ 由下式给出\n$$\nx(\\theta) = r(\\theta)\\cos\\theta,\\quad y(\\theta) = r(\\theta)\\sin\\theta,\\quad z = z,\n$$\n其中\n$$\nr(\\theta) = R_0 + \\varepsilon \\sin\\theta,\n$$\n其中 $\\theta$ 以弧度为单位。表面上的诱导度量具有以下分量\n$$\ng_{\\theta\\theta} = r(\\theta)^2 + \\left(\\frac{dr}{d\\theta}\\right)^2,\\quad g_{zz} = 1,\\quad g_{\\theta z} = 0,\n$$\n且行列式 $g$ 满足 $\\sqrt{g} = \\sqrt{g_{\\theta\\theta}}$。作用于标量场 $u(\\theta,z)$ 的曲面拉普拉斯-贝尔特拉米算子（即内蕴曲面拉普拉斯算子）为\n$$\n\\Delta_s u = \\frac{1}{\\sqrt{g}} \\frac{\\partial}{\\partial \\theta}\\left(\\sqrt{g}\\, g^{\\theta\\theta}\\, \\frac{\\partial u}{\\partial \\theta}\\right) + \\frac{1}{\\sqrt{g}} \\frac{\\partial}{\\partial z}\\left(\\sqrt{g}\\, g^{zz}\\, \\frac{\\partial u}{\\partial z}\\right),\n$$\n其中 $g^{\\theta\\theta} = \\left(g_{\\theta\\theta}\\right)^{-1}$ 且 $g^{zz} = 1$。由于 $\\sqrt{g}$ 不依赖于 $z$，上式可简化为\n$$\n\\Delta_s u = \\frac{1}{\\sqrt{g}} \\frac{\\partial}{\\partial \\theta}\\left(\\sqrt{g}\\, g^{\\theta\\theta}\\, \\frac{\\partial u}{\\partial \\theta}\\right) + \\frac{\\partial^2 u}{\\partial z^2}.\n$$\n定义人造（解析）解\n$$\nu(\\theta,z) = \\sin(3\\theta)\\,\\cos\\left(\\frac{2\\pi}{L} z\\right),\n$$\n其中 $L$ 是轴向周期。使用以上定义，并记 $G(\\theta) = r(\\theta)^2 + \\left(\\frac{dr}{d\\theta}\\right)^2$ 和 $B(\\theta) = \\frac{1}{\\sqrt{G(\\theta)}}$，我们可以将该算子等价地重写为\n$$\n\\Delta_s u = B(\\theta)\\left( \\frac{d B}{d\\theta} \\frac{\\partial u}{\\partial \\theta} + B(\\theta) \\frac{\\partial^2 u}{\\partial \\theta^2} \\right) + \\frac{\\partial^2 u}{\\partial z^2}.\n$$\n对于所选的 $r(\\theta)$，其精确导数为 $r'(\\theta) = \\varepsilon \\cos\\theta$ 以及\n$$\nG(\\theta) = R_0^2 + \\varepsilon^2 + 2 R_0 \\varepsilon \\sin\\theta,\\quad B(\\theta) = \\left(R_0^2 + \\varepsilon^2 + 2 R_0 \\varepsilon \\sin\\theta\\right)^{-1/2},\n$$\n$$\n\\frac{dB}{d\\theta} = - \\frac{R_0 \\varepsilon \\cos\\theta}{\\left(R_0^2 + \\varepsilon^2 + 2 R_0 \\varepsilon \\sin\\theta\\right)^{3/2}}.\n$$\n\n您的任务是在 $\\theta$ 和 $z$ 方向均为均匀周期性的网格上，实现 $\\Delta_s u$ 的两种离散近似：\n\n1. 一种“精确度量”离散化方法，它对 $B(\\theta)$ 和 $\\frac{dB}{d\\theta}$ 使用解析表达式，并对 $\\frac{\\partial u}{\\partial \\theta}$、$\\frac{\\partial^2 u}{\\partial \\theta^2}$ 和 $\\frac{\\partial^2 u}{\\partial z^2}$ 使用二阶中心有限差分。\n\n2. 一种“朴素度量”离散化方法，它纯粹通过离散化几何，并使用一阶向前差分来计算几何度量，具体而言\n   - 通过向前差分近似 $r'(\\theta)$：$r'(\\theta_i) \\approx \\frac{r(\\theta_{i+1}) - r(\\theta_i)}{\\Delta\\theta}$，\n   - 构造 $G(\\theta_i) = r(\\theta_i)^2 + \\left(r'(\\theta_i)\\right)^2$ 和 $B(\\theta_i) = \\frac{1}{\\sqrt{G(\\theta_i)}}$，\n   - 通过向前差分近似 $\\frac{dB}{d\\theta}$：$\\frac{dB}{d\\theta}(\\theta_i) \\approx \\frac{B(\\theta_{i+1}) - B(\\theta_i)}{\\Delta\\theta}$，\n   同时仍然对 $u$ 的导数使用二阶中心有限差分。\n\n对于每种离散化方法，在网格上计算离散算子 $\\Delta_{s,h} u$ 的值，并使用 $u$ 的解析表达式和导数计算 $\\Delta_s u(\\theta_i,z_j)$ 的逐点精确值。然后计算离散均方根（RMS）误差\n$$\nE_h = \\left( \\frac{1}{N_\\theta N_z} \\sum_{i=0}^{N_\\theta - 1} \\sum_{j=0}^{N_z - 1} \\left[ \\Delta_{s,h} u(\\theta_i,z_j) - \\Delta_s u(\\theta_i,z_j) \\right]^2 \\right)^{1/2}.\n$$\n\n为测量观测收敛率，请使用三个逐次加密的网格，并对 $\\log E_h$ 与 $\\log h$ 进行线性回归，其中 $h = \\Delta\\theta = \\frac{2\\pi}{N_\\theta}$ 是角向网格间距。此拟合的斜率即为观测阶数 $p$。\n\n请实现一个程序，对以下四个测试用例执行此过程（所有角度均以弧度为单位，所有长度均使用相同的任意单位）：\n\n- 用例 A（理想情况）：$R_0 = 1.0$, $\\varepsilon = 0.1$, $L = 1.0$，网格为 $(N_\\theta,N_z) = (32,32)$, $(64,64)$, $(128,128)$。\n- 用例 B（强扰动）：$R_0 = 1.0$, $\\varepsilon = 0.5$, $L = 1.0$，网格为 $(N_\\theta,N_z) = (32,32)$, $(64,64)$, $(128,128)$。\n- 用例 C（无扰动情况）：$R_0 = 1.0$, $\\varepsilon = 0.0$, $L = 1.0$，网格为 $(N_\\theta,N_z) = (32,32)$, $(64,64)$, $(128,128)$。\n- 用例 D（不同轴向周期）：$R_0 = 2.0$, $\\varepsilon = 0.2$, $L = 3.0$，网格为 $(N_\\theta,N_z) = (32,32)$, $(64,64)$, $(128,128)$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，其中包含观测到的收敛率，顺序如下\n$$\n[\\;p_{\\text{naive},A},\\;p_{\\text{exact},A},\\;p_{\\text{naive},B},\\;p_{\\text{exact},B},\\;p_{\\text{naive},C},\\;p_{\\text{exact},C},\\;p_{\\text{naive},D},\\;p_{\\text{exact},D}\\;].\n$$\n每个 $p$ 都必须是浮点数。不应产生任何其他输出。",
            "solution": "用户希望分析在扰动柱面上，拉普拉斯-贝尔特拉米算子的两种不同数值离散化方法的精度阶。\n\n### 步骤 1：问题验证\n\n对该问题进行严格的验证过程。\n\n- **提取已知条件**：所有提供的信息，包括柱面参数化 $r(\\theta) = R_0 + \\varepsilon \\sin\\theta$、度量张量分量（$g_{\\theta\\theta}$、$g_{zz}$）、拉普拉斯-贝尔特拉米算子的简化形式 $\\Delta_s u = B(\\theta)( \\frac{d B}{d\\theta} \\frac{\\partial u}{\\partial \\theta} + B(\\theta) \\frac{\\partial^2 u}{\\partial \\theta^2} ) + \\frac{\\partial^2 u}{\\partial z^2}$、人造解 $u(\\theta,z) = \\sin(3\\theta)\\cos(\\frac{2\\pi}{L} z)$、两种离散化方案（“精确度量”和“朴素度量”）的定义、误差度量（RMS 误差）、确定收敛率的方法（对数-对数线性回归）以及具体的测试用例（参数和网格尺寸），均已记录在案。所提供的 $G(\\theta)$、$B(\\theta)$ 和 $\\frac{dB}{d\\theta}$ 的所有解析表达式都经过验证并且是正确的。\n\n- **验证检查**：\n    1.  **科学基础**：该问题在根本上是可靠的，其基础是微分几何（度量张量、拉普拉斯-贝尔特拉米算子）和数值分析（人造解方法、有限差分法、收敛性研究）的既定原理。这是计算物理和工程领域中一个标准的验证与确认（V&V）实践。\n    2.  **适定性**：该任务是适定的。它要求根据一组给定的输入和明确的方法，计算一个特定且定义明确的数值量（观测精度阶）。收敛率存在唯一且稳定的解。\n    3.  **客观性**：该问题使用精确、无歧义的数学术语进行规定。没有主观内容。\n    4.  **完整性与一致性**：所有必需的公式、参数和边界条件（周期性）均已提供。该问题是自洽的。检查度量项 $B(\\theta)$ 中的分母，即 $G(\\theta) = (R_0 - \\varepsilon)^2 + 2R_0\\varepsilon(1+\\sin\\theta)$，证实对于所有 $\\varepsilon>0$ 的测试用例，由于始终满足 $R_0 > \\varepsilon$，该分母严格为正。对于 $\\varepsilon=0$，它也为正。因此，不会发生除以零的情况。\n    5.  **可行性**：所需的计算在数值上是可行的，并且完全在标准科学计算库的能力范围之内。参数在物理上是合理的。\n\n- **结论**：该问题被评估为**有效**。这是一个形式良好、科学可靠的数值分析问题，应用于与CFD相关的背景中。\n\n### 步骤 2：解的推导与算法设计\n\n问题的核心是计算两种方案的观测收敛阶 $p$。这通过在三个网格序列上计算 RMS 误差 $E_h$，并求出 $\\log E_h$ 相对于 $\\log h$ 的斜率来实现，其中 $h = \\Delta\\theta$。\n\n**A. 解析参考解**\n将精确的拉普拉斯-贝尔特拉米算子应用于人造解 $u(\\theta,z)$，其结果是误差计算所需的基准。给定 $u(\\theta,z) = \\sin(3\\theta)\\cos(kz)$，其中 $k = 2\\pi/L$，其偏导数为：\n$$\n\\frac{\\partial u}{\\partial \\theta} = 3\\cos(3\\theta)\\cos(kz), \\quad \\frac{\\partial^2 u}{\\partial \\theta^2} = -9\\sin(3\\theta)\\cos(kz), \\quad \\frac{\\partial^2 u}{\\partial z^2} = -k^2\\sin(3\\theta)\\cos(kz).\n$$\n将这些导数代入算子 $\\Delta_s u = B(\\theta)\\left( \\frac{dB}{d\\theta} \\frac{\\partial u}{\\partial \\theta} + B(\\theta) \\frac{\\partial^2 u}{\\partial \\theta^2} \\right) + \\frac{\\partial^2 u}{\\partial z^2}$ 的给定形式，得到在任意点 $(\\theta, z)$ 的精确值：\n$$\n\\Delta_s u(\\theta,z) = \\left[ B(\\theta)\\left( \\frac{dB}{d\\theta} (3\\cos(3\\theta)) - 9B(\\theta)\\sin(3\\theta) \\right) - k^2\\sin(3\\theta) \\right] \\cos(kz).\n$$\n项 $B(\\theta)$ 和 $\\frac{dB}{d\\theta}$ 使用问题描述中的解析公式计算。该表达式将在网格上求值，作为误差计算的精确解。\n\n**B. 数值离散化**\n一个均匀周期性网格由 $\\theta_i = i \\Delta\\theta$ 和 $z_j = j \\Delta z$ 定义，其中 $\\Delta\\theta = 2\\pi/N_\\theta$ 且 $\\Delta z = L/N_z$。在此网格上，任何函数 $f(\\theta_i, z_j)$ 表示为一个二维数组 $f_{i,j}$。\n\n对 $u$ 的导数，考虑周期性后所需的二阶中心有限差分近似为：\n$$\n\\left(\\frac{\\partial u}{\\partial \\theta}\\right)_{i,j} \\approx \\frac{u_{i+1,j} - u_{i-1,j}}{2\\Delta\\theta}\n$$\n$$\n\\left(\\frac{\\partial^2 u}{\\partial \\theta^2}\\right)_{i,j} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\\Delta\\theta)^2}\n$$\n$$\n\\left(\\frac{\\partial^2 u}{\\partial z^2}\\right)_{i,j} \\approx \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{(\\Delta z)^2}\n$$\n这些将使用 `numpy.roll` 高效实现，以处理周期性边界条件。\n\n**C. 方案实现**\n\n1.  **精确度量方案**：此方案将 $u$ 的数值计算导数与解析计算的度量系数相结合。\n    -   度量项 $B(\\theta_i)$ 和 $\\frac{dB}{d\\theta}(\\theta_i)$ 使用精确公式为网格上的每个 $\\theta_i$ 计算。\n    -   离散算子组装如下：\n        $\\Delta_{s,h} u = B_{\\text{exact}} \\left( \\frac{dB}{d\\theta}_{\\text{exact}} \\left(\\frac{\\partial u}{\\partial \\theta}\\right)_h + B_{\\text{exact}} \\left(\\frac{\\partial^2 u}{\\partial \\theta^2}\\right)_h \\right) + \\left(\\frac{\\partial^2 u}{\\partial z^2}\\right)_h$。\n    -   截断误差主要由 $u$ 的有限差分带来的 $O(h^2)$ 误差决定。因此，我们预期收敛率 $p \\approx 2$。\n\n2.  **朴素度量方案**：此方案对度量项使用低阶数值近似。\n    -   在每个点 $\\theta_i$，$r'_i$ 通过一阶向前差分近似：$r'_i \\approx (r_{i+1} - r_i)/\\Delta\\theta$。\n    -   这用于计算“朴素”的 $G_i = r_i^2 + (r'_i)^2$ 和 $B_i = 1/\\sqrt{G_i}$。\n    -   然后，$\\frac{dB}{d\\theta}$ 也通过一阶向前差分近似：$(\\frac{dB}{d\\theta})_i \\approx (B_{i+1} - B_i)/\\Delta\\theta$。\n    -   离散算子以类似方式组装，但使用这些朴素的度量项 $B_{\\text{naive}}$ 和 $(\\frac{dB}{d\\theta})_{\\text{naive}}$。\n    -   总体精度将受到度量计算中引入的一阶 $O(h)$ 误差的限制。因此，我们预期收敛率 $p \\approx 1$。\n    -   一个例外是用例 C（$\\varepsilon=0$），此时几何形状为理想圆柱体。对于常数半径 $r(\\theta)=R_0$，$r'$ 和 $dB/d\\theta$ 的一阶向前差分计算结果都恰好为零，这与解析值相符。在这种特殊情况下，朴素度量方案与精确度量方案变得完全相同，两者预期都将以二阶（$p \\approx 2$）收敛。\n\n**D. 收敛率计算**\n对于每个测试用例和每个方案，流程如下：\n1.  对三种网格分辨率计算 RMS 误差 $E_h = \\sqrt{\\frac{1}{N_\\theta N_z}\\sum_{i,j} (\\Delta_{s,h}u_{i,j} - \\Delta_s u(\\theta_i,z_j))^2}$，得到 $(E_{h_1}, E_{h_2}, E_{h_3})$。\n2.  相应的网格间距为 $h_k = 2\\pi/N_{\\theta,k}$。\n3.  对点集 $(\\log(h_k), \\log(E_{h_k}))$ 进行线性回归。该直线的斜率即为观测精度阶 $p$。此步骤使用 `scipy.stats.linregress` 函数。\n\n最终程序将对所有四个测试用例系统地执行整个过程，并以指定格式输出八个得到的收敛率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Computes the observed convergence rates for two discretizations\n    of the Laplace-Beltrami operator on a perturbed cylinder.\n    \"\"\"\n    test_cases = [\n        # (R0, epsilon, L)\n        (1.0, 0.1, 1.0),  # Case A\n        (1.0, 0.5, 1.0),  # Case B\n        (1.0, 0.0, 1.0),  # Case C\n        (2.0, 0.2, 3.0),  # Case D\n    ]\n    grid_resolutions = [(32, 32), (64, 64), (128, 128)]\n    \n    all_convergence_rates = []\n\n    for R0, eps, L in test_cases:\n        errors_naive = []\n        errors_exact = []\n        h_values = []\n\n        for N_theta, N_z in grid_resolutions:\n            # 1. Grid setup\n            d_theta = 2.0 * np.pi / N_theta\n            d_z = L / N_z\n            h_values.append(d_theta)\n\n            theta_1d = np.linspace(0.0, 2.0 * np.pi, N_theta, endpoint=False)\n            z_1d = np.linspace(0.0, L, N_z, endpoint=False)\n            THETA, Z = np.meshgrid(theta_1d, z_1d, indexing='ij')\n\n            k = 2.0 * np.pi / L\n\n            # 2. Manufactured solution and its analytical derivatives\n            u = np.sin(3.0 * THETA) * np.cos(k * Z)\n            u_theta = 3.0 * np.cos(3.0 * THETA) * np.cos(k * Z)\n            u_thetatheta = -9.0 * np.sin(3.0 * THETA) * np.cos(k * Z)\n            u_zz = -(k**2) * u\n\n            # 3. Analytical Laplace-Beltrami operator evaluation\n            G_analytic = R0**2 + eps**2 + 2.0 * R0 * eps * np.sin(THETA)\n            B_analytic = G_analytic**(-0.5)\n            dBdtheta_analytic = -R0 * eps * np.cos(THETA) * G_analytic**(-1.5)\n            \n            lap_u_analytic = B_analytic * (dBdtheta_analytic * u_theta + B_analytic * u_thetatheta) + u_zz\n\n            # 4. Numerical derivatives of u (2nd-order centered differences)\n            u_ip1 = np.roll(u, -1, axis=0) # i+1\n            u_im1 = np.roll(u, 1, axis=0)  # i-1\n            u_jp1 = np.roll(u, -1, axis=1) # j+1\n            u_jm1 = np.roll(u, 1, axis=1)  # j-1\n            \n            du_dtheta_h = (u_ip1 - u_im1) / (2.0 * d_theta)\n            d2u_dtheta2_h = (u_ip1 - 2.0 * u + u_im1) / (d_theta**2)\n            d2u_dz2_h = (u_jp1 - 2.0 * u + u_jm1) / (d_z**2)\n            \n            # --- Scheme 1: \"Exact-Metric\" Discretization ---\n            G_exact_1d = R0**2 + eps**2 + 2.0 * R0 * eps * np.sin(theta_1d)\n            B_exact_1d = G_exact_1d**(-0.5)\n            dBdtheta_exact_1d = -R0 * eps * np.cos(theta_1d) * G_exact_1d**(-1.5)\n            \n            # Broadcast metric terms to 2D grid shape\n            B_exact = B_exact_1d[:, np.newaxis]\n            dBdtheta_exact = dBdtheta_exact_1d[:, np.newaxis]\n            \n            lap_u_h_exact = B_exact * (dBdtheta_exact * du_dtheta_h + B_exact * d2u_dtheta2_h) + d2u_dz2_h\n            \n            error_exact = np.sqrt(np.mean((lap_u_h_exact - lap_u_analytic)**2))\n            errors_exact.append(error_exact)\n\n            # --- Scheme 2: \"Naive-Metric\" Discretization ---\n            r_vals = R0 + eps * np.sin(theta_1d)\n            # 1st-order forward difference for r'\n            rp_naive = (np.roll(r_vals, -1) - r_vals) / d_theta\n            \n            G_naive_1d = r_vals**2 + rp_naive**2\n            B_naive_1d = G_naive_1d**(-0.5)\n            # 1st-order forward difference for B'\n            dBdtheta_naive_1d = (np.roll(B_naive_1d, -1) - B_naive_1d) / d_theta\n            \n            # Broadcast metric terms to 2D grid shape\n            B_naive = B_naive_1d[:, np.newaxis]\n            dBdtheta_naive = dBdtheta_naive_1d[:, np.newaxis]\n\n            lap_u_h_naive = B_naive * (dBdtheta_naive * du_dtheta_h + B_naive * d2u_dtheta2_h) + d2u_dz2_h\n\n            error_naive = np.sqrt(np.mean((lap_u_h_naive - lap_u_analytic)**2))\n            errors_naive.append(error_naive)\n\n        # 5. Convergence analysis via log-log linear regression\n        log_h = np.log(h_values)\n        \n        # Naive scheme rate\n        log_err_naive = np.log(errors_naive)\n        p_naive = stats.linregress(log_h, log_err_naive).slope\n        \n        # Exact scheme rate\n        log_err_exact = np.log(errors_exact)\n        p_exact = stats.linregress(log_h, log_err_exact).slope\n        \n        all_convergence_rates.extend([p_naive, p_exact])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{rate:.8f}' for rate in all_convergence_rates)}]\")\n\nsolve()\n```"
        }
    ]
}