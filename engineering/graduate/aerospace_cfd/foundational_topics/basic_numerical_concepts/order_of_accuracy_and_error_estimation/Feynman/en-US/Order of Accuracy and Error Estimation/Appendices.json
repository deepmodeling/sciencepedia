{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of developing numerical methods is the ability to construct a discrete operator that approximates a continuous one to a desired order of accuracy. This practice guides you through the fundamental process of using Taylor series expansions to derive the coefficients of a high-order finite-difference stencil for the Laplacian operator. By systematically cancelling lower-order error terms, you will not only build the scheme but also precisely quantify its leading truncation error, a critical skill for error estimation and scheme analysis .",
            "id": "3982491",
            "problem": "Aerospace Computational Fluid Dynamics (CFD) simulations often require high-fidelity discretizations of viscous diffusion operators to control numerical dissipation and resolve thin boundary layers. Consider a one-dimensional, sufficiently smooth function $u(x)$ describing the streamwise component of velocity along a line in a laminar boundary-layer calculation, defined on a uniform grid with spacing $h$ and nodes $x_i = x_0 + i h$. You are tasked with constructing a fourth-order accurate finite-difference approximation to the one-dimensional Laplacian (second derivative) operator using a symmetric $5$-point stencil centered at $x_i$. \n\nStarting from the Taylor series expansion of $u(x)$ about $x_i$ for the points $x_{i \\pm h}$ and $x_{i \\pm 2 h}$, and enforcing consistency with the continuous second derivative operator at leading order, derive the unique symmetric $5$-point stencil that yields a fourth-order accurate approximation to $u''(x_i)$. Then, using the same Taylor expansion framework, derive the truncation error and explicitly determine the coefficient multiplying the term $h^4 u^{(6)}(x_i)$ in the truncation error series of your discrete Laplacian.\n\nYour final reported quantity must be the single real-valued coefficient that multiplies $h^4 u^{(6)}(x_i)$ in the truncation error. Express the coefficient as an exact rational number. No rounding is required. Do not include units.",
            "solution": "The problem requires the derivation of a fourth-order accurate, symmetric, $5$-point finite-difference approximation for the second derivative $u''(x_i)$, and the subsequent determination of the coefficient of the leading term in its truncation error.\n\nLet the uniform grid spacing be $h$. The approximation for the second derivative at the node $x_i$, which we denote as $L_h u_i$, is a linear combination of function values at five symmetric points: $x_{i-2}$, $x_{i-1}$, $x_i$, $x_{i+1}$, and $x_{i+2}$. We can write this approximation as:\n$$\nL_h u_i = \\frac{1}{h^2} \\left[ c_{-2} u(x_{i-2}) + c_{-1} u(x_{i-1}) + c_0 u(x_i) + c_1 u(x_{i+1}) + c_2 u(x_{i+2}) \\right]\n$$\nFor a symmetric stencil, the coefficients must satisfy $c_{-k} = c_k$. Thus, we have $c_{-1} = c_1$ and $c_{-2} = c_2$.\n\nTo determine the coefficients $c_0$, $c_1$, and $c_2$, we use Taylor series expansions of $u(x)$ around the point $x_i$. For a sufficiently smooth function $u(x)$, we have:\n$$\nu(x_{i+k}) = u(x_i + kh) = \\sum_{n=0}^{\\infty} \\frac{(kh)^n}{n!} u^{(n)}(x_i)\n$$\nwhere $u^{(n)}(x_i)$ is the $n$-th derivative of $u$ at $x_i$.\n\nSubstituting these expansions into the formula for $L_h u_i$:\n$$\nL_h u_i = \\frac{1}{h^2} \\sum_{k=-2}^{2} c_k \\left( \\sum_{n=0}^{\\infty} \\frac{(kh)^n}{n!} u^{(n)}(x_i) \\right)\n$$\nBy interchanging the order of summation, we get:\n$$\nL_h u_i = \\sum_{n=0}^{\\infty} \\left[ \\frac{h^{n-2}}{n!} \\sum_{k=-2}^{2} c_k k^n \\right] u^{(n)}(x_i)\n$$\nWe want our approximation $L_h u_i$ to be equal to $u''(x_i)$ with an error of order $O(h^4)$. This means we need to match the terms in the expansion to the expression $u''(x_i) + O(h^4)$.\n\nFor $n=0$: The coefficient of $u(x_i)$ must be zero.\n$$\n\\frac{h^{-2}}{0!} \\sum_{k=-2}^{2} c_k k^0 = \\frac{1}{h^2}(c_{-2} + c_{-1} + c_0 + c_1 + c_2) = 0 \\implies c_0 + 2c_1 + 2c_2 = 0\n$$\n\nFor $n=1$: The coefficient of $u'(x_i)$ must be zero.\n$$\n\\frac{h^{-1}}{1!} \\sum_{k=-2}^{2} c_k k^1 = \\frac{1}{h}(c_1 - c_1 + 2c_2 - 2c_2) = 0\n$$\nThis is automatically satisfied due to the symmetry $c_{-k}=c_k$.\n\nFor $n=2$: The coefficient of $u''(x_i)$ must be $1$.\n$$\n\\frac{h^{0}}{2!} \\sum_{k=-2}^{2} c_k k^2 = \\frac{1}{2} (c_1(1)^2 + c_1(-1)^2 + c_2(2)^2 + c_2(-2)^2) = 1 \\implies \\frac{1}{2}(2c_1 + 8c_2) = 1 \\implies c_1 + 4c_2 = 1\n$$\n\nFor $n=3$: The coefficient of $u'''(x_i)$ is automatically zero due to symmetry.\n$$\n\\frac{h^{1}}{3!} \\sum_{k=-2}^{2} c_k k^3 = \\frac{h}{6} (c_1(1)^3 + c_1(-1)^3 + c_2(2)^3 + c_2(-2)^3) = 0\n$$\n\nFor $n=4$: To achieve fourth-order accuracy, the coefficient of the $h^2 u^{(4)}(x_i)$ term must be zero.\n$$\n\\frac{h^{2}}{4!} \\sum_{k=-2}^{2} c_k k^4 = \\frac{h^2}{24} (c_1(1)^4 + c_1(-1)^4 + c_2(2)^4 + c_2(-2)^4) = 0 \\implies \\frac{h^2}{24}(2c_1 + 32c_2) = 0 \\implies c_1 + 16c_2 = 0\n$$\n\nWe now have a system of linear equations for $c_1$ and $c_2$:\n1) $c_1 + 4c_2 = 1$\n2) $c_1 + 16c_2 = 0$\n\nSubtracting equation (1) from (2):\n$$\n(c_1 + 16c_2) - (c_1 + 4c_2) = 0 - 1 \\implies 12c_2 = -1 \\implies c_2 = -\\frac{1}{12}\n$$\nSubstituting $c_2$ back into equation (2):\n$$\nc_1 + 16\\left(-\\frac{1}{12}\\right) = 0 \\implies c_1 - \\frac{16}{12} = 0 \\implies c_1 = \\frac{16}{12} = \\frac{4}{3}\n$$\nFinally, we find $c_0$ from the first condition:\n$$\nc_0 = -2c_1 - 2c_2 = -2\\left(\\frac{4}{3}\\right) - 2\\left(-\\frac{1}{12}\\right) = -\\frac{8}{3} + \\frac{2}{12} = -\\frac{16}{6} + \\frac{1}{6} = -\\frac{15}{6} = -\\frac{5}{2}\n$$\nThe finite-difference approximation is:\n$$\nL_h u_i = \\frac{1}{12h^2} \\left[ -u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2} \\right]\n$$\n\nThe truncation error, $\\tau$, is defined as $\\tau = L_h u_i - u''(x_i)$. The leading term of the truncation error corresponds to the first non-zero term in the expansion after the $u''(x_i)$ term. The terms for $n=3$, $n=4$, and $n=5$ (by symmetry) are zero. The leading error term is from $n=6$.\n$$\n\\tau = \\left[ \\frac{h^{6-2}}{6!} \\sum_{k=-2}^{2} c_k k^6 \\right] u^{(6)}(x_i) + O(h^6)\n$$\nThe coefficient multiplying $h^4 u^{(6)}(x_i)$ is therefore:\n$$\nK = \\frac{1}{6!} \\sum_{k=-2}^{2} c_k k^6 = \\frac{1}{720} \\left[ c_{-2}(-2)^6 + c_{-1}(-1)^6 + c_1(1)^6 + c_2(2)^6 \\right]\n$$\nUsing $c_{-k}=c_k$:\n$$\nK = \\frac{1}{720} \\left[ 2c_1 (1)^6 + 2c_2 (2)^6 \\right] = \\frac{2c_1 + 128c_2}{720} = \\frac{c_1 + 64c_2}{360}\n$$\nSubstituting the derived values for $c_1$ and $c_2$:\n$$\nc_1 = \\frac{4}{3} \\quad \\text{and} \\quad c_2 = -\\frac{1}{12}\n$$\n$$\nK = \\frac{\\frac{4}{3} + 64\\left(-\\frac{1}{12}\\right)}{360} = \\frac{\\frac{4}{3} - \\frac{64}{12}}{360} = \\frac{\\frac{4}{3} - \\frac{16}{3}}{360}\n$$\n$$\nK = \\frac{-\\frac{12}{3}}{360} = \\frac{-4}{360} = -\\frac{1}{90}\n$$\nThus, the coefficient multiplying the term $h^4 u^{(6)}(x_i)$ in the truncation error series is $-\\frac{1}{90}$.",
            "answer": "$$ \\boxed{-\\frac{1}{90}} $$"
        },
        {
            "introduction": "Once a numerical scheme is constructed, we must understand how it will behave in practice, especially when simulating wave propagation phenomena. This exercise introduces the powerful concept of the modified wavenumber, which reveals how a discrete operator distorts the amplitude and phase of different Fourier modes. By analyzing a third-order upwind scheme, you will learn to distinguish and quantify numerical dissipation (amplitude error) and dispersion (phase error), two key sources of error that govern the fidelity of advection-dominated simulations .",
            "id": "3982496",
            "problem": "Consider one-dimensional linear advection of a passive scalar in a uniform flow, governed by the partial differential equation $u_{t} + a\\,u_{x} = 0$, with constant advection speed $a > 0$. In a semi-discrete Method of Lines (MOL) formulation of Computational Fluid Dynamics (CFD), approximate the spatial derivative using the third-order upwind-biased backward difference operator (appropriate for $a>0$) on a uniform grid of spacing $h$:\n$$\n\\left(D u\\right)_{i} \\equiv \\frac{1}{h}\\left(\\frac{11}{6}\\,u_{i} - 3\\,u_{i-1} + \\frac{3}{2}\\,u_{i-2} - \\frac{1}{3}\\,u_{i-3}\\right).\n$$\nPerform a Fourier (von Neumann) analysis by inserting the mode $u_{j} = \\exp\\!\\left(i k x_{j}\\right)$, where $x_{j} = j h$ and $k$ is the physical wavenumber, so that the discrete derivative is represented by $D u_{j} = \\left(i\\,\\tilde{k}\\right) u_{j}$, which defines the modified wavenumber $\\tilde{k} = \\tilde{k}(k,h)$. Using small-parameter expansion in $\\theta \\equiv k h$, determine from $\\tilde{k}$ the leading-order numerical dissipation and dispersion. For this problem, define:\n- The numerical dissipation coefficient $C_{d}$ as the leading constant (independent of $h$) in the small-$\\theta$ expansion of the imaginary part of the modified wavenumber,\n$$\n\\mathrm{Im}\\!\\left(\\tilde{k}\\right) = C_{d}\\,k^{4} h^{3} + \\mathcal{O}\\!\\left(k^{6} h^{5}\\right).\n$$\n- The numerical dispersion coefficient $C_{p}$ as the leading constant in the small-$\\theta$ expansion of the deviation of the real part of the modified wavenumber from the true wavenumber,\n$$\n\\mathrm{Re}\\!\\left(\\tilde{k}\\right) - k = C_{p}\\,k^{5} h^{4} + \\mathcal{O}\\!\\left(k^{7} h^{6}\\right).\n$$\nDerive these coefficients starting from the above discrete operator and the definition of $\\tilde{k}$, without invoking any pre-tabulated discrete symbols. Express your final answer as a row matrix $\\begin{pmatrix}C_{d} & C_{p}\\end{pmatrix}$ of exact fractions. No rounding is required. In your derivation, also state how each effect scales with $h$.",
            "solution": "The problem requires the determination of the leading-order numerical dissipation and dispersion coefficients, denoted $C_d$ and $C_p$ respectively, for a given third-order finite difference approximation to the first spatial derivative. The analysis is performed using the concept of the modified wavenumber, $\\tilde{k}$.\n\nThe governing partial differential equation is the one-dimensional linear advection equation, $u_{t} + a\\,u_{x} = 0$, where $a > 0$ is a constant advection speed. The spatial derivative $u_x$ at a grid point $x_i$ is approximated by the discrete operator $(D u)_i$:\n$$\n\\left(D u\\right)_{i} \\equiv \\frac{1}{h}\\left(\\frac{11}{6}\\,u_{i} - 3\\,u_{i-1} + \\frac{3}{2}\\,u_{i-2} - \\frac{1}{3}\\,u_{i-3}\\right)\n$$\nwhere $h$ is the uniform grid spacing.\n\nTo perform a Fourier analysis, we consider the action of this operator on a single Fourier mode, $u_j = \\exp(i k x_j)$, where $x_j=jh$ and $k$ is the physical wavenumber. The modified wavenumber $\\tilde{k}$ is defined by the relation:\n$$\nD u_{j} = \\left(i\\,\\tilde{k}\\right) u_{j}\n$$\nThe exact differential operator $\\frac{\\partial}{\\partial x}$ acting on this mode yields $\\frac{\\partial}{\\partial x} \\exp(ikx) = (ik)\\exp(ikx)$. Thus, $\\tilde{k}$ serves as the representation of the wavenumber $k$ in the discrete system. Any deviation of $\\tilde{k}$ from $k$ signifies numerical error.\n\nWe begin by substituting the Fourier mode into the discrete operator. Note that for any integer $m$, $u_{j-m} = \\exp(ik(j-m)h) = \\exp(ikjh) \\exp(-ikmh) = u_j \\exp(-imkh)$. Let $\\theta \\equiv kh$ be the dimensionless wavenumber. Then $u_{j-m} = u_j \\exp(-im\\theta)$.\nApplying the operator $D$ to $u_j$:\n$$\n\\begin{aligned}\nD u_{j} &= \\frac{1}{h}\\left(\\frac{11}{6}\\,u_{j} - 3\\,u_{j-1} + \\frac{3}{2}\\,u_{j-2} - \\frac{1}{3}\\,u_{j-3}\\right) \\\\\n&= \\frac{1}{h}\\left(\\frac{11}{6}\\,u_{j} - 3\\,u_{j}\\exp(-i\\theta) + \\frac{3}{2}\\,u_{j}\\exp(-i2\\theta) - \\frac{1}{3}\\,u_{j}\\exp(-i3\\theta)\\right) \\\\\n&= \\frac{u_{j}}{h}\\left(\\frac{11}{6} - 3\\exp(-i\\theta) + \\frac{3}{2}\\exp(-i2\\theta) - \\frac{1}{3}\\exp(-i3\\theta)\\right)\n\\end{aligned}\n$$\nBy the definition of the modified wavenumber, we equate this to $(i\\,\\tilde{k}) u_{j}$:\n$$\n(i\\,\\tilde{k}) u_{j} = \\frac{u_{j}}{h}\\left(\\frac{11}{6} - 3\\exp(-i\\theta) + \\frac{3}{2}\\exp(-i2\\theta) - \\frac{1}{3}\\exp(-i3\\theta)\\right)\n$$\nSolving for $\\tilde{k}$ yields:\n$$\n\\tilde{k} = \\frac{1}{ih}\\left(\\frac{11}{6} - 3\\exp(-i\\theta) + \\frac{3}{2}\\exp(-i2\\theta) - \\frac{1}{3}\\exp(-i3\\theta)\\right)\n$$\nThis is the exact expression for the modified wavenumber. To analyze the numerical error for long wavelengths (small $k$), we perform a Taylor series expansion of this expression for small $\\theta \\ll 1$. Let the term in parentheses be $Z(\\theta)$. By expanding each exponential function ($\\exp(-im\\theta) = 1 - im\\theta - (m\\theta)^2/2! + i(m\\theta)^3/3! + \\dots$) and collecting terms by powers of $\\theta$, we find that the terms for $\\theta^0$, $\\theta^2$, and $\\theta^3$ are zero, as expected for a third-order scheme. The leading terms of the expansion are:\n$$\nZ(\\theta) = i\\theta - \\frac{1}{4}\\theta^4 + i\\frac{3}{10}\\theta^5 + \\mathcal{O}(\\theta^6)\n$$\nNow we substitute this back into the expression for $\\tilde{k}$:\n$$\n\\tilde{k} = \\frac{Z(\\theta)}{ih} = \\frac{1}{ih}\\left(i\\theta - \\frac{1}{4}\\theta^4 + i\\frac{3}{10}\\theta^5 + \\mathcal{O}(\\theta^6)\\right)\n$$\n$$\n\\tilde{k} = \\frac{\\theta}{h} + i\\frac{\\theta^4}{4h} - \\frac{3\\theta^5}{10h} + \\mathcal{O}\\left(\\frac{\\theta^6}{h}\\right)\n$$\nSubstituting $\\theta=kh$:\n$$\n\\tilde{k} = \\frac{kh}{h} + i\\frac{(kh)^4}{4h} - \\frac{3(kh)^5}{10h} + \\mathcal{O}(k^6h^5) = k + i\\frac{1}{4}k^4h^3 - \\frac{3}{10}k^5h^4 + \\mathcal{O}(k^6h^5)\n$$\nWe now separate the real and imaginary parts of $\\tilde{k}$.\nThe imaginary part of $\\tilde{k}$ represents numerical dissipation (if positive) or amplification (if negative).\n$$\n\\mathrm{Im}(\\tilde{k}) = \\frac{1}{4}k^4h^3 + \\mathcal{O}(k^6h^5)\n$$\nThis corresponds to numerical dissipation since the coefficient is positive. Comparing with the given form $\\mathrm{Im}(\\tilde{k}) = C_{d}\\,k^{4} h^{3} + \\mathcal{O}(k^{6} h^{5})$, we identify the numerical dissipation coefficient as:\n$$\nC_d = \\frac{1}{4}\n$$\nThe leading-order dissipation error scales with the grid spacing as $h^3$.\n\nThe real part of $\\tilde{k}$ relates to the wave propagation speed. The deviation from the true wavenumber $k$, $\\mathrm{Re}(\\tilde{k}) - k$, represents numerical dispersion.\n$$\n\\mathrm{Re}(\\tilde{k}) = k - \\frac{3}{10}k^5h^4 + \\mathcal{O}(k^6h^5)\n$$\nThus, the dispersion error is:\n$$\n\\mathrm{Re}(\\tilde{k}) - k = -\\frac{3}{10}k^5h^4 + \\mathcal{O}(k^6h^5)\n$$\nComparing with the given form $\\mathrm{Re}(\\tilde{k}) - k = C_{p}\\,k^{5} h^{4} + \\mathcal{O}(k^{7} h^{6})$, we identify the numerical dispersion coefficient as:\n$$\nC_p = -\\frac{3}{10}\n$$\nThe leading-order dispersion error scales with the grid spacing as $h^4$. The negative sign indicates that the numerical phase speed is less than the true phase speed for long wavelengths.\n\nThe requested coefficients are $C_d = \\frac{1}{4}$ and $C_p = -\\frac{3}{10}$.\nFinal answer is to be expressed as a row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{4} & -\\frac{3}{10} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "In computational fluid dynamics, spatial and temporal discretization errors are coupled, and the stability of the time-stepping scheme often imposes severe constraints. This practice explores the critical, and often subtle, relationship between stability and accuracy for stiff systems, which contain vastly different time scales. By analyzing the explicit Euler method applied to the canonical scalar test equation at the very edge of its stability limit, you will derive a surprising result about the global error, illustrating why merely satisfying a stability criterion is not sufficient to guarantee a physically meaningful solution .",
            "id": "3982535",
            "problem": "Consider a stiff linear mode arising from a semi-discrete formulation of the compressible Navierâ€“Stokes equations in Computational Fluid Dynamics (CFD), modeled as the scalar test equation $u_{t} = \\lambda u$ with initial condition $u(0) = u_{0}$, where $\\lambda \\in \\mathbb{R}$, $\\lambda < 0$, and $|\\lambda| \\gg 1$. Let $T > 0$ be a fixed final time. Apply the explicit forward Euler time-stepping method with a uniform step size $\\Delta t > 0$, and define the global error at time $T$ as $E(T) = u(T) - u^{N}$, where $u(T)$ is the exact solution at time $T$, $u^{N}$ is the numerical approximation after $N$ steps, and $N = T / \\Delta t$ is an integer.\n\nStarting from fundamental definitions and without invoking pre-derived error formulas, derive a closed-form expression for $E(T)$ in terms of $\\lambda$, $\\Delta t$, $T$, and $u_{0}$. Then enforce the explicit Euler stability constraint for the real negative scalar test equation, namely $\\Delta t \\le 2 / |\\lambda|$, and saturate it by taking $\\Delta t = 2 / |\\lambda|$. Under this saturation, express $E(T)$ in closed form as a function of $u_{0}$, $T$, and $|\\lambda|$, assuming $N = T / \\Delta t \\in \\mathbb{N}$ (equivalently, $T |\\lambda| / 2 \\in \\mathbb{N}$). Your final answer must be this closed-form expression for the global error $E(T)$ under $\\Delta t = 2 / |\\lambda|$. No numerical rounding is required, and no units should be included in your final expression.",
            "solution": "The exact solution to the initial value problem $u_{t} = \\lambda u$ with $u(0)=u_0$ is $u(t) = u_0 e^{\\lambda t}$. At the final time $T$, the exact solution is $u(T) = u_0 e^{\\lambda T}$.\n\nThe explicit forward Euler method applied to this equation gives the recurrence relation $u^{n+1} = u^n + \\Delta t (\\lambda u^n) = (1 + \\lambda \\Delta t) u^n$. The solution after $N$ steps is $u^N = (1 + \\lambda \\Delta t)^N u_0$. With $N=T/\\Delta t$, the numerical solution at time $T$ is $u^N = (1 + \\lambda \\Delta t)^{T/\\Delta t} u_0$.\n\nThe global error at time $T$ is $E(T) = u(T) - u^N = u_0 \\left[ e^{\\lambda T} - (1 + \\lambda \\Delta t)^{T/\\Delta t} \\right]$.\n\nWe are given that the stability constraint is saturated. For the explicit Euler method and real negative $\\lambda$, the stability region is $|1 + \\lambda\\Delta t| \\le 1$. Saturation occurs at the boundary, $1 + \\lambda\\Delta t = -1$, which gives $\\lambda \\Delta t = -2$. This corresponds to a time step of $\\Delta t = -2/\\lambda = 2/|\\lambda|$.\n\nSubstituting $\\lambda \\Delta t = -2$ into the error expression, and using $N=T/\\Delta t = T|\\lambda|/2$:\n$$\nE(T) = u_0 \\left[ e^{\\lambda T} - (1 - 2)^{T|\\lambda|/2} \\right]\n$$\nFinally, replacing $\\lambda$ with $-|\\lambda|$ in the exponential, we get the closed-form expression for the global error:\n$$\nE(T) = u_0 \\left[ e^{-|\\lambda|T} - (-1)^{T|\\lambda|/2} \\right]\n$$",
            "answer": "$$\n\\boxed{u_0 \\left( \\exp(-|\\lambda|T) - (-1)^{T|\\lambda|/2} \\right)}\n$$"
        }
    ]
}