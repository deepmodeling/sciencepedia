{
    "hands_on_practices": [
        {
            "introduction": "A numerical scheme is considered \"consistent\" if its truncation error vanishes as the grid spacing approaches zero, meaning it faithfully represents the original partial differential equation in the limit. However, for any finite grid resolution, the scheme effectively solves a different PDE, known as the modified equation. This exercise guides you through a Taylor series analysis to derive this modified equation for the classic first-order upwind scheme, revealing the source and form of its infamous \"artificial diffusion\"—a non-physical dissipative effect inherent to the discretization .",
            "id": "3950230",
            "problem": "Consider the one-dimensional linear advection partial differential equation (PDE) in the context of Computational Fluid Dynamics (CFD), given by $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$, where $u(x,t)$ is sufficiently smooth. On a uniform spatial grid with spacing $\\Delta x$, define the semi-discrete first-order upwind finite-difference approximation to the spatial derivative at grid point $x_{i}$ by replacing $u_{x}(x_{i},t)$ with $\\left(u_{i}(t) - u_{i-1}(t)\\right)/\\Delta x$, where $u_{i}(t) = u(x_{i},t)$ and $x_{i} = i\\,\\Delta x$. The resulting semi-discrete scheme is $u_{i}'(t) + a\\,\\left(u_{i}(t) - u_{i-1}(t)\\right)/\\Delta x = 0$.\n\nStarting from the PDE and the definition of the upwind scheme, use Taylor series expansions of $u(x,t)$ about $x_{i}$ to derive the modified equation that the semi-discrete scheme solves, retaining terms up to and including order $\\mathcal{O}\\!\\left(\\Delta x^{2}\\right)$. Then, identify the leading-order artificial diffusion term that appears in this modified equation and is proportional to $a\\,\\Delta x$.\n\nExpress your final answer as a single analytic expression for that leading artificial diffusion term. No numerical evaluation is required, and no units are involved in the final expression.",
            "solution": "The problem requires the derivation of the modified partial differential equation for a semi-discrete, first-order upwind scheme applied to the one-dimensional linear advection equation. From this modified equation, we must identify the leading-order artificial diffusion term.\n\nThe given partial differential equation (PDE) is the linear advection equation:\n$$u_{t} + a\\,u_{x} = 0$$\nwhere $u=u(x,t)$, $u_t = \\frac{\\partial u}{\\partial t}$, $u_x = \\frac{\\partial u}{\\partial x}$, and the advection speed $a$ is a positive constant ($a > 0$).\n\nThe problem defines a semi-discrete numerical scheme on a uniform grid with spacing $\\Delta x$. At each grid point $x_i$, the spatial derivative $u_x$ is approximated by the first-order upwind finite difference formula. Since $a > 0$, the \"upwind\" direction is the negative $x$ direction, involving grid points $i$ and $i-1$. The scheme is given as:\n$$\\frac{d u_{i}(t)}{dt} + a\\,\\frac{u_{i}(t) - u_{i-1}(t)}{\\Delta x} = 0$$\nHere, $u_i(t)$ represents the numerical solution at grid point $x_i$ as a function of continuous time $t$, so $\\frac{d u_{i}(t)}{dt}$ is equivalent to evaluating the partial derivative $\\frac{\\partial u}{\\partial t}$ at $x_i$. We can write the scheme using partial derivative notation at the point $(x_i, t)$:\n$$\\frac{\\partial u}{\\partial t} + a\\,\\left(\\frac{u(x_i, t) - u(x_i - \\Delta x, t)}{\\Delta x}\\right) = 0$$\n\nTo find the modified equation that this scheme actually solves, we analyze the truncation error of the finite difference approximation. We perform a Taylor series expansion of the term $u(x_i - \\Delta x, t)$ about the point $x_i$:\n$$u(x_i - \\Delta x, t) = u(x_i, t) - (\\Delta x)\\frac{\\partial u}{\\partial x}\\bigg|_{x_i} + \\frac{(\\Delta x)^2}{2!}\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x_i} - \\frac{(\\Delta x)^3}{3!}\\frac{\\partial^3 u}{\\partial x^3}\\bigg|_{x_i} + \\mathcal{O}(\\Delta x^4)$$\nFor clarity, we adopt the subscript notation for partial derivatives evaluated at $(x_i, t)$, e.g., $u_x = \\frac{\\partial u}{\\partial x}\\big|_{x_i}$, $u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}\\big|_{x_i}$, and so on. The expansion becomes:\n$$u(x_i - \\Delta x, t) = u(x_i, t) - \\Delta x \\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\n\nNow, we substitute this expansion into the finite difference operator from the scheme:\n$$\\frac{u(x_i, t) - u(x_i - \\Delta x, t)}{\\Delta x} = \\frac{1}{\\Delta x} \\left[ u(x_i, t) - \\left( u(x_i, t) - \\Delta x \\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) \\right) \\right]$$\nSimplifying the expression inside the brackets:\n$$\\frac{u(x_i, t) - u(x_i - \\Delta x, t)}{\\Delta x} = \\frac{1}{\\Delta x} \\left[ \\Delta x \\, u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} - \\mathcal{O}(\\Delta x^4) \\right]$$\nDividing by $\\Delta x$, we obtain the continuous representation of the discrete spatial derivative operator:\n$$\\frac{u(x_i, t) - u(x_i - \\Delta x, t)}{\\Delta x} = u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{(\\Delta x)^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3)$$\n\nNext, we substitute this result back into the semi-discrete scheme. Dropping the explicit evaluation at $x_i$ for notational convenience, we are now describing the behavior of the solution on a continuous domain:\n$$u_t + a \\left( u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{(\\Delta x)^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3) \\right) = 0$$\nDistributing the constant $a$:\n$$u_t + a u_x - a \\frac{\\Delta x}{2} u_{xx} + a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3) = 0$$\n\nThis is the modified partial differential equation solved by the scheme, including terms up to order $\\mathcal{O}(\\Delta x^2)$. To better see the relationship with the original PDE, we rearrange the equation:\n$$u_t + a u_x = a \\frac{\\Delta x}{2} u_{xx} - a \\frac{(\\Delta x)^2}{6} u_{xxx} - \\mathcal{O}(\\Delta x^3)$$\n\nThe left side, $u_t + a u_x$, is the original PDE, which should be equal to $0$. The right side represents the truncation error of the scheme. The modified equation shows that the numerical solution does not satisfy the original PDE exactly, but rather satisfies a different PDE that includes these error terms.\n\nThe leading term of the truncation error is the term with the lowest power of $\\Delta x$, which is $a \\frac{\\Delta x}{2} u_{xx}$. This term is of order $\\mathcal{O}(\\Delta x)$. It involves a second-order spatial derivative, $u_{xx}$, which is characteristic of physical diffusion or viscous dissipation phenomena (e.g., the heat equation, $u_t = \\nu u_{xx}$). Because this term is an artifact of the numerical method and not part of the original physical model, it is referred to as \"artificial diffusion\" or \"numerical diffusion\". The coefficient $a \\frac{\\Delta x}{2}$ is the artificial diffusion coefficient. Since $a > 0$ and $\\Delta x > 0$, this coefficient is positive, indicating that the scheme introduces a dissipative effect that tends to smooth out sharp gradients in the solution.\n\nThe problem asks to identify this \"leading-order artificial diffusion term\". Based on our analysis, this term is precisely the leading term of the truncation error.\n\nThe artificial diffusion term is therefore $a \\frac{\\Delta x}{2} u_{xx}$.",
            "answer": "$$\n\\boxed{a \\frac{\\Delta x}{2} u_{xx}}\n$$"
        },
        {
            "introduction": "While consistency addresses the accuracy of a scheme, stability governs whether errors will remain bounded or grow catastrophically over time. For linear problems, the von Neumann stability analysis is the canonical tool for investigating this behavior by examining the amplification of individual Fourier modes. This practice applies the analysis to a fully discrete upwind scheme, demonstrating how to derive its amplification factor and, most importantly, the celebrated Courant–Friedrichs–Lewy (CFL) condition that constrains the time step for a stable simulation .",
            "id": "3950212",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$, which serves as a canonical transport model in Computational Fluid Dynamics (CFD). The domain is taken to be either periodic or infinite, and the spatial grid is uniform with nodes $x_{j} = j\\,\\Delta x$ for integer $j$ and time levels $t^{n} = n\\,\\Delta t$ for integer $n$. Define the Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$. Discretize the equation with a first-order upwind spatial difference (appropriate for $a>0$) and a forward-Euler time integration, forming the explicit scheme that updates $u_{j}^{n}$ to $u_{j}^{n+1}$. Starting from the linear advection model and the definitions of the forward difference in time and the upwind difference in space, perform a von Neumann (Fourier) stability analysis by substituting a single Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$, where $i = \\sqrt{-1}$ and $\\theta$ is the nondimensional wavenumber. Derive the amplification factor $G(\\theta)$ defined by $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$, and determine the largest admissible value of the CFL number $\\nu$ such that the scheme is stable for all $\\theta$. Your final answer must consist of the closed-form expression for $G(\\theta)$ and the single number giving the largest admissible $\\nu$, in that order. No rounding is required.",
            "solution": "The given partial differential equation (PDE) is the one-dimensional linear advection equation:\n$$u_{t} + a\\,u_{x} = 0$$\nwhere the advection speed $a$ is a positive constant ($a > 0$).\n\nThe specified numerical scheme uses a forward-Euler method for time integration and a first-order upwind method for spatial discretization.\n\nThe time derivative term, $u_t$, is approximated by a first-order forward difference:\n$$\\frac{\\partial u}{\\partial t} \\approx \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}$$\nwhere $u_j^n$ represents the numerical solution at spatial node $x_j = j\\,\\Delta x$ and time level $t^n = n\\,\\Delta t$.\n\nThe spatial derivative term, $u_x$, is approximated by a first-order upwind difference. Since $a > 0$, the \"upwind\" direction is from the left (i.e., information propagates from smaller $x$ to larger $x$). This corresponds to a first-order backward difference:\n$$\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x}$$\nSubstituting these discrete approximations into the PDE yields the fully discretized equation:\n$$\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a \\left(\\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x}\\right) = 0$$\nTo obtain the explicit update scheme for $u_{j}^{n+1}$, we rearrange the terms:\n$$u_{j}^{n+1} - u_{j}^{n} = -a \\frac{\\Delta t}{\\Delta x} \\left(u_{j}^{n} - u_{j-1}^{n}\\right)$$\nWe introduce the Courant–Friedrichs–Lewy (CFL) number, defined as $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$. Substituting $\\nu$ into the equation gives:\n$$u_{j}^{n+1} = u_{j}^{n} - \\nu \\left(u_{j}^{n} - u_{j-1}^{n}\\right)$$\n$$u_{j}^{n+1} = (1 - \\nu)u_{j}^{n} + \\nu u_{j-1}^{n}$$\nThis is the finite difference scheme for which we must perform a von Neumann stability analysis. The analysis proceeds by substituting a single Fourier mode, $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$, into the scheme. Here, $\\hat{u}^{n}$ is the amplitude of the mode at time step $n$, $i=\\sqrt{-1}$, and $\\theta = k_x \\Delta x$ is the nondimensional wavenumber, with $k_x$ being the wavenumber.\n\nThe terms in the scheme become:\n$$u_{j}^{n+1} = \\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\theta)$$\n$$u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$$\n$$u_{j-1}^{n} = \\hat{u}^{n}\\,\\exp(i\\,(j-1)\\,\\theta) = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(-i\\,\\theta)$$\nSubstituting these into the discrete equation:\n$$\\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\theta) = (1 - \\nu)\\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta) + \\nu \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(-i\\,\\theta)$$\nWe can divide the entire equation by the common factor $\\exp(i\\,j\\,\\theta)$, which is non-zero:\n$$\\hat{u}^{n+1} = (1 - \\nu)\\hat{u}^{n} + \\nu \\hat{u}^{n}\\,\\exp(-i\\,\\theta)$$\nFactoring out $\\hat{u}^n$ on the right-hand side gives:\n$$\\hat{u}^{n+1} = [1 - \\nu + \\nu \\exp(-i\\,\\theta)]\\,\\hat{u}^{n}$$\nThe amplification factor, $G(\\theta)$, is defined by the relation $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$. By comparison, we find the expression for $G(\\theta)$:\n$$G(\\theta) = 1 - \\nu + \\nu \\exp(-i\\,\\theta)$$\nThis is the first part of the required answer.\n\nFor the scheme to be stable, the modulus of the amplification factor must not exceed unity for any value of the nondimensional wavenumber $\\theta$. The von Neumann stability condition is:\n$$|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in [-\\pi, \\pi]$$\nTo analyze this condition, we compute the modulus squared, $|G(\\theta)|^2$. Using Euler's formula, $\\exp(-i\\,\\theta) = \\cos(\\theta) - i\\,\\sin(\\theta)$, we can write $G(\\theta)$ in terms of its real and imaginary parts:\n$$G(\\theta) = (1 - \\nu + \\nu \\cos(\\theta)) - i\\,(\\nu \\sin(\\theta))$$\nThe modulus squared is the sum of the squares of the real and imaginary parts:\n$$|G(\\theta)|^2 = (1 - \\nu + \\nu \\cos(\\theta))^2 + (-\\nu \\sin(\\theta))^2$$\n$$|G(\\theta)|^2 = (1 - \\nu(1 - \\cos(\\theta)))^2 + \\nu^2 \\sin^2(\\theta)$$\nExpanding the squared terms:\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + \\nu^2(1 - \\cos(\\theta))^2 + \\nu^2 \\sin^2(\\theta)$$\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + \\nu^2(1 - 2\\cos(\\theta) + \\cos^2(\\theta)) + \\nu^2 \\sin^2(\\theta)$$\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + \\nu^2(1 - 2\\cos(\\theta) + \\cos^2(\\theta) + \\sin^2(\\theta))$$\nUsing the identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$:\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + \\nu^2(1 - 2\\cos(\\theta) + 1)$$\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + \\nu^2(2 - 2\\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 - 2\\nu(1 - \\cos(\\theta)) + 2\\nu^2(1 - \\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 + (2\\nu^2 - 2\\nu)(1 - \\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 + 2\\nu(\\nu - 1)(1 - \\cos(\\theta))$$\nThe stability condition $|G(\\theta)|^2 \\le 1$ becomes:\n$$1 + 2\\nu(\\nu - 1)(1 - \\cos(\\theta)) \\le 1$$\n$$2\\nu(\\nu - 1)(1 - \\cos(\\theta)) \\le 0$$\nWe analyze the factors in this inequality:\n1.  The CFL number $\\nu = a\\,\\Delta t / \\Delta x$ is positive since $a > 0$, $\\Delta t > 0$, and $\\Delta x > 0$. Thus, $\\nu > 0$.\n2.  The term $(1 - \\cos(\\theta))$ is always non-negative for any real $\\theta$, as $-1 \\le \\cos(\\theta) \\le 1$. It ranges from $0$ to $2$.\nSince $2\\nu > 0$ and $(1 - \\cos(\\theta)) \\ge 0$, the inequality can only be satisfied for all $\\theta$ if the remaining factor $(\\nu-1)$ is non-positive.\n$$\\nu - 1 \\le 0 \\implies \\nu \\le 1$$\nCombining this with $\\nu > 0$, the stability condition for the scheme is $0 < \\nu \\le 1$.\nThe question asks for the largest admissible value of the CFL number $\\nu$ for which the scheme is stable. This corresponds to the upper bound of the stability range.\n$$\\nu_{\\text{max}} = 1$$\nThis is the second part of the required answer.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1 - \\nu + \\nu \\exp(-i\\theta) & 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "The Lax Equivalence Theorem famously states that for a consistent scheme, stability is the necessary and sufficient condition for convergence. This means that if a scheme is both consistent and stable, its solution will approach the true solution of the PDE as the grid is refined. This final exercise bridges theory and practice by tasking you with a core activity of computational science: performing a grid convergence study to measure the observed order of accuracy from simulated data, and reconciling it with theoretical expectations in the presence of real-world complexities like boundary conditions .",
            "id": "3950211",
            "problem": "Consider the two-dimensional compressible Euler equations on a square domain, initialized with an isentropic vortex embedded in a uniform free-stream so that the exact solution is a rigid-body convection of the vortex at constant speed. Assume a finite-volume spatial discretization that is formally second-order accurate in the interior and advanced with a stable explicit time integrator under a fixed Courant–Friedrichs–Lewy (CFL) number. Let the spatial grid be uniform with spacing $h$, and let the global discrete $L^{2}$-error at a fixed final time be denoted by $E(h)$. By definition of consistency, the interior local truncation error has order $q_{i}=2$; however, boundary closures can alter the global consistency order depending on their accuracy. Under stability, the principle of convergence asserts that the global error behaves as a sum of contributions coming from distinct regions (interior and boundary-affected), which can be modeled as\n$$\nE(h) \\approx C_{i}\\, h^{q_{i}} + C_{b}\\, h^{q_{b}},\n$$\nwhere $C_{i}$ and $C_{b}$ are positive constants that depend on the solution and scheme details, $q_{i}$ is the interior order, and $q_{b}$ is the boundary-closure order. The observed order of accuracy $p_{\\mathrm{obs}}$ over a grid refinement with ratio $r>1$ can be estimated from error measurements by fitting the slope of $\\log E(h)$ versus $\\log h$.\n\nYour task is to write a program that, given a small test suite of measured $L^{2}$-errors for three grid spacings per scenario, computes the observed order of accuracy and reconciles it with the theoretical consistency expectations when boundary effects are present. No physical units are required because the errors and spacings are non-dimensional.\n\nDefinitions and requirements:\n- The observed pairwise order between two consecutive grid spacings $h_{k}$ and $h_{k+1}=h_{k}/r$ with corresponding errors $E_{k}$ and $E_{k+1}$ is\n$$\np_{k\\rightarrow k+1} = \\frac{\\log\\left(E_{k}/E_{k+1}\\right)}{\\log(r)}.\n$$\n- The multi-point observed order $p_{\\mathrm{fit}}$ should be obtained by a least-squares linear fit of $y=\\log E(h)$ versus $x=\\log h$ using all three data points; the fitted slope is the estimate of the order.\n- The theoretical asymptotic global order under stability is $p_{\\infty}=\\min\\{q_{i}, q_{b}\\}$, where $q_{b}$ is the boundary-closure order. In the absence of boundary closures that reduce accuracy (e.g., periodic boundaries), take $q_{b}=q_{i}$.\n- Reconciliation criterion: declare a boolean $\\mathrm{asymptotic\\_consistent}$ that is true if either $|p_{\\mathrm{fit}}-p_{\\infty}|\\leq \\tau$ or $|p_{k\\rightarrow k+1}^{\\text{fine}}-p_{\\infty}|\\leq \\tau$, where $p_{k\\rightarrow k+1}^{\\text{fine}}$ is the pairwise order on the two finest grids and $\\tau$ is a small tolerance.\n\nTest suite:\n- Common settings for all scenarios: domain length $L=1$, refinement ratio $r=2$, grid sizes $N\\in\\{16,32,64\\}$ with $h=L/N$.\n- Scenario $\\mathcal{A}$ (periodic boundaries, no boundary-induced degradation): measured errors\n  - $E_{16}=0.0001953125$,\n  - $E_{32}=0.000048828125$,\n  - $E_{64}=0.00001220703125$,\n  and theoretical $p_{\\infty}=2$.\n- Scenario $\\mathcal{B}$ (inflow–outflow boundaries with first-order closure dominating globally): measured errors\n  - $E_{16}=0.001328125$,\n  - $E_{32}=0.00064453125$,\n  - $E_{64}=0.0003173828125$,\n  and theoretical $p_{\\infty}=1$.\n- Scenario $\\mathcal{C}$ (wall boundaries with first-order closure in a pre-asymptotic regime, interior still significant on coarse grids): measured errors\n  - $E_{16}=0.000640625$,\n  - $E_{32}=0.00022265625$,\n  - $E_{64}=0.0000869140625$,\n  and theoretical $p_{\\infty}=1$.\n\nProgram requirements:\n- Implement the computation of $p_{16\\rightarrow 32}$, $p_{32\\rightarrow 64}$, and $p_{\\mathrm{fit}}$ for each scenario using the definitions above with $r=2$.\n- Use tolerance $\\tau=0.15$ for the reconciliation criterion and set $\\mathrm{asymptotic\\_consistent}$ according to the rule described.\n- Your program should produce a single line of output containing the aggregated results as a comma-separated list enclosed in square brackets. For each scenario in the order $\\mathcal{A},\\mathcal{B},\\mathcal{C}$, output the three floating-point values $p_{16\\rightarrow 32}$, $p_{32\\rightarrow 64}$, and $p_{\\mathrm{fit}}$ rounded to three decimal places, followed by the boolean $\\mathrm{asymptotic\\_consistent}$ rendered as either the word True or False. The final output therefore contains twelve items:\n  - Scenario $\\mathcal{A}$: $p_{16\\rightarrow 32}$, $p_{32\\rightarrow 64}$, $p_{\\mathrm{fit}}$, $\\mathrm{asymptotic\\_consistent}$,\n  - Scenario $\\mathcal{B}$: $p_{16\\rightarrow 32}$, $p_{32\\rightarrow 64}$, $p_{\\mathrm{fit}}$, $\\mathrm{asymptotic\\_consistent}$,\n  - Scenario $\\mathcal{C}$: $p_{16\\rightarrow 32}$, $p_{32\\rightarrow 64}$, $p_{\\mathrm{fit}}$, $\\mathrm{asymptotic\\_consistent}$.\nExample format: \"[2.000,2.000,2.000,True,1.050,1.020,1.035,True,1.520,1.360,1.440,False]\". The numerical values shown here are illustrative; your program must compute the actual values from the provided data.",
            "solution": "The core of the problem lies in analyzing the convergence of a numerical solution to the Euler equations. For a well-posed numerical scheme that is consistent and stable, the Lax Equivalence Theorem guarantees convergence. The rate of this convergence is a critical measure of the scheme's efficiency.\n\nThe global discrete error $E(h)$ at a fixed final time for a grid spacing $h$ depends on contributions from the interior of the computational domain and its boundaries. The problem provides a model for this behavior:\n$$\nE(h) \\approx C_{i}\\, h^{q_{i}} + C_{b}\\, h^{q_{b}}\n$$\nHere, $C_{i}$ and $C_{b}$ are constants, $q_{i}$ is the order of accuracy of the spatial discretization in the interior of the domain, and $q_{b}$ is the order of accuracy of the boundary condition implementation. The problem states that the interior scheme is second-order accurate, so $q_{i}=2$. The asymptotic order of accuracy, $p_{\\infty}$, is the rate at which the error decreases for sufficiently small $h$. In this limit, the term with the lower exponent dominates, thus $p_{\\infty} = \\min\\{q_{i}, q_{b}\\}$.\n\nTo numerically verify the order of accuracy, one measures the error $E(h)$ on a sequence of systematically refined grids. The observed order of accuracy, $p_{\\mathrm{obs}}$, can be estimated from these measurements.\n\nIf we assume the error is dominated by a single term, $E(h) \\approx C h^{p}$, we can take the logarithm of both sides:\n$$\n\\log(E(h)) \\approx \\log(C) + p \\log(h)\n$$\nThis shows a linear relationship between $\\log(E)$ and $\\log(h)$, where the slope is the order of accuracy $p$.\n\nThe observed pairwise order between two grid levels, with spacings $h_k$ and $h_{k+1}=h_k/r$ (where $r$ is the refinement ratio), is derived from the ratio of their errors:\n$$\n\\frac{E_k}{E_{k+1}} \\approx \\frac{C h_k^p}{C (h_k/r)^p} = r^p\n$$\nSolving for $p$ gives the formula provided:\n$$\np_{k\\rightarrow k+1} = \\frac{\\log(E_k/E_{k+1})}{\\log(r)}\n$$\nFor a more robust estimate using multiple data points, a least-squares linear regression is performed on the data $\\{(\\log h_k, \\log E_k)\\}$. The slope of the resulting line provides the fitted order of accuracy, $p_{\\mathrm{fit}}$.\n\nThe reconciliation criterion, $|p_{\\mathrm{fit}}-p_{\\infty}|\\leq \\tau$ or $|p_{k\\rightarrow k+1}^{\\text{fine}}-p_{\\infty}|\\leq \\tau$, serves to determine if the simulation results are in the asymptotic regime, where the observed order is close to the theoretical asymptotic order $p_\\infty$. The tolerance $\\tau$ accounts for small deviations due to higher-order terms or numerical noise. In this problem, we are given $r=2$, $h_N = L/N = 1/N$ for $N \\in \\{16, 32, 64\\}$, and $\\tau=0.15$.\n\nWe now apply this framework to each scenario.\n\n**Scenario $\\mathcal{A}$**\n- Given errors: $E_{16}=0.0001953125$, $E_{32}=0.000048828125$, $E_{64}=0.00001220703125$.\n- Theoretical order: $p_{\\infty}=2$.\n- The error ratios are $E_{16}/E_{32} = 4$ and $E_{32}/E_{64} = 4$.\n- Pairwise orders:\n  $$p_{16\\rightarrow 32} = \\frac{\\log(4)}{\\log(2)} = 2$$\n  $$p_{32\\rightarrow 64} = \\frac{\\log(4)}{\\log(2)} = 2$$\n- For the fitted order, we perform a linear regression on $(\\log(h_N), \\log(E_N))$ for $N\\in\\{16,32,64\\}$. The three points for $(\\log h, \\log E)$ are equally spaced in their abscissa, which simplifies the least-squares slope to be the slope between the first and last points:\n  $$p_{\\mathrm{fit}} = \\frac{\\log(E_{64}) - \\log(E_{16})}{\\log(h_{64}) - \\log(h_{16})} = \\frac{\\log(E_{16}/E_{64})}{\\log(h_{16}/h_{64})} = \\frac{\\log(E_{16}/E_{64})}{\\log(4)} = \\frac{\\log(16)}{\\log(4)} = 2$$\n- Reconciliation: The finest pairwise order is $p_{32\\rightarrow 64}=2$, and the fitted order is $p_{\\mathrm{fit}}=2$.\n  $|p_{\\mathrm{fit}}-p_{\\infty}| = |2-2|=0 \\leq 0.15$. Thus, $\\mathrm{asymptotic\\_consistent}$ is true.\n  This scenario depicts ideal second-order convergence, as expected for a second-order interior scheme with periodic boundaries that do not degrade accuracy ($q_b=q_i=2$).\n\n**Scenario $\\mathcal{B}$**\n- Given errors: $E_{16}=0.001328125$, $E_{32}=0.00064453125$, $E_{64}=0.0003173828125$.\n- Theoretical order: $p_{\\infty}=1$.\n- The error ratios are $E_{16}/E_{32} \\approx 2.06059$ and $E_{32}/E_{64} \\approx 2.02985$.\n- Pairwise orders:\n  $$p_{16\\rightarrow 32} = \\frac{\\log(2.06059)}{\\log(2)} \\approx 1.043$$\n  $$p_{32\\rightarrow 64} = \\frac{\\log(2.02985)}{\\log(2)} \\approx 1.021$$\n- Fitted order:\n  $$p_{\\mathrm{fit}} = \\frac{\\log(E_{16}/E_{64})}{\\log(4)} = \\frac{\\log(4.18373)}{\\log(4)} \\approx 1.032$$\n- Reconciliation: The finest pairwise order is $p_{32\\rightarrow 64} \\approx 1.021$, and the fitted order is $p_{\\mathrm{fit}} \\approx 1.032$.\n  $|p_{\\mathrm{fit}}-p_{\\infty}| = |1.032-1| = 0.032 \\leq 0.15$. Thus, $\\mathrm{asymptotic\\_consistent}$ is true.\n  The results are consistent with the theoretical expectation of first-order convergence, which arises when a first-order boundary closure ($q_b=1$) dominates the second-order interior scheme ($q_i=2$).\n\n**Scenario $\\mathcal{C}$**\n- Given errors: $E_{16}=0.000640625$, $E_{32}=0.00022265625$, $E_{64}=0.0000869140625$.\n- Theoretical order: $p_{\\infty}=1$.\n- The error ratios are $E_{16}/E_{32} \\approx 2.87719$ and $E_{32}/E_{64} \\approx 2.56180$.\n- Pairwise orders:\n  $$p_{16\\rightarrow 32} = \\frac{\\log(2.87719)}{\\log(2)} \\approx 1.525$$\n  $$p_{32\\rightarrow 64} = \\frac{\\log(2.56180)}{\\log(2)} \\approx 1.357$$\n- Fitted order:\n  $$p_{\\mathrm{fit}} = \\frac{\\log(E_{16}/E_{64})}{\\log(4)} = \\frac{\\log(7.37086)}{\\log(4)} \\approx 1.441$$\n- Reconciliation: The finest pairwise order is $p_{32\\rightarrow 64} \\approx 1.357$, and the fitted order is $p_{\\mathrm{fit}} \\approx 1.441$.\n  $|p_{\\mathrm{fit}}-p_{\\infty}| = |1.441-1| = 0.441 > 0.15$.\n  $|p_{32\\rightarrow 64}-p_{\\infty}| = |1.357-1| = 0.357 > 0.15$.\n  Both conditions are false, so $\\mathrm{asymptotic\\_consistent}$ is false.\n  This scenario illustrates a pre-asymptotic regime. Although the ultimate convergence rate is $p_{\\infty}=1$, the grids used are not fine enough to reach this limit. On these grids, the second-order error component $C_i h^2$ is still significant compared to the first-order boundary component $C_b h^1$, resulting in an observed order between $1$ and $2$. The decreasing trend in the pairwise order ($1.525 \\rightarrow 1.357$) correctly indicates that the convergence rate is approaching the asymptotic limit of $1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes observed orders of accuracy for a numerical scheme under different\n    scenarios and reconciles them with theoretical expectations.\n    \"\"\"\n    # Common settings for all scenarios\n    r = 2.0  # Refinement ratio\n    N_values = [16, 32, 64]\n    L = 1.0\n    h_values = [L / n for n in N_values]\n    tau = 0.15  # Reconciliation tolerance\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Scenario A\",\n            \"errors\": [0.0001953125, 0.000048828125, 0.00001220703125],\n            \"p_inf\": 2.0\n        },\n        {\n            \"name\": \"Scenario B\",\n            \"errors\": [0.001328125, 0.00064453125, 0.0003173828125],\n            \"p_inf\": 1.0\n        },\n        {\n            \"name\": \"Scenario C\",\n            \"errors\": [0.000640625, 0.00022265625, 0.0000869140625],\n            \"p_inf\": 1.0\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        errors = case[\"errors\"]\n        p_inf = case[\"p_inf\"]\n        \n        # Calculate pairwise orders of accuracy\n        # p_16->32\n        p_coarse = np.log(errors[0] / errors[1]) / np.log(r)\n        \n        # p_32->64\n        p_fine = np.log(errors[1] / errors[2]) / np.log(r)\n\n        # Calculate the multi-point fitted order p_fit\n        # This is done by a least-squares linear fit of y=log(E) vs x=log(h)\n        log_h = np.log(h_values)\n        log_E = np.log(errors)\n        \n        # np.polyfit with degree 1 returns [slope, intercept]\n        p_fit = np.polyfit(log_h, log_E, 1)[0]\n        \n        # Reconciliation criterion\n        # is true if either |p_fit - p_inf| <= tau or |p_fine - p_inf| <= tau\n        is_consistent = (abs(p_fit - p_inf) <= tau) or (abs(p_fine - p_inf) <= tau)\n        \n        # Append formatted results for the current scenario\n        results.append(f\"{p_coarse:.3f}\")\n        results.append(f\"{p_fine:.3f}\")\n        results.append(f\"{p_fit:.3f}\")\n        results.append(str(is_consistent))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}