{
    "hands_on_practices": [
        {
            "introduction": "理论与实践之间的桥梁是验证。在将数值方案应用于未知问题之前，一个关键步骤是验证其在已知光滑解上的行为是否符合理论预期。这个练习将指导你完成一个网格加密研究，这是计算流体动力学和更广泛的科学计算中验证代码准确性的基石。通过这个过程，你将把截断误差的理论概念与测量收敛阶的实际技术联系起来 。",
            "id": "3958504",
            "problem": "在计算流体动力学 (CFD) 中，用于离散化可压缩Navier–Stokes方程的空间导数算子，在用于生产模拟之前，必须在光滑基准场上进行精度评估。考虑在区间 $x \\in [0,1]$ 上的一个一维周期性测试场 $u(x)$，它代表了沿翼型剖面的无量纲化光滑壁面切向速度分布。您使用三点中心有限差分导数算子，在三个具有 $N_{1}$、$N_{2}$ 和 $N_{3}$ 个点的连续加密的均匀网格上近似 $u^{\\prime}(x)$，其中加密比固定为 $r = \\frac{h_{1}}{h_{2}} = \\frac{h_{2}}{h_{3}} = 2$，$h_{k}$ 表示第 $k$ 层上的网格间距。在网格点 $x_{i}$ 处的离散误差定义为 $e_{i}(h) = D_{h}u(x_{i}) - u^{\\prime}(x_{i})$，其中 $D_{h}$ 是网格间距为 $h$ 上的离散导数算子。\n\n设计一个系统性的网格加密研究，从第一性原理出发，即从光滑函数相容有限差分近似的基于泰勒级数的截断误差定义开始，估计该导数算子的观测精度阶。以此为基础，推导适用于 $[0,1]$ 上均匀周期性网格的离散误差范数 $\\|e\\|_{L_{1}}$、$\\|e\\|_{L_{2}}$ 和 $\\|e\\|_{L_{\\infty}}$ 的形式，然后推导观测精度阶 $p_{\\text{obs}}$ 的表达式，该表达式用加密比 $r$ 和在连续加密网格上测量的误差范数表示。\n\n最后，将您推导的表达式应用于在加密比 $r = 2$ 的三个网格上使用相同导数算子获得的以下测得的 $L_{2}$ 范数误差：\n$$\nE_{L_{2}}(h_{1}) = 2.985 \\times 10^{-3}, \\quad\nE_{L_{2}}(h_{2}) = 7.500 \\times 10^{-4}, \\quad\nE_{L_{2}}(h_{3}) = 1.885 \\times 10^{-4}.\n$$\n使用数据对 $(h_{1}, h_{2})$ 计算观测精度阶 $p_{\\text{obs}}$，并将您的最终数值结果四舍五入到四位有效数字。$p_{\\text{obs}}$ 是无量纲的，因此不需要物理单位。",
            "solution": "在计算流体动力学 (CFD) 中，对导数算子的系统性网格加密研究必须建立在有限差分分析所要求的相容性和光滑性假设之上。对于一个光滑函数 $u(x)$ 和一个相容的离散导数算子 $D_{h}$，在网格点 $x_{i}$ 附近的泰勒级数展开可以得到局部截断误差。对于一阶导数的三点中心有限差分近似，可以写作\n$$\nD_{h}u(x_{i}) = \\frac{u(x_{i+1}) - u(x_{i-1})}{2h}.\n$$\n将 $u(x_{i \\pm 1})$ 在 $x_{i}$ 附近用泰勒级数展开，并减去精确导数 $u^{\\prime}(x_{i})$，对于光滑的 $u$，可得到与 $h^{2}$ 成正比的主阶截断误差，即：\n$$\nD_{h}u(x_{i}) - u^{\\prime}(x_{i}) = \\frac{h^{2}}{6}u^{(3)}(\\xi_{i}) + \\mathcal{O}(h^{4}),\n$$\n其中 $\\xi_{i}$ 位于 $x_{i}$ 的某个邻域内。这意味着在某个选定的范数下，存在一个渐近误差模型，\n$$\nE(h) = C h^{p} + \\mathcal{O}(h^{p+1}),\n$$\n其中 $C$ 是一个取决于 $u$ 和算子的常数，而 $p$ 是形式精度阶（这里对于光滑函数 $u$ 的中心差分，预期 $p=2$）。观测精度阶 $p_{\\text{obs}}$ 是通过在连续加密的网格上测量误差，并在解进入渐近区域后利用误差随 $h$ 的幂律缩放关系来估计的。\n\n在一个均匀周期性网格 $x_{i} = ih$（其中 $i = 0,1,\\dots,N-1$，间距 $h = 1/N$）上，离散误差样本为 $e_{i}(h) = D_{h}u(x_{i}) - u^{\\prime}(x_{i})$。模拟在 $[0,1]$ 上的连续 $L_{1}$、$L_{2}$ 和 $L_{\\infty}$ 范数的范数定义如下：\n$$\n\\|e\\|_{L_{1}} = \\int_{0}^{1} |e(x)| \\, dx \\approx h \\sum_{i=0}^{N-1} |e_{i}(h)|,\n$$\n$$\n\\|e\\|_{L_{2}} = \\left( \\int_{0}^{1} e(x)^{2} \\, dx \\right)^{1/2} \\approx \\left( h \\sum_{i=0}^{N-1} e_{i}(h)^{2} \\right)^{1/2},\n$$\n$$\n\\|e\\|_{L_{\\infty}} = \\sup_{x \\in [0,1]} |e(x)| \\approx \\max_{0 \\le i \\le N-1} |e_{i}(h)|.\n$$\n这些离散公式保留了范数作为定义域上误差度量的解释，并且是评估均匀网格上离散化误差的标准方法。\n\n假设渐近模型 $E(h) = C h^{p}$ 占主导地位，考虑两个间距分别为 $h$ 和 $h/r$ 的连续网格，其中 $r > 1$ 是加密比。那么\n$$\n\\frac{E(h)}{E(h/r)} \\approx \\frac{C h^{p}}{C (h/r)^{p}} = r^{p}.\n$$\n取自然对数可得\n$$\n\\ln\\!\\left( \\frac{E(h)}{E(h/r)} \\right) \\approx p \\ln(r),\n$$\n这就得到了观测精度阶的估计量\n$$\np_{\\text{obs}} \\approx \\frac{\\ln\\!\\left( E(h) / E(h/r) \\right)}{\\ln(r)}.\n$$\n该估计量对任何范数都有效，只要误差是在主阶项占主导的渐近范围内测量的。\n\n现在我们将此公式应用于给定的加密比 $r = 2$ 和数据对 $(h_{1}, h_{2})$ 的 $L_{2}$ 误差：\n$$\nE_{L_{2}}(h_{1}) = 2.985 \\times 10^{-3}, \\quad E_{L_{2}}(h_{2}) = 7.500 \\times 10^{-4}.\n$$\n计算比值\n$$\n\\frac{E_{L_{2}}(h_{1})}{E_{L_{2}}(h_{2})} = \\frac{2.985 \\times 10^{-3}}{7.500 \\times 10^{-4}} = 3.98.\n$$\n因此，\n$$\np_{\\text{obs}} \\approx \\frac{\\ln(3.98)}{\\ln(2)}.\n$$\n使用 $\\ln(4) = 2 \\ln(2)$ 和 $3.98 = 4 \\times 0.995$，我们有\n$$\n\\ln(3.98) = \\ln(4) + \\ln(0.995) \\approx 2 \\ln(2) - \\left(0.005 + \\frac{0.005^{2}}{2} + \\frac{0.005^{3}}{3} + \\cdots \\right),\n$$\n数值计算给出\n$$\n\\ln(3.98) \\approx 1.381281819, \\quad \\ln(2) \\approx 0.693147181,\n$$\n所以\n$$\np_{\\text{obs}} \\approx \\frac{1.381281819}{0.693147181} \\approx 1.992773\\ldots\n$$\n四舍五入到四位有效数字，\n$$\np_{\\text{obs}} \\approx 1.993.\n$$\n这个结果与应用于光滑场的中心有限差分导数算子的预期二阶行为是一致的。",
            "answer": "$$\\boxed{1.993}$$"
        },
        {
            "introduction": "从理想化的光滑函数转向更贴近现实的场景，我们常常需要处理带有测量噪声的数据。数值微分本质上是一个不适定问题 (ill-posed problem)，对输入数据中的高频成分（如噪声）极为敏感。这个练习将探讨这一关键挑战，通过理论分析和数值实验，揭示减小步长 $\\Delta t$ 以降低截断误差的同时，是如何灾难性地放大噪声的 。",
            "id": "2392343",
            "problem": "给定一个一维位置随时间变化的时间序列模型，其中包含加性测量噪声。该位置是一个已知的平滑时间函数，并在每个采样点上叠加了零均值、独立的噪声。您的任务是设计并实现一个程序，该程序针对一组测试用例，构造带噪声的位置数据，使用有限差分法估计速度和加速度，并定量分析微分算子对测量噪声的放大效应。\n\n您的推理应仅基于以下基本定义和事实：函数的导数是差商的极限，线性算子作用于独立随机变量时，其输出的方差根据算子权重的平方和进行叠加，以及可以使用泰勒级数展开来推导有限差分模板的局部截断误差阶。除这些原则外，不要使用任何其他预先打包好的公式。\n\n使用以下信号模型。无噪声的位置为\n$$\nx(t) = A \\sin(2\\pi f_1 t) + C \\sin(2\\pi f_2 t) + D t^2,\n$$\n参数为\n$$\nA = 1.0\\ \\text{m},\\quad C = 0.5\\ \\text{m},\\quad f_1 = 1.0\\ \\text{Hz},\\quad f_2 = 3.0\\ \\text{Hz},\\quad D = 0.05\\ \\text{m/s}^2.\n$$\n三角函数中的角度以弧度为单位。精确的速度和加速度分别为，\n$$\nv(t) = \\frac{dx}{dt} = 2\\pi f_1 A \\cos(2\\pi f_1 t) + 2\\pi f_2 C \\cos(2\\pi f_2 t) + 2 D t,\n$$\n$$\na(t) = \\frac{d^2 x}{dt^2} = - (2\\pi f_1)^2 A \\sin(2\\pi f_1 t) - (2\\pi f_2)^2 C \\sin(2\\pi f_2 t) + 2 D.\n$$\n\n采样和噪声模型。对于每个测试用例，在以下时间点进行均匀采样\n$$\nt_n = n \\,\\Delta t,\\quad n=0,1,\\dots,N-1,\\quad N = \\left\\lfloor \\frac{T}{\\Delta t}\\right\\rfloor + 1,\\quad T = 10\\ \\text{s},\n$$\n并形成带噪声的测量值\n$$\nx_n^{\\text{noisy}} = x(t_n) + \\eta_n,\\quad \\eta_n \\sim \\mathcal{N}(0,\\sigma_x^2)\\ \\text{i.i.d.},\n$$\n为保证可复现性，使用固定的随机种子 $12345$。所有距离单位为米，时间单位为秒。\n\n有限差分要求。从第一性原理出发，推导并实现用于一阶和二阶导数的二阶精度有限差分格式，具体如下：\n- 对于内部点，使用中心、二阶精度的模板。\n- 在两个边界处，使用单侧、二阶精度的模板。\n您的实现必须生成与输入 $x_n$ 等长的数组 $v_n^{\\text{FD}}$ 和 $a_n^{\\text{FD}}$。\n\n噪声放大分析。设索引 $i$ 处的有限差分导数为线性组合\n$$\ny_i = \\sum_{j} w_{i,j} x_j,\n$$\n其中 $y_i$ 表示一阶或二阶导数估计值，$w_{i,j}$ 是除以 $\\Delta t$ 适当次方的有限差分权重。仅利用期望的线性和噪声样本的独立性，推导并计算：\n- 一阶导数的经验均方根 (RMS) 噪声放大系数，\n$$\ng_v^{\\text{emp}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1} \\left( v_i^{\\text{FD}}[x^{\\text{noisy}}] - v_i^{\\text{FD}}[x^{\\text{clean}}]\\right)^2 },\n$$\n以及二阶导数的经验均方根 (RMS) 噪声放大系数，\n$$\ng_a^{\\text{emp}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1} \\left( a_i^{\\text{FD}}[x^{\\text{noisy}}] - a_i^{\\text{FD}}[x^{\\text{clean}}]\\right)^2 }.\n$$\n- 由权重预测的理论 RMS 噪声放大系数，\n$$\ng^{\\text{theory}} = \\sigma_x \\sqrt{ \\frac{1}{N} \\sum_{i=0}^{N-1} \\left( \\sum_{j} w_{i,j}^2 \\right) }.\n$$\n使用每个索引处（包括边界模板）的实际权重来计算 $g_v^{\\text{theory}}$ 和 $g_a^{\\text{theory}}$。\n\n性能指标。对于每个测试用例，计算：\n- 速度估计值相对于精确速度的 RMS 误差，\n$$\nE_v = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1} \\left( v_i^{\\text{FD}}[x^{\\text{noisy}}] - v(t_i) \\right)^2 } \\ \\text{in m/s}.\n$$\n- 加速度估计值相对于精确加速度的 RMS 误差，\n$$\nE_a = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1} \\left( a_i^{\\text{FD}}[x^{\\text{noisy}}] - a(t_i) \\right)^2 } \\ \\text{in m/s}^2.\n$$\n- 比率\n$$\nR_v = \\frac{ g_v^{\\text{emp}} }{ g_v^{\\text{theory}} },\\qquad R_a = \\frac{ g_a^{\\text{emp}} }{ g_a^{\\text{theory}} },\n$$\n该比率表明经验噪声放大与理论预测的匹配程度。\n\n测试套件。在以下四个测试用例上运行您的程序，这些用例的采样间隔和噪声水平不同：\n- 用例 1：$\\Delta t = 0.01\\ \\text{s}$，$\\sigma_x = 0.001\\ \\text{m}$。\n- 用例 2：$\\Delta t = 0.1\\ \\text{s}$，$\\sigma_x = 0.001\\ \\text{m}$。\n- 用例 3：$\\Delta t = 0.01\\ \\text{s}$，$\\sigma_x = 0.01\\ \\text{m}$。\n- 用例 4：$\\Delta t = 0.001\\ \\text{s}$，$\\sigma_x = 0.001\\ \\text{m}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。对于从 $1$ 到 $4$ 的每个用例，按以下顺序附加四个浮点数：$E_v$（单位 m/s）、$E_a$（单位 m/s$^2$）、$R_v$（无量纲）、$R_a$（无量纲）。每个数字必须以包含六位有效数字的科学记数法打印。例如，整体输出格式为\n$$\n[\\ E_{v,1},\\ E_{a,1},\\ R_{v,1},\\ R_{a,1},\\ E_{v,2},\\ E_{a,2},\\ R_{v,2},\\ R_{a,2},\\ E_{v,3},\\ E_{a,3},\\ R_{v,3},\\ R_{a,3},\\ E_{v,4},\\ E_{a,4},\\ R_{v,4},\\ R_{a,4}\\ ].\n$$",
            "solution": "我们从第一性原理开始。函数 $x(t)$ 在时间 $t$ 的一阶导数由极限定义\n$$\n\\frac{dx}{dt}(t) = \\lim_{\\Delta t \\to 0} \\frac{x(t+\\Delta t) - x(t-\\Delta t)}{2\\Delta t},\n$$\n这表明对于有限但较小的 $\\Delta t$，应使用对称（中心）差商。二阶导数定义为\n$$\n\\frac{d^2x}{dt^2}(t) = \\lim_{\\Delta t \\to 0} \\frac{x(t+\\Delta t) - 2x(t) + x(t-\\Delta t)}{\\Delta t^2}.\n$$\n使用在 $t_i = i \\Delta t$ 附近的泰勒级数展开，\n$$\nx(t_{i\\pm 1}) = x(t_i) \\pm \\Delta t\\, x'(t_i) + \\frac{\\Delta t^2}{2} x''(t_i) \\pm \\frac{\\Delta t^3}{6} x^{(3)}(t_i) + \\frac{\\Delta t^4}{24} x^{(4)}(t_i) + \\mathcal{O}(\\Delta t^5),\n$$\n我们可以为内部点推导出二阶精度的中心模板：\n$$\nx'(t_i) = \\frac{x_{i+1} - x_{i-1}}{2\\Delta t} + \\mathcal{O}(\\Delta t^2), \\quad\nx''(t_i) = \\frac{x_{i+1} - 2 x_i + x_{i-1}}{\\Delta t^2} + \\mathcal{O}(\\Delta t^2),\n$$\n其中 $x_i = x(t_i)$。在边界处，无法形成对称差分；作为替代，使用前向点的泰勒展开可以得到单侧、二阶精度的模板。对于左边界 $i=0$ 处的一阶导数，\n$$\nx'(t_0) = \\frac{-3 x_0 + 4 x_1 - x_2}{2\\Delta t} + \\mathcal{O}(\\Delta t^2),\n$$\n类似地，对于右边界 $i=N-1$，\n$$\nx'(t_{N-1}) = \\frac{3 x_{N-1} - 4 x_{N-2} + x_{N-3}}{2\\Delta t} + \\mathcal{O}(\\Delta t^2).\n$$\n对于二阶导数，前向和后向的二阶精度单侧模板为\n$$\nx''(t_0) = \\frac{2 x_0 - 5 x_1 + 4 x_2 - x_3}{\\Delta t^2} + \\mathcal{O}(\\Delta t^2), \\quad\nx''(t_{N-1}) = \\frac{2 x_{N-1} - 5 x_{N-2} + 4 x_{N-3} - x_{N-4}}{\\Delta t^2} + \\mathcal{O}(\\Delta t^2).\n$$\n这些公式是通过求解方程组得到的，该方程组逐项匹配泰勒展开式以消除低阶误差项，从而确保二阶精度。\n\n噪声放大分析基于线性性质。设将 $\\{x_j\\}$ 映射到导数估计值 $\\{y_i\\}$ 的有限差分算子是线性的：\n$$\ny_i = \\sum_{j} w_{i,j} x_j,\n$$\n其中 $w_{i,j}$ 是算子权重，包括根据导数阶数由 $\\Delta t$ 的适当次幂进行的归一化。假设测量值包含加性零均值、独立噪声 $\\eta_j$，其方差为 $\\mathbb{V}[\\eta_j] = \\sigma_x^2$。由于线性和独立性，\n$$\n\\mathbb{E}[y_i] = \\sum_{j} w_{i,j} \\mathbb{E}[x_j], \\quad\n\\mathbb{V}[y_i] = \\sum_{j} w_{i,j}^2 \\,\\mathbb{V}[\\eta_j] = \\sigma_x^2 \\sum_{j} w_{i,j}^2.\n$$\n因此，索引 $i$ 处噪声分量的均方根 (RMS) 等于\n$$\n\\sqrt{\\mathbb{V}[y_i]} = \\sigma_x \\sqrt{\\sum_{j} w_{i,j}^2}.\n$$\n在所有索引上计算的全局 RMS（与实践中使用的经验 RMS 一致）为\n$$\ng^{\\text{theory}} = \\sigma_x \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1} \\left(\\sum_{j} w_{i,j}^2\\right)}.\n$$\n该表达式通过与索引相关的权重自然地包含了边界效应。\n\n由此可以得出两个推论：\n- 对于一阶导数，权重与 $1/\\Delta t$ 成比例，因此 $g_v^{\\text{theory}} \\propto \\sigma_x/\\Delta t$；也就是说，如果每个样本的位置噪声水平固定，减小 $\\Delta t$ 会增加速度估计中的噪声放大。\n- 对于二阶导数，权重与 $1/\\Delta t^2$ 成比例，因此 $g_a^{\\text{theory}} \\propto \\sigma_x/\\Delta t^2$，这意味着噪声放大会更强。\n\n通过比较将微分算子应用于带噪声数据和干净数据的结果，可以分离出经验均方根 (RMS) 噪声放大，这样做可以消除确定性的截断误差：\n$$\ng^{\\text{emp}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1} \\left( y_i[x^{\\text{noisy}}] - y_i[x^{\\text{clean}}] \\right)^2 }.\n$$\n因为 $y_i[\\cdot]$ 是线性的，且 $x^{\\text{noisy}} = x^{\\text{clean}} + \\eta$，所以差值等于 $y_i[\\eta]$，其 RMS 在大样本极限下与上面推导的理论表达式相匹配。因此，比率\n$$\nR_v = \\frac{g_v^{\\text{emp}}}{g_v^{\\text{theory}}},\\qquad R_a = \\frac{g_a^{\\text{emp}}}{g_a^{\\text{theory}}},\n$$\n在经验平均具有代表性时应接近于 $1$。\n\n算法设计：\n- 构造时间样本 $t_i = i \\Delta t$，其中 $i=0,\\dots,N-1$，$T=10$ 秒。\n- 根据给定的解析表达式计算干净位置 $x(t_i)$、精确速度 $v(t_i)$ 和精确加速度 $a(t_i)$。\n- 使用固定的种子生成加性噪声 $\\eta_i \\sim \\mathcal{N}(0,\\sigma_x^2)$ 以确保可复现性，并构成 $x^{\\text{noisy}}_i = x(t_i) + \\eta_i$。\n- 实现用于一阶和二阶导数的二阶精度有限差分估计器，其在内部应用中心模板，在边界应用单侧模板，从而对干净和带噪声的输入均得到 $v^{\\text{FD}}$ 和 $a^{\\text{FD}}$。\n- 计算性能指标：$E_v$ 和 $E_a$ 作为相对于精确导数的 RMS 误差。计算 $g_v^{\\text{emp}}$ 和 $g_a^{\\text{emp}}$ 作为有限差分在带噪声和干净数据上输出的 RMS 差值。通过对每个索引处的权重平方求和并取平均，然后乘以 $\\sigma_x$ 并开方，来计算 $g_v^{\\text{theory}}$ 和 $g_a^{\\text{theory}}$。最后，计算 $R_v$ 和 $R_a$ 作为经验放大与理论放大的比率。\n- 对四个指定的测试用例重复上述步骤。将合并的结果以要求的单行、带方括号、逗号分隔的列表形式打印，使用科学记数法并保留六位有效数字。\n\n预期趋势：\n- 将 $\\sigma_x$ 增加 10 倍，应使 $g^{\\text{emp}}$ 以及 $E_v$ 和 $E_a$ 中由噪声主导的分量增加 10 倍。\n- 增加 $\\Delta t$ 会使 $g_v^{\\text{theory}}$ 大致按 $1/\\Delta t$ 减小，使 $g_a^{\\text{theory}}$ 大致按 $1/\\Delta t^2$ 减小；然而，截断误差按 $\\mathcal{O}(\\Delta t^2)$ 增长，因此由于截断误差和噪声放大之间的权衡，$E_v$ 和 $E_a$ 可能不会随 $\\Delta t$ 单调减小。\n- 比率 $R_v$ 和 $R_a$ 应接近 1，从而验证线性噪声放大分析的正确性。",
            "answer": "[1.423985e-01,4.510107e+01,9.993077e-01,9.998492e-01,1.583344e-02,2.164805e+00,9.929858e-01,9.924846e-01,1.414349e+00,4.509748e+02,9.993077e-01,9.998492e-01,1.414969e+00,4.472911e+03,9.999307e-01,9.999849e-01]"
        },
        {
            "introduction": "在许多物理问题中，例如气体动力学中的激波，我们必须处理带有不连续性的函数。虽然高阶格式在处理光滑流场时因其高精度而备受青睐，但它们在不连续点附近可能会引入非物理的振荡，即吉布斯类现象 (Gibbs-like phenomenon)。这个练习将让你亲手实现并观察这一现象，从而学会审慎地将高阶方法应用于非光滑问题，并学习如何量化这些数值伪影 。",
            "id": "2392401",
            "problem": "您需要研究在使用高阶有限差分 (FD) 格式近似不连续周期函数的空间导数时，出现的类似于吉布斯现象 (Gibbs phenomenon) 的行为。考虑在 $[0,2\\pi)$ 上的周期函数 $f(x)$，其定义为\n$$\nf(x) = \\operatorname{sgn}(\\sin x),\n$$\n约定 $\\operatorname{sgn}(0)=1$。所有角度必须以弧度为单位。\n\n设 $N$ 为一个偶数。定义一个均匀网格 $x_j = jh$，其中 $j\\in\\{0,1,\\dots,N-1\\}$，网格间距为 $h = \\frac{2\\pi}{N}$，并施加周期性边界条件，使得索引在模 $N$ 意义下进行计算。对于偶数阶 $p=2m$（其中 $m\\in\\mathbb{N}$），令 $D_h f(x_j)$ 表示在 $x_j$ 点处对 $f$ 的一阶导数的中心、周期性、$p$ 阶有限差分近似，该近似由一个对称的 $(2m+1)$ 点模板构建。也就是说，存在系数 $\\{c_r\\}_{r=-m}^m$（依赖于 $m$ 但不依赖于 $h$ 或 $j$），使得\n$$\nD_h f(x_j) = \\frac{1}{h}\\sum_{r=-m}^{m} c_r\\, f\\big(x_{(j+r)\\bmod N}\\big),\n$$\n并且对于任意次数至多为 $2m$ 的多项式 $q(x)$，当在单位间距的整数网格上求值时，该近似满足 $D_h q(0) = q'(0)$。您必须完全按照所述处理具有周期性边界条件的问题。\n\n为每个 $(N,p)$ 定义以下两个无量纲诊断量：\n1. 峰值放大因子\n$$\nA(N,p) = \\frac{\\max_{0\\le j\\le N-1}\\,\\big|D_h f(x_j)\\big|}{2/h}.\n$$\n2. 溢出均方根 (RMS) 归一化幅值\n$$\nE(N,p) = \\frac{\\left(\\frac{1}{|S|}\\sum_{j\\in S}\\big(D_h f(x_j)\\big)^2\\right)^{1/2}}{2/h},\n$$\n其中 $S$ 是所有网格索引 $j$ 的集合，这些索引与每个不连续点索引的循环索引距离严格大于 $1$。不连续点索引为 $j=0$（对应于 $x=0$）和 $j = N/2$（对应于 $x=\\pi$）。索引 $a$ 和 $b$ 之间的循环索引距离定义为 $d(a,b)=\\min\\{|a-b|,\\,N-|a-b|\\}$。因此，$S$ 排除了索引邻域 $\\{N-1,0,1\\}$ 和 $\\{N/2-1,N/2,N/2+1\\}$。\n\n您的程序必须为以下参数对 $(N,p)$ 的测试套件计算 $A(N,p)$ 和 $E(N,p)$：\n- $(64,2)$,\n- $(64,6)$,\n- $(32,8)$,\n- $(16,4)$,\n- $(10,8)$.\n\n所有计算必须遵循给定的定义。您的最终输出必须是单行，包含一个逗号分隔的浮点数扁平列表，顺序为 $[A(64,2),E(64,2),A(64,6),E(64,6),A(32,8),E(32,8),A(16,4),E(16,4),A(10,8),E(10,8)]$。每个数字必须四舍五入到恰好 $6$ 位小数。例如，输出格式必须类似于\n“[0.123456,0.234567,0.345678,0.456789,0.567890,0.678901,0.789012,0.890123,0.901234,0.012345]”。",
            "solution": "问题陈述经过严格验证，被认定为 **有效**。这是一个在计算物理和数值分析领域中定义明确、具有科学依据的问题。所有提供的参数、定义和约束都是自洽、一致且数学上精确的，从而能够得出一个唯一且有意义的解。该问题研究了将高阶有限差分格式应用于不连续函数时出现的类吉布斯现象，这是数值方法研究中的一个经典课题。\n\n求解过程如下。首先，我们确定通用 $p$ 阶中心有限差分格式的系数。其次，我们在指定网格上对给定函数实施该格式。最后，我们为每个参数对 $(N,p)$ 计算所需的诊断量。\n\n**1. 有限差分系数的确定**\n\n问题指定了一个用于一阶导数的中心、对称、$(2m+1)$ 点、$p=2m$ 阶有限差分近似，其中 $m \\in \\mathbb{N}$。系数 $\\{c_r\\}_{r=-m}^m$ 的确定方法是要求该近似对于任意次数不高于 $p$ 的多项式都是精确的。这等价于满足一组从函数 $g(x)$ 在点 $x_0$ 附近的泰勒级数展开推导出的约束条件。\n该近似由下式给出：\n$$\nD_h g(x_0) = \\frac{1}{h} \\sum_{r=-m}^{m} c_r g(x_0+rh)\n$$\n将泰勒级数 $g(x_0+rh) = \\sum_{k=0}^{\\infty} \\frac{(rh)^k}{k!} g^{(k)}(x_0)$ 代入公式中，得到：\n$$\nD_h g(x_0) = \\frac{1}{h} \\sum_{r=-m}^{m} c_r \\sum_{k=0}^{\\infty} \\frac{(rh)^k}{k!} g^{(k)}(x_0) = \\sum_{k=0}^{\\infty} \\left( \\frac{h^{k-1}}{k!} \\sum_{r=-m}^{m} c_r r^k \\right) g^{(k)}(x_0)\n$$\n为了使该式以 $O(h^p)$ 的误差阶近似 $g'(x_0)$，$g'(x_0)$ 的系数必须为 $1$，而 $g^{(k)}(x_0)$ (其中 $k \\in \\{0, 2, 3, \\dots, p\\}$) 的系数必须为零。这产生以下关于系数 $c_r$ 的矩条件系统：\n$$\n\\sum_{r=-m}^{m} c_r r^k = \\delta_{k,1}, \\quad \\text{for } k=0, 1, \\dots, p=2m\n$$\n其中 $\\delta_{k,1}$ 是克罗内克 delta 符号。\n对于近似一阶导数的中心差分模板，对称性要求 $c_0=0$ 且对于 $r \\neq 0$ 有 $c_r = -c_{-r}$。此对称性自动满足所有偶次幂 $k$ 的条件。\n- 对于 $k=0$，$\\sum c_r = c_0 + \\sum_{r=1}^m (c_r+c_{-r}) = 0$，条件满足。\n- 对于偶数 $k \\ge 2$，$\\sum c_r r^k = c_0 \\cdot 0^k + \\sum_{r=1}^m (c_r r^k + c_{-r}(-r)^k) = \\sum_{r=1}^m (c_r r^k - c_r r^k) = 0$，条件满足。\n\n非平凡的约束来自奇数次幂 $k$：\n$$\n\\sum_{r=-m}^{m} c_r r^k = \\delta_{k,1} \\quad \\text{for odd } k \\in \\{1, 3, \\dots, p-1=2m-1\\}\n$$\n利用对称性，该和式可以简化为：\n$$\n\\sum_{r=1}^m (c_r r^k + c_{-r}(-r)^k) = \\sum_{r=1}^m (c_r r^k - c_r (-1)^k r^k) = 2 \\sum_{r=1}^m c_r r^k = \\delta_{k,1}\n$$\n这为 $m$ 个未知系数 $c_1, \\dots, c_m$ 产生了一个包含 $m$ 个线性方程的方程组：\n$$\n\\sum_{r=1}^{m} c_r r^{2i-1} = \\frac{1}{2} \\delta_{i,1} \\quad \\text{for } i=1, 2, \\dots, m\n$$\n该系统可以写成矩阵形式 $M\\mathbf{c}=\\mathbf{b}$，其中 $\\mathbf{c} = [c_1, \\dots, c_m]^T$，右侧项为 $\\mathbf{b} = [1/2, 0, \\dots, 0]^T$，矩阵 $M$ 的元素为 $M_{ij} = j^{2i-1}$，其中 $i,j \\in \\{1,\\dots,m\\}$。对于每个所需的阶数 $p$，该系统会被数值求解。\n\n**2. 离散化与导数计算**\n\n问题定义在周期域 $[0, 2\\pi)$上，有 $N$ 个网格点 $x_j=jh$（$j \\in \\{0, \\dots, N-1\\}$），网格间距为 $h=2\\pi/N$。待微分的函数是 $f(x) = \\operatorname{sgn}(\\sin x)$，且 $\\operatorname{sgn}(0)=1$。在离散网格上，其值 $f_j = f(x_j)$ 为：\n- $f_j = 1$ 对于 $x_j \\in [0, \\pi]$，对应于索引 $j \\in \\{0, 1, \\dots, N/2\\}$。\n- $f_j = -1$ 对于 $x_j \\in (\\pi, 2\\pi)$，对应于索引 $j \\in \\{N/2+1, \\dots, N-1\\}$。\n该函数在 $x=0$（索引 $j=0$）和 $x=\\pi$（索引 $j=N/2$）处有跳跃间断点。两个跳跃的幅度均为 $2$。\n\n每个网格点 $j$ 处的数值导数 $D_h f(x_j)$ 通过应用有限差分公式计算：\n$$\nD_h f(x_j) = \\frac{1}{h}\\sum_{r=-m}^{m} c_r f_{(j+r)\\bmod N}\n$$\n对索引的取模运算正确地实现了周期性边界条件。\n\n**3. 诊断量的计算**\n\n对于每对 $(N, p)$，从导数值数组（记为 $\\{d_j\\}_{j=0}^{N-1}$，其中 $d_j = D_h f(x_j)$）中计算出两个无量纲诊断量。两个诊断量的归一化因子均为 $2/h$，它代表函数的跳跃幅度除以网格间距。\n\n- 峰值放大因子 $A(N,p)$ 衡量数值导数的最大过冲，并用特征尺度进行归一化：\n$$\nA(N,p) = \\frac{\\max_{0\\le j < N} |d_j|}{2/h}\n$$\n\n- 溢出 RMS 归一化幅值 $E(N,p)$ 衡量了远离不连续点的伪振荡能量。它是在一组特定的索引 $S$ 上计算的，这些索引“远离”不连续点 $j=0$ 和 $j=N/2$。如果一个索引 $j$ 与 $0$ 和 $N/2$ 的循环距离都严格大于 $1$，则 $j$ 属于 $S$。循环距离为 $d(a,b)=\\min\\{|a-b|,\\,N-|a-b|\\}$。此条件排除了索引邻域 $\\{N-1,0,1\\}$ 和 $\\{N/2-1,N/2,N/2+1\\}$。该诊断量则为：\n$$\nE(N,p) = \\frac{\\sqrt{\\frac{1}{|S|}\\sum_{j\\in S} d_j^2}}{2/h}\n$$\n\n**4. 算法实现**\n\n构建了一个 Python 脚本来为给定的测试套件自动化此过程。\n1. 创建一个辅助函数 `get_fd_coeffs(p)` 来求解系数 $c_r$ 的线性方程组。它以阶数 $p$ 为输入，计算 $m=p/2$，构造矩阵 $M$ 和向量 $\\mathbf{b}$，求解 $[c_1, \\dots, c_m]$，并返回完整的对称系数集 $\\{c_r\\}_{r=-m}^m$。\n2. 主函数遍历测试用例列表 $(N, p)$。\n3. 对于每个用例，它初始化网格间距 $h$、根据定义初始化函数数组 $f$，并使用辅助函数计算系数。\n4. 然后，通过在每个网格点应用有限差分模板来计算导数数组 $d$，同时遵守周期性边界。\n5. 根据定义计算诊断量 $A(N,p)$ 和 $E(N,p)$。集合 $S$ 是通过对 NumPy 索引数组进行布尔索引来确定的。\n6. 每个用例计算出的 $A$ 和 $E$ 的值被追加到一个列表中。\n7. 最后，将结果列表格式化为单个字符串，其中每个数字都四舍五入到 $6$ 位小数，并打印到标准输出。\n此过程为问题提供了一个完整且可验证的解决方案。",
            "answer": "[1.015407,0.015407,1.238495,0.055845,1.353386,0.076898,1.144123,0.076939,1.455436,0.000000]"
        }
    ]
}