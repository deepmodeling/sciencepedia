{
    "hands_on_practices": [
        {
            "introduction": "拉克斯等价定理指出，对于一个一致的线性格式，其解收敛的充要条件是格式稳定。本练习将通过冯·诺依曼稳定性分析，指导您推导出一阶迎风格式的稳定性约束，即著名的Courant-Friedrichs-Lewy (CFL) 条件。掌握这种分析方法对于评估和设计可靠的数值格式至关重要。",
            "id": "3972090",
            "problem": "考虑一维空间中的线性平流方程，这是航空航天流动输运建模中计算流体力学（CFD）的一个标准构建模块，\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\n其中 $a>0$ 是一个恒定的对流速度。您在均匀网格 $x_{j} = j\\,\\Delta x$ 和时间层 $t^{n} = n\\,\\Delta t$ 上对该方程进行离散化，时间上使用前向欧拉格式，空间上使用适用于 $a>0$ 的一阶迎风格式。假设采用周期性边界条件，以便可以使用傅里叶表示。\n\n以控制方程和上述离散格式为基础，通过代入单个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)$（其中 $\\theta \\in [-\\pi,\\pi]$）来进行 Von Neumann 傅里叶分析。推导出离散放大因子 $G(\\theta)$，然后通过施加 $|G(\\theta)| \\le 1$ 对所有 $\\theta \\in [-\\pi,\\pi]$ 成立的条件来确定稳定区域。应用 Lax 等价定理（LET）来解释您的稳定性结论与收敛性之间的关系，已知该格式与平流方程是一致的。\n\n作为您的最终答案，报告最大允许时间步长 $\\Delta t_{\\max}$，以 $a$ 和 $\\Delta x$ 的闭式解析表达式形式给出。最终答案以秒为单位表示。无需进行数值四舍五入；给出精确表达式。",
            "solution": "该问题要求对应用于一维线性平流方程的特定有限差分格式进行数值稳定性分析。我们将通过执行 Von Neumann 分析来确定稳定性约束，然后使用 Lax 等价定理将其与数值解的收敛性联系起来。\n\n控制偏微分方程（PDE）是线性平流方程：\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n其中 $u(x,t)$ 是输运量，$a>0$ 是恒定的波速。\n\n问题指定了离散化方法：\n1.  **时间导数 ($u_t$)**：前向欧拉格式。在均匀时间网格 $t^n = n \\Delta t$ 上，其近似为：\n    $$\n    u_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n    $$\n    其中上标 $n$ 表示时间层，下标 $j$ 表示空间网格点。\n\n2.  **空间导数 ($u_x$)**：一阶迎风格式。对于 $a>0$，波从左向右传播，因此我们使用来自“迎风”方向（即较小的 $x$）的信息。在均匀空间网格 $x_j = j \\Delta x$ 上，其近似为：\n    $$\n    u_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}\n    $$\n\n将这些近似代入 PDE，得到完全离散化的方程：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) = 0\n$$\n我们重排此方程以求解下一时间步的解 $u_j^{n+1}$：\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n)\n$$\n我们定义 Courant 数 $C$，它是一个无量纲量，表示数值信息传播速度（$\\Delta x / \\Delta t$）与物理波速（$a$）之比：\n$$\nC = \\frac{a \\Delta t}{\\Delta x}\n$$\n离散方程可以更紧凑地写为：\n$$\nu_j^{n+1} = u_j^n - C(u_j^n - u_{j-1}^n) = (1-C)u_j^n + C u_{j-1}^n\n$$\n这就是我们必须进行稳定性分析的有限差分格式。\n\n接下来，我们进行 Von Neumann 稳定性分析。我们假设解具有单个傅里叶模态的形式：\n$$\nu_j^n = \\hat{u}^n \\exp(i j \\theta)\n$$\n其中 $\\hat{u}^n$ 是时间层 $n$ 处模态的振幅，$i = \\sqrt{-1}$ 是虚数单位，$\\theta = k \\Delta x$ 是无量纲波数，其中 $k$ 是波数。对于周期性区域，$\\theta$ 的范围是 $[-\\pi, \\pi]$。\n将此形式代入我们的离散方程中：\n$$\n\\hat{u}^{n+1} \\exp(i j \\theta) = (1-C) \\hat{u}^n \\exp(i j \\theta) + C \\hat{u}^n \\exp(i (j-1) \\theta)\n$$\n我们可以提出公因子项 $\\exp(i j \\theta)$：\n$$\n\\hat{u}^{n+1} \\exp(i j \\theta) = \\left[ (1-C) + C \\exp(-i \\theta) \\right] \\hat{u}^n \\exp(i j \\theta)\n$$\n两边同除以 $\\hat{u}^n \\exp(i j \\theta)$（假设存在非平凡解），我们得到放大因子 $G(\\theta)$ 的表达式，该因子是傅里叶模态的振幅在单个时间步内被乘的系数：\n$$\nG(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n} = 1 - C + C \\exp(-i \\theta)\n$$\n使用欧拉公式 $\\exp(-i \\theta) = \\cos(\\theta) - i \\sin(\\theta)$，我们可以用其实部和虚部来表示 $G(\\theta)$：\n$$\nG(\\theta) = (1 - C + C \\cos(\\theta)) - i (C \\sin(\\theta))\n$$\n为了使数值格式稳定，任何傅里叶模态的振幅都不能随时间增长。这要求放大因子的模对于所有可能的 $\\theta$ 值都小于或等于1：\n$$\n|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\n我们可以通过考察模的平方 $|G(\\theta)|^2$ 来分析这个条件：\n$$\n|G(\\theta)|^2 = (\\operatorname{Re}(G))^2 + (\\operatorname{Im}(G))^2\n$$\n$$\n|G(\\theta)|^2 = (1 - C + C \\cos(\\theta))^2 + (-C \\sin(\\theta))^2\n$$\n$$\n|G(\\theta)|^2 = (1 - C(1 - \\cos(\\theta)))^2 + C^2 \\sin^2(\\theta)\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1 - \\cos(\\theta)) + C^2(1 - \\cos(\\theta))^2 + C^2 \\sin^2(\\theta)\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1 - \\cos(\\theta)) + C^2(1 - 2\\cos(\\theta) + \\cos^2(\\theta)) + C^2 \\sin^2(\\theta)\n$$\n使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$\n|G(\\theta)|^2 = 1 - 2C(1 - \\cos(\\theta)) + C^2(1 - 2\\cos(\\theta) + 1)\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1 - \\cos(\\theta)) + 2C^2(1 - \\cos(\\theta))\n$$\n$$\n|G(\\theta)|^2 = 1 + (2C^2 - 2C)(1 - \\cos(\\theta))\n$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 变为：\n$$\n1 + (2C^2 - 2C)(1 - \\cos(\\theta)) \\le 1\n$$\n$$\n(2C^2 - 2C)(1 - \\cos(\\theta)) \\le 0\n$$\n$$\n2C(C - 1)(1 - \\cos(\\theta)) \\le 0\n$$\n我们分析这个不等式中的各项。根据定义，$a>0$，$\\Delta t>0$ 和 $\\Delta x>0$，所以 Courant 数 $C \\ge 0$。项 $(1 - \\cos(\\theta))$ 总是非负的，因为 $\\cos(\\theta) \\le 1$。因此，为了使不等式对所有 $\\theta$ 都成立，项 $2C(C-1)$ 必须非正。由于 $C \\ge 0$，这要求：\n$$\nC - 1 \\le 0 \\implies C \\le 1\n$$\n综合这些条件，该格式的稳定区域是 $0 \\le C \\le 1$。\n\nLax 等价定理（LET）指出，对于一个线性初值问题，一个一致的有限差分格式是收敛的，当且仅当它是稳定的。问题指出该格式是一致的。对截断误差的简要检查证实，该格式在时间和空间上都是一阶精确的，$O(\\Delta t, \\Delta x)$，因此是一致的（当 $\\Delta t, \\Delta x \\to 0$ 时，截断误差趋于零）。\n\n因此，根据 Lax 等价定理，我们的数值解将收敛到偏微分方程的真实解，当且仅当满足稳定性判据时。稳定性判据是：\n$$\n0 \\le \\frac{a \\Delta t}{\\Delta x} \\le 1\n$$\n题目要求的是最大允许时间步长 $\\Delta t_{\\max}$，它对应于此稳定区间的上界：\n$$\n\\frac{a \\Delta t_{\\max}}{\\Delta x} = 1\n$$\n解出 $\\Delta t_{\\max}$ 可得：\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{a}\n$$\n这就是该显式格式的 Courant-Friedrichs-Lewy (CFL) 条件。其物理上的解释是，在单个时间步内，数值依赖域必须包含物理依赖域。在一个时间步 $\\Delta t$ 内，波传播的距离为 $a \\Delta t$。为了使格式能够正确地捕捉波的传播，这个距离不能大于空间网格间距 $\\Delta x$。该表达式具有时间单位（例如，如果 $\\Delta x$ 以米为单位，而 $a$ 以米/秒为单位，则结果以秒为单位），正如题目所要求。",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{a}}\n$$"
        },
        {
            "introduction": "除了稳定性，一致性是拉克斯等价定理的另一个基石，它确保离散格式在网格无限加密时能够逼近原始的偏微分方程。本练习将通过对Lax-Friedrichs格式进行泰勒级数展开，向您展示如何计算截断误差并推导修正方程。通过这个过程，您将能识别出格式中隐含的人工黏性，这是理解数值耗散的关键一步。",
            "id": "3972069",
            "problem": "航空航天计算流体动力学 (CFD) 通常使用一维线性平流方程来模拟扰动的输运，其无量纲形式为 $u_{t} + a\\,u_{x} = 0$，其中 $u(x,t)$ 足够光滑，$a$ 是一个恒定的波速。考虑用于此方程的 Lax–Friedrichs 有限差分格式，\n$$\nu^{n+1}_{j} = \\frac{1}{2}\\left(u^{n}_{j+1} + u^{n}_{j-1}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right),\n$$\n其中 $u^{n}_{j}$ 近似 $u(x_{j}, t^{n})$，空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 均为匀值。从局部截断误差和一致性的定义出发，使用在点 $(x_{j}, t^{n})$ 附近的泰勒级数展开，推导此格式所近似的主阶修正方程。使用原始的偏微分方程消去时间导数，以空间导数取而代之，并辨识出修正方程中乘以 $u_{xx}$ 的系数，作为该格式的人工扩散，记作 $D(\\Delta x, \\Delta t, a)$。根据你的推导，确认对于足够光滑的 $u$，该格式在时间上是一阶一致的，在空间上是二阶一致的。最后，对于参数值 $\\Delta t = 0.004$，$\\Delta x = 0.02$ 和 $a = 1$，计算 $D(\\Delta x, \\Delta t, a)$ 的数值。将人工扩散系数以无量纲单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导应用于线性平流方程的 Lax-Friedrichs 格式的主阶修正方程，辨识和计算人工扩散系数，并确认一致性的阶数。\n\n一维线性平流方程由下式给出：\n$$u_{t} + a\\,u_{x} = 0$$\n其中 $u=u(x,t)$ 是一个足够光滑的函数，$u_t = \\frac{\\partial u}{\\partial t}$，$u_x = \\frac{\\partial u}{\\partial x}$，且 $a$ 是一个恒定的波速。\n\nLax-Friedrichs 有限差分格式为：\n$$u^{n+1}_{j} = \\frac{1}{2}\\left(u^{n}_{j+1} + u^{n}_{j-1}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right)$$\n这里，$u^n_j$ 是精确解 $u(x_j, t_n)$ 的数值近似，其中 $x_j=j\\Delta x$ 且 $t_n=n\\Delta t$。\n\n为了推导修正方程，我们用格式中每一项在点 $(x_j, t_n)$ 附近的泰勒级数展开进行代换。令 $u$ 及其导数（$u_t$, $u_x$, $u_{xx}$ 等）表示它们在点 $(x_j, t_n)$ 处的值。\n\n左侧（LHS）的泰勒展开为：\n$$u^{n+1}_{j} = u(x_j, t_n+\\Delta t) = u + \\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2!}u_{tt} + \\frac{(\\Delta t)^3}{3!}u_{ttt} + O((\\Delta t)^4)$$\n\n右侧（RHS）各项的泰勒展开为：\n$$u^{n}_{j+1} = u(x_j+\\Delta x, t_n) = u + \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2!}u_{xx} + \\frac{(\\Delta x)^3}{3!}u_{xxx} + \\frac{(\\Delta x)^4}{4!}u_{xxxx} + O((\\Delta x)^5)$$\n$$u^{n}_{j-1} = u(x_j-\\Delta x, t_n) = u - \\Delta x\\,u_x + \\frac{(\\Delta x)^2}{2!}u_{xx} - \\frac{(\\Delta x)^3}{3!}u_{xxx} + \\frac{(\\Delta x)^4}{4!}u_{xxxx} + O((\\Delta x)^5)$$\n\n我们构造格式中出现的组合：\n$$\\frac{1}{2}\\left(u^{n}_{j+1} + u^{n}_{j-1}\\right) = \\frac{1}{2}\\left(2u + (\\Delta x)^2 u_{xx} + \\frac{(\\Delta x)^4}{12} u_{xxxx} + O((\\Delta x)^6)\\right) = u + \\frac{(\\Delta x)^2}{2}u_{xx} + \\frac{(\\Delta x)^4}{24}u_{xxxx} + O((\\Delta x)^6)$$\n$$\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) = \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(2\\Delta x\\,u_x + \\frac{(\\Delta x)^3}{3}u_{xxx} + O((\\Delta x)^5)\\right) = a\\,\\Delta t\\,u_x + \\frac{a\\,\\Delta t\\,(\\Delta x)^2}{6}u_{xxx} + O(\\Delta t(\\Delta x)^4)$$\n\n现在，我们令展开后的 LHS 和 RHS 相等：\n$$u + \\Delta t\\,u_t + \\frac{(\\Delta t)^2}{2}u_{tt} + \\dots = \\left(u + \\frac{(\\Delta x)^2}{2}u_{xx} + \\dots\\right) - \\left(a\\,\\Delta t\\,u_x + \\frac{a\\,\\Delta t\\,(\\Delta x)^2}{6}u_{xxx} + \\dots\\right)$$\n\n重新整理各项以匹配原始偏微分方程的形式：\n$$\\Delta t\\,u_t + a\\,\\Delta t\\,u_x = \\frac{(\\Delta x)^2}{2}u_{xx} - \\frac{(\\Delta t)^2}{2}u_{tt} - \\frac{a\\,\\Delta t\\,(\\Delta x)^2}{6}u_{xxx} + \\dots$$\n两边同除以 $\\Delta t$：\n$$u_t + a\\,u_x = \\frac{(\\Delta x)^2}{2\\Delta t}u_{xx} - \\frac{\\Delta t}{2}u_{tt} - \\frac{a\\,(\\Delta x)^2}{6}u_{xxx} + \\dots$$\n这是修正方程，但其右侧包含了时间导数。为了得到仅含空间导数的主阶修正方程，我们必须消去 $u_{tt}$。我们使用推导出的方程本身。在最低阶上，修正方程表明 $u_t = -a\\,u_x + O(\\frac{(\\Delta x)^2}{\\Delta t}, \\Delta t)$。对时间求导得到 $u_{tt} = \\frac{\\partial}{\\partial t}(-a\\,u_x + \\dots) = -a\\,u_{xt} + \\dots$。对同样最低阶关系式对空间求导得到 $u_{xt} = -a\\,u_{xx} + \\dots$。结合这些，我们发现在所需阶数上，$u_{tt} = a^2 u_{xx} + \\dots$。\n\n将此代入修正方程：\n$$u_t + a\\,u_x = \\frac{(\\Delta x)^2}{2\\Delta t}u_{xx} - \\frac{\\Delta t}{2}(a^2 u_{xx}) + O((\\Delta x)^2, (\\Delta t)^2, \\Delta t (\\Delta x)^2)$$\n$$u_t + a\\,u_x = \\left(\\frac{(\\Delta x)^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2}\\right)u_{xx} + \\dots$$\n这是主阶修正方程。该格式求解的方程不是纯粹的平流方程，而是一个平流-扩散方程。$u_{xx}$ 项的系数是该格式的人工扩散（或数值扩散/数值黏性）。\n\n因此，人工扩散系数 $D(\\Delta x, \\Delta t, a)$ 为：\n$$D(\\Delta x, \\Delta t, a) = \\frac{(\\Delta x)^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2}$$\n\n接下来，我们确认一致性的阶数。局部截断误差 $\\tau$ 是将原始偏微分方程的精确解代入归一化差分格式后得到的余项。从修正方程的推导中，截断误差对应于添加到原始偏微分方程中的项：\n$$\\tau = u_t + a\\,u_x - (u_t + a\\,u_x)_{\\text{scheme}} = - \\left[ \\left(\\frac{(\\Delta x)^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2}\\right)u_{xx} + \\dots \\right]$$\n如果当 $\\Delta x, \\Delta t \\to 0$ 时 $\\tau \\to 0$，则该格式是一致的。对于这样的显式格式，稳定性（通过 Courant-Friedrichs-Lewy 条件）要求 $\\Delta t$ 和 $\\Delta x$ 以相关的方式趋于零，通常是保持 $\\frac{\\Delta t}{\\Delta x}$ 为常数（即，对于某个常数 $k$，有 $\\Delta t = k \\Delta x$）。在此条件下：\n$$\\tau = - \\left(\\frac{(\\Delta x)^2}{2k\\Delta x} - \\frac{a^2k\\Delta x}{2}\\right)u_{xx} + \\dots = - \\left(\\frac{1}{2k} - \\frac{a^2k}{2}\\right)\\Delta x\\,u_{xx} + \\dots = O(\\Delta x)$$\n由于 $\\Delta t$ 也是 $O(\\Delta x)$，该格式是一阶一致的，即 $\\tau = O(\\Delta t, \\Delta x)$。\n\n“该格式在时间上是一阶一致的，在空间上是二阶一致的”这一说法指的是单个离散化选择的属性。时间演化基于向前差分，其在时间上是一阶精确的。空间算子 $\\frac{1}{2}(u^n_{j+1} + u^n_{j-1})$ 和 $\\frac{1}{2\\Delta x}(u^n_{j+1} - u^n_{j-1})$ 基于中心差分格式，并且在空间上各自是二阶精确的。然而，它们在 Lax-Friedrichs 格式中的组合引入了一个主导误差项，表现为人工扩散，这将整体精度降低到一阶。\n\n最后，我们计算给定参数下人工扩散系数 $D$ 的数值：$\\Delta t = 0.004$，$\\Delta x = 0.02$，以及 $a = 1$。\n$$D = \\frac{(\\Delta x)^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2} = \\frac{(0.02)^2}{2(0.004)} - \\frac{(1)^2(0.004)}{2}$$\n$$D = \\frac{0.0004}{0.008} - \\frac{0.004}{2}$$\n$$D = 0.05 - 0.002$$\n$$D = 0.048$$\n问题指定了无量纲单位，并要求四舍五入到四位有效数字。\n$$D = 0.04800$$",
            "answer": "$$\\boxed{0.04800}$$"
        },
        {
            "introduction": "理论分析与数值实验相结合，能够最深刻地揭示科学原理。本练习提供了一个绝佳的机会，通过编码实践来验证拉克斯等价定理的核心论断：一个一致但非稳定的格式无法收敛。您将实现经典的前向时间中心空间（FTCS）格式，并亲眼观察到即使在网格加密时，数值误差非但不会减小，反而会爆炸式增长，从而体验到稳定性在计算流体动力学中的决定性作用。",
            "id": "3972054",
            "problem": "考虑来自计算流体力学 (CFD) 的线性平流初边值问题 (IBVP)：寻找一个足够光滑的标量场 $u(x,t)$，使得\n$$\nu_t + a\\,u_x = 0 \\quad \\text{for } x \\in [0,1], \\ t \\ge 0,\n$$\n满足周期性边界条件 $u(0,t) = u(1,t)$ 和初始条件\n$$\nu(x,0) = \\sin(2\\pi x) + \\tfrac{1}{2}\\cos(6\\pi x).\n$$\n此处 $a > 0$ 是一个恒定的平流速度。精确解由平移给出\n$$\nu(x,t) = u_0(x - a t \\bmod 1).\n$$\n问题在于构建一个最小的反例测试，通过实现一个一致但不稳定的时间推进有限差分法，来凸显 Lax 等价定理中稳定性的必要性，然后数值地证明当网格加密时该方法不收敛。\n\n在具有 $N$ 个点的均匀网格上使用前向时间中心空间 (FTCS) 格式，网格间距为 $\\Delta x = 1/N$，时间步长使用 Courant–Friedrichs–Lewy (CFL) 数 $\\text{CFL} \\in (0,1)$ 选择为\n$$\n\\Delta t \\approx \\frac{\\text{CFL}\\,\\Delta x}{a},\n$$\n并进行调整，以确保在整数个时间步后恰好达到最终时间 $T$。记 $\\sigma = a \\,\\Delta t / \\Delta x$。FTCS 的更新方式为\n$$\nu_j^{n+1} = u_j^n - \\frac{\\sigma}{2} \\left( u_{j+1}^n - u_{j-1}^n \\right),\n$$\n其中索引是周期性的。将时间 $T$ 时的数值解与在网格上采样的精确解 $u(x,T)$ 进行比较，误差用离散 $L^2$ 范数衡量\n$$\n\\| e \\|_2 = \\left( \\Delta x \\sum_{j=0}^{N-1} \\left( u_j^{\\text{num}}(T) - u_j^{\\text{exact}}(T) \\right)^2 \\right)^{1/2}.\n$$\n由于问题是无量纲的，因此不需要物理单位；角度隐含地以弧度为单位。\n\n你的任务是实现上述 FTCS 格式，并针对下面的每个测试场景，计算三种网格分辨率 $N \\in \\{50, 100, 200\\}$ 下的离散 $L^2$ 误差。对于每个场景，还要确定一个布尔标志，当且仅当误差随着 $N$ 的增加而严格减小（即 $E_{100}  E_{50}$ 且 $E_{200}  E_{100}$）时，该标志为真，否则为假。该标志是该场景下网格加密时收敛性的数值指标。\n\n测试套件：\n- 场景 1 (理想情况)：$a = 1.0$, $T = 0.2$, $\\text{CFL} = 0.8$。\n- 场景 2 (短时间内的边界情况)：$a = 1.0$, $T = 0.01$, $\\text{CFL} = 0.8$。\n- 场景 3 (极小 CFL 的边缘情况)：$a = 1.0$, $T = 0.2$, $\\text{CFL} = 0.1$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个场景对应一个条目。每个场景的条目本身必须是一个带括号的逗号分隔列表，按顺序包含四项内容：$N = 50, 100, 200$ 时的三个离散 $L^2$ 误差，后跟收敛标志。例如，输出格式必须为\n$$\n[ [E_{50}^{(1)}, E_{100}^{(1)}, E_{200}^{(1)}, \\text{flag}^{(1)}], [E_{50}^{(2)}, E_{100}^{(2)}, E_{200}^{(2)}, \\text{flag}^{(2)}], [E_{50}^{(3)}, E_{100}^{(3)}, E_{200}^{(3)}, \\text{flag}^{(3)}] ].\n$$\n所有数值输出必须是实数（浮点数）或布尔值，并且最终输出必须是完全符合规定的单行。",
            "solution": "用户提供的问题是计算科学中的一个有效练习。它要求数值地展示违反 Lax 等价定理中有限差分格式稳定性条件的后果。该问题具有科学依据，是适定的，并且所有参数和方法都得到了明确的定义。\n\n问题的核心是线性平流方程：\n$$ u_t + a u_x = 0 $$\n针对空间域 $x \\in [0,1]$ 上具有周期性边界条件的标量场 $u(x,t)$。初始条件由 $u(x,0) = u_0(x) = \\sin(2\\pi x) + \\frac{1}{2}\\cos(6\\pi x)$ 给出。精确解是初始轮廓的简单平移：$u(x,t) = u_0(x - a t \\pmod 1)$。\n\n问题指定使用前向时间中心空间 (FTCS) 有限差分格式。对于间距为 $\\Delta x$ 的均匀网格和时间步长 $\\Delta t$，该格式将偏微分方程近似为：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x} = 0 $$\n其中 $u_j^n \\approx u(j\\Delta x, n\\Delta t)$。这可以重排为一个显式的更新规则：\n$$ u_j^{n+1} = u_j^n - \\frac{\\sigma}{2} (u_{j+1}^n - u_{j-1}^n) $$\n此处，$\\sigma$ 是 Courant 数，定义为 $\\sigma = a \\Delta t / \\Delta x$。\n\nLax 等价定理指出，对于一个线性的、适定的初值问题，一个一致的有限差分格式收敛的充要条件是它是稳定的。\n*   **一致性**：FTCS 格式与平流方程是一致的。泰勒级数展开表明，其局部截断误差的阶数为 $O(\\Delta t, \\Delta x^2)$。\n*   **稳定性**：稳定性可以使用 von Neumann 方法进行分析。我们寻找形式为 $u_j^n = G^n e^{i k x_j}$ 的解，其中 $k$ 是波数，$G$ 是放大因子。将此代入 FTCS 格式可得：\n$$ G = 1 - \\frac{\\sigma}{2} (e^{i k \\Delta x} - e^{-i k \\Delta x}) = 1 - i \\sigma \\sin(k \\Delta x) $$\n为保证稳定性，放大因子的大小 $|G|$ 对于所有可能的波数都不能超过 $1$。其大小的平方为：\n$$ |G|^2 = 1^2 + (-\\sigma \\sin(k \\Delta x))^2 = 1 + \\sigma^2 \\sin^2(k \\Delta x) $$\n对于任何非零的 $\\sigma$ 和任何非 $\\pi$ 整数倍的 $k\\Delta x$，都有 $|G|^2  1$。这意味着误差分量（尤其是高频分量）将在每个时间步被放大，导致指数级增长。因此，对于纯平流问题，该格式是无条件不稳定的。\n\n根据 Lax 等价定理，由于 FTCS 格式是一致但不稳定的，它在网格加密时不会收敛。该数值实验旨在证明这种不收敛性。\n\n实现计划如下：\n1.  对于每个测试场景 $(a, T, \\text{CFL})$，我们遍历网格分辨率 $N \\in \\{50, 100, 200\\}$。\n2.  对于每个 $N$，我们建立网格，其 $\\Delta x = 1/N$，点为 $x_j = j \\Delta x$。\n3.  确定时间步数 $N_t$，以恰好匹配最终时间 $T$。我们估计 $N_t \\approx aTN/\\text{CFL}$，然后取其向上取整：$N_t = \\lceil aTN/\\text{CFL} \\rceil$。时间步长则为 $\\Delta t = T/N_t$。\n4.  通过在网格上采样 $u_0(x)$ 来设置初始状态 $u^0$。\n5.  使用 FTCS 更新规则将状态推进 $N_t$ 次。通过循环数组索引来处理周期性边界条件。\n6.  将最终的数值解 $u^{\\text{num}}(T)$ 与在同一网格上采样的精确解 $u^{\\text{exact}}(T)$ 进行比较。误差使用离散 $L^2$ 范数量化：\n    $$ \\| e \\|_2 = \\left( \\Delta x \\sum_{j=0}^{N-1} \\left( u_j^{\\text{num}}(T) - u_j^{\\text{exact}}(T) \\right)^2 \\right)^{1/2} $$\n7.  在计算完所有三个 $N$ 值的误差后，设置一个收敛标志。如果每次加密时误差都严格减小（$E_{100}  E_{50}$ 且 $E_{200}  E_{100}$），则为 `True`，否则为 `False`。\n8.  由于不稳定性，我们通常期望该标志为 `False`，除非在模拟时间 $T$ 非常短的情况下，此时指数级误差增长尚未压倒截断误差的减小。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef run_scenario(a, T, CFL, N_vals):\n    \"\"\"\n    Runs the FTCS simulation for a given scenario and a list of grid resolutions.\n\n    Args:\n        a (float): Advection speed.\n        T (float): Final time.\n        CFL (float): CFL number to determine time step.\n        N_vals (list of int): List of grid resolutions (number of points).\n\n    Returns:\n        list: A list containing the L2 errors for each resolution and the convergence flag.\n    \"\"\"\n    errors = []\n    \n    # Initial condition function\n    def u_initial(x):\n        return np.sin(2 * np.pi * x) + 0.5 * np.cos(6 * np.pi * x)\n\n    # Exact solution function\n    def u_exact(x, t):\n        # The modulo operator correctly handles the periodicity for x-at\n        return u_initial((x - a * t) % 1.0)\n\n    for N in N_vals:\n        # Spatial grid setup\n        dx = 1.0 / N\n        x = np.linspace(0, 1, N, endpoint=False)\n\n        # Time step setup\n        # Adjust dt so that T is reached in an integer number of steps\n        Nt_approx = a * T * N / CFL\n        Nt = int(math.ceil(Nt_approx))\n        # Handle case where Nt is 0 for very small T\n        if Nt == 0:\n            Nt = 1 \n        dt = T / Nt\n        \n        # Courant number\n        sigma = a * dt / dx\n\n        # Set initial condition\n        u = u_initial(x)\n\n        # Time-marching loop\n        for n in range(Nt):\n            u_prev = u.copy()\n            # Implement periodic boundaries using numpy.roll\n            u_plus_1 = np.roll(u_prev, -1)\n            u_minus_1 = np.roll(u_prev, 1)\n            \n            # FTCS update\n            u = u_prev - (sigma / 2.0) * (u_plus_1 - u_minus_1)\n\n        # Calculate exact solution at time T\n        u_ex = u_exact(x, T)\n\n        # Calculate discrete L2 error\n        error_vec = u - u_ex\n        l2_error = np.sqrt(dx * np.sum(error_vec**2))\n        errors.append(l2_error)\n\n    # Check for convergence: error must strictly decrease with refinement\n    is_convergent = (errors[1]  errors[0]) and (errors[2]  errors[1])\n\n    return [errors[0], errors[1], errors[2], is_convergent]\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the specified test suite.\n    \"\"\"\n    test_cases = [\n        {'a': 1.0, 'T': 0.2, 'CFL': 0.8},  # Scenario 1\n        {'a': 1.0, 'T': 0.01, 'CFL': 0.8}, # Scenario 2\n        {'a': 1.0, 'T': 0.2, 'CFL': 0.1},  # Scenario 3\n    ]\n    \n    N_values = [50, 100, 200]\n    \n    results = []\n    for case in test_cases:\n        scenario_result = run_scenario(case['a'], case['T'], case['CFL'], N_values)\n        results.append(scenario_result)\n\n    # Format the output string as per the requirements\n    # e.g., [[err1,err2,err3,flag], [err1,err2,err3,flag]]\n    result_strings = []\n    for res in results:\n        # str(bool) gives 'True' or 'False' as required\n        inner_str = f\"[{res[0]},{res[1]},{res[2]},{res[3]}]\"\n        result_strings.append(inner_str)\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}