{
    "hands_on_practices": [
        {
            "introduction": "在计算流体力学中，将连续的偏微分方程转化为离散的代数方程是核心步骤，而这一转化过程的精度直接决定了最终仿真结果的可靠性。本练习将指导您使用泰勒级数展开这一基本工具，来系统地构建一个用于二阶导数的高阶（四阶）中心差分格式。通过这个过程，您不仅将学习如何推导数值格式，还将深入理解截断误差的概念，这是量化离散化精度的关键，为您设计和分析更复杂的数值方法奠定坚实的数学基础 。",
            "id": "3955828",
            "problem": "考虑一个光滑标量场 $u(x)$，它代表了航空航天应用中计算流体力学 (CFD) 范围内流动变量的一个一维切片。您的任务是在一个间距为 $h$ 的均匀网格上，仅使用模板点 $x_{i-2}$、$x_{i-1}$、$x_{i}$、$x_{i+1}$ 和 $x_{i+2}$，构造在网格节点 $x_{i}$ 处二阶偏导数 $\\partial_{xx} u$ 的中心有限差分近似。从导数的基本定义和 $u(x)$ 在 $x_{i}$ 点的泰勒级数展开出发，推导一个形如下式的线性组合\n$$\n\\frac{1}{h^{2}}\\left(a_{0}\\,u(x_{i}) + a_{1}\\,\\big[u(x_{i+1}) + u(x_{i-1})\\big] + a_{2}\\,\\big[u(x_{i+2}) + u(x_{i-2})\\big]\\right)\n$$\n该线性组合以四阶精度近似 $\\partial_{xx} u(x_{i})$。通过以下关系式定义主截断误差系数 $C$\n$$\n\\frac{1}{h^{2}}\\left(a_{0}\\,u(x_{i}) + a_{1}\\,\\big[u(x_{i+1}) + u(x_{i-1})\\big] + a_{2}\\,\\big[u(x_{i+2}) + u(x_{i-2})\\big]\\right) \\;=\\; \\partial_{xx} u(x_{i}) \\;+\\; C\\,h^{4}\\,\\partial_{x}^{6}u(x_{i}) \\;+\\; \\mathcal{O}(h^{6}),\n$$\n其中 $\\partial_{x}^{6}u$ 表示 $u$ 对 $x$ 的六阶导数。使用泰勒级数，通过强制要求四阶精度来确定系数 $a_{0}$、$a_{1}$ 和 $a_{2}$，然后计算您的构造所蕴含的 $C$ 的精确值。请以精确有理数的形式提供 $C$。最终答案不需要单位。不要四舍五入；请给出最简分数。",
            "solution": "所述问题在科学上是合理的、适定的、客观的，并包含足够的信息以获得唯一解。这是使用泰勒级数分析推导有限差分格式的一个标准练习。因此，该问题被认为是有效的。\n\n目标是找到在网格节点 $x_i$ 处二阶导数 $\\partial_{xx} u$ 的一个有限差分近似，其形式为：\n$$\n\\frac{1}{h^{2}}\\left(a_{0}\\,u(x_{i}) + a_{1}\\,\\big[u(x_{i+1}) + u(x_{i-1})\\big] + a_{2}\\,\\big[u(x_{i+2}) + u(x_{i-2})\\big]\\right)\n$$\n这个近似必须是四阶精度的，这意味着它的泰勒级数展开必须与 $\\partial_{xx} u(x_i)$ 的泰勒级数展开在 $\\mathcal{O}(h^4)$ 阶项之前都相匹配。我们首先写出函数 $u(x)$ 在模板点 $x_{i \\pm 1}$ 和 $x_{i \\pm 2}$ 处围绕中心点 $x_i$ 的泰勒级数展开。令 $u_j = u(x_j)$ 且 $u_i^{(k)} = \\partial_x^k u(x_i)$。均匀网格间距为 $h$，所以 $x_{i \\pm n} = x_i \\pm n h$。\n\n泰勒级数展开式为：\n$$u_{i+1} = u_i + h u_i^{(1)} + \\frac{h^2}{2!} u_i^{(2)} + \\frac{h^3}{3!} u_i^{(3)} + \\frac{h^4}{4!} u_i^{(4)} + \\frac{h^5}{5!} u_i^{(5)} + \\frac{h^6}{6!} u_i^{(6)} + \\mathcal{O}(h^7)$$\n$$u_{i-1} = u_i - h u_i^{(1)} + \\frac{h^2}{2!} u_i^{(2)} - \\frac{h^3}{3!} u_i^{(3)} + \\frac{h^4}{4!} u_i^{(4)} - \\frac{h^5}{5!} u_i^{(5)} + \\frac{h^6}{6!} u_i^{(6)} + \\mathcal{O}(h^7)$$\n$$u_{i+2} = u_i + (2h) u_i^{(1)} + \\frac{(2h)^2}{2!} u_i^{(2)} + \\frac{(2h)^3}{3!} u_i^{(3)} + \\frac{(2h)^4}{4!} u_i^{(4)} + \\frac{(2h)^5}{5!} u_i^{(5)} + \\frac{(2h)^6}{6!} u_i^{(6)} + \\mathcal{O}(h^7)$$\n$$u_{i-2} = u_i - (2h) u_i^{(1)} + \\frac{(2h)^2}{2!} u_i^{(2)} - \\frac{(2h)^3}{3!} u_i^{(3)} + \\frac{(2h)^4}{4!} u_i^{(4)} - \\frac{(2h)^5}{5!} u_i^{(5)} + \\frac{(2h)^6}{6!} u_i^{(6)} + \\mathcal{O}(h^7)$$\n\n所提出的格式使用了这些点的对称组合。将成对的展开式相加可以消去所有奇数阶导数项：\n$$u_{i+1} + u_{i-1} = 2u_i + 2\\frac{h^2}{2!}u_i^{(2)} + 2\\frac{h^4}{4!}u_i^{(4)} + 2\\frac{h^6}{6!}u_i^{(6)} + \\mathcal{O}(h^8)$$\n$$u_{i+1} + u_{i-1} = 2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12}u_i^{(4)} + \\frac{h^6}{360}u_i^{(6)} + \\mathcal{O}(h^8)$$\n对于更外侧的点：\n$$u_{i+2} + u_{i-2} = 2u_i + 2\\frac{(2h)^2}{2!}u_i^{(2)} + 2\\frac{(2h)^4}{4!}u_i^{(4)} + 2\\frac{(2h)^6}{6!}u_i^{(6)} + \\mathcal{O}(h^8)$$\n$$u_{i+2} + u_{i-2} = 2u_i + 4h^2 u_i^{(2)} + \\frac{16h^4}{12}u_i^{(4)} + \\frac{64h^6}{360}u_i^{(6)} + \\mathcal{O}(h^8)$$\n$$u_{i+2} + u_{i-2} = 2u_i + 4h^2 u_i^{(2)} + \\frac{4}{3}h^4 u_i^{(4)} + \\frac{8}{45}h^6 u_i^{(6)} + \\mathcal{O}(h^8)$$\n\n现在，我们将这些和代入有限差分算子的一般形式。令 $L[u]$ 为该算子。\n$$L[u] = \\frac{1}{h^2} \\left( a_0 u_i + a_1(u_{i+1} + u_{i-1}) + a_2(u_{i+2} + u_{i-2}) \\right)$$\n$$L[u] = \\frac{1}{h^2} \\left[ a_0 u_i + a_1 \\left( 2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12}u_i^{(4)} + \\frac{h^6}{360}u_i^{(6)} \\right) + a_2 \\left( 2u_i + 4h^2 u_i^{(2)} + \\frac{4}{3}h^4 u_i^{(4)} + \\frac{8}{45}h^6 u_i^{(6)} \\right) + \\mathcal{O}(h^8) \\right]$$\n我们根据 $u$ 在 $x_i$ 处的导数阶数来合并各项：\n$$L[u] = \\frac{1}{h^2} \\left[ (a_0 + 2a_1 + 2a_2)u_i + (a_1 + 4a_2)h^2 u_i^{(2)} + \\left(\\frac{a_1}{12} + \\frac{4a_2}{3}\\right)h^4 u_i^{(4)} + \\left(\\frac{a_1}{360} + \\frac{8a_2}{45}\\right)h^6 u_i^{(6)} + \\mathcal{O}(h^8) \\right]$$\n$$L[u] = \\frac{(a_0 + 2a_1 + 2a_2)}{h^2} u_i + (a_1 + 4a_2) u_i^{(2)} + \\left(\\frac{a_1}{12} + \\frac{4a_2}{3}\\right)h^2 u_i^{(4)} + \\left(\\frac{a_1}{360} + \\frac{8a_2}{45}\\right)h^4 u_i^{(6)} + \\mathcal{O}(h^6)$$\n为使此表达式成为 $u_i^{(2)} = \\partial_{xx} u(x_i)$ 的四阶精度近似，系数必须满足以下条件：\n\\begin{enumerate}\n    \\item $u_i$ 的系数必须为零：$a_0 + 2a_1 + 2a_2 = 0$。\n    \\item $u_i^{(2)}$ 的系数必须为一：$a_1 + 4a_2 = 1$。\n    \\item $u_i^{(4)}$ 的系数必须为零，以消去 $\\mathcal{O}(h^2)$ 误差项：$\\frac{a_1}{12} + \\frac{4a_2}{3} = 0$。\n\\end{enumerate}\n我们求解这个关于 $a_0$、$a_1$ 和 $a_2$ 的三元线性方程组。由第三个方程可得：\n$$\\frac{a_1}{12} = -\\frac{4a_2}{3} \\implies a_1 = -16a_2$$\n将此代入第二个方程：\n$$-16a_2 + 4a_2 = 1 \\implies -12a_2 = 1 \\implies a_2 = -\\frac{1}{12}$$\n现在，我们求 $a_1$：\n$$a_1 = -16 \\left(-\\frac{1}{12}\\right) = \\frac{16}{12} = \\frac{4}{3}$$\n最后，使用第一个方程，我们求 $a_0$：\n$$a_0 = -2a_1 - 2a_2 = -2\\left(\\frac{4}{3}\\right) - 2\\left(-\\frac{1}{12}\\right) = -\\frac{8}{3} + \\frac{2}{12} = -\\frac{8}{3} + \\frac{1}{6}$$\n$$a_0 = -\\frac{16}{6} + \\frac{1}{6} = -\\frac{15}{6} = -\\frac{5}{2}$$\n系数为 $a_0 = -\\frac{5}{2}$，$a_1 = \\frac{4}{3}$ 和 $a_2 = -\\frac{1}{12}$。\n\n有了这些系数，$\\mathcal{O}(h^2)$ 误差项就消失了。主误差项是展开式中下一个非零项，即与 $h^4 u_i^{(6)}$ 成正比的项。问题将截断误差定义为：\n$$L[u] = \\partial_{xx} u(x_{i}) + C\\,h^{4}\\,\\partial_{x}^{6}u(x_{i}) + \\mathcal{O}(h^{6})$$\n从我们的展开式中可知，$h^4 u_i^{(6)}$ 的系数是 $C$。我们可以从推导出的 $L[u]$ 表达式中确定 $C$：\n$$C = \\frac{a_1}{360} + \\frac{8a_2}{45}$$\n代入 $a_1$ 和 $a_2$ 的值：\n$$C = \\frac{4/3}{360} + \\frac{8(-1/12)}{45} = \\frac{4}{3 \\cdot 360} - \\frac{8}{12 \\cdot 45}$$\n$$C = \\frac{4}{1080} - \\frac{8}{540} = \\frac{1}{270} - \\frac{8}{540}$$\n为了进行减法，我们使用公分母 $540$：\n$$C = \\frac{2}{540} - \\frac{8}{540} = -\\frac{6}{540}$$\n化简分数得到主截断误差系数的最终值：\n$$C = -\\frac{1}{90}$$",
            "answer": "$$\\boxed{-\\frac{1}{90}}$$"
        },
        {
            "introduction": "一个数值格式即使理论精度很高，如果它在计算中不稳定，导致误差无限放大，那么它在实践中也是毫无用处的。因此，稳定性分析是评估和选择数值方案时必不可少的一环。本练习将引导您应用冯·诺依曼稳定性分析方法——一个研究线性、常系数偏微分方程离散格式稳定性的强大工具——来探究经典的一阶迎风格式。通过推导其放大因子并确定稳定性边界，您将亲手揭示著名的Courant–Friedrichs–Lewy (CFL) 条件，这是确保显式时间推进格式收敛的基本准则 。",
            "id": "3955901",
            "problem": "考虑线性平流（输运）方程 $\\partial_{t} u + a \\,\\partial_{x} u = 0$，其中常数波速为 $a \\in \\mathbb{R}$，定义在一个具有空间步长 $\\Delta x$ 和显式时间步长 $\\Delta t$ 的无限均匀网格上。设 $u^{n}_{j}$ 表示在空间节点 $x_{j} = j\\,\\Delta x$ 和时间层 $t^{n} = n\\,\\Delta t$ 上对 $u$ 的数值近似。时间上使用前向欧拉格式离散，空间上根据 $a$ 的符号选择一阶迎风差分（沿特征线方向迎风）：\n- 若 $a \\ge 0$，则在空间上使用后向差分。\n- 若 $a \\le 0$，则在空间上使用前向差分。\n定义无量纲的 Courant–Friedrichs–Lewy (CFL) 数 $C = |a|\\,\\Delta t/\\Delta x$。\n\n对此线性常系数格式使用 von Neumann（傅里叶）稳定性分析，从离散傅里叶模态的定义和更新的线性性出发：\n- 推导单步放大因子作为无量纲波数 $\\theta \\in [-\\pi,\\pi]$ 和带符号的 Courant 数 $\\nu = a\\,\\Delta t/\\Delta x$ 的函数的闭式表达式。\n- 从第一性原理出发，确定 $\\nu$ 的充要边界，使得该格式在傅里叶（能量）意义下是稳定的，即放大矩阵的谱半径（等价于 $\\sup_{\\theta} |G(\\theta;\\nu)|$）不超过 $1$。\n- 用 CFL 数 $C$ 表示此稳定性边界，并计算最大允许 CFL 数的确切值\n$$\nC_{\\max} \\equiv \\sup \\{\\, C \\ge 0 \\;:\\; \\sup_{\\theta \\in [-\\pi,\\pi]} |G(\\theta;\\nu)| \\le 1 \\,\\}.\n$$\n\n报告 $C_{\\max}$ 的唯一精确值作为您的最终答案。CFL 数是无量纲的，无需单位。不要提供不等式，只提供最大允许值 $C_{\\max}$。",
            "solution": "该问题陈述是有限差分格式稳定性分析中的一个标准练习，被认为是有效的。它具有科学依据、适定、客观且完整。我们将按要求进行推导。\n\n控制偏微分方程是线性平流方程：\n$$\n\\partial_{t} u + a \\,\\partial_{x} u = 0\n$$\n其中 $a \\in \\mathbb{R}$ 是恒定波速。\n数值网格由 $x_j = j\\,\\Delta x$ 和 $t^n = n\\,\\Delta t$ 定义，其中 $u^n_j$ 近似于 $u(x_j, t^n)$。时间导数使用一阶前向欧拉格式离散：$\\partial_t u \\approx (u_j^{n+1} - u_j^n)/\\Delta t$。空间导数使用一阶迎风格式离散，该格式取决于波速 $a$ 的符号。\n\n我们根据 $a$ 的符号考虑两种情况。\n\n情况 1：$a \\ge 0$ (波沿 x 正方向传播)\n迎风方向来自左侧，因此我们对空间导数使用后向差分：$\\partial_x u \\approx (u_j^n - u_{j-1}^n)/\\Delta x$。有限差分方程 (FDE) 是：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\n对 $u_j^{n+1}$ 进行整理，并引入带符号的 Courant 数 $\\nu = a\\,\\Delta t/\\Delta x$（在此情况下为非负，$\\nu \\ge 0$），我们得到：\n$$\nu_j^{n+1} = u_j^n - \\nu (u_j^n - u_{j-1}^n)\n$$\n为了进行 von Neumann 稳定性分析，我们代入单个傅里叶模态 $u_j^n = \\hat{u}^n \\exp(ij\\theta)$，其中 $\\theta = k\\Delta x$ 是波数为 $k$ 的模态的无量纲波数，$\\hat{u}^n$ 是时间层 $n$ 的振幅。\n$$\n\\hat{u}^{n+1} \\exp(ij\\theta) = \\hat{u}^n \\exp(ij\\theta) - \\nu (\\hat{u}^n \\exp(ij\\theta) - \\hat{u}^n \\exp(i(j-1)\\theta))\n$$\n放大因子 $G(\\theta; \\nu) = \\hat{u}^{n+1}/\\hat{u}^n$ 通过除以 $\\hat{u}^n \\exp(ij\\theta)$ 得到：\n$$\nG(\\theta; \\nu) = 1 - \\nu (1 - \\exp(-i\\theta))\n$$\n为了保证稳定性，对于所有的 $\\theta \\in [-\\pi, \\pi]$，放大因子的模必须不超过 $1$，即 $|G(\\theta; \\nu)| \\le 1$。我们可以将 $G$ 表示为：\n$$\nG(\\theta; \\nu) = (1 - \\nu) + \\nu \\exp(-i\\theta)\n$$\n这个表达式描述了复平面上的一个圆，圆心为 $c = 1 - \\nu$，半径为 $r = \\nu$。要使整个圆都位于单位圆盘 $|z| \\le 1$ 内，必须满足条件 $|c| + r \\le 1$。\n$$\n|1 - \\nu| + \\nu \\le 1\n$$\n由于我们处于 $\\nu \\ge 0$ 的情况，我们对绝对值考虑两种子情况：\n1. 如果 $0 \\le \\nu \\le 1$，那么 $1 - \\nu \\ge 0$，条件变为 $(1 - \\nu) + \\nu \\le 1$，简化为 $1 \\le 1$。这恒成立。\n2. 如果 $\\nu  1$，那么 $1 - \\nu  0$，条件变为 $-(1 - \\nu) + \\nu \\le 1$，简化为 $2\\nu - 1 \\le 1$，即 $\\nu \\le 1$。这与假设 $\\nu  1$ 矛盾。\n因此，对于 $a \\ge 0$，稳定性条件是 $0 \\le \\nu \\le 1$。\n\n情况 2：$a \\le 0$ (波沿 x 负方向传播)\n迎风方向来自右侧，因此我们对空间导数使用前向差分：$\\partial_x u \\approx (u_{j+1}^n - u_j^n)/\\Delta x$。有限差分方程是：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0\n$$\n再次引入 $\\nu = a\\,\\Delta t/\\Delta x$（在此情况下为非正，$\\nu \\le 0$），我们得到：\n$$\nu_j^{n+1} = u_j^n - \\nu (u_{j+1}^n - u_j^n)\n$$\n代入傅里叶模态 $u_j^n = \\hat{u}^n \\exp(ij\\theta)$：\n$$\n\\hat{u}^{n+1} \\exp(ij\\theta) = \\hat{u}^n \\exp(ij\\theta) - \\nu (\\hat{u}^n \\exp(i(j+1)\\theta) - \\hat{u}^n \\exp(ij\\theta))\n$$\n通过除以 $\\hat{u}^n \\exp(ij\\theta)$ 得到放大因子：\n$$\nG(\\theta; \\nu) = 1 - \\nu (\\exp(i\\theta) - 1)\n$$\n这可以重写为：\n$$\nG(\\theta; \\nu) = (1 + \\nu) - \\nu \\exp(i\\theta)\n$$\n这个表达式描述了复平面上的一个圆，圆心为 $c = 1 + \\nu$，半径为 $r = |-\\nu| = -\\nu$（因为 $\\nu \\le 0$）。稳定性条件 $|c| + r \\le 1$ 变为：\n$$\n|1 + \\nu| - \\nu \\le 1\n$$\n由于 $\\nu \\le 0$，我们对绝对值考虑两种子情况：\n1. 如果 $-1 \\le \\nu \\le 0$，那么 $1 + \\nu \\ge 0$，条件为 $(1 + \\nu) - \\nu \\le 1$，简化为 $1 \\le 1$。这恒成立。\n2. 如果 $\\nu  -1$，那么 $1 + \\nu  0$，条件为 $-(1 + \\nu) - \\nu \\le 1$，简化为 $-1 - 2\\nu \\le 1$，即 $\\nu \\ge -1$。这与假设 $\\nu  -1$ 矛盾。\n因此，对于 $a \\le 0$，稳定性条件是 $-1 \\le \\nu \\le 0$。\n\n结果总结\n一阶迎风格式的放大因子 $G(\\theta; \\nu)$ 由下式给出：\n$$\nG(\\theta; \\nu) = \n\\begin{cases} \n1 - \\nu (1 - \\exp(-i\\theta))  \\text{若 } \\nu \\ge 0 \\\\\n1 - \\nu (\\exp(i\\theta) - 1)  \\text{若 } \\nu \\le 0 \n\\end{cases}\n$$\n傅里叶稳定性的充要条件，即对所有 $\\theta$ 都有 $|G(\\theta; \\nu)| \\le 1$，可以通过结合两种情况的结果得到：\n$$\n-1 \\le \\nu \\le 1\n$$\n这可以紧凑地写为 $|\\nu| \\le 1$。\n\n问题将（非负）CFL 数定义为 $C = |a|\\,\\Delta t/\\Delta x$。我们可以将其与带符号的 Courant 数 $\\nu = a\\,\\Delta t/\\Delta x$ 联系起来。注意 $C = |\\nu|$。\n因此，稳定性条件 $|\\nu| \\le 1$ 等价于：\n$$\nC \\le 1\n$$\n由于根据定义，$C$ 是非负的，所以稳定性边界是 $0 \\le C \\le 1$。\n\n问题要求最大允许 CFL 数 $C_{\\max}$，定义为：\n$$\nC_{\\max} \\equiv \\sup \\{\\, C \\ge 0 \\;:\\; \\sup_{\\theta \\in [-\\pi,\\pi]} |G(\\theta;\\nu)| \\le 1 \\,\\}\n$$\n允许的 $C$ 值集合是区间 $[0, 1]$。这个集合的上确界是 $1$。\n因此，最大允许 CFL 数是 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "理论分析为我们提供了数值格式的预期精度，但在实际编程实现中，我们如何验证代码是否正确无误地达到了这个理论精度呢？本练习将带您从理论走向实践，通过实施网格加密研究来经验性地测量数值格式的收敛阶。您将亲手编写代码，对特定函数计算其导数的数值解，并通过分析误差随网格尺寸的变化来量化程序的实际表现。这项练习不仅是验证代码正确性的标准流程，还将让您直面非渐近区和边界层等真实世界问题带来的挑战，深刻理解理论与实践之间的联系 。",
            "id": "3955888",
            "problem": "考虑在计算流体动力学（CFD）中，经验性地估计空间离散化精度阶数的任务。其理论基础是空间导数的定义以及使用泰勒级数展开来推导有限差分近似。假设在一个闭区间 $[0,1]$ 上定义了一个足够光滑的标量场 $u(x)$，并考虑一系列均匀网格，这些网格有 $N$ 个网格点，网格间距为 $h = \\frac{1}{N-1}$，网格节点为 $x_i = i h$，其中 $i = 0,1,\\dots,N-1$。\n\n您的目标是：\n1. 在均匀网格上，为一阶导数 $u'(x)$ 推导并实现二阶精度的有限差分公式：\n   - 对内部节点使用二阶中心差分。\n   - 在边界上使用二阶单边差分。\n   推导必须从泰勒级数展开和 $u'(x)$ 的定义出发，而不是先验地假设目标公式。\n2. 对每个网格，计算 $u'(x)$ 的离散近似，并评估离散 $L^2$ 误差范数\n   $$E(h) = \\left( h \\sum_{i=0}^{N-1} \\left( u'_h(x_i) - u'(x_i) \\right)^2 \\right)^{1/2},$$\n   其中 $u'_h(x_i)$ 表示由您的有限差分格式计算出的节点 $x_i$ 处的数值导数。\n3. 使用具有恒定加密比的网格加密研究，通过对 $\\log E(h)$ 与 $\\log h$ 进行最小二乘拟合来估计经验精度阶数 $p$，即找到最佳拟合直线的斜率\n   $$\\log E(h) \\approx \\alpha + p \\log h.$$\n   经验阶数 $p$ 必须从至少三个网格层级计算得出。\n\n在您的解决方案中需要考虑和讨论的陷阱：\n- 在粗网格上的非渐近区域，高阶截断项不可忽略，这可能会扭曲估计的 $p$ 值。\n- 边界层效应，其中局部陡峭的梯度可能主导全局误差，除非网格足够解析边界层厚度，否则会改变表观的收敛速率。\n\n为以下测试套件实现此过程，该套件旨在探究经验阶数测量的不同方面：\n\n- 测试用例 A（理想情况，光滑且解析良好）：\n  - 函数 $u(x) = \\sin(2\\pi x)$，其精确导数为 $u'(x) = 2\\pi \\cos(2\\pi x)$。\n  - 网格 $N \\in \\{50, 100, 200\\}$。\n- 测试用例 B（高频内容的非渐近粗糙解析）：\n  - 函数 $u(x) = \\sin(12\\pi x)$，其精确导数为 $u'(x) = 12\\pi \\cos(12\\pi x)$。\n  - 网格 $N \\in \\{12, 24, 48\\}$。\n- 测试用例 C（边界层效应）：\n  - 函数 $u(x) = \\tanh\\!\\left(\\frac{x}{\\delta}\\right)$，其精确导数为 $u'(x) = \\frac{1}{\\delta}\\,\\mathrm{sech}^2\\!\\left(\\frac{x}{\\delta}\\right)$，其中 $\\delta = 10^{-2}$。\n  - 网格 $N \\in \\{100, 200, 400\\}$。\n\n您的程序必须：\n- 实现上述从第一性原理推导出的二阶有限差分格式。\n- 对每个测试用例，计算指定网格的误差 $E(h)$，并通过对 $(\\log h, \\log E(h))$ 数据点进行最小二乘法来估计经验阶数 $p$。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序为 $[p_A, p_B, p_C]$，其中 $p_A$、$p_B$ 和 $p_C$ 是分别表示测试用例 A、B 和 C 的估计经验阶数的浮点数。\n\n不涉及物理单位；所有量纲均为无量纲。三角函数中的角度以弧度为单位。最终输出必须严格符合指定格式，不得包含任何额外文本。",
            "solution": "该问题要求推导并实现一个用于一阶导数的二阶精度有限差分格式，然后对三个不同的测试用例进行精度阶数的经验性估计。解决方案分几步呈现：数值格式的推导、误差分析方法的描述，以及针对已知数值分析陷阱对特定测试用例的讨论。\n\n### 1. 二阶有限差分格式的推导\n\n我们的任务是在均匀网格 $x_i = i h$（其中 $i = 0, 1, \\dots, N-1$ 且网格间距为 $h = 1/(N-1)$）上近似一个足够光滑的函数 $u(x)$ 的一阶导数 $u'(x)$。该格式必须是二阶精度的，即截断误差必须为 $O(h^2)$。我们需要为内部节点和边界节点使用不同的公式。\n\n#### 1.1. 内部节点：中心差分格式\n对于一个内部节点 $x_i$（其中 $1 \\le i \\le N-2$），我们可以访问相邻点 $x_{i-1} = x_i - h$ 和 $x_{i+1} = x_i + h$。我们使用 $u(x)$ 在 $x_i$ 点的泰勒级数展开：\n$$u(x_{i+1}) = u(x_i + h) = u(x_i) + h u'(x_i) + \\frac{h^2}{2} u''(x_i) + \\frac{h^3}{6} u'''(x_i) + O(h^4)$$\n$$u(x_{i-1}) = u(x_i - h) = u(x_i) - h u'(x_i) + \\frac{h^2}{2} u''(x_i) - \\frac{h^3}{6} u'''(x_i) + O(h^4)$$\n用第一个展开式减去第二个展开式可得：\n$$u(x_{i+1}) - u(x_{i-1}) = 2h u'(x_i) + \\frac{h^3}{3} u'''(x_i) + O(h^5)$$\n求解 $u'(x_i)$：\n$$u'(x_i) = \\frac{u(x_{i+1}) - u(x_{i-1})}{2h} - \\frac{h^2}{6} u'''(x_i) + O(h^4)$$\n有限差分近似 $u'_h(x_i)$ 取为右边的第一项。截断误差的主项是 $-\\frac{h^2}{6} u'''(x_i)$，这表明该格式是二阶精度的。\n$$u'_h(x_i) = \\frac{u(x_{i+1}) - u(x_{i-1})}{2h}, \\quad \\text{for } i = 1, \\dots, N-2$$\n\n#### 1.2. 边界节点：单边差分格式\n在边界点 $x_0$ 和 $x_{N-1}$，无法使用中心差分。我们必须使用保持二阶精度的单边公式。我们使用待定系数法来推导这些公式。\n\n**左边界 ($i=0$):** 我们寻求一个形如 $u'_h(x_0) \\approx a u(x_0) + b u(x_1) + c u(x_2)$ 的公式。我们将 $u(x_1) = u(x_0+h)$ 和 $u(x_2) = u(x_0+2h)$ 在 $x_0$ 点展开：\n$$u(x_1) = u(x_0) + h u'(x_0) + \\frac{h^2}{2} u''(x_0) + O(h^3)$$\n$$u(x_2) = u(x_0) + 2h u'(x_0) + \\frac{(2h)^2}{2} u''(x_0) + O(h^3) = u(x_0) + 2h u'(x_0) + 2h^2 u''(x_0) + O(h^3)$$\n将这些展开式代入 $u'_h(x_0)$ 的公式中，并按 $u$ 在 $x_0$ 处的各阶导数整理各项：\n$$a u_0 + b u_1 + c u_2 = (a+b+c)u(x_0) + (bh + 2ch)u'(x_0) + (b\\frac{h^2}{2} + c\\frac{4h^2}{2})u''(x_0) + \\dots$$\n为使该表达式成为 $u'(x_0)$ 的二阶近似，我们需要：\n\\begin{enumerate}\n    \\item $u(x_0)$ 的系数为 $0$：$a+b+c=0$\n    \\item $u'(x_0)$ 的系数为 $1$：$bh + 2ch=1$\n    \\item $u''(x_0)$ 的系数为 $0$：$\\frac{b h^2}{2} + 2 c h^2=0$\n\\end{enumerate}\n由 (3) 可得 $b/2 + 2c = 0 \\implies b = -4c$。将其代入 (2) 得 $(-4c)h + 2ch = 1 \\implies -2ch=1 \\implies c = -1/(2h)$。因此，$b = 2/h$。最后，由 (1) 可得 $a = -b-c = -2/h + 1/(2h) = -3/(2h)$。得到的二阶向前差分公式为：\n$$u'_h(x_0) = \\frac{-3u(x_0) + 4u(x_1) - u(x_2)}{2h}$$\n\n**右边界 ($i=N-1$):** 使用点 $x_{N-1}$、$x_{N-2}$ 和 $x_{N-3}$ 的类似过程可得出二阶向后差分公式。通过对称性，我们可以推断出系数，或者求解相应的方程组。该公式为：\n$$u'_h(x_{N-1}) = \\frac{3u(x_{N-1}) - 4u(x_{N-2}) + u(x_{N-3})}{2h}$$\n\n### 2. 误差分析与精度阶数\n\n问题指定了使用离散 $L^2$ 误差范数来量化数值导数 $u'_h(x_i)$ 与精确导数 $u'(x_i)$ 之间的差异：\n$$E(h) = \\left( h \\sum_{i=0}^{N-1} \\left( u'_h(x_i) - u'(x_i) \\right)^2 \\right)^{1/2}$$\n对于一个精度阶数为 $p$ 的离散化方法，当 $h$ 足够小（即在渐近收敛区域）时，误差预计表现为 $E(h) \\approx C h^p$，其中 $C$ 为一个常数。为了经验性地确定 $p$，我们可以对这个关系式取对数：\n$$\\log E(h) \\approx \\log C + p \\log h$$\n这表明 $\\log E(h)$ 和 $\\log h$ 之间存在线性关系，其斜率即为精度阶数 $p$。给定在一系列间距为 $(h_j)$ 的网格上的一组误差测量值 $(E_j)$，我们可以通过对数据点 $(\\log h_j, \\log E_j)$ 进行线性最小二乘拟合来求得 $p$。\n\n### 3. 测试用例与陷阱讨论\n\n所选的测试用例旨在突出收敛性研究中的重要实践方面。\n\n**测试用例 A：$u(x) = \\sin(2\\pi x)$，网格 $N \\in \\{50, 100, 200\\}$**\n这是一个“理想情况”的用例。函数光滑且周期性，其导数性质良好。网格足够精细，可以在定义域 $[0,1]$ 上解析单个波长的变化。我们预计误差将处于渐近区域，估计的阶数 $p_A$ 应非常接近理论值 $2$。\n\n**测试用例 B：$u(x) = \\sin(12\\pi x)$，网格 $N \\in \\{12, 24, 48\\}$**\n该用例探究非渐近区域。函数具有更高的频率（在 $[0,1]$ 内有6个完整波长）。最粗的网格 $N=12$ 对应的间距为 $h=1/11$。波长为 $\\lambda = 2\\pi/(12\\pi) = 1/6$。每个波长内的点数为 $\\lambda/h \\approx (1/6)/(1/11) \\approx 1.83$，这远低于 Nyquist-Shannon 采样定理的要求，不足以精确近似导数。在如此粗糙的网格上，截断误差展开中的高阶项（例如 $O(h^4)$）与主导的 $O(h^2)$ 项相比不可忽略。因此，假设 $E(h) \\approx C h^p$ 在此网格范围内不成立。对数-对数图的斜率会失真，预计估计的阶数 $p_B$ 将显著低于 $2$。\n\n**测试用例 C：$u(x) = \\tanh(x/\\delta)$，其中 $\\delta = 10^{-2}$，网格 $N \\in \\{100, 200, 400\\}$**\n该用例说明了边界层的影响。函数在 $x=0$ 附近有一个急剧变化的区域（一个“层”），其特征厚度为 $\\delta=0.01$。我们格式的截断误差依赖于高阶导数，例如 $u'''(x)$。对于此函数，这些导数在层内可能非常大，其量级可达 $1/\\delta^3$。这使得误差关系 $E(h) \\approx C h^p$ 中的常数 $C$ 变得极大。全局误差 $E(h)$ 将由这个未被充分解析的层内的大局部误差所主导。网格间距约为 $h \\approx 1/99, 1/199, 1/399$，对应于 $h/\\delta \\approx 1, 0.5, 0.25$。只有最精细的网格才开始在层内放置几个点。由于研究中使用的所有网格都未能充分解析该层，观测到的收敛可能不会遵循理论速率。我们可能预期 $p_C$ 会偏离理想值 $2$。只有当 $h \\ll \\delta$ 时，收敛才会接近理论速率，这比光滑正弦函数的情况要严格得多。",
            "answer": "[2.000326463567073,1.259258284534015,1.0028882046835218]"
        }
    ]
}