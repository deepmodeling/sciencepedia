{
    "hands_on_practices": [
        {
            "introduction": "Understanding the Courant–Friedrichs–Lewy (CFL) condition begins with its most fundamental origin: the principle of causality in physics. This exercise guides you to derive the stability constraint from first principles for the canonical linear advection equation. By linking the numerical time step to the physical propagation of information, you will establish the crucial relationship between the numerical and physical domains of dependence, which forms the bedrock of all further analysis.",
            "id": "3952418",
            "problem": "Consider a one-dimensional hyperbolic transport of a small disturbance in inviscid compressible flow, modeled by the linear advection equation $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$. Here $u(x,t)$ represents a conservative transported quantity and $a$ is a constant characteristic speed associated with information propagation. In an explicit single-stage conservative finite-volume method on a uniform mesh with spacing $\\Delta x$, the numerical update in one time step uses only the immediately adjacent upstream state and the local state (a nearest-neighbor stencil). In this setting, the Courant–Friedrichs–Lewy (CFL) condition requires the Courant number $C$ to satisfy $C \\le 1$ for stability.\n\nStarting from the governing equation and the characteristic interpretation of information propagation, derive the bound on the maximum allowable time step $\\Delta t_{\\max}$ that guarantees stability for the described explicit nearest-neighbor scheme, expressing $\\Delta t_{\\max}$ in closed form in terms of $a$ and $\\Delta x$ without invoking any shortcut formulas. Then, evaluate $\\Delta t_{\\max}$ for the specific parameters $a = 460\\,\\mathrm{m/s}$ and $\\Delta x = 0.035\\,\\mathrm{m}$. Round your numerical result to four significant figures and express your final answer in seconds. Finally, provide a concise physical interpretation of the bound in terms of information propagation in Computational Fluid Dynamics (CFD), and explain how it relates the physical domain of dependence to the numerical domain of dependence.",
            "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, and objective. It contains a complete and consistent set of givens, allowing for a logical and rigorous solution.\n\nThe problem asks for the derivation of the maximum allowable time step, $\\Delta t_{\\max}$, for a specific numerical scheme, a numerical evaluation of this bound, and a physical interpretation based on the Courant–Friedrichs–Lewy (CFL) condition.\n\nThe governing equation is the one-dimensional linear advection equation:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u(x,t)$ is the transported quantity and $a$ is the constant propagation speed.\n\nThis is a hyperbolic partial differential equation. Its solution can be understood by analyzing the characteristic curves. A characteristic curve is a path in the $(x,t)$ plane along which the solution $u$ is constant. The slope of these curves is given by $\\frac{dx}{dt} = a$. Integrating this yields the equation for the characteristic lines: $x - at = \\text{constant}$. This implies that the value of the solution $u$ at a point $(x_p, t_p)$ is determined by its value at an earlier time $t_0 < t_p$ at the point $x_0 = x_p - a(t_p - t_0)$. This point $x_0$ constitutes the *physical domain of dependence* for the point $(x_p, t_p)$ relative to the time slice $t_0$.\n\nNow, let's consider the numerical discretization. We have a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. A grid point is denoted by $(x_i, t_n)$, where $x_i = i\\Delta x$ and $t_n = n\\Delta t$. The numerical scheme is explicit, meaning the solution at time $t_{n+1} = t_n + \\Delta t$ is computed using known values at time $t_n$. The problem states the scheme uses a nearest-neighbor stencil, involving the local state ($x_i$) and the immediately adjacent upstream state.\n\nThe \"upstream\" direction depends on the sign of the propagation speed $a$.\nCase 1: $a > 0$. Information propagates in the positive $x$ direction. The flow is from left to right. The upstream cell relative to cell $i$ is cell $i-1$. The numerical stencil for computing the updated value $u_i^{n+1}$ (the approximation to $u(x_i, t_{n+1})$) thus uses values $u_{i-1}^n$ and $u_i^n$. The set of grid points at time $t_n$ that influence the solution at $(x_i, t_{n+1})$ is $\\{x_{i-1}, x_i\\}$. The continuous interval corresponding to these points, $[x_{i-1}, x_i]$, is the *numerical domain of dependence*.\n\nThe Courant–Friedrichs–Lewy (CFL) condition is a necessary condition for the stability of an explicit numerical method for a hyperbolic PDE. It states that for the numerical solution to be stable and converge to the true solution, the physical domain of dependence of the PDE must be contained within the numerical domain of dependence of the scheme.\n\nFor our problem, this means that the physical point $x_0 = x_i - a\\Delta t$ at time $t_n$, which determines the true solution at $(x_i, t_{n+1})$, must lie within the numerical domain of dependence $[x_{i-1}, x_i]$.\nMathematically, this is expressed as:\n$$\nx_{i-1} \\le x_i - a\\Delta t \\le x_i\n$$\nSubstituting $x_{i-1} = x_i - \\Delta x$, we get:\n$$\nx_i - \\Delta x \\le x_i - a\\Delta t \\le x_i\n$$\nThis inequality can be split into two parts:\n1. $x_i - a\\Delta t \\le x_i \\implies -a\\Delta t \\le 0 \\implies a\\Delta t \\ge 0$. Since $a > 0$ and $\\Delta t > 0$, this is always satisfied.\n2. $x_i - \\Delta x \\le x_i - a\\Delta t \\implies -\\Delta x \\le -a\\Delta t$. Multiplying by $-1$ and reversing the inequality sign gives $a\\Delta t \\le \\Delta x$.\n\nThis leads to the stability constraint on the time step:\n$$\n\\Delta t \\le \\frac{\\Delta x}{a}\n$$\nAlthough not required by the problem, if we considered Case 2: $a < 0$, information would propagate in the negative $x$ direction, and the upstream neighbor would be at $x_{i+1}$. The numerical domain of dependence would be $[x_i, x_{i+1}]$. The CFL condition would be $x_i \\le x_i - a\\Delta t \\le x_{i+1}$, which simplifies to $\\Delta t \\le \\frac{\\Delta x}{-a} = \\frac{\\Delta x}{|a|}$.\nThus, the general condition for any non-zero $a$ is $\\Delta t \\le \\frac{\\Delta x}{|a|}$.\n\nThe problem defines the Courant number as $C \\le 1$. The Courant number is defined as $C = \\frac{|a| \\Delta t}{\\Delta x}$. Our derived condition $\\Delta t \\le \\frac{\\Delta x}{|a|}$ is equivalent to $\\frac{|a| \\Delta t}{\\Delta x} \\le 1$, or $C \\le 1$, which is consistent.\n\nThe maximum allowable time step, $\\Delta t_{\\max}$, is the value of $\\Delta t$ that satisfies this condition at its limit:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$\nGiven that the problem provides a positive value for $a$, we can write:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{a}\n$$\nThis completes the derivation of the closed-form expression for the maximum allowable time step.\n\nNext, we evaluate $\\Delta t_{\\max}$ for the given parameters: $a = 460\\,\\mathrm{m/s}$ and $\\Delta x = 0.035\\,\\mathrm{m}$.\n$$\n\\Delta t_{\\max} = \\frac{0.035\\,\\mathrm{m}}{460\\,\\mathrm{m/s}}\n$$\n$$\n\\Delta t_{\\max} = 0.000076086956... \\,\\mathrm{s}\n$$\nThe problem requires rounding the numerical result to four significant figures.\n$$\n\\Delta t_{\\max} \\approx 0.00007609 \\,\\mathrm{s}\n$$\nIn scientific notation, this is $7.609 \\times 10^{-5}\\,\\mathrm{s}$.\n\nFinally, we provide the physical interpretation.\nThe quantity $\\tau = \\frac{\\Delta x}{a}$ represents the time it takes for a physical disturbance, propagating at speed $a$, to travel a distance equal to one grid cell width, $\\Delta x$. The stability condition $\\Delta t \\le \\Delta t_{\\max} = \\frac{\\Delta x}{a}$ therefore has a clear physical meaning: the numerical time step $\\Delta t$ must be less than or equal to the time required for information to physically cross one grid cell. If the time step were larger than this value ($\\Delta t > \\frac{\\Delta x}{a}$), a disturbance could originate in one cell and travel past the next cell's node within a single time step. An explicit nearest-neighbor scheme, which only uses information from adjacent cells to update a node, would completely miss this information. The numerical algorithm would be trying to compute the future state at a point without access to the physical data that actually determines it, leading to a rapid, unbounded growth of errors, i.e., numerical instability.\n\nThis is formalized by the relationship between the physical and numerical domains of dependence. As derived above, the CFL condition demands that the physical domain of dependence (the point $x_i - a\\Delta t$ at time $t_n$) must be contained within the numerical scheme's domain of dependence (the interval $[x_{i-1}, x_i]$ at time $t_n$ for $a>0$). This ensures that the numerical method has access to all the necessary physical information to correctly compute the solution's evolution. In essence, the CFL condition guarantees that the speed of numerical information propagation ($\\frac{\\Delta x}{\\Delta t}$) is at least as fast as the speed of physical information propagation ($a$).",
            "answer": "$$ \\boxed{7.609 \\times 10^{-5}} $$"
        },
        {
            "introduction": "Building on the foundational principle, we now apply the CFL condition to a more realistic scenario in aerospace engineering: one-dimensional compressible flow. This practice challenges you to adapt the concept from a single, constant wave speed to the multiple characteristic speeds present in the Euler equations. You will learn to identify the fastest local wave speed, $|u|+c$, and use it to calculate the maximum permissible time step in a supersonic flow, connecting abstract theory to tangible fluid dynamics.",
            "id": "3952482",
            "problem": "A one-dimensional inviscid compressible air flow in a straight duct is advanced in time using an explicit finite-volume method on a uniform grid. At a particular cell center, the local Mach number is measured to be $M = 2.3$, the static temperature is $T = 700\\,\\mathrm{K}$, and the grid spacing is $\\Delta x = 2.5\\times 10^{-3}\\,\\mathrm{m}$. The gas may be treated as calorically perfect, with ratio of specific heats $\\gamma = 1.4$ and specific gas constant $R = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$. The Courant–Friedrichs–Lewy (CFL) number is set to $\\nu = 0.8$. Starting from the one-dimensional compressible Euler equations and the requirement that the numerical domain of dependence must contain the physical domain of dependence, determine the largest admissible time step $\\Delta t$ at this location that preserves stability for the explicit update. Use the definition of Mach number $M = |u|/c$ and the ideal-gas speed of sound relation $c^{2} = \\gamma R T$. Express your final $\\Delta t$ in microseconds and round your answer to four significant figures.",
            "solution": "The problem statement is first validated to ensure it is scientifically grounded, well-posed, and complete.\n\n**Step 1: Extract Givens**\n- Flow type: one-dimensional inviscid compressible air flow\n- Numerical method: explicit finite-volume method on a uniform grid\n- Local Mach number: $M = 2.3$\n- Static temperature: $T = 700\\,\\mathrm{K}$\n- Grid spacing: $\\Delta x = 2.5\\times 10^{-3}\\,\\mathrm{m}$\n- Gas model: calorically perfect gas\n- Ratio of specific heats: $\\gamma = 1.4$\n- Specific gas constant: $R = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- Courant–Friedrichs–Lewy (CFL) number: $\\nu = 0.8$\n- Governing equations: one-dimensional compressible Euler equations\n- Stability principle: The numerical domain of dependence must contain the physical domain of dependence.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it deals with the Courant–Friedrichs–Lewy (CFL) stability condition, a fundamental concept in the numerical solution of hyperbolic partial differential equations like the Euler equations used in aerospace CFD. The provided values for temperature, Mach number, grid spacing, and gas properties are physically realistic for high-speed compressible flow scenarios. The problem is well-posed, providing all necessary data to compute the time step. The terminology is precise and objective. There are no contradictions or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be derived.\n\nThe problem requires determining the maximum permissible time step, $\\Delta t$, for an explicit numerical scheme, governed by the Courant–Friedrichs–Lewy (CFL) condition. The CFL condition is a necessary stability criterion for explicit time-integration methods applied to hyperbolic partial differential equations. It ensures that the numerical domain of dependence of a grid point includes the physical domain of dependence.\n\nFor the one-dimensional Euler equations, the characteristic speeds, which represent the speeds at which information propagates, are given by the eigenvalues of the system's Jacobian matrix. These eigenvalues are $\\lambda_1 = u$, $\\lambda_2 = u+c$, and $\\lambda_3 = u-c$, where $u$ is the fluid velocity and $c$ is the local speed of sound. The fastest speed at which information can travel in the domain is the largest absolute value of these characteristic speeds, which is given by $\\max\\left(|\\lambda_i|\\right) = |u| + c$.\n\nThe CFL condition states that the distance traveled by the fastest moving wave in a single time step $\\Delta t$ must be less than or equal to the grid spacing $\\Delta x$. This is expressed as:\n$$ (|u|+c)\\Delta t \\le \\Delta x $$\nThe Courant number, or CFL number, $\\nu$, is defined as the ratio of this distance to the grid spacing:\n$$ \\nu = \\frac{(|u|+c)\\Delta t}{\\Delta x} $$\nFor stability, the CFL number must be less than or equal to a scheme-dependent limit, which is typically $\\nu \\le 1$ for one-dimensional problems. The problem specifies a practical CFL number of $\\nu = 0.8$ to be used. The largest admissible time step $\\Delta t$ is found by setting the expression to equality:\n$$ \\Delta t = \\frac{\\nu \\Delta x}{|u|+c} $$\nTo calculate $\\Delta t$, we must first determine the values of the local speed of sound $c$ and the fluid velocity magnitude $|u|$.\n\nFirst, we calculate the speed of sound $c$ using the provided relation for an ideal gas:\n$$ c = \\sqrt{\\gamma R T} $$\nSubstituting the given values: $\\gamma = 1.4$, $R = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, and $T = 700\\,\\mathrm{K}$.\n$$ c = \\sqrt{1.4 \\times 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1} \\times 700\\,\\mathrm{K}} = \\sqrt{281260\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}} $$\n$$ c \\approx 530.3395\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\nNext, we calculate the fluid velocity magnitude $|u|$ using the definition of the Mach number, $M = |u|/c$:\n$$ |u| = M \\times c $$\nSubstituting the given Mach number $M = 2.3$ and the calculated speed of sound $c$:\n$$ |u| = 2.3 \\times 530.3395\\,\\mathrm{m}\\,\\mathrm{s}^{-1} \\approx 1219.7809\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\nNow we can substitute the values for $|u|$, $c$, $\\nu$, and $\\Delta x$ into the equation for $\\Delta t$. A more direct symbolic substitution is also possible by noting that $|u|+c = Mc+c = c(M+1)$:\n$$ \\Delta t = \\frac{\\nu \\Delta x}{c(M+1)} $$\nSubstituting the given numerical values into this expression:\n- $\\nu = 0.8$\n- $\\Delta x = 2.5 \\times 10^{-3}\\,\\mathrm{m}$\n- $M = 2.3$\n- $c \\approx 530.3395\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n$$ \\Delta t = \\frac{0.8 \\times (2.5 \\times 10^{-3}\\,\\mathrm{m})}{(530.3395\\,\\mathrm{m}\\,\\mathrm{s}^{-1})(2.3+1)} = \\frac{2.0 \\times 10^{-3}\\,\\mathrm{m}}{(530.3395\\,\\mathrm{m}\\,\\mathrm{s}^{-1})(3.3)} $$\n$$ \\Delta t = \\frac{2.0 \\times 10^{-3}\\,\\mathrm{m}}{1750.1204\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} \\approx 1.142779 \\times 10^{-6}\\,\\mathrm{s} $$\nThe problem asks for the answer in microseconds ($\\mu\\mathrm{s}$) and rounded to four significant figures.\n$$ 1\\,\\mathrm{s} = 10^6\\,\\mu\\mathrm{s} $$\n$$ \\Delta t \\approx (1.142779 \\times 10^{-6}) \\times 10^6\\,\\mu\\mathrm{s} = 1.142779\\,\\mu\\mathrm{s} $$\nRounding to four significant figures, we get:\n$$ \\Delta t \\approx 1.143\\,\\mu\\mathrm{s} $$\nThis is the largest admissible time step at the specified location that preserves stability for the explicit numerical update.",
            "answer": "$$\n\\boxed{1.143}\n$$"
        },
        {
            "introduction": "Real-world aerospace simulations are governed by the Navier-Stokes equations, which include not only advection but also diffusion due to viscosity. This final practice explores the stability constraint arising from these viscous terms, which scales differently and often proves more restrictive than the advective CFL limit. By analyzing a highly anisotropic mesh typical of boundary layer resolution, you will uncover why the viscous time-step limit can become a dominant computational bottleneck in high-fidelity simulations.",
            "id": "3952452",
            "problem": "Consider an explicit time-marching Computational Fluid Dynamics (CFD) solver for the compressible Navier–Stokes equations with second-order central differences for the viscous terms and Forward Euler time integration. Focus attention on the viscous stability restriction implied by the Courant–Friedrichs–Lewy (CFL) condition for diffusion. Assume constant dynamic viscosity $\\mu$ and constant density $\\rho$, so the kinematic viscosity is $\\nu = \\mu / \\rho$, and neglect thermal diffusion and any spatial variation of viscosity.\n\nYou are given a boundary-layer-resolved, highly anisotropic mesh near a smooth wall. Let the local orthogonal coordinates be $n$ (wall-normal), $s$ (streamwise), and $z$ (spanwise). Near the wall, the mesh spacings are:\n- $\\Delta n_{\\mathrm{w}} = 1.0 \\times 10^{-6}\\ \\mathrm{m}$,\n- $\\Delta s_{\\mathrm{w}} = 1.0 \\times 10^{-3}\\ \\mathrm{m}$,\n- $\\Delta z_{\\mathrm{w}} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$.\n\nIn the outer layer away from the wall, the spacings are:\n- $\\Delta n_{\\mathrm{o}} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$,\n- $\\Delta s_{\\mathrm{o}} = 2.0 \\times 10^{-2}\\ \\mathrm{m}$,\n- $\\Delta z_{\\mathrm{o}} = 1.0 \\times 10^{-2}\\ \\mathrm{m}$.\n\nAir properties (assumed uniform in the region of interest) are:\n- $\\mu = 1.8 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$,\n- $\\rho = 1.2\\ \\mathrm{kg/m^3}$.\n\nStarting from the governing momentum equation specialized to the diffusive term and its semi-discrete form on a Cartesian grid, use a von Neumann stability analysis to derive the explicit-viscous time-step restriction on a general anisotropic grid $(\\Delta n, \\Delta s, \\Delta z)$ for Forward Euler time integration. Then, evaluate the maximum stable viscous time step at the wall, $\\Delta t_{\\mathrm{visc},\\mathrm{w}}$, and in the outer layer, $\\Delta t_{\\mathrm{visc},\\mathrm{o}}$, with the given numerical values. Finally, compute the ratio\n$$R = \\frac{\\Delta t_{\\mathrm{visc},\\mathrm{w}}}{\\Delta t_{\\mathrm{visc},\\mathrm{o}}}.$$\n\nExplain physically, based on your derivation, why the viscous CFL restriction is particularly severe near walls on boundary-layer-resolved meshes with extreme aspect ratios.\n\nRound your final numerical answer for $R$ to four significant figures. Express the final answer as a pure number (dimensionless).",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and contains all necessary information for a unique solution. The given parameters, physical constants, and numerical methods are standard in the field of computational fluid dynamics, rendering the problem valid. We may thus proceed with the solution.\n\nThe task is to derive the viscous time-step restriction for an explicit solver and apply it to two different regions of a computational grid. The analysis begins with a model partial differential equation representing the viscous diffusion of momentum. For constant kinematic viscosity $\\nu$, the momentum equation's viscous term for a velocity component $\\phi$ can be modeled by the linear diffusion equation in three dimensions:\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\nu \\nabla^2 \\phi = \\nu \\left( \\frac{\\partial^2 \\phi}{\\partial n^2} + \\frac{\\partial^2 \\phi}{\\partial s^2} + \\frac{\\partial^2 \\phi}{\\partial z^2} \\right)\n$$\nHere, $(n, s, z)$ are treated as a local orthogonal coordinate system.\n\nThe problem specifies Forward Euler for time integration and second-order central differences for the spatial derivatives. Let $\\phi_{i,j,k}^m$ denote the value of $\\phi$ at grid point $(i\\Delta n, j\\Delta s, k\\Delta z)$ and time level $m \\Delta t$. The discretized form of the equation is:\n$$\n\\frac{\\phi_{i,j,k}^{m+1} - \\phi_{i,j,k}^m}{\\Delta t} = \\nu \\left( \\frac{\\phi_{i+1,j,k}^m - 2\\phi_{i,j,k}^m + \\phi_{i-1,j,k}^m}{(\\Delta n)^2} + \\frac{\\phi_{i,j+1,k}^m - 2\\phi_{i,j,k}^m + \\phi_{i,j-1,k}^m}{(\\Delta s)^2} + \\frac{\\phi_{i,j,k+1}^m - 2\\phi_{i,j,k}^m + \\phi_{i,j,k-1}^m}{(\\Delta z)^2} \\right)\n$$\n\nTo analyze the stability of this scheme, we perform a von Neumann stability analysis. We consider the evolution of a single Fourier mode of the numerical error, represented as:\n$$\n\\phi_{i,j,k}^m = G^m \\exp(I(i\\theta_n + j\\theta_s + k\\theta_z))\n$$\nwhere $I = \\sqrt{-1}$, $G$ is the amplification factor per time step, and $\\theta_n = k_n \\Delta n$, $\\theta_s = k_s \\Delta s$, $\\theta_z = k_z \\Delta z$ are the phase angles corresponding to wavenumbers $k_n, k_s, k_z$. Substituting this into the discretized equation and dividing by the common exponential term yields an expression for the amplification factor $G = \\phi^{m+1}/\\phi^m$:\n$$\n\\frac{G - 1}{\\Delta t} = \\nu \\left( \\frac{\\exp(I\\theta_n) - 2 + \\exp(-I\\theta_n)}{(\\Delta n)^2} + \\frac{\\exp(I\\theta_s) - 2 + \\exp(-I\\theta_s)}{(\\Delta s)^2} + \\frac{\\exp(I\\theta_z) - 2 + \\exp(-I\\theta_z)}{(\\Delta z)^2} \\right)\n$$\nUsing the identity $\\exp(I\\theta) + \\exp(-I\\theta) = 2\\cos(\\theta)$, we simplify the expression:\n$$\nG - 1 = 2\\nu \\Delta t \\left( \\frac{\\cos(\\theta_n) - 1}{(\\Delta n)^2} + \\frac{\\cos(\\theta_s) - 1}{(\\Delta s)^2} + \\frac{\\cos(\\theta_z) - 1}{(\\Delta z)^2} \\right)\n$$\nFurther using the trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we obtain:\n$$\nG = 1 - 4\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_n/2)}{(\\Delta n)^2} + \\frac{\\sin^2(\\theta_s/2)}{(\\Delta s)^2} + \\frac{\\sin^2(\\theta_z/2)}{(\\Delta z)^2} \\right)\n$$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must not exceed unity for any possible Fourier mode, i.e., $|G| \\le 1$. Since $G$ is real and the term subtracted from $1$ is always non-negative, $G \\le 1$ is always satisfied. The stability condition thus reduces to $G \\ge -1$:\n$$\n1 - 4\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_n/2)}{(\\Delta n)^2} + \\frac{\\sin^2(\\theta_s/2)}{(\\Delta s)^2} + \\frac{\\sin^2(\\theta_z/2)}{(\\Delta z)^2} \\right) \\ge -1\n$$\n$$\n2 \\ge 4\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_n/2)}{(\\Delta n)^2} + \\frac{\\sin^2(\\theta_s/2)}{(\\Delta s)^2} + \\frac{\\sin^2(\\theta_z/2)}{(\\Delta z)^2} \\right)\n$$\nRearranging for $\\Delta t$:\n$$\n\\Delta t \\le \\frac{1}{2\\nu \\left( \\frac{\\sin^2(\\theta_n/2)}{(\\Delta n)^2} + \\frac{\\sin^2(\\theta_s/2)}{(\\Delta s)^2} + \\frac{\\sin^2(\\theta_z/2)}{(\\Delta z)^2} \\right)}\n$$\nThis must hold for all phase angles $\\theta_n, \\theta_s, \\theta_z \\in [-\\pi, \\pi]$. The most restrictive condition on $\\Delta t$ occurs when the denominator is maximized. This happens for the highest frequency modes resolvable on the grid, where $\\theta_n = \\theta_s = \\theta_z = \\pi$, which gives $\\sin^2(\\pi/2) = 1$. This leads to the final viscous time-step restriction:\n$$\n\\Delta t_{\\mathrm{visc}} \\le \\frac{1}{2\\nu \\left( \\frac{1}{(\\Delta n)^2} + \\frac{1}{(\\Delta s)^2} + \\frac{1}{(\\Delta z)^2} \\right)}\n$$\n\nWe now apply this formula to the given data. First, we compute the kinematic viscosity $\\nu$:\n$\\mu = 1.8 \\times 10^{-5}\\ \\mathrm{Pa \\cdot s}$\n$\\rho = 1.2\\ \\mathrm{kg/m^3}$\n$$\n\\nu = \\frac{\\mu}{\\rho} = \\frac{1.8 \\times 10^{-5}\\ \\mathrm{kg/(m \\cdot s)}}{1.2\\ \\mathrm{kg/m^3}} = 1.5 \\times 10^{-5}\\ \\mathrm{m^2/s}\n$$\nLet the summation term be $S = \\frac{1}{(\\Delta n)^2} + \\frac{1}{(\\Delta s)^2} + \\frac{1}{(\\Delta z)^2}$. Then $\\Delta t_{\\mathrm{visc}} = \\frac{1}{2\\nu S}$.\n\nFor the near-wall region:\n$\\Delta n_{\\mathrm{w}} = 1.0 \\times 10^{-6}\\ \\mathrm{m}$\n$\\Delta s_{\\mathrm{w}} = 1.0 \\times 10^{-3}\\ \\mathrm{m}$\n$\\Delta z_{\\mathrm{w}} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$\n$$\nS_{\\mathrm{w}} = \\frac{1}{(1.0 \\times 10^{-6})^2} + \\frac{1}{(1.0 \\times 10^{-3})^2} + \\frac{1}{(5.0 \\times 10^{-4})^2} \\\\\nS_{\\mathrm{w}} = 1.0 \\times 10^{12} + 1.0 \\times 10^{6} + 4.0 \\times 10^{6} = 1,000,005,000,000\\ \\mathrm{m^{-2}}\n$$\n$$\n\\Delta t_{\\mathrm{visc},\\mathrm{w}} = \\frac{1}{2(1.5 \\times 10^{-5}) (1.000005 \\times 10^{12})} = \\frac{1}{3.000015 \\times 10^7} \\approx 3.33 \\times 10^{-8}\\ \\mathrm{s}\n$$\nFor the outer layer:\n$\\Delta n_{\\mathrm{o}} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$\n$\\Delta s_{\\mathrm{o}} = 2.0 \\times 10^{-2}\\ \\mathrm{m}$\n$\\Delta z_{\\mathrm{o}} = 1.0 \\times 10^{-2}\\ \\mathrm{m}$\n$$\nS_{\\mathrm{o}} = \\frac{1}{(5.0 \\times 10^{-4})^2} + \\frac{1}{(2.0 \\times 10^{-2})^2} + \\frac{1}{(1.0 \\times 10^{-2})^2} \\\\\nS_{\\mathrm{o}} = 4.0 \\times 10^{6} + 2500 + 10000 = 4,012,500\\ \\mathrm{m^{-2}}\n$$\n$$\n\\Delta t_{\\mathrm{visc},\\mathrm{o}} = \\frac{1}{2(1.5 \\times 10^{-5}) (4.0125 \\times 10^{6})} = \\frac{1}{120.375} \\approx 8.307 \\times 10^{-3}\\ \\mathrm{s}\n$$\nThe required ratio $R$ is:\n$$\nR = \\frac{\\Delta t_{\\mathrm{visc},\\mathrm{w}}}{\\Delta t_{\\mathrm{visc},\\mathrm{o}}} = \\frac{1/(2\\nu S_{\\mathrm{w}})}{1/(2\\nu S_{\\mathrm{o}})} = \\frac{S_{\\mathrm{o}}}{S_{\\mathrm{w}}}\n$$\n$$\nR = \\frac{4,012,500}{1,000,005,000,000} = 4.01248... \\times 10^{-6}\n$$\nRounding to four significant figures, we get $R = 4.012 \\times 10^{-6}$.\n\nThe physical explanation for the severity of the viscous CFL restriction near walls lies in the derived formula for $\\Delta t_{\\mathrm{visc}}$. The maximum allowable time step is inversely proportional to the sum of the inverse squares of the grid spacings, $\\Delta t_{\\mathrm{visc}} \\propto \\left(\\sum_i \\frac{1}{\\Delta x_i^2}\\right)^{-1}$. On highly anisotropic boundary-layer meshes, the wall-normal cell size $\\Delta n$ is made extremely small to resolve the thin viscous sublayer. In this problem, $\\Delta n_{\\mathrm{w}} = 1.0 \\times 10^{-6}\\ \\mathrm{m}$, while $\\Delta s_{\\mathrm{w}}$ and $\\Delta z_{\\mathrm{w}}$ are orders of magnitude larger. The term $\\frac{1}{(\\Delta n_{\\mathrm{w}})^2} = 10^{12}\\ \\mathrm{m^{-2}}$ is six orders of magnitude larger than the other terms in the sum ($\\frac{1}{(\\Delta s_{\\mathrm{w}})^2} = 10^6\\ \\mathrm{m^{-2}}$ and $\\frac{1}{(\\Delta z_{\\mathrm{w}})^2} = 4 \\times 10^6\\ \\mathrm{m^{-2}}$). Consequently, the sum is utterly dominated by the smallest grid spacing, and the restriction approximates to:\n$$\n\\Delta t_{\\mathrm{visc}} \\approx \\frac{(\\Delta n_{\\mathrm{min}})^2}{2\\nu}\n$$\nThe quadratic dependence on the grid spacing means that halving the grid spacing reduces the maximum stable time step by a factor of four. For the extremely small $\\Delta n$ required for wall resolution, this leads to a prohibitively small time step. Physically, stability requires that the time step be small enough to resolve the diffusion of information across the smallest grid cell. Since diffusive time scales as the length squared, the very small $\\Delta n$ imposes a severe temporal constraint, making explicit schemes computationally expensive for wall-resolved simulations.",
            "answer": "$$\n\\boxed{4.012 \\times 10^{-6}}\n$$"
        }
    ]
}