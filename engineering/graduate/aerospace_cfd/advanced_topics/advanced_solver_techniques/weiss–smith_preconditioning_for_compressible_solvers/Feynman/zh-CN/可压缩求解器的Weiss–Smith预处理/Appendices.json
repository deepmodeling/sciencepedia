{
    "hands_on_practices": [
        {
            "introduction": "标准的迎风格式可压缩求解器在低马赫数下会遇到严重的收敛问题和精度损失。本练习旨在通过对 Roe 类格式进行线性化分析，揭示这一问题的根源。您将推导出由数值耗散产生的等效人工扩散项，并证明其在低马赫数极限下对压力场产生的不成比例的巨大影响，从而为预处理的必要性提供坚实的理论依据 。",
            "id": "4006379",
            "problem": "考虑以守恒变量 $\\boldsymbol{U} = (\\rho, \\rho u, \\rho E)^{\\mathsf{T}}$ 书写的一维可压缩欧拉方程，该方程使用Roe格式近似黎曼求解器在间距为 $\\Delta x$ 的均匀网格上进行空间离散。\n\n界面 $i+\\tfrac{1}{2}$ 处的数值通量由中心平均项和耗散项构成，其中耗散项源于通量雅可比矩阵在Roe平均状态下的谱分解。假设一个均匀基流，其密度 $\\rho_0$、压力 $p_0$ 和速度 $u_0$ 均为常数，并定义马赫数 $M = u_0/a_0$，其中 $a_0 = \\sqrt{\\gamma p_0/\\rho_0}$ 是声速，$\\gamma$ 是比热比。考虑围绕该基态的小振幅、平滑变化的等熵扰动。\n\n从可压缩欧拉方程和Roe格式通量的结构出发，对半离散格式在均匀基态附近进行线性化，并推导由数值耗散为压力扰动 $p'(x,t)$ 引入的主阶等效微分算子。仔细使用泰勒展开将通量差分与空间导数联系起来，并明确指出声学特征速度如何进入线性化系统中出现的等效人工扩散项。在低马赫数极限 $M \\to 0$ 下，确定人工压力扩散系数对 $M$ 的主阶依赖关系。\n\n然后，解释为何在使用朴素通量分裂（即在耗散项中使用未修正的声学特征值）时，这种标度关系会在 $M \\to 0$ 时破坏压力-速度耦合。并简要地将其与 Weiss–Smith 预处理的动机联系起来，该预处理方法通过重新标度声学贡献来恢复正确的低马赫数行为。\n\n你的最终任务是，给出在无预处理的Roe格式耗散所引起的等效线性化压力演化中，乘以 $\\partial_{xx} p'$ 的主阶人工扩散系数的解析表达式，该表达式需用 $\\Delta x$、$u_0$ 和 $M$ 表示。请用国际单位制单位 $\\mathrm{m}^2/\\mathrm{s}$ 表达你的最终答案。无需进行数值计算。",
            "solution": "分析始于守恒形式的一维可压缩欧拉方程，$\\partial_t \\boldsymbol{U} + \\partial_x \\boldsymbol{F}(\\boldsymbol{U}) = 0$，其中状态向量为 $\\boldsymbol{U} = (\\rho, \\rho u, \\rho E)^{\\mathsf{T}}$，通量向量为 $\\boldsymbol{F}(\\boldsymbol{U}) = (\\rho u, \\rho u^2 + p, u(\\rho E + p))^{\\mathsf{T}}$。单位质量总能量为 $E = \\frac{p}{\\rho(\\gamma-1)} + \\frac{1}{2}u^2$。\n\n使用Roe格式近似黎曼求解器在间距为 $\\Delta x$ 的均匀网格上进行半离散化，得到节点 $i$ 处的方程如下：\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x}(\\boldsymbol{F}_{i+1/2} - \\boldsymbol{F}_{i-1/2})\n$$\n数值通量 $\\boldsymbol{F}_{i+1/2}$ 由中心平均项和耗散项构成：\n$$\n\\boldsymbol{F}_{i+1/2} = \\frac{1}{2}(\\boldsymbol{F}(\\boldsymbol{U}_i) + \\boldsymbol{F}(\\boldsymbol{U}_{i+1})) - \\frac{1}{2} |\\tilde{\\boldsymbol{A}}_{i+1/2}| (\\boldsymbol{U}_{i+1} - \\boldsymbol{U}_i)\n$$\n其中 $\\tilde{\\boldsymbol{A}}_{i+1/2}$ 是在 $\\boldsymbol{U}_i$ 和 $\\boldsymbol{U}_{i+1}$ 之间的Roe平均状态下计算的通量雅可比矩阵 $\\partial\\boldsymbol{F}/\\partial\\boldsymbol{U}$。矩阵 $|\\tilde{\\boldsymbol{A}}|$ 通过谱分解 $\\tilde{\\boldsymbol{A}} = \\tilde{\\boldsymbol{R}} \\tilde{\\boldsymbol{\\Lambda}} \\tilde{\\boldsymbol{L}}$ 定义，因此 $|\\tilde{\\boldsymbol{A}}| = \\tilde{\\boldsymbol{R}} |\\tilde{\\boldsymbol{\\Lambda}}| \\tilde{\\boldsymbol{L}}$，其中 $|\\tilde{\\boldsymbol{\\Lambda}}|$ 是 $\\tilde{\\boldsymbol{A}}$ 特征值绝对值构成的对角矩阵。\n\n将通量表达式代入半离散方程，得到：\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{\\boldsymbol{F}_{i+1} - \\boldsymbol{F}_{i-1}}{2\\Delta x} + \\frac{1}{2\\Delta x} \\left( |\\tilde{\\boldsymbol{A}}_{i+1/2}|(\\boldsymbol{U}_{i+1} - \\boldsymbol{U}_i) - |\\tilde{\\boldsymbol{A}}_{i-1/2}|(\\boldsymbol{U}_{i} - \\boldsymbol{U}_{i-1}) \\right)\n$$\n第一项是通量导数的中心差分近似。第二项代表数值耗散。对于均匀基流 $(\\rho_0, u_0, p_0)$ 周围的小的、平滑的扰动，任何界面处的Roe平均雅可比矩阵 $\\tilde{\\boldsymbol{A}}$ 都可以近似为基态处的常数雅可比矩阵 $\\boldsymbol{A}_0$。作用于 $\\boldsymbol{U}_i$ 的耗散项算子于是变为：\n$$\n\\boldsymbol{D}_i \\approx \\frac{1}{2\\Delta x} |\\boldsymbol{A}_0| ((\\boldsymbol{U}_{i+1} - \\boldsymbol{U}_i) - (\\boldsymbol{U}_i - \\boldsymbol{U}_{i-1})) = \\frac{1}{2\\Delta x} |\\boldsymbol{A}_0| (\\boldsymbol{U}_{i+1} - 2\\boldsymbol{U}_i + \\boldsymbol{U}_{i-1})\n$$\n使用泰勒级数展开，$(\\boldsymbol{U}_{i+1} - 2\\boldsymbol{U}_i + \\boldsymbol{U}_{i-1})$ 项是 $(\\Delta x)^2 \\partial_{xx}\\boldsymbol{U}$ 的二阶近似。因此，数值耗散的主阶等效微分算子为：\n$$\n\\boldsymbol{D} = \\frac{\\Delta x}{2} |\\boldsymbol{A}_0| \\partial_{xx}\\boldsymbol{U}\n$$\n线性化的半离散格式等效于系统 $\\partial_t \\boldsymbol{U}' + \\boldsymbol{A}_0 \\partial_x \\boldsymbol{U}' = \\frac{\\Delta x}{2} |\\boldsymbol{A}_0| \\partial_{xx} \\boldsymbol{U}'$，其中 $\\boldsymbol{U}'$ 表示对基态的扰动。\n\n为了分析对压力的影响，我们变换到特征变量。令 $\\boldsymbol{L}_0$ 为 $\\boldsymbol{A}_0$ 的左特征向量矩阵。用 $\\boldsymbol{L}_0$ 左乘可将系统对角化，得到关于特征变量扰动 $\\boldsymbol{W} = \\boldsymbol{L}_0 \\boldsymbol{U}'$ 的一组解耦的对流-扩散方程：\n$$\n\\partial_t \\boldsymbol{W} + \\boldsymbol{\\Lambda}_0 \\partial_x \\boldsymbol{W} = \\frac{\\Delta x}{2} |\\boldsymbol{\\Lambda}_0| \\partial_{xx} \\boldsymbol{W}\n$$\n此处，$\\boldsymbol{\\Lambda}_0$ 是 $\\boldsymbol{A}_0$ 的特征值构成的对角矩阵，这些特征值即为特征速度：$\\lambda_1 = u_0$（熵波/接触波），$\\lambda_2 = u_0 - a_0$（左行声波），以及 $\\lambda_3 = u_0 + a_0$（右行声波），其中 $a_0 = \\sqrt{\\gamma p_0/\\rho_0}$。\n\n每个特征变量扰动 $w_k$ 遵循以下演化方程：\n$$\n\\partial_t w_k + \\lambda_k \\partial_x w_k = \\frac{\\Delta x}{2} |\\lambda_k| \\partial_{xx} w_k\n$$\n对于等熵扰动，压力变化 $dp$ 和密度变化 $d\\rho$ 通过 $dp = a^2 d\\rho$ 相关。对应于熵波的特征变量是静止的（$dw_1 \\propto dp - a^2 d\\rho = 0$）。声学特征扰动可以用原始变量扰动 $(p', u')$ 定义为 $dw_2 = dp' - \\rho_0 a_0 du'$ 和 $dw_3 = dp' + \\rho_0 a_0 du'$。由此，我们可以将压力扰动表示为 $p' = \\frac{1}{2}(w_2 + w_3)$。\n\n$p'$ 的演化方程可以通过将 $w_2$ 和 $w_3$ 的方程相加再除以2得到。得到的 $p'$ 方程中的扩散部分为：\n$$\nD_{p'} = \\frac{1}{2} \\left( \\frac{\\Delta x}{2}|\\lambda_2| \\partial_{xx}w_2 + \\frac{\\Delta x}{2}|\\lambda_3| \\partial_{xx}w_3 \\right) = \\frac{\\Delta x}{4} \\left( |u_0-a_0|\\partial_{xx}w_2 + |u_0+a_0|\\partial_{xx}w_3 \\right)\n$$\n为求 $p'$ 的人工扩散系数，我们代入 $w_2 = p' - \\rho_0 a_0 u'$ 和 $w_3 = p' + \\rho_0 a_0 u'$：\n$$\nD_{p'} = \\frac{\\Delta x}{4} \\left( |u_0-a_0|\\partial_{xx}(p' - \\rho_0 a_0 u') + |u_0+a_0|\\partial_{xx}(p' + \\rho_0 a_0 u') \\right)\n$$\n$\\partial_{xx}p'$ 项的系数即为人工压力扩散系数 $\\nu_{pp}$：\n$$\n\\nu_{pp} = \\frac{\\Delta x}{4} \\left( |u_0-a_0| + |u_0+a_0| \\right)\n$$\n在低马赫数极限（$M = u_0/a_0 \\to 0$）下，流动是亚音速的，即 $u_0  a_0$。因此，$|u_0-a_0| = a_0-u_0$ 且 $|u_0+a_0| = a_0+u_0$。该系数简化为：\n$$\n\\nu_{pp} = \\frac{\\Delta x}{4} \\left( (a_0 - u_0) + (a_0 + u_0) \\right) = \\frac{\\Delta x a_0}{2}\n$$\n为了用 $M=u_0/a_0$ 表示，我们代入 $a_0 = u_0/M$：\n$$\n\\nu_{pp} = \\frac{\\Delta x}{2} \\left(\\frac{u_0}{M}\\right) = \\frac{\\Delta x u_0}{2M}\n$$\n该表达式揭示了朴素可压缩求解器在低速下的核心问题。当 $M \\to 0$ 时，压力的人工扩散系数 $\\nu_{pp}$ 与 $M^{-1}$ 成比例，变得过大。低马赫数流动的物理行为趋近于不可压缩流，其中压力和速度通过一个椭圆约束（$\\nabla^2 p \\sim \\text{source}$）紧密耦合。巨大的人工压力扩散（由大的声速 $a_0$ 而非小的流速 $u_0$ 来标度）压倒了物理压力演化。它有效地将压力场与速度场解耦，阻止了格式正确捕捉不可压缩行为。这导致了严重的收敛性恶化和不准确的解，尤其是在压力场上。\n\nWeiss–Smith 预处理旨在修正这一缺陷。它修改了系统的时间导数项，从而起到重新标度系统雅可比矩阵特征值的作用。其目标是在低马赫数极限下，使所有特征值具有相同的数量级。对于数值通量，这对应于用一个重新标度的值替换耗散标度 $|\\lambda_k|$。具体来说，声速 $|u_0 \\pm a_0| \\approx a_0$ 被替换为一个与流速同量级的修正速度，即与 $u_0$ 成比例。这将人工压力扩散系数从 $O(a_0)$ 降低到 $O(u_0)$，从而恢复正确的压力-速度耦合，并确保格式具有正确的不可压缩极限。\n\n乘以 $\\partial_{xx}p'$ 的主阶人工扩散系数为 $\\frac{\\Delta x a_0}{2}$。用所要求的变量表示，即为 $\\frac{\\Delta x u_0}{2M}$。",
            "answer": "$$\\boxed{\\frac{\\Delta x u_0}{2M}}$$"
        },
        {
            "introduction": "在理解了预处理的必要性之后，我们将深入分析其对数值格式的具体影响。本练习要求您对一个简化的、经过 Weiss-Smith 预处理的线性系统进行 von Neumann 稳定性分析。通过这个经典的分析工具，您将能够量化预处理参数 $ \\beta $ 如何直接改变系统的特征值，并推导出显式时间格式的稳定性边界（CFL 条件），从而直观地理解为改善系统刚性所付出的稳定性代价 。",
            "id": "4006455",
            "problem": "在计算流体力学 (CFD) 的背景下，考虑围绕均匀状态的一维线性化等熵声学子系统，该系统源于可压缩欧拉方程。令原始变量向量为 $q = \\begin{pmatrix} p \\\\ u \\end{pmatrix}$，其中 $p$ 是压力，$u$ 是速度。假设基准密度 $\\rho$ 和声速 $a$ 为常数。该线性化系统可以写为\n$$\n\\frac{\\partial q}{\\partial t} + A \\frac{\\partial q}{\\partial x} = 0,\n$$\n其中通量雅可比矩阵为\n$$\nA = \\begin{pmatrix} 0  \\rho a^{2} \\\\ \\frac{1}{\\rho}  0 \\end{pmatrix}.\n$$\n为解决低马赫数刚性问题，应用 Weiss–Smith 预处理，使用对角预处理矩阵 $P(\\beta) = \\operatorname{diag}(\\beta, 1)$（其中 $0  \\beta \\leq 1$），得到预处理后的系统\n$$\nP(\\beta)\\,\\frac{\\partial q}{\\partial t} + A\\,\\frac{\\partial q}{\\partial x} = 0.\n$$\n在间距为 $\\Delta x$ 的均匀网格上，使用时间步长为 $\\Delta t$ 的显式向前欧拉时间步进法，以及对预处理算子的特征变量应用的一阶迎风空间离散，对此系统进行离散化。通过考虑单个傅里叶模态 $q_{j}^{n} = \\hat{q}^{n}\\exp(i \\theta j)$（其中 $j$ 索引网格点，$n$ 索引时间层）进行 von Neumann (傅里叶) 分析，以推导放大矩阵及其特征值。然后，根据预处理参数 $\\beta$ 和由下式定义的常规声学 Courant–Friedrichs–Lewy (CFL) 数\n$$\n\\mathrm{CFL}_{a} = \\frac{a\\,\\Delta t}{\\Delta x}\n$$\n来获得稳定性条件。通过将最大允许 $\\mathrm{CFL}_{a}$ 表示为 $\\beta$ 的函数，确定此显式格式在 $(\\beta,\\mathrm{CFL}_{a})$ 平面上的稳定性区域边界。以 $\\beta$ 表示的最大 $\\mathrm{CFL}_{a}$ 的单个闭式解析表达式的形式给出最终答案。无需四舍五入。CFL 数是无量纲的；请勿在最终答案中包含单位。",
            "solution": "用户希望找到预处理系统的稳定性条件。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n-   偏微分方程组为 $\\frac{\\partial q}{\\partial t} + A \\frac{\\partial q}{\\partial x} = 0$。\n-   原始变量向量为 $q = \\begin{pmatrix} p \\\\ u \\end{pmatrix}$，其中 $p$ 是压力，$u$ 是速度。\n-   通量雅可比矩阵为 $A = \\begin{pmatrix} 0  \\rho a^{2} \\\\ \\frac{1}{\\rho}  0 \\end{pmatrix}$，其中密度 $\\rho$ 和声速 $a$ 为常数。\n-   预处理矩阵为 $P(\\beta) = \\operatorname{diag}(\\beta, 1) = \\begin{pmatrix} \\beta  0 \\\\ 0  1 \\end{pmatrix}$，其中 $0  \\beta \\leq 1$。\n-   预处理后的系统为 $P(\\beta)\\,\\frac{\\partial q}{\\partial t} + A\\,\\frac{\\partial q}{\\partial x} = 0$。\n-   数值格式为：\n    -   时间积分：显式向前欧拉法。\n    -   空间离散：对预处理算子的特征变量应用一阶迎风格式。\n    -   网格：均匀网格，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。\n-   分析方法是使用单个模态 $q_{j}^{n} = \\hat{q}^{n}\\exp(i \\theta j)$ 的 von Neumann (傅里叶) 分析。\n-   常规声学 Courant–Friedrichs–Lewy (CFL) 数定义为 $\\mathrm{CFL}_{a} = \\frac{a\\,\\Delta t}{\\Delta x}$。\n-   目标是找到最大允许 $\\mathrm{CFL}_{a}$ 作为 $\\beta$ 的函数。\n\n**1.2. 使用提取的已知条件进行验证**\n-   **科学依据**：该问题设置在计算流体力学 (CFD) 的背景下，使用线性化欧拉方程（声学的标准模型）。Weiss–Smith 预处理是处理低马赫数流动的成熟技术。Von Neumann 稳定性分析是分析数值格式的基本工具。该问题牢固地植根于应用数学和流体力学的既定原则。\n-   **适定性**：问题定义清晰。它指明了控制方程、预处理、数值方法和分析技术。目标是一个特定的、可推导的量（稳定性边界）。预期会有一个唯一解。\n-   **客观性**：语言精确、数学化，并且没有任何主观性。\n-   **完整性与一致性**：提供了所有必需的矩阵、参数和定义。问题陈述中没有明显的矛盾。\n\n**1.3. 结论与行动**\n该问题被认为是**有效的**。我将继续进行求解。\n\n### 步骤 2：求解\n\n预处理后的系统由下式给出\n$$\nP(\\beta)\\,\\frac{\\partial q}{\\partial t} + A\\,\\frac{\\partial q}{\\partial x} = 0\n$$\n乘以预处理矩阵的逆矩阵 $P^{-1}(\\beta)$，我们得到一个标准守恒形式的系统：\n$$\n\\frac{\\partial q}{\\partial t} + P^{-1}(\\beta)A\\,\\frac{\\partial q}{\\partial x} = 0\n$$\n让我们将预处理后的通量雅可比矩阵 $A'$ 定义为\n$$\nA' = P^{-1}(\\beta)A\n$$\n已知 $P(\\beta) = \\begin{pmatrix} \\beta  0 \\\\ 0  1 \\end{pmatrix}$，其逆矩阵为 $P^{-1}(\\beta) = \\begin{pmatrix} 1/\\beta  0 \\\\ 0  1 \\end{pmatrix}$。\n因此，\n$$\nA' = \\begin{pmatrix} \\frac{1}{\\beta}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0  \\rho a^{2} \\\\ \\frac{1}{\\rho}  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\rho a^{2}}{\\beta} \\\\ \\frac{1}{\\rho}  0 \\end{pmatrix}\n$$\n空间离散是对预处理算子 $A'$ 的特征变量应用的一阶迎风格式。为此，我们首先需要找到 $A'$ 的特征值和特征向量，这将使我们能够解耦该系统。\n\n$A'$ 的特征值 $\\lambda'$ 是特征方程 $\\det(A' - \\lambda'I) = 0$ 的根。\n$$\n\\det\\begin{pmatrix} -\\lambda'  \\frac{\\rho a^{2}}{\\beta} \\\\ \\frac{1}{\\rho}  -\\lambda' \\end{pmatrix} = (-\\lambda')^2 - \\left(\\frac{\\rho a^{2}}{\\beta}\\right)\\left(\\frac{1}{\\rho}\\right) = (\\lambda')^2 - \\frac{a^2}{\\beta} = 0\n$$\n特征值代表了预处理系统的特征速度，它们是：\n$$\n\\lambda'_{1,2} = \\pm \\frac{a}{\\sqrt{\\beta}}\n$$\n我们可以定义一个到特征变量 $w$ 的变换，使得系统 $\\frac{\\partial q}{\\partial t} + A' \\frac{\\partial q}{\\partial x} = 0$ 成为一组解耦的标量对流方程：\n$$\n\\frac{\\partial w_k}{\\partial t} + \\lambda'_k \\frac{\\partial w_k}{\\partial x} = 0, \\quad k=1, 2\n$$\n问题为这些特征方程指定了一阶迎风空间离散，并结合向前欧拉时间步长。对于一个一般的标量对流方程 $\\frac{\\partial w}{\\partial t} + c \\frac{\\partial w}{\\partial x} = 0$，其格式为：\n$$\n\\frac{w_j^{n+1} - w_j^n}{\\Delta t} + c \\frac{w_j^n - w_{j-1}^n}{\\Delta x} = 0 \\quad \\text{如果 } c > 0\n$$\n$$\n\\frac{w_j^{n+1} - w_j^n}{\\Delta t} + c \\frac{w_{j+1}^n - w_j^n}{\\Delta x} = 0 \\quad \\text{如果 } c  0\n$$\n这里，$j$ 是网格点索引，$n$ 是时间层。\n\n对于我们的第一个特征场，我们有 $\\lambda'_1 = \\frac{a}{\\sqrt{\\beta}} > 0$。离散化方程为：\n$$\nw_{1,j}^{n+1} = w_{1,j}^n - \\frac{\\lambda'_1 \\Delta t}{\\Delta x} (w_{1,j}^n - w_{1,j-1}^n)\n$$\n对于我们的第二个特征场，我们有 $\\lambda'_2 = -\\frac{a}{\\sqrt{\\beta}}  0$。离散化方程为：\n$$\nw_{2,j}^{n+1} = w_{2,j}^n - \\frac{\\lambda'_2 \\Delta t}{\\Delta x} (w_{2,j+1}^n - w_{2,j}^n)\n$$\n现在我们进行 von Neumann 稳定性分析。我们代入单个傅里叶模态 $w_j^n = \\hat{w}^n e^{i \\theta j}$，其中 $\\theta = k \\Delta x$ 是无量纲波数。\n\n对于第一个方程（其中 $\\lambda'_1 > 0$）：\n$$\n\\hat{w}_1^{n+1} e^{i\\theta j} = \\hat{w}_1^n e^{i\\theta j} - \\frac{\\lambda'_1 \\Delta t}{\\Delta x} (\\hat{w}_1^n e^{i\\theta j} - \\hat{w}_1^n e^{i\\theta (j-1)})\n$$\n两边同除以 $\\hat{w}_1^n e^{i\\theta j}$，我们得到放大因子 $g_1 = \\hat{w}_1^{n+1} / \\hat{w}_1^n$：\n$$\ng_1 = 1 - \\frac{\\lambda'_1 \\Delta t}{\\Delta x} (1 - e^{-i\\theta})\n$$\n为保证稳定性，对于所有 $\\theta$，我们需要 $|g_1| \\leq 1$。令 $\\nu_1 = \\frac{\\lambda'_1 \\Delta t}{\\Delta x} = \\frac{a \\Delta t}{\\sqrt{\\beta} \\Delta x}$。\n$$\n|g_1|^2 = |1 - \\nu_1(1 - \\cos\\theta + i\\sin\\theta)|^2 = |(1 - \\nu_1 + \\nu_1\\cos\\theta) - i\\nu_1\\sin\\theta|^2\n$$\n$$\n|g_1|^2 = (1 - \\nu_1 + \\nu_1\\cos\\theta)^2 + (\\nu_1\\sin\\theta)^2\n$$\n$$\n|g_1|^2 = (1-\\nu_1)^2 + 2\\nu_1(1-\\nu_1)\\cos\\theta + \\nu_1^2\\cos^2\\theta + \\nu_1^2\\sin^2\\theta\n$$\n$$\n|g_1|^2 = 1 - 2\\nu_1 + \\nu_1^2 + 2\\nu_1(1-\\nu_1)\\cos\\theta + \\nu_1^2\n$$\n$$\n|g_1|^2 = 1 - 2\\nu_1(1-\\nu_1) - 2\\nu_1(1-\\nu_1)\\cos\\theta = 1 + 2\\nu_1(\\nu_1-1)(1-\\cos\\theta)\n$$\n由于 $\\nu_1 > 0$ 且 $1-\\cos\\theta \\ge 0$，要使 $|g_1|^2 \\le 1$，我们必须有 $2\\nu_1(\\nu_1-1) \\le 0$，这意味着 $\\nu_1-1 \\le 0$，即 $\\nu_1 \\le 1$。这是一阶迎风格式的标准 CFL 条件。\n\n对于第二个方程（其中 $\\lambda'_2  0$）：\n$$\n\\hat{w}_2^{n+1} e^{i\\theta j} = \\hat{w}_2^n e^{i\\theta j} - \\frac{\\lambda'_2 \\Delta t}{\\Delta x} (\\hat{w}_2^n e^{i\\theta (j+1)} - \\hat{w}_2^n e^{i\\theta j})\n$$\n放大因子 $g_2 = \\hat{w}_2^{n+1} / \\hat{w}_2^n$ 是：\n$$\ng_2 = 1 - \\frac{\\lambda'_2 \\Delta t}{\\Delta x} (e^{i\\theta} - 1)\n$$\n令 $\\nu_2 = \\frac{|\\lambda'_2| \\Delta t}{\\Delta x} = \\frac{a \\Delta t}{\\sqrt{\\beta} \\Delta x}$。注意 $\\nu_2 = \\nu_1$。$g_2$ 的表达式变为：\n$$\ng_2 = 1 + \\nu_2 (e^{i\\theta} - 1)\n$$\n对 $|g_2|^2$ 进行类似的计算可得：\n$$\n|g_2|^2 = |(1 - \\nu_2 + \\nu_2\\cos\\theta) + i\\nu_2\\sin\\theta|^2 = 1 + 2\\nu_2(\\nu_2-1)(1-\\cos\\theta)\n$$\n这导致了相同的稳定性要求，即 $\\nu_2 \\le 1$。\n\n系统的稳定性要求所有特征分量都稳定。由于 $\\nu_1 = \\nu_2$，单一条件是：\n$$\n\\frac{a \\Delta t}{\\sqrt{\\beta} \\Delta x} \\le 1\n$$\n问题将常规声学 CFL 数定义为 $\\mathrm{CFL}_{a} = \\frac{a \\Delta t}{\\Delta x}$。将此定义代入我们的稳定性条件，我们得到：\n$$\n\\frac{\\mathrm{CFL}_{a}}{\\sqrt{\\beta}} \\le 1\n$$\n$$\n\\mathrm{CFL}_{a} \\le \\sqrt{\\beta}\n$$\n这个不等式定义了 $(\\beta,\\mathrm{CFL}_{a})$ 平面上的稳定区域。该区域的边界对应于最大允许 CFL 数。因此，$\\mathrm{CFL}_{a}$ 的最大值由下式给出：\n$$\n\\mathrm{CFL}_{a, \\max} = \\sqrt{\\beta}\n$$\n这个表达式表示了作为预处理参数 $\\beta$ 函数的稳定性边界。对于未预处理的情况 ($\\beta=1$)，我们恢复了标准的声学 CFL 限制，即 $\\mathrm{CFL}_{a} \\le 1$。对于 $\\beta  1$，预处理收紧了此显式格式的稳定性限制。",
            "answer": "$$\n\\boxed{\\sqrt{\\beta}}\n$$"
        },
        {
            "introduction": "预处理并非万能，其应用范围有严格限制，尤其是在存在激波等间断的区域。本练习将通过一个思想实验，量化在激波区域错误地激活预处理所导致的物理误差，包括激波速度的偏差和非物理的熵产生。这个分析突显了在实际的 CFD 求解器中，必须配备可靠的激波传感器来动态开关预处理，以确保在不同流动区域都能恢复正确的双曲物理特性 。",
            "id": "4006394",
            "problem": "考虑一个理想气体的一维可压缩欧拉方程，其比热比为 $\\gamma$，气体常数为 $R$。该问题作为一个代表激波管的初值问题给出：在 $x0$ 处的左态为 $(\\rho_{L}, u_{L}=0, p_{L})$，在 $x>0$ 处的右态为 $(\\rho_{R}, u_{R}=0, p_{R})$，其中 $p_{L} > p_{R}$ 且 $\\rho_{L}, \\rho_{R} > 0$。这些方程使用一个计算流体力学 (CFD) 求解器进行离散化，该求解器采用 Weiss–Smith 预处理，通过修改声学特征值来加速低马赫数下的收敛。在物理上正确的、无预处理的系统中，特征声速为 $u \\pm a$，其中 $a = \\sqrt{\\gamma p / \\rho}$ 是当地声速。在 Weiss–Smith 预处理下，声速被修改为 $u \\pm a_{p}$，其中 $a_{p} = \\sqrt{\\beta}\\, a$，而 $0  \\beta \\leq 1$ 是预处理参数。在实践中，应在激波附近停用预处理以保持正确的双曲物理特性；然而，假设预处理在整个激波区域被错误地保持激活状态，且 $\\beta$ 为常数。\n\n假设激波向右态传播。为进行误差量化，使用在黎曼求解器的高级分析中属于标准做法的以下建模假设：\n1. Roe 型近似黎曼求解器所使用的激波速度可以由在代表性平均状态下评估的右行声学特征值表示，预处理的效果是在该特征值中用 $a_{p}$ 替换 $a$，同时保持对流部分 $u$ 不变。\n2. 代表性平均声速由左右两边声速的算术平均值近似，即 $\\bar{a} = \\dfrac{1}{2}\\left( a_{L} + a_{R} \\right)$，其中 $a_{L} = \\sqrt{\\dfrac{\\gamma p_{L}}{\\rho_{L}}}$ 和 $a_{R} = \\sqrt{\\dfrac{\\gamma p_{R}}{\\rho_{R}}}$。为估算由声速修正引起的位置误差，在激波管的早期阶段，代表性平均速度 $\\bar{u}$ 保持可忽略不计，因此对激波速度的主要贡献来自声学部分。\n3. 穿过局部平面正激波的熵变可以通过理想气体的标准正激波关系式，用上游马赫数 $M_{u}$（定义于激波固定坐标系）来表示。如果错误地使用预处理来评估激波，它会通过错误表示声学尺度，有效地将上游马赫数重新缩放为 $M_{p} = \\dfrac{M_{u}}{\\sqrt{\\beta}}$。\n\n从欧拉方程、守恒跳跃条件和正激波热力学关系式出发，推导：\n- 在时刻 $t>0$ 时，由于保持预处理器激活而导致的激波位置误差 $\\Delta x(t)$ 的闭式解析表达式，该误差定义为由预处理后的声学特征值预测的位置与由无预处理的声学特征值预测的位置之差。\n- 因使用 $M_{p}$ 而非 $M_{u}$ 评估激波热力学而产生的熵误差 $\\Delta s$ 的闭式解析表达式，使用理想气体穿过正激波的熵变公式表示：\n$$\ns_{2} - s_{1} = c_{v} \\ln\\!\\left(\\frac{p_{2}}{p_{1}}\\right) - R \\ln\\!\\left(\\frac{\\rho_{2}}{\\rho_{1}}\\right),\n$$\n其中 $c_{v} = \\dfrac{R}{\\gamma - 1}$，且 $\\dfrac{p_{2}}{p_{1}}$ 和 $\\dfrac{\\rho_{2}}{\\rho_{1}}$ 是写成上游马赫数 $M$ 的函数的标准正激波比：\n$$\n\\frac{p_{2}}{p_{1}}(M) = 1 + \\frac{2\\gamma}{\\gamma + 1}\\left(M^{2} - 1\\right), \\qquad\n\\frac{\\rho_{2}}{\\rho_{1}}(M) = \\frac{(\\gamma + 1) M^{2}}{(\\gamma - 1) M^{2} + 2}.\n$$\n\n您的最终答案必须是一个单行矩阵，其中包含 $\\Delta x(t)$ 和 $\\Delta s$ 的闭式解析表达式，且仅用 $\\beta$, $\\gamma$, $R$, $p_{L}$, $\\rho_{L}$, $p_{R}$, $\\rho_{R}$, $M_{u}$ 和 $t$ 表示。不要引入任何其他未定义的符号。如果代入数值，$\\Delta x(t)$ 的单位为米，$\\Delta s$ 的单位为焦耳每千克-开尔文，但最终答案需以无单位的符号形式报告。无需四舍五入。",
            "solution": "该问题已经过验证，并被确定为计算流体力学中一个适定且具有科学依据的问题。任务是推导因错误地对激波应用 Weiss–Smith 预处理而引起的激波位置误差 $\\Delta x(t)$ 和熵误差 $\\Delta s$ 的表达式。\n\n### 激波位置误差 $\\Delta x(t)$ 的推导\n\n激波位置误差 $\\Delta x(t)$ 定义为使用预处理的求解器预测的激波位置与未使用预处理的求解器预测的激波位置之差。激波的初始位置在 $t=0$ 时为 $x=0$。在稍后時刻 $t$ 的位置由 $x(t) = S \\cdot t$ 给出，其中 $S$ 是激波传播速度。\n\n根据问题的建模假设（1和2），激波速度由在代表性平均状态下评估的右行声学特征值 $u+a$ 近似。在此分析中，对流部分 $\\bar{u}$ 被假定为可忽略不计。\n\n因此，无预处理的激波速度 $S_{unpre}$ 由代表性平均声速 $\\bar{a}$ 近似：\n$$\nS_{unpre} \\approx \\bar{a}\n$$\n相应地，激波位置为：\n$$\nx_{unpre}(t) = S_{unpre} \\cdot t = \\bar{a} t\n$$\n在 Weiss–Smith 预处理下，声速 $a$ 被修改为 $a_{p} = \\sqrt{\\beta} a$。问题陈述指出特征值的对流部分 $u$ 保持不变。由于我们忽略了 $\\bar{u}$，预处理后的激波速度 $S_{pre}$ 由预处理后的代表性平均声速 $\\bar{a}_{p}$ 近似：\n$$\nS_{pre} \\approx \\bar{a}_{p} = \\sqrt{\\beta} \\bar{a}\n$$\n预处理下的相应激波位置为：\n$$\nx_{pre}(t) = S_{pre} \\cdot t = \\sqrt{\\beta} \\bar{a} t\n$$\n在时刻 $t$ 的激波位置误差是这两个位置之差：\n$$\n\\Delta x(t) = x_{pre}(t) - x_{unpre}(t) = \\sqrt{\\beta} \\bar{a} t - \\bar{a} t = (\\sqrt{\\beta} - 1) \\bar{a} t\n$$\n问题将代表性平均声速指定为左右两边初始声速的算术平均值：\n$$\n\\bar{a} = \\frac{1}{2} (a_{L} + a_{R})\n$$\n其中 $a_{L} = \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}}$ 和 $a_{R} = \\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}}$。\n\n将此代入 $\\Delta x(t)$ 的表达式中，得到位置误差的最终闭式表达式：\n$$\n\\Delta x(t) = (\\sqrt{\\beta} - 1) \\frac{t}{2} \\left( \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}} + \\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}} \\right)\n$$\n由于 $0  \\beta \\leq 1$，项 $(\\sqrt{\\beta} - 1)$ 小于或等于零，这表明预处理后的激波落后于正确的激波，这与人为减小的声速所预期的结果一致。\n\n### 熵误差 $\\Delta s$ 的推导\n\n熵误差 $\\Delta s$ 源于使用不正确的声学尺度评估跨激波的热力学跳跃条件，这导致了错误的有效马赫数。\n\n理想气体穿过正激波的比熵变化由下式给出：\n$$\n\\Delta s_{shock} = s_{2} - s_{1} = c_{v} \\ln\\left(\\frac{p_{2}}{p_{1}}\\right) - R \\ln\\left(\\frac{\\rho_{2}}{\\rho_{1}}\\right)\n$$\n其中 $c_{v} = \\frac{R}{\\gamma - 1}$，压力比 $\\frac{p_{2}}{p_{1}}$ 和密度比 $\\frac{\\rho_{2}}{\\rho_{1}}$ 是相对于激波的上游马赫数 $M$ 的函数。\n\n正确的熵变 $\\Delta s_{correct}$ 使用真实的上游马赫数 $M_{u}$ 计算：\n$$\n\\Delta s_{correct} = c_{v} \\ln\\left(\\frac{p_{2}}{p_{1}}(M_{u})\\right) - R \\ln\\left(\\frac{\\rho_{2}}{\\rho_{1}}(M_{u})\\right)\n$$\n根据建模假设3，错误激活的预处理器将有效马赫数重新缩放为 $M_{p} = \\frac{M_{u}}{\\sqrt{\\beta}}$。这导致了错误的熵变计算 $\\Delta s_{error}$：\n$$\n\\Delta s_{error} = c_{v} \\ln\\left(\\frac{p_{2}}{p_{1}}(M_{p})\\right) - R \\ln\\left(\\frac{\\rho_{2}}{\\rho_{1}}(M_{p})\\right)\n$$\n熵误差是差值 $\\Delta s = \\Delta s_{error} - \\Delta s_{correct}$：\n$$\n\\Delta s = \\left[ c_{v} \\ln\\left(\\frac{p_{2}}{p_{1}}(M_{p})\\right) - R \\ln\\left(\\frac{\\rho_{2}}{\\rho_{1}}(M_{p})\\right) \\right] - \\left[ c_{v} \\ln\\left(\\frac{p_{2}}{p_{1}}(M_{u})\\right) - R \\ln\\left(\\frac{\\rho_{2}}{\\rho_{1}}(M_{u})\\right) \\right]\n$$\n按 $c_{v}$ 和 $R$ 分组各项，并使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\n\\Delta s = c_{v} \\ln\\left(\\frac{\\frac{p_{2}}{p_{1}}(M_{p})}{\\frac{p_{2}}{p_{1}}(M_{u})}\\right) - R \\ln\\left(\\frac{\\frac{\\rho_{2}}{\\rho_{1}}(M_{p})}{\\frac{\\rho_{2}}{\\rho_{1}}(M_{u})}\\right)\n$$\n我们代入 $c_{v} = \\frac{R}{\\gamma - 1}$ 和给定的正激波关系式：\n$$\n\\frac{p_{2}}{p_{1}}(M) = 1 + \\frac{2\\gamma}{\\gamma + 1}\\left(M^{2} - 1\\right)\n$$\n$$\n\\frac{\\rho_{2}}{\\rho_{1}}(M) = \\frac{(\\gamma + 1) M^{2}}{(\\gamma - 1) M^{2} + 2}\n$$\n第一个对数的参数变为：\n$$\n\\frac{\\frac{p_{2}}{p_{1}}(M_{p})}{\\frac{p_{2}}{p_{1}}(M_{u})} = \\frac{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(M_{p}^{2} - 1\\right)}{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(M_{u}^{2} - 1\\right)} = \\frac{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(\\frac{M_u^{2}}{\\beta} - 1\\right)}{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(M_{u}^{2} - 1\\right)}\n$$\n第二个对数的参数变为：\n$$\n\\frac{\\frac{\\rho_{2}}{\\rho_{1}}(M_{p})}{\\frac{\\rho_{2}}{\\rho_{1}}(M_{u})} = \\frac{\\frac{(\\gamma + 1) M_{p}^{2}}{(\\gamma - 1) M_{p}^{2} + 2}}{\\frac{(\\gamma + 1) M_{u}^{2}}{(\\gamma - 1) M_{u}^{2} + 2}} = \\frac{M_{p}^{2}}{M_{u}^{2}} \\cdot \\frac{(\\gamma - 1) M_{u}^{2} + 2}{(\\gamma - 1) M_{p}^{2} + 2} = \\frac{1}{\\beta} \\frac{(\\gamma - 1) M_{u}^{2} + 2}{(\\gamma - 1) \\frac{M_{u}^{2}}{\\beta} + 2} = \\frac{1}{\\beta} \\frac{(\\gamma - 1) M_{u}^{2} + 2}{\\frac{(\\gamma - 1) M_{u}^{2} + 2\\beta}{\\beta}} = \\frac{(\\gamma - 1) M_{u}^{2} + 2}{(\\gamma - 1) M_{u}^{2} + 2\\beta}\n$$\n将这些代回 $\\Delta s$ 的表达式中，我们得到熵误差的最终闭式表达式：\n$$\n\\Delta s = \\frac{R}{\\gamma - 1} \\ln\\left( \\frac{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(\\frac{M_u^{2}}{\\beta} - 1\\right)}{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(M_u^{2} - 1\\right)} \\right) - R \\ln\\left( \\frac{(\\gamma - 1) M_u^{2} + 2}{(\\gamma - 1) M_u^{2} + 2\\beta} \\right)\n$$\n该表达式仅根据给定参数提供了比熵的误差。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(\\sqrt{\\beta} - 1) \\frac{t}{2} \\left( \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}} + \\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}} \\right)  \\frac{R}{\\gamma - 1} \\ln\\left( \\frac{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(\\frac{M_u^{2}}{\\beta} - 1\\right)}{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(M_u^{2} - 1\\right)} \\right) - R \\ln\\left( \\frac{(\\gamma - 1) M_u^{2} + 2}{(\\gamma - 1) M_u^{2} + 2\\beta} \\right)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}