{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp why Weiss-Smith preconditioning is essential, we must first diagnose the illness it is designed to cure. This exercise takes you to the heart of the problem by analyzing the behavior of a standard compressible flow solver in the low-Mach-number limit. By deriving the equivalent artificial diffusion for the pressure field, you will uncover how numerical dissipation, intended to provide stability, becomes unphysically large and damages the crucial pressure-velocity coupling as the flow velocity drops .",
            "id": "4006379",
            "problem": "Consider the one-dimensional compressible Euler equations written in conservative variables $\\boldsymbol{U} = (\\rho, \\rho u, \\rho E)^{\\mathsf{T}}$ and discretized in space on a uniform grid with spacing $\\Delta x$ using a Roe-type approximate Riemann solver. The numerical flux at an interface $i+\\tfrac{1}{2}$ is constructed by a central average plus a dissipation term derived from the spectral decomposition of the flux Jacobian at the Roe-averaged state. Assume a uniform base flow with constant density $\\rho_0$, pressure $p_0$, and velocity $u_0$, and define the Mach number $M = u_0/a_0$, where $a_0 = \\sqrt{\\gamma p_0/\\rho_0}$ is the speed of sound and $\\gamma$ is the ratio of specific heats. Consider small-amplitude, smoothly varying isentropic perturbations about this base state.\n\nStarting from the compressible Euler equations and the structure of a Roe-type flux, perform a linearization of the semi-discrete scheme about the uniform base state and derive the leading-order equivalent differential operator that the numerical dissipation induces for the pressure perturbation $p'(x,t)$. Carefully use Taylor expansions to relate flux differences to spatial derivatives, and explicitly identify how the acoustic characteristic speeds enter the equivalent artificial diffusion that appears in the linearized system. In the low-Mach-number limit $M \\to 0$, determine the leading-order dependence of the artificial pressure diffusion coefficient on $M$.\n\nThen, explain why this scaling damages pressure–velocity coupling as $M \\to 0$ when using naive flux splitting (i.e., using the unmodified acoustic eigenvalues in the dissipation), and briefly relate this to the motivation for Weiss–Smith preconditioning, which rescales the acoustic contributions to restore correct low-Mach behavior.\n\nYour final task is to provide the analytic expression for the leading-order artificial diffusion coefficient multiplying $\\partial_{xx} p'$ in the equivalent linearized pressure evolution induced by the Roe-type dissipation without preconditioning, expressed in terms of $\\Delta x$, $u_0$, and $M$. Express your final answer in SI units of $\\mathrm{m}^2/\\mathrm{s}$. No numerical evaluation is required.",
            "solution": "The analysis begins with the one-dimensional compressible Euler equations in conservative form, $\\partial_t \\boldsymbol{U} + \\partial_x \\boldsymbol{F}(\\boldsymbol{U}) = 0$, where the state vector is $\\boldsymbol{U} = (\\rho, \\rho u, \\rho E)^{\\mathsf{T}}$ and the flux vector is $\\boldsymbol{F}(\\boldsymbol{U}) = (\\rho u, \\rho u^2 + p, u(\\rho E + p))^{\\mathsf{T}}$. The total energy per unit mass is $E = \\frac{p}{\\rho(\\gamma-1)} + \\frac{1}{2}u^2$.\n\nA semi-discretization on a uniform grid with spacing $\\Delta x$ using a Roe-type approximate Riemann solver leads to the following equation at node $i$:\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x}(\\boldsymbol{F}_{i+1/2} - \\boldsymbol{F}_{i-1/2})\n$$\nThe numerical flux $\\boldsymbol{F}_{i+1/2}$ is constructed from a central average and a dissipation term:\n$$\n\\boldsymbol{F}_{i+1/2} = \\frac{1}{2}(\\boldsymbol{F}(\\boldsymbol{U}_i) + \\boldsymbol{F}(\\boldsymbol{U}_{i+1})) - \\frac{1}{2} |\\tilde{\\boldsymbol{A}}_{i+1/2}| (\\boldsymbol{U}_{i+1} - \\boldsymbol{U}_i)\n$$\nwhere $\\tilde{\\boldsymbol{A}}_{i+1/2}$ is the flux Jacobian $\\partial\\boldsymbol{F}/\\partial\\boldsymbol{U}$ evaluated at the Roe-averaged state between $\\boldsymbol{U}_i$ and $\\boldsymbol{U}_{i+1}$. The matrix $|\\tilde{\\boldsymbol{A}}|$ is defined via the spectral decomposition $\\tilde{\\boldsymbol{A}} = \\tilde{\\boldsymbol{R}} \\tilde{\\boldsymbol{\\Lambda}} \\tilde{\\boldsymbol{L}}$, such that $|\\tilde{\\boldsymbol{A}}| = \\tilde{\\boldsymbol{R}} |\\tilde{\\boldsymbol{\\Lambda}}| \\tilde{\\boldsymbol{L}}$, where $|\\tilde{\\boldsymbol{\\Lambda}}|$ is the diagonal matrix of the absolute values of the eigenvalues of $\\tilde{\\boldsymbol{A}}$.\n\nSubstituting the flux expression into the semi-discrete equation yields:\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{\\boldsymbol{F}_{i+1} - \\boldsymbol{F}_{i-1}}{2\\Delta x} + \\frac{1}{2\\Delta x} \\left( |\\tilde{\\boldsymbol{A}}_{i+1/2}|(\\boldsymbol{U}_{i+1} - \\boldsymbol{U}_i) - |\\tilde{\\boldsymbol{A}}_{i-1/2}|(\\boldsymbol{U}_{i} - \\boldsymbol{U}_{i-1}) \\right)\n$$\nThe first term is a central difference approximation of the flux derivative. The second term represents the numerical dissipation. For small, smooth perturbations around a uniform base flow $(\\rho_0, u_0, p_0)$, the Roe-averaged Jacobian $\\tilde{\\boldsymbol{A}}$ at any interface can be approximated by the constant Jacobian at the base state, $\\boldsymbol{A}_0$. The dissipation term operator on $\\boldsymbol{U}_i$ then becomes:\n$$\n\\boldsymbol{D}_i \\approx \\frac{1}{2\\Delta x} |\\boldsymbol{A}_0| ((\\boldsymbol{U}_{i+1} - \\boldsymbol{U}_i) - (\\boldsymbol{U}_i - \\boldsymbol{U}_{i-1})) = \\frac{1}{2\\Delta x} |\\boldsymbol{A}_0| (\\boldsymbol{U}_{i+1} - 2\\boldsymbol{U}_i + \\boldsymbol{U}_{i-1})\n$$\nUsing a Taylor series expansion, the term $(\\boldsymbol{U}_{i+1} - 2\\boldsymbol{U}_i + \\boldsymbol{U}_{i-1})$ is a second-order approximation of $(\\Delta x)^2 \\partial_{xx}\\boldsymbol{U}$. Thus, the leading-order equivalent differential operator for the numerical dissipation is:\n$$\n\\boldsymbol{D} = \\frac{\\Delta x}{2} |\\boldsymbol{A}_0| \\partial_{xx}\\boldsymbol{U}\n$$\nThe linearized semi-discrete scheme is equivalent to the system $\\partial_t \\boldsymbol{U}' + \\boldsymbol{A}_0 \\partial_x \\boldsymbol{U}' = \\frac{\\Delta x}{2} |\\boldsymbol{A}_0| \\partial_{xx} \\boldsymbol{U}'$, where $\\boldsymbol{U}'$ represents the perturbation from the base state.\n\nTo analyze the effect on pressure, we transform to characteristic variables. Let $\\boldsymbol{L}_0$ be the matrix of left eigenvectors of $\\boldsymbol{A}_0$. Multiplying by $\\boldsymbol{L}_0$ diagonalizes the system, yielding a set of decoupled advection-diffusion equations for the characteristic variable perturbations $\\boldsymbol{W} = \\boldsymbol{L}_0 \\boldsymbol{U}'$:\n$$\n\\partial_t \\boldsymbol{W} + \\boldsymbol{\\Lambda}_0 \\partial_x \\boldsymbol{W} = \\frac{\\Delta x}{2} |\\boldsymbol{\\Lambda}_0| \\partial_{xx} \\boldsymbol{W}\n$$\nHere, $\\boldsymbol{\\Lambda}_0$ is the diagonal matrix of eigenvalues of $\\boldsymbol{A}_0$, which are the characteristic speeds: $\\lambda_1 = u_0$ (entropy/contact wave), $\\lambda_2 = u_0 - a_0$ (left-running acoustic wave), and $\\lambda_3 = u_0 + a_0$ (right-running acoustic wave), with $a_0 = \\sqrt{\\gamma p_0/\\rho_0}$.\n\nEach characteristic variable perturbation $w_k$ evolves according to:\n$$\n\\partial_t w_k + \\lambda_k \\partial_x w_k = \\frac{\\Delta x}{2} |\\lambda_k| \\partial_{xx} w_k\n$$\nFor isentropic perturbations, the change in pressure $dp$ and density $d\\rho$ are related by $dp = a^2 d\\rho$. The characteristic variable corresponding to the entropy wave is stationary ($dw_1 \\propto dp - a^2 d\\rho = 0$). The acoustic characteristic perturbations can be defined in terms of primitive variable perturbations $(p', u')$ as $dw_2 = dp' - \\rho_0 a_0 du'$ and $dw_3 = dp' + \\rho_0 a_0 du'$. From this, we can express the pressure perturbation as $p' = \\frac{1}{2}(w_2 + w_3)$.\n\nThe evolution equation for $p'$ is obtained by summing the equations for $w_2$ and $w_3$ and dividing by $2$. The diffusion part of the resulting equation for $p'$ is:\n$$\nD_{p'} = \\frac{1}{2} \\left( \\frac{\\Delta x}{2}|\\lambda_2| \\partial_{xx}w_2 + \\frac{\\Delta x}{2}|\\lambda_3| \\partial_{xx}w_3 \\right) = \\frac{\\Delta x}{4} \\left( |u_0-a_0|\\partial_{xx}w_2 + |u_0+a_0|\\partial_{xx}w_3 \\right)\n$$\nTo find the artificial diffusion coefficient for $p'$, we substitute $w_2 = p' - \\rho_0 a_0 u'$ and $w_3 = p' + \\rho_0 a_0 u'$:\n$$\nD_{p'} = \\frac{\\Delta x}{4} \\left( |u_0-a_0|\\partial_{xx}(p' - \\rho_0 a_0 u') + |u_0+a_0|\\partial_{xx}(p' + \\rho_0 a_0 u') \\right)\n$$\nThe coefficient of the $\\partial_{xx}p'$ term is the artificial pressure diffusion coefficient, $\\nu_{pp}$:\n$$\n\\nu_{pp} = \\frac{\\Delta x}{4} \\left( |u_0-a_0| + |u_0+a_0| \\right)\n$$\nIn the low-Mach-number limit ($M = u_0/a_0 \\to 0$), the flow is subsonic, $u_0 < a_0$. Therefore, $|u_0-a_0| = a_0-u_0$ and $|u_0+a_0| = a_0+u_0$. The coefficient simplifies to:\n$$\n\\nu_{pp} = \\frac{\\Delta x}{4} \\left( (a_0 - u_0) + (a_0 + u_0) \\right) = \\frac{\\Delta x a_0}{2}\n$$\nTo express this in terms of $M=u_0/a_0$, we substitute $a_0 = u_0/M$:\n$$\n\\nu_{pp} = \\frac{\\Delta x}{2} \\left(\\frac{u_0}{M}\\right) = \\frac{\\Delta x u_0}{2M}\n$$\nThis expression reveals the core problem of naive compressible solvers at low speeds. As $M \\to 0$, the artificial diffusion coefficient for pressure $\\nu_{pp}$ scales as $M^{-1}$, becoming excessively large. The physical behavior of low-Mach-number flows approaches that of incompressible flow, where pressure and velocity are tightly coupled through an elliptic constraint ($\\nabla^2 p \\sim \\text{source}$). The enormous artificial pressure diffusion, scaled by the large acoustic speed $a_0$ rather than the small flow speed $u_0$, overwhelms the physical pressure evolution. It effectively decouples the pressure field from the velocity field, preventing the scheme from correctly capturing the incompressible behavior. This leads to severe convergence degradation and inaccurate solutions, particularly for the pressure field.\n\nWeiss–Smith preconditioning is designed to remedy this flaw. It modifies the system's time derivatives, which has the effect of re-scaling the eigenvalues of the system Jacobian. The goal is to make all eigenvalues of the same order of magnitude in the low-Mach limit. For the numerical flux, this corresponds to replacing the dissipation scaling $|\\lambda_k|$ with a re-scaled value. Specifically, the acoustic speeds $|u_0 \\pm a_0| \\approx a_0$ are replaced by a modified speed on the order of the flow velocity, i.e., scaling with $u_0$. This reduces the artificial pressure diffusion coefficient from $O(a_0)$ to $O(u_0)$, thereby restoring the correct pressure-velocity coupling and ensuring the scheme has the proper incompressible limit.\n\nThe leading-order artificial diffusion coefficient multiplying $\\partial_{xx}p'$ is $\\frac{\\Delta x a_0}{2}$. Expressed in the requested variables, this is $\\frac{\\Delta x u_0}{2M}$.",
            "answer": "$$\\boxed{\\frac{\\Delta x u_0}{2M}}$$"
        },
        {
            "introduction": "Having identified the issue of numerical stiffness, we now explore how preconditioning offers a direct solution by rescaling the system's eigenvalues. However, this modification is not without consequences, particularly for the stability of time-marching schemes. This practice asks you to perform a von Neumann stability analysis to quantify the precise relationship between the preconditioning parameter $\\beta$ and the maximum allowable Courant–Friedrichs–Lewy (CFL) number, revealing a fundamental trade-off between alleviating stiffness and the time-step restrictions in explicit solvers .",
            "id": "4006455",
            "problem": "Consider the one-dimensional linearized isentropic acoustic subsystem of the compressible Euler equations about a uniform state within the context of Computational Fluid Dynamics (CFD). Let the primitive variable vector be $q = \\begin{pmatrix} p \\\\ u \\end{pmatrix}$, where $p$ is pressure and $u$ is velocity. Assume constant base density $\\rho$ and constant speed of sound $a$. The linearized system can be written as\n$$\n\\frac{\\partial q}{\\partial t} + A \\frac{\\partial q}{\\partial x} = 0,\n$$\nwith the flux Jacobian\n$$\nA = \\begin{pmatrix} 0 & \\rho a^{2} \\\\ \\frac{1}{\\rho} & 0 \\end{pmatrix}.\n$$\nTo address low-Mach-number stiffness, apply Weiss–Smith preconditioning using a diagonal preconditioning matrix $P(\\beta) = \\operatorname{diag}(1/\\beta, 1)$ (with $0 < \\beta \\leq 1$), producing the preconditioned system\n$$\nP(\\beta)\\,\\frac{\\partial q}{\\partial t} + A\\,\\frac{\\partial q}{\\partial x} = 0.\n$$\nDiscretize this system on a uniform grid with spacing $\\Delta x$ using explicit forward Euler time stepping with time step $\\Delta t$, and a first-order upwind spatial discretization applied in characteristic variables of the preconditioned operator. Perform a von Neumann (Fourier) analysis by considering a single Fourier mode $q_{j}^{n} = \\hat{q}^{n}\\exp(i \\theta j)$, where $j$ indexes grid points and $n$ indexes time levels, to derive the amplification matrix and its eigenvalues. Then, obtain the stability condition in terms of the preconditioning parameter $\\beta$ and the conventional acoustic Courant–Friedrichs–Lewy (CFL) number defined by\n$$\n\\mathrm{CFL}_{a} = \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\nDetermine the boundary of the stability region in the $(\\beta,\\mathrm{CFL}_{a})$-plane for this explicit scheme by expressing the maximal admissible $\\mathrm{CFL}_{a}$ as a function of $\\beta$. Provide the final answer as a single closed-form analytic expression for the maximal $\\mathrm{CFL}_{a}$ in terms of $\\beta$. No rounding is required. The CFL number is dimensionless; do not include units in your final answer.",
            "solution": "The preconditioned system is given by $P(\\beta)\\,\\frac{\\partial q}{\\partial t} + A\\,\\frac{\\partial q}{\\partial x} = 0$. We can rewrite this in standard form by multiplying by the inverse of the preconditioning matrix, $P^{-1}(\\beta)$:\n$$\n\\frac{\\partial q}{\\partial t} + P^{-1}(\\beta)A\\,\\frac{\\partial q}{\\partial x} = 0\n$$\nLet's define the preconditioned flux Jacobian as $A' = P^{-1}(\\beta)A$. Given $P(\\beta) = \\operatorname{diag}(1/\\beta, 1)$, its inverse is $P^{-1}(\\beta) = \\operatorname{diag}(\\beta, 1)$. Thus, the preconditioned Jacobian is:\n$$\nA' = \\begin{pmatrix} \\beta & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & \\rho a^{2} \\\\ \\frac{1}{\\rho} & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\beta \\rho a^{2} \\\\ \\frac{1}{\\rho} & 0 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda'$ of $A'$ represent the characteristic speeds of the preconditioned system. They are the roots of the characteristic equation $\\det(A' - \\lambda'I) = 0$:\n$$\n\\det\\begin{pmatrix} -\\lambda' & \\beta \\rho a^{2} \\\\ \\frac{1}{\\rho} & -\\lambda' \\end{pmatrix} = (-\\lambda')^2 - \\left(\\beta \\rho a^{2}\\right)\\left(\\frac{1}{\\rho}\\right) = (\\lambda')^2 - \\beta a^2 = 0\n$$\nThe eigenvalues are $\\lambda'_{1,2} = \\pm a\\sqrt{\\beta}$. These are the preconditioned acoustic wave speeds.\n\nThe numerical scheme consists of a first-order upwind discretization of the characteristic equations combined with a forward Euler time step. For a scalar advection equation $\\frac{\\partial w}{\\partial t} + c \\frac{\\partial w}{\\partial x} = 0$, the von Neumann stability analysis of this scheme yields the Courant number condition $|c|\\frac{\\Delta t}{\\Delta x} \\leq 1$.\n\nFor our preconditioned system, the stability is governed by the fastest characteristic speed. The stability condition for the entire system is therefore:\n$$\n\\max(|\\lambda'_{1,2}|) \\frac{\\Delta t}{\\Delta x} \\leq 1\n$$\nSubstituting the magnitude of the preconditioned eigenvalues, we get:\n$$\na\\sqrt{\\beta} \\frac{\\Delta t}{\\Delta x} \\leq 1\n$$\nThe problem defines the conventional acoustic CFL number as $\\mathrm{CFL}_{a} = \\frac{a\\,\\Delta t}{\\Delta x}$. Substituting this definition into our stability condition gives:\n$$\n\\sqrt{\\beta} \\cdot \\mathrm{CFL}_{a} \\leq 1\n$$\nSolving for $\\mathrm{CFL}_{a}$, we find the stability constraint:\n$$\n\\mathrm{CFL}_{a} \\leq \\frac{1}{\\sqrt{\\beta}}\n$$\nThis inequality defines the stable region in the $(\\beta, \\mathrm{CFL}_{a})$-plane. The boundary of this region corresponds to the maximum admissible CFL number. For the unpreconditioned case ($\\beta=1$), we recover the standard acoustic CFL limit, $\\mathrm{CFL}_{a} \\le 1$. For low-Mach-number flows, $\\beta$ is chosen to be small ($\\beta \\ll 1$), which allows for a much larger CFL number, indicating that larger time steps can be taken, hence accelerating convergence to steady state.",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{\\beta}}}\n$$"
        },
        {
            "introduction": "A crucial aspect of mastering any numerical technique is understanding its domain of applicability. Weiss-Smith preconditioning is tailored for low-Mach flows and loses its physical basis in transonic or supersonic regions containing discontinuities like shocks. This final exercise provides a stark illustration of this limitation by having you quantify the errors in shock speed and entropy production that arise if preconditioning is mistakenly left active, cementing the understanding that this powerful tool must be applied judiciously .",
            "id": "4006394",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma$ and gas constant $R$, posed as an initial-value problem representative of a shock tube: the left state at $x<0$ is $(\\rho_{L}, u_{L}=0, p_{L})$ and the right state at $x>0$ is $(\\rho_{R}, u_{R}=0, p_{R})$, with $p_{L} > p_{R}$ and $\\rho_{L}, \\rho_{R} > 0$. The equations are discretized using a Computational Fluid Dynamics (CFD) solver that employs Weiss–Smith preconditioning to accelerate convergence at low Mach number by modifying the acoustic eigenvalues. In the physically correct, unpreconditioned system, the characteristic acoustic speeds are $u \\pm a$, where $a = \\sqrt{\\gamma p / \\rho}$ is the local sound speed. Under Weiss–Smith preconditioning, the acoustic speeds are modified to $u \\pm a_{p}$, with $a_{p} = \\sqrt{\\beta}\\, a$, where $0 < \\beta \\leq 1$ is the preconditioning parameter. In practice, preconditioning should be deactivated near shocks to preserve correct hyperbolic physics; however, suppose it is mistakenly left active with a constant $\\beta$ across the shock.\n\nAssume the shock propagates into the right state. For the purpose of error quantification, use the following modeling assumptions that are standard in advanced analysis of Riemann solvers:\n1. The shock speed used by a Roe-type approximate Riemann solver can be represented by the right-going acoustic eigenvalue evaluated at a representative average state, and the effect of preconditioning is to replace $a$ by $a_{p}$ in that eigenvalue while leaving the convective part $u$ unchanged.\n2. The representative average sound speed is approximated by the arithmetic mean of the left and right sound speeds, $\\bar{a} = \\dfrac{1}{2}\\left( a_{L} + a_{R} \\right)$, with $a_{L} = \\sqrt{\\dfrac{\\gamma p_{L}}{\\rho_{L}}}$ and $a_{R} = \\sqrt{\\dfrac{\\gamma p_{R}}{\\rho_{R}}}$. The representative average velocity $\\bar{u}$ remains negligible at early times in the shock tube for the purpose of estimating the position error induced by the acoustic speed modification, so the dominant contribution to the shock speed is the acoustic part.\n3. The entropy change across a locally planar, normal shock can be expressed in terms of the upstream Mach number $M_{u}$ (defined relative to the shock-fixed frame) via the standard normal-shock relations for an ideal gas. If preconditioning is erroneously used to evaluate the shock, it effectively rescales the upstream Mach number to $M_{p} = \\dfrac{M_{u}}{\\sqrt{\\beta}}$ by misrepresenting the acoustic scale.\n\nStarting from the Euler equations, conservation jump conditions, and the normal-shock thermodynamic relations, derive:\n- A closed-form analytic expression for the shock position error $\\Delta x(t)$ at time $t>0$ resulting from leaving the preconditioner active, defined as the difference between the position predicted by the preconditioned acoustic eigenvalue and the position predicted by the unpreconditioned acoustic eigenvalue.\n- A closed-form analytic expression for the entropy error $\\Delta s$ resulting from evaluating the shock thermodynamics with $M_{p}$ instead of $M_{u}$, expressed using the ideal-gas entropy change across a normal shock:\n$$\ns_{2} - s_{1} = c_{v} \\ln\\!\\left(\\frac{p_{2}}{p_{1}}\\right) - R \\ln\\!\\left(\\frac{\\rho_{2}}{\\rho_{1}}\\right),\n$$\nwhere $c_{v} = \\dfrac{R}{\\gamma - 1}$ and $\\dfrac{p_{2}}{p_{1}}$ and $\\dfrac{\\rho_{2}}{\\rho_{1}}$ are the standard normal-shock ratios written as functions of the upstream Mach number $M$:\n$$\n\\frac{p_{2}}{p_{1}}(M) = 1 + \\frac{2\\gamma}{\\gamma + 1}\\left(M^{2} - 1\\right), \\qquad\n\\frac{\\rho_{2}}{\\rho_{1}}(M) = \\frac{(\\gamma + 1) M^{2}}{(\\gamma - 1) M^{2} + 2}.\n$$\n\nYour final answer must be a single row matrix containing $\\Delta x(t)$ and $\\Delta s$ as closed-form analytic expressions in terms of $\\beta$, $\\gamma$, $R$, $p_{L}$, $\\rho_{L}$, $p_{R}$, $\\rho_{R}$, $M_{u}$, and $t$ only. Do not introduce any additional undefined symbols. Express $\\Delta x(t)$ in meters and $\\Delta s$ in Joules per kilogram-Kelvin if numerical values are substituted, but report the final answer symbolically without units. No rounding is required.",
            "solution": "### Derivation of Shock Position Error $\\Delta x(t)$\n\nThe shock position error, $\\Delta x(t)$, is the difference between the shock position predicted with preconditioning and the one predicted without it. The position at time $t$ is $x(t) = S \\cdot t$, where $S$ is the shock propagation speed.\n\nBased on the problem's modeling assumptions, the shock speed is approximated by the right-going acoustic eigenvalue, $u+a$, evaluated at a representative average state, with the convective part $\\bar{u}$ neglected.\n\nThe unpreconditioned shock speed, $S_{unpre}$, is approximated by the average sound speed, $\\bar{a}$:\n$$\nS_{unpre} \\approx \\bar{a}\n$$\nThe corresponding shock position is $x_{unpre}(t) = \\bar{a} t$.\n\nWith Weiss–Smith preconditioning, the acoustic speed is modified to $a_{p} = \\sqrt{\\beta} a$. The preconditioned shock speed, $S_{pre}$, is thus approximated by the preconditioned average sound speed:\n$$\nS_{pre} \\approx \\bar{a}_{p} = \\sqrt{\\beta} \\bar{a}\n$$\nThe corresponding shock position is $x_{pre}(t) = \\sqrt{\\beta} \\bar{a} t$.\n\nThe position error is the difference between these positions:\n$$\n\\Delta x(t) = x_{pre}(t) - x_{unpre}(t) = \\sqrt{\\beta} \\bar{a} t - \\bar{a} t = (\\sqrt{\\beta} - 1) \\bar{a} t\n$$\nUsing the specified arithmetic mean for the average sound speed, $\\bar{a} = \\frac{1}{2} (a_{L} + a_{R})$, we get:\n$$\n\\Delta x(t) = (\\sqrt{\\beta} - 1) \\frac{t}{2} \\left( \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}} + \\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}} \\right)\n$$\n\n### Derivation of Entropy Error $\\Delta s$\n\nThe entropy error, $\\Delta s$, results from evaluating the thermodynamic jump conditions using an incorrect effective Mach number due to preconditioning. The change in specific entropy across a normal shock is:\n$$\n\\Delta s_{shock} = c_{v} \\ln\\left(\\frac{p_{2}}{p_{1}}\\right) - R \\ln\\left(\\frac{\\rho_{2}}{\\rho_{1}}\\right)\n$$\nwhere the ratios are functions of the upstream Mach number $M$. The correct entropy change, $\\Delta s_{correct}$, is calculated using the true upstream Mach number, $M_{u}$.\n\nThe erroneous preconditioning rescales the effective Mach number to $M_{p} = M_{u}/\\sqrt{\\beta}$. The resulting incorrect entropy change is $\\Delta s_{error} = \\Delta s_{shock}(M_p)$. The total entropy error is the difference $\\Delta s = \\Delta s_{error} - \\Delta s_{correct}$:\n$$\n\\Delta s = \\left[ c_{v} \\ln\\left(\\frac{p_{2}}{p_{1}}(M_{p})\\right) - R \\ln\\left(\\frac{\\rho_{2}}{\\rho_{1}}(M_{p})\\right) \\right] - \\left[ c_{v} \\ln\\left(\\frac{p_{2}}{p_{1}}(M_{u})\\right) - R \\ln\\left(\\frac{\\rho_{2}}{\\rho_{1}}(M_{u})\\right) \\right]\n$$\nGrouping terms and using logarithm properties:\n$$\n\\Delta s = c_{v} \\ln\\left(\\frac{\\frac{p_{2}}{p_{1}}(M_{p})}{\\frac{p_{2}}{p_{1}}(M_{u})}\\right) - R \\ln\\left(\\frac{\\frac{\\rho_{2}}{\\rho_{1}}(M_{p})}{\\frac{\\rho_{2}}{\\rho_{1}}(M_{u})}\\right)\n$$\nSubstituting the normal-shock relations for pressure and density ratios, along with $M_p = M_u/\\sqrt{\\beta}$ and $c_v = R/(\\gamma-1)$, yields the final expression:\n$$\n\\Delta s = \\frac{R}{\\gamma - 1} \\ln\\left( \\frac{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(\\frac{M_u^{2}}{\\beta} - 1\\right)}{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(M_u^{2} - 1\\right)} \\right) - R \\ln\\left( \\frac{(\\gamma - 1) M_u^{2} + 2}{(\\gamma - 1) M_u^{2} + 2\\beta} \\right)\n$$\nThis expression provides the error in specific entropy solely in terms of the given parameters.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(\\sqrt{\\beta} - 1) \\frac{t}{2} \\left( \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}} + \\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}} \\right) & \\frac{R}{\\gamma - 1} \\ln\\left( \\frac{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(\\frac{M_u^{2}}{\\beta} - 1\\right)}{1 + \\frac{2\\gamma}{\\gamma + 1}\\left(M_u^{2} - 1\\right)} \\right) - R \\ln\\left( \\frac{(\\gamma - 1) M_u^{2} + 2}{(\\gamma - 1) M_u^{2} + 2\\beta} \\right)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}