{
    "hands_on_practices": [
        {
            "introduction": "要有效实现无反射边界，最基本的方法之一是奥兰斯基（Orlanski）型辐射边界条件，它假设波以某一相速度传出计算域。这个练习旨在通过一个简化的模型，帮助你推导当边界条件中使用的估计相速度与真实的波速不匹配时产生的反射。通过这个实践 ，你将深刻理解为何精确估计波速对于这类简单边界条件的性能至关重要，并认识到其在复杂流动中的局限性。",
            "id": "3980869",
            "problem": "考虑一个一维小振幅声扰动，它在具有平面边界 $x = 0$ 的半无限域 $x  0$ 中，由线性波动方程所控制。该波的动力学源自线性化的一维声学方程，这些方程导出了标量扰动 $q(x,t)$ 的二阶波动方程 $q_{tt} = c^{2} q_{xx}$，其中 $c > 0$ 是介质的真实相速度。在计算流体力学（CFD）中，一种常见的无反射边界处理方法，即 Orlanski 型辐射边界条件（RBC），在边界 $x = 0$ 处规定了一阶关系 $q_{t} + \\hat{c}\\, q_{x} = 0$，其中 $\\hat{c} > 0$ 是该边界条件所使用的估计相速度，它可能与 $c$ 不同。\n\n假设一个单位振幅的右行谐波从内部入射到边界上：\n$$\nq_{i}(x,t) = \\exp\\!\\big(i(k x - \\omega t)\\big),\n$$\n其中 $k > 0$ 且根据波动方程的色散关系有 $\\omega = c\\, k$。边界附近的总场是入射波和可能存在的反射左行谐波的叠加：\n$$\nq(x,t) = q_{i}(x,t) + q_{r}(x,t), \\quad q_{r}(x,t) = R\\, \\exp\\!\\big(-i(k x + \\omega t)\\big),\n$$\n其中 $R$ 是复振幅反射系数，定义为反射振幅与入射振幅之比。\n\n通过在 $x=0$ 处施加 Orlanski 型辐射边界条件，推导反射系数 $R$ 关于真实速度 $c$ 和估计速度 $\\hat{c}$ 的闭式解析表达式。您的答案必须是单一的解析表达式。不需要数值近似或舍入，且最终表达式中不应包含任何物理单位。",
            "solution": "此问题经验证具有科学依据、问题适定、客观，并包含足够的信息以推导唯一解。这是分析波动方程数值边界条件中的一个标准问题。\n\n问题要求计算在 $x=0$ 边界处施加 Orlanski 型辐射边界条件（RBC）时，入射谐波的反射系数 $R$。求解域为 $x  0$。\n\n标量扰动 $q(x,t)$ 的控制方程是一维波动方程：\n$$\n\\frac{\\partial^2 q}{\\partial t^2} = c^2 \\frac{\\partial^2 q}{\\partial x^2}\n$$\n其中 $c > 0$ 是介质的真实相速度。\n\n总波场 $q(x,t)$ 是右行入射波 $q_i(x,t)$ 和左行反射波 $q_r(x,t)$ 的叠加。\n入射波给定为：\n$$\nq_i(x,t) = \\exp(i(kx - \\omega t))\n$$\n这是一个沿 $x$ 轴正方向传播，朝向 $x=0$ 边界的波。参数 $k > 0$ 和 $\\omega$ 分别是波数和角频率。它们通过控制波动方程的色散关系 $\\omega = ck$ 相关联。\n\n反射波给定为：\n$$\nq_r(x,t) = R \\exp(-i(kx + \\omega t))\n$$\n这是一个沿 $x$ 轴负方向传播，远离边界的波。$R$ 是我们需要确定的复反射系数。\n\n总场是入射波和反射波之和：\n$$\nq(x,t) = q_i(x,t) + q_r(x,t) = \\exp(i(kx - \\omega t)) + R \\exp(-i(kx + \\omega t))\n$$\n\n在边界 $x=0$ 处，应用 Orlanski 型辐射边界条件：\n$$\n\\frac{\\partial q}{\\partial t} + \\hat{c} \\frac{\\partial q}{\\partial x} = 0 \\quad \\text{at } x=0\n$$\n其中 $\\hat{c} > 0$ 是边界条件中使用的估计相速度。\n\n为求得 $R$，我们必须将总场 $q(x,t)$ 的表达式代入边界条件。首先，我们计算 $q(x,t)$ 所需的偏导数。\n\n关于时间 $t$ 的偏导数为：\n$$\n\\frac{\\partial q}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\exp(i(kx - \\omega t)) + R \\exp(-i(kx + \\omega t)) \\right]\n$$\n$$\n\\frac{\\partial q}{\\partial t} = (-i\\omega) \\exp(i(kx - \\omega t)) + R (-i\\omega) \\exp(-i(kx + \\omega t))\n$$\n$$\n\\frac{\\partial q}{\\partial t} = -i\\omega \\left[ \\exp(i(kx - \\omega t)) + R \\exp(-i(kx + \\omega t)) \\right]\n$$\n\n关于位置 $x$ 的偏导数为：\n$$\n\\frac{\\partial q}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\exp(i(kx - \\omega t)) + R \\exp(-i(kx + \\omega t)) \\right]\n$$\n$$\n\\frac{\\partial q}{\\partial x} = (ik) \\exp(i(kx - \\omega t)) + R (-ik) \\exp(-i(kx + \\omega t))\n$$\n$$\n\\frac{\\partial q}{\\partial x} = ik \\left[ \\exp(i(kx - \\omega t)) - R \\exp(-i(kx + \\omega t)) \\right]\n$$\n\n接下来，我们在边界 $x=0$ 处计算这些导数的值：\n$$\n\\left. \\frac{\\partial q}{\\partial t} \\right|_{x=0} = -i\\omega \\left[ \\exp(-i\\omega t) + R \\exp(-i\\omega t) \\right] = -i\\omega (1+R) \\exp(-i\\omega t)\n$$\n$$\n\\left. \\frac{\\partial q}{\\partial x} \\right|_{x=0} = ik \\left[ \\exp(-i\\omega t) - R \\exp(-i\\omega t) \\right] = ik (1-R) \\exp(-i\\omega t)\n$$\n\n现在，我们将这些表达式代入边界条件方程 $\\left. \\frac{\\partial q}{\\partial t} \\right|_{x=0} + \\hat{c} \\left. \\frac{\\partial q}{\\partial x} \\right|_{x=0} = 0$：\n$$\n-i\\omega (1+R) \\exp(-i\\omega t) + \\hat{c} \\left( ik (1-R) \\exp(-i\\omega t) \\right) = 0\n$$\n由于该方程必须对所有时间 $t$ 成立，且项 $\\exp(-i\\omega t)$ 永不为零，我们可以将整个方程除以它。我们还可以除以公因子 $i$：\n$$\n-\\omega(1+R) + \\hat{c} k(1-R) = 0\n$$\n问题陈述色散关系为 $\\omega = ck$。我们用它代换 $\\omega$：\n$$\n-ck(1+R) + \\hat{c}k(1-R) = 0\n$$\n由于波数 $k$ 给定为 $k>0$，它不为零，我们可以将方程除以 $k$：\n$$\n-c(1+R) + \\hat{c}(1-R) = 0\n$$\n现在我们求解这个关于反射系数 $R$ 的代数方程。我们展开各项：\n$$\n-c - cR + \\hat{c} - \\hat{c}R = 0\n$$\n将含 $R$ 的项归到一边，常数项归到另一边：\n$$\n\\hat{c} - c = cR + \\hat{c}R\n$$\n提取因子 $R$：\n$$\n\\hat{c} - c = R(c + \\hat{c})\n$$\n最后，我们分离出 $R$ 以获得最终表达式：\n$$\nR = \\frac{\\hat{c} - c}{c + \\hat{c}}\n$$\n该表达式给出了反射系数 $R$ 作为真实相速度 $c$ 和边界条件中使用的估计相速度 $\\hat{c}$ 的函数。我们注意到，只有当估计速度与真实速度匹配，即 $\\hat{c} = c$ 时，才能实现完美的无反射（$R=0$）。",
            "answer": "$$\n\\boxed{\\frac{\\hat{c} - c}{\\hat{c} + c}}\n$$"
        },
        {
            "introduction": "为了克服简单辐射边界条件的局限性，发展出了更为精密的纳维-斯托克斯特征边界条件（NSCBC）。该方法基于特征理论，能够更准确地处理出流边界上的多种波动。本练习  引导你分析一个带压力松弛的NSCBC，并优化其关键参数 $\\alpha$，以在最小化内部声波反射和维持对外部压力变化的稳定响应之间取得平衡。这个过程体现了在设计高级边界条件时所面临的真实权衡与挑战。",
            "id": "3980918",
            "problem": "考虑一个一维可压缩流，该流由关于一个均匀、定常、亚音速平均状态的线性化欧拉方程控制。该平均状态具有恒定的密度 $\\rho_{0}$、声速 $a_{0}$ 和平均速度 $u_{0}$，使得马赫数 $M = u_{0}/a_{0}$ 满足 $0  M  1$。假设压力 $p'(x,t)$ 和速度 $u'(x,t)$ 的小扰动是等熵的，因此 $p' = a_{0}^{2} \\rho'$。对于形式为 $\\exp\\!\\left(i k x - i \\omega t\\right)$ 的平面波解，色散关系为 $(\\omega - k u_{0})^{2} = a_{0}^{2} k^{2}$，下游和上游声波分别满足 $p'/u' = \\rho_{0} a_{0}$ 和 $p'/u' = -\\rho_{0} a_{0}$。\n\n在位于 $x = L$ 的右边界处，为带有压力松弛的亚音速出流实施一个 Navier–Stokes 特征边界条件 (NSCBC)，其中 NSCBC 代表 Navier–Stokes Characteristic Boundary Conditions。令特征变量定义为 $R_{+} = u' + \\frac{p'}{\\rho_{0} a_{0}}$ 和 $R_{-} = u' - \\frac{p'}{\\rho_{0} a_{0}}$。假设边界定律通过以速率参数 $\\alpha > 0$ 将局部压力松弛到外部目标压力 $p'_{\\mathrm{ext}}(t)$ 来注入入射特征 $R_{-}$，具体如下\n$$\n\\frac{\\partial R_{-}}{\\partial t} \\;=\\; -\\,\\alpha\\,\\frac{p'(L,t) - p'_{\\mathrm{ext}}(t)}{\\rho_{0} a_{0}}.\n$$\n对于与 $\\exp(-i \\omega t)$ 成正比的时谐信号，在单一角频率 $\\omega > 0$ 下分析其频域行为。\n\n1. 对于一个从内部接近 $x=L$、复振幅为 $A$ 的入射下游传播声波（无外部压力驱动，$p'_{\\mathrm{ext}} = 0$），设反射的上游波振幅为 $B$，因此在 $x = L$ 处有 $u' = A + B$ 和 $p' = \\rho_{0} a_{0}(A - B)$。推导由上述边界定律产生的频域反射系数 $r(\\alpha,\\omega) = B/A$，作为 $\\alpha$ 和 $\\omega$ 的函数。\n\n2. 对于无来自内部的入射波 ($A=0$) 且有复振幅为 $P_{e}$ 的非零外部压力驱动 $p'_{\\mathrm{ext}}(t) = \\Re\\{P_{e} \\exp(-i \\omega t)\\}$ 的外部压力跟踪问题，推导由 $p'(L,t) = \\Re\\{T(\\alpha,\\omega)\\,P_{e}\\,\\exp(-i \\omega t)\\}$ 定义的复传递函数 $T(\\alpha,\\omega)$。\n\n假设在边界处维持稳定的流入/流出耦合意味着在目标频率下达到一个预定的最小振幅比 $\\eta \\in (0,1)$，即耦合约束为 $|T(\\alpha,\\omega)| \\ge \\eta$。在此约束条件下，选择 $\\alpha$ 以最小化在相同频率 $\\omega$ 下的反射系数的模 $|r(\\alpha,\\omega)|$。提供最优松弛率 $\\alpha^{\\star}$，作为关于 $\\omega$ 和 $\\eta$ 的单一、闭式解析表达式。以 $\\mathrm{s}^{-1}$ 为单位表示 $\\alpha^{\\star}$，且最终表达式中不包含单位。无需进行数值取整。",
            "solution": "该问题已经过验证，被认为是合理的。它在科学上基于流体动力学和气动声学的原理，特别是关于线性化欧拉方程和特征边界条件。该问题是适定的、客观的，并包含求解唯一解的充分信息。\n\n解答按照问题陈述的要求分为三个部分。首先，我们推导反射系数 $r(\\alpha,\\omega)$。其次，我们推导传递函数 $T(\\alpha,\\omega)$。第三，我们求解约束优化问题以找到最优松弛率 $\\alpha^{\\star}$。\n\n分析是在频域中进行的，针对与 $\\exp(-i \\omega t)$ 成正比的时谐信号，其中 $\\omega > 0$ 是角频率。对于任何随时间变化的变量 $f(t)$，其复振幅表示为 $\\hat{f}$，使得 $f(t) = \\Re\\{\\hat{f} \\exp(-i \\omega t)\\}$。在此约定下，时间导数算子变换为 $\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$。\n\n在 $x=L$ 处的边界定律为：\n$$\n\\frac{\\partial R_{-}}{\\partial t} \\;=\\; -\\,\\alpha\\,\\frac{p'(L,t) - p'_{\\mathrm{ext}}(t)}{\\rho_{0} a_{0}}\n$$\n在频域中，该方程变为：\n$$\n-i\\omega \\hat{R}_{-} \\;=\\; -\\,\\alpha\\,\\frac{\\hat{p} - \\hat{p}_{\\mathrm{ext}}}{\\rho_{0} a_{0}}\n$$\n其中 $\\hat{R}_{-}$、$\\hat{p}$ 和 $\\hat{p}_{\\mathrm{ext}}$ 分别是 $R_{-}(L,t)$、$p'(L,t)$ 和 $p'_{\\mathrm{ext}}(t)$ 的复振幅。\n\n特征变量 $R_{-}$ 定义为 $R_{-} = u' - \\frac{p'}{\\rho_{0} a_{0}}$。用复振幅表示为 $\\hat{R}_{-} = \\hat{u} - \\frac{\\hat{p}}{\\rho_{0} a_{0}}$。\n在边界 $x=L$ 处，总的速度和压力扰动由振幅为 $A$ 的入射下游波和振幅为 $B$ 的反射上游波叠加而成。复振幅为：\n$$\n\\hat{u} = A + B\n$$\n$$\n\\hat{p} = \\rho_{0} a_{0}(A - B)\n$$\n将这些代入 $\\hat{R}_{-}$ 的表达式中：\n$$\n\\hat{R}_{-} = (A + B) - \\frac{\\rho_{0} a_{0}(A - B)}{\\rho_{0} a_{0}} = (A + B) - (A - B) = 2B\n$$\n这证实了特征变量 $R_{-}$ 代表了在右边界处的入射（反射）波的振幅。\n\n我们可以将 $\\hat{R}_{-} = 2B$ 和 $\\hat{p} = \\rho_{0} a_{0}(A-B)$ 代入频域边界定律：\n$$\n-i\\omega (2B) \\;=\\; -\\,\\alpha\\,\\frac{\\rho_{0} a_{0}(A - B) - \\hat{p}_{\\mathrm{ext}}}{\\rho_{0} a_{0}}\n$$\n$$\n-2i\\omega B \\;=\\; -\\alpha(A - B) + \\frac{\\alpha \\hat{p}_{\\mathrm{ext}}}{\\rho_{0} a_{0}}\n$$\n这个一般关系式将用于求解问题的前两个部分。\n\n**1. 反射系数 $r(\\alpha, \\omega)$ 的推导**\n\n对于这一部分，没有外部压力驱动，因此 $p'_{\\mathrm{ext}} = 0$，这意味着 $\\hat{p}_{\\mathrm{ext}} = 0$。一般关系式简化为：\n$$\n-2i\\omega B \\;=\\; -\\alpha(A - B)\n$$\n展开右侧得到：\n$$\n-2i\\omega B \\;=\\; -\\alpha A + \\alpha B\n$$\n我们需要求出反射系数 $r(\\alpha, \\omega) = B/A$。重新整理各项以将 $A$ 和 $B$ 分组：\n$$\n\\alpha A \\;=\\; \\alpha B + 2i\\omega B\n$$\n$$\n\\alpha A \\;=\\; (\\alpha + 2i\\omega) B\n$$\n求解比率 $B/A$：\n$$\nr(\\alpha, \\omega) = \\frac{B}{A} = \\frac{\\alpha}{\\alpha + 2i\\omega}\n$$\n\n**2. 传递函数 $T(\\alpha, \\omega)$ 的推导**\n\n对于这一部分，没有来自内部的入射波，因此 $A=0$。外部压力驱动的复振幅为 $P_{e}$，所以 $\\hat{p}_{\\mathrm{ext}} = P_{e}$。一般关系式变为：\n$$\n-2i\\omega B \\;=\\; -\\alpha(0 - B) + \\frac{\\alpha P_{e}}{\\rho_{0} a_{0}}\n$$\n$$\n-2i\\omega B \\;=\\; \\alpha B + \\frac{\\alpha P_{e}}{\\rho_{0} a_{0}}\n$$\n我们寻求传递函数 $T(\\alpha, \\omega) = \\hat{p}/P_{e}$。首先，我们需要用 $P_{e}$ 来表示 $\\hat{p}$。当 $A=0$ 时，边界处的压力振幅为 $\\hat{p} = \\rho_{0} a_{0}(0-B) = -\\rho_{0} a_{0} B$。这意味着 $B = -\\hat{p}/(\\rho_{0} a_{0})$。将这个 $B$ 的表达式代入方程中：\n$$\n-2i\\omega \\left(-\\frac{\\hat{p}}{\\rho_{0} a_{0}}\\right) \\;=\\; \\alpha \\left(-\\frac{\\hat{p}}{\\rho_{0} a_{0}}\\right) + \\frac{\\alpha P_{e}}{\\rho_{0} a_{0}}\n$$\n将整个方程乘以 $\\rho_{0} a_{0}$，简化后得到：\n$$\n2i\\omega \\hat{p} \\;=\\; -\\alpha \\hat{p} + \\alpha P_{e}\n$$\n重新整理以求解 $\\hat{p}$：\n$$\n2i\\omega \\hat{p} + \\alpha \\hat{p} \\;=\\; \\alpha P_{e}\n$$\n$$\n(\\alpha + 2i\\omega) \\hat{p} \\;=\\; \\alpha P_{e}\n$$\n因此，传递函数为：\n$$\nT(\\alpha, \\omega) = \\frac{\\hat{p}}{P_{e}} = \\frac{\\alpha}{\\alpha + 2i\\omega}\n$$\n我们注意到反射系数和传递函数是相同的：$r(\\alpha, \\omega) = T(\\alpha, \\omega)$。\n\n**3. 最优松弛率 $\\alpha^{\\star}$ 的优化**\n\n问题是选择松弛率 $\\alpha > 0$ 以最小化反射系数的模 $|r(\\alpha, \\omega)|$，其约束条件是传递函数的模至少为 $\\eta$，即 $|T(\\alpha, \\omega)| \\ge \\eta$，其中 $\\eta \\in (0,1)$。\n\n由于我们发现 $r(\\alpha, \\omega) = T(\\alpha, \\omega)$，该问题等价于：在 $|T(\\alpha, \\omega)| \\ge \\eta$ 的约束下最小化 $|T(\\alpha, \\omega)|$。\n\n首先，我们计算 $T(\\alpha, \\omega)$ 的模：\n$$\n|T(\\alpha, \\omega)| = \\left|\\frac{\\alpha}{\\alpha + 2i\\omega}\\right| = \\frac{|\\alpha|}{|\\alpha + 2i\\omega|}\n$$\n由于 $\\alpha > 0$：\n$$\n|T(\\alpha, \\omega)| = \\frac{\\alpha}{\\sqrt{\\alpha^2 + (2\\omega)^2}} = \\frac{\\alpha}{\\sqrt{\\alpha^2 + 4\\omega^2}}\n$$\n让我们将待最小化的函数定义为 $f(\\alpha) = |T(\\alpha, \\omega)|$。我们需要理解它作为 $\\alpha$ 的函数的行为。为此，我们计算它关于 $\\alpha$ 的导数：\n$$\n\\frac{df}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{\\alpha}{(\\alpha^2 + 4\\omega^2)^{1/2}} \\right)\n$$\n使用微分的求商法则：\n$$\n\\frac{df}{d\\alpha} = \\frac{1 \\cdot (\\alpha^2 + 4\\omega^2)^{1/2} - \\alpha \\cdot \\left(\\frac{1}{2}(\\alpha^2 + 4\\omega^2)^{-1/2}(2\\alpha)\\right)}{\\alpha^2 + 4\\omega^2}\n$$\n$$\n\\frac{df}{d\\alpha} = \\frac{(\\alpha^2 + 4\\omega^2)^{1/2} - \\alpha^2(\\alpha^2 + 4\\omega^2)^{-1/2}}{\\alpha^2 + 4\\omega^2}\n$$\n将分子和分母同乘以 $(\\alpha^2 + 4\\omega^2)^{1/2}$ 得到：\n$$\n\\frac{df}{d\\alpha} = \\frac{(\\alpha^2 + 4\\omega^2) - \\alpha^2}{(\\alpha^2 + 4\\omega^2)^{3/2}} = \\frac{4\\omega^2}{(\\alpha^2 + 4\\omega^2)^{3/2}}\n$$\n由于 $\\omega > 0$ 且 $\\alpha > 0$，分子 $4\\omega^2$ 是正的，分母 $(\\alpha^2 + 4\\omega^2)^{3/2}$ 也是正的。因此，对于所有 $\\alpha > 0$，$\\frac{df}{d\\alpha} > 0$。这意味着 $f(\\alpha) = |T(\\alpha, \\omega)|$ 是一个关于 $\\alpha$ 的严格单调递增函数。\n\n这个优化问题是在约束 $f(\\alpha) \\ge \\eta$ 下最小化一个单调递增函数 $f(\\alpha)$。在满足约束条件的情况下，$f(\\alpha)$ 能取的最小值恰好是 $\\eta$。因此，通过将函数值设为约束的下界来找到最优解：\n$$\n|T(\\alpha^\\star, \\omega)| = \\eta\n$$\n我们现在求解最优速率 $\\alpha^\\star$：\n$$\n\\frac{\\alpha^\\star}{\\sqrt{(\\alpha^\\star)^2 + 4\\omega^2}} = \\eta\n$$\n将方程两边平方：\n$$\n\\frac{(\\alpha^\\star)^2}{(\\alpha^\\star)^2 + 4\\omega^2} = \\eta^2\n$$\n现在，我们求解 $(\\alpha^\\star)^2$：\n$$\n(\\alpha^\\star)^2 = \\eta^2 ((\\alpha^\\star)^2 + 4\\omega^2)\n$$\n$$\n(\\alpha^\\star)^2 = \\eta^2 (\\alpha^\\star)^2 + 4\\eta^2\\omega^2\n$$\n$$\n(\\alpha^\\star)^2 - \\eta^2 (\\alpha^\\star)^2 = 4\\eta^2\\omega^2\n$$\n$$\n(\\alpha^\\star)^2 (1 - \\eta^2) = 4\\eta^2\\omega^2\n$$\n$$\n(\\alpha^\\star)^2 = \\frac{4\\eta^2\\omega^2}{1 - \\eta^2}\n$$\n由于 $\\alpha$ 必须为正，我们取正平方根来求得 $\\alpha^\\star$：\n$$\n\\alpha^\\star = \\sqrt{\\frac{4\\eta^2\\omega^2}{1 - \\eta^2}} = \\frac{2\\eta\\omega}{\\sqrt{1 - \\eta^2}}\n$$\n这就是最优松弛率的闭式解析表达式。由于 $\\eta \\in (0,1)$，项 $1 - \\eta^2$ 是正的，因此该表达式是良定义且为实数。$\\alpha^\\star$ 的单位与 $\\omega$ 的单位相同，即 $\\mathrm{s}^{-1}$，这与松弛率参数的物理意义一致。",
            "answer": "$$\\boxed{\\frac{2\\eta\\omega}{\\sqrt{1 - \\eta^2}}}$$"
        },
        {
            "introduction": "除了在边界上直接施加条件，另一种常用的吸收波的方法是在计算域的出口区域设置一个“海绵层”（Sponge Layer），通过引入人工阻尼项来逐渐衰减波的能量。然而，这种方法的数值实现方式会直接影响计算的稳定性。本练习  要求你对一个采用显式时间格式的海绵层进行冯·诺依曼稳定性分析，推导出由阻尼项引起的时间步长限制，并将其与经典的对流CFL条件进行比较。这有助于你理解在CFD模拟中，数值算法的选择如何与物理模型的参数相互制约。",
            "id": "3980938",
            "problem": "考虑在计算流体动力学（CFD）的可压缩流模拟中，一个一维线性化扰动场 $q'(x,t)$ 在流出边界附近演化。为了实现无反射边界，在一定厚度的缓冲区内应用了一个海绵层，其中一个阻尼源迫使 $q'$ 趋向于一个均匀的参考状态。假设扰动是围绕均匀基态的小振幅扰动，因此 $q'$ 的主阶动力学遵循一个带有阻尼源的线性双曲型偏微分方程，其形式为\n$$\n\\frac{\\partial q'}{\\partial t} + a \\frac{\\partial q'}{\\partial x} = -\\sigma(x)\\,q'(x,t),\n$$\n其中 $a$ 是一个恒定的特征速度，代表边界附近最大的向右传播的波速，而 $\\sigma(x) \\ge 0$ 是空间变化的海绵强度，在海绵区域内的最大值为 $\\sigma_{\\max}$。\n\n假设半离散的线方法（method-of-lines）公式对对流项采用前向欧拉时间积分和一阶迎风空间离散，并通过算子分裂方法显式处理海绵源项：一个用于对流的显式步骤，然后一个用于海绵源的显式步骤。对对流步骤的单个傅里叶模式进行线性冯·诺依曼稳定性分析，并对海绵步骤进行独立的线性稳定性分析，推导与海绵源项相关的、用于保证线性化更新稳定性的时间步长约束。然后，将其与来自对流步骤的对流 Courant–Friedrichs–Lewy (CFL) 约束进行比较。\n\n给定一个特定流出缓冲区的以下参数：\n- 网格间距 $\\Delta x = 2.0 \\times 10^{-3}\\,\\text{m}$，\n- 最大特征速度 $a_{\\max} = 350\\,\\text{m}\\,\\text{s}^{-1}$，\n- 迎风对流步骤的目标 CFL 系数 $C_{\\mathrm{CFL}} = 0.5$，\n- 最大海绵强度 $\\sigma_{\\max} = 800\\,\\text{s}^{-1}$，\n\n确定同时满足对流 CFL 约束和海绵层稳定性约束的最大稳定时间步长 $\\Delta t$。\n\n以秒为单位表示最终答案，并将结果四舍五入到四位有效数字。",
            "solution": "该问题要求确定用于求解带阻尼源项的一维线性化对流方程的数值格式的最大稳定时间步长 $\\Delta t$。该格式采用算子分裂法，将对流项和源项在两个独立的显式步骤中处理。我们必须推导每一步的稳定性约束，然后找出最严格的约束，该约束将决定总体的最大稳定时间步长。\n\n扰动场 $q'(x,t)$ 的控制偏微分方程为：\n$$\n\\frac{\\partial q'}{\\partial t} + a \\frac{\\partial q'}{\\partial x} = -\\sigma(x)\\,q'(x,t)\n$$\n其中 $a > 0$ 是一个恒定的波速。从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的每一次时间推进，数值方法包括两个连续的步骤：\n\n步骤 1：对流（显式，一阶迎风，前向欧拉）\n$$\n\\frac{\\partial q'}{\\partial t} + a \\frac{\\partial q'}{\\partial x} = 0\n$$\n\n步骤 2：海绵阻尼（显式，前向欧拉）\n$$\n\\frac{\\partial q'}{\\partial t} = -\\sigma(x)\\,q'\n$$\n\n我们将分别分析每一步的稳定性。\n\n**1. 对流步骤的稳定性分析**\n\n对流方程在时间上使用前向欧拉格式，在空间上使用一阶迎风格式进行离散。对于正波速 $a > 0$，迎风格式在网格点 $j$ 和时间层 $n$ 处使用空间导数近似 $(\\frac{\\partial q'}{\\partial x})_j^n \\approx \\frac{q'_j{}^n - q'_{j-1}{}^n}{\\Delta x}$。对流步骤的半离散方程为：\n$$\n\\frac{q'^{*}_j - q'_j{}^n}{\\Delta t} + a \\left( \\frac{q'_j{}^n - q'_{j-1}{}^n}{\\Delta x} \\right) = 0\n$$\n其中 $q'^{*}$ 是对流步骤后的中间解。整理 $q'^{*}_j$ 可得更新规则：\n$$\nq'^{*}_j = q'_j{}^n - \\frac{a \\Delta t}{\\Delta x} (q'_j{}^n - q'_{j-1}{}^n)\n$$\n令 $C = \\frac{a \\Delta t}{\\Delta x}$ 为库朗数。方程变为：\n$$\nq'^{*}_j = q'_j{}^n - C (q'_j{}^n - q'_{j-1}{}^n)\n$$\n为了进行冯·诺依曼稳定性分析，我们考虑形式为 $q'_j{}^n = \\hat{q}^n(k) \\exp(i k x_j)$ 的单个傅里叶模式，其中 $k$ 是波数，$x_j = j \\Delta x$。放大因子 $G_{adv}(k) = \\frac{\\hat{q}^{n+1}(k)}{\\hat{q}^n(k)}$ 可通过将此形式代入更新规则得到：\n$$\nG_{adv} \\exp(i k j \\Delta x) = \\exp(i k j \\Delta x) - C (\\exp(i k j \\Delta x) - \\exp(i k (j-1) \\Delta x))\n$$\n两边同除以 $\\exp(i k j \\Delta x)$ 得：\n$$\nG_{adv} = 1 - C (1 - \\exp(-i k \\Delta x))\n$$\n为了保证稳定性，对于所有波数，放大因子的模必须小于或等于1，即 $|G_{adv}| \\le 1$。令 $\\theta = k \\Delta x$。\n$$\nG_{adv} = 1 - C (1 - \\cos(\\theta) + i \\sin(\\theta)) = (1 - C + C\\cos(\\theta)) - i C\\sin(\\theta)\n$$\n其模的平方为：\n$$\n|G_{adv}|^2 = (1 - C + C\\cos(\\theta))^2 + (-C\\sin(\\theta))^2\n$$\n$$\n|G_{adv}|^2 = (1-C)^2 + 2C(1-C)\\cos(\\theta) + C^2\\cos^2(\\theta) + C^2\\sin^2(\\theta)\n$$\n$$\n|G_{adv}|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos(\\theta) + C^2 = 1 - 2C + 2C^2 + (2C-2C^2)\\cos(\\theta)\n$$\n$$\n|G_{adv}|^2 = 1 - 2C(1 - \\cos(\\theta)) + 2C^2(1 - \\cos(\\theta)) = 1 - 2C(1-C)(1 - \\cos(\\theta))\n$$\n为保证稳定性，需满足 $|G_{adv}|^2 \\le 1$。由于 $C = \\frac{a \\Delta t}{\\Delta x} > 0$ 且 $(1 - \\cos(\\theta)) \\ge 0$，这要求项 $-2C(1-C)(1 - \\cos(\\theta))$ 为非正数。如果 $C(1-C) \\ge 0$，则该条件满足。因为 $C>0$，我们必须有 $1-C \\ge 0$，这意味着 $C \\le 1$。\n这就是此格式的 Courant–Friedrichs–Lewy (CFL) 条件。问题指定了目标 CFL 系数 $C_{\\mathrm{CFL}} = 0.5$，我们将其解释为操作上限。因此，对流步骤对 $\\Delta t$ 的约束是：\n$$\n\\frac{a_{\\max} \\Delta t}{\\Delta x} \\le C_{\\mathrm{CFL}} \\implies \\Delta t \\le \\frac{C_{\\mathrm{CFL}} \\Delta x}{a_{\\max}}\n$$\n我们称这个上限为 $\\Delta t_{\\text{conv}}$。\n\n**2. 海绵源项步骤的稳定性分析**\n\n第二步求解每个网格点上阻尼的常微分方程（ODE）：\n$$\n\\frac{d q'}{d t} = -\\sigma(x) q'\n$$\n使用前向欧拉格式从中间状态 $q'^{*}$ 到最终状态 $q'^{n+1}$ 进行离散：\n$$\n\\frac{q'_j{}^{n+1} - q'^{*}_j}{\\Delta t} = -\\sigma_j q'^{*}_j\n$$\n更新规则为：\n$$\nq'_j{}^{n+1} = q'^{*}_j - \\sigma_j \\Delta t \\, q'^{*}_j = (1 - \\sigma_j \\Delta t) q'^{*}_j\n$$\n此步骤的放大因子 $G_{sponge}$ 就是乘法因子：\n$$\nG_{sponge} = 1 - \\sigma_j \\Delta t\n$$\n为保证稳定性，我们需要对所有网格点 $j$ 满足 $|G_{sponge}| \\le 1$。此不等式为 $|1 - \\sigma_j \\Delta t| \\le 1$，等价于：\n$$\n-1 \\le 1 - \\sigma_j \\Delta t \\le 1\n$$\n右侧不等式 $1 - \\sigma_j \\Delta t \\le 1$ 意味着 $-\\sigma_j \\Delta t \\le 0$。由于 $\\sigma_j \\ge 0$ 且 $\\Delta t > 0$，此条件总是满足的。\n左侧不等式 $-1 \\le 1 - \\sigma_j \\Delta t$ 意味着 $\\sigma_j \\Delta t \\le 2$。\n此约束必须对域中所有的海绵强度 $\\sigma_j$ 均成立。最严格的情况对应于最大海绵强度 $\\sigma_{\\max}$。因此，海绵层的稳定性约束为：\n$$\n\\Delta t \\le \\frac{2}{\\sigma_{\\max}}\n$$\n我们称这个上限为 $\\Delta t_{\\text{sponge}}$。\n\n**3. 组合稳定性约束与最终计算**\n\n为使整个算子分裂格式稳定，时间步长 $\\Delta t$ 必须同时满足两个约束。因此，最大允许时间步长是两个独立上限中的最小值：\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\text{conv}}, \\Delta t_{\\text{sponge}}) = \\min\\left( \\frac{C_{\\mathrm{CFL}} \\Delta x}{a_{\\max}}, \\frac{2}{\\sigma_{\\max}} \\right)\n$$\n我们给定了以下参数值：\n- 网格间距: $\\Delta x = 2.0 \\times 10^{-3}\\,\\text{m}$\n- 最大特征速度: $a_{\\max} = 350\\,\\text{m}\\,\\text{s}^{-1}$\n- 目标 CFL 系数: $C_{\\mathrm{CFL}} = 0.5$\n- 最大海绵强度: $\\sigma_{\\max} = 800\\,\\text{s}^{-1}$\n\n现在我们计算两个时间步长限制。\n对流时间步长限制为：\n$$\n\\Delta t_{\\text{conv}} = \\frac{C_{\\mathrm{CFL}} \\Delta x}{a_{\\max}} = \\frac{0.5 \\times (2.0 \\times 10^{-3}\\,\\text{m})}{350\\,\\text{m}\\,\\text{s}^{-1}} = \\frac{1.0 \\times 10^{-3}}{350}\\,\\text{s} \\approx 2.85714 \\times 10^{-6}\\,\\text{s}\n$$\n海绵层时间步长限制为：\n$$\n\\Delta t_{\\text{sponge}} = \\frac{2}{\\sigma_{\\max}} = \\frac{2}{800\\,\\text{s}^{-1}} = \\frac{1}{400}\\,\\text{s} = 0.0025\\,\\text{s} = 2.5 \\times 10^{-3}\\,\\text{s}\n$$\n比较这两个限制：\n$$\n\\Delta t_{\\text{conv}} \\approx 2.857 \\times 10^{-6}\\,\\text{s}\n$$\n$$\n\\Delta t_{\\text{sponge}} = 2.5 \\times 10^{-3}\\,\\text{s}\n$$\n对流 CFL 约束远比海绵阻尼约束更严格。因此，总体的最大稳定时间步长由对流步骤决定。\n$$\n\\Delta t_{\\max} = \\min(2.85714 \\times 10^{-6}\\,\\text{s}, 2.5 \\times 10^{-3}\\,\\text{s}) = 2.85714 \\times 10^{-6}\\,\\text{s}\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\n\\Delta t_{\\max} \\approx 2.857 \\times 10^{-6}\\,\\text{s}\n$$",
            "answer": "$$\n\\boxed{2.857 \\times 10^{-6}}\n$$"
        }
    ]
}