{
    "hands_on_practices": [
        {
            "introduction": "要深刻理解完美匹配层（PML）的精妙之处，我们必须首先弄清它所要解决的问题。本练习将分析一种最基本的边界条件——刚性壁面——以揭示其如何导致波的完全反射。通过推导反射系数，您将亲眼看到为何这种简单的边界在计算流体力学（CFD）中不适用于模拟开放或无界区域。",
            "id": "3984419",
            "problem": "考虑半线 $x \\in [0,\\infty)$ 上的一维线性声波方程 $u_{tt} = c^{2} u_{xx}$，其中 $u(x,t)$ 是声速势，$t$ 是时间，$c$ 是恒定的声速。$x=0$ 处的边界代表一个完美刚性壁，该壁施加了诺伊曼边界条件 $u_{x}(0,t)=0$。在航空航天计算流体动力学 (CFD) 中，如何在不引入伪反射的情况下截断无界域是一个核心问题；已知刚性壁边界会反射波，因此它不能模拟像完美匹配层 (PML) 这样的吸收边界。\n\n假设域中存在时谐平面波解。设一个向边界传播的入射平面波表示为 $u_{i}(x,t) = A \\exp\\!\\left(i(-k x - \\omega t)\\right)$，一个远离边界传播的反射平面波表示为 $u_{r}(x,t) = B \\exp\\!\\left(i(k x - \\omega t)\\right)$，其中 $k>0$ 和 $\\omega>0$ 满足适用于 $u_{tt} = c^{2} u_{xx}$ 的色散关系。总场为 $u(x,t) = u_{i}(x,t) + u_{r}(x,t)$。将复反射系数 $R$ 定义为反射复振幅与入射复振幅之比，$R = B/A$。\n\n仅从指定的控制方程、边界条件和上述平面波形式出发，推导刚性壁边界处的反射系数 $R$ 的精确表达式，并定性地解释在 $x \\ge 0$ 区域内产生的驻波模式。将最终答案以 $R$ 的精确复数形式报告。最终答案无需四舍五入，也无需单位。",
            "solution": "出发点是一维线性声波方程 $u_{tt} = c^{2} u_{xx}$。我们寻求形式为 $u(x,t) = \\Re\\{U(x) \\exp(i \\omega t)\\}$ 的时谐平面波解，但为了代数上的简便，使用复指数更为方便。对于平面波拟设 $u(x,t) = \\exp\\!\\left(i(k x - \\omega t)\\right)$，将其代入 $u_{tt} = c^{2} u_{xx}$ 可得\n\n$$\n\\frac{\\partial^{2}}{\\partial t^{2}} \\exp\\!\\left(i(k x - \\omega t)\\right) = c^{2} \\frac{\\partial^{2}}{\\partial x^{2}} \\exp\\!\\left(i(k x - \\omega t)\\right).\n$$\n\n计算导数可得\n\n$$\n(-\\omega^{2}) \\exp\\!\\left(i(k x - \\omega t)\\right) = c^{2} (-k^{2}) \\exp\\!\\left(i(k x - \\omega t)\\right),\n$$\n\n这可简化为色散关系\n\n$$\n\\omega^{2} = c^{2} k^{2}.\n$$\n\n对于 $k>0$ 和 $\\omega>0$，这表明该波动方程是非色散的，对于向右传播有 $\\omega = c k$，对于向左传播同样有 $\\omega = c k$，二者通过相位中 $k$ 的符号来区分。\n\n在具有 $x=0$ 边界的半线 $x \\ge 0$ 上，一个向左传播并接近边界的入射波可以写为\n\n$$\nu_{i}(x,t) = A \\exp\\!\\left(i(-k x - \\omega t)\\right),\n$$\n\n反射的向右传播的波可以写为\n\n$$\nu_{r}(x,t) = B \\exp\\!\\left(i(k x - \\omega t)\\right),\n$$\n\n其中 $A$ 和 $B$ 是复振幅且 $k>0$。那么总场为\n\n$$\nu(x,t) = u_{i}(x,t) + u_{r}(x,t) = A \\exp\\!\\left(i(-k x - \\omega t)\\right) + B \\exp\\!\\left(i(k x - \\omega t)\\right).\n$$\n\n施加刚性壁的诺伊曼边界条件 $u_{x}(0,t) = 0$ 决定了反射系数。计算空间导数：\n\n$$\nu_{x}(x,t) = \\frac{\\partial}{\\partial x}\\left[A \\exp\\!\\left(i(-k x - \\omega t)\\right) + B \\exp\\!\\left(i(k x - \\omega t)\\right)\\right]\n= A \\left(-i k\\right) \\exp\\!\\left(i(-k x - \\omega t)\\right) + B \\left(i k\\right) \\exp\\!\\left(i(k x - \\omega t)\\right).\n$$\n\n在 $x=0$ 处求值：\n\n$$\nu_{x}(0,t) = (-i k) A \\exp\\!\\left(-i \\omega t\\right) + (i k) B \\exp\\!\\left(-i \\omega t\\right) = i k \\exp\\!\\left(-i \\omega t\\right)\\left(B - A\\right).\n$$\n\n诺伊曼边界条件要求对所有 $t$ 都有 $u_{x}(0,t)=0$，因此\n\n$$\ni k \\exp\\!\\left(-i \\omega t\\right)\\left(B - A\\right) = 0 \\quad \\Rightarrow \\quad B - A = 0 \\quad \\Rightarrow \\quad B = A.\n$$\n\n根据定义 $R = B/A$，立即可得\n\n$$\nR = \\frac{B}{A} = 1.\n$$\n\n这个结果有明确的物理解释。一个刚性壁（诺伊曼）边界会以单位幅值和相对于入射波的零相移反射入射声学平面波。总场形成一个驻波。为了明确地看到这一点，将 $B=A$ 代入 $u(x,t)$：\n\n$$\nu(x,t) = A \\exp\\!\\left(-i \\omega t\\right)\\left[\\exp\\!\\left(-i k x\\right) + \\exp\\!\\left(i k x\\right)\\right] = 2 A \\exp\\!\\left(-i \\omega t\\right) \\cos(k x).\n$$\n\n因此，空间结构与 $\\cos(k x)$ 成正比，波腹位于 $x = n \\pi / k$（整数 $n \\ge 0$），波节位于 $\\cos(k x) = 0$ 的位置，即 $x = (2 n + 1)\\pi/(2 k)$（整数 $n \\ge 0$）。在航空航天计算流体动力学的背景下，这种完美反射（$|R|=1$）例证了非吸收截断（刚性壁边界）如何产生强驻波。相比之下，完美匹配层被设计成使得有效反射系数 $R$ 在很宽的频率和入射角范围内近似为零，从而抑制截断计算域中的驻波干涉。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在PML问世之前，研究人员开发了被称为吸收边界条件（ABCs）的更简单方法。本练习将探究一种经典的一阶ABC，以揭示其根本局限性：其吸收效果高度依赖于波的入射角度。通过推导反射系数作为角度的函数，您将对催生PML等更稳健方法的挑战获得关键的洞见。",
            "id": "3984406",
            "problem": "考虑在二维 (2D) 半空间域 $\\{(x,y) \\in \\mathbb{R}^2 : x \\le 0\\}$ 中的气动声学波传播。该区域填充有均匀的静止介质，其声速恒为 $c$。标量声压扰动 $u(x,y,t)$ 满足线性波动方程 $u_{tt} = c^2 (u_{xx} + u_{yy})$。一个平面边界位于 $x=0$ 处，旨在作为波离开计算域的出流边界。为模拟波的吸收，该边界在 $x=0$ 处施加了一阶 Engquist–Majda 吸收边界条件 (ABC)，形式为 $u_t + c\\,u_x = 0$。\n\n一列角频率为 $\\omega$、波矢量为 $(k_x,k_y)$ 的时谐平面波从内部倾斜入射到边界上（即，它朝着 $x$ 增大的方向传播，因此 $k_x > 0$），其中 $k = \\sqrt{k_x^2 + k_y^2}$ 且色散关系为 $\\omega = c\\,k$。入射场为\n$$\nu^{\\mathrm{inc}}(x,y,t) = \\exp\\!\\big(i(k_x x + k_y y - \\omega t)\\big),\n$$\n反射场具有以下形式\n$$\nu^{\\mathrm{ref}}(x,y,t) = R\\,\\exp\\!\\big(i(-k_x x + k_y y - \\omega t)\\big),\n$$\n其中 $R$ 是由边界产生的复值反射系数（振幅比）。定义入射角 $\\theta \\in [0,\\pi/2)$，它是相对于边界法线（$+x$ 方向）的角度，由 $k_x = k \\cos\\theta$ 和 $k_y = k \\sin\\theta$ 给出，且 $\\theta$ 以弧度为单位。\n\n从控制波动方程和给定的边界条件出发，并且不引用任何预先推导的边界反射公式，推导反射系数 $R$ 对入射角 $\\theta$ 的闭式依赖关系。将您的最终答案表示为关于 $\\theta$ 的单个解析表达式 $R(\\theta)$。无需四舍五入。反射系数是无量纲的；不要在最终表达式中包含单位。",
            "solution": "总声压场 $u(x,y,t)$ 是入射波和反射波的线性叠加：\n$$\nu(x,y,t) = u^{\\mathrm{inc}}(x,y,t) + u^{\\mathrm{ref}}(x,y,t)\n$$\n代入给定的入射场和反射场表达式，得到：\n$$\nu(x,y,t) = \\exp\\!\\big(i(k_x x + k_y y - \\omega t)\\big) + R\\,\\exp\\!\\big(i(-k_x x + k_y y - \\omega t)\\big)\n$$\n这个总场 $u$ 必须满足在边界 $x=0$ 处的一阶 Engquist–Majda 吸收边界条件：\n$$\n\\frac{\\partial u}{\\partial t} + c\\frac{\\partial u}{\\partial x} = 0 \\quad \\text{at } x=0\n$$\n为了应用此条件，我们首先计算 $u(x,y,t)$ 所需的偏导数。\n\n关于时间 $t$ 的偏导数是：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial t}\\left[ \\exp\\!\\big(i(k_x x + k_y y - \\omega t)\\big) + R\\,\\exp\\!\\big(i(-k_x x + k_y y - \\omega t)\\big) \\right]\n$$\n$$\n\\frac{\\partial u}{\\partial t} = (-i\\omega)\\exp\\!\\big(i(k_x x + k_y y - \\omega t)\\big) + R(-i\\omega)\\exp\\!\\big(i(-k_x x + k_y y - \\omega t)\\big)\n$$\n关于位置 $x$ 的偏导数是：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}\\left[ \\exp\\!\\big(i(k_x x + k_y y - \\omega t)\\big) + R\\,\\exp\\!\\big(i(-k_x x + k_y y - \\omega t)\\big) \\right]\n$$\n$$\n\\frac{\\partial u}{\\partial x} = (ik_x)\\exp\\!\\big(i(k_x x + k_y y - \\omega t)\\big) + R(-ik_x)\\exp\\!\\big(i(-k_x x + k_y y - \\omega t)\\big)\n$$\n现在，我们在边界 $x=0$ 处计算这些导数的值：\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{x=0} = (-i\\omega)\\exp\\!\\big(i(k_y y - \\omega t)\\big) + R(-i\\omega)\\exp\\!\\big(i(k_y y - \\omega t)\\big) = -i\\omega (1+R) \\exp\\!\\big(i(k_y y - \\omega t)\\big)\n$$\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=0} = (ik_x)\\exp\\!\\big(i(k_y y - \\omega t)\\big) + R(-ik_x)\\exp\\!\\big(i(k_y y - \\omega t)\\big) = ik_x (1-R) \\exp\\!\\big(i(k_y y - \\omega t)\\big)\n$$\n我们将这些表达式代入边界条件方程：\n$$\n-i\\omega (1+R) \\exp\\!\\big(i(k_y y - \\omega t)\\big) + c \\left[ ik_x (1-R) \\exp\\!\\big(i(k_y y - \\omega t)\\big) \\right] = 0\n$$\n由于项 $\\exp\\!\\big(i(k_y y - \\omega t)\\big)$ 非零，我们可以用它来除整个方程。我们还可以除以公因数 $i$：\n$$\n-\\omega (1+R) + c k_x (1-R) = 0\n$$\n现在，我们求解这个关于反射系数 $R$ 的代数方程：\n$$\n-\\omega - \\omega R + c k_x - c k_x R = 0\n$$\n$$\nc k_x - \\omega = \\omega R + c k_x R\n$$\n$$\nc k_x - \\omega = R(\\omega + c k_x)\n$$\n$$\nR = \\frac{c k_x - \\omega}{c k_x + \\omega}\n$$\n问题要求答案用入射角 $\\theta$ 表示。我们使用给定的关系式：$k_x = k \\cos\\theta$ 和色散关系 $\\omega = c k$。\n将这些代入 $R$ 的表达式中：\n$$\nR(\\theta) = \\frac{c (k \\cos\\theta) - (c k)}{c (k \\cos\\theta) + (c k)}\n$$\n项 $c k$ 是分子和分母的公因数。由于波存在，$\\omega \\neq 0$，这意味着 $k \\neq 0$，所以我们可以安全地消去这个因子：\n$$\nR(\\theta) = \\frac{c k (\\cos\\theta - 1)}{c k (\\cos\\theta + 1)}\n$$\n$$\nR(\\theta) = \\frac{\\cos\\theta - 1}{\\cos\\theta + 1}\n$$\n这就是反射系数 $R$ 作为入射角 $\\theta$ 函数的闭式表达式。只有在法向入射（$\\theta = 0$，$\\cos\\theta=1$）时，边界条件才是完美吸收的（$R=0$），此时 $R(0) = \\frac{1-1}{1+1} = 0$。对于任何其他角度 $\\theta \\neq 0$，都存在非零反射，对于 $\\theta \\in (0, \\pi/2)$，有 $|R(\\theta)|<1$。",
            "answer": "$$\n\\boxed{\\frac{\\cos\\theta - 1}{\\cos\\theta + 1}}\n$$"
        },
        {
            "introduction": "现代PML在时域求解器中通常采用辅助微分方程（ADE）的形式来实现。这最后一个练习将从解析理论走向计算验证，将抽象概念与其在CFD中的实际应用联系起来。通过对一个ADE PML系统的脉冲响应进行编码和分析，您将亲身体验这些先进的吸收层是如何在数值上实现的。",
            "id": "3984392",
            "problem": "给定一个一维、线性、时不变的辅助微分方程完美匹配层 (ADE PML) 模型，该模型用于在航空航天应用的计算流体动力学 (CFD) 中吸收计算域内的出射波。在时域中，ADE PML 引入了一个记忆变量，用以模拟复频移坐标拉伸。考虑由以下常微分方程控制的标量记忆变量\n$$\\frac{d \\psi(t)}{d t} + (\\alpha + \\sigma)\\, \\psi(t) = \\sigma\\, f(t),$$\n其中 $\\psi(t)$ 是辅助场，$f(t)$ 是输入激励，$\\alpha \\ge 0$ 和 $\\sigma \\ge 0$ 是单位为 $\\mathrm{s}^{-1}$ 的参数，分别源于复频移和层的电导率。本问题的输入是一个脉冲，$f(t) = \\delta(t)$，其中 $\\delta(t)$ 是狄拉克 delta 分布，初始条件为 $\\psi(0^{-}) = 0$。\n\n您必须仅从上述微分方程、狄拉克 delta 的定义、拉普拉斯变换以及线性时不变系统的性质出发，分析 ADE PML 子系统的脉冲响应 $h(t)$ 并验证以下两个性质：\n1. 因果性：对于所有 $t  0$，有 $h(t) = 0$。\n2. 指数衰减，其衰减速率由 $\\alpha$ 和 $\\sigma$ 决定。\n\n您的任务是实现一个程序，该程序能够：\n- 在包含负时间和正时间的均匀时间网格上计算脉冲响应 $h(t)$。\n- 通过检查网格上 $t  0$ 的 $h(t)$ 是否精确为 0，来数值上验证因果性。\n- 对 $t > 0$ 的数据，使用最小二乘法拟合 $\\log\\left(h(t)/h(0^{+})\\right)$ 关于 $t$ 的关系，从而估计衰减速率，其中 $h(0^{+})$ 是 $h(t)$ 在 $t=0$ 处的右极限。\n- 将估计的衰减速率与控制方程所蕴含的理论速率进行比较。\n- 处理脉冲响应恒等于零的平凡情况。\n\n使用以下参数对 $(\\alpha,\\sigma)$ 测试套件，单位均为 $\\mathrm{s}^{-1}$：\n- 情况 1：$(\\alpha,\\sigma) = (50, 100)$。\n- 情况 2：$(\\alpha,\\sigma) = (0, 10)$。\n- 情况 3：$(\\alpha,\\sigma) = (10, 0)$。\n- 情况 4：$(\\alpha,\\sigma) = (0, 0)$。\n- 情况 5：$(\\alpha,\\sigma) = (1, 2)$。\n\n构建一个均匀时间网格 $t \\in [t_{\\min}, t_{\\max}]$，其中 $t_{\\min} = -0.01\\,\\mathrm{s}$，$t_{\\max} = 1.0\\,\\mathrm{s}$，时间步长 $\\Delta t = 10^{-3}\\,\\mathrm{s}$。将衰减速率的单位视为 $\\mathrm{s}^{-1}$ 并将其表示为浮点数。对于每个测试用例，您的程序必须输出一个列表，其中包含：\n- 一个布尔值，指示响应在采样网格上是否是因果的。\n- 一个布尔值，指示在响应为非平凡时，数值估计的衰减速率是否在 $0.01$（即 $1 \\times 10^{-2}$）的相对容差内与理论速率匹配；对于平凡零响应，如果测量速率和理论速率均为 $0$，则此布尔值必须为真。\n- 测量得到的衰减速率，单位为 $\\mathrm{s}^{-1}$。\n- 理论衰减速率，单位为 $\\mathrm{s}^{-1}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的每个元素对应一个测试用例，并且本身也是一个按上述顺序排列的列表。例如，输出格式必须为\n$$[\\,[\\text{bool},\\text{bool},\\text{float},\\text{float}],\\ldots\\,],$$\n不含任何额外文本。所有计算必须是确定性的，并且无需用户输入即可复现。",
            "solution": "根据定义，脉冲响应 $h(t)$ 是当输入为 $f(t) = \\delta(t)$ 且系统从静止状态（即对于 $t0$，$h(t)=0$）开始时，控制方程的解 $\\psi(t)$。脉冲响应的微分方程为：\n$$ \\frac{d h(t)}{d t} + (\\alpha + \\sigma)\\, h(t) = \\sigma\\, \\delta(t) $$\n初始条件为 $h(0^{-}) = 0$。\n\n我们使用拉普拉斯变换（记作 $\\mathcal{L}\\{\\cdot\\}$）来求解此方程。令 $H(s) = \\mathcal{L}\\{h(t)\\}$。利用拉普拉斯变换的性质，特别是 $\\mathcal{L}\\{\\frac{dh}{dt}\\} = s H(s) - h(0^{-})$ 和 $\\mathcal{L}\\{\\delta(t)\\} = 1$，我们将微分方程转换为复频域 $s$ 中的代数方程：\n$$ (s H(s) - h(0^{-})) + (\\alpha + \\sigma) H(s) = \\sigma \\cdot 1 $$\n代入初始条件 $h(0^{-}) = 0$：\n$$ s H(s) + (\\alpha + \\sigma) H(s) = \\sigma $$\n求解传递函数 $H(s)$：\n$$ (s + \\alpha + \\sigma) H(s) = \\sigma $$\n$$ H(s) = \\frac{\\sigma}{s + (\\alpha + \\sigma)} $$\n为了在时域中求得脉冲响应 $h(t)$，我们计算 $H(s)$ 的拉普拉斯逆变换。我们使用标准变换对 $\\mathcal{L}^{-1}\\left\\{\\frac{1}{s+a}\\right\\} = e^{-at} u(t)$，其中 $u(t)$ 是亥维赛阶跃函数，当 $t  0$ 时为 $0$，当 $t \\ge 0$ 时为 $1$。\n$$ h(t) = \\mathcal{L}^{-1}\\left\\{ \\frac{\\sigma}{s + (\\alpha + \\sigma)} \\right\\} = \\sigma \\, \\mathcal{L}^{-1}\\left\\{ \\frac{1}{s + (\\alpha + \\sigma)} \\right\\} $$\n由此得到脉冲响应的解析表达式：\n$$ h(t) = \\sigma e^{-(\\alpha + \\sigma)t} u(t) $$\n\n**1. 因果性**\n解中亥维赛函数 $u(t)$ 的存在明确地强制了 $h(t) = 0$ 对所有 $t  0$ 成立的性质。这证实了该系统是因果的，这是一个物理系统的预期属性，其响应不能先于其原因。\n\n**2. 指数衰减**\n对于 $t > 0$，亥维赛函数 $u(t) = 1$，脉冲响应简化为：\n$$ h(t) = \\sigma e^{-(\\alpha + \\sigma)t} $$\n该表达式描述了一个指数衰减。衰减速率是衰减项 $e^{-kt}$ 指数中的正系数。因此，**理论衰减速率**为：\n$$ k_{th} = \\alpha + \\sigma $$\n约束条件 $\\alpha \\ge 0$ 和 $\\sigma \\ge 0$ 确保了衰减速率 $k_{th} \\ge 0$，从而保证了系统的稳定性（即脉冲响应不会无界增长）。\n\n当 $\\sigma = 0$ 时出现一种特殊情况。在这种情况下，对所有 $t$ 都有 $h(t) = 0 \\cdot e^{-\\alpha t} u(t) = 0$。脉冲响应平凡地为零。\n\n### 数值验证方案\n\n程序将对每对 $(\\alpha, \\sigma)$ 实现以下步骤。\n\n**1. 脉冲响应计算**\n创建一个从 $t_{\\min} = -0.01\\,\\mathrm{s}$到 $t_{\\max} = 1.0\\,\\mathrm{s}$、时间步长为 $\\Delta t = 10^{-3}\\,\\mathrm{s}$ 的均匀时间网格 $t$。然后在此网格的每个点上计算解析解 $h(t) = \\sigma e^{-(\\alpha + \\sigma)t} u(t)$。\n\n**2. 因果性检查**\n在数值上，通过检查所有计算出的 $t  0$ 的 $h(t)$ 值是否精确等于 $0$ 来验证因果性。\n\n**3. 衰减速率估计**\n通过对 $t > 0$ 的计算响应进行模型拟合来估计衰减速率。问题指定拟合 $\\log\\left(h(t)/h(0^{+})\\right)$ 与 $t$ 的关系。\n\n首先，我们确定 $h(0^{+})$，即 $h(t)$ 在 $t=0$ 处的右极限。从解析解可知，$h(0^{+}) = \\lim_{t \\to 0^+} \\sigma e^{-(\\alpha + \\sigma)t} = \\sigma$。\n\n我们定义一个新变量 $y(t) = \\log\\left(h(t)/h(0^{+})\\right)$。对于 $t > 0$：\n$$ y(t) = \\log\\left( \\frac{\\sigma e^{-(\\alpha + \\sigma)t}}{\\sigma} \\right) = \\log\\left( e^{-(\\alpha + \\sigma)t} \\right) = -(\\alpha + \\sigma)t $$\n这表明 $y(t)$ 是一个通过原点的关于 $t$ 的线性函数，其斜率为 $m = -(\\alpha + \\sigma)$。因此，估计的衰减速率为 $k_{est} = -m$。\n\n数值计算步骤如下：\n- **平凡情况 $(\\sigma = 0)$：** 如果 $\\sigma=0$，$h(t)$ 恒等于零。对数未定义。在这种情况下，响应是平凡的，测量的衰减速率被赋值为 $0.0\\,\\mathrm{s}^{-1}$。\n- **非平凡情况 $(\\sigma  0)$：**\n    1. 选择所有网格点 $t_i > 0$ 及其对应的响应值 $h_i$。\n    2. 计算拟合的目标值：$y_i = \\log(h_i / \\sigma)$。\n    3. 对数据点 $(t_i, y_i)$ 进行模型 $y = m t$ 的线性最小二乘拟合。这是一个通过原点的回归，可以通过找到最小化 $\\sum (y_i - m t_i)^2$ 的斜率 $m$ 来高效求解。解为 $m = (\\sum t_i y_i) / (\\sum t_i^2)$。我们将使用 `numpy.linalg.lstsq` 进行稳健的实现。\n    4. 计算得到的测量衰减速率为 $k_{est} = -m$。\n\n**4. 速率比较**\n将测量得到的衰减速率 $k_{est}$ 与理论速率 $k_{th} = \\alpha + \\sigma$ 进行比较。\n- 对于非平凡情况（$\\sigma > 0$，因此 $k_{th} > 0$，除非 $\\alpha=0$ 且 $\\sigma$ 趋近于 $0$），如果相对误差在指定容差范围内，即 $\\frac{|k_{est} - k_{th}|}{k_{th}} \\le 0.01$，则认为速率匹配。\n- 对于平凡零响应情况（$\\sigma = 0$），问题规定当且仅当测量速率和理论速率均为 $0$ 时，匹配结果为 `True`。我们的方案将 $k_{est}$ 设为 $0$。理论速率为 $k_{th} = \\alpha$。因此，只有当 $\\alpha = 0$ 且 $\\sigma=0$ 时，才满足匹配条件。\n\n这个全面的方案能够按要求验证系统的性质。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the impulse response of an ADE PML subsystem for given parameters.\n    For each test case, it computes the impulse response, verifies causality,\n    estimates the decay rate numerically, and compares it to the theoretical rate.\n    \"\"\"\n    # Define problem constants\n    t_min = -0.01\n    t_max = 1.0\n    dt = 0.001\n    rel_tol = 1e-2\n\n    # Construct the time grid\n    # Use round to prevent floating point inaccuracies in num_points calculation\n    num_points = int(round((t_max - t_min) / dt)) + 1\n    t = np.linspace(t_min, t_max, num_points)\n\n    # Define the test suite of parameter pairs (alpha, sigma)\n    test_cases = [\n        (50.0, 100.0),\n        (0.0, 10.0),\n        (10.0, 0.0),\n        (0.0, 0.0),\n        (1.0, 2.0)\n    ]\n\n    all_results = []\n    for alpha, sigma in test_cases:\n        # Theoretical decay rate is k = alpha + sigma\n        k_th = alpha + sigma\n\n        # Compute the analytical impulse response h(t) = sigma * exp(-(alpha+sigma)t) * u(t)\n        # where u(t) is the Heaviside step function.\n        h = np.zeros_like(t, dtype=float)\n        t_non_negative_mask = (t >= 0)\n        t_non_negative = t[t_non_negative_mask]\n        \n        # Only compute exponentiation if sigma is not zero\n        if sigma != 0:\n            h[t_non_negative_mask] = sigma * np.exp(-k_th * t_non_negative)\n\n        # Verify causality: h(t) must be 0 for t  0.\n        is_causal = np.all(h[t  0] == 0.0)\n\n        # Estimate the decay rate by fitting log(h(t)/h(0+)) vs t for t > 0.\n        # h(0+) = sigma. The model is log(h(t)/sigma) = -k*t, a line through the origin.\n        measured_rate = 0.0\n        rate_matches = False\n\n        if sigma == 0:\n            # Trivial zero response case\n            measured_rate = 0.0\n            # Per problem spec, match is True iff both measured and theoretical rates are 0.\n            # a measured_rate of 0 is assigned for this case.\n            # We compare with the theoretical rate k_th = alpha + 0 = alpha.\n            if k_th == 0.0:\n                rate_matches = True\n            else:\n                rate_matches = False\n        else: # Non-trivial response case (sigma > 0)\n            t_fit = t[t > 0]\n            h_fit = h[t > 0]\n            \n            # Ensure there are points to fit. This should always be true for the given grid.\n            if t_fit.size > 0:\n                # The model is y = m*t, where y=log(h/sigma) and m = -k_est\n                y_fit = np.log(h_fit / sigma)\n                \n                # Use np.linalg.lstsq to find the slope m.\n                # A needs to be a column vector for lstsq.\n                A = t_fit[:, np.newaxis]\n                \n                # Solve the least-squares problem A*m = y_fit\n                m_solution, _, _, _ = np.linalg.lstsq(A, y_fit, rcond=None)\n                slope = m_solution[0]\n                \n                measured_rate = -slope\n\n                # Compare the measured rate to the theoretical rate\n                if k_th == 0.0: \n                    # This case does not occur for sigma>0 with problem constraints (alpha>=0)\n                    # But for robustness, we use an absolute comparison.\n                    if np.isclose(measured_rate, 0.0, atol=rel_tol):\n                        rate_matches = True\n                else:\n                    # Use relative tolerance for non-zero theoretical rates\n                    if abs(measured_rate - k_th) / k_th = rel_tol:\n                        rate_matches = True\n            # else branch for t_fit.size == 0 is not needed for this problem's grid.\n\n        # Append results for the current test case\n        all_results.append([is_causal, rate_matches, measured_rate, k_th])\n\n    # Format the final output string as a list of lists.\n    # Booleans are converted to their standard string representations 'True' or 'False'.\n    # Floats are formatted to a consistent precision.\n    result_strings = []\n    for c, m, r, t in all_results:\n        result_strings.append(f\"[{c},{m},{r:.7f},{t:.7f}]\")\n    \n    # Print the final output in the exact required format.\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}