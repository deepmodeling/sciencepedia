{
    "hands_on_practices": [
        {
            "introduction": "在任意拉格朗日-欧拉（ALE）方法中，几何守恒律（Geometric Conservation Law, GCL）是确保数值方案在移动网格上保持正确性的基石。这个练习  将引导你通过构造一个思想实验——即“人造解方法”（Method of Manufactured Solutions）——来设计一个诊断测试。此举旨在验证一个离散格式是否满足GCL，从而加深你对这一核心原则的理解及其在代码验证中的重要性。",
            "id": "3944054",
            "problem": "考虑一个在任意拉格朗日-欧拉（ALE）有限体积格式中，由恒定均匀速度场对流的被动标量。ALE方法通过一个指定的网格（grid）速度来推进一个移动的控制体。您需要设计一种人工解法（MMS）验证，用以检测离散格式是否满足几何守恒律（GCL）。目标是构造一个人工均匀流和一个诊断量，该诊断量为零可验证离散格式符合GCL，而非零值则揭示了对GCL的违背。\n\n假设设置如下。\n\n- 物理空间中的控制方程是一个针对被动标量$\\,\\phi\\,$的守恒型对流方程，其对流速度$\\,\\boldsymbol{u}\\,$为恒定均匀向量，问题设定在三维空间中：标量由$\\,\\boldsymbol{u}\\,$输运，而控制体可以以网格速度$\\,\\boldsymbol{w}(\\boldsymbol{x},t)\\,$移动。\n- 与单元$\\,i\\,$关联的控制体是$\\,V_i(t)\\,$，其体积为$\\,|V_i(t)| \\equiv V_i(t)\\,$。其边界被划分为由索引$\\,f\\,$标记的平面，每个面具有外向单位法向量$\\,\\boldsymbol{n}_f\\,$和面积$\\,A_f\\,$。对于一个闭合多面体单元，面法向封闭性$\\,\\sum_{f} \\boldsymbol{n}_f A_f = \\boldsymbol{0}\\,$恒成立。\n- ALE有限体积法使用相对速度$\\,\\boldsymbol{u}-\\boldsymbol{w}_f\\,$计算面通量，其中$\\,\\boldsymbol{w}_f\\,$是投影或定义在面$\\,f\\,$上的网格速度。\n- 人工解是均匀场$\\,\\phi(\\boldsymbol{x},t)\\equiv \\phi_0\\,$，其中$\\,\\phi_0\\neq 0\\,$为常数，且$\\,\\boldsymbol{u}\\,$为恒定均匀向量。网格速度场$\\,\\boldsymbol{w}(\\boldsymbol{x},t)\\,$在空间和时间上是任意、光滑的，并且不被约束为无散或与$\\,\\boldsymbol{u}\\,$对齐。\n- 除了上述的面法向封闭性之外，逐单元的诊断量不需要特殊的边界约束。\n\n您将使用此人工均匀解，通过监测与均匀性的伪偏差来验证离散格式是否满足GCL。请选择所有正确指定了必要且充分的离散诊断量或条件的选项，在上述假设下，当且仅当格式离散地符合GCL时，该诊断量或条件必须对所有时间和任何容许的$\\,\\boldsymbol{w}(\\boldsymbol{x},t)\\,$在每个单元上都成立。\n\nA. 逐单元残差\n$$\nR_i \\;\\equiv\\; \\frac{d}{dt}\\big(\\phi_0\\,V_i(t)\\big)\\;+\\;\\phi_0\\sum_{f}\\Big[\\big(\\boldsymbol{u}-\\boldsymbol{w}_f\\big)\\cdot \\boldsymbol{n}_f\\Big]\\,A_f\n$$\n必须对所有$\\,t\\,$和任何$\\,\\boldsymbol{w}\\,$恒等于$\\,0\\,$；其非零值表示对离散GCL的违背。\n\nB. 设置$\\,\\boldsymbol{w}=\\boldsymbol{0}\\,$（固定网格）足以验证GCL，因为任何对GCL的违背在固定网格上仍会在$\\,\\phi\\,$中产生伪偏差。\n\nC. 对于所有$\\,t\\,$和任何$\\,\\boldsymbol{w}\\,$，要使人工均匀解在每个单元中保持精确均匀，唯一的方法是离散体积更新和面法向网格通量在每个单元上满足\n$$\n\\frac{dV_i}{dt} \\;=\\; \\sum_{f}\\big(\\boldsymbol{w}_f\\cdot \\boldsymbol{n}_f\\big)\\,A_f,\n$$\n这正是几何守恒律的离散表述。\n\nD. 一个更严格的诊断量，当且仅当格式符合GCL时，它必须对所有$\\,t\\,$和任何$\\,\\boldsymbol{w}\\,$为零，该诊断量为\n$$\n\\widetilde{R}_i \\;\\equiv\\; \\frac{d}{dt}\\big(\\phi_0\\,V_i(t)\\big)\\;+\\;\\phi_0\\sum_{f}\\big(\\boldsymbol{u}\\cdot \\boldsymbol{n}_f\\big)\\,A_f,\n$$\n其中不显式包含$\\,\\boldsymbol{w}\\,$。\n\nE. 为了通过任何此类针对任意$\\,\\boldsymbol{w}\\,$的MMS验证，必须在每个单元中施加$\\,\\nabla\\cdot \\boldsymbol{w} = 0\\,$的约束；否则，在移动网格上无法保持均匀解。\n\n选择所有适用选项。",
            "solution": "用户要求对一个关于任意拉格朗日-欧拉（ALE）格式和几何守恒律（GCL）的问题陈述进行细致的验证，然后给出完整的解答和对所提供选项的评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **控制方程**：三维空间中，关于被动标量$\\,\\phi\\,$的守恒型对流方程，其对流速度$\\,\\boldsymbol{u}\\,$恒定均匀。控制体以网格速度$\\,\\boldsymbol{w}(\\boldsymbol{x},t)\\,$移动。\n- **离散化**：ALE有限体积法。\n- **控制体**：对于单元$\\,i\\,$，体积为$\\,V_i(t)\\,$。\n- **单元边界**：由索引为$\\,f\\,$的平面组成，每个面有面积$\\,A_f\\,$和外向单位法向量$\\,\\boldsymbol{n}_f\\,$。\n- **封闭性**：对于任意闭合多面体单元，$\\,\\sum_{f} \\boldsymbol{n}_f A_f = \\boldsymbol{0}\\,$恒成立。\n- **通量计算**：面通量使用相对速度$\\,\\boldsymbol{u}-\\boldsymbol{w}_f\\,$计算，其中$\\,\\boldsymbol{w}_f\\,$是面$\\,f\\,$上的网格速度。\n- **人工解**：均匀标量场$\\,\\phi(\\boldsymbol{x},t) \\equiv \\phi_0\\,$，其中$\\,\\phi_0\\,$是一个非零常数。速度场$\\,\\boldsymbol{u}\\,$是恒定均匀的。\n- **网格速度**：$\\,\\boldsymbol{w}(\\boldsymbol{x},t)\\,$是空间和时间上的任意光滑函数。\n- **目标**：设计一个人工解法（MMS）诊断量，该诊断量当且仅当离散格式满足GCL时为零，从而验证其GCL符合性。\n\n**步骤2：使用提取的已知条件进行验证**\n- **有科学依据**：该问题在计算流体动力学（CFD）的成熟理论中有坚实的基础。ALE格式、GCL以及使用MMS进行程序验证都是该领域的标准和基本概念。\n- **适定的**：问题陈述清晰。它要求在特定测试（人工均匀解）下，为一个性质（GCL符合性）找到一个必要且充分的条件或诊断量。给定的条件足以推导出这样的条件。\n- **客观性**：语言精确、技术性强，没有主观或模糊的术语。\n- **缺陷清单**：\n    1.  **科学/事实上不成立**：无。所有原理均正确。\n    2.  **不可形式化/不相关**：该问题与指定主题高度相关，并且完全可以形式化。\n    3.  **设置不完整/矛盾**：设置完整且自洽。封闭性$\\,\\sum_{f} \\boldsymbol{n}_f A_f = \\boldsymbol{0}\\,$是一个关键信息，并且已正确提供。\n    4.  **不切实际/不可行**：所描述的MMS测试是验证CFD代码的常用且实用的程序。\n    5.  **不适定/结构不良**：问题结构良好，能导出一个唯一概念性答案。\n    6.  **伪深刻/琐碎**：该问题探讨了ALE格式的一个核心、非平凡的要求。\n    7.  **超出科学可验证性范围**：其中的论断在数学上是可验证的。\n\n**步骤3：结论与操作**\n问题陈述是**有效的**。接下来进行求解。\n\n### GCL条件的推导\n\n在一个任意移动的控制体$\\,V(t)\\,$中，标量$\\,\\phi\\,$的控制方程由Reynolds输运定理给出，其守恒律的积分形式为：\n$$\n\\frac{d}{dt}\\int_{V(t)} \\phi \\, dV + \\int_{\\partial V(t)} \\phi (\\boldsymbol{u} - \\boldsymbol{w}) \\cdot \\boldsymbol{n} \\, dA = 0\n$$\n其中$\\,\\boldsymbol{u}\\,$是流体速度，$\\,\\boldsymbol{w}\\,$是边界$\\,\\partial V(t)\\,$的速度。\n\n对于有限体积离散化，我们将此方程应用于单个单元$\\,i\\,$。体积为$\\,V_i(t)\\,$，单元平均标量为$\\,\\bar{\\phi}_i = \\frac{1}{V_i(t)}\\int_{V_i(t)} \\phi \\, dV\\,$。半离散有限体积方程为：\n$$\n\\frac{d}{dt}\\big(\\bar{\\phi}_i V_i(t)\\big) + \\sum_{f} F_f = 0\n$$\n其中$\\,F_f\\,$是通过面$\\,f\\,$的数值通量。根据问题描述，通量使用相对速度$\\,\\boldsymbol{u} - \\boldsymbol{w}_f\\,$计算。通过面$\\,f\\,$的通量的标准近似为$\\,F_f = \\phi_f (\\boldsymbol{u} - \\boldsymbol{w}_f) \\cdot \\boldsymbol{n}_f A_f\\,$，其中$\\,\\phi_f\\,$是面上的标量值。\n\n单元$\\,i\\,$的完整半离散方程为：\n$$\n\\frac{d}{dt}\\big(\\bar{\\phi}_i V_i(t)\\big) + \\sum_{f} \\phi_f (\\boldsymbol{u} - \\boldsymbol{w}_f) \\cdot \\boldsymbol{n}_f A_f = 0\n$$\n现在，我们应用人工解法（MMS），使用均匀场$\\,\\phi(\\boldsymbol{x},t) \\equiv \\phi_0\\,$，其中$\\,\\phi_0 \\neq 0\\,$是一个常数。对于这个均匀场：\n- 单元平均值为$\\,\\bar{\\phi}_i = \\phi_0\\,$。\n- 面上的值为$\\,\\phi_f = \\phi_0\\,$。\n\n将这些代入半离散方程，得到人工解的单元残差：\n$$\n\\frac{d}{dt}\\big(\\phi_0 V_i(t)\\big) + \\sum_{f} \\phi_0 (\\boldsymbol{u} - \\boldsymbol{w}_f) \\cdot \\boldsymbol{n}_f A_f = 0\n$$\n为了使数值格式能精确保持这个均匀解，该残差必须恒等于零。由于$\\,\\phi_0\\,$是常数，我们可以将其从时间导数和求和项中提出：\n$$\n\\phi_0 \\frac{d V_i(t)}{dt} + \\phi_0 \\sum_{f} (\\boldsymbol{u} - \\boldsymbol{w}_f) \\cdot \\boldsymbol{n}_f A_f = 0\n$$\n让我们展开求和项：\n$$\n\\sum_{f} (\\boldsymbol{u} - \\boldsymbol{w}_f) \\cdot \\boldsymbol{n}_f A_f = \\sum_{f} (\\boldsymbol{u} \\cdot \\boldsymbol{n}_f) A_f - \\sum_{f} (\\boldsymbol{w}_f \\cdot \\boldsymbol{n}_f) A_f\n$$\n由于对流速度$\\,\\boldsymbol{u}\\,$是恒定均匀的，它可以从第一个求和项中提出：\n$$\n\\sum_{f} (\\boldsymbol{u} \\cdot \\boldsymbol{n}_f) A_f = \\boldsymbol{u} \\cdot \\left(\\sum_{f} \\boldsymbol{n}_f A_f\\right)\n$$\n使用给定的几何封闭性$\\,\\sum_{f} \\boldsymbol{n}_f A_f = \\boldsymbol{0}\\,$，该项为零：\n$$\n\\boldsymbol{u} \\cdot \\left(\\sum_{f} \\boldsymbol{n}_f A_f\\right) = \\boldsymbol{u} \\cdot \\boldsymbol{0} = 0\n$$\n因此，残差方程简化为：\n$$\n\\phi_0 \\frac{d V_i(t)}{dt} + \\phi_0 \\left( - \\sum_{f} (\\boldsymbol{w}_f \\cdot \\boldsymbol{n}_f) A_f \\right) = 0\n$$\n$$\n\\phi_0 \\left( \\frac{d V_i(t)}{dt} - \\sum_{f} (\\boldsymbol{w}_f \\cdot \\boldsymbol{n}_f) A_f \\right) = 0\n$$\n由于$\\,\\phi_0 \\neq 0\\,$，要使该方程对任意网格运动$\\,\\boldsymbol{w}(\\boldsymbol{x},t)\\,$都成立，括号中的项必须为零。这给出了必要且充分的条件：\n$$\n\\frac{d V_i(t)}{dt} = \\sum_{f} (\\boldsymbol{w}_f \\cdot \\boldsymbol{n}_f) A_f\n$$\n这就是**几何守恒律（GCL）**的离散形式。它要求由时间积分格式计算的单元体积变化率，必须精确等于网格速度通过该单元所有面的通量之和。满足此恒等式的格式称为符合GCL。不满足GCL会导致在使用均匀密度场时产生伪质量，这就是为什么这种MMS测试是有效的。\n\n### 逐项分析\n\n**A. 逐单元残差 $$R_i \\;\\equiv\\; \\frac{d}{dt}\\big(\\phi_0\\,V_i(t)\\big)\\;+\\;\\phi_0\\sum_{f}\\Big[\\big(\\boldsymbol{u}-\\boldsymbol{w}_f\\big)\\cdot \\boldsymbol{n}_f\\Big]\\,A_f$$ 必须对所有 $\\,t\\,$ 和任何 $\\,\\boldsymbol{w}\\,$ 恒等于 $\\,0\\,$；其非零值表示对离散 GCL 的违背。**\n\n$\\,R_i\\,$的这个表达式正是人工解$\\,\\phi_0\\,$的半离散方程在设为零之前的左侧。如推导所示：\n$$\nR_i = \\phi_0 \\left( \\frac{d V_i(t)}{dt} - \\sum_{f} (\\boldsymbol{w}_f \\cdot \\boldsymbol{n}_f) A_f \\right)\n$$\n由于$\\,\\phi_0 \\neq 0\\,$，条件$\\,R_i = 0\\,$在数学上等价于GCL：$\\,\\frac{d V_i}{dt} = \\sum_{f}(\\boldsymbol{w}_f\\cdot \\boldsymbol{n}_f)A_f\\,$。因此，对于任何容许的网格运动$\\,\\boldsymbol{w}\\,$，该残差$\\,R_i\\,$为零是确认格式符合GCL的必要且充分的诊断。非零的$\\,R_i\\,$直接度量了对GCL的违背程度。\n\n**结论：正确**\n\n**B. 设置$\\,\\boldsymbol{w}=\\boldsymbol{0}\\,$（固定网格）足以验证GCL，因为任何对GCL的违背在固定网格上仍会在$\\,\\phi\\,$中产生伪偏差。**\n\n如果$\\,\\boldsymbol{w}=\\boldsymbol{0}\\,$，那么所有面上的$\\,\\boldsymbol{w}_f = \\boldsymbol{0}\\,$。GCL方程变为：\n$$\n\\frac{d V_i}{dt} = \\sum_{f} (\\boldsymbol{0} \\cdot \\boldsymbol{n}_f) A_f = 0\n$$\n这要求$\\,dV_i/dt = 0\\,$，意味着单元体积是恒定的。对于固定网格，这是平凡成立的。因此，在固定网格上运行模拟，无法提供关于数值格式中负责处理网格运动并确保满足GCL的组件的任何信息。GCL是一个仅对移动/变形网格（$\\boldsymbol{w} \\neq \\boldsymbol{0}$）才非平凡的约束。\n\n**结论：不正确**\n\n**C. 对于所有$\\,t\\,$和任何$\\,\\boldsymbol{w}\\,$，要使人工均匀解在每个单元中保持精确均匀，唯一的方法是离散体积更新和面法向网格通量在每个单元上满足 $$ \\frac{dV_i}{dt} \\;=\\; \\sum_{f}\\big(\\boldsymbol{w}_f\\cdot \\boldsymbol{n}_f\\big)\\,A_f, $$ 这正是几何守恒律的离散表述。**\n\n如推导所示，要求离散控制方程对均匀解$\\,\\phi_0 \\neq 0\\,$精确满足，直接导出了条件$\\,\\frac{d V_i}{dt} = \\sum_{f}(\\boldsymbol{w}_f\\cdot \\boldsymbol{n}_f)A_f\\,$。这个条件既是必要的（如果解得以保持，GCL必须成立），也是充分的（如果GCL成立，均匀解的残差为零，因此解得以保持）。该陈述准确地描述了这一基本关系。\n\n**结论：正确**\n\n**D. 一个更严格的诊断量，当且仅当格式符合GCL时，它必须对所有$\\,t\\,$和任何$\\,\\boldsymbol{w}\\,$为零，该诊断量为 $$ \\widetilde{R}_i \\;\\equiv\\; \\frac{d}{dt}\\big(\\phi_0\\,V_i(t)\\big)\\;+\\;\\phi_0\\sum_{f}\\big(\\boldsymbol{u}\\cdot \\boldsymbol{n}_f\\big)\\,A_f, $$ 其中不显式包含$\\,\\boldsymbol{w}\\,$。**\n\n我们来分析这个提议的诊断量$\\,\\widetilde{R}_i\\,$。\n$$\n\\widetilde{R}_i = \\phi_0 \\frac{d V_i}{dt} + \\phi_0 \\sum_{f}(\\boldsymbol{u}\\cdot \\boldsymbol{n}_f)A_f\n$$\n如主推导所示，求和项由于封闭性$\\,\\sum_f \\boldsymbol{n}_f A_f = \\boldsymbol{0}\\,$和$\\,\\boldsymbol{u}\\,$的均匀性而恒等于零。\n$$\n\\sum_{f}(\\boldsymbol{u}\\cdot \\boldsymbol{n}_f)A_f = \\boldsymbol{u} \\cdot \\left(\\sum_f \\boldsymbol{n}_f A_f\\right) = 0\n$$\n因此，该诊断量简化为$\\,\\widetilde{R}_i = \\phi_0 \\frac{d V_i}{dt}\\,$。条件$\\,\\widetilde{R}_i = 0\\,$将意味着$\\,\\frac{d V_i}{dt} = 0\\,$。这意味着对于任意网格运动$\\,\\boldsymbol{w}\\,$，单元体积都必须保持不变，这是一个不正确且过度限制的条件。在通用的ALE格式中，网格单元是明确允许体积变化的。这个诊断量存在根本性缺陷，与GCL无关。\n\n**结论：不正确**\n\n**E. 为了通过任何此类针对任意$\\,\\boldsymbol{w}\\,$的MMS验证，必须在每个单元中施加$\\,\\nabla\\cdot \\boldsymbol{w} = 0\\,$的约束；否则，在移动网格上无法保持均匀解。**\n\n这个陈述颠倒了逻辑。GCL是正确处理任意网格运动（包括$\\,\\nabla \\cdot \\boldsymbol{w} \\neq 0\\,$的非保体运动）所需的特定数值条件。（注意，根据Reynolds输运定理，有$\\,\\frac{1}{V}\\frac{dV}{dt} = \\nabla \\cdot \\boldsymbol{w}\\,$）。一个符合GCL的格式必须能为*任何*光滑的网格速度场$\\,\\boldsymbol{w}\\,$正确地保持均匀流场，而不仅仅是针对无散（等容）网格运动的特殊情况。在测试案例中强加$\\,\\nabla \\cdot \\boldsymbol{w} = 0\\,$的约束，会避免测试格式处理一般情况的能力。因此，这对格式来说不是一个必要条件；而是对验证测试的一个不必要的限制。\n\n**结论：不正确**",
            "answer": "$$\n\\boxed{AC}\n$$"
        },
        {
            "introduction": "确立了GCL作为正确性的基本要求后，我们来探讨ALE方法的关键优势：提高计算精度。本练习  通过对一个简单的线性对流问题进行冯·诺依曼稳定性分析，来量化网格运动如何影响数值耗散和色散等误差。它为你提供了一个坚实的数学依据，以理解为何通过移动网格来追踪流动特征能够显著减少数值误差。",
            "id": "3944042",
            "problem": "考虑一个被动标量 $u(x,t)$ 的一维线性平流问题，其在惯性参考系中的物理平流速度为常数 $a > 0$，由守恒律 $\\partial u/\\partial t + \\partial (a u)/\\partial x = 0$ 控制。使用均匀网格对求解域进行离散化，该网格以恒定速度 $w$ 在 $x$ 方向上刚性平移，因此单元尺寸 $\\Delta x$ 随时间保持不变。采用任意拉格朗日-欧拉（ALE）有限体积格式，其中单元 $i$ 的半离散平衡方程为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(u_i \\Delta x\\right) + \\left[(a - w) u\\right]_{i+\\frac{1}{2}} - \\left[(a - w) u\\right]_{i-\\frac{1}{2}} = 0,\n$$\n其中 $[\\cdot]_{i\\pm \\frac{1}{2}}$ 表示在右/左单元面上的值，相对平流速度为 $a - w$。假设 $a - w > 0$。考虑用于计算单元面值 $u_{i+\\frac{1}{2}}$ 的两种相容的数值通量：由 $u_{i+\\frac{1}{2}}^{C} = \\left(u_i + u_{i+1}\\right)/2$ 定义的中心（对称）通量，以及由 $u_{i+\\frac{1}{2}}^{U} = u_i$ 定义的一阶迎风通量。\n\n通过假设一个傅里叶模态 $u_i(t) = \\hat{u} \\exp\\!\\left(\\lambda t\\right) \\exp\\!\\left(\\mathrm{i} i \\theta\\right)$，进行一次具有精确时间积分的空间冯·诺依曼分析（空间半离散分析），其中 $\\theta \\in [0, \\pi]$ 是无量纲波数，$\\mathrm{i}$ 是虚数单位。分别推导中心通量和迎风通量的半离散色散关系 $\\lambda_C(\\theta,w)$ 和 $\\lambda_U(\\theta,w)$。在每种情况下，确定数值耗散率（非负量 $-\\Re[\\lambda]$）和网格参考系中的数值相速度（定义为 $c_p = -\\Im[\\lambda]/k$，其中 $k = \\theta/\\Delta x$），并定性讨论网格速度 $w$ 如何影响这些误差。\n\n最后，就 $a$、$w$、$\\Delta x$ 和 $\\theta$ 提供一个单一的闭式解析表达式，用于表示单位时间的迎风数值耗散率，其定义为 $\\sigma_{\\mathrm{up}}(\\theta,w) \\equiv -\\Re\\left[\\lambda_U(\\theta,w)\\right]$。你的最终答案必须仅为该表达式。不要包含单位。不要四舍五入。",
            "solution": "用户要求对使用任意拉格朗日-欧拉（ALE）有限体积方法离散化的一维线性平流方程进行冯·诺依曼稳定性分析。\n\n### 步骤1：提取已知条件\n-   **控制方程：** $\\frac{\\partial u}{\\partial t} + \\frac{\\partial (a u)}{\\partial x} = 0$，其中 $a > 0$ 是一个恒定的物理平流速度。\n-   **网格：** 具有恒定单元尺寸 $\\Delta x$ 的均匀网格，以恒定速度 $w$ 刚性平移。\n-   **ALE 半离散格式：** $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(u_i \\Delta x\\right) + \\left[(a - w) u\\right]_{i+\\frac{1}{2}} - \\left[(a - w) u\\right]_{i-\\frac{1}{2}} = 0$。\n-   **相对平流速度：** $a - w > 0$。\n-   **在单元面 $i+\\frac{1}{2}$ 处的数值通量：**\n    -   中心通量：$u_{i+\\frac{1}{2}}^{C} = \\frac{1}{2}\\left(u_i + u_{i+1}\\right)$。\n    -   一阶迎风通量：$u_{i+\\frac{1}{2}}^{U} = u_i$。\n-   **傅里叶模态假设：** $u_i(t) = \\hat{u} \\exp\\!\\left(\\lambda t\\right) \\exp\\!\\left(\\mathrm{i} i \\theta\\right)$，其中 $\\theta \\in [0, \\pi]$ 是无量纲波数，$\\mathrm{i}$ 是虚数单位。\n-   **定义：**\n    -   数值耗散率：$-\\Re[\\lambda]$。\n    -   网格参考系中的数值相速度：$c_p = -\\Im[\\lambda]/k$，其中 $k = \\theta/\\Delta x$。\n-   **最终任务：** 为迎风数值耗散率提供一个闭式表达式，$\\sigma_{\\mathrm{up}}(\\theta,w) \\equiv -\\Re\\left[\\lambda_U(\\theta,w)\\right]$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在偏微分方程数值分析这一成熟领域具有坚实的科学基础，特别关注双曲守恒律有限体积格式的稳定性和精度分析。ALE 格式、冯·诺依曼分析、数值耗散和色散等概念在计算流体动力学中是标准内容。该问题是适定的，提供了推导唯一解所需的所有必要定义、方程和约束（例如 $a-w > 0$）。语言客观且精确。问题是自洽且内部一致的。这个问题并非微不足道，因为它需要将标准分析技术应用于一个非标准（ALE）的参考系。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n单元 $i$ 的半离散方程如下：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(u_i \\Delta x\\right) + \\left[(a - w) u\\right]_{i+\\frac{1}{2}} - \\left[(a - w) u\\right]_{i-\\frac{1}{2}} = 0\n$$\n由于网格单元尺寸 $\\Delta x$ 随时间恒定，我们可以将其从时间导数中提出：\n$$\n\\Delta x \\frac{\\mathrm{d}u_i}{\\mathrm{d}t} + (a-w)u_{i+\\frac{1}{2}} - (a-w)u_{i-\\frac{1}{2}} = 0\n$$\n我们通过代入傅里叶模态 $u_j(t) = \\hat{u} \\exp(\\lambda t) \\exp(\\mathrm{i} j \\theta)$（对于任意索引 $j$）来进行冯·诺依曼分析。时间导数为 $\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = \\lambda u_i$。将其代入方程可得：\n$$\n\\Delta x \\lambda u_i + (a-w)u_{i+\\frac{1}{2}} - (a-w)u_{i-\\frac{1}{2}} = 0\n$$\n可以重新整理此式以求解复放大因子 $\\lambda$：\n$$\n\\lambda = -\\frac{a-w}{\\Delta x u_i} \\left( u_{i+\\frac{1}{2}} - u_{i-\\frac{1}{2}} \\right)\n$$\n现在我们分别分析中心格式和迎风格式。对于任意单元 $j$，我们可以使用傅里叶模态将 $u_j$ 表示为 $u_i$ 的函数：$u_j = u_i \\exp(\\mathrm{i}(j-i)\\theta)$。具体来说，$u_{i+1} = u_i \\exp(\\mathrm{i}\\theta)$ 和 $u_{i-1} = u_i \\exp(-\\mathrm{i}\\theta)$。\n\n**1. 中心通量：$u_{i+\\frac{1}{2}}^{C} = \\frac{1}{2}(u_i + u_{i+1})$**\n\n右侧面 $i+\\frac{1}{2}$ 的通量项为 $u_{i+\\frac{1}{2}} = \\frac{1}{2}(u_i + u_{i+1})$。根据对称性，左侧面 $i-\\frac{1}{2}$ 的通量为 $u_{i-\\frac{1}{2}} = \\frac{1}{2}(u_{i-1} + u_i)$。\n将这些代入 $\\lambda$ 的表达式中：\n$$\n\\lambda_C = -\\frac{a-w}{\\Delta x u_i} \\left[ \\frac{1}{2}(u_i + u_{i+1}) - \\frac{1}{2}(u_{i-1} + u_i) \\right]\n$$\n$$\n\\lambda_C = -\\frac{a-w}{2\\Delta x u_i} (u_{i+1} - u_{i-1})\n$$\n现在，代入傅里叶模态关系：\n$$\n\\lambda_C = -\\frac{a-w}{2\\Delta x u_i} \\left[ u_i \\exp(\\mathrm{i}\\theta) - u_i \\exp(-\\mathrm{i}\\theta) \\right]\n$$\n$$\n\\lambda_C = -\\frac{a-w}{2\\Delta x} \\left[ \\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta) \\right]\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{1}{2\\mathrm{i}}(\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta))$，可简化为：\n$$\n\\lambda_C(\\theta,w) = -\\frac{a-w}{2\\Delta x} (2\\mathrm{i}\\sin\\theta) = -\\mathrm{i} \\frac{a-w}{\\Delta x} \\sin(\\theta)\n$$\n-   **数值耗散率：** $-\\Re[\\lambda_C] = -\\Re[0] = 0$。中心格式是无耗散的。\n-   **数值相速度：** 虚部为 $\\Im[\\lambda_C] = -\\frac{a-w}{\\Delta x}\\sin(\\theta)$。物理波数为 $k = \\theta/\\Delta x$。\n    $$\n    c_p^C = -\\frac{\\Im[\\lambda_C]}{k} = -\\frac{-\\frac{a-w}{\\Delta x}\\sin(\\theta)}{\\theta/\\Delta x} = (a-w)\\frac{\\sin(\\theta)}{\\theta}\n    $$\n-   **关于 $w$ 的讨论：** 网格速度 $w$ 通过将有效平流速度修正为 $a-w$ 来影响相速度的计算。相误差是数值相速度 $c_p^C$ 与网格参考系中的精确相速度 ($a-w$) 之差，即 $(a-w)(\\frac{\\sin\\theta}{\\theta} - 1)$。此误差与相对速度 $a-w$ 成正比。该格式是纯色散的，$w$ 对（零）耗散没有影响。\n\n**2. 一阶迎风通量：$u_{i+\\frac{1}{2}}^{U} = u_i$**\n\n由于相对平流速度 $a-w$ 为正，相对于网格的流动方向是从左到右。因此，在面 $i+\\frac{1}{2}$ 的迎风值为 $u_i$，在面 $i-\\frac{1}{2}$ 的迎风值为 $u_{i-1}$。\n将这些代入 $\\lambda$ 的表达式中：\n$$\n\\lambda_U = -\\frac{a-w}{\\Delta x u_i} \\left[ u_i - u_{i-1} \\right]\n$$\n现在，代入 $u_{i-1}$ 的傅里叶模态关系：\n$$\n\\lambda_U = -\\frac{a-w}{\\Delta x u_i} \\left[ u_i - u_i \\exp(-\\mathrm{i}\\theta) \\right]\n$$\n$$\n\\lambda_U = -\\frac{a-w}{\\Delta x} \\left[ 1 - \\exp(-\\mathrm{i}\\theta) \\right]\n$$\n使用欧拉恒等式 $\\exp(-\\mathrm{i}\\theta) = \\cos(\\theta) - \\mathrm{i}\\sin(\\theta)$：\n$$\n\\lambda_U = -\\frac{a-w}{\\Delta x} \\left[ 1 - (\\cos\\theta - \\mathrm{i}\\sin\\theta) \\right]\n$$\n$$\n\\lambda_U(\\theta,w) = -\\frac{a-w}{\\Delta x}(1 - \\cos\\theta) - \\mathrm{i}\\frac{a-w}{\\Delta x}\\sin\\theta\n$$\n-   **数值耗散率：** 这是量 $\\sigma_{\\mathrm{up}}(\\theta,w)$。\n    $$\n    \\sigma_{\\mathrm{up}}(\\theta,w) = -\\Re[\\lambda_U] = -\\left[-\\frac{a-w}{\\Delta x}(1 - \\cos\\theta)\\right] = \\frac{a-w}{\\Delta x}(1 - \\cos\\theta)\n    $$\n    由于 $a-w > 0$ 且对于所有 $\\theta$ 都有 $1-\\cos\\theta \\geq 0$，因此耗散率是非负的，表明该格式是稳定的。这就是最终答案所需的表达式。\n-   **数值相速度：** 虚部为 $\\Im[\\lambda_U] = -\\frac{a-w}{\\Delta x}\\sin(\\theta)$。\n    $$\n    c_p^U = -\\frac{\\Im[\\lambda_U]}{k} = -\\frac{-\\frac{a-w}{\\Delta x}\\sin(\\theta)}{\\theta/\\Delta x} = (a-w)\\frac{\\sin(\\theta)}{\\theta}\n    $$\n    迎风格式的数值相速度与中心格式的数值相速度相同。\n-   **关于 $w$ 的讨论：** 网格速度 $w$ 同时影响数值耗散和相误差。两种误差都与相对速度 $a-w$ 成正比。具体来说，耗散率 $\\sigma_{\\mathrm{up}} \\propto (a-w)$，相误差 $(a-w)(\\frac{\\sin\\theta}{\\theta} - 1) \\propto (a-w)$。这意味着如果网格随流而动（即 $w \\to a$），相对速度趋于零，数值耗散和相误差都会消失。这是 ALE（或拉格朗日）方法的主要优点：通过移动网格来追踪流动特征，可以显著减少数值误差。\n\n问题要求提供一个单一的闭式解析表达式，用于表示单位时间的迎风数值耗散率 $\\sigma_{\\mathrm{up}}(\\theta,w) \\equiv -\\Re\\left[\\lambda_U(\\theta,w)\\right]$。根据以上推导，该表达式为：\n$$\n\\sigma_{\\mathrm{up}}(\\theta,w) = \\frac{a-w}{\\Delta x}(1 - \\cos\\theta)\n$$\n此表达式作为最终答案提供。",
            "answer": "$$\n\\boxed{\\frac{a - w}{\\Delta x} (1 - \\cos(\\theta))}\n$$"
        },
        {
            "introduction": "理解了ALE的“为何”之后，我们转向“如何”实现。ALE模拟的一个关键组成部分是确定网格速度的算法。本练习  探讨了一种常见且优雅的方法——拉普拉斯平滑，要求你从变分原理出发推导其控制方程，并分析其优缺点。这将为你提供处理平滑、行为良好的网格运动这一实际问题的动手经验。",
            "id": "3944031",
            "problem": "在任意拉格朗日-欧拉 (ALE) 计算流体动力学 (CFD) 中，一种确定内部网格速度场的策略是将网格视为一个伪连续体，该连续体将内部运动从边界平滑地重新分布。考虑一个覆盖矩形流体域 $\\Omega=\\{(x,y): 0",
            "solution": "首先验证问题，以确保其科学基础扎实、适定、客观和完整。\n\n### 步骤 1：提取已知条件\n-   **方法论**：任意拉格朗日-欧拉 (ALE) 计算流体动力学 (CFD)。\n-   **域**：一个二维 ($2$D) 矩形区域 $\\Omega=\\{(x,y): 0",
            "answer": "$$\n\\boxed{V_{0} \\frac{\\sinh\\left(\\frac{\\pi y}{L}\\right)}{\\sinh\\left(\\frac{\\pi H}{L}\\right)} \\sin\\left(\\frac{\\pi x}{L}\\right)}\n$$"
        }
    ]
}