{
    "hands_on_practices": [
        {
            "introduction": "This first practice focuses on the \"Arbitrary\" aspect of the ALE formulation: how to determine the motion of the mesh itself. A common and effective method is to treat the mesh as a pseudo-elastic solid, ensuring that boundary movements are smoothly propagated into the interior to maintain mesh quality. This exercise asks you to derive the governing equation for one such method, Laplacian smoothing, from a variational principle and then solve it for a specific case, providing insight into its fundamental mathematical properties and practical limitations .",
            "id": "3944031",
            "problem": "In Arbitrary Lagrangian–Eulerian (ALE) Computational Fluid Dynamics (CFD), one strategy for determining an interior mesh velocity field is to treat the mesh as a pseudo-continuum that redistributes interior motion smoothly from the boundaries. Consider a two-dimensional ($2$D) mesh over a rectangular fluid domain $\\Omega=\\{(x,y): 0xL,\\ 0yH\\}$, and let $w(x,y)$ denote the vertical component of the mesh velocity, to be enforced as Dirichlet data on $\\partial\\Omega$ and determined in the interior of $\\Omega$ by a smoothing principle. Start from the Dirichlet energy functional for a scalar field,\n$$\n\\mathcal{J}[w]=\\int_{\\Omega} \\frac{1}{2}|\\nabla w|^{2}\\,\\mathrm{d}\\Omega,\n$$\nand, using calculus of variations, derive the governing interior partial differential equation (PDE) and natural boundary conditions that arise when $w$ is prescribed on $\\partial\\Omega$. Then, for the specific boundary data\n$$\nw(x,0)=0,\\quad w(x,H)=V_{0}\\sin\\!\\left(\\frac{\\pi x}{L}\\right),\\quad w(0,y)=0,\\quad w(L,y)=0,\n$$\nwith constants $L0$, $H0$, and $V_{0}$ a given constant velocity scale, solve the resulting boundary value problem in closed form by separation of variables and orthogonality, and obtain the unique smooth field $w(x,y)$ in $\\Omega$. Finally, using the same variational perspective and the maximum principle for harmonic functions, justify one advantage and one limitation of this smoothing approach for mesh quality in large-deformation flows, without appealing to any numerical experiment. Your final reported answer must be the single closed-form expression you obtain for $w(x,y)$; do not include units in the final answer.",
            "solution": "### Derivation of the Governing PDE\n\nThe smoothing principle is based on minimizing the Dirichlet energy functional for the vertical mesh velocity component $w(x,y)$:\n$$\n\\mathcal{J}[w] = \\int_{\\Omega} \\frac{1}{2}|\\nabla w|^{2}\\,\\mathrm{d}\\Omega = \\frac{1}{2} \\iint_{\\Omega} \\left[ \\left(\\frac{\\partial w}{\\partial x}\\right)^2 + \\left(\\frac{\\partial w}{\\partial y}\\right)^2 \\right] \\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\nTo find the function $w$ that minimizes this functional subject to prescribed boundary values, we use the calculus of variations. We consider an admissible variation of $w$, given by $w + \\epsilon\\eta$, where $\\eta(x,y)$ is an arbitrary smooth function that vanishes on the boundary $\\partial\\Omega$ (i.e., $\\eta|_{\\partial\\Omega}=0$), and $\\epsilon$ is a small parameter. The condition for an extremum is that the first variation of $\\mathcal{J}$ is zero:\n$$\n\\delta \\mathcal{J} = \\left. \\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon} \\mathcal{J}[w+\\epsilon\\eta] \\right|_{\\epsilon=0} = 0\n$$\nSubstituting $w+\\epsilon\\eta$ into the functional gives:\n$$\n\\mathcal{J}[w+\\epsilon\\eta] = \\frac{1}{2} \\iint_{\\Omega} \\left[ \\left(\\frac{\\partial w}{\\partial x} + \\epsilon\\frac{\\partial \\eta}{\\partial x}\\right)^2 + \\left(\\frac{\\partial w}{\\partial y} + \\epsilon\\frac{\\partial \\eta}{\\partial y}\\right)^2 \\right] \\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\nDifferentiating with respect to $\\epsilon$ yields:\n$$\n\\frac{\\mathrm{d}\\mathcal{J}}{\\mathrm{d}\\epsilon} = \\iint_{\\Omega} \\left[ \\left(\\frac{\\partial w}{\\partial x} + \\epsilon\\frac{\\partial \\eta}{\\partial x}\\right)\\frac{\\partial \\eta}{\\partial x} + \\left(\\frac{\\partial w}{\\partial y} + \\epsilon\\frac{\\partial \\eta}{\\partial y}\\right)\\frac{\\partial \\eta}{\\partial y} \\right] \\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\nSetting $\\epsilon=0$, we obtain the first variation:\n$$\n\\delta \\mathcal{J} = \\iint_{\\Omega} \\left( \\frac{\\partial w}{\\partial x}\\frac{\\partial \\eta}{\\partial x} + \\frac{\\partial w}{\\partial y}\\frac{\\partial \\eta}{\\partial y} \\right) \\,\\mathrm{d}x\\,\\mathrm{d}y = \\iint_{\\Omega} \\nabla w \\cdot \\nabla \\eta \\,\\mathrm{d}\\Omega = 0\n$$\nWe apply the divergence theorem in the form of Green's first identity, $\\iint_{\\Omega} \\nabla w \\cdot \\nabla \\eta \\,\\mathrm{d}\\Omega = \\int_{\\partial\\Omega} \\eta (\\nabla w \\cdot \\mathbf{n}) \\,\\mathrm{d}S - \\iint_{\\Omega} \\eta (\\nabla^2 w) \\,\\mathrm{d}\\Omega$, where $\\mathbf{n}$ is the outward unit normal to $\\partial\\Omega$.\nThe first variation becomes:\n$$\n\\delta \\mathcal{J} = \\int_{\\partial\\Omega} \\eta (\\nabla w \\cdot \\mathbf{n}) \\,\\mathrm{d}S - \\iint_{\\Omega} \\eta (\\nabla^2 w) \\,\\mathrm{d}\\Omega = 0\n$$\nSince $w$ is prescribed on the entire boundary $\\partial\\Omega$, the variation $\\eta$ must be zero on $\\partial\\Omega$. Consequently, the boundary integral vanishes: $\\int_{\\partial\\Omega} \\eta (\\nabla w \\cdot \\mathbf{n}) \\,\\mathrm{d}S = 0$. We are left with:\n$$\n\\iint_{\\Omega} \\eta (\\nabla^2 w) \\,\\mathrm{d}\\Omega = 0\n$$\nBy the fundamental lemma of calculus of variations, since this equality must hold for any choice of $\\eta$ that is zero on the boundary, the integrand must be identically zero throughout the domain $\\Omega$. Thus, the governing interior PDE is Laplace's equation:\n$$\n\\nabla^2 w = 0\n$$\nThe problem also asks for natural boundary conditions. These arise on portions of the boundary where the field is not prescribed (i.e., where $\\eta \\neq 0$). On such a boundary segment, for $\\delta\\mathcal{J}$ to be zero, one would require the boundary integrand $\\eta(\\nabla w \\cdot \\mathbf{n})$ to vanish. Since $\\eta$ would be arbitrary, this implies the natural boundary condition is $\\nabla w \\cdot \\mathbf{n} = \\frac{\\partial w}{\\partial n} = 0$, which is a homogeneous Neumann condition. However, in the specified problem, $w$ is prescribed on the entire boundary (Dirichlet conditions), so there are no natural boundary conditions to be applied.\n\n### Solution of the Boundary Value Problem\n\nWe must solve the following BVP:\n-   PDE: $\\frac{\\partial^2 w}{\\partial x^2} + \\frac{\\partial^2 w}{\\partial y^2} = 0$ for $x \\in (0,L)$ and $y \\in (0,H)$.\n-   Boundary Conditions:\n    $w(x,0)=0$\n    $w(x,H)=V_{0}\\sin(\\frac{\\pi x}{L})$\n    $w(0,y)=0$\n    $w(L,y)=0$\n\nWe use the method of separation of variables, assuming a solution of the form $w(x,y) = X(x)Y(y)$. Substituting this into the PDE gives $X''(x)Y(y) + X(x)Y''(y) = 0$, which can be rearranged as:\n$$\n\\frac{X''(x)}{X(x)} = -\\frac{Y''(y)}{Y(y)} = -k\n$$\nwhere $k$ is a separation constant. This gives two ordinary differential equations. The boundary conditions on $w$ dictate the conditions on $X$ and $Y$. The homogeneous conditions are $w(0,y)=0$ and $w(L,y)=0$, which imply $X(0)=0$ and $X(L)=0$. The problem for $X(x)$ is thus:\n$$\nX''(x) + kX(x) = 0, \\quad X(0)=0, \\quad X(L)=0\n$$\nThis is a Sturm-Liouville problem. For non-trivial solutions, the constant $k$ must be positive. Let $k = \\lambda^2$. The general solution is $X(x) = A\\cos(\\lambda x) + B\\sin(\\lambda x)$.\n$X(0)=A=0$. The solution is $X(x) = B\\sin(\\lambda x)$.\n$X(L)=B\\sin(\\lambda L)=0$. For a non-trivial solution ($B \\neq 0$), we need $\\sin(\\lambda L)=0$, which implies $\\lambda L = n\\pi$ for integer $n \\geq 1$.\nThe eigenvalues are $k_n = \\lambda_n^2 = (\\frac{n\\pi}{L})^2$, and the corresponding eigenfunctions are $X_n(x) = \\sin(\\frac{n\\pi x}{L})$ for $n=1, 2, 3, \\ldots$.\n\nThe equation for $Y(y)$ becomes:\n$$\nY''(y) - k_n Y(y) = 0 \\quad \\implies \\quad Y_n''(y) - \\left(\\frac{n\\pi}{L}\\right)^2 Y_n(y) = 0\n$$\nThe general solution for $Y_n(y)$ is a linear combination of hyperbolic functions:\n$$\nY_n(y) = C_n \\cosh\\left(\\frac{n\\pi y}{L}\\right) + D_n \\sinh\\left(\\frac{n\\pi y}{L}\\right)\n$$\nThe homogeneous boundary condition $w(x,0)=0$ implies $Y(0)=0$. Applying this to $Y_n(y)$:\n$Y_n(0) = C_n \\cosh(0) + D_n \\sinh(0) = C_n \\cdot 1 + D_n \\cdot 0 = C_n = 0$.\nSo, the solution for $Y_n(y)$ must be of the form $Y_n(y) = D_n \\sinh(\\frac{n\\pi y}{L})$.\n\nThe general solution $w(x,y)$ is a superposition of all possible product solutions:\n$$\nw(x,y) = \\sum_{n=1}^{\\infty} A_n X_n(x) Y_n(y) = \\sum_{n=1}^{\\infty} B_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sinh\\left(\\frac{n\\pi y}{L}\\right)\n$$\nwhere $B_n$ are the new combined constants. We determine these constants using the final, non-homogeneous boundary condition at $y=H$:\n$$\nw(x,H) = \\sum_{n=1}^{\\infty} B_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sinh\\left(\\frac{n\\pi H}{L}\\right) = V_{0}\\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\nThis is a Fourier sine series representation. By comparing the terms on the left and right sides, we can equate coefficients. The right side contains only a single term corresponding to $n=1$. Therefore, all coefficients for $n1$ must be zero. For $n=1$:\n$$\nB_1 \\sinh\\left(\\frac{\\pi H}{L}\\right) = V_0 \\quad \\implies \\quad B_1 = \\frac{V_0}{\\sinh\\left(\\frac{\\pi H}{L}\\right)}\n$$\nFor $n1$, $B_n \\sinh(\\frac{n\\pi H}{L}) = 0$, which implies $B_n=0$ since $\\sinh(z) \\neq 0$ for $z \\neq 0$.\nThe final solution is therefore comprised of only the $n=1$ term:\n$$\nw(x,y) = B_1 \\sin\\left(\\frac{\\pi x}{L}\\right) \\sinh\\left(\\frac{\\pi y}{L}\\right) = \\frac{V_0}{\\sinh\\left(\\frac{\\pi H}{L}\\right)} \\sin\\left(\\frac{\\pi x}{L}\\right) \\sinh\\left(\\frac{\\pi y}{L}\\right)\n$$\n\n### Advantage and Limitation of the Smoothing Approach\n\nThe derived governing equation is Laplace's equation, and its solutions are harmonic functions. This property is central to understanding the method's behavior.\n\n**Advantage**: Guarantee of mesh quality preservation for moderate deformations. A fundamental property of non-constant harmonic functions is the **maximum principle**, which states that the function's maximum and minimum values are attained exclusively on the boundary of the domain. In this problem, the mesh velocity $w(x,y)$ is bounded by the extrema of the boundary data, which are $0$ and $V_0$. The principle guarantees that no new extrema (i.e., no overshoots or undershoots in mesh velocity) are created inside the domain $\\Omega$. This ensures a smooth interpolation of the boundary motion, preventing the formation of spurious oscillations or velocity spikes that could lead to cell inversion or high skewness. This inherent smoothness is a direct consequence of minimizing the Dirichlet energy, which penalizes large gradients in the velocity field, thus preventing mesh tangling under sufficiently small boundary deformations.\n\n**Limitation**: Global propagation of local boundary motion. The governing PDE is elliptic, which means the value of the solution $w$ at any interior point $(x,y)$ depends on the boundary data along the *entire* boundary $\\partial\\Omega$. This global dependence is a significant limitation in large-deformation flow problems. If a boundary deformation is highly localized (e.g., the deflection of a small flap on a large wing), the Laplacian smoother will propagate the influence of this motion throughout the entire mesh. Consequently, mesh nodes far from the moving boundary will be displaced, leading to unnecessary and often detrimental cell distortion (e.g., stretching or shearing) in regions that should ideally remain undisturbed. This lack of a mechanism to confine mesh deformation to the vicinity of the moving boundary makes the method inefficient and potentially harmful to mesh quality in the far-field for large, localized boundary movements.\n\nThe final requested answer is the closed-form expression for $w(x,y)$.\n$$\nw(x,y) = V_0 \\frac{\\sinh\\left(\\frac{\\pi y}{L}\\right)}{\\sinh\\left(\\frac{\\pi H}{L}\\right)} \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$",
            "answer": "$$\n\\boxed{V_{0} \\frac{\\sinh\\left(\\frac{\\pi y}{L}\\right)}{\\sinh\\left(\\frac{\\pi H}{L}\\right)} \\sin\\left(\\frac{\\pi x}{L}\\right)}\n$$"
        },
        {
            "introduction": "Once the mesh is in motion, a critical numerical constraint known as the Geometric Conservation Law (GCL) must be satisfied to prevent the creation of artificial sources or sinks of conserved quantities. This practice explores how to verify that a numerical scheme is GCL-compliant using the Method of Manufactured Solutions (MMS), a powerful technique for code verification. By testing whether the scheme can exactly preserve a trivial, uniform flow on an arbitrarily moving mesh, you will derive the precise mathematical condition that defines the discrete GCL .",
            "id": "3944054",
            "problem": "Consider a passive scalar convected by a constant, uniform velocity field in an Arbitrary Lagrangian–Eulerian (ALE) finite volume formulation. The ALE approach advances a moving control volume with a prescribed mesh (grid) velocity. You are asked to design a Method of Manufactured Solutions (MMS) verification that detects whether the discrete scheme satisfies the Geometric Conservation Law (GCL). The goal is to construct a manufactured uniform flow and a diagnostic whose vanishing certifies discrete GCL compliance, and whose nonzero value exposes a violation.\n\nAssume the following setup.\n\n- The governing equation in physical space is a conservative advection equation for a passive scalar $\\,\\phi\\,$ with constant, uniform advecting velocity $\\,\\boldsymbol{u}\\,$, posed in three spatial dimensions:\n  the scalar is transported by $\\,\\boldsymbol{u}\\,$ and the control volume may move with grid velocity $\\,\\boldsymbol{w}(\\boldsymbol{x},t)\\,$.\n- The control volume associated with a cell $\\,i\\,$ is $\\,V_i(t)\\,$ with volume $\\,|V_i(t)| \\equiv V_i(t)\\,$. Its boundary is partitioned into planar faces indexed by $\\,f\\,$, each with outward unit normal $\\,\\boldsymbol{n}_f\\,$ and area $\\,A_f\\,$. The face-normal closure property $\\,\\sum_{f} \\boldsymbol{n}_f A_f = \\boldsymbol{0}\\,$ holds identically for a closed polyhedral cell.\n- The ALE finite volume method computes face fluxes using the relative velocity $\\,\\boldsymbol{u}-\\boldsymbol{w}_f\\,$, where $\\,\\boldsymbol{w}_f\\,$ is the grid velocity projected or defined at face $\\,f\\,$.\n- The manufactured solution is the uniform field $\\,\\phi(\\boldsymbol{x},t)\\equiv \\phi_0\\,$ with constant $\\,\\phi_0\\neq 0\\,$ and a constant, uniform $\\,\\boldsymbol{u}\\,$. The mesh velocity field $\\,\\boldsymbol{w}(\\boldsymbol{x},t)\\,$ is arbitrary, smooth in space and time, and not constrained to be divergence-free or aligned with $\\,\\boldsymbol{u}\\,$.\n- No special boundary constraints are needed for the cellwise diagnostic beyond the face-normal closure property stated above.\n\nYou will use this manufactured uniform solution to verify whether the discrete scheme satisfies GCL by monitoring spurious deviations from uniformity. Select all options that correctly specify a necessary and sufficient discrete diagnostic or condition that must hold cellwise for all times and for any admissible $\\,\\boldsymbol{w}(\\boldsymbol{x},t)\\,$ if and only if the scheme is discretely GCL-compliant under the assumptions above.\n\nA. The cellwise residual\n$$\nR_i \\;\\equiv\\; \\frac{d}{dt}\\big(\\phi_0\\,V_i(t)\\big)\\;+\\;\\phi_0\\sum_{f}\\Big[\\big(\\boldsymbol{u}-\\boldsymbol{w}_f\\big)\\cdot \\boldsymbol{n}_f\\Big]\\,A_f\n$$\nmust be identically $\\,0\\,$ for all $\\,t\\,$ and any $\\,\\boldsymbol{w}\\,$; its nonzero value indicates a discrete GCL violation.\n\nB. Setting $\\,\\boldsymbol{w}=\\boldsymbol{0}\\,$ (a fixed mesh) is sufficient to verify the GCL, because any violation would still create spurious deviations in $\\,\\phi\\,$ on the fixed mesh.\n\nC. The only way for the manufactured uniform solution to remain exactly uniform in each cell for all $\\,t\\,$ and any $\\,\\boldsymbol{w}\\,$ is that the discrete volume update and face-normal grid flux satisfy, cellwise,\n$$\n\\frac{dV_i}{dt} \\;=\\; \\sum_{f}\\big(\\boldsymbol{w}_f\\cdot \\boldsymbol{n}_f\\big)\\,A_f,\n$$\nwhich is the discrete statement of the Geometric Conservation Law.\n\nD. A stricter diagnostic that must vanish for all $\\,t\\,$ and any $\\,\\boldsymbol{w}\\,$ if and only if the scheme is GCL-compliant is\n$$\n\\widetilde{R}_i \\;\\equiv\\; \\frac{d}{dt}\\big(\\phi_0\\,V_i(t)\\big)\\;+\\;\\phi_0\\sum_{f}\\big(\\boldsymbol{u}\\cdot \\boldsymbol{n}_f\\big)\\,A_f,\n$$\nwhich does not involve $\\,\\boldsymbol{w}\\,$ explicitly.\n\nE. To pass any such MMS verification for arbitrary $\\,\\boldsymbol{w}\\,$, it is necessary to impose $\\,\\nabla\\cdot \\boldsymbol{w} = 0\\,$ in each cell; otherwise, uniform solutions cannot be preserved on a moving mesh.\n\nSelect all that apply.",
            "solution": "### Derivation of the GCL Condition\n\nThe governing equation for a scalar $\\,\\phi\\,$ in an arbitrary moving control volume $\\,V(t)\\,$ is given by the Reynolds transport theorem, expressed in integral form for a conservation law:\n$$\n\\frac{d}{dt}\\int_{V(t)} \\phi \\, dV + \\int_{\\partial V(t)} \\phi (\\boldsymbol{u} - \\boldsymbol{w}) \\cdot \\boldsymbol{n} \\, dA = 0\n$$\nwhere $\\,\\boldsymbol{u}\\,$ is the fluid velocity and $\\,\\boldsymbol{w}\\,$ is the velocity of the boundary $\\,\\partial V(t)\\,$.\n\nFor a finite volume discretization, we apply this equation to a single cell $\\,i\\,$. The volume is $\\,V_i(t)\\,$, and the cell-averaged scalar is $\\,\\bar{\\phi}_i = \\frac{1}{V_i(t)}\\int_{V_i(t)} \\phi \\, dV\\,$. The semi-discrete finite volume equation is:\n$$\n\\frac{d}{dt}\\big(\\bar{\\phi}_i V_i(t)\\big) + \\sum_{f} F_f = 0\n$$\nwhere $\\,F_f\\,$ is the numerical flux through face $\\,f\\,$. Based on the problem description, the flux is computed using the relative velocity $\\,\\boldsymbol{u} - \\boldsymbol{w}_f\\,$. A standard approximation for the flux through face $\\,f\\,$ is $\\,F_f = \\phi_f (\\boldsymbol{u} - \\boldsymbol{w}_f) \\cdot \\boldsymbol{n}_f A_f\\,$, where $\\,\\phi_f\\,$ is the scalar value at the face.\n\nThe full semi-discrete equation for cell $\\,i\\,$ is:\n$$\n\\frac{d}{dt}\\big(\\bar{\\phi}_i V_i(t)\\big) + \\sum_{f} \\phi_f (\\boldsymbol{u} - \\boldsymbol{w}_f) \\cdot \\boldsymbol{n}_f A_f = 0\n$$\nNow, we apply the Method of Manufactured Solutions (MMS) with the uniform field $\\,\\phi(\\boldsymbol{x},t) \\equiv \\phi_0\\,$, where $\\,\\phi_0 \\neq 0\\,$ is a constant. For this uniform field:\n- The cell-averaged value is $\\,\\bar{\\phi}_i = \\phi_0\\,$.\n- The face value is $\\,\\phi_f = \\phi_0\\,$.\n\nSubstituting these into the semi-discrete equation gives the cell residual for the manufactured solution:\n$$\n\\frac{d}{dt}\\big(\\phi_0 V_i(t)\\big) + \\sum_{f} \\phi_0 (\\boldsymbol{u} - \\boldsymbol{w}_f) \\cdot \\boldsymbol{n}_f A_f = 0\n$$\nFor a numerical scheme to exactly preserve this uniform solution, this residual must be identically zero. As $\\,\\phi_0\\,$ is a constant, we can factor it out of the time derivative and the summation:\n$$\n\\phi_0 \\frac{d V_i(t)}{dt} + \\phi_0 \\sum_{f} (\\boldsymbol{u} - \\boldsymbol{w}_f) \\cdot \\boldsymbol{n}_f A_f = 0\n$$\nLet's expand the summation term:\n$$\n\\sum_{f} (\\boldsymbol{u} - \\boldsymbol{w}_f) \\cdot \\boldsymbol{n}_f A_f = \\sum_{f} (\\boldsymbol{u} \\cdot \\boldsymbol{n}_f) A_f - \\sum_{f} (\\boldsymbol{w}_f \\cdot \\boldsymbol{n}_f) A_f\n$$\nSince the advecting velocity $\\,\\boldsymbol{u}\\,$ is constant and uniform, it can be factored out of the first sum:\n$$\n\\sum_{f} (\\boldsymbol{u} \\cdot \\boldsymbol{n}_f) A_f = \\boldsymbol{u} \\cdot \\left(\\sum_{f} \\boldsymbol{n}_f A_f\\right)\n$$\nUsing the provided geometric closure property, $\\,\\sum_{f} \\boldsymbol{n}_f A_f = \\boldsymbol{0}\\,$, this term vanishes:\n$$\n\\boldsymbol{u} \\cdot \\left(\\sum_{f} \\boldsymbol{n}_f A_f\\right) = \\boldsymbol{u} \\cdot \\boldsymbol{0} = 0\n$$\nTherefore, the residual equation simplifies to:\n$$\n\\phi_0 \\frac{d V_i(t)}{dt} + \\phi_0 \\left( - \\sum_{f} (\\boldsymbol{w}_f \\cdot \\boldsymbol{n}_f) A_f \\right) = 0\n$$\n$$\n\\phi_0 \\left( \\frac{d V_i(t)}{dt} - \\sum_{f} (\\boldsymbol{w}_f \\cdot \\boldsymbol{n}_f) A_f \\right) = 0\n$$\nSince $\\,\\phi_0 \\neq 0\\,$, for this equation to hold for any arbitrary mesh motion $\\,\\boldsymbol{w}(\\boldsymbol{x},t)\\,$, the term in the parentheses must be zero. This gives the necessary and sufficient condition:\n$$\n\\frac{d V_i(t)}{dt} = \\sum_{f} (\\boldsymbol{w}_f \\cdot \\boldsymbol{n}_f) A_f\n$$\nThis is the discrete form of the **Geometric Conservation Law (GCL)**. It mandates that the rate of change of a cell's volume, as computed by the time integration scheme, must be exactly equal to the sum of the fluxes of the grid velocity through the cell's faces. A scheme that satisfies this identity is called GCL-compliant. Failure to satisfy the GCL leads to the creation of spurious mass when using a uniform density field, which is why this MMS test is effective.\n\n### Option-by-Option Analysis\n\n**A. The cellwise residual $$R_i \\;\\equiv\\; \\frac{d}{dt}\\big(\\phi_0\\,V_i(t)\\big)\\;+\\;\\phi_0\\sum_{f}\\Big[\\big(\\boldsymbol{u}-\\boldsymbol{w}_f\\big)\\cdot \\boldsymbol{n}_f\\Big]\\,A_f$$ must be identically $\\,0\\,$ for all $\\,t\\,$ and any $\\,\\boldsymbol{w}\\,$; its nonzero value indicates a discrete GCL violation.**\n\nThis expression for $\\,R_i\\,$ is precisely the left-hand side of the semi-discrete equation for the manufactured solution $\\,\\phi_0\\,$, before setting it to zero. As shown in the derivation:\n$$\nR_i = \\phi_0 \\left( \\frac{d V_i(t)}{dt} - \\sum_{f} (\\boldsymbol{w}_f \\cdot \\boldsymbol{n}_f) A_f \\right)\n$$\nThe condition $\\,R_i = 0\\,$ is, since $\\,\\phi_0 \\neq 0\\,$, mathematically equivalent to the GCL: $\\,\\frac{d V_i}{dt} = \\sum_{f}(\\boldsymbol{w}_f\\cdot \\boldsymbol{n}_f)A_f\\,$. Therefore, the vanishing of this residual $\\,R_i\\,$ for any admissible mesh motion $\\,\\boldsymbol{w}\\,$ is a necessary and sufficient diagnostic to confirm that the scheme is GCL-compliant. A non-zero $\\,R_i\\,$ directly measures the GCL violation.\n\n**Verdict: Correct**\n\n**B. Setting $\\,\\boldsymbol{w}=\\boldsymbol{0}\\,$ (a fixed mesh) is sufficient to verify the GCL, because any violation would still create spurious deviations in $\\,\\phi\\,$ on the fixed mesh.**\n\nIf $\\,\\boldsymbol{w}=\\boldsymbol{0}\\,$, then $\\,\\boldsymbol{w}_f = \\boldsymbol{0}\\,$ for all faces. The GCL equation becomes:\n$$\n\\frac{d V_i}{dt} = \\sum_{f} (\\boldsymbol{0} \\cdot \\boldsymbol{n}_f) A_f = 0\n$$\nThis requires $\\,dV_i/dt = 0\\,$, meaning the cell volume is constant. This is trivially true for a fixed mesh. Therefore, running a simulation on a fixed mesh provides no information about the components of the numerical scheme responsible for handling mesh motion and ensuring GCL is satisfied. The GCL is a constraint that is non-trivial only for moving/deforming meshes ($\\boldsymbol{w} \\neq \\boldsymbol{0}$).\n\n**Verdict: Incorrect**\n\n**C. The only way for the manufactured uniform solution to remain exactly uniform in each cell for all $\\,t\\,$ and any $\\,\\boldsymbol{w}\\,$ is that the discrete volume update and face-normal grid flux satisfy, cellwise, $$ \\frac{dV_i}{dt} \\;=\\; \\sum_{f}\\big(\\boldsymbol{w}_f\\cdot \\boldsymbol{n}_f\\big)\\,A_f, $$ which is the discrete statement of the Geometric Conservation Law.**\n\nAs demonstrated in the derivation, the requirement that the discrete governing equation be exactly satisfied for the uniform solution $\\,\\phi_0 \\neq 0\\,$ leads directly to the condition $\\,\\frac{d V_i}{dt} = \\sum_{f}(\\boldsymbol{w}_f\\cdot \\boldsymbol{n}_f)A_f\\,$. This condition is both necessary (if the solution is preserved, GCL must hold) and sufficient (if GCL holds, the residual for the uniform solution is zero, so it is preserved). The statement accurately describes this fundamental relationship.\n\n**Verdict: Correct**\n\n**D. A stricter diagnostic that must vanish for all $\\,t\\,$ and any $\\,\\boldsymbol{w}\\,$ if and only if the scheme is GCL-compliant is $$ \\widetilde{R}_i \\;\\equiv\\; \\frac{d}{dt}\\big(\\phi_0\\,V_i(t)\\big)\\;+\\;\\phi_0\\sum_{f}\\big(\\boldsymbol{u}\\cdot \\boldsymbol{n}_f\\big)\\,A_f, $$ which does not involve $\\,\\boldsymbol{w}\\,$ explicitly.**\n\nLet's analyze this proposed diagnostic $\\,\\widetilde{R}_i\\,$.\n$$\n\\widetilde{R}_i = \\phi_0 \\frac{d V_i}{dt} + \\phi_0 \\sum_{f}(\\boldsymbol{u}\\cdot \\boldsymbol{n}_f)A_f\n$$\nAs shown in the main derivation, the summation term is identically zero due to the closure property $\\,\\sum_f \\boldsymbol{n}_f A_f = \\boldsymbol{0}\\,$ and the uniformity of $\\,\\boldsymbol{u}\\,$.\n$$\n\\sum_{f}(\\boldsymbol{u}\\cdot \\boldsymbol{n}_f)A_f = \\boldsymbol{u} \\cdot \\left(\\sum_f \\boldsymbol{n}_f A_f\\right) = 0\n$$\nThus, the diagnostic simplifies to $\\,\\widetilde{R}_i = \\phi_0 \\frac{d V_i}{dt}\\,$. The condition $\\,\\widetilde{R}_i = 0\\,$ would imply $\\,\\frac{d V_i}{dt} = 0\\,$. This would mean cell volumes must remain constant for any arbitrary mesh motion $\\,\\boldsymbol{w}\\,$, which is an incorrect and overly restrictive condition. Mesh cells are explicitly allowed to change volume in a general ALE formulation. This diagnostic is fundamentally flawed and irrelevant to the GCL.\n\n**Verdict: Incorrect**\n\n**E. To pass any such MMS verification for arbitrary $\\,\\boldsymbol{w}\\,$, it is necessary to impose $\\,\\nabla\\cdot \\boldsymbol{w} = 0\\,$ in each cell; otherwise, uniform solutions cannot be preserved on a moving mesh.**\n\nThis statement reverses the logic. The GCL is the specific numerical condition required to correctly handle arbitrary mesh motion, including non-volume-preserving motion where $\\,\\nabla \\cdot \\boldsymbol{w} \\neq 0\\,$. (Note that $\\,\\frac{1}{V}\\frac{dV}{dt} = \\nabla \\cdot \\boldsymbol{w}\\,$ from Reynolds transport theorem). A GCL-compliant scheme must correctly preserve a uniform flow field for *any* smooth mesh velocity field $\\,\\boldsymbol{w}\\,$, not just for the special case of divergence-free (isochoric) mesh motion. Imposing $\\,\\nabla \\cdot \\boldsymbol{w} = 0\\,$ on the test case avoids testing the scheme's ability to handle the general case. Therefore, this is not a necessary condition for the scheme; it is an unnecessary restriction on the verification test.\n\n**Verdict: Incorrect**",
            "answer": "$$\n\\boxed{AC}\n$$"
        },
        {
            "introduction": "The primary motivation for using the complex ALE framework is to improve simulation accuracy by moving the mesh in an intelligent way, for instance, to track flow features. This exercise provides a quantitative foundation for this idea by using von Neumann stability analysis to study the numerical errors of a simple advection scheme on a moving mesh. You will derive how numerical dissipation and dispersion are directly influenced by the relative velocity between the physical flow and the moving mesh, demonstrating the tangible benefits of the ALE approach .",
            "id": "3944042",
            "problem": "Consider the one-dimensional linear advection of a passive scalar $u(x,t)$ with constant physical advection speed $a  0$ in an inertial frame, governed by the conservation law $\\partial u/\\partial t + \\partial (a u)/\\partial x = 0$. Discretize the domain using a uniform mesh that translates rigidly at a constant velocity $w$ in the $x$-direction, so that the cell size $\\Delta x$ remains constant in time. Adopt the Arbitrary Lagrangian–Eulerian (ALE) finite volume formulation, in which the semi-discrete balance for cell $i$ reads\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(u_i \\Delta x\\right) + \\left[(a - w) u\\right]_{i+\\frac{1}{2}} - \\left[(a - w) u\\right]_{i-\\frac{1}{2}} = 0,\n$$\nwhere $[\\cdot]_{i\\pm \\frac{1}{2}}$ denotes the value at the right/left cell face and the relative advective speed is $a - w$. Assume $a - w  0$. Consider two consistent numerical fluxes for the face value $u_{i+\\frac{1}{2}}$: a central (symmetric) flux defined by $u_{i+\\frac{1}{2}}^{C} = \\left(u_i + u_{i+1}\\right)/2$ and a first-order upwind flux defined by $u_{i+\\frac{1}{2}}^{U} = u_i$.\n\nPerform a spatial von Neumann analysis with exact time integration (semi-discrete-in-space analysis) by assuming a Fourier mode $u_i(t) = \\hat{u} \\exp\\!\\left(\\lambda t\\right) \\exp\\!\\left(\\mathrm{i} i \\theta\\right)$, where $\\theta \\in [0, \\pi]$ is the nondimensional wavenumber and $\\mathrm{i}$ is the imaginary unit. Derive the semi-discrete dispersion relations $\\lambda_C(\\theta,w)$ and $\\lambda_U(\\theta,w)$ for the central and upwind fluxes, respectively. Identify, in each case, the numerical dissipation rate (the nonnegative quantity $-\\Re[\\lambda]$) and the numerical phase speed in the mesh frame (defined by $c_p = -\\Im[\\lambda]/k$ with $k = \\theta/\\Delta x$), and discuss qualitatively how the mesh velocity $w$ enters these errors.\n\nFinally, provide a single closed-form analytic expression, in terms of $a$, $w$, $\\Delta x$, and $\\theta$, for the upwind numerical dissipation rate per unit time, defined as $\\sigma_{\\mathrm{up}}(\\theta,w) \\equiv -\\Re\\left[\\lambda_U(\\theta,w)\\right]$. Your final answer must be this expression only. Do not include units. Do not round.",
            "solution": "### Solution Derivation\nThe semi-discrete equation for cell $i$ is given as:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(u_i \\Delta x\\right) + \\left[(a - w) u\\right]_{i+\\frac{1}{2}} - \\left[(a - w) u\\right]_{i-\\frac{1}{2}} = 0\n$$\nSince the mesh cell size $\\Delta x$ is constant in time, we can take it out of the time derivative:\n$$\n\\Delta x \\frac{\\mathrm{d}u_i}{\\mathrm{d}t} + (a-w)u_{i+\\frac{1}{2}} - (a-w)u_{i-\\frac{1}{2}} = 0\n$$\nWe perform a von Neumann analysis by substituting the Fourier mode $u_j(t) = \\hat{u} \\exp(\\lambda t) \\exp(\\mathrm{i} j \\theta)$ for any index $j$. The time derivative is $\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = \\lambda u_i$. Substituting this into the equation gives:\n$$\n\\Delta x \\lambda u_i + (a-w)u_{i+\\frac{1}{2}} - (a-w)u_{i-\\frac{1}{2}} = 0\n$$\nThis can be rearranged to solve for the complex amplification factor $\\lambda$:\n$$\n\\lambda = -\\frac{a-w}{\\Delta x u_i} \\left( u_{i+\\frac{1}{2}} - u_{i-\\frac{1}{2}} \\right)\n$$\nWe now analyze the central and upwind schemes separately. For any cell $j$, we can write $u_j$ in terms of $u_i$ using the Fourier mode: $u_j = u_i \\exp(\\mathrm{i}(j-i)\\theta)$. Specifically, $u_{i+1} = u_i \\exp(\\mathrm{i}\\theta)$ and $u_{i-1} = u_i \\exp(-\\mathrm{i}\\theta)$.\n\n**1. Central Flux: $u_{i+\\frac{1}{2}}^{C} = \\frac{1}{2}(u_i + u_{i+1})$**\n\nThe term for the flux at the right face $i+\\frac{1}{2}$ is $u_{i+\\frac{1}{2}} = \\frac{1}{2}(u_i + u_{i+1})$. By symmetry, the flux at the left face $i-\\frac{1}{2}$ is $u_{i-\\frac{1}{2}} = \\frac{1}{2}(u_{i-1} + u_i)$.\nSubstituting these into the expression for $\\lambda$:\n$$\n\\lambda_C = -\\frac{a-w}{\\Delta x u_i} \\left[ \\frac{1}{2}(u_i + u_{i+1}) - \\frac{1}{2}(u_{i-1} + u_i) \\right]\n$$\n$$\n\\lambda_C = -\\frac{a-w}{2\\Delta x u_i} (u_{i+1} - u_{i-1})\n$$\nNow, substitute the Fourier mode relationships:\n$$\n\\lambda_C = -\\frac{a-w}{2\\Delta x u_i} \\left[ u_i \\exp(\\mathrm{i}\\theta) - u_i \\exp(-\\mathrm{i}\\theta) \\right]\n$$\n$$\n\\lambda_C = -\\frac{a-w}{2\\Delta x} \\left[ \\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta) \\right]\n$$\nUsing Euler's identity $\\sin(\\theta) = \\frac{1}{2\\mathrm{i}}(\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta))$, this simplifies to:\n$$\n\\lambda_C(\\theta,w) = -\\frac{a-w}{2\\Delta x} (2\\mathrm{i}\\sin\\theta) = -\\mathrm{i} \\frac{a-w}{\\Delta x} \\sin(\\theta)\n$$\n-   **Numerical Dissipation Rate:** $-\\Re[\\lambda_C] = -\\Re[0] = 0$. The central scheme is non-dissipative.\n-   **Numerical Phase Speed:** The imaginary part is $\\Im[\\lambda_C] = -\\frac{a-w}{\\Delta x}\\sin(\\theta)$. The physical wavenumber is $k = \\theta/\\Delta x$.\n    $$\n    c_p^C = -\\frac{\\Im[\\lambda_C]}{k} = -\\frac{-\\frac{a-w}{\\Delta x}\\sin(\\theta)}{\\theta/\\Delta x} = (a-w)\\frac{\\sin(\\theta)}{\\theta}\n    $$\n-   **Discussion of $w$:** The mesh velocity $w$ enters the phase speed calculation by modifying the effective advection speed to $a-w$. The phase error, which is the difference between the numerical phase speed $c_p^C$ and the exact phase speed in the mesh frame ($a-w$), is $(a-w)(\\frac{\\sin\\theta}{\\theta} - 1)$. This error is directly proportional to the relative speed $a-w$. The scheme is purely dispersive, and $w$ has no effect on the (zero) dissipation.\n\n**2. First-Order Upwind Flux: $u_{i+\\frac{1}{2}}^{U} = u_i$**\n\nSince the relative advection speed $a-w$ is positive, the flow is from left to right relative to the mesh. Therefore, the upwind value at face $i+\\frac{1}{2}$ is $u_i$, and the upwind value at face $i-\\frac{1}{2}$ is $u_{i-1}$.\nSubstituting these into the expression for $\\lambda$:\n$$\n\\lambda_U = -\\frac{a-w}{\\Delta x u_i} \\left[ u_i - u_{i-1} \\right]\n$$\nNow, substitute the Fourier mode relationship for $u_{i-1}$:\n$$\n\\lambda_U = -\\frac{a-w}{\\Delta x u_i} \\left[ u_i - u_i \\exp(-\\mathrm{i}\\theta) \\right]\n$$\n$$\n\\lambda_U = -\\frac{a-w}{\\Delta x} \\left[ 1 - \\exp(-\\mathrm{i}\\theta) \\right]\n$$\nUsing Euler's identity $\\exp(-\\mathrm{i}\\theta) = \\cos(\\theta) - \\mathrm{i}\\sin(\\theta)$:\n$$\n\\lambda_U = -\\frac{a-w}{\\Delta x} \\left[ 1 - (\\cos\\theta - \\mathrm{i}\\sin\\theta) \\right]\n$$\n$$\n\\lambda_U(\\theta,w) = -\\frac{a-w}{\\Delta x}(1 - \\cos\\theta) - \\mathrm{i}\\frac{a-w}{\\Delta x}\\sin\\theta\n$$\n-   **Numerical Dissipation Rate:** This is the quantity $\\sigma_{\\mathrm{up}}(\\theta,w)$.\n    $$\n    \\sigma_{\\mathrm{up}}(\\theta,w) = -\\Re[\\lambda_U] = -\\left[-\\frac{a-w}{\\Delta x}(1 - \\cos\\theta)\\right] = \\frac{a-w}{\\Delta x}(1 - \\cos\\theta)\n    $$\n    Since $a-w  0$ and $1-\\cos\\theta \\geq 0$ for all $\\theta$, the dissipation rate is non-negative, indicating the scheme is stable. This is the expression required for the final answer.\n-   **Numerical Phase Speed:** The imaginary part is $\\Im[\\lambda_U] = -\\frac{a-w}{\\Delta x}\\sin(\\theta)$.\n    $$\n    c_p^U = -\\frac{\\Im[\\lambda_U]}{k} = -\\frac{-\\frac{a-w}{\\Delta x}\\sin(\\theta)}{\\theta/\\Delta x} = (a-w)\\frac{\\sin(\\theta)}{\\theta}\n    $$\n    The numerical phase speed for the upwind scheme is identical to that of the central scheme.\n-   **Discussion of $w$:** The mesh velocity $w$ affects both the numerical dissipation and the phase error. Both errors are proportional to the relative speed $a-w$. Specifically, the dissipation rate is $\\sigma_{\\mathrm{up}} \\propto (a-w)$ and the phase error is $(a-w)(\\frac{\\sin\\theta}{\\theta} - 1) \\propto (a-w)$. This means that if the mesh moves with the flow (i.e., $w \\to a$), the relative speed tends to zero, and both numerical dissipation and phase error vanish. This is the main advantage of an ALE (or Lagrangian) approach: by moving the mesh to track features of the flow, numerical errors can be significantly reduced.\n\nThe problem asks for a single closed-form analytic expression for the upwind numerical dissipation rate per unit time, $\\sigma_{\\mathrm{up}}(\\theta,w) \\equiv -\\Re\\left[\\lambda_U(\\theta,w)\\right]$. Based on the derivation above, this expression is:\n$$\n\\sigma_{\\mathrm{up}}(\\theta,w) = \\frac{a-w}{\\Delta x}(1 - \\cos\\theta)\n$$",
            "answer": "$$\n\\boxed{\\frac{a - w}{\\Delta x} (1 - \\cos(\\theta))}\n$$"
        }
    ]
}