{
    "hands_on_practices": [
        {
            "introduction": "低马赫数预处理的核心目标是重新调整系统特征值，以消除声学波和对流波速度之间的巨大差异所带来的刚性问题。本练习将引导您从第一性原理出发，通过施加稳态不变性、高马赫数一致性和低马赫数均衡化等基本约束，推导出许多预处理方法所依赖的基础缩放函数 。这项实践阐明了预处理器为何采用其特定的数学形式，从而加深您对该技术本质的理解。",
            "id": "3974443",
            "problem": "考虑一维可压缩理想气体的守恒形式欧拉方程，该方程是计算流体动力学（CFD）中无粘流分析的基础：\n$$\n\\frac{\\partial \\boldsymbol{Q}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0},\n$$\n其中 $\\boldsymbol{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}$，$\\boldsymbol{F}(\\boldsymbol{Q}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(\\rho E + p) \\end{pmatrix}$，状态方程为 $p = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^{2}\\right)$。声速为 $a = \\sqrt{\\gamma p / \\rho}$，马赫数为 $M = |u|/a$。低马赫数预处理通过用一个预处理后的伪时间导数替换物理时间导数，来修改用于稳态计算的伪时间演化：\n$$\n\\boldsymbol{\\Gamma}^{-1}(M)\\,\\frac{\\partial \\boldsymbol{Q}}{\\partial \\tau} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0},\n$$\n其中 $\\boldsymbol{\\Gamma}(M)$ 是一个对称正定矩阵，它依赖于局部马赫数 $M$，并且仅作用于伪时间导数。\n\n从欧拉方程和理想气体定律出发，在一个均匀基态 $(\\rho_{0}, u_{0}, p_{0})$（其中 $M \\in (0,1]$）附近进行线性化。假设一个标量低马赫数预处理，它能有效地重新标度连续性-压力耦合中的可压缩性，使得在线性化、预处理后的系统中，伪声速变为 $\\sqrt{\\alpha(M)}\\,a$（其中 $\\alpha(M)$ 是某个光滑的标量函数），而空间通量雅可比矩阵保持不变。施加以下要求：\n1. 稳态不变性：预处理伪时间系统的稳态解集必须与原始欧拉方程的稳态解集一致。\n2. 低马赫数均等化：在极限 $M \\to 0$ 时，控制伪时间推进的最大特征速度的量级必须与 $\\mathcal{O}(|u_{0}|)$ 同阶（而不是 $\\mathcal{O}(a)$）。\n3. 高马赫数一致性：当 $M \\to 1$ 时，预处理系统必须恢复原始的声学标度。\n\n在这些约束条件下，推导出一个满足所有三个条件的、关于马赫数 $M$ 的 $\\alpha(M)$ 的闭式解析表达式，并将该表达式作为您的最终答案。最终答案必须是单个解析表达式。无需四舍五入，答案是无量纲的。",
            "solution": "用户希望为一维欧拉方程的低马赫数预处理方案中使用的标量函数 $\\alpha(M)$ 推导出一个闭式解析表达式。函数 $\\alpha(M)$ 必须满足三个特定要求。\n\n出发点是用于低马赫数计算的、在伪时间下预处理的一维可压缩欧拉方程：\n$$ \\boldsymbol{\\Gamma}^{-1}(M)\\,\\frac{\\partial \\boldsymbol{Q}}{\\partial \\tau} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0} $$\n在这里，$\\boldsymbol{Q}$ 是守恒变量向量，$\\boldsymbol{F}(\\boldsymbol{Q})$ 是通量向量，$\\tau$ 是伪时间，$\\boldsymbol{\\Gamma}(M)$ 是预处理矩阵。对于稳态计算，系统在伪时间中演化，直到项 $\\partial \\boldsymbol{Q} / \\partial \\tau$ 消失。\n\n这个双曲系统的特征速度控制着信息在伪时间域 $(\\tau, x)$ 中的传播。这些速度用 $\\lambda'_p$ 表示，是矩阵乘积 $\\boldsymbol{\\Gamma}(M)\\boldsymbol{A}(\\boldsymbol{Q})$ 的特征值，其中 $\\boldsymbol{A} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{Q}}$ 是原始欧拉方程的通量雅可比矩阵。\n\n未预处理的通量雅可比矩阵 $\\boldsymbol{A}$ 的特征值是众所周知的 $\\{u, u+a, u-a\\}$，其中 $u$ 是流体速度，$a$ 是声速。这些对应一个对流波（熵和涡量）和两个声波。\n\n问题陈述指出，预处理方案的设计使得“伪声速变为 $\\sqrt{\\alpha(M)}a$”。在特征分析的背景下，声速是声波相对于移动流体的传播速度，在原始系统中为 $\\pm a$。对问题陈述最直接的解释是，预处理系统将这些相对速度修改为 $\\pm \\sqrt{\\alpha(M)}a$。假设对流速度 $u$ 仍然是声波的参考速度，则预处理系统矩阵 $\\boldsymbol{\\Gamma A}$ 的特征值为：\n$$ \\{\\lambda'_{p}\\} = \\{ u, u + \\sqrt{\\alpha(M)}a, u - \\sqrt{\\alpha(M)}a \\} $$\n我们现在将使用给定的三个要求来确定 $\\alpha(M)$ 的形式。\n\n1.  **稳态不变性：** 第一个要求是预处理系统的稳态解必须与原始欧拉方程的稳态解相同。在稳态时，伪时间导数项为零：$\\frac{\\partial \\boldsymbol{Q}}{\\partial \\tau} = \\boldsymbol{0}$。预处理系统简化为 $\\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0}$。这与原始欧拉方程的稳态形式完全相同。只要预处理矩阵 $\\boldsymbol{\\Gamma}(M)$ 是可逆的（题目已给出其为正定矩阵，故可逆性得到保证），该条件就由预处理系统的结构所满足。因此，这个要求没有对函数 $\\alpha(M)$ 施加进一步的约束。\n\n2.  **低马赫数均等化：** 第二个要求规定了系统在低马赫数极限 $M \\to 0$ 下的行为。它指出，最大特征速度的量级 $\\max_p |\\lambda'_p|$ 必须与 $\\mathcal{O}(|u_0|)$ 同阶。这是低马赫数预处理的核心：其目的在于重新标度差异巨大的特征速度（$|u|$ 和 $|u \\pm a|$），使其量级相同，从而消除由大比率 $a/|u| = 1/M$ 引起的刚性问题。\n\n    预处理后特征值的量级为 $|u|$ 和 $|u \\pm \\sqrt{\\alpha(M)}a|$。其中最大的通常是 $|u| + \\sqrt{\\alpha(M)}a$。\n    我们要求当 $M \\to 0$ 时，这个最大量级与 $|u|$ 同阶：\n    $$ |u| + \\sqrt{\\alpha(M)}a = \\mathcal{O}(|u|) $$\n    由于 $|u|$ 本身就与 $\\mathcal{O}(|u|)$ 同阶，该条件对第二项施加了一个约束：\n    $$ \\sqrt{\\alpha(M)}a = \\mathcal{O}(|u|) $$\n    除以声速 $a$（在基态中为一个有限的非零常数），我们得到：\n    $$ \\sqrt{\\alpha(M)} = \\mathcal{O}\\left(\\frac{|u|}{a}\\right) = \\mathcal{O}(M) $$\n    这意味着对于小的 $M$，函数 $\\alpha(M)$ 必须具有渐近行为 $\\alpha(M) \\sim k M^2$，其中 $k$ 是某个量级为 1 的无量纲常数。\n\n3.  **高马赫数一致性：** 第三个要求是当马赫数接近 1 ($M \\to 1$) 时，预处理系统必须恢复原始的声学标度。这意味着预处理系统的特征速度必须趋近于原始欧拉方程的特征速度。\n    $$ u \\pm \\sqrt{\\alpha(M)}a \\to u \\pm a \\quad \\text{as } M \\to 1 $$\n    这意味着当 $M \\to 1$ 时，$\\sqrt{\\alpha(M)} \\to 1$，从而得出条件：\n    $$ \\alpha(M) \\to 1 \\quad \\text{as } M \\to 1 $$\n\n最后，我们必须合成一个单一、光滑的闭式解析表达式 $\\alpha(M)$，使其在 $M \\in (0, 1]$ 上满足推导出的条件：\n- 来自要求 2 的条件：当 $M \\to 0$ 时，$\\alpha(M) \\sim k M^2$。\n- 来自要求 3 的条件：$\\alpha(1) = 1$。\n\n让我们寻找满足这些约束的最简单的解析函数。与低马赫数标度一致的一个简单选择是幂律形式 $\\alpha(M) = C M^n$。根据低马赫数条件，指数必须为 $n=2$，因此形式为 $\\alpha(M) = C M^2$。现在，在 $M=1$ 处应用高马赫数条件：\n$$ \\alpha(1) = C \\cdot (1)^2 = C $$\n根据要求 $\\alpha(1)=1$，我们发现常数 $C$ 必须为 $1$。\n这导出了唯一的简单解：\n$$ \\alpha(M) = M^2 $$\n该函数对于所有 $M$ 都是解析的，因此是光滑的。它通过将伪声速设置为 $u \\pm Ma = u \\pm |u|$ 来满足低马赫数要求，确保所有特征速度的量级都与 $|u|$ 同阶。它也满足高马赫数一致性要求，因为当 $M=1$ 时，$\\alpha(1)=1^2=1$，正确恢复了原始的声速。",
            "answer": "$$\\boxed{M^{2}}$$"
        },
        {
            "introduction": "我们已经了解了如何从基本原则推导出预处理缩放因子，但它究竟有多大效果？本练习旨在量化预处理带来的性能提升。您将计算两个关键指标：谱条件数（衡量系统数值刚性）和最大稳定时间步长比（直接关系到计算效率的提升） 。通过这个练习，您将把特征值的理论调整与求解器效率的实际增益直接联系起来。",
            "id": "3974411",
            "problem": "考虑在一维、无量纲化的可压缩欧拉方程组，其围绕一个马赫数为 $M>0$、参考声速标度为 $a=1$、基流速度为 $u=M$ 的均匀基流进行线性化。该线性化系统可以写成拟线性形式 $\\partial_t \\mathbf{q} + \\mathbf{A} \\, \\partial_x \\mathbf{q} = 0$，其中 $\\mathbf{A}$ 是通量雅可比矩阵。特征速度（$\\mathbf{A}$ 的特征值）为 $u$、$u+a$ 和 $u-a$。在一个使用伪时间推进的基于密度的定常求解器中，一个左预处理矩阵 $\\mathbf{P}$ 被应用于时间导数项以缓解低马赫数刚性，从而得到预处理后的伪时间系统 $\\mathbf{P}\\,\\partial_t \\mathbf{q} + \\mathbf{A} \\, \\partial_x \\mathbf{q} = 0$，或者等价地写为 $\\partial_t \\mathbf{q} + \\mathbf{A}_p \\,\\partial_x \\mathbf{q}=0$，其中 $\\mathbf{A}_p = \\mathbf{P}^{-1}\\mathbf{A}$。假设预处理器的设计旨在保持对流模态不变，同时缩放声学模态，使得修正后的声速为 $\\tilde{a}=\\sqrt{\\beta}\\,M$，其中参数 $\\beta$ 满足 $0 < \\beta < 1$。\n\n仅使用上述物理设置和一维欧拉特征的标准性质，从第一性原理推导：\n\n- 预处理后的雅可比矩阵 $\\mathbf{A}_p$ 的谱条件数 $\\kappa$，定义为 $\\mathbf{A}_p$ 的特征速度中严格为正的模的最大值与最小值之比。\n- 在两种情况下均一致使用固定的 Courant-Friedrichs-Lewy (CFL) 数 $\\text{CFL}_0$ 和间距为 $\\Delta x$ 的均匀网格的假设下，预处理伪时间系统相对于未预处理物理时间系统，在使用前向欧拉法时的最大稳定显式时间步长之比 $R$。使用标准显式稳定性边界 $\\Delta t_{\\max} = \\text{CFL}_0 \\, \\Delta x / \\lambda_{\\max}$，其中 $\\lambda_{\\max}$ 是特征速度的最大模。\n\n将您的最终答案表示为一个包含两个闭式表达式 $(\\kappa, R)$ 的单行矩阵，表达式以 $M$ 和 $\\beta$ 表示。所有变量都是无量纲的，因此不需要物理单位。不要代入数值。不要四舍五入；请提供精确的符号表达式。",
            "solution": "问题要求推导与一维可压缩欧拉方程预处理相关的两个量：预处理雅可比矩阵 $\\mathbf{A}_p$ 的谱条件数 $\\kappa$，以及预处理系统和未预处理系统的最大稳定显式时间步长之比 $R$。推导将从系统的给定性质出发。\n\n首先，我们确定未预处理系统和预处理系统的特征速度（特征值）。\n\n未预处理系统由 $\\partial_t \\mathbf{q} + \\mathbf{A} \\, \\partial_x \\mathbf{q} = 0$ 给出。问题陈述，基流速度为 $u=M$，参考声速为 $a=1$，其中 $M>0$ 是马赫数。特征速度，即通量雅可比矩阵 $\\mathbf{A}$ 的特征值，为 $\\{u, u+a, u-a\\}$。代入给定值，未预处理系统的特征值集合，记为 $\\Lambda$，是：\n$$\n\\Lambda = \\{ M, M+1, M-1 \\}\n$$\n\n预处理系统为 $\\partial_t \\mathbf{q} + \\mathbf{A}_p \\,\\partial_x \\mathbf{q}=0$，其中 $\\mathbf{A}_p = \\mathbf{P}^{-1}\\mathbf{A}$。问题指明了预处理器 $\\mathbf{P}$ 如何改变特征值。令 $\\mathbf{A}_p$ 的特征值记为 $\\Lambda_p$。\n1.  对流模态保持不变。原始系统中对应于对流模态的特征值是 $u=M$。因此，$\\mathbf{A}_p$ 的一个特征值是 $M$。\n2.  声学模态被缩放，使得修正后的声速为 $\\tilde{a} = \\sqrt{\\beta}\\,M$，其中 $0 < \\beta < 1$。原始声学模态对应的特征值为 $u \\pm a$。因此，预处理后的声学特征值为 $u \\pm \\tilde{a}$。代入 $u=M$ 和 $\\tilde{a}$，我们得到 $M \\pm \\sqrt{\\beta}\\,M$。\n\n所以，预处理系统的特征值集合 $\\Lambda_p$ 是：\n$$\n\\Lambda_p = \\{ M, M + \\sqrt{\\beta}\\,M, M - \\sqrt{\\beta}\\,M \\} = \\{ M, M(1+\\sqrt{\\beta}), M(1-\\sqrt{\\beta}) \\}\n$$\n\n现在我们可以开始推导所需的两个量。\n\n1.  **谱条件数 $\\kappa$ 的推导**\n\n预处理雅可比矩阵 $\\mathbf{A}_p$ 的谱条件数 $\\kappa$ 定义为其特征速度中严格为正的模的最大值与最小值之比。\n$$\n\\kappa = \\frac{\\max(|\\lambda_p| \\text{ for } \\lambda_p \\in \\Lambda_p)}{\\min(|\\lambda_p| > 0 \\text{ for } \\lambda_p \\in \\Lambda_p)}\n$$\n我们需要求出 $\\Lambda_p$ 中特征值的模。由于 $M > 0$ 且 $0 < \\beta < 1$，我们有 $0 < \\sqrt{\\beta} < 1$。\n这意味着：\n- $|\\lambda_{p,1}| = |M| = M$\n- $|\\lambda_{p,2}| = |M(1+\\sqrt{\\beta})| = M(1+\\sqrt{\\beta})$，因为 $1+\\sqrt{\\beta} > 0$。\n- $|\\lambda_{p,3}| = |M(1-\\sqrt{\\beta})| = M(1-\\sqrt{\\beta})$，因为 $1-\\sqrt{\\beta} > 0$。\n\n所有特征值都是严格为正的。现在我们求这些模的最大值和最小值。\n让我们比较这三个值：$M$、$M(1+\\sqrt{\\beta})$ 和 $M(1-\\sqrt{\\beta})$。\n由于 $\\sqrt{\\beta} > 0$，我们有 $M\\sqrt{\\beta} > 0$。\n- $M(1+\\sqrt{\\beta}) = M + M\\sqrt{\\beta} > M$。\n- $M(1-\\sqrt{\\beta}) = M - M\\sqrt{\\beta} < M$。\n因此，最大和最小模的特征值是：\n$$\n\\max(|\\lambda_p|) = M(1+\\sqrt{\\beta})\n$$\n$$\n\\min(|\\lambda_p|) = M(1-\\sqrt{\\beta})\n$$\n将这些代入 $\\kappa$ 的定义中：\n$$\n\\kappa = \\frac{M(1+\\sqrt{\\beta})}{M(1-\\sqrt{\\beta})} = \\frac{1+\\sqrt{\\beta}}{1-\\sqrt{\\beta}}\n$$\n\n2.  **时间步长比 $R$ 的推导**\n\n比率 $R$ 定义为 $R = \\frac{\\Delta t_{\\text{max, precond}}}{\\Delta t_{\\text{max, unprecond}}}$。显式方法的最大稳定时间步长由 CFL 条件给出：$\\Delta t_{\\max} = \\text{CFL}_0 \\, \\Delta x / \\lambda_{\\max}$，其中 $\\lambda_{\\max}$ 是系统特征速度的最大模。对于两个系统，$\\text{CFL}_0$ 和 $\\Delta x$ 这两项是常数。\n因此，比率 $R$ 可以写成：\n$$\nR = \\frac{\\frac{\\text{CFL}_0 \\, \\Delta x}{\\lambda_{\\max, \\text{precond}}}}{\\frac{\\text{CFL}_0 \\, \\Delta x}{\\lambda_{\\max, \\text{unprecond}}}} = \\frac{\\lambda_{\\max, \\text{unprecond}}}{\\lambda_{\\max, \\text{precond}}}\n$$\n\n首先，我们求未预处理系统的最大特征值模 $\\lambda_{\\max, \\text{unprecond}}$。特征值为 $\\{M, M+1, M-1\\}$。它们的模为 $\\{|M|, |M+1|, |M-1|\\}$。由于 $M>0$，我们有 $|M|=M$ 和 $|M+1|=M+1$。\n- 如果 $0 < M < 1$，则模为 $\\{M, M+1, 1-M\\}$。比较它们，$M+1>M$ 且 $M+1 > 1-M$ (因为 $2M>0$)。所以，$\\lambda_{\\max, \\text{unprecond}} = M+1$。\n- 如果 $M \\ge 1$，则模为 $\\{M, M+1, M-1\\}$。显然，$\\lambda_{\\max, \\text{unprecond}} = M+1$。\n在所有 $M>0$ 的情况下，最大特征值模为：\n$$\n\\lambda_{\\max, \\text{unprecond}} = M+1\n$$\n\n接下来，我们求预处理系统的最大特征值模 $\\lambda_{\\max, \\text{precond}}$。如在推导 $\\kappa$ 时所确定的，特征值为 $\\{M, M(1+\\sqrt{\\beta}), M(1-\\sqrt{\\beta})\\}$，并且由于它们都为正，其模与值本身相同。其中最大的是：\n$$\n\\lambda_{\\max, \\text{precond}} = M(1+\\sqrt{\\beta})\n$$\n\n最后，我们计算比率 $R$：\n$$\nR = \\frac{\\lambda_{\\max, \\text{unprecond}}}{\\lambda_{\\max, \\text{precond}}} = \\frac{M+1}{M(1+\\sqrt{\\beta})}\n$$\n\n推导出的两个量是 $\\kappa = \\frac{1+\\sqrt{\\beta}}{1-\\sqrt{\\beta}}$ 和 $R = \\frac{M+1}{M(1+\\sqrt{\\beta})}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1+\\sqrt{\\beta}}{1-\\sqrt{\\beta}} & \\frac{M+1}{M(1+\\sqrt{\\beta})} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理论必须与实践相结合。本练习将引导您实现一个著名且广泛使用的预处理方法——Weiss-Smith 模型。您需要为从极低马赫数到超声速等一系列假设的流动场景计算修正后的特征波速 。这项实践旨在将抽象的理论概念转化为具体的计算实现，加深您对预处理器在不同流动状态下如何工作的理解。",
            "id": "3974405",
            "problem": "考虑理想气体的一维可压缩欧拉方程，该方程针对具有恒定密度 $\\rho_{0}$、速度 $u_{0}$ 和压力 $p_{0}$ 的均匀基态，且比热比 $\\gamma > 1$。未知守恒状态向量为 $U = [\\rho, \\rho u, \\rho E]^{\\top}$，通量向量为 $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$，其中压力 $p$ 满足理想气体关系式 $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$。声速定义为 $a = \\sqrt{\\gamma p / \\rho}$，马赫数定义为 $M = |u|/a$。在计算流体动力学 (CFD) 中，对于低马赫数流动，由于对流波速和声波波速之间的巨大差异，显式格式会遇到刚性问题。低马赫数预处理通过修改系统的时间行为来缓解刚性问题，同时保持其双曲特性。在 Weiss–Smith 预处理中，通过缩放热力学压力的时间导数来调整声波波速，同时在高马赫数区域与原始系统保持一致。\n\n从在 $(\\rho_{0}, u_{0}, p_{0})$ 附近线性化的可压缩欧拉方程出发，考虑形式为 $P\\,\\partial U/\\partial t + \\partial F(U)/\\partial x = 0$ 的预处理系统，其中 $P$ 是一个常对称正定矩阵，它通过在原始变量表示中选择性地缩放压力时间导数来实现 Weiss–Smith 预处理。假设理想气体封闭关系和均匀基态。所求的特征速度是预处理算子的特征值，即那些存在非平凡平面波解 $U'(x,t) = \\hat{U}\\,\\exp\\left(i(kx - \\omega t)\\right)$ 的值 $c$，这导致了广义特征值问题 $(A - c P)\\hat{U} = 0$，其中 $A = \\partial F/\\partial U$ 在基态下求值，且 $c = \\omega/k$。\n\n你的任务是：\n\n1. 从一维线性化欧拉方程的第一性原理以及 Weiss–Smith 预处理作为热力学压力时间导数缩放的定义出发，推导预处理算子的修正特征速度，并用基态速度 $u_{0}$、基态声速 $a_{0}$ 和一个无量纲预处理参数来表示。证明预处理后的声速在低马赫数下会降低，并在 $M \\geq 1$ 时恢复为未修正的声速。\n\n2. 定义一个截止参数 $M_{\\text{cut}} \\in (0,1)$，它为预处理效应强制施加一个下界。设无量纲缩放为 $\\beta = \\min\\left(1, \\max\\left(M^{2}, M_{\\text{cut}}^{2}\\right)\\right)$，相速修正用 $\\beta$ 和基态声速 $a_{0}$ 表示。实现推导出的表达式，以计算给定 $(\\rho, p, u, \\gamma, M_{\\text{cut}})$ 下预处理算子的特征值。\n\n3. 对于以下测试套件，计算每种情况下的三个特征速度，并生成一个单行输出，该输出按顺序拼接所有情况的特征速度。所有速度必须以 $\\mathrm{m/s}$ 为单位表示为浮点数。最终输出格式必须是单行，包含一个用方括号括起来的逗号分隔列表，其中包含按 $\\left[u - a_{\\text{tilde}}, u, u + a_{\\text{tilde}}\\right]$ 顺序排列的每个案例的所有特征值，其顺序与案例出现的顺序相同。\n\n测试套件参数集 (每个集为 $(\\rho, p, u, \\gamma, M_{\\text{cut}})$，单位 $\\rho$ 为 $\\mathrm{kg/m^{3}}$，$p$ 为 $\\mathrm{Pa}$，$u$ 为 $\\mathrm{m/s}$):\n\n- 案例 A (理想情况，极低马赫数): $(\\rho, p, u, \\gamma, M_{\\text{cut}}) = ($$1.0$$, $$100000.0$$, $$1.0$$, $$1.4$$, $$0.05$$$)$。\n- 案例 B (中等亚音速马赫数): $(\\rho, p, u, \\gamma, M_{\\text{cut}}) = ($$1.0$$, $$100000.0$$, $$100.0$$, $$1.4$$, $$0.05$$$)$。\n- 案例 C (超音速，预处理非激活): $(\\rho, p, u, \\gamma, M_{\\text{cut}}) = ($$1.0$$, $$100000.0$$, $$600.0$$, $$1.4$$, $$0.05$$$)$。\n- 案例 D (边界情况，零速度): $(\\rho, p, u, \\gamma, M_{\\text{cut}}) = ($$1.225$$, $$101325.0$$, $$0.0$$, $$1.4$$, $$0.02$$$)$。\n- 案例 E (边界，处于截止马赫数): $(\\rho, p, u, \\gamma, M_{\\text{cut}}) = ($$1.0$$, $$100000.0$$, $$37.416573867739416$$, $$1.4$$, $$0.1$$$)$，其中速度值的选择使得对于给定的 $(\\rho, p, \\gamma)$ 有 $$M = M_{\\text{cut}}$$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果 (例如，$$[c_{A,1}, c_{A,2}, c_{A,3}, c_{B,1}, \\dots, c_{E,3}]$$)，其中每个 $$c_{*,*}$$ 是一个以 $\\mathrm{m/s}$ 为单位的浮点数。",
            "solution": "该问题被评估为有效。它在科学上是合理的、适定的，并基于计算流体动力学和欧拉方程的既定原理。提供了唯一解所需的所有必要信息和数据。\n\n目标是推导在使用 Weiss-Smith 方法进行预处理时，一维可压缩欧拉方程的特征速度 (特征值)。该方法通过缩放热力学压力的时间导数来改善系统在低马赫数流动下的条件数。预处理后的系统由 $P\\,\\partial U/\\partial t + A\\,\\partial U/\\partial x = 0$ 给出，其中 $U$ 是守恒变量向量，$A = \\partial F/\\partial U$ 是通量雅可比矩阵，$P$ 是预处理矩阵。通过求解平面波解的广义特征值问题 $(A - cP)\\hat{U} = 0$ 来找到特征值 $c$。\n\n为便于推导，使用一组原始变量更为方便，因为预处理是通过其对压力时间导数的作用来定义的。一组合适的变量是 $(p, u, s)$，分别代表压力、速度和比熵。一维欧拉方程可以用这些变量来表示。对于在均匀介质中传播的波，熵扰动与压力和速度扰动是解耦的。关于均匀基态 $(\\rho_0, u_0, p_0, s_0)$ 线性化后，等熵扰动 $(p', u')$ 和熵扰动 $(s')$ 的控制方程为：\n\n1.  组合的连续性与能量方程 (由 $D\\rho/Dt = (1/a^2)Dp/Dt$ 推导而来):\n    $$ \\frac{1}{\\rho_0 a_0^2}\\left(\\frac{\\partial p'}{\\partial t} + u_0 \\frac{\\partial p'}{\\partial x}\\right) + \\frac{\\partial u'}{\\partial x} = 0 $$\n2.  动量方程:\n    $$ \\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0 $$\n3.  熵输运方程:\n    $$ \\frac{\\partial s'}{\\partial t} + u_0 \\frac{\\partial s'}{\\partial x} = 0 $$\n\n此处，$a_0 = \\sqrt{\\gamma p_0 / \\rho_0}$ 是基态声速。\n\nWeiss-Smith 预处理是通过缩放压力时间导数的贡献引入的。根据问题描述，这等同于修改系统中的压力时间导数项。包含与声学相关的 $\\partial p'/\\partial t$ 项的第一个方程被修改。设无量纲缩放参数为 $\\beta$。预处理后的系统变为：\n\n1.  预处理后的连续性/能量方程:\n    $$ \\frac{1}{\\beta \\rho_0 a_0^2}\\frac{\\partial p'}{\\partial t} + \\frac{u_0}{\\rho_0 a_0^2}\\frac{\\partial p'}{\\partial x} + \\frac{\\partial u'}{\\partial x} = 0 $$\n2.  动量方程 (不变):\n    $$ \\rho_0\\left(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}\\right) + \\frac{\\partial p'}{\\partial x} = 0 $$\n3.  熵方程 (不变):\n    $$ \\frac{\\partial s'}{\\partial t} + u_0 \\frac{\\partial s'}{\\partial x} = 0 $$\n\n为求特征速度，我们寻找形式为 $(p', u', s') = (\\hat{p}, \\hat{u}, \\hat{s}) \\exp(i(kx - \\omega t))$ 的平面波解，其中 $k$ 是波数，$\\omega$ 是角频率。相速为 $c = \\omega/k$。将此形式代入线性化系统，偏导数变换为 $\\partial/\\partial t \\to -i\\omega = -ikc$ 和 $\\partial/\\partial x \\to ik$。这为振幅 $(\\hat{p}, \\hat{u}, \\hat{s})$ 产生一个代数系统：\n\n1.  $$ \\left(\\frac{-ikc}{\\beta \\rho_0 a_0^2} + \\frac{iku_0}{\\rho_0 a_0^2}\\right)\\hat{p} + ik\\hat{u} = 0 \\implies \\left(\\frac{u_0 - c}{\\beta a_0^2}\\right)\\hat{p} + \\hat{u} = 0 $$\n2.  $$ \\rho_0(-ikc + iku_0)\\hat{u} + ik\\hat{p} = 0 \\implies \\rho_0(u_0 - c)\\hat{u} + \\hat{p} = 0 $$\n3.  $$ (-ikc + iku_0)\\hat{s} = 0 \\implies (u_0 - c)\\hat{s} = 0 $$\n\n为了存在非平凡解，系数矩阵的行列式必须为零。我们也可以直接求解该系统。从方程(3)中，我们发现两种可能性：要么 $c = u_0$，要么 $\\hat{s} = 0$。\n-   如果 $c = u_0$，我们就找到了一个特征值。这对应于接触间断 (熵波)，它随流速 $u_0$ 被动平流。其速度不受预处理的影响。\n-   如果 $\\hat{s} = 0$，扰动是等熵的，对应于声波。我们求解剩下的两个方程来得到 $\\hat{p}$ 和 $\\hat{u}$。从方程(2)，我们将 $\\hat{p}$ 表示为 $\\hat{u}$ 的函数：\n    $$ \\hat{p} = -\\rho_0(u_0 - c)\\hat{u} $$\n    将此代入方程(1)：\n    $$ \\left(\\frac{u_0 - c}{\\beta a_0^2}\\right) \\left(-\\rho_0(u_0 - c)\\hat{u}\\right) + \\hat{u} = 0 $$\n    对于非平凡声波 ($\\hat{u} \\neq 0$)，我们可以除以 $\\hat{u}$：\n    $$ -\\frac{\\rho_0(u_0 - c)^2}{\\beta a_0^2} + 1 = 0 \\implies (u_0 - c)^2 = \\frac{\\beta a_0^2}{\\rho_0} $$\n    等等，这里有一个不应该出现的 $\\rho_0$。我们来重新检查第一个代数方程。$ (\\frac{u_0 - c}{\\beta \\rho_0 a_0^2})\\hat{p} + \\hat{u} = 0$。这看起来是正确的。我们来重新检查动量方程。$\\rho_0(\\dots) \\implies \\rho_0(\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x}) = -\\frac{\\partial p'}{\\partial x}$。对原始变量 $p,u$ 线性化该方程，就是 $\\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x} + \\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial x}=0$。我们用这个形式。\n    那么系统是：\n    $\\frac{1}{\\beta \\rho_0 a_0^2}\\frac{\\partial p'}{\\partial t} + \\dots = 0$\n    $\\frac{\\partial u'}{\\partial t} + u_0\\frac{\\partial u'}{\\partial x} + \\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial x} = 0$\n    这得到：\n    1. $(\\frac{u_0-c}{\\beta a_0^2})\\hat{p} + \\rho_0 \\hat{u} = 0$\n    2. $(u_0-c)\\hat{u} + \\frac{1}{\\rho_0} \\hat{p} = 0 \\implies \\hat{p} = -\\rho_0(u_0-c)\\hat{u}$\n    将(2)代入(1)：\n    $(\\frac{u_0-c}{\\beta a_0^2})(-\\rho_0(u_0-c)\\hat{u}) + \\rho_0 \\hat{u} = 0$。\n    除以 $\\rho_0 \\hat{u}$ (对于 $\\hat{u} \\neq 0$)：\n    $-\\frac{(u_0-c)^2}{\\beta a_0^2} + 1 = 0 \\implies (u_0 - c)^2 = \\beta a_0^2$。\n    这给出了剩下的两个特征值：\n    $$ u_0 - c = \\pm \\sqrt{\\beta} a_0 \\implies c = u_0 \\pm \\sqrt{\\beta} a_0 $$\n\n因此，预处理系统的三个特征速度是：\n$$ \\{ c_1, c_2, c_3 \\} = \\{ u_0 - \\sqrt{\\beta} a_0, u_0, u_0 + \\sqrt{\\beta} a_0 \\} $$\n修正后的声速为 $\\tilde{a} = \\sqrt{\\beta} a_0$。\n\n无量纲参数 $\\beta$ 定义为 $\\beta = \\min\\left(1, \\max\\left(M^2, M_{\\text{cut}}^{2}\\right)\\right)$，其中 $M = |u_0|/a_0$ 是基态流的马赫数，$M_{\\text{cut}}$ 是一个指定的截止值。\n-   对于超音速流 ($M \\ge 1$)，$M^2 \\ge 1$。因此 $\\max(M^2, M_{\\text{cut}}^2) \\ge 1$，这使得 $\\beta = \\min(1, \\dots) = 1$。特征值变为 $u_0, u_0 \\pm a_0$，恢复为原始欧拉速度，因此预处理按要求变为非激活状态。\n-   对于亚音速流 ($M < 1$)，有两种子情况：\n    -   如果 $M_{\\text{cut}} \\le M < 1$，那么 $M^2 \\ge M_{\\text{cut}}^2$，所以 $\\max(M^2, M_{\\text{cut}}^2) = M^2$。由于 $M^2 < 1$，$\\beta = M^2$。修正后的声速为 $\\tilde{a} = \\sqrt{M^2} a_0 = M a_0 = |u_0|$。声波被缩放，使其相对于流体以流速传播。\n    -   如果 $M < M_{\\text{cut}}$，那么 $M^2 < M_{\\text{cut}}^2$，所以 $\\max(M^2, M_{\\text{cut}}^2) = M_{\\text{cut}}^2$。由于 $M_{\\text{cut}} < 1$，$\\beta = M_{\\text{cut}}^2$。修正后的声速为 $\\tilde{a} = \\sqrt{M_{\\text{cut}}^2} a_0 = M_{\\text{cut}} a_0$。这为波速提供了一个下界，防止其变得过小 (或在静止流中变为零)，因为那样会重新引入刚性。\n\n该实现将为每个提供的测试案例计算这三个特征值。\n每个案例的最终特征速度使用基态值 $(\\rho_0, p_0, u_0, \\gamma, M_{\\text{cut}})$ 进行计算。首先，计算 $a_0 = \\sqrt{\\gamma p_0 / \\rho_0}$ 和 $M_0 = |u_0| / a_0$。然后，计算 $\\beta = \\min(1.0, \\max(M_0^2, M_{\\text{cut}}^2))$。最后，计算特征值 $u_0 - \\sqrt{\\beta}a_0$，$u_0$ 和 $u_0 + \\sqrt{\\beta}a_0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the characteristic speeds of the 1D Euler equations with\n    Weiss-Smith preconditioning for a given set of test cases.\n    \"\"\"\n\n    # Test suite parameter sets: (rho, p, u, gamma, M_cut)\n    test_cases = [\n        # Case A (happy path, very low Mach)\n        (1.0, 100000.0, 1.0, 1.4, 0.05),\n        # Case B (moderate subsonic Mach)\n        (1.0, 100000.0, 100.0, 1.4, 0.05),\n        # Case C (supersonic, preconditioning inactive)\n        (1.0, 100000.0, 600.0, 1.4, 0.05),\n        # Case D (edge case, zero velocity)\n        (1.225, 101325.0, 0.0, 1.4, 0.02),\n        # Case E (boundary, at cutoff Mach)\n        (1.0, 100000.0, 37.416573867739416, 1.4, 0.1),\n    ]\n\n    all_eigenvalues = []\n\n    for case in test_cases:\n        rho_0, p_0, u_0, gamma, m_cut = case\n\n        # 1. Calculate base state speed of sound\n        a_0 = np.sqrt(gamma * p_0 / rho_0)\n\n        # 2. Calculate base state Mach number\n        # Avoid division by zero if a_0 is zero (although physically unlikely for gamma > 1, p_0 > 0, rho_0 > 0)\n        if a_0 == 0.0:\n            m_0 = np.inf if u_0 != 0.0 else 0.0\n        else:\n            m_0 = np.abs(u_0) / a_0\n\n        # 3. Calculate the preconditioning parameter beta\n        beta = min(1.0, max(m_0**2, m_cut**2))\n\n        # 4. Calculate the modified acoustic speed\n        a_tilde = np.sqrt(beta) * a_0\n\n        # 5. Calculate the three characteristic speeds (eigenvalues)\n        c1 = u_0 - a_tilde\n        c2 = u_0\n        c3 = u_0 + a_tilde\n\n        all_eigenvalues.extend([c1, c2, c3])\n\n    # Final print statement in the exact required format.\n    # The output format is a single line containing a comma-separated list\n    # enclosed in square brackets of all eigenvalues in order.\n    print(f\"[{','.join(map(str, all_eigenvalues))}]\")\n\nsolve()\n```"
        }
    ]
}