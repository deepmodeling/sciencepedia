{
    "hands_on_practices": [
        {
            "introduction": "To understand low-Mach number preconditioning, we must first grasp its fundamental purpose: to rescale the eigenvalues of the governing equations to alleviate numerical stiffness. This exercise guides you through a first-principles derivation to discover the ideal form of a preconditioning function, based on essential physical and numerical constraints like preserving the steady-state solution and ensuring consistency across the Mach number range. By working through this problem , you will see how the ubiquitous $M^2$ scaling factor emerges not by accident, but from logical necessity.",
            "id": "3974443",
            "problem": "Consider the one-dimensional compressible Euler equations in conservative form for an ideal gas, which provide the foundation of Computational Fluid Dynamics (CFD) analysis of inviscid flows:\n$$\n\\frac{\\partial \\boldsymbol{Q}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}$, $\\boldsymbol{F}(\\boldsymbol{Q}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(\\rho E + p) \\end{pmatrix}$, and the equation of state is $p = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^{2}\\right)$. The sound speed is $a = \\sqrt{\\gamma p / \\rho}$ and the Mach number is $M = |u|/a$. Low-Mach number preconditioning modifies the pseudo-time evolution used in steady computations by replacing the physical time derivative with a preconditioned pseudo-time derivative:\n$$\n\\boldsymbol{\\Gamma}^{-1}(M)\\,\\frac{\\partial \\boldsymbol{Q}}{\\partial \\tau} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{\\Gamma}(M)$ is a symmetric positive definite matrix that depends on the local Mach number $M$ and acts only on the pseudo-time derivative.\n\nStarting from the Euler equations and the ideal gas law, linearize about a uniform base state $(\\rho_{0}, u_{0}, p_{0})$ with $M \\in (0,1]$. Assume a scalar low-Mach preconditioning that effectively rescales the compressibility in the continuity-pressure coupling so that, in the linearized, preconditioned system, the pseudo-acoustic speed becomes $\\sqrt{\\alpha(M)}\\,a$ for some smooth scalar function $\\alpha(M)$, while the spatial flux Jacobian is left unmodified. Impose the following requirements:\n1. Steady-state invariance: the set of steady solutions of the preconditioned pseudo-time system must coincide with the steady solutions of the original Euler equations.\n2. Low-Mach equalization: in the limit $M \\to 0$, the largest characteristic speed magnitude governing the pseudo-time marching must scale as $\\mathcal{O}(|u_{0}|)$ (not $\\mathcal{O}(a)$).\n3. High-Mach consistency: as $M \\to 1$, the preconditioned system must recover the original acoustic scaling.\n\nUnder these constraints, derive a closed-form analytic expression for $\\alpha(M)$ in terms of the Mach number $M$ that satisfies all three conditions, and provide that expression as your final answer. The final answer must be a single analytic expression. No rounding is required and the answer is dimensionless.",
            "solution": "The user wants to derive a closed-form analytic expression for a scalar function $\\alpha(M)$ used in a low-Mach number preconditioning scheme for the one-dimensional Euler equations. The function $\\alpha(M)$ must satisfy three specific requirements.\n\nThe starting point is the one-dimensional compressible Euler equations in pseudo-time, preconditioned for low-Mach number computations:\n$$ \\boldsymbol{\\Gamma}^{-1}(M)\\,\\frac{\\partial \\boldsymbol{Q}}{\\partial \\tau} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0} $$\nHere, $\\boldsymbol{Q}$ is the vector of conserved variables, $\\boldsymbol{F}(\\boldsymbol{Q})$ is the flux vector, $\\tau$ is the pseudo-time, and $\\boldsymbol{\\Gamma}(M)$ is the preconditioning matrix. For steady-state computations, the system is evolved in pseudo-time until the term $\\partial \\boldsymbol{Q} / \\partial \\tau$ vanishes.\n\nThe characteristic speeds of this hyperbolic system govern the propagation of information in the pseudo-time domain $(\\tau, x)$. These speeds, denoted by $\\lambda'_p$, are the eigenvalues of the matrix product $\\boldsymbol{\\Gamma}(M)\\boldsymbol{A}(\\boldsymbol{Q})$, where $\\boldsymbol{A} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{Q}}$ is the flux Jacobian of the original Euler equations.\n\nThe eigenvalues of the unpreconditioned flux Jacobian $\\boldsymbol{A}$ are well-known to be $\\{u, u+a, u-a\\}$, where $u$ is the fluid velocity and $a$ is the speed of sound. These correspond to one convective wave (entropy and vorticity) and two acoustic waves.\n\nThe problem states that the preconditioning scheme is designed such that \"the pseudo-acoustic speed becomes $\\sqrt{\\alpha(M)}a$\". In the context of characteristic analysis, the acoustic speeds are the propagation speeds of sound waves relative to the moving fluid, which are $\\pm a$ in the original system. The most direct interpretation of the problem statement is that the preconditioned system modifies these relative speeds to $\\pm \\sqrt{\\alpha(M)}a$. Assuming the convective speed $u$ remains the reference for the acoustic waves, the eigenvalues of the preconditioned system matrix $\\boldsymbol{\\Gamma A}$ are:\n$$ \\{\\lambda'_{p}\\} = \\{ u, u + \\sqrt{\\alpha(M)}a, u - \\sqrt{\\alpha(M)}a \\} $$\nWe will now use the three given requirements to determine the form of $\\alpha(M)$.\n\n1.  **Steady-state invariance:** The first requirement is that the steady solutions of the preconditioned system must be the same as those of the original Euler equations. At steady state, the pseudo-time derivative term is zero: $\\frac{\\partial \\boldsymbol{Q}}{\\partial \\tau} = \\boldsymbol{0}$. The preconditioned system reduces to $\\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0}$. This is identical to the steady-state form of the original Euler equations. This condition is satisfied by the structure of the preconditioned system, provided the preconditioning matrix $\\boldsymbol{\\Gamma}(M)$ is invertible (which is guaranteed as it is given to be positive definite). Thus, this requirement imposes no further constraints on the function $\\alpha(M)$.\n\n2.  **Low-Mach equalization:** The second requirement dictates the behavior of the system in the low-Mach number limit, $M \\to 0$. It states that the largest characteristic speed magnitude, $\\max_p |\\lambda'_p|$, must scale as $\\mathcal{O}(|u_0|)$. This is the core of low-Mach preconditioning: it aims to rescale the disparate characteristic speeds ($|u|$ and $|u \\pm a|$) to be of the same order of magnitude, thereby removing the stiffness associated with the large ratio $a/|u| = 1/M$.\n\n    The magnitudes of the preconditioned eigenvalues are $|u|$ and $|u \\pm \\sqrt{\\alpha(M)}a|$. The largest of these is generally $|u| + \\sqrt{\\alpha(M)}a$.\n    We require this largest magnitude to scale with $|u|$ as $M \\to 0$:\n    $$ |u| + \\sqrt{\\alpha(M)}a = \\mathcal{O}(|u|) $$\n    Since $|u|$ already scales as $\\mathcal{O}(|u|)$, this condition imposes a constraint on the second term:\n    $$ \\sqrt{\\alpha(M)}a = \\mathcal{O}(|u|) $$\n    Dividing by the sound speed $a$ (which is a finite, non-zero constant in the base state), we get:\n    $$ \\sqrt{\\alpha(M)} = \\mathcal{O}\\left(\\frac{|u|}{a}\\right) = \\mathcal{O}(M) $$\n    This implies that for small $M$, the function $\\alpha(M)$ must have the asymptotic behavior $\\alpha(M) \\sim k M^2$ for some dimensionless constant $k$ of order unity.\n\n3.  **High-Mach consistency:** The third requirement is that as the Mach number approaches unity ($M \\to 1$), the preconditioned system must recover the original acoustic scaling. This means the characteristic speeds of the preconditioned system must approach those of the original Euler equations.\n    $$ u \\pm \\sqrt{\\alpha(M)}a \\to u \\pm a \\quad \\text{as } M \\to 1 $$\n    This implies that $\\sqrt{\\alpha(M)} \\to 1$ as $M \\to 1$, which leads to the condition:\n    $$ \\alpha(M) \\to 1 \\quad \\text{as } M \\to 1 $$\n\nFinally, we must synthesize a single, smooth, closed-form analytic expression for $\\alpha(M)$ that satisfies the derived conditions for $M \\in (0, 1]$:\n- Condition from Requirement 2: $\\alpha(M) \\sim k M^2$ as $M \\to 0$.\n- Condition from Requirement 3: $\\alpha(1) = 1$.\n\nLet us seek the simplest possible analytic function that satisfies these constraints. A simple choice consistent with the low-Mach scaling is a power-law form, $\\alpha(M) = C M^n$. From the low-Mach condition, we must have the exponent $n=2$, so the form is $\\alpha(M) = C M^2$. Now, applying the high-Mach condition at $M=1$:\n$$ \\alpha(1) = C \\cdot (1)^2 = C $$\nFrom the requirement $\\alpha(1)=1$, we find that the constant $C$ must be $1$.\nThis leads to the unique simple solution:\n$$ \\alpha(M) = M^2 $$\nThis function is analytic and therefore smooth for all $M$. It satisfies the low-Mach requirement by setting the pseudo-acoustic speeds to $u \\pm Ma = u \\pm |u|$, ensuring all characteristic speed magnitudes scale with $|u|$. It satisfies the high-Mach consistency requirement, as for $M=1$, $\\alpha(1)=1^2=1$, correctly recovering the original acoustic speeds.",
            "answer": "$$\\boxed{M^{2}}$$"
        },
        {
            "introduction": "After establishing the theoretical form of a preconditioner, the next logical step is to quantify its practical benefits. This practice problem  challenges you to calculate two key metrics of success: the improvement in the system's spectral condition number, which measures the reduction in stiffness, and the resulting increase in the maximum stable time step for an explicit solver, which directly translates to computational speed-up. This analysis provides a concrete understanding of why preconditioning is a critical enabling technology for efficient low-Mach number simulations.",
            "id": "3974411",
            "problem": "Consider the one-dimensional, non-dimensionalized compressible Euler equations linearized about a uniform base flow of Mach number $M>0$ with reference sound speed scaled to $a=1$ and base velocity $u=M$. The linearized system can be written in quasi-linear form as $\\partial_t \\mathbf{q} + \\mathbf{A} \\, \\partial_x \\mathbf{q} = 0$, where $\\mathbf{A}$ is the flux Jacobian. The characteristic speeds (eigenvalues of $\\mathbf{A}$) are $u$, $u+a$, and $u-a$. In a density-based steady solver that uses pseudo-time marching, a left preconditioning matrix $\\mathbf{P}$ is applied to the time derivative to alleviate low-Mach stiffness, yielding the preconditioned pseudo-time system $\\mathbf{P}\\,\\partial_t \\mathbf{q} + \\mathbf{A} \\, \\partial_x \\mathbf{q} = 0$, or equivalently $\\partial_t \\mathbf{q} + \\mathbf{A}_p \\,\\partial_x \\mathbf{q}=0$ with $\\mathbf{A}_p = \\mathbf{P}^{-1}\\mathbf{A}$. Suppose the preconditioner is designed to leave the convective mode unchanged while scaling the acoustic modes so that the modified acoustic speed is $\\tilde{a}=\\sqrt{\\beta}\\,M$, where the parameter $\\beta$ satisfies $0<\\beta<1$.\n\nUsing only the above physical setup and standard properties of the one-dimensional Euler characteristics, derive from first principles:\n\n- The spectral condition number $\\kappa$ of the preconditioned Jacobian $\\mathbf{A}_p$, defined as the ratio of the largest to the smallest strictly positive magnitude among the characteristic speeds of $\\mathbf{A}_p$.\n- The ratio $R$ of the maximum stable explicit time step under forward Euler for the preconditioned pseudo-time system to that of the unpreconditioned physical-time system, assuming a uniform grid of spacing $\\Delta x$ and a fixed Courant-Friedrichs-Lewy (CFL) number $\\text{CFL}_0$ applied consistently in both cases. Use the standard explicit stability bound $\\Delta t_{\\max} = \\text{CFL}_0 \\, \\Delta x / \\lambda_{\\max}$, where $\\lambda_{\\max}$ is the largest magnitude characteristic speed.\n\nProvide your final answer as a single row matrix containing the two closed-form expressions $(\\kappa, R)$ in terms of $M$ and $\\beta$. All variables are non-dimensional, so no physical units are required. Do not substitute numerical values. Do not round; provide exact symbolic expressions.",
            "solution": "The problem requires the derivation of two quantities related to the preconditioning of the one-dimensional compressible Euler equations: the spectral condition number $\\kappa$ of the preconditioned Jacobian $\\mathbf{A}_p$, and the ratio $R$ of the maximum stable explicit time steps for the preconditioned and unpreconditioned systems. The derivation will proceed from the given properties of the systems.\n\nFirst, let us establish the characteristic speeds (eigenvalues) for both the unpreconditioned and preconditioned systems.\n\nThe unpreconditioned system is given by $\\partial_t \\mathbf{q} + \\mathbf{A} \\, \\partial_x \\mathbf{q} = 0$. The problem states that the base flow has a velocity $u=M$ and the reference sound speed is $a=1$, where $M>0$ is the Mach number. The characteristic speeds, which are the eigenvalues of the flux Jacobian $\\mathbf{A}$, are given as $\\{u, u+a, u-a\\}$. Substituting the given values, the set of eigenvalues for the unpreconditioned system, denoted by $\\Lambda$, is:\n$$\n\\Lambda = \\{ M, M+1, M-1 \\}\n$$\n\nThe preconditioned system is $\\partial_t \\mathbf{q} + \\mathbf{A}_p \\,\\partial_x \\mathbf{q}=0$, where $\\mathbf{A}_p = \\mathbf{P}^{-1}\\mathbf{A}$. The problem specifies how the preconditioner $\\mathbf{P}$ alters the eigenvalues. Let the eigenvalues of $\\mathbf{A}_p$ be denoted by $\\Lambda_p$.\n1.  The convective mode is unchanged. The eigenvalue corresponding to the convective mode in the original system is $u=M$. Therefore, one eigenvalue of $\\mathbf{A}_p$ is $M$.\n2.  The acoustic modes are scaled such that the modified acoustic speed is $\\tilde{a} = \\sqrt{\\beta}\\,M$, where $0 < \\beta < 1$. The original acoustic modes correspond to eigenvalues $u \\pm a$. The preconditioned acoustic eigenvalues are thus $u \\pm \\tilde{a}$. Substituting $u=M$ and $\\tilde{a}$, we get $M \\pm \\sqrt{\\beta}\\,M$.\n\nSo, the set of eigenvalues for the preconditioned system, $\\Lambda_p$, is:\n$$\n\\Lambda_p = \\{ M, M + \\sqrt{\\beta}\\,M, M - \\sqrt{\\beta}\\,M \\} = \\{ M, M(1+\\sqrt{\\beta}), M(1-\\sqrt{\\beta}) \\}\n$$\n\nNow we can proceed to derive the two required quantities.\n\n1.  **Derivation of the Spectral Condition Number $\\kappa$**\n\nThe spectral condition number $\\kappa$ of the preconditioned Jacobian $\\mathbf{A}_p$ is defined as the ratio of the largest to the smallest strictly positive magnitude among its characteristic speeds.\n$$\n\\kappa = \\frac{\\max(|\\lambda_p| \\text{ for } \\lambda_p \\in \\Lambda_p)}{\\min(|\\lambda_p| > 0 \\text{ for } \\lambda_p \\in \\Lambda_p)}\n$$\nWe need to find the magnitudes of the eigenvalues in $\\Lambda_p$. Since $M > 0$ and $0 < \\beta < 1$, we have $0 < \\sqrt{\\beta} < 1$.\nThis implies:\n- $|\\lambda_{p,1}| = |M| = M$\n- $|\\lambda_{p,2}| = |M(1+\\sqrt{\\beta})| = M(1+\\sqrt{\\beta})$, since $1+\\sqrt{\\beta} > 0$.\n- $|\\lambda_{p,3}| = |M(1-\\sqrt{\\beta})| = M(1-\\sqrt{\\beta})$, since $1-\\sqrt{\\beta} > 0$.\n\nAll eigenvalues are strictly positive. We now find the maximum and minimum of these magnitudes.\nLet's compare the three values: $M$, $M(1+\\sqrt{\\beta})$, and $M(1-\\sqrt{\\beta})$.\nSince $\\sqrt{\\beta} > 0$, we have $M\\sqrt{\\beta} > 0$.\n- $M(1+\\sqrt{\\beta}) = M + M\\sqrt{\\beta} > M$.\n- $M(1-\\sqrt{\\beta}) = M - M\\sqrt{\\beta} < M$.\nThus, the maximum and minimum magnitude eigenvalues are:\n$$\n\\max(|\\lambda_p|) = M(1+\\sqrt{\\beta})\n$$\n$$\n\\min(|\\lambda_p|) = M(1-\\sqrt{\\beta})\n$$\nSubstituting these into the definition of $\\kappa$:\n$$\n\\kappa = \\frac{M(1+\\sqrt{\\beta})}{M(1-\\sqrt{\\beta})} = \\frac{1+\\sqrt{\\beta}}{1-\\sqrt{\\beta}}\n$$\n\n2.  **Derivation of the Time Step Ratio $R$**\n\nThe ratio $R$ is defined as $R = \\frac{\\Delta t_{\\text{max, precond}}}{\\Delta t_{\\text{max, unprecond}}}$. The maximum stable time step for an explicit method is given by the CFL condition: $\\Delta t_{\\max} = \\text{CFL}_0 \\, \\Delta x / \\lambda_{\\max}$, where $\\lambda_{\\max}$ is the largest magnitude of the characteristic speeds of the system. The terms $\\text{CFL}_0$ and $\\Delta x$ are constant for both systems.\nTherefore, the ratio $R$ can be written as:\n$$\nR = \\frac{\\frac{\\text{CFL}_0 \\, \\Delta x}{\\lambda_{\\max, \\text{precond}}}}{\\frac{\\text{CFL}_0 \\, \\Delta x}{\\lambda_{\\max, \\text{unprecond}}}} = \\frac{\\lambda_{\\max, \\text{unprecond}}}{\\lambda_{\\max, \\text{precond}}}\n$$\n\nFirst, we find $\\lambda_{\\max, \\text{unprecond}}$, the largest eigenvalue magnitude for the unpreconditioned system. The eigenvalues are $\\{M, M+1, M-1\\}$. Their magnitudes are $\\{|M|, |M+1|, |M-1|\\}$. Since $M>0$, we have $|M|=M$ and $|M+1|=M+1$.\n- If $0 < M < 1$, the magnitudes are $\\{M, M+1, 1-M\\}$. Comparing them, $M+1>M$ and $M+1 > 1-M$ (since $2M>0$). So, $\\lambda_{\\max, \\text{unprecond}} = M+1$.\n- If $M \\ge 1$, the magnitudes are $\\{M, M+1, M-1\\}$. Clearly, $\\lambda_{\\max, \\text{unprecond}} = M+1$.\nIn all cases for $M>0$, the largest eigenvalue magnitude is:\n$$\n\\lambda_{\\max, \\text{unprecond}} = M+1\n$$\n\nNext, we find $\\lambda_{\\max, \\text{precond}}$, the largest eigenvalue magnitude for the preconditioned system. As determined in the derivation of $\\kappa$, the eigenvalues are $\\{M, M(1+\\sqrt{\\beta}), M(1-\\sqrt{\\beta})\\}$, and their magnitudes are the same since they are all positive. The largest among them is:\n$$\n\\lambda_{\\max, \\text{precond}} = M(1+\\sqrt{\\beta})\n$$\n\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{\\lambda_{\\max, \\text{unprecond}}}{\\lambda_{\\max, \\text{precond}}} = \\frac{M+1}{M(1+\\sqrt{\\beta})}\n$$\n\nThe two derived quantities are $\\kappa = \\frac{1+\\sqrt{\\beta}}{1-\\sqrt{\\beta}}$ and $R = \\frac{M+1}{M(1+\\sqrt{\\beta})}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1+\\sqrt{\\beta}}{1-\\sqrt{\\beta}} & \\frac{M+1}{M(1+\\sqrt{\\beta})} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The final step in mastering a numerical technique is to move from theoretical derivation to practical implementation. This exercise  asks you to implement the classic Weiss-Smith preconditioner, a widely-used method that builds upon the principles you have explored. You will translate the mathematical model into code and apply it to various flow conditions, observing how practical additions like a cutoff Mach number, $M_{\\text{cut}}$, ensure robustness in real-world scenarios, such as at stagnation points where $M=0$.",
            "id": "3974405",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas, posed for a uniform base state with constant density $\\rho_{0}$, velocity $u_{0}$, and pressure $p_{0}$, with the ratio of specific heats $\\gamma > 1$. The unknown conservative state vector is $U = [\\rho, \\rho u, \\rho E]^{\\top}$, and the flux vector is $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$, where the pressure $p$ satisfies the ideal gas relation $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$. The speed of sound is defined by $a = \\sqrt{\\gamma p / \\rho}$ and the Mach number is $M = |u|/a$. In Computational Fluid Dynamics (CFD), for low Mach number flows, explicit schemes suffer from stiffness due to the disparity between convective and acoustic wave speeds. Low-Mach number preconditioning modifies the temporal behavior to alleviate stiffness while preserving the hyperbolic character. In Weiss–Smith preconditioning, the time derivative of the thermodynamic pressure is scaled to adjust acoustic wave speeds while maintaining consistency with the original system in the high-Mach regime.\n\nStarting from the compressible Euler equations linearized about $(\\rho_{0}, u_{0}, p_{0})$, consider the preconditioned system in the form $P\\,\\partial U/\\partial t + \\partial F(U)/\\partial x = 0$, where $P$ is a constant, symmetric, positive definite matrix that effects Weiss–Smith preconditioning by selectively scaling the pressure time derivative in the primitive-variable representation. Assume ideal gas closure and a uniform base state. The sought characteristic speeds are the eigenvalues of the preconditioned operator, namely those values $c$ for which nontrivial plane-wave solutions $U'(x,t) = \\hat{U}\\,\\exp\\left(i(kx - \\omega t)\\right)$ exist, leading to the generalized eigenvalue problem $(A - c P)\\hat{U} = 0$ with $A = \\partial F/\\partial U$ evaluated at the base state and $c = \\omega/k$.\n\nYour tasks are:\n\n1. Derive, from first principles of the one-dimensional linearized Euler equations and the definition of Weiss–Smith preconditioning as a scaling of the thermodynamic-pressure time derivative, the modified characteristic speeds of the preconditioned operator, expressed in terms of the base velocity $u_{0}$, the base speed of sound $a_{0}$, and a dimensionless preconditioning parameter. Show that the preconditioned acoustic speeds are reduced at low Mach numbers and revert to the unmodified acoustic speeds when $M \\geq 1$.\n\n2. Define a cutoff parameter $M_{\\text{cut}} \\in (0,1)$ that enforces a lower bound for the preconditioning effect. Let the dimensionless scaling be $\\beta = \\min\\left(1, \\max\\left(M^{2}, M_{\\text{cut}}^{2}\\right)\\right)$, with the phase speed modification to be expressed using $\\beta$ and the base speed of sound $a_{0}$. Implement the derived expression to compute the eigenvalues of the preconditioned operator for given $(\\rho, p, u, \\gamma, M_{\\text{cut}})$.\n\n3. For the following test suite, compute the three characteristic speeds for each case and produce a single-line output that concatenates the characteristic speeds for all cases in order. All velocities must be expressed in $\\mathrm{m/s}$ as floating-point numbers. The final output format must be a single line containing a comma-separated list enclosed in square brackets of all eigenvalues in the order $\\left[u - a_{\\text{tilde}}, u, u + a_{\\text{tilde}}\\right]$ for each case, in the same sequence as the cases appear.\n\nTest suite parameter sets (each set is $(\\rho, p, u, \\gamma, M_{\\text{cut}})$ with units $\\rho$ in $\\mathrm{kg/m^{3}}$, $p$ in $\\mathrm{Pa}$, $u$ in $\\mathrm{m/s}$):\n\n- Case A (happy path, very low Mach): $(1.0, 100000.0, 1.0, 1.4, 0.05)$.\n- Case B (moderate subsonic Mach): $(1.0, 100000.0, 100.0, 1.4, 0.05)$.\n- Case C (supersonic, preconditioning inactive): $(1.0, 100000.0, 600.0, 1.4, 0.05)$.\n- Case D (edge case, zero velocity): $(1.225, 101325.0, 0.0, 1.4, 0.02)$.\n- Case E (boundary, at cutoff Mach): $(1.0, 100000.0, 37.416573867739416, 1.4, 0.1)$, where the velocity value is chosen so that $M = M_{\\text{cut}}$ for the given $(\\rho, p, \\gamma)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[c_{A,1}, c_{A,2}, c_{A,3}, c_{B,1}, \\dots, c_{E,3}]$), where each $c_{*,*}$ is a floating-point number in $\\mathrm{m/s}$.",
            "solution": "The objective is to derive the characteristic speeds (eigenvalues) of the one-dimensional compressible Euler equations under Weiss-Smith preconditioning. It is most convenient to work with the linearized Euler equations in primitive variables, like pressure $p$, velocity $u$, and entropy $s$. For isentropic perturbations, the entropy equation decouples, and we are left with a system for pressure and velocity perturbations, $p'$ and $u'$.\n\nThe standard linearized Euler equations for isentropic waves around a uniform base state $(u_0, \\rho_0, a_0)$ are:\n$$ \\frac{\\partial p'}{\\partial t} + u_0 \\frac{\\partial p'}{\\partial x} + \\rho_0 a_0^2 \\frac{\\partial u'}{\\partial x} = 0 \\quad \\text{(from continuity/energy)} $$\n$$ \\frac{\\partial u'}{\\partial t} + u_0 \\frac{\\partial u'}{\\partial x} + \\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial x} = 0 \\quad \\text{(from momentum)} $$\n\nLow-Mach preconditioning of the Weiss-Smith type modifies the pressure-velocity coupling in the first equation. This can be represented by scaling the effective compressibility term. The preconditioned system becomes:\n$$ \\frac{1}{\\beta}\\left(\\frac{\\partial p'}{\\partial t} + u_0 \\frac{\\partial p'}{\\partial x}\\right) + \\rho_0 a_0^2 \\frac{\\partial u'}{\\partial x} = 0 $$\nThe momentum equation remains unchanged. The dimensionless parameter $\\beta$ controls the preconditioning.\n\nTo find the characteristic speeds, we seek plane-wave solutions of the form $(p', u') = (\\hat{p}, \\hat{u}) \\exp(i(kx - \\omega t))$, where $c=\\omega/k$ is the phase speed (eigenvalue). Substituting this into the system gives:\n$$ \\frac{1}{\\beta}(-ikc + iku_0)\\hat{p} + ik\\rho_0 a_0^2 \\hat{u} = 0 \\implies (u_0 - c)\\hat{p} + \\beta\\rho_0 a_0^2 \\hat{u} = 0 $$\n$$ (-ikc + iku_0)\\hat{u} + \\frac{ik}{\\rho_0}\\hat{p} = 0 \\implies (u_0 - c)\\hat{u} + \\frac{1}{\\rho_0}\\hat{p} = 0 $$\n\nThis is a linear system for the amplitudes $(\\hat{p}, \\hat{u})$. For a non-trivial solution, the determinant of the coefficient matrix must be zero:\n$$ \\det \\begin{pmatrix} u_0 - c & \\beta\\rho_0 a_0^2 \\\\ 1/\\rho_0 & u_0 - c \\end{pmatrix} = 0 $$\n$$ (u_0 - c)^2 - (\\beta\\rho_0 a_0^2)\\left(\\frac{1}{\\rho_0}\\right) = 0 $$\n$$ (u_0 - c)^2 = \\beta a_0^2 $$\nThis gives the two acoustic eigenvalues: $u_0 - c = \\pm \\sqrt{\\beta} a_0$, or $c = u_0 \\pm \\sqrt{\\beta} a_0$.\n\nThe third eigenvalue comes from the entropy transport equation, $\\partial s'/\\partial t + u_0 \\partial s'/\\partial x = 0$, which is unaffected by this preconditioning. Its characteristic speed is simply $c = u_0$.\n\nThe three characteristic speeds of the preconditioned system are therefore:\n$$ \\{ c_1, c_2, c_3 \\} = \\{ u_0 - \\tilde{a}, u_0, u_0 + \\tilde{a} \\} \\quad \\text{where} \\quad \\tilde{a} = \\sqrt{\\beta} a_0 $$\n\nThe implementation will compute these three eigenvalues for each test case. The dimensionless parameter $\\beta$ is defined as $\\beta = \\min\\left(1, \\max\\left(M^{2}, M_{\\text{cut}}^{2}\\right)\\right)$, where $M = |u_0|/a_0$ is the base flow Mach number and $M_{\\text{cut}}$ is a specified cutoff. The logic is as follows:\n1.  For each case, calculate the base state speed of sound $a_0 = \\sqrt{\\gamma p_0 / \\rho_0}$ and Mach number $M_0 = |u_0| / a_0$.\n2.  Calculate the preconditioning parameter $\\beta = \\min(1.0, \\max(M_0^2, M_{\\text{cut}}^2))$.\n3.  Compute the modified acoustic speed $\\tilde{a} = \\sqrt{\\beta}a_0$.\n4.  Compute the final eigenvalues: $u_0 - \\tilde{a}$, $u_0$, and $u_0 + \\tilde{a}$.\nThis derivation and implementation plan fulfills all requirements of the problem.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the characteristic speeds of the 1D Euler equations with\n    Weiss-Smith preconditioning for a given set of test cases.\n    \"\"\"\n\n    # Test suite parameter sets: (rho, p, u, gamma, M_cut)\n    test_cases = [\n        # Case A (happy path, very low Mach)\n        (1.0, 100000.0, 1.0, 1.4, 0.05),\n        # Case B (moderate subsonic Mach)\n        (1.0, 100000.0, 100.0, 1.4, 0.05),\n        # Case C (supersonic, preconditioning inactive)\n        (1.0, 100000.0, 600.0, 1.4, 0.05),\n        # Case D (edge case, zero velocity)\n        (1.225, 101325.0, 0.0, 1.4, 0.02),\n        # Case E (boundary, at cutoff Mach)\n        (1.0, 100000.0, 37.416573867739416, 1.4, 0.1),\n    ]\n\n    all_eigenvalues = []\n\n    for case in test_cases:\n        rho_0, p_0, u_0, gamma, m_cut = case\n\n        # 1. Calculate base state speed of sound\n        a_0 = np.sqrt(gamma * p_0 / rho_0)\n\n        # 2. Calculate base state Mach number\n        # Avoid division by zero if a_0 is zero (although physically unlikely for gamma > 1, p_0 > 0, rho_0 > 0)\n        if a_0 == 0.0:\n            m_0 = np.inf if u_0 != 0.0 else 0.0\n        else:\n            m_0 = np.abs(u_0) / a_0\n\n        # 3. Calculate the preconditioning parameter beta\n        beta = min(1.0, max(m_0**2, m_cut**2))\n\n        # 4. Calculate the modified acoustic speed\n        a_tilde = np.sqrt(beta) * a_0\n\n        # 5. Calculate the three characteristic speeds (eigenvalues)\n        c1 = u_0 - a_tilde\n        c2 = u_0\n        c3 = u_0 + a_tilde\n\n        all_eigenvalues.extend([c1, c2, c3])\n\n    # Final print statement in the exact required format.\n    # The output format is a single line containing a comma-separated list\n    # enclosed in square brackets of all eigenvalues in order.\n    print(f\"[{','.join(map(str, all_eigenvalues))}]\")\n\nsolve()\n```"
        }
    ]
}