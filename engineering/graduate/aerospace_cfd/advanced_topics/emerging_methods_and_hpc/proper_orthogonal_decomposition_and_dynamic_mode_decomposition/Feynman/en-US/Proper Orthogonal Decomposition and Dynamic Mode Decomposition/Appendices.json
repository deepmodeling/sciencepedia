{
    "hands_on_practices": [
        {
            "introduction": "Proper Orthogonal Decomposition (POD) is fundamentally an optimization problem that seeks the most \"energetic\" modes in a dataset. But what defines energy? This exercise  challenges you to explore how the choice of inner product—the mathematical tool for measuring energy and orthogonality—profoundly impacts which modes are identified as dominant. By comparing results from a standard Euclidean inner product with a physically-motivated weighted inner product, you will gain a crucial understanding of why a \"one-size-fits-all\" approach can be misleading in complex physical systems.",
            "id": "3987525",
            "problem": "Consider a reduced two-component state extracted from a compressible flow simulation in aerospace Computational Fluid Dynamics (CFD). The state at time index $k$ is $x_{k} \\in \\mathbb{R}^{2}$ with components $x_{k} = \\begin{pmatrix} c_{k} \\\\ u'_{k} \\end{pmatrix}$, where $c_{k}$ represents a passive scalar concentration fluctuation driven by injection and $u'_{k}$ represents the streamwise velocity fluctuation. You are given four snapshots,\n$$\nx_{1} = \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix},\\quad\nx_{2} = \\begin{pmatrix} -4 \\\\ 0 \\end{pmatrix},\\quad\nx_{3} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix},\\quad\nx_{4} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.\n$$\nThe sample size is $m = 4$. The passive scalar component has larger variance than the velocity component in these data, but kinetic energy is physically associated with $u'_{k}$ rather than $c_{k}$.\n\nDefine two inner products on $\\mathbb{R}^{2}$:\n- The Euclidean inner product $\\langle a, b \\rangle = a^{\\top} b$.\n- The energy-weighted inner product $\\langle a, b \\rangle_{W} = a^{\\top} W b$ with $W = \\operatorname{diag}(\\alpha, 1)$ and $\\alpha = 0.01$, which downweights the passive scalar in proportion to its lack of physical relevance to kinetic energy.\n\nStarting from the definition of Proper Orthogonal Decomposition (POD) as the problem of finding directions that maximize the mean-square projection of the data subject to orthonormality in the chosen inner product, derive the leading POD mode under the Euclidean inner product and under the energy-weighted inner product. Then explain, from first principles, how and why the choice of inner product reorders the leading POD modes in this example, and discuss the implications this has for model reduction and for interpreting modes relative to Dynamic Mode Decomposition (DMD) (define the acronym and its core aim before discussing).\n\nReport the components of the leading POD modes as a single dimensionless row vector\n$$\n\\left((\\phi^{\\mathrm{E}}_{1})_{1},\\;(\\phi^{\\mathrm{E}}_{1})_{2},\\;(\\phi^{\\mathrm{W}}_{1})_{1},\\;(\\phi^{\\mathrm{W}}_{1})_{2}\\right),\n$$\nwhere $\\phi^{\\mathrm{E}}_{1}$ is the leading POD mode under the Euclidean inner product and $\\phi^{\\mathrm{W}}_{1}$ is the leading POD mode under the energy-weighted inner product. No rounding is required.",
            "solution": "The Proper Orthogonal Decomposition (POD) modes are the eigenvectors of the spatial correlation matrix, ranked by their corresponding eigenvalues which represent the captured energy.\n\n**1. Euclidean Inner Product**\nFor the Euclidean inner product, the POD modes are the eigenvectors of the correlation matrix $C_E = \\frac{1}{m} X X^\\top$, where $X$ is the data matrix whose columns are the snapshots. The leading mode corresponds to the largest eigenvalue. We can compute $XX^\\top$ without the scaling factor $1/m$, as it doesn't affect the eigenvectors.\n$$\nX = \\begin{pmatrix} 4  -4  3  0 \\\\ 0  0  0  1 \\end{pmatrix}\n$$\n$$\nX X^\\top = \\begin{pmatrix} 4  -4  3  0 \\\\ 0  0  0  1 \\end{pmatrix} \\begin{pmatrix} 4  0 \\\\ -4  0 \\\\ 3  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 4^2 + (-4)^2 + 3^2  0 \\\\ 0  1^2 \\end{pmatrix} = \\begin{pmatrix} 41  0 \\\\ 0  1 \\end{pmatrix}\n$$\nThis matrix is diagonal, so its eigenvalues are the diagonal entries, $\\lambda_1 = 41$ and $\\lambda_2 = 1$. The corresponding eigenvectors are the standard basis vectors. The leading mode corresponds to the largest eigenvalue, $\\lambda_1 = 41$. Its eigenvector is $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. This vector is already normalized in the Euclidean norm. Thus, the leading Euclidean POD mode is:\n$$\n\\phi^{\\mathrm{E}}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n\n**2. Energy-Weighted Inner Product**\nFor the weighted inner product $\\langle a, b \\rangle_W = a^\\top W b$, the POD modes solve a generalized eigenvalue problem. A standard approach is to transform the coordinates. Let $y = W^{1/2} x$ and $\\psi = W^{1/2} \\phi$. The problem becomes a standard POD problem for the transformed data $y_k$, finding the eigenvectors $\\psi$ of the new correlation matrix $C_y = \\frac{1}{m} Y Y^\\top = \\frac{1}{m} W^{1/2} X X^\\top W^{1/2}$.\nWith $W = \\text{diag}(0.01, 1)$, we have $W^{1/2} = \\text{diag}(0.1, 1)$.\n$$\nW^{1/2} (X X^\\top) W^{1/2} = \\begin{pmatrix} 0.1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 41  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0.1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0.1 \\cdot 41 \\cdot 0.1  0 \\\\ 0  1 \\cdot 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 0.41  0 \\\\ 0  1 \\end{pmatrix}\n$$\nThe eigenvalues of this new matrix are $\\lambda'_1 = 1$ and $\\lambda'_2 = 0.41$. The leading eigenvalue is now $\\lambda'_1 = 1$, and its corresponding eigenvector is $\\psi_1 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\nTo find the POD mode $\\phi^{\\mathrm{W}}_{1}$ in the original coordinates, we transform back: $\\phi^{\\mathrm{W}}_{1} = W^{-1/2} \\psi_1$.\n$$\n\\phi^{\\mathrm{W}}_{1} = \\begin{pmatrix} 1/0.1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 10  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\nWe must confirm this mode is normalized in the weighted norm: $\\|\\phi^{\\mathrm{W}}_{1}\\|_W^2 = (\\phi^{\\mathrm{W}}_{1})^\\top W \\phi^{\\mathrm{W}}_{1} = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 0.01  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 1$. It is correctly normalized.\n\n**3. Discussion**\nThe choice of inner product defines the \"energy\" that POD maximizes. The Euclidean inner product treats all components equally, so it identifies the direction of maximum variance, which is the $c_k$ axis (eigenvalue 41 vs. 1). The energy-weighted inner product, by heavily downweighting the $c_k$ component, redefines energy to be dominated by the velocity fluctuation $u'_k$. The weighted energy of the $u'_k$ component (eigenvalue 1) is now larger than that of the $c_k$ component (eigenvalue $41 \\times 0.01 = 0.41$). Consequently, the leading POD mode switches to the $u'_k$ axis.\n- **Implications for Model Reduction:** If a reduced-order model is built using the leading Euclidean POD mode, it would only capture the passive scalar dynamics, missing the kinetically energetic velocity fluctuations entirely. A model based on the physically-motivated weighted inner product correctly prioritizes the kinetically important velocity dynamics.\n- **Relation to DMD:** **Dynamic Mode Decomposition (DMD)** identifies modes with pure temporal dynamics (a single frequency and growth/decay rate). POD modes are ranked by energy. If a dynamically important phenomenon (which DMD would identify) has low energy, it might be missed by a truncated POD basis. Using a physical inner product for POD helps align its energy ranking with physical importance, making it more likely that the leading POD modes correspond to the dynamically significant modes identified by DMD.\n\nThe final answer vector is formed by concatenating the components of $\\phi^{\\mathrm{E}}_{1}$ and $\\phi^{\\mathrm{W}}_{1}$:\n$$\n\\left((\\phi^{\\mathrm{E}}_{1})_{1},\\;(\\phi^{\\mathrm{E}}_{1})_{2},\\;(\\phi^{\\mathrm{W}}_{1})_{1},\\;(\\phi^{\\mathrm{W}}_{1})_{2}\\right) = (1, 0, 0, 1)\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  0  0  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "In practical CFD applications, simulations are often performed on non-uniform meshes, where different spatial locations have different weights or volumes. To correctly account for this, POD is performed using a weighted inner product, often defined by a mass or mesh matrix. This practice  provides a concrete, hands-on calculation of how to apply the method of snapshots with a weighted inner product to determine the energy distribution among POD modes, a core skill for analyzing real-world simulation data.",
            "id": "3987548",
            "problem": "A high-fidelity computational fluid dynamics dataset for a two-dimensional compressible flow over a thin airfoil was reduced to two dominant fluctuation snapshots of the pressure field after subtracting the mean. The spatial discretization uses a nonuniform mesh, and the energy of a field $u \\in \\mathbb{R}^{n}$ is measured by the symmetric positive-definite matrix $M \\in \\mathbb{R}^{n \\times n}$ via the $M$-inner product $\\langle u, v \\rangle_{M} = u^{\\top} M v$ and the induced $M$-norm $\\|u\\|_{M} = \\sqrt{u^{\\top} M u}$. The proper orthogonal decomposition (POD) seeks modes that optimally capture snapshot energy in this weighted sense.\n\nConsider the following reduced setting in which the spatial dimension is $n = 2$ and the number of snapshots is $m = 2$. The mesh-weight matrix and the snapshot matrix are\n$$\nM = \\begin{pmatrix}\n4  0 \\\\\n0  1\n\\end{pmatrix}, \\qquad\nX = \\begin{pmatrix}\n1  1 \\\\\n0  2\n\\end{pmatrix},\n$$\nwhere the columns of $X$ are the two pressure fluctuation snapshots.\n\nUsing only the definitions of the $M$-inner product and the induced $M$-norm as the energetic measure, compute the singular values $\\sigma_{i}$ that characterize the POD under the $M$-inner product, and quantify the energy captured by each POD mode as $E_{i} = \\sigma_{i}^{2} / \\sum_{j=1}^{m} \\sigma_{j}^{2}$. Report only the fraction of energy captured by the leading POD mode, expressed as a single reduced exact analytic expression. Do not round your final result.",
            "solution": "The energy of the Proper Orthogonal Decomposition (POD) modes is determined by the eigenvalues of a temporal correlation matrix $K$, where the snapshot inner products are weighted by the matrix $M$. The squared singular values, $\\sigma_i^2$, are the eigenvalues of this matrix $K$.\n\n1.  **Construct the Temporal Correlation Matrix**\n    The method of snapshots uses the $m \\times m$ correlation matrix $K$, where the entries are the inner products of the snapshots: $K_{ij} = \\langle x_i, x_j \\rangle_M = x_i^\\top M x_j$. The full matrix can be computed as $K = X^\\top M X$.\n    Given:\n    $$\n    M = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix}, \\qquad X = \\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix}\n    $$\n    First, calculate $M X$:\n    $$\n    M X = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} (4)(1)+(0)(0)  (4)(1)+(0)(2) \\\\ (0)(1)+(1)(0)  (0)(1)+(1)(2) \\end{pmatrix} = \\begin{pmatrix} 4  4 \\\\ 0  2 \\end{pmatrix}\n    $$\n    Now, compute $K = X^\\top (M X)$:\n    $$\n    K = \\begin{pmatrix} 1  0 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 4  4 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} (1)(4)+(0)(0)  (1)(4)+(0)(2) \\\\ (1)(4)+(2)(0)  (1)(4)+(2)(2) \\end{pmatrix} = \\begin{pmatrix} 4  4 \\\\ 4  8 \\end{pmatrix}\n    $$\n\n2.  **Find the Eigenvalues of K**\n    The eigenvalues $\\lambda$ of $K$ are the squared singular values ($\\lambda_i = \\sigma_i^2$). We find them by solving the characteristic equation $\\det(K - \\lambda I) = 0$.\n    $$\n    \\det \\begin{pmatrix} 4 - \\lambda  4 \\\\ 4  8 - \\lambda \\end{pmatrix} = 0\n    $$\n    $$\n    (4 - \\lambda)(8 - \\lambda) - (4)(4) = 0\n    $$\n    $$\n    32 - 12\\lambda + \\lambda^2 - 16 = 0\n    $$\n    $$\n    \\lambda^2 - 12\\lambda + 16 = 0\n    $$\n    Using the quadratic formula $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n    $$\n    \\lambda = \\frac{12 \\pm \\sqrt{(-12)^2 - 4(1)(16)}}{2} = \\frac{12 \\pm \\sqrt{144 - 64}}{2} = \\frac{12 \\pm \\sqrt{80}}{2}\n    $$\n    Simplifying $\\sqrt{80} = \\sqrt{16 \\times 5} = 4\\sqrt{5}$:\n    $$\n    \\lambda = \\frac{12 \\pm 4\\sqrt{5}}{2} = 6 \\pm 2\\sqrt{5}\n    $$\n    The two eigenvalues (squared singular values) are $\\sigma_1^2 = 6 + 2\\sqrt{5}$ (for the leading mode) and $\\sigma_2^2 = 6 - 2\\sqrt{5}$.\n\n3.  **Calculate the Energy Fraction**\n    The total energy is the sum of the eigenvalues: $\\sum \\sigma_j^2 = (6 + 2\\sqrt{5}) + (6 - 2\\sqrt{5}) = 12$. (This also matches the trace of $K$, $\\text{tr}(K)=4+8=12$, as expected).\n    The fraction of energy captured by the leading POD mode is $E_1$:\n    $$\n    E_1 = \\frac{\\sigma_1^2}{\\sum \\sigma_j^2} = \\frac{6 + 2\\sqrt{5}}{12}\n    $$\n    Simplifying the expression gives:\n    $$\n    E_1 = \\frac{2(3 + \\sqrt{5})}{12} = \\frac{3 + \\sqrt{5}}{6}\n    $$",
            "answer": "$$\n\\boxed{\\frac{3 + \\sqrt{5}}{6}}\n$$"
        },
        {
            "introduction": "While POD provides an optimal basis for representing the energy of a system, Dynamic Mode Decomposition (DMD) offers a complementary perspective by identifying modes with coherent temporal behavior—each characterized by a single frequency and growth or decay rate. The power of DMD lies in translating its mathematical output (eigenvalues of a linear map) into these physical characteristics. This exercise  guides you through this critical interpretation step, showing how to extract the dynamic \"fingerprint\" of flow structures from DMD eigenvalues and determine whether they represent stable, decaying phenomena or growing instabilities.",
            "id": "3987563",
            "problem": "An unsteady separated flow past a pitching airfoil is simulated using the incompressible Navier–Stokes equations in a high-fidelity Computational Fluid Dynamics (CFD) solver. A sequence of velocity-field snapshots is collected at uniform sampling interval $\\Delta t$ from a statistically stationary regime. The snapshots are assembled into a snapshot matrix in the spirit of Proper Orthogonal Decomposition (POD), and a Dynamic Mode Decomposition (DMD) is performed to approximate the one-step linear flow map that advances the state by $\\Delta t$.\n\nAssume the flow evolution over short times is well-approximated by a linear operator advancing the state according to a discrete-time map derived from the continuous-time dynamics, and that DMD computes eigenvalues $\\lambda$ of this map. Consider three dominant DMD modes whose eigenvalues, extracted from the CFD snapshot sequence sampled at $\\Delta t = 0.005$ $\\mathrm{s}$, are\n$$\n\\lambda_{1} = 1.02 \\exp(i\\,0.40),\\quad\n\\lambda_{2} = 0.98 \\exp(i\\,2.30),\\quad\n\\lambda_{3} = 0.995 \\exp(-i\\,0.05),\n$$\nwhere $i$ denotes the imaginary unit and each complex argument is taken in the principal range $(-\\pi,\\pi]$.\n\nStarting from the definition of the discrete-time flow map and its relationship to the continuous-time generator of the dynamics, translate each DMD eigenvalue $\\lambda_{j}$ to its corresponding continuous-time exponential growth or decay rate $\\sigma_{j}$ (in $\\mathrm{s}^{-1}$) and signed oscillation frequency $f_{j}$ (in $\\mathrm{Hz}$). Use the principal branch of the complex logarithm in this translation. Then, interpret for each mode whether the dynamics is unstable, neutrally stable, or damped based on the sign of $\\sigma_{j}$, and whether it is oscillatory and at what signed frequency.\n\nRound all reported numerical values for $\\sigma_{j}$ and $f_{j}$ to four significant figures. Express frequencies in $\\mathrm{Hz}$ and growth/decay rates in $\\mathrm{s}^{-1}$. Your final answer must provide, in order, the six numbers $\\sigma_{1}, f_{1}, \\sigma_{2}, f_{2}, \\sigma_{3}, f_{3}$.",
            "solution": "The goal is to convert discrete-time DMD eigenvalues ($\\lambda_j$) into continuous-time dynamic properties: the growth/decay rate ($\\sigma_j$) and the oscillation frequency ($f_j$).\n\nThe relationship between a discrete-time DMD eigenvalue $\\lambda_j$ and its continuous-time counterpart $\\omega_j$ is given by $\\lambda_j = \\exp(\\omega_j \\Delta t)$, where $\\Delta t$ is the sampling interval. The continuous-time eigenvalue $\\omega_j$ can be written as $\\omega_j = \\sigma_j + i \\Omega_j$, where $\\sigma_j$ is the growth rate and $\\Omega_j = 2\\pi f_j$ is the angular frequency.\n\nTo find $\\omega_j$, we take the natural logarithm of the equation:\n$$ \\omega_j = \\frac{\\ln(\\lambda_j)}{\\Delta t} $$\nUsing the polar representation of the DMD eigenvalue, $\\lambda_j = |\\lambda_j| \\exp(i\\theta_j)$, the logarithm becomes $\\ln(\\lambda_j) = \\ln(|\\lambda_j|) + i\\theta_j$. Substituting this in, we get:\n$$ \\omega_j = \\sigma_j + i(2\\pi f_j) = \\frac{\\ln(|\\lambda_j|)}{\\Delta t} + i \\frac{\\theta_j}{\\Delta t} $$\nFrom this, we can extract the formulas for the growth rate and frequency:\n$$ \\sigma_j = \\frac{\\ln(|\\lambda_j|)}{\\Delta t} \\quad (\\text{in } s^{-1}) $$\n$$ f_j = \\frac{\\theta_j}{2\\pi \\Delta t} \\quad (\\text{in } Hz) $$\nWe are given $\\Delta t = 0.005$ s. Now we apply these formulas to each eigenvalue.\n\n**Mode 1:** $\\lambda_1 = 1.02 \\exp(i\\,0.40)$\n-   Magnitude $|\\lambda_1| = 1.02$, Argument $\\theta_1 = 0.40$.\n-   Growth rate: $\\sigma_1 = \\frac{\\ln(1.02)}{0.005} \\approx \\frac{0.0198026}{0.005} \\approx 3.9605 \\text{ s}^{-1}$.\n-   Frequency: $f_1 = \\frac{0.40}{2\\pi(0.005)} = \\frac{0.40}{0.01\\pi} \\approx 12.7324 \\text{ Hz}$.\n-   **Interpretation:** Since $\\sigma_1 > 0$ ($|\\lambda_1| > 1$), this mode is **unstable** and grows exponentially. It oscillates at approximately $12.73 \\text{ Hz}$.\n\n**Mode 2:** $\\lambda_2 = 0.98 \\exp(i\\,2.30)$\n-   Magnitude $|\\lambda_2| = 0.98$, Argument $\\theta_2 = 2.30$.\n-   Growth rate: $\\sigma_2 = \\frac{\\ln(0.98)}{0.005} \\approx \\frac{-0.0202027}{0.005} \\approx -4.0405 \\text{ s}^{-1}$.\n-   Frequency: $f_2 = \\frac{2.30}{2\\pi(0.005)} = \\frac{2.30}{0.01\\pi} \\approx 73.2051 \\text{ Hz}$.\n-   **Interpretation:** Since $\\sigma_2  0$ ($|\\lambda_2|  1$), this mode is **damped** (stable) and decays exponentially. It oscillates at approximately $73.21 \\text{ Hz}$.\n\n**Mode 3:** $\\lambda_3 = 0.995 \\exp(-i\\,0.05)$\n-   Magnitude $|\\lambda_3| = 0.995$, Argument $\\theta_3 = -0.05$.\n-   Growth rate: $\\sigma_3 = \\frac{\\ln(0.995)}{0.005} \\approx \\frac{-0.0050125}{0.005} \\approx -1.0025 \\text{ s}^{-1}$.\n-   Frequency: $f_3 = \\frac{-0.05}{2\\pi(0.005)} = \\frac{-0.05}{0.01\\pi} \\approx -1.5915 \\text{ Hz}$.\n-   **Interpretation:** Since $\\sigma_3  0$ ($|\\lambda_3|  1$), this mode is also **damped** (stable). It oscillates with a signed frequency of approximately $-1.592 \\text{ Hz}$.\n\nRounding the results to four significant figures, the six requested numbers are:\n- $\\sigma_1 = 3.961$\n- $f_1 = 12.73$\n- $\\sigma_2 = -4.041$\n- $f_2 = 73.21$\n- $\\sigma_3 = -1.003$\n- $f_3 = -1.592$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 3.961  12.73  -4.041  73.21  -1.003  -1.592 \\end{pmatrix}}\n$$"
        }
    ]
}