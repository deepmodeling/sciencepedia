{
    "hands_on_practices": [
        {
            "introduction": "在计算流体力学（CFD）中，任何仿真结果都包含数值误差。在对模型输入或参数进行不确定性量化（UQ）之前，我们必须首先通过一个称为“解验证”的过程来理解并量化由网格离散化引起的误差。理查森外推法（Richardson extrapolation）是这一过程的基石，它使我们能够利用在一系列系统加密的网格上得到的解，来估计无网格影响下的连续介质解$Q_0$以及仿真实践中观察到的收敛阶$p$ 。这项练习将通过从基本原理出发推导这些关键公式，来加深您对离散化误差量化的理解。",
            "id": "4002936",
            "problem": "执行航空航天计算流体动力学 (CFD) 仿真，模拟二维翼型周围的可压缩粘性流，以估计工程上关注的标量输出量，记为 $Q$，例如升力系数。在渐近网格收敛区域，离散误差由截断误差的主阶项建模，因此在特征网格尺寸为 $h$ 的网格上的输出遵循\n$$\nQ(h) \\;=\\; Q_{0} \\;+\\; C\\, h^{p},\n$$\n其中 $Q_{0}$ 是连续介质（网格无关）值，$C$ 是一个依赖于解和格式的未知常数，$p$ 是数值方法对输出量 $Q$ 的形式精度阶。\n\n您在三个系统加密的几何相似网格上运行求解器，其特征尺寸为 $h_{1}  h_{2}  h_{3}$，且具有均匀加密比 $r$，使得 $r = h_{1}/h_{2} = h_{2}/h_{3}  1$。将计算出的输出记为 $Q_{1} = Q(h_{1})$、$Q_{2} = Q(h_{2})$ 和 $Q_{3} = Q(h_{3})$。\n\n仅从误差模型 $Q(h) = Q_{0} + C\\, h^{p}$ 和均匀加密比 $r$ 的定义出发，执行以下操作：\n\n- 使用两个连续的网格层级 $h$ 和 $h/r$，推导 $Q_{0}$ 的理查森外推表达式，该表达式用 $Q(h)$、$Q(h/r)$、$p$ 和 $r$ 表示。\n- 使用三个网格层级 $h_{1}$、$h_{2}$、$h_{3}$ 及其对应的输出 $Q_{1}$、$Q_{2}$、$Q_{3}$ 和已知的加密比 $r$，推导一个用于估计精度阶 $p$ 的闭式表达式。\n- 结合这些结果，得到一个仅用 $Q_{1}$、$Q_{2}$ 和 $Q_{3}$ 表示的 $Q_{0}$ 的闭式表达式，并显式地消去 $C$ 和 $p$。\n\n以单行矩阵的形式提供您的最终答案，其元素为 $\\left[ Q_{0},\\, p \\right]$，写成用 $Q_{1}$、$Q_{2}$、$Q_{3}$ 和 $r$ 表示的闭式解析表达式。不要进行数值计算。不需要四舍五入，最终表达式中不应包含单位。",
            "solution": "问题陈述已经过严格审查，并被认定为有效。它在科学上基于数值分析的公认原理，特别是用于估计计算模拟中离散误差的理查森外推法。该问题是适定的、客观的，并提供了执行所需推导的所有必要信息。它不包含任何科学缺陷、歧义或矛盾。\n\n分析过程是通过对给定的误差模型 $Q(h) = Q_{0} + C h^{p}$ 在三个指定的网格层级上进行代数操作。\n\n首先，我们来推导使用在两个加密比为 $r$ 的网格上获得的两个解 $Q(h)$ 和 $Q(h/r)$ 来计算连续介质值 $Q_{0}$ 的通用理查森外推表达式。\n误差模型为这两个网格提供了两个方程：\n$$\nQ(h) = Q_{0} + C h^{p} \\quad (1)\n$$\n$$\nQ(h/r) = Q_{0} + C (h/r)^{p} = Q_{0} + \\frac{C h^{p}}{r^{p}} \\quad (2)\n$$\n我们的目标是消去未知项 $C h^{p}$。从方程 $(1)$，我们可以将此项表示为：\n$$\nC h^{p} = Q(h) - Q_{0}\n$$\n将此式代入方程 $(2)$ 可得：\n$$\nQ(h/r) = Q_{0} + \\frac{Q(h) - Q_{0}}{r^{p}}\n$$\n现在我们求解这个关于 $Q_{0}$ 的方程。两边同乘以 $r^{p}$ 得到：\n$$\nr^{p} Q(h/r) = r^{p} Q_{0} + Q(h) - Q_{0}\n$$\n整理各项以分离 $Q_{0}$：\n$$\nr^{p} Q(h/r) - Q(h) = Q_{0} (r^{p} - 1)\n$$\n这给出了 $Q_{0}$ 的理查森外推公式：\n$$\nQ_{0} = \\frac{r^{p} Q(h/r) - Q(h)}{r^{p} - 1}\n$$\n该表达式也可以写成 $Q_{0} = Q(h/r) + \\frac{Q(h/r) - Q(h)}{r^{p} - 1}$。至此完成了第一个要求的推导。\n\n其次，我们使用三个解 $Q_{1}$、$Q_{2}$ 和 $Q_{3}$ 推导观测到的精度阶 $p$ 的闭式表达式。我们为三个网格中的每一个写出误差模型：\n$$\nQ_{1} = Q(h_{1}) = Q_{0} + C h_{1}^{p} \\quad (3)\n$$\n$$\nQ_{2} = Q(h_{2}) = Q_{0} + C h_{2}^{p} \\quad (4)\n$$\n$$\nQ_{3} = Q(h_{3}) = Q_{0} + C h_{3}^{p} \\quad (5)\n$$\n我们考虑连续网格上解的差值以消去 $Q_{0}$：\n$$\nQ_{1} - Q_{2} = (Q_{0} + C h_{1}^{p}) - (Q_{0} + C h_{2}^{p}) = C (h_{1}^{p} - h_{2}^{p})\n$$\n$$\nQ_{2} - Q_{3} = (Q_{0} + C h_{2}^{p}) - (Q_{0} + C h_{3}^{p}) = C (h_{2}^{p} - h_{3}^{p})\n$$\n使用均匀加密比的定义 $r = h_{1}/h_{2} = h_{2}/h_{3}$，我们可以写出 $h_{1} = r h_{2}$ 和 $h_{2} = r h_{3}$。将这些代入差分方程：\n$$\nQ_{1} - Q_{2} = C ((r h_{2})^{p} - h_{2}^{p}) = C h_{2}^{p} (r^{p} - 1)\n$$\n$$\nQ_{2} - Q_{3} = C (h_{2}^{p} - (h_{2}/r)^{p}) = C \\frac{h_{2}^{p}}{r^{p}} (r^{p} - 1)\n$$\n现在，我们取这两个差值的比率，以消去 $C$ 和项 $(r^{p}-1)$：\n$$\n\\frac{Q_{1} - Q_{2}}{Q_{2} - Q_{3}} = \\frac{C h_{2}^{p} (r^{p} - 1)}{C \\frac{h_{2}^{p}}{r^{p}} (r^{p} - 1)}\n$$\n假设 $C \\neq 0$，$r^{p} \\neq 1$ 且 $Q_{2} \\neq Q_{3}$，这些项可以消去，剩下：\n$$\n\\frac{Q_{1} - Q_{2}}{Q_{2} - Q_{3}} = r^{p}\n$$\n为了解出 $p$，我们对两边取自然对数：\n$$\n\\ln\\left(\\frac{Q_{1} - Q_{2}}{Q_{2} - Q_{3}}\\right) = \\ln(r^{p}) = p \\ln(r)\n$$\n因此，观测到的精度阶的表达式为：\n$$\np = \\frac{\\ln\\left(\\frac{Q_{1} - Q_{2}}{Q_{2} - Q_{3}}\\right)}{\\ln(r)}\n$$\n至此完成了第二个要求的推导。\n\n第三，我们结合之前的结果，得到一个仅用 $Q_{1}$、$Q_{2}$ 和 $Q_{3}$ 表示的 $Q_{0}$ 的闭式表达式。我们使用前面推导的理查森外推公式，应用于两个最密的网格，即 $h=h_{2}$ 和 $h/r=h_{3}$。在这种情况下，$Q(h) = Q_{2}$ 且 $Q(h/r) = Q_{3}$：\n$$\nQ_{0} = \\frac{r^{p} Q_{3} - Q_{2}}{r^{p} - 1}\n$$\n现在我们代入在推导 $p$ 的过程中找到的 $r^{p}$ 的表达式：\n$$\nr^{p} = \\frac{Q_{1} - Q_{2}}{Q_{2} - Q_{3}}\n$$\n将此代入 $Q_{0}$ 的方程中：\n$$\nQ_{0} = \\frac{\\left(\\frac{Q_{1} - Q_{2}}{Q_{2} - Q_{3}}\\right) Q_{3} - Q_{2}}{\\left(\\frac{Q_{1} - Q_{2}}{Q_{2} - Q_{3}}\\right) - 1}\n$$\n为了简化这个繁分数，我们将分子和分母同乘以 $(Q_{2} - Q_{3})$：\n$$\nQ_{0} = \\frac{(Q_{1} - Q_{2}) Q_{3} - Q_{2} (Q_{2} - Q_{3})}{(Q_{1} - Q_{2}) - (Q_{2} - Q_{3})}\n$$\n展开分子和分母中的各项：\n$$\nQ_{0} = \\frac{Q_{1} Q_{3} - Q_{2} Q_{3} - Q_{2}^{2} + Q_{2} Q_{3}}{Q_{1} - 2 Q_{2} + Q_{3}}\n$$\n分子中的项 $Q_{2} Q_{3}$ 相互抵消，得到连续介质值 $Q_{0}$ 的最终紧凑表达式：\n$$\nQ_{0} = \\frac{Q_{1} Q_{3} - Q_{2}^{2}}{Q_{1} - 2 Q_{2} + Q_{3}}\n$$\n至此完成了最后一个要求的推导。$p$ 和 $Q_0$ 的结果作为最终答案提供。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{Q_1 Q_3 - Q_2^2}{Q_1 - 2Q_2 + Q_3}  \\frac{\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)}{\\ln(r)} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在量化了数值不确定性之后，下一步是处理模型输入中的不确定性，例如边界条件或材料属性的变化。多项式混沌展开（Polynomial Chaos Expansion, PCE）是一种功能强大的非侵入式方法，用于将复杂的CFD模型响应表示为关于随机输入的谱展开。通过这种方式，我们可以创建一个易于处理的代理模型，从而高效地计算输出量的统计矩（如均值和方差）。这项练习将指导您使用非侵入式谱投影和高斯-埃尔米特求积法，为一个给定的二维不确定性问题构建PCE ，这是现代UQ实践中的一项核心技能。",
            "id": "4002899",
            "problem": "考虑一个针对跨音速翼型的二维航空航天计算流体动力学 (CFD) 不确定性量化问题，其中目标量 $u$（例如，来自雷诺平均纳维-斯托克斯 (RANS) 求解器的翼段升力系数）取决于两个独立的随机输入 $\\xi_{1}$ 和 $\\xi_{2}$，它们分别代表攻角和自由来流马赫数的标准化变异。假设 $\\xi_{1} \\sim \\mathcal{N}(0,1)$，$\\xi_{2} \\sim \\mathcal{N}(0,1)$，并且 $\\xi_{1}$ 和 $\\xi_{2}$ 是独立的。CFD 响应的局部多项式代理模型由下式给出：\n$$\nu(\\xi_{1},\\xi_{2}) \\;=\\; 0.32 \\;+\\; 0.12\\,\\xi_{1} \\;-\\; 0.08\\,\\xi_{2} \\;+\\; 0.05\\,\\xi_{1}^{2} \\;+\\; 0.09\\,\\xi_{1}\\xi_{2} \\;-\\; 0.04\\,\\xi_{2}^{2}.\n$$\n使用由概率论埃尔米特多项式的张量积构成的标准正交基，构建 $u$ 的一个总阶最高为 $2$ 的多项式混沌展开 (PCE)。在一维情况下，基函数为 $\\psi_{0}(\\xi)=1$，$\\psi_{1}(\\xi)=\\xi$ 和 $\\psi_{2}(\\xi)=\\frac{\\xi^{2}-1}{\\sqrt{2}}$；在二维情况下，对于多重索引 $\\alpha=(\\alpha_{1},\\alpha_{2})$，基函数为 $\\psi_{\\alpha}(\\xi_{1},\\xi_{2})=\\psi_{\\alpha_{1}}(\\xi_{1})\\,\\psi_{\\alpha_{2}}(\\xi_{2})$。使用非侵入式谱投影方法，计算总阶最高为 $2$ 的六个系数，对应于多重索引 $\\alpha \\in \\{(0,0),(1,0),(0,1),(2,0),(1,1),(0,2)\\}$。\n\n为近似计算定义谱投影的期望值，请在每个维度上使用适用于标准正态权重的3阶张量积高斯-埃尔米特求积法。对于每个一维标准正态变量，使用节点和权重\n$$\n\\xi \\in \\{-\\sqrt{3},\\,0,\\,\\sqrt{3}\\}, \\quad w \\in \\left\\{\\tfrac{1}{6},\\,\\tfrac{2}{3},\\,\\tfrac{1}{6}\\right\\},\n$$\n并通过张量积形成具有乘积权重的二维求积法则。将最终答案表示为 PCE 系数的行向量\n$$\n\\left(c_{00},\\,c_{10},\\,c_{01},\\,c_{20},\\,c_{11},\\,c_{02}\\right),\n$$\n不带单位。无需四舍五入，请提供精确值。",
            "solution": "用户希望我严格验证所提供的问题陈述，如果有效，则进行求解。\n\n### 步骤 1：提取已知条件\n-   **目标量**：一个 CFD 响应 $u(\\xi_{1},\\xi_{2})$，由以下多项式代理模型给出：\n    $$u(\\xi_{1},\\xi_{2}) = 0.32 + 0.12\\xi_{1} - 0.08\\xi_{2} + 0.05\\xi_{1}^{2} + 0.09\\xi_{1}\\xi_{2} - 0.04\\xi_{2}^{2}$$\n-   **随机输入**：两个独立的随机变量 $\\xi_{1}$ 和 $\\xi_{2}$，均服从标准正态分布，即 $\\xi_{1} \\sim \\mathcal{N}(0,1)$ 和 $\\xi_{2} \\sim \\mathcal{N}(0,1)$。\n-   **任务**：构建 $u$ 的一个总阶最高为 $2$ 的多项式混沌展开 (PCE)。\n-   **PCE 基**：由一维概率论埃尔米特多项式的张量积构成的标准正交基。\n    -   一维基：$\\psi_{0}(\\xi)=1$，$\\psi_{1}(\\xi)=\\xi$，$\\psi_{2}(\\xi)=\\frac{\\xi^{2}-1}{\\sqrt{2}}$。\n    -   二维基：对于多重索引 $\\alpha=(\\alpha_{1},\\alpha_{2})$，有 $\\psi_{\\alpha}(\\xi_{1},\\xi_{2})=\\psi_{\\alpha_{1}}(\\xi_{1})\\,\\psi_{\\alpha_{2}}(\\xi_{2})$。\n-   **待计算系数**：总阶 $|\\alpha| = \\alpha_1+\\alpha_2 \\le 2$ 的六个系数 $c_{\\alpha}$，其中 $\\alpha \\in \\{(0,0),(1,0),(0,1),(2,0),(1,1),(0,2)\\}$。\n-   **方法论**：“非侵入式谱投影”。\n-   **数值积分**：每个维度上3阶的张量积高斯-埃尔米特求积法。\n    -   一维节点：$\\xi \\in \\{-\\sqrt{3},\\,0,\\,\\sqrt{3}\\}$。\n    -   一维权重（对于标准正态测度）：$w \\in \\left\\{\\frac{1}{6},\\,\\frac{2}{3},\\,\\frac{1}{6}\\right\\}$。\n-   **最终答案格式**：一个包含六个系数 $(c_{00},\\,c_{10},\\,c_{01},\\,c_{20},\\,c_{11},\\,c_{02})$ 的行向量，值为精确值。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是多项式混沌展开在不确定性量化中的一个标准应用，这在计算科学和工程领域是一个成熟的方法。对于高斯随机变量使用埃尔米特多项式是理论上正确的选择。该问题是合理的。\n2.  **良态性**：问题陈述清晰。目标是找到 PCE 的系数。函数、输入的概率分布、基多项式以及计算系数的方法都已明确定义。\n3.  **客观性**：问题以客观的数学语言陈述。没有使用主观或模棱两可的术语。\n4.  **完整性**：所有必要信息均已提供。给出了 $u$ 的代理模型，$\\xi_1$ 和 $\\xi_2$ 的分布，基函数以及具体的数值求积法则。没有矛盾之处。\n5.  **一致性检查**：问题指定了一个3点高斯-埃尔米特求积法则。一维 $N$ 点高斯-埃尔米特法则对于最高次数为 $2N-1$ 的多项式是精确的。这里 $N=3$，所以一维法则对于最高次数为 $2(3)-1=5$ 的多项式是精确的。相应的张量积法则对于 $(\\xi_1, \\xi_2)$ 中的多项式是精确的，其中每个变量的最高次数最多为 $5$。系数是通过积分 $u \\cdot \\psi_{\\alpha}$ 来计算的。任何被积函数中任何变量的最高次数是 $4$（例如，在 $u \\cdot \\psi_{20}$ 中，出现了 $\\xi_1^2 \\cdot \\xi_1^2 = \\xi_1^4$ 项）。由于 $4 \\le 5$，所规定的求积法则对所有需要的积分都是精确的。这使得该问题完全一致且良态。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它具有科学依据、良态、客观且信息自足。我将继续进行求解。\n\n$u(\\xi_1, \\xi_2)$ 的多项式混沌展开由下式给出\n$$u(\\xi_1, \\xi_2) = \\sum_{\\alpha \\in \\mathbb{N}_0^2} c_{\\alpha} \\psi_{\\alpha}(\\xi_1, \\xi_2)$$\n其中 $\\psi_{\\alpha}$ 是标准正交基多项式。系数 $c_{\\alpha}$ 使用非侵入式谱投影确定，该方法依赖于基函数的正交性：\n$$c_{\\alpha} = \\mathbb{E}[u(\\xi_1, \\xi_2) \\psi_{\\alpha}(\\xi_1, \\xi_2)] = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} u(\\xi_1, \\xi_2) \\psi_{\\alpha}(\\xi_1, \\xi_2) \\frac{1}{2\\pi} \\exp\\left(-\\frac{\\xi_1^2+\\xi_2^2}{2}\\right) d\\xi_1 d\\xi_2$$\n正如在验证中所确立的，指定的3点张量积高斯-埃尔米特求积法对于这些积分是精确的。一种等效且更直接的方法是使用标准正态分布的矩来解析地计算这些期望值，这同样能得到精确结果。\n\n随机变量 $\\xi_1$ 和 $\\xi_2$ 是独立的标准正态变量，$\\mathcal{N}(0,1)$。它们的矩为：\n- $\\mathbb{E}[\\xi_i] = 0$\n- $\\mathbb{E}[\\xi_i^2] = 1$\n- $\\mathbb{E}[\\xi_i^3] = 0$\n- $\\mathbb{E}[\\xi_i^4] = 3$\n- 由于独立性，对于 $i \\neq j$，有 $\\mathbb{E}[\\xi_i^m \\xi_j^n] = \\mathbb{E}[\\xi_i^m]\\mathbb{E}[\\xi_j^n]$。\n\n总阶最高为 $2$ 的基多项式为：\n- $\\psi_{(0,0)}(\\xi_1,\\xi_2) = \\psi_0(\\xi_1)\\psi_0(\\xi_2) = 1 \\cdot 1 = 1$\n- $\\psi_{(1,0)}(\\xi_1,\\xi_2) = \\psi_1(\\xi_1)\\psi_0(\\xi_2) = \\xi_1 \\cdot 1 = \\xi_1$\n- $\\psi_{(0,1)}(\\xi_1,\\xi_2) = \\psi_0(\\xi_1)\\psi_1(\\xi_2) = 1 \\cdot \\xi_2 = \\xi_2$\n- $\\psi_{(2,0)}(\\xi_1,\\xi_2) = \\psi_2(\\xi_1)\\psi_0(\\xi_2) = \\frac{\\xi_1^2 - 1}{\\sqrt{2}}$\n- $\\psi_{(1,1)}(\\xi_1,\\xi_2) = \\psi_1(\\xi_1)\\psi_1(\\xi_2) = \\xi_1 \\xi_2$\n- $\\psi_{(0,2)}(\\xi_1,\\xi_2) = \\psi_0(\\xi_1)\\psi_2(\\xi_2) = \\frac{\\xi_2^2 - 1}{\\sqrt{2}}$\n\n现在我们通过取期望来计算每个系数。\n\n**系数 $c_{00}$：**\n$c_{00} = \\mathbb{E}[u \\cdot \\psi_{(0,0)}] = \\mathbb{E}[u] = \\mathbb{E}[0.32 + 0.12\\xi_1 - 0.08\\xi_2 + 0.05\\xi_1^2 + 0.09\\xi_1\\xi_2 - 0.04\\xi_2^2]$\n利用期望的线性性质：\n$c_{00} = 0.32 + 0.12\\mathbb{E}[\\xi_1] - 0.08\\mathbb{E}[\\xi_2] + 0.05\\mathbb{E}[\\xi_1^2] + 0.09\\mathbb{E}[\\xi_1]\\mathbb{E}[\\xi_2] - 0.04\\mathbb{E}[\\xi_2^2]$\n$c_{00} = 0.32 + 0.12(0) - 0.08(0) + 0.05(1) + 0.09(0)(0) - 0.04(1) = 0.32 + 0.05 - 0.04 = 0.33$\n\n**系数 $c_{10}$：**\n$c_{10} = \\mathbb{E}[u \\cdot \\psi_{(1,0)}] = \\mathbb{E}[u \\xi_1] = \\mathbb{E}[(0.32 + 0.12\\xi_1 - 0.08\\xi_2 + 0.05\\xi_1^2 + 0.09\\xi_1\\xi_2 - 0.04\\xi_2^2)\\xi_1]$\n$c_{10} = \\mathbb{E}[0.32\\xi_1 + 0.12\\xi_1^2 - 0.08\\xi_1\\xi_2 + 0.05\\xi_1^3 + 0.09\\xi_1^2\\xi_2 - 0.04\\xi_1\\xi_2^2]$\n只有每个变量均为偶次幂的项才具有非零期望。唯一这样的项是 $0.12\\xi_1^2$。\n$c_{10} = 0.12\\mathbb{E}[\\xi_1^2] = 0.12(1) = 0.12$\n\n**系数 $c_{01}$：**\n$c_{01} = \\mathbb{E}[u \\cdot \\psi_{(0,1)}] = \\mathbb{E}[u \\xi_2] = \\mathbb{E}[(0.32 + 0.12\\xi_1 - 0.08\\xi_2 + 0.05\\xi_1^2 + 0.09\\xi_1\\xi_2 - 0.04\\xi_2^2)\\xi_2]$\n$c_{01} = \\mathbb{E}[0.32\\xi_2 + 0.12\\xi_1\\xi_2 - 0.08\\xi_2^2 + 0.05\\xi_1^2\\xi_2 + 0.09\\xi_1\\xi_2^2 - 0.04\\xi_2^3]$\n唯一具有非零期望的项是 $-0.08\\xi_2^2$。\n$c_{01} = -0.08\\mathbb{E}[\\xi_2^2] = -0.08(1) = -0.08$\n\n**系数 $c_{20}$：**\n$c_{20} = \\mathbb{E}[u \\cdot \\psi_{(2,0)}] = \\mathbb{E}\\left[u \\frac{\\xi_1^2 - 1}{\\sqrt{2}}\\right] = \\frac{1}{\\sqrt{2}}(\\mathbb{E}[u\\xi_1^2] - \\mathbb{E}[u])$\n我们已经求得 $\\mathbb{E}[u] = c_{00} = 0.33$。我们需要计算 $\\mathbb{E}[u\\xi_1^2]$。\n$\\mathbb{E}[u\\xi_1^2] = \\mathbb{E}[(0.32 + 0.12\\xi_1 - 0.08\\xi_2 + 0.05\\xi_1^2 + 0.09\\xi_1\\xi_2 - 0.04\\xi_2^2)\\xi_1^2]$\n$\\mathbb{E}[u\\xi_1^2] = \\mathbb{E}[0.32\\xi_1^2 + 0.05\\xi_1^4 - 0.04\\xi_1^2\\xi_2^2]$ (只保留偶次幂项)\n$\\mathbb{E}[u\\xi_1^2] = 0.32\\mathbb{E}[\\xi_1^2] + 0.05\\mathbb{E}[\\xi_1^4] - 0.04\\mathbb{E}[\\xi_1^2]\\mathbb{E}[\\xi_2^2]$\n$\\mathbb{E}[u\\xi_1^2] = 0.32(1) + 0.05(3) - 0.04(1)(1) = 0.32 + 0.15 - 0.04 = 0.43$\n$c_{20} = \\frac{1}{\\sqrt{2}}(0.43 - 0.33) = \\frac{0.1}{\\sqrt{2}} = \\frac{0.1\\sqrt{2}}{2} = 0.05\\sqrt{2}$\n\n**系数 $c_{11}$：**\n$c_{11} = \\mathbb{E}[u \\cdot \\psi_{(1,1)}] = \\mathbb{E}[u \\xi_1 \\xi_2] = \\mathbb{E}[(0.32 + 0.12\\xi_1 - 0.08\\xi_2 + 0.05\\xi_1^2 + 0.09\\xi_1\\xi_2 - 0.04\\xi_2^2)\\xi_1\\xi_2]$\n$c_{11} = \\mathbb{E}[0.09\\xi_1^2\\xi_2^2]$ (只保留两个变量均为偶次幂的项)\n$c_{11} = 0.09\\mathbb{E}[\\xi_1^2]\\mathbb{E}[\\xi_2^2] = 0.09(1)(1) = 0.09$\n\n**系数 $c_{02}$：**\n$c_{02} = \\mathbb{E}[u \\cdot \\psi_{(0,2)}] = \\mathbb{E}\\left[u \\frac{\\xi_2^2 - 1}{\\sqrt{2}}\\right] = \\frac{1}{\\sqrt{2}}(\\mathbb{E}[u\\xi_2^2] - \\mathbb{E}[u])$\n我们有 $\\mathbb{E}[u] = 0.33$。我们需要计算 $\\mathbb{E}[u\\xi_2^2]$。\n$\\mathbb{E}[u\\xi_2^2] = \\mathbb{E}[(0.32 + 0.12\\xi_1 - 0.08\\xi_2 + 0.05\\xi_1^2 + 0.09\\xi_1\\xi_2 - 0.04\\xi_2^2)\\xi_2^2]$\n$\\mathbb{E}[u\\xi_2^2] = \\mathbb{E}[0.32\\xi_2^2 + 0.05\\xi_1^2\\xi_2^2 - 0.04\\xi_2^4]$ (只保留偶次幂项)\n$\\mathbb{E}[u\\xi_2^2] = 0.32\\mathbb{E}[\\xi_2^2] + 0.05\\mathbb{E}[\\xi_1^2]\\mathbb{E}[\\xi_2^2] - 0.04\\mathbb{E}[\\xi_2^4]$\n$\\mathbb{E}[u\\xi_2^2] = 0.32(1) + 0.05(1)(1) - 0.04(3) = 0.32 + 0.05 - 0.12 = 0.25$\n$c_{02} = \\frac{1}{\\sqrt{2}}(0.25 - 0.33) = \\frac{-0.08}{\\sqrt{2}} = -\\frac{0.08\\sqrt{2}}{2} = -0.04\\sqrt{2}$\n\n计算出的系数为：\n$c_{00} = 0.33$\n$c_{10} = 0.12$\n$c_{01} = -0.08$\n$c_{20} = 0.05\\sqrt{2}$\n$c_{11} = 0.09$\n$c_{02} = -0.04\\sqrt{2}$\n\n将这些系数收集到所要求的行向量 $(c_{00},\\,c_{10},\\,c_{01},\\,c_{20},\\,c_{11},\\,c_{02})$ 中。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.33  0.12  -0.08  0.05\\sqrt{2}  0.09  -0.04\\sqrt{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "尽管PCE等方法很强大，但当不确定性输入的维度增加时，评估CFD模型所需的仿真次数可能会变得非常庞大，使得不确定性量化在计算上望而却步。多保真度方法通过结合少量高成本、高精度的仿真和大量低成本、低精度的仿真来解决这一挑战。本练习将引导您设计并实现一个多保真度控制变量框架，这是一种先进的方差缩减技术，旨在显著降低估计输出统计数据（如热通量的均值和标准差）所需的计算开销，从而使UQ在实际工程应用中变得可行。",
            "id": "4002827",
            "problem": "您需要设计并实现一个多保真度不确定性量化框架，该框架将一个简化的化学模型与一个完整的计算流体动力学（CFD）模型相结合，以估计超音速反应边界层中壁面热通量预测的不确定性。目标是使用一种方差缩减的多保真度控制变量策略，在输入不确定性的情况下，估计壁面热通量的均值和标准差。您的最终程序必须是一个完整的、可运行的 Python 脚本，该脚本能为指定的测试套件计算所需的输出，并以确切要求的格式打印结果。\n\n您必须将您的推导和算法建立在以下基本原理和核心定义之上：\n\n- 可压缩流动的能量平衡表明，壁面热通量由傅里叶定律给出，$q'' = -k \\, \\partial T / \\partial n \\rvert_{\\text{wall}}$，其中 $k$ 是热导率，$\\partial T / \\partial n$ 是壁面法向温度梯度。为实现工程封闭，通常将壁面热通量表示为 $q'' = h \\left(T_{r} - T_{w}\\right)$，其中 $h$ 是对流传热系数，$T_{r}$ 是表征来流边界层的恢复类温度，$T_{w}$ 是壁面温度。\n- 在高速湍流边界层中，恢复温度通常用一个取决于湍流普朗特数的恢复因子来描述。化学热释放可以通过化学引起的温升来增加恢复温度。\n- 不确定性量化旨在通过计算期望 $\\mathbb{E}[\\cdot]$ 和方差 $\\mathbb{V}[\\cdot]$ 来估计输入不确定性下输出的统计矩（均值和方差）。\n- 多保真度控制变量利用低成本、有偏模型与高成本、精确模型之间的相关性，在不改变目标期望值的情况下，减小估计量的方差。\n\n将壁面热通量 $q''$（单位为 $\\mathrm{W/m^2}$）定义为不确定输入的函数，包含以下高保真度（CFD 与详细化学）和低保真度（CFD 与简化化学）模型。这些模型是经过工程设计的代理模型，它们编码了经过充分检验的定性物理关系，而不是估计器的简化公式：\n\n1) 高保真度模型 $q_{H}''(A,E,Pr_{t})$:\n- 常数：$T_{e} = 1200 \\,\\mathrm{K}$，$T_{w} = 600 \\,\\mathrm{K}$，$\\gamma = 1.4$，$M = 2$，$R = 8.314 \\,\\mathrm{J/(mol \\cdot K)}$，$A_{\\mathrm{ref}} = 10^{6} \\,\\mathrm{s^{-1}}$，$H_{0} = 350 \\,\\mathrm{W/(m^{2}\\cdot K)}$，$S = 500 \\,\\mathrm{K}$，$\\kappa = 5 \\times 10^{4}$ (无量纲)。\n- 湍流恢复因子：$r = Pr_{t}^{1/3}$。\n- 化学引起的温升：$\\Delta T_{\\mathrm{chem},H} = S \\, \\ln\\!\\left(1 + \\kappa \\, \\frac{A}{A_{\\mathrm{ref}}} \\, \\exp\\!\\left(- \\frac{E}{R T_{e}}\\right)\\right)$。\n- 恢复类温度：$T_{r,H} = T_{e}\\left(1 + r \\, \\frac{\\gamma - 1}{2} \\, M^{2}\\right) + \\Delta T_{\\mathrm{chem},H}$。\n- 传热系数：$h = H_{0} \\, Pr_{t}^{-2/3}$。\n- 壁面热通量：$q_{H}'' = h \\, (T_{r,H} - T_{w})$，单位为 $\\mathrm{W/m^{2}}$。\n\n2) 低保真度模型 $q_{L}''(A,E,Pr_{t}; \\alpha, s)$，由失配参数 $\\alpha$ 和 $s$ 参数化：\n- 常数：与上述 $T_{e}$, $T_{w}$, $\\gamma$, $M$, $R$, $A_{\\mathrm{ref}}$, $H_{0}$ 相同，且 $\\kappa_{L} = 0.8 \\, \\kappa$。\n- 恢复因子：$r = Pr_{t}^{1/3}$。\n- 简化化学温升：$\\Delta T_{\\mathrm{chem},L} = s \\, S \\, \\ln\\!\\left(1 + \\kappa_{L} \\, \\left(\\frac{A}{A_{\\mathrm{ref}}}\\right)^{\\alpha} \\, \\exp\\!\\left(- \\frac{E}{R T_{e}}\\right)\\right)$。\n- 恢复类温度：$T_{r,L} = T_{e}\\left(1 + r \\, \\frac{\\gamma - 1}{2} \\, M^{2}\\right) + \\Delta T_{\\mathrm{chem},L}$。\n- 传热系数：$h = H_{0} \\, Pr_{t}^{-2/3}$。\n- 壁面热通量：$q_{L}'' = h \\, (T_{r,L} - T_{w})$，单位为 $\\mathrm{W/m^{2}}$。\n\n输入不确定性是独立的，具有以下分布：\n- 反应指前因子 $A$（单位为 $\\mathrm{s^{-1}}$）：$\\ln A \\sim \\mathcal{N}(\\ln(10^{6}),\\, 0.5^{2})$。\n- 活化能 $E$（单位为 $\\mathrm{J/mol}$）：$E \\sim \\mathcal{N}(8 \\times 10^{4},\\, (1 \\times 10^{4})^{2})$。\n- 湍流普朗特数 $Pr_{t}$（无量纲）：$\\ln Pr_{t} \\sim \\mathcal{N}(\\ln(0.9),\\, 0.2^{2})$。\n\n令关注量为随机壁面热通量 $Q = q_{H}''(A,E,Pr_{t})$。您必须使用一个多保真度控制变量框架来估计其均值 $\\mu = \\mathbb{E}[Q]$ 和标准差 $\\sigma = \\sqrt{\\mathbb{V}[Q]}$，该框架利用 $q_{L}''$ 作为与 $q_{H}''$ 相关的低保真度模型。您必须从第一性原理出发，设计一个用于估计 $\\mathbb{E}[Q]$ 的估计量，该估计量结合了少量成对的高/低保真度评估和大量仅低保真度的评估。为了估计 $\\mathbb{V}[Q]$，您必须使用类似的多保真度结构来估计 $\\mathbb{E}[Q^{2}]$，然后计算 $\\sigma = \\sqrt{\\max\\{ \\mathbb{E}[Q^{2}] - (\\mathbb{E}[Q])^{2},\\, 0\\}}$。当需要时，您必须通过使用一个最小的正则化正常数来确保在样本方差非常小的情况下的数值稳定性。\n\n数值和实现要求：\n- 使用标准的蒙特卡洛抽样，并设置固定的随机种子 $2025$ 以确保可复现性。\n- 不涉及角度；不需要角度单位。\n- 以 $\\mathrm{W/m^{2}}$ 为单位表示最终估计的均值和标准差，在打印输出中，每个浮点数都四舍五入到恰好 $6$ 位小数。\n- 不得读取任何外部输入；不允许访问外部文件或网络。\n\n测试套件：\n对于每个测试用例，使用指定的低保真度失配参数 $(\\alpha, s)$ 和抽样预算。在每个用例中，$M$ 表示成对的高/低保真度样本数量，$N$ 表示低保真度样本总数（包括 $M$ 个成对样本）。所有 $N - M$ 个仅低保真度的样本必须独立于 $M$ 个成对样本。\n\n- 用例 $1$：$(\\alpha, s) = (1.0, 1.0)$，$M = 40$，$N = 4000$。\n- 用例 $2$：$(\\alpha, s) = (0.9, 0.85)$，$M = 40$，$N = 4000$。\n- 用例 $3$：$(\\alpha, s) = (0.6, 0.6)$，$M = 40$，$N = 4000$。\n- 用例 $4$（高保真度样本极少的边界条件）：$(\\alpha, s) = (0.8, 0.9)$，$M = 2$，$N = 4000$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。该列表必须按顺序包含每个测试用例的估计均值和标准差（均以 $\\mathrm{W/m^{2}}$ 为单位），四个用例的结果连接在一起：\n[$\\mu_{1}$, $\\sigma_{1}$, $\\mu_{2}$, $\\sigma_{2}$, $\\mu_{3}$, $\\sigma_{3}$, $\\mu_{4}$, $\\sigma_{4}$]\n每个数字必须四舍五入到恰好 $6$ 位小数并打印，不带单位，其中 $\\mu_{i}$ 和 $\\sigma_{i}$ 是用例 $i$ 的多保真度估计值，单位为 $\\mathrm{W/m^{2}}$。",
            "solution": "用户提供的问题是有效的。这是一个在航空航天CFD不确定性量化领域中适定且具有科学依据的问题。所给出的物理模型虽然经过简化，但代表了反应边界层传热的工程近似方法，并且在数学上是一致的。基于多保真度控制变量的 statistical 框架是实现所述目标的标准且合适的技术。所有必需的常数、模型定义、输入不确定性和数值要求都已提供，使得问题自成体系且可解。\n\n### 理论框架与推导\n\n主要目标是估计高保真度关注量 $Q_H = q_{H}''(A,E,Pr_{t})$ 的均值 $\\mu = \\mathbb{E}[Q_H]$ 和标准差 $\\sigma = \\sqrt{\\mathbb{V}[Q_H]}$，该量的评估计算成本高昂。为加速此估计过程，我们利用一个计算成本低但精度较低的低保真度模型 $Q_L = q_{L}''(A,E,Pr_{t}, \\alpha, s)$。为此，采用了多保真度控制变量（MF-CV）方法。\n\n#### 1. 均值的多保真度控制变量估计量\n\n控制变量的核心思想是使用一个具有已知（或可廉价估计）均值的相关变量来减小估计量的方差。$\\mathbb{E}[Q_H]$ 的标准控制变量估计量为：\n$$ \\hat{Q}_{H,CV} = Q_H - \\beta (Q_L - \\mathbb{E}[Q_L]) $$\n其中 $\\beta$ 是为最小化 $\\hat{Q}_{H,CV}$ 方差而选择的系数。该估计量的期望值为 $\\mathbb{E}[\\hat{Q}_{H,CV}] = \\mathbb{E}[Q_H] = \\mu$，因此它是无偏的。\n\n在实践中，真实均值 $\\mathbb{E}[Q_L]$ 是未知的，必须进行估计。MF-CV 框架使用少量高保真度评估和大量低保真度评估。我们给定的预算是 $M$ 次成对评估 $\\{(Q_H^{(i)}, Q_L^{(i)})\\}_{i=1}^M$，以及总共 $N$ 次低保真度评估，其中额外的 $N-M$ 次评估是在一组独立的输入样本上进行的。\n\n均值的 MF-CV 估计量 $\\hat{\\mu}_{H, MF}$ 按如下方式构造：\n$$ \\hat{\\mu}_{H, MF} = \\hat{\\mu}_{H, M} + \\beta (\\hat{\\mu}_{L, N} - \\hat{\\mu}_{L, M}) $$\n其中：\n- $\\hat{\\mu}_{H, M} = \\frac{1}{M} \\sum_{i=1}^{M} Q_H^{(i)}$ 是使用 $M$ 个昂贵样本对高保真度均值的标准蒙特卡洛估计。\n- $\\hat{\\mu}_{L, M} = \\frac{1}{M} \\sum_{i=1}^{M} Q_L^{(i)}$ 是来自相同 $M$ 个样本的低保真度均值的估计。\n- $\\hat{\\mu}_{L, N} = \\frac{1}{N} \\sum_{j=1}^{N} Q_L^{(j)}$ 是使用所有 $N$ 个廉价样本对低保真度均值更准确的估计。\n- $\\beta$ 是控制变量系数。\n\n使估计量方差最小化的最优系数 $\\beta^*$ 由下式给出：\n$$ \\beta^* = \\frac{\\mathrm{Cov}(Q_H, Q_L)}{\\mathbb{V}[Q_L]} $$\n由于真实的协方差和方差是未知的，我们从 $M$ 个成对样本中估计它们：\n$$ \\hat{\\beta} = \\frac{\\widehat{\\mathrm{Cov}}(Q_H, Q_L)}{\\widehat{\\mathbb{V}}[Q_L]} = \\frac{\\sum_{i=1}^{M} (Q_H^{(i)} - \\hat{\\mu}_{H, M})(Q_L^{(i)} - \\hat{\\mu}_{L, M})}{\\sum_{i=1}^{M} (Q_L^{(i)} - \\hat{\\mu}_{L, M})^2} $$\n为了数值稳定性，特别是当 $M$ 很小时，分母可能接近于零。我们引入一个小的正则化常数 $\\epsilon > 0$ 来防止除以一个非常小的数：\n$$ \\hat{\\beta} = \\frac{\\widehat{\\mathrm{Cov}}(Q_H, Q_L)}{\\widehat{\\mathbb{V}}[Q_L] + \\epsilon} $$\n\n均值的最终估计量为：\n$$ \\hat{\\mu}_{H, MF} = \\hat{\\mu}_{H, M} + \\hat{\\beta} (\\hat{\\mu}_{L, N} - \\hat{\\mu}_{L, M}) $$\n\n#### 2. 标准差的估计量\n\n标准差为 $\\sigma = \\sqrt{\\mathbb{V}[Q_H]}$，其中方差定义为 $\\mathbb{V}[Q_H] = \\mathbb{E}[Q_H^2] - (\\mathbb{E}[Q_H])^2$。我们已经推导出了 $\\mathbb{E}[Q_H]$ 的估计量。为了估计 $\\mathbb{V}[Q_H]$，我们需要一个二阶矩 $\\mathbb{E}[Q_H^2]$ 的估计量。\n\n根据问题描述，我们为 $\\mathbb{E}[Q_H^2]$ 构建一个类似的 MF-CV 估计量。让我们定义两个新的随机变量：$Y_H = Q_H^2$ 和 $Y_L = Q_L^2$。我们现在寻求估计 $\\mathbb{E}[Y_H]$。我们应用相同的 MF-CV 过程：\n$$ \\widehat{\\mathbb{E}[Y_H]}_{MF} = \\hat{\\mu}_{Y_H, M} + \\hat{\\beta}_Y (\\hat{\\mu}_{Y_L, N} - \\hat{\\mu}_{Y_L, M}) $$\n其中：\n- 均值 $\\hat{\\mu}_{Y_H, M}$、$\\hat{\\mu}_{Y_L, M}$ 和 $\\hat{\\mu}_{Y_L, N}$ 是平方量的样本平均值，类似于均值估计量。\n- 系数 $\\hat{\\beta}_Y$ 是从平方量的 $M$ 个成对样本中估计的：\n$$ \\hat{\\beta}_Y = \\frac{\\widehat{\\mathrm{Cov}}(Y_H, Y_L)}{\\widehat{\\mathbb{V}}[Y_L] + \\epsilon} = \\frac{\\widehat{\\mathrm{Cov}}(Q_H^2, Q_L^2)}{\\widehat{\\mathbb{V}}[Q_L^2] + \\epsilon} $$\n\n利用一阶矩和二阶矩的估计量，方差估计为：\n$$ \\widehat{\\mathbb{V}}[Q_H] = \\widehat{\\mathbb{E}[Y_H]}_{MF} - (\\hat{\\mu}_{H, MF})^2 $$\n为确保方差非负（可能因抽样误差而违背），我们取该值与零的最大值：\n$$ \\widehat{\\mathbb{V}}[Q_H] = \\max\\{0, \\widehat{\\mathbb{E}[Y_H]}_{MF} - (\\hat{\\mu}_{H, MF})^2 \\} $$\n最后，估计的标准差是估计方差的平方根：\n$$ \\hat{\\sigma}_{H, MF} = \\sqrt{\\widehat{\\mathbb{V}}[Q_H]} $$\n\n### 算法实现\n\n解决方案通过对每个测试用例执行以下步骤来实现：\n\n1.  **初始化**：设置一个随机数生成器，并使用指定的种子 `2025`，以确保所有测试用例的可复现性。\n\n2.  **样本生成**：对于给定的参数为 $(M, N)$ 的用例，从其指定的分布中生成两组独立的输入样本：\n    - 一组 $M$ 个不确定输入 $(A, E, Pr_t)$ 的样本，用于成对的高保真度和低保真度模型评估。\n    - 一组 $N-M$ 个 $(A, E, Pr_t)$ 的样本，用于仅低保真度模型的评估。\n    分布为：\n    - $A \\sim \\text{LogNormal}(\\mu=\\ln(10^{6}), \\sigma=0.5)$\n    - $E \\sim \\mathcal{N}(\\mu=8 \\times 10^{4}, \\sigma=1 \\times 10^{4})$\n    - $Pr_t \\sim \\text{LogNormal}(\\mu=\\ln(0.9), \\sigma=0.2)$\n\n3.  **模型评估**：\n    - 在 $M$ 个成对样本上评估 $Q_H$ 和 $Q_L$，得到数组 $Q_{H,M}$ 和 $Q_{L,M}$。\n    - 在 $N-M$ 个独立样本上评估 $Q_L$，得到 $Q_{L, \\text{rest}}$。\n    - 构建完整的 $N$ 个低保真度评估集合：$Q_{L,N}$ 是 $Q_{L,M}$ 和 $Q_{L, \\text{rest}}$ 的串联。\n\n4.  **均值估计**：\n    - 从评估数组中计算样本均值 $\\hat{\\mu}_{H, M}$、$\\hat{\\mu}_{L, M}$ 和 $\\hat{\\mu}_{L, N}$。\n    - 使用 $M$ 个成对样本计算样本协方差 $\\widehat{\\mathrm{Cov}}(Q_H, Q_L)$ 和方差 $\\widehat{\\mathbb{V}}[Q_L]$。\n    - 计算带正则化的系数 $\\hat{\\beta}$。\n    - 计算最终估计值 $\\hat{\\mu}_{H, MF}$。\n\n5.  **标准差估计**：\n    - 将评估数组的元素平方，得到 $Q_{H,M}^2$、$Q_{L,M}^2$ 和 $Q_{L,N}^2$。\n    - 使用这些平方量重复步骤 4 的过程，以找到 $\\widehat{\\mathbb{E}[Q_H^2]}_{MF}$。\n    - 计算估计的方差 $\\widehat{\\mathbb{V}}[Q_H]$，然后计算标准差 $\\hat{\\sigma}_{H, MF}$。\n\n6.  **输出**：存储计算出的均值和标准差，四舍五入到 $6$ 位小数。处理完所有测试用例后，以指定的列表格式打印整理好的结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and implements a multifidelity uncertainty quantification framework\n    to estimate mean and standard deviation of wall heat flux in a supersonic,\n    reacting boundary layer.\n    \"\"\"\n\n    # --- Constants ---\n    T_e = 1200.0        # K\n    T_w = 600.0         # K\n    gamma = 1.4\n    Mach = 2.0\n    R = 8.314           # J/(mol*K)\n    A_ref = 1.0e6       # s^-1\n    H_0 = 350.0         # W/(m^2*K)\n    S = 500.0           # K\n    kappa = 5.0e4\n    kappa_L = 0.8 * kappa\n    REG_EPSILON = 1e-12 # Regularization constant\n\n    # --- Model Definitions ---\n    def q_H(A, E, Pr_t):\n        \"\"\"High-fidelity model for wall heat flux.\"\"\"\n        r = Pr_t**(1/3)\n        delta_T_chem_H = S * np.log(1 + kappa * (A / A_ref) * np.exp(-E / (R * T_e)))\n        T_r_H = T_e * (1 + r * (gamma - 1) / 2 * Mach**2) + delta_T_chem_H\n        h = H_0 * Pr_t**(-2/3)\n        return h * (T_r_H - T_w)\n\n    def q_L(A, E, Pr_t, alpha, s):\n        \"\"\"Low-fidelity model for wall heat flux.\"\"\"\n        r = Pr_t**(1/3)\n        delta_T_chem_L = s * S * np.log(1 + kappa_L * (A / A_ref)**alpha * np.exp(-E / (R * T_e)))\n        T_r_L = T_e * (1 + r * (gamma - 1) / 2 * Mach**2) + delta_T_chem_L\n        h = H_0 * Pr_t**(-2/3)\n        return h * (T_r_L - T_w)\n\n    def get_mf_estimates(Q_H_m, Q_L_m, Q_L_rest):\n        \"\"\"\n        Computes the multifidelity estimates for the mean and second moment.\n        \"\"\"\n        M = len(Q_H_m)\n        N = M + len(Q_L_rest)\n        \n        Q_L_n = np.concatenate((Q_L_m, Q_L_rest))\n        \n        # --- Estimate Mean of Q ---\n        mu_H_m = np.mean(Q_H_m)\n        mu_L_m = np.mean(Q_L_m)\n        mu_L_n = np.mean(Q_L_n)\n\n        # Handle M > 1 case for np.cov ddof=1 which requires M>1\n        if M > 1:\n            cov_matrix_Q = np.cov(Q_H_m, Q_L_m, ddof=1)\n            cov_Q = cov_matrix_Q[0, 1]\n            var_Q_L_m = cov_matrix_Q[1, 1]\n        else: # M=1; variance/covariance are poorly defined. Use 0\n            cov_Q = 0.0\n            var_Q_L_m = 0.0\n\n        beta_Q = cov_Q / (var_Q_L_m + REG_EPSILON)\n        est_mean = mu_H_m + beta_Q * (mu_L_n - mu_L_m)\n\n        # --- Estimate Mean of Q^2 ---\n        Y_H_m = Q_H_m**2\n        Y_L_m = Q_L_m**2\n        Y_L_n = Q_L_n**2\n\n        mu_Y_H_m = np.mean(Y_H_m)\n        mu_Y_L_m = np.mean(Y_L_m)\n        mu_Y_L_n = np.mean(Y_L_n)\n\n        if M > 1:\n            cov_matrix_Y = np.cov(Y_H_m, Y_L_m, ddof=1)\n            cov_Y = cov_matrix_Y[0, 1]\n            var_Y_L_m = cov_matrix_Y[1, 1]\n        else:\n            cov_Y = 0.0\n            var_Y_L_m = 0.0\n\n        beta_Y = cov_Y / (var_Y_L_m + REG_EPSILON)\n        est_mean_sq = mu_Y_H_m + beta_Y * (mu_Y_L_n - mu_Y_L_m)\n        \n        return est_mean, est_mean_sq\n\n    # --- Test Suite ---\n    test_cases = [\n        # (alpha, s, M, N)\n        (1.0, 1.0, 40, 4000),\n        (0.9, 0.85, 40, 4000),\n        (0.6, 0.6, 40, 4000),\n        (0.8, 0.9, 2, 4000),\n    ]\n\n    # Use a single random number generator for reproducibility of the entire script\n    rng = np.random.default_rng(2025)\n    \n    final_results = []\n\n    for alpha, s, M, N in test_cases:\n        N_rest = N - M\n        \n        # --- Sample Generation ---\n        # Paired samples (M)\n        A_m = rng.lognormal(mean=np.log(1e6), sigma=0.5, size=M)\n        E_m = rng.normal(loc=8e4, scale=1e4, size=M)\n        Pr_t_m = rng.lognormal(mean=np.log(0.9), sigma=0.2, size=M)\n        \n        # Low-fidelity only samples (N-M)\n        A_rest = rng.lognormal(mean=np.log(1e6), sigma=0.5, size=N_rest)\n        E_rest = rng.normal(loc=8e4, scale=1e4, size=N_rest)\n        Pr_t_rest = rng.lognormal(mean=np.log(0.9), sigma=0.2, size=N_rest)\n        \n        # --- Model Evaluations ---\n        Q_H_m = q_H(A_m, E_m, Pr_t_m)\n        Q_L_m = q_L(A_m, E_m, Pr_t_m, alpha, s)\n        Q_L_rest = q_L(A_rest, E_rest, Pr_t_rest, alpha, s)\n\n        # --- Estimation ---\n        est_mean, est_mean_sq = get_mf_estimates(Q_H_m, Q_L_m, Q_L_rest)\n        \n        est_var = max(0, est_mean_sq - est_mean**2)\n        est_std = np.sqrt(est_var)\n\n        # Append results rounded to 6 decimal places\n        final_results.append(f\"{est_mean:.6f}\")\n        final_results.append(f\"{est_std:.6f}\")\n    \n    # --- Final Output ---\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```"
        }
    ]
}