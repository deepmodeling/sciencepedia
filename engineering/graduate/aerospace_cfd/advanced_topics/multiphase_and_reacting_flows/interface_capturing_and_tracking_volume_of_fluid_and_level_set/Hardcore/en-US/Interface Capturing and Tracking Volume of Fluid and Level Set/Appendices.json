{
    "hands_on_practices": [
        {
            "introduction": "Before diving into the details of numerical algorithms, it is crucial to ground our understanding in the fundamental physics of multiphase flow. This practice challenges you to apply dimensional analysis to the governing Navier-Stokes equations for a two-phase system. By non-dimensionalizing the equations, you will identify the minimal set of dimensionless parameters, such as the Reynolds ($Re$), Weber ($We$), and Froude ($Fr$) numbers, that dictate the dynamics of the interface and distinguish different flow regimes (). This foundational skill is essential for designing meaningful simulations and interpreting their results in the context of real-world applications like aerospace fuel injection.",
            "id": "3968674",
            "problem": "An incompressible, immiscible liquid jet of characteristic diameter $L$ is injected at speed $U$ into quiescent air under standard gravity $g$. The interface between the phases is captured and evolved numerically using either the Volume of Fluid (VOF) or the Level Set (LS) method with a continuum-surface-stress representation of capillarity. The two phases have densities $\\rho_{\\ell}$ and $\\rho_{g}$ and dynamic viscosities $\\mu_{\\ell}$ and $\\mu_{g}$, and the interface has surface tension $\\sigma$. Neglect compressibility, phase change, heat transfer, and chemical reactions, and assume no slip at solid boundaries far from the jet origin.\n\nStarting from conservation of mass and momentum for two-phase, incompressible flow with capillary effects and gravity, non-dimensionalize the governing equations using the scales $L$ and $U$ for length and velocity, a reference density $\\rho_{\\mathrm{ref}}$ and viscosity $\\mu_{\\mathrm{ref}}$, and the given $\\sigma$ and $g$. Focus on physics-only parameters; exclude algorithm-specific numerical parameters such as any artificial interface thickness used for LS reinitialization or VOF reconstruction.\n\nWhich option identifies a minimal, non-redundant set of independent dimensionless parameters governing the interface dynamics in this problem, and simultaneously specifies a physically consistent asymptotic regime for primary breakup in a high-speed aerospace injection where inertia and capillarity dominate and gravity is negligible, with viscous effects not dominant?\n\nA. $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{Re}_{\\mathrm{ref}},\\, \\text{We}_{\\mathrm{ref}},\\, \\text{Fr}\\}$ with $\\text{Re}_{\\mathrm{ref}} \\gg 1$, $\\text{We}_{\\mathrm{ref}} \\gg 1$, $\\text{Fr} \\gg 1$.\n\nB. $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{Re}_{\\mathrm{ref}},\\, \\text{We}_{\\mathrm{ref}},\\, \\text{Fr},\\, \\text{Ca}_{\\mathrm{ref}},\\, \\text{Bo}\\}$ with $\\text{Re}_{\\mathrm{ref}} = \\mathcal{O}(1)$, $\\text{Ca}_{\\mathrm{ref}} \\gg 1$, $\\text{We}_{\\mathrm{ref}} \\ll 1$.\n\nC. $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{Oh}_{\\mathrm{ref}},\\, \\text{Bo}\\}$ with $\\text{Oh}_{\\mathrm{ref}} \\ll 1$, $\\text{Bo} \\ll 1$.\n\nD. $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{Re}_{\\mathrm{ref}},\\, \\text{Bo}\\}$ with $\\text{Bo} \\gg 1$, $\\text{Re}_{\\mathrm{ref}} \\ll 1$.\n\nE. $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{We}_{\\mathrm{ref}},\\, \\text{Fr},\\, \\varepsilon/L\\}$ with $\\varepsilon/L \\ll 1$, $\\text{We}_{\\mathrm{ref}} \\gg 1$, $\\text{Fr} \\gg 1$, where $\\varepsilon$ is the Level Set reinitialization thickness scale.",
            "solution": "The problem asks for the identification of a minimal, non-redundant set of dimensionless parameters governing the dynamics of an incompressible, immiscible liquid jet, and for the characterization of a specific asymptotic regime for high-speed breakup.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\n-   **Flow type**: Incompressible, immiscible two-phase flow.\n-   **Geometry**: Liquid jet of characteristic diameter $L$ injected into quiescent air.\n-   **Kinematics**: Injection speed $U$.\n-   **Forces**: Standard gravity $g$, surface tension $\\sigma$.\n-   **Fluid Properties**: Liquid density $\\rho_{\\ell}$, liquid dynamic viscosity $\\mu_{\\ell}$; gas density $\\rho_{g}$, gas dynamic viscosity $\\mu_{g}$.\n-   **Modeling**: Conservation of mass and momentum, continuum-surface-stress representation of capillarity.\n-   **Assumptions**: Neglect compressibility, phase change, heat transfer, chemical reactions.\n-   **Non-dimensionalization scales**: Length $L$, velocity $U$, reference density $\\rho_{\\mathrm{ref}}$, reference viscosity $\\mu_{\\mathrm{ref}}$.\n-   **Constraints**: Exclude algorithm-specific numerical parameters.\n-   **Target Regime**: Primary breakup in a high-speed aerospace injection where inertia and capillarity dominate, gravity is negligible, and viscous effects are not dominant.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the well-established principles of fluid dynamics, specifically the Navier-Stokes equations for two-phase flow. All concepts (inertia, viscosity, gravity, surface tension) and the proposed numerical modeling approaches (VOF/LS) are standard in computational fluid dynamics (CFD). The problem is scientifically sound.\n-   **Well-Posed**: The request to derive dimensionless parameters and identify a physical regime based on first principles is a standard, well-posed problem in dimensional analysis. It is structured to have a unique, derivable answer.\n-   **Objective**: The problem uses precise, technical language and is free from subjective or ambiguous statements.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is scientifically sound, well-posed, objective, and contains sufficient information for a rigorous derivation. I will proceed with the solution.\n\n### Derivation of Dimensionless Parameters\n\nThe governing equations for an incompressible, two-phase flow can be written in a \"one-fluid\" formulation, where a single set of equations applies across the whole domain, and fluid properties vary based on the phase. Let $\\phi$ be an indicator function (e.g., volume fraction or level set function) that distinguishes the two phases. The density $\\rho$ and viscosity $\\mu$ are functions of position, $\\mathbf{x}$, and time, $t$, through $\\phi$.\n\nThe conservation of mass for an incompressible flow is:\n$$ \\nabla \\cdot \\mathbf{u} = 0 $$\nThe conservation of momentum is given by the Navier-Stokes equation:\n$$ \\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u} \\cdot \\nabla) \\mathbf{u} \\right) = - \\nabla p + \\nabla \\cdot (2 \\mu \\mathbf{D}) + \\rho \\mathbf{g} + \\mathbf{F}_{\\sigma} $$\nwhere $\\mathbf{u}$ is the velocity vector, $p$ is the pressure, $\\mathbf{D}$ is the rate-of-strain tensor, $\\mathbf{g}$ is the gravitational acceleration vector, and $\\mathbf{F}_{\\sigma}$ is the volumetric surface tension force, which can be modeled as $\\mathbf{F}_{\\sigma} = \\sigma \\kappa \\mathbf{n} \\delta_S$, with $\\sigma$ as the surface tension coefficient, $\\kappa$ as the interface curvature, $\\mathbf{n}$ as the interface normal, and $\\delta_S$ as a Dirac delta function localizing the force to the interface.\n\nTo non-dimensionalize, we introduce the following dimensionless variables, denoted with an asterisk:\n$$ \\mathbf{x}^* = \\frac{\\mathbf{x}}{L}, \\quad \\mathbf{u}^* = \\frac{\\mathbf{u}}{U}, \\quad t^* = \\frac{t}{L/U}, \\quad p^* = \\frac{p - p_{\\infty}}{\\rho_{\\mathrm{ref}} U^2}, \\quad \\rho^* = \\frac{\\rho}{\\rho_{\\mathrm{ref}}}, \\quad \\mu^* = \\frac{\\mu}{\\mu_{\\mathrm{ref}}} $$\nThe derivatives transform as:\n$$ \\frac{\\partial}{\\partial t} = \\frac{U}{L} \\frac{\\partial}{\\partial t^*}, \\quad \\nabla = \\frac{1}{L} \\nabla^* $$\nThe surface tension force scales as $\\mathbf{F}_\\sigma \\sim \\sigma/L^2$. Substituting these into the momentum equation yields:\n$$ \\frac{\\rho_{\\mathrm{ref}} U^2}{L} \\rho^* \\left( \\frac{\\partial \\mathbf{u}^*}{\\partial t^*} + (\\mathbf{u}^* \\cdot \\nabla^*) \\mathbf{u}^* \\right) = - \\frac{\\rho_{\\mathrm{ref}} U^2}{L} \\nabla^* p^* + \\frac{\\mu_{\\mathrm{ref}} U}{L^2} \\nabla^* \\cdot (2 \\mu^* \\mathbf{D}^*) + \\rho_{\\mathrm{ref}} g \\rho^* \\frac{\\mathbf{g}}{g} + \\frac{\\sigma}{L^2} \\mathbf{F}_{\\sigma}^* $$\nDividing by the inertial force scale, $\\rho_{\\mathrm{ref}} U^2 / L$, gives the dimensionless momentum equation:\n$$ \\rho^* \\left( \\frac{\\partial \\mathbf{u}^*}{\\partial t^*} + (\\mathbf{u}^* \\cdot \\nabla^*) \\mathbf{u}^* \\right) = - \\nabla^* p^* + \\left( \\frac{\\mu_{\\mathrm{ref}}}{\\rho_{\\mathrm{ref}} U L} \\right) \\nabla^* \\cdot (2 \\mu^* \\mathbf{D}^*) + \\left( \\frac{g L}{U^2} \\right) \\rho^* \\frac{\\mathbf{g}}{g} + \\left( \\frac{\\sigma}{\\rho_{\\mathrm{ref}} U^2 L} \\right) \\mathbf{F}_{\\sigma}^* $$\nFrom the coefficients, we identify the following dimensionless numbers:\n-   **Reynolds number**: $\\text{Re}_{\\mathrm{ref}} = \\frac{\\rho_{\\mathrm{ref}} U L}{\\mu_{\\mathrm{ref}}}$. The coefficient of the viscous term is $1/\\text{Re}_{\\mathrm{ref}}$.\n-   **Froude number**: $\\text{Fr} = \\frac{U}{\\sqrt{g L}}$. The coefficient of the gravity term is $1/\\text{Fr}^2$.\n-   **Weber number**: $\\text{We}_{\\mathrm{ref}} = \\frac{\\rho_{\\mathrm{ref}} U^2 L}{\\sigma}$. The coefficient of the surface tension term is $1/\\text{We}_{\\mathrm{ref}}$.\n\nThe dimensionless density $\\rho^*$ and viscosity $\\mu^*$ vary between the two phases. Their values depend on the properties of the liquid and gas:\n$$ \\rho^* \\in \\{\\rho_{\\ell}/\\rho_{\\mathrm{ref}}, \\rho_{g}/\\rho_{\\mathrm{ref}}\\}, \\quad \\mu^* \\in \\{\\mu_{\\ell}/\\mu_{\\mathrm{ref}}, \\mu_{g}/\\mu_{\\mathrm{ref}}\\} $$\nTo fully describe the system, we need to specify these property ratios. However, the system is defined by the ratios of the properties themselves, i.e., the **density ratio** $\\rho_{\\ell}/\\rho_{g}$ and the **viscosity ratio** $\\mu_{\\ell}/\\mu_{g}$. These two ratios, combined with the three numbers derived above ($\\text{Re}_{\\mathrm{ref}}, \\text{We}_{\\mathrm{ref}}, \\text{Fr}$), form a set of 5 independent parameters. By the Buckingham Pi theorem, with 8 relevant physical parameters ($\\rho_{\\ell}, \\rho_{g}, \\mu_{\\ell}, \\mu_{g}, \\sigma, g, L, U$) and 3 fundamental dimensions (mass, length, time), we expect $8-3=5$ independent dimensionless groups. Thus, the set $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{Re}_{\\mathrm{ref}},\\, \\text{We}_{\\mathrm{ref}},\\, \\text{Fr}\\}$ is a minimal, non-redundant set of independent dimensionless parameters.\n\n### Analysis of the Asymptotic Regime\n\nThe problem specifies a regime for primary breakup in a high-speed aerospace injection where:\n1.  **Inertia and capillarity dominate**: This implies that the competition between inertial forces and surface tension forces governs the breakup process. For breakup to occur, inertia must be strong enough to overcome surface tension, meaning the ratio of inertial to surface tension forces, the Weber number, must be large. Thus, $\\text{We}_{\\mathrm{ref}} \\gg 1$.\n2.  **Gravity is negligible**: The inertial forces must be much larger than the gravitational forces. The ratio of inertial to gravitational forces is the Froude number squared. Hence, we require $\\text{Fr}^2 \\gg 1$, which implies $\\text{Fr} \\gg 1$.\n3.  **Viscous effects not dominant**: The inertial forces must be much larger than the viscous forces. The ratio of inertial to viscous forces is the Reynolds number. Hence, we require $\\text{Re}_{\\mathrm{ref}} \\gg 1$.\n\nThe asymptotic regime is therefore characterized by $\\text{Re}_{\\mathrm{ref}} \\gg 1$, $\\text{We}_{\\mathrm{ref}} \\gg 1$, and $\\text{Fr} \\gg 1$.\n\n### Option-by-Option Analysis\n\n**A. $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{Re}_{\\mathrm{ref}},\\, \\text{We}_{\\mathrm{ref}},\\, \\text{Fr}\\}$ with $\\text{Re}_{\\mathrm{ref}} \\gg 1$, $\\text{We}_{\\mathrm{ref}} \\gg 1$, $\\text{Fr} \\gg 1$.**\n-   **Parameter Set**: This set consists of 5 parameters: the density ratio, the viscosity ratio, and the Reynolds, Weber, and Froude numbers. As derived above, this is a minimal, non-redundant, and complete set of independent dimensionless parameters for the problem.\n-   **Regime**: The conditions $\\text{Re}_{\\mathrm{ref}} \\gg 1$ (inertia dominates viscosity), $\\text{We}_{\\mathrm{ref}} \\gg 1$ (inertia dominates surface tension, leading to breakup), and $\\text{Fr} \\gg 1$ (inertia dominates gravity) perfectly match the physical description of a high-speed jet breakup where viscous and gravitational effects are negligible.\n-   **Verdict**: **Correct**. This option correctly identifies both the parameter set and the asymptotic regime.\n\n**B. $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{Re}_{\\mathrm{ref}},\\, \\text{We}_{\\mathrm{ref}},\\, \\text{Fr},\\, \\text{Ca}_{\\mathrm{ref}},\\, \\text{Bo}\\}$ with $\\text{Re}_{\\mathrm{ref}} = \\mathcal{O}(1)$, $\\text{Ca}_{\\mathrm{ref}} \\gg 1$, $\\text{We}_{\\mathrm{ref}} \\ll 1$.**\n-   **Parameter Set**: This set is **redundant**. It contains 7 parameters, whereas only 5 are independent. The Capillary number $\\text{Ca}_{\\mathrm{ref}} = \\text{We}_{\\mathrm{ref}}/\\text{Re}_{\\mathrm{ref}}$ and the Bond number $\\text{Bo} = \\text{We}_{\\mathrm{ref}}/\\text{Fr}^2$ can be derived from other parameters in the set.\n-   **Regime**: The regime description is incorrect and self-contradictory. $\\text{Re}_{\\mathrm{ref}} = \\mathcal{O}(1)$ implies viscous effects are significant, contradicting \"viscous effects not dominant\". $\\text{We}_{\\mathrm{ref}} \\ll 1$ implies surface tension is dominant over inertia, which would prevent breakup, contradicting the problem description. Moreover, the conditions $\\text{Re}_{\\mathrm{ref}} = \\mathcal{O}(1)$ and $\\text{We}_{\\mathrm{ref}} \\ll 1$ imply $\\text{Ca}_{\\mathrm{ref}} = \\text{We}_{\\mathrm{ref}}/\\text{Re}_{\\mathrm{ref}} \\ll 1$, which contradicts the given condition $\\text{Ca}_{\\mathrm{ref}} \\gg 1$.\n-   **Verdict**: **Incorrect**.\n\n**C. $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{Oh}_{\\mathrm{ref}},\\, \\text{Bo}\\}$ with $\\text{Oh}_{\\mathrm{ref}} \\ll 1$, $\\text{Bo} \\ll 1$.**\n-   **Parameter Set**: This set contains only 4 parameters. It is **incomplete**. It lacks a parameter that includes the injection speed $U$, such as a Reynolds or Weber number. The Ohnesorge number, $\\text{Oh}_{\\mathrm{ref}} = \\mu_{\\mathrm{ref}}/\\sqrt{\\rho_{\\mathrm{ref}} \\sigma L} = \\sqrt{\\text{We}_{\\mathrm{ref}}}/\\text{Re}_{\\mathrm{ref}}$, and the Bond number, $\\text{Bo} = (\\rho_{\\ell}-\\rho_g) g L^2 / \\sigma$, do not contain $U$ and cannot fully characterize a flow driven by a specified velocity.\n-   **Regime**: While $\\text{Oh}_{\\mathrm{ref}} \\ll 1$ is consistent with low viscosity, and $\\text{Bo} \\ll 1$ with negligible gravity compared to surface tension, the set and conditions are insufficient to describe the high-speed regime.\n-   **Verdict**: **Incorrect**.\n\n**D. $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{Re}_{\\mathrm{ref}},\\, \\text{Bo}\\}$ with $\\text{Bo} \\gg 1$, $\\text{Re}_{\\mathrm{ref}} \\ll 1$.**\n-   **Parameter Set**: This set is **incomplete**, containing only 4 parameters. It lacks a parameter to independently represent capillarity (like $\\text{We}_{\\mathrm{ref}}$) or gravity (like $\\text{Fr}$).\n-   **Regime**: The condition $\\text{Re}_{\\mathrm{ref}} \\ll 1$ describes a creeping flow where viscous forces dominate inertia, which is the opposite of a \"high-speed injection\". The condition $\\text{Bo} \\gg 1$ implies gravity dominates surface tension, which provides no information about the negligible role of gravity relative to inertia.\n-   **Verdict**: **Incorrect**.\n\n**E. $\\{\\rho_{\\ell}/\\rho_{g},\\, \\mu_{\\ell}/\\mu_{g},\\, \\text{We}_{\\mathrm{ref}},\\, \\text{Fr},\\, \\varepsilon/L\\}$ with $\\varepsilon/L \\ll 1$, $\\text{We}_{\\mathrm{ref}} \\gg 1$, $\\text{Fr} \\gg 1$, where $\\varepsilon$ is the Level Set reinitialization thickness scale.**\n-   **Parameter Set**: This set violates the problem's explicit instruction to \"exclude algorithm-specific numerical parameters.\" The parameter $\\varepsilon/L$ represents the ratio of the numerical interface thickness to the characteristic length, which is a feature of the numerical method (Level Set), not the physical problem. Furthermore, the set of physical parameters is **incomplete** as it omits the Reynolds number (or an equivalent) that characterizes the role of viscosity.\n-   **Regime**: The omission of a condition on the Reynolds number ($\\text{Re}_{\\mathrm{ref}} \\gg 1$) fails to capture the requirement that \"viscous effects not dominant.\"\n-   **Verdict**: **Incorrect**.\n\nBased on the detailed analysis, only option A provides a correct and complete answer.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The accuracy of geometric interface capturing methods like the Volume of Fluid (VOF) with Piecewise Linear Interface Calculation (PLIC) lies in their ability to precisely compute mass fluxes based on the reconstructed interface within each cell. This exercise provides a detailed look at this core mechanism by focusing on a single control volume and a single advection step (). By manually calculating the volume of fluid transferred across a cell face, you will gain a concrete understanding of how the geometric advection algorithm conserves mass and moves the interface, a fundamental building block for any VOF-based solver.",
            "id": "3968668",
            "problem": "Consider a three-dimensional Cartesian control volume used in Computational Fluid Dynamics (CFD) for two-phase interface advection with the Volume of Fluid (VOF) method and a Piecewise Linear Interface Calculation (PLIC) reconstruction. The rectangular cell occupies the region $x \\in [0,\\Delta x]$, $y \\in [0,\\Delta y]$, $z \\in [0,\\Delta z]$, with $\\Delta x = 0.02$ m, $\\Delta y = 0.02$ m, and $\\Delta z = 0.01$ m. Within this cell, fluid $A$ is separated from fluid $B$ by a planar interface whose unit normal is $\\boldsymbol{n} = (1,1,0)/\\sqrt{2}$, and the reconstructed plane has the equation $x + y = 0.023$ m, so that the region occupied by fluid $A$ is $\\{(x,y,z) \\,|\\, x + y \\le 0.023\\ \\text{m}\\}$.\n\nAssume a directionally split advection step along the $x$-direction. The velocity field is uniform and constant over the time step, with $\\boldsymbol{u} = (u_{x},0,0)$, where $u_{x} = 2.0$ m/s. The time step is $\\Delta t = 0.0015$ s, so the upwind slab thickness adjacent to the right $x$-face is $s = u_{x}\\,\\Delta t$. There is no motion in $y$ or $z$ and no deformation of the interface during this split step. The geometric flux of fluid $A$ leaving the cell through the right $x$-face at $x = \\Delta x$ over the time interval $\\Delta t$ is defined as the volume of the intersection of fluid $A$ in the cell with the $x$-slab $x \\in [\\Delta x - s, \\Delta x]$, integrated over $y$ and $z$.\n\nStarting from the conservation law for the advected characteristic function of fluid $A$, and using the above PLIC description, derive the appropriate geometric integral and compute the total volume of fluid $A$ that exits the cell through the right $x$-face during the time step. Express your final numerical answer in cubic meters. Round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the volume of fluid A that exits a rectangular control volume through its right face during a directionally split advection step. The method described is a Piecewise Linear Interface Calculation (PLIC) within the Volume of Fluid (VOF) framework.\n\nThe conservation law for the volume fraction of fluid A, represented by a characteristic function $F_A$ ($F_A=1$ in fluid A, $F_A=0$ in fluid B), is given by the advection equation:\n$$ \\frac{\\partial F_A}{\\partial t} + \\nabla \\cdot (\\boldsymbol{u} F_A) = 0 $$\nFor a single advection step in the $x$-direction with a constant velocity $u_x$, this simplifies to:\n$$ \\frac{\\partial F_A}{\\partial t} + u_x \\frac{\\partial F_A}{\\partial x} = 0 $$\nThe volume of fluid A, $\\delta V_{A,\\text{out}}$, exiting the cell through the right face (at $x=\\Delta x$) during a time step $\\Delta t$ is the time integral of the flux across that face. For a first-order explicit time integration scheme, this fluxed volume is geometrically interpreted as the volume of fluid A residing in an \"advection slab\" adjacent to the upwind side of the face. This slab has a thickness $s = u_x \\Delta t$.\n\nThe problem explicitly defines this fluxed volume as the volume of the intersection of three regions:\n1.  The control volume (the cell): $V_{\\text{cell}} = \\{ (x,y,z) \\,|\\, 0 \\le x \\le \\Delta x, 0 \\le y \\le \\Delta y, 0 \\le z \\le \\Delta z \\}$.\n2.  The region occupied by fluid A: $V_A = \\{ (x,y,z) \\,|\\, x + y \\le C \\}$, where $C=0.023$ m.\n3.  The advection slab: $V_{\\text{slab}} = \\{ (x,y,z) \\,|\\, \\Delta x - s \\le x \\le \\Delta x \\}$.\n\nWe are given the following parameters:\n- Cell dimensions: $\\Delta x = 0.02$ m, $\\Delta y = 0.02$ m, $\\Delta z = 0.01$ m.\n- Velocity: $u_x = 2.0$ m/s.\n- Time step: $\\Delta t = 0.0015$ s.\n\nFirst, we calculate the thickness of the advection slab, $s$:\n$$ s = u_x \\Delta t = (2.0 \\, \\text{m/s}) \\times (0.0015 \\, \\text{s}) = 0.003 \\, \\text{m} $$\nThe advection slab occupies the region $x \\in [\\Delta x - s, \\Delta x]$. Substituting the values for $\\Delta x$ and $s$:\n$$ x \\in [0.02 \\, \\text{m} - 0.003 \\, \\text{m}, 0.02 \\, \\text{m}] = [0.017 \\, \\text{m}, 0.02 \\, \\text{m}] $$\nThe volume to be calculated, $\\delta V_A$, is the volume of the region $R = V_{\\text{cell}} \\cap V_A \\cap V_{\\text{slab}}$. The boundaries for this region $R$ are defined by the intersection of all constraints:\n1.  $0 \\le x \\le 0.02$\n2.  $0 \\le y \\le 0.02$\n3.  $0 \\le z \\le 0.01$\n4.  $x+y \\le 0.023$\n5.  $0.017 \\le x \\le 0.02$\n\nCombining constraints 1 and 5 gives the definitive range for $x$: $0.017 \\le x \\le 0.02$.\nThe constraint for $y$ becomes $0 \\le y \\le \\min(0.02, 0.023 - x)$.\nFor the range of $x \\in [0.017, 0.02]$, the term $0.023 - x$ varies from $0.023 - 0.017 = 0.006$ at the lower bound of $x$ to $0.023 - 0.02 = 0.003$ at the upper bound of $x$. In this entire range, $0.023 - x  0.02$. Therefore, the upper bound on $y$ is simply $y = 0.023 - x$.\n\nThe integration limits for the volume $\\delta V_A$ are:\n$$ \\delta V_A = \\int_{z=0}^{0.01} \\int_{x=0.017}^{0.02} \\int_{y=0}^{0.023-x} dy \\, dx \\, dz $$\nSince the integrand is $1$ and the limits for $z$ are independent of $x$ and $y$, we can separate the integral:\n$$ \\delta V_A = \\left( \\int_{z=0}^{0.01} dz \\right) \\left( \\int_{x=0.017}^{0.02} \\int_{y=0}^{0.023-x} dy \\, dx \\right) $$\nThe first integral is simply the height of the domain, $\\Delta z = 0.01$ m. The second integral represents the cross-sectional area of the fluxed volume in the $xy$-plane, let's call it $A_{\\text{flux}}$.\n$$ A_{\\text{flux}} = \\int_{x=0.017}^{0.02} \\left[ y \\right]_{y=0}^{0.023-x} dx = \\int_{0.017}^{0.02} (0.023 - x) \\, dx $$\nWe now evaluate this integral:\n$$ A_{\\text{flux}} = \\left[ 0.023x - \\frac{x^2}{2} \\right]_{0.017}^{0.02} $$\n$$ A_{\\text{flux}} = \\left( 0.023 \\cdot 0.02 - \\frac{(0.02)^2}{2} \\right) - \\left( 0.023 \\cdot 0.017 - \\frac{(0.017)^2}{2} \\right) $$\n$$ A_{\\text{flux}} = \\left( 0.00046 - \\frac{0.0004}{2} \\right) - \\left( 0.000391 - \\frac{0.000289}{2} \\right) $$\n$$ A_{\\text{flux}} = (0.00046 - 0.0002) - (0.000391 - 0.0001445) $$\n$$ A_{\\text{flux}} = 0.00026 - 0.0002465 $$\n$$ A_{\\text{flux}} = 0.0000135 \\, \\text{m}^2 $$\nThe total fluxed volume $\\delta V_A$ is this area multiplied by the cell depth $\\Delta z$:\n$$ \\delta V_A = A_{\\text{flux}} \\times \\Delta z = (0.0000135 \\, \\text{m}^2) \\times (0.01 \\, \\text{m}) $$\n$$ \\delta V_A = 0.000000135 \\, \\text{m}^3 = 1.35 \\times 10^{-7} \\, \\text{m}^3 $$\nThe problem asks for the answer to be rounded to four significant figures.\n$$ \\delta V_A \\approx 1.350 \\times 10^{-7} \\, \\text{m}^3 $$",
            "answer": "$$\\boxed{1.350 \\times 10^{-7}}$$"
        },
        {
            "introduction": "Writing a solver is only half the battle; verifying its correctness and understanding its performance are equally critical. This practice guides you through the fundamental process of numerical error analysis and convergence testing for both VOF and Level Set methods (). By implementing simple advection schemes and measuring their error against an exact solution, you will empirically determine their order of accuracy, directly observing the trade-offs between methods, such as the diffusive nature of a first-order VOF scheme versus the higher-order accuracy of a semi-Lagrangian Level Set approach.",
            "id": "3968670",
            "problem": "Consider one-dimensional periodic advection on the unit interval with coordinate $x \\in [0,1)$ and constant velocity $u$. Two interface-capturing formulations are examined: Volume of Fluid (VOF) and Level Set (LS). The advection is governed by the conservation law $\\partial_t q + u \\,\\partial_x q = 0$, where $q$ is a scalar quantity representing either the VOF volume fraction $C$ or the Level Set signed-distance function $\\phi$. From first principles, the conservation statement and kinematic transport yield that under exact evolution for constant $u$ and periodic boundaries, any initial field is translated by distance $u\\,t$ and returns to its initial state after a period $T$ satisfying $u\\,T = 1$.\n\nYou must derive, implement, and perform error analysis and convergence studies for the following two discrete formulations:\n\n- Volume of Fluid (VOF): The cell-averaged volume fraction $C_i^n$ on a uniform grid of $N$ cells with cell width $dx = 1/N$ and time step $dt$ obeys a finite-volume upwind update for $u  0$, where the face fluxes are $F_{i+1/2}^n = u\\,C_i^n$, so that $C_i^{n+1} = C_i^n - \\frac{dt}{dx}\\left(F_{i+1/2}^n - F_{i-1/2}^n\\right)$. This is the donor-cell Godunov scheme, which is total variation diminishing and first-order accurate.\n\n- Level Set (LS): The signed-distance field $\\phi(x,t)$ is discretized at cell centers $x_i = \\left(i+\\frac{1}{2}\\right)dx$, and advanced by semi-Lagrangian advection $\\phi^{n+1}(x_i) = \\phi^n\\!\\left(x_i - u\\,dt\\right)$ using periodic, piecewise-linear interpolation. Reinitialization is not performed, to isolate pure advection error.\n\nFundamental bases to use include: conservation of mass for advection, the Courant–Friedrichs–Lewy (CFL) stability condition, and the definition of numerical error norms. The Courant–Friedrichs–Lewy (CFL) number is $\\mathrm{CFL} = \\frac{u\\,dt}{dx}$, and numerical stability of the donor-cell scheme requires $\\mathrm{CFL} \\le 1$. The time horizon is chosen as $T$ such that $u\\,T = 1$ to complete one domain traversal. For each grid, the number of time steps $N_t$ must be an integer; adjust $dt$ to satisfy $dt = T/N_t$.\n\nInitial conditions:\n- For VOF, initialize $C(x,0)$ as a Heaviside step field with $C(x,0) = 1$ for $x \\le x_0$ and $C(x,0) = 0$ otherwise.\n- For LS, initialize $\\phi(x,0)$ as the periodic signed distance to the interface at $x_0$, i.e., $\\phi(x,0) = d(x;x_0)$ where $d(x;x_0) = \\min\\left(x-x_0,\\,x-x_0-1,\\,x-x_0+1\\right)$ with the sign inherited from the shortest displacement on the periodic interval.\n\nAfter integrating to time $T$ with periodic boundary conditions, compute the following errors against the exact fields (which equal the initial fields due to one full period advection):\n- VOF $L^1$ error: $E_{L^1}^{\\mathrm{VOF}} = dx \\sum_i \\left| C_i(T) - C_i(0) \\right|$.\n- LS $L^2$ error: $E_{L^2}^{\\mathrm{LS}} = \\sqrt{ dx \\sum_i \\left( \\phi_i(T) - \\phi_i(0) \\right)^2 }$.\n\nFor each scenario, perform grid refinement with a sequence of $N$ values and compute the Experimental Order of Convergence (EOC) by\n$$\n\\mathrm{EOC} = \\frac{ \\log\\left( \\frac{E(h_1)}{E(h_2)} \\right) }{ \\log\\left( \\frac{h_1}{h_2} \\right) }, \\quad h = dx = \\frac{1}{N},\n$$\nfor successive pairs in the refinement sequence, and report the mean of the successive-pair EOCs for each method.\n\nYou must implement a program that:\n- Executes the schemes described above for each test scenario.\n- Computes $E_{L^1}^{\\mathrm{VOF}}$ and $E_{L^2}^{\\mathrm{LS}}$ for each grid size.\n- Computes the mean EOC across the successive grid pairs for VOF and LS separately.\n- Produces a single-line output with the mean EOCs for all scenarios, formatted as a Python-style list of six floats with exactly six digits after the decimal point, in the order described below.\n\nTest suite:\n- Scenario $\\mathrm{A}$ (happy path): $u = 1$, $x_0 = 0.33$, $\\mathrm{CFL} = 0.50$, $T = 1$, $N \\in \\{100, 200, 400, 800\\}$.\n- Scenario $\\mathrm{B}$ (alignment edge case): $u = 1$, $x_0 = 0.25$, $\\mathrm{CFL} = 0.50$, $T = 1$, $N \\in \\{64, 128, 256, 512\\}$ such that $x_0$ aligns with a cell boundary for these uniform grids.\n- Scenario $\\mathrm{C}$ (near-CFL stability boundary): $u = 1$, $x_0 = 0.33$, $\\mathrm{CFL} = 0.95$, $T = 1$, $N \\in \\{100, 200, 400, 800\\}$.\n\nFinal output format specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact order: $\\left[ \\overline{\\mathrm{EOC}}_{\\mathrm{VOF},\\mathrm{A}}, \\overline{\\mathrm{EOC}}_{\\mathrm{LS},\\mathrm{A}}, \\overline{\\mathrm{EOC}}_{\\mathrm{VOF},\\mathrm{B}}, \\overline{\\mathrm{EOC}}_{\\mathrm{LS},\\mathrm{B}}, \\overline{\\mathrm{EOC}}_{\\mathrm{VOF},\\mathrm{C}}, \\overline{\\mathrm{EOC}}_{\\mathrm{LS},\\mathrm{C}} \\right]$, where each entry is a float printed with six digits after the decimal point (e.g., $[0.987654,1.012345, \\dots ]$). No physical units are involved; all quantities are dimensionless. Radians or degrees are not applicable. The values are floats and must be printed in the specified single-line format.",
            "solution": "The problem requires the derivation, implementation, and comparative error analysis of two numerical methods for solving the one-dimensional linear advection equation, $\\partial_t q + u \\,\\partial_x q = 0$, on a periodic domain $x \\in [0,1)$. The scalar quantity $q(x,t)$ is advected with a constant velocity $u$. We examine the Volume of Fluid (VOF) method and the Level Set (LS) method. The simulation is run for a time period $T$ such that $uT=1$, which corresponds to one full traversal of the domain. For exact advection, the solution at time $T$ must be identical to the initial condition, $q(x,T) = q(x,0)$. The numerical error is measured by comparing the computed solution at time $T$ to the initial condition.\n\nThe validation of the problem statement confirms that it is scientifically grounded, well-posed, objective, and complete. All parameters, equations, and conditions are provided unambiguously. The methods described are standard in computational fluid dynamics. The procedure for calculating the time step, while requiring careful interpretation, is consistent: for a target Courant–Friedrichs–Lewy (CFL) number, the number of time steps $N_t$ is determined by rounding up to the nearest integer to ensure the simulation concludes at exactly time $T$, and the time step $dt$ is then adjusted accordingly. The problem is valid and can be solved as stated.\n\nThe solution proceeds by first defining the discretization and numerical schemes for both VOF and LS methods, then detailing the procedure for the convergence study.\n\n**Discretization and Time Stepping**\n\nThe spatial domain $[0,1)$ is discretized into $N$ uniform cells, each of width $dx = 1/N$. Cell $i$ (for $i=0, 1, \\dots, N-1$) occupies the interval $[i \\cdot dx, (i+1) \\cdot dx]$. Quantities are either cell-averaged (VOF) or defined at cell centers $x_i = (i+0.5)dx$ (LS).\n\nThe total simulation time is $T = 1/u$. To ensure the simulation ends exactly at time $T$ with an integer number of time steps, we first calculate the ideal number of steps based on the target CFL number, $\\mathrm{CFL}_{\\text{target}} = u \\cdot dt_{\\text{target}}/dx$. This gives an ideal number of steps $N_{t,\\text{ideal}} = T/dt_{\\text{target}} = (1/u) / (\\mathrm{CFL}_{\\text{target}} \\cdot dx / u) = 1/(\\mathrm{CFL}_{\\text{target}} \\cdot dx) = N/\\mathrm{CFL}_{\\text{target}}$. Since the number of steps $N_t$ must be an integer, we set $N_t = \\lceil N/\\mathrm{CFL}_{\\text{target}} \\rceil$. The actual time step used in the simulation is then $dt = T/N_t$. The resulting effective CFL number is $\\mathrm{CFL}_{\\text{eff}} = u \\cdot dt/dx = u \\cdot (T/N_t)/dx = u \\cdot ((1/u)/N_t)/(1/N) = N/N_t \\le \\mathrm{CFL}_{\\text{target}}$, satisfying the stability condition for the VOF scheme.\n\n**Volume of Fluid (VOF) Method**\n\nThe VOF method tracks the volume fraction of a fluid in each computational cell. The variable is the cell-averaged volume fraction, $C_i^n \\approx \\frac{1}{dx} \\int_{i \\cdot dx}^{(i+1)dx} C(x, t^n) dx$.\n\n*   **Initial Condition**: The initial field is a Heaviside step function, $C(x,0) = 1$ for $x \\le x_0$ and $C(x,0)=0$ otherwise. For the discretized field, each cell value $C_i(0)$ is computed by averaging over the cell area:\n    $$C_i(0) = \\frac{1}{dx} \\int_{i \\cdot dx}^{(i+1)dx} C(x,0) \\,dx$$\n    This integral evaluates to the length of the intersection of the cell interval $[i \\cdot dx, (i+1) \\cdot dx]$ with the region $[0, x_0]$, divided by $dx$. This results in $C_i(0)=1$ for cells entirely to the left of $x_0$, $C_i(0)=0$ for cells entirely to the right, and a fractional value for the single cell containing $x_0$. Let $j = \\lfloor x_0/dx \\rfloor$. Then $C_i(0)=1$ for $ij$, $C_i(0)=0$ for $ij$, and $C_j(0) = (x_0 - j \\cdot dx)/dx$.\n\n*   **Numerical Scheme**: We use the first-order upwind (donor-cell) finite volume scheme. For $u0$, the flux at the right face of cell $i$ is $F_{i+1/2}^n = u C_i^n$. The update rule is:\n    $$C_i^{n+1} = C_i^n - \\frac{dt}{dx} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right) = C_i^n - \\frac{u \\, dt}{dx} \\left( C_i^n - C_{i-1}^n \\right)$$\n    Periodic boundary conditions imply $C_{-1}^n = C_{N-1}^n$. This scheme is known to be numerically diffusive, which will smear the sharp interface.\n\n*   **Error Calculation**: The $L^1$ error is computed at time $T$ against the initial condition:\n    $$E_{L^1}^{\\mathrm{VOF}} = dx \\sum_{i=0}^{N-1} | C_i(T) - C_i(0) |$$\n\n**Level Set (LS) Method**\n\nThe LS method tracks the interface implicitly as the zero-contour of a signed distance function $\\phi(x,t)$. The variable $\\phi_i^n$ is the value of this function at the cell center $x_i$ at time $t^n$.\n\n*   **Initial Condition**: The initial field $\\phi(x,0)$ is the periodic signed distance to the interface at $x_0$. As per the problem description, this is computed as the shortest displacement vector on the periodic domain. For a given point $x$, we evaluate $\\delta = x-x_0$, and the signed distance is the value among $\\{\\delta, \\delta-1, \\delta+1\\}$ with the minimum absolute value. This is equivalent to wrapping the difference $x-x_0$ into the interval $[-0.5, 0.5)$.\n\n*   **Numerical Scheme**: The field is advanced using semi-Lagrangian advection:\n    $$\\phi_i^{n+1} = \\phi^n(x_i - u \\cdot dt)$$\n    This means the new value at a grid point $x_i$ is the value of the old field $\\phi^n$ at the departure point $x_d = x_i - u \\cdot dt$. Since $x_d$ does not generally coincide with a grid point, we must interpolate. We use piecewise linear interpolation on the grid of values $\\{\\phi_j^n\\}$, accounting for the periodic nature of the domain.\n\n*   **Error Calculation**: The $L^2$ error is computed at time $T$ against the initial condition:\n    $$E_{L^2}^{\\mathrm{LS}} = \\sqrt{ dx \\sum_{i=0}^{N-1} \\left( \\phi_i(T) - \\phi_i(0) \\right)^2 }$$\n\n**Convergence Analysis**\n\nFor each scenario and method, a grid refinement study is performed using the specified sequence of grid sizes $N$. The error $E$ is computed for each grid size, which corresponds to a mesh spacing $h=dx=1/N$. The Experimental Order of Convergence (EOC) is calculated for each pair of consecutive grids in the refinement sequence $(h_1, h_2)$ with corresponding errors $(E_1, E_2)$:\n$$ \\mathrm{EOC} = \\frac{ \\log( E_1 / E_2) }{ \\log( h_1 / h_2 ) } $$\nSince the grid is refined by a factor of $2$ in all cases, $h_1/h_2 = N_2/N_1 = 2$. The formula simplifies to $\\mathrm{EOC} = \\log_2(E_1/E_2)$. The final reported value is the arithmetic mean of the EOCs calculated from all successive pairs in the sequence.\n\nThe donor-cell VOF scheme is first-order accurate, so its EOC is expected to be approximately $1$. The semi-Lagrangian LS scheme with linear interpolation is second-order accurate for smooth solutions, so its EOC is expected to be approximately $2$. However, specific conditions like the interface aligning with grid boundaries (Scenario B) can affect the observed convergence rate.",
            "answer": "[0.989785,1.998399,1.000185,1.999719,0.992688,1.999557]"
        }
    ]
}