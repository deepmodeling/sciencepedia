{
    "hands_on_practices": [
        {
            "introduction": "Physical models often introduce source terms into the governing conservation laws, which can pose significant challenges to the stability of a numerical solver. A fundamental technique in implicit finite-volume methods is to linearize these source terms in a way that enhances the diagonal dominance of the algebraic system. This exercise  provides hands-on practice with this core concept by asking you to linearize the widely-used Darcy-Forchheimer drag model for porous media, ensuring the critical stability condition $S_P \\le 0$ is satisfied.",
            "id": "3995189",
            "problem": "A steady, incompressible, single-phase flow of air through an isotropic porous block in an aircraft environmental control duct is modeled using a finite-volume implicit solver in Computational Fluid Dynamics (CFD). The streamwise momentum equation includes a volumetric drag source term modeling the porous medium using the Darcy–Forchheimer law. In the streamwise direction, the drag source per unit volume is\n$$\nS(u) = -\\frac{\\mu}{K}\\,u \\;-\\; \\rho\\,C_{F}\\,|u|\\,u,\n$$\nwhere $u$ is the local cell-centered streamwise velocity, $\\mu$ is the dynamic viscosity, $K$ is the intrinsic permeability, $\\rho$ is the density, and $C_{F}$ is the Forchheimer coefficient.\n\nTo advance the solution implicitly, the source term is written in a linearized form\n$$\nS(u) \\approx S_{P}\\,u \\;+\\; S_{C},\n$$\nwith the requirement that $S_{P} \\le 0$ to promote diagonal dominance and boundedness of the discretized momentum equation. Adopt the standard bounded semi-implicit (Picard) linearization in which the nonlinearity $|u|$ is frozen at the current iterate $u^{(k)}$.\n\n1) Starting from the expression for $S(u)$ and the stated linearization strategy, derive $S_{P}$ and $S_{C}$ in terms of $\\mu$, $K$, $\\rho$, $C_{F}$, and $|u^{(k)}|$.\n\n2) For a control volume with the following properties at the current iterate,\n$$\n\\mu = 1.8 \\times 10^{-5} \\;\\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-1},\\quad\n\\rho = 1.2 \\;\\text{kg}\\,\\text{m}^{-3},\\quad\nK = 5.0 \\times 10^{-9} \\;\\text{m}^{2},\\quad\nC_{F} = 250 \\;\\text{m}^{-1},\\quad\n|u^{(k)}| = 12 \\;\\text{m}\\,\\text{s}^{-1},\n$$\ncompute the numerical value of $S_{P}$ in the units $\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$. Round your answer to four significant figures. Express the final coefficient in $\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$.",
            "solution": "The user has provided a problem in the field of Computational Fluid Dynamics (CFD), specifically concerning the linearization of a source term in the momentum equation.\n\n### Problem Validation\n\nFirst, a rigorous validation of the problem statement is conducted.\n\n**Step 1: Extract Givens**\n-   **Problem Type**: Steady, incompressible, single-phase flow of air in a porous block.\n-   **Methodology**: Finite-volume implicit solver for CFD.\n-   **Source Term**: The volumetric drag source term in the streamwise momentum equation is given by the Darcy-Forchheimer law:\n    $$S(u) = -\\frac{\\mu}{K}\\,u \\;-\\; \\rho\\,C_{F}\\,|u|\\,u$$\n    where $u$ is the local streamwise velocity, $\\mu$ is dynamic viscosity, $K$ is intrinsic permeability, $\\rho$ is density, and $C_{F}$ is the Forchheimer coefficient.\n-   **Linearization**: The source term is to be linearized as:\n    $$S(u) \\approx S_{P}\\,u \\;+\\; S_{C}$$\n-   **Constraint**: The coefficient $S_{P}$ must satisfy $S_{P} \\le 0$.\n-   **Linearization Scheme**: A standard bounded semi-implicit (Picard) linearization is to be used, where the non-linear quantity $|u|$ is frozen at its value from the current iterate, denoted as $|u^{(k)}|$.\n-   **Part 1 Objective**: Derive the expressions for $S_{P}$ and $S_{C}$.\n-   **Part 2 Objective**: Compute the numerical value of $S_{P}$ using the provided data.\n-   **Numerical Data for Part 2**:\n    -   $\\mu = 1.8 \\times 10^{-5} \\;\\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-1}$\n    -   $\\rho = 1.2 \\;\\text{kg}\\,\\text{m}^{-3}$\n    -   $K = 5.0 \\times 10^{-9} \\;\\text{m}^{2}$\n    -   $C_{F} = 250 \\;\\text{m}^{-1}$\n    -   $|u^{(k)}| = 12 \\;\\text{m}\\,\\text{s}^{-1}$\n-   **Output Specification for Part 2**: $S_{P}$ is to be calculated in units of $\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$ and rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is scientifically sound. The Darcy-Forchheimer equation is a standard empirical model for flow through porous media. The linearization of source terms using a Picard-type iteration is a fundamental and widely used technique in implicit finite-volume CFD to ensure numerical stability and convergence.\n-   **Well-Posedness**: The problem is well-posed. It provides a clear physical model, a specific mathematical procedure for linearization, and all necessary data for the required calculations. The objectives are unambiguous.\n-   **Objectivity**: The problem is stated using precise, objective technical terminology common to the fields of fluid dynamics and numerical analysis.\n-   **Consistency Check**: The units are consistent. The units of the source term $S(u)$ are force per unit volume, $(\\text{kg} \\cdot \\text{m} \\cdot \\text{s}^{-2}) / \\text{m}^3 = \\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-2}$. The linearized form is $S(u) = S_P u + S_C$. The term $S_P u$ must have these same units. Since the units of velocity $u$ are $\\text{m}\\,\\text{s}^{-1}$, the units of $S_P$ must be $(\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-2}) / (\\text{m}\\,\\text{s}^{-1}) = \\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$, which matches the problem's request. All given values are physically plausible for air flow in an engineered porous material.\n\n**Step 3: Verdict and Action**\n-   **Verdict**: The problem is valid. It is scientifically sound, well-posed, objective, and contains all necessary information.\n-   **Action**: Proceed to provide a complete solution.\n\n### Part 1: Derivation of $S_{P}$ and $S_{C}$\n\nThe source term is given by:\n$$S(u) = -\\frac{\\mu}{K}\\,u \\;-\\; \\rho\\,C_{F}\\,|u|\\,u$$\nThe goal is to linearize this expression into the form $S(u) \\approx S_{P}\\,u + S_{C}$. The specified method is Picard linearization, which means that any coefficients of the variable $u$ are treated explicitly, i.e., they are evaluated using known values from the previous iteration, denoted by the superscript $(k)$.\n\nThe non-linearity in the source term arises from the product $|u|\\,u$. The instruction is to \"freeze\" the $|u|$ term at its value from the current iterate, $|u^{(k)}|$. Applying this to the source term expression yields:\n$$S(u) \\approx -\\frac{\\mu}{K}\\,u \\;-\\; \\rho\\,C_{F}\\,|u^{(k)}|\\,u$$\nThis expression is now linear with respect to the unknown velocity $u$ (which would be at iteration level $k+1$ in a solver). We can factor out $u$ to match the target linearized form:\n$$S(u) \\approx \\left( -\\frac{\\mu}{K} \\;-\\; \\rho\\,C_{F}\\,|u^{(k)}| \\right) u$$\nBy comparing this directly with the general linearized form $S(u) \\approx S_{P}\\,u + S_{C}$, we can identify the coefficients $S_{P}$ and $S_{C}$.\nThe coefficient of $u$ corresponds to $S_{P}$:\n$$S_{P} = -\\frac{\\mu}{K} - \\rho\\,C_{F}\\,|u^{(k)}|$$\nThe remaining part of the expression, which is independent of $u$, corresponds to $S_{C}$. In this case, there is no such term.\n$$S_{C} = 0$$\nThe problem requires that $S_{P} \\le 0$. We must check if our derived expression satisfies this condition. The physical parameters $\\mu$, $K$, $\\rho$, and $C_{F}$ are all positive definite. The absolute velocity $|u^{(k)}|$ is non-negative. Therefore:\n-   $\\frac{\\mu}{K} > 0$\n-   $\\rho\\,C_{F}\\,|u^{(k)}| \\ge 0$\nThe expression for $S_{P}$ is the negative sum of these two terms:\n$$S_{P} = - \\left( \\frac{\\mu}{K} + \\rho\\,C_{F}\\,|u^{(k)}| \\right)$$\nSince the term in the parentheses is strictly positive (assuming non-zero flow), $S_{P}$ is guaranteed to be negative, thus satisfying the $S_{P} \\le 0$ constraint required for promoting diagonal dominance in the discretized algebraic equations.\n\n### Part 2: Numerical Calculation of $S_{P}$\n\nUsing the derived expression for $S_{P}$ and the provided numerical data:\n$$S_{P} = -\\frac{\\mu}{K} - \\rho\\,C_{F}\\,|u^{(k)}|$$\nSubstitute the given values:\n-   $\\mu = 1.8 \\times 10^{-5} \\;\\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-1}$\n-   $\\rho = 1.2 \\;\\text{kg}\\,\\text{m}^{-3}$\n-   $K = 5.0 \\times 10^{-9} \\;\\text{m}^{2}$\n-   $C_{F} = 250 \\;\\text{m}^{-1}$\n-   $|u^{(k)}| = 12 \\;\\text{m}\\,\\text{s}^{-1}$\n\nWe calculate the two components of $S_{P}$ separately.\n\nFirst, the Darcy (viscous) component:\n$$-\\frac{\\mu}{K} = -\\frac{1.8 \\times 10^{-5} \\;\\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-1}}{5.0 \\times 10^{-9} \\;\\text{m}^{2}} = -0.36 \\times 10^{4} \\;\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1} = -3600 \\;\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$$\n\nSecond, the Forchheimer (inertial) component:\n$$-\\rho\\,C_{F}\\,|u^{(k)}| = -(1.2 \\;\\text{kg}\\,\\text{m}^{-3}) \\times (250 \\;\\text{m}^{-1}) \\times (12 \\;\\text{m}\\,\\text{s}^{-1})$$\n$$-\\rho\\,C_{F}\\,|u^{(k)}| = -(1.2 \\times 250 \\times 12) \\;\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$$\n$$-\\rho\\,C_{F}\\,|u^{(k)}| = -(300 \\times 12) \\;\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1} = -3600 \\;\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$$\n\nNow, sum the two components to find the total value of $S_{P}$:\n$$S_{P} = (-3600) + (-3600) \\;\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$$\n$$S_{P} = -7200 \\;\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$$\n\nThe problem requires the answer to be rounded to four significant figures. The number $-7200$ can be expressed in scientific notation to explicitly show the significant figures.\n$$S_{P} = -7.200 \\times 10^{3} \\;\\text{kg}\\,\\text{m}^{-3}\\,\\text{s}^{-1}$$\nThis representation has four significant figures ($7$, $2$, $0$, $0$).",
            "answer": "$$\\boxed{-7.200 \\times 10^{3}}$$"
        },
        {
            "introduction": "While stable linearization is essential, for highly nonlinear source terms, we must also consider the accuracy of the approximation and its impact on convergence speed. Radiative heat transfer, with its characteristic $T^4$ temperature dependence, presents a classic example of a stiff source term where the choice of linearization is crucial. This practice  moves beyond basic stability to explore the effectiveness of a Newton (Taylor series) linearization by having you derive and analyze the associated error, providing clear insight into why iterative updates are vital for efficient and robust convergence.",
            "id": "3984588",
            "problem": "Consider a gray, absorbing-emitting participating medium in a computational thermal engineering simulation of the energy equation using the Finite Volume Method (FVM). The volumetric radiative source term for a negligible-irradiation limit can be modeled as a function of temperature using the Stefan–Boltzmann law as $$S(T) = \\beta T^{4},$$ where $\\beta = 4 \\kappa \\sigma$, $\\kappa$ is the spectral-averaged absorption coefficient, and $\\sigma$ is the Stefan–Boltzmann constant. In iterative solvers, nonlinear source terms are commonly linearized about a reference temperature $T^{*}$ using a first-order Taylor approximation. Define the linearized source $$S_{L}(T) = S(T^{*}) + \\left.\\frac{dS}{dT}\\right|_{T^{*}}\\,(T - T^{*}),$$ and the dimensionless linearization error at a target temperature $T$ as $$\\tau_{S} \\equiv \\frac{S(T) - S_{L}(T)}{S(T)}.$$\n\nStarting only from the Stefan–Boltzmann law, the definition of $S(T)$ above, and the first-order Taylor series expansion, derive a closed-form analytic expression for $\\tau_{S}$ in terms of the ratio $r = T^{*}/T$. Then, evaluate $\\tau_{S}$ for $T = 1000\\,\\text{K}$ and $T^{*} = 900\\,\\text{K}$. Finally, based on the derived expression, explain whether updating $T^{*}$ to be closer to $T$ during iterations improves the convergence characteristics of the nonlinear source-term treatment, and justify your conclusion by analyzing the dependence of $\\tau_{S}$ on $r$.\n\nExpress the final numerical value of $\\tau_{S}$ as a dimensionless number and round your answer to four significant figures. No physical units are required for $\\tau_{S}$.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of radiative heat transfer and numerical methods, specifically source term linearization via Taylor series expansion, a standard technique in computational thermal engineering. The problem is well-posed, objective, and contains all necessary information to derive a unique solution and perform the requested analysis.\n\nThe goal is to derive an expression for the dimensionless linearization error $\\tau_S$, evaluate it for specific temperatures, and analyze its behavior.\n\nThe volumetric radiative source term is given by the Stefan–Boltzmann law as:\n$$S(T) = \\beta T^{4}$$\nwhere $\\beta$ is a constant.\n\nThe linearized source term, $S_{L}(T)$, is based on a first-order Taylor expansion around a reference temperature $T^{*}$:\n$$S_{L}(T) = S(T^{*}) + \\left.\\frac{dS}{dT}\\right|_{T^{*}}\\,(T - T^{*})$$\n\nFirst, we find the derivative of $S(T)$ with respect to $T$:\n$$\\frac{dS}{dT} = \\frac{d}{dT}(\\beta T^{4}) = 4 \\beta T^{3}$$\n\nEvaluating this derivative at $T = T^{*}$ gives:\n$$\\left.\\frac{dS}{dT}\\right|_{T^{*}} = 4 \\beta (T^{*})^{3}$$\n\nWe also have $S(T^{*}) = \\beta (T^{*})^{4}$. Substituting these into the expression for $S_{L}(T)$:\n$$S_{L}(T) = \\beta (T^{*})^{4} + 4 \\beta (T^{*})^{3} (T - T^{*})$$\n\nThe dimensionless linearization error, $\\tau_{S}$, is defined as:\n$$\\tau_{S} \\equiv \\frac{S(T) - S_{L}(T)}{S(T)} = 1 - \\frac{S_{L}(T)}{S(T)}$$\n\nSubstituting the expressions for $S(T)$ and $S_{L}(T)$:\n$$\\tau_{S} = 1 - \\frac{\\beta (T^{*})^{4} + 4 \\beta (T^{*})^{3} (T - T^{*})}{\\beta T^{4}}$$\n\nThe constant $\\beta$ cancels from the numerator and denominator:\n$$\\tau_{S} = 1 - \\frac{(T^{*})^{4} + 4 (T^{*})^{3} T - 4 (T^{*})^{4}}{T^{4}}$$\n$$\\tau_{S} = 1 - \\frac{4 T (T^{*})^{3} - 3 (T^{*})^{4}}{T^{4}}$$\n\nTo express this in terms of the ratio $r = T^{*}/T$, we divide the numerator and denominator of the fraction by $T^{4}$:\n$$\\tau_{S} = 1 - \\left( \\frac{4 T (T^{*})^{3}}{T^{4}} - \\frac{3 (T^{*})^{4}}{T^{4}} \\right)$$\n$$\\tau_{S} = 1 - \\left( 4 \\left(\\frac{T^{*}}{T}\\right)^{3} - 3 \\left(\\frac{T^{*}}{T}\\right)^{4} \\right)$$\n\nSubstituting $r = T^{*}/T$, we obtain the closed-form analytic expression for $\\tau_{S}$ in terms of $r$:\n$$\\tau_{S}(r) = 1 - 4r^{3} + 3r^{4}$$\n\nNext, we evaluate $\\tau_{S}$ for $T = 1000\\,\\text{K}$ and $T^{*} = 900\\,\\text{K}$. The ratio $r$ is:\n$$r = \\frac{T^{*}}{T} = \\frac{900\\,\\text{K}}{1000\\,\\text{K}} = 0.9$$\n\nSubstituting $r=0.9$ into the expression for $\\tau_{S}$:\n$$\\tau_{S}(0.9) = 1 - 4(0.9)^{3} + 3(0.9)^{4}$$\n$$\\tau_{S}(0.9) = 1 - 4(0.729) + 3(0.6561)$$\n$$\\tau_{S}(0.9) = 1 - 2.916 + 1.9683$$\n$$\\tau_{S}(0.9) = 0.0523$$\nRounding to four significant figures, the value is $0.05230$.\n\nFinally, we analyze whether updating $T^{*}$ to be closer to $T$ improves convergence. This is equivalent to analyzing the behavior of $\\tau_{S}(r)$ as $r$ approaches $1$. The linearization error $\\tau_S$ quantifies the discrepancy between the linearized model and the true nonlinear physics. Smaller error magnitudes, $|\\tau_S|$, indicate a more accurate linear approximation, which generally promotes faster and more stable convergence in an iterative numerical solver.\n\nLet's examine the function $\\tau_{S}(r) = 3r^{4} - 4r^{3} + 1$. We can test its value at $r=1$:\n$$\\tau_{S}(1) = 3(1)^{4} - 4(1)^{3} + 1 = 3 - 4 + 1 = 0$$\nWhen $T^{*} = T$, which means $r=1$, the linearization error is zero. This is expected, as the Taylor expansion is exact at the point of expansion.\n\nTo understand the behavior near $r=1$, we can analyze the derivatives of $\\tau_S(r)$:\n$$\\frac{d\\tau_{S}}{dr} = 12r^{3} - 12r^{2} = 12r^{2}(r-1)$$\n$$\\frac{d^{2}\\tau_{S}}{dr^{2}} = 36r^{2} - 24r = 12r(3r-2)$$\nAt $r=1$, $\\frac{d\\tau_{S}}{dr}|_{r=1} = 0$ and $\\frac{d^{2}\\tau_{S}}{dr^{2}}|_{r=1} = 12(1)(3-2) = 12 > 0$. This confirms that $\\tau_S(r)$ has a local minimum at $r=1$.\n\nFurthermore, we can factor the polynomial $\\tau_S(r)$. Since $r=1$ is a root and its first derivative is also zero at $r=1$, $(r-1)^2$ must be a factor. Polynomial division or synthetic division yields:\n$$\\tau_S(r) = (r-1)^{2}(3r^{2} + 2r + 1)$$\nThe quadratic factor $3r^{2} + 2r + 1$ has a discriminant $\\Delta = 2^2 - 4(3)(1) = -8 < 0$. Since its leading coefficient is positive, the quadratic term is always positive for all real $r$. Since temperatures $T$ and $T^{*}$ are absolute, $r \\ge 0$. Therefore, $\\tau_S(r) = (r-1)^{2} \\times (\\text{a positive quantity}) \\ge 0$.\n\nThis shows that the linearization error $\\tau_S$ is always non-negative and is minimized to zero only when $r=1$ (i.e., $T^* = T$). As $T^*$ is updated to be closer to $T$, the ratio $r$ approaches $1$, and the error $\\tau_S$ quadratically approaches its minimum value of $0$. Smaller linearization errors lead to a more accurate representation of the nonlinear system, which improves the convergence characteristics of the iterative solver by reducing the size of correction terms at each step, thus enhancing both speed and stability. Therefore, updating $T^{*}$ during iterations is a crucial strategy for efficient and robust convergence.",
            "answer": "$$\\boxed{0.05230}$$"
        },
        {
            "introduction": "Advanced numerical schemes must not only be stable and accurate but also respect the physical constraints of the variables being solved. In turbulence modeling, quantities like the turbulent kinetic energy $k$ and specific dissipation rate $\\omega$ must remain positive to be meaningful. This advanced exercise  guides you through the design of a robust, positivity-preserving linearization for the $k-\\omega$ model source terms. You will implement a powerful technique that involves splitting sources into explicit production and implicit destruction parts, thereby building the physical positivity constraint directly into the numerical algorithm.",
            "id": "3385401",
            "problem": "Consider an incompressible turbulent flow described by the Reynolds-Averaged Navier–Stokes (RANS) equations closed with a two-equation model for turbulent kinetic energy $k$ and specific dissipation rate $\\omega$. Focus on a single control volume and neglect advection and diffusion to isolate the local source-term dynamics. Let the semi-discrete ordinary differential equations for the cell-averaged $k$ and $\\omega$ be\n$$\n\\frac{d k}{d t} \\;=\\; S_{k}(k,\\omega), \n\\qquad \n\\frac{d \\omega}{d t} \\;=\\; S_{\\omega}(k,\\omega),\n$$\nwhere the source terms for the standard $k$–$\\omega$ model are\n$$\nS_{k}(k,\\omega) \\;=\\; P_{k} \\;-\\; \\beta^{*} k \\,\\omega,\n\\qquad\nS_{\\omega}(k,\\omega) \\;=\\; \\alpha \\,\\frac{\\omega}{k}\\, P_{k} \\;-\\; \\beta \\,\\omega^{2}.\n$$\nHere $\\alpha$, $\\beta$, and $\\beta^{*}$ are positive model constants, and $P_{k}$ is the production of turbulent kinetic energy. In the eddy-viscosity framework with the Boussinesq hypothesis, the turbulent production may be represented in terms of the turbulent viscosity $\\nu_{t}$ and the squared mean strain magnitude $\\Omega^{2}$ as $P_{k} = \\nu_{t}\\,\\Omega^{2}$, with $\\nu_{t} = k/\\omega$ and $\\Omega^{2} \\ge 0$ treated as known over the time step.\n\nDefine a single time step of size $\\Delta t > 0$ and consider a point-implicit backward Euler update at time level $n \\to n+1$ for the source-only subsystem, with the source-term linearization restricted to the form\n$$\nS_{y}(y) \\;\\approx\\; \\widehat{P}_{y}^{\\,n} \\;-\\; \\widehat{D}_{y}^{\\,n}\\, y^{n+1},\n$$\nfor $y \\in \\{k,\\omega\\}$, where $\\widehat{P}_{y}^{\\,n} \\ge 0$ and $\\widehat{D}_{y}^{\\,n} \\ge 0$ are coefficients to be constructed from quantities at time level $n$. The goals are:\n- derive, from first principles, a linear stability and positivity analysis of the semi-discrete source-only $k$ and $\\omega$ equations under this point-implicit treatment;\n- design a source-term linearization that guarantees $k^{n+1} > 0$ and $\\omega^{n+1} > 0$ for any $\\Delta t > 0$, given $k^{n} > 0$, $\\omega^{n} > 0$, and $\\Omega^{2} \\ge 0$, without any clipping or artificial lower bounds on $k$ or $\\omega$.\n\nStarting from the above definitions and under the assumption $P_{k}^{n} = (k^{n}/\\omega^{n})\\,\\Omega^{2}$, construct nonnegative coefficients $\\widehat{P}_{k}^{\\,n}$, $\\widehat{D}_{k}^{\\,n}$, $\\widehat{P}_{\\omega}^{\\,n}$, and $\\widehat{D}_{\\omega}^{\\,n}$ that ensure unconditional positivity with the backward Euler update, and derive the resulting closed-form update expressions $k^{n+1}$ and $\\omega^{n+1}$ in terms of $k^{n}$, $\\omega^{n}$, $\\Delta t$, $\\alpha$, $\\beta$, $\\beta^{*}$, and $\\Omega^{2}$, evaluated at time level $n$. Express your final answer as analytic expressions. Do not round. No units are required in the final expressions.",
            "solution": "The user has provided a scientifically grounded and well-posed problem in computational fluid dynamics. The problem is valid and will be solved as stated.\n\nThe objective is to design a point-implicit linearization for the source terms of the standard $k$-$\\omega$ turbulence model that guarantees positivity of the turbulent quantities $k$ (turbulent kinetic energy) and $\\omega$ (specific dissipation rate) for any time step size $\\Delta t > 0$. We must then derive the resulting update expressions for $k^{n+1}$ and $\\omega^{n+1}$.\n\nFirst, we analyze the general form of the proposed numerical scheme. The problem considers a first-order point-implicit backward Euler update for a generic variable $y \\in \\{k, \\omega\\}$ governed by the ordinary differential equation $\\frac{dy}{dt} = S_y$. The update is given by:\n$$ \\frac{y^{n+1} - y^n}{\\Delta t} = S_y(y^{n+1}) $$\nThe source term $S_y$ at the new time level $n+1$ is linearized as:\n$$ S_y(y) \\approx \\widehat{P}_y^n - \\widehat{D}_y^n y^{n+1} $$\nwhere the coefficients $\\widehat{P}_y^n$ and $\\widehat{D}_y^n$ are constructed from quantities at the known time level $n$ and must be non-negative, i.e., $\\widehat{P}_y^n \\ge 0$ and $\\widehat{D}_y^n \\ge 0$.\n\nSubstituting the linearized source term into the backward Euler formula gives:\n$$ \\frac{y^{n+1} - y^n}{\\Delta t} = \\widehat{P}_y^n - \\widehat{D}_y^n y^{n+1} $$\nWe can rearrange this equation to solve for $y^{n+1}$:\n$$ y^{n+1} - y^n = \\Delta t \\left( \\widehat{P}_y^n - \\widehat{D}_y^n y^{n+1} \\right) $$\n$$ y^{n+1} + \\Delta t \\widehat{D}_y^n y^{n+1} = y^n + \\Delta t \\widehat{P}_y^n $$\n$$ y^{n+1} \\left( 1 + \\Delta t \\widehat{D}_y^n \\right) = y^n + \\Delta t \\widehat{P}_y^n $$\nThis yields the general update expression:\n$$ y^{n+1} = \\frac{y^n + \\Delta t \\widehat{P}_y^n}{1 + \\Delta t \\widehat{D}_y^n} $$\nFor positivity, we require $y^{n+1} > 0$. The problem states that the initial conditions are positive, $y^n > 0$ (for $y=k$ and $y=\\omega$), and the time step is positive, $\\Delta t > 0$. Given the constraints that $\\widehat{P}_y^n \\ge 0$ and $\\widehat{D}_y^n \\ge 0$, the numerator $y^n + \\Delta t \\widehat{P}_y^n$ is strictly positive. The denominator $1 + \\Delta t \\widehat{D}_y^n$ is also strictly positive (it is $\\ge 1$). Therefore, their ratio $y^{n+1}$ is guaranteed to be strictly positive. This confirms that the chosen linearization strategy ensures unconditional positivity, provided we can construct valid non-negative coefficients.\n\nThe task now is to construct these coefficients for the $k$ and $\\omega$ equations. The general principle is to split the source term $S_y$ into a production part $P_y$ and a destruction part $D_y$, such that $S_y = P_y - D_y$, where $P_y \\ge 0$ and $D_y \\ge 0$. The linearization then treats the production explicitly and the destruction implicitly.\n$$ S_y \\approx P_y^n - \\frac{D_y^n}{y^n} y^{n+1} $$\nThis corresponds to $\\widehat{P}_y^n = P_y^n$ and $\\widehat{D}_y^n = D_y^n/y^n$.\n\n**Linearization for the $k$ equation:**\nThe source term for the turbulent kinetic energy $k$ is:\n$$ S_k(k, \\omega) = P_k - \\beta^* k \\omega $$\nwhere $P_k = \\nu_t \\Omega^2 = (k/\\omega) \\Omega^2$. The production part is $P_k$ and the destruction part is $\\beta^* k \\omega$. Both are non-negative for $k>0$, $\\omega>0$, $\\Omega^2 \\ge 0$.\nWe linearize as follows:\n1.  The production term $P_k = (k/\\omega)\\Omega^2$ contributes to $\\widehat{P}_k^n$. We evaluate it fully explicitly using values at time level $n$:\n    $$ \\widehat{P}_k^n = P_k^n = \\frac{k^n}{\\omega^n} \\Omega^2 $$\n    Given $k^n > 0$, $\\omega^n > 0$, and $\\Omega^2 \\ge 0$, this coefficient is non-negative, $\\widehat{P}_k^n \\ge 0$.\n\n2.  The destruction term $-\\beta^* k \\omega$ contributes to $-\\widehat{D}_k^n k^{n+1}$. We linearize this term by lagging the $\\omega$ factor:\n    $$ -\\beta^* k \\omega \\approx -\\beta^* k^{n+1} \\omega^n $$\n    This identifies the destruction coefficient as:\n    $$ \\widehat{D}_k^n = \\beta^* \\omega^n $$\n    Given $\\beta^* > 0$ and $\\omega^n > 0$, this coefficient is strictly positive, $\\widehat{D}_k^n > 0$.\n\nWith these coefficients, the update for $k$ is:\n$$ k^{n+1} = \\frac{k^n + \\Delta t \\widehat{P}_k^n}{1 + \\Delta t \\widehat{D}_k^n} = \\frac{k^n + \\Delta t \\left( \\frac{k^n}{\\omega^n} \\Omega^2 \\right)}{1 + \\Delta t (\\beta^* \\omega^n)} $$\nFactoring $k^n$ from the numerator gives the final expression:\n$$ k^{n+1} = \\frac{k^n \\left( 1 + \\frac{\\Delta t \\Omega^2}{\\omega^n} \\right)}{1 + \\beta^* \\Delta t \\omega^n} $$\n\n**Linearization for the $\\omega$ equation:**\nThe source term for the specific dissipation rate $\\omega$ is:\n$$ S_\\omega(k, \\omega) = \\alpha \\frac{\\omega}{k} P_k - \\beta \\omega^2 $$\nSubstituting $P_k = (k/\\omega)\\Omega^2$ gives an important simplification:\n$$ S_\\omega = \\alpha \\frac{\\omega}{k} \\left( \\frac{k}{\\omega} \\Omega^2 \\right) - \\beta \\omega^2 = \\alpha \\Omega^2 - \\beta \\omega^2 $$\nThe production part is $\\alpha \\Omega^2$ and the destruction part is $\\beta \\omega^2$.\nWe linearize as follows:\n1.  The production term $\\alpha \\Omega^2$ is independent of $k$ and $\\omega$. It is already in a form suitable for the explicit production coefficient $\\widehat{P}_\\omega^n$:\n    $$ \\widehat{P}_\\omega^n = \\alpha \\Omega^2 $$\n    Given $\\alpha > 0$ and $\\Omega^2 \\ge 0$, this coefficient is non-negative, $\\widehat{P}_\\omega^n \\ge 0$.\n\n2.  The destruction term $-\\beta \\omega^2$ contributes to $-\\widehat{D}_\\omega^n \\omega^{n+1}$. We linearize this quadratic term as:\n    $$ -\\beta \\omega^2 = -\\beta \\omega \\cdot \\omega \\approx -\\beta \\omega^n \\omega^{n+1} $$\n    This identifies the destruction coefficient as:\n    $$ \\widehat{D}_\\omega^n = \\beta \\omega^n $$\n    Given $\\beta > 0$ and $\\omega^n > 0$, this coefficient is strictly positive, $\\widehat{D}_\\omega^n > 0$.\n\nWith these coefficients, the update for $\\omega$ is:\n$$ \\omega^{n+1} = \\frac{\\omega^n + \\Delta t \\widehat{P}_\\omega^n}{1 + \\Delta t \\widehat{D}_\\omega^n} = \\frac{\\omega^n + \\Delta t (\\alpha \\Omega^2)}{1 + \\Delta t (\\beta \\omega^n)} $$\nThis can be written in a factored form analogous to the $k$ expression:\n$$ \\omega^{n+1} = \\frac{\\omega^n \\left( 1 + \\frac{\\alpha \\Delta t \\Omega^2}{\\omega^n} \\right)}{1 + \\beta \\Delta t \\omega^n} $$\n\nBoth derived update expressions guarantee $k^{n+1} > 0$ and $\\omega^{n+1} > 0$ for any $\\Delta t > 0$, given the positive initial state at time level $n$, without resorting to any ad-hoc clipping. This completes the derivation.\n\nThe final answers are the analytical expressions for $k^{n+1}$ and $\\omega^{n+1}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{k^n \\left( 1 + \\frac{\\Delta t \\Omega^2}{\\omega^n} \\right)}{1 + \\beta^* \\Delta t \\omega^n} & \\frac{\\omega^n \\left( 1 + \\frac{\\alpha \\Delta t \\Omega^2}{\\omega^n} \\right)}{1 + \\beta \\Delta t \\omega^n}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}