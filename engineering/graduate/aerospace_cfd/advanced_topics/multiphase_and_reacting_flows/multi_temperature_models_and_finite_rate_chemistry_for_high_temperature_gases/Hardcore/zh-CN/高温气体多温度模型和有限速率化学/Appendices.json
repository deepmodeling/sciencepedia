{
    "hands_on_practices": [
        {
            "introduction": "在高温气体中，平动、转动、振动和电子等不同能量模式可能处于非平衡状态，需要用不同的温度（如$T$、$T_v$和$T_e$）来描述。本练习将指导您应用统计力学原理，量化在这种非平衡条件下储存在各个模式中的能量。这是构建完整热化学模型、理解激波后能量分配的第一步。",
            "id": "3977839",
            "problem": "绕钝体的高超声速流会产生一道强激波，其后是出现热化学非平衡的激波后区域。在高温气体的多温度模型中，重粒子平动-转动温度 $T$、双原子振动温度 $T_v$ 和电子温度 $T_e$ 是各不相同的。考虑空气激波后区域中的一个空间点，该点的重粒子组分为氮分子 $\\mathrm{N}_2$ 和氧原子 $\\mathrm{O}$，其摩尔分数分别为 $x_{\\mathrm{N}_2} = 0.55$ 和 $x_{\\mathrm{O}} = 0.45$，自由电子相对于重粒子摩尔含量的摩尔分数为 $\\chi_e = 0.02$。假设温度如下：$T = 6000\\,\\mathrm{K}$，$T_v = 10000\\,\\mathrm{K}$ 和 $T_e = 12000\\,\\mathrm{K}$。摩尔质量为 $M_{\\mathrm{N}_2} = 0.0280134\\,\\mathrm{kg/mol}$ 和 $M_{\\mathrm{O}} = 0.015999\\,\\mathrm{kg/mol}$，普适气体常数为 $R_u = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$。$\\mathrm{N}_2$ 的特征振动温度为 $\\theta_{v,\\mathrm{N}_2} = 3395\\,\\mathrm{K}$。在混合物分子量中忽略电子质量，并忽略单原子 $\\mathrm{O}$ 的任何转动或振动贡献。\n\n从适用于高温气体计算流体动力学(CFD)的统计力学和热力学原理出发，推导以下各项的表达式：\n- 使用线性刚性转子的能量均分定理，推导双原子组分 $\\mathrm{N}_2$ 的比转动能贡献 $e_r(T)$（单位混合物质量），\n- 使用量子谐振子模型，推导 $\\mathrm{N}_2$ 的比振动能贡献 $e_v(T_v)$（单位混合物质量），\n- 将电子视为单原子理想气体，推导比电子平动能贡献 $e_e(T_e)$（单位混合物质量）。\n\n使用给定的组分和温度，计算 $e_r(T)$、$e_v(T_v)$ 和 $e_e(T_e)$ 的数值。然后，基于非平衡温度分布和组分，简要解释在激波后区域中哪一项贡献占主导地位及其原因。\n\n将每项能量以 $\\mathrm{kJ/kg}$ 为单位表示，并将答案四舍五入到四位有效数字。最终报告值必须按 $e_r(T)$、$e_v(T_v)$ 和 $e_e(T_e)$ 的顺序给出。",
            "solution": "该问题基于高温气体动力学原理，具有科学依据，且所有必要信息均已提供，问题表述适定，语言客观正式，因此被评估为有效。所描述的模型和条件是高超声速流中热化学非平衡分析的标准方法。我们开始进行解答。\n\n目标是计算给定气体混合物单位质量的比转动能 $e_r(T)$、比振动能 $e_v(T_v)$ 和比电子平动能 $e_e(T_e)$。求解过程需要计算混合物的质量组分，然后对每种能量模式应用相应的统计力学模型。\n\n首先，我们确定混合物的性质。重粒子混合物由 $\\mathrm{N}_2$ 和 $\\mathrm{O}$ 组成。摩尔分数给定为 $x_{\\mathrm{N}_2} = 0.55$ 和 $x_{\\mathrm{O}} = 0.45$。摩尔质量为 $M_{\\mathrm{N}_2} = 0.0280134\\,\\mathrm{kg/mol}$ 和 $M_{\\mathrm{O}} = 0.015999\\,\\mathrm{kg/mol}$。重粒子混合物的平均摩尔质量 $M_h$ 是摩尔分数的加权平均值：\n$$M_h = \\sum_s x_s M_s = x_{\\mathrm{N}_2} M_{\\mathrm{N}_2} + x_{\\mathrm{O}} M_{\\mathrm{O}}$$\n$$M_h = (0.55)(0.0280134\\,\\mathrm{kg/mol}) + (0.45)(0.015999\\,\\mathrm{kg/mol})$$\n$$M_h = 0.01540737\\,\\mathrm{kg/mol} + 0.00719955\\,\\mathrm{kg/mol} = 0.02260692\\,\\mathrm{kg/mol}$$\n题目说明在混合物分子量中忽略电子质量，因此混合物的总摩尔质量 $M_{mix}$ 取为 $M_h$。\n\n题目要求的是单位总混合物质量的比能贡献。因此，我们需要贡献组分的质量分数。$\\mathrm{N}_2$ 的质量分数 $Y_{\\mathrm{N}_2}$ 是一个代表性样本中 $\\mathrm{N}_2$ 的质量与重粒子总质量之比：\n$$Y_{\\mathrm{N}_2} = \\frac{x_{\\mathrm{N}_2} M_{\\mathrm{N}_2}}{M_h} = \\frac{0.01540737\\,\\mathrm{kg/mol}}{0.02260692\\,\\mathrm{kg/mol}} \\approx 0.6815403$$\n\n现在，我们推导并计算这三项能量贡献。\n\n**1. 比转动能贡献, $e_r(T)$**\n双原子组分 $\\mathrm{N}_2$ 的转动能使用线性刚性转子的能量均分定理，在重粒子平动-转动温度 $T = 6000\\,\\mathrm{K}$ 下进行建模。线性分子有两个转动自由度。每个自由度对每个分子的平均能量贡献为 $\\frac{1}{2}k_B T$，其中 $k_B$ 是玻尔兹曼常数。\n$\\mathrm{N}_2$ 的摩尔转动能为：\n$$E_{r, \\mathrm{N}_2}^{\\text{mole}} = N_A \\left( 2 \\times \\frac{1}{2} k_B T \\right) = N_A k_B T = R_u T$$\n其中 $N_A$ 是阿伏伽德罗常数，$R_u$ 是普适气体常数。纯 $\\mathrm{N}_2$ 的比转动能是 $\\frac{R_u T}{M_{\\mathrm{N}_2}}$。由于单原子 $\\mathrm{O}$ 没有转动能，因此对混合物比能的贡献是该值乘以 $\\mathrm{N}_2$ 的质量分数。\n$$e_r(T) = Y_{\\mathrm{N}_2} \\left( \\frac{R_u T}{M_{\\mathrm{N}_2}} \\right)$$\n使用给定值：\n$$e_r(T) = (0.6815403) \\left( \\frac{(8.314462618\\,\\mathrm{J/(mol\\cdot K)})(6000\\,\\mathrm{K})}{0.0280134\\,\\mathrm{kg/mol}} \\right)$$\n$$e_r(T) \\approx 1213600\\,\\mathrm{J/kg} = 1213.6\\,\\mathrm{kJ/kg}$$\n四舍五入到四位有效数字，得到 $e_r(T) = 1214\\,\\mathrm{kJ/kg}$。\n\n**2. 比振动能贡献, $e_v(T_v)$**\n$\\mathrm{N}_2$ 的振动能被建模为量子谐振子，在振动温度 $T_v = 10000\\,\\mathrm{K}$ 下计算。$\\mathrm{N}_2$ 的摩尔振动能由下式给出：\n$$E_{v, \\mathrm{N}_2}^{\\text{mole}} = R_u \\frac{\\theta_{v,\\mathrm{N}_2}}{\\exp\\left(\\frac{\\theta_{v,\\mathrm{N}_2}}{T_v}\\right) - 1}$$\n其中 $\\theta_{v,\\mathrm{N}_2} = 3395\\,\\mathrm{K}$ 是 $\\mathrm{N}_2$ 的特征振动温度。对混合物比能的贡献是 $\\mathrm{N}_2$ 的比振动能乘以其质量分数：\n$$e_v(T_v) = Y_{\\mathrm{N}_2} \\left( \\frac{R_u \\theta_{v,\\mathrm{N}_2}}{M_{\\mathrm{N}_2} \\left(\\exp\\left(\\frac{\\theta_{v,\\mathrm{N}_2}}{T_v}\\right) - 1\\right)} \\right)$$\n首先，我们计算指数项的参数：$\\frac{\\theta_{v,\\mathrm{N}_2}}{T_v} = \\frac{3395\\,\\mathrm{K}}{10000\\,\\mathrm{K}} = 0.3395$。\n$$e_v(T_v) = (0.6815403) \\left( \\frac{(8.314462618\\,\\mathrm{J/(mol\\cdot K)})(3395\\,\\mathrm{K})}{(0.0280134\\,\\mathrm{kg/mol}) (\\exp(0.3395) - 1)} \\right)$$\n$$e_v(T_v) = (0.6815403) \\left( \\frac{28227.599\\,\\mathrm{J/mol}}{(0.0280134\\,\\mathrm{kg/mol}) (1.404260 - 1)} \\right)$$\n$$e_v(T_v) \\approx 1698539\\,\\mathrm{J/kg} = 1698.539\\,\\mathrm{kJ/kg}$$\n四舍五入到四位有效数字，得到 $e_v(T_v) = 1699\\,\\mathrm{kJ/kg}$。\n\n**3. 比电子平动能贡献, $e_e(T_e)$**\n电子被视为单原子理想气体，在电子温度 $T_e = 12000\\,\\mathrm{K}$ 下计算。单原子粒子有三个平动自由度。电子的摩尔平动能为：\n$$E_{e}^{\\text{mole}} = N_A \\left( 3 \\times \\frac{1}{2} k_B T_e \\right) = \\frac{3}{2} R_u T_e$$\n单位混合物质量的比电子能是样本中的总电子能量除以该样本的总质量。考虑一个包含一摩尔重粒子 ($n_h = 1\\,\\mathrm{mol}$) 的样本。电子的摩尔数为 $n_e = \\chi_e n_h = 0.02\\,\\mathrm{mol}$。该样本的总质量（忽略电子质量）为 $m_{total} = n_h M_h = M_h$。\n该样本中的总电子能量为 $E_{e,total} = n_e E_{e}^{\\text{mole}} = \\chi_e \\frac{3}{2} R_u T_e$。因此，比能贡献为：\n$$e_e(T_e) = \\frac{E_{e,total}}{m_{total}} = \\frac{\\chi_e \\frac{3}{2} R_u T_e}{M_h}$$\n使用给定值：\n$$e_e(T_e) = \\frac{(0.02) \\times \\frac{3}{2} \\times (8.314462618\\,\\mathrm{J/(mol\\cdot K)})(12000\\,\\mathrm{K})}{0.02260692\\,\\mathrm{kg/mol}}$$\n$$e_e(T_e) = \\frac{2993.2065\\,\\mathrm{J/mol}}{0.02260692\\,\\mathrm{kg/mol}} \\approx 132401\\,\\mathrm{J/kg} = 132.401\\,\\mathrm{kJ/kg}$$\n四舍五入到四位有效数字，得到 $e_e(T_e) = 132.4\\,\\mathrm{kJ/kg}$。\n\n**比较与解释**\n计算得到的比能贡献为 $e_r \\approx 1214\\,\\mathrm{kJ/kg}$，$e_v \\approx 1699\\,\\mathrm{kJ/kg}$ 和 $e_e \\approx 132.4\\,\\mathrm{kJ/kg}$。\n比振动能 $e_v(T_v)$ 是此处考虑的内能分配中的主导贡献。这主要是因为振动温度 $T_v = 10000\\,\\mathrm{K}$ 非常高，远大于重粒子温度 $T = 6000\\,\\mathrm{K}$ 和特征振动温度 $\\theta_{v,\\mathrm{N}_2} = 3395\\,\\mathrm{K}$。高的 $T_v$ 值表明 $\\mathrm{N}_2$ 的振动模式被高度激发，储存了大量能量。尽管电子温度 $T_e = 12000\\,\\mathrm{K}$ 最高，但比电子能贡献 $e_e(T_e)$ 却是最小的。这是因为比能是单位*混合物*质量所具有的能量。电子的摩尔分数 $\\chi_e=0.02$ 很小，更重要的是，与重粒子相比，电子的摩尔质量可以忽略不计。因此，尽管单个电子能量很高，但由于其质量仅占总质量的极小一部分，它们对单位质量气体混合物总能量的贡献很小。由于重粒子温度 $T$ 较高以及双原子组分 $\\mathrm{N}_2$ 的质量分数相当大，转动能的贡献是显著的，但它被高度激发的振动能所超过。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1214  1699  132.4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理解了能量可以存储在不同模式中后，下一个关键问题是这些模式的温度如何演化并趋于平衡。本练习聚焦于描述振动-平动（V-T）能量交换的基石——Landau-Teller模型。通过求解一个简化场景下的弛豫方程，您将掌握弛豫时间的概念，并对非平衡过程的动力学建立起基本认识。",
            "id": "3977827",
            "problem": "考虑一个在计算流体动力学（CFD）中采用双温度框架建模的空间均匀、静止的高温双原子气体团，其中平动-转动温度表示为 $T(t)$，振动温度表示为 $T_{v}(t)$。假设化学反应冻结，并忽略对流和扩散。设单位质量的振动能为 $e_{v}(t)$，其相对于平动-转动模态的局部热力学平衡值为 $e_{v}^{\\ast}(T(t))$。模态间的振动能交换由一个广为接受的线性弛豫定律描述，其特征振动弛豫时间为 $\\tau_{v}$：\n$$\n\\frac{d e_{v}}{d t} = \\frac{e_{v}^{\\ast}(T) - e_{v}}{\\tau_{v}} \\quad \\text{for} \\quad t \\ge 0.\n$$\n在时间 $t=0$ 时，一个外部脉冲加热事件瞬时将平动-转动温度从激波前的值 $T(0^{-}) = T_{i}$ 提高到激波后的平台值 $T(t) = T_{f}$（对于所有 $t \\ge 0$）。假设振动温度初始时与激波前状态处于平衡，即 $T_{v}(0^{-}) = T_{i}$。对于 $t \\ge 0$，取振动弛豫时间为常数 $\\tau_{v} = \\text{const}$，并采用定振动比热近似 $c_{v,v} = \\text{const}$，使得\n$$\ne_{v}(t) = c_{v,v} \\, T_{v}(t), \\qquad e_{v}^{\\ast}(T(t)) = c_{v,v} \\, T(t).\n$$\n从所述的能量弛豫定律和这些定义出发，推导控制 $T_{v}(t)$（对于 $t \\ge 0$）的常微分方程（ODE），并针对 $t=0$ 时 $T$ 的阶跃变化对其进行解析求解。使用初始条件 $T_{v}(0)=T_{i}$（对应于 $T$ 发生阶跃之后的那一刻）。将最终答案表示为 $T_{v}(t)$ 关于 $t$、$T_{i}$、$T_{f}$ 和 $\\tau_{v}$ 的单个闭式解析表达式。表达式中无需包含单位；将 $T$ 和 $T_{v}$ 视为以开尔文为单位的温度。无需进行数值计算。",
            "solution": "在进行求解之前，对问题陈述的有效性进行评估。\n\n**步骤 1：提取已知条件**\n问题陈述中提供了以下信息：\n- 系统是一个空间均匀、静止的高温双原子气体团。\n- 模型是一个双温度框架，包含平动-转动温度 $T(t)$ 和振动温度 $T_v(t)$。\n- 化学反应冻结；忽略对流和扩散。\n- 单位质量的振动能为 $e_v(t)$。\n- 局部热力学平衡振动能为 $e_v^{\\ast}(T(t))$。\n- 对于 $t \\ge 0$，振动能弛豫的控制方程为：\n$$ \\frac{d e_{v}}{d t} = \\frac{e_{v}^{\\ast}(T) - e_{v}}{\\tau_{v}} $$\n- 在 $t=0$ 时发生一个脉冲加热事件。\n- 激波前的平动-转动温度为 $T(0^{-}) = T_i$。\n- 激波后的平动-转动温度为 $T(t) = T_f$（对于所有 $t \\ge 0$）。\n- 振动温度的初始条件为 $T_v(0^{-}) = T_i$。\n- 振动弛豫时间为常数：$\\tau_v = \\text{const}$。\n- 振动比热为常数：$c_{v,v} = \\text{const}$。\n- 能量和温度之间的关系为：\n$$ e_{v}(t) = c_{v,v} \\, T_{v}(t) $$\n$$ e_{v}^{\\ast}(T(t)) = c_{v,v} \\, T(t) $$\n- 对于 $t \\ge 0$ 求解的微分方程的初始条件是 $T_v(0) = T_i$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题定义明确且具有科学依据。它描述了非平衡气体动力学中的一个经典问题：气体团在平动温度突然升高后（正如正激波后区域的典型特征）的振动温度弛豫过程。其控制方程是标准的 Landau-Teller 弛豫模型。定振动比热和定弛豫时间的假设是推导解析解时常用且有效的简化。该问题是自洽的，提供了所有必要的方程和初始条件。它是一个适定的一阶常微分方程初值问题，存在唯一、稳定的解。问题陈述中没有科学或事实上的不健全之处，没有矛盾，也没有歧义。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将推导解答。\n\n**解答推导**\n目标是推导并求解关于振动温度 $T_v(t)$ 的常微分方程（ODE）。\n\n首先，我们将给定的 $e_v$ 和 $e_v^{\\ast}$ 的本构关系代入振动能弛豫方程。\n弛豫定律为：\n$$ \\frac{d e_{v}}{d t} = \\frac{e_{v}^{\\ast}(T) - e_{v}}{\\tau_{v}} $$\n代入 $e_{v}(t) = c_{v,v} T_{v}(t)$ 和 $e_{v}^{\\ast}(T(t)) = c_{v,v} T(t)$：\n$$ \\frac{d}{dt} (c_{v,v} T_{v}) = \\frac{c_{v,v} T - c_{v,v} T_{v}}{\\tau_{v}} $$\n由于 $c_{v,v}$ 是一个常数，它可以从时间导数中提出，并在右侧作为公因子提出：\n$$ c_{v,v} \\frac{d T_{v}}{d t} = \\frac{c_{v,v} (T - T_{v})}{\\tau_{v}} $$\n两边同除以非零常数 $c_{v,v}$，得到以平动-转动温度 $T(t)$ 表示的振动温度 $T_v(t)$ 的常微分方程：\n$$ \\frac{d T_{v}}{d t} = \\frac{T(t) - T_{v}(t)}{\\tau_{v}} $$\n问题指明，对于 $t \\ge 0$，平动-转动温度恒定为激波后的值 $T(t) = T_f$。将其代入常微分方程得到：\n$$ \\frac{d T_{v}}{d t} = \\frac{T_{f} - T_{v}}{\\tau_{v}} $$\n这是一个一阶线性非齐次常微分方程。可以使用分离变量法求解。我们重排方程以分离变量 $T_v$ 和 $t$：\n$$ \\frac{d T_{v}}{T_{f} - T_{v}} = \\frac{dt}{\\tau_{v}} $$\n我们对等式两边进行积分。左侧对 $T_v$ 从其初始值 $T_v(0)$ 积到稍后时刻的值 $T_v(t)$，右侧对时间从 $0$ 积到 $t$：\n$$ \\int_{T_{v}(0)}^{T_{v}(t)} \\frac{d T'_{v}}{T_{f} - T'_{v}} = \\int_{0}^{t} \\frac{d t'}{\\tau_{v}} $$\n左侧的积分得到一个自然对数：\n$$ \\left[ -\\ln(T_{f} - T'_{v}) \\right]_{T_{v}(0)}^{T_{v}(t)} = \\left[ \\frac{t'}{\\tau_{v}} \\right]_{0}^{t} $$\n使用初始条件 $T_v(0) = T_i$：\n$$ -\\ln(T_{f} - T_{v}(t)) - (-\\ln(T_{f} - T_{i})) = \\frac{t}{\\tau_{v}} $$\n$$ \\ln(T_{f} - T_{i}) - \\ln(T_{f} - T_{v}(t)) = \\frac{t}{\\tau_{v}} $$\n利用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$ \\ln\\left(\\frac{T_{f} - T_{i}}{T_{f} - T_{v}(t)}\\right) = \\frac{t}{\\tau_{v}} $$\n为了求解 $T_v(t)$，我们对两边取指数：\n$$ \\frac{T_{f} - T_{i}}{T_{f} - T_{v}(t)} = \\exp\\left(\\frac{t}{\\tau_{v}}\\right) $$\n现在，我们进行代数重排以分离出 $T_v(t)$：\n$$ T_{f} - T_{v}(t) = (T_{f} - T_{i}) \\exp\\left(-\\frac{t}{\\tau_{v}}\\right) $$\n$$ T_{v}(t) = T_{f} - (T_{f} - T_{i}) \\exp\\left(-\\frac{t}{\\tau_{v}}\\right) $$\n该表达式描述了振动温度从其初始值 $T_i$ 开始，以特征时间尺度 $\\tau_v$ 向新的平衡温度 $T_f$ 弛豫的演化过程。\n在 $t=0$ 时，$T_v(0) = T_f - (T_f - T_i)\\exp(0) = T_f - (T_f - T_i) = T_i$，满足初始条件。\n当 $t \\to \\infty$ 时，$T_v(t) \\to T_f - (T_f - T_i)(0) = T_f$，这是预期的平衡状态。\n推导出的表达式是正确的解析解。",
            "answer": "$$\\boxed{T_{f} - (T_{f} - T_{i}) \\exp\\left(-\\frac{t}{\\tau_{v}}\\right)}$$"
        },
        {
            "introduction": "在真实的CFD模拟中，必须求解由有限速率化学反应和能量弛豫带来的耦合且通常是“刚性”的方程组。这项高级练习将深入探讨求解这些方程所需的数值方法，指导您推导并实现一个点隐式后向欧拉格式。本练习旨在连接物理理论与计算流体力学（CFD）代码的实际实现，展示在处理快速化学反应和能量弛豫时间尺度时如何确保数值稳定性。",
            "id": "3977830",
            "problem": "考虑计算流体动力学（CFD）中的一个多温度模型，用于描述具有有限速率化学反应的高温气体。在该模型中，物种质量分数和振动温度通过点隐式积分在时间上进行局部演化。设存在 $N_s$ 个化学物种，其质量分数为 $Y_i$（其中 $i \\in \\{1,\\dots,N_s\\}$），质量密度为 $\\rho$，振动温度为 $T_v$。假设物种质量分数和振动温度的局部常微分方程如下：\n$$\n\\frac{d Y_i}{dt} = \\frac{\\omega_i(Y_1,\\dots,Y_{N_s},T_v)}{\\rho}, \\quad i = 1,\\dots,N_s,\n$$\n$$\n\\rho \\, c_{v,v} \\, \\frac{d T_v}{dt} = S_v(Y_1,\\dots,Y_{N_s},T_v),\n$$\n其中 $\\omega_i$ 是用于质量生成的有限速率化学反应源项，$S_v$ 是振动能源项，$c_{v,v}$ 是定容振动比热。\n\n你需要通过在已知状态 $(Y^n, T_v^n)$ 处使用一阶泰勒展开对源项进行线性化，为未知增量向量 $\\Delta Y_i = Y_i^{n+1} - Y_i^n$ 和 $\\Delta T_v = T_v^{n+1}-T_v^n$ 构建一个后向欧拉、点隐式更新方案。令 $\\Delta t$ 为时间步长。在时间层 $n$ 定义源项值及其偏导数\n$$\n\\omega_i^n = \\omega_i(Y^n,T_v^n), \\quad \\left.\\frac{\\partial \\omega_i}{\\partial Y_j}\\right|_n, \\quad \\left.\\frac{\\partial \\omega_i}{\\partial T_v}\\right|_n,\n$$\n$$\nS_v^n = S_v(Y^n,T_v^n), \\quad \\left.\\frac{\\partial S_v}{\\partial Y_j}\\right|_n, \\quad \\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n.\n$$\n使用后向欧拉方法和线性化，推导用于求解未知增量 $\\Delta Y_i$ 和 $\\Delta T_v$ 的局部线性系统，将其写成矩阵形式，并用 $\\rho$、$\\Delta t$、$c_{v,v}$ 以及在时间层 $n$ 给定的源项值和导数，明确表示所有矩阵元素和右侧向量分量的表达式。\n\n然后实现一个程序，对每个提供的测试用例，构建并求解这个局部线性系统，以获得更新后的值 $Y_i^{n+1}$ 和 $T_v^{n+1}$。\n\n使用以下测试套件，每个用例由 $(N_s, \\rho, \\Delta t, Y^n, T_v^n, \\omega^n, \\partial \\omega/\\partial Y|_n, \\partial \\omega/\\partial T_v|_n, S_v^n, \\partial S_v/\\partial Y|_n, \\partial S_v/\\partial T_v|_n, c_{v,v})$ 指定。所有量均采用国际单位制（SI）；振动温度必须以开尔文报告，物种质量分数为无量纲量。\n\n- 测试用例 1（一般情况）：\n  - $N_s = 2$\n  - $\\rho = 0.5 \\,\\mathrm{kg/m^3}$\n  - $\\Delta t = 1.0\\times 10^{-3} \\,\\mathrm{s}$\n  - $Y^n = [0.8,\\,0.2]$\n  - $T_v^n = 7000 \\,\\mathrm{K}$\n  - $\\omega^n = [-1.0\\times 10^{-3},\\, 1.0\\times 10^{-3}] \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial Y}\\right|_n = \\begin{bmatrix} -0.2  0.2 \\\\ 0.2  -0.2 \\end{bmatrix} \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial T_v}\\right|_n = [0.0,\\,0.0] \\,\\mathrm{kg/(m^3 \\cdot s \\cdot K)}$\n  - $S_v^n = -2000 \\,\\mathrm{W/m^3}$\n  - $\\left.\\frac{\\partial S_v}{\\partial Y}\\right|_n = [100,\\,-100] \\,\\mathrm{W/(m^3)}$\n  - $\\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n = -5000 \\,\\mathrm{W/(m^3 \\cdot K)}$\n  - $c_{v,v} = 1000 \\,\\mathrm{J/(kg \\cdot K)}$\n\n- 测试用例 2（刚性耦合）：\n  - $N_s = 3$\n  - $\\rho = 0.2 \\,\\mathrm{kg/m^3}$\n  - $\\Delta t = 2.0\\times 10^{-5} \\,\\mathrm{s}$\n  - $Y^n = [0.6,\\,0.3,\\,0.1]$\n  - $T_v^n = 9000 \\,\\mathrm{K}$\n  - $\\omega^n = [-1.0\\times 10^{-2},\\, 8.0\\times 10^{-3},\\, 2.0\\times 10^{-3}] \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial Y}\\right|_n = \\begin{bmatrix} -10.0  8.0  2.0 \\\\ 10.0  -12.0  2.0 \\\\ 0.0  4.0  -4.0 \\end{bmatrix} \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial T_v}\\right|_n = [0.5,\\,-0.3,\\,-0.2] \\,\\mathrm{kg/(m^3 \\cdot s \\cdot K)}$\n  - $S_v^n = -5.0\\times 10^{5} \\,\\mathrm{W/m^3}$\n  - $\\left.\\frac{\\partial S_v}{\\partial Y}\\right|_n = [1.0\\times 10^{4},\\, -5.0\\times 10^{3},\\, 0.0] \\,\\mathrm{W/(m^3)}$\n  - $\\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n = -2.0\\times 10^{6} \\,\\mathrm{W/(m^3 \\cdot K)}$\n  - $c_{v,v} = 1500 \\,\\mathrm{J/(kg \\cdot K)}$\n\n- 测试用例 3（零源项和零导数的边界情况）：\n  - $N_s = 1$\n  - $\\rho = 1.0 \\,\\mathrm{kg/m^3}$\n  - $\\Delta t = 1.0\\times 10^{-2} \\,\\mathrm{s}$\n  - $Y^n = [1.0]$\n  - $T_v^n = 3000 \\,\\mathrm{K}$\n  - $\\omega^n = [0.0] \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial Y}\\right|_n = \\begin{bmatrix} 0.0 \\end{bmatrix} \\,\\mathrm{kg/(m^3 \\cdot s)}$\n  - $\\left.\\frac{\\partial \\omega}{\\partial T_v}\\right|_n = [0.0] \\,\\mathrm{kg/(m^3 \\cdot s \\cdot K)}$\n  - $S_v^n = 0.0 \\,\\mathrm{W/m^3}$\n  - $\\left.\\frac{\\partial S_v}{\\partial Y}\\right|_n = [0.0] \\,\\mathrm{W/(m^3)}$\n  - $\\left.\\frac{\\partial S_v}{\\partial T_v}\\right|_n = 0.0 \\,\\mathrm{W/(m^3 \\cdot K)}$\n  - $c_{v,v} = 1000 \\,\\mathrm{J/(kg \\cdot K)}$\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身是一个列表，包含更新后的物种质量分数和随后的更新后振动温度。对于数值，将每个数字表示为小数点后有六位的小数浮点数。例如，三个用例的输出格式为 $[[Y_1^{n+1},\\dots,Y_{N_s}^{n+1},T_v^{n+1}], [\\dots], [\\dots]]$，所有温度单位为 $\\mathrm{K}$，质量分数为无量纲量。",
            "solution": "该问题要求推导并实现一个点隐式后向欧拉更新方案，用于求解描述高温气体中物种质量分数和振动温度演化的常微分方程（ODE）组。这是计算流体动力学（CFD）中处理与化学反应和能量交换相关的刚性源项的一种常用且基本的技术。\n\n控制性的局部 ODE 如下：\n$$\n\\frac{d Y_i}{dt} = \\frac{\\omega_i(Y_1,\\dots,Y_{N_s},T_v)}{\\rho}, \\quad i = 1,\\dots,N_s\n$$\n$$\n\\rho \\, c_{v,v} \\, \\frac{d T_v}{dt} = S_v(Y_1,\\dots,Y_{N_s},T_v)\n$$\n其中 $Y_i$ 是物种质量分数，$T_v$ 是振动温度，$\\rho$ 是质量密度，$c_{v,v}$ 是定容振动比热，$\\omega_i$ 是物种质量生成源项，$S_v$ 是振动能源项。物种数量由 $N_s$ 表示。\n\n我们可以将此系统合并为一个单一的向量方程。设状态向量为 $\\vec{U} \\in \\mathbb{R}^{N_s+1}$，定义为 $\\vec{U} = [Y_1, \\dots, Y_{N_s}, T_v]^T$。该 ODE 系统可以紧凑地写成 $\\frac{d\\vec{U}}{dt} = \\vec{F}(\\vec{U})$，其中源函数 $\\vec{F}$ 的分量为：\n$$\nF_i(\\vec{U}) = \\frac{\\omega_i(\\vec{U})}{\\rho} \\quad \\text{for } i \\in \\{1, \\dots, N_s\\}\n$$\n$$\nF_{N_s+1}(\\vec{U}) = \\frac{S_v(\\vec{U})}{\\rho c_{v,v}}\n$$\n\n后向欧拉法是一种一阶精度的隐式积分方案，用于在时间上离散化该 ODE 系统：\n$$\n\\frac{\\vec{U}^{n+1} - \\vec{U}^n}{\\Delta t} = \\vec{F}(\\vec{U}^{n+1})\n$$\n其中 $\\vec{U}^n$ 是当前时间层 $n$ 的已知状态，$\\vec{U}^{n+1}$ 是新时间层 $n+1$ 的未知状态，$\\Delta t$ 是时间步长。\n\n该方程代表一个关于未知状态 $\\vec{U}^{n+1}$ 的非线性代数方程组。为高效求解，我们使用一阶泰勒级数展开，在已知状态 $\\vec{U}^n$ 附近对源函数 $\\vec{F}(\\vec{U}^{n+1})$ 进行线性化：\n$$\n\\vec{F}(\\vec{U}^{n+1}) \\approx \\vec{F}(\\vec{U}^n) + \\mathbf{J}_F(\\vec{U}^n) (\\vec{U}^{n+1} - \\vec{U}^n)\n$$\n其中 $\\mathbf{J}_F(\\vec{U}^n) = \\left. \\frac{\\partial \\vec{F}}{\\partial \\vec{U}} \\right|_n$ 是源函数 $\\vec{F}$ 的雅可比矩阵，在时间层 $n$ 进行求值。设未知增量向量为 $\\Delta \\vec{U} = \\vec{U}^{n+1} - \\vec{U}^n$。将线性化结果代入后向欧拉公式可得：\n$$\n\\frac{\\Delta \\vec{U}}{\\Delta t} \\approx \\vec{F}(\\vec{U}^n) + \\mathbf{J}_F(\\vec{U}^n) \\Delta \\vec{U}\n$$\n这是一个关于增量向量 $\\Delta \\vec{U}$ 的线性系统。我们将其重排为标准形式 $\\mathbf{A} \\vec{x} = \\vec{b}$：\n$$\n\\left( \\frac{\\mathbf{I}}{\\Delta t} - \\mathbf{J}_F(\\vec{U}^n) \\right) \\Delta \\vec{U} = \\vec{F}(\\vec{U}^n)\n$$\n两边同乘以 $\\Delta t$ 得到局部线性系统的最终形式：\n$$\n\\left( \\mathbf{I} - \\Delta t \\, \\mathbf{J}_F(\\vec{U}^n) \\right) \\Delta \\vec{U} = \\Delta t \\, \\vec{F}(\\vec{U}^n)\n$$\n其中 $\\mathbf{I}$ 是 $(N_s+1) \\times (N_s+1)$ 的单位矩阵。\n\n下一步是根据问题陈述中提供的量，推导系统矩阵的元素和右侧向量的显式表达式。系统矩阵为 $\\mathbf{A} = \\mathbf{I} - \\Delta t \\, \\mathbf{J}_F(\\vec{U}^n)$，右侧向量为 $\\vec{b} = \\Delta t \\, \\vec{F}(\\vec{U}^n)$。未知数向量为 $\\Delta\\vec{U} = [\\Delta Y_1, \\dots, \\Delta Y_{N_s}, \\Delta T_v]^T$。\n\n首先，我们通过对 $\\vec{F}$ 的分量求偏导数来确定雅可比矩阵 $\\mathbf{J}_F$ 的分量：\n对于物种方程（$i \\in \\{1, \\dots, N_s\\}$）：\n$$\n(\\mathbf{J}_F)_{ij} = \\frac{\\partial F_i}{\\partial Y_j} = \\frac{\\partial}{\\partial Y_j} \\left( \\frac{\\omega_i}{\\rho} \\right) = \\frac{1}{\\rho} \\frac{\\partial \\omega_i}{\\partial Y_j} \\quad \\text{for } j \\in \\{1, \\dots, N_s\\}\n$$\n$$\n(\\mathbf{J}_F)_{i, N_s+1} = \\frac{\\partial F_i}{\\partial T_v} = \\frac{\\partial}{\\partial T_v} \\left( \\frac{\\omega_i}{\\rho} \\right) = \\frac{1}{\\rho} \\frac{\\partial \\omega_i}{\\partial T_v}\n$$\n对于振动能方程（第 $N_s+1$ 行）：\n$$\n(\\mathbf{J}_F)_{N_s+1, j} = \\frac{\\partial F_{N_s+1}}{\\partial Y_j} = \\frac{\\partial}{\\partial Y_j} \\left( \\frac{S_v}{\\rho c_{v,v}} \\right) = \\frac{1}{\\rho c_{v,v}} \\frac{\\partial S_v}{\\partial Y_j} \\quad \\text{for } j \\in \\{1, \\dots, N_s\\}\n$$\n$$\n(\\mathbf{J}_F)_{N_s+1, N_s+1} = \\frac{\\partial F_{N_s+1}}{\\partial T_v} = \\frac{\\partial}{\\partial T_v} \\left( \\frac{S_v}{\\rho c_{v,v}} \\right) = \\frac{1}{\\rho c_{v,v}} \\frac{\\partial S_v}{\\partial T_v}\n$$\n所有导数都在已知状态 $\\vec{U}^n$ 处求值。\n\n现在我们可以明确矩阵 $\\mathbf{A}$ 和向量 $\\vec{b}$ 的元素。\n\n**$\\mathbf{A} \\Delta\\vec{U} = \\vec{b}$ 中矩阵 $\\mathbf{A}$ 的元素：**\n矩阵 $\\mathbf{A}$ 的大小为 $(N_s+1) \\times (N_s+1)$。\n\n1.  左上块（$N_s \\times N_s$），对于 $i \\in \\{1, \\dots, N_s\\}$ 和 $j \\in \\{1, \\dots, N_s\\}$：\n    $$\n    A_{ij} = (\\mathbf{I} - \\Delta t \\, \\mathbf{J}_F)_{ij} = \\delta_{ij} - \\Delta t \\, (\\mathbf{J}_F)_{ij} = \\delta_{ij} - \\frac{\\Delta t}{\\rho} \\left. \\frac{\\partial \\omega_i}{\\partial Y_j} \\right|_n\n    $$\n    其中 $\\delta_{ij}$ 是克罗内克 δ。\n\n2.  右上块（$N_s \\times 1$），与 $\\Delta T_v$ 耦合的列，对于 $i \\in \\{1, \\dots, N_s\\}$：\n    $$\n    A_{i, N_s+1} = -\\Delta t \\, (\\mathbf{J}_F)_{i, N_s+1} = - \\frac{\\Delta t}{\\rho} \\left. \\frac{\\partial \\omega_i}{\\partial T_v} \\right|_n\n    $$\n\n3.  左下块（$1 \\times N_s$），$T_v$ 方程所在的行，对于 $j \\in \\{1, \\dots, N_s\\}$：\n    $$\n    A_{N_s+1, j} = -\\Delta t \\, (\\mathbf{J}_F)_{N_s+1, j} = - \\frac{\\Delta t}{\\rho c_{v,v}} \\left. \\frac{\\partial S_v}{\\partial Y_j} \\right|_n\n    $$\n\n4.  右下块（$1 \\times 1$），$T_v$ 方程的对角项：\n    $$\n    A_{N_s+1, N_s+1} = 1 - \\Delta t \\, (\\mathbf{J}_F)_{N_s+1, N_s+1} = 1 - \\frac{\\Delta t}{\\rho c_{v,v}} \\left. \\frac{\\partial S_v}{\\partial T_v} \\right|_n\n    $$\n\n**右侧向量 $\\vec{b}$ 的分量：**\n向量 $\\vec{b}$ 有 $N_s+1$ 个分量。\n\n1.  上半部分（前 $N_s$ 个分量），对应于物种方程：\n    $$\n    b_i = \\Delta t \\, F_i(\\vec{U}^n) = \\frac{\\Delta t}{\\rho} \\, \\omega_i^n \\quad \\text{for } i \\in \\{1, \\dots, N_s\\}\n    $$\n\n2.  下半部分（最后一个分量），对应于能量方程：\n    $$\n    b_{N_s+1} = \\Delta t \\, F_{N_s+1}(\\vec{U}^n) = \\frac{\\Delta t}{\\rho c_{v,v}} \\, S_v^n\n    $$\n\n根据时间层 $n$ 的给定数据构建矩阵 $\\mathbf{A}$ 和向量 $\\vec{b}$ 后，我们求解线性系统 $\\mathbf{A} \\Delta\\vec{U} = \\vec{b}$ 以求得增量向量 $\\Delta\\vec{U} = [\\Delta Y_1, \\dots, \\Delta Y_{N_s}, \\Delta T_v]^T$。\n\n最后，将状态变量更新到新的时间层 $n+1$：\n$$\nY_i^{n+1} = Y_i^n + \\Delta Y_i, \\quad i = 1, \\dots, N_s\n$$\n$$\nT_v^{n+1} = T_v^n + \\Delta T_v\n$$\n以下程序为提供的测试用例实现了此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and solves the point-implicit linear system for each test case\n    to find the updated species mass fractions and vibrational temperature.\n    \"\"\"\n    test_cases = [\n        {\n            \"Ns\": 2,\n            \"rho\": 0.5,\n            \"dt\": 1.0e-3,\n            \"Yn\": [0.8, 0.2],\n            \"Tvn\": 7000,\n            \"omega_n\": [-1.0e-3, 1.0e-3],\n            \"d_omega_d_Y_n\": [[-0.2, 0.2], [0.2, -0.2]],\n            \"d_omega_d_Tv_n\": [0.0, 0.0],\n            \"Sv_n\": -2000,\n            \"d_Sv_d_Y_n\": [100, -100],\n            \"d_Sv_d_Tv_n\": -5000,\n            \"c_vv\": 1000,\n        },\n        {\n            \"Ns\": 3,\n            \"rho\": 0.2,\n            \"dt\": 2.0e-5,\n            \"Yn\": [0.6, 0.3, 0.1],\n            \"Tvn\": 9000,\n            \"omega_n\": [-1.0e-2, 8.0e-3, 2.0e-3],\n            \"d_omega_d_Y_n\": [[-10.0, 8.0, 2.0], [10.0, -12.0, 2.0], [0.0, 4.0, -4.0]],\n            \"d_omega_d_Tv_n\": [0.5, -0.3, -0.2],\n            \"Sv_n\": -5.0e5,\n            \"d_Sv_d_Y_n\": [1.0e4, -5.0e3, 0.0],\n            \"d_Sv_d_Tv_n\": -2.0e6,\n            \"c_vv\": 1500,\n        },\n        {\n            \"Ns\": 1,\n            \"rho\": 1.0,\n            \"dt\": 1.0e-2,\n            \"Yn\": [1.0],\n            \"Tvn\": 3000,\n            \"omega_n\": [0.0],\n            \"d_omega_d_Y_n\": [[0.0]],\n            \"d_omega_d_Tv_n\": [0.0],\n            \"Sv_n\": 0.0,\n            \"d_Sv_d_Y_n\": [0.0],\n            \"d_Sv_d_Tv_n\": 0.0,\n            \"c_vv\": 1000,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters\n        Ns = case[\"Ns\"]\n        rho = case[\"rho\"]\n        dt = case[\"dt\"]\n        Yn = np.array(case[\"Yn\"], dtype=float)\n        Tvn = float(case[\"Tvn\"])\n        omega_n = np.array(case[\"omega_n\"], dtype=float)\n        d_omega_d_Y_n = np.array(case[\"d_omega_d_Y_n\"], dtype=float)\n        d_omega_d_Tv_n = np.array(case[\"d_omega_d_Tv_n\"], dtype=float)\n        Sv_n = float(case[\"Sv_n\"])\n        d_Sv_d_Y_n = np.array(case[\"d_Sv_d_Y_n\"], dtype=float)\n        d_Sv_d_Tv_n = float(case[\"d_Sv_d_Tv_n\"])\n        c_vv = float(case[\"c_vv\"])\n\n        # Initialize the matrix A and vector b\n        system_size = Ns + 1\n        A = np.zeros((system_size, system_size))\n        b = np.zeros(system_size)\n\n        # Populate matrix A\n        # Upper-left block (species-species coupling)\n        A[:Ns, :Ns] = np.identity(Ns) - (dt / rho) * d_omega_d_Y_n\n        # Upper-right block (species-temperature coupling)\n        A[:Ns, Ns] = - (dt / rho) * d_omega_d_Tv_n\n        # Lower-left block (temperature-species coupling)\n        A[Ns, :Ns] = - (dt / (rho * c_vv)) * d_Sv_d_Y_n\n        # Lower-right block (temperature-temperature coupling)\n        A[Ns, Ns] = 1 - (dt / (rho * c_vv)) * d_Sv_d_Tv_n\n\n        # Populate vector b\n        # Upper part (species source terms)\n        b[:Ns] = (dt / rho) * omega_n\n        # Lower part (energy source term)\n        b[Ns] = (dt / (rho * c_vv)) * Sv_n\n\n        # Solve the linear system A * delta_U = b\n        delta_U = np.linalg.solve(A, b)\n\n        # Extract increments\n        delta_Y = delta_U[:Ns]\n        delta_Tv = delta_U[Ns]\n\n        # Update the state\n        Y_np1 = Yn + delta_Y\n        Tv_np1 = Tvn + delta_Tv\n\n        # Store the result for this case\n        case_result = list(Y_np1) + [Tv_np1]\n        results.append(case_result)\n\n    # Format the final output string as per requirements\n    formatted_results = []\n    for res_list in results:\n        formatted_nums = [f\"{num:.6f}\" for num in res_list]\n        formatted_results.append(f\"[{','.join(formatted_nums)}]\")\n\n    print(f\"[[{','.join(formatted_results)}]]\")\n\nsolve()\n```"
        }
    ]
}