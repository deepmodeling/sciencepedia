{
    "hands_on_practices": [
        {
            "introduction": "在模拟反应流时，准确描述可逆反应至关重要，这要求我们将化学动力学与热力学原理紧密联系起来。本练习将引导您从第一性原理出发，推导并计算反应速率常数之间的基本关系。您将学习如何通过平衡常数 $K_c(T)$ 将逆反应速率 $k_r$ 与正反应速率 $k_f$ 联系起来，而平衡常数本身又由反应的吉布斯自由能变化 $\\Delta g^0(T)$ 决定。掌握这一被称为“细致平衡原理”的概念，是构建任何物理上自洽的有限速率化学模型的基石。",
            "id": "3989119",
            "problem": "一种在高温下典型的航空航天计算流体动力学 (CFD) 中的理想气体反应混合物，被认为是空间均匀、充分混合的，且扩散输运可忽略不计。关注基元反应\n$$\\mathrm{CO} + \\mathrm{OH} \\rightleftharpoons \\mathrm{CO}_2 + \\mathrm{H},$$\n该反应用于模拟反应流中的有限速率源项。假设所有物种的标准态压力为 $p^{0} = 1\\,\\text{bar}$，且混合物遵循理想气体行为。\n\n从化学势、吉布斯自由能和质量作用定律的基本定义出发，推导基于浓度的平衡常数 $K_{c}(T)$ 与温度 $T$ 下的标准反应吉布斯自由能变 $\\Delta g^{0}(T)$ 之间的关系，并利用平衡条件从正向速率常数 $k_{f}(T)$ 求得逆向 Arrhenius 速率常数 $k_{r}(T)$。\n\n然后，在温度 $T = 2000\\,\\text{K}$ 时，使用以下热力学和动力学数据计算 $k_{r}(T)$ 的数值：\n- 在 $T = 2000\\,\\text{K}$ 时的标准生成吉布斯自由能：\n  $$g_{f,\\mathrm{CO}}^{0}(T) = -150000\\,\\text{J/mol},\\quad g_{f,\\mathrm{OH}}^{0}(T) = 30000\\,\\text{J/mol},$$\n  $$g_{f,\\mathrm{CO}_2}^{0}(T) = -360000\\,\\text{J/mol},\\quad g_{f,\\mathrm{H}}^{0}(T) = 200000\\,\\text{J/mol}.$$\n- 反应 $\\mathrm{CO} + \\mathrm{OH} \\rightarrow \\mathrm{CO}_2 + \\mathrm{H}$ 的正向 Arrhenius 参数：\n  $$A_{f} = 5.00 \\times 10^{7}\\,\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1},\\quad n_{f} = 0.0,\\quad E_{f} = 1.20 \\times 10^{4}\\,\\text{J/mol}.$$\n- 普适气体常数：\n  $$R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}.$$\n\n你的推导应从由化学势表示的平衡条件和 $\\Delta g^{0}(T)$ 的定义开始，进而得到适用于理想气体的 $K_{c}(T)$ 的形式。利用此关系从 $k_{f}(T)$ 求出 $k_{r}(T)$。最后，数值计算 $k_{r}(2000\\,\\text{K})$。\n\n将 $k_{r}(2000\\,\\text{K})$ 的最终数值答案四舍五入至四位有效数字。以 $\\text{m}^{3}\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$ 为单位表示最终答案。",
            "solution": "该问题经验证具有科学依据、良定且客观。它基于化学热力学和动力学的基本原理。所有必要数据均已提供，问题没有矛盾或含糊之处。\n\n解答按要求分三部分进行：\n1.  推导基于浓度的平衡常数 $K_c(T)$ 的关系式。\n2.  推导正向和逆向速率常数 $k_f(T)$ 与 $k_r(T)$ 之间的关系。\n3.  在 $T=2000\\,\\text{K}$ 时对 $k_r(T)$ 进行数值计算。\n\n**1. 平衡常数 $K_c(T)$ 的推导**\n\n基元反应为：\n$$ \\mathrm{CO} + \\mathrm{OH} \\rightleftharpoons \\mathrm{CO}_2 + \\mathrm{H} $$\n化学平衡的条件是反应的吉布斯自由能变 $\\Delta G_r$ 为零。该变化表示为各物种的化学势 $\\mu_i$ 按其化学计量系数 $\\nu_i$（产物为正，反应物为负）加权的共和：\n$$ \\Delta G_r = \\sum_{i} \\nu_i \\mu_i = 0 $$\n对于给定反应，这变为：\n$$ \\mu_{\\mathrm{CO}_2} + \\mu_{\\mathrm{H}} - \\mu_{\\mathrm{CO}} - \\mu_{\\mathrm{OH}} = 0 $$\n在理想气体混合物中，物种 $i$ 的化学势 $\\mu_i$ 与其在标准压力 $p^0$ 下的标准化学势 $\\mu_i^0(T)$ 的关系如下：\n$$ \\mu_i(T, p_i) = \\mu_i^0(T) + RT \\ln\\left(\\frac{p_i}{p^0}\\right) $$\n其中 $p_i$ 是物种 $i$ 的分压，$R$ 是普适气体常数，$T$ 是温度。标准化学势 $\\mu_i^0(T)$ 等同于标准摩尔吉布斯自由能 $g_i^0(T)$。\n\n将各物种的此表达式代入平衡条件：\n$$ \\left( \\mu_{\\mathrm{CO}_2}^0 + RT \\ln\\frac{p_{\\mathrm{CO}_2}}{p^0} \\right) + \\left( \\mu_{\\mathrm{H}}^0 + RT \\ln\\frac{p_{\\mathrm{H}}}{p^0} \\right) - \\left( \\mu_{\\mathrm{CO}}^0 + RT \\ln\\frac{p_{\\mathrm{CO}}}{p^0} \\right) - \\left( \\mu_{\\mathrm{OH}}^0 + RT \\ln\\frac{p_{\\mathrm{OH}}}{p^0} \\right) = 0 $$\n将标准势项和对数项分组：\n$$ (\\mu_{\\mathrm{CO}_2}^0 + \\mu_{\\mathrm{H}}^0 - \\mu_{\\mathrm{CO}}^0 - \\mu_{\\mathrm{OH}}^0) + RT \\ln\\left( \\frac{(p_{\\mathrm{CO}_2}/p^0)(p_{\\mathrm{H}}/p^0)}{(p_{\\mathrm{CO}}/p^0)(p_{\\mathrm{OH}}/p^0)} \\right)_{\\text{eq}} = 0 $$\n第一项是标准反应吉布斯自由能变 $\\Delta g^0(T)$：\n$$ \\Delta g^0(T) = \\mu_{\\mathrm{CO}_2}^0 + \\mu_{\\mathrm{H}}^0 - \\mu_{\\mathrm{CO}}^0 - \\mu_{\\mathrm{OH}}^0 $$\n对数内的项是基于压力的平衡常数 $K_p(T)$：\n$$ K_p(T) = \\left( \\frac{(p_{\\mathrm{CO}_2}/p^0)(p_{\\mathrm{H}}/p^0)}{(p_{\\mathrm{CO}}/p^0)(p_{\\mathrm{OH}}/p^0)} \\right)_{\\text{eq}} $$\n因此，平衡条件简化为：\n$$ \\Delta g^0(T) + RT \\ln K_p(T) = 0 \\implies K_p(T) = \\exp\\left(-\\frac{\\Delta g^0(T)}{RT}\\right) $$\n为了求出基于浓度的平衡常数 $K_c(T)$，我们使用理想气体定律 $p_i = [i]RT$，其中 $[i]$ 是物种 $i$ 的摩尔浓度。\n$$ K_p(T) = \\frac{([\\mathrm{CO}_2]RT/p^0)([\\mathrm{H}]RT/p^0)}{([\\mathrm{CO}]RT/p^0)([\\mathrm{OH}]RT/p^0)} = \\frac{[\\mathrm{CO}_2][\\mathrm{H}]}{[\\mathrm{CO}][\\mathrm{OH}]} \\left(\\frac{RT}{p^0}\\right)^{(1+1)-(1+1)} $$\n第一个因子是 $K_c(T)$ 的定义。指数是反应中气体摩尔数的变化量 $\\Delta\\nu = (1+1)-(1+1)=0$。因此，对于这个特定反应，$(RT/p^0)$ 项的幂为 $0$，其值为 $1$。\n$$ K_p(T) = K_c(T) \\left(\\frac{RT}{p^0}\\right)^0 = K_c(T) $$\n所以，$K_c(T)$ 所需的关系式为：\n$$ K_c(T) = \\exp\\left(-\\frac{\\Delta g^0(T)}{RT}\\right) $$\n\n**2. 逆向速率常数 $k_r(T)$ 的推导**\n\n在化学平衡时，净反应速率为零，这意味着正向反应速率 ($r_f$) 等于逆向反应速率 ($r_r$)。根据此基元反应的质量作用定律：\n$$ r_f = k_f(T)[\\mathrm{CO}][\\mathrm{OH}] $$\n$$ r_r = k_r(T)[\\mathrm{CO}_2][\\mathrm{H}] $$\n在平衡时，$r_{f,\\text{eq}} = r_{r,\\text{eq}}$：\n$$ k_f(T)[\\mathrm{CO}]_{\\text{eq}}[\\mathrm{OH}]_{\\text{eq}} = k_r(T)[\\mathrm{CO}_2]_{\\text{eq}}[\\mathrm{H}]_{\\text{eq}} $$\n重新整理此方程可得：\n$$ \\frac{k_f(T)}{k_r(T)} = \\frac{[\\mathrm{CO}_2]_{\\text{eq}}[\\mathrm{H}]_{\\text{eq}}}{[\\mathrm{CO}]_{\\text{eq}}[\\mathrm{OH}]_{\\text{eq}}} $$\n等式右侧是基于浓度的平衡常数 $K_c(T)$ 的定义。\n$$ \\frac{k_f(T)}{k_r(T)} = K_c(T) $$\n因此，逆向速率常数可以表示为正向速率常数和平衡常数的函数：\n$$ k_r(T) = \\frac{k_f(T)}{K_c(T)} $$\n\n**3. $k_r(2000\\,\\text{K})$ 的数值计算**\n\n首先，我们结合推导出的表达式。\n$$ k_r(T) = \\frac{k_f(T)}{K_c(T)} = \\frac{k_f(T)}{\\exp\\left(-\\frac{\\Delta g^0(T)}{RT}\\right)} = k_f(T) \\exp\\left(\\frac{\\Delta g^0(T)}{RT}\\right) $$\n正向速率常数 $k_f(T)$ 由修正的 Arrhenius 方程给出：\n$$ k_f(T) = A_f T^{n_f} \\exp\\left(-\\frac{E_f}{RT}\\right) $$\n将此代入 $k_r(T)$ 的表达式中：\n$$ k_r(T) = A_f T^{n_f} \\exp\\left(-\\frac{E_f}{RT}\\right) \\exp\\left(\\frac{\\Delta g^0(T)}{RT}\\right) = A_f T^{n_f} \\exp\\left(\\frac{\\Delta g^0(T) - E_f}{RT}\\right) $$\n现在，我们使用给定数据在 $T = 2000\\,\\text{K}$ 时计算此表达式。\n\n首先，计算标准反应吉布斯自由能变 $\\Delta g^0(T)$：\n$$ \\Delta g^0(T) = (g_{f,\\mathrm{CO}_2}^0 + g_{f,\\mathrm{H}}^0) - (g_{f,\\mathrm{CO}}^0 + g_{f,\\mathrm{OH}}^0) $$\n$$ \\Delta g^0(2000\\,\\text{K}) = (-360000 + 200000)\\,\\text{J/mol} - (-150000 + 30000)\\,\\text{J/mol} $$\n$$ \\Delta g^0(2000\\,\\text{K}) = -160000\\,\\text{J/mol} - (-120000\\,\\text{J/mol}) = -40000\\,\\text{J/mol} $$\n\n现在，将此值用于 $k_r(2000\\,\\text{K})$ 的组合表达式中。\n给定数据：\n$A_f = 5.00 \\times 10^7\\,\\text{m}^3\\,\\text{mol}^{-1}\\,\\text{s}^{-1}$\n$n_f = 0.0$\n$E_f = 1.20 \\times 10^4\\,\\text{J/mol}$\n$\\Delta g^0(2000\\,\\text{K}) = -4.00 \\times 10^4\\,\\text{J/mol}$\n$R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$\n$T = 2000\\,\\text{K}$\n\n项 $T^{n_f} = (2000)^{0.0} = 1$。\n指数项为：\n$$ \\frac{\\Delta g^0(T) - E_f}{RT} = \\frac{-40000\\,\\text{J/mol} - 12000\\,\\text{J/mol}}{(8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(2000\\,\\text{K})} $$\n$$ \\frac{-52000}{16628.925236} \\approx -3.1271198 $$\n现在，计算 $k_r(2000\\,\\text{K})$：\n$$ k_r(2000\\,\\text{K}) = (5.00 \\times 10^7) \\times (1) \\times \\exp(-3.1271198) $$\n$$ k_r(2000\\,\\text{K}) \\approx (5.00 \\times 10^7) \\times 0.043846603 $$\n$$ k_r(2000\\,\\text{K}) \\approx 2192330.15\\,\\text{m}^3\\,\\text{mol}^{-1}\\,\\text{s}^{-1} $$\n将结果四舍五入至四位有效数字，可得：\n$$ k_r(2000\\,\\text{K}) \\approx 2.192 \\times 10^6\\,\\text{m}^3\\,\\text{mol}^{-1}\\,\\text{s}^{-1} $$\n$k_r$ 的单位与 $k_f$ 相同，因为对于此反应，$K_c$ 是无量纲的（$\\Delta\\nu = 0$）。",
            "answer": "$$\n\\boxed{2.192 \\times 10^{6}}\n$$"
        },
        {
            "introduction": "在掌握了反应速率的基础知识后，我们将其应用于一个典型的燃烧问题：非预混扩散火焰。扩散火焰是航空航天发动机中的常见现象，理解其结构和温度至关重要。本练习首先采用一个理想化模型——假设化学反应速率无限快且过程绝热，来计算火焰的最高理论温度，即绝热火焰温度。这个计算为我们提供了一个重要的基准，并揭示了在真实高速系统中，有限速率化学和热量损失等实际因素如何导致火焰温度偏离理想值。",
            "id": "3989092",
            "problem": "在计算流体动力学 (CFD) 框架中，考虑一个在环境压力 $p = 1\\,\\mathrm{atm}$ 下，位于两个半无限流之间的稳态平面非预混扩散火焰。燃料流为纯甲烷（物种 $\\mathrm{CH_4}$），质量分数为 $Y_{F,\\infty} = 1$，温度为 $T_{F,0} = 298\\,\\mathrm{K}$。氧化剂流为干燥空气，温度为 $T_{O,0} = 298\\,\\mathrm{K}$，质量分数为 $Y_{\\mathrm{O_2},\\infty} = 0.233$ 和 $Y_{\\mathrm{N_2},\\infty} = 0.767$。假设总反应为\n$$\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O},$$\n在 $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$ 下的标准生成焓由 $h_f^0(\\mathrm{CH_4}) = -74.85\\,\\mathrm{kJ/mol}$，$h_f^0(\\mathrm{CO_2}) = -393.5\\,\\mathrm{kJ/mol}$，$h_f^0(\\mathrm{H_2O(g)}) = -241.826\\,\\mathrm{kJ/mol}$，$h_f^0(\\mathrm{O_2}) = 0$ 和 $h_f^0(\\mathrm{N_2}) = 0$ 给出。分子量为 $W_{\\mathrm{CH_4}} = 16\\,\\mathrm{kg/kmol}$，$W_{\\mathrm{O_2}} = 32\\,\\mathrm{kg/kmol}$，$W_{\\mathrm{CO_2}} = 44\\,\\mathrm{kg/kmol}$ 和 $W_{\\mathrm{H_2O}} = 18\\,\\mathrm{kg/kmol}$。\n\n采用混合分数概念，其中混合分数 $Z$ 表示源自燃料流的局部质量分数，在燃料中 $Z = 1$，在氧化剂中 $Z = 0$。利用元素守恒和化学计量关系，通过确定局部化学计量条件下的燃料和氧化剂质量比，来计算化学计量混合分数 $Z_{\\mathrm{st}}$。将氮气视为惰性气体。在无限快化学反应和绝热条件的假设下，最高火焰温度出现在 $Z = Z_{\\mathrm{st}}$ 处，并且可以通过能量平衡（将产物的显焓升高与化学热释放相等）来获得。对于 $Z_{\\mathrm{st}}$ 处的已燃混合物，使用与温度相关的线性拟合来近似混合物平均定压比热\n$$c_{p,\\mathrm{mix}}(T) = a + b\\,T,$$\n其中 $a = 1.15\\,\\mathrm{kJ/(kg\\cdot K)}$ 和 $b = 2.0 \\times 10^{-4}\\,\\mathrm{kJ/(kg\\cdot K^2)}$，在 $T \\in [298\\,\\mathrm{K}, 3000\\,\\mathrm{K}]$ 范围内有效。\n\n使用第一性原理（质量守恒、元素平衡和能量守恒），计算扩散火焰在 $Z = Z_{\\mathrm{st}}$ 处的绝热最高温度 $T_{\\max}$。最终答案以 $\\mathrm{K}$ 为单位表示，并四舍五入到四位有效数字。\n\n然后，简要解释（无需计算）为什么在真实的航空航天配置中，由于有限速率化学反应和热损失，高速反应流中的实际峰值温度可能会偏离此值。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、适定且客观。\n\n**步骤1：提取已知条件**\n- 流场条件：稳态平面非预混扩散火焰。\n- 压力：$p = 1\\,\\mathrm{atm}$。\n- 燃料流：纯甲烷 ($\\mathrm{CH_4}$)，$Y_{F,\\infty} = 1$，$T_{F,0} = 298\\,\\mathrm{K}$。\n- 氧化剂流：干燥空气，$Y_{\\mathrm{O_2},\\infty} = 0.233$，$Y_{\\mathrm{N_2},\\infty} = 0.767$，$T_{O,0} = 298\\,\\mathrm{K}$。\n- 化学计量：$\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$。\n- 参考温度：$T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$。\n- 标准生成焓 ($h_f^0$)：\n  - $h_f^0(\\mathrm{CH_4}) = -74.85\\,\\mathrm{kJ/mol}$\n  - $h_f^0(\\mathrm{CO_2}) = -393.5\\,\\mathrm{kJ/mol}$\n  - $h_f^0(\\mathrm{H_2O(g)}) = -241.826\\,\\mathrm{kJ/mol}$\n  - $h_f^0(\\mathrm{O_2}) = 0\\,\\mathrm{kJ/mol}$\n  - $h_f^0(\\mathrm{N_2}) = 0\\,\\mathrm{kJ/mol}$\n- 分子量 ($W$)：\n  - $W_{\\mathrm{CH_4}} = 16\\,\\mathrm{kg/kmol}$\n  - $W_{\\mathrm{O_2}} = 32\\,\\mathrm{kg/kmol}$\n  - $W_{\\mathrm{CO_2}} = 44\\,\\mathrm{kg/kmol}$\n  - $W_{\\mathrm{H_2O}} = 18\\,\\mathrm{kg/kmol}$\n- 混合分数概念：燃料中 $Z=1$，氧化剂中 $Z=0$。\n- 假设：无限快化学反应，绝热条件。\n- 产物混合物比热：$c_{p,\\mathrm{mix}}(T) = a + b\\,T$，其中 $a = 1.15\\,\\mathrm{kJ/(kg\\cdot K)}$ 和 $b = 2.0 \\times 10^{-4}\\,\\mathrm{kJ/(kg\\cdot K^2)}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，代表了经典的 Burke-Schumann 扩散火焰分析，这是燃烧学中的一个基本课题。该问题是适定的，提供了所有必要的热力学数据、边界条件和比热的本构关系，以确定绝热火焰温度的唯一解。数据是一致且物理上合理的。该问题是客观的，并使用了反应流领域的标准术语。该问题与*航空航天cfd*中的*反应流和有限速率化学*主题直接相关。\n\n**步骤3：结论与行动**\n问题**有效**。将推导解答。\n\n**解答推导**\n\n绝热最高温度 $T_{\\max}$ 的计算涉及三个主要步骤：\n1.  确定化学计量混合分数 $Z_{\\mathrm{st}}$。\n2.  计算反应热。\n3.  对绝热系统应用热力学第一定律（能量平衡）。\n\n**1. 化学计量混合分数 ($Z_{\\mathrm{st}}$)**\n化学计量质量比 $s$ 是完全燃烧单位质量燃料所需的纯氧质量。根据化学反应 $\\mathrm{CH_4} + 2\\,\\mathrm{O_2} \\rightarrow \\mathrm{CO_2} + 2\\,\\mathrm{H_2O}$，摩尔比为 2 摩尔 $\\mathrm{O_2}$ 对 1 摩尔 $\\mathrm{CH_4}$。\n$$\ns = \\frac{\\text{mass of }\\mathrm{O_2}}{\\text{mass of }\\mathrm{CH_4}} = \\frac{2 \\cdot W_{\\mathrm{O_2}}}{1 \\cdot W_{\\mathrm{CH_4}}} = \\frac{2 \\times 32\\,\\mathrm{kg/kmol}}{1 \\times 16\\,\\mathrm{kg/kmol}} = 4\n$$\n氧化剂流是空气，其中氧气的质量分数为 $Y_{\\mathrm{O_2},\\infty} = 0.233$。因此，化学计量空燃质量比 $(A/F)_{\\mathrm{st}}$ 为：\n$$\n\\left(\\frac{A}{F}\\right)_{\\mathrm{st}} = \\frac{s}{Y_{\\mathrm{O_2},\\infty}} = \\frac{4}{0.233}\n$$\n化学计量混合分数 $Z_{\\mathrm{st}}$ 是化学计量的燃料和空气混合物中燃料的质量分数。\n$$\nZ_{\\mathrm{st}} = \\frac{m_{\\text{fuel}}}{m_{\\text{fuel}} + m_{\\text{air}}} = \\frac{1}{1 + (m_{\\text{air}}/m_{\\text{fuel}})} = \\frac{1}{1 + (A/F)_{\\mathrm{st}}}\n$$\n$$\nZ_{\\mathrm{st}} = \\frac{1}{1 + \\frac{4}{0.233}} = \\frac{0.233}{0.233 + 4} = \\frac{0.233}{4.233} \\approx 0.0550437\n$$\n\n**2. 反应热**\n在参考温度 $T_{\\mathrm{ref}} = 298\\,\\mathrm{K}$ 下，每摩尔燃料的标准反应热 $\\Delta H_R^0$ 是根据生成焓计算的。\n$$\n\\Delta H_R^0 = \\sum_{\\text{products}} \\nu_k h_{f,k}^0 - \\sum_{\\text{reactants}} \\nu_k h_{f,k}^0\n$$\n$$\n\\Delta H_R^0 = \\left[1 \\cdot h_f^0(\\mathrm{CO_2}) + 2 \\cdot h_f^0(\\mathrm{H_2O})\\right] - \\left[1 \\cdot h_f^0(\\mathrm{CH_4}) + 2 \\cdot h_f^0(\\mathrm{O_2})\\right]\n$$\n$$\n\\Delta H_R^0 = \\left[1(-393.5) + 2(-241.826)\\right] - \\left[1(-74.85) + 2(0)\\right]\n$$\n$$\n\\Delta H_R^0 = -877.152 - (-74.85) = -802.302\\,\\mathrm{kJ/mol} \\text{ of } \\mathrm{CH_4}\n$$\n单位质量燃料释放的热量 $q_R$ 为：\n$$\nq_R = \\frac{-\\Delta H_R^0}{W_{\\mathrm{CH_4}}} = \\frac{802.302\\,\\mathrm{kJ/mol}}{16\\,\\mathrm{kg/kmol}} = 50.143875\\,\\mathrm{kJ/g} = 5.0143875 \\times 10^7\\,\\mathrm{J/kg}\n$$\n\n**3. 绝热能量平衡**\n对于一个绝热系统，反应物在 $T_0 = T_{\\mathrm{ref}}$ 进入，能量平衡表明反应释放的热量等于产物的显焓升高。对于单位质量的化学计量混合物，燃料的质量为 $Z_{\\mathrm{st}}$，释放的热量为 $Z_{\\mathrm{st}} q_R$。这部分能量将产物从 $T_0$ 加热到 $T_{\\max}$。\n$$\n\\text{释放的热量} = \\text{显焓增益}\n$$\n$$\nZ_{\\mathrm{st}} q_R = \\int_{T_0}^{T_{\\max}} c_{p,\\mathrm{mix}}(T) \\,dT\n$$\n使用给定的混合物比热线性模型 $c_{p,\\mathrm{mix}}(T) = a + bT$：\n$$\nZ_{\\mathrm{st}} q_R = \\int_{T_0}^{T_{\\max}} (a+bT) \\,dT = \\left[aT + \\frac{1}{2}bT^2\\right]_{T_0}^{T_{\\max}}\n$$\n$$\nZ_{\\mathrm{st}} q_R = \\left(aT_{\\max} + \\frac{1}{2}bT_{\\max}^2\\right) - \\left(aT_0 + \\frac{1}{2}bT_0^2\\right)\n$$\n这可以重新整理为关于 $T_{\\max}$ 的二次方程：\n$$\n\\frac{1}{2}bT_{\\max}^2 + aT_{\\max} - \\left(Z_{\\mathrm{st}} q_R + aT_0 + \\frac{1}{2}bT_0^2\\right) = 0\n$$\n现在，我们代入一致的国际单位制单位（$J$, $kg$, $K$）下的数值。\n- $a = 1.15 \\times 10^3\\,\\mathrm{J/(kg\\cdot K)}$\n- $b = 2.0 \\times 10^{-4} \\times 10^3 = 0.2\\,\\mathrm{J/(kg\\cdot K^2)}$\n- $T_0 = 298\\,\\mathrm{K}$\n- $Z_{\\mathrm{st}} \\approx 0.0550437$\n- $q_R = 5.0143875 \\times 10^7\\,\\mathrm{J/kg}$\n\n我们来计算括号中的常数项：\n$Z_{\\mathrm{st}} q_R \\approx 0.0550437 \\times (5.0143875 \\times 10^7) \\approx 2.7600 \\times 10^6\\,\\mathrm{J/kg}$\n$aT_0 = (1.15 \\times 10^3) \\times 298 = 3.427 \\times 10^5\\,\\mathrm{J/kg}$\n$\\frac{1}{2}bT_0^2 = \\frac{1}{2}(0.2)(298)^2 = 0.1 \\times 88804 = 8880.4\\,\\mathrm{J/kg}$\n\n常数项为 $C = (2.7600 \\times 10^6) + (3.427 \\times 10^5) + 8880.4 \\approx 3.11158 \\times 10^6\\,\\mathrm{J/kg}$。\n二次方程为：\n$$\n\\frac{1}{2}(0.2)T_{\\max}^2 + (1.15 \\times 10^3)T_{\\max} - 3.11158 \\times 10^6 = 0\n$$\n$$\n0.1 T_{\\max}^2 + 1150 T_{\\max} - 3111580 = 0\n$$\n使用二次公式求解 $T_{\\max}$，$T_{\\max} = \\frac{-B \\pm \\sqrt{B^2-4AC'}}{2A}$，其中 $A=0.1$，$B=1150$，$C'=-3111580$：\n$$\nT_{\\max} = \\frac{-1150 + \\sqrt{(1150)^2 - 4(0.1)(-3111580)}}{2(0.1)}\n$$\n$$\nT_{\\max} = \\frac{-1150 + \\sqrt{1322500 + 1244632}}{0.2} = \\frac{-1150 + \\sqrt{2567132}}{0.2}\n$$\n$$\nT_{\\max} \\approx \\frac{-1150 + 1602.227}{0.2} = \\frac{452.227}{0.2} \\approx 2261.135\\,\\mathrm{K}\n$$\n将结果四舍五入到四位有效数字，得到 $T_{\\max} = 2261\\,\\mathrm{K}$。\n\n**关于在真实情景中偏差的解释**\n\n计算出的值 $T_{\\max} = 2261\\,\\mathrm{K}$ 是一个理想化的最大值。在实际的高速反应流中，例如在超燃冲压发动机或火箭发动机燃烧室中，观测到的峰值温度较低，主要有两个原因：\n\n1.  **有限速率化学反应：** 无限快化学反应（化学平衡）的假设意味着反应物在混合后瞬间转化为产物。实际上，化学反应以有限的速率进行。在高速流中，流体在燃烧室内的停留时间可能极短（毫秒量级），这可能不足以使反应达到完全。这种化学非平衡状态意味着并非所有的化学能都被释放，导致气体温度低于平衡绝热火焰温度。反应区变宽，最高温度降低。\n\n2.  **热损失：** 该计算假设了一个绝热系统，这意味着没有与周围环境的热量交换。任何实际的航空航天燃烧室的壁面为了结构完整性，都通过主动冷却等方式维持在远低于火焰温度的温度。这会产生巨大的温度梯度，导致通过对流从高温燃烧气体向壁面发生显著的热传递。此外，在所涉及的高温下，产物物种如 $\\mathrm{CO_2}$ 和 $\\mathrm{H_2O}$ 是强辐射体，会通过热辐射造成大量热损失。这些非绝热效应从气体中带走能量，直接降低其焓值，从而降低了可达到的峰值温度。",
            "answer": "$$\n\\boxed{2261}\n$$"
        },
        {
            "introduction": "为了将理论付诸实践，本练习将指导您通过编程来直接模拟有限速率化学过程。我们将聚焦于一个经典的航空航天问题：激波加热后的空气团的化学弛豫过程。您将为高温空气的离解反应建立常微分方程(ODE)组，并通过数值积分来追踪其组分随时间的变化，从而量化系统偏离化学平衡的程度。这个实践将“有限速率”这一抽象概念变得具体可感，直观地展示了化学变化需要时间的物理现实，并为您在计算流体力学(CFD)中处理化学非平衡问题打下坚实基础。",
            "id": "3989089",
            "problem": "考虑一个经过激波加热的空气块，其模型为一个在恒定压力 $p$ 和温度 $T$ 下的空间均匀、等温、等压的均相反应器。其组分仅限于四种物质：分子氧 $\\mathrm{O_2}$、原子氧 $\\mathrm{O}$、分子氮 $\\mathrm{N_2}$ 和原子氮 $\\mathrm{N}$。化学反应由两个可逆基元反应表示，\n$$\\mathrm{O_2} \\rightleftharpoons 2\\mathrm{O}, \\qquad \\mathrm{N_2} \\rightleftharpoons 2\\mathrm{N}.$$\n假设理想气体行为。设通用气体常数为 $R_u$，单位为 $\\mathrm{J/(mol\\,K)}$。总摩尔浓度由理想气体定律给出：$c_{\\mathrm{tot}} = p/(R_u T)$，单位为 $\\mathrm{mol/m^3}$。用 $x_i$ 表示物质的摩尔分数，用 $c_i = x_i c_{\\mathrm{tot}}$ 表示物质的摩尔浓度。对于正向反应速率为 $k_{f,r}(T)$、逆向反应速率为 $k_{b,r}(T)$ 的反应 $r$，其摩尔生成速率根据基元反应级数的质量作用定律计算，得到反应速率\n$$r_1 = k_{f,1}(T)\\,c_{\\mathrm{O_2}} - k_{b,1}(T)\\,c_{\\mathrm{O}}^2,\\qquad r_2 = k_{f,2}(T)\\,c_{\\mathrm{N_2}} - k_{b,2}(T)\\,c_{\\mathrm{N}}^2,$$\n单位为 $\\mathrm{mol/(m^3\\,s)}$。物质生成速率 $\\omega_i$（单位为 $\\mathrm{mol/(m^3\\,s)}$）由化学计量关系得出：\n$$\\omega_{\\mathrm{O_2}} = -r_1,\\quad \\omega_{\\mathrm{O}} = 2 r_1,\\quad \\omega_{\\mathrm{N_2}} = -r_2,\\quad \\omega_{\\mathrm{N}} = 2 r_2.$$\n由于反应会改变分子总数，恒压、恒温的约束条件意味着总摩尔浓度 $c_{\\mathrm{tot}}$ 保持不变。因此，摩尔分数的动力学方程必须包含一个归一化项，以确保在任何时候都满足 $\\sum_i x_i = 1$。从理想气体混合物在等温等压条件下的第一性原理出发，摩尔分数的常微分方程（ODE）组为\n$$\\frac{dx_i}{dt} = \\frac{1}{c_{\\mathrm{tot}}}\\left(\\omega_i - x_i \\sum_j \\omega_j\\right),$$\n其中 $i \\in \\{\\mathrm{O_2}, \\mathrm{O}, \\mathrm{N_2}, \\mathrm{N}\\}$，求和遍及所有物质。\n\n正向反应速率常数 $k_{f,r}(T)$ 由 Arrhenius 定律给出\n$$k_{f,r}(T) = A_r\\,T^{n_r}\\,\\exp\\!\\left(-\\frac{E_{a,r}}{R_u\\,T}\\right),$$\n其中 $A_r$ 的单位为 $\\mathrm{s^{-1}}$，$n_r$ 无量纲，$E_{a,r}$ 的单位为 $\\mathrm{J/mol}$。为通过细致平衡原理确保热力学一致性，使用平衡常数 $K_{c,r}(T)$（单位为 $\\mathrm{mol/m^3}$）。该常数由一个 van 't Hoff 关系式定义，其中包含指定的参考温度 $T_{\\mathrm{ref}}$ 和参考平衡常数 $K_{c,r}^{\\mathrm{ref}}$，\n$$K_{c,r}(T) = K_{c,r}^{\\mathrm{ref}}\\,\\exp\\!\\left(\\frac{\\Delta H_r}{R_u}\\left(\\frac{1}{T_{\\mathrm{ref}}} - \\frac{1}{T}\\right)\\right),$$\n其中 $\\Delta H_r$ 是反应 $r$ 的反应焓（假设为常数），单位为 $\\mathrm{J/mol}$。然后，逆向反应速率常数定义为\n$$k_{b,r}(T) = \\frac{k_{f,r}(T)}{K_{c,r}(T)},$$\n这样，$r_r = 0$ 就意味着满足质量作用的平衡条件。\n\n在相同的 $p$ 和 $T$ 条件下，平衡组分可以直接通过质量作用平衡关系和元素守恒计算得出。对于氧的子集，定义守恒的氧原子浓度 $a_{\\mathrm{O}}$ 为\n$$a_{\\mathrm{O}} = c_{\\mathrm{O}}^0 + 2 c_{\\mathrm{O_2}}^0,$$\n其中上标 $0$ 表示初始（激波后）浓度。在平衡状态下，\n$$c_{\\mathrm{O}}^2 = K_{c,1}(T)\\,c_{\\mathrm{O_2}},\\qquad c_{\\mathrm{O}} + 2 c_{\\mathrm{O_2}} = a_{\\mathrm{O}}.$$\n引入 $z = \\sqrt{c_{\\mathrm{O_2}}}$ 和 $b_1 = \\sqrt{K_{c,1}(T)}$，氧的平衡问题简化为一个二次方程\n$$2 z^2 + b_1 z - a_{\\mathrm{O}} = 0,$$\n其具有物理意义的解为\n$$z = \\frac{-b_1 + \\sqrt{b_1^2 + 8 a_{\\mathrm{O}}}}{4},\\qquad c_{\\mathrm{O_2}}^{\\mathrm{eq}} = z^2,\\qquad c_{\\mathrm{O}}^{\\mathrm{eq}} = b_1 z.$$\n对于氮，使用 $a_{\\mathrm{N}} = c_{\\mathrm{N}}^0 + 2 c_{\\mathrm{N_2}}^0$ 和 $b_2 = \\sqrt{K_{c,2}(T)}$，可以得到类似的公式。平衡摩尔分数为 $x_i^{\\mathrm{eq}} = c_i^{\\mathrm{eq}}/c_{\\mathrm{tot}}$。\n\n设分子量为 $W_{\\mathrm{O_2}} = 0.032\\,\\mathrm{kg/mol}$，$W_{\\mathrm{O}} = 0.016\\,\\mathrm{kg/mol}$，$W_{\\mathrm{N_2}} = 0.028\\,\\mathrm{kg/mol}$，$W_{\\mathrm{N}} = 0.014\\,\\mathrm{kg/mol}$，并定义混合物的平均分子量 $W_{\\mathrm{mix}} = \\sum_i x_i W_i$。质量分数为 $Y_i = x_i W_i/W_{\\mathrm{mix}}$。将偏离平衡的程度定义为在停留时间 $t_{\\mathrm{res}}$ 时质量分数的绝对差之和，\n$$\\Delta = \\sum_{i \\in \\{\\mathrm{O_2},\\mathrm{O},\\mathrm{N_2},\\mathrm{N}\\}} \\left|Y_i(t_{\\mathrm{res}}) - Y_i^{\\mathrm{eq}}\\right|,$$\n该值为无量纲。\n\n从初始激波后摩尔分数 $x_{\\mathrm{O_2}}^0$、$x_{\\mathrm{O}}^0$、$x_{\\mathrm{N_2}}^0$、$x_{\\mathrm{N}}^0$（其总和为 1）开始，对每个测试用例执行以下操作：\n- 在恒定的 $p$ 和 $T$ 下，将 ODE 系统从 $t=0$ 积分到 $t=t_{\\mathrm{res}}$，得到 $x_i(t_{\\mathrm{res}})$，然后计算 $Y_i(t_{\\mathrm{res}})$。\n- 使用二次公式计算平衡摩尔分数 $x_i^{\\mathrm{eq}}$ 及相应的 $Y_i^{\\mathrm{eq}}$。\n- 返回如上定义的 $\\Delta$。\n\n使用以下数值指定的参数，这些参数对于高温空气化学建模是科学上合理且自洽的：\n- 通用气体常数：$R_u = 8.314462618\\,\\mathrm{J/(mol\\,K)}$。\n- 反应焓：$\\Delta H_1 = 4.94\\times 10^5\\,\\mathrm{J/mol}$ (对于 $\\mathrm{O_2} \\rightleftharpoons 2\\mathrm{O}$)，以及 $\\Delta H_2 = 9.40\\times 10^5\\,\\mathrm{J/mol}$ (对于 $\\mathrm{N_2} \\rightleftharpoons 2\\mathrm{N}$)。\n- Arrhenius 参数：$A_1 = 1.0\\times 10^5\\,\\mathrm{s^{-1}}$，$n_1 = 1$，$E_{a,1} = 4.00\\times 10^5\\,\\mathrm{J/mol}$；$A_2 = 1.0\\times 10^5\\,\\mathrm{s^{-1}}$，$n_2 = 1$，$E_{a,2} = 9.40\\times 10^5\\,\\mathrm{J/mol}$。\n- 参考温度 $T_{\\mathrm{ref}} = 5000\\,\\mathrm{K}$ 下的平衡常数：$K_{c,1}^{\\mathrm{ref}} = 1.0\\,\\mathrm{mol/m^3}$，$K_{c,2}^{\\mathrm{ref}} = 1.0\\times 10^{-2}\\,\\mathrm{mol/m^3}$。\n\n输入必须使用物理单位：压力 $p$ 的单位是 $\\mathrm{Pa}$，温度 $T$ 的单位是 $\\mathrm{K}$，时间 $t_{\\mathrm{res}}$ 的单位是 $\\mathrm{s}$。不使用角度。所有输出均为无量纲。使用以下包含五个用例的测试套件；每个用例指定了 $(p,T,t_{\\mathrm{res}},x_{\\mathrm{O}}^0,x_{\\mathrm{N}}^0)$，其中包含原子物质的初始摩尔分数，而分子的初始摩尔分数为 $x_{\\mathrm{O_2}}^0 = 0.21 - x_{\\mathrm{O}}^0$ 和 $x_{\\mathrm{N_2}}^0 = 0.79 - x_{\\mathrm{N}}^0$：\n1. $(1.0\\times 10^5,\\ 5000,\\ 1.0\\times 10^{-4},\\ 0.0,\\ 0.0)$\n2. $(1.0\\times 10^5,\\ 3000,\\ 1.0\\times 10^{-3},\\ 0.0,\\ 0.0)$\n3. $(5.0\\times 10^5,\\ 7000,\\ 2.0\\times 10^{-4},\\ 0.0,\\ 0.0)$\n4. $(1.0\\times 10^5,\\ 6000,\\ 1.0\\times 10^{-7},\\ 0.0,\\ 0.0)$\n5. $(1.0\\times 10^5,\\ 5000,\\ 1.0\\times 10^{-4},\\ 0.01,\\ 0.005)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”），其中每个“result”是对应测试用例的 $\\Delta$ 的浮点值，顺序与上面给出的一致。",
            "solution": "该问题是化学动力学和常微分方程（ODE）领域一个定义明确的练习，其基础是反应气体动力学的基本原理。它要求在均相反应器中模拟简化的多高温空气混合物，并将随时间演化的状态与化学平衡状态进行比较。所有提供的参数、方程和约束在科学上和数学上都是一致的。因此，该问题被认为是有效的。\n\n对于每个测试用例，求解过程分为两个主要部分：首先，计算最终的化学平衡状态；其次，对物质摩尔分数进行时间积分，以求得在指定停留时间下的状态。然后计算这两种状态之间的偏差。\n\n**1. 系统和状态变量**\n\n该系统是四种理想气体物质的混合物：$\\mathrm{O_2}$、$\\mathrm{O}$、$\\mathrm{N_2}$ 和 $\\mathrm{N}$。我们可以分别将它们索引为 $i=0, 1, 2, 3$。系统的状态由摩尔分数集合 $\\{x_i\\}$ 描述，其中 $\\sum_i x_i = 1$。反应器保持在恒定压力 $p$ 和温度 $T$ 下。在这些条件下，总摩尔浓度 $c_{\\mathrm{tot}}$ 也是恒定的，由理想气体定律给出：\n$$c_{\\mathrm{tot}} = \\frac{p}{R_u T}$$\n其中 $R_u = 8.314462618\\,\\mathrm{J/(mol\\,K)}$ 是通用气体常数。物质 $i$ 的摩尔浓度为 $c_i = x_i c_{\\mathrm{tot}}$。\n\n**2. 化学动力学模型**\n\n化学反应由两个可逆反应控制：\n$$ \\mathrm{O_2} \\rightleftharpoons 2\\mathrm{O} \\quad (\\text{反应 1}) $$\n$$ \\mathrm{N_2} \\rightleftharpoons 2\\mathrm{N} \\quad (\\text{反应 2}) $$\n基于质量作用定律，反应速率 $r_1$ 和 $r_2$ 为：\n$$ r_1 = k_{f,1}(T) c_{\\mathrm{O_2}} - k_{b,1}(T) c_{\\mathrm{O}}^2 $$\n$$ r_2 = k_{f,2}(T) c_{\\mathrm{N_2}} - k_{b,2}(T) c_{\\mathrm{N}}^2 $$\n正向反应速率常数 $k_{f,r}(T)$ 遵循 Arrhenius 定律：\n$$ k_{f,r}(T) = A_r T^{n_r} \\exp\\left(-\\frac{E_{a,r}}{R_u T}\\right) $$\n逆向反应速率常数 $k_{b,r}(T)$ 通过细致平衡原理，使用基于浓度的平衡常数 $K_{c,r}(T)$ 确定：\n$$ k_{b,r}(T) = \\frac{k_{f,r}(T)}{K_{c,r}(T)} $$\n平衡常数使用简化的 van 't Hoff 关系式计算：\n$$ K_{c,r}(T) = K_{c,r}^{\\mathrm{ref}} \\exp\\left(\\frac{\\Delta H_r}{R_u}\\left(\\frac{1}{T_{\\mathrm{ref}}} - \\frac{1}{T}\\right)\\right) $$\n问题提供了所有必要的参数：$A_r, n_r, E_{a,r}, \\Delta H_r, T_{\\mathrm{ref}}, K_{c,r}^{\\mathrm{ref}}$。\n\n**3. 摩尔分数的控制常微分方程组**\n\n在等压-等温系统中，物质 $i$ 的摩尔浓度变化率为 $\\frac{dc_i}{dt} = \\omega_i - c_i \\frac{\\sum_j \\omega_j}{c_{\\mathrm{tot}}}$，其中物质生成速率 $\\omega_i$ 由反应的化学计量关系确定：\n$$ \\omega_{\\mathrm{O_2}} = -r_1, \\quad \\omega_{\\mathrm{O}} = 2r_1, \\quad \\omega_{\\mathrm{N_2}} = -r_2, \\quad \\omega_{\\mathrm{N}} = 2r_2 $$\n由于 $c_{\\mathrm{tot}}$ 是常数，所以 $\\frac{dc_i}{dt} = c_{\\mathrm{tot}} \\frac{dx_i}{dt}$。代入此式以及 $c_i = x_i c_{\\mathrm{tot}}$，得到摩尔分数的控制常微分方程组：\n$$ \\frac{dx_i}{dt} = \\frac{1}{c_{\\mathrm{tot}}} \\left( \\omega_i - x_i \\sum_j \\omega_j \\right) $$\n生成速率之和为 $\\sum_j \\omega_j = (-r_1) + (2r_1) + (-r_2) + (2r_2) = r_1 + r_2$。这个由四个耦合常微分方程组成的系统从 $t=0$ 积分到 $t=t_{\\mathrm{res}}$，初始条件为摩尔分数 $x_i^0$。由于反应时间尺度可能存在巨大差异，该系统通常是刚性的，需要使用合适的数值积分器，例如采用后向差分公式（BDF）或 Radau 方法的积分器。\n\n**4. 平衡组分计算**\n\n通过将反应速率设为零（$r_1=0, r_2=0$）并强制执行元素守恒来找到平衡组分。对于氧物质，守恒量是氧原子的总浓度 $a_{\\mathrm{O}}$，它在整个过程中保持不变：\n$$ a_{\\mathrm{O}} = c_{\\mathrm{O}} + 2c_{\\mathrm{O_2}} = c_{\\mathrm{O}}^0 + 2c_{\\mathrm{O_2}}^0 $$\n在平衡状态下，质量作用定律给出 $K_{c,1}(T) = (c_{\\mathrm{O}}^{\\mathrm{eq}})^2 / c_{\\mathrm{O_2}}^{\\mathrm{eq}}$。正如问题陈述中所推导的，该系统可以简化为关于 $z = \\sqrt{c_{\\mathrm{O_2}}^{\\mathrm{eq}}}$ 的二次方程：\n$$ 2z^2 + b_1 z - a_{\\mathrm{O}} = 0, \\quad \\text{其中 } b_1 = \\sqrt{K_{c,1}(T)} $$\n物理上有效的解产生平衡浓度：\n$$ z = \\frac{-b_1 + \\sqrt{b_1^2 + 8 a_{\\mathrm{O}}}}{4}, \\quad c_{\\mathrm{O_2}}^{\\mathrm{eq}} = z^2, \\quad c_{\\mathrm{O}}^{\\mathrm{eq}} = b_1 z $$\n对氮物质应用相同的过程，使用守恒的氮原子浓度 $a_{\\mathrm{N}} = c_{\\mathrm{N}}^0 + 2c_{\\mathrm{N_2}}^0$ 来求得 $c_{\\mathrm{N_2}}^{\\mathrm{eq}}$ 和 $c_{\\mathrm{N}}^{\\mathrm{eq}}$。根据这些平衡浓度，通过 $x_i^{\\mathrm{eq}} = c_i^{\\mathrm{eq}} / c_{\\mathrm{tot}}$ 求得平衡摩尔分数。\n\n**5. 最终度量计算**\n\n对于每个测试用例，我们执行以下步骤：\n1.  根据给定的 $x_{\\mathrm{O}}^0$ 和 $x_{\\mathrm{N}}^0$ 建立初始摩尔分数 $x_i^0$。\n2.  计算所有与温度相关的常数（$c_{\\mathrm{tot}}, k_{f,r}, K_{c,r}, k_{b,r}$）。\n3.  计算平衡浓度 $c_i^{\\mathrm{eq}}$ 和摩尔分数 $x_i^{\\mathrm{eq}}$。然后计算平衡质量分数 $Y_i^{\\mathrm{eq}} = x_i^{\\mathrm{eq}} W_i / \\sum_j(x_j^{\\mathrm{eq}} W_j)$，其中 $W_i$ 是物质 $i$ 的摩尔质量。\n4.  以初始条件 $x_i^0$ 将常微分方程组从 $t=0$ 数值积分到 $t=t_{\\mathrm{res}}$，以求得最终摩尔分数 $x_i(t_{\\mathrm{res}})$。\n5.  计算最终质量分数 $Y_i(t_{\\mathrm{res}}) = x_i(t_{\\mathrm{res}}) W_i / \\sum_j(x_j(t_{\\mathrm{res}}) W_j)$。\n6.  最终结果是偏差度量 $\\Delta$，计算为质量分数的绝对差之和：\n    $$ \\Delta = \\sum_{i \\in \\{\\mathrm{O_2},\\mathrm{O},\\mathrm{N_2},\\mathrm{N}\\}} \\left|Y_i(t_{\\mathrm{res}}) - Y_i^{\\mathrm{eq}}\\right| $$\n\n该实现将利用 `scipy.integrate.solve_ivp` 及其 'Radau' 方法，该方法非常适合化学动力学中常见的刚性常微分方程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the shock-heated air chemistry problem for a given set of test cases.\n    \"\"\"\n    \n    # Global Constants\n    Ru = 8.314462618  # J/(mol*K)\n    \n    # Species data: O2, O, N2, N\n    # Molecular weights (kg/mol)\n    W = np.array([0.032, 0.016, 0.028, 0.014])\n    \n    # Reaction 1: O2 => 2O\n    A1 = 1.0e5       # s^-1\n    n1 = 1.0\n    Ea1 = 4.00e5     # J/mol\n    dH1 = 4.94e5     # J/mol\n    Kc1_ref = 1.0    # mol/m^3\n    \n    # Reaction 2: N2 => 2N\n    A2 = 1.0e5       # s^-1\n    n2 = 1.0\n    Ea2 = 9.40e5     # J/mol\n    dH2 = 9.40e5     # J/mol\n    Kc2_ref = 1.0e-2 # mol/m^3\n    \n    T_ref = 5000.0   # K\n\n    test_cases = [\n        # (p [Pa], T [K], t_res [s], x_O^0, x_N^0)\n        (1.0e5, 5000.0, 1.0e-4, 0.0, 0.0),\n        (1.0e5, 3000.0, 1.0e-3, 0.0, 0.0),\n        (5.0e5, 7000.0, 2.0e-4, 0.0, 0.0),\n        (1.0e5, 6000.0, 1.0e-7, 0.0, 0.0),\n        (1.0e5, 5000.0, 1.0e-4, 0.01, 0.005)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p, T, t_res, x_O_0, x_N_0 = case\n        \n        # Initial mole fractions\n        x0 = np.array([\n            0.21 - x_O_0,  # O2\n            x_O_0,         # O\n            0.79 - x_N_0,  # N2\n            x_N_0          # N\n        ])\n        \n        # --- Pre-computation of constants for the given T ---\n        ctot = p / (Ru * T)\n        \n        # Forward rate constants\n        kf1 = A1 * (T**n1) * np.exp(-Ea1 / (Ru * T))\n        kf2 = A2 * (T**n2) * np.exp(-Ea2 / (Ru * T))\n        \n        # Equilibrium constants\n        Kc1 = Kc1_ref * np.exp((dH1 / Ru) * (1/T_ref - 1/T))\n        Kc2 = Kc2_ref * np.exp((dH2 / Ru) * (1/T_ref - 1/T))\n        \n        # Backward rate constants\n        kb1 = kf1 / Kc1\n        kb2 = kf2 / Kc2\n        \n        # --- Equilibrium Composition Calculation ---\n        c0 = x0 * ctot\n        \n        # Oxygen\n        a_O = c0[1] + 2 * c0[0]\n        b1 = np.sqrt(Kc1)\n        z1_num = -b1 + np.sqrt(b1**2 + 8 * a_O)\n        z1 = z1_num / 4.0\n        c_O2_eq = z1**2\n        c_O_eq = b1 * z1\n        \n        # Nitrogen\n        a_N = c0[3] + 2 * c0[2]\n        b2 = np.sqrt(Kc2)\n        z2_num = -b2 + np.sqrt(b2**2 + 8 * a_N)\n        z2 = z2_num / 4.0\n        c_N2_eq = z2**2\n        c_N_eq = b2 * z2\n        \n        c_eq = np.array([c_O2_eq, c_O_eq, c_N2_eq, c_N_eq])\n        x_eq = c_eq / ctot\n        \n        W_mix_eq = np.sum(x_eq * W)\n        Y_eq = (x_eq * W) / W_mix_eq\n        \n        # --- ODE Integration ---\n        def ode_system(t, x):\n            # x_i must not become negative due to numerical error\n            x = np.maximum(x, 0)\n            x /= np.sum(x)\n            \n            c = x * ctot\n            c_O2, c_O, c_N2, c_N = c\n            \n            # Reaction rates\n            r1 = kf1 * c_O2 - kb1 * c_O**2\n            r2 = kf2 * c_N2 - kb2 * c_N**2\n            \n            # Species production rates\n            omega_O2 = -r1\n            omega_O = 2 * r1\n            omega_N2 = -r2\n            omega_N = 2 * r2\n            \n            omega = np.array([omega_O2, omega_O, omega_N2, omega_N])\n            omega_sum = r1 + r2\n            \n            dxdt = (omega - x * omega_sum) / ctot\n            return dxdt\n            \n        sol = solve_ivp(ode_system, [0, t_res], x0, method='Radau', atol=1e-12, rtol=1e-8)\n        \n        x_res = sol.y[:, -1]\n        \n        # --- Final Deviation Calculation ---\n        W_mix_res = np.sum(x_res * W)\n        Y_res = (x_res * W) / W_mix_res\n        \n        delta = np.sum(np.abs(Y_res - Y_res))\n        results.append(delta)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}