{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any aircraft icing simulation is determining the flux of supercooled water droplets that impinge upon the airframe. This practice guides you through the fundamental process of building a Lagrangian particle tracking model to compute this impingement. By combining a potential flow model for the air velocity field with Newton's laws for particle motion, you will simulate the trajectories of individual droplets and quantify the resulting surface mass flux, which serves as the primary input for subsequent thermodynamic and accretion calculations .",
            "id": "3942688",
            "problem": "You are to implement a two-dimensional particle tracking simulation consistent with aircraft icing analysis at advanced graduate level, beginning from first principles of mechanics and potential flow. The objective is to compute the surface mass flux $m''(s)$ along the leading edge of a NACA $0012$ airfoil approximated locally as a circular cylinder, for an inlet particle size distribution following a lognormal law and a freestream speed $U_\\infty = 70\\,\\mathrm{m/s}$. The output must be expressed in $\\mathrm{kg/(m^2\\,s)}$ and angles must be treated in radians.\n\nModel and assumptions:\n\n- Geometry: Consider a NACA $0012$ with chord $c = 1\\,\\mathrm{m}$ and thickness ratio $t = 0.12$. Approximate the leading edge by a circular cylinder of radius $R = r_{\\mathrm{LE}}$, where $r_{\\mathrm{LE}} = 1.1019\\,t^2\\,c$. Place the cylinder center at the origin in the $xy$-plane. The surface arc length coordinate $s$ is measured from the stagnation point at $\\theta = 0$ (front center) along either upper or lower surface, using $s = R\\,|\\theta|$ for $|\\theta| \\le \\pi/2$.\n\n- Flow field: Assume steady, incompressible, inviscid potential flow around a circular cylinder in uniform freestream. Using complex analysis, the complex potential derivative is $dw/dz = U_\\infty\\left(1 - \\frac{R^2}{z^2}\\right)$ with $z = x + i y$. Interpreting $dw/dz = u - i v$, the local flow velocity is $u(x,y) = \\Re\\left(U_\\infty\\left(1 - \\frac{R^2}{(x+i y)^2}\\right)\\right)$, $v(x,y) = -\\Im\\left(U_\\infty\\left(1 - \\frac{R^2}{(x+i y)^2}\\right)\\right)$.\n\n- Particle dynamics: Model droplets as point particles obeying Newton’s second law with Stokes drag in the air, neglecting gravity, buoyancy, and added mass. For a droplet of diameter $d$, density $\\rho_w$, and dynamic viscosity of air $\\mu$, the relaxation time is $\\tau_p = \\frac{\\rho_w\\,d^2}{18\\,\\mu}$. With local flow velocity components $u(x,y)$ and $v(x,y)$, the particle equations of motion are\n$$\n\\frac{dx}{dt} = v_x,\\quad \\frac{dy}{dt} = v_y,\n$$\n$$\n\\frac{dv_x}{dt} = \\frac{1}{\\tau_p}\\left(u(x,y) - v_x\\right),\\quad \\frac{dv_y}{dt} = \\frac{1}{\\tau_p}\\left(v(x,y) - v_y\\right).\n$$\nA particle is considered to impact the surface when its radial distance $r = \\sqrt{x^2 + y^2}$ satisfies $r \\le R$. The impact location on the cylinder is characterized by $\\theta = \\mathrm{atan2}(y,x)$ and $s = R\\,|\\theta|$. Only impacts on the front half $|\\theta| \\le \\pi/2$ are accumulated.\n\n- Inlet particle size distribution: Assume an inlet lognormal distribution of diameters $d$ with median diameter $d_m$ and geometric standard deviation $\\sigma_g$. That is, $\\ln d \\sim \\mathcal{N}\\left(\\ln d_m,\\, (\\ln \\sigma_g)^2\\right)$. Use Monte Carlo sampling to draw $N_p$ independent droplets per case.\n\n- Liquid water content and mass flux normalization: Let the Liquid Water Content (LWC) be $\\mathrm{kg/m^3}$. Consider an inlet plane at $x = -5R$ spanning $y \\in [-3R, 3R]$ per unit span in the $z$-direction. The physical area of this inlet plane is $A_{\\text{in}} = 6R \\times 1\\,\\mathrm{m^2}$. The total water mass flux crossing the inlet per unit span is $F_{\\text{in}} = \\mathrm{LWC}\\times U_\\infty \\times A_{\\text{in}}$ in $\\mathrm{kg/s}$. For each sampled droplet of diameter $d_i$, assign its physical mass $m_i = \\rho_w \\frac{\\pi}{6} d_i^3$ and define its contribution weight $w_i = (m_i/F_{\\text{tot}}) \\times F_{\\text{in}}$ where $F_{\\text{tot}} = \\sum_{j=1}^{N_p} m_j$. This makes $\\sum_i w_i = F_{\\text{in}}$ and interprets the simulation as representing a unit time.\n\n- Surface mass flux accumulation: Discretize the front half arc length $s \\in [0, R\\,\\pi/2]$ into $M$ equal bins. For each impacting particle, compute the bin index from its $s$ and add its weight $w_i$ to that bin’s tally. The surface mass flux density in bin $k$ is then $m''_k = \\frac{W_k}{\\Delta s}$ where $W_k$ is the sum of weights that impacted in bin $k$ and $\\Delta s = \\frac{R\\,\\pi/2}{M}$ is the bin width. The units are $\\mathrm{kg/(m^2\\,s)}$.\n\nAlgorithmic requirements:\n\n- Use an explicit time-marching scheme with fixed time step for integrating the particle ordinary differential equations above. Initialize each particle at $x_0 = -5R$ with $y_0$ uniformly sampled from $[-3R, 3R]$ and initial velocity $(v_{x0}, v_{y0}) = (U_\\infty, 0)$. Terminate integration for a particle when it impacts ($r \\le R$), exits the computational box ($x \\ge 5R$ or $|y| \\ge 5R$), or exceeds a maximum integration time. Use a robust interpolation if a step crosses the surface to estimate the impact location.\n\n- Angles must be in radians. The final output surface mass flux density must be expressed in $\\mathrm{kg/(m^2\\,s)}$.\n\nTest suite:\n\nImplement your program to run the following three scientifically distinct cases that explore typical aircraft icing regimes:\n\n- Case $1$ (general mixed droplets): $U_\\infty = 70\\,\\mathrm{m/s}$, $c = 1\\,\\mathrm{m}$, $t = 0.12$, $\\rho_w = 1000\\,\\mathrm{kg/m^3}$, $\\mu = 1.8\\times 10^{-5}\\,\\mathrm{kg/(m\\,s)}$, $\\mathrm{LWC} = 5.0\\times 10^{-4}\\,\\mathrm{kg/m^3}$, $d_m = 20\\,\\mu\\mathrm{m}$, $\\sigma_g = 1.5$, $N_p = 2000$, $M = 12$, time step $\\Delta t = 2.0\\times 10^{-5}\\,\\mathrm{s}$, maximum integration time $t_{\\max} = 5.0\\times 10^{-3}\\,\\mathrm{s}$.\n\n- Case $2$ (small droplets near Stokes regime): $U_\\infty = 70\\,\\mathrm{m/s}$, $c = 1\\,\\mathrm{m}$, $t = 0.12$, $\\rho_w = 1000\\,\\mathrm{kg/m^3}$, $\\mu = 1.8\\times 10^{-5}\\,\\mathrm{kg/(m\\,s)}$, $\\mathrm{LWC} = 2.0\\times 10^{-4}\\,\\mathrm{kg/m^3}$, $d_m = 5\\,\\mu\\mathrm{m}$, $\\sigma_g = 1.3$, $N_p = 2000$, $M = 12$, time step $\\Delta t = 2.0\\times 10^{-5}\\,\\mathrm{s}$, maximum integration time $t_{\\max} = 5.0\\times 10^{-3}\\,\\mathrm{s}$.\n\n- Case $3$ (large droplets with higher inertia): $U_\\infty = 70\\,\\mathrm{m/s}$, $c = 1\\,\\mathrm{m}$, $t = 0.12$, $\\rho_w = 1000\\,\\mathrm{kg/m^3}$, $\\mu = 1.8\\times 10^{-5}\\,\\mathrm{kg/(m\\,s)}$, $\\mathrm{LWC} = 1.2\\times 10^{-3}\\,\\mathrm{kg/m^3}$, $d_m = 100\\,\\mu\\mathrm{m}$, $\\sigma_g = 1.8$, $N_p = 2000$, $M = 12$, time step $\\Delta t = 2.0\\times 10^{-5}\\,\\mathrm{s}$, maximum integration time $t_{\\max} = 5.0\\times 10^{-3}\\,\\mathrm{s}$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list of $M$ floats representing $m''(s)$ bin values from $s = 0$ to $s = R\\,\\pi/2$ in $\\mathrm{kg/(m^2\\,s)}$. For example, the printed line must look like $[[m''_1,\\dots,m''_{12}],[m''_1,\\dots,m''_{12}],[m''_1,\\dots,m''_{12}]]$ with no additional text.",
            "solution": "The problem requires the implementation of a two-dimensional Lagrangian particle tracking simulation to compute the surface mass flux of supercooled water droplets impinging on the leading edge of a NACA 0012 airfoil. The airfoil's leading edge is approximated as a circular cylinder. The solution involves a synthesis of potential flow theory, classical mechanics, statistical methods, and numerical integration.\n\n### 1. Geometric and Fluid Dynamic Model\n\nThe initial step is to define the geometry and the surrounding flow field.\n\n**Geometry:** The leading edge of a NACA 0012 airfoil with chord $c = 1\\,\\mathrm{m}$ and thickness ratio $t = 0.12$ is modeled as a circular cylinder. The radius of this cylinder, $R$, is given by the standard empirical relation for the leading edge radius of curvature, $r_{\\mathrm{LE}}$:\n$$\nR = r_{\\mathrm{LE}} = 1.1019\\,t^2\\,c\n$$\nFor $t = 0.12$ and $c = 1\\,\\mathrm{m}$, the radius is:\n$$\nR = 1.1019 \\times (0.12)^2 \\times 1 = 1.1019 \\times 0.0144 \\approx 0.015867\\,\\mathrm{m}\n$$\nThe cylinder is centered at the origin $(0,0)$ of a Cartesian coordinate system. The surface arc length, $s$, is measured from the forward stagnation point $(\\theta=0)$ along the cylinder's surface, defined as $s = R\\,|\\theta|$ for the front-facing portion $|\\theta| \\le \\pi/2$.\n\n**Flow Field:** The airflow around the cylinder is modeled as steady, incompressible, and inviscid potential flow. The velocity field is derived from the complex potential, $w(z)$, where $z = x + iy$. The derivative of the complex potential for uniform flow with speed $U_\\infty$ past a cylinder of radius $R$ is:\n$$\n\\frac{dw}{dz} = U_\\infty\\left(1 - \\frac{R^2}{z^2}\\right)\n$$\nThe local fluid velocity vector $(u, v)$ is related to the complex velocity by $dw/dz = u - iv$. Therefore, we can extract the velocity components:\n$$\nu(x,y) = \\Re\\left(\\frac{dw}{dz}\\right) = \\Re\\left( U_\\infty\\left(1 - \\frac{R^2}{(x+iy)^2}\\right) \\right)\n$$\n$$\nv(x,y) = -\\Im\\left(\\frac{dw}{dz}\\right) = -\\Im\\left( U_\\infty\\left(1 - \\frac{R^2}{(x+iy)^2}\\right) \\right)\n$$\nExpanding the complex term $\\frac{R^2}{z^2} = \\frac{R^2(x-iy)^2}{(x^2+y^2)^2} = \\frac{R^2(x^2 - y^2 - 2ixy)}{(x^2+y^2)^2}$, we obtain the explicit expressions for the velocity components:\n$$\nu(x,y) = U_\\infty \\left(1 - \\frac{R^2(x^2 - y^2)}{(x^2+y^2)^2}\\right)\n$$\n$$\nv(x,y) = -U_\\infty \\frac{2R^2xy}{(x^2+y^2)^2}\n$$\nThese equations define the velocity of the air at any point $(x,y)$ outside the cylinder.\n\n### 2. Particle Dynamics and Statistical Model\n\nThe motion of water droplets within this flow field is governed by Newton's second law, assuming the dominant force is Stokes drag.\n\n**Equation of Motion:** A droplet is treated as a point mass. Forces such as gravity, buoyancy, and added mass are neglected. The equation of motion for a particle with velocity $(\\mathbf{v}_x, \\mathbf{v}_y)$ in a fluid with velocity $(u, v)$ is:\n$$\n\\frac{d\\mathbf{v}_p}{dt} = \\frac{1}{\\tau_p}(\\mathbf{u}_{\\text{fluid}} - \\mathbf{v}_p)\n$$\nHere, $\\tau_p$ is the particle relaxation time, which characterizes the particle's inertial response to changes in the fluid velocity. For a spherical particle of diameter $d$ and density $\\rho_w$ in a fluid with dynamic viscosity $\\mu$, it is defined as:\n$$\n\\tau_p = \\frac{\\rho_w\\,d^2}{18\\,\\mu}\n$$\nThe complete system of first-order ordinary differential equations (ODEs) for the particle's position $(x, y)$ and velocity $(\\mathbf{v}_x, \\mathbf{v}_y)$ is:\n$$\n\\frac{dx}{dt} = \\mathbf{v}_x, \\quad \\frac{dy}{dt} = \\mathbf{v}_y\n$$\n$$\n\\frac{d\\mathbf{v}_x}{dt} = \\frac{1}{\\tau_p}\\left(u(x,y) - \\mathbf{v}_x\\right), \\quad \\frac{d\\mathbf{v}_y}{dt} = \\frac{1}{\\tau_p}\\left(v(x,y) - \\mathbf{v}_y\\right)\n$$\nThe behavior of a particle is largely determined by its inertia, encapsulated by $\\tau_p$. Small droplets (small $\\tau_p$) tend to follow the fluid streamlines, while large droplets (large $\\tau_p$) are less affected by streamline curvature and tend to travel in straighter lines.\n\n**Particle Size Distribution:** The simulation employs a Monte Carlo method where $N_p$ individual particles are tracked. The diameters of these particles are not uniform but are sampled from a lognormal distribution. This distribution is defined by a median diameter $d_m$ and a geometric standard deviation $\\sigma_g$. Specifically, the natural logarithm of the diameter, $\\ln d$, follows a normal distribution with mean $\\mu = \\ln d_m$ and standard deviation $\\sigma = \\ln \\sigma_g$:\n$$\n\\ln d \\sim \\mathcal{N}\\left(\\ln d_m, (\\ln \\sigma_g)^2\\right)\n$$\nFor each of the $N_p$ computational particles, a diameter $d_i$ is drawn from this distribution.\n\n### 3. Numerical Algorithm and Mass Flux Calculation\n\nThe continuous physics model is discretized to enable a numerical solution.\n\n**Particle Trajectory Integration:** The system of ODEs is solved numerically using an explicit time-marching scheme with a fixed time step $\\Delta t$. We use the Explicit Euler method. For a particle at state $(x_n, y_n, v_{x,n}, v_{y,n})$ at time $t_n$:\n1.  Evaluate fluid velocity $u_n = u(x_n, y_n)$ and $v_n = v(x_n, y_n)$.\n2.  Update particle velocity:\n    $v_{x,n+1} = v_{x,n} + \\frac{1}{\\tau_p}(u_n - v_{x,n})\\Delta t$\n    $v_{y,n+1} = v_{y,n} + \\frac{1}{\\tau_p}(v_n - v_{y,n})\\Delta t$\n3.  Update particle position:\n    $x_{n+1} = x_n + v_{x,n}\\Delta t$\n    $y_{n+1} = y_n + v_{y,n}\\Delta t$\nEach particle is initialized at $x_0 = -5R$ with a vertical position $y_0$ sampled uniformly from $[-3R, 3R]$. The initial velocity is set to the freestream velocity, $(v_{x0}, v_{y0}) = (U_\\infty, 0)$. Integration for a particle terminates if it impacts the cylinder, exits the computational domain ($x \\ge 5R$ or $|y| \\ge 5R$), or exceeds the maximum integration time $t_{\\max}$.\n\n**Impact Detection:** An impact occurs when the particle's radial position $r = \\sqrt{x^2+y^2}$ becomes less than or equal to $R$. Since the discrete time step $\\Delta t$ is finite, a particle can jump from a position outside the cylinder, $\\mathbf{p}_n$, to one inside, $\\mathbf{p}_{n+1}$. To find the precise impact location, we interpolate along the straight line segment between these two points. We solve for the parameter $s_{int} \\in [0,1]$ such that the point $\\mathbf{p}_{\\text{impact}} = \\mathbf{p}_n + s_{int}(\\mathbf{p}_{n+1} - \\mathbf{p}_n)$ satisfies $|\\mathbf{p}_{\\text{impact}}|^2 = R^2$. This leads to a quadratic equation for $s_{int}$, from which the correct root is chosen to find the impact coordinates $(x_{impact}, y_{impact})$. The impact angle is then $\\theta_{impact} = \\mathrm{atan2}(y_{impact}, x_{impact})$.\n\n**Mass Flux Calculation:** The simulation with a finite number of particles $N_p$ must be scaled to represent the continuous physical mass flux.\n1.  The physical mass flux entering the domain per unit span is $F_{\\text{in}} = \\mathrm{LWC} \\times U_\\infty \\times A_{\\text{in}}$, where $A_{\\text{in}} = (6R \\times 1\\,\\mathrm{m})$ is the inlet area. Its units are $\\mathrm{kg/s}$.\n2.  For each sampled particle $i$ with diameter $d_i$, its physical mass is $m_i = \\rho_w \\frac{\\pi}{6} d_i^3$.\n3.  The total mass of all $N_p$ sampled particles is $M_{sampled} = \\sum_{j=1}^{N_p} m_j$.\n4.  Each computational particle $i$ is assigned a weight, $w_i$, which represents the mass flow rate it carries:\n    $$\n    w_i = \\frac{m_i}{M_{sampled}} \\times F_{\\text{in}}\n    $$\n    The sum of all weights $\\sum_i w_i$ is equal to the total incoming mass flux $F_{\\text{in}}$.\n5.  The front surface of the cylinder, corresponding to the arc length from $s=0$ to $s=R\\pi/2$, is divided into $M$ equal-sized bins. The width of each bin is $\\Delta s = \\frac{R\\pi/2}{M}$.\n6.  When a particle impacts the front surface ($|\\theta_{impact}| \\le \\pi/2$), its arc length $s_{impact} = R|\\theta_{impact}|$ is calculated. The corresponding bin index is $k = \\lfloor s_{impact} / \\Delta s \\rfloor$. The particle's weight $w_i$ is added to the total weight collected in that bin, $W_k$.\n7.  Finally, the surface mass flux density for each bin $k$ is computed by dividing the collected mass rate by the bin's surface area (per unit span). The area is $\\Delta A_k = \\Delta s \\times 1\\,\\mathrm{m}$.\n    $$\n    m''_k = \\frac{W_k}{\\Delta s} \\quad [\\mathrm{kg/(m^2s)}]\n    $$\nThis procedure yields a histogram of the mass flux distribution along the airfoil's leading edge. The three test cases explore how this distribution changes with different droplet statistics (median diameter and spread), which directly affects particle inertia and therefore the impingement pattern.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to run the aircraft icing simulation for all test cases.\n    \"\"\"\n\n    # Test suite definition\n    test_cases = [\n        # Case 1: General mixed droplets\n        dict(U_inf=70.0, c=1.0, t=0.12, rho_w=1000.0, mu=1.8e-5, lwc=5.0e-4, \n             d_m=20e-6, sigma_g=1.5, N_p=2000, M=12, dt=2.0e-5, t_max=5.0e-3),\n        # Case 2: Small droplets near Stokes regime\n        dict(U_inf=70.0, c=1.0, t=0.12, rho_w=1000.0, mu=1.8e-5, lwc=2.0e-4, \n             d_m=5e-6, sigma_g=1.3, N_p=2000, M=12, dt=2.0e-5, t_max=5.0e-3),\n        # Case 3: Large droplets with higher inertia\n        dict(U_inf=70.0, c=1.0, t=0.12, rho_w=1000.0, mu=1.8e-5, lwc=1.2e-3, \n             d_m=100e-6, sigma_g=1.8, N_p=2000, M=12, dt=2.0e-5, t_max=5.0e-3),\n    ]\n\n    all_results = []\n    \n    # Use a fixed seed for reproducibility of the Monte Carlo simulation\n    np.random.seed(42)\n\n    for params in test_cases:\n        result = run_simulation(**params)\n        all_results.append(result.tolist())\n\n    # Format the final output string exactly as required\n    result_str = \"[\" + \",\".join([str(res) for res in all_results]) + \"]\"\n    print(result_str)\n\ndef get_flow_velocity(x, y, R, U_inf):\n    \"\"\"\n    Calculates potential flow velocity (u, v) around a cylinder.\n    \"\"\"\n    z = complex(x, y)\n    if abs(z)  R:\n        return 0.0, 0.0\n    \n    # dw/dz = u - iv\n    dw_dz = U_inf * (1 - (R**2) / (z**2))\n    return dw_dz.real, -dw_dz.imag\n\ndef track_particle(pos0, vel0, tau_p, params, R):\n    \"\"\"\n    Integrates a single particle's trajectory.\n    \"\"\"\n    pos = np.array(pos0, dtype=float)\n    vel = np.array(vel0, dtype=float)\n    t = 0.0\n\n    while t  params['t_max']:\n        # Check domain exit conditions\n        if pos[0]  5 * R or abs(pos[1])  5 * R:\n            return None\n\n        pos_prev = np.copy(pos)\n        r_prev = np.linalg.norm(pos_prev)\n\n        if r_prev  R: # Particle started inside, should not happen with proper setup\n             return None\n\n        # Get local air velocity\n        u_fluid, v_fluid = get_flow_velocity(pos[0], pos[1], R, params['U_inf'])\n\n        # Update velocity (Explicit Euler)\n        vel[0] += (1.0 / tau_p) * (u_fluid - vel[0]) * params['dt']\n        vel[1] += (1.0 / tau_p) * (v_fluid - vel[1]) * params['dt']\n        \n        # Update position (Explicit Euler)\n        pos[0] += vel[0] * params['dt']\n        pos[1] += vel[1] * params['dt']\n\n        t += params['dt']\n        \n        r_curr = np.linalg.norm(pos)\n\n        # Impact detection\n        if r_curr = R:\n            # Interpolate to find precise impact location\n            p_prev = pos_prev\n            p_curr = pos\n            v_path = p_curr - p_prev\n            \n            a = np.dot(v_path, v_path)\n            b = 2 * np.dot(p_prev, v_path)\n            c = np.dot(p_prev, p_prev) - R**2\n            \n            discriminant = b**2 - 4*a*c\n            if discriminant  0: # Should not happen if path crosses\n                return None\n            \n            s_int = (-b - math.sqrt(discriminant)) / (2 * a)\n            \n            if 0 = s_int  1:\n                impact_pos = p_prev + s_int * v_path\n                theta = math.atan2(impact_pos[1], impact_pos[0])\n                \n                # Consider only front half impacts\n                if abs(theta) = math.pi / 2:\n                    return theta\n            return None # Grazing hit or miss\n\n    return None # Particle timed out or exited\n\n\ndef run_simulation(U_inf, c, t, rho_w, mu, lwc, d_m, sigma_g, N_p, M, dt, t_max):\n    \"\"\"\n    Executes one full simulation case.\n    \"\"\"\n    # 1. Geometry\n    R = 1.1019 * t**2 * c\n\n    # 2. Inlet conditions and mass flux scaling\n    A_in = 6 * R * 1.0  # Inlet area per unit span\n    F_in = lwc * U_inf * A_in\n\n    # 3. Particle Sampling\n    mu_ln_d = math.log(d_m)\n    sigma_ln_d = math.log(sigma_g)\n    diameters = np.random.lognormal(mean=mu_ln_d, sigma=sigma_ln_d, size=N_p)\n    \n    masses = rho_w * (math.pi / 6) * diameters**3\n    M_sampled = np.sum(masses)\n    \n    weights = (masses / M_sampled) * F_in\n    \n    y0_initial = np.random.uniform(-3 * R, 3 * R, N_p)\n\n    # 4. Binning setup\n    W_bins = np.zeros(M)\n    s_max = R * math.pi / 2\n    delta_s = s_max / M\n\n    # 5. Particle tracking loop\n    for i in range(N_p):\n        d_i = diameters[i]\n        tau_p = (rho_w * d_i**2) / (18 * mu)\n        w_i = weights[i]\n        \n        pos0 = [-5 * R, y0_initial[i]]\n        vel0 = [U_inf, 0.0]\n        \n        impact_theta = track_particle(pos0, vel0, tau_p, \n                                      dict(U_inf=U_inf, dt=dt, t_max=t_max), R)\n\n        if impact_theta is not None:\n            s_impact = R * abs(impact_theta)\n            if s_impact  s_max:\n                bin_idx = math.floor(s_impact / delta_s)\n                if 0 = bin_idx  M:\n                    W_bins[bin_idx] += w_i\n\n    # 6. Final mass flux calculation\n    m_double_prime = W_bins / delta_s\n    return m_double_prime\n\nsolve()\n\n```"
        },
        {
            "introduction": "Once water impinges on the surface, its thermal state dictates whether it freezes, runs back, or evaporates. Convective heat transfer from the relatively warm boundary layer to the cold surface is a critical component of this energy balance. This exercise delves into the fluid dynamics of the boundary layer, tasking you with quantifying the sensitivity of the convective heat transfer coefficient to different turbulence models and the augmenting effect of surface roughness, which are crucial for accurately predicting the type and shape of ice accretion .",
            "id": "3942643",
            "problem": "You are to implement a program that quantifies the sensitivity of aircraft icing heat-transfer predictions to turbulence model choice by computing the relative sensitivity function $\\beta(s)$ and the differences in heat transfer coefficient on a rime-roughened surface. The turbulence models to be compared are the Spalart–Allmaras (SA) model and the $k$–$\\omega$ model. The evaluation is to be performed along a surface coordinate $s$ on a locally flat leading-edge segment subject to incompressible external flow.\n\nStart from the base of Newton’s laws and conservation of mass, momentum, and energy for boundary-layer flows, combined with the Reynolds analogy and Chilton–Colburn $j$-factor concept for turbulent convective heat transfer, and use well-tested empirical correlations where closure is necessary. Specifically, use the following definitions and modeling choices:\n\n- The Reynolds number along the curvilinear coordinate is\n$$\n\\mathrm{Re}_s = \\frac{\\rho U_{\\infty} s}{\\mu}.\n$$\n\n- The turbulent skin-friction coefficient correlation representing the Spalart–Allmaras model is\n$$\nC_{f,SA}(s) = 0.0592\\, \\mathrm{Re}_s^{-1/5}.\n$$\n\n- The turbulent skin-friction coefficient correlation representing the $k$–$\\omega$ model is\n$$\nC_{f,KO}(s) = 0.026\\, \\mathrm{Re}_s^{-1/7}.\n$$\n\n- The turbulent boundary-layer thickness for a flat plate is approximated as\n$$\n\\delta(s) = 0.37\\, s\\, \\mathrm{Re}_s^{-1/5}.\n$$\n\n- Rime-induced roughness of equivalent height $k_s$ augments turbulent transport. Model the roughness augmentation multiplicatively by\n$$\n\\Phi_r(s) = \\min\\!\\left(2,\\; \\max\\!\\left(1,\\; 1 + C_r \\left(\\frac{k_s}{\\delta(s)}\\right)^{m}\\right)\\right),\n$$\nwith $C_r = 1.0$ and $m = 0.5$, and apply it equally to skin friction and heat-transfer correlations.\n\n- Using the Chilton–Colburn $j$-factor relation for turbulent flow, the Stanton number is\n$$\nSt(s) = \\frac{C_f(s)}{2}\\, \\mathrm{Pr}^{-2/3},\n$$\nand the convective heat transfer coefficient is\n$$\nh(s) = St(s)\\, \\rho\\, c_p\\, U_{\\infty}.\n$$\n\nHere, $\\rho$ is air density, $U_{\\infty}$ is freestream velocity, $\\mu$ is dynamic viscosity, $\\mathrm{Pr}$ is Prandtl number, and $c_p$ is specific heat at constant pressure. Assume constant properties typical of cold air: $\\rho = 1.225 \\, \\mathrm{kg/m^3}$, $\\mu = 1.75 \\times 10^{-5} \\, \\mathrm{Pa \\cdot s}$, $k_{air} = 0.024 \\, \\mathrm{W/(m \\cdot K)}$, $c_p = 1005 \\, \\mathrm{J/(kg \\cdot K)}$, and $\\mathrm{Pr} = \\mu c_p / k_{air}$.\n\nDefine the sensitivity function to turbulence model choice as\n$$\n\\beta(s) = \\frac{h_{KO}(s) - h_{SA}(s)}{h_{SA}(s)},\n$$\nwhich is dimensionless and measures the relative change in convective heat transfer due to switching from the Spalart–Allmaras closure to the $k$–$\\omega$ closure.\n\nTo avoid singular or non-applicable behavior near the stagnation point, restrict evaluation to\n$$\ns \\in [s_{\\min}, L], \\quad s_{\\min} = \\max\\!\\left(10^{-4} \\, \\mathrm{m},\\; 5 k_s\\right),\n$$\nwith a uniform discretization of $N = 400$ points, where $L$ is the length of the evaluation segment.\n\nFor each test case, compute the following two quantitative outputs:\n1. The maximum absolute sensitivity $\\beta_{\\max} = \\max_{s \\in [s_{\\min}, L]} |\\beta(s)|$, which is dimensionless.\n2. The average heat transfer coefficient difference\n$$\n\\Delta h_{\\mathrm{avg}} = \\frac{1}{L - s_{\\min}} \\int_{s_{\\min}}^{L} \\left[h_{KO}(s) - h_{SA}(s)\\right] \\, ds,\n$$\nexpressed in $\\mathrm{W/(m^2 \\cdot K)}$.\n\nImplement the integral as the arithmetic mean over the uniform discretization of $s$.\n\nYour program must use the above physics and modeling, with the following test suite of parameter sets $(L, U_{\\infty}, k_s)$:\n\n- Test Case $1$ (happy path, moderate rime roughness): $(L = 0.3 \\, \\mathrm{m},\\; U_{\\infty} = 70 \\, \\mathrm{m/s},\\; k_s = 50 \\times 10^{-6} \\, \\mathrm{m})$.\n- Test Case $2$ (smooth surface boundary): $(L = 0.3 \\, \\mathrm{m},\\; U_{\\infty} = 70 \\, \\mathrm{m/s},\\; k_s = 0 \\, \\mathrm{m})$.\n- Test Case $3$ (strong rime roughness effect): $(L = 0.2 \\, \\mathrm{m},\\; U_{\\infty} = 50 \\, \\mathrm{m/s},\\; k_s = 200 \\times 10^{-6} \\, \\mathrm{m})$.\n- Test Case $4$ (lower speed edge case): $(L = 0.2 \\, \\mathrm{m},\\; U_{\\infty} = 30 \\, \\mathrm{m/s},\\; k_s = 50 \\times 10^{-6} \\, \\mathrm{m})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a two-element list $[\\beta_{\\max}, \\Delta h_{\\mathrm{avg}}]$. For example, the output must look like\n$$\n[\\,[\\beta_{\\max}^{(1)}, \\Delta h_{\\mathrm{avg}}^{(1)}],\\,[\\beta_{\\max}^{(2)}, \\Delta h_{\\mathrm{avg}}^{(2)}],\\,[\\beta_{\\max}^{(3)}, \\Delta h_{\\mathrm{avg}}^{(3)}],\\,[\\beta_{\\max}^{(4)}, \\Delta h_{\\mathrm{avg}}^{(4)}]\\,].\n$$\nThe first element of each pair is dimensionless and must be returned as a decimal. The second element must be returned in $\\mathrm{W/(m^2 \\cdot K)}$ as a floating-point number.",
            "solution": "The problem has been validated and is determined to be a well-posed, scientifically grounded problem in the field of aerospace computational fluid dynamics, specifically concerning heat transfer modeling for aircraft icing applications. All provided equations, constants, and test cases are consistent and sufficient for a unique solution.\n\nThe core task is to conduct a sensitivity analysis of the convective heat transfer coefficient, $h$, to the choice of turbulence model. The comparison is between the Spalart-Allmaras (SA) model and the $k$-$\\omega$ (KO) model, represented by distinct empirical correlations for skin friction on a rime-roughened surface.\n\nThe solution methodology proceeds as follows, adhering to the specified physical models and numerical procedures.\n\n**1. Fundamental Principles and Constitutive Relations**\n\nThe analysis is rooted in the principles of turbulent boundary-layer theory and the Reynolds analogy, which connects momentum and heat transfer.\n\n- **Flow and Geometrical Parameters**: For a given freestream velocity $U_{\\infty}$ and surface length $L$, the flow regime at any point $s$ along the surface is characterized by the local Reynolds number:\n$$\n\\mathrm{Re}_s = \\frac{\\rho U_{\\infty} s}{\\mu}\n$$\nwhere $\\rho$ is the air density and $\\mu$ is its dynamic viscosity.\n\n- **Turbulence Models and Skin Friction**: The two turbulence models are represented by distinct power-law correlations for the turbulent skin-friction coefficient, $C_f(s)$:\n    - Spalart-Allmaras (SA): $C_{f,SA}(s) = 0.0592\\, \\mathrm{Re}_s^{-1/5}$\n    - $k$-$\\omega$ (KO): $C_{f,KO}(s) = 0.026\\, \\mathrm{Re}_s^{-1/7}$\n\n- **Heat Transfer Calculation**: The link between skin friction (momentum transfer) and convective heat transfer is established by the Chilton-Colburn $j$-factor analogy. The Stanton number, $St$, is related to the skin-friction coefficient by:\n$$\nSt(s) = \\frac{C_f(s)}{2}\\, \\mathrm{Pr}^{-2/3}\n$$\nHere, $\\mathrm{Pr} = \\frac{\\mu c_p}{k_{air}}$ is the Prandtl number, a dimensionless property of the fluid, with $c_p$ being the specific heat and $k_{air}$ the thermal conductivity. The convective heat transfer coefficient, $h(s)$, is then obtained from the Stanton number:\n$$\nh(s) = St(s)\\, \\rho\\, c_p\\, U_{\\infty}\n$$\n\n- **Roughness Augmentation**: Rime ice accretion creates surface roughness, which enhances turbulent mixing and consequently increases both skin friction and heat transfer. This effect is modeled by a multiplicative augmentation factor, $\\Phi_r(s)$. This factor depends on the ratio of the equivalent sand-grain roughness height, $k_s$, to the turbulent boundary-layer thickness, $\\delta(s)$.\n    - The boundary-layer thickness is estimated using the standard flat-plate correlation:\n    $$\n    \\delta(s) = 0.37\\, s\\, \\mathrm{Re}_s^{-1/5}\n    $$\n    - The augmentation factor is then given by:\n    $$\n    \\Phi_r(s) = \\min\\!\\left(2,\\; \\max\\!\\left(1,\\; 1 + C_r \\left(\\frac{k_s}{\\delta(s)}\\right)^{m}\\right)\\right)\n    $$\n    with empirical constants $C_r = 1.0$ and $m = 0.5$. The $\\min$ and $\\max$ functions ensure the factor is bounded between $1$ (for a smooth surface where $k_s=0$) and $2$ (for a fully rough surface).\n\nThe augmented skin-friction coefficient for each model is $C_{f,aug}(s) = \\Phi_r(s) C_f(s)$. This augmentation directly propagates to the heat transfer coefficient: $h_{aug}(s) = \\Phi_r(s) h_{base}(s)$.\n\n**2. Numerical Evaluation and Sensitivity Metrics**\n\nThe analysis is performed over a discretized surface domain $s \\in [s_{\\min}, L]$, where $s_{\\min} = \\max(10^{-4} \\, \\mathrm{m}, 5 k_s)$ prevents singularities at $s=0$ and applicability issues at very small $s$. The domain is discretized into $N = 400$ uniformly spaced points.\n\nFor each point $s_i$ in the discretization, the following sequence is computed for both SA and KO models:\n$\\mathrm{Re}_{s_i} \\rightarrow \\delta(s_i) \\rightarrow \\Phi_r(s_i) \\rightarrow C_f(s_i) \\rightarrow St(s_i) \\rightarrow h(s_i)$.\n\nTwo final metrics quantify the sensitivity:\n\n- **Maximum Absolute Sensitivity, $\\beta_{\\max}$**: This metric measures the peak relative difference in heat transfer prediction. The sensitivity function is defined as:\n$$\n\\beta(s) = \\frac{h_{KO}(s) - h_{SA}(s)}{h_{SA}(s)}\n$$\nSubstituting the expressions for $h(s)$ reveals that many terms cancel, including the roughness factor $\\Phi_r(s)$:\n$$\n\\beta(s) = \\frac{C_{f,KO}(s)}{C_{f,SA}(s)} - 1 = \\frac{0.026\\, \\mathrm{Re}_s^{-1/7}}{0.0592\\, \\mathrm{Re}_s^{-1/5}} - 1 = \\frac{0.026}{0.0592} \\mathrm{Re}_s^{2/35} - 1\n$$\nThis shows that the relative sensitivity $\\beta(s)$ is independent of surface roughness. The maximum absolute sensitivity is then computed over the discretized domain:\n$$\n\\beta_{\\max} = \\max_{i} |\\beta(s_i)|\n$$\n\n- **Average Heat Transfer Coefficient Difference, $\\Delta h_{\\mathrm{avg}}$**: This metric measures the average absolute difference in heat transfer over the surface. It is defined by the integral:\n$$\n\\Delta h_{\\mathrm{avg}} = \\frac{1}{L - s_{\\min}} \\int_{s_{\\min}}^{L} \\left[h_{KO}(s) - h_{SA}(s)\\right] \\, ds\n$$\nThe problem specifies that this is to be implemented by computing the arithmetic mean of the integrand over the $N=400$ discrete points:\n$$\n\\Delta h_{\\mathrm{avg}} \\approx \\frac{1}{N} \\sum_{i=1}^{N} \\left[h_{KO}(s_i) - h_{SA}(s_i)\\right]\n$$\nUnlike $\\beta(s)$, the difference $h_{KO}(s) - h_{SA}(s)$ explicitly depends on the roughness augmentation factor $\\Phi_r(s)$.\n\nThe overall algorithm consists of iterating through each test case, performing these calculations, and compiling the results. All physical constants are givenfixed values: $\\rho = 1.225 \\, \\mathrm{kg/m^3}$, $\\mu = 1.75 \\times 10^{-5} \\, \\mathrm{Pa \\cdot s}$, $k_{air} = 0.024 \\, \\mathrm{W/(m \\cdot K)}$, and $c_p = 1005 \\, \\mathrm{J/(kg \\cdot K)}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes sensitivity of aircraft icing heat-transfer predictions to turbulence model choice.\n    \"\"\"\n\n    # Define physical constants\n    rho = 1.225      # Air density [kg/m^3]\n    mu = 1.75e-5     # Dynamic viscosity [Pa*s]\n    k_air = 0.024    # Thermal conductivity of air [W/(m*K)]\n    c_p = 1005       # Specific heat at constant pressure [J/(kg*K)]\n\n    # Roughness model parameters\n    C_r = 1.0\n    m = 0.5\n\n    # Numerical parameters\n    N = 400\n\n    # Calculate Prandtl number\n    Pr = mu * c_p / k_air\n\n    test_cases = [\n        # (L [m], U_inf [m/s], k_s [m])\n        (0.3, 70, 50e-6),   # Test Case 1\n        (0.3, 70, 0),       # Test Case 2\n        (0.2, 50, 200e-6),  # Test Case 3\n        (0.2, 30, 50e-6)    # Test Case 4\n    ]\n\n    results = []\n    for L, U_inf, k_s in test_cases:\n        # Step 1: Define the evaluation domain\n        s_min = np.maximum(1e-4, 5 * k_s)\n        s = np.linspace(s_min, L, N)\n\n        # Step 2: Calculate s-dependent quantities\n        Re_s = rho * U_inf * s / mu\n        \n        # Handle cases where Re_s might be zero or negative to avoid warnings, though domain prevents this.\n        Re_s[Re_s = 0] = 1e-12\n\n        # Step 3: Calculate base skin-friction coefficients\n        Cf_SA_base = 0.0592 * np.power(Re_s, -1/5)\n        Cf_KO_base = 0.026 * np.power(Re_s, -1/7)\n\n        # Step 4: Calculate roughness augmentation factor\n        # Boundary layer thickness\n        delta = 0.37 * s * np.power(Re_s, -1/5)\n        delta[delta = 0] = 1e-12 # Avoid division by zero if s_min could be 0\n\n        if k_s  0:\n            roughness_ratio = k_s / delta\n            Phi_r = 1.0 + C_r * np.power(roughness_ratio, m)\n            Phi_r = np.clip(Phi_r, 1.0, 2.0)\n        else:\n            Phi_r = np.ones_like(s)\n\n        # Step 5: Calculate augmented heat transfer coefficients\n        # Common factor for h(s) calculation\n        h_factor = rho * c_p * U_inf * (np.power(Pr, -2/3) / 2.0)\n\n        # Spalart-Allmaras\n        Cf_SA_aug = Phi_r * Cf_SA_base\n        St_SA = Cf_SA_aug / 2.0 * np.power(Pr, -2/3)\n        h_SA = St_SA * rho * c_p * U_inf\n        \n        # k-omega\n        Cf_KO_aug = Phi_r * Cf_KO_base\n        St_KO = Cf_KO_aug / 2.0 * np.power(Pr, -2/3)\n        h_KO = St_KO * rho * c_p * U_inf\n\n        # Step 6: Compute sensitivity metrics\n        \n        # Metric 1: Maximum absolute sensitivity beta_max\n        # beta is independent of roughness factor Phi_r\n        beta = (Cf_KO_base / Cf_SA_base) - 1\n        beta_max = np.max(np.abs(beta))\n\n        # Metric 2: Average heat transfer coefficient difference delta_h_avg\n        h_diff = h_KO - h_SA\n        delta_h_avg = np.mean(h_diff)\n\n        results.append([beta_max, delta_h_avg])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice integrates the preceding concepts to simulate the end product: the evolution of the ice shape itself. Using simplified yet physically representative models for mass impingement, surface runoff, and freezing fraction, you will compute the ice thickness distribution along an airfoil. This exercise provides a tangible outcome, demonstrating how the interplay of aerodynamics and thermodynamics leads to the formation of complex and potentially hazardous ice shapes, such as the characteristic 'horns' in glaze icing conditions .",
            "id": "3942669",
            "problem": "A two-dimensional glaze icing event is modeled on the upper surface of a smooth airfoil using a simplified physically-based accretion model appropriate for Computational Fluid Dynamics (CFD) post-processing. Let $s$ denote the surface arc-length coordinate (in $\\mathrm{m}$) measured from the leading-edge stagnation point along the upper surface. The impinging water field is described by a known impingement efficiency distribution $\\beta(s)$ that maps the free-stream volumetric liquid water into local surface mass flux. The free-stream liquid water content (LWC) is uniform in space and constant in time. The free-stream speed is $U_{\\infty}$ (in $\\mathrm{m/s}$), the accretion duration is $t$ (in $\\mathrm{s}$), the ice density is $\\rho_{i}$ (in $\\mathrm{kg/m^3}$), and the glaze growth is taken to be normal to the surface. A local runoff fraction $r(s)$ (dimensionless) removes a portion of the impinging water immediately; the remaining portion may freeze with a position-dependent freezing propensity $\\phi(s)$ (dimensionless). Assume that the aerodynamic impingement efficiency $\\beta(s)$, the freezing propensity $\\phi(s)$, and the runoff fraction $r(s)$ are time-independent and do not change with the evolving ice shape over the specified duration. Neglect all heat transfer feedbacks, curvature effects, and film advection; specifically, treat the freezing as an instantaneous local sink on the retained liquid water fraction and assume the accretion is dilute enough that $\\beta(s)$ remains fixed. Take the ice thickness to grow purely by local mass conservation of frozen water under constant density.\n\nStarting only from conservation of mass of liquid water and the definition of liquid water content as mass per unit air volume, derive the expression for the local normal ice thickness growth rate $dh/dt$ as a function of $s$ in terms of the given quantities $\\beta(s)$, \\text{LWC}, $U_{\\infty}$, $r(s)$, $\\phi(s)$, and $\\rho_i$. Then, integrate in time for constant coefficients to obtain $h(s)$ after time $t$. Based on this $h(s)$, define the “horn height” as the maximum $h(s)$ along the $s$-domain and the “horn location” as the smallest $s$ at which this maximum occurs. Your program must compute and report, for several specified cases, the horn height in $\\mathrm{mm}$ and the horn location in $\\mathrm{m}$.\n\nFor numerical reproducibility, discretize the interval $s \\in [0,S_{\\max}]$ uniformly with exactly $N=1001$ points (including endpoints). For each case, compute $h(s)$, determine the maximum horn height and its location as defined above, convert the height to $\\mathrm{mm}$, and round both the horn height (in $\\mathrm{mm}$) and the horn location (in $\\mathrm{m}$) to exactly $6$ decimal places. If $h(s) \\equiv 0$ over the domain, define the horn height to be $0.0$ and the horn location to be $0.0$.\n\nUse the following parameterized functional forms, with parameters specified per case:\n- $\\beta(s) = \\beta_{0}\\,\\exp\\!\\left(-\\left(\\dfrac{s}{\\sigma}\\right)^{2}\\right)$,\n- $\\phi(s) = \\phi_{\\min} + \\left(\\phi_{\\max}-\\phi_{\\min}\\right)\\left(1-\\exp\\!\\left(-\\dfrac{s}{\\lambda_{\\phi}}\\right)\\right)$,\n- $r(s) = r_{0}\\,\\exp\\!\\left(-\\dfrac{s}{\\lambda_{r}}\\right)$.\n\nPhysically constrain the fields to the interval $[0,1]$ by clamping if necessary. Use $\\rho_{i} = 917\\,\\mathrm{kg/m^3}$ and $t = 600\\,\\mathrm{s}$ for all cases.\n\nImplement the program to evaluate the following test suite of four cases. For each case, all unspecified quantities are as defined globally above, and all units are $\\mathrm{SI}$:\n- Case 1 (baseline glaze):\n  - $S_{\\max} = 0.25$, $U_{\\infty} = 70$, $\\mathrm{LWC} = 0.0005$,\n  - $\\beta_{0} = 0.8$, $\\sigma = 0.02$,\n  - $\\phi_{\\min} = 0.1$, $\\phi_{\\max} = 0.6$, $\\lambda_{\\phi} = 0.05$,\n  - $r_{0} = 0.4$, $\\lambda_{r} = 0.03$.\n- Case 2 (more severe icing):\n  - $S_{\\max} = 0.35$, $U_{\\infty} = 120$, $\\mathrm{LWC} = 0.0012$,\n  - $\\beta_{0} = 0.9$, $\\sigma = 0.03$,\n  - $\\phi_{\\min} = 0.05$, $\\phi_{\\max} = 0.5$, $\\lambda_{\\phi} = 0.08$,\n  - $r_{0} = 0.5$, $\\lambda_{r} = 0.02$.\n- Case 3 (no accretion edge case):\n  - $S_{\\max} = 0.30$, $U_{\\infty} = 80$, $\\mathrm{LWC} = 0.0$,\n  - $\\beta_{0} = 0.85$, $\\sigma = 0.02$,\n  - $\\phi_{\\min} = 0.1$, $\\phi_{\\max} = 0.7$, $\\lambda_{\\phi} = 0.07$,\n  - $r_{0} = 0.3$, $\\lambda_{r} = 0.03$.\n- Case 4 (wet-to-dry transition near the nose):\n  - $S_{\\max} = 0.20$, $U_{\\infty} = 90$, $\\mathrm{LWC} = 0.0008$,\n  - $\\beta_{0} = 0.7$, $\\sigma = 0.015$,\n  - $\\phi_{\\min} = 0.2$, $\\phi_{\\max} = 0.8$, $\\lambda_{\\phi} = 0.02$,\n  - $r_{0} = 0.6$, $\\lambda_{r} = 0.01$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case’s result is a two-element list $[h_{\\max,\\mathrm{mm}}, s_{\\mathrm{loc}}]$ with both entries rounded to $6$ decimal places. For example, a valid output format for four cases is of the form\n\"[[h1,s1],[h2,s2],[h3,s3],[h4,s4]]\"\nwith $h1$, $s1$, $h2$, $s2$, $h3$, $s3$, $h4$, $s4$ being decimal numbers without units. The horn height must be expressed in $\\mathrm{mm}$ and the horn location in $\\mathrm{m}$.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n\n**Variables and Concepts:**\n-   $s$: surface arc-length coordinate ($\\mathrm{m}$) from the leading-edge stagnation point.\n-   $\\beta(s)$: impingement efficiency distribution (dimensionless).\n-   $\\text{LWC}$: free-stream liquid water content ($\\mathrm{kg/m^3}$).\n-   $U_{\\infty}$: free-stream speed ($\\mathrm{m/s}$).\n-   $t$: accretion duration ($\\mathrm{s}$).\n-   $\\rho_{i}$: ice density ($\\mathrm{kg/m^3}$).\n-   Growth direction: normal to the surface.\n-   $r(s)$: local runoff fraction (dimensionless).\n-   $\\phi(s)$: position-dependent freezing propensity (dimensionless).\n-   $h(s)$: local normal ice thickness ($\\mathrm{m}$).\n-   $dh/dt$: local normal ice thickness growth rate ($\\mathrm{m/s}$).\n-   Horn Height: maximum $h(s)$ along the $s$-domain ($\\mathrm{mm}$).\n-   Horn Location: smallest $s$ at which the maximum height occurs ($\\mathrm{m}$).\n\n**Assumptions and Constraints:**\n-   The model is for a two-dimensional glaze icing event on a smooth airfoil's upper surface.\n-   LWC is uniform and constant.\n-   $\\beta(s)$, $\\phi(s)$, and $r(s)$ are time-independent.\n-   Neglect heat transfer feedbacks, curvature effects, and film advection.\n-   Freezing is an instantaneous local sink on the retained liquid water.\n-   Accretion is dilute enough that $\\beta(s)$ remains fixed.\n-   Ice growth is by local mass conservation under constant density.\n-   The fields $\\beta(s)$, $\\phi(s)$, $r(s)$ must be physically constrained to the interval $[0,1]$ by clamping.\n\n**Numerical Specifications:**\n-   Discretization: interval $s \\in [0,S_{\\max}]$ is discretized uniformly with $N=1001$ points.\n-   Global Constants: $\\rho_{i} = 917\\,\\mathrm{kg/m^{3}}$, $t = 600\\,\\mathrm{s}$.\n-   Output Precision: Horn height (in $\\mathrm{mm}$) and horn location (in $\\mathrm{m}$) must be rounded to $6$ decimal places.\n-   Edge Case: If $h(s) \\equiv 0$, horn height is $0.0\\,\\mathrm{mm}$ and location is $0.0\\,\\mathrm{m}$.\n\n**Functional Forms:**\n-   $\\beta(s) = \\beta_{0}\\,\\exp\\!\\left(-\\left(\\dfrac{s}{\\sigma}\\right)^{2}\\right)$\n-   $\\phi(s) = \\phi_{\\min} + \\left(\\phi_{\\max}-\\phi_{\\min}\\right)\\left(1-\\exp\\!\\left(-\\dfrac{s}{\\lambda_{\\phi}}\\right)\\right)$\n-   $r(s) = r_{0}\\,\\exp\\!\\left(-\\dfrac{s}{\\lambda_{r}}\\right)$\n\n**Test Cases:**\n-   Case 1: $S_{\\max} = 0.25$, $U_{\\infty} = 70$, $\\text{LWC} = 0.0005$, $\\beta_{0} = 0.8$, $\\sigma = 0.02$, $\\phi_{\\min} = 0.1$, $\\phi_{\\max} = 0.6$, $\\lambda_{\\phi} = 0.05$, $r_{0} = 0.4$, $\\lambda_{r} = 0.03$.\n-   Case 2: $S_{\\max} = 0.35$, $U_{\\infty} = 120$, $\\text{LWC} = 0.0012$, $\\beta_{0} = 0.9$, $\\sigma = 0.03$, $\\phi_{\\min} = 0.05$, $\\phi_{\\max} = 0.5$, $\\lambda_{\\phi} = 0.08$, $r_{0} = 0.5$, $\\lambda_{r} = 0.02$.\n-   Case 3: $S_{\\max} = 0.30$, $U_{\\infty} = 80$, $\\text{LWC} = 0.0$, $\\beta_{0} = 0.85$, $\\sigma = 0.02$, $\\phi_{\\min} = 0.1$, $\\phi_{\\max} = 0.7$, $\\lambda_{\\phi} = 0.07$, $r_{0} = 0.3$, $\\lambda_{r} = 0.03$.\n-   Case 4: $S_{\\max} = 0.20$, $U_{\\infty} = 90$, $\\text{LWC} = 0.0008$, $\\beta_{0} = 0.7$, $\\sigma = 0.015$, $\\phi_{\\min} = 0.2$, $\\phi_{\\max} = 0.8$, $\\lambda_{\\phi} = 0.02$, $r_{0} = 0.6$, $\\lambda_{r} = 0.01$.\n\n#### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded:** The problem describes a simplified aircraft icing accretion model based on mass conservation, a fundamental physical principle. The concepts of liquid water content ($\\text{LWC}$), impingement efficiency ($\\beta$), runoff fraction ($r$), and freezing propensity ($\\phi$) are standard in the field of aircraft icing analysis. The explicit simplifying assumptions (e.g., time-independent coefficients, no thermodynamic feedback) are scientifically acceptable for creating a tractable, first-order model. The problem is free of pseudoscience.\n-   **Well-Posed:** All necessary parameters, functional forms, constants, and boundary conditions (via the $S_{\\max}$ domain) are provided for each case. The definitions of \"horn height\" and \"horn location\" are unambiguous. A unique, stable, and meaningful solution exists for the given inputs.\n-   **Objective:** The problem is stated in precise, quantitative, and unbiased technical language. It defines all non-standard terms and provides clear instructions for calculation and output formatting.\n\n#### Step 3: Verdict and Action\n\nThe problem is **valid**. It is scientifically grounded, well-posed, and objective. A solution can be derived and implemented.\n\n### Derivation and Solution Methodology\n\nThe derivation begins from the principle of conservation of mass for the liquid water accreting on the airfoil surface.\n\n1.  **Mass Flux of Water in the Freestream:** The Liquid Water Content, $\\text{LWC}$, is defined as the mass of water per unit volume of air. An air parcel moving at the freestream velocity $U_{\\infty}$ transports water. The mass of water crossing a unit area ($1\\,\\mathrm{m^2}$) normal to the flow per unit time is the freestream mass flux, $\\dot{m}''_{\\text{stream}}$:\n    $$\n    \\dot{m}''_{\\text{stream}} = \\text{LWC} \\cdot U_{\\infty}\n    $$\n    The units are $(\\mathrm{kg/m^3}) \\cdot (\\mathrm{m/s}) = \\mathrm{kg/(s \\cdot m^2)}$, which is correctly a mass flux.\n\n2.  **Impinging Mass Flux:** The local impingement efficiency, $\\beta(s)$, is the fraction of the freestream water that strikes the surface at arc-length coordinate $s$. The local mass flux of impinging water, $\\dot{m}''_{\\text{impinge}}(s)$, is therefore:\n    $$\n    \\dot{m}''_{\\text{impinge}}(s) = \\beta(s) \\cdot \\dot{m}''_{\\text{stream}} = \\beta(s) \\cdot \\text{LWC} \\cdot U_{\\infty}\n    $$\n\n3.  **Retained Mass Flux:** A portion of the impinging water, given by the runoff fraction $r(s)$, is immediately removed and does not participate in the freezing process. The fraction of water that remains on the surface is $(1 - r(s))$. The mass flux of this retained water, $\\dot{m}''_{\\text{retained}}(s)$, is:\n    $$\n    \\dot{m}''_{\\text{retained}}(s) = (1 - r(s)) \\cdot \\dot{m}''_{\\text{impinge}}(s) = (1 - r(s)) \\cdot \\beta(s) \\cdot \\text{LWC} \\cdot U_{\\infty}\n    $$\n\n4.  **Freezing Mass Flux:** The freezing propensity, $\\phi(s)$, is the fraction of the *retained* water that freezes into ice. The mass flux of water turning into solid ice, $\\dot{m}''_{\\text{ice}}(s)$, is:\n    $$\n    \\dot{m}''_{\\text{ice}}(s) = \\phi(s) \\cdot \\dot{m}''_{\\text{retained}}(s) = \\phi(s) \\cdot (1 - r(s)) \\cdot \\beta(s) \\cdot \\text{LWC} \\cdot U_{\\infty}\n    $$\n\n5.  **Ice Thickness Growth Rate:** The problem states that ice grows normal to the surface with a thickness $h(s)$ and constant density $\\rho_i$. The accumulation of ice mass per unit area per unit time must equal the freezing mass flux. For a differential thickness $dh$ added over a time $dt$, the mass added per unit area is $\\rho_i \\cdot dh$. The rate of mass addition per unit area is thus $\\rho_i \\cdot (dh/dt)$. Equating this with the freezing mass flux gives the local ice thickness growth rate:\n    $$\n    \\rho_i \\frac{dh}{dt}(s) = \\dot{m}''_{\\text{ice}}(s)\n    $$\n    Solving for the growth rate $\\frac{dh}{dt}(s)$:\n    $$\n    \\frac{dh}{dt}(s) = \\frac{1}{\\rho_i} \\dot{m}''_{\\text{ice}}(s) = \\frac{\\text{LWC} \\cdot U_{\\infty}}{\\rho_i} \\cdot \\beta(s) \\cdot (1 - r(s)) \\cdot \\phi(s)\n    $$\n\n6.  **Total Ice Thickness:** The problem specifies that all coefficients are constant over the accretion duration $t$. To find the total ice thickness $h(s)$ after time $t$, we integrate the growth rate from time $0$ to $t$:\n    $$\n    h(s) = \\int_{0}^{t} \\frac{dh}{dt}(s) \\,d\\tau = \\frac{dh}{dt}(s) \\cdot t\n    $$\n    Substituting the expression for the growth rate, we obtain the final expression for the local ice thickness:\n    $$\n    h(s) = \\frac{\\text{LWC} \\cdot U_{\\infty} \\cdot t}{\\rho_i} \\cdot \\beta(s) \\cdot (1 - r(s)) \\cdot \\phi(s)\n    $$\n\n7.  **Numerical Implementation:**\n    -   The surface arc-length domain $s \\in [0, S_{\\max}]$ is discretized into $N=1001$ equally spaced points.\n    -   For each point $s_j$ in the discretized domain, the functions $\\beta(s_j)$, $\\phi(s_j)$, and $r(s_j)$ are calculated using the given parametric formulas.\n    -   As per the problem statement, the computed values of these three functions are clamped to the physical range $[0, 1]$.\n    -   The ice thickness $h(s_j)$ is computed for all points using the derived formula.\n    -   The \"horn height\" is the maximum value in the resulting $h(s)$ array. This value, originally in meters, is converted to millimeters by multiplying by $1000$.\n    -   The \"horn location\" is the smallest value of $s$ where this maximum occurs. This is found by determining the index of the first occurrence of the maximum value in the $h(s)$ array and retrieving the corresponding value from the $s$ array.\n    -   For the case where $h(s) \\equiv 0$ (e.g., if $\\text{LWC}=0$), the horn height and location are both defined as $0.0$.\n    -   Both the final horn height (in $\\mathrm{mm}$) and horn location (in $\\mathrm{m}$) are rounded to $6$ decimal places.",
            "answer": "```python\nimport numpy as np\n# from scipy import ... # Scipy is not required for this problem.\n\ndef solve():\n    \"\"\"\n    Solves the aircraft icing accretion problem for a suite of test cases.\n    \"\"\"\n    # Global constants as defined in the problem\n    RHO_ICE = 917.0  # Ice density in kg/m^3\n    T_ACCRETION = 600.0  # Accretion duration in s\n    N_POINTS = 1001  # Number of discretization points\n\n    test_cases = [\n        # Case 1 (baseline glaze)\n        {\n            \"S_max\": 0.25, \"U_inf\": 70.0, \"LWC\": 0.0005,\n            \"beta_0\": 0.8, \"sigma\": 0.02,\n            \"phi_min\": 0.1, \"phi_max\": 0.6, \"lambda_phi\": 0.05,\n            \"r_0\": 0.4, \"lambda_r\": 0.03,\n        },\n        # Case 2 (more severe icing)\n        {\n            \"S_max\": 0.35, \"U_inf\": 120.0, \"LWC\": 0.0012,\n            \"beta_0\": 0.9, \"sigma\": 0.03,\n            \"phi_min\": 0.05, \"phi_max\": 0.5, \"lambda_phi\": 0.08,\n            \"r_0\": 0.5, \"lambda_r\": 0.02,\n        },\n        # Case 3 (no accretion edge case)\n        {\n            \"S_max\": 0.30, \"U_inf\": 80.0, \"LWC\": 0.0,\n            \"beta_0\": 0.85, \"sigma\": 0.02,\n            \"phi_min\": 0.1, \"phi_max\": 0.7, \"lambda_phi\": 0.07,\n            \"r_0\": 0.3, \"lambda_r\": 0.03,\n        },\n        # Case 4 (wet-to-dry transition near the nose)\n        {\n            \"S_max\": 0.20, \"U_inf\": 90.0, \"LWC\": 0.0008,\n            \"beta_0\": 0.7, \"sigma\": 0.015,\n            \"phi_min\": 0.2, \"phi_max\": 0.8, \"lambda_phi\": 0.02,\n            \"r_0\": 0.6, \"lambda_r\": 0.01,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Discretize the arc-length domain\n        s = np.linspace(0, case[\"S_max\"], N_POINTS)\n\n        # Calculate impingement efficiency beta(s)\n        beta_s = case[\"beta_0\"] * np.exp(-((s / case[\"sigma\"]) ** 2))\n        beta_s = np.clip(beta_s, 0, 1) # Clamp to [0, 1]\n\n        # Calculate freezing propensity phi(s)\n        phi_s = case[\"phi_min\"] + (case[\"phi_max\"] - case[\"phi_min\"]) * \\\n                (1 - np.exp(-s / case[\"lambda_phi\"]))\n        phi_s = np.clip(phi_s, 0, 1) # Clamp to [0, 1]\n\n        # Calculate runoff fraction r(s)\n        r_s = case[\"r_0\"] * np.exp(-s / case[\"lambda_r\"])\n        r_s = np.clip(r_s, 0, 1) # Clamp to [0, 1]\n\n        # Calculate local ice thickness h(s) in meters\n        # h(s) = (LWC * U_inf * t / rho_i) * beta(s) * (1-r(s)) * phi(s)\n        prefactor = (case[\"LWC\"] * case[\"U_inf\"] * T_ACCRETION) / RHO_ICE\n        h_s_m = prefactor * beta_s * (1 - r_s) * phi_s\n\n        # Find horn height and location\n        h_max_m = np.max(h_s_m)\n\n        if h_max_m == 0.0:\n            s_loc_m = 0.0\n        else:\n            # np.argmax() returns the index of the first occurrence of the maximum\n            s_loc_m = s[np.argmax(h_s_m)]\n        \n        # Convert horn height to mm\n        h_max_mm = h_max_m * 1000.0\n\n        # Round to 6 decimal places as required\n        final_h_mm = round(h_max_mm, 6)\n        final_s_m = round(s_loc_m, 6)\n        \n        results.append([final_h_mm, final_s_m])\n\n    # Format output as specified: [[h1,s1],[h2,s2],...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}