{
    "hands_on_practices": [
        {
            "introduction": "本章节的实践练习旨在将共轭传热的理论知识应用于实际问题求解。我们从一个基本但至关重要的一维稳态问题开始。该练习要求您推导固体和流体交界面上的温度，这需要您在界面处耦合傅里叶热传导定律和牛顿冷却定律，通过建立能量守恒方程来解决问题。掌握这种基本的耦合方法是所有更复杂的CHT分析的基础。",
            "id": "3949553",
            "problem": "考虑一个在计算流体力学 (CFD) 中建模的一维稳态共轭传热问题，该问题代表了外部空气动力学热效应。一块厚度为 $L$、导热系数为 $k$ 的扁平均匀隔热瓦，其内表面被冷却，外表面暴露于高焓外部气流中。$x$ 坐标定义为垂直于瓦片的方向，冷却的内表面处为 $x=0$，固体与流体交界的外表面处为 $x=L$。内表面通过内部冷却系统保持在均匀温度 $T_{b}$。外部气流的特征是相对于外表面的均匀传热系数 $h$ 和自由流温度 $T_{\\infty}$。假设材料属性恒定，热传导严格为一维，无内部体积热生成，且辐射交换和接触热阻可忽略不计。流动侧的壁面传热可以很好地由 Newton 冷却定律描述。\n\n从 Fourier 热传导定律和 Newton 冷却定律出发，并根据固-流界面的能量守恒，推导在 $x=L$ 处的界面温度 $T_{s}$ 的解析表达式，然后用以下参数计算其值：$L = 3.0 \\times 10^{-3}\\ \\text{m}$，$k = 22\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$，$T_{b} = 900\\ \\text{K}$，$h = 1.8 \\times 10^{3}\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$，以及 $T_{\\infty} = 1600\\ \\text{K}$。以开尔文表示最终界面温度，并将答案四舍五入到四位有效数字。最终答案必须是一个实数。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、适定且客观。\n\n### 步骤1：提取已知条件\n-   瓦片厚度：$L = 3.0 \\times 10^{-3}\\ \\text{m}$\n-   导热系数：$k = 22\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$\n-   坐标系：内表面处为 $x=0$，外表面处为 $x=L$。\n-   内表面温度：$T(x=0) = T_{b} = 900\\ \\text{K}$\n-   传热系数：$h = 1.8 \\times 10^{3}\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n-   自由流温度：$T_{\\infty} = 1600\\ \\text{K}$\n-   假设：\n    1.  一维 (1D) 稳态传热。\n    2.  材料均匀且属性恒定。\n    3.  无内部体积热生成。\n    4.  辐射和接触热阻可忽略不计。\n-   控制定律：Fourier 热传导定律和 Newton 冷却定律。\n-   要求：推导在 $x=L$ 处的界面温度 $T_s$ 的表达式并计算其值。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题是传热基本原理（Fourier 定律、Newton 冷却定律、能量守恒）的经典应用。航空航天应用中的共轭传热背景在物理上是现实的，也是工程学中的一个标准课题。\n-   **适定性：** 该问题提供了一个二阶常微分方程（由稳态下的 Fourier 定律得出）和两个边界条件（在 $x=0$ 处的 Dirichlet 条件和在 $x=L$ 处的 Robin 条件）。这个设置足以得到唯一且稳定的解。所有必要的参数均已提供。\n-   **客观性：** 问题陈述使用了精确、定量的语言，没有主观性或模糊性。\n\n### 步骤3：结论与行动\n问题被认为是**有效**的。将进行求解。\n\n在导热系数 $k$ 恒定的均匀材料中，无内部热生成的一维稳态热传导的控制方程由 Fourier 定律推导得出。其微分形式的热方程简化为：\n$$ \\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) = 0 $$\n由于 $k$ 是常数，方程进一步简化为：\n$$ \\frac{d^2T}{dx^2} = 0 $$\n对该方程关于 $x$ 积分两次，得到温度分布 $T(x)$ 的通解：\n$$ \\frac{dT}{dx} = C_1 $$\n$$ T(x) = C_1 x + C_2 $$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的积分常数。\n\n第一个边界条件在内表面 $x=0$ 处，温度保持在恒定值 $T_b$：\n$$ T(0) = T_b $$\n将此条件应用于通解：\n$$ T(0) = C_1(0) + C_2 = T_b \\implies C_2 = T_b $$\n因此，温度分布为：\n$$ T(x) = C_1 x + T_b $$\n\n第二个边界条件在固-流界面 $x=L$ 处。在这里，能量守恒原理要求从固体内部传导至表面的热通量必须等于从表面对流到流体中的热通量。\n\n在 $x=L$ 处的传导热通量 $q''_{cond}$ 由 Fourier 定律给出：\n$$ q''_{cond} = -k \\left. \\frac{dT}{dx} \\right|_{x=L} $$\n根据我们的温度分布，$\\frac{dT}{dx} = C_1$，因此传导热通量在整个固体中是恒定的：\n$$ q''_{cond} = -k C_1 $$\n从温度为 $T_s = T(L)$ 的表面到温度为 $T_{\\infty}$ 的流体中的对流热通量 $q''_{conv}$ 由 Newton 冷却定律给出：\n$$ q''_{conv} = h (T_s - T_{\\infty}) $$\n令界面处的通量相等 ($q''_{cond} = q''_{conv}$):\n$$ -k C_1 = h (T_s - T_{\\infty}) $$\n我们有两个未知数，$C_1$ 和 $T_s$。我们可以使用在 $x=L$ 处的温度分布方程将它们联系起来：\n$$ T_s = T(L) = C_1 L + T_b $$\n由此，我们用 $T_s$ 表示 $C_1$：\n$$ C_1 = \\frac{T_s - T_b}{L} $$\n现在，将这个 $C_1$ 的表达式代入能量平衡方程：\n$$ -k \\left( \\frac{T_s - T_b}{L} \\right) = h (T_s - T_{\\infty}) $$\n我们现在求解这个关于 $T_s$ 的代数方程。\n$$ -\\frac{k}{L} (T_s - T_b) = h T_s - h T_{\\infty} $$\n$$ -\\frac{k}{L} T_s + \\frac{k}{L} T_b = h T_s - h T_{\\infty} $$\n将含有 $T_s$ 的项归到一边，常数项归到另一边：\n$$ \\frac{k}{L} T_b + h T_{\\infty} = h T_s + \\frac{k}{L} T_s $$\n$$ \\frac{k}{L} T_b + h T_{\\infty} = T_s \\left( h + \\frac{k}{L} \\right) $$\n分离出 $T_s$ 可得到界面温度的解析表达式：\n$$ T_s = \\frac{\\frac{k}{L} T_b + h T_{\\infty}}{h + \\frac{k}{L}} $$\n为了简化表达式，我们可以将分子和分母同乘以 $L$：\n$$ T_s = \\frac{L \\left( \\frac{k}{L} T_b + h T_{\\infty} \\right)}{L \\left( h + \\frac{k}{L} \\right)} = \\frac{k T_b + h L T_{\\infty}}{h L + k} $$\n\n现在，我们使用给定的数值计算此表达式的值：\n$L = 3.0 \\times 10^{-3}\\ \\text{m}$\n$k = 22\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$\n$T_{b} = 900\\ \\text{K}$\n$h = 1.8 \\times 10^{3}\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}$\n$T_{\\infty} = 1600\\ \\text{K}$\n\n首先，计算复合项 $hL$：\n$$ hL = (1.8 \\times 10^{3}\\ \\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-1}) \\times (3.0 \\times 10^{-3}\\ \\text{m}) = 5.4\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1} $$\n现在将所有值代入 $T_s$ 的表达式中：\n$$ T_s = \\frac{(22\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1})(900\\ \\text{K}) + (5.4\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1})(1600\\ \\text{K})}{5.4\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1} + 22\\ \\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}} $$\n$$ T_s = \\frac{19800 + 8640}{27.4}\\ \\text{K} $$\n$$ T_s = \\frac{28440}{27.4}\\ \\text{K} $$\n$$ T_s = 1037.9562043... \\ \\text{K} $$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$0$、$3$ 和 $7$。第五位有效数字是 $9$，大于或等于 $5$，因此我们将第四位数字向上取整。\n$$ T_s \\approx 1038\\ \\text{K} $$",
            "answer": "$$\\boxed{1038}$$"
        },
        {
            "introduction": "在掌握了基本的耦合原理后，我们转向一个更接近工程实际的挑战：在湍流中对共轭传热进行建模。这个练习将指导您通过编程实现一个考虑了详细湍流边界层结构的一维CHT模型，核心在于对比常数湍流普朗特数（$Pr_t$）假设与更真实的随空间变化的$Pr_t$分布对壁面热流预测的影响。通过这个实践，您将深刻理解湍流模型选择在CHT模拟中的重要性，并获得宝贵的计算实现经验。",
            "id": "3949545",
            "problem": "您需要实现一个计算模型，以量化在具有一维共轭传热的湍流边界层中，指定的空间变化湍流普朗特数剖面 $Pr_t(y)$ 对预测的壁面热通量的影响。您必须从第一性原理推导出控制表达式，并通过算法实现它们。流动是稳态、统计平稳的，且为双层结构：一个有限厚度的固体基底上方是一个半无限的流体区域。流体通过一维雷诺平均Navier–Stokes (RANS) 能量方程和涡扩散率封闭进行建模，固体则通过一维傅里叶传导进行建模。您的程序必须为每个测试用例计算两种模型的壁面热通量：(i) 恒定湍流普朗特数 $Pr_t = \\text{const}$ 和 (ii) 可变 $Pr_t(y)$ 剖面。然后，程序必须报告这两个热通量值及其相对差异。\n\n请从以下基本陈述开始，将其作为您推导和算法设计的基础：\n- 在流体中，被动标量温度的雷诺平均一维稳态能量平衡方程简化为：$$\\frac{d}{dy}\\left(k_\\text{eff}(y)\\,\\frac{dT}{dy}\\right)=0,$$ 其中有效导热系数为 $$k_\\text{eff}(y)=k + \\rho\\,c_p\\,\\alpha_t(y),$$ $k$ 是分子导热系数，$\\rho$ 是密度， $c_p$ 是定压比热，$\\alpha_t(y)$ 是湍流热扩散率。湍流热扩散率通过涡粘性系数 $\\nu_t(y)$ 和湍流普朗特数 $Pr_t(y)$ 相关联：$$\\alpha_t(y)=\\frac{\\nu_t(y)}{Pr_t(y)}.$$\n- 涡粘性系数使用 van Driest 阻尼混合长度模型进行建模：$$\\nu_t(y)=\\kappa\\,u_\\tau\\,y\\left[1-\\exp\\!\\left(-\\frac{y^+}{A^+}\\right)\\right]^2,$$ 其中 $\\kappa$ 是 von Kármán 常数， $u_\\tau$ 是摩阻速度， $A^+$ 是一个常数， $y^+=y\\,u_\\tau/\\nu$ 是使用运动粘度 $\\nu$ 定义的壁面坐标。\n- 在固体中，适用稳态一维傅里叶传导，温度 $T_s(y)$ 满足 $$\\frac{d^2 T_s}{dy^2}=0.$$\n- 在 $y=0$ 处的流固界面，温度连续和热通量连续条件成立：$$T(0)=T_s(0)=T_w,\\quad -k_\\text{eff}(0)\\left.\\frac{dT}{dy}\\right|_{0^+}=-k_s\\left.\\frac{dT_s}{dy}\\right|_{0^-}=q''.$$ 当热量从固体流入流体时，壁面热通量 $q''$ 取正值。\n- 边界条件为：流体中 $T(y=\\delta)=T_\\infty$，固体中 $T_s(y=-L_s)=T_\\text{base}$，其中 $\\delta$ 是用作截断的热边界层外缘，$L_s$ 是固体厚度，$T_\\infty$ 是环境流体温度，$T_\\text{base}$ 是固体背部的基础温度。\n\n除了此处定义的内容外，您不得引入任何其他封闭模型或关联式。特别地，待比较的两个模型之间的唯一区别在于对 $Pr_t$ 的处理：要么是恒定值 $Pr_t=\\text{const}$，要么是由给定的 $y^+$ 函数表示的可变 $Pr_t(y)$。\n\n在推导出计算与上述条件一致的壁面热通量和界面温度所需的表达式后，请实现一个程序来评估以下内容。对于下方的每个测试用例，计算：\n- 假设湍流普朗特数恒定为 $Pr_t=\\hat{P}$ 时的壁面热通量。\n- 假设湍流普朗特数为可变剖面 $$Pr_t(y^+)=P_\\text{log} - \\left(P_\\text{log}-P_\\text{wall}\\right)\\exp\\!\\left(-\\frac{y^+}{B}\\right),$$ 时的壁面热通量，其中 $y^+=y\\,u_\\tau/\\nu$。\n- 定义为 $r=(q''_\\text{var}-q''_\\text{const})/q''_\\text{const}$ 的相对差异，以小数形式表示。\n\n您的程序在所有测试用例中必须使用以下固定常数：$\\kappa=0.41$，$A^+=26$，并且必须以足够的精度计算任何所需的积分，以确保报告的值至少稳定在4位有效数字。\n\n测试套件（每个用例提供所有参数；所有输入均使用国际单位制）：\n- 用例 A（基准情况，中等湍流，高导热性固体）：\n  - 流体：$\\rho=1.200$, $c_p=1005.0$, $\\nu=1.50\\times 10^{-5}$, $k=0.0260$, $u_\\tau=0.50$, $\\delta=0.0500$。\n  - 固体：$k_s=205.0$, $L_s=0.0100$。\n  - 热边界条件：$T_\\infty=300.0$, $T_\\text{base}=350.0$。\n  - 湍流普朗特数：恒定值 $\\hat{P}=0.85$；可变参数 $P_\\text{wall}=0.70$, $P_\\text{log}=0.85$, $B=30.0$。\n- 用例 B（弱湍流，低导热性厚固体）：\n  - 流体：$\\rho=1.200$, $c_p=1005.0$, $\\nu=1.50\\times 10^{-5}$, $k=0.0260$, $u_\\tau=0.15$, $\\delta=0.0200$。\n  - 固体：$k_s=2.00$, $L_s=0.0200$。\n  - 热边界条件：$T_\\infty=300.0$, $T_\\text{base}=350.0$。\n  - 湍流普朗特数：恒定值 $\\hat{P}=0.85$；可变参数 $P_\\text{wall}=0.70$, $P_\\text{log}=0.85$, $B=30.0$。\n- 用例 C（强湍流，高导热性薄固体）：\n  - 流体：$\\rho=1.200$, $c_p=1005.0$, $\\nu=1.50\\times 10^{-5}$, $k=0.0260$, $u_\\tau=1.00$, $\\delta=0.1000$。\n  - 固体：$k_s=380.0$, $L_s=0.00500$。\n  - 热边界条件：$T_\\infty=300.0$, $T_\\text{base}=350.0$。\n  - 湍流普朗特数：恒定值 $\\hat{P}=0.85$；可变参数 $P_\\text{wall}=0.70$, $P_\\text{log}=0.85$, $B=30.0$。\n- 用例 D（中等湍流，中等导热性薄固体）：\n  - 流体：$\\rho=1.200$, $c_p=1005.0$, $\\nu=1.50\\times 10^{-5}$, $k=0.0260$, $u_\\tau=0.70$, $\\delta=0.0300$。\n  - 固体：$k_s=16.0$, $L_s=0.00500$。\n  - 热边界条件：$T_\\infty=300.0$, $T_\\text{base}=350.0$。\n  - 湍流普朗特数：恒定值 $\\hat{P}=0.85$；可变参数 $P_\\text{wall}=0.70$, $P_\\text{log}=0.85$, $B=30.0$。\n\n每个测试用例的必需输出：\n- 计算数值对 $\\left(q''_\\text{var},\\,q''_\\text{const}\\right)$，单位均为 $\\text{W}/\\text{m}^2$，以及相对差异 $r$（以小数表示，无百分号）。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个由列表组成的逗号分隔列表形式的结果，每个内部列表的顺序为 $\\left[q''_\\text{var},\\,q''_\\text{const},\\,r\\right]$。例如：$\\left[\\left[1.0,2.0,-0.5\\right],\\left[\\dots\\right],\\dots\\right]$。",
            "solution": "该物理问题描述了一个稳态一维共轭传热情景。热量通过有限厚度的固体基底进行传导，然后传递到由湍流对流控制的半无限流体域中。目标是通过建立固体域和流体域之间的一致耦合来确定壁面热通量 $q''$。这是通过推导每个域的热阻并将它们组合成热路比拟来实现的。\n\n首先，我们分析覆盖区域 $y \\in [-L_s, 0]$ 的固体域。控制方程是稳态一维热传导方程：\n$$\n\\frac{d^2 T_s}{dy^2} = 0\n$$\n其中 $T_s(y)$ 是固体内的温度剖面。对该方程关于 $y$ 进行两次积分，得到一个线性温度剖面：\n$$\nT_s(y) = C_1 y + C_2\n$$\n积分常数 $C_1$ 和 $C_2$ 由边界条件确定。在固-液界面 $y=0$ 处，温度是未知的壁面温度 $T_w$，因此 $T_s(0) = T_w$，这得出 $C_2 = T_w$。在固体背部 $y=-L_s$ 处，温度保持在恒定值 $T_\\text{base}$，因此 $T_s(-L_s) = T_\\text{base}$。将此代入解中得到：\n$$\nT_\\text{base} = C_1(-L_s) + T_w \\implies C_1 = \\frac{T_w - T_\\text{base}}{-L_s} = \\frac{T_\\text{base} - T_w}{L_s}\n$$\n热通量 $q''$ 定义为从固体流入流体时为正。这对应于传导至界面 $y=0$ 处的热量。根据傅里叶定律和问题的符号约定，该通量为：\n$$\nq'' = -k_s \\left.\\frac{dT_s}{dy}\\right|_{y=0^-} = -k_s C_1 = -k_s \\left(\\frac{T_w - T_\\text{base}}{-L_s}\\right) = k_s \\frac{T_\\text{base} - T_w}{L_s}\n$$\n其中 $k_s$ 是固体的导热系数。该方程可以重排，用其热阻 $R_s$ 表示固体两端的温降：\n$$\nT_\\text{base} - T_w = q'' \\frac{L_s}{k_s} \\equiv q'' R_s\n$$\n因此，固体的热阻为 $R_s = L_s/k_s$。\n\n接下来，我们分析覆盖区域 $y \\in [0, \\delta]$ 的流体域。控制方程是一维稳态雷诺平均能量方程，采用涡扩散率封闭：\n$$\n\\frac{d}{dy}\\left(k_\\text{eff}(y)\\,\\frac{dT}{dy}\\right)=0\n$$\n其中 $T(y)$ 是流体中的平均温度剖面，$k_\\text{eff}(y)$ 是有效导热系数。该方程意味着 $y$ 方向的热通量 $q_f(y) = -k_\\text{eff}(y) \\frac{dT}{dy}$ 对于所有 $y \\in [0, \\delta]$ 都是恒定的。根据界面处的热通量连续性，这个恒定的通量必须等于 $q''$。因此：\n$$\n-k_\\text{eff}(y)\\frac{dT}{dy} = q''\n$$\n我们可以分离变量并从壁面（$y=0$）积分到热边界层边缘（$y=\\delta$），以求得流体两端的温降：\n$$\n\\int_{T(0)}^{T(\\delta)} dT = \\int_0^\\delta -\\frac{q''}{k_\\text{eff}(y)} dy\n$$\n使用边界条件 $T(0)=T_w$ 和 $T(\\delta)=T_\\infty$：\n$$\nT_\\infty - T_w = -q'' \\int_0^\\delta \\frac{dy}{k_\\text{eff}(y)}\n$$\n这可以根据流体热阻 $R_f$ 进行重排：\n$$\nT_w - T_\\infty = q'' \\int_0^\\delta \\frac{dy}{k_\\text{eff}(y)} \\equiv q'' R_f\n$$\n流体热阻 $R_f$ 是一个必须通过数值计算的积分：\n$$\nR_f = \\int_0^\\delta \\frac{dy}{k_\\text{eff}(y)}\n$$\n问题简化为从以下两个线性方程组中求解未知的壁面热通量 $q''$ 和壁面温度 $T_w$：\n$$\n\\begin{cases}\nT_\\text{base} - T_w = q'' R_s \\\\\nT_w - T_\\infty = q'' R_f\n\\end{cases}\n$$\n将这两个方程相加可以消去 $T_w$，并为 $q''$ 提供一个直接的表达式：\n$$\n(T_\\text{base} - T_w) + (T_w - T_\\infty) = q''(R_s + R_f) \\implies T_\\text{base} - T_\\infty = q''(R_s + R_f)\n$$\n解出 $q''$，我们得到计算的核心公式：\n$$\nq'' = \\frac{T_\\text{base} - T_\\infty}{R_s + R_f} = \\frac{T_\\text{base} - T_\\infty}{\\frac{L_s}{k_s} + \\int_0^\\delta \\frac{dy}{k_\\text{eff}(y)}}\n$$\n有效导热系数 $k_\\text{eff}(y)$ 是分子贡献和湍流贡献的总和：$k_\\text{eff}(y) = k + \\rho c_p \\alpha_t(y)$，其中 $\\alpha_t(y) = \\nu_t(y)/Pr_t(y)$。涡粘性系数 $\\nu_t(y)$ 由 van Driest 阻尼混合长度模型给出：\n$$\n\\nu_t(y)=\\kappa\\,u_\\tau\\,y\\left[1-\\exp\\!\\left(-\\frac{y^+}{A^+}\\right)\\right]^2\n$$\n其中 $y^+=y\\,u_\\tau/\\nu$，$\\kappa=0.41$，$A^+=26$。\n\n问题要求在两种湍流普朗特数 $Pr_t$ 模型之间进行比较。\n1.  **恒定 $Pr_t$ 模型：** $Pr_t(y) = \\hat{P}$。有效导热系数为 $k_{\\text{eff,const}}(y) = k + \\rho c_p \\nu_t(y)/\\hat{P}$。由此产生的热通量记为 $q''_\\text{const}$。\n2.  **可变 $Pr_t$ 模型：** $Pr_t$ 是壁面坐标 $y^+$ 的函数，由 $Pr_t(y^+) = P_\\text{log} - (P_\\text{log} - P_\\text{wall})\\exp(-y^+/B)$ 给出。有效导热系数为 $k_{\\text{eff,var}}(y) = k + \\rho c_p \\nu_t(y)/Pr_t(y^+(y))$。由此产生的热通量记为 $q''_\\text{var}$。\n\n解决每个测试用例的算法流程如下：\n首先，对于恒定 $Pr_t$ 模型，通过数值积分 $\\int_0^\\delta (k_{\\text{eff,const}}(y))^{-1} dy$ 来计算流体热阻 $R_{f,\\text{const}}$。然后，使用总热通量公式计算热通量 $q''_\\text{const}$。\n其次，对可变 $Pr_t$ 模型重复相同的过程，以求得 $R_{f,\\text{var}}$ 和 $q''_\\text{var}$。\n最后，计算相对差异 $r = (q''_\\text{var} - q''_\\text{const}) / q''_\\text{const}$。\n对测试套件中提供的每组参数执行此过程。数值积分使用 `scipy.integrate` 库中的 `quad` 函数执行，该函数为此应用提供了足够的精度。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to solve the conjugate heat transfer problem for all test cases.\n    \"\"\"\n    \n    # Global constants from the problem statement\n    KAPPA = 0.41\n    A_PLUS = 26.0\n\n    # Test suite from the problem statement\n    test_cases = [\n        {\n            # Case A\n            'fluid': {'rho': 1.200, 'cp': 1005.0, 'nu': 1.50e-5, 'k': 0.0260, 'u_tau': 0.50, 'delta': 0.0500},\n            'solid': {'k_s': 205.0, 'L_s': 0.0100},\n            'thermal_bc': {'T_infty': 300.0, 'T_base': 350.0},\n            'prt': {'const': 0.85, 'var_params': {'P_wall': 0.70, 'P_log': 0.85, 'B': 30.0}}\n        },\n        {\n            # Case B\n            'fluid': {'rho': 1.200, 'cp': 1005.0, 'nu': 1.50e-5, 'k': 0.0260, 'u_tau': 0.15, 'delta': 0.0200},\n            'solid': {'k_s': 2.00, 'L_s': 0.0200},\n            'thermal_bc': {'T_infty': 300.0, 'T_base': 350.0},\n            'prt': {'const': 0.85, 'var_params': {'P_wall': 0.70, 'P_log': 0.85, 'B': 30.0}}\n        },\n        {\n            # Case C\n            'fluid': {'rho': 1.200, 'cp': 1005.0, 'nu': 1.50e-5, 'k': 0.0260, 'u_tau': 1.00, 'delta': 0.1000},\n            'solid': {'k_s': 380.0, 'L_s': 0.00500},\n            'thermal_bc': {'T_infty': 300.0, 'T_base': 350.0},\n            'prt': {'const': 0.85, 'var_params': {'P_wall': 0.70, 'P_log': 0.85, 'B': 30.0}}\n        },\n        {\n            # Case D\n            'fluid': {'rho': 1.200, 'cp': 1005.0, 'nu': 1.50e-5, 'k': 0.0260, 'u_tau': 0.70, 'delta': 0.0300},\n            'solid': {'k_s': 16.0, 'L_s': 0.00500},\n            'thermal_bc': {'T_infty': 300.0, 'T_base': 350.0},\n            'prt': {'const': 0.85, 'var_params': {'P_wall': 0.70, 'P_log': 0.85, 'B': 30.0}}\n        }\n    ]\n\n    def calculate_flux(params, prt_model_type):\n        \"\"\"\n        Calculates wall heat flux for a given set of parameters and Pr_t model.\n        \"\"\"\n        # Unpack parameters\n        fluid_p, solid_p, thermal_p, prt_p = params['fluid'], params['solid'], params['thermal_bc'], params['prt']\n\n        def integrand(y):\n            # Calculate wall coordinate y+\n            y_plus = y * fluid_p['u_tau'] / fluid_p['nu']\n            \n            # Calculate eddy viscosity nu_t\n            van_driest_damping = (1.0 - np.exp(-y_plus / A_PLUS))**2\n            nu_t = KAPPA * fluid_p['u_tau'] * y * van_driest_damping\n            \n            # Select Pr_t model\n            if prt_model_type == 'const':\n                pr_t = prt_p['const']\n            else:  # 'var'\n                vp = prt_p['var_params']\n                pr_t = vp['P_log'] - (vp['P_log'] - vp['P_wall']) * np.exp(-y_plus / vp['B'])\n\n            # Effective thermal conductivity k_eff\n            k_t = fluid_p['rho'] * fluid_p['cp'] * nu_t / pr_t\n            k_eff = fluid_p['k'] + k_t\n            \n            return 1.0 / k_eff\n\n        # Numerically integrate to find fluid thermal resistance R_f\n        R_f, _ = quad(integrand, 0, fluid_p['delta'])\n        \n        # Solid thermal resistance\n        R_s = solid_p['L_s'] / solid_p['k_s']\n        \n        # Total temperature difference\n        delta_T = thermal_p['T_base'] - thermal_p['T_infty']\n        \n        # Wall heat flux q''\n        q_double_prime = delta_T / (R_s + R_f)\n        \n        return q_double_prime\n\n    results = []\n    for case in test_cases:\n        # Calculate heat flux for the constant Pr_t model\n        q_const = calculate_flux(case, 'const')\n        \n        # Calculate heat flux for the variable Pr_t model\n        q_var = calculate_flux(case, 'var')\n        \n        # Calculate the relative difference\n        relative_diff = (q_var - q_const) / q_const if q_const != 0 else 0.0\n        \n        results.append([q_var, q_const, relative_diff])\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "任何计算流体动力学（CFD）或共轭传热（CHT）模拟的最终目标都是获得可靠的、与网格无关的解。本练习聚焦于计算结果的验证，特别是网格收敛性分析这一关键步骤。您将学习并应用Richardson外推法，利用来自三个不同分辨率网格的解来估算精确的“网格无关”热流值，并评估数值方法的观测精度阶。这项技能对于确保任何数值模拟结果的严谨性和可信度都是不可或-缺的。",
            "id": "3949575",
            "problem": "一个二维稳态共轭传热问题，将一个不可压缩流体层与一个厚度为 $L_{s}$ 的均匀固壁耦合。该系统通过一个等温远场流体边界和一个固定的固壁背面温度来定义。一个二阶、单元中心的有限体积计算流体力学(CFD)求解器在流固界面上强制保证温度和法向热通量的连续性。生成了三个连续加密的共形网格，其中流体和固体网格都以一个恒定的加密比 $r$ 进行加密，使得代表性的界面网格间距满足 $h_{1}/h_{2}=h_{2}/h_{3}=r$。设 $q(h)$ 表示在固体侧评估并沿界面空间平均的界面壁面热通量。假设数值方法是一致的，并且在渐近网格收敛区，$q(h)$ 的主截断误差允许展开为 $q(h)=q^{\\ast}+C h^{p}+\\mathcal{O}(h^{p+1})$，其中 $q^{\\ast}$ 是网格收敛的界面热通量，对于固定的解分支，$C$ 是一个与网格无关的常数，$p$ 是观测精度阶。\n\n在加密比 $r=2$ 的三个网格上，求解器报告了以下界面热通量：\n$q(h_{1}) = 29\\,432\\,\\mathrm{W\\,m^{-2}}$，$q(h_{2}) = 27\\,932\\,\\mathrm{W\\,m^{-2}}$，以及 $q(h_{3}) = 27\\,557\\,\\mathrm{W\\,m^{-2}}$。\n\n从上述截断误差模型出发，仅使用一致性和恒定加密比的假设，推导表达式以 (i) 从三个网格解中确定观测精度阶 $p$，以及 (ii) 用三个计算值和 $r$ 来获得 $q^{\\ast}$ 的 Richardson 外推估计。然后用所提供的数据评估这些表达式，以产生网格收敛的界面壁面热通量的单个最佳估计。最终的壁面热通量以 $\\mathrm{W\\,m^{-2}}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于计算流体力学和数值分析的原理，特别是关于使用 Richardson 外推法进行网格收敛性研究。该问题是适定的、客观的，并包含推导唯一解所需的所有必要信息。\n\n该问题涉及从一系列在连续加密的网格上得到的三个数值解中，估计空间平均的界面热通量的网格收敛值 $q^{\\ast}$。在特征间距为 $h$ 的网格上计算得到的热通量（记为 $q(h)$）与精确解 $q^{\\ast}$ 之间的关系由截断误差展开式给出：\n$$q(h) = q^{\\ast} + C h^{p} + \\mathcal{O}(h^{p+1})$$\n其中 $p$ 是观测精度阶，$C$ 是一个常数。我们被给予了在三个具有代表性间距 $h_1 > h_2 > h_3$ 的网格上的三个解，$q_1 = q(h_1)$，$q_2 = q(h_2)$ 和 $q_3 = q(h_3)$。网格以一个恒定的比率 $r$ 加密，使得 $h_1 = r h_2$ 并且 $h_2 = r h_3$。\n\n假设我们处于渐近区域，其中高阶项 $\\mathcal{O}(h^{p+1})$ 可以忽略不计，我们可以写出以下方程组：\n$q_1 \\approx q^{\\ast} + C h_1^p$\n$q_2 \\approx q^{\\ast} + C h_2^p$\n$q_3 \\approx q^{\\ast} + C h_3^p$\n\n(i) 观测精度阶 $p$ 的表达式推导。\n\n我们构造连续解之间的差值：\n$$q_1 - q_2 = (q^{\\ast} + C h_1^p) - (q^{\\ast} + C h_2^p) = C(h_1^p - h_2^p)$$\n$$q_2 - q_3 = (q^{\\ast} + C h_2^p) - (q^{\\ast} + C h_3^p) = C(h_2^p - h_3^p)$$\n使用网格加密关系 $h_1 = r h_2$ 和 $h_2 = r h_3$，我们可以重写这些差值：\n$$q_1 - q_2 = C((r h_2)^p - h_2^p) = C h_2^p (r^p - 1)$$\n$$q_2 - q_3 = C((r h_3)^p - h_3^p) = C h_3^p (r^p - 1)$$\n通过取这两个差值的比率，未知常数 $C$ 和项 $(r^p - 1)$ 被消去：\n$$\\frac{q_1 - q_2}{q_2 - q_3} = \\frac{C h_2^p (r^p - 1)}{C h_3^p (r^p - 1)} = \\frac{h_2^p}{h_3^p} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p$$\n为了求解 $p$，我们对两边取自然对数：\n$$\\ln\\left(\\frac{q_1 - q_2}{q_2 - q_3}\\right) = \\ln(r^p) = p \\ln(r)$$\n分离 $p$ 得到观测精度阶的表达式：\n$$p = \\frac{\\ln\\left(\\frac{q_1 - q_2}{q_2 - q_3}\\right)}{\\ln(r)}$$\n\n(ii) $q^{\\ast}$ 的 Richardson 外推估计的推导。\n\n我们寻求一个用三个计算值 $q_1$, $q_2$, $q_3$ 和加密比 $r$ 表示 $q^{\\ast}$ 的表达式。从以上结果出发，我们有两个关于 $r^p$ 的表达式：\n$$r^p = \\frac{q_1 - q_2}{q_2 - q_3}$$\n此外，从误差模型本身，我们可以写出误差的比率：\n$q_1 - q^{\\ast} = C h_1^p$\n$q_2 - q^{\\ast} = C h_2^p$\n$q_3 - q^{\\ast} = C h_3^p$\n前两个误差的比率是 $\\frac{q_1 - q^{\\ast}}{q_2 - q^{\\ast}} = \\frac{C h_1^p}{C h_2^p} = \\left(\\frac{h_1}{h_2}\\right)^p = r^p$。\n类似地，后两个误差的比率是 $\\frac{q_2 - q^{\\ast}}{q_3 - q^{\\ast}} = \\frac{C h_2^p}{C h_3^p} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p$。\n将这两个 $r^p$ 的表达式相等，得到：\n$$\\frac{q_1 - q^{\\ast}}{q_2 - q^{\\ast}} = \\frac{q_2 - q^{\\ast}}{q_3 - q^{\\ast}}$$\n交叉相乘得到：\n$$(q_1 - q^{\\ast})(q_3 - q^{\\ast}) = (q_2 - q^{\\ast})^2$$\n展开方程两边：\n$$q_1 q_3 - q_1 q^{\\ast} - q_3 q^{\\ast} + (q^{\\ast})^2 = q_2^2 - 2 q_2 q^{\\ast} + (q^{\\ast})^2$$\n$(q^{\\ast})^2$ 项相互抵消。我们重新整理方程以求解 $q^{\\ast}$：\n$$q_1 q_3 - q_2^2 = q_1 q^{\\ast} + q_3 q^{\\ast} - 2 q_2 q^{\\ast}$$\n$$q_1 q_3 - q_2^2 = q^{\\ast} (q_1 - 2q_2 + q_3)$$\n最后，网格收敛热通量的 Richardson 外推估计为：\n$$q^{\\ast} = \\frac{q_1 q_3 - q_2^2}{q_1 - 2q_2 + q_3}$$\n这个表达式是 Aitken's delta-squared 加速法的一种形式，它直接从三个数据点提供外推值 $q^{\\ast}$。\n\n(iii) 表达式求值。\n\n给定的数据是：\n$q_1 = 29\\,432\\,\\mathrm{W\\,m^{-2}}$\n$q_2 = 27\\,932\\,\\mathrm{W\\,m^{-2}}$\n$q_3 = 27\\,557\\,\\mathrm{W\\,m^{-2}}$\n$r = 2$\n\n首先，我们计算差值：\n$q_1 - q_2 = 29\\,432 - 27\\,932 = 1\\,500$\n$q_2 - q_3 = 27\\,932 - 27\\,557 = 375$\n\n现在，我们计算观测精度阶 $p$：\n$$p = \\frac{\\ln\\left(\\frac{1\\,500}{375}\\right)}{\\ln(2)} = \\frac{\\ln(4)}{\\ln(2)} = \\frac{\\ln(2^2)}{\\ln(2)} = \\frac{2\\ln(2)}{\\ln(2)} = 2$$\n观测精度阶恰好为 $2$，这与问题陈述中求解器是二阶的说法一致。\n\n接下来，我们计算网格收敛的热通量 $q^{\\ast}$。虽然推导出的公式 $q^{\\ast} = (q_1 q_3 - q_2^2)/(q_1 - 2q_2 + q_3)$ 是正确的，但一个代数上等价且计算上更稳定的形式是 $q^{\\ast} = q_2 - \\frac{(q_1 - q_2)(q_2 - q_3)}{q_1 - 2q_2 + q_3}$。我们使用这个形式进行计算。分母是 $q_1 - 2q_2 + q_3 = (q_1 - q_2) - (q_2 - q_3) = 1\\,500 - 375 = 1\\,125$。\n$$q^{\\ast} = 27\\,932 - \\frac{1\\,500 \\times 375}{1\\,125} = 27\\,932 - \\frac{562\\,500}{1\\,125} = 27\\,932 - 500 = 27\\,432$$\n网格收敛的界面壁面热通量的最佳估计值为 $27\\,432\\,\\mathrm{W\\,m^{-2}}$。\n\n问题要求将此值四舍五入到四位有效数字。\n将 $27\\,432$ 四舍五入到四位有效数字是 $27\\,430$。用科学记数法表示为 $2.743 \\times 10^4$。",
            "answer": "$$\\boxed{2.743 \\times 10^4}$$"
        }
    ]
}