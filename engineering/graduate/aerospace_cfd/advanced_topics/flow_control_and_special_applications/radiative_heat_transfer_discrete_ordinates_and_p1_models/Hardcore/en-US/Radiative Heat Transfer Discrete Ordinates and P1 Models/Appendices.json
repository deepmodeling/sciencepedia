{
    "hands_on_practices": [
        {
            "introduction": "The first step in any engineering analysis is choosing the right tool for the job. This practice tackles the critical decision of when to use the P1 approximation versus the more general Discrete Ordinates Method (DOM). You will learn to calculate fundamental dimensionless parameters, such as the optical thickness and single-scattering albedo, which dictate the physical regime of radiative transport. This exercise  will equip you with the quantitative criteria and physical intuition necessary to justify your choice of model in practical aerospace applications.",
            "id": "3988548",
            "problem": "Consider a one-dimensional, plane-parallel, gray, isothermal slab of thickness $L$ representing a radiatively participating layer in a hypersonic vehicle boundary layer. The slab has uniform absorption coefficient $\\kappa$ and scattering coefficient $\\sigma_{s}$, with isotropic scattering and refractive index equal to unity. The boundaries are black and isothermal so that emitted thermal radiation is isotropic. The participating medium is at local thermodynamic equilibrium, so the emission source is the blackbody source function. Let the slab be characterized by\n$$L = 0.12 \\ \\text{m}, \\quad \\kappa = 18 \\ \\text{m}^{-1}, \\quad \\sigma_{s} = 42 \\ \\text{m}^{-1}.$$\n\nUsing first principles starting from the Radiative Transfer Equation (RTE), define the total extinction coefficient, the radiative mean free path, the optical thickness, the radiative Knudsen number, and the single-scattering albedo. Then, based on asymptotic arguments for the diffusion limit and angular isotropy of the radiation field, provide quantitative criteria that indicate when the First-Order Spherical Harmonics (P1) method is expected to be accurate and when the Discrete Ordinates Method (DOM) is preferred. Apply your criteria to the given slab to assess the validity of P1 and DOM in this case.\n\nCompute the optical thickness $\\tau$ for the slab. Express the numerical value of $\\tau$ to four significant figures. The optical thickness is dimensionless; report it without units.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information to proceed with a solution. All physical quantities and parameters are within realistic ranges for the specified application in aerospace CFD.\n\nThe starting point for analyzing radiative transfer is the Radiative Transfer Equation (RTE). For a one-dimensional, plane-parallel, gray, absorbing, emitting, and isotropically scattering medium in local thermodynamic equilibrium (LTE), the RTE is given by:\n$$\n\\mu \\frac{dI(z, \\mu)}{dz} = -\\kappa I(z, \\mu) - \\sigma_s I(z, \\mu) + \\kappa I_b(T) + \\frac{\\sigma_s}{2} \\int_{-1}^{1} I(z, \\mu') d\\mu'\n$$\nwhere $z$ is the spatial coordinate, $I(z, \\mu)$ is the radiation intensity at position $z$ in the direction specified by the direction cosine $\\mu = \\cos\\theta$, $\\kappa$ is the absorption coefficient, $\\sigma_s$ is the scattering coefficient, and $I_b(T)$ is the Planck blackbody intensity at the medium temperature $T$. The givens are the slab thickness $L = 0.12 \\ \\text{m}$, absorption coefficient $\\kappa = 18 \\ \\text{m}^{-1}$, and scattering coefficient $\\sigma_{s} = 42 \\ \\text{m}^{-1}$.\n\nFrom these fundamental coefficients, we can define several key parameters that characterize the radiative transfer process.\n\n1.  **Total Extinction Coefficient ($\\beta$)**: This coefficient represents the total attenuation of radiation per unit path length due to the combined effects of absorption and scattering. It is defined as the sum of the absorption and scattering coefficients.\n    $$\n    \\beta = \\kappa + \\sigma_s\n    $$\n\n2.  **Radiative Mean Free Path ($\\lambda_r$)**: This is the average distance a photon travels through the medium before an interaction (either absorption or scattering) occurs. It is the reciprocal of the total extinction coefficient.\n    $$\n    \\lambda_r = \\frac{1}{\\beta} = \\frac{1}{\\kappa + \\sigma_s}\n    $$\n\n3.  **Single-Scattering Albedo ($\\omega$)**: This dimensionless parameter quantifies the relative importance of scattering compared to total extinction. It is the ratio of the scattering coefficient to the total extinction coefficient. A value of $\\omega = 0$ indicates a purely absorbing medium, while $\\omega = 1$ indicates a purely scattering medium.\n    $$\n    \\omega = \\frac{\\sigma_s}{\\beta} = \\frac{\\sigma_s}{\\kappa + \\sigma_s}\n    $$\n\n4.  **Optical Thickness ($\\tau$)**: This dimensionless quantity measures the total \"optical\" distance through the medium. For a homogeneous slab of physical thickness $L$, it is defined as the product of the extinction coefficient and the physical thickness. A medium is considered optically thin if $\\tau \\ll 1$ and optically thick if $\\tau \\gg 1$.\n    $$\n    \\tau = \\beta L = (\\kappa + \\sigma_s)L\n    $$\n\n5.  **Radiative Knudsen Number ($Kn_r$)**: This dimensionless number is the ratio of the radiative mean free path to a characteristic length scale of the problem, $L$. It is the reciprocal of the optical thickness and is crucial for determining the regime of radiative transport.\n    $$\n    Kn_r = \\frac{\\lambda_r}{L} = \\frac{1}{\\beta L} = \\frac{1}{\\tau}\n    $$\n\nNext, we establish the criteria for the applicability of the First-Order Spherical Harmonics (P1) method and the Discrete Ordinates Method (DOM).\n\nThe **P1 method** is an approximation derived by assuming the radiation intensity field $I$ is nearly isotropic. Specifically, the intensity is approximated by a linear function of the direction cosine, $I \\approx A_0 + A_1 \\mu$. This assumption is physically valid only when radiation has undergone many scattering events, which randomizes its directionality. This leads to the **diffusion limit** of radiative transfer. The P1 model is accurate under the following conditions, based on asymptotic arguments:\n-   The medium must be **optically thick**, meaning the optical thickness $\\tau \\gg 1$, or equivalently, the radiative Knudsen number $Kn_r \\ll 1$. A commonly used quantitative criterion is $\\tau > 10$. In this regime, photons undergo numerous interactions, and the radiation field becomes diffusive and nearly isotropic, far from boundaries.\n-   The P1 method is more accurate for **scattering-dominated media**, where the single-scattering albedo $\\omega$ approaches $1$. High scattering enhances the isotropization of the radiation field.\n-   The P1 method is inherently inaccurate within a few radiative mean free paths of a boundary, as the radiation field is highly anisotropic in these regions. Therefore, its validity is restricted to the interior of an optically thick domain.\n\nThe **Discrete Ordinates Method (DOM)** solves the RTE for a set of discrete, representative directions. It does not rely on assumptions about the isotropy of the radiation field.\n-   DOM is the preferred method when the P1 assumptions are violated. This occurs in **optically thin** ($\\tau \\le 1$) or **intermediately thick** ($1  \\tau \\le 10$) media, where radiation is not diffusive.\n-   DOM is necessary to capture strong **anisotropy** in the radiation field. Such conditions are characteristic of regions near boundaries, in problems involving collimated sources, or in media with significant absorption (lower $\\omega$).\n-   The DOM's accuracy is a function of the number of discrete directions (the order of the quadrature set). It is a more general and robust method, applicable across all optical regimes, provided a sufficiently high order is used.\n\nNow we apply these criteria to the given slab. First, we compute the characteristic parameters:\nTotal extinction coefficient:\n$$\n\\beta = \\kappa + \\sigma_s = 18 \\ \\text{m}^{-1} + 42 \\ \\text{m}^{-1} = 60 \\ \\text{m}^{-1}\n$$\nOptical thickness of the slab:\n$$\n\\tau = \\beta L = (60 \\ \\text{m}^{-1}) (0.12 \\ \\text{m}) = 7.2\n$$\nSingle-scattering albedo:\n$$\n\\omega = \\frac{\\sigma_s}{\\beta} = \\frac{42}{60} = 0.7\n$$\nRadiative Knudsen number:\n$$\nKn_r = \\frac{1}{\\tau} = \\frac{1}{7.2} \\approx 0.139\n$$\n\nAssessment of the methods:\n-   The optical thickness is $\\tau = 7.2$. This value does not satisfy the criterion for the optically thick limit ($\\tau \\gg 10$). The medium is in the intermediate optical thickness regime. The radiative Knudsen number, $Kn_r \\approx 0.139$, is not small enough to justify the diffusion approximation.\n-   The single-scattering albedo is $\\omega = 0.7$. This indicates that absorption is significant ($30\\%$ of extinction events are absorptions), which reduces the tendency of the radiation field to become isotropic. The P1 method performs best when $\\omega \\to 1$.\n-   Since the problem concerns the entire slab, including its boundaries, the inherent inaccuracy of the P1 method near boundaries will affect the entire solution domain.\n\nBased on this analysis, the conditions for the validity of the P1 approximation are not met. The slab is not optically thick, and the contribution of absorption is significant. The DOM is the appropriate method for this problem, as it can accurately handle the intermediate optical thickness and the boundary effects without assuming an isotropic radiation field.\n\nFinally, the problem asks to compute the numerical value of the optical thickness $\\tau$ to four significant figures.\n$$\n\\tau = (\\kappa + \\sigma_s)L = (18 + 42) \\times 0.12 = 60 \\times 0.12 = 7.2\n$$\nExpressed to four significant figures, this value is $7.200$.",
            "answer": "$$\n\\boxed{7.200}\n$$"
        },
        {
            "introduction": "Once the P1 model is chosen for an optically thick medium, it is crucial to understand its mathematical structure. This exercise provides a foundational, analytical look into the P1 approximation by having you derive it from the Radiative Transfer Equation (RTE). By solving the resulting diffusion equation for a canonical 1D slab problem , you will gain a rigorous understanding of the model's formulation and the application of Marshak boundary conditions, which are critical for its correct implementation.",
            "id": "3988565",
            "problem": "Consider a one-dimensional planar slab of thickness $L$ filled with a homogeneous, gray, isotropically scattering gas at steady state. The gas has constant absorption coefficient $\\sigma_{a}$ and scattering coefficient $\\sigma_{s}$, so that the total interaction coefficient is $\\sigma_{t} = \\sigma_{a} + \\sigma_{s}$. The slab is bounded by two black, diffuse walls located at $x=0$ and $x=L$, maintained at uniform temperatures $T_{0}$ and $T_{L}$, respectively. The gas is isothermal at temperature $T_{m}$ so that its local isotropic blackbody intensity is $I_{b,m} = \\sigma_{\\mathrm{SB}} T_{m}^{4} / \\pi$, where $\\sigma_{\\mathrm{SB}}$ is the Stefanâ€“Boltzmann constant. The blackbody intensities of the walls are $I_{b,0} = \\sigma_{\\mathrm{SB}} T_{0}^{4} / \\pi$ at $x=0$ and $I_{b,L} = \\sigma_{\\mathrm{SB}} T_{L}^{4} / \\pi$ at $x=L$.\n\nStarting from the Radiative Transfer Equation (RTE) and using the first-order spherical harmonics method (P1), derive the governing diffusion equation for the scalar radiation flux $\\phi(x) = \\int_{4\\pi} I(x,\\mathbf{s}) \\,\\mathrm{d}\\Omega$ and the associated boundary conditions appropriate for black, diffuse walls. Solve analytically for $\\phi(x)$ in the slab and then compute the net radiative heat flux into the left wall at $x=0$ (take positive when directed into the wall). Express your final heat flux as a single closed-form analytic expression in terms of $L$, $\\sigma_{a}$, $\\sigma_{s}$, $T_{m}$, $T_{0}$, $T_{L}$, and $\\sigma_{\\mathrm{SB}}$. Express the heat flux in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.",
            "solution": "The problem statement is assessed to be valid as it is scientifically grounded, self-contained, well-posed, and objective. It presents a standard problem in radiative heat transfer that can be formalized and solved using established principles.\n\nThe starting point for the derivation is the one-dimensional, steady-state Radiative Transfer Equation (RTE) for a gray, absorbing, emitting, and isotropically scattering gas in a planar slab:\n$$\n\\mu \\frac{\\mathrm{d}I(x, \\mu)}{\\mathrm{d}x} + \\sigma_{t} I(x, \\mu) = S(x)\n$$\nwhere $I(x, \\mu)$ is the radiation intensity at position $x$ in the direction specified by the direction cosine $\\mu = \\cos\\theta$, $\\sigma_{t} = \\sigma_{a} + \\sigma_{s}$ is the extinction coefficient. The source term $S(x)$ for an isothermal gas at temperature $T_{m}$ with isotropic scattering is given by:\n$$\nS(x) = \\sigma_{a} I_{b,m} + \\frac{\\sigma_{s}}{4\\pi} \\int_{4\\pi} I(x, \\mathbf{s}') \\,\\mathrm{d}\\Omega' = \\sigma_{a} I_{b,m} + \\frac{\\sigma_{s}}{4\\pi} \\phi(x)\n$$\nHere, $I_{b,m} = \\sigma_{\\mathrm{SB}}T_{m}^{4}/\\pi$ is the blackbody intensity of the gas, and $\\phi(x) = \\int_{4\\pi} I(x, \\mathbf{s}) \\,\\mathrm{d}\\Omega$ is the scalar radiation flux (incident radiation).\n\nThe first-order spherical harmonics (P1) approximation expands the intensity as:\n$$\nI(x, \\mu) \\approx \\frac{1}{4\\pi}\\phi(x) + \\frac{3}{4\\pi}q(x)\\mu\n$$\nwhere $q(x) = \\int_{4\\pi} I(x, \\mu)\\mu \\,\\mathrm{d}\\Omega$ is the radiative heat flux in the $x$-direction.\n\nTo derive the governing equation for $\\phi(x)$, we take moments of the RTE. The zeroth moment (integrating the RTE over all solid angles) yields the energy conservation equation:\n$$\n\\frac{\\mathrm{d}q(x)}{\\mathrm{d}x} = -\\sigma_{a}(\\phi(x) - 4\\pi I_{b,m})\n$$\nThe first moment (multiplying the RTE by $\\mu$ and integrating over all solid angles) yields Fick's law of diffusion for radiation:\n$$\nq(x) = -\\frac{1}{3\\sigma_{t}} \\frac{\\mathrm{d}\\phi(x)}{\\mathrm{d}x}\n$$\nSubstituting this expression for $q(x)$ into the zeroth moment equation gives the P1 diffusion equation:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(-\\frac{1}{3\\sigma_{t}} \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) = -\\sigma_{a}(\\phi - 4\\pi I_{b,m})\n$$\nSince coefficients are constant, we have:\n$$\n\\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2} - 3\\sigma_{a}\\sigma_{t}\\phi = -3\\sigma_{a}\\sigma_{t}(4\\pi I_{b,m})\n$$\nLet's define the blackbody scalar flux $\\phi_{b} = 4\\pi I_{b} = 4\\sigma_{\\mathrm{SB}}T^4$ and the parameter $\\kappa = \\sqrt{3\\sigma_{a}\\sigma_{t}}$. The governing ODE becomes:\n$$\n\\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2} - \\kappa^2 \\phi = -\\kappa^2 \\phi_{b,m}\n$$\n\nNext, we derive the Marshak boundary conditions for black walls. At a black wall at $x=0$, the outgoing intensity is $I(0, \\mu>0) = I_{b,0}$. We equate the exact outgoing radiative flux $q^{+} = \\pi I_{b,0}$ with the P1 approximation for this flux, leading to the boundary condition:\n$$\n\\phi(0) - \\frac{2}{3\\sigma_{t}}\\phi'(0) = \\phi_{b,0}\n$$\nSimilarly, at the wall at $x=L$, the outgoing intensity (into the medium) is $I(L, \\mu0) = I_{b,L}$. This yields the boundary condition at $x=L$:\n$$\n\\phi(L) + \\frac{2}{3\\sigma_{t}}\\phi'(L) = \\phi_{b,L}\n$$\n\nThe general solution to the non-homogeneous ODE is the sum of a particular solution, $\\phi_p(x) = \\phi_{b,m}$, and a homogeneous solution. The full solution is:\n$$\n\\phi(x) = C_1 \\cosh(\\kappa x) + C_2 \\sinh(\\kappa x) + \\phi_{b,m}\n$$\nIts derivative is $\\phi'(x) = \\kappa C_1 \\sinh(\\kappa x) + \\kappa C_2 \\cosh(\\kappa x)$.\nThe constants $C_1$ and $C_2$ are determined by applying the Marshak boundary conditions, which form a 2x2 linear system.\n\nThe quantity of interest is the net radiative heat flux into the wall at $x=0$, which is $q_{net,0} = -q(0)$. Using Fick's law:\n$$\nq_{net,0} = - \\left(-\\frac{1}{3\\sigma_{t}} \\phi'(0)\\right) = \\frac{1}{3\\sigma_{t}} (\\kappa C_2)\n$$\nSolving the linear system for $C_2$ and substituting into the flux expression is algebraically intensive. After defining a dimensionless parameter $\\gamma = \\frac{2\\kappa}{3\\sigma_t} = 2\\sqrt{\\frac{\\sigma_a}{3\\sigma_t}}$ and using the relation $\\phi_b = 4\\sigma_{\\mathrm{SB}}T^4$, the final analytical expression for the heat flux is obtained.\nThe expression for the net radiative heat flux into the left wall is:\n$$\nq_{net,0} = \\frac{2\\gamma \\sigma_{\\mathrm{SB}} \\left[ (T_{L}^{4} - T_{m}^{4}) - (T_{0}^{4} - T_{m}^{4})(\\cosh(\\kappa L) + \\gamma \\sinh(\\kappa L)) \\right]}{(1+\\gamma^2)\\sinh(\\kappa L) + 2\\gamma\\cosh(\\kappa L)}\n$$\nwhere $\\sigma_{t} = \\sigma_{a} + \\sigma_{s}$, $\\kappa = \\sqrt{3\\sigma_{a}(\\sigma_{a} + \\sigma_{s})}$, and $\\gamma = 2\\sqrt{\\frac{\\sigma_{a}}{3(\\sigma_{a} + \\sigma_{s})}}$. The units are $\\mathrm{W}\\,\\mathrm{m}^{-2}$ as required.",
            "answer": "$$\n\\boxed{2\\gamma \\sigma_{\\mathrm{SB}} \\frac{(T_{L}^{4} - T_{m}^{4}) - (T_{0}^{4} - T_{m}^{4})(\\cosh(\\kappa L) + \\gamma \\sinh(\\kappa L))}{(1+\\gamma^2)\\sinh(\\kappa L) + 2\\gamma\\cosh(\\kappa L)}}\n$$"
        },
        {
            "introduction": "While the Discrete Ordinates Method (DOM) is more broadly applicable than the P1 model, it is susceptible to numerical artifacts, most notably the 'ray effect.' This computational practice moves from theory to code, tasking you with simulating a collimated beam to visualize and quantify this non-physical behavior. By implementing a benchmark and comparing a coarse angular discretization against a reference solution , you will develop a practical appreciation for the challenges of DOM and the importance of angular resolution in problems with strong directional dependencies.",
            "id": "3988576",
            "problem": "Consider a two-dimensional, steady, gray, non-emitting, plane medium in which a collimated radiative beam enters through a narrow slit at the left boundary. The medium is low-scattering, and for this benchmark you will assume negligible scattering. The governing equation for the radiative intensity in the absence of scattering is the steady, absorption-only Radiative Transfer Equation (RTE): $$\\frac{d I(\\mathbf{x},\\mathbf{s})}{ds} = - \\kappa I(\\mathbf{x},\\mathbf{s}),$$ where $I$ is the radiative intensity, $\\kappa$ is the absorption coefficient (assumed constant), $\\mathbf{s}$ is the propagation direction, and $s$ is the pathlength along $\\mathbf{s}$. The analytical solution for a collimated beam along a straight characteristic with initial intensity $I_0$ is $$I(s) = I_0 e^{-\\kappa s}.$$ The volumetric absorption source is $$\\dot{q}_{\\mathrm{abs}}(\\mathbf{x}) = \\kappa \\int_{4\\pi} I(\\mathbf{x},\\mathbf{s}) \\, d\\Omega.$$ In the collimated case with a single direction, this reduces to $$\\dot{q}_{\\mathrm{abs}}(\\mathbf{x}) = \\kappa I(\\mathbf{x},\\mathbf{s}_0),$$ within the beam tube and zero elsewhere, where $\\mathbf{s}_0$ is the true beam direction.\n\nIn the Discrete Ordinates Method (DOM), the angular domain is discretized into a finite set of directions. Ray effects arise when a sparse angular quadrature forces energy transport along discrete directions that do not match the true beam direction, producing spurious streaks. In this problem, you will quantify ray effects by comparing a coarse-angular DOM approximation that replaces the true beam direction by its nearest discrete ordinate to a high-resolution angular reference that uses the exact beam angle.\n\nDefine a rectangular domain with width $L_x$ and height $L_y$. A collimated beam of finite slit width $w$ enters at the left boundary at the entry point $(x_0,y_0)=(0, L_y/2)$ and propagates into the domain along the direction $\\mathbf{d}_0 = (\\cos\\theta_0,\\sin\\theta_0)$, where $\\theta_0$ is the beam angle measured from the positive $x$-axis. The beam is uniform across the slit width $w$ and has initial intensity $I_0$ at $s=0$. For any point $(x,y)$, let $\\mathbf{r}=(x-x_0, y-y_0)$, the longitudinal coordinate be $t = \\mathbf{r}\\cdot \\mathbf{d}$ along a direction $\\mathbf{d}$, and the lateral distance to the beam centerline be $$\\rho = \\left\\| \\mathbf{r} - t \\mathbf{d} \\right\\|.$$ A point is inside the beam tube if $0 \\le t \\le t_{\\mathrm{exit}}(\\mathbf{d})$ and $\\rho \\le w/2$, where $t_{\\mathrm{exit}}(\\mathbf{d})$ is the pathlength from $(x_0,y_0)$ to the first exit intersection with the domain boundary along $\\mathbf{d}$. The absorption source for a given direction $\\mathbf{d}$ is then $$\\dot{q}_{\\mathrm{abs}}(x,y;\\mathbf{d}) = \\begin{cases} \\kappa I_0 e^{-\\kappa t},  \\text{if } 0 \\le t \\le t_{\\mathrm{exit}}(\\mathbf{d}) \\text{ and } \\rho \\le w/2, \\\\ 0,  \\text{otherwise.}\\end{cases}$$\n\nYou are to compute a Ray Effect Index (REI), defined as the normalized root-mean-square deviation of the coarse-angular DOM absorption field from the high-resolution angular reference field: $$\\mathrm{REI} = \\sqrt{\\frac{\\sum_{i,j} \\left(\\dot{q}_{\\mathrm{abs}}^{\\mathrm{coarse}}(x_i,y_j) - \\dot{q}_{\\mathrm{abs}}^{\\mathrm{ref}}(x_i,y_j)\\right)^2}{\\sum_{i,j} \\left(\\dot{q}_{\\mathrm{abs}}^{\\mathrm{ref}}(x_i,y_j)\\right)^2}}.$$ The reference field uses the true direction $\\mathbf{d}_0$, while the coarse DOM field uses the nearest discrete ordinate direction $\\mathbf{d}_{\\mathrm{coarse}}$ from a uniform angular set of $N$ directions over $[0,\\pi)$: $$\\theta_n = \\frac{n\\pi}{N}, \\quad n=0,1,\\dots,N-1.$$\n\nAlgorithmic requirements:\n- Discretize the domain into a uniform Cartesian grid of $N_x \\times N_y$ cell centers.\n- For each test case, compute $\\dot{q}_{\\mathrm{abs}}^{\\mathrm{ref}}$ using $\\mathbf{d}_0$ and $\\dot{q}_{\\mathrm{abs}}^{\\mathrm{coarse}}$ using $\\mathbf{d}_{\\mathrm{coarse}}$ at all grid points via the expressions above.\n- Compute $\\mathrm{REI}$ as a dimensionless float.\n\nUnits and numerical specifications:\n- Use $L_x$ and $L_y$ in meters, $w$ in meters, $\\kappa$ in inverse meters, and $I_0$ in watts per square meter per steradian. Angles must be specified in radians. The output REI is dimensionless.\n- Use $N_x=200$ and $N_y=200$ grid points for all cases.\n- Use $I_0=1$.\n\nTest suite:\n- Case A (general): $(L_x,L_y,\\kappa,w,\\theta_0,N) = (1,1,2,0.02,\\pi/6,8)$.\n- Case B (aligned): $(L_x,L_y,\\kappa,w,\\theta_0,N) = (1,1,2,0.02,\\pi/4,8)$.\n- Case C (edge): $(L_x,L_y,\\kappa,w,\\theta_0,N) = (2,1,0.1,0.01,\\pi/9,4)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each $\\mathrm{REI}$ reported as a decimal float rounded to six decimal places in the order [Case A, Case B, Case C], for example: \"[0.123456,0.000000,0.654321]\".",
            "solution": "The problem is valid. It presents a well-posed, scientifically grounded computational task in the field of radiative heat transfer, complete with all necessary definitions, parameters, and constraints.\n\nThe objective is to quantify the \"ray effect,\" a numerical artifact in the Discrete Ordinates Method (DOM) for solving the Radiative Transfer Equation (RTE). This is accomplished by calculating a Ray Effect Index (REI), which measures the deviation of an approximate solution using a coarse angular discretization from a high-resolution reference solution.\n\nThe physical scenario involves a steady, two-dimensional, non-emitting, purely absorbing, gray medium. The governing equation is the absorption-only RTE:\n$$\n\\frac{d I(\\mathbf{x},\\mathbf{s})}{ds} = - \\kappa I(\\mathbf{x},\\mathbf{s})\n$$\nwhere $I$ is the radiative intensity, $\\kappa$ is the constant absorption coefficient, $\\mathbf{s}$ is the direction vector, and $s$ is the pathlength. For a collimated beam with initial intensity $I_0$, the solution is Beer's law:\n$$\nI(s) = I_0 e^{-\\kappa s}\n$$\nThe volumetric absorption source, $\\dot{q}_{\\mathrm{abs}}(\\mathbf{x})$, is the rate of energy absorbed per unit volume. For a single collimated beam, this is non-zero only within the beam's geometric confines and is given by $\\dot{q}_{\\mathrm{abs}}(\\mathbf{x}) = \\kappa I(\\mathbf{x}, \\mathbf{s}_0)$, where $\\mathbf{s}_0$ is the beam's propagation direction.\n\nThe algorithm proceeds as follows:\n\n1.  **Domain and Grid Discretization**:\n    The rectangular domain $[0, L_x] \\times [0, L_y]$ is discretized into a uniform Cartesian grid of $N_x \\times N_y$ cells. The center of each cell $(i,j)$ is located at coordinates $(x_i, y_j)$, where $i \\in \\{0, 1, \\dots, N_x-1\\}$ and $j \\in \\{0, 1, \\dots, N_y-1\\}$.\n\n2.  **Direction Specification**:\n    *   **Reference Direction**: The reference field, $\\dot{q}_{\\mathrm{abs}}^{\\mathrm{ref}}$, is computed using the true beam direction $\\mathbf{d}_{\\mathrm{ref}} = (\\cos\\theta_0, \\sin\\theta_0)$.\n    *   **Coarse DOM Direction**: The set of $N$ discrete angles is given by $\\theta_n = \\frac{n\\pi}{N}$ for $n \\in \\{0, 1, \\dots, N-1\\}$. The coarse direction vector, $\\mathbf{d}_{\\mathrm{coarse}}$, corresponds to the angle $\\theta_{\\mathrm{coarse}}$ from this set that is closest to the true angle $\\theta_0$. This is found by minimizing $|\\theta_n - \\theta_0|$.\n\n3.  **Computation of the Absorption Field**:\n    For a given direction $\\mathbf{d} = (d_x, d_y)$ and for each grid point $(x_i, y_j)$, we compute the absorption source $\\dot{q}_{\\mathrm{abs}}(x_i, y_j; \\mathbf{d})$. The problem provides the formula:\n    $$\n    \\dot{q}_{\\mathrm{abs}}(x,y;\\mathbf{d}) = \\begin{cases} \\kappa I_0 e^{-\\kappa t},  \\text{if } 0 \\le t \\le t_{\\mathrm{exit}}(\\mathbf{d}) \\text{ and } \\rho \\le w/2 \\\\ 0,  \\text{otherwise}\\end{cases}\n    $$\n    The quantities in this formula are determined as follows:\n    *   The beam enters at $(x_0, y_0) = (0, L_y/2)$. The position vector from the entry point to a grid point is $\\mathbf{r} = (x_i - x_0, y_j - y_0)$.\n    *   The longitudinal distance (pathlength) $t$ along the beam's central axis is the projection of $\\mathbf{r}$ onto $\\mathbf{d}$: $t = \\mathbf{r} \\cdot \\mathbf{d} = (x_i - x_0)d_x + (y_j - y_0)d_y$.\n    *   The lateral distance $\\rho$ from the grid point to the central axis is the magnitude of the component of $\\mathbf{r}$ perpendicular to $\\mathbf{d}$. This can be computed efficiently as the magnitude of the 2D cross product: $\\rho = |(x_i - x_0)d_y - (y_j - y_0)d_x|$.\n    *   The exit pathlength $t_{\\mathrm{exit}}(\\mathbf{d})$ is the distance from $(x_0, y_0)$ to the boundary of the domain $[0, L_x] \\times [0, L_y]$ along the direction $\\mathbf{d}$. Since the beam enters from the left ($x=0$) and propagates into the domain, we consider intersections with boundaries $x=L_x$, $y=0$, and $y=L_y$. The applicable pathlengths are $t_{x} = L_x / d_x$ (for $d_x>0$) and $t_{y} = (L_y-y_0)/d_y$ (for $d_y>0$) or $t_{y} = (0-y_0)/d_y$ (for $d_y0$). $t_{\\mathrm{exit}}$ is the minimum of these positive pathlengths.\n\n4.  **Calculation of the Ray Effect Index (REI)**:\n    The REI is computed by first generating the entire absorption field for both the reference direction ($\\dot{q}_{\\mathrm{abs}}^{\\mathrm{ref}}$) and the coarse direction ($\\dot{q}_{\\mathrm{abs}}^{\\mathrm{coarse}}$) on the $N_x \\times N_y$ grid. The REI is then the normalized root-mean-square deviation:\n    $$\n    \\mathrm{REI} = \\sqrt{\\frac{\\sum_{i,j} \\left(\\dot{q}_{\\mathrm{abs}}^{\\mathrm{coarse}}(x_i,y_j) - \\dot{q}_{\\mathrm{abs}}^{\\mathrm{ref}}(x_i,y_j)\\right)^2}{\\sum_{i,j} \\left(\\dot{q}_{\\mathrm{abs}}^{\\mathrm{ref}}(x_i,y_j)\\right)^2}}\n    $$\n    The summations extend over all $N_x \\times N_y$ grid points. For Case B, $\\theta_0$ is one of the discrete angles, so $\\theta_{\\mathrm{coarse}}=\\theta_{\\mathrm{ref}}$. This makes $\\dot{q}_{\\mathrm{abs}}^{\\mathrm{coarse}} = \\dot{q}_{\\mathrm{abs}}^{\\mathrm{ref}}$, and the numerator becomes $0$, yielding an REI of $0$. For other cases, a non-zero REI is expected, quantifying the error introduced by the angular discretization. The calculation is performed for each test case using the specified parameters.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a Ray Effect Index (REI) for a collimated radiation beam problem\n    by comparing a coarse angular approximation to a high-resolution reference.\n    \"\"\"\n\n    # Define constants from the problem.\n    I0 = 1.0  # W/m^2/sr\n    Nx = 200\n    Ny = 200\n\n    def compute_q_abs_field(Lx, Ly, kappa, w, theta, Nx, Ny):\n        \"\"\"\n        Computes the volumetric absorption source field for a given beam direction.\n\n        Args:\n            Lx (float): Domain width [m].\n            Ly (float): Domain height [m].\n            kappa (float): Absorption coefficient [1/m].\n            w (float): Beam slit width [m].\n            theta (float): Beam angle [radians] from the positive x-axis.\n            Nx (int): Number of grid points in x.\n            Ny (int): Number of grid points in y.\n\n        Returns:\n            numpy.ndarray: A 2D array of the absorption source field.\n        \"\"\"\n        # Beam entry point\n        x0, y0 = 0.0, Ly / 2.0\n\n        # Create grid of cell centers\n        dx, dy = Lx / Nx, Ly / Ny\n        x_pts = np.linspace(dx / 2, Lx - dx / 2, Nx)\n        y_pts = np.linspace(dy / 2, Ly - dy / 2, Ny)\n        xx, yy = np.meshgrid(x_pts, y_pts, indexing='xy')\n\n        # Direction vector components\n        dx_dir, dy_dir = np.cos(theta), np.sin(theta)\n\n        # Calculate exit pathlength t_exit\n        # The beam enters at x=0 and propagates into the domain.\n        t_exits_possible = []\n        if dx_dir > 1e-12:  # Avoid division by zero\n            t_exits_possible.append(Lx / dx_dir)\n        if dy_dir > 1e-12:  # Beam propagating towards y=Ly\n            t_exits_possible.append((Ly - y0) / dy_dir)\n        elif dy_dir  -1e-12:  # Beam propagating towards y=0\n            t_exits_possible.append((0 - y0) / dy_dir)\n\n        if not t_exits_possible:\n            # This case occurs if direction vector is (0,0), which is not possible\n            # for a unit vector, or if the direction is out of the domain.\n            # For the given problem, this branch will not be taken.\n            t_exit = np.inf\n        else:\n            t_exit = min(t_exits_possible)\n\n        # Vectorized calculation for all grid points\n        # Position vector from entry point to each grid point\n        rx = xx - x0\n        ry = yy - y0\n\n        # Longitudinal coordinate 't'\n        t = rx * dx_dir + ry * dy_dir\n\n        # Lateral distance 'rho' using 2D cross-product magnitude\n        rho = np.abs(rx * dy_dir - ry * dx_dir)\n\n        # Apply conditions to find points within the beam tube\n        mask = (t >= 0)  (t = t_exit)  (rho = w / 2.0)\n\n        # Initialize absorption field with zeros\n        q_abs = np.zeros_like(xx)\n        \n        # Calculate absorption source for points inside the beam\n        t_masked = t[mask]\n        q_abs[mask] = kappa * I0 * np.exp(-kappa * t_masked)\n\n        return q_abs\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Lx, Ly, kappa, w, theta_0, N)\n        (1.0, 1.0, 2.0, 0.02, np.pi/6, 8),  # Case A\n        (1.0, 1.0, 2.0, 0.02, np.pi/4, 8),  # Case B\n        (2.0, 1.0, 0.1, 0.01, np.pi/9, 4),  # Case C\n    ]\n\n    results = []\n    for case in test_cases:\n        Lx, Ly, kappa, w, theta0, N = case\n\n        # --- Reference Field Calculation ---\n        # The reference field uses the true beam angle\n        q_ref = compute_q_abs_field(Lx, Ly, kappa, w, theta0, Nx, Ny)\n\n        # --- Coarse DOM Field Calculation ---\n        # Find the nearest discrete ordinate angle\n        thetas_discrete = np.arange(N) * np.pi / N\n        idx_coarse = np.abs(thetas_discrete - theta0).argmin()\n        theta_coarse = thetas_discrete[idx_coarse]\n        \n        # The coarse field uses the nearest discrete angle\n        q_coarse = compute_q_abs_field(Lx, Ly, kappa, w, theta_coarse, Nx, Ny)\n\n        # --- Compute Ray Effect Index (REI) ---\n        # Sum of squared differences\n        numerator = np.sum(np.square(q_coarse - q_ref))\n        # Sum of squares of the reference field\n        denominator = np.sum(np.square(q_ref))\n\n        # The denominator should not be zero for this problem, but check as a safeguard.\n        if denominator  1e-12:\n            # This occurs if the reference field is zero everywhere,\n            # or if both coarse and ref are zero (numerator=0).\n            rei = 0.0\n        else:\n            rei = np.sqrt(numerator / denominator)\n        \n        results.append(rei)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}