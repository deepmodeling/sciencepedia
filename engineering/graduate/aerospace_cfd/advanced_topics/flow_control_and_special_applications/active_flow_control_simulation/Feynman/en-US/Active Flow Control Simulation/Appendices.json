{
    "hands_on_practices": [
        {
            "introduction": "To effectively simulate active flow control, we must first model the actuator's influence on the flow, and a crucial step is to quantify the actuator's strength using a standardized, dimensionless parameter. This practice guides you through deriving the momentum coefficient, $C_\\mu$, from first principles for a synthetic jet actuator, providing a fundamental tool for setting up and interpreting AFC simulations. This exercise is based on a hypothetical model that simplifies the jet's behavior to clearly illustrate the derivation, focusing on the underlying principles of momentum flux and non-dimensionalization.",
            "id": "3941259",
            "problem": "Consider a Synthetic Jet Actuator (SJA) embedded flush on the surface of a high-lift airfoil section in a Computational Fluid Dynamics (CFD) simulation. The actuator is modeled as a time-periodic wall-normal velocity boundary condition applied over a slot of area $A_{j}$, with a spatially uniform profile across the slot and zero mean mass flux over one actuation period. Specifically, the wall-normal velocity at the slot is prescribed as $v_{j}(t) = V_{a}\\sin(\\omega t)$, where $V_{a}$ is the peak amplitude and $\\omega$ is the angular frequency. The external freestream is uniform with speed $U_{\\infty}$, density $\\rho_{\\infty}$, and a chosen aerodynamic reference area $S$ associated with the controlled surface patch. The jet fluid density is $\\rho_{j}$. Assume the actuator produces an outward jet only during the blowing half-cycle (i.e., when $v_{j}(t) > 0$), and that suction during the other half-cycle does not inject momentum into the external flow.\n\nStarting from the Reynolds Transport Theorem (RTT) for linear momentum applied to a pillbox control volume that straddles the slot and using first-principles definitions of fluxes, derive the time-averaged outward momentum input to the external flow over one actuation period in terms of $\\rho_{j}$, $A_{j}$, and $v_{j}(t)$. Using this result, define the dimensionless momentum coefficient $C_{\\mu}$ as the ratio of the time-averaged outward momentum input to the freestream dynamic pressure scale times $S$, and obtain a closed-form expression for $C_{\\mu}$ in terms of $\\rho_{j}$, $\\rho_{\\infty}$, $U_{\\infty}$, $A_{j}$, $S$, and $V_{a}$ for the given sinusoidal actuation. Then, for air with $\\rho_{\\infty} = \\rho_{j} = $ $1.2$ kg/m$^{3}$, freestream speed $U_{\\infty} = $ $30$ m/s, slot area $A_{j} = $ $5.0 \\times 10^{-5}$ m$^{2}$, actuation amplitude $V_{a} = $ $100$ m/s, and reference area $S = $ $0.10$ m$^{2}$, compute the numerical value of $C_{\\mu}$. Express the final answer as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Actuator Model**: Synthetic Jet Actuator (SJA) with a time-periodic wall-normal velocity boundary condition.\n- **Slot Area**: $A_{j}$.\n- **Velocity Profile**: Spatially uniform across the slot.\n- **Actuation Velocity**: $v_{j}(t) = V_{a}\\sin(\\omega t)$.\n- **Peak Velocity**: $V_{a}$.\n- **Angular Frequency**: $\\omega$.\n- **Mean Mass Flux**: Zero over one actuation period.\n- **Momentum Input Condition**: Outward momentum is produced only during the blowing half-cycle, where $v_{j}(t) > 0$. Suction half-cycle injects no momentum.\n- **Freestream Speed**: $U_{\\infty}$.\n- **Freestream Density**: $\\rho_{\\infty}$.\n- **Jet Fluid Density**: $\\rho_{j}$.\n- **Aerodynamic Reference Area**: $S$.\n- **Task**:\n    1. Derive the time-averaged outward momentum input over one actuation period, $T$.\n    2. Define the dimensionless momentum coefficient $C_{\\mu}$ as the ratio of the time-averaged outward momentum input to the freestream dynamic pressure scale times $S$.\n    3. Obtain a closed-form expression for $C_{\\mu}$.\n    4. Compute the numerical value of $C_{\\mu}$ for the given data.\n- **Numerical Data**:\n    - $\\rho_{\\infty} = \\rho_{j} = 1.2$ kg/m$^{3}$.\n    - $U_{\\infty} = 30$ m/s.\n    - $A_{j} = 5.0 \\times 10^{-5}$ m$^{2}$.\n    - $V_{a} = 100$ m/s.\n    - $S = 0.10$ m$^{2}$.\n- **Rounding Requirement**: The final numerical answer must be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, employing standard principles of fluid dynamics such as the Reynolds Transport Theorem, momentum flux, and dimensionless analysis (momentum coefficient $C_{\\mu}$). The model of a synthetic jet actuator as a sinusoidal velocity boundary condition is a common and valid simplification in computational fluid dynamics (CFD). The problem is well-posed, providing all necessary definitions, variables, and numerical values to arrive at a unique solution. The language is objective and precise. The distinction between the zero-net-mass-flux nature of an SJA and the definition of $C_{\\mu}$ based only on the blowing stroke is a standard convention in the aerospace field for characterizing the actuator's momentum-imparting capability to the external flow. All numerical values are physically plausible for a typical low-speed aerodynamic application. The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe first step is to derive the time-averaged outward momentum input to the flow. The instantaneous momentum flux is the product of the mass flow rate and the velocity of the jet. The mass flow rate, $\\dot{m}(t)$, from the slot is given by $\\dot{m}(t) = \\rho_{j} A_{j} v_{j}(t)$, where the velocity profile is assumed uniform across the slot area $A_{j}$. The instantaneous rate of momentum input (momentum flux), $\\dot{M}(t)$, is then:\n$$\n\\dot{M}(t) = \\dot{m}(t) v_{j}(t) = \\left(\\rho_{j} A_{j} v_{j}(t)\\right) v_{j}(t) = \\rho_{j} A_{j} \\left[v_{j}(t)\\right]^{2}\n$$\nSubstituting the given sinusoidal velocity function, $v_{j}(t) = V_{a}\\sin(\\omega t)$:\n$$\n\\dot{M}(t) = \\rho_{j} A_{j} \\left(V_{a}\\sin(\\omega t)\\right)^{2} = \\rho_{j} A_{j} V_{a}^{2} \\sin^{2}(\\omega t)\n$$\nThe problem specifies that momentum is input to the external flow only during the blowing half-cycle, i.e., when $v_{j}(t) > 0$. For the function $\\sin(\\omega t)$, this corresponds to the time interval $t \\in [0, T/2]$, where $T = 2\\pi/\\omega$ is the actuation period. During the suction half-cycle, $t \\in (T/2, T]$, the momentum input is considered zero.\n\nThe time-averaged outward momentum input, which we denote as $\\bar{M}$, is the total momentum input over one full period $T$, divided by the period itself.\n$$\n\\bar{M} = \\frac{1}{T} \\int_{0}^{T} \\dot{M}_{\\text{outward}}(t) \\, dt\n$$\nBased on the problem statement, this becomes:\n$$\n\\bar{M} = \\frac{1}{T} \\left[ \\int_{0}^{T/2} \\rho_{j} A_{j} V_{a}^{2} \\sin^{2}(\\omega t) \\, dt + \\int_{T/2}^{T} 0 \\, dt \\right] = \\frac{\\rho_{j} A_{j} V_{a}^{2}}{T} \\int_{0}^{T/2} \\sin^{2}(\\omega t) \\, dt\n$$\nTo evaluate the integral, we use the trigonometric identity $\\sin^{2}(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$:\n$$\n\\int_{0}^{T/2} \\sin^{2}(\\omega t) \\, dt = \\int_{0}^{T/2} \\frac{1 - \\cos(2\\omega t)}{2} \\, dt = \\frac{1}{2} \\left[ t - \\frac{\\sin(2\\omega t)}{2\\omega} \\right]_{0}^{T/2}\n$$\nSubstituting the limits of integration:\n$$\n\\frac{1}{2} \\left[ \\left(\\frac{T}{2} - \\frac{\\sin(2\\omega(T/2))}{2\\omega}\\right) - \\left(0 - \\frac{\\sin(0)}{2\\omega}\\right) \\right]\n$$\nSince $T=2\\pi/\\omega$, the argument of the sine function becomes $2\\omega(T/2) = \\omega T = 2\\pi$. As $\\sin(2\\pi)=0$ and $\\sin(0)=0$, the integral simplifies to:\n$$\n\\frac{1}{2} \\left[ \\frac{T}{2} - 0 \\right] = \\frac{T}{4}\n$$\nSubstituting this result back into the expression for $\\bar{M}$:\n$$\n\\bar{M} = \\frac{\\rho_{j} A_{j} V_{a}^{2}}{T} \\left( \\frac{T}{4} \\right) = \\frac{1}{4} \\rho_{j} A_{j} V_{a}^{2}\n$$\nThis is the time-averaged outward momentum input.\n\nNext, we define the dimensionless momentum coefficient, $C_{\\mu}$. The problem defines it as the ratio of the time-averaged outward momentum input to the freestream momentum scale, which is the product of the freestream dynamic pressure, $q_{\\infty} = \\frac{1}{2}\\rho_{\\infty}U_{\\infty}^{2}$, and the reference area, $S$.\n$$\nC_{\\mu} = \\frac{\\bar{M}}{q_{\\infty} S} = \\frac{\\bar{M}}{\\frac{1}{2} \\rho_{\\infty} U_{\\infty}^{2} S}\n$$\nSubstituting our derived expression for $\\bar{M}$:\n$$\nC_{\\mu} = \\frac{\\frac{1}{4} \\rho_{j} A_{j} V_{a}^{2}}{\\frac{1}{2} \\rho_{\\infty} U_{\\infty}^{2} S} = \\frac{1}{2} \\frac{\\rho_{j} A_{j} V_{a}^{2}}{\\rho_{\\infty} S U_{\\infty}^{2}}\n$$\nThis is the closed-form expression for $C_{\\mu}$.\n\nFinally, we compute the numerical value of $C_{\\mu}$ using the provided data:\n$\\rho_{j} = 1.2$ kg/m$^{3}$\n$\\rho_{\\infty} = 1.2$ kg/m$^{3}$\n$A_{j} = 5.0 \\times 10^{-5}$ m$^{2}$\n$V_{a} = 100$ m/s\n$U_{\\infty} = 30$ m/s\n$S = 0.10$ m$^{2}$\n\nSubstituting these values into the expression for $C_{\\mu}$:\n$$\nC_{\\mu} = \\frac{1}{2} \\frac{(1.2) \\cdot (5.0 \\times 10^{-5}) \\cdot (100)^{2}}{(1.2) \\cdot (0.10) \\cdot (30)^{2}}\n$$\nSince $\\rho_{j} = \\rho_{\\infty}$, the density terms cancel.\n$$\nC_{\\mu} = \\frac{1}{2} \\frac{(5.0 \\times 10^{-5}) \\cdot (10000)}{(0.10) \\cdot (900)}\n$$\n$$\nC_{\\mu} = \\frac{1}{2} \\frac{5.0 \\times 10^{-1}}{90} = \\frac{0.5}{180} = \\frac{1}{360}\n$$\nConverting this fraction to a decimal:\n$$\nC_{\\mu} = 0.002777...\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nC_{\\mu} \\approx 0.002778\n$$\nThis can also be expressed in scientific notation as $2.778 \\times 10^{-3}$.",
            "answer": "$$\n\\boxed{2.778 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "Active flow control actuators can introduce physical effects beyond simple momentum addition, such as heating, which is particularly relevant for devices like Dielectric Barrier Discharge (DBD) plasma actuators. This practice explores how to assess the importance of such secondary effects, specifically thermal buoyancy, using a thought experiment grounded in scaling analysis of the boundary layer equations. By evaluating the local Richardson number under hypothetical heating conditions, you will develop a principled approach to decide whether these multi-physics couplings are significant enough to be included in a CFD simulation.",
            "id": "3941323",
            "problem": "You are tasked with constructing a principled evaluation of buoyancy effects in a low-speed heated boundary layer by incorporating a Boussinesq term into the momentum equation and quantifying its relevance for heat loads representative of Dielectric Barrier Discharge (DBD) plasma actuators used in Computational Fluid Dynamics (CFD)-based active flow control simulations. The objective is to design and implement a program that, using first-principles scaling of the boundary layer energy balance, computes a dimensionless measure of buoyancy significance and assesses the validity of the Boussinesq approximation for given operating conditions.\n\nBegin from the incompressible Navier–Stokes equations and the thermal energy equation for a Newtonian fluid:\n- The continuity equation is $ \\nabla \\cdot \\mathbf{u} = 0 $.\n- The momentum equation, under the Boussinesq approximation, adds a buoyancy source in the wall-normal direction with $ \\rho \\mathbf{g} \\approx \\rho_0 \\left( 1 - \\beta (T - T_0) \\right) \\mathbf{g} $, where $ \\beta $ is the thermal expansion coefficient and $ T_0 $ is a reference temperature, yielding an effective acceleration term $ \\mathbf{a}_b = \\beta g (T - T_0) \\mathbf{e}_y $.\n- The thermal energy equation in the boundary layer can be written as $ \\mathbf{u} \\cdot \\nabla T = \\alpha \\nabla^2 T $, where $ \\alpha $ is the thermal diffusivity.\n\nUse the following fundamental scaling argument for a steady, two-dimensional, laminar forced-convection boundary layer with external velocity $ U_\\infty $ along a flat plate from the leading edge:\n1. Balance of streamwise advection and cross-stream diffusion in the thermal boundary layer gives $ U_\\infty \\, \\partial T/\\partial x \\sim \\alpha \\, \\partial^2 T/\\partial y^2 $, which implies a thermal boundary layer thickness $ \\delta_T $ satisfying $ U_\\infty \\, \\Delta T / x \\sim \\alpha \\, \\Delta T / \\delta_T^2 $ and therefore $$ \\delta_T \\sim \\sqrt{\\frac{\\alpha x}{U_\\infty}}. $$\n2. A prescribed uniform wall heat flux $ q'' $ across the thermal boundary layer scales as $ q'' \\sim k \\, \\Delta T / \\delta_T $, where $ k $ is the thermal conductivity and $ \\Delta T = T_w - T_\\infty $ is the characteristic temperature rise between the wall and the free stream. This yields $$ \\Delta T \\sim \\frac{q'' \\, \\delta_T}{k}. $$\n3. The Boussinesq buoyancy acceleration magnitude is then $ a_b = g \\, \\beta \\, \\Delta T $, where $ g $ is the gravitational acceleration and $ \\beta $ is the thermal expansion coefficient.\n4. To assess the relevance of buoyancy relative to inertial forces in the boundary layer, use the local Richardson number defined by $$ \\mathrm{Ri}_x = \\frac{a_b \\, x}{U_\\infty^2} = \\frac{g \\, \\beta \\, \\Delta T \\, x}{U_\\infty^2}, $$ which compares buoyant forcing to convective inertia. A small value of $ \\mathrm{Ri}_x $ indicates weak buoyancy effects; larger values indicate stronger buoyancy coupling.\n5. The validity of the Boussinesq approximation requires $ \\left| \\beta \\, \\Delta T \\right| \\ll 1 $. For practical assessment, declare the approximation valid if $ \\left| \\beta \\, \\Delta T \\right| \\le 0.1 $ and invalid otherwise.\n\nImplement a program that, for each test case in the provided suite, computes:\n- The thermal boundary layer thickness $ \\delta_T $ using $ \\delta_T = \\sqrt{\\alpha x / U_\\infty} $.\n- The temperature rise $ \\Delta T $ using $ \\Delta T = q'' \\, \\delta_T / k $.\n- The buoyant acceleration magnitude $ a_b $ using $ a_b = g \\, \\beta \\, \\Delta T $.\n- The local Richardson number $ \\mathrm{Ri}_x $ using $ \\mathrm{Ri}_x = a_b \\, x / U_\\infty^2 $.\n- A boolean indicating Boussinesq validity using $ \\left| \\beta \\, \\Delta T \\right| \\le 0.1 $.\n\nUse the following fluid properties for air at standard conditions:\n- Density $ \\rho = 1.2 \\, \\mathrm{kg/m^3} $.\n- Specific heat at constant pressure $ c_p = 1005 \\, \\mathrm{J/(kg \\cdot K)} $.\n- Thermal conductivity $ k = 0.026 \\, \\mathrm{W/(m \\cdot K)} $.\n- Kinematic viscosity $ \\nu = 1.5 \\times 10^{-5} \\, \\mathrm{m^2/s} $.\n- Thermal diffusivity $ \\alpha = k / (\\rho c_p) $.\n- Free-stream temperature $ T_\\infty = 300 \\, \\mathrm{K} $.\n- Thermal expansion coefficient $ \\beta = 1/T_\\infty $.\n- Gravitational acceleration $ g = 9.81 \\, \\mathrm{m/s^2} $.\n\nTest suite:\n- Case A (happy path): $ U_\\infty = 5 \\, \\mathrm{m/s} $, $ x = 0.05 \\, \\mathrm{m} $, $ q'' = 1000 \\, \\mathrm{W/m^2} $.\n- Case B (strong heating, lower speed): $ U_\\infty = 2 \\, \\mathrm{m/s} $, $ x = 0.1 \\, \\mathrm{m} $, $ q'' = 2000 \\, \\mathrm{W/m^2} $.\n- Case C (higher speed, moderate heating): $ U_\\infty = 20 \\, \\mathrm{m/s} $, $ x = 0.1 \\, \\mathrm{m} $, $ q'' = 1000 \\, \\mathrm{W/m^2} $.\n- Case D (edge case, no heating): $ U_\\infty = 5 \\, \\mathrm{m/s} $, $ x = 0.1 \\, \\mathrm{m} $, $ q'' = 0 \\, \\mathrm{W/m^2} $.\n\nUnits:\n- Report $ a_b $ in $ \\mathrm{m/s^2} $.\n- Report $ \\Delta T $ in $ \\mathrm{K} $.\n- $ \\mathrm{Ri}_x $ is dimensionless.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the form $ [\\mathrm{Ri}_x, a_b, \\Delta T, \\text{valid}] $. Represent the floating-point values rounded to six decimal places, and the validity as a boolean. For example, the output format is $ [[r_1,a_1,\\Delta T_1,v_1],[r_2,a_2,\\Delta T_2,v_2],...] $.",
            "solution": "We begin from the incompressible flow framework appropriate to low-speed aerodynamics. The continuity equation is $ \\nabla \\cdot \\mathbf{u} = 0 $. The momentum equation for a Newtonian fluid includes pressure, viscous diffusion, and external body forces. Under the Boussinesq approximation, density variations are neglected in all terms except in the buoyancy force, leading to the effective body force $ \\rho \\mathbf{g} \\approx \\rho_0 \\left( 1 - \\beta (T - T_0) \\right) \\mathbf{g} $. The buoyancy contribution in the wall-normal direction thus acts as $ \\rho_0 \\beta (T - T_0) g $/unit volume, and appears as an acceleration $ a_b = g \\beta (T - T_0) $ in the wall-normal momentum equation.\n\nThe energy equation for a steady, two-dimensional boundary layer over a flat plate is $ \\mathbf{u} \\cdot \\nabla T = \\alpha \\nabla^2 T $, where $ \\alpha = k / (\\rho c_p) $ is the thermal diffusivity. For a flat plate with uniform external speed $ U_\\infty $ in the streamwise direction $ x $ and temperature variations confined within a thermal boundary layer of thickness $ \\delta_T $, we construct a scaling analysis. The advection term scales as $ U_\\infty \\partial T/\\partial x \\sim U_\\infty \\Delta T / x $, and the cross-stream diffusion term scales as $ \\alpha \\partial^2 T/\\partial y^2 \\sim \\alpha \\Delta T / \\delta_T^2 $. Setting these of the same order for a steady boundary layer yields \n$$ U_\\infty \\frac{\\Delta T}{x} \\sim \\alpha \\frac{\\Delta T}{\\delta_T^2} \\quad \\Rightarrow \\quad \\delta_T \\sim \\sqrt{\\frac{\\alpha x}{U_\\infty}}. $$\nThe net convective effect of a uniform wall heat flux $ q'' $ across $ \\delta_T $ can be related to the temperature gradient via Fourier’s law. A scaling form is $ q'' \\sim k \\Delta T / \\delta_T $, which rearranges to \n$$ \\Delta T \\sim \\frac{q'' \\delta_T}{k}. $$\nCombining these results gives $ \\Delta T \\sim \\frac{q''}{k} \\sqrt{\\frac{\\alpha x}{U_\\infty}} $. The Boussinesq buoyant acceleration is \n$$ a_b = g \\beta \\Delta T = g \\beta \\frac{q'' \\delta_T}{k}. $$\nTo compare buoyancy forcing with inertial effects in the forced boundary layer, a local Richardson number can be defined as the ratio of buoyancy-induced acceleration acting over a streamwise length $ x $ to the characteristic inertial acceleration $ U_\\infty^2/x $, namely\n$$ \\mathrm{Ri}_x = \\frac{a_b x}{U_\\infty^2} = \\frac{g \\beta \\Delta T x}{U_\\infty^2}. $$\nThis form is consistent with the classical mixed-convection $ \\mathrm{Ri} $ parameter because $ \\mathrm{Ri}_x = \\mathrm{Gr}_x/\\mathrm{Re}_x^2 $ simplifies to $ g \\beta \\Delta T x / U_\\infty^2 $ under laminar scaling, but here we compute $ \\Delta T $ via the thermal boundary layer diffusion-advection balance rather than invoking empirical heat transfer correlations. The Boussinesq approximation is justified when \n$$ \\left| \\beta \\Delta T \\right| \\ll 1. $$\nFor practical evaluation, we adopt the criterion $ \\left| \\beta \\Delta T \\right| \\le 0.1 $ as an indicator of validity.\n\nAlgorithmic steps for each test case:\n1. Compute thermal diffusivity $ \\alpha = k / (\\rho c_p) $.\n2. Compute $ \\delta_T = \\sqrt{\\alpha x / U_\\infty} $, which is the thermal boundary layer thickness scale.\n3. Compute wall-to-free-stream temperature rise $ \\Delta T = q'' \\delta_T / k $.\n4. Compute buoyant acceleration magnitude $ a_b = g \\beta \\Delta T $, with $ \\beta = 1/T_\\infty $ for ideal gas near constant pressure.\n5. Compute $ \\mathrm{Ri}_x = a_b x / U_\\infty^2 $.\n6. Evaluate Boussinesq validity as a boolean $ \\left| \\beta \\Delta T \\right| \\le 0.1 $.\n\nNumerical properties:\n- Air properties are set as $ \\rho = 1.2 \\, \\mathrm{kg/m^3} $, $ c_p = 1005 \\, \\mathrm{J/(kg \\cdot K)} $, $ k = 0.026 \\, \\mathrm{W/(m \\cdot K)} $, $ \\nu = 1.5 \\times 10^{-5} \\, \\mathrm{m^2/s} $. The value of $ \\nu $ does not explicitly enter the above expressions but is provided for completeness.\n- Thermal diffusivity is $ \\alpha = k / (\\rho c_p) $. With the given values, $ \\alpha \\approx \\frac{0.026}{1.2 \\times 1005} \\, \\mathrm{m^2/s} $.\n- Gravitational acceleration is $ g = 9.81 \\, \\mathrm{m/s^2} $.\n- The free-stream temperature is set at $ T_\\infty = 300 \\, \\mathrm{K} $, such that $ \\beta = 1/T_\\infty \\approx 1/300 \\, \\mathrm{K^{-1}} $.\n\nInterpretation of outputs:\n- If $ \\mathrm{Ri}_x $ is on the order of $ 10^{-3} $ or smaller, buoyancy effects are very weak compared to forced convection at the specified location.\n- Larger $ \\mathrm{Ri}_x $ values (for instance, $ \\gtrsim 10^{-2} $) indicate stronger coupling and potential impact on the boundary layer structure.\n- The boolean validity flag indicates whether using the Boussinesq approximation is justifiable for the computed temperature rise.\n\nThe final program prints, in a single line, a list of lists where each inner list is $ [\\mathrm{Ri}_x, a_b, \\Delta T, \\text{valid}] $, with the floating-point quantities rounded to six decimal places and units as specified: $ a_b $ in $ \\mathrm{m/s^2} $, $ \\Delta T $ in $ \\mathrm{K} $, and $ \\mathrm{Ri}_x $ as dimensionless.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_results(U_inf, x, qpp, rho, cp, k, T_inf, g):\n    \"\"\"\n    Compute thermal boundary layer thickness, temperature rise, buoyant acceleration,\n    Richardson number, and Boussinesq validity for a given test case.\n    \"\"\"\n    # Thermal diffusivity alpha = k / (rho * cp)\n    alpha = k / (rho * cp)\n\n    # Thermal expansion coefficient beta = 1 / T_inf (ideal gas approximation)\n    beta = 1.0 / T_inf\n\n    # Thermal boundary layer thickness from advection-diffusion balance\n    # delta_T = sqrt(alpha * x / U_inf)\n    delta_T_bl = np.sqrt(alpha * x / U_inf)\n\n    # Temperature rise from uniform wall heat flux across the thermal boundary layer\n    # DeltaT = q'' * delta_T / k\n    delta_T = qpp * delta_T_bl / k\n\n    # Buoyant acceleration magnitude a_b = g * beta * DeltaT\n    a_b = g * beta * delta_T\n\n    # Local Richardson number Ri_x = a_b * x / U_inf^2\n    Ri_x = a_b * x / (U_inf ** 2)\n\n    # Boussinesq validity: |beta * DeltaT| <= 0.1\n    boussinesq_valid = (abs(beta * delta_T) <= 0.1)\n\n    return Ri_x, a_b, delta_T, boussinesq_valid\n\ndef format_case_result(result):\n    \"\"\"\n    Format a single case result as [Ri,a_b,DeltaT,valid] with 6 decimal places for floats.\n    \"\"\"\n    Ri_x, a_b, delta_T, valid = result\n    return f\"[{Ri_x:.6f},{a_b:.6f},{delta_T:.6f},{str(valid)}]\"\n\ndef solve():\n    # Air properties and constants\n    rho = 1.2          # kg/m^3\n    cp = 1005.0        # J/(kg*K)\n    k = 0.026          # W/(m*K)\n    T_inf = 300.0      # K\n    g = 9.81           # m/s^2\n\n    # Define the test cases from the problem statement:\n    # Each tuple: (U_inf [m/s], x [m], qpp [W/m^2])\n    test_cases = [\n        (5.0, 0.05, 1000.0),   # Case A: happy path\n        (2.0, 0.10, 2000.0),   # Case B: strong heating, lower speed\n        (20.0, 0.10, 1000.0),  # Case C: higher speed, moderate heating\n        (5.0, 0.10, 0.0),      # Case D: edge case, no heating\n    ]\n\n    results_str = []\n    for U_inf, x, qpp in test_cases:\n        res = compute_results(U_inf, x, qpp, rho, cp, k, T_inf, g)\n        results_str.append(format_case_result(res))\n\n    # Final print statement in the exact required format:\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Full-order CFD simulations, while accurate, are often too computationally expensive for the rapid iteration needed in control system design. This practice introduces Proper Orthogonal Decomposition (POD), a powerful data-driven technique to analyze simulation output and extract the most dynamically significant flow structures. By projecting a model of the governing equations onto a low-dimensional basis derived from flow snapshots, you will learn the fundamental process of constructing a reduced-order model (ROM) suitable for efficient analysis and control.",
            "id": "3941255",
            "problem": "You are given a controlled, linearized incompressible flow model intended to represent a one-dimensional streamwise perturbation of a base flow in a channel. The governing dynamics for the perturbation field $q(x,t)$ are modeled in continuous form by the linear advection–diffusion equation with a localized body-force control input\n$$\n\\frac{\\partial q}{\\partial t} = \\nu \\frac{\\partial^2 q}{\\partial x^2} - U \\frac{\\partial q}{\\partial x} + b(x) \\, u(t),\n$$\nwhere $x \\in [0,L_x]$ with periodic boundary conditions, $U$ is the uniform base flow speed, $\\nu$ is the kinematic viscosity, $b(x)$ is the spatial control input distribution, and $u(t)$ is the scalar control signal. The spatial domain is discretized uniformly into $N$ points with spacing $\\Delta x = L_x/N$, yielding the semi-discrete linear system\n$$\n\\frac{d \\mathbf{q}}{d t} = \\mathbf{L} \\mathbf{q} + \\mathbf{B} \\, u(t),\n$$\nwhere $\\mathbf{q}(t) \\in \\mathbb{R}^N$, $\\mathbf{L} \\in \\mathbb{R}^{N \\times N}$ is the discrete advection–diffusion operator constructed using second-order central differences for diffusion and central differences for advection with periodic wrap, and $\\mathbf{B} \\in \\mathbb{R}^N$ is the discretized control input distribution corresponding to $b(x)$. A set of $K$ time-indexed snapshots is assembled as columns of the matrix $\\mathbf{Q} \\in \\mathbb{R}^{N \\times K}$ by numerically integrating the full-order model under a prescribed control signal $u(t)$.\n\nTo construct an energy-optimal low-dimensional subspace, define the weighted inner product via the diagonal weight matrix $\\mathbf{W} \\in \\mathbb{R}^{N \\times N}$ with positive entries (for example, approximating quadrature weights over the domain), and the corresponding norm $\\|\\mathbf{v}\\|_{\\mathbf{W}}^2 = \\mathbf{v}^\\top \\mathbf{W} \\mathbf{v}$. Proper Orthogonal Decomposition (POD) seeks an $r$-dimensional subspace spanned by columns of $\\boldsymbol{\\Phi} \\in \\mathbb{R}^{N \\times r}$ that minimizes the mean-squared reconstruction error of the snapshots in the $\\mathbf{W}$-weighted norm, with the constraint of $\\mathbf{W}$-orthonormality, i.e., $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$. The reduced coordinates are defined by the projection of the state onto the subspace via $ \\mathbf{a}(t) = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{q}(t)$, where $\\mathbf{a}(t) \\in \\mathbb{R}^r$. The reduced-order dynamical system is the Galerkin projection of the full-order dynamics onto the POD subspace, yielding a low-dimensional system with control input $u(t)$.\n\nYour task is to:\n1. Starting from the continuous advection–diffusion model, construct the discrete operator $\\mathbf{L}$ using a second-order central difference scheme for diffusion and a central difference scheme for advection with periodic boundary conditions, and construct $\\mathbf{B}$ as a localized Gaussian body-force distribution centered at a specified location with standard deviation given in spatial units.\n2. Simulate the semi-discrete system using explicit Euler time-stepping to generate $K$ snapshots $\\mathbf{Q} = [\\mathbf{q}(t_1), \\ldots, \\mathbf{q}(t_K)]$ for a specified control function $u(t)$, with $\\mathbf{q}(0) = \\mathbf{0}$. Use uniform time steps of size $\\Delta t$.\n3. Compute the $\\mathbf{W}$-weighted POD modes $\\boldsymbol{\\Phi}$ of rank $r$ from $\\mathbf{Q}$, and enforce $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$.\n4. Define the reduced-order coordinates $\\mathbf{a}(t) = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{q}(t)$ and derive the reduced-order model of the form\n$$\n\\frac{d \\mathbf{a}}{dt} = \\mathbf{A}_r \\mathbf{a} + \\mathbf{B}_r \\, u(t),\n$$\nby projecting the full-order linear dynamics onto the POD subspace. Provide the explicit construction of $\\mathbf{A}_r$ and $\\mathbf{B}_r$ in terms of $\\boldsymbol{\\Phi}$, $\\mathbf{W}$, $\\mathbf{L}$, and $\\mathbf{B}$.\n5. Quantify two metrics: the retained energy fraction of the rank-$r$ POD approximation defined as the ratio of the sum of the leading $r$ snapshot singular values squared to the total sum of snapshot singular values squared (this is a dimensionless decimal), and the projection closure residual defined as\n$$\n\\mathcal{R} = \\frac{\\|(\\mathbf{I} - \\mathbf{P}_{\\mathbf{W}})\\mathbf{L}\\boldsymbol{\\Phi}\\|_F}{\\|\\mathbf{L}\\boldsymbol{\\Phi}\\|_F},\n\\quad \\text{with} \\quad \\mathbf{P}_{\\mathbf{W}} = \\boldsymbol{\\Phi} \\boldsymbol{\\Phi}^\\top \\mathbf{W},\n$$\nwhere $\\|\\cdot\\|_F$ denotes the Frobenius norm. This residual is a dimensionless decimal.\n\nUse the following fixed physical and numerical parameters in all simulations:\n- Domain length $L_x = 1$ meters, number of grid points $N = 64$, viscosity $\\nu = 0.01$ meters$^2$/seconds, base flow $U = 1$ meters/seconds, Gaussian control center $x_c = 0.25$ meters, Gaussian standard deviation $\\sigma = 0.05$ meters, time step $\\Delta t = 0.002$ seconds, final time $T = 0.5$ seconds, and initial condition $\\mathbf{q}(0) = \\mathbf{0}$.\n- Control signal $u(t)$ is piecewise constant: $u(t) = 1$ for $0 \\le t &lt; 0.25$ seconds, and $u(t) = -1$ for $0.25 \\le t \\le 0.5$ seconds.\n- Use snapshots at every time step, so $K = T/\\Delta t$.\n\nThe weight matrix $\\mathbf{W}$ and rank $r$ vary according to the following test suite:\n- Test case 1 (happy path, low rank): $\\mathbf{W}$ is uniform quadrature weights $\\mathbf{W} = \\Delta x \\, \\mathbf{I}_N$, rank $r = 1$.\n- Test case 2 (increased rank): $\\mathbf{W}$ is uniform quadrature weights $\\mathbf{W} = \\Delta x \\, \\mathbf{I}_N$, rank $r = 5$.\n- Test case 3 (non-uniform weights edge case): $\\mathbf{W}$ has entries $W_{ii} = \\Delta x \\left(1 + 0.3 \\cos(2\\pi x_i/L_x)\\right)$, rank $r = 15$, where $x_i$ are the grid point coordinates.\n\nYour program must compute, for each test case, the retained energy fraction (dimensionless decimal) and the projection closure residual (dimensionless decimal). The final output must be a single line containing a comma-separated list enclosed in square brackets in the order\n$$\n[\\text{energy}_1,\\text{residual}_1,\\text{energy}_2,\\text{residual}_2,\\text{energy}_3,\\text{residual}_3],\n$$\nwith each entry expressed as a decimal number. No units are required in the output because all requested metrics are dimensionless.",
            "solution": "The user-provided problem is critically reviewed and determined to be valid. It is scientifically grounded in the principles of fluid dynamics and linear systems theory, well-posed with a clear objective, and provides a complete and consistent set of parameters. The task demands the application of standard numerical methods (finite differences, time integration) and data-driven model reduction techniques (Proper Orthogonal Decomposition), which are staple concepts in computational science and engineering.\n\nThe solution is constructed by following the five tasks outlined in the problem statement.\n\n### Step 1: Discretization of the Governing Equation\n\nThe given continuous partial differential equation (PDE) is:\n$$\n\\frac{\\partial q}{\\partial t} = \\nu \\frac{\\partial^2 q}{\\partial x^2} - U \\frac{\\partial q}{\\partial x} + b(x) \\, u(t)\n$$\nThe spatial domain $x \\in [0, L_x]$ is discretized into $N$ uniformly spaced points $x_i = i \\Delta x$ for $i = 0, 1, \\dots, N-1$, where the grid spacing is $\\Delta x = L_x / N$. The perturbation field $q(x, t)$ is represented by a vector $\\mathbf{q}(t) \\in \\mathbb{R}^N$ where $(\\mathbf{q})_i = q(x_i, t)$.\n\nThe spatial derivatives are approximated using second-order finite difference schemes with periodic boundary conditions.\n\nThe diffusion term $\\nu \\frac{\\partial^2 q}{\\partial x^2}$ is discretized using a second-order central difference scheme:\n$$\n\\nu \\frac{\\partial^2 q}{\\partial x^2}\\bigg|_{x_i} \\approx \\nu \\frac{q(x_{i+1}, t) - 2q(x_i, t) + q(x_{i-1}, t)}{(\\Delta x)^2}\n$$\nThe advection term $-U \\frac{\\partial q}{\\partial x}$ is discretized using a second-order central difference scheme:\n$$\n-U \\frac{\\partial q}{\\partial x}\\bigg|_{x_i} \\approx -U \\frac{q(x_{i+1}, t) - q(x_{i-1}, t)}{2 \\Delta x}\n$$\nCombining these discretizations, the $i$-th component of the discretized operator $\\mathbf{L} \\mathbf{q}$ is:\n$$\n(\\mathbf{L} \\mathbf{q})_i = \\left(\\frac{\\nu}{(\\Delta x)^2} + \\frac{U}{2 \\Delta x}\\right) q_{i-1} - \\frac{2\\nu}{(\\Delta x)^2} q_i + \\left(\\frac{\\nu}{(\\Delta x)^2} - \\frac{U}{2 \\Delta x}\\right) q_{i+1}\n$$\nwhere indices are taken modulo $N$ to enforce periodicity. This defines the entries of the circulant matrix $\\mathbf{L} \\in \\mathbb{R}^{N \\times N}$.\n\nThe control input distribution $b(x)$ is a localized Gaussian function. The corresponding discrete vector $\\mathbf{B} \\in \\mathbb{R}^N$ has components:\n$$\nB_i = b(x_i) = \\exp\\left(-\\frac{(x_i - x_c)^2}{2\\sigma^2}\\right)\n$$\nThis leads to the semi-discrete linear time-invariant system:\n$$\n\\frac{d \\mathbf{q}}{dt} = \\mathbf{L} \\mathbf{q} + \\mathbf{B} u(t)\n$$\n\n### Step 2: Snapshot Generation via Time Integration\n\nThe semi-discrete system is integrated in time using the explicit Euler method, starting from the zero initial condition $\\mathbf{q}(0) = \\mathbf{0}$. The update rule for the state vector at time step $k$ is:\n$$\n\\mathbf{q}(t_{k+1}) = \\mathbf{q}(t_k) + \\Delta t \\left( \\mathbf{L} \\mathbf{q}(t_k) + \\mathbf{B} u(t_k) \\right)\n$$\nwhere $t_k = k \\Delta t$. The control signal $u(t)$ is piecewise constant as specified. We generate $K = T/\\Delta t$ snapshots by storing the state vector at each time step from $t_1 = \\Delta t$ to $t_K = T$. These vectors form the columns of the snapshot matrix $\\mathbf{Q} = [\\mathbf{q}(t_1), \\mathbf{q}(t_2), \\dots, \\mathbf{q}(t_K)] \\in \\mathbb{R}^{N \\times K}$.\n\n### Step 3: Weighted Proper Orthogonal Decomposition (POD)\n\nThe goal of POD is to find an $r$-dimensional basis $\\boldsymbol{\\Phi} = [\\boldsymbol{\\phi}_1, \\dots, \\boldsymbol{\\phi}_r] \\in \\mathbb{R}^{N \\times r}$ that is orthonormal with respect to the $\\mathbf{W}$-weighted inner product ($\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$) and minimizes the average projection error of the snapshots.\n\nThis optimization problem is solved via the Singular Value Decomposition (SVD) of a weighted snapshot matrix. Let $\\mathbf{W}^{1/2}$ be the diagonal matrix whose entries are the square roots of the diagonal entries of $\\mathbf{W}$. We form the weighted snapshot matrix $\\tilde{\\mathbf{Q}} = \\mathbf{W}^{1/2} \\mathbf{Q}$ and compute its SVD:\n$$\n\\tilde{\\mathbf{Q}} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^\\top\n$$\nwhere $\\mathbf{U} \\in \\mathbb{R}^{N \\times \\min(N,K)}$ has orthonormal columns, $\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{\\min(N,K) \\times \\min(N,K)}$ is a diagonal matrix of singular values $\\sigma_i \\geq 0$, and $\\mathbf{V} \\in \\mathbb{R}^{K \\times \\min(N,K)}$ has orthonormal columns.\n\nThe columns of the optimal basis $\\boldsymbol{\\Phi}$, known as the POD modes, are obtained from the leading $r$ left singular vectors (columns of $\\mathbf{U}$) by reversing the weighting:\n$$\n\\boldsymbol{\\Phi} = (\\mathbf{W}^{1/2})^{-1} \\mathbf{U}_r\n$$\nwhere $\\mathbf{U}_r$ contains the first $r$ columns of $\\mathbf{U}$. The resulting modes are guaranteed to be $\\mathbf{W}$-orthonormal.\n\n### Step 4: Galerkin Projection and Reduced-Order Model (ROM)\n\nA reduced-order model (ROM) is obtained by projecting the full-order dynamics onto the subspace spanned by the POD modes. We approximate the state as a linear combination of the POD modes: $\\mathbf{q}(t) \\approx \\boldsymbol{\\Phi} \\mathbf{a}(t)$, where $\\mathbf{a}(t) \\in \\mathbb{R}^r$ is the vector of reduced coordinates.\n\nSubstituting this ansatz into the semi-discrete system yields a residual:\n$$\n\\mathbf{R}(t) = \\boldsymbol{\\Phi} \\frac{d\\mathbf{a}}{dt} - (\\mathbf{L} \\boldsymbol{\\Phi} \\mathbf{a} + \\mathbf{B} u(t))\n$$\nGalerkin projection requires this residual to be orthogonal to the basis functions in the $\\mathbf{W}$-weighted inner product, i.e., $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{R}(t) = \\mathbf{0}$.\n$$\n\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\left( \\boldsymbol{\\Phi} \\frac{d\\mathbf{a}}{dt} \\right) = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\left( \\mathbf{L} \\boldsymbol{\\Phi} \\mathbf{a} + \\mathbf{B} u(t) \\right)\n$$\nUsing the $\\mathbf{W}$-orthonormality property, $\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\boldsymbol{\\Phi} = \\mathbf{I}_r$, we obtain the ROM:\n$$\n\\frac{d\\mathbf{a}}{dt} = \\left(\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{L} \\boldsymbol{\\Phi}\\right) \\mathbf{a}(t) + \\left(\\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{B}\\right) u(t)\n$$\nThis is of the form $\\frac{d \\mathbf{a}}{dt} = \\mathbf{A}_r \\mathbf{a} + \\mathbf{B}_r u(t)$, with the reduced-order system matrices defined as:\n$$\n\\mathbf{A}_r = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{L} \\boldsymbol{\\Phi} \\in \\mathbb{R}^{r \\times r}\n$$\n$$\n\\mathbf{B}_r = \\boldsymbol{\\Phi}^\\top \\mathbf{W} \\mathbf{B} \\in \\mathbb{R}^{r}\n$$\n\n### Step 5: Calculation of Performance Metrics\n\nTwo metrics are computed to evaluate the quality of the reduced-order basis.\n\n**Retained Energy Fraction**: The squared singular values $\\sigma_i^2$ of the weighted snapshot matrix $\\tilde{\\mathbf{Q}}$ correspond to the \"energy\" (variance) captured by each mode. The fraction of total energy retained by the rank-$r$ approximation is:\n$$\nE_r = \\frac{\\sum_{i=1}^r \\sigma_i^2}{\\sum_{j=1}^{\\min(N,K)} \\sigma_j^2}\n$$\n\n**Projection Closure Residual**: This metric quantifies how well the POD subspace is closed under the action of the dynamics operator $\\mathbf{L}$. The projection operator onto the POD subspace in the $\\mathbf{W}$-norm is $\\mathbf{P}_{\\mathbf{W}} = \\boldsymbol{\\Phi} \\boldsymbol{\\Phi}^\\top \\mathbf{W}$. The residual is defined as the Frobenius norm of the component of $\\mathbf{L}\\boldsymbol{\\Phi}$ that lies outside the POD subspace, normalized by the norm of $\\mathbf{L}\\boldsymbol{\\Phi}$:\n$$\n\\mathcal{R} = \\frac{\\|(\\mathbf{I} - \\mathbf{P}_{\\mathbf{W}})\\mathbf{L}\\boldsymbol{\\Phi}\\|_F}{\\|\\mathbf{L}\\boldsymbol{\\Phi}\\|_F}\n$$\nA small residual indicates that the dynamics of the modes are well-contained within the subspace they span, suggesting that the Galerkin projection will be accurate.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of building and evaluating a reduced-order model for a\n    linearized 1D advection-diffusion equation.\n    \"\"\"\n    # Fixed physical and numerical parameters\n    Lx = 1.0  # Domain length\n    N = 64  # Number of grid points\n    nu = 0.01  # Kinematic viscosity\n    U = 1.0  # Base flow speed\n    xc = 0.25  # Gaussian control center\n    sigma = 0.05  # Gaussian standard deviation\n    dt = 0.002  # Time step\n    T = 0.5  # Final time\n\n    # Derived parameters\n    dx = Lx / N\n    x = np.linspace(0, Lx, N, endpoint=False)\n    num_steps = int(T / dt)\n    K = num_steps\n\n    # --- Step 1: Construct discrete operators L and B ---\n    L = np.zeros((N, N))\n    # Coefficients based on central difference schemes\n    c_diff = nu / dx**2\n    c_adv = U / (2 * dx)\n    for i in range(N):\n        L[i, i] = -2.0 * c_diff\n        L[i, (i + 1) % N] = c_diff - c_adv\n        L[i, (i - 1 + N) % N] = c_diff + c_adv\n    \n    B = np.exp(-((x - xc)**2) / (2 * sigma**2))\n\n    # --- Step 2: Generate snapshots Q ---\n    q = np.zeros(N)\n    Q = np.zeros((N, K))\n    for k in range(num_steps):\n        time = k * dt\n        u_val = 1.0 if time < 0.25 else -1.0\n        \n        # Explicit Euler step\n        q = q + dt * (L @ q + B * u_val)\n        Q[:, k] = q\n\n    # Define test cases\n    test_cases = [\n        {'type': 'uniform', 'r': 1},\n        {'type': 'uniform', 'r': 5},\n        {'type': 'cosine', 'r': 15}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        r = case['r']\n\n        # --- Construct weight matrix W for the current test case ---\n        if case['type'] == 'uniform':\n            W_diag = np.full(N, dx)\n        elif case['type'] == 'cosine':\n            W_diag = dx * (1.0 + 0.3 * np.cos(2 * np.pi * x / Lx))\n        \n        W = np.diag(W_diag)\n        W_sqrt_diag = np.sqrt(W_diag)\n        W_inv_sqrt_diag = 1.0 / W_sqrt_diag\n        W_sqrt = np.diag(W_sqrt_diag)\n        W_inv_sqrt = np.diag(W_inv_sqrt_diag)\n\n        # --- Step 3: Compute weighted POD modes Phi ---\n        Q_tilde = W_sqrt @ Q\n        # Use full_matrices=False for efficiency\n        U_svd, s, _ = np.linalg.svd(Q_tilde, full_matrices=False)\n        \n        # Truncate to rank r\n        Ur = U_svd[:, :r]\n        Phi = W_inv_sqrt @ Ur\n\n        # --- Step 5: Compute metrics ---\n        # Retained Energy Fraction\n        energy_fraction = np.sum(s[:r]**2) / np.sum(s**2)\n\n        # Projection Closure Residual\n        LPhi = L @ Phi\n        P_W = Phi @ Phi.T @ W\n        I = np.identity(N)\n        \n        residual_matrix = (I - P_W) @ LPhi\n        \n        norm_numerator = np.linalg.norm(residual_matrix, 'fro')\n        norm_denominator = np.linalg.norm(LPhi, 'fro')\n        \n        closure_residual = norm_numerator / norm_denominator\n\n        results.extend([energy_fraction, closure_residual])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{val:.10f}' for val in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}