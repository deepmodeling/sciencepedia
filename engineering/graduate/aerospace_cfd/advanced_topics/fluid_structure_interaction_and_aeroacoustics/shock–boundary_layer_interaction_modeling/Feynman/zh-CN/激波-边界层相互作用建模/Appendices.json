{
    "hands_on_practices": [
        {
            "introduction": "SBLI分析的一项核心技能是根据速度剖面数据来表征边界层的状态。本练习  将提供从激波下游的代表性速度剖面计算基本参数的实践，例如壁面摩阻系数 $C_f$ 和克劳泽压力梯度参数 $\\beta$。该实践旨在加强对壁面速度梯度、剪切应力以及边界层对逆压梯度响应之间物理联系的理解。",
            "id": "3993935",
            "problem": "一个二维的激波-边界层相互作用 (SBLI) 在一个压缩斜坡上游的平板上形成。在激波足紧邻下游的一个流向站位上，粘性子层和对数律层中的平均流向速度剖面可以很好地用测量拟合公式 $u(y) = U_{e}\\left(1 - \\exp\\left(-\\frac{y}{a}\\right)\\right)$ (对于 $y \\ge 0$) 来近似。其中，$y$ 是壁面法向坐标，$U_{e}$ 是边界层边缘速度，$a$ 是一个表征近壁剖面的长度尺度。假设在该站位处：壁面动力粘度为常数，等于 $\\mu_{w}$；整个边界层内的密度近似均匀，等于 $\\rho_{e}$；边缘压力随 $p_{e}(x)$ 变化，并测得逆压梯度 $\\frac{d p_{e}}{d x}  0$。在这些假设下，使用基本定义，根据给定的数据集计算表面摩擦系数 $C_{f}$ 和 Clauser 压力梯度参数 $\\beta$：\n- $U_{e} = 600 \\ \\mathrm{m/s}$，\n- $\\rho_{e} = 0.600 \\ \\mathrm{kg/m^{3}}$，\n- $\\mu_{w} = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$，\n- $a = 2.00 \\times 10^{-3} \\ \\mathrm{m}$，\n- $\\frac{d p_{e}}{d x} = 3.00 \\times 10^{4} \\ \\mathrm{Pa/m}$。\n\n采用壁面无滑移条件，并将边缘视为无粘流动。使用基于牛顿粘性的壁面剪切应力定义、表面摩擦系数的标准定义，以及用位移厚度和壁面剪切应力表示的 Clauser 压力梯度参数定义。报告 $C_{f}$ 和 $\\beta$ 的值，四舍五入到三位有效数字。将最终结果表示为不带单位的无量纲数。",
            "solution": "问题陈述已经过评估并被确定为有效。它在科学上基于流体动力学原理，特别是边界层理论，并且提法恰当，提供了足够的信息来为所求的量推导出唯一解。给定的物理参数对于涉及激波-边界层相互作用的高速空气动力学情景是合理的。我们将进行正式推导。\n\n该问题要求计算两个无量纲参数：表面摩擦系数 $C_{f}$ 和 Clauser 压力梯度参数 $\\beta$。这将分两部分进行。\n\n第1部分：计算表面摩擦系数 $C_{f}$\n\n表面摩擦系数定义为经自由流动态压力无量纲化后的壁面剪切应力 $\\tau_{w}$。\n$$C_{f} = \\frac{\\tau_{w}}{\\frac{1}{2}\\rho_{e}U_{e}^{2}}$$\n对于牛顿流体，在无滑移条件下，壁面剪切应力 $\\tau_{w}$ 由壁面动力粘度 $\\mu_{w}$ 与壁面速度梯度的乘积给出。\n$$\\tau_{w} = \\mu_{w} \\left( \\frac{\\partial u}{\\partial y} \\right)_{y=0}$$\n我们已知流向速度剖面是壁面法向坐标 $y$ 的函数：\n$$u(y) = U_{e}\\left(1 - \\exp\\left(-\\frac{y}{a}\\right)\\right)$$\n首先，我们必须通过对速度剖面关于 $y$ 求导来计算速度梯度 $\\frac{\\partial u}{\\partial y}$。\n$$\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ U_{e}\\left(1 - \\exp\\left(-\\frac{y}{a}\\right)\\right) \\right] = U_{e} \\left( - \\exp\\left(-\\frac{y}{a}\\right) \\cdot \\left(-\\frac{1}{a}\\right) \\right) = \\frac{U_{e}}{a} \\exp\\left(-\\frac{y}{a}\\right)$$\n接下来，我们计算该梯度在壁面处（即 $y=0$ 处）的值。\n$$\\left( \\frac{\\partial u}{\\partial y} \\right)_{y=0} = \\frac{U_{e}}{a} \\exp(0) = \\frac{U_{e}}{a}$$\n现在，我们可以计算壁面剪切应力 $\\tau_{w}$。\n$$\\tau_{w} = \\mu_{w} \\frac{U_{e}}{a}$$\n将 $\\tau_{w}$ 的这个表达式代入 $C_{f}$ 的定义中：\n$$C_{f} = \\frac{\\mu_{w} \\frac{U_{e}}{a}}{\\frac{1}{2}\\rho_{e}U_{e}^{2}} = \\frac{2\\mu_{w}}{\\rho_{e}U_{e}a}$$\n我们已知以下数值：\n- $U_{e} = 600 \\ \\mathrm{m/s}$\n- $\\rho_{e} = 0.600 \\ \\mathrm{kg/m^{3}}$\n- $\\mu_{w} = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$\n- $a = 2.00 \\times 10^{-3} \\ \\mathrm{m}$\n\n将这些值代入 $C_{f}$ 的表达式中：\n$$C_{f} = \\frac{2(1.80 \\times 10^{-5})}{(0.600)(600)(2.00 \\times 10^{-3})} = \\frac{3.60 \\times 10^{-5}}{720 \\times 10^{-3}} = \\frac{3.60 \\times 10^{-5}}{0.720} = 5.00 \\times 10^{-5}$$\n表面摩擦系数四舍五入到三位有效数字为 $5.00 \\times 10^{-5}$。\n\n第2部分：计算 Clauser 压力梯度参数 $\\beta$\n\nClauser 参数 $\\beta$ 定义为：\n$$\\beta = \\frac{\\delta^{*}}{\\tau_{w}} \\frac{dp_{e}}{dx}$$\n其中 $\\delta^{*}$ 是位移厚度，$\\frac{dp_{e}}{dx}$ 是边界层边缘的流向压力梯度。\n\n首先，我们必须计算位移厚度 $\\delta^{*}$，其定义为：\n$$\\delta^{*} = \\int_{0}^{\\infty} \\left(1 - \\frac{u(y)}{U_{e}}\\right) dy$$\n将给定的速度剖面代入被积函数中：\n$$1 - \\frac{u(y)}{U_{e}} = 1 - \\frac{U_{e}\\left(1 - \\exp\\left(-\\frac{y}{a}\\right)\\right)}{U_{e}} = 1 - \\left(1 - \\exp\\left(-\\frac{y}{a}\\right)\\right) = \\exp\\left(-\\frac{y}{a}\\right)$$\n现在我们进行积分以求得 $\\delta^{*}$：\n$$\\delta^{*} = \\int_{0}^{\\infty} \\exp\\left(-\\frac{y}{a}\\right) dy = \\left[ -a \\exp\\left(-\\frac{y}{a}\\right) \\right]_{0}^{\\infty} = (-a \\cdot 0) - (-a \\cdot \\exp(0)) = a$$\n因此，位移厚度等于长度尺度 $a$。\n$$\\delta^{*} = a$$\n现在，通过代入 $\\delta^{*}$ 和 $\\tau_{w}$ 的表达式，我们可以写出 $\\beta$ 的表达式：\n$$\\beta = \\frac{a}{\\mu_{w} \\frac{U_{e}}{a}} \\frac{dp_{e}}{dx} = \\frac{a^{2}}{\\mu_{w}U_{e}} \\frac{dp_{e}}{dx}$$\n我们还已知以下数值：\n- $\\frac{dp_{e}}{dx} = 3.00 \\times 10^{4} \\ \\mathrm{Pa/m}$\n\n将所有已知值代入 $\\beta$ 的表达式中：\n$$\\beta = \\frac{(2.00 \\times 10^{-3})^{2}}{(1.80 \\times 10^{-5})(600)} (3.00 \\times 10^{4})$$\n$$\\beta = \\frac{4.00 \\times 10^{-6}}{1.08 \\times 10^{-2}} (3.00 \\times 10^{4}) = \\frac{12.00 \\times 10^{-2}}{1.08 \\times 10^{-2}} = \\frac{12.00}{1.08} \\approx 11.111...$$\n将结果四舍五入到三位有效数字，我们得到：\n$$\\beta = 11.1$$\n计算出的表面摩擦系数和 Clauser 参数的值分别为 $C_{f} = 5.00 \\times 10^{-5}$ 和 $\\beta = 11.1$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 5.00 \\times 10^{-5}  11.1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "从局部剖面分析扩展到整体分离结构，我们常常可以从壁面压力特征中推断其属性。本练习  将演示如何使用简化的线性化超音速理论模型，从分离泡特有的压力平台区来估算其长度和高度。该实践突出了基于模型的推理方法在从空气动力学数据中提取定量几何信息方面的强大作用。",
            "id": "3993937",
            "problem": "当一道斜激波冲击名义上平壁上的湍流边界层时，会发生二维定常超声速激波-边界层相互作用（SBLI）。在分离相互作用区，测得的壁面压力分布呈现出一个压力平台。假设外部无粘流通过线性化超声速小扰动理论响应边界层的位移，并将分离泡的影响模拟为在整个平台上恒定的附加位移厚度。\n\n来流条件为：马赫数 $M_{e} = 2.5$，相互作用区上游静压 $p_{1} = 5.0 \\times 10^{4} \\ \\mathrm{Pa}$，静温 $T_{e} = 220 \\ \\mathrm{K}$，比热比 $\\gamma = 1.4$，特定气体常数 $R = 287 \\ \\mathrm{J/(kg \\cdot K)}$，动力粘度 $\\mu_{e} = 1.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$。基于上游动量厚度的雷诺数为 $\\mathrm{Re}_{\\theta} = 6000$，其中 $\\mathrm{Re}_{\\theta} \\equiv \\rho_{e} U_{e} \\theta_{e} / \\mu_{e}$，$\\rho_{e}$ 和 $U_{e}$ 分别是上游密度和边缘速度，$\\theta_{e}$ 是上游动量厚度。\n\n测得的壁面压力分布 $p_{w}(x)$ 有一个恒定的压力平台 $p_{\\mathrm{plat}} = 7.8 \\times 10^{4} \\ \\mathrm{Pa}$，从分离起始位置 $x_{s} = 0.050 \\ \\mathrm{m}$ 延伸到再附位置 $x_{r} = 0.095 \\ \\mathrm{m}$，在此区域之外 $p_{w}(x)$ 等于 $p_{1}$。将此平台视为空间上均匀的，其值为 $p_{\\mathrm{plat}}$。\n\n从线性化超声速小扰动理论和将位移厚度定义为外部无粘流的有效壁面偏转出发，推导一个将平台上的附加位移厚度与壁面压力升高联系起来的关系式。使用此关系式计算：\n1) 分离泡长度 $L_{b}$，定义为 $L_{b} = x_{r} - x_{s}$，\n2) 分离泡高度 $h_{b}$，解释为平台上的附加位移厚度，\n3) 无量纲分离长度 $L_{b}/\\theta_{e}$ 和分离泡高度 $h_{b}/\\theta_{e}$。\n\n为了在相似的 $M_{e}$ 和 $\\mathrm{Re}_{\\theta}$ 下进行比较，经验关联式报告的参考值为 $(L_{b}/\\theta_{e})_{\\mathrm{ref}} = 250$ 和 $(h_{b}/\\theta_{e})_{\\mathrm{ref}} = 35$。计算比值\n$$\nr_{L} = \\frac{L_{b}/\\theta_{e}}{(L_{b}/\\theta_{e})_{\\mathrm{ref}}}\n\\quad \\text{和} \\quad\nr_{h} = \\frac{h_{b}/\\theta_{e}}{(h_{b}/\\theta_{e})_{\\mathrm{ref}}}.\n$$\n将最终答案表示为行矩阵 $\\begin{pmatrix} r_{L}  r_{h} \\end{pmatrix}$，无单位，并四舍五入到四位有效数字。",
            "solution": "首先根据所需标准验证问题陈述。\n\n**步骤1：提取已知条件**\n-   来流马赫数：$M_{e} = 2.5$\n-   上游静压：$p_{1} = 5.0 \\times 10^{4} \\ \\mathrm{Pa}$\n-   静温：$T_{e} = 220 \\ \\mathrm{K}$\n-   比热比：$\\gamma = 1.4$\n-   特定气体常数：$R = 287 \\ \\mathrm{J/(kg \\cdot K)}$\n-   动力粘度：$\\mu_{e} = 1.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$\n-   基于动量厚度的雷诺数：$\\mathrm{Re}_{\\theta} = 6000$\n-   雷诺数的定义：$\\mathrm{Re}_{\\theta} \\equiv \\rho_{e} U_{e} \\theta_{e} / \\mu_{e}$\n-   平台压力：$p_{\\mathrm{plat}} = 7.8 \\times 10^{4} \\ \\mathrm{Pa}$\n-   分离起始位置：$x_{s} = 0.050 \\ \\mathrm{m}$\n-   再附位置：$x_{r} = 0.095 \\ \\mathrm{m}$\n-   参考无量纲长度：$(L_{b}/\\theta_{e})_{\\mathrm{ref}} = 250$\n-   参考无量纲高度：$(h_{b}/\\theta_{e})_{\\mathrm{ref}} = 35$\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础**：该问题描述了一个经典的超声速激波/湍流边界层相互作用（SBLI）。使用线性化小扰动理论是外部无粘流响应的标准一阶近似。提供的物理量（$M_e$、$p_1$、$T_e$ 等）在空气动力学应用中是现实的。分离流中压力平台的概念是一个有充分文献记载的实验现象。该问题在科学上是合理的。\n-   **适定性**：问题陈述清晰，提供了计算所需量所需的所有必要数据和定义。步骤逻辑明确，可以确定唯一的解。\n-   **客观性**：语言技术性强且精确，没有主观或含糊的陈述。\n\n**步骤3：结论与行动**\n该问题有效。它具有科学基础、适定性和客观性。将提供解答。\n\n解答过程首先推导压力升高与分离泡有效几何形状之间的关系，然后依次计算所需的参数。\n\n首先，我们推导平台上的附加位移厚度（解释为分离泡高度 $h_b$）与壁面压力升高之间的关系。根据线性化超声速小扰动理论，表面上的压力系数 $C_p$ 与局部流偏转角 $\\alpha$ 通过 Ackeret 公式相关联：\n$$\nC_p = \\frac{2\\alpha}{\\sqrt{M_e^2 - 1}}\n$$\n问题陈述指出，在分离泡上方的壁面压力恒为 $p_{\\mathrm{plat}}$。恒定的压力意味着恒定的压力系数 $C_p$，这又意味着恒定的流偏转角 $\\alpha$。这意味着边界层位移厚度 $\\delta^*(x)$ 的有效表面在分离泡长度 $L_b$ 上必须具有恒定的斜率。\n分离泡高度 $h_b$ 是位移厚度在长度 $L_b = x_r - x_s$ 上的总附加增量。因此，作为有效流偏转角的恒定斜率由下式给出：\n$$\n\\alpha = \\frac{h_b}{L_b}\n$$\n压力系数 $C_p$ 定义为压差除以上游动压 $q_e$：\n$$\nC_p = \\frac{p_{\\mathrm{plat}} - p_1}{q_e}\n$$\n动压 $q_e$ 可以使用理想气体定律（$p_1 = \\rho_e R T_e$）以及马赫数（$M_e = U_e/a_e$）和声速（$a_e = \\sqrt{\\gamma R T_e}$）的定义，用上游静态特性表示：\n$$\nq_e = \\frac{1}{2}\\rho_e U_e^2 = \\frac{1}{2}\\left(\\frac{p_1}{RT_e}\\right)(M_e \\sqrt{\\gamma R T_e})^2 = \\frac{1}{2}\\frac{p_1}{RT_e}(M_e^2 \\gamma R T_e) = \\frac{1}{2}\\gamma p_1 M_e^2\n$$\n将 $\\alpha$ 和 $C_p$ 的表达式代入 Ackeret 公式，我们得到：\n$$\n\\frac{p_{\\mathrm{plat}} - p_1}{q_e} = \\frac{2(h_b/L_b)}{\\sqrt{M_e^2 - 1}}\n$$\n求解分离泡高度 $h_b$ 得到所需的关系式：\n$$\nh_b = \\frac{L_b \\sqrt{M_e^2 - 1}}{2} \\left( \\frac{p_{\\mathrm{plat}} - p_1}{q_e} \\right)\n$$\n现在我们计算所需的量。\n\n1.  **分离泡长度 $L_b$**：\n    分离泡长度是再附点与分离点之间的距离。\n    $$\n    L_b = x_r - x_s = 0.095 \\ \\mathrm{m} - 0.050 \\ \\mathrm{m} = 0.045 \\ \\mathrm{m}\n    $$\n\n2.  **分离泡高度 $h_b$**：\n    首先，我们计算上游动压 $q_e$。\n    $$\n    q_e = \\frac{1}{2}\\gamma p_1 M_e^2 = \\frac{1}{2}(1.4)(5.0 \\times 10^4 \\ \\mathrm{Pa})(2.5)^2 = 218750 \\ \\mathrm{Pa}\n    $$\n    相互作用区上的压力升高为：\n    $$\n    p_{\\mathrm{plat}} - p_1 = 7.8 \\times 10^4 \\ \\mathrm{Pa} - 5.0 \\times 10^4 \\ \\mathrm{Pa} = 2.8 \\times 10^4 \\ \\mathrm{Pa}\n    $$\n    马赫数项为：\n    $$\n    \\sqrt{M_e^2 - 1} = \\sqrt{2.5^2 - 1} = \\sqrt{6.25 - 1} = \\sqrt{5.25}\n    $$\n    现在，我们可以计算 $h_b$：\n    $$\n    h_b = \\frac{(0.045 \\ \\mathrm{m}) \\sqrt{5.25}}{2} \\left( \\frac{2.8 \\times 10^4 \\ \\mathrm{Pa}}{218750 \\ \\mathrm{Pa}} \\right) \\approx 0.05155397 \\ \\mathrm{m} \\times 0.128 \\approx 0.0065989 \\ \\mathrm{m}\n    $$\n\n3.  **无量纲分离长度 $L_b/\\theta_e$ 和分离泡高度 $h_b/\\theta_e$**：\n    我们首先需要求出上游动量厚度 $\\theta_e$。根据雷诺数 $\\mathrm{Re}_{\\theta}$ 的定义：\n    $$\n    \\theta_e = \\frac{\\mu_e \\mathrm{Re}_{\\theta}}{\\rho_e U_e}\n    $$\n    我们计算上游密度 $\\rho_e$ 和速度 $U_e$：\n    $$\n    \\rho_e = \\frac{p_1}{R T_e} = \\frac{5.0 \\times 10^4 \\ \\mathrm{Pa}}{(287 \\ \\mathrm{J/(kg \\cdot K)})(220 \\ \\mathrm{K})} \\approx 0.79255 \\ \\mathrm{kg/m^3}\n    $$\n    $$\n    U_e = M_e \\sqrt{\\gamma R T_e} = 2.5 \\sqrt{(1.4)(287 \\ \\mathrm{J/(kg \\cdot K)})(220 \\ \\mathrm{K})} \\approx 2.5 \\times 297.315 \\ \\mathrm{m/s} \\approx 743.287 \\ \\mathrm{m/s}\n    $$\n    现在我们计算 $\\theta_e$：\n    $$\n    \\theta_e = \\frac{(1.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s})(6000)}{(0.79255 \\ \\mathrm{kg/m^3})(743.287 \\ \\mathrm{m/s})} \\approx \\frac{0.096}{589.10} \\ \\mathrm{m} \\approx 0.0001630 \\ \\mathrm{m}\n    $$\n    有了 $\\theta_e$，我们可以求出无量纲量：\n    $$\n    \\frac{L_b}{\\theta_e} = \\frac{0.045 \\ \\mathrm{m}}{0.0001630 \\ \\mathrm{m}} \\approx 276.0\n    $$\n    $$\n    \\frac{h_b}{\\theta_e} = \\frac{0.0065989 \\ \\mathrm{m}}{0.0001630 \\ \\mathrm{m}} \\approx 40.48\n    $$\n\n4.  **比值 $r_L$ 和 $r_h$**：\n    使用计算值和给定的参考值，我们计算最终的比值。为获得更高精度，我们使用未四舍五入的中间结果。\n    $$\n    \\frac{L_b}{\\theta_e} \\approx 275.984 \\quad \\text{和} \\quad \\frac{h_b}{\\theta_e} \\approx 40.473\n    $$\n    $$\n    r_L = \\frac{L_b/\\theta_e}{(L_b/\\theta_e)_{\\mathrm{ref}}} = \\frac{275.984}{250} \\approx 1.103936\n    $$\n    $$\n    r_h = \\frac{h_b/\\theta_e}{(h_b/\\theta_e)_{\\mathrm{ref}}} = \\frac{40.473}{35} \\approx 1.15637\n    $$\n    四舍五入到四位有效数字，我们得到 $r_L = 1.104$ 和 $r_h = 1.156$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.104  1.156 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "许多重要的SBLI本质上是非定常的，其特征是分离泡的低频振荡。这个动手编程练习  介绍了一种用于诊断这些动态特性的关键数据分析技术。你将通过实现一个信号处理流程来计算瞬态压力信号的功率谱密度(PSD)，从而识别非定常激波运动的主导频率。",
            "id": "3993909",
            "problem": "您的任务是设计一个程序，用于估算来自高精度计算流体动力学（CFD）的壁压时间序列的单边功率谱密度，并自动识别与激波—边界层相互作用（SBLI）相关的低频峰值。该程序必须基于信号处理的第一性原理构建，并明确说明所有假设。您必须实现以下算法流程，并将其应用于提供的由物理上合理的合成壁压信号组成的测试套件。\n\n定义与基本原理：\n- 令壁压信号表示为 $p(t)$，其在时间 $t_n = n / f_s$（其中 $n \\in \\{0,1,\\dots,N-1\\}$）的采样值为 $p_n = p(t_n)$。此处，$f_s$ 是以 $\\mathrm{Hz}$ 为单位的采样频率，$N = f_s T$，$T$ 是以 $\\mathrm{s}$ 为单位的持续时间。\n- 压力脉动信号为 $p^\\prime(t) = p(t) - \\bar{p}$，其中 $\\bar{p}$ 是采样窗口内的时间平均值。\n- $p^\\prime(t)$ 的单边功率谱密度 (PSD) $S_{pp}(f)$ 的单位是 $\\mathrm{Pa}^2/\\mathrm{Hz}$。在连续极限下，根据维纳—辛钦定理，它被定义为自相关函数 $R_{pp}(\\tau)$ 的傅里叶变换：\n$$\nS_{pp}(f) = \\int_{-\\infty}^{\\infty} R_{pp}(\\tau)\\, e^{-i 2 \\pi f \\tau}\\, d\\tau.\n$$\n- 对于离散采样数据，使用韦尔奇方法（周期图平均法）来估计 $S_{pp}(f)$：将 $p^\\prime(t)$ 分割成长度为 $N_{\\mathrm{seg}}$ 个样本的重叠块，重叠率为 $50\\%$；对每个块应用汉宁窗；计算每个块的离散傅里叶变换 (DFT)；形成缩放后的单边周期图；最后将它们平均以减小方差。最终的估计量 $\\hat{S}_{pp}(f)$ 的单位必须是 $\\mathrm{Pa}^2/\\mathrm{Hz}$。\n\n峰值识别：\n- 通过将注意力限制在频带 $f \\in (0, f_{\\mathrm{LF,max}}]$ 内，专注于低频 SBLI 动力学，其中 $f_{\\mathrm{LF,max}}$ 是一个以 $\\mathrm{Hz}$ 为单位的指定上限。\n- 在低频带内使用 $\\hat{S}_{pp}(f)$ 的中位数来定义一个稳健的基线 $B$：\n$$\nB = \\operatorname{median}\\left\\{ \\hat{S}_{pp}(f_k) \\,\\big|\\, f_k \\in (0, f_{\\mathrm{LF,max}}] \\right\\}.\n$$\n- 将低频带内的谱峰识别为凸显度不小于与 $B$ 成比例的阈值的局部最大值。具体来说，如果位于频率 $f^\\star$ 的候选峰的凸显度至少为 $\\theta \\cdot B$，则该峰被接受，其中 $\\theta  0$ 是用户指定的无量纲因子。凸显度定义为峰高与其两侧相邻的两个局部最小值中较高者之间的垂直距离。\n\n程序要求：\n1. 使用物理上合理的组分生成指定的合成壁压信号：\n   - 一个以 $\\mathrm{Pa}$ 为单位的稳定平均压力 $p_0$。\n   - 一个或多个低频正弦分量，用于表示与 SBLI 相关的非定常性，其振幅 $A_i$ 以 $\\mathrm{Pa}$ 为单位，频率 $f_i$ 以 $\\mathrm{Hz}$ 为单位。\n   - 一个可选的高频音调分量，用于表示其他流动特征，其振幅 $A_{\\mathrm{HF}}$ 以 $\\mathrm{Pa}$ 为单位，频率 $f_{\\mathrm{HF}}$ 以 $\\mathrm{Hz}$ 为单位。\n   - 加性、零均值、高斯宽带噪声，其标准差 $\\sigma$ 以 $\\mathrm{Pa}$ 为单位，用于模拟湍流压力脉动。\n   - 总信号为\n   $$\n   p(t) = p_0 + \\sum_i A_i \\sin(2\\pi f_i t) + A_{\\mathrm{HF}}\\sin(2\\pi f_{\\mathrm{HF}} t) + \\eta(t),\n   $$\n   其中 $\\eta(t)$ 是一个标准差为 $\\sigma$ 的高斯白噪声过程。\n2. 移除均值以获得 $p^\\prime(t)$，使用韦尔奇方法（采用汉宁窗、段长 $N_{\\mathrm{seg}}$、50% 重叠率和采样频率 $f_s$）估计单边 PSD $\\hat{S}_{pp}(f)$。将 $\\hat{S}_{pp}(f)$ 以 $\\mathrm{Pa}^2/\\mathrm{Hz}$ 为单位表示。\n3. 在 $(0, f_{\\mathrm{LF,max}}]$ 范围内，使用相对于频带中位数 $B$ 的凸显度准则（因子为 $\\theta$）识别峰值。\n4. 对于每个测试用例，返回检测到的低频峰值位置列表（以 $\\mathrm{Hz}$ 为单位），四舍五入到最近的整数，并按升序排序。\n\n单位和输出格式：\n- 所有频率必须以 $\\mathrm{Hz}$ 表示。\n- 所有压力和振幅必须以 $\\mathrm{Pa}$ 表示。\n- PSD 必须以 $\\mathrm{Pa}^2/\\mathrm{Hz}$ 为单位。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素对应一个测试用例，并且本身是一个由四舍五入到整数的已检测峰值频率组成的列表，例如：$[ [f_{1,1}, f_{1,2}], [], [f_{3,1}] ]$。\n\n测试套件：\n使用固定的随机种子以保证可复现性。对每个用例，生成信号并应用上述算法。参数如下：\n\n- 用例 1（理想情况，两个低频峰值）：\n  - $f_s = 5000\\,\\mathrm{Hz}$，$T = 4\\,\\mathrm{s}$，$N_{\\mathrm{seg}} = 4096$。\n  - $f_{\\mathrm{LF,max}} = 400\\,\\mathrm{Hz}$，$\\theta = 4.0$。\n  - $p_0 = 101325\\,\\mathrm{Pa}$。\n  - 低频分量：$(f_1, A_1) = (80\\,\\mathrm{Hz}, 40\\,\\mathrm{Pa})$，$(f_2, A_2) = (250\\,\\mathrm{Hz}, 25\\,\\mathrm{Pa})$。\n  - 高频音调：$(f_{\\mathrm{HF}}, A_{\\mathrm{HF}}) = (1500\\,\\mathrm{Hz}, 15\\,\\mathrm{Pa})$。\n  - 噪声标准差：$\\sigma = 8\\,\\mathrm{Pa}$。\n\n- 用例 2（边界情况，无低频内容；预期为空列表）：\n  - $f_s = 5000\\,\\mathrm{Hz}$，$T = 4\\,\\mathrm{s}$，$N_{\\mathrm{seg}} = 4096$。\n  - $f_{\\mathrm{LF,max}} = 400\\,\\mathrm{Hz}$，$\\theta = 4.0$。\n  - $p_0 = 101325\\,\\mathrm{Pa}$。\n  - 低频分量：无。\n  - 高频音调：$(f_{\\mathrm{HF}}, A_{\\mathrm{HF}}) = (1200\\,\\mathrm{Hz}, 25\\,\\mathrm{Pa})$。\n  - 噪声标准差：$\\sigma = 10\\,\\mathrm{Pa}$。\n\n- 用例 3（分辨率与低频带内的相近峰值）：\n  - $f_s = 8000\\,\\mathrm{Hz}$，$T = 3\\,\\mathrm{s}$，$N_{\\mathrm{seg}} = 2048$。\n  - $f_{\\mathrm{LF,max}} = 200\\,\\mathrm{Hz}$，$\\theta = 4.0$。\n  - $p_0 = 101325\\,\\mathrm{Pa}$。\n  - 低频分量：$(f_1, A_1) = (95\\,\\mathrm{Hz}, 25\\,\\mathrm{Pa})$，$(f_2, A_2) = (105\\,\\mathrm{Hz}, 22\\,\\mathrm{Pa})$。\n  - 高频音调：$(f_{\\mathrm{HF}}, A_{\\mathrm{HF}}) = (2500\\,\\mathrm{Hz}, 10\\,\\mathrm{Pa})$。\n  - 噪声标准差：$\\sigma = 9\\,\\mathrm{Pa}$。\n\n- 用例 4（边缘情况，靠近频带限制；仅包含限制以下的峰值）：\n  - $f_s = 10000\\,\\mathrm{Hz}$，$T = 2.5\\,\\mathrm{s}$，$N_{\\mathrm{seg}} = 2048$。\n  - $f_{\\mathrm{LF,max}} = 400\\,\\mathrm{Hz}$，$\\theta = 4.0$。\n  - $p_0 = 101325\\,\\mathrm{Pa}$。\n  - 低频分量：$(f_1, A_1) = (395\\,\\mathrm{Hz}, 20\\,\\mathrm{Pa})$，$(f_2, A_2) = (405\\,\\mathrm{Hz}, 20\\,\\mathrm{Pa})$。\n  - 高频音调：$(f_{\\mathrm{HF}}, A_{\\mathrm{HF}}) = (3000\\,\\mathrm{Hz}, 12\\,\\mathrm{Pa})$。\n  - 噪声标准差：$\\sigma = 7\\,\\mathrm{Pa}$。\n\n实现约束：\n- 在韦尔奇方法中使用汉宁窗、50% 重叠率和单边 PSD。\n- 对所有用例使用固定的随机种子，以确保重复运行时输出相同。\n- 您可以使用科学计算 Python 库 SciPy 来实现 PSD 估计器和寻峰功能。\n\n您的程序必须生成单行输出，包含四个结果，格式为一个用方括号括起来的逗号分隔列表，其中每个结果是为四个用例（按顺序）检测到的低频峰值的整数频率列表（升序排列）：$[ \\text{用例 1 结果}, \\text{用例 2 结果}, \\text{用例 3 结果}, \\text{用例 4 结果} ]$。",
            "solution": "用户提供了一个在航空航天应用信号处理领域内定义明确且具有科学依据的问题。任务是设计并实现一种算法，用于在合成的壁压时间序列数据中检测具有激波—边界层相互作用（SBLI）特征的低频峰值。问题陈述是完整、一致的，并依赖于公认的原理。因此，将遵循指定的算法流程来构建解决方案。\n\n该解决方案分四个主要阶段实现：1) 生成合成壁压信号，2) 使用韦尔奇方法估计单边功率谱密度 (PSD)，3) 基于凸显度准则识别低频峰值，以及 4) 格式化最终结果。\n\n**1. 合成壁压信号的生成**\n\n这项任务的基础是一个真实但合成的时域信号 $p(t)$。该信号由具有物理意义的多个分量叠加而成。对于给定的采样频率 $f_s$ (Hz) 和总持续时间 $T$ (s)，我们在时间步长 $t_n = n / f_s$（其中 $n \\in \\{0, 1, \\dots, N-1\\}$）处生成 $N = f_s T$ 个离散样本 $p_n = p(t_n)$。连续模型为：\n$$\np(t) = p_0 + \\sum_i A_i \\sin(2\\pi f_i t) + A_{\\mathrm{HF}}\\sin(2\\pi f_{\\mathrm{HF}} t) + \\eta(t)\n$$\n此处，$p_0$ 是以 $\\mathrm{Pa}$ 为单位的恒定平均压力。总和 $\\sum_i A_i \\sin(2\\pi f_i t)$ 代表与 SBLI 相关的相干低频振荡，其振幅为 $A_i$，频率为 $f_i$。可选的高频音调 $A_{\\mathrm{HF}}\\sin(2\\pi f_{\\mathrm{HF}} t)$ 用于模拟其他独特的空气动力学现象。最后，$\\eta(t)$ 是一个标准差为 $\\sigma$ 的零均值高斯白噪声过程，代表湍流边界层的随机宽带压力脉动。为了保证可复现性，用于创建 $\\eta(t)$ 的伪随机数生成器在所有测试用例中都使用一个固定的整数值作为种子。\n\n**2. 单边功率谱密度 (PSD) 估计**\n\n对非定常现象的分析在频域中最为有效。功率谱密度 $S_{pp}(f)$ 描述了信号功率在频率上的分布。根据问题定义，我们关心的是脉动信号 $p^\\prime(t) = p(t) - \\bar{p}$，其中 $\\bar{p}$ 是信号的时间平均值。PSD 由维纳—辛钦定理正式给出，即信号自相关函数的傅里叶变换。\n\n对于离散、有限长度的信号，必须对 PSD 进行估计。原始周期图（离散傅里叶变换的幅值平方）具有很高的方差。韦尔奇方法通过减小这种方差提供了一个更优的估计。其步骤如下：\n- 将压力脉动信号 $p^\\prime(t)$ 分割成多个重叠段。每个段的长度为 $N_{\\mathrm{seg}}$ 个样本，连续段之间重叠 $50\\%$，即 $N_{\\mathrm{seg}}/2$ 个样本。\n- 每个段都乘以一个汉宁窗函数。这会削弱段数据两端的值，从而减少对非周期性数据应用 DFT 时发生的光谱泄漏。\n- 计算每个加窗段的周期图。\n- 然后将这些单独的周期图平均，以产生最终的 PSD 估计值 $\\hat{S}_{pp}(f)$。\n\n关键在于，为了获得单边 PSD 正确的物理单位 $\\mathrm{Pa}^2/\\mathrm{Hz}$，必须进行适当的缩放。这包括用采样频率 $f_s$ 和窗函数样本的平方和来对结果进行归一化。Python 的 SciPy 库中的 `scipy.signal.welch` 函数会自动完成整个过程。其关键参数如下：\n- `x`: 输入的时间序列，$p(t)$。\n- `fs`: 采样频率，$f_s$。\n- `window`: 设置为 `'hann'` 以使用汉宁窗。\n- `nperseg`: 每个段的长度，$N_{\\mathrm{seg}}$。\n- `noverlap`: 重叠的点数，$N_{\\mathrm{seg}}/2$。\n- `detrend`: 将此项设置为 `'constant'` 等同于从信号中减去均值，从而对 $p^\\prime(t)$ 进行操作。\n- `scaling`: 将此项设置为 `'density'` 可确保输出的 PSD $\\hat{S}_{pp}(f)$ 的单位为（信号单位）$^2/\\mathrm{Hz}$，在本例中即 $\\mathrm{Pa}^2/\\mathrm{Hz}$。\n- `return_onesided`: 对于实值信号，默认为 `True`，提供单边谱。\n\n此过程产生两个数组：一个频率数组 $f_k$ 和对应的 PSD 估计值数组 $\\hat{S}_{pp}(f_k)$。\n\n**3. 低频峰值识别**\n\n该算法旨在自动识别与 SBLI 对应的峰值，这些峰值通常出现在低频范围内。因此，搜索范围被限制在频带 $f_k \\in (0, f_{\\mathrm{LF,max}}]$ 内。$f_k=0$ (DC) 分量被排除在外。\n\n为了将真实峰值与宽带噪声基底区分开来，采用了一种稳健的阈值策略。\n- 首先，在感兴趣的频带内建立一个基线噪声水平 $B$。中位数是用于此目的的稳健统计量，因为它对构成峰值本身的高能量异常值不敏感。基线计算如下：\n$$\nB = \\operatorname{median}\\left\\{ \\hat{S}_{pp}(f_k) \\,\\big|\\, f_k \\in (0, f_{\\mathrm{LF,max}}] \\right\\}\n$$\n- 其次，将峰值识别为 PSD 中的局部最大值。每个峰值的重要性通过其*凸显度*来量化——即峰顶与其两侧相邻的两个局部最小值中较高者之间的垂直距离。\n- 如果一个峰值的凸显度超过了与基线 $B$ 成比例的阈值，则认为该峰值是显著的并被接受。接受准则为：\n$$\n\\text{Prominence}(f^\\star) \\geq \\theta \\cdot B\n$$\n其中 $f^\\star$ 是峰值频率，$\\theta$ 是一个指定的无量纲因子。\n\n这个任务是使用 `scipy.signal.find_peaks` 函数完成的。我们将其应用于 PSD 数组 $\\hat{S}_{pp}$ 中落在低频带内的部分。`prominence` 参数被设置为计算出的阈值 $\\theta \\cdot B$。\n\n**4. 最终处理与输出**\n\n`find_peaks` 函数返回在 PSD 数组的低频部分中已识别峰值的索引。这些索引被映射回频率数组中对应的频率值。根据要求，这些频率被四舍五入到最近的整数并按升序排序。对每个测试用例重复此过程，并将得到的频率列表收集到一个最终列表中。程序的输出就是这个列表的列表，格式化为单行字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef analyze_pressure_signal(params):\n    \"\"\"\n    Analyzes a synthetic pressure signal to find low-frequency peaks.\n\n    This function performs the following steps:\n    1. Generates a time-series signal based on specified components.\n    2. Computes the one-sided Power Spectral Density (PSD) using Welch's method.\n    3. Identifies significant peaks in a specified low-frequency band based on\n       prominence relative to the band's median PSD value.\n    \"\"\"\n    # Unpack parameters for the current test case\n    fs, T, n_seg, f_lf_max, theta, p0, lf_comps, hf_comp, sigma, seed = params\n\n    # Set the random seed for this specific signal generation to ensure reproducibility.\n    # Note: Using the same seed for every case ensures each signal is generated\n    # identically on every run.\n    np.random.seed(seed)\n\n    # 1. Generate the synthetic wall-pressure signal\n    N = int(fs * T)  # Total number of samples\n    t = np.arange(N) / fs  # Time vector\n\n    # Start with the steady mean pressure\n    p_t = np.full(N, p0, dtype=np.float64)\n\n    # Add low-frequency sinusoidal components (SBLI)\n    if lf_comps:\n        for f_i, A_i in lf_comps:\n            p_t += A_i * np.sin(2 * np.pi * f_i * t)\n\n    # Add optional high-frequency tonal component\n    if hf_comp:\n        f_hf, A_hf = hf_comp\n        p_t += A_hf * np.sin(2 * np.pi * f_hf * t)\n\n    # Add Gaussian broadband noise\n    eta_t = np.random.normal(loc=0, scale=sigma, size=N)\n    p_t += eta_t\n\n    # 2. Estimate the one-sided PSD using Welch's method\n    # - detrend='constant' removes the mean from the signal (p' = p - p_bar).\n    # - scaling='density' provides the PSD in units of Pa^2/Hz.\n    # - return_onesided=True is the default for real signals.\n    # - overlap is set to 50% of the segment length.\n    freqs, S_pp = signal.welch(\n        p_t,\n        fs=fs,\n        window='hann',\n        nperseg=n_seg,\n        noverlap=n_seg // 2,\n        detrend='constant',\n        scaling='density'\n    )\n\n    # 3. Identify low-frequency peaks\n    # Isolate the frequency band of interest: (0, f_lf_max]\n    lf_mask = (freqs > 0)  (freqs = f_lf_max)\n    lf_freqs = freqs[lf_mask]\n    lf_S_pp = S_pp[lf_mask]\n    \n    # If the band is empty, there are no peaks to find.\n    if len(lf_S_pp) == 0:\n        return []\n\n    # Calculate the baseline B as the median of the PSD in the low-freq band\n    B = np.median(lf_S_pp)\n\n    # Calculate the prominence threshold\n    prominence_threshold = theta * B\n\n    # Find peaks in the low-frequency PSD using the prominence criterion\n    peak_indices, _ = signal.find_peaks(\n        lf_S_pp,\n        prominence=prominence_threshold\n    )\n\n    # Extract the frequencies corresponding to the detected peak indices\n    detected_freqs = lf_freqs[peak_indices]\n\n    # 4. Format the output for this case\n    # Round to the nearest integer, convert to int, and sort in ascending order.\n    return sorted([int(round(f)) for f in detected_freqs])\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # A single fixed random seed is used for all cases for reproducibility.\n    # This ensures that the noise component of each signal is identical on every run.\n    fixed_seed = 42\n\n    # Define the test suite as per the problem statement\n    test_cases = [\n        # Case 1: Happy path with two clear low-frequency peaks\n        (5000, 4, 4096, 400, 4.0, 101325, [(80, 40), (250, 25)], (1500, 15), 8, fixed_seed),\n        \n        # Case 2: Boundary case with no low-frequency content\n        (5000, 4, 4096, 400, 4.0, 101325, [], (1200, 25), 10, fixed_seed),\n        \n        # Case 3: Case with two closely spaced low-frequency peaks\n        (8000, 3, 2048, 200, 4.0, 101325, [(95, 25), (105, 22)], (2500, 10), 9, fixed_seed),\n        \n        # Case 4: Edge case with one peak just inside the band limit\n        (10000, 2.5, 2048, 400, 4.0, 101325, [(395, 20), (405, 20)], (3000, 12), 7, fixed_seed)\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = analyze_pressure_signal(params)\n        all_results.append(result)\n\n    # Print the final results in the exact specified format: [[80,250],[],[100],[395]]\n    # Using str() and replace() is a direct way to achieve the required compact format.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}