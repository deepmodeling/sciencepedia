{
    "hands_on_practices": [
        {
            "introduction": "Understanding the response of a turbulent boundary layer to the adverse pressure gradient imposed by a shock wave is fundamental to SBLI modeling. This practice focuses on quantifying the state of the boundary layer by calculating key local parameters directly from a velocity profile . By computing the skin-friction coefficient, $C_f$, and the Clauser pressure-gradient parameter, $\\beta$, you will gain hands-on experience in assessing a boundary layer's proximity to separation, a critical skill for analyzing CFD results.",
            "id": "3993935",
            "problem": "A two-dimensional Shock–Boundary Layer Interaction (SBLI) forms over a flat plate upstream of a compression ramp. At a streamwise station just downstream of the shock foot, the mean streamwise velocity profile in the viscous sublayer and log-layer is well-approximated by the measured fit $u(y) = U_{e}\\left(1 - \\exp\\left(-\\frac{y}{a}\\right)\\right)$ for $y \\ge 0$, where $y$ is the wall-normal coordinate, $U_{e}$ is the boundary-layer edge speed, and $a$ is a length scale characterizing the near-wall profile. Assume the following at this station: the dynamic viscosity at the wall is constant and equal to $\\mu_{w}$, the density is approximately uniform across the boundary layer and equal to $\\rho_{e}$, and the edge pressure varies as $p_{e}(x)$ with a measured adverse gradient $\\frac{d p_{e}}{d x} > 0$. Under these assumptions, use fundamental definitions to compute the skin-friction coefficient $C_{f}$ and the Clauser pressure-gradient parameter $\\beta$ from the given dataset:\n- $U_{e} = 600 \\ \\mathrm{m/s}$,\n- $\\rho_{e} = 0.600 \\ \\mathrm{kg/m^{3}}$,\n- $\\mu_{w} = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$,\n- $a = 2.00 \\times 10^{-3} \\ \\mathrm{m}$,\n- $\\frac{d p_{e}}{d x} = 3.00 \\times 10^{4} \\ \\mathrm{Pa/m}$.\n\nAdopt the no-slip condition at the wall and treat the edge as inviscid. Use the definition of wall shear stress based on Newtonian viscosity, the standard definition of the skin-friction coefficient, and the definition of the Clauser pressure-gradient parameter in terms of the displacement thickness and the wall shear stress. Report both $C_{f}$ and $\\beta$ rounded to three significant figures. Express the final results as dimensionless numbers with no units.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded in the principles of fluid dynamics, specifically boundary layer theory, and is well-posed with sufficient information to derive a unique solution for the requested quantities. The given physical parameters are plausible for a high-speed aerodynamic scenario involving a shock–boundary layer interaction. We shall proceed with a formal derivation.\n\nThe problem requires the computation of two dimensionless parameters: the skin-friction coefficient, $C_{f}$, and the Clauser pressure-gradient parameter, $\\beta$. This will be executed in two parts.\n\nPart 1: Calculation of the Skin-Friction Coefficient, $C_{f}$\n\nThe skin-friction coefficient is defined as the wall shear stress, $\\tau_{w}$, non-dimensionalized by the freestream dynamic pressure.\n$$C_{f} = \\frac{\\tau_{w}}{\\frac{1}{2}\\rho_{e}U_{e}^{2}}$$\nThe wall shear stress, $\\tau_{w}$, for a Newtonian fluid under the no-slip condition is given by the product of the dynamic viscosity at the wall, $\\mu_{w}$, and the velocity gradient at the wall.\n$$\\tau_{w} = \\mu_{w} \\left( \\frac{\\partial u}{\\partial y} \\right)_{y=0}$$\nWe are given the streamwise velocity profile as a function of the wall-normal coordinate $y$:\n$$u(y) = U_{e}\\left(1 - \\exp\\left(-\\frac{y}{a}\\right)\\right)$$\nFirst, we must compute the velocity gradient, $\\frac{\\partial u}{\\partial y}$, by differentiating the velocity profile with respect to $y$.\n$$\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ U_{e}\\left(1 - \\exp\\left(-\\frac{y}{a}\\right)\\right) \\right] = U_{e} \\left( - \\exp\\left(-\\frac{y}{a}\\right) \\cdot \\left(-\\frac{1}{a}\\right) \\right) = \\frac{U_{e}}{a} \\exp\\left(-\\frac{y}{a}\\right)$$\nNext, we evaluate this gradient at the wall, i.e., at $y=0$.\n$$\\left( \\frac{\\partial u}{\\partial y} \\right)_{y=0} = \\frac{U_{e}}{a} \\exp(0) = \\frac{U_{e}}{a}$$\nNow, we can compute the wall shear stress, $\\tau_{w}$.\n$$\\tau_{w} = \\mu_{w} \\frac{U_{e}}{a}$$\nSubstituting this expression for $\\tau_{w}$ into the definition of $C_{f}$:\n$$C_{f} = \\frac{\\mu_{w} \\frac{U_{e}}{a}}{\\frac{1}{2}\\rho_{e}U_{e}^{2}} = \\frac{2\\mu_{w}}{\\rho_{e}U_{e}a}$$\nWe are provided with the following numerical values:\n- $U_{e} = 600 \\ \\mathrm{m/s}$\n- $\\rho_{e} = 0.600 \\ \\mathrm{kg/m^{3}}$\n- $\\mu_{w} = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$\n- $a = 2.00 \\times 10^{-3} \\ \\mathrm{m}$\n\nSubstituting these values into the expression for $C_{f}$:\n$$C_{f} = \\frac{2(1.80 \\times 10^{-5})}{(0.600)(600)(2.00 \\times 10^{-3})} = \\frac{3.60 \\times 10^{-5}}{720 \\times 10^{-3}} = \\frac{3.60 \\times 10^{-5}}{0.720} = 5.00 \\times 10^{-5}$$\nThe skin-friction coefficient, rounded to three significant figures, is $5.00 \\times 10^{-5}$.\n\nPart 2: Calculation of the Clauser Pressure-Gradient Parameter, $\\beta$\n\nThe Clauser parameter, $\\beta$, is defined as:\n$$\\beta = \\frac{\\delta^{*}}{\\tau_{w}} \\frac{dp_{e}}{dx}$$\nwhere $\\delta^{*}$ is the displacement thickness and $\\frac{dp_{e}}{dx}$ is the streamwise pressure gradient at the boundary-layer edge.\n\nFirst, we must calculate the displacement thickness, $\\delta^{*}$, defined as:\n$$\\delta^{*} = \\int_{0}^{\\infty} \\left(1 - \\frac{u(y)}{U_{e}}\\right) dy$$\nSubstituting the given velocity profile into the integrand:\n$$1 - \\frac{u(y)}{U_{e}} = 1 - \\frac{U_{e}\\left(1 - \\exp\\left(-\\frac{y}{a}\\right)\\right)}{U_{e}} = 1 - \\left(1 - \\exp\\left(-\\frac{y}{a}\\right)\\right) = \\exp\\left(-\\frac{y}{a}\\right)$$\nNow we perform the integration to find $\\delta^{*}$:\n$$\\delta^{*} = \\int_{0}^{\\infty} \\exp\\left(-\\frac{y}{a}\\right) dy = \\left[ -a \\exp\\left(-\\frac{y}{a}\\right) \\right]_{0}^{\\infty} = (-a \\cdot 0) - (-a \\cdot \\exp(0)) = a$$\nThus, the displacement thickness is equal to the length scale $a$.\n$$\\delta^{*} = a$$\nNow we can write the expression for $\\beta$ by substituting the expressions for $\\delta^{*}$ and $\\tau_{w}$:\n$$\\beta = \\frac{a}{\\mu_{w} \\frac{U_{e}}{a}} \\frac{dp_{e}}{dx} = \\frac{a^{2}}{\\mu_{w}U_{e}} \\frac{dp_{e}}{dx}$$\nWe are provided with the additional numerical value:\n- $\\frac{dp_{e}}{dx} = 3.00 \\times 10^{4} \\ \\mathrm{Pa/m}$\n\nSubstituting all known values into the expression for $\\beta$:\n$$\\beta = \\frac{(2.00 \\times 10^{-3})^{2}}{(1.80 \\times 10^{-5})(600)} (3.00 \\times 10^{4})$$\n$$\\beta = \\frac{4.00 \\times 10^{-6}}{1.08 \\times 10^{-2}} (3.00 \\times 10^{4}) = \\frac{12.00 \\times 10^{-2}}{1.08 \\times 10^{-2}} = \\frac{12.00}{1.08} \\approx 11.111...$$\nRounding the result to three significant figures, we get:\n$$\\beta = 11.1$$\nThe computed values for the skin-friction coefficient and the Clauser parameter are $C_{f} = 5.00 \\times 10^{-5}$ and $\\beta = 11.1$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 5.00 \\times 10^{-5} & 11.1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "A defining feature of Shock-Boundary Layer Interaction is the two-way coupling between the viscous boundary layer and the outer inviscid flow. In this exercise, you will explore this 'interaction' by modeling the separation bubble as an effective ramp that deflects the supersonic stream . Using linearized small-disturbance theory, you will derive a relationship between the observed wall-pressure plateau and the dimensions of the separation bubble, providing insight into how CFD models can capture the global structure of separated SBLI.",
            "id": "3993937",
            "problem": "A two-dimensional steady supersonic Shock–Boundary Layer Interaction (SBLI) occurs when an oblique shock impinges on a turbulent boundary layer over a nominally flat wall. In the separated interaction region, the measured wall pressure distribution exhibits a pressure plateau. Assume the outer inviscid flow responds to the boundary layer displacement through linearized supersonic small-disturbance theory, and model the influence of the separation bubble as an additional displacement thickness that is constant across the plateau.\n\nThe incoming conditions are: Mach number $M_{e} = 2.5$, static pressure upstream of interaction $p_{1} = 5.0 \\times 10^{4} \\ \\mathrm{Pa}$, static temperature $T_{e} = 220 \\ \\mathrm{K}$, ratio of specific heats $\\gamma = 1.4$, specific gas constant $R = 287 \\ \\mathrm{J/(kg \\cdot K)}$, and dynamic viscosity $\\mu_{e} = 1.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$. The Reynolds number based on upstream momentum thickness is $\\mathrm{Re}_{\\theta} = 6000$, where $\\mathrm{Re}_{\\theta} \\equiv \\rho_{e} U_{e} \\theta_{e} / \\mu_{e}$, with $\\rho_{e}$ and $U_{e}$ the upstream density and edge velocity and $\\theta_{e}$ the upstream momentum thickness.\n\nThe measured wall pressure distribution $p_{w}(x)$ has a constant plateau of $p_{\\mathrm{plat}} = 7.8 \\times 10^{4} \\ \\mathrm{Pa}$ extending from the separation onset location $x_{s} = 0.050 \\ \\mathrm{m}$ to the reattachment location $x_{r} = 0.095 \\ \\mathrm{m}$, outside of which $p_{w}(x)$ equals $p_{1}$. Treat the plateau as spatially uniform at $p_{\\mathrm{plat}}$.\n\nStarting from linearized supersonic small-disturbance theory and the definition of displacement thickness as an effective wall deflection for the outer inviscid flow, derive a relation linking the additional displacement thickness across the plateau to the wall-pressure rise. Using this relation, compute:\n1) the bubble length $L_{b}$ defined as $L_{b} = x_{r} - x_{s}$,\n2) the bubble height $h_{b}$ interpreted as the additional displacement thickness across the plateau,\n3) the nondimensional separation length $L_{b}/\\theta_{e}$ and bubble height $h_{b}/\\theta_{e}$.\n\nFor comparison at similar $M_{e}$ and $\\mathrm{Re}_{\\theta}$, empirical correlations report reference values $(L_{b}/\\theta_{e})_{\\mathrm{ref}} = 250$ and $(h_{b}/\\theta_{e})_{\\mathrm{ref}} = 35$. Compute the ratios\n$$\nr_{L} = \\frac{L_{b}/\\theta_{e}}{(L_{b}/\\theta_{e})_{\\mathrm{ref}}}\n\\quad \\text{and} \\quad\nr_{h} = \\frac{h_{b}/\\theta_{e}}{(h_{b}/\\theta_{e})_{\\mathrm{ref}}}.\n$$\nExpress the final answer as the row matrix $\\begin{pmatrix} r_{L} & r_{h} \\end{pmatrix}$, unitless, and round to four significant figures.",
            "solution": "The problem statement is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n-   Incoming Mach number: $M_{e} = 2.5$\n-   Upstream static pressure: $p_{1} = 5.0 \\times 10^{4} \\ \\mathrm{Pa}$\n-   Static temperature: $T_{e} = 220 \\ \\mathrm{K}$\n-   Ratio of specific heats: $\\gamma = 1.4$\n-   Specific gas constant: $R = 287 \\ \\mathrm{J/(kg \\cdot K)}$\n-   Dynamic viscosity: $\\mu_{e} = 1.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$\n-   Reynolds number based on momentum thickness: $\\mathrm{Re}_{\\theta} = 6000$\n-   Definition of Reynolds number: $\\mathrm{Re}_{\\theta} \\equiv \\rho_{e} U_{e} \\theta_{e} / \\mu_{e}$\n-   Plateau pressure: $p_{\\mathrm{plat}} = 7.8 \\times 10^{4} \\ \\mathrm{Pa}$\n-   Separation onset location: $x_{s} = 0.050 \\ \\mathrm{m}$\n-   Reattachment location: $x_{r} = 0.095 \\ \\mathrm{m}$\n-   Reference nondimensional length: $(L_{b}/\\theta_{e})_{\\mathrm{ref}} = 250$\n-   Reference nondimensional height: $(h_{b}/\\theta_{e})_{\\mathrm{ref}} = 35$\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem describes a classic supersonic shock-wave/turbulent-boundary-layer interaction (SBLI). The use of linearized small-disturbance theory is a standard first-order approximation for the inviscid flow response. The physical quantities provided ($M_e$, $p_1$, $T_e$, etc.) are realistic for aerodynamic applications. The concept of a pressure plateau in separated flow is a well-documented experimental phenomenon. The problem is scientifically sound.\n-   **Well-Posed**: The problem is clearly stated, providing all necessary data and definitions to calculate the required quantities. The steps are logically defined, and a unique solution can be determined.\n-   **Objective**: The language is technical and precise, free from subjective or ambiguous statements.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically grounded, well-posed, and objective. A solution will be provided.\n\nThe solution proceeds by first deriving the relationship between the pressure rise and the effective geometry of the separation bubble, then calculating the required parameters in sequence.\n\nFirst, we derive the relation between the additional displacement thickness across the plateau, interpreted as the bubble height $h_b$, and the wall-pressure rise. According to linearized supersonic small-disturbance theory, the pressure coefficient $C_p$ on a surface is related to the local flow deflection angle $\\alpha$ by the Ackeret formula:\n$$\nC_p = \\frac{2\\alpha}{\\sqrt{M_e^2 - 1}}\n$$\nThe problem states that the wall pressure is constant at $p_{\\mathrm{plat}}$ over the separation bubble. A constant pressure implies a constant pressure coefficient $C_p$, which in turn implies a constant flow deflection angle $\\alpha$. This means the effective surface of the boundary layer's displacement thickness, $\\delta^*(x)$, must have a constant slope over the length of the bubble, $L_b$.\nThe bubble height $h_b$ is the total additional rise in displacement thickness over the length $L_b = x_r - x_s$. Therefore, the constant slope, which is the effective flow deflection angle, is given by:\n$$\n\\alpha = \\frac{h_b}{L_b}\n$$\nThe pressure coefficient $C_p$ is defined as the pressure difference normalized by the upstream dynamic pressure, $q_e$:\n$$\nC_p = \\frac{p_{\\mathrm{plat}} - p_1}{q_e}\n$$\nThe dynamic pressure $q_e$ can be expressed in terms of upstream static properties using the ideal gas law ($p_1 = \\rho_e R T_e$) and the definitions of the Mach number ($M_e = U_e/a_e$) and speed of sound ($a_e = \\sqrt{\\gamma R T_e}$):\n$$\nq_e = \\frac{1}{2}\\rho_e U_e^2 = \\frac{1}{2}\\left(\\frac{p_1}{RT_e}\\right)(M_e \\sqrt{\\gamma R T_e})^2 = \\frac{1}{2}\\frac{p_1}{RT_e}(M_e^2 \\gamma R T_e) = \\frac{1}{2}\\gamma p_1 M_e^2\n$$\nBy substituting the expressions for $\\alpha$ and $C_p$ into the Ackeret formula, we obtain:\n$$\n\\frac{p_{\\mathrm{plat}} - p_1}{q_e} = \\frac{2(h_b/L_b)}{\\sqrt{M_e^2 - 1}}\n$$\nSolving for the bubble height $h_b$ yields the desired relation:\n$$\nh_b = \\frac{L_b \\sqrt{M_e^2 - 1}}{2} \\left( \\frac{p_{\\mathrm{plat}} - p_1}{q_e} \\right)\n$$\nNow we compute the required quantities.\n\n1.  **Bubble length $L_b$**:\n    The bubble length is the distance between reattachment and separation.\n    $$\n    L_b = x_r - x_s = 0.095 \\ \\mathrm{m} - 0.050 \\ \\mathrm{m} = 0.045 \\ \\mathrm{m}\n    $$\n\n2.  **Bubble height $h_b$**:\n    First, we calculate the upstream dynamic pressure $q_e$.\n    $$\n    q_e = \\frac{1}{2}\\gamma p_1 M_e^2 = \\frac{1}{2}(1.4)(5.0 \\times 10^4 \\ \\mathrm{Pa})(2.5)^2 = 218750 \\ \\mathrm{Pa}\n    $$\n    The pressure rise across the interaction is:\n    $$\n    p_{\\mathrm{plat}} - p_1 = 7.8 \\times 10^4 \\ \\mathrm{Pa} - 5.0 \\times 10^4 \\ \\mathrm{Pa} = 2.8 \\times 10^4 \\ \\mathrm{Pa}\n    $$\n    The Mach number term is:\n    $$\n    \\sqrt{M_e^2 - 1} = \\sqrt{2.5^2 - 1} = \\sqrt{6.25 - 1} = \\sqrt{5.25}\n    $$\n    Now, we can compute $h_b$:\n    $$\n    h_b = \\frac{(0.045 \\ \\mathrm{m}) \\sqrt{5.25}}{2} \\left( \\frac{2.8 \\times 10^4 \\ \\mathrm{Pa}}{218750 \\ \\mathrm{Pa}} \\right) \\approx 0.05155397 \\ \\mathrm{m} \\times 0.128 \\approx 0.0065989 \\ \\mathrm{m}\n    $$\n\n3.  **Nondimensional separation length $L_b/\\theta_e$ and bubble height $h_b/\\theta_e$**:\n    We first need to find the upstream momentum thickness $\\theta_e$. From the definition of the Reynolds number $\\mathrm{Re}_{\\theta}$:\n    $$\n    \\theta_e = \\frac{\\mu_e \\mathrm{Re}_{\\theta}}{\\rho_e U_e}\n    $$\n    We calculate the upstream density $\\rho_e$ and velocity $U_e$:\n    $$\n    \\rho_e = \\frac{p_1}{R T_e} = \\frac{5.0 \\times 10^4 \\ \\mathrm{Pa}}{(287 \\ \\mathrm{J/(kg \\cdot K)})(220 \\ \\mathrm{K})} \\approx 0.79255 \\ \\mathrm{kg/m^3}\n    $$\n    $$\n    U_e = M_e \\sqrt{\\gamma R T_e} = 2.5 \\sqrt{(1.4)(287 \\ \\mathrm{J/(kg \\cdot K)})(220 \\ \\mathrm{K})} \\approx 2.5 \\times 297.315 \\ \\mathrm{m/s} \\approx 743.287 \\ \\mathrm{m/s}\n    $$\n    Now we compute $\\theta_e$:\n    $$\n    \\theta_e = \\frac{(1.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s})(6000)}{(0.79255 \\ \\mathrm{kg/m^3})(743.287 \\ \\mathrm{m/s})} \\approx \\frac{0.096}{589.10} \\ \\mathrm{m} \\approx 0.0001630 \\ \\mathrm{m}\n    $$\n    With $\\theta_e$, we can find the nondimensional quantities:\n    $$\n    \\frac{L_b}{\\theta_e} = \\frac{0.045 \\ \\mathrm{m}}{0.0001630 \\ \\mathrm{m}} \\approx 276.0\n    $$\n    $$\n    \\frac{h_b}{\\theta_e} = \\frac{0.0065989 \\ \\mathrm{m}}{0.0001630 \\ \\mathrm{m}} \\approx 40.48\n    $$\n\n4.  **Ratios $r_L$ and $r_h$**:\n    Using the computed values and the given reference values, we calculate the final ratios. For better precision, we use the unrounded intermediate results.\n    $$\n    \\frac{L_b}{\\theta_e} \\approx 275.984 \\quad \\text{and} \\quad \\frac{h_b}{\\theta_e} \\approx 40.473\n    $$\n    $$\n    r_L = \\frac{L_b/\\theta_e}{(L_b/\\theta_e)_{\\mathrm{ref}}} = \\frac{275.984}{250} \\approx 1.103936\n    $$\n    $$\n    r_h = \\frac{h_b/\\theta_e}{(h_b/\\theta_e)_{\\mathrm{ref}}} = \\frac{40.473}{35} \\approx 1.15637\n    $$\n    Rounding to four significant figures, we get $r_L = 1.104$ and $r_h = 1.156$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.104 & 1.156 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Beyond steady-state structures, many SBLIs exhibit large-scale, low-frequency unsteadiness that is critical to predict for applications involving structural loads and thermal fatigue. This hands-on coding practice guides you through the essential task of analyzing time-accurate CFD data to identify these characteristic frequencies . You will implement a full signal processing pipeline, from estimating the power spectral density (PSD) of a wall-pressure signal to automatically detecting significant peaks, a core skill for researchers studying unsteady aerodynamics.",
            "id": "3993909",
            "problem": "You are given the task of designing a program that estimates the one-sided power spectral density of a wall-pressure time series from time-accurate Computational Fluid Dynamics (CFD) and automatically identifies low-frequency peaks associated with Shock–Boundary Layer Interaction (SBLI). The program must be constructed from first principles of signal processing and clearly state all assumptions. You must implement the following algorithmic pipeline and apply it to the provided test suite of synthetic, physically plausible wall-pressure signals.\n\nDefinitions and fundamental base:\n- Let the wall-pressure signal be denoted by $p(t)$ with sample values $p_n = p(t_n)$ at times $t_n = n / f_s$ for $n \\in \\{0,1,\\dots,N-1\\}$, where $f_s$ is the sampling frequency in $\\mathrm{Hz}$ and $N = f_s T$ for duration $T$ in $\\mathrm{s}$.\n- The pressure fluctuation signal is $p^\\prime(t) = p(t) - \\bar{p}$, where $\\bar{p}$ is the time-average over the sampled window.\n- The one-sided power spectral density (PSD) $S_{pp}(f)$ of $p^\\prime(t)$ has units $\\mathrm{Pa}^2/\\mathrm{Hz}$ and is defined, in the continuous limit, via the Wiener–Khinchin theorem as the Fourier transform of the autocorrelation function $R_{pp}(\\tau)$:\n$$\nS_{pp}(f) = \\int_{-\\infty}^{\\infty} R_{pp}(\\tau)\\, e^{-i 2 \\pi f \\tau}\\, d\\tau.\n$$\n- For discrete sampled data, estimate $S_{pp}(f)$ using Welch’s method (periodogram averaging): segment $p^\\prime(t)$ into overlapping blocks of length $N_{\\mathrm{seg}}$ samples with $50\\%$ overlap, apply a Hann window to each block, compute each block’s discrete Fourier transform (DFT), form the scaled one-sided periodograms, and average them to reduce variance. The resulting estimator $\\hat{S}_{pp}(f)$ must have units $\\mathrm{Pa}^2/\\mathrm{Hz}$.\n\nPeak identification:\n- Focus on low-frequency SBLI dynamics by restricting attention to the band $f \\in (0, f_{\\mathrm{LF,max}}]$, where $f_{\\mathrm{LF,max}}$ is a specified upper bound in $\\mathrm{Hz}$.\n- Define a robust baseline within the low-frequency band using the median of $\\hat{S}_{pp}(f)$:\n$$\nB = \\operatorname{median}\\left\\{ \\hat{S}_{pp}(f_k) \\,\\big|\\, f_k \\in (0, f_{\\mathrm{LF,max}}] \\right\\}.\n$$\n- Identify spectral peaks in the low-frequency band as local maxima with prominence not less than a threshold proportional to $B$. Specifically, a candidate peak at frequency $f^\\star$ is accepted if its prominence is at least $\\theta \\cdot B$, where $\\theta > 0$ is a user-specified dimensionless factor. Prominence is defined as the vertical distance between the peak height and the higher of the two neighboring minima in the PSD curve.\n\nProgram requirements:\n1. Generate the specified synthetic wall-pressure signals using physically plausible components:\n   - A steady mean pressure $p_0$ in $\\mathrm{Pa}$.\n   - One or more low-frequency sinusoidal components intended to represent SBLI-related unsteadiness, with amplitudes $A_i$ in $\\mathrm{Pa}$ and frequencies $f_i$ in $\\mathrm{Hz}$.\n   - An optional high-frequency tonal component representing other flow features, with amplitude $A_{\\mathrm{HF}}$ in $\\mathrm{Pa}$ and frequency $f_{\\mathrm{HF}}$ in $\\mathrm{Hz}$.\n   - Additive, zero-mean, Gaussian broadband noise with standard deviation $\\sigma$ in $\\mathrm{Pa}$ to model turbulent pressure fluctuations.\n   - The total signal is\n   $$\n   p(t) = p_0 + \\sum_i A_i \\sin(2\\pi f_i t) + A_{\\mathrm{HF}}\\sin(2\\pi f_{\\mathrm{HF}} t) + \\eta(t),\n   $$\n   where $\\eta(t)$ is a Gaussian white-noise process with standard deviation $\\sigma$.\n2. Remove the mean to obtain $p^\\prime(t)$, estimate the one-sided PSD $\\hat{S}_{pp}(f)$ using Welch’s method with Hann window, segment length $N_{\\mathrm{seg}}$, and $50\\%$ overlap, and sampling frequency $f_s$. Express $\\hat{S}_{pp}(f)$ in $\\mathrm{Pa}^2/\\mathrm{Hz}$.\n3. Identify peaks within $(0, f_{\\mathrm{LF,max}}]$ using the prominence criterion with factor $\\theta$ relative to the band median $B$.\n4. For each test case, return the list of detected low-frequency peak locations in $\\mathrm{Hz}$, rounded to the nearest integer, sorted in ascending order.\n\nUnits and output format:\n- All frequencies must be expressed in $\\mathrm{Hz}$.\n- All pressures and amplitudes must be expressed in $\\mathrm{Pa}$.\n- The PSD must be in $\\mathrm{Pa}^2/\\mathrm{Hz}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of detected peak frequencies rounded to integers, for example: $[ [f_{1,1}, f_{1,2}], [], [f_{3,1}] ]$.\n\nTest suite:\nUse a fixed random seed for reproducibility. For each case, generate the signal and apply the above algorithm. The parameters are:\n\n- Case $1$ (happy path, two low-frequency peaks):\n  - $f_s = 5000\\,\\mathrm{Hz}$, $T = 4\\,\\mathrm{s}$, $N_{\\mathrm{seg}} = 4096$.\n  - $f_{\\mathrm{LF,max}} = 400\\,\\mathrm{Hz}$, $\\theta = 4.0$.\n  - $p_0 = 101325\\,\\mathrm{Pa}$.\n  - Low-frequency components: $(f_1, A_1) = (80\\,\\mathrm{Hz}, 40\\,\\mathrm{Pa})$, $(f_2, A_2) = (250\\,\\mathrm{Hz}, 25\\,\\mathrm{Pa})$.\n  - High-frequency tone: $(f_{\\mathrm{HF}}, A_{\\mathrm{HF}}) = (1500\\,\\mathrm{Hz}, 15\\,\\mathrm{Pa})$.\n  - Noise standard deviation: $\\sigma = 8\\,\\mathrm{Pa}$.\n\n- Case $2$ (boundary case, no low-frequency content; expect empty list):\n  - $f_s = 5000\\,\\mathrm{Hz}$, $T = 4\\,\\mathrm{s}$, $N_{\\mathrm{seg}} = 4096$.\n  - $f_{\\mathrm{LF,max}} = 400\\,\\mathrm{Hz}$, $\\theta = 4.0$.\n  - $p_0 = 101325\\,\\mathrm{Pa}$.\n  - Low-frequency components: none.\n  - High-frequency tone: $(f_{\\mathrm{HF}}, A_{\\mathrm{HF}}) = (1200\\,\\mathrm{Hz}, 25\\,\\mathrm{Pa})$.\n  - Noise standard deviation: $\\sigma = 10\\,\\mathrm{Pa}$.\n\n- Case $3$ (resolution and close peaks in low-frequency band):\n  - $f_s = 8000\\,\\mathrm{Hz}$, $T = 3\\,\\mathrm{s}$, $N_{\\mathrm{seg}} = 2048$.\n  - $f_{\\mathrm{LF,max}} = 200\\,\\mathrm{Hz}$, $\\theta = 4.0$.\n  - $p_0 = 101325\\,\\mathrm{Pa}$.\n  - Low-frequency components: $(f_1, A_1) = (95\\,\\mathrm{Hz}, 25\\,\\mathrm{Pa})$, $(f_2, A_2) = (105\\,\\mathrm{Hz}, 22\\,\\mathrm{Pa})$.\n  - High-frequency tone: $(f_{\\mathrm{HF}}, A_{\\mathrm{HF}}) = (2500\\,\\mathrm{Hz}, 10\\,\\mathrm{Pa})$.\n  - Noise standard deviation: $\\sigma = 9\\,\\mathrm{Pa}$.\n\n- Case $4$ (edge case near band limit; only include the peak below the limit):\n  - $f_s = 10000\\,\\mathrm{Hz}$, $T = 2.5\\,\\mathrm{s}$, $N_{\\mathrm{seg}} = 2048$.\n  - $f_{\\mathrm{LF,max}} = 400\\,\\mathrm{Hz}$, $\\theta = 4.0$.\n  - $p_0 = 101325\\,\\mathrm{Pa}$.\n  - Low-frequency components: $(f_1, A_1) = (395\\,\\mathrm{Hz}, 20\\,\\mathrm{Pa})$, $(f_2, A_2) = (405\\,\\mathrm{Hz}, 20\\,\\mathrm{Pa})$.\n  - High-frequency tone: $(f_{\\mathrm{HF}}, A_{\\mathrm{HF}}) = (3000\\,\\mathrm{Hz}, 12\\,\\mathrm{Pa})$.\n  - Noise standard deviation: $\\sigma = 7\\,\\mathrm{Pa}$.\n\nImplementation constraints:\n- Use Hann window in Welch’s method, $50\\%$ overlap, and one-sided PSD.\n- Use a fixed random seed for all cases to ensure identical outputs on repeated runs.\n- You may use the Scientific Python library SciPy for the PSD estimator and peak-finding functionality.\n\nYour program must produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, where each result is a list of integer frequencies in $\\mathrm{Hz}$ for the detected low-frequency peaks, sorted ascending, for the four cases in order: $[ \\text{Case 1 result}, \\text{Case 2 result}, \\text{Case 3 result}, \\text{Case 4 result} ]$.",
            "solution": "The user has provided a well-posed and scientifically grounded problem in the domain of signal processing for aerospace applications. The task is to design and implement an algorithm to detect low-frequency peaks, characteristic of Shock–Boundary Layer Interaction (SBLI), in synthetic wall-pressure time series data. The problem statement is complete, consistent, and relies on established principles. Therefore, a solution will be constructed following the specified algorithmic pipeline.\n\nThe solution is implemented in four main stages: $1$) generation of a synthetic wall-pressure signal, $2$) estimation of the one-sided Power Spectral Density (PSD) using Welch's method, $3$) identification of low-frequency peaks based on a prominence criterion, and $4$) formatting of the final results.\n\n**1. Synthetic Wall-Pressure Signal Generation**\n\nThe foundation of this task is a realistic, albeit synthetic, time-domain signal, $p(t)$. This signal is constructed as a superposition of physically meaningful components. For a given sampling frequency $f_s$ in $\\mathrm{Hz}$ and a total duration $T$ in $\\mathrm{s}$, we generate $N = f_s T$ discrete samples $p_n = p(t_n)$ at time steps $t_n = n / f_s$ for $n \\in \\{0, 1, \\dots, N-1\\}$. The continuous model is:\n$$\np(t) = p_0 + \\sum_i A_i \\sin(2\\pi f_i t) + A_{\\mathrm{HF}}\\sin(2\\pi f_{\\mathrm{HF}} t) + \\eta(t)\n$$\nHere, $p_0$ is the constant mean pressure in $\\mathrm{Pa}$. The sum $\\sum_i A_i \\sin(2\\pi f_i t)$ represents the coherent, low-frequency oscillations associated with SBLI, with amplitudes $A_i$ and frequencies $f_i$. An optional high-frequency tone $A_{\\mathrm{HF}}\\sin(2\\pi f_{\\mathrm{HF}} t)$ models other distinct aerodynamic phenomena. Finally, $\\eta(t)$ is a zero-mean Gaussian white-noise process with standard deviation $\\sigma$, representing the stochastic, broadband pressure fluctuations of a turbulent boundary layer. For reproducibility, the pseudo-random number generator used to create $\\eta(t)$ is seeded with a fixed integer value across all test cases.\n\n**2. One-Sided Power Spectral Density (PSD) Estimation**\n\nThe analysis of unsteady phenomena is most effectively performed in the frequency domain. The Power Spectral Density, $S_{pp}(f)$, describes the distribution of the signal's power over frequency. As per the problem definition, we are interested in the fluctuations $p^\\prime(t) = p(t) - \\bar{p}$, where $\\bar{p}$ is the time average of the signal. The PSD is formally given by the Wiener–Khinchin theorem as the Fourier transform of the signal's autocorrelation function.\n\nFor discrete, finite-length signals, the PSD must be estimated. A raw periodogram (the squared magnitude of the Discrete Fourier Transform) suffers from high variance. Welch's method provides a superior estimate by reducing this variance. The procedure is as follows:\n- The pressure fluctuation signal $p^\\prime(t)$ is partitioned into multiple overlapping segments. Each segment has a length of $N_{\\mathrm{seg}}$ samples, and consecutive segments overlap by $50\\%$, i.e., $N_{\\mathrm{seg}}/2$ samples.\n- Each segment is multiplied by a Hann window function. This tapers the segment's data at its ends, reducing spectral leakage that occurs when applying the DFT to non-periodic data.\n- The periodogram of each windowed segment is computed.\n- These individual periodograms are then averaged to produce the final PSD estimate, $\\hat{S}_{pp}(f)$.\n\nCrucially, to obtain the correct physical units of $\\mathrm{Pa}^2/\\mathrm{Hz}$ for the one-sided PSD, proper scaling must be applied. This involves normalizing the result by the sampling frequency $f_s$ and the sum of squares of the window function samples. The `scipy.signal.welch` function in Python's SciPy library automates this entire process. The key parameters are:\n- `x`: The input time series, $p(t)$.\n- `fs`: The sampling frequency, $f_s$.\n- `window`: Set to `'hann'` for the Hann window.\n- `nperseg`: The length of each segment, $N_{\\mathrm{seg}}$.\n- `noverlap`: The number of overlapping points, $N_{\\mathrm{seg}}/2$.\n- `detrend`: Setting this to `'constant'` is equivalent to subtracting the mean from the signal, thus operating on $p^\\prime(t)$.\n- `scaling`: Setting this to `'density'` ensures the output PSD $\\hat{S}_{pp}(f)$ has units of (signal units)$^2/\\mathrm{Hz}$, which is $\\mathrm{Pa}^2/\\mathrm{Hz}$ in this case.\n- `return_onesided`: Defaults to `True`, providing the one-sided spectrum for a real-valued signal.\n\nThis procedure yields two arrays: an array of frequencies $f_k$ and the corresponding estimated PSD values $\\hat{S}_{pp}(f_k)$.\n\n**3. Low-Frequency Peak Identification**\n\nThe algorithm aims to automatically identify peaks corresponding to SBLI, which are typically found in a low-frequency range. The search is therefore restricted to the band $f_k \\in (0, f_{\\mathrm{LF,max}}]$. The $f_k=0$ (DC) component is excluded.\n\nTo distinguish genuine peaks from the broadband noise floor, a robust thresholding strategy is employed.\n- First, a baseline noise level $B$ is established within the band of interest. The median is a robust statistic for this purpose, as it is insensitive to the high-energy outliers that constitute the peaks themselves. The baseline is calculated as:\n$$\nB = \\operatorname{median}\\left\\{ \\hat{S}_{pp}(f_k) \\,\\big|\\, f_k \\in (0, f_{\\mathrm{LF,max}}] \\right\\}\n$$\n- Second, peaks are identified as local maxima in the PSD. The significance of each peak is quantified by its *prominence*—the vertical distance from the peak's apex to the higher of its two neighboring local minima.\n- A peak is deemed significant and accepted if its prominence exceeds a threshold proportional to the baseline $B$. The acceptance criterion is:\n$$\n\\text{Prominence}(f^\\star) \\geq \\theta \\cdot B\n$$\nwhere $f^\\star$ is the peak frequency and $\\theta$ is a specified dimensionless factor.\n\nThis task is accomplished using the `scipy.signal.find_peaks` function. We apply it to the portion of the PSD array $\\hat{S}_{pp}$ that falls within the low-frequency band. The `prominence` argument is set to the calculated threshold $\\theta \\cdot B$.\n\n**4. Final Processing and Output**\n\nThe `find_peaks` function returns the indices of the identified peaks within the low-frequency portion of the PSD arrays. These indices are mapped back to their corresponding frequency values from the frequency array. As required, these frequencies are rounded to the nearest integer and sorted in ascending order. This process is repeated for each test case, and the resulting lists of frequencies are collected into a final list. The program's output is this final list of lists, formatted as a single-line string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef analyze_pressure_signal(params):\n    \"\"\"\n    Analyzes a synthetic pressure signal to find low-frequency peaks.\n\n    This function performs the following steps:\n    1. Generates a time-series signal based on specified components.\n    2. Computes the one-sided Power Spectral Density (PSD) using Welch's method.\n    3. Identifies significant peaks in a specified low-frequency band based on\n       prominence relative to the band's median PSD value.\n    \"\"\"\n    # Unpack parameters for the current test case\n    fs, T, n_seg, f_lf_max, theta, p0, lf_comps, hf_comp, sigma, seed = params\n\n    # Set the random seed for this specific signal generation to ensure reproducibility.\n    # Note: Using the same seed for every case ensures each signal is generated\n    # identically on every run.\n    np.random.seed(seed)\n\n    # 1. Generate the synthetic wall-pressure signal\n    N = int(fs * T)  # Total number of samples\n    t = np.arange(N) / fs  # Time vector\n\n    # Start with the steady mean pressure\n    p_t = np.full(N, p0, dtype=np.float64)\n\n    # Add low-frequency sinusoidal components (SBLI)\n    if lf_comps:\n        for f_i, A_i in lf_comps:\n            p_t += A_i * np.sin(2 * np.pi * f_i * t)\n\n    # Add optional high-frequency tonal component\n    if hf_comp:\n        f_hf, A_hf = hf_comp\n        p_t += A_hf * np.sin(2 * np.pi * f_hf * t)\n\n    # Add Gaussian broadband noise\n    eta_t = np.random.normal(loc=0, scale=sigma, size=N)\n    p_t += eta_t\n\n    # 2. Estimate the one-sided PSD using Welch's method\n    # - detrend='constant' removes the mean from the signal (p' = p - p_bar).\n    # - scaling='density' provides the PSD in units of Pa^2/Hz.\n    # - return_onesided=True is the default for real signals.\n    # - overlap is set to 50% of the segment length.\n    freqs, S_pp = signal.welch(\n        p_t,\n        fs=fs,\n        window='hann',\n        nperseg=n_seg,\n        noverlap=n_seg // 2,\n        detrend='constant',\n        scaling='density'\n    )\n\n    # 3. Identify low-frequency peaks\n    # Isolate the frequency band of interest: (0, f_lf_max]\n    lf_mask = (freqs > 0)  (freqs = f_lf_max)\n    lf_freqs = freqs[lf_mask]\n    lf_S_pp = S_pp[lf_mask]\n    \n    # If the band is empty, there are no peaks to find.\n    if len(lf_S_pp) == 0:\n        return []\n\n    # Calculate the baseline B as the median of the PSD in the low-freq band\n    B = np.median(lf_S_pp)\n\n    # Calculate the prominence threshold\n    prominence_threshold = theta * B\n\n    # Find peaks in the low-frequency PSD using the prominence criterion\n    peak_indices, _ = signal.find_peaks(\n        lf_S_pp,\n        prominence=prominence_threshold\n    )\n\n    # Extract the frequencies corresponding to the detected peak indices\n    detected_freqs = lf_freqs[peak_indices]\n\n    # 4. Format the output for this case\n    # Round to the nearest integer, convert to int, and sort in ascending order.\n    return sorted([int(round(f)) for f in detected_freqs])\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # A single fixed random seed is used for all cases for reproducibility.\n    # This ensures that the noise component of each signal is identical on every run.\n    fixed_seed = 42\n\n    # Define the test suite as per the problem statement\n    test_cases = [\n        # Case 1: Happy path with two clear low-frequency peaks\n        (5000, 4, 4096, 400, 4.0, 101325, [(80, 40), (250, 25)], (1500, 15), 8, fixed_seed),\n        \n        # Case 2: Boundary case with no low-frequency content\n        (5000, 4, 4096, 400, 4.0, 101325, [], (1200, 25), 10, fixed_seed),\n        \n        # Case 3: Case with two closely spaced low-frequency peaks\n        (8000, 3, 2048, 200, 4.0, 101325, [(95, 25), (105, 22)], (2500, 10), 9, fixed_seed),\n        \n        # Case 4: Edge case with one peak just inside the band limit\n        (10000, 2.5, 2048, 400, 4.0, 101325, [(395, 20), (405, 20)], (3000, 12), 7, fixed_seed)\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = analyze_pressure_signal(params)\n        all_results.append(result)\n\n    # Print the final results in the exact specified format: [[80,250],[],[100],[395]]\n    # Using str() and replace() is a direct way to achieve the required compact format.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}