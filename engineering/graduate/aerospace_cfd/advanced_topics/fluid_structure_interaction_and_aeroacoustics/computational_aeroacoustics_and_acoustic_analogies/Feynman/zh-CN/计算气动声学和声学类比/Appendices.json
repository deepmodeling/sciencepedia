{
    "hands_on_practices": [
        {
            "introduction": "深入理解计算航空声学，核心在于掌握延迟时间的概念。本练习将引导你从 Ffowcs Williams-Hawkings (FW-H) 方程的基本关系出发，通过第一性原理推导运动单极子声源的多普勒效应。这个过程不仅能加深你对延迟时间物理意义的理解，还能揭示声学类比理论如何与经典的声学现象建立联系 。",
            "id": "3940973",
            "problem": "考虑一个紧凑的平移单极子声源，该声源嵌入在环境密度为 $\\rho_{0}$、声速为 $c$ 的静止无粘性流体中。声源被建模为一个附着在刚性、不可穿透控制面上的点，该控制面的运动定义了声源轨迹 $\\boldsymbol{x}_{s}(t)$，其速度为恒定的 $\\boldsymbol{U}$ 且无加速度。单极子体积通量由 $q(t)=q_{0}\\cos(\\omega_{0}t)$ 给出，其中 $\\omega_{0}$ 是声源角频率， $q_{0}$ 是一个恒定振幅。一个观测者位于远场中的固定位置 $\\boldsymbol{x}$。设 $\\boldsymbol{R}(t_{r})=\\boldsymbol{x}-\\boldsymbol{x}_{s}(t_{r})$，$R(t_{r})=|\\boldsymbol{R}(t_{r})|$，以及 $\\boldsymbol{n}(t_{r})=\\boldsymbol{R}(t_{r})/R(t_{r})$，其中 $t_{r}$ 是在观测者时间 $t$ 探测到的信号所产生的发射时间。\n\n从 Ffowcs Williams–Hawkings (FW-H) 声学比拟出发，针对运动表面，利用辐射场中的声源量在由 $t=t_{r}+R(t_{r})/c$ 隐式定义的推迟时间进行计算这一事实。通过直接从该推迟时间关系和平移声源的运动学出发，推导在观测者处测量的由 $q(t)$ 产生的信号的瞬时观测频率。将最终结果表示为声源频率 $f_{0}=\\omega_{0}/(2\\pi)$、声速 $c$、声源速率 $U=|\\boldsymbol{U}|$ 以及 $\\boldsymbol{U}$ 和 $\\boldsymbol{n}(t_{r})$ 之间的夹角 $\\theta$ 的函数。观测者是静止的，流体在其他方面也处于静止状态。忽略四极子贡献，并假设线性声学和远场条件，使得几何扩散不影响频率。请以观测频率 $f_{\\mathrm{obs}}$ 关于 $f_{0}$、$U$、$c$ 和 $\\theta$ 的单一闭式解析表达式的形式给出最终答案。不需要进行数值计算。",
            "solution": "问题陈述经分析和验证，具有科学依据、适定且客观。它代表了在静止介质中运动单极子声源的多普勒效应的标准推导。解答过程通过分析声源时间与观测者时间之间的关系展开。\n\n问题的核心在于观测到信号的时间 $t$ 与其发射时间 $t_r$ 之间的关系。这就是推迟时间方程，表示为：\n$$ t = t_r + \\frac{R(t_r)}{c} $$\n这里，$t$ 是观测者时间，$t_r$ 是发射时间（或推迟时间），$c$ 是声速，$R(t_r)$ 是发射时刻声源与观测者之间的距离。$R(t_r) = |\\boldsymbol{x} - \\boldsymbol{x}_s(t_r)|$，其中 $\\boldsymbol{x}$ 是观测者的固定位置，$\\boldsymbol{x}_s(t_r)$ 是声源在时间 $t_r$ 的位置。\n\n声源由体积通量 $q(t) = q_0\\cos(\\omega_0 t)$ 描述，这是一个时间的谐波函数。在给定的发射时间 $t_r$，声源信号的相位可以写为 $\\phi_s(t_r) = \\omega_0 t_r$。位于位置 $\\boldsymbol{x}$ 的观测者测量在时间 $t_r$ 发射的信号。因此，观测者在时间 $t$ 测量的信号相位是声源在相应推迟时间 $t_r(t)$ 的相位。我们将观测到的相位表示为 $\\phi_{\\mathrm{obs}}(t)$：\n$$ \\phi_{\\mathrm{obs}}(t) = \\phi_s(t_r(t)) = \\omega_0 t_r(t) $$\n在时间 $t$ 观测到的瞬时角频率，记为 $\\omega_{\\mathrm{obs}}$，是观测相位对观测者时间 $t$ 的时间导数：\n$$ \\omega_{\\mathrm{obs}}(t) = \\frac{d\\phi_{\\mathrm{obs}}}{dt} = \\frac{d}{dt} \\left( \\omega_0 t_r(t) \\right) = \\omega_0 \\frac{dt_r}{dt} $$\n为了求得观测频率，我们必须确定推迟时间对观测者时间的导数 $\\frac{dt_r}{dt}$。我们可以通过对推迟时间方程关于 $t$ 求导来得到这个值：\n$$ \\frac{d}{dt}(t) = \\frac{d}{dt}\\left( t_r + \\frac{R(t_r)}{c} \\right) $$\n$$ 1 = \\frac{dt_r}{dt} + \\frac{1}{c} \\frac{d R(t_r)}{dt} $$\n使用链式法则，我们可以写出 $\\frac{dR}{dt} = \\frac{dR}{dt_r} \\frac{dt_r}{dt}$。将此代入方程中得到：\n$$ 1 = \\frac{dt_r}{dt} + \\frac{1}{c} \\frac{dR}{dt_r} \\frac{dt_r}{dt} = \\frac{dt_r}{dt} \\left( 1 + \\frac{1}{c} \\frac{dR}{dt_r} \\right) $$\n解出所需的导数 $\\frac{dt_r}{dt}$：\n$$ \\frac{dt_r}{dt} = \\frac{1}{1 + \\frac{1}{c} \\frac{dR}{dt_r}} $$\n下一步是计算距离 $R$ 对推迟时间 $t_r$ 的导数。距离 $R$ 是矢量 $\\boldsymbol{R}(t_r) = \\boldsymbol{x} - \\boldsymbol{x}_s(t_r)$ 的模。我们可以写成 $R^2 = \\boldsymbol{R} \\cdot \\boldsymbol{R}$。现在，我们对这个表达式关于 $t_r$ 求导：\n$$ \\frac{d}{dt_r}(R^2) = 2R \\frac{dR}{dt_r} = \\frac{d}{dt_r}(\\boldsymbol{R} \\cdot \\boldsymbol{R}) = 2\\boldsymbol{R} \\cdot \\frac{d\\boldsymbol{R}}{dt_r} $$\n$$ \\frac{dR}{dt_r} = \\frac{\\boldsymbol{R}}{R} \\cdot \\frac{d\\boldsymbol{R}}{dt_r} $$\n根据定义，$\\boldsymbol{n}(t_r) = \\boldsymbol{R}(t_r)/R(t_r)$ 是从发射时间的声源指向观测者的单位矢量。所以，\n$$ \\frac{dR}{dt_r} = \\boldsymbol{n} \\cdot \\frac{d\\boldsymbol{R}}{dt_r} $$\n现在我们求矢量 $\\boldsymbol{R}(t_r)$ 的导数：\n$$ \\frac{d\\boldsymbol{R}}{dt_r} = \\frac{d}{dt_r}(\\boldsymbol{x} - \\boldsymbol{x}_s(t_r)) = \\frac{d\\boldsymbol{x}}{dt_r} - \\frac{d\\boldsymbol{x}_s}{dt_r} $$\n由于观测者位置 $\\boldsymbol{x}$ 是固定的，其对时间的导数为零。导数 $\\frac{d\\boldsymbol{x}_s}{dt_r}$ 是声源在时间 $t_r$ 的速度，即给定的恒定矢量 $\\boldsymbol{U}$。因此：\n$$ \\frac{d\\boldsymbol{R}}{dt_r} = -\\boldsymbol{U} $$\n将此代回 $\\frac{dR}{dt_r}$ 的表达式中：\n$$ \\frac{dR}{dt_r} = \\boldsymbol{n} \\cdot (-\\boldsymbol{U}) = -(\\boldsymbol{n} \\cdot \\boldsymbol{U}) $$\n问题将 $\\theta$ 定义为声源速度矢量 $\\boldsymbol{U}$ 与辐射方向矢量 $\\boldsymbol{n}(t_r)$ 之间的夹角。因此，标量积为 $\\boldsymbol{n} \\cdot \\boldsymbol{U} = |\\boldsymbol{n}||\\boldsymbol{U}|\\cos(\\theta) = U\\cos(\\theta)$，因为 $|\\boldsymbol{n}|=1$。这得到：\n$$ \\frac{dR}{dt_r} = -U\\cos(\\theta) $$\n我们现在可以将这个结果代入我们关于 $\\frac{dt_r}{dt}$ 的表达式中：\n$$ \\frac{dt_r}{dt} = \\frac{1}{1 + \\frac{1}{c}(-U\\cos(\\theta))} = \\frac{1}{1 - \\frac{U}{c}\\cos(\\theta)} $$\n这是关联声源处时间流逝与观测者处时间流逝的因子。最后，我们求得观测角频率 $\\omega_{\\mathrm{obs}}$：\n$$ \\omega_{\\mathrm{obs}} = \\omega_0 \\frac{dt_r}{dt} = \\frac{\\omega_0}{1 - \\frac{U}{c}\\cos(\\theta)} $$\n问题要求用声源频率 $f_0$ 表示观测频率 $f_{\\mathrm{obs}}$。利用关系式 $\\omega_{\\mathrm{obs}} = 2\\pi f_{\\mathrm{obs}}$ 和 $\\omega_0 = 2\\pi f_0$，我们可以写出：\n$$ 2\\pi f_{\\mathrm{obs}} = \\frac{2\\pi f_0}{1 - \\frac{U}{c}\\cos(\\theta)} $$\n两边除以 $2\\pi$ 得到观测频率的最终表达式：\n$$ f_{\\mathrm{obs}} = \\frac{f_0}{1 - \\frac{U}{c}\\cos(\\theta)} $$\n这是运动声源和静止观测者的经典多普勒频移公式。角度 $\\theta$ 是在推迟时间 $t_r$ 计算的。",
            "answer": "$$\\boxed{\\frac{f_{0}}{1 - \\frac{U}{c}\\cos(\\theta)}}$$"
        },
        {
            "introduction": "声学类比理论的巨大威力在于其预测能力，能够将复杂的流场与远场声辐射联系起来。本练习将带你应用 Lighthill 声学类比理论，通过对核心的四极子源项进行量纲分析，推导出著名的 Lighthill “八次方律” 。完成此练习有助于你掌握如何从理论模型中提炼出关键的工程预测，并理解湍流射流噪声的主要物理机制。",
            "id": "3940990",
            "problem": "考虑一个高雷诺数、亚声速的湍射流，它处于一个静止介质中，该介质的环境密度为 $\\rho_{0}$，声速为 $c_{0}$。该射流具有特征平均流速 $U$ 和一个含能尺度 $L$。假设含能湍流满足紧致声源极限，即与主导声源频率相关的声波长远大于 $L$，且斯特劳哈尔数 $\\mathrm{St} \\equiv \\omega L/U$ 的量级为1。使用Lighthill声学比拟（LAA），将主导声源建模为由雷诺应力散度产生的四极子，在非齐次声波方程中由源项 $\\partial_{ij}(\\rho u_{i} u_{j})$ 表示。在此框架下，通过量纲分析推导总辐射声功率 $W$ 在远场的标度律，用 $\\rho_{0}$、$c_{0}$、$U$ 和 $L$ 表示，然后用马赫数 $M \\equiv U/c_{0}$ 明确表达您的最终结果。您可以忽略量级为1的无量纲常数，并假设湍流具有统计各向同性。以瓦特（国际单位制）为单位报告功率标度。最终答案必须是关于 $\\rho_{0}$、$c_{0}$、$L$ 和 $M$ 的单个闭式解析表达式；不要将中间方程作为最终答案。",
            "solution": "该问题要求推导来自高雷诺数、亚声速湍射流的总辐射声功率 $W$ 的标度律。推导将基于对Lighthill声学比拟（LAA）的量纲分析。\n\nLighthill声学比拟将精确的Navier-Stokes方程重构为一个关于声压脉动 $p' = p - p_0$ 的非齐次波动方程。在一个无界静止介质中，该方程为：\n$$\n\\frac{1}{c_0^2}\\frac{\\partial^2 p'}{\\partial t^2} - \\nabla^2 p' = \\frac{\\partial^2 T_{ij}}{\\partial x_i \\partial x_j}\n$$\n其中 $c_0$ 是环境声速，$T_{ij}$ 是Lighthill应力张量。对于没有外部体积力或热源的高雷诺数流动，该张量可以很好地用雷诺应力项 $T_{ij} \\approx \\rho u_i u_j$ 来近似。问题陈述指导我们使用此项来建模主导声源，具体为 $\\partial_{ij}(\\rho u_i u_j)$。对于亚声速射流，湍流内部的密度脉动与环境密度 $\\rho_0$ 相比很小，因此我们可以进一步近似为 $T_{ij} \\approx \\rho_0 u_i u_j$。因此，右侧的源项是一个四极子声源。\n\n非齐次波动方程在远场（观测点距离 $r = |\\mathbf{x}|$ 远大于声源尺寸 $L$）的解可以使用格林函数方法找到。对于问题陈述中假设的紧致声源（声波长 $\\lambda \\gg L$），远场声压脉动由下式给出：\n$$\np'(\\mathbf{x}, t) \\approx \\frac{1}{4\\pi c_0^2 r} \\frac{x_i x_j}{r^2} \\frac{\\partial^2}{\\partial t^2} \\int_V T_{ij}(\\mathbf{y}, t - r/c_0) dV(\\mathbf{y})\n$$\n其中积分是在声源体积 $V$ 上进行的。\n\n我们现在进行量纲分析以确定 $p'$ 的标度。\n湍射流中的特征速度脉动与平均流速 $U$ 成比例。因此，Lighthill应力张量的标度为：\n$$\nT_{ij} \\sim \\rho_0 U^2\n$$\n由含能尺度 $L$ 表征的声源体积，其标度为 $V \\sim L^3$。因此，应力张量在该体积上的积分标度为：\n$$\n\\int_V T_{ij} dV \\sim (\\rho_0 U^2) L^3\n$$\n含能湍涡的特征频率 $\\omega$ 与速度 $U$ 和长度尺度 $L$ 相关。问题陈述指出斯特劳哈尔数 $\\mathrm{St} \\equiv \\omega L/U$ 的量级为1。这意味着特征频率的标度为 $\\omega \\sim U/L$。因此，压力表达式中的二阶时间导数的标度为：\n$$\n\\frac{\\partial^2}{\\partial t^2} \\sim \\omega^2 \\sim \\left(\\frac{U}{L}\\right)^2\n$$\n将这些标度关系代入远场声压脉动 $p'$ 的表达式中（并忽略像 $4\\pi$ 这样的无量纲常数和像 $x_i x_j/r^2$ 这样在所有方向上平均后量级为1的几何因子），我们得到：\n$$\np' \\sim \\frac{1}{c_0^2 r} \\left(\\frac{U}{L}\\right)^2 (\\rho_0 U^2 L^3) = \\frac{\\rho_0 U^4 L}{c_0^2 r}\n$$\n声强 $I$ 是单位面积上时间平均的声能通量。它由 $I = \\frac{\\overline{p'^2}}{\\rho_0 c_0}$ 给出。压力脉动平方的时间平均值 $\\overline{p'^2}$，其标度与特征压力脉动幅值的平方 $(p')^2$ 相同：\n$$\nI \\sim \\frac{(p')^2}{\\rho_0 c_0} \\sim \\frac{1}{\\rho_0 c_0} \\left( \\frac{\\rho_0 U^4 L}{c_0^2 r} \\right)^2 = \\frac{\\rho_0^2 U^8 L^2}{\\rho_0 c_0 c_0^4 r^2} = \\frac{\\rho_0 U^8 L^2}{c_0^5 r^2}\n$$\n总辐射声功率 $W$ 是通过将声强 $I$ 在半径为 $r$ 的大球面上积分得到的。该球体的表面积为 $4\\pi r^2$。积分考虑了辐射的方向性，但为了标度分析，我们可以简单地将特征声强乘以表面积，其标度为 $r^2$。\n$$\nW = \\int_{S} I dS \\sim I \\times r^2 \\sim \\left(\\frac{\\rho_0 U^8 L^2}{c_0^5 r^2}\\right) r^2 = \\frac{\\rho_0 U^8 L^2}{c_0^5}\n$$\n这就是著名的Lighthill八次方律，它指出湍射流辐射的声功率与射流速度的八次方成正比。\n\n最后一步是用射流马赫数 $M \\equiv U/c_0$ 来表示此标度关系。我们将 $U = M c_0$ 代入 $W$ 的表达式中：\n$$\nW \\sim \\frac{\\rho_0 (M c_0)^8 L^2}{c_0^5} = \\frac{\\rho_0 M^8 c_0^8 L^2}{c_0^5} = \\rho_0 c_0^3 L^2 M^8\n$$\n由于问题要求我们忽略量级为1的无量纲常数，该标度关系即为总辐射声功率的最终表达式。单位与功率（国际单位制中的瓦特）一致，这可以通过量纲分析来验证：$[\\rho_0 c_0^3 L^2] = (\\frac{M_{mass}}{L_{len}^3}) (\\frac{L_{len}}{T_{time}})^3 (L_{len}^2) = \\frac{M_{mass} L_{len}^2}{T_{time}^3}$，这是功率（能量/时间）的量纲。",
            "answer": "$$\\boxed{\\rho_{0} c_{0}^{3} L^{2} M^{8}}$$"
        },
        {
            "introduction": "从理论到实践，本练习将指导你构建一个完整的计算流程，用以处理计算流体动力学（CFD）数据并预测远场噪声。你将设计一个 Ffowcs Williams–Hawkings (FW-H) 后处理流程，包括从原始数据中滤除伪声（流体动力学脉动），并实现关键的延迟时间插值 。这个综合性练习模拟了航空声学工程师在实际工作中面临的核心挑战，是将在理论知识应用于复杂数值模拟的关键一步。",
            "id": "3940991",
            "problem": "需要设计一个 Ffowcs Williams–Hawkings (FW-H) 声学比拟后处理流程，用于从包含声学和流体动力学贡献的合成大涡模拟 (LES) 表面数据中计算远场单边功率谱密度。该流程必须包括使用对流对齐的流体动力学压力显式滤波，并与 FW-H 曲面积分固有的延迟时间计算进行同步。计算任务是为每个指定的测试案例，以纯数学术语的形式，实现以下物理上一致的步骤：\n\n1. 定义一个半径为 $a$ 的圆形可渗透 FW-H 控制面，该控制面位于 $x$-$y$ 平面内，并以原点为中心。将该表面离散为 $N_s$ 个按角度均匀分布的点，点的位置为 $\\mathbf{y}_i = \\left(a \\cos \\theta_i, a \\sin \\theta_i, 0\\right)$，向外的法线向量为 $\\mathbf{n}_i = \\left(\\cos \\theta_i, a \\sin \\theta_i, 0\\right)$，其中 $\\theta_i = 2\\pi i/N_s$，对于 $i = 0,1,\\ldots,N_s-1$。\n\n2. 为每个表面点生成合成的 LES 表面压力信号 $p_s(\\mathbf{y}_i,t)$。令声学平面波部分以声速 $c_0$ 沿 $+x$ 方向传播，流体动力学对流部分以对流速度 $U$ 沿 $+x$ 方向传播（通常 $U  c_0$）。定义投影坐标 $s(\\mathbf{y}_i) = \\hat{\\mathbf{e}}_x \\cdot \\mathbf{y}_i = a \\cos \\theta_i$。每个点的信号为\n$$\np_s(\\mathbf{y}_i,t) = A_a \\cos\\left(2\\pi f_a \\left(t - \\frac{s(\\mathbf{y}_i)}{c_0}\\right)\\right) + A_h \\cos\\left(2\\pi f_h \\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\\right) + \\eta_i(t),\n$$\n其中 $A_a$ 是声学振幅（帕斯卡），$f_a$ 是声学频率（赫兹），$A_h$ 是流体动力学振幅（帕斯卡），$f_h$ 是流体动力学频率（赫兹），$\\eta_i(t)$ 是零均值加性随机噪声，其振幅以帕斯卡为单位指定。采样率为 $f_s$（赫兹），持续时间为 $T$（秒）。声速为 $c_0$（米/秒）。\n\n3. 通过在整个表面上进行对流对齐来构建流体动力学压力估计，并将其减去以滤除流体动力学内容。定义对流对齐信号\n$$\nq_i(t) = p_s(\\mathbf{y}_i,\\, t + s(\\mathbf{y}_i)/U),\n$$\n和表面平均对齐信号\n$$\n\\overline{q}(t) = \\frac{1}{N_s} \\sum_{i=0}^{N_s-1} q_i(t).\n$$\n然后通过取消对齐来定义每个点的流体动力学估计\n$$\n\\widehat{p}_h(\\mathbf{y}_i,t) = \\overline{q}\\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right),\n$$\n并构建滤波后的压力\n$$\np_f(\\mathbf{y}_i,t) = p_s(\\mathbf{y}_i,t) - \\widehat{p}_h(\\mathbf{y}_i,t).\n$$\n所有时间平移都通过时间上的线性插值来计算。此过程旨在移除以接近速度 $U$ 对流的组分，同时保留以接近 $c_0$ 速度传播的组分。\n\n4. 通过延迟时间同步计算固定观察者位置 $\\mathbf{x}_o$ 处的 FW-H 远场代理压力。对于每个表面点 $\\mathbf{y}_i$，计算声学延迟时间\n$$\nt_r^{(i)}(t) = t - \\frac{R_i}{c_0}, \\quad R_i = \\|\\mathbf{x}_o - \\mathbf{y}_i\\|.\n$$\n通过使用保持压力单位的离散化、无量纲加权和来近似仅含载荷的多孔 FW-H 贡献，使用\n$$\np'(\\mathbf{x}_o,t) \\approx \\sum_{i=0}^{N_s-1} w_i \\, p_f\\left(\\mathbf{y}_i,\\, t_r^{(i)}(t)\\right),\n$$\n其中\n$$\nw_i = \\frac{R_{\\mathrm{ref}}}{4\\pi R_i N_s},\n$$\n$R_{\\mathrm{ref}}$ 是一个固定参考长度，设置为 $1\\,\\mathrm{m}$ 以保持求和为无量纲。延迟时间同步是通过在 $t_r^{(i)}(t)$ 处对 $p_f(\\mathbf{y}_i,t)$ 进行线性插值来实现的。\n\n5. 使用汉宁窗 $w(t)$ 和快速傅里叶变换 (FFT) 计算 $p'(\\mathbf{x}_o,t)$ 的单边功率谱密度 (PSD) $S_{p'p'}(f)$。如果 $x[n]$ 是采样信号，$w[n]$ 是窗函数，$X[k]$ 是 $w[n] x[n]$ 的离散傅里叶变换，$f_s$ 是采样频率，$N$ 是样本数，以及 $U_w = \\frac{1}{N}\\sum_{n=0}^{N-1} w[n]^2$ 是窗功率，则单边 PSD 对频率 $f_k = k f_s/N$ 定义为\n$$\nS_{p'p'}(f_k) = \\begin{cases}\n\\frac{1}{f_s N U_w} |X[0]|^2,  k = 0, \\\\[6pt]\n\\frac{2}{f_s N U_w} |X[k]|^2,  1 \\le k \\le \\frac{N}{2}-1, \\\\[6pt]\n\\frac{1}{f_s N U_w} |X[N/2]|^2,  k = \\frac{N}{2} \\text{ 当 $N$ 为偶数时。}\n\\end{cases}\n$$\n通过取最接近每个目标的 FFT 频点，报告在声学频率 $f_a$ 和流体动力学频率 $f_h$ 处的 $S_{p'p'}(f)$。\n\n所有物理答案必须以帕斯卡平方每赫兹 ($\\mathrm{Pa}^2/\\mathrm{Hz}$) 表示。角度单位为弧度。报告数值时，将每个值四舍五入到六位小数。\n\n测试套件：\n- 案例 1（一般情况）：\n  - $N_s = 64$，$a = 0.5\\,\\mathrm{m}$，$\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$，\n  - $f_a = 800\\,\\mathrm{Hz}$，$A_a = 1.0\\,\\mathrm{Pa}$，\n  - $f_h = 200\\,\\mathrm{Hz}$，$A_h = 2.0\\,\\mathrm{Pa}$，\n  - $U = 100.0\\,\\mathrm{m/s}$，$c_0 = 340.0\\,\\mathrm{m/s}$，\n  - 噪声振幅 $A_n = 0.05\\,\\mathrm{Pa}$，\n  - $f_s = 20000\\,\\mathrm{Hz}$，$T = 0.5\\,\\mathrm{s}$。\n\n- 案例 2（无流体动力学内容）：\n  - $N_s = 64$，$a = 0.5\\,\\mathrm{m}$，$\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$，\n  - $f_a = 800\\,\\mathrm{Hz}$，$A_a = 1.0\\,\\mathrm{Pa}$，\n  - $f_h = 200\\,\\mathrm{Hz}$，$A_h = 0.0\\,\\mathrm{Pa}$，\n  - $U = 100.0\\,\\mathrm{m/s}$，$c_0 = 340.0\\,\\mathrm{m/s}$，\n  - 噪声振幅 $A_n = 0.05\\,\\mathrm{Pa}$，\n  - $f_s = 20000\\,\\mathrm{Hz}$，$T = 0.5\\,\\mathrm{s}$。\n\n- 案例 3（近声速对流）：\n  - $N_s = 64$，$a = 0.5\\,\\mathrm{m}$，$\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$，\n  - $f_a = 800\\,\\mathrm{Hz}$，$A_a = 1.0\\,\\mathrm{Pa}$，\n  - $f_h = 200\\,\\mathrm{Hz}$，$A_h = 2.0\\,\\mathrm{Pa}$，\n  - $U = 320.0\\,\\mathrm{m/s}$，$c_0 = 340.0\\,\\mathrm{m/s}$，\n  - 噪声振幅 $A_n = 0.05\\,\\mathrm{Pa}$，\n  - $f_s = 20000\\,\\mathrm{Hz}$，$T = 0.5\\,\\mathrm{s}$。\n\n- 案例 4（稀疏表面采样和较小孔径）：\n  - $N_s = 8$，$a = 0.1\\,\\mathrm{m}$，$\\mathbf{x}_o = (5.0,0.0,0.0)\\,\\mathrm{m}$，\n  - $f_a = 1200\\,\\mathrm{Hz}$，$A_a = 1.0\\,\\mathrm{Pa}$，\n  - $f_h = 300\\,\\mathrm{Hz}$，$A_h = 2.0\\,\\mathrm{Pa}$，\n  - $U = 150.0\\,\\mathrm{m/s}$，$c_0 = 340.0\\,\\mathrm{m/s}$，\n  - 噪声振幅 $A_n = 0.05\\,\\mathrm{Pa}$，\n  - $f_s = 20000\\,\\mathrm{Hz}$，$T = 0.5\\,\\mathrm{s}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试案例，报告两个以 $\\mathrm{Pa}^2/\\mathrm{Hz}$ 为单位、四舍五入到六位小数的值：首先是 $S_{p'p'}(f_a)$，然后是 $S_{p'p'}(f_h)$。因此，总输出应按案例 1 到 4 的顺序包含八个数字，总格式为\n$$\n[\\;S_{p'p'}(f_a)_{\\text{案例 1}},\\,S_{p'p'}(f_h)_{\\text{案例 1}},\\,S_{p'p'}(f_a)_{\\text{案例 2}},\\,S_{p'p'}(f_h)_{\\text{案例 2}},\\,S_{p'p'}(f_a)_{\\text{案例 3}},\\,S_{p'p'}(f_h)_{\\text{案例 3}},\\,S_{p'p'}(f_a)_{\\text{案例 4}},\\,S_{p'p'}(f_h)_{\\text{案例 4}}\\;].\n$$",
            "solution": "该问题要求实现一个用于后处理合成航空声学数据的计算流程。该流程模拟 Ffowcs Williams–Hawkings (FW-H) 方法，包括一个关键的预处理步骤，用于从源数据中滤除非传播的流体动力学压力脉动。解决方案的构建严格遵循了规定的数学和算法步骤。\n\n首先，我们建立计算域并生成源信号。在 $x$-$y$ 平面内定义一个以原点为中心、半径为 $a$ 的圆形可渗透控制面。该表面被离散为 $N_s$ 个点，其位置由 $\\mathbf{y}_i = (a \\cos\\theta_i, a \\sin\\theta_i, 0)$ 给出，其中 $i = 0, 1, \\ldots, N_s-1$，$\\theta_i = 2\\pi i/N_s$。每个点的向外法线向量为 $\\mathbf{n}_i = (\\cos\\theta_i, \\sin\\theta_i, 0)$。\n\n对于每个点 $\\mathbf{y}_i$，在持续时间 $T$ 内以采样率 $f_s$ 生成一个合成压力信号 $p_s(\\mathbf{y}_i,t)$。时间样本数为 $N = \\lfloor T f_s \\rfloor$。该信号由一个声学平面波、一个流体动力学对流扰动和一个加性随机噪声组成。声学波以声速 $c_0$ 传播，而流体动力学分量以不同的速度 $U$ 对流。两者都被定义为在 $+x$ 方向上传播。每个表面点 $\\mathbf{y}_i$ 的信号由下式给出：\n$$\np_s(\\mathbf{y}_i,t) = A_a \\cos\\left(2\\pi f_a \\left(t - \\frac{s(\\mathbf{y}_i)}{c_0}\\right)\\right) + A_h \\cos\\left(2\\pi f_h \\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\\right) + \\eta_i(t)\n$$\n这里，$s(\\mathbf{y}_i) = \\hat{\\mathbf{e}}_x \\cdot \\mathbf{y}_i = a \\cos\\theta_i$ 是点的位置在传播方向上的投影。$A_a$ 和 $f_a$ 分别是声学振幅和频率，$A_h$ 和 $f_h$ 分别是流体动力学振幅和频率，$\\eta_i(t)$ 是具有指定振幅 $A_n$ 的零均值随机噪声。为了计算的可复现性，噪声是使用固定的随机种子从 $[-A_n, A_n]$ 上的均匀分布中生成的。\n\n第二个主要步骤是滤除流体动力学压力分量。这是通过对流对齐和相减技术实现的。对于每个表面点 $\\mathbf{y}_i$，对信号 $p_s$ 进行时间平移，以对齐以速度 $U$ 对流的事件：\n$$\nq_i(t) = p_s\\left(\\mathbf{y}_i, t + \\frac{s(\\mathbf{y}_i)}{U}\\right)\n$$\n代入 $p_s$ 的表达式，$q_i(t)$ 的流体动力学部分变为 $A_h \\cos(2\\pi f_h t)$，现在在所有表面点上都是同步的，与其位置 $s(\\mathbf{y}_i)$ 无关。然而，声学部分的相位与 $c_0$ 相关，因此仍然依赖于 $s(\\mathbf{y}_i)$。通过对整个表面上的这些对齐信号进行平均，空间上非相干的声学和噪声分量被衰减，而相干的流体动力学分量被保留下来：\n$$\n\\overline{q}(t) = \\frac{1}{N_s} \\sum_{i=0}^{N_s-1} q_i(t) \\approx A_h \\cos(2\\pi f_h t)\n$$\n这个表面平均信号 $\\overline{q}(t)$ 作为参考位置（$s=0$）处孤立的流体动力学脉动的估计。然后将此估计时间平移回每个点的原始坐标系，以构建流体动力学压力场估计：\n$$\n\\widehat{p}_h(\\mathbf{y}_i,t) = \\overline{q}\\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\n$$\n最后，将此估计从原始信号中减去，得到滤波后的压力，理想情况下它只包含声学信号和残余噪声：\n$$\np_f(\\mathbf{y}_i,t) = p_s(\\mathbf{y}_i,t) - \\widehat{p}_h(\\mathbf{y}_i,t)\n$$\n所有所需的时间平移都通过对离散时间序列数据进行线性插值来数值执行。\n\n第三步是使用简化的多孔 FW-H 积分公式计算远场观察者压力 $p'(\\mathbf{x}_o,t)$。这涉及到对所有表面点的贡献求和，每个贡献都在其特定的延迟时间进行计算。对于从点 $\\mathbf{y}_i$ 发出并在时间 $t$ 到达观察者位置 $\\mathbf{x}_o$ 的信号，其延迟时间 $t_r^{(i)}$ 为：\n$$\nt_r^{(i)}(t) = t - \\frac{R_i}{c_0}, \\quad \\text{其中} \\quad R_i = \\|\\mathbf{x}_o - \\mathbf{y}_i\\|\n$$\n远场代理压力是滤波后压力在其各自延迟时间处取值的加权和：\n$$\np'(\\mathbf{x}_o,t) \\approx \\sum_{i=0}^{N_s-1} w_i \\, p_f\\left(\\mathbf{y}_i,\\, t_r^{(i)}(t)\\right)\n$$\n权重 $w_i$ 由 $w_i = \\frac{R_{\\mathrm{ref}}}{4\\pi R_i N_s}$ 给出，其中 $R_{\\mathrm{ref}}=1\\,\\mathrm{m}$ 是一个参考长度。此求和是通过在所需的延迟时间样本 $t_r^{(i)}(t)$ 处对每个滤波信号 $p_f(\\mathbf{y}_i, t)$ 进行插值来执行的。\n\n最后一步是通过计算所得观察者压力信号 $p'(\\mathbf{x}_o,t)$ 的单边功率谱密度 (PSD) $S_{p'p'}(f)$ 来分析其频率内容。首先将长度为 $N$ 的信号乘以汉宁窗 $w[n]$ 以减少频谱泄漏。计算加窗信号的离散傅里叶变换 (DFT) $X[k]$。然后根据以下公式计算单边 PSD：\n$$\nS_{p'p'}(f_k) = \\begin{cases}\n\\frac{1}{f_s N U_w} |X[0]|^2,  k = 0 \\\\\n\\frac{2}{f_s N U_w} |X[k]|^2,  1 \\le k \\le N/2 - 1 \\\\\n\\frac{1}{f_s N U_w} |X[N/2]|^2,  k = N/2 \\text{ (对于偶数 } N\\text{)}\n\\end{cases}\n$$\n其中 $f_k = k f_s/N$ 是离散频率，$U_w = \\frac{1}{N}\\sum_{n=0}^{N-1} w[n]^2$ 是窗功率校正因子。PSD 值在最接近指定的声学频率 $f_a$ 和流体动力学频率 $f_h$ 的频率点处报告。\n\n整个过程被封装在一个 Python 脚本中。为了提高效率，使用了向量化的 `numpy` 操作，而对于涉及跨表面点的非均匀时间平移的步骤（滤波和延迟时间计算），则使用循环。所有插值都由 `numpy.interp` 处理。该脚本遍历提供的测试案例，为每个案例计算两个所要求的 PSD 值，并将输出格式化为包含四舍五入小数的单个列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef process_case(Ns, a, xo, fa, Aa, fh, Ah, U, c0, An, fs, T):\n    \"\"\"\n    Implements the full aeroacoustic post-processing pipeline for a single test case.\n    \"\"\"\n    # Set seed for reproducibility of noise. Using a combination of inputs to\n    # ensure noise is different per case but reproducible for the same case.\n    # A simple seed like 0 is sufficient, but this is more robust if case parameters were permuted.\n    seed_val = Ns + int(a*10) + int(xo[0]) + int(fa) + int(fh)\n    np.random.seed(seed_val)\n\n    # Step 1: Define a circular, permeable FW-H control surface and time array\n    N = int(T * fs)\n    t = np.linspace(0, T, N, endpoint=False)\n    dt = T / N\n\n    theta_i = 2 * np.pi * np.arange(Ns) / Ns\n    y_i = np.zeros((Ns, 3))\n    y_i[:, 0] = a * np.cos(theta_i)\n    y_i[:, 1] = a * np.sin(theta_i)\n    \n    # Step 2: Generate synthetic LES surface pressure signals\n    s_i = y_i[:, 0]  # Projection coordinate s(y_i) = x-component\n    \n    # Use broadcasting for efficient signal generation\n    t_grid = t[np.newaxis, :]\n    s_grid = s_i[:, np.newaxis]\n\n    acoustic_part = Aa * np.cos(2 * np.pi * fa * (t_grid - s_grid / c0))\n    hydro_part = Ah * np.cos(2 * np.pi * fh * (t_grid - s_grid / U))\n    noise_part = np.random.uniform(-An, An, size=(Ns, N))\n    \n    p_s = acoustic_part + hydro_part + noise_part\n    \n    # Step 3: Construct a hydrodynamic pressure estimate and filter\n    q = np.zeros_like(p_s)\n    for i in range(Ns):\n        t_aligned = t + s_i[i] / U\n        # Interpolate p_s at aligned times. Extrapolate with 0.\n        q[i, :] = np.interp(t_aligned, t, p_s[i, :], left=0.0, right=0.0)\n        \n    q_bar = np.mean(q, axis=0)\n    \n    p_h_hat = np.zeros_like(p_s)\n    for i in range(Ns):\n        t_dealigned = t - s_i[i] / U\n        # Interpolate q_bar at de-aligned times. Extrapolate with 0.\n        p_h_hat[i, :] = np.interp(t_dealigned, t, q_bar, left=0.0, right=0.0)\n        \n    p_f = p_s - p_h_hat\n    \n    # Step 4: Compute the FW-H far-field proxy pressure\n    xo_vec = np.array(xo)\n    R_i = np.linalg.norm(xo_vec - y_i, axis=1)\n    \n    R_ref = 1.0\n    w_i = R_ref / (4 * np.pi * R_i * Ns)\n    \n    p_prime = np.zeros(N)\n    for i in range(Ns):\n        t_r = t - R_i[i] / c0\n        p_f_retarded = np.interp(t_r, t, p_f[i, :], left=0.0, right=0.0)\n        p_prime += w_i[i] * p_f_retarded\n        \n    # Step 5: Compute the one-sided power spectral density (PSD)\n    x = p_prime\n    win = np.hanning(N)\n    # Window power correction factor\n    Uw = np.mean(win**2)\n    \n    x_w = x * win\n    X = np.fft.fft(x_w)\n    \n    freqs = np.fft.fftfreq(N, d=dt)\n    \n    psd = np.abs(X)**2 / (fs * N * Uw)\n    \n    # Correct for one-sided PSD, handling N even or odd\n    psd_one_sided = psd[:N//2 + 1]\n    freqs_one_sided = freqs[:N//2 + 1]\n    \n    # Double the power for non-DC and non-Nyquist frequencies\n    if N % 2 == 0:\n        psd_one_sided[1:-1] *= 2\n    else: # N is odd\n        psd_one_sided[1:] *= 2\n\n    # Find PSD values at frequencies closest to fa and fh\n    idx_fa = np.argmin(np.abs(freqs_one_sided - fa))\n    S_fa = psd_one_sided[idx_fa]\n    \n    idx_fh = np.argmin(np.abs(freqs_one_sided - fh))\n    S_fh = psd_one_sided[idx_fh]\n    \n    return S_fa, S_fh\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general case)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 2.0, 'U': 100.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 2 (no hydrodynamic content)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 0.0, 'U': 100.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 3 (near-sonic convection)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 2.0, 'U': 320.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 4 (sparse surface sampling and smaller aperture)\n        {'Ns': 8, 'a': 0.1, 'xo': (5.0, 0.0, 0.0), 'fa': 1200, 'Aa': 1.0, \n         'fh': 300, 'Ah': 2.0, 'U': 150.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n    ]\n\n    results = []\n    for case in test_cases:\n        S_fa, S_fh = process_case(**case)\n        results.append(round(S_fa, 6))\n        results.append(round(S_fh, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}