{
    "hands_on_practices": [
        {
            "introduction": "The foundation of high-fidelity aeroacoustic simulation lies in the design of numerical schemes that minimize error. This first practice delves into the construction and analysis of high-order finite-difference schemes from first principles. By using Taylor series analysis, you will determine the coefficients for both explicit and compact sixth-order stencils, and then use the concept of the modified wavenumber to compare their dispersion characteristics, revealing why compact schemes are often favored for their superior wave-propagation properties .",
            "id": "3973783",
            "problem": "Consider one-dimensional small-amplitude isentropic acoustics governed by the Linearized Euler Equations (LEE) as used in Computational Fluid Dynamics (CFD). On a uniform grid with spacing $\\Delta x$, denote the first spatial derivative operator by $\\partial_{x}$. High-order, low-dissipation discretizations of $\\partial_{x}$ are essential for accurate wave propagation. In this problem, you will derive a sixth-order tridiagonal compact Padé scheme for $\\partial_{x}$, obtain its modified wavenumber, and compare its dispersion to a classical explicit centered sixth-order difference.\n\nLet $u_{i} = u(x_{i})$ be a smooth grid function and $u'_{i} \\approx \\partial_{x} u(x_{i})$ its discrete derivative. Consider the following two discretizations:\n\n1. A tridiagonal compact Padé scheme (unknown coefficients to be determined):\n$$\n\\alpha\\,u'_{i-1} + u'_{i} + \\alpha\\,u'_{i+1}\n= \\frac{1}{\\Delta x}\\left[ A\\left(u_{i+1}-u_{i-1}\\right) + B\\left(u_{i+2}-u_{i-2}\\right) \\right].\n$$\n\n2. An explicit centered sixth-order scheme (unknown coefficients to be determined):\n$$\nu'_{i} = \\frac{1}{\\Delta x}\\left[ a\\left(u_{i+1}-u_{i-1}\\right) + b\\left(u_{i+2}-u_{i-2}\\right) + c\\left(u_{i+3}-u_{i-3}\\right) \\right].\n$$\n\nTasks:\n- Using Taylor-series consistency about $x_{i}$, determine $\\alpha$, $A$, and $B$ such that the compact scheme is sixth-order accurate for $\\partial_{x}$. Similarly, determine $a$, $b$, and $c$ such that the explicit centered scheme is sixth-order accurate.\n- For a plane wave $u_{i} = \\exp\\!\\left(\\mathrm{i} k x_{i}\\right)$ with nondimensional wavenumber $\\kappa = k\\,\\Delta x$ (use radian measure), derive the modified wavenumber $\\kappa^{\\star}$ for each scheme, defined by $u'_{i} \\approx \\mathrm{i}\\,k^{\\star} u_{i}$ and $\\kappa^{\\star} = k^{\\star}\\Delta x$.\n- Let $\\kappa = \\pi/2$. Compute the ratio of absolute dispersion errors,\n$$\nR = \\frac{\\left|\\kappa^{\\star}_{\\mathrm{compact}} - \\kappa\\right|}{\\left|\\kappa^{\\star}_{\\mathrm{explicit}} - \\kappa\\right|}.\n$$\n\nExpress the final value of $R$ as a dimensionless real number. Round your answer to four significant figures. No units are required, and angles must be in radians throughout.",
            "solution": "The user wants to derive the coefficients for a sixth-order compact Padé scheme and a sixth-order explicit centered scheme for the first derivative, derive their respective modified wavenumbers, and compute the ratio of their dispersion errors at a specific nondimensional wavenumber.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\n- **Problem Domain**: One-dimensional isentropic acoustics, Linearized Euler Equations (LEE), uniform grid with spacing $\\Delta x$.\n- **Operators and Functions**: First spatial derivative operator $\\partial_{x}$, a smooth grid function $u_{i} = u(x_{i})$, and its discrete derivative $u'_{i}$.\n- **Compact Padé Scheme**: $\\alpha\\,u'_{i-1} + u'_{i} + \\alpha\\,u'_{i+1} = \\frac{1}{\\Delta x}\\left[ A\\left(u_{i+1}-u_{i-1}\\right) + B\\left(u_{i+2}-u_{i-2}\\right) \\right]$.\n- **Explicit Centered Scheme**: $u'_{i} = \\frac{1}{\\Delta x}\\left[ a\\left(u_{i+1}-u_{i-1}\\right) + b\\left(u_{i+2}-u_{i-2}\\right) + c\\left(u_{i+3}-u_{i-3}\\right) \\right]$.\n- **Task 1**: Determine coefficients $\\alpha$, $A$, $B$ and $a$, $b$, $c$ for sixth-order accuracy.\n- **Task 2**: For a plane wave $u_{i} = \\exp(\\mathrm{i} k x_{i})$ with $\\kappa = k\\,\\Delta x$, derive the modified wavenumber $\\kappa^{\\star}$, defined by $u'_{i} \\approx \\mathrm{i}\\,k^{\\star} u_{i}$ and $\\kappa^{\\star} = k^{\\star}\\Delta x$.\n- **Task 3**: Compute the ratio of absolute dispersion errors $R = \\frac{\\left|\\kappa^{\\star}_{\\mathrm{compact}} - \\kappa\\right|}{\\left|\\kappa^{\\star}_{\\mathrm{explicit}} - \\kappa\\right|}$ for $\\kappa = \\pi/2$.\n- **Output Requirement**: Round $R$ to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the field of numerical analysis for computational fluid dynamics (CFD), specifically concerning high-order finite difference schemes. The problem is well-posed, providing sufficient information to determine the unknown coefficients and compute the required quantities. The language is objective and precise. The problem is a standard exercise in the analysis of numerical methods and does not violate any scientific principles, contain faulty premises, or include subjective claims. All terms are standard within the discipline.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed with the solution.\n\nThe solution is divided into three parts as requested.\n\n**Part 1: Determination of Scheme Coefficients**\n\nTo determine the coefficients, we expand each term in the given schemes in a Taylor series about the point $x_{i}$ and match the coefficients of the derivatives of $u$ to achieve the desired order of accuracy. Let $u^{(n)}_{i}$ denote the $n$-th derivative of $u$ at $x_i$, i.e., $d^n u/dx^n|_{x_i}$.\n\n**Compact Padé Scheme:**\nThe scheme is $\\alpha\\,u'_{i-1} + u'_{i} + \\alpha\\,u'_{i+1} = \\frac{1}{\\Delta x}\\left[ A\\left(u_{i+1}-u_{i-1}\\right) + B\\left(u_{i+2}-u_{i-2}\\right) \\right]$.\nWe expand the terms:\n$u_{i\\pm j} = u_{i} \\pm j\\Delta x u^{(1)}_{i} + \\frac{(j\\Delta x)^2}{2!} u^{(2)}_{i} \\pm \\frac{(j\\Delta x)^3}{3!} u^{(3)}_{i} + \\dots$\n$u'_{i\\pm 1} = u' _{i} \\pm \\Delta x u^{(2)}_{i} + \\frac{(\\Delta x)^2}{2!} u^{(3)}_{i} \\pm \\frac{(\\Delta x)^3}{3!} u^{(4)}_{i} + \\dots$\n\nThe left-hand side (LHS) of the scheme becomes:\n$\\alpha(u'_{i} - \\Delta x u^{(2)}_{i} + \\frac{(\\Delta x)^2}{2} u^{(3)}_{i} - \\dots) + u'_{i} + \\alpha(u'_{i} + \\Delta x u^{(2)}_{i} + \\frac{(\\Delta x)^2}{2} u^{(3)}_{i} + \\dots)$\n$= (1+2\\alpha)u'_{i} + \\alpha(\\Delta x)^2 u^{(3)}_{i} + \\frac{\\alpha}{12}(\\Delta x)^4 u^{(5)}_{i} + O((\\Delta x)^6)$\n\nThe right-hand side (RHS) of the scheme becomes:\n$\\frac{1}{\\Delta x} \\left[ A(2\\Delta x u'_{i} + \\frac{2(\\Delta x)^3}{6}u^{(3)}_{i} + \\frac{2(\\Delta x)^5}{120}u^{(5)}_{i} + \\dots) + B(4\\Delta x u'_{i} + \\frac{2(2\\Delta x)^3}{6}u^{(3)}_{i} + \\frac{2(2\\Delta x)^5}{120}u^{(5)}_{i} + \\dots) \\right]$\n$= (2A+4B)u'_{i} + (\\frac{A}{3} + \\frac{8B}{3})(\\Delta x)^2 u^{(3)}_{i} + (\\frac{A}{60} + \\frac{32B}{60})(\\Delta x)^4 u^{(5)}_{i} + O((\\Delta x)^6)$\n\nFor a sixth-order scheme, the operator must be exact for polynomials up to degree $6$. This requires matching terms up to $u^{(5)}_{i}$. The error will be proportional to $u^{(7)}_{i}$. Equating coefficients of $u'_{_i}$, $u^{(3)}_{i}$, and $u^{(5)}_{i}$ gives the following system of linear equations:\n1. $u'_{i}$: $1+2\\alpha = 2A+4B$\n2. $u^{(3)}_{i}$: $\\alpha = \\frac{A}{3} + \\frac{8B}{3} \\implies 3\\alpha = A+8B$\n3. $u^{(5)}_{i}$: $\\frac{\\alpha}{12} = \\frac{A}{60} + \\frac{32B}{60} \\implies 5\\alpha = A+32B$\n\nSubtracting equation (2) from (3) yields $2\\alpha = 24B$, so $B = \\frac{\\alpha}{12}$.\nSubstituting $B$ into (2): $3\\alpha = A + 8(\\frac{\\alpha}{12}) = A + \\frac{2\\alpha}{3} \\implies A = 3\\alpha - \\frac{2\\alpha}{3} = \\frac{7\\alpha}{3}$.\nSubstituting $A$ and $B$ into (1): $1+2\\alpha = 2(\\frac{7\\alpha}{3}) + 4(\\frac{\\alpha}{12}) = \\frac{14\\alpha}{3} + \\frac{\\alpha}{3} = \\frac{15\\alpha}{3} = 5\\alpha$.\nThis gives $1 = 3\\alpha$, so $\\alpha = \\frac{1}{3}$.\nThen, $A = \\frac{7}{3}(\\frac{1}{3}) = \\frac{7}{9}$ and $B = \\frac{1}{12}(\\frac{1}{3}) = \\frac{1}{36}$.\nThe coefficients are $\\alpha = \\frac{1}{3}$, $A = \\frac{7}{9}$, $B = \\frac{1}{36}$.\n\n**Explicit Centered Scheme:**\nThe scheme is $u'_{i} = \\frac{1}{\\Delta x}\\left[ a\\left(u_{i+1}-u_{i-1}\\right) + b\\left(u_{i+2}-u_{i-2}\\right) + c\\left(u_{i+3}-u_{i-3}\\right) \\right]$.\nUsing the Taylor expansion for $u_{i\\pm j} - u_{i-j} = 2j\\Delta x u'_{i} + \\frac{2(j\\Delta x)^3}{6}u^{(3)}_{i} + \\frac{2(j\\Delta x)^5}{120}u^{(5)}_{i} + O((\\Delta x)^7)$, the RHS becomes:\n$\\frac{1}{\\Delta x} \\left[ a(2\\Delta x u'_{i} + \\frac{(\\Delta x)^3}{3}u^{(3)}_{i} + \\dots) + b(4\\Delta x u'_{i} + \\frac{8(\\Delta x)^3}{3}u^{(3)}_{i} + \\dots) + c(6\\Delta x u'_{i} + \\frac{54(\\Delta x)^3}{6}u^{(3)}_{i} + \\dots) \\right]$\n$= (2a+4b+6c)u'_{i} + (\\frac{a}{3} + \\frac{8b}{3} + 9c)(\\Delta x)^2 u^{(3)}_{i} + (\\frac{a}{60} + \\frac{32b}{60} + \\frac{243c}{60})(\\Delta x)^4 u^{(5)}_{i} + O((\\Delta x)^6)$.\nFor sixth-order accuracy, we require the coefficients of $u'_{i}$ to be $1$ and the coefficients of $u^{(3)}_{i}$ and $u^{(5)}_{i}$ to be $0$.\n1. $u'_{i}$: $2a+4b+6c = 1$\n2. $u^{(3)}_{i}$: $\\frac{a}{3} + \\frac{8b}{3} + 9c = 0 \\implies a+8b+27c = 0$\n3. $u^{(5)}_{i}$: $\\frac{a}{60} + \\frac{32b}{60} + \\frac{243c}{60} = 0 \\implies a+32b+243c = 0$\n\nSubtracting (2) from (3): $24b + 216c = 0 \\implies b = -9c$.\nSubstituting into (2): $a+8(-9c)+27c = 0 \\implies a-72c+27c = 0 \\implies a = 45c$.\nSubstituting into (1): $2(45c)+4(-9c)+6c = 1 \\implies 90c-36c+6c = 1 \\implies 60c=1$, so $c=\\frac{1}{60}$.\nThen, $a = 45(\\frac{1}{60}) = \\frac{3}{4}$ and $b = -9(\\frac{1}{60}) = -\\frac{3}{20}$.\nThe coefficients are $a=\\frac{3}{4}$, $b=-\\frac{3}{20}$, $c=\\frac{1}{60}$.\n\n**Part 2: Modified Wavenumbers**\n\nFor a plane wave $u_j = \\exp(\\mathrm{i} k x_j) = u_i \\exp(\\mathrm{i}(j-i)\\kappa)$, the numerical derivative is $u'_j = \\mathrm{i} k^{\\star} u_j = \\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_j$.\n\n**Compact Padé Scheme:**\nSubstituting the plane wave and its numerical derivative into the scheme:\n$\\alpha \\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_{i-1} + \\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_i + \\alpha \\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_{i+1} = \\frac{1}{\\Delta x}[A(u_{i+1}-u_{i-1}) + B(u_{i+2}-u_{i-2})]$\n$\\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_i (\\alpha e^{-\\mathrm{i}\\kappa} + 1 + \\alpha e^{\\mathrm{i}\\kappa}) = \\frac{u_i}{\\Delta x}[A(e^{\\mathrm{i}\\kappa}-e^{-\\mathrm{i}\\kappa}) + B(e^{2\\mathrm{i}\\kappa}-e^{-2\\mathrm{i}\\kappa})]$\n$\\mathrm{i}\\kappa^{\\star} (1 + 2\\alpha\\cos\\kappa) = A(2\\mathrm{i}\\sin\\kappa) + B(2\\mathrm{i}\\sin(2\\kappa))$\n$\\kappa^{\\star}_{\\mathrm{compact}} = \\frac{2A\\sin\\kappa + 2B\\sin(2\\kappa)}{1+2\\alpha\\cos\\kappa}$\nSubstituting the coefficients $\\alpha=1/3$, $A=7/9$, $B=1/36$:\n$\\kappa^{\\star}_{\\mathrm{compact}} = \\frac{2(\\frac{7}{9})\\sin\\kappa + 2(\\frac{1}{36})\\sin(2\\kappa)}{1+2(\\frac{1}{3})\\cos\\kappa} = \\frac{\\frac{14}{9}\\sin\\kappa + \\frac{1}{18}\\sin(2\\kappa)}{1+\\frac{2}{3}\\cos\\kappa}$\nUsing $\\sin(2\\kappa) = 2\\sin\\kappa\\cos\\kappa$:\n$\\kappa^{\\star}_{\\mathrm{compact}} = \\frac{\\sin\\kappa (\\frac{14}{9} + \\frac{1}{9}\\cos\\kappa)}{1+\\frac{2}{3}\\cos\\kappa} = \\frac{\\frac{\\sin\\kappa}{9}(14+\\cos\\kappa)}{\\frac{1}{3}(3+2\\cos\\kappa)} = \\frac{\\sin\\kappa(14+\\cos\\kappa)}{3(3+2\\cos\\kappa)} = \\frac{\\sin\\kappa(14+\\cos\\kappa)}{9+6\\cos\\kappa}$\n\n**Explicit Centered Scheme:**\nSubstituting the plane wave into the scheme:\n$\\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_i = \\frac{1}{\\Delta x}[ a(u_{i+1}-u_{i-1}) + b(u_{i+2}-u_{i-2}) + c(u_{i+3}-u_{i-3}) ]$\n$\\mathrm{i}\\kappa^{\\star} u_i = u_i [a(e^{\\mathrm{i}\\kappa}-e^{-\\mathrm{i}\\kappa}) + b(e^{2\\i\\kappa}-e^{-2\\mathrmi\\kappa}) + c(e^{3\\mathrmi\\kappa}-e^{-3\\mathrmi\\kappa})]$\n$\\mathrm{i}\\kappa^{\\star} = a(2\\mathrm{i}\\sin\\kappa) + b(2\\mathrm{i}\\sin(2\\kappa)) + c(2\\mathrm{i}\\sin(3\\kappa))$\n$\\kappa^{\\star}_{\\mathrm{explicit}} = 2a\\sin\\kappa + 2b\\sin(2\\kappa) + 2c\\sin(3\\kappa)$\nSubstituting the coefficients $a=3/4$, $b=-3/20$, $c=1/60$:\n$\\kappa^{\\star}_{\\mathrm{explicit}} = 2(\\frac{3}{4})\\sin\\kappa + 2(-\\frac{3}{20})\\sin(2\\kappa) + 2(\\frac{1}{60})\\sin(3\\kappa)$\n$\\kappa^{\\star}_{\\mathrm{explicit}} = \\frac{3}{2}\\sin\\kappa - \\frac{3}{10}\\sin(2\\kappa) + \\frac{1}{30}\\sin(3\\kappa)$\n\n**Part 3: Ratio of Dispersion Errors at $\\kappa = \\pi/2$**\n\nWe are given $\\kappa=\\pi/2$.\nWe have $\\sin(\\pi/2)=1$, $\\cos(\\pi/2)=0$.\n$\\sin(2 \\cdot \\pi/2) = \\sin(\\pi) = 0$.\n$\\sin(3 \\cdot \\pi/2) = -1$.\n\nFor the compact scheme:\n$\\kappa^{\\star}_{\\mathrm{compact}} = \\frac{\\sin(\\pi/2)(14+\\cos(\\pi/2))}{9+6\\cos(\\pi/2)} = \\frac{1(14+0)}{9+0} = \\frac{14}{9}$.\nThe absolute dispersion error is $|\\kappa^{\\star}_{\\mathrm{compact}} - \\kappa| = |\\frac{14}{9} - \\frac{\\pi}{2}|$.\n\nFor the explicit scheme:\n$\\kappa^{\\star}_{\\mathrm{explicit}} = \\frac{3}{2}\\sin(\\frac{\\pi}{2}) - \\frac{3}{10}\\sin(\\pi) + \\frac{1}{30}\\sin(\\frac{3\\pi}{2})$\n$= \\frac{3}{2}(1) - \\frac{3}{10}(0) + \\frac{1}{30}(-1) = \\frac{3}{2} - \\frac{1}{30} = \\frac{45-1}{30} = \\frac{44}{30} = \\frac{22}{15}$.\nThe absolute dispersion error is $|\\kappa^{\\star}_{\\mathrm{explicit}} - \\kappa| = |\\frac{22}{15} - \\frac{\\pi}{2}|$.\n\nNow we compute the ratio $R$:\n$R = \\frac{|\\frac{14}{9} - \\frac{\\pi}{2}|}{|\\frac{22}{15} - \\frac{\\pi}{2}|}$\nNumerically, $\\pi/2 \\approx 1.5708$, $14/9 \\approx 1.5556$, and $22/15 \\approx 1.4667$.\nSince $\\frac{\\pi}{2}  \\frac{14}{9}$ and $\\frac{\\pi}{2}  \\frac{22}{15}$, the absolute values can be removed:\n$R = \\frac{\\frac{\\pi}{2} - \\frac{14}{9}}{\\frac{\\pi}{2} - \\frac{22}{15}} = \\frac{\\frac{9\\pi-28}{18}}{\\frac{15\\pi-44}{30}} = \\frac{9\\pi-28}{18} \\cdot \\frac{30}{15\\pi-44} = \\frac{5(9\\pi-28)}{3(15\\pi-44)} = \\frac{45\\pi-140}{45\\pi-132}$.\nUsing $\\pi \\approx 3.14159265$:\n$45\\pi \\approx 141.37166925$\n$R \\approx \\frac{141.37166925 - 140}{141.37166925 - 132} = \\frac{1.37166925}{9.37166925} \\approx 0.146363$\nRounding to four significant figures, we get $0.1464$.",
            "answer": "$$\\boxed{0.1464}$$"
        },
        {
            "introduction": "Having designed an accurate spatial discretization, the next challenge is to integrate it forward in time without the solution becoming unstable. This exercise explores the critical relationship between the spatial scheme, the time integration method, and the maximum allowable time step, known as the Courant-Friedrichs-Lewy (CFL) constraint. Through a rigorous von Neumann stability analysis, you will derive the precise stability limit for a high-order spatial scheme combined with the popular fourth-order Runge-Kutta method, a fundamental skill for any CFD practitioner .",
            "id": "3973749",
            "problem": "Consider the one-dimensional small-amplitude acoustic motion governed by the linearized Euler equations for an isentropic, uniform base state with constant base density $\\rho_{0}$ and constant speed of sound $c_{0}$. Let the perturbation pressure be $p'(x,t)$ and the perturbation velocity be $u'(x,t)$. The governing equations are\n$$\n\\frac{\\partial p'}{\\partial t} + \\rho_{0} c_{0}^{2} \\frac{\\partial u'}{\\partial x} = 0, \n\\qquad\n\\frac{\\partial u'}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p'}{\\partial x} = 0.\n$$\nIntroduce the state vector $q = \\begin{pmatrix} p' \\\\ u' \\end{pmatrix}$ so that the system can be written in the compact form $q_{t} + A q_{x} = 0$, where\n$$\nA = \\begin{pmatrix} 0  \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}}  0 \\end{pmatrix},\n$$\nand assume periodic boundary conditions on a uniform grid with spacing $\\Delta x$. Discretize the spatial derivative $\\partial/\\partial x$ at grid index $i$ using the nondissipative fourth-order central finite-difference stencil\n$$\n\\left.\\frac{\\partial f}{\\partial x}\\right|_{i} \\approx \\frac{1}{12 \\Delta x} \\left( - f_{i+2} + 8 f_{i+1} - 8 f_{i-1} + f_{i-2} \\right),\n$$\nand integrate in time with the classical four-stage, fourth-order Runge–Kutta (RK) method, commonly referred to as RK$4$.\n\nUsing a Fourier (von Neumann) stability analysis, determine the Courant-Friedrichs-Lewy (CFL) constraint that guarantees linear stability of this fully discrete scheme. Specifically, derive the maximum stable time step $\\Delta t_{\\max}$ as a closed-form analytic expression in terms of the acoustic speed $c_{0}$ and the grid spacing $\\Delta x$. Your derivation must start from the governing equations and proceed by constructing the semi-discrete Fourier symbol of the spatial operator, the eigenvalues of the semi-discrete acoustic system, and the absolute-stability condition implied by the RK$4$ stability polynomial evaluated on the imaginary axis. You must rigorously identify the wavenumber that maximizes the discrete-derivative magnitude for the given stencil.\n\nProvide your final answer as a single closed-form expression involving only $c_{0}$ and $\\Delta x$. The expression yields a quantity in seconds when $c_{0}$ is expressed in $\\mathrm{m/s}$ and $\\Delta x$ in $\\mathrm{m}$, but do not include units in your final boxed answer. Do not insert numerical values and do not simplify by giving approximate decimal constants; retain exact radicals where they arise.",
            "solution": "The linearized Euler equations for isentropic acoustics can be compactly written as\n$$\nq_{t} + A q_{x} = 0, \\qquad q = \\begin{pmatrix} p' \\\\ u' \\end{pmatrix}, \\qquad\nA = \\begin{pmatrix} 0  \\rho_{0} c_{0}^{2} \\\\ \\frac{1}{\\rho_{0}}  0 \\end{pmatrix}.\n$$\nThe flux Jacobian $A$ has eigenvalues $\\lambda_{A} = \\pm c_{0}$, and corresponding left/right-going acoustic characteristic speeds are $\\pm c_{0}$. On a uniform grid with spacing $\\Delta x$, we discretize $\\partial/\\partial x$ using the fourth-order central finite-difference stencil\n$$\n\\left.\\frac{\\partial f}{\\partial x}\\right|_{i} \\approx \\frac{1}{12 \\Delta x} \\left( - f_{i+2} + 8 f_{i+1} - 8 f_{i-1} + f_{i-2} \\right).\n$$\nFor a Fourier mode $f_{i} = \\hat{f} \\exp\\!\\left( \\mathrm{i} \\, \\theta \\, i \\right)$ with nondimensional wavenumber $\\theta = k \\Delta x$, the discrete spatial derivative operator has Fourier symbol\n$$\n\\mathrm{D}(\\theta) = \\frac{\\mathrm{i}}{\\Delta x} \\left[ \\frac{4}{3} \\sin(\\theta) - \\frac{1}{6} \\sin(2 \\theta) \\right].\n$$\nThus the semi-discrete ordinary differential equation for each Fourier mode is\n$$\n\\frac{\\mathrm{d} \\hat{q}}{\\mathrm{d} t} = - A \\, \\mathrm{D}(\\theta) \\, \\hat{q} = - \\frac{\\mathrm{i}}{\\Delta x} \\left[ \\frac{4}{3} \\sin(\\theta) - \\frac{1}{6} \\sin(2 \\theta) \\right] A \\, \\hat{q}.\n$$\nThe eigenvalues of the semi-discrete operator are therefore\n$$\n\\lambda(\\theta) = \\pm \\left( - \\frac{\\mathrm{i}}{\\Delta x} \\left[ \\frac{4}{3} \\sin(\\theta) - \\frac{1}{6} \\sin(2 \\theta) \\right] \\right) c_{0} = \\pm \\mathrm{i} \\, \\omega(\\theta),\n$$\nwhere\n$$\n\\omega(\\theta) = \\frac{c_{0}}{\\Delta x} \\left[ \\frac{4}{3} \\sin(\\theta) - \\frac{1}{6} \\sin(2 \\theta) \\right].\n$$\nHence the semi-discrete system has purely imaginary eigenvalues $\\pm \\mathrm{i} \\, \\omega(\\theta)$, with\n$$\n|\\omega(\\theta)| = \\frac{c_{0}}{\\Delta x} \\left| \\frac{4}{3} \\sin(\\theta) - \\frac{1}{6} \\sin(2 \\theta) \\right|.\n$$\n\nFor time integration, the classical Runge–Kutta of order $4$ (RK$4$) has stability function\n$$\nR(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24}.\n$$\nLet $z = \\lambda(\\theta) \\Delta t = \\mathrm{i} \\, y$, where $y = \\omega(\\theta) \\Delta t$ is real. The absolute stability condition requires $|R(z)| \\leq 1$. On the imaginary axis, $z = \\mathrm{i} \\, y$, we have\n$$\nR(\\mathrm{i} y) = 1 + \\mathrm{i} y - \\frac{y^{2}}{2} - \\mathrm{i} \\frac{y^{3}}{6} + \\frac{y^{4}}{24}.\n$$\nIts real and imaginary parts are\n$$\n\\Re\\{R(\\mathrm{i} y)\\} = 1 - \\frac{y^{2}}{2} + \\frac{y^{4}}{24}, \n\\qquad\n\\Im\\{R(\\mathrm{i} y)\\} = y - \\frac{y^{3}}{6}.\n$$\nTherefore,\n$$\n|R(\\mathrm{i} y)|^{2} = \\left( 1 - \\frac{y^{2}}{2} + \\frac{y^{4}}{24} \\right)^{2} + \\left( y - \\frac{y^{3}}{6} \\right)^{2}.\n$$\nExpanding and simplifying,\n\\begin{align*}\n\\left( 1 - \\frac{y^{2}}{2} + \\frac{y^{4}}{24} \\right)^{2} \n= 1 - y^{2} + \\frac{y^{4}}{3} - \\frac{y^{6}}{24} + \\frac{y^{8}}{576}, \\\\\n\\left( y - \\frac{y^{3}}{6} \\right)^{2} \n= y^{2} - \\frac{y^{4}}{3} + \\frac{y^{6}}{36}.\n\\end{align*}\nAdding these gives\n$$\n|R(\\mathrm{i} y)|^{2} = 1 - \\frac{y^{6}}{72} + \\frac{y^{8}}{576}.\n$$\nThe boundary of absolute stability on the imaginary axis satisfies $|R(\\mathrm{i} y)|^{2} = 1$, which yields\n$$\n- \\frac{y^{6}}{72} + \\frac{y^{8}}{576} = 0 \\quad \\Longrightarrow \\quad y^{6} \\left( - \\frac{1}{72} + \\frac{y^{2}}{576} \\right) = 0,\n$$\nso that the nontrivial bound is\n$$\n\\frac{y^{2}}{576} = \\frac{1}{72} \\quad \\Longrightarrow \\quad y^{2} = 8 \\quad \\Longrightarrow \\quad y_{\\max} = 2 \\sqrt{2}.\n$$\nHence RK$4$ is stable for purely imaginary $z$ provided $|y| \\leq 2 \\sqrt{2}$, i.e.,\n$$\n|\\omega(\\theta)| \\, \\Delta t \\leq 2 \\sqrt{2} \\quad \\text{for all admissible } \\theta.\n$$\n\nThe maximal discrete spatial frequency magnitude from the fourth-order central derivative is obtained by maximizing\n$$\nf(\\theta) = \\frac{4}{3} \\sin(\\theta) - \\frac{1}{6} \\sin(2 \\theta), \\qquad \\theta \\in [0, \\pi].\n$$\nUsing the identity $\\sin(2 \\theta) = 2 \\sin(\\theta) \\cos(\\theta)$, we write\n$$\nf(\\theta) = \\sin(\\theta) \\left( \\frac{4}{3} - \\frac{1}{3} \\cos(\\theta) \\right).\n$$\nSince $\\sin(\\theta) \\geq 0$ for $\\theta \\in [0, \\pi]$, we find critical points by differentiating:\n\\begin{align*}\nf'(\\theta) \n= \\cos(\\theta) \\left( \\frac{4}{3} - \\frac{1}{3} \\cos(\\theta) \\right) + \\sin(\\theta) \\left( \\frac{1}{3} \\sin(\\theta) \\right) \\\\\n= \\frac{1}{3} \\left( 4 \\cos(\\theta) - \\cos^{2}(\\theta) + \\sin^{2}(\\theta) \\right) \\\\\n= \\frac{1}{3} \\left( 4 \\cos(\\theta) - 2 \\cos^{2}(\\theta) + 1 \\right),\n\\end{align*}\nwhere we used $\\sin^{2}(\\theta) = 1 - \\cos^{2}(\\theta)$. Setting $f'(\\theta) = 0$ and letting $u = \\cos(\\theta)$ yields\n$$\n2 u^{2} - 4 u - 1 = 0 \\quad \\Longrightarrow \\quad u = \\frac{2 \\pm \\sqrt{6}}{2}.\n$$\nThe admissible solution in $[-1, 1]$ is\n$$\nu_{\\star} = \\cos(\\theta_{\\star}) = \\frac{2 - \\sqrt{6}}{2} = 1 - \\frac{\\sqrt{6}}{2}.\n$$\nTherefore,\n$$\n\\sin^{2}(\\theta_{\\star}) = 1 - u_{\\star}^{2} = \\sqrt{6} - \\frac{3}{2}, \\qquad \\sin(\\theta_{\\star}) = \\sqrt{ \\sqrt{6} - \\frac{3}{2} }.\n$$\nThe bracket evaluates to\n$$\n\\frac{4}{3} - \\frac{1}{3} u_{\\star} = \\frac{1}{3} \\left( 4 - u_{\\star} \\right) = \\frac{1}{3} \\left( 4 - \\left( 1 - \\frac{\\sqrt{6}}{2} \\right) \\right) = 1 + \\frac{\\sqrt{6}}{6}.\n$$\nHence the maximum of $f(\\theta)$ over $\\theta \\in [0, \\pi]$ is\n$$\nf_{\\max} = \\sqrt{ \\sqrt{6} - \\frac{3}{2} } \\left( 1 + \\frac{\\sqrt{6}}{6} \\right).\n$$\nConsequently, the maximum spatial frequency magnitude is\n$$\n|\\omega|_{\\max} = \\frac{c_{0}}{\\Delta x} f_{\\max}.\n$$\nImposing the RK$4$ imaginary-axis stability bound $|\\omega|_{\\max} \\Delta t \\leq 2 \\sqrt{2}$ gives the maximal stable time step\n$$\n\\Delta t_{\\max} = \\frac{2 \\sqrt{2}}{|\\omega|_{\\max}} = \\frac{2 \\sqrt{2} \\, \\Delta x}{c_{0} \\, f_{\\max}} = \\frac{2 \\sqrt{2} \\, \\Delta x}{ c_{0} \\left( 1 + \\frac{\\sqrt{6}}{6} \\right) \\sqrt{ \\sqrt{6} - \\frac{3}{2} } }.\n$$\nThis is the desired Courant-Friedrichs-Lewy constraint expressed in terms of the acoustic speed $c_{0}$, grid spacing $\\Delta x$, and the chosen low-dissipation high-order spatial discretization combined with RK$4$ time integration. When $c_{0}$ is in $\\mathrm{m/s}$ and $\\Delta x$ in $\\mathrm{m}$, the formula yields $\\Delta t_{\\max}$ in seconds.",
            "answer": "$$\\boxed{\\frac{2 \\sqrt{2} \\,\\Delta x}{\\,c_{0}\\left(1+\\frac{\\sqrt{6}}{6}\\right)\\sqrt{\\sqrt{6}-\\frac{3}{2}}\\,}}$$"
        },
        {
            "introduction": "Theory comes to life in this final practice, where you will implement a complete one-dimensional aeroacoustics simulation. This exercise synthesizes the concepts of high-order spatial discretization and stable time integration to model the propagation of a monochromatic sound wave over many periods. By building a solver with a Dispersion-Relation-Preserving (DRP) scheme and measuring the resulting amplitude and phase errors, you will gain tangible insight into how these advanced numerical methods succeed in preserving the integrity of acoustic waves over long distances .",
            "id": "3973747",
            "problem": "You are tasked with implementing a Dispersion-Relation-Preserving (DRP) spatial discretization for the one-dimensional acoustics derived from the linearized Euler equations and quantifying the numerical dispersion (phase error) and numerical dissipation (amplitude error) for a monochromatic traveling wave. The fundamental base is the linearized Euler equations for small disturbances about a uniform quiescent state, which in one spatial dimension reduce to the coupled system\n$$\n\\frac{\\partial p'}{\\partial t} + \\rho_0 c_0^2 \\frac{\\partial u'}{\\partial x} = 0, \\qquad \\frac{\\partial u'}{\\partial t} + \\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial x} = 0,\n$$\nwhere $p'$ is the acoustic pressure fluctuation, $u'$ is the acoustic velocity fluctuation, $\\rho_0$ is the mean density, and $c_0$ is the speed of sound. Under harmonic plane-wave assumptions $p'(x,t) = \\mathrm{Re}\\{ \\hat{p} e^{i(k x - \\omega t)} \\}$ and $u'(x,t) = \\mathrm{Re}\\{ \\hat{u} e^{i(k x - \\omega t)} \\}$, the exact dispersion relation satisfies $\\omega = c_0 k$ and the relation $u' = p'/(\\rho_0 c_0)$ for a right-traveling wave.\n\nYour program must:\n- Discretize the spatial domain of length $L = \\lambda$ (one wavelength) with $M$ points per wavelength, where $\\lambda$ is the physical wavelength. Use periodic boundary conditions.\n- Implement a DRP-centered finite difference operator for the first derivative $\\partial / \\partial x$ using a symmetric $7$-point stencil with coefficients $\\{w_1,w_2,w_3\\}$ applied to offsets $\\{\\pm 1, \\pm 2, \\pm 3\\}$ such that the discrete derivative at grid index $i$ is\n$$\n\\left.\\frac{\\partial f}{\\partial x}\\right|_i \\approx \\frac{1}{\\Delta x}\\left( w_1 \\left(f_{i+1} - f_{i-1}\\right) + w_2 \\left(f_{i+2} - f_{i-2}\\right) + w_3 \\left(f_{i+3} - f_{i-3}\\right) \\right),\n$$\nwith $\\Delta x = \\lambda/M$. The chosen weights must be designed from first principles to match low-wavenumber behavior of the exact derivative and reduce numerical dispersion, while ensuring zero artificial dissipation due to the antisymmetry of the stencil.\n- Integrate the coupled system in time using an explicit scheme that is appropriate for linear hyperbolic systems. Use a uniform time step $\\Delta t$ chosen to satisfy a specified Courant-Friedrichs-Lewy (CFL) bound $\\sigma = c_0 \\Delta t/\\Delta x \\leq \\sigma_{\\max}$ for stability. The total simulation time must be $T = N P$, where $P$ is the temporal period of the plane wave and $N$ is the number of periods. For a plane wave of wavelength $\\lambda$, the temporal period is $P = \\lambda/c_0$, so $T = N \\lambda / c_0$.\n- Initialize a right-traveling monochromatic wave consistent with the governing equations: $p'(x,0) = \\cos(k x)$ and $u'(x,0) = p'(x,0)/(\\rho_0 c_0)$, where $k = 2\\pi/\\lambda$.\n- After integrating to time $T$, compute the numerical amplitude $A$ and phase $\\phi$ of the pressure field by projecting $p'(x,T)$ onto $\\cos(kx)$ and $\\sin(kx)$ via discrete inner products on the periodic grid. Specifically, compute\n$$\na_c = \\frac{2}{M} \\sum_{j=0}^{M-1} p'(x_j, T)\\cos(k x_j), \\qquad a_s = \\frac{2}{M} \\sum_{j=0}^{M-1} p'(x_j, T)\\sin(k x_j),\n$$\nwith $x_j = j \\Delta x$, and then\n$$\nA = \\sqrt{a_c^2 + a_s^2}, \\qquad \\phi = \\mathrm{atan2}(-a_s, a_c).\n$$\n- Report the amplitude error as the float $A - 1$ (dimensionless) and the phase error as the float $\\phi$ in radians. Angles must be expressed in radians. Physical units must be used for parameters: $\\lambda$ in meters, $c_0$ in meters per second, $\\rho_0$ in kilograms per cubic meter, $t$ in seconds.\n\nScientific realism requirements:\n- The DRP stencil must be derived by enforcing low-wavenumber matching of the exact derivative symbol and eliminating leading-order dispersion errors through moment conditions on the weights, while maintaining central symmetry to avoid artificial dissipation.\n- The time integrator must be consistent with the hyperbolic nature of the equations, and the stability bound must be enforced by choosing $\\Delta t$ such that $c_0 \\Delta t/\\Delta x \\leq \\sigma_{\\max}$.\n\nTest suite:\nUse the following parameter sets. For all cases, use $\\rho_0 = 1.225$ kilograms per cubic meter, $c_0 = 343$ meters per second, and $\\lambda = 1$ meter. The CFL bound to enforce is $\\sigma_{\\max} = 0.5$.\n- Case 1 (happy path): $M = 16$ points per wavelength, $N = 5$ periods.\n- Case 2 (edge: minimal resolution): $M = 8$ points per wavelength, $N = 1$ period.\n- Case 3 (edge: no evolution): $M = 16$ points per wavelength, $N = 0$ periods.\n- Case 4 (higher resolution, moderate duration): $M = 32$ points per wavelength, $N = 10$ periods.\n- Case 5 (high resolution, long duration): $M = 64$ points per wavelength, $N = 20$ periods.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case result given as a bracketed two-float list in the form $[A-1,\\phi]$ using radians for $\\phi$. For example: \"[[amp_error1,phase_error1],[amp_error2,phase_error2],...]\".",
            "solution": "The user-provided problem is assessed to be **valid**. It is a well-posed, scientifically grounded problem in the field of computational aeroacoustics that asks for the implementation and analysis of a numerical scheme for the linearized Euler equations. The problem is self-contained and all necessary parameters and evaluation metrics are clearly defined.\n\nThe solution proceeds in several stages: design of the spatial discretization operator, selection of a temporal integration scheme, implementation of the simulation loop, and post-processing to quantify numerical errors.\n\n**1. Spatial Discretization: A Dispersion-Relation-Preserving (DRP) Scheme**\n\nThe problem requires a symmetric $7$-point finite difference stencil to approximate the spatial derivative $\\partial/\\partial x$.\n$$\n\\left.\\frac{\\partial f}{\\partial x}\\right|_i \\approx \\frac{1}{\\Delta x}\\left( w_1 (f_{i+1} - f_{i-1}) + w_2 (f_{i+2} - f_{i-2}) + w_3 (f_{i+3} - f_{i-3}) \\right)\n$$\nThe weights $\\{w_1, w_2, w_3\\}$ are designed to minimize numerical dispersion error. A standard and effective method to achieve this for low-to-moderate wavenumbers is to construct a high-order-of-accuracy scheme. We derive the weights for a sixth-order accurate scheme by matching the Taylor series expansion of the discrete operator to that of the exact derivative.\n\nThe Taylor series expansion of the stencil applied to a function $f(x)$ at grid point $x_i$ is:\n$$\n\\delta_x f_i = \\left( 2\\sum_{m=1}^3 m w_m \\right) f'_i + \\frac{(\\Delta x)^2}{3} \\left( \\sum_{m=1}^3 m^3 w_m \\right) f'''_i + \\frac{(\\Delta x)^4}{60} \\left( \\sum_{m=1}^3 m^5 w_m \\right) f^{(5)}_i + O((\\Delta x)^6)\n$$\nTo make this operator sixth-order accurate ($\\delta_x f_i = f'_i + O((\\Delta x)^6)$), we must enforce the following conditions on the weights:\n1.  Coefficient of $f'_i$ must be $1$: $2(w_1 + 2w_2 + 3w_3) = 1$.\n2.  Coefficient of $f'''_i$ must be $0$: $w_1 + 8w_2 + 27w_3 = 0$.\n3.  Coefficient of $f^{(5)}_i$ must be $0$: $w_1 + 32w_2 + 243w_3 = 0$.\n\nSolving this linear system of three equations for the three unknown weights yields the unique solution:\n$$\nw_1 = \\frac{3}{4}, \\qquad w_2 = -\\frac{3}{20}, \\qquad w_3 = \\frac{1}{60}\n$$\nThis scheme is a high-fidelity approximation of the derivative. Because the stencil is antisymmetric (symmetric weights applied to an antisymmetric pattern of grid points), the eigenvalues of the discrete derivative operator are purely imaginary. For a hyperbolic system like the one given, this ensures that the semi-discretization introduces no artificial dissipation, thereby preserving wave amplitude. The only errors will be in the wave's phase (dispersion).\n\n**2. Temporal Discretization: The Fourth-Order Runge-Kutta (RK4) Scheme**\n\nThe semi-discretized system of equations can be written in the form of a system of ordinary differential equations (ODEs), $\\frac{d\\mathbf{q}}{dt} = \\mathbf{F}(\\mathbf{q})$, where $\\mathbf{q}$ is the global vector of states ($p'$ and $u'$ at all grid points) and $\\mathbf{F}$ represents the application of the spatial derivative operators.\n\nTo integrate this system in time, we choose the classical fourth-order Runge-Kutta (RK4) scheme. This explicit scheme is selected for its high order of accuracy, which is consistent with the sixth-order spatial stencil, its favorable stability properties for wave problems, and its low inherent numerical dissipation. For a single time step from $t_n$ to $t_{n+1} = t_n + \\Delta t$, the RK4 update is:\n$$\n\\begin{align*}\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{F}(\\mathbf{q}_n) \\\\\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{F}(\\mathbf{q}_n + \\frac{1}{2}\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{F}(\\mathbf{q}_n + \\frac{1}{2}\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{F}(\\mathbf{q}_n + \\mathbf{k}_3) \\\\\n\\mathbf{q}_{n+1} = \\mathbf{q}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n\\end{align*}\n$$\n\n**3. Stability and Simulation Parameters**\n\nThe stability of this explicit numerical scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition. The time step $\\Delta t$ must be small enough to ensure that information does not propagate across more than a certain number of grid cells in a single step. The problem specifies a CFL number bound $\\sigma = c_0 \\Delta t / \\Delta x \\leq \\sigma_{\\max} = 0.5$. We use the limiting value to take the largest stable time step:\n$$\n\\Delta t = \\frac{\\sigma_{\\max} \\Delta x}{c_0} = \\frac{0.5 \\cdot (\\lambda/M)}{c_0}\n$$\nThe total simulation time is $T = N P = N \\lambda / c_0$. The total number of time steps, $N_{steps}$, is:\n$$\nN_{steps} = \\frac{T}{\\Delta t} = \\frac{N \\lambda / c_0}{0.5 (\\lambda/M) / c_0} = \\frac{N M}{0.5} = 2NM\n$$\nSince $N$ and $M$ are integers, $N_{steps}$ is always an integer. This ensures that the simulation runs for exactly $N$ periods.\n\n**4. Error Analysis**\n\nThe initial condition is a right-traveling monochromatic wave. After evolving for an integer number of temporal periods $N$, the exact solution $p'_{\\text{exact}}(x, T)$ should be identical to the initial condition $p'(x, 0) = \\cos(kx)$, since $p'_{\\text{exact}}(x,T) = \\cos(k(x - c_0 T)) = \\cos(kx - k c_0 (N\\lambda/c_0)) = \\cos(kx - 2\\pi N) = \\cos(kx)$.\n\nThe numerical solution $p'_{\\text{num}}(x, T)$ will differ from the exact solution due to numerical errors. We quantify these errors by projecting the numerical solution onto the basis functions $\\cos(kx)$ and $\\sin(kx)$. The amplitude $A$ and phase $\\phi$ of the numerical wave are calculated using the provided formulae:\n$$\na_c = \\frac{2}{M} \\sum_{j=0}^{M-1} p'_{\\text{num}}(x_j, T)\\cos(k x_j), \\qquad a_s = \\frac{2}{M} \\sum_{j=0}^{M-1} p'_{\\text{num}}(x_j, T)\\sin(k x_j)\n$$\n$$\nA = \\sqrt{a_c^2 + a_s^2}, \\qquad \\phi = \\mathrm{atan2}(-a_s, a_c)\n$$\nThe amplitude error is then $A-1$, and the phase error is $\\phi$. A positive phase error $\\phi$ corresponds to a numerical wave that lags behind the exact wave, indicating a numerical wave speed lower than $c_0$. For the trivial case where $N=0$, the simulation time is $T=0$, so the final state is the initial state. The discrete projection of $\\cos(kx)$ onto itself yields $a_c=1$ and $a_s=0$, resulting in zero amplitude and phase error, as expected.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D linearized Euler acoustics problem using a DRP scheme\n    and quantifies numerical errors for a set of test cases.\n    \"\"\"\n\n    # Define physical constants given in the problem statement.\n    # All values are in SI units.\n    rho0 = 1.225    # Mean density (kg/m^3)\n    c0 = 343.0      # Speed of sound (m/s)\n    lmbda = 1.0     # Wavelength (m)\n    \n    # Derived constant\n    k = 2.0 * np.pi / lmbda  # Wavenumber (rad/m)\n\n    # Courant-Friedrichs-Lewy (CFL) number bound\n    sigma_max = 0.5\n\n    # Coefficients for the 6th-order symmetric 7-point finite difference stencil.\n    # These are derived by enforcing 6th-order accuracy via Taylor series expansion,\n    # which serves as a high-fidelity dispersion-relation-preserving (DRP) scheme.\n    # d/dx(f)_i ≈ (1/dx) * [w1(f_{i+1}-f_{i-1}) + w2(f_{i+2}-f_{i-2}) + w3(f_{i+3}-f_{i-3})]\n    # w = {w1, w2, w3}\n    w_coeffs = np.array([3.0/4.0, -3.0/20.0, 1.0/60.0])\n\n    def spatial_derivative(f_grid, dx, coeffs):\n        \"\"\"\n        Computes the first derivative of a periodic function on a uniform grid\n        using a symmetric finite difference stencil.\n        \"\"\"\n        dfdx = np.zeros_like(f_grid)\n        for i in range(len(coeffs)):\n            offset = i + 1\n            # np.roll handles periodic boundary conditions efficiently\n            dfdx += coeffs[i] * (np.roll(f_grid, -offset) - np.roll(f_grid, offset))\n        return dfdx / dx\n\n    def compute_rhs(q_vec, dx, M, rho0, c0, coeffs):\n        \"\"\"\n        Computes the right-hand side (RHS) of the semi-discretized system dq/dt = F(q).\n        `q_vec` is a state vector containing both pressure and velocity fields.\n        \"\"\"\n        p_field = q_vec[:M]\n        u_field = q_vec[M:]\n        \n        # Calculate spatial derivatives for both fields\n        dp_dx = spatial_derivative(p_field, dx, coeffs)\n        du_dx = spatial_derivative(u_field, dx, coeffs)\n        \n        # Compute time derivatives according to the linearized Euler equations\n        # dp'/dt = -rho0 * c0^2 * du'/dx\n        # du'/dt = -1/rho0 * dp'/dx\n        dp_dt = -rho0 * c0**2 * du_dx\n        du_dt = -1.0 / rho0 * dp_dx\n        \n        return np.concatenate([dp_dt, du_dt])\n\n    def run_simulation(M, N, rho0, c0, lmbda, k, coeffs, sigma):\n        \"\"\"\n        Runs the complete simulation for a given number of points per wavelength (M)\n        and number of periods (N).\n        \"\"\"\n        # Handle the trivial case where simulation time is zero.\n        if N == 0:\n            # For N=0, the final state is the initial state. The projection\n            # of the initial wave onto itself gives A=1 and phi=0.\n            return 0.0, 0.0\n\n        # Setup grid and time step parameters\n        dx = lmbda / M\n        x_grid = np.linspace(0, lmbda, M, endpoint=False)\n        \n        P = lmbda / c0  # Temporal period of the wave\n        T_final = N * P # Total simulation time\n        \n        # The number of time steps is calculated to reach T_final exactly\n        # with a time step dt determined by the CFL number.\n        # n_steps = T / dt = (N*lmbda/c0) / (sigma*dx/c0) = N*M/sigma\n        n_steps = int(round(N * M / sigma))\n        dt = T_final / n_steps\n        \n        # Initialize fields: a right-traveling monochromatic wave\n        p_initial = np.cos(k * x_grid)\n        u_initial = p_initial / (rho0 * c0)\n        q = np.concatenate([p_initial, u_initial])\n\n        # Time integration using the 4th-order Runge-Kutta (RK4) method\n        for _ in range(n_steps):\n            k1 = dt * compute_rhs(q, dx, M, rho0, c0, coeffs)\n            k2 = dt * compute_rhs(q + 0.5 * k1, dx, M, rho0, c0, coeffs)\n            k3 = dt * compute_rhs(q + 0.5 * k2, dx, M, rho0, c0, coeffs)\n            k4 = dt * compute_rhs(q + k3, dx, M, rho0, c0, coeffs)\n            q += (k1 + 2.0 * k2 + 2.0 * k3 + k4) / 6.0\n            \n        p_final = q[:M]\n        \n        # Post-processing: Calculate amplitude and phase errors\n        # The exact solution after N periods is the initial condition.\n        cos_kx = np.cos(k * x_grid)\n        sin_kx = np.sin(k * x_grid)\n        \n        # Project the final numerical solution onto cos(kx) and sin(kx)\n        a_c = (2.0 / M) * np.sum(p_final * cos_kx)\n        a_s = (2.0 / M) * np.sum(p_final * sin_kx)\n        \n        # Calculate numerical amplitude and phase\n        A = np.sqrt(a_c**2 + a_s**2)\n        phi = np.arctan2(-a_s, a_c)\n        \n        amplitude_error = A - 1.0\n        phase_error = phi\n        \n        return amplitude_error, phase_error\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        (16, 5),   # Case 1: happy path\n        (8, 1),    # Case 2: edge, minimal resolution\n        (16, 0),   # Case 3: edge, no evolution\n        (32, 10),  # Case 4: higher resolution, moderate duration\n        (64, 20),  # Case 5: high resolution, long duration\n    ]\n\n    results = []\n    for M_val, N_val in test_cases:\n        amp_err, phase_err = run_simulation(M_val, N_val, rho0, c0, lmbda, k, w_coeffs, sigma_max)\n        results.append(f\"[{amp_err},{phase_err}]\")\n\n    # Print the final results in the specified single-line format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}