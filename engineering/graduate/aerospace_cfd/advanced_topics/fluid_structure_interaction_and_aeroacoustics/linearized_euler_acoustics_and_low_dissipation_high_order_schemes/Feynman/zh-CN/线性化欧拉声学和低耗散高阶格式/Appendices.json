{
    "hands_on_practices": [
        {
            "introduction": "这项练习是理解低耗散格式的理论基石。通过推导紧致和显式六阶格式的系数及其修正波数，您将亲身体会到为何某些格式在波传播问题中表现更优。这项练习旨在通过泰勒级数和傅里叶分析等方法，提升您评估数值方法的分析能力。",
            "id": "3973783",
            "problem": "考虑由计算流体动力学 (CFD) 中使用的线性化欧拉方程 (LEE) 控制的一维小振幅等熵声学。在间距为 $\\Delta x$ 的均匀网格上，将一阶空间导数算子表示为 $\\partial_{x}$。对于精确的波传播而言，$\\partial_{x}$ 的高阶、低耗散离散化至关重要。在本问题中，您将为 $\\partial_{x}$ 推导一个六阶三对角紧致 Padé 格式，求出其修正波数，并将其色散与经典的显式中心六阶差分进行比较。\n\n令 $u_{i} = u(x_{i})$ 为一个光滑的网格函数，其离散导数为 $u'_{i} \\approx \\partial_{x} u(x_{i})$。考虑以下两种离散化方法：\n\n1. 一个三对角紧致 Padé 格式（待定系数）：\n$$\n\\alpha\\,u'_{i-1} + u'_{i} + \\alpha\\,u'_{i+1}\n= \\frac{1}{\\Delta x}\\left[ A\\left(u_{i+1}-u_{i-1}\\right) + B\\left(u_{i+2}-u_{i-2}\\right) \\right].\n$$\n\n2. 一个显式中心六阶格式（待定系数）：\n$$\nu'_{i} = \\frac{1}{\\Delta x}\\left[ a\\left(u_{i+1}-u_{i-1}\\right) + b\\left(u_{i+2}-u_{i-2}\\right) + c\\left(u_{i+3}-u_{i-3}\\right) \\right].\n$$\n\n任务：\n- 使用关于 $x_{i}$ 的泰勒级数相容性，确定 $\\alpha$、$A$ 和 $B$，使得紧致格式对于 $\\partial_{x}$ 是六阶精确的。类似地，确定 $a$、$b$ 和 $c$，使得显式中心格式是六阶精确的。\n- 对于平面波 $u_{i} = \\exp\\!\\left(\\mathrm{i} k x_{i}\\right)$，其无量纲波数为 $\\kappa = k\\,\\Delta x$（使用弧度制），推导每种格式的修正波数 $\\kappa^{\\star}$，其定义为 $u'_{i} \\approx \\mathrm{i}\\,k^{\\star} u_{i}$ 和 $\\kappa^{\\star} = k^{\\star}\\Delta x$。\n- 令 $\\kappa = \\pi/2$。计算绝对色散误差之比，\n$$\nR = \\frac{\\left|\\kappa^{\\star}_{\\mathrm{compact}} - \\kappa\\right|}{\\left|\\kappa^{\\star}_{\\mathrm{explicit}} - \\kappa\\right|}.\n$$\n\n将 $R$ 的最终值表示为一个无量纲实数。将您的答案四舍五入到四位有效数字。不需要单位，并且整个计算过程中角度必须使用弧度制。",
            "solution": "用户希望为一阶导数推导六阶紧致 Padé 格式和六阶显式中心格式的系数，推导它们各自的修正波数，并计算在特定无量纲波数下它们的色散误差之比。\n\n首先，我将验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **问题领域**：一维等熵声学，线性化欧拉方程 (LEE)，间距为 $\\Delta x$ 的均匀网格。\n- **算子和函数**：一阶空间导数算子 $\\partial_{x}$，光滑网格函数 $u_{i} = u(x_{i})$，及其离散导数 $u'_{i}$。\n- **紧致 Padé 格式**：$\\alpha\\,u'_{i-1} + u'_{i} + \\alpha\\,u'_{i+1} = \\frac{1}{\\Delta x}\\left[ A\\left(u_{i+1}-u_{i-1}\\right) + B\\left(u_{i+2}-u_{i-2}\\right) \\right]$。\n- **显式中心格式**：$u'_{i} = \\frac{1}{\\Delta x}\\left[ a\\left(u_{i+1}-u_{i-1}\\right) + b\\left(u_{i+2}-u_{i-2}\\right) + c\\left(u_{i+3}-u_{i-3}\\right) \\right]$。\n- **任务 1**：确定系数 $\\alpha$、$A$、$B$ 和 $a$、$b$、$c$ 以达到六阶精度。\n- **任务 2**：对于平面波 $u_{i} = \\exp(\\mathrm{i} k x_{i})$，其无量纲波数为 $\\kappa = k\\,\\Delta x$，推导修正波数 $\\kappa^{\\star}$，其定义为 $u'_{i} \\approx \\mathrm{i}\\,k^{\\star} u_{i}$ 和 $\\kappa^{\\star} = k^{\\star}\\Delta x$。\n- **任务 3**：对于 $\\kappa = \\pi/2$，计算绝对色散误差之比 $R = \\frac{\\left|\\kappa^{\\star}_{\\mathrm{compact}} - \\kappa\\right|}{\\left|\\kappa^{\\star}_{\\mathrm{explicit}} - \\kappa\\right|}$。\n- **输出要求**：将 $R$ 四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上植根于计算流体动力学 (CFD) 的数值分析领域，特别涉及高阶有限差分格式。该问题是适定的，提供了足够的信息来确定未知系数并计算所需的量。语言客观而精确。该问题是数值方法分析中的一个标准练习，不违反任何科学原理，不包含错误的假设，也不包括主观断言。所有术语在该学科中都是标准的。\n\n### 步骤 3：结论与行动\n问题是**有效的**。我将继续进行求解。\n\n根据要求，解答分为三个部分。\n\n**第 1 部分：格式系数的确定**\n\n为确定系数，我们将给定格式中的每一项在点 $x_{i}$ 附近进行泰勒级数展开，并通过匹配 $u$ 的各阶导数的系数来达到所需的精度阶数。令 $u^{(n)}_{i}$ 表示 $u$ 在 $x_i$ 处的 $n$ 阶导数，即 $d^n u/dx^n|_{x_i}$。\n\n**紧致 Padé 格式：**\n该格式为 $\\alpha\\,u'_{i-1} + u'_{i} + \\alpha\\,u'_{i+1} = \\frac{1}{\\Delta x}\\left[ A\\left(u_{i+1}-u_{i-1}\\right) + B\\left(u_{i+2}-u_{i-2}\\right) \\right]$。\n我们展开各项：\n$u_{i\\pm j} = u_{i} \\pm j\\Delta x u^{(1)}_{i} + \\frac{(j\\Delta x)^2}{2!} u^{(2)}_{i} \\pm \\frac{(j\\Delta x)^3}{3!} u^{(3)}_{i} + \\dots$\n$u'_{i\\pm 1} = u' _{i} \\pm \\Delta x u^{(2)}_{i} + \\frac{(\\Delta x)^2}{2!} u^{(3)}_{i} \\pm \\frac{(\\Delta x)^3}{3!} u^{(4)}_{i} + \\dots$\n\n格式的左侧 (LHS) 变为：\n$\\alpha(u'_{i} - \\Delta x u^{(2)}_{i} + \\frac{(\\Delta x)^2}{2} u^{(3)}_{i} - \\dots) + u'_{i} + \\alpha(u'_{i} + \\Delta x u^{(2)}_{i} + \\frac{(\\Delta x)^2}{2} u^{(3)}_{i} + \\dots)$\n$= (1+2\\alpha)u'_{i} + \\alpha(\\Delta x)^2 u^{(3)}_{i} + \\frac{\\alpha}{12}(\\Delta x)^4 u^{(5)}_{i} + O((\\Delta x)^6)$\n\n格式的右侧 (RHS) 变为：\n$\\frac{1}{\\Delta x} \\left[ A(2\\Delta x u'_{i} + \\frac{2(\\Delta x)^3}{6}u^{(3)}_{i} + \\frac{2(\\Delta x)^5}{120}u^{(5)}_{i} + \\dots) + B(4\\Delta x u'_{i} + \\frac{2(2\\Delta x)^3}{6}u^{(3)}_{i} + \\frac{2(2\\Delta x)^5}{120}u^{(5)}_{i} + \\dots) \\right]$\n$= (2A+4B)u'_{i} + (\\frac{A}{3} + \\frac{8B}{3})(\\Delta x)^2 u^{(3)}_{i} + (\\frac{A}{60} + \\frac{32B}{60})(\\Delta x)^4 u^{(5)}_{i} + O((\\Delta x)^6)$\n\n对于一个六阶格式，算子必须对最高 6 次的多项式精确。这要求匹配到 $u^{(5)}_{i}$ 的项。误差将与 $u^{(7)}_{i}$ 成正比。令 $u'_{i}$、$u^{(3)}_{i}$ 和 $u^{(5)}_{i}$ 的系数相等，得到以下线性方程组：\n1. $u'_{i}$: $1+2\\alpha = 2A+4B$\n2. $u^{(3)}_{i}$: $\\alpha = \\frac{A}{3} + \\frac{8B}{3} \\implies 3\\alpha = A+8B$\n3. $u^{(5)}_{i}$: $\\frac{\\alpha}{12} = \\frac{A}{60} + \\frac{32B}{60} \\implies 5\\alpha = A+32B$\n\n用方程 (3) 减去方程 (2) 得到 $2\\alpha = 24B$，所以 $B = \\frac{\\alpha}{12}$。\n将 $B$ 代入 (2)：$3\\alpha = A + 8(\\frac{\\alpha}{12}) = A + \\frac{2\\alpha}{3} \\implies A = 3\\alpha - \\frac{2\\alpha}{3} = \\frac{7\\alpha}{3}$。\n将 $A$ 和 $B$ 代入 (1)：$1+2\\alpha = 2(\\frac{7\\alpha}{3}) + 4(\\frac{\\alpha}{12}) = \\frac{14\\alpha}{3} + \\frac{\\alpha}{3} = \\frac{15\\alpha}{3} = 5\\alpha$。\n这得到 $1 = 3\\alpha$，所以 $\\alpha = \\frac{1}{3}$。\n然后，$A = \\frac{7}{3}(\\frac{1}{3}) = \\frac{7}{9}$ 且 $B = \\frac{1}{12}(\\frac{1}{3}) = \\frac{1}{36}$。\n系数为 $\\alpha = \\frac{1}{3}$，$A = \\frac{7}{9}$，$B = \\frac{1}{36}$。\n\n**显式中心格式：**\n该格式为 $u'_{i} = \\frac{1}{\\Delta x}\\left[ a\\left(u_{i+1}-u_{i-1}\\right) + b\\left(u_{i+2}-u_{i-2}\\right) + c\\left(u_{i+3}-u_{i-3}\\right) \\right]$。\n使用泰勒展开式 $u_{i\\pm j} - u_{i-j} = 2j\\Delta x u'_{i} + \\frac{2(j\\Delta x)^3}{6}u^{(3)}_{i} + \\frac{2(j\\Delta x)^5}{120}u^{(5)}_{i} + O((\\Delta x)^7)$，RHS 变为：\n$\\frac{1}{\\Delta x} \\left[ a(2\\Delta x u'_{i} + \\frac{(\\Delta x)^3}{3}u^{(3)}_{i} + \\dots) + b(4\\Delta x u'_{i} + \\frac{8(\\Delta x)^3}{3}u^{(3)}_{i} + \\dots) + c(6\\Delta x u'_{i} + \\frac{54(\\Delta x)^3}{6}u^{(3)}_{i} + \\dots) \\right]$\n$= (2a+4b+6c)u'_{i} + (\\frac{a}{3} + \\frac{8b}{3} + 9c)(\\Delta x)^2 u^{(3)}_{i} + (\\frac{a}{60} + \\frac{32b}{60} + \\frac{243c}{60})(\\Delta x)^4 u^{(5)}_{i} + O((\\Delta x)^6)$。\n为了达到六阶精度，我们需要 $u'_{i}$ 的系数为 $1$，而 $u^{(3)}_{i}$ 和 $u^{(5)}_{i}$ 的系数为 $0$。\n1. $u'_{i}$: $2a+4b+6c = 1$\n2. $u^{(3)}_{i}$: $\\frac{a}{3} + \\frac{8b}{3} + 9c = 0 \\implies a+8b+27c = 0$\n3. $u^{(5)}_{i}$: $\\frac{a}{60} + \\frac{32b}{60} + \\frac{243c}{60} = 0 \\implies a+32b+243c = 0$\n\n用 (3) 减去 (2)：$24b + 216c = 0 \\implies b = -9c$。\n代入 (2)：$a+8(-9c)+27c = 0 \\implies a-72c+27c = 0 \\implies a = 45c$。\n代入 (1)：$2(45c)+4(-9c)+6c = 1 \\implies 90c-36c+6c = 1 \\implies 60c=1$，所以 $c=\\frac{1}{60}$。\n然后，$a = 45(\\frac{1}{60}) = \\frac{3}{4}$ 且 $b = -9(\\frac{1}{60}) = -\\frac{3}{20}$。\n系数为 $a=\\frac{3}{4}$，$b=-\\frac{3}{20}$，$c=\\frac{1}{60}$。\n\n**第 2 部分：修正波数**\n\n对于平面波 $u_j = \\exp(\\mathrm{i} k x_j) = u_i \\exp(\\mathrm{i}(j-i)\\kappa)$，其数值导数为 $u'_j = \\mathrm{i} k^{\\star} u_j = \\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_j$。\n\n**紧致 Padé 格式：**\n将平面波及其数值导数代入格式中：\n$\\alpha \\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_{i-1} + \\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_i + \\alpha \\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_{i+1} = \\frac{1}{\\Delta x}[A(u_{i+1}-u_{i-1}) + B(u_{i+2}-u_{i-2})]$\n$\\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_i (\\alpha e^{-\\mathrm{i}\\kappa} + 1 + \\alpha e^{\\mathrm{i}\\kappa}) = \\frac{u_i}{\\Delta x}[A(e^{\\mathrm{i}\\kappa}-e^{-\\mathrm{i}\\kappa}) + B(e^{2\\mathrm{i}\\kappa}-e^{-2\\mathrm{i}\\kappa})]$\n$\\mathrm{i}\\kappa^{\\star} (1 + 2\\alpha\\cos\\kappa) = A(2\\mathrm{i}\\sin\\kappa) + B(2\\mathrm{i}\\sin(2\\kappa))$\n$\\kappa^{\\star}_{\\mathrm{compact}} = \\frac{2A\\sin\\kappa + 2B\\sin(2\\kappa)}{1+2\\alpha\\cos\\kappa}$\n代入系数 $\\alpha=1/3$，$A=7/9$，$B=1/36$：\n$\\kappa^{\\star}_{\\mathrm{compact}} = \\frac{2(\\frac{7}{9})\\sin\\kappa + 2(\\frac{1}{36})\\sin(2\\kappa)}{1+2(\\frac{1}{3})\\cos\\kappa} = \\frac{\\frac{14}{9}\\sin\\kappa + \\frac{1}{18}\\sin(2\\kappa)}{1+\\frac{2}{3}\\cos\\kappa}$\n使用 $\\sin(2\\kappa) = 2\\sin\\kappa\\cos\\kappa$：\n$\\kappa^{\\star}_{\\mathrm{compact}} = \\frac{\\sin\\kappa (\\frac{14}{9} + \\frac{1}{9}\\cos\\kappa)}{1+\\frac{2}{3}\\cos\\kappa} = \\frac{\\frac{\\sin\\kappa}{9}(14+\\cos\\kappa)}{\\frac{1}{3}(3+2\\cos\\kappa)} = \\frac{\\sin\\kappa(14+\\cos\\kappa)}{3(3+2\\cos\\kappa)} = \\frac{\\sin\\kappa(14+\\cos\\kappa)}{9+6\\cos\\kappa}$\n\n**显式中心格式：**\n将平面波代入格式中：\n$\\frac{\\mathrm{i}\\kappa^{\\star}}{\\Delta x} u_i = \\frac{1}{\\Delta x}[ a(u_{i+1}-u_{i-1}) + b(u_{i+2}-u_{i-2}) + c(u_{i+3}-u_{i-3}) ]$\n$\\mathrm{i}\\kappa^{\\star} u_i = u_i [a(e^{\\mathrm{i}\\kappa}-e^{-\\mathrm{i}\\kappa}) + b(e^{2\\mathrm{i}\\kappa}-e^{-2\\mathrm{i}\\kappa}) + c(e^{3\\mathrm{i}\\kappa}-e^{-3\\mathrm{i}\\kappa})]$\n$\\mathrm{i}\\kappa^{\\star} = a(2\\mathrm{i}\\sin\\kappa) + b(2\\mathrm{i}\\sin(2\\kappa)) + c(2\\mathrm{i}\\sin(3\\kappa))$\n$\\kappa^{\\star}_{\\mathrm{explicit}} = 2a\\sin\\kappa + 2b\\sin(2\\kappa) + 2c\\sin(3\\kappa)$\n代入系数 $a=3/4$，$b=-3/20$，$c=1/60$：\n$\\kappa^{\\star}_{\\mathrm{explicit}} = 2(\\frac{3}{4})\\sin\\kappa + 2(-\\frac{3}{20})\\sin(2\\kappa) + 2(\\frac{1}{60})\\sin(3\\kappa)$\n$\\kappa^{\\star}_{\\mathrm{explicit}} = \\frac{3}{2}\\sin\\kappa - \\frac{3}{10}\\sin(2\\kappa) + \\frac{1}{30}\\sin(3\\kappa)$\n\n**第 3 部分：在 $\\kappa = \\pi/2$ 时的色散误差之比**\n\n给定 $\\kappa=\\pi/2$。\n我们有 $\\sin(\\pi/2)=1$，$\\cos(\\pi/2)=0$。\n$\\sin(2 \\cdot \\pi/2) = \\sin(\\pi) = 0$。\n$\\sin(3 \\cdot \\pi/2) = -1$。\n\n对于紧致格式：\n$\\kappa^{\\star}_{\\mathrm{compact}} = \\frac{\\sin(\\pi/2)(14+\\cos(\\pi/2))}{9+6\\cos(\\pi/2)} = \\frac{1(14+0)}{9+0} = \\frac{14}{9}$。\n绝对色散误差为 $|\\kappa^{\\star}_{\\mathrm{compact}} - \\kappa| = |\\frac{14}{9} - \\frac{\\pi}{2}|$。\n\n对于显式格式：\n$\\kappa^{\\star}_{\\mathrm{explicit}} = \\frac{3}{2}\\sin(\\frac{\\pi}{2}) - \\frac{3}{10}\\sin(\\pi) + \\frac{1}{30}\\sin(\\frac{3\\pi}{2})$\n$= \\frac{3}{2}(1) - \\frac{3}{10}(0) + \\frac{1}{30}(-1) = \\frac{3}{2} - \\frac{1}{30} = \\frac{45-1}{30} = \\frac{44}{30} = \\frac{22}{15}$。\n绝对色散误差为 $|\\kappa^{\\star}_{\\mathrm{explicit}} - \\kappa| = |\\frac{22}{15} - \\frac{\\pi}{2}|$。\n\n现在我们计算比率 $R$：\n$R = \\frac{|\\frac{14}{9} - \\frac{\\pi}{2}|}{|\\frac{22}{15} - \\frac{\\pi}{2}|}$\n数值上，$\\pi/2 \\approx 1.5708$，$14/9 \\approx 1.5556$，以及 $22/15 \\approx 1.4667$。\n由于 $\\frac{\\pi}{2} > \\frac{14}{9}$ 并且 $\\frac{\\pi}{2} > \\frac{22}{15}$，绝对值可以去掉：\n$R = \\frac{\\frac{\\pi}{2} - \\frac{14}{9}}{\\frac{\\pi}{2} - \\frac{22}{15}} = \\frac{\\frac{9\\pi-28}{18}}{\\frac{15\\pi-44}{30}} = \\frac{9\\pi-28}{18} \\cdot \\frac{30}{15\\pi-44} = \\frac{5(9\\pi-28)}{3(15\\pi-44)} = \\frac{45\\pi-140}{45\\pi-132}$。\n使用 $\\pi \\approx 3.14159265$：\n$45\\pi \\approx 141.37166925$\n$R \\approx \\frac{141.37166925 - 140}{141.37166925 - 132} = \\frac{1.37166925}{9.37166925} \\approx 0.146363$\n四舍五入到四位有效数字，我们得到 $0.1464$。",
            "answer": "$$\\boxed{0.1464}$$"
        },
        {
            "introduction": "在修正波数概念的基础上，这项练习将采用计算方法来量化色散（相位）和耗散（幅值）误差。您将编写一个程序，分析多种格式在单个波周期内的表现，从而对它们的有效性进行清晰的量化比较。这项练习将  中建立的理论分析与具体的性能指标联系起来。",
            "id": "3973744",
            "problem": "考虑从关于一个具有恒定密度 $\\rho_0$ 和声速 $c$ 的静止均匀基态的线性化欧拉方程导出的一维线性声学。声压脉动 $p'(x,t)$ 和声速脉动 $u'(x,t)$ 的控制方程为\n$$\n\\frac{\\partial p'}{\\partial t} + \\rho_0 c^2 \\frac{\\partial u'}{\\partial x} = 0, \\qquad \\frac{\\partial u'}{\\partial t} + \\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial x} = 0.\n$$\n该系统存在波数为 $k$、角频率为 $\\omega = c k$ 的右行平面波解，使得在一个声学周期 $T = \\frac{2\\pi}{\\omega}$ 后，精确解再现其初始状态，即振幅为单位1，净相移模 $2\\pi$ 为零。\n\n您将分析几种中心有限差分空间离散化方法与经典四阶 Runge–Kutta 时间积分器相结合时的半离散和全离散色散与耗散。使用黎曼不变量形式来关注单个右行模态，该模态对于某个标量场 $\\phi(x,t)$ 遵循一个标量平流方程 $\\frac{\\partial \\phi}{\\partial t} + c \\frac{\\partial \\phi}{\\partial x} = 0$。对于平面波 $\\phi(x,t) = \\hat{\\phi}(t) e^{i k x}$，作用于无量纲波数为 $\\theta = k \\,\\Delta x$ 的模态上的 $\\frac{\\partial}{\\partial x}$ 的一个线性、移不变的有限差分近似具有傅里叶符号\n$i k_{\\text{eff}} = \\frac{i}{\\Delta x} \\,\\kappa_{\\text{eff}}(\\theta)$, 其中 $\\kappa_{\\text{eff}}(\\theta) = 2 \\sum_{m=1}^{M} a_m \\sin(m \\theta)$，\n其中模板是显式的、中心的和反对称的：\n$$\n\\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{j} \\approx \\frac{1}{\\Delta x} \\sum_{m=1}^{M} a_m \\left(\\phi_{j+m} - \\phi_{j-m}\\right).\n$$\n将此与经典的显式四阶 Runge–Kutta 时间积分器相结合，其对于线性检验方程 $y' = \\lambda y$ 的单步稳定性多项式为\n$$\nR(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24},\n$$\n其中 $z = \\lambda \\,\\Delta t$。对于右行声学模态，半离散特征值为 $\\lambda = -i c k_{\\text{eff}} = - i \\frac{c}{\\Delta x} \\kappa_{\\text{eff}}(\\theta)$。定义库朗数 $\\nu = \\frac{c \\,\\Delta t}{\\Delta x}$，因此数值格式的单步放大因子为\n$$\nG_{\\text{step}}(\\theta,\\nu) = R\\!\\left(-i \\,\\nu \\,\\kappa_{\\text{eff}}(\\theta)\\right).\n$$\n对于单个周期 $T = \\frac{2\\pi}{c k}$，选择时间步长，使得整数步数 $N$ 恰好覆盖一个周期。对于每波长点数 $\\mathrm{PPW} = \\frac{2\\pi}{\\theta}$，我们有 $N = \\frac{T}{\\Delta t} = \\frac{2\\pi}{\\nu \\theta} = \\frac{\\mathrm{PPW}}{\\nu}$，该值必须为整数。在一个周期内，总放大为\n$$\nG_{\\text{period}}(\\theta,\\nu) = \\left[G_{\\text{step}}(\\theta,\\nu)\\right]^N.\n$$\n一个周期后，精确解具有单位增益和零净相位。将振幅误差定义为增益幅值与1的绝对偏差，\n$$\nE_{\\text{amp}} = \\left|\\,|G_{\\text{period}}| - 1\\,\\right|,\n$$\n并将相位误差定义为 $G_{\\text{period}}$ 的主辐角（限制在 $(-\\pi,\\pi]$ 区间内），以弧度为单位，\n$$\nE_{\\text{phase}} = \\operatorname{Arg}\\!\\left(G_{\\text{period}}\\right).\n$$\n\n实现一个程序，对于每个指定的空间格式和每波长点数值，使用上述全离散分析方法，计算在周期性域上传播整整一个周期的右行平面波的 $E_{\\text{amp}}$ 和 $E_{\\text{phase}}$。使用以下显式中心模板，每个模板都以带有系数 $a_m$ 的反对称 $2M+1$ 点形式写出：\n\n- 二阶中心差分 (CD2, $M = 1$): $a_1 = \\frac{1}{2}$。\n- 四阶中心差分 (CD4, $M = 2$): $a_1 = \\frac{2}{3}, \\; a_2 = -\\frac{1}{12}$。\n- 六阶中心差分 (CD6, $M = 3$): $a_1 = \\frac{3}{4}, \\; a_2 = -\\frac{3}{20}, \\; a_3 = \\frac{1}{60}$。\n- 七点色散关系保持格式 (DRP7, $M = 3$): $a_1 = 0.770882380518225,\\; a_2 = -0.166705904414580,\\; a_3 = 0.0208431427703119$。\n\n不失一般性地，采用无量纲公式，设 $c = 1$ 和 $\\rho_0 = 1$。使用库朗数 $\\nu = 0.5$，因此每个周期的步数为 $N = \\frac{\\mathrm{PPW}}{0.5}$。角度必须以弧度为单位。除了声明相位误差必须以弧度为单位外，输出不需要任何物理单位。\n\n测试套件规范：\n- 测试的格式，严格按此顺序：CD2, CD4, CD6, DRP7。\n- 测试的每波长点数值，严格按此顺序：$6$, $10$, $20$, $40$。\n- 对于每一对格式和每波长点数值，在 $\\nu = 0.5$ 的条件下，计算传播整整一个周期后的 $E_{\\text{amp}}$ 和 $E_{\\text{phase}}$（如上定义）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个结果列表，每个结果是针对一个测试用例的双元素列表 $[E_{\\text{amp}}, E_{\\text{phase}}]$。排序必须按照上面指定的格式顺序，然后是每波长点数顺序的字典序。整个输出必须是这些双元素列表的单个列表，写成由方括号括起来的逗号分隔列表。例如，具有三个用例的输出将类似于 $[[e_{1,a},e_{1,p}],[e_{2,a},e_{2,p}],[e_{3,a},e_{3,p}]]$，其中每个 $e$ 都是一个浮点数。将 $E_{\\text{phase}}$ 表示为弧度，将 $E_{\\text{amp}}$ 表示为无量纲量。不要对任何量进行四舍五入；打印您的实现所产生的全精度浮点值。",
            "solution": "### 问题验证\n\n#### 步骤 1：提取给定信息\n\n问题提供了以下数据、定义和约束：\n\n-   **控制方程**：一维线性化欧拉方程，用于描述声压脉动$p'(x,t)$和速度脉动$u'(x,t)$：\n    $$\n    \\frac{\\partial p'}{\\partial t} + \\rho_0 c^2 \\frac{\\partial u'}{\\partial x} = 0, \\qquad \\frac{\\partial u'}{\\partial t} + \\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial x} = 0.\n    $$\n-   **基态**：基态是静止且均匀的，具有恒定的密度$\\rho_0$和声速$c$。\n-   **简化模型**：系统被简化为描述右行模态的标量平流方程：\n    $$\n    \\frac{\\partial \\phi}{\\partial t} + c \\frac{\\partial \\phi}{\\partial x} = 0.\n    $$\n-   **波解**：考虑形式为$\\phi(x,t) = \\hat{\\phi}(t) e^{i k x}$的平面波解。\n-   **空间离散化**：空间导数使用中心、反对称的有限差分格式：\n    $$\n    \\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{j} \\approx \\frac{1}{\\Delta x} \\sum_{m=1}^{M} a_m \\left(\\phi_{j+m} - \\phi_{j-m}\\right).\n    $$\n-   **有效波数**：空间导数算子的傅里叶符号由$i k_{\\text{eff}} = \\frac{i}{\\Delta x} \\,\\kappa_{\\text{eff}}(\\theta)$给出，其中$\\theta = k \\,\\Delta x$是无量纲波数，且\n    $$\n    \\kappa_{\\text{eff}}(\\theta) = 2 \\sum_{m=1}^{M} a_m \\sin(m \\theta).\n    $$\n-   **空间格式和系数 ($a_m$)**：\n    -   CD2 ($M=1$): $a_1 = \\frac{1}{2}$。\n    -   CD4 ($M=2$): $a_1 = \\frac{2}{3}, \\; a_2 = -\\frac{1}{12}$。\n    -   CD6 ($M=3$): $a_1 = \\frac{3}{4}, \\; a_2 = -\\frac{3}{20}, \\; a_3 = \\frac{1}{60}$。\n    -   DRP7 ($M=3$): $a_1 = 0.770882380518225, \\; a_2 = -0.166705904414580, \\; a_3 = 0.0208431427703119$。\n-   **时间积分**：使用经典的四阶 Runge–Kutta (RK4) 方法。\n-   **RK4 稳定性多项式**：对于$y' = \\lambda y$，单步稳定性多项式为：\n    $$\n    R(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}, \\quad \\text{其中 } z = \\lambda \\,\\Delta t.\n    $$\n-   **半离散特征值**：对于右行模态，$\\lambda = -i c k_{\\text{eff}} = - i \\frac{c}{\\Delta x} \\kappa_{\\text{eff}}(\\theta)$。\n-   **库朗数**：$\\nu = \\frac{c \\,\\Delta t}{\\Delta x}$。问题指定使用$\\nu = 0.5$。\n-   **单步放大因子**：$G_{\\text{step}}(\\theta,\\nu) = R\\!\\left(-i \\,\\nu \\,\\kappa_{\\text{eff}}(\\theta)\\right)$。\n-   **传播周期和时间步**：模拟运行一个声学周期$T = \\frac{2\\pi}{\\omega} = \\frac{2\\pi}{c k}$。每个周期的步数$N = \\frac{T}{\\Delta t}$，必须为整数。给定每波长点数$\\mathrm{PPW} = \\frac{2\\pi}{\\theta}$，可得$N = \\frac{\\mathrm{PPW}}{\\nu}$。\n-   **总放大因子**：在一个周期内，$G_{\\text{period}}(\\theta,\\nu) = \\left[G_{\\text{step}}(\\theta,\\nu)\\right]^N$。\n-   **误差度量**：\n    -   振幅误差：$E_{\\text{amp}} = \\left|\\,|G_{\\text{period}}| - 1\\,\\right|$。\n    -   相位误差：$E_{\\text{phase}} = \\operatorname{Arg}\\!\\left(G_{\\text{period}}\\right)$，其中$\\operatorname{Arg}$是$(-\\pi, \\pi]$内的辐角主值。\n-   **无量纲化**：设置$c = 1$和$\\rho_0 = 1$。\n-   **测试用例**：\n    -   格式：CD2, CD4, CD6, DRP7（按此顺序）。\n    -   每波长点数(PPW)：$6, 10, 20, 40$（按此顺序）。\n\n#### 步骤 2：使用提取的给定信息进行验证\n\n问题需满足以下验证标准：\n1.  **科学依据**：问题牢固地植根于计算航空声学领域，这是计算流体动力学的一个子学科。它采用了标准模型（线性化欧拉方程）、数值方法（有限差分、RK4）和分析技术（冯·诺依曼稳定性分析、色散-耗散分析）。库朗数、每波长点数、放大因子和数值误差等概念是波传播数值格式分析的基础。该问题在科学上是合理的。\n2.  **适定性**：问题要求基于一组清晰、确定性和完整的公式和参数计算两个明确定义的量$E_{\\text{amp}}$和$E_{\\text{phase}}$。对于每个指定的测试用例（格式和PPW值的组合），计算都会得到唯一的数值结果。$N = \\frac{\\mathrm{PPW}}{\\nu}$必须是整数的条件是满足的，因为$\\nu = 0.5$并且所有指定的PPW值都是偶数整数（或者任何整数，因为$2 \\times \\text{整数}$是整数）。\n3.  **客观性**：问题使用精确、无歧义的数学语言陈述。所有量的定义都是形式化和客观的。没有主观或基于意见的元素。\n4.  **完整且一致**：所有必要的信息都已提供。控制方程、数值格式定义、常数和误差度量都已明确说明。所提供的信息中没有明显的矛盾。\n5.  **非平凡或伪深刻**：该问题需要对复数算术进行非平凡的实现，并理解偏微分方程数值分析的原理。虽然这是该领域学生的标准练习，但它并非微不足道，并且测试了分析数值格式的核心能力。\n\n问题是自洽的、科学上有效的和适定的。\n\n#### 步骤 3：结论和行动\n\n问题是**有效的**。将提供一个解决方案。\n\n### 基于原理的设计\n\n任务是为几种有限差分格式与四阶 Runge-Kutta 时间积分器相结合的情况执行数值色散和耗散分析。分析集中于单个右行声波，该声波由标量平流方程 $\\frac{\\partial \\phi}{\\partial t} + c \\frac{\\partial \\phi}{\\partial x} = 0$ 控制。一个周期 $T$ 后的精确解就是其初始状态本身，意味着放大因子为 $1$（增益为 $1$，相移模 $2\\pi$ 为 $0$）。数值方法会引入误差，导致数值解的振幅偏离 $1$（耗散/放大误差），其相位发生偏移（色散误差）。我们将量化这些误差。\n\n每个测试用例（特定的格式和每波长点数，$\\mathrm{PPW}$）的过程如下：\n\n1.  **确定无量纲波数 $\\theta$**：每波长点数 $\\mathrm{PPW}$ 表示用于解析一个完整波长 $\\lambda_{wave} = 2\\pi/k$ 的网格点数。无量纲波数 $\\theta$ 是物理波数 $k$ 按网格间距 $\\Delta x$ 进行缩放，即 $\\theta = k \\Delta x$。它们之间的关系是 $\\mathrm{PPW} = \\frac{\\lambda_{wave}}{\\Delta x} = \\frac{2\\pi/k}{\\Delta x} = \\frac{2\\pi}{k \\Delta x} = \\frac{2\\pi}{\\theta}$。因此，对于给定的 $\\mathrm{PPW}$，我们计算 $\\theta = \\frac{2\\pi}{\\mathrm{PPW}}$。\n\n2.  **计算修正波数函数 $\\kappa_{\\text{eff}}(\\theta)$**：空间有限差分算子不能完美地表示真实导数 $\\frac{\\partial}{\\partial x}$。在傅里叶空间中，它对模态 $e^{ikx}$ 的作用是乘以 $i k_{\\text{eff}}$ 而不是 $i k$。函数 $\\kappa_{\\text{eff}}(\\theta) = k_{\\text{eff}} \\Delta x$ 表征了这种差异。它使用所选格式的给定公式和系数 $\\{a_m\\}$ 进行计算：\n    $$\n    \\kappa_{\\text{eff}}(\\theta) = 2 \\sum_{m=1}^{M} a_m \\sin(m \\theta)\n    $$\n    完美的微分将对应于 $\\kappa_{\\text{eff}}(\\theta) = \\theta$。任何偏差都会导致色散误差。\n\n3.  **确定 RK4 稳定性多项式的自变量**：单个傅里叶模态 $\\hat{\\phi}(t)e^{ikx}$ 的半离散方程是一个常微分方程：$\\frac{d\\hat{\\phi}}{dt} = -i c k_{\\text{eff}} \\hat{\\phi}$。这是 $y' = \\lambda y$ 的形式，其中 $\\lambda = -i c k_{\\text{eff}}$。RK4 稳定性多项式 $R(z)$ 的自变量是 $z = \\lambda \\Delta t$。使用库朗数 $\\nu = \\frac{c \\Delta t}{\\Delta x}$ 和 $\\kappa_{\\text{eff}}(\\theta) = k_{\\text{eff}} \\Delta x$ 的定义，我们可以将 $z$ 写为：\n    $$\n    z = \\left(-i c \\frac{\\kappa_{\\text{eff}}(\\theta)}{\\Delta x}\\right) \\Delta t = -i \\left(\\frac{c \\Delta t}{\\Delta x}\\right) \\kappa_{\\text{eff}}(\\theta) = -i \\nu \\kappa_{\\text{eff}}(\\theta)\n    $$\n    给定 $\\nu = 0.5$，我们有 $z = -i \\cdot 0.5 \\cdot \\kappa_{\\text{eff}}(\\theta)$。\n\n4.  **计算单步放大因子 $G_{\\text{step}}$**：将 RK4 时间步进格式应用于 ODE $y'=\\lambda y$ 一个时间步长 $\\Delta t$，会将解乘以一个因子 $G_{\\text{step}} = R(\\lambda \\Delta t) = R(z)$。我们计算该复数多项式：\n    $$\n    G_{\\text{step}} = R(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}\n    $$\n\n5.  **计算总放大因子 $G_{\\text{period}}$**：模拟运行一个完整的声学周期。所需的步数 $N$ 为 $N = \\frac{T}{\\Delta t}$。使用 $T = \\frac{2\\pi}{ck}$，$\\nu = \\frac{c \\Delta t}{\\Delta x}$ 和 $\\theta = k \\Delta x$，我们发现：\n    $$\n    N = \\frac{2\\pi / (ck)}{\\Delta t} = \\frac{2\\pi}{k (c \\Delta t)} = \\frac{2\\pi}{k \\Delta x (\\frac{c \\Delta t}{\\Delta x})} = \\frac{2\\pi}{\\theta \\nu} = \\frac{\\mathrm{PPW}}{\\nu}\n    $$\n    当 $\\nu=0.5$ 时，这简化为 $N = 2 \\cdot \\mathrm{PPW}$。$N$ 步后的总放大是单步因子的 $N$ 次方：\n    $$\n    G_{\\text{period}} = (G_{\\text{step}})^N\n    $$\n    这个复数幂运算使用 $G_{\\text{step}}$ 的极坐标形式进行。如果 $G_{\\text{step}} = |G_{\\text{step}}|e^{i \\operatorname{Arg}(G_{\\text{step}})}$，则 $G_{\\text{period}} = |G_{\\text{step}}|^N e^{i N \\operatorname{Arg}(G_{\\text{step}})}$。\n\n6.  **计算振幅和相位误差**：\n    -   模 $|G_{\\text{period}}|$ 代表一个周期后波的数值振幅。精确解的振幅为 $1$。振幅误差是绝对差：$E_{\\text{amp}} = \\big| |G_{\\text{period}}| - 1 \\big|$。\n    -   辐角 $\\operatorname{Arg}(G_{\\text{period}})$ 代表一个周期内的总数值相移。精确解的净相移为 $0$（模 $2\\pi$）。因此，相位误差就是总放大因子的主辐角：$E_{\\text{phase}} = \\operatorname{Arg}(G_{\\text{period}})$，其计算范围在 $(-\\pi, \\pi]$ 内。负的相位误差表示数值波滞后于精确波（相位滞后），而正的误差表示它超前（相位超前）。\n\n对空间格式（CD2, CD4, CD6, DRP7）和每波长点数（$\\mathrm{PPW} \\in \\{6, 10, 20, 40\\}$）的每种组合重复此整个过程，为每种情况生成一对误差值 $[E_{\\text{amp}}, E_{\\text{phase}}]$。最终输出是这些对的有序列表。\n#### 代码实现\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes amplitude and phase errors for various finite-difference schemes\n    discretizing the 1D linear advection equation.\n    \"\"\"\n    # Define schemes with their antisymmetric coefficients {a_m} for m=1, 2, ...\n    schemes = {\n        \"CD2\": [0.5],\n        \"CD4\": [2.0/3.0, -1.0/12.0],\n        \"CD6\": [3.0/4.0, -3.0/20.0, 1.0/60.0],\n        \"DRP7\": [0.770882380518225, -0.166705904414580, 0.0208431427703119],\n    }\n    \n    # Define test parameters\n    scheme_order = [\"CD2\", \"CD4\", \"CD6\", \"DRP7\"]\n    ppw_values = [6, 10, 20, 40]\n    nu = 0.5  # Courant number c*dt/dx\n\n    results = []\n\n    def rk4_poly(z):\n        \"\"\"Computes the RK4 stability polynomial R(z).\"\"\"\n        return 1 + z + (z**2)/2.0 + (z**3)/6.0 + (z**4)/24.0\n\n    def kappa_eff(theta, coeffs):\n        \"\"\"Computes the effective wavenumber function kappa_eff(theta).\"\"\"\n        val = 0.0\n        for m, a_m in enumerate(coeffs, 1):\n            val += a_m * np.sin(m * theta)\n        return 2.0 * val\n\n    # Iterate through specified schemes and PPW values in order\n    for scheme_name in scheme_order:\n        coeffs = schemes[scheme_name]\n        for ppw in ppw_values:\n            # 1. Calculate nondimensional wavenumber theta\n            theta = 2.0 * np.pi / ppw\n            \n            # 2. Calculate effective wavenumber function kappa_eff\n            kappa_val = kappa_eff(theta, coeffs)\n            \n            # 3. Determine the argument for the RK4 stability polynomial\n            # z = -i * nu * kappa_eff(theta)\n            z = -1j * nu * kappa_val\n            \n            # 4. Compute the one-step amplification factor G_step\n            G_step = rk4_poly(z)\n            \n            # 5. Compute the number of steps per period N\n            # N must be an integer, which is guaranteed here since ppw is int and nu=0.5.\n            N = int(ppw / nu)\n            \n            # 6. Compute the total amplification factor over one period G_period\n            G_period = G_step ** N\n            \n            # 7. Calculate amplitude error\n            # E_amp = | |G_period| - 1 |\n            E_amp = np.abs(np.abs(G_period) - 1.0)\n            \n            # 8. Calculate phase error\n            # E_phase = Arg(G_period)\n            E_phase = np.angle(G_period)\n            \n            results.append([E_amp, E_phase])\n\n    # Format the final output string as specified\n    output_str = f\"[{','.join([f'[{amp},{phase}]' for amp, phase in results])}]\"\n    return output_str\n\n# The problem asks for the output of the script, not the script itself.\n# print(solve())\n```",
            "answer": "[[0.002821217631379373,-0.7410885558989508],[0.00010991515234983353,-0.12995388099684102],[6.848037416327375e-07,-0.007936665768843934],[4.275529452441052e-09,-0.0004953335965611149],[0.00016147427210212045,-0.20577977695325068],[2.449742661848529e-07,-0.010530777322989262],[3.791538356262453e-10,-0.0003264639908866103],[5.922383827170119e-13,-0.000020359781844627447],[1.906377771746973e-05,-0.03056094692790757],[1.405786377651034e-08,-0.0011409249764516136],[1.077270425983424e-11,-0.00003554167198642289],[1.678129598284583e-14,-0.000002220199419101037],[4.168545809800645e-07,-0.0019253724219463923],[2.253036814647341e-10,-0.0000570341773099951],[8.630040510563413e-14,-0.000001777095941199321],[2.122345019013589e-17,-1.1102230246251565e-07]]"
        },
        {
            "introduction": "最后的这项练习将所有概念融合成一个实际的仿真项目。您将使用一个高阶的色散关系保持（DRP）格式和经典的四阶龙格－库塔（RK4）方法，构建一个简单的一维气动声学求解器，以观察波的长期演化过程。通过这个练习，您将巩固对如何实现数值方法以及如何在真实仿真场景中分析数值误差累积效应的理解。",
            "id": "3973747",
            "problem": "您的任务是为从线性化欧拉方程导出的一维声学问题实现一种色散关系保持 (DRP) 空间离散化方法，并量化单色行波的数值色散（相位误差）和数值耗散（幅值误差）。其基本基础是关于均匀静止状态小扰动的线性化欧拉方程，在一维空间中简化为以下耦合系统：\n$$\n\\frac{\\partial p'}{\\partial t} + \\rho_0 c_0^2 \\frac{\\partial u'}{\\partial x} = 0, \\qquad \\frac{\\partial u'}{\\partial t} + \\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial x} = 0,\n$$\n其中 $p'$ 是声压脉动，$u'$ 是声速脉动，$\\rho_0$ 是平均密度，$c_0$ 是声速。在谐和平面波假设 $p'(x,t) = \\mathrm{Re}\\{ \\hat{p} e^{i(k x - \\omega t)} \\}$ 和 $u'(x,t) = \\mathrm{Re}\\{ \\hat{u} e^{i(k x - \\omega t)} \\}$ 下，精确色散关系满足 $\\omega = c_0 k$，对于右行波，关系为 $u' = p'/(\\rho_0 c_0)$。\n\n您的程序必须：\n- 将长度为 $L = \\lambda$（一个波长）的空间域用每波长 $M$ 个点进行离散化，其中 $\\lambda$ 是物理波长。使用周期性边界条件。\n- 使用对称的 $7$ 点模板实现一个 DRP 中心有限差分算子，用于一阶导数 $\\partial / \\partial x$，其系数 $\\{w_1,w_2,w_3\\}$ 应用于偏移量 $\\{\\pm 1, \\pm 2, \\pm 3\\}$，使得网格索引 $i$ 处的离散导数为\n$$\n\\left.\\frac{\\partial f}{\\partial x}\\right|_i \\approx \\frac{1}{\\Delta x}\\left( w_1 \\left(f_{i+1} - f_{i-1}\\right) + w_2 \\left(f_{i+2} - f_{i-2}\\right) + w_3 \\left(f_{i+3} - f_{i-3}\\right) \\right),\n$$\n其中 $\\Delta x = \\lambda/M$。所选权重必须从第一性原理出发进行设计，以匹配精确导数的低波数行为并减少数值色散，同时通过模板的反对称性确保零人工耗散。\n- 使用适用于线性双曲系统的显式格式对耦合系统进行时间积分。使用均匀的时间步长 $\\Delta t$，其选择需满足指定的 Courant-Friedrichs-Lewy (CFL) 界限 $\\sigma = c_0 \\Delta t/\\Delta x \\leq \\sigma_{\\max}$ 以确保稳定性。总模拟时间必须为 $T = N P$，其中 $P$ 是平面波的时间周期，$N$ 是周期数。对于波长为 $\\lambda$ 的平面波，时间周期为 $P = \\lambda/c_0$，因此 $T = N \\lambda / c_0$。\n- 初始化一个与控制方程一致的右行单色波：$p'(x,0) = \\cos(k x)$ 和 $u'(x,0) = p'(x,0)/(\\rho_0 c_0)$，其中 $k = 2\\pi/\\lambda$。\n- 在积分到时间 $T$ 后，通过在周期性网格上将 $p'(x,T)$ 投影到 $\\cos(kx)$ 和 $\\sin(kx)$ 上（通过离散内积），计算压力场的数值振幅 $A$ 和相位 $\\phi$。具体来说，计算\n$$\na_c = \\frac{2}{M} \\sum_{j=0}^{M-1} p'(x_j, T)\\cos(k x_j), \\qquad a_s = \\frac{2}{M} \\sum_{j=0}^{M-1} p'(x_j, T)\\sin(k x_j),\n$$\n其中 $x_j = j \\Delta x$，然后计算\n$$\nA = \\sqrt{a_c^2 + a_s^2}, \\qquad \\phi = \\mathrm{atan2}(-a_s, a_c).\n$$\n- 将幅值误差报告为浮点数 $A - 1$（无量纲），将相位误差报告为浮点数 $\\phi$（以弧度为单位）。角度必须以弧度表示。参数必须使用物理单位：$\\lambda$ 以米为单位， $c_0$ 以米/秒为单位，$\\rho_0$ 以千克/立方米为单位，$t$ 以秒为单位。\n\n科学真实性要求：\n- DRP 模板必须通过强制精确导数符号的低波数匹配、通过权重的矩条件消除主阶色散误差来推导，同时保持中心对称性以避免人工耗散。\n- 时间积分器必须与方程的双曲性质一致，并且必须通过选择 $\\Delta t$ 使得 $c_0 \\Delta t/\\Delta x \\leq \\sigma_{\\max}$ 来强制执行稳定性界限。\n\n测试套件：\n使用以下参数集。对于所有情况，使用 $\\rho_0 = 1.225$ 千克/立方米，$c_0 = 343$ 米/秒，以及 $\\lambda = 1$ 米。需要强制执行的 CFL 界限是 $\\sigma_{\\max} = 0.5$。\n- 情况 1 (正常路径)：每波长 $M = 16$ 个点，持续 $N = 5$ 个周期。\n- 情况 2 (边界情况：最小分辨率)：每波长 $M = 8$ 个点，持续 $N = 1$ 个周期。\n- 情况 3 (边界情况：无演化)：每波长 $M = 16$ 个点，持续 $N = 0$ 个周期。\n- 情况 4 (更高分辨率，中等时长)：每波长 $M = 32$ 个点，持续 $N = 10$ 个周期。\n- 情况 5 (高分辨率，长时长)：每波长 $M = 64$ 个点，持续 $N = 20$ 个周期。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表被方括号包围。每个测试用例的结果以方括号括起来的两个浮点数列表的形式给出，格式为 $[A-1,\\phi]$，其中 $\\phi$ 使用弧度。例如：“[[amp_error1,phase_error1],[amp_error2,phase_error2],...]”。",
            "solution": "用户提供的问题被评估为 **有效**。这是一个在计算航空声学领域中适定且有科学依据的问题，要求实现和分析一种用于线性化欧拉方程的数值格式。该问题是自洽的，所有必要的参数和评估指标都已明确定义。\n\n解决方案分几个阶段进行：设计空间离散算子、选择时间积分格式、实现模拟循环以及进行后处理以量化数值误差。\n\n**1. 空间离散化：色散关系保持 (DRP) 格式**\n\n问题要求使用一个对称的 $7$ 点有限差分模板来近似空间导数 $\\partial/\\partial x$。\n$$\n\\left.\\frac{\\partial f}{\\partial x}\\right|_i \\approx \\frac{1}{\\Delta x}\\left( w_1 (f_{i+1} - f_{i-1}) + w_2 (f_{i+2} - f_{i-2}) + w_3 (f_{i+3} - f_{i-3}) \\right)\n$$\n权重 $\\{w_1, w_2, w_3\\}$ 的设计旨在最小化数值色散误差。对于中低波数，实现此目标的一种标准且有效的方法是构造一个高阶精度格式。我们通过将离散算子的 Taylor 级数展开与精确导数的展开相匹配，来推导六阶精度格式的权重。\n\n将模板应用于网格点 $x_i$ 上的函数 $f(x)$ 的 Taylor 级数展开为：\n$$\n\\delta_x f_i = \\left( 2\\sum_{m=1}^3 m w_m \\right) f'_i + \\frac{(\\Delta x)^2}{3} \\left( \\sum_{m=1}^3 m^3 w_m \\right) f'''_i + \\frac{(\\Delta x)^4}{60} \\left( \\sum_{m=1}^3 m^5 w_m \\right) f^{(5)}_i + O((\\Delta x)^6)\n$$\n为使该算子达到六阶精度 ($\\delta_x f_i = f'_i + O((\\Delta x)^6)$)，我们必须对权重强制执行以下条件：\n1. $f'_i$ 的系数必须为 $1$：$2(w_1 + 2w_2 + 3w_3) = 1$。\n2. $f'''_i$ 的系数必须为 $0$：$w_1 + 8w_2 + 27w_3 = 0$。\n3. $f^{(5)}_i$ 的系数必须为 $0$：$w_1 + 32w_2 + 243w_3 = 0$。\n\n解这个包含三个未知权重的三元线性方程组，得到唯一解：\n$$\nw_1 = \\frac{3}{4}, \\qquad w_2 = -\\frac{3}{20}, \\qquad w_3 = \\frac{1}{60}\n$$\n该格式是导数的高保真近似。因为模板是反对称的（对称权重应用于反对称的网格点模式），所以离散导数算子的特征值是纯虚数。对于像给定问题这样的双曲系统，这确保了半离散化不会引入人工耗散，从而保持波幅。唯一的误差将出现在波的相位（色散）中。\n\n**2. 时间离散化：四阶 Runge-Kutta (RK4) 格式**\n\n半离散化方程组可以写成常微分方程组 (ODEs) 的形式，$\\frac{d\\mathbf{q}}{dt} = \\mathbf{F}(\\mathbf{q})$，其中 $\\mathbf{q}$ 是全局状态向量（所有网格点上的 $p'$ 和 $u'$），而 $\\mathbf{F}$ 代表空间导数算子的应用。\n\n为对此系统进行时间积分，我们选择经典的四阶 Runge-Kutta (RK4) 格式。选择这种显式格式是因为其高阶精度（与六阶空间模板一致）、对波动问题良好的稳定特性以及其固有的低数值耗散。对于从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的单个时间步，RK4 更新如下：\n$$\n\\begin{align*}\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{F}(\\mathbf{q}_n) \\\\\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{F}(\\mathbf{q}_n + \\frac{1}{2}\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{F}(\\mathbf{q}_n + \\frac{1}{2}\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{F}(\\mathbf{q}_n + \\mathbf{k}_3) \\\\\n\\mathbf{q}_{n+1} = \\mathbf{q}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n\\end{align*}\n$$\n\n**3. 稳定性和模拟参数**\n\n这种显式数值格式的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件控制。时间步长 $\\Delta t$ 必须足够小，以确保信息在单步内传播不超过一定数量的网格单元。问题指定了一个 CFL 数界限 $\\sigma = c_0 \\Delta t / \\Delta x \\leq \\sigma_{\\max} = 0.5$。我们使用极限值来获取最大稳定时间步长：\n$$\n\\Delta t = \\frac{\\sigma_{\\max} \\Delta x}{c_0} = \\frac{0.5 \\cdot (\\lambda/M)}{c_0}\n$$\n总模拟时间为 $T = N P = N \\lambda / c_0$。总时间步数 $N_{steps}$ 为：\n$$\nN_{steps} = \\frac{T}{\\Delta t} = \\frac{N \\lambda / c_0}{0.5 (\\lambda/M) / c_0} = \\frac{N M}{0.5} = 2NM\n$$\n由于 $N$ 和 $M$ 是整数，$N_{steps}$ 始终是整数。这确保了模拟恰好运行 $N$ 个周期。\n\n**4. 误差分析**\n\n初始条件是一个右行单色波。在演化了整数个时间周期 $N$ 后，精确解 $p'_{\\text{exact}}(x, T)$ 应与初始条件 $p'(x, 0) = \\cos(kx)$ 相同，因为 $p'_{\\text{exact}}(x,T) = \\cos(k(x - c_0 T)) = \\cos(kx - k c_0 (N\\lambda/c_0)) = \\cos(kx - 2\\pi N) = \\cos(kx)$。\n\n由于数值误差，数值解 $p'_{\\text{num}}(x, T)$ 将与精确解不同。我们通过将数值解投影到基函数 $\\cos(kx)$ 和 $\\sin(kx)$ 上来量化这些误差。数值波的振幅 $A$ 和相位 $\\phi$ 使用提供的公式计算：\n$$\na_c = \\frac{2}{M} \\sum_{j=0}^{M-1} p'_{\\text{num}}(x_j, T)\\cos(k x_j), \\qquad a_s = \\frac{2}{M} \\sum_{j=0}^{M-1} p'_{\\text{num}}(x_j, T)\\sin(k x_j)\n$$\n$$\nA = \\sqrt{a_c^2 + a_s^2}, \\qquad \\phi = \\mathrm{atan2}(-a_s, a_c)\n$$\n于是，幅值误差为 $A-1$，相位误差为 $\\phi$。一个正的相位误差 $\\phi$ 对应于数值波滞后于精确波，表明数值波速低于 $c_0$。对于 $N=0$ 的平凡情况，模拟时间为 $T=0$，因此最终状态即为初始状态。将 $\\cos(kx)$ 离散投影到自身上得到 $a_c=1$ 和 $a_s=0$，从而产生零幅值和相位误差，符合预期。\n#### 代码实现\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D linearized Euler acoustics problem using a DRP scheme\n    and quantifies numerical errors for a set of test cases.\n    \"\"\"\n\n    # Define physical constants given in the problem statement.\n    # All values are in SI units.\n    rho0 = 1.225    # Mean density (kg/m^3)\n    c0 = 343.0      # Speed of sound (m/s)\n    lmbda = 1.0     # Wavelength (m)\n    \n    # Derived constant\n    k = 2.0 * np.pi / lmbda  # Wavenumber (rad/m)\n\n    # Courant-Friedrichs-Lewy (CFL) number bound\n    sigma_max = 0.5\n\n    # Coefficients for the 6th-order symmetric 7-point finite difference stencil.\n    # These are derived by enforcing 6th-order accuracy via Taylor series expansion,\n    # which serves as a high-fidelity dispersion-relation-preserving (DRP) scheme.\n    # d/dx(f)_i ≈ (1/dx) * [w1(f_{i+1}-f_{i-1}) + w2(f_{i+2}-f_{i-2}) + w3(f_{i+3}-f_{i-3})]\n    # w = {w1, w2, w3}\n    w_coeffs = np.array([3.0/4.0, -3.0/20.0, 1.0/60.0])\n\n    def spatial_derivative(f_grid, dx, coeffs):\n        \"\"\"\n        Computes the first derivative of a periodic function on a uniform grid\n        using a symmetric finite difference stencil.\n        \"\"\"\n        dfdx = np.zeros_like(f_grid)\n        for i in range(len(coeffs)):\n            offset = i + 1\n            # np.roll handles periodic boundary conditions efficiently\n            dfdx += coeffs[i] * (np.roll(f_grid, -offset) - np.roll(f_grid, offset))\n        return dfdx / dx\n\n    def compute_rhs(q_vec, dx, M, rho0, c0, coeffs):\n        \"\"\"\n        Computes the right-hand side (RHS) of the semi-discretized system dq/dt = F(q).\n        `q_vec` is a state vector containing both pressure and velocity fields.\n        \"\"\"\n        p_field = q_vec[:M]\n        u_field = q_vec[M:]\n        \n        # Calculate spatial derivatives for both fields\n        dp_dx = spatial_derivative(p_field, dx, coeffs)\n        du_dx = spatial_derivative(u_field, dx, coeffs)\n        \n        # Compute time derivatives according to the linearized Euler equations\n        # dp'/dt = -rho0 * c0^2 * du'/dx\n        # du'/dt = -1/rho0 * dp'/dx\n        dp_dt = -rho0 * c0**2 * du_dx\n        du_dt = -1.0 / rho0 * dp_dx\n        \n        return np.concatenate([dp_dt, du_dt])\n\n    def run_simulation(M, N, rho0, c0, lmbda, k, coeffs, sigma):\n        \"\"\"\n        Runs the complete simulation for a given number of points per wavelength (M)\n        and number of periods (N).\n        \"\"\"\n        # Handle the trivial case where simulation time is zero.\n        if N == 0:\n            # For N=0, the final state is the initial state. The projection\n            # of the initial wave onto itself gives A=1 and phi=0.\n            return 0.0, 0.0\n\n        # Setup grid and time step parameters\n        dx = lmbda / M\n        x_grid = np.linspace(0, lmbda, M, endpoint=False)\n        \n        P = lmbda / c0  # Temporal period of the wave\n        T_final = N * P # Total simulation time\n        \n        # The number of time steps is calculated to reach T_final exactly\n        # with a time step dt determined by the CFL number.\n        # n_steps = T / dt = (N*lmbda/c0) / (sigma*dx/c0) = N*M/sigma\n        n_steps = int(round(N * M / sigma))\n        dt = T_final / n_steps\n        \n        # Initialize fields: a right-traveling monochromatic wave\n        p_initial = np.cos(k * x_grid)\n        u_initial = p_initial / (rho0 * c0)\n        q = np.concatenate([p_initial, u_initial])\n\n        # Time integration using the 4th-order Runge-Kutta (RK4) method\n        for _ in range(n_steps):\n            k1 = dt * compute_rhs(q, dx, M, rho0, c0, coeffs)\n            k2 = dt * compute_rhs(q + 0.5 * k1, dx, M, rho0, c0, coeffs)\n            k3 = dt * compute_rhs(q + 0.5 * k2, dx, M, rho0, c0, coeffs)\n            k4 = dt * compute_rhs(q + k3, dx, M, rho0, c0, coeffs)\n            q += (k1 + 2.0 * k2 + 2.0 * k3 + k4) / 6.0\n            \n        p_final = q[:M]\n        \n        # Post-processing: Calculate amplitude and phase errors\n        # The exact solution after N periods is the initial condition.\n        cos_kx = np.cos(k * x_grid)\n        sin_kx = np.sin(k * x_grid)\n        \n        # Project the final numerical solution onto cos(kx) and sin(kx)\n        a_c = (2.0 / M) * np.sum(p_final * cos_kx)\n        a_s = (2.0 / M) * np.sum(p_final * sin_kx)\n        \n        # Calculate numerical amplitude and phase\n        A = np.sqrt(a_c**2 + a_s**2)\n        phi = np.arctan2(-a_s, a_c)\n        \n        amplitude_error = A - 1.0\n        phase_error = phi\n        \n        return amplitude_error, phase_error\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        (16, 5),   # Case 1: happy path\n        (8, 1),    # Case 2: edge, minimal resolution\n        (16, 0),   # Case 3: edge, no evolution\n        (32, 10),  # Case 4: higher resolution, moderate duration\n        (64, 20),  # Case 5: high resolution, long duration\n    ]\n\n    results = []\n    for M_val, N_val in test_cases:\n        amp_err, phase_err = run_simulation(M_val, N_val, rho0, c0, lmbda, k, w_coeffs, sigma_max)\n        results.append(f\"[{amp_err},{phase_err}]\")\n\n    # Print the final results in the specified single-line format\n    # print(f\"[{','.join(results)}]\")\n```",
            "answer": "[[-1.579413284033108e-10,-0.08865440652758253],[-1.139046898935235e-11,-0.12643538965942403],[0.0,0.0],[-1.1923053702452294e-09,-0.04415842823055403],[-9.294387807498424e-09,-0.04411130836248383]]"
        }
    ]
}