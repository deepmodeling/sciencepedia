{
    "hands_on_practices": [
        {
            "introduction": "To begin, we will explore the core mechanism of the original Detached Eddy Simulation (DES) formulation. This exercise  provides a direct, hands-on calculation of the DES length scale, $d_{DES}$, which determines whether the model operates in its Reynolds-Averaged Navier–Stokes (RANS) or Large Eddy Simulation (LES) branch. Understanding this fundamental switch is the first step toward appreciating the need for the more advanced, shielded variants.",
            "id": "4007376",
            "problem": "A point in an attached turbulent boundary layer over a flat plate is resolved on a locally orthogonal grid with spacings $\\Delta_{x}$, $\\Delta_{y}$, and $\\Delta_{z}$ measured at the cell center. The wall-normal distance from the point to the nearest wall is $d$. In the Spalart–Allmaras Detached Eddy Simulation (SA-DES) approach, the modeled eddy-viscosity destruction term uses a DES length scale that, in the classical formulation (without shielding), is limited by a grid length computed from the local mesh. Improved zonal variants, such as Delayed Detached Eddy Simulation (DDES) and Improved Delayed Detached Eddy Simulation (IDDES), introduce shielding functions to prevent modeled-stress depletion in attached boundary layers, but for this point assume the classical SA-DES limiting mechanism without shielding. Take the grid length as $\\Delta=\\max(\\Delta_{x},\\Delta_{y},\\Delta_{z})$. Using the standard SA-DES constant $C_{DES}$, determine the DES length scale at the point and deduce whether the eddy-viscosity model operates in the Reynolds-Averaged Navier–Stokes (RANS) or Large Eddy Simulation (LES) branch at this location by comparing the relevant limiting scales.\n\nGiven: $C_{DES}=0.65$, $d=2\\ \\mathrm{mm}$, and $(\\Delta_{x},\\Delta_{y},\\Delta_{z})=(1,0.5,3)\\ \\mathrm{mm}$. Report your final answer as a row matrix $\\begin{pmatrix} d_{DES} & S \\end{pmatrix}$, where $d_{DES}$ is expressed in $\\mathrm{mm}$ and rounded to four significant figures, and $S$ is an indicator with $S=1$ for LES and $S=0$ for RANS. Do not include units in the matrix.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\nThe data and definitions explicitly provided in the problem statement are:\n-   The context is an attached turbulent boundary layer.\n-   The turbulence model is the Spalart–Allmaras Detached Eddy Simulation (SA-DES), classical formulation without shielding.\n-   The grid is locally orthogonal with cell-center spacings $\\Delta_{x}$, $\\Delta_{y}$, and $\\Delta_{z}$.\n-   The wall-normal distance is $d$.\n-   The grid length scale is defined as $\\Delta = \\max(\\Delta_{x}, \\Delta_{y}, \\Delta_{z})$.\n-   The SA-DES constant is $C_{DES} = 0.65$.\n-   The wall-normal distance is given as $d = 2 \\ \\mathrm{mm}$.\n-   The grid spacings are given as $(\\Delta_{x}, \\Delta_{y}, \\Delta_{z}) = (1, 0.5, 3) \\ \\mathrm{mm}$, which corresponds to $\\Delta_{x} = 1 \\ \\mathrm{mm}$, $\\Delta_{y} = 0.5 \\ \\mathrm{mm}$, and $\\Delta_{z} = 3 \\ \\mathrm{mm}$.\n-   The final answer must be a row matrix $\\begin{pmatrix} d_{DES} & S \\end{pmatrix}$, where $d_{DES}$ is the DES length scale in $\\mathrm{mm}$ rounded to four significant figures, and $S$ is an indicator variable where $S=1$ for LES mode and $S=0$ for RANS mode.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n-   **Scientifically Grounded**: The problem describes the fundamental mechanism of the original Detached Eddy Simulation (DES) formulation as proposed by Spalart et al. (1997). The length scale definition, the constant $C_{DES}$, and the distinction between Reynolds-Averaged Navier–Stokes (RANS) and Large Eddy Simulation (LES) modes are standard and correct concepts in the field of computational fluid dynamics (CFD) and turbulence modeling. The problem is firmly based on established scientific principles.\n-   **Well-Posed**: The problem provides all necessary data and definitions to calculate the required quantities. The instructions are unambiguous, and a unique, stable solution can be determined.\n-   **Objective**: The problem is stated using precise, technical language, free of any subjective or opinion-based content.\n\nThe problem statement does not violate any of the specified invalidity criteria. It is scientifically sound, complete, and well-posed.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Solution Derivation\nThe core principle of Detached Eddy Simulation (DES) is to create a hybrid model that functions as a Reynolds-Averaged Navier–Stokes (RANS) model in boundary layers and as a Large Eddy Simulation (LES) model in separated flow regions. This is achieved by modifying the length scale used in the RANS model's destruction term.\n\nFor the Spalart–Allmaras (SA) model, the original RANS length scale is the distance to the nearest wall, $d$. In the DES formulation (specifically SA-DES), this length scale is replaced by a new DES length scale, $d_{DES}$, defined as:\n$$\nd_{DES} = \\min(d, C_{DES}\\Delta)\n$$\nwhere $d$ is the wall distance, $C_{DES}$ is a model constant, and $\\Delta$ is a measure of the local grid spacing. This formulation creates two distinct operational modes:\n\n$1$. **RANS Mode**: If the wall distance $d$ is the smaller length scale, i.e., $d < C_{DES}\\Delta$, then $d_{DES} = d$. The model's destruction term retains its original RANS formulation, and the model behaves as a RANS model. This is intended to occur inside attached boundary layers where the grid is typically too coarse to resolve the turbulent eddies.\n\n$2$. **LES Mode**: If the grid-related scale $C_{DES}\\Delta$ is smaller, i.e., $d > C_{DES}\\Delta$, then $d_{DES} = C_{DES}\\Delta$. In this case, the length scale becomes proportional to the grid size, and the model acts as a subgrid-scale model for LES. This is intended for regions away from walls, such as in separated shear layers, where the grid is fine enough to resolve the large, energy-containing turbulent structures.\n\nThe problem requires us to determine $d_{DES}$ and the operational mode at a specific point. We are given the necessary values.\n\nFirst, we calculate the grid length scale $\\Delta$. The problem defines it as the maximum of the local grid spacings:\n$$\n\\Delta = \\max(\\Delta_{x}, \\Delta_{y}, \\Delta_{z})\n$$\nSubstituting the given values, $\\Delta_{x} = 1 \\ \\mathrm{mm}$, $\\Delta_{y} = 0.5 \\ \\mathrm{mm}$, and $\\Delta_{z} = 3 \\ \\mathrm{mm}$:\n$$\n\\Delta = \\max(1, 0.5, 3) \\ \\mathrm{mm} = 3 \\ \\mathrm{mm}\n$$\n\nNext, we calculate the LES length scale, which is the grid-dependent part of the $d_{DES}$ definition, $C_{DES}\\Delta$. We are given $C_{DES} = 0.65$:\n$$\nC_{DES}\\Delta = 0.65 \\times 3 \\ \\mathrm{mm} = 1.95 \\ \\mathrm{mm}\n$$\n\nNow we can determine the DES length scale, $d_{DES}$, by taking the minimum of the wall distance $d$ and the calculated LES length scale $C_{DES}\\Delta$. We are given $d = 2 \\ \\mathrm{mm}$.\n$$\nd_{DES} = \\min(d, C_{DES}\\Delta) = \\min(2 \\ \\mathrm{mm}, 1.95 \\ \\mathrm{mm})\n$$\n$$\nd_{DES} = 1.95 \\ \\mathrm{mm}\n$$\nThe problem asks for this value to be rounded to four significant figures, which gives $1.950 \\ \\mathrm{mm}$.\n\nFinally, we determine whether or not the model is in RANS or LES mode by comparing $d$ and $C_{DES}\\Delta$.\nWe have $d = 2 \\ \\mathrm{mm}$ and $C_{DES}\\Delta = 1.95 \\ \\mathrm{mm}$.\nSince $d > C_{DES}\\Delta$ (as $2 > 1.95$), the grid-related length scale is the limiting factor. This condition corresponds to the **LES mode** of operation.\nAccording to the problem's definition, the indicator for LES mode is $S=1$.\n\nThe final answer is a row matrix containing $d_{DES}$ and $S$.\n$$\n\\begin{pmatrix} d_{DES} & S \\end{pmatrix} = \\begin{pmatrix} 1.950 & 1 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.950 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Having seen the basic DES switching mechanism, we now address its primary limitation in wall-bounded flows. This practice  introduces the concept of a shielding function, which is central to Delayed Detached-Eddy Simulation (DDES). By working through the derivation and application of the modified length scale, $d_{DDES}$, you will see how this function elegantly 'delays' the switch to LES mode, thereby preventing the non-physical phenomenon of Modeled-Stress Depletion (MSD) in attached boundary layers.",
            "id": "4007382",
            "problem": "A wall-bounded aerodynamic flow over a smooth surface is computed using a hybrid Reynolds-Averaged Navier–Stokes (RANS) and Large Eddy Simulation (LES) approach, specifically the Delayed Detached-Eddy Simulation (DDES) variant of the Spalart–Allmaras model. In this approach, the modeled eddy-viscosity destruction term depends on an effective wall-distance that is modified to avoid premature switching from RANS to LES within attached boundary layers. The original Detached-Eddy Simulation (DES) replaces the physical wall-distance $d$ by a grid-dependent scale in separated regions, while DDES introduces a shielding function $f_{d}$ to ensure that within attached boundary layers the modification vanishes appropriately.\n\nStarting from the following foundational requirements for the effective distance used in the destruction term in DDES:\n\n- Within attached boundary layers where the local physical wall-distance $d$ is smaller than or comparable to the grid-imposed length $C_{DES}\\Delta$, the effective distance must reduce to $d$ to preserve the RANS behavior.\n- In regions where eddies are to be resolved (away from walls and separation), the effective distance must approach the grid scale $C_{DES}\\Delta$ to enable LES-like behavior.\n- The modification must be monotone, nonnegative, and continuous with respect to $d$ and must not reduce $d$ when $d \\leq C_{DES}\\Delta$ (to avoid grid-induced separation).\n\nDerive an expression for the modified distance $d_{DDES}$ that satisfies these requirements using the shielding function $f_{d}\\in[0,1]$, the physical wall-distance $d$, and the grid scale $C_{DES}\\Delta$. Then, for $d=1.5\\ \\mathrm{mm}$, $C_{DES}\\Delta=1.0\\ \\mathrm{mm}$, and $f_{d}=0.05$, compute the numerical value of $d_{DDES}$ and state whether, at this location, the destruction term remains in the RANS mode.\n\nExpress the final value of $d_{DDES}$ in $\\mathrm{mm}$ and round your answer to four significant figures. The qualitative conclusion about the mode should be stated explicitly but will not be part of the boxed final numerical answer.",
            "solution": "The problem requires the derivation of an expression for the modified wall distance, $d_{DDES}$, used in Delayed Detached-Eddy Simulation (DDES), and its subsequent calculation for a given set of parameters. The derivation must satisfy a set of foundational requirements for the model.\n\nFirst, let us formalize the given requirements for the effective distance $d_{DDES}$:\n1.  In Reynolds-Averaged Navier–Stokes (RANS) regions, specifically attached boundary layers where the physical wall-distance $d$ is less than or comparable to the grid-dependent length scale $C_{DES}\\Delta$, the effective distance must be the physical wall-distance: $d_{DDES} \\rightarrow d$. This preserves the wall-modeling behavior of the RANS model.\n2.  In Large Eddy Simulation (LES) regions, where large-scale turbulent eddies are resolved, the effective distance must become the grid-dependent length scale: $d_{DDES} \\rightarrow C_{DES}\\Delta$. This allows the model to act as a subgrid-scale model for LES.\n3.  The function $d_{DDES}(d)$ must be continuous, non-negative, and monotonic. Furthermore, for $d \\leq C_{DES}\\Delta$, the modification must not reduce the physical wall distance, meaning $d_{DDES} \\ge d$. The problem states it must not reduce $d$, which implies $d_{DDES} \\geq d$. We will see the standard formulation is $d_{DDES}=d$ in this range.\n\nThe standard Detached-Eddy Simulation (DES) model defines its length scale as $\\tilde{d}_{DES} = \\min(d, C_{DES}\\Delta)$. This formulation can lead to premature switching to LES mode within an attached boundary layer if the grid resolution is fine enough such that $C_{DES}\\Delta < d$. This phenomenon is known as Grid-Induced Separation (GIS).\n\nTo prevent this, DDES introduces a shielding function, $f_d$, which is designed to be $f_d=0$ deep inside an attached boundary layer and $f_d=1$ in regions where LES is appropriate (e.g., separated flow). The function $f_d$ smoothly transitions between $0$ and $1$.\n\nA functional form for $d_{DDES}$ that satisfies the requirements can be constructed by modifying the physical distance $d$ based on $f_d$. The objective is to \"delay\" the point at which $d$ is replaced by $C_{DES}\\Delta$. The standard formulation for the DDES length scale is:\n$$\nd_{DDES} = d - f_d \\max(0, d - C_{DES}\\Delta)\n$$\nLet us verify this expression against the given requirements.\n\nVerification of Requirement 1:\nIn an attached boundary layer, the shielding function is designed to be close to zero, $f_d \\approx 0$. In this case, $d_{DDES} \\approx d - 0 = d$. More strictly, if $d \\leq C_{DES}\\Delta$, the term $d - C_{DES}\\Delta$ is non-positive, so $\\max(0, d - C_{DES}\\Delta) = 0$. This leads to $d_{DDES} = d - f_d \\cdot 0 = d$. This perfectly satisfies the requirement to preserve RANS behavior in the near-wall region of an attached boundary layer.\n\nVerification of Requirement 2:\nIn a region intended for LES, the shielding function approaches unity, $f_d \\rightarrow 1$. Substituting $f_d=1$ into the expression gives:\n$$\nd_{DDES} = d - 1 \\cdot \\max(0, d - C_{DES}\\Delta)\n$$\nThis can be analyzed in two cases:\n- If $d \\leq C_{DES}\\Delta$, then $\\max(0, d - C_{DES}\\Delta) = 0$, so $d_{DDES} = d$.\n- If $d > C_{DES}\\Delta$, then $\\max(0, d - C_{DES}\\Delta) = d - C_{DES}\\Delta$, so $d_{DDES} = d - (d - C_{DES}\\Delta) = C_{DES}\\Delta$.\nCombining these two cases, the expression is equivalent to $d_{DDES} = \\min(d, C_{DES}\\Delta)$. This is precisely the original DES length scale, which correctly switches to the LES-like behavior by adopting the grid scale $C_{DES}\\Delta$ away from the wall.\n\nVerification of Requirement 3:\n-   **Continuity:** The function is composed of continuous functions ($d$, $f_d$, $\\max$). The expression is continuous everywhere, including the junction point at $d = C_{DES}\\Delta$.\n-   **Non-negativity:** Since $d \\ge 0$ and $C_{DES}\\Delta \\ge 0$, we have two cases. If $d \\le C_{DES}\\Delta$, $d_{DDES}=d \\ge 0$. If $d > C_{DES}\\Delta$, $d_{DDES} = d - f_d(d - C_{DES}\\Delta) = (1-f_d)d + f_d C_{DES}\\Delta$. Since $f_d \\in [0,1]$, this is a convex combination of two non-negative values ($d$ and $C_{DES}\\Delta$), and is therefore non-negative.\n-   **Monotonicity:** The derivative with respect to $d$ (treating $f_d$ as locally constant) is $1$ for $d < C_{DES}\\Delta$ and $1-f_d$ for $d > C_{DES}\\Delta$. Since $f_d \\in [0,1]$, the derivative is always non-negative, so the function is monotonic non-decreasing.\n-   **\"Must not reduce $d$ when $d \\leq C_{DES}\\Delta$\"**: As shown for requirement 1, when $d \\leq C_{DES}\\Delta$, we find $d_{DDES} = d$. Thus, the distance is not reduced.\n\nThe expression $d_{DDES} = d - f_d \\max(0, d - C_{DES}\\Delta)$ is therefore correct.\n\nNow, we compute the numerical value of $d_{DDES}$ using the provided data:\n- Physical wall-distance: $d = 1.5 \\ \\mathrm{mm}$\n- Grid-dependent length scale: $C_{DES}\\Delta = 1.0 \\ \\mathrm{mm}$\n- Shielding function value: $f_d = 0.05$\n\nSubstituting these values into the derived expression:\n$$\nd_{DDES} = 1.5 - 0.05 \\times \\max(0, 1.5 - 1.0)\n$$\nFirst, evaluate the term inside the $\\max$ function:\n$$\n1.5 - 1.0 = 0.5\n$$\nSince $0.5 > 0$, we have $\\max(0, 0.5) = 0.5$. The expression becomes:\n$$\nd_{DDES} = 1.5 - 0.05 \\times 0.5\n$$\n$$\nd_{DDES} = 1.5 - 0.025\n$$\n$$\nd_{DDES} = 1.475 \\ \\mathrm{mm}\n$$\nThe value $1.475$ has four significant figures, so no further rounding is needed.\n\nFinally, we must determine whether the destruction term remains in the RANS mode. The purpose of the shielding function $f_d$ is to keep the model in RANS mode inside an attached boundary layer, even if the grid is fine ($C_{DES}\\Delta < d$). A value of $f_d$ close to $0$ indicates that the shielding is active, which is characteristic of a RANS region. Here, $f_d = 0.05$, which is small. The resulting length scale is $d_{DDES} = 1.475 \\ \\mathrm{mm}$. This value is very close to the physical wall distance $d = 1.5 \\ \\mathrm{mm}$ and significantly different from the grid scale $C_{DES}\\Delta = 1.0 \\ \\mathrm{mm}$. Without the shielding ($f_d=1$), the length scale would have been $1.0 \\ \\mathrm{mm}$. The fact that $d_{DDES} \\approx d$ demonstrates that the shielding is effective and the model is operating, as intended, predominantly in its RANS mode at this location.",
            "answer": "$$\\boxed{1.475}$$"
        },
        {
            "introduction": "This final practice consolidates our understanding by connecting the abstract model formulations to a tangible engineering quantity: the skin-friction coefficient, $C_f$. In this numerical experiment , you will construct a reduced-order model to visualize the practical consequences of using an unshielded DES versus a shielded DDES. This exercise will vividly demonstrate how Modeled Stress Depletion (MSD) degrades the accuracy of DES in boundary layers and how shielding functions are essential for restoring the correct physical behavior.",
            "id": "4007320",
            "problem": "You are asked to construct a minimal yet scientifically consistent numerical test to demonstrate the onset of Modeled Stress Depletion (MSD) in Detached-Eddy Simulation (DES) and its mitigation in Delayed Detached-Eddy Simulation (DDES) by means of shielding functions, and to quantify the effect through the skin-friction coefficient trends. The scenario is a steady, zero-pressure-gradient turbulent boundary layer developing on a smooth flat plate at a fixed station. The computation must be carried out using dimensional consistency and a reduced-order formulation appropriate for a numerical experiment.\n\nStarting point and definitions:\n- Consider a uniform free-stream speed $U$ over the flat plate, fluid density $\\rho$, and dynamic viscosity $\\mu$.\n- At a streamwise station $x$, define the Reynolds number $Re_x = \\dfrac{\\rho U x}{\\mu}$.\n- Use a widely accepted correlation for the turbulent flat-plate local skin friction coefficient based on the Reynolds number to form a RANS baseline. The baseline skin-friction coefficient is $C_f^{\\mathrm{RANS}}(Re_x)$.\n- Estimate the turbulent boundary layer thickness $\\delta(Re_x)$ at the station $x$ using a well-tested correlation.\n- Define a characteristic RANS turbulence length scale $L_{\\mathrm{RANS}} = C_L \\,\\delta$, where $C_L$ is a positive constant reflecting the proportionality between the turbulent length scale and the boundary layer thickness.\n- For DES, introduce the DES blending length scale $L_{\\mathrm{DES}} = \\min\\!\\left(L_{\\mathrm{RANS}},\\, C_{\\mathrm{DES}}\\,\\Delta_x\\right)$ where $C_{\\mathrm{DES}}$ is a positive constant and $\\Delta_x$ is the streamwise grid spacing. Modeled Stress Depletion occurs when $C_{\\mathrm{DES}}\\Delta_x < L_{\\mathrm{RANS}}$; in that regime, the effective modeled turbulent length scale is reduced relative to its RANS value.\n- Assume that in the simplified one-dimensional attached boundary-layer setting, the modeled eddy viscosity scales proportionally to the square of a turbulence length scale and a representative mean shear magnitude, and that the reduction of the length scale in DES implies a proportional reduction in modeled turbulent shear stress. Consequently, let the DES skin-friction coefficient be scaled from its RANS baseline by a factor derived from the ratio of length scales.\n- For DDES, assume the shielding function in attached boundary layers fully prevents premature switching to the Large Eddy Simulation mode. In this reduced-order test, that implies that the effective length scale in attached regions remains $L_{\\mathrm{RANS}}$ irrespective of $\\Delta_x$, so the DDES skin-friction coefficient is equal to the baseline RANS skin-friction coefficient. This embodies the improved DES variants with shielding functions concept in a manner consistent with their purpose: attached boundary layers remain in Reynolds-Averaged Navier–Stokes mode until a genuine separation or detachment occurs, which is not part of this test.\n\nTasks:\n1. Compute $Re_x$, $C_f^{\\mathrm{RANS}}(Re_x)$, and $\\delta(Re_x)$ for each test case.\n2. Compute $L_{\\mathrm{RANS}} = C_L \\delta$.\n3. For DES, compute $L_{\\mathrm{DES}} = \\min\\!\\left(L_{\\mathrm{RANS}},\\, C_{\\mathrm{DES}}\\,\\Delta_x\\right)$ and then compute the DES skin-friction coefficient $C_f^{\\mathrm{DES}}$ by scaling $C_f^{\\mathrm{RANS}}$ with the square of the ratio $\\left(\\dfrac{L_{\\mathrm{DES}}}{L_{\\mathrm{RANS}}}\\right)^2$.\n4. For DDES, apply shielding in attached boundary layers so that $C_f^{\\mathrm{DDES}} = C_f^{\\mathrm{RANS}}$ for all $\\Delta_x$ in this test.\n\nPhysical units and constants:\n- Use $U$ in $\\mathrm{m/s}$, $\\rho$ in $\\mathrm{kg/m^3}$, $\\mu$ in $\\mathrm{Pa\\cdot s}$, $x$ and $\\Delta_x$ in $\\mathrm{m}$.\n- The skin-friction coefficients $C_f^{\\mathrm{RANS}}$, $C_f^{\\mathrm{DES}}$, and $C_f^{\\mathrm{DDES}}$ are dimensionless.\n- Use $C_{\\mathrm{DES}} = 0.65$ and $C_L = 0.30$.\n- Use the following well-tested correlations for the flat-plate zero-pressure-gradient turbulent boundary layer:\n  - Local skin-friction coefficient baseline: $C_f^{\\mathrm{RANS}}(Re_x) = 0.026\\,Re_x^{-1/7}$.\n  - Boundary layer thickness: $\\delta(Re_x) = 0.37\\,x\\,Re_x^{-1/5}$.\nThese formulas are acceptable as well-tested engineering correlations serving as a baseline for the reduced-order DES/DDES comparison in an attached turbulent boundary layer.\n\nTest suite:\n- Fix fluid properties $\\rho = 1.225\\,\\mathrm{kg/m^3}$ and $\\mu = 1.789\\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$, and free-stream speed $U = 50\\,\\mathrm{m/s}$.\n- Use three streamwise stations $x$: $x_1 = 0.20\\,\\mathrm{m}$, $x_2 = 1.00\\,\\mathrm{m}$, $x_3 = 5.00\\,\\mathrm{m}$.\n- For each $x$, evaluate four grid spacings $\\Delta_x$: $\\Delta_x \\in \\{0.05\\,\\mathrm{m},\\,0.01\\,\\mathrm{m},\\,0.002\\,\\mathrm{m},\\,0.0005\\,\\mathrm{m}\\}$.\n- This yields $12$ test cases. These values exercise:\n  - A \"happy path\" regime where $\\Delta_x$ is large and $C_f^{\\mathrm{DES}}\\approx C_f^{\\mathrm{RANS}}$.\n  - A near-threshold regime where $\\Delta_x$ approaches $L_{\\mathrm{RANS}}/C_{\\mathrm{DES}}$.\n  - An edge case with very fine $\\Delta_x$ where MSD becomes pronounced in DES.\n  - Variation with streamwise location $x$ affects $Re_x$ and $\\delta$, changing the onset threshold.\n\nOutput specification:\n- For each of the $12$ test cases, compute and return the pair $\\left[C_f^{\\mathrm{DES}},\\,C_f^{\\mathrm{DDES}}\\right]$ as floating-point numbers.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list in the form $\\left[C_f^{\\mathrm{DES}}, C_f^{\\mathrm{DDES}}\\right]$. For example, a valid output format is like $[[a_1,b_1],[a_2,b_2],\\dots,[a_{12},b_{12}]]$ with all $a_i$ and $b_i$ as decimal numbers.",
            "solution": "The problem presents a valid and well-posed numerical experiment designed to illustrate the phenomenon of Modeled Stress Depletion (MSD) in Detached-Eddy Simulation (DES) and its remedy in Delayed Detached-Eddy Simulation (DDES). The setup is scientifically grounded in the principles of hybrid Reynolds-Averaged Navier-Stokes (RANS) and Large Eddy Simulation (LES) methods. The problem provides all necessary definitions, constants, and a clear computational framework, making it solvable. We will proceed with a step-by-step solution based on the provided framework.\n\nThe objective is to compute the skin-friction coefficients for DES ($C_f^{\\mathrm{DES}}$) and DDES ($C_f^{\\mathrm{DDES}}$) for a turbulent boundary layer over a smooth flat plate at several streamwise locations and for various computational grid spacings. The results will quantify how the DES model can erroneously reduce modeled stress (and thus skin friction) on fine grids, while the DDES model, by design, avoids this issue in attached flows.\n\nThe solution is constructed following a sequence of calculations for each of the $12$ test cases, defined by a specific streamwise station $x$ and grid spacing $\\Delta_x$.\n\n**1. Governing Formulations and Definitions**\n\nFirst, we establish the set of equations that form our reduced-order model.\n\n- **Reynolds Number**: The local Reynolds number at a streamwise station $x$ is defined as:\n$$Re_x = \\frac{\\rho U x}{\\mu}$$\nwhere $\\rho$ is the fluid density, $U$ is the free-stream velocity, and $\\mu$ is the dynamic viscosity.\n\n- **RANS Baseline Correlations**: We use well-established empirical correlations for a zero-pressure-gradient turbulent boundary layer to define our RANS baseline.\n  - The local skin-friction coefficient, $C_f^{\\mathrm{RANS}}$, is given by the power law:\n  $$C_f^{\\mathrm{RANS}}(Re_x) = 0.026\\,Re_x^{-1/7}$$\n  - The boundary layer thickness, $\\delta$, is given by:\n  $$\\delta(Re_x) = 0.37\\,x\\,Re_x^{-1/5}$$\n\n- **Turbulence Length Scales**: The core of the DES/DDES logic lies in the definition of the turbulence length scale.\n  - The RANS turbulence length scale, $L_{\\mathrm{RANS}}$, is assumed to be proportional to the boundary layer thickness:\n  $$L_{\\mathrm{RANS}} = C_L \\,\\delta$$\n  where $C_L$ is a model constant.\n  - The DES blending length scale, $L_{\\mathrm{DES}}$, is defined by the minimum of the RANS scale and a grid-dependent scale:\n  $$L_{\\mathrm{DES}} = \\min\\!\\left(L_{\\mathrm{RANS}},\\, C_{\\mathrm{DES}}\\,\\Delta_x\\right)$$\n  where $C_{\\mathrm{DES}}$ is the DES model constant and $\\Delta_x$ is the local grid spacing. This $\\min$ function is the defining feature of the original DES formulation and the root cause of MSD. When the grid is fine, such that $C_{\\mathrm{DES}}\\,\\Delta_x < L_{\\mathrm{RANS}}$, the length scale is artificially limited by the grid, even within an attached boundary layer where a RANS model would be more appropriate.\n\n- **Skin-Friction Coefficient Scaling**: The effect of the modified length scale on the modeled stress is represented by a scaling of the skin-friction coefficient. The modeled turbulent shear stress, and consequently the skin friction, is assumed to be proportional to the square of the turbulence length scale.\n  - The DES skin-friction coefficient, $C_f^{\\mathrm{DES}}$, is scaled from the RANS baseline:\n  $$C_f^{\\mathrm{DES}} = C_f^{\\mathrm{RANS}} \\left(\\frac{L_{\\mathrm{DES}}}{L_{\\mathrm{RANS}}}\\right)^2$$\n  - The DDES model incorporates a shielding function that prevents the switch to the LES mode in an attached boundary layer. For this idealized test, this means the length scale is always the RANS scale, regardless of grid spacing. Therefore, the DDES skin-friction coefficient, $C_f^{\\mathrm{DDES}}$, is identical to the RANS baseline:\n  $$C_f^{\\mathrm{DDES}} = C_f^{\\mathrm{RANS}}$$\n\n**2. Physical Constants and Test Case Parameters**\n\nThe following numerical values are used for all calculations:\n- Fluid density: $\\rho = 1.225\\,\\mathrm{kg/m^3}$\n- Dynamic viscosity: $\\mu = 1.789\\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$\n- Free-stream speed: $U = 50\\,\\mathrm{m/s}$\n- Model constant for RANS length scale: $C_L = 0.30$\n- Model constant for DES: $C_{\\mathrm{DES}} = 0.65$\n\nThe computations are performed for a set of $12$ test cases, comprising all combinations of:\n- Streamwise stations: $x \\in \\{0.20\\,\\mathrm{m},\\, 1.00\\,\\mathrm{m},\\, 5.00\\,\\mathrm{m}\\}$\n- Grid spacings: $\\Delta_x \\in \\{0.05\\,\\mathrm{m},\\, 0.01\\,\\mathrm{m},\\, 0.002\\,\\mathrm{m},\\, 0.0005\\,\\mathrm{m}\\}$\n\n**3. Computational Procedure**\n\nFor each test case defined by a pair $(x, \\Delta_x)$, we perform the following steps:\n\n- **Step A: Compute Reynolds Number**: Calculate $Re_x$ using the given fluid properties, velocity, and streamwise station $x$.\n- **Step B: Compute RANS Baseline**: Using the calculated $Re_x$, compute the RANS skin-friction coefficient $C_f^{\\mathrm{RANS}}$ and boundary layer thickness $\\delta$. This represents the target solution that an ideal turbulence model should produce for this attached flow.\n- **Step C: Compute RANS Length Scale**: Calculate the characteristic RANS turbulence length scale $L_{\\mathrm{RANS}}$ from $\\delta$.\n- **Step D: Compute DES Length Scale**: Calculate the grid-dependent scale $C_{\\mathrm{DES}}\\Delta_x$ and find the DES length scale $L_{\\mathrm{DES}}$ by taking the minimum of $L_{\\mathrm{RANS}}$ and $C_{\\mathrm{DES}}\\Delta_x$.\n- **Step E: Compute DES Skin-Friction Coefficient**: Calculate the scaling factor $(L_{\\mathrm{DES}}/L_{\\mathrm{RANS}})^2$. If $L_{\\mathrm{DES}} = L_{\\mathrm{RANS}}$, this factor is $1$, and $C_f^{\\mathrm{DES}} = C_f^{\\mathrm{RANS}}$. If $L_{\\mathrm{DES}} < L_{\\mathrm{RANS}}$ (the MSD regime), this factor is less than $1$, leading to $C_f^{\\mathrm{DES}} < C_f^{\\mathrm{RANS}}$.\n- **Step F: Compute DDES Skin-Friction Coefficient**: According to the problem definition for this idealized scenario, the shielding in DDES is perfect, so we set $C_f^{\\mathrm{DDES}} = C_f^{\\mathrm{RANS}}$.\n- **Step G: Store Results**: The final result for the test case is the pair $[C_f^{\\mathrm{DES}}, C_f^{\\mathrm{DDES}}]$.\n\nThis procedure is systematically applied to all $12$ test cases to generate the final output. The resulting list of pairs will clearly show that for coarse grids, $C_f^{\\mathrm{DES}}$ is close to $C_f^{\\mathrm{DDES}}$, but as the grid is refined, $C_f^{\\mathrm{DES}}$ drops significantly below the correct RANS/DDES value, demonstrating the effect of Modeled Stress Depletion.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes DES and DDES skin-friction coefficients to demonstrate\n    Modeled Stress Depletion (MSD) and its mitigation.\n    \"\"\"\n\n    # Physical properties and constants\n    rho = 1.225  # Fluid density in kg/m^3\n    mu = 1.789e-5  # Dynamic viscosity in Pa.s\n    U = 50.0  # Free-stream speed in m/s\n\n    # Model constants\n    C_DES = 0.65\n    C_L = 0.30\n\n    # Test suite parameters\n    x_stations = [0.20, 1.00, 5.00]  # Streamwise stations in m\n    delta_x_spacings = [0.05, 0.01, 0.002, 0.0005]  # Grid spacings in m\n\n    test_cases = []\n    for x in x_stations:\n        for delta_x in delta_x_spacings:\n            test_cases.append({'x': x, 'delta_x': delta_x})\n\n    results = []\n    for case in test_cases:\n        x = case['x']\n        delta_x = case['delta_x']\n\n        # Step 1: Compute Reynolds number\n        Re_x = (rho * U * x) / mu\n\n        # Step 2: Compute RANS baseline quantities\n        # Skin-friction coefficient correlation\n        Cf_RANS = 0.026 * Re_x**(-1.0/7.0)\n        # Boundary layer thickness correlation\n        delta_bl = 0.37 * x * Re_x**(-1.0/5.0)\n\n        # Step 3: Compute RANS turbulence length scale\n        L_RANS = C_L * delta_bl\n\n        # Step 4: Compute DES blending length scale\n        L_DES = np.minimum(L_RANS, C_DES * delta_x)\n\n        # Step 5: Compute DES skin-friction coefficient\n        # The scaling is proportional to the square of the length scale ratio.\n        Cf_DES = Cf_RANS * (L_DES / L_RANS)**2\n\n        # Step 6: Compute DDES skin-friction coefficient\n        # In DDES, the shielding function prevents MSD in attached boundary layers.\n        # Thus, the model correctly operates in RANS mode.\n        Cf_DDES = Cf_RANS\n        \n        results.append([Cf_DES, Cf_DDES])\n\n    # Format the final output string as specified: [[a1,b1],[a2,b2],...]\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    output_string = f\"[{','.join(formatted_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}