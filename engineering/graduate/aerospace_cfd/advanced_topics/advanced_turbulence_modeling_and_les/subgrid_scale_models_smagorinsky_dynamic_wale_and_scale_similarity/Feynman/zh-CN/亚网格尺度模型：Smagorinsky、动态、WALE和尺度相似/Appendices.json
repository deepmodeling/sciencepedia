{
    "hands_on_practices": [
        {
            "introduction": "亚格子尺度（SGS）模型是湍流大涡模拟（LES）的基石，但这些模型的数学形式从何而来？本练习将引导你追溯到物理学的第一性原理。通过运用白金汉 $\\Pi$ 定理进行量纲分析，你将推导出最具代表性的 Smagorinsky 模型的基本形式 。这项练习旨在阐明，如何仅通过量纲一致性和伽利略不变性等基本物理约束，就能构建出在计算流体力学中广泛应用的湍流模型。",
            "id": "3998601",
            "problem": "考虑一个不可压缩湍流的大涡模拟 (LES)。令 $\\tilde{u}_{i}$ 表示空间滤波后的速度场，并将解析的应变率张量定义为 $\\tilde{S}_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\tilde{u}_{i}}{\\partial x_{j}} + \\frac{\\partial \\tilde{u}_{j}}{\\partial x_{i}}\\right)$。亚格子尺度 (SGS) 湍流涡粘性 $\\nu_{t}$ 被假定为一个类运动粘性系数，用于在滤波后的不可压缩 Navier-Stokes 方程中模拟未解析的动量输运，并且其依赖关系仅限于滤波宽度 $\\Delta$ 和解析的应变率张量 $\\tilde{S}_{ij}$。该模型必须满足伽利略不变性、旋转不变性和各向同性，并且当 $\\tilde{S}_{ij} = 0$ 时必须为零。\n\n从不可压缩 Navier-Stokes 方程的量纲结构出发，并使用白金汉 $\\Pi$ 定理，推导 $\\nu_{t}$ 关于 $\\Delta$ 和一个与所述不变性一致的 $\\tilde{S}_{ij}$ 标量不变量的依赖关系。您的答案应为 $\\nu_{t}$ 的一个封闭形式解析表达式，其中包含 $\\Delta$、解析应变率张量的大小 $|\\tilde{S}|$ 以及一个未确定的无量纲常数。请勿引入任何其他变量或参数。将解析应变率大小表示为 $|\\tilde{S}| = \\left(2\\,\\tilde{S}_{ij}\\tilde{S}_{ij}\\right)^{1/2}$。只需提供 $\\nu_{t}$ 的最终表达式；不需要进行数值计算或四舍五入，最终答案中不应包含任何单位。",
            "solution": "该问题陈述具有科学依据，提法恰当，客观且自洽。它提出了一个湍流模型中的标准问题，可以使用量纲分析进行严格求解。因此，该问题是有效的，并将推导出解答。\n\n目标是找到亚格子尺度 (SGS) 涡粘性 $\\nu_{t}$ 的函数形式，假定其依赖于滤波宽度 $\\Delta$ 和解析的应变率张量 $\\tilde{S}_{ij}$。该关系可以表示为：\n$$ \\nu_{t} = f(\\Delta, \\tilde{S}_{ij}) $$\n旋转不变性的要求规定了函数 $f$ 不能依赖于坐标系的方向。因此，它对张量 $\\tilde{S}_{ij}$ 的依赖性必须通过该张量的标量不变量来体现。问题指定使用解析应变率张量的大小 $|\\tilde{S}|$，它是一个标量不变量。因此，函数依赖关系简化为：\n$$ \\nu_{t} = f(\\Delta, |\\tilde{S}|) $$\n我们将使用白金汉 $\\Pi$ 定理来确定该函数的形式。\n\n首先，我们确定所涉及的物理量及其在长度 ($L$) 和时间 ($T$) 方面的基本量纲。\n$1$. SGS 涡粘性 $\\nu_{t}$ 是一种运动粘性。其量纲为 $[L^{2} T^{-1}]$。\n$2$. 滤波宽度 $\\Delta$ 是一个特征长度。其量纲为 $[L]$。\n$3$. 解析应变率张量的大小 $|\\tilde{S}|$ 定义为 $|\\tilde{S}| = \\left(2\\,\\tilde{S}_{ij}\\tilde{S}_{ij}\\right)^{1/2}$。应变率张量的分量 $\\tilde{S}_{ij}$ 具有时间倒数的量纲 $[T^{-1}]$，因为它们代表速度梯度。因此， $|\\tilde{S}|$ 的量纲也是 $[T^{-1}]$。\n\n我们有 $n=3$ 个物理量（$\\nu_{t}$、$\\Delta$、$|\\tilde{S}|$）和 $k=2$ 个基本量纲（$L$、$T$）。根据白金汉 $\\Pi$ 定理，可以形成的独立无量纲群组（$\\Pi$ 群组）的数量为 $n-k = 3-2 = 1$。我们将这个单一的无量纲群组称为 $\\Pi_1$。\n\n我们将 $\\Pi_1$ 构建为各变量特定次幂的乘积：\n$$ \\Pi_1 = \\nu_{t}^{a} \\Delta^{b} |\\tilde{S}|^{c} $$\n其中 $a$、$b$ 和 $c$ 是常数指数。为了使 $\\Pi_1$ 无量纲，其在 $L$ 和 $T$ 方面的总维量纲必须为零。我们通过代入每个变量的量纲来表示这一点：\n$$ [\\Pi_1] = (L^{2} T^{-1})^{a} (L)^{b} (T^{-1})^{c} = L^{2a+b} T^{-a-c} $$\n为了使其无量纲，我们必须有 $L^{0} T^{0}$。这产生了一个关于指数的线性方程组：\n$$ \\begin{cases} 2a + b = 0  \\text{(对于量纲 } L\\text{)} \\\\ -a - c = 0  \\text{(对于量纲 } T\\text{)} \\end{cases} $$\n这是一个包含三个未知数的两个方程的方程组。我们可以用一个指数来表示另外两个。我们设 $a=1$，以找到 $\\nu_{t}$ 的关系形式。\n当 $a=1$ 时：\n第一个方程得出 $2(1) + b = 0$，这意味着 $b = -2$。\n第二个方程得出 $-(1) - c = 0$，这意味着 $c = -1$。\n将这些指数代回 $\\Pi_1$ 的表达式中：\n$$ \\Pi_1 = \\nu_{t}^{1} \\Delta^{-2} |\\tilde{S}|^{-1} = \\frac{\\nu_{t}}{\\Delta^{2} |\\tilde{S}|} $$\n由于只有一个无量纲群组，白金汉 $\\Pi$ 定理指出该群组必须等于一个常数。我们用 $C$ 表示这个未确定的无量纲常数。\n$$ \\frac{\\nu_{t}}{\\Delta^{2} |\\tilde{S}|} = C $$\n求解 $\\nu_{t}$，我们得到涡粘性的函数形式：\n$$ \\nu_{t} = C \\Delta^{2} |\\tilde{S}| $$\n我们根据问题陈述中给出的约束来验证这个结果。\n- **不变性**：滤波宽度 $\\Delta$ 是一个标量。解析的应变率张量 $\\tilde{S}_{ij}$ 是伽利略不变的，其标量大小 $|\\tilde{S}|$ 也是如此。因此，所表达的 $\\nu_{t}$ 是伽利略不变的。由于对 $\\tilde{S}_{ij}$ 的依赖仅通过其标量大小，该模型也是旋转不变和各向同性的。\n- **零应变时为零**：如果 $\\tilde{S}_{ij} = 0$，则 $|\\tilde{S}| = 0$，这导致 $\\nu_{t} = C \\Delta^{2} (0) = 0$。此条件得到满足。\n- **量纲一致性**：等式右边的量纲为 $[L]^{2} [T^{-1}] = [L^{2} T^{-1}]$，与左边运动粘性 $\\nu_{t}$ 的量纲相匹配。常数 $C$ 确实是无量纲的。\n\n推导出的表达式是著名的 Smagorinsky 亚格子尺度粘性模型，其中常数 $C$ 通常通过 $C=C_S^{2}$ 与 Smagorinsky 常数 $C_S$ 相关联。该推导满足了问题的所有要求。",
            "answer": "$$ \\boxed{C \\Delta^{2} |\\tilde{S}|} $$"
        },
        {
            "introduction": "虽然 Smagorinsky 模型是基础，但它在近壁区等非完全发展的湍流区域存在已知的局限性。本练习将探讨一种更先进的模型——壁面自适应局部涡粘性（WALE）模型，并分析其在特定流场中的表现 。通过在一个简化的二维驻点流中，将 WALE 模型的涡粘性预测与经典的 Smagorinsky 模型进行对比，你将揭示 WALE 模型的一个关键设计优势：它能够自动在层流或纯剪切流区域“关闭”涡粘性，而无需额外的阻尼函数。",
            "id": "3998661",
            "problem": "考虑不可压缩流的大涡模拟(LES)，其中对Navier-Stokes方程进行滤波会引入一个未解析的亚格子尺度(SGS)应力张量，该张量通常使用涡粘性封闭进行建模，其形式为 $\\tau_{ij}^{\\mathrm{SGS}}=-2\\,\\rho\\,\\nu_{t}\\,S_{ij}$，其中 $S_{ij}$ 是已解析的应变率张量，定义为 $S_{ij}=\\frac{1}{2}\\left(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{j}}{\\partial x_{i}}\\right)$，$\\rho$ 是流体密度。两种广泛使用的SGS模型是Smagorinsky模型和壁面自适应局部涡粘性(WALE)模型。在WALE模型中，涡粘性由下式给出\n$$\n\\nu_{t}^{\\mathrm{WALE}}=(C_{w}\\,\\Delta)^{2}\\,\\frac{\\left(S_{ij}^{d}S_{ij}^{d}\\right)^{3/2}}{\\left(S_{ij}S_{ij}\\right)^{5/2}+\\left(S_{ij}^{d}S_{ij}^{d}\\right)^{5/4}},\n$$\n其中 $\\Delta$ 是滤波宽度，$C_{w}$ 是一个模型常数，$S_{ij}^{d}$ 是速度梯度张量平方的对称偏张量部分。令 $g_{ij}=\\frac{\\partial u_{i}}{\\partial x_{j}}$ 表示速度梯度张量，$G_{ij}=g_{ik}g_{kj}$ 表示梯度张量的平方。在 $d$ 维空间中，与WALE相关的对称偏张量部分为\n$$\nS_{ij}^{d}=\\frac{1}{2}\\left(G_{ij}+G_{ji}\\right)-\\frac{1}{d}\\,G_{kk}\\,\\delta_{ij}.\n$$\n带有van Driest近壁阻尼的Smagorinsky涡粘性为\n$$\n\\nu_{t}^{\\mathrm{Smag}}=(C_{s}\\,\\Delta)^{2}\\,|S|\\,f_{d}^{2},\\qquad |S|=\\sqrt{2\\,S_{ij}S_{ij}},\\qquad f_{d}=1-\\exp\\!\\left(-\\frac{y^{+}}{A^{+}}\\right),\n$$\n其中 $C_{s}$ 是Smagorinsky常数，$A^{+}$ 是van Driest系数，$y^{+}$ 是以粘性单位表示的壁面法向距离。假设一个二维、不可压缩的层流驻点流，其速度梯度场是均匀的\n$$\ng_{ij}=\\begin{pmatrix}a  0 \\\\ 0  -a\\end{pmatrix},\\qquad a>0\\ \\text{constant},\n$$\n这是驻点运动学的经典线性近似。使用上述定义并取 $d=2$，推导此流动的 $\\nu_{t}^{\\mathrm{WALE}}$ 和 $\\nu_{t}^{\\mathrm{Smag}}$。然后定义比率\n$$\nR(y^{+})=\\frac{\\nu_{t}^{\\mathrm{WALE}}}{\\nu_{t}^{\\mathrm{Smag}}},\n$$\n并对任意有限的 $a$、$\\Delta$、$C_{w}$、$C_{s}$ 和 $A^{+}$，计算近壁层流驻点极限 $\\lim_{y^{+}\\to 0}R(y^{+})$。将您的最终结果表示为单个无量纲数。无需进行四舍五入。",
            "solution": "问题要求针对一个指定的二维驻点流，推导并比较两种亚格子尺度(SGS)涡粘性 $\\nu_{t}^{\\mathrm{WALE}}$ 和 $\\nu_{t}^{\\mathrm{Smag}}$，然后计算它们比率的近壁极限。\n\n首先，我们分析给定流动的运动学。速度梯度张量由下式给出：\n$$\ng_{ij} = \\frac{\\partial u_i}{\\partial x_j} = \\begin{pmatrix} a  0 \\\\ 0  -a \\end{pmatrix}\n$$\n其中 $a  0$ 是一个常数。由于流动是二维的，下标 $i, j$ 的取值范围为1到2。\n\n我们首先计算Smagorinsky模型所需的各分量。已解析的应变率张量 $S_{ij}$ 定义为：\n$$\nS_{ij} = \\frac{1}{2}\\left(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{j}}{\\partial x_{i}}\\right) = \\frac{1}{2}(g_{ij} + g_{ji})\n$$\n由于给定的 $g_{ij}$ 张量是对称的 ($g_{ij} = g_{ji}$)，因此应变率张量等于速度梯度张量：\n$$\nS_{ij} = g_{ij} = \\begin{pmatrix} a  0 \\\\ 0  -a \\end{pmatrix}\n$$\nSmagorinsky模型取决于该张量的大小 $|S| = \\sqrt{2S_{ij}S_{ij}}$。我们计算标量不变量 $S_{ij}S_{ij}$ (使用爱因斯坦求和约定)：\n$$\nS_{ij}S_{ij} = S_{11}^2 + S_{12}^2 + S_{21}^2 + S_{22}^2 = a^2 + 0^2 + 0^2 + (-a)^2 = 2a^2\n$$\n使用此结果，我们求得应变率大小：\n$$\n|S| = \\sqrt{2 S_{ij}S_{ij}} = \\sqrt{2(2a^2)} = \\sqrt{4a^2} = 2a\n$$\n最后一步成立是因为 $a  0$。因此，带有van Driest阻尼的Smagorinsky涡粘性为：\n$$\n\\nu_{t}^{\\mathrm{Smag}} = (C_{s}\\,\\Delta)^{2}\\,|S|\\,f_{d}^{2} = (C_{s}\\,\\Delta)^{2}\\,(2a)\\,\\left(1-\\exp\\!\\left(-\\frac{y^{+}}{A^{+}}\\right)\\right)^2\n$$\n\n接下来，我们计算壁面自适应局部涡粘性(WALE)模型所需的各分量。该模型使用了速度梯度张量的平方，$G_{ij} = g_{ik}g_{kj}$。\n$$\nG_{ij} = \\begin{pmatrix} a  0 \\\\ 0  -a \\end{pmatrix} \\begin{pmatrix} a  0 \\\\ 0  -a \\end{pmatrix} = \\begin{pmatrix} a^2  0 \\\\ 0  (-a)^2 \\end{pmatrix} = \\begin{pmatrix} a^2  0 \\\\ 0  a^2 \\end{pmatrix}\n$$\nWALE模型需要张量 $S_{ij}^d$，它是 $G_{ij}$ 的对称偏张量部分。其 d 维公式为 $S_{ij}^{d}=\\frac{1}{2}\\left(G_{ij}+G_{ji}\\right)-\\frac{1}{d}\\,G_{kk}\\,\\delta_{ij}$。由于我们计算出的 $G_{ij}$ 是对称的 ($G_{ij} = G_{ji}$)，所以对称部分就是 $G_{ij}$。问题指定取 $d=2$。我们首先计算 $G_{ij}$ 的迹：\n$$\nG_{kk} = G_{11} + G_{22} = a^2 + a^2 = 2a^2\n$$\n现在，我们可以计算 $d=2$ 时的 $S_{ij}^d$：\n$$\nS_{ij}^{d} = G_{ij} - \\frac{1}{2} G_{kk} \\delta_{ij} = \\begin{pmatrix} a^2  0 \\\\ 0  a^2 \\end{pmatrix} - \\frac{1}{2}(2a^2) \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} a^2  0 \\\\ 0  a^2 \\end{pmatrix} - \\begin{pmatrix} a^2  0 \\\\ 0  a^2 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n因此，对于这个二维特定流场，$S_{ij}^d$ 是零张量。这是一个关键的发现。WALE模型的关键标量不变量是 $S_{ij}^d S_{ij}^d$：\n$$\nS_{ij}^d S_{ij}^d = 0^2+0^2+0^2+0^2 = 0\n$$\n现在我们将计算出的不变量代入 $\\nu_{t}^{\\mathrm{WALE}}$ 的公式中：\n$$\n\\nu_{t}^{\\mathrm{WALE}}=(C_{w}\\,\\Delta)^{2}\\,\\frac{\\left(S_{ij}^{d}S_{ij}^{d}\\right)^{3/2}}{\\left(S_{ij}S_{ij}\\right)^{5/2}+\\left(S_{ij}^{d}S_{ij}^{d}\\right)^{5/4}}\n$$\n代入 $S_{ij}^d S_{ij}^d = 0$ 和 $S_{ij}S_{ij} = 2a^2$：\n$$\n\\nu_{t}^{\\mathrm{WALE}}=(C_{w}\\,\\Delta)^{2}\\,\\frac{\\left(0\\right)^{3/2}}{\\left(2a^2\\right)^{5/2}+\\left(0\\right)^{5/4}}\n$$\n分子为 $0$。分母为 $(2a^2)^{5/2} = 16\\sqrt{2}a^5$，对于 $a0$ 而言，该值非零。因此，对于此流动，WALE涡粘性恰好为零：\n$$\n\\nu_{t}^{\\mathrm{WALE}} = 0\n$$\n这个结果反映了WALE模型构造的一个特性，即对于某些特定的流动运动学，包括二维无旋驻点流，它会在没有任何显式阻尼的情况下产生零涡粘性。\n\n最后，题目要求我们计算比率 $R(y^{+})=\\frac{\\nu_{t}^{\\mathrm{WALE}}}{\\nu_{t}^{\\mathrm{Smag}}}$ 当 $y^{+}\\to 0$ 时的极限。该比率为：\n$$\nR(y^{+}) = \\frac{0}{(C_{s}\\,\\Delta)^{2}\\,(2a)\\,\\left(1-\\exp\\!\\left(-\\frac{y^{+}}{A^{+}}\\right)\\right)^2}\n$$\n对于任意有限正值 $y^{+}$，所有参数($C_s, \\Delta, a, A^+$)都是有限且非零的，分母也非零。因此，对于任意 $y^{+}  0$，该比率恰好为零：\n$$\nR(y^{+}) = 0 \\quad \\text{for } y^{+}  0\n$$\n我们需要求此函数当 $y^{+}$ 趋近于 $0$ 时的极限：\n$$\n\\lim_{y^{+}\\to 0}R(y^{+}) = \\lim_{y^{+}\\to 0} 0\n$$\n常数函数的极限就是该常数本身。因此，极限为 $0$。\n值得注意的是，虽然 $\\lim_{y^{+}\\to 0}\\nu_{t}^{\\mathrm{Smag}} = 0$，但这在极限情况下不会产生 $0/0$ 型的不定式，因为在 $y^+=0$ 的邻域内，分子函数恒等于零。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "动态程序是 SGS 建模的一大进步，它允许模型常数根据流场数据本身进行自适应计算，而非依赖于经验设定。这项计算练习将挑战你从理论走向实践，在一个有限体积法框架下实现动态 Smagorinsky 模型 。该练习进一步探讨了计算流体力学中的一个关键实际问题：网格的非正交性和扭曲度等质量缺陷，如何影响模型的计算结果，从而加深你对理论模型在实际应用中稳健性的理解。",
            "id": "3998668",
            "problem": "考虑在航空航天计算流体力学 (CFD) 中对二维周期性流进行的不可压缩大涡模拟 (LES)。令滤波后的不可压缩纳维-斯托克斯方程作为基本基础，并结合亚格子尺度应力张量和应变率张量的定义。具体来说，滤波速度表示为 $\\tilde{\\mathbf{u}} = (\\tilde{u}, \\tilde{v})$，亚格子尺度 (SGS) 应力张量为 $\\tau_{ij} = \\widetilde{u_i u_j} - \\tilde{u}_i \\tilde{u}_j$。解析应变率张量为 $S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\tilde{u}_i}{\\partial x_j} + \\frac{\\partial \\tilde{u}_j}{\\partial x_i}\\right)$，其模为 $|S| = \\sqrt{2 S_{ij} S_{ij}}$。Smagorinsky 的涡粘性闭合模型假定 $\\nu_t = (C_s \\Delta)^2 |S|$，其中 $\\Delta$ 是滤波器宽度， $C_s$ 是 Smagorinsky 常数。动态程序通过应用于网格滤波场的测试滤波器（由帽子符号表示）构建的 Germano 恒等式来确定 $C_s^2$，从而得出 $C_s^2$ 的最小二乘估计，该估计使精确恒等式与模型化张量之间的失配最小化。\n\n您需要在有限体积网格上，使用基于面的测试滤波器来一致地实现动态模型。单元上的基于面的滤波器定义为面插值量的加权平均。对于一个有四个面（东、西、南、北）的单元，将一个通用的单元中心量表示为 $\\phi$。对于单元 $p$ 与其相邻单元 $q$ 共享的每个内面，通过线性混合 $\\phi_f = \\alpha \\, \\phi_p + (1 - \\alpha) \\, \\phi_q$ 来插值得到面值 $\\phi_f$，其中插值系数 $\\alpha$ 根据给定的网格偏斜参数 $s \\in [0, 0.5)$ 偏离 $0.5$。具体地，对于单元东侧和北侧的面，取 $\\alpha = 0.5 + s$；对于西侧和南侧的面，取 $\\alpha = 0.5 - s$。然后，单元上基于面的滤波值为 $\\hat{\\phi} = \\frac{\\sum_f w_f \\, \\phi_f}{\\sum_f w_f}$，其中面权重 $w_f = A_f \\cos(\\theta_f)$ 包含面面积 $A_f$ 和一个余弦因子，该余弦因子通过一个统一应用于所有面的给定角度 $\\theta_f$ 来捕捉网格非正交性。在二维情况下，对东、西面使用 $A_f = \\Delta y$，对南、北面使用 $A_f = \\Delta x$，并且 $\\cos(\\theta_f) = \\cos(\\theta)$，其中非正交性角度 $\\theta$ 以度为单位指定。\n\n考虑在 $[0, 2\\pi] \\times [0, 2\\pi]$ 上的周期性方形域，该域通过一个在 $x$ 方向有 $N_x$ 个单元、在 $y$ 方向有 $N_y$ 个单元的均匀有限体积网格进行离散，并采用周期性边界条件。令 $\\Delta x = \\frac{2\\pi}{N_x}$ 和 $\\Delta y = \\frac{2\\pi}{N_y}$。选择解析速度场为光滑无散场 $\\tilde{u}(x,y) = \\sin(x)\\cos(y)$ 和 $\\tilde{v}(x,y) = -\\cos(x)\\sin(y)$。使用周期性二阶中心差分计算空间导数。使用网格滤波器宽度 $\\Delta = \\sqrt{\\Delta x \\Delta y}$ 和测试滤波器宽度 $\\hat{\\Delta} = 2 \\Delta$。\n\n从滤波后的不可压缩纳维-斯托克斯方程和 Germano 恒等式出发，根据由解析场及其基于面的测试滤波对应场构建的张量的双点积，推导 $C_s^2$ 的最小二乘公式。与上述基于面的滤波器定义一致地实现此公式，通过对所有单元上的最小二乘估计进行空间平均，来为每个案例评估一个单一的全局 $C_s^2$。将密度视为1，如果最小二乘估计中的分母在数值上接近于零，则通过加上一个小的正数 $10^{-12}$ 对其进行正则化。\n\n设计程序，通过为一组给定案例计算全局 $C_s^2$，来评估动态 $C_s^2$ 对网格偏斜度 $s$ 和非正交性角度 $\\theta$ 的敏感性。使用 $N_x = 32$ 和 $N_y = 32$。$(s, \\theta)$ 对的测试套件是：\n- 案例 1：(0.0, 0)，正交基准。\n- 案例 2：(0.2, 20)，中等偏斜度和非正交性。\n- 案例 3：(0.4, 40)，高偏斜度和非正交性，接近稳定性的实际应用上限。\n- 案例 4：(0.3, 0)，仅有偏斜度。\n- 案例 5：(0.0, 30)，仅有非正交性。\n\n您的程序必须为每个案例计算全局动态 $C_s^2$（作为一个实数），并生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[c_1,c_2,c_3,c_4,c_5]$）。最终结果是无量纲实数。不允许外部输入；所有参数均按上文给定值固定。确保您的实现是自包含的，并且在数值上与指定的基于面的滤波和周期性差分方法一致。",
            "solution": "该问题是有效的，因为它科学地基于湍流建模的大涡模拟 (LES) 原理，问题陈述清晰，提供了所有必要的参数和定义，并且完全客观。任务是在二维周期性域上，为给定的速度场计算动态 Smagorinsky 常数 $C_s^2$。计算必须通过一个自定义的基于面的测试滤波操作，来考虑网格质量的变化，特别是偏斜度 $s$ 和非正交性 $\\theta$。\n\n**理论公式：动态程序**\n\n动态 Smagorinsky 模型根据解析流场在局部动态地确定系数 $C_s^2$。该程序基于 Germano 恒等式，该恒等式关联了亚格子尺度 (SGS) 应力张量 $\\tau_{ij}$ 和亚测试尺度 (STS) 应力张量 $T_{ij}$。\n\n令网格滤波器由波浪号 $(\\sim)$ 表示，测试滤波器由帽子符号 $(\\wedge)$ 表示。解析速度场给定为 $\\tilde{\\mathbf{u}}$。SGS 应力张量定义为 $\\tau_{ij} = \\widetilde{u_i u_j} - \\tilde{u}_i \\tilde{u}_j$。Smagorinsky 模型通过涡粘性 $\\nu_t$ 将此张量的偏量部分与解析应变率张量 $S_{ij} = \\frac{1}{2}(\\partial_j \\tilde{u}_i + \\partial_i \\tilde{u}_j)$ 联系起来：\n$$ \\tau_{ij} - \\frac{1}{3}\\tau_{kk}\\delta_{ij} = -2\\nu_t S_{ij} $$\n对于不可压缩流，迹部分 $\\tau_{kk}$ 通常被吸收到压力项中。涡粘性被建模为 $\\nu_t = (C_s \\Delta)^2 |S|$，其中 $\\Delta$ 是网格滤波器宽度，而 $|S| = \\sqrt{2 S_{kl} S_{kl}}$ 是应变率张量的模。因此，模型化的 SGS 应力为：\n$$ \\tau_{ij}^{\\text{model}} = -2(C_s \\Delta)^2 |S| S_{ij} = C_s^2 \\beta_{ij} $$\n其中我们定义 $\\beta_{ij} = -2 \\Delta^2 |S| S_{ij}$。\n\n将测试滤波器应用于解析场 $\\tilde{\\mathbf{u}}$ 会得到 $\\hat{\\tilde{\\mathbf{u}}}$。一个类似的 STS 应力张量，$T_{ij} = \\widehat{\\widetilde{u_i u_j}} - \\hat{\\tilde{u}}_i \\hat{\\tilde{u}}_j$，可以类似地建模，假设 Smagorinsky 形式在测试滤波器尺度上成立，其测试滤波器宽度为 $\\hat{\\Delta}$：\n$$ T_{ij}^{\\text{model}} = -2(C_s \\hat{\\Delta})^2 |\\hat{S}| \\hat{S}_{ij} = C_s^2 \\alpha_{ij} $$\n其中 $\\hat{S}_{ij}$ 是场 $\\hat{\\tilde{\\mathbf{u}}}$ 的应变率张量，且 $\\alpha_{ij} = -2 \\hat{\\Delta}^2 |\\hat{S}| \\hat{S}_{ij}$。\n\nGermano 恒等式为 $L_{ij} = T_{ij} - \\hat{\\tau}_{ij}$，其中 $L_{ij}$ 是解析湍流应力张量。它可以直接从解析速度场计算得出：\n$$ L_{ij} = \\widehat{\\tilde{u}_i \\tilde{u}_j} - \\hat{\\tilde{u}}_i \\hat{\\tilde{u}}_j $$\n将模型化的应力张量代入 Germano 恒等式，并假设 $C_s$ 足够恒定以至于可以移到测试滤波器之外，我们得到一个误差方程：\n$$ L_{ij} \\approx C_s^2 \\alpha_{ij} - \\widehat{C_s^2 \\beta_{ij}} \\approx C_s^2 (\\alpha_{ij} - \\hat{\\beta}_{ij}) $$\n令 $M_{ij} = \\alpha_{ij} - \\hat{\\beta}_{ij}$，我们有 $L_{ij} \\approx C_s^2 M_{ij}$。这个关于标量 $C_s^2$ 的超定系统通过对误差 $E_{ij} = L_{ij} - C_s^2 M_{ij}$ 的最小二乘最小化来求解。关于 $C_s^2$ 最小化 $E_{ij}E_{ij}$ 得到局部解：\n$$ C_s^2 = \\frac{L_{ij} M_{ij}}{M_{kl} M_{kl}} $$\n其中双点积意味着对所有指标求和（例如，$L_{ij}M_{ij} = \\sum_i\\sum_j L_{ij}M_{ij}$）。\n\n问题指定需要通过对所有网格单元上的局部估计进行平均，来找到一个单一的全局 $C_s^2$。为防止除以零，分母用一个小的数值 $\\epsilon=10^{-12}$ 进行正则化：\n$$ C_{s, \\text{global}}^2 = \\left\\langle \\frac{L_{ij} M_{ij}}{M_{kl} M_{kl} + \\epsilon} \\right\\rangle $$\n其中 $\\langle \\cdot \\rangle$ 表示对所有单元的空间平均。\n\n**数值实现**\n\n该算法在域 $[0, 2\\pi] \\times [0, 2\\pi]$ 上一个具有 $N_x=32$ 和 $N_y=32$ 个单元的均匀有限体积网格上实现。\n\n1.  **网格与场设置**：生成以单元为中心的网格坐标 $(x_i, y_j)$。在这些单元中心计算速度分量 $\\tilde{u}(x,y) = \\sin(x)\\cos(y)$ 和 $\\tilde{v}(x,y) = -\\cos(x)\\sin(y)$。滤波器宽度为 $\\Delta x = 2\\pi/N_x$, $\\Delta y = 2\\pi/N_y$, $\\Delta = \\sqrt{\\Delta x \\Delta y}$ 和 $\\hat{\\Delta} = 2\\Delta$。\n\n2.  **空间导数**：所有空间导数，如 $\\partial \\tilde{u}_i / \\partial x_j$，都使用二阶中心差分计算。周期性通过使用环绕域边界的相邻单元值来处理，这可以通过数组滚动操作高效实现。对于网格上的一个通用场 $\\phi$，其导数为：\n    $$ \\left(\\frac{\\partial \\phi}{\\partial x}\\right)_{i,j} = \\frac{\\phi_{i+1,j} - \\phi_{i-1,j}}{2\\Delta x}, \\quad \\left(\\frac{\\partial \\phi}{\\partial y}\\right)_{i,j} = \\frac{\\phi_{i,j+1} - \\phi_{i,j-1}}{2\\Delta y} $$\n\n3.  **基于面的测试滤波器**：这是分析网格质量影响的核心部分。对于任何以单元为中心的量 $\\phi$，在单元 `p` 处的测试滤波值 $\\hat{\\phi}$ 是插值到其四个面（东、西、南、北）的值的加权平均：$\\hat{\\phi}_p = \\frac{\\sum_f w_f \\, \\phi_f}{\\sum_f w_f}$。\n    -   单元 `p` 和相邻单元 `q` 之间的面上的面值 $\\phi_f$ 为 $\\phi_f = \\alpha \\phi_p + (1-\\alpha)\\phi_q$。\n    -   插值因子 $\\alpha$ 取决于面相对于单元 `p` 的位置和偏斜参数 $s$：对于东/北面，$\\alpha = 0.5+s$；对于西/南面，$\\alpha = 0.5-s$。\n    -   面权重 $w_f = A_f \\cos(\\theta)$ 取决于面面积（东/西面为 $A_f = \\Delta y$，南/北面为 $A_f = \\Delta x$）和统一的非正交性角度 $\\theta$。\n\n4.  **计算序列**：对于每个案例 $(s, \\theta)$：\n    a.  根据给定的 $\\tilde{\\mathbf{u}}$ 计算解析应变率张量分量 $S_{11}$、$S_{12}$、$S_{22}$ 及其模 $|S|$。\n    b.  计算张量 $\\beta_{ij} = -2\\Delta^2|S|S_{ij}$。\n    c.  应用基于面的测试滤波器以获得 $\\hat{\\tilde{u}}$、$\\hat{\\tilde{v}}$ 以及滤波后的速度乘积 $\\widehat{\\tilde{u}^2}$、$\\widehat{\\tilde{u}\\tilde{v}}$、$\\widehat{\\tilde{v}^2}$。\n    d.  从滤波后的场计算解析湍流应力张量分量 $L_{11}$、$L_{12}$、$L_{22}$。\n    e.  从测试滤波后的速度场 $\\hat{\\tilde{\\mathbf{u}}}$ 计算应变率张量 $\\hat{S}_{ij}$ 及其模 $|\\hat{S}|$。\n    f.  计算张量 $\\alpha_{ij} = -2\\hat{\\Delta}^2|\\hat{S}|\\hat{S}_{ij}$。\n    g.  对 $\\beta_{ij}$ 的分量应用测试滤波器以得到 $\\hat{\\beta}_{ij}$。\n    h.  形成张量 $M_{ij} = \\alpha_{ij} - \\hat{\\beta}_{ij}$。\n    i.  使用正则化的最小二乘公式计算整个网格上 $C_s^2$ 的局部值。\n    j.  通过对局部值求平均来计算最终的全局 $C_s^2$。\n\n对五个 $(s, \\theta)$ 对中的每一对执行此程序，并收集得到的全局 $C_s^2$ 值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the global dynamic Smagorinsky constant C_s^2 for a series of\n    test cases with varying mesh skewness and non-orthogonality.\n    \"\"\"\n    \n    test_cases = [\n        (0.0, 0.0),  # Case 1: Orthogonal baseline\n        (0.2, 20.0), # Case 2: Moderate skewness and non-orthogonality\n        (0.4, 40.0), # Case 3: High skewness and non-orthogonality\n        (0.3, 0.0),  # Case 4: Skewness only\n        (0.0, 30.0), # Case 5: Non-orthogonality only\n    ]\n\n    results = []\n    \n    for s, theta_deg in test_cases:\n        cs2_global = compute_global_cs2(s, theta_deg)\n        results.append(cs2_global)\n\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\n\ndef compute_global_cs2(s, theta_deg):\n    \"\"\"\n    Calculates the global C_s^2 for a given skewness s and non-orthogonality angle theta.\n    \"\"\"\n    # 1. Grid and Field Setup\n    Nx, Ny = 32, 32\n    Lx, Ly = 2 * np.pi, 2 * np.pi\n    dx, dy = Lx / Nx, Ly / Ny\n\n    x = np.linspace(dx / 2, Lx - dx / 2, Nx)\n    y = np.linspace(dy / 2, Ly - dy / 2, Ny)\n    xx, yy = np.meshgrid(x, y, indexing='xy')\n\n    u_tilde = np.sin(xx) * np.cos(yy)\n    v_tilde = -np.cos(xx) * np.sin(yy)\n    \n    delta = np.sqrt(dx * dy)\n    delta_hat = 2 * delta\n    \n    # 2. Spatial Derivatives Helper Functions\n    def deriv_x(f):\n        return (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2 * dx)\n\n    def deriv_y(f):\n        return (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2 * dy)\n\n    # 3. Face-Based Test Filter Helper Function\n    def test_filter(phi, s, theta_deg):\n        theta = np.deg2rad(theta_deg)\n        cos_theta = np.cos(theta)\n        \n        w_E = w_W = dy * cos_theta\n        w_N = w_S = dx * cos_theta\n        sum_w = 2 * w_E + 2 * w_N\n\n        phi_E = np.roll(phi, -1, axis=1)\n        phi_W = np.roll(phi, 1, axis=1)\n        phi_N = np.roll(phi, -1, axis=0)\n        phi_S = np.roll(phi, 1, axis=0)\n\n        alpha_E = alpha_N = 0.5 + s\n        alpha_W = alpha_S = 0.5 - s\n\n        f_E = alpha_E * phi + (1 - alpha_E) * phi_E\n        f_W = alpha_W * phi + (1 - alpha_W) * phi_W\n        f_N = alpha_N * phi + (1 - alpha_N) * phi_N\n        f_S = alpha_S * phi + (1 - alpha_S) * phi_S\n        \n        numerator = w_E * f_E + w_W * f_W + w_N * f_N + w_S * f_S\n        \n        # Avoid division by zero if sum_w is zero (e.g., theta=90 deg)\n        if abs(sum_w)  1e-15:\n            return np.zeros_like(phi)\n            \n        return numerator / sum_w\n\n    # 4a. Compute resolved strain-rate tensor S_ij and magnitude |S|\n    du_dx = deriv_x(u_tilde)\n    du_dy = deriv_y(u_tilde)\n    dv_dx = deriv_x(v_tilde)\n    dv_dy = deriv_y(v_tilde)\n\n    S11 = du_dx\n    S22 = dv_dy\n    S12 = 0.5 * (du_dy + dv_dx)\n    \n    S_mag_sq = 2 * (S11**2 + S22**2 + 2 * S12**2)\n    S_mag = np.sqrt(S_mag_sq)\n    \n    # 4b. Compute tensor beta_ij\n    beta_factor = -2 * delta**2 * S_mag\n    beta11 = beta_factor * S11\n    beta12 = beta_factor * S12\n    beta22 = beta_factor * S22\n    \n    # 4c. Apply test filter\n    u_tilde_hat = test_filter(u_tilde, s, theta_deg)\n    v_tilde_hat = test_filter(v_tilde, s, theta_deg)\n    \n    uu_hat = test_filter(u_tilde**2, s, theta_deg)\n    uv_hat = test_filter(u_tilde * v_tilde, s, theta_deg)\n    vv_hat = test_filter(v_tilde**2, s, theta_deg)\n    \n    # 4d. Compute resolved turbulent stress L_ij\n    L11 = uu_hat - u_tilde_hat**2\n    L12 = uv_hat - u_tilde_hat * v_tilde_hat\n    L22 = vv_hat - v_tilde_hat**2\n\n    # 4e. Compute test-filtered strain-rate hat(S)_ij and magnitude |hat(S)|\n    du_hat_dx = deriv_x(u_tilde_hat)\n    du_hat_dy = deriv_y(u_tilde_hat)\n    dv_hat_dx = deriv_x(v_tilde_hat)\n    dv_hat_dy = deriv_y(v_tilde_hat)\n    \n    S_hat_11 = du_hat_dx\n    S_hat_22 = dv_hat_dy\n    S_hat_12 = 0.5 * (du_hat_dy + dv_hat_dx)\n    \n    S_hat_mag_sq = 2 * (S_hat_11**2 + S_hat_22**2 + 2 * S_hat_12**2)\n    S_hat_mag = np.sqrt(S_hat_mag_sq)\n\n    # 4f. Compute tensor alpha_ij\n    alpha_factor = -2 * delta_hat**2 * S_hat_mag\n    alpha11 = alpha_factor * S_hat_11\n    alpha12 = alpha_factor * S_hat_12\n    alpha22 = alpha_factor * S_hat_22\n    \n    # 4g. Apply test filter to beta_ij\n    beta11_hat = test_filter(beta11, s, theta_deg)\n    beta12_hat = test_filter(beta12, s, theta_deg)\n    beta22_hat = test_filter(beta22, s, theta_deg)\n    \n    # 4h. Form tensor M_ij\n    M11 = alpha11 - beta11_hat\n    M12 = alpha12 - beta12_hat\n    M22 = alpha22 - beta22_hat\n    \n    # 4i. Calculate local C_s^2\n    Lij_Mij = L11*M11 + 2*L12*M12 + L22*M22\n    Mkl_Mkl = M11**2 + 2*M12**2 + M22**2\n    \n    local_cs2 = Lij_Mij / (Mkl_Mkl + 1e-12)\n    \n    # 4j. Compute global C_s^2 by averaging\n    global_cs2 = np.mean(local_cs2)\n    \n    return global_cs2\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}