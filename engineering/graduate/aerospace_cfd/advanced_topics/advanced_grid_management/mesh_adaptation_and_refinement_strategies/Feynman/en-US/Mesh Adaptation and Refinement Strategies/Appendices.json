{
    "hands_on_practices": [
        {
            "introduction": "A fundamental prerequisite for any mesh adaptation strategy is the ability to reliably quantify the error in a numerical solution. This practice introduces the Grid Convergence Index (GCI), a widely accepted method in the Verification and Validation (V&V) community for estimating the discretization error of a simulation. By systematically analyzing results from a sequence of refined meshes, you will learn to compute the observed order of accuracy, $p$, and use it to establish a confidence interval for your solution, providing a quantitative justification for further mesh refinement .",
            "id": "3975807",
            "problem": "A compressible inviscid airfoil computation in Computational Fluid Dynamics (CFD) is performed with three successively refined structured meshes characterized by grid spacings $h_1 > h_2 > h_3$ and a constant refinement ratio $r = h_1/h_2 = h_2/h_3$. For a scalar quantity of interest (QoI) $Q$, you obtain mesh-converged solutions $Q_1$, $Q_2$, and $Q_3$ on these grids, respectively. Assume the solution is in the asymptotic range, and the discretization error obeys the leading-order model $Q(h) = Q^{\\ast} + K h^{p} + \\mathcal{O}(h^{p+1})$, where $Q^{\\ast}$ is the exact QoI, $K$ is a nonzero constant, and $p$ is the observed order of accuracy. The three-grid sequence is monotone and single-signed.\n\nYou are given $Q_1 = 0.142$, $Q_2 = 0.138$, $Q_3 = 0.1365$, and $r = 2$. Using only these data and the asymptotic error model:\n\n1. From first principles, derive a formula to estimate the observed order $p$ from the three-grid data and the constant ratio $r$, and then compute its numerical value.\n2. Using the same asymptotic model, derive the two-grid Richardson extrapolation expression for $Q^{\\ast}$ in terms of $Q_3$, $Q_2$, $r$, and $p$, and compute the extrapolated value $Q_{\\text{ext}}$.\n3. Outline the standard steps to compute the fine-grid Grid Convergence Index (GCI) for the pair $(h_3, h_2)$, including the choice and role of a safety factor $F_s$, and then compute the numerical value of $\\text{GCI}_{32}$ using $F_s = 1.25$. Express $\\text{GCI}_{32}$ as a dimensionless decimal fraction.\n\nRound both the numerical value of $p$ and the numerical value of $\\text{GCI}_{32}$ to four significant figures. Provide your final answer as two numbers in the order ($p$, GCI$_{32}$).",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- A compressible inviscid airfoil computation in Computational Fluid Dynamics (CFD).\n- Three successively refined structured meshes with grid spacings $h_1 > h_2 > h_3$.\n- A constant refinement ratio $r = h_1/h_2 = h_2/h_3$.\n- Mesh-converged solutions for a scalar quantity of interest (QoI) $Q$: $Q_1$, $Q_2$, and $Q_3$.\n- Asymptotic error model: $Q(h) = Q^{\\ast} + K h^{p} + \\mathcal{O}(h^{p+1})$, where $Q^{\\ast}$ is the exact QoI, $K$ is a nonzero constant, and $p$ is the observed order of accuracy.\n- The three-grid sequence is monotone and single-signed.\n- Given data: $Q_1 = 0.142$, $Q_2 = 0.138$, $Q_3 = 0.1365$, and $r = 2$.\n- Tasks:\n  1. Derive and compute the observed order $p$.\n  2. Derive the Richardson extrapolation expression for $Q^{\\ast}$ and compute its value, $Q_{\\text{ext}}$.\n  3. Outline the steps for and compute the Grid Convergence Index $\\text{GCI}_{32}$ using a safety factor $F_s = 1.25$.\n- Rounding requirements: $p$ and $\\text{GCI}_{32}$ to four significant figures.\n- Final answer format: A row matrix containing the numerical values for $p$ and $\\text{GCI}_{32}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes a standard, widely accepted procedure for verification and validation in CFD, known as the Grid Convergence Index (GCI) method, which is based on Richardson extrapolation. The asymptotic error model is the fundamental assumption of this method. The procedure is well-documented in the scientific literature (e.g., by Roache, Celik, et al.).\n- **Well-Posed:** The problem provides all necessary data ($Q_1, Q_2, Q_3, r, F_s$) to uniquely determine the required quantities ($p$ and $\\text{GCI}_{32}$). The condition that the convergence is monotonic is met by the data ($0.142 > 0.138 > 0.1365$), which is a prerequisite for the standard application of the method.\n- **Objective:** The problem is stated in precise, technical language, free from subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, and complete. It is a valid problem in numerical methods and computational fluid dynamics. I will proceed with the solution.\n\nThe solution requires executing the three tasks specified in the problem statement.\n\n**1. Derivation and Computation of the Observed Order of Accuracy, $p$**\n\nThe solution is assumed to be in the asymptotic range, where the error is dominated by the leading term. The error model is given by $Q(h) \\approx Q^{\\ast} + K h^{p}$. We can write this expression for the three grids:\n$$Q_1 \\approx Q^{\\ast} + K h_1^{p}$$\n$$Q_2 \\approx Q^{\\ast} + K h_2^{p}$$\n$$Q_3 \\approx Q^{\\ast} + K h_3^{p}$$\nTo eliminate the unknown exact solution $Q^{\\ast}$, we take the differences between solutions on successive grids:\n$$Q_1 - Q_2 \\approx K (h_1^p - h_2^p)$$\n$$Q_2 - Q_3 \\approx K (h_2^p - h_3^p)$$\nNext, we take the ratio of these differences to eliminate the unknown constant $K$:\n$$\\frac{Q_1 - Q_2}{Q_2 - Q_3} \\approx \\frac{h_1^p - h_2^p}{h_2^p - h_3^p}$$\nUsing the constant grid refinement ratio, $r = h_1/h_2 = h_2/h_3$, we can express $h_1$ and $h_3$ in terms of $h_2$: $h_1 = r h_2$ and $h_3 = h_2/r$. Substituting these into the ratio:\n$$\\frac{Q_1 - Q_2}{Q_2 - Q_3} \\approx \\frac{(r h_2)^p - h_2^p}{h_2^p - (h_2/r)^p} = \\frac{h_2^p (r^p - 1)}{h_2^p (1 - r^{-p})} = \\frac{r^p - 1}{(r^p - 1)/r^p} = r^p$$\nThis provides the formula for $p$. To solve for $p$, we take the natural logarithm of both sides:\n$$\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right) \\approx p \\ln(r)$$\nThus, the derived formula for the observed order of accuracy is:\n$$p \\approx \\frac{\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)}{\\ln(r)}$$\nNow, we substitute the given numerical values: $Q_1 = 0.142$, $Q_2 = 0.138$, $Q_3 = 0.1365$, and $r = 2$.\n$$p \\approx \\frac{\\ln\\left(\\frac{0.142 - 0.138}{0.138 - 0.1365}\\right)}{\\ln(2)} = \\frac{\\ln\\left(\\frac{0.004}{0.0015}\\right)}{\\ln(2)} = \\frac{\\ln(8/3)}{\\ln(2)}$$\nComputing the numerical value:\n$$p \\approx \\frac{0.980829253}{0.693147181} \\approx 1.415037499$$\nRounding to four significant figures, we get $p \\approx 1.415$.\n\n**2. Derivation and Computation of the Richardson Extrapolation, $Q_{\\text{ext}}$**\n\nWe use the two finest grid solutions, $Q_2$ and $Q_3$, to find the extrapolated value, which we denote as $Q_{\\text{ext}}$. The model gives:\n$$Q_2 \\approx Q_{\\text{ext}} + K h_2^{p}$$\n$$Q_3 \\approx Q_{\\text{ext}} + K h_3^{p}$$\nUsing $h_2 = r h_3$, the first equation becomes $Q_2 \\approx Q_{\\text{ext}} + K (r h_3)^{p} = Q_{\\text{ext}} + K r^p h_3^p$. To eliminate $K$, we multiply the second equation by $r^p$:\n$$r^p Q_3 \\approx r^p Q_{\\text{ext}} + K r^p h_3^p$$\nSubtracting the expression for $Q_2$ from this yields:\n$$r^p Q_3 - Q_2 \\approx (r^p Q_{\\text{ext}} - Q_{\\text{ext}}) = Q_{\\text{ext}}(r^p - 1)$$\nSolving for $Q_{\\text{ext}}$, we derive the two-grid Richardson extrapolation formula:\n$$Q_{\\text{ext}} = \\frac{r^p Q_3 - Q_2}{r^p - 1}$$\nThis can be rewritten to show the correction to the fine-grid solution:\n$$Q_{\\text{ext}} = Q_3 + \\frac{Q_3 - Q_2}{r^p - 1}$$\nWe compute the numerical value of $Q_{\\text{ext}}$ using the exact ratio $r^p = 8/3$ from the previous step, along with $Q_2 = 0.138$ and $Q_3 = 0.1365$:\n$$Q_{\\text{ext}} = 0.1365 + \\frac{0.1365 - 0.138}{(8/3) - 1} = 0.1365 + \\frac{-0.0015}{5/3} = 0.1365 - (0.0015 \\times \\frac{3}{5}) = 0.1365 - 0.0009 = 0.1356$$\nSo, the extrapolated value is $Q_{\\text{ext}} = 0.1356$.\n\n**3. Grid Convergence Index ($\\text{GCI}_{32}$)**\n\nThe Grid Convergence Index (GCI) provides a measure of the uncertainty of the fine-grid solution due to discretization error. The standard steps to compute the fine-grid GCI for the pair $(h_3, h_2)$, denoted $\\text{GCI}_{32}$, are as follows:\n- **Step A:** Compute the apparent order of accuracy, $p$, using the three-grid solution data. This was completed in Part 1.\n- **Step B:** Compute the relative difference between the two finest grid solutions, $Q_2$ and $Q_3$. The standard formulation normalizes by the fine-grid solution:\n  $$e_{a,32} = \\left| \\frac{Q_3 - Q_2}{Q_3} \\right|$$\n- **Step C:** Apply the GCI formula, which scales this relative difference by a factor that includes the safety factor $F_s$ and the refinement ratio $r$ raised to the power $p$:\n  $$\\text{GCI}_{32} = \\frac{F_s |e_{a,32}|}{r^p - 1} = \\frac{F_s}{r^p - 1} \\left| \\frac{Q_3 - Q_2}{Q_3} \\right|$$\nThe safety factor $F_s$ accounts for the fact that the solution may not be perfectly in the asymptotic range. A value of $F_s = 1.25$ is recommended when the observed order $p$ is close to the formal order of the scheme, and $F_s=3$ is used when $p$ is not well-determined or varies significantly. Here, $F_s=1.25$ is given.\n\nNow we compute the numerical value of $\\text{GCI}_{32}$ using the given data and intermediate results:\n$F_s = 1.25$, $r^p = 8/3$, $Q_2 = 0.138$, $Q_3 = 0.1365$.\n$$\\text{GCI}_{32} = \\frac{1.25}{(8/3) - 1} \\left| \\frac{0.1365 - 0.138}{0.1365} \\right| = \\frac{1.25}{5/3} \\left| \\frac{-0.0015}{0.1365} \\right|$$\n$$\\text{GCI}_{32} = (1.25 \\times \\frac{3}{5}) \\left(\\frac{0.0015}{0.1365}\\right) = 0.75 \\times \\frac{15}{1365} = 0.75 \\times \\frac{1}{91}$$\nComputing the final numerical value:\n$$\\text{GCI}_{32} \\approx 0.00824175824$$\nAs a dimensionless decimal fraction, and rounding to four significant figures, we get $\\text{GCI}_{32} \\approx 0.008242$. This value implies an estimated uncertainty of approximately $0.82\\%$ in the fine-grid solution $Q_3$.\n\nThe final requested values are $p$ and $\\text{GCI}_{32}$, rounded to four significant figures.\n$p \\approx 1.415$\n$\\text{GCI}_{32} \\approx 0.008242$",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.415 & 0.008242 \\end{pmatrix}}$$"
        },
        {
            "introduction": "After establishing that refinement is necessary, the next challenge is to decide precisely *which* elements to refine to maximize accuracy improvement while minimizing computational cost. This exercise moves from global error estimation to the practical application of a local, indicator-based marking strategy, where an error indicator $\\eta_{K}$ is computed for each element $K$. You will navigate a realistic scenario that involves prioritizing elements with high error indicators while adhering to strict budgetary and physical constraints, a common task in production-level CFD .",
            "id": "3975794",
            "problem": "Consider a steady compressible flow simulation around a slender aerospace vehicle using Computational Fluid Dynamics (CFD). The finite volume discretization on an unstructured tetrahedral mesh produces a non-negative elementwise residual-based error indicator $\\eta_K$ for each element $K$. A constrained marking strategy is desired for mesh adaptation such that, at each cycle, only a fraction $\\beta$ of the total elements are tagged for refinement to respect a memory budget.\n\nAssume the following scientifically consistent setting:\n\n- The mesh has $M=2.5\\times 10^{5}$ elements.\n- The error indicator field $\\{\\eta_K\\}$ is distributed as a mixture representing shock and smooth regions:\n  - With probability $p_h=0.3$, an element is in a high-gradient/shock-affected region with $\\eta_K$ uniformly distributed on $[0.6,1.0]$.\n  - With probability $p_c=0.7$, an element is in a smooth region with $\\eta_K$ uniformly distributed on $[0.0,0.5]$.\n- An empirical anisotropy measure $a_K$ correlates monotonically with unresolved directional gradients via $a_K=1+4\\,(1-\\eta_K)$. The refinement constraint requires $a_K\\leq 3$, which implies $\\eta_K\\geq 0.5$.\n- A shock sensor $s_K\\in\\{0,1\\}$ filters out spurious refinement in smooth regions; it flags $s_K=1$ precisely on the high-gradient component of the mixture (the $p_h$ portion).\n- The memory budget is $\\beta=0.12$, meaning at most the fraction $\\beta$ of elements may be refined in a single cycle.\n- The prioritization scheme must satisfy both constraints ($a_K\\leq 3$ and $s_K=1$), and then rank eligible elements by descending $\\eta_K$, selecting the largest values until the budget is met.\n\nStarting from the core definitions of error indicators and the constrained marking approach described above, determine the number of elements to refine in one cycle under this scheme, and provide the result as an integer count. No rounding is required. Your final answer must be a single real-valued number.",
            "solution": "The problem is found to be scientifically grounded, well-posed, and self-contained. All provided data are consistent and sufficient for arriving at a unique solution. The problem statement describes a standard procedure in computational fluid dynamics (CFD) for adaptive mesh refinement, and a solution can be derived through a rigorous, step-by-step logical deduction.\n\nThe task is to determine the number of elements to be refined in a single mesh adaptation cycle. This number depends on two factors: the set of elements eligible for refinement based on physical criteria, and the memory budget that constrains the total number of refined elements.\n\nFirst, we must identify the criteria that an element $K$ must satisfy to be considered eligible for refinement. The problem specifies two constraints:\n1.  An anisotropy constraint: $a_K \\leq 3$.\n2.  A shock sensor constraint: $s_K = 1$.\n\nLet us analyze the first constraint. The anisotropy measure $a_K$ is given by the empirical relation $a_K = 1 + 4(1 - \\eta_K)$. Substituting this into the inequality gives:\n$$1 + 4(1 - \\eta_K) \\leq 3$$\n$$4(1 - \\eta_K) \\leq 2$$\n$$1 - \\eta_K \\leq \\frac{1}{2}$$\n$$\\eta_K \\geq \\frac{1}{2}$$\nSo, the first constraint requires the element's error indicator $\\eta_K$ to be at least $0.5$.\n\nThe second constraint requires the shock sensor $s_K$ to be equal to $1$. The problem states that $s_K=1$ \"precisely on the high-gradient component of the mixture\". This means that only elements from the high-gradient population are candidates for refinement.\n\nNow, we must determine which elements satisfy both constraints simultaneously. The total population of $M = 2.5 \\times 10^5$ elements is described by a mixture model with two components:\n\n- **Smooth region population**: This group constitutes a fraction $p_c = 0.7$ of the total elements. For these elements, the error indicator $\\eta_K$ is uniformly distributed on the interval $[0.0, 0.5]$. By definition, the shock sensor for this population is $s_K = 0$. Since this violates the second constraint ($s_K=1$), no element from the smooth region is eligible for refinement.\n\n- **High-gradient/shock-affected population**: This group constitutes a fraction $p_h = 0.3$ of the total elements. For these elements, the error indicator $\\eta_K$ is uniformly distributed on the interval $[0.6, 1.0]$. The shock sensor for this population is $s_K = 1$, which satisfies the second constraint. We must also check if these elements satisfy the first constraint, $\\eta_K \\geq 0.5$. Since the range of $\\eta_K$ for this population is $[0.6, 1.0]$, every value within this range is greater than $0.5$. Therefore, all elements in the high-gradient population satisfy both constraints.\n\nFrom this analysis, we conclude that the set of elements eligible for refinement is exactly the set of all elements belonging to the high-gradient population. We can calculate the total number of such elements, denoted $N_{\\text{eligible}}$:\n$$N_{\\text{eligible}} = p_h \\times M$$\nSubstituting the given values, $p_h = 0.3$ and $M = 2.5 \\times 10^5$:\n$$N_{\\text{eligible}} = 0.3 \\times (2.5 \\times 10^5) = 75000$$\nThere are $75000$ elements eligible for refinement.\n\nNext, we consider the memory budget. The problem states that at most a fraction $\\beta = 0.12$ of the total elements may be refined in a single cycle. This imposes an upper limit on the number of elements that can be refined, which we denote as $N_{\\text{budget}}$:\n$$N_{\\text{budget}} = \\beta \\times M$$\nSubstituting the given values, $\\beta = 0.12$ and $M = 2.5 \\times 10^5$:\n$$N_{\\text{budget}} = 0.12 \\times 250000 = 30000$$\nThe memory budget allows for a maximum of $30000$ elements to be refined.\n\nThe refinement strategy is to select elements from the eligible set, starting with those having the highest values of $\\eta_K$, until the budget is exhausted. The number of elements to be refined, $N_{\\text{refine}}$, is therefore the minimum of the number of eligible elements and the number imposed by the budget constraint.\n$$N_{\\text{refine}} = \\min(N_{\\text{eligible}}, N_{\\text{budget}})$$\n$$N_{\\text{refine}} = \\min(75000, 30000)$$\n$$N_{\\text{refine}} = 30000$$\n\nThus, in one cycle, $30000$ elements will be marked for refinement. These would be the $30000$ elements from the high-gradient population with the largest error indicators $\\eta_K$.",
            "answer": "$$\\boxed{30000}$$"
        },
        {
            "introduction": "Executing a mesh adaptation cycle involves more than just identifying target cells; it requires carefully transferring the flow solution from the old mesh to the new one. The physical integrity of the simulation hinges on this transfer process being conservative—that is, perfectly preserving quantities like mass, momentum, and energy. This problem provides a crucial hands-on demonstration of this principle by asking you to quantify the unphysical mass loss that occurs with a naive, non-conservative interpolation scheme, thereby underscoring the necessity of conservative remapping in any adaptive simulation framework .",
            "id": "3975819",
            "problem": "Consider one-dimensional scalar advection in Computational Fluid Dynamics (CFD), governed by the conservation law $\\partial q/\\partial t + a\\,\\partial q/\\partial x = 0$ on the domain $x \\in [0,1]$ with $a>0$. Global mass $M(t) = \\int_{0}^{1} q(x,t)\\,dx$ is invariant under advection with appropriate boundary treatment. You will examine the effect of a mesh adaptation cycle on this invariance by comparing a non-conservative interpolation against a conservative remap, using a standard scalar advection test field.\n\nLet the initial condition be the top-hat field $q(x,0) = 1$ for $x \\in [0.05,0.28]$ and $q(x,0) = 0$ elsewhere. The initial computational mesh is a uniform coarse grid of $N_c = 4$ cells, each of width $h_c = 0.25$, with cell centers at $x_1 = 0.125$, $x_2 = 0.375$, $x_3 = 0.625$, and $x_4 = 0.875$. Define one adaptation cycle as: refine every coarse cell into two equal fine cells (each of width $h_f = h_c/2$), perform a grid-to-grid interpolation from the coarse representation to the fine representation, and then immediately coarsen back to the original coarse grid representation without any time advancement.\n\nUse the following mesh-to-mesh transfer rules:\n\n- Non-conservative interpolation: Construct a piecewise-linear function by linearly interpolating $q$ between adjacent coarse cell centers. At the physical boundaries, impose Dirichlet values $q(0) = 0$ and $q(1) = 0$ for the interpolation. Define the value on each fine half-cell of a coarse cell as the average integral of this linear interpolant over that half-cell (i.e., use the exact integral of the interpolant over each fine half-cell). When coarsening back, define the coarse cell value as the average of its two fine half-cells (i.e., an $L^1$ average of the fine representation over the coarse cell).\n\n- Conservative remap: Transfer from coarse to fine by subdividing each coarse cell’s mass exactly into its two fine half-cells so that the sum of fine half-cell masses equals the original coarse cell mass. When coarsening back, use an exact average over the two fine half-cells so that the coarse cell mass is unchanged.\n\nStarting from first principles of conservation, compute the signed fractional change in total mass introduced by the non-conservative interpolation after one adaptation cycle, defined as\n$$\\Delta = \\frac{M_{\\text{after}} - M_{\\text{before}}}{M_{\\text{before}}}.$$\nRound your answer to four significant figures and express it as a decimal without units. Also, qualitatively compare this to the conservative remap in terms of mass change, but provide only the numerical value of $\\Delta$ as your final answer.",
            "solution": "The problem asks for the signed fractional change in total mass, $\\Delta$, after one mesh adaptation cycle using a non-conservative interpolation scheme. The cycle consists of refining a coarse grid to a fine grid, transferring the data non-conservatively, and then coarsening back to the original grid.\n\nFirst, we must establish the initial state of the system on the coarse grid. The initial condition is a top-hat function:\n$$q(x,0) = \\begin{cases} 1 & \\text{if } x \\in [0.05, 0.28] \\\\ 0 & \\text{otherwise} \\end{cases}$$\nThe total mass in the system, $M_{\\text{before}}$, is the integral of this function over the domain $x \\in [0, 1]$:\n$$M_{\\text{before}} = \\int_{0}^{1} q(x,0) \\,dx = \\int_{0.05}^{0.28} 1 \\,dx = 0.28 - 0.05 = 0.23$$\nThe initial computational mesh is a uniform coarse grid of $N_c = 4$ cells, each of width $h_c = 0.25$. The cell boundaries are at $x = \\{0, 0.25, 0.5, 0.75, 1.0\\}$. The cell centers are at $x_1 = 0.125$, $x_2 = 0.375$, $x_3 = 0.625$, and $x_4 = 0.875$.\n\nThe cell-averaged value for a cell $i$, denoted $Q_i$, is defined as $Q_i = \\frac{1}{h_c} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,0) \\,dx$.\nFor cell $1$ ($x \\in [0, 0.25]$):\n$$Q_1 = \\frac{1}{0.25} \\int_{0}^{0.25} q(x,0) \\,dx = \\frac{1}{0.25} \\int_{0.05}^{0.25} 1 \\,dx = \\frac{0.25 - 0.05}{0.25} = \\frac{0.20}{0.25} = 0.8$$\nFor cell $2$ ($x \\in [0.25, 0.5]$):\n$$Q_2 = \\frac{1}{0.25} \\int_{0.25}^{0.5} q(x,0) \\,dx = \\frac{1}{0.25} \\int_{0.25}^{0.28} 1 \\,dx = \\frac{0.28 - 0.25}{0.25} = \\frac{0.03}{0.25} = 0.12$$\nFor cell $3$ ($x \\in [0.5, 0.75]$) and cell $4$ ($x \\in [0.75, 1.0]$), the integral of $q(x,0)$ is zero, so $Q_3 = 0$ and $Q_4 = 0$.\nThe initial coarse-grid representation is the vector of cell averages $Q_c = (0.8, 0.12, 0, 0)$. The discrete total mass is $\\sum_{i=1}^{4} Q_i h_c = (0.8 + 0.12 + 0 + 0) \\times 0.25 = 0.92 \\times 0.25 = 0.23$, which correctly matches $M_{\\text{before}}$.\n\nThe adaptation cycle begins with refining each coarse cell into two fine cells of width $h_f = h_c/2 = 0.125$. This creates a fine grid of $N_f = 8$ cells.\nNext, we perform the non-conservative interpolation. A piecewise-linear function, $q_{PL}(x)$, is constructed connecting the values at the coarse cell centers. The problem specifies Dirichlet boundary conditions $q(0)=0$ and $q(1)=0$. This gives us the following points to connect:\n$P_0 = (0, 0)$\n$P_1 = (x_1, Q_1) = (0.125, 0.8)$\n$P_2 = (x_2, Q_2) = (0.375, 0.12)$\n$P_3 = (x_3, Q_3) = (0.625, 0)$\n$P_4 = (x_4, Q_4) = (0.875, 0)$\n$P_5 = (1, 0)$\n\nThe value in each fine cell, $Q_{f,j}$, is the average integral of $q_{PL}(x)$ over that fine cell's domain. Since $q_{PL}(x)$ is linear on each segment, the average value over any interval within that segment is the arithmetic mean of the function's values at the interval's endpoints.\nThe fine cells are indexed $j=1, \\dots, 8$:\n- **Fine cells 1 & 2 (within coarse cell 1):** These lie in the linear segments $P_0P_1$ and $P_1P_2$.\n  - Fine cell 1 ($j=1$, $x \\in [0, 0.125]$): This is the domain of segment $P_0P_1$. The values at the endpoints are $q_{PL}(0)=0$ and $q_{PL}(0.125)=0.8$.\n    $$Q_{f,1} = \\frac{q_{PL}(0) + q_{PL}(0.125)}{2} = \\frac{0 + 0.8}{2} = 0.4$$\n  - Fine cell 2 ($j=2$, $x \\in [0.125, 0.25]$): This is part of segment $P_1P_2$. We need the value of $q_{PL}(x)$ at $x=0.25$.\n    The slope of segment $P_1P_2$ is $m_{12} = \\frac{0.12 - 0.8}{0.375 - 0.125} = \\frac{-0.68}{0.25} = -2.72$.\n    $q_{PL}(0.25) = Q_1 + m_{12}(0.25 - x_1) = 0.8 + (-2.72)(0.25 - 0.125) = 0.8 - 0.34 = 0.46$.\n    The values at the endpoints are $q_{PL}(0.125)=0.8$ and $q_{PL}(0.25)=0.46$.\n    $$Q_{f,2} = \\frac{q_{PL}(0.125) + q_{PL}(0.25)}{2} = \\frac{0.8 + 0.46}{2} = 0.63$$\n- **Fine cells 3 & 4 (within coarse cell 2):** These lie in segments $P_1P_2$ and $P_2P_3$.\n  - Fine cell 3 ($j=3$, $x \\in [0.25, 0.375]$): This is the rest of segment $P_1P_2$. The values are $q_{PL}(0.25)=0.46$ and $q_{PL}(0.375)=0.12$.\n    $$Q_{f,3} = \\frac{q_{PL}(0.25) + q_{PL}(0.375)}{2} = \\frac{0.46 + 0.12}{2} = 0.29$$\n  - Fine cell 4 ($j=4$, $x \\in [0.375, 0.5]$): This is part of segment $P_2P_3$. We need $q_{PL}(0.5)$.\n    The slope of segment $P_2P_3$ is $m_{23} = \\frac{0 - 0.12}{0.625 - 0.375} = \\frac{-0.12}{0.25} = -0.48$.\n    $q_{PL}(0.5) = Q_2 + m_{23}(0.5 - x_2) = 0.12 + (-0.48)(0.5 - 0.375) = 0.12 - 0.06 = 0.06$.\n    The values are $q_{PL}(0.375)=0.12$ and $q_{PL}(0.5)=0.06$.\n    $$Q_{f,4} = \\frac{q_{PL}(0.375) + q_{PL}(0.5)}{2} = \\frac{0.12 + 0.06}{2} = 0.09$$\n- **Fine cells 5 & 6 (within coarse cell 3):** These lie in segment $P_2P_3$ and $P_3P_4$.\n  - Fine cell 5 ($j=5$, $x \\in [0.5, 0.625]$): This is the rest of segment $P_2P_3$. The values are $q_{PL}(0.5)=0.06$ and $q_{PL}(0.625)=0$.\n    $$Q_{f,5} = \\frac{q_{PL}(0.5) + q_{PL}(0.625)}{2} = \\frac{0.06 + 0}{2} = 0.03$$\n  - Fine cell 6 ($j=6$, $x \\in [0.625, 0.75]$): Segment $P_3P_4$ is on the line $y=0$. So $Q_{f,6}=0$.\n- **Fine cells 7 & 8 (within coarse cell 4):** Segments $P_3P_4$ and $P_4P_5$ are on the line $y=0$. So $Q_{f,7}=0$ and $Q_{f,8}=0$.\n\nThe fine-grid representation is $Q_f = (0.4, 0.63, 0.29, 0.09, 0.03, 0, 0, 0)$.\nThe total mass on the fine grid, $M_{\\text{fine}}$, is the sum of the masses in each fine cell:\n$$M_{\\text{fine}} = \\sum_{j=1}^{8} Q_{f,j} h_f = 0.125 \\times (0.4 + 0.63 + 0.29 + 0.09 + 0.03 + 0 + 0 + 0) = 0.125 \\times 1.44 = 0.18$$\nThis interpolation step is non-conservative, as $M_{\\text{fine}} = 0.18 \\neq M_{\\text{before}} = 0.23$.\n\nThe final step of the cycle is to coarsen back to the original grid. The new coarse cell value, $Q'_i$, is the average of its two constituent fine-cell values.\n$Q'_1 = \\frac{Q_{f,1} + Q_{f,2}}{2} = \\frac{0.4 + 0.63}{2} = 0.515$\n$Q'_2 = \\frac{Q_{f,3} + Q_{f,4}}{2} = \\frac{0.29 + 0.09}{2} = 0.19$\n$Q'_3 = \\frac{Q_{f,5} + Q_{f,6}}{2} = \\frac{0.03 + 0}{2} = 0.015$\n$Q'_4 = \\frac{Q_{f,7} + Q_{f,8}}{2} = \\frac{0 + 0}{2} = 0$\nThe final coarse grid representation is $Q'_c = (0.515, 0.19, 0.015, 0)$.\nThe total mass after the cycle, $M_{\\text{after}}$, is:\n$$M_{\\text{after}} = \\sum_{i=1}^{4} Q'_i h_c = 0.25 \\times (0.515 + 0.19 + 0.015 + 0) = 0.25 \\times 0.72 = 0.18$$\nAs expected, the coarsening step (a simple averaging) is conservative with respect to the fine grid representation, so $M_{\\text{after}} = M_{\\text{fine}}$.\n\nFinally, we compute the signed fractional change in total mass, $\\Delta$:\n$$\\Delta = \\frac{M_{\\text{after}} - M_{\\text{before}}}{M_{\\text{before}}} = \\frac{0.18 - 0.23}{0.23} = \\frac{-0.05}{0.23} \\approx -0.2173913...$$\nRounding to four significant figures, we get $\\Delta \\approx -0.2174$.\n\nFor qualitative comparison, a conservative remap is designed to prevent this mass change. In a conservative scheme, the total mass in each coarse cell would be exactly distributed to its child fine cells, preserving mass during refinement. Similarly, coarsening would sum the mass from child cells, also preserving mass. Therefore, for the conservative remap, $M_{\\text{after}} = M_{\\text{before}}$, and the fractional change $\\Delta$ would be exactly $0$. The non-conservative linear interpolation, by contrast, created a mass loss of over $21\\%$.",
            "answer": "$$\\boxed{-0.2174}$$"
        }
    ]
}