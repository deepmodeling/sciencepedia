{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering the Geometric Conservation Law (GCL) is to understand its most direct, differential form. This principle states that the instantaneous rate of change of a control volume's size is precisely equal to the net flux of the grid velocity across its boundaries. This exercise  provides a concrete opportunity to apply this law, translating the abstract GCL integral, $\\dot{V} = \\oint \\boldsymbol{v}_g \\cdot d\\boldsymbol{A}$, into a practical sum over the faces of a three-dimensional cell.",
            "id": "3962113",
            "problem": "Consider a single moving hexahedral control volume in Computational Fluid Dynamics (CFD) under the Geometric Conservation Law (GCL). The vertices are labeled $\\mathbf{x}_{i}(t)$ for $i=1,\\dots,8$, and at time $t=0$ they form a rectangular box with edge lengths $L_{x}=2$, $L_{y}=3$, and $L_{z}=4$ meters, aligned with the coordinate axes. Specifically, the vertex positions at $t=0$ are\n$$\n\\mathbf{x}_{1}=(0,0,0),\\quad \\mathbf{x}_{2}=(2,0,0),\\quad \\mathbf{x}_{3}=(2,3,0),\\quad \\mathbf{x}_{4}=(0,3,0),\n$$\n$$\n\\mathbf{x}_{5}=(0,0,4),\\quad \\mathbf{x}_{6}=(2,0,4),\\quad \\mathbf{x}_{7}=(2,3,4),\\quad \\mathbf{x}_{8}=(0,3,4).\n$$\nThe vertices move with a grid velocity that is affine in space, given at $t=0$ by\n$$\n\\mathbf{v}_{i}=\\mathbf{b}+\\alpha\\,\\mathbf{x}_{i},\\qquad \\mathbf{b}=(0.2,-0.1,0.05)\\ \\text{m/s},\\quad \\alpha=0.05\\ \\text{s}^{-1}.\n$$\nFaces are taken with outward orientation. For each of the six quadrilateral faces, construct the oriented area vector $\\mathbf{A}_{f}(0)$ at $t=0$ using a triangulation of the face into two triangles with a fixed local reference vertex on the face, and the associated cross product construction of triangle area vectors. Then, using only the vertex velocities and these face area vectors, derive from first principles the time derivative of the control volume $\\dot{V}(0)$ implied by the GCL kinematics for this moving grid.\n\nExpress your final $\\dot{V}(0)$ in cubic meters per second. Round your answer to four significant figures.",
            "solution": "The problem is well-posed, scientifically grounded, and internally consistent, establishing it as a valid problem in computational fluid dynamics. We will proceed with a full derivation.\n\nThe time derivative of a control volume $V(t)$ with a boundary surface $\\partial V(t)$ moving with a grid velocity field $\\mathbf{v}_g(\\mathbf{x},t)$ is given by the Geometric Conservation Law (GCL). The integral form of the GCL states that the rate of change of the volume is equal to the flux of the grid velocity through the boundary of the volume:\n$$ \\frac{dV}{dt} = \\int_{\\partial V} \\mathbf{v}_g \\cdot d\\mathbf{A} $$\nFor a discrete hexahedral control volume, this integral becomes a sum over its six faces, denoted by the index $f$:\n$$ \\dot{V}(t) = \\frac{dV}{dt} = \\sum_{f=1}^{6} \\int_{A_f} \\mathbf{v}_g(\\mathbf{x}, t) \\cdot d\\mathbf{A}_f $$\nwhere $A_f$ is the area of face $f$ and $d\\mathbf{A}_f$ is the outward-pointing differential area vector.\n\nThe problem specifies an affine grid velocity field at time $t=0$:\n$$ \\mathbf{v}_g(\\mathbf{x}) = \\mathbf{b} + \\alpha \\mathbf{x} $$\nwhere $\\mathbf{b} = (0.2, -0.1, 0.05) \\, \\text{m/s}$ and $\\alpha = 0.05 \\, \\text{s}^{-1}$ are constants.\n\nSubstituting the velocity field into the flux expression for a single face $f$:\n$$ \\int_{A_f} \\mathbf{v}_g \\cdot d\\mathbf{A}_f = \\int_{A_f} (\\mathbf{b} + \\alpha \\mathbf{x}) \\cdot d\\mathbf{A}_f = \\int_{A_f} \\mathbf{b} \\cdot d\\mathbf{A}_f + \\int_{A_f} \\alpha \\mathbf{x} \\cdot d\\mathbf{A}_f $$\nSince $\\mathbf{b}$ and $\\alpha$ are constant, we can move them outside the integrals:\n$$ \\int_{A_f} \\mathbf{v}_g \\cdot d\\mathbf{A}_f = \\mathbf{b} \\cdot \\int_{A_f} d\\mathbf{A}_f + \\alpha \\int_{A_f} \\mathbf{x} \\cdot d\\mathbf{A}_f $$\nThe first integral is simply the face area vector, $\\mathbf{A}_f = \\int_{A_f} d\\mathbf{A}_f$.\nFor the second integral, we note that at $t=0$, each face of the hexahedron is a planar quadrilateral. For a planar face, $d\\mathbf{A}_f = \\mathbf{n}_f dA_f$, where $\\mathbf{n}_f$ is the constant unit normal vector. The position vector of the face centroid is defined as $\\mathbf{x}_{c,f} = \\frac{1}{|A_f|} \\int_{A_f} \\mathbf{x} \\, dA_f$. The integral becomes:\n$$ \\int_{A_f} \\mathbf{x} \\cdot d\\mathbf{A}_f = \\int_{A_f} (\\mathbf{x} \\cdot \\mathbf{n}_f) \\, dA_f $$\nFor a planar face, the term $\\mathbf{x} \\cdot \\mathbf{n}_f$ is constant for all points $\\mathbf{x}$ on the face. Let this constant be $d_f$. Thus, $d_f = \\mathbf{x}_{c,f} \\cdot \\mathbf{n}_f$. The integral simplifies to:\n$$ (\\mathbf{x}_{c,f} \\cdot \\mathbf{n}_f) \\int_{A_f} dA_f = (\\mathbf{x}_{c,f} \\cdot \\mathbf{n}_f) |A_f| = \\mathbf{x}_{c,f} \\cdot (|A_f| \\mathbf{n}_f) = \\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f $$\nTherefore, the flux through a single face is given exactly by:\n$$ \\int_{A_f} \\mathbf{v}_g \\cdot d\\mathbf{A}_f = \\mathbf{b} \\cdot \\mathbf{A}_f + \\alpha (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) = (\\mathbf{b} + \\alpha \\mathbf{x}_{c,f}) \\cdot \\mathbf{A}_f $$\nSumming over all six faces to find the total rate of volume change:\n$$ \\dot{V}(0) = \\sum_{f=1}^{6} (\\mathbf{b} \\cdot \\mathbf{A}_f + \\alpha (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f)) = \\mathbf{b} \\cdot \\left(\\sum_{f=1}^{6} \\mathbf{A}_f\\right) + \\alpha \\sum_{f=1}^{6} (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) $$\nFor any closed volume, the sum of the outward-pointing face area vectors is zero, $\\sum_{f=1}^{6} \\mathbf{A}_f = \\mathbf{0}$. This means the purely translational part of the velocity field, $\\mathbf{b}$, does not contribute to a change in volume. The expression for $\\dot{V}(0)$ simplifies to:\n$$ \\dot{V}(0) = \\alpha \\sum_{f=1}^{6} (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) $$\nWe now compute the necessary geometric quantities for the hexahedron at $t=0$. The edge lengths are $L_x=2$, $L_y=3$, and $L_z=4$ meters.\n\n1.  **Face 1 (bottom, $z=0$):**\n    Vertices $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3, \\mathbf{x}_4$. Outward normal is in the $-z$ direction.\n    $\\mathbf{A}_1 = (0, 0, -L_x L_y) = (0, 0, -6) \\, \\text{m}^2$.\n    Centroid $\\mathbf{x}_{c,1} = (\\frac{L_x}{2}, \\frac{L_y}{2}, 0) = (1, 1.5, 0) \\, \\text{m}$.\n    $\\mathbf{x}_{c,1} \\cdot \\mathbf{A}_1 = (1, 1.5, 0) \\cdot (0, 0, -6) = 0$.\n\n2.  **Face 2 (top, $z=L_z=4$):**\n    Vertices $\\mathbf{x}_5, \\mathbf{x}_6, \\mathbf{x}_7, \\mathbf{x}_8$. Outward normal is in the $+z$ direction.\n    $\\mathbf{A}_2 = (0, 0, L_x L_y) = (0, 0, 6) \\, \\text{m}^2$.\n    Centroid $\\mathbf{x}_{c,2} = (\\frac{L_x}{2}, \\frac{L_y}{2}, L_z) = (1, 1.5, 4) \\, \\text{m}$.\n    $\\mathbf{x}_{c,2} \\cdot \\mathbf{A}_2 = (1, 1.5, 4) \\cdot (0, 0, 6) = 4 \\times 6 = 24 \\, \\text{m}^3$.\n\n3.  **Face 3 (back, $y=0$):**\n    Vertices $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_6, \\mathbf{x}_5$. Outward normal is in the $-y$ direction.\n    $\\mathbf{A}_3 = (0, -L_x L_z, 0) = (0, -8, 0) \\, \\text{m}^2$.\n    Centroid $\\mathbf{x}_{c,3} = (\\frac{L_x}{2}, 0, \\frac{L_z}{2}) = (1, 0, 2) \\, \\text{m}$.\n    $\\mathbf{x}_{c,3} \\cdot \\mathbf{A}_3 = (1, 0, 2) \\cdot (0, -8, 0) = 0$.\n\n4.  **Face 4 (front, $y=L_y=3$):**\n    Vertices $\\mathbf{x}_4, \\mathbf{x}_3, \\mathbf{x}_7, \\mathbf{x}_8$. Outward normal is in the $+y$ direction.\n    $\\mathbf{A}_4 = (0, L_x L_z, 0) = (0, 8, 0) \\, \\text{m}^2$.\n    Centroid $\\mathbf{x}_{c,4} = (\\frac{L_x}{2}, L_y, \\frac{L_z}{2}) = (1, 3, 2) \\, \\text{m}$.\n    $\\mathbf{x}_{c,4} \\cdot \\mathbf{A}_4 = (1, 3, 2) \\cdot (0, 8, 0) = 3 \\times 8 = 24 \\, \\text{m}^3$.\n\n5.  **Face 5 (left, $x=0$):**\n    Vertices $\\mathbf{x}_1, \\mathbf{x}_4, \\mathbf{x}_8, \\mathbf{x}_5$. Outward normal is in the $-x$ direction.\n    $\\mathbf{A}_5 = (-L_y L_z, 0, 0) = (-12, 0, 0) \\, \\text{m}^2$.\n    Centroid $\\mathbf{x}_{c,5} = (0, \\frac{L_y}{2}, \\frac{L_z}{2}) = (0, 1.5, 2) \\, \\text{m}$.\n    $\\mathbf{x}_{c,5} \\cdot \\mathbf{A}_5 = (0, 1.5, 2) \\cdot (-12, 0, 0) = 0$.\n\n6.  **Face 6 (right, $x=L_x=2$):**\n    Vertices $\\mathbf{x}_2, \\mathbf{x}_3, \\mathbf{x}_7, \\mathbf{x}_6$. Outward normal is in the $+x$ direction.\n    $\\mathbf{A}_6 = (L_y L_z, 0, 0) = (12, 0, 0) \\, \\text{m}^2$.\n    As requested, we can verify this area vector by triangulation, e.g., using triangles $(2,3,7)$ and $(2,7,6)$ with $\\mathbf{x}_2=(2,0,0)$ as reference. $\\vec{\\mathbf{x}_2\\mathbf{x}_3}=(0,3,0)$, $\\vec{\\mathbf{x}_2\\mathbf{x}_7}=(0,3,4)$, $\\vec{\\mathbf{x}_2\\mathbf{x}_6}=(0,0,4)$. The total area vector is $\\frac{1}{2}(\\vec{\\mathbf{x}_2\\mathbf{x}_3} \\times \\vec{\\mathbf{x}_2\\mathbf{x}_7}) + \\frac{1}{2}(\\vec{\\mathbf{x}_2\\mathbf{x}_7} \\times \\vec{\\mathbf{x}_2\\mathbf{x}_6}) = \\frac{1}{2}(12,0,0) + \\frac{1}{2}(12,0,0) = (12,0,0)$, which is correct.\n    Centroid $\\mathbf{x}_{c,6} = (L_x, \\frac{L_y}{2}, \\frac{L_z}{2}) = (2, 1.5, 2) \\, \\text{m}$.\n    $\\mathbf{x}_{c,6} \\cdot \\mathbf{A}_6 = (2, 1.5, 2) \\cdot (12, 0, 0) = 2 \\times 12 = 24 \\, \\text{m}^3$.\n\nNow, we sum the dot products:\n$$ \\sum_{f=1}^{6} (\\mathbf{x}_{c,f} \\cdot \\mathbf{A}_f) = 0 + 24 + 0 + 24 + 0 + 24 = 72 \\, \\text{m}^3 $$\nFinally, we calculate $\\dot{V}(0)$ by multiplying by $\\alpha$:\n$$ \\dot{V}(0) = \\alpha \\times 72 \\, \\text{m}^3 = 0.05 \\, \\text{s}^{-1} \\times 72 \\, \\text{m}^3 = 3.6 \\, \\text{m}^3/\\text{s} $$\nThe time derivative of the control volume at $t=0$ is $3.6 \\, \\text{m}^3/\\text{s}$. Rounding to four significant figures gives $3.600 \\, \\text{m}^3/\\text{s}$.\n\nThis result can be verified using the divergence theorem on the velocity field. $\\nabla \\cdot \\mathbf{v}_g = \\nabla \\cdot (\\mathbf{b} + \\alpha \\mathbf{x}) = \\nabla \\cdot \\mathbf{b} + \\alpha (\\nabla \\cdot \\mathbf{x}) = 0 + \\alpha(1+1+1) = 3\\alpha$. Since the divergence is constant, $\\dot{V} = \\int_V \\nabla \\cdot \\mathbf{v}_g dV = (3\\alpha) V_0$. The initial volume is $V_0 = 2 \\times 3 \\times 4 = 24 \\, \\text{m}^3$. Thus, $\\dot{V}(0) = 3 \\times 0.05 \\times 24 = 0.15 \\times 24 = 3.6 \\, \\text{m}^3/\\text{s}$, which confirms our face-by-face calculation.",
            "answer": "$$\n\\boxed{3.600}\n$$"
        },
        {
            "introduction": "Moving beyond the fundamental definition, the practical implementation of the GCL in time-accurate solvers demands careful attention to numerical discretization. Simply understanding the law is insufficient; it must be discretized to the same order of accuracy as the overall flow solver to avoid contaminating the solution. This practice  challenges you to perform a formal analysis, deriving the precise conditions on the time integration and geometric approximations needed to satisfy the GCL to second-order accuracy, a common requirement for unsteady simulations.",
            "id": "3962139",
            "problem": "Consider a three-dimensional finite-volume discretization of a compressible flow in the Arbitrary Lagrangian-Eulerian (ALE) frame on a moving grid. Let a control volume (cell) $C(t)$ with volume $V(t)$ be bounded by a set of planar faces $f \\in \\mathcal{F}(t)$, each with oriented face area vector $\\boldsymbol{A}_f(t)$ and face centroid position $\\boldsymbol{x}_f(t)$. The grid velocity at face $f$ is defined as $\\boldsymbol{v}_{g,f}(t) = \\frac{d \\boldsymbol{x}_f}{dt}(t)$. The discrete update of the conserved variables is advanced in time with a one-step $\\theta$-method using a single time step $\\Delta t = t^{n+1} - t^{n}$, where face-based geometric quantities and fluxes are evaluated at the intermediate time $t^{n+\\theta} = t^{n} + \\theta \\,\\Delta t$.\n\nThe Geometric Conservation Law (GCL) requires that a uniform conservative state remains exactly uniform under grid motion when discretized. Starting from the Reynolds transport theorem applied to the scalar field $\\phi(\\boldsymbol{x},t) \\equiv 1$ over the moving control volume $C(t)$, and using only definitions of kinematics and standard time-discretization principles, derive the conditions on the parameter $\\theta$ and on how the face area vector $\\boldsymbol{A}_f$ and the grid velocity $\\boldsymbol{v}_{g,f}$ must be evaluated in time such that:\n- the time-discrete identity equating the control-volume change to the grid-velocity flux is satisfied to second order in time, and\n- the scheme preserves a uniform state through one time step with second-order temporal accuracy.\n\nYour final answer must be a single closed-form analytic expression consisting of the value of $\\theta$ and the second-order consistent evaluations for $\\boldsymbol{A}_f$ and $\\boldsymbol{v}_{g,f}$ at the required time level. No numerical rounding is needed, and no physical units should be included in the final expression. Express multiple components of the final expression as a single row matrix using LaTeX’s $\\mathrm{pmatrix}$ environment.",
            "solution": "The problem requires the derivation of conditions for a second-order accurate Geometric Conservation Law (GCL) for a finite-volume scheme on a moving grid using a one-step $\\theta$-method.\n\nThe starting point is the Reynolds transport theorem for an arbitrary moving control volume $C(t)$ with volume $V(t)$ and boundary $\\partial C(t)$. For a scalar field $\\phi(\\boldsymbol{x}, t)$, the theorem states:\n$$\n\\frac{d}{dt} \\int_{C(t)} \\phi \\, dV = \\int_{C(t)} \\frac{\\partial \\phi}{\\partial t} \\, dV + \\oint_{\\partial C(t)} \\phi \\, \\boldsymbol{v}_g \\cdot d\\boldsymbol{A}\n$$\nwhere $\\boldsymbol{v}_g$ is the velocity of the boundary $\\partial C(t)$, and $d\\boldsymbol{A}$ is the outward-pointing differential area vector.\n\nThe Geometric Conservation Law is obtained by setting the scalar field $\\phi \\equiv 1$. In this case, $\\phi$ is constant in both space and time, so $\\frac{\\partial \\phi}{\\partial t} = 0$. The integral of $\\phi$ over the volume $C(t)$ is simply the volume $V(t)$. The Reynolds transport theorem thus simplifies to a purely kinematic identity:\n$$\n\\frac{dV(t)}{dt} = \\oint_{\\partial C(t)} \\boldsymbol{v}_g \\cdot d\\boldsymbol{A}\n$$\nThis is the continuous form of the GCL. It means the rate of change of the cell volume is equal to the flux of the grid velocity through the cell's boundary.\n\nFor a finite-volume discretization, the control volume $C(t)$ is a cell bounded by a set of planar faces $f$. The surface integral is replaced by a sum over the faces:\n$$\n\\frac{dV(t)}{dt} = \\sum_{f \\in \\mathcal{F}(t)} \\boldsymbol{v}_{g,f}(t) \\cdot \\boldsymbol{A}_f(t)\n$$\nwhere $\\boldsymbol{v}_{g,f}(t)$ is the grid velocity at the centroid of face $f$ and $\\boldsymbol{A}_f(t)$ is the oriented area vector of face $f$.\n\nThe problem states that this equation is discretized in time using a one-step $\\theta$-method, with quantities evaluated at the intermediate time $t^{n+\\theta} = t^n + \\theta \\Delta t$. The discrete form of the GCL is therefore:\n$$\n\\frac{V^{n+1} - V^n}{\\Delta t} = \\sum_{f} \\left( \\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f \\right)^{n+\\theta}\n$$\nwhere the superscripts $n$ and $n+1$ denote evaluation at times $t^n$ and $t^{n+1} = t^n + \\Delta t$, respectively. The term on the left represents the time derivative of the volume, and the term on the right represents the flux of the grid velocity. To satisfy the GCL with second-order temporal accuracy, the error in this equation must be of order $O(\\Delta t^2)$.\n\nLet's analyze both sides of the equation using Taylor series expansions around the time $t^{n+\\theta}$.\nThe left-hand side (LHS) is an approximation of the time derivative $\\frac{dV}{dt}$. Let's expand $V^{n+1}$ and $V^n$ around $t^{n+\\theta}$:\n$$\nV^{n+1} = V(t^{n+\\theta} + (1-\\theta)\\Delta t) = V^{n+\\theta} + (1-\\theta)\\Delta t \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{((1-\\theta)\\Delta t)^2}{2} \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^3)\n$$\n$$\nV^{n} = V(t^{n+\\theta} - \\theta\\Delta t) = V^{n+\\theta} - \\theta\\Delta t \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{(-\\theta\\Delta t)^2}{2} \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^3)\n$$\nSubtracting the second expansion from the first and dividing by $\\Delta t$:\n$$\n\\frac{V^{n+1} - V^{n}}{\\Delta t} = \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{(1-\\theta)^2 - \\theta^2}{2} \\Delta t \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^2)\n$$\n$$\n\\frac{V^{n+1} - V^{n}}{\\Delta t} = \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{1-2\\theta}{2} \\Delta t \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^2)\n$$\nThe right-hand side (RHS) of the discrete GCL is by definition the evaluation of the grid velocity flux at $t^{n+\\theta}$:\n$$\n\\text{RHS} = \\sum_{f} \\left( \\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f \\right)^{n+\\theta} = \\left( \\oint_{\\partial C} \\boldsymbol{v}_g \\cdot d\\boldsymbol{A} \\right)^{n+\\theta}\n$$\nFrom the continuous GCL, this is equal to $\\left(\\frac{dV}{dt}\\right)^{n+\\theta}$.\nEquating the expansion of the LHS with the RHS:\n$$\n\\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{1-2\\theta}{2} \\Delta t \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^2) = \\left(\\frac{dV}{dt}\\right)^{n+\\theta}\n$$\nFor this equality to hold with an error of $O(\\Delta t^2)$, the first-order error term (proportional to $\\Delta t$) must vanish. Assuming a general grid motion where $\\frac{d^2V}{dt^2} \\neq 0$, we require:\n$$\n\\frac{1-2\\theta}{2} = 0 \\implies \\theta = \\frac{1}{2}\n$$\nThis establishes that the time integration must be centered (equivalent to the Crank-Nicolson method) to achieve second-order temporal accuracy. The evaluation time is thus $t^{n+1/2}$.\n\nNext, we must determine how the geometric quantities $\\boldsymbol{v}_{g,f}$ and $\\boldsymbol{A}_f$ are to be evaluated at $t^{n+1/2}$ to maintain second-order accuracy. The scheme requires evaluation of the product $(\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)^{n+1/2}$. We need to find expressions for $\\boldsymbol{v}_{g,f}^{n+1/2}$ and $\\boldsymbol{A}_f^{n+1/2}$ using information at times $t^n$ and $t^{n+1}$ such that their product is a second-order accurate approximation of $(\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)$ at $t^{n+1/2}$.\n\nLet's consider the grid velocity $\\boldsymbol{v}_{g,f} = \\frac{d\\boldsymbol{x}_f}{dt}$. A second-order accurate, centered-difference approximation for the velocity at the midpoint time $t^{n+1/2}$ is given by:\n$$\n\\boldsymbol{v}_{g,f}^{n+1/2} = \\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^{n}}{\\Delta t}\n$$\nTo verify its accuracy, we expand $\\boldsymbol{x}_f^{n+1}$ and $\\boldsymbol{x}_f^{n}$ about $t^{n+1/2}$:\n$$\n\\boldsymbol{x}_f^{n+1} = \\boldsymbol{x}_f^{n+1/2} + \\frac{\\Delta t}{2} \\dot{\\boldsymbol{x}}_f^{n+1/2} + \\frac{(\\Delta t/2)^2}{2!} \\ddot{\\boldsymbol{x}}_f^{n+1/2} + O(\\Delta t^3)\n$$\n$$\n\\boldsymbol{x}_f^{n} = \\boldsymbol{x}_f^{n+1/2} - \\frac{\\Delta t}{2} \\dot{\\boldsymbol{x}}_f^{n+1/2} + \\frac{(\\Delta t/2)^2}{2!} \\ddot{\\boldsymbol{x}}_f^{n+1/2} - O(\\Delta t^3)\n$$\n$$\n\\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^{n}}{\\Delta t} = \\dot{\\boldsymbol{x}}_f^{n+1/2} + O(\\Delta t^2) = \\boldsymbol{v}_{g,f}(t^{n+1/2}) + O(\\Delta t^2)\n$$\nThis approximation is indeed second-order accurate.\n\nFor the face area vector $\\boldsymbol{A}_f$, a natural second-order approximation at $t^{n+1/2}$ is the arithmetic average of its values at $t^n$ and $t^{n+1}$:\n$$\n\\boldsymbol{A}_f^{n+1/2} = \\frac{\\boldsymbol{A}_f^n + \\boldsymbol{A}_f^{n+1}}{2}\n$$\nThe error of this approximation is $O(\\Delta t^2)$:\n$$\n\\frac{\\boldsymbol{A}_f^n + \\boldsymbol{A}_f^{n+1}}{2} = \\frac{1}{2}\\left[\\left(\\boldsymbol{A}_f^{n+1/2} \\!-\\! \\frac{\\Delta t}{2} \\dot{\\boldsymbol{A}}_f^{n+1/2} \\!+\\! O(\\Delta t^2)\\right) \\!+\\! \\left(\\boldsymbol{A}_f^{n+1/2} \\!+\\! \\frac{\\Delta t}{2} \\dot{\\boldsymbol{A}}_f^{n+1/2} \\!+\\! O(\\Delta t^2)\\right)\\right] = \\boldsymbol{A}_f(t^{n+1/2}) + O(\\Delta t^2)\n$$\n\nWith these definitions, the product of the approximations is also second-order accurate:\n$$\n\\boldsymbol{v}_{g,f}^{n+1/2} \\cdot \\boldsymbol{A}_f^{n+1/2} = (\\boldsymbol{v}_{g,f}(t^{n+1/2}) + O(\\Delta t^2)) \\cdot (\\boldsymbol{A}_f(t^{n+1/2}) + O(\\Delta t^2)) = (\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)^{n+1/2} + O(\\Delta t^2)\n$$\nThus, the discrete GCL equation is satisfied to second-order accuracy.\n\nThe second part of the problem asks that the scheme preserves a uniform state with second-order accuracy. In a flow with a uniform conservative state vector $\\boldsymbol{U}_{const}$, the discretized governing equation for a cell $C$ is:\n$$\n\\frac{\\boldsymbol{U}_{C}^{n+1}V^{n+1} - \\boldsymbol{U}_{C}^{n}V^{n}}{\\Delta t} + \\sum_{f} \\boldsymbol{\\mathcal{F}}_f^{n+1/2} = 0\n$$\nIf $\\boldsymbol{U}_{C}^n = \\boldsymbol{U}_{const}$ for all cells, then for the state to be preserved, we must have $\\boldsymbol{U}_{C}^{n+1} = \\boldsymbol{U}_{const}$. The equation becomes:\n$$\n\\boldsymbol{U}_{const} \\left(\\frac{V^{n+1} - V^{n}}{\\Delta t}\\right) + \\sum_{f} \\boldsymbol{\\mathcal{F}}_f^{n+1/2} = 0\n$$\nFor a uniform state, the physical flux is constant on all faces, and the numerical flux $\\boldsymbol{\\mathcal{F}}_f$ simplifies. For the Euler equations, for example, the flux is $\\boldsymbol{F}(\\boldsymbol{U}) - \\boldsymbol{U} (\\boldsymbol{v}_{g,f})^T$. For a uniform state, this leads to a condition on the geometric terms. The discrete sum of physical fluxes over a closed cell is zero, $\\sum_f \\boldsymbol{F}(\\boldsymbol{U}_{const}) \\cdot \\boldsymbol{A}_f^{n+1/2} = \\boldsymbol{F}(\\boldsymbol{U}_{const}) \\cdot (\\sum_f \\boldsymbol{A}_f^{n+1/2}) = 0$. The remaining terms give:\n$$\n\\boldsymbol{U}_{const} \\left(\\frac{V^{n+1} - V^{n}}{\\Delta t}\\right) - \\sum_{f} \\boldsymbol{U}_{const} (\\boldsymbol{v}_{g,f}^{n+1/2})^T \\boldsymbol{A}_f^{n+1/2} = 0\n$$\nFactoring out $\\boldsymbol{U}_{const}$ yields exactly the discrete GCL:\n$$\n\\frac{V^{n+1} - V^{n}}{\\Delta t} - \\sum_{f} \\boldsymbol{v}_{g,f}^{n+1/2} \\cdot \\boldsymbol{A}_f^{n+1/2} = 0\n$$\nTherefore, satisfying the GCL to second order is the necessary and sufficient condition to preserve a uniform state with second-order accuracy.\n\nIn summary, the three required conditions are:\n1.  The time-integration parameter must be $\\theta = 1/2$.\n2.  The face area vector at the intermediate time must be evaluated as the arithmetic mean: $\\boldsymbol{A}_f^{n+1/2} = \\frac{\\boldsymbol{A}_f^n + \\boldsymbol{A}_f^{n+1}}{2}$.\n3.  The face grid velocity at the intermediate time must be evaluated using a centered difference of face centroid positions: $\\boldsymbol{v}_{g,f}^{n+1/2} = \\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^n}{\\Delta t}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} & \\frac{\\boldsymbol{A}_f^{n} + \\boldsymbol{A}_f^{n+1}}{2} & \\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^{n}}{\\Delta t}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Theory and calculation are essential, but a direct demonstration can provide the most powerful lesson. This final practice  offers a compelling, code-based experiment to witness the consequences of failing to uphold the GCL. By implementing a simple one-dimensional solver and comparing a GCL-compliant scheme against one with a deliberate violation, you will see firsthand how numerical inconsistencies manifest as non-physical pressure oscillations, even in a perfectly uniform flow.",
            "id": "3962168",
            "problem": "You are tasked with constructing a self-contained numerical experiment that exposes the necessity of the Geometric Conservation Law (GCL) in Arbitrary Lagrangian–Eulerian (ALE) formulations for moving meshes in Computational Fluid Dynamics (CFD). Starting from the fundamental control-volume form of conservation for a moving mesh, derive and implement a minimal one-dimensional finite-volume update that demonstrates how inconsistency between the control-volume change and the grid-advection flux produces spurious pressure oscillations in a uniform flow. Your program must be a complete, runnable implementation.\n\nThe base you must use is the integral conservation law on a moving control volume and the ideal-gas equation of state:\n- The integral conservation law: for a conserved state vector $U$ and physical flux $F$, on a control volume $\\Omega(t)$ with boundary $\\partial \\Omega(t)$ and outward unit normal $\\boldsymbol{n}$, the Arbitrary Lagrangian–Eulerian (ALE) form of conservation states\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega(t)} U \\,\\mathrm{d}\\Omega + \\oint_{\\partial \\Omega(t)} \\left(F - U \\,\\boldsymbol{w}\\right)\\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\nwhere $\\boldsymbol{w}$ is the mesh velocity.\n- The Geometric Conservation Law (GCL): the control-volume time rate of change must satisfy\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left|\\Omega(t)\\right| = \\oint_{\\partial \\Omega(t)} \\boldsymbol{w}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S,\n$$\nso that uniform solutions are preserved under mesh motion.\n- The ideal-gas equation of state: with ratio of specific heats $\\gamma$, density $\\rho$, velocity $u$, specific total energy $E$, and specific internal energy $e = E - \\tfrac{1}{2}u^2$, the pressure is\n$$\np = (\\gamma - 1)\\,\\rho\\,e.\n$$\n\nYou must design a manufactured one-dimensional mesh motion and a uniform initial state that make any violation of the discrete GCL manifest as a spurious pressure oscillation. Implement a first-order, cell-centered finite-volume update for the conserved variables on a one-dimensional mesh with moving faces, assuming a uniform initial flow with zero physical flux. The key idea is that, for a uniform state $U$ with zero physical flux, the update reduces to a balance between the control-volume change and the grid-advection term. If these are discretely inconsistent (violating the GCL), then the scheme introduces a non-zero update to $U$, which appears as a spurious pressure change via the ideal-gas relation.\n\nManufacture a sinusoidal mesh motion for the face locations $x_i(t)$ in meters:\n$$\nx_i(t) = x_i(0) + A\\,\\sin\\!\\left(\\omega\\,t + \\phi_i\\right),\n$$\nwhere $A$ is the amplitude in meters, $\\omega$ is the angular frequency in radians per second, and $\\phi_i = \\beta\\,i$ is a phase shift in radians indexed by face $i$. The face velocity is then\n$$\nw_i(t) = \\frac{\\mathrm{d}x_i}{\\mathrm{d}t} = A\\,\\omega\\,\\cos\\!\\left(\\omega\\,t + \\phi_i\\right).\n$$\n\nLet the initial domain be $[0,L]$ with $N$ uniform cells, face indices $i=0,\\dots,N$, and cell indices $j=0,\\dots,N-1$. The initial face positions are $x_i(0) = i\\,\\Delta x$ with $\\Delta x = L/N$, and the initial uniform state is a quiescent ideal-gas with density $\\rho_0$ in kilograms per cubic meter, velocity $u_0 = 0$ in meters per second, and pressure $p_0$ in Pascals. The initial specific internal energy $e_0$ in joules per kilogram must satisfy $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$.\n\nConstruct a discrete update over time steps of size $\\Delta t$ seconds. At time $t_n = n\\,\\Delta t$, define the cell volumes $V_j^n = x_{j+1}(t_n) - x_j(t_n)$ and the staged mesh velocity at $t_n^\\star = t_n + \\theta\\,\\Delta t$ as $w_i^\\star = w_i(t_n^\\star)$, where $\\theta \\in [0,1]$ specifies the temporal staging of the grid-advection term. The discrete grid-advection volume change is\n$$\n\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\,\\left( w_{j+1}^\\star - w_j^\\star \\right).\n$$\n\nYou must implement two update modes:\n- A GCL-compliant mode: use the control volume for the update $V_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}$, consistent with the grid-advection term.\n- A GCL-violating mode: use the exact geometric volume $V_j^{n+1,\\mathrm{used}} = V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$ while still computing $\\Delta V_j^{\\mathrm{flux}}$ from the staged velocities at $t_n^\\star$. The discrete GCL residual is then\n$$\n\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right).\n$$\n\nFor a uniform state $U$ and zero physical flux, the finite-volume update of the conserved variables (mass, momentum, and energy densities) over the used control volume reduces to scaling by the ratio induced by the GCL residual. Specifically, for each cell,\n$$\nU_j^{n+1} = U_j^n \\left( 1 - \\frac{\\varepsilon_j^n}{V_j^{n+1,\\mathrm{used}}} \\right),\n$$\nwhich preserves $u=0$ but scales $\\rho$ and $\\rho E$ identically, inducing a pressure change via $p = (\\gamma - 1)\\,\\rho\\,e_0$ with constant $e_0$. Any non-zero $\\varepsilon_j^n$ thereby manifests as a spurious pressure oscillation.\n\nYour program must:\n- Implement the face motion and compute $x_i(t_n)$ and $x_i(t_{n+1})$ exactly from the manufactured motion.\n- Compute $w_i^\\star$ at the staged time $t_n^\\star$ and the discrete flux-based volume change $\\Delta V_j^{\\mathrm{flux}}$.\n- Update the conserved variables using $V_j^{n+1,\\mathrm{used}}$ according to the selected mode (GCL-compliant or GCL-violating).\n- Track the pressure deviation $|p_j^n - p_0|$ over all cells and time steps.\n- Compute diagnostic metrics:\n  1. The maximum absolute pressure deviation over all cells and times in Pascals.\n  2. The root-mean-square pressure deviation over all cells and times in Pascals.\n  3. The maximum absolute GCL residual over all cells and times in meters.\n\nAngle quantities must be expressed in radians. All physical units must be consistent with the International System of Units (SI): meters ($\\mathrm{m}$), seconds ($\\mathrm{s}$), kilograms ($\\mathrm{kg}$), and Pascals ($\\mathrm{Pa}$).\n\nUse the following test suite of parameter sets to exercise distinct behaviors:\n- Case A (happy path, compliant): $N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.01\\,\\mathrm{m}$, $\\omega=20.0\\,\\mathrm{rad/s}$, $\\Delta t=0.005\\,\\mathrm{s}$, $N_t=200$ time steps, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, compliant mode.\n- Case B (violation, oscillations): same as Case A but GCL-violating mode.\n- Case C (edge case, static grid): $N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.0\\,\\mathrm{m}$, $\\omega=20.0\\,\\mathrm{rad/s}$, $\\Delta t=0.005\\,\\mathrm{s}$, $N_t=200$, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, GCL-violating mode.\n- Case D (edge case, higher frequency): $N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.01\\,\\mathrm{m}$, $\\omega=100.0\\,\\mathrm{rad/s}$, $\\Delta t=0.002\\,\\mathrm{s}$, $N_t=300$, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, GCL-violating mode.\n\nAssume the ideal-gas parameters $\\gamma = 1.4$ and initial state $\\rho_0 = 1.0\\,\\mathrm{kg/m^3}$, $u_0 = 0.0\\,\\mathrm{m/s}$, $p_0 = 100000.0\\,\\mathrm{Pa}$, with $e_0$ chosen to satisfy $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case’s result is itself a list of three floats in the order [max absolute pressure deviation, root-mean-square pressure deviation, max absolute GCL residual], for Cases A, B, C, and D respectively. For example: \"[[a1,b1,c1],[a2,b2,c2],[a3,b3,c3],[a4,b4,c4]]\". No other text must be printed.",
            "solution": "We begin from the integral conservation law on a moving control volume in the Arbitrary Lagrangian–Eulerian (ALE) frame. For a conserved state vector $U$ and physical flux $F$, the integral law over a time-dependent control volume $\\Omega(t)$ with boundary $\\partial \\Omega(t)$ is\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega(t)} U \\,\\mathrm{d}\\Omega + \\oint_{\\partial \\Omega(t)} \\left(F - U \\,\\boldsymbol{w}\\right)\\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\nwhere $\\boldsymbol{w}$ is the mesh velocity and $\\boldsymbol{n}$ is the outward normal on the boundary. The grid-advection term $-U\\,\\boldsymbol{w}$ enforces invariance of uniform states under mesh motion, provided the control-volume change and grid-advection are discretely consistent.\n\nThe Geometric Conservation Law (GCL) is the requirement\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left|\\Omega(t)\\right| = \\oint_{\\partial \\Omega(t)} \\boldsymbol{w}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S,\n$$\nwhich guarantees that the volume change matches the net normal grid velocity through the boundary. In the finite-volume context, the discrete counterpart is that the updated control volume must be consistent with the staged grid velocities used in the grid-advection flux.\n\nWe consider a one-dimensional mesh with faces at positions $x_i(t)$ and cells indexed by $j$. The manufactured motion\n$$\nx_i(t) = x_i(0) + A\\,\\sin\\!\\left(\\omega\\,t + \\phi_i\\right),\\quad \\phi_i = \\beta\\,i,\n$$\nhas face velocity\n$$\nw_i(t) = \\frac{\\mathrm{d}x_i}{\\mathrm{d}t} = A\\,\\omega\\,\\cos\\!\\left(\\omega\\,t + \\phi_i\\right).\n$$\nLet the initial domain be $[0,L]$ with $N$ uniform cells, face positions $x_i(0) = i\\,\\Delta x$ with $\\Delta x = L/N$. At time $t_n = n\\,\\Delta t$, the cell volume is $V_j^n = x_{j+1}(t_n) - x_j(t_n)$. Let the staged mesh velocity at $t_n^\\star = t_n + \\theta\\,\\Delta t$ be $w_i^\\star = w_i(t_n^\\star)$, with $\\theta \\in [0,1]$.\n\nThe discrete flux-based volume change, consistent with a first-order explicit finite-volume method using staged velocities, is\n$$\n\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\left( w_{j+1}^\\star - w_j^\\star \\right).\n$$\nThe GCL-compliant update must use the control volume\n$$\nV_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}.\n$$\nIf instead one uses an inconsistent control volume, such as the exact geometric volume $V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$ while retaining the staged grid-advection term computed from $w^\\star$, the discrete GCL residual becomes\n$$\n\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right),\n$$\nwhich is identically zero in the compliant mode and generally non-zero in the violating mode due to the time variation of $w$ over the step and phase differences across faces.\n\nConsider a uniform initial state for the compressible Euler equations: constant density $\\rho_0$, velocity $u_0 = 0$, and pressure $p_0$, with specific internal energy $e_0$ satisfying $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$. For uniform $U$ and zero physical flux, the finite-volume update reduces to the balance between the grid-advection flux and the control-volume change. Integrating the one-dimensional ALE law over cell $j$ from $t_n$ to $t_{n+1}$ with the chosen $V_j^{n+1,\\mathrm{used}}$ yields the update for the cell-integrated conserved variables:\n$$\nU_j^{n+1}\\,V_j^{n+1,\\mathrm{used}} = U_j^n\\,V_j^n - \\Delta t\\left[ \\left(F - U\\,w\\right)_{j+1/2} - \\left(F - U\\,w\\right)_{j-1/2} \\right].\n$$\nWith uniform $U$ and zero physical flux $F=0$, the right-hand side simplifies to\n$$\nU_j^{n+1}\\,V_j^{n+1,\\mathrm{used}} = U_j^n\\,V_j^n + \\Delta t\\,U\\,\\left( w_{j+1}^\\star - w_j^\\star \\right) = U_j^n\\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right).\n$$\nThus,\n$$\nU_j^{n+1} = U_j^n \\frac{V_j^n + \\Delta V_j^{\\mathrm{flux}}}{V_j^{n+1,\\mathrm{used}}}\n= U_j^n\\left(1 - \\frac{\\varepsilon_j^n}{V_j^{n+1,\\mathrm{used}}}\\right).\n$$\nThis shows that any non-zero $\\varepsilon_j^n$ scales all conserved components equally. In particular, the velocity $u$ remains zero because both $\\rho$ and $\\rho u$ scale by the same factor, while the specific total energy $E$ per unit mass remains constant because both $\\rho E$ and $\\rho$ scale identically. Therefore, the pressure computed from the ideal-gas equation of state\n$$\np_j^n = (\\gamma - 1)\\,\\rho_j^n\\,e_0\n$$\nresponds linearly to the density scaling induced by the GCL residual. Any non-zero $\\varepsilon_j^n$ produces spurious pressure oscillations, even though the physical solution should remain uniform.\n\nAlgorithmic design:\n- Initialize the mesh faces $x_i(0)$, cell volumes $V_j^0$, and the uniform state $(\\rho_0,u_0=0,p_0,e_0)$ with $e_0 = p_0/((\\gamma-1)\\rho_0)$.\n- For each time step $n$:\n  - Compute $x_i(t_n)$ and $x_i(t_{n+1})$ exactly from the manufactured motion $x_i(t)$ with given $(A,\\omega,\\beta)$, ensuring units: meters for positions, seconds for time, radians for angles.\n  - Compute staged mesh velocities $w_i^\\star = A\\,\\omega\\,\\cos(\\omega(t_n+\\theta\\Delta t)+\\phi_i)$ at $t_n^\\star$.\n  - Compute $V_j^n = x_{j+1}(t_n) - x_j(t_n)$ and $V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$.\n  - Compute $\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\left( w_{j+1}^\\star - w_j^\\star \\right)$.\n  - Set $V_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}$ (GCL-compliant mode) or $V_j^{n+1,\\mathrm{used}} = V_j^{n+1}$ (GCL-violating mode).\n  - Compute $\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right)$.\n  - Update $\\rho_j^{n+1} = \\rho_j^n\\left(1 - \\varepsilon_j^n/V_j^{n+1,\\mathrm{used}}\\right)$; keep $u_j^{n+1}=0$ and $e_0$ constant; compute $p_j^{n+1} = (\\gamma - 1)\\,\\rho_j^{n+1}\\,e_0$.\n  - Record the absolute pressure deviation $|p_j^{n+1} - p_0|$ and the residual $|\\varepsilon_j^n|$.\n- After all steps, compute:\n  - The maximum absolute pressure deviation over all $j,n$ in Pascals.\n  - The root-mean-square (RMS) pressure deviation $\\sqrt{\\frac{1}{N\\,N_t}\\sum_{n=1}^{N_t}\\sum_{j=0}^{N-1}(p_j^n - p_0)^2}$ in Pascals.\n  - The maximum absolute GCL residual $\\max_{j,n}|\\varepsilon_j^n|$ in meters.\n\nEdge-case analysis and expectations:\n- In the GCL-compliant mode, $\\varepsilon_j^n=0$ by construction, thus $\\rho_j^n$ and $p_j^n$ remain equal to $\\rho_0$ and $p_0$ for all $n$, so both the maximum and RMS pressure deviations are zero to within floating-point roundoff.\n- In the GCL-violating mode with non-zero mesh motion ($A>0$) and time-varying $w^\\star$, $\\varepsilon_j^n$ is generally non-zero, producing non-zero pressure deviations. The magnitude grows with increased $\\omega$ and accumulated time steps.\n- In the static-grid edge case ($A=0$), $w^\\star=0$ and $x_i(t)$ is constant, so $\\Delta V_j^{\\mathrm{flux}}=0$ and $V_j^{n+1}=V_j^n$, implying $\\varepsilon_j^n=0$ even in the violating mode. Pressure deviations remain zero.\n\nYour program must implement the four test cases specified in the problem statement and output a single line containing a list of four lists, each inner list holding three floats: $[\\text{max abs pressure deviation in Pa}, \\text{RMS pressure deviation in Pa}, \\text{max abs GCL residual in m}]$, in the order Case A, Case B, Case C, Case D. No other text should be printed.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_case(N, L, A, omega, dt, Nt, beta, theta, compliant,\n             gamma=1.4, rho0=1.0, p0=100000.0):\n    # Derived initial quantities\n    e0 = p0 / ((gamma - 1.0) * rho0)  # specific internal energy [J/kg]\n    # Face indices 0..N\n    i_faces = np.arange(N + 1, dtype=np.int64)\n    # Initial face positions [m]\n    x0 = i_faces * (L / N)\n    # Phase per face [rad]\n    phi = beta * i_faces\n\n    # Storage for diagnostics\n    max_abs_pressure_dev = 0.0\n    sum_sq_pressure_dev = 0.0\n    max_abs_gcl_residual = 0.0\n    count = 0\n\n    # Initialize density per cell [kg/m^3]\n    rho = np.full(N, rho0, dtype=np.float64)\n\n    # Time loop\n    for n in range(Nt):\n        t_n = n * dt\n        t_np1 = (n + 1) * dt\n        t_star = t_n + theta * dt\n\n        # Analytic face positions at t_n and t_{n+1}\n        x_n = x0 + A * np.sin(omega * t_n + phi)         # [m]\n        x_np1 = x0 + A * np.sin(omega * t_np1 + phi)     # [m]\n\n        # Staged mesh velocities at t_star\n        w_star = A * omega * np.cos(omega * t_star + phi)  # [m/s]\n\n        # Cell volumes at t_n and t_{n+1}\n        V_n = x_n[1:] - x_n[:-1]          # [m]\n        V_np1 = x_np1[1:] - x_np1[:-1]    # [m]\n\n        # Flux-based discrete volume change\n        dV_flux = dt * (w_star[1:] - w_star[:-1])  # [m]\n\n        # Used control volume at n+1\n        if compliant:\n            V_used_np1 = V_n + dV_flux\n        else:\n            V_used_np1 = V_np1\n\n        # GCL residual epsilon\n        epsilon = V_used_np1 - (V_n + dV_flux)  # [m]\n\n        # Update density using multiplicative factor\n        # Factor = 1 - epsilon / V_used_np1\n        # Guard against division by tiny V_used_np1 (should not happen if motion is mild)\n        factor = 1.0 - np.divide(epsilon, V_used_np1, where=(V_used_np1 != 0.0))\n\n        rho *= factor  # [kg/m^3]\n\n        # Pressure from ideal gas with constant e0\n        p = (gamma - 1.0) * rho * e0  # [Pa]\n\n        # Diagnostics\n        abs_dev = np.abs(p - p0)\n        max_abs_pressure_dev = max(max_abs_pressure_dev, float(np.max(abs_dev)))\n        max_abs_gcl_residual = max(max_abs_gcl_residual, float(np.max(np.abs(epsilon))))\n        sum_sq_pressure_dev += float(np.sum(abs_dev**2))\n        count += N\n\n    # RMS pressure deviation over all cells and time steps\n    rms_pressure_dev = np.sqrt(sum_sq_pressure_dev / count) if count > 0 else 0.0\n\n    return [max_abs_pressure_dev, rms_pressure_dev, max_abs_gcl_residual]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: GCL compliant, happy path\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": True},\n        # Case B: GCL violation, oscillations expected\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n        # Case C: Static grid edge case (A=0), violation mode but zero motion\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.0,  \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n        # Case D: Higher frequency, violation mode\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 100.0, \"dt\": 0.002, \"Nt\": 300, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_case(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Each result is a list of three floats; we print the overall list of lists.\n    # Ensure plain Python list formatting.\n    print(f\"[{','.join([str(res) for res in results])}]\")\n\nsolve()\n```"
        }
    ]
}