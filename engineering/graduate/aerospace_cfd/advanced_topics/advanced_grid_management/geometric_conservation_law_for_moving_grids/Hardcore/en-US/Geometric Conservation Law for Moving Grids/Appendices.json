{
    "hands_on_practices": [
        {
            "introduction": "The theoretical foundation of the Geometric Conservation Law (GCL) is the relationship between the rate of change of a control volume's size and the velocity of its boundary. In a discrete numerical setting, this translates to a critical identity: over a finite time step, the change in a cell's volume must exactly equal the volume swept by its moving faces. This first practice provides a concrete exercise in this fundamental concept, tasking you with calculating the signed swept area for a single two-dimensional face and relating it directly to the time-integrated grid flux .",
            "id": "3962126",
            "problem": "Consider a two-dimensional control volume edge (face) in an Arbitrary Lagrangian-Eulerian (ALE) mesh used in Computational Fluid Dynamics (CFD). The Geometric Conservation Law (GCL) requires that the discrete grid motion exactly preserves uniform solutions by ensuring that the time-integrated grid flux equals the swept area of each moving face. The face endpoints at the initial time $t^{n}$ are $A^{n}=(x_{A}^{n},y_{A}^{n})=(1.2\\,\\text{m},\\,0.7\\,\\text{m})$ and $B^{n}=(x_{B}^{n},y_{B}^{n})=(3.0\\,\\text{m},\\,1.6\\,\\text{m})$. The nodal grid velocities are constant over the time step and given by $\\boldsymbol{w}_{A}=(0.4\\,\\text{m/s},\\,-0.2\\,\\text{m/s})$ and $\\boldsymbol{w}_{B}=(-0.1\\,\\text{m/s},\\,0.3\\,\\text{m/s})$. Assume the endpoints move linearly in time with these velocities during the time step $\\Delta t=0.02\\,\\text{s}$, and the face is oriented from $A$ to $B$. The outward unit normal for the control volume associated with this face is defined by the left-hand normal with respect to the orientation $A\\rightarrow B$.\n\nUsing only first principles, including kinematics $\\boldsymbol{w}=\\mathrm{d}\\boldsymbol{x}/\\mathrm{d}t$ and conservation arguments appropriate to the Reynolds transport theorem, derive the signed swept area of the face over the interval $[t^{n},t^{n+1}]$ where $t^{n+1}=t^{n}+\\Delta t$, and relate it to the time-integrated grid flux across the face that enforces the Geometric Conservation Law. Then, evaluate this signed time-integrated grid flux numerically.\n\nExpress the final answer in $\\text{m}^{2}$ and round your answer to four significant figures. The answer must be a single real number.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Initial position of endpoint A: $\\boldsymbol{x}_{A}^{n} = (x_{A}^{n}, y_{A}^{n}) = (1.2\\,\\text{m}, 0.7\\,\\text{m})$\n- Initial position of endpoint B: $\\boldsymbol{x}_{B}^{n} = (x_{B}^{n}, y_{B}^{n}) = (3.0\\,\\text{m}, 1.6\\,\\text{m})$\n- Grid velocity at endpoint A: $\\boldsymbol{w}_{A} = (0.4\\,\\text{m/s}, -0.2\\,\\text{m/s})$\n- Grid velocity at endpoint B: $\\boldsymbol{w}_{B} = (-0.1\\,\\text{m/s}, 0.3\\,\\text{m/s})$\n- The grid velocities are constant over the time step.\n- The endpoints move linearly in time.\n- Time step duration: $\\Delta t = 0.02\\,\\text{s}$\n- The face is oriented from $A$ to $B$.\n- The outward unit normal is the left-hand normal with respect to the orientation $A \\to B$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the Geometric Conservation Law (GCL), a fundamental concept in the numerical solution of conservation laws on moving domains, particularly within Arbitrary Lagrangian-Eulerian (ALE) frameworks in Computational Fluid Dynamics (CFD). The use of kinematics and the Reynolds transport theorem is appropriate and standard. The problem is scientifically sound.\n- **Well-Posed**: The problem provides all necessary initial conditions, velocities, and the time step to uniquely determine the geometry of the swept area. The definitions are clear and unambiguous. A unique, stable, and meaningful solution exists.\n- **Objective**: The problem statement is composed of precise, technical language and quantitative data. There are no subjective or opinion-based statements.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is self-contained, consistent, and scientifically sound. A full solution will be provided.\n\n### Derivation and Solution\nThe problem asks for the derivation of the signed swept area and its relation to the time-integrated grid flux, followed by a numerical evaluation. The relationship is derived from the integral form of a general conservation law on a time-dependent control volume $\\Omega(t)$. For a conserved scalar quantity $\\phi$ per unit volume, the Reynolds transport theorem is:\n$$ \\frac{d}{dt} \\int_{\\Omega(t)} \\phi \\, dV + \\oint_{\\partial\\Omega(t)} \\phi (\\boldsymbol{v} - \\boldsymbol{w}) \\cdot \\boldsymbol{n} \\, dS = \\int_{\\Omega(t)} S_\\phi \\, dV $$\nwhere $\\boldsymbol{v}$ is the fluid velocity, $\\boldsymbol{w}$ is the grid velocity (boundary velocity), $\\boldsymbol{n}$ is the outward-pointing unit normal vector to the boundary $\\partial\\Omega(t)$, and $S_\\phi$ is the source term for $\\phi$.\n\nThe Geometric Conservation Law (GCL) is a statement that the discrete grid motion must preserve a uniform flow field exactly. For instance, consider a quiescent fluid ($\\boldsymbol{v} = \\boldsymbol{0}$) with a constant scalar value (e.g., density $\\phi = 1$) and no sources ($S_\\phi = 0$). The conservation law must still hold, which simplifies the equation to:\n$$ \\frac{d}{dt} \\int_{\\Omega(t)} 1 \\, dV + \\oint_{\\partial\\Omega(t)} 1 (\\boldsymbol{0} - \\boldsymbol{w}) \\cdot \\boldsymbol{n} \\, dS = 0 $$\n$$ \\frac{d}{dt} V_{\\Omega}(t) = \\oint_{\\partial\\Omega(t)} \\boldsymbol{w} \\cdot \\boldsymbol{n} \\, dS $$\nwhere $V_{\\Omega}(t)$ is the volume (or area in 2D) of the control volume at time $t$. This equation states that the rate of change of the control volume's measure is equal to the flux of the grid velocity through its boundary.\n\nIntegrating this expression over a time step $\\Delta t = t^{n+1} - t^{n}$ yields:\n$$ \\int_{t^n}^{t^{n+1}} \\frac{d}{dt} V_{\\Omega}(t) \\, dt = \\int_{t^n}^{t^{n+1}} \\left( \\oint_{\\partial\\Omega(t)} \\boldsymbol{w} \\cdot \\boldsymbol{n} \\, dS \\right) dt $$\n$$ V_{\\Omega}(t^{n+1}) - V_{\\Omega}(t^{n}) = \\int_{t^n}^{t^{n+1}} \\left( \\sum_{j} \\int_{S_j(t)} \\boldsymbol{w} \\cdot \\boldsymbol{n}_j \\, dS \\right) dt $$\nThe term on the left, $V_{\\Omega}^{n+1} - V_{\\Omega}^{n}$, represents the total change in volume of the control cell. This change is precisely the sum of the signed volumes swept by each face $j$ of the cell. The term on the right is the time-integrated grid flux. Hence, for a single face, the signed swept volume (or area in 2D) is exactly equal to the time-integrated grid flux across that face:\n$$ \\Delta A_{\\text{swept, face}} = \\int_{t^n}^{t^{n+1}} \\left( \\int_{\\text{face}} \\boldsymbol{w} \\cdot \\boldsymbol{n} \\, dl \\right) dt $$\nThis establishes the required relationship.\n\nTo evaluate this quantity numerically, we calculate the signed area of the quadrilateral formed by the face's initial and final positions. The vertices of this quadrilateral are $A^n$, $B^n$, $B^{n+1}$, and $A^{n+1}$.\n\nFirst, we determine the positions of the endpoints at time $t^{n+1} = t^n + \\Delta t$:\nThe position vector of a point $\\boldsymbol{x}$ moving with a constant velocity $\\boldsymbol{w}$ is given by $\\boldsymbol{x}(t) = \\boldsymbol{x}(t_0) + \\boldsymbol{w}(t-t_0)$.\nFor endpoint A:\n$$ \\boldsymbol{x}_{A}^{n+1} = \\boldsymbol{x}_{A}^{n} + \\boldsymbol{w}_{A} \\Delta t = (1.2, 0.7) + (0.4, -0.2) \\times 0.02 = (1.2 + 0.008, 0.7 - 0.004) = (1.208, 0.696) $$\nFor endpoint B:\n$$ \\boldsymbol{x}_{B}^{n+1} = \\boldsymbol{x}_{B}^{n} + \\boldsymbol{w}_{B} \\Delta t = (3.0, 1.6) + (-0.1, 0.3) \\times 0.02 = (3.0 - 0.002, 1.6 + 0.006) = (2.998, 1.606) $$\n\nThe four vertices of the swept quadrilateral, in order $A^n \\to B^n \\to B^{n+1} \\to A^{n+1}$, are:\n$P_1 = (x_1, y_1) = (1.2, 0.7)$\n$P_2 = (x_2, y_2) = (3.0, 1.6)$\n$P_3 = (x_3, y_3) = (2.998, 1.606)$\n$P_4 = (x_4, y_4) = (1.208, 0.696)$\n\nThe signed area of this polygon can be calculated using the shoelace formula:\n$$ \\text{Area} = \\frac{1}{2} \\sum_{i=1}^{4} (x_i y_{i+1} - x_{i+1} y_i) $$\nwhere $(x_5, y_5) = (x_1, y_1)$.\n$$ \\text{Area} = \\frac{1}{2} [ (x_1y_2 - x_2y_1) + (x_2y_3 - x_3y_2) + (x_3y_4 - x_4y_3) + (x_4y_1 - x_1y_4) ] $$\nLet's compute each term:\n- Term 1: $(1.2)(1.6) - (3.0)(0.7) = 1.92 - 2.1 = -0.18$\n- Term 2: $(3.0)(1.606) - (2.998)(1.6) = 4.818 - 4.7968 = 0.0212$\n- Term 3: $(2.998)(0.696) - (1.208)(1.606) = 2.086608 - 1.940048 = 0.14656$\n- Term 4: $(1.208)(0.7) - (1.2)(0.696) = 0.8456 - 0.8352 = 0.0104$\n\nSumming the terms:\n$$ \\text{Sum} = -0.18 + 0.0212 + 0.14656 + 0.0104 = -0.00184 $$\nThe signed area is:\n$$ \\text{Area} = \\frac{1}{2} (-0.00184) = -0.00092 \\, \\text{m}^2 $$\nThe problem asks for the answer to be rounded to four significant figures. The exact result is $-0.00092$, which is $-9.2 \\times 10^{-4}$ in scientific notation. To express this with four significant figures, we append two zeros.\n$$ \\text{Signed Swept Area} = -0.0009200 \\, \\text{m}^2 $$\nThis value represents the signed time-integrated grid flux across the face. The negative sign indicates that the net effect of the grid motion is a decrease in the area of the control volume associated with this face (assuming the face $A \\to B$ is part of a counter-clockwise traversal of the control volume boundary).",
            "answer": "$$\\boxed{-0.0009200}$$"
        },
        {
            "introduction": "While the previous exercise focused on a single calculation, building a robust numerical solver requires a general framework that maintains accuracy for arbitrary grid motion. This practice elevates the challenge from a specific instance to the general theory, tasking you with deriving the precise conditions under which a common time-discretization scheme satisfies the GCL to second-order accuracy. Successfully completing this derivation reveals the core recipe for implementing a high-fidelity Arbitrary Lagrangian-Eulerian (ALE) method that preserves uniform flow states .",
            "id": "3962139",
            "problem": "Consider a three-dimensional finite-volume discretization of a compressible flow in the Arbitrary Lagrangian-Eulerian (ALE) frame on a moving grid. Let a control volume (cell) $C(t)$ with volume $V(t)$ be bounded by a set of planar faces $f \\in \\mathcal{F}(t)$, each with oriented face area vector $\\boldsymbol{A}_f(t)$ and face centroid position $\\boldsymbol{x}_f(t)$. The grid velocity at face $f$ is defined as $\\boldsymbol{v}_{g,f}(t) = \\frac{d \\boldsymbol{x}_f}{dt}(t)$. The discrete update of the conserved variables is advanced in time with a one-step $\\theta$-method using a single time step $\\Delta t = t^{n+1} - t^{n}$, where face-based geometric quantities and fluxes are evaluated at the intermediate time $t^{n+\\theta} = t^{n} + \\theta \\,\\Delta t$.\n\nThe Geometric Conservation Law (GCL) requires that a uniform conservative state remains exactly uniform under grid motion when discretized. Starting from the Reynolds transport theorem applied to the scalar field $\\phi(\\boldsymbol{x},t) \\equiv 1$ over the moving control volume $C(t)$, and using only definitions of kinematics and standard time-discretization principles, derive the conditions on the parameter $\\theta$ and on how the face area vector $\\boldsymbol{A}_f$ and the grid velocity $\\boldsymbol{v}_{g,f}$ must be evaluated in time such that:\n- the time-discrete identity equating the control-volume change to the grid-velocity flux is satisfied to second order in time, and\n- the scheme preserves a uniform state through one time step with second-order temporal accuracy.\n\nYour final answer must be a single closed-form analytic expression consisting of the value of $\\theta$ and the second-order consistent evaluations for $\\boldsymbol{A}_f$ and $\\boldsymbol{v}_{g,f}$ at the required time level. No numerical rounding is needed, and no physical units should be included in the final expression. Express multiple components of the final expression as a single row matrix using LaTeX’s $\\mathrm{pmatrix}$ environment.",
            "solution": "The problem requires the derivation of conditions for a second-order accurate Geometric Conservation Law (GCL) for a finite-volume scheme on a moving grid using a one-step $\\theta$-method.\n\nThe starting point is the Reynolds transport theorem for an arbitrary moving control volume $C(t)$ with volume $V(t)$ and boundary $\\partial C(t)$. For a scalar field $\\phi(\\boldsymbol{x}, t)$, the theorem states:\n$$\n\\frac{d}{dt} \\int_{C(t)} \\phi \\, dV = \\int_{C(t)} \\frac{\\partial \\phi}{\\partial t} \\, dV + \\oint_{\\partial C(t)} \\phi \\, \\boldsymbol{v}_g \\cdot d\\boldsymbol{A}\n$$\nwhere $\\boldsymbol{v}_g$ is the velocity of the boundary $\\partial C(t)$, and $d\\boldsymbol{A}$ is the outward-pointing differential area vector.\n\nThe Geometric Conservation Law is obtained by setting the scalar field $\\phi \\equiv 1$. In this case, $\\phi$ is constant in both space and time, so $\\frac{\\partial \\phi}{\\partial t} = 0$. The integral of $\\phi$ over the volume $C(t)$ is simply the volume $V(t)$. The Reynolds transport theorem thus simplifies to a purely kinematic identity:\n$$\n\\frac{dV(t)}{dt} = \\oint_{\\partial C(t)} \\boldsymbol{v}_g \\cdot d\\boldsymbol{A}\n$$\nThis is the continuous form of the GCL. It means the rate of change of the cell volume is equal to the flux of the grid velocity through the cell's boundary.\n\nFor a finite-volume discretization, the control volume $C(t)$ is a cell bounded by a set of planar faces $f$. The surface integral is replaced by a sum over the faces:\n$$\n\\frac{dV(t)}{dt} = \\sum_{f \\in \\mathcal{F}(t)} \\boldsymbol{v}_{g,f}(t) \\cdot \\boldsymbol{A}_f(t)\n$$\nwhere $\\boldsymbol{v}_{g,f}(t)$ is the grid velocity at the centroid of face $f$ and $\\boldsymbol{A}_f(t)$ is the oriented area vector of face $f$.\n\nThe problem states that this equation is discretized in time using a one-step $\\theta$-method, with quantities evaluated at the intermediate time $t^{n+\\theta} = t^n + \\theta \\Delta t$. The discrete form of the GCL is therefore:\n$$\n\\frac{V^{n+1} - V^n}{\\Delta t} = \\sum_{f} \\left( \\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f \\right)^{n+\\theta}\n$$\nwhere the superscripts $n$ and $n+1$ denote evaluation at times $t^n$ and $t^{n+1} = t^n + \\Delta t$, respectively. The term on the left represents the time derivative of the volume, and the term on the right represents the flux of the grid velocity. To satisfy the GCL with second-order temporal accuracy, the error in this equation must be of order $O(\\Delta t^2)$.\n\nLet's analyze both sides of the equation using Taylor series expansions around the time $t^{n+\\theta}$.\nThe left-hand side (LHS) is an approximation of the time derivative $\\frac{dV}{dt}$. Let's expand $V^{n+1}$ and $V^n$ around $t^{n+\\theta}$:\n$$\nV^{n+1} = V(t^{n+\\theta} + (1-\\theta)\\Delta t) = V^{n+\\theta} + (1-\\theta)\\Delta t \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{((1-\\theta)\\Delta t)^2}{2} \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^3)\n$$\n$$\nV^{n} = V(t^{n+\\theta} - \\theta\\Delta t) = V^{n+\\theta} - \\theta\\Delta t \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{(-\\theta\\Delta t)^2}{2} \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^3)\n$$\nSubtracting the second expansion from the first and dividing by $\\Delta t$:\n$$\n\\frac{V^{n+1} - V^{n}}{\\Delta t} = \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{(1-\\theta)^2 - \\theta^2}{2} \\Delta t \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^2)\n$$\n$$\n\\frac{V^{n+1} - V^{n}}{\\Delta t} = \\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{1-2\\theta}{2} \\Delta t \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^2)\n$$\nThe right-hand side (RHS) of the discrete GCL is by definition the evaluation of the grid velocity flux at $t^{n+\\theta}$:\n$$\n\\text{RHS} = \\sum_{f} \\left( \\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f \\right)^{n+\\theta} = \\left( \\oint_{\\partial C} \\boldsymbol{v}_g \\cdot d\\boldsymbol{A} \\right)^{n+\\theta}\n$$\nFrom the continuous GCL, this is equal to $\\left(\\frac{dV}{dt}\\right)^{n+\\theta}$.\nEquating the expansion of the LHS with the RHS:\n$$\n\\left(\\frac{dV}{dt}\\right)^{n+\\theta} + \\frac{1-2\\theta}{2} \\Delta t \\left(\\frac{d^2V}{dt^2}\\right)^{n+\\theta} + O(\\Delta t^2) = \\left(\\frac{dV}{dt}\\right)^{n+\\theta}\n$$\nFor this equality to hold with an error of $O(\\Delta t^2)$, the first-order error term (proportional to $\\Delta t$) must vanish. Assuming a general grid motion where $\\frac{d^2V}{dt^2} \\neq 0$, we require:\n$$\n\\frac{1-2\\theta}{2} = 0 \\implies \\theta = \\frac{1}{2}\n$$\nThis establishes that the time integration must be centered (equivalent to the Crank-Nicolson method) to achieve second-order temporal accuracy. The evaluation time is thus $t^{n+1/2}$.\n\nNext, we must determine how the geometric quantities $\\boldsymbol{v}_{g,f}$ and $\\boldsymbol{A}_f$ are to be evaluated at $t^{n+1/2}$ to maintain second-order accuracy. The scheme requires evaluation of the product $(\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)^{n+1/2}$. We need to find expressions for $\\boldsymbol{v}_{g,f}^{n+1/2}$ and $\\boldsymbol{A}_f^{n+1/2}$ using information at times $t^n$ and $t^{n+1}$ such that their product is a second-order accurate approximation of $(\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)$ at $t^{n+1/2}$.\n\nLet's consider the grid velocity $\\boldsymbol{v}_{g,f} = \\frac{d\\boldsymbol{x}_f}{dt}$. A second-order accurate, centered-difference approximation for the velocity at the midpoint time $t^{n+1/2}$ is given by:\n$$\n\\boldsymbol{v}_{g,f}^{n+1/2} = \\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^{n}}{\\Delta t}\n$$\nTo verify its accuracy, we expand $\\boldsymbol{x}_f^{n+1}$ and $\\boldsymbol{x}_f^{n}$ about $t^{n+1/2}$:\n$$\n\\boldsymbol{x}_f^{n+1} = \\boldsymbol{x}_f^{n+1/2} + \\frac{\\Delta t}{2} \\dot{\\boldsymbol{x}}_f^{n+1/2} + \\frac{(\\Delta t/2)^2}{2!} \\ddot{\\boldsymbol{x}}_f^{n+1/2} + O(\\Delta t^3)\n$$\n$$\n\\boldsymbol{x}_f^{n} = \\boldsymbol{x}_f^{n+1/2} - \\frac{\\Delta t}{2} \\dot{\\boldsymbol{x}}_f^{n+1/2} + \\frac{(\\Delta t/2)^2}{2!} \\ddot{\\boldsymbol{x}}_f^{n+1/2} - O(\\Delta t^3)\n$$\n$$\n\\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^{n}}{\\Delta t} = \\dot{\\boldsymbol{x}}_f^{n+1/2} + O(\\Delta t^2) = \\boldsymbol{v}_{g,f}(t^{n+1/2}) + O(\\Delta t^2)\n$$\nThis approximation is indeed second-order accurate.\n\nFor the face area vector $\\boldsymbol{A}_f$, a natural second-order approximation at $t^{n+1/2}$ is the arithmetic average of its values at $t^n$ and $t^{n+1}$:\n$$\n\\boldsymbol{A}_f^{n+1/2} = \\frac{\\boldsymbol{A}_f^n + \\boldsymbol{A}_f^{n+1}}{2}\n$$\nThe error of this approximation is $O(\\Delta t^2)$:\n$$\n\\frac{\\boldsymbol{A}_f^n + \\boldsymbol{A}_f^{n+1}}{2} = \\frac{1}{2}\\left[\\left(\\boldsymbol{A}_f^{n+1/2} \\!-\\! \\frac{\\Delta t}{2} \\dot{\\boldsymbol{A}}_f^{n+1/2} \\!+\\! O(\\Delta t^2)\\right) \\!+\\! \\left(\\boldsymbol{A}_f^{n+1/2} \\!+\\! \\frac{\\Delta t}{2} \\dot{\\boldsymbol{A}}_f^{n+1/2} \\!+\\! O(\\Delta t^2)\\right)\\right] = \\boldsymbol{A}_f(t^{n+1/2}) + O(\\Delta t^2)\n$$\n\nWith these definitions, the product of the approximations is also second-order accurate:\n$$\n\\boldsymbol{v}_{g,f}^{n+1/2} \\cdot \\boldsymbol{A}_f^{n+1/2} = (\\boldsymbol{v}_{g,f}(t^{n+1/2}) + O(\\Delta t^2)) \\cdot (\\boldsymbol{A}_f(t^{n+1/2}) + O(\\Delta t^2)) = (\\boldsymbol{v}_{g,f} \\cdot \\boldsymbol{A}_f)^{n+1/2} + O(\\Delta t^2)\n$$\nThus, the discrete GCL equation is satisfied to second-order accuracy.\n\nThe second part of the problem asks that the scheme preserves a uniform state with second-order accuracy. In a flow with a uniform conservative state vector $\\boldsymbol{U}_{const}$, the discretized governing equation for a cell $C$ is:\n$$\n\\frac{\\boldsymbol{U}_{C}^{n+1}V^{n+1} - \\boldsymbol{U}_{C}^{n}V^{n}}{\\Delta t} + \\sum_{f} \\boldsymbol{\\mathcal{F}}_f^{n+1/2} = 0\n$$\nIf $\\boldsymbol{U}_{C}^n = \\boldsymbol{U}_{const}$ for all cells, then for the state to be preserved, we must have $\\boldsymbol{U}_{C}^{n+1} = \\boldsymbol{U}_{const}$. The equation becomes:\n$$\n\\boldsymbol{U}_{const} \\left(\\frac{V^{n+1} - V^{n}}{\\Delta t}\\right) + \\sum_{f} \\boldsymbol{\\mathcal{F}}_f^{n+1/2} = 0\n$$\nFor a uniform state, the physical flux is constant on all faces, and the numerical flux $\\boldsymbol{\\mathcal{F}}_f$ simplifies. For the Euler equations, for example, the flux is $\\boldsymbol{F}(\\boldsymbol{U}) - \\boldsymbol{U} (\\boldsymbol{v}_{g,f})^T$. For a uniform state, this leads to a condition on the geometric terms. The discrete sum of physical fluxes over a closed cell is zero, $\\sum_f \\boldsymbol{F}(\\boldsymbol{U}_{const}) \\cdot \\boldsymbol{A}_f^{n+1/2} = \\boldsymbol{F}(\\boldsymbol{U}_{const}) \\cdot (\\sum_f \\boldsymbol{A}_f^{n+1/2}) = 0$. The remaining terms give:\n$$\n\\boldsymbol{U}_{const} \\left(\\frac{V^{n+1} - V^{n}}{\\Delta t}\\right) - \\sum_{f} \\boldsymbol{U}_{const} (\\boldsymbol{v}_{g,f}^{n+1/2})^T \\boldsymbol{A}_f^{n+1/2} = 0\n$$\nFactoring out $\\boldsymbol{U}_{const}$ yields exactly the discrete GCL:\n$$\n\\frac{V^{n+1} - V^{n}}{\\Delta t} - \\sum_{f} \\boldsymbol{v}_{g,f}^{n+1/2} \\cdot \\boldsymbol{A}_f^{n+1/2} = 0\n$$\nTherefore, satisfying the GCL to second order is the necessary and sufficient condition to preserve a uniform state with second-order accuracy.\n\nIn summary, the three required conditions are:\n1.  The time-integration parameter must be $\\theta = 1/2$.\n2.  The face area vector at the intermediate time must be evaluated as the arithmetic mean: $\\boldsymbol{A}_f^{n+1/2} = \\frac{\\boldsymbol{A}_f^n + \\boldsymbol{A}_f^{n+1}}{2}$.\n3.  The face grid velocity at the intermediate time must be evaluated using a centered difference of face centroid positions: $\\boldsymbol{v}_{g,f}^{n+1/2} = \\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^n}{\\Delta t}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} & \\frac{\\boldsymbol{A}_f^{n} + \\boldsymbol{A}_f^{n+1}}{2} & \\frac{\\boldsymbol{x}_f^{n+1} - \\boldsymbol{x}_f^{n}}{\\Delta t}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Theory and derivation are essential, but the true importance of the Geometric Conservation Law is revealed by the dramatic failures that occur when it is violated. This final hands-on practice is a numerical experiment where you will write a small program to witness these consequences firsthand. You will implement both a GCL-compliant and a GCL-violating scheme to observe how a seemingly subtle inconsistency generates non-physical, spurious pressure oscillations in a simple uniform flow, providing a tangible demonstration of why strict adherence to the GCL is non-negotiable in CFD .",
            "id": "3962168",
            "problem": "You are tasked with constructing a self-contained numerical experiment that exposes the necessity of the Geometric Conservation Law (GCL) in Arbitrary Lagrangian–Eulerian (ALE) formulations for moving meshes in Computational Fluid Dynamics (CFD). Starting from the fundamental control-volume form of conservation for a moving mesh, derive and implement a minimal one-dimensional finite-volume update that demonstrates how inconsistency between the control-volume change and the grid-advection flux produces spurious pressure oscillations in a uniform flow. Your program must be a complete, runnable implementation.\n\nThe base you must use is the integral conservation law on a moving control volume and the ideal-gas equation of state:\n- The integral conservation law: for a conserved state vector $U$ and physical flux $F$, on a control volume $\\Omega(t)$ with boundary $\\partial \\Omega(t)$ and outward unit normal $\\boldsymbol{n}$, the Arbitrary Lagrangian–Eulerian (ALE) form of conservation states\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega(t)} U \\,\\mathrm{d}\\Omega + \\oint_{\\partial \\Omega(t)} \\left(F - U \\,\\boldsymbol{w}\\right)\\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\nwhere $\\boldsymbol{w}$ is the mesh velocity.\n- The Geometric Conservation Law (GCL): the control-volume time rate of change must satisfy\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left|\\Omega(t)\\right| = \\oint_{\\partial \\Omega(t)} \\boldsymbol{w}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S,\n$$\nso that uniform solutions are preserved under mesh motion.\n- The ideal-gas equation of state: with ratio of specific heats $\\gamma$, density $\\rho$, velocity $u$, specific total energy $E$, and specific internal energy $e = E - \\tfrac{1}{2}u^2$, the pressure is\n$$\np = (\\gamma - 1)\\,\\rho\\,e.\n$$\n\nYou must design a manufactured one-dimensional mesh motion and a uniform initial state that make any violation of the discrete GCL manifest as a spurious pressure oscillation. Implement a first-order, cell-centered finite-volume update for the conserved variables on a one-dimensional mesh with moving faces, assuming a uniform initial flow with zero physical flux. The key idea is that, for a uniform state $U$ with zero physical flux, the update reduces to a balance between the control-volume change and the grid-advection term. If these are discretely inconsistent (violating the GCL), then the scheme introduces a non-zero update to $U$, which appears as a spurious pressure change via the ideal-gas relation.\n\nManufacture a sinusoidal mesh motion for the face locations $x_i(t)$ in meters:\n$$\nx_i(t) = x_i(0) + A\\,\\sin\\!\\left(\\omega\\,t + \\phi_i\\right),\n$$\nwhere $A$ is the amplitude in meters, $\\omega$ is the angular frequency in radians per second, and $\\phi_i = \\beta\\,i$ is a phase shift in radians indexed by face $i$. The face velocity is then\n$$\nw_i(t) = \\frac{\\mathrm{d}x_i}{\\mathrm{d}t} = A\\,\\omega\\,\\cos\\!\\left(\\omega\\,t + \\phi_i\\right).\n$$\n\nLet the initial domain be $[0,L]$ with $N$ uniform cells, face indices $i=0,\\dots,N$, and cell indices $j=0,\\dots,N-1$. The initial face positions are $x_i(0) = i\\,\\Delta x$ with $\\Delta x = L/N$, and the initial uniform state is a quiescent ideal-gas with density $\\rho_0$ in kilograms per cubic meter, velocity $u_0 = 0$ in meters per second, and pressure $p_0$ in Pascals. The initial specific internal energy $e_0$ in joules per kilogram must satisfy $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$.\n\nConstruct a discrete update over time steps of size $\\Delta t$ seconds. At time $t_n = n\\,\\Delta t$, define the cell volumes $V_j^n = x_{j+1}(t_n) - x_j(t_n)$ and the staged mesh velocity at $t_n^\\star = t_n + \\theta\\,\\Delta t$ as $w_i^\\star = w_i(t_n^\\star)$, where $\\theta \\in [0,1]$ specifies the temporal staging of the grid-advection term. The discrete grid-advection volume change is\n$$\n\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\,\\left( w_{j+1}^\\star - w_j^\\star \\right).\n$$\n\nYou must implement two update modes:\n- A GCL-compliant mode: use the control volume for the update $V_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}$, consistent with the grid-advection term.\n- A GCL-violating mode: use the exact geometric volume $V_j^{n+1,\\mathrm{used}} = V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$ while still computing $\\Delta V_j^{\\mathrm{flux}}$ from the staged velocities at $t_n^\\star$. The discrete GCL residual is then\n$$\n\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right).\n$$\n\nFor a uniform state $U$ and zero physical flux, the finite-volume update of the conserved variables (mass, momentum, and energy densities) over the used control volume reduces to scaling by the ratio induced by the GCL residual. Specifically, for each cell,\n$$\nU_j^{n+1} = U_j^n \\left( 1 - \\frac{\\varepsilon_j^n}{V_j^{n+1,\\mathrm{used}}} \\right),\n$$\nwhich preserves $u=0$ but scales $\\rho$ and $\\rho E$ identically, inducing a pressure change via $p = (\\gamma - 1)\\,\\rho\\,e_0$ with constant $e_0$. Any non-zero $\\varepsilon_j^n$ thereby manifests as a spurious pressure oscillation.\n\nYour program must:\n- Implement the face motion and compute $x_i(t_n)$ and $x_i(t_{n+1})$ exactly from the manufactured motion.\n- Compute $w_i^\\star$ at the staged time $t_n^\\star$ and the discrete flux-based volume change $\\Delta V_j^{\\mathrm{flux}}$.\n- Update the conserved variables using $V_j^{n+1,\\mathrm{used}}$ according to the selected mode (GCL-compliant or GCL-violating).\n- Track the pressure deviation $|p_j^n - p_0|$ over all cells and time steps.\n- Compute diagnostic metrics:\n  1. The maximum absolute pressure deviation over all cells and times in Pascals.\n  2. The root-mean-square pressure deviation over all cells and times in Pascals.\n  3. The maximum absolute GCL residual over all cells and times in meters.\n\nAngle quantities must be expressed in radians. All physical units must be consistent with the International System of Units (SI): meters ($\\mathrm{m}$), seconds ($\\mathrm{s}$), kilograms ($\\mathrm{kg}$), and Pascals ($\\mathrm{Pa}$).\n\nUse the following test suite of parameter sets to exercise distinct behaviors:\n- Case A (happy path, compliant): $N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.01\\,\\mathrm{m}$, $\\omega=20.0\\,\\mathrm{rad/s}$, $\\Delta t=0.005\\,\\mathrm{s}$, $N_t=200$ time steps, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, compliant mode.\n- Case B (violation, oscillations): same as Case A but GCL-violating mode.\n- Case C (edge case, static grid): $N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.0\\,\\mathrm{m}$, $\\omega=20.0\\,\\mathrm{rad/s}$, $\\Delta t=0.005\\,\\mathrm{s}$, $N_t=200$, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, GCL-violating mode.\n- Case D (edge case, higher frequency): $N=20$, $L=1.0\\,\\mathrm{m}$, $A=0.01\\,\\mathrm{m}$, $\\omega=100.0\\,\\mathrm{rad/s}$, $\\Delta t=0.002\\,\\mathrm{s}$, $N_t=300$, $\\beta=0.3\\,\\mathrm{rad}$, $\\theta=0.5$, GCL-violating mode.\n\nAssume the ideal-gas parameters $\\gamma = 1.4$ and initial state $\\rho_0 = 1.0\\,\\mathrm{kg/m^3}$, $u_0 = 0.0\\,\\mathrm{m/s}$, $p_0 = 100000.0\\,\\mathrm{Pa}$, with $e_0$ chosen to satisfy $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case’s result is itself a list of three floats in the order [max absolute pressure deviation, root-mean-square pressure deviation, max absolute GCL residual], for Cases A, B, C, and D respectively. For example: \"[[a1,b1,c1],[a2,b2,c2],[a3,b3,c3],[a4,b4,c4]]\". No other text must be printed.",
            "solution": "We begin from the integral conservation law on a moving control volume in the Arbitrary Lagrangian–Eulerian (ALE) frame. For a conserved state vector $U$ and physical flux $F$, the integral law over a time-dependent control volume $\\Omega(t)$ with boundary $\\partial \\Omega(t)$ is\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega(t)} U \\,\\mathrm{d}\\Omega + \\oint_{\\partial \\Omega(t)} \\left(F - U \\,\\boldsymbol{w}\\right)\\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\nwhere $\\boldsymbol{w}$ is the mesh velocity and $\\boldsymbol{n}$ is the outward normal on the boundary. The grid-advection term $-U\\,\\boldsymbol{w}$ enforces invariance of uniform states under mesh motion, provided the control-volume change and grid-advection are discretely consistent.\n\nThe Geometric Conservation Law (GCL) is the requirement\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left|\\Omega(t)\\right| = \\oint_{\\partial \\Omega(t)} \\boldsymbol{w}\\cdot \\boldsymbol{n}\\,\\mathrm{d}S,\n$$\nwhich guarantees that the volume change matches the net normal grid velocity through the boundary. In the finite-volume context, the discrete counterpart is that the updated control volume must be consistent with the staged grid velocities used in the grid-advection flux.\n\nWe consider a one-dimensional mesh with faces at positions $x_i(t)$ and cells indexed by $j$. The manufactured motion\n$$\nx_i(t) = x_i(0) + A\\,\\sin\\!\\left(\\omega\\,t + \\phi_i\\right),\\quad \\phi_i = \\beta\\,i,\n$$\nhas face velocity\n$$\nw_i(t) = \\frac{\\mathrm{d}x_i}{\\mathrm{d}t} = A\\,\\omega\\,\\cos\\!\\left(\\omega\\,t + \\phi_i\\right).\n$$\nLet the initial domain be $[0,L]$ with $N$ uniform cells, face positions $x_i(0) = i\\,\\Delta x$ with $\\Delta x = L/N$. At time $t_n = n\\,\\Delta t$, the cell volume is $V_j^n = x_{j+1}(t_n) - x_j(t_n)$. Let the staged mesh velocity at $t_n^\\star = t_n + \\theta\\,\\Delta t$ be $w_i^\\star = w_i(t_n^\\star)$, with $\\theta \\in [0,1]$.\n\nThe discrete flux-based volume change, consistent with a first-order explicit finite-volume method using staged velocities, is\n$$\n\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\left( w_{j+1}^\\star - w_j^\\star \\right).\n$$\nThe GCL-compliant update must use the control volume\n$$\nV_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}.\n$$\nIf instead one uses an inconsistent control volume, such as the exact geometric volume $V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$ while retaining the staged grid-advection term computed from $w^\\star$, the discrete GCL residual becomes\n$$\n\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right),\n$$\nwhich is identically zero in the compliant mode and generally non-zero in the violating mode due to the time variation of $w$ over the step and phase differences across faces.\n\nConsider a uniform initial state for the compressible Euler equations: constant density $\\rho_0$, velocity $u_0 = 0$, and pressure $p_0$, with specific internal energy $e_0$ satisfying $p_0 = (\\gamma - 1)\\,\\rho_0\\,e_0$. For uniform $U$ and zero physical flux, the finite-volume update reduces to the balance between the grid-advection flux and the control-volume change. Integrating the one-dimensional ALE law over cell $j$ from $t_n$ to $t_{n+1}$ with the chosen $V_j^{n+1,\\mathrm{used}}$ yields the update for the cell-integrated conserved variables:\n$$\nU_j^{n+1}\\,V_j^{n+1,\\mathrm{used}} = U_j^n\\,V_j^n - \\Delta t\\left[ \\left(F - U\\,w\\right)_{j+1/2} - \\left(F - U\\,w\\right)_{j-1/2} \\right].\n$$\nWith uniform $U$ and zero physical flux $F=0$, the right-hand side simplifies to\n$$\nU_j^{n+1}\\,V_j^{n+1,\\mathrm{used}} = U_j^n\\,V_j^n + \\Delta t\\,U\\,\\left( w_{j+1}^\\star - w_j^\\star \\right) = U_j^n\\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right).\n$$\nThus,\n$$\nU_j^{n+1} = U_j^n \\frac{V_j^n + \\Delta V_j^{\\mathrm{flux}}}{V_j^{n+1,\\mathrm{used}}}\n= U_j^n\\left(1 - \\frac{\\varepsilon_j^n}{V_j^{n+1,\\mathrm{used}}}\\right).\n$$\nThis shows that any non-zero $\\varepsilon_j^n$ scales all conserved components equally. In particular, the velocity $u$ remains zero because both $\\rho$ and $\\rho u$ scale by the same factor, while the specific total energy $E$ per unit mass remains constant because both $\\rho E$ and $\\rho$ scale identically. Therefore, the pressure computed from the ideal-gas equation of state\n$$\np_j^n = (\\gamma - 1)\\,\\rho_j^n\\,e_0\n$$\nresponds linearly to the density scaling induced by the GCL residual. Any non-zero $\\varepsilon_j^n$ produces spurious pressure oscillations, even though the physical solution should remain uniform.\n\nAlgorithmic design:\n- Initialize the mesh faces $x_i(0)$, cell volumes $V_j^0$, and the uniform state $(\\rho_0,u_0=0,p_0,e_0)$ with $e_0 = p_0/((\\gamma-1)\\rho_0)$.\n- For each time step $n$:\n  - Compute $x_i(t_n)$ and $x_i(t_{n+1})$ exactly from the manufactured motion $x_i(t)$ with given $(A,\\omega,\\beta)$, ensuring units: meters for positions, seconds for time, radians for angles.\n  - Compute staged mesh velocities $w_i^\\star = A\\,\\omega\\,\\cos(\\omega(t_n+\\theta\\Delta t)+\\phi_i)$ at $t_n^\\star$.\n  - Compute $V_j^n = x_{j+1}(t_n) - x_j(t_n)$ and $V_j^{n+1} = x_{j+1}(t_{n+1}) - x_j(t_{n+1})$.\n  - Compute $\\Delta V_j^{\\mathrm{flux}} = \\Delta t\\left( w_{j+1}^\\star - w_j^\\star \\right)$.\n  - Set $V_j^{n+1,\\mathrm{used}} = V_j^n + \\Delta V_j^{\\mathrm{flux}}$ (GCL-compliant mode) or $V_j^{n+1,\\mathrm{used}} = V_j^{n+1}$ (GCL-violating mode).\n  - Compute $\\varepsilon_j^n = V_j^{n+1,\\mathrm{used}} - \\left( V_j^n + \\Delta V_j^{\\mathrm{flux}} \\right)$.\n  - Update $\\rho_j^{n+1} = \\rho_j^n\\left(1 - \\varepsilon_j^n/V_j^{n+1,\\mathrm{used}}\\right)$; keep $u_j^{n+1}=0$ and $e_0$ constant; compute $p_j^{n+1} = (\\gamma - 1)\\,\\rho_j^{n+1}\\,e_0$.\n  - Record the absolute pressure deviation $|p_j^{n+1} - p_0|$ and the residual $|\\varepsilon_j^n|$.\n- After all steps, compute:\n  - The maximum absolute pressure deviation over all $j,n$ in Pascals.\n  - The root-mean-square (RMS) pressure deviation $\\sqrt{\\frac{1}{N\\,N_t}\\sum_{n=1}^{N_t}\\sum_{j=0}^{N-1}(p_j^n - p_0)^2}$ in Pascals.\n  - The maximum absolute GCL residual $\\max_{j,n}|\\varepsilon_j^n|$ in meters.\n\nEdge-case analysis and expectations:\n- In the GCL-compliant mode, $\\varepsilon_j^n=0$ by construction, thus $\\rho_j^n$ and $p_j^n$ remain equal to $\\rho_0$ and $p_0$ for all $n$, so both the maximum and RMS pressure deviations are zero to within floating-point roundoff.\n- In the GCL-violating mode with non-zero mesh motion and time-varying $w^\\star$, $\\varepsilon_j^n$ is generally non-zero, producing non-zero pressure deviations. The magnitude grows with increased $\\omega$ and accumulated time steps.\n- In the static-grid edge case ($A=0$), $w^\\star=0$ and $x_i(t)$ is constant, so $\\Delta V_j^{\\mathrm{flux}}=0$ and $V_j^{n+1}=V_j^n$, implying $\\varepsilon_j^n=0$ even in the violating mode. Pressure deviations remain zero.\n\nYour program must implement the four test cases specified in the problem statement and output a single line containing a list of four lists, each inner list holding three floats: $[\\text{max abs pressure deviation in Pa}, \\text{RMS pressure deviation in Pa}, \\text{max abs GCL residual in m}]$, in the order Case A, Case B, Case C, Case D. No other text should be printed.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_case(N, L, A, omega, dt, Nt, beta, theta, compliant,\n             gamma=1.4, rho0=1.0, p0=100000.0):\n    # Derived initial quantities\n    e0 = p0 / ((gamma - 1.0) * rho0)  # specific internal energy [J/kg]\n    # Face indices 0..N\n    i_faces = np.arange(N + 1, dtype=np.int64)\n    # Initial face positions [m]\n    x0 = i_faces * (L / N)\n    # Phase per face [rad]\n    phi = beta * i_faces\n\n    # Storage for diagnostics\n    max_abs_pressure_dev = 0.0\n    sum_sq_pressure_dev = 0.0\n    max_abs_gcl_residual = 0.0\n    count = 0\n\n    # Initialize density per cell [kg/m^3]\n    rho = np.full(N, rho0, dtype=np.float64)\n\n    # Time loop\n    for n in range(Nt):\n        t_n = n * dt\n        t_np1 = (n + 1) * dt\n        t_star = t_n + theta * dt\n\n        # Analytic face positions at t_n and t_{n+1}\n        x_n = x0 + A * np.sin(omega * t_n + phi)         # [m]\n        x_np1 = x0 + A * np.sin(omega * t_np1 + phi)     # [m]\n\n        # Staged mesh velocities at t_star\n        w_star = A * omega * np.cos(omega * t_star + phi)  # [m/s]\n\n        # Cell volumes at t_n and t_{n+1}\n        V_n = x_n[1:] - x_n[:-1]          # [m]\n        V_np1 = x_np1[1:] - x_np1[:-1]    # [m]\n\n        # Flux-based discrete volume change\n        dV_flux = dt * (w_star[1:] - w_star[:-1])  # [m]\n\n        # Used control volume at n+1\n        if compliant:\n            V_used_np1 = V_n + dV_flux\n        else:\n            V_used_np1 = V_np1\n\n        # GCL residual epsilon\n        epsilon = V_used_np1 - (V_n + dV_flux)  # [m]\n\n        # Update density using multiplicative factor\n        # Factor = 1 - epsilon / V_used_np1\n        # Guard against division by tiny V_used_np1 (should not happen if motion is mild)\n        factor = 1.0 - np.divide(epsilon, V_used_np1, where=(V_used_np1 != 0.0))\n\n        rho *= factor  # [kg/m^3]\n\n        # Pressure from ideal gas with constant e0\n        p = (gamma - 1.0) * rho * e0  # [Pa]\n\n        # Diagnostics\n        abs_dev = np.abs(p - p0)\n        max_abs_pressure_dev = max(max_abs_pressure_dev, float(np.max(abs_dev)))\n        max_abs_gcl_residual = max(max_abs_gcl_residual, float(np.max(np.abs(epsilon))))\n        sum_sq_pressure_dev += float(np.sum(abs_dev**2))\n        count += N\n\n    # RMS pressure deviation over all cells and time steps\n    rms_pressure_dev = np.sqrt(sum_sq_pressure_dev / count) if count > 0 else 0.0\n\n    return [max_abs_pressure_dev, rms_pressure_dev, max_abs_gcl_residual]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: GCL compliant, happy path\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": True},\n        # Case B: GCL violation, oscillations expected\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n        # Case C: Static grid edge case (A=0), violation mode but zero motion\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.0,  \"omega\": 20.0, \"dt\": 0.005, \"Nt\": 200, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n        # Case D: Higher frequency, violation mode\n        {\"N\": 20, \"L\": 1.0, \"A\": 0.01, \"omega\": 100.0, \"dt\": 0.002, \"Nt\": 300, \"beta\": 0.3, \"theta\": 0.5, \"compliant\": False},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_case(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Each result is a list of three floats; we print the overall list of lists.\n    # Ensure plain Python list formatting.\n    print(f\"[{','.join([str(res) for res in results])}]\")\n\nsolve()\n```"
        }
    ]
}