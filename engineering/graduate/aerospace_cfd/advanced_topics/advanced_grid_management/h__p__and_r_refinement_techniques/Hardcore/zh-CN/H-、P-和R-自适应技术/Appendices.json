{
    "hands_on_practices": [
        {
            "introduction": "任何数值格式都是对真实物理过程的近似，这会引入误差，这些误差可分为耗散性（衰减波）或色散性（扭曲波速）。这项练习  对一个简单的模型进行了基础的误差分析，揭示了这些误差如何依赖于网格尺寸 $h$ 和多项式阶数 $p$。理解这一点是解读 CFD 结果并就网格加密做出明智选择的关键。",
            "id": "3964562",
            "problem": "考虑周期域上的一维线性平流方程，\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\n其中 $a>0$ 是一个恒定的平流速度。该方程在空间上使用谱元法进行离散化，网格由大小为 $h$ 的均匀单元构成，每个单元内使用 $p$ 次多项式。对于单元间的耦合，使用迎风数值通量。为了与波传播的傅里叶分析联系起来，假设解在单元网格上由单元中心的模态值表示。\n\n将分析具体到分段常数情况 $p=0$（这是最低阶的谱元或间断伽辽金近似），单元大小为均匀的 $h$，并使用迎风数值通量。在这种情况下，对于正平流速度 $a$，其半离散格式可以为位于 $x_j = j h$ 位置的单元索引值 $u_j(t)$ 写为\n$$\n\\frac{d u_j}{d t} = -\\frac{a}{h} \\left( u_j - u_{j-1} \\right).\n$$\n通过考虑波数为 $k$ 的离散傅里叶模态 $u_j(t) = \\hat{u}(t) \\exp(i k x_j)$，进行傅里叶或冯·诺依曼分析，并推导半离散色散关系。根据此色散关系，定义：\n- 数值相速度 $c_{\\mathrm{num}}(k)$，通过 $-\\Im(\\lambda(k)) = c_{\\mathrm{num}}(k)\\,k$ 定义，其中 $\\lambda(k)$ 是作用于傅里叶模态的半离散算子的特征值，以及\n- 数值耗散率 $d_{\\mathrm{num}}(k)$，通过 $d_{\\mathrm{num}}(k) = -\\Re(\\lambda(k))$ 定义。\n\n计算这些色散和耗散特性，作为单元大小 $h$ 和波数 $k$ 的显式函数。然后，通过讨论对于小的无量纲波数 $kh$，主阶色散和耗散行为如何随 $p$ 变化，来解释 $h$-细化（减小 $h$）和 $p$-细化（增加 $p$）之间的权衡。\n\n你的最终答案必须是数值相速度与精确相速度之比 $c_{\\mathrm{num}}(k)/a$ 的单个闭式解析表达式，表示为无量纲量 $kh$ 的函数。不需要进行数值计算。最终答案中不要包含单位。在此上下文中，所有角度都是无量纲的。如果在推理过程中进行任何小 $kh$ 展开，请保持常数为符号形式，除非为清晰起见绝对必要，否则避免数值代入。最终方框中的答案必须是所要求的比率的精确解析形式。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 步骤 1：提取给定条件\n-   **控制方程**：一维线性平流方程为 $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$，其中 $a>0$ 是一个恒定的平流速度。\n-   **域**：周期性。\n-   **离散化方法**：谱元法，在大小为 $h$ 的均匀单元网格上使用 $p$ 次多项式。\n-   **单元间通量**：迎风数值通量。\n-   **分析特例**：分段常数近似 ($p=0$)，单元大小为均匀的 $h$。\n-   **半离散格式**：对于位于 $x_j = j h$ 位置的单元索引值 $u_j(t)$，格式由 $\\frac{d u_j}{d t} = -\\frac{a}{h} \\left( u_j - u_{j-1} \\right)$ 给出。\n-   **分析方法**：傅里叶或冯·诺依曼分析，使用波数为 $k$ 的离散傅里叶模态 $u_j(t) = \\hat{u}(t) \\exp(i k x_j)$。\n-   **定义**：\n    -   $\\lambda(k)$ 是作用于傅里叶模态的半离散算子的特征值。\n    -   数值相速度 $c_{\\mathrm{num}}(k)$ 由 $-\\Im(\\lambda(k)) = c_{\\mathrm{num}}(k)\\,k$ 定义。\n    -   数值耗散率 $d_{\\mathrm{num}}(k)$ 由 $d_{\\mathrm{num}}(k) = -\\Re(\\lambda(k))$ 定义。\n-   **任务**：\n    1.  计算 $c_{\\mathrm{num}}(k)$ 和 $d_{\\mathrm{num}}(k)$，作为 $h$ 和 $k$ 的显式函数。\n    2.  通过讨论对于小 $kh$ 的主阶色散和耗散，解释 $h$-细化和 $p$-细化之间的权衡。\n    3.  最终答案必须是比率 $c_{\\mathrm{num}}(k)/a$。\n\n### 步骤 2：使用提取的给定条件进行验证\n-   **科学依据**：该问题是偏微分方程数值分析中的一个标准基础练习，具体分析了线性平流方程的一阶迎风格式的性质。它牢固地建立在公认的数学原理之上。\n-   **适定性**：问题陈述清晰，提供了要分析的精确半离散方程以及要推导的量的明确定义。存在唯一解。\n-   **客观性**：语言精确、技术性强，没有任何主观性或含糊不清之处。\n-   **完整性**：所有必要信息（半离散方程、傅里叶模态形式和定义）都已提供。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它科学合理、适定、客观且自洽。将提供完整解答。\n\n分析从给定的单元平均值 $u_j(t)$ 的半离散方程开始：\n$$\n\\frac{d u_j}{d t} = -\\frac{a}{h} \\left( u_j - u_{j-1} \\right)\n$$\n我们通过代入离散傅里叶模态 $u_j(t) = \\hat{u}(t) \\exp(i k x_j)$（其中 $x_j = j h$）来进行冯·诺依曼稳定性分析。左侧的时间导数变为：\n$$\n\\frac{d}{dt} \\left( \\hat{u}(t) \\exp(i k j h) \\right) = \\frac{d\\hat{u}}{dt} \\exp(i k j h)\n$$\n右侧变为：\n$$\n-\\frac{a}{h} \\left( \\hat{u}(t) \\exp(i k j h) - \\hat{u}(t) \\exp(i k (j-1) h) \\right)\n$$\n将两侧相等并除以公因子 $\\exp(i k j h)$，得到模态振幅 $\\hat{u}(t)$ 的常微分方程：\n$$\n\\frac{d\\hat{u}}{dt} = -\\frac{a}{h} \\left( \\hat{u}(t) - \\hat{u}(t) \\exp(-i k h) \\right) = \\left[ -\\frac{a}{h} \\left( 1 - \\exp(-i k h) \\right) \\right] \\hat{u}(t)\n$$\n该方程的形式为 $\\frac{d\\hat{u}}{dt} = \\lambda(k) \\hat{u}$。因此，半离散算子的特征值 $\\lambda(k)$ 是：\n$$\n\\lambda(k) = -\\frac{a}{h} \\left( 1 - \\exp(-i k h) \\right)\n$$\n为了求出 $\\lambda(k)$ 的实部和虚部，我们使用欧拉公式 $\\exp(-i\\theta) = \\cos(\\theta) - i\\sin(\\theta)$：\n$$\n\\lambda(k) = -\\frac{a}{h} \\left( 1 - (\\cos(kh) - i\\sin(kh)) \\right) = -\\frac{a}{h} (1 - \\cos(kh)) - i \\frac{a}{h} \\sin(kh)\n$$\n由此，我们确定实部和虚部：\n$$\n\\Re(\\lambda(k)) = -\\frac{a}{h} (1 - \\cos(kh))\n$$\n$$\n\\Im(\\lambda(k)) = -\\frac{a}{h} \\sin(kh)\n$$\n使用问题中提供的定义，我们现在可以计算数值耗散率和相速度。数值耗散率 $d_{\\mathrm{num}}(k)$ 为：\n$$\nd_{\\mathrm{num}}(k) = -\\Re(\\lambda(k)) = - \\left( -\\frac{a}{h} (1 - \\cos(kh)) \\right) = \\frac{a}{h} (1 - \\cos(kh))\n$$\n数值相速度 $c_{\\mathrm{num}}(k)$ 由关系式 $-\\Im(\\lambda(k)) = c_{\\mathrm{num}}(k)\\,k$ 定义。代入 $\\Im(\\lambda(k))$ 的表达式：\n$$\n- \\left( -\\frac{a}{h} \\sin(kh) \\right) = c_{\\mathrm{num}}(k)\\,k\n$$\n$$\n\\frac{a}{h} \\sin(kh) = c_{\\mathrm{num}}(k)\\,k\n$$\n求解 $c_{\\mathrm{num}}(k)$ 得：\n$$\nc_{\\mathrm{num}}(k) = \\frac{a \\sin(kh)}{kh}\n$$\n连续平流方程 $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$ 的精确相速度是常数 $a$。因此，数值相速度与精确相速度之比为：\n$$\n\\frac{c_{\\mathrm{num}}(k)}{a} = \\frac{\\frac{a \\sin(kh)}{kh}}{a} = \\frac{\\sin(kh)}{kh}\n$$\n这提供了所需的解析表达式。\n\n为了解释 h-p 权衡，我们分析了在小的无量纲波数 $kh \\ll 1$ 时，所推导量的行为。我们使用 $\\sin(x)$ 和 $\\cos(x)$ 的泰勒级数展开：\n对于相速度比：\n$$\n\\frac{c_{\\mathrm{num}}(k)}{a} = \\frac{kh - \\frac{(kh)^3}{3!} + O((kh)^5)}{kh} = 1 - \\frac{(kh)^2}{6} + O((kh)^4)\n$$\n数值色散误差 $c_{\\mathrm{num}}(k) - a$ 近似为 $-a \\frac{(kh)^2}{6}$。该误差是 $O(h^2)$ 阶的，导致波的传播速度慢于精确速度，这种现象称为相位滞后。\n对于耗散率：\n$$\nd_{\\mathrm{num}}(k) = \\frac{a}{h} \\left( 1 - \\left[1 - \\frac{(kh)^2}{2!} + O((kh)^4)\\right] \\right) = \\frac{a}{h} \\left( \\frac{k^2 h^2}{2} - O(k^4 h^4) \\right) = \\frac{ak^2h}{2} + O(h^3)\n$$\n数值耗散是 $O(h)$ 阶的。由于该格式的主导误差项是 $O(h)$ 的耗散项，因此 $p=0$ 格式（一阶迎风）是一阶精度的。\n\n从这个 $p=0$ 的情况推广，可以解释 $h$-细化和 $p$-细化之间的权衡。\n1.  **精度阶数**：对于多项式阶数为 $p$ 的一般间断伽辽金或谱元格式，其总精度阶数为 $p+1$。对于所分析的 $p=0$ 的情况，该格式为一阶精度，这是吻合的。将 $p$ 增加到 $p=1$（线性元）会得到一个二阶格式，以此类推。\n2.  **收敛性**：\n    -   **$h$-细化**：对于固定的多项式阶数 $p$，减小单元尺寸 $h$ 可以减少数值误差。误差以代数方式收敛到零，与 $h^{p+1}$ 成正比。这是一种稳健但可能较慢的提高精度的方法。\n    -   **$p$-细化**：对于固定的网格（固定的 $h$），增加多项式阶数 $p$ 也能减少误差。对于具有光滑解的问题，这种收敛是指数级的，意味着误差下降速度远快于 $h$-细化。这使得 $p$-细化对此类问题非常高效。\n3.  **误差特性**：权衡的一个关键方面是主导误差项的性质，对于基于迎风通量的格式，该性质随 $p$ 的奇偶性交替变化。\n    -   对于偶数 $p$（例如，$p=0, 2, ...$），主导误差项是耗散性的（与偶数阶导数成正比，如 $p=0$ 时的 $\\frac{\\partial^2 u}{\\partial x^2}$）。这些格式会在数值上衰减波，特别是高频波，这会抹平尖锐梯度，但能防止伪振荡。\n    -   对于奇数 $p$（例如，$p=1, 3, ...$），主导误差项是色散性的（与奇数阶导数成正比，如 $p=1$ 时的 $\\frac{\\partial^3 u}{\\partial x^3}$）。这些格式在主导阶上不增加数值阻尼，更善于保持波幅，但它们可能在不连续或尖锐梯度附近引入非物理振荡（吉布斯现象）。\n\n总而言之，$h$-细化提供了可预测的代数误差减少，而 $p$-细化为光滑解提供了更快的指数收敛。它们之间的选择涉及收敛速度和数值误差特性（耗散性与色散性）之间的权衡，而误差特性随多项式阶数 $p$ 而变化。",
            "answer": "$$\n\\boxed{\\frac{\\sin(kh)}{kh}}\n$$"
        },
        {
            "introduction": "虽然通过 $h$-refinement 加密网格或通过 $p$-refinement 提高多项式阶数可以提高空间精度，但这会带来计算成本。这项练习  探讨了显式求解器最显著的成本之一：Courant–Friedrichs–Lewy (CFL) 稳定性约束。通过推导和应用该约束，您将具体理解 $h$ 和 $p$ 如何共同限制模拟的时间步长，这是影响 CFD 模拟整体效率的关键因素。",
            "id": "3964587",
            "problem": "考虑控制气体质量、动量和能量守恒的无粘性可压缩欧拉方程，其守恒形式写作 $\\partial_{t} \\mathbf{U} + \\nabla \\cdot \\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$，其中 $\\mathbf{U}$ 表示守恒变量矢量，$\\mathbf{F}(\\mathbf{U})$ 表示相应的通量张量。假设在一个协调网格的每个单元 $K$ 上，使用 $p$ 阶间断多项式近似对这些方程进行空间离散，并假设采用显式 Runge–Kutta 时间积分格式，其稳定性极限由一个正常数 $C$ 表征。对于每个单元 $K$，定义其特征网格尺寸 $h_{K}$，并令该双曲系统的最大特征波速记为 $\\lambda_{\\max,K}$，其定义为通量雅可比矩阵沿单位法向量投影后特征值绝对值在所有方向上的最大值。显式时间推进格式的 Courant–Friedrichs–Lewy (CFL) 稳定性条件要求离散数值依赖域必须包含偏微分方程的依赖域。\n\n任务1：从欧拉方程的线性化双曲特性出发，结合单元 $K$ 上 $p$ 阶多项式的标准反估计，以及显式时间积分器的稳定域需包围半离散空间算子谱半径的要求，推导出一个形式为 $\\Delta t \\le C \\min_{K} \\frac{h_{K}}{(2p+1)\\lambda_{\\max,K}}$ 的充分稳定性约束。请清晰陈述导致因子 $(2p+1)$ 和项 $\\lambda_{\\max,K}$ 出现的假设。\n\n任务2：考虑一个二维均匀气流，其速度大小为 $|u| = 200$ m/s，温度为 $T = 300$ K。假设气体为量热完全气体，比热比 $\\gamma = 1.4$，比气体常数 $R = 287$ J/(kg·K)，因此声速为 $c = \\sqrt{\\gamma R T}$。对于可压缩欧拉系统，取每个单元上的最大特征速度为 $\\lambda_{\\max,K} = |u| + c$。在一个三角形网格上，三个代表性单元的尺寸分别为 $h_{K_{1}} = 0.010$ m、$h_{K_{2}} = 0.008$ m 和 $h_{K_{3}} = 0.012$ m。设多项式阶数为 $p = 3$，显式 Runge–Kutta 稳定性常数为 $C = 0.5$。计算由所推导约束所蕴含的全局最大稳定时间步长 $\\Delta t_{\\max}$。请用微秒表示最终时间步长，并将答案四舍五入到四位有效数字。\n\n任务3：根据推导出的约束，简要解释 $h$-加密（减小 $h_{K}$）和 $p$-加密（增加 $p$）如何共同限制可压缩计算流体动力学（CFD）中允许的时间步长，并定性评论 $r$-加密（网格移动）如何通过改变局部 $h_{K}$ 和方向波速来间接影响该上限。",
            "solution": "用户提供了一个关于计算流体动力学（CFD）中数值稳定性的多部分问题。必须首先验证问题陈述的科学合理性、自洽性和适定性。\n\n### 步骤1：提取已知条件\n- **控制方程**：无粘性可压缩欧拉方程，守恒形式为 $\\partial_{t} \\mathbf{U} + \\nabla \\cdot \\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$。\n- **守恒变量矢量**：$\\mathbf{U}$。\n- **通量张量**：$\\mathbf{F}(\\mathbf{U})$。\n- **空间离散**：在协调网格的每个单元 $K$ 上采用 $p$ 阶高阶间断多项式近似。\n- **时间积分**：具有正常数稳定性常数 $C$ 的显式 Runge–Kutta 格式。\n- **单元特征尺寸**：每个单元 $K$ 的 $h_{K}$。\n- **最大特征波速**：每个单元 $K$ 的 $\\lambda_{\\max,K}$。\n- **CFL 条件原理**：数值依赖域必须包含物理依赖域。\n- **任务1目标**：推导稳定性约束 $\\Delta t \\le C \\min_{K} \\frac{h_{K}}{(2p+1)\\lambda_{\\max,K}}$，并陈述导致因子 $(2p+1)$ 和项 $\\lambda_{\\max,K}$ 的假设。\n- **任务2数据**：\n    - 流动：二维均匀流。\n    - 速度大小：$|u| = 200 \\text{ m/s}$。\n    - 温度：$T = 300 \\text{ K}$。\n    - 气体性质：量热完全气体，$\\gamma = 1.4$， $R = 287 \\text{ J/(kg·K)}$。\n    - 声速定义：$c = \\sqrt{\\gamma R T}$。\n    - 此任务的最大波速定义：$\\lambda_{\\max,K} = |u| + c$。\n    - 网格单元尺寸：$h_{K_{1}} = 0.010 \\text{ m}$，$h_{K_{2}} = 0.008 \\text{ m}$，$h_{K_{3}} = 0.012 \\text{ m}$。\n    - 多项式阶数：$p = 3$。\n    - 稳定性常数：$C = 0.5$。\n    - 任务2目标：计算全局最大稳定时间步长 $\\Delta t_{\\max}$，单位为微秒，并四舍五入到四位有效数字。\n- **任务3目标**：解释 $h$-、$p$- 和 $r$-加密对所推导的时间步长约束的影响。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础**：该问题植根于双曲守恒律数值方法的标准理论，特别是应用于欧拉方程的间断 Galerkin (DG) 方法。CFL 稳定性、特征波速和加密技术等概念是该领域的基础。所提供的物理常数和参数对于近标准条件下的空气是现实的。待推导的稳定性约束是 DG 方法中被广泛引用的一个结果。\n- **适定的**：所有三个任务都定义清晰。任务1要求基于数值分析的标准原理进行推导。任务2为直接计算提供了一套完整的数值。任务3要求基于任务1的结果进行概念性解释。问题的结构是从理论到应用再到解释。\n- **客观的**：问题使用精确、技术性的语言陈述，没有歧义或主观论断。\n- **完整性和一致性**：问题是自洽的。它提供了执行所需任务的所有必要方程、常数和定义。没有内部矛盾。\n\n### 步骤3：结论与行动\n该问题有效。它具有科学合理性、适定性和完整性。将提供完整解答。\n\n### 解答\n\n此问题分三部分解决：一个稳定性约束的理论推导，该约束的数值应用，以及对网格加密策略的概念性讨论。\n\n**任务1：稳定性约束的推导**\n\n我们从控制偏微分方程的半离散形式开始，该形式可以写成关于时间的常微分方程组（ODEs）：\n$$\n\\frac{d\\mathbf{U}_h}{dt} = \\mathcal{L}_h(\\mathbf{U}_h)\n$$\n其中 $\\mathbf{U}_h$ 是网格上多项式解的所有离散自由度组成的向量，$\\mathcal{L}_h$ 是代表对 $-\\nabla \\cdot \\mathbf{F}$ 的间断 Galerkin (DG) 近似的半离散空间算子。\n\n对于显式时间积分格式（如 Runge-Kutta 方法），稳定性要求时间步长 $\\Delta t$ 乘以空间算子的谱半径 $\\rho(\\mathcal{L}_h)$ 必须位于 ODE 求解器稳定域内。对于双曲问题，$\\mathcal{L}_h$ 的特征值主要为虚数。稳定性条件可表示为：\n$$\n\\Delta t \\cdot \\rho(\\mathcal{L}_h) \\le C\n$$\n其中 $C$ 是一个常数，取决于所选显式 Runge-Kutta 格式稳定域沿虚轴的范围。重新整理此式，得到对时间步长的约束：\n$$\n\\Delta t \\le \\frac{C}{\\rho(\\mathcal{L}_h)}\n$$\n全局空间算子 $\\mathcal{L}_h$ 耦合了网格中的所有单元。其谱半径由“最具限制性”的单元决定，即施加最严格约束的单元。因此，我们可以用局部谱半径的最大值来界定全局谱半径，稳定性约束变为对所有单元 $K$ 取最小值：\n$$\n\\Delta t \\le C \\min_{K} \\frac{1}{\\rho(\\mathcal{L}_{h,K})}\n$$\n其中 $\\rho(\\mathcal{L}_{h,K})$ 是与单元 $K$ 相关联的算子的谱半径。\n\n下一步是估计 $\\rho(\\mathcal{L}_{h,K})$。对于非线性欧拉方程，我们进行局部线性化。在每个单元 $K$ 上，系统的行为由通量雅可比矩阵的特征值决定。最大特征波速 $\\lambda_{\\max,K}$ 代表了信息局部传播的最快速度。单元上空间算子的谱半径与此波速成正比，与单元的特征尺寸 $h_K$ 成反比。近似的多项式阶数 $p$ 也会影响此关系。\n\n一个关键步骤是确定对 $p$ 的依赖关系。空间算子涉及多项式基函数的导数。对于单元 $K$ 上的 $p$ 阶多项式，一个反估计将多项式导数的范数与多项式本身的范数联系起来，并引入了对 $p$ 和 $h_K$ 的依赖。一个典型的反不等式表明，对于多项式 $v_p \\in P^p(K)$，有 $\\|\\nabla v_p\\|_{L^2(K)} \\le C_{inv} h_K^{-1} \\|v_p\\|_{L^2(K)}$，其中常数 $C_{inv}$ 的尺度与 $p^2$ 相当。这表明谱半径应按 $\\rho(\\mathcal{L}_{h,K}) \\propto \\frac{\\lambda_{\\max,K} p^2}{h_K}$ 缩放。\n\n然而，问题要求推导一个带有 $(2p+1)$ 因子的形式。这个特定的因子源于对一维线性平流方程 $u_t + \\lambda u_x = 0$ 的 DG 算子进行更详细的谱分析，其中在单元界面处使用迎风数值通量。这种分析通常通过傅里叶方法或通过使用 Legendre 多项式基检查算子的显式矩阵形式来执行，它为谱半径得出了以下精确结果：\n$$\n\\rho(\\mathcal{L}_{h,K}) = \\frac{(2p+1)\\lambda}{h_K}\n$$\n导致这种形式的主要假设是：\n1.  **线性化**：非线性系统被局部分析为线性平流问题，其中 $\\lambda$ 被最大特征波速 $\\lambda_{\\max,K}$ 所取代，后者是通量雅可比矩阵特征值绝对值的最大值，并在所有空间方向上取最大。\n2.  **迎风通量**：在单元界面处使用迎风数值通量来计算通量。不同的通量格式（例如，中心通量）会导致不同的谱半径，从而产生不同的稳定性约束。\n3.  **一维模型**：该分析基于一维模型问题，其结果通过使用整个网格上的最小单元尺寸 $h_K$ 和最大波速 $\\lambda_{\\max,K}$（代表最坏情况）推广到多维。\n\n将此谱半径表达式代入稳定性条件，得到所需结果：\n$$\n\\Delta t \\le C \\min_{K} \\frac{h_{K}}{(2p+1)\\lambda_{\\max,K}}\n$$\n这是一个充分的稳定性条件。\n\n**任务2：最大稳定时间步长的计算**\n\n首先，我们计算气体的物理性质。声速 $c$ 由下式给出：\n$$\nc = \\sqrt{\\gamma R T}\n$$\n代入给定值：\n$$\nc = \\sqrt{1.4 \\times 287 \\frac{\\text{J}}{\\text{kg·K}} \\times 300 \\text{ K}} = \\sqrt{120540} \\frac{\\text{m}}{\\text{s}} \\approx 347.1887 \\frac{\\text{m}}{\\text{s}}\n$$\n接下来，我们计算最大特征波速，对于此问题，假设其在整个区域内是恒定的：\n$$\n\\lambda_{\\max,K} = \\lambda_{\\max} = |u| + c = 200 \\frac{\\text{m}}{\\text{s}} + 347.1887 \\frac{\\text{m}}{\\text{s}} = 547.1887 \\frac{\\text{m}}{\\text{s}}\n$$\n稳定性约束为 $\\Delta t \\le C \\min_{K} \\frac{h_{K}}{(2p+1)\\lambda_{\\max}}$。全局最大稳定时间步长 $\\Delta t_{\\max}$ 在等式对最具限制性的单元成立时达到。这对应于 $h_K$ 的最小值。\n$$\nh_{\\min} = \\min(h_{K_{1}}, h_{K_{2}}, h_{K_{3}}) = \\min(0.010 \\text{ m}, 0.008 \\text{ m}, 0.012 \\text{ m}) = 0.008 \\text{ m}\n$$\n多项式阶数为 $p=3$，因此因子 $(2p+1)$ 为：\n$$\n2p+1 = 2(3)+1 = 7\n$$\n稳定性常数给定为 $C=0.5$。我们现在可以计算 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = C \\frac{h_{\\min}}{(2p+1)\\lambda_{\\max}} = 0.5 \\times \\frac{0.008 \\text{ m}}{7 \\times 547.1887 \\frac{\\text{m}}{\\text{s}}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.004}{3830.3209} \\text{ s} \\approx 1.044298 \\times 10^{-6} \\text{ s}\n$$\n问题要求答案以微秒（$\\mu$s）为单位，其中 $1 \\text{ s} = 10^6 \\mu\\text{s}$。\n$$\n\\Delta t_{\\max} \\approx 1.044298 \\mu\\text{s}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t_{\\max} = 1.044 \\mu\\text{s}\n$$\n\n**任务3：加密策略的解释**\n\n推导出的稳定性约束 $\\Delta t \\le C \\min_{K} \\frac{h_{K}}{(2p+1)\\lambda_{\\max,K}}$ 清晰地显示了不同的网格加密策略如何影响显式方法允许的时间步长。\n\n**$h$-加密**：此策略涉及减小单元尺寸 $h_K$ 以提高空间分辨率，特别是在解梯度较大的区域。根据公式，最大允许时间步长 $\\Delta t$ 与 $h_K$ 成正比。因此，减小 $h_K$（即加密网格）直接导致允许的 $\\Delta t$ 变小。这种线性依赖关系意味着，将每个方向的网格分辨率加倍（将 $h_K$ 减半）需要将时间步长减半以维持稳定性，这显著增加了模拟给定物理时间所需的总时间步数。\n\n**$p$-加密**：此策略涉及在单元内增加多项式阶数 $p$ 以实现更高阶的精度。公式显示 $\\Delta t$ 与因子 $(2p+1)$ 成反比。随着 $p$ 的增加，$(2p+1)$ 增加，导致允许的 $\\Delta t$ 减小。虽然不像基本反估计所建议的 $p^2$ 缩放那样严重，但这仍然施加了显著的惩罚。例如，从 $p=1$ 增加到 $p=3$ 会使时间步长减少一个因子 $(2 \\cdot 1+1)/(2 \\cdot 3+1) = 3/7$。因此，通过 $p$-加密实现更高精度也以减小稳定时间步长为代价。$h$- 和 $p$-加密共同严重限制了 $\\Delta t$，使得显式格式对于高保真度模拟在计算上非常昂贵。\n\n**$r$-加密**：此策略涉及重新定位网格顶点（网格移动），而不改变单元数量或其连接性。它对时间步长的影响是间接但显著的，通过项 $\\min_{K} \\frac{h_{K}}{\\lambda_{\\max,K}}$ 起作用。一个有效的 $r$-加密算法会将节点移动到需要更高分辨率的区域。这可能意味着在某些区域（例如，激波或边界层附近）减小 $h_K$，这往往会降低全局的 $\\Delta t$。然而，一个复杂的 $r$-加密策略也可以优化单元的形状和尺寸。例如，它可能旨在使整个网格上的局部误差指标均衡化。由于时间步长约束通常与局部误差有关，这样的策略可以被设计成使量 $\\frac{h_{K}}{(2p+1)\\lambda_{\\max,K}}$ 在所有单元上更加均匀。通过这样做，与具有相似数量单元的固定网格相比，它提高了该项的最小值，从而在给定整体精度下最大化了全局稳定时间步长 $\\Delta t$。此外，通过拉伸单元以与各向异性流动特征对齐，$r$-加密可以改变局部特征长度尺度 $h_K$ 以及它与构成 $\\lambda_{\\max,K}$ 的方向波速的关系，从而进一步影响稳定性界限。",
            "answer": "$$\\boxed{1.044}$$"
        },
        {
            "introduction": "最高效的网格加密策略并非均匀一致的，而是将计算资源集中在最需要的地方。对于具有激波或边界层等各向异性特征的流动，这意味着需要使用被正确拉伸和定向的单元。这项练习  深入探讨了这种“智能”网格自适应的数学基础，展示了如何利用解的局部二阶导数（由 Hessian 矩阵捕捉）来确定网格单元的最优尺寸和长宽比。这一原理是许多现代 $h$- 和 $r$-refinement 算法背后的引擎。",
            "id": "3964586",
            "problem": "考虑一个定义在有界域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的二维光滑标量场 $u(x,y)$，它代表计算流体动力学 (CFD) 中的一个流动变量，例如压力。假设为了进行分片线性有限元法 (FEM) 近似 ($p = 1$)，构建了一个局部各向异性网格单元，这是 $h$-refinement 和 $r$-refinement 策略的一部分，其中 $h$-refinement 改变单元大小，而 $r$-refinement 通过重新定位节点来与解的特征对齐。\n\n假设在点 $(x_{0}, y_{0}) \\in \\Omega$ 的一个小邻域内，$u$ 的海森矩阵（记为 $H(x_{0}, y_{0})$）近似为常数且对称，并且 $u$ 关于 $(x_{0}, y_{0})$ 的泰勒展开是有效的。线性单元的主阶插值误差由泰勒级数的二阶项决定。考虑绝对海森矩阵 $|H|$，其定义为 $|H| = R \\,\\mathrm{diag}(|\\lambda_{1}|, |\\lambda_{2}|)\\, R^{\\top}$，其中 $H = R \\,\\mathrm{diag}(\\lambda_{1}, \\lambda_{2})\\, R^{\\top}$，$R$ 中的列为标准正交特征向量，$\\lambda_{1}$ 和 $\\lambda_{2}$ 为实特征值。\n\n令 $e \\in \\mathbb{R}^{2}$ 表示网格单元的一个边向量。沿着 $e$ 的主阶方向插值误差模型被认为与 $e^{\\top} |H| e$ 成正比。为了在黎曼度量自适应框架中实现误差均匀分布，引入一个正定度量张量 $M$，使得每条边通过 $e^{\\top} M e = \\ell_{m}^{2}$ 被赋予一个统一的度量长度，其中 $\\ell_{m} > 0$ 为常数。\n\n利用泰勒展开的基本原理（保留至二阶项）以及海森矩阵的对称性和可对角化性，执行以下步骤：\n- 对角化海森矩阵 $H$，并将网格边与它的标准正交特征向量对齐，使得两条主边为 $e_{1} = h_{1} v_{1}$ 和 $e_{2} = h_{2} v_{2}$，其中 $v_{1}$ 和 $v_{2}$ 分别是 $H$ 对应于特征值 $\\lambda_{1}$ 和 $\\lambda_{2}$ 的特征向量，而 $h_{1}, h_{2} > 0$ 是沿着这些主方向的物理边长。\n- 施加均匀分布条件 $e_{i}^{\\top} M e_{i} = \\ell_{m}^{2}$（对于 $i \\in \\{1,2\\}$），并选择 $M$ 以使主阶插值误差在各个方向上均等。\n\n从第一性原理出发，推导编码在 $H$ 中的二阶导数与最优各向异性细化方向和长度之间的关系。将最终的最优纵横比 $h_{1}/h_{2}$ 完全用 $H$ 的特征值 $\\lambda_{1}$ 和 $\\lambda_{2}$ 来表示。以单一闭式解析表达式的形式给出最终答案。无需进行数值计算，最终表达式中不应包含任何单位。",
            "solution": "该问题要求基于误差均匀分布原理，推导分片线性有限元近似中网格单元的最优纵横比 $\\frac{h_{1}}{h_{2}}$。该框架是基于黎曼度量的网格自适应，其中使用度量张量 $M$ 来控制单元的大小和各向异性。\n\n首先，我们必须建立插值误差与度量张量 $M$ 之间的联系。问题陈述，沿着边向量 $e \\in \\mathbb{R}^{2}$ 的主阶方向插值误差与二次型 $e^{\\top} |H| e$ 成正比，其中 $|H|$ 是标量场 $u(x,y)$ 的绝对海森矩阵。我们将此误差记为 $\\mathcal{E}(e)$。因此，对于某个正常数比例系数 $C$，有 $\\mathcal{E}(e) = C e^{\\top} |H| e$。\n\n网格自适应的目标是生成一个插值误差均匀分布的网格，即在整个域上和所有方向上均等化。在基于度量的框架背景下，这通过定义一个度量张量 $M$ 来实现，使得任何被视为“理想”的边 $e$ 在度量空间中都具有一个恒定的、预定义的长度。问题将此条件指定为 $e^{\\top} M e = \\ell_{m}^{2}$，其中 $\\ell_{m} > 0$ 为某个恒定的目标度量长度。\n\n为了“选择 $M$ 以均等化主阶插值误差”，我们必须定义 $M$，使得任何满足度量长度约束 $e^{\\top} M e = \\ell_{m}^{2}$ 的边 $e$ 也具有相同的插值误差。这意味着二次型 $e^{\\top} M e$ 必须与误差二次型 $e^{\\top} |H| e$ 成比例。因此，我们必须将度量张量 $M$ 设置为与绝对海森矩阵 $|H|$ 成比例。我们定义 $M = \\alpha |H|$，其中 $\\alpha$ 是某个正常数缩放因子。使用绝对海森矩阵 $|H|$ 而不是 $H$，是因为度量张量必须是正定的，而 $H$ 的特征值（代表曲率）可能为负。操作 $|H| = R \\,\\mathrm{diag}(|\\lambda_{1}|, |\\lambda_{2}|)\\, R^{\\top}$ 确保了所得张量具有非负特征值，因此至少是半正定的。由于我们处于需要细化的目标区域，我们假设至少有一个特征值非零，这使得 $|H|$（并因此 $M$）是正定的。\n\n当 $M = \\alpha |H|$ 时，度量长度约束变为 $e^{\\top} (\\alpha |H|) e = \\ell_{m}^{2}$，可简化为 $e^{\\top} |H| e = \\frac{\\ell_{m}^{2}}{\\alpha}$。将此代入误差模型可得 $\\mathcal{E}(e) = C \\left(\\frac{\\ell_{m}^{2}}{\\alpha}\\right)$。这证实了通过选择 $M = \\alpha|H|$，对于所有具有指定度量长度 $\\ell_{m}$ 的边，插值误差确实是恒定的。常数 $\\alpha$ 可以被调整以设定所需的绝对误差水平，但正如我们将看到的，它不影响单元的纵横比。\n\n问题陈述网格与主曲率方向对齐，这些方向由海森矩阵 $H$ 的特征向量给出。令 $v_{1}$ 和 $v_{2}$ 为 $H$ 对应于实特征值 $\\lambda_{1}$ 和 $\\lambda_{2}$ 的标准正交特征向量。网格单元的主边由 $e_{1} = h_{1} v_{1}$ 和 $e_{2} = h_{2} v_{2}$ 给出，其中 $h_{1}$ 和 $h_{2}$ 是单元在这些方向上的物理边长。\n\n现在我们将均匀分布条件应用于这两条主边，这意味着每条边都必须满足度量长度约束：$e_{i}^{\\top} M e_{i} = \\ell_{m}^{2}$，对于 $i \\in \\{1, 2\\}$。\n\n让我们分析 $i=1$ 的情况：\n$$e_{1}^{\\top} M e_{1} = \\ell_{m}^{2}$$\n代入 $e_{1} = h_{1} v_{1}$ 和 $M = \\alpha |H|$：\n$$(h_{1} v_{1})^{\\top} (\\alpha |H|) (h_{1} v_{1}) = \\ell_{m}^{2}$$\n$$h_{1}^{2} \\alpha (v_{1}^{\\top} |H| v_{1}) = \\ell_{m}^{2}$$\n海森矩阵 $H$ 被对角化为 $H = R D R^{\\top}$，其中 $D = \\mathrm{diag}(\\lambda_{1}, \\lambda_{2})$，$R$ 是以特征向量 $v_{1}$ 和 $v_{2}$ 为列的矩阵。因此， $|H| = R |D| R^{\\top}$，其中 $|D| = \\mathrm{diag}(|\\lambda_{1}|, |\\lambda_{2}|)$。由于 $v_{1}$ 是 $H$ 对应于特征值 $\\lambda_{1}$ 的特征向量，它也是 $|H|$ 对应于特征值 $|\\lambda_{1}|$ 的特征向量。因此， $|H|v_{1} = |\\lambda_{1}|v_{1}$。\n表达式变为：\n$$h_{1}^{2} \\alpha (v_{1}^{\\top} (|\\lambda_{1}| v_{1})) = \\ell_{m}^{2}$$\n由于特征向量是标准正交的， $v_{1}^{\\top} v_{1} = 1$。这将方程简化为：\n$$h_{1}^{2} \\alpha |\\lambda_{1}| = \\ell_{m}^{2}$$\n\n类似地，对于 $i=2$ 的情况：\n$$e_{2}^{\\top} M e_{2} = \\ell_{m}^{2}$$\n代入 $e_{2} = h_{2} v_{2}$ 和 $M = \\alpha |H|$：\n$$(h_{2} v_{2})^{\\top} (\\alpha |H|) (h_{2} v_{2}) = \\ell_{m}^{2}$$\n$$h_{2}^{2} \\alpha (v_{2}^{\\top} |H| v_{2}) = \\ell_{m}^{2}$$\n如前所述，$v_{2}$ 是 $|H|$ 对应于特征值 $|\\lambda_{2}|$ 的特征向量，所以 $|H|v_{2} = |\\lambda_{2}|v_{2}$。表达式变为：\n$$h_{2}^{2} \\alpha (v_{2}^{\\top} (|\\lambda_{2}| v_{2})) = \\ell_{m}^{2}$$\n使用归一化条件 $v_{2}^{\\top} v_{2} = 1$：\n$$h_{2}^{2} \\alpha |\\lambda_{2}| = \\ell_{m}^{2}$$\n\n我们现在得到一个包含两个方程的方程组：\n1. $h_{1}^{2} \\alpha |\\lambda_{1}| = \\ell_{m}^{2}$\n2. $h_{2}^{2} \\alpha |\\lambda_{2}| = \\ell_{m}^{2}$\n\n从这些方程中，我们可以表示出物理边长 $h_{1}$ 和 $h_{2}$：\n$$h_{1} = \\frac{\\ell_{m}}{\\sqrt{\\alpha |\\lambda_{1}|}}$$\n$$h_{2} = \\frac{\\ell_{m}}{\\sqrt{\\alpha |\\lambda_{2}|}}$$\n这个结果表明，在一个主方向上的最优局部网格尺寸与该方向上二阶导数（即特征值）大小的平方根成反比。在解的曲率大的地方，网格必须小，反之亦然。\n\n最后一步是求最优纵横比 $\\frac{h_{1}}{h_{2}}$。我们取两个边长表达式的比值：\n$$\\frac{h_{1}}{h_{2}} = \\frac{\\frac{\\ell_{m}}{\\sqrt{\\alpha |\\lambda_{1}|}}}{\\frac{\\ell_{m}}{\\sqrt{\\alpha |\\lambda_{2}|}}} = \\frac{\\sqrt{\\alpha |\\lambda_{2}|}}{\\sqrt{\\alpha |\\lambda_{1}|}}$$\n常数 $\\ell_{m}$ 和 $\\alpha$ 被消去，得出完全用海森矩阵的特征值表示的最终关系：\n$$\\frac{h_{1}}{h_{2}} = \\frac{\\sqrt{|\\lambda_{2}|}}{\\sqrt{|\\lambda_{1}|}} = \\sqrt{\\frac{|\\lambda_{2}|}{|\\lambda_{1}|}}$$",
            "answer": "$$\\boxed{\\sqrt{\\frac{|\\lambda_{2}|}{|\\lambda_{1}|}}}$$"
        }
    ]
}