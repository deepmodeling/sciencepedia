{
    "hands_on_practices": [
        {
            "introduction": "Before applying advanced stabilization methods, it is crucial to understand why standard numerical schemes fail in advection-dominated scenarios. This practice uses a Taylor series analysis to derive the *modified differential equation* for a central difference scheme applied to the advection-diffusion equation. By identifying the leading-order error terms, you will uncover the source of the spurious, non-physical oscillations that plague standard methods, providing the core motivation for techniques like SUPG .",
            "id": "3999758",
            "problem": "In high Reynolds number aerospace Computational Fluid Dynamics (CFD), advection-dominated transport along streamlines can be locally modeled by the steady one-dimensional advection-diffusion equation\n$$\na\\,\\frac{du}{dx} - \\nu\\,\\frac{d^{2}u}{dx^{2}} = 0,\n$$\nwhere $a>0$ is the constant advective speed and $\\nu>0$ is the kinematic viscosity. Consider a uniform grid with spacing $h>0$ and the standard second-order central-difference discretization at node $x_i$,\n$$\n\\mathcal{L}_h[u]_i \\equiv a\\,\\frac{u_{i+1}-u_{i-1}}{2h} \\;-\\; \\nu\\,\\frac{u_{i+1}-2u_i+u_{i-1}}{h^{2}} \\;=\\; 0,\n$$\nwhere $u_i \\approx u(x_i)$. Using a Taylor series expansion of $u(x)$ about $x_i$, construct the formal modified differential equation that the grid function satisfies by substituting the Taylor expansions for $u_{i\\pm 1}$ into $\\mathcal{L}_h[u]_i$ and collecting terms up to and including order $h^{2}$. Write the modified equation in the canonical form\n$$\na\\,\\frac{du}{dx} \\;-\\; \\nu\\,\\frac{d^{2}u}{dx^{2}} \\;+\\; C_{\\text{disp}}\\,\\frac{d^{3}u}{dx^{3}} \\;+\\; C_{\\text{diss}}\\,\\frac{d^{4}u}{dx^{4}} \\;=\\; 0 \\;+\\; \\mathcal{O}(h^{4}),\n$$\nwhere $C_{\\text{disp}}$ and $C_{\\text{diss}}$ are the leading-order dispersive and dissipative error coefficients, respectively. In the context of this advection-diffusion operator, odd-derivative corrections are to be identified as dispersive and even-derivative corrections as dissipative. This analysis underpins the need for Streamline-Upwind/Petrov-Galerkin (SUPG) stabilization in advection-dominated regimes.\n\nProvide the ordered pair $\\left(C_{\\text{disp}},\\,C_{\\text{diss}}\\right)$ as a closed-form analytic expression in terms of $a$, $\\nu$, and $h$. No numerical approximation is required, and no rounding is needed. Express the final answer as the row matrix $\\begin{pmatrix} C_{\\text{disp}} & C_{\\text{diss}} \\end{pmatrix}$.",
            "solution": "The user wants me to determine the leading-order dispersive and dissipative error coefficients for the standard central difference discretization of the one-dimensional steady advection-diffusion equation. This is achieved by deriving the modified differential equation.\n\nThe problem statement provides the steady one-dimensional advection-diffusion equation:\n$$\na\\,\\frac{du}{dx} - \\nu\\,\\frac{d^{2}u}{dx^{2}} = 0\n$$\nwhere $a>0$ is a constant advective speed and $\\nu>0$ is the kinematic viscosity.\n\nThe given second-order central-difference discretization on a uniform grid with spacing $h$ at node $x_i$ is:\n$$\n\\mathcal{L}_h[u]_i \\equiv a\\,\\frac{u_{i+1}-u_{i-1}}{2h} \\;-\\; \\nu\\,\\frac{u_{i+1}-2u_i+u_{i-1}}{h^{2}} \\;=\\; 0\n$$\nwhere $u_i$ is the numerical approximation to $u(x_i)$.\n\nTo find the modified differential equation, we perform a Taylor series expansion of the grid function values $u_{i+1}$ and $u_{i-1}$ around the point $x_i$. The expansions for $u(x_{i \\pm 1}) = u(x_i \\pm h)$ are:\n$$\nu_{i+1} = u(x_i+h) = u_i + h\\frac{du}{dx} + \\frac{h^2}{2!}\\frac{d^2u}{dx^2} + \\frac{h^3}{3!}\\frac{d^3u}{dx^3} + \\frac{h^4}{4!}\\frac{d^4u}{dx^4} + \\frac{h^5}{5!}\\frac{d^5u}{dx^5} + \\mathcal{O}(h^6)\n$$\n$$\nu_{i-1} = u(x_i-h) = u_i - h\\frac{du}{dx} + \\frac{h^2}{2!}\\frac{d^2u}{dx^2} - \\frac{h^3}{3!}\\frac{d^3u}{dx^3} + \\frac{h^4}{4!}\\frac{d^4u}{dx^4} - \\frac{h^5}{5!}\\frac{d^5u}{dx^5} + \\mathcal{O}(h^6)\n$$\nAll derivatives are evaluated at $x=x_i$.\n\nFirst, we analyze the discrete advection term, which uses the central difference approximation for the first derivative. We find the expression for $u_{i+1}-u_{i-1}$:\n$$\nu_{i+1} - u_{i-1} = \\left(u_i + h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} + \\frac{h^3}{6}\\frac{d^3u}{dx^3} + \\dots\\right) - \\left(u_i - h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} - \\frac{h^3}{6}\\frac{d^3u}{dx^3} + \\dots\\right)\n$$\n$$\nu_{i+1} - u_{i-1} = 2h\\frac{du}{dx} + 2\\frac{h^3}{6}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^5) = 2h\\frac{du}{dx} + \\frac{h^3}{3}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^5)\n$$\nDividing by $2h$, we obtain the Taylor series for the discrete first derivative operator:\n$$\n\\frac{u_{i+1}-u_{i-1}}{2h} = \\frac{du}{dx} + \\frac{h^2}{6}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^4)\n$$\n\nNext, we analyze the discrete diffusion term, which uses the central difference approximation for the second derivative. We find the expression for $u_{i+1}-2u_i+u_{i-1}$ by summing $u_{i+1}$ and $u_{i-1}$ first:\n$$\nu_{i+1} + u_{i-1} = \\left(u_i + h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} + \\dots\\right) + \\left(u_i - h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} - \\dots\\right)\n$$\n$$\nu_{i+1} + u_{i-1} = 2u_i + 2\\frac{h^2}{2}\\frac{d^2u}{dx^2} + 2\\frac{h^4}{24}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^6) = 2u_i + h^2\\frac{d^2u}{dx^2} + \\frac{h^4}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^6)\n$$\nSubtracting $2u_i$ from this sum yields:\n$$\nu_{i+1}-2u_i+u_{i-1} = h^2\\frac{d^2u}{dx^2} + \\frac{h^4}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^6)\n$$\nDividing by $h^2$, we get the Taylor series for the discrete second derivative operator:\n$$\n\\frac{u_{i+1}-2u_i+u_{i-1}}{h^2} = \\frac{d^2u}{dx^2} + \\frac{h^2}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^4)\n$$\n\nNow, we substitute these expanded forms back into the discrete equation $\\mathcal{L}_h[u]_i = 0$:\n$$\na\\left(\\frac{du}{dx} + \\frac{h^2}{6}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^4)\\right) - \\nu\\left(\\frac{d^2u}{dx^2} + \\frac{h^2}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^4)\\right) = 0\n$$\nExpanding and collecting terms gives the modified differential equation:\n$$\na\\frac{du}{dx} - \\nu\\frac{d^2u}{dx^2} + a\\frac{h^2}{6}\\frac{d^3u}{dx^3} - \\nu\\frac{h^2}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^4) = 0\n$$\nThe problem specifies the canonical form for this equation as:\n$$\na\\,\\frac{du}{dx} \\;-\\; \\nu\\,\\frac{d^{2}u}{dx^{2}} \\;+\\; C_{\\text{disp}}\\,\\frac{d^{3}u}{dx^{3}} \\;+\\; C_{\\text{diss}}\\,\\frac{d^{4}u}{dx^{4}} \\;=\\; 0 \\;+\\; \\mathcal{O}(h^{4})\n$$\nBy comparing the derived modified equation with the canonical form, we can identify the coefficients $C_{\\text{disp}}$ and $C_{\\text{diss}}$.\n\nThe coefficient of the third derivative term, $\\frac{d^3u}{dx^3}$, is the leading-order dispersive error coefficient:\n$$\nC_{\\text{disp}} = a\\frac{h^2}{6}\n$$\nThe coefficient of the fourth derivative term, $\\frac{d^4u}{dx^4}$, is the leading-order dissipative error coefficient:\n$$\nC_{\\text{diss}} = -\\nu\\frac{h^2}{12}\n$$\nThe ordered pair is therefore $\\left(a\\frac{h^2}{6}, -\\nu\\frac{h^2}{12}\\right)$. This must be provided as a row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{ah^{2}}{6} & -\\frac{\\nu h^{2}}{12}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having identified the dispersive errors inherent in standard Galerkin methods, we now investigate the mechanism of the SUPG correction. This exercise employs Fourier analysis to examine the spectrum of the semi-discretized advection operator, both with and without SUPG stabilization. By deriving the shift in the system's eigenvalues, you will demonstrate precisely how the SUPG term introduces numerical dissipation to damp the problematic high-frequency oscillations .",
            "id": "3999745",
            "problem": "Consider the linear advection equation in one spatial dimension, $x \\in [0,L]$, with constant advective velocity $a \\in \\mathbb{R}$:\n$$\n\\partial_t u + a\\,\\partial_x u = 0,\n$$\nsubject to periodic boundary conditions. Discretize the spatial domain with a uniform mesh of $N$ elements of size $h = L/N$ and use continuous, piecewise-linear finite elements with the consistent mass matrix. Let $\\{\\varphi_i(x)\\}$ denote the standard hat basis functions associated with the mesh nodes $\\{x_i\\}$.\n\nThe standard Galerkin semi-discretization in space reads\n$$\nM\\,\\dot{\\mathbf{u}} + a\\,C\\,\\mathbf{u} = 0,\n$$\nwhere $M$ is the consistent mass matrix with entries $M_{ij} = \\int_0^L \\varphi_i \\varphi_j\\,dx$, and $C$ is the convection matrix with entries $C_{ij} = \\int_0^L \\varphi_i\\,\\partial_x \\varphi_j\\,dx$.\n\nAugment this formulation using the Streamline-Upwind/Petrov-Galerkin (SUPG) method with a constant stabilization parameter $\\tau>0$, adding the stabilization bilinear form along the flow direction. For constant $a$ in one dimension, this yields the stabilized semi-discrete system\n$$\nM\\,\\dot{\\mathbf{u}} + a\\,C\\,\\mathbf{u} + a^2 \\tau\\,K\\,\\mathbf{u} = 0,\n$$\nwhere $K$ is the standard stiffness matrix with entries $K_{ij} = \\int_0^L \\partial_x \\varphi_i\\,\\partial_x \\varphi_j\\,dx$.\n\nAssume periodic boundary conditions so that $M$, $C$, and $K$ are circulant operators on the uniform grid, and analyze the spectrum of the corresponding semi-discrete evolution operators $A_{\\mathrm{GAL}} = -M^{-1} a C$ (Galerkin) and $A_{\\mathrm{SUPG}} = -M^{-1}(a C + a^2 \\tau K)$ (SUPG). Consider discrete Fourier modes $\\mathbf{u}^{(\\theta)}$ with components $u^{(\\theta)}_j = \\exp(i j \\theta)$, where $\\theta \\in [-\\pi,\\pi]$ is the discrete phase angle in radians and $i$ is the imaginary unit.\n\nStarting from the definitions of $M$, $C$, and $K$ on a uniform mesh with linear elements, derive the discrete Fourier symbols of these matrices and hence the eigenvalues $\\lambda_{\\mathrm{GAL}}(\\theta)$ and $\\lambda_{\\mathrm{SUPG}}(\\theta)$ of $A_{\\mathrm{GAL}}$ and $A_{\\mathrm{SUPG}}$, respectively, acting on $\\mathbf{u}^{(\\theta)}$. Then, compute the SUPG-induced eigenvalue shift\n$$\n\\Delta \\lambda(\\theta) \\equiv \\lambda_{\\mathrm{SUPG}}(\\theta) - \\lambda_{\\mathrm{GAL}}(\\theta),\n$$\nwhich is responsible for the damping of upstream oscillations.\n\nExpress your final answer as a single, closed-form analytic expression for $\\Delta \\lambda(\\theta)$ in terms of $a$, $h$, $\\tau$, and $\\theta$ (with $\\theta$ in radians). No numerical evaluation is required.",
            "solution": "The problem is valid as it is a well-posed, scientifically grounded exercise in the numerical analysis of finite element methods, specifically concerning the spectral properties of the SUPG stabilization for the linear advection equation. All necessary information and definitions are provided.\n\nThe objective is to compute the SUPG-induced eigenvalue shift, $\\Delta \\lambda(\\theta) = \\lambda_{\\mathrm{SUPG}}(\\theta) - \\lambda_{\\mathrm{GAL}}(\\theta)$.\nThe semi-discrete systems for the Galerkin and SUPG methods are given by:\n$$\nM\\,\\dot{\\mathbf{u}} = -a\\,C\\,\\mathbf{u} \\quad (\\text{Galerkin})\n$$\n$$\nM\\,\\dot{\\mathbf{u}} = -(a\\,C + a^2 \\tau\\,K)\\,\\mathbf{u} \\quad (\\text{SUPG})\n$$\nThe corresponding evolution operators are $A_{\\mathrm{GAL}} = -M^{-1} a C$ and $A_{\\mathrm{SUPG}} = -M^{-1}(a C + a^2 \\tau K)$.\nSince the problem assumes a uniform grid with periodic boundary conditions, the matrices $M$, $C$, and $K$ are circulant. The discrete Fourier modes $\\mathbf{u}^{(\\theta)}$ with components $u_j^{(\\theta)} = \\exp(i j \\theta)$ are the eigenvectors of all circulant matrices. The eigenvalues of the evolution operators can therefore be found by determining the eigenvalues of the matrices $M$, $C$, and $K$, which are known as their discrete Fourier symbols, denoted $\\widehat{M}(\\theta)$, $\\widehat{C}(\\theta)$, and $\\widehat{K}(\\theta)$.\n\nThe eigenvalues of $A_{\\mathrm{GAL}}$ and $A_{\\mathrm{SUPG}}$ are then:\n$$\n\\lambda_{\\mathrm{GAL}}(\\theta) = -a \\frac{\\widehat{C}(\\theta)}{\\widehat{M}(\\theta)}\n$$\n$$\n\\lambda_{\\mathrm{SUPG}}(\\theta) = -\\frac{a \\widehat{C}(\\theta) + a^2 \\tau \\widehat{K}(\\theta)}{\\widehat{M}(\\theta)}\n$$\nThe required eigenvalue shift is:\n$$\n\\Delta \\lambda(\\theta) = \\lambda_{\\mathrm{SUPG}}(\\theta) - \\lambda_{\\mathrm{GAL}}(\\theta) = \\left( -a \\frac{\\widehat{C}(\\theta)}{\\widehat{M}(\\theta)} - a^2 \\tau \\frac{\\widehat{K}(\\theta)}{\\widehat{M}(\\theta)} \\right) - \\left( -a \\frac{\\widehat{C}(\\theta)}{\\widehat{M}(\\theta)} \\right) = -a^2 \\tau \\frac{\\widehat{K}(\\theta)}{\\widehat{M}(\\theta)}\n$$\nTo find this expression, we must first compute the entries of the matrices $M$, $C$, and $K$ and subsequently their Fourier symbols.\n\nA standard piecewise-linear basis function $\\varphi_j(x)$ centered at node $x_j=jh$ is non-zero on the interval $[x_{j-1}, x_{j+1}]$. It is defined as:\n$$\n\\varphi_j(x) =\n\\begin{cases}\n\\frac{x - x_{j-1}}{h}, & x \\in [x_{j-1}, x_j] \\\\\n\\frac{x_{j+1} - x}{h}, & x \\in [x_j, x_{j+1}] \\\\\n0, & \\text{otherwise}\n\\end{cases}\n$$\nIts derivative is:\n$$\n\\partial_x \\varphi_j(x) =\n\\begin{cases}\n\\frac{1}{h}, & x \\in [x_{j-1}, x_j) \\\\\n-\\frac{1}{h}, & x \\in (x_j, x_{j+1}] \\\\\n0, & \\text{otherwise}\n\\end{cases}\n$$\nWe compute the non-zero entries of the matrices for a generic row $j$:\n1.  **Mass Matrix ($M$)**: $M_{ij} = \\int_0^L \\varphi_i \\varphi_j\\,dx$.\n    $M_{jj} = \\int_{x_{j-1}}^{x_{j+1}} \\varphi_j^2(x) \\,dx = \\int_{x_{j-1}}^{x_j} \\left(\\frac{x-x_{j-1}}{h}\\right)^2 dx + \\int_{x_j}^{x_{j+1}} \\left(\\frac{x_{j+1}-x}{h}\\right)^2 dx = \\frac{h}{3} + \\frac{h}{3} = \\frac{2h}{3}$.\n    $M_{j,j+1} = \\int_{x_j}^{x_{j+1}} \\varphi_j(x)\\varphi_{j+1}(x) \\,dx = \\int_{x_j}^{x_{j+1}} \\left(\\frac{x_{j+1}-x}{h}\\right)\\left(\\frac{x-x_j}{h}\\right) dx = \\frac{h}{6}$.\n    Due to symmetry, $M_{j,j-1} = M_{j,j+1} = \\frac{h}{6}$. The stencil for $M$ is $\\frac{h}{6}[1, 4, 1]$.\n\n2.  **Convection Matrix ($C$)**: $C_{ij} = \\int_0^L \\varphi_i \\partial_x \\varphi_j\\,dx$.\n    $C_{jj} = \\int_{x_{j-1}}^{x_{j+1}} \\varphi_j(x)\\partial_x\\varphi_j(x) \\,dx = \\frac{1}{2} \\int_{x_{j-1}}^{x_{j+1}} \\partial_x(\\varphi_j^2) \\,dx = \\frac{1}{2}[\\varphi_j^2(x)]_{x_{j-1}}^{x_{j+1}} = 0$.\n    $C_{j,j+1} = \\int_{x_j}^{x_{j+1}} \\varphi_j(x)\\partial_x\\varphi_{j+1}(x) \\,dx = \\int_{x_j}^{x_{j+1}} \\left(\\frac{x_{j+1}-x}{h}\\right) \\left(\\frac{1}{h}\\right) dx = \\frac{1}{2}$.\n    $C_{j,j-1} = \\int_{x_{j-1}}^{x_j} \\varphi_j(x)\\partial_x\\varphi_{j-1}(x) \\,dx = \\int_{x_{j-1}}^{x_j} \\left(\\frac{x-x_{j-1}}{h}\\right) \\left(-\\frac{1}{h}\\right) dx = -\\frac{1}{2}$.\n    The stencil for $C$ is $\\frac{1}{2}[-1, 0, 1]$.\n\n3.  **Stiffness Matrix ($K$)**: $K_{ij} = \\int_0^L \\partial_x \\varphi_i \\partial_x \\varphi_j\\,dx$.\n    $K_{jj} = \\int_{x_{j-1}}^{x_{j+1}} (\\partial_x\\varphi_j)^2 \\,dx = \\int_{x_{j-1}}^{x_j} \\left(\\frac{1}{h}\\right)^2 dx + \\int_{x_j}^{x_{j+1}} \\left(-\\frac{1}{h}\\right)^2 dx = \\frac{1}{h^2}h + \\frac{1}{h^2}h = \\frac{2}{h}$.\n    $K_{j,j+1} = \\int_{x_j}^{x_{j+1}} \\partial_x\\varphi_j(x)\\partial_x\\varphi_{j+1}(x) \\,dx = \\int_{x_j}^{x_{j+1}} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) dx = -\\frac{1}{h}$.\n    Due to symmetry, $K_{j,j-1} = K_{j,j+1} = -\\frac{1}{h}$. The stencil for $K$ is $\\frac{1}{h}[-1, 2, -1]$.\n\nNow, we compute the Fourier symbol for each matrix. For a circulant matrix with stencil $[c_{-1}, c_0, c_1]$, its symbol is $\\widehat{C}(\\theta) = c_{-1}e^{-i\\theta} + c_0 + c_1e^{i\\theta}$.\n-   $\\widehat{M}(\\theta) = \\frac{h}{6} (1\\cdot e^{-i\\theta} + 4 + 1\\cdot e^{i\\theta}) = \\frac{h}{6}(4 + 2\\cos\\theta) = \\frac{h}{3}(2 + \\cos\\theta)$.\n-   $\\widehat{C}(\\theta) = \\frac{1}{2} (-1\\cdot e^{-i\\theta} + 0 + 1\\cdot e^{i\\theta}) = \\frac{1}{2}(e^{i\\theta} - e^{-i\\theta}) = i\\sin\\theta$.\n-   $\\widehat{K}(\\theta) = \\frac{1}{h}(-1\\cdot e^{-i\\theta} + 2 - 1\\cdot e^{i\\theta}) = \\frac{1}{h}(2 - 2\\cos\\theta) = \\frac{2}{h}(1-\\cos\\theta)$.\n\nFinally, we substitute the symbols for $\\widehat{M}(\\theta)$ and $\\widehat{K}(\\theta)$ into the expression for $\\Delta \\lambda(\\theta)$:\n$$\n\\Delta \\lambda(\\theta) = -a^2 \\tau \\frac{\\widehat{K}(\\theta)}{\\widehat{M}(\\theta)} = -a^2 \\tau \\frac{\\frac{2}{h}(1-\\cos\\theta)}{\\frac{h}{3}(2+\\cos\\theta)}\n$$\nSimplifying this expression yields the final answer:\n$$\n\\Delta \\lambda(\\theta) = -\\frac{6 a^2 \\tau}{h^2} \\frac{1-\\cos\\theta}{2+\\cos\\theta}\n$$\nThis expression represents the change in the complex eigenvalue of the semi-discrete operator due to the addition of the SUPG stabilization term. Since $a^2 \\ge 0$, $\\tau > 0$, $h^2 > 0$, $1-\\cos\\theta \\ge 0$, and $2+\\cos\\theta > 0$, the real part of this shift, which is the shift itself, is always less than or equal to zero. This confirms that the SUPG term adds numerical dissipation (damping) to the system, which is its primary purpose in suppressing spurious oscillations.",
            "answer": "$$\n\\boxed{-\\frac{6 a^{2} \\tau}{h^{2}} \\frac{1-\\cos(\\theta)}{2+\\cos(\\theta)}}\n$$"
        },
        {
            "introduction": "The final step in mastering a numerical technique is translating its theoretical formulation into a practical implementation. This exercise guides you through the process of deriving the explicit element-level SUPG contribution matrix for a two-dimensional triangular element. This practice connects the abstract principle of residual-based stabilization to the concrete algebraic systems solved by finite element software, a critical skill for developing or customizing CFD codes .",
            "id": "3999763",
            "problem": "Consider the steady two-dimensional advection-diffusion equation for a transported scalar field $\\phi$ over a bounded domain $\\Omega \\subset \\mathbb{R}^{2}$ with boundary $\\partial \\Omega$,\n$$\n\\boldsymbol{u} \\cdot \\nabla \\phi - \\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) = 0 \\quad \\text{in} \\ \\Omega,\n$$\nwith constant velocity $\\boldsymbol{u} = \\left( u_{x}, u_{y} \\right)$ and constant diffusivity $\\kappa > 0$. Assume homogeneous Dirichlet boundary conditions on $\\partial \\Omega$. Let $\\{ N_{i} \\}_{i=1}^{3}$ denote the standard linear shape functions over a single triangular finite element $\\Omega_{e}$ with nodes at $(0,0)$, $(L,0)$, and $(0,H)$, where $L>0$ and $H>0$, and area $A = \\frac{L H}{2}$.\n\nThe Streamline-Upwind/Petrov-Galerkin (SUPG) method is a residual-based stabilization technique. In the SUPG formulation, the test space is enriched by directional weighting along the streamline through a stabilization parameter $\\tau > 0$, yielding an additional element-level contribution to the algebraic system matrix that depends on the residual of the governing differential operator.\n\nStarting from the strong form and the principle of weighted residuals, and using fundamental definitions of finite element interpolation and integration, derive the element-level SUPG contribution matrix $K^{\\mathrm{SUPG}} \\in \\mathbb{R}^{3 \\times 3}$ for this linear triangular element under the assumptions stated above. Your derivation must begin from the governing equation and the definition of residual, proceed through the weak form with SUPG test function enrichment, and explicitly use the properties of linear shape functions over $\\Omega_{e}$.\n\nThen, determine the minimal polynomial exactness requirements for triangle-based numerical quadrature rules to integrate the SUPG residual terms exactly under:\n- constant coefficients ($\\boldsymbol{u}$ and $\\kappa$ constant),\n- linearly varying coefficients within $\\Omega_{e}$ (i.e., $\\boldsymbol{u}$ and $\\kappa$ vary at most linearly in $x$ and $y$).\n\nFinally, for the specific element with nodes at $(0,0)$, $(L,0)$, $(0,H)$ and constant $\\boldsymbol{u}$ and $\\kappa$ as above, compute the Frobenius norm squared of $K^{\\mathrm{SUPG}}$, defined by\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} \\left( K^{\\mathrm{SUPG}}_{ij} \\right)^{2},\n$$\nand express it as a single closed-form analytic expression in terms of $\\tau$, $L$, $H$, $u_{x}$, and $u_{y}$. Provide your final answer as this single analytic expression. No numerical evaluation is required, and no physical units should be included in the final answer.",
            "solution": "The problem is first validated against the established criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Governing Equation: Steady two-dimensional advection-diffusion equation, $\\boldsymbol{u} \\cdot \\nabla \\phi - \\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) = 0$ in a bounded domain $\\Omega \\subset \\mathbb{R}^{2}$.\n- Coefficients: Velocity $\\boldsymbol{u} = (u_x, u_y)$ is constant, diffusivity $\\kappa > 0$ is constant.\n- Boundary Conditions: Homogeneous Dirichlet boundary conditions on $\\partial \\Omega$.\n- Finite Element: A single linear triangular element $\\Omega_e$ with nodes at $(0,0)$, $(L,0)$, and $(0,H)$, where $L>0$ and $H>0$. The element area is $A = \\frac{LH}{2}$.\n- Shape Functions: $\\{N_i\\}_{i=1}^3$ are the standard linear shape functions for the triangular element.\n- Numerical Method: Streamline-Upwind/Petrov-Galerkin (SUPG) with a stabilization parameter $\\tau > 0$.\n- Tasks:\n  1. Derive the element-level SUPG contribution matrix $K^{\\mathrm{SUPG}} \\in \\mathbb{R}^{3 \\times 3}$.\n  2. Determine minimal polynomial exactness for numerical quadrature for two cases: (a) constant coefficients, (b) linearly varying coefficients.\n  3. For the constant coefficient case, compute the Frobenius norm squared, $\\| K^{\\mathrm{SUPG}} \\|_{F}^{2}$, as a closed-form expression in terms of $\\tau$, $L$, $H$, $u_x$, and $u_y$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard derivation within the field of Finite Element Methods (FEM) for Computational Fluid Dynamics (CFD). The advection-diffusion equation, linear triangular elements, and the SUPG method are fundamental concepts. The problem is scientifically sound.\n- **Well-Posed:** The tasks are clearly defined mathematical derivations based on the provided a priori information. Unique analytical solutions exist for all parts of the problem.\n- **Objective:** The language is formal, precise, and standard for mathematics and engineering, free of any subjectivity.\n- **Completeness and Consistency:** All necessary information (governing equation, element geometry, basis functions, method definition) is provided. There are no contradictions.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Derivation and Solution\n\nThe solution is presented in three parts as requested by the problem statement.\n\n**Part 1: Derivation of the SUPG Contribution Matrix $K^{\\mathrm{SUPG}}$**\n\nThe strong form of the steady advection-diffusion equation is:\n$$\n\\mathcal{L}(\\phi) \\equiv \\boldsymbol{u} \\cdot \\nabla \\phi - \\nabla \\cdot (\\kappa \\nabla \\phi) = 0\n$$\nIn the finite element method, the unknown field $\\phi$ is approximated within an element $\\Omega_e$ by $\\phi_h = \\sum_{j=1}^{3} \\phi_j N_j(x,y)$, where $\\phi_j$ are the nodal values and $N_j$ are the linear shape functions. The residual of the equation for this approximation is $R(\\phi_h) = \\mathcal{L}(\\phi_h)$.\n\nThe standard Galerkin method uses the same space for test functions $w_h$ and trial functions $\\phi_h$. The SUPG method modifies the test functions to introduce artificial diffusion along the streamline direction. The SUPG test function $w_i^{\\mathrm{SUPG}}$ corresponding to node $i$ is:\n$$\nw_i^{\\mathrm{SUPG}} = N_i + \\tau (\\boldsymbol{u} \\cdot \\nabla N_i)\n$$\nwhere $N_i$ is the standard Galerkin test function and the second term is the Petrov-Galerkin addition, with $\\tau$ being the stabilization parameter.\n\nThe weak form of the SUPG method over the element $\\Omega_e$ is:\n$$\n\\int_{\\Omega_e} w_i^{\\mathrm{SUPG}} R(\\phi_h) d\\Omega = 0 \\quad \\text{for } i=1,2,3\n$$\nSubstituting the expressions for $w_i^{\\mathrm{SUPG}}$ and $R(\\phi_h)$:\n$$\n\\int_{\\Omega_e} (N_i + \\tau (\\boldsymbol{u} \\cdot \\nabla N_i)) (\\boldsymbol{u} \\cdot \\nabla \\phi_h - \\nabla \\cdot (\\kappa \\nabla \\phi_h)) d\\Omega = 0\n$$\nThis can be split into the standard Galerkin part and the SUPG contribution:\n$$\n\\int_{\\Omega_e} N_i R(\\phi_h) d\\Omega + \\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) R(\\phi_h) d\\Omega = 0\n$$\nThe SUPG contribution to the element stiffness matrix, $K^{\\mathrm{SUPG}}$, arises from the second term. Let's analyze the residual term $R(\\phi_h)$ for linear elements. The approximation is $\\phi_h = \\sum_{j=1}^{3} \\phi_j N_j$. The shape functions for the specified triangle with nodes $1:(0,0)$, $2:(L,0)$, $3:(0,H)$ are:\n$$\nN_1(x,y) = 1 - \\frac{x}{L} - \\frac{y}{H}, \\quad N_2(x,y) = \\frac{x}{L}, \\quad N_3(x,y) = \\frac{y}{H}\n$$\nTheir gradients are constant vectors:\n$$\n\\nabla N_1 = \\begin{pmatrix} -1/L \\\\ -1/H \\end{pmatrix}, \\quad \\nabla N_2 = \\begin{pmatrix} 1/L \\\\ 0 \\end{pmatrix}, \\quad \\nabla N_3 = \\begin{pmatrix} 0 \\\\ 1/H \\end{pmatrix}\n$$\nThe Laplacian of any linear shape function is $\\nabla^2 N_j = \\nabla \\cdot (\\nabla N_j) = 0$, since the gradient is constant. With constant diffusivity $\\kappa$, the diffusion part of the residual becomes:\n$$\n\\nabla \\cdot (\\kappa \\nabla \\phi_h) = \\kappa \\nabla^2 \\phi_h = \\kappa \\sum_{j=1}^{3} \\phi_j \\nabla^2 N_j = 0\n$$\nThus, for linear elements and constant coefficients, the residual simplifies to the advection part:\n$$\nR(\\phi_h) = \\boldsymbol{u} \\cdot \\nabla \\phi_h = \\boldsymbol{u} \\cdot \\sum_{j=1}^{3} \\phi_j \\nabla N_j = \\sum_{j=1}^{3} \\phi_j (\\boldsymbol{u} \\cdot \\nabla N_j)\n$$\nThe SUPG contribution to the weak form for the $i$-th equation is:\n$$\n\\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) \\left( \\sum_{j=1}^{3} \\phi_j (\\boldsymbol{u} \\cdot \\nabla N_j) \\right) d\\Omega = \\sum_{j=1}^{3} \\phi_j \\left[ \\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j) d\\Omega \\right]\n$$\nThe term in the square brackets is the $(i,j)$-th entry of the SUPG contribution matrix, $K^{\\mathrm{SUPG}}_{ij}$:\n$$\nK^{\\mathrm{SUPG}}_{ij} = \\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j) d\\Omega\n$$\nSince $\\boldsymbol{u}$, $\\tau$ are constant and $\\nabla N_i$ are constant vectors, the integrand is constant over the element $\\Omega_e$. The integral is simply the integrand multiplied by the element area $A$:\n$$\nK^{\\mathrm{SUPG}}_{ij} = \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j) \\int_{\\Omega_e} d\\Omega = \\tau A (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j)\n$$\nThis is the desired expression for the entries of the SUPG contribution matrix.\n\n**Part 2: Quadrature Exactness Requirements**\n\nWe need to determine the polynomial degree of the integrand of the SUPG term, which dictates the required degree of precision for a numerical quadrature rule to integrate it exactly. The integrand is $I_{ij} = \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) R(\\phi_h, N_j)$, where $R(\\phi_h, N_j) = \\boldsymbol{u} \\cdot \\nabla N_j - \\nabla \\cdot (\\kappa \\nabla N_j)$. The shape functions $N_i$ are linear (polynomials of degree $1$), so their gradients $\\nabla N_i$ are constant (degree $0$).\n\n- **Case 1: Constant Coefficients**\n  $\\boldsymbol{u}$, $\\kappa$, and $\\tau$ are constants (degree $0$).\n  - The term $\\boldsymbol{u} \\cdot \\nabla N_i$ is a product of constants, hence it is a constant (degree $0$).\n  - The term $\\boldsymbol{u} \\cdot \\nabla N_j$ is also a constant (degree $0$).\n  - The term $\\nabla \\cdot (\\kappa \\nabla N_j) = \\kappa \\nabla^2 N_j = 0$, as derived before.\n  - The integrand $I_{ij} = \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j)$ is a product of constants, so it is a constant (polynomial of degree $0$).\n  - Therefore, to integrate the SUPG term exactly, the numerical quadrature rule must be exact for polynomials of degree $0$. A one-point quadrature rule is sufficient.\n\n- **Case 2: Linearly Varying Coefficients**\n  $\\boldsymbol{u}$ and $\\kappa$ vary linearly over the element (polynomials of degree $1$). We assume $\\tau$ is taken as constant over the element (e.g., evaluated at the centroid), which is standard practice.\n  - The term $\\boldsymbol{u} \\cdot \\nabla N_i$ is a product of a linear function $\\boldsymbol{u}(x,y)$ and a constant vector $\\nabla N_i$. The result is a linear polynomial (degree $1$).\n  - Similarly, $\\boldsymbol{u} \\cdot \\nabla N_j$ is a linear polynomial (degree $1$).\n  - Consider the term $\\nabla \\cdot (\\kappa \\nabla N_j)$. $\\nabla N_j$ is a constant vector, let's say $\\boldsymbol{c}_j = (c_{jx}, c_{jy})$. $\\kappa(x,y)$ is a linear function, $\\kappa(x,y) = a_0 + a_1 x + a_2 y$. Then $\\kappa \\nabla N_j = (\\kappa(x,y) c_{jx}, \\kappa(x,y) c_{jy})$.\n  - Its divergence is $\\nabla \\cdot (\\kappa \\nabla N_j) = \\frac{\\partial}{\\partial x}(\\kappa c_{jx}) + \\frac{\\partial}{\\partial y}(\\kappa c_{jy}) = c_{jx} \\frac{\\partial \\kappa}{\\partial x} + c_{jy} \\frac{\\partial \\kappa}{\\partial y}$.\n  - Since $\\kappa$ is linear, its partial derivatives $\\frac{\\partial \\kappa}{\\partial x} = a_1$ and $\\frac{\\partial \\kappa}{\\partial y} = a_2$ are constants. Thus, $\\nabla \\cdot (\\kappa \\nabla N_j)$ is a constant (degree $0$).\n  - The integrand is $I_{ij} = \\underbrace{\\tau}_{\\text{deg } 0} \\underbrace{(\\boldsymbol{u} \\cdot \\nabla N_i)}_{\\text{deg } 1} (\\underbrace{\\boldsymbol{u} \\cdot \\nabla N_j}_{\\text{deg } 1} - \\underbrace{\\nabla \\cdot (\\kappa \\nabla N_j)}_{\\text{deg } 0})$.\n  - The term in the parenthesis is a polynomial of degree $1$. The full integrand is a product of a degree $1$ polynomial and another degree $1$ polynomial, resulting in a polynomial of degree $2$.\n  - Therefore, to integrate the SUPG term exactly, the numerical quadrature rule must be exact for polynomials of degree $2$.\n\n**Part 3: Frobenius Norm Squared of $K^{\\mathrm{SUPG}}$**\n\nFor the case with constant coefficients, we have $K^{\\mathrm{SUPG}}_{ij} = \\tau A (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j)$. Let's define a scalar $g_k = \\boldsymbol{u} \\cdot \\nabla N_k$. Then $K^{\\mathrm{SUPG}}_{ij} = \\tau A g_i g_j$. In vector notation, if $\\boldsymbol{g} = (g_1, g_2, g_3)^T$, then $K^{\\mathrm{SUPG}} = \\tau A \\boldsymbol{g} \\boldsymbol{g}^T$.\n\nThe Frobenius norm squared is $\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} (K^{\\mathrm{SUPG}}_{ij})^2$.\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} (\\tau A g_i g_j)^2 = (\\tau A)^2 \\sum_{i=1}^{3} \\sum_{j=1}^{3} g_i^2 g_j^2\n$$\nThe double summation can be factored:\n$$\n\\sum_{i=1}^{3} \\sum_{j=1}^{3} g_i^2 g_j^2 = \\left( \\sum_{i=1}^{3} g_i^2 \\right) \\left( \\sum_{j=1}^{3} g_j^2 \\right) = \\left( \\sum_{k=1}^{3} g_k^2 \\right)^2\n$$\nSo, $\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = (\\tau A)^2 \\left( \\sum_{k=1}^{3} g_k^2 \\right)^2$.\n\nNow we compute the values of $g_k = \\boldsymbol{u} \\cdot \\nabla N_k$ for $k=1,2,3$:\n$$\n\\boldsymbol{u} = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix}, \\quad \\nabla N_1 = \\begin{pmatrix} -1/L \\\\ -1/H \\end{pmatrix}, \\quad \\nabla N_2 = \\begin{pmatrix} 1/L \\\\ 0 \\end{pmatrix}, \\quad \\nabla N_3 = \\begin{pmatrix} 0 \\\\ 1/H \\end{pmatrix}\n$$\n$$\ng_1 = \\boldsymbol{u} \\cdot \\nabla N_1 = u_x(-\\frac{1}{L}) + u_y(-\\frac{1}{H}) = -\\frac{u_x}{L} - \\frac{u_y}{H}\n$$\n$$\ng_2 = \\boldsymbol{u} \\cdot \\nabla N_2 = u_x(\\frac{1}{L}) + u_y(0) = \\frac{u_x}{L}\n$$\n$$\ng_3 = \\boldsymbol{u} \\cdot \\nabla N_3 = u_x(0) + u_y(\\frac{1}{H}) = \\frac{u_y}{H}\n$$\nNext, we compute the sum of their squares, $\\sum_{k=1}^{3} g_k^2$:\n$$\n\\sum_{k=1}^{3} g_k^2 = g_1^2 + g_2^2 + g_3^2 = \\left(-\\frac{u_x}{L} - \\frac{u_y}{H}\\right)^2 + \\left(\\frac{u_x}{L}\\right)^2 + \\left(\\frac{u_y}{H}\\right)^2\n$$\n$$\n= \\left(\\frac{u_x^2}{L^2} + 2\\frac{u_x u_y}{LH} + \\frac{u_y^2}{H^2}\\right) + \\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} = 2\\frac{u_x^2}{L^2} + 2\\frac{u_y^2}{H^2} + 2\\frac{u_x u_y}{LH}\n$$\n$$\n\\sum_{k=1}^{3} g_k^2 = 2\\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right)\n$$\nFinally, we substitute this into the expression for the Frobenius norm squared. Recall that the element area is $A = \\frac{LH}{2}$.\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\left(\\tau \\frac{LH}{2}\\right)^2 \\left[ 2\\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right) \\right]^2\n$$\n$$\n= \\tau^2 \\frac{L^2 H^2}{4} \\cdot 4 \\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right)^2\n$$\n$$\n= \\tau^2 L^2 H^2 \\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right)^2\n$$\nTo obtain a more compact form, we can bring the factor $L^2 H^2$ inside the square:\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\tau^2 \\left[ LH \\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right) \\right]^2\n$$\n$$\n= \\tau^2 \\left( \\frac{H}{L}u_x^2 + \\frac{L}{H}u_y^2 + u_x u_y \\right)^2\n$$\nThis is the final closed-form expression for the Frobenius norm squared of the SUPG contribution matrix.",
            "answer": "$$\n\\boxed{\\tau^{2} \\left( \\frac{H}{L}u_{x}^{2} + \\frac{L}{H}u_{y}^{2} + u_{x} u_{y} \\right)^{2}}\n$$"
        }
    ]
}