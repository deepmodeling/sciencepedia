{
    "hands_on_practices": [
        {
            "introduction": "在深入研究解决方案之前，我们首先需要精确地诊断问题所在。本练习通过修正方程分析（modified equation analysis）这一经典工具，揭示了标准中心差分格式在求解对流主导问题时的根本缺陷。通过泰勒级数展开 ，我们将看到离散格式实际求解的并非原始偏微分方程，而是附加了非物理的色散和耗散误差项的方程，这正是导致数值解产生非物理振荡的根源。",
            "id": "3999758",
            "problem": "在高雷诺数的航空航天计算流体力学 (CFD) 中，沿流线的对流主导输运可局部建模为稳态一维对流-扩散方程\n$$\na\\,\\frac{du}{dx} - \\nu\\,\\frac{d^{2}u}{dx^{2}} = 0,\n$$\n其中 $a>0$ 是恒定的对流速度，$\\nu>0$ 是运动粘度。考虑一个间距为 $h>0$ 的均匀网格以及在节点 $x_i$ 处的标准二阶中心差分离散格式，\n$$\n\\mathcal{L}_h[u]_i \\equiv a\\,\\frac{u_{i+1}-u_{i-1}}{2h} \\;-\\; \\nu\\,\\frac{u_{i+1}-2u_i+u_{i-1}}{h^{2}} \\;=\\; 0,\n$$\n其中 $u_i \\approx u(x_i)$。使用 $u(x)$ 在 $x_i$ 点的泰勒级数展开，通过将 $u_{i\\pm 1}$ 的泰勒展开式代入 $\\mathcal{L}_h[u]_i$ 并收集截至并包含 $h^{2}$ 阶的项，构造该网格函数所满足的形式上的修正微分方程。将修正方程写为以下典范形式\n$$\na\\,\\frac{du}{dx} \\;-\\; \\nu\\,\\frac{d^{2}u}{dx^{2}} \\;+\\; C_{\\text{disp}}\\,\\frac{d^{3}u}{dx^{3}} \\;+\\; C_{\\text{diss}}\\,\\frac{d^{4}u}{dx^{4}} \\;=\\; 0 \\;+\\; \\mathcal{O}(h^{4}),\n$$\n其中 $C_{\\text{disp}}$ 和 $C_{\\text{diss}}$ 分别是主阶色散误差系数和耗散误差系数。在此对流-扩散算子的背景下，奇数阶导数修正项被视为色散项，偶数阶导数修正项被视为耗散项。该分析为在对流主导区域需要使用流线迎风 Petrov–Galerkin (SUPG) 稳定化方法提供了理论基础。\n\n请以 $a$、$\\nu$ 和 $h$ 的闭式解析表达式形式，给出有序对 $\\left(C_{\\text{disp}},\\,C_{\\text{diss}}\\right)$。无需进行数值近似或四舍五入。将最终答案表示为行矩阵 $\\begin{pmatrix} C_{\\text{disp}}  C_{\\text{diss}} \\end{pmatrix}$。",
            "solution": "用户要求我确定一维稳态对流-扩散方程的标准中心差分离散格式的主阶色散和耗散误差系数。这可以通过推导修正微分方程来实现。\n\n问题陈述中给出了一维稳态对流-扩散方程：\n$$\na\\,\\frac{du}{dx} - \\nu\\,\\frac{d^{2}u}{dx^{2}} = 0\n$$\n其中 $a>0$ 是恒定的对流速度，$\\nu>0$ 是运动粘度。\n\n在节点 $x_i$ 处，给定间距为 $h$ 的均匀网格上的二阶中心差分离散格式为：\n$$\n\\mathcal{L}_h[u]_i \\equiv a\\,\\frac{u_{i+1}-u_{i-1}}{2h} \\;-\\; \\nu\\,\\frac{u_{i+1}-2u_i+u_{i-1}}{h^{2}} \\;=\\; 0\n$$\n其中 $u_i$ 是 $u(x_i)$ 的数值近似解。\n\n为了求得修正微分方程，我们对网格函数值 $u_{i+1}$ 和 $u_{i-1}$ 在点 $x_i$ 附近进行泰勒级数展开。$u(x_{i \\pm 1}) = u(x_i \\pm h)$ 的展开式为：\n$$\nu_{i+1} = u(x_i+h) = u_i + h\\frac{du}{dx} + \\frac{h^2}{2!}\\frac{d^2u}{dx^2} + \\frac{h^3}{3!}\\frac{d^3u}{dx^3} + \\frac{h^4}{4!}\\frac{d^4u}{dx^4} + \\frac{h^5}{5!}\\frac{d^5u}{dx^5} + \\mathcal{O}(h^6)\n$$\n$$\nu_{i-1} = u(x_i-h) = u_i - h\\frac{du}{dx} + \\frac{h^2}{2!}\\frac{d^2u}{dx^2} - \\frac{h^3}{3!}\\frac{d^3u}{dx^3} + \\frac{h^4}{4!}\\frac{d^4u}{dx^4} - \\frac{h^5}{5!}\\frac{d^5u}{dx^5} + \\mathcal{O}(h^6)\n$$\n所有导数均在 $x=x_i$ 处求值。\n\n首先，我们分析离散对流项，它使用中心差分来近似一阶导数。我们求出 $u_{i+1}-u_{i-1}$ 的表达式：\n$$\nu_{i+1} - u_{i-1} = \\left(u_i + h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} + \\frac{h^3}{6}\\frac{d^3u}{dx^3} + \\dots\\right) - \\left(u_i - h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} - \\frac{h^3}{6}\\frac{d^3u}{dx^3} + \\dots\\right)\n$$\n$$\nu_{i+1} - u_{i-1} = 2h\\frac{du}{dx} + 2\\frac{h^3}{6}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^5) = 2h\\frac{du}{dx} + \\frac{h^3}{3}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^5)\n$$\n两边除以 $2h$，我们得到离散一阶导数算子的泰勒级数：\n$$\n\\frac{u_{i+1}-u_{i-1}}{2h} = \\frac{du}{dx} + \\frac{h^2}{6}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^4)\n$$\n\n接下来，我们分析离散扩散项，它使用中心差分来近似二阶导数。我们首先对 $u_{i+1}$ 和 $u_{i-1}$ 求和，来求出 $u_{i+1}-2u_i+u_{i-1}$ 的表达式：\n$$\nu_{i+1} + u_{i-1} = \\left(u_i + h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} + \\dots\\right) + \\left(u_i - h\\frac{du}{dx} + \\frac{h^2}{2}\\frac{d^2u}{dx^2} - \\dots\\right)\n$$\n$$\nu_{i+1} + u_{i-1} = 2u_i + 2\\frac{h^2}{2}\\frac{d^2u}{dx^2} + 2\\frac{h^4}{24}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^6) = 2u_i + h^2\\frac{d^2u}{dx^2} + \\frac{h^4}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^6)\n$$\n从这个和中减去 $2u_i$ 得到：\n$$\nu_{i+1}-2u_i+u_{i-1} = h^2\\frac{d^2u}{dx^2} + \\frac{h^4}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^6)\n$$\n两边除以 $h^2$，我们得到离散二阶导数算子的泰勒级数：\n$$\n\\frac{u_{i+1}-2u_i+u_{i-1}}{h^2} = \\frac{d^2u}{dx^2} + \\frac{h^2}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^4)\n$$\n\n现在，我们将这些展开式代回到离散方程 $\\mathcal{L}_h[u]_i = 0$ 中：\n$$\na\\left(\\frac{du}{dx} + \\frac{h^2}{6}\\frac{d^3u}{dx^3} + \\mathcal{O}(h^4)\\right) - \\nu\\left(\\frac{d^2u}{dx^2} + \\frac{h^2}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^4)\\right) = 0\n$$\n展开并合并同类项，得到修正微分方程：\n$$\na\\frac{du}{dx} - \\nu\\frac{d^2u}{dx^2} + a\\frac{h^2}{6}\\frac{d^3u}{dx^3} - \\nu\\frac{h^2}{12}\\frac{d^4u}{dx^4} + \\mathcal{O}(h^4) = 0\n$$\n问题将此方程的典范形式指定为：\n$$\na\\,\\frac{du}{dx} \\;-\\; \\nu\\,\\frac{d^{2}u}{dx^{2}} \\;+\\; C_{\\text{disp}}\\,\\frac{d^{3}u}{dx^{3}} \\;+\\; C_{\\text{diss}}\\,\\frac{d^{4}u}{dx^{4}} \\;=\\; 0 \\;+\\; \\mathcal{O}(h^{4})\n$$\n通过将推导出的修正方程与典范形式进行比较，我们可以确定系数 $C_{\\text{disp}}$ 和 $C_{\\text{diss}}$。\n\n三阶导数项 $\\frac{d^3u}{dx^3}$ 的系数是主阶色散误差系数：\n$$\nC_{\\text{disp}} = a\\frac{h^2}{6}\n$$\n四阶导数项 $\\frac{d^4u}{dx^4}$ 的系数是主阶耗散误差系数：\n$$\nC_{\\text{diss}} = -\\nu\\frac{h^2}{12}\n$$\n因此，有序对为 $\\left(a\\frac{h^2}{6}, -\\nu\\frac{h^2}{12}\\right)$。这必须以行矩阵的形式给出。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{ah^{2}}{6}  & -\\frac{\\nu h^{2}}{12}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "了解了标准格式的缺陷后，我们来探究SUPG方法是如何修正这些问题的。本练习采用傅里叶分析（或谱分析）的方法，通过考察离散算子的特征值来提供一个独特的视角 。你将推导出SUPG修正项如何改变系统的谱特性，特别是它如何引入一个与波数相关的数值耗散，从而精确地“靶向”并抑制那些由对流项引起的高频伪振荡。",
            "id": "3999745",
            "problem": "考虑一维空间 $x \\in [0,L]$ 中的线性平流方程，其平流速度 $a \\in \\mathbb{R}$ 为常数：\n$$\n\\partial_t u + a\\,\\partial_x u = 0,\n$$\n服从周期性边界条件。使用包含 $N$ 个尺寸为 $h = L/N$ 的单元的均匀网格对空间域进行离散，并采用带有一致质量矩阵的连续分段线性有限元。令 $\\{\\varphi_i(x)\\}$ 表示与网格节点 $\\{x_i\\}$ 相关联的标准帽状基函数。\n\n标准Galerkin空间半离散化形式为\n$$\nM\\,\\dot{\\mathbf{u}} + a\\,C\\,\\mathbf{u} = 0,\n$$\n其中 $M$ 是一致质量矩阵，其元素为 $M_{ij} = \\int_0^L \\varphi_i \\varphi_j\\,dx$，$C$ 是对流矩阵，其元素为 $C_{ij} = \\int_0^L \\varphi_i\\,\\partial_x \\varphi_j\\,dx$。\n\n使用流线迎风Petrov–Galerkin (SUPG) 方法对该公式进行增强，该方法具有一个恒定的稳定化参数 $\\tau>0$，并沿流动方向添加稳定化双线性形式。对于一维常数 $a$，这会产生稳定化的半离散系统\n$$\nM\\,\\dot{\\mathbf{u}} + a\\,C\\,\\mathbf{u} + a^2 \\tau\\,K\\,\\mathbf{u} = 0,\n$$\n其中 $K$ 是标准刚度矩阵，其元素为 $K_{ij} = \\int_0^L \\partial_x \\varphi_i\\,\\partial_x \\varphi_j\\,dx$。\n\n假设采用周期性边界条件，因此 $M$、$C$ 和 $K$ 在均匀网格上是循环算子，并分析相应的半离散演化算子 $A_{\\mathrm{GAL}} = -M^{-1} a C$ (Galerkin) 和 $A_{\\mathrm{SUPG}} = -M^{-1}(a C + a^2 \\tau K)$ (SUPG) 的谱。考虑离散傅里叶模 $\\mathbf{u}^{(\\theta)}$，其分量为 $u^{(\\theta)}_j = \\exp(i j \\theta)$，其中 $\\theta \\in [-\\pi,\\pi]$ 是以弧度为单位的离散相位角，$i$ 是虚数单位。\n\n从 $M$、$C$ 和 $K$ 在带有线性单元的均匀网格上的定义出发，推导这些矩阵的离散傅里叶符号，并由此推导出分别作用于 $\\mathbf{u}^{(\\theta)}$ 的 $A_{\\mathrm{GAL}}$ 和 $A_{\\mathrm{SUPG}}$ 的特征值 $\\lambda_{\\mathrm{GAL}}(\\theta)$ 和 $\\lambda_{\\mathrm{SUPG}}(\\theta)$。然后，计算SUPG引起的特征值偏移\n$$\n\\Delta \\lambda(\\theta) \\equiv \\lambda_{\\mathrm{SUPG}}(\\theta) - \\lambda_{\\mathrm{GAL}}(\\theta),\n$$\n该偏移负责抑制上游振荡。\n\n将你的最终答案表示为关于 $a$、$h$、$\\tau$ 和 $\\theta$（其中 $\\theta$ 以弧度为单位）的 $\\Delta \\lambda(\\theta)$ 的单个闭式解析表达式。无需进行数值计算。",
            "solution": "该问题是有效的，因为它是有限元方法数值分析中一个适定且有科学依据的练习，特别涉及线性平流方程的SUPG稳定化方法的谱特性。所有必要的信息和定义均已提供。\n\n目标是计算SUPG引起的特征值偏移，$\\Delta \\lambda(\\theta) = \\lambda_{\\mathrm{SUPG}}(\\theta) - \\lambda_{\\mathrm{GAL}}(\\theta)$。\nGalerkin方法和SUPG方法的半离散系统由下式给出：\n$$\nM\\,\\dot{\\mathbf{u}} = -a\\,C\\,\\mathbf{u} \\quad (\\text{Galerkin})\n$$\n$$\nM\\,\\dot{\\mathbf{u}} = -(a\\,C + a^2 \\tau\\,K)\\,\\mathbf{u} \\quad (\\text{SUPG})\n$$\n相应的演化算子为 $A_{\\mathrm{GAL}} = -M^{-1} a C$ 和 $A_{\\mathrm{SUPG}} = -M^{-1}(a C + a^2 \\tau K)$。\n由于问题假设了带有周期性边界条件的均匀网格，矩阵 $M$、$C$ 和 $K$ 都是循环矩阵。分量为 $u_j^{(\\theta)} = \\exp(i j \\theta)$ 的离散傅里叶模 $\\mathbf{u}^{(\\theta)}$ 是所有循环矩阵的特征向量。因此，可以通过确定矩阵 $M$、$C$ 和 $K$ 的特征值来找到演化算子的特征值，这些特征值被称为它们的离散傅里叶符号，记为 $\\widehat{M}(\\theta)$、$\\widehat{C}(\\theta)$ 和 $\\widehat{K}(\\theta)$。\n\n那么，$A_{\\mathrm{GAL}}$ 和 $A_{\\mathrm{SUPG}}$ 的特征值为：\n$$\n\\lambda_{\\mathrm{GAL}}(\\theta) = -a \\frac{\\widehat{C}(\\theta)}{\\widehat{M}(\\theta)}\n$$\n$$\n\\lambda_{\\mathrm{SUPG}}(\\theta) = -\\frac{a \\widehat{C}(\\theta) + a^2 \\tau \\widehat{K}(\\theta)}{\\widehat{M}(\\theta)}\n$$\n所求的特征值偏移为：\n$$\n\\Delta \\lambda(\\theta) = \\lambda_{\\mathrm{SUPG}}(\\theta) - \\lambda_{\\mathrm{GAL}}(\\theta) = \\left( -a \\frac{\\widehat{C}(\\theta)}{\\widehat{M}(\\theta)} - a^2 \\tau \\frac{\\widehat{K}(\\theta)}{\\widehat{M}(\\theta)} \\right) - \\left( -a \\frac{\\widehat{C}(\\theta)}{\\widehat{M}(\\theta)} \\right) = -a^2 \\tau \\frac{\\widehat{K}(\\theta)}{\\widehat{M}(\\theta)}\n$$\n为了找到这个表达式，我们必须首先计算矩阵 $M$、$C$ 和 $K$ 的元素，然后计算它们的傅里叶符号。\n\n一个以节点 $x_j=jh$ 为中心的标准分段线性基函数 $\\varphi_j(x)$ 在区间 $[x_{j-1}, x_{j+1}]$ 上非零。其定义为：\n$$\n\\varphi_j(x) =\n\\begin{cases}\n\\frac{x - x_{j-1}}{h},  x \\in [x_{j-1}, x_j] \\\\\n\\frac{x_{j+1} - x}{h},  x \\in [x_j, x_{j+1}] \\\\\n0,  \\text{otherwise}\n\\end{cases}\n$$\n其导数为：\n$$\n\\partial_x \\varphi_j(x) =\n\\begin{cases}\n\\frac{1}{h},  x \\in [x_{j-1}, x_j) \\\\\n-\\frac{1}{h},  x \\in (x_j, x_{j+1}] \\\\\n0,  \\text{otherwise}\n\\end{cases}\n$$\n我们为通用行 $j$ 计算矩阵的非零元素：\n1.  **质量矩阵 ($M$)**: $M_{ij} = \\int_0^L \\varphi_i \\varphi_j\\,dx$。\n    $M_{jj} = \\int_{x_{j-1}}^{x_{j+1}} \\varphi_j^2(x) \\,dx = \\int_{x_{j-1}}^{x_j} \\left(\\frac{x-x_{j-1}}{h}\\right)^2 dx + \\int_{x_j}^{x_{j+1}} \\left(\\frac{x_{j+1}-x}{h}\\right)^2 dx = \\frac{h}{3} + \\frac{h}{3} = \\frac{2h}{3}$。\n    $M_{j,j+1} = \\int_{x_j}^{x_{j+1}} \\varphi_j(x)\\varphi_{j+1}(x) \\,dx = \\int_{x_j}^{x_{j+1}} \\left(\\frac{x_{j+1}-x}{h}\\right)\\left(\\frac{x-x_j}{h}\\right) dx = \\frac{h}{6}$。\n    由于对称性，$M_{j,j-1} = M_{j,j+1} = \\frac{h}{6}$。$M$ 的模板是 $\\frac{h}{6}[1, 4, 1]$。\n\n2.  **对流矩阵 ($C$)**: $C_{ij} = \\int_0^L \\varphi_i \\partial_x \\varphi_j\\,dx$。\n    $C_{jj} = \\int_{x_{j-1}}^{x_{j+1}} \\varphi_j(x)\\partial_x\\varphi_j(x) \\,dx = \\frac{1}{2} \\int_{x_{j-1}}^{x_{j+1}} \\partial_x(\\varphi_j^2) \\,dx = \\frac{1}{2}[\\varphi_j^2(x)]_{x_{j-1}}^{x_{j+1}} = 0$。\n    $C_{j,j+1} = \\int_{x_j}^{x_{j+1}} \\varphi_j(x)\\partial_x\\varphi_{j+1}(x) \\,dx = \\int_{x_j}^{x_{j+1}} \\left(\\frac{x_{j+1}-x}{h}\\right) \\left(\\frac{1}{h}\\right) dx = \\frac{1}{2}$。\n    $C_{j,j-1} = \\int_{x_{j-1}}^{x_j} \\varphi_j(x)\\partial_x\\varphi_{j-1}(x) \\,dx = \\int_{x_{j-1}}^{x_j} \\left(\\frac{x-x_{j-1}}{h}\\right) \\left(-\\frac{1}{h}\\right) dx = -\\frac{1}{2}$。\n    $C$ 的模板是 $\\frac{1}{2}[-1, 0, 1]$。\n\n3.  **刚度矩阵 ($K$)**: $K_{ij} = \\int_0^L \\partial_x \\varphi_i \\partial_x \\varphi_j\\,dx$。\n    $K_{jj} = \\int_{x_{j-1}}^{x_{j+1}} (\\partial_x\\varphi_j)^2 \\,dx = \\int_{x_{j-1}}^{x_j} \\left(\\frac{1}{h}\\right)^2 dx + \\int_{x_j}^{x_{j+1}} \\left(-\\frac{1}{h}\\right)^2 dx = \\frac{1}{h^2}h + \\frac{1}{h^2}h = \\frac{2}{h}$。\n    $K_{j,j+1} = \\int_{x_j}^{x_{j+1}} \\partial_x\\varphi_j(x)\\partial_x\\varphi_{j+1}(x) \\,dx = \\int_{x_j}^{x_{j+1}} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) dx = -\\frac{1}{h}$。\n    由于对称性，$K_{j,j-1} = K_{j,j+1} = -\\frac{1}{h}$。$K$ 的模板是 $\\frac{1}{h}[-1, 2, -1]$。\n\n现在，我们计算每个矩阵的傅里叶符号。对于一个模板为 $[c_{-1}, c_0, c_1]$ 的循环矩阵，其符号为 $\\widehat{C}(\\theta) = c_{-1}e^{-i\\theta} + c_0 + c_1e^{i\\theta}$。\n-   $\\widehat{M}(\\theta) = \\frac{h}{6} (1\\cdot e^{-i\\theta} + 4 + 1\\cdot e^{i\\theta}) = \\frac{h}{6}(4 + 2\\cos\\theta) = \\frac{h}{3}(2 + \\cos\\theta)$。\n-   $\\widehat{C}(\\theta) = \\frac{1}{2} (-1\\cdot e^{-i\\theta} + 0 + 1\\cdot e^{i\\theta}) = \\frac{1}{2}(e^{i\\theta} - e^{-i\\theta}) = i\\sin\\theta$。\n-   $\\widehat{K}(\\theta) = \\frac{1}{h}(-1\\cdot e^{-i\\theta} + 2 - 1\\cdot e^{i\\theta}) = \\frac{1}{h}(2 - 2\\cos\\theta) = \\frac{2}{h}(1-\\cos\\theta)$。\n\n最后，我们将 $\\widehat{M}(\\theta)$ 和 $\\widehat{K}(\\theta)$ 的符号代入 $\\Delta \\lambda(\\theta)$ 的表达式中：\n$$\n\\Delta \\lambda(\\theta) = -a^2 \\tau \\frac{\\widehat{K}(\\theta)}{\\widehat{M}(\\theta)} = -a^2 \\tau \\frac{\\frac{2}{h}(1-\\cos\\theta)}{\\frac{h}{3}(2+\\cos\\theta)}\n$$\n简化此表达式可得出最终答案：\n$$\n\\Delta \\lambda(\\theta) = -\\frac{6 a^2 \\tau}{h^2} \\frac{1-\\cos\\theta}{2+\\cos\\theta}\n$$\n该表达式表示由于添加SUPG稳定项而引起的半离散算子复特征值的变化。由于 $a^2 \\ge 0$，$\\tau > 0$，$h^2 > 0$，$1-\\cos\\theta \\ge 0$ 且 $2+\\cos\\theta > 0$，这个偏移的实部（即偏移本身）总是小于或等于零。这证实了SUPG项为系统增加了数值耗散（阻尼），其主要目的就是抑制伪振荡。",
            "answer": "$$\n\\boxed{-\\frac{6 a^{2} \\tau}{h^{2}} \\frac{1-\\cos(\\theta)}{2+\\cos(\\theta)}}\n$$"
        },
        {
            "introduction": "从一维理论分析走向多维工程实践，是掌握任何数值方法的关键一步。本练习将引导你将SUPG方法应用到二维线性三角单元上，推导其在有限元框架下的具体形式 。通过计算单元级的SUPG贡献矩阵，你将深刻理解如何将基于残差的稳定化思想，转化为可以被计算机程序执行的离散代数项，这是开发和应用高级CFD求解器的基础。",
            "id": "3999763",
            "problem": "考虑一个定义在有界域 $\\Omega \\subset \\mathbb{R}^{2}$（其边界为 $\\partial \\Omega$）上的输运标量场 $\\phi$ 的稳态二维对流扩散方程，\n$$\n\\boldsymbol{u} \\cdot \\nabla \\phi - \\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) = 0 \\quad \\text{in} \\ \\Omega,\n$$\n其中速度 $\\boldsymbol{u} = \\left( u_{x}, u_{y} \\right)$ 和扩散系数 $\\kappa > 0$ 均为常数。假设在边界 $\\partial \\Omega$ 上为齐次狄利克雷边界条件。令 $\\{ N_{i} \\}_{i=1}^{3}$ 表示单个三角形有限元 $\\Omega_{e}$ 上的标准线性形函数，该单元的节点位于 $(0,0)$、$(L,0)$ 和 $(0,H)$，其中 $L>0$ 且 $H>0$，单元面积为 $A = \\frac{L H}{2}$。\n\n流线迎风/彼得罗夫-伽辽金 (Streamline-Upwind/Petrov-Galerkin, SUPG) 方法是一种基于残差的稳定化技术。在 SUPG 格式中，通过一个稳定化参数 $\\tau > 0$，沿流线方向进行方向加权来增广测试空间，从而对代数系统矩阵产生一个附加的单元级贡献，该贡献取决于控制微分算子的残差。\n\n从强形式和加权残差法原理出发，利用有限元插值和积分的基本定义，在上述假设下，推导此线性三角形单元的单元级 SUPG 贡献矩阵 $K^{\\mathrm{SUPG}} \\in \\mathbb{R}^{3 \\times 3}$。您的推导必须从控制方程和残差的定义开始，经过带有 SUPG 测试函数增广的弱形式，并明确使用 $\\Omega_{e}$ 上线性形函数的性质。\n\n然后，确定在以下条件下，为精确积分 SUPG 残差项，基于三角形的数值积分法则所需的最低多项式精度要求：\n- 常系数（$\\boldsymbol{u}$ 和 $\\kappa$ 为常数），\n- $\\Omega_{e}$ 内线性变化的系数（即 $\\boldsymbol{u}$ 和 $\\kappa$ 在 $x$ 和 $y$ 方向上至多呈线性变化）。\n\n最后，对于节点位于 $(0,0)$、$(L,0)$、$(0,H)$ 且 $\\boldsymbol{u}$ 和 $\\kappa$ 如上所述为常数的特定单元，计算 $K^{\\mathrm{SUPG}}$ 的弗罗贝尼乌斯范数的平方，其定义为\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} \\left( K^{\\mathrm{SUPG}}_{ij} \\right)^{2},\n$$\n并将其表示为关于 $\\tau$、$L$、$H$、$u_{x}$ 和 $u_{y}$ 的单个闭式解析表达式。将您的最终答案以该单个解析表达式的形式给出。不需要进行数值评估，最终答案中也不应包含任何物理单位。",
            "solution": "首先根据既定准则对问题进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 控制方程：稳态二维对流扩散方程，$\\boldsymbol{u} \\cdot \\nabla \\phi - \\nabla \\cdot \\left( \\kappa \\nabla \\phi \\right) = 0$，在有界域 $\\Omega \\subset \\mathbb{R}^{2}$ 上。\n- 系数：速度 $\\boldsymbol{u} = (u_x, u_y)$ 为常数，扩散系数 $\\kappa > 0$ 为常数。\n- 边界条件：在 $\\partial \\Omega$ 上的齐次狄利克雷边界条件。\n- 有限元：单个线性三角形单元 $\\Omega_e$，节点位于 $(0,0)$、$(L,0)$ 和 $(0,H)$，其中 $L>0$ 且 $H>0$。单元面积为 $A = \\frac{LH}{2}$。\n- 形函数：$\\{N_i\\}_{i=1}^3$ 是该三角形单元的标准线性形函数。\n- 数值方法：流线迎风/彼得罗夫-伽辽金 (SUPG) 方法，稳定化参数为 $\\tau > 0$。\n- 任务：\n  1. 推导单元级 SUPG 贡献矩阵 $K^{\\mathrm{SUPG}} \\in \\mathbb{R}^{3 \\times 3}$。\n  2. 确定两种情况下（a) 常系数，b) 线性变化系数）数值积分所需的最低多项式精度。\n  3. 对于常系数情况，计算弗罗贝尼乌斯范数的平方 $\\| K^{\\mathrm{SUPG}} \\|_{F}^{2}$，并将其表示为关于 $\\tau$、$L$、$H$、$u_x$ 和 $u_y$ 的闭式表达式。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是计算流体动力学 (CFD) 中有限元法 (FEM) 领域的一个标准推导。对流扩散方程、线性三角形单元和 SUPG 方法都是基本概念。该问题在科学上是合理的。\n- **适定性：** 这些任务是基于所提供的先验信息进行的明确定义的数学推导。问题的所有部分都存在唯一的解析解。\n- **客观性：** 所用语言正式、精确，是数学和工程领域的标准语言，不含任何主观性。\n- **完整性和一致性：** 提供了所有必要的信息（控制方程、单元几何形状、基函数、方法定义）。不存在矛盾之处。\n\n**第3步：结论与行动**\n问题有效。将提供完整解答。\n\n### 推导与解答\n\n根据题目要求，解答分为三个部分。\n\n**第1部分：SUPG 贡献矩阵 $K^{\\mathrm{SUPG}}$ 的推导**\n\n稳态对流扩散方程的强形式为：\n$$\n\\mathcal{L}(\\phi) \\equiv \\boldsymbol{u} \\cdot \\nabla \\phi - \\nabla \\cdot (\\kappa \\nabla \\phi) = 0\n$$\n在有限元法中，未知场 $\\phi$ 在单元 $\\Omega_e$ 内被近似为 $\\phi_h = \\sum_{j=1}^{3} \\phi_j N_j(x,y)$，其中 $\\phi_j$ 是节点值，$N_j$ 是线性形函数。此近似下方程的残差为 $R(\\phi_h) = \\mathcal{L}(\\phi_h)$。\n\n标准的伽辽金法对测试函数 $w_h$ 和试探函数 $\\phi_h$ 使用相同的空间。SUPG 方法修改了测试函数，以沿流线方向引入人工扩散。对应于节点 $i$ 的 SUPG 测试函数 $w_i^{\\mathrm{SUPG}}$ 为：\n$$\nw_i^{\\mathrm{SUPG}} = N_i + \\tau (\\boldsymbol{u} \\cdot \\nabla N_i)\n$$\n其中 $N_i$ 是标准的伽辽金测试函数，第二项是彼得罗夫-伽辽金附加项，$\\tau$ 是稳定化参数。\n\nSUPG 方法在单元 $\\Omega_e$ 上的弱形式为：\n$$\n\\int_{\\Omega_e} w_i^{\\mathrm{SUPG}} R(\\phi_h) d\\Omega = 0 \\quad \\text{for } i=1,2,3\n$$\n代入 $w_i^{\\mathrm{SUPG}}$ 和 $R(\\phi_h)$ 的表达式：\n$$\n\\int_{\\Omega_e} (N_i + \\tau (\\boldsymbol{u} \\cdot \\nabla N_i)) (\\boldsymbol{u} \\cdot \\nabla \\phi_h - \\nabla \\cdot (\\kappa \\nabla \\phi_h)) d\\Omega = 0\n$$\n这可以分解为标准伽辽金部分和 SUPG 贡献部分：\n$$\n\\int_{\\Omega_e} N_i R(\\phi_h) d\\Omega + \\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) R(\\phi_h) d\\Omega = 0\n$$\n单元刚度矩阵的 SUPG 贡献 $K^{\\mathrm{SUPG}}$ 来自第二项。我们来分析线性单元的残差项 $R(\\phi_h)$。近似解为 $\\phi_h = \\sum_{j=1}^{3} \\phi_j N_j$。对于节点为 $1:(0,0)$、$2:(L,0)$、$3:(0,H)$ 的指定三角形，其形函数为：\n$$\nN_1(x,y) = 1 - \\frac{x}{L} - \\frac{y}{H}, \\quad N_2(x,y) = \\frac{x}{L}, \\quad N_3(x,y) = \\frac{y}{H}\n$$\n它们的梯度是常数向量：\n$$\n\\nabla N_1 = \\begin{pmatrix} -1/L \\\\ -1/H \\end{pmatrix}, \\quad \\nabla N_2 = \\begin{pmatrix} 1/L \\\\ 0 \\end{pmatrix}, \\quad \\nabla N_3 = \\begin{pmatrix} 0 \\\\ 1/H \\end{pmatrix}\n$$\n任何线性形函数的拉普拉斯算子均为 $\\nabla^2 N_j = \\nabla \\cdot (\\nabla N_j) = 0$，因为其梯度是常数。当扩散系数 $\\kappa$ 为常数时，残差的扩散部分变为：\n$$\n\\nabla \\cdot (\\kappa \\nabla \\phi_h) = \\kappa \\nabla^2 \\phi_h = \\kappa \\sum_{j=1}^{3} \\phi_j \\nabla^2 N_j = 0\n$$\n因此，对于线性单元和常系数，残差简化为对流部分：\n$$\nR(\\phi_h) = \\boldsymbol{u} \\cdot \\nabla \\phi_h = \\boldsymbol{u} \\cdot \\sum_{j=1}^{3} \\phi_j \\nabla N_j = \\sum_{j=1}^{3} \\phi_j (\\boldsymbol{u} \\cdot \\nabla N_j)\n$$\n对于第 $i$ 个方程，SUPG 对弱形式的贡献为：\n$$\n\\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) \\left( \\sum_{j=1}^{3} \\phi_j (\\boldsymbol{u} \\cdot \\nabla N_j) \\right) d\\Omega = \\sum_{j=1}^{3} \\phi_j \\left[ \\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j) d\\Omega \\right]\n$$\n方括号中的项是 SUPG 贡献矩阵 $K^{\\mathrm{SUPG}}$ 的第 $(i,j)$ 个元素 $K^{\\mathrm{SUPG}}_{ij}$：\n$$\nK^{\\mathrm{SUPG}}_{ij} = \\int_{\\Omega_e} \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j) d\\Omega\n$$\n由于 $\\boldsymbol{u}$、$\\tau$ 是常数，$\\nabla N_i$ 是常数向量，因此被积函数在单元 $\\Omega_e$ 上是常数。积分就是被积函数乘以单元面积 $A$：\n$$\nK^{\\mathrm{SUPG}}_{ij} = \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j) \\int_{\\Omega_e} d\\Omega = \\tau A (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j)\n$$\n这就是 SUPG 贡献矩阵元素的所求表达式。\n\n**第2部分：积分精度要求**\n\n我们需要确定 SUPG 项被积函数的多项式次数，这决定了要精确积分该项，数值积分法则所需的精度阶。被积函数为 $I_{ij} = \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) R(\\phi_h, N_j)$，其中 $R(\\phi_h, N_j) = \\boldsymbol{u} \\cdot \\nabla N_j - \\nabla \\cdot (\\kappa \\nabla N_j)$。形函数 $N_i$ 是线性的（1次多项式），所以它们的梯度 $\\nabla N_i$ 是常数（0次）。\n\n- **情况1：常系数**\n  $\\boldsymbol{u}$、$\\kappa$ 和 $\\tau$ 是常数（0次）。\n  - 项 $\\boldsymbol{u} \\cdot \\nabla N_i$ 是常数的乘积，因此是常数（0次）。\n  - 项 $\\boldsymbol{u} \\cdot \\nabla N_j$ 也是常数（0次）。\n  - 如前所述，项 $\\nabla \\cdot (\\kappa \\nabla N_j) = \\kappa \\nabla^2 N_j = 0$。\n  - 被积函数 $I_{ij} = \\tau (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j)$ 是常数的乘积，所以它是一个常数（0次多项式）。\n  - 因此，为了精确积分 SUPG 项，数值积分法则必须对0次多项式精确。单点积分法则就足够了。\n\n- **情况2：线性变化的系数**\n  $\\boldsymbol{u}$ 和 $\\kappa$ 在单元上呈线性变化（1次多项式）。我们假设 $\\tau$ 在单元上为常数（例如，在形心处取值），这是标准做法。\n  - 项 $\\boldsymbol{u} \\cdot \\nabla N_i$ 是一个线性函数 $\\boldsymbol{u}(x,y)$ 和一个常数向量 $\\nabla N_i$ 的乘积，结果是一个线性多项式（1次）。\n  - 类似地，$\\boldsymbol{u} \\cdot \\nabla N_j$ 是一个线性多项式（1次）。\n  - 考虑项 $\\nabla \\cdot (\\kappa \\nabla N_j)$。$\\nabla N_j$ 是一个常数向量，比如说 $\\boldsymbol{c}_j = (c_{jx}, c_{jy})$。$\\kappa(x,y)$ 是一个线性函数，$\\kappa(x,y) = a_0 + a_1 x + a_2 y$。那么 $\\kappa \\nabla N_j = (\\kappa(x,y) c_{jx}, \\kappa(x,y) c_{jy})$。\n  - 它的散度是 $\\nabla \\cdot (\\kappa \\nabla N_j) = \\frac{\\partial}{\\partial x}(\\kappa c_{jx}) + \\frac{\\partial}{\\partial y}(\\kappa c_{jy}) = c_{jx} \\frac{\\partial \\kappa}{\\partial x} + c_{jy} \\frac{\\partial \\kappa}{\\partial y}$。\n  - 由于 $\\kappa$ 是线性的，它的偏导数 $\\frac{\\partial \\kappa}{\\partial x} = a_1$ 和 $\\frac{\\partial \\kappa}{\\partial y} = a_2$ 是常数。因此，$\\nabla \\cdot (\\kappa \\nabla N_j)$ 是一个常数（0次）。\n  - 被积函数为 $I_{ij} = \\underbrace{\\tau}_{\\text{0次}} \\underbrace{(\\boldsymbol{u} \\cdot \\nabla N_i)}_{\\text{1次}} (\\underbrace{\\boldsymbol{u} \\cdot \\nabla N_j}_{\\text{1次}} - \\underbrace{\\nabla \\cdot (\\kappa \\nabla N_j)}_{\\text{0次}})$。\n  - 括号中的项是1次多项式。整个被积函数是一个1次多项式与另一个1次多项式的乘积，结果是一个2次多项式。\n  - 因此，为了精确积分 SUPG 项，数值积分法则必须对2次多项式精确。\n\n**第3部分：$K^{\\mathrm{SUPG}}$ 的弗罗贝尼乌斯范数的平方**\n\n对于常系数情况，我们有 $K^{\\mathrm{SUPG}}_{ij} = \\tau A (\\boldsymbol{u} \\cdot \\nabla N_i) (\\boldsymbol{u} \\cdot \\nabla N_j)$。我们定义一个标量 $g_k = \\boldsymbol{u} \\cdot \\nabla N_k$。那么 $K^{\\mathrm{SUPG}}_{ij} = \\tau A g_i g_j$。用向量表示，如果 $\\boldsymbol{g} = (g_1, g_2, g_3)^T$，那么 $K^{\\mathrm{SUPG}} = \\tau A \\boldsymbol{g} \\boldsymbol{g}^T$。\n\n弗罗贝尼乌斯范数的平方为 $\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} (K^{\\mathrm{SUPG}}_{ij})^2$。\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} (\\tau A g_i g_j)^2 = (\\tau A)^2 \\sum_{i=1}^{3} \\sum_{j=1}^{3} g_i^2 g_j^2\n$$\n双重求和可以因式分解：\n$$\n\\sum_{i=1}^{3} \\sum_{j=1}^{3} g_i^2 g_j^2 = \\left( \\sum_{i=1}^{3} g_i^2 \\right) \\left( \\sum_{j=1}^{3} g_j^2 \\right) = \\left( \\sum_{k=1}^{3} g_k^2 \\right)^2\n$$\n所以，$\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = (\\tau A)^2 \\left( \\sum_{k=1}^{3} g_k^2 \\right)^2$。\n\n现在我们计算 $k=1,2,3$ 时 $g_k = \\boldsymbol{u} \\cdot \\nabla N_k$ 的值：\n$$\n\\boldsymbol{u} = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix}, \\quad \\nabla N_1 = \\begin{pmatrix} -1/L \\\\ -1/H \\end{pmatrix}, \\quad \\nabla N_2 = \\begin{pmatrix} 1/L \\\\ 0 \\end{pmatrix}, \\quad \\nabla N_3 = \\begin{pmatrix} 0 \\\\ 1/H \\end{pmatrix}\n$$\n$$\ng_1 = \\boldsymbol{u} \\cdot \\nabla N_1 = u_x(-\\frac{1}{L}) + u_y(-\\frac{1}{H}) = -\\frac{u_x}{L} - \\frac{u_y}{H}\n$$\n$$\ng_2 = \\boldsymbol{u} \\cdot \\nabla N_2 = u_x(\\frac{1}{L}) + u_y(0) = \\frac{u_x}{L}\n$$\n$$\ng_3 = \\boldsymbol{u} \\cdot \\nabla N_3 = u_x(0) + u_y(\\frac{1}{H}) = \\frac{u_y}{H}\n$$\n接下来，我们计算它们的平方和 $\\sum_{k=1}^{3} g_k^2$：\n$$\n\\sum_{k=1}^{3} g_k^2 = g_1^2 + g_2^2 + g_3^2 = \\left(-\\frac{u_x}{L} - \\frac{u_y}{H}\\right)^2 + \\left(\\frac{u_x}{L}\\right)^2 + \\left(\\frac{u_y}{H}\\right)^2\n$$\n$$\n= \\left(\\frac{u_x^2}{L^2} + 2\\frac{u_x u_y}{LH} + \\frac{u_y^2}{H^2}\\right) + \\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} = 2\\frac{u_x^2}{L^2} + 2\\frac{u_y^2}{H^2} + 2\\frac{u_x u_y}{LH}\n$$\n$$\n\\sum_{k=1}^{3} g_k^2 = 2\\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right)\n$$\n最后，我们将此代入弗罗贝尼乌斯范数平方的表达式中。回想一下，单元面积为 $A = \\frac{LH}{2}$。\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\left(\\tau \\frac{LH}{2}\\right)^2 \\left[ 2\\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right) \\right]^2\n$$\n$$\n= \\tau^2 \\frac{L^2 H^2}{4} \\cdot 4 \\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right)^2\n$$\n$$\n= \\tau^2 L^2 H^2 \\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right)^2\n$$\n为了得到更紧凑的形式，我们可以将因子 $L^2 H^2$ 移到平方内部：\n$$\n\\| K^{\\mathrm{SUPG}} \\|_{F}^{2} = \\tau^2 \\left[ LH \\left(\\frac{u_x^2}{L^2} + \\frac{u_y^2}{H^2} + \\frac{u_x u_y}{LH}\\right) \\right]^2\n$$\n$$\n= \\tau^2 \\left( \\frac{H}{L}u_x^2 + \\frac{L}{H}u_y^2 + u_x u_y \\right)^2\n$$\n这就是 SUPG 贡献矩阵的弗罗贝尼乌斯范数平方的最终闭式表达式。",
            "answer": "$$\n\\boxed{\\tau^{2} \\left( \\frac{H}{L}u_{x}^{2} + \\frac{L}{H}u_{y}^{2} + u_{x} u_{y} \\right)^{2}}\n$$"
        }
    ]
}