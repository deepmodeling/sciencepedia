{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of designing reliable numerical methods is ensuring their stability. This exercise provides a foundational practice in performing a discrete energy analysis for a Flux Reconstruction scheme, utilizing the powerful Summation-By-Parts (SBP) property. By working through this derivation, you will determine the precise condition on the numerical flux that guarantees the scheme is energy-stable, a critical skill for developing and analyzing high-order methods for conservation laws.",
            "id": "3959925",
            "problem": "Consider the one-dimensional constant-coefficient linear advection equation $u_{t} + a\\,u_{x} = 0$ with $a>0$ on a periodic domain, discretized by Flux Reconstruction (FR) / Correction Procedure via Reconstruction (CPR) on $N$ uniform elements. On each element, let the nodal polynomial space be of degree $p \\geq 1$, and let the quadrature-based mass matrix $M$ be symmetric positive definite and the discrete differentiation matrix $D$ satisfy the Summation-By-Parts (SBP) property $M D + D^{\\top} M = R^{\\top} B R$, where $R$ extracts left/right face values and $B = \\mathrm{diag}(-1,1)$ encodes face orientation. The semi-discrete FR/CPR formulation is given elementwise by\n$$\nM\\,u_{t} = -\\,M\\,D\\,f(u)\\;+\\;R^{\\top}\\bigl(f^{\\mathrm{num}} - R\\,f(u)\\bigr),\n$$\nwith the physical flux $f(u) = a\\,u$. For each interior interface $i$ between two neighboring elements, define the average $\\{u\\}_{i} = \\tfrac{1}{2}\\bigl(u^{-}_{i} + u^{+}_{i}\\bigr)$ and jump $[u]_{i} = u^{+}_{i} - u^{-}_{i}$, where $u^{-}_{i}$ and $u^{+}_{i}$ denote the trace values from the left and right elements, respectively. Consider the one-parameter family of interface numerical fluxes\n$$\nf^{\\mathrm{num}}_{i} = a\\,\\{u\\}_{i} - a\\,c\\,[u]_{i},\\quad c \\in \\mathbb{R}.\n$$\nUsing only the SBP property and the periodic assembly of interface contributions, derive the semi-discrete energy balance for the total discrete energy\n$$\nE(t) \\;=\\; \\frac{1}{2}\\sum_{e=1}^{N} u_{e}(t)^{\\top} M\\,u_{e}(t),\n$$\nand determine the value of the parameter $c$ that ensures the assembled discrete operator governing $u_{t}$ is symmetric and negative semi-definite (so that the energy production is a non-positive quadratic form that depends only on jumps $[u]_{i}$ and includes no mixed average–jump terms). Express your final answer as a single real number (no units). No rounding is required.",
            "solution": "The problem asks for the value of the parameter $c$ in a numerical flux definition that ensures the stability of a Flux Reconstruction (FR) / Correction Procedure via Reconstruction (CPR) scheme for the linear advection equation. Specifically, the condition is that the semi-discrete operator is symmetric and negative semi-definite, which translates to an energy production rate that is non-positive and depends only on the solution jumps at element interfaces.\n\nThe analysis begins with the total discrete energy, defined as:\n$$\nE(t) = \\frac{1}{2}\\sum_{e=1}^{N} u_{e}(t)^{\\top} M u_{e}(t)\n$$\nwhere $u_e(t)$ is the vector of nodal solution values in element $e$, and $M$ is the symmetric positive definite mass matrix.\n\nWe differentiate $E(t)$ with respect to time $t$. Using the product rule and the symmetry of $M$ ($M=M^{\\top}$), we get:\n$$\n\\frac{dE}{dt} = \\frac{1}{2}\\sum_{e=1}^{N} \\left( \\frac{du_{e}^{\\top}}{dt} M u_{e} + u_{e}^{\\top} M \\frac{du_{e}}{dt} \\right) = \\sum_{e=1}^{N} u_{e}^{\\top} M \\frac{du_{e}}{dt}\n$$\nLet's denote $\\frac{du_e}{dt}$ as $u_{et}$. The semi-discrete FR/CPR formulation is given elementwise as:\n$$\nM u_{et} = -M D f(u_e) + R^{\\top}(f^{\\mathrm{num}}_{e} - R f(u_e))\n$$\nSince the problem specifies the linear advection equation, the physical flux is $f(u) = a u$, where $a>0$ is a constant. Thus, $f(u_e) = a u_e$. Substituting this into the formulation gives:\n$$\nM u_{et} = -a M D u_e + R^{\\top}(f^{\\mathrm{num}}_{e} - a R u_e)\n$$\nNow, substitute this expression for $M u_{et}$ into the equation for the energy rate of change:\n$$\n\\frac{dE}{dt} = \\sum_{e=1}^{N} u_{e}^{\\top} \\left( -a M D u_e + R^{\\top}(f^{\\mathrm{num}}_{e} - a R u_e) \\right)\n$$\n$$\n\\frac{dE}{dt} = \\sum_{e=1}^{N} \\left( -a u_{e}^{\\top} M D u_e + u_{e}^{\\top} R^{\\top} f^{\\mathrm{num}}_{e} - a u_{e}^{\\top} R^{\\top} R u_e \\right)\n$$\nThe terms can be rearranged as:\n$$\n\\frac{dE}{dt} = \\sum_{e=1}^{N} \\left( -a u_{e}^{\\top} M D u_e + (R u_e)^{\\top} f^{\\mathrm{num}}_{e} - a (R u_e)^{\\top} (R u_e) \\right)\n$$\nWe use the Summation-By-Parts (SBP) property, $M D + D^{\\top} M = R^{\\top} B R$, to analyze the first term. The quadratic form $u_e^{\\top} M D u_e$ can be related to its symmetric part:\n$$\nu_{e}^{\\top} M D u_e = \\frac{1}{2} u_{e}^{\\top} (M D + D^{\\top} M) u_e = \\frac{1}{2} u_{e}^{\\top} (R^{\\top} B R) u_e = \\frac{1}{2} (R u_e)^{\\top} B (R u_e)\n$$\nSubstituting this into the expression for $\\frac{dE}{dt}$:\n$$\n\\frac{dE}{dt} = \\sum_{e=1}^{N} \\left( -\\frac{a}{2} (R u_e)^{\\top} B (R u_e) + (R u_e)^{\\top} f^{\\mathrm{num}}_{e} - a (R u_e)^{\\top} (R u_e) \\right)\n$$\nLet's analyze the contribution from a single element $e$. Let $u_{e,L}$ and $u_{e,R}$ be the solution values at the left and right faces of the element. Then $R u_e = \\begin{pmatrix} u_{e,L} \\\\ u_{e,R} \\end{pmatrix}$. With $B = \\mathrm{diag}(-1, 1)$, the SBP term is $-\\frac{a}{2}(-u_{e,L}^2 + u_{e,R}^2)$. The total energy change $\\frac{dE}{dt}$ is the sum of contributions over all elements. We can regroup this sum by interfaces. Consider an interface $i$ between element $e$ (to its left) and element $e+1$ (to its right). The solution traces are $u_{e,R} = u_i^{-}$ and $u_{e+1,L} = u_i^{+}$. The numerical flux is single-valued at the interface, $f^{\\mathrm{num}}_{e,R} = f^{\\mathrm{num}}_{e+1,L} = f^{\\mathrm{num}}_i$.\n\nThe contribution to $\\frac{dE}{dt}$ from interface $i$ comes from the right face of element $e$ and the left face of element $e+1$:\n\\begin{itemize}\n    \\item From element $e$: $-\\frac{a}{2}(-u_{e,L}^2 + u_{e,R}^2)$ and other terms. The part at face $R$ is $-\\frac{a}{2} u_{e,R}^2 + u_{e,R} f_{e,R}^{\\text{num}} - a u_{e,R}^2 = u_i^{-} f_i^{\\text{num}} - \\frac{3a}{2}(u_i^{-})^2$.\n    \\item From element $e+1$: The part at face $L$ is $+\\frac{a}{2} u_{e+1,L}^2 + u_{e+1,L} f_{e+1,L}^{\\text{num}} - a u_{e+1,L}^2 = u_i^{+} f_i^{\\text{num}} - \\frac{a}{2}(u_i^{+})^2$.\n\\end{itemize}\nSumming these gives the total contribution from interface $i$:\n$$\n\\left(\\frac{dE}{dt}\\right)_i = (u_i^{-} + u_i^{+}) f^{\\mathrm{num}}_i - \\frac{a}{2} \\left( 3(u_i^{-})^2 + (u_i^{+})^2 \\right)\n$$\nNow, we substitute the definition of the numerical flux, $f^{\\mathrm{num}}_{i} = a\\,\\{u\\}_{i} - a\\,c\\,[u]_{i}$, expressed using the trace values $u_i^{-}$ and $u_i^{+}$:\n$$\nf^{\\mathrm{num}}_{i} = a \\frac{u_i^{-} + u_i^{+}}{2} - ac(u_i^{+} - u_i^{-})\n$$\nSubstituting this into the interface energy balance:\n$$\n\\left(\\frac{dE}{dt}\\right)_i = (u_i^{-} + u_i^{+}) \\left( a \\frac{u_i^{-} + u_i^{+}}{2} - ac(u_i^{+} - u_i^{-}) \\right) - \\frac{a}{2} \\left( 3(u_i^{-})^2 + (u_i^{+})^2 \\right)\n$$\n$$\n= \\frac{a}{2}(u_i^{-} + u_i^{+})^2 - ac(u_i^{+} - u_i^{-})(u_i^{-} + u_i^{+}) - \\frac{3a}{2}(u_i^{-})^2 - \\frac{a}{2}(u_i^{+})^2\n$$\n$$\n= \\frac{a}{2}((u_i^{-})^2 + 2u_i^{-}u_i^{+} + (u_i^{+})^2) - ac((u_i^{+})^2 - (u_i^{-})^2) - \\frac{3a}{2}(u_i^{-})^2 - \\frac{a}{2}(u_i^{+})^2\n$$\nCombine terms with $(u_i^{-})^2$ and $(u_i^{+})^2$:\n$$\n= \\left(\\frac{a}{2} + ac - \\frac{3a}{2}\\right)(u_i^{-})^2 + \\left(\\frac{a}{2} - ac - \\frac{a}{2}\\right)(u_i^{+})^2 + a u_i^{-}u_i^{+}\n$$\n$$\n= (ac-a)(u_i^{-})^2 -ac(u_i^{+})^2 + a u_i^{-}u_i^{+}\n$$\n$$\n= a u_i^{-}(c u_i^{-} - u_i^{-} + u_i^{+}) - ac(u_i^{+})^2 = -a u_i^{-} (u_i^{-} - u_i^{+}) + ac((u_i^{-})^2 - (u_i^{+})^2)\n$$\n$$\n= a u_i^{-} (u_i^{+} - u_i^{-}) - ac(u_i^{+} - u_i^{-})(u_i^{+} + u_i^{-})\n$$\nFactoring out the jump term $[u]_i = u_i^{+} - u_i^{-}$:\n$$\n= [u]_i \\left( a u_i^{-} - ac(u_i^{+} + u_i^{-}) \\right)\n$$\nSubstituting the average and jump definitions again: $u_i^{-} = \\{u\\}_i - \\frac{1}{2}[u]_i$ and $u_i^{+} + u_i^{-} = 2\\{u\\}_i$.\n$$\n= [u]_i \\left( a\\left(\\{u\\}_i - \\frac{1}{2}[u]_i\\right) - ac(2\\{u\\}_i) \\right)\n$$\n$$\n= [u]_i \\left( a\\{u\\}_i - \\frac{a}{2}[u]_i - 2ac\\{u\\}_i \\right)\n$$\n$$\n= a(1 - 2c)\\{u\\}_i[u]_i - \\frac{a}{2}[u]_i^2\n$$\nThe total energy dissipation rate is the sum over all interfaces:\n$$\n\\frac{dE}{dt} = \\sum_{i=1}^{N} \\left( a(1 - 2c)\\{u\\}_i[u]_i - \\frac{a}{2}[u]_i^2 \\right)\n$$\nThe problem requires that the energy production is a non-positive quadratic form that depends only on jumps $[u]_i$ and includes no mixed average-jump terms. This means the coefficient of the mixed term $\\{u\\}_i[u]_i$ must be zero.\n$$\na(1 - 2c) = 0\n$$\nSince we are given $a > 0$, this implies:\n$$\n1 - 2c = 0 \\implies 2c = 1 \\implies c = \\frac{1}{2}\n$$\nWith $c = \\frac{1}{2}$, the energy balance becomes:\n$$\n\\frac{dE}{dt} = \\sum_{i=1}^{N} \\left( -\\frac{a}{2}[u]_i^2 \\right)\n$$\nSince $a > 0$ and $[u]_i^2 \\geq 0$, $\\frac{dE}{dt} \\leq 0$. This confirms the operator is negative semi-definite (dissipative) and depends only on the solution jumps. The value $c=\\frac{1}{2}$ makes the numerical flux an upwind flux, $f^{\\mathrm{num}}_{i} = a u_i^{-}$, which is a classic choice for stable schemes for problems with $a>0$.",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "Moving from theory to application, this practice focuses on the core computational mechanics of the Flux Reconstruction method. You will apply the step-by-step procedure to a nonlinear problem, constructing the discontinuous flux, defining correction functions, and assembling the final continuously-reconstructed flux polynomial. This hands-on calculation is essential for understanding how the abstract components of the FR/CPR framework come together to approximate the spatial derivative within a single element.",
            "id": "3959927",
            "problem": "Consider the one-dimensional scalar conservation law $\\partial_{t} u + \\partial_{x} f(u) = 0$ on an affine-mapped element $\\Omega_{e}$ obtained from the reference interval $\\xi \\in [-1,1]$ by $x(\\xi) = x_{e} + \\frac{h}{2}\\,\\xi$, with constant Jacobian $J = \\frac{dx}{d\\xi} = \\frac{h}{2}$. Let the flux be the inviscid Burgers flux $f(u) = \\frac{1}{2} u^{2}$. On a single element, assume a polynomial solution representation of degree $p=2$ at the solution points $\\xi_{0} = -1$, $\\xi_{1} = 0$, and $\\xi_{2} = 1$, with nodal solution values $u(-1) = 1$, $u(0) = 2$, and $u(1) = \\frac{3}{2}$. The element size is $h = 3$, hence $J^{-1} = \\frac{2}{3}$. The nodal discontinuous flux values are $f_{i} = f(u(\\xi_{i}))$ for $i \\in \\{0,1,2\\}$, and the degree-$2$ discontinuous flux polynomial $f^{d}(\\xi)$ is the Lagrange interpolant of $\\{(\\xi_{i}, f_{i})\\}_{i=0}^{2}$.\nUsing Flux Reconstruction (FR) with Correction Procedure via Reconstruction (CPR), define the reconstructed flux on the element by\n$$\nf^{rec}(\\xi) = f^{d}(\\xi) + \\big(f_{L}^{\\ast} - f^{d}(-1)\\big)\\, g_{L}(\\xi) + \\big(f_{R}^{\\ast} - f^{d}(1)\\big)\\, g_{R}(\\xi),\n$$\nwhere the common interface fluxes at the element boundaries are given as $f_{L}^{\\ast} = \\frac{3}{4}$ and $f_{R}^{\\ast} = 1$. The correction functions are chosen from Huynh’s family for $p=2$ using Legendre polynomials:\n$$\ng_{L}(\\xi) = -\\tfrac{1}{2}\\big(P_{3}(\\xi) - P_{2}(\\xi)\\big), \\qquad g_{R}(\\xi) = \\tfrac{1}{2}\\big(P_{3}(\\xi) + P_{2}(\\xi)\\big),\n$$\nwith $P_{2}(\\xi) = \\tfrac{1}{2}(3\\xi^{2} - 1)$ and $P_{3}(\\xi) = \\tfrac{1}{2}(5\\xi^{3} - 3\\xi)$.\nCompute the Jacobian-weighted flux reconstruction derivative $J^{-1}\\,\\partial_{\\xi} f^{rec}(\\xi)$ at the three solution points $\\xi \\in \\{-1,0,1\\}$ and report the result as a single row vector in the order $\\xi=-1$, $\\xi=0$, $\\xi=1$. Express your final answer as exact rational numbers.\nThen, starting from the conservation law, the affine mapping, and polynomial interpolation, discuss the requirements on the correction functions and interface fluxes that guarantee exactness on affine elements for polynomial solutions of degree at most $p$. Your discussion should identify necessary properties for conservation and $p$-exactness. The final reported answer must be only the requested row vector; do not include units or any additional text in the final answer box.",
            "solution": "The analysis of the problem is performed in two parts. First, a numerical calculation is carried out to find the Jacobian-weighted flux reconstruction derivative at the specified points. Second, a theoretical discussion on the requirements for conservation and exactness of the Flux Reconstruction (FR/CPR) scheme is presented.\n\n### Part 1: Numerical Calculation\n\nThe problem asks for the computation of $J^{-1}\\,\\partial_{\\xi} f^{rec}(\\xi)$ at the solution points $\\xi \\in \\{-1, 0, 1\\}$. The process involves several steps.\n\n**1. Determine the Discontinuous Flux Polynomial, $f^{d}(\\xi)$**\n\nThe flux function is given as $f(u) = \\frac{1}{2}u^{2}$. The nodal solution values are $u(-1) = 1$, $u(0) = 2$, and $u(1) = \\frac{3}{2}$. The corresponding discontinuous flux values at the solution points $\\{\\xi_{0}, \\xi_{1}, \\xi_{2}\\} = \\{-1, 0, 1\\}$ are:\n$$f_{0} = f(u(-1)) = \\frac{1}{2}(1)^{2} = \\frac{1}{2}$$\n$$f_{1} = f(u(0)) = \\frac{1}{2}(2)^{2} = 2$$\n$$f_{2} = f(u(1)) = \\frac{1}{2}\\left(\\frac{3}{2}\\right)^{2} = \\frac{1}{2} \\cdot \\frac{9}{4} = \\frac{9}{8}$$\n\nThe discontinuous flux polynomial $f^{d}(\\xi)$ is the degree-$2$ Lagrange interpolant of the points $\\{(-1, \\frac{1}{2}), (0, 2), (1, \\frac{9}{8})\\}$. The Lagrange basis polynomials for the points $\\{-1, 0, 1\\}$ are:\n$$L_{0}(\\xi) = \\frac{(\\xi - 0)(\\xi - 1)}{(-1 - 0)(-1 - 1)} = \\frac{1}{2}(\\xi^{2} - \\xi)$$\n$$L_{1}(\\xi) = \\frac{(\\xi - (-1))(\\xi - 1)}{(0 - (-1))(0 - 1)} = -(\\xi^{2} - 1) = 1 - \\xi^{2}$$\n$$L_{2}(\\xi) = \\frac{(\\xi - (-1))(\\xi - 0)}{(1 - (-1))(1 - 0)} = \\frac{1}{2}(\\xi^{2} + \\xi)$$\n\nSo, $f^{d}(\\xi)$ is given by:\n$$f^{d}(\\xi) = f_{0}L_{0}(\\xi) + f_{1}L_{1}(\\xi) + f_{2}L_{2}(\\xi)$$\n$$f^{d}(\\xi) = \\frac{1}{2} \\cdot \\frac{1}{2}(\\xi^{2} - \\xi) + 2(1 - \\xi^{2}) + \\frac{9}{8} \\cdot \\frac{1}{2}(\\xi^{2} + \\xi)$$\n$$f^{d}(\\xi) = \\left(\\frac{1}{4} - 2 + \\frac{9}{16}\\right)\\xi^{2} + \\left(-\\frac{1}{4} + \\frac{9}{16}\\right)\\xi + 2$$\n$$f^{d}(\\xi) = \\left(\\frac{4 - 32 + 9}{16}\\right)\\xi^{2} + \\left(\\frac{-4 + 9}{16}\\right)\\xi + 2$$\n$$f^{d}(\\xi) = -\\frac{19}{16}\\xi^{2} + \\frac{5}{16}\\xi + 2$$\n\nThe boundary values of this polynomial are $f^{d}(-1) = f_{0} = \\frac{1}{2}$ and $f^{d}(1) = f_{2} = \\frac{9}{8}$.\n\n**2. Define the Reconstructed Flux, $f^{rec}(\\xi)$**\n\nThe reconstructed flux is defined as:\n$$f^{rec}(\\xi) = f^{d}(\\xi) + \\big(f_{L}^{\\ast} - f^{d}(-1)\\big)\\, g_{L}(\\xi) + \\big(f_{R}^{\\ast} - f^{d}(1)\\big)\\, g_{R}(\\xi)$$\nThe correction terms are:\n$$f_{L}^{\\ast} - f^{d}(-1) = \\frac{3}{4} - \\frac{1}{2} = \\frac{1}{4}$$\n$$f_{R}^{\\ast} - f^{d}(1) = 1 - \\frac{9}{8} = -\\frac{1}{8}$$\nThe correction functions $g_{L}(\\xi)$ and $g_{R}(\\xi)$ are given in terms of Legendre polynomials $P_{2}(\\xi) = \\frac{1}{2}(3\\xi^{2} - 1)$ and $P_{3}(\\xi) = \\frac{1}{2}(5\\xi^{3} - 3\\xi)$:\n$$g_{L}(\\xi) = -\\frac{1}{2}\\big(P_{3}(\\xi) - P_{2}(\\xi)\\big) = -\\frac{1}{2}\\left[\\frac{1}{2}(5\\xi^{3} - 3\\xi) - \\frac{1}{2}(3\\xi^{2} - 1)\\right] = -\\frac{5}{4}\\xi^{3} + \\frac{3}{4}\\xi^{2} + \\frac{3}{4}\\xi - \\frac{1}{4}$$\n$$g_{R}(\\xi) = \\frac{1}{2}\\big(P_{3}(\\xi) + P_{2}(\\xi)\\big) = \\frac{1}{2}\\left[\\frac{1}{2}(5\\xi^{3} - 3\\xi) + \\frac{1}{2}(3\\xi^{2} - 1)\\right] = \\frac{5}{4}\\xi^{3} + \\frac{3}{4}\\xi^{2} - \\frac{3}{4}\\xi - \\frac{1}{4}$$\nThe reconstructed flux expression is:\n$$f^{rec}(\\xi) = f^{d}(\\xi) + \\frac{1}{4}g_{L}(\\xi) - \\frac{1}{8}g_{R}(\\xi)$$\n\n**3. Compute the Derivative of the Reconstructed Flux**\n\nTo find the final result, we need to compute $\\partial_{\\xi} f^{rec}(\\xi)$.\n$$\\partial_{\\xi} f^{rec}(\\xi) = \\partial_{\\xi} f^{d}(\\xi) + \\frac{1}{4}\\partial_{\\xi}g_{L}(\\xi) - \\frac{1}{8}\\partial_{\\xi}g_{R}(\\xi)$$\nThe derivatives of the components are:\n$$\\partial_{\\xi} f^{d}(\\xi) = -\\frac{19}{8}\\xi + \\frac{5}{16}$$\n$$\\partial_{\\xi} g_{L}(\\xi) = -\\frac{15}{4}\\xi^{2} + \\frac{3}{2}\\xi + \\frac{3}{4}$$\n$$\\partial_{\\xi} g_{R}(\\xi) = \\frac{15}{4}\\xi^{2} + \\frac{3}{2}\\xi - \\frac{3}{4}$$\n\nNow, we evaluate $\\partial_{\\xi} f^{rec}(\\xi)$ at the solution points $\\xi \\in \\{-1, 0, 1\\}$.\n\nAt $\\xi = -1$:\n$$\\partial_{\\xi} f^{d}(-1) = -\\frac{19}{8}(-1) + \\frac{5}{16} = \\frac{19}{8} + \\frac{5}{16} = \\frac{38+5}{16} = \\frac{43}{16}$$\n$$\\partial_{\\xi} g_{L}(-1) = -\\frac{15}{4}(-1)^{2} + \\frac{3}{2}(-1) + \\frac{3}{4} = -\\frac{15}{4} - \\frac{6}{4} + \\frac{3}{4} = -\\frac{18}{4} = -\\frac{9}{2}$$\n$$\\partial_{\\xi} g_{R}(-1) = \\frac{15}{4}(-1)^{2} + \\frac{3}{2}(-1) - \\frac{3}{4} = \\frac{15}{4} - \\frac{6}{4} - \\frac{3}{4} = \\frac{6}{4} = \\frac{3}{2}$$\n$$\\partial_{\\xi} f^{rec}(-1) = \\frac{43}{16} + \\frac{1}{4}\\left(-\\frac{9}{2}\\right) - \\frac{1}{8}\\left(\\frac{3}{2}\\right) = \\frac{43}{16} - \\frac{9}{8} - \\frac{3}{16} = \\frac{43 - 18 - 3}{16} = \\frac{22}{16} = \\frac{11}{8}$$\n\nAt $\\xi = 0$:\n$$\\partial_{\\xi} f^{d}(0) = \\frac{5}{16}$$\n$$\\partial_{\\xi} g_{L}(0) = \\frac{3}{4}$$\n$$\\partial_{\\xi} g_{R}(0) = -\\frac{3}{4}$$\n$$\\partial_{\\xi} f^{rec}(0) = \\frac{5}{16} + \\frac{1}{4}\\left(\\frac{3}{4}\\right) - \\frac{1}{8}\\left(-\\frac{3}{4}\\right) = \\frac{5}{16} + \\frac{3}{16} + \\frac{3}{32} = \\frac{8}{16} + \\frac{3}{32} = \\frac{16+3}{32} = \\frac{19}{32}$$\n\nAt $\\xi = 1$:\n$$\\partial_{\\xi} f^{d}(1) = -\\frac{19}{8}(1) + \\frac{5}{16} = \\frac{-38+5}{16} = -\\frac{33}{16}$$\n$$\\partial_{\\xi} g_{L}(1) = -\\frac{15}{4}(1)^{2} + \\frac{3}{2}(1) + \\frac{3}{4} = \\frac{-15+6+3}{4} = -\\frac{6}{4} = -\\frac{3}{2}$$\n$$\\partial_{\\xi} g_{R}(1) = \\frac{15}{4}(1)^{2} + \\frac{3}{2}(1) - \\frac{3}{4} = \\frac{15+6-3}{4} = \\frac{18}{4} = \\frac{9}{2}$$\n$$\\partial_{\\xi} f^{rec}(1) = -\\frac{33}{16} + \\frac{1}{4}\\left(-\\frac{3}{2}\\right) - \\frac{1}{8}\\left(\\frac{9}{2}\\right) = -\\frac{33}{16} - \\frac{3}{8} - \\frac{9}{16} = \\frac{-33-6-9}{16} = -\\frac{48}{16} = -3$$\n\n**4. Scale by the Inverse Jacobian**\n\nThe Jacobian of the transformation $x(\\xi) = x_{e} + \\frac{h}{2}\\xi$ is $J = \\frac{dx}{d\\xi} = \\frac{h}{2}$. With $h=3$, $J = \\frac{3}{2}$. The inverse Jacobian is $J^{-1} = \\frac{2}{3}$.\nThe required values are $J^{-1} \\partial_{\\xi} f^{rec}(\\xi)$:\nAt $\\xi = -1$: $\\frac{2}{3} \\cdot \\frac{11}{8} = \\frac{11}{12}$\nAt $\\xi = 0$: $\\frac{2}{3} \\cdot \\frac{19}{32} = \\frac{19}{48}$\nAt $\\xi = 1$: $\\frac{2}{3} \\cdot (-3) = -2$\n\nThe result is the row vector $\\left( \\frac{11}{12}, \\frac{19}{48}, -2 \\right)$.\n\n### Part 2: Theoretical Discussion\n\nThe FR/CPR method for a conservation law $\\partial_{t} u + \\partial_{x} f(u) = 0$ is constructed on a reference element $\\xi \\in [-1, 1]$ via an affine map with Jacobian $J$. The semi-discrete form is $\\frac{du_{e}}{dt} + J^{-1}\\nabla_{\\xi} \\cdot \\mathbf{f}^{rec} = 0$, which for a 1D scalar problem becomes $\\frac{d u(\\xi_{j})}{dt} + J^{-1} \\partial_{\\xi} f^{rec}(\\xi_{j}) = 0$. The method's validity hinges on properties ensuring conservation and accuracy.\n\n**1. Requirement for Conservation**\nA numerical scheme is conservative if the change in a quantity within a control volume is solely due to the flux across its boundaries. In a Discontinuous Galerkin or FR/CPR framework, this is achieved by ensuring the numerical flux is single-valued at element interfaces.\nThe reconstructed flux is $f^{rec}(\\xi) = f^{d}(\\xi) + \\delta_{L}(\\xi) + \\delta_{R}(\\xi)$, where $\\delta_{L}(\\xi) = (f_{L}^{\\ast} - f^{d}(-1))g_{L}(\\xi)$ and $\\delta_{R}(\\xi) = (f_{R}^{\\ast} - f^{d}(1))g_{R}(\\xi)$. At the left boundary $\\xi=-1$, the reconstructed flux must equal the common interface flux $f_{L}^{\\ast}$:\n$$f^{rec}(-1) = f^{d}(-1) + \\big(f_{L}^{\\ast} - f^{d}(-1)\\big)\\, g_{L}(-1) + \\big(f_{R}^{\\ast} - f^{d}(1)\\big)\\, g_{R}(-1) = f_{L}^{\\ast}$$\nFor this equality to hold for any values of $f^{d}(-1)$, $f^{d}(1)$, $f_{L}^{\\ast}$, and $f_{R}^{\\ast}$, the correction functions must satisfy:\n$$g_{L}(-1) = 1 \\quad \\text{and} \\quad g_{R}(-1) = 0$$\nSimilarly, at the right boundary $\\xi=1$, the reconstructed flux must equal $f_{R}^{\\ast}$:\n$$f^{rec}(1) = f^{d}(1) + \\big(f_{L}^{\\ast} - f^{d}(-1)\\big)\\, g_{L}(1) + \\big(f_{R}^{\\ast} - f^{d}(1)\\big)\\, g_{R}(1) = f_{R}^{\\ast}$$\nThis necessitates that the correction functions satisfy:\n$$g_{L}(1) = 0 \\quad \\text{and} \\quad g_{R}(1) = 1$$\nThese four boundary conditions on $g_L$ and $g_R$ are necessary properties to ensure that the reconstructed flux is continuous across element boundaries, which, when combined with a conservative interface flux $f^{\\ast}$ (e.g., Lax-Friedrichs, Roe), guarantees global conservation.\n\n**2. Requirement for $p$-Exactness**\nA scheme is said to be $p$-exact for a polynomial solution of degree at most $p$ if it reproduces the exact solution. For the semi-discrete conservation law, this means the computed spatial derivative term must equal the exact spatial derivative. On an affine element, $u$ being a polynomial of degree up to $p$ in $x$ means it is also a polynomial of degree up to $p$ in $\\xi$.\nThe exact equation is $\\partial_{t}u = -J^{-1}\\partial_{\\xi}f(u)$. The numerical scheme computes $\\frac{du_j}{dt} = -J^{-1}\\partial_{\\xi}f^{rec}(\\xi_j)$.\nTherefore, for $p$-exactness, we need $\\partial_{\\xi}f^{rec}(\\xi_j) = \\partial_{\\xi}f(u(\\xi_j))$ for all solution points $\\xi_j$, for any solution $u(\\xi)$ that is a polynomial of degree at most $p$.\n\nThis condition is satisfied by the FR/CPR framework by ensuring that if the *flux* $f(u(\\xi))$ is itself a polynomial of degree at most $p$, its derivative is recovered exactly. Let the exact flux be a polynomial $Q(\\xi)$ of degree at most $p$.\n1.  The nodal values for the discontinuous flux are $f_j = Q(\\xi_j)$. Since $Q(\\xi)$ is a polynomial of degree at most $p$, its Lagrange interpolant $f^d(\\xi)$ through $p+1$ points is identical to itself: $f^d(\\xi) = Q(\\xi)$.\n2.  The interface flux $f^{\\ast}$ must be *consistent*, meaning $f^{\\ast}(u, u) = f(u)$. For a continuous polynomial solution $Q(\\xi)$, the flux at the boundary is simply its value there. Thus, we must have $f_{L}^{\\ast} = Q(-1)$ and $f_{R}^{\\ast} = Q(1)$.\n3.  The correction terms in the reconstructed flux become:\n    $$f_{L}^{\\ast} - f^{d}(-1) = Q(-1) - Q(-1) = 0$$\n    $$f_{R}^{\\ast} - f^{d}(1) = Q(1) - Q(1) = 0$$\n4.  Consequently, the entire correction vanishes, and the reconstructed flux is identical to the discontinuous (and exact) flux: $f^{rec}(\\xi) = f^{d}(\\xi) = Q(\\xi)$.\n5.  The derivative is therefore exact everywhere: $\\partial_{\\xi}f^{rec}(\\xi) = \\partial_{\\xi}Q(\\xi)$.\n\nThis demonstrates that the scheme is exact for any flux function that is a polynomial of degree at most $p$. This property underpins the scheme's order of accuracy, which is $p+1$. For nonlinear problems like Burgers' equation, where a polynomial solution $u(\\xi)$ of degree $p$ produces a flux $f(u(\\xi))$ of degree $2p$, the specific choice of correction functions (e.g., from Huynh's family) is crucial for stability and for achieving accuracy beyond this baseline by optimally correcting the derivative of the higher-order polynomial components of the flux. For example, the chosen functions for $p=2$, built from $P_2$ and $P_3$, are designed to exactly reconstruct the derivative of any polynomial of degree up to $p+1=3$ at the solution points, thus providing superior accuracy.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{11}{12} & \\frac{19}{48} & -2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The landscape of high-order methods contains many seemingly different schemes that are, in fact, deeply related. This advanced exercise explores the unifying principles connecting the Correction Procedure via Reconstruction (CPR) and Spectral Difference (SD) methods. By deriving the specific correction functions that make the two schemes identical, you will gain a deeper appreciation for the common mathematical structure underlying these methods and learn how properties like stability can be inferred across different frameworks.",
            "id": "3959970",
            "problem": "Consider one-dimensional linear advection $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a>0$ on a uniform mesh of physical elements of width $h$, each mapped affinely to a reference element $\\xi \\in [-1,1]$. On each reference element, represent the solution by a polynomial of degree $p=2$ collocated at equidistant solution nodes $\\xi_{0}=-1$, $\\xi_{1}=0$, and $\\xi_{2}=1$. Let $u(\\xi)$ denote the degree-$2$ interpolant from these nodes, and define the discontinuous flux $f_{d}(\\xi) = a\\,u(\\xi)$.\n\nIn the Correction Procedure via Reconstruction (CPR), the corrected flux is constructed as\n$$\nf_{c}(\\xi) \\;=\\; f_{d}(\\xi) \\;+\\; \\big(f_{L}^{\\ast} - f_{d}(-1)\\big)\\,g_{L}(\\xi) \\;+\\; \\big(f_{R}^{\\ast} - f_{d}(1)\\big)\\,g_{R}(\\xi),\n$$\nwhere $f_{L}^{\\ast}$ and $f_{R}^{\\ast}$ are consistent numerical fluxes at the left and right boundaries, and $g_{L}(\\xi)$, $g_{R}(\\xi)$ are degree-$3$ correction functions satisfying the boundary interpolation constraints $g_{L}(-1)=1$, $g_{L}(1)=0$, $g_{R}(-1)=0$, and $g_{R}(1)=1$. Assume the symmetry constraint $g_{R}(\\xi)=g_{L}(-\\xi)$.\n\nIn the Spectral Difference (SD) method on the same element with the same solution nodes, let the flux points be the equidistant set $\\{-1,\\,-\\frac{1}{3},\\,\\frac{1}{3},\\,1\\}$, and define the degree-$3$ reconstructed flux polynomial $F(\\xi)$ by requiring\n$$\nF(-1)=f_{L}^{\\ast}, \\quad F(1)=f_{R}^{\\ast}, \\quad F\\!\\left(-\\tfrac{1}{3}\\right)=a\\,u\\!\\left(-\\tfrac{1}{3}\\right), \\quad F\\!\\left(\\tfrac{1}{3}\\right)=a\\,u\\!\\left(\\tfrac{1}{3}\\right).\n$$\nStarting from these definitions and the polynomial interpolation properties on $\\xi\\in[-1,1]$, derive the necessary and sufficient conditions on $g_{L}(\\xi)$ and $g_{R}(\\xi)$ for the CPR corrected flux $f_{c}(\\xi)$ to coincide with the SD reconstructed flux $F(\\xi)$ for all degree-$2$ solutions $u(\\xi)$, under arbitrary consistent boundary fluxes $f_{L}^{\\ast}$ and $f_{R}^{\\ast}$.\n\nThen, using the equidistant nodes and the conditions you derived, solve explicitly for the left correction function $g_{L}(\\xi)$ as a single closed-form polynomial of degree $3$.\n\nFinally, based on your equivalence conditions, explain the implication for linear energy stability of the semi-discrete scheme with an upwind numerical flux choice at element boundaries, and identify whether interior pointwise corrections contribute to the discrete energy production.\n\nExpress your final answer as the closed-form analytic expression for $g_{L}(\\xi)$; no numerical approximation and no units are required.",
            "solution": "The problem requires the derivation of conditions for the equivalence of a Correction Procedure via Reconstruction (CPR) scheme and a Spectral Difference (SD) scheme, the explicit form of the CPR correction function $g_L(\\xi)$ that ensures this equivalence, and an analysis of the stability implications.\n\n**Derivation of Equivalence Conditions**\n\nThe core of the first task is to find the necessary and sufficient conditions on $g_L(\\xi)$ and $g_R(\\xi)$ such that the CPR corrected flux $f_c(\\xi)$ is identical to the SD reconstructed flux $F(\\xi)$ for any degree-$2$ solution $u(\\xi)$ and any consistent numerical fluxes $f_L^*$ and $f_R^*$.\nThe two flux functions are:\n$$f_{c}(\\xi) = a\\,u(\\xi) + \\big(f_{L}^{\\ast} - a\\,u(-1)\\big)\\,g_{L}(\\xi) + \\big(f_{R}^{\\ast} - a\\,u(1)\\big)\\,g_{R}(\\xi)$$\n$$F(\\xi) \\text{ is a degree-3 polynomial defined by interpolation conditions.}$$\nSince $u(\\xi)$ is degree-$2$ and $g_L(\\xi)$, $g_R(\\xi)$ are degree-$3$, $f_c(\\xi)$ is a polynomial of degree at most $3$. The SD flux $F(\\xi)$ is also defined as a degree-$3$ polynomial. For two polynomials of degree at most $3$ to be identical, it is necessary and sufficient that they agree at $4$ distinct points. Let's use the SD flux points $\\{-1, -1/3, 1/3, 1\\}$ for this comparison.\n\n1.  At $\\xi=-1$:\n    $f_c(-1) = a\\,u(-1) + (f_L^* - a\\,u(-1))g_L(-1) + (f_R^* - a\\,u(1))g_R(-1)$.\n    Using the given constraints $g_L(-1)=1$ and $g_R(-1)=0$:\n    $f_c(-1) = a\\,u(-1) + (f_L^* - a\\,u(-1))(1) + (f_R^* - a\\,u(1))(0) = f_L^*$.\n    The SD flux is $F(-1) = f_L^*$. Thus, $f_c(-1) = F(-1)$ is automatically satisfied.\n\n2.  At $\\xi=1$:\n    $f_c(1) = a\\,u(1) + (f_L^* - a\\,u(-1))g_L(1) + (f_R^* - a\\,u(1))g_R(1)$.\n    Using the given constraints $g_L(1)=0$ and $g_R(1)=1$:\n    $f_c(1) = a\\,u(1) + (f_L^* - a\\,u(-1))(0) + (f_R^* - a\\,u(1))(1) = f_R^*$.\n    The SD flux is $F(1) = f_R^*$. Thus, $f_c(1) = F(1)$ is also automatically satisfied.\n\n3.  At $\\xi = -1/3$:\n    For equivalence, we must have $f_c(-1/3) = F(-1/3)$. The SD definition gives $F(-1/3) = a\\,u(-1/3)$.\n    Therefore, we require:\n    $a\\,u(-1/3) + (f_L^* - a\\,u(-1))g_L(-1/3) + (f_R^* - a\\,u(1))g_R(-1/3) = a\\,u(-1/3)$.\n    This simplifies to:\n    $(f_L^* - a\\,u(-1))g_L(-1/3) + (f_R^* - a\\,u(1))g_R(-1/3) = 0$.\n    This equation must hold for any valid choice of $u(\\xi)$ (degree-2 polynomial) and arbitrary consistent fluxes $f_L^*$ and $f_R^*$. The terms $(f_L^* - a\\,u(-1))$ and $(f_R^* - a\\,u(1))$ represent jumps at the boundaries and can be varied independently. For their linear combination to be zero for any coefficients, the multipliers must both be zero. This gives the conditions:\n    $g_L(-1/3) = 0$\n    $g_R(-1/3) = 0$\n\n4.  At $\\xi = 1/3$:\n    Similarly, we must have $f_c(1/3) = F(1/3)$, which is $f_c(1/3) = a\\,u(1/3)$.\n    $(f_L^* - a\\,u(-1))g_L(1/3) + (f_R^* - a\\,u(1))g_R(1/3) = 0$.\n    For this to hold for arbitrary $f_L^*$ and $f_R^*$, we must have:\n    $g_L(1/3) = 0$\n    $g_R(1/3) = 0$\n\nThe derived conditions are consistent with the symmetry constraint $g_R(\\xi) = g_L(-\\xi)$, as $g_R(1/3)=g_L(-1/3)$ and $g_R(-1/3)=g_L(1/3)$.\nTherefore, the necessary and sufficient conditions for $f_c(\\xi) \\equiv F(\\xi)$ are that the correction functions vanish at the interior flux points of the SD scheme:\n$$g_L(\\tfrac{1}{3}) = 0, \\quad g_L(-\\tfrac{1}{3}) = 0, \\quad g_R(\\tfrac{1}{3}) = 0, \\quad g_R(-\\tfrac{1}{3}) = 0.$$\n\n**Explicit Solution for the Correction Function $g_L(\\xi)$**\n\nWe need to find the unique degree-$3$ polynomial $g_L(\\xi)$ that satisfies the four conditions:\n1.  $g_L(-1) = 1$ (from problem statement)\n2.  $g_L(1) = 0$ (from problem statement)\n3.  $g_L(-1/3) = 0$ (from derived condition)\n4.  $g_L(1/3) = 0$ (from derived condition)\n\nSince $g_L(\\xi)$ has roots at $\\xi=1$, $\\xi=1/3$, and $\\xi=-1/3$, it can be written in the form:\n$$g_L(\\xi) = C (\\xi - 1) (\\xi - \\tfrac{1}{3}) (\\xi + \\tfrac{1}{3})$$\nwhere $C$ is a constant. This simplifies to:\n$$g_L(\\xi) = C (\\xi - 1) (\\xi^2 - \\tfrac{1}{9})$$\nWe determine the constant $C$ using the remaining condition, $g_L(-1)=1$:\n$$1 = C (-1 - 1) ((-1)^2 - \\tfrac{1}{9}) = C (-2) (1 - \\tfrac{1}{9}) = C (-2) (\\tfrac{8}{9}) = -\\tfrac{16}{9} C$$\nSolving for $C$ yields $C = -9/16$.\nSubstituting $C$ back into the expression for $g_L(\\xi)$:\n$$g_L(\\xi) = -\\frac{9}{16} (\\xi - 1) (\\xi^2 - \\frac{1}{9})$$\nExpanding this into the standard polynomial form:\n$$g_L(\\xi) = -\\frac{9}{16} (\\xi^3 - \\xi^2 - \\frac{1}{9}\\xi + \\frac{1}{9})$$\n$$g_L(\\xi) = -\\frac{9}{16}\\xi^3 + \\frac{9}{16}\\xi^2 + \\frac{1}{16}\\xi - \\frac{1}{16}$$\n\n**Implications for Linear Energy Stability**\n\nThe stability of the semi-discrete scheme is analyzed by examining the rate of change of a discrete energy norm. The equivalence of this CPR scheme to an SD scheme on equidistant flux points implies it inherits the stability properties of the latter. Equidistant-point SD schemes are known to be linearly unstable for advection problems.\n\nThe mechanism for this instability lies in the contribution of the interior pointwise corrections to the discrete energy production. For a typical Discontinuous Galerkin (DG) scheme, stability is achieved because the volume integral and surface integral terms combine (with an upwind flux) to produce a purely dissipative term proportional to the square of the jump at the interface.\nIn the equivalent CPR scheme, the total flux is $f_c = f_d + \\delta f_c$, where $f_d=au$ is the discontinuous flux (like in DG) and $\\delta f_c$ is the correction part. The energy change rate contains a term $\\int (\\partial_\\xi u) \\delta f_c d\\xi$.\nThis term represents the energy production or dissipation from the correction procedure *within* the element. For the specific correction functions derived here, this term is not guaranteed to be zero or non-positive. Since these functions make the scheme equivalent to an unstable SD scheme, it confirms that the **interior pointwise corrections contribute to the discrete energy production** in a way that can be positive, leading to energy growth and linear instability. An upwind flux choice provides dissipation at the boundaries, but this is not sufficient to overcome the potential energy production from the interior corrections for this particular scheme.",
            "answer": "$$ \\boxed{-\\frac{9}{16}\\xi^3 + \\frac{9}{16}\\xi^2 + \\frac{1}{16}\\xi - \\frac{1}{16}} $$"
        }
    ]
}