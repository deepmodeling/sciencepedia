{
    "hands_on_practices": [
        {
            "introduction": "At the heart of Essentially Non-Oscillatory (ENO) methods lies the principle of adaptive stenciling to avoid interpolating across discontinuities, which would otherwise introduce spurious oscillations. This first practice provides a concrete, hands-on application of this core idea. You will use Newton's divided differences to quantify local smoothness and select the optimal stencil from a set of candidates, thereby constructing a non-oscillatory polynomial from a given set of data points .",
            "id": "3957182",
            "problem": "In aerospace computational fluid dynamics, high-resolution reconstructions at cell interfaces are used to compute numerical fluxes for hyperbolic conservation laws. Consider a uniform one-dimensional grid with spacing $\\Delta x = 1$ and nodes $x_{j} = j$ for integer $j$. You are given pointwise solution values $u_{j}$ at five consecutive nodes with indices $j \\in \\{-2,-1,0,1,2\\}$:\n- $u_{-2} = -0.909297$,\n- $u_{-1} = -0.841471$,\n- $u_{0} = 0.000000$,\n- $u_{1} = 3.100000$,\n- $u_{2} = 3.300000$.\n\nAssume a positive characteristic wave speed so that a left-biased reconstruction at the interface $x_{i+1/2}$ with $i=0$ is appropriate. Starting from the fundamental definition of polynomial interpolation and Newton’s divided differences, construct the third-order Essential Non-Oscillatory (ENO) polynomial at the interface $x_{1/2} = 0.5$ by:\n1. Enumerating all three-point candidate stencils that can be used to reconstruct a quadratic polynomial for the left-biased value at $x_{1/2}$,\n2. Computing the corresponding second divided differences for each candidate stencil on the uniform grid,\n3. Selecting the stencil that maximizes local smoothness according to the ENO principle,\n4. Constructing the unique quadratic interpolant on the chosen stencil and evaluating it at $x_{1/2}$.\n\nReport the reconstructed interface value $u^{-}_{1/2}$ as a real number rounded to six significant figures. No units are required. Also explain how the selected stencil maximizes local smoothness based on your second divided difference calculations.",
            "solution": "The problem requires the construction of a third-order Essentially Non-Oscillatory (ENO) reconstruction for a left-biased value, denoted $u^{-}_{1/2}$, at the cell interface $x_{1/2} = 0.5$. The procedure is based on polynomial interpolation using a stencil of points selected from the provided data to maximize local smoothness. A third-order accurate scheme uses a quadratic interpolating polynomial, which requires a stencil of $3$ points. The process unfolds in four distinct steps as specified.\n\nThe given data are the point values $u_j$ at nodes $x_j = j$ for a uniform grid with spacing $\\Delta x = 1$:\n- $u_{-2} = -0.909297$\n- $u_{-1} = -0.841471$\n- $u_{0} = 0.000000$\n- $u_{1} = 3.100000$\n- $u_{2} = 3.300000$\n\n**1. Enumeration of Candidate Stencils**\n\nFor a third-order reconstruction at the interface $x_{i+1/2}$ with $i=0$ (i.e., $x_{1/2}$), we seek a quadratic polynomial (degree $2$). Such a polynomial is uniquely defined by $3$ points. The candidate stencils are formed by shifting a $3$-point window around the cell of interest, $i=0$. Since the characteristic wave speed is positive, a left-biased reconstruction is required, meaning the stencils are preferentially located to the left of the interface. The standard set of candidate stencils, $S_k$, for a reconstruction at $x_{1/2}$ are:\n- $S_0 = \\{x_0, x_1, x_2\\}$, corresponding to indices $\\{0, 1, 2\\}$.\n- $S_1 = \\{x_{-1}, x_0, x_1\\}$, corresponding to indices $\\{-1, 0, 1\\}$.\n- $S_2 = \\{x_{-2}, x_{-1}, x_0\\}$, corresponding to indices $\\{-2, -1, 0\\}$.\n\n**2. Computation of Second Divided Differences**\n\nThe ENO algorithm selects the \"smoothest\" stencil by comparing the magnitudes of the highest-order divided differences. For a quadratic polynomial, this corresponds to the second divided difference.\nThe first divided difference on a uniform grid with $\\Delta x=1$ is $u[x_j, x_{j+1}] = \\frac{u_{j+1} - u_j}{x_{j+1}-x_j} = u_{j+1} - u_j$.\nThe second divided difference is $u[x_j, x_{j+1}, x_{j+2}] = \\frac{u[x_{j+1}, x_{j+2}] - u[x_j, x_{j+1}]}{x_{j+2}-x_j} = \\frac{(u_{j+2}-u_{j+1}) - (u_{j+1}-u_j)}{2}$.\n\nFirst, we compute the required first divided differences:\n- $u[x_{-2}, x_{-1}] = u_{-1} - u_{-2} = -0.841471 - (-0.909297) = 0.067826$\n- $u[x_{-1}, x_0] = u_0 - u_{-1} = 0.000000 - (-0.841471) = 0.841471$\n- $u[x_0, x_1] = u_1 - u_0 = 3.100000 - 0.000000 = 3.100000$\n- $u[x_1, x_2] = u_2 - u_1 = 3.300000 - 3.100000 = 0.200000$\n\nNext, we compute the second divided differences for each candidate stencil:\n- For $S_0 = \\{0, 1, 2\\}$:\n$u[x_0, x_1, x_2] = \\frac{u[x_1, x_2] - u[x_0, x_1]}{x_2 - x_0} = \\frac{0.200000 - 3.100000}{2} = -1.450000$\n- For $S_1 = \\{-1, 0, 1\\}$:\n$u[x_{-1}, x_0, x_1] = \\frac{u[x_0, x_1] - u[x_{-1}, x_0]}{x_1 - x_{-1}} = \\frac{3.100000 - 0.841471}{2} = 1.1292645$\n- For $S_2 = \\{-2, -1, 0\\}$:\n$u[x_{-2}, x_{-1}, x_0] = \\frac{u[x_{-1}, x_0] - u[x_{-2}, x_{-1}]}{x_0 - x_{-2}} = \\frac{0.841471 - 0.067826}{2} = 0.3868225$\n\n**3. Stencil Selection based on the ENO Principle**\n\nThe ENO principle dictates selecting the stencil that corresponds to the interpolating polynomial with the minimum oscillation. This is achieved by choosing the stencil with the smallest absolute value of the highest-order divided difference. We compare the magnitudes of the second divided differences:\n- For $S_0$: $|u[x_0, x_1, x_2]| = |-1.450000| = 1.450000$\n- For $S_1$: $|u[x_{-1}, x_0, x_1]| = |1.1292645| = 1.1292645$\n- For $S_2$: $|u[x_{-2}, x_{-1}, x_0]| = |0.3868225| = 0.3868225$\n\nThe minimum magnitude is $0.3868225$, which corresponds to the stencil $S_2 = \\{-2, -1, 0\\}$.\nThis stencil maximizes local smoothness because the second divided difference is an approximation of the second derivative of the underlying function. By selecting the stencil with the minimum-magnitude second divided difference, we are choosing the data set that can be fit by the \"flattest\" or least curved quadratic polynomial. The large magnitudes for stencils $S_1$ and $S_0$ suggest the presence of a sharp gradient or discontinuity in the data between stencil points $\\{0\\}$ and $\\{1\\}$, and the ENO algorithm correctly avoids interpolating across this feature.\n\n**4. Construction and Evaluation of the Interpolating Polynomial**\n\nWe construct the unique quadratic polynomial $P(x)$ that interpolates the data on the selected stencil $S_2=\\{-2,-1,0\\}$, which consists of the points $(x_{-2}, u_{-2})$, $(x_{-1}, u_{-1})$, and $(x_0, u_0)$. The Newton form of the interpolating polynomial is the most direct method. For the points $\\{x_{-2}, x_{-1}, x_0\\}$, the polynomial is:\n$$P(x) = u[x_{-2}] + u[x_{-2}, x_{-1}](x-x_{-2}) + u[x_{-2}, x_{-1}, x_0](x-x_{-2})(x-x_{-1})$$\nSubstituting the values:\n- $u[x_{-2}] = u_{-2} = -0.909297$\n- $u[x_{-2}, x_{-1}] = 0.067826$\n- $u[x_{-2}, x_{-1}, x_0] = 0.3868225$\n- $x_{-2} = -2$, $x_{-1} = -1$\n\nThe polynomial is:\n$$P(x) = -0.909297 + 0.067826(x - (-2)) + 0.3868225(x - (-2))(x - (-1))$$\n$$P(x) = -0.909297 + 0.067826(x+2) + 0.3868225(x+2)(x+1)$$\nWe evaluate this polynomial at the interface location $x = x_{1/2} = 0.5$ to find the reconstructed value $u^{-}_{1/2}$:\n$$u^{-}_{1/2} = P(0.5) = -0.909297 + 0.067826(0.5+2) + 0.3868225(0.5+2)(0.5+1)$$\n$$u^{-}_{1/2} = -0.909297 + 0.067826(2.5) + 0.3868225(2.5)(1.5)$$\n$$u^{-}_{1/2} = -0.909297 + 0.169565 + 0.3868225(3.75)$$\n$$u^{-}_{1/2} = -0.909297 + 0.169565 + 1.450584375$$\n$$u^{-}_{1/2} = -0.739732 + 1.450584375 = 0.710852375$$\nThe problem requires the answer to be rounded to six significant figures.\n$$u^{-}_{1/2} \\approx 0.710852$$\nThis value is the third-order ENO reconstruction at the interface $x_{1/2}$.",
            "answer": "$$\\boxed{0.710852}$$"
        },
        {
            "introduction": "Moving from ENO to Weighted Essentially Non-Oscillatory (WENO) involves replacing the discrete stencil choice with a convex combination of all candidate stencils, assigning weights based on local smoothness. This exercise delves into the foundational algebra of the widely-used fifth-order WENO-JS scheme in a finite-volume context. By deriving the explicit coefficients for the candidate polynomials, you will gain a deeper appreciation for the scheme's construction and its relationship to the underlying cell-averaged data .",
            "id": "3957151",
            "problem": "Consider the one-dimensional scalar conservation law $\\partial u/\\partial t + \\partial f(u)/\\partial x = 0$ on a uniform grid with spacing $\\Delta x$, and denote by $\\bar{f}_{i}$ the cell-average of the flux $f(u)$ over the cell $[x_{i-1/2}, x_{i+1/2}]$. In the finite-volume Weighted Essentially Non-Oscillatory (WENO) reconstruction of order five due to Jiang and Shu (WENO5-JS), the left-biased interface flux at $x_{i+1/2}$ is constructed by forming three quadratic candidate polynomials $p^{(0)}(x)$, $p^{(1)}(x)$, and $p^{(2)}(x)$ on the stencils $\\{i-2,i-1,i\\}$, $\\{i-1,i,i+1\\}$, and $\\{i,i+1,i+2\\}$, respectively. Each candidate polynomial $p^{(k)}(x)$ is defined as the unique quadratic that reproduces the given cell-averages on its stencil, and the corresponding candidate interface value is $q_{k} = p^{(k)}(x_{i+1/2})$.\n\nStarting from the finite-volume definition of a cell-average and the requirement that each quadratic $p^{(k)}(x)$ matches the three cell-averages on its stencil, derive the three candidate interface values $q_{0}$, $q_{1}$, and $q_{2}$ explicitly as linear combinations of $\\bar{f}_{i-2}$, $\\bar{f}_{i-1}$, $\\bar{f}_{i}$, $\\bar{f}_{i+1}$, and $\\bar{f}_{i+2}$, and compute their exact rational coefficients. Express your final result as a single row matrix listing the nine coefficients in the order $(c_{0,-2}, c_{0,-1}, c_{0,0}; c_{1,-1}, c_{1,0}, c_{1,1}; c_{2,0}, c_{2,1}, c_{2,2})$, where $q_{0} = c_{0,-2}\\bar{f}_{i-2} + c_{0,-1}\\bar{f}_{i-1} + c_{0,0}\\bar{f}_{i}$, $q_{1} = c_{1,-1}\\bar{f}_{i-1} + c_{1,0}\\bar{f}_{i} + c_{1,1}\\bar{f}_{i+1}$, and $q_{2} = c_{2,0}\\bar{f}_{i} + c_{2,1}\\bar{f}_{i+1} + c_{2,2}\\bar{f}_{i+2}$. Provide the coefficients in exact fractional form. No rounding is required.",
            "solution": "The problem requires the derivation of the coefficients for the three candidate interface fluxes, denoted as $q_0$, $q_1$, and $q_2$, in the fifth-order Weighted Essentially Non-Oscillatory (WENO) finite-volume scheme. The interface flux at $x_{i+1/2}$ is reconstructed from the cell-averaged values of the flux function, $\\bar{f}_j$, on three different stencils.\n\nLet us establish a local coordinate system normalized by the grid spacing $\\Delta x$ and centered at $x_i$, the center of cell $i$. We define $\\xi = (x-x_i)/\\Delta x$. In this system, the cell $I_j = [x_{j-1/2}, x_{j+1/2}]$ corresponds to the interval $[j-i-1/2, j-i+1/2]$ in $\\xi$. The interface of interest, $x_{i+1/2}$, is located at $\\xi = 1/2$.\n\nThe fundamental condition is that each candidate polynomial, $p^{(k)}(x)$, must reproduce the cell averages of the flux function, $\\bar{f}_j$, on its respective stencil. In the normalized coordinate system, this condition is:\n$$ \\bar{f}_j = \\frac{1}{\\Delta x} \\int_{x_{j-1/2}}^{x_{j+1/2}} p^{(k)}(x) dx = \\int_{j-i-1/2}^{j-i+1/2} p^{(k)}(\\xi) d\\xi $$\nwhere $p^{(k)}(\\xi)$ is now a quadratic polynomial in $\\xi$. Let us represent a generic quadratic polynomial as $p(\\xi) = A\\xi^2 + B\\xi + C$. Its integral over a cell $I_j$, centered at $\\xi_j = j-i$, is:\n$$ \\int_{\\xi_j - 1/2}^{\\xi_j + 1/2} (A\\xi^2 + B\\xi + C) d\\xi = \\left[ \\frac{A}{3}\\xi^3 + \\frac{B}{2}\\xi^2 + C\\xi \\right]_{\\xi_j - 1/2}^{\\xi_j + 1/2} $$\n$$ = \\frac{A}{3}((\\xi_j+\\frac{1}{2})^3 - (\\xi_j-\\frac{1}{2})^3) + \\frac{B}{2}((\\xi_j+\\frac{1}{2})^2 - (\\xi_j-\\frac{1}{2})^2) + C((\\xi_j+\\frac{1}{2}) - (\\xi_j-\\frac{1}{2})) $$\n$$ = \\frac{A}{3}(3\\xi_j^2 + \\frac{1}{4}) + \\frac{B}{2}(2\\xi_j) + C(1) = A\\left(\\xi_j^2 + \\frac{1}{12}\\right) + B\\xi_j + C $$\nSo, for any cell $j$ with center at $\\xi_j = j-i$, the cell average is related to the polynomial coefficients by $\\bar{f}_j = A(\\xi_j^2 + \\frac{1}{12}) + B\\xi_j + C$.\n\nWe now apply this to each of the three stencils.\n\n**Stencil $S_0 = \\{i-2, i-1, i\\}$**\n\nThe polynomial is $p^{(0)}(\\xi) = A_0\\xi^2 + B_0\\xi + C_0$. The cells are centered at $\\xi_{i-2}=-2$, $\\xi_{i-1}=-1$, and $\\xi_i=0$. The system of equations is:\n$$ \\bar{f}_{i-2} = A_0((-2)^2 + \\frac{1}{12}) + B_0(-2) + C_0 = \\frac{49}{12}A_0 - 2B_0 + C_0 $$\n$$ \\bar{f}_{i-1} = A_0((-1)^2 + \\frac{1}{12}) + B_0(-1) + C_0 = \\frac{13}{12}A_0 - B_0 + C_0 $$\n$$ \\bar{f}_{i}   = A_0((0)^2 + \\frac{1}{12}) + B_0(0) + C_0   = \\frac{1}{12}A_0 + C_0 $$\nSubtracting consecutive equations yields:\n$$ \\bar{f}_{i-1} - \\bar{f}_{i} = A_0 - B_0 $$\n$$ \\bar{f}_{i-2} - \\bar{f}_{i-1} = 3A_0 - B_0 $$\nSubtracting these two difference equations gives:\n$$ (\\bar{f}_{i-2} - \\bar{f}_{i-1}) - (\\bar{f}_{i-1} - \\bar{f}_{i}) = 2A_0 \\implies A_0 = \\frac{1}{2}(\\bar{f}_{i-2} - 2\\bar{f}_{i-1} + \\bar{f}_{i}) $$\nFrom this, we find $B_0 = A_0 - (\\bar{f}_{i-1} - \\bar{f}_{i}) = \\frac{1}{2}\\bar{f}_{i-2} - 2\\bar{f}_{i-1} + \\frac{3}{2}\\bar{f}_{i}$.\nAnd from the third original equation, $C_0 = \\bar{f}_{i} - \\frac{1}{12}A_0 = \\bar{f}_{i} - \\frac{1}{24}(\\bar{f}_{i-2} - 2\\bar{f}_{i-1} + \\bar{f}_{i}) = -\\frac{1}{24}\\bar{f}_{i-2} + \\frac{1}{12}\\bar{f}_{i-1} + \\frac{23}{24}\\bar{f}_{i}$.\n\nThe candidate interface value is $q_0 = p^{(0)}(\\xi=1/2)$:\n$$ q_0 = A_0(\\frac{1}{2})^2 + B_0(\\frac{1}{2}) + C_0 = \\frac{1}{4}A_0 + \\frac{1}{2}B_0 + C_0 $$\nSubstituting the expressions for $A_0$, $B_0$, and $C_0$:\n$$ q_0 = \\frac{1}{4}\\left(\\frac{1}{2}(\\bar{f}_{i-2} - 2\\bar{f}_{i-1} + \\bar{f}_{i})\\right) + \\frac{1}{2}\\left(\\frac{1}{2}\\bar{f}_{i-2} - 2\\bar{f}_{i-1} + \\frac{3}{2}\\bar{f}_{i}\\right) + \\left(-\\frac{1}{24}\\bar{f}_{i-2} + \\frac{1}{12}\\bar{f}_{i-1} + \\frac{23}{24}\\bar{f}_{i}\\right) $$\nCollecting coefficients for each $\\bar{f}_j$:\n$$ q_0 = \\bar{f}_{i-2}\\left(\\frac{1}{8} + \\frac{1}{4} - \\frac{1}{24}\\right) + \\bar{f}_{i-1}\\left(-\\frac{2}{8} - 1 + \\frac{2}{24}\\right) + \\bar{f}_{i}\\left(\\frac{1}{8} + \\frac{3}{4} + \\frac{23}{24}\\right) $$\n$$ q_0 = \\bar{f}_{i-2}\\left(\\frac{3+6-1}{24}\\right) + \\bar{f}_{i-1}\\left(\\frac{-6-24+2}{24}\\right) + \\bar{f}_{i}\\left(\\frac{3+18+23}{24}\\right) $$\n$$ q_0 = \\frac{8}{24}\\bar{f}_{i-2} - \\frac{28}{24}\\bar{f}_{i-1} + \\frac{44}{24}\\bar{f}_{i} = \\frac{1}{3}\\bar{f}_{i-2} - \\frac{7}{6}\\bar{f}_{i-1} + \\frac{11}{6}\\bar{f}_{i} $$\nThus, $(c_{0,-2}, c_{0,-1}, c_{0,0}) = (\\frac{1}{3}, -\\frac{7}{6}, \\frac{11}{6})$.\n\n**Stencil $S_1 = \\{i-1, i, i+1\\}$**\n\nThe polynomial is $p^{(1)}(\\xi) = A_1\\xi^2 + B_1\\xi + C_1$. The cells are centered at $\\xi_{i-1}=-1$, $\\xi_i=0$, and $\\xi_{i+1}=1$. The system of equations is:\n$$ \\bar{f}_{i-1} = A_1((-1)^2 + \\frac{1}{12}) + B_1(-1) + C_1 = \\frac{13}{12}A_1 - B_1 + C_1 $$\n$$ \\bar{f}_{i}   = A_1((0)^2 + \\frac{1}{12}) + B_1(0) + C_1   = \\frac{1}{12}A_1 + C_1 $$\n$$ \\bar{f}_{i+1} = A_1((1)^2 + \\frac{1}{12}) + B_1(1) + C_1   = \\frac{13}{12}A_1 + B_1 + C_1 $$\nAdding and subtracting the first and third equations gives:\n$$ \\bar{f}_{i+1} - \\bar{f}_{i-1} = 2B_1 \\implies B_1 = \\frac{1}{2}(\\bar{f}_{i+1} - \\bar{f}_{i-1}) $$\n$$ \\bar{f}_{i+1} + \\bar{f}_{i-1} = 2(\\frac{13}{12}A_1 + C_1) $$\nSubstituting $C_1 = \\bar{f}_{i} - \\frac{1}{12}A_1$ into the sum:\n$$ \\bar{f}_{i+1} + \\bar{f}_{i-1} = 2(\\frac{13}{12}A_1 + \\bar{f}_{i} - \\frac{1}{12}A_1) = 2(A_1 + \\bar{f}_{i}) = 2A_1 + 2\\bar{f}_{i} $$\n$$ \\implies A_1 = \\frac{1}{2}(\\bar{f}_{i-1} - 2\\bar{f}_{i} + \\bar{f}_{i+1}) $$\nThe candidate interface value is $q_1 = p^{(1)}(1/2) = \\frac{1}{4}A_1 + \\frac{1}{2}B_1 + C_1$. Substituting $C_1=\\bar{f}_i - \\frac{1}{12}A_1$:\n$$ q_1 = \\frac{1}{4}A_1 + \\frac{1}{2}B_1 + \\bar{f}_i - \\frac{1}{12}A_1 = \\frac{1}{6}A_1 + \\frac{1}{2}B_1 + \\bar{f}_i $$\nSubstituting the expressions for $A_1$ and $B_1$:\n$$ q_1 = \\frac{1}{6}\\left(\\frac{1}{2}(\\bar{f}_{i-1} - 2\\bar{f}_{i} + \\bar{f}_{i+1})\\right) + \\frac{1}{2}\\left(\\frac{1}{2}(\\bar{f}_{i+1} - \\bar{f}_{i-1})\\right) + \\bar{f}_i $$\n$$ q_1 = \\bar{f}_{i-1}\\left(\\frac{1}{12} - \\frac{1}{4}\\right) + \\bar{f}_{i}\\left(-\\frac{2}{12} + 1\\right) + \\bar{f}_{i+1}\\left(\\frac{1}{12} + \\frac{1}{4}\\right) $$\n$$ q_1 = -\\frac{2}{12}\\bar{f}_{i-1} + \\frac{10}{12}\\bar{f}_{i} + \\frac{4}{12}\\bar{f}_{i+1} = -\\frac{1}{6}\\bar{f}_{i-1} + \\frac{5}{6}\\bar{f}_{i} + \\frac{1}{3}\\bar{f}_{i+1} $$\nThus, $(c_{1,-1}, c_{1,0}, c_{1,1}) = (-\\frac{1}{6}, \\frac{5}{6}, \\frac{1}{3})$.\n\n**Stencil $S_2 = \\{i, i+1, i+2\\}$**\n\nThe polynomial is $p^{(2)}(\\xi) = A_2\\xi^2 + B_2\\xi + C_2$. The cells are centered at $\\xi_i=0$, $\\xi_{i+1}=1$, and $\\xi_{i+2}=2$. A direct derivation is performed. The system of equations is:\n$$ \\bar{f}_{i}   = A_2((0)^2 + \\frac{1}{12}) + B_2(0) + C_2   = \\frac{1}{12}A_2 + C_2 $$\n$$ \\bar{f}_{i+1} = A_2((1)^2 + \\frac{1}{12}) + B_2(1) + C_2 = \\frac{13}{12}A_2 + B_2 + C_2 $$\n$$ \\bar{f}_{i+2} = A_2((2)^2 + \\frac{1}{12}) + B_2(2) + C_2 = \\frac{49}{12}A_2 + 2B_2 + C_2 $$\nSubtracting consecutive equations yields:\n$$ \\bar{f}_{i+1} - \\bar{f}_{i} = A_2 + B_2 $$\n$$ \\bar{f}_{i+2} - \\bar{f}_{i+1} = 3A_2 + B_2 $$\nSubtracting these two difference equations gives:\n$$ (\\bar{f}_{i+2} - \\bar{f}_{i+1}) - (\\bar{f}_{i+1} - \\bar{f}_{i}) = 2A_2 \\implies A_2 = \\frac{1}{2}(\\bar{f}_{i} - 2\\bar{f}_{i+1} + \\bar{f}_{i+2}) $$\nFrom this, we find $B_2 = (\\bar{f}_{i+1} - \\bar{f}_{i}) - A_2 = (\\bar{f}_{i+1} - \\bar{f}_{i}) - \\frac{1}{2}(\\bar{f}_{i} - 2\\bar{f}_{i+1} + \\bar{f}_{i+2}) = -\\frac{3}{2}\\bar{f}_i + 2\\bar{f}_{i+1} - \\frac{1}{2}\\bar{f}_{i+2}$.\n\nThe candidate interface value is $q_2 = p^{(2)}(1/2)$. We can express this efficiently using $C_2 = \\bar{f}_i - \\frac{1}{12}A_2$:\n$$ q_2 = A_2(\\frac{1}{2})^2 + B_2(\\frac{1}{2}) + C_2 = \\frac{1}{4}A_2 + \\frac{1}{2}B_2 + \\bar{f}_i - \\frac{1}{12}A_2 = \\frac{1}{6}A_2 + \\frac{1}{2}B_2 + \\bar{f}_i $$\nSubstituting the expressions for $A_2$ and $B_2$:\n$$ q_2 = \\frac{1}{6}\\left(\\frac{1}{2}(\\bar{f}_i - 2\\bar{f}_{i+1} + \\bar{f}_{i+2})\\right) + \\frac{1}{2}\\left(-\\frac{3}{2}\\bar{f}_i + 2\\bar{f}_{i+1} - \\frac{1}{2}\\bar{f}_{i+2}\\right) + \\bar{f}_i $$\nCollecting coefficients for each $\\bar{f}_j$:\n$$ q_2 = \\bar{f}_i\\left(\\frac{1}{12} - \\frac{3}{4} + 1\\right) + \\bar{f}_{i+1}\\left(-\\frac{2}{12} + 1\\right) + \\bar{f}_{i+2}\\left(\\frac{1}{12} - \\frac{1}{4}\\right) $$\n$$ q_2 = \\bar{f}_i\\left(\\frac{1-9+12}{12}\\right) + \\bar{f}_{i+1}\\left(\\frac{-2+12}{12}\\right) + \\bar{f}_{i+2}\\left(\\frac{1-3}{12}\\right) $$\n$$ q_2 = \\frac{4}{12}\\bar{f}_i + \\frac{10}{12}\\bar{f}_{i+1} - \\frac{2}{12}\\bar{f}_{i+2} = \\frac{1}{3}\\bar{f}_i + \\frac{5}{6}\\bar{f}_{i+1} - \\frac{1}{6}\\bar{f}_{i+2} $$\nThus, $(c_{2,0}, c_{2,1}, c_{2,2}) = (\\frac{1}{3}, \\frac{5}{6}, -\\frac{1}{6})$.\n\nIn summary, the nine coefficients are:\nFor $q_0$: $(c_{0,-2}, c_{0,-1}, c_{0,0}) = (\\frac{1}{3}, -\\frac{7}{6}, \\frac{11}{6})$\nFor $q_1$: $(c_{1,-1}, c_{1,0}, c_{1,1}) = (-\\frac{1}{6}, \\frac{5}{6}, \\frac{1}{3})$\nFor $q_2$: $(c_{2,0}, c_{2,1}, c_{2,2}) = (\\frac{1}{3}, \\frac{5}{6}, -\\frac{1}{6})$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{3} & -\\frac{7}{6} & \\frac{11}{6} & -\\frac{1}{6} & \\frac{5}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{5}{6} & -\\frac{1}{6} \\end{pmatrix} } $$"
        },
        {
            "introduction": "While powerful, the original WENO-JS scheme can suffer from a loss of accuracy at critical points where derivatives of the solution vanish. This advanced practice explores this subtle but important phenomenon by comparing the behavior of WENO-JS with an improved variant, WENO-Z. By calculating the nonlinear weights for both schemes under these specific conditions, you will see firsthand how modifications to the weight calculation can restore the optimal order of accuracy and improve the scheme's robustness .",
            "id": "3957225",
            "problem": "Consider a one-dimensional uniform grid with spacing $\\Delta x$ and nodes $x_{i+k} = x_i + k \\Delta x$ for integers $k$. Let $u(x)$ be a smooth scalar field to be reconstructed at the cell interface $x_{i+1/2}$ using a fifth-order Weighted Essentially Non-Oscillatory (WENO) finite-difference formulation built from three three-point candidate stencils $\\mathcal{S}_0 = \\{x_{i-2}, x_{i-1}, x_i\\}$, $\\mathcal{S}_1 = \\{x_{i-1}, x_i, x_{i+1}\\}$, and $\\mathcal{S}_2 = \\{x_i, x_{i+1}, x_{i+2}\\}$. For each stencil $\\mathcal{S}_k$, the smoothness indicator $\\beta_k$ is defined by the well-tested Jiang–Shu (JS) measures\n$$\n\\beta_0 = \\frac{13}{12}\\left(u_{i-2} - 2 u_{i-1} + u_{i}\\right)^{2} + \\frac{1}{4}\\left(u_{i-2} - 4 u_{i-1} + 3 u_{i}\\right)^{2},\n$$\n$$\n\\beta_1 = \\frac{13}{12}\\left(u_{i-1} - 2 u_{i} + u_{i+1}\\right)^{2} + \\frac{1}{4}\\left(u_{i-1} - u_{i+1}\\right)^{2},\n$$\n$$\n\\beta_2 = \\frac{13}{12}\\left(u_{i} - 2 u_{i+1} + u_{i+2}\\right)^{2} + \\frac{1}{4}\\left(3 u_{i} - 4 u_{i+1} + u_{i+2}\\right)^{2},\n$$\nwhere $u_{i+k} = u(x_{i+k})$. The optimal linear weights for the fifth-order finite-difference reconstruction at $x_{i+1/2}$ are $d_0 = \\frac{1}{10}$, $d_1 = \\frac{6}{10}$, and $d_2 = \\frac{3}{10}$. The JS nonlinear weights are defined by the well-tested rule with exponent $p = 2$ and $\\epsilon = 0$,\n$$\n\\alpha_k^{\\mathrm{JS}} = \\frac{d_k}{\\beta_k^{p}}, \\quad w_k^{\\mathrm{JS}} = \\frac{\\alpha_k^{\\mathrm{JS}}}{\\alpha_0^{\\mathrm{JS}} + \\alpha_1^{\\mathrm{JS}} + \\alpha_2^{\\mathrm{JS}}},\n$$\nand the improved WENO-Z weights use the nonlinearity measure $\\tau_{5} = |\\beta_0 - \\beta_2|$,\n$$\n\\alpha_k^{\\mathrm{Z}} = d_k \\left( 1 + \\left( \\frac{\\tau_{5}}{\\beta_k + \\epsilon} \\right)^{2} \\right), \\quad w_k^{\\mathrm{Z}} = \\frac{\\alpha_k^{\\mathrm{Z}}}{\\alpha_0^{\\mathrm{Z}} + \\alpha_1^{\\mathrm{Z}} + \\alpha_2^{\\mathrm{Z}}},\n$$\nwith the same choice $\\epsilon = 0$ and exponent $2$ in the WENO-Z correction.\n\nAssume a smooth cubic $u(x) = a x^{3} + b x^{2} + c x + d$ and enforce the critical-point condition $u'(x_i) = 0$ at $x_i$ by taking $x_i = 0$ and $c = 0$. To highlight the reduced-order degradation mechanism of Jiang–Shu WENO at higher-order critical points, consider the special case $b = 0$ so that $u(x) = a x^{3} + d$ near $x_i = 0$. Using only the definitions above and uniform-grid algebra, compute the three JS weights $w_0^{\\mathrm{JS}}, w_1^{\\mathrm{JS}}, w_2^{\\mathrm{JS}}$ and the three Z weights $w_0^{\\mathrm{Z}}, w_1^{\\mathrm{Z}}, w_2^{\\mathrm{Z}}$ at $x_{i+1/2}$. Express the final answer as exact fractions in a single row matrix containing the six weights in the order $\\left(w_0^{\\mathrm{JS}}, w_1^{\\mathrm{JS}}, w_2^{\\mathrm{JS}}, w_0^{\\mathrm{Z}}, w_1^{\\mathrm{Z}}, w_2^{\\mathrm{Z}}\\right)$. No rounding is required.",
            "solution": "The problem requires the computation of the fifth-order Jiang-Shu (JS) and WENO-Z (Z) nonlinear weights for a specific smooth function at a higher-order critical point. The validation of the problem statement confirms its scientific soundness, consistency, and completeness. We may therefore proceed with the solution.\n\nThe analysis is centered at the grid point $x_i$, which is set to $0$ without loss of generality. The grid is uniform with spacing $\\Delta x$, so the node coordinates are $x_{i+k} = (i+k-i) \\Delta x = k \\Delta x$. The function under consideration is $u(x) = a x^3 + d$, which satisfies the specified conditions $u'(x_i) = u'(0) = 0$ and $u''(x_i)=u''(0)=0$. The value of the function at a grid node $x_{j}$ is denoted by $u_j = u(x_j)$. Thus, for the relevant stencils, the function values are:\n$$\nu_{i+k} = u(k \\Delta x) = a (k \\Delta x)^3 + d\n$$\nWe will first compute the smoothness indicators $\\beta_k$ for $k \\in \\{0, 1, 2\\}$. To simplify the algebra, let $C = a (\\Delta x)^3$. The relevant terms within the $\\beta_k$ definitions can be expressed using $C$.\n\nFor the first stencil $\\mathcal{S}_0 = \\{x_{i-2}, x_{i-1}, x_i\\}$, we evaluate the two finite-difference terms in $\\beta_0$.\nThe point values are:\n$u_i = u(0) = d$\n$u_{i-1} = u(-\\Delta x) = a(-\\Delta x)^3 + d = -C + d$\n$u_{i-2} = u(-2\\Delta x) = a(-2\\Delta x)^3 + d = -8C + d$\n\nThe first term in $\\beta_0$ is a scaled second difference:\n$$\nu_{i-2} - 2 u_{i-1} + u_{i} = (-8C + d) - 2(-C + d) + d = -8C + 2C + d - 2d + d = -6C\n$$\nThe second term in $\\beta_0$ is a scaled first difference:\n$$\nu_{i-2} - 4 u_{i-1} + 3 u_{i} = (-8C + d) - 4(-C + d) + 3d = -8C + 4C + d - 4d + 3d = -4C\n$$\nSubstituting these into the definition of $\\beta_0$:\n$$\n\\beta_0 = \\frac{13}{12}(-6C)^2 + \\frac{1}{4}(-4C)^2 = \\frac{13}{12}(36 C^2) + \\frac{1}{4}(16 C^2) = (13 \\times 3)C^2 + 4C^2 = (39+4)C^2 = 43 C^2\n$$\n\nFor the second stencil $\\mathcal{S}_1 = \\{x_{i-1}, x_i, x_{i+1}\\}$, we need the value at $x_{i+1}$:\n$u_{i+1} = u(\\Delta x) = a(\\Delta x)^3 + d = C + d$\nThe first term in $\\beta_1$ is:\n$$\nu_{i-1} - 2 u_i + u_{i+1} = (-C + d) - 2d + (C+d) = 0\n$$\nThe second term in $\\beta_1$ is:\n$$\nu_{i-1} - u_{i+1} = (-C+d) - (C+d) = -2C\n$$\nSubstituting these into the definition of $\\beta_1$:\n$$\n\\beta_1 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(-2C)^2 = \\frac{1}{4}(4 C^2) = C^2\n$$\n\nFor the third stencil $\\mathcal{S}_2 = \\{x_i, x_{i+1}, x_{i+2}\\}$, we need the value at $x_{i+2}$:\n$u_{i+2} = u(2\\Delta x) = a(2\\Delta x)^3 + d = 8C + d$\nThe first term in $\\beta_2$ is:\n$$\nu_i - 2 u_{i+1} + u_{i+2} = d - 2(C+d) + (8C+d) = -2C + 8C + d - 2d + d = 6C\n$$\nThe second term in $\\beta_2$ is:\n$$\n3u_i - 4u_{i+1} + u_{i+2} = 3d - 4(C+d) + (8C+d) = -4C + 8C + 3d - 4d + d = 4C\n$$\nSubstituting these into the definition of $\\beta_2$:\n$$\n\\beta_2 = \\frac{13}{12}(6C)^2 + \\frac{1}{4}(4C)^2 = \\frac{13}{12}(36 C^2) + \\frac{1}{4}(16 C^2) = (13 \\times 3)C^2 + 4C^2 = 43 C^2\n$$\nIn summary, assuming $C \\neq 0$ (i.e., $a \\neq 0$), the smoothness indicators are:\n$\\beta_0 = 43 C^2$, $\\beta_1 = C^2$, $\\beta_2 = 43 C^2$.\n\nNow, we compute the Jiang-Shu (JS) weights. The formula for the unnormalized weights is $\\alpha_k^{\\mathrm{JS}} = d_k / \\beta_k^p$ with $p=2$ and $\\epsilon=0$.\n$$\n\\alpha_0^{\\mathrm{JS}} = \\frac{d_0}{\\beta_0^2} = \\frac{1/10}{(43 C^2)^2} = \\frac{1}{10 \\cdot 43^2 C^4} = \\frac{1}{18490 C^4}\n$$\n$$\n\\alpha_1^{\\mathrm{JS}} = \\frac{d_1}{\\beta_1^2} = \\frac{6/10}{(C^2)^2} = \\frac{6}{10 C^4}\n$$\n$$\n\\alpha_2^{\\mathrm{JS}} = \\frac{d_2}{\\beta_2^2} = \\frac{3/10}{(43 C^2)^2} = \\frac{3}{10 \\cdot 43^2 C^4} = \\frac{3}{18490 C^4}\n$$\nThe normalized weights $w_k^{\\mathrm{JS}}$ are found by dividing by the sum $\\sum_{j=0}^{2} \\alpha_j^{\\mathrm{JS}}$. The common factor $1/C^4$ cancels out. The weights are proportional to the numerators of the $\\alpha_k^{\\mathrm{JS}}$ values, scaled to a common base:\n$\\alpha_0^{\\mathrm{JS}} \\propto \\frac{1}{18490}$\n$\\alpha_1^{\\mathrm{JS}} \\propto \\frac{6}{10} = \\frac{6 \\cdot 1849}{10 \\cdot 1849} = \\frac{11094}{18490}$\n$\\alpha_2^{\\mathrm{JS}} \\propto \\frac{3}{18490}$\nThe sum of these proportional parts is $S = \\frac{1+11094+3}{18490} = \\frac{11098}{18490}$.\nThe JS weights are:\n$$\nw_0^{\\mathrm{JS}} = \\frac{1/18490}{11098/18490} = \\frac{1}{11098}\n$$\n$$\nw_1^{\\mathrm{JS}} = \\frac{11094/18490}{11098/18490} = \\frac{11094}{11098} = \\frac{5547}{5549}\n$$\n$$\nw_2^{\\mathrm{JS}} = \\frac{3/18490}{11098/18490} = \\frac{3}{11098}\n$$\n\nNext, we compute the WENO-Z weights. First, we find the nonlinearity measure $\\tau_5$:\n$$\n\\tau_5 = |\\beta_0 - \\beta_2| = |43 C^2 - 43 C^2| = 0\n$$\nThe unnormalized WENO-Z weights are given by $\\alpha_k^{\\mathrm{Z}} = d_k \\left( 1 + \\left( \\frac{\\tau_5}{\\beta_k + \\epsilon} \\right)^2 \\right)$ with $\\epsilon=0$.\nSince $\\tau_5 = 0$ and all $\\beta_k \\neq 0$, the correction term $\\left( \\frac{\\tau_5}{\\beta_k} \\right)^2$ is zero for all $k$.\nTherefore, $\\alpha_k^{\\mathrm{Z}}$ reduces to the optimal linear weight $d_k$.\n$$\n\\alpha_0^{\\mathrm{Z}} = d_0 \\left( 1 + 0 \\right) = d_0 = \\frac{1}{10}\n$$\n$$\n\\alpha_1^{\\mathrm{Z}} = d_1 \\left( 1 + 0 \\right) = d_1 = \\frac{6}{10}\n$$\n$$\n\\alpha_2^{\\mathrm{Z}} = d_2 \\left( 1 + 0 \\right) = d_2 = \\frac{3}{10}\n$$\nThe sum of the unnormalized weights is $\\sum_{j=0}^{2} \\alpha_j^{\\mathrm{Z}} = d_0+d_1+d_2 = \\frac{1}{10} + \\frac{6}{10} + \\frac{3}{10} = \\frac{10}{10} = 1$.\nThe normalized WENO-Z weights are then:\n$$\nw_k^{\\mathrm{Z}} = \\frac{\\alpha_k^{\\mathrm{Z}}}{\\sum_{j=0}^{2} \\alpha_j^{\\mathrm{Z}}} = \\frac{\\alpha_k^{\\mathrm{Z}}}{1} = \\alpha_k^{\\mathrm{Z}}\n$$\n$$\nw_0^{\\mathrm{Z}} = \\frac{1}{10}\n$$\n$$\nw_1^{\\mathrm{Z}} = \\frac{6}{10} = \\frac{3}{5}\n$$\n$$\nw_2^{\\mathrm{Z}} = \\frac{3}{10}\n$$\nThis demonstrates that the WENO-Z formulation recovers the optimal fifth-order accuracy at this type of critical point, whereas the original JS formulation does not.\n\nThe final six weights are assembled in the specified order.\n$w_0^{\\mathrm{JS}} = \\frac{1}{11098}$\n$w_1^{\\mathrm{JS}} = \\frac{5547}{5549}$\n$w_2^{\\mathrm{JS}} = \\frac{3}{11098}$\n$w_0^{\\mathrm{Z}} = \\frac{1}{10}$\n$w_1^{\\mathrm{Z}} = \\frac{3}{5}$\n$w_2^{\\mathrm{Z}} = \\frac{3}{10}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{11098} & \\frac{5547}{5549} & \\frac{3}{11098} & \\frac{1}{10} & \\frac{3}{5} & \\frac{3}{10}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}