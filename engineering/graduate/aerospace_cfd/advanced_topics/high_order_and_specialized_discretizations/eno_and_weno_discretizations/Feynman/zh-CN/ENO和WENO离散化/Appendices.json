{
    "hands_on_practices": [
        {
            "introduction": "高阶数值格式在捕捉激波和接触间断等尖锐梯度时，往往会引入非物理的数值振荡。本质无振荡（ENO）格式通过自适应地选择包含最平滑解的模板来解决这一核心挑战。本练习  将引导您手动执行 ENO 格式的模板选择过程，通过计算和比较分裂差商来识别并避开解中的不连续性，从而为理解现代激波捕捉格式的智能特性打下坚实的直观基础。",
            "id": "3957182",
            "problem": "在航空航天计算流体动力学中，网格界面处的高分辨率重构被用于计算双曲守恒律的数值通量。考虑一个间距为 $\\Delta x = 1$ 的均匀一维网格，其节点为 $x_{j} = j$，其中 $j$ 为整数。给定五个索引为 $j \\in \\{-2,-1,0,1,2\\}$ 的连续节点上的逐点解值 $u_{j}$：\n- $u_{-2} = -0.909297$，\n- $u_{-1} = -0.841471$，\n- $u_{0} = 0.000000$，\n- $u_{1} = 3.100000$，\n- $u_{2} = 3.300000$。\n\n假设特征波速为正，因此在 $i=0$ 处的界面 $x_{i+1/2}$ 进行左偏重构是合适的。从多项式插值和 Newton 均差的基本定义出发，通过以下步骤在界面 $x_{1/2} = 0.5$ 处构造三阶本质无振荡 (ENO) 多项式：\n1. 枚举所有可用于在 $x_{1/2}$ 处为左偏值重构二次多项式的三点候选模板，\n2. 计算均匀网格上每个候选模板对应的二阶均差，\n3. 根据 ENO 原则选择能最大化局部光滑性的模板，\n4. 在所选模板上构造唯一的二次插值多项式，并在 $x_{1/2}$ 处对其求值。\n\n将重构的界面值 $u^{-}_{1/2}$ 报告为一个四舍五入到六位有效数字的实数。无需单位。同时，根据你的二阶均差计算，解释所选模板如何最大化局部光滑性。",
            "solution": "该问题要求在网格界面 $x_{1/2} = 0.5$ 处为一个记作 $u^{-}_{1/2}$ 的左偏值构造一个三阶本质无振荡 (ENO) 重构。该过程基于多项式插值，使用从给定数据中选择的点构成的模板来最大化局部光滑性。一个三阶精度的格式使用二次插值多项式，这需要一个包含3个点的模板。整个过程按指定的四个独立步骤展开。\n\n给定数据为间距 $\\Delta x = 1$ 的均匀网格上节点 $x_j = j$ 处的点值 $u_j$：\n- $u_{-2} = -0.909297$\n- $u_{-1} = -0.841471$\n- $u_{0} = 0.000000$\n- $u_{1} = 3.100000$\n- $u_{2} = 3.300000$\n\n**1. 候选模板的枚举**\n\n对于在 $i=0$ 处的界面 $x_{i+1/2}$（即 $x_{1/2}$）进行的三阶重构，我们需要寻找一个二次多项式（2次）。这样的多项式由3个点唯一确定。候选模板是通过在目标网格 $i=0$ 周围移动一个3点窗口形成的。由于特征波速为正，需要进行左偏重构，这意味着模板优先选择在界面的左侧。在 $x_{1/2}$ 处进行重构的标准候选模板集 $S_k$ 为：\n- $S_0 = \\{x_0, x_1, x_2\\}$，对应索引 $\\{0, 1, 2\\}$。\n- $S_1 = \\{x_{-1}, x_0, x_1\\}$，对应索引 $\\{-1, 0, 1\\}$。\n- $S_2 = \\{x_{-2}, x_{-1}, x_0\\}$，对应索引 $\\{-2, -1, 0\\}$。\n\n**2. 二阶均差的计算**\n\nENO 算法通过比较最高阶均差的大小来选择“最光滑”的模板。对于二次多项式，这对应于二阶均差。\n在 $\\Delta x=1$ 的均匀网格上，一阶均差为 $u[x_j, x_{j+1}] = \\frac{u_{j+1} - u_j}{x_{j+1}-x_j} = u_{j+1} - u_j$。\n二阶均差为 $u[x_j, x_{j+1}, x_{j+2}] = \\frac{u[x_{j+1}, x_{j+2}] - u[x_j, x_{j+1}]}{x_{j+2}-x_j} = \\frac{(u_{j+2}-u_{j+1}) - (u_{j+1}-u_j)}{2}$。\n\n首先，我们计算所需的一阶均差：\n- $u[x_{-2}, x_{-1}] = u_{-1} - u_{-2} = -0.841471 - (-0.909297) = 0.067826$\n- $u[x_{-1}, x_0] = u_0 - u_{-1} = 0.000000 - (-0.841471) = 0.841471$\n- $u[x_0, x_1] = u_1 - u_0 = 3.100000 - 0.000000 = 3.100000$\n- $u[x_1, x_2] = u_2 - u_1 = 3.300000 - 3.100000 = 0.200000$\n\n接下来，我们计算每个候选模板的二阶均差：\n- 对于 $S_0 = \\{0, 1, 2\\}$：\n$u[x_0, x_1, x_2] = \\frac{u[x_1, x_2] - u[x_0, x_1]}{x_2 - x_0} = \\frac{0.200000 - 3.100000}{2} = -1.450000$\n- 对于 $S_1 = \\{-1, 0, 1\\}$：\n$u[x_{-1}, x_0, x_1] = \\frac{u[x_0, x_1] - u[x_{-1}, x_0]}{x_1 - x_{-1}} = \\frac{3.100000 - 0.841471}{2} = 1.1292645$\n- 对于 $S_2 = \\{-2, -1, 0\\}$：\n$u[x_{-2}, x_{-1}, x_0] = \\frac{u[x_{-1}, x_0] - u[x_{-2}, x_{-1}]}{x_0 - x_{-2}} = \\frac{0.841471 - 0.067826}{2} = 0.3868225$\n\n**3. 基于 ENO 原则的模板选择**\n\nENO 原则要求选择对应于具有最小振荡的插值多项式的模板。这是通过选择具有最小绝对值的最高阶均差的模板来实现的。我们比较二阶均差的大小：\n- 对于 $S_0$：$|u[x_0, x_1, x_2]| = |-1.450000| = 1.450000$\n- 对于 $S_1$：$|u[x_{-1}, x_0, x_1]| = |1.1292645| = 1.1292645$\n- 对于 $S_2$：$|u[x_{-2}, x_{-1}, x_0]| = |0.3868225| = 0.3868225$\n\n最小量值为 $0.3868225$，对应于模板 $S_2 = \\{-2, -1, 0\\}$。\n该模板最大化了局部光滑性，因为二阶均差是底层函数的二阶导数的近似。通过选择具有最小量值二阶均差的模板，我们选择了可以被“最平坦”或曲率最小的二次多项式拟合的数据集。模板 $S_1$ 和 $S_0$ 的大量值表明在模板点 $\\{0\\}$ 和 $\\{1\\}$ 之间的数据中存在陡峭梯度或间断，而 ENO 算法正确地避免了跨越此特征进行插值。\n\n**4. 插值多项式的构造与求值**\n\n我们构造唯一的二次多项式 $P(x)$，它对所选模板 $S_2=\\{-2,-1,0\\}$ 上的数据点 $(x_{-2}, u_{-2})$、$(x_{-1}, u_{-1})$ 和 $(x_0, u_0)$ 进行插值。插值多项式的 Newton 形式是最直接的方法。对于点集 $\\{x_{-2}, x_{-1}, x_0\\}$，多项式为：\n$$P(x) = u[x_{-2}] + u[x_{-2}, x_{-1}](x-x_{-2}) + u[x_{-2}, x_{-1}, x_0](x-x_{-2})(x-x_{-1})$$\n代入数值：\n- $u[x_{-2}] = u_{-2} = -0.909297$\n- $u[x_{-2}, x_{-1}] = 0.067826$\n- $u[x_{-2}, x_{-1}, x_0] = 0.3868225$\n- $x_{-2} = -2$, $x_{-1} = -1$\n\n多项式为：\n$$P(x) = -0.909297 + 0.067826(x - (-2)) + 0.3868225(x - (-2))(x - (-1))$$\n$$P(x) = -0.909297 + 0.067826(x+2) + 0.3868225(x+2)(x+1)$$\n我们在界面位置 $x = x_{1/2} = 0.5$ 处对该多项式求值，以找到重构值 $u^{-}_{1/2}$：\n$$u^{-}_{1/2} = P(0.5) = -0.909297 + 0.067826(0.5+2) + 0.3868225(0.5+2)(0.5+1)$$\n$$u^{-}_{1/2} = -0.909297 + 0.067826(2.5) + 0.3868225(2.5)(1.5)$$\n$$u^{-}_{1/2} = -0.909297 + 0.169565 + 0.3868225(3.75)$$\n$$u^{-}_{1/2} = -0.909297 + 0.169565 + 1.450584375$$\n$$u^{-}_{1/2} = -0.739732 + 1.450584375 = 0.710852375$$\n问题要求答案四舍五入到六位有效数字。\n$$u^{-}_{1/2} \\approx 0.710852$$\n该值即为界面 $x_{1/2}$ 处的三阶 ENO 重构值。",
            "answer": "$$\\boxed{0.710852}$$"
        },
        {
            "introduction": "加权本质无振荡（WENO）格式是对 ENO 思想的重大改进，它用一个非线性加权组合取代了 ENO 格式中对候选模板的“硬切换”。本练习  聚焦于构建 WENO 格式的一个关键先决步骤：从单元平均值中推导候选多项式。通过亲手计算这些系数，您将深刻理解有限体积法中，离散的单元平均值如何与底层的连续多项式重构联系起来，这对于实现和分析 WENO 格式至关重要。",
            "id": "3957151",
            "problem": "考虑一维标量守恒律 $\\partial u/\\partial t + \\partial f(u)/\\partial x = 0$ 在间距为 $\\Delta x$ 的均匀网格上的情况，并用 $\\bar{f}_{i}$ 表示通量 $f(u)$ 在单元 $[x_{i-1/2}, x_{i+1/2}]$ 上的单元平均值。在由 Jiang 和 Shu 提出的五阶有限体积加权基本无振荡（WENO）重构（WENO5-JS）中，通过分别在模板 $\\{i-2,i-1,i\\}$, $\\{i-1,i,i+1\\}$ 和 $\\{i,i+1,i+2\\}$ 上构造三个二次候选多项式 $p^{(0)}(x)$, $p^{(1)}(x)$ 和 $p^{(2)}(x)$，来构建 $x_{i+1/2}$ 处的左偏界面通量。\n\n每个候选多项式 $p^{(k)}(x)$ 被定义为其模板上能重现给定单元平均值的唯一二次多项式，相应的候选界面值为 $q_{k} = p^{(k)}(x_{i+1/2})$。\n\n从单元平均值的有限体积定义以及每个二次多项式 $p^{(k)}(x)$ 需与其模板上的三个单元平均值相匹配的要求出发，推导三个候选界面值 $q_{0}$、$q_{1}$ 和 $q_{2}$ 作为 $\\bar{f}_{i-2}$、$\\bar{f}_{i-1}$、$\\bar{f}_{i}$、$\\bar{f}_{i+1}$ 和 $\\bar{f}_{i+2}$ 的显式线性组合，并计算它们精确的有理系数。将您的最终结果表示为单个行矩阵，按 $(c_{0,-2}, c_{0,-1}, c_{0,0}; c_{1,-1}, c_{1,0}, c_{1,1}; c_{2,0}, c_{2,1}, c_{2,2})$ 的顺序列出九个系数，其中 $q_{0} = c_{0,-2}\\bar{f}_{i-2} + c_{0,-1}\\bar{f}_{i-1} + c_{0,0}\\bar{f}_{i}$，$q_{1} = c_{1,-1}\\bar{f}_{i-1} + c_{1,0}\\bar{f}_{i} + c_{1,1}\\bar{f}_{i+1}$，以及 $q_{2} = c_{2,0}\\bar{f}_{i} + c_{2,1}\\bar{f}_{i+1} + c_{2,2}\\bar{f}_{i+2}$。以精确分数形式提供系数，无需四舍五入。",
            "solution": "该问题要求在五阶加权基本无振荡（WENO）有限体积格式中，推导三个候选界面通量（记为 $q_0$、$q_1$ 和 $q_2$）的系数。$x_{i+1/2}$ 处的界面通量由三个不同模板上的通量函数单元平均值 $\\bar{f}_j$ 重构得到。\n\n让我们建立一个用网格间距 $\\Delta x$ 归一化、并以单元 $i$ 的中心 $x_i$ 为原点的局部坐标系。我们定义 $\\xi = (x-x_i)/\\Delta x$。在该坐标系中，单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 对应于 $\\xi$ 中的区间 $[j-i-1/2, j-i+1/2]$。我们关心的界面 $x_{i+1/2}$ 位于 $\\xi = 1/2$ 处。\n\n基本条件是，每个候选多项式 $p^{(k)}(x)$ 必须在其各自的模板上重现通量函数 $\\bar{f}_j$ 的单元平均值。在归一化坐标系中，此条件为：\n$$ \\bar{f}_j = \\frac{1}{\\Delta x} \\int_{x_{j-1/2}}^{x_{j+1/2}} p^{(k)}(x) dx = \\int_{j-i-1/2}^{j-i+1/2} p^{(k)}(\\xi) d\\xi $$\n其中 $p^{(k)}(\\xi)$ 现在是关于 $\\xi$ 的二次多项式。让我们将一个通用的二次多项式表示为 $p(\\xi) = A\\xi^2 + B\\xi + C$。它在以 $\\xi_j = j-i$ 为中心的单元 $I_j$ 上的积分为：\n$$ \\int_{\\xi_j - 1/2}^{\\xi_j + 1/2} (A\\xi^2 + B\\xi + C) d\\xi = \\left[ \\frac{A}{3}\\xi^3 + \\frac{B}{2}\\xi^2 + C\\xi \\right]_{\\xi_j - 1/2}^{\\xi_j + 1/2} $$\n$$ = \\frac{A}{3}((\\xi_j+\\frac{1}{2})^3 - (\\xi_j-\\frac{1}{2})^3) + \\frac{B}{2}((\\xi_j+\\frac{1}{2})^2 - (\\xi_j-\\frac{1}{2})^2) + C((\\xi_j+\\frac{1}{2}) - (\\xi_j-\\frac{1}{2})) $$\n$$ = \\frac{A}{3}(3\\xi_j^2 + \\frac{1}{4}) + \\frac{B}{2}(2\\xi_j) + C(1) = A\\left(\\xi_j^2 + \\frac{1}{12}\\right) + B\\xi_j + C $$\n因此，对于中心位于 $\\xi_j = j-i$ 的任意单元 $j$，单元平均值通过 $\\bar{f}_j = A(\\xi_j^2 + \\frac{1}{12}) + B\\xi_j + C$ 与多项式系数相关联。\n\n我们现在将此应用于三个模板中的每一个。\n\n**模板 $S_0 = \\{i-2, i-1, i\\}$**\n\n多项式为 $p^{(0)}(\\xi) = A_0\\xi^2 + B_0\\xi + C_0$。单元中心位于 $\\xi_{i-2}=-2$、$\\xi_{i-1}=-1$ 和 $\\xi_i=0$。方程组为：\n$$ \\bar{f}_{i-2} = A_0((-2)^2 + \\frac{1}{12}) + B_0(-2) + C_0 = \\frac{49}{12}A_0 - 2B_0 + C_0 $$\n$$ \\bar{f}_{i-1} = A_0((-1)^2 + \\frac{1}{12}) + B_0(-1) + C_0 = \\frac{13}{12}A_0 - B_0 + C_0 $$\n$$ \\bar{f}_{i}   = A_0((0)^2 + \\frac{1}{12}) + B_0(0) + C_0   = \\frac{1}{12}A_0 + C_0 $$\n连续方程相减得到：\n$$ \\bar{f}_{i-1} - \\bar{f}_{i} = A_0 - B_0 $$\n$$ \\bar{f}_{i-2} - \\bar{f}_{i-1} = 3A_0 - B_0 $$\n这两个差分方程相减得到：\n$$ (\\bar{f}_{i-2} - \\bar{f}_{i-1}) - (\\bar{f}_{i-1} - \\bar{f}_{i}) = 2A_0 \\implies A_0 = \\frac{1}{2}(\\bar{f}_{i-2} - 2\\bar{f}_{i-1} + \\bar{f}_{i}) $$\n由此，我们求得 $B_0 = A_0 - (\\bar{f}_{i-1} - \\bar{f}_{i}) = \\frac{1}{2}\\bar{f}_{i-2} - 2\\bar{f}_{i-1} + \\frac{3}{2}\\bar{f}_{i}$。\n并从第三个原始方程中，求得 $C_0 = \\bar{f}_{i} - \\frac{1}{12}A_0 = \\bar{f}_{i} - \\frac{1}{24}(\\bar{f}_{i-2} - 2\\bar{f}_{i-1} + \\bar{f}_{i}) = -\\frac{1}{24}\\bar{f}_{i-2} + \\frac{1}{12}\\bar{f}_{i-1} + \\frac{23}{24}\\bar{f}_{i}$。\n\n候选界面值为 $q_0 = p^{(0)}(\\xi=1/2)$：\n$$ q_0 = A_0(\\frac{1}{2})^2 + B_0(\\frac{1}{2}) + C_0 = \\frac{1}{4}A_0 + \\frac{1}{2}B_0 + C_0 $$\n代入 $A_0$、$B_0$ 和 $C_0$ 的表达式：\n$$ q_0 = \\frac{1}{4}\\left(\\frac{1}{2}(\\bar{f}_{i-2} - 2\\bar{f}_{i-1} + \\bar{f}_{i})\\right) + \\frac{1}{2}\\left(\\frac{1}{2}\\bar{f}_{i-2} - 2\\bar{f}_{i-1} + \\frac{3}{2}\\bar{f}_{i}\\right) + \\left(-\\frac{1}{24}\\bar{f}_{i-2} + \\frac{1}{12}\\bar{f}_{i-1} + \\frac{23}{24}\\bar{f}_{i}\\right) $$\n合并每个 $\\bar{f}_j$ 的系数：\n$$ q_0 = \\bar{f}_{i-2}\\left(\\frac{1}{8} + \\frac{1}{4} - \\frac{1}{24}\\right) + \\bar{f}_{i-1}\\left(-\\frac{2}{8} - 1 + \\frac{2}{24}\\right) + \\bar{f}_{i}\\left(\\frac{1}{8} + \\frac{3}{4} + \\frac{23}{24}\\right) $$\n$$ q_0 = \\bar{f}_{i-2}\\left(\\frac{3+6-1}{24}\\right) + \\bar{f}_{i-1}\\left(\\frac{-6-24+2}{24}\\right) + \\bar{f}_{i}\\left(\\frac{3+18+23}{24}\\right) $$\n$$ q_0 = \\frac{8}{24}\\bar{f}_{i-2} - \\frac{28}{24}\\bar{f}_{i-1} + \\frac{44}{24}\\bar{f}_{i} = \\frac{1}{3}\\bar{f}_{i-2} - \\frac{7}{6}\\bar{f}_{i-1} + \\frac{11}{6}\\bar{f}_{i} $$\n因此，$(c_{0,-2}, c_{0,-1}, c_{0,0}) = (\\frac{1}{3}, -\\frac{7}{6}, \\frac{11}{6})$。\n\n**模板 $S_1 = \\{i-1, i, i+1\\}$**\n\n多项式为 $p^{(1)}(\\xi) = A_1\\xi^2 + B_1\\xi + C_1$。单元中心位于 $\\xi_{i-1}=-1$、$\\xi_i=0$ 和 $\\xi_{i+1}=1$。方程组为：\n$$ \\bar{f}_{i-1} = A_1((-1)^2 + \\frac{1}{12}) + B_1(-1) + C_1 = \\frac{13}{12}A_1 - B_1 + C_1 $$\n$$ \\bar{f}_{i}   = A_1((0)^2 + \\frac{1}{12}) + B_1(0) + C_1   = \\frac{1}{12}A_1 + C_1 $$\n$$ \\bar{f}_{i+1} = A_1((1)^2 + \\frac{1}{12}) + B_1(1) + C_1   = \\frac{13}{12}A_1 + B_1 + C_1 $$\n第一和第三个方程相加减得到：\n$$ \\bar{f}_{i+1} - \\bar{f}_{i-1} = 2B_1 \\implies B_1 = \\frac{1}{2}(\\bar{f}_{i+1} - \\bar{f}_{i-1}) $$\n$$ \\bar{f}_{i+1} + \\bar{f}_{i-1} = 2(\\frac{13}{12}A_1 + C_1) $$\n将 $C_1 = \\bar{f}_{i} - \\frac{1}{12}A_1$ 代入求和式：\n$$ \\bar{f}_{i+1} + \\bar{f}_{i-1} = 2(\\frac{13}{12}A_1 + \\bar{f}_{i} - \\frac{1}{12}A_1) = 2(A_1 + \\bar{f}_{i}) = 2A_1 + 2\\bar{f}_{i} $$\n$$ \\implies A_1 = \\frac{1}{2}(\\bar{f}_{i-1} - 2\\bar{f}_{i} + \\bar{f}_{i+1}) $$\n候选界面值为 $q_1 = p^{(1)}(1/2) = \\frac{1}{4}A_1 + \\frac{1}{2}B_1 + C_1$。代入 $C_1=\\bar{f}_i - \\frac{1}{12}A_1$：\n$$ q_1 = \\frac{1}{4}A_1 + \\frac{1}{2}B_1 + \\bar{f}_i - \\frac{1}{12}A_1 = \\frac{1}{6}A_1 + \\frac{1}{2}B_1 + \\bar{f}_i $$\n代入 $A_1$ 和 $B_1$ 的表达式：\n$$ q_1 = \\frac{1}{6}\\left(\\frac{1}{2}(\\bar{f}_{i-1} - 2\\bar{f}_{i} + \\bar{f}_{i+1})\\right) + \\frac{1}{2}\\left(\\frac{1}{2}(\\bar{f}_{i+1} - \\bar{f}_{i-1})\\right) + \\bar{f}_i $$\n$$ q_1 = \\bar{f}_{i-1}\\left(\\frac{1}{12} - \\frac{1}{4}\\right) + \\bar{f}_{i}\\left(-\\frac{2}{12} + 1\\right) + \\bar{f}_{i+1}\\left(\\frac{1}{12} + \\frac{1}{4}\\right) $$\n$$ q_1 = -\\frac{2}{12}\\bar{f}_{i-1} + \\frac{10}{12}\\bar{f}_{i} + \\frac{4}{12}\\bar{f}_{i+1} = -\\frac{1}{6}\\bar{f}_{i-1} + \\frac{5}{6}\\bar{f}_{i} + \\frac{1}{3}\\bar{f}_{i+1} $$\n因此，$(c_{1,-1}, c_{1,0}, c_{1,1}) = (-\\frac{1}{6}, \\frac{5}{6}, \\frac{1}{3})$。\n\n**模板 $S_2 = \\{i, i+1, i+2\\}$**\n\n多项式为 $p^{(2)}(\\xi) = A_2\\xi^2 + B_2\\xi + C_2$。单元中心位于 $\\xi_i=0$、$\\xi_{i+1}=1$ 和 $\\xi_{i+2}=2$。通过在模板 $S_0$ 的推导中将索引 $i \\to i+1$ 进行移位，我们可以推断出系数。具体来说，模板 $S_2$ 是模板 $S_0$ 的右移版本。$q_2$ 的表达式可以通过将 $q_0$ 表达式中的 $i$ 替换为 $i+1$ 并因模板相对于界面的反射而反转系数来获得。\n或者，我们可以直接进行推导。方程组为：\n$$ \\bar{f}_{i}   = \\frac{1}{12}A_2 + C_2 $$\n$$ \\bar{f}_{i+1} = \\frac{13}{12}A_2 + B_2 + C_2 $$\n$$ \\bar{f}_{i+2} = \\frac{49}{12}A_2 + 2B_2 + C_2 $$\n解此方程组得到：\n$$ A_2 = \\frac{1}{2}(\\bar{f}_{i} - 2\\bar{f}_{i+1} + \\bar{f}_{i+2}) $$\n$$ B_2 = -\\frac{3}{2}\\bar{f}_{i} + 2\\bar{f}_{i+1} - \\frac{1}{2}\\bar{f}_{i+2} $$\n$$ C_2 = \\bar{f}_{i} - \\frac{1}{12}A_2 = \\frac{23}{24}\\bar{f}_i + \\frac{2}{24}\\bar{f}_{i+1} - \\frac{1}{24}\\bar{f}_{i+2} $$\n候选界面值为 $q_2 = p^{(2)}(1/2) = \\frac{1}{4}A_2 + \\frac{1}{2}B_2 + C_2$。\n$$ q_2 = \\frac{1}{6}A_2 + \\frac{1}{2}B_2 + \\bar{f}_i $$\n代入 $A_2$ 和 $B_2$ 的表达式：\n$$ q_2 = \\frac{1}{6}\\left(\\frac{1}{2}(\\bar{f}_i - 2\\bar{f}_{i+1} + \\bar{f}_{i+2})\\right) + \\frac{1}{2}\\left(-\\frac{3}{2}\\bar{f}_i + 2\\bar{f}_{i+1} - \\frac{1}{2}\\bar{f}_{i+2}\\right) + \\bar{f}_i $$\n$$ q_2 = \\bar{f}_i\\left(\\frac{1}{12} - \\frac{3}{4} + 1\\right) + \\bar{f}_{i+1}\\left(-\\frac{2}{12} + 1\\right) + \\bar{f}_{i+2}\\left(\\frac{1}{12} - \\frac{1}{4}\\right) $$\n$$ q_2 = \\bar{f}_i\\left(\\frac{1-9+12}{12}\\right) + \\bar{f}_{i+1}\\left(\\frac{-2+12}{12}\\right) + \\bar{f}_{i+2}\\left(\\frac{1-3}{12}\\right) $$\n$$ q_2 = \\frac{4}{12}\\bar{f}_i + \\frac{10}{12}\\bar{f}_{i+1} - \\frac{2}{12}\\bar{f}_{i+2} = \\frac{1}{3}\\bar{f}_i + \\frac{5}{6}\\bar{f}_{i+1} - \\frac{1}{6}\\bar{f}_{i+2} $$\n因此，$(c_{2,0}, c_{2,1}, c_{2,2}) = (\\frac{1}{3}, \\frac{5}{6}, -\\frac{1}{6})$。\n\n总结起来，这九个系数是：\n对于 $q_0$： $(c_{0,-2}, c_{0,-1}, c_{0,0}) = (\\frac{1}{3}, -\\frac{7}{6}, \\frac{11}{6})$\n对于 $q_1$： $(c_{1,-1}, c_{1,0}, c_{1,1}) = (-\\frac{1}{6}, \\frac{5}{6}, \\frac{1}{3})$\n对于 $q_2$： $(c_{2,0}, c_{2,1}, c_{2,2}) = (\\frac{1}{3}, \\frac{5}{6}, -\\frac{1}{6})$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{3} & -\\frac{7}{6} & \\frac{11}{6} & -\\frac{1}{6} & \\frac{5}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{5}{6} & -\\frac{1}{6} \\end{pmatrix} } $$"
        },
        {
            "introduction": "经典的 Jiang-Shu WENO (WENO-JS) 格式虽然强大，但在解的光滑极值点（即临界点）附近存在已知的精度下降问题。本高级练习  将通过一个精心设计的案例，直接探究这一现象，并将其与改进的 WENO-Z 格式进行对比。通过计算和分析这两种格式在临界点处的权重表现，您将对格式性能的微妙之处以及推动高阶格式不断发展的动机有更深入的认识。",
            "id": "3957225",
            "problem": "考虑一个一维均匀网格，其网格间距为 $\\Delta x$，节点为 $x_{i+k} = x_i + k \\Delta x$，其中 $k$ 为整数。设 $u(x)$ 是一个光滑标量场，需要在单元界面 $x_{i+1/2}$ 处进行重构。重构使用一种五阶加权基本无振荡 (WENO) 有限差分格式，该格式由三个三点候选模板 $\\mathcal{S}_0 = \\{x_{i-2}, x_{i-1}, x_i\\}$、$\\mathcal{S}_1 = \\{x_{i-1}, x_i, x_{i+1}\\}$ 和 $\\mathcal{S}_2 = \\{x_i, x_{i+1}, x_{i+2}\\}$ 构建。对于每个模板 $\\mathcal{S}_k$，其光滑度指示子 $\\beta_k$ 由经过充分检验的 Jiang–Shu (JS) 度量定义\n$$\n\\beta_0 = \\frac{13}{12}\\left(u_{i-2} - 2 u_{i-1} + u_{i}\\right)^{2} + \\frac{1}{4}\\left(u_{i-2} - 4 u_{i-1} + 3 u_{i}\\right)^{2},\n$$\n$$\n\\beta_1 = \\frac{13}{12}\\left(u_{i-1} - 2 u_{i} + u_{i+1}\\right)^{2} + \\frac{1}{4}\\left(u_{i-1} - u_{i+1}\\right)^{2},\n$$\n$$\n\\beta_2 = \\frac{13}{12}\\left(u_{i} - 2 u_{i+1} + u_{i+2}\\right)^{2} + \\frac{1}{4}\\left(3 u_{i} - 4 u_{i+1} + u_{i+2}\\right)^{2},\n$$\n其中 $u_{i+k} = u(x_{i+k})$。在 $x_{i+1/2}$ 处进行五阶有限差分重构的最优线性权重为 $d_0 = \\frac{1}{10}$、$d_1 = \\frac{6}{10}$ 和 $d_2 = \\frac{3}{10}$。JS 非线性权重由经过充分检验的规则定义，其中指数 $p = 2$ 且 $\\epsilon = 0$，\n$$\n\\alpha_k^{\\mathrm{JS}} = \\frac{d_k}{\\beta_k^{p}}, \\quad w_k^{\\mathrm{JS}} = \\frac{\\alpha_k^{\\mathrm{JS}}}{\\alpha_0^{\\mathrm{JS}} + \\alpha_1^{\\mathrm{JS}} + \\alpha_2^{\\mathrm{JS}}},\n$$\n而改进的 WENO-Z 权重使用非线性度量 $\\tau_{5} = |\\beta_0 - \\beta_2|$，\n$$\n\\alpha_k^{\\mathrm{Z}} = d_k \\left( 1 + \\left( \\frac{\\tau_{5}}{\\beta_k + \\epsilon} \\right)^{2} \\right), \\quad w_k^{\\mathrm{Z}} = \\frac{\\alpha_k^{\\mathrm{Z}}}{\\alpha_0^{\\mathrm{Z}} + \\alpha_1^{\\mathrm{Z}} + \\alpha_2^{\\mathrm{Z}}},\n$$\n在 WENO-Z 修正项中，同样选择 $\\epsilon = 0$ 和指数 $2$。\n\n假设存在一个光滑三次函数 $u(x) = a x^{3} + b x^{2} + c x + d$，并通过取 $x_i = 0$ 和 $c = 0$ 在 $x_i$ 处强制满足临界点条件 $u'(x_i) = 0$。为了突显 Jiang–Shu WENO 在高阶临界点处的降阶机制，考虑 $b = 0$ 的特殊情况，使得在 $x_i = 0$ 附近有 $u(x) = a x^{3} + d$。仅使用上述定义和均匀网格代数，计算在 $x_{i+1/2}$ 处的三个 JS 权重 $w_0^{\\mathrm{JS}}, w_1^{\\mathrm{JS}}, w_2^{\\mathrm{JS}}$ 和三个 Z 权重 $w_0^{\\mathrm{Z}}, w_1^{\\mathrm{Z}}, w_2^{\\mathrm{Z}}$。最终答案需表示为一个包含六个权重（顺序为 $\\left(w_0^{\\mathrm{JS}}, w_1^{\\mathrm{JS}}, w_2^{\\mathrm{JS}}, w_0^{\\mathrm{Z}}, w_1^{\\mathrm{Z}}, w_2^{\\mathrm{Z}}\\right)$）的单行矩阵，并以精确分数形式给出。无需四舍五入。",
            "solution": "该问题要求计算一个特定光滑函数在高阶临界点处的五阶 Jiang-Shu (JS) 和 WENO-Z (Z) 非线性权重。对问题陈述的验证证实了其科学合理性、一致性和完整性。因此，我们可以着手求解。\n\n分析以网格点 $x_i$ 为中心，不失一般性地设其为 $0$。网格是均匀的，间距为 $\\Delta x$，因此节点坐标为 $x_{i+k} = (i+k-i) \\Delta x = k \\Delta x$。所考虑的函数为 $u(x) = a x^3 + d$，它满足指定的条件 $u'(x_i) = u'(0) = 0$ 和 $u''(x_i)=u''(0)=0$。函数在网格节点 $x_{j}$ 处的值记为 $u_j = u(x_j)$。因此，对于相关模板，函数值为：\n$$\nu_{i+k} = u(k \\Delta x) = a (k \\Delta x)^3 + d\n$$\n我们首先计算 $k \\in \\{0, 1, 2\\}$ 的光滑度指示子 $\\beta_k$。为简化代数运算，令 $C = a (\\Delta x)^3$。$\\beta_k$ 定义中的相关项可以用 $C$ 表示。\n\n对于第一个模板 $\\mathcal{S}_0 = \\{x_{i-2}, x_{i-1}, x_i\\}$，我们计算 $\\beta_0$ 中的两个有限差分项。\n点值为：\n$u_i = u(0) = d$\n$u_{i-1} = u(-\\Delta x) = a(-\\Delta x)^3 + d = -C + d$\n$u_{i-2} = u(-2\\Delta x) = a(-2\\Delta x)^3 + d = -8C + d$\n\n$\\beta_0$ 中的第一项是一个缩放的二阶差分：\n$$\nu_{i-2} - 2 u_{i-1} + u_{i} = (-8C + d) - 2(-C + d) + d = -8C + 2C + d - 2d + d = -6C\n$$\n$\\beta_0$ 中的第二项是一个缩放的一阶差分：\n$$\nu_{i-2} - 4 u_{i-1} + 3 u_{i} = (-8C + d) - 4(-C + d) + 3d = -8C + 4C + d - 4d + 3d = -4C\n$$\n将这些代入 $\\beta_0$ 的定义中：\n$$\n\\beta_0 = \\frac{13}{12}(-6C)^2 + \\frac{1}{4}(-4C)^2 = \\frac{13}{12}(36 C^2) + \\frac{1}{4}(16 C^2) = (13 \\times 3)C^2 + 4C^2 = (39+4)C^2 = 43 C^2\n$$\n\n对于第二个模板 $\\mathcal{S}_1 = \\{x_{i-1}, x_i, x_{i+1}\\}$，我们需要 $x_{i+1}$ 处的值：\n$u_{i+1} = u(\\Delta x) = a(\\Delta x)^3 + d = C + d$\n$\\beta_1$ 中的第一项是：\n$$\nu_{i-1} - 2 u_i + u_{i+1} = (-C + d) - 2d + (C+d) = 0\n$$\n$\\beta_1$ 中的第二项是：\n$$\nu_{i-1} - u_{i+1} = (-C+d) - (C+d) = -2C\n$$\n将这些代入 $\\beta_1$ 的定义中：\n$$\n\\beta_1 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(-2C)^2 = \\frac{1}{4}(4 C^2) = C^2\n$$\n\n对于第三个模板 $\\mathcal{S}_2 = \\{x_i, x_{i+1}, x_{i+2}\\}$，我们需要 $x_{i+2}$ 处的值：\n$u_{i+2} = u(2\\Delta x) = a(2\\Delta x)^3 + d = 8C + d$\n$\\beta_2$ 中的第一项是：\n$$\nu_i - 2 u_{i+1} + u_{i+2} = d - 2(C+d) + (8C+d) = -2C + 8C + d - 2d + d = 6C\n$$\n$\\beta_2$ 中的第二项是：\n$$\n3u_i - 4u_{i+1} + u_{i+2} = 3d - 4(C+d) + (8C+d) = -4C + 8C + 3d - 4d + d = 4C\n$$\n将这些代入 $\\beta_2$ 的定义中：\n$$\n\\beta_2 = \\frac{13}{12}(6C)^2 + \\frac{1}{4}(4C)^2 = \\frac{13}{12}(36 C^2) + \\frac{1}{4}(16 C^2) = (13 \\times 3)C^2 + 4C^2 = 43 C^2\n$$\n总而言之，假设 $C \\neq 0$（即 $a \\neq 0$），光滑度指示子为：\n$\\beta_0 = 43 C^2$, $\\beta_1 = C^2$, $\\beta_2 = 43 C^2$。\n\n现在，我们计算 Jiang-Shu (JS) 权重。未归一化的权重公式为 $\\alpha_k^{\\mathrm{JS}} = d_k / \\beta_k^p$，其中 $p=2$ 且 $\\epsilon=0$。\n$$\n\\alpha_0^{\\mathrm{JS}} = \\frac{d_0}{\\beta_0^2} = \\frac{1/10}{(43 C^2)^2} = \\frac{1}{10 \\cdot 43^2 C^4} = \\frac{1}{18490 C^4}\n$$\n$$\n\\alpha_1^{\\mathrm{JS}} = \\frac{d_1}{\\beta_1^2} = \\frac{6/10}{(C^2)^2} = \\frac{6}{10 C^4}\n$$\n$$\n\\alpha_2^{\\mathrm{JS}} = \\frac{d_2}{\\beta_2^2} = \\frac{3/10}{(43 C^2)^2} = \\frac{3}{10 \\cdot 43^2 C^4} = \\frac{3}{18490 C^4}\n$$\n归一化权重 $w_k^{\\mathrm{JS}}$ 通过除以总和 $\\sum_{j=0}^{2} \\alpha_j^{\\mathrm{JS}}$ 得到。公因子 $1/C^4$ 会被约掉。权重与 $\\alpha_k^{\\mathrm{JS}}$ 值的分子成正比，缩放到一个共同的基数：\n$\\alpha_0^{\\mathrm{JS}} \\propto \\frac{1}{18490}$\n$\\alpha_1^{\\mathrm{JS}} \\propto \\frac{6}{10} = \\frac{6 \\cdot 1849}{10 \\cdot 1849} = \\frac{11094}{18490}$\n$\\alpha_2^{\\mathrm{JS}} \\propto \\frac{3}{18490}$\n这些比例部分的总和是 $S = \\frac{1+11094+3}{18490} = \\frac{11098}{18490}$。\nJS 权重为：\n$$\nw_0^{\\mathrm{JS}} = \\frac{1/18490}{11098/18490} = \\frac{1}{11098}\n$$\n$$\nw_1^{\\mathrm{JS}} = \\frac{11094/18490}{11098/18490} = \\frac{11094}{11098} = \\frac{5547}{5549}\n$$\n$$\nw_2^{\\mathrm{JS}} = \\frac{3/18490}{11098/18490} = \\frac{3}{11098}\n$$\n\n接下来，我们计算 WENO-Z 权重。首先，我们求出非线性度量 $\\tau_5$：\n$$\n\\tau_5 = |\\beta_0 - \\beta_2| = |43 C^2 - 43 C^2| = 0\n$$\n未归一化的 WENO-Z 权重由 $\\alpha_k^{\\mathrm{Z}} = d_k \\left( 1 + \\left( \\frac{\\tau_5}{\\beta_k + \\epsilon} \\right)^2 \\right)$ 给出，其中 $\\epsilon=0$。\n由于 $\\tau_5 = 0$ 且所有 $\\beta_k \\neq 0$，因此对于所有的 $k$，修正项 $\\left( \\frac{\\tau_5}{\\beta_k} \\right)^2$ 都为零。\n因此，$\\alpha_k^{\\mathrm{Z}}$ 简化为最优线性权重 $d_k$。\n$$\n\\alpha_0^{\\mathrm{Z}} = d_0 \\left( 1 + 0 \\right) = d_0 = \\frac{1}{10}\n$$\n$$\n\\alpha_1^{\\mathrm{Z}} = d_1 \\left( 1 + 0 \\right) = d_1 = \\frac{6}{10}\n$$\n$$\n\\alpha_2^{\\mathrm{Z}} = d_2 \\left( 1 + 0 \\right) = d_2 = \\frac{3}{10}\n$$\n未归一化权重的总和为 $\\sum_{j=0}^{2} \\alpha_j^{\\mathrm{Z}} = d_0+d_1+d_2 = \\frac{1}{10} + \\frac{6}{10} + \\frac{3}{10} = \\frac{10}{10} = 1$。\n那么，归一化的 WENO-Z 权重为：\n$$\nw_k^{\\mathrm{Z}} = \\frac{\\alpha_k^{\\mathrm{Z}}}{\\sum_{j=0}^{2} \\alpha_j^{\\mathrm{Z}}} = \\frac{\\alpha_k^{\\mathrm{Z}}}{1} = \\alpha_k^{\\mathrm{Z}}\n$$\n$$\nw_0^{\\mathrm{Z}} = \\frac{1}{10}\n$$\n$$\nw_1^{\\mathrm{Z}} = \\frac{6}{10} = \\frac{3}{5}\n$$\n$$\nw_2^{\\mathrm{Z}} = \\frac{3}{10}\n$$\n这表明 WENO-Z 格式在这种类型的临界点上恢复了最优的五阶精度，而原始的 JS 格式则没有。\n\n最终的六个权重按指定顺序组合。\n$w_0^{\\mathrm{JS}} = \\frac{1}{11098}$\n$w_1^{\\mathrm{JS}} = \\frac{5547}{5549}$\n$w_2^{\\mathrm{JS}} = \\frac{3}{11098}$\n$w_0^{\\mathrm{Z}} = \\frac{1}{10}$\n$w_1^{\\mathrm{Z}} = \\frac{3}{5}$\n$w_2^{\\mathrm{Z}} = \\frac{3}{10}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{11098} & \\frac{5547}{5549} & \\frac{3}{11098} & \\frac{1}{10} & \\frac{3}{5} & \\frac{3}{10}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}