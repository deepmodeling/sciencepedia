{
    "hands_on_practices": [
        {
            "introduction": "第一项实践是进入熵稳定格式世界的第一步。我们将从一维无粘伯格斯方程入手，这是一个研究非线性波现象和激波形成过程的经典模型。通过从第一性原理构造一个熵稳定通量，你将亲手实践这些先进数值方法的核心组件，并验证非负熵产这一基本性质。",
            "id": "3999364",
            "problem": "考虑周期性域 $[-L/2, L/2]$（其中 $L=2$）上的一维标量守恒律 $u_t + f(u)_x = 0$，其通量为 $f(u) = \\frac{1}{2} u^2$（无粘伯格斯方程）。采用一个包含 $N$ 个点的均匀网格，网格间距为 $\\Delta x = \\frac{L}{N}$，单元中心为 $x_i = -\\frac{L}{2} + \\left(i + \\frac{1}{2}\\right)\\Delta x$，其中整数 $i \\in \\{0,1,\\dots,N-1\\}$。使用具有对角质量矩阵的分部求和（SBP）一阶导数算子，在周期性边界条件下近似空间导数，这意味着中心差分算子相对于对角内积矩阵是斜对称的。熵函数为 $\\eta(u) = \\frac{1}{2} u^2$，熵变量为 $v = \\eta'(u) = u$，熵通量为 $q(u) = \\frac{1}{3} u^3$。\n\n为伯格斯方程设计一个两点熵守恒通量 $\\hat{f}^{\\,ec}(u_L,u_R)$，并通过增加一个对称、相容的耗散项来得到一个熵稳定通量 $\\hat{f}^{\\,es}(u_L,u_R)$。该格式必须在周期性网格上写成通量差分（有限体积）形式\n$$\n\\frac{d u_i}{dt} = -\\frac{1}{\\Delta x}\\left(\\hat{f}^{\\,es}_{i+\\frac{1}{2}} - \\hat{f}^{\\,es}_{i-\\frac{1}{2}}\\right),\n$$\n其中 $\\hat{f}^{\\,es}_{i+\\frac{1}{2}} = \\hat{f}^{\\,es}(u_i,u_{i+1})$，并且为了周期性，下标对 $N$ 取模。\n\n从熵、熵变量的基本定义以及 Tadmor 框架关于熵守恒和熵稳定通量的理论出发，推导你的熵稳定通量所隐含的每个界面的离散熵产生 $p_{i+\\frac{1}{2}}$，并证明其为非负，即 $p_{i+\\frac{1}{2}} \\ge 0$。然后，实现一个程序，为以下测试套件计算该界面熵产生 $p_{i+\\frac{1}{2}}$ 和半离散熵率\n$$\n\\frac{d}{dt}\\left(\\sum_{i=0}^{N-1} \\Delta x \\,\\eta(u_i)\\right) = \\Delta x \\sum_{i=0}^{N-1} v_i \\,\\frac{d u_i}{dt},\n$$\n。对于每个测试，适用时验证激波处熵产生的非负性和局域性，并在移除耗散时验证动能守恒（此处解释为二次熵 $\\eta(u)$ 的守恒）。\n\n使用以下测试套件：\n- 测试 $\\mathrm{A}$（理想情况，激波）：$N = 128$，$u_L = 1$，$u_R = -1$，初始数据为若 $x_i  0$ 则 $u_i = u_L$，否则 $u_i = u_R$，耗散标度 $\\alpha = 1$。验证：\n  $1)$ 所有 $p_{i+\\frac{1}{2}} \\ge 0$，\n  $2)$ 熵产生仅局域化于间断处，即在周期性网格上恰好有两个界面（一个在 $x=0$ 处，一个在周期性环绕处）具有严格正的熵产生。\n- 测试 $\\mathrm{B}$（熵守恒，动能守恒）：$N = 128$，与测试 $\\mathrm{A}$ 相同的初始数据，耗散标度 $\\alpha = 0$。验证总半离散熵率等于 $0$（在数值容差范围内），即离散动能守恒。\n- 测试 $\\mathrm{C}$（边界情况，粗网格激波）：$N = 4$，与测试 $\\mathrm{A}$ 相同的初始数据，耗散标度 $\\alpha = 1$。验证：\n  $1)$ 所有 $p_{i+\\frac{1}{2}} \\ge 0$，\n  $2)$ 恰好有两个界面具有严格正的熵产生。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。条目必须按以下顺序和类型排列：\n$[\\text{A\\_nonneg}, \\text{A\\_localized}, \\text{B\\_energy\\_preserved}, \\text{C\\_nonneg}, \\text{C\\_localized}]$，\n其中每个条目都是布尔值（$\\text{True}$ 或 $\\text{False}$）。本问题中任何量都不需要物理单位。不出现角度。不得使用百分比。\n\n用 Python 实现完整的程序，并确保它在不需任何用户输入的情况下运行，仅使用执行环境中指定的库。",
            "solution": "所述问题在科学上是合理的，适定的，并包含了进行严格推导和计算验证所需的所有信息。我将开始解答。\n\n这个问题的基础是为一维标量守恒律\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0,\n$$\n构建一个数值格式，该格式遵循热力学第二定律的离散版本。对于无粘伯格斯方程，通量为 $f(u) = \\frac{1}{2} u^2$。该连续系统具有无穷多个熵对 $(\\eta(u), q(u))$，它们满足相容性条件 $q'(u) = \\eta'(u) f'(u)$。对于任何凸熵函数 $\\eta(u)$，精确解满足不等式\n$$\n\\frac{\\partial \\eta(u)}{\\partial t} + \\frac{\\partial q(u)}{\\partial x} \\le 0.\n$$\n问题指定了二次熵函数 $\\eta(u) = \\frac{1}{2} u^2$，它对应于该方程的物理动能密度。相关的熵变量是 $v(u) = \\eta'(u) = u$，熵通量是 $q(u) = \\int^u v(\\xi) f'(\\xi) d\\xi = \\int^u \\xi \\cdot \\xi \\, d\\xi = \\frac{1}{3} u^3$。\n\n我们考虑在均匀周期性网格上的有限体积离散化，\n$$\n\\frac{d u_i}{dt} = -\\frac{1}{\\Delta x}\\left(\\hat{f}_{i+\\frac{1}{2}} - \\hat{f}_{i-\\frac{1}{2}}\\right),\n$$\n其中 $\\hat{f}_{i+\\frac{1}{2}} = \\hat{f}(u_i, u_{i+1})$ 是一个与 $f(u)$ 相容的两点数值通量函数。\n\n熵稳定格式是一种能保证离散熵不等式成立的格式。根据 Tadmor 的框架，这是通过首先设计一个熵守恒通量，然后添加一个精确控制的耗散量来实现的。\n\n**1. 熵守恒（EC）通量**\n\n如果一个两点数值通量 $\\hat{f}^{\\,ec}(u_L, u_R)$ 满足条件\n$$\n(v_R - v_L) \\hat{f}^{\\,ec}(u_L, u_R) - (q_R - q_L) = 0,\n$$\n则它被定义为熵守恒的，其中 $v_L = v(u_L)$，$v_R = v(u_R)$，熵通量 $q$ 也类似。该条件确保数值格式在没有任何附加耗散的情况下，能精确地守恒总离散熵 $\\sum_i \\Delta x \\eta(u_i)$。\n\n对于给定的熵对，其中 $v(u) = u$ 且 $q(u) = \\frac{1}{3}u^3$，我们可以求解 $\\hat{f}^{\\,ec}$：\n$$\n\\hat{f}^{\\,ec}(u_L, u_R) = \\frac{q_R - q_L}{v_R - v_L} = \\frac{\\frac{1}{3}u_R^3 - \\frac{1}{3}u_L^3}{u_R - u_L}.\n$$\n假设 $u_L \\ne u_R$，我们可以对分子进行因式分解：\n$$\n\\hat{f}^{\\,ec}(u_L, u_R) = \\frac{\\frac{1}{3}(u_R - u_L)(u_L^2 + u_L u_R + u_R^2)}{u_R - u_L} = \\frac{1}{3} (u_L^2 + u_L u_R + u_R^2).\n$$\n如果 $u_L = u_R = u$，该公式正确地收敛到 $\\frac{1}{3}(3u^2) = u^2$。物理通量是 $f(u) = \\frac{1}{2}u^2$。这个通量是不相容的，因为 $\\hat{f}^{\\,ec}(u, u) = u^2 \\neq \\frac{1}{2}u^2$。让我们重新审视EC通量的定义。它是 $\\hat{f}^{ec}(u_L, u_R) = \\frac{q(u_R) - q(u_L)}{v(u_R) - v(u_L)}$。等等，这不是通用定义。一个用于伯格斯方程的通用、对称且相容的熵守恒通量是 $\\hat{f}^{ec}(u_L, u_R) = \\frac{f(u_L) + f(u_R)}{2} + \\dots$。一个被广泛使用且正确推导的形式实际上是 $\\hat{f}^{ec}(u_L, u_R) = \\frac{u_L^2 + u_L u_R + u_R^2}{6}$。让我们重新推导。势函数 $\\psi(u)$ 定义为 $v(u)f(u)-q(u) = u \\cdot \\frac{1}{2}u^2 - \\frac{1}{3}u^3 = \\frac{1}{6}u^3$。EC 通量是 $\\hat{f}^{ec}(u_L, u_R)=\\frac{\\psi_R-\\psi_L}{v_R-v_L} = \\frac{\\frac{1}{6}u_R^3-\\frac{1}{6}u_L^3}{u_R-u_L} = \\frac{1}{6}(u_L^2+u_L u_R+u_R^2)$。这是相容的：$\\hat{f}^{ec}(u,u) = \\frac{3u^2}{6} = \\frac{1}{2}u^2 = f(u)$。我最初的推导导致了一个不相容的通量，这是一个关键的缺陷。此后将使用修正后的通量。\n\n正确的EC通量：\n$$\n\\hat{f}^{\\,ec}(u_L, u_R) = \\frac{1}{6} (u_L^2 + u_L u_R + u_R^2).\n$$\n\n**2. 熵稳定（ES）通量**\n\n为了正确地捕捉激波，我们必须引入熵耗散。熵稳定通量 $\\hat{f}^{\\,es}$ 是通过在EC通量上添加一个数值耗散项而形成的。添加的项必须是对称的，并且作用于熵变量跳跃 $\\llbracket v \\rrbracket = v_R - v_L$ 的方向：\n$$\n\\hat{f}^{\\,es}(u_L, u_R) = \\hat{f}^{\\,ec}(u_L, u_R) - \\frac{1}{2} D(u_L, u_R) (v_R - v_L),\n$$\n其中 $D(u_L, u_R) \\ge 0$ 是一个标量耗散系数。为了与守恒律保持一致，耗散必须与状态的跳跃成正比，这里这一点得到了保证，因为它与熵变量的跳跃成正比。一个能确保稳定性的标准选择是基于系统的波速：\n$$\nD(u_L, u_R) = \\alpha \\max(|f'(u_L)|, |f'(u_R)|) = \\alpha \\max(|u_L|, |u_R|),\n$$\n其中 $\\alpha \\ge 0$ 是一个标度参数。当 $v(u)=u$ 时，ES通量为：\n$$\n\\hat{f}^{\\,es}(u_L, u_R) = \\frac{1}{6} (u_L^2 + u_L u_R + u_R^2) - \\frac{1}{2} \\alpha \\max(|u_L|, |u_R|) (u_R - u_L).\n$$\n\n**3. 离散熵产生**\n\n在状态 $u_L$ 和 $u_R$ 之间的界面上的数值熵产生被定义为熵守恒条件被违反的量：\n$$\np(u_L, u_R) := (v_R - v_L) \\hat{f}^{\\,es}(u_L, u_R) - (q_R - q_L).\n$$\n熵稳定性要求此产生项为非正，即 $p \\le 0$，这对应于熵耗散。问题隐含地将产生量 $p_{i+1/2}$ 定义为一个非负量，这表明存在符号约定上的差异。让我们将产生率定义为 $P_{i+1/2} = -p(u_i, u_{i+1})$，因此我们必须证明 $P_{i+1/2} \\ge 0$。\n$$\nP(u_L, u_R) = (q_R - q_L) - (v_R - v_L) \\hat{f}^{\\,es}(u_L, u_R).\n$$\n代入ES通量的定义：\n$$\nP(u_L, u_R) = (q_R - q_L) - (v_R - v_L) \\left[ \\hat{f}^{\\,ec}(u_L, u_R) - \\frac{1}{2} D(u_L, u_R) (v_R - v_L) \\right].\n$$\n$$\nP(u_L, u_R) = \\underbrace{\\left[ (q_R - q_L) - (v_R - v_L) \\hat{f}^{\\,ec}(u_L, u_R) \\right]}_{=0 \\text{ 根据EC性质}} + \\frac{1}{2} D(u_L, u_R) (v_R - v_L)^2.\n$$\n这明确地给出了每个界面的熵产生率：\n$$\np_{i+1/2} \\equiv P(u_i, u_{i+1}) = \\frac{1}{2} D(u_i, u_{i+1}) (v_{i+1} - v_i)^2.\n$$\n代入我们对 $D$ 和 $v$ 的选择：\n$$\np_{i+1/2} = \\frac{1}{2} \\alpha \\max(|u_i|, |u_{i+1}|) (u_{i+1} - u_i)^2.\n$$\n由于 $\\alpha \\ge 0$，$\\max(|u_i|, |u_{i+1}|) \\ge 0$ 且 $(u_{i+1} - u_i)^2 \\ge 0$，因此证明了每个界面的熵产生 $p_{i+1/2}$ 是非负的。只有当 $\\alpha  0$，$u_i \\ne u_{i+1}$，且 $u_i, u_{i+1}$ 中至少有一个非零时，产生量才是严格为正的。\n\n**4. 半离散熵率**\n\n总离散熵为 $E = \\sum_{i=0}^{N-1} \\Delta x\\, \\eta(u_i)$。其变化率为：\n$$\n\\frac{dE}{dt} = \\sum_{i=0}^{N-1} \\Delta x \\frac{d\\eta(u_i)}{dt} = \\sum_{i=0}^{N-1} \\Delta x\\, v_i \\frac{du_i}{dt}.\n$$\n这是问题陈述中给出的表达式。通过代入半离散格式并在周期性网格上应用分部求和，我们可以将其与熵产生联系起来。\n$$\n\\frac{dE}{dt} = \\sum_{i=0}^{N-1} \\Delta x\\, v_i \\left( -\\frac{1}{\\Delta x}(\\hat{f}^{\\,es}_{i+\\frac{1}{2}} - \\hat{f}^{\\,es}_{i-\\frac{1}{2}}) \\right) = -\\sum_{i=0}^{N-1} v_i (\\hat{f}^{\\,es}_{i+\\frac{1}{2}} - \\hat{f}^{\\,es}_{i-\\frac{1}{2}}).\n$$\n使用分部求和（注意在周期性域上 $\\sum a_i(b_{i+1}-b_i) = -\\sum b_i(a_i-a_{i-1})$），我们变换该和式：\n$$\n\\frac{dE}{dt} = \\sum_{i=0}^{N-1} \\hat{f}^{\\,es}_{i+\\frac{1}{2}} (v_{i+1} - v_i).\n$$\n根据 $p_{i+1/2}$ 的定义，我们有 $(v_{i+1} - v_i) \\hat{f}^{\\,es}_{i+1/2} = (q_{i+1} - q_i) - p_{i+1/2}$。将此代入和式：\n$$\n\\frac{dE}{dt} = \\sum_{i=0}^{N-1} \\left( (q_{i+1} - q_i) - p_{i+1/2} \\right) = \\sum_{i=0}^{N-1} (q_{i+1} - q_i) - \\sum_{i=0}^{N-1} p_{i+1/2}.\n$$\n右边的第一项是在周期性网格上的伸缩求和，$\\sum_{i=0}^{N-1} (q_{i+1} - q_i) = q_N - q_0$。由于周期性，$u_N=u_0$ 因而 $q_N=q_0$，使得此和为零。这留下了最终的关系式：\n$$\n\\frac{d}{dt}\\left(\\sum_{i=0}^{N-1} \\Delta x \\,\\eta(u_i)\\right) = - \\sum_{i=0}^{N-1} p_{i+1/2}.\n$$\n由于我们证明了 $p_{i+1/2} \\ge 0$，总熵率 $\\frac{dE}{dt}$ 是非正的，满足离散熵不等式。如果 $\\alpha=0$（无耗散），则所有 $p_{i+1/2}=0$，熵率为零，这意味着该格式是熵守恒的（因此也是动能守恒的）。\n现在，实现部分将为指定的测试用例计算这些量。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and tests an entropy-stable scheme for the 1D Burgers' equation.\n    \"\"\"\n    \n    test_cases = [\n        {'id': 'A', 'N': 128, 'uL': 1.0, 'uR': -1.0, 'alpha': 1.0, 'L': 2.0},\n        {'id': 'B', 'N': 128, 'uL': 1.0, 'uR': -1.0, 'alpha': 0.0, 'L': 2.0},\n        {'id': 'C', 'N': 4,   'uL': 1.0, 'uR': -1.0, 'alpha': 1.0, 'L': 2.0}\n    ]\n\n    all_results = {}\n    tolerance = 1e-14\n\n    for params in test_cases:\n        test_id = params['id']\n        N = params['N']\n        uL = params['uL']\n        uR = params['uR']\n        alpha = params['alpha']\n        L = params['L']\n\n        # 1. Grid and Initial Condition\n        dx = L / N\n        x = -L / 2 + (np.arange(N) + 0.5) * dx\n        u = np.where(x  0, uL, uR)\n\n        # 2. Define entropy pair and flux\n        # Entropy variable: v(u) = u\n        # Entropy flux: q(u) = u^3 / 3\n        # In this specific case, u is the state and the entropy variable.\n        v = u\n\n        # 3. Compute numerical fluxes and per-interface production\n        f_hat_es = np.zeros(N)\n        p = np.zeros(N)\n        \n        for i in range(N):\n            u_i = u[i]\n            u_ip1 = u[(i + 1) % N]\n            \n            # Entropy-conservative flux\n            f_hat_ec = (u_i**2 + u_i * u_ip1 + u_ip1**2) / 6.0\n            \n            # Dissipation term\n            # D = alpha * max(|f'(u_L)|, |f'(u_R)|) = alpha * max(|u_L|, |u_R|)\n            D_val = alpha * max(abs(u_i), abs(u_ip1))\n            \n            # Entropy-stable flux at interface i+1/2\n            v_i = u_i\n            v_ip1 = u_ip1\n            f_hat_es[i] = f_hat_ec - 0.5 * D_val * (v_ip1 - v_i)\n            \n            # Per-interface entropy production p_{i+1/2}\n            # p = 0.5 * D * (v_{i+1} - v_i)^2\n            p[i] = 0.5 * D_val * (v_ip1 - v_i)**2\n\n        # 4. Compute semi-discrete time derivative du/dt\n        dudt = np.zeros(N)\n        for i in range(N):\n            f_hat_plus = f_hat_es[i]\n            f_hat_minus = f_hat_es[(i - 1 + N) % N]\n            dudt[i] = -(f_hat_plus - f_hat_minus) / dx\n\n        # 5. Compute total semi-discrete entropy rate\n        # S_dot = integral(eta_t dx) = integral(v * u_t dx)\n        # S_dot_discrete = sum(dx * v_i * du_i/dt)\n        total_entropy_rate = dx * np.sum(v * dudt)\n        \n        # 6. Perform verifications based on test case ID\n        if test_id == 'A':\n            # 1) Non-negativity of entropy production\n            all_results['A_nonneg'] = np.all(p >= -tolerance)\n            # 2) Localization of production to shock interfaces\n            # For this IC, shocks are at x=0 and periodic boundary.\n            # Only two interfaces should have non-zero production.\n            positive_production_count = np.sum(p > tolerance)\n            all_results['A_localized'] = (positive_production_count == 2)\n        \n        elif test_id == 'B':\n            # With alpha=0, scheme is EC, entropy/energy must be conserved.\n            # Total entropy rate must be zero.\n            all_results['B_energy_preserved'] = (abs(total_entropy_rate)  tolerance)\n\n        elif test_id == 'C':\n            # 1) Non-negativity of entropy production\n            all_results['C_nonneg'] = np.all(p >= -tolerance)\n            # 2) Localization on a coarse grid\n            positive_production_count = np.sum(p > tolerance)\n            all_results['C_localized'] = (positive_production_count == 2)\n\n    # 7. Format final output\n    ordered_results = [\n        all_results['A_nonneg'],\n        all_results['A_localized'],\n        all_results['B_energy_preserved'],\n        all_results['C_nonneg'],\n        all_results['C_localized']\n    ]\n\n    print(f\"[{','.join(map(str, ordered_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在为标量方程建立了格式之后，我们现在将这些原理推广到一个方程组：一维可压缩欧拉方程。本练习侧重于另一个关键性质——动能守恒，这对于稳定模拟湍流等复杂流动至关重要。你将使用一个保动能（KEP）的分裂形式离散，并利用分部求和（SBP）性质来数值验证离散能量收支，这是一项关键的诊断技能。",
            "id": "3999356",
            "problem": "考虑一维可压缩欧拉方程，其定义在长度为 $L = 2\\pi$（角度单位为弧度）的周期性域上，以无量纲形式写出密度 $\\rho(x,t)$、速度 $u(x,t)$ 和压力 $p(x,t)$，其中比热比 $\\gamma = 1.4$。我们关注半离散动量方程，其非线性对流通量采用动能守恒（KEP）的分裂形式，并包含线性数值黏性。该半离散动量方程为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}(\\rho u) = -\\mathcal{C}_m(\\rho,u) - D p + D\\left(\\mu D u\\right),\n$$\n其中 $D$ 是一个满足分部求和（SBP）性质的离散周期性中心差分导数算子，$\\mu$ 是一个常数数值黏性系数，$\\mathcal{C}_m(\\rho,u)$ 是对流项 $\\partial_x(\\rho u^2)$ 的 KEP 分裂形式离散化。在一个具有 $N$ 个点和间距 $\\Delta x = L/N$ 的均匀网格上，离散导数算子 $D$ 定义为\n$$\n(D v)_i = \\frac{v_{i+1} - v_{i-1}}{2\\Delta x},\n$$\n采用周期性索引。SBP 性质为\n$$\n\\Delta x \\sum_{i=0}^{N-1} v_i (D w)_i = - \\Delta x \\sum_{i=0}^{N-1} (D v)_i w_i,\n$$\n适用于所有离散网格函数 $v,w$。\n\n动量对流算子的 KEP 分裂形式是三重积对称分裂\n$$\n\\mathcal{C}_m(\\rho,u) = \\frac{1}{3}\\left[ D\\left(\\rho u^2\\right) + u\\, D(\\rho u) + \\rho u\\, D u \\right].\n$$\n定义离散动能\n$$\nK = \\Delta x \\sum_{i=0}^{N-1} \\frac{1}{2}\\rho_i u_i^2.\n$$\n使用 SBP 性质和上述分裂形式，精确的离散动能收支可写为\n$$\n\\frac{\\mathrm{d}K}{\\mathrm{d}t} = - \\Delta x \\sum_{i=0}^{N-1} u_i (D p)_i \\;-\\; \\Delta x \\sum_{i=0}^{N-1} \\mu \\left(D u\\right)_i^2,\n$$\n这表明了精确的输运（动能没有因对流离散化而产生伪变化）和由数值黏性引起的受控耗散（半负定贡献）。\n\n您的任务是实现一个程序，对于给定的离散场 $\\rho, u, p$，计算离散动能收支的三个定量诊断指标：\n\n1. 输运残差\n$$\nR_{\\mathrm{trans}} = \\left| \\Delta x \\sum_{i=0}^{N-1} u_i\\, \\mathcal{C}_m(\\rho,u)_i \\right|,\n$$\n对于精确的 KEP 分裂形式和 SBP 导数，该值在数值上必须接近于零。\n\n2. 黏性残差\n$$\nR_{\\mathrm{visc}} = \\left| \\Delta x \\sum_{i=0}^{N-1} u_i\\, D\\left(\\mu D u\\right)_i \\;+\\; \\Delta x \\sum_{i=0}^{N-1} \\mu \\left(D u\\right)_i^2 \\right|,\n$$\n该值在数值上必须接近于零，以验证数值黏性对动能变化率的贡献是一个半负定的耗散。\n\n3. 总收支残差\n$$\nR_{\\mathrm{budget}} = \\left| \\Delta x \\sum_{i=0}^{N-1} u_i \\left(-\\mathcal{C}_m(\\rho,u)_i - (D p)_i + D(\\mu D u)_i \\right) \\;-\\; \\left( - \\Delta x \\sum_{i=0}^{N-1} u_i (D p)_i \\;-\\; \\Delta x \\sum_{i=0}^{N-1} \\mu (D u)_i^2 \\right) \\right|,\n$$\n该值在数值上必须接近于零，以验证组合的半离散右端项与精确的离散动能收支相匹配。\n\n所有量都是无量纲的。角度以弧度为单位。不需要物理单位。\n\n在周期性域 $[0,2\\pi)$ 上，使用以下初始条件测试套件实现上述过程，每个初始条件代表一个独特的、空间变化的压缩状态，模拟衰减可压缩湍流的特征：\n\n- 测试用例 1（一般多模态波动，“理想路径”）：\n    - $N = 128$\n    - $\\mu = 5\\times 10^{-3}$\n    - $x_i = i \\Delta x$, $\\Delta x = 2\\pi/N$\n    - $\\rho(x) = 1 + 0.20 \\sin(x) + 0.10 \\sin(7x)$\n    - $u(x) = 0.50 \\sin(2x) + 0.20 \\cos(3x) + 0.10 \\sin(5x)$\n    - $p(x) = 1 + 0.10 \\cos(x) + 0.05 \\sin(5x) + 0.03 \\cos(7x)$\n\n- 测试用例 2（恒定状态，边界条件检查）：\n    - $N = 128$\n    - $\\mu = 5\\times 10^{-3}$\n    - $\\rho(x) = 1$\n    - $u(x) = 0$\n    - $p(x) = 1$\n\n- 测试用例 3（更强的可压缩性和梯度，边界情况）：\n    - $N = 257$\n    - $\\mu = 1\\times 10^{-2}$\n    - $x_i = i \\Delta x$, $\\Delta x = 2\\pi/N$\n    - $\\rho(x) = 1 + 0.50 \\sin(x) + 0.25 \\sin(4x)$\n    - $u(x) = 0.70 \\sin(3x) + 0.50 \\cos(2x)$\n    - $p(x) = 1 + 0.20 \\cos(2x) + 0.10 \\sin(6x)$\n\n您的程序必须为每个测试用例计算三个残差 $R_{\\mathrm{trans}}, R_{\\mathrm{visc}}, R_{\\mathrm{budget}}$ 作为浮点数。最终输出格式必须是单行，包含一个由三元素列表组成的列表，每个测试用例一个，按上述顺序排列。例如，\n$$\n\\text{[ [}R_{\\mathrm{trans}}^{(1)}, R_{\\mathrm{visc}}^{(1)}, R_{\\mathrm{budget}}^{(1)}\\text{], [}R_{\\mathrm{trans}}^{(2)}, R_{\\mathrm{visc}}^{(2)}, R_{\\mathrm{budget}}^{(2)}\\text{], [}R_{\\mathrm{trans}}^{(3)}, R_{\\mathrm{visc}}^{(3)}, R_{\\mathrm{budget}}^{(3)}\\text{] ]}\n$$\n不含其他文本。所有残差都必须使用上面定义的离散 SBP 内积 $\\Delta x \\sum$ 计算，并且必须以普通十进制数（无百分号）报告。对于精确守恒或精确耗散恒等式，数值结果应接近于零（在机器精度范围内），但您的程序仍必须按原样输出计算出的残差值，而不是将它们四舍五入到零。",
            "solution": "该问题要求实现并验证一维可压缩动量方程的半离散格式的性质。验证是通过计算与离散动能收支相关的三个残差来进行的。所提供的格式使用了一个满足分部求和（SBP）性质的周期性中心差分算子，以及一个为保持动能（KEP）而设计的特定对流项分裂形式。\n\n首先，我们建立计算框架。域是一个周期性区间 $[0, 2\\pi)$，用 $N$ 个均匀间隔的点 $x_i = i \\Delta x$（$i=0, 1, \\dots, N-1$）进行离散化，其中 $\\Delta x = 2\\pi/N$。一个离散函数 $v$ 由其在这些网格点上的值 $v_i = v(x_i)$ 组成的向量表示。\n\n离散化的核心是周期性中心差分算子 $D$，定义为\n$$\n(D v)_i = \\frac{v_{i+1} - v_{i-1}}{2\\Delta x}\n$$\n索引是周期性的，意味着 $v_{N} = v_0$ 且 $v_{-1} = v_{N-1}$。该算子具有分部求和（SBP）性质，这是积分分部法的离散模拟。对于任意两个周期性网格函数 $v$ 和 $w$，SBP 性质表明：\n$$\n\\Delta x \\sum_{i=0}^{N-1} v_i (D w)_i = - \\Delta x \\sum_{i=0}^{N-1} (D v)_i w_i\n$$\n此性质对于推导模拟其连续对应物的离散守恒律至关重要。在我们的实现中，我们可以使用数组移位操作，特别是 NumPy 中的 `np.roll`，来高效地计算 $D$ 在表示网格函数的向量上的作用，该函数自然地处理周期性边界。\n\n半离散动量方程给出为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}(\\rho u) = -\\mathcal{C}_m(\\rho,u) - D p + D\\left(\\mu D u\\right)\n$$\n我们分析右侧各项对总离散动能 $K = \\Delta x \\sum_{i=0}^{N-1} \\frac{1}{2}\\rho_i u_i^2$ 变化率的贡献。该分析依赖于将右侧与速度 $u$ 作离散内积。\n\n**1. 对流项和输运残差, $R_{\\mathrm{trans}}$**\n\n对流项使用一种特定的动能守恒（KEP）分裂形式进行离散化：\n$$\n\\mathcal{C}_m(\\rho,u) = \\frac{1}{3}\\left[ D\\left(\\rho u^2\\right) + u\\, D(\\rho u) + \\rho u\\, D u \\right]\n$$\n如果一个离散化方法对动能收支的贡献为零，则该方法是 KEP 的。这个贡献由内积 $-\\Delta x \\sum u_i (\\mathcal{C}_m)_i$ 给出。对于这种特定形式，可以解析地证明在精确算术中 $\\Delta x \\sum u_i (\\mathcal{C}_m)_i = 0$。输运残差，\n$$\nR_{\\mathrm{trans}} = \\left| \\Delta x \\sum_{i=0}^{N-1} u_i\\, \\mathcal{C}_m(\\rho,u)_i \\right|\n$$\n在数值上验证了这一性质。任何非零值都应在机器浮点精度的量级上。\n\n**2. 黏性项和黏性残差, $R_{\\mathrm{visc}}$**\n\n数值黏性项是 $D(\\mu D u)$。它对动能变化率的贡献是 $\\Delta x \\sum u_i D(\\mu D u)_i$。由于黏性系数 $\\mu$ 是一个常数，这等于 $\\mu \\Delta x \\sum u_i D(D u)_i$。应用一次 SBP 性质，可将其转换为：\n$$\n\\mu \\Delta x \\sum_{i=0}^{N-1} u_i (D(D u))_i = - \\mu \\Delta x \\sum_{i=0}^{N-1} (D u)_i (D u)_i = - \\Delta x \\sum_{i=0}^{N-1} \\mu (D u)_i^2\n$$\n这最后一项显然是半负定的，代表了动能的物理耗散。黏性残差，\n$$\nR_{\\mathrm{visc}} = \\left| \\Delta x \\sum_{i=0}^{N-1} u_i\\, D\\left(\\mu D u\\right)_i \\;+\\; \\Delta x \\sum_{i=0}^{N-1} \\mu \\left(D u\\right)_i^2 \\right|\n$$\n被设计为在离散算术中精确为零，从而确认我们对黏性算子的实现和 SBP 性质是一致的。非零值将表示实现错误或显著的浮点累积。\n\n**3. 总收支残差, $R_{\\mathrm{budget}}$**\n\n总收支残差作为一个整体的一致性检查。它将直接从动量方程的完整右端计算出的动能趋势与理论上推导的动能收支表达式进行比较。\n设动量方程的右端为 $\\mathcal{F} = -\\mathcal{C}_m - D p + D(\\mu D u)$。动能趋势是 $\\Delta x \\sum u_i \\mathcal{F}_i$。\n理论收支是 $\\mathcal{B} = - \\Delta x \\sum u_i (D p)_i - \\Delta x \\sum \\mu (D u)_i^2$。\n残差定义为 $R_{\\mathrm{budget}} = \\left| \\Delta x \\sum u_i \\mathcal{F}_i - \\mathcal{B} \\right|$。\n代入 $\\mathcal{F}$ 和 $\\mathcal{B}$ 的表达式并简化，我们发现：\n$$\nR_{\\mathrm{budget}} = \\left| \\left( \\Delta x \\sum u_i D(\\mu D u)_i + \\Delta x \\sum \\mu (D u)_i^2 \\right) - \\left( \\Delta x \\sum u_i \\mathcal{C}_m \\right) \\right|\n$$\n这表明 $R_{\\mathrm{budget}}$ 是黏性残差项和输运残差项的未取绝对值的值之差的绝对值。如果 $R_{\\mathrm{trans}}$ 和 $R_{\\mathrm{visc}}$ 都接近于零，那么 $R_{\\mathrm{budget}}$ 也必须接近于零，这证实了整个数值公式及其实现的自洽性。\n\n算法通过遍历每个测试用例来进行。对于每个用例，它设置网格和初始场 $\\rho, u, p$。然后计算算子 $\\mathcal{C}_m$ 和 $D$，并根据它们的定义组装三个残差。所有向量操作都使用 NumPy 以提高效率。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes kinetic-energy budget residuals for a semidiscrete momentum equation\n    for three test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"N\": 128, \"mu\": 5e-3,\n            \"rho_func\": lambda x: 1 + 0.20 * np.sin(x) + 0.10 * np.sin(7*x),\n            \"u_func\": lambda x: 0.50 * np.sin(2*x) + 0.20 * np.cos(3*x) + 0.10 * np.sin(5*x),\n            \"p_func\": lambda x: 1 + 0.10 * np.cos(x) + 0.05 * np.sin(5*x) + 0.03 * np.cos(7*x)\n        },\n        {\n            \"N\": 128, \"mu\": 5e-3,\n            \"rho_func\": lambda x: np.ones_like(x),\n            \"u_func\": lambda x: np.zeros_like(x),\n            \"p_func\": lambda x: np.ones_like(x)\n        },\n        {\n            \"N\": 257, \"mu\": 1e-2,\n            \"rho_func\": lambda x: 1 + 0.50 * np.sin(x) + 0.25 * np.sin(4*x),\n            \"u_func\": lambda x: 0.70 * np.sin(3*x) + 0.50 * np.cos(2*x),\n            \"p_func\": lambda x: 1 + 0.20 * np.cos(2x) + 0.10 * np.sin(6*x)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Setup grid and discrete fields\n        N = case[\"N\"]\n        mu = case[\"mu\"]\n        L = 2 * np.pi\n        dx = L / N\n        x = np.arange(N) * dx\n\n        rho = case[\"rho_func\"](x)\n        u = case[\"u_func\"](x)\n        p = case[\"p_func\"](x)\n\n        # 2. Define the discrete periodic central-difference operator D\n        def D(v):\n            \"\"\"Computes the SBP-compatible central difference on a periodic grid.\"\"\"\n            return (np.roll(v, -1) - np.roll(v, 1)) / (2 * dx)\n\n        # 3. Compute terms for the residuals\n        \n        # Convective operator C_m\n        rho_u2 = rho * u**2\n        rho_u = rho * u\n        D_rho_u2 = D(rho_u2)\n        D_rho_u = D(rho_u)\n        D_u = D(u)\n        Cm = (1/3) * (D_rho_u2 + u * D_rho_u + rho_u * D_u)\n\n        # Dissipative operator term D(mu*D(u))\n        D_Du = D(D_u)\n        visc_term_mom_eq = mu * D_Du\n        \n        # 4. Compute the residuals\n        \n        # R_trans: Transport residual\n        # This term should be zero in exact arithmetic for a KEP scheme.\n        val_trans = dx * np.sum(u * Cm)\n        R_trans = np.abs(val_trans)\n\n        # R_visc: Viscous residual\n        # This term should be zero in exact arithmetic, verifying SBP for the viscous term.\n        val_visc = dx * np.sum(u * visc_term_mom_eq) + dx * np.sum(mu * D_u**2)\n        R_visc = np.abs(val_visc)\n\n        # R_budget: Full budget residual\n        # This combines the two checks above.\n        # R_budget = | val_visc - val_trans |\n        # As derived in the solution text, the pressure terms cancel.\n        R_budget = np.abs(val_visc - val_trans)\n        \n        results.append([R_trans, R_visc, R_budget])\n\n    # Final print statement in the exact required format.\n    # repr() produces a string representation that matches the format, including spaces.\n    print(repr(results))\n\nsolve()\n```"
        },
        {
            "introduction": "一个稳健的数值格式不仅需要稳定的内部离散，还需要恰当处理的边界条件。这项高级实践将探讨一项关键任务：在分部求和-同步近似项（SBP-SAT）框架下，为欧拉方程设计一个稳定的滑移壁面边界条件。你将推导确保熵稳定性和防止负压等非物理现象所需的最小耗散，从而在理论稳定性分析与实际代码实现之间架起一座桥梁。",
            "id": "3999349",
            "problem": "考虑以守恒形式写出的一维可压缩欧拉方程，其状态向量为 $U = [\\rho, \\rho u, E]^{\\top}$，其中 $\\rho$ 是密度， $u$ 是垂直于平面壁面的速度， $E$ 是总能量。压力 $p$ 由 $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$ 定义，其中比热比 $\\gamma  1$。通量为 $F(U) = [\\rho u, \\rho u^{2} + p, (E + p)u]^{\\top}$。令物理熵为 $U_{s} = -\\frac{\\rho s}{\\gamma - 1}$，其中 $s = \\ln(p) - \\gamma \\ln(\\rho)$，熵变量为 $V = \\frac{\\partial U_{s}}{\\partial U}$。采用分部求和（SBP）有限差分格式，并结合同时近似项（SAT）罚函数，在 $x=0$ 处施加一个固定的、平面的、无粘滑移壁面条件。内部体积离散采用一种保持动能（KEP）的分裂形式，而壁面处的界面通量由一个熵守恒（EC）两点通量和一个熵稳定耗散项增强构成。\n\n在壁面处，一个内部状态 $U^{I} = [\\rho^{I}, \\rho^{I} u^{I}, E^{I}]^{\\top}$ 与一个镜像壁面状态 $U^{W}$ 配对，该镜像状态通过施加精确反射（滑移）来定义：$\\rho^{W} = \\rho^{I}$， $u^{W} = -u^{I}$，以及 $p^{W} = p^{I}$（这意味着 $E^{W} = E^{I}$）。在壁面处施加的数值通量是一个熵守恒通量 $F^{\\mathrm{ec}}(U^{I}, U^{W})$ 加上一个对称的熵稳定罚项，该罚项以熵变量的形式写成一个带有标量缩放的耗散算子，即边界贡献具有以下形式\n$$\nF^{*}(U^{I}, U^{W}) \\;=\\; F^{\\mathrm{ec}}(U^{I}, U^{W}) \\;-\\; \\frac{1}{2}\\,d\\,\\mathcal{D}(U^{I}, U^{W}),\n$$\n其中 $d \\ge 0$ 是一个标量耗散系数，$\\mathcal{D}(U^{I}, U^{W})$ 是一个相容的状态差分算子，其产生的非负离散熵与 $(V^{I} - V^{W})^{\\top}(U^{I} - U^{W})$ 成正比。假设 SBP-SAT 半离散格式的构造使得内部贡献是熵守恒的（在 Tadmor 的意义上），并且当 $d$ 超过在邻近壁面状态下评估的法向通量雅可比矩阵的谱半径时，壁面罚项会产生一个具有上述通量形式的边界熵不等式。\n\n在壁面附近的强压缩情况下，如果内能 $E - \\frac{1}{2}\\rho u^{2}$ 变为非正值，数值上可能会出现伪负压。你的任务是：\n\n1. 从可压缩欧拉方程和物理熵的定义出发，推导上述描述的具有熵守恒内部通量和熵稳定壁面通量的 SBP-SAT 格式的半离散熵平衡。说明边界项如何依赖于 $d$ 的选择，以及如何通过镜像状态 $U^{W}$ 实现精确反射。\n\n2. 使用镜像状态 $U^{W}$，证明壁面通量的熵守恒部分在壁面处产生零质量通量和零能量通量，并保持了半离散格式的动能守恒特性。解释当 $U^{W}$ 是一个完美镜像时，耗散项为何只作用于法向动量，以及为何这对于防止负压是有利的。\n\n3. 从双曲系统的第一性原理和可压缩欧拉通量雅可比矩阵的结构出发，推导最小标量耗散系数 $d_{\\min}$。该系数需同时确保半离散熵不增加（熵稳定），防止边界处理在强压缩下产生负压（通过不减少内能并减少过多的法向动能），并维持精确反射。用邻近壁面的原始变量 $\\rho^{I}$、 $u^{I}$、 $p^{I}$ 和 $\\gamma$ 表示 $d_{\\min}$。使用在邻近壁面状态下评估的标准声速 $a = \\sqrt{\\gamma p / \\rho}$。\n\n提供 $d_{\\min}$ 的最终表达式，单位为米每秒。不需要进行数值计算；仅给出封闭形式的解析表达式。",
            "solution": "该问题的分析始于可压缩流体动力学的基本原理及其数值近似。该问题涉及一种用于对一维欧拉方程施加滑移壁面边界条件的分部求和（SBP）有限差分格式，该格式带有同时近似项（SAT）。核心任务包括分析该格式的熵稳定性、壁面通量的性质，以及推导一个最小耗散系数以确保物理和数值稳定性。\n\n首先，我们讨论半离散熵平衡。一维可压缩欧拉方程是一个守恒律系统，$\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0$。对于光滑解，存在一个关于物理熵 $U_s = -\\frac{\\rho s}{\\gamma - 1}$ 的附加守恒律，其形式为 $\\frac{\\partial U_s}{\\partial t} + \\frac{\\partial F_s(U)}{\\partial x} = 0$，其中 $F_s$ 是熵通量。该方程是通过将欧拉方程左乘熵变量向量 $V^{\\top} = \\frac{\\partial U_s}{\\partial U}$ 推导出来的。像 $U_s$ 这样的凸熵函数的存在是双曲守恒律的一个关键特征。对于有激波的解，熵平衡变为一个不等式，$\\frac{\\partial U_s}{\\partial t} + \\frac{\\partial F_s(U)}{\\partial x} \\le 0$。如果一个数值格式满足此不等式的离散模拟，则该格式被认为是熵稳定的。\n\n问题描述了一个 SBP-SAT 半离散格式。域内的总离散熵为 $\\mathcal{S}(t) = \\sum_{j} (H U_s(U_j(t)))_j$，其中 $H$ 是与 SBP 算子相关的正定对角范数矩阵。时间导数为 $\\frac{d\\mathcal{S}}{dt} = \\sum_j H_j V_j^{\\top} \\frac{dU_j}{dt}$。半离散格式的形式为 $\\frac{dU}{dt} = -\\mathcal{D}_{int}(U) + \\mathcal{B}(U)$，其中 $\\mathcal{D}_{int}$ 代表内部空间离散，$\\mathcal{B}$ 代表施加边界条件的 SAT 罚项。问题指出，内部格式是熵守恒的。这个性质基于使用熵守恒（EC）两点通量的分裂形式离散，确保了来自内部算子 $\\mathcal{D}_{int}$ 对熵产生的贡献为零。也就是说，$\\sum_j H_j V_j^{\\top} (-\\mathcal{D}_{int}(U))_j = \\Psi_{b,L} - \\Psi_{b,R}$，其中 $\\Psi_{b,L}$ 和 $\\Psi_{b,R}$ 是在域边界上的数值熵通量。因此，总熵的变化率完全由边界项控制：\n$$\n\\frac{d\\mathcal{S}}{dt} = \\text{边界贡献}\n$$\n在固壁（$x=0$）处，SAT 施加边界条件。该边界处熵变化的贡献由罚项中使用的数值通量 $F^*(U^I, U^W)$ 决定。对于 SBP-SAT 格式，边界对熵变化的贡献表现为数值熵通量的形式。总熵不增加（熵稳定）的条件要求流入计算域的净熵流为非正。在滑移壁面处，这转化为对边界上数值熵产生的条件。所提供的公式表明数值通量为 $F^* = F^{\\mathrm{ec}} - \\frac{1}{2}d\\,\\mathcal{D}$。边界上的熵产生由此通量控制，并且如问题所述，当耗散系数 $d$ 足够大时，可以实现稳定性。镜像状态 $U^W$ 以对称的方式设定了速度 $u=0$ 的边界条件，强制实现反射。速度分量 $u^W = -u^I$ 确保了壁面处的平均法向速度为零，这是滑移条件的本质。\n\n接下来，我们分析壁面通量的性质。数值通量为 $F^{*} = F^{\\mathrm{ec}}(U^{I}, U^{W}) - \\frac{1}{2}\\,d\\,\\mathcal{D}(U^{I}, U^{W})$。我们首先考察熵守恒部分 $F^{\\mathrm{ec}}$。壁面状态 $U^W$ 由 $\\rho^W = \\rho^I$，$u^W = -u^I$ 和 $p^W = p^I$ 定义。根据状态方程，这意味着总能量也是对称的：$E^W = \\frac{p^W}{\\gamma-1} + \\frac{1}{2}\\rho^W(u^W)^2 = \\frac{p^I}{\\gamma-1} + \\frac{1}{2}\\rho^I(-u^I)^2 = E^I$。在内部状态 $U^I=[\\rho^I, \\rho^I u^I, E^I]^\\top$ 和镜像状态 $U^W=[\\rho^I, -\\rho^I u^I, E^I]^\\top$ 之间构造一个 EC 通量时，我们观察到一个特定的对称模式。即，状态向量的第一和第三个分量是对称的，而第二个（动量）分量是反对称的。所有用于欧拉方程的 EC 通量的标准构造（例如，基于参数向量平均或对数平均的构造）都被设计成如果跨界面的平均速度为零，则质量和能量通量也为零。在这里，平均速度为 $\\frac{1}{2}(u^I + u^W) = \\frac{1}{2}(u^I - u^I) = 0$。因此，EC 通量向量的第一（质量）和第三（能量）分量为零：$F^{\\mathrm{ec}}_1(U^I, U^W) = 0$ 和 $F^{\\mathrm{ec}}_3(U^I, U^W) = 0$。这意味着边界条件的 EC 部分正确地施加了穿过壁面的零质量和零能量输运，这是无粘、绝热壁面的物理条件。这是维持整个格式的动能守恒（KEP）特性的一个关键方面，因为它防止了在边界处非物理的能量注入或提取。\n\n现在考虑耗散项 $-\\frac{1}{2}d\\,\\mathcal{D}$。算子 $\\mathcal{D}(U^I, U^W)$ 被描述为一个相容的状态差分算子。它的作用必须与状态向量的跳跃 $U^I - U^W$ 成正比。\n$$\nU^I - U^W = \\begin{pmatrix} \\rho^I - \\rho^W \\\\ \\rho^I u^I - \\rho^W u^W \\\\ E^I - E^W \\end{pmatrix} = \\begin{pmatrix} \\rho^I - \\rho^I \\\\ \\rho^I u^I - \\rho^I (-u^I) \\\\ E^I - E^I \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2\\rho^I u^I \\\\ 0 \\end{pmatrix}\n$$\n由于跳跃仅在动量分量上非零，耗散算子 $\\mathcal{D}$ 也只作用于动量方程。这是非常有益的。边界通量 $F^*$ 的质量和能量分量为零，因此边界条件不会直接改变邻近壁面单元中的密度 $\\rho$ 或总能量 $E$。然而，它确实对动量 $\\rho u$ 施加了一个耗散力。压力由 $p = (\\gamma-1)(E - \\frac{1}{2\\rho}(\\rho u)^2)$ 给出。在强压缩期间，入射速度 $u^I$ 可能很大，导致一个大的动能项 $\\frac{1}{2\\rho}(\\rho u)^2$。一个数值格式可能会过冲，导致这个动能项超过总能量 $E$，从而产生负内能，进而导致负压。耗散项通过仅作用于动量，减小了邻近壁面单元中 $|\\rho u|$ 的大小。由于边界通量守恒 $E$，动能 $\\frac{1}{2\\rho}(\\rho u)^2$ 的减少必然导致内能 $E_{int} = E - \\frac{1}{2\\rho}(\\rho u)^2$ 的增加。这种动能到内能的转换是对抗负压形成的物理机制。\n\n最后，我们推导最小标量耗散系数 $d_{\\min}$。问题明确指出，如果 $d$ 超过在邻近壁面状态 $U^I$ 处评估的法向通量雅可比矩阵 $A(U) = \\frac{\\partial F}{\\partial U}$ 的谱半径，则 SBP-SAT 格式可被证明是熵稳定的。这是基于罚函数的双曲系统数值方法稳定性分析的一个标准结果。罚项必须足够强，以抑制任何可能违反边界条件的入射特征波。这些波的速度由通量雅可比矩阵的特征值给出。对于一维欧拉方程， $A(U)$ 的特征值为：\n$$\n\\lambda_1 = u, \\quad \\lambda_2 = u-a, \\quad \\lambda_3 = u+a\n$$\n其中 $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$ 是当地声速。谱半径 $\\rho(A)$ 是这些特征值绝对值的最大值：\n$$\n\\rho(A) = \\max \\left( |u|, |u-a|, |u+a| \\right)\n$$\n根据三角不等式， $|u \\pm a| \\le |u| + |a| = |u|+a$。等号在两种情况之一（$u+a$ 或 $u-a$）下成立，因此最大值为 $|u|+a$。因此，谱半径就是 $|u|+a$。为了稳定性，我们需要 $d \\ge \\rho(A(U^I))$。因此，保证稳定性的最小值为：\n$$\nd_{\\min} = \\rho(A(U^I)) = |u^I| + a^I\n$$\n这个关于 $d$ 的单一条件足以满足所有陈述的要求。它通过构造确保了熵稳定性。对于欧拉方程，这种稳定性也确保了密度和压力的正性保持，从而防止了问题中提到的伪负压。如上所述，其机制是针对动量分量的耗散。这个值也是所需的*最小值*，确保了格式不会过度耗散，这有助于保持精度并尊重 EC 通量为良好解析的流所建立的反射特性。将声速 $a^I$ 用邻近壁面位置给定的原始变量表示，得到系数的最终形式。所得表达式具有速度的量纲，与问题的要求一致。\n\n$$\nd_{\\min} = |u^I| + \\sqrt{\\frac{\\gamma p^I}{\\rho^I}}\n$$\n该表达式为边界上的人工耗散提供了必要的缩放，以确保在固壁强压缩的挑战性场景中获得鲁棒且物理上一致的数值解。",
            "answer": "$$\n\\boxed{|u^I| + \\sqrt{\\frac{\\gamma p^I}{\\rho^I}}}\n$$"
        }
    ]
}