## Applications and Interdisciplinary Connections

The preceding chapters have established the theoretical foundations of Summation-by-Parts (SBP) operators and their use in constructing high-order numerical schemes that are entropy-stable (ES) or kinetic-energy-preserving (KEP). These properties are not merely of abstract mathematical interest; they form the bedrock of modern, robust, and accurate simulation tools used across a spectrum of scientific and engineering disciplines. By discretely mimicking fundamental physical conservation laws, these structure-preserving discretizations provide a level of reliability that is essential for predictive simulations of complex fluid phenomena, from the [aerodynamics](@entry_id:193011) of a hypersonic vehicle to the dynamics of a turbulent astrophysical [accretion disk](@entry_id:159604).

This chapter transitions from theory to practice. We will explore how the core principles of SBP, ES, and KEP are applied to build complete, functional, and stable computational fluid dynamics (CFD) solvers. We will demonstrate their utility in addressing practical challenges such as the handling of complex geometries, the enforcement of physical boundary conditions, the treatment of viscous effects, and the capture of shock waves. The goal is to illustrate not only the *how* but also the *why*: why this structure-preserving philosophy leads to more robust and physically faithful numerical methods, bridging the gap between mathematical formalism and real-world application.

### Constructing a Complete, Provably Stable Scheme

A robust numerical scheme is more than its core [spatial discretization](@entry_id:172158). Stability must be maintained through [time integration](@entry_id:170891), on realistic curved geometries, and in the presence of strong nonlinearities. The structure-preserving framework provides a systematic approach to addressing each of these components.

#### Temporal Discretization and Stability

A stable [semi-discretization](@entry_id:163562) $\frac{d\boldsymbol{u}}{dt} = \boldsymbol{L}(\boldsymbol{u})$ that satisfies a [discrete entropy inequality](@entry_id:748505), such as $\frac{d}{dt} H(\boldsymbol{u}) \le 0$ for a convex entropy functional $H$, must be paired with a [time integration](@entry_id:170891) scheme that preserves this property. Not all [time integrators](@entry_id:756005) do. Strong-Stability-Preserving (SSP) Runge-Kutta methods are particularly well-suited for this task. An $s$-stage SSP-RK scheme can be written as a convex combination of forward-Euler steps. If the forward-Euler step itself is entropy-stable for a given time step $\Delta t_{\mathrm{FE}}$, then an SSP scheme can be proven to be entropy-stable under a modified time-step restriction $\Delta t \le C \cdot \Delta t_{\mathrm{FE}}$. The SSP coefficient $C$, which is determined by the specific Shu-Osher coefficients of the RK scheme, is found by ensuring that each effective time step within the internal stages of the method respects the forward-Euler stability limit. For many popular schemes, such as the classical third-order SSPRK(3,3), this coefficient is unity ($C=1$), meaning the scheme retains the full forward-Euler stability limit while achieving higher order accuracy in time .

#### Handling Complex Geometries: Curvilinear Grids

Real-world simulations are rarely performed on simple Cartesian domains. When a high-order method is applied to a general [curvilinear grid](@entry_id:1123319), the transformation from computational to physical coordinates introduces metric terms (e.g., the Jacobian of the mapping). A naive discretization can lead to a critical failure: the scheme may not be able to preserve a trivial uniform flow, a property known as free-stream preservation. This failure manifests as the generation of spurious forces or sources purely from the grid's curvature.

To avoid this, the discrete operators must satisfy a discrete analogue of the continuous metric identities, a condition known as the Geometric Conservation Law (GCL). For SBP-based schemes, a common and effective way to satisfy the GCL is to compute the metric terms in a "curl form" and ensure that the underlying SBP differentiation operators commute. For instance, in two dimensions with computational coordinates $(\xi, \eta)$, the discrete divergence of metric vectors can be shown to be zero if the discrete derivative operators $D_{\xi}$ and $D_{\eta}$ commute, i.e., $D_{\xi}D_{\eta} = D_{\eta}D_{\xi}$. This condition is automatically satisfied by standard tensor-product SBP operators. Fulfilling the GCL is not merely an issue of accuracy; it is a prerequisite for conservation. Failure to do so can violate the delicate cancellations required for proving [entropy conservation](@entry_id:749018), even if the underlying flux functions are perfectly designed  .

#### Managing Nonlinearities: De-aliasing and Split Forms

A central challenge in [high-order methods](@entry_id:165413) is [nonlinear instability](@entry_id:752642). When two polynomials of degree $N$ are multiplied, the result is a polynomial of degree $2N$. If this product is evaluated on a grid that can only uniquely represent polynomials up to degree $N$, aliasing occurs: the high-frequency content of the product is misinterpreted as low-frequency information, which can feed energy into the system and cause the simulation to become unstable. This is particularly problematic for standard Discontinuous Galerkin (DG) or [collocation methods](@entry_id:142690) applied to the convective terms of the Navier-Stokes equations, where under-integration of the volume term can lead to spurious growth of the discrete kinetic energy .

The structure-preserving framework offers two powerful remedies. The first is formal [de-aliasing](@entry_id:748234), where the nonlinear flux is explicitly projected back into the [polynomial space](@entry_id:269905) of degree $N$ before the derivative is taken. Using an [orthogonal projection](@entry_id:144168) with respect to the SBP norm matrix ensures that the resulting term is "seen" as a valid polynomial by the SBP operator, thereby restoring the crucial telescoping-sum property needed for stability proofs .

The second, and often preferred, approach is the use of split-form discretizations. Instead of discretizing the conservative form of the convective term, e.g., $\nabla \cdot (\boldsymbol{u} \otimes \boldsymbol{u})$, one discretizes an equivalent [non-conservative form](@entry_id:752551) that builds in a skew-symmetric structure. When combined with an SBP operator, this results in a discrete convective operator that is provably skew-symmetric with respect to the discrete [energy norm](@entry_id:274966). Consequently, its contribution to the global energy budget is identically zero, effectively eliminating the aliasing-driven instability mechanism. This is the foundation of [kinetic-energy-preserving schemes](@entry_id:1126920) and is a key feature of many modern entropy-stable methods   .

### Boundary and Interface Conditions: The Key to Realistic Problems

The stability of a numerical simulation is often determined at its boundaries. SBP-based [energy methods](@entry_id:183021) provide a rigorous framework for designing boundary conditions that are both physically accurate and numerically stable.

#### Weak Imposition of Boundary Conditions via SAT

A fundamental choice in implementing boundary conditions is between strong imposition (injection), where boundary node values are simply overwritten, and [weak imposition](@entry_id:1134007), where boundary conditions are enforced through penalty terms added to the semi-discrete equations. For SBP schemes, [weak imposition](@entry_id:1134007) via the Simultaneous Approximation Term (SAT) method is vastly superior.

Strong injection is non-conservative and can interfere with the delicate algebraic structure of the SBP operator near the boundary, potentially disrupting the stability proven by the [energy method](@entry_id:175874). In contrast, SATs are formulated as boundary fluxes that directly contribute to the discrete energy balance. By appropriately choosing the penalty parameters, one can design SATs that guarantee stability and mimic the energy fluxes of the continuous problem. This approach provides a tunable mechanism for boundary dissipation and is fully compatible with the KEP and ES frameworks, whereas strong injection generally breaks these properties .

##### Solid Walls

A common application is the [inviscid flow](@entry_id:273124) over a solid, reflective wall. The physical condition is zero normal velocity. Using the SAT methodology, this is enforced by defining a "ghost" state outside the domain. This ghost state is constructed to satisfy the physical boundary condition; for a reflective wall, it has the same density and pressure as the interior state but with a reflected normal velocity. An entropy-conservative numerical flux is then computed between the interior and ghost states, and the difference between this numerical flux and the physical flux is injected as a penalty term. This procedure ensures that the zero-normal-flux condition is met without spuriously generating numerical entropy at the wall, preserving the inviscid nature of the interaction .

##### Inflow/Outflow Conditions

At inflow and outflow boundaries, [weak imposition](@entry_id:1134007) via SATs allows for the stable prescription of far-field data and the implementation of [non-reflecting boundary conditions](@entry_id:174905).

For inflow, where variables like density, velocity, and pressure are specified, a stable SAT can be constructed by first converting these prescribed primitive variables into entropy variables. The penalty term then drives the solution's entropy variables at the boundary towards these prescribed values, a formulation that fits naturally into the entropy-stable framework .

For outflow boundaries, the goal is often to let waves exit the domain without reflecting back and contaminating the solution. This is achieved by transforming the governing equations into [characteristic variables](@entry_id:747282) at the boundary, which represent incoming and outgoing waves. A stable, non-reflecting SAT is constructed by penalizing only the incoming [characteristic variables](@entry_id:747282) (which are set to zero or a target value), while leaving the outgoing variables free. The magnitude of the [penalty parameter](@entry_id:753318) can be derived directly from an energy analysis to guarantee that the boundary treatment is dissipative and thus stable .

#### Non-Conforming and Multi-Block Interfaces

The SAT approach extends naturally to handling internal interfaces between different mesh blocks or regions of varying refinement (non-conforming grids). At such interfaces, conservation and stability are ensured by applying equal and opposite penalty terms on either side. This "flux-splitting" approach guarantees that the interface is transparent to the global energy balance.

For non-conforming interfaces, where a coarse element faces multiple fine elements, a [mortar method](@entry_id:167336) is employed. Solution values are passed between the grids via $L^2$-[projection operators](@entry_id:154142). Again, a stable coupling can be designed using SATs with a compatible numerical flux. To preserve properties like kinetic energy conservation across the interface, the [numerical flux](@entry_id:145174) itself must be carefully designed. For example, the convective momentum flux must use a specific velocity average (the arithmetic mean) to ensure that kinetic energy is conserved across the coarse-fine interface  .

### Extending the Framework: From Ideal to Complex Physics

The power of the structure-preserving framework lies in its extensibility to more complex physical models, such as [viscous flows](@entry_id:136330) and flows with shock waves.

#### Viscous Flows: The Navier-Stokes Equations

To simulate [viscous flows](@entry_id:136330), the Euler equations are extended to the Navier-Stokes equations by adding viscous flux terms, which depend on the gradient of the state variables. A naive discretization of these terms can violate the second law of thermodynamics, which demands that viscosity be a purely dissipative process that generates entropy.

An entropy-stable discretization of the viscous terms is achieved by reformulating them in terms of the gradient of the entropy variables, $\partial_x \boldsymbol{v}$, instead of the conservative variables, $\partial_x \boldsymbol{u}$. The viscous flux is written as $\boldsymbol{f}^{\mathrm{V}} = -K(\boldsymbol{u}) \partial_x \boldsymbol{v}$. When this form is used in the entropy analysis, the contribution from the viscous terms appears as a [quadratic form](@entry_id:153497) $(\partial_x \boldsymbol{v})^T K(\boldsymbol{u}) (\partial_x \boldsymbol{v})$. If the matrix $K(\boldsymbol{u})$ can be shown to be symmetric and positive semi-definite, the viscous terms are guaranteed to contribute non-negatively to [entropy production](@entry_id:141771), thus ensuring stability. The transformation from the standard physical viscosity matrix to the entropy-[variable viscosity](@entry_id:756431) matrix $K(\boldsymbol{u})$ can be derived directly via the [chain rule](@entry_id:147422) and involves the inverse of the entropy Hessian .

#### Discontinuous Flows: Shock Capturing

High-order methods are notoriously prone to severe oscillations (Gibbs phenomena) near discontinuities like shock waves. Entropy-stable schemes provide a powerful foundation for controlling these instabilities. The baseline scheme is often entropy-conservative, meaning it generates no numerical entropy and is suitable only for smooth flows. To handle shocks, this [conservative scheme](@entry_id:747714) is augmented with a carefully designed numerical dissipation term.

Modern shock-capturing strategies add this dissipation in a way that is consistent with the entropy framework. One successful approach is to add a diffusion term proportional to the jump in entropy variables, which can be proven to be entropy-stable . Another is to blend the high-order scheme with a robust, entropy-stable [finite volume method](@entry_id:141374) in troubled cells. This ensures that in regions with shocks, the scheme produces the physically required entropy and remains stable, while in smooth regions, the dissipation vanishes, recovering the high-order, non-dissipative behavior of the baseline scheme. This is a significant advantage over traditional artificial viscosity methods, which are not aligned with the entropy dynamics and may not guarantee stability .

The design of the dissipative term often draws inspiration from classic approximate Riemann solvers. For instance, the numerical dissipation matrix in an ES scheme can be related to the matrices used in Roe or HLL fluxes. An entropy analysis reveals why a standard Roe flux requires an "[entropy fix](@entry_id:749021)" to prevent entropy violation at sonic points, and why an HLL flux, while robustly entropy-stable, is often more dissipative for contact discontinuities. The ES framework provides a unifying lens through which to analyze and improve upon these classical methods .

### Conceptual Synthesis: Kinetic Energy Preservation versus Entropy Stability

Throughout this chapter, we have referred to two key structure-preserving properties: kinetic-energy preservation (KEP) and [entropy stability](@entry_id:749023) (ES). It is crucial to understand their distinct roles and relationship.

**Kinetic-energy preservation** generally refers to the conservation of the discrete kinetic energy, $\frac{1}{2} \int |u_h|^2 dx$, by the convective terms of the discretization. As discussed, this is achieved by constructing a discretely skew-symmetric convective operator using split forms and SBP properties. For incompressible flow, where kinetic energy is the only relevant energy, this property is synonymous with stability. For compressible flow, KEP refers only to the non-dissipative nature of the advective transport; it does not account for the transfer of energy between kinetic and internal forms via [pressure work](@entry_id:265787), nor does it provide stability in the presence of shocks .

**Entropy stability**, on the other hand, is a more powerful and comprehensive stability principle for [compressible flows](@entry_id:747589). It ensures that a discrete version of a convex mathematical entropy, $\int U(\boldsymbol{q}_h) dx$, is non-increasing (or is conserved for smooth flows). Because the entropy $U$ is a [convex function](@entry_id:143191) of the *entire* state vector (density, momentum, and total energy), controlling its growth provides a robust [nonlinear stability](@entry_id:1128872) guarantee for the entire system. This is what prevents catastrophic instabilities in simulations with strong shocks or contact discontinuities.

The two properties can coexist. A state-of-the-art entropy-stable scheme for the Euler equations is often built from a baseline flux that is both entropy-conservative *and* kinetic-energy-preserving. This ensures that for smooth, resolved flows, the scheme is minimally dissipative and respects the distinct transport mechanisms of entropy and kinetic energy. When shock-capturing dissipation is added to this baseline flux, the scheme becomes entropy-stable but generally loses the exact KEP property, as the numerical dissipation required for shock stability will typically also dissipate kinetic energy. This, however, is often physically desirable, as shocks irreversibly convert kinetic energy into internal energy  . In essence, KEP provides an elegant structure for the non-dissipative part of the scheme, while ES provides the overarching [nonlinear stability](@entry_id:1128872) necessary to handle the full complexity of compressible fluid dynamics.