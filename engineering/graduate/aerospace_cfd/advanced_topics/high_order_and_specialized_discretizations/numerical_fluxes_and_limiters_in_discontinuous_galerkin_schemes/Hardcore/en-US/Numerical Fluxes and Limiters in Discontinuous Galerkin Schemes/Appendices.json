{
    "hands_on_practices": [
        {
            "introduction": "The choice of numerical flux is central to the accuracy and stability of any Discontinuous Galerkin scheme. This exercise provides a foundational comparison between two archetypal fluxes by tasking you with their computation for the inviscid Burgers' equation, a simple yet illustrative nonlinear model. By deriving the Godunov flux from the exact Riemann solution and comparing it to the more diffusive Lax-Friedrichs flux, you will gain a first-hand understanding of the concept of numerical dissipation and its role in stabilizing solutions near shocks .",
            "id": "3982038",
            "problem": "Consider the scalar conservation law for the inviscid Burgers equation in nondimensional form, given by $u_{t} + f(u)_{x} = 0$ with flux $f(u) = \\frac{u^{2}}{2}$. In a one-dimensional discontinuous Galerkin (DG) discretization with a piecewise linear polynomial per cell, interface states are reconstructed using a Total Variation Diminishing (TVD) minmod limiter to control spurious oscillations. For a particular interface $x_{i+\\frac{1}{2}}$, suppose the limited left and right reconstructed states are $u_{L} = 0.8$ and $u_{R} = -0.2$.\n\nUsing first principles for hyperbolic conservation laws and their Riemann problems:\n\n- Compute the Godunov flux at $x_{i+\\frac{1}{2}}$ by invoking the exact self-similar Riemann solution for the inviscid Burgers equation, consistent with conservation and entropy conditions.\n- Compute the Lax–Friedrichs numerical flux at $x_{i+\\frac{1}{2}}$ using the standard symmetric form with a dissipation parameter chosen as the maximum characteristic speed magnitude appropriate for the inviscid Burgers equation, i.e., $\\alpha = \\max\\!\\big(|u_{L}|, |u_{R}|\\big)$.\n\nFinally, compute the difference $F_{\\mathrm{LF}} - F_{\\mathrm{G}}$ between the Lax–Friedrichs flux and the Godunov flux at this interface. Express the final answer as a unitless number and round your answer to four significant figures.",
            "solution": "The user wants me to solve the following problem:\nConsider the scalar conservation law for the inviscid Burgers equation in nondimensional form, given by $u_{t} + f(u)_{x} = 0$ with flux $f(u) = \\frac{u^{2}}{2}$. In a one-dimensional discontinuous Galerkin (DG) discretization with a piecewise linear polynomial per cell, interface states are reconstructed using a Total Variation Diminishing (TVD) minmod limiter to control spurious oscillations. For a particular interface $x_{i+\\frac{1}{2}}$, suppose the limited left and right reconstructed states are $u_{L} = 0.8$ and $u_{R} = -0.2$.\n\nUsing first principles for hyperbolic conservation laws and their Riemann problems:\n\n- Compute the Godunov flux at $x_{i+\\frac{1}{2}}$ by invoking the exact self-similar Riemann solution for the inviscid Burgers equation, consistent with conservation and entropy conditions.\n- Compute the Lax–Friedrichs numerical flux at $x_{i+\\frac{1}{2}}$ using the standard symmetric form with a dissipation parameter chosen as the maximum characteristic speed magnitude appropriate for the inviscid Burgers equation, i.e., $\\alpha = \\max\\!\\big(|u_{L}|, |u_{R}|\\big)$.\n\nFinally, compute the difference $F_{\\mathrm{LF}} - F_{\\mathrm{G}}$ between the Lax–Friedrichs flux and the Godunov flux at this interface. Express the final answer as a unitless number and round your answer to four significant figures.\n\n### Step 1: Extract Givens\n- Conservation Law: $u_{t} + f(u)_{x} = 0$\n- Flux function: $f(u) = \\frac{u^{2}}{2}$\n- Left state at interface $x_{i+\\frac{1}{2}}$: $u_{L} = 0.8$\n- Right state at interface $x_{i+\\frac{1}{2}}$: $u_{R} = -0.2$\n- Dissipation parameter for Lax–Friedrichs flux: $\\alpha = \\max(|u_{L}|, |u_{R}|)$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard exercise in numerical methods for hyperbolic conservation laws, specifically focusing on the well-known Burgers equation. It uses established concepts like the Godunov and Lax-Friedrichs numerical fluxes, which are fundamental to the field of computational fluid dynamics. The problem is well-posed, providing all necessary information ($u_L$, $u_R$, flux function, dissipation parameter rule) to uniquely determine the required quantities. The language is objective and precise. The problem is self-contained and consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe problem requires a three-step calculation: first, the Godunov flux $F_{\\mathrm{G}}$; second, the Lax-Friedrichs flux $F_{\\mathrm{LF}}$; and third, their difference $F_{\\mathrm{LF}} - F_{\\mathrm{G}}$.\n\n**1. Computation of the Godunov Flux ($F_{\\mathrm{G}}$)**\n\nThe Godunov flux is determined by the exact solution to the Riemann problem at the interface. The Riemann problem for the Burgers equation is defined by the initial condition:\n$$u(x,0) = \\begin{cases} u_{L}  \\text{if } x  0 \\\\ u_{R}  \\text{if } x  0 \\end{cases}$$\nwith $u_{L} = 0.8$ and $u_{R} = -0.2$. The characteristic speed is given by $a(u) = f'(u) = u$.\n\nSince the characteristic speed of the left state, $a(u_{L}) = u_{L} = 0.8$, is greater than the characteristic speed of the right state, $a(u_{R}) = u_{R} = -0.2$, the characteristics will intersect, forming a shock wave. The speed of this shock, $s$, is determined by the Rankine-Hugoniot jump condition:\n$$s = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}$$\nFor the Burgers equation, this simplifies to:\n$$s = \\frac{\\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2}}{u_{R} - u_{L}} = \\frac{1}{2} \\frac{(u_{R}-u_{L})(u_{R}+u_{L})}{u_{R}-u_{L}} = \\frac{u_{L} + u_{R}}{2}$$\nSubstituting the given values:\n$$s = \\frac{0.8 + (-0.2)}{2} = \\frac{0.6}{2} = 0.3$$\nWe must verify that this shock satisfies the Lax entropy condition, which states that characteristics must flow into the shock: $a(u_{L}) > s > a(u_{R})$.\n$$0.8 > 0.3 > -0.2$$\nThe condition is satisfied.\n\nThe self-similar solution to the Riemann problem is a function of $\\xi = x/t$. As the shock speed $s = 0.3$ is positive, the shock front moves to the right. For any time $t > 0$, the state at the interface location $x=0$ (i.e., $\\xi=0$) is the state to the left of the shock, which is $u_{L}$.\nTherefore, the state to be used for the Godunov flux calculation is $u_{\\mathrm{G}} = u_{L} = 0.8$.\nThe Godunov flux is then:\n$$F_{\\mathrm{G}} = f(u_{\\mathrm{G}}) = f(u_{L}) = \\frac{1}{2}u_{L}^{2} = \\frac{1}{2}(0.8)^{2} = \\frac{1}{2}(0.64) = 0.32$$\n\n**2. Computation of the Lax–Friedrichs Flux ($F_{\\mathrm{LF}}$)**\n\nThe Lax-Friedrichs numerical flux (also known as the Rusanov flux) is given by the formula:\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ f(u_{L}) + f(u_{R}) - \\alpha(u_{R} - u_{L}) \\right]$$\nThe dissipation parameter $\\alpha$ is defined as the maximum magnitude of the characteristic speeds at the interface:\n$$\\alpha = \\max(|a(u_L)|, |a(u_R)|) = \\max(|u_{L}|, |u_{R}|)$$\nSubstituting the given values:\n$$\\alpha = \\max(|0.8|, |-0.2|) = \\max(0.8, 0.2) = 0.8$$\nNext, we compute the flux values for the left and right states:\n$$f(u_{L}) = \\frac{1}{2}u_{L}^{2} = \\frac{1}{2}(0.8)^{2} = 0.32$$\n$$f(u_{R}) = \\frac{1}{2}u_{R}^{2} = \\frac{1}{2}(-0.2)^{2} = \\frac{1}{2}(0.04) = 0.02$$\nNow we substitute these quantities into the Lax-Friedrichs flux formula:\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ (0.32) + (0.02) - (0.8)((-0.2) - (0.8)) \\right]$$\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ 0.34 - 0.8(-1.0) \\right]$$\n$$F_{\\mathrm{LF}} = \\frac{1}{2} \\left[ 0.34 + 0.8 \\right]$$\n$$F_{\\mathrm{LF}} = \\frac{1}{2} (1.14) = 0.57$$\n\n**3. Computation of the Difference**\n\nThe final step is to compute the difference between the Lax-Friedrichs flux and the Godunov flux:\n$$F_{\\mathrm{LF}} - F_{\\mathrm{G}} = 0.57 - 0.32 = 0.25$$\nThe problem requires the answer to be rounded to four significant figures. This gives $0.2500$.",
            "answer": "$$\\boxed{0.2500}$$"
        },
        {
            "introduction": "The theoretical elegance and stability of the Discontinuous Galerkin method rely on precise mathematical cancellations that occur when its weak form is derived. In practice, however, we rely on numerical quadrature to evaluate the integrals, which can introduce errors that compromise these properties. This exercise  challenges you to determine the minimum quadrature accuracy required to exactly integrate the face flux terms, a critical step for preserving the scheme's stability and exploring the subtle consequences of underintegration.",
            "id": "3981997",
            "problem": "Consider the scalar linear advection equation in three dimensions,\n$$\n\\frac{\\partial u}{\\partial t} + \\nabla \\cdot \\big( \\boldsymbol{a}\\, u \\big) = 0,\n$$\nwith constant advection velocity $\\boldsymbol{a} \\in \\mathbb{R}^{3}$. The spatial domain is partitioned into affine simplicial elements with planar faces and constant face normals. A Discontinuous Galerkin (DG) method is used with trial and test spaces consisting of polynomials of total degree at most $p$ on each element. Let $u_{h}$ denote the DG approximation and let $\\phi_{h}$ denote a generic DG test function, both belonging to the polynomial space of degree at most $p$ on each element. The face term in the weak formulation involves the numerical flux $\\hat{f}$ and has the generic form\n$$\n\\sum_{F \\in \\partial K} \\int_{F} \\hat{f}\\big(u_{h}^{-}, u_{h}^{+}; \\boldsymbol{n}_{F}\\big) \\cdot \\boldsymbol{n}_{F}\\, \\phi_{h}\\, \\mathrm{d}s,\n$$\nwhere $u_{h}^{-}$ and $u_{h}^{+}$ are the traces from the interior and exterior of element $K$, respectively, and $\\boldsymbol{n}_{F}$ is the outward unit normal for face $F$. Assume an upwind numerical flux for linear advection,\n$$\n\\hat{f}\\big(u_{h}^{-}, u_{h}^{+}; \\boldsymbol{n}_{F}\\big) \\cdot \\boldsymbol{n}_{F} = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_{F})\\, u_{\\mathrm{up}},\n$$\nwhere $u_{\\mathrm{up}}$ equals $u_{h}^{-}$ when $(\\boldsymbol{a} \\cdot \\boldsymbol{n}_{F}) \\ge 0$ and equals $u_{h}^{+}$ otherwise. The surface integral on each face is approximated by a quadrature rule that is exact for all polynomials on that face up to some degree $D$.\n\nStarting from the principles of the DG weak form, polynomial approximation properties, and the definition of upwind numerical flux for linear advection, determine the minimal polynomial exactness degree $D_{\\min}(p)$ required of the face quadrature so that, for arbitrary $u_{h}$ and $\\phi_{h}$ in the degree-$p$ DG space, the face flux integral is computed exactly by the quadrature on every face. Then, analyze from first principles how choosing a face quadrature with exactness degree $D  D_{\\min}(p)$ (underintegration) impacts:\n- Discrete conservation of element averages (mass) in the semidiscrete DG formulation, and\n- The $L^2$-type energy stability of the semidiscrete scheme under the upwind numerical flux.\n\nYou may assume affine element mappings, planar faces with constant $\\boldsymbol{n}_{F}$, and that both sides of any interior face employ the same set of quadrature nodes and weights to evaluate the single-valued numerical flux. Express your final answer as a closed-form analytical expression for $D_{\\min}(p)$ in terms of $p$. No numerical rounding is required, and no physical units are involved in the final answer. Computational Fluid Dynamics (CFD) context applies; in your analysis, briefly comment on how slope limiters or nonlinear stabilization interact with underintegration-induced errors without changing $D_{\\min}(p)$.",
            "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Governing Equation:** The scalar linear advection equation in three dimensions is $\\frac{\\partial u}{\\partial t} + \\nabla \\cdot \\big( \\boldsymbol{a}\\, u \\big) = 0$.\n- **Advection Velocity:** $\\boldsymbol{a} \\in \\mathbb{R}^{3}$ is a constant vector.\n- **Discretization:** The domain is partitioned into affine simplicial elements ($K$) with planar faces ($F$).\n- **DG Polynomial Space:** The trial functions ($u_h$) and test functions ($\\phi_h$) are polynomials of total degree at most $p$ on each element $K$. Let this space be denoted $\\mathcal{P}_p(K)$.\n- **Weak Form Face Term:** The term is $\\sum_{F \\in \\partial K} \\int_{F} \\hat{f}\\big(u_{h}^{-}, u_{h}^{+}; \\boldsymbol{n}_{F}\\big) \\cdot \\boldsymbol{n}_{F}\\, \\phi_{h}\\, \\mathrm{d}s$. Here, $u_{h}^{-}$ and $u_{h}^{+}$ are the interior and exterior traces of the solution on a face $F$ of element $K$, and $\\boldsymbol{n}_{F}$ is the outward unit normal.\n- **Numerical Flux:** The upwind numerical flux is given by $\\hat{f}\\big(u_{h}^{-}, u_{h}^{+}; \\boldsymbol{n}_{F}\\big) \\cdot \\boldsymbol{n}_{F} = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_{F})\\, u_{\\mathrm{up}}$.\n- **Upwind State:** $u_{\\mathrm{up}} = u_{h}^{-}$ if $(\\boldsymbol{a} \\cdot \\boldsymbol{n}_{F}) \\ge 0$, and $u_{\\mathrm{up}} = u_{h}^{+}$ if $(\\boldsymbol{a} \\cdot \\boldsymbol{n}_{F})  0$.\n- **Quadrature:** The face integrals are approximated by a quadrature rule that is exact for polynomials on the face up to degree $D$.\n- **Assumptions:** Element mappings are affine, faces are planar (constant $\\boldsymbol{n}_{F}$), and the same quadrature rule is used on both sides of any interior face.\n- **Objectives:**\n    1. Determine the minimal polynomial exactness degree $D_{\\min}(p)$ for the face quadrature to compute the face flux integral exactly.\n    2. Analyze the impact of underintegration ($D  D_{\\min}(p)$) on discrete conservation of element averages and $L^2$-energy stability.\n    3. Briefly comment on the interaction of underintegration with slope limiters.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard Discontinuous Galerkin formulation for a fundamental partial differential equation. The definitions, assumptions, and objectives are clear, consistent, and formalizable within the established mathematical framework of numerical analysis for PDEs. The problem does not violate any scientific principles, is not based on false premises, and contains all necessary information for a rigorous analysis. The questions posed are central to the theory and practice of DG methods.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution\n\nThe analysis proceeds in three parts as requested by the problem statement.\n\n**Part 1: Determination of Minimal Quadrature Exactness Degree $D_{\\min}(p)$**\n\nThe integral that must be computed exactly by the face quadrature for an element $K$ is the face term in the weak formulation:\n$$\n\\int_{F} \\hat{f}\\big(u_{h}^{-}, u_{h}^{+}; \\boldsymbol{n}_{F}\\big) \\cdot \\boldsymbol{n}_{F}\\, \\phi_{h}\\, \\mathrm{d}s\n$$\nSubstituting the given definition of the upwind numerical flux, the integrand becomes:\n$$\n\\text{Integrand} = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_{F})\\, u_{\\mathrm{up}}\\, \\phi_{h}\n$$\nWe must determine the maximal polynomial degree of this integrand on a face $F$.\n- The advection velocity $\\boldsymbol{a}$ is a constant vector. As the elements have planar faces, the outward unit normal $\\boldsymbol{n}_{F}$ is also a constant vector on face $F$. Therefore, their dot product, $\\boldsymbol{a} \\cdot \\boldsymbol{n}_{F}$, is a scalar constant across the face $F$.\n- The DG approximation $u_h$ is a polynomial of total degree at most $p$ in the coordinates of the element $K$. The trace of such a polynomial onto a planar face $F$ is a polynomial of total degree at most $p$ in the coordinates of that face. Both $u_h^{-}$ and $u_h^{+}$ are such traces.\n- The upwind state $u_{\\mathrm{up}}$ is chosen to be either $u_h^{-}$ or $u_h^{+}$, depending on the sign of the constant $\\boldsymbol{a} \\cdot \\boldsymbol{n}_{F}$. In either case, $u_{\\mathrm{up}}$ is a polynomial of degree at most $p$ on the face $F$.\n- The test function $\\phi_h$ is selected from the same polynomial space as $u_h$. Its trace on the face $F$ is also a polynomial of degree at most $p$.\n- The integrand is therefore the product of a constant $(\\boldsymbol{a} \\cdot \\boldsymbol{n}_{F})$, a polynomial $u_{\\mathrm{up}}$ of degree at most $p$, and a polynomial $\\phi_h$ of degree at most $p$. The product of two polynomials of degree $p_1$ and $p_2$ is a polynomial of degree $p_1 + p_2$.\n- Consequently, the product $u_{\\mathrm{up}} \\phi_h$ is a polynomial on the face $F$ of total degree at most $p + p = 2p$.\n\nFor a quadrature rule to compute the integral of this polynomial exactly, it must be exact for all polynomials up to that degree. Therefore, the minimal required degree of exactness $D$ for the face quadrature is $2p$.\n$$\nD_{\\min}(p) = 2p\n$$\n\n**Part 2: Analysis of Underintegration ($D  D_{\\min}(p)$)**\n\nWe analyze the impact of using a quadrature rule with an exactness degree $D  2p$ on conservation and stability. Let $I_F[\\cdot]$ denote the quadrature operator on face $F$.\n\n**2a. Discrete Conservation of Element Averages**\n\nThe semidiscrete weak form for an element $K$ is:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h \\phi_h \\, \\mathrm{d}V - \\int_K (\\boldsymbol{a} u_h) \\cdot \\nabla \\phi_h \\, \\mathrm{d}V + \\sum_{F \\in \\partial K} I_F\\Big[ (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) u_{\\mathrm{up}} \\phi_h \\Big] = 0\n$$\nTo assess the conservation of the element average (or \"mass\"), $\\int_K u_h \\, \\mathrm{d}V$, we choose the test function $\\phi_h = 1$. Since $p \\ge 0$, $\\phi_h=1$ is a valid test function. For this choice, $\\nabla \\phi_h = 0$, and the weak form simplifies to:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h \\, \\mathrm{d}V = - \\sum_{F \\in \\partial K} I_F\\Big[ (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) u_{\\mathrm{up}} \\Big]\n$$\nThis equation states that the rate of change of mass in element $K$ is equal to the negative of the total numerical flux out of its boundary. This is the statement of local conservation at the discrete level.\n\nGlobal conservation requires that when summing over all elements in the domain, the contributions from interior faces cancel. Consider an interior face $F$ shared by two elements, $K_1$ and $K_2$. Let their respective traces be $u_1$ and $u_2$, and their normals be $\\boldsymbol{n}_1$ and $\\boldsymbol{n}_2 = -\\boldsymbol{n}_1$. The total flux across this face in the global sum is:\n$$\nI_F\\Big[ (\\boldsymbol{a} \\cdot \\boldsymbol{n}_1) u_{\\mathrm{up}}(u_1, u_2, \\boldsymbol{n}_1) \\Big] + I_F\\Big[ (\\boldsymbol{a} \\cdot \\boldsymbol{n}_2) u_{\\mathrm{up}}(u_2, u_1, \\boldsymbol{n}_2) \\Big]\n$$\nThe upwind flux is conservative, meaning its definition ensures flux consistency and conservation at the continuous level: $\\hat{f}(u_1, u_2, \\boldsymbol{n}_1) \\cdot \\boldsymbol{n}_1 + \\hat{f}(u_2, u_1, \\boldsymbol{n}_2) \\cdot \\boldsymbol{n}_2 = 0$. Let's verify:\n- If $\\boldsymbol{a} \\cdot \\boldsymbol{n}_1 \\ge 0$, then $\\boldsymbol{a} \\cdot \\boldsymbol{n}_2 \\le 0$. The flux sum is $(\\boldsymbol{a} \\cdot \\boldsymbol{n}_1)u_1 + (\\boldsymbol{a} \\cdot \\boldsymbol{n}_2)u_1 = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_1)u_1 - (\\boldsymbol{a} \\cdot \\boldsymbol{n}_1)u_1 = 0$.\n- If $\\boldsymbol{a} \\cdot \\boldsymbol{n}_1  0$, then $\\boldsymbol{a} \\cdot \\boldsymbol{n}_2  0$. The flux sum is $(\\boldsymbol{a} \\cdot \\boldsymbol{n}_1)u_2 + (\\boldsymbol{a} \\cdot \\boldsymbol{n}_2)u_2 = (\\boldsymbol{a} \\cdot \\boldsymbol{n}_1)u_2 - (\\boldsymbol{a} \\cdot \\boldsymbol{n}_1)u_2 = 0$.\nThe integrand of the summed discrete flux is identically zero point-wise on the face. Since the quadrature operator $I_F[\\cdot]$ is linear and the same rule is used from both sides of the face:\n$$\nI_F\\Big[ (\\boldsymbol{a} \\cdot \\boldsymbol{n}_1) u_{\\mathrm{up},1} + (\\boldsymbol{a} \\cdot \\boldsymbol{n}_2) u_{\\mathrm{up},2} \\Big] = I_F[0] = 0\n$$\nThis cancellation is algebraic and occurs before quadrature is applied. Thus, it holds regardless of the quadrature's degree of exactness $D$.\n**Conclusion on conservation:** Underintegration does not affect the discrete conservation of element averages, provided the numerical flux is conservative and the same quadrature is used on both sides of an interior face.\n\n**2b. $L^2$-type Energy Stability**\n\nTo analyze $L^2$-stability, we set the test function $\\phi_h = u_h$. The weak form for element $K$ becomes:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h^2 \\, \\mathrm{d}V - \\int_K (\\boldsymbol{a} u_h) \\cdot \\nabla u_h \\, \\mathrm{d}V + \\sum_{F \\in \\partial K} I_F\\Big[ (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) u_{\\mathrm{up}} u_h^{-} \\Big] = 0\n$$\nThe volume integral term can be rewritten using the identity $\\nabla u_h \\cdot u_h = \\frac{1}{2}\\nabla(u_h^2)$ and the divergence theorem (since $\\boldsymbol{a}$ is constant):\n$$\n\\int_K (\\boldsymbol{a} u_h) \\cdot \\nabla u_h \\, \\mathrm{d}V = \\frac{1}{2} \\int_K \\boldsymbol{a} \\cdot \\nabla(u_h^2) \\, \\mathrm{d}V = \\frac{1}{2} \\int_K \\nabla \\cdot (\\boldsymbol{a} u_h^2) \\, \\mathrm{d}V = \\frac{1}{2} \\sum_{F \\in \\partial K} \\int_F (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) (u_h^{-})^2 \\, \\mathrm{d}s\n$$\nSubstituting this into the weak form and multiplying by $2$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h^2 \\, \\mathrm{d}V = \\sum_{F \\in \\partial K} \\left( \\int_F (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) (u_h^{-})^2 \\, \\mathrm{d}s - 2 I_F\\Big[ (\\boldsymbol{a} \\cdot \\boldsymbol{n}_F) u_{\\mathrm{up}} u_h^{-} \\Big] \\right)\n$$\nSumming over all elements $K$ gives the rate of change of the global $L^2$-norm squared, $\\|u_h\\|_{L^2(\\Omega)}^2 = \\sum_K \\int_K u_h^2 \\, \\mathrm{d}V$. For interior faces, terms are paired. The total contribution from an interior face $F$ (with normal $\\boldsymbol{n}$ from $K_1$ to $K_2$ and traces $u_1, u_2$) to the right-hand side is:\n$$\n\\int_F (\\boldsymbol{a} \\cdot \\boldsymbol{n})(u_1^2 - u_2^2) \\, \\mathrm{d}s - 2 I_F\\Big[ (\\boldsymbol{a} \\cdot \\boldsymbol{n}) \\big(u_{\\mathrm{up}}(u_1,u_2,\\boldsymbol{n})u_1 - u_{\\mathrm{up}}(u_2,u_1,-\\boldsymbol{n})u_2 \\big) \\Big]\n$$\nIf quadrature is exact ($D \\ge 2p$), $I_F[\\cdot]$ can be replaced with $\\int_F[\\cdot]\\mathrm{d}s$. The entire expression simplifies to $-\\int_F |\\boldsymbol{a} \\cdot \\boldsymbol{n}|(u_1-u_2)^2 \\, \\mathrm{d}s$. This term is non-positive, representing energy dissipation at discontinuities, which proves stability.\n\nHowever, if quadrature is not exact ($D  2p$), the integrands $(u_h^{-})^2$ and $u_{\\mathrm{up}} u_h^{-}$ are polynomials of degree up to $2p$. The integrals and quadrature approximations no longer match: $\\int_F \\neq I_F$. The delicate cancellation that leads to the non-positive dissipation term is broken. The resulting expression contains aliasing errors from the inexact quadrature:\n$$\n\\text{Error term for face F} = \\left( \\int_F \\dots \\mathrm{d}s - I_F[\\dots] \\right)\n$$\nThis error term does not have a definite sign. It can be positive, leading to a spurious production of energy in the discrete system.\n**Conclusion on stability:** Underintegration ($D  D_{\\min}(p) = 2p$) destroys the mathematical proof of $L^2$-stability for the semidiscrete upwind DG scheme. The aliasing errors introduced by the inexact face quadrature can act as a source of energy, potentially leading to numerical instability.\n\n**Part 3: Interaction with Slope Limiters**\n\nSlope limiters are nonlinear filtering procedures applied to the polynomial solution $u_h$ to enforce monotonicity, typically near discontinuities, thereby preventing non-physical oscillations.\nThe formal derivation of $D_{\\min}(p) = 2p$ assumes that the solution and test functions fully occupy the polynomial space $\\mathcal{P}_p$. A limiter modifies $u_h$, often reducing its effective polynomial degree in regions where it is active. For example, it might project $u_h$ onto a $\\mathcal{P}_1$ space.\n\nHowever, the choice of quadrature must be sufficient for the un-limited case for several reasons:\n1. The test function space remains $\\mathcal{P}_p$, so the term $\\hat{f} \\phi_h$ can still reach a high polynomial degree.\n2. The stability analysis is based on the properties of the underlying Galerkin formulation. Underintegration compromises this foundation, introducing errors that are not what the limiter is designed to handle. A limiter is designed to control physical oscillations (Gibbs phenomenon), not cure aliasing errors from quadrature.\n3. While a limiter may suppress the growth of instabilities caused by underintegration—acting as a numerical safety net by adding artificial diffusion—it does not rectify the source of the error. The aliasing errors can still pollute the solution, for instance by altering wave propagation speeds or dissipation rates, even if the scheme does not catastrophically fail.\n\nIn summary, slope limiting does not change the formal requirement that $D_{\\min}(p)=2p$ for the baseline DG scheme to be provably stable. It is a separate stabilization mechanism that may mask the symptoms of underintegration-induced instability, but it does not fix the underlying mathematical inconsistency.",
            "answer": "$$\\boxed{2p}$$"
        },
        {
            "introduction": "Moving from scalar equations to the systems that govern fluid dynamics, such as the Euler equations, presents a \"zoo\" of approximate Riemann solvers, each with distinct characteristics. Understanding their inherent numerical dissipation is key to selecting the right tool for a given aerospace application. This problem  guides you through a comparative analysis of four widely-used fluxes—Roe, HLL, HLLC, and Rusanov—by examining their behavior for a pure contact wave, revealing why some schemes excel at capturing certain flow features while others smear them out.",
            "id": "3982046",
            "problem": "Consider the one-dimensional Euler equations for a calorically perfect gas in conservative form, with state vector $U = (\\rho, \\rho u, E)^{\\top}$, flux $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\top}$, and equation of state $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$, where $\\gamma$ is the ratio of specific heats. Let the uniform base state be $U_{0} = (\\rho_{0}, 0, E_{0})^{\\top}$ with constant pressure $p_{0}$ and speed of sound $a_{0} = \\sqrt{\\gamma p_{0}/\\rho_{0}}$. We analyze a single interface in a Discontinuous Galerkin (DG) scheme for this conservation law, with outward normal aligned with the $x$-direction.\n\nFocus on a small-amplitude, pure contact-mode discontinuity across the interface, defined by left and right states $U_{L} = U_{0}$ and $U_{R} = U_{0} + \\varepsilon r_{c}$, where $0  \\varepsilon \\ll 1$ and $r_{c}$ is the eigenvector of the flux Jacobian associated with the linearly degenerate field (the contact/entropy wave). For the given uniform base state with $u_{0} = 0$ and constant $p_{0}$, this contact-mode perturbation can be chosen in conservative variables as $r_{c} = (1, 0, 0)^{\\top}$, corresponding to a density jump with continuous pressure and velocity.\n\nLinearize the interface numerical flux around $U_{0}$ for each of the following approximate Riemann solvers:\n- Roe’s approximate Riemann solver (Roe),\n- Harten–Lax–van Leer (HLL),\n- Harten–Lax–van Leer–Contact (HLLC),\n- Rusanov (also known as Local Lax–Friedrichs).\n\nFor each solver, define the leading-order dissipation contribution in the linearization as the matrix term that multiplies the jump $(U_{R} - U_{L})$, and project it onto the contact eigenvector $r_{c}$ normalized such that its density component is unity. From this projection, extract the scalar equivalent dissipation coefficient $\\nu$ for the contact mode, and report the dimensionless quantity $\\hat{\\nu} = \\nu / a_{0}$.\n\nCompute and provide the four values of $\\hat{\\nu}$ as a single row matrix, ordered as (Roe, HLL, HLLC, Rusanov). The final answer must be a closed-form analytic expression. No rounding is required, and the quantity $\\hat{\\nu}$ is dimensionless, so no physical units are to be used.",
            "solution": "The user wants me to critically validate and, if valid, solve a problem concerning the numerical dissipation of four common approximate Riemann solvers for a pure contact-wave discontinuity in the one-dimensional Euler equations.\n\n### Problem Validation\n\nThe problem is subjected to a rigorous validation procedure before any attempt at a solution is made.\n\n**Step 1: Extract Givens**\n-   **Governing Law**: One-dimensional Euler equations in conservative form.\n    -   State vector: $U = (\\rho, \\rho u, E)^{\\top}$.\n    -   Flux vector: $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\top}$.\n    -   Equation of state (calorically perfect gas): $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^{2})$.\n-   **Base State**: A uniform state $U_{0} = (\\rho_{0}, 0, E_{0})^{\\top}$. This state has constant pressure $p_{0}$ and speed of sound $a_{0} = \\sqrt{\\gamma p_{0}/\\rho_{0}}$.\n-   **Interface Perturbation**: A small-amplitude, pure contact-mode discontinuity.\n    -   Left state: $U_{L} = U_{0}$.\n    -   Right state: $U_{R} = U_{0} + \\varepsilon r_{c}$, with $0  \\varepsilon \\ll 1$.\n    -   Contact eigenvector for the base state with $u_0=0$: $r_{c} = (1, 0, 0)^{\\top}$. This represents a jump in density ($\\rho$) with zero jump in velocity ($u$) and pressure ($p$).\n-   **Task**:\n    1.  Linearize the numerical flux of four specified solvers around the base state $U_{0}$.\n    2.  For each solver, identify the leading-order dissipation matrix term.\n    3.  Project this term onto the contact eigenvector $r_c$.\n    4.  From the projection, extract the scalar dissipation coefficient $\\nu$ for the contact mode.\n    5.  Report the dimensionless quantity $\\hat{\\nu} = \\nu / a_{0}$.\n-   **Solvers to Analyze**: Roe, Harten-Lax-van Leer (HLL), Harten-Lax-van Leer-Contact (HLLC), and Rusanov (Local Lax-Friedrichs).\n-   **Required Output**: A single row matrix containing the four values of $\\hat{\\nu}$ for (Roe, HLL, HLLC, Rusanov), in that order.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is firmly rooted in the established theory of numerical methods for hyperbolic conservation laws, a core topic in computational fluid dynamics (CFD). The Euler equations, Riemann solvers, and wave analysis are all standard concepts.\n-   **Well-Posedness**: The problem is well-posed. It specifies the governing equations, the base state, the precise form of the perturbation, the analysis to be performed, and the exact form of the output. The quantities to be calculated are uniquely determinable from the provided information.\n-   **Objectivity**: The problem is stated in precise, objective, and technical language, free from any subjectivity or ambiguity.\n-   **Consistency Check**: The chosen contact eigenvector $r_c = (1, 0, 0)^{\\top}$ for a base state with $u_0=0$ corresponds to $U_L = (\\rho_0, 0, E_0)^{\\top}$ and $U_R = (\\rho_0+\\varepsilon, 0, E_0)^{\\top}$. From the equation of state, $p_L = (\\gamma-1)E_0$ and $p_R = (\\gamma-1)E_0$, so $p_L=p_R$. The velocities are $u_L=0/\\rho_0=0$ and $u_R=0/(\\rho_0+\\varepsilon)=0$. Thus, velocity and pressure are continuous across the jump, which correctly defines a contact discontinuity. The setup is fully consistent.\n\nThere are no scientific flaws, contradictions, or ambiguities. The problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution\n\nThe general form of a numerical flux $\\mathcal{F}$ for a one-sided interface can be expressed as a central part and a dissipation part:\n$$ \\mathcal{F}(U_L, U_R) = \\frac{1}{2}(F(U_L) + F(U_R)) - \\frac{1}{2}D_{\\text{num}}(U_L, U_R)(U_R - U_L) $$\nwhere $D_{\\text{num}}$ is the numerical dissipation matrix. We are asked to linearize this flux around the base state $U_0$. For the given small perturbation $U_L=U_0$ and $U_R = U_0 + \\varepsilon r_c$, the dissipation matrix can be approximated by its value at the base state, $\\bar{D}_{\\text{num}} = D_{\\text{num}}(U_0, U_0)$.\n\nThe problem defines the scalar dissipation coefficient $\\nu$ via the projection of the dissipation term onto the contact eigenvector $r_c$. The dissipation term is $-\\frac{1}{2}\\bar{D}_{\\text{num}}(U_R-U_L) = -\\frac{\\varepsilon}{2}\\bar{D}_{\\text{num}}r_c$. Let this vector be $d$. Its projection onto $r_c$ is $\\text{proj}_{r_c}(d) = \\frac{d \\cdot r_c}{r_c \\cdot r_c}r_c$. The problem asks to extract $\\nu$ from this projection. This implies that the action of the dissipation on the contact mode is modeled as $-\\nu(U_R-U_L)$. Equating this with the projection shows that $\\nu$ is the eigenvalue of the operator $\\frac{1}{2}\\bar{D}_{\\text{num}}$ corresponding to the eigenvector $r_c$.\n$$ \\frac{1}{2}\\bar{D}_{\\text{num}} r_c = \\nu r_c $$\nThis holds because for all schemes considered, $r_c$ is an eigenvector of the linearized dissipation matrix $\\bar{D}_{\\text{num}}$.\n\nFirst, we determine the flux Jacobian $A(U) = \\frac{\\partial F}{\\partial U}$ at the base state $U_0 = (\\rho_0, 0, E_0)^\\top$. The calculation at $u=U_2/U_1=0$ yields:\n$$ A_0 = A(U_0) = \\begin{pmatrix} 0  1  0 \\\\ 0  0  \\gamma-1 \\\\ 0  a_0^2/(\\gamma-1)  0 \\end{pmatrix} $$\nThe eigenvalues of $A_0$ are the roots of $\\det(A_0-\\lambda I) = -\\lambda(\\lambda^2 - a_0^2) = 0$, which are $\\lambda_1=0$, $\\lambda_2=a_0$, and $\\lambda_3=-a_0$. These correspond to the wave speeds $\\{u_0, u_0+a_0, u_0-a_0\\}$. The right eigenvector for the eigenvalue $\\lambda_1=0$ is found by solving $A_0 r = 0$, which gives $r=(1, 0, 0)^\\top$, up to a scaling factor. This confirms that the given $r_c$ is indeed the correct contact eigenvector.\n\nWe now analyze each scheme to find its $\\bar{D}_{\\text{num}}$ and the corresponding eigenvalue $\\nu$.\n\n**1. Roe's Approximate Riemann Solver**\nThe dissipation matrix for Roe's solver is given by $|A(\\tilde{U})|$, where $\\tilde{U}$ is the Roe-averaged state. For a small perturbation, $\\tilde{U} \\approx U_0$. Therefore, the linearized dissipation matrix is $\\bar{D}_{\\text{Roe}} = |A(U_0)| = |A_0|$. The matrix $|A_0|$ has the same eigenvectors as $A_0$, but its eigenvalues are the absolute values of the eigenvalues of $A_0$.\nThe contact eigenvector $r_c$ corresponds to the eigenvalue $\\lambda_1 = 0$ of $A_0$. Thus, it is also an eigenvector of $|A_0|$ with eigenvalue $|\\lambda_1| = |0| = 0$.\nThe dissipation operator is $\\frac{1}{2}|A_0|$. Applying it to $r_c$:\n$$ \\frac{1}{2}\\bar{D}_{\\text{Roe}}r_c = \\frac{1}{2}|A_0|r_c = \\frac{1}{2}(0)r_c = 0 \\cdot r_c $$\nSo, the scalar dissipation coefficient is $\\nu_{\\text{Roe}} = 0$. The dimensionless coefficient is $\\hat{\\nu}_{\\text{Roe}} = \\nu_{\\text{Roe}} / a_0 = 0$.\n\n**2. Harten-Lax-van Leer (HLL) Solver**\nThe HLL numerical flux is $\\mathcal{F}_{\\text{HLL}} = \\frac{s_R F_L - s_L F_R + s_L s_R (U_R - U_L)}{s_R - s_L}$, where $s_L$ and $s_R$ are signal velocity estimates. For the base state $U_0$ with $u_0=0$, standard choices are $s_L = u_0 - a_0 = -a_0$ and $s_R = u_0 + a_0 = a_0$. Substituting these into the flux formula and simplifying:\n$$ \\mathcal{F}_{\\text{HLL}} = \\frac{a_0 F_L - (-a_0) F_R + (-a_0)(a_0)(U_R - U_L)}{a_0 - (-a_0)} = \\frac{a_0(F_L + F_R) - a_0^2(U_R - U_L)}{2a_0} $$\n$$ \\mathcal{F}_{\\text{HLL}} = \\frac{1}{2}(F_L + F_R) - \\frac{a_0}{2}(U_R - U_L) $$\nComparing this to the general form, the numerical dissipation matrix is $\\bar{D}_{\\text{HLL}} = a_0 I$, where $I$ is the identity matrix. Any vector is an eigenvector of the identity matrix with eigenvalue $1$.\n$$ \\frac{1}{2}\\bar{D}_{\\text{HLL}}r_c = \\frac{1}{2}(a_0 I)r_c = \\frac{a_0}{2}r_c $$\nThe scalar dissipation coefficient is $\\nu_{\\text{HLL}} = \\frac{a_0}{2}$. The dimensionless coefficient is $\\hat{\\nu}_{\\text{HLL}} = \\nu_{\\text{HLL}} / a_0 = \\frac{1}{2}$.\n\n**3. Harten-Lax-van Leer-Contact (HLLC) Solver**\nThe HLLC solver is specifically designed to recognize and exactly resolve isolated contact discontinuities. The specified interface condition is a pure, stationary ($u_0=0$) contact wave. For such a wave, the exact solution of the Riemann problem consists of the left state $U_L$ and the right state $U_R$ separated by the contact wave traveling at speed $u=0$. The flux at the interface is exactly $F(U_L) = F(U_R) = F(U_0)$.\nThe HLLC scheme reproduces this exact flux, thus $\\mathcal{F}_{\\text{HLLC}}(U_L, U_R) = F(U_0)$.\nThe central part of the flux is $\\frac{1}{2}(F_L + F_R) = \\frac{1}{2}(F(U_0) + F(U_0 + \\varepsilon r_c))$.\nWe linearize $F(U_R)$ around $U_0$: $F(U_R) \\approx F(U_0) + A_0 (U_R-U_0) = F_0 + \\varepsilon A_0 r_c$.\nSince $A_0 r_c = 0$, we have $F(U_R) \\approx F(U_0)$ to first order in $\\varepsilon$.\nSo, $\\frac{1}{2}(F_L + F_R) \\approx \\frac{1}{2}(F_0 + F_0) = F_0$.\nEquating the HLLC flux to the general form:\n$$ F_0 = \\frac{1}{2}(F_L + F_R) - \\frac{1}{2}\\bar{D}_{\\text{HLLC}}(U_R - U_L) \\approx F_0 - \\frac{1}{2}\\bar{D}_{\\text{HLLC}}(U_R - U_L) $$\nThis implies that the dissipation term is zero. Thus, $\\bar{D}_{\\text{HLLC}}$ acting on $r_c$ gives zero.\n$$ \\frac{1}{2}\\bar{D}_{\\text{HLLC}}r_c = 0 \\cdot r_c $$\nThe scalar dissipation coefficient is $\\nu_{\\text{HLLC}} = 0$. The dimensionless coefficient is $\\hat{\\nu}_{\\text{HLLC}} = 0$.\n\n**4. Rusanov (Local Lax-Friedrichs) Solver**\nThe Rusanov flux is given by $\\mathcal{F}_{\\text{LLF}} = \\frac{1}{2}(F_L + F_R) - \\frac{S_{\\text{max}}}{2}(U_R - U_L)$, where $S_{\\text{max}}$ is the maximum absolute wave speed, $S_{\\text{max}} = \\max(|u_L|+a_L, |u_R|+a_R)$.\nAt the interface, we have:\n-   $U_L = U_0$: $|u_L|+a_L = |0|+a_0 = a_0$.\n-   $U_R = (\\rho_0+\\varepsilon, 0, E_0)^\\top$: $|u_R|=0$. The speed of sound is $a_R = \\sqrt{\\gamma p_0/\\rho_R} = \\sqrt{\\gamma p_0/(\\rho_0+\\varepsilon)}$. Since $\\varepsilon0$, $\\rho_R  \\rho_0$, so $a_R  a_0$.\nThe maximum absolute wave speed is $S_{\\text{max}} = \\max(a_0, a_R) = a_0$.\nThe Rusanov flux becomes:\n$$ \\mathcal{F}_{\\text{LLF}} = \\frac{1}{2}(F_L + F_R) - \\frac{a_0}{2}(U_R - U_L) $$\nThis expression is identical to the one derived for the HLL solver under these conditions. Therefore, the analysis is identical. The linearized dissipation matrix is $\\bar{D}_{\\text{Rusanov}} = a_0 I$, and the corresponding dissipation coefficient is $\\nu_{\\text{Rusanov}} = \\frac{a_0}{2}$.\nThe dimensionless coefficient is $\\hat{\\nu}_{\\text{Rusanov}} = \\nu_{\\text{Rusanov}} / a_0 = \\frac{1}{2}$.\n\n**Summary of Results**\nThe calculated dimensionless scalar dissipation coefficients for the contact mode are:\n-   $\\hat{\\nu}_{\\text{Roe}} = 0$\n-   $\\hat{\\nu}_{\\text{HLL}} = \\frac{1}{2}$\n-   $\\hat{\\nu}_{\\text{HLLC}} = 0$\n-   $\\hat{\\nu}_{\\text{Rusanov}} = \\frac{1}{2}$\n\nThe final answer is the row matrix of these values in the specified order.",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n0  \\frac{1}{2}  0  \\frac{1}{2}\n\\end{pmatrix}\n} $$"
        }
    ]
}