{
    "hands_on_practices": [
        {
            "introduction": "在求解包含激波或接触间断的守恒律时，高阶数值方法常常会产生非物理的振荡。为了抑制这些振荡并保证解的稳定性，斜率限制器是必不可少的工具。本练习将从第一性原理出发，引导您推导出一维问题中经典的minmod斜率限制器，并通过一个具体算例展示其应用，同时深入分析它在光滑极值点和间断点附近对精度产生的不同影响。",
            "id": "3954984",
            "problem": "考虑建立在均匀网格上的一维标量守恒律 $u_{t} + f(u)_{x} = 0$，其网格单元为 $I_{i} = [x_{i-1/2}, x_{i+1/2}]$，宽度为 $\\Delta x$。在一个分片线性间断 Galerkin (DG) 方法中，单元内的近似解为 $u_{h}|_{I_{i}}(x) = \\bar{u}_{i} + \\sigma_{i} (x - x_{i})$，其中 $\\bar{u}_{i}$ 是单元平均值，$\\sigma_{i}$ 是斜率系数。为了防止在陡峭梯度附近出现伪振荡，引入了斜率限制，目的是在单调数值通量下，在离散层面上保持总变差递减 (TVD) 性质。\n\n从以单元平均值序列表示的总变差定义出发，并要求界面值 $u_{i}^{-} = \\bar{u}_{i} - \\frac{1}{2}\\sigma_{i}\\Delta x$ 和 $u_{i}^{+} = \\bar{u}_{i} + \\frac{1}{2}\\sigma_{i}\\Delta x$ 不产生新的局部极值，推导一个限制器，该限制器通过将 $\\sigma_{i}$ 与根据相邻单元平均值计算的单边离散梯度进行比较来约束 $\\sigma_{i}$。证明此构造可导出一维情况下斜率系数的 minmod 型限制器，并用未限制斜率 $\\sigma_{i}^{(0)}$、局部单边差分以及一个用于放宽界限的参数 $\\theta \\in [1,2]$ 来表示最终的限制后斜率 $\\sigma_{i}^{\\text{lim}}$。您的推导必须从 TVD 原理和界面值的单调性出发，并最终得到 $\\sigma_{i}^{\\text{lim}}$ 的一个闭式表达式。\n\n接着，在一个 $\\Delta x = 0.4$ 米的均匀网格上，考虑单元 $I_{i}$，其数据为 $\\bar{u}_{i-1} = 1.2$，$\\bar{u}_{i} = 1.0$，$\\bar{u}_{i+1} = 0.7$，以及未限制斜率 $\\sigma_{i}^{(0)} = -0.6$ 米⁻¹。使用推导出的限制器和参数 $\\theta = 1.5$，计算该单元的限制后斜率 $\\sigma_{i}^{\\text{lim}}$。用单位米⁻¹表示最终的限制后斜率，并将您的答案四舍五入到四位有效数字。\n\n最后，分析在光滑极值点与在间断点处应用此限制器的精度影响。通过对光滑函数 $u(x)$ 在 $x_i$ 附近进行泰勒展开，确定在 $u'(x_{i}) = 0$ 且 $u''(x_{i}) \\neq 0$ 的点附近的单边平均值差分的符号，并解释限制器在这种情形下的作用。将此行为与单边差分同号的真实间断点情况进行对比。您的分析应将限制器的决策（将斜率置零或保留有界斜率）与局部精度阶和无振荡行为联系起来。\n\n用单位米⁻¹表示最终的限制后斜率值。将最终数值答案四舍五入到四位有效数字。",
            "solution": "该问题要求分三部分作答：为分片线性间断 Galerkin (DG) 方法推导一个 minmod 型斜率限制器，该限制器的一个数值应用，以及对其精度特性的分析。我们将依次处理每个部分。\n\n### 第1部分：minmod 型限制器的推导\n\n我们考虑一维标量守恒律 $u_{t} + f(u)_{x} = 0$。解域被离散为宽度均匀的单元 $I_{i} = [x_{i-1/2}, x_{i+1/2}]$，其宽度为 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。在每个单元 $I_i$ 内，解由一个线性多项式近似：\n$$u_{h}|_{I_{i}}(x) = \\bar{u}_{i} + \\sigma_{i} (x - x_{i})$$\n其中 $x_i = (x_{i-1/2} + x_{i+1/2})/2$ 是单元中心，$\\bar{u}_{i}$ 是解在 $I_i$ 内的单元平均值，$\\sigma_{i}$ 是线性近似的斜率。\n\n确保无振荡行为，特别是保持总变差递减 (TVD) 性质的核心原则是，防止引入新的局部极值。一个充分条件是，在单元边界处重构多项式的值，$u_{i}^{-} = u_{h}(x_{i-1/2})$ 和 $u_{i}^{+} = u_{h}(x_{i+1/2})$，不应过冲或下冲相邻单元的单元平均值。\n\n单元边界处的值由下式给出：\n$$u_{i}^{-} = \\bar{u}_{i} + \\sigma_{i} (x_{i-1/2} - x_{i}) = \\bar{u}_{i} - \\frac{1}{2}\\sigma_{i}\\Delta x$$\n$$u_{i}^{+} = \\bar{u}_{i} + \\sigma_{i} (x_{i+1/2} - x_{i}) = \\bar{u}_{i} + \\frac{1}{2}\\sigma_{i}\\Delta x$$\n\n无过冲条件是：\n1. 值 $u_{i}^{-}$ 必须位于 $\\bar{u}_{i}$ 和 $\\bar{u}_{i-1}$ 之间。\n2. 值 $u_{i}^{+}$ 必须位于 $\\bar{u}_{i}$ 和 $\\bar{u}_{i+1}$ 之间。\n\n我们来分析关于 $u_{i}^{-}$ 的第一个条件。\n如果 $\\bar{u}_{i} > \\bar{u}_{i-1}$，我们需要 $\\bar{u}_{i-1} \\le u_{i}^{-} \\le \\bar{u}_{i}$。\n右侧不等式 $\\bar{u}_{i} - \\frac{1}{2}\\sigma_{i}\\Delta x \\le \\bar{u}_{i}$ 意味着 $\\sigma_{i} \\ge 0$。\n左侧不等式 $\\bar{u}_{i-1} \\le \\bar{u}_{i} - \\frac{1}{2}\\sigma_{i}\\Delta x$ 意味着 $\\frac{1}{2}\\sigma_{i}\\Delta x \\le \\bar{u}_{i} - \\bar{u}_{i-1}$，所以 $\\sigma_{i} \\le \\frac{2(\\bar{u}_{i} - \\bar{u}_{i-1})}{\\Delta x}$。\n因此，对于这种情况，$0 \\le \\sigma_{i} \\le 2\\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{\\Delta x}$。\n\n如果 $\\bar{u}_{i}  \\bar{u}_{i-1}$，我们需要 $\\bar{u}_{i} \\le u_{i}^{-} \\le \\bar{u}_{i-1}$。\n左侧不等式意味着 $\\sigma_{i} \\le 0$。右侧不等式意味着 $\\sigma_{i} \\ge 2\\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{\\Delta x}$。\n因此，对于这种情况，$2\\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{\\Delta x} \\le \\sigma_{i} \\le 0$。\n\n我们将后向差分斜率定义为 $\\sigma_{i}^{-} = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{\\Delta x}$。来自左边界 $x_{i-1/2}$ 对 $\\sigma_i$ 的条件是，如果 $\\sigma_i$ 和 $\\sigma_i^-$ 同号，则 $|\\sigma_i| \\le 2|\\sigma_i^-|$。如果它们异号，则只有当 $\\sigma_i=0$ 时条件才满足。\n\n现在，我们来分析关于 $u_{i}^{+}$ 的第二个条件。\n如果 $\\bar{u}_{i}  \\bar{u}_{i+1}$，我们需要 $\\bar{u}_{i} \\le u_{i}^{+} \\le \\bar{u}_{i+1}$。这导致 $0 \\le \\sigma_{i} \\le 2\\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{\\Delta x}$。\n如果 $\\bar{u}_{i} > \\bar{u}_{i+1}$，我们需要 $\\bar{u}_{i+1} \\le u_{i}^{+} \\le \\bar{u}_{i}$。这导致 $2\\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{\\Delta x} \\le \\sigma_{i} \\le 0$。\n\n我们将前向差分斜率定义为 $\\sigma_{i}^{+} = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{\\Delta x}$。来自右边界 $x_{i+1/2}$ 对 $\\sigma_i$ 的条件是，如果 $\\sigma_i$ 和 $\\sigma_i^+$ 同号，则 $|\\sigma_i| \\le 2|\\sigma_i^+|$。如果它们异号，则只有当 $\\sigma_i=0$ 时条件才满足。\n\n为同时满足两个边界条件，斜率 $\\sigma_i$ 必须遵守两个约束。\n- 如果 $\\sigma_{i}^{-}$、$\\sigma_{i}^{+}$ 和期望的斜率 $\\sigma_{i}$ 符号全部相同，则 $|\\sigma_{i}|$ 必须同时受 $2|\\sigma_{i}^{-}|$ 和 $2|\\sigma_{i}^{+}|$ 的限制。这意味着 $|\\sigma_{i}| \\le \\min(2|\\sigma_{i}^{-}|, 2|\\sigma_{i}^{+}|)$。\n- 如果 $\\sigma_{i}^{-}$ 和 $\\sigma_{i}^{+}$ 符号相反，则解在单元 $I_i$ 处有一个局部极值。在这种情况下，满足两组约束的唯一方法是设置 $\\sigma_{i} = 0$。\n\n这导出了一个限制程序。给定一个未限制的斜率 $\\sigma_{i}^{(0)}$（例如，来自高阶重构或中心差分），限制后的斜率 $\\sigma_i^{\\text{lim}}$ 必须满足这些界限。因子 $2$ 是无过冲原则下允许的最宽松的值。这可以通过使用参数 $\\theta \\in [1, 2]$ 来放宽，其中 $\\theta=1$ 限制性更强（常用于有限体积法），而 $\\theta=2$ 是无过冲分片线性重构的极限。一般界限变为 $|\\sigma_{i}| \\le \\min(\\theta|\\sigma_{i}^{-}|, \\theta|\\sigma_{i}^{+}|)$。\n\n`minmod` 函数是表达此逻辑的一种便捷方式。广义的 minmod 函数定义为：\n$$\\text{minmod}(a_{1}, a_{2}, \\dots, a_{n}) = \n\\begin{cases} \n\\min(a_{1}, a_{2}, \\dots, a_{n})  \\text{如果对所有 } k \\text{ 都有 } a_{k} > 0 \\\\\n\\max(a_{1}, a_{2}, \\dots, a_{n})  \\text{如果对所有 } k \\text{ 都有 } a_{k}  0 \\\\\n0  \\text{其他情况}\n\\end{cases}$$\n如果所有参数符号相同，此函数返回绝对值最小的参数；否则返回 $0$。\n\n使用此函数，可以通过迫使未限制的先验斜率 $\\sigma_i^{(0)}$ 符合推导出的界限来构造限制后的斜率 $\\sigma_i^{\\text{lim}}$。最终限制后的斜率由下式给出：\n$$\\sigma_{i}^{\\text{lim}} = \\text{minmod}(\\sigma_{i}^{(0)}, \\theta \\sigma_{i}^{-}, \\theta \\sigma_{i}^{+})$$\n该表达式巧妙地实现了所需的性质：如果 $\\sigma_i^{(0)}$、$\\sigma_i^{-}$ 和 $\\sigma_i^{+}$ 不全为同号（表明存在极值或振荡），斜率将被平坦化为零。否则，仅当 $\\sigma_i^{(0)}$ 的量值小于由 $\\theta|\\sigma_i^{-}|$ 和 $\\theta|\\sigma_i^{+}|$ 给出的界限时，才选择它；否则，它将被“限制”为量值较小的那个界限。\n\n### 第2部分：数值计算\n\n在一个均匀网格上，我们给定以下数据：\n- 单元宽度：$\\Delta x = 0.4$ 米\n- 单元平均值：$\\bar{u}_{i-1} = 1.2$, $\\bar{u}_{i} = 1.0$, $\\bar{u}_{i+1} = 0.7$\n- 单元 $I_i$ 中的未限制斜率：$\\sigma_{i}^{(0)} = -0.6$ 米⁻¹\n- 限制器参数：$\\theta = 1.5$\n\n首先，我们计算单边离散梯度斜率 $\\sigma_i^{-}$ 和 $\\sigma_i^{+}$：\n$$\\sigma_{i}^{-} = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{\\Delta x} = \\frac{1.0 - 1.2}{0.4} = \\frac{-0.2}{0.4} = -0.5 \\, \\text{m}^{-1}$$\n$$\\sigma_{i}^{+} = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{\\Delta x} = \\frac{0.7 - 1.0}{0.4} = \\frac{-0.3}{0.4} = -0.75 \\, \\text{m}^{-1}$$\n\n接下来，我们使用参数 $\\theta$ 计算有界斜率项：\n$$\\theta \\sigma_{i}^{-} = 1.5 \\times (-0.5) = -0.75 \\, \\text{m}^{-1}$$\n$$\\theta \\sigma_{i}^{+} = 1.5 \\times (-0.75) = -1.125 \\, \\text{m}^{-1}$$\n\n现在，我们将 `minmod` 函数应用于三个参数：$\\sigma_{i}^{(0)}$、$\\theta \\sigma_{i}^{-}$ 和 $\\theta \\sigma_{i}^{+}$。\n参数为：$-0.6$、$-0.75$ 和 $-1.125$。\n所有三个参数均为负数。因此，`minmod` 函数返回这些值中的最大值（即绝对值最小的那个值）。\n$$\\sigma_{i}^{\\text{lim}} = \\text{minmod}(-0.6, -0.75, -1.125) = \\max(-0.6, -0.75, -1.125) = -0.6 \\, \\text{m}^{-1}$$\n未限制的斜率 $\\sigma_i^{(0)}$ 已经位于限制器设定的界限内，因此未被修改。四舍五入到四位有效数字，限制后的斜率为 $-0.6000 \\, \\text{m}^{-1}$。\n\n### 第3部分：精度分析\n\n我们分析限制器在两种不同情况下的行为：光滑极值点和间断点。\n\n**情况1：光滑极值点**\n考虑一个在 $x = x_i$ 处有局部极值的光滑函数 $u(x)$。这意味着 $u'(x_i) = 0$ 且 $u''(x_i) \\neq 0$。为了分析单元平均值差分的符号，我们对 $u(x)$ 在 $x_i$ 附近进行泰勒展开。可以证明，在 $u'(x_i)=0$ 的条件下，相邻单元平均值的差近似为：\n$$\\bar{u}_i - \\bar{u}_{i-1} \\approx -\\frac{1}{2} u''(x_i) \\Delta x^2$$\n$$\\bar{u}_{i+1} - \\bar{u}_i \\approx \\frac{1}{2} u''(x_i) \\Delta x^2$$\n如果 $x_i$ 是一个局部最大值（即 $u''(x_i)  0$），则 $\\bar{u}_i - \\bar{u}_{i-1} > 0$ 且 $\\bar{u}_{i+1} - \\bar{u}_i  0$。这意味着后向差分斜率 $\\sigma_i^- = (\\bar{u}_i - \\bar{u}_{i-1})/\\Delta x$ 为正，而前向差分斜率 $\\sigma_i^+ = (\\bar{u}_{i+1} - \\bar{u}_i)/\\Delta x$ 为负。\n由于 $\\sigma_i^-$ 和 $\\sigma_i^+$ 的符号相反，`minmod` 限制器将强制设置限制后的斜率 $\\sigma_i^{\\text{lim}} = 0$。这将使单元 $I_i$ 内的解变成一个常数（等于单元平均值 $\\bar{u}_i$），有效地“削平”了光滑的极值点。这种行为虽然保证了无振荡性，但会将该点的局部精度降低到一阶，这是斜率限制器的一个著名缺点。\n\n**情况2：间断点**\n在一个单调变化的区域，例如一个激波或接触间断的附近（但不是在极值点），单元平均值序列 $\\bar{u}_{i-1}, \\bar{u}_i, \\bar{u}_{i+1}$ 将是单调的。因此，差分 $\\bar{u}_{i} - \\bar{u}_{i-1}$ 和 $\\bar{u}_{i+1} - \\bar{u}_{i}$ 将具有相同的符号，导致 $\\sigma_i^-$ 和 $\\sigma_i^+$ 也同号。\n在这种情况下，`minmod` 函数不会自动将斜率置零。相反，如果 $\\sigma_i^{(0)}$ 与它们同号，它会选择三者中绝对值最小的那个。这允许格式在保持非零斜率的同时捕捉陡峭的梯度，从而在不引入振荡的情况下保持较高的分辨率。限制器的作用是确保重构的斜率不会太陡，从而防止过冲。",
            "answer": "$$\\boxed{-0.6000}$$"
        },
        {
            "introduction": "一个优秀的数值格式应该在离散层面尽可能地保持其模拟的物理定律的守恒性。非连续伽辽金方法的一个标志性特征就是其内在的局部守恒性。本练习将要求您从DG方法的弱形式出发，证明单元平均解的时间变化率精确地被通过单元边界的数值通量所平衡，从而验证该方法的局部守恒特性，无论内部和边界上采用何种具体的通量函数。",
            "id": "2385273",
            "problem": "考虑有界域 $\\Omega \\subset \\mathbb{R}^d$ 上的标量守恒律 $u_t + \\nabla \\cdot \\boldsymbol{f}(u) = 0$，并在 $\\partial \\Omega$ 上带有适当的边界数据。设 $\\Omega$ 被划分为构成协调网格的非重叠单元 $\\{K\\}$。通过在每个 $K$ 上的多项式空间中分片寻找 $u_h$，将守恒律乘以支集在 $K$ 上的检验函数 $v_h$，在 $K$ 上积分，并在 $K$ 上应用分部积分，可以构建间断伽辽金 (DG) 半离散格式。每个面上的边界通量积分被替换为单值的数值通量。在两个单元共享的内部面上，使用一个数值通量函数 $\\widehat{\\boldsymbol{f}}_i(u_h^-, u_h^+, \\boldsymbol{n}^-)$，该函数依赖于来自两个相邻单元的迹以及当前单元的单位外法向量 $\\boldsymbol{n}^-$。在边界面上，假设使用一个可能不同的通量函数 $\\widehat{\\boldsymbol{f}}_b(u_h, \\boldsymbol{n}, \\text{BC})$，该函数依赖于内部迹 $u_h$、单位外法向量 $\\boldsymbol{n}$ 和边界条件数据，而不要求 $\\widehat{\\boldsymbol{f}}_b$ 与专用于边界状态的 $\\widehat{\\boldsymbol{f}}_i$ 一致。\n\n根据第一性原理，单元 $K$ 上的局部守恒是指 $K$ 上 $u_h$ 的单元平均值的时间变化率等于通过 $\\partial K$ 的净数值通量（符号由 $K$ 的外法向量决定）。具体来说，它询问该半离散格式是否意味着以下形式的精确平衡\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h \\,\\mathrm{d}\\boldsymbol{x} + \\int_{\\partial K} \\widehat{\\boldsymbol{f}}(u_h) \\cdot \\boldsymbol{n} \\,\\mathrm{d}s = 0,\n$$\n对于 $\\partial K$ 的每个面上的某个单值数值通量 $\\widehat{\\boldsymbol{f}}$ 成立。\n\n假设在每个内部面上，两个相邻单元一致地使用单个数值通量值 $\\widehat{\\boldsymbol{f}}_i(u_h^-, u_h^+, \\boldsymbol{n}^-)$（法向量相反），而在边界面上使用一个可能不同的函数 $\\widehat{\\boldsymbol{f}}_b$。没有源项。\n\n当边界通量积分用 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 计算时，以下哪个陈述最能描述局部守恒的情况？\n\nA. 每个单元 $K$ 上的局部守恒都精确保持；单元平均值的演化与 $\\partial K$ 上单值数值通量的总和相平衡，其中内部面使用 $\\widehat{\\boldsymbol{f}}_i$，边界面使用 $\\widehat{\\boldsymbol{f}}_b$。内部面的抵消是全局守恒的基础，而全局守恒不受使用不同 $\\widehat{\\boldsymbol{f}}_b$ 的影响。\n\nB. 在与 $\\partial \\Omega$ 相邻的单元上，局部守恒被破坏，因为使用 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 会在同个边界面上产生两个不同的通量值，从而无法实现守恒平衡。\n\nC. 除非 $\\widehat{\\boldsymbol{f}}_b$ 与 $\\widehat{\\boldsymbol{f}}_i$ 一致，否则局部守恒和全局守恒都会失效；否则，即使在单元平均值的意义上，该格式也无法是守恒的。\n\nD. 局部守恒在内部单元上成立，但在邻近边界的单元上失效，因为当 $\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$ 时，单元平均值的更新包含一个无法写成边界通量的额外残差。",
            "solution": "为了确定哪个陈述是正确的，我们从间断伽辽金 (DG) 方法的弱形式出发，推导单元平均值的演化方程。\n\n对于单元 $K$ 上的守恒律 $u_t + \\nabla \\cdot \\boldsymbol{f}(u) = 0$，DG 半离散格式要求对于所有检验函数 $v_h \\in V_h(K)$（其中 $V_h(K)$ 是单元 $K$ 上的多项式空间），下式成立：\n$$\n\\int_K \\frac{\\partial u_h}{\\partial t} v_h \\, \\mathrm{d}\\boldsymbol{x} + \\int_K (\\nabla \\cdot \\boldsymbol{f}(u_h)) v_h \\, \\mathrm{d}\\boldsymbol{x} = 0.\n$$\n对第二项应用分部积分（散度定理），并将边界上的物理通量 $\\boldsymbol{f}(u_h) \\cdot \\boldsymbol{n}$ 替换为单值的数值通量 $\\widehat{\\boldsymbol{f}} \\cdot \\boldsymbol{n}$，我们得到：\n$$\n\\int_K \\frac{\\partial u_h}{\\partial t} v_h \\, \\mathrm{d}\\boldsymbol{x} - \\int_K \\boldsymbol{f}(u_h) \\cdot \\nabla v_h \\, \\mathrm{d}\\boldsymbol{x} + \\int_{\\partial K} (\\widehat{\\boldsymbol{f}} \\cdot \\boldsymbol{n}) v_h \\, \\mathrm{d}s = 0.\n$$\n局部守恒性质关系到单元平均值 $\\bar{u}_K(t) = \\frac{1}{|K|} \\int_K u_h(\\boldsymbol{x},t) \\, \\mathrm{d}\\boldsymbol{x}$ 的演化。为了得到它的控制方程，我们选择一个特殊的检验函数：$v_h(\\boldsymbol{x}) = 1$。由于常数函数是任何次数 $k \\ge 0$ 的多项式空间的一部分，这是一个有效的选择。\n\n将 $v_h = 1$ 代入弱形式：\n1.  时间导数项变为 $\\int_K \\frac{\\partial u_h}{\\partial t} \\cdot 1 \\, \\mathrm{d}\\boldsymbol{x} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h \\, \\mathrm{d}\\boldsymbol{x}$。\n2.  体积积分项消失，因为 $\\nabla v_h = \\nabla(1) = \\boldsymbol{0}$，所以 $\\int_K \\boldsymbol{f}(u_h) \\cdot \\boldsymbol{0} \\, \\mathrm{d}\\boldsymbol{x} = 0$。\n3.  边界积分项变为 $\\int_{\\partial K} (\\widehat{\\boldsymbol{f}} \\cdot \\boldsymbol{n}) \\cdot 1 \\, \\mathrm{d}s$。\n\n于是，弱形式精确地简化为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_K u_h \\, \\mathrm{d}\\boldsymbol{x} + \\int_{\\partial K} \\widehat{\\boldsymbol{f}} \\cdot \\boldsymbol{n} \\, \\mathrm{d}s = 0.\n$$\n这个方程正是局部守恒的数学表述：单元 $K$ 内 $u_h$ 总量的时间变化率，精确地等于通过其边界 $\\partial K$ 的净数值通量。\n\n这一推导对于**任何**单元 $K$ 都成立，无论它位于计算域内部还是与边界 $\\partial\\Omega$ 相邻。数值通量的具体函数形式（即内部通量 $\\widehat{\\boldsymbol{f}}_i$ 和边界通量 $\\widehat{\\boldsymbol{f}}_b$），以及它们是否相同（$\\widehat{\\boldsymbol{f}}_b \\neq \\widehat{\\boldsymbol{f}}_i$），完全不影响这个基本平衡关系。它仅仅决定了在边界 $\\partial K$ 的不同部分，$\\widehat{\\boldsymbol{f}}$ 具体取什么值。\n\n基于此推导，我们分析各个选项：\n\n**A. 每个单元 K 上的局部守恒都精确保持...**\n这个陈述是正确的。我们的推导表明，局部守恒是 DG 方法的内在属性，对所有单元均成立。全局守恒是通过对所有单元的局部守恒方程求和得到的；内部通量因其一致性而相互抵消，只留下边界通量，这也与 $\\widehat{\\boldsymbol{f}}_b$ 的具体选择无关。\n\n**B. 在与 $\\partial \\Omega$ 相邻的单元上，局部守恒被破坏...**\n这个陈述不正确。推导表明局部守恒对所有单元都成立。其理由也是错误的，因为在域边界的一个面上，只有一个单元与之相邻，通量由 $\\widehat{\\boldsymbol{f}}_b$ 唯一定义，不存在“两个不同的通量值”。\n\n**C. 除非 $\\widehat{\\boldsymbol{f}}_b$ 与 $\\widehat{\\boldsymbol{f}}_i$ 一致，否则局部守恒和全局守恒都会失效...**\n这个陈述不正确。局部守恒和全局守恒的成立不要求 $\\widehat{\\boldsymbol{f}}_b$ 和 $\\widehat{\\boldsymbol{f}}_i$ 必须一致。\n\n**D. 局部守恒在内部单元上成立，但在邻近边界的单元上失效...**\n这个陈述不正确。它错误地声称局部守恒在边界单元上失效。如推导所示，并不存在无法写成边界通量的“额外残差”。\n\n因此，选项A是唯一正确的描述。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}