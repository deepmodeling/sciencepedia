{
    "hands_on_practices": [
        {
            "introduction": "我们首先分析计算流体动力学中的一个基础性方法——Lax-Friedrichs格式。通过本练习，您将从第一性原理出发，推导出该格式的固有数值耗散是如何降低正弦波振幅的。将这一结果与总变差（Total Variation, TV）的概念联系起来，您将深入理解为何数值耗散虽然能保证稳定性，却也以牺牲解的细节为代价。",
            "id": "3976760",
            "problem": "在计算流体力学（CFD）中，考虑被动标量的一维线性平流问题，该问题由标量守恒定律 $u_{t} + a\\,u_{x} = 0$ 控制，其中 $a$ 是一个恒定的平流速度。在具有周期性边界条件的均匀网格 $x_{i} = i\\,\\Delta x$ 上，考虑使用 Lax–Friedrichs 数值通量的守恒更新。设时间步长为 $\\Delta t$，定义库朗数 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$，且 $|\\lambda| \\leq 1$。初始条件被规定为正弦波 $u_{i}^{0} = \\sin(k\\,x_{i})$，其中 $k$ 是与周期性域兼容的实波数。\n\n将时间层 $n$ 的离散全变分 $TV_{d}^{n}$ 定义为 $TV_{d}^{n} = \\sum_{i} \\left|u_{i+1}^{n} - u_{i}^{n}\\right|$，其中索引是周期性的。仅使用标量守恒定律、Lax–Friedrichs 数值通量的定义以及离散全变分的定义，从第一性原理推导出一个 Lax–Friedrichs 时间步后波数为 $k$ 的傅里叶模的放大因子的模的闭式表达式，然后用它来求得：\n\n1. 一个时间步后正弦波相对于其初始振幅的振幅衰减因子。\n2. 一个时间步后的离散全变分衰减因子 $TV_{d}^{1}/TV_{d}^{0}$。\n\n用 $k$、$\\Delta x$ 和 $\\lambda$ 表示这两个量。你的最终答案必须是包含这两个量作为行矩阵的单个解析表达式。不需要进行数值四舍五入，也不需要单位。",
            "solution": "本题要求推导与一维线性平流方程的 Lax–Friedrichs 格式相关的两个量：一个时间步后，正弦初始条件的振幅衰减因子和离散全变分衰减因子。\n\n首先，我们必须推导 Lax–Friedrichs 格式的有限差分模板及其对应的放大因子。\n\n标量守恒定律为 $u_t + a u_x = 0$。其守恒形式为 $u_t + F(u)_x = 0$，其中通量为 $F(u) = a u$。\n均匀网格上的守恒有限差分更新为：\n$$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)$$\n其中 $u_i^n$ 是网格点 $x_i = i \\Delta x$ 和时间 $t^n = n \\Delta t$ 处的解，$F_{i+1/2}$ 是单元 $i$ 和 $i+1$ 之间界面上的数值通量。\n\nLax–Friedrichs 数值通量定义为：\n$$F_{i+1/2}^{LF} = \\frac{1}{2} \\left[ F(u_i^n) + F(u_{i+1}^n) \\right] - \\frac{1}{2} \\frac{\\Delta x}{\\Delta t} \\left( u_{i+1}^n - u_i^n \\right)$$\n代入 $F(u) = a u$：\n$$F_{i+1/2}^{LF} = \\frac{a}{2} \\left( u_i^n + u_{i+1}^n \\right) - \\frac{1}{2} \\frac{\\Delta x}{\\Delta t} \\left( u_{i+1}^n - u_i^n \\right)$$\n类似地，在 $i-1/2$ 界面处的通量为：\n$$F_{i-1/2}^{LF} = \\frac{a}{2} \\left( u_{i-1}^n + u_i^n \\right) - \\frac{1}{2} \\frac{\\Delta x}{\\Delta t} \\left( u_i^n - u_{i-1}^n \\right)$$\n\n将这些通量代入守恒更新方程：\n$$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left[ \\left(\\frac{a}{2}(u_i^n + u_{i+1}^n) - \\frac{\\Delta x}{2\\Delta t}(u_{i+1}^n - u_i^n)\\right) - \\left(\\frac{a}{2}(u_{i-1}^n + u_i^n) - \\frac{\\Delta x}{2\\Delta t}(u_i^n - u_{i-1}^n)\\right) \\right]$$\n我们来对各项进行分组。平流部分的贡献是：\n$$-\\frac{\\Delta t}{\\Delta x} \\left[ \\frac{a}{2}(u_{i+1}^n - u_{i-1}^n) \\right] = -\\frac{a \\Delta t}{2 \\Delta x} (u_{i+1}^n - u_{i-1}^n) = -\\frac{\\lambda}{2} (u_{i+1}^n - u_{i-1}^n)$$\n其中 $\\lambda = \\frac{a \\Delta t}{\\Delta x}$ 是库朗数。\n耗散部分的贡献是：\n$$-\\frac{\\Delta t}{\\Delta x} \\left[ -\\frac{\\Delta x}{2\\Delta t}(u_{i+1}^n - 2u_i^n + u_{i-1}^n) \\right] = \\frac{1}{2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$\n合并所有项：\n$$u_i^{n+1} = u_i^n - \\frac{\\lambda}{2} (u_{i+1}^n - u_{i-1}^n) + \\frac{1}{2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$\n$$u_i^{n+1} = u_i^n(1 - 1) + u_{i-1}^n \\left(\\frac{\\lambda}{2} + \\frac{1}{2}\\right) + u_{i+1}^n \\left(-\\frac{\\lambda}{2} + \\frac{1}{2}\\right)$$\n这简化为 Lax–Friedrichs 模板：\n$$u_i^{n+1} = \\frac{1+\\lambda}{2} u_{i-1}^n + \\frac{1-\\lambda}{2} u_{i+1}^n$$\n注意，这也可以看作是在前一个时间步的时间平均值上应用空间中心差分，即 $\\frac{u_i^{n+1} - \\frac{1}{2}(u_{i+1}^n + u_{i-1}^n)}{\\Delta t} + a \\frac{u_{i+1}^n - u_{i-1}^n}{2\\Delta x} = 0$，重新整理后得到相同的模板。\n\n为了求解放大因子，我们进行 von Neumann 稳定性分析。我们考虑单个傅里叶模 $u_i^n = \\hat{u}^n(k) e^{I k x_i}$，其中 $I = \\sqrt{-1}$ 是虚数单位，$k$ 是波数。下一个时间步的解是 $u_i^{n+1} = G(k) \\hat{u}^n(k) e^{I k x_i}$，其中 $G(k)$ 是放大因子。将这些代入模板：\n$$G(k) \\hat{u}^n e^{I k x_i} = \\frac{1+\\lambda}{2} \\hat{u}^n e^{I k x_{i-1}} + \\frac{1-\\lambda}{2} \\hat{u}^n e^{I k x_{i+1}}$$\n使用 $x_{j} = j \\Delta x$ 并除以 $\\hat{u}^n e^{I k i \\Delta x}$：\n$$G(k) = \\frac{1+\\lambda}{2} e^{-I k \\Delta x} + \\frac{1-\\lambda}{2} e^{I k \\Delta x}$$\n使用欧拉公式 $e^{I\\theta} = \\cos\\theta + I\\sin\\theta$：\n$$G(k) = \\frac{1+\\lambda}{2} (\\cos(k\\Delta x) - I\\sin(k\\Delta x)) + \\frac{1-\\lambda}{2} (\\cos(k\\Delta x) + I\\sin(k\\Delta x))$$\n对实部和虚部进行分组：\n$$G(k) = \\cos(k\\Delta x) \\left( \\frac{1+\\lambda}{2} + \\frac{1-\\lambda}{2} \\right) + I\\sin(k\\Delta x) \\left( -\\frac{1+\\lambda}{2} + \\frac{1-\\lambda}{2} \\right)$$\n$$G(k) = \\cos(k\\Delta x) - I \\lambda \\sin(k\\Delta x)$$\n放大因子的模为：\n$$|G(k)| = \\sqrt{(\\cos(k\\Delta x))^2 + (-\\lambda \\sin(k\\Delta x))^2} = \\sqrt{\\cos^2(k\\Delta x) + \\lambda^2 \\sin^2(k\\Delta x)}$$\n使用恒等式 $\\cos^2\\theta = 1 - \\sin^2\\theta$，我们可以将其写得更紧凑：\n$$|G(k)| = \\sqrt{1 - \\sin^2(k\\Delta x) + \\lambda^2 \\sin^2(k\\Delta x)} = \\sqrt{1 - (1-\\lambda^2)\\sin^2(k\\Delta x)}$$\n这就是推导出的放大因子的模的表达式。\n\n**1. 振幅衰减因子**\n初始条件为 $u_i^0 = \\sin(k x_i)$。我们可以用复指数表示它：\n$$u_i^0 = \\frac{e^{I k x_i} - e^{-I k x_i}}{2I}$$\n这是波数为 $k$ 和 $-k$ 的两个模的叠加。一个时间步后，每个模都乘以其各自的放大因子 $G(k)$ 和 $G(-k)$。\n$$u_i^1 = \\frac{G(k) e^{I k x_i} - G(-k) e^{-I k x_i}}{2I}$$\n我们注意到 $G(-k) = \\cos(-k\\Delta x) - I\\lambda\\sin(-k\\Delta x) = \\cos(k\\Delta x) + I\\lambda\\sin(k\\Delta x) = G(k)^*$，即 $G(k)$ 的复共轭。\n设 $G(k) = |G(k)| e^{-I\\phi_k}$，其中 $\\phi_k = \\arctan(\\lambda \\tan(k\\Delta x))$ 是相移。那么 $G(-k) = |G(k)| e^{I\\phi_k}$。\n将这些代入 $u_i^1$ 的表达式中：\n$$u_i^1 = \\frac{|G(k)| e^{-I\\phi_k} e^{I k x_i} - |G(k)| e^{I\\phi_k} e^{-I k x_i}}{2I} = |G(k)| \\frac{e^{I(kx_i - \\phi_k)} - e^{-I(kx_i - \\phi_k)}}{2I}$$\n$$u_i^1 = |G(k)| \\sin(k x_i - \\phi_k)$$\n正弦波 $u_i^0$ 的初始振幅为 $1$。一个时间步后的振幅为 $|G(k)|$。\n振幅衰减因子是最终振幅与初始振幅之比，即 $\\frac{|G(k)|}{1} = |G(k)|$。\n所以，振幅衰减因子是 $\\sqrt{1 - (1-\\lambda^2)\\sin^2(k\\Delta x)}$。\n\n**2. 离散全变分衰减因子**\n时间层 $n$ 的离散全变分是 $TV_d^n = \\sum_i |u_{i+1}^n - u_i^n|$。我们需要求比值 $TV_d^1/TV_d^0$。\n\n对于 $n=0$： $u_i^0 = \\sin(k x_i) = \\sin(k i \\Delta x)$。\n差值为 $u_{i+1}^0 - u_i^0 = \\sin(k(i+1)\\Delta x) - \\sin(ki\\Delta x)$。\n使用和差化积恒等式 $\\sin(A) - \\sin(B) = 2\\cos(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$：\n$$u_{i+1}^0 - u_i^0 = 2\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right) \\sin\\left(\\frac{k\\Delta x}{2}\\right)$$\n全变分为：\n$$TV_d^0 = \\sum_i \\left| 2\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right) \\sin\\left(\\frac{k\\Delta x}{2}\\right) \\right| = 2\\left|\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right| \\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right)\\right|$$\n\n对于 $n=1$： $u_i^1 = |G(k)| \\sin(k x_i - \\phi_k)$。\n差值为 $u_{i+1}^1 - u_i^1 = |G(k)|[\\sin(k(i+1)\\Delta x - \\phi_k) - \\sin(ki\\Delta x - \\phi_k)]$。\n使用相同的恒等式：\n$$u_{i+1}^1 - u_i^1 = |G(k)| \\left[ 2\\cos\\left(k(i+\\frac{1}{2})\\Delta x - \\phi_k\\right) \\sin\\left(\\frac{k\\Delta x}{2}\\right) \\right]$$\n全变分为：\n$$TV_d^1 = \\sum_i \\left| |G(k)| 2\\cos\\left(k(i+\\frac{1}{2})\\Delta x - \\phi_k\\right) \\sin\\left(\\frac{k\\Delta x}{2}\\right) \\right|$$\n$$TV_d^1 = |G(k)| \\cdot 2\\left|\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right| \\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x - \\phi_k\\right)\\right|$$\n求和是在一个完整的周期性域上进行的。项 $\\phi_k$ 代表一个恒定的相移。对于一个在整个周期上求和的周期函数，恒定的相移不会改变求和的值。因此：\n$$\\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x - \\phi_k\\right)\\right| = \\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right)\\right|$$\n现在我们计算比值 $TV_d^1/TV_d^0$：\n$$\\frac{TV_d^1}{TV_d^0} = \\frac{|G(k)| \\cdot 2\\left|\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right| \\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right)\\right|}{2\\left|\\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right| \\sum_i \\left|\\cos\\left(k(i+\\frac{1}{2})\\Delta x\\right)\\right|} = |G(k)|$$\n离散全变分衰减因子也等于放大因子的模 $|G(k)|$。\n\n这两个量都等于同一个表达式：$\\sqrt{1 - (1-\\lambda^2)\\sin^2(k\\Delta x)}$。我们按照要求将它们表示为一个行矩阵。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\sqrt{1 - (1-\\lambda^{2})\\sin^{2}(k\\Delta x)} & \\sqrt{1 - (1-\\lambda^{2})\\sin^{2}(k\\Delta x)} \\end{pmatrix} } $$"
        },
        {
            "introduction": "虽然一阶格式耗散过大，但草率地追求高阶精度往往会在激波等尖锐梯度附近引入非物理振荡。本练习将通过一个无限制的二阶MUSCL重构方案，揭示其不满足单调性的根本原因。通过精确计算一个阶跃间断处的过冲（overshoot）幅值，您将具体理解为何需要发展总变差递减（Total Variation Diminishing, TVD）格式。",
            "id": "3976722",
            "problem": "在与航空航天应用相关的计算流体动力学（CFD）背景下，考虑定义在间距为 $\\Delta x$ 的均匀网格上的一维标量线性平流方程 $u_t + a\\,u_x = 0$，其中平流速度 $a > 0$ 为常数。一种有限体积法采用一阶显式欧拉时间更新和具有无限制线性斜率的守恒律单调上游中心格式（MUSCL）重构。具体而言，将时间层 $n$ 时单元 $i$ 中的单元平均值记为 $u_i^n$，将 Courant–Friedrichs–Lewy (CFL) 数记为 $\\nu = a\\,\\Delta t/\\Delta x$，并将 MUSCL 无限制中心斜率记为 $s_i = \\dfrac{u_{i+1}^n - u_{i-1}^n}{2}$。界面 $i+\\tfrac{1}{2}$ 处的左态重构为 $u_{i+\\tfrac{1}{2}}^{-} = u_i^n + \\dfrac{1}{2}s_i$。对于 $a>0$，使用迎风数值通量 $F_{i+\\tfrac{1}{2}} = a\\,u_{i+\\tfrac{1}{2}}^{-}$，有限体积更新式为 $u_i^{n+1} = u_i^n - \\nu\\left(u_{i+\\tfrac{1}{2}}^{-} - u_{i-\\tfrac{1}{2}}^{-}\\right)$。\n\n使用左右两侧为常数状态的单个间断进行初始化\n$$\nu_i^0 = \\begin{cases}\nU_L, & i \\le 0, \\\\\nU_R, & i \\ge 1,\n\\end{cases}\n$$\n其中 $U_L > U_R$ 且二者均为有限实常数。假设 $0  \\nu  1$。\n\n将第一个时间步在间断附近的过冲幅值定义为紧邻界面的最左侧单元中的更新值超过左态的正量，即 $A_{\\text{over}} = \\max\\{0,\\,u_0^{1} - U_L\\}$。\n\n从守恒律、带迎风通量的有限体积更新式以及上述 MUSCL 无限制斜率重构出发，推导单调性的失效，并计算 $A_{\\text{over}}$ 作为 $\\nu$、$U_L$ 和 $U_R$ 的函数的精确闭式表达式。请将最终答案表示为单个解析表达式。最终表达式中无需四舍五入，也不应包含单位。",
            "solution": "问题要求推导应用于线性平流方程的特定有限体积格式的单调性失效，并计算其过冲幅值。该格式是一种具有无限制中心斜率的二阶 MUSCL 重构，结合了一阶显式欧拉时间更新和迎风通量。\n\n一维标量线性平流方程由下式给出\n$$u_t + a\\,u_x = 0$$\n其中平流速度 $a  0$ 是一个常数。在时间层 $n$ 时单元 $i$ 中的单元平均值 $u_i^n$ 的有限体积更新式为\n$$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)$$\n数值通量 $F_{i+\\frac{1}{2}}$ 使用迎风格式计算，对于 $a  0$，这意味着我们取界面左侧的状态 $u_{i+\\frac{1}{2}}^{-}$。线性平流方程的通量函数为 $F(u)=au$。因此，数值通量为 $F_{i+\\frac{1}{2}} = a\\,u_{i+\\frac{1}{2}}^{-}$。将此代入更新公式，并使用 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = a\\,\\Delta t/\\Delta x$，我们便得到了问题描述中提供的更新公式：\n$$u_i^{n+1} = u_i^n - \\nu\\left(u_{i+\\frac{1}{2}}^{-} - u_{i-\\frac{1}{2}}^{-}\\right)$$\n状态 $u_{i+\\frac{1}{2}}^{-}$ 是通过单元 $i$ 内的 MUSCL 重构得到的。对于无限制线性斜率，单元 $i$ 右边界（即界面 $i+\\frac{1}{2}$ 的左侧）的值由下式给出\n$$u_{i+\\frac{1}{2}}^{-} = u_i^n + \\frac{1}{2}s_i^n$$\n其中斜率 $s_i^n$ 使用中心差分计算：\n$$s_i^n = \\frac{u_{i+1}^n - u_{i-1}^n}{2}$$\n题目要求我们从阶跃间断的初始条件出发，在第一个时间步之后，找到过冲幅值 $A_{\\text{over}} = \\max\\{0, u_0^{1} - U_L\\}$：\n$$\nu_i^0 = \\begin{cases}\nU_L,  i \\le 0, \\\\\nU_R,  i \\ge 1,\n\\end{cases}\n$$\n其中 $U_L  U_R$。\n\n我们来计算 $u_0^1$ 的值。单元 $i=0$ 的更新式为：\n$$u_0^1 = u_0^0 - \\nu\\left(u_{\\frac{1}{2}}^{-} - u_{-\\frac{1}{2}}^{-}\\right)$$\n我们需要确定时间层 $n=0$ 时重构的界面状态 $u_{\\frac{1}{2}}^{-}$ 和 $u_{-\\frac{1}{2}}^{-}$。\n\n首先，我们计算 $n=0$ 时所需的斜率：\n单元 $i=0$ 中的斜率为 $s_0^0$：\n$$s_0^0 = \\frac{u_1^0 - u_{-1}^0}{2}$$\n使用初始条件，$u_1^0 = U_R$ 且 $u_{-1}^0 = U_L$。\n$$s_0^0 = \\frac{U_R - U_L}{2}$$\n单元 $i=-1$ 中的斜率为 $s_{-1}^0$：\n$$s_{-1}^0 = \\frac{u_0^0 - u_{-2}^0}{2}$$\n使用初始条件，$u_0^0 = U_L$ 且 $u_{-2}^0 = U_L$。\n$$s_{-1}^0 = \\frac{U_L - U_L}{2} = 0$$\n\n现在，我们可以求出界面上的重构状态：\n状态 $u_{\\frac{1}{2}}^{-}$ 从单元 $i=0$ 重构：\n$$u_{\\frac{1}{2}}^{-} = u_0^0 + \\frac{1}{2}s_0^0 = U_L + \\frac{1}{2}\\left(\\frac{U_R - U_L}{2}\\right) = U_L + \\frac{U_R - U_L}{4}$$\n状态 $u_{-\\frac{1}{2}}^{-}$ 从单元 $i=-1$ 重构：\n$$u_{-\\frac{1}{2}}^{-} = u_{-1}^0 + \\frac{1}{2}s_{-1}^0 = U_L + \\frac{1}{2}(0) = U_L$$\n\n将这些界面状态代回到 $u_0^1$ 的更新方程中：\n$$u_0^1 = u_0^0 - \\nu\\left( \\left(U_L + \\frac{U_R - U_L}{4}\\right) - U_L \\right)$$\n由于 $u_0^0 = U_L$，这可以简化为：\n$$u_0^1 = U_L - \\nu\\left(\\frac{U_R - U_L}{4}\\right)$$\n\n现在我们分析这个结果来证明单调性的失效。如果一个格式不引入新的极值，则称其为单调的。更新单元 $i=0$ 的模板涉及到来自单元 $i=-2, -1, 0, 1$ 的值。初始值为 $u_{-2}^0=U_L$、$u_{-1}^0=U_L$、$u_0^0=U_L$ 和 $u_1^0=U_R$。给定 $U_L  U_R$，邻域内的最大值为 $U_L$。单调性要求 $u_0^1 \\le U_L$。我们来检验这个条件：\n$$u_0^1 - U_L = -\\nu\\left(\\frac{U_R - U_L}{4}\\right)$$\n我们可以将括号中的项重写为 $-(U_L - U_R)$。\n$$u_0^1 - U_L = -\\nu\\left(\\frac{-(U_L - U_R)}{4}\\right) = \\frac{\\nu(U_L - U_R)}{4}$$\n我们已知 $\\nu  0$ 且 $U_L  U_R$。这意味着 $(U_L - U_R)  0$。因此，乘积 $\\frac{\\nu(U_L - U_R)}{4}$ 严格为正。\n$$u_0^1 - U_L  0 \\implies u_0^1  U_L$$\n单元 $0$ 中的更新值超过了其邻域内的初始最大值。这种新局部最大值的产生明显违反了单调性原理，证明了该格式的单调性失效。这种现象被称为过冲 (overshoot)。\n\n最后，我们计算过冲幅值，其定义为 $A_{\\text{over}} = \\max\\{0, u_0^1 - U_L\\}$。\n因为我们刚刚证明了 $u_0^1 - U_L  0$，所以 $\\max$ 函数是多余的，我们有：\n$$A_{\\text{over}} = u_0^1 - U_L$$\n代入我们求得的 $u_0^1-U_L$ 的表达式：\n$$A_{\\text{over}} = \\frac{\\nu(U_L - U_R)}{4}$$\n这就是第一个时间步的过冲幅值的闭式表达式。",
            "answer": "$$\n\\boxed{\\frac{\\nu(U_L - U_R)}{4}}\n$$"
        },
        {
            "introduction": "为抑制高阶格式的振荡，现代CFD方法普遍采用通量限制器。然而，限制器的设计必须遵循严格的数学理论，如Sweby条件，以保证格式的TVD性质。在本练习中，您将使用一个特意设计的、违反了TVD条件的“坏”限制器进行计算，亲眼见证新极值的产生以及总变差的增加，从而巩固对TVD理论重要性的认识。",
            "id": "3976741",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其平流速度 $a  0$ 为常数。在间距为 $\\Delta x$ 的均匀网格上进行有限体积离散化，使用带有通量限制器 $\\phi(r)$ 的守恒律单调上游中心格式 (MUSCL) 型分段线性重构，在界面 $x_{i+1/2}$ 处的数值通量定义如下。对于 $a  0$，界面 $x_{i+1/2}$ 处的左状态为\n$$\nu_{i+1/2}^{-} = u_{i} + \\frac{1}{2}\\,\\phi(r_{i})\\,(u_{i} - u_{i-1}),\n$$\n其中连续斜率之比为\n$$\nr_{i} = \\frac{u_{i} - u_{i-1}}{u_{i+1} - u_{i}},\n$$\n只要分母不为零，且迎风数值通量为 $F_{i+1/2} = a\\,u_{i+1/2}^{-}$。一个显式欧拉时间步 $\\Delta t$ 内的更新为\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda\\,(F_{i+1/2}^{n} - F_{i-1/2}^{n}), \\quad \\lambda \\equiv \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\n设区域为周期性的，有 $N=3$ 个单元，索引为 $i \\in \\{0,1,2\\}$，并具有周期性包裹 $u_{-1} \\equiv u_{2}$ 和 $u_{3} \\equiv u_{0}$。在周期性网格上定义离散全变分 $TV_{d}$ 为\n$$\nTV_{d}(u) = \\sum_{i=0}^{N-1} \\left|u_{i+1} - u_{i}\\right|, \\quad u_{N} \\equiv u_{0}.\n$$\n在全变分递减 (TVD) 理论中，Sweby 条件对 $\\phi(r)$ 进行了约束，以确保该格式不会产生新的极值，也不会增加 $TV_{d}$。在本问题中，通过选择以下限制器来故意违反这些条件\n$$\n\\phi_{\\text{bad}}(r) = 3 \\quad \\text{对于所有实数 } r.\n$$\n取 $a = 1$，Courant–Friedrichs–Lewy (CFL) 数 $\\lambda = \\frac{1}{2}$，以及初始单元平均值\n$$\nu_{0}^{n} = 0, \\quad u_{1}^{n} = 1, \\quad u_{2}^{n} = 2.\n$$\n从上述基本守恒更新和定义出发，完成以下任务：\n1. 参考 TVD 框架和 Sweby 约束，简明解释为什么 $\\phi_{\\text{bad}}(r)$ 违反了 TVD 容许区域。\n2. 计算 $i \\in \\{0,1,2\\}$ 时的 $u_{i+1/2}^{-}$、相应的通量 $F_{i+1/2}$ 以及更新后的单元平均值 $u_{i}^{n+1}$。\n3. 计算 $TV_{d}(u^{n})$ 和 $TV_{d}(u^{n+1})$，并证明该更新产生了新的极值。\n4. 报告单一标量 $\\Delta TV_{d} \\equiv TV_{d}(u^{n+1}) - TV_{d}(u^{n})$ 作为你的最终答案。以精确形式表示最终答案，无需四舍五入。",
            "solution": "用户提供了一个关于一维线性平流方程数值格式的问题陈述。任务是分析一个特定的非全变分递减 (non-TVD) 格式的性质。\n\n### 步骤 1：提取已知条件\n- **控制方程**：$u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数。\n- **离散化**：在间距为 $\\Delta x$ 的均匀网格上的有限体积法。\n- **重构**：守恒律单调上游中心格式 (MUSCL) 分段线性重构。对于 $a  0$，界面 $x_{i+1/2}$ 处的左状态为 $u_{i+1/2}^{-} = u_{i} + \\frac{1}{2}\\,\\phi(r_{i})\\,(u_{i} - u_{i-1})$。\n- **斜率比**：$r_{i} = \\frac{u_{i} - u_{i-1}}{u_{i+1} - u_{i}}$。\n- **数值通量**：迎风通量 $F_{i+1/2} = a\\,u_{i+1/2}^{-}$。\n- **时间积分**：显式欧拉法，更新公式为 $u_{i}^{n+1} = u_{i}^{n} - \\lambda\\,(F_{i+1/2}^{n} - F_{i-1/2}^{n})$，其中 $\\lambda \\equiv \\frac{a\\,\\Delta t}{\\Delta x}$。\n- **区域**：具有 $N=3$ 个单元的周期性区域，索引为 $i \\in \\{0,1,2\\}$。\n- **周期性边界条件**：$u_{-1} \\equiv u_{2}$ 和 $u_{3} \\equiv u_{0}$。\n- **全变分定义**：$TV_{d}(u) = \\sum_{i=0}^{N-1} |u_{i+1} - u_{i}|$，其中 $u_{N} \\equiv u_{0}$。\n- **通量限制器**：$\\phi_{\\text{bad}}(r) = 3$，对于所有实数 $r$。\n- **常数**：$a = 1$，$\\lambda = \\frac{1}{2}$。\n- **初始条件**：$u_{0}^{n} = 0$，$u_{1}^{n} = 1$, $u_{2}^{n} = 2$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在双曲守恒律数值方法的既定理论中有坚实的科学基础。它提出了一个明确定义的计算练习，以展示违反 TVD 条件的后果。所有必要的已知条件都已提供，并且没有内部矛盾。语言客观、正式。使用“坏”限制器是说明 TVD 约束重要性的标准教学工具。因此，该问题被认为是**有效的**。\n\n### 步骤 3：求解\n该问题要求完成四个任务。\n\n**1. 违反 TVD 条件**\n\n如果离散解的全变分不随时间增加，即 $TV_{d}(u^{n+1}) \\le TV_{d}(u^{n})$，则数值格式是 TVD 的。对于带有显式欧拉时间步的 MUSCL 型格式，为确保格式是 TVD 的，对通量限制器 $\\phi(r)$ 的条件在 Sweby 图中被制定。对于给定的 $a0$ 的格式，当 $r0$ 且 Courant 数为 $\\lambda$ 时，对 $\\phi(r)$ 的充分条件是：\n$$0 \\leq \\phi(r) \\leq 2$$\n$$0 \\leq \\frac{\\phi(r)}{r} \\leq \\frac{2}{\\lambda}$$\n给定的限制器是对于所有 $r$ 值，$\\phi_{\\text{bad}}(r) = 3$。这直接违反了第一个条件 $0 \\leq \\phi(r) \\leq 2$。$\\phi(r)  2$ 的值对应于过度反扩散（或压缩）的重构，这会以不受控制的方式使梯度变陡，导致伪振荡和新极值的产生。这违反了 TVD 格式的核心原则，即防止此类非物理行为。\n\n**2. 计算更新后的单元平均值**\n\n我们已知 $a = 1$, $\\lambda = \\frac{1}{2}$，以及初始状态 $u^{n} = (u_0^n, u_1^n, u_2^n) = (0, 1, 2)$。周期性边界条件意味着 $u_{-1}^n = u_2^n = 2$ 和 $u_3^n = u_0^n = 0$。通量限制器为 $\\phi(r) = 3$。\n\n我们首先计算 $i \\in \\{0, 1, 2\\}$ 的斜率比 $r_i$：\n- 对于 $i=0$: $r_0 = \\frac{u_0^n - u_{-1}^n}{u_1^n - u_0^n} = \\frac{0 - 2}{1 - 0} = -2$.\n- 对于 $i=1$: $r_1 = \\frac{u_1^n - u_0^n}{u_2^n - u_1^n} = \\frac{1 - 0}{2 - 1} = 1$.\n- 对于 $i=2$: $r_2 = \\frac{u_2^n - u_1^n}{u_3^n - u_2^n} = \\frac{2 - 1}{0 - 2} = -\\frac{1}{2}$.\n\n接下来，我们计算单元界面处的重构状态 $u_{i+1/2}^{-}$：\n- 对于 $i=0$: $u_{1/2}^{-} = u_0^n + \\frac{1}{2}\\phi(r_0)(u_0^n - u_{-1}^n) = 0 + \\frac{1}{2}(3)(0 - 2) = -3$.\n- 对于 $i=1$: $u_{3/2}^{-} = u_1^n + \\frac{1}{2}\\phi(r_1)(u_1^n - u_0^n) = 1 + \\frac{1}{2}(3)(1 - 0) = 1 + \\frac{3}{2} = \\frac{5}{2}$.\n- 对于 $i=2$: $u_{5/2}^{-} = u_2^n + \\frac{1}{2}\\phi(r_2)(u_2^n - u_1^n) = 2 + \\frac{1}{2}(3)(2 - 1) = 2 + \\frac{3}{2} = \\frac{7}{2}$.\n\n数值通量为 $F_{i+1/2} = a u_{i+1/2}^{-} = 1 \\cdot u_{i+1/2}^{-}$。\n- $F_{1/2} = -3$.\n- $F_{3/2} = \\frac{5}{2}$.\n- $F_{5/2} = \\frac{7}{2}$.\n根据周期性，界面 $x_{-1/2}$ 处的通量等于 $x_{5/2}$ 处的通量，因此 $F_{-1/2} = F_{5/2} = \\frac{7}{2}$。\n\n现在，我们使用 $u_{i}^{n+1} = u_{i}^{n} - \\lambda(F_{i+1/2} - F_{i-1/2})$ 并取 $\\lambda = \\frac{1}{2}$ 来更新单元平均值：\n- 对于 $i=0$: $u_0^{n+1} = u_0^n - \\frac{1}{2}(F_{1/2} - F_{-1/2}) = 0 - \\frac{1}{2}(-3 - \\frac{7}{2}) = -\\frac{1}{2}(-\\frac{13}{2}) = \\frac{13}{4}$.\n- 对于 $i=1$: $u_1^{n+1} = u_1^n - \\frac{1}{2}(F_{3/2} - F_{1/2}) = 1 - \\frac{1}{2}(\\frac{5}{2} - (-3)) = 1 - \\frac{1}{2}(\\frac{11}{2}) = 1 - \\frac{11}{4} = -\\frac{7}{4}$.\n- 对于 $i=2$: $u_2^{n+1} = u_2^n - \\frac{1}{2}(F_{5/2} - F_{3/2}) = 2 - \\frac{1}{2}(\\frac{7}{2} - \\frac{5}{2}) = 2 - \\frac{1}{2}(1) = \\frac{3}{2} = \\frac{6}{4}$.\n更新后的状态是 $u^{n+1} = (\\frac{13}{4}, -\\frac{7}{4}, \\frac{6}{4})$。\n\n**3. 全变分与新极值**\n\n首先，我们计算初始状态 $u^{n} = (0, 1, 2)$ 的全变分：\n$$TV_{d}(u^{n}) = |u_1^n - u_0^n| + |u_2^n - u_1^n| + |u_0^n - u_2^n| = |1-0| + |2-1| + |0-2| = 1 + 1 + 2 = 4.$$\n接下来，我们计算更新后状态 $u^{n+1} = (\\frac{13}{4}, -\\frac{7}{4}, \\frac{6}{4})$ 的全变分：\n$$\n\\begin{aligned}\nTV_{d}(u^{n+1}) = |u_1^{n+1} - u_0^{n+1}| + |u_2^{n+1} - u_1^{n+1}| + |u_0^{n+1} - u_2^{n+1}| \\\\\n= \\left|-\\frac{7}{4} - \\frac{13}{4}\\right| + \\left|\\frac{6}{4} - \\left(-\\frac{7}{4}\\right)\\right| + \\left|\\frac{13}{4} - \\frac{6}{4}\\right| \\\\\n= \\left|-\\frac{20}{4}\\right| + \\left|\\frac{13}{4}\\right| + \\left|\\frac{7}{4}\\right| \\\\\n= 5 + \\frac{13}{4} + \\frac{7}{4} = 5 + \\frac{20}{4} = 5 + 5 = 10.\n\\end{aligned}\n$$\n全变分从 $TV_{d}(u^{n}) = 4$ 增加到 $TV_{d}(u^{n+1}) = 10$，这证实了该格式不是 TVD 的。\n\n一个 TVD 格式也满足极值原理，意味着它不会产生新的全局极值。初始数据的范围是 $[\\min(u^n), \\max(u^n)] = [0, 2]$。更新后解的范围是 $[\\min(u^{n+1}), \\max(u^{n+1})] = [-\\frac{7}{4}, \\frac{13}{4}] = [-1.75, 3.25]$。由于新的最大值 $u_0^{n+1} = 3.25$ 大于初始最大值 2，而新的最小值 $u_1^{n+1} = -1.75$ 小于初始最小值 0，该格式产生了新的极值，这是非 TVD 格式的一个特征性失效表现。\n\n**4. 全变分的变化**\n\n离散全变分的变化计算如下：\n$$\\Delta TV_{d} = TV_{d}(u^{n+1}) - TV_{d}(u^{n}) = 10 - 4 = 6.$$",
            "answer": "$$\n\\boxed{6}\n$$"
        }
    ]
}