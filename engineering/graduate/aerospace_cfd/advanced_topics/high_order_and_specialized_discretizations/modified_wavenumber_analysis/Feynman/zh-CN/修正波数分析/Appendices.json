{
    "hands_on_practices": [
        {
            "introduction": "分析任何数值格式性能的第一步，是理解其在极限情况下的行为。这个练习将重点放在网格能解析的最高波数——奈奎斯特极限（Nyquist limit）上 。通过为常见的中心差分格式计算相位误差，您将具体地揭示这些格式的一个基本限制，从而巩固对修正波数的核心定义以及其与色散误差之间关系的理解。",
            "id": "3976409",
            "problem": "在计算流体动力学（CFD, Computational Fluid Dynamics）中，一个一维空间周期标量场在间距为 $\\Delta x$ 的均匀网格上进行采样。为使用修正波数分析法分析离散空间微分算子的色散特性，请考虑两种中心有限差分格式的作用，这两种格式用于近似内部网格点上的一阶空间导数 $\\partial u/\\partial x$：\n- 二阶中心差分：$D^{(2)} u_{j} = \\left(u_{j+1} - u_{j-1}\\right)/(2 \\Delta x)$。\n- 四阶中心差分：$D^{(4)} u_{j} = \\left(-u_{j+2} + 8 u_{j+1} - 8 u_{j-1} + u_{j-2}\\right)/(12 \\Delta x)$。\n\n设一个离散傅里叶模式为 $u_{j} = \\exp\\!\\left(i \\kappa j\\right)$，其中无量纲波数为 $\\kappa = k \\Delta x$，$k$ 是物理波数。对于作用在 $u_{j}$ 上的每种格式 $D$，修正波数 $\\tilde{k}(\\kappa)$ 由关系式 $D u_{j} = i \\tilde{k}(\\kappa)\\, u_{j}$ 定义。\n\n从上述定义和差分格式出发，并且仅基于基本采样论证和傅里叶模式属性，完成以下任务：\n1) 确定网格的奈奎斯特波数 $k_{N}$。基于可分辨正弦波的最小采样要求来证明你的结果。以 $\\Delta x$ 的符号形式报告 $k_{N}$；不附加单位。\n2) 对于每种格式，计算在无量纲奈奎斯特模式 $\\kappa = \\pi$ 处的相位误差大小，该误差定义为 $\\left|\\operatorname{Re}\\tilde{k}(\\kappa) - k\\right|/k$。此处 $\\operatorname{Re}\\tilde{k}$ 表示 $\\tilde{k}$ 的实部。将每个相位误差表示为不进行四舍五入的精确数值。\n\n将你的最终答案表示为单行矩阵 $\\left[k_{N}, E_{2}, E_{4}\\right]$，其中 $E_{2}$ 和 $E_{4}$ 分别是二阶和四阶中心差分格式在 $\\kappa=\\pi$ 处的相位误差大小。无需四舍五入。量 $\\kappa$ 是无量纲的，$k_{N}$ 必须以 $\\Delta x$ 的符号形式报告，不带单位。相位误差大小是无量纲的。",
            "solution": "该问题要求对均匀网格上的离散微分算子进行两部分分析：首先，确定奈奎斯特波数；其次，计算两种特定有限差分格式在奈奎斯特极限下的相位误差。\n\n第一部分：确定奈奎斯特波数 $k_N$\n\nNyquist-Shannon采样定理是控制在离散间隔上采样的连续信号分辨率的基本原理。对于空间周期信号，该定理规定，一个给定波长为 $\\lambda$ 的正弦分量只有在采样率大于其频率两倍时才能被无歧义地分辨。在空间域中，这意味着每个波长我们必须至少有两个采样点。\n\n给定一个间距为 $\\Delta x$ 的均匀网格，分辨波数为 $k = 2\\pi/\\lambda$ 的波的最小采样条件是：\n$$2 \\Delta x \\le \\lambda$$\n将 $\\lambda = 2\\pi/k$ 代入不等式得到：\n$$2 \\Delta x \\le \\frac{2\\pi}{k}$$\n$$k \\Delta x \\le \\pi$$\n这个不等式定义了网格可以分辨的波数范围。最大可分辨波数是奈奎斯特波数 $k_N$，它对应于每个波长恰好有两个采样点的情况。这发生在不等式的上限处：\n$$k_N \\Delta x = \\pi$$\n求解 $k_N$ 可得以网格间距 $\\Delta x$ 表示的奈奎斯特波数：\n$$k_N = \\frac{\\pi}{\\Delta x}$$\n相应的无量纲波数是 $\\kappa_N = k_N \\Delta x = \\pi$，它表示网格可以分辨的最高频率模式。\n\n第二部分：修正波数分析与相位误差评估\n\n修正波数 $\\tilde{k}(\\kappa)$ 表征了数值微分格式如何作用于傅里叶模式。它由关系式 $D u_j = i \\tilde{k}(\\kappa) u_j$ 定义，其中 $u_j = \\exp(i \\kappa j)$ 是一个离散傅里叶模式，$\\kappa = k \\Delta x$ 是无量纲波数，$D$ 是微分算子。其连续对应物 $u(x) = \\exp(ikx)$ 的精确一阶导数是 $\\partial u/\\partial x = iku$。修正波数 $\\tilde{k}$ 是数值格式中与精确波数 $k$ 相对应的量。\n\n我们现在推导每种指定格式的修正波数。\n\n对于二阶中心差分格式 $D^{(2)} u_j = \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}$：\n我们将此算子应用于模式 $u_j = \\exp(i \\kappa j)$。\n$$D^{(2)} u_j = \\frac{\\exp(i \\kappa (j+1)) - \\exp(i \\kappa (j-1))}{2 \\Delta x}$$\n提出因子 $u_j = \\exp(i \\kappa j)$：\n$$D^{(2)} u_j = \\frac{\\exp(i \\kappa j) (\\exp(i \\kappa) - \\exp(-i \\kappa))}{2 \\Delta x} = u_j \\frac{\\exp(i \\kappa) - \\exp(-i \\kappa)}{2 \\Delta x}$$\n使用欧拉公式 $\\sin(\\theta) = (\\exp(i\\theta) - \\exp(-i\\theta))/(2i)$，我们有 $\\exp(i\\kappa) - \\exp(-i\\kappa) = 2i\\sin(\\kappa)$。\n$$D^{(2)} u_j = u_j \\frac{2i\\sin(\\kappa)}{2 \\Delta x} = i \\left( \\frac{\\sin(\\kappa)}{\\Delta x} \\right) u_j$$\n通过与定义 $D^{(2)} u_j = i \\tilde{k}^{(2)}(\\kappa) u_j$ 进行比较，我们确定二阶格式的修正波数为：\n$$\\tilde{k}^{(2)}(\\kappa) = \\frac{\\sin(\\kappa)}{\\Delta x}$$\n\n对于四阶中心差分格式 $D^{(4)} u_j = \\frac{-u_{j+2} + 8 u_{j+1} - 8 u_{j-1} + u_{j-2}}{12 \\Delta x}$：\n将此算子应用于 $u_j$：\n$$D^{(4)} u_j = \\frac{-\\exp(i \\kappa (j+2)) + 8\\exp(i \\kappa (j+1)) - 8\\exp(i \\kappa (j-1)) + \\exp(i \\kappa (j-2))}{12 \\Delta x}$$\n提出因子 $u_j = \\exp(i \\kappa j)$：\n$$D^{(4)} u_j = u_j \\frac{-\\exp(i 2\\kappa) + 8\\exp(i \\kappa) - 8\\exp(-i \\kappa) + \\exp(-i 2\\kappa)}{12 \\Delta x}$$\n对各项进行分组：\n$$D^{(4)} u_j = u_j \\frac{8(\\exp(i \\kappa) - \\exp(-i \\kappa)) - (\\exp(i 2\\kappa) - \\exp(-i 2\\kappa))}{12 \\Delta x}$$\n使用恒等式 $2i\\sin(n\\theta) = \\exp(in\\theta) - \\exp(-in\\theta)$：\n$$D^{(4)} u_j = u_j \\frac{8(2i\\sin(\\kappa)) - (2i\\sin(2\\kappa))}{12 \\Delta x} = i \\left( \\frac{16\\sin(\\kappa) - 2\\sin(2\\kappa)}{12 \\Delta x} \\right) u_j$$\n简化表达式：\n$$D^{(4)} u_j = i \\left( \\frac{8\\sin(\\kappa) - \\sin(2\\kappa)}{6 \\Delta x} \\right) u_j$$\n通过与定义 $D^{(4)} u_j = i \\tilde{k}^{(4)}(\\kappa) u_j$ 进行比较，我们确定四阶格式的修正波数为：\n$$\\tilde{k}^{(4)}(\\kappa) = \\frac{8\\sin(\\kappa) - \\sin(2\\kappa)}{6 \\Delta x}$$\n\n现在，我们计算在无量纲奈奎斯特模式 $\\kappa = \\pi$ 处的相位误差大小。相位误差大小定义为 $E = |\\operatorname{Re}\\tilde{k}(\\kappa) - k|/k$。在 $\\kappa=\\pi$ 时，精确波数是奈奎斯特波数 $k = k_N = \\pi/\\Delta x$。对于这两种中心差分格式，推导出的修正波数 $\\tilde{k}^{(2)}$ 和 $\\tilde{k}^{(4)}$ 都是纯实函数，因此 $\\operatorname{Re}\\tilde{k} = \\tilde{k}$。\n\n对于二阶格式，在 $\\kappa = \\pi$ 处的相位误差 $E_2$ 为：\n首先，我们计算修正波数：\n$$\\tilde{k}^{(2)}(\\pi) = \\frac{\\sin(\\pi)}{\\Delta x} = \\frac{0}{\\Delta x} = 0$$\n然后我们计算误差：\n$$E_2 = \\frac{|\\tilde{k}^{(2)}(\\pi) - k_N|}{k_N} = \\frac{|0 - \\pi/\\Delta x|}{\\pi/\\Delta x} = \\frac{\\pi/\\Delta x}{\\pi/\\Delta x} = 1$$\n\n对于四阶格式，在 $\\kappa = \\pi$ 处的相位误差 $E_4$ 为：\n首先，我们计算修正波数：\n$$\\tilde{k}^{(4)}(\\pi) = \\frac{8\\sin(\\pi) - \\sin(2\\pi)}{6 \\Delta x} = \\frac{8(0) - 0}{6 \\Delta x} = 0$$\n然后我们计算误差：\n$$E_4 = \\frac{|\\tilde{k}^{(4)}(\\pi) - k_N|}{k_N} = \\frac{|0 - \\pi/\\Delta x|}{\\pi/\\Delta x} = \\frac{\\pi/\\Delta x}{\\pi/\\Delta x} = 1$$\n对于 $2\\Delta x$ 波（即 $\\kappa=\\pi$ 处的模式），两种格式得到的修正波数均为零，这意味着它们无法检测到最高可分辨频率的任何梯度。这导致两种格式的相位误差均为 $100\\%$。\n\n最终答案是行矩阵 $\\left[k_{N}, E_{2}, E_{4}\\right]$，其中 $k_N = \\pi/\\Delta x$，$E_2 = 1$，$E_4 = 1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\pi}{\\Delta x}  & 1  & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "中心差分格式的修正波数是纯实数，因此它们只引入色散误差。然而，许多在计算流体力学（CFD）中至关重要的格式（如迎风格式）是不对称的，这会引入一个复数修正波数。这个练习将向您展示如何推导这个复数，并解释其虚部如何量化数值耗散（或可能导致不稳定的反耗散）。通过分析一个非对称格式，您将学会如何同时评估相位和振幅误差，从而更全面地了解一个数值格式的性能。",
            "id": "3976416",
            "problem": "考虑计算流体力学(CFD)中的一维线性平流问题，其控制方程为偏微分方程 $u_{t} + a\\,u_{x} = 0$。其中平流速度 $a$ 为常数，空间上在间距为 $\\Delta x$ 的均匀网格上进行离散，节点由整数 $j$ 索引。空间导数 $u_{x}$ 由离散线性算子 $(Du)_{j}$ 近似，其定义为\n$$(Du)_{j} \\;=\\; \\frac{-\\,u_{j+2} \\;+\\; 6\\,u_{j+1} \\;-\\; 3\\,u_{j} \\;-\\; 2\\,u_{j-1}}{6\\,\\Delta x}.$$\n在修正波数分析中，对于无量纲波数为 $\\kappa = k\\,\\Delta x$（角度单位为弧度）的傅里叶模态 $u_{j} = \\hat{u}\\,\\exp(i\\,j\\,\\kappa)$，该算子的作用可表示为 $(Du)_{j} = i\\,\\tilde{k}(\\kappa)\\,u_{j}$，其中 $\\tilde{k}(\\kappa)$ 是复修正波数。从线性平流方程和修正波数的定义出发，推导与给定离散算子相关的 $\\tilde{k}(\\kappa)$ 的精确闭式表达式。然后，通过计算在最高可分辨无量纲波数 $\\kappa = \\pi$（角度单位为弧度）处 $\\tilde{k}(\\kappa)$ 的虚部，来评估该格式的高波数耗散特性。\n\n你的最终答案必须以行矩阵的形式给出，其第一个元素是 $\\tilde{k}(\\kappa)$ 的解析表达式，第二个元素是 $\\operatorname{Im}\\tilde{k}(\\pi)$ 的精确值。不需要进行数值四舍五入。在最终的方框答案中不要包含单位。",
            "solution": "该问题陈述被认为是有效的，因为它科学地基于偏微分方程数值分析的原理，特别是有限差分格式的修正波数分析。该问题提法适定、客观，并包含了获得唯一解所需的所有信息。\n\n任务是为一个给定的离散空间算子推导复修正波数 $\\tilde{k}(\\kappa)$，然后在一个特定的无量纲波数处计算其虚部。\n\n用于空间导数 $u_x$ 的离散算子由下式给出\n$$ (Du)_{j} \\;=\\; \\frac{-\\,u_{j+2} \\;+\\; 6\\,u_{j+1} \\;-\\; 3\\,u_{j} \\;-\\; 2\\,u_{j-1}}{6\\,\\Delta x} $$\n我们分析该算子对单个傅里叶模态 $u_{j} = \\hat{u}\\,\\exp(i\\,j\\,\\kappa)$ 的作用，其中 $\\kappa = k\\,\\Delta x$ 是无量纲波数，$k$ 是物理波数，$i$ 是虚数单位。\n\n相邻网格点上的值用 $u_j$ 表示如下：\n\\begin{itemize}\n    \\item $u_{j+2} = \\hat{u}\\,\\exp(i\\,(j+2)\\,\\kappa) = \\hat{u}\\,\\exp(i\\,j\\,\\kappa)\\,\\exp(i\\,2\\,\\kappa) = u_j\\,\\exp(i\\,2\\,\\kappa)$\n    \\item $u_{j+1} = \\hat{u}\\,\\exp(i\\,(j+1)\\,\\kappa) = \\hat{u}\\,\\exp(i\\,j\\,\\kappa)\\,\\exp(i\\,\\kappa) = u_j\\,\\exp(i\\,\\kappa)$\n    \\item $u_{j-1} = \\hat{u}\\,\\exp(i\\,(j-1)\\,\\kappa) = \\hat{u}\\,\\exp(i\\,j\\,\\kappa)\\,\\exp(-i\\,\\kappa) = u_j\\,\\exp(-i\\,\\kappa)$\n\\end{itemize}\n将这些代入离散算子表达式中：\n$$ (Du)_{j} = \\frac{-\\,u_j\\,\\exp(i\\,2\\,\\kappa) \\;+\\; 6\\,u_j\\,\\exp(i\\,\\kappa) \\;-\\; 3\\,u_j \\;-\\; 2\\,u_j\\,\\exp(-i\\,\\kappa)}{6\\,\\Delta x} $$\n我们提出公因式 $u_j$：\n$$ (Du)_{j} = u_j \\left( \\frac{-\\,\\exp(i\\,2\\,\\kappa) \\;+\\; 6\\,\\exp(i\\,\\kappa) \\;-\\; 3 \\;-\\; 2\\,\\exp(-i\\,\\kappa)}{6\\,\\Delta x} \\right) $$\n复修正波数 $\\tilde{k}(\\kappa)$ 的定义由关系式 $(Du)_{j} = i\\,\\tilde{k}(\\kappa)\\,u_{j}$ 给出。将其与上述表达式相等，我们得到：\n$$ i\\,\\tilde{k}(\\kappa)\\,u_{j} = u_j \\left( \\frac{-\\,\\exp(i\\,2\\,\\kappa) \\;+\\; 6\\,\\exp(i\\,\\kappa) \\;-\\; 3 \\;-\\; 2\\,\\exp(-i\\,\\kappa)}{6\\,\\Delta x} \\right) $$\n我们可以消去两边的 $u_j$ 并求解 $\\tilde{k}(\\kappa)$：\n$$ \\tilde{k}(\\kappa) = \\frac{1}{i} \\left( \\frac{-\\,\\exp(i\\,2\\,\\kappa) \\;+\\; 6\\,\\exp(i\\,\\kappa) \\;-\\; 3 \\;-\\; 2\\,\\exp(-i\\,\\kappa)}{6\\,\\Delta x} \\right) $$\n$$ \\tilde{k}(\\kappa) = \\frac{-i}{6\\,\\Delta x} \\left[ - \\exp(i\\,2\\,\\kappa) + 6\\,\\exp(i\\,\\kappa) - 3 - 2\\,\\exp(-i\\,\\kappa) \\right] $$\n为了求出 $\\tilde{k}(\\kappa)$ 的实部和虚部，我们使用欧拉公式 $\\exp(i\\theta) = \\cos(\\theta) + i\\sin(\\theta)$。我们展开方括号中的项：\n$$ \\left[ \\dots \\right] = -\\left(\\cos(2\\kappa) + i\\sin(2\\kappa)\\right) + 6\\left(\\cos(\\kappa) + i\\sin(\\kappa)\\right) - 3 - 2\\left(\\cos(\\kappa) - i\\sin(\\kappa)\\right) $$\n分别对实部项和虚部项进行分组：\n$$ \\left[ \\dots \\right] = \\left(-\\cos(2\\kappa) + 4\\cos(\\kappa) - 3\\right) + i\\left(-\\sin(2\\kappa) + 8\\sin(\\kappa)\\right) $$\n现在，我们将其代回 $\\tilde{k}(\\kappa)$ 的表达式中，并乘以 $-i$：\n$$ \\tilde{k}(\\kappa) = \\frac{-i}{6\\,\\Delta x} \\left[ \\left(-\\cos(2\\kappa) + 4\\cos(\\kappa) - 3\\right) + i\\left(-\\sin(2\\kappa) + 8\\sin(\\kappa)\\right) \\right] $$\n$$ \\tilde{k}(\\kappa) = \\frac{1}{6\\,\\Delta x} \\left[ -i\\left(-\\cos(2\\kappa) + 4\\cos(\\kappa) - 3\\right) -i^2\\left(-\\sin(2\\kappa) + 8\\sin(\\kappa)\\right) \\right] $$\n由于 $-i^2 = 1$，我们有：\n$$ \\tilde{k}(\\kappa) = \\frac{1}{6\\,\\Delta x} \\left[ \\left(8\\sin(\\kappa) - \\sin(2\\kappa)\\right) + i\\left(\\cos(2\\kappa) - 4\\cos(\\kappa) + 3\\right) \\right] $$\n这就是复修正波数的闭式表达式。我们可以使用三角恒等式来简化其实部和虚部。\n实部为：\n$$ \\operatorname{Re}\\tilde{k}(\\kappa) = \\frac{1}{6\\,\\Delta x} \\left(8\\sin(\\kappa) - \\sin(2\\kappa)\\right) = \\frac{1}{6\\,\\Delta x} \\left(8\\sin(\\kappa) - 2\\sin(\\kappa)\\cos(\\kappa)\\right) = \\frac{\\sin(\\kappa)(4 - \\cos(\\kappa))}{3\\,\\Delta x} $$\n虚部为：\n$$ \\operatorname{Im}\\tilde{k}(\\kappa) = \\frac{1}{6\\,\\Delta x} \\left(\\cos(2\\kappa) - 4\\cos(\\kappa) + 3\\right) = \\frac{1}{6\\,\\Delta x} \\left((2\\cos^2(\\kappa) - 1) - 4\\cos(\\kappa) + 3\\right) $$\n$$ \\operatorname{Im}\\tilde{k}(\\kappa) = \\frac{1}{6\\,\\Delta x} \\left(2\\cos^2(\\kappa) - 4\\cos(\\kappa) + 2\\right) = \\frac{2}{6\\,\\Delta x} \\left(\\cos^2(\\kappa) - 2\\cos(\\kappa) + 1\\right) = \\frac{(\\cos(\\kappa) - 1)^2}{3\\,\\Delta x} $$\n结合简化后的实部和虚部，$\\tilde{k}(\\kappa)$ 的最终表达式为：\n$$ \\tilde{k}(\\kappa) = \\frac{1}{3\\,\\Delta x} \\left[ \\sin(\\kappa)(4 - \\cos(\\kappa)) + i(\\cos(\\kappa) - 1)^2 \\right] $$\n问题的第二部分要求计算在最高可分辨无量纲波数 $\\kappa = \\pi$ 处 $\\tilde{k}(\\kappa)$ 的虚部。这对应于波长为 $2\\Delta x$，即网格的奈奎斯特极限。\n使用虚部的简化表达式：\n$$ \\operatorname{Im}\\tilde{k}(\\pi) = \\frac{(\\cos(\\pi) - 1)^2}{3\\,\\Delta x} $$\n我们代入值 $\\cos(\\pi) = -1$：\n$$ \\operatorname{Im}\\tilde{k}(\\pi) = \\frac{(-1 - 1)^2}{3\\,\\Delta x} = \\frac{(-2)^2}{3\\,\\Delta x} = \\frac{4}{3\\,\\Delta x} $$\n$\\tilde{k}$ 的正虚部表明该数值格式是反耗散的，这意味着它会放大相应傅里叶模态的振幅，导致数值不稳定性。结果表明，该格式对于最高波数的模态是不稳定的。\n\n最终答案包含两部分：推导出的 $\\tilde{k}(\\kappa)$ 表达式和 $\\operatorname{Im}\\tilde{k}(\\pi)$ 的具体值。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{3\\,\\Delta x} \\left[ \\sin(\\kappa)(4 - \\cos(\\kappa)) + i(\\cos(\\kappa) - 1)^2 \\right]  & \\frac{4}{3\\,\\Delta x}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "超越分析现有格式的范畴，计算流体力学研究者的一个关键技能是设计满足特定需求的定制格式。这个高级练习将引导您从分析转向综合，您将构建并解决一个约束优化问题，以找到在一系列特定波数上最小化色散误差的模板系数 。这个实践项目展示了修正波数分析不仅是一个诊断工具，更是一个强大的设计工具，能够用于为航空声学等应用创建高保真度的“色散关系保持”（Dispersion-Relation-Preserving, DRP）格式。",
            "id": "3976394",
            "problem": "您需要使用修正波数分析，对用于一阶空间导数计算的优化对称显式有限差分模板系数进行敏感性研究。修正波数分析是计算流体动力学 (CFD) 中广泛使用的工具。考虑一个半径为 $M$ 的线性、位移不变、对称、显式模板，它通过以下公式在网格点 $i$ 处近似 $\\frac{\\partial f}{\\partial x}$：\n$$\n\\left.\\frac{\\partial f}{\\partial x}\\right|_{x_i} \\approx \\frac{1}{\\Delta x}\\sum_{m=1}^{M} c_m \\left(f_{i+m} - f_{i-m}\\right),\n$$\n其中 $\\Delta x$ 是以米为单位的网格间距，$\\{c_m\\}_{m=1}^{M}$ 是无量纲模板系数。对于角波数为 $k$（单位为弧度/米）的纯傅里叶模态 $f(x) = e^{\\mathrm{i} k x}$，其离散导数具有一个修正无量纲波数 $\\tilde{\\kappa}(\\kappa)$，定义为：\n$$\n\\tilde{\\kappa}(\\kappa) = 2 \\sum_{m=1}^{M} c_m \\sin(m \\kappa),\n$$\n其中 $\\kappa = k \\Delta x$ 是以弧度为单位的无量纲波数。精确的无量纲波数是 $\\kappa$。该格式是一致的，当且仅当：\n$$\n2\\sum_{m=1}^{M} m c_m = 1.\n$$\n\n定义一个优化问题，给定物理目标截止波数 $k_c$（单位为弧度/米）和网格间距 $\\Delta x$（单位为米）。令 $K = k_c \\Delta x$ 表示以弧度为单位的无量纲截止波数。选择系数 $\\{c_m\\}$ 以最小化在频带 $[0,K]$ 上的积分平方色散误差，\n$$\n\\mathcal{E}(\\mathbf{c};K) = \\int_{0}^{K} \\left(\\tilde{\\kappa}(\\kappa) - \\kappa \\right)^2 \\, \\mathrm{d}\\kappa,\n$$\n并受线性一致性约束 $2\\sum_{m=1}^{M} m c_m = 1$ 的限制。假设在所有计算中，$M=3$ 固定不变。\n\n待实现的任务：\n1. 从线性位移不变算子的傅里叶分析和 $\\tilde{\\kappa}(\\kappa)$ 的定义出发，推导出 $\\mathcal{E}(\\mathbf{c};K)$ 关于 $\\mathbf{c}$ 的二次型，并识别出对称半正定内积矩阵以及依赖于 $K$ 的线性项。在 $\\kappa \\in [0,K]$ 上使用精确解析积分，并通过拉格朗日乘子施加一致性约束。您的算法必须求解生成的 Karush–Kuhn–Tucker (KKT) 线性系统以获得最优的 $\\mathbf{c}(K)$。\n2. 将优化系数对无量纲截止波数 $K$ 变化的敏感性定义为相对 2-范数敏感性\n$$\nS(K) = \\frac{\\left\\|\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K}\\right\\|_2}{\\left\\|\\mathbf{c}\\right\\|_2} \\, K,\n$$\n通过对称扰动 $\\delta K$ 的中心有限差分进行数值近似，\n$$\n\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K} \\approx \\frac{\\mathbf{c}(K+\\delta K) - \\mathbf{c}(K-\\delta K)}{2 \\, \\delta K},\n$$\n其中您必须选择 $\\delta K = \\max\\left(10^{-6}, 10^{-3} K\\right)$。\n3. 定义鲁棒性决策规则如下：当且仅当 $S(K) \\leq T$ 时，给定 $K$ 下的优化模板是鲁棒的，其中固定阈值 $T = 0.5$。\n4. 在单个程序中实现所有计算，并将其应用于以下测试套件。每个测试案例提供 $(k_c, \\Delta x)$，其中 $k_c$ 的单位是弧度/米，$\\Delta x$ 的单位是米：\n   - 案例 1：$k_c = 20$，$\\Delta x = 0.005$。\n   - 案例 2：$k_c = 100$，$\\Delta x = 0.005$。\n   - 案例 3：$k_c = 250$，$\\Delta x = 0.01$。\n   - 案例 4：$k_c = 300$，$\\Delta x = 0.01$。\n   对于每个案例，计算以弧度为单位的 $K = k_c \\Delta x$、当 $M=3$ 时的优化系数、敏感性 $S(K)$，并使用上述规则确定鲁棒性标志。\n\n角度单位要求：将所有波数角 $\\kappa$ 和 $K$ 视为弧度。\n\n最终输出格式：\n- 您的程序必须生成单行输出，其中包含一个 Python 风格的列表，每个测试案例对应一个条目，顺序与所列顺序相同。每个条目本身必须是一个包含两个元素的列表：敏感性（浮点数，四舍五入到六位小数）和鲁棒性决策（布尔值）。例如，一个包含两个案例的有效输出如下所示：\n\"[ [0.123456,True],[0.654321,False] ]\" 尽管您的程序必须打印与上述四个指定案例相对应的值。\n\n注意：\n- 输出中不需要其他单位，因为敏感性 $S(K)$ 是无量纲的，而鲁棒性标志是布尔值。\n- 确保您的实现对于 $K$ 是通用的，并使用二次型的精确解析积分。",
            "solution": "该问题是有效的。这是一个在计算流体动力学的数值分析领域中适定的、有科学依据的问题。所有必要的数据和定义均已提供，不存在矛盾或歧义。\n\n在此，我们推导用于优化和分析有限差分系数敏感性的解法。模板半径固定为 $M=3$。系数由向量 $\\mathbf{c} = [c_1, c_2, c_3]^T$ 表示。\n\n问题的核心是最小化积分平方色散误差，\n$$\n\\mathcal{E}(\\mathbf{c};K) = \\int_{0}^{K} \\left(\\tilde{\\kappa}(\\kappa) - \\kappa \\right)^2 \\, \\mathrm{d}\\kappa,\n$$\n并满足一致性约束 $2\\sum_{m=1}^{3} m c_m = 1$。修正无量纲波数为 $\\tilde{\\kappa}(\\kappa) = 2 \\sum_{m=1}^{3} c_m \\sin(m \\kappa)$。\n\n首先，我们展开被积函数，将 $\\mathcal{E}$ 表示为系数 $\\mathbf{c}$ 的二次函数：\n$$\n\\mathcal{E}(\\mathbf{c};K) = \\int_{0}^{K} \\left[ \\left(2 \\sum_{m=1}^{3} c_m \\sin(m \\kappa)\\right)^2 - 4\\kappa \\sum_{m=1}^{3} c_m \\sin(m \\kappa) + \\kappa^2 \\right] \\, \\mathrm{d}\\kappa.\n$$\n展开求和项并交换求和与积分的顺序，得到二次型：\n$$\n\\mathcal{E}(\\mathbf{c};K) = \\sum_{m=1}^{3} \\sum_{n=1}^{3} c_m c_n \\left( 4 \\int_{0}^{K} \\sin(m\\kappa)\\sin(n\\kappa) \\, \\mathrm{d}\\kappa \\right) - \\sum_{m=1}^{3} c_m \\left( 4 \\int_{0}^{K} \\kappa \\sin(m\\kappa) \\, \\mathrm{d}\\kappa \\right) + \\int_{0}^{K} \\kappa^2 \\, \\mathrm{d}\\kappa.\n$$\n这可以写成矩阵-向量表示法 $\\mathcal{E}(\\mathbf{c}) = \\mathbf{c}^T \\mathbf{A} \\mathbf{c} - \\mathbf{b}^T \\mathbf{c} + d$，其中常数项 $d$ 不影响优化。对称矩阵 $\\mathbf{A}(K)$ 和向量 $\\mathbf{b}(K)$ 的分量由积分定义。\n\n$3 \\times 3$ 矩阵 $\\mathbf{A}$ 的元素 $A_{mn}$ 由 $A_{mn} = 4 \\int_{0}^{K} \\sin(m\\kappa)\\sin(n\\kappa) \\, \\mathrm{d}\\kappa$ 给出。使用三角恒等式 $\\sin(\\alpha)\\sin(\\beta) = \\frac{1}{2}[\\cos(\\alpha-\\beta) - \\cos(\\alpha+\\beta)]$，我们得到解析积分：\n当 $m=n$ 时：\n$$\nA_{mm} = 4 \\int_{0}^{K} \\sin^2(m\\kappa) \\, \\mathrm{d}\\kappa = 2 \\int_{0}^{K} (1 - \\cos(2m\\kappa)) \\, \\mathrm{d}\\kappa = 2 \\left[\\kappa - \\frac{\\sin(2m\\kappa)}{2m}\\right]_0^K = 2K - \\frac{\\sin(2mK)}{m}.\n$$\n当 $m \\neq n$ 时：\n$$\nA_{mn} = 2 \\int_{0}^{K} (\\cos((m-n)\\kappa) - \\cos((m+n)\\kappa)) \\, \\mathrm{d}\\kappa = 2 \\left[\\frac{\\sin((m-n)\\kappa)}{m-n} - \\frac{\\sin((m+n)\\kappa)}{m+n}\\right]_0^K = 2 \\left(\\frac{\\sin((m-n)K)}{m-n} - \\frac{\\sin((m+n)K)}{m+n}\\right).\n$$\n\n向量 $\\mathbf{b}$ 的元素 $b_m$ 由 $b_m = 4 \\int_{0}^{K} \\kappa\\sin(m\\kappa) \\, \\mathrm{d}\\kappa$ 给出。使用分部积分法，我们得到：\n$$\nb_m = 4 \\left[\\frac{\\sin(m\\kappa)}{m^2} - \\frac{\\kappa\\cos(m\\kappa)}{m}\\right]_0^K = 4\\left(\\frac{\\sin(mK)}{m^2} - \\frac{K\\cos(mK)}{m}\\right).\n$$\n\n该优化问题是一个带约束的二次最小化问题：\n最小化 $f(\\mathbf{c}) = \\mathbf{c}^T \\mathbf{A} \\mathbf{c} - \\mathbf{b}^T \\mathbf{c}$，约束条件为 $\\mathbf{g}^T \\mathbf{c} = 1$，其中约束向量为 $\\mathbf{g} = [2, 4, 6]^T$。\n我们使用拉格朗日乘子法来求解。拉格朗日函数为 $\\mathcal{L}(\\mathbf{c}, \\mu) = \\mathbf{c}^T \\mathbf{A} \\mathbf{c} - \\mathbf{b}^T \\mathbf{c} + \\mu (\\mathbf{g}^T \\mathbf{c} - 1)$。通过将梯度设为零，可以得到 Karush-Kuhn-Tucker (KKT) 条件：\n$$\n\\nabla_{\\mathbf{c}} \\mathcal{L} = 2\\mathbf{A}\\mathbf{c} - \\mathbf{b} + \\mu \\mathbf{g} = \\mathbf{0}\n$$\n$$\n\\nabla_{\\mu} \\mathcal{L} = \\mathbf{g}^T\\mathbf{c} - 1 = 0\n$$\n重新整理并令 $\\lambda = -\\mu/2$，我们得到关于未知数 $\\mathbf{c}$ 和 $\\lambda$ 的线性方程组：\n$$\n\\mathbf{A}\\mathbf{c} - \\lambda \\mathbf{g} = \\frac{1}{2}\\mathbf{b}\n$$\n$$\n\\mathbf{g}^T\\mathbf{c} = 1\n$$\n这可以表示为单个 $(M+1) \\times (M+1)$ 的分块矩阵系统：\n$$\n\\begin{pmatrix}\n\\mathbf{A}  -\\mathbf{g} \\\\\n\\mathbf{g}^T  0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{2}\\mathbf{b} \\\\\n1\n\\end{pmatrix}\n$$\n对增广向量 $[\\mathbf{c}, \\lambda]^T$ 数值求解这个 $4 \\times 4$ 线性系统，以求得给定无量纲截止波数 $K$ 下的最优系数 $\\mathbf{c}(K)$。\n\n系数对 $K$ 变化的敏感性 $S(K)$ 定义为：\n$$\nS(K) = \\frac{\\left\\|\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K}\\right\\|_2}{\\left\\|\\mathbf{c}\\right\\|_2} \\, K.\n$$\n导数 $\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K}$ 使用二阶中心有限差分格式进行近似：\n$$\n\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K} \\approx \\frac{\\mathbf{c}(K+\\delta K) - \\mathbf{c}(K-\\delta K)}{2 \\, \\delta K},\n$$\n步长设定为 $\\delta K = \\max(10^{-6}, 10^{-3} K)$。这需要在三个点上计算最优系数 $\\mathbf{c}$：$K$、$K+\\delta K$ 和 $K-\\delta K$。\n\n给定 $K$ 处模板的鲁棒性由一个简单的阈值规则确定：当且仅当其敏感性 $S(K)$ 小于或等于阈值 $T=0.5$ 时，该模板是鲁棒的。\n\n针对每个测试案例 $(k_c, \\Delta x)$ 的总体算法设计如下：\n1.  计算无量纲截止波数 $K = k_c \\Delta x$。\n2.  确定扰动步长 $\\delta K = \\max(10^{-6}, 10^{-3} K)$。\n3.  实现一个函数，对于任意给定的 $K$，该函数使用 $\\mathbf{A}(K)$ 和 $\\mathbf{b}(K)$ 的解析公式构建 KKT 矩阵和右侧向量，并求解该系统以返回最优系数向量 $\\mathbf{c}(K)$。\n4.  调用此函数三次，以获得 $\\mathbf{c}(K)$、$\\mathbf{c}(K+\\delta K)$ 和 $\\mathbf{c}(K-\\delta K)$。\n5.  使用有限差分公式计算数值导数 $\\frac{\\mathrm{d}\\mathbf{c}}{\\mathrm{d}K}$。\n6.  计算导数向量和中心系数向量 $\\mathbf{c}(K)$ 的 L2-范数。\n7.  使用其定义计算敏感性 $S(K)$。\n8.  将 $S(K)$ 与阈值 $T=0.5$ 进行比较，以确定布尔鲁棒性标志。\n9.  将得到的敏感性和鲁棒性标志格式化为所需的输出格式。",
            "answer": "[[0.000003,True],[0.001944,True],[0.892011,False],[1.706214,False]]"
        }
    ]
}