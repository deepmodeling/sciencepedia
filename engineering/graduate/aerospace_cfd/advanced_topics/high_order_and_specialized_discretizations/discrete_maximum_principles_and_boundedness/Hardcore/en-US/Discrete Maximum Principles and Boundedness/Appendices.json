{
    "hands_on_practices": [
        {
            "introduction": "We begin with the canonical problem for understanding numerical stability and boundedness: the one-dimensional diffusion equation. This exercise will guide you through the process of deriving the famous time-step constraint for an explicit time-integration scheme. By analyzing the coefficients of the fully discrete update formula, you will determine the precise condition required to guarantee that the numerical solution respects both non-negativity and the discrete maximum principle, a fundamental skill for developing and analyzing numerical methods .",
            "id": "3955314",
            "problem": "In Computational Fluid Dynamics (CFD) for aerospace applications, the diffusion of a passive scalar transported by molecular diffusion alone is governed by a parabolic Partial Differential Equation (PDE). Consider the one-dimensional diffusion equation\n$$\nu_{t}=\\nu\\,u_{xx}\n$$\non the spatial interval $[0,L]$ with homogeneous Dirichlet boundary conditions\n$$\nu(0,t)=0,\\quad u(L,t)=0,\n$$\nand nonnegative initial data\n$$\nu(x,0)\\ge 0 \\quad \\text{for all } x\\in[0,L].\n$$\nLet the spatial domain be discretized on a uniform grid $x_{i}=i\\,h$ with $i\\in\\{0,1,\\dots,N\\}$ and $h=L/N$, and denote the grid function at time level $t^{n}=n\\,\\Delta t$ by $u_{i}^{n}\\approx u(x_{i},t^{n})$. Use a second-order central difference approximation for $u_{xx}$ in space and the explicit forward Euler method in time to produce a fully discrete scheme for the interior nodes $i\\in\\{1,2,\\dots,N-1\\}$, while enforcing the boundary conditions as $u_{0}^{n}=0$ and $u_{N}^{n}=0$ for all $n$.\n\nBy requiring that the fully discrete solution preserves both:\n- a discrete maximum principle in the $\\ell^{\\infty}$ norm (that is, the discrete $\\ell^{\\infty}$ norm does not increase in time), and\n- nonnegativity for all subsequent time levels $n\\ge 1$ whenever the initial data are nonnegative,\n\nderive the sharp upper bound on the time step $\\Delta t$ in terms of the kinematic diffusivity $\\nu$ and the grid spacing $h$ that ensures both properties. Show that your condition is both necessary and sufficient under the stated discretization and boundary enforcement.\n\nExpress your final result as a single closed-form analytic expression in terms of $\\nu$ and $h$ only. Do not include units in your final expression. Interpret $\\nu$ in square meters per second and $h$ in meters so that $\\Delta t$ is in seconds.",
            "solution": "The problem requires the derivation of the sharp upper bound on the time step $\\Delta t$ for a numerical scheme applied to the one-dimensional diffusion equation, such that the scheme preserves nonnegativity and a discrete maximum principle.\n\nThe governing partial differential equation (PDE) is the one-dimensional diffusion equation:\n$$\nu_{t}=\\nu\\,u_{xx}\n$$\non the domain $x \\in [0, L]$, with homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(L,t)=0$, and a nonnegative initial condition $u(x,0) \\ge 0$.\n\nFirst, we formulate the fully discrete numerical scheme. The spatial domain $[0,L]$ is discretized with a uniform grid $x_i = i h$ for $i \\in \\{0, 1, \\dots, N\\}$, where $h=L/N$. The time domain is discretized by time levels $t^n = n \\Delta t$. The numerical solution at grid point $(x_i, t^n)$ is denoted by $u_i^n$.\n\nThe time derivative $u_t$ is approximated using the explicit forward Euler method:\n$$\nu_t(x_i, t^n) \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}\n$$\n\nThe second spatial derivative $u_{xx}$ is approximated using a second-order central difference scheme:\n$$\nu_{xx}(x_i, t^n) \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2}\n$$\n\nSubstituting these approximations into the PDE gives the scheme for the interior nodes $i \\in \\{1, 2, \\dots, N-1\\}$:\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\nu \\left( \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} \\right)\n$$\n\nSolving for the solution at the next time step, $u_i^{n+1}$:\n$$\nu_i^{n+1} = u_i^n + \\frac{\\nu \\Delta t}{h^2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\n\nLet's define the dimensionless parameter $s = \\frac{\\nu \\Delta t}{h^2}$, which is often called the mesh Fourier number or numerical diffusion number. The update equation can be rewritten by collecting terms at time level $n$:\n$$\nu_i^{n+1} = u_i^n + s u_{i+1}^n - 2s u_i^n + s u_{i-1}^n\n$$\n$$\nu_i^{n+1} = s u_{i-1}^n + (1 - 2s) u_i^n + s u_{i+1}^n\n$$\nThis is the update rule for the interior nodes. The boundary conditions are enforced as $u_0^n = 0$ and $u_N^n = 0$ for all time levels $n \\ge 0$.\n\nNow, we analyze the two required properties to find the condition on $s$, and thus on $\\Delta t$.\n\n**1. Nonnegativity Preservation**\n\nWe require that if $u_i^n \\ge 0$ for all $i \\in \\{0, 1, \\dots, N\\}$, then $u_i^{n+1} \\ge 0$ for all $i$. By induction, this will ensure nonnegativity for all time, given $u_i^0 \\ge 0$.\n\nThe update rule expresses $u_i^{n+1}$ as a linear combination of values at time level $n$: $u_{i-1}^n$, $u_i^n$, and $u_{i+1}^n$. If we assume $u_j^n \\ge 0$ for all $j$, then a sufficient condition to ensure $u_i^{n+1} \\ge 0$ is that all coefficients in the linear combination are non-negative.\nThe coefficients are $s$, $(1-2s)$, and $s$.\nSince $\\nu  0$, $\\Delta t  0$, and $h  0$, the parameter $s = \\frac{\\nu \\Delta t}{h^2}$ is always positive.\nThe only remaining condition is for the coefficient of $u_i^n$:\n$$\n1 - 2s \\ge 0 \\implies 2s \\le 1 \\implies s \\le \\frac{1}{2}\n$$\nAt the boundaries, $u_0^{n+1}=0$ and $u_N^{n+1}=0$, which are non-negative.\nTherefore, the condition $s \\le \\frac{1}{2}$ is **sufficient** for nonnegativity preservation.\n\nTo show this condition is also **necessary**, we must show that if $s  \\frac{1}{2}$, there exists a non-negative initial condition $u_i^0 \\ge 0$ for which the scheme produces a negative value at the next time step. Consider an initial condition with a single non-zero value at an interior node $k \\in \\{1, \\dots, N-1\\}$, such as $u_k^0 = 1$ and $u_i^0 = 0$ for all $i \\ne k$. This initial condition is non-negative. Applying the scheme for one time step, we find the value at node $k$:\n$$\nu_k^1 = s u_{k-1}^0 + (1-2s) u_k^0 + s u_{k+1}^0 = s(0) + (1-2s)(1) + s(0) = 1 - 2s\n$$\nIf $s  \\frac{1}{2}$, then $2s1$, and $1-2s  0$. Thus, $u_k^1  0$, which violates the nonnegativity requirement. Therefore, the condition $s \\le \\frac{1}{2}$ is both necessary and sufficient for nonnegativity preservation.\n\n**2. Discrete Maximum Principle**\n\nThe discrete maximum principle (in the $\\ell^{\\infty}$ norm) states that the maximum absolute value of the solution does not grow in time: $\\|u^{n+1}\\|_{\\infty} \\le \\|u^n\\|_{\\infty}$, where $\\|u^n\\|_{\\infty} = \\max_{i} |u_i^n|$. Let $M^n = \\|u^n\\|_{\\infty}$.\n\nLet's analyze the update rule under the condition $s \\le \\frac{1}{2}$.\n$$\n|u_i^{n+1}| = |s u_{i-1}^n + (1 - 2s) u_i^n + s u_{i+1}^n|\n$$\nUsing the triangle inequality:\n$$\n|u_i^{n+1}| \\le |s u_{i-1}^n| + |(1 - 2s) u_i^n| + |s u_{i+1}^n| = |s||u_{i-1}^n| + |1 - 2s||u_i^n| + |s||u_{i+1}^n|\n$$\nSince we established that $0  s \\le \\frac{1}{2}$, the coefficients $s$ and $(1-2s)$ are non-negative. So, $|s| = s$ and $|1-2s| = 1-2s$.\n$$\n|u_i^{n+1}| \\le s|u_{i-1}^n| + (1 - 2s)|u_i^n| + s|u_{i+1}^n|\n$$\nBy definition of the maximum norm, $|u_j^n| \\le M^n$ for all $j$. Substituting this into the inequality:\n$$\n|u_i^{n+1}| \\le s M^n + (1 - 2s) M^n + s M^n = (s + 1 - 2s + s) M^n = M^n\n$$\nThis result, $|u_i^{n+1}| \\le M^n$, holds for all interior nodes $i$. For the boundary nodes, $|u_0^{n+1}|=0 \\le M^n$ and $|u_N^{n+1}|=0 \\le M^n$ (assuming a non-trivial initial condition where $M^n  0$).\nSince $|u_i^{n+1}| \\le M^n$ for all $i \\in \\{0, 1, \\dots, N\\}$, we can conclude that $\\max_i |u_i^{n+1}| \\le M^n$. This is precisely $\\|u^{n+1}\\|_{\\infty} \\le \\|u^n\\|_{\\infty}$. Thus, the condition $s \\le \\frac{1}{2}$ is **sufficient** for the discrete maximum principle to hold.\n\nTo show that the condition is also **necessary** for the discrete maximum principle, we again construct a counterexample for the case $s  \\frac{1}{2}$. The principle must hold for any initial data. Consider an oscillatory initial condition, such as $u_i^0 = (-1)^i$ for $i \\in \\{1, \\dots, N-1\\}$, with $u_0^0=0, u_N^0=0$. The maximum norm of this initial data is $\\|u^0\\|_{\\infty}=1$. Let's examine an interior node $k$ where $u_k^0 = 1$. Its neighbors will be $u_{k-1}^0 = -1$ and $u_{k+1}^0 = -1$.\nThe value at this node at the next time step is:\n$$\nu_k^1 = s u_{k-1}^0 + (1-2s) u_k^0 + s u_{k+1}^0 = s(-1) + (1-2s)(1) + s(-1) = -s + 1 - 2s - s = 1 - 4s\n$$\nIf $s  \\frac{1}{2}$, then $4s  2$, which implies $1-4s  -1$.\nThe absolute value is $|u_k^1| = |1-4s| = 4s - 1$. Since $s  \\frac{1}{2}$, we have $4s-1  4(\\frac{1}{2})-1 = 1$.\nSo, $|u_k^1|  1 = \\|u^0\\|_{\\infty}$. This means $\\|u^1\\|_{\\infty}  \\|u^0\\|_{\\infty}$, which violates the discrete maximum principle. Therefore, the condition $s \\le \\frac{1}{2}$ is also **necessary**.\n\n**Conclusion**\n\nBoth nonnegativity preservation and the discrete maximum principle require the condition $s \\le \\frac{1}{2}$, and this condition is both necessary and sufficient for each property. The problem asks for the sharp upper bound on $\\Delta t$ that ensures both. This bound is found by setting $s$ to its maximum allowed value:\n$$\ns = \\frac{\\nu \\Delta t}{h^2} = \\frac{1}{2}\n$$\nSolving for $\\Delta t$:\n$$\n\\Delta t = \\frac{h^2}{2\\nu}\n$$\nThe condition that guarantees both properties is $\\Delta t \\le \\frac{h^2}{2\\nu}$. The sharp upper bound is the equality case.",
            "answer": "$$\n\\boxed{\\frac{h^2}{2\\nu}}\n$$"
        },
        {
            "introduction": "The principles of the Discrete Maximum Principle (DMP) must hold throughout the entire computational domain, which includes the critical and often challenging boundary nodes. This practice demonstrates how a naively implemented Neumann boundary condition can violate the algebraic structure (the M-matrix property) required for the DMP, potentially leading to unphysical solutions. You will then derive a corrected, conservative boundary stencil that restores this crucial property, providing insight into the importance of physically consistent discretizations at boundaries .",
            "id": "3955278",
            "problem": "Consider the steady one-dimensional diffusion of a passive scalar in a planar slab, a canonical model for wall-bounded transport in Aerospace Computational Fluid Dynamics (CFD). Let the scalar field be $u(x)$ on the interval $x \\in [0,L]$, with constant diffusivity $k0$. The governing equation is the steady diffusion equation $-\\frac{d}{dx}\\left(k \\frac{du}{dx}\\right)=0$. Impose a Neumann boundary condition at the left boundary specifying an outward diffusive flux $q$ through $x=0$, i.e., $k\\,u_{x}(0)=q$, and a Dirichlet boundary condition at the right boundary, $u(L)=0$. Discretize the interval using a uniform grid with $N+1$ nodes, $x_i = i h$ for $i=0,1,\\dots,N$, where $h=L/N$. On interior nodes $i=1,2,\\dots,N-1$, discretize the diffusion operator using the standard second-order centered difference on this node-based grid. \n\nYou will analyze how the Neumann boundary closure affects the sign structure of the system matrix and the satisfaction of a Discrete Maximum Principle (DMP). Recall that a sufficient algebraic condition for a linear system $A \\mathbf{u}=\\mathbf{b}$ to satisfy a DMP for scalar diffusion is that $A$ be an $M$-matrix with nonpositive off-diagonal entries and positive diagonal entries, which for the present scalar diffusion discretization reduces to requiring that, row by row, the off-diagonal coefficients are $\\le 0$ and the diagonal coefficient is $0$.\n\n(a) Construct the algebraic row associated with the left boundary $x=0$ by enforcing the Neumann boundary condition with the improper one-sided difference $u_{x}(0)\\approx \\frac{u_1-u_0}{h}$. Write this boundary row in the form $a_{00} u_0 + a_{01} u_1 = b_0$ using the same dimensional scaling as the interior equations by dividing the boundary equation by $h$ to obtain coefficients with units consistent with $k/h^2$. Identify the signs of $a_{00}$ and $a_{01}$ and briefly explain why this row can violate the $M$-matrix off-diagonal sign requirement and thus break the DMP.\n\n(b) Derive a corrected, conservative boundary stencil for the left boundary by enforcing a flux balance on a half-cell adjacent to $x=0$: the left-face diffusive flux equals the prescribed $q$, and the right-face diffusive flux between nodes $0$ and $1$ is approximated by the centered difference. Write the resulting algebraic boundary row in the form $a_{00}^{(c)} u_0 + a_{01}^{(c)} u_1 = b_0^{(c)}$, and identify the signs of $a_{00}^{(c)}$ and $a_{01}^{(c)}$, showing that this row restores the off-diagonal nonpositivity required by the $M$-matrix structure.\n\n(c) Consider a blended family of boundary rows obtained as a convex combination of the improperly scaled row from part (a), after division by $h$, and the conservative row from part (b). Define the blended row as\n$$\n\\theta\\left[\\frac{k}{h^2}(u_1-u_0)=\\frac{q}{h}\\right] + (1-\\theta)\\left[\\frac{k}{h^2}(u_0 - u_1)=\\frac{q}{h}\\right],\n$$\nwith blending weight $\\theta \\in [0,1]$. Reduce this to the form $a_{00}(\\theta) u_0 + a_{01}(\\theta) u_1 = b_0(\\theta)$, and determine the largest value $\\theta^\\star$ such that the blended boundary row preserves the $M$-matrix off-diagonal sign condition at the left boundary, i.e., $a_{01}(\\theta)\\le 0$. Provide your final answer for $\\theta^\\star$ as a single exact number with no units. No rounding is required.",
            "solution": "The problem asks for a three-part analysis of a boundary condition discretization for the steady one-dimensional diffusion equation. The central theme is the satisfaction of the algebraic conditions for a Discrete Maximum Principle (DMP), which relies on the system matrix being an $M$-matrix. A sufficient condition for this is to have positive diagonal entries ($a_{ii}0$) and non-positive off-diagonal entries ($a_{ij}\\le 0$ for $i \\ne j$).\n\n(a) We are asked to discretize the Neumann boundary condition $k\\,u_{x}(0)=q$ using the first-order, one-sided forward difference approximation $u_{x}(0)\\approx \\frac{u_1-u_0}{h}$, where $u_i = u(x_i)$. Substituting this into the boundary condition gives:\n$$\nk \\left(\\frac{u_1 - u_0}{h}\\right) = q\n$$\nThe problem specifies that this equation should be written with a dimensional scaling consistent with the interior equations. The standard interior discretization of $-\\frac{d}{dx}(k\\frac{du}{dx})=0$ at node $i$ is $\\frac{k}{h^2}(-u_{i-1} + 2u_i - u_{i+1})=0$, where the coefficients have units of $k/h^2$. To achieve this scaling, we divide the boundary equation by $h$:\n$$\n\\frac{k}{h^2} (u_1 - u_0) = \\frac{q}{h}\n$$\nArranging this into the form $a_{00} u_0 + a_{01} u_1 = b_0$, we get:\n$$\n-\\frac{k}{h^2} u_0 + \\frac{k}{h^2} u_1 = \\frac{q}{h}\n$$\nFrom this, we identify the coefficients for the first row ($i=0$) of the system matrix:\n- $a_{00} = -\\frac{k}{h^2}$\n- $a_{01} = \\frac{k}{h^2}$\n- $b_0 = \\frac{q}{h}$\n\nSince the diffusivity $k>0$ and the grid spacing $h>0$, we have $k/h^2 > 0$. Therefore, the sign of the off-diagonal coefficient is $a_{01} > 0$. This violates the $M$-matrix requirement that off-diagonal entries must be non-positive ($a_{ij} \\le 0$ for $i \\neq j$). This positive off-diagonal entry can prevent the system matrix from being an $M$-matrix, thereby potentially breaking the DMP. Additionally, the diagonal entry $a_{00} = -k/h^2  0$ also violates the condition that diagonal entries must be positive.\n\n(b) Next, we derive a conservative stencil using a flux balance on the control volume (CV) adjacent to the boundary, which is a half-cell of length $h/2$, i.e., the interval $[0, h/2]$. The governing equation, when integrated over this CV, yields a balance of fluxes at its faces for a steady-state problem with no source:\n$$\n\\int_0^{h/2} -\\frac{d}{dx}\\left(k \\frac{du}{dx}\\right) dx = 0 \\implies \\left[-k \\frac{du}{dx}\\right]_0^{h/2} = 0\n$$\nThis is equivalent to stating that the flux entering the CV equals the flux exiting it. The problem states that the left-face diffusive flux equals the prescribed $q$. This is interpreted as the flux *into* the CV at $x=0$, which is $q$. The flux *out of* the CV at the right face ($x=h/2$) is approximated using a centered difference between nodes $0$ and $1$:\n$$\n\\text{Flux out} = -k u_x\\left(\\frac{h}{2}\\right) \\approx -k \\frac{u_1 - u_0}{h} = k \\frac{u_0 - u_1}{h}\n$$\nThe flux balance is then: Flux in = Flux out.\n$$\nq = k \\frac{u_0-u_1}{h}\n$$\nTo match the scaling of the interior equations, we divide by $h$:\n$$\n\\frac{k}{h^2}(u_0 - u_1) = \\frac{q}{h}\n$$\nWriting this in the form $a_{00}^{(c)} u_0 + a_{01}^{(c)} u_1 = b_0^{(c)}$ gives:\n$$\n\\frac{k}{h^2} u_0 - \\frac{k}{h^2} u_1 = \\frac{q}{h}\n$$\nThe coefficients are:\n- $a_{00}^{(c)} = \\frac{k}{h^2}$\n- $a_{01}^{(c)} = -\\frac{k}{h^2}$\n- $b_0^{(c)} = \\frac{q}{h}$\n\nSince $k/h^2 > 0$, the diagonal coefficient $a_{00}^{(c)}$ is positive, and the off-diagonal coefficient $a_{01}^{(c)}$ is negative. Both of these signs are consistent with the requirements for an $M$-matrix ($a_{ii}>0$ and $a_{ij}\\le 0$ for $i \\ne j$). This conservative formulation restores the desired sign structure for the boundary row.\n\n(c) We are given a blended boundary row formed by a convex combination of the scaled improper row from (a) and the conservative row from (b):\n$$\n\\theta\\left[\\frac{k}{h^2}(u_1-u_0)=\\frac{q}{h}\\right] + (1-\\theta)\\left[\\frac{k}{h^2}(u_0 - u_1)=\\frac{q}{h}\\right]\n$$\nwith $\\theta \\in [0,1]$. We need to find the largest $\\theta^\\star$ such that the off-diagonal coefficient $a_{01}(\\theta)$ is non-positive. First, we expand and group the terms by $u_0$ and $u_1$:\n$$\n\\theta\\left(-\\frac{k}{h^2}u_0 + \\frac{k}{h^2}u_1\\right) + (1-\\theta)\\left(\\frac{k}{h^2}u_0 - \\frac{k}{h^2}u_1\\right) = \\theta\\frac{q}{h} + (1-\\theta)\\frac{q}{h}\n$$\nThe right-hand side simplifies to $b_0(\\theta) = (\\theta + 1 - \\theta)\\frac{q}{h} = \\frac{q}{h}$.\nThe coefficient of $u_0$ is:\n$$\na_{00}(\\theta) = \\theta\\left(-\\frac{k}{h^2}\\right) + (1-\\theta)\\left(\\frac{k}{h^2}\\right) = \\frac{k}{h^2}(-\\theta + 1 - \\theta) = \\frac{k}{h^2}(1-2\\theta)\n$$\nThe coefficient of $u_1$ is:\n$$\na_{01}(\\theta) = \\theta\\left(\\frac{k}{h^2}\\right) + (1-\\theta)\\left(-\\frac{k}{h^2}\\right) = \\frac{k}{h^2}(\\theta - (1-\\theta)) = \\frac{k}{h^2}(\\theta - 1 + \\theta) = \\frac{k}{h^2}(2\\theta-1)\n$$\nThe problem requires that the off-diagonal sign condition for the $M$-matrix property is preserved. This means we must have $a_{01}(\\theta) \\le 0$:\n$$\n\\frac{k}{h^2}(2\\theta-1) \\le 0\n$$\nSince $k/h^2 > 0$, we can divide by this term without changing the direction of the inequality:\n$$\n2\\theta - 1 \\le 0\n$$\n$$\n2\\theta \\le 1\n$$\n$$\n\\theta \\le \\frac{1}{2}\n$$\nThe blending factor $\\theta$ is restricted to the interval $[0,1]$. The condition $\\theta \\le \\frac{1}{2}$ is thus the constraining factor. The largest value of $\\theta$ that satisfies this condition is $\\theta^\\star = \\frac{1}{2}$.",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "This final practice serves as a crucial cautionary tale, highlighting the distinct roles of temporal stability and spatial boundedness. It is a common misconception that unconditionally stable time-stepping schemes, such as the backward Euler method, automatically prevent unphysical oscillations. By combining an A-stable time integrator with a non-monotone spatial discretization for an advection-dominated problem, you will compute a concrete counterexample where the solution violates the maximum principle. This exercise underscores a vital lesson: preserving physical bounds is a property of the complete space-time discretization, and the structure of the spatial operator is paramount .",
            "id": "3955271",
            "problem": "Consider one-dimensional transient advectionâ€“diffusion of a bounded scalar in aerospace Computational Fluid Dynamics (CFD), modeled on the spatial interval $x \\in [0,3]$ with Dirichlet boundary conditions $u(0,t)=0$ and $u(3,t)=1$. The governing equation is\n$$\n\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = D \\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\nwhere $U$ is the uniform advection speed and $D$ is the molecular diffusivity. Discretize the spatial domain on a uniform grid with nodes at $x=0,1,2,3$ so that the interior unknowns are $u_{1}(t)=u(1,t)$ and $u_{2}(t)=u(2,t)$, with grid spacing $\\Delta x = 1$. Use second-order centered finite differences for both the first and second spatial derivatives. Denote the semi-discrete system in the form $\\dot{\\boldsymbol{u}} = \\boldsymbol{A}\\boldsymbol{u} + \\boldsymbol{f}$ after enforcing the Dirichlet boundary conditions at $x=0$ and $x=3$.\n\nAdvance this system in time using the backward Euler method, which is known to be absolutely stable (A-stable), with time step $\\Delta t = 4$. Take $U=-1$ and $D=0.1$ (both in consistent SI units), and an initial interior state $u_{1}^{n}=u_{2}^{n}=\\frac{1}{2}$. Using only these inputs and the stated discretizations, carry out one backward Euler step to compute $\\boldsymbol{u}^{n+1}$ from the linear system\n$$\n\\left(\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A}\\right)\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f}.\n$$\nThen, evaluate the violation of the Discrete Maximum Principle (DMP) by computing the maximum overshoot above the upper boundary value $1$,\n$$\n\\max\\left\\{\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) - 1,\\;0\\right\\}.\n$$\nExpress your final answer as a single exact value (no units). No rounding is required. This construction should serve as a counterexample demonstrating that an A-stable method can fail to preserve a DMP when paired with a non-monotone spatial discretization lacking a Monotone-matrix (M-matrix) structure.",
            "solution": "The user wants me to solve the given problem.\n\n### Step 1: Extract Givens\n- **Governing Equation:** $\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = D \\frac{\\partial^{2} u}{\\partial x^{2}}$\n- **Domain:** $x \\in [0,3]$\n- **Boundary Conditions:** $u(0,t)=0$, $u(3,t)=1$\n- **Grid Nodes:** $x=0,1,2,3$\n- **Grid Spacing:** $\\Delta x = 1$\n- **Interior Unknowns:** $u_{1}(t)=u(1,t)$, $u_{2}(t)=u(2,t)$\n- **Spatial Discretization:** Second-order centered finite differences for both first and second derivatives.\n- **Semi-discrete form:** $\\dot{\\boldsymbol{u}} = \\boldsymbol{A}\\boldsymbol{u} + \\boldsymbol{f}$\n- **Time-stepping method:** Backward Euler\n- **Time step:** $\\Delta t = 4$\n- **Constants:** $U=-1$, $D=0.1$\n- **Initial Condition:** $\\boldsymbol{u}^{n} = \\begin{pmatrix} u_{1}^{n} \\\\ u_{2}^{n} \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix}$\n- **Linear system for time step:** $\\left(\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A}\\right)\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f}$\n- **Task:** Compute $\\boldsymbol{u}^{n+1}$ and evaluate the DMP violation $\\max\\left\\{\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) - 1,\\;0\\right\\}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes a standard one-dimensional advection-diffusion equation, a fundamental model in fluid dynamics and heat transfer. The numerical methods (centered differences, backward Euler) are standard techniques in CFD. The parameters are physically plausible. The problem is scientifically sound.\n- **Well-Posed:** All necessary parameters, boundary conditions, initial conditions, and numerical methods are specified. The task is to perform a single, well-defined computational step. The resulting linear system is non-singular, leading to a unique solution. The problem is well-posed.\n- **Objective:** The problem statement is composed of objective mathematical definitions and instructions. It asks for a specific numerical calculation. No subjective interpretation is required.\n- **Other criteria:** The problem is complete, consistent, and directly relevant to the specified topic of discrete maximum principles in CFD. It is a standard, non-trivial exercise designed to illustrate a key concept in numerical analysis.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\nThe governing equation is rearranged to isolate the time derivative term:\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^{2} u}{\\partial x^{2}} - U \\frac{\\partial u}{\\partial x}\n$$\nThe spatial domain is discretized with a uniform grid spacing $\\Delta x = 1$. The grid nodes are $x_0=0, x_1=1, x_2=2, x_3=3$. The interior unknowns are $u_1(t) = u(x_1, t)$ and $u_2(t) = u(x_2, t)$. The boundary conditions are $u_0 = u(0,t) = 0$ and $u_3 = u(3,t) = 1$.\n\nWe use second-order centered finite differences to discretize the spatial derivatives at the interior nodes $i=1,2$:\n$$\n\\left. \\frac{\\partial u}{\\partial x} \\right|_{x_i} \\approx \\frac{u_{i+1} - u_{i-1}}{2\\Delta x}\n$$\n$$\n\\left. \\frac{\\partial^2 u}{\\partial x^2} \\right|_{x_i} \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta x)^2}\n$$\nSubstituting these into the governing equation for each interior node, with $\\Delta x=1$:\n\nFor node $i=1$:\n$$\n\\frac{du_1}{dt} = D \\frac{u_2 - 2u_1 + u_0}{(1)^2} - U \\frac{u_2 - u_0}{2(1)}\n$$\nWith $u_0=0$:\n$$\n\\frac{du_1}{dt} = D(u_2 - 2u_1) - U \\frac{u_2}{2} = (-2D)u_1 + \\left(D - \\frac{U}{2}\\right)u_2\n$$\n\nFor node $i=2$:\n$$\n\\frac{du_2}{dt} = D \\frac{u_3 - 2u_2 + u_1}{(1)^2} - U \\frac{u_3 - u_1}{2(1)}\n$$\nWith $u_3=1$:\n$$\n\\frac{du_2}{dt} = D(1 - 2u_2 + u_1) - U \\frac{1 - u_1}{2} = (D + \\frac{U}{2})u_1 - 2Du_2 + \\left(D - \\frac{U}{2}\\right)\n$$\n\nThe semi-discrete system $\\dot{\\boldsymbol{u}} = \\boldsymbol{A}\\boldsymbol{u} + \\boldsymbol{f}$ for $\\boldsymbol{u} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ is:\n$$\n\\begin{pmatrix} \\dot{u}_1 \\\\ \\dot{u}_2 \\end{pmatrix} = \\begin{pmatrix} -2D  D - \\frac{U}{2} \\\\ D + \\frac{U}{2}  -2D \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ D - \\frac{U}{2} \\end{pmatrix}\n$$\nWe substitute the given values $U=-1$ and $D=0.1$:\n$$\n-2D = -2(0.1) = -0.2 = -\\frac{1}{5}\n$$\n$$\nD - \\frac{U}{2} = 0.1 - \\frac{-1}{2} = 0.1 + 0.5 = 0.6 = \\frac{3}{5}\n$$\n$$\nD + \\frac{U}{2} = 0.1 + \\frac{-1}{2} = 0.1 - 0.5 = -0.4 = -\\frac{2}{5}\n$$\nThe system matrices are:\n$$\n\\boldsymbol{A} = \\begin{pmatrix} -1/5  3/5 \\\\ -2/5  -1/5 \\end{pmatrix}, \\quad \\boldsymbol{f} = \\begin{pmatrix} 0 \\\\ 3/5 \\end{pmatrix}\n$$\nThe problem specifies the backward Euler method with time step $\\Delta t = 4$. The system to solve for $\\boldsymbol{u}^{n+1}$ is:\n$$\n\\left(\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A}\\right)\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f}\n$$\nFirst, we compute the matrix on the left-hand side (LHS):\n$$\n\\Delta t\\,\\boldsymbol{A} = 4 \\begin{pmatrix} -1/5  3/5 \\\\ -2/5  -1/5 \\end{pmatrix} = \\begin{pmatrix} -4/5  12/5 \\\\ -8/5  -4/5 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} -4/5  12/5 \\\\ -8/5  -4/5 \\end{pmatrix} = \\begin{pmatrix} 9/5  -12/5 \\\\ 8/5  9/5 \\end{pmatrix}\n$$\nNext, we compute the vector on the right-hand side (RHS). The initial state is $\\boldsymbol{u}^n = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix}$.\n$$\n\\Delta t\\,\\boldsymbol{f} = 4 \\begin{pmatrix} 0 \\\\ 3/5 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 12/5 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 12/5 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 5/10 + 24/10 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 29/10 \\end{pmatrix}\n$$\nThe linear system to solve for $\\boldsymbol{u}^{n+1} = \\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\end{pmatrix}$ is:\n$$\n\\begin{pmatrix} 9/5  -12/5 \\\\ 8/5  9/5 \\end{pmatrix} \\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 29/10 \\end{pmatrix}\n$$\nWe solve this $2 \\times 2$ system. The determinant of the coefficient matrix is:\n$$\n\\det(\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A}) = \\left(\\frac{9}{5}\\right)\\left(\\frac{9}{5}\\right) - \\left(-\\frac{12}{5}\\right)\\left(\\frac{8}{5}\\right) = \\frac{81}{25} + \\frac{96}{25} = \\frac{177}{25}\n$$\nUsing Cramer's rule to find $u_1^{n+1}$ and $u_2^{n+1}$:\n$$\nu_1^{n+1} = \\frac{\\det\\begin{pmatrix} 1/2  -12/5 \\\\ 29/10  9/5 \\end{pmatrix}}{177/25} = \\frac{(1/2)(9/5) - (-12/5)(29/10)}{177/25} = \\frac{9/10 + 348/50}{177/25} = \\frac{45/50 + 348/50}{177/25} = \\frac{393/50}{177/25} = \\frac{393}{50} \\cdot \\frac{25}{177} = \\frac{393}{2 \\cdot 177}\n$$\nFactoring the numbers, $393 = 3 \\cdot 131$ and $177 = 3 \\cdot 59$.\n$$\nu_1^{n+1} = \\frac{3 \\cdot 131}{2 \\cdot 3 \\cdot 59} = \\frac{131}{118}\n$$\nSimilarly for $u_2^{n+1}$:\n$$\nu_2^{n+1} = \\frac{\\det\\begin{pmatrix} 9/5  1/2 \\\\ 8/5  29/10 \\end{pmatrix}}{177/25} = \\frac{(9/5)(29/10) - (1/2)(8/5)}{177/25} = \\frac{261/50 - 4/5}{177/25} = \\frac{261/50 - 40/50}{177/25} = \\frac{221/50}{177/25} = \\frac{221}{50} \\cdot \\frac{25}{177} = \\frac{221}{2 \\cdot 177} = \\frac{221}{354}\n$$\nThe state at time $n+1$ is $\\boldsymbol{u}^{n+1} = \\begin{pmatrix} 131/118 \\\\ 221/354 \\end{pmatrix}$.\n\nFinally, we evaluate the violation of the Discrete Maximum Principle (DMP). The initial data and boundary data are in the range $[0,1]$. The DMP would require that the solution at the next time step also remains in this range. We check for overshoot above the maximum boundary value of $1$.\nThe quantity to compute is $\\max\\left\\{\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) - 1,\\;0\\right\\}$.\nFirst, we compare $u_1^{n+1}$ and $u_2^{n+1}$:\n$$\nu_1^{n+1} = \\frac{131}{118}  \\frac{118}{118} = 1\n$$\n$$\nu_2^{n+1} = \\frac{221}{354}  1\n$$\nThe maximum of the two is $u_1^{n+1}$:\n$$\n\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) = \\frac{131}{118}\n$$\nNow we compute the overshoot:\n$$\n\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) - 1 = \\frac{131}{118} - 1 = \\frac{131 - 118}{118} = \\frac{13}{118}\n$$\nSince this value is positive, the final result is:\n$$\n\\max\\left\\{\\frac{13}{118},\\;0\\right\\} = \\frac{13}{118}\n$$\nThis demonstrates a violation of the DMP, as the numerical solution $u_1^{n+1}$ overshoots the maximum boundary value of $1$.",
            "answer": "$$\\boxed{\\frac{13}{118}}$$"
        }
    ]
}