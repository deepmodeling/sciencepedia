{
    "hands_on_practices": [
        {
            "introduction": "本练习是理解离散最大值原理的一个基本出发点。它演示了对于一个简单的显式时间格式，如何通过强制执行非负性和最大值不增长的物理约束，来直接推导出其稳定性条件。通过这个实践 ，你将建立起一个核心的直觉：数值方法的稳定性与离散格式的系数直接相关，而这些系数又必须反映问题的物理本质。",
            "id": "3955314",
            "problem": "在航空航天应用的计算流体动力学 (CFD) 中，仅由分子扩散输运的被动标量的扩散过程由一个抛物线型偏微分方程 (PDE) 控制。考虑一维扩散方程\n$$\nu_{t}=\\nu\\,u_{xx}\n$$\n该方程定义在空间区间 $$[0,L]$$ 上，并具有齐次狄利克雷边界条件\n$$\nu(0,t)=0,\\quad u(L,t)=0,\n$$\n以及非负初始数据\n$$\nu(x,0)\\ge 0 \\quad \\text{对所有 } x\\in[0,L].\n$$\n设空间域在均匀网格 $$x_{i}=i\\,h$$（其中 $$i\\in\\{0,1,\\dots,N\\}$$ 且 $$h=L/N$$）上进行离散化，并将时间层 $$t^{n}=n\\,\\Delta t$$ 上的网格函数表示为 $$u_{i}^{n}\\approx u(x_{i},t^{n})$$。对空间上的 $$u_{xx}$$ 使用二阶中心差分近似，对时间使用显式前向欧拉法，为内部节点 $$i\\in\\{1,2,\\dots,N-1\\}$$ 建立一个全离散格式，同时将边界条件强制设置为 $$u_{0}^{n}=0$$ 和 $$u_{N}^{n}=0$$ 对所有 $$n$$ 成立。\n\n通过要求全离散解同时保持以下两个性质：\n- $$\\ell^{\\infty}$$ 范数下的离散极值原理（即，离散 $$\\ell^{\\infty}$$ 范数不随时间增加），以及\n- 当初始数据非负时，在所有后续时间层 $$n\\ge 1$$ 保持非负性，\n\n推导确保这两个性质成立的时间步长 $$\\Delta t$$ 关于运动扩散系数 $$\\nu$$ 和网格间距 $$h$$ 的精确上界。证明在给定的离散化和边界条件强制执行下，您得出的条件是充分且必要的。\n\n将最终结果表示为仅包含 $$\\nu$$ 和 $$h$$ 的单个闭式解析表达式。最终表达式中不要包含单位。将 $$\\nu$$ 的单位理解为平方米/秒，$$h$$ 的单位理解为米，这样 $$\\Delta t$$ 的单位就是秒。",
            "solution": "该问题要求推导应用于一维扩散方程的数值格式的时间步长 $\\Delta t$ 的精确上界，以使该格式保持非负性和离散极值原理。\n\n控制偏微分方程 (PDE) 是一维扩散方程：\n$$\nu_{t}=\\nu\\,u_{xx}\n$$\n定义在区域 $x \\in [0, L]$上，具有齐次狄利克雷边界条件 $u(0,t)=0$ 和 $u(L,t)=0$，以及非负初始条件 $u(x,0) \\ge 0$。\n\n首先，我们构建全离散数值格式。空间域 $[0,L]$ 用均匀网格 $x_i = i h$（其中 $i \\in \\{0, 1, \\dots, N\\}$，$h=L/N$）进行离散。时间域用时间层 $t^n = n \\Delta t$ 进行离散。在网格点 $(x_i, t^n)$ 处的数值解记为 $u_i^n$。\n\n时间导数 $u_t$ 使用显式前向欧拉法进行近似：\n$$\nu_t(x_i, t^n) \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}\n$$\n\n空间二阶导数 $u_{xx}$ 使用二阶中心差分格式进行近似：\n$$\nu_{xx}(x_i, t^n) \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2}\n$$\n\n将这些近似代入偏微分方程，得到内部节点 $i \\in \\{1, 2, \\dots, N-1\\}$ 的格式：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\nu \\left( \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} \\right)\n$$\n\n求解下一个时间步的解 $u_i^{n+1}$：\n$$\nu_i^{n+1} = u_i^n + \\frac{\\nu \\Delta t}{h^2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\n\n让我们定义无量纲参数 $s = \\frac{\\nu \\Delta t}{h^2}$，该参数通常称为网格傅里叶数或数值扩散数。通过收集时间层 $n$ 的项，可以重写更新方程：\n$$\nu_i^{n+1} = u_i^n + s u_{i+1}^n - 2s u_i^n + s u_{i-1}^n\n$$\n$$\nu_i^{n+1} = s u_{i-1}^n + (1 - 2s) u_i^n + s u_{i+1}^n\n$$\n这是内部节点的更新规则。边界条件被强制设置为 $u_0^n = 0$ 和 $u_N^n = 0$，对所有时间层 $n \\ge 0$ 成立。\n\n现在，我们分析所需的两个性质，以找到对 $s$ 的条件，并由此得到对 $\\Delta t$ 的条件。\n\n**1. 非负性保持**\n\n我们要求，如果对所有 $i \\in \\{0, 1, \\dots, N\\}$ 都有 $u_i^n \\ge 0$，那么对所有 $i$ 都有 $u_i^{n+1} \\ge 0$。通过归纳法，在给定 $u_i^0 \\ge 0$ 的情况下，这将确保在所有时间都保持非负性。\n\n更新规则将 $u_i^{n+1}$ 表示为时间层 $n$ 上的值 $u_{i-1}^n$、$u_i^n$ 和 $u_{i+1}^n$ 的线性组合。如果我们假设对所有 $j$ 都有 $u_j^n \\ge 0$，那么确保 $u_i^{n+1} \\ge 0$ 的一个充分条件是该线性组合中的所有系数都非负。\n系数分别为 $s$、$(1-2s)$ 和 $s$。\n由于 $\\nu > 0$、$\\Delta t > 0$ 和 $h > 0$，参数 $s = \\frac{\\nu \\Delta t}{h^2}$ 总是正的。\n唯一剩下的条件是针对 $u_i^n$ 的系数：\n$$\n1 - 2s \\ge 0 \\implies 2s \\le 1 \\implies s \\le \\frac{1}{2}\n$$\n在边界上，$u_0^{n+1}=0$ 和 $u_N^{n+1}=0$，它们是非负的。\n因此，条件 $s \\le \\frac{1}{2}$ 是保持非负性的**充分**条件。\n\n为了证明该条件也是**必要**的，我们必须证明如果 $s > \\frac{1}{2}$，则存在一个非负初始条件 $u_i^0 \\ge 0$，使得该格式在下一个时间步产生负值。考虑一个在内部节点 $k \\in \\{1, \\dots, N-1\\}$ 处有单个非零值的初始条件，例如 $u_k^0 = 1$ 且对所有 $i \\ne k$ 都有 $u_i^0 = 0$。该初始条件是非负的。将该格式应用一个时间步，我们得到节点 $k$ 处的值：\n$$\nu_k^1 = s u_{k-1}^0 + (1-2s) u_k^0 + s u_{k+1}^0 = s(0) + (1-2s)(1) + s(0) = 1 - 2s\n$$\n如果 $s > \\frac{1}{2}$，则 $2s > 1$，且 $1-2s  0$。因此 $u_k^1  0$，这违反了非负性要求。所以，条件 $s \\le \\frac{1}{2}$ 是保持非负性的充分必要条件。\n\n**2. 离散极值原理**\n\n离散极值原理（在 $\\ell^{\\infty}$ 范数下）指出，解的最大绝对值不随时间增长：$\\|u^{n+1}\\|_{\\infty} \\le \\|u^n\\|_{\\infty}$，其中 $\\|u^n\\|_{\\infty} = \\max_{i} |u_i^n|$。令 $M^n = \\|u^n\\|_{\\infty}$。\n\n让我们在 $s \\le \\frac{1}{2}$ 的条件下分析更新规则。\n$$\n|u_i^{n+1}| = |s u_{i-1}^n + (1 - 2s) u_i^n + s u_{i+1}^n|\n$$\n使用三角不等式：\n$$\n|u_i^{n+1}| \\le |s u_{i-1}^n| + |(1 - 2s) u_i^n| + |s u_{i+1}^n| = |s||u_{i-1}^n| + |1 - 2s||u_i^n| + |s||u_{i+1}^n|\n$$\n因为我们已经确定 $0  s \\le \\frac{1}{2}$，所以系数 $s$ 和 $(1-2s)$ 都是非负的。因此， $|s| = s$ 且 $|1-2s| = 1-2s$。\n$$\n|u_i^{n+1}| \\le s|u_{i-1}^n| + (1 - 2s)|u_i^n| + s|u_{i+1}^n|\n$$\n根据最大范数的定义，对所有 $j$ 都有 $|u_j^n| \\le M^n$。将此代入不等式：\n$$\n|u_i^{n+1}| \\le s M^n + (1 - 2s) M^n + s M^n = (s + 1 - 2s + s) M^n = M^n\n$$\n这个结果 $|u_i^{n+1}| \\le M^n$ 对所有内部节点 $i$ 都成立。对于边界节点，有 $|u_0^{n+1}|=0 \\le M^n$ 和 $|u_N^{n+1}|=0 \\le M^n$（假设初始条件非平凡，即 $M^n  0$）。\n由于对所有 $i \\in \\{0, 1, \\dots, N\\}$ 都有 $|u_i^{n+1}| \\le M^n$，我们可以得出结论 $\\max_i |u_i^{n+1}| \\le M^n$。这正是 $\\|u^{n+1}\\|_{\\infty} \\le \\|u^n\\|_{\\infty}$。因此，条件 $s \\le \\frac{1}{2}$ 是离散极值原理成立的**充分**条件。\n\n为了证明该条件对于离散极值原理也是**必要**的，我们再次为 $s  \\frac{1}{2}$ 的情况构造一个反例。该原理必须对任何初始数据都成立。考虑一个振荡初始条件，例如对 $i \\in \\{1, \\dots, N-1\\}$ 有 $u_i^0 = (-1)^i$，且 $u_0^0=0, u_N^0=0$。该初始数据的最大范数为 $\\|u^0\\|_{\\infty}=1$。我们考察一个内部节点 $k$，在该点 $u_k^0 = 1$。其相邻点的值为 $u_{k-1}^0 = -1$ 和 $u_{k+1}^0 = -1$。\n在下一个时间步，该节点的值为：\n$$\nu_k^1 = s u_{k-1}^0 + (1-2s) u_k^0 + s u_{k+1}^0 = s(-1) + (1-2s)(1) + s(-1) = -s + 1 - 2s - s = 1 - 4s\n$$\n如果 $s  \\frac{1}{2}$，则 $4s  2$，这意味着 $1-4s  -1$。\n其绝对值为 $|u_k^1| = |1-4s| = 4s - 1$。由于 $s  \\frac{1}{2}$，我们有 $4s-1  4(\\frac{1}{2})-1 = 1$。\n所以， $|u_k^1|  1 = \\|u^0\\|_{\\infty}$。这意味着 $\\|u^1\\|_{\\infty}  \\|u^0\\|_{\\infty}$，这违反了离散极值原理。因此，条件 $s \\le \\frac{1}{2}$ 也是**必要**的。\n\n**结论**\n\n保持非负性和离散极值原理都需要条件 $s \\le \\frac{1}{2}$，并且该条件对每个性质都是充分且必要的。问题要求确保这两个性质成立的时间步长 $\\Delta t$ 的精确上界。该上界通过将 $s$ 设置为其允许的最大值来找到：\n$$\ns = \\frac{\\nu \\Delta t}{h^2} = \\frac{1}{2}\n$$\n求解 $\\Delta t$：\n$$\n\\Delta t = \\frac{h^2}{2\\nu}\n$$\n保证这两个性质的条件是 $\\Delta t \\le \\frac{h^2}{2\\nu}$。精确上界是等式成立的情况。",
            "answer": "$$\n\\boxed{\\frac{h^2}{2\\nu}}\n$$"
        },
        {
            "introduction": "在掌握了内部网格点的基本原理后，下一个关键步骤是处理边界条件，这也是实际计算中错误的常见来源。本练习将揭示一个不恰当处理的诺伊曼（Neumann）边界条件如何破坏保证离散最大值原理成立所需的代数结构（即M-矩阵特性），从而可能产生非物理解。通过构建一个基于通量平衡的保守格式 ，你将学会如何修正这个问题，确保整个离散系统保持良好的物理性质。",
            "id": "3955278",
            "problem": "考虑平面板中被动标量的稳态一维扩散，这是航空航天计算流体动力学 (CFD) 中壁面有界输运的典型模型。设标量场为 $u(x)$，定义在区间 $x \\in [0,L]$ 上，其扩散系数为常数 $k0$。其控制方程为稳态扩散方程 $-\\frac{d}{dx}\\left(k \\frac{du}{dx}\\right)=0$。在左边界施加 Neumann 边界条件，指定通过 $x=0$ 的向外扩散通量为 $q$，即 $k\\,u_{x}(0)=q$；在右边界施加 Dirichlet 边界条件，$u(L)=0$。使用具有 $N+1$ 个节点的均匀网格对区间进行离散化，节点位置为 $x_i = i h$，$i=0,1,\\dots,N$，其中 $h=L/N$。在内部节点 $i=1,2,\\dots,N-1$ 上，使用基于节点的标准二阶中心差分格式对扩散算子进行离散化。\n\n您将分析 Neumann 边界封闭对方程组矩阵的符号结构以及离散极值原理 (DMP) 满足情况的影响。回想一下，对于标量扩散问题，线性系统 $A \\mathbf{u}=\\mathbf{b}$ 满足 DMP 的一个充分代数条件是 $A$ 是一个 M-矩阵，其非对角线元素为非正值，对角线元素为正值。对于当前的标量扩散离散化，这简化为逐行要求非对角线系数 $\\le 0$ 且对角线系数 $0$。\n\n(a) 通过使用不恰当的单边差分 $u_{x}(0)\\approx \\frac{u_1-u_0}{h}$ 来施加 Neumann 边界条件，构造与左边界 $x=0$ 相关的代数行。通过将边界方程除以 $h$，使用与内部方程相同的量纲尺度，将此边界行写成 $a_{00} u_0 + a_{01} u_1 = b_0$ 的形式，以获得与 $k/h^2$ 单位一致的系数。确定 $a_{00}$ 和 $a_{01}$ 的符号，并简要解释为什么该行会违反 M-矩阵的非对角线符号要求，从而破坏 DMP。\n\n(b) 通过在与 $x=0$ 相邻的半单元上实施通量平衡，为左边界推导一个修正的、守恒的边界格式：左侧面的扩散通量等于给定的 $q$，节点 0 和 1 之间的右侧面扩散通量由中心差分近似。将得到的代数边界行写成 $a_{00}^{(c)} u_0 + a_{01}^{(c)} u_1 = b_0^{(c)}$ 的形式，并确定 $a_{00}^{(c)}$ 和 $a_{01}^{(c)}$ 的符号，证明该行恢复了 M-矩阵结构所要求的非对角线非正性。\n\n(c) 考虑一个混合边界行族，它是通过将 (a) 部分中除以 $h$ 后的非恰当缩放行与 (b) 部分中的守恒行进行凸组合得到的。将混合行定义为\n$$\n\\theta\\left[\\frac{k}{h^2}(u_1-u_0)=\\frac{q}{h}\\right] + (1-\\theta)\\left[\\frac{k}{h^2}(u_0 - u_1)=\\frac{q}{h}\\right],\n$$\n其中混合权重为 $\\theta \\in [0,1]$。将其简化为 $a_{00}(\\theta) u_0 + a_{01}(\\theta) u_1 = b_0(\\theta)$ 的形式，并确定最大值 $\\theta^\\star$，使得混合边界行在左边界处保持 M-矩阵的非对角线符号条件，即 $a_{01}(\\theta)\\le 0$。请以一个无单位的精确数值给出 $\\theta^\\star$ 的最终答案。无需四舍五入。",
            "solution": "该问题要求对稳态一维扩散方程的边界条件离散化进行三部分分析。核心主题是满足离散极值原理 (DMP) 的代数条件，这依赖于系统矩阵是一个 M-矩阵。其充分条件是具有正的对角线元素 ($a_{ii}0$) 和非正的非对角线元素 ($a_{ij}\\le 0$ for $i \\ne j$)。\n\n(a) 我们被要求使用一阶单边前向差分近似 $u_{x}(0)\\approx \\frac{u_1-u_0}{h}$ 来离散化 Neumann 边界条件 $k\\,u_{x}(0)=q$，其中 $u_i = u(x_i)$。将此近似代入边界条件可得：\n$$\nk \\left(\\frac{u_1 - u_0}{h}\\right) = q\n$$\n问题指定该方程应采用与内部方程一致的量纲尺度来书写。在节点 $i$ 处，$-\\frac{d}{dx}(k\\frac{du}{dx})=0$ 的标准内部离散化为 $\\frac{k}{h^2}(-u_{i-1} + 2u_i - u_{i+1})=0$，其中系数的单位是 $k/h^2$。为达到此尺度，我们将边界方程除以 $h$：\n$$\n\\frac{k}{h^2} (u_1 - u_0) = \\frac{q}{h}\n$$\n将其整理成 $a_{00} u_0 + a_{01} u_1 = b_0$ 的形式，我们得到：\n$$\n-\\frac{k}{h^2} u_0 + \\frac{k}{h^2} u_1 = \\frac{q}{h}\n$$\n由此，我们确定系统矩阵第一行 ($i=0$) 的系数：\n- $a_{00} = -\\frac{k}{h^2}$\n- $a_{01} = \\frac{k}{h^2}$\n- $b_0 = \\frac{q}{h}$\n\n由于扩散系数 $k0$ 且网格间距 $h0$，我们有 $k/h^2  0$。因此，非对角线系数的符号为 $a_{01}  0$。这违反了 M-矩阵关于非对角线元素必须为非正值（$a_{ij} \\le 0$ for $i \\neq j$）的要求。这个正的非对角线元素会阻止系统矩阵成为 M-矩阵，从而可能破坏 DMP。此外，对角线元素 $a_{00} = -k/h^2  0$ 也违反了对角线元素必须为正的条件。\n\n(b) 接下来，我们通过在边界附近的控制体积 (CV) 上使用通量平衡来推导一个守恒格式。该控制体积是一个长度为 $h/2$ 的半单元，即区间 $[0, h/2]$。对于没有源项的稳态问题，将控制方程在该 CV 上积分，可得到其各个面上的通量平衡：\n$$\n\\int_0^{h/2} -\\frac{d}{dx}\\left(k \\frac{du}{dx}\\right) dx = 0 \\implies \\left[-k \\frac{du}{dx}\\right]_0^{h/2} = 0\n$$\n这等效于声明进入 CV 的通量等于流出 CV 的通量。问题陈述左侧面的扩散通量等于给定的 $q$。这被解释为在 $x=0$ 处*进入* CV 的通量，即 $q$。在右侧面 ($x=h/2$) *流出* CV 的通量使用节点 0 和 1 之间的中心差分来近似：\n$$\n\\text{流出通量} = -k u_x\\left(\\frac{h}{2}\\right) \\approx -k \\frac{u_1 - u_0}{h} = k \\frac{u_0 - u_1}{h}\n$$\n通量平衡为：流入通量 = 流出通量。\n$$\nq = k \\frac{u_0-u_1}{h}\n$$\n为了与内部方程的尺度匹配，我们将其除以 $h$：\n$$\n\\frac{k}{h^2}(u_0 - u_1) = \\frac{q}{h}\n$$\n将其写成 $a_{00}^{(c)} u_0 + a_{01}^{(c)} u_1 = b_0^{(c)}$ 的形式可得：\n$$\n\\frac{k}{h^2} u_0 - \\frac{k}{h^2} u_1 = \\frac{q}{h}\n$$\n系数为：\n- $a_{00}^{(c)} = \\frac{k}{h^2}$\n- $a_{01}^{(c)} = -\\frac{k}{h^2}$\n- $b_0^{(c)} = \\frac{q}{h}$\n\n由于 $k/h^2  0$，对角线系数 $a_{00}^{(c)}$ 为正，非对角线系数 $a_{01}^{(c)}$ 为负。这两个符号都与 M-矩阵的要求（$a_{ii}0$ 且 $a_{ij}\\le 0$ for $i \\ne j$）一致。这种守恒格式恢复了边界行所期望的符号结构。\n\n(c) 给定一个混合边界行，它由 (a) 部分的缩放后的非恰当行和 (b) 部分的守恒行进行凸组合而成：\n$$\n\\theta\\left[\\frac{k}{h^2}(u_1-u_0)=\\frac{q}{h}\\right] + (1-\\theta)\\left[\\frac{k}{h^2}(u_0 - u_1)=\\frac{q}{h}\\right]\n$$\n其中 $\\theta \\in [0,1]$。我们需要找到最大的 $\\theta^\\star$，使得非对角线系数 $a_{01}(\\theta)$ 为非正值。首先，我们展开并按 $u_0$ 和 $u_1$ 对各项进行分组：\n$$\n\\theta\\left(-\\frac{k}{h^2}u_0 + \\frac{k}{h^2}u_1\\right) + (1-\\theta)\\left(\\frac{k}{h^2}u_0 - \\frac{k}{h^2}u_1\\right) = \\theta\\frac{q}{h} + (1-\\theta)\\frac{q}{h}\n$$\n等式右边简化为 $b_0(\\theta) = (\\theta + 1 - \\theta)\\frac{q}{h} = \\frac{q}{h}$。\n$u_0$ 的系数是：\n$$\na_{00}(\\theta) = \\theta\\left(-\\frac{k}{h^2}\\right) + (1-\\theta)\\left(\\frac{k}{h^2}\\right) = \\frac{k}{h^2}(-\\theta + 1 - \\theta) = \\frac{k}{h^2}(1-2\\theta)\n$$\n$u_1$ 的系数是：\n$$\na_{01}(\\theta) = \\theta\\left(\\frac{k}{h^2}\\right) + (1-\\theta)\\left(-\\frac{k}{h^2}\\right) = \\frac{k}{h^2}(\\theta - (1-\\theta)) = \\frac{k}{h^2}(\\theta - 1 + \\theta) = \\frac{k}{h^2}(2\\theta-1)\n$$\n问题要求保持 M-矩阵性质的非对角线符号条件。这意味着我们必须有 $a_{01}(\\theta) \\le 0$：\n$$\n\\frac{k}{h^2}(2\\theta-1) \\le 0\n$$\n由于 $k/h^2  0$，我们可以用此项相除而不改变不等式的方向：\n$$\n2\\theta - 1 \\le 0\n$$\n$$\n2\\theta \\le 1\n$$\n$$\n\\theta \\le \\frac{1}{2}\n$$\n混合因子 $\\theta$ 被限制在区间 $[0,1]$ 内。因此，条件 $\\theta \\le \\frac{1}{2}$ 是约束因子。满足此条件的最大 $\\theta$ 值为 $\\theta^\\star = \\frac{1}{2}$。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "这个练习旨在揭示一个更深层次的、也更容易被误解的概念。许多人可能认为，使用一个无条件稳定（A-稳定）的时间积分方法（如隐式欧拉法）就能保证解的有界性，但事实并非如此。本练习通过一个具体的计算反例  表明，如果空间离散格式本身不满足单调性（例如，在对流主导问题中使用中心差分），即使是最好的时间格式也无法阻止非物理振荡的产生。这个实践将加深你的理解：离散最大值原理本质上与空间算子的结构紧密相关，而不是单靠时间格式就能保证的。",
            "id": "3955271",
            "problem": "考虑航空航天计算流体力学(CFD)中的一维瞬态有界标量对流扩散问题，该问题在空间区间 $x \\in [0,3]$ 上建模，并采用狄利克雷边界条件 $u(0,t)=0$ 和 $u(3,t)=1$。其控制方程为\n$$\n\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = D \\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\n其中 $U$ 是均匀对流速度，$D$ 是分子扩散率。将空间域在均匀网格上离散化，节点位于 $x=0,1,2,3$，使得内部未知数为 $u_{1}(t)=u(1,t)$ 和 $u_{2}(t)=u(2,t)$，网格间距为 $\\Delta x = 1$。对一阶和二阶空间导数均使用二阶中心有限差分。在施加 $x=0$ 和 $x=3$ 处的狄利克雷边界条件后，将半离散系统表示为 $\\dot{\\boldsymbol{u}} = \\boldsymbol{A}\\boldsymbol{u} + \\boldsymbol{f}$ 的形式。\n\n使用后向欧拉法对该系统进行时间推进，已知该方法是绝对稳定（A-稳定）的，时间步长为 $\\Delta t = 4$。取 $U=-1$ 和 $D=0.1$（均为一致的国际单位制单位），以及初始内部状态 $u_{1}^{n}=u_{2}^{n}=\\frac{1}{2}$。仅使用这些输入和所述的离散化方法，执行一个后向欧拉步，从以下线性系统中计算 $\\boldsymbol{u}^{n+1}$：\n$$\n\\left(\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A}\\right)\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f}.\n$$\n然后，通过计算超过上边界值 $1$ 的最大过冲来评估对离散极值原理(DMP)的违背程度：\n$$\n\\max\\left\\{\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) - 1,\\;0\\right\\}.\n$$\n将你的最终答案表示为单个精确值（无单位）。无需四舍五入。此构造应作为一个反例，证明当与缺乏单调矩阵（M-矩阵）结构的非单调空间离散格式配对时，一个A-稳定的方法可能无法保持DMP。",
            "solution": "用户希望我解决给定的问题。\n\n### 步骤1：提取已知条件\n- **控制方程：** $\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} = D \\frac{\\partial^{2} u}{\\partial x^{2}}$\n- **定义域：** $x \\in [0,3]$\n- **边界条件：** $u(0,t)=0$, $u(3,t)=1$\n- **网格节点：** $x=0,1,2,3$\n- **网格间距：** $\\Delta x = 1$\n- **内部未知数：** $u_{1}(t)=u(1,t)$， $u_{2}(t)=u(2,t)$\n- **空间离散：** 对一阶和二阶导数均使用二阶中心有限差分。\n- **半离散形式：** $\\dot{\\boldsymbol{u}} = \\boldsymbol{A}\\boldsymbol{u} + \\boldsymbol{f}$\n- **时间步进方法：** 后向欧拉法\n- **时间步长：** $\\Delta t = 4$\n- **常数：** $U=-1$, $D=0.1$\n- **初始条件：** $\\boldsymbol{u}^{n} = \\begin{pmatrix} u_{1}^{n} \\\\ u_{2}^{n} \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix}$\n- **时间步的线性系统：** $\\left(\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A}\\right)\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f}$\n- **任务：** 计算 $\\boldsymbol{u}^{n+1}$ 并评估DMP违背情况 $\\max\\left\\{\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) - 1,\\;0\\right\\}$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题描述了一个标准的一维对流扩散方程，这是流体力学和传热学中的一个基本模型。所用的数值方法（中心差分、后向欧拉法）是CFD中的标准技术。参数在物理上是合理的。该问题是科学合理的。\n- **适定性：** 所有必要的参数、边界条件、初始条件和数值方法都已指定。任务是执行一个单一、明确的计算步骤。得到的线性系统是非奇异的，从而有唯一解。该问题是适定的。\n- **客观性：** 问题陈述由客观的数学定义和指令组成。它要求进行一个特定的数值计算。不需要主观解释。\n- **其他标准：** 该问题是完整的、一致的，并且与CFD中离散极值原理这一特定主题直接相关。这是一个标准的、非平凡的练习，旨在阐明数值分析中的一个关键概念。\n\n### 步骤3：结论与行动\n该问题是有效的。将提供完整解答。\n\n### 解题推导\n将控制方程重新排列以分离时间导数项：\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^{2} u}{\\partial x^{2}} - U \\frac{\\partial u}{\\partial x}\n$$\n空间域使用均匀网格间距 $\\Delta x = 1$ 进行离散化。网格节点为 $x_0=0, x_1=1, x_2=2, x_3=3$。内部未知数为 $u_1(t) = u(x_1, t)$ 和 $u_2(t) = u(x_2, t)$。边界条件为 $u_0 = u(0,t) = 0$ 和 $u_3 = u(3,t) = 1$。\n\n我们使用二阶中心有限差分来离散化内部节点 $i=1,2$ 处的空间导数：\n$$\n\\left. \\frac{\\partial u}{\\partial x} \\right|_{x_i} \\approx \\frac{u_{i+1} - u_{i-1}}{2\\Delta x}\n$$\n$$\n\\left. \\frac{\\partial^2 u}{\\partial x^2} \\right|_{x_i} \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta x)^2}\n$$\n将这些代入每个内部节点的控制方程，其中 $\\Delta x=1$：\n\n对于节点 $i=1$：\n$$\n\\frac{du_1}{dt} = D \\frac{u_2 - 2u_1 + u_0}{(1)^2} - U \\frac{u_2 - u_0}{2(1)}\n$$\n当 $u_0=0$ 时：\n$$\n\\frac{du_1}{dt} = D(u_2 - 2u_1) - U \\frac{u_2}{2} = (-2D)u_1 + \\left(D - \\frac{U}{2}\\right)u_2\n$$\n\n对于节点 $i=2$：\n$$\n\\frac{du_2}{dt} = D \\frac{u_3 - 2u_2 + u_1}{(1)^2} - U \\frac{u_3 - u_1}{2(1)}\n$$\n当 $u_3=1$ 时：\n$$\n\\frac{du_2}{dt} = D(1 - 2u_2 + u_1) - U \\frac{1 - u_1}{2} = (D + \\frac{U}{2})u_1 - 2Du_2 + \\left(D - \\frac{U}{2}\\right)\n$$\n\n对于 $\\boldsymbol{u} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ 的半离散系统 $\\dot{\\boldsymbol{u}} = \\boldsymbol{A}\\boldsymbol{u} + \\boldsymbol{f}$ 为：\n$$\n\\begin{pmatrix} \\dot{u}_1 \\\\ \\dot{u}_2 \\end{pmatrix} = \\begin{pmatrix} -2D  D - \\frac{U}{2} \\\\ D + \\frac{U}{2}  -2D \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ D - \\frac{U}{2} \\end{pmatrix}\n$$\n我们代入给定值 $U=-1$ 和 $D=0.1$：\n$$\n-2D = -2(0.1) = -0.2 = -\\frac{1}{5}\n$$\n$$\nD - \\frac{U}{2} = 0.1 - \\frac{-1}{2} = 0.1 + 0.5 = 0.6 = \\frac{3}{5}\n$$\n$$\nD + \\frac{U}{2} = 0.1 + \\frac{-1}{2} = 0.1 - 0.5 = -0.4 = -\\frac{2}{5}\n$$\n系统矩阵为：\n$$\n\\boldsymbol{A} = \\begin{pmatrix} -1/5  3/5 \\\\ -2/5  -1/5 \\end{pmatrix}, \\quad \\boldsymbol{f} = \\begin{pmatrix} 0 \\\\ 3/5 \\end{pmatrix}\n$$\n问题指定使用后向欧拉法，时间步长为 $\\Delta t = 4$。求解 $\\boldsymbol{u}^{n+1}$ 的系统是：\n$$\n\\left(\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A}\\right)\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f}\n$$\n首先，我们计算左侧（LHS）的矩阵：\n$$\n\\Delta t\\,\\boldsymbol{A} = 4 \\begin{pmatrix} -1/5  3/5 \\\\ -2/5  -1/5 \\end{pmatrix} = \\begin{pmatrix} -4/5  12/5 \\\\ -8/5  -4/5 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} -4/5  12/5 \\\\ -8/5  -4/5 \\end{pmatrix} = \\begin{pmatrix} 9/5  -12/5 \\\\ 8/5  9/5 \\end{pmatrix}\n$$\n接下来，我们计算右侧（RHS）的向量。初始状态为 $\\boldsymbol{u}^n = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix}$。\n$$\n\\Delta t\\,\\boldsymbol{f} = 4 \\begin{pmatrix} 0 \\\\ 3/5 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 12/5 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{u}^{n} + \\Delta t\\,\\boldsymbol{f} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 12/5 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 5/10 + 24/10 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 29/10 \\end{pmatrix}\n$$\n求解 $\\boldsymbol{u}^{n+1} = \\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\end{pmatrix}$ 的线性系统为：\n$$\n\\begin{pmatrix} 9/5  -12/5 \\\\ 8/5  9/5 \\end{pmatrix} \\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 29/10 \\end{pmatrix}\n$$\n我们求解这个 $2 \\times 2$ 系统。系数矩阵的行列式为：\n$$\n\\det(\\boldsymbol{I} - \\Delta t\\,\\boldsymbol{A}) = \\left(\\frac{9}{5}\\right)\\left(\\frac{9}{5}\\right) - \\left(-\\frac{12}{5}\\right)\\left(\\frac{8}{5}\\right) = \\frac{81}{25} + \\frac{96}{25} = \\frac{177}{25}\n$$\n使用克莱姆法则求解 $u_1^{n+1}$ 和 $u_2^{n+1}$：\n$$\nu_1^{n+1} = \\frac{\\det\\begin{pmatrix} 1/2  -12/5 \\\\ 29/10  9/5 \\end{pmatrix}}{177/25} = \\frac{(1/2)(9/5) - (-12/5)(29/10)}{177/25} = \\frac{9/10 + 348/50}{177/25} = \\frac{45/50 + 348/50}{177/25} = \\frac{393/50}{177/25} = \\frac{393}{50} \\cdot \\frac{25}{177} = \\frac{393}{2 \\cdot 177}\n$$\n分解数字，$393 = 3 \\cdot 131$ 且 $177 = 3 \\cdot 59$。\n$$\nu_1^{n+1} = \\frac{3 \\cdot 131}{2 \\cdot 3 \\cdot 59} = \\frac{131}{118}\n$$\n类似地，对于 $u_2^{n+1}$：\n$$\nu_2^{n+1} = \\frac{\\det\\begin{pmatrix} 9/5  1/2 \\\\ 8/5  29/10 \\end{pmatrix}}{177/25} = \\frac{(9/5)(29/10) - (1/2)(8/5)}{177/25} = \\frac{261/50 - 4/5}{177/25} = \\frac{261/50 - 40/50}{177/25} = \\frac{221/50}{177/25} = \\frac{221}{50} \\cdot \\frac{25}{177} = \\frac{221}{2 \\cdot 177} = \\frac{221}{354}\n$$\n时间 $n+1$ 时的状态是 $\\boldsymbol{u}^{n+1} = \\begin{pmatrix} 131/118 \\\\ 221/354 \\end{pmatrix}$。\n\n最后，我们评估对离散极值原理(DMP)的违背情况。初始数据和边界数据在范围 $[0,1]$ 内。DMP要求下一个时间步的解也保持在此范围内。我们检查是否存在超过最大边界值 $1$ 的过冲。\n需要计算的量是 $\\max\\left\\{\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) - 1,\\;0\\right\\}$。\n首先，我们比较 $u_1^{n+1}$ 和 $u_2^{n+1}$：\n$$\nu_1^{n+1} = \\frac{131}{118}  \\frac{118}{118} = 1\n$$\n$$\nu_2^{n+1} = \\frac{221}{354}  1\n$$\n两者中的最大值是 $u_1^{n+1}$：\n$$\n\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) = \\frac{131}{118}\n$$\n现在我们计算过冲：\n$$\n\\max\\left(u_{1}^{n+1},u_{2}^{n+1}\\right) - 1 = \\frac{131}{118} - 1 = \\frac{131 - 118}{118} = \\frac{13}{118}\n$$\n由于该值为正，最终结果是：\n$$\n\\max\\left\\{\\frac{13}{118},\\;0\\right\\} = \\frac{13}{118}\n$$\n这表明DMP被违背了，因为数值解 $u_1^{n+1}$ 超过了最大边界值 $1$。",
            "answer": "$$\\boxed{\\frac{13}{118}}$$"
        }
    ]
}