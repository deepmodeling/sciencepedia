{
    "hands_on_practices": [
        {
            "introduction": "压力修正方法的核心在于求解压力泊松方程（Pressure Poisson Equation, PPE），以强制执行不可压缩流动的无散场条件。本练习提供了一个直接的实践机会，让您亲手计算离散化后的压力泊松方程的源项，该源项来自于预测速度场的散度 ()。掌握这一基础计算是理解并实现任何压力修正求解器的关键第一步。",
            "id": "3986461",
            "problem": "在计算流体动力学（CFD）中，一个不可压缩流通过压力修正策略在时间上推进。通过对修正后的速度施加无散度约束，产生了压力泊松方程（PPE）。考虑一个二维均匀笛卡尔网格，预测速度场存储在单元中心。我们关注一个内部控制体，记为单元 $P$，其近邻为 $W$、$E$、$S$ 和 $N$。网格间距为 $\\Delta x = 0.02$ 米和 $\\Delta y = 0.03$ 米，流体密度和时间步长分别为 $\\rho = 1.2$ $\\mathrm{kg\\, m^{-3}}$ 和 $\\Delta t = 0.005$ 秒。\n\n五个单元中心处的预测速度分量如下（单位为 $\\mathrm{m\\, s^{-1}}$）：\n- 在 $P$ 处：$\\tilde{u}_{P} = 1.8$, $\\tilde{v}_{P} = -0.6$。\n- 在 $E$ 处：$\\tilde{u}_{E} = 2.1$, $\\tilde{v}_{E} = -0.5$。\n- 在 $W$ 处：$\\tilde{u}_{W} = 1.2$, $\\tilde{v}_{W} = -0.7$。\n- 在 $N$ 处：$\\tilde{u}_{N} = 1.9$, $\\tilde{v}_{N} = -0.2$。\n- 在 $S$ 处：$\\tilde{u}_{S} = 1.7$, $\\tilde{v}_{S} = -1.0$。\n\n使用二阶中心插值格式来近似单元 $P$ 东、西、南、北四个面上的法向预测速度，计算由预测速度的有限体积散度得到的 $P$ 点压力泊松方程（PPE）的离散右端源项。将答案表示为单位体积源项 $s_{P}$，并将您的答案四舍五入到四位有效数字。最终源项的单位为 $\\mathrm{kg\\, m^{-3}\\, s^{-2}}$。",
            "solution": "不可压缩流的压力修正法对修正后的速度场 $\\mathbf{u}^{n+1}$ 施加无散度约束。新时间步 $n+1$ 的速度由预测速度场 $\\tilde{\\mathbf{u}}$ 通过压力修正量 $p'$ 更新得到：\n$$ \\mathbf{u}^{n+1} = \\tilde{\\mathbf{u}} - \\frac{\\Delta t}{\\rho} \\nabla p' $$\n不可压缩流的连续性方程为 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$。将修正方程代入连续性方程，得到压力泊松方程（PPE）：\n$$ \\nabla \\cdot \\left( \\tilde{\\mathbf{u}} - \\frac{\\Delta t}{\\rho} \\nabla p' \\right) = 0 $$\n$$ \\nabla \\cdot \\tilde{\\mathbf{u}} - \\frac{\\Delta t}{\\rho} \\nabla^2 p' = 0 $$\n重新整理可得压力修正量的标准形式 PPE：\n$$ \\nabla^2 p' = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\tilde{\\mathbf{u}} $$\n问题要求解的是该方程在控制体 $P$ 中心的离散单位体积源项 $s_P$。连续源项为 $s = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\tilde{\\mathbf{u}}$。其在单元 $P$ 的离散对应项为：\n$$ s_P = \\frac{\\rho}{\\Delta t} (\\nabla \\cdot \\tilde{\\mathbf{u}})_P $$\n其中 $(\\nabla \\cdot \\tilde{\\mathbf{u}})_P$ 是单元 $P$ 中预测速度场散度的有限体积近似。\n\n根据散度定理，控制体 $V_P$ 上的平均散度是流出控制体表面 $S_P$ 的净通量除以体积：\n$$ (\\nabla \\cdot \\tilde{\\mathbf{u}})_P = \\frac{1}{V_P} \\oint_{S_P} \\tilde{\\mathbf{u}} \\cdot d\\mathbf{A} $$\n对于单元尺寸为 $\\Delta x$ 和 $\\Delta y$ 的二维笛卡尔网格，体积为 $V_P = \\Delta x \\Delta y$（假设单位深度）。面积分可近似为穿过控制体四个面（东 $e$、西 $w$、北 $n$、南 $s$）的通量之和：\n$$ \\oint_{S_P} \\tilde{\\mathbf{u}} \\cdot d\\mathbf{A} \\approx (\\tilde{u}_e A_e) - (\\tilde{u}_w A_w) + (\\tilde{v}_n A_n) - (\\tilde{v}_s A_s) $$\n面面积为 $A_e = A_w = \\Delta y$ 和 $A_n = A_s = \\Delta x$。散度的表达式变为：\n$$ (\\nabla \\cdot \\tilde{\\mathbf{u}})_P \\approx \\frac{\\tilde{u}_e \\Delta y - \\tilde{u}_w \\Delta y + \\tilde{v}_n \\Delta x - \\tilde{v}_s \\Delta x}{\\Delta x \\Delta y} = \\frac{\\tilde{u}_e - \\tilde{u}_w}{\\Delta x} + \\frac{\\tilde{v}_n - \\tilde{v}_s}{\\Delta y} $$\n问题指定面法向速度应使用二阶中心插值格式从单元中心值近似得到。\n东面上的速度 $\\tilde{u}_e$ 由单元 $P$ 和 $E$ 插值得到：\n$$ \\tilde{u}_e = \\frac{\\tilde{u}_P + \\tilde{u}_E}{2} = \\frac{1.8 + 2.1}{2} = \\frac{3.9}{2} = 1.95 \\, \\mathrm{m\\,s^{-1}} $$\n西面上的速度 $\\tilde{u}_w$ 由单元 $W$ 和 $P$ 插值得到：\n$$ \\tilde{u}_w = \\frac{\\tilde{u}_W + \\tilde{u}_P}{2} = \\frac{1.2 + 1.8}{2} = \\frac{3.0}{2} = 1.5 \\, \\mathrm{m\\,s^{-1}} $$\n北面上的速度 $\\tilde{v}_n$ 由单元 $P$ 和 $N$ 插值得到：\n$$ \\tilde{v}_n = \\frac{\\tilde{v}_P + \\tilde{v}_N}{2} = \\frac{-0.6 + (-0.2)}{2} = \\frac{-0.8}{2} = -0.4 \\, \\mathrm{m\\,s^{-1}} $$\n南面上的速度 $\\tilde{v}_s$ 由单元 $S$ 和 $P$ 插值得到：\n$$ \\tilde{v}_s = \\frac{\\tilde{v}_S + \\tilde{v}_P}{2} = \\frac{-1.0 + (-0.6)}{2} = \\frac{-1.6}{2} = -0.8 \\, \\mathrm{m\\,s^{-1}} $$\n现在，我们使用给定的网格间距 $\\Delta x = 0.02$ 和 $\\Delta y = 0.03$ 计算离散散度的两项：\n$$ \\frac{\\tilde{u}_e - \\tilde{u}_w}{\\Delta x} = \\frac{1.95 - 1.5}{0.02} = \\frac{0.45}{0.02} = 22.5 \\, \\mathrm{s^{-1}} $$\n$$ \\frac{\\tilde{v}_n - \\tilde{v}_s}{\\Delta y} = \\frac{-0.4 - (-0.8)}{0.03} = \\frac{0.4}{0.03} = \\frac{40}{3} \\, \\mathrm{s^{-1}} $$\n单元 $P$ 处的总离散散度是这两项的和：\n$$ (\\nabla \\cdot \\tilde{\\mathbf{u}})_P = 22.5 + \\frac{40}{3} = \\frac{45}{2} + \\frac{40}{3} = \\frac{135 + 80}{6} = \\frac{215}{6} \\, \\mathrm{s^{-1}} $$\n最后，我们使用 $\\rho = 1.2$ 和 $\\Delta t = 0.005$ 计算单位体积源项 $s_P$：\n$$ s_P = \\frac{\\rho}{\\Delta t} (\\nabla \\cdot \\tilde{\\mathbf{u}})_P = \\left( \\frac{1.2\\,\\mathrm{kg\\,m^{-3}}}{0.005\\,\\mathrm{s}} \\right) \\left( \\frac{215}{6} \\, \\mathrm{s^{-1}} \\right) $$\n前置因子为：\n$$ \\frac{1.2}{0.005} = \\frac{1200}{5} = 240 \\, \\mathrm{kg\\,m^{-3}\\,s^{-1}} $$\n因此，源项为：\n$$ s_P = 240 \\times \\frac{215}{6} = 40 \\times 215 = 8600 \\, \\mathrm{kg\\,m^{-3}\\,s^{-2}} $$\n计算值恰好为 $8600$。问题要求答案四舍五入到四位有效数字。数字 $8600$ 可以明确地写成四位有效数字的形式，即 $8.600 \\times 10^3$。",
            "answer": "$$\n\\boxed{8.600 \\times 10^3}\n$$"
        },
        {
            "introduction": "在同位网格（collocated grid）上实现压力修正算法时，一个常见的挑战是压力-速度解耦，这可能导致非物理的棋盘状压力场。本练习将引导您应用 Rhie–Chow 动量插值法，这是一种经典的数值技术，旨在克服这一问题，确保压力和速度场的正确耦合 ()。通过此练习，您将理解如何在实践中保证求解的鲁棒性。",
            "id": "3986482",
            "problem": "考虑沿笛卡尔坐标 $x$ 的一维稳态、层流、不可压缩流动，其采用同位网格有限体积法进行离散化，控制体大小均匀为 $\\Delta x$，面面积为单位面积 $A$。流动方向与 $x$ 轴一致，面法向量指向 $x$ 轴正方向。计算任务是使用 Rhie–Chow 动量插值法计算单个内部面的质量通量，以避免压力-速度解耦。\n\n从一维的质量守恒和稳态、不可压缩动量平衡方程出发：\n- 连续性方程：$\\frac{d u}{d x} = 0$，\n- 动量方程：$\\rho u \\frac{d u}{d x} = -\\frac{d p}{d x} + \\mu \\frac{d^{2} u}{d x^{2}}$，\n并使用在均匀网格上的中心差分、同位网格有限体积法 (FVM) 离散化，推导与 Rhie–Chow 动量插值一致的面速度表达式。假设动量方程已被线性化，并使用速度欠松弛因子 $\\alpha_{u}$ 进行欠松弛，因此单元 $P$ 的欠松弛对角系数为 $a_{P}^{u} = a_{P}/\\alpha_{u}$，其中 $a_{P}$ 是由均匀网格上的扩散算子产生的未松弛的对角系数。使用欠松弛动量对角线，通过对称地平均相邻的欠松弛对角线，来构造位于两个相邻单元 $P$ 和 $E$ 之间的面 $f$ 上的 Rhie–Chow 压力-速度耦合系数，并用此来封闭与半控制体动量平衡一致的面速度表达式。将给定的单元中心伪速度视为通过求解不含压力梯度项的动量方程得到的速度。\n\n位于单元 $P$ 和 $E$ 之间的特定面 $f$ 的数据：\n- 均匀间距 $\\Delta x = 0.1\\,\\mathrm{m}$，\n- 面面积 $A = 1\\,\\mathrm{m}^{2}$，\n- 密度 $\\rho = 1.0\\,\\mathrm{kg/m^{3}}$，\n- 动力粘度 $\\mu = 10\\,\\mathrm{Pa\\cdot s}$，\n- 速度欠松弛 $\\alpha_{u} = 0.7$，\n- 相邻单元中心的伪速度 $u_{P}^{*} = 0.08\\,\\mathrm{m/s}$ 和 $u_{E}^{*} = 0.04\\,\\mathrm{m/s}$，\n- 单元中心的压力 $p_{P} = 101325\\,\\mathrm{Pa}$ 和 $p_{E} = 101305\\,\\mathrm{Pa}$。\n\n计算在 $x$ 轴正方向上，面 $f$ 处的 Rhie–Chow 插值面质量通量 $\\phi_{f} = \\rho\\,u_{f}\\,A$。以 $\\mathrm{kg/s}$ 为单位表示您的最终答案，并将答案四舍五入到四位有效数字。",
            "solution": "主要目标是计算位于两个单元中心 $P$ 和 $E$ 之间的面 $f$ 上的质量通量 $\\phi_f$。质量通量定义为 $\\phi_f = \\rho u_f A$。为了求出 $\\phi_f$，我们必须首先使用 Rhie–Chow 插值法确定面速度 $u_f$。\n\n在单元中心（例如 $P$）的离散化动量方程可以一般地写成欠松弛形式：\n$$ a_P^u u_P = H_P - V_P (\\nabla p)_P $$\n其中 $a_P^u$ 是欠松弛对角系数，$H_P$ 包含相邻速度和源项的贡献，$V_P$ 是单元体积，$(\\nabla p)_P$ 是单元中心的压力梯度。\n\n问题将伪速度 $u_P^*$ 定义为不含压力梯度项的动量方程的解：\n$$ a_P^u u_P^* = H_P $$\n将此代入完整的动量方程，得到单元中心速度的表达式：\n$$ u_P = u_P^* - \\frac{V_P}{a_P^u} (\\nabla p)_P $$\nRhie–Chow 插值格式通过插值伪速度并应用一个特殊形式的压力修正项来构造面速度 $u_f$。面速度 $u_f$ 的表达式为：\n$$ u_f = \\overline{u_f^*} - \\overline{\\left(\\frac{V}{a^u}\\right)_f} (\\nabla p)_f $$\n这里，对于单元 $P$ 和 $E$ 之间的面 $f$，各项定义如下：\n1.  插值得到的伪速度 $\\overline{u_f^*}$ 是单元中心伪速度的线性平均值：\n    $$ \\overline{u_f^*} = \\frac{u_P^* + u_E^*}{2} $$\n2.  面上的压力梯度 $(\\nabla p)_f$ 使用中心差分近似：\n    $$ (\\nabla p)_f = \\frac{p_E - p_P}{\\Delta x} $$\n3.  插值得到的压力-速度耦合系数 $\\overline{\\left(\\frac{V}{a^u}\\right)_f}$ 是单元级系数的算术平均值：\n    $$ \\overline{\\left(\\frac{V}{a^u}\\right)_f} = \\frac{1}{2} \\left(\\frac{V_P}{a_P^u} + \\frac{V_E}{a_E^u}\\right) $$\n对于一维均匀网格，单元体积为 $V_P = V_E = V = A \\Delta x$。问题还指定了均匀网格和恒定物性，这意味着对角系数相等，$a_P = a_E$，因此 $a_P^u = a_E^u$。耦合系数简化为：\n$$ \\overline{\\left(\\frac{V}{a^u}\\right)_f} = \\frac{V_P}{a_P^u} = \\frac{A \\Delta x}{a_P^u} $$\n将这些代入面速度方程：\n$$ u_f = \\frac{u_P^* + u_E^*}{2} - \\left(\\frac{A \\Delta x}{a_P^u}\\right) \\left(\\frac{p_E - p_P}{\\Delta x}\\right) = \\frac{u_P^* + u_E^*}{2} - \\frac{A}{a_P^u} (p_E - p_P) $$\n为继续计算，我们必须计算未松弛的对角系数 $a_P$。问题指出 $a_P$ 来自于使用中心差分有限体积法离散化的扩散算子 $\\mu \\frac{d^2 u}{dx^2}$。扩散项在控制体 $V_P$ (从面 $w$ 到面 $e$) 上的积分为：\n$$ \\int_{V_P} \\nabla \\cdot (\\mu \\nabla u) \\,dV = (\\mu A \\frac{du}{dx})_e - (\\mu A \\frac{du}{dx})_w $$\n在面上使用中心差分来表示梯度：\n$$ \\mu A \\left(\\frac{u_E - u_P}{\\Delta x}\\right) - \\mu A \\left(\\frac{u_P - u_W}{\\Delta x}\\right) = \\frac{\\mu A}{\\Delta x} u_E + \\frac{\\mu A}{\\Delta x} u_W - \\frac{2\\mu A}{\\Delta x} u_P $$\n在标准 FVM 公式 $a_P u_P = \\sum a_{nb} u_{nb} + S_u$ 中，我们有 $a_E = \\frac{\\mu A}{\\Delta x}$，$a_W = \\frac{\\mu A}{\\Delta x}$，以及 $a_P = a_E + a_W$ (对于无源项的纯扩散问题，以确保守恒)。因此，未松弛的对角系数为：\n$$ a_P = \\frac{2\\mu A}{\\Delta x} $$\n现在，我们可以代入给定的数值：\n$\\mu = 10\\,\\mathrm{Pa\\cdot s}$，$A = 1\\,\\mathrm{m}^2$，$\\Delta x = 0.1\\,\\mathrm{m}$。\n$$ a_P = \\frac{2(10)(1)}{0.1} = 200\\,\\mathrm{kg/s} $$\n欠松弛对角系数 $a_P^u$ 是使用给定的欠松弛因子 $\\alpha_u = 0.7$ 计算的：\n$$ a_P^u = \\frac{a_P}{\\alpha_u} = \\frac{200}{0.7}\\,\\mathrm{kg/s} $$\n我们现在拥有计算 $u_f$ 所需的所有分量：\n- $u_P^* = 0.08\\,\\mathrm{m/s}$，$u_E^* = 0.04\\,\\mathrm{m/s}$\n- $p_P = 101325\\,\\mathrm{Pa}$，$p_E = 101305\\,\\mathrm{Pa}$\n- $A = 1\\,\\mathrm{m}^2$\n\n首先，计算插值伪速度：\n$$ \\overline{u_f^*} = \\frac{0.08 + 0.04}{2} = 0.06\\,\\mathrm{m/s} $$\n接下来，计算压力差：\n$$ p_E - p_P = 101305 - 101325 = -20\\,\\mathrm{Pa} $$\n现在将这些值代入 $u_f$ 的表达式：\n$$ u_f = 0.06 - \\frac{1}{200/0.7} (-20) = 0.06 - \\frac{0.7}{200}(-20) = 0.06 + 0.07 = 0.13\\,\\mathrm{m/s} $$\n最后，计算面质量通量 $\\phi_f$：\n$$ \\phi_f = \\rho u_f A = (1.0\\,\\mathrm{kg/m^3})(0.13\\,\\mathrm{m/s})(1\\,\\mathrm{m}^2) = 0.13\\,\\mathrm{kg/s} $$\n问题要求将答案四舍五入到四位有效数字。\n$$ \\phi_f = 0.1300\\,\\mathrm{kg/s} $$",
            "answer": "$$\n\\boxed{0.1300}\n$$"
        },
        {
            "introduction": "一个数值格式的实用性最终取决于其稳定性。本练习将带您进行一次冯·诺依曼（von Neumann）稳定性分析，以推导半隐式投影方法的 Courant–Friedrichs–Lewy (CFL) 条件 ()。通过这个过程，您将深入理解对流项和扩散项的不同离散化选择如何共同决定数值模拟所允许的最大时间步长，并体会到投影步本身在能量上的非扩张特性。",
            "id": "3986508",
            "problem": "考虑一个具有均匀笛卡尔网格间距 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 的周期性矩形箱体中的不可压缩纳维-斯托克斯方程：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u} = -\\nabla p + \\nu \\nabla^{2}\\boldsymbol{u}, \\qquad \\nabla \\cdot \\boldsymbol{u} = 0,\n$$\n其中 $\\boldsymbol{u}(\\boldsymbol{x},t)$ 是速度场，$p(\\boldsymbol{x},t)$ 是运动压力，$\\nu$ 是运动粘度。在交错的标记-单元 (Marker-and-Cell, MAC) 网格上，使用一种半隐式投影法，其中对流项采用显式处理，扩散项采用隐式处理。对流项使用一阶迎风有限体积通量和时间上的前向欧拉法进行离散，扩散项使用二阶中心拉普拉斯算子和时间上的后向欧拉法进行离散，压力修正步通过求解压力增量的泊松方程来强制执行无散度约束。从 $t^n$到 $t^{n+1} = t^n + \\Delta t$ 的完整时间步长为\n$$\n\\text{(中间速度):}\\quad (I - \\nu \\Delta t\\, L)\\,\\boldsymbol{u}^{*} = \\boldsymbol{u}^{n} - \\Delta t\\,\\mathcal{A}(\\boldsymbol{u}^{n}),\n$$\n$$\n\\text{(投影):}\\quad \\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\Delta t\\,\\nabla \\phi^{n+1}, \\qquad \\nabla\\cdot \\boldsymbol{u}^{n+1} = 0,\n$$\n边界条件为周期性，其中 $L$ 是离散拉普拉斯算子，$\\mathcal{A}$ 是离散平流算子。假设一个恒定的冻结对流速度 $\\boldsymbol{U} = (U,V,W)$ 出现在 $\\mathcal{A}$ 中，因此 $\\mathcal{A}$ 是 $\\boldsymbol{U}\\cdot\\nabla$ 的离散迎风近似，并逐分量地应用于 $\\boldsymbol{u}^{n}$。压力修正步通过求解 $\\phi^{n+1}$ 的离散泊松方程来执行，以使更新后的速度是无散度的。\n\n从常系数线性化平流-扩散形式的基本基础以及在周期性边界条件下对无散度子空间进行 $L^{2}$-正交投影的性质出发，对该投影法进行 von Neumann (傅里叶) 稳定性分析。推导出一个关于 $|U|$、 $|V|$、 $|W|$、 $\\Delta x$、 $\\Delta y$ 和 $\\Delta z$ 的时间步长 $\\Delta t$ 的 Courant–Friedrichs–Lewy (CFL) 稳定性界限，该界限保证对于所有傅里叶模式，在一个完整的时间步长内离散动能不增加。\n\n将您的最终结果表示为最大允许 $\\Delta t$ 关于 $|U|$、 $|V|$、 $|W|$、 $\\Delta x$、 $\\Delta y$ 和 $\\Delta z$ 的单一闭式解析表达式。无需进行数值评估，最终表达式中也不应包含任何单位。在推导过程中必须明确使用压力修正法和周期性设置，以论证投影和隐式扩散在稳定性界限中的作用。",
            "solution": "该问题要求对特定离散化选择下的不可压缩纳维-斯托克斯方程的半隐式投影法进行 von Neumann 稳定性分析。目标是推导时间步长 $\\Delta t$ 的 Courant–Friedrichs–Lewy (CFL) 稳定性界限。\n\n分析将在傅里叶空间中进行。离散网格上的一个通用速度分量 $u(\\boldsymbol{x}_j, t_n)$ 可以表示为傅里叶模式的叠加。我们分析单一模式 $\\hat{\\boldsymbol{u}}^n(\\boldsymbol{k}) \\exp(i \\boldsymbol{k} \\cdot \\boldsymbol{x}_j)$，其中 $\\hat{\\boldsymbol{u}}^n(\\boldsymbol{k})$ 是在时间步 $n$ 时速度向量对应于波向量 $\\boldsymbol{k} = (k_x, k_y, k_z)$ 的复傅里叶振幅，$i=\\sqrt{-1}$。稳定性条件要求，对于所有可能的波向量 $\\boldsymbol{k}$，连接第 $n+1$ 步与第 $n$ 步的傅里叶振幅范数的放大因子必须不大于1。这确保了任何模式的离散动能都不会随时间增长。\n\n时间步进格式分两个阶段给出：一个中间速度计算和一个投影步。\n\n1.  **中间速度步：**\n    中间速度 $\\boldsymbol{u}^*$ 的方程为：\n    $$\n    (I - \\nu \\Delta t\\, L)\\,\\boldsymbol{u}^{*} = \\boldsymbol{u}^{n} - \\Delta t\\,\\mathcal{A}(\\boldsymbol{u}^{n})\n    $$\n    其中 $I$ 是单位算子，$L$ 是离散拉普拉斯算子，$\\mathcal{A}$ 是用于冻结速度场 $\\boldsymbol{U}=(U,V,W)$ 的离散平流算子。我们将此方程转换到傅里叶空间。\n    \n    离散拉普拉斯算子 $L$ 是一个二阶中心差分算子。其傅里叶符号 $\\hat{L}(\\boldsymbol{k})$ 为：\n    $$\n    \\hat{L}(\\boldsymbol{k}) = \\frac{2\\cos(k_x \\Delta x) - 2}{\\Delta x^2} + \\frac{2\\cos(k_y \\Delta y) - 2}{\\Delta y^2} + \\frac{2\\cos(k_z \\Delta z) - 2}{\\Delta z^2}\n    $$\n    使用恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$，我们可以写成：\n    $$\n    \\hat{L}(\\boldsymbol{k}) = -4 \\left( \\frac{\\sin^2(k_x\\Delta x/2)}{\\Delta x^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{\\Delta y^2} + \\frac{\\sin^2(k_z\\Delta z/2)}{\\Delta z^2} \\right) \\equiv -\\lambda_k\n    $$\n    其中对于所有 $\\boldsymbol{k}$，$\\lambda_k$ 是一个实数、非负量。\n\n    平流算子 $\\mathcal{A}$ 是 $\\boldsymbol{U}\\cdot\\nabla$ 的一阶迎风近似。在三维中，这是 $\\mathcal{A}_x + \\mathcal{A}_y + \\mathcal{A}_z$，其中每个分量算子作用于速度分量。对于标量场 $q$ 和正速度分量 $U > 0$，x-方向的迎风差分为 $U(q_j-q_{j-1})/\\Delta x$。对于 $U < 0$，它是 $U(q_{j+1}-q_j)/\\Delta x$。傅里叶符号 $\\hat{\\mathcal{A}}(\\boldsymbol{k})$ 是每个方向的符号之和：\n    $$\n    \\hat{\\mathcal{A}}(\\boldsymbol{k}) = \\sum_{\\alpha \\in \\{x,y,z\\}} \\left( \\frac{U_\\alpha^+}{\\Delta x_\\alpha}(1 - e^{-ik_\\alpha \\Delta x_\\alpha}) + \\frac{U_\\alpha^-}{\\Delta x_\\alpha}(e^{ik_\\alpha \\Delta x_\\alpha} - 1) \\right)\n    $$\n    其中 $U_\\alpha$ 对应于 $U, V, W$，$\\Delta x_\\alpha$ 对应于 $\\Delta x, \\Delta y, \\Delta z$。$U_\\alpha^+ = \\max(U_\\alpha, 0)$ 且 $U_\\alpha^- = \\min(U_a, 0)$。\n\n    在傅里叶空间中，中间速度步变为：\n    $$\n    (1 - \\nu \\Delta t \\hat{L}(\\boldsymbol{k})) \\hat{\\boldsymbol{u}}^*(\\boldsymbol{k}) = (1 - \\Delta t \\hat{\\mathcal{A}}(\\boldsymbol{k})) \\hat{\\boldsymbol{u}}^n(\\boldsymbol{k})\n    $$\n    解出 $\\hat{\\boldsymbol{u}}^*(\\boldsymbol{k})$：\n    $$\n    \\hat{\\boldsymbol{u}}^*(\\boldsymbol{k}) = \\frac{1 - \\Delta t \\hat{\\mathcal{A}}(\\boldsymbol{k})}{1 - \\nu \\Delta t \\hat{L}(\\boldsymbol{k})} \\hat{\\boldsymbol{u}}^n(\\boldsymbol{k}) = \\frac{1 - \\Delta t \\hat{\\mathcal{A}}(\\boldsymbol{k})}{1 + \\nu \\Delta t \\lambda_k} \\hat{\\boldsymbol{u}}^n(\\boldsymbol{k})\n    $$\n    项 $G_{intermediate}(\\boldsymbol{k}) = \\frac{1 - \\Delta t \\hat{\\mathcal{A}}(\\boldsymbol{k})}{1 + \\nu \\Delta t \\lambda_k}$ 是中间步骤的标量放大因子。\n\n2.  **投影步：**\n    投影步更新速度以强制执行无散度条件：\n    $$\n    \\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\Delta t\\,\\nabla \\phi^{n+1}, \\qquad \\nabla\\cdot \\boldsymbol{u}^{n+1} = 0\n    $$\n    该操作对应于将投影算子 $\\mathbb{P}$ 应用于中间速度场，$\\boldsymbol{u}^{n+1} = \\mathbb{P}(\\boldsymbol{u}^*)$。问题指定了周期性边界条件。在这种情况下，算子 $\\mathbb{P}$ 是到无散度向量场子空间的 $L^2$-正交投影。正交投影的一个关键性质是它是非扩张的，意味着对于任何向量场 $\\boldsymbol{v}$，都有 $||\\mathbb{P}(\\boldsymbol{v})||_2 \\le ||\\boldsymbol{v}||_2$。\n    \n    在傅里叶空间中，这转化为 $||\\hat{\\boldsymbol{u}}^{n+1}(\\boldsymbol{k})|| \\le ||\\hat{\\boldsymbol{u}}^*(\\boldsymbol{k})||$。投影算子 $\\hat{\\mathbb{P}}(\\boldsymbol{k})$ 的傅里叶表示是一个将向量投影到与波向量 $\\boldsymbol{k}$ 正交的平面上的矩阵。其算子范数为 $1$。从 $\\hat{\\boldsymbol{u}}^n$ 到 $\\hat{\\boldsymbol{u}}^{n+1}$ 的完全放大为：\n    $$\n    \\hat{\\boldsymbol{u}}^{n+1}(\\boldsymbol{k}) = \\hat{\\mathbb{P}}(\\boldsymbol{k}) \\left( G_{intermediate}(\\boldsymbol{k}) \\hat{\\boldsymbol{u}}^n(\\boldsymbol{k}) \\right)\n    $$\n    取范数并应用算子范数的性质：\n    $$\n    ||\\hat{\\boldsymbol{u}}^{n+1}(\\boldsymbol{k})|| \\le ||\\hat{\\mathbb{P}}(\\boldsymbol{k})||_{op} |G_{intermediate}(\\boldsymbol{k})| ||\\hat{\\boldsymbol{u}}^n(\\boldsymbol{k})|| = |G_{intermediate}(\\boldsymbol{k})| ||\\hat{\\boldsymbol{u}}^n(\\boldsymbol{k})||\n    $$\n    因此，整个格式的稳定性由中间步骤的标量放大因子的模小于或等于1的条件决定：\n    $$\n    |G_{intermediate}(\\boldsymbol{k})| = \\left| \\frac{1 - \\Delta t \\hat{\\mathcal{A}}(\\boldsymbol{k})}{1 + \\nu \\Delta t \\lambda_k} \\right| \\le 1\n    $$\n\n3.  **稳定性分析：**\n    由于 $\\nu \\ge 0$, $\\Delta t > 0$, 且 $\\lambda_k \\ge 0$，分母 $1 + \\nu \\Delta t \\lambda_k$ 总是大于或等于 $1$。因此，稳定性条件简化为：\n    $$\n    |1 - \\Delta t \\hat{\\mathcal{A}}(\\boldsymbol{k})| \\le |1 + \\nu \\Delta t \\lambda_k|\n    $$\n    由于右侧总是 $\\ge 1$，一个更严格但充分的稳定性条件是 $|1 - \\Delta t \\hat{\\mathcal{A}}(\\boldsymbol{k})| \\le 1$。这意味着稳定性极限完全由显式对流项决定。扩散项的隐式处理是无条件稳定的，而投影步是非扩张的，因此它们都不对 $\\Delta t$ 施加限制。我们必须分析显式一阶迎风格式的稳定性。\n\n    令 $G_{adv}(\\boldsymbol{k}) = 1 - \\Delta t \\hat{\\mathcal{A}}(\\boldsymbol{k})$。我们要求对于所有 $\\boldsymbol{k}$，都有 $|G_{adv}(\\boldsymbol{k})| \\le 1$。\n    令 $c_\\alpha = U_\\alpha \\Delta t / \\Delta x_\\alpha$ 为方向 $\\alpha \\in \\{x,y,z\\}$ 的库朗数。\n    则 $\\Delta t \\hat{\\mathcal{A}}(\\boldsymbol{k}) = \\sum_{\\alpha} \\left( c_\\alpha^+(1 - e^{-ik_\\alpha \\Delta x_\\alpha}) + c_\\alpha^-(e^{ik_\\alpha \\Delta x_\\alpha} - 1) \\right)$。\n    令 $C = \\sum_{\\alpha} |c_\\alpha| = \\Delta t \\left( \\frac{|U|}{\\Delta x} + \\frac{|V|}{\\Delta y} + \\frac{|W|}{\\Delta z} \\right)$。\n    可以证明，$G_{adv}$ 位于复平面上以点 $(1-C, 0)$ 为中心、半径为 $C$ 的圆盘内。为了使这个圆盘完全包含在以原点为中心的单位圆盘（即稳定性区域 $|G_{adv}| \\le 1$）内，其边界必须在单位圆内或上。圆盘上离原点最远的点是 $(1-C) + C = 1$，它在单位圆上。离原点最近的点是 $(1-C) - C = 1 - 2C$。这个点必须大于或等于 $-1$：\n    $$\n    1 - 2C \\ge -1 \\implies 2 \\ge 2C \\implies C \\le 1\n    $$\n    这个条件是充分且必要的。\n    \n4.  **最终结果：**\n    稳定性条件是 $C \\le 1$：\n    $$\n    \\Delta t \\left( \\frac{|U|}{\\Delta x} + \\frac{|V|}{\\Delta y} + \\frac{|W|}{\\Delta z} \\right) \\le 1\n    $$\n    问题要求最大的允许时间步长 $\\Delta t$，这在等式成立时获得：\n    $$\n    \\Delta t = \\frac{1}{\\frac{|U|}{\\Delta x} + \\frac{|V|}{\\Delta y} + \\frac{|W|}{\\Delta z}}\n    $$\n    这是三维中平流项的显式一阶迎风离散化的 CFL 稳定性极限。隐式扩散和投影步没有引入更严格的约束。",
            "answer": "$$\\boxed{\\frac{1}{\\frac{|U|}{\\Delta x} + \\frac{|V|}{\\Delta y} + \\frac{|W|}{\\Delta z}}}$$"
        }
    ]
}