{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学中，一个基本的挑战是如何施加积分边界条件。在许多实际模拟中，例如内燃机或管道流，通常会指定入口的总质量或体积流量，而不是详细的速度分布。本练习将指导您使用一种常用技术来修正预测的速度场，以确保跨边界的总通量与指定的全局值精确匹配，这是维持质量守恒的关键一步 。",
            "id": "3984960",
            "problem": "考虑一个使用算子分裂压力隐式 (PISO) 算法推进的瞬态不可压缩流。当入口边界条件指定的是总体积流量而非点态速度分布时，动量预测步产生的面法向速度通常不满足积分入口条件。设流体密度恒定，并考虑一个被网格划分为 $4$ 个平面网格面的单一入口边界，其向外的面积矢量与几何法线对齐。入口网格面的面积分别为 $A_{1}=0.015\\,\\mathrm{m}^{2}$、$A_{2}=0.020\\,\\mathrm{m}^{2}$、$A_{3}=0.020\\,\\mathrm{m}^{2}$ 和 $A_{4}=0.015\\,\\mathrm{m}^{2}$。在 $t^{n+1}$ 时刻，动量预测步之后，预测的流入计算域的面法向速度为 $u_{1}^{\\ast}=12.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$、$u_{2}^{\\ast}=9.8\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$、$u_{3}^{\\ast}=7.2\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ 和 $u_{4}^{\\ast}=10.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。指定的入口体积流量为 $Q_{\\mathrm{in}}=0.700\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$，定义为法向速度在入口上的积分。\n\n假设，在 PISO 算法的一个压力修正步对内部控制体强制执行离散连续性之后，通过以保形方式仅修正入口面法向速度来解决剩余的边界不一致性：修正后的入口速度被约束为与预测剖面成正比，即 $u_{i}^{\\mathrm{corr}}=\\beta\\,u_{i}^{\\ast}$，其中单个标量 $\\beta$ 统一应用于所有入口面。使用基本质量守恒定律，确定标量 $\\beta$ 的值，该值能在 $t^{n+1}$ 时刻精确地强制执行指定的入口体积流量。\n\n报告无量纲缩放因子 $\\beta$ 的值，四舍五入至五位有效数字。最终的方框答案中不要包含单位。",
            "solution": "用户希望我通过首先验证所提供问题的前提，然后在前提有效的情况下，提供详细的解答。\n\n### 步骤 1：提取已知条件\n- **流动类型**：瞬态，不可压缩。\n- **算法**：PISO (算子分裂压力隐式)。\n- **流体性质**：恒定密度。\n- **入口面**：$4$ 个平面网格面。\n- **网格面面积**：$A_{1}=0.015\\,\\mathrm{m}^{2}$、$A_{2}=0.020\\,\\mathrm{m}^{2}$、$A_{3}=0.020\\,\\mathrm{m}^{2}$、$A_{4}=0.015\\,\\mathrm{m}^{2}$。\n- **预测的面法向速度（进入计算域）**：$u_{1}^{\\ast}=12.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$、$u_{2}^{\\ast}=9.8\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$、$u_{3}^{\\ast}=7.2\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$、$u_{4}^{\\ast}=10.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- **指定的入口体积流量**：$Q_{\\mathrm{in}}=0.700\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$。\n- **修正约束**：修正后的面法向速度为 $u_{i}^{\\mathrm{corr}}=\\beta\\,u_{i}^{\\ast}$，其中 $\\beta$ 是一个统一的标量。\n- **目标**：确定标量 $\\beta$ 的值。\n- **报告要求**：报告 $\\beta$ 的值，四舍五入至五位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它描述了一种在基于压力修正的 CFD 算法（如 PISO）中强制执行固定通量边界条件的标准实用方法。通过缩放局部通量来强制执行全局质量守恒是一种常用技术。该问题是适定的；它提供了所有必要的数据和明确的约束，从而可以得到未知数 $\\beta$ 的唯一解。语言客观，并采用了计算流体动力学领域的标准术语。物理和数值是切合实际的。该问题不违反任何无效性标准。\n\n### 步骤 3：结论与行动\n问题有效。将提供解答。\n\n需要应用的基本原理是质量守恒，以体积流量的形式表示。通过由一组离散网格面组成的边界的总流量 $Q$ 是通过每个单独网格面的流量之和。通过单个网格面 $i$ 的流量是该网格面面积 $A_i$ 与垂直于该面的速度分量 $u_i$ 的乘积。根据本问题的约定，指向计算域内部的速度为正，因此总入口流量由下式给出：\n$$Q = \\sum_{i} u_{i} A_{i}$$\n首先，我们根据预测的面法向速度 $u_{i}^{\\ast}$ 计算总体积流量。记为 $Q^{\\ast}$。入口边界由 $4$ 个网格面组成，因此求和范围为 $i=1$ 到 $4$：\n$$Q^{\\ast} = \\sum_{i=1}^{4} u_{i}^{\\ast} A_{i} = u_{1}^{\\ast}A_{1} + u_{2}^{\\ast}A_{2} + u_{3}^{\\ast}A_{3} + u_{4}^{\\ast}A_{4}$$\n代入给定值：\n- 对于面 1：$u_{1}^{\\ast}A_{1} = (12.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (0.015\\,\\mathrm{m}^{2}) = 0.1875\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$\n- 对于面 2：$u_{2}^{\\ast}A_{2} = (9.8\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (0.020\\,\\mathrm{m}^{2}) = 0.1960\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$\n- 对于面 3：$u_{3}^{\\ast}A_{3} = (7.2\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (0.020\\,\\mathrm{m}^{2}) = 0.1440\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$\n- 对于面 4：$u_{4}^{\\ast}A_{4} = (10.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (0.015\\,\\mathrm{m}^{2}) = 0.1575\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$\n\n将这些单独的流量相加，得到总预测流量 $Q^{\\ast}$：\n$$Q^{\\ast} = 0.1875 + 0.1960 + 0.1440 + 0.1575 = 0.6850\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$$\n这个预测流量与指定的入口流量 $Q_{\\mathrm{in}}=0.700\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$ 不匹配。为了强制执行指定的流量，必须对速度进行修正。问题指定了一种形式为 $u_{i}^{\\mathrm{corr}}=\\beta\\,u_{i}^{\\ast}$ 的保形修正，其中 $\\beta$ 是一个应用于所有入口面的单一缩放因子。\n\n修正后的体积流量 $Q_{\\mathrm{corr}}$ 必须等于指定的入口流量 $Q_{\\mathrm{in}}$。我们可以用修正后的速度来表示 $Q_{\\mathrm{corr}}$：\n$$Q_{\\mathrm{corr}} = \\sum_{i=1}^{4} u_{i}^{\\mathrm{corr}} A_{i}$$\n将修正关系 $u_{i}^{\\mathrm{corr}}=\\beta\\,u_{i}^{\\ast}$ 代入此方程：\n$$Q_{\\mathrm{corr}} = \\sum_{i=1}^{4} (\\beta u_{i}^{\\ast}) A_{i}$$\n由于 $\\beta$ 是一个常数标量，可以将其从求和中提出：\n$$Q_{\\mathrm{corr}} = \\beta \\left( \\sum_{i=1}^{4} u_{i}^{\\ast} A_{i} \\right)$$\n括号中的项是预测流量 $Q^{\\ast}$。因此，我们有以下关系：\n$$Q_{\\mathrm{corr}} = \\beta Q^{\\ast}$$\n为满足边界条件，我们必须有 $Q_{\\mathrm{corr}} = Q_{\\mathrm{in}}$。因此：\n$$Q_{\\mathrm{in}} = \\beta Q^{\\ast}$$\n现在我们可以求解缩放因子 $\\beta$：\n$$\\beta = \\frac{Q_{\\mathrm{in}}}{Q^{\\ast}}$$\n代入 $Q_{\\mathrm{in}}$ 的数值和计算出的 $Q^{\\ast}$：\n$$\\beta = \\frac{0.700\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}}{0.685\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}} = \\frac{0.700}{0.685}$$\n进行除法运算得到：\n$$\\beta \\approx 1.0218978102...$$\n问题要求答案四舍五入至五位有效数字。前五位有效数字是 $1$、$0$、$2$、$1$ 和 $8$。第六位有效数字是 $9$。由于 $9 \\ge 5$，我们将第五位有效数字 $8$ 向上取整为 $9$。\n因此，$\\beta$ 的值四舍五入至五位有效数字为 $1.0219$。",
            "answer": "$$\\boxed{1.0219}$$"
        },
        {
            "introduction": "真实的工程几何形状通常需要使用非正交网格，这为梯度项的离散化带来了复杂性。本练习深入探讨了此种网格上有限体积方法的核心，特别是如何在单元面上精确计算压力梯度。您将应用非正交修正，将梯度计算分解为正交和非正交分量，这对于在扭曲网格上保持PISO模拟的准确性和稳定性至关重要 。",
            "id": "3984994",
            "problem": "考虑一个在计算流体动力学 (CFD) 中使用算子分裂压力隐式 (PISO) 算法求解的二维不可压缩瞬态流。关注扭曲四边形网格中两个相邻控制体积（单元 $P$ 和单元 $N$）共享的一个内表面。单元中心分别位于 $\\boldsymbol{x}_{P} = (0, 0)\\,\\text{m}$ 和 $\\boldsymbol{x}_{N} = (1.0, 0.2)\\,\\text{m}$。共享面的端点位于 $(0.5, -0.3)\\,\\text{m}$ 和 $(0.5, 0.5)\\,\\text{m}$，因此其长度为 $0.8\\,\\text{m}$，从单元 $P$ 指出的外向面积矢量为 $\\boldsymbol{S}_{f} = (0.8, 0)\\,\\text{m}^{2}$。令 $\\boldsymbol{n}_{f} = \\boldsymbol{S}_{f} / \\|\\boldsymbol{S}_{f}\\| = (1, 0)$ 表示面上的单位法向量，从单元 $P$ 指向单元 $N$。连接单元中心的矢量为 $\\boldsymbol{d} = \\boldsymbol{x}_{N} - \\boldsymbol{x}_{P}$。\n\n假设在当前的 PISO 迭代中，场值如下：\n- 恒定密度 $\\rho = 1.2\\,\\text{kg}\\,\\text{m}^{-3}$。\n- 时间步长 $\\Delta t = 1.0 \\times 10^{-3}\\,\\text{s}$。\n- 单元压力 $p_{P} = 102000\\,\\text{Pa}$ 和 $p_{N} = 101000\\,\\text{Pa}$。\n- 预测速度（动量预测步）$\\boldsymbol{u}^{*}_{P} = (2.0, 0.0)\\,\\text{m}\\,\\text{s}^{-1}$ 和 $\\boldsymbol{u}^{*}_{N} = (1.5, 0.2)\\,\\text{m}\\,\\text{s}^{-1}$。\n- 通过最小二乘法重构的单元压力梯度 $\\left(\\nabla p\\right)_{P} = (-900,\\, 200)\\,\\text{Pa}\\,\\text{m}^{-1}$ 和 $\\left(\\nabla p\\right)_{N} = (-1100,\\, 300)\\,\\text{Pa}\\,\\text{m}^{-1}$。\n\n从连续性方程和动量方程的积分形式出发，并引用 Gauss 定理（散度定理），通过分解为垂直于 $\\boldsymbol{d}$ 和平行于 $\\boldsymbol{d}$ 的方向，构建面法向压力梯度的非正交修正近似。具体来说，将 $\\nabla p$ 的面法向投影分解为一个正交部分和一个非正交修正部分。正交部分与沿 $\\boldsymbol{d}$ 的中心到中心差值 $p_{N} - p_{P}$ 相关，非正交修正部分基于插值到面上的重构梯度。对面中心的预测速度和重构压力梯度均使用线性插值。\n\n然后，使用应用于控制体积的 Newton 第二定律推导出的预测-校正形式，估算面速度为 $\\boldsymbol{u}_{f} = \\boldsymbol{u}^{*}_{f} - \\frac{\\Delta t}{\\rho}\\left(\\nabla p\\right)_{f}$，并计算通过该面的相应质量通量 $\\dot{m}_{f} = \\rho\\,\\boldsymbol{u}_{f} \\cdot \\boldsymbol{S}_{f}$。\n\n将面质量通量的最终数值答案四舍五入到四位有效数字。以 $\\text{kg}\\,\\text{s}^{-1}$ 为单位表示最终的质量通量。",
            "solution": "目标是计算一个经过非正交修正的面法向压力梯度，然后将其用于算子分裂压力隐式 (PISO) 算法中的面速度计算，以获得质量通量。我们从有限体积法的基础出发，使用 Gauss 定理和矢量分解。\n\n首先，建立几何关系。中心到中心的矢量及其模和单位矢量为\n$$\n\\boldsymbol{d} = \\boldsymbol{x}_{N} - \\boldsymbol{x}_{P} = (1.0,\\,0.2), \\quad\n\\|\\boldsymbol{d}\\| = \\sqrt{(1.0)^{2} + (0.2)^{2}} = \\sqrt{1.04}, \\quad\n\\hat{\\boldsymbol{d}} = \\frac{\\boldsymbol{d}}{\\|\\boldsymbol{d}\\|}.\n$$\n数值上，\n$$\n\\|\\boldsymbol{d}\\| = 1.019803902718557, \\quad\n\\hat{\\boldsymbol{d}} = \\left(0.980580675690920,\\,0.196116135138184\\right).\n$$\n面面积矢量和面单位法向量（从 $P$ 指向 $N$）为\n$$\n\\boldsymbol{S}_{f} = (0.8,\\,0), \\quad \\boldsymbol{n}_{f} = (1,\\,0).\n$$\n\n为了构建面上的非正交压力梯度，我们使用面法向投影的分解。对于任意矢量 $\\boldsymbol{a}$，\n$$\n\\boldsymbol{a}\\cdot \\boldsymbol{n}_{f} = (\\boldsymbol{a}\\cdot \\hat{\\boldsymbol{d}})\\,(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f}) + \\boldsymbol{a}\\cdot\\left(\\boldsymbol{n}_{f} - \\hat{\\boldsymbol{d}}(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f})\\right).\n$$\n将此应用于 $\\boldsymbol{a} = \\left(\\nabla p\\right)_{f}$，并用有限体积近似代替中心到中心方向导数，\n$$\n\\left(\\nabla p\\right)_{f}\\cdot \\hat{\\boldsymbol{d}} \\approx \\frac{p_{N} - p_{P}}{\\|\\boldsymbol{d}\\|},\n$$\n我们得到非正交修正的面法向压力梯度为\n$$\n\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{n}_{f} \\approx \\frac{p_{N} - p_{P}}{\\|\\boldsymbol{d}\\|}\\,(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f})\n+ \\left(\\nabla p\\right)_{f}\\cdot\\left(\\boldsymbol{n}_{f} - \\hat{\\boldsymbol{d}}(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f})\\right).\n$$\n我们通过对重构梯度进行线性插值来得到 $\\left(\\nabla p\\right)_{f}$：\n$$\n\\left(\\nabla p\\right)_{f} = \\frac{\\left(\\nabla p\\right)_{P} + \\left(\\nabla p\\right)_{N}}{2} = \\frac{(-900,\\,200) + (-1100,\\,300)}{2} = (-1000,\\,250)\\,\\text{Pa}\\,\\text{m}^{-1}.\n$$\n计算所需的几何标量和矢量：\n$$\n\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f} = 0.980580675690920,\n$$\n$$\n\\hat{\\boldsymbol{d}}(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f}) = \\left(0.980580675690920,\\,0.196116135138184\\right)\\,(0.980580675690920)\n= \\left(0.961538461538462,\\,0.192307692307692\\right),\n$$\n$$\n\\boldsymbol{n}_{f} - \\hat{\\boldsymbol{d}}(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f}) = \\left(1,\\,0\\right) - \\left(0.961538461538462,\\,0.192307692307692\\right)\n= \\left(0.038461538461538,\\,-0.192307692307692\\right).\n$$\n现在评估正交和非正交贡献。正交部分是\n$$\n\\frac{p_{N} - p_{P}}{\\|\\boldsymbol{d}\\|}\\,(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f})\n= \\frac{101000 - 102000}{1.019803902718557}\\,(0.980580675690920)\n= (-980.580675690920)\\,(0.980580675690920)\n= -961.538461538462\\,\\text{Pa}\\,\\text{m}^{-1}.\n$$\n非正交修正是\n$$\n\\left(\\nabla p\\right)_{f}\\cdot\\left(\\boldsymbol{n}_{f} - \\hat{\\boldsymbol{d}}(\\hat{\\boldsymbol{d}}\\cdot \\boldsymbol{n}_{f})\\right)\n= (-1000,\\,250)\\cdot\\left(0.038461538461538,\\,-0.192307692307692\\right)\n= -38.461538461538 - 48.076923076923\n= -86.538461538462\\,\\text{Pa}\\,\\text{m}^{-1}.\n$$\n因此，修正后的面法向压力梯度为\n$$\n\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{n}_{f} \\approx -961.538461538462 - 86.538461538462\n= -1048.07692307692\\,\\text{Pa}\\,\\text{m}^{-1}.\n$$\n其与面面积矢量的缩并为\n$$\n\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{S}_{f}\n= \\|\\boldsymbol{S}_{f}\\|\\,\\left[\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{n}_{f}\\right]\n= 0.8\\,(-1048.07692307692)\n= -838.461538461538\\,\\text{Pa}.\n$$\n\n接下来，计算 PISO 中使用的面速度。根据对控制体积积分 Newton 第二定律得到的动量预测-校正公式，我们采用\n$$\n\\boldsymbol{u}_{f} = \\boldsymbol{u}^{*}_{f} - \\frac{\\Delta t}{\\rho}\\left(\\nabla p\\right)_{f}.\n$$\n将预测速度插值到面上（线性插值）：\n$$\n\\boldsymbol{u}^{*}_{f} = \\frac{\\boldsymbol{u}^{*}_{P} + \\boldsymbol{u}^{*}_{N}}{2}\n= \\frac{(2.0,\\,0.0) + (1.5,\\,0.2)}{2}\n= (1.75,\\,0.1)\\,\\text{m}\\,\\text{s}^{-1}.\n$$\n通过该面的质量通量是\n$$\n\\dot{m}_{f} = \\rho\\,\\boldsymbol{u}_{f}\\cdot \\boldsymbol{S}_{f}\n= \\rho\\,\\boldsymbol{u}^{*}_{f}\\cdot \\boldsymbol{S}_{f} - \\Delta t\\,\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{S}_{f}.\n$$\n评估这两个贡献：\n$$\n\\rho\\,\\boldsymbol{u}^{*}_{f}\\cdot \\boldsymbol{S}_{f}\n= 1.2\\,\\left[(1.75,\\,0.1)\\cdot(0.8,\\,0)\\right]\n= 1.2\\,(1.4)\n= 1.68\\,\\text{kg}\\,\\text{s}^{-1},\n$$\n$$\n-\\Delta t\\,\\left(\\nabla p\\right)_{f}\\cdot \\boldsymbol{S}_{f}\n= -\\left(1.0\\times 10^{-3}\\right)\\,(-838.461538461538)\n= +0.838461538461538\\,\\text{kg}\\,\\text{s}^{-1}.\n$$\n因此，\n$$\n\\dot{m}_{f} = 1.68 + 0.838461538461538 = 2.51846153846154\\,\\text{kg}\\,\\text{s}^{-1}.\n$$\n四舍五入到四位有效数字并以 $\\text{kg}\\,\\text{s}^{-1}$ 为单位表示，质量通量为 $2.518\\,\\text{kg}\\,\\text{s}^{-1}$。",
            "answer": "$$\\boxed{2.518}$$"
        },
        {
            "introduction": "在瞬态CFD模拟中，计算效率至关重要，而PISO算法在时间步长和压力修正步数之间提供了一个关键的权衡。本练习通过定量分析来探讨这种关键的性能动态。通过使用一个模拟PISO收敛行为的实际数值模型，您将确定不同时间步长下的最佳修正次数，并分析其对总计算成本的影响，这是设计高效模拟策略的一项至关重要的技能 。",
            "id": "3984973",
            "problem": "考虑一个围绕翼型的不可压缩瞬态外流，该流场在同位非结构化网格上进行离散，并使用算子分裂压力隐式 (PISO) 算法进行时间推进。其控制方程为不可压缩Navier–Stokes方程，\n$$\n\\rho \\,\\frac{\\partial \\mathbf{u}}{\\partial t} + \\rho\\,(\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\mu \\,\\nabla^2 \\mathbf{u},\n\\qquad\n\\nabla\\cdot \\mathbf{u} = 0,\n$$\n其中 $\\rho$ 为密度，$\\mu$ 为动力粘度。在每个大小为 $\\Delta t$ 的时间步中，PISO 执行一次动量预测，然后进行一系列压力修正，以强制满足离散连续性约束。求解器在压力修正循环开始时以及每次修正后，都会监测全局连续性残差范数，记为 $\\|\\mathbf{r}_c\\|$。\n\n在该网格上，使用选定的线性求解器容差和压力欠松弛，先前的验证运行显示出以下行为：\n\n- 修正循环开始时的初始连续性残差随时间步长缩放，关系为 $\\|\\mathbf{r}_c^{(0)}\\| \\approx C\\,\\Delta t$，其中 $C = 0.2\\,\\mathrm{s}^{-1}$。\n- 每次压力修正扫描将连续性残差降低一个经验测量的因子 $q(\\Delta t) = q_0 + \\beta\\,\\Delta t$，其中 $q_0 = 0.25$ 且 $\\beta = 600\\,\\mathrm{s}^{-1}$，这反映了在此工作点由压力修正耦合和欠松弛决定的有效收缩率。\n\n连续性残差的目标容差为 $\\varepsilon = 10^{-6}$（无量纲范数）。通过确定两个候选时间步长（$\\Delta t = 10^{-4}\\,\\mathrm{s}$ 和 $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$）下，为达到 $\\|\\mathbf{r}_c^{(M)}\\| \\le \\varepsilon$ 所需的最小整数压力修正次数 $M$，来量化 $\\Delta t$ 与 $M$ 之间的权衡。然后，对于每个 $\\Delta t$，假设每个时间步长有一次动量预测和 $M$ 次修正，计算每单位物理时间（每秒）所需的总压力修正扫描次数，由 $M / \\Delta t$ 给出。\n\n选择正确报告了两个 $\\Delta t$ 值的 $M$ 以及相应的每物理秒总压力修正扫描次数的选项。\n\nA. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ 需要 $M = 3$，$\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ 需要 $M = 8$；每物理秒的总压力修正扫描次数分别为 $3\\times 10^{4}$ 和 $1.6\\times 10^{4}$。\n\nB. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ 需要 $M = 2$，$\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ 需要 $M = 6$；每物理秒的总压力修正扫描次数分别为 $2\\times 10^{4}$ 和 $1.2\\times 10^{4}$。\n\nC. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ 需要 $M = 3$，$\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ 需要 $M = 6$；每物理秒的总压力修正扫描次数分别为 $3\\times 10^{4}$ 和 $1.2\\times 10^{4}$。\n\nD. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ 需要 $M = 4$，$\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ 需要 $M = 9$；每物理秒的总压力修正扫描次数分别为 $4\\times 10^{4}$ 和 $1.8\\times 10^{4}$。",
            "solution": "在进行求解之前，对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 控制方程：不可压缩Navier–Stokes方程：\n$$\n\\rho \\,\\frac{\\partial \\mathbf{u}}{\\partial t} + \\rho\\,(\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\mu \\,\\nabla^2 \\mathbf{u}\n$$\n$$\n\\nabla\\cdot \\mathbf{u} = 0\n$$\n- 算法：算子分裂压力隐式 (PISO)。\n- 一个时间步长的初始连续性残差范数：$\\|\\mathbf{r}_c^{(0)}\\| \\approx C\\,\\Delta t$。\n- 初始残差的常数：$C = 0.2\\,\\mathrm{s}^{-1}$。\n- 每次压力修正扫描的残差缩减因子：$q(\\Delta t) = q_0 + \\beta\\,\\Delta t$。\n- 缩减因子的常数：$q_0 = 0.25$ 和 $\\beta = 600\\,\\mathrm{s}^{-1}$。\n- 连续性残差范数的目标容差：$\\varepsilon = 10^{-6}$。\n- 每个时间步长的压力修正次数：$M$。\n- 需满足的条件：$\\|\\mathbf{r}_c^{(M)}\\| \\le \\varepsilon$。\n- 用于分析的两个候选时间步长：$\\Delta t_1 = 10^{-4}\\,\\mathrm{s}$ 和 $\\Delta t_2 = 5\\times 10^{-4}\\,\\mathrm{s}$。\n- 为进行比较而计算的量：每单位物理时间的总压力修正扫描次数，$M / \\Delta t$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了 PISO 算法的行为，这是一种求解计算流体动力学中不可压缩Navier-Stokes方程的标准方法。初始残差（$ \\|\\mathbf{r}_c^{(0)}\\| \\propto \\Delta t$）和压力修正收敛因子（$q(\\Delta t) = q_0 + \\beta\\,\\Delta t$）的经验模型是对数值行为的合理解释。一阶预测步自然会产生与 $\\Delta t$ 成正比的初始连续性误差。迭代求解器收敛速度随 $\\Delta t$ 增大而恶化（即 $q$ 随 $\\Delta t$ 增大）也是一种常见现象。\n- **适定性**：该问题是适定的。它提供了一个清晰的数学框架和所有必要的参数，可以为每种情况计算出修正次数 $M$ 的唯一整数值。\n- **客观性**：问题以精确、定量的术语陈述，没有歧义或主观内容。\n\n所有其他验证标准均已满足。该问题没有说明中列出的任何缺陷。所提供的常数对于数值模拟是物理上合理的。对于所选的 $\\Delta t$ 值，缩减因子 $q(\\Delta t)$ 保持在1以下，确保了收敛性。\n\n**步骤3：结论与行动**\n问题有效。将推导解答。\n\n**推导**\n\nPISO 算法迭代地减小连续性残差范数。设 $\\|\\mathbf{r}_c^{(k)}\\|$ 为 $k$ 次压力修正扫描后的范数。根据问题陈述，每次扫描残差范数会减小一个因子 $q(\\Delta t)$。\n因此，在 $M$ 次扫描后，残差范数与初始残差范数 $\\|\\mathbf{r}_c^{(0)}\\|$ 的关系为：\n$$\n\\|\\mathbf{r}_c^{(M)}\\| = [q(\\Delta t)]^M \\, \\|\\mathbf{r}_c^{(0)}\\|\n$$\n目标是确定满足容差条件 $\\|\\mathbf{r}_c^{(M)}\\| \\le \\varepsilon$ 所需的最小整数修正次数 $M$。\n代入 $\\|\\mathbf{r}_c^{(0)}\\|$ 和 $q(\\Delta t)$ 的给定模型：\n$$\n[q_0 + \\beta\\,\\Delta t]^M \\, (C\\,\\Delta t) \\le \\varepsilon\n$$\n为了求解 $M$，我们对不等式两边取自然对数：\n$$\n\\ln\\left( [q_0 + \\beta\\,\\Delta t]^M \\, (C\\,\\Delta t) \\right) \\le \\ln(\\varepsilon)\n$$\n$$\nM \\ln(q_0 + \\beta\\,\\Delta t) + \\ln(C\\,\\Delta t) \\le \\ln(\\varepsilon)\n$$\n$$\nM \\ln(q_0 + \\beta\\,\\Delta t) \\le \\ln(\\varepsilon) - \\ln(C\\,\\Delta t) = \\ln\\left(\\frac{\\varepsilon}{C\\,\\Delta t}\\right)\n$$\n由于收敛要求 $q(\\Delta t)  1$，其对数 $\\ln(q_0 + \\beta\\,\\Delta t)$ 为负。两边同除以这个负数会使不等号反向：\n$$\nM \\ge \\frac{\\ln\\left(\\frac{\\varepsilon}{C\\,\\Delta t}\\right)}{\\ln(q_0 + \\beta\\,\\Delta t)}\n$$\n由于 $M$ 必须是整数，我们必须对右侧取上整。\n\n**情况1：$\\Delta t = 10^{-4}\\,\\mathrm{s}$**\n\n首先，计算此时间步长所需的参数：\n- 初始残差：$\\|\\mathbf{r}_c^{(0)}\\|_1 = C\\,\\Delta t_1 = (0.2\\,\\mathrm{s}^{-1}) \\times (10^{-4}\\,\\mathrm{s}) = 2 \\times 10^{-5}$。\n- 缩减因子：$q_1 = q_0 + \\beta\\,\\Delta t_1 = 0.25 + (600\\,\\mathrm{s}^{-1}) \\times (10^{-4}\\,\\mathrm{s}) = 0.25 + 0.06 = 0.31$。\n\n现在，我们计算最小修正次数 $M_1$：\n$$\nM_1 \\ge \\frac{\\ln\\left(\\frac{10^{-6}}{2 \\times 10^{-5}}\\right)}{\\ln(0.31)} = \\frac{\\ln(0.05)}{\\ln(0.31)} \\approx \\frac{-2.9957}{-1.1712} \\approx 2.5578\n$$\n满足此条件的最小整数 $M_1$ 是 $M_1=3$。\n\n每物理秒的总压力修正扫描次数为：\n$$\n\\frac{M_1}{\\Delta t_1} = \\frac{3}{10^{-4}\\,\\mathrm{s}} = 3 \\times 10^4\\,\\mathrm{s}^{-1}\n$$\n\n**情况2：$\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$**\n\n首先，计算此时间步长所需的参数：\n- 初始残差：$\\|\\mathbf{r}_c^{(0)}\\|_2 = C\\,\\Delta t_2 = (0.2\\,\\mathrm{s}^{-1}) \\times (5\\times 10^{-4}\\,\\mathrm{s}) = 1 \\times 10^{-4}$。\n- 缩减因子：$q_2 = q_0 + \\beta\\,\\Delta t_2 = 0.25 + (600\\,\\mathrm{s}^{-1}) \\times (5 \\times 10^{-4}\\,\\mathrm{s}) = 0.25 + 0.30 = 0.55$。\n\n现在，我们计算最小修正次数 $M_2$：\n$$\nM_2 \\ge \\frac{\\ln\\left(\\frac{10^{-6}}{1 \\times 10^{-4}}\\right)}{\\ln(0.55)} = \\frac{\\ln(0.01)}{\\ln(0.55)} \\approx \\frac{-4.6052}{-0.5978} \\approx 7.7036\n$$\n满足此条件的最小整数 $M_2$ 是 $M_2=8$。\n\n每物理秒的总压力修正扫描次数为：\n$$\n\\frac{M_2}{\\Delta t_2} = \\frac{8}{5\\times 10^{-4}\\,\\mathrm{s}} = \\frac{8}{5} \\times 10^4\\,\\mathrm{s}^{-1} = 1.6 \\times 10^4\\,\\mathrm{s}^{-1}\n$$\n\n**结果总结**\n- 对于 $\\Delta t = 10^{-4}\\,\\mathrm{s}$：需要 $M = 3$ 次修正，导致每物理秒 $3 \\times 10^4$ 次扫描。\n- 对于 $\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$：需要 $M = 8$ 次修正，导致每物理秒 $1.6 \\times 10^4$ 次扫描。\n\n**逐项分析选项**\n\nA. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ 需要 $M = 3$，$\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ 需要 $M = 8$；每物理秒的总压力修正扫描次数分别为 $3\\times 10^{4}$ 和 $1.6\\times 10^{4}$。\n此选项与我们为两个时间步长推导出的结果完全匹配，包括修正次数 $M$ 和每秒扫描次数。\n**结论：正确**\n\nB. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ 需要 $M = 2$，$\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ 需要 $M = 6$；每物理秒的总压力修正扫描次数分别为 $2\\times 10^{4}$ 和 $1.2\\times 10^{4}$。\n$M$ 的值不正确。我们的计算表明 $M_1=3$ 和 $M_2=8$。\n**结论：错误**\n\nC. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ 需要 $M = 3$，$\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ 需要 $M = 6$；每物理秒的总压力修正扫描次数分别为 $3\\times 10^{4}$ 和 $1.2\\times 10^{4}$。\n第一种情况的 $M=3$ 是正确的，但第二种情况的 $M=6$ 是错误的（应为 $8$）。\n**结论：错误**\n\nD. $\\Delta t = 10^{-4}\\,\\mathrm{s}$ 需要 $M = 4$，$\\Delta t = 5\\times 10^{-4}\\,\\mathrm{s}$ 需要 $M = 9$；每物理秒的总压力修正扫描次数分别为 $4\\times 10^{4}$ 和 $1.8\\times 10^{4}$。\n两种情况的 $M$ 值都不正确。我们的计算表明 $M_1=3$ 和 $M_2=8$。\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}