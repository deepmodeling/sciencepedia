{
    "hands_on_practices": [
        {
            "introduction": "要真正理解压力-速度耦合，最好的方法是从基本原理出发。本练习提供了一个坚实的分析基础，通过一个简化的槽道流场景，我们将推导出压力场为满足全局质量守恒约束必须如何响应给定的速度边界条件。通过这个计算，你将清晰地认识到压力在不可压缩流中扮演的关键角色——即作为不可压缩性约束的执行者 。",
            "id": "3986915",
            "problem": "一个高度为 $H$、长度为 $L$ 的二维通道中的稳定、不可压缩、牛顿流体流动，使用计算流体动力学 (CFD) 中的分离式压力-速度耦合算法进行模拟。流体的密度为 $\\rho$，动力粘度为 $\\mu$。基于 $H$ 和一个特征速度的雷诺数足够小，以至于惯性项可以忽略不计，即适用 Stokes 流极限。\n\n$x=0$ 处的左边界为流向分量规定了一个 Dirichlet 速度剖面，\n$$u_{\\text{in}}(y)=U_{0}\\left[1-\\left( \\frac{2y}{H}-1 \\right)^{2}\\right],$$\n对于 $y\\in[0,H]$，$v=0$。位于 $y=H$ 和 $y=0$ 处的顶壁和底壁强制执行无滑移和无穿透条件，即 $u=0$ 和 $v=0$。$x=L$ 处的右边界是开放的；该算法确定与速度耦合以满足不可压缩性和动量守恒的压力场。假设出口截面是充分发展且局部平行的，因此流向速度 $u(y)$ 满足恒定流向压力梯度 $\\partial p/\\partial x$ 和跨间隙的粘性扩散之间的稳定 Stokes 平衡，且 $u(0)=u(H)=0$。\n\n从不可压缩连续性方程和稳定 Stokes 动量方程出发，并对由整个矩形域定义的控制体积使用散度定理，完成以下任务：\n\n- 通过计算通过矩形每一侧的质量通量，并利用其总和在稳定不可压缩流中必须为零的条件，计算由边界条件所隐含的区域积分质量通量。\n- 在充分发展的出口截面，求解壁面有界 Stokes 问题以得到 $u(y)$，并沿高度积分，以用均匀压力梯度 $\\partial p/\\partial x$ 表示出口的单位翼展体积流量。\n- 施加零净散度条件（即入口和出口流量相等），以确定压力场为满足全局质量守恒必须产生的恒定流向压力梯度。\n\n将最终答案表示为所需的恒定流向压力梯度 $\\partial p/\\partial x$ 的单个闭式解析表达式，以国际单位制 $\\text{Pa/m}$ 为单位，作为 $\\mu$、$U_{0}$ 和 $H$ 的函数。不需要数值。",
            "solution": "该问题要求在给定入口特定速度剖面的情况下，确定充分发展的通道流截面中为满足全局质量守恒必须存在的恒定流向压力梯度 $\\frac{\\partial p}{\\partial x}$。该分析基于稳定、不可压缩 Stokes 流的基本原理。\n\n第一个原理是质量守恒。对于不可压缩流体，连续性方程为 $\\nabla \\cdot \\mathbf{u} = 0$，其中 $\\mathbf{u}$ 是速度场。为了在整个计算域上强制执行全局质量守恒，我们对由矩形 $[0, L] \\times [0, H]$ 定义的控制体积应用散度定理：\n$$ \\int_V (\\nabla \\cdot \\mathbf{u}) \\, dV = \\oint_S \\mathbf{u} \\cdot \\mathbf{n} \\, dS = 0 $$\n此处，$V$ 是二维域的面积，$S$ 是其边界。边界 $S$ 由四部分组成：$x=0$ 处的入口、$x=L$ 处的出口、$y=0$ 处的底壁和 $y=H$ 处的顶壁。表面积分可以写成通过这四个边界的通量之和：\n$$ \\oint_S \\mathbf{u} \\cdot \\mathbf{n} \\, dS = \\int_{0}^{H} u(x=L, y) \\, dy - \\int_{0}^{H} u(x=0, y) \\, dy + \\int_{0}^{L} v(x, y=H) \\, dx - \\int_{0}^{L} v(x, y=0) \\, dx = 0 $$\n壁面边界条件是无滑移和无穿透，意味着在 $y=0$ 和 $y=H$ 处 $u=0$ 和 $v=0$。因此，沿顶壁和底壁的积分为零。该条件简化为：\n$$ \\int_{0}^{H} u(x=L, y) \\, dy = \\int_{0}^{H} u(x=0, y) \\, dy $$\n该方程表明，出口处的单位翼展体积流量 $Q_{\\text{out}}$ 必须等于入口处的单位翼展体积流量 $Q_{\\text{in}}$。\n\n首先，我们使用规定的速度剖面 $u_{\\text{in}}(y) = U_{0}\\left[1-\\left( \\frac{2y}{H}-1 \\right)^{2}\\right]$ 计算入口体积流量 $Q_{\\text{in}}$：\n$$ Q_{\\text{in}} = \\int_0^H u_{\\text{in}}(y) \\, dy = \\int_0^H U_{0}\\left[1-\\left( \\frac{2y}{H}-1 \\right)^{2}\\right] \\, dy $$\n让我们展开被积函数中的项：\n$$ 1-\\left( \\frac{2y}{H}-1 \\right)^{2} = 1 - \\left( \\frac{4y^2}{H^2} - \\frac{4y}{H} + 1 \\right) = \\frac{4y}{H} - \\frac{4y^2}{H^2} $$\n将此代回积分中：\n$$ Q_{\\text{in}} = U_0 \\int_0^H \\left( \\frac{4y}{H} - \\frac{4y^2}{H^2} \\right) dy = U_0 \\left[ \\frac{4y^2}{2H} - \\frac{4y^3}{3H^2} \\right]_0^H $$\n$$ Q_{\\text{in}} = U_0 \\left( \\frac{2H^2}{H} - \\frac{4H^3}{3H^2} \\right) = U_0 \\left( 2H - \\frac{4}{3}H \\right) = \\frac{2}{3}U_0 H $$\n\n接下来，我们根据恒定的流向压力梯度 $\\frac{\\partial p}{\\partial x}$ 来确定出口体积流量 $Q_{\\text{out}}$。假设出口处的流动是充分发展且局部平行的。对于稳定 Stokes 流，动量方程为 $0 = -\\nabla p + \\mu \\nabla^2 \\mathbf{u}$。在流向（$x$）方向上，这变为：\n$$ 0 = -\\frac{\\partial p}{\\partial x} + \\mu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right) $$\n对于充分发展的流动，速度剖面不随 $x$ 变化，因此 $\\frac{\\partial u}{\\partial x} = 0$，这意味着 $\\frac{\\partial^2 u}{\\partial x^2} = 0$。对于平行流，横向速度 $v=0$ 处处成立，因此 $y$ 方向的动量方程简化为 $\\frac{\\partial p}{\\partial y} = 0$。这意味着压力 $p$ 仅是 $x$ 的函数，$p=p(x)$。$x$ 方向的动量方程随后简化为一个常微分方程：\n$$ \\mu \\frac{d^2 u}{dy^2} = \\frac{dp}{dx} $$\n由于左侧仅依赖于 $y$，而右侧仅依赖于 $x$，两者必须等于一个常数。设这个恒定的压力梯度为 $G = \\frac{dp}{dx}$。\n$$ \\frac{d^2 u}{dy^2} = \\frac{G}{\\mu} $$\n对 $y$ 积分两次，得到速度剖面的通解：\n$$ u(y) = \\frac{G}{2\\mu}y^2 + C_1 y + C_2 $$\n积分常数 $C_1$ 和 $C_2$ 由壁面处的无滑移边界条件确定：$u(0)=0$ 和 $u(H)=0$。\n由 $u(0)=0$ 得：\n$$ 0 = \\frac{G}{2\\mu}(0)^2 + C_1(0) + C_2 \\implies C_2=0 $$\n由 $u(H)=0$ 得：\n$$ 0 = \\frac{G}{2\\mu}H^2 + C_1 H \\implies C_1 = -\\frac{GH}{2\\mu} $$\n将常数代回，出口处的速度剖面为：\n$$ u_{\\text{out}}(y) = \\frac{G}{2\\mu}y^2 - \\frac{GH}{2\\mu}y = \\frac{G}{2\\mu}(y^2 - Hy) $$\n现在，我们可以计算出口体积流量 $Q_{\\text{out}}$：\n$$ Q_{\\text{out}} = \\int_0^H u_{\\text{out}}(y) \\, dy = \\int_0^H \\frac{G}{2\\mu}(y^2 - Hy) \\, dy $$\n$$ Q_{\\text{out}} = \\frac{G}{2\\mu} \\left[ \\frac{y^3}{3} - \\frac{Hy^2}{2} \\right]_0^H = \\frac{G}{2\\mu} \\left( \\frac{H^3}{3} - \\frac{H^3}{2} \\right) = \\frac{G}{2\\mu} \\left( -\\frac{H^3}{6} \\right) = -\\frac{G H^3}{12\\mu} $$\n\n最后，我们通过令入口和出口流量相等（$Q_{\\text{in}} = Q_{\\text{out}}$）来强制执行全局质量守恒：\n$$ \\frac{2}{3}U_0 H = -\\frac{G H^3}{12\\mu} $$\n代入 $G = \\frac{\\partial p}{\\partial x}$，我们可以解出所需的压力梯度：\n$$ \\frac{2}{3}U_0 H = -\\frac{(\\partial p/\\partial x) H^3}{12\\mu} $$\n$$ \\frac{\\partial p}{\\partial x} = -\\left( \\frac{2}{3}U_0 H \\right) \\left( \\frac{12\\mu}{H^3} \\right) = -\\frac{2 \\times 12}{3} \\frac{\\mu U_0 H}{H^3} = -\\frac{24}{3} \\frac{\\mu U_0}{H^2} $$\n$$ \\frac{\\partial p}{\\partial x} = -8 \\frac{\\mu U_0}{H^2} $$\n该表达式给出了压力场为驱动流动所必须产生的恒定流向压力梯度，使得出口质量通量与入口质量通量完全平衡，从而满足整个域上的不可压缩性约束。负号表示压力必须在流动方向上减小，这与压力驱动流的预期相符。",
            "answer": "$$ \\boxed{-8 \\frac{\\mu U_0}{H^2}} $$"
        },
        {
            "introduction": "从分析洞察转向计算实践，本练习将指导你为经典的顶盖驱动方腔流问题编写一个完整的求解器。你将运用人工可压缩法（Artificial Compressibility Method, ACM）这一强大的压力-速度耦合技术，并通过追踪速度散度的收敛过程，亲眼见证压力场如何演化以驱动流动趋向于不可压缩的稳态解 。这种亲手编程的经验对于深入理解现代CFD求解器的工作机制至关重要。",
            "id": "3986941",
            "problem": "考虑一个单位正方形域（坐标 $x\\in[0,1]$ 和 $y\\in[0,1]$）中的二维、稳态、不可压缩顶盖驱动方腔流。顶盖以均匀切向速度 $U$ 移动，所有壁面均施加无滑移边界条件。目标是设计并实现一种采用人工可压缩方法 (ACM) 进行压力-速度耦合的伪时间推进法，将速度场的散度驱动至机器容差，并量化散度残差的衰减情况。实现必须基于第一性原理，从守恒定律出发，在均匀笛卡尔网格上使用有限差分法 (FDM) 进行离散化。\n\n从以下基本物理定律和定义出发：\n\n- 不可压缩流的质量守恒：$\\nabla\\cdot\\boldsymbol{u} = 0$。\n- 线性动量守恒（稳态目标）的无量纲形式：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial \\tau} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} = -\\nabla p + \\frac{1}{Re}\\nabla^2 \\boldsymbol{u},\n$$\n其中 $\\boldsymbol{u}=(u,v)$ 是速度场，$p$ 是压力，$Re$ 是雷诺数，$\\tau$ 是用于松弛到稳态解的伪时间。\n- 压力的人工可压缩耦合：\n$$\n\\beta\\,\\frac{\\partial p}{\\partial \\tau} + \\nabla\\cdot\\boldsymbol{u} = 0,\n$$\n其中 $\\beta$ 是人工可压缩系数。\n\n在均匀网格上离散化方程，该网格在 $x$ 方向有 $N_x$ 个点，在 $y$ 方向有 $N_y$ 个点，间距分别为 $\\Delta x = 1/(N_x-1)$ 和 $\\Delta y = 1/(N_y-1)$。对空间梯度和拉普拉斯算子使用二阶中心差分，对所有变量在伪时间上使用显式向前欧拉法。在每个伪时间步施加以下边界条件：\n- 无滑移速度边界：在底壁 ($y=0$)、左壁 ($x=0$) 和右壁 ($x=1$) 上，$u=0$ 且 $v=0$；在顶盖 ($y=1$) 上，$u=U$ 且 $v=0$。\n- 零法向梯度压力边界：在所有壁面上，$\\partial p/\\partial n = 0$。\n\n将散度残差定义为内部网格点上 $\\nabla\\cdot\\boldsymbol{u}$ 的离散 $L^2$ 范数，\n$$\nR = \\left(\\frac{1}{(N_x-2)(N_y-2)}\\sum_{i=2}^{N_x-1}\\sum_{j=2}^{N_y-1} \\left(\\frac{\\partial u}{\\partial x}\\bigg|_{i,j} + \\frac{\\partial v}{\\partial y}\\bigg|_{i,j}\\right)^2\\right)^{1/2}.\n$$\n\n实现伪时间推进格式来更新 $(u,v,p)$ 并在每一步测量 $R$。将内部速度场和压力场初始化为零，顶盖边界条件除外。执行一个初始伪时间步以获得一个非零的初始残差 $R_0$（因为平凡初始化可能导致 $R=0$）。然后进行迭代，直到残差满足 $R \\leq \\varepsilon$，其中 $\\varepsilon$ 是用于停止的机器容差阈值。对于本问题，使用无量纲容差 $\\varepsilon = 10^{-10}$。\n\n您的程序必须实现该算法，并为下面指定的每个测试用例返回三个量：执行的伪时间步总数 $N_{\\text{steps}}$（包括用于定义 $R_0$ 的初始步），以无量纲单位表示的浮点数形式的最终残差 $R_{\\text{final}}$，以及表示终止时是否有 $R \\leq \\varepsilon$ 的收敛标志 $\\mathrm{converged}$。如果由于初始化导致 $R_0=0$，则将第一个伪时间更新后的残差重新定义为 $R_0$，以避免在您计算的任何内部比率中出现除以零的情况。\n\n所有量都是无量纲的，因此不需要物理单位。不使用角度。不得使用百分比。最终程序输出必须在单行上，并且必须将所有测试用例结果聚合到如下所述的确切格式的单个列表中。\n\n测试套件：\n- 用例 1：$N_x=24$, $N_y=24$, $Re=10$, $\\beta=1$, $\\Delta\\tau=5\\times 10^{-4}$, $U=1$, $N_{\\max}=4000$, $\\varepsilon=10^{-10}$。\n- 用例 2：$N_x=24$, $N_y=24$, $Re=10$, $\\beta=0.2$, $\\Delta\\tau=5\\times 10^{-4}$, $U=1$, $N_{\\max}=6000, \\varepsilon=10^{-10}$。\n- 用例 3：$N_x=16$, $N_y=16$, $Re=50$, $\\beta=2$, $\\Delta\\tau=3\\times 10^{-4}$, $U=1, N_{\\max}=5000, \\varepsilon=10^{-10}$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的列表的列表形式的结果。每个内部列表必须按 $[N_{\\text{steps}},R_{\\text{final}},\\mathrm{converged}]$ 的顺序排列。例如，输出格式必须严格为\n$[[N_{\\text{steps},1},R_{\\text{final},1},\\mathrm{converged}_1],[N_{\\text{steps},2},R_{\\text{final},2},\\mathrm{converged}_2],[N_{\\text{steps},3},R_{\\text{final},3},\\mathrm{converged}_3]]$，\n所有值都以纯数字和布尔字面量的形式表示在单行上。",
            "solution": "### 基于原理的求解设计\n\n该问题要求实现人工可压缩方法 (ACM) 来求解顶盖驱动方腔中的稳态不可压缩流。ACM 的核心思想是将压力的虚构时间导数引入连续性方程，使其与动量方程耦合。这将稳态不可压缩纳维-斯托克斯方程的混合椭圆-抛物型系统转化为伪时间上的双曲-抛物型系统，该系统可以通过时间推进过程求解，直到达到稳态。在稳态时，伪时间导数消失，原始的控制方程（包括不可压缩性约束 $\\nabla \\cdot \\boldsymbol{u}=0$）得以恢复。\n\n**1. 控制方程的离散化**\n求解域被离散化为一个均匀的笛卡尔网格，网格点为 $(x_i, y_j)$，其中 $x_i = (i-1)\\Delta x$（对于 $i=1, \\dots, N_x$）和 $y_j = (j-1)\\Delta y$（对于 $j=1, \\dots, N_y$）。所有变量 $(u, v, p)$ 都存储在这些网格点上（同位网格布置）。令 $f_{i,j}^n$ 表示函数 $f$ 在网格点 $(i,j)$ 和伪时间步 $n$ 的值。\n\n对于通用变量 $\\phi$，指定的显式向前欧拉格式为：\n$$ \\phi^{n+1} = \\phi^n + \\Delta\\tau \\left(\\frac{\\partial\\phi}{\\partial\\tau}\\right)^n $$\n空间导数使用二阶中心差分近似。对于函数 $f(x,y)$：\n$$ \\left(\\frac{\\partial f}{\\partial x}\\right)_{i,j} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2\\Delta x} \\quad , \\quad \\left(\\frac{\\partial f}{\\partial y}\\right)_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2\\Delta y} $$\n$$ (\\nabla^2 f)_{i,j} \\approx \\frac{f_{i+1,j} - 2f_{i,j} + f_{i-1,j}}{(\\Delta x)^2} + \\frac{f_{i,j+1} - 2f_{i,j} + f_{i-1,j}}{(\\Delta y)^2} $$\n\n将这些格式应用于控制方程，得到内部网格点（$i=2,\\dots,N_x-1$；$j=2,\\dots,N_y-1$）的更新规则。\n\n**动量方程：**\n分离时间导数项：\n$$ \\frac{\\partial u}{\\partial \\tau} = - \\left(u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y}\\right) - \\frac{\\partial p}{\\partial x} + \\frac{1}{Re} \\nabla^2 u $$\n$$ \\frac{\\partial v}{\\partial \\tau} = - \\left(u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y}\\right) - \\frac{\\partial p}{\\partial y} + \\frac{1}{Re} \\nabla^2 v $$\n$u$-速度分量的完全显式的离散更新为：\n$$\nu_{i,j}^{n+1} = u_{i,j}^n + \\Delta\\tau \\left[\n- \\left(u_{i,j}^n \\frac{u_{i+1,j}^n - u_{i-1,j}^n}{2\\Delta x} + v_{i,j}^n \\frac{u_{i,j+1}^n - u_{i,j-1}^n}{2\\Delta y}\\right)\n- \\frac{p_{i+1,j}^n - p_{i-1,j}^n}{2\\Delta x}\n+ \\frac{1}{Re} \\left(\\frac{u_{i+1,j}^n - 2u_{i,j}^n + u_{i-1,j}^n}{(\\Delta x)^2} + \\frac{u_{i,j+1}^n - 2u_{i,j}^n + u_{i-1,j}^n}{(\\Delta y)^2}\\right)\n\\right]\n$$\n对于 $v_{i,j}^{n+1}$，可以推导出类似的方程。\n\n**压力方程（人工可压缩性）：**\n压力基于前一时间步的速度场散度进行更新：\n$$ \\frac{\\partial p}{\\partial \\tau} = -\\frac{1}{\\beta} (\\nabla \\cdot \\boldsymbol{u}) $$\n离散更新规则为：\n$$ p_{i,j}^{n+1} = p_{i,j}^n - \\frac{\\Delta\\tau}{\\beta} \\left( \\frac{u_{i+1,j}^n - u_{i-1,j}^n}{2\\Delta x} + \\frac{v_{i,j+1}^n - v_{i,j-1}^n}{2\\Delta y} \\right) $$\n\n**2. 边界条件的实现**\n边界条件在每个伪时间步后应用。\n- **速度**：无滑移条件是狄利克雷型的。在整个模拟过程中，所有边界节点上的 $u$ 和 $v$ 值保持不变。\n    - $u_{i,1}=0, v_{i,1}=0$ for $i=1,\\dots,N_x$（底壁）。\n    - $u_{1,j}=0, v_{1,j}=0$ for $j=1,\\dots,N_y$（左壁）。\n    - $u_{N_x,j}=0, v_{N_x,j}=0$ for $j=1,\\dots,N_y$（右壁）。\n    - $u_{i,N_y}=U, v_{i,N_y}=0$ for $i=1,\\dots,N_x$（顶盖）。\n更新方程仅适用于内部速度节点。\n\n- **压力**：零法向梯度条件 $\\partial p/\\partial n = 0$ 是一个诺伊曼型条件。使用一个简单而稳健的一阶有限差分近似，它将压力从第一个内部节点外插到相应的边界节点。\n    - 左壁 ($n=(-1,0)$): $\\frac{\\partial p}{\\partial x}=0 \\implies p_{1,j} = p_{2,j}$。\n    - 右壁 ($n=(1,0)$): $\\frac{\\partial p}{\\partial x}=0 \\implies p_{N_x,j} = p_{N_x-1,j}$。\n    - 底壁 ($n=(0,-1)$): $\\frac{\\partial p}{\\partial y}=0 \\implies p_{i,1} = p_{i,2}$。\n    - 顶壁 ($n=(0,1)$): $\\frac{\\partial p}{\\partial y}=0 \\implies p_{i,N_y} = p_{i,N_y-1}$。\n这些条件在每一步更新完内部点后应用于压力场。\n\n**3. 算法流程**\n完整的数值算法如下：\n1.  **初始化**：设置模拟参数（$N_x, N_y, Re, \\beta, \\Delta\\tau, U, N_{\\max}, \\varepsilon$）。定义网格间距 $\\Delta x$ 和 $\\Delta y$。将 $u, v, p$ 数组初始化为零，然后在顶部边界上应用固定的顶盖速度 $U$。\n2.  **伪时间推进**：从伪时间步 $k=1$ 迭代到 $N_{\\max}$。在每一步中：\n    a.  复制第 $k-1$ 步的场量（$u^{k-1}, v^{k-1}, p^{k-1}$）。\n    b.  使用第 $k-1$ 步的场量和中心差分计算动量方程的对流项、压力梯度项和粘性项。\n    c.  使用向前欧拉公式更新内部速度分量 $u$ 和 $v$，得到 $u^k$ 和 $v^k$。\n    d.  使用第 $k-1$ 步的速度场计算速度散度项。\n    e.  使用向前欧拉公式和人工可压缩关系更新内部压力 $p$，得到 $p^k$。\n    f.  对新计算的压力场 $p^k$ 应用零法向梯度边界条件。\n3.  **残差计算与收敛性检查**：在计算新状态 $(u^k, v^k, p^k)$ 后：\n    a.  在所有内部点计算新速度场的散度 $D_{i,j} = (\\nabla \\cdot \\boldsymbol{u}^k)_{i,j}$。\n    b.  根据问题陈述中的定义，计算 $L^2$-范数残差 $R$。\n    c.  如果 $R \\leq \\varepsilon$，则解已收敛。将当前步数 $k$ 存储为 $N_{\\text{steps}}$，将最终残差 $R$ 存储为 $R_{\\text{final}}$，将收敛标志设置为 true，并终止循环。\n4.  **终止**：如果循环达到 $N_{\\max}$ 而未满足残差条件，则模拟未收敛。将 $N_{\\max}$ 存储为 $N_{\\text{steps}}$，将最终计算的残差存储为 $R_{\\text{final}}$，并将收敛标志设置为 false。\n\n从初始化到终止的这个过程对每个测试用例都实现一次。使用 NumPy 数组存储场量，可以对整个内部网格上的空间导数同时进行高效的向量化计算，从而避免在 Python 中使用缓慢的显式循环。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # (Nx, Ny, Re, beta, dt, U, N_max, epsilon)\n        (24, 24, 10, 1.0, 5e-4, 1.0, 4000, 1e-10),\n        (24, 24, 10, 0.2, 5e-4, 1.0, 6000, 1e-10),\n        (16, 16, 50, 2.0, 3e-4, 1.0, 5000, 1e-10),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_case(*case)\n        results.append(result)\n\n    # Format the final output list as specified.\n    # The boolean must be lowercase 'true' or 'false' in Python's string representation.\n    output_str = \"[\" + \",\".join([f\"[{res[0]},{res[1]},{str(res[2]).lower()}]\" for res in results]) + \"]\"\n    print(output_str)\n\ndef _solve_case(Nx, Ny, Re, beta, dt, U, N_max, epsilon):\n    \"\"\"\n    Solves the lid-driven cavity problem for a single test case using the\n    Artificial Compressibility Method.\n    \"\"\"\n    # 1. Grid and Initialization\n    dx = 1.0 / (Nx - 1)\n    dy = 1.0 / (Ny - 1)\n\n    # Initialize fields (u, v, p).\n    # Using (Ny, Nx) indexing to match (row, col) convention, where row ~ y, col ~ x.\n    u = np.zeros((Ny, Nx), dtype=np.float64)\n    v = np.zeros((Ny, Nx), dtype=np.float64)\n    p = np.zeros((Ny, Nx), dtype=np.float64)\n\n    # Apply Dirichlet boundary condition for velocity.\n    # Lid at y=1 (top wall, index Ny-1) moves with velocity U.\n    # Other walls have u=v=0, which is the default from initialization.\n    u[Ny - 1, :] = U\n\n    converged = False\n    final_R = 0.0\n    \n    # 2. Pseudo-Time Marching Loop\n    # The loop counter 'k' represents the number of steps taken.\n    for k in range(1, N_max + 1):\n        # Store fields from previous step (n) for RHS calculation\n        un = u.copy()\n        vn = v.copy()\n        pn = p.copy()\n\n        # --- Calculate RHS terms for interior points (from step n) ---\n        # Slices for interior points: [1:-1, 1:-1]\n        # Slices for neighbors: [1:-1, 2:], [1:-1, :-2], [2:, 1:-1], [:-2, 1:-1]\n        \n        # Convective terms\n        conv_u = (un[1:-1, 1:-1] * (un[1:-1, 2:] - un[1:-1, :-2]) / (2 * dx) +\n                  vn[1:-1, 1:-1] * (un[2:, 1:-1] - un[:-2, 1:-1]) / (2 * dy))\n        conv_v = (un[1:-1, 1:-1] * (vn[1:-1, 2:] - vn[1:-1, :-2]) / (2 * dx) +\n                  vn[1:-1, 1:-1] * (vn[2:, 1:-1] - vn[:-2, 1:-1]) / (2 * dy))\n\n        # Pressure gradient terms\n        grad_p_x = (pn[1:-1, 2:] - pn[1:-1, :-2]) / (2 * dx)\n        grad_p_y = (pn[2:, 1:-1] - pn[:-2, 1:-1]) / (2 * dy)\n\n        # Viscous terms (Laplacian)\n        lap_u = ((un[1:-1, 2:] - 2 * un[1:-1, 1:-1] + un[1:-1, :-2]) / dx**2 +\n                 (un[2:, 1:-1] - 2 * un[1:-1, 1:-1] + un[:-2, 1:-1]) / dy**2)\n        lap_v = ((vn[1:-1, 2:] - 2 * vn[1:-1, 1:-1] + vn[1:-1, :-2]) / dx**2 +\n                 (vn[2:, 1:-1] - 2 * vn[1:-1, 1:-1] + vn[:-2, 1:-1]) / dy**2)\n\n        # --- Update u and v for interior points to step n+1 ---\n        u[1:-1, 1:-1] = un[1:-1, 1:-1] + dt * (-conv_u - grad_p_x + (1 / Re) * lap_u)\n        v[1:-1, 1:-1] = vn[1:-1, 1:-1] + dt * (-conv_v - grad_p_y + (1 / Re) * lap_v)\n        \n        # Velocity BCs are fixed and not modified.\n\n        # --- Update p for interior points to step n+1 ---\n        # Pressure update uses the velocity field from step n for a fully explicit scheme.\n        div_u_old = ((un[1:-1, 2:] - un[1:-1, :-2]) / (2 * dx) +\n                     (vn[2:, 1:-1] - vn[:-2, 1:-1]) / (2 * dy))\n        p[1:-1, 1:-1] = pn[1:-1, 1:-1] - (dt / beta) * div_u_old\n        \n        # Apply pressure BCs (zero normal gradient, 1st-order extrapolation)\n        p[:, 0] = p[:, 1]       # Left wall\n        p[:, -1] = p[:, -2]     # Right wall\n        p[0, :] = p[1, :]       # Bottom wall\n        p[-1, :] = p[-2, :]     # Top wall\n\n        # --- Calculate Residual at step n+1 ---\n        # The residual is the L2 norm of the divergence of the newly computed velocity field.\n        div_u_new = ((u[1:-1, 2:] - u[1:-1, :-2]) / (2 * dx) +\n                     (v[2:, 1:-1] - v[:-2, 1:-1]) / (2 * dy))\n        \n        num_interior_points = (Nx - 2) * (Ny - 2)\n        R = np.sqrt(np.sum(div_u_new**2) / num_interior_points)\n        final_R = R\n\n        # --- Check for convergence ---\n        if R = epsilon:\n            converged = True\n            break\n    \n    # After loop, 'k' holds the total number of steps performed.\n    N_steps = k\n    \n    # If the loop finished by reaching N_max, 'converged' will be False.\n    return [N_steps, final_R, converged]\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "在实际应用中，任何基于压力的不可压缩流求解器都会面临一个微妙但至关重要的数学难题：压力方程的奇异性。最后的这个实践练习将带你深入到离散压力泊松算子的数值分析中，要求你识别出这种奇异性的根源，并阐述CFD程序中为确保获得唯一且稳定的压力解所采用的标准策略 。掌握这一理论要点是开发稳健可靠数值方法的关键。",
            "id": "3986924",
            "problem": "考虑一个有界单连通域 $\\Omega \\subset \\mathbb{R}^{d}$ ($d \\in \\{2,3\\}$) 中的不可压缩流，并假设边界上为无穿透条件，即在 $\\partial \\Omega$ 上有 $\\mathbf{u} \\cdot \\mathbf{n} = 0$，其中 $\\mathbf{u}$ 是速度，$\\mathbf{n}$ 是外法向向量。在一个具有 $N$ 个单元的连通均匀笛卡尔网格上，采用同位网格有限体积法进行离散，所有主变量（压力和速度分量）都存储在单元中心。压力-速度耦合中使用的压力方程源于对不可压缩约束 $\\nabla \\cdot \\mathbf{u} = 0$ 和动量预测的强制施加。其标准的离散形式可以抽象地写为\n$$\nL \\, p = b,\n$$\n其中 $p \\in \\mathbb{R}^{N}$ 是单元中心压力的向量，$b \\in \\mathbb{R}^{N}$ 是预测质量通量场的离散散度，$L$ 是离散的诺伊曼-泊松算子，其组合方式为\n$$\nL \\;=\\; -\\, D \\, G,\n$$\n其中 $G$ 是一个离散梯度算子，将单元中心的压力映射到面法向的压力梯度；$D$ 是一个离散散度算子，将面法向的通量映射到单元中心的散度。由无穿透条件和动量预测-校正所隐含的 $p$ 的边界条件是齐次诺伊曼条件，即在连续极限下，在 $\\partial \\Omega$ 上有 $\\partial p / \\partial n = 0$。假设 $G$ 和 $D$ 的构造满足离散散度定理和该同位网格上的分部求和恒等式，并且面梯度由与齐次诺伊曼边界处理一致的二阶中心差分构成。\n\n从不可压缩流约束和这些算子定义出发，确定在这个连通的同位网格上 $L$ 的零空间维数。然后，解释在实际的计算流体动力学（CFD）压力-速度耦合算法中，例如压力关联方程组的半隐式方法（SIMPLE）和算子分裂的压力隐式方法（PISO），当压力存在纯诺伊曼条件时，这个零空间是如何处理的。\n\n请以单个整数形式给出零空间的维数。无需四舍五入。最终答案无需单位。",
            "solution": "出发点是不可压缩流的不可压缩性约束，其强形式为在 $\\Omega$ 中 $\\nabla \\cdot \\mathbf{u} = 0$ 以及在 $\\partial \\Omega$ 上 $\\mathbf{u} \\cdot \\mathbf{n} = 0$。在投影类压力-速度耦合格式中（包括压力关联方程组的半隐式方法（SIMPLE）和算子分裂的压力隐式方法（PISO）），动量预测器会产生一个不一定满足 $\\nabla \\cdot \\mathbf{u} = 0$ 的临时速度 $\\mathbf{u}^{\\ast}$。然后引入压力修正量 $\\phi$（或压力 $p$），使得校正后的速度 $\\mathbf{u} = \\mathbf{u}^{\\ast} - G \\, \\phi$ 在离散层面上是无散的。强制施加 $D \\, \\mathbf{u} = 0$ 可得到压力方程\n$$\n- D \\, G \\, \\phi = D \\, \\mathbf{u}^{\\ast},\n$$\n因此压力方程的离散算子是 $L = - D G$。\n\n我们分析在具有齐次诺伊曼压力边界处理的连通同位网格上 $L$ 的零空间。算子定义被构造为遵循离散分部求和恒等式（分部积分的代数模拟）。具体来说，对于任意两个单元中心的标量场 $q, r \\in \\mathbb{R}^{N}$，以及一个与 $G q$ 一致的面中心矢量场 $\\mathbf{f}$，在齐次诺伊曼边界条件下，以下恒等式\n$$\nq^{\\top} \\, (D \\, \\mathbf{f}) \\;=\\; -\\, (G \\, q)^{\\top} \\, \\mathbf{f}\n$$\n成立，该边界条件使得边界贡献为零。从 $L = - D G$，我们得到离散能量恒等式\n$$\nq^{\\top} \\, L \\, q \\;=\\; q^{\\top} \\, (- D G) \\, q \\;=\\; (G \\, q)^{\\top} \\, (G \\, q) \\;=\\; \\| G \\, q \\|^{2}.\n$$\n因此，$L$ 是对称半正定的。$L$ 的零空间由所有满足 $q^{\\top} L q = 0$ 的 $q$ 组成，根据上述恒等式，这等价于 $G \\, q = \\mathbf{0}$。\n\n我们现在来刻画集合 $\\{ q \\in \\mathbb{R}^{N} \\mid G \\, q = \\mathbf{0} \\}$。离散梯度 $G$ 通过二阶中心差分将单元中心压力映射到面法向差分，这与区域边界上的齐次诺伊曼处理是一致的。在一个连通网格上，$G \\, q = \\mathbf{0}$ 意味着跨越每个内部面的相邻单元压力之间的离散差为零，因为垂直于任何内部面的 $q$ 的中心差分正比于相邻单元值的差。根据连通性，这迫使 $q$ 的所有单元值都等于一个常数 $c \\in \\mathbb{R}$。在边界上，齐次诺伊曼条件与 $G \\, c = \\mathbf{0}$ 一致，因为常数的法向导数为零。因此，所有常数都位于 $G$ 的核中，也即位于 $L$ 的核中。\n\n接下来需要论证该模式的唯一性。假设 $q$ 在 $G$ 的核中但不是常数。在一个使用中心差分的均匀连通网格上，要使所有面法向差分为零，唯一的方法是 $q$ 在相邻单元中是相同的，通过归纳法可推断出 $q$ 在整个连通分量（根据假设即整个区域）中必须是常数。因此，$G$ 的核恰好是常数向量\n$$\n\\mathbf{1} \\;=\\; (1, 1, \\dots, 1)^{\\top} \\in \\mathbb{R}^{N}.\n$$\n的生成空间。因此，$L$ 的零空间是相同的的一维子空间：\n$$\n\\mathrm{null}(L) \\;=\\; \\mathrm{span}\\{\\mathbf{1}\\}.\n$$\n因此，$L$ 的零空间维数为1。\n\n这个结论与具有纯诺伊曼边界条件的连续算子是一致的：具有齐次诺伊曼条件的拉普拉斯算子，其核由常数组成，而离散算子 $L = - D G$ 在一致的离散化和边界处理下也反映了这一性质。\n\n我们现在解释在计算流体动力学（CFD）的压力-速度耦合算法中，当压力存在纯诺伊曼边界条件时，这个零空间在实践中是如何处理的。因为 $L$ 是具有一维核的奇异矩阵，线性系统 $L \\, p = b$ 仅当 $b$ 与零空间正交时才有解，即 $\\mathbf{1}^{\\top} b = 0$。由于离散散度定理和无穿透条件，这个条件对于封闭区域是满足的：净通量总和为零。然而，解 $p$ 不是唯一的；它只能在相差一个加性常数的意义下被确定。在具体实现中，可以采用以下等效方法之一来固定这个自由度：\n- 通过固定一个压力自由度来施加参考压力，例如，在选定的单元索引 $k$ 处设置 $p_{k} = p_{\\mathrm{ref}}$，这会使系统增广为非奇异系统并产生唯一解。\n- 强制施加零均值约束，即 $\\frac{1}{N} \\sum_{i=1}^{N} p_{i} = 0$，可以通过添加拉格朗日乘子，或者将右端项投影到 $\\mathrm{span}\\{\\mathbf{1}\\}$ 的正交补上，然后从计算出的解中减去其均值来实现。\n- 使用具有零空间缩减的求解器，显式地将 $\\mathbf{1}$ 注册为零向量，使得克雷洛夫方法在商空间中运行，并对最终的压力进行后处理以满足选定的参考条件（通常是零均值）。\n\n在同位网格上，如果面通量完全由插值的单元中心速度和压力构成，可能会出现额外的伪压力-速度解耦（棋盘格模式）。在实践中，使用 Rhie–Chow 插值来构造同时依赖于动量和压力梯度的面通量，从而抑制这些非物理的棋盘格模式。这种稳定化方法解决了耦合病态问题，但并没有改变由诺伊曼边界条件引起的基本的一维零空间，该零空间仍然通过上述约束之一来消除。\n\n因此，计算出的离散诺伊曼-泊松算子 $L$ 的零空间维数为1，在实践中通过固定一个参考压力或强制施加零均值约束（可选用能感知零空间的线性求解器）来消除，而 Rhie–Chow 插值则确保了同位网格上的鲁棒耦合。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}