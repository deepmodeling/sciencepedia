{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个练习将带您深入了解 SIMPLE 算法的核心机制：压力修正步骤。通过一个具体的计算案例，您将亲手操作如何利用压力修正量来调整速度场（表现为质量通量），从而强制满足控制体中的质量守恒定律。这个基本练习旨在揭示压力-速度耦合求解过程中的关键一步，帮助您建立对该算法工作原理的直观理解。",
            "id": "3994181",
            "problem": "在计算流体力学（CFD）的压力耦合方程组半隐式方法（SIMPLE）系列算法框架下，考虑一个在均匀笛卡尔网格上的二维、稳态、密度恒定的不可压缩流。考虑一个以单元 $P$ 为中心的内部控制体，其相邻单元为 $E$、$W$、$N$ 和 $S$。采用符号约定，当面质量通量 $\\dot{m}_{f}$ 从单元 $P$ 通过面 $f \\in \\{E,W,N,S\\}$ 指向外部时，其值为正。对于单元 $P$ 的稳态不可压缩流连续性要求是，所有向外的面质量通量之和必须为零。\n\n在一个压力修正步中，面质量通量根据以下公式进行更新：\n$$\n\\dot{m}_{f}^{\\text{new}} \\;=\\; \\dot{m}_{f}^{\\text{old}} \\;+\\; d_{f}\\,\\bigl(p_{P}' - p_{N(f)}'\\bigr),\n$$\n其中，$p'$ 表示单元中心的压力修正值，$N(f)$ 是与面 $f$ 相关联的相邻单元，$d_{f}$ 是一个已知的正常数，由均匀网格上的离散化动量方程得到。\n\n给定示例单元 $P$ 的以下数据：\n- 旧的向外质量通量：$\\dot{m}_{E}^{\\text{old}} = 2.2 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$，$\\dot{m}_{W}^{\\text{old}} = -1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$，$\\dot{m}_{N}^{\\text{old}} = -0.6 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$，$\\dot{m}_{S}^{\\text{old}} = 0.1 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$。\n- 均匀的面系数：$d_{E} = d_{W} = d_{N} = d_{S} = 1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$。\n- 单元中心的压力修正值：$p_{P}' = 0 \\ \\mathrm{Pa}$ 且 $p_{E}' = p_{W}' = p_{N}' = p_{S}' = 0.175 \\ \\mathrm{Pa}$。\n\n任务：\n- 仅使用稳态不可压缩流连续性的控制要求和给定的通量修正关系，计算修正后的面质量通量 $\\dot{m}_{f}^{\\text{new}}$（其中 $f \\in \\{E,W,N,S\\}$），并验证在此均匀网格上，单元 $P$ 的局部质量平衡得到满足。\n- 最后，将净质量不平衡量\n$$\nR_{P}^{\\text{new}} \\;=\\; \\dot{m}_{E}^{\\text{new}} \\;+\\; \\dot{m}_{W}^{\\text{new}} \\;+\\; \\dot{m}_{N}^{\\text{new}} \\;+\\; \\dot{m}_{S}^{\\text{new}}\n$$\n报告为一个单一的数值。\n\n将 $R_{P}^{\\text{new}}$ 的最终答案以 $\\mathrm{kg}\\,\\mathrm{s}^{-1}$ 为单位表示。无需四舍五入。",
            "solution": "此问题经验证是合理的。这是一个适定、自洽的计算练习，基于计算流体力学（CFD）中 SIMPLE 算法的标准原理。所有提供的数据在科学上是一致的，并且足以获得唯一解。\n\n主要任务是计算控制体 $P$ 的修正质量通量，然后确定由此产生的净质量不平衡量，或称为连续性残差，$R_{P}^{\\text{new}}$。其框架是稳态不可压缩流模拟中的一个压力修正步。\n\n控制体每个面 $f$ 的质量通量 $\\dot{m}_{f}$ 的修正是由以下关系式给出：\n$$\n\\dot{m}_{f}^{\\text{new}} = \\dot{m}_{f}^{\\text{old}} + d_{f}(p_{P}' - p_{N(f)}')\n$$\n其中 $\\dot{m}_{f}^{\\text{new}}$ 是修正后的质量通量，$\\dot{m}_{f}^{\\text{old}}$ 是上一次迭代的质量通量，$p_{P}'$ 是单元 $P$ 中心的压力修正值，$p_{N(f)}'$ 是与单元 $P$ 共享面 $f$ 的相邻单元 $N(f)$ 中心的压力修正值，而 $d_{f}$ 是一个从离散化动量方程推导出的已知系数。\n\n为控制体 $P$ 及其相邻单元 $E$、$W$、$N$ 和 $S$ 给定的数据如下：\n- 旧的向外质量通量：\n  $\\dot{m}_{E}^{\\text{old}} = 2.2 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n  $\\dot{m}_{W}^{\\text{old}} = -1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n  $\\dot{m}_{N}^{\\text{old}} = -0.6 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n  $\\dot{m}_{S}^{\\text{old}} = 0.1 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n- 面系数：$d_{E} = d_{W} = d_{N} = d_{S} = 1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$\n- 压力修正值：\n  $p_{P}' = 0 \\ \\mathrm{Pa}$\n  $p_{E}' = p_{W}' = p_{N}' = p_{S}' = 0.175 \\ \\mathrm{Pa}$\n\n首先，我们计算控制体 $P$ 每个面的修正质量通量。\n\n对于东面，$f=E$，相邻单元是 $N(E) = E$。\n$$\n\\dot{m}_{E}^{\\text{new}} = \\dot{m}_{E}^{\\text{old}} + d_{E}(p_{P}' - p_{E}') = 2.2 + 1.0 \\times (0 - 0.175) = 2.2 - 0.175 = 2.025 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\n对于西面，$f=W$，相邻单元是 $N(W) = W$。\n$$\n\\dot{m}_{W}^{\\text{new}} = \\dot{m}_{W}^{\\text{old}} + d_{W}(p_{P}' - p_{W}') = -1.0 + 1.0 \\times (0 - 0.175) = -1.0 - 0.175 = -1.175 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\n对于北面，$f=N$，相邻单元是 $N(N) = N$。\n$$\n\\dot{m}_{N}^{\\text{new}} = \\dot{m}_{N}^{\\text{old}} + d_{N}(p_{P}' - p_{N}') = -0.6 + 1.0 \\times (0 - 0.175) = -0.6 - 0.175 = -0.775 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\n对于南面，$f=S$，相邻单元是 $N(S) = S$。\n$$\n\\dot{m}_{S}^{\\text{new}} = \\dot{m}_{S}^{\\text{old}} + d_{S}(p_{P}' - p_{S}') = 0.1 + 1.0 \\times (0 - 0.175) = 0.1 - 0.175 = -0.075 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\n问题要求验证局部质量平衡是否得到满足。这可以通过计算净质量不平衡量 $R_{P}^{\\text{new}}$ 来实现，该值是单元 $P$ 所有向外修正质量通量之和。根据稳态不可压缩流连续性方程，为保证质量守恒，此和必须为零。\n$$\nR_{P}^{\\text{new}} = \\dot{m}_{E}^{\\text{new}} + \\dot{m}_{W}^{\\text{new}} + \\dot{m}_{N}^{\\text{new}} + \\dot{m}_{S}^{\\text{new}}\n$$\n代入计算出的值：\n$$\nR_{P}^{\\text{new}} = 2.025 + (-1.175) + (-0.775) + (-0.075)\n$$\n$$\nR_{P}^{\\text{new}} = 2.025 - 1.175 - 0.775 - 0.075\n$$\n$$\nR_{P}^{\\text{new}} = 2.025 - (1.175 + 0.775 + 0.075) = 2.025 - (1.950 + 0.075) = 2.025 - 2.025\n$$\n$$\nR_{P}^{\\text{new}} = 0\n$$\n结果 $R_{P}^{\\text{new}} = 0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$ 验证了压力修正步使用给定的压力修正值，成功地为控制体 $P$ 实现了局部质量守恒。最后的任务是报告这个值。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "理解了基本的修正原理后，我们来探讨一个在实践中至关重要的问题：数值不稳定性。在某些网格布置（如同位网格）上直接应用朴素的压力修正方法，可能会导致非物理的“棋盘格”压力振荡。本练习通过一个简化的模型进行线性模态分析，旨在揭示这种振荡现象的数学根源，从而让您深刻体会到 Rhie–Chow 插值等先进格式的必要性。",
            "id": "3994170",
            "problem": "考虑在长度为 $L$、横截面积恒为 $A$ 的管道中，密度为常数 $\\rho$ 的一维、稳态、不可压缩流动。空间域使用包含 $N$ 个控制体积的均匀同位网格进行离散，网格间距为 $\\Delta x = L/N$。压力和速度存储在单元中心。在压力耦合方程组的半隐式方法 (SIMPLE) 算法中，预测速度 $u_{i}^{*}$ 通过线性化的离散动量修正，使用压力修正值 $p_{i}^{\\prime}$ 进行校正\n$$\nu_{i}^{(k+1)} \\;=\\; u_{i}^{*} \\;-\\; d\\,\\frac{p_{i+1}^{\\prime\\,(k)} - p_{i-1}^{\\prime\\,(k)}}{2\\,\\Delta x},\n$$\n其中 $d>0$ 是由离散动量方程得到的局部速度-压力耦合系数，$i$ 是单元索引，$k$ 是 SIMPLE 迭代索引。面速度的计算不使用 Rhie–Chow 插值，而是通过简单平均得到，\n$$\nu_{i+\\frac{1}{2}}^{(k+1)} \\;=\\; \\frac{u_{i}^{(k+1)} + u_{i+1}^{(k+1)}}{2}.\n$$\n每个单元中的离散连续性方程强制净质量通量为零，\n$$\n\\rho\\,A\\left(u_{i+\\frac{1}{2}}^{(k+1)} - u_{i-\\frac{1}{2}}^{(k+1)}\\right) \\;=\\; 0,\n$$\n在整个域上采用周期性边界条件。\n\n从不可压缩连续性方程和上述离散关系出发，对交替（棋盘格）压力模式的压力修正更新进行线性模态分析\n$$\np_{i}^{\\prime\\,(k)} \\;=\\; \\hat{A}^{(k)}\\,(-1)^{i},\n$$\n其中 $\\hat{A}^{(k)}$ 是在迭代 $k$ 时该模态的振幅。推导由下式定义的放大因子 $G$\n$$\nG \\;=\\; \\frac{\\hat{A}^{(k+1)}}{\\hat{A}^{(k)}}\n$$\n对于在不使用 Rhie–Chow 插值的同位网格上进行的单次 SIMPLE 压力修正迭代。假设 $d$ 是均匀的，并忽略任何未明确说明的效应。然后，对于代表性的网格间距 $\\Delta x = L/N$（其中 $L = 1\\,\\mathrm{m}$ 且 $N = 64$），计算 $G$ 的值。\n\n提供 $G$ 的精确值（不进行四舍五入）。将最终答案表示为一个无量纲数。最终答案中不要包含单位。",
            "solution": "用户要求我解决一个流体动力学问题。\n\n**问题验证**\n\n**第一步：提取已知条件**\n\n-   **流动与流体属性**：一维、稳态、不可压缩流动，密度为常数 $\\rho$。\n-   **域与离散化**：长度为 $L$、横截面积恒为 $A$ 的管道。该域使用包含 $N$ 个控制体积的均匀同位网格进行离散，网格间距为 $\\Delta x = L/N$。压力和速度存储在单元中心。\n-   **算法**：压力耦合方程组的半隐式方法 (SIMPLE)。\n-   **离散方程**：\n    1.  速度修正：$u_{i}^{(k+1)} = u_{i}^{*} - d\\,\\frac{p_{i+1}^{\\prime\\,(k)} - p_{i-1}^{\\prime\\,(k)}}{2\\,\\Delta x}$，其中 $d>0$ 是一个均匀的耦合系数，$k$ 是 SIMPLE 迭代索引。\n    2.  面速度：$u_{i+\\frac{1}{2}}^{(k+1)} = \\frac{u_{i}^{(k+1)} + u_{i+1}^{(k+1)}}{2}$（简单平均，无 Rhie–Chow 插值）。\n    3.  离散连续性：$\\rho\\,A\\left(u_{i+\\frac{1}{2}}^{(k+1)} - u_{i-\\frac{1}{2}}^{(k+1)}\\right) = 0$。\n-   **边界条件**：在整个域上采用周期性边界条件。\n-   **分析任务**：\n    1.  对交替（棋盘格）压力模式进行线性模态分析：$p_{i}^{\\prime\\,(k)} = \\hat{A}^{(k)}\\,(-1)^{i}$，其中 $\\hat{A}^{(k)}$ 是在迭代 $k$ 时的振幅。\n    2.  推导单次 SIMPLE 压力修正迭代的放大因子 $G = \\frac{\\hat{A}^{(k+1)}}{\\hat{A}^{(k)}}$。\n    3.  假设 $d$ 是均匀的，并忽略所述之外的效应。\n-   **求值**：对于代表性的网格间距 $\\Delta x = L/N$（其中 $L = 1\\,\\mathrm{m}$ 且 $N = 64$），计算 $G$ 的值。\n\n**第二步：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题具有科学依据。它涉及计算流体动力学 (CFD) 中的一个著名问题，具体来说是当不使用特殊插值（如 Rhie–Chow）时在同位网格上发生的压力-速度解耦。所提供的方程是 SIMPLE 等算法中使用的离散化的标准（尽管是简化的）表示。分析棋盘格模态是诊断这种数值不稳定性的经典方法。\n-   **适定性**：该问题是适定的。它提供了一套完整的离散方程，并指定了要分析的模态。目标是推导一个放大因子，这是线性稳定性分析中的标准程序。虽然“单次 SIMPLE 压力修正迭代”的表述可能含糊不清，但在问题的已知行为背景下可以合理地解释。最合乎逻辑的解释是，它指的是棋盘格模态在压力修正方程自身迭代求解过程中的行为，因为这是解耦问题的根源。\n-   **客观性**：该问题以精确、客观、无偏见的技术语言陈述。\n\n**结论**：该问题被判定为有效。这是一个标准的、尽管具有挑战性的学术问题，测试对 CFD 中数值伪影的理解。在对问题陈述最合乎逻辑的解释下，所提供的数据是自洽且充分的。\n\n**第三步：裁决与行动**\n\n该问题被判定为有效。我将继续进行求解。\n\n**解法**\n\nSIMPLE 算法的核心是求解一个类泊松方程以得到压力修正值 $p'$。该方程通过将速度修正公式代入连续性方程推导得出。我们首先从给定的离散关系推导这个压力修正方程。\n\n离散连续性方程给出如下：\n$$\n\\rho\\,A\\left(u_{i+\\frac{1}{2}}^{(k+1)} - u_{i-\\frac{1}{2}}^{(k+1)}\\right) = 0\n$$\n由于 $\\rho$ 和 $A$ 是非零常数，这可以简化为：\n$$\nu_{i+\\frac{1}{2}}^{(k+1)} - u_{i-\\frac{1}{2}}^{(k+1)} = 0\n$$\n面速度是通过对单元中心速度进行简单平均来计算的：\n$$\nu_{i+\\frac{1}{2}}^{(k+1)} = \\frac{u_{i}^{(k+1)} + u_{i+1}^{(k+1)}}{2} \\quad \\text{和} \\quad u_{i-\\frac{1}{2}}^{(k+1)} = \\frac{u_{i-1}^{(k+1)} + u_{i}^{(k+1)}}{2}\n$$\n将这些代入连续性方程得到：\n$$\n\\frac{u_{i}^{(k+1)} + u_{i+1}^{(k+1)}}{2} - \\frac{u_{i-1}^{(k+1)} + u_{i}^{(k+1)}}{2} = 0\n$$\n这可以简化为修正后速度的中心差分形式：\n$$\nu_{i+1}^{(k+1)} - u_{i-1}^{(k+1)} = 0\n$$\n问题陈述，修正后的速度 $u^{(k+1)}$ 是由预测速度 $u^*$ 和当前 SIMPLE 迭代 $k$ 的压力修正值 $p'^{(k)}$ 得到的：\n$$\nu_{j}^{(k+1)} = u_{j}^{*} - d\\,\\frac{p_{j+1}^{\\prime\\,(k)} - p_{j-1}^{\\prime\\,(k)}}{2\\,\\Delta x}\n$$\n现在，我们将此速度修正公式代入简化后的连续性方程。对于项 $u_{i+1}^{(k+1)}$ 和 $u_{i-1}^{(k+1)}$，索引 $j$ 分别变为 $i+1$ 和 $i-1$：\n$$\n\\left( u_{i+1}^{*} - d\\,\\frac{p_{i+2}^{\\prime\\,(k)} - p_{i}^{\\prime\\,(k)}}{2\\,\\Delta x} \\right) - \\left( u_{i-1}^{*} - d\\,\\frac{p_{i}^{\\prime\\,(k)} - p_{i-2}^{\\prime\\,(k)}}{2\\,\\Delta x} \\right) = 0\n$$\n重新整理各项，将压力修正场 $p'^{(k)}$ 分离到一边，预测速度场 $u^*$ 分离到另一边，得到压力修正的离散泊松方程：\n$$\nd\\,\\frac{p_{i+2}^{\\prime\\,(k)} - 2p_{i}^{\\prime\\,(k)} + p_{i-2}^{\\prime\\,(k)}}{2\\,\\Delta x} = u_{i+1}^{*} - u_{i-1}^{*}\n$$\n在迭代 $k$ 时求解此方程以找到 $p'^{(k)}$。包含预测速度的右侧项作为源项，表示局部质量不平衡。左侧是一个离散拉普拉斯算子，但其模板宽度为 $4\\Delta x$，连接节点 $i-2$、$i$ 和 $i+2$。\n\n该算子的关键特征是它只耦合具有相同奇偶性的网格点（偶数索引与偶数索引，奇数索引与奇数索引）。它对在每个网格点上符号交替的任何压力场分量——即棋盘格模态——完全不敏感。为了验证这一点，我们将棋盘格模态 $p_{j}^{\\prime} = \\hat{A}\\,(-1)^{j}$ 代入压力修正方程的左侧：\n$$\np_{i+2}^{\\prime} - 2p_{i}^{\\prime} + p_{i-2}^{\\prime} = \\hat{A}(-1)^{i+2} - 2\\hat{A}(-1)^{i} + \\hat{A}(-1)^{i-2}\n$$\n由于 $(-1)^{i+2} = (-1)^i$ 且 $(-1)^{i-2} = (-1)^i$，表达式变为：\n$$\n\\hat{A}(-1)^{i} - 2\\hat{A}(-1)^{i} + \\hat{A}(-1)^{i} = \\hat{A}(-1)^{i}(1-2+1) = 0\n$$\n这表明棋盘格模态位于离散压力-泊松算子的零空间中。因此，如上所述的 SIMPLE 算法没有机制来控制或抑制该模态。如果存在棋盘格压力场，它将满足压力修正方程的齐次部分，并且不会产生任何速度修正，因为离散压力梯度也为零：\n$$\n\\frac{p_{i+1}^{\\prime} - p_{i-1}^{\\prime}}{2\\,\\Delta x} = \\frac{\\hat{A}(-1)^{i+1} - \\hat{A}(-1)^{i-1}}{2\\,\\Delta x} = \\frac{-\\hat{A}(-1)^{i} - (-\\hat{A}(-1)^{i})}{2\\,\\Delta x} = 0\n$$\n问题要求计算放大因子 $G = \\hat{A}^{(k+1)}/\\hat{A}^{(k)}$。该因子描述了压力修正场中棋盘格模态的振幅如何从一次 SIMPLE 迭代演变到下一次。在一个典型问题中，压力修正场 $p'$ 是通过迭代求解泊松方程得到的。短语“单次 SIMPLE 压力修正迭代”最好被解释为对压力修正方程进行的一次迭代求解（如 Jacobi 或 Gauss-Seidel 方法）。让我们分析棋盘格模态在这种求解过程中的行为。\n\n设 $m$ 为在固定的外层 SIMPLE 循环索引 $k$ 下，求解压力修正方程的内层迭代求解器的迭代索引。对于方程\n$$\np_{i+2}^{\\prime} - 2p_{i}^{\\prime} + p_{i-2}^{\\prime} = \\frac{2\\Delta x}{d}(u_{i+1}^* - u_{i-1}^*)\n$$\n的类 Jacobi 迭代通过分离对角项 $p_i'$ 来构建：\n$$\np_{i}^{\\prime, (m+1)} = \\frac{1}{2}\\left(p_{i-2}^{\\prime, (m)} + p_{i+2}^{\\prime, (m)}\\right) - \\frac{\\Delta x}{d}(u_{i+1}^* - u_{i-1}^*)\n$$\n我们对误差 $\\epsilon_i^{(m)}$ 的传播进行线性模态分析，该误差具有棋盘格模态的形式：$\\epsilon_i^{(m)} = \\hat{A}^{(m)}(-1)^i$。误差根据迭代格式的齐次部分进行传播：\n$$\n\\epsilon_{i}^{(m+1)} = \\frac{1}{2}\\left(\\epsilon_{i-2}^{(m)} + \\epsilon_{i+2}^{(m)}\\right)\n$$\n代入模态形状：\n$$\n\\hat{A}^{(m+1)}(-1)^i = \\frac{1}{2}\\left(\\hat{A}^{(m)}(-1)^{i-2} + \\hat{A}^{(m)}(-1)^{i+2}\\right)\n$$\n使用恒等式 $(-1)^{i \\pm 2} = (-1)^i$：\n$$\n\\hat{A}^{(m+1)}(-1)^i = \\frac{1}{2}\\left(\\hat{A}^{(m)}(-1)^{i} + \\hat{A}^{(m)}(-1)^{i}\\right) = \\hat{A}^{(m)}(-1)^{i}\n$$\n这得出 $\\hat{A}^{(m+1)} = \\hat{A}^{(m)}$。从一次内迭代到下一次，误差的放大因子为 $1$。这意味着棋盘格误差一旦出现，就不会被迭代求解器所抑制；它会无限期地持续存在。我们可以将该模态在一次这样的迭代步骤中的演变等同于从一个全局 SIMPLE 步骤 $k$ 到 $k+1$ 的演变，因为这个数值误差不会被算法的任何其他部分修正。因此，$\\hat{A}^{(k+1)} = \\hat{A}^{(k)}$。\n\n放大因子为：\n$$\nG = \\frac{\\hat{A}^{(k+1)}}{\\hat{A}^{(k)}} = 1\n$$\n放大因子为 $1$ 意味着伪棋盘格模态既不被放大也不被抑制，导致压力场中出现持续的非物理振荡。这是同位网格方案的经典失效模式，而 Rhie-Chow 插值正是为了修正这个问题而发明的。\n\n给定的值 $L = 1\\,\\mathrm{m}$ 和 $N = 64$ 在此推导中是不需要的，因为结果与网格间距或域大小无关。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "算法的理论正确性并不能完全保证其在实际计算中的高效收敛。最后一个练习将引导您探索影响 SIMPLE 算法性能的一个关键实践环节：松弛因子。通过对比不同压力和速度松弛因子组合下的收敛过程，本练习将展示这些参数如何直接影响耦合系统的迭代路径和残差下降速率。这有助于您理解在实际 CFD 求解中如何通过调整这些“旋钮”来控制计算的稳定性和收敛速度。",
            "id": "3994235",
            "problem": "考虑一个在航空航天计算流体力学（CFD）中使用的有限体积离散化中的单个控制体积所表示的一维稳态不可压缩流斑。压力耦合方程组的半隐式方法（SIMPLE）通过一个基于离散化动量和连续性方程的分离式程序来耦合压力场和速度场。对于该控制体积，假设离散化的流向动量方程具有以下线性形式\n$$\na_u\\, u = h - d\\, p,\n$$\n其中 $a_u > 0$ 是中心动量系数，$d > 0$ 是压力梯度耦合系数，$h$ 是邻近网格和源项的总贡献，$u$ 是控制体积速度，$p$ 是控制体积压力。该控制体积的连续性要求净质量通量为零，此处简化为速度目标为零，\n$$\nu = 0.\n$$\n在SIMPLE算法中，通过将压力固定在当前迭代值 $p^{(k)}$ 并求解动量方程，来计算预测速度 $u^{*}$；然后通过引入一个压力修正量 $p'$，该修正量通过动量方程的线性化来引起速度修正，从而强制满足连续性。在标准线性化下，由压力修正量引起的速度修正是\n$$\nu^{\\text{corr}} = u^{*} - \\frac{d}{a_u}\\, p'.\n$$\n在这个单自由度流斑中，通过施加 $u^{\\text{corr}} = 0$ 来恢复局部连续性。欠松弛在更新变量的层面上应用，\n$$\np^{(k+1)} = p^{(k)} + \\alpha_p\\, p' \\quad \\text{and} \\quad u^{(k+1)} = u^{(k)} + \\alpha_u \\left(u^{\\text{corr}} - u^{(k)}\\right),\n$$\n其中松弛因子 $\\alpha_p \\in (0,1]$ 和 $\\alpha_u \\in (0,1]$ 是预设的。为了量化迭代衰减，定义在第 $k$ 次迭代时的耦合残差向量，\n$$\nr^{(k)} := \\begin{pmatrix} r_m^{(k)} \\\\ r_c^{(k)} \\end{pmatrix} = \\begin{pmatrix} a_u\\, u^{(k)} - d\\, p^{(k)} - h \\\\ u^{(k)} \\end{pmatrix},\n$$\n以及相关的欧几里得范数\n$$\n\\|r^{(k)}\\|_2 = \\sqrt{\\left(r_m^{(k)}\\right)^2 + \\left(r_c^{(k)}\\right)^2}.\n$$\n\n给定系数和初始猜测值\n$$\na_u = 4, \\quad d = 1.5, \\quad h = 2, \\quad u^{(0)} = 0.5, \\quad p^{(0)} = 1,\n$$\n对两种不同的欠松弛设置执行两次SIMPLE迭代（$k=0 \\rightarrow 1 \\rightarrow 2$）：\n\n情况A：$\\alpha_u = 0.7$ 和 $\\alpha_p = 0.3$，\n\n情况B：$\\alpha_u = 0.3$ 和 $\\alpha_p = 0.7$。\n\n使用所述的程序和残差定义，计算比率\n$$\n\\rho := \\frac{\\|r^{(2)}\\|_{2,\\text{B}}}{\\|r^{(2)}\\|_{2,\\text{A}}},\n$$\n其中 $\\|r^{(2)}\\|_{2,\\text{A}}$ 和 $\\|r^{(2)}\\|_{2,\\text{B}}$ 分别表示情况A和情况B两次迭代后的残差范数。将最终比率四舍五入到四位有效数字。最终比率不需要单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第1步：提取已知条件\n给定的数据和方程如下：\n- 离散化流向动量方程：$a_u\\, u = h - d\\, p$\n- 连续性方程（速度目标）：$u = 0$\n- 中心动量系数：$a_u = 4$\n- 压力梯度耦合系数：$d = 1.5$\n- 邻近网格和源项的总贡献：$h = 2$\n- 速度修正公式：$u^{\\text{corr}} = u^{*} - \\frac{d}{a_u}\\, p'$\n- 局部连续性条件：$u^{\\text{corr}} = 0$\n- 压力更新公式：$p^{(k+1)} = p^{(k)} + \\alpha_p\\, p'$\n- 速度更新公式：$u^{(k+1)} = u^{(k)} + \\alpha_u \\left(u^{\\text{corr}} - u^{(k)}\\right)$\n- 残差向量定义：$r^{(k)} := \\begin{pmatrix} r_m^{(k)} \\\\ r_c^{(k)} \\end{pmatrix} = \\begin{pmatrix} a_u\\, u^{(k)} - d\\, p^{(k)} - h \\\\ u^{(k)} \\end{pmatrix}$\n- 残差范数定义：$\\|r^{(k)}\\|_2 = \\sqrt{\\left(r_m^{(k)}\\right)^2 + \\left(r_c^{(k)}\\right)^2}$\n- 初始条件（迭代 $k=0$）：$u^{(0)} = 0.5$，$p^{(0)} = 1$\n- 情况A欠松弛因子：$\\alpha_u = 0.7$，$\\alpha_p = 0.3$\n- 情况B欠松弛因子：$\\alpha_u = 0.3$，$\\alpha_p = 0.7$\n- 最终目标是计算比率 $\\rho := \\frac{\\|r^{(2)}\\|_{2,\\text{B}}}{\\|r^{(2)}\\|_{2,\\text{A}}}$。\n\n### 第2步：使用提取的已知条件进行验证\n对问题进行验证：\n- **科学依据**：该问题描述了SIMPLE算法的一个简化的一维单网格应用，该算法是计算流体力学（CFD）中的一个基石迭代方法。所用方程是在此背景下使用的标准线性化表示。该设置在科学和数学上是合理的。\n- **适定性**：所有必要的常数、初始条件和迭代公式都已明确给出。该问题是自包含的，并且有唯一的确定性解。\n- **客观性**：问题以精确、技术性的语言陈述，没有主观性或模糊性。\n\n### 第3步：结论与行动\n问题是**有效的**。将提供完整解答。\n\n解题的核心是为情况A和情况B分别执行两次SIMPLE算法迭代，计算每种情况下第二次迭代结束时的残差范数，然后求出它们的比率。\n\n从迭代 $k$ 推进到 $k+1$ 的迭代过程如下：\n1.  使用当前压力 $p^{(k)}$ 求解动量方程，得到预测速度 $u^{*}$：\n    $$u^{*} = \\frac{h - d\\, p^{(k)}}{a_u}$$\n2.  通过在速度修正公式中强制施加连续性条件 $u^{\\text{corr}} = 0$ 来求得压力修正量 $p'$：\n    $$0 = u^{*} - \\frac{d}{a_u}\\, p' \\implies p' = \\frac{a_u}{d} u^{*}$$\n3.  使用欠松弛因子更新压力和速度场。由于 $u^{\\text{corr}}=0$，速度更新得以简化：\n    $$p^{(k+1)} = p^{(k)} + \\alpha_p\\, p'$$\n    $$u^{(k+1)} = u^{(k)} + \\alpha_u \\left(0 - u^{(k)}\\right) = (1 - \\alpha_u) u^{(k)}$$\n4.  计算迭代 $k+1$ 时的残差：\n    $$r_m^{(k+1)} = a_u\\, u^{(k+1)} - d\\, p^{(k+1)} - h$$\n    $$r_c^{(k+1)} = u^{(k+1)}$$\n5.  计算残差向量的欧几里得范数：\n    $$\\|r^{(k+1)}\\|_2 = \\sqrt{\\left(r_m^{(k+1)}\\right)^2 + \\left(r_c^{(k+1)}\\right)^2}$$\n\n给定的常数是 $a_u = 4$，$d = 1.5$，$h = 2$。\n初始条件是 $u^{(0)} = 0.5$，$p^{(0)} = 1$。\n\n**情况A：$\\alpha_u = 0.7$，$\\alpha_p = 0.3$**\n\n**第1次迭代（$k=0 \\rightarrow 1$）：**\n- 预测速度：$u^{*} = \\frac{2 - 1.5 \\times 1}{4} = \\frac{0.5}{4} = 0.125$。\n- 压力修正量：$p' = \\frac{4}{1.5} \\times 0.125 = \\frac{8}{3} \\times \\frac{1}{8} = \\frac{1}{3}$。\n- 更新后的压力：$p^{(1)} = p^{(0)} + \\alpha_p\\, p' = 1 + 0.3 \\times \\frac{1}{3} = 1 + 0.1 = 1.1$。\n- 更新后的速度：$u^{(1)} = (1 - \\alpha_u) u^{(0)} = (1 - 0.7) \\times 0.5 = 0.3 \\times 0.5 = 0.15$。\n\n**第2次迭代（$k=1 \\rightarrow 2$）：**\n- 预测速度：$u^{*} = \\frac{2 - 1.5 \\times p^{(1)}}{4} = \\frac{2 - 1.5 \\times 1.1}{4} = \\frac{2 - 1.65}{4} = \\frac{0.35}{4} = 0.0875$。\n- 压力修正量：$p' = \\frac{4}{1.5} \\times 0.0875 = \\frac{8}{3} \\times \\frac{7}{80} = \\frac{7}{30}$。\n- 更新后的压力：$p_{\\text{A}}^{(2)} = p^{(1)} + \\alpha_p\\, p' = 1.1 + 0.3 \\times \\frac{7}{30} = 1.1 + 0.07 = 1.17$。\n- 更新后的速度：$u_{\\text{A}}^{(2)} = (1 - \\alpha_u) u^{(1)} = (1 - 0.7) \\times 0.15 = 0.3 \\times 0.15 = 0.045$。\n\n**情况A在 $k=2$ 时的残差：**\n- 动量残差：$r_{m,\\text{A}}^{(2)} = a_u u_{\\text{A}}^{(2)} - d p_{\\text{A}}^{(2)} - h = 4(0.045) - 1.5(1.17) - 2 = 0.18 - 1.755 - 2 = -3.575$。\n- 连续性残差：$r_{c,\\text{A}}^{(2)} = u_{\\text{A}}^{(2)} = 0.045$。\n- 残差范数：$\\|r^{(2)}\\|_{2,\\text{A}} = \\sqrt{(-3.575)^2 + (0.045)^2} = \\sqrt{12.780625 + 0.002025} = \\sqrt{12.78265}$。\n\n**情况B：$\\alpha_u = 0.3$，$\\alpha_p = 0.7$**\n\n**第1次迭代（$k=0 \\rightarrow 1$）：**\n- 预测速度（仅取决于 $p^{(0)}$）：$u^{*} = \\frac{2 - 1.5 \\times 1}{4} = 0.125$。\n- 压力修正量（仅取决于 $u^{*}$）：$p' = \\frac{4}{1.5} \\times 0.125 = \\frac{1}{3}$。\n- 更新后的压力：$p^{(1)} = p^{(0)} + \\alpha_p\\, p' = 1 + 0.7 \\times \\frac{1}{3} = 1 + \\frac{7}{30} = \\frac{37}{30}$。\n- 更新后的速度：$u^{(1)} = (1 - \\alpha_u) u^{(0)} = (1 - 0.3) \\times 0.5 = 0.7 \\times 0.5 = 0.35$。\n\n**第2次迭代（$k=1 \\rightarrow 2$）：**\n- 预测速度：$u^{*} = \\frac{2 - 1.5 \\times p^{(1)}}{4} = \\frac{2 - 1.5 \\times (37/30)}{4} = \\frac{2 - (3/2) \\times (37/30)}{4} = \\frac{2 - 37/20}{4} = \\frac{(40-37)/20}{4} = \\frac{3}{80} = 0.0375$。\n- 压力修正量：$p' = \\frac{4}{1.5} \\times 0.0375 = \\frac{8}{3} \\times \\frac{3}{80} = \\frac{1}{10} = 0.1$。\n- 更新后的压力：$p_{\\text{B}}^{(2)} = p^{(1)} + \\alpha_p\\, p' = \\frac{37}{30} + 0.7 \\times 0.1 = \\frac{37}{30} + 0.07 = \\frac{37}{30} + \\frac{7}{100} = \\frac{370 + 21}{300} = \\frac{391}{300}$。\n- 更新后的速度：$u_{\\text{B}}^{(2)} = (1 - \\alpha_u) u^{(1)} = (1 - 0.3) \\times 0.35 = 0.7 \\times 0.35 = 0.245$。\n\n**情况B在 $k=2$ 时的残差：**\n- 动量残差：$r_{m,\\text{B}}^{(2)} = a_u u_{\\text{B}}^{(2)} - d p_{\\text{B}}^{(2)} - h = 4(0.245) - 1.5(\\frac{391}{300}) - 2 = 0.98 - \\frac{391}{200} - 2 = 0.98 - 1.955 - 2 = -2.975$。\n- 连续性残差：$r_{c,\\text{B}}^{(2)} = u_{\\text{B}}^{(2)} = 0.245$。\n- 残差范数：$\\|r^{(2)}\\|_{2,\\text{B}} = \\sqrt{(-2.975)^2 + (0.245)^2} = \\sqrt{8.850625 + 0.060025} = \\sqrt{8.91065}$。\n\n**最终比率计算：**\n比率 $\\rho$ 的计算如下：\n$$\\rho = \\frac{\\|r^{(2)}\\|_{2,\\text{B}}}{\\|r^{(2)}\\|_{2,\\text{A}}} = \\frac{\\sqrt{8.91065}}{\\sqrt{12.78265}} = \\sqrt{\\frac{8.91065}{12.78265}} \\approx \\sqrt{0.6970719} \\approx 0.8349083$$\n四舍五入到四位有效数字，结果为 $0.8349$。",
            "answer": "$$\\boxed{0.8349}$$"
        }
    ]
}