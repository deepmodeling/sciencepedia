{
    "hands_on_practices": [
        {
            "introduction": "在求解不可压缩流动问题时，核心挑战在于压力和速度之间的耦合。SIMPLE算法通过引入压力修正步骤，巧妙地解决了这个问题。第一个练习将通过一个具体的数值计算，带你完整地走一遍这个关键步骤，让你亲眼见证计算出的压力修正场如何在一个控制体积内强制实现质量守恒。",
            "id": "3994181",
            "problem": "考虑在计算流体力学 (CFD) 的压力耦合方程组半隐式方法 (SIMPLE) 算法族框架下，均匀笛卡尔网格上的一个二维、定常、密度恒定的不可压缩流动。关注一个以单元 $P$ 为中心，且与 $E$, $W$, $N$, $S$ 相邻的内部控制体。采用符号约定，即当每个面质量通量 $\\dot{m}_{f}$ 通过面 $f \\in \\{E,W,N,S\\}$ 从单元 $P$ 向外流出时，其值为正。对于单元 $P$，不可压缩定常连续性要求是，所有向外的面质量通量之和必须为零。\n\n在压力修正步中，面质量通量根据以下公式进行更新\n$$\n\\dot{m}_{f}^{\\text{new}} \\;=\\; \\dot{m}_{f}^{\\text{old}} \\;+\\; d_{f}\\,\\bigl(p_{P}' - p_{N(f)}'\\bigr),\n$$\n其中 $p'$ 表示单元中心的压力修正值，$N(f)$ 是与面 $f$ 相关联的相邻单元，$d_{f}$ 是从均匀网格上的离散化动量方程得到的已知正常数系数。\n\n给定示例单元 $P$ 的以下数据：\n- 旧的向外质量通量：$\\dot{m}_{E}^{\\text{old}} = 2.2 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$，$\\dot{m}_{W}^{\\text{old}} = -1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$，$\\dot{m}_{N}^{\\text{old}} = -0.6 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$，$\\dot{m}_{S}^{\\text{old}} = 0.1 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$。\n- 统一的面系数：$d_{E} = d_{W} = d_{N} = d_{S} = 1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$。\n- 单元中心的压力修正值：$p_{P}' = 0 \\ \\mathrm{Pa}$ 以及 $p_{E}' = p_{W}' = p_{N}' = p_{S}' = 0.175 \\ \\mathrm{Pa}$。\n\n任务：\n- 仅使用定常不可压缩连续性的控制要求和给定的通量修正关系式，计算修正后的面质量通量 $\\dot{m}_{f}^{\\text{new}}$ (其中 $f \\in \\{E,W,N,S\\}$)，并验证在此均匀网格上，单元 $P$ 的局部质量平衡得到满足。\n- 最后，将净质量不平衡量\n$$\nR_{P}^{\\text{new}} \\;=\\; \\dot{m}_{E}^{\\text{new}} \\;+\\; \\dot{m}_{W}^{\\text{new}} \\;+\\; \\dot{m}_{N}^{\\text{new}} \\;+\\; \\dot{m}_{S}^{\\text{new}}\n$$\n报告为一个单一数值。\n\n以 $\\mathrm{kg}\\,\\mathrm{s}^{-1}$ 为单位表示 $R_{P}^{\\text{new}}$ 的最终答案。无需四舍五入。",
            "solution": "该问题经核验是合理的。这是一个适定、自洽的计算练习，基于计算流体力学 (CFD) 中 SIMPLE 算法的标准原理。所有给定数据在科学上是一致的，并且足以得到唯一解。\n\n主要任务是计算控制体 $P$ 的修正后质量通量，然后确定由此产生的净质量不平衡量，或称为连续性残差 $R_{P}^{\\text{new}}$。其框架是定常不可压缩流模拟中的一个压力修正步。\n\n通过控制体每个面 $f$ 的质量通量 $\\dot{m}_{f}$ 的修正是由以下关系式给出的：\n$$\n\\dot{m}_{f}^{\\text{new}} = \\dot{m}_{f}^{\\text{old}} + d_{f}(p_{P}' - p_{N(f)}')\n$$\n其中 $\\dot{m}_{f}^{\\text{new}}$ 是修正后的质量通量，$\\dot{m}_{f}^{\\text{old}}$ 是上一次迭代的质量通量，$p_{P}'$ 是单元 $P$ 中心的压力修正值，$p_{N(f)}'$ 是共享面 $f$ 的相邻单元 $N(f)$ 中心的压力修正值，而 $d_{f}$ 是从离散化动量方程导出的已知系数。\n\n给定的控制体 $P$ 及其相邻单元 $E$, $W$, $N$, $S$ 的数据如下：\n- 旧的向外质量通量：\n  $\\dot{m}_{E}^{\\text{old}} = 2.2 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n  $\\dot{m}_{W}^{\\text{old}} = -1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n  $\\dot{m}_{N}^{\\text{old}} = -0.6 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n  $\\dot{m}_{S}^{\\text{old}} = 0.1 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$\n- 面系数：$d_{E} = d_{W} = d_{N} = d_{S} = 1.0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\\,\\mathrm{Pa}^{-1}$\n- 压力修正值：\n  $p_{P}' = 0 \\ \\mathrm{Pa}$\n  $p_{E}' = p_{W}' = p_{N}' = p_{S}' = 0.175 \\ \\mathrm{Pa}$\n\n首先，我们计算控制体 $P$ 每个面的修正后质量通量。\n\n对于东面，$f=E$，相邻单元是 $N(E) = E$。\n$$\n\\dot{m}_{E}^{\\text{new}} = \\dot{m}_{E}^{\\text{old}} + d_{E}(p_{P}' - p_{E}') = 2.2 + 1.0 \\times (0 - 0.175) = 2.2 - 0.175 = 2.025 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\n对于西面，$f=W$，相邻单元是 $N(W) = W$。\n$$\n\\dot{m}_{W}^{\\text{new}} = \\dot{m}_{W}^{\\text{old}} + d_{W}(p_{P}' - p_{W}') = -1.0 + 1.0 \\times (0 - 0.175) = -1.0 - 0.175 = -1.175 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\n对于北面，$f=N$，相邻单元是 $N(N) = N$。\n$$\n\\dot{m}_{N}^{\\text{new}} = \\dot{m}_{N}^{\\text{old}} + d_{N}(p_{P}' - p_{N}') = -0.6 + 1.0 \\times (0 - 0.175) = -0.6 - 0.175 = -0.775 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\n对于南面，$f=S$，相邻单元是 $N(S) = S$。\n$$\n\\dot{m}_{S}^{\\text{new}} = \\dot{m}_{S}^{\\text{old}} + d_{S}(p_{P}' - p_{S}') = 0.1 + 1.0 \\times (0 - 0.175) = 0.1 - 0.175 = -0.075 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n\n问题要求验证局部质量平衡是否得到满足。这通过计算净质量不平衡量 $R_{P}^{\\text{new}}$ 来实现，它是从单元 $P$ 流出的所有修正后向外质量通量的总和。根据定常不可压缩连续性方程，为使质量守恒，该总和必须为零。\n$$\nR_{P}^{\\text{new}} = \\dot{m}_{E}^{\\text{new}} + \\dot{m}_{W}^{\\text{new}} + \\dot{m}_{N}^{\\text{new}} + \\dot{m}_{S}^{\\text{new}}\n$$\n代入计算出的值：\n$$\nR_{P}^{\\text{new}} = 2.025 + (-1.175) + (-0.775) + (-0.075)\n$$\n$$\nR_{P}^{\\text{new}} = 2.025 - 1.175 - 0.775 - 0.075\n$$\n$$\nR_{P}^{\\text{new}} = 2.025 - (1.175 + 0.775 + 0.075) = 2.025 - (1.950 + 0.075) = 2.025 - 2.025\n$$\n$$\nR_{P}^{\\text{new}} = 0\n$$\n结果 $R_{P}^{\\text{new}} = 0 \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}$ 验证了压力修正步使用给定的压力修正值，已成功地对控制体 $P$ 强制实现了局部质量守恒。最后的任务是报告这个值。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "尽管压力修正步骤确保了质量守恒，但要让整个求解过程稳定高效地收敛，还需要精细的控制。这正是亚松弛因子发挥作用的地方。本练习将探讨如何调节压力亚松弛因子（$\\alpha_p$）和速度亚松弛因子（$\\alpha_u$）来影响收敛行为，这是任何计算流体力学（CFD）实践者都必须掌握的一项重要技能。",
            "id": "3994235",
            "problem": "考虑一个在航空航天计算流体力学 (CFD) 中使用的有限体积离散化方法下的单个控制体积，该控制体积代表一个一维稳态不可压缩流动区域。压力耦合方程组的半隐式方法 (SIMPLE) 通过基于离散化的动量方程和连续性方程的分离式求解过程，来耦合压力场和速度场。对于该控制体积，假设离散化的流向动量方程具有以下线性形式\n$$\na_u\\, u = h - d\\, p,\n$$\n其中 $a_u  0$ 是中心动量系数，$d  0$ 是压力梯度耦合系数，$h$ 是邻点和源项的综合贡献，$u$ 是控制体积的速度，$p$ 是控制体积的压力。此控制体积的连续性要求净质量通量为零，此处简化为速度目标值为零，\n$$\nu = 0.\n$$\n在 SIMPLE 算法中，首先通过将压力固定在当前迭代值 $p^{(k)}$ 并求解动量方程来计算预测速度 $u^{*}$；然后通过引入压力修正量 $p'$，经由动量方程的线性化来引起速度修正，从而强制满足连续性。在标准线性化下，由压力修正引起的速度修正为\n$$\nu^{\\text{corr}} = u^{*} - \\frac{d}{a_u}\\, p'.\n$$\n通过在这个单自由度区域中强制施加 $u^{\\text{corr}} = 0$ 来恢复局部连续性。欠松弛在更新变量的层面上应用，\n$$\np^{(k+1)} = p^{(k)} + \\alpha_p\\, p' \\quad \\text{且} \\quad u^{(k+1)} = u^{(k)} + \\alpha_u \\left(u^{\\text{corr}} - u^{(k)}\\right),\n$$\n其中松弛因子 $\\alpha_p \\in (0,1]$ 和 $\\alpha_u \\in (0,1]$ 是预设值。为量化迭代衰减，定义第 $k$ 次迭代的耦合残差向量，\n$$\nr^{(k)} := \\begin{pmatrix} r_m^{(k)} \\\\ r_c^{(k)} \\end{pmatrix} = \\begin{pmatrix} a_u\\, u^{(k)} - d\\, p^{(k)} - h \\\\ u^{(k)} \\end{pmatrix},\n$$\n以及相关的欧几里得范数\n$$\n\\|r^{(k)}\\|_2 = \\sqrt{\\left(r_m^{(k)}\\right)^2 + \\left(r_c^{(k)}\\right)^2}.\n$$\n\n给定系数和初始值\n$$\na_u = 4, \\quad d = 1.5, \\quad h = 2, \\quad u^{(0)} = 0.5, \\quad p^{(0)} = 1,\n$$\n对两种不同的欠松弛设置执行两次 SIMPLE 迭代 ($k=0 \\rightarrow 1 \\rightarrow 2$)：\n\n情况 A：$\\alpha_u = 0.7$ 且 $\\alpha_p = 0.3$，\n\n情况 B：$\\alpha_u = 0.3$ 且 $\\alpha_p = 0.7$。\n\n使用所述过程和残差定义，计算比率\n$$\n\\rho := \\frac{\\|r^{(2)}\\|_{2,\\text{B}}}{\\|r^{(2)}\\|_{2,\\text{A}}},\n$$\n其中 $\\|r^{(2)}\\|_{2,\\text{A}}$ 和 $\\|r^{(2)}\\|_{2,\\text{B}}$ 分别表示情况 A 和情况 B 两次迭代后的残差范数。将最终比率四舍五入至四位有效数字。最终比率无需单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n给定的数据和方程如下：\n- 离散化流向动量方程：$a_u\\, u = h - d\\, p$\n- 连续性方程（速度目标值）：$u = 0$\n- 中心动量系数：$a_u = 4$\n- 压力梯度耦合系数：$d = 1.5$\n- 邻点和源项的综合贡献：$h = 2$\n- 速度修正公式：$u^{\\text{corr}} = u^{*} - \\frac{d}{a_u}\\, p'$\n- 局部连续性条件：$u^{\\text{corr}} = 0$\n- 压力更新公式：$p^{(k+1)} = p^{(k)} + \\alpha_p\\, p'$\n- 速度更新公式：$u^{(k+1)} = u^{(k)} + \\alpha_u \\left(u^{\\text{corr}} - u^{(k)}\\right)$\n- 残差向量定义：$r^{(k)} := \\begin{pmatrix} r_m^{(k)} \\\\ r_c^{(k)} \\end{pmatrix} = \\begin{pmatrix} a_u\\, u^{(k)} - d\\, p^{(k)} - h \\\\ u^{(k)} \\end{pmatrix}$\n- 残差范数定义：$\\|r^{(k)}\\|_2 = \\sqrt{\\left(r_m^{(k)}\\right)^2 + \\left(r_c^{(k)}\\right)^2}$\n- 初始条件（迭代 $k=0$）：$u^{(0)} = 0.5$，$p^{(0)} = 1$\n- 情况 A 的欠松弛因子：$\\alpha_u = 0.7$，$\\alpha_p = 0.3$\n- 情况 B 的欠松弛因子：$\\alpha_u = 0.3$，$\\alpha_p = 0.7$\n- 最终目标是计算比率 $\\rho := \\frac{\\|r^{(2)}\\|_{2,\\text{B}}}{\\|r^{(2)}\\|_{2,\\text{A}}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题进行验证：\n- **科学依据**：该问题描述了 SIMPLE 算法在一个简化的、一维、单网格场景下的应用。SIMPLE 算法是计算流体力学 (CFD) 中一种重要的迭代方法。所用方程是在此背景下使用的标准线性化表示。整个设置在科学上和数学上都是合理的。\n- **适定性**：所有必要的常数、初始条件和迭代公式都已明确给出。问题是自洽的，并有唯一的确定性解。\n- **客观性**：问题以精确、技术性的语言陈述，没有主观性或模糊性。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供完整解答。\n\n解答的核心是为情况 A 和情况 B 分别执行两次 SIMPLE 算法迭代，计算每种情况下第二次迭代结束时的残差范数，然后求出它们的比率。\n\n从迭代步 $k$推进到 $k+1$ 的迭代过程如下：\n1.  使用当前压力 $p^{(k)}$ 求解动量方程，得到预测速度 $u^{*}$：\n    $$u^{*} = \\frac{h - d\\, p^{(k)}}{a_u}$$\n2.  在速度修正公式中强制施加连续性条件 $u^{\\text{corr}} = 0$ 来求得压力修正量 $p'$：\n    $$0 = u^{*} - \\frac{d}{a_u}\\, p' \\implies p' = \\frac{a_u}{d} u^{*}$$\n3.  使用欠松弛因子更新压力场和速度场。由于 $u^{\\text{corr}}=0$，速度更新公式得以简化：\n    $$p^{(k+1)} = p^{(k)} + \\alpha_p\\, p'$$\n    $$u^{(k+1)} = u^{(k)} + \\alpha_u \\left(0 - u^{(k)}\\right) = (1 - \\alpha_u) u^{(k)}$$\n4.  计算第 $k+1$ 次迭代的残差：\n    $$r_m^{(k+1)} = a_u\\, u^{(k+1)} - d\\, p^{(k+1)} - h$$\n    $$r_c^{(k+1)} = u^{(k+1)}$$\n5.  计算残差向量的欧几里得范数：\n    $$\\|r^{(k+1)}\\|_2 = \\sqrt{\\left(r_m^{(k+1)}\\right)^2 + \\left(r_c^{(k+1)}\\right)^2}$$\n\n给定的常数为 $a_u = 4$，$d = 1.5$，$h = 2$。\n初始条件为 $u^{(0)} = 0.5$，$p^{(0)} = 1$。\n\n**情况 A：$\\alpha_u = 0.7$，$\\alpha_p = 0.3$**\n\n**第 1 次迭代 ($k=0 \\rightarrow 1$)：**\n- 预测速度：$u^{*} = \\frac{2 - 1.5 \\times 1}{4} = \\frac{0.5}{4} = 0.125$。\n- 压力修正：$p' = \\frac{4}{1.5} \\times 0.125 = \\frac{8}{3} \\times \\frac{1}{8} = \\frac{1}{3}$。\n- 更新后的压力：$p^{(1)} = p^{(0)} + \\alpha_p\\, p' = 1 + 0.3 \\times \\frac{1}{3} = 1 + 0.1 = 1.1$。\n- 更新后的速度：$u^{(1)} = (1 - \\alpha_u) u^{(0)} = (1 - 0.7) \\times 0.5 = 0.3 \\times 0.5 = 0.15$。\n\n**第 2 次迭代 ($k=1 \\rightarrow 2$)：**\n- 预测速度：$u^{*} = \\frac{2 - 1.5 \\times p^{(1)}}{4} = \\frac{2 - 1.5 \\times 1.1}{4} = \\frac{2 - 1.65}{4} = \\frac{0.35}{4} = 0.0875$。\n- 压力修正：$p' = \\frac{4}{1.5} \\times 0.0875 = \\frac{8}{3} \\times \\frac{7}{80} = \\frac{7}{30}$。\n- 更新后的压力：$p_{\\text{A}}^{(2)} = p^{(1)} + \\alpha_p\\, p' = 1.1 + 0.3 \\times \\frac{7}{30} = 1.1 + 0.07 = 1.17$。\n- 更新后的速度：$u_{\\text{A}}^{(2)} = (1 - \\alpha_u) u^{(1)} = (1 - 0.7) \\times 0.15 = 0.3 \\times 0.15 = 0.045$。\n\n**情况 A 在 $k=2$ 时的残差：**\n- 动量残差：$r_{m,\\text{A}}^{(2)} = a_u u_{\\text{A}}^{(2)} - d p_{\\text{A}}^{(2)} - h = 4(0.045) - 1.5(1.17) - 2 = 0.18 - 1.755 - 2 = -3.575$。\n- 连续性残差：$r_{c,\\text{A}}^{(2)} = u_{\\text{A}}^{(2)} = 0.045$。\n- 残差范数：$\\|r^{(2)}\\|_{2,\\text{A}} = \\sqrt{(-3.575)^2 + (0.045)^2} = \\sqrt{12.780625 + 0.002025} = \\sqrt{12.78265}$。\n\n**情况 B：$\\alpha_u = 0.3$，$\\alpha_p = 0.7$**\n\n**第 1 次迭代 ($k=0 \\rightarrow 1$)：**\n- 预测速度（仅取决于 $p^{(0)}$）：$u^{*} = \\frac{2 - 1.5 \\times 1}{4} = 0.125$。\n- 压力修正（仅取决于 $u^{*}$）：$p' = \\frac{4}{1.5} \\times 0.125 = \\frac{1}{3}$。\n- 更新后的压力：$p^{(1)} = p^{(0)} + \\alpha_p\\, p' = 1 + 0.7 \\times \\frac{1}{3} = 1 + \\frac{7}{30} = \\frac{37}{30}$。\n- 更新后的速度：$u^{(1)} = (1 - \\alpha_u) u^{(0)} = (1 - 0.3) \\times 0.5 = 0.7 \\times 0.5 = 0.35$。\n\n**第 2 次迭代 ($k=1 \\rightarrow 2$)：**\n- 预测速度：$u^{*} = \\frac{2 - 1.5 \\times p^{(1)}}{4} = \\frac{2 - 1.5 \\times (37/30)}{4} = \\frac{2 - (3/2) \\times (37/30)}{4} = \\frac{2 - 37/20}{4} = \\frac{(40-37)/20}{4} = \\frac{3/20}{4} = \\frac{3}{80} = 0.0375$。\n- 压力修正：$p' = \\frac{4}{1.5} \\times 0.0375 = \\frac{8}{3} \\times \\frac{3}{80} = \\frac{1}{10} = 0.1$。\n- 更新后的压力：$p_{\\text{B}}^{(2)} = p^{(1)} + \\alpha_p\\, p' = \\frac{37}{30} + 0.7 \\times 0.1 = \\frac{37}{30} + 0.07 = \\frac{37}{30} + \\frac{7}{100} = \\frac{370 + 21}{300} = \\frac{391}{300}$。\n- 更新后的速度：$u_{\\text{B}}^{(2)} = (1 - \\alpha_u) u^{(1)} = (1 - 0.3) \\times 0.35 = 0.7 \\times 0.35 = 0.245$。\n\n**情况 B 在 $k=2$ 时的残差：**\n- 动量残差：$r_{m,\\text{B}}^{(2)} = a_u u_{\\text{B}}^{(2)} - d p_{\\text{B}}^{(2)} - h = 4(0.245) - 1.5(\\frac{391}{300}) - 2 = 0.98 - \\frac{391}{200} - 2 = 0.98 - 1.955 - 2 = -2.975$。\n- 连续性残差：$r_{c,\\text{B}}^{(2)} = u_{\\text{B}}^{(2)} = 0.245$。\n- 残差范数：$\\|r^{(2)}\\|_{2,\\text{B}} = \\sqrt{(-2.975)^2 + (0.245)^2} = \\sqrt{8.850625 + 0.060025} = \\sqrt{8.91065}$。\n\n**最终比率计算：**\n比率 $\\rho$ 计算如下：\n$$\\rho = \\frac{\\|r^{(2)}\\|_{2,\\text{B}}}{\\|r^{(2)}\\|_{2,\\text{A}}} = \\frac{\\sqrt{8.91065}}{\\sqrt{12.78265}} = \\sqrt{\\frac{8.91065}{12.78265}} \\approx \\sqrt{0.6970719} \\approx 0.8349083$$\n四舍五入到四位有效数字，结果是 $0.8349$。",
            "answer": "$$\\boxed{0.8349}$$"
        },
        {
            "introduction": "压力-速度耦合的原理不仅限于稳态问题。PISO算法将这些思想扩展到了瞬态流动，通常需要在单个时间步内进行多次修正以保持计算精度。本练习将指导你对一个控制体积完成一个完整的PISO循环，展示预测-修正框架如何应用于瞬态模拟。",
            "id": "3994160",
            "problem": "考虑一个在横截面积恒定的直通道中的瞬态、不可压缩启动流。一个长度为 $\\Delta x$、横截面积为 $A$ 的内部单一控制体 $P$，采用有限体积法进行建模，其中压力和速度存储在同一位置（同位网格）。流体的密度 $\\rho$ 和动力粘度 $\\mu$ 均为常数。动量方程采用一阶隐式时间离散，空间项采用中心差分格式。采用算子分裂压力隐式 (PISO) 算法，并在交界面上使用 Rhie–Chow 插值进行压力-速度耦合。控制体的左边界为给定速度的入口，右边界为固定绝对压力的出口。在时间步开始时，在猜测的压力场下，速度场不满足无散条件。\n\n给定一个时间步的以下数值数据：\n-   流体性质：$\\rho = 1.225 \\,\\mathrm{kg/m^3}$，$\\mu = 1.8 \\times 10^{-5} \\,\\mathrm{Pa \\cdot s}$。\n-   单元几何：$A = 1.0 \\times 10^{-2} \\,\\mathrm{m^2}$，$\\Delta x = 4.0 \\times 10^{-2} \\,\\mathrm{m}$，因此单元体积为 $V = A \\Delta x$。\n-   时间步长：$\\Delta t = 2.0 \\times 10^{-3} \\,\\mathrm{s}$。\n-   动量预测步在猜测压力场下的输出，得到控制体西侧和东侧交界面的速度为：$u_{W}^{*} = 0.36 \\,\\mathrm{m/s}$ 和 $u_{E}^{*} = 0.12 \\,\\mathrm{m/s}$。\n\n对这个单一控制体执行一个完整的 PISO 循环：\n1. 预测步：采用给定的预测交界面速度 $u_{W}^{*}$ 和 $u_{E}^{*}$。\n2. 第一次压力修正：通过从质量守恒的积分形式和与不可压缩 Navier–Stokes 方程的有限体积离散一致的 Rhie–Chow 交界面速度修正中，推导并求解压力修正方程，以在控制体内强制执行离散连续性。\n3. 动量修正：使用步骤 2 中获得的压力修正值来修正交界面速度。\n4. 第二次压力修正：使用修正后的交界面速度重新计算连续性残差，并执行第二次压力修正。\n\n对于压力修正方程，假设在两个边界上都采用均匀（零）压力修正，这与出口具有固定绝对压力和入口速度为给定值的情况一致。使用基本守恒定律和标准的 PISO 压力-速度耦合逻辑，计算完成对该单一控制体的第二次压力修正后的最终共同交界面速度。以 $\\mathrm{m/s}$ 为单位表示您的最终答案，并将结果四舍五入到四位有效数字。",
            "solution": "用户提供了一个关于单一控制体的计算流体动力学问题，需要使用算子分裂压力隐式 (PISO) 算法的一个循环来求解。\n\n## 问题验证\n\n### 步骤 1：提取给定条件\n-   **流动类型**：瞬态、不可压缩启动流。\n-   **几何**：直通道，恒定横截面积 $A = 1.0 \\times 10^{-2} \\,\\mathrm{m^2}$。\n-   **控制体 (CV)**：单一内部控制体，标记为 $P$，长度为 $\\Delta x = 4.0 \\times 10^{-2} \\,\\mathrm{m}$。\n-   **控制体体积**：$V = A \\Delta x$。\n-   **流体性质**：恒定密度 $\\rho = 1.225 \\,\\mathrm{kg/m^3}$，恒定动力粘度 $\\mu = 1.8 \\times 10^{-5} \\,\\mathrm{Pa \\cdot s}$。\n-   **数值方案**：\n    -   方法：有限体积法 (FVM)。\n    -   网格：压力和速度的同位存储。\n    -   时间离散：一阶隐式。\n    -   空间离散：空间项采用中心差分。\n    -   压力-速度耦合：PISO 算法与 Rhie–Chow 插值。\n-   **时间步长**：$\\Delta t = 2.0 \\times 10^{-3} \\,\\mathrm{s}$。\n-   **边界条件 (CV)**：左侧交界面（西，W）为入口，右侧交界面（东，E）为出口。\n-   **预测步输出**：时间步开始时的预测交界面速度为 $u_{W}^{*} = 0.36 \\,\\mathrm{m/s}$ 和 $u_{E}^{*} = 0.12 \\,\\mathrm{m/s}$。\n-   **压力修正边界条件**：对于包含该单一单元的计算域，其两个边界上的压力修正假定为均匀的（零）。\n-   **任务**：计算一个完整 PISO 循环（一个预测步，两个修正步）后的最终共同交界面速度，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的给定条件进行验证\n-   **科学依据**：该问题基于流体动力学的基本原理（不可压缩 Navier-Stokes 方程）和计算流体动力学中使用的标准数值方法（FVM、PISO、Rhie-Chow）。所有原理都已成熟。此标准已满足。\n-   **适定性**：该问题为压力修正方程提供了足够的数据和明确的边界条件，以确定在定义的 PISO 循环内速度修正的唯一解。该设置虽然简化为单个单元，但其结构能够产生唯一答案。此标准已满足。\n-   **客观性**：该问题使用精确、量化和无偏的语言陈述。所有术语均为 CFD 领域的标准术语。此标准已满足。\n-   **总体**：该问题没有科学缺陷、歧义或缺失信息，这些问题会妨碍严谨的求解。这是一个有效的、适定的计算流体动力学问题。\n\n### 步骤 3：结论与操作\n该问题是有效的。将提供详细的解决方案。\n\n## 解\n\nPISO 算法是一种用于瞬态、不可压缩流动的压力-速度耦合方案。它包括一个预测步和随后的两个或多个修正步，以在满足动量方程的同时强制执行质量守恒。我们将对给定的控制体执行一个完整的 PISO 循环（一个预测步，两个修正步）。\n\n**1. 预测步**\n问题提供了由动量预测步得出的交界面速度，该步骤使用了猜测的压力场。这些用上标 `*` 表示的速度尚未满足连续性方程。\n-   预测的西侧交界面速度：$u_{W}^{*} = 0.36 \\,\\mathrm{m/s}$\n-   预测的东侧交界面速度：$u_{E}^{*} = 0.12 \\,\\mathrm{m/s}$\n\n控制体 P 中的质量不平衡（或连续性残差）由净质量通量给出：\n$$ \\dot{m}^{*} = (\\rho A u)_{E}^{*} - (\\rho A u)_{W}^{*} = \\rho A (u_{E}^{*} - u_{W}^{*}) $$\n由于 $u_{E}^{*} \\neq u_{W}^{*}$，初始预测的速度场不满足无散条件。\n\n**2. 第一次压力修正 ($p'$)**\n第一个修正步旨在找到一个压力修正场 $p'$，使得修正后的速度场 $u^{**}$ 满足连续性方程。\n\n交界面上的速度修正与压力修正 $p'$ 的梯度有关。这种关系由离散化的动量方程导出。对于同位网格和一阶瞬态格式，交界面速度 $u_f$ 的更新由下式给出：\n$$ u_f = u_f^{*} - d_f (\\nabla p')_f $$\n其中 $d_f$ 是一个系数。对于给定的几何形状和离散格式，$d_f \\approx \\frac{\\Delta t}{\\rho \\Delta x_f}$，其中 $\\Delta x_f$ 是与交界面相邻的单元中心之间的距离。修正后的东侧和西侧交界面速度为：\n$$ u_{E}^{**} = u_{E}^{*} - \\frac{\\Delta t}{\\rho} \\left(\\frac{p'_{E_{cell}} - p'_{P}}{\\Delta x}\\right) $$\n$$ u_{W}^{**} = u_{W}^{*} - \\frac{\\Delta t}{\\rho} \\left(\\frac{p'_{P} - p'_{W_{cell}}}{\\Delta x}\\right) $$\n这里，$p'_{P}$ 是单元 P 中的压力修正值，$p'_{W_{cell}}$ 和 $p'_{E_{cell}}$ 是相邻（边界）单元中的压力修正值。问题陈述假设边界上的压力修正为均匀的，因此 $p'_{W_{cell}} = 0$ 和 $p'_{E_{cell}} = 0$。方程简化为：\n$$ u_{E}^{**} = u_{E}^{*} + \\frac{\\Delta t}{\\rho \\Delta x} p'_{P} $$\n$$ u_{W}^{**} = u_{W}^{*} - \\frac{\\Delta t}{\\rho \\Delta x} p'_{P} $$\n控制体中不可压缩流的连续性方程要求净质量通量为零。由于 $\\rho$ 和 $A$ 是常数，这意味着体积流量必须守恒：\n$$ A u_{E}^{**} - A u_{W}^{**} = 0 \\implies u_{E}^{**} - u_{W}^{**} = 0 $$\n代入修正后速度的表达式：\n$$ \\left( u_{E}^{*} + \\frac{\\Delta t}{\\rho \\Delta x} p'_{P} \\right) - \\left( u_{W}^{*} - \\frac{\\Delta t}{\\rho \\Delta x} p'_{P} \\right) = 0 $$\n$$ (u_{E}^{*} - u_{W}^{*}) + \\frac{2 \\Delta t}{\\rho \\Delta x} p'_{P} = 0 $$\n我们现在可以求解压力修正值 $p'_{P}$：\n$$ p'_{P} = - \\frac{\\rho \\Delta x}{2 \\Delta t} (u_{E}^{*} - u_{W}^{*}) $$\n代入给定的数值：\n-   $\\rho = 1.225 \\,\\mathrm{kg/m^3}$\n-   $\\Delta x = 4.0 \\times 10^{-2} \\,\\mathrm{m}$\n-   $\\Delta t = 2.0 \\times 10^{-3} \\,\\mathrm{s}$\n-   $u_{E}^{*} = 0.12 \\,\\mathrm{m/s}$\n-   $u_{W}^{*} = 0.36 \\,\\mathrm{m/s}$\n$$ p'_{P} = - \\frac{(1.225) \\cdot (4.0 \\times 10^{-2})}{2 \\cdot (2.0 \\times 10^{-3})} (0.12 - 0.36) $$\n$$ p'_{P} = - \\frac{0.049}{0.004} (-0.24) = -12.25 \\cdot (-0.24) = 2.94 \\,\\mathrm{Pa} $$\n\n**3. 第一次动量修正 ($u^{**}$)**\n使用计算出的 $p'_{P}$，我们修正交界面速度。设速度修正的大小为 $\\delta u$：\n$$ \\delta u = \\frac{\\Delta t}{\\rho \\Delta x} p'_{P} = \\frac{2.0 \\times 10^{-3}}{(1.225) \\cdot (4.0 \\times 10^{-2})} (2.94) = \\frac{0.002}{0.049} (2.94) = 0.12 \\,\\mathrm{m/s} $$\n或者，从 $p'_P$ 的方程中，我们有 $\\frac{\\Delta t}{\\rho \\Delta x} p'_{P} = -\\frac{1}{2}(u_E^* - u_W^*) = -\\frac{1}{2}(0.12 - 0.36) = 0.12 \\,\\mathrm{m/s}$。\n\n一次修正后的交界面速度为：\n$$ u_{E}^{**} = u_{E}^{*} + \\delta u = 0.12 + 0.12 = 0.24 \\,\\mathrm{m/s} $$\n$$ u_{W}^{**} = u_{W}^{*} - \\delta u = 0.36 - 0.12 = 0.24 \\,\\mathrm{m/s} $$\n正如预期的那样，$u_{E}^{**} = u_{W}^{**}$，因此速度场 $u^{**}$ 满足该控制体的连续性方程。第一次修正后的共同交界面速度为 $0.24 \\,\\mathrm{m/s}$。\n\n**4. 第二次压力修正 ($p''$) 及最终动量修正**\nPISO 算法包含第二个修正步。在一般多单元实现中，相邻单元中的第一次速度修正 $u'_{nb}$ 会改变进入单元 P 的对流和扩散通量（$H(u)$ 算子）。这种变化会产生一个新的、微小的连续性残差，而第二次压力修正 $p''$ 就是为了消除这个残差。$p''$ 方程的源项由动量算子的变化导出，即 $H(u^{**}) - H(u^{*})$。\n\n然而，在这个具体的问题设置中，我们被要求“使用修正后的交界面速度重新计算连续性残差”。修正后的交界面速度是 $u_{E}^{**}$ 和 $u_{W}^{**}$。连续性残差（净质量通量）是：\n$$ \\dot{m}^{**} = \\rho A (u_{E}^{**} - u_{W}^{**}) $$\n使用上一步计算的值：\n$$ \\dot{m}^{**} = \\rho A (0.24 - 0.24) = 0 $$\n第二次压力修正方程的形式与第一次相同，但未知数为 $p''$，源项为 $\\dot{m}^{**}$。\n$$ (u_{E}^{**} - u_{W}^{**}) + \\frac{2 \\Delta t}{\\rho \\Delta x} p''_{P} = 0 $$\n由于重新计算的连续性残差 $(u_{E}^{**} - u_{W}^{**})$ 为零，我们有：\n$$ 0 + \\frac{2 \\Delta t}{\\rho \\Delta x} p''_{P} = 0 \\implies p''_{P} = 0 $$\n零压力修正 $p''_{P}$ 导致第二步的速度修正为零。因此，最终速度与一次修正后的速度相同：\n$$ u_{E}^{final} = u_{E}^{**} $$\n$$ u_{W}^{final} = u_{W}^{**} $$\n对于这个单一控制体，在第二次压力修正后的最终共同交界面速度是 $0.24 \\,\\mathrm{m/s}$。问题要求将答案四舍五入到四位有效数字。\n\n最终共同交界面速度 = $0.2400 \\,\\mathrm{m/s}$。",
            "answer": "$$\n\\boxed{0.2400}\n$$"
        }
    ]
}