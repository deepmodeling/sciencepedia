{
    "hands_on_practices": [
        {
            "introduction": "掌握理论的最佳方式是付诸实践。本节的第一个练习将引导你掌握一项基本技能：从给定的坐标变换中计算度量张量。度量张量 $g_{ij}$ 是曲线坐标系中的“度量尺”，它描述了局部距离和角度，是理解网格特性的核心。通过计算并检查度量张量的非对角项，你将能亲手判断坐标系在某一点是否正交，这是评估网格质量的一个重要方面 。",
            "id": "3952790",
            "problem": "在计算流体动力学（CFD）中，用于拟合弯曲航空航天边界的结构化曲线映射由位置向量 $\\mathbf{x}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta,\\zeta), y(\\xi,\\eta,\\zeta), z(\\xi,\\eta,\\zeta)\\big)$ 给出，其分量为\n$$\nx(\\xi,\\eta,\\zeta) = \\xi + \\eta \\zeta,\\quad\ny(\\xi,\\eta,\\zeta) = \\eta + \\xi \\zeta,\\quad\nz(\\xi,\\eta,\\zeta) = \\zeta + \\xi \\eta.\n$$\n在计算点 $(\\xi,\\eta,\\zeta) = (\\,1,\\,-2,\\,1\\,)$ 处，使用曲线坐标中协变基向量和度量张量的基本定义，计算该点处的所有度量分量 $g_{ij}$，并通过检查非对角度量分量来确定坐标线在此处是否相互正交。为便于评分，请报告一个编码此正交性检查的标量：\n$$\nS \\equiv g_{12}^{2} + g_{13}^{2} + g_{23}^{2}.\n$$\n若 $S = 0$，则坐标系在该点是正交的；若 $S \\neq 0$，则不是。请提供 $S$ 的值作为最终答案。无需四舍五入。",
            "solution": "该问题是有效的，因为它在应用于计算流体动力学的微分几何领域提出了一个适定且有科学依据的问题。它自成体系、客观，并且没有任何科学或数学上的缺陷。\n\n该问题要求计算一个标量 $S$，它作为一个给定曲线坐标系在特定点正交性的指标。曲线坐标用 $(\\xi, \\eta, \\zeta)$ 表示，笛卡尔坐标为 $(x, y, z)$。从计算空间 $(\\xi, \\eta, \\zeta)$ 到物理空间 $(x, y, z)$ 的变换由位置向量 $\\mathbf{x}(\\xi,\\eta,\\zeta) = x(\\xi,\\eta,\\zeta)\\mathbf{i} + y(\\xi,\\eta,\\zeta)\\mathbf{j} + z(\\xi,\\eta,\\zeta)\\mathbf{k}$ 定义，其中 $\\mathbf{i}$、$\\mathbf{j}$ 和 $\\mathbf{k}$ 是标准笛卡尔基向量。给定的分量函数是：\n$$\nx(\\xi,\\eta,\\zeta) = \\xi + \\eta \\zeta\n$$\n$$\ny(\\xi,\\eta,\\zeta) = \\eta + \\xi \\zeta\n$$\n$$\nz(\\xi,\\eta,\\zeta) = \\zeta + \\xi \\eta\n$$\n描述曲线坐标系局部性质的基本量是协变基向量 $\\mathbf{g}_1$、$\\mathbf{g}_2$ 和 $\\mathbf{g}_3$。这些向量与坐标线相切，并定义为位置向量 $\\mathbf{x}$ 对每个曲线坐标的偏导数。我们将曲线坐标表示为 $(q^1, q^2, q^3) = (\\xi, \\eta, \\zeta)$。协变基向量为：\n$$\n\\mathbf{g}_i = \\frac{\\partial \\mathbf{x}}{\\partial q^i}\n$$\n对于我们的系统，具体为：\n$$\n\\mathbf{g}_1 = \\frac{\\partial \\mathbf{x}}{\\partial \\xi} = \\frac{\\partial x}{\\partial \\xi}\\mathbf{i} + \\frac{\\partial y}{\\partial \\xi}\\mathbf{j} + \\frac{\\partial z}{\\partial \\xi}\\mathbf{k}\n$$\n$$\n\\mathbf{g}_2 = \\frac{\\partial \\mathbf{x}}{\\partial \\eta} = \\frac{\\partial x}{\\partial \\eta}\\mathbf{i} + \\frac{\\partial y}{\\partial \\eta}\\mathbf{j} + \\frac{\\partial z}{\\partial \\eta}\\mathbf{k}\n$$\n$$\n\\mathbf{g}_3 = \\frac{\\partial \\mathbf{x}}{\\partial \\zeta} = \\frac{\\partial x}{\\partial \\zeta}\\mathbf{i} + \\frac{\\partial y}{\\partial \\zeta}\\mathbf{j} + \\frac{\\partial z}{\\partial \\zeta}\\mathbf{k}\n$$\n我们根据给定的变换方程计算必要的偏导数：\n$$\n\\begin{array}{ccc}\n\\frac{\\partial x}{\\partial \\xi} = 1 & \\frac{\\partial x}{\\partial \\eta} = \\zeta & \\frac{\\partial x}{\\partial \\zeta} = \\eta \\\\\n\\frac{\\partial y}{\\partial \\xi} = \\zeta & \\frac{\\partial y}{\\partial \\eta} = 1 & \\frac{\\partial y}{\\partial \\zeta} = \\xi \\\\\n\\frac{\\partial z}{\\partial \\xi} = \\eta & \\frac{\\partial z}{\\partial \\eta} = \\xi & \\frac{\\partial z}{\\partial \\zeta} = 1\n\\end{array}\n$$\n将这些代入基向量的定义中，我们得到它们关于 $(\\xi, \\eta, \\zeta)$ 的一般表达式：\n$$\n\\mathbf{g}_1 = 1\\mathbf{i} + \\zeta\\mathbf{j} + \\eta\\mathbf{k} = (1, \\zeta, \\eta)\n$$\n$$\n\\mathbf{g}_2 = \\zeta\\mathbf{i} + 1\\mathbf{j} + \\xi\\mathbf{k} = (\\zeta, 1, \\xi)\n$$\n$$\n\\mathbf{g}_3 = \\eta\\mathbf{i} + \\xi\\mathbf{j} + 1\\mathbf{k} = (\\eta, \\xi, 1)\n$$\n我们被要求在特定的计算点 $(\\xi,\\eta,\\zeta) = (\\,1,\\,-2,\\,1\\,)$ 处计算这些量。代入这些值：\n$$\n\\mathbf{g}_1(\\,1,\\,-2,\\,1\\,) = (1, 1, -2)\n$$\n$$\n\\mathbf{g}_2(\\,1,\\,-2,\\,1\\,) = (1, 1, 1)\n$$\n$$\n\\mathbf{g}_3(\\,1,\\,-2,\\,1\\,) = (-2, 1, 1)\n$$\n协变度量张量的分量 $g_{ij}$ 由协变基向量的标量积（点积）定义：\n$$\ng_{ij} = \\mathbf{g}_i \\cdot \\mathbf{g}_j\n$$\n如果一个坐标系的基向量在某一点相互正交，那么该坐标系在该点是局部正交的。这个几何条件等价于度量张量的非对角分量为零的代数条件，即对于所有 $i \\neq j$，$g_{ij} = 0$。问题要求我们计算量 $S \\equiv g_{12}^{2} + g_{13}^{2} + g_{23}^{2}$，它封装了这种正交性检查。我们继续计算在点 $(\\,1,\\,-2,\\,1\\,)$ 处必要的非对角度量分量：\n$$\ng_{12} = \\mathbf{g}_1 \\cdot \\mathbf{g}_2 = (1)(1) + (1)(1) + (-2)(1) = 1 + 1 - 2 = 0\n$$\n$$\ng_{13} = \\mathbf{g}_1 \\cdot \\mathbf{g}_3 = (1)(-2) + (1)(1) + (-2)(1) = -2 + 1 - 2 = -3\n$$\n$$\ng_{23} = \\mathbf{g}_2 \\cdot \\mathbf{g}_3 = (1)(-2) + (1)(1) + (1)(1) = -2 + 1 + 1 = 0\n$$\n由于 $g_{13} = -3 \\neq 0$，坐标系在指定点不是相互正交的。对应于 $\\xi$ 和 $\\zeta$ 的坐标线彼此不垂直。现在，我们计算最终的标量 $S$：\n$$\nS = g_{12}^{2} + g_{13}^{2} + g_{23}^{2}\n$$\n代入计算出的度量分量值：\n$$\nS = (0)^{2} + (-3)^{2} + (0)^{2} = 0 + 9 + 0 = 9\n$$\n$S$ 的值为 $9$，非零，这证实了坐标系在点 $(\\,1,\\,-2,\\,1\\,)$ 不是正交的。",
            "answer": "$$\n\\boxed{9}\n$$"
        },
        {
            "introduction": "在掌握了度量张量的基本计算后，下一步是理解这些数学构件的物理意义。雅可比行列式 $J$ 并非一个抽象的数学概念，而是连接计算空间与物理空间的关键桥梁，它代表了体积（或面积）元素的局部缩放因子。本练习将通过一个二维到三维的嵌入映射，让你推导并计算面积元素，从而深刻理解雅可比行列式在守恒型方程坐标变换中的核心作用 。",
            "id": "3952786",
            "problem": "在计算流体力学 (CFD) 的贴体坐标系公式中，使用曲线坐标将计算域 $(\\xi,\\eta)$ 映射到物理平面 $(x,y)$，而诸如协变基向量和雅可比行列式等微分几何构造则控制着几何度量的变换。考虑一个从计算空间到物理空间的光滑二维映射，该映射由参数化浸入 $\\mathbf{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta)\\big)$ 定义，并通过平凡扩张 $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta), \\zeta\\big)$ 将其嵌入三维空间。协变基向量定义为 $\\mathbf{a}_{i} = \\partial \\mathbf{X}/\\partial q^{i}$，其中 $q^{1}=\\xi$、$q^{2}=\\eta$ 和 $q^{3}=\\zeta$。变换的雅可比行列式 $J$ 由标量三重积 $J = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times\\mathbf{a}_{3})$ 定义。\n\n仅从这些核心定义和向量微积分出发，首先推导在常数 $\\zeta$ 曲面上与计算元 $d\\xi\\,d\\eta$ 相关联的物理面元的表达式，并用 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$ 和 $J$ 表示。然后，对于特定的光滑映射\n$$\nx(\\xi,\\eta) = \\xi^{2} - \\eta, \\qquad y(\\xi,\\eta) = \\xi\\,\\eta,\n$$\n嵌入为 $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(\\xi^{2} - \\eta,\\ \\xi\\,\\eta,\\ \\zeta\\big)$，计算曲面度量因子的大小 $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}||$ 作为 $\\xi$ 和 $\\eta$ 的函数的解析表达式（闭合形式）。\n\n将最终答案表示为关于 $\\xi$ 和 $\\eta$ 的单个解析表达式。最终答案中不应包含微分。无需四舍五入。",
            "solution": "必须首先严格验证问题陈述。\n\n### 第一步：提取已知条件\n- 计算域坐标：$(\\xi,\\eta)$。\n- 物理平面坐标：$(x,y)$。\n- 二维映射：$\\mathbf{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta)\\big)$。\n- 三维嵌入：$\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta), \\zeta\\big)$。\n- 协变基向量：$\\mathbf{a}_{i} = \\partial \\mathbf{X}/\\partial q^{i}$，对于坐标系 $(q^{1}, q^{2}, q^{3}) = (\\xi, \\eta, \\zeta)$。\n- 雅可比行列式：$J = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times\\mathbf{a}_{3})$。\n- 特定映射函数：$x(\\xi,\\eta) = \\xi^{2} - \\eta$ 和 $y(\\xi,\\eta) = \\xi\\,\\eta$。\n- 特定三维嵌入：$\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(\\xi^{2} - \\eta,\\ \\xi\\,\\eta,\\ \\zeta\\big)$。\n- 任务1：推导在常数 $\\zeta$ 曲面上与计算元 $d\\xi\\,d\\eta$ 相关联的物理面元 $dS$ 的表达式，并用 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$ 和 $J$ 表示。\n- 任务2：对于特定映射，计算曲面度量因子的大小 $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}||$ 作为 $\\xi$ 和 $\\eta$ 的函数的解析表达式。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，它基于微分几何和向量微积分在计算流体力学领域的标准定义。问题提法恰当，提供了得出唯一解所需的所有定义和函数。语言客观且正式。问题是自洽的、一致的，并且不违反任何基本原则。任务具体且可形式化。\n\n### 第三步：结论与行动\n该问题被认定为有效。将提供完整解答。\n\n### 求解推导\n\n按要求，该问题分两部分解决。\n\n**第一部分：物理面元的推导**\n\n常数 $\\zeta$ 曲面是嵌入三维空间中的二维流形，由坐标 $\\xi$ 和 $\\eta$ 参数化。该曲面上的位置向量可以写为 $\\mathbf{r}(\\xi, \\eta) = \\mathbf{X}(\\xi, \\eta, \\zeta=\\text{const})$。\n\n该曲面上的无穷小位移向量由 $\\mathbf{r}$ 的全微分给出：\n$$d\\mathbf{r} = \\frac{\\partial \\mathbf{r}}{\\partial \\xi} d\\xi + \\frac{\\partial \\mathbf{r}}{\\partial \\eta} d\\eta$$\n偏导数 $\\frac{\\partial \\mathbf{r}}{\\partial \\xi}$ 和 $\\frac{\\partial \\mathbf{r}}{\\partial \\eta}$ 分别表示曲面上坐标曲线 $\\eta=\\text{const}$ 和 $\\xi=\\text{const}$ 的切向量。\n\n根据问题的核心定义，协变基向量为 $\\mathbf{a}_{i} = \\frac{\\partial \\mathbf{X}}{\\partial q^{i}}$。对于我们的坐标系 $(q^{1}, q^{2}, q^{3}) = (\\xi, \\eta, \\zeta)$，我们有：\n$$ \\mathbf{a}_{1} = \\frac{\\partial \\mathbf{X}}{\\partial \\xi} \\quad \\text{和} \\quad \\mathbf{a}_{2} = \\frac{\\partial \\mathbf{X}}{\\partial \\eta} $$\n由于 $\\mathbf{X}$ 的 $\\zeta$ 分量与 $\\xi$ 和 $\\eta$ 无关，并且在我们所关注的曲面上 $\\zeta$ 保持不变，因此曲面的切向量与前两个协变基向量相同：\n$$ \\frac{\\partial \\mathbf{r}}{\\partial \\xi} = \\mathbf{a}_{1} \\quad \\text{和} \\quad \\frac{\\partial \\mathbf{r}}{\\partial \\eta} = \\mathbf{a}_{2} $$\n无穷小物理面元 $dS$ 对应于由两个无穷小位移向量 $\\mathbf{a}_{1}d\\xi$ 和 $\\mathbf{a}_{2}d\\eta$ 张成的平行四边形的面积。该平行四边形的面积是这两个向量叉积的模：\n$$ dS = ||(\\mathbf{a}_{1}d\\xi) \\times (\\mathbf{a}_{2}d\\eta)|| = ||\\mathbf{a}_{1} \\times \\mathbf{a}_{2}|| d\\xi d\\eta $$\n这用 $\\mathbf{a}_{1}$ 和 $\\mathbf{a}_{2}$ 表达了面元。现在，我们必须将其与雅可比行列式 $J$ 联系起来。\n\n雅可比行列式 $J$ 定义为 $J = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times\\mathbf{a}_{3})$。这是标量三重积，表示由三个基向量张成的平行六面体的体积。它也可以通过计算以基向量分量为行（或列）的矩阵的行列式来得到。\n\n让我们计算给定嵌入 $\\mathbf{X}(\\xi,\\eta,\\zeta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta), \\zeta\\big)$ 的基向量。令 $x_\\xi = \\frac{\\partial x}{\\partial \\xi}$，$y_\\eta = \\frac{\\partial y}{\\partial \\eta}$，依此类推。\n$$ \\mathbf{a}_{1} = \\frac{\\partial \\mathbf{X}}{\\partial \\xi} = \\left( \\frac{\\partial x}{\\partial \\xi}, \\frac{\\partial y}{\\partial \\xi}, \\frac{\\partial \\zeta}{\\partial \\xi} \\right) = (x_{\\xi}, y_{\\xi}, 0) $$\n$$ \\mathbf{a}_{2} = \\frac{\\partial \\mathbf{X}}{\\partial \\eta} = \\left( \\frac{\\partial x}{\\partial \\eta}, \\frac{\\partial y}{\\partial \\eta}, \\frac{\\partial \\zeta}{\\partial \\eta} \\right) = (x_{\\eta}, y_{\\eta}, 0) $$\n$$ \\mathbf{a}_{3} = \\frac{\\partial \\mathbf{X}}{\\partial \\zeta} = \\left( \\frac{\\partial x}{\\partial \\zeta}, \\frac{\\partial y}{\\partial \\zeta}, \\frac{\\partial \\zeta}{\\partial \\zeta} \\right) = (0, 0, 1) = \\mathbf{k} $$\n叉积 $\\mathbf{a}_{1} \\times \\mathbf{a}_{2}$ 为：\n$$ \\mathbf{a}_{1} \\times \\mathbf{a}_{2} = \\det \\begin{pmatrix} \\mathbf{i} & \\mathbf{j} & \\mathbf{k} \\\\ x_{\\xi} & y_{\\xi} & 0 \\\\ x_{\\eta} & y_{\\eta} & 0 \\end{pmatrix} = (x_{\\xi}y_{\\eta} - y_{\\xi}x_{\\eta})\\mathbf{k} $$\n雅可比行列式 $J$ 为：\n$$ J = \\mathbf{a}_{1} \\cdot (\\mathbf{a}_{2} \\times \\mathbf{a}_{3}) = \\det(\\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3}) = \\det \\begin{pmatrix} x_{\\xi} & y_{\\xi} & 0 \\\\ x_{\\eta} & y_{\\eta} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = (1) \\cdot (x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi}) = x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi} $$\n比较这些表达式，我们看到对于这种特定类型的嵌入，$\\mathbf{a}_{1} \\times \\mathbf{a}_{2} = J\\mathbf{k}$。\n因此，其模为：\n$$ ||\\mathbf{a}_{1} \\times \\mathbf{a}_{2}|| = ||J\\mathbf{k}|| = |J| \\cdot ||\\mathbf{k}|| = |J| \\cdot 1 = |J| $$\n将此代回面元 $dS$ 的表达式中：\n$$ dS = |J| d\\xi d\\eta $$\n这就提供了用雅可比行列式 $J$ 表示的物理面元的所需表达式，而 $J$ 本身由 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$ 和 $\\mathbf{a}_{3}$ 定义。\n\n**第二部分：针对特定映射的计算**\n\n第二个任务是计算特定映射的曲面度量因子的大小 $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}||$：\n$$ x(\\xi,\\eta) = \\xi^{2} - \\eta $$\n$$ y(\\xi,\\eta) = \\xi\\,\\eta $$\n从第一部分我们已经确定，对于给定的嵌入结构，有 $||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}|| = |J|$，其中 $J = x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi}$。\n\n我们首先计算所需的偏导数：\n$$ x_{\\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi^{2} - \\eta) = 2\\xi $$\n$$ x_{\\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi^{2} - \\eta) = -1 $$\n$$ y_{\\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi\\,\\eta) = \\eta $$\n$$ y_{\\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi\\,\\eta) = \\xi $$\n现在，我们将这些导数代入雅可比行列式 $J$ 的表达式中：\n$$ J = x_{\\xi}y_{\\eta} - x_{\\eta}y_{\\xi} = (2\\xi)(\\xi) - (-1)(\\eta) $$\n$$ J = 2\\xi^{2} + \\eta $$\n曲面度量因子的大小是雅可比行列式的绝对值：\n$$ ||\\mathbf{a}_{1}\\times\\mathbf{a}_{2}|| = |J| = |2\\xi^{2} + \\eta| $$\n这就是曲面度量因子大小作为 $\\xi$ 和 $\\eta$ 函数的最终解析表达式。",
            "answer": "$$\n\\boxed{|2\\xi^2 + \\eta|}\n$$"
        },
        {
            "introduction": "本节的高级练习将理论与计算流体力学 (CFD) 数值方法的核心问题联系起来。在离散控制方程时，一个看似微小的选择——例如在网格节点还是在单元面上计算度量项——可能对模拟的准确性产生深远影响。本练习将通过泰勒级数分析，揭示非守恒格式如何引入“几何守恒律”误差，从而强调在构建高保真CFD求解器时，采用守恒离散格式的重要性 。",
            "id": "3952773",
            "problem": "考虑与计算流体力学 (CFD) 相关的一维稳态扩散算子在曲线坐标映射中的形式。设物理坐标 $x$ 通过光滑、不依赖于时间的映射 $x(\\xi) = \\xi + \\varepsilon \\sin \\xi$ 从计算坐标 $\\xi$ 映射而来，其中 $|\\varepsilon| < 1$ 是一个小参数，且域在 $\\xi$ 方向上是 $2\\pi$ 周期的。雅可比行列式为 $J(\\xi) = \\frac{dx}{d\\xi} = 1 + \\varepsilon \\cos \\xi$。对于一个具有恒定热扩散系数 $\\kappa = 1$ 的标量场 $q(x)$，物理扩散算子为 $\\frac{d}{dx}\\left(\\kappa \\frac{dq}{dx}\\right)$。\n\n使用基于链式法则的标准坐标变换，该算子的守恒计算形式可以写为\n$$\n\\mathcal{L}[q](\\xi) = \\frac{1}{J(\\xi)} \\frac{d}{d\\xi} \\left( \\frac{1}{J(\\xi)} \\frac{dq}{d\\xi} \\right).\n$$\n\n现在，在间距为 $\\Delta \\xi$ 的均匀计算网格 $\\{\\xi_i\\}$ 上进行离散化。在节点 $i$ 处定义以下两种二阶中心半离散近似：\n- 守恒的、基于面的形式（通量在面上求值）：\n$$\n\\mathcal{L}_{c}[q]_i = \\frac{1}{J_i \\, \\Delta \\xi^2} \\left[ \\left(\\frac{1}{J}\\right)_{i+\\frac{1}{2}} \\left(q_{i+1} - q_i\\right) - \\left(\\frac{1}{J}\\right)_{i-\\frac{1}{2}} \\left(q_i - q_{i-1}\\right) \\right],\n$$\n其中 $\\left(\\frac{1}{J}\\right)_{i\\pm\\frac{1}{2}}$ 表示在面 $\\xi_{i\\pm\\frac{1}{2}} = \\xi_i \\pm \\frac{1}{2}\\Delta \\xi$ 处求值的度量因子。\n- 非守恒的、基于节点的度量形式（度量在节点上求值，而差分使用面相邻的值）：\n$$\n\\mathcal{L}_{nc}[q]_i = \\frac{1}{J_i^2} \\, \\frac{q_{i+1} - 2 q_i + q_{i-1}}{\\Delta \\xi^2}.\n$$\n\n设制造的光滑场为 $q(\\xi) = \\sin(\\beta \\xi)$，其中整数 $\\beta \\geq 1$。定义将这两个半离散算子应用于精确解 $q$ 时的逐点差异为\n$$\nE_i \\equiv \\left(\\mathcal{L}_{nc}[q]_i - \\mathcal{L}_{c}[q]_i\\right).\n$$\n\n从变换后的守恒算子和上述定义出发，使用关于 $\\xi_i$ 的泰勒展开，推导 $E_i$ 在 $\\Delta \\xi$ 幂次下的领头阶渐近表达式。保留所有阶数直到并包括 $\\Delta \\xi^{0}$ 的项（即，忽略 $\\mathcal{O}(\\Delta \\xi^{2})$ 及更高阶的项）。将您的最终答案表示为仅含 $\\varepsilon$、$\\beta$ 和 $\\xi_i$ 的单一简化解析表达式。不需要进行数值舍入，也不涉及任何单位。您的最终答案必须是单一的封闭形式解析表达式。",
            "solution": "用户希望找到一个扩散算子的两种半离散近似之间的差异 $E_i$ 的领头阶渐近表达式。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n- **坐标映射：** $x(\\xi) = \\xi + \\varepsilon \\sin \\xi$，其中 $|\\varepsilon| < 1$。\n- **雅可比行列式：** $J(\\xi) = \\frac{dx}{d\\xi} = 1 + \\varepsilon \\cos \\xi$。其倒数记为 $f(\\xi) = 1/J(\\xi)$。\n- **域：** 在 $\\xi$ 方向上是 $2\\pi$ 周期的。\n- **物理算子：** $\\frac{d}{dx}\\left(\\kappa \\frac{dq}{dx}\\right)$，其中 $\\kappa = 1$。\n- **变换后的算子：** $\\mathcal{L}[q](\\xi) = \\frac{1}{J(\\xi)} \\frac{d}{d\\xi} \\left( \\frac{1}{J(\\xi)} \\frac{dq}{d\\xi} \\right)$。\n- **计算网格：** 均匀网格 $\\{\\xi_i\\}$，间距为 $\\Delta \\xi$。$\\xi_{i\\pm1} = \\xi_i \\pm \\Delta\\xi$，$\\xi_{i\\pm1/2} = \\xi_i \\pm \\frac{1}{2}\\Delta\\xi$。\n- **守恒离散化：** $\\mathcal{L}_{c}[q]_i = \\frac{1}{J_i \\, \\Delta \\xi^2} \\left[ \\left(\\frac{1}{J}\\right)_{i+\\frac{1}{2}} (q_{i+1} - q_i) - \\left(\\frac{1}{J}\\right)_{i-\\frac{1}{2}} (q_i - q_{i-1}) \\right]$。\n- **非守恒离散化：** $\\mathcal{L}_{nc}[q]_i = \\frac{1}{J_i^2} \\, \\frac{q_{i+1} - 2 q_i + q_{i-1}}{\\Delta \\xi^2}$。\n- **制造场：** $q(\\xi) = \\sin(\\beta \\xi)$，其中整数 $\\beta \\geq 1$。\n- **差异：** $E_i \\equiv \\mathcal{L}_{nc}[q]_i - \\mathcal{L}_{c}[q]_i$。\n- **目标：** 找到 $E_i$ 在 $\\Delta \\xi \\to 0$ 时的领头阶渐近表达式，保留至 $\\mathcal{O}(\\Delta \\xi^0)$ 阶的项。\n\n**1.2. 使用提取的已知条件进行验证**\n该问题具有科学依据，是适定的、客观的。它涉及数值分析和计算流体力学 (CFD) 的标准技术，特别是对非均匀网格上有限差分格式的分析。给定的坐标变换是生成拉伸网格的一个常见例子。守恒和非守恒格式的定义是标准的。通过泰勒展开找到领头阶差异是分析数值格式的形式精度和性质的经典方法。该问题是自洽的，没有矛盾；条件 $|\\varepsilon| < 1$ 确保雅可比行列式 $J(\\xi) = 1 + \\varepsilon \\cos\\xi$ 始终为正，因此映射是非奇异的。\n\n**1.3. 结论与行动**\n问题有效。将推导完整解法。\n\n### 步骤2：解法推导\n\n目标是通过在 $\\xi_i$ 周围进行泰勒级数展开，找到 $E_i = \\mathcal{L}_{nc}[q]_i - \\mathcal{L}_{c}[q]_i$ 的领头项。我们将展开两个算子并求其差值。设 $q_i, q'_i, q''_i, \\dots$ 表示函数 $q(\\xi)$ 及其在 $\\xi_i$ 处的导数。类似地，$J_i, J'_i, \\dots$ 是 $J(\\xi)$ 在 $\\xi_i$ 处的值。我们还使用记号 $f(\\xi) = 1/J(\\xi)$，所以 $f_i = 1/J_i$。\n\n**非守恒算子 $\\mathcal{L}_{nc}[q]_i$ 的分析**\n\n非守恒算子包含二阶导数的标准二阶中心差分近似：\n$$\n\\frac{q_{i+1} - 2 q_i + q_{i-1}}{\\Delta \\xi^2}\n$$\n$q_{i+1}$ 和 $q_{i-1}$ 在 $\\xi_i$ 周围的泰勒展开为：\n$$\nq_{i+1} = q(\\xi_i + \\Delta\\xi) = q_i + \\Delta\\xi q'_i + \\frac{\\Delta\\xi^2}{2} q''_i + \\frac{\\Delta\\xi^3}{6} q'''_i + \\frac{\\Delta\\xi^4}{24} q''''_i + \\mathcal{O}(\\Delta\\xi^5)\n$$\n$$\nq_{i-1} = q(\\xi_i - \\Delta\\xi) = q_i - \\Delta\\xi q'_i + \\frac{\\Delta\\xi^2}{2} q''_i - \\frac{\\Delta\\xi^3}{6} q'''_i + \\frac{\\Delta\\xi^4}{24} q''''_i + \\mathcal{O}(\\Delta\\xi^5)\n$$\n将这些代入有限差分公式，得到：\n$$\n\\frac{q_{i+1} - 2 q_i + q_{i-1}}{\\Delta \\xi^2} = \\frac{(\\Delta\\xi^2 q''_i + \\frac{\\Delta\\xi^4}{12} q''''_i + \\mathcal{O}(\\Delta\\xi^6))}{\\Delta \\xi^2} = q''_i + \\frac{\\Delta\\xi^2}{12} q''''_i + \\mathcal{O}(\\Delta\\xi^4)\n$$\n因此，$\\mathcal{L}_{nc}[q]_i$ 的展开式为：\n$$\n\\mathcal{L}_{nc}[q]_i = \\frac{1}{J_i^2} \\left( q''_i + \\mathcal{O}(\\Delta\\xi^2) \\right) = f_i^2 q''_i + \\mathcal{O}(\\Delta\\xi^2)\n$$\n\n**守恒算子 $\\mathcal{L}_{c}[q]_i$ 的分析**\n\n守恒算子是连续算子 $\\mathcal{L}[q] = f(\\xi) \\frac{d}{d\\xi}(f(\\xi)q'(\\xi))$ 的一个近似。\n让我们首先使用乘法法则展开连续算子：\n$$\n\\mathcal{L}[q](\\xi) = f(\\xi) \\left( f'(\\xi)q'(\\xi) + f(\\xi)q''(\\xi) \\right) = f(\\xi)f'(\\xi)q'(\\xi) + (f(\\xi))^2 q''(\\xi)\n$$\n守恒离散化 $\\mathcal{L}_{c}[q]_i$ 被设计成在 $\\xi_i$ 处对这个完整表达式的一个相容的二阶近似。我们来验证这一点。\n$\\mathcal{L}_{c}[q]_i$ 是构造成在单元面 $\\xi_{i\\pm1/2}$ 上求值的通量的中心差分。\n项 $\\left(\\frac{1}{J}\\right)_{i+1/2} \\frac{q_{i+1}-q_i}{\\Delta\\xi}$ 是通量 $g(\\xi) = f(\\xi)q'(\\xi)$ 在 $\\xi_{i+1/2}$ 处的二阶近似。\n整个表达式 $\\frac{1}{J_i \\Delta\\xi} \\left[ g_{i+1/2}^{\\text{approx}} - g_{i-1/2}^{\\text{approx}} \\right]$ 是 $\\frac{1}{J_i} \\frac{d g}{d\\xi}\\Big|_{\\xi_i}$ 的一个二阶近似。\n因此，$\\mathcal{L}_{c}[q]_i$ 的泰勒展开必定是：\n$$\n\\mathcal{L}_{c}[q]_i = \\mathcal{L}[q](\\xi_i) + \\mathcal{O}(\\Delta\\xi^2)\n$$\n$$\n\\mathcal{L}_{c}[q]_i = f_i f'_i q'_i + f_i^2 q''_i + \\mathcal{O}(\\Delta\\xi^2)\n$$\n\n**计算差异 $E_i$**\n\n现在我们可以通过减去两个算子的展开式来计算差异 $E_i$ 的领头项。问题要求结果精确到 $\\Delta\\xi^0$ 阶。\n\n$$\nE_i = \\mathcal{L}_{nc}[q]_i - \\mathcal{L}_{c}[q]_i\n$$\n$$\nE_i = \\left( f_i^2 q''_i + \\mathcal{O}(\\Delta\\xi^2) \\right) - \\left( f_i f'_i q'_i + f_i^2 q''_i + \\mathcal{O}(\\Delta\\xi^2) \\right)\n$$\n$$\nE_i = - f_i f'_i q'_i + \\mathcal{O}(\\Delta\\xi^2)\n$$\n领头项的阶数为 $\\Delta\\xi^0$，即 $-f_i f'_i q'_i$。该项表示由非守恒格式引入的几何守恒误差，该格式忽略了由度量空间变化引起的项。\n\n**代入具体函数**\n\n最后，我们代入给定的度量和解场的表达式。\n函数 $f(\\xi)$ 是雅可比行列式的倒数：\n$$\nf(\\xi) = \\frac{1}{J(\\xi)} = \\frac{1}{1 + \\varepsilon \\cos \\xi} = (1 + \\varepsilon \\cos \\xi)^{-1}\n$$\n它关于 $\\xi$ 的导数是：\n$$\nf'(\\xi) = -1 (1 + \\varepsilon \\cos \\xi)^{-2} (-\\varepsilon \\sin \\xi) = \\frac{\\varepsilon \\sin \\xi}{(1 + \\varepsilon \\cos \\xi)^2}\n$$\n制造的解场是 $q(\\xi) = \\sin(\\beta \\xi)$。其导数是：\n$$\nq'(\\xi) = \\beta \\cos(\\beta \\xi)\n$$\n现在，我们在 $\\xi_i$ 处对这些进行求值，并代入 $E_i$ 的表达式中：\n$$\nE_i \\approx -f_i f'_i q'_i = - \\left( \\frac{1}{1 + \\varepsilon \\cos \\xi_i} \\right) \\left( \\frac{\\varepsilon \\sin \\xi_i}{(1 + \\varepsilon \\cos \\xi_i)^2} \\right) \\left( \\beta \\cos(\\beta \\xi_i) \\right)\n$$\n合并各项得到最终的简化表达式：\n$$\nE_i \\approx -\\frac{\\varepsilon \\beta \\sin(\\xi_i) \\cos(\\beta \\xi_i)}{(1 + \\varepsilon \\cos \\xi_i)^3}\n$$\n这是差异的领头阶渐近表达式，其阶数为 $\\Delta\\xi^0$。",
            "answer": "$$\\boxed{-\\frac{\\varepsilon \\beta \\sin(\\xi_i) \\cos(\\beta \\xi_i)}{(1 + \\varepsilon \\cos \\xi_i)^3}}$$"
        }
    ]
}