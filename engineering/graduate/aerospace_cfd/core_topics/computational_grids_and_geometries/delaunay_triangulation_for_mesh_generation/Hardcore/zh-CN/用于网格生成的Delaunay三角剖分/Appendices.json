{
    "hands_on_practices": [
        {
            "introduction": "任何稳健的网格生成方案都始于对底层几何原理的坚实掌握。第一个练习将邀请您从第一性原理出发，利用基本的“空外接圆”性质构建一个Delaunay三角剖分。通过这一过程，您还将探索它与Voronoi图的紧密联系，从而巩固对它们之间基本对偶性的理解 。",
            "id": "3953020",
            "problem": "在计算流体力学 (CFD) 的二维网格生成中，一种常用策略是放置种子点并构建一个通过避免细长三角形来保证数值稳定性的三角剖分。考虑一个靠近翼身连接处的平面横截面，其中有 $4$ 个候选网格种子点，坐标分别为 $P_A=(0,0)$, $P_B=(3,0)$, $P_C=(1,2)$ 和 $P_D=(2,3)$，单位为米。仅使用以下基本定义：(i) Delaunay 三角剖分是一种三角剖分，其中每个三角形的外接圆内部不严格包含任何其他点；(ii) Voronoi 图将平面划分为多个区域，每个区域内的点到给定点的距离比到任何其他点的距离都近。请完成以下任务：\n\n1. 从基本原理出发，通过判断由这些点形成的凸四边形的哪条对角线所生成的三角形的外接圆不包含相对的顶点，来确定这 $4$ 个点的 Delaunay 三角剖分。\n2. 利用外心的垂直平分线特性，明确计算共享所选对角线的两个 Delaunay 三角形的外心。\n3. 通过识别由这些外心和垂直平分线导出的 Voronoi 顶点和边，来构建这 $4$ 个点的 Voronoi 图。通过证明由 Delaunay 对角线连接的两个点之间的 Voronoi 边是相邻的两个 Delaunay 三角形的外心为端点的垂直平分线段，来验证 Delaunay 三角剖分与 Voronoi 图之间的对偶性。\n\n最后，作为对偶性的定量验证，计算与连接 $P_B$ 和 $P_C$ 的 Delaunay 边对偶的 Voronoi 边的长度。以米为单位，用精确值表示最终答案（不要四舍五入），并仅报告此长度。",
            "solution": "该问题是良定的，有科学依据，并提供了确定唯一解所需的所有信息。Delaunay 三角剖分和 Voronoi 图的概念是计算几何及其应用（如 CFD 网格生成）中的标准概念。我们开始求解。\n\n给定的点为 $P_A=(0,0)$、$P_B=(3,0)$、$P_C=(1,2)$ 和 $P_D=(2,3)$。\n\n**第一部分：确定 Delaunay 三角剖分**\n\n首先，我们确定这四个点形成一个凸四边形。凸包的顶点按逆时针顺序为 $P_A, P_B, P_D, P_C$。我们可以通过检查对角线 $P_A P_D$ 和 $P_B P_C$ 是否相交来验证这一点。\n通过 $P_A=(0,0)$ 和 $P_D=(2,3)$ 的直线方程为 $y = \\frac{3}{2}x$。\n通过 $P_B=(3,0)$ 和 $P_C=(1,2)$ 的直线斜率为 $m = \\frac{2-0}{1-3} = -1$。其方程为 $y - 0 = -1(x-3)$，可简化为 $y = -x+3$。\n为了求交点，我们令 $y$ 的表达式相等：\n$$ \\frac{3}{2}x = -x+3 $$\n$$ \\frac{5}{2}x = 3 \\implies x = \\frac{6}{5} $$\n对应的 $y$ 坐标为 $y = -(\\frac{6}{5}) + 3 = \\frac{9}{5}$。\n交点是 $(\\frac{6}{5}, \\frac{9}{5})$。由于 $0  \\frac{6}{5}  2$ 且 $1  \\frac{6}{5}  3$，该交点位于线段 $P_A P_D$ 和 $P_B P_C$ 上。因此，这些点构成一个凸四边形 $P_A P_B P_D P_C$。\n\n该四边形有两种可能的三角剖分，对应于选择两条对角线之一：$P_A P_D$ 或 $P_B P_C$。根据 Delaunay 三角剖分的定义，所选的对角线必须满足以下条件：对于它所创建的两个三角形中的每一个，该三角形的外接圆不包含第四个点（即四边形的相对顶点）。这就是 Delaunay“空外接圆”测试。\n\n我们来测试对角线 $P_B P_C$。这个选择创建了两个三角形：$\\triangle P_A P_B P_C$ 和 $\\triangle P_D P_B P_C$。\n我们必须检查 $\\triangle P_A P_B P_C$ 的外接圆是否包含 $P_D$，以及 $\\triangle P_D P_B P_C$ 的外接圆是否包含 $P_A$。\n\n首先，考虑顶点为 $P_A=(0,0)$、$P_B=(3,0)$、$P_C=(1,2)$ 的 $\\triangle P_A P_B P_C$。设其外心为 $O_{ABC}=(h,k)$，半径为 $R_{ABC}$。外接圆的方程为 $(x-h)^2 + (y-k)^2 = R_{ABC}^2$。\n由于 $P_A$ 在圆上：$(0-h)^2+(0-k)^2 = R_{ABC}^2 \\implies h^2+k^2=R_{ABC}^2$。\n由于 $P_B$ 在圆上：$(3-h)^2+(0-k)^2 = R_{ABC}^2 \\implies 9-6h+h^2+k^2=h^2+k^2 \\implies 9-6h=0 \\implies h=\\frac{3}{2}$。\n由于 $P_C$ 在圆上：$(1-h)^2+(2-k)^2 = R_{ABC}^2 \\implies (1-\\frac{3}{2})^2+(2-k)^2 = (\\frac{3}{2})^2+k^2$。\n$(-\\frac{1}{2})^2 + 4-4k+k^2 = \\frac{9}{4}+k^2 \\implies \\frac{1}{4}+4-4k = \\frac{9}{4} \\implies \\frac{17}{4}-4k=\\frac{9}{4}$。\n$4k = \\frac{17}{4} - \\frac{9}{4} = \\frac{8}{4}=2 \\implies k=\\frac{1}{2}$。\n外心为 $O_{ABC}=(\\frac{3}{2}, \\frac{1}{2})$。半径的平方为 $R_{ABC}^2 = h^2+k^2 = (\\frac{3}{2})^2+(\\frac{1}{2})^2 = \\frac{9}{4}+\\frac{1}{4} = \\frac{10}{4} = \\frac{5}{2}$。\n现在我们通过计算 $P_D$ 到 $O_{ABC}$ 的距离的平方来检查 $P_D=(2,3)$ 是否在该圆内部：\n$d^2 = (2-\\frac{3}{2})^2 + (3-\\frac{1}{2})^2 = (\\frac{1}{2})^2 + (\\frac{5}{2})^2 = \\frac{1}{4} + \\frac{25}{4} = \\frac{26}{4} = \\frac{13}{2}$。\n由于 $d^2 = \\frac{13}{2} > R_{ABC}^2 = \\frac{5}{2}$，点 $P_D$ 位于 $\\triangle P_A P_B P_C$ 的外接圆之外。\n\n这个结果足以断定 $P_B P_C$ 是正确的 Delaunay 对角线。Delaunay 三角剖分由 $\\triangle P_A P_B P_C$ 和 $\\triangle P_D P_B P_C$ 组成。\n\n**第二部分：外心的明确计算**\n\n题目要求使用垂直平分线特性。三角形的外心是其各边垂直平分线的交点。\n\n对于顶点为 $P_A=(0,0)$、$P_B=(3,0)$、$P_C=(1,2)$ 的 $\\triangle P_A P_B P_C$：\n边 $P_A P_B$ 是水平的。其中点为 $(\\frac{0+3}{2}, \\frac{0+0}{2}) = (\\frac{3}{2}, 0)$。其垂直平分线是垂直线 $x = \\frac{3}{2}$。\n边 $P_A P_C$ 的中点为 $(\\frac{0+1}{2}, \\frac{0+2}{2}) = (\\frac{1}{2}, 1)$。其斜率为 $\\frac{2-0}{1-0}=2$。垂直平分线的斜率为 $-\\frac{1}{2}$。该平分线的方程为 $y - 1 = -\\frac{1}{2}(x - \\frac{1}{2})$，可简化为 $y = -\\frac{1}{2}x + \\frac{1}{4} + 1 = -\\frac{1}{2}x + \\frac{5}{4}$。\n外心 $O_{ABC}$ 是这两条直线的交点。将 $x=\\frac{3}{2}$ 代入第二个方程：\n$y = -\\frac{1}{2}(\\frac{3}{2}) + \\frac{5}{4} = -\\frac{3}{4} + \\frac{5}{4} = \\frac{2}{4} = \\frac{1}{2}$。\n因此，外心为 $O_{ABC} = (\\frac{3}{2}, \\frac{1}{2})$。\n\n对于顶点为 $P_D=(2,3)$、$P_B=(3,0)$、$P_C=(1,2)$ 的 $\\triangle P_D P_B P_C$：\n边 $P_B P_C$ 的中点为 $(\\frac{3+1}{2}, \\frac{0+2}{2}) = (2,1)$。其斜率为 $\\frac{2-0}{1-3}=-1$。垂直平分线的斜率为 $1$。其方程为 $y-1=1(x-2)$，即 $y=x-1$。\n边 $P_C P_D$ 的中点为 $(\\frac{1+2}{2}, \\frac{2+3}{2}) = (\\frac{3}{2}, \\frac{5}{2})$。其斜率为 $\\frac{3-2}{2-1}=1$。垂直平分线的斜率为 $-1$。其方程为 $y-\\frac{5}{2}=-1(x-\\frac{3}{2})$，即 $y=-x+\\frac{3}{2}+\\frac{5}{2}=-x+4$。\n外心 $O_{BCD}$ 是这两条直线的交点：\n$x-1 = -x+4 \\implies 2x=5 \\implies x=\\frac{5}{2}$。\n$y = x-1 = \\frac{5}{2}-1 = \\frac{3}{2}$。\n因此，外心为 $O_{BCD} = (\\frac{5}{2}, \\frac{3}{2})$。\n\n**第三部分：对偶性验证与最终计算**\n\nVoronoi 图是 Delaunay 三角剖分的对偶。Voronoi 图的顶点是 Delaunay 三角形的外心。Voronoi 图的边是 Delaunay 边的垂直平分线段。\n分隔两个点 $P_i$ 和 $P_j$ 的 Voronoi 胞腔的 Voronoi 边，位于线段 $P_i P_j$ 的垂直平分线上。这条边连接了共享边 $P_i P_j$ 的两个 Delaunay 三角形的外心。\n在本例中，Delaunay 边是对角线 $P_B P_C$。这条边由两个 Delaunay 三角形 $\\triangle P_A P_B P_C$ 和 $\\triangle P_D P_B P_C$ 共享。这些三角形的外心是 $O_{ABC}$ 和 $O_{BCD}$，它们是 Voronoi 图的顶点。因此，与 Delaunay 边 $P_B P_C$ 对偶的 Voronoi 边是连接 $O_{ABC}$ 和 $O_{BCD}$ 的线段。\n$O_{ABC}$ 和 $O_{BCD}$ 都与 $P_B$ 和 $P_C$ 等距，因此它们都位于线段 $P_B P_C$ 的垂直平分线上。因此，线段 $O_{ABC}O_{BCD}$ 是这条垂直平分线上的一段，以两个外心为端点，从而验证了所要求的对偶性质。\n\n最后的任务是计算这条 Voronoi 边的长度，即其端点 $O_{ABC}=(\\frac{3}{2}, \\frac{1}{2})$ 和 $O_{BCD}=(\\frac{5}{2}, \\frac{3}{2})$ 之间的距离。\n长度 $L$ 由 Euclidean 距离公式给出：\n$$ L = \\sqrt{\\left(\\frac{5}{2} - \\frac{3}{2}\\right)^2 + \\left(\\frac{3}{2} - \\frac{1}{2}\\right)^2} $$\n$$ L = \\sqrt{\\left(\\frac{2}{2}\\right)^2 + \\left(\\frac{2}{2}\\right)^2} $$\n$$ L = \\sqrt{1^2 + 1^2} $$\n$$ L = \\sqrt{1+1} $$\n$$ L = \\sqrt{2} $$\n坐标单位是米，所以得出的长度单位也是米。",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        },
        {
            "introduction": "尽管Delaunay三角剖分的定义很优雅，但为大量点集构建它需要高效的算法。本练习深入探讨了许多此类算法的核心：迭代式的“边翻转”过程。您将应用关键的代数“内切圆”测试来做出局部优化决策，从而深入了解高质量网格是如何通过编程方式构建和维护的 。",
            "id": "3953059",
            "problem": "在用于升力面周围的高阶可压缩计算流体力学 (CFD) 的二维非结构化网格中，应用局部边翻转来强制执行 Delaunay 三角剖分性质，这可以改善角度质量并有助于控制通量重构中的数值色散和条件数。考虑一个由四个无量纲化节点（坐标由翼型弦长进行缩放）形成的凸网格四边形：$A=(0,0)$，$B=(4,0)$，$C=(1,3)$ 和 $D=(0,1)$。当前的三角剖分使用内部边 $AC$，形成了相邻的三角形 $ABC$ 和 $ACD$。仅使用基本的 Delaunay 空外接圆定义和定向定义（通过二维叉积计算有符号面积），从第一性原理推导出一个代数的内外测试，以判断点 $D$ 是否位于具有给定几何定向的三角形 $ABC$ 的外接圆内部。对给定坐标应用这个推导出的测试进行求值，并判断将对角线从 $AC$ 翻转到 $BD$ 是否能局部地恢复 Delaunay 条件。将您计算出的关于点 $D$ 相对于三角形 $ABC$ 的有符号代数“在圆内”谓词的精确值作为最终答案。提供精确的整数值（不要四舍五入）。",
            "solution": "三角形的 Delaunay 条件规定，其外接圆内部不包含任何其他网格顶点。对于一个由对角线 $AC$ 形成三角形 $ABC$ 和 $ACD$ 的凸四边形，边 $AC$ 是局部 Delaunay 的当且仅当顶点 $D$ 位于三角形 $ABC$ 的外接圆之外（或之上），并且顶点 $B$ 位于三角形 $ACD$ 的外接圆之外（或之上）。等价地，当四边形是凸的时，只需测试一侧：如果 $D$ 在三角形 $ABC$ 的外接圆内部，则对角线 $AC$ 违反了 Delaunay 准则，应翻转为 $BD$；否则，$AC$ 已经是局部 Delaunay 的。\n\n我们从两个基本依据开始：\n1. Delaunay 空外接圆定义：给定三角形 $ABC$，一个点 $P$ 位于其外接圆内部当且仅当点 $P$ 相对于 $ABC$ 外接圆的有符号幂为负，位于外部则为正，符号约定与 $ABC$ 的定向相关。\n2. 平面定向定义：有向三角形 $ABC$ 的有符号面积（面积的两倍）由行列式给出\n$$\n\\operatorname{orient}(A,B,C)=\n\\begin{vmatrix}\nx_A   y_A  1 \\\\\nx_B   y_B  1 \\\\\nx_C   y_C  1\n\\end{vmatrix}\n= x_A(y_B-y_C) + x_B(y_C-y_A) + x_C(y_A-y_B).\n$$\n如果 $\\operatorname{orient}(A,B,C) > 0$，则 $ABC$ 是逆时针方向（正定向）；如果 $ 0$，则是顺时针方向。\n\n从解析几何可知，通过三个不共线点 $A$、$B$ 和 $C$ 的圆有一个隐式方程，可以表示为包含半径平方项的齐次形式。通过利用 $A$、$B$ 和 $C$ 位于圆上的条件来消去圆的参数，然后在一个查询点 $P$ 处对所得表达式的符号进行求值，可以推导出与空外接圆测试等价的经典代数谓词。具体来说，定义函数\n$$\n\\Phi(A,B,C;P) = \n\\begin{vmatrix}\nx_A   y_A  x_A^{2} + y_A^{2}  1 \\\\\nx_B   y_B  x_B^{2} + y_B^{2}  1 \\\\\nx_C   y_C  x_C^{2} + y_C^{2}  1 \\\\\nx_P   y_P  x_P^{2} + y_P^{2}  1\n\\end{vmatrix}.\n$$\n可以通过从圆方程（通过将点 $A$、$B$ 和 $C$ 的方程相减以消去圆心和半径得到）直接推导得出，$\\Phi(A,B,C;P)$ 的符号与点 $P$ 相对于 $ABC$ 外接圆的位置以及 $ABC$ 的定向两者都有关：\n- 如果 $\\operatorname{orient}(A,B,C)  0$（逆时针），则当且仅当 $P$ 严格位于 $ABC$ 的外接圆内部时 $\\Phi(A,B,C;P)  0$；当且仅当 $P$ 位于外接圆上时 $\\Phi(A,B,C;P) = 0$；当且仅当 $P$ 严格位于外部时 $\\Phi(A,B,C;P)  0$。\n- 如果 $\\operatorname{orient}(A,B,C)  0$（顺时针），则不等式反向。\n\n因此，为了一致地使用这个谓词，我们首先检查 $ABC$ 的定向，然后计算 $\\Phi(A,B,C;D)$ 的值。\n\n步骤 1：$ABC$ 的定向。\n给定 $A=(0,0)$，$B=(4,0)$ 和 $C=(1,3)$，计算\n$$\n\\operatorname{orient}(A,B,C) =\n\\begin{vmatrix}\n0   0  1 \\\\\n4   0  1 \\\\\n1   3  1\n\\end{vmatrix}\n= 0\\cdot(0-3) - 0\\cdot(4-1) + 1\\cdot(4\\cdot 3 - 0\\cdot 1) = 12.\n$$\n因此 $\\operatorname{orient}(A,B,C) = 12  0$，所以 $ABC$ 是逆时针方向。因此 $\\Phi$ 的符号法则是：$\\Phi(A,B,C;P)  0$ 意味着 $P$ 在 $ABC$ 的外接圆内部。\n\n步骤 2：对点 $D$ 计算“在圆内”谓词的值。\n设 $D=(0,1)$。计算所需的范数的平方：\n$$\nx_A^{2}+y_A^{2} = 0^{2}+0^{2}=0,\\quad\nx_B^{2}+y_B^{2} = 4^{2}+0^{2}=16,\\quad\nx_C^{2}+y_C^{2} = 1^{2}+3^{2}=10,\\quad\nx_D^{2}+y_D^{2} = 0^{2}+1^{2}=1.\n$$\n构建行列式\n$$\n\\Phi(A,B,C;D) =\n\\begin{vmatrix}\n0   0  0   1 \\\\\n4   0  16  1 \\\\\n1   3  10  1 \\\\\n0   1  1   1\n\\end{vmatrix}.\n$$\n按第一行展开计算 $\\Phi$。因为第一行中唯一的非零元素是最后一个，我们得到\n$$\n\\Phi(A,B,C;D) = (-1)^{1+4}\\cdot 1 \\cdot\n\\begin{vmatrix}\n4   0  16 \\\\\n1   3  10 \\\\\n0   1  1\n\\end{vmatrix}\n= - \n\\begin{vmatrix}\n4   0  16 \\\\\n1   3  10 \\\\\n0   1  1\n\\end{vmatrix}.\n$$\n现在计算这个 $3\\times 3$ 行列式：\n$$\n\\begin{vmatrix}\n4   0  16 \\\\\n1   3  10 \\\\\n0   1  1\n\\end{vmatrix}\n= 4\\cdot\n\\begin{vmatrix}\n3   10 \\\\\n1   1\n\\end{vmatrix}\n- 0\\cdot(\\cdots) \n+ 16\\cdot\n\\begin{vmatrix}\n1   3 \\\\\n0   1\n\\end{vmatrix}.\n$$\n计算这两个 $2\\times 2$ 行列式：\n$$\n\\begin{vmatrix}\n3   10 \\\\\n1   1\n\\end{vmatrix}\n= 3\\cdot 1 - 10\\cdot 1 = -7,\\qquad\n\\begin{vmatrix}\n1   3 \\\\\n0   1\n\\end{vmatrix}\n= 1\\cdot 1 - 3\\cdot 0 = 1.\n$$\n因此\n$$\n\\begin{vmatrix}\n4   0  16 \\\\\n1   3  10 \\\\\n0   1  1\n\\end{vmatrix}\n= 4\\cdot(-7) + 16\\cdot 1 = -28 + 16 = -12,\n$$\n由此\n$$\n\\Phi(A,B,C;D) = -(-12) = 12.\n$$\n\n解释与翻转决策。由于 $\\operatorname{orient}(A,B,C)  0$ 且 $\\Phi(A,B,C;D) = 12  0$，点 $D$ 严格位于三角形 $ABC$ 的外接圆内部。因此，三角形 $ABC$ 相对于这个局部四边形不是 Delaunay 的，所以当前的边 $AC$ 违反了局部 Delaunay 条件。因此，将对角线从 $AC$ 翻转到 $BD$ 可以恢复 Delaunay 条件。\n\n为完整起见，我们检查这两个三角形确实构成一个有效的凸四边形，其中 $B$ 和 $D$ 位于 $AC$ 的两侧。计算相对于直线 $AC$ 的有符号定向：\n$$\n\\operatorname{orient}(A,C,B) = \n\\begin{vmatrix}\n0   0  1 \\\\\n1   3  1 \\\\\n4   0  1\n\\end{vmatrix}\n= 0\\cdot(3-0) - 0\\cdot(1-4) + 1\\cdot(1\\cdot 0 - 3\\cdot 4) = -12  0,\n$$\n$$\n\\operatorname{orient}(A,C,D) = \n\\begin{vmatrix}\n0   0  1 \\\\\n1   3  1 \\\\\n0   1  1\n\\end{vmatrix}\n= 0\\cdot(3-1) - 0\\cdot(1-0) + 1\\cdot(1\\cdot 1 - 3\\cdot 0) = 1 > 0,\n$$\n所以 $B$ 和 $D$ 位于 $AC$ 的两侧，证实了局部翻转决策的有效性。\n\n因此，该有符号“在圆内”谓词的精确值为 $12$，正确的局部操作是将 $AC$ 翻转为 $BD$。",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "大多数用于航空航天应用的实用CFD模拟都涉及复杂的三维几何形状，这需要由四面体组成的体网格。这最后一个练习将二维的原理扩展到三维。通过推导和应用`insphere`谓词，您将处理在四面体网格中确保Delaunay质量的挑战，这是为真实世界分析生成稳健网格的一项关键技能 。",
            "id": "3953064",
            "problem": "考虑一个用于航空航天应用的计算流体动力学（CFD）中的非结构化四面体网格，其中局部网格优化依赖于Delaunay准则。如果一个四面体的外接球内部不包含其他任何网格顶点，则该四面体是Delaunay的。该问题的基本基础是Delaunay镶嵌的空外接球特性以及欧几里得几何中的定向谓词：一个点$\\boldsymbol{p}$位于一个非退化四面体$\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$的外接球内部，当且仅当经过定向校正后，带符号的“内球”测试为正。仅从这些定义和欧几里得内积出发，推导四面体的行列式形式的内球谓词，然后将其重塑为相对于四面体外接球的定向不变的“点之幂”差值。最后，应用推导出的谓词来判断是否应该在两个四面体$\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$和$\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{e}\\}$之间，对它们的共享面$\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c}\\}$执行一次局部面翻转（双星$2$–$3$变换），其顶点为\n$\\boldsymbol{a}=(1,0,0)$，$\\boldsymbol{b}=(0,1,0)$，$\\boldsymbol{c}=(0,0,1)$，$\\boldsymbol{d}=(-1,0,0)$，以及$\\boldsymbol{e}=(0.8,0.2,0.2)$。\n您必须：\n- 通过提升到更高维度的方法，从空外接球定义推导对$\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$在点$\\boldsymbol{e}$处求值的基于行列式的内球谓词，并解释定向如何影响其符号。\n- 证明该行列式的符号与定向不变的“点之幂”差值$R^{2}-\\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^{2}$的符号等价，其中$\\boldsymbol{c}_{\\text{circ}}$和$R$是$\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$的外接球心和外接球半径。\n- 计算$\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$的定向以及关于$\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$在点$\\boldsymbol{e}$处的定向不变内球谓词值，并用它来判断面$\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c}\\}$是否是局部Delaunay的。\n将最终的谓词值表示为一个精确的有理数。不需要单位。最终答案必须是一个实数。",
            "solution": "本题将按要求分三部分解答：首先，推导基于行列式的内球谓词；其次，证明其与点之幂差值的等价性；第三，将该谓词应用于给定的具体案例。\n\n**第一部分：内球谓词的推导**\n\n内球谓词用于确定点$\\boldsymbol{e}$是位于顶点为$\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$的四面体的外接球的内部、表面还是外部。这可以通过将点从$\\mathbb{R}^3$“提升”到$\\mathbb{R}^4$中的一个抛物面上来推导。\n\n$\\mathbb{R}^3$中一个中心为$\\boldsymbol{c}_{\\text{circ}} = (c_x, c_y, c_z)$、半径为$R$的任意球面可由以下方程描述：\n$$\n(x - c_x)^2 + (y - c_y)^2 + (z - c_z)^2 - R^2 = 0\n$$\n展开此方程得：\n$$\nx^2 + y^2 + z^2 - 2c_x x - 2c_y y - 2c_z z + (c_x^2 + c_y^2 + c_z^2 - R^2) = 0\n$$\n该方程在变量$x$、$y$、$z$和$w = x^2+y^2+z^2$上是线性的。这启发我们将$\\mathbb{R}^3$中的点$\\boldsymbol{p} = (p_x, p_y, p_z)$提升到$\\mathbb{R}^4$中的点$\\boldsymbol{p}^* = (p_x, p_y, p_z, p_x^2+p_y^2+p_z^2)$。所有这样提升的点都位于$\\mathbb{R}^4$中的抛物面$w = x^2+y^2+z^2$上。\n\n现在，球面的方程对应于$\\mathbb{R}^4$中的一个超平面。四个点$\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}$共球当且仅当它们提升后的对应点$\\boldsymbol{a}^*, \\boldsymbol{b}^*, \\boldsymbol{c}^*, \\boldsymbol{d}^*$共面（即位于$\\mathbb{R}^4$的一个超平面上）。\n\n第五个点$\\boldsymbol{e}$位于$\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$的外接球上，当且仅当其提升点$\\boldsymbol{e}^*$位于由$\\boldsymbol{a}^*, \\boldsymbol{b}^*, \\boldsymbol{c}^*, \\boldsymbol{d}^*$定义的同一超平面上。这一几何条件等价于，当用$\\mathbb{R}^4$中的齐次坐标表示时，五个点$\\boldsymbol{a}^*, \\boldsymbol{b}^*, \\boldsymbol{c}^*, \\boldsymbol{d}^*, \\boldsymbol{e}^*$是线性相关的。通过检查由它们的齐次坐标构成的矩阵的行列式是否为零来测试这种线性相关性。\n\n测试点$\\boldsymbol{e}$是位于外接球内部、表面还是外部，取决于以下$5 \\times 5$行列式的符号，我们将其定义为内球谓词$\\text{InSphere}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}, \\boldsymbol{e})$：\n$$\n\\text{InSphere}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}, \\boldsymbol{e}) =\n\\det\n\\begin{pmatrix}\na_x   a_y  a_z  \\|\\boldsymbol{a}\\|^2  1 \\\\\nb_x   b_y  b_z  \\|\\boldsymbol{b}\\|^2  1 \\\\\nc_x   c_y  c_z  \\|\\boldsymbol{c}\\|^2  1 \\\\\nd_x   d_y  d_z  \\|\\boldsymbol{d}\\|^2  1 \\\\\ne_x   e_y  e_z  \\|\\boldsymbol{e}\\|^2  1\n\\end{pmatrix}\n$$\n其中$\\|\\boldsymbol{p}\\|^2 = p_x^2 + p_y^2 + p_z^2$。该行列式的符号表示点$\\boldsymbol{e}$相对于通过$\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}$的定向球面的位置。\n\n该行列式的符号取决于前四个点的顺序。具体来说，它取决于四面体$\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$的定向。定向$\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})$由四面体有向体积的符号给出，该体积与以下行列式成正比：\n$$\n\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}) =\n\\det\n\\begin{pmatrix}\na_x   a_y  a_z  1 \\\\\nb_x   b_y  b_z  1 \\\\\nc_x   c_y  c_z  1 \\\\\nd_x   d_y  d_z  1\n\\end{pmatrix}\n$$\n按照惯例（例如，在J. Shewchuk的鲁棒谓词文献中），如果$\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})  0$，则$\\text{InSphere}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}, \\boldsymbol{e})  0$表示点$\\boldsymbol{e}$位于外接球内部。如果定向为负，则内球测试符号的含义相反。因此，要获得一个一致的“内部性”测试，必须考虑定向。问题陈述中提到，对于内部点，测试在*经过定向校正后*为正，这意味着定向不变的测试才是关键。\n\n**第二部分：与点之幂差值的等价性**\n\n我们的目标是证明内球行列式的符号与点之幂差值$R^2 - \\|\\boldsymbol{e} - \\boldsymbol{c}_{\\text{circ}}\\|^2$以及定向直接相关。设$\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$的外接球面方程为$\\|\\boldsymbol{p} - \\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2 = 0$。可重写为：\n$$\n\\|\\boldsymbol{p}\\|^2 - 2\\boldsymbol{p}\\cdot\\boldsymbol{c}_{\\text{circ}} + \\|\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2 = 0\n$$\n设$D$为内球行列式。我们对矩阵进行列变换。设$C_j$表示第$j$列。我们执行变换$C_4 \\to C_4 - 2c_x C_1 - 2c_y C_2 - 2c_z C_3 + (\\|\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2) C_5$。此操作不改变行列式的值。对于点$\\boldsymbol{p}_i$，新的第4列中的一个元素将是：\n$$\n\\|\\boldsymbol{p}_i\\|^2 - 2(p_{ix} c_x + p_{iy} c_y + p_{iz} c_z) + (\\|\\boldsymbol{c}_{\\text{circ}}\\|^2-R^2) = \\|\\boldsymbol{p}_i-\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2\n$$\n对于点$\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}$（根据定义它们在外接球上），此值为$0$。对于点$\\boldsymbol{e}$，此值为$\\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2$。行列式变为：\n$$\nD = \\det\n\\begin{pmatrix}\na_x   a_y  a_z  0  1 \\\\\nb_x   b_y  b_z  0  1 \\\\\nc_x   c_y  c_z  0  1 \\\\\nd_x   d_y  d_z  0  1 \\\\\ne_x   e_y  e_z  \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2  1\n\\end{pmatrix}\n$$\n沿第4列展开此行列式，得到唯一对应于最后一行的非零项：\n$$\nD = (\\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2) \\times (-1)^{5+4} \\det\n\\begin{pmatrix}\na_x   a_y  a_z  1 \\\\\nb_x   b_y  b_z  1 \\\\\nc_x   c_y  c_z  1 \\\\\nd_x   d_y  d_z  1\n\\end{pmatrix}\n$$\n余下的$4 \\times 4$行列式正是定向行列式$\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})$。因此，\n$$\nD = (\\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2) \\times (-1) \\times \\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})\n$$\n$$\nD = (R^2 - \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2) \\times \\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})\n$$\n此恒等式表明，我们可以定义为$P = D / \\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})$的定向不变谓词值，恰好就是点之幂差值：\n$$\nP = R^2 - \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2\n$$\n如果$P  0$，点$\\boldsymbol{e}$在外接球内部；如果$P = 0$，点$\\boldsymbol{e}$在球面上；如果$P  0$，点$\\boldsymbol{e}$在外部。这个值$P$与$\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$的排序无关，是题目所要求的值。\n\n**第三部分：计算与决策**\n\n给定顶点：\n$\\boldsymbol{a}=(1,0,0)$, $\\boldsymbol{b}=(0,1,0)$, $\\boldsymbol{c}=(0,0,1)$, $\\boldsymbol{d}=(-1,0,0)$, $\\boldsymbol{e}=(0.8,0.2,0.2)$。\n\n首先，我们求四面体$\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$的外接球。我们观察到顶点的模平方分别为$\\|\\boldsymbol{a}\\|^2 = 1$, $\\|\\boldsymbol{b}\\|^2 = 1$, $\\|\\boldsymbol{c}\\|^2 = 1$以及$\\|\\boldsymbol{d}\\|^2 = 1$。所有四个点都位于以原点$\\boldsymbol{c}_{\\text{circ}}=(0,0,0)$为中心、半径为$R=1$的球面上。由于四个不共面的点确定一个唯一的球面，因此这必定是其外接球。\n所以，$\\boldsymbol{c}_{\\text{circ}}=(0,0,0)$且$R=1$。\n\n接着，我们计算$\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$的定向：\n$$\n\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}) = \\det\n\\begin{pmatrix}\n1   0  0  1 \\\\\n0   1  0  1 \\\\\n0   0  1  1 \\\\\n-1  0  0  1\n\\end{pmatrix}\n$$\n将第一行加到第四行（$R_4 \\to R_4 + R_1$）：\n$$\n\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}) = \\det\n\\begin{pmatrix}\n1   0  0  1 \\\\\n0   1  0  1 \\\\\n0   0  1  1 \\\\\n0   0  0  2\n\\end{pmatrix} = 1 \\cdot 1 \\cdot 1 \\cdot 2 = 2\n$$\n定向为正。\n\n现在，我们计算定向不变内球谓词值，$P = R^2 - \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2$。\n$$\nP = 1^2 - \\|(0.8, 0.2, 0.2) - (0,0,0)\\|^2 = 1 - (0.8^2 + 0.2^2 + 0.2^2)\n$$\n为了将其表示为精确有理数，我们使用分数：$0.8 = \\frac{4}{5}$和$0.2 = \\frac{1}{5}$。\n$$\nP = 1 - \\left( \\left(\\frac{4}{5}\\right)^2 + \\left(\\frac{1}{5}\\right)^2 + \\left(\\frac{1}{5}\\right)^2 \\right) = 1 - \\left( \\frac{16}{25} + \\frac{1}{25} + \\frac{1}{25} \\right) = 1 - \\frac{18}{25} = \\frac{7}{25}\n$$\n定向不变内球谓词的值为$\\frac{7}{25}$。\n\n最后，我们决定是否进行面翻转。谓词值$P = \\frac{7}{25}$为正。这意味着点$\\boldsymbol{e}$位于四面体$\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$的外接球*内部*。这种构型违反了共享面$\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}\\}$的Delaunay准则。这样的面称为非Delaunay面。在网格生成和优化中，通常通过执行局部网格变换（例如所提到的双星$2$–$3$变换）来消除非Delaunay面。因此，应该执行翻转操作以恢复网格的局部Delaunay性质。\n\n题目要求以精确有理数形式给出最终谓词值。该值为$\\frac{7}{25}$。",
            "answer": "$$\n\\boxed{\\frac{7}{25}}\n$$"
        }
    ]
}