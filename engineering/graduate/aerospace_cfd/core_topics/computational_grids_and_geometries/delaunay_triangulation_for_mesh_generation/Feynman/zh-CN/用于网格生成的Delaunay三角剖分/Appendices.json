{
    "hands_on_practices": [
        {
            "introduction": "为了深刻理解Delaunay三角剖分的几何本质，从基本原理出发进行构建是至关重要的一步。本练习将引导你通过“空外接圆”这一定义，为一个简单的点集手动构建Delaunay三角剖分。更进一步，你将计算其对偶图——Voronoi图，并验证两者之间的对偶关系，从而直观地理解为何Delaunay三角剖分能够生成高质量的网格。",
            "id": "3953020",
            "problem": "在用于计算流体动力学（CFD）的二维网格生成中，一种常见的策略是放置种子点并构建一个三角剖分，该剖分通过避免细长三角形来提高数值稳定性。考虑一个靠近机翼-机身连接处的平面横截面，其中有$4$个候选网格种子点，坐标分别为 $P_A=(0,0)$、$P_B=(3,0)$、$P_C=(1,2)$ 和 $P_D=(2,3)$，单位为米。仅使用以下基本定义：(i) Delaunay三角剖分是这样一种三角剖分，其中每个三角形的外接圆内部严格不包含任何其他站点；(ii) Voronoi图将平面划分为多个区域，每个区域内的点到给定站点的距离比到任何其他站点的距离都近。请完成以下任务：\n\n1. 从基本原理出发，确定这$4$个站点的Delaunay三角剖分。具体方法是判断由这些站点形成的凸四边形的哪条对角线所生成的三角形，其外接圆不包含相对的站点。\n2. 使用外心的垂直平分线性质，显式计算共享所选对角线的两个Delaunay三角形的外心。\n3. 通过确定由这些外心和垂直平分线导出的Voronoi顶点和Voronoi边，构建这$4$个站点的Voronoi图。通过证明连接由Delaunay对角线连接的两个站点的Voronoi边，是以上述相邻Delaunay三角形的两个外心为端点的垂直平分线段，来验证Delaunay三角剖分和Voronoi图之间的对偶性。\n\n最后，作为对偶性的定量验证，计算与连接$P_B$和$P_C$的Delaunay边对偶的Voronoi边的长度。请用精确值表示最终答案，单位为米（不要四舍五入），并仅报告该长度。",
            "solution": "该问题是良构的，具有科学依据，并提供了确定唯一解所需的所有信息。Delaunay三角剖分和Voronoi图的概念是计算几何及其应用（如CFD网格生成）中的标准概念。我们开始求解。\n\n给定的站点是 $P_A=(0,0)$、$P_B=(3,0)$、$P_C=(1,2)$ 和 $P_D=(2,3)$。\n\n**第1部分：确定Delaunay三角剖分**\n\n首先，我们确定这四个点构成一个凸四边形。其凸包的顶点按逆时针顺序为 $P_A, P_B, P_D, P_C$。我们可以通过检查对角线 $P_A P_D$ 和 $P_B P_C$ 是否相交来验证这一点。\n穿过 $P_A=(0,0)$ 和 $P_D=(2,3)$ 的直线方程为 $y = \\frac{3}{2}x$。\n穿过 $P_B=(3,0)$ 和 $P_C=(1,2)$ 的直线斜率为 $m = \\frac{2-0}{1-3} = -1$。其方程为 $y - 0 = -1(x-3)$，化简后为 $y = -x+3$。\n为了求交点，我们将两个 $y$ 的表达式设为相等：\n$$ \\frac{3}{2}x = -x+3 $$\n$$ \\frac{5}{2}x = 3 \\implies x = \\frac{6}{5} $$\n相应的 $y$ 坐标为 $y = -(\\frac{6}{5}) + 3 = \\frac{9}{5}$。\n交点是 $(\\frac{6}{5}, \\frac{9}{5})$。由于 $0  \\frac{6}{5}  2$ 和 $1  \\frac{6}{5}  3$，该交点位于线段 $P_A P_D$ 和 $P_B P_C$ 上。因此，这些点构成一个凸四边形 $P_A P_B P_D P_C$。\n\n对于这个四边形，有两种可能的三角剖分，对应于选择两条对角线中的一条：$P_A P_D$ 或 $P_B P_C$。根据Delaunay三角剖分的定义，所选的对角线必须满足以下条件：它所创建的两个三角形中，每个三角形的外接圆都不包含第四个点（即四边形的相对顶点）。这就是Delaunay的“空外接圆”测试。\n\n我们来测试对角线 $P_B P_C$。这个选择会创建两个三角形：$\\triangle P_A P_B P_C$ 和 $\\triangle D P_B P_C$。\n我们必须检查 $\\triangle P_A P_B P_C$ 的外接圆是否包含 $P_D$，以及 $\\triangle D P_B P_C$ 的外接圆是否包含 $P_A$。\n\n首先，考虑顶点为 $P_A=(0,0)$、$P_B=(3,0)$、$P_C=(1,2)$ 的 $\\triangle P_A P_B P_C$。设外心为 $O_{ABC}=(h,k)$，半径为 $R_{ABC}$。其外接圆方程为 $(x-h)^2 + (y-k)^2 = R_{ABC}^2$。\n由于 $P_A$ 在圆上：$(0-h)^2+(0-k)^2 = R_{ABC}^2 \\implies h^2+k^2=R_{ABC}^2$。\n由于 $P_B$ 在圆上：$(3-h)^2+(0-k)^2 = R_{ABC}^2 \\implies 9-6h+h^2+k^2=h^2+k^2 \\implies 9-6h=0 \\implies h=\\frac{3}{2}$。\n由于 $P_C$ 在圆上：$(1-h)^2+(2-k)^2 = R_{ABC}^2 \\implies (1-\\frac{3}{2})^2+(2-k)^2 = (\\frac{3}{2})^2+k^2$。\n$(-\\frac{1}{2})^2 + 4-4k+k^2 = \\frac{9}{4}+k^2 \\implies \\frac{1}{4}+4-4k = \\frac{9}{4} \\implies \\frac{17}{4}-4k=\\frac{9}{4}$。\n$4k = \\frac{17}{4} - \\frac{9}{4} = \\frac{8}{4}=2 \\implies k=\\frac{1}{2}$。\n外心是 $O_{ABC}=(\\frac{3}{2}, \\frac{1}{2})$。半径的平方为 $R_{ABC}^2 = h^2+k^2 = (\\frac{3}{2})^2+(\\frac{1}{2})^2 = \\frac{9}{4}+\\frac{1}{4} = \\frac{10}{4} = \\frac{5}{2}$。\n现在我们通过计算 $P_D$ 到 $O_{ABC}$ 的距离的平方来检查 $P_D=(2,3)$ 是否在该圆内：\n$d^2 = (2-\\frac{3}{2})^2 + (3-\\frac{1}{2})^2 = (\\frac{1}{2})^2 + (\\frac{5}{2})^2 = \\frac{1}{4} + \\frac{25}{4} = \\frac{26}{4} = \\frac{13}{2}$。\n由于 $d^2 = \\frac{13}{2} > R_{ABC}^2 = \\frac{5}{2}$，点 $P_D$ 位于 $\\triangle P_A P_B P_C$ 的外接圆之外。\n\n这个结果足以断定 $P_B P_C$ 是正确的Delaunay对角线。Delaunay三角剖分由 $\\triangle P_A P_B P_C$ 和 $\\triangle D P_B P_C$ 组成。\n\n**第2部分：外心的显式计算**\n\n题目要求使用垂直平分线性质。三角形的外心是其各边垂直平分线的交点。\n\n对于顶点为 $P_A=(0,0)$、$P_B=(3,0)$、$P_C=(1,2)$ 的 $\\triangle P_A P_B P_C$：\n边 $P_A P_B$ 是水平的。它的中点是 $(\\frac{0+3}{2}, \\frac{0+0}{2}) = (\\frac{3}{2}, 0)$。垂直平分线是竖直线 $x = \\frac{3}{2}$。\n边 $P_A P_C$ 的中点是 $(\\frac{0+1}{2}, \\frac{0+2}{2}) = (\\frac{1}{2}, 1)$。其斜率为 $\\frac{2-0}{1-0}=2$。垂直平分线的斜率为 $-\\frac{1}{2}$。该平分线的方程是 $y - 1 = -\\frac{1}{2}(x - \\frac{1}{2})$，化简后为 $y = -\\frac{1}{2}x + \\frac{1}{4} + 1 = -\\frac{1}{2}x + \\frac{5}{4}$。\n外心 $O_{ABC}$ 是这两条直线的交点。将 $x=\\frac{3}{2}$ 代入第二个方程：\n$y = -\\frac{1}{2}(\\frac{3}{2}) + \\frac{5}{4} = -\\frac{3}{4} + \\frac{5}{4} = \\frac{2}{4} = \\frac{1}{2}$。\n因此，外心是 $O_{ABC} = (\\frac{3}{2}, \\frac{1}{2})$。\n\n对于顶点为 $P_D=(2,3)$、$P_B=(3,0)$、$P_C=(1,2)$ 的 $\\triangle D P_B P_C$：\n边 $P_B P_C$ 的中点是 $(\\frac{3+1}{2}, \\frac{0+2}{2}) = (2,1)$。其斜率为 $\\frac{2-0}{1-3}=-1$。垂直平分线的斜率为 $1$。其方程为 $y-1=1(x-2)$，即 $y=x-1$。\n边 $P_C P_D$ 的中点是 $(\\frac{1+2}{2}, \\frac{2+3}{2}) = (\\frac{3}{2}, \\frac{5}{2})$。其斜率为 $\\frac{3-2}{2-1}=1$。垂直平分线的斜率为 $-1$。其方程为 $y-\\frac{5}{2}=-1(x-\\frac{3}{2})$，即 $y=-x+\\frac{3}{2}+\\frac{5}{2}=-x+4$。\n外心 $O_{BCD}$ 是这两条直线的交点：\n$x-1 = -x+4 \\implies 2x=5 \\implies x=\\frac{5}{2}$。\n$y = x-1 = \\frac{5}{2}-1 = \\frac{3}{2}$。\n因此，外心是 $O_{BCD} = (\\frac{5}{2}, \\frac{3}{2})$。\n\n**第3部分：对偶性验证与最终计算**\n\nVoronoi图是Delaunay三角剖分的对偶。Voronoi图的顶点是Delaunay三角形的外心。Voronoi图的边是Delaunay边的垂直平分线段。\n分隔两个站点 $P_i$ 和 $P_j$ 的Voronoi单元的Voronoi边，位于线段 $P_i P_j$ 的垂直平分线上。这条边连接着共享边 $P_i P_j$ 的两个Delaunay三角形的外心。\n在我们的例子中，Delaunay边是对角线 $P_B P_C$。这条边由两个Delaunay三角形 $\\triangle P_A P_B P_C$ 和 $\\triangle D P_B P_C$ 共享。这两个三角形的外心分别是 $O_{ABC}$ 和 $O_{BCD}$，它们是Voronoi图的顶点。因此，与Delaunay边 $P_B P_C$ 对偶的Voronoi边是连接 $O_{ABC}$ 和 $O_{BCD}$ 的线段。\n$O_{ABC}$ 和 $O_{BCD}$ 到 $P_B$ 和 $P_C$ 的距离都相等，因此它们都位于线段 $P_B P_C$ 的垂直平分线上。因此，线段 $O_{ABC}O_{BCD}$ 是这条垂直平分线的一部分，以两个外心为端点，从而验证了所要求的对偶性质。\n\n最后的任务是计算这条Voronoi边的长度，也就是其两个端点 $O_{ABC}=(\\frac{3}{2}, \\frac{1}{2})$ 和 $O_{BCD}=(\\frac{5}{2}, \\frac{3}{2})$ 之间的距离。\n长度 $L$ 由欧几里得距离公式给出：\n$$ L = \\sqrt{\\left(\\frac{5}{2} - \\frac{3}{2}\\right)^2 + \\left(\\frac{3}{2} - \\frac{1}{2}\\right)^2} $$\n$$ L = \\sqrt{\\left(\\frac{2}{2}\\right)^2 + \\left(\\frac{2}{2}\\right)^2} $$\n$$ L = \\sqrt{1^2 + 1^2} $$\n$$ L = \\sqrt{1+1} $$\n$$ L = \\sqrt{2} $$\n坐标单位是米，所以计算出的长度单位也是米。",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        },
        {
            "introduction": "在掌握了Delaunay三角剖分的定义之后，下一个关键是理解其构建和优化的算法。边翻转（edge flip）是其中最核心的局部操作，它依赖于一个稳健的几何判断——“内切圆测试”（incircle test）——来决定是否翻转一条边以满足Delaunay条件。通过本练习，你将实践这一关键算法步骤，并运用其代数形式，这是许多计算几何软件库的核心。",
            "id": "3953059",
            "problem": "在用于升力面周围的高阶可压缩计算流体力学 (CFD) 的二维非结构网格中，通过应用局部边翻转来强制执行德劳内 (Delaunay) 三角剖分属性，这可以改善角度质量并有助于在通量重构中控制数值色散和条件数。考虑一个由四个无量纲化节点（坐标通过翼型弦长进行缩放）形成的凸网格四边形：$A=(0,0)$, $B=(4,0)$, $C=(1,3)$ 和 $D=(0,1)$。当前的三角剖分使用内部边 $AC$，形成相邻的三角形 $ABC$ 和 $ACD$。仅使用基本的德劳内 (Delaunay) 空外接圆定义和定向定义（通过二维叉积得到的有向面积），从第一性原理推导出一个代数测试，用于判断点 $D$ 是否位于具有给定几何定向的三角形 $ABC$ 的外接圆内部。对给定坐标评估此推导出的测试，并决定将对角线从 $AC$ 翻转到 $BD$ 是否能局部恢复德劳内 (Delaunay) 条件。报告你计算出的关于 $ABC$ 的点 $D$ 的有向代数外接圆判定式的精确值作为最终答案。提供精确的整数值（不要四舍五入）。",
            "solution": "德劳内 (Delaunay) 条件规定，一个三角形的外接圆内部不包含任何其他网格顶点。对于一个由对角线 $AC$ 形成三角形 $ABC$ 和 $ACD$ 的凸四边形，边 $AC$ 是局部德劳内的，当且仅当顶点 $D$ 位于 $ABC$ 的外接圆之外（或之上）且顶点 $B$ 位于 $ACD$ 的外接圆之外（或之上）。等价地，当四边形是凸的时，只需测试一侧：如果 $D$ 在 $ABC$ 的外接圆内部，则对角线 $AC$ 违反了德劳内准则，应翻转为 $BD$；否则，$AC$ 已经是局部德劳内的。\n\n我们从两个基本依据出发：\n1. 德劳内 (Delaunay) 空外接圆定义：给定三角形 $ABC$，一个点 $P$ 位于其外接圆内部，当且仅当点 $P$ 相对于 $ABC$ 外接圆的有向幂为负；如果为正，则位于外部。此处的符号约定与 $ABC$ 的定向相关。\n2. 平面定向定义：定向三角形 $ABC$ 的有向面积（即面积的两倍）由以下行列式给出：\n$$\n\\operatorname{orient}(A,B,C)=\n\\begin{vmatrix}\nx_A  y_A  1 \\\\\nx_B  y_B  1 \\\\\nx_C  y_C  1\n\\end{vmatrix}\n= x_A(y_B-y_C) + x_B(y_C-y_A) + x_C(y_A-y_B).\n$$\n如果 $\\operatorname{orient}(A,B,C) > 0$，则 $ABC$ 是逆时针方向（正定向）；如果小于 0，则是顺时针方向。\n\n根据解析几何，通过三个不共线点 $A$、$B$ 和 $C$ 的圆存在一个隐式方程，该方程可以表示为包含半径平方项的齐次形式。通过使用 $A$、$B$ 和 $C$ 位于圆上的条件来消去圆的参数，可以推导出一个与空外接圆测试等价的经典代数判定式，然后在一个查询点 $P$ 处计算所得表达式的符号。具体来说，定义函数\n$$\n\\Phi(A,B,C;P) = \n\\begin{vmatrix}\nx_A  y_A  x_A^{2} + y_A^{2}  1 \\\\\nx_B  y_B  x_B^{2} + y_B^{2}  1 \\\\\nx_C  y_C  x_C^{2} + y_C^{2}  1 \\\\\nx_P  y_P  x_P^{2} + y_P^{2}  1\n\\end{vmatrix}.\n$$\n通过从圆方程直接推导（通过将点 $A$、$B$ 和 $C$ 的方程相减以消去圆心和半径得到）可以证明，$\\Phi(A,B,C;P)$ 的符号与点 $P$ 相对于 $ABC$ 外接圆的位置以及 $ABC$ 的定向两者都有关：\n- 如果 $\\operatorname{orient}(A,B,C) > 0$（逆时针），则当且仅当 $P$ 严格位于 $ABC$ 外接圆内部时，$\\Phi(A,B,C;P) > 0$；当且仅当 $P$ 位于外接圆上时，$\\Phi(A,B,C;P) = 0$；当且仅当 $P$ 严格位于外接圆外部时，$\\Phi(A,B,C;P)  0$。\n- 如果 $\\operatorname{orient}(A,B,C)  0$（顺时针），则不等式方向相反。\n\n因此，为了一致地使用此判定式，我们首先检查 $ABC$ 的定向，然后计算 $\\Phi(A,B,C;D)$ 的值。\n\n步骤 1：$ABC$ 的定向。\n给定 $A=(0,0)$、$B=(4,0)$ 和 $C=(1,3)$，计算\n$$\n\\operatorname{orient}(A,B,C) =\n\\begin{vmatrix}\n0  0  1 \\\\\n4  0  1 \\\\\n1  3  1\n\\end{vmatrix}\n= 0\\cdot(0-3) - 0\\cdot(4-1) + 1\\cdot(4\\cdot 3 - 0\\cdot 1) = 12.\n$$\n因此 $\\operatorname{orient}(A,B,C) = 12 > 0$，所以 $ABC$ 是逆时针方向。因此 $\\Phi$ 的符号法则是：$\\Phi(A,B,C;P) > 0$ 表示 $P$ 在 $ABC$ 的外接圆内部。\n\n步骤 2：计算点 $D$ 的外接圆判定式。\n令 $D=(0,1)$。计算所需的范数平方：\n$$\nx_A^{2}+y_A^{2} = 0^{2}+0^{2}=0,\\quad\nx_B^{2}+y_B^{2} = 4^{2}+0^{2}=16,\\quad\nx_C^{2}+y_C^{2} = 1^{2}+3^{2}=10,\\quad\nx_D^{2}+y_D^{2} = 0^{2}+1^{2}=1.\n$$\n构造行列式\n$$\n\\Phi(A,B,C;D) =\n\\begin{vmatrix}\n0  0  0  1 \\\\\n4  0  16  1 \\\\\n1  3  10  1 \\\\\n0  1  1  1\n\\end{vmatrix}.\n$$\n沿第一行展开来计算 $\\Phi$。因为第一行中唯一的非零元素是最后一个，我们有\n$$\n\\Phi(A,B,C;D) = (-1)^{1+4}\\cdot 1 \\cdot\n\\begin{vmatrix}\n4  0  16 \\\\\n1  3  10 \\\\\n0  1  1\n\\end{vmatrix}\n= - \n\\begin{vmatrix}\n4  0  16 \\\\\n1  3  10 \\\\\n0  1  1\n\\end{vmatrix}.\n$$\n现在计算这个 $3\\times 3$ 行列式：\n$$\n\\begin{vmatrix}\n4  0  16 \\\\\n1  3  10 \\\\\n0  1  1\n\\end{vmatrix}\n= 4\\cdot\n\\begin{vmatrix}\n3  10 \\\\\n1  1\n\\end{vmatrix}\n- 0\\cdot(\\cdots) \n+ 16\\cdot\n\\begin{vmatrix}\n1  3 \\\\\n0  1\n\\end{vmatrix}.\n$$\n计算这两个 $2\\times 2$ 行列式：\n$$\n\\begin{vmatrix}\n3  10 \\\\\n1  1\n\\end{vmatrix}\n= 3\\cdot 1 - 10\\cdot 1 = -7,\\qquad\n\\begin{vmatrix}\n1  3 \\\\\n0  1\n\\end{vmatrix}\n= 1\\cdot 1 - 3\\cdot 0 = 1.\n$$\n因此\n$$\n\\begin{vmatrix}\n4  0  16 \\\\\n1  3  10 \\\\\n0  1  1\n\\end{vmatrix}\n= 4\\cdot(-7) + 16\\cdot 1 = -28 + 16 = -12,\n$$\n因此\n$$\n\\Phi(A,B,C;D) = -(-12) = 12.\n$$\n\n结果解释与翻转决策。由于 $\\operatorname{orient}(A,B,C) > 0$ 且 $\\Phi(A,B,C;D) = 12 > 0$，点 $D$ 严格位于三角形 $ABC$ 的外接圆内部。因此，相对于局部四边形，三角形 $ABC$ 不是德劳内的，所以当前边 $AC$ 违反了局部德劳内条件。因此，将对角线从 $AC$ 翻转到 $BD$ 可以恢复德劳内条件。\n\n为完整起见，我们检查这两个三角形确实构成一个有效的凸四边形，其中 $B$ 和 $D$ 位于 $AC$ 的两侧。计算相对于直线 $AC$ 的有向定向：\n$$\n\\operatorname{orient}(A,C,B) = \n\\begin{vmatrix}\n0  0  1 \\\\\n1  3  1 \\\\\n4  0  1\n\\end{vmatrix}\n= 0\\cdot(3-0) - 0\\cdot(1-4) + 1\\cdot(1\\cdot 0 - 3\\cdot 4) = -12  0,\n$$\n$$\n\\operatorname{orient}(A,C,D) = \n\\begin{vmatrix}\n0  0  1 \\\\\n1  3  1 \\\\\n0  1  1\n\\end{vmatrix}\n= 0\\cdot(3-1) - 0\\cdot(1-0) + 1\\cdot(1\\cdot 1 - 3\\cdot 0) = 1 > 0,\n$$\n所以 $B$ 和 $D$ 位于 $AC$ 的两侧，这证实了局部翻转决策的有效性。\n\n因此，有向外接圆判定式的精确值为 $12$，正确的局部操作是将 $AC$ 翻转为 $BD$。",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "现实世界中的航空航天CFD应用几乎都是三维的，因此将二维概念推广到三维空间是必不可少的一步。本练习将二维的“内切圆测试”扩展到三维四面体网格中的“内切球测试”（insphere test），这是优化三维网格的关键。通过这个实践，你将看到核心几何原理如何优美地推广到更高维度，并直接接触到处理三维面翻转（face flip）所需的数学工具。",
            "id": "3953064",
            "problem": "考虑一个用于航空航天应用的计算流体动力学（CFD）中的非结构化四面体网格，其局部网格优化依赖于Delaunay准则。如果一个四面体的外接球不包含其他网格顶点，则该四面体是Delaunay的。本问题的基本依据是Delaunay镶嵌的空外接球特性以及欧几里得几何中的方向谓词：一个点 $\\boldsymbol{p}$ 位于一个非退化四面体 $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$ 的外接球内部，当且仅当经过方向校正后，带符号的“内切球”测试为正。仅从这些定义和欧几里得内积出发，推导四面体的内切球谓词的行列式形式，然后将其重塑为相对于该四面体外接球的一个方向无关的“点幂”差。最后，应用推导出的谓词来决定是否应该对两个四面体 $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$ 和 $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{e}\\}$ 之间的共享面 $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c}\\}$ 进行局部面翻转（双星 $2$–$3$ 移动），其顶点为\n$\\boldsymbol{a}=(1,0,0)$, $\\boldsymbol{b}=(0,1,0)$, $\\boldsymbol{c}=(0,0,1)$, $\\boldsymbol{d}=(-1,0,0)$ 和 $\\boldsymbol{e}=(0.8,0.2,0.2)$。\n您必须：\n- 从空外接球定义出发，通过提升到更高维度的方法，推导在点 $\\boldsymbol{e}$ 处求值的四面体 $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$ 的基于行列式的内切球谓词，并解释方向如何影响其符号。\n- 证明该行列式的符号与方向无关的“点幂”差 $R^{2}-\\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^{2}$ 的符号等价，其中 $\\boldsymbol{c}_{\\text{circ}}$ 和 $R$ 是四面体 $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$ 的外心和外接球半径。\n- 计算四面体 $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$ 的方向以及点 $\\boldsymbol{e}$ 相对于 $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$ 的方向无关的内切球谓词值，并用它来决定面 $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c}\\}$ 是否是局部Delaunay的。\n将最终谓词值表示为一个精确的有理数。无需单位。最终答案必须是单个实数。",
            "solution": "首先，我们推导内切球谓词的行列式形式。该谓词用于判断一个点 $\\boldsymbol{e}$ 是位于顶点为 $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$ 的四面体的外接球的内部、表面上还是外部。这可以通过将点从 $\\mathbb{R}^3$ “提升”到 $\\mathbb{R}^4$ 中的一个抛物面上来推导。\n\n$\\mathbb{R}^3$ 中任意一个以 $\\boldsymbol{c}_{\\text{circ}} = (c_x, c_y, c_z)$ 为中心、半径为 $R$ 的球体可由以下方程描述：\n$$\n(x - c_x)^2 + (y - c_y)^2 + (z - c_z)^2 - R^2 = 0\n$$\n展开此方程可得：\n$$\nx^2 + y^2 + z^2 - 2c_x x - 2c_y y - 2c_z z + (c_x^2 + c_y^2 + c_z^2 - R^2) = 0\n$$\n该方程对于变量 $x$, $y$, $z$ 和 $w = x^2+y^2+z^2$ 是线性的。这启发我们将 $\\mathbb{R}^3$ 中的点 $\\boldsymbol{p} = (p_x, p_y, p_z)$ 提升到 $\\mathbb{R}^4$ 中的点 $\\boldsymbol{p}^* = (p_x, p_y, p_z, p_x^2+p_y^2+p_z^2)$。所有这些提升后的点都位于 $\\mathbb{R}^4$ 中的抛物面 $w = x^2+y^2+z^2$ 上。球体方程现在对应于 $\\mathbb{R}^4$ 中的一个超平面。四个点 $\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}$ 共球，当且仅当它们提升后的对应点 $\\boldsymbol{a}^*, \\boldsymbol{b}^*, \\boldsymbol{c}^*, \\boldsymbol{d}^*$ 共面（在$\\mathbb{R}^4$的一个超平面内）。判断点 $\\boldsymbol{e}$ 是位于外接球内部、表面上还是外部的测试，由以下 $5 \\times 5$ 行列式的符号决定，我们将其定义为内切球谓词 $\\text{InSphere}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}, \\boldsymbol{e})$：\n$$\n\\text{InSphere}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}, \\boldsymbol{e}) =\n\\det\n\\begin{pmatrix}\na_x  a_y  a_z  \\|\\boldsymbol{a}\\|^2  1 \\\\\nb_x  b_y  b_z  \\|\\boldsymbol{b}\\|^2  1 \\\\\nc_x  c_y  c_z  \\|\\boldsymbol{c}\\|^2  1 \\\\\nd_x  d_y  d_z  \\|\\boldsymbol{d}\\|^2  1 \\\\\ne_x  e_y  e_z  \\|\\boldsymbol{e}\\|^2  1\n\\end{pmatrix}\n$$\n其中 $\\|\\boldsymbol{p}\\|^2 = p_x^2 + p_y^2 + p_z^2$。该行列式的符号表示点 $\\boldsymbol{e}$ 相对于通过 $\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}$ 的定向球体的位置。它的符号取决于四面体 $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$ 的方向。方向 $\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})$ 由四面体的有向体积的符号给出，该体积与以下行列式成正比：\n$$\n\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}) =\n\\det\n\\begin{pmatrix}\na_x  a_y  a_z  1 \\\\\nb_x  b_y  b_z  1 \\\\\nc_x  c_y  c_z  1 \\\\\nd_x  d_y  d_z  1\n\\end{pmatrix}\n$$\n按照惯例，如果 $\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}) > 0$，则 $\\text{InSphere}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}, \\boldsymbol{e}) > 0$ 表示 $\\boldsymbol{e}$ 位于外接球内部。如果方向为负，内切球测试的符号含义则相反。\n\n接下来，我们证明该行列式与点幂差 $R^2 - \\|\\boldsymbol{e} - \\boldsymbol{c}_{\\text{circ}}\\|^2$ 的等价性。设内切球行列式为 $D$。通过一系列列变换，我们可以证明：\n$$\nD = (R^2 - \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2) \\times \\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})\n$$\n这个恒等式表明，方向无关的谓词值（我们可以定义为 $P = D / \\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})$）恰好是点幂差：\n$$\nP = R^2 - \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2\n$$\n如果 $P > 0$，点 $\\boldsymbol{e}$ 在外接球内部；如果 $P = 0$，在球面上；如果 $P  0$，在球体外部。这个值 $P$ 与 $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$ 的顺序无关，是我们计算所求的量。\n\n现在，我们应用此谓词于给定的顶点：\n$\\boldsymbol{a}=(1,0,0)$, $\\boldsymbol{b}=(0,1,0)$, $\\boldsymbol{c}=(0,0,1)$, $\\boldsymbol{d}=(-1,0,0)$, $\\boldsymbol{e}=(0.8,0.2,0.2)$。\n\n首先，我们求四面体 $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$ 的外接球。我们观察到顶点的模长的平方为 $\\|\\boldsymbol{a}\\|^2 = 1$, $\\|\\boldsymbol{b}\\|^2 = 1$, $\\|\\boldsymbol{c}\\|^2 = 1$ 和 $\\|\\boldsymbol{d}\\|^2 = 1$。所有四个点都位于一个以原点 $\\boldsymbol{c}_{\\text{circ}}=(0,0,0)$ 为中心、半径为 $R=1$ 的球面上。由于四个不共面的点定义一个唯一的球体，这必定是其外接球。\n所以，$\\boldsymbol{c}_{\\text{circ}}=(0,0,0)$ 且 $R=1$。\n\n现在，我们计算方向无关的内切球谓词值 $P = R^2 - \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2$。\n$$\nP = 1^2 - \\|(0.8, 0.2, 0.2) - (0,0,0)\\|^2 = 1 - (0.8^2 + 0.2^2 + 0.2^2)\n$$\n为了将其表示为精确的有理数，我们使用分数：$0.8 = \\frac{4}{5}$ 且 $0.2 = \\frac{1}{5}$。\n$$\nP = 1 - \\left( \\left(\\frac{4}{5}\\right)^2 + \\left(\\frac{1}{5}\\right)^2 + \\left(\\frac{1}{5}\\right)^2 \\right) = 1 - \\left( \\frac{16}{25} + \\frac{1}{25} + \\frac{1}{25} \\right) = 1 - \\frac{18}{25} = \\frac{7}{25}\n$$\n方向无关的内切球谓词的值为 $\\frac{7}{25}$。\n\n最后，我们决定是否进行面翻转。谓词值 $P = \\frac{7}{25}$ 为正。这意味着点 $\\boldsymbol{e}$ 位于四面体 $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$ 的外接球*内部*。这种构型违反了共享面 $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}\\}$ 的Delaunay准则。这样的面被称为非Delaunay面。在网格生成和优化中，非Delaunay面通常通过执行局部网格变换（如所提到的双星 $2$–$3$ 翻转）来消除。因此，应该执行翻转以恢复网格的局部Delaunay属性。",
            "answer": "$$\\boxed{\\frac{7}{25}}$$"
        }
    ]
}