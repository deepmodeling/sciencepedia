{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, we begin with the core geometric principles of Delaunay triangulation. This first practice requires you to construct a triangulation for a small set of points directly from the 'empty circumcircle' definition, without relying on a pre-built algorithm. By also constructing the corresponding Voronoi diagram, you will gain a hands-on appreciation for the fundamental duality between these two structures, a concept that is central to many meshing and spatial data analysis techniques. ",
            "id": "3953020",
            "problem": "In two-dimensional mesh generation for Computational Fluid Dynamics (CFD), a common strategy is to place seed sites and construct a triangulation that favors numerical stability by avoiding skinny triangles. Consider a planar cross-section near a wing–fuselage junction where $4$ candidate mesh-seed sites are located at the coordinates $P_A=(0,0)$, $P_B=(3,0)$, $P_C=(1,2)$, and $P_D=(2,3)$, measured in meters. Using only the foundational definitions that (i) the Delaunay triangulation is the triangulation in which the circumcircle of each triangle contains no other site strictly inside, and (ii) the Voronoi diagram partitions the plane into regions of points closer to a given site than to any other, complete the following:\n\n1. From first principles, determine the Delaunay triangulation of the $4$ sites by deciding which diagonal of the convex quadrilateral formed by the sites yields triangles whose circumcircles are empty of the opposite site.\n2. Using the perpendicular-bisector characterization of circumcenters, explicitly compute the circumcenters of the two Delaunay triangles that share the chosen diagonal. \n3. Construct the Voronoi diagram of the $4$ sites by identifying the Voronoi vertices and edges induced by these circumcenters and the bisectors. Verify the duality between the Delaunay triangulation and the Voronoi diagram by showing that the Voronoi edge between the two sites connected by the Delaunay diagonal is the segment of the perpendicular bisector bounded by the two circumcenters of the adjacent Delaunay triangles.\n\nFinally, as a quantitative verification of the duality, compute the length of the Voronoi edge that is dual to the Delaunay edge connecting $P_B$ and $P_C$. Express your final answer as an exact value in meters (do not round) and report only this length.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information to determine a unique solution. The concepts of Delaunay triangulation and Voronoi diagrams are standard in computational geometry and its applications, such as CFD mesh generation. We proceed with the solution.\n\nThe given sites are $P_A=(0,0)$, $P_B=(3,0)$, $P_C=(1,2)$, and $P_D=(2,3)$.\n\n**Part 1: Determination of the Delaunay Triangulation**\n\nFirst, we establish that the four points form a convex quadrilateral. The vertices of the convex hull are $P_A, P_B, P_D, P_C$ in counter-clockwise order. We can verify this by checking that the diagonals $P_A P_D$ and $P_B P_C$ intersect.\nThe line passing through $P_A=(0,0)$ and $P_D=(2,3)$ has the equation $y = \\frac{3}{2}x$.\nThe line passing through $P_B=(3,0)$ and $P_C=(1,2)$ has a slope of $m = \\frac{2-0}{1-3} = -1$. Its equation is $y - 0 = -1(x-3)$, which simplifies to $y = -x+3$.\nTo find the intersection, we set the expressions for $y$ equal:\n$$ \\frac{3}{2}x = -x+3 $$\n$$ \\frac{5}{2}x = 3 \\implies x = \\frac{6}{5} $$\nThe corresponding $y$-coordinate is $y = -(\\frac{6}{5}) + 3 = \\frac{9}{5}$.\nThe intersection point is $(\\frac{6}{5}, \\frac{9}{5})$. Since $0 < \\frac{6}{5} < 2$ and $1 < \\frac{6}{5} < 3$, the intersection point lies on both line segments $P_A P_D$ and $P_B P_C$. Thus, the points form a convex quadrilateral $P_A P_B P_D P_C$.\n\nThere are two possible triangulations for this quadrilateral, corresponding to the choice of one of the two diagonals: $P_A P_D$ or $P_B P_C$. According to the definition of a Delaunay triangulation, the chosen diagonal must be such that for each of the two triangles it creates, the circumcircle of that triangle does not contain the fourth point (the opposite vertex of the quadrilateral). This is the Delaunay \"in-circle\" test.\n\nLet's test the diagonal $P_B P_C$. This choice creates two triangles: $\\triangle P_A P_B P_C$ and $\\triangle P_D P_B P_C$.\nWe must check if the circumcircle of $\\triangle P_A P_B P_C$ contains $P_D$, and if the circumcircle of $\\triangle P_D P_B P_C$ contains $P_A$.\n\nFirst, consider $\\triangle P_A P_B P_C$ with vertices $P_A=(0,0)$, $P_B=(3,0)$, $P_C=(1,2)$. Let the circumcenter be $O_{ABC}=(h,k)$ and the radius be $R_{ABC}$. The equation of the circumcircle is $(x-h)^2 + (y-k)^2 = R_{ABC}^2$.\nSince $P_A$ is on the circle: $(0-h)^2+(0-k)^2 = R_{ABC}^2 \\implies h^2+k^2=R_{ABC}^2$.\nSince $P_B$ is on the circle: $(3-h)^2+(0-k)^2 = R_{ABC}^2 \\implies 9-6h+h^2+k^2=h^2+k^2 \\implies 9-6h=0 \\implies h=\\frac{3}{2}$.\nSince $P_C$ is on the circle: $(1-h)^2+(2-k)^2 = R_{ABC}^2 \\implies (1-\\frac{3}{2})^2+(2-k)^2 = (\\frac{3}{2})^2+k^2$.\n$(-\\frac{1}{2})^2 + 4-4k+k^2 = \\frac{9}{4}+k^2 \\implies \\frac{1}{4}+4-4k = \\frac{9}{4} \\implies \\frac{17}{4}-4k=\\frac{9}{4}$.\n$4k = \\frac{17}{4} - \\frac{9}{4} = \\frac{8}{4}=2 \\implies k=\\frac{1}{2}$.\nThe circumcenter is $O_{ABC}=(\\frac{3}{2}, \\frac{1}{2})$. The squared radius is $R_{ABC}^2 = h^2+k^2 = (\\frac{3}{2})^2+(\\frac{1}{2})^2 = \\frac{9}{4}+\\frac{1}{4} = \\frac{10}{4} = \\frac{5}{2}$.\nNow we check if $P_D=(2,3)$ is inside this circle by evaluating the squared distance from $P_D$ to $O_{ABC}$:\n$d^2 = (2-\\frac{3}{2})^2 + (3-\\frac{1}{2})^2 = (\\frac{1}{2})^2 + (\\frac{5}{2})^2 = \\frac{1}{4} + \\frac{25}{4} = \\frac{26}{4} = \\frac{13}{2}$.\nSince $d^2 = \\frac{13}{2} > R_{ABC}^2 = \\frac{5}{2}$, the point $P_D$ lies outside the circumcircle of $\\triangle P_A P_B P_C$.\n\nThis result is sufficient to conclude that $P_B P_C$ is the correct Delaunay diagonal. The Delaunay triangulation is composed of $\\triangle P_A P_B P_C$ and $\\triangle P_D P_B P_C$.\n\n**Part 2: Explicit Computation of Circumcenters**\n\nThe problem requires using the perpendicular-bisector characterization. The circumcenter of a triangle is the intersection of the perpendicular bisectors of its sides.\n\nFor $\\triangle P_A P_B P_C$ with vertices $P_A=(0,0)$, $P_B=(3,0)$, $P_C=(1,2)$:\nThe side $P_A P_B$ is horizontal. Its midpoint is $(\\frac{0+3}{2}, \\frac{0+0}{2}) = (\\frac{3}{2}, 0)$. The perpendicular bisector is the vertical line $x = \\frac{3}{2}$.\nThe side $P_A P_C$ has midpoint $(\\frac{0+1}{2}, \\frac{0+2}{2}) = (\\frac{1}{2}, 1)$. Its slope is $\\frac{2-0}{1-0}=2$. The slope of the perpendicular bisector is $-\\frac{1}{2}$. The equation of this bisector is $y - 1 = -\\frac{1}{2}(x - \\frac{1}{2})$, which simplifies to $y = -\\frac{1}{2}x + \\frac{1}{4} + 1 = -\\frac{1}{2}x + \\frac{5}{4}$.\nThe circumcenter $O_{ABC}$ is the intersection of these two lines. Substituting $x=\\frac{3}{2}$ into the second equation:\n$y = -\\frac{1}{2}(\\frac{3}{2}) + \\frac{5}{4} = -\\frac{3}{4} + \\frac{5}{4} = \\frac{2}{4} = \\frac{1}{2}$.\nThus, the circumcenter is $O_{ABC} = (\\frac{3}{2}, \\frac{1}{2})$.\n\nFor $\\triangle P_D P_B P_C$ with vertices $P_D=(2,3)$, $P_B=(3,0)$, $P_C=(1,2)$:\nThe side $P_B P_C$ has midpoint $(\\frac{3+1}{2}, \\frac{0+2}{2}) = (2,1)$. Its slope is $\\frac{2-0}{1-3}=-1$. The slope of the perpendicular bisector is $1$. The equation is $y-1=1(x-2)$, or $y=x-1$.\nThe side $P_C P_D$ has midpoint $(\\frac{1+2}{2}, \\frac{2+3}{2}) = (\\frac{3}{2}, \\frac{5}{2})$. Its slope is $\\frac{3-2}{2-1}=1$. The slope of the perpendicular bisector is $-1$. The equation is $y-\\frac{5}{2}=-1(x-\\frac{3}{2})$, or $y=-x+\\frac{3}{2}+\\frac{5}{2}=-x+4$.\nThe circumcenter $O_{P_B P_C P_D}$ is the intersection of these two lines:\n$x-1 = -x+4 \\implies 2x=5 \\implies x=\\frac{5}{2}$.\n$y = x-1 = \\frac{5}{2}-1 = \\frac{3}{2}$.\nThus, the circumcenter is $O_{P_B P_C P_D} = (\\frac{5}{2}, \\frac{3}{2})$.\n\n**Part 3: Verification of Duality and Final Calculation**\n\nThe Voronoi diagram is the dual of the Delaunay triangulation. The vertices of the Voronoi diagram are the circumcenters of the Delaunay triangles. The edges of the Voronoi diagram are the segments of the perpendicular bisectors of the Delaunay edges.\nAn edge of the Voronoi diagram separating the Voronoi cells of two sites, $P_i$ and $P_j$, lies on the perpendicular bisector of the segment $P_i P_j$. This edge connects the circumcenters of the two Delaunay triangles that share the edge $P_i P_j$.\nIn our case, the Delaunay edge is the diagonal $P_B P_C$. This edge is shared by the two Delaunay triangles $\\triangle P_A P_B P_C$ and $\\triangle P_D P_B P_C$. The circumcenters of these triangles are $O_{ABC}$ and $O_{P_B P_C P_D}$, which are vertices of the Voronoi diagram. The Voronoi edge dual to the Delaunay edge $P_B P_C$ is therefore the line segment connecting $O_{ABC}$ and $O_{P_B P_C P_D}$.\nBoth $O_{ABC}$ and $O_{P_B P_C P_D}$ are equidistant from $P_B$ and $P_C$, so they both lie on the perpendicular bisector of the segment $P_B P_C$. The segment connecting $O_{ABC}$ and $O_{P_B P_C P_D}$ is therefore a segment of this perpendicular bisector, bounded by the two circumcenters, verifying the duality property as requested.\n\nThe final task is to compute the length of this Voronoi edge, which is the distance between its endpoints, $O_{ABC}=(\\frac{3}{2}, \\frac{1}{2})$ and $O_{P_B P_C P_D}=(\\frac{5}{2}, \\frac{3}{2})$.\nThe length $L$ is given by the Euclidean distance formula:\n$$ L = \\sqrt{\\left(\\frac{5}{2} - \\frac{3}{2}\\right)^2 + \\left(\\frac{3}{2} - \\frac{1}{2}\\right)^2} $$\n$$ L = \\sqrt{\\left(\\frac{2}{2}\\right)^2 + \\left(\\frac{2}{2}\\right)^2} $$\n$$ L = \\sqrt{1^2 + 1^2} $$\n$$ L = \\sqrt{1+1} $$\n$$ L = \\sqrt{2} $$\nThe coordinates are in meters, so the resulting length is in meters.",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        },
        {
            "introduction": "High-quality meshes are rarely constructed in a single step; they are often built by iteratively improving an initial triangulation. This exercise introduces the most common local optimization technique: the edge flip. You will explore the 'incircle test,' a robust algebraic predicate that determines whether a quadrilateral's diagonal is locally Delaunay, guiding the decision to flip it. Mastering this test provides insight into the computational engine that drives many powerful 2D mesh generators. ",
            "id": "3953059",
            "problem": "In a two-dimensional unstructured mesh used for high-order compressible Computational Fluid Dynamics (CFD) around a lifting surface, local edge flips are applied to enforce the Delaunay triangulation property, which improves angle quality and helps control numerical dispersion and conditioning in flux reconstruction. Consider a convex mesh quadrilateral formed by four nondimensionalized nodes (coordinates scaled by the airfoil chord): $A=(0,0)$, $B=(4,0)$, $C=(1,3)$, and $D=(0,1)$. The current triangulation uses the internal edge $AC$, forming the adjacent triangles $ABC$ and $ACD$. Using only the fundamental Delaunay empty-circumcircle definition and the orientation definition (signed area via a two-dimensional cross product), derive from first principles an algebraic inside-or-outside test for whether $D$ lies inside the circumcircle of triangle $ABC$ with its given geometric orientation. Evaluate this derived test for the given coordinates and decide whether flipping the diagonal from $AC$ to $BD$ restores the Delaunay condition locally. Report as your final answer the exact value of the signed algebraic incircle predicate you compute for $D$ with respect to $ABC$. Provide the exact integer value (no rounding).",
            "solution": "The Delaunay condition for a triangle states that its circumcircle contains no other mesh vertex in its interior. For a convex quadrilateral with diagonal $AC$ forming triangles $ABC$ and $ACD$, the edge $AC$ is locally Delaunay if and only if the vertex $D$ lies outside (or on) the circumcircle of $ABC$ and the vertex $B$ lies outside (or on) the circumcircle of $ACD$. Equivalently, when the quadrilateral is convex, it suffices to test one side: if $D$ is inside the circumcircle of $ABC$, then the diagonal $AC$ violates the Delaunay criterion and should be flipped to $BD$; otherwise, $AC$ is already locally Delaunay.\n\nWe begin from two fundamental bases:\n1. The Delaunay empty-circumcircle definition: given triangle $ABC$, a point $P$ lies inside its circumcircle if and only if the signed power of $P$ with respect to the circumcircle of $ABC$ is negative, and outside if it is positive, with the sign convention tied to the orientation of $ABC$.\n2. The planar orientation definition: the signed area (twice the area) of the oriented triangle $ABC$ is given by the determinant\n$$\n\\operatorname{orient}(A,B,C)=\n\\begin{vmatrix}\nx_A & y_A & 1 \\\\\nx_B & y_B & 1 \\\\\nx_C & y_C & 1\n\\end{vmatrix}\n= x_A(y_B-y_C) + x_B(y_C-y_A) + x_C(y_A-y_B).\n$$\nIf $\\operatorname{orient}(A,B,C) > 0$, then $ABC$ is counterclockwise (positively oriented); if it is $< 0$, it is clockwise.\n\nFrom analytic geometry, the circle through three noncollinear points $A$, $B$, and $C$ has an implicit equation that can be expressed in a homogeneous form involving the squared radius terms. A classical algebraic predicate equivalent to the empty-circumcircle test can be derived by eliminating the circle parameters using the condition that $A$, $B$, and $C$ lie on the circle, and then evaluating the sign of the resulting expression at a query point $P$. Concretely, define the function\n$$\n\\Phi(A,B,C;P) = \n\\begin{vmatrix}\nx_A & y_A & x_A^{2} + y_A^{2} & 1 \\\\\nx_B & y_B & x_B^{2} + y_B^{2} & 1 \\\\\nx_C & y_C & x_C^{2} + y_C^{2} & 1 \\\\\nx_P & y_P & x_P^{2} + y_P^{2} & 1\n\\end{vmatrix}.\n$$\nIt can be shown by direct derivation from the circle equation (obtained by subtracting the equations for $A$, $B$, and $C$ to eliminate the center and radius) that the sign of $\\Phi(A,B,C;P)$ is tied to both the location of $P$ relative to the circumcircle of $ABC$ and the orientation of $ABC$:\n- If $\\operatorname{orient}(A,B,C) > 0$ (counterclockwise), then $\\Phi(A,B,C;P) > 0$ if and only if $P$ lies strictly inside the circumcircle of $ABC$, $\\Phi(A,B,C;P) = 0$ if and only if $P$ lies on the circumcircle, and $\\Phi(A,B,C;P) < 0$ if and only if $P$ lies strictly outside.\n- If $\\operatorname{orient}(A,B,C) < 0$ (clockwise), the inequalities reverse.\n\nTherefore, to use this predicate consistently, we first check the orientation of $ABC$ and then evaluate $\\Phi(A,B,C;D)$.\n\nStep 1: Orientation of $ABC$.\nGiven $A=(0,0)$, $B=(4,0)$, and $C=(1,3)$, compute\n$$\n\\operatorname{orient}(A,B,C) =\n\\begin{vmatrix}\n0 & 0 & 1 \\\\\n4 & 0 & 1 \\\\\n1 & 3 & 1\n\\end{vmatrix}\n= 0\\cdot(0-3) - 0\\cdot(4-1) + 1\\cdot(4\\cdot 3 - 0\\cdot 1) = 12.\n$$\nThus $\\operatorname{orient}(A,B,C) = 12 > 0$, so $ABC$ is counterclockwise. The sign rule for $\\Phi$ is therefore: $\\Phi(A,B,C;P) > 0$ means $P$ is inside the circumcircle of $ABC$.\n\nStep 2: Evaluate the incircle predicate for $D$.\nLet $D=(0,1)$. Compute the required squared norms:\n$$\nx_A^{2}+y_A^{2} = 0^{2}+0^{2}=0,\\quad\nx_B^{2}+y_B^{2} = 4^{2}+0^{2}=16,\\quad\nx_C^{2}+y_C^{2} = 1^{2}+3^{2}=10,\\quad\nx_D^{2}+y_D^{2} = 0^{2}+1^{2}=1.\n$$\nForm the determinant\n$$\n\\Phi(A,B,C;D) =\n\\begin{vmatrix}\n0 & 0 & 0 & 1 \\\\\n4 & 0 & 16 & 1 \\\\\n1 & 3 & 10 & 1 \\\\\n0 & 1 & 1 & 1\n\\end{vmatrix}.\n$$\nCompute $\\Phi$ by expanding along the first row. Because the only nonzero entry in the first row is the last one, we have\n$$\n\\Phi(A,B,C;D) = (-1)^{1+4}\\cdot 1 \\cdot\n\\begin{vmatrix}\n4 & 0 & 16 \\\\\n1 & 3 & 10 \\\\\n0 & 1 & 1\n\\end{vmatrix}\n= - \n\\begin{vmatrix}\n4 & 0 & 16 \\\\\n1 & 3 & 10 \\\\\n0 & 1 & 1\n\\end{vmatrix}.\n$$\nNow evaluate the $3\\times 3$ determinant:\n$$\n\\begin{vmatrix}\n4 & 0 & 16 \\\\\n1 & 3 & 10 \\\\\n0 & 1 & 1\n\\end{vmatrix}\n= 4\\cdot\n\\begin{vmatrix}\n3 & 10 \\\\\n1 & 1\n\\end{vmatrix}\n- 0\\cdot(\\cdots) \n+ 16\\cdot\n\\begin{vmatrix}\n1 & 3 \\\\\n0 & 1\n\\end{vmatrix}.\n$$\nCompute the $2\\times 2$ determinants:\n$$\n\\begin{vmatrix}\n3 & 10 \\\\\n1 & 1\n\\end{vmatrix}\n= 3\\cdot 1 - 10\\cdot 1 = -7,\\qquad\n\\begin{vmatrix}\n1 & 3 \\\\\n0 & 1\n\\end{vmatrix}\n= 1\\cdot 1 - 3\\cdot 0 = 1.\n$$\nThus\n$$\n\\begin{vmatrix}\n4 & 0 & 16 \\\\\n1 & 3 & 10 \\\\\n0 & 1 & 1\n\\end{vmatrix}\n= 4\\cdot(-7) + 16\\cdot 1 = -28 + 16 = -12,\n$$\nand hence\n$$\n\\Phi(A,B,C;D) = -(-12) = 12.\n$$\n\nInterpretation and flip decision. Since $\\operatorname{orient}(A,B,C) > 0$ and $\\Phi(A,B,C;D) = 12 > 0$, the point $D$ lies strictly inside the circumcircle of triangle $ABC$. Therefore, triangle $ABC$ is not Delaunay with respect to the local quadrilateral, so the current edge $AC$ violates the local Delaunay condition. Consequently, flipping the diagonal from $AC$ to $BD$ restores the Delaunay condition.\n\nFor completeness, we check that the two triangles indeed form a valid convex quadrilateral with $B$ and $D$ on opposite sides of $AC$. Compute the signed orientations with respect to the line $AC$:\n$$\n\\operatorname{orient}(A,C,B) = \n\\begin{vmatrix}\n0 & 0 & 1 \\\\\n1 & 3 & 1 \\\\\n4 & 0 & 1\n\\end{vmatrix}\n= 0\\cdot(3-0) - 0\\cdot(1-4) + 1\\cdot(1\\cdot 0 - 3\\cdot 4) = -12 < 0,\n$$\n$$\n\\operatorname{orient}(A,C,D) = \n\\begin{vmatrix}\n0 & 0 & 1 \\\\\n1 & 3 & 1 \\\\\n0 & 1 & 1\n\\end{vmatrix}\n= 0\\cdot(3-1) - 0\\cdot(1-0) + 1\\cdot(1\\cdot 1 - 3\\cdot 0) = 1 > 0,\n$$\nso $B$ and $D$ lie on opposite sides of $AC$, confirming the validity of the local flip decision.\n\nTherefore, the exact value of the signed incircle predicate is $12$, and the correct local operation is to flip $AC$ to $BD$.",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "While 2D examples are instructive, real-world aerospace CFD simulations almost always operate in three dimensions. This practice generalizes the Delaunay criterion from triangles and circumcircles to tetrahedra and circumspheres. You will derive the 3D 'in-sphere' predicate, the higher-dimensional analogue of the incircle test, and apply it to decide on a 'face flip'—the fundamental local operation for optimizing 3D tetrahedral meshes. This exercise bridges the gap between 2D theory and 3D practical application. ",
            "id": "3953064",
            "problem": "Consider an unstructured tetrahedral mesh used in Computational Fluid Dynamics (CFD) for aerospace applications, where local mesh optimization relies on the Delaunay criterion. A tetrahedron is Delaunay if its circumsphere is empty of other mesh vertices. The fundamental base for this problem is the empty circumsphere characterization of Delaunay tessellations and the orientation predicate in Euclidean geometry: a point $\\boldsymbol{p}$ lies inside the circumsphere of a non-degenerate tetrahedron $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$ if and only if the signed “insphere” test is positive after correcting for orientation. Starting only from these definitions and the Euclidean inner product, derive the insphere predicate in determinant form for a tetrahedron, and then recast it as an orientation-invariant “power-of-point” difference relative to the tetrahedron’s circumsphere. Finally, apply the derived predicate to decide whether a local face flip (bistellar $2$–$3$ move) across the shared face $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c}\\}$ should be performed between the two tetrahedra $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$ and $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{e}\\}$ with vertices\n$\\boldsymbol{a}=(1,0,0)$, $\\boldsymbol{b}=(0,1,0)$, $\\boldsymbol{c}=(0,0,1)$, $\\boldsymbol{d}=(-1,0,0)$, and $\\boldsymbol{e}=(0.8,0.2,0.2)$.\nYou must:\n- Derive the determinant-based insphere predicate for $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$ evaluated at $\\boldsymbol{e}$ from the empty circumsphere definition via lifting to a higher dimension, and explain how orientation enters the sign.\n- Show the equivalence of the sign of this determinant to the sign of the orientation-invariant “power-of-point” difference $R^{2}-\\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^{2}$, where $\\boldsymbol{c}_{\\text{circ}}$ and $R$ are the circumcenter and circumradius of $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$.\n- Compute the orientation of $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$ and the orientation-invariant insphere predicate value for $\\boldsymbol{e}$ with respect to $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c},\\boldsymbol{d}\\}$, and use it to decide whether the face $\\{\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c}\\}$ is locally Delaunay.\nExpress the final predicate value as an exact rational number. No units are required. The final answer must be a single real number.",
            "solution": "The solution is presented in three parts as requested.\n\n**1. Derivation of the In-sphere Predicate**\n\nThe insphere predicate determines whether a point $\\boldsymbol{e}$ lies inside, on, or outside the circumsphere of a tetrahedron with vertices $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$. This can be derived by \"lifting\" the points from $\\mathbb{R}^3$ to a paraboloid in $\\mathbb{R}^4$.\n\nAn arbitrary sphere in $\\mathbb{R}^3$ with center $\\boldsymbol{c}_{\\text{circ}} = (c_x, c_y, c_z)$ and radius $R$ is described by the equation:\n$$\n(x - c_x)^2 + (y - c_y)^2 + (z - c_z)^2 - R^2 = 0\n$$\nExpanding this equation gives:\n$$\nx^2 + y^2 + z^2 - 2c_x x - 2c_y y - 2c_z z + (c_x^2 + c_y^2 + c_z^2 - R^2) = 0\n$$\nThis equation is linear in the variables $x$, $y$, $z$, and $w = x^2+y^2+z^2$. This suggests lifting a point $\\boldsymbol{p} = (p_x, p_y, p_z) \\in \\mathbb{R}^3$ to a point $\\boldsymbol{p}^* = (p_x, p_y, p_z, p_x^2+p_y^2+p_z^2) \\in \\mathbb{R}^4$. All such lifted points lie on the paraboloid $w = x^2+y^2+z^2$ in $\\mathbb{R}^4$.\n\nThe equation of the sphere now corresponds to a hyperplane in $\\mathbb{R}^4$. Four points $\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}$ are cospherical if and only if their lifted counterparts $\\boldsymbol{a}^*, \\boldsymbol{b}^*, \\boldsymbol{c}^*, \\boldsymbol{d}^*$ are coplanar (in a hyperplane in $\\mathbb{R}^4$).\n\nA fifth point $\\boldsymbol{e}$ lies on the circumsphere of $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$ if and only if its lifted point $\\boldsymbol{e}^*$ lies on the same hyperplane defined by $\\boldsymbol{a}^*, \\boldsymbol{b}^*, \\boldsymbol{c}^*, \\boldsymbol{d}^*$. This geometric condition is equivalent to the five points $\\boldsymbol{a}^*, \\boldsymbol{b}^*, \\boldsymbol{c}^*, \\boldsymbol{d}^*, \\boldsymbol{e}^*$ being linearly dependent when represented in homogeneous coordinates in $\\mathbb{R}^4$. This linear dependence is tested by checking if the determinant of the matrix formed by their homogeneous coordinates is zero.\n\nThe test for whether $\\boldsymbol{e}$ is inside, on, or outside the circumsphere is determined by the sign of the following $5 \\times 5$ determinant, which we define as the insphere predicate $\\text{InSphere}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}, \\boldsymbol{e})$:\n$$\n\\text{InSphere}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}, \\boldsymbol{e}) =\n\\det\n\\begin{pmatrix}\na_x & a_y & a_z & \\|\\boldsymbol{a}\\|^2 & 1 \\\\\nb_x & b_y & b_z & \\|\\boldsymbol{b}\\|^2 & 1 \\\\\nc_x & c_y & c_z & \\|\\boldsymbol{c}\\|^2 & 1 \\\\\nd_x & d_y & d_z & \\|\\boldsymbol{d}\\|^2 & 1 \\\\\ne_x & e_y & e_z & \\|\\boldsymbol{e}\\|^2 & 1\n\\end{pmatrix}\n$$\nwhere $\\|\\boldsymbol{p}\\|^2 = p_x^2 + p_y^2 + p_z^2$. The sign of this determinant indicates the position of $\\boldsymbol{e}$ relative to the oriented sphere through $\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}$.\n\nThe sign of this determinant depends on the order of the first four points. Specifically, it depends on the orientation of the tetrahedron $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$. The orientation, $\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})$, is given by the sign of the signed volume of the tetrahedron, which is proportional to the determinant:\n$$\n\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}) =\n\\det\n\\begin{pmatrix}\na_x & a_y & a_z & 1 \\\\\nb_x & b_y & b_z & 1 \\\\\nc_x & c_y & c_z & 1 \\\\\nd_x & d_y & d_z & 1\n\\end{pmatrix}\n$$\nBy convention, if $\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}) > 0$, then $\\text{InSphere}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}, \\boldsymbol{e}) > 0$ indicates that $\\boldsymbol{e}$ lies inside the circumsphere. If the orientation is negative, the meaning of the sign of the insphere test is flipped. Therefore, to obtain a consistent test for \"insideness\", one must account for the orientation. The problem states that the test is positive for an interior point *after correcting for orientation*, meaning the orientation-invariant test is what matters.\n\n**2. Equivalence to Power-of-Point Difference**\n\nWe aim to show that the sign of the insphere determinant is directly related to the power-of-point difference $R^2 - \\|\\boldsymbol{e} - \\boldsymbol{c}_{\\text{circ}}\\|^2$ and the orientation. Let the equation of the circumsphere of $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$ be $\\|\\boldsymbol{p} - \\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2 = 0$. This can be rewritten as:\n$$\n\\|\\boldsymbol{p}\\|^2 - 2\\boldsymbol{p}\\cdot\\boldsymbol{c}_{\\text{circ}} + \\|\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2 = 0\n$$\nLet $D$ be the insphere determinant. We perform a column operation on the matrix. Let $C_j$ denote the $j$-th column. We perform the operation $C_4 \\to C_4 - 2c_x C_1 - 2c_y C_2 - 2c_z C_3 + (\\|\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2) C_5$. This operation does not change the value of the determinant. An entry in the new 4th column for a point $\\boldsymbol{p}_i$ will be:\n$$\n\\|\\boldsymbol{p}_i\\|^2 - 2(p_{ix} c_x + p_{iy} c_y + p_{iz} c_z) + (\\|\\boldsymbol{c}_{\\text{circ}}\\|^2-R^2) = \\|\\boldsymbol{p}_i-\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2\n$$\nFor the points $\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}$ (which are on the circumsphere by definition), this value is $0$. For the point $\\boldsymbol{e}$, this value is $\\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2$. The determinant becomes:\n$$\nD = \\det\n\\begin{pmatrix}\na_x & a_y & a_z & 0 & 1 \\\\\nb_x & b_y & b_z & 0 & 1 \\\\\nc_x & c_y & c_z & 0 & 1 \\\\\nd_x & d_y & d_z & 0 & 1 \\\\\ne_x & e_y & e_z & \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2 & 1\n\\end{pmatrix}\n$$\nExpanding this determinant along the 4th column gives a single non-zero term corresponding to the last row:\n$$\nD = (\\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2) \\times (-1)^{5+4} \\det\n\\begin{pmatrix}\na_x & a_y & a_z & 1 \\\\\nb_x & b_y & b_z & 1 \\\\\nc_x & c_y & c_z & 1 \\\\\nd_x & d_y & d_z & 1\n\\end{pmatrix}\n$$\nThe remaining $4 \\times 4$ determinant is precisely the orientation determinant, $\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})$. Thus,\n$$\nD = (\\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2 - R^2) \\times (-1) \\times \\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})\n$$\n$$\nD = (R^2 - \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2) \\times \\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})\n$$\nThis identity shows that the orientation-invariant predicate value, which we can define as $P = D / \\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d})$, is exactly the power-of-point difference:\n$$\nP = R^2 - \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2\n$$\nThe point $\\boldsymbol{e}$ is inside the circumsphere if $P > 0$, on the sphere if $P = 0$, and outside if $P < 0$. This value $P$ is independent of the ordering of $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$ and is the quantity requested.\n\n**3. Calculation and Decision**\n\nWe are given the vertices:\n$\\boldsymbol{a}=(1,0,0)$, $\\boldsymbol{b}=(0,1,0)$, $\\boldsymbol{c}=(0,0,1)$, $\\boldsymbol{d}=(-1,0,0)$, $\\boldsymbol{e}=(0.8,0.2,0.2)$.\n\nFirst, we find the circumsphere of the tetrahedron $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$. We observe that the squared magnitudes of the vertices are $\\|\\boldsymbol{a}\\|^2 = 1$, $\\|\\boldsymbol{b}\\|^2 = 1$, $\\|\\boldsymbol{c}\\|^2 = 1$, and $\\|\\boldsymbol{d}\\|^2 = 1$. All four points lie on a sphere of radius $R=1$ centered at the origin $\\boldsymbol{c}_{\\text{circ}}=(0,0,0)$. Since four non-coplanar points define a unique sphere, this must be the circumsphere.\nSo, $\\boldsymbol{c}_{\\text{circ}}=(0,0,0)$ and $R=1$.\n\nNext, we compute the orientation of $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$:\n$$\n\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}) = \\det\n\\begin{pmatrix}\n1 & 0 & 0 & 1 \\\\\n0 & 1 & 0 & 1 \\\\\n0 & 0 & 1 & 1 \\\\\n-1 & 0 & 0 & 1\n\\end{pmatrix}\n$$\nAdding the first row to the fourth row ($R_4 \\to R_4 + R_1$):\n$$\n\\text{Orient}(\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}) = \\det\n\\begin{pmatrix}\n1 & 0 & 0 & 1 \\\\\n0 & 1 & 0 & 1 \\\\\n0 & 0 & 1 & 1 \\\\\n0 & 0 & 0 & 2\n\\end{pmatrix} = 1 \\cdot 1 \\cdot 1 \\cdot 2 = 2\n$$\nThe orientation is positive.\n\nNow, we compute the orientation-invariant insphere predicate value, $P = R^2 - \\|\\boldsymbol{e}-\\boldsymbol{c}_{\\text{circ}}\\|^2$.\n$$\nP = 1^2 - \\|(0.8, 0.2, 0.2) - (0,0,0)\\|^2 = 1 - (0.8^2 + 0.2^2 + 0.2^2)\n$$\nTo express this as an exact rational number, we use fractions: $0.8 = \\frac{4}{5}$ and $0.2 = \\frac{1}{5}$.\n$$\nP = 1 - \\left( \\left(\\frac{4}{5}\\right)^2 + \\left(\\frac{1}{5}\\right)^2 + \\left(\\frac{1}{5}\\right)^2 \\right) = 1 - \\left( \\frac{16}{25} + \\frac{1}{25} + \\frac{1}{25} \\right) = 1 - \\frac{18}{25} = \\frac{7}{25}\n$$\nThe value of the orientation-invariant insphere predicate is $\\frac{7}{25}$.\n\nFinally, we decide on the face flip. The predicate value $P = \\frac{7}{25}$ is positive. This means that the point $\\boldsymbol{e}$ lies *inside* the circumsphere of the tetrahedron $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}, \\boldsymbol{d}\\}$. This configuration violates the Delaunay criterion for the shared face $\\{\\boldsymbol{a}, \\boldsymbol{b}, \\boldsymbol{c}\\}$. Such a face is called non-Delaunay. In mesh generation and optimization, a non-Delaunay face is typically eliminated by performing a local mesh transformation, such as the bistellar $2$–$3$ flip mentioned. Therefore, the flip should be performed to restore the local Delaunay property of the mesh.\n\nThe problem asks for the final predicate value as an exact rational number. This value is $\\frac{7}{25}$.",
            "answer": "$$\n\\boxed{\\frac{7}{25}}\n$$"
        }
    ]
}