{
    "hands_on_practices": [
        {
            "introduction": "The primary motivation for using adaptive mesh refinement (AMR) is computational efficiency. This practice explores the fundamental relationship between the number of cells in a mesh and the computational work required for a finite volume solver. By analyzing the number of neighbor interactions, you will derive from first principles why the computational cost of a solver on a balanced octree mesh scales linearly with the number of cells, a crucial property denoted as $O(N)$ that makes AMR practical for large-scale simulations .",
            "id": "3988151",
            "problem": "Consider a three-dimensional finite volume discretization of the inviscid compressible flow equations within the framework of Computational Fluid Dynamics (CFD). In a balanced octree (three-dimensional analog of a quadtree) mesh, the domain is partitioned into leaves (cells) such that the mesh satisfies the standard 2:1 balance: adjacent leaves differ in edge length by at most a factor of $2$. In the Finite Volume Method (FVM), a numerical flux is evaluated once per unique interface between two adjacent leaves (an interior face) and once per boundary face on the physical boundary.\n\nA rectangular box domain is partitioned uniformly (all leaves are at the same octree level, hence balanced) into a grid of $m \\times n \\times p$ leaves, with $m = 12$, $n = 8$, and $p = 10$. All faces are treated as requiring flux evaluations: interior faces between adjacent leaves and boundary faces on the external boundary of the box.\n\nDefine a “neighbor interaction” as a single evaluation of the numerical flux either across a unique interior face shared by two leaves or across a boundary face between a leaf and the physical boundary. Starting from core definitions of the Finite Volume Method and geometric face counting on Cartesian partitions, derive an expression for the total number $T$ of neighbor interactions in terms of $m$, $n$, and $p$, and then evaluate $T$ for $m = 12$, $n = 8$, $p = 10$. Finally, justify from first principles why, for any balanced octree with $N$ leaves (not necessarily uniform), the total number of neighbor interactions is bounded by $O(N)$.\n\nExpress the final numerical value of $T$ as an integer. Do not include any units. No rounding is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is therefore deemed valid. The solution will be presented in three parts as requested: derivation of the total number of interactions $T$, evaluation of $T$ for the given parameters, and a first-principles justification for the asymptotic complexity of $T$.\n\nA \"neighbor interaction\" is defined as a numerical flux evaluation, which occurs once for each unique face in the mesh. These faces can be categorized as either interior faces (shared between two adjacent leaves) or boundary faces (on the external surface of the domain). Therefore, the total number of neighbor interactions, $T$, is equal to the total number of unique faces in the discretization.\n\n**Part 1: Derivation of the expression for $T$**\n\nWe are given a rectangular box domain partitioned into a uniform grid of $m \\times n \\times p$ cuboidal leaves. We can calculate the total number of faces by summing the faces oriented along each of the three principal axes.\n\n1.  **Faces perpendicular to the x-axis:**\n    The grid of leaves consists of $m$ cells along the x-direction. This arrangement creates $m+1$ distinct planes of faces oriented perpendicular to the x-axis. Each of these planes contains a grid of $n \\times p$ faces. Therefore, the total number of faces perpendicular to the x-axis is $T_x = (m+1)np$.\n\n2.  **Faces perpendicular to the y-axis:**\n    Similarly, there are $n$ cells along the y-direction, creating $n+1$ planes of faces. Each of these planes contains $m \\times p$ faces. The total number of faces perpendicular to the y-axis is $T_y = (n+1)mp$.\n\n3.  **Faces perpendicular to the z-axis:**\n    Following the same logic, there are $p$ cells along the z-direction, creating $p+1$ planes of faces. Each plane contains $m \\times n$ faces. The total number of faces perpendicular to the z-axis is $T_z = (p+1)mn$.\n\nThe total number of faces, $T$, is the sum of the faces in these three orientations:\n$$T = T_x + T_y + T_z = (m+1)np + (n+1)mp + (p+1)mn$$\nExpanding this expression gives:\n$$T = (mnp + np) + (mnp + mp) + (mnp + mn)$$\n$$T = 3mnp + mn + mp + np$$\nThis is the general expression for the total number of faces (and thus neighbor interactions) in a uniform $m \\times n \\times p$ Cartesian grid.\n\n**Part 2: Evaluation of $T$ for the given parameters**\n\nThe problem provides the dimensions of the grid as $m = 12$, $n = 8$, and $p = 10$. We substitute these values into the derived expression for $T$.\n\nFirst, we calculate the products:\n-   $mn = 12 \\times 8 = 96$\n-   $mp = 12 \\times 10 = 120$\n-   $np = 8 \\times 10 = 80$\n-   $mnp = 12 \\times 8 \\times 10 = 960$\n\nNow, substitute these into the formula for $T$:\n$$T = 3(960) + 96 + 120 + 80$$\n$$T = 2880 + 296$$\n$$T = 3176$$\nThus, for the specified grid, there are $3176$ total neighbor interactions.\n\n**Part 3: Justification of the $O(N)$ bound for a balanced octree**\n\nWe are asked to justify from first principles why the total number of neighbor interactions $T$ is bounded by $O(N)$ for any balanced octree with $N$ leaves. As before, $T$ is the total number of unique faces in the mesh. We can write $T$ as the sum of interior faces, $F_{int}$, and boundary faces, $F_{bndy}$:\n$$T = F_{int} + F_{bndy}$$\nWe will analyze the asymptotic behavior of $F_{int}$ and $F_{bndy}$ separately.\n\n1.  **Bounding the number of interior faces ($F_{int}$):**\n    An interior face is shared by exactly two leaves. This adjacency can be represented by a dual graph where each leaf is a vertex and an edge connects the vertices of two adjacent leaves. The number of interior faces, $F_{int}$, is precisely the number of edges in this dual graph.\n    The octree mesh is specified to be balanced with a 2:1 ratio. This means that for any two adjacent leaves, their edge lengths differ by at most a factor of $2$. This condition imposes a strict constraint on the local mesh topology. Consider a single leaf. It has $6$ faces. Due to the balance condition, a face of a given leaf can be adjacent to either one leaf of the same size or four leaves of half the size. It cannot be adjacent to, for example, $16$ leaves of a quarter size. Therefore, the number of neighbors for any given leaf through any of its $6$ faces is at most $4$. The total number of face-neighbors for any leaf is thus bounded by a constant, let's call it $C_{neighbors}$ (e.g., $C_{neighbors} \\le 6 \\times 4 = 24$).\n    In the dual graph with $N$ vertices, the degree of each vertex (number of neighbors of a leaf) is bounded by this constant $C_{neighbors}$. According to the handshaking lemma, the sum of the degrees of all vertices is equal to twice the number of edges: $\\sum_{i=1}^{N} \\text{degree}(v_i) = 2 F_{int}$.\n    Since the degree of each vertex is bounded by $C_{neighbors}$, we have:\n    $$2 F_{int} = \\sum_{i=1}^{N} \\text{degree}(v_i) \\le \\sum_{i=1}^{N} C_{neighbors} = C_{neighbors}N$$\n    This implies $F_{int} \\le \\frac{C_{neighbors}}{2}N$. Therefore, the number of interior faces is linearly proportional to the number of leaves, or $F_{int} = O(N)$.\n\n2.  **Bounding the number of boundary faces ($F_{bndy}$):**\n    The boundary faces are the faces of the leaves that lie on the external boundary of the physical domain. The problems in CFD typically involve domains in $\\mathbb{R}^3$ that are compact and have piece-wise smooth boundaries (e.g., aircraft, turbine blades). For such non-fractal domains, there is a fundamental relationship between the volume and the surface area.\n    Let $h$ be the characteristic edge length of the smallest cells in the mesh. The total number of leaves, $N$, required to fill the domain's volume, $V$, scales as $N \\propto V/h^3$. The number of boundary faces, $F_{bndy}$, required to tile the domain's surface area, $A$, scales as $F_{bndy} \\propto A/h^2$.\n    From the scaling of $N$, we can write $h \\propto N^{-1/3}$ (assuming constant $V$). Substituting this into the scaling for $F_{bndy}$ gives:\n    $$F_{bndy} \\propto (N^{-1/3})^{-2} = N^{2/3}$$\n    Since an asymptotic bound of $O(N^{2/3})$ is a tighter bound than, and thus included in, $O(N)$, we can state that $F_{bndy} = O(N)$.\n\n3.  **Conclusion for the total number of interactions ($T$):**\n    Combining the results for the interior and boundary faces, we find the total number of interactions:\n    $$T = F_{int} + F_{bndy} = O(N) + O(N) = O(N)$$\n    This demonstrates from first principles—the structural constraint of the balanced octree and the geometric properties of physical domains—that the total number of neighbor interactions scales linearly with the total number of leaves.",
            "answer": "$$\\boxed{3176}$$"
        },
        {
            "introduction": "A cornerstone of the finite volume method is the strict enforcement of conservation laws, which is complicated by the presence of refinement boundaries in an AMR grid. This exercise challenges you to design a flux redistribution scheme that guarantees conservation across interfaces between coarse and fine cells. You will derive a method to compute a single, consistent flux for a coarse face from its smaller neighbors, a critical technique for ensuring that the simulation correctly captures physical quantities like mass, momentum, and energy .",
            "id": "3988152",
            "problem": "Consider a two-dimensional scalar advection equation in Computational Fluid Dynamics (CFD),\n$$\n\\frac{\\partial u}{\\partial t} + \\nabla \\cdot (\\mathbf{a}\\, u) = 0,\n$$\nwith constant advection velocity $\\mathbf{a} \\in \\mathbb{R}^{2}$ on a finite-volume quadtree mesh. Let a coarse control volume at level $\\ell$ have a straight face of total length $L$ that is adjacent across a refinement boundary to $m$ finer neighbors at level $\\ell+1$, so that the coarse face is exactly partitioned into $m$ disjoint child subfaces of lengths $\\{l_i\\}_{i=1}^{m}$, with $\\sum_{i=1}^{m} l_i = L$. Denote by $\\mathbf{n}$ the outward unit normal of the coarse cell on that face, and define the normal advective flux density\n$$\n\\varphi(s) \\equiv (\\mathbf{a} \\cdot \\mathbf{n})\\, u(s),\n$$\nwhere $s$ denotes the arclength coordinate along the face, measured with origin at the coarse-face centroid to ensure symmetry.\n\nAssume a second-order accurate face-centered reconstruction is used on the fine level, providing $m$ numerical flux density values $\\{\\phi_i\\}_{i=1}^{m}$ at the geometric midpoints $\\{s_i\\}_{i=1}^{m}$ of the subfaces, each consistent with $\\varphi(s)$ in the sense that $\\phi_i = \\varphi(s_i) + \\mathcal{O}(h_i^{2})$, where $h_i$ is the local fine-level characteristic size normal to the face. To alleviate the small-cell restriction imposed by the Courant–Friedrichs–Lewy (CFL) condition on the fine cells, you are tasked to construct a conservative coarse-face flux for a merged control-volume update that permits a coarse-level time step while preserving total mass and maintaining second-order accuracy in smooth regions.\n\nStarting from the integral finite-volume update and the divergence theorem, and using only well-tested numerical quadrature facts, derive a conservative flux redistribution scheme across the refinement interface in which the coarse cell uses a single merged face flux density $\\Phi_{\\mathrm{C}}$ computed from $\\{l_i\\}$ and $\\{\\phi_i\\}$. Impose the following two requirements:\n\n- Conservation: the integrated coarse-face flux equals the sum of the integrated fine subface fluxes across the interface for any $m$,\n$$\n\\text{Integrated coarse-face flux} = \\sum_{i=1}^{m} \\text{Integrated fine-face flux}_i.\n$$\n\n- Second-order accuracy in smooth regions: for sufficiently smooth $u(s)$, the merged coarse-face flux density $\\Phi_{\\mathrm{C}}$ must be second-order accurate with respect to the face length $L$, independent of the distribution of $\\{l_i\\}$, provided the local reconstruction at fine faces is second-order accurate.\n\nProvide the final closed-form analytical expression for the merged conservative coarse-face flux density $\\Phi_{\\mathrm{C}}$ in terms of $\\{l_i\\}$, $\\{\\phi_i\\}$, and $L$. Your answer must be a single expression. No rounding is required, and no units should be included in the final expression.",
            "solution": "The task is to derive a closed-form analytical expression for a merged coarse-face flux density, denoted $\\Phi_{\\mathrm{C}}$, for use in a finite-volume scheme on a quadtree mesh. The derivation must satisfy two specific requirements: conservation of flux across the refinement interface and second-order accuracy in space.\n\nLet the coarse-face be denoted by $\\mathcal{F}$ and its $m$ adjacent fine-level subfaces by $\\{\\mathcal{F}_i\\}_{i=1}^{m}$. The length of the coarse face is $L$, and the lengths of the subfaces are $\\{l_i\\}_{i=1}^{m}$, such that $\\sum_{i=1}^{m} l_i = L$. The problem provides the numerical flux density values $\\{\\phi_i\\}_{i=1}^{m}$ at the geometric midpoints of the fine subfaces.\n\nThe first requirement is **conservation**. This principle, fundamental to the finite-volume method, demands that the total flux passing through the coarse face $\\mathcal{F}$ must be identical to the sum of the fluxes passing through the constituent subfaces $\\{\\mathcal{F}_i\\}$. In a finite-volume context, the integral of a flux density over a face is approximated by the product of the representative flux density and the face's measure (length in this 2D case).\n\nThe integrated flux across the coarse face $\\mathcal{F}$ is given by $\\Phi_{\\mathrm{C}} L$.\nThe integrated flux across the $i$-th fine subface $\\mathcal{F}_i$ is given by $\\phi_i l_i$.\n\nThe conservation requirement is mathematically stated as:\n$$\n\\text{Integrated coarse-face flux} = \\sum_{i=1}^{m} \\text{Integrated fine-face flux}_i\n$$\n$$\n\\Phi_{\\mathrm{C}} L = \\sum_{i=1}^{m} \\phi_i l_i\n$$\nThis equation provides a unique expression for $\\Phi_{\\mathrm{C}}$ that is conservative by construction. Solving for $\\Phi_{\\mathrm{C}}$, we obtain our candidate expression for the merged coarse-face flux density:\n$$\n\\Phi_{\\mathrm{C}} = \\frac{1}{L} \\sum_{i=1}^{m} \\phi_i l_i\n$$\nThis expression represents a length-weighted average of the fine-face flux densities.\n\nThe second requirement is **second-order accuracy**. We must verify that the derived expression for $\\Phi_{\\mathrm{C}}$ is a second-order accurate approximation to the exact flux density, $\\varphi(s)$, at the centroid of the coarse face, $s=0$. That is, we must show $\\Phi_{\\mathrm{C}} = \\varphi(0) + \\mathcal{O}(L^2)$.\n\nWe are given that the fine-face flux densities are themselves second-order accurate:\n$$\n\\phi_i = \\varphi(s_i) + \\mathcal{O}(h_i^2)\n$$\nwhere $s_i$ is the midpoint of the subface $\\mathcal{F}_i$, and $h_i$ is the local characteristic cell size. For a quadtree mesh, $h_i$ is proportional to the face length $l_i$, so we can write this as $\\phi_i = \\varphi(s_i) + \\mathcal{O}(l_i^2)$.\n\nSubstituting this into our expression for $\\Phi_{\\mathrm{C}}$:\n$$\n\\Phi_{\\mathrm{C}} = \\frac{1}{L} \\sum_{i=1}^{m} l_i \\left( \\varphi(s_i) + \\mathcal{O}(l_i^2) \\right) = \\left( \\frac{1}{L} \\sum_{i=1}^{m} l_i \\varphi(s_i) \\right) + \\left( \\frac{1}{L} \\sum_{i=1}^{m} \\mathcal{O}(l_i^3) \\right)\n$$\nLet's analyze the two terms on the right-hand side. The second term is the accumulated error from the fine-face reconstructions. Since $\\sum_{i=1}^{m}l_i = L$ and $l_i \\le L$, we have $\\sum_{i=1}^{m}l_i^3 \\le \\max(l_i^2) \\sum_{i=1}^{m}l_i \\le L^2 \\cdot L = L^3$. Thus, the second term is of order $\\frac{1}{L}\\mathcal{O}(L^3) = \\mathcal{O}(L^2)$, which is consistent with the overall second-order accuracy requirement.\n\nNow we focus on the first term. To analyze its accuracy, we perform a Taylor series expansion of the exact flux density $\\varphi(s)$ around the coarse-face centroid $s=0$:\n$$\n\\varphi(s) = \\varphi(0) + s \\frac{d\\varphi}{ds}\\bigg|_{s=0} + \\frac{s^2}{2} \\frac{d^2\\varphi}{ds^2}\\bigg|_{s=0} + \\mathcal{O}(s^3)\n$$\nFor simplicity of notation, let $\\varphi'(0) = \\frac{d\\varphi}{ds}\\big|_{s=0}$ and $\\varphi''(0) = \\frac{d^2\\varphi}{ds^2}\\big|_{s=0}$.\nThen, $\\varphi(s_i) = \\varphi(0) + s_i \\varphi'(0) + \\frac{s_i^2}{2} \\varphi''(0) + \\mathcal{O}(s_i^3)$.\n\nThe first term of our $\\Phi_{\\mathrm{C}}$ expression becomes:\n$$\n\\frac{1}{L} \\sum_{i=1}^{m} l_i \\varphi(s_i) = \\frac{1}{L} \\sum_{i=1}^{m} l_i \\left( \\varphi(0) + s_i \\varphi'(0) + \\frac{s_i^2}{2} \\varphi''(0) + \\mathcal{O}(s_i^3) \\right)\n$$\n$$\n= \\varphi(0) \\left( \\frac{1}{L} \\sum_{i=1}^{m} l_i \\right) + \\varphi'(0) \\left( \\frac{1}{L} \\sum_{i=1}^{m} l_i s_i \\right) + \\frac{\\varphi''(0)}{2} \\left( \\frac{1}{L} \\sum_{i=1}^{m} l_i s_i^2 \\right) + \\mathcal{O}(L^2)\n$$\nWe analyze each coefficient:\n1.  Since $\\sum_{i=1}^{m} l_i = L$, the coefficient of $\\varphi(0)$ is $1$. The leading term is correctly $\\varphi(0)$.\n2.  The coefficient of $\\varphi'(0)$ involves the sum $\\sum_{i=1}^{m} l_i s_i$. This is a composite midpoint rule quadrature for the integral $\\int_{-L/2}^{L/2} s \\, ds$. A well-known property of the midpoint rule is that it is exact for polynomials of degree $1$. Therefore:\n    $$\n    \\sum_{i=1}^{m} l_i s_i = \\sum_{i=1}^{m} \\int_{\\mathcal{F}_i} s \\, ds = \\int_{-L/2}^{L/2} s \\, ds = \\left[ \\frac{s^2}{2} \\right]_{-L/2}^{L/2} = 0\n    $$\n    The term proportional to $\\varphi'(0)$ vanishes, meaning the scheme is at least first-order accurate.\n3.  The coefficient of $\\varphi''(0)$ involves the sum $\\sum_{i=1}^{m} l_i s_i^2$, which approximates $\\int_{-L/2}^{L/2} s^2 \\, ds = \\frac{L^3}{12}$. This sum represents the leading-order truncation error of the quadrature. The error for the midpoint rule on an interval of length $l$ for an integrand $f(s)$ is $\\frac{l^3}{24} f''(\\xi)$. Here, $f(s) = s^2$, so $f''(s) = 2$.\n    The error on subface $\\mathcal{F}_i$ is $\\int_{\\mathcal{F}_i} s^2 ds - l_i s_i^2 = \\frac{l_i^3}{12}$.\n    Summing the errors: $\\int_{-L/2}^{L/2} s^2 ds - \\sum_{i=1}^{m} l_i s_i^2 = \\sum_{i=1}^{m} \\frac{l_i^3}{12}$.\n    So, $\\sum_{i=1}^{m} l_i s_i^2 = \\frac{L^3}{12} - \\frac{1}{12}\\sum_{i=1}^{m} l_i^3$.\n    The third term in the expansion is $\\frac{\\varphi''(0)}{2L} \\left(\\frac{L^3}{12} - \\frac{1}{12}\\sum_{i=1}^{m} l_i^3 \\right) = \\frac{\\varphi''(0)}{24} \\left( L^2 - \\frac{1}{L}\\sum_{i=1}^{m} l_i^3 \\right)$. This entire term is of order $\\mathcal{O}(L^2)$.\n\nCombining all results, the full expression for $\\Phi_{\\mathrm{C}}$ is:\n$$\n\\Phi_{\\mathrm{C}} = \\varphi(0) + \\frac{\\varphi''(0)}{24} \\left( L^2 - \\frac{1}{L}\\sum_{i=1}^{m} l_i^3 \\right) + \\mathcal{O}(L^2) + \\mathcal{O}(L^3)\n$$\nThe total error is dominated by the terms of order $\\mathcal{O}(L^2)$. Thus, $\\Phi_{\\mathrm{C}} = \\varphi(0) + \\mathcal{O}(L^2)$, and the second-order accuracy requirement is satisfied.\n\nThe derived expression is therefore both conservative and second-order accurate, and it depends only on the provided quantities $\\{l_i\\}$, $\\{\\phi_i\\}$, and $L$.",
            "answer": "$$\n\\boxed{\\frac{1}{L} \\sum_{i=1}^{m} \\phi_i l_i}\n$$"
        },
        {
            "introduction": "While mesh refinement sharpens solution features, mesh coarsening can introduce numerical errors, especially near discontinuities like shock waves. This hands-on problem quantifies the local truncation error generated when two fine cells resolving a shock are merged into a single coarse cell. By analyzing this error, you will gain insight into the delicate interplay between the grid dynamics of AMR and the accuracy of the numerical solution, revealing why sophisticated limiters are essential for stability .",
            "id": "3988133",
            "problem": "Consider a quadtree-based Adaptive Mesh Refinement (AMR) discretization of a scalar, inviscid, constant-coefficient linear advection equation in a two-dimensional setting that is uniform in the transverse direction, so the dynamics reduce to one spatial dimension along the streamwise axis. The governing conservation law is the scalar advection equation in conservation form, $\\partial u / \\partial t + \\partial f(u) / \\partial x = 0$, with $f(u) = a\\,u$ and constant advection speed $a > 0$. A planar, shock-aligned discontinuity separates a left state $u_{L}$ and a right state $u_{R}$, with the discontinuity exactly aligned with an internal face of the finest-level quadtree cells prior to any mesh change. The numerical method is a conservative finite-volume scheme that updates cell averages via the semi-discrete balance $\\mathrm{d}\\bar{u}_{i}/\\mathrm{d}t = -\\left(F_{i+1/2}-F_{i-1/2}\\right)/\\Delta x$, where $F_{i\\pm 1/2}$ is a consistent numerical flux computed by the Godunov upwind flux for linear advection, i.e., $F_{i+1/2} = a\\,u_{\\text{left at }i+1/2}$ for $a>0$.\n\nInitially, two sibling fine cells of width $h$ share the shock-aligned internal face, so the discontinuity lies exactly on their shared face and each cell average equals the corresponding exact state. A mesh coarsening operation merges these two siblings into a single coarse control volume of width $2h$ that now contains the discontinuity strictly in its interior. The coarse-cell average is defined by conservative averaging of its two children. Immediately after this coarsening, consider the semi-discrete finite-volume operator applied to the exact weak solution (piecewise-constant $u(x)$ with a jump at the cell midpoint). Define the local truncation error in the coarse cell as the signed semi-discrete residual,\n$$\n\\mathcal{T} \\equiv -\\frac{F_{E} - F_{W}}{2h},\n$$\nwhere $F_{W}$ and $F_{E}$ are the numerical fluxes at the west and east faces of the coarse cell, respectively, computed by the Godunov upwind flux with $a>0$ and using cell averages as the representative states on each side of the interface.\n\nTasks:\n- Starting from the conservation-law finite-volume update and the definition of the Godunov upwind flux for $a>0$, derive a closed-form expression for $\\mathcal{T}$ in terms of $a$, $u_{L}$, $u_{R}$, and $h$ that captures the leading-order truncation error introduced solely by this coarsening step.\n- Briefly justify, from conservation and monotonicity principles, how employing a Total Variation Diminishing (TVD) limiter (for example, the minmod limiter) during prolongation (coarse-to-fine reconstruction) suppresses spurious oscillations when the mesh is re-refined in the vicinity of the discontinuity.\n\nProvide your final answer for the truncation error $\\mathcal{T}$ as a single closed-form analytic expression in terms of $a$, $u_{L}$, $u_{R}$, and $h$. Do not include units. No rounding is required.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, self-contained, well-posed, and objective. It presents a standard problem in the numerical analysis of conservation laws. The solution process proceeds in two parts as requested.\n\n### Part 1: Derivation of the Truncation Error $\\mathcal{T}$\n\nThe problem asks for the local truncation error $\\mathcal{T}$ introduced by a single coarsening operation over a discontinuity. The setup involves the one-dimensional scalar advection equation $\\partial u / \\partial t + \\partial f(u) / \\partial x = 0$ with a linear flux $f(u) = a u$, where the advection speed $a$ is a positive constant, $a > 0$.\n\nInitially, we consider two adjacent fine cells of equal width $h$. The interface between them is perfectly aligned with a jump discontinuity separating a left state $u_{L}$ from a right state $u_{R}$. Let the left cell be indexed by $i$ and the right cell by $i+1$. The problem states that the cell average in each cell is equal to the corresponding exact state. Thus, the cell average in cell $i$ is $\\bar{u}_{i} = u_{L}$, and the cell average in cell $i+1$ is $\\bar{u}_{i+1} = u_{R}$.\n\nA mesh coarsening operation merges these two sibling cells into a single coarse cell, which we will index by $I$. The width of this new coarse cell is the sum of the widths of its children, so its width is $h+h=2h$. The problem specifies that the cell average for the new coarse cell, $\\bar{u}_{I}$, is determined by conservative averaging of its children. The total amount of the conserved quantity $u$ must be preserved during this averaging. The total quantity in the coarse cell is $\\bar{u}_{I} \\cdot (2h)$, and the sum of quantities in the child cells is $\\bar{u}_{i} \\cdot h + \\bar{u}_{i+1} \\cdot h$. Equating these gives:\n$$\n\\bar{u}_{I} (2h) = \\bar{u}_{i} h + \\bar{u}_{i+1} h\n$$\nSubstituting the known initial averages $\\bar{u}_{i} = u_{L}$ and $\\bar{u}_{i+1} = u_{R}$:\n$$\n\\bar{u}_{I} (2h) = u_{L} h + u_{R} h\n$$\nSolving for the coarse cell average $\\bar{u}_{I}$ yields:\n$$\n\\bar{u}_{I} = \\frac{u_{L} + u_{R}}{2}\n$$\nThis represents a numerical smearing of the discontinuity into a single cell average.\n\nNext, we compute the local truncation error, which is defined as the semi-discrete residual for this coarse cell:\n$$\n\\mathcal{T} \\equiv -\\frac{F_{E} - F_{W}}{2h}\n$$\nHere, $F_{W}$ and $F_{E}$ are the numerical fluxes at the west and east faces of the coarse cell $I$, respectively. The flux is the Godunov upwind flux, which for linear advection with $a > 0$ is given by $F = a u_{\\text{left}}$, where $u_{\\text{left}}$ is the state on the left side of the interface. The states on either side of an interface are taken to be the cell averages of the corresponding cells.\n\nTo compute the west flux $F_{W}$ at the boundary between cell $I$ and its western neighbor, we need the states in these two cells. The state within cell $I$ is $\\bar{u}_{I} = \\frac{u_{L} + u_{R}}{2}$. Since the initial condition is a planar shock, the region to the west of the original fine cell $i$ has the uniform state $u_{L}$. Therefore, the cell average of the western neighbor to cell $I$ is $u_{L}$. For the Godunov flux with $a > 0$, we take the state to the left of the interface:\n$$\nF_{W} = a \\cdot u_{L}\n$$\nTo compute the east flux $F_{E}$ at the boundary between cell $I$ and its eastern neighbor, we use the state within cell $I$, which is $\\bar{u}_{I}$, and the state of the eastern neighbor. By the same reasoning as for the western neighbor, the region to the east of the original fine cell $i+1$ has the uniform state $u_{R}$. Thus, the cell average of the eastern neighbor is $u_{R}$. For the Godunov flux with $a > 0$, we take the state to the left of the interface, which is the state in cell $I$:\n$$\nF_{E} = a \\cdot \\bar{u}_{I} = a \\left(\\frac{u_{L} + u_{R}}{2}\\right)\n$$\nNow we substitute these flux expressions into the definition of $\\mathcal{T}$:\n$$\n\\mathcal{T} = -\\frac{1}{2h} \\left( F_{E} - F_{W} \\right) = -\\frac{1}{2h} \\left( a \\frac{u_{L} + u_{R}}{2} - a u_{L} \\right)\n$$\nWe can factor out the constant $a$:\n$$\n\\mathcal{T} = -\\frac{a}{2h} \\left( \\frac{u_{L} + u_{R}}{2} - u_{L} \\right)\n$$\nSimplifying the term in the parenthesis:\n$$\n\\mathcal{T} = -\\frac{a}{2h} \\left( \\frac{u_{L} + u_{R} - 2u_{L}}{2} \\right) = -\\frac{a}{2h} \\left( \\frac{u_{R} - u_{L}}{2} \\right)\n$$\nThis gives the final closed-form expression for the leading-order truncation error introduced by the coarsening step:\n$$\n\\mathcal{T} = -\\frac{a(u_{R} - u_{L})}{4h}\n$$\nThis term represents a spurious source or sink term introduced into the semi-discrete equation precisely because the sharp discontinuity has been averaged over the coarse cell volume. It is proportional to the wave speed $a$ and the jump strength $(u_R - u_L)$, and inversely proportional to the cell size $h$.\n\n### Part 2: Justification for TVD Limiters in Prolongation\n\nWhen a coarse cell containing a numerically smeared discontinuity is re-refined into finer cells (a process called prolongation), it is necessary to reconstruct a profile of the solution within the coarse cell to assign values to the new child cells. A simple, low-order reconstruction, such as zeroth-order (piecewise constant), would assign the coarse cell average to all children, leading to excessive numerical diffusion. A higher-order reconstruction, such as piecewise linear, aims to recover more of the sub-cell structure.\n\nHowever, using a naive high-order reconstruction (e.g., an unlimited linear reconstruction based on centered differences) in the vicinity of a steep gradient or discontinuity is known to produce spurious oscillations, often called Gibbs phenomena or overshoots/undershoots. These oscillations are non-physical, as they represent the creation of new local extrema in the solution, which is a behavior that violates fundamental properties of the exact solution to a scalar conservation law.\n\nThe justification for using a Total Variation Diminishing (TVD) limiter during prolongation is rooted in two key principles:\n\n1.  **Conservation**: The reconstruction must be conservative, meaning the average of the reconstructed values over the new child cells must equal the original coarse cell average. This is typically satisfied by construction.\n\n2.  **Monotonicity**: The numerical method should be monotonicity-preserving. The exact solution of a scalar conservation law does not create new local maxima or minima. A numerical scheme that does is unstable and produces non-physical results. The Total Variation (TV) of the solution, defined discretely as $TV(\\bar{u}) = \\sum_{j} |\\bar{u}_{j+1} - \\bar{u}_{j}|$, is a measure of its oscillatory content. For the exact solution, the total variation is non-increasing in time, i.e., $TV(u(\\cdot, t_2)) \\le TV(u(\\cdot, t_1))$ for $t_2 > t_1$. A TVD scheme is one that enforces this property on the discrete solution.\n\nDuring prolongation, a TVD limiter (such as minmod, superbee, or van Leer) is applied to the slopes of the reconstructed profiles within each coarse cell. The limiter's function is to enforce a local monotonicity constraint. It does this by comparing the initially computed slope against slopes that would connect the cell's average to its neighbors' averages. If the reconstruction with the initial slope would create a new extremum (i.e., a value outside the range defined by the neighboring cell averages), the limiter reduces the magnitude of the slope—in some cases setting it to zero—to prevent the over- or undershoot.\n\nFor example, the `minmod` limiter selects the slope with the smallest magnitude among the forward, backward, and centered difference-based slopes, and returns zero if they have different signs. This ensures that the reconstructed profile within the coarse cell remains bounded by the max/min of its immediate neighbors. By enforcing this local monotonicity, the TVD limiter ensures that the prolongation step does not introduce spurious oscillations into the solution. This maintains the physical integrity and stability of the numerical solution when the mesh is dynamically refined near discontinuities.",
            "answer": "$$\n\\boxed{-\\frac{a(u_{R} - u_{L})}{4h}}\n$$"
        }
    ]
}