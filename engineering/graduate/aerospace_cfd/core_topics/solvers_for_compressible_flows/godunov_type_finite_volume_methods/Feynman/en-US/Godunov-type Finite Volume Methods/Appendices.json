{
    "hands_on_practices": [
        {
            "introduction": "Understanding the behavior of discontinuities like shock waves is the first step in building a robust shock-capturing scheme. This practice takes you back to first principles, deriving the Rankine-Hugoniot jump conditions directly from the integral form of the Euler equations. Mastering this derivation solidifies the physical foundation upon which Godunov-type methods are built, clarifying how mass, momentum, and energy are conserved across a moving wave front.",
            "id": "3963108",
            "problem": "In Computational Fluid Dynamics (CFD) with Godunov-type finite volume methods, intercell fluxes are obtained by solving local Riemann problems and propagating discontinuities according to conservation laws. Consider a one-dimensional inviscid compressible flow of a calorically perfect gas with constant ratio of specific heats $\\gamma$. A planar discontinuity separating a left state and a right state moves with unknown speed $s$. Starting from the integral conservation laws for mass, momentum, and total energy for the one-dimensional Euler equations, and using only fundamental definitions of the conserved variables and fluxes, derive the generic Rankine–Hugoniot jump conditions across an arbitrary moving discontinuity.\n\nThen, for the specific calorically perfect gas with $\\gamma = 1.4$ and the following left and right states (given in the laboratory frame):\n- Left state: $\\rho_{L} = 1.0$ $\\mathrm{kg/m^{3}}$, $u_{L} = 750$ $\\mathrm{m/s}$, $p_{L} = 1.0 \\times 10^{5}$ $\\mathrm{Pa}$,\n- Right state: $\\rho_{R} = 3.\\overline{3}$ $\\mathrm{kg/m^{3}}$, $u_{R} = 95.20995731456036$ $\\mathrm{m/s}$, $p_{R} = 7.125 \\times 10^{5}$ $\\mathrm{Pa}$,\n\ncompute the discontinuity speed $s$ that satisfies the derived Rankine–Hugoniot conditions. Round your final value of $s$ to four significant figures and express it in $\\mathrm{m/s}$. Assume the specific total energy per unit mass is $E = e + \\tfrac{1}{2} u^{2}$ with internal energy $e = \\dfrac{p}{(\\gamma - 1)\\rho}$.",
            "solution": "The problem consists of two parts. First, to derive the Rankine-Hugoniot jump conditions for a one-dimensional inviscid compressible flow from the integral form of the Euler equations. Second, to compute the speed of a specific discontinuity, $s$, given its left and right states.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- **System**: 1D inviscid compressible flow.\n- **Gas Model**: Calorically perfect gas with constant ratio of specific heats, $\\gamma$.\n- **Discontinuity**: A planar discontinuity separating a left state (L) and a right state (R), moving with an unknown speed $s$.\n- **Governing Equations**: The integral form of the 1D Euler equations for mass, momentum, and total energy.\n- **Task 1**: Derive the generic Rankine–Hugoniot jump conditions.\n- **Task 2**: Compute the discontinuity speed $s$ for the following states and gas properties:\n    - $\\gamma = 1.4$\n    - Left state: $\\rho_{L} = 1.0$ $\\mathrm{kg/m^{3}}$, $u_{L} = 750$ $\\mathrm{m/s}$, $p_{L} = 1.0 \\times 10^{5}$ $\\mathrm{Pa}$.\n    - Right state: $\\rho_{R} = 3.\\overline{3}$ $\\mathrm{kg/m^{3}}$, $u_{R} = 95.20995731456036$ $\\mathrm{m/s}$, $p_{R} = 7.125 \\times 10^{5}$ $\\mathrm{Pa}$.\n- **Energy Definitions**: Specific total energy $E = e + \\frac{1}{2} u^{2}$, and specific internal energy $e = \\frac{p}{(\\gamma - 1)\\rho}$.\n\n**1.2. Validate Using Extracted Givens**\nThe problem is scientifically grounded, rooted in the fundamental principles of fluid dynamics (Euler equations, conservation laws, Rankine-Hugoniot conditions). The language is objective and precise. The provided data appears complete for solving the problem. The specific numerical values for the right state are precisely chosen to be consistent with the left state and the governing equations, making the problem well-posed. No scientific flaws, contradictions, or ambiguities are present.\n\n**1.3. Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Step 2: Derivation of the Rankine-Hugoniot Conditions\n\nThe one-dimensional Euler equations can be written in conservation law form as:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0\n$$\nwhere $\\mathbf{U}$ is the vector of conserved variables and $\\mathbf{F}(\\mathbf{U})$ is the vector of corresponding fluxes:\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (\\rho E + p)u \\end{pmatrix}\n$$\nHere, $\\rho$ is the fluid density, $u$ is the velocity, $p$ is the pressure, and $E$ is the specific total energy.\n\nTo derive the jump conditions across a discontinuity, we consider the integral form of the conservation laws over a control volume $[x_a(t), x_b(t)]$ that moves with the discontinuity. Let the position of the discontinuity be $x_s(t)$, moving with speed $s = \\frac{dx_s}{dt}$. We choose the control volume boundaries to enclose the discontinuity, $x_a(t)  x_s(t)  x_b(t)$, and move with it, so $\\frac{dx_a}{dt} = \\frac{dx_b}{dt} = s$.\n\nThe integral form of the conservation law for a moving control volume is given by the Reynolds transport theorem:\n$$\n\\frac{d}{dt} \\int_{x_a(t)}^{x_b(t)} \\mathbf{U} \\, dx = \\int_{x_a(t)}^{x_b(t)} \\frac{\\partial \\mathbf{U}}{\\partial t} \\, dx + \\mathbf{U}(x_b, t) \\frac{dx_b}{dt} - \\mathbf{U}(x_a, t) \\frac{dx_a}{dt}\n$$\nFrom the differential form of the Euler equations, $\\frac{\\partial \\mathbf{U}}{\\partial t} = -\\frac{\\partial \\mathbf{F}}{\\partial x}$. Substituting this into the integral gives:\n$$\n\\int_{x_a(t)}^{x_b(t)} \\frac{\\partial \\mathbf{U}}{\\partial t} \\, dx = - \\int_{x_a(t)}^{x_b(t)} \\frac{\\partial \\mathbf{F}}{\\partial x} \\, dx = \\mathbf{F}(\\mathbf{U}(x_a, t)) - \\mathbf{F}(\\mathbf{U}(x_b, t))\n$$\nSubstituting this back into the Reynolds transport theorem expression:\n$$\n\\frac{d}{dt} \\int_{x_a(t)}^{x_b(t)} \\mathbf{U} \\, dx = \\mathbf{F}(x_a, t) - \\mathbf{F}(x_b, t) + s \\mathbf{U}(x_b, t) - s \\mathbf{U}(x_a, t)\n$$\nNow, we consider the limit as the control volume shrinks to zero width around the discontinuity, i.e., $x_a \\to x_s^{-}$ and $x_b \\to x_s^{+}$. In this limit, the integral term $\\int_{x_a}^{x_b} \\mathbf{U} \\, dx$ vanishes, assuming $\\mathbf{U}$ is bounded. The left-hand side becomes zero. The states $\\mathbf{U}(x_a, t)$ and $\\mathbf{U}(x_b, t)$ approach the constant left state $\\mathbf{U}_L$ and right state $\\mathbf{U}_R$, respectively. The same applies to the fluxes. This leads to:\n$$\n0 = \\mathbf{F}_L - \\mathbf{F}_R + s \\mathbf{U}_R - s \\mathbf{U}_L\n$$\nRearranging this equation gives the general form of the Rankine-Hugoniot jump conditions:\n$$\ns(\\mathbf{U}_R - \\mathbf{U}_L) = \\mathbf{F}_R - \\mathbf{F}_L\n$$\nUsing the jump notation $[[q]] = q_R - q_L$, this is written compactly as $s[[\\mathbf{U}]] = [[\\mathbf{F}]]$.\n\nWriting out the components for mass, momentum, and energy conservation yields the specific jump conditions:\n1.  **Mass Conservation**:\n    $$ s(\\rho_R - \\rho_L) = \\rho_R u_R - \\rho_L u_L $$\n2.  **Momentum Conservation**:\n    $$ s(\\rho_R u_R - \\rho_L u_L) = (\\rho_R u_R^2 + p_R) - (\\rho_L u_L^2 + p_L) $$\n3.  **Energy Conservation**:\n    $$ s(\\rho_R E_R - \\rho_L E_L) = (\\rho_R E_R + p_R)u_R - (\\rho_L E_L + p_L)u_L $$\nwhere $E = \\frac{p}{(\\gamma-1)\\rho} + \\frac{1}{2}u^2$. These three equations are the generic Rankine-Hugoniot jump conditions across a moving discontinuity.\n\n### Step 3: Computation of the Discontinuity Speed\n\nThe problem provides the left and right states for a calorically perfect gas with $\\gamma=1.4$.\n- Left state (L): $\\rho_{L} = 1.0$ $\\mathrm{kg/m^{3}}$, $u_{L} = 750$ $\\mathrm{m/s}$, $p_{L} = 1.0 \\times 10^{5}$ $\\mathrm{Pa}$.\n- Right state (R): $\\rho_{R} = 3.\\overline{3} = \\frac{10}{3}$ $\\mathrm{kg/m^{3}}$, $u_{R} = 95.20995731456036$ $\\mathrm{m/s}$, $p_{R} = 7.125 \\times 10^{5}$ $\\mathrm{Pa}$.\n\nWe can compute the discontinuity speed $s$ using the Rankine-Hugoniot condition for mass conservation. This equation provides a direct expression for $s$:\n$$\ns = \\frac{\\rho_R u_R - \\rho_L u_L}{\\rho_R - \\rho_L}\n$$\nWe substitute the given numerical values into this expression. First, we compute the numerator and denominator.\nThe numerator is:\n$$\n[[\\rho u]] = \\rho_R u_R - \\rho_L u_L = \\left(\\frac{10}{3} \\frac{\\mathrm{kg}}{\\mathrm{m^3}}\\right) \\left(95.20995731456036 \\frac{\\mathrm{m}}{\\mathrm{s}}\\right) - \\left(1.0 \\frac{\\mathrm{kg}}{\\mathrm{m^3}}\\right) \\left(750 \\frac{\\mathrm{m}}{\\mathrm{s}}\\right)\n$$\n$$\n[[\\rho u]] \\approx 317.3665243818679 \\frac{\\mathrm{kg}}{\\mathrm{m^2 s}} - 750 \\frac{\\mathrm{kg}}{\\mathrm{m^2 s}} = -432.6334756181321 \\frac{\\mathrm{kg}}{\\mathrm{m^2 s}}\n$$\nThe denominator is:\n$$\n[[\\rho]] = \\rho_R - \\rho_L = \\frac{10}{3} \\frac{\\mathrm{kg}}{\\mathrm{m^3}} - 1.0 \\frac{\\mathrm{kg}}{\\mathrm{m^3}} = \\frac{7}{3} \\frac{\\mathrm{kg}}{\\mathrm{m^3}}\n$$\nNow, we compute the speed $s$:\n$$\ns = \\frac{-432.6334756181321 \\frac{\\mathrm{kg}}{\\mathrm{m^2 s}}}{\\frac{7}{3} \\frac{\\mathrm{kg}}{\\mathrm{m^3}}} = -432.6334756181321 \\times \\frac{3}{7} \\frac{\\mathrm{m}}{\\mathrm{s}} \\approx -185.4143466934852 \\frac{\\mathrm{m}}{\\mathrm{s}}\n$$\nThe problem requires the value of $s$ rounded to four significant figures.\n$$\ns \\approx -185.4 \\, \\mathrm{m/s}\n$$\nThe negative sign indicates that the discontinuity is propagating to the left in the laboratory frame of reference. The given state values are mutually consistent across all three Rankine-Hugoniot equations, confirming the well-posedness of the numerical problem.",
            "answer": "$$\\boxed{-185.4}$$"
        },
        {
            "introduction": "After establishing the physical jump conditions , the next challenge is to design a numerical flux that correctly models them. This exercise introduces the mathematical elegance of Roe's approximate Riemann solver by having you construct its core component: the Roe-averaged Jacobian. Understanding this linearization is key to appreciating how a complex nonlinear system can be efficiently and accurately solved at each cell interface.",
            "id": "3963019",
            "problem": "Consider the one-dimensional compressible Euler equations for a calorically perfect gas with ratio of specific heats $\\gamma$, written in conservative form with the state vector $q = (\\rho, \\rho u, \\rho E)^{\\mathsf{T}}$, where $\\rho$ is the mass density, $u$ is the velocity, and $E$ is the specific total energy. The corresponding flux function $f(q)$ follows from the conservation of mass, momentum, and energy and the ideal-gas closure $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$, where $p$ is the pressure. In the context of Godunov-type finite volume methods in Computational Fluid Dynamics (CFD), the Roe linearization seeks a constant matrix $\\tilde{A}$ such that $f(q_R) - f(q_L) = \\tilde{A}\\,(q_R - q_L)$, where $q_L$ and $q_R$ denote given left and right states.\n\nStarting from the conservation-law formulation and the ideal-gas closure, define the Roe-averaged variables between $q_L$ and $q_R$ and construct the associated constant linearized Jacobian $\\tilde{A}$ in conservative variables that satisfies $f(q_R) - f(q_L) = \\tilde{A}\\,(q_R - q_L)$. Express $\\tilde{A}$ explicitly in closed form in terms of the Roe-averaged velocity $\\tilde{u}$, the Roe-averaged total enthalpy $\\tilde{H}$, and the ratio of specific heats $\\gamma$, without introducing any numerical approximations. The final answer must be a single closed-form analytical expression.",
            "solution": "The problem requires the construction of the Roe-averaged Jacobian matrix $\\tilde{A}$ for the one-dimensional compressible Euler equations. The matrix must satisfy the property $f(q_R) - f(q_L) = \\tilde{A}\\,(q_R - q_L)$ for any two states $q_L$ and $q_R$.\n\nThe state vector of conservative variables is $q = (\\rho, \\rho u, \\rho E)^{\\mathsf{T}} = (q_1, q_2, q_3)^{\\mathsf{T}}$. The corresponding flux vector $f(q)$ is given by the conservation of mass, momentum, and energy:\n$$\nf(q) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (\\rho E + p)u \\end{pmatrix}\n$$\nUsing the definitions of the conservative variables, we can express the primitive variables $u$ and the pressure $p$ in terms of $q_1$, $q_2$, and $q_3$. The velocity is $u = q_2/q_1$. The pressure $p$ for a calorically perfect gas is given by the equation of state:\n$$\np = (\\gamma - 1)\\left(\\rho E - \\frac{1}{2}\\rho u^2\\right) = (\\gamma - 1)\\left(q_3 - \\frac{1}{2}\\frac{q_2^2}{q_1}\\right)\n$$\nThe flux vector can then be written explicitly in terms of the components of $q$:\n$$\nf(q) = \\begin{pmatrix} q_2 \\\\ \\frac{q_2^2}{q_1} + (\\gamma - 1)\\left(q_3 - \\frac{1}{2}\\frac{q_2^2}{q_1}\\right) \\\\ \\left(q_3 + (\\gamma - 1)\\left(q_3 - \\frac{1}{2}\\frac{q_2^2}{q_1}\\right)\\right)\\frac{q_2}{q_1} \\end{pmatrix} = \\begin{pmatrix} q_2 \\\\ (\\frac{3-\\gamma}{2})\\frac{q_2^2}{q_1} + (\\gamma-1)q_3 \\\\ \\gamma\\frac{q_2 q_3}{q_1} - \\frac{\\gamma-1}{2}\\frac{q_2^3}{q_1^2} \\end{pmatrix}\n$$\nThe Roe matrix $\\tilde{A}$ is constructed such that it is the flux Jacobian $A(q) = \\frac{\\partial f}{\\partial q}$ evaluated at a specially defined averaged state, $\\tilde{q}$. To find the form of this matrix, we first compute the analytical Jacobian $A(q)$ for an arbitrary state $q$. It is more convenient to express the entries of the Jacobian in terms of the primitive variables $u$, and the specific total enthalpy $H = E + p/\\rho$.\n\nThe components of the Jacobian $A_{ij} = \\frac{\\partial f_i}{\\partial q_j}$ are:\nRow $1$:\n$$\nA_{11} = \\frac{\\partial q_2}{\\partial q_1} = 0, \\quad A_{12} = \\frac{\\partial q_2}{\\partial q_2} = 1, \\quad A_{13} = \\frac{\\partial q_2}{\\partial q_3} = 0\n$$\nRow $2$:\n$$\nA_{21} = \\frac{\\partial f_2}{\\partial q_1} = -(\\frac{3-\\gamma}{2})\\frac{q_2^2}{q_1^2} = -\\frac{3-\\gamma}{2}u^2 = \\frac{\\gamma-3}{2}u^2\n$$\n$$\nA_{22} = \\frac{\\partial f_2}{\\partial q_2} = (3-\\gamma)\\frac{q_2}{q_1} = (3-\\gamma)u\n$$\n$$\nA_{23} = \\frac{\\partial f_2}{\\partial q_3} = \\gamma-1\n$$\nRow $3$: To compute the derivatives for $f_3$, we use the form $f_3 = (\\rho E + p)u = \\rho u H = q_2 H$. We need to express $H$ in terms of $q_i$.\n$H = E + p/\\rho = q_3/q_1 + (\\gamma-1)(q_3/q_1 - q_2^2/(2q_1^2)) = \\gamma q_3/q_1 - (\\gamma-1)q_2^2/(2q_1^2) = \\gamma E - \\frac{\\gamma-1}{2}u^2$.\n$$\nA_{31} = \\frac{\\partial f_3}{\\partial q_1} = \\frac{\\partial}{\\partial q_1}\\left(\\gamma\\frac{q_2 q_3}{q_1} - \\frac{\\gamma-1}{2}\\frac{q_2^3}{q_1^2}\\right) = -\\gamma\\frac{q_2 q_3}{q_1^2} + (\\gamma-1)\\frac{q_2^3}{q_1^3} = -\\gamma u E + (\\gamma-1)u^3 = u((\\gamma-1)u^2 - \\gamma E)\n$$\nUsing $H = \\gamma E - \\frac{\\gamma-1}{2}u^2$, we can write $\\gamma E = H + \\frac{\\gamma-1}{2}u^2$.\nSo, $A_{31} = u\\left((\\gamma-1)u^2 - (H + \\frac{\\gamma-1}{2}u^2)\\right) = u\\left(\\frac{\\gamma-1}{2}u^2 - H\\right)$.\n$$\nA_{32} = \\frac{\\partial f_3}{\\partial q_2} = \\frac{\\partial}{\\partial q_2}\\left(\\gamma\\frac{q_2 q_3}{q_1} - \\frac{\\gamma-1}{2}\\frac{q_2^3}{q_1^2}\\right) = \\gamma\\frac{q_3}{q_1} - \\frac{3(\\gamma-1)}{2}\\frac{q_2^2}{q_1^2} = \\gamma E - \\frac{3(\\gamma-1)}{2}u^2\n$$\nUsing the expression for $\\gamma E$, this is $A_{32} = H + \\frac{\\gamma-1}{2}u^2 - \\frac{3(\\gamma-1)}{2}u^2 = H - (\\gamma-1)u^2$.\n$$\nA_{33} = \\frac{\\partial f_3}{\\partial q_3} = \\frac{\\partial}{\\partial q_3}\\left(\\gamma\\frac{q_2 q_3}{q_1} - \\frac{\\gamma-1}{2}\\frac{q_2^3}{q_1^2}\\right) = \\gamma\\frac{q_2}{q_1} = \\gamma u\n$$\nCombining these terms, the analytical flux Jacobian is:\n$$\nA(q) = \\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}u^2  (3-\\gamma)u  \\gamma-1 \\\\ u\\left(\\frac{\\gamma-1}{2}u^2 - H\\right)  H - (\\gamma-1)u^2  \\gamma u \\end{pmatrix}\n$$\nThe Roe-linearization condition $f(q_R) - f(q_L) = \\tilde{A}\\,(q_R - q_L)$ is satisfied exactly if the matrix $\\tilde{A}$ is constructed by evaluating the Jacobian $A(q)$ at a specific averaged state. This state is defined by the Roe-averaged variables. For the one-dimensional Euler equations, these averages for velocity and specific total enthalpy are defined as follows, where subscripts $L$ and $R$ denote the left and right states:\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L} u_L + \\sqrt{\\rho_R} u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_L} H_L + \\sqrt{\\rho_R} H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\nThe remarkable property of these specific averages is that they ensure the linearization condition holds for the non-linear Euler system. The construction of the Roe matrix $\\tilde{A}$ is then achieved by substituting these Roe-averaged variables, $\\tilde{u}$ and $\\tilde{H}$, into the analytical Jacobian matrix $A(q)$.\n\nTherefore, the Roe-averaged Jacobian matrix $\\tilde{A}$ is:\n$$\n\\tilde{A} = \\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}\\tilde{u}^2  (3-\\gamma)\\tilde{u}  \\gamma-1 \\\\ \\tilde{u}\\left(\\frac{\\gamma-1}{2}\\tilde{u}^2 - \\tilde{H}\\right)  \\tilde{H} - (\\gamma-1)\\tilde{u}^2  \\gamma \\tilde{u} \\end{pmatrix}\n$$\nThis matrix is constant for given left and right states $q_L$ and $q_R$, and by its construction with the specified Roe averages, it exactly satisfies the required property $f(q_R) - f(q_L) = \\tilde{A}\\,(q_R - q_L)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}\\tilde{u}^2  (3-\\gamma)\\tilde{u}  \\gamma-1 \\\\ \\tilde{u}\\left(\\frac{\\gamma-1}{2}\\tilde{u}^2 - \\tilde{H}\\right)  \\tilde{H} - (\\gamma-1)\\tilde{u}^2  \\gamma \\tilde{u} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While the Roe solver is powerful, its linearization can fail in specific but important cases, leading to non-physical solutions like expansion shocks. This practice addresses the famous 'entropy-fix' problem, a critical aspect of developing robust solvers based on the Roe linearization . By analyzing a transonic rarefaction, you will learn to identify the source of the failure and calculate the necessary modification to ensure your numerical solution remains physically valid.",
            "id": "3963045",
            "problem": "You are asked to analyze a one-dimensional Riemann problem for the compressible Euler equations within a Godunov-type finite volume method employing Roe’s approximate Riemann solver. Consider a perfect gas with ratio of specific heats $\\gamma = 1.4$. The left and right states at a cell interface are\n- Left: density $\\rho_L = 1.0$ (in $\\mathrm{kg/m^3}$), velocity $u_L = 100$ (in $\\mathrm{m/s}$), pressure $p_L = 100000$ (in $\\mathrm{Pa}$).\n- Right: density $\\rho_R = 0.5$ (in $\\mathrm{kg/m^3}$), velocity $u_R = 400$ (in $\\mathrm{m/s}$), pressure $p_R = 50000$ (in $\\mathrm{Pa}$).\n\nAssume an ideal gas equation of state and define the speed of sound by $a = \\sqrt{\\gamma p/\\rho}$. The Roe linearization uses a constant Jacobian across the interface with eigenvalues $\\lambda_1 = \\tilde{u} - \\tilde{a}$, $\\lambda_2 = \\tilde{u}$, and $\\lambda_3 = \\tilde{u} + \\tilde{a}$, where tildes denote Roe averages. In transonic rarefaction, Roe’s linearization is known to admit nonphysical expansion shocks because it replaces a continuous self-similar rarefaction fan by a single discontinuity moving at a single speed.\n\nExplain, from the perspective of the entropy condition and characteristic speeds, why a transonic rarefaction in the $1$-family ($\\lambda_1 = u - a$) can be misrepresented by Roe’s solver as an expansion shock for the above data. Then, using a Harten-type entropy fix that replaces $|\\lambda|$ by\n$$\n\\phi(|\\lambda|;\\delta) = \n\\begin{cases}\n\\dfrac{|\\lambda|^2}{2\\delta} + \\dfrac{\\delta}{2},  \\text{if } |\\lambda|  \\delta, \\\\\n|\\lambda|,  \\text{if } |\\lambda| \\ge \\delta,\n\\end{cases}\n$$\ndetermine the minimal entropy-fix magnitude $\\delta$ for the $1$-family that is sufficient to eliminate the nonphysical expansion shock for this interface, expressed solely in terms of the left and right characteristic speeds of that family.\n\nCompute the numerical value of $\\delta$ for the given states. Express your final answer in meters per second and round your answer to four significant figures.",
            "solution": "The problem requires an analysis of a one-dimensional Riemann problem for the Euler equations, specifically focusing on a failure mode of Roe's approximate Riemann solver and its correction via an entropy fix. The analysis is divided into two parts: first, an explanation for the occurrence of a nonphysical expansion shock, and second, the determination of a minimal parameter for an entropy fix.\n\n### Part 1: Explanation of the Nonphysical Expansion Shock\n\nThe behavior of solutions to hyperbolic conservation laws, such as the Euler equations, is governed by characteristic waves. The entropy condition distinguishes physically admissible discontinuities (shocks) from nonphysical ones (expansion shocks).\n\nFor a wave associated with the $k$-th characteristic family with speed $\\lambda_k$, the physical nature of the solution between a left state ($L$) and a right state ($R$) is determined by the relative values of the characteristic speeds $\\lambda_{k,L}$ and $\\lambda_{k,R}$.\n1.  **Shock Wave:** A physical shock wave is a compressive discontinuity. For it to be stable, characteristics on both sides must propagate into the shock front. If the shock moves with speed $S$, the Lax entropy condition requires $\\lambda_k(U_L)  S$ and $\\lambda_k(U_R)  S$. This implies that $\\lambda_k(U_L)  \\lambda_k(U_R)$.\n2.  **Rarefaction Wave:** A rarefaction wave is an expansive, continuous solution. The characteristics spread out, meaning $\\lambda_k(U_L)  \\lambda_k(U_R)$. The solution is a self-similar fan of characteristics with speeds varying continuously from $\\lambda_k(U_L)$ to $\\lambda_k(U_R)$.\n\nRoe's approximate Riemann solver linearizes the nonlinear hyperbolic system by defining a constant matrix $\\tilde{A}$ (the Roe matrix) that satisfies $F(U_R) - F(U_L) = \\tilde{A}(U_R - U_L)$. This method approximates the true wave structure of the Riemann problem with a set of discrete discontinuities, each moving at a constant speed equal to one of the eigenvalues of $\\tilde{A}$, denoted by $\\tilde{\\lambda}_k$.\n\nLet us analyze the given Riemann problem for the $1$-family, whose characteristic speed is $\\lambda_1 = u - a$.\nFirst, we compute the speed of sound $a = \\sqrt{\\gamma p / \\rho}$ for the left and right states, with $\\gamma = 1.4$.\n\nFor the left state:\n$\\rho_L = 1.0 \\, \\mathrm{kg/m^3}$, $u_L = 100 \\, \\mathrm{m/s}$, $p_L = 100000 \\, \\mathrm{Pa}$.\n$$ a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 100000}{1.0}} = \\sqrt{140000} \\, \\mathrm{m/s} \\approx 374.17 \\, \\mathrm{m/s} $$\nThe characteristic speed of the $1$-family on the left is:\n$$ \\lambda_{1,L} = u_L - a_L = 100 - \\sqrt{140000} \\approx 100 - 374.17 = -274.17 \\, \\mathrm{m/s} $$\n\nFor the right state:\n$\\rho_R = 0.5 \\, \\mathrm{kg/m^3}$, $u_R = 400 \\, \\mathrm{m/s}$, $p_R = 50000 \\, \\mathrm{Pa}$.\n$$ a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 50000}{0.5}} = \\sqrt{140000} \\, \\mathrm{m/s} \\approx 374.17 \\, \\mathrm{m/s} $$\nThe characteristic speed of the $1$-family on the right is:\n$$ \\lambda_{1,R} = u_R - a_R = 400 - \\sqrt{140000} \\approx 400 - 374.17 = 25.83 \\, \\mathrm{m/s} $$\n\nComparing the characteristic speeds, we find $\\lambda_{1,L}  \\lambda_{1,R}$. According to the entropy condition, this indicates that the true solution for the $1$-wave is a rarefaction wave.\nFurthermore, we observe that $\\lambda_{1,L}  0$ and $\\lambda_{1,R}  0$. This specific case, where the range of characteristic speeds in the wave fan, $(\\lambda_{1,L}, \\lambda_{1,R})$, contains the speed $0$, is known as a *transonic rarefaction*.\n\nRoe's solver does not resolve the continuous fan structure. Instead, it represents the entire $1$-wave as a single discontinuity propagating at the Roe-averaged eigenvalue speed $\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}$. A property of the Roe average is that $\\tilde{\\lambda}_1$ lies between $\\lambda_{1,L}$ and $\\lambda_{1,R}$.\nBy treating the wave as a discontinuity, the solver implicitly assumes it is a shock. However, a physical shock must satisfy $\\lambda_{1,L}  \\lambda_{1,R}$. The given data lead to the opposite, $\\lambda_{1,L}  \\lambda_{1,R}$. Therefore, the discontinuity generated by the pure Roe solver violates the Lax entropy condition. Such a nonphysical, entropy-violating discontinuity that corresponds to an expansion in the flow is called an expansion shock. This is a well-known pathology of Roe's method when dealing with transonic rarefactions.\n\n### Part 2: Determination of the Entropy-Fix Magnitude $\\delta$\n\nThe Harten entropy fix is designed to remedy this pathology by adding numerical viscosity (or diffusion) selectively. The fix modifies the absolute value of the eigenvalue, $|\\lambda|$, in the numerical flux calculation. The provided function is:\n$$\n\\phi(|\\lambda|;\\delta) = \n\\begin{cases}\n\\dfrac{|\\lambda|^2}{2\\delta} + \\dfrac{\\delta}{2},  \\text{if } |\\lambda|  \\delta, \\\\\n|\\lambda|,  \\text{if } |\\lambda| \\ge \\delta.\n\\end{cases}\n$$\nWhen $|\\lambda|$ is small (specifically, less than a threshold $\\delta$), the function $\\phi(|\\lambda|;\\delta)$ provides a larger value, preventing the numerical viscosity from vanishing and \"smearing\" the nonphysical shock into a more physically correct, smooth profile resembling a rarefaction.\n\nThe entropy fix needs to be activated for the problematic wave, which occurs when a rarefaction is transonic. For the $1$-family, this corresponds to the condition $\\lambda_{1,L}  0  \\lambda_{1,R}$. The parameter $\\delta$ must be chosen to be large enough to \"detect\" this situation. A widely adopted and robust choice, proposed by Harten and Hyman, is to scale the fix parameter $\\delta_k$ with the width of the characteristic speed range for the wave family $k$. This ensures that the artificial viscosity is appropriate for the scale of the physical feature it is meant to resolve.\n\nFor the $k$-th wave family, this choice is given by:\n$$ \\delta_k = \\max(0, \\lambda_{k,R} - \\lambda_{k,L}) $$\nFor the $1$-family in this problem, we have confirmed that $\\lambda_{1,R} > \\lambda_{1,L}$, so this simplifies to:\n$$ \\delta_1 = \\lambda_{1,R} - \\lambda_{1,L} $$\nThis expression for $\\delta_1$ is solely in terms of the left and right characteristic speeds, as required. It represents the minimal sufficient magnitude for the entropy-fix parameter under this standard and well-established formulation, ensuring that the fix is applied and provides sufficient numerical viscosity to resolve the transonic rarefaction correctly.\n\nWe now compute the numerical value of $\\delta_1$ for the given states.\n$$ \\delta_1 = (u_R - a_R) - (u_L - a_L) $$\nSubstituting the values we have previously calculated:\n$$ \\lambda_{1,L} = 100 - \\sqrt{140000} \\, \\mathrm{m/s} $$\n$$ \\lambda_{1,R} = 400 - \\sqrt{140000} \\, \\mathrm{m/s} $$\nThe value of $\\delta_1$ is:\n$$ \\delta_1 = (400 - \\sqrt{140000}) - (100 - \\sqrt{140000}) $$\n$$ \\delta_1 = 400 - \\sqrt{140000} - 100 + \\sqrt{140000} $$\n$$ \\delta_1 = 300 \\, \\mathrm{m/s} $$\nThe problem requires the answer to be rounded to four significant figures. The exact value is $300$. To express this with four significant figures, we write it as $300.0$.\nThe minimal entropy-fix magnitude $\\delta$ for the $1$-family is $300.0 \\, \\mathrm{m/s}$.",
            "answer": "$$\n\\boxed{300.0}\n$$"
        }
    ]
}