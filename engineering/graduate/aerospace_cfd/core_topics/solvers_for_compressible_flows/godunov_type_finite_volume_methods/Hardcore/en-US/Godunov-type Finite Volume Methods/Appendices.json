{
    "hands_on_practices": [
        {
            "introduction": "Godunov-type methods are built upon the solution of local Riemann problems, which model the interaction of fluid states across a discontinuity. Before approximating these solutions numerically, it is essential to understand the exact physical laws that govern them. This exercise  guides you through a foundational derivation of the Rankine–Hugoniot jump conditions directly from the integral form of the Euler equations, establishing the non-negotiable relationships between states across any shock wave.",
            "id": "3963108",
            "problem": "In Computational Fluid Dynamics (CFD) with Godunov-type finite volume methods, intercell fluxes are obtained by solving local Riemann problems and propagating discontinuities according to conservation laws. Consider a one-dimensional inviscid compressible flow of a calorically perfect gas with constant ratio of specific heats $\\gamma$. A planar discontinuity separating a left state and a right state moves with unknown speed $s$. Starting from the integral conservation laws for mass, momentum, and total energy for the one-dimensional Euler equations, and using only fundamental definitions of the conserved variables and fluxes, derive the generic Rankine–Hugoniot jump conditions across an arbitrary moving discontinuity.\n\nThen, for the specific calorically perfect gas with $\\gamma = 1.4$ and the following left and right states (given in the laboratory frame):\n- Left state: $\\rho_{L} = 1.0$ $\\mathrm{kg/m^{3}}$, $u_{L} = 750$ $\\mathrm{m/s}$, $p_{L} = 1.0 \\times 10^{5}$ $\\mathrm{Pa}$,\n- Right state: $\\rho_{R} = 3.\\overline{3}$ $\\mathrm{kg/m^{3}}$, $u_{R} = 95.20995731456036$ $\\mathrm{m/s}$, $p_{R} = 7.125 \\times 10^{5}$ $\\mathrm{Pa}$,\n\ncompute the discontinuity speed $s$ that satisfies the derived Rankine–Hugoniot conditions. Round your final value of $s$ to four significant figures and express it in $\\mathrm{m/s}$. Assume the specific total energy per unit mass is $E = e + \\tfrac{1}{2} u^{2}$ with internal energy $e = \\dfrac{p}{(\\gamma - 1)\\rho}$.",
            "solution": "The problem consists of two parts. First, to derive the Rankine-Hugoniot jump conditions for a one-dimensional inviscid compressible flow from the integral form of the Euler equations. Second, to compute the speed of a specific discontinuity, $s$, given its left and right states.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- **System**: 1D inviscid compressible flow.\n- **Gas Model**: Calorically perfect gas with constant ratio of specific heats, $\\gamma$.\n- **Discontinuity**: A planar discontinuity separating a left state (L) and a right state (R), moving with an unknown speed $s$.\n- **Governing Equations**: The integral form of the 1D Euler equations for mass, momentum, and total energy.\n- **Task 1**: Derive the generic Rankine–Hugoniot jump conditions.\n- **Task 2**: Compute the discontinuity speed $s$ for the following states and gas properties:\n    - $\\gamma = 1.4$\n    - Left state: $\\rho_{L} = 1.0$ $\\mathrm{kg/m^{3}}$, $u_{L} = 750$ $\\mathrm{m/s}$, $p_{L} = 1.0 \\times 10^{5}$ $\\mathrm{Pa}$.\n    - Right state: $\\rho_{R} = 3.\\overline{3}$ $\\mathrm{kg/m^{3}}$, $u_{R} = 95.20995731456036$ $\\mathrm{m/s}$, $p_{R} = 7.125 \\times 10^{5}$ $\\mathrm{Pa}$.\n- **Energy Definitions**: Specific total energy $E = e + \\frac{1}{2} u^{2}$, and specific internal energy $e = \\frac{p}{(\\gamma - 1)\\rho}$.\n\n**1.2. Validate Using Extracted Givens**\nThe problem is scientifically grounded, rooted in the fundamental principles of fluid dynamics (Euler equations, conservation laws, Rankine-Hugoniot conditions). The language is objective and precise. The provided data appears complete for solving the problem. The specific numerical values for the right state are precisely chosen to be consistent with the left state and the governing equations, making the problem well-posed. No scientific flaws, contradictions, or ambiguities are present.\n\n**1.3. Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Step 2: Derivation of the Rankine-Hugoniot Conditions\n\nThe one-dimensional Euler equations can be written in conservation law form as:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0\n$$\nwhere $\\mathbf{U}$ is the vector of conserved variables and $\\mathbf{F}(\\mathbf{U})$ is the vector of corresponding fluxes:\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (\\rho E + p)u \\end{pmatrix}\n$$\nHere, $\\rho$ is the fluid density, $u$ is the velocity, $p$ is the pressure, and $E$ is the specific total energy.\n\nTo derive the jump conditions across a discontinuity, we consider the integral form of the conservation laws over a control volume $[x_a(t), x_b(t)]$ that moves with the discontinuity. Let the position of the discontinuity be $x_s(t)$, moving with speed $s = \\frac{dx_s}{dt}$. We choose the control volume boundaries to enclose the discontinuity, $x_a(t)  x_s(t)  x_b(t)$, and move with it, so $\\frac{dx_a}{dt} = \\frac{dx_b}{dt} = s$.\n\nThe integral form of the conservation law for a moving control volume is given by the Reynolds transport theorem:\n$$\n\\frac{d}{dt} \\int_{x_a(t)}^{x_b(t)} \\mathbf{U} \\, dx = \\int_{x_a(t)}^{x_b(t)} \\frac{\\partial \\mathbf{U}}{\\partial t} \\, dx + \\mathbf{U}(x_b, t) \\frac{dx_b}{dt} - \\mathbf{U}(x_a, t) \\frac{dx_a}{dt}\n$$\nFrom the differential form of the Euler equations, $\\frac{\\partial \\mathbf{U}}{\\partial t} = -\\frac{\\partial \\mathbf{F}}{\\partial x}$. Substituting this into the integral gives:\n$$\n\\int_{x_a(t)}^{x_b(t)} \\frac{\\partial \\mathbf{U}}{\\partial t} \\, dx = - \\int_{x_a(t)}^{x_b(t)} \\frac{\\partial \\mathbf{F}}{\\partial x} \\, dx = \\mathbf{F}(\\mathbf{U}(x_a, t)) - \\mathbf{F}(\\mathbf{U}(x_b, t))\n$$\nSubstituting this back into the Reynolds transport theorem expression:\n$$\n\\frac{d}{dt} \\int_{x_a(t)}^{x_b(t)} \\mathbf{U} \\, dx = \\mathbf{F}(x_a, t) - \\mathbf{F}(x_b, t) + s \\mathbf{U}(x_b, t) - s \\mathbf{U}(x_a, t)\n$$\nNow, we consider the limit as the control volume shrinks to zero width around the discontinuity, i.e., $x_a \\to x_s^{-}$ and $x_b \\to x_s^{+}$. In this limit, the integral term $\\int_{x_a}^{x_b} \\mathbf{U} \\, dx$ vanishes, assuming $\\mathbf{U}$ is bounded. The left-hand side becomes zero. The states $\\mathbf{U}(x_a, t)$ and $\\mathbf{U}(x_b, t)$ approach the constant left state $\\mathbf{U}_L$ and right state $\\mathbf{U}_R$, respectively. The same applies to the fluxes. This leads to:\n$$\n0 = \\mathbf{F}_L - \\mathbf{F}_R + s \\mathbf{U}_R - s \\mathbf{U}_L\n$$\nRearranging this equation gives the general form of the Rankine-Hugoniot jump conditions:\n$$\ns(\\mathbf{U}_R - \\mathbf{U}_L) = \\mathbf{F}_R - \\mathbf{F}_L\n$$\nUsing the jump notation $[[q]] = q_R - q_L$, this is written compactly as $s[[\\mathbf{U}]] = [[\\mathbf{F}]]$.\n\nWriting out the components for mass, momentum, and energy conservation yields the specific jump conditions:\n1.  **Mass Conservation**:\n    $$ s(\\rho_R - \\rho_L) = \\rho_R u_R - \\rho_L u_L $$\n2.  **Momentum Conservation**:\n    $$ s(\\rho_R u_R - \\rho_L u_L) = (\\rho_R u_R^2 + p_R) - (\\rho_L u_L^2 + p_L) $$\n3.  **Energy Conservation**:\n    $$ s(\\rho_R E_R - \\rho_L E_L) = (\\rho_R E_R + p_R)u_R - (\\rho_L E_L + p_L)u_L $$\nwhere $E = \\frac{p}{(\\gamma-1)\\rho} + \\frac{1}{2}u^2$. These three equations are the generic Rankine-Hugoniot jump conditions across a moving discontinuity.\n\n### Step 3: Computation of the Discontinuity Speed\n\nThe problem provides the left and right states for a calorically perfect gas with $\\gamma=1.4$.\n- Left state (L): $\\rho_{L} = 1.0$ $\\mathrm{kg/m^{3}}$, $u_{L} = 750$ $\\mathrm{m/s}$, $p_{L} = 1.0 \\times 10^{5}$ $\\mathrm{Pa}$.\n- Right state (R): $\\rho_{R} = 3.\\overline{3} = \\frac{10}{3}$ $\\mathrm{kg/m^{3}}$, $u_{R} = 95.20995731456036$ $\\mathrm{m/s}$, $p_{R} = 7.125 \\times 10^{5}$ $\\mathrm{Pa}$.\n\nWe can compute the discontinuity speed $s$ using the Rankine-Hugoniot condition for mass conservation. This equation provides a direct expression for $s$:\n$$\ns = \\frac{\\rho_R u_R - \\rho_L u_L}{\\rho_R - \\rho_L}\n$$\nWe substitute the given numerical values into this expression. First, we compute the numerator and denominator.\nThe numerator is:\n$$\n[[\\rho u]] = \\rho_R u_R - \\rho_L u_L = \\left(\\frac{10}{3} \\frac{\\mathrm{kg}}{\\mathrm{m^3}}\\right) \\left(95.20995731456036 \\frac{\\mathrm{m}}{\\mathrm{s}}\\right) - \\left(1.0 \\frac{\\mathrm{kg}}{\\mathrm{m^3}}\\right) \\left(750 \\frac{\\mathrm{m}}{\\mathrm{s}}\\right)\n$$\n$$\n[[\\rho u]] \\approx 317.3665243818679 \\frac{\\mathrm{kg}}{\\mathrm{m^2 s}} - 750 \\frac{\\mathrm{kg}}{\\mathrm{m^2 s}} = -432.6334756181321 \\frac{\\mathrm{kg}}{\\mathrm{m^2 s}}\n$$\nThe denominator is:\n$$\n[[\\rho]] = \\rho_R - \\rho_L = \\frac{10}{3} \\frac{\\mathrm{kg}}{\\mathrm{m^3}} - 1.0 \\frac{\\mathrm{kg}}{\\mathrm{m^3}} = \\frac{7}{3} \\frac{\\mathrm{kg}}{\\mathrm{m^3}}\n$$\nNow, we compute the speed $s$:\n$$\ns = \\frac{-432.6334756181321 \\frac{\\mathrm{kg}}{\\mathrm{m^2 s}}}{\\frac{7}{3} \\frac{\\mathrm{kg}}{\\mathrm{m^3}}} = -432.6334756181321 \\times \\frac{3}{7} \\frac{\\mathrm{m}}{\\mathrm{s}} \\approx -185.4143466934852 \\frac{\\mathrm{m}}{\\mathrm{s}}\n$$\nThe problem requires the value of $s$ rounded to four significant figures.\n$$\ns \\approx -185.4 \\, \\mathrm{m/s}\n$$\nThe negative sign indicates that the discontinuity is propagating to the left in the laboratory frame of reference. The given state values are mutually consistent across all three Rankine-Hugoniot equations, confirming the well-posedness of the numerical problem.",
            "answer": "$$\\boxed{-185.4}$$"
        },
        {
            "introduction": "Moving from exact physics to discrete computation introduces numerical errors that can fundamentally alter the behavior of the solution. This practice  delves into the analysis of a basic first-order upwind scheme (equivalent to the Lax-Friedrichs flux for this case) for the linear advection equation. By performing a Taylor series analysis to derive the modified equation, you will uncover and quantify the scheme's leading-order error, which manifests as an artificial numerical diffusion, a key concept for understanding the accuracy of finite volume methods.",
            "id": "3963152",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a0$, posed on a uniform mesh of spacing $\\Delta x$ and advanced in time with a fixed time step $\\Delta t$. A first-order Godunov-type finite volume method with piecewise-constant reconstruction and explicit Euler time stepping updates the cell averages $\\bar{u}_{i}^{n}$ according to\n$$\n\\bar{u}_{i}^{n+1} \\;=\\; \\bar{u}_{i}^{n} \\;-\\; \\frac{\\Delta t}{\\Delta x}\\Big(F_{i+1/2}^{n} \\;-\\; F_{i-1/2}^{n}\\Big),\n$$\nwhere $F_{i\\pm 1/2}^{n}$ are numerical fluxes computed from left and right interface states $(u_{L},u_{R})$ at time level $n$. For the scalar flux function $f(u)=a\\,u$, the exact Godunov flux is defined by selecting the upwind state, namely $F_{\\mathrm{God}}(u_{L},u_{R})=a\\,u_{L}$ for $a0$. The Lax–Friedrichs (also called Rusanov) flux is given by\n$$\nF_{\\mathrm{LF}}(u_{L},u_{R}) \\;=\\; \\frac{1}{2}\\Big(f(u_{L}) + f(u_{R})\\Big) \\;-\\; \\frac{\\alpha}{2}\\Big(u_{R} - u_{L}\\Big),\n$$\nwith dissipation parameter $\\alpha=\\lvert f'(u)\\rvert=\\lvert a\\rvert$. \n\nStarting from the conservation-law form and the finite volume update above, perform the following:\n\n- Show, for $a0$, that $F_{\\mathrm{LF}}(u_{L},u_{R}) = F_{\\mathrm{God}}(u_{L},u_{R})$ for the linear advection equation.\n- Derive the leading-order modified equation of the fully discrete scheme by a Taylor expansion in $\\Delta t$ and $\\Delta x$ for a smooth solution $u(x,t)$, and isolate the principal dissipative term that quantifies numerical diffusion.\n\nDefine the Courant number $\\sigma = \\dfrac{a\\,\\Delta t}{\\Delta x}$. Your final answer must be a single closed-form analytic expression for the leading-order numerical diffusion coefficient multiplying $u_{xx}$ in the modified equation, expressed in terms of $a$, $\\Delta x$, and $\\sigma$. No numerical evaluation is required, and no rounding is needed. The final answer must contain no units.",
            "solution": "### Step 1: Extract Givens\nThe problem statement provides the following data, definitions, and equations:\n- The governing partial differential equation is the one-dimensional linear advection equation: $u_{t} + a\\,u_{x} = 0$, with a constant advection speed $a0$.\n- The computational domain is a uniform mesh with cell spacing $\\Delta x$.\n- The time integration uses a fixed time step $\\Delta t$.\n- The finite volume update scheme for cell averages $\\bar{u}_{i}^{n}$ is:\n$$\n\\bar{u}_{i}^{n+1} \\;=\\; \\bar{u}_{i}^{n} \\;-\\; \\frac{\\Delta t}{\\Delta x}\\Big(F_{i+1/2}^{n} \\;-\\; F_{i-1/2}^{n}\\Big)\n$$\n- The numerical fluxes $F_{i\\pm 1/2}^{n}$ are computed from left and right interface states $(u_{L},u_{R})$.\n- The physical flux function is $f(u)=a\\,u$.\n- The exact Godunov flux for $a0$ is: $F_{\\mathrm{God}}(u_{L},u_{R})=a\\,u_{L}$.\n- The Lax–Friedrichs (Rusanov) flux is:\n$$\nF_{\\mathrm{LF}}(u_{L},u_{R}) \\;=\\; \\frac{1}{2}\\Big(f(u_{L}) + f(u_{R})\\Big) \\;-\\; \\frac{\\alpha}{2}\\Big(u_{R} - u_{L}\\Big)\n$$\n- The dissipation parameter for the Lax-Friedrichs flux is $\\alpha=\\lvert f'(u)\\rvert=\\lvert a\\rvert$.\n- The Courant number is defined as $\\sigma = \\dfrac{a\\,\\Delta t}{\\Delta x}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation against the specified criteria.\n- **Scientifically Grounded:** The problem is based on the fundamental principles of numerical analysis for partial differential equations, specifically the finite volume method applied to the linear advection equation. The concepts of Godunov and Lax-Friedrichs fluxes, Taylor series analysis, and modified equations are standard and well-established in the field of computational fluid dynamics (CFD). The problem is scientifically sound.\n- **Well-Posed:** The problem provides all necessary information and definitions to perform the required derivations. The tasks are clearly stated and lead to a unique analytical result. The problem is well-posed.\n- **Objective:** The problem is stated in precise, objective language. It contains no subjective claims, ambiguities, or non-formalizable statements.\n\nThe problem is self-contained and free of scientific flaws, contradictions, or ambiguities. It requests a standard derivation found in textbooks on numerical methods for conservation laws. Thus, it is deemed a valid problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe solution is developed in two parts as requested by the problem statement.\n\n**Part 1: Equivalence of Godunov and Lax–Friedrichs Fluxes**\n\nWe are asked to show that for the linear advection equation with $a0$, the Lax–Friedrichs flux $F_{\\mathrm{LF}}(u_{L},u_{R})$ is identical to the Godunov flux $F_{\\mathrm{God}}(u_{L},u_{R})$.\n\nThe physical flux function is given as $f(u) = a\\,u$. Therefore, the fluxes evaluated at the left and right states are $f(u_L) = a\\,u_L$ and $f(u_R) = a\\,u_R$.\n\nThe dissipation parameter $\\alpha$ is defined as $\\alpha = |f'(u)|$. The derivative of the flux function is $f'(u) = \\frac{d}{du}(a\\,u) = a$. Thus, $\\alpha = |a|$. Since the problem specifies $a  0$, we have $\\alpha = a$.\n\nNow, we substitute these expressions into the formula for the Lax–Friedrichs flux:\n$$\nF_{\\mathrm{LF}}(u_{L},u_{R}) \\;=\\; \\frac{1}{2}\\Big(f(u_{L}) + f(u_{R})\\Big) \\;-\\; \\frac{\\alpha}{2}\\Big(u_{R} - u_{L}\\Big)\n$$\n$$\nF_{\\mathrm{LF}}(u_{L},u_{R}) \\;=\\; \\frac{1}{2}\\Big(a\\,u_{L} + a\\,u_{R}\\Big) \\;-\\; \\frac{a}{2}\\Big(u_{R} - u_{L}\\Big)\n$$\nDistributing the terms, we get:\n$$\nF_{\\mathrm{LF}}(u_{L},u_{R}) \\;=\\; \\frac{a}{2}u_{L} + \\frac{a}{2}u_{R} - \\frac{a}{2}u_{R} + \\frac{a}{2}u_{L}\n$$\nThe terms involving $u_R$ cancel out:\n$$\nF_{\\mathrm{LF}}(u_{L},u_{R}) \\;=\\; \\frac{a}{2}u_{L} + \\frac{a}{2}u_{L} \\;=\\; a\\,u_{L}\n$$\nThe Godunov flux for $a0$ is defined by selecting the upwind state, which is the left state $u_L$. Therefore, $F_{\\mathrm{God}}(u_{L},u_{R}) = a\\,u_{L}$.\n\nComparing the two results, we have demonstrated that $F_{\\mathrm{LF}}(u_{L},u_{R}) = F_{\\mathrm{God}}(u_{L},u_{R})$ for this specific case.\n\n**Part 2: Derivation of the Modified Equation and Numerical Diffusion**\n\nWe start with the finite volume scheme:\n$$\n\\bar{u}_{i}^{n+1} \\;=\\; \\bar{u}_{i}^{n} \\;-\\; \\frac{\\Delta t}{\\Delta x}\\Big(F_{i+1/2}^{n} \\;-\\; F_{i-1/2}^{n}\\Big)\n$$\nFor a piecewise-constant reconstruction, the left and right states at interface $x_{i+1/2}$ are $u_L = \\bar{u}_{i}^{n}$ and $u_R = \\bar{u}_{i+1}^{n}$, respectively. As shown in Part 1, the numerical flux is the upwind flux $F(u_L, u_R) = a\\,u_L$.\nTherefore, the flux at interface $x_{i+1/2}$ is $F_{i+1/2}^{n} = F(\\bar{u}_{i}^{n}, \\bar{u}_{i+1}^{n}) = a\\,\\bar{u}_{i}^{n}$.\nSimilarly, the flux at interface $x_{i-1/2}$ (with states $\\bar{u}_{i-1}^{n}$ and $\\bar{u}_{i}^{n}$) is $F_{i-1/2}^{n} = F(\\bar{u}_{i-1}^{n}, \\bar{u}_{i}^{n}) = a\\,\\bar{u}_{i-1}^{n}$.\n\nSubstituting these fluxes into the finite volume scheme gives:\n$$\n\\bar{u}_{i}^{n+1} \\;=\\; \\bar{u}_{i}^{n} \\;-\\; \\frac{\\Delta t}{\\Delta x}\\Big(a\\,\\bar{u}_{i}^{n} \\;-\\; a\\,\\bar{u}_{i-1}^{n}\\Big)\n$$\nTo derive the modified equation, we assume the solution $u(x,t)$ is smooth and relate the cell average $\\bar{u}_{i}^{n}$ to the point value $u(x_i, t_n)$, denoted as $u_i^n$. The scheme becomes:\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\frac{a\\,\\Delta t}{\\Delta x}\\Big(u_{i}^{n} \\;-\\; u_{i-1}^{n}\\Big)\n$$\nUsing the definition of the Courant number $\\sigma = \\frac{a\\,\\Delta t}{\\Delta x}$, the scheme is recognized as the first-order upwind method:\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\sigma\\Big(u_{i}^{n} \\;-\\; u_{i-1}^{n}\\Big)\n$$\nWe perform a Taylor series expansion of each term around the point $(x_i, t_n)$. Let $u_t = \\frac{\\partial u}{\\partial t}$, $u_x = \\frac{\\partial u}{\\partial x}$, etc., be the partial derivatives evaluated at $(x_i, t_n)$.\n$$\nu_{i}^{n+1} \\;=\\; u(x_i, t_n + \\Delta t) \\;=\\; u_{i}^{n} + \\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\mathcal{O}((\\Delta t)^3)\n$$\n$$\nu_{i-1}^{n} \\;=\\; u(x_i - \\Delta x, t_n) \\;=\\; u_{i}^{n} - \\Delta x\\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\mathcal{O}((\\Delta x)^3)\n$$\nSubstituting these expansions into the numerical scheme:\n$$\nu_{i}^{n} + \\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\;=\\; u_{i}^{n} - \\sigma\\bigg(u_{i}^{n} - \\Big(u_{i}^{n} - \\Delta x\\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\dots\\Big)\\bigg)\n$$\nThe $u_i^n$ terms on the left and right cancel. The term $u_i^n - u_i^n$ inside the parenthesis on the right is zero.\n$$\n\\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\;=\\; - \\sigma\\bigg(\\Delta x\\, u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots\\bigg)\n$$\nSubstitute $\\sigma = \\frac{a\\,\\Delta t}{\\Delta x}$:\n$$\n\\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\;=\\; - \\frac{a\\,\\Delta t}{\\Delta x}\\bigg(\\Delta x\\, u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\dots\\bigg)\n$$\n$$\n\\Delta t\\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\dots \\;=\\; - a\\,\\Delta t\\, u_x + \\frac{a\\,\\Delta t\\,\\Delta x}{2} u_{xx} + \\dots\n$$\nDividing the entire equation by $\\Delta t$:\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + \\dots \\;=\\; -a\\,u_x + \\frac{a\\,\\Delta x}{2} u_{xx} + \\dots\n$$\nRearranging to match the form of the original PDE:\n$$\nu_t + a\\,u_x \\;=\\; \\frac{a\\,\\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} u_{tt} + \\text{H.O.T.}\n$$\nThis is the modified equation, but it contains a higher-order time derivative $u_{tt}$. To express it purely in terms of spatial derivatives, we differentiate the leading-order part of the modified equation, which is the original PDE, $u_t = -a\\,u_x$.\nDifferentiating with respect to $t$: $u_{tt} = \\frac{\\partial}{\\partial t}(-a\\,u_x) = -a\\,u_{xt}$.\nDifferentiating with respect to $x$: $u_{tx} = -a\\,u_{xx}$.\nAssuming sufficient smoothness, $u_{xt} = u_{tx}$, so we have $u_{tt} = -a(-a\\,u_{xx}) = a^2 u_{xx}$.\n\nSubstituting this result for $u_{tt}$ back into the modified equation:\n$$\nu_t + a\\,u_x \\;=\\; \\frac{a\\,\\Delta x}{2} u_{xx} - \\frac{\\Delta t}{2} (a^2 u_{xx}) + \\text{H.O.T.}\n$$\n$$\nu_t + a\\,u_x \\;=\\; \\left(\\frac{a\\,\\Delta x}{2} - \\frac{a^2\\,\\Delta t}{2}\\right) u_{xx} + \\text{H.O.T.}\n$$\nWe can factor out $\\frac{a\\,\\Delta x}{2}$ from the term in the parenthesis:\n$$\nu_t + a\\,u_x \\;=\\; \\frac{a\\,\\Delta x}{2} \\left(1 - \\frac{a\\,\\Delta t}{\\Delta x}\\right) u_{xx} + \\text{H.O.T.}\n$$\nRecognizing the Courant number $\\sigma = \\frac{a\\,\\Delta t}{\\Delta x}$, the equation becomes:\n$$\nu_t + a\\,u_x \\;=\\; \\frac{a\\,\\Delta x}{2} (1 - \\sigma) u_{xx} + \\text{H.O.T.}\n$$\nThe leading-order error term is a second-derivative term, $\\frac{a\\,\\Delta x}{2} (1 - \\sigma) u_{xx}$, which has the form of a physical diffusion term. The coefficient of $u_{xx}$ is the leading-order numerical diffusion coefficient.\n$$\n\\text{Numerical Diffusion Coefficient} \\;=\\; \\frac{a\\,\\Delta x}{2} (1 - \\sigma)\n$$\nThis expression is in terms of the required quantities $a$, $\\Delta x$, and $\\sigma$.",
            "answer": "$$\n\\boxed{\\frac{a \\Delta x}{2} (1 - \\sigma)}\n$$"
        },
        {
            "introduction": "Advanced schemes like the Roe solver provide high-resolution results but can fail in specific scenarios, producing non-physical solutions. This exercise  presents a classic pathology where the solver violates the entropy condition in a transonic rarefaction, creating an \"expansion shock.\" You will learn to diagnose this failure by analyzing the characteristic speeds across the interface and determine the necessary correction, known as an entropy fix, which is crucial for the robustness of modern CFD codes.",
            "id": "3963045",
            "problem": "You are asked to analyze a one-dimensional Riemann problem for the compressible Euler equations within a Godunov-type finite volume method employing Roe’s approximate Riemann solver. Consider a perfect gas with ratio of specific heats $\\gamma = 1.4$. The left and right states at a cell interface are\n- Left: density $\\rho_L = 1.0$ (in $\\mathrm{kg/m^3}$), velocity $u_L = 100$ (in $\\mathrm{m/s}$), pressure $p_L = 100000$ (in $\\mathrm{Pa}$).\n- Right: density $\\rho_R = 0.5$ (in $\\mathrm{kg/m^3}$), velocity $u_R = 400$ (in $\\mathrm{m/s}$), pressure $p_R = 50000$ (in $\\mathrm{Pa}$).\n\nAssume an ideal gas equation of state and define the speed of sound by $a = \\sqrt{\\gamma p/\\rho}$. The Roe linearization uses a constant Jacobian across the interface with eigenvalues $\\lambda_1 = \\tilde{u} - \\tilde{a}$, $\\lambda_2 = \\tilde{u}$, and $\\lambda_3 = \\tilde{u} + \\tilde{a}$, where tildes denote Roe averages. In transonic rarefaction, Roe’s linearization is known to admit nonphysical expansion shocks because it replaces a continuous self-similar rarefaction fan by a single discontinuity moving at a single speed.\n\nExplain, from the perspective of the entropy condition and characteristic speeds, why a transonic rarefaction in the $1$-family ($\\lambda_1 = u - a$) can be misrepresented by Roe’s solver as an expansion shock for the above data. Then, using a Harten-type entropy fix that replaces $|\\lambda|$ by\n$$\n\\phi(|\\lambda|;\\delta) = \n\\begin{cases}\n\\dfrac{|\\lambda|^2}{2\\delta} + \\dfrac{\\delta}{2},  \\text{if } |\\lambda|  \\delta,\\\\[6pt]\n|\\lambda|,  \\text{if } |\\lambda| \\ge \\delta,\n\\end{cases}\n$$\ndetermine the minimal entropy-fix magnitude $\\delta$ for the $1$-family that is sufficient to eliminate the nonphysical expansion shock for this interface, expressed solely in terms of the left and right characteristic speeds of that family.\n\nCompute the numerical value of $\\delta$ for the given states. Express your final answer in meters per second and round your answer to four significant figures.",
            "solution": "The problem requires an analysis of a one-dimensional Riemann problem for the Euler equations, specifically focusing on a failure mode of Roe's approximate Riemann solver and its correction via an entropy fix. The analysis is divided into two parts: first, an explanation for the occurrence of a nonphysical expansion shock, and second, the determination of a minimal parameter for an entropy fix.\n\n### Part 1: Explanation of the Nonphysical Expansion Shock\n\nThe behavior of solutions to hyperbolic conservation laws, such as the Euler equations, is governed by characteristic waves. The entropy condition distinguishes physically admissible discontinuities (shocks) from nonphysical ones (expansion shocks).\n\nFor a wave associated with the $k$-th characteristic family with speed $\\lambda_k$, the physical nature of the solution between a left state ($L$) and a right state ($R$) is determined by the relative values of the characteristic speeds $\\lambda_{k,L}$ and $\\lambda_{k,R}$.\n1.  **Shock Wave:** A physical shock wave is a compressive discontinuity. For it to be stable, characteristics on both sides must propagate into the shock front. If the shock moves with speed $S$, the Lax entropy condition requires $\\lambda_k(U_L)  S$ and $\\lambda_k(U_R)  S$. This implies that $\\lambda_k(U_L)  \\lambda_k(U_R)$.\n2.  **Rarefaction Wave:** A rarefaction wave is an expansive, continuous solution. The characteristics spread out, meaning $\\lambda_k(U_L)  \\lambda_k(U_R)$. The solution is a self-similar fan of characteristics with speeds varying continuously from $\\lambda_k(U_L)$ to $\\lambda_k(U_R)$.\n\nRoe's approximate Riemann solver linearizes the nonlinear hyperbolic system by defining a constant matrix $\\tilde{A}$ (the Roe matrix) that satisfies $F(U_R) - F(U_L) = \\tilde{A}(U_R - U_L)$. This method approximates the true wave structure of the Riemann problem with a set of discrete discontinuities, each moving at a constant speed equal to one of the eigenvalues of $\\tilde{A}$, denoted by $\\tilde{\\lambda}_k$.\n\nLet us analyze the given Riemann problem for the $1$-family, whose characteristic speed is $\\lambda_1 = u - a$.\nFirst, we compute the speed of sound $a = \\sqrt{\\gamma p / \\rho}$ for the left and right states, with $\\gamma = 1.4$.\n\nFor the left state:\n$\\rho_L = 1.0 \\, \\mathrm{kg/m^3}$, $u_L = 100 \\, \\mathrm{m/s}$, $p_L = 100000 \\, \\mathrm{Pa}$.\n$$ a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 100000}{1.0}} = \\sqrt{140000} \\, \\mathrm{m/s} \\approx 374.17 \\, \\mathrm{m/s} $$\nThe characteristic speed of the $1$-family on the left is:\n$$ \\lambda_{1,L} = u_L - a_L = 100 - \\sqrt{140000} \\approx 100 - 374.17 = -274.17 \\, \\mathrm{m/s} $$\n\nFor the right state:\n$\\rho_R = 0.5 \\, \\mathrm{kg/m^3}$, $u_R = 400 \\, \\mathrm{m/s}$, $p_R = 50000 \\, \\mathrm{Pa}$.\n$$ a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 50000}{0.5}} = \\sqrt{140000} \\, \\mathrm{m/s} \\approx 374.17 \\, \\mathrm{m/s} $$\nThe characteristic speed of the $1$-family on the right is:\n$$ \\lambda_{1,R} = u_R - a_R = 400 - \\sqrt{140000} \\approx 400 - 374.17 = 25.83 \\, \\mathrm{m/s} $$\n\nComparing the characteristic speeds, we find $\\lambda_{1,L}  \\lambda_{1,R}$. According to the entropy condition, this indicates that the true solution for the $1$-wave is a rarefaction wave.\nFurthermore, we observe that $\\lambda_{1,L}  0$ and $\\lambda_{1,R}  0$. This specific case, where the range of characteristic speeds in the wave fan, $(\\lambda_{1,L}, \\lambda_{1,R})$, contains the speed $0$, is known as a *transonic rarefaction*.\n\nRoe's solver does not resolve the continuous fan structure. Instead, it represents the entire $1$-wave as a single discontinuity propagating at the Roe-averaged eigenvalue speed $\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}$. A property of the Roe average is that $\\tilde{\\lambda}_1$ lies between $\\lambda_{1,L}$ and $\\lambda_{1,R}$.\nBy treating the wave as a discontinuity, the solver implicitly assumes it is a shock. However, a physical shock must satisfy $\\lambda_{1,L}  \\lambda_{1,R}$. The given data lead to the opposite, $\\lambda_{1,L}  \\lambda_{1,R}$. Therefore, the discontinuity generated by the pure Roe solver violates the Lax entropy condition. Such a nonphysical, entropy-violating discontinuity that corresponds to an expansion in the flow is called an expansion shock. This is a well-known pathology of Roe's method when dealing with transonic rarefactions.\n\n### Part 2: Determination of the Entropy-Fix Magnitude $\\delta$\n\nThe Harten entropy fix is designed to remedy this pathology by adding numerical viscosity (or diffusion) selectively. The fix modifies the absolute value of the eigenvalue, $|\\lambda|$, in the numerical flux calculation. The provided function is:\n$$\n\\phi(|\\lambda|;\\delta) = \n\\begin{cases}\n\\dfrac{|\\lambda|^2}{2\\delta} + \\dfrac{\\delta}{2},  \\text{if } |\\lambda|  \\delta, \\\\\n|\\lambda|,  \\text{if } |\\lambda| \\ge \\delta.\n\\end{cases}\n$$\nWhen $|\\lambda|$ is small (specifically, less than a threshold $\\delta$), the function $\\phi(|\\lambda|;\\delta)$ provides a larger value, preventing the numerical viscosity from vanishing and \"smearing\" the nonphysical shock into a more physically correct, smooth profile resembling a rarefaction.\n\nThe entropy fix needs to be activated for the problematic wave, which occurs when a rarefaction is transonic. For the $1$-family, this corresponds to the condition $\\lambda_{1,L}  0  \\lambda_{1,R}$. The parameter $\\delta$ must be chosen to be large enough to \"detect\" this situation. A widely adopted and robust choice, proposed by Harten and Hyman, is to scale the fix parameter $\\delta_k$ with the width of the characteristic speed range for the wave family $k$. This ensures that the artificial viscosity is appropriate for the scale of the physical feature it is meant to resolve.\n\nFor the $k$-th wave family, this choice is given by:\n$$ \\delta_k = \\max(0, \\lambda_{k,R} - \\lambda_{k,L}) $$\nFor the $1$-family in this problem, we have confirmed that $\\lambda_{1,R}  \\lambda_{1,L}$, so this simplifies to:\n$$ \\delta_1 = \\lambda_{1,R} - \\lambda_{1,L} $$\nThis expression for $\\delta_1$ is solely in terms of the left and right characteristic speeds, as required. It represents the minimal sufficient magnitude for the entropy-fix parameter under this standard and well-established formulation, ensuring that the fix is applied and provides sufficient numerical viscosity to resolve the transonic rarefaction correctly.\n\nWe now compute the numerical value of $\\delta_1$ for the given states.\n$$ \\delta_1 = (u_R - a_R) - (u_L - a_L) $$\nSubstituting the values we have previously calculated:\n$$ \\lambda_{1,L} = 100 - \\sqrt{140000} \\, \\mathrm{m/s} $$\n$$ \\lambda_{1,R} = 400 - \\sqrt{140000} \\, \\mathrm{m/s} $$\nThe value of $\\delta_1$ is:\n$$ \\delta_1 = (400 - \\sqrt{140000}) - (100 - \\sqrt{140000}) $$\n$$ \\delta_1 = 400 - \\sqrt{140000} - 100 + \\sqrt{140000} $$\n$$ \\delta_1 = 300 \\, \\mathrm{m/s} $$\nThe problem requires the answer to be rounded to four significant figures. The exact value is $300$. To express this with four significant figures, we write it as $300.0$.\nThe minimal entropy-fix magnitude $\\delta$ for the $1$-family is $300.0 \\, \\mathrm{m/s}$.",
            "answer": "$$\n\\boxed{300.0}\n$$"
        }
    ]
}