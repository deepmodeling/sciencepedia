{
    "hands_on_practices": [
        {
            "introduction": "在深入研究通量矢量分裂方法的复杂数学公式之前，我们必须首先掌握其核心的物理原理。本练习  旨在巩固基于特征的迎风思想，它将局部流态（亚音速或超音速）与信息传播的方向联系起来。通过推导声速并计算马赫数 $M$，您将亲身体会到为什么以及如何根据特征速度的符号来分裂通量矢量。",
            "id": "4003770",
            "problem": "考虑一个一维无粘可压缩流动，该流体为热力学和量热学上的理想气体，其流动由欧拉方程控制，正如在计算流体动力学（CFD）中为诸如 van Leer 通量矢量分裂等迎风格式所通常建模的那样。在一个单位法线与 $x$ 方向对齐的平面上，面法向速度分量为 $u$，质量密度为 $\\rho$，热力学压力为 $p$。比热比为 $\\gamma$。从声速的热力学定义——等熵导数 $c^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$ 出发，结合理想气体的等熵关系，推导出声速 $a$ 关于 $\\gamma$、$p$ 和 $\\rho$ 的表达式，然后计算定义为面法向速度与声速之比的面法向马赫数 $M$。接下来，利用一维欧拉系统的特征波速，在 van Leer 通量矢量分裂的背景下解释 $|M|1$ 和 $|M|>1$ 这两种流态，说明特征速度相对于面法线的符号模式以及由此产生的通量分裂贡献的定性结构。\n\n对于数值计算，使用 $\\gamma = 1.4$，$\\rho = 1.0\\,\\mathrm{kg/m^{3}}$，$p = 87500\\,\\mathrm{Pa}$，以及 $u = 300\\,\\mathrm{m/s}$。计算声速 $a$ 和马赫数 $M$。将 $a$ 以米/秒为单位表示，$M$ 为无量纲数。将 $a$ 和 $M$ 的结果都四舍五入到四位有效数字。",
            "solution": "首先对问题进行验证，以确保其科学基础扎实、提法恰当且客观。\n\n**第1步：提取已知条件**\n- 流动模型：一维无粘可压缩流，气体为热力学和量热学上的理想气体，由欧拉方程控制。\n- CFD 背景：迎风格式，特别是 van Leer 通量矢量分裂。\n- 面上的状态变量：面法向速度分量 $u$，质量密度 $\\rho$，热力学压力 $p$。\n- 气体性质：比热比 $\\gamma$。\n- 声速定义：$c^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$。问题中使用符号 $a$ 表示声速。\n- 等熵关系：理想气体的等熵关系。\n- 马赫数定义：$M = \\frac{u}{a}$。\n- 任务1：推导声速 $a$ 关于 $\\gamma$、$p$ 和 $\\rho$ 的表达式。\n- 任务2：基于一维欧拉系统的特征波速，在 van Leer 通量矢量分裂的背景下解释 $|M|1$ 和 $|M|>1$ 的流态。\n- 用于评估的数值：\n  - $\\gamma = 1.4$\n  - $\\rho = 1.0\\,\\mathrm{kg/m^{3}}$\n  - $p = 87500\\,\\mathrm{Pa}$\n  - $u = 300\\,\\mathrm{m/s}$\n- 数值计算任务：计算声速 $a$ 和马赫数 $M$，并将两者均四舍五入至四位有效数字。\n\n**第2步：验证**\n该问题具有坚实的科学基础，植根于流体动力学、气体动力学和计算流体动力学的基本原理。欧拉方程、声速的概念、理想气体模型以及通量矢量分裂背后的理论都是公认的科学概念。问题提法恰当，为获得唯一解提供了所有必要的信息和定义。问题客观且无歧义。所给数值在物理上是一致且符合实际的。因此，该问题被认定为有效。\n\n**第3步：求解**\n\n**第1部分：声速的推导**\n\n声速（用 $a$ 表示）在热力学上定义为在恒定熵 $s$ 的条件下，压力对密度的偏导数的平方根：\n$$a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$$\n对于经历等熵过程（熵恒定的过程）的热力学和量热学上的理想气体，其压力和密度由以下方程关联：\n$$p = K \\rho^{\\gamma}$$\n其中，对于一个给定的等熵过程，$K$ 是一个常数，$\\gamma$ 是比热比。\n\n为了求出导数 $\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$，我们对该关系式关于 $\\rho$ 求导：\n$$\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s} = \\frac{d}{d\\rho}(K \\rho^{\\gamma}) = K \\gamma \\rho^{\\gamma-1}$$\n现在，我们可以根据等熵关系本身，即 $K = \\frac{p}{\\rho^{\\gamma}}$，将常数 $K$ 用 $p$ 和 $\\rho$ 代换回去。\n$$a^2 = \\left(\\frac{p}{\\rho^{\\gamma}}\\right) \\gamma \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho^{\\gamma}} \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho}$$\n取平方根，得到声速的表达式：\n$$a = \\sqrt{\\gamma \\frac{p}{\\rho}}$$\n\n**第2部分：针对 van Leer 通量矢量分裂的马赫数流态解释**\n\n一维欧拉方程可以写成守恒形式：\n$$\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} = 0$$\n其中 $\\mathbf{U}$ 是守恒变量矢量，$\\mathbf{F}$ 是通量矢量：\n$$\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad \\mathbf{F} = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{pmatrix}$$\n这里，$E$ 是单位质量的总能量。\n\n欧拉方程的拟线性形式为 $\\frac{\\partial \\mathbf{U}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{U}}{\\partial x} = 0$，其中 $\\mathbf{A} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}$ 是通量雅可比矩阵。$\\mathbf{A}$ 的特征值代表信息在流体中传播的特征速度。对于一维欧拉方程，这些特征值为：\n$$\\lambda_1 = u - a, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + a$$\n这些速度分别对应于相对于流体运动向上游传播的声波（$u-a$）和向下游传播的声波（$u+a$），以及随流体对流的熵/涡波（$u$）。\n\nvan Leer 通量矢量分裂方法将通量矢量 $\\mathbf{F}$ 分裂为一个前向通量 $\\mathbf{F}^{+}$ 和一个后向通量 $\\mathbf{F}^{-}$，使得 $\\mathbf{F}^{+}$ 的雅可比矩阵只有非负特征值，而 $\\mathbf{F}^{-}$ 的雅可比矩阵只有非正特征值。这种分裂是基于特征速度的符号，而特征速度的符号取决于面法向马赫数 $M = u/a$。\n\n- **流态1：超声速流 ($|M| > 1$)**\n  如果流动是超声速的，则 $|u| > a$。\n  - 如果 $M > 1$（即 $u > a > 0$），那么所有三个特征值都是正的：$\\lambda_1 = u-a > 0$，$\\lambda_2 = u > 0$，以及 $\\lambda_3 = u+a > 0$。这表示所有信息都向下游（$x$ 正方向）传播。因此，不存在上游影响。通量实际上并未被“分裂”；整个通量贡献都来自上游方向。分裂后的通量为 $\\mathbf{F}^{+} = \\mathbf{F}$ 和 $\\mathbf{F}^{-} = \\mathbf{0}$。\n  - 如果 $M  -1$（即 $u  -a  0$），那么所有三个特征值都是负的：$\\lambda_1  0$，$\\lambda_2  0$，以及 $\\lambda_3  0$。所有信息都向上游（$x$ 负方向）传播。分裂后的通量为 $\\mathbf{F}^{+} = \\mathbf{0}$ 和 $\\mathbf{F}^{-} = \\mathbf{F}$。\n  - 总而言之，对于 $|M|>1$ 的情况，所有特征速度的符号都相同，通量矢量不被分割，而是完全分配给 $\\mathbf{F}^{+}$ 或 $\\mathbf{F}^{-}$，这反映了所有物理信号的单向传播特性。\n\n- **流态2：亚声速流 ($|M|  1$)**\n  如果流动是亚声速的，则 $|u|  a$。\n  - 在这种情况下，特征值的符号是混合的。特征值 $\\lambda_1 = u-a$ 总是负的，因为 $u  a$。特征值 $\\lambda_3 = u+a$ 总是正的，因为 $u > -a$。$\\lambda_2 = u$ 的符号取决于流动的方向。\n  - 同时存在正负特征值意味着信息向两个方向传播：对应于 $\\lambda_3$ 的声波向下游传播，而对应于 $\\lambda_1$ 的声波向上游传播。\n  - 这种信息双向流动的物理现实要求将通量矢量 $\\mathbf{F}$ 进行真正的分裂，得到非零的分量 $\\mathbf{F}^{+}$ 和 $\\mathbf{F}^{-}$。$\\mathbf{F}^{+}$ 由与非负特征值（如果 $u \\ge 0$ 则包括 $\\lambda_2$，以及 $\\lambda_3$）相关的流动物理部分构建，而 $\\mathbf{F}^{-}$ 由与非正特征值（$\\lambda_1$，以及如果 $u \\le 0$ 则包括 $\\lambda_2$）相关的部分构建。具体的 van Leer 公式为这些分裂通量在 $|M|$ 穿过 $1$ 时提供了一个平滑（连续可微）的过渡。\n\n**第3部分：数值计算**\n\n给定数值：\n- $\\gamma = 1.4$\n- $\\rho = 1.0\\,\\mathrm{kg/m^{3}}$\n- $p = 87500\\,\\mathrm{Pa}$\n- $u = 300\\,\\mathrm{m/s}$\n\n首先，我们使用推导出的公式计算声速 $a$：\n$$a = \\sqrt{\\gamma \\frac{p}{\\rho}} = \\sqrt{1.4 \\times \\frac{87500\\,\\mathrm{Pa}}{1.0\\,\\mathrm{kg/m^{3}}}} = \\sqrt{1.4 \\times 87500} = \\sqrt{122500} = 350\\,\\mathrm{m/s}$$\n四舍五入到四位有效数字，声速为 $a = 350.0\\,\\mathrm{m/s}$。\n\n接下来，我们计算面法向马赫数 $M$：\n$$M = \\frac{u}{a} = \\frac{300\\,\\mathrm{m/s}}{350\\,\\mathrm{m/s}} = \\frac{30}{35} = \\frac{6}{7}$$\n其小数值约为 $0.8571428...$。\n四舍五入到四位有效数字，马赫数为 $M = 0.8571$。\n\n由于 $|M|=0.8571  1$，该面上的流动是亚声速的。这对应于信息向上游和下游双向传播的情况，van Leer 通量矢量分裂格式将产生非零的 $\\mathbf{F}^{+}$ 和 $\\mathbf{F}^{-}$ 分量。",
            "answer": "$$\\boxed{\\begin{pmatrix} 350.0  0.8571 \\end{pmatrix}}$$"
        },
        {
            "introduction": "理解了通量分裂的基本原理后，下一步是评估其在实践中的表现。本练习  探讨了早期通量矢量分裂方案（如 Steger-Warming 方法）的一个关键缺陷：过度的数值耗散。通过分析一个简单但重要的物理现象——接触间断，您将学习一种强大的分析工具（修正方程分析），并理解为何这些经典格式难以精确捕捉某些流动结构，从而推动了如 AUSM 等更先进格式的发展。",
            "id": "3960852",
            "problem": "考虑理想气体的一维可压缩欧拉方程，其守恒形式写作 $\\partial_{t}\\boldsymbol{U} + \\partial_{x}\\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$，其中 $\\boldsymbol{U} = [\\rho, \\rho u, \\rho E]^{\\top}$，$\\boldsymbol{F}(\\boldsymbol{U}) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$，且 $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$，$\\gamma$ 为比热比。考虑一个黎曼初始条件，其接触间断满足 $p_{L} = p_{R} = p_{0}$ 和 $u_{L} = u_{R} = u_{0}$，但 $\\rho_{L} \\neq \\rho_{R}$，因此其精确解是一个以速度 $u_{0}$ 对流的接触波，没有压力波。\n\n在间距为 $\\Delta x$ 的均匀网格上，应用一阶有限体积半离散格式，并在单元交界面处使用 Steger-Warming 通量矢量分裂。围绕常态 $\\boldsymbol{U}_{0}$ 将格式线性化，并将更新投影到通量雅可比矩阵的接触（熵）特征向量上。对于与接触特征向量对齐的接触场振幅，使用主阶修正方程分析（保留至 $O(\\Delta x)$ 的项），推导由 Steger-Warming 分裂引起的、作用于接触波的有效数值耗散系数。将最终结果表示为包含 $u_{0}$ 和 $\\Delta x$ 的封闭形式解析表达式。将您的表达式表述为有效数值黏性，单位为平方米/秒 (m$^{2}$/s)。无需四舍五入。\n\n此外，简要解释为什么对于给定的接触间断配置 $p_{L} = p_{R}$ 和 $u_{L} = u_{R}$，与 Steger-Warming 相比，对流上游分裂方法+ (AUSM+) 会减少这种耗散。您的解释应从 AUSM+ 中对流通量和压力通量的结构分离以及接触波的特征属性出发。\n\n请仅提供有效数值黏性系数的单一封闭形式表达式作为最终答案。",
            "solution": "该问题陈述经评估具有科学依据、问题适定、客观且自洽。它代表了计算流体力学 (CFD) 领域的标准分析，没有明显缺陷。因此，将提供解答。\n\n该问题要求推导由一阶 Steger-Warming 通量矢量分裂格式建模的接触波的有效数值耗散系数。将使用修正方程方法对一维欧拉方程进行分析。\n\n在间距为 $\\Delta x$ 的均匀网格上，单元 $i$ 的半离散有限体积格式由下式给出：\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x} \\left( \\hat{\\boldsymbol{F}}_{i+1/2} - \\hat{\\boldsymbol{F}}_{i-1/2} \\right)\n$$\n其中 $\\boldsymbol{U}_i$ 是单元平均状态向量。对于使用 Steger-Warming 分裂的一阶格式，交界面 $i+1/2$ 处的数值通量为：\n$$\n\\hat{\\boldsymbol{F}}_{i+1/2} = \\boldsymbol{F}^+(\\boldsymbol{U}_i) + \\boldsymbol{F}^-(\\boldsymbol{U}_{i+1})\n$$\n通量 $\\boldsymbol{F}^+$ 和 $\\boldsymbol{F}^-$ 分别是物理通量 $\\boldsymbol{F}$ 中与通量雅可比矩阵 $\\boldsymbol{A} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{U}}$ 的正特征值和负特征值相关的部分。它们由 $\\boldsymbol{F}^{\\pm} = \\boldsymbol{A}^{\\pm}\\boldsymbol{U}$ 定义，其中 $\\boldsymbol{A}^{\\pm} = \\boldsymbol{S}\\boldsymbol{\\Lambda}^{\\pm}\\boldsymbol{S}^{-1}$，$\\boldsymbol{\\Lambda}$ 是 $\\boldsymbol{A}$ 的特征值对角矩阵，$\\boldsymbol{\\Lambda}^{\\pm}$ 包含特征值的正部和负部。\n\n将数值通量代入半离散方程，得到：\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x} \\left[ \\left(\\boldsymbol{F}^+(\\boldsymbol{U}_i) + \\boldsymbol{F}^-(\\boldsymbol{U}_{i+1})\\right) - \\left(\\boldsymbol{F}^+(\\boldsymbol{U}_{i-1}) + \\boldsymbol{F}^-(\\boldsymbol{U}_{i})\\right) \\right]\n$$\n整理各项：\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x} \\left[ \\left(\\boldsymbol{F}^+(\\boldsymbol{U}_i) - \\boldsymbol{F}^+(\\boldsymbol{U}_{i-1})\\right) + \\left(\\boldsymbol{F}^-(\\boldsymbol{U}_{i+1}) - \\boldsymbol{F}^-(\\boldsymbol{U}_i)\\right) \\right]\n$$\n为推导修正方程，我们围绕位置 $x_i$ 对通量项进行泰勒级数展开：\n$$\n\\boldsymbol{F}^+(\\boldsymbol{U}_{i-1}) = \\boldsymbol{F}^+(\\boldsymbol{U}_i) - \\Delta x \\frac{\\partial \\boldsymbol{F}^+}{\\partial x} \\bigg|_i + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^+}{\\partial x^2} \\bigg|_i - O((\\Delta x)^3)\n$$\n$$\n\\boldsymbol{F}^-(\\boldsymbol{U}_{i+1}) = \\boldsymbol{F}^-(\\boldsymbol{U}_i) + \\Delta x \\frac{\\partial \\boldsymbol{F}^-}{\\partial x} \\bigg|_i + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^-}{\\partial x^2} \\bigg|_i + O((\\Delta x)^3)\n$$\n将这些展开式代入格式，并将左侧的时间导数替换为其连续对应项，我们得到：\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} \\approx -\\frac{1}{\\Delta x} \\left[ \\Delta x \\frac{\\partial \\boldsymbol{F}^+}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^+}{\\partial x^2} + \\Delta x \\frac{\\partial \\boldsymbol{F}^-}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^-}{\\partial x^2} \\right] + O((\\Delta x)^2)\n$$\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} \\approx -\\left(\\frac{\\partial \\boldsymbol{F}^+}{\\partial x} + \\frac{\\partial \\boldsymbol{F}^-}{\\partial x}\\right) + \\frac{\\Delta x}{2} \\left(\\frac{\\partial^2 \\boldsymbol{F}^+}{\\partial x^2} - \\frac{\\partial^2 \\boldsymbol{F}^-}{\\partial x^2}\\right)\n$$\n由于 $\\boldsymbol{F} = \\boldsymbol{F}^+ + \\boldsymbol{F}^-$，第一项是 $-\\frac{\\partial \\boldsymbol{F}}{\\partial x}$。方程变为：\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}}{\\partial x} \\approx \\frac{\\Delta x}{2} \\frac{\\partial^2}{\\partial x^2} \\left( \\boldsymbol{F}^+ - \\boldsymbol{F}^- \\right)\n$$\n这就是修正偏微分方程，它包含了数值格式的主阶误差项。为了分析此误差项，我们在常态 $\\boldsymbol{U}_0$ 周围进行线性化。在这种情况下，$\\boldsymbol{F}^{\\pm}(\\boldsymbol{U}) \\approx \\boldsymbol{A}^{\\pm}(\\boldsymbol{U}_0)\\boldsymbol{U}$，这里我们利用了欧拉通量的齐次性。\n项 $\\boldsymbol{F}^+ - \\boldsymbol{F}^-$ 可以写作 $(\\boldsymbol{A}^+ - \\boldsymbol{A}^-)\\boldsymbol{U}$。矩阵 $\\boldsymbol{A}^+ - \\boldsymbol{A}^-$ 是 $\\boldsymbol{S}(\\boldsymbol{\\Lambda}^+ - \\boldsymbol{\\Lambda}^-)\\boldsymbol{S}^{-1} = \\boldsymbol{S}|\\boldsymbol{\\Lambda}|\\boldsymbol{S}^{-1} = |\\boldsymbol{A}|$，其中 $|\\boldsymbol{A}|$ 是一个矩阵，其特征值为 $\\boldsymbol{A}$ 特征值的绝对值。\n线性化的修正方程为：\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\boldsymbol{A} \\frac{\\partial \\boldsymbol{U}}{\\partial x} = \\frac{\\Delta x}{2} |\\boldsymbol{A}| \\frac{\\partial^2 \\boldsymbol{U}}{\\partial x^2}\n$$\n右侧项代表了格式的数值耗散。\n\n我们关心的是作用于接触波的耗散。这对应于与特征值 $\\lambda_2 = u$ 相关的特征场。我们将修正方程投影到 $\\boldsymbol{A}$ 的特征向量基上。设解的扰动分解为 $\\delta \\boldsymbol{U} = \\boldsymbol{U} - \\boldsymbol{U}_0 = \\sum_{k=1}^3 \\alpha_k \\boldsymbol{r}_k$，其中 $\\boldsymbol{r}_k$ 是 $\\boldsymbol{A}$ 的右特征向量，$\\alpha_k$ 是特征变量振幅。使用与 $\\lambda_2 = u$ 对应的左特征向量 $\\boldsymbol{l}_2^{\\top}$ 对该方程进行投影，可以分离出 $\\alpha_2$ 的演化：\n$$\n\\boldsymbol{l}_2^{\\top} \\left( \\frac{\\partial (\\alpha_2 \\boldsymbol{r}_2)}{\\partial t} + \\boldsymbol{A} \\frac{\\partial (\\alpha_2 \\boldsymbol{r}_2)}{\\partial x} \\right) = \\boldsymbol{l}_2^{\\top} \\left( \\frac{\\Delta x}{2} |\\boldsymbol{A}| \\frac{\\partial^2 (\\alpha_2 \\boldsymbol{r}_2)}{\\partial x^2} \\right)\n$$\n假设在此线性分析中特征向量是常数，并使用性质 $\\boldsymbol{A}\\boldsymbol{r}_2 = \\lambda_2 \\boldsymbol{r}_2$ 和 $\\boldsymbol{l}_2^{\\top}\\boldsymbol{r}_2 = 1$（经过适当归一化），左侧变为：\n$$\n\\frac{\\partial \\alpha_2}{\\partial t} + \\lambda_2 \\frac{\\partial \\alpha_2}{\\partial x}\n$$\n对于右侧，我们使用 $|\\boldsymbol{A}|\\boldsymbol{r}_2 = \\boldsymbol{S}|\\boldsymbol{\\Lambda}|\\boldsymbol{S}^{-1}\\boldsymbol{r}_2 = |\\lambda_2|\\boldsymbol{r}_2$。投影得出：\n$$\n\\boldsymbol{l}_2^{\\top} \\left( \\frac{\\Delta x}{2} |\\lambda_2|\\boldsymbol{r}_2 \\frac{\\partial^2 \\alpha_2}{\\partial x^2} \\right) = \\frac{\\Delta x}{2} |\\lambda_2| \\frac{\\partial^2 \\alpha_2}{\\partial x^2}\n$$\n因此，接触波振幅的修正方程是一个对流-扩散方程：\n$$\n\\frac{\\partial \\alpha_2}{\\partial t} + \\lambda_2 \\frac{\\partial \\alpha_2}{\\partial x} = \\left(\\frac{\\Delta x}{2} |\\lambda_2|\\right) \\frac{\\partial^2 \\alpha_2}{\\partial x^2}\n$$\n问题指定了一个具有均匀速度 $u_L = u_R = u_0$ 的接触间断。因此，相关特征值为 $\\lambda_2 = u_0$。乘以二阶空间导数的项是有效数值耗散系数 $\\nu_{\\text{num}}$。\n$$\n\\nu_{\\text{num}} = \\frac{1}{2} |u_0| \\Delta x\n$$\n这个表达式表明 Steger-Warming 格式引入了与波速和网格间距成正比的数值耗散，这会不必要地模糊接触间断。\n\n关于对流上游分裂方法+ (AUSM+)，其在处理接触间断方面的优越性能源于其对通量矢量的物理（而非数学）分裂。AUSM+ 通量被分离为对流部分和压力部分：$\\hat{\\boldsymbol{F}} = \\hat{\\boldsymbol{F}}_c + \\hat{\\boldsymbol{P}}$。对于给定的初始条件，$p_L = p_R = p_0$ 且 $u_L = u_R = u_0$。在这种情况下，压力是连续的，流场在交界面上处于力学平衡状态。AUSM+ 中的压力通量项，其设计目的是处理声波，此时会处于静止状态，不会引入虚假的压力振荡或耗散。对于恒定速度场，对流通量项实际上简化为对被对流的量（$\\rho$ 和 $\\rho E$）的简单上游平流。这种纯上游格式是输运接触间断的精确机制，因此产生的数值耗散非常低。相比之下，Steger-Warming 基于特征值的分裂强制所有特征场之间发生耦合。即使在没有压力波的情况下，基于 $\\{u-c, u, u+c\\}$ 符号的分裂也会不适当地混合来自左右两种状态的信息，而这两种状态具有不同的密度（$\\rho_L \\neq \\rho_R$），从而产生显著的数值耗散，使接触间断变得模糊。",
            "answer": "$$\n\\boxed{\\frac{1}{2}|u_{0}|\\Delta x}\n$$"
        },
        {
            "introduction": "最后的练习将理论分析与计算实践紧密结合，聚焦于隐式求解器的收敛性能，这在计算流体力学中至关重要。本编程练习  将让您通过傅里叶分析，亲手验证“通量一致”雅可比矩阵对伪瞬态求解器收敛速度的显著影响。通过对比精确雅可比矩阵与简化模型的效果，您将深刻理解数值通量与其精确导数之间的紧密联系，以及理论的严谨性如何直接转化为计算效率的提升。",
            "id": "3960902",
            "problem": "考虑由欧拉方程描述的理想气体一维无粘可压缩流动，其比热容比为 $\\gamma$。令守恒状态向量为 $U = [\\rho, \\rho u, \\rho E]^{\\mathrm{T}}$，其中 $\\rho$ 是密度， $u$ 是速度， $E$ 是比总能。物理通量向量 $F(U)$ 由 $F(U) = [\\rho u,\\ \\rho u^{2} + p,\\ u(\\rho E + p)]^{\\mathrm{T}}$ 给出，状态方程为 $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$。\n\n一类被称为通量矢量分裂的数值方法依赖于通量雅可比矩阵 $A = \\partial F / \\partial U$ 的特征分解，并将通量分裂为正向和负向对流分量。van Leer 通量矢量分裂通过将特征值平滑地分裂为其正部和负部，从 $A$ 的谱分解中构造矩阵 $A^{+}$ 和 $A^{-}$。对于给定的数值通量，通量一致的雅可比矩阵定义为该数值通量相对于守恒变量 $U$ 的精确导数。\n\n用于稳态问题的伪瞬态延拓法（PTC）通过隐式迭代 $U^{n+1} = U^{n} - \\left(I/\\Delta \\tau + J(U^{n})\\right)^{-1} R(U^{n})$ 来更新状态，其中 $I$ 是单位矩阵，$\\Delta \\tau$ 是伪时间步长，$R(U)$ 是半离散残差，$J(U)$ 是更新中使用的雅可比矩阵。当在均匀状态附近线性化时，周期性网格上的全局残差算子具有傅里叶符号表示。对于一致的 van Leer 分裂，线性化残差的符号可以表示为 $A$、$A^{+}$ 和 $A^{-}$ 的函数，傅里叶模态迭代矩阵的形式为 $M(k) = I - \\left(I/\\Delta \\tau + J(k)\\right)^{-1} K(k)$，其中 $k$ 是模态的波数（以弧度为单位）。$M(k)$ 的谱半径决定了每个 PTC 迭代中该傅里叶模态的收缩情况。通过选择 $J(k)$ 为通量一致的雅可比矩阵来匹配精确的耗散特征结构，与不匹配的耗散（例如，与 $A$ 的特征结构不对齐的标量局部 Lax–Friedrichs 耗散）相比，有望减小所有模态中的最坏情况谱半径，从而改善全局收敛性。\n\n从欧拉方程、物理通量的定义以及通量雅可比矩阵的谱分解出发，推导具有最近邻数值通量的周期性网格上线性化残差算子的结构。实现一个程序，该程序：\n- 为理想气体构造物理通量 $F(U)$。\n- 通过数值稳健的方法计算均匀基准状态下的通量雅可比矩阵 $A = \\partial F / \\partial U$。\n- 使用平滑的熵修正进行特征值分裂，以确保在声速条件下可微，从而构建 van Leer 分裂矩阵 $A^{+}$ 和 $A^{-}$。\n- 在一维周期性网格上，使用最近邻耦合，为 van Leer 分裂通量组装线性化残差算子的傅里叶符号 $K(k)$。\n- 构建第二个不匹配的雅可比模型，该模型基于强度为 $s = |u| + a$ 的局部 Lax–Friedrichs 标量耗散，其中 $a$ 是声速，从而为 PTC 更新中使用的雅可比矩阵产生一个不同的傅里叶符号 $\\widetilde{K}(k)$。\n- 形成一致迭代矩阵 $M_{\\mathrm{cons}}(k) = I - \\left(I/\\Delta \\tau + K(k)\\right)^{-1} K(k)$ 和不匹配迭代矩阵 $M_{\\mathrm{mis}}(k) = I - \\left(I/\\Delta \\tau + \\widetilde{K}(k)\\right)^{-1} K(k)$。\n- 对每种情况，计算所有非零傅里叶模态下的最坏情况谱半径 $\\rho_{\\max}$，然后估计将残差范数减小因子 $\\varepsilon$ 所需的最小整数迭代次数 $n$，当 $0  \\rho_{\\max}  1$ 时使用 $n = \\lceil \\log(\\varepsilon)/\\log(\\rho_{\\max}) \\rceil$，如果 $\\rho_{\\max} \\geq 1$（线性意义上不收敛）则定义 $n = -1$，如果 $\\rho_{\\max} = 0$ 则定义 $n = 1$。\n\n使用以下无量纲参数测试套件（角度必须以弧度处理）：\n- 情况 1（亚声速）：$\\gamma = 1.4$，$\\rho = 1.0$，$p = 1.0$，马赫数 $M = 0.5$，伪时间步长 $\\Delta \\tau = 1.0$，网格傅里叶模态采样点数 $N = 64$。\n- 情况 2（近声速）：$\\gamma = 1.4$，$\\rho = 1.0$，$p = 1.0$，马赫数 $M = 0.999$，伪时间步长 $\\Delta \\tau = 1.0$，网格傅里叶模态采样点数 $N = 64$。\n- 情况 3（超声速）：$\\gamma = 1.4$，$\\rho = 1.0$，$p = 1.0$，马赫数 $M = 2.0$，伪时间步长 $\\Delta \\tau = 1.0$，网格傅里叶模态采样点数 $N = 64$。\n- 情况 4（大伪时间步）：$\\gamma = 1.4$，$\\rho = 1.0$，$p = 1.0$，马赫数 $M = 0.7$，伪时间步长 $\\Delta \\tau = 100.0$，网格傅里叶模态采样点数 $N = 64$。\n\n在所有情况下，令用于分裂的熵修正平滑参数为声速的一部分，$\\delta = \\beta a$，其中 $\\beta = 0.05$，并设置期望的残差减小因子为 $\\varepsilon = 10^{-8}$。傅里叶模态应排除零模态 $k = 0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。该列表必须按上述顺序列出每种情况的两个整数 $[n_{\\mathrm{cons}}, n_{\\mathrm{mis}}]$，并将它们展平成一个单一列表。例如，输出格式必须与 $[n_{1,\\mathrm{cons}},n_{1,\\mathrm{mis}},n_{2,\\mathrm{cons}},n_{2,\\mathrm{mis}},n_{3,\\mathrm{cons}},n_{3,\\mathrm{mis}},n_{4,\\mathrm{cons}},n_{4,\\mathrm{mis}}]$ 完全一样。",
            "solution": "该问题要求对一维欧拉方程的伪瞬态延拓法（PTC）的收敛特性进行傅里叶分析。我们将比较使用源自 van Leer 通量矢量分裂格式的通量一致雅可比矩阵的隐式更新，与使用来自标量 Lax-Friedrichs (Rusanov) 耗散模型的不匹配雅可比矩阵的隐式更新的性能。\n\n### 1. 控制方程和状态变量\n\n理想气体的一维、无粘、可压缩流动由欧拉方程描述，其守恒形式可以写为 $\\partial U / \\partial t + \\partial F(U) / \\partial x = 0$。守恒量向量 $U$ 和物理通量向量 $F(U)$ 由下式给出：\n$$\nU = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{bmatrix}, \\quad F(U) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{bmatrix}\n$$\n这里，$\\rho$ 是流体密度，$u$ 是速度，$E$ 是比总能，$p$ 是压力。该系统由理想气体状态方程封闭：\n$$\np = (\\gamma - 1) \\left(\\rho E - \\frac{1}{2}\\rho u^2 \\right)\n$$\n其中 $\\gamma$ 是比热容比。通量中的项 $u(\\rho E + p)$ 可以写为 $\\rho u H$，其中 $H = E + p/\\rho$ 是比总焓。\n\n### 2. 线性化与通量雅可比矩阵\n\n对数值方法的稳定性和收敛特性的分析是通过围绕均匀平均流状态 $U_0$ 对方程进行线性化来执行的。这涉及到通量雅可比矩阵 $A(U) = \\partial F / \\partial U$。该矩阵的解析形式为：\n$$\nA = \\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}u^2  (3-\\gamma)u  \\gamma-1 \\\\ u\\left( \\frac{\\gamma-1}{2}u^2 - H \\right)  H - (\\gamma-1)u^2  \\gamma u \\end{pmatrix}\n$$\n其中所有原始变量（$u$，$H$ 等）都在均匀状态下进行评估。该状态由给定参数 $(\\rho, p, M, \\gamma)$ 定义，我们从中计算声速 $a = \\sqrt{\\gamma p / \\rho}$ 和速度 $u = M a$。\n\n### 3. 通量雅可比矩阵的特征分解\n雅可比矩阵 $A$ 是一个具有实特征值和完备特征向量集的实矩阵，这反映了欧拉方程的双曲性质。系统可以被对角化为 $A = R \\Lambda L$，其中 $R$ 是右特征向量矩阵，$L=R^{-1}$ 是左特征向量矩阵，$\\Lambda$ 是特征值的对角矩阵。\n\n特征值代表了波传播的特征速度，它们是：\n$$\n\\lambda_1 = u - a, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + a\n$$\n右特征向量矩阵 $R$ 及其逆矩阵 $L$ 是：\n$$\nR = \\begin{pmatrix} 1  1  1 \\\\ u-a  u  u+a \\\\ H - ua  \\frac{1}{2}u^2  H+ua \\end{pmatrix}\n$$\n$$\nL = \\frac{1}{2a^2}\\begin{pmatrix} \\frac{(\\gamma-1)u^2}{2} + ua  -(\\gamma-1)u - a  \\gamma-1 \\\\ 2a^2 - (\\gamma-1)u^2  2(\\gamma-1)u  -2(\\gamma-1) \\\\ \\frac{(\\gamma-1)u^2}{2} - ua  -(\\gamma-1)u + a  \\gamma-1 \\end{pmatrix}\n$$\n\n### 4. Van Leer 通量矢量分裂\n通量矢量分裂方法根据波传播的方向来分解通量。在线性化系统的背景下，这对应于将雅可比矩阵 $A$ 分裂为与正特征值和负特征值相关的部分，即 $A = A^+ + A^-$。van Leer 格式采用对特征值的平滑分裂，以确保分裂后的通量是连续可微的，这对于隐式方法至关重要。特征值 $\\lambda_i$ 使用熵修正参数 $\\delta$ 进行分裂：\n$$\n\\lambda_i^{\\pm} = \\frac{1}{2} \\left( \\lambda_i \\pm \\sqrt{\\lambda_i^2 + \\delta^2} \\right)\n$$\n其中问题指定 $\\delta = \\beta a$，$\\beta = 0.05$。这种分裂确保了对于非零的 $\\delta$，$\\lambda_i^+$ 是严格为正的，$\\lambda_i^-$ 是严格为负的，并且它们的和为 $\\lambda_i^+ + \\lambda_i^- = \\lambda_i$。\n然后通过重新组装这些分量来构造分裂的雅可比矩阵：\n$$\nA^{\\pm} = R \\Lambda^{\\pm} L, \\quad \\text{其中} \\quad \\Lambda^{\\pm} = \\mathrm{diag}(\\lambda_1^{\\pm}, \\lambda_2^{\\pm}, \\lambda_3^{\\pm})\n$$\n\n### 5. 离散算子的傅里叶分析\n我们在单个傅里叶模态 $U_j = \\hat{U} e^{i k x_j}$ 上分析格式的行为，其中 $x_j=j\\Delta x$，$k$ 是波数。在具有 $N$ 个点的周期性网格上，离散波数导致网格角 $\\theta = k \\Delta x = 2\\pi m/N$，其中 $m \\in \\{1, \\dots, N-1\\}$。空间离散化算子可以由其矩阵值的傅里叶符号表示。\n\n使用 van Leer 分裂的一阶迎风格式的半离散残差为 $R_j = \\frac{1}{\\Delta x} [F_{j+1/2} - F_{j-1/2}]$，其数值通量为 $F_{j+1/2} = F^+(U_j) + F^-(U_{j+1})$。将此残差线性化并变换到傅里叶空间，得到 van Leer 数值残差的精确雅可比矩阵的符号：\n$$\nK(\\theta) = A^+ (1 - e^{-i\\theta}) + A^- (e^{i\\theta} - 1)\n$$\n这是**一致**雅可比矩阵的符号。\n\n对于**不匹配**的情况，PTC 更新中的雅可比矩阵近似是基于局部 Lax-Friedrichs（或 Rusanov）格式。该格式的数值通量为 $F_{j+1/2} = \\frac{1}{2}(F(U_j) + F(U_{j+1})) - \\frac{s}{2}(U_{j+1} - U_j)$。该格式残差的雅可比矩阵的傅里叶符号是：\n$$\n\\widetilde{K}(\\theta) = i \\sin(\\theta) A + s(1 - \\cos(\\theta))I\n$$\n其中 $s = |u| + a$ 是标量耗散系数，$I$ 是 $3 \\times 3$ 的单位矩阵。\n\n### 6. 伪瞬态延拓法与收敛性分析\n用于求解稳态方程 $R(U)=0$ 的 PTC 迭代由下式给出：\n$$\nU^{n+1} = U^{n} - \\left(\\frac{I}{\\Delta \\tau} + J(U^{n})\\right)^{-1} R(U^{n})\n$$\n其中 $J(U)$ 是用于隐式更新的雅可比矩阵。在傅里叶空间中，角度为 $\\theta$ 的模态的误差放大矩阵（或迭代矩阵）为：\n$$\nM(\\theta) = I - \\left(\\frac{I}{\\Delta \\tau} + J(\\theta)\\right)^{-1} K(\\theta)\n$$\n其中 $K(\\theta)$ 始终是 van Leer 残差的符号，$J(\\theta)$ 是更新中使用的雅可比矩阵的符号。这给出了两个迭代矩阵：\n- **一致雅可比矩阵**：$J(\\theta) = K(\\theta) \\implies M_{\\mathrm{cons}}(\\theta) = I - \\left(\\frac{I}{\\Delta \\tau} + K(\\theta)\\right)^{-1} K(\\theta)$\n- **不匹配雅可比矩阵**：$J(\\theta) = \\widetilde{K}(\\theta) \\implies M_{\\mathrm{mis}}(\\theta) = I - \\left(\\frac{I}{\\Delta \\tau} + \\widetilde{K}(\\theta)\\right)^{-1} K(\\theta)$\n\n格式的收敛性由迭代矩阵的谱半径 $\\rho(M) = \\max_i |\\sigma_i(M)|$ 决定，其中 $\\sigma_i$ 是 $M$ 的特征值。如果 $\\rho(M)  1$，则格式收敛。总收敛率由所有非零傅里叶模态中的最坏情况（最大）谱半径决定：\n$$\n\\rho_{\\max} = \\max_{\\theta \\in \\{2\\pi m/N\\}_{m=1}^{N-1}} \\rho(M(\\theta))\n$$\n将残差范数减小因子 $\\varepsilon$ 所需的迭代次数 $n$ 可估计为：\n$$\nn = \\begin{cases} -1  \\text{若 } \\rho_{\\max} \\ge 1 \\\\ 1  \\text{若 } \\rho_{\\max} = 0 \\\\ \\lceil \\log(\\varepsilon) / \\log(\\rho_{\\max}) \\rceil  \\text{若 } 0  \\rho_{\\max}  1 \\end{cases}\n$$\n该问题要求针对所提供的一组流动参数，计算一致和不匹配两种情况下的 $n$。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main solver function to orchestrate the analysis for all test cases.\n    \"\"\"\n    \n    test_cases = [\n        # (gamma, rho, p, M, delta_tau, N)\n        (1.4, 1.0, 1.0, 0.5, 1.0, 64),\n        (1.4, 1.0, 1.0, 0.999, 1.0, 64),\n        (1.4, 1.0, 1.0, 2.0, 1.0, 64),\n        (1.4, 1.0, 1.0, 0.7, 100.0, 64),\n    ]\n\n    epsilon = 1e-8\n    beta = 0.05\n    all_results = []\n\n    for case in test_cases:\n        gamma, rho, p, M, delta_tau, N = case\n        n_cons, n_mis = run_case(gamma, rho, p, M, delta_tau, N, beta, epsilon)\n        all_results.extend([n_cons, n_mis])\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\n\ndef run_case(gamma, rho, p, M, delta_tau, N, beta, epsilon):\n    \"\"\"\n    Computes the iteration counts for a single test case.\n    \"\"\"\n    # 1. Compute Base State\n    a = math.sqrt(gamma * p / rho)\n    u = M * a\n    E = p / (rho * (gamma - 1.0)) + 0.5 * u**2\n    H = E + p / rho\n    \n    # 2. Construct Flux Jacobian (A)\n    A = np.zeros((3, 3))\n    A[0, 1] = 1.0\n    A[1, 0] = 0.5 * (gamma - 3.0) * u**2\n    A[1, 1] = (3.0 - gamma) * u\n    A[1, 2] = gamma - 1.0\n    A[2, 0] = u * (0.5 * (gamma - 1.0) * u**2 - H)\n    A[2, 1] = H - (gamma - 1.0) * u**2\n    A[2, 2] = gamma * u\n\n    # 3. Construct Eigenvector Matrices (R and L)\n    R = np.array([\n        [1.0, 1.0, 1.0],\n        [u - a, u, u + a],\n        [H - u * a, 0.5 * u**2, H + u * a]\n    ])\n    \n    L = np.zeros((3, 3))\n    factor = 1.0 / (2.0 * a**2)\n    L[0, 0] = factor * (0.5 * (gamma - 1.0) * u**2 + u * a)\n    L[0, 1] = factor * (- (gamma - 1.0) * u - a)\n    L[0, 2] = factor * (gamma - 1.0)\n    L[1, 0] = factor * (2.0 * a**2 - (gamma - 1.0) * u**2)\n    L[1, 1] = factor * (2.0 * (gamma - 1.0) * u)\n    L[1, 2] = factor * (-2.0 * (gamma - 1.0))\n    L[2, 0] = factor * (0.5 * (gamma - 1.0) * u**2 - u * a)\n    L[2, 1] = factor * (- (gamma - 1.0) * u + a)\n    L[2, 2] = factor * (gamma - 1.0)\n\n    # 4. Eigenvalues and Entropy Fix\n    lambdas = np.array([u - a, u, u + a])\n    delta = beta * a\n    \n    # 5. Loop over Fourier Modes\n    max_rho_cons = 0.0\n    max_rho_mis = 0.0\n    I_mat = np.eye(3)\n\n    for j in range(1, N):\n        theta = 2.0 * math.pi * j / N\n        \n        # Van Leer Eigenvalue Splitting\n        lambdas_p = 0.5 * (lambdas + np.sqrt(lambdas**2 + delta**2))\n        lambdas_m = 0.5 * (lambdas - np.sqrt(lambdas**2 + delta**2))\n        \n        Lambda_p = np.diag(lambdas_p)\n        Lambda_m = np.diag(lambdas_m)\n        \n        Ap = R @ Lambda_p @ L\n        Am = R @ Lambda_m @ L\n        \n        # Fourier Symbol for van Leer Residual (K)\n        exp_itheta = complex(math.cos(theta), math.sin(theta))\n        exp_neg_itheta = complex(math.cos(-theta), math.sin(-theta))\n        K = Ap * (1.0 - exp_neg_itheta) + Am * (exp_itheta - 1.0)\n        \n        # Fourier Symbol for LLF Jacobian (K_tilde)\n        s = abs(u) + a\n        K_tilde = 1j * math.sin(theta) * A + s * (1.0 - math.cos(theta)) * I_mat\n        \n        # Iteration Matrices\n        # Consistent\n        inv_part_cons = I_mat / delta_tau + K\n        M_cons = I_mat - np.linalg.inv(inv_part_cons) @ K\n\n        # Mismatched\n        inv_part_mis = I_mat / delta_tau + K_tilde\n        M_mis = I_mat - np.linalg.inv(inv_part_mis) @ K\n\n        # Spectral Radii\n        rho_cons = np.max(np.abs(np.linalg.eigvals(M_cons)))\n        rho_mis = np.max(np.abs(np.linalg.eigvals(M_mis)))\n        \n        if rho_cons > max_rho_cons:\n            max_rho_cons = rho_cons\n        if rho_mis > max_rho_mis:\n            max_rho_mis = rho_mis\n    \n    # 6. Calculate Iteration Counts\n    def get_iterations(rho_max, eps):\n        if rho_max >= 1.0 - 1e-12:\n            return -1\n        if np.isclose(rho_max, 0):\n            return 1\n        return int(math.ceil(math.log(eps) / math.log(rho_max)))\n        \n    n_cons = get_iterations(max_rho_cons, epsilon)\n    n_mis = get_iterations(max_rho_mis, epsilon)\n    \n    return n_cons, n_mis\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}