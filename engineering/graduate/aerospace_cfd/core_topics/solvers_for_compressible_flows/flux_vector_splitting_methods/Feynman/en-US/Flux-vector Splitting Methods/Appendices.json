{
    "hands_on_practices": [
        {
            "introduction": "The fundamental principle of flux-vector splitting is to align the numerical discretization with the physical direction of information flow. This practice provides a foundational exercise in connecting the mathematical structure of the Euler equations to this physical principle. By deriving the speed of sound $a$ and calculating the Mach number $M$, you will interpret how the flow regime—subsonic ($|M| \\lt 1$) or supersonic ($|M| \\gt 1$)—dictates the direction of characteristic wave propagation and, consequently, the structure of the split fluxes in schemes like Van Leer's .",
            "id": "4003770",
            "problem": "Consider a one-dimensional inviscid compressible flow of a thermally and calorically perfect gas governed by the Euler equations, as commonly modeled in Computational Fluid Dynamics (CFD) for upwind schemes such as van Leer flux-vector splitting. At a planar face whose unit normal is aligned with the $x$-direction, the face-normal velocity component is $u$, the mass density is $\\rho$, and the thermodynamic pressure is $p$. The ratio of specific heats is $\\gamma$. Starting from the thermodynamic definition of the acoustic speed as the isentropic derivative $c^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$ together with the ideal-gas isentropic relation for a perfect gas, derive the sound speed $a$ in terms of $\\gamma$, $p$, and $\\rho$, then compute the face-normal Mach number $M$ defined as the ratio of the face-normal velocity to the sound speed. Next, use the characteristic wave speeds of the one-dimensional Euler system to interpret the regimes $|M|1$ and $|M|1$ in the context of van Leer flux-vector splitting, explaining the sign pattern of the characteristic speeds relative to the face normal and the consequent qualitative structure of the split flux contributions.\n\nFor the numerical evaluation, use $\\gamma = 1.4$, $\\rho = 1.0\\,\\mathrm{kg/m^{3}}$, $p = 87{,}500\\,\\mathrm{Pa}$, and $u = 300\\,\\mathrm{m/s}$. Compute the sound speed $a$ and the Mach number $M$. Express $a$ in meters per second and $M$ as dimensionless. Round both $a$ and $M$ to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extraction of Givens**\n- Flow model: One-dimensional inviscid compressible flow of a thermally and calorically perfect gas, governed by the Euler equations.\n- CFD context: Upwind schemes, specifically van Leer flux-vector splitting.\n- State variables at a face: Face-normal velocity component $u$, mass density $\\rho$, thermodynamic pressure $p$.\n- Gas property: Ratio of specific heats $\\gamma$.\n- Definition of acoustic speed: $c^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$. The problem uses the symbol $a$ for the sound speed.\n- Isentropic relation: The ideal-gas isentropic relation for a perfect gas.\n- Definition of Mach number: $M = \\frac{u}{a}$.\n- Task 1: Derive the sound speed $a$ in terms of $\\gamma$, $p$, and $\\rho$.\n- Task 2: Interpret the flow regimes $|M|1$ and $|M|1$ in the context of van Leer flux-vector splitting, based on the characteristic wave speeds of the one-dimensional Euler system.\n- Numerical values for evaluation:\n  - $\\gamma = 1.4$\n  - $\\rho = 1.0\\,\\mathrm{kg/m^{3}}$\n  - $p = 87{,}500\\,\\mathrm{Pa}$\n  - $u = 300\\,\\mathrm{m/s}$\n- Numerical computation task: Compute the sound speed $a$ and Mach number $M$, rounding both to four significant figures.\n\n**Step 2: Validation**\nThe problem is scientifically grounded, rooted in the fundamental principles of fluid dynamics, gas dynamics, and computational fluid dynamics. The Euler equations, the concept of sound speed, the model of a perfect gas, and the theory behind flux-vector splitting are all well-established scientific concepts. The problem is well-posed, providing all necessary information and definitions for a unique solution. It is objective and free of ambiguity. The numerical values are physically consistent and realistic. Therefore, the problem is deemed valid.\n\n**Step 3: Solution**\n\n**Part 1: Derivation of the Sound Speed**\n\nThe sound speed, denoted by $a$, is defined thermodynamically as the square root of the partial derivative of pressure with respect to density at constant entropy $s$:\n$$a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$$\nFor a thermally and calorically perfect gas undergoing an isentropic process (a process at constant entropy), the pressure and density are related by the following equation:\n$$p = K \\rho^{\\gamma}$$\nwhere $K$ is a constant for a given isentropic process and $\\gamma$ is the ratio of specific heats.\n\nTo find the derivative $\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$, we differentiate this relation with respect to $\\rho$:\n$$\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s} = \\frac{d}{d\\rho}(K \\rho^{\\gamma}) = K \\gamma \\rho^{\\gamma-1}$$\nNow, we can substitute the constant $K$ back in terms of $p$ and $\\rho$ from the isentropic relation itself, i.e., $K = \\frac{p}{\\rho^{\\gamma}}$.\n$$a^2 = \\left(\\frac{p}{\\rho^{\\gamma}}\\right) \\gamma \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho^{\\gamma}} \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho}$$\nTaking the square root gives the expression for the sound speed:\n$$a = \\sqrt{\\gamma \\frac{p}{\\rho}}$$\n\n**Part 2: Interpretation of Mach Number Regimes for van Leer Flux-Vector Splitting**\n\nThe one-dimensional Euler equations can be written in conservative form as:\n$$\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} = 0$$\nwhere $\\mathbf{U}$ is the vector of conserved variables and $\\mathbf{F}$ is the vector of fluxes:\n$$\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad \\mathbf{F} = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{pmatrix}$$\nHere, $E$ is the total energy per unit mass.\n\nThe quasi-linear form of the Euler equations is $\\frac{\\partial \\mathbf{U}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{U}}{\\partial x} = 0$, where $\\mathbf{A} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}$ is the flux Jacobian matrix. The eigenvalues of $\\mathbf{A}$ represent the characteristic speeds at which information propagates through the fluid. For the one-dimensional Euler equations, these eigenvalues are:\n$$\\lambda_1 = u - a, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + a$$\nThese speeds correspond to acoustic waves traveling upstream ($u-a$) and downstream ($u+a$) relative to the fluid motion, and an entropy/vorticity wave being convected with the flow ($u$).\n\nThe van Leer flux-vector splitting method splits the flux vector $\\mathbf{F}$ into a forward flux $\\mathbf{F}^{+}$ and a backward flux $\\mathbf{F}^{-}$, such that the Jacobian of $\\mathbf{F}^{+}$ has only non-negative eigenvalues and the Jacobian of $\\mathbf{F}^{-}$ has only non-positive eigenvalues. This splitting is based on the signs of the characteristic speeds, which depend on the face-normal Mach number, $M = u/a$.\n\n- **Regime 1: Supersonic Flow ($|M|  1$)**\n  If the flow is supersonic, $|u|  a$.\n  - If $M  1$ (i.e., $u  a  0$), then all three eigenvalues are positive: $\\lambda_1 = u-a  0$, $\\lambda_2 = u  0$, and $\\lambda_3 = u+a  0$. This signifies that all information propagates downstream (in the direction of positive $x$). Consequently, there is no upstream influence. The flux is not truly \"split\"; the entire flux contribution comes from the upstream direction. The split fluxes are $\\mathbf{F}^{+} = \\mathbf{F}$ and $\\mathbf{F}^{-} = \\mathbf{0}$.\n  - If $M  -1$ (i.e., $u  -a  0$), then all three eigenvalues are negative: $\\lambda_1  0$, $\\lambda_2  0$, and $\\lambda_3  0$. All information propagates upstream (in the direction of negative $x$). The split fluxes are $\\mathbf{F}^{+} = \\mathbf{0}$ and $\\mathbf{F}^{-} = \\mathbf{F}$.\n  - In summary, for $|M|1$, all characteristic speeds share the same sign, and the flux vector is not divided but is wholly assigned to either $\\mathbf{F}^{+}$ or $\\mathbf{F}^{-}$, reflecting the unidirectional propagation of all physical signals.\n\n- **Regime 2: Subsonic Flow ($|M|  1$)**\n  If the flow is subsonic, $|u|  a$.\n  - In this case, the signs of the eigenvalues are mixed. The eigenvalue $\\lambda_1 = u-a$ is always negative, since $u  a$. The eigenvalue $\\lambda_3 = u+a$ is always positive, since $u  -a$. The sign of $\\lambda_2 = u$ depends on the direction of the flow.\n  - The presence of both positive and negative eigenvalues signifies that information propagates in both directions: the acoustic wave corresponding to $\\lambda_3$ travels downstream, while the acoustic wave corresponding to $\\lambda_1$ travels upstream.\n  - This physical reality of bidirectional information flow requires a genuine splitting of the flux vector $\\mathbf{F}$ into non-zero components $\\mathbf{F}^{+}$ and $\\mathbf{F}^{-}$. $\\mathbf{F}^{+}$ is constructed from the parts of the flow physics associated with non-negative eigenvalues ($\\lambda_2$ if $u \\ge 0$, and $\\lambda_3$), and $\\mathbf{F}^{-}$ is constructed from the parts associated with non-positive eigenvalues ($\\lambda_1$, and $\\lambda_2$ if $u \\le 0$). The specific van Leer formulas provide a smooth (continuously differentiable) transition for these split fluxes as $|M|$ passes through $1$.\n\n**Part 3: Numerical Evaluation**\n\nGiven the values:\n- $\\gamma = 1.4$\n- $\\rho = 1.0\\,\\mathrm{kg/m^{3}}$\n- $p = 87{,}500\\,\\mathrm{Pa}$\n- $u = 300\\,\\mathrm{m/s}$\n\nFirst, we compute the sound speed $a$ using the derived formula:\n$$a = \\sqrt{\\gamma \\frac{p}{\\rho}} = \\sqrt{1.4 \\times \\frac{87{,}500\\,\\mathrm{Pa}}{1.0\\,\\mathrm{kg/m^{3}}}} = \\sqrt{1.4 \\times 87{,}500} = \\sqrt{122{,}500} = 350\\,\\mathrm{m/s}$$\nRounding to four significant figures, the sound speed is $a = 350.0\\,\\mathrm{m/s}$.\n\nNext, we compute the face-normal Mach number $M$:\n$$M = \\frac{u}{a} = \\frac{300\\,\\mathrm{m/s}}{350\\,\\mathrm{m/s}} = \\frac{30}{35} = \\frac{6}{7}$$\nAs a decimal, this is approximately $0.8571428...$.\nRounding to four significant figures, the Mach number is $M = 0.8571$.\n\nSince $|M|=0.8571  1$, the flow at the face is subsonic. This corresponds to the case where information propagates both upstream and downstream, and the van Leer flux vector splitting scheme would result in non-zero $\\mathbf{F}^{+}$ and $\\mathbf{F}^{-}$ components.",
            "answer": "$$\\boxed{\\begin{pmatrix} 350.0  0.8571 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While conceptually elegant, early flux-vector splitting methods like Steger-Warming can introduce significant non-physical artifacts. A classic example is the excessive smearing of contact discontinuities, which should ideally propagate without dissipation. This practice introduces the powerful technique of modified equation analysis to formally derive and quantify the numerical diffusion coefficient responsible for this error, providing critical insight into a scheme's accuracy and motivating the development of more advanced methods like AUSM+ .",
            "id": "3960852",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas, written in conservative form as $\\partial_{t}\\boldsymbol{U} + \\partial_{x}\\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$, where $\\boldsymbol{U} = [\\rho, \\rho u, \\rho E]^{\\top}$, $\\boldsymbol{F}(\\boldsymbol{U}) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$, and $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$ with $\\gamma$ the ratio of specific heats. Consider a Riemann initial condition with a contact discontinuity satisfying $p_{L} = p_{R} = p_{0}$ and $u_{L} = u_{R} = u_{0}$, but with $\\rho_{L} \\neq \\rho_{R}$, so that the exact solution is a contact wave convecting at speed $u_{0}$ with no pressure waves.\n\nOn a uniform grid of spacing $\\Delta x$, apply a first-order finite-volume semi-discrete scheme with Steger–Warming flux-vector splitting at cell interfaces. Linearize the scheme about the constant state $\\boldsymbol{U}_{0}$ and project the update onto the contact (entropy) eigenvector of the flux Jacobian. Using a leading-order modified equation analysis (retaining terms up to $O(\\Delta x)$) for the contact field amplitude aligned with the contact eigenvector, derive the effective numerical diffusion coefficient that acts on the contact wave due to the Steger–Warming splitting. Express your final result as a closed-form analytic expression in terms of $u_{0}$ and $\\Delta x$. State your expression as an effective numerical viscosity with units of meters squared per second (m$^{2}$/s). No rounding is required.\n\nAdditionally, briefly explain why the Advection Upstream Splitting Method plus (AUSM+) reduces this diffusion for the given contact discontinuity configuration $p_{L} = p_{R}$ and $u_{L} = u_{R}$ compared to Steger–Warming. Your explanation should start from the structural separation of convective and pressure fluxes in AUSM+ and the characteristic properties of the contact wave.\n\nProvide only the single closed-form expression for the effective numerical viscosity coefficient as your final answer.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and self-contained. It represents a standard analysis in the field of Computational Fluid Dynamics (CFD) and contains no apparent flaws. Therefore, a solution will be provided.\n\nThe problem asks for the derivation of the effective numerical diffusion coefficient for a contact wave, as modeled by the first-order Steger–Warming flux-vector splitting scheme. The analysis will be performed using a modified equation approach for the one-dimensional Euler equations.\n\nThe semi-discrete finite-volume scheme for a cell $i$ on a uniform grid with spacing $\\Delta x$ is given by:\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x} \\left( \\hat{\\boldsymbol{F}}_{i+1/2} - \\hat{\\boldsymbol{F}}_{i-1/2} \\right)\n$$\nwhere $\\boldsymbol{U}_i$ is the cell-averaged state vector. For a first-order scheme utilizing Steger–Warming splitting, the numerical flux at the interface $i+1/2$ is:\n$$\n\\hat{\\boldsymbol{F}}_{i+1/2} = \\boldsymbol{F}^+(\\boldsymbol{U}_i) + \\boldsymbol{F}^-(\\boldsymbol{U}_{i+1})\n$$\nThe fluxes $\\boldsymbol{F}^+$ and $\\boldsymbol{F}^-$ are the parts of the physical flux $\\boldsymbol{F}$ associated with positive and negative eigenvalues of the flux Jacobian matrix $\\boldsymbol{A} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{U}}$, respectively. They are defined by $\\boldsymbol{F}^{\\pm} = \\boldsymbol{A}^{\\pm}\\boldsymbol{U}$, where $\\boldsymbol{A}^{\\pm} = \\boldsymbol{S}\\boldsymbol{\\Lambda}^{\\pm}\\boldsymbol{S}^{-1}$, $\\boldsymbol{\\Lambda}$ is the diagonal matrix of eigenvalues of $\\boldsymbol{A}$, and $\\boldsymbol{\\Lambda}^{\\pm}$ contain the positive and negative parts of the eigenvalues.\n\nSubstituting the numerical flux into the semi-discrete equation gives:\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x} \\left[ \\left(\\boldsymbol{F}^+(\\boldsymbol{U}_i) + \\boldsymbol{F}^-(\\boldsymbol{U}_{i+1})\\right) - \\left(\\boldsymbol{F}^+(\\boldsymbol{U}_{i-1}) + \\boldsymbol{F}^-(\\boldsymbol{U}_{i})\\right) \\right]\n$$\nRearranging the terms:\n$$\n\\frac{d\\boldsymbol{U}_i}{dt} = -\\frac{1}{\\Delta x} \\left[ \\left(\\boldsymbol{F}^+(\\boldsymbol{U}_i) - \\boldsymbol{F}^+(\\boldsymbol{U}_{i-1})\\right) + \\left(\\boldsymbol{F}^-(\\boldsymbol{U}_{i+1}) - \\boldsymbol{F}^-(\\boldsymbol{U}_i)\\right) \\right]\n$$\nTo derive the modified equation, we perform a Taylor series expansion of the flux terms around the location $x_i$:\n$$\n\\boldsymbol{F}^+(\\boldsymbol{U}_{i-1}) = \\boldsymbol{F}^+(\\boldsymbol{U}_i) - \\Delta x \\frac{\\partial \\boldsymbol{F}^+}{\\partial x} \\bigg|_i + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^+}{\\partial x^2} \\bigg|_i - O((\\Delta x)^3)\n$$\n$$\n\\boldsymbol{F}^-(\\boldsymbol{U}_{i+1}) = \\boldsymbol{F}^-(\\boldsymbol{U}_i) + \\Delta x \\frac{\\partial \\boldsymbol{F}^-}{\\partial x} \\bigg|_i + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^-}{\\partial x^2} \\bigg|_i + O((\\Delta x)^3)\n$$\nSubstituting these expansions into the scheme and replacing the time derivative on the left-hand side with its continuous counterpart, we obtain:\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} \\approx -\\frac{1}{\\Delta x} \\left[ \\Delta x \\frac{\\partial \\boldsymbol{F}^+}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^+}{\\partial x^2} + \\Delta x \\frac{\\partial \\boldsymbol{F}^-}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\boldsymbol{F}^-}{\\partial x^2} \\right] + O((\\Delta x)^2)\n$$\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} \\approx -\\left(\\frac{\\partial \\boldsymbol{F}^+}{\\partial x} + \\frac{\\partial \\boldsymbol{F}^-}{\\partial x}\\right) + \\frac{\\Delta x}{2} \\left(\\frac{\\partial^2 \\boldsymbol{F}^+}{\\partial x^2} - \\frac{\\partial^2 \\boldsymbol{F}^-}{\\partial x^2}\\right)\n$$\nSince $\\boldsymbol{F} = \\boldsymbol{F}^+ + \\boldsymbol{F}^-$, the first term is $-\\frac{\\partial \\boldsymbol{F}}{\\partial x}$. The equation becomes:\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}}{\\partial x} \\approx \\frac{\\Delta x}{2} \\frac{\\partial^2}{\\partial x^2} \\left( \\boldsymbol{F}^+ - \\boldsymbol{F}^- \\right)\n$$\nThis is the modified partial differential equation, which includes the leading-order error term of the numerical scheme. To analyze this error term, we linearize around a constant state $\\boldsymbol{U}_0$. In this case, $\\boldsymbol{F}^{\\pm}(\\boldsymbol{U}) \\approx \\boldsymbol{A}^{\\pm}(\\boldsymbol{U}_0)\\boldsymbol{U}$, where we use the homogeneity property of the Euler fluxes.\nThe term $\\boldsymbol{F}^+ - \\boldsymbol{F}^-$ can be written as $(\\boldsymbol{A}^+ - \\boldsymbol{A}^-)\\boldsymbol{U}$. The matrix $\\boldsymbol{A}^+ - \\boldsymbol{A}^-$ is $\\boldsymbol{S}(\\boldsymbol{\\Lambda}^+ - \\boldsymbol{\\Lambda}^-)\\boldsymbol{S}^{-1} = \\boldsymbol{S}|\\boldsymbol{\\Lambda}|\\boldsymbol{S}^{-1} = |\\boldsymbol{A}|$, where $|\\boldsymbol{A}|$ is a matrix whose eigenvalues are the absolute values of the eigenvalues of $\\boldsymbol{A}$.\nThe linearized modified equation is:\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\boldsymbol{A} \\frac{\\partial \\boldsymbol{U}}{\\partial x} = \\frac{\\Delta x}{2} |\\boldsymbol{A}| \\frac{\\partial^2 \\boldsymbol{U}}{\\partial x^2}\n$$\nThe right-hand side represents the numerical diffusion of the scheme.\n\nWe are interested in the diffusion acting on the contact wave. This corresponds to the characteristic field associated with the eigenvalue $\\lambda_2 = u$. We project the modified equation onto the basis of the eigenvectors of $\\boldsymbol{A}$. Let the solution perturbation be decomposed as $\\delta \\boldsymbol{U} = \\boldsymbol{U} - \\boldsymbol{U}_0 = \\sum_{k=1}^3 \\alpha_k \\boldsymbol{r}_k$, where $\\boldsymbol{r}_k$ are the right eigenvectors of $\\boldsymbol{A}$ and $\\alpha_k$ are the characteristic variable amplitudes. Projecting the equation using the left eigenvector $\\boldsymbol{l}_2^{\\top}$ corresponding to $\\lambda_2 = u$ isolates the evolution of $\\alpha_2$:\n$$\n\\boldsymbol{l}_2^{\\top} \\left( \\frac{\\partial (\\alpha_2 \\boldsymbol{r}_2)}{\\partial t} + \\boldsymbol{A} \\frac{\\partial (\\alpha_2 \\boldsymbol{r}_2)}{\\partial x} \\right) = \\boldsymbol{l}_2^{\\top} \\left( \\frac{\\Delta x}{2} |\\boldsymbol{A}| \\frac{\\partial^2 (\\alpha_2 \\boldsymbol{r}_2)}{\\partial x^2} \\right)\n$$\nAssuming the eigenvectors are constant for this linear analysis, and using the properties $\\boldsymbol{A}\\boldsymbol{r}_2 = \\lambda_2 \\boldsymbol{r}_2$ and $\\boldsymbol{l}_2^{\\top}\\boldsymbol{r}_2 = 1$ (with proper normalization), the left side becomes:\n$$\n\\frac{\\partial \\alpha_2}{\\partial t} + \\lambda_2 \\frac{\\partial \\alpha_2}{\\partial x}\n$$\nFor the right side, we use $|\\boldsymbol{A}|\\boldsymbol{r}_2 = \\boldsymbol{S}|\\boldsymbol{\\Lambda}|\\boldsymbol{S}^{-1}\\boldsymbol{r}_2 = |\\lambda_2|\\boldsymbol{r}_2$. The projection yields:\n$$\n\\boldsymbol{l}_2^{\\top} \\left( \\frac{\\Delta x}{2} |\\lambda_2|\\boldsymbol{r}_2 \\frac{\\partial^2 \\alpha_2}{\\partial x^2} \\right) = \\frac{\\Delta x}{2} |\\lambda_2| \\frac{\\partial^2 \\alpha_2}{\\partial x^2}\n$$\nThus, the modified equation for the amplitude of the contact wave is a convection-diffusion equation:\n$$\n\\frac{\\partial \\alpha_2}{\\partial t} + \\lambda_2 \\frac{\\partial \\alpha_2}{\\partial x} = \\left(\\frac{\\Delta x}{2} |\\lambda_2|\\right) \\frac{\\partial^2 \\alpha_2}{\\partial x^2}\n$$\nThe problem specifies a contact discontinuity with uniform velocity $u_L = u_R = u_0$. The relevant eigenvalue is therefore $\\lambda_2 = u_0$. The term multiplying the second spatial derivative is the effective numerical diffusion coefficient, $\\nu_{\\text{num}}$.\n$$\n\\nu_{\\text{num}} = \\frac{1}{2} |u_0| \\Delta x\n$$\nThis expression shows that the Steger–Warming scheme introduces numerical diffusion proportional to the wave speed and the grid spacing, which undesirably smears contact discontinuities.\n\nRegarding the Advection Upstream Splitting Method plus (AUSM+), its superior performance for contact discontinuities stems from its physical, rather than mathematical, splitting of the flux vector. The AUSM+ flux is separated into a convective part and a pressure part: $\\hat{\\boldsymbol{F}} = \\hat{\\boldsymbol{F}}_c + \\hat{\\boldsymbol{P}}$. For the given initial condition, $p_L = p_R = p_0$ and $u_L = u_R = u_0$. In this scenario, the pressure is continuous and the flow is in mechanical equilibrium across the interface. The pressure flux term in AUSM+, which is designed to handle acoustic waves, becomes quiescent and introduces no spurious pressure oscillations or diffusion. The convective flux term, for a constant velocity field, effectively reduces to a simple upwind advection of the convected quantities ($\\rho$ and $\\rho E$). This pure upwinding is the exact mechanism for transporting a contact discontinuity, resulting in very low numerical diffusion. In contrast, Steger–Warming's eigenvalue-based splitting forces a coupling between all characteristic fields. Even with no pressure waves present, the splitting based on the signs of $\\{u-c, u, u+c\\}$ inappropriately mixes information from the left and right states, which have different densities ($\\rho_L \\neq \\rho_R$), thereby generating significant numerical diffusion that smears the contact.",
            "answer": "$$\n\\boxed{\\frac{1}{2}|u_{0}|\\Delta x}\n$$"
        },
        {
            "introduction": "Beyond accuracy, the robustness and smoothness of a numerical scheme are paramount for practical CFD, especially in implicit solvers where Jacobians are required. The original Steger-Warming splitting suffers from a non-differentiable 'kink' at sonic points, where an eigenvalue $\\lambda$ passes through zero, due to its reliance on the absolute value function $|\\lambda|$. In this exercise, you will analyze this issue and derive a common and effective remedy—a continuously differentiable 'entropy fix'—that smooths the eigenvalue splitting and improves the scheme's robustness .",
            "id": "3960890",
            "problem": "Consider the one-dimensional Euler equations for a calorically perfect gas with ratio of specific heats $\\gamma$, written in conservation form for the state vector $U = [\\rho, \\rho u, \\rho E]^{\\mathsf{T}}$ and convective flux $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\mathsf{T}}$, where $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$. Let $A(U) = \\partial F / \\partial U$ denote the flux Jacobian, whose eigen-decomposition is $A = R \\Lambda L$, with eigenvalues $\\lambda_{1} = u - c$, $\\lambda_{2} = u$, and $\\lambda_{3} = u + c$, right eigenvectors $R$, left eigenvectors $L$, and local speed of sound $c = \\sqrt{\\gamma p/\\rho}$. In the Steger–Warming flux-vector splitting, positive and negative flux contributions are defined by splitting the eigenvalues into positive and negative parts based on the absolute value operation, which induces characteristic dissipation in the numerical flux at an interface in Computational Fluid Dynamics (CFD).\n\nSuppose a finite-volume interface located at $x_{i+\\tfrac{1}{2}}$ separates left and right states $U_{L}$ and $U_{R}$ that are small perturbations of a uniform base state $U_{0}$, and consider a linearized analysis around $U_{0}$ using the eigen-decomposition of $A(U_{0})$ and characteristic variables. Derive, from first principles, the form of the Steger–Warming numerical flux at the interface as a sum of a central (non-dissipative) term plus a characteristic dissipation term that is controlled by the magnitude of the eigenvalues through the absolute value operation. Use this to analyze the behavior of the right-going acoustic characteristic associated with $\\lambda_{3}$ near a sonic point, where $u + c$ crosses zero. Specifically, parameterize the departure from exact sonic conditions by writing $u + c = \\eta$ with $|\\eta| \\ll 1$ and show how the absolute value $|\\eta|$ imposes a non-differentiable kink at $\\eta = 0$, which manifests as left–right symmetric dissipation in the acoustic field.\n\nTo avoid this nondifferentiable kink while retaining correct asymptotic behavior away from the sonic point, propose a continuous eigenvalue smoothing function $\\psi(\\lambda)$ to be used in place of $|\\lambda|$ within the characteristic dissipation term. Your smoothing function must satisfy the following conditions:\n- It is an even function: $\\psi(-\\lambda) = \\psi(\\lambda)$.\n- It is continuously differentiable: $\\psi \\in C^{1}(\\mathbb{R})$.\n- It matches the unsmoothed magnitude away from the sonic region: $\\psi(\\lambda) = |\\lambda|$ for $|\\lambda| \\ge \\varepsilon$, for a given small positive smoothing parameter $\\varepsilon$.\n- Inside the sonic transition band $|\\lambda|  \\varepsilon$, it is a low-order polynomial in $\\lambda$ chosen such that both the function value and its derivative match those of $|\\lambda|$ at $\\lambda = \\pm \\varepsilon$.\n\nUnder these constraints, derive the unique quadratic form for $\\psi(\\lambda)$ on $|\\lambda|  \\varepsilon$, and then specialize it to obtain the smoothed dissipation magnitude for the right-going acoustic characteristic near sonic conditions, i.e., $\\alpha(\\eta, \\varepsilon) = \\psi(\\eta)$ with $|\\eta|  \\varepsilon$. Provide your final answer as a single closed-form analytic expression for $\\alpha(\\eta, \\varepsilon)$, suitable for use in the Steger–Warming characteristic dissipation term. No numerical evaluation is required, and no units are needed in the final expression.",
            "solution": "The problem requires the derivation of a smoothing function used to regularize the dissipation term in the Steger–Warming flux-vector splitting scheme, particularly near sonic points. The derivation proceeds from first principles, beginning with the structure of the numerical flux and culminating in the specific analytical form of the required smoothing function.\n\nThe one-dimensional Euler equations are given in conservation form with state vector $U = [\\rho, \\rho u, \\rho E]^{\\mathsf{T}}$ and convective flux $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\mathsf{T}}$. The flux Jacobian is $A(U) = \\partial F / \\partial U$. For a linearized analysis around a uniform base state $U_0$, the Jacobian $A_0 = A(U_0)$ is treated as constant. Its eigen-decomposition is $A_0 = R_0 \\Lambda_0 L_0$, where $\\Lambda_0$ is the diagonal matrix of eigenvalues $\\lambda_j$.\n\nThe Steger–Warming flux-vector splitting scheme defines the numerical flux at a cell interface $x_{i+\\frac{1}{2}}$ between a left state $U_L$ and a right state $U_R$ by splitting the Jacobian into parts associated with positive and negative eigenvalues:\n$$ F_{i+\\frac{1}{2}} = A_0^+ U_L + A_0^- U_R $$\nHere, $A_0^+ = R_0 \\Lambda_0^+ L_0$ and $A_0^- = R_0 \\Lambda_0^- L_0$. The diagonal matrices $\\Lambda_0^+$ and $\\Lambda_0^-$ are formed from the positive and negative parts of the eigenvalues, respectively. These can be expressed using the absolute value function: $\\lambda^+_j = \\frac{1}{2}(\\lambda_j + |\\lambda_j|)$ and $\\lambda^-_j = \\frac{1}{2}(\\lambda_j - |\\lambda_j|)$. Thus, the matrices are $\\Lambda_0^{\\pm} = \\frac{1}{2}(\\Lambda_0 \\pm |\\Lambda_0|)$, where $|\\Lambda_0|$ is the diagonal matrix with entries $|\\lambda_j|$.\n\nSubstituting these expressions into the numerical flux formula:\n$$ F_{i+\\frac{1}{2}} = R_0 \\left(\\frac{1}{2}(\\Lambda_0 + |\\Lambda_0|)\\right) L_0 U_L + R_0 \\left(\\frac{1}{2}(\\Lambda_0 - |\\Lambda_0|)\\right) L_0 U_R $$\nBy rearranging terms, we can separate the flux into a central (non-dissipative) part and a dissipative part:\n$$ F_{i+\\frac{1}{2}} = \\frac{1}{2} R_0 \\Lambda_0 L_0 (U_L + U_R) - \\frac{1}{2} R_0 |\\Lambda_0| L_0 (U_R - U_L) $$\nRecognizing that $A_0 = R_0 \\Lambda_0 L_0$ and that in a linearized context $F(U) \\approx A_0 U$, the expression becomes:\n$$ F_{i+\\frac{1}{2}} \\approx \\frac{1}{2}(F(U_L) + F(U_R)) - \\frac{1}{2} R_0 |\\Lambda_0| L_0 (U_R - U_L) $$\nThe first term is a central flux average, and the second term is a numerical dissipation term, $D = \\frac{1}{2} |A_0| (U_R - U_L)$, where $|A_0| = R_0 |\\Lambda_0| L_0$. The dissipation is controlled by the magnitude of the eigenvalues, $|\\lambda_j|$.\n\nThe problem focuses on the behavior near a sonic point for the right-going acoustic characteristic, where its associated eigenvalue $\\lambda_3 = u+c$ passes through zero. We parameterize this as $\\eta = u+c$. The dissipation for this characteristic is proportional to $|\\eta|$. The function $f(\\eta)=|\\eta|$ has a non-differentiable point (a \"kink\") at $\\eta=0$, which can cause numerical stability and smoothness issues.\n\nTo resolve this, we seek a continuously differentiable smoothing function $\\psi(\\lambda)$ to replace $|\\lambda|$. The function must satisfy the following constraints:\n1.  It is an even function: $\\psi(-\\lambda) = \\psi(\\lambda)$.\n2.  It is continuously differentiable: $\\psi \\in C^{1}(\\mathbb{R})$.\n3.  It matches $|\\lambda|$ outside a small interval: $\\psi(\\lambda) = |\\lambda|$ for $|\\lambda| \\ge \\varepsilon$.\n4.  It is a quadratic polynomial for $|\\lambda|  \\varepsilon$.\n\nLet the quadratic polynomial for $|\\lambda|  \\varepsilon$ be $P(\\lambda) = a\\lambda^2 + b\\lambda + c_{\\text{poly}}$.\nFrom the even function condition (1), the coefficient of the odd-degree term must be zero, so $b=0$. The polynomial simplifies to:\n$$ P(\\lambda) = a\\lambda^2 + c_{\\text{poly}} $$\nTo ensure continuous differentiability (condition 2), the function value and its first derivative must match at the transition points $\\lambda = \\pm\\varepsilon$. Due to the even symmetry, we only need to enforce the matching conditions at $\\lambda = \\varepsilon$.\nFrom condition (3), for $\\lambda \\ge \\varepsilon$, we have $\\psi(\\lambda) = |\\lambda| = \\lambda$ and its derivative is $\\psi'(\\lambda) = 1$.\n\nWe set up a system of two equations by matching $P(\\lambda)$ and its derivative to $\\psi(\\lambda)$ and its derivative at $\\lambda = \\varepsilon$:\na) Matching function values:\n$$ P(\\varepsilon) = \\psi(\\varepsilon) \\implies a\\varepsilon^2 + c_{\\text{poly}} = \\varepsilon $$\nb) Matching derivative values:\n$$ P'(\\lambda) = 2a\\lambda \\implies P'(\\varepsilon) = \\psi'(\\varepsilon) \\implies 2a\\varepsilon = 1 $$\n\nSolving this system for $a$ and $c_{\\text{poly}}$:\nFrom the derivative matching equation (b), we find $a$:\n$$ a = \\frac{1}{2\\varepsilon} $$\nSubstituting this value of $a$ into the function value matching equation (a):\n$$ \\left(\\frac{1}{2\\varepsilon}\\right)\\varepsilon^2 + c_{\\text{poly}} = \\varepsilon $$\n$$ \\frac{\\varepsilon}{2} + c_{\\text{poly}} = \\varepsilon $$\nSolving for $c_{\\text{poly}}$:\n$$ c_{\\text{poly}} = \\varepsilon - \\frac{\\varepsilon}{2} = \\frac{\\varepsilon}{2} $$\nThe unique quadratic polynomial that satisfies the conditions for $|\\lambda|  \\varepsilon$ is therefore:\n$$ \\psi(\\lambda) = \\frac{1}{2\\varepsilon}\\lambda^2 + \\frac{\\varepsilon}{2} $$\nThis can be written more compactly as:\n$$ \\psi(\\lambda) = \\frac{\\lambda^2 + \\varepsilon^2}{2\\varepsilon} $$\nThe problem asks for the smoothed dissipation magnitude, $\\alpha(\\eta, \\varepsilon)$, for the right-going acoustic characteristic near sonic conditions. This corresponds to evaluating $\\psi(\\lambda)$ at $\\lambda = \\eta$, where $|\\eta|  \\varepsilon$.\nThus, the final expression is:\n$$ \\alpha(\\eta, \\varepsilon) = \\frac{\\eta^2 + \\varepsilon^2}{2\\varepsilon} $$\nThis function is quadratic, continuously differentiable everywhere, and smoothly transitions to $|\\eta|$ for $|\\eta| \\ge \\varepsilon$, thereby removing the problematic kink at the sonic point.",
            "answer": "$$\n\\boxed{\\frac{\\eta^{2} + \\varepsilon^{2}}{2 \\varepsilon}}\n$$"
        }
    ]
}