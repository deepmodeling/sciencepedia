## 引言
在[计算流体动力学](@entry_id:142614)（CFD）领域，对[可压缩流](@entry_id:747589)动的精确和鲁棒模拟是航空航天设计、能源科学及诸多前沿研究的基石。然而，开发一种能够在从低速到高超声速的广阔范围内，同时准确捕捉激波、[接触间断](@entry_id:194702)等复杂现象的数值格式，始终是一项艰巨的挑战。平流上游分裂方法（Advection Upstream Splitting Method, AUSM）族格式正是在应对这一挑战中应运而生的杰出代表。它摒弃了复杂的[特征分解](@entry_id:181333)，转而从流动的物理本质出发，将通量分解为更直观的平流[部分和](@entry_id:162077)压力部分，从而在物理保真度与计算效率之间取得了卓越的平衡。

本文旨在为读者提供一个关于AUSM族格式的全面而深入的理解。通过学习，您将掌握这一先进数值方法的核心思想、技术细节及其在解决实际问题中的强大能力。

- 在“**原理与机制**”一章中，我们将深入剖析[AUSM格式](@entry_id:746578)的灵魂——[平流-压力分裂](@entry_id:1120840)思想。您将学习到这种分裂的物理动机、代数构造，以及它如何通过精巧的[马赫数](@entry_id:274014)[分裂函数](@entry_id:161308)设计，从根本上保证了格式在跨声速、[低马赫数](@entry_id:1127478)等关键区域的鲁棒性和准确性。

- 随后的“**应用与跨学科交叉**”章节将视野拓宽至实际应用。我们将探讨[AUSM格式](@entry_id:746578)如何处理复杂的边界条件，如何与高分辨率格式结合，以及如何扩展到粘性流、化学[反应流](@entry_id:190741)乃至相对论天体物理等更广阔的[多物理场](@entry_id:164478)领域，展现其作为一种设计框架的灵活性与普适性。

- 最后，“**动手实践**”部分提供了一系列精心设计的计算问题，旨在引导您亲手推导和验证[AUSM格式](@entry_id:746578)的关键特性，将理论知识转化为解决问题的实践技能。

通过这一系统性的学习路径，本文将带领您一步步揭开AUSM族格式的神秘面纱，领略其作为现代CFD核心工具之一的精妙之处。

## 原理与机制

在本章中，我们将深入探讨平流上游分裂方法（Advection Upstream Splitting Method, AUSM）族格式的核心原理与机制。AUSM 族格式作为一类先进的[通量分裂](@entry_id:637102)方法，在[计算流体动力学](@entry_id:142614)（CFD）领域，特别是在[可压缩流](@entry_id:747589)动的[数值模拟](@entry_id:146043)中，获得了广泛的应用。其成功的关键在于其设计理念紧密结合了流动的物理本质，将复杂的通量[函数分解](@entry_id:197881)为更易于处理且物理意义明确的平流部分与压力部分。本章将从基本分裂思想出发，系统阐述其物理动机、数值构造方法，并进一步探讨其如何确保在各种[复杂流动](@entry_id:747569)条件下的鲁棒性和准确性。

### 基本原理：通量函数的[平流-压力分裂](@entry_id:1120840)

求解[欧拉方程](@entry_id:177914)的[有限体积法](@entry_id:141374)，其核心在于在控制体的交界面上构造数值通量。物理通量本身包含了动量、能量等多种物理效应的复杂耦合。AUSM 族格式的出发点，便是将这种耦合根据其物理来源进行[解耦](@entry_id:160890)。具体而言，[数值通量](@entry_id:145174)被分解为两部分：一部分代表由流体宏观运动引起的**平流输运（Advective Transport）**，另一部分则代表由压力波传播引起的**声学效应（Acoustic Effects）**。

我们首先考察一维[欧拉方程](@entry_id:177914)。其[守恒变量](@entry_id:747720)向量为 $\boldsymbol{U} = [\rho, \rho u, \rho E]^T$，对应的物理通量向量为 $\boldsymbol{F}(\boldsymbol{U}) = [\rho u, \rho u^2+p, u(\rho E+p)]^T$。其中，$\rho$ 是密度，$u$ 是速度，$p$ 是压力，$E$ 是单位质量总能。AUSM 格式将此通量向量 $\boldsymbol{F}(\boldsymbol{U})$ 分裂为一个平流通量 $\boldsymbol{F}^{adv}(\boldsymbol{U})$ 和一个压力通量 $\boldsymbol{F}^{press}(\boldsymbol{U})$ 的和。

一个物理上直观且代数上自洽的分裂方式是利用总焓 $H = E + p/\rho$ 的定义。将 $u(\rho E+p)$ 改写为 $u \rho (E+p/\rho) = u \rho H$，我们可以将物理通量表示为：
$$
\boldsymbol{F}(\boldsymbol{U}) = \begin{bmatrix} \rho u \\ \rho u^2 + p \\ u \rho H \end{bmatrix}
$$
基于此形式，一个自然的[平流-压力分裂](@entry_id:1120840)便显而易见 ：
$$
\boldsymbol{F}(\boldsymbol{U}) = \boldsymbol{F}^{adv}(\boldsymbol{U}) + \boldsymbol{F}^{press}(\boldsymbol{U}) = \underbrace{u \begin{bmatrix} \rho \\ \rho u \\ \rho H \end{bmatrix}}_{\text{平流部分}} + \underbrace{\begin{bmatrix} 0 \\ p \\ 0 \end{bmatrix}}_{\text{压力部分}}
$$
这种分裂方式具有深刻的物理内涵。平流部分 $\boldsymbol{F}^{adv}(\boldsymbol{U})$ 描述了质量、动量和[总焓](@entry_id:197863)这些物理量随着[流体速度](@entry_id:267320) $u$ 的“搭车”[输运过程](@entry_id:177992)。值得注意的是，能量通量中的压力功项 $up$ 被巧妙地包含在了总焓 $H$ 中，并归于平流部分。这反映了一个物理事实：能量的输运与质量的输运紧密相连，通过总焓的形式统一处理，使得能量守恒的数值离散更为简洁和鲁棒。压力部分 $\boldsymbol{F}^{press}(\boldsymbol{U})$ 则代表了纯粹的[机械压力](@entry_id:263227)作用，它仅在[动量方程](@entry_id:197225)中表现为一个力项，而与质量和能量的直接输运无关。

这一思想可以自然地推广到多维空间 。对于一个具有[单位法向量](@entry_id:178851) $\boldsymbol{n}$ 的控制体表面，我们关心的是法向通量。速度向量可以分解为法向分量 $u_n = \boldsymbol{u} \cdot \boldsymbol{n}$ 和切向分量 $\boldsymbol{u}_t$。物理法向通量可以分裂为：
$$
\boldsymbol{F}_n = u_n \begin{bmatrix} \rho \\ \rho \boldsymbol{u} \\ \rho H \end{bmatrix} + \begin{bmatrix} 0 \\ p \boldsymbol{n} \\ 0 \end{bmatrix}
$$
由此可见，质量、动量（包括[法向和切向分量](@entry_id:166204)）和[总焓](@entry_id:197863)均由法向质量通量 $\rho u_n$ 进行平流输运。而压力项 $p \boldsymbol{n}$ 作为一个力，其作用方向严格沿着法向，对切向动量没有贡献。因此，在 AUSM 格式中，切向动量的输运完全由平流通量部分（$\dot{m} \boldsymbol{u}_t$）负责，其中 $\dot{m}$ 是数值质量通量。

### 物理动机：特征波结构

AUSM 的[平流-压力分裂](@entry_id:1120840)思想并非凭空构造，而是源于对[双曲守恒律](@entry_id:147752)方程（如[欧拉方程](@entry_id:177914)）内在物理的深刻洞察，即其信息传播的**特征波结构（Characteristic Wave Structure）**。对一维欧拉方程进行线性化分析，可以得到其通量[雅可比矩阵](@entry_id:178326)的三个特征值，它们代表了信息在流场中传播的速度  ：
1.  $\lambda_1 = u - a$：代表向下游（相对于流体）传播的**声波（Acoustic Wave）**。
2.  $\lambda_2 = u$：代表随流体本身运动的**[接触间断](@entry_id:194702)/熵波（Contact/Entropy Wave）**。
3.  $\lambda_3 = u + a$：代表向上游（相对于流体）传播的**声波**。

其中 $a$ 是当地声速。这三种波携带不同类型的[物理信息](@entry_id:152556)：
- **对流波（$\lambda_2 = u$）**：该波以流体速度 $u$ 传播，携带关于密度（或等效地，熵）和切向动量（在多维情况下）的信息。在物理上，这些量就像是“附着”在流体微团上，被动地随波逐流。因此，与该波相关的物理过程是纯粹的平流或对流。
- **声波（$\lambda_{1,3} = u \pm a$）**：这两列波以相对于流体运动的声速 $a$ 传播，它们是压力 $p$ 和法向速度 $u_n$ 扰动传播的载体。正是通过声波，流场中的一个点才能“感知”到远处压[力场](@entry_id:147325)的变化。

AUSM 格式的设计巧妙地将这种物理图像映射到了[数值通量](@entry_id:145174)的构造上。**平流通量** $\boldsymbol{F}^{adv}$ 的构建旨在模拟对流波（$\lambda_2=u$）的行为，其迎风方向自然应由流体速度 $u$ 的符号决定。**压力通量** $\boldsymbol{F}^{press}$ 则旨在模拟声波（$\lambda_{1,3}=u \pm a$）的行为，其迎风方向和强度必须与声波的传播特性相匹配。这种分离使得格式能够对不同物理现象施加最恰当的数值处理，从而避免了早期[通量矢量分裂](@entry_id:1125145)（FVS）格式中将所有效应都与流速 $u$ 绑定的缺陷。

### 数值通量的构造：[马赫数](@entry_id:274014)的中心角色

从连续的[通量分裂](@entry_id:637102)思想过渡到离散的数值格式，核心任务是在每个单元交界面上，根据界面两侧的左（L）和右（R）两个重构状态，构造一个自洽的数值通量。在这一过程中，**[法向马赫数](@entry_id:191185) $M_n = u_n/a$** 扮演了无可替代的中心角色 。

#### 平流通量与质量通量

平流通量的核心是**数值质量通量** $\dot{m}$ 的构造。$\dot{m}$ 本身就体现了[迎风](@entry_id:756372)思想，它是通过对左右状态的马赫数进行分裂和加权得到的。具体而言，引入马赫数[分裂函数](@entry_id:161308) $M^\pm(M)$，它们将马赫数 $M$ 分解为正向和负向的贡献，并满足 $M^+(M) + M^-(M) = M$。一个典型的数值质量通量形式为 ：
$$
\dot{m} = a_{1/2} \left( M^+_L \rho_L + M^-_R \rho_R \right)
$$
其中 $M_L = u_{n,L}/a_{1/2}$ 和 $M_R = u_{n,R}/a_{1/2}$ 是左右状态的[马赫数](@entry_id:274014)（$a_{1/2}$ 是合适的界面声速），$M_L^+ = M^+(M_L)$，$M^-_R = M^-(M_R)$。这种构造确保了当流动方向明确时（例如超[声速流](@entry_id:267707)动），质量通量能正确地从上游状态取值。

一旦确定了 $\dot{m}$，平流通量的其余部分（如动量和能量）便可构造为 $\dot{m}$ 与一个[迎风](@entry_id:756372)选择的物理量向量 $\boldsymbol{\Psi}$ 的乘积，例如 $\boldsymbol{\Psi} = [1, u_n, H]^T$。向量 $\boldsymbol{\Psi}$ 的取值（来自左状态或右状态）由 $\dot{m}$ 的符号决定。

#### 压力通量与声学特性

与平流通量不同，压力通量的构造必须反映声波的传播特性 。声波的传播方向取决于 $u_n-a$ 和 $u_n+a$ 的符号，这等价于判断 $M_n-1$ 和 $M_n+1$ 的符号。
- **亚声速流动 ($|M_n|  1$)**：此时 $u_n-a  0$ 而 $u_n+a > 0$（假设 $u_n > 0$），意味着声学信息从左右两个方向同时传到界面。因此，界面压力 $p_{1/2}$ 应当是左右状态压力 $p_L$ 和 $p_R$ 的某种加权平均。
- **超声速流动 ($|M_n| \ge 1$)**：此时 $u_n-a$ 和 $u_n+a$ 的符号相同。所有声学信息都来自上游。因此，界面压力 $p_{1/2}$ 必须完全取自上游状态的压力。

为了实现这种随马赫数变化的特性，AUSM 格式引入了依赖于[马赫数](@entry_id:274014)的**压力[分裂函数](@entry_id:161308)** $P^\pm(M)$。数值压力通量构造为：
$$
\boldsymbol{F}^{press} = \begin{bmatrix} 0 \\ p_{1/2} \\ 0 \end{bmatrix}, \quad \text{其中} \quad p_{1/2} = P^+_L p_L + P^-_R p_R
$$
这里的 $P^\pm_L = P^\pm(M_L)$ 和 $P^\pm_R = P^\pm(M_R)$。这些函数被精心设计，以确保在 $|M_n| \ge 1$ 时退化为纯粹的迎风格式，而在 $|M_n|  1$ 时则提供平滑的过渡和适当的[数值耗散](@entry_id:168584) 。这种对压力项的特殊处理，是 AUSM 格式相比于早期 FVS 格式（如 Steger-Warming）的关键改进之一。

### 物理与数值的鲁棒性

AUSM 族格式之所以强大，不仅在于其巧妙的物理分裂思想，更在于其设计中蕴含了对多种数值疑难问题的解决方案。

#### [熵条件](@entry_id:166346)与[声速点](@entry_id:755066)问题

[非线性](@entry_id:637147)[双曲守恒律](@entry_id:147752)允许多个数学上的[弱解](@entry_id:161732)，但只有一个是物理上真实的。**熵条件**是筛选出物理真实解（例如，只允许压缩激波，不允许膨胀激波）的判据。早期的 FVS 格式，如 Steger-Warming，由于采用简单的基于特征值符号的“硬”分裂，在声速点（$\lambda=0$）处的[数值耗散](@entry_id:168584)会完全消失。这种耗散的缺失使得格式无法阻止非物理的膨胀激波的产生 。

AUSM 族格式以及 Van Leer FVS 格式通过使用关于马赫数的光滑多项式或[有理函数](@entry_id:154279)作为[分裂函数](@entry_id:161308)（$M^\pm, P^\pm$），自然地解决了这个问题。这些函数在声速点（$|M_n|=1$）和[驻点](@entry_id:136617)（$M_n=0$）附近是光滑的，确保了[数值耗散](@entry_id:168584)不会突然降为零。这相当于一种内建的“[熵修正](@entry_id:749021)”，保证了格式在跨声速区域的物理真实性。

#### 低马赫数一致性

当使用为可压缩流设计的求解器模拟近乎不可压缩的低速流（$M \to 0$）时，会遇到所谓的**刚性问题**。在[无量纲化](@entry_id:136704)的[动量方程](@entry_id:197225)中，压力梯度项带有 $1/M^2$ 的因子，这使得方程对微小的压力扰动极为敏感 。物理上，在[低马赫数](@entry_id:1127478)极限下，压[力场](@entry_id:147325)趋于空间均匀，其空间涨落的量级应为 $O(M^2)$。如果数值格式不能正确地再现这种[标度关系](@entry_id:273705)，例如产生了 $O(M)$ 或 $O(1)$ 的虚假压力振荡，那么 $1/M^2$ 因子会将其放大为灾难性的 $O(1/M)$ 或 $O(1/M^2)$ 的伪加速度，从而彻底破坏计算结果。

要做到**[低马赫数](@entry_id:1127478)一致性**，数值格式必须保证其引入的虚假压力波动不会超过物理真实的量级。对于 AUSM 格式而言，这意味着施加在压力项上的[数值耗散](@entry_id:168584)必须随着马赫数的减小而减小。具体而言，压力耗散系数必须至少以 $O(M)$ 的速度趋于零。AUSM 格式中的压力[分裂函数](@entry_id:161308) $P^\pm$ 正是为此而设计，当 $M \to 0$ 时，它们使得界面压力 $p_{1/2}$ 趋近于中心平均 $(p_L+p_R)/2$，从而将[数值耗散](@entry_id:168584)降至最低，满足了低马赫数一致性的要求 。

#### 强激波稳定性：Carbuncle 现象与奇偶[解耦](@entry_id:160890)

在模拟强激波，特别是与网格正交的定常[正激波](@entry_id:263382)时，一些经典的[激波捕捉格式](@entry_id:754789)（如 Roe 格式）会表现出一种被称为“Carbuncle”的致命[数值不稳定性](@entry_id:137058)，导致光滑的激波面出现非物理的“脓包”状突起 。其根源在于，在激波后的低速区（$u \approx 0$），与切向动量输运相关的剪切波特征值 $u$ 趋于零，导致 Roe 格式在该特征场上的[数值耗散](@entry_id:168584)消失。这使得沿着激[波阵面](@entry_id:197956)的横向扰动（例如奇偶模态）无法被有效抑制，最终发展为不稳定性。

现代的 AUSM 族格式（如 AUSM$^+$-up）通过引入**基于压力的耗散项**，显著提升了对此类问题的鲁棒性。这些耗散项的尺度不依赖于流速 $u$，而是与当地声速 $a$ 和压力差成正比。在强激波后，虽然速度 $u$ 很小，但温度和压力很高，声速 $a$ 依然是一个较大的值。因此，AUSM 格式的压力耗散机制在关键区域依然活跃，能有效抑制导致 Carbuncle 现象的横向扰动。

与此相关的另一个问题是**奇偶[解耦](@entry_id:160890)（Odd-Even Decoupling）**，即在亚声速区出现压[力场](@entry_id:147325)的棋盘状振荡。其产生机理与 Carbuncle 现象类似，都是由于在某些方向上[数值耗散](@entry_id:168584)不足，导致压[力场](@entry_id:147325)与速度场[解耦](@entry_id:160890)。AUSM 格式通过引入与法向对齐、在亚声速区激活的压力耗散项，有效地在离散层面重新耦合了压力和[动量方程](@entry_id:197225)，从而抑制了这种非物理振荡 。

综上所述，AUSM 族格式通过其基于物理的[平流-压力分裂](@entry_id:1120840)框架，并结合针对性的[数值耗散](@entry_id:168584)机制，不仅在理论上保持了对特征波结构的尊重，还在实践中解决了从跨[声速流](@entry_id:267707)动到低马赫数极限，再到强激波捕捉等一系列挑战性问题，成为了一类高效、鲁棒且应用广泛的现代 CFD 工具。