{
    "hands_on_practices": [
        {
            "introduction": "The power of the Roe solver stems from a remarkable mathematical property: the existence of a specially constructed \"Roe-averaged\" state. This exercise provides a direct, hands-on verification of this cornerstone property, which states that the difference in the physical flux between two states is exactly equal to the Roe-averaged Jacobian matrix multiplied by the difference in the conserved state vectors. By working through this calculation step-by-step, you will solidify your understanding of the theoretical foundation that makes the Roe linearization both exact for contact discontinuities and shocks, and highly accurate for general flows .",
            "id": "3992129",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas, as used in Computational Fluid Dynamics (CFD). Let the conserved variable vector be $U = (\\rho, \\rho u, \\rho E)^{\\mathsf{T}}$, where $\\rho$ is the density, $u$ is the velocity, and $E$ is the total specific energy. The ideal-gas relation is $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$, and the corresponding physical flux is $F(U) = (\\rho u,\\ \\rho u^{2} + p,\\ u(\\rho E + p))^{\\mathsf{T}}$. Define the total specific enthalpy $H = E + \\frac{p}{\\rho}$. For Roe’s linearization, the Roe-averaged velocity and enthalpy are defined by\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_{L}}\\,u_{L} + \\sqrt{\\rho_{R}}\\,u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}}, \n\\quad\n\\tilde{H} = \\frac{\\sqrt{\\rho_{L}}\\,H_{L} + \\sqrt{\\rho_{R}}\\,H_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}},\n$$\nand the Roe-averaged sound speed satisfies $\\tilde{a}^{2} = (\\gamma - 1)\\left(\\tilde{H} - \\tfrac{1}{2}\\tilde{u}^{2}\\right)$.\n\nTake the following left and right states (all quantities are physically consistent and refer to the same ideal gas with ratio of specific heats $\\gamma = \\tfrac{7}{5}$):\n- Left state: $\\rho_{L} = 4$ kg/m$^{3}$, $u_{L} = 2$ m/s, $p_{L} = 10$ Pa.\n- Right state: $\\rho_{R} = 9$ kg/m$^{3}$, $u_{R} = 1$ m/s, $p_{R} = 20$ Pa.\n\nCompute $U_{L}$ and $U_{R}$ using $E = \\tfrac{p}{(\\gamma-1)\\rho} + \\tfrac{1}{2}u^{2}$, then compute $F(U_{L})$ and $F(U_{R})$. Using the Roe averages above, form the $3\\times 3$ flux Jacobian $A(\\tilde{U}) = \\frac{\\partial F}{\\partial U}\\big|_{\\tilde{U}}$ evaluated at the Roe-averaged state $\\tilde{U}$ (expressed in terms of $(\\tilde{u}, \\tilde{H}, \\gamma)$). Finally, evaluate the residual vector\n$$\nR \\equiv A(\\tilde{U})\\,(U_{R} - U_{L}) - \\big(F(U_{R}) - F(U_{L})\\big).\n$$\n\nCompute $R$ exactly and provide its three components as a single row vector. No rounding is required. Do not include units in your final numeric answer.",
            "solution": "The user wants to compute the residual vector $R \\equiv A(\\tilde{U})\\,(U_{R} - U_{L}) - \\big(F(U_{R}) - F(U_{L})\\big)$ for a specific set of left and right states in the context of the 1D Euler equations. The core of this problem is to verify that the Roe-averaged matrix satisfies the property $A(\\tilde{U})\\Delta U = \\Delta F$, which is a fundamental requirement for Roe's approximate Riemann solver. This implies that the residual vector $R$ should be the zero vector. We will perform the explicit calculation to verify this.\n\nThe ratio of specific heats is given as $\\gamma = \\frac{7}{5}$. Therefore, $\\gamma-1 = \\frac{2}{5}$.\n\n**Step 1: Compute State Vectors $U_{L}$ and $U_{R}$**\n\nThe total specific energy $E$ is given by $E = \\frac{p}{(\\gamma-1)\\rho} + \\frac{1}{2}u^{2}$.\n\nFor the left state $(L)$:\n$\\rho_{L} = 4$, $u_{L} = 2$, $p_{L} = 10$.\nThe total specific energy $E_{L}$ is:\n$$E_{L} = \\frac{p_{L}}{(\\gamma-1)\\rho_{L}} + \\frac{1}{2}u_{L}^{2} = \\frac{10}{(\\frac{2}{5})(4)} + \\frac{1}{2}(2)^{2} = \\frac{10}{\\frac{8}{5}} + \\frac{4}{2} = \\frac{50}{8} + 2 = \\frac{25}{4} + 2 = \\frac{33}{4}$$\nThe conserved variable vector $U_{L}$ is:\n$$U_{L} = \\begin{pmatrix} \\rho_{L} \\\\ \\rho_{L} u_{L} \\\\ \\rho_{L} E_{L} \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 4(2) \\\\ 4(\\frac{33}{4}) \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 8 \\\\ 33 \\end{pmatrix}$$\n\nFor the right state $(R)$:\n$\\rho_{R} = 9$, $u_{R} = 1$, $p_{R} = 20$.\nThe total specific energy $E_{R}$ is:\n$$E_{R} = \\frac{p_{R}}{(\\gamma-1)\\rho_{R}} + \\frac{1}{2}u_{R}^{2} = \\frac{20}{(\\frac{2}{5})(9)} + \\frac{1}{2}(1)^{2} = \\frac{20}{\\frac{18}{5}} + \\frac{1}{2} = \\frac{100}{18} + \\frac{1}{2} = \\frac{50}{9} + \\frac{1}{2} = \\frac{100+9}{18} = \\frac{109}{18}$$\nThe conserved variable vector $U_{R}$ is:\n$$U_{R} = \\begin{pmatrix} \\rho_{R} \\\\ \\rho_{R} u_{R} \\\\ \\rho_{R} E_{R} \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 9(1) \\\\ 9(\\frac{109}{18}) \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 9 \\\\ \\frac{109}{2} \\end{pmatrix}$$\n\n**Step 2: Compute Flux Vectors $F(U_{L})$ and $F(U_{R})$**\n\nThe flux vector $F(U)$ is given by $F(U) = (\\rho u, \\rho u^{2}+p, u(\\rho E + p))^{\\mathsf{T}}$.\n\nFor the left state $(L)$:\n$$F(U_{L}) = \\begin{pmatrix} \\rho_{L} u_{L} \\\\ \\rho_{L} u_{L}^{2} + p_{L} \\\\ u_{L}(\\rho_{L} E_{L} + p_{L}) \\end{pmatrix} = \\begin{pmatrix} 4(2) \\\\ 4(2)^{2} + 10 \\\\ 2(33 + 10) \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 16 + 10 \\\\ 2(43) \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 26 \\\\ 86 \\end{pmatrix}$$\n\nFor the right state $(R)$:\n$$F(U_{R}) = \\begin{pmatrix} \\rho_{R} u_{R} \\\\ \\rho_{R} u_{R}^{2} + p_{R} \\\\ u_{R}(\\rho_{R} E_{R} + p_{R}) \\end{pmatrix} = \\begin{pmatrix} 9(1) \\\\ 9(1)^{2} + 20 \\\\ 1(\\frac{109}{2} + 20) \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 9 + 20 \\\\ \\frac{109+40}{2} \\end{pmatrix} = \\begin{pmatrix} 9 \\\\ 29 \\\\ \\frac{149}{2} \\end{pmatrix}$$\n\n**Step 3: Compute Differences $\\Delta U$ and $\\Delta F$**\n\n$$\\Delta U = U_{R} - U_{L} = \\begin{pmatrix} 9 - 4 \\\\ 9 - 8 \\\\ \\frac{109}{2} - 33 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 1 \\\\ \\frac{109 - 66}{2} \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 1 \\\\ \\frac{43}{2} \\end{pmatrix}$$\n$$\\Delta F = F(U_{R}) - F(U_{L}) = \\begin{pmatrix} 9 - 8 \\\\ 29 - 26 \\\\ \\frac{149}{2} - 86 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 3 \\\\ \\frac{149 - 172}{2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 3 \\\\ -\\frac{23}{2} \\end{pmatrix}$$\n\n**Step 4: Compute Roe Averages $\\tilde{u}$ and $\\tilde{H}$**\n\nFirst, compute specific enthalpies $H_{L}$ and $H_{R}$ using $H = E + \\frac{p}{\\rho}$.\n$$H_{L} = E_{L} + \\frac{p_{L}}{\\rho_{L}} = \\frac{33}{4} + \\frac{10}{4} = \\frac{43}{4}$$\n$$H_{R} = E_{R} + \\frac{p_{R}}{\\rho_{R}} = \\frac{109}{18} + \\frac{20}{9} = \\frac{109 + 40}{18} = \\frac{149}{18}$$\nNow, compute the Roe averages. We have $\\sqrt{\\rho_{L}} = \\sqrt{4} = 2$ and $\\sqrt{\\rho_{R}} = \\sqrt{9} = 3$.\n$$\\tilde{u} = \\frac{\\sqrt{\\rho_{L}}\\,u_{L} + \\sqrt{\\rho_{R}}\\,u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{2(2) + 3(1)}{2+3} = \\frac{4+3}{5} = \\frac{7}{5}$$\n$$\\tilde{H} = \\frac{\\sqrt{\\rho_{L}}\\,H_{L} + \\sqrt{\\rho_{R}}\\,H_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{2(\\frac{43}{4}) + 3(\\frac{149}{18})}{5} = \\frac{\\frac{43}{2} + \\frac{149}{6}}{5} = \\frac{\\frac{3(43)+149}{6}}{5} = \\frac{129+149}{30} = \\frac{278}{30} = \\frac{139}{15}$$\n\n**Step 5: Form the Roe Matrix $A(\\tilde{U})$**\n\nThe flux Jacobian matrix $A(U) = \\frac{\\partial F}{\\partial U}$ evaluated at a state with velocity $u$ and specific enthalpy $H$ is:\n$$A(u, H) = \\begin{pmatrix} 0 & 1 & 0 \\\\ \\frac{\\gamma-3}{2}u^2 & (3-\\gamma)u & \\gamma-1 \\\\ u\\left(\\frac{\\gamma-1}{2}u^2-H\\right) & H - (\\gamma-1)u^2 & \\gamma u \\end{pmatrix}$$\nWe evaluate this matrix at the Roe-averaged state $(\\tilde{u}, \\tilde{H})$. We have $\\gamma=\\frac{7}{5}$, so $\\gamma-1=\\frac{2}{5}$, $3-\\gamma=\\frac{8}{5}$, and $\\frac{\\gamma-3}{2}=-\\frac{4}{5}$.\nLet's compute the components of $A(\\tilde{U}) = A(\\tilde{u}, \\tilde{H})$:\n$A_{11} = 0$, $A_{12} = 1$, $A_{13} = 0$.\n$A_{21} = \\frac{\\gamma-3}{2}\\tilde{u}^{2} = -\\frac{4}{5}\\left(\\frac{7}{5}\\right)^{2} = -\\frac{4}{5}\\left(\\frac{49}{25}\\right) = -\\frac{196}{125}$.\n$A_{22} = (3-\\gamma)\\tilde{u} = \\frac{8}{5}\\left(\\frac{7}{5}\\right) = \\frac{56}{25}$.\n$A_{23} = \\gamma-1 = \\frac{2}{5}$.\n$A_{31} = \\tilde{u}\\left(\\frac{\\gamma-1}{2}\\tilde{u}^{2}-\\tilde{H}\\right) = \\frac{7}{5}\\left(\\frac{1}{2}\\left(\\frac{2}{5}\\right)\\left(\\frac{7}{5}\\right)^{2} - \\frac{139}{15}\\right) = \\frac{7}{5}\\left(\\frac{49}{125} - \\frac{139}{15}\\right) = \\frac{7}{5}\\left(\\frac{49 \\cdot 3 - 139 \\cdot 25}{375}\\right) = \\frac{7}{5}\\left(\\frac{147 - 3475}{375}\\right) = \\frac{7}{5}\\left(\\frac{-3328}{375}\\right) = -\\frac{23296}{1875}$.\n$A_{32} = \\tilde{H} - (\\gamma-1)\\tilde{u}^{2} = \\frac{139}{15} - \\frac{2}{5}\\left(\\frac{7}{5}\\right)^{2} = \\frac{139}{15} - \\frac{98}{125} = \\frac{139 \\cdot 25 - 98 \\cdot 3}{375} = \\frac{3475-294}{375} = \\frac{3181}{375}$.\n$A_{33} = \\gamma \\tilde{u} = \\frac{7}{5}\\left(\\frac{7}{5}\\right) = \\frac{49}{25}$.\n\nSo, the Roe matrix is:\n$$A(\\tilde{U}) = \\begin{pmatrix} 0 & 1 & 0 \\\\ -\\frac{196}{125} & \\frac{56}{25} & \\frac{2}{5} \\\\ -\\frac{23296}{1875} & \\frac{3181}{375} & \\frac{49}{25} \\end{pmatrix}$$\n\n**Step 6: Compute the Residual Vector $R$**\n\nWe compute the product $A(\\tilde{U})\\Delta U$ component by component.\nFirst component:\n$$(A(\\tilde{U})\\Delta U)_1 = (0)(5) + (1)(1) + (0)\\left(\\frac{43}{2}\\right) = 1$$\nSecond component:\n$$(A(\\tilde{U})\\Delta U)_2 = \\left(-\\frac{196}{125}\\right)(5) + \\left(\\frac{56}{25}\\right)(1) + \\left(\\frac{2}{5}\\right)\\left(\\frac{43}{2}\\right) = -\\frac{196}{25} + \\frac{56}{25} + \\frac{43}{5} = \\frac{-196+56}{25} + \\frac{215}{25} = \\frac{-140+215}{25} = \\frac{75}{25} = 3$$\nThird component:\n$$(A(\\tilde{U})\\Delta U)_3 = \\left(-\\frac{23296}{1875}\\right)(5) + \\left(\\frac{3181}{375}\\right)(1) + \\left(\\frac{49}{25}\\right)\\left(\\frac{43}{2}\\right) = -\\frac{23296}{375} + \\frac{3181}{375} + \\frac{2107}{50} = \\frac{-20115}{375} + \\frac{2107}{50}$$\nTo simplify the first term, we divide the numerator and denominator by common factors. $375 = 3 \\cdot 5^3 = 3 \\cdot 125$. $20115$ is divisible by $3$ and $5$. $20115/15 = 1341$ and $375/15=25$. So, $-\\frac{20115}{375} = -\\frac{1341}{25}$.\n$$(A(\\tilde{U})\\Delta U)_3 = -\\frac{1341}{25} + \\frac{2107}{50} = -\\frac{2682}{50} + \\frac{2107}{50} = \\frac{-575}{50} = -\\frac{115}{10} = -\\frac{23}{2}$$\nSo, we have:\n$$A(\\tilde{U})\\Delta U = \\begin{pmatrix} 1 \\\\ 3 \\\\ -\\frac{23}{2} \\end{pmatrix}$$\nNow we compute the residual vector $R$:\n$$R = A(\\tilde{U})\\Delta U - \\Delta F = \\begin{pmatrix} 1 \\\\ 3 \\\\ -\\frac{23}{2} \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 3 \\\\ -\\frac{23}{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\nThe calculation confirms that for the given states, the Roe matrix satisfies the required property, and the residual is the zero vector.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While powerful, the Roe solver is not without its pitfalls; in certain \"transonic\" cases where a characteristic speed passes through zero, the scheme can fail to introduce necessary dissipation, leading to non-physical solutions like expansion shocks. This practice demonstrates how to identify this critical failure mode by examining the Roe eigenvalues for a transonic rarefaction case . You will then implement a standard \"entropy fix,\" such as the one proposed by Harten, to modify the eigenvalues and restore the correct physical behavior and numerical stability of the solver.",
            "id": "3992160",
            "problem": "Consider the one-dimensional compressible Euler equations in the streamwise direction for an ideal gas, posed as a Riemann problem in Computational Fluid Dynamics (CFD). The gas has constant specific heat ratio $\\gamma = 1.4$. The left and right states are\n$\\rho_{L} = 1.0 \\,\\mathrm{kg/m^3}$, $u_{L} = 400 \\,\\mathrm{m/s}$, $p_{L} = \\dfrac{290000}{7} \\,\\mathrm{Pa}$, and\n$\\rho_{R} = 1.0 \\,\\mathrm{kg/m^3}$, $u_{R} = 100 \\,\\mathrm{m/s}$, $p_{R} = \\dfrac{290000}{7} \\,\\mathrm{Pa}$.\nAssume the ideal-gas relation, and use the standard Roe’s approximate Riemann solver linearization based on Roe averages. Treat this case as a transonic rarefaction across a sonic point in the Roe linearization.\n\nStarting from the definitions of the one-dimensional Euler equations, the ideal-gas enthalpy, and the Roe-averaged state, carry out the following steps:\n- Derive the Roe-averaged velocity $\\tilde{u}$ and Roe-averaged total specific enthalpy $\\tilde{H}$ from the given left and right states.\n- From these, derive the Roe-averaged speed of sound $\\tilde{a}$.\n- Using the Roe-averaged state, derive the three Roe eigenvalues of the flux Jacobian in the streamwise direction before any entropy correction.\n- Apply Harten’s entropy fix with threshold parameter $\\varepsilon = 120 \\,\\mathrm{m/s}$ to obtain the corrected absolute eigenvalues $|\\lambda_{k}|_{\\varepsilon}$, where for each characteristic speed $\\lambda$ the correction is defined by \n$|\\lambda|_{\\varepsilon} = \\dfrac{1}{2}\\!\\left(\\dfrac{\\lambda^{2}}{\\varepsilon} + \\varepsilon\\right)$ if $|\\lambda| < \\varepsilon$, and $|\\lambda|_{\\varepsilon} = |\\lambda|$ otherwise.\n- Evaluate the corrected total characteristic dissipation weight defined as $\\sum_{k=1}^{3} |\\lambda_{k}|_{\\varepsilon}$.\n\nProvide the final answer as a single row matrix containing, in order,\n$\\lambda_{1}$, $\\lambda_{2}$, $\\lambda_{3}$, $|\\lambda_{1}|_{\\varepsilon}$, $|\\lambda_{2}|_{\\varepsilon}$, $|\\lambda_{3}|_{\\varepsilon}$, and $\\sum_{k=1}^{3} |\\lambda_{k}|_{\\varepsilon}$.\nExpress all speed-like quantities in $\\mathrm{m/s}$. Use exact values; no rounding is required.",
            "solution": "The problem requires the analysis of a specific one-dimensional Riemann problem for the compressible Euler equations using Roe's approximate Riemann solver. The gas is ideal with a constant specific heat ratio $\\gamma = 1.4$.\n\nThe fundamental quantities for an ideal gas are the total specific enthalpy, $H$, and the speed of sound, $a$. The total specific enthalpy is defined as $H = E + \\frac{p}{\\rho}$, where $E = e + \\frac{1}{2}u^2$ is the total specific energy, $e$ is the specific internal energy, $p$ is the pressure, $\\rho$ is the density, and $u$ is the velocity. For an ideal gas, $e = \\frac{p}{\\rho(\\gamma-1)}$, so the enthalpy can be expressed as $H = \\frac{\\gamma p}{\\rho(\\gamma-1)} + \\frac{1}{2}u^2$. The speed of sound is given by $a^2 = \\frac{\\gamma p}{\\rho}$. Using this, the enthalpy can also be written as $H = \\frac{a^2}{\\gamma-1} + \\frac{1}{2}u^2$.\n\nThe given left ($L$) and right ($R$) states are:\n$\\rho_{L} = 1.0 \\,\\mathrm{kg/m^3}$, $u_{L} = 400 \\,\\mathrm{m/s}$, $p_{L} = \\frac{290000}{7} \\,\\mathrm{Pa}$.\n$\\rho_{R} = 1.0 \\,\\mathrm{kg/m^3}$, $u_{R} = 100 \\,\\mathrm{m/s}$, $p_{R} = \\frac{290000}{7} \\,\\mathrm{Pa}$.\nThe specific heat ratio is $\\gamma = 1.4 = \\frac{7}{5}$.\n\nFirst, we derive the Roe-averaged state variables. The Roe-averaged velocity, $\\tilde{u}$, is given by the formula:\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_L} u_L + \\sqrt{\\rho_R} u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\nSubstituting the given values:\n$$\n\\tilde{u} = \\frac{\\sqrt{1.0} \\cdot 400 + \\sqrt{1.0} \\cdot 100}{\\sqrt{1.0} + \\sqrt{1.0}} = \\frac{400 + 100}{2} = 250 \\,\\mathrm{m/s}\n$$\nThe Roe-averaged total specific enthalpy, $\\tilde{H}$, is given by:\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_L} H_L + \\sqrt{\\rho_R} H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}\n$$\nTo calculate $\\tilde{H}$, we first need to determine the total specific enthalpies $H_L$ and $H_R$. We start by calculating the speed of sound squared for each state. Since $p_L=p_R$ and $\\rho_L=\\rho_R$, we have $a_L=a_R$.\n$$\na_L^2 = a_R^2 = \\frac{\\gamma p_L}{\\rho_L} = \\frac{1.4 \\cdot \\frac{290000}{7}}{1.0} = \\frac{\\frac{7}{5} \\cdot \\frac{290000}{7}}{1} = \\frac{290000}{5} = 58000 \\,(\\mathrm{m/s})^2\n$$\nNow we compute $H_L$ and $H_R$ using $\\gamma-1 = 1.4 - 1 = 0.4 = \\frac{2}{5}$:\n$$\nH_L = \\frac{a_L^2}{\\gamma-1} + \\frac{1}{2}u_L^2 = \\frac{58000}{0.4} + \\frac{1}{2}(400)^2 = 145000 + \\frac{160000}{2} = 145000 + 80000 = 225000 \\,\\mathrm{J/kg}\n$$\n$$\nH_R = \\frac{a_R^2}{\\gamma-1} + \\frac{1}{2}u_R^2 = \\frac{58000}{0.4} + \\frac{1}{2}(100)^2 = 145000 + \\frac{10000}{2} = 145000 + 5000 = 150000 \\,\\mathrm{J/kg}\n$$\nWith $H_L$ and $H_R$, we can compute $\\tilde{H}$:\n$$\n\\tilde{H} = \\frac{\\sqrt{1.0} \\cdot 225000 + \\sqrt{1.0} \\cdot 150000}{\\sqrt{1.0} + \\sqrt{1.0}} = \\frac{225000 + 150000}{2} = \\frac{375000}{2} = 187500 \\,\\mathrm{J/kg}\n$$\nNext, we derive the Roe-averaged speed of sound, $\\tilde{a}$, from $\\tilde{u}$ and $\\tilde{H}$:\n$$\n\\tilde{a}^2 = (\\gamma-1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right)\n$$\nSubstituting the calculated values:\n$$\n\\tilde{a}^2 = (0.4)\\left(187500 - \\frac{1}{2}(250)^2\\right) = \\frac{2}{5}\\left(187500 - \\frac{62500}{2}\\right) = \\frac{2}{5}(187500 - 31250) = \\frac{2}{5}(156250) = 62500 \\,(\\mathrm{m/s})^2\n$$\n$$\n\\tilde{a} = \\sqrt{62500} = 250 \\,\\mathrm{m/s}\n$$\nThe eigenvalues of the Roe flux Jacobian matrix, $\\tilde{A}$, are given by $\\lambda_1 = \\tilde{u} - \\tilde{a}$, $\\lambda_2 = \\tilde{u}$, and $\\lambda_3 = \\tilde{u} + \\tilde{a}$.\n$$\n\\lambda_1 = 250 - 250 = 0 \\,\\mathrm{m/s}\n$$\n$$\n\\lambda_2 = 250 \\,\\mathrm{m/s}\n$$\n$$\n\\lambda_3 = 250 + 250 = 500 \\,\\mathrm{m/s}\n$$\nThe problem specifies that this is a case of a transonic rarefaction, which is confirmed by $\\lambda_1 = 0$. This vanishing eigenvalue requires an entropy correction to prevent non-physical solutions. We apply Harten's entropy fix with a threshold $\\varepsilon = 120 \\,\\mathrm{m/s}$. The rule for the corrected absolute eigenvalue $|\\lambda|_\\varepsilon$ is:\n$$\n|\\lambda|_{\\varepsilon} =\n\\begin{cases}\n\\frac{1}{2}\\left(\\frac{\\lambda^2}{\\varepsilon} + \\varepsilon\\right) & \\text{if } |\\lambda| < \\varepsilon \\\\\n|\\lambda| & \\text{if } |\\lambda| \\ge \\varepsilon\n\\end{cases}\n$$\nWe apply this correction to each eigenvalue:\nFor $\\lambda_1 = 0$:\n$|\\lambda_1| = 0$, which is less than $\\varepsilon = 120$.\n$$\n|\\lambda_1|_{\\varepsilon} = \\frac{1}{2}\\left(\\frac{0^2}{120} + 120\\right) = \\frac{1}{2}(120) = 60 \\,\\mathrm{m/s}\n$$\nFor $\\lambda_2 = 250$:\n$|\\lambda_2| = 250$, which is greater than $\\varepsilon = 120$.\n$$\n|\\lambda_2|_{\\varepsilon} = |\\lambda_2| = 250 \\,\\mathrm{m/s}\n$$\nFor $\\lambda_3 = 500$:\n$|\\lambda_3| = 500$, which is greater than $\\varepsilon = 120$.\n$$\n|\\lambda_3|_{\\varepsilon} = |\\lambda_3| = 500 \\,\\mathrm{m/s}\n$$\nFinally, we compute the corrected total characteristic dissipation weight, which is the sum of the corrected absolute eigenvalues:\n$$\n\\sum_{k=1}^{3} |\\lambda_{k}|_{\\varepsilon} = |\\lambda_{1}|_{\\varepsilon} + |\\lambda_{2}|_{\\varepsilon} + |\\lambda_{3}|_{\\varepsilon} = 60 + 250 + 500 = 810 \\,\\mathrm{m/s}\n$$\nThe required quantities are:\n$\\lambda_1 = 0 \\,\\mathrm{m/s}$\n$\\lambda_2 = 250 \\,\\mathrm{m/s}$\n$\\lambda_3 = 500 \\,\\mathrm{m/s}$\n$|\\lambda_1|_{\\varepsilon} = 60 \\,\\mathrm{m/s}$\n$|\\lambda_2|_{\\varepsilon} = 250 \\,\\mathrm{m/s}$\n$|\\lambda_3|_{\\varepsilon} = 500 \\,\\mathrm{m/s}$\n$\\sum_{k=1}^{3} |\\lambda_k|_{\\varepsilon} = 810 \\,\\mathrm{m/s}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 250 & 500 & 60 & 250 & 500 & 810 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A common practice in multi-dimensional CFD is to extend one-dimensional Riemann solvers to higher dimensions by applying them directionally at each cell face. This exercise uses the principles of modified equation analysis to reveal a key consequence of this approach: the introduction of grid-aligned numerical diffusion . By deriving and calculating the effective diffusion coefficients both normal and tangential to an oblique contact discontinuity, you will gain a quantitative understanding of how this numerical artifact can smear sharp features in a non-physical, anisotropic manner, which is a critical consideration for accurately capturing complex flow structures.",
            "id": "3992180",
            "problem": "Consider the two-dimensional compressible Euler equations for inviscid flow, written in conservation form for the conserved state $\\,\\mathbf{U} = (\\rho, \\rho u, \\rho v, \\rho E)\\,$ with spatial coordinates $(x,y)$ and time $t$. Let $\\,\\rho\\,$ denote fluid density, $\\,(u,v)\\,$ the velocity components, and $\\,E\\,$ the specific total energy. Across a contact discontinuity, assume equal pressure and equal velocity on both sides, with only a jump in density. In the exact continuous equations, the contact is linearly degenerate and is simply advected by the uniform velocity vector $\\,\\mathbf{V} = (u,v)\\,$ without change of shape. Consider a finite-volume discretization on a Cartesian mesh of uniform spacings $\\,\\Delta x\\,$ and $\\,\\Delta y\\,$, and let the numerical flux at a face be computed using Roe’s approximate Riemann solver with one-dimensional linearization in the face-normal direction.\n\nIn this context, the semi-discrete, first-order scheme can be analyzed by a modified-equation approach. For a contact discontinuity advected by a uniform velocity $\\,\\mathbf{V} = (u,v)\\,$ with zero physical viscosity, Roe’s one-dimensional linearization applied separately on each face direction induces anisotropic numerical diffusion that acts like an artificial diffusion tensor aligned with the grid axes. This anisotropy can smear the contact both in the direction normal to the contact and in the direction transverse to it, depending on the obliqueness of the contact with respect to the grid.\n\nDesign a test problem consisting of a planar oblique contact in two dimensions whose unit normal is $\\,\\mathbf{n} = (\\cos\\phi,\\sin\\phi)\\,$, where the angle $\\,\\phi\\,$ is measured in radians from the positive $x$-axis to the contact normal. Assume the flow velocity $\\,\\mathbf{V} = (u,v)\\,$ is uniform. Using a principle-based derivation from the conservation laws and properties of Roe’s solver for the contact wave, compute two quantitative measures of numerical smearing produced by the one-dimensional Roe linearization:\n\n1. The effective diffusion coefficient $\\,\\kappa_n\\,$ in $\\,\\mathrm{m^2/s}\\,$ acting along the contact-normal direction $\\,\\mathbf{n}\\,$.\n2. The effective diffusion coefficient $\\,\\kappa_t\\,$ in $\\,\\mathrm{m^2/s}\\,$ acting along the contact-transverse (tangential) direction $\\,\\mathbf{t} = (-\\sin\\phi,\\cos\\phi)\\,$.\n\nEnsure that your expressions combine the per-face contributions induced by the Roe flux linearized in the face-normal directions and properly project the resulting anisotropic diffusion onto the contact-aligned basis $\\{\\mathbf{n},\\mathbf{t}\\}$.\n\nYour program must evaluate these quantities for the following test suite of parameter sets and produce the final results:\n\n- Test case 1 (happy path, oblique contact with purely streamwise advection): $\\,u = 200\\,\\mathrm{m/s}\\,$, $\\,v = 0\\,\\mathrm{m/s}\\,$, $\\,\\Delta x = 0.01\\,\\mathrm{m}\\,$, $\\,\\Delta y = 0.01\\,\\mathrm{m}\\,$, $\\,\\phi = \\pi/4\\,\\mathrm{rad}\\,$.\n- Test case 2 (isotropic advection and grid): $\\,u = 200\\,\\mathrm{m/s}\\,$, $\\,v = 200\\,\\mathrm{m/s}\\,$, $\\,\\Delta x = 0.01\\,\\mathrm{m}\\,$, $\\,\\Delta y = 0.01\\,\\mathrm{m}\\,$, $\\,\\phi = \\pi/4\\,\\mathrm{rad}\\,$.\n- Test case 3 (anisotropic grid and unequal velocity components): $\\,u = 200\\,\\mathrm{m/s}\\,$, $\\,v = 50\\,\\mathrm{m/s}\\,$, $\\,\\Delta x = 0.01\\,\\mathrm{m}\\,$, $\\,\\Delta y = 0.02\\,\\mathrm{m}\\,$, $\\,\\phi = \\pi/3\\,\\mathrm{rad}\\,$.\n- Test case 4 (boundary case with zero advection): $\\,u = 0\\,\\mathrm{m/s}\\,$, $\\,v = 0\\,\\mathrm{m/s}\\,$, $\\,\\Delta x = 0.01\\,\\mathrm{m}\\,$, $\\,\\Delta y = 0.01\\,\\mathrm{m}\\,$, $\\,\\phi = 1.0\\,\\mathrm{rad}\\,$.\n- Test case 5 (mixed-sign velocity components and anisotropic grid): $\\,u = -150\\,\\mathrm{m/s}\\,$, $\\,v = 100\\,\\mathrm{m/s}\\,$, $\\,\\Delta x = 0.02\\,\\mathrm{m}\\,$, $\\,\\Delta y = 0.01\\,\\mathrm{m}\\,$, $\\,\\phi = 0.7\\,\\mathrm{rad}\\,$.\n\nAll angles are in radians. Express all diffusion coefficients in $\\,\\mathrm{m^2/s}\\,$. Your program should produce a single line of output containing a comma-separated list of five entries, one for each test case. Each entry must be a two-element list $[\\kappa_n,\\kappa_t]$ using floating-point numbers. Thus, the output format must be a single line of the form\n\"[[\\kappa_{n,1},\\kappa_{t,1}],[\\kappa_{n,2},\\kappa_{t,2}],[\\kappa_{n,3},\\kappa_{t,3}],[\\kappa_{n,4},\\kappa_{t,4}],[\\kappa_{n,5},\\kappa_{t,5}]]\",\nwith all values expressed in $\\,\\mathrm{m^2/s}\\,$. For numerical presentation, round each floating-point number to six decimal places.",
            "solution": "The problem requires the derivation and computation of effective numerical diffusion coefficients, $\\kappa_n$ and $\\kappa_t$, for a planar contact discontinuity advected in a uniform flow field. The numerical method is a first-order finite-volume scheme on a 2D Cartesian grid using Roe's approximate Riemann solver for the flux calculations. The derivation proceeds via a modified equation analysis.\n\nA key property of a contact discontinuity in the Euler equations is that pressure $p$ and the velocity vector $\\mathbf{V} = (u,v)$ are constant across it, while density $\\rho$ and specific total energy $E$ exhibit a jump. Since the velocity is uniform, the advection of density is governed by the linear advection equation:\n$$\n\\frac{\\partial \\rho}{\\partial t} + u \\frac{\\partial \\rho}{\\partial x} + v \\frac{\\partial \\rho}{\\partial y} = 0\n$$\nWe analyze the numerical diffusion introduced by the scheme when solving this equation.\n\nThe semi-discrete finite-volume scheme for an arbitrary conserved quantity $\\psi$ on a Cartesian grid with cell spacings $\\Delta x$ and $\\Delta y$ is:\n$$\n\\frac{d\\psi_{ij}}{dt} + \\frac{F_{i+1/2, j} - F_{i-1/2, j}}{\\Delta x} + \\frac{G_{i, j+1/2} - G_{i, j-1/2}}{\\Delta y} = 0\n$$\nwhere $F$ and $G$ are the numerical fluxes in the $x$ and $y$ directions, respectively.\n\nFor a first-order scheme, the Roe solver's numerical flux at a face (e.g., $i+1/2, j$ in the $x$-direction) is given by:\n$$\n\\mathbf{F}_{i+1/2, j} = \\frac{1}{2} [\\mathbf{f}(\\mathbf{U}_L) + \\mathbf{f}(\\mathbf{U}_R)] - \\frac{1}{2} |\\tilde{A}_x| (\\mathbf{U}_R - \\mathbf{U}_L)\n$$\nwhere $\\mathbf{U}_L = \\mathbf{U}_{ij}$ and $\\mathbf{U}_R = \\mathbf{U}_{i+1,j}$ are the states on the left and right of the face, $\\mathbf{f}$ is the physical flux vector, and $|\\tilde{A}_x|$ is the dissipation matrix from the Roe-averaged Jacobian for the $x$-direction. For a pure contact discontinuity, the jump $\\mathbf{U}_R - \\mathbf{U}_L$ aligns with the eigenvector corresponding to the eigenvalue $\\lambda = u_n$, where $u_n$ is the flow velocity normal to the face. The action of the Roe dissipation matrix on this specific jump vector simplifies to multiplication by $|\\lambda| = |u_n|$.\n\nFor the mass conservation equation, the physical fluxes are $f_\\rho = \\rho u$ and $g_\\rho = \\rho v$.\nAt an $x$-face, the normal velocity is $u$, so the dissipation is proportional to $|u|$. The numerical flux for density is effectively that of a scalar advection scheme:\n$$\nF_{i+1/2, j} = \\frac{1}{2} ((\\rho u)_L + (\\rho u)_R) - \\frac{1}{2} |u| (\\rho_R - \\rho_L)\n$$\nExpanding the flux difference in a Taylor series gives the leading-order behavior of the scheme. The spatial discretization becomes:\n$$\n\\frac{F_{i+1/2, j} - F_{i-1/2, j}}{\\Delta x} \\rightarrow \\frac{\\partial (\\rho u)}{\\partial x} - \\frac{\\Delta x}{2} \\frac{\\partial}{\\partial x} \\left( |u| \\frac{\\partial \\rho}{\\partial x} \\right)\n$$\nSince $u$ is constant, this simplifies to $u \\frac{\\partial \\rho}{\\partial x} - \\frac{|u| \\Delta x}{2} \\frac{\\partial^2 \\rho}{\\partial x^2}$.\nA similar analysis applies to the $y$-direction, where the normal velocity is $v$, leading to a term $v \\frac{\\partial \\rho}{\\partial y} - \\frac{|v| \\Delta y}{2} \\frac{\\partial^2 \\rho}{\\partial y^2}$.\n\nCombining these results, the modified partial differential equation that describes the leading-order behavior of the numerical scheme for the density field is:\n$$\n\\frac{\\partial \\rho}{\\partial t} + u \\frac{\\partial \\rho}{\\partial x} + v \\frac{\\partial \\rho}{\\partial y} = \\frac{|u| \\Delta x}{2} \\frac{\\partial^2 \\rho}{\\partial x^2} + \\frac{|v| \\Delta y}{2} \\frac{\\partial^2 \\rho}{\\partial y^2}\n$$\nThis is an advection-diffusion equation. The right-hand side represents the numerical diffusion. This diffusion is anisotropic and aligned with the grid axes. The grid-aligned numerical diffusion tensor, $\\mathbf{K}$, is:\n$$\n\\mathbf{K} = \\begin{pmatrix} \\kappa_{xx} & 0 \\\\ 0 & \\kappa_{yy} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} |u| \\Delta x & 0 \\\\ 0 & \\frac{1}{2} |v| \\Delta y \\end{pmatrix}\n$$\n\nThe problem requires the diffusion coefficients in a coordinate system aligned with the contact discontinuity. This basis is defined by the unit normal vector $\\mathbf{n}$ and the unit tangential vector $\\mathbf{t}$:\n$$\n\\mathbf{n} = \\begin{pmatrix} \\cos\\phi \\\\ \\sin\\phi \\end{pmatrix}, \\quad \\mathbf{t} = \\begin{pmatrix} -\\sin\\phi \\\\ \\cos\\phi \\end{pmatrix}\n$$\nwhere $\\phi$ is the angle of the normal with the positive $x$-axis.\n\nThe effective diffusion coefficient in any direction $\\mathbf{d}$ is given by the projection $\\mathbf{d}^T \\mathbf{K} \\mathbf{d}$. Therefore, the normal and tangential diffusion coefficients, $\\kappa_n$ and $\\kappa_t$, are obtained by projecting the diffusion tensor $\\mathbf{K}$ onto the $\\mathbf{n}$ and $\\mathbf{t}$ directions:\n$$\n\\kappa_n = \\mathbf{n}^T \\mathbf{K} \\mathbf{n} = \\begin{pmatrix} \\cos\\phi & \\sin\\phi \\end{pmatrix} \\begin{pmatrix} \\kappa_{xx} & 0 \\\\ 0 & \\kappa_{yy} \\end{pmatrix} \\begin{pmatrix} \\cos\\phi \\\\ \\sin\\phi \\end{pmatrix} = \\kappa_{xx} \\cos^2\\phi + \\kappa_{yy} \\sin^2\\phi\n$$\n$$\n\\kappa_t = \\mathbf{t}^T \\mathbf{K} \\mathbf{t} = \\begin{pmatrix} -\\sin\\phi & \\cos\\phi \\end{pmatrix} \\begin{pmatrix} \\kappa_{xx} & 0 \\\\ 0 & \\kappa_{yy} \\end{pmatrix} \\begin{pmatrix} -\\sin\\phi \\\\ \\cos\\phi \\end{pmatrix} = \\kappa_{xx} \\sin^2\\phi + \\kappa_{yy} \\cos^2\\phi\n$$\n\nSubstituting the expressions for $\\kappa_{xx}$ and $\\kappa_{yy}$, we arrive at the final formulas:\n$$\n\\kappa_n = \\frac{1}{2} |u| \\Delta x \\cos^2\\phi + \\frac{1}{2} |v| \\Delta y \\sin^2\\phi\n$$\n$$\n\\kappa_t = \\frac{1}{2} |u| \\Delta x \\sin^2\\phi + \\frac{1}{2} |v| \\Delta y \\cos^2\\phi\n$$\nThese equations quantify the artificial diffusion rates normal and tangential to the contact discontinuity, as induced by the one-dimensional Roe solver applied on a two-dimensional Cartesian grid. These formulas will be used to compute the results for the given test cases.",
            "answer": "[[0.5, 0.5], [1.0, 1.0], [0.625, 0.875], [0.0, 0.0], [1.056037, 0.943963]]"
        }
    ]
}