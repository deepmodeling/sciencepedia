{
    "hands_on_practices": [
        {
            "introduction": "Roe 求解器的强大之处在于它能够将流体动力学中的间断分解为基本波。本练习是一项基础理论实践，旨在剖析这一过程。通过推导波强度 $\\alpha_i$ 的显式公式，您将深入理解压力和速度等物理量的跳变如何直接转化为 Roe 线性化核心的声波和接触波的振幅 。",
            "id": "3992400",
            "problem": "考虑比热比为 $\\gamma1$ 的理想气体的一维可压缩欧拉方程，其守恒形式对守恒变量 $U=(\\rho,\\rho u,E)^{\\top}$ 写成。通量 $F(U)$ 源于质量、动量和能量守恒，压力满足 $p=(\\gamma-1)\\left(E-\\frac{1}{2}\\rho u^{2}\\right)$。定义比总焓 $H=\\frac{E+p}{\\rho}$。在计算流体力学(CFD)的Roe格式近似黎曼求解器中，通常围绕由左、右状态 $(\\rho_{L},u_{L},p_{L})$ 和 $(\\rho_{R},u_{R},p_{R})$ 构建的Roe平均状态对通量雅可比矩阵进行线性化，具体如下：\n- Roe平均速度为 $\\tilde{u}=\\frac{\\sqrt{\\rho_{L}}\\,u_{L}+\\sqrt{\\rho_{R}}\\,u_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}}$。\n- Roe平均比总焓为 $\\tilde{H}=\\frac{\\sqrt{\\rho_{L}}\\,H_{L}+\\sqrt{\\rho_{R}}\\,H_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}}$。\n- Roe平均声速为 $\\tilde{a}=\\sqrt{(\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^{2}\\right)}$。\n- 为了线性化恒等式，取Roe平均密度为 $\\tilde{\\rho}=\\sqrt{\\rho_{L}\\rho_{R}}$。\n\n令跳跃为 $\\Delta U=U_{R}-U_{L}$，并将原始变量的跳跃记为 $\\Delta\\rho=\\rho_{R}-\\rho_{L}$、$\\Delta u=u_{R}-u_{L}$ 和 $\\Delta p=p_{R}-p_{L}$。Roe线性化将守恒变量的跳跃分解为 $\\Delta U=\\sum_{i=1}^{3}\\alpha_{i}r_{i}$，其中 $r_{i}$ 是Roe线性化雅可比矩阵的右特征向量，$\\alpha_{i}$ 是波强度。假设标准的三波结构，其特征值为 $\\tilde{u}-\\tilde{a}$、$\\tilde{u}$ 和 $\\tilde{u}+\\tilde{a}$，以及相应的守恒变量下的右特征向量。\n\n从控制方程和理想气体热力学关系出发，推导波强度 $\\alpha_{1}$、$\\alpha_{2}$ 和 $\\alpha_{3}$ 的显式公式，用 $\\Delta\\rho$、$\\Delta u$、$\\Delta p$ 以及Roe平均量 $\\tilde{\\rho}$ 和 $\\tilde{a}$ 表示。解释压力跳跃在确定和 $\\alpha_{1}+\\alpha_{3}$ 中的作用。简要论证当通过修改声速点附近的特征速度来应用Harten–Hyman熵修正时，这些 $\\alpha_{i}$ 的表达式是否会改变，假设特征向量不变。\n\n将您关于 $(\\alpha_{1},\\alpha_{2},\\alpha_{3})$ 的最终答案表示为单个闭合形式的解析表达式。无需进行数值计算。无需四舍五入。最终答案必须以行矩阵的形式给出。",
            "solution": "本问题要求推导Roe线性化一维欧拉方程的波强度 $\\alpha_1, \\alpha_2, \\alpha_3$。这些强度是守恒变量跳跃 $\\Delta U$ 在Roe平均雅可比矩阵右特征向量基上的分解系数。\n\n守恒变量向量为 $U = (\\rho, \\rho u, E)^{\\top}$。该向量在右状态($R$)和左状态($L$)之间的跳跃为 $\\Delta U = U_R - U_L = (\\Delta\\rho, \\Delta(\\rho u), \\Delta E)^{\\top}$。该跳跃分解为：\n$$\n\\Delta U = \\sum_{i=1}^{3} \\alpha_i r_i\n$$\n其中 $r_i$ 是Roe平均雅可比矩阵的右特征向量，对应于特征值 $\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}$、$\\tilde{\\lambda}_2 = \\tilde{u}$ 和 $\\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a}$。这些特征向量在Roe平均状态 $(\\tilde{\\rho}, \\tilde{u}, \\tilde{p})$ 下的标准、未缩放形式为：\n$$\nr_1 = \\begin{pmatrix} 1 \\\\ \\tilde{u}-\\tilde{a} \\\\ \\tilde{H}-\\tilde{u}\\tilde{a} \\end{pmatrix}, \\quad\nr_2 = \\begin{pmatrix} 1 \\\\ \\tilde{u} \\\\ \\frac{1}{2}\\tilde{u}^2 \\end{pmatrix}, \\quad\nr_3 = \\begin{pmatrix} 1 \\\\ \\tilde{u}+\\tilde{a} \\\\ \\tilde{H}+\\tilde{u}\\tilde{a} \\end{pmatrix}\n$$\n此处，$\\tilde{H}$ 是Roe平均比总焓，$\\tilde{a}$ 是Roe平均声速，定义为 $\\tilde{a}^2 = (\\gamma-1)(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2)$。\n\n将这些向量代入分解式，得到关于 $(\\alpha_1, \\alpha_2, \\alpha_3)$ 的三元线性方程组：\n$$\n\\begin{cases}\n\\Delta\\rho  = \\alpha_1 + \\alpha_2 + \\alpha_3 \\\\\n\\Delta(\\rho u)  = \\alpha_1(\\tilde{u}-\\tilde{a}) + \\alpha_2\\tilde{u} + \\alpha_3(\\tilde{u}+\\tilde{a}) \\\\\n\\Delta E  = \\alpha_1(\\tilde{H}-\\tilde{u}\\tilde{a}) + \\alpha_2\\frac{1}{2}\\tilde{u}^2 + \\alpha_3(\\tilde{H}+\\tilde{u}\\tilde{a})\n\\end{cases}\n$$\n为求解此方程组，我们首先用原始变量跳跃 $\\Delta\\rho$、$\\Delta u$、$\\Delta p$ 和Roe平均量来表示守恒变量的跳跃 $\\Delta(\\rho u)$ 和 $\\Delta E$。Roe平均量的特殊构造确保了简单的关系。\n对于动量跳跃 $\\Delta(\\rho u)$：\n$$\n\\Delta(\\rho u) = \\rho_R u_R - \\rho_L u_L\n$$\n使用Roe平均速度的定义 $\\tilde{u} = \\frac{\\sqrt{\\rho_{L}}\\,u_{L}+\\sqrt{\\rho_{R}}\\,u_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}}$，可以证明以下精确关系：\n$$\n\\Delta(\\rho u) = \\tilde{u}\\Delta\\rho + \\tilde{\\rho}\\Delta u\n$$\n其中 $\\tilde{\\rho} = \\sqrt{\\rho_L \\rho_R}$ 是问题陈述中为线性化目的给出的。\n\n现在，将此式代入我们方程组的第二个方程：\n$$\n\\tilde{u}\\Delta\\rho + \\tilde{\\rho}\\Delta u = \\alpha_1(\\tilde{u}-\\tilde{a}) + \\alpha_2\\tilde{u} + \\alpha_3(\\tilde{u}+\\tilde{a})\n$$\n可以对各项进行重排：\n$$\n\\tilde{u}(\\alpha_1 + \\alpha_2 + \\alpha_3) + \\tilde{\\rho}\\Delta u = \\tilde{u}(\\alpha_1 + \\alpha_2 + \\alpha_3) - \\tilde{a}\\alpha_1 + \\tilde{a}\\alpha_3\n$$\n从第一个方程组方程代入 $\\Delta\\rho = \\alpha_1+\\alpha_2+\\alpha_3$ 可将其简化为：\n$$\n\\tilde{u}\\Delta\\rho + \\tilde{\\rho}\\Delta u = \\tilde{u}\\Delta\\rho - \\tilde{a}\\alpha_1 + \\tilde{a}\\alpha_3\n$$\n这直接得出了 $\\alpha_1$ 和 $\\alpha_3$ 之间的一个关系：\n$$\n\\alpha_3 - \\alpha_1 = \\frac{\\tilde{\\rho}\\Delta u}{\\tilde{a}}\n$$\n接下来，我们寻找涉及 $\\alpha_1$ 和 $\\alpha_3$ 的第二个关系。这可以通过将总能量跳跃 $\\Delta E$ 与压力跳跃 $\\Delta p$ 联系起来找到。压力为 $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$，这意味着 $\\Delta E = \\frac{\\Delta p}{\\gamma-1} + \\frac{1}{2}\\Delta(\\rho u^2)$。Roe线性化（“U-性质”）的一个关键属性要求压力跳跃满足：\n$$\n\\Delta p = (\\gamma-1)\\left(\\Delta E - \\tilde{u}\\Delta(\\rho u) + \\frac{1}{2}\\tilde{u}^2\\Delta\\rho\\right)\n$$\n我们可以将特征向量分解代入 $\\Delta E$、$\\Delta(\\rho u)$ 和 $\\Delta\\rho$各项：\n$$\n\\frac{\\Delta p}{\\gamma-1} = \\left(\\alpha_1(\\tilde{H}-\\tilde{u}\\tilde{a}) + \\alpha_2\\frac{\\tilde{u}^2}{2} + \\alpha_3(\\tilde{H}+\\tilde{u}\\tilde{a})\\right) - \\tilde{u}\\left(\\alpha_1(\\tilde{u}-\\tilde{a}) + \\alpha_2\\tilde{u} + \\alpha_3(\\tilde{u}+\\tilde{a})\\right) + \\frac{\\tilde{u}^2}{2}\\left(\\alpha_1 + \\alpha_2 + \\alpha_3\\right)\n$$\n对每个 $\\alpha_i$ 合并同类项：\n- 对于 $\\alpha_1: (\\tilde{H}-\\tilde{u}\\tilde{a}) - \\tilde{u}(\\tilde{u}-\\tilde{a}) + \\frac{\\tilde{u}^2}{2} = \\tilde{H}-\\tilde{u}\\tilde{a} - \\tilde{u}^2 + \\tilde{u}\\tilde{a} + \\frac{\\tilde{u}^2}{2} = \\tilde{H}-\\frac{\\tilde{u}^2}{2} = \\frac{\\tilde{a}^2}{\\gamma-1}$\n- 对于 $\\alpha_2: \\frac{\\tilde{u}^2}{2} - \\tilde{u}(\\tilde{u}) + \\frac{\\tilde{u}^2}{2} = 0$\n- 对于 $\\alpha_3: (\\tilde{H}+\\tilde{u}\\tilde{a}) - \\tilde{u}(\\tilde{u}+\\tilde{a}) + \\frac{\\tilde{u}^2}{2} = \\tilde{H}+\\tilde{u}\\tilde{a} - \\tilde{u}^2 - \\tilde{u}\\tilde{a} + \\frac{\\tilde{u}^2}{2} = \\tilde{H}-\\frac{\\tilde{u}^2}{2} = \\frac{\\tilde{a}^2}{\\gamma-1}$\n\n因此，该方程简化为：\n$$\n\\frac{\\Delta p}{\\gamma-1} = \\alpha_1 \\frac{\\tilde{a}^2}{\\gamma-1} + \\alpha_3 \\frac{\\tilde{a}^2}{\\gamma-1}\n$$\n这给出了我们的第二个关系式：\n$$\n\\alpha_1 + \\alpha_3 = \\frac{\\Delta p}{\\tilde{a}^2}\n$$\n这个方程直接说明了压力跳跃的作用：两个声波的强度之和 $\\alpha_1 + \\alpha_3$ 与压力跳跃 $\\Delta p$ 成正比，与Roe平均声速的平方 $\\tilde{a}^2$ 成反比。\n\n现在我们得到了一个关于 $\\alpha_1$ 和 $\\alpha_3$ 的 $2 \\times 2$ 线性方程组：\n$$\n\\begin{cases}\n\\alpha_3 + \\alpha_1 = \\frac{\\Delta p}{\\tilde{a}^2} \\\\\n\\alpha_3 - \\alpha_1 = \\frac{\\tilde{\\rho}\\Delta u}{\\tilde{a}}\n\\end{cases}\n$$\n将两个方程相加得到 $2\\alpha_3 = \\frac{\\Delta p}{\\tilde{a}^2} + \\frac{\\tilde{\\rho}\\Delta u}{\\tilde{a}}$，所以：\n$$\n\\alpha_3 = \\frac{1}{2\\tilde{a}^2}\\left(\\Delta p + \\tilde{\\rho}\\tilde{a}\\Delta u\\right)\n$$\n用第一个方程减去第二个方程得到 $2\\alpha_1 = \\frac{\\Delta p}{\\tilde{a}^2} - \\frac{\\tilde{\\rho}\\Delta u}{\\tilde{a}}$，所以：\n$$\n\\alpha_1 = \\frac{1}{2\\tilde{a}^2}\\left(\\Delta p - \\tilde{\\rho}\\tilde{a}\\Delta u\\right)\n$$\n最后，我们从原方程组的第一个方程求出 $\\alpha_2$：$\\alpha_2 = \\Delta\\rho - (\\alpha_1 + \\alpha_3)$。使用我们之前求出的和：\n$$\n\\alpha_2 = \\Delta\\rho - \\frac{\\Delta p}{\\tilde{a}^2}\n$$\n至此完成了波强度的推导。\n\n关于Harten–Hyman熵修正：该过程旨在声速点（即特征值 $|\\tilde{\\lambda}_i|$ 接近于0处）增加数值耗散，以防止非物理膨胀激波的形成。它通常通过修改数值通量耗散项中使用的特征值来实现，例如，将 $|\\tilde{\\lambda}_i|$ 替换为一个函数 $Q(\\tilde{\\lambda}_i)$，使得 $Q(\\lambda) \\geq \\delta  0$。问题陈述，此修正是应用于特征速度（特征值）的，*而不改变特征向量*。\n\n波强度 $\\alpha_i$ 是跳跃向量 $\\Delta U$ 在右特征向量基 $\\{r_1, r_2, r_3\\}$ 下的坐标。如上所示，它们的计算仅依赖于这些特征向量的分量和跳跃条件，而不依赖于相应的特征值 $\\tilde{\\lambda}_i$。由于假设特征向量不受熵修正的影响，$\\Delta U$ 在此基上的代数投影保持不变。因此，$\\alpha_1$、$\\alpha_2$ 和 $\\alpha_3$ 的表达式不会因应用此类熵修正而改变。该修正修改的是如何使用这些波强度来计算数值通量，而不是修改波强度本身。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2\\tilde{a}^2}(\\Delta p - \\tilde{\\rho}\\tilde{a}\\Delta u)  \\Delta\\rho - \\frac{\\Delta p}{\\tilde{a}^2}  \\frac{1}{2\\tilde{a}^2}(\\Delta p + \\tilde{\\rho}\\tilde{a}\\Delta u) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然功能强大，但标准的 Roe 求解器并非万无一失，在某些条件下可能会失效，导致非物理解和数值不稳定性。本练习提出了一个关键的思想实验，挑战您分析 Roe 平均态失去其物理意义并导致双曲性丧失的情景 。评估所提出的保障措施将帮助您建立设计鲁棒数值格式的直觉，以处理如强膨胀波等极端流动条件。",
            "id": "3992411",
            "problem": "考虑一维可压缩理想气体欧拉方程组，比热比为$\\gamma$，写为密度$\\rho$、动量$\\rho u$和总能量$E$的守恒形式。与这些方程相关的通量雅可比矩阵在物理允许的状态下有三个实特征值：$u-c$、$u$和$u+c$，其中$u$是流体速度，$c$是热力学声速，定义为$c^2 = \\gamma p/\\rho = (\\gamma-1)\\left(H-\\frac{1}{2}u^2\\right)$，其中$p$是压力，$H = (E+p)/\\rho$是总比焓。在 Roe 近似黎曼求解器中，根据左右状态$(\\rho_L,u_L,p_L)$和$(\\rho_R,u_R,p_R)$构建一个 Roe 平均状态$\\tilde{\\boldsymbol{U}}$，并在此状态上构造一个线性化，从而得到 Roe 平均速度$\\tilde{u}$和 Roe 平均焓$\\tilde{H}$，以及由$\\tilde{c}^2 = (\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^2\\right)$定义的 Roe 声速。\n\n从欧拉方程和理想气体热力学关系出发，分析当$\\tilde{H}-\\frac{1}{2}\\tilde{u}^2$变为负值时，对 Roe 线性化双曲性的影响。解释在 Roe 线性化产生的中间状态和由此产生的特征结构方面，该条件的物理和数学意义。基于第一性原理和经过充分检验的数值分析事实，推荐一些防护措施，以确保在强稀疏波或跨音速膨胀存在的情况下，能够获得物理上允许的声速并保持离散化的稳健性。\n\n在所述情况下，以下哪些防护措施在科学上是合理的，并且足以维持物理声速和稳健的格式？\n\nA. 对$|\\tilde{u}| \\approx \\tilde{c}$附近的 Roe 特征值应用 Harten–Hyman 熵修正；仅凭熵修正就能保证$\\tilde{c}^2$对于所有左右状态都保持非负。\n\nB. 当 Roe 平均声速的平方变为负值时，将 Roe 通量替换为保正的 Harten–Lax–van Leer 族通量（例如 HLL 或 Harten–Lax–van Leer–Einfeldt (HLLE)），或使用一个在保正性传感器触发下回退到 HLL/HLLE 的混合通量；这能强制保证中间密度和压力的正性，从而保证声速为实数。\n\nC. 使用带有总变差减小（TVD）限制器的原始变量重构和保正性时间步进，以确保重构的界面状态具有正压力和正密度；仅此一项就能保证 Roe 平均的$\\tilde{c}^2$为非负。\n\nD. 人为地增加$\\gamma$直到$(\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^2\\right)$变为正值；这可以在不损害守恒性或相容性的情况下保持物理声速。\n\nE. 修改 Roe 平均法，使用能量相容或基于熵变量的平均（例如，对压力/温度使用对数平均），以保持热力学变量的凸性和正性，确保$\\tilde{H}-\\frac{1}{2}\\tilde{u}^2 \\ge 0$；这样可以在保持迎风特性的同时，得到一个具有实特征值的 Roe 线性化。\n\n选择所有适用项。",
            "solution": "在进行求解之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **控制方程**：一维可压缩理想气体欧拉方程。\n- **状态变量（守恒形式）**：密度$\\rho$，动量$\\rho u$，总能量$E$。\n- **比热比**：$\\gamma$。\n- **通量雅可比矩阵特征值**：对于物理允许的状态，通量雅可比矩阵有三个实特征值：$u-c$、$u$和$u+c$。\n- **流体速度**：$u$。\n- **热力学声速**：$c$，定义为$c^2 = \\gamma p/\\rho = (\\gamma-1)\\left(H-\\frac{1}{2}u^2\\right)$。\n- **压力**：$p$。\n- **总比焓**：$H = (E+p)/\\rho$。\n- **Roe 近似黎曼求解器**：根据左右状态$(\\rho_L, u_L, p_L)$和$(\\rho_R, u_R, p_R)$构建一个 Roe 平均状态$\\tilde{\\boldsymbol{U}}$上的线性化。\n- **Roe 平均量**：Roe 平均速度$\\tilde{u}$和 Roe 平均焓$\\tilde{H}$。\n- **Roe 平均声速**：$\\tilde{c}$，定义为$\\tilde{c}^2 = (\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^2\\right)$。\n- **核心问题**：分析$\\tilde{H}-\\frac{1}{2}\\tilde{u}^2  0$的影响，并推荐确保物理可容许性和稳健性的防护措施。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学和数学上是良定义的。\n- **科学基础**：问题描述了一维欧拉方程和 Roe 近似黎曼求解器，这些是计算流体力学（CFD）中的经典课题。所讨论的具体失效模式，即 Roe 平均状态变为非物理状态（$\\tilde{c}^2  0$），是标准 Roe 求解器中一个有详细记载的病态问题，尤其是在处理强膨胀波或近真空状态时。这是开发稳健数值格式时一个真实且重要的问题。\n- **良构性**：该问题是良构的。它要求对一种已知的数值不稳定性进行概念性分析，并评估为缓解该问题而设计的既有技术。\n- **客观性**：术语精确且在 CFD 领域内是标准的。问题陈述没有主观或含糊不清的语言。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。这是数值分析双曲守恒律领域一个标准的、非平凡的问题。可以继续求解过程。\n\n### 问题分析\n欧拉方程的双曲性是其物理性质的基础，代表了信息通过波（声波和熵波/接触波）的传播。通量雅可比矩阵的特征值$u-c$、$u$和$u+c$代表了这些波的速度。为使系统是双曲的，这些特征值必须是实数，这要求声速$c$是一个实数。这意味着$c^2 = \\gamma p / \\rho \\ge 0$。由于对于任何物理状态，$\\gamma1$和$\\rho0$，这等价于要求压力$p \\ge 0$。\n\nRoe 近似黎曼求解器通过引入一个矩阵$\\tilde{A}(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$来在线性化单元界面处的非线性欧拉方程，该矩阵具有两个性质：\n$1$. 它与真实雅可比矩阵相容：$\\tilde{A}(\\boldsymbol{U}, \\boldsymbol{U}) = A(\\boldsymbol{U})$。\n$2$. 它精确满足跳跃条件：$\\boldsymbol{F}(\\boldsymbol{U}_R) - \\boldsymbol{F}(\\boldsymbol{U}_L) = \\tilde{A}(\\boldsymbol{U}_L, \\boldsymbol{U}_R)(\\boldsymbol{U}_R - \\boldsymbol{U}_L)$。\n\n这个 Roe 矩阵$\\tilde{A}$的特征值是$\\tilde{u}-\\tilde{c}$、$\\tilde{u}$和$\\tilde{u}+\\tilde{c}$，其中$\\tilde{u}$是 Roe 平均速度，$\\tilde{c}$是 Roe 平均声速。为使数值格式稳定且具有物理意义，这个线性化系统也必须是双曲的，这意味着其特征值必须是实数。这要求$\\tilde{c}^2 \\ge 0$。\n\n问题聚焦于这一条件失效的情况：$\\tilde{c}^2  0$。根据定义$\\tilde{c}^2 = (\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^2\\right)$，并注意到对于任何物理气体$\\gamma-1  0$，此失效意味着$\\tilde{H}-\\frac{1}{2}\\tilde{u}^2  0$。\n对于单个物理状态，项$H - \\frac{1}{2}u^2$等于比内能加上压力-密度比：$H - \\frac{1}{2}u^2 = (e+p/\\rho+\\frac{1}{2}u^2) - \\frac{1}{2}u^2 = e + p/\\rho$。对于理想气体，$p = (\\gamma-1)\\rho e$，所以$p/\\rho = (\\gamma-1)e$。因此，$e+p/\\rho = e+(\\gamma-1)e = \\gamma e$。\n所以，条件$\\tilde{H}-\\frac{1}{2}\\tilde{u}^2  0$表明 Roe 平均状态对应于一个具有有效负内能或负压力的非物理状态。这是因为标准的 Roe 平均公式虽然满足跳跃条件，但本身并不保证热力学量的正性。\n\n当$\\tilde{c}^2  0$时，$\\tilde{c}$变成一个虚数。特征值$\\tilde{u} \\pm \\tilde{c}$成为一对共轭复数。具有复数特征值的系统是椭圆性的，而非双曲性的。将一个依赖于实特征值符号来确定信息传播方向的迎风格式应用于椭圆系统，会导致方法的灾难性崩溃和爆发性数值不稳定性。\n\n任务是找出防止这种失效的有效防护措施。\n\n### 逐项分析选项\n\n**A. 对$|\\tilde{u}| \\approx \\tilde{c}$附近的 Roe 特征值应用 Harten–Hyman 熵修正；仅凭熵修正就能保证$\\tilde{c}^2$对于所有左右状态都保持非负。**\n\nHarten-Hyman 熵修正（或简称 Harten 熵修正）是为解决另一个问题而设计的。标准的 Roe 求解器可能在跨音速稀疏波中错误地允许非物理的“膨胀激波”出现，此时某个特征速度穿过零（例如，$\\tilde{u}-\\tilde{c}  0$而$\\tilde{u}+\\tilde{c}  0$）。熵修正通过增加少量数值耗散来“抹平”波，确保产生正确的、连续的膨胀扇。它的工作原理是当特征值$\\lambda$的绝对值$|\\lambda|$非常小时，对其进行修正，例如用一个函数如$\\frac{\\lambda^2+\\delta^2}{2\\delta}$（当$|\\lambda|  \\delta$时）替换$|\\lambda|$，其中$\\delta$是一个小参数。这个过程预设了特征值本身是实数。它不能也无法阻止$\\tilde{c}^2$变为负值。声称仅凭熵修正就能保证$\\tilde{c}^2$非负的说法在事实上是错误的。\n\n**结论：不正确。**\n\n**B. 当 Roe 平均声速的平方变为负值时，将 Roe 通量替换为保正的 Harten–Lax–van Leer 族通量（例如 HLL 或 Harten–Lax–van Leer–Einfeldt (HLLE)），或使用一个在保正性传感器触发下回退到 HLL/HLLE 的混合通量；这能强制保证中间密度和压力的正性，从而保证声速为实数。**\n\n这描述了一种被广泛使用且有效的“混合格式”策略。HLL 类求解器以其稳健性而闻名。它们通常比 Roe 求解器耗散性更强，因为它们不能解析所有的特征波，但在合适的 CFL 条件下，它们是保正的。这意味着它们可以被设计成永远不会从正的输入数据产生负的密度或压力。这种策略是在默认情况下使用高分辨率的 Roe 求解器，但在每个单元界面检查是否存在病态问题。如果一个传感器（例如条件$\\tilde{c}^2  0$）检测到 Roe 求解器即将失效，格式会局部地为该界面切换到一个稳健的 HLL 或 HLLE 通量。这种“回退”机制结合了 Roe 在光滑区域的精度和 HLL 在问题区域的稳健性。这是一种科学上合理、实用且充分的防护措施。\n\n**结论：正确。**\n\n**C. 使用带有总变差减小（TVD）限制器的原始变量重构和保正性时间步进，以确保重构的界面状态具有正压力和正密度；仅此一项就能保证 Roe 平均的$\\tilde{c}^2$为非负。**\n\n此选项描述了高分辨率有限体积格式的一系列良好实践。重构原始变量（$\\rho, u, p$）通常比重构守恒变量表现更好。TVD 限制器对于无振荡的激波捕捉至关重要。保正性的重构和时间步进方法对于确保网格平均状态保持物理性很重要。然而，问题的核心不在于输入到黎曼求解器的左右状态，而在于 Roe *平均过程*本身。标准的 Roe 平均可以接受两个完全有效、物理的左右状态$(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$，并产生一个非物理的中间状态$\\tilde{\\boldsymbol{U}}$（即导致$\\tilde{c}^2  0$）。因此，确保输入状态是物理的是一个必要但不充分的条件。这个防护措施本身并不能修复 Roe 平均方法内部的缺陷。\n\n**结论：不正确。**\n\n**D. 人为地增加$\\gamma$直到$(\\gamma-1)\\left(\\tilde{H}-\\frac{1}{2}\\tilde{u}^2\\right)$变为正值；这可以在不损害守恒性或相容性的情况下保持物理声速。**\n\n这个提议从科学角度看是根本不合理的。比热比$\\gamma$是被模拟气体的物理属性（例如，空气的$\\gamma \\approx 1.4$）。人为修改一个物理常数构成了对控制方程本身的改变。虽然在某些情况下它可能在数学上“修正”$\\tilde{c}^2$的符号，但得到的数值解将不再是原始物理问题的解的近似。它损害了与预期偏微分方程的相容性。对于*修改后*的方程，守恒性可能得以维持，但对于原始方程则不然。这是一个无原则的“取巧”方法，违背了模拟的基本目标，即模拟物理现实。\n\n**结论：不正确。**\n\n**E. 修改 Roe 平均法，使用能量相容或基于熵变量的平均（例如，对压力/温度使用对数平均），以保持热力学变量的凸性和正性，确保$\\tilde{H}-\\frac{1}{2}\\tilde{u}^2 \\ge 0$；这样可以在保持迎风特性的同时，得到一个具有实特征值的 Roe 线性化。**\n\n这种方法解决了问题的根本原因：标准代数 Roe 平均法的不足。Roe 平均的失败与其未能尊重熵函数的凸结构有关。通过基于更基本的物理或数学原理设计一种新的平均程序，可以消除这个问题。已知基于熵变量的平均法通过构造就能产生物理上允许的中间状态。类似地，对于理想气体，可以通过对热力学变量选择特定的对数平均来构造一个类 Roe 矩阵，该矩阵被保证具有正性，从而确保对于任何两个物理输入状态都有$\\tilde{c}^2 \\ge 0$。这种修改创造了一个既稳健（总是双曲的）又精确（完全迎风，能解析所有波）的求解器，代表了一种比混合格式更根本、更优雅的解决方案。这是一种科学上合理且充分的防护措施。\n\n**结论：正确。**",
            "answer": "$$\\boxed{BE}$$"
        },
        {
            "introduction": "在探究了理论基础和潜在的失效模式之后，本练习将 Roe 格式应用于经典的 Sod 激波管问题——这是验证数值方法的基石。您将具体计算 Roe 平均态及其特征值，并关键性地评估是否需要熵修正来确保稀疏波的物理解 。这项练习弥合了抽象理论与实际数值实现之间的鸿沟。",
            "id": "3992402",
            "problem": "考虑计算流体动力学（CFD）中的一维无粘可压缩流动的欧拉方程，其守恒形式写作状态向量 $U = (\\rho, \\rho u, E)^{\\mathsf{T}}$ 和通量 $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$。初始数据对应于 Sod 激波管黎曼问题，其左状态为 $U_{L} = (\\rho_{L}, u_{L}, p_{L}) = (1.0, 0, 1.0)$，右状态为 $U_{R} = (\\rho_{R}, u_{R}, p_{R}) = (0.125, 0, 0.1)$，气体为完全气体，比热比 $\\gamma = 1.4$。你可以使用理想气体关系式 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$、声速 $a = \\sqrt{\\gamma p / \\rho}$ 以及比总焓 $H = (E + p)/\\rho = \\tfrac{\\gamma}{\\gamma - 1}\\tfrac{p}{\\rho} + \\tfrac{1}{2}u^{2}$。\n\n从控制方程和这些热力学定义出发，推导 $U_{L}$ 和 $U_{R}$ 之间界面的 Roe 线性化。计算 Roe 平均速度 $\\tilde{u}$、比总焓 $\\tilde{H}$ 和声速 $\\tilde{a}$。然后，通过使用 Roe 特征结构将跳跃 $\\Delta U = U_{R} - U_{L}$分解为特征波，构建界面处的 Roe 矩阵特征值和相应的 Roe 通量 $F_{i+1/2}^{\\mathrm{Roe}}$。最后，对左行声场实施 Harten 熵修正，使用阈值\n$$\\delta_{1} = \\max\\!\\big(0,\\, \\lambda_{1,R} - \\lambda_{1,L}\\big),$$\n其中 $\\lambda_{1,L} = u_{L} - a_{L}$ 和 $\\lambda_{1,R} = u_{R} - a_{R}$ 是从物理（非 Roe）状态计算出的相应左/右声学特征值，并应用修正后的粘性函数\n$$|\\lambda|_{\\mathrm{fix}} = \\begin{cases}\n\\frac{1}{2}\\!\\left(\\frac{\\lambda^{2}}{\\delta} + \\delta\\right),  \\text{若 } |\\lambda|  \\delta, \\\\[6pt]\n|\\lambda|,  \\text{其他情况.}\n\\end{cases}$$\n其中 $\\lambda$ 等于界面处的 Roe 左行声学特征值。评估此熵修正是否改变了与初始间断处的稀疏扇相关的波速。\n\n作为最终答案，报告界面处经过熵修正的左行声学特征速度的大小。将所有量视为无量纲，并将最终值四舍五入到四位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。这是一个基于既定科学原理的计算流体动力学中的适定问题。所有必要的数据和定义都已提供，没有内部矛盾或歧义。\n\n该问题要求使用 Roe 线性化和 Harten 型熵修正，计算 Sod 激波管问题的左行声学特征速度的熵修正后的大小。\n\n一维欧拉方程由 $\\partial_t U + \\partial_x F(U) = 0$ 给出，其中状态向量为 $U = (\\rho, \\rho u, E)^{\\mathsf{T}}$，通量向量为 $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$。比热比为 $\\gamma = 1.4$。完全气体的状态方程为 $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2)$。\n\n首先，我们用原始变量和守恒变量来定义左 ($L$) 和右 ($R$) 状态。\n初始原始变量为：\n左状态：$\\rho_L = 1.0$, $u_L = 0$, $p_L = 1.0$。\n右状态：$\\rho_R = 0.125$, $u_R = 0$, $p_R = 0.1$。\n\n由此，我们计算每个状态的单位体积总能量 $E$：\n$E_L = \\frac{p_L}{\\gamma - 1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{1.0}{1.4 - 1} + \\frac{1}{2}(1.0)(0)^2 = \\frac{1.0}{0.4} = 2.5$。\n$E_R = \\frac{p_R}{\\gamma - 1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{0.1}{1.4 - 1} + \\frac{1}{2}(0.125)(0)^2 = \\frac{0.1}{0.4} = 0.25$。\n\n守恒形式的状态向量为：\n$U_L = (\\rho_L, \\rho_L u_L, E_L)^{\\mathsf{T}} = (1.0, 0, 2.5)^{\\mathsf{T}}$。\n$U_R = (\\rho_R, \\rho_R u_R, E_R)^{\\mathsf{T}} = (0.125, 0, 0.25)^{\\mathsf{T}}$。\n\n接下来，我们计算每个状态的比总焓 $H = (E+p)/\\rho$：\n$H_L = \\frac{E_L + p_L}{\\rho_L} = \\frac{2.5 + 1.0}{1.0} = 3.5$。\n$H_R = \\frac{E_R + p_R}{\\rho_R} = \\frac{0.25 + 0.1}{0.125} = \\frac{0.35}{0.125} = 2.8$。\n\nRoe 平均状态的定义是满足属性 $F_R - F_L = \\tilde{A}(U_R - U_L)$，其中 $\\tilde{A}$ 是在 Roe 平均状态下求值的 Roe 矩阵。Roe 平均变量计算如下：\n$\\tilde{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}} = \\frac{\\sqrt{1.0}(0) + \\sqrt{0.125}(0)}{\\sqrt{1.0} + \\sqrt{0.125}} = 0$。\n$\\tilde{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}} = \\frac{\\sqrt{1.0}(3.5) + \\sqrt{0.125}(2.8)}{\\sqrt{1.0} + \\sqrt{0.125}}$。\n使用 $\\sqrt{0.125} = \\sqrt{1/8} = 1/(2\\sqrt{2}) = \\frac{\\sqrt{2}}{4}$：\n$\\tilde{H} = \\frac{3.5 + \\frac{\\sqrt{2}}{4}(2.8)}{1 + \\frac{\\sqrt{2}}{4}} = \\frac{4(3.5 + 0.7\\sqrt{2})}{4(1 + \\frac{\\sqrt{2}}{4})} = \\frac{14 + 2.8\\sqrt{2}}{4 + \\sqrt{2}}$。\n分母有理化：\n$\\tilde{H} = \\frac{14 + 2.8\\sqrt{2}}{4 + \\sqrt{2}} \\cdot \\frac{4 - \\sqrt{2}}{4 - \\sqrt{2}} = \\frac{56 - 14\\sqrt{2} + 11.2\\sqrt{2} - 2.8(2)}{16 - 2} = \\frac{50.4 - 2.8\\sqrt{2}}{14} = 3.6 - 0.2\\sqrt{2}$。\n\nRoe 平均声速 $\\tilde{a}$ 由 $\\tilde{a}^2 = (\\gamma - 1)(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2)$ 给出：\n$\\tilde{a}^2 = (1.4 - 1)( (3.6 - 0.2\\sqrt{2}) - \\frac{1}{2}(0)^2) = 0.4(3.6 - 0.2\\sqrt{2}) = 1.44 - 0.08\\sqrt{2}$。\n$\\tilde{a} = \\sqrt{1.44 - 0.08\\sqrt{2}}$。\n\nRoe 矩阵 $\\tilde{A}$ 的特征值为 $\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}$，$\\tilde{\\lambda}_2 = \\tilde{u}$ 和 $\\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a}$。左行声学特征速度为：\n$\\tilde{\\lambda}_1 = 0 - \\sqrt{1.44 - 0.08\\sqrt{2}} = -\\sqrt{1.44 - 0.08\\sqrt{2}}$。\n\n现在我们必须评估 Harten 熵修正是否被激活。当 $|\\tilde{\\lambda}_1|  \\delta_1$ 时，应用该修正。阈值 $\\delta_1$ 定义为 $\\delta_1 = \\max(0, \\lambda_{1,R} - \\lambda_{1,L})$。\n首先，我们计算物理（非平均）声速 $a_L$ 和 $a_R$：\n$a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\cdot 1.0}{1.0}} = \\sqrt{1.4}$。\n$a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\cdot 0.1}{0.125}} = \\sqrt{1.4 \\cdot 0.8} = \\sqrt{1.12}$。\n\n接下来，我们计算物理特征速度 $\\lambda_{1,L}$ 和 $\\lambda_{1,R}$：\n$\\lambda_{1,L} = u_L - a_L = 0 - \\sqrt{1.4} = -\\sqrt{1.4}$。\n$\\lambda_{1,R} = u_R - a_R = 0 - \\sqrt{1.12} = -\\sqrt{1.12}$。\n\n现在，我们计算阈值 $\\delta_1$：\n$\\delta_1 = \\max(0, \\lambda_{1,R} - \\lambda_{1,L}) = \\max(0, -\\sqrt{1.12} - (-\\sqrt{1.4})) = \\max(0, \\sqrt{1.4} - \\sqrt{1.12})$。\n数值上，$\\sqrt{1.4} \\approx 1.1832$ 且 $\\sqrt{1.12} \\approx 1.0583$。由于 $\\sqrt{1.4} > \\sqrt{1.12}$，我们有：\n$\\delta_1 = \\sqrt{1.4} - \\sqrt{1.12} \\approx 0.1249$。\n\n熵修正的条件是 $|\\tilde{\\lambda}_1|  \\delta_1$。我们来评估这些量：\n$|\\tilde{\\lambda}_1| = \\sqrt{1.44 - 0.08\\sqrt{2}}$。使用 $\\sqrt{2} \\approx 1.4142$：\n$|\\tilde{\\lambda}_1| \\approx \\sqrt{1.44 - 0.08(1.4142)} = \\sqrt{1.44 - 0.113136} = \\sqrt{1.326864} \\approx 1.1519$。\n\n比较这些值：\n$|\\tilde{\\lambda}_1| \\approx 1.1519$\n$\\delta_1 \\approx 0.1249$\n条件 $|\\tilde{\\lambda}_1|  \\delta_1$ 即 $1.1519  0.1249$，这是不成立的。\n\nHarten 熵修正由修正后的粘性函数定义：\n$|\\lambda|_{\\mathrm{fix}} = \\begin{cases} \\frac{1}{2}(\\frac{\\lambda^2}{\\delta} + \\delta),  \\text{若 } |\\lambda|  \\delta, \\\\ |\\lambda|,  \\text{其他情况。} \\end{cases}$\n由于条件 $|\\tilde{\\lambda}_1|  \\delta_1$ 不满足，我们属于“其他情况”。因此，熵修正不会改变波速。\n经过熵修正的左行声学特征速度的大小是：\n$|\\tilde{\\lambda}_1|_{\\mathrm{fix}} = |\\tilde{\\lambda}_1| = \\sqrt{1.44 - 0.08\\sqrt{2}}$。\n\n问题要求将此值四舍五入到四位有效数字。\n$|\\tilde{\\lambda}_1|_{\\mathrm{fix}} = \\sqrt{1.44 - 0.08\\sqrt{2}} \\approx \\sqrt{1.44 - 0.08(1.41421356)} \\approx \\sqrt{1.44 - 0.11313708} \\approx \\sqrt{1.32686292} \\approx 1.15189536$。\n\n四舍五入到四位有效数字，我们得到 $1.152$。\n\n对熵修正的评估是，在此 Sod 激波管问题中，它不会改变左行稀疏波的波速。这是预期的行为，因为该修正旨在主要为跨音速稀疏波（其中特征值穿过零）增加数值耗散，而这里情况并非如此（$\\lambda_{1,L}$ 和 $\\lambda_{1,R}$ 均为负值）。\n\n最终答案计算：\n待报告的值：$|\\tilde{\\lambda}_1|_{\\mathrm{fix}} = 1.15189536 \\dots$\n四舍五入到四位有效数字：$1.152$。",
            "answer": "$$\\boxed{1.152}$$"
        }
    ]
}