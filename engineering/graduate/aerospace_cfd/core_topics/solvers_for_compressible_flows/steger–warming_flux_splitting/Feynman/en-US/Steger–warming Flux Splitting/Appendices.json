{
    "hands_on_practices": [
        {
            "introduction": "To truly understand the Steger-Warming scheme, we must begin with its core calculation. This first practice challenges you to apply the fundamental formulas to the classic Sod shock tube problem . By computing the eigenvalues and the resulting split fluxes for the initial left and right states, you will gain hands-on experience with the direct mechanics of characteristic-based flux splitting.",
            "id": "3997168",
            "problem": "Consider the one-dimensional inviscid compressible Euler equations used in Computational Fluid Dynamics (CFD), with an ideal gas of constant ratio of specific heats $\\gamma$. A Sod shock tube is initialized at time $t=0$ with left state $\\left(\\rho_L, u_L, p_L\\right) = \\left(1, 0, 1\\right)$ and right state $\\left(\\rho_R, u_R, p_R\\right) = \\left(0.125, 0, 0.1\\right)$, and $\\gamma=1.4$. Using first-principles reasoning from the governing equations and ideal-gas relations, determine the following quantities at $t=0$:\n- the sound speeds $a_L$ and $a_R$,\n- the three characteristic speeds (eigenvalues of the flux Jacobian in the $x$-direction) at $U_L$ and at $U_R$,\n- the Steger–Warming flux-split vectors $F^{+}(U_L)$ and $F^{-}(U_R)$.\n\nAssume the standard conservative-variable form $U = \\left(\\rho, \\rho u, \\rho E\\right)^{\\top}$ and ideal-gas equation of state, and perform a characteristic (eigen) decomposition consistent with Steger–Warming flux splitting. Provide exact values (do not round). Express your final result as a single row vector containing, in order,\n$\\left[a_L,\\ a_R,\\ \\lambda_{-}(U_L),\\ \\lambda_{0}(U_L),\\ \\lambda_{+}(U_L),\\ \\lambda_{-}(U_R),\\ \\lambda_{0}(U_R),\\ \\lambda_{+}(U_R),\\ \\left(F^{+}(U_L)\\right)_1,\\ \\left(F^{+}(U_L)\\right)_2,\\ \\left(F^{+}(U_L)\\right)_3,\\ \\left(F^{-}(U_R)\\right)_1,\\ \\left(F^{-}(U_R)\\right)_2,\\ \\left(F^{-}(U_R)\\right)_3\\right]$. No units are required.",
            "solution": "The user wants to solve a problem on Steger-Warming flux splitting based on given initial conditions for a Sod shock tube problem.\n\n### Step 1: Problem Validation\n\nThe problem is examined against the specified validation criteria.\n\n**1. Extracted Givens:**\n- **Governing Equations:** 1D inviscid compressible Euler equations.\n- **Gas Model:** Ideal gas with a constant ratio of specific heats $\\gamma = 1.4$.\n- **Problem Setup:** Sod shock tube at $t=0$.\n- **Left State:** $(\\rho_L, u_L, p_L) = (1, 0, 1)$.\n- **Right State:** $(\\rho_R, u_R, p_R) = (0.125, 0, 0.1)$.\n- **Conservative Variables:** $U = (\\rho, \\rho u, \\rho E)^{\\top}$.\n- **Equation of State:** Ideal gas, $p = (\\gamma - 1)(\\rho E - \\frac{1}{2}\\rho u^2)$.\n- **Task:** Determine $a_L$, $a_R$, the eigenvalues of the flux Jacobian at $U_L$ and $U_R$, and the flux-split vectors $F^{+}(U_L)$ and $F^{-}(U_R)$ using Steger-Warming splitting.\n- **Output Format:** A single row vector of $14$ specified quantities.\n\n**2. Validation using Extracted Givens:**\n- **Scientific Grounding:** The problem is firmly rooted in the fundamental principles of fluid dynamics, specifically the Euler equations, ideal gas physics, and the theory of characteristics. The Steger–Warming flux-splitting scheme is a standard, well-documented method in computational fluid dynamics (CFD). All aspects are scientifically sound.\n- **Well-Posedness:** The initial conditions are fully specified, and the quantities to be determined are direct, unique consequences of these conditions and the governing equations. The problem is well-posed.\n- **Objectivity:** The problem is stated using precise, unambiguous mathematical and physical terminology. There are no subjective elements.\n- **Flaw Checklist:**\n    - No scientific or factual unsoundness.\n    - Directly relevant to the specified topic of Steger-Warming splitting.\n    - The setup is complete and consistent.\n    - Conditions and data are physically realistic for a shock tube problem.\n    - The problem structure is clear and leads to a unique solution.\n    - The problem is a standard, non-trivial application of CFD theory.\n    - All results are scientifically verifiable.\n\n**3. Verdict and Action:**\nThe problem is valid. A complete solution will be provided.\n\n### Step 2: Solution\n\nThe one-dimensional Euler equations for an inviscid, compressible fluid can be written in conservative form as:\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0\n$$\nwhere $U$ is the vector of conserved variables and $F(U)$ is the flux vector:\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad\nF(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (\\rho E + p)u \\end{pmatrix}\n$$\nHere, $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E$ is the total energy per unit mass. For an ideal gas, the total energy is $E = e + \\frac{1}{2}u^2$, where $e$ is the specific internal energy. The equation of state is given by $p = \\rho (\\gamma-1)e$, which relates pressure to internal energy. This can be expressed in terms of the conservative variables as:\n$$\np = (\\gamma-1) \\left(\\rho E - \\frac{1}{2}\\rho u^2\\right)\n$$\nThe speed of sound, $a$, in an ideal gas is given by:\n$$\na = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\n\n**1. Sound Speeds ($a_L$ and $a_R$)**\n\nWe are given the primitive variables for the left ($L$) and right ($R$) states at $t=0$, and $\\gamma = 1.4$.\n\nFor the left state: $(\\rho_L, u_L, p_L) = (1, 0, 1)$.\nThe speed of sound is:\n$$\na_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 1}{1}} = \\sqrt{1.4}\n$$\n\nFor the right state: $(\\rho_R, u_R, p_R) = (0.125, 0, 0.1)$.\nThe speed of sound is:\n$$\na_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 0.1}{0.125}} = \\sqrt{\\frac{0.14}{0.125}} = \\sqrt{1.12}\n$$\n\n**2. Characteristic Speeds (Eigenvalues)**\n\nThe characteristic speeds are the eigenvalues of the flux Jacobian matrix $A(U) = \\frac{\\partial F}{\\partial U}$. For the 1D Euler equations, these eigenvalues are well-known and are given by:\n$$\n\\lambda_1 = u - a, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + a\n$$\nWe denote these as $\\lambda_{-}$, $\\lambda_{0}$, and $\\lambda_{+}$.\n\nFor the left state $U_L$, with $u_L=0$ and $a_L=\\sqrt{1.4}$:\n$$\n\\lambda_{-}(U_L) = u_L - a_L = 0 - \\sqrt{1.4} = -\\sqrt{1.4}\n$$\n$$\n\\lambda_{0}(U_L) = u_L = 0\n$$\n$$\n\\lambda_{+}(U_L) = u_L + a_L = 0 + \\sqrt{1.4} = \\sqrt{1.4}\n$$\n\nFor the right state $U_R$, with $u_R=0$ and $a_R=\\sqrt{1.12}$:\n$$\n\\lambda_{-}(U_R) = u_R - a_R = 0 - \\sqrt{1.12} = -\\sqrt{1.12}\n$$\n$$\n\\lambda_{0}(U_R) = u_R = 0\n$$\n$$\n\\lambda_{+}(U_R) = u_R + a_R = 0 + \\sqrt{1.12} = \\sqrt{1.12}\n$$\n\n**3. Steger–Warming Flux Splitting**\n\nThe Steger–Warming scheme splits the flux vector $F$ into $F^+$ and $F^-$, corresponding to positive and negative eigenvalues, respectively. This is possible due to the homogeneity property of the Euler flux vector, which allows us to write $F(U) = A(U)U$. The Jacobian $A$ can be diagonalized as $A=S\\Lambda S^{-1}$, where $\\Lambda$ is the diagonal matrix of eigenvalues and $S$ is the matrix of right eigenvectors. The flux can be decomposed as a sum over the characteristic fields:\n$$\nF = \\sum_{i=1}^{3} \\alpha_i \\lambda_i K_i\n$$\nwhere $K_i$ are the right eigenvectors and $\\alpha_i$ are scaling coefficients. For the 1D Euler equations, this decomposition is explicitly:\n$$\nF = \\frac{\\rho}{2\\gamma} \\lambda_1 \\begin{pmatrix} 1 \\\\ u-a \\\\ H-ua \\end{pmatrix} + \\frac{\\rho(\\gamma-1)}{\\gamma} \\lambda_2 \\begin{pmatrix} 1 \\\\ u \\\\ u^2/2 \\end{pmatrix} + \\frac{\\rho}{2\\gamma} \\lambda_3 \\begin{pmatrix} 1 \\\\ u+a \\\\ H+ua \\end{pmatrix}\n$$\nwhere $H$ is the total enthalpy, $H = E + p/\\rho = \\frac{a^2}{\\gamma-1} + \\frac{u^2}{2}$.\nThe split fluxes $F^+$ and $F^-$ are obtained by summing the contributions from positive and negative eigenvalues, respectively:\n$$\nF^{+} = \\sum_{\\lambda_i  0} (\\text{component for } \\lambda_i), \\quad F^{-} = \\sum_{\\lambda_i  0} (\\text{component for } \\lambda_i)\n$$\nNote that for this problem, the middle eigenvalue $\\lambda_2=u$ is zero for both left and right states, so we do not need to consider its contribution to either split flux.\n\n**3a. Calculation of $F^{+}(U_L)$**\n\nFor the left state, the eigenvalues are $\\lambda_-(U_L)=-\\sqrt{1.4}$, $\\lambda_0(U_L)=0$, and $\\lambda_+(U_L)=\\sqrt{1.4}$. The only positive eigenvalue is $\\lambda_+$. Thus, $F^+(U_L)$ consists only of the component associated with $\\lambda_3=\\lambda_+$:\n$$\nF^{+}(U_L) = \\frac{\\rho_L}{2\\gamma} \\lambda_+(U_L) \\begin{pmatrix} 1 \\\\ u_L+a_L \\\\ H_L+u_L a_L \\end{pmatrix}\n$$\nWe have $\\rho_L=1$, $u_L=0$, $\\gamma=1.4$, $\\lambda_+(U_L) = a_L = \\sqrt{1.4}$.\nFirst, calculate $H_L$:\n$$\nH_L = \\frac{a_L^2}{\\gamma-1} + \\frac{u_L^2}{2} = \\frac{1.4}{1.4-1} + 0 = \\frac{1.4}{0.4} = 3.5\n$$\nNow, substitute these values into the expression for $F^+(U_L)$:\n$$\nF^{+}(U_L) = \\frac{1}{2(1.4)} (\\sqrt{1.4}) \\begin{pmatrix} 1 \\\\ 0+\\sqrt{1.4} \\\\ 3.5+0 \\end{pmatrix} = \\frac{\\sqrt{1.4}}{2.8} \\begin{pmatrix} 1 \\\\ \\sqrt{1.4} \\\\ 3.5 \\end{pmatrix}\n$$\nThe components are:\n$$\n(F^{+}(U_L))_1 = \\frac{\\sqrt{1.4}}{2.8}\n$$\n$$\n(F^{+}(U_L))_2 = \\frac{\\sqrt{1.4}}{2.8} \\times \\sqrt{1.4} = \\frac{1.4}{2.8} = 0.5\n$$\n$$\n(F^{+}(U_L))_3 = \\frac{\\sqrt{1.4}}{2.8} \\times 3.5 = \\frac{3.5}{2.8}\\sqrt{1.4} = 1.25\\sqrt{1.4}\n$$\n\n**3b. Calculation of $F^{-}(U_R)$**\n\nFor the right state, the eigenvalues are $\\lambda_-(U_R)=-\\sqrt{1.12}$, $\\lambda_0(U_R)=0$, and $\\lambda_+(U_R)=\\sqrt{1.12}$. The only negative eigenvalue is $\\lambda_-$. Thus, $F^-(U_R)$ consists only of the component associated with $\\lambda_1=\\lambda_-$:\n$$\nF^{-}(U_R) = \\frac{\\rho_R}{2\\gamma} \\lambda_-(U_R) \\begin{pmatrix} 1 \\\\ u_R-a_R \\\\ H_R-u_R a_R \\end{pmatrix}\n$$\nWe have $\\rho_R=0.125$, $u_R=0$, $\\gamma=1.4$, $\\lambda_-(U_R) = -a_R = -\\sqrt{1.12}$.\nFirst, calculate $H_R$:\n$$\nH_R = \\frac{a_R^2}{\\gamma-1} + \\frac{u_R^2}{2} = \\frac{1.12}{1.4-1} + 0 = \\frac{1.12}{0.4} = 2.8\n$$\nNow, substitute these values into the expression for $F^-(U_R)$:\n$$\nF^{-}(U_R) = \\frac{0.125}{2(1.4)} (-\\sqrt{1.12}) \\begin{pmatrix} 1 \\\\ 0-\\sqrt{1.12} \\\\ 2.8-0 \\end{pmatrix} = -\\frac{0.125\\sqrt{1.12}}{2.8} \\begin{pmatrix} 1 \\\\ -\\sqrt{1.12} \\\\ 2.8 \\end{pmatrix}\n$$\nThe components are:\n$$\n(F^{-}(U_R))_1 = -\\frac{0.125\\sqrt{1.12}}{2.8} = -\\frac{\\sqrt{1.12}}{22.4}\n$$\n$$\n(F^{-}(U_R))_2 = -\\frac{0.125\\sqrt{1.12}}{2.8} \\times (-\\sqrt{1.12}) = \\frac{0.125 \\times 1.12}{2.8} = 0.05\n$$\n$$\n(F^{-}(U_R))_3 = -\\frac{0.125\\sqrt{1.12}}{2.8} \\times 2.8 = -0.125\\sqrt{1.12}\n$$\n\n**4. Final Result Vector**\n\nWe assemble the $14$ computed quantities into a single row vector as requested. For exactness, we use fractional and radical forms where appropriate.\n$\\gamma = 1.4 = \\frac{7}{5}$.\n$a_L = \\sqrt{1.4} = \\sqrt{\\frac{7}{5}}$.\n$a_R = \\sqrt{1.12} = \\sqrt{\\frac{28}{25}} = \\frac{2\\sqrt{7}}{5}$.\n$(F^{+}(U_L))_1 = \\frac{\\sqrt{1.4}}{2.8} = \\frac{\\sqrt{7/5}}{14/5} = \\frac{\\sqrt{7}/\\sqrt{5}}{14/5} = \\frac{\\sqrt{35}}{14}$.\n$(F^{+}(U_L))_2 = 0.5 = \\frac{1}{2}$.\n$(F^{+}(U_L))_3 = 1.25\\sqrt{1.4} = \\frac{5}{4}\\sqrt{\\frac{7}{5}} = \\frac{\\sqrt{25}}{4} \\frac{\\sqrt{7}}{\\sqrt{5}} = \\frac{\\sqrt{125 \\times 7 / 25}}{4} = \\frac{\\sqrt{35}}{4}$.\n$(F^{-}(U_R))_1 = -\\frac{\\sqrt{1.12}}{22.4} = -\\frac{2\\sqrt{7}/5}{112/5} = -\\frac{2\\sqrt{7}}{112} = -\\frac{\\sqrt{7}}{56}$.\n$(F^{-}(U_R))_2 = 0.05 = \\frac{1}{20}$.\n$(F^{-}(U_R))_3 = -0.125\\sqrt{1.12} = -\\frac{1}{8}\\frac{2\\sqrt{7}}{5} = -\\frac{\\sqrt{7}}{20}$.\n\nThe final vector elements are:\n$[a_L, a_R, \\lambda_{-}(U_L), \\lambda_{0}(U_L), \\lambda_{+}(U_L), \\lambda_{-}(U_R), \\lambda_{0}(U_R), \\lambda_{+}(U_R), (F^{+}(U_L))_1, (F^{+}(U_L))_2, (F^{+}(U_L))_3, (F^{-}(U_R))_1, (F^{-}(U_R))_2, (F^{-}(U_R))_3]$\n$= [\\sqrt{\\frac{7}{5}}, \\frac{2\\sqrt{7}}{5}, -\\sqrt{\\frac{7}{5}}, 0, \\sqrt{\\frac{7}{5}}, -\\frac{2\\sqrt{7}}{5}, 0, \\frac{2\\sqrt{7}}{5}, \\frac{\\sqrt{35}}{14}, \\frac{1}{2}, \\frac{\\sqrt{35}}{4}, -\\frac{\\sqrt{7}}{56}, \\frac{1}{20}, -\\frac{\\sqrt{7}}{20}]$.\nAlternatively, using the exact decimal values provided in the problem statement:\n$[ \\sqrt{1.4}, \\sqrt{1.12}, -\\sqrt{1.4}, 0, \\sqrt{1.4}, -\\sqrt{1.12}, 0, \\sqrt{1.12}, \\frac{\\sqrt{1.4}}{2.8}, 0.5, 1.25\\sqrt{1.4}, -\\frac{\\sqrt{1.12}}{22.4}, 0.05, -0.125\\sqrt{1.12} ]$.\nBoth forms are exact. Given the nature of scientific computation, the decimal-based radical form is common and directly relates to the input values. It will be used for the final answer.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{1.4}  \\sqrt{1.12}  -\\sqrt{1.4}  0  \\sqrt{1.4}  -\\sqrt{1.12}  0  \\sqrt{1.12}  \\frac{\\sqrt{1.4}}{2.8}  0.5  1.25\\sqrt{1.4}  -\\frac{\\sqrt{1.12}}{22.4}  0.05  -0.125\\sqrt{1.12} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The original Steger-Warming scheme, while elegant, possesses a known flaw: its inability to correctly handle sonic points, often producing entropy-violating expansion shocks. This practice delves into the standard remedy, the \"entropy fix\" . You will quantitatively explore how a small modification to the eigenvalue calculation near zero restores numerical robustness and ensures physical solutions.",
            "id": "3997178",
            "problem": "Consider one-dimensional inviscid compressible flow governed by the Euler equations for an ideal gas with ratio of specific heats $\\gamma$. The conservative variables are $U = [\\rho, \\rho u, \\rho E]^{\\top}$, and the corresponding flux vector is $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$, where $p$ is the thermodynamic pressure, $u$ is the velocity, and $E$ is the specific total energy. The Jacobian $\\partial F / \\partial U$ has three real eigenvalues $\\lambda_{1} = u - a$, $\\lambda_{2} = u$, and $\\lambda_{3} = u + a$, where $a$ is the speed of sound. In the Steger–Warming flux splitting, the split is performed on the characteristic speeds using their positive and negative parts. In many implementations, an entropy fix is applied by replacing $|\\lambda|$ with a smoothed magnitude. Assume the entropy fix modifies the absolute value according to $|\\lambda| \\mapsto \\sqrt{\\lambda^{2} + \\epsilon^{2}}$, with $\\epsilon = 0.1 a$.\n\nTake a uniform state with Mach number $M = u/a = 0.05$ so that $u = 0.05 a$. Focus on the contact mode, for which the eigenvalue is $\\lambda_{2} = u$. Define the unmodified positive split speed as $\\lambda_{2}^{+} = \\tfrac{1}{2}(\\lambda_{2} + |\\lambda_{2}|)$ and the entropy-fixed positive split speed as $\\lambda_{2,\\epsilon}^{+} = \\tfrac{1}{2}(\\lambda_{2} + \\sqrt{\\lambda_{2}^{2} + \\epsilon^{2}})$. Compute the ratio $R = \\lambda_{2,\\epsilon}^{+} / \\lambda_{2}^{+}$ for the given state. Express the final ratio as a dimensionless number and round your answer to four significant figures.\n\nIn addition to computing $R$, explain in words how the entropy fix changes the split fluxes near the contact mode compared to the unmodified splitting, relying on foundational properties of the Euler equations and characteristic decomposition, but do not provide any shortcut formulae beyond the definitions above.",
            "solution": "The problem statement is critically validated and found to be scientifically grounded, well-posed, and objective. It is a standard problem in the analysis of numerical methods for computational fluid dynamics, specifically concerning the Steger–Warming flux-vector splitting for the Euler equations. All necessary definitions and data are provided, and there are no contradictions or ambiguities.\n\nWe are tasked with computing the ratio $R = \\lambda_{2,\\epsilon}^{+} / \\lambda_{2}^{+}$ and explaining the role of the entropy fix.\n\nFirst, we compute the numerical ratio $R$.\nThe given state is a uniform flow with a Mach number $M = u/a = 0.05$. This implies the fluid velocity is $u = 0.05 a$.\nThe eigenvalue for the contact mode is given as $\\lambda_{2} = u$.\nTherefore, $\\lambda_{2} = 0.05 a$.\n\nThe unmodified positive split speed, $\\lambda_{2}^{+}$, is defined as:\n$$\n\\lambda_{2}^{+} = \\frac{1}{2}(\\lambda_{2} + |\\lambda_{2}|)\n$$\nSince the speed of sound $a$ is inherently positive, $\\lambda_{2} = 0.05 a$ is a positive value. Thus, $|\\lambda_{2}| = \\lambda_{2}$.\nSubstituting this into the definition, we get:\n$$\n\\lambda_{2}^{+} = \\frac{1}{2}(\\lambda_{2} + \\lambda_{2}) = \\lambda_{2} = 0.05 a\n$$\n\nThe entropy-fixed positive split speed, $\\lambda_{2,\\epsilon}^{+}$, is defined with the modification $|\\lambda| \\mapsto \\sqrt{\\lambda^{2} + \\epsilon^{2}}$. The definition is:\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(\\lambda_{2} + \\sqrt{\\lambda_{2}^{2} + \\epsilon^{2}})\n$$\nWe are given that the entropy fix parameter is $\\epsilon = 0.1 a$.\nNow, we substitute the values of $\\lambda_{2}$ and $\\epsilon$ into this expression:\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(0.05 a + \\sqrt{(0.05 a)^{2} + (0.1 a)^{2}})\n$$\nWe can factor out $a$ from the square root:\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(0.05 a + \\sqrt{0.0025 a^{2} + 0.01 a^{2}}) = \\frac{1}{2}(0.05 a + \\sqrt{0.0125 a^{2}})\n$$\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(0.05 a + a\\sqrt{0.0125}) = \\frac{a}{2}(0.05 + \\sqrt{0.0125})\n$$\nThe problem asks for the ratio $R = \\lambda_{2,\\epsilon}^{+} / \\lambda_{2}^{+}$.\n$$\nR = \\frac{\\frac{a}{2}(0.05 + \\sqrt{0.0125})}{0.05 a}\n$$\nThe term $a$ cancels out, leaving a dimensionless ratio:\n$$\nR = \\frac{0.05 + \\sqrt{0.0125}}{2 \\times 0.05} = \\frac{0.05 + \\sqrt{0.0125}}{0.1}\n$$\nTo simplify the numerical calculation, we can express the parameters in terms of a base value. Let $M=0.05$, so $u=Ma$ and $\\epsilon = (0.1/0.05)Ma = 2Ma$. This is incorrect. $\\epsilon = 0.1a = (0.1/0.05)u = 2u$. Let's restart this alternative calculation.\nGiven $\\lambda_2 = u$ and $\\epsilon=0.1a$. Since $u=0.05a$, we have $\\epsilon=2u=2\\lambda_2$.\nThen $\\lambda_2^+ = \\lambda_2$.\nAnd $\\lambda_{2,\\epsilon}^+ = \\frac{1}{2}(\\lambda_2 + \\sqrt{\\lambda_2^2 + \\epsilon^2}) = \\frac{1}{2}(\\lambda_2 + \\sqrt{\\lambda_2^2 + (2\\lambda_2)^2}) = \\frac{1}{2}(\\lambda_2 + \\sqrt{5\\lambda_2^2}) = \\frac{\\lambda_2}{2}(1+\\sqrt{5})$.\nThe ratio is:\n$$\nR = \\frac{\\frac{\\lambda_2}{2}(1+\\sqrt{5})}{\\lambda_2} = \\frac{1+\\sqrt{5}}{2}\n$$\nThis is the golden ratio, $\\phi$.\nNow we compute its numerical value:\n$$\nR = \\frac{1 + \\sqrt{5}}{2} \\approx \\frac{1 + 2.2360679...}{2} = \\frac{3.2360679...}{2} \\approx 1.6180339...\n$$\nRounding to four significant figures, we get $R = 1.618$.\n\nNext, we provide the conceptual explanation for the entropy fix.\n\nThe Steger–Warming flux splitting method is founded on the characteristic-based nature of hyperbolic systems like the Euler equations. Information propagates along characteristics at speeds given by the eigenvalues of the flux Jacobian. The method splits the flux vector $F$ into components $F^{+}$ and $F^{-}$, where $F^{+}$ corresponds to information moving in the positive direction (associated with positive eigenvalues) and $F^{-}$ corresponds to information moving in the negative direction (associated with negative eigenvalues). This allows for an upwind discretization, which properly respects the direction of signal propagation and enhances numerical stability.\n\nThe splitting is based on the sign of the eigenvalues $\\lambda$. The unmodified split uses the absolute value function, $|\\lambda|$, to separate the positive and negative contributions, for instance, via $\\lambda^{+} = \\frac{1}{2}(\\lambda + |\\lambda|)$. The function $|\\lambda|$ is not differentiable at $\\lambda=0$. This lack of smoothness in the splitting function is the root of the problem. When an eigenvalue is very close to zero, for example, for a stationary or slowly moving contact wave where $\\lambda_2 = u \\approx 0$, any small numerical perturbation can cause its sign to flip. This flip causes an abrupt change in the split fluxes: the portion of the flux associated with that characteristic is suddenly switched from being entirely in $F^{-}$ to entirely in $F^{+}$. This discontinuous behavior of the split fluxes as a function of the flow state can introduce numerical oscillations and unphysical solutions, such as expansion shocks, particularly at sonic points or stationary contact discontinuities.\n\nThe entropy fix addresses this pathology by replacing the non-smooth function $|\\lambda|$ with a continuously differentiable approximation, such as $\\sqrt{\\lambda^{2} + \\epsilon^{2}}$. This modified function is smooth everywhere, including at $\\lambda=0$. For the contact mode, when $u \\approx 0$, the split speeds $\\lambda_{2,\\epsilon}^{+}$ and $\\lambda_{2,\\epsilon}^{-}$ no longer vanish. For instance, at exactly $u=0$, the unmodified split gives $\\lambda_{2}^{+} = 0$ and $\\lambda_2^- = 0$. In contrast, the entropy-fixed split gives $\\lambda_{2,\\epsilon}^{+} = \\epsilon/2$ and $\\lambda_{2,\\epsilon}^{-} = -\\epsilon/2$.\n\nThe consequence of this modification is the introduction of numerical dissipation (or artificial viscosity). By ensuring that both $\\lambda_{\\epsilon}^{+}$ and $\\lambda_{\\epsilon}^{-}$ are non-zero in a small region around $\\lambda=0$, the scheme allows information to \"propagate\" or \"smear\" in both directions, even for a nearly stationary wave. This dissipation damps oscillations and stabilizes the numerical solution by smoothing out the sharp, unphysical features that would otherwise arise from the discontinuous splitting. In essence, the entropy fix ensures that the numerical scheme transitions smoothly from upwind to downwind biasing as a characteristic speed passes through zero, thereby restoring the correct physical behavior and numerical robustness.",
            "answer": "$$\n\\boxed{1.618}\n$$"
        },
        {
            "introduction": "A stable numerical simulation requires careful consideration of time-step size, a constraint governed by the Courant–Friedrichs–Lewy (CFL) condition. This final exercise connects the characteristic speeds, which are central to the Steger-Warming method, to this crucial aspect of practical CFD implementation . You will use the maximum eigenvalues from adjacent states to determine the largest permissible time step for an explicit finite-volume scheme.",
            "id": "3997174",
            "problem": "Consider the one-dimensional Euler equations for a calorically perfect ideal gas in the context of Computational Fluid Dynamics (CFD) and the Steger–Warming flux splitting. At an interface located at $x=x_{i+1/2}$ at time $t=0$, the left and right conservative states are given by $U_L$ and $U_R$, constructed from the following primitive variables:\n- Left state: density $\\rho_L=1.0\\ \\mathrm{kg/m^3}$, velocity $u_L=200\\ \\mathrm{m/s}$, pressure $p_L=1.0\\times 10^{5}\\ \\mathrm{Pa}$.\n- Right state: density $\\rho_R=0.8\\ \\mathrm{kg/m^3}$, velocity $u_R=150\\ \\mathrm{m/s}$, pressure $p_R=8.0\\times 10^{4}\\ \\mathrm{Pa}$.\n\nAssume a calorically perfect ideal gas with ratio of specific heats $\\gamma=1.4$. The conservative variables are $U = \\left[\\rho, \\rho u, \\rho E\\right]^{\\top}$, with total energy per unit mass $E$ related to pressure by $p=(\\gamma-1)\\left(\\rho E-\\tfrac{1}{2}\\rho u^2\\right)$.\n\nStarting from the Euler equations and the definition of the flux Jacobian, determine the characteristic speeds for each side of the interface at $t=0$ and use them to identify the maximum characteristic speed relevant to the Steger–Warming flux splitting at this interface. Then, enforce the Courant–Friedrichs–Lewy (CFL) condition for an explicit finite-volume update with Courant number $\\mathrm{CFL}=0.5$ on a uniform grid with spacing $\\Delta x=0.01\\ \\mathrm{m}$, and compute the largest admissible time step $\\Delta t$ at $t=0$ based on the maximum eigenvalue taken from both $U_L$ and $U_R$. Round your answer to four significant figures and express the final result in seconds.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- Left state primitive variables: $\\rho_L=1.0\\ \\mathrm{kg/m^3}$, $u_L=200\\ \\mathrm{m/s}$, $p_L=1.0\\times 10^{5}\\ \\mathrm{Pa}$.\n- Right state primitive variables: $\\rho_R=0.8\\ \\mathrm{kg/m^3}$, $u_R=150\\ \\mathrm{m/s}$, $p_R=8.0\\times 10^{4}\\ \\mathrm{Pa}$.\n- Ratio of specific heats: $\\gamma=1.4$.\n- Vector of conservative variables: $U=[\\rho,\\ \\rho u,\\ \\rho E]^{\\top}$.\n- Equation of state relating total energy per unit mass $E$ to pressure $p$: $p=(\\gamma-1)\\left(\\rho E-\\tfrac{1}{2}\\rho u^2\\right)$.\n- Courant number for the Courant–Friedrichs–Lewy (CFL) condition: $\\mathrm{CFL}=0.5$.\n- Uniform grid spacing: $\\Delta x=0.01\\ \\mathrm{m}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the one-dimensional Euler equations, a fundamental model in fluid dynamics. The concepts of flux splitting (Steger–Warming), characteristic speeds (eigenvalues), and the CFL stability condition are standard and well-established in the field of Computational Fluid Dynamics (CFD). The values provided are physically realistic for a gas flow.\n- **Well-Posed**: The problem is clearly stated and provides all necessary data and equations to compute a unique numerical answer for the time step $\\Delta t$.\n- **Objective**: The problem is formulated with precise, quantitative language and is free of any subjective or opinion-based statements.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe problem requires the calculation of the maximum admissible time step, $\\Delta t$, for an explicit finite-volume scheme applied to the one-dimensional Euler equations. This time step is constrained by the Courant–Friedrichs–Lewy (CFL) condition, which ensures numerical stability. The CFL condition relates the time step $\\Delta t$, the grid spacing $\\Delta x$, and the maximum speed of information propagation in the system.\n\nThe one-dimensional Euler equations can be written in conservative form as:\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0\n$$\nwhere $U$ is the vector of conserved variables and $F(U)$ is the flux vector. For the purpose of analyzing wave propagation speeds, the system is linearized, leading to:\n$$\n\\frac{\\partial U}{\\partial t} + A(U) \\frac{\\partial U}{\\partial x} = 0\n$$\nwhere $A(U) = \\frac{\\partial F}{\\partial U}$ is the flux Jacobian matrix. The eigenvalues of a given $A(U)$ are the characteristic speeds (or wave speeds) of the system at state $U$. For the $1\\mathrm{D}$ Euler equations, these eigenvalues are:\n$$\n\\lambda_1 = u, \\quad \\lambda_2 = u+a, \\quad \\lambda_3 = u-a\n$$\nwhere $u$ is the fluid velocity and $a$ is the speed of sound. For a calorically perfect ideal gas, the speed of sound is given by:\n$$\na = \\sqrt{\\gamma \\frac{p}{\\rho}}\n$$\nWhile Steger–Warming flux splitting uses the signs of these eigenvalues to split the flux vector, the stability of an explicit time integration scheme is determined by the magnitude of the fastest-moving wave. The spectral radius of the Jacobian, $\\rho(A) = \\max_k |\\lambda_k|$, dictates this speed. For any physical flow, $a > 0$, so the maximum eigenvalue magnitude is:\n$$\n\\max(|\\lambda_1|, |\\lambda_2|, |\\lambda_3|) = \\max(|u|, |u+a|, |u-a|) = |u| + a\n$$\nThe CFL condition for an explicit method on a uniform grid is given by:\n$$\n\\mathrm{CFL} = \\frac{S_{max} \\Delta t}{\\Delta x} \\implies \\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{S_{max}}\n$$\nwhere $S_{max}$ is the maximum wave speed over the entire computational domain. The problem asks for the time step at $t=0$ based on the left and right states at the interface $x_{i+1/2}$. Therefore, $S_{max}$ must be the maximum of the fastest wave speeds from the left and right states.\n$$\nS_{max} = \\max(|u_L| + a_L, |u_R| + a_R)\n$$\nWe proceed by calculating the speed of sound for the left and right states.\n\nFor the left state ($L$):\n- $\\rho_L = 1.0\\ \\mathrm{kg/m^3}$\n- $p_L = 1.0 \\times 10^5\\ \\mathrm{Pa}$\n- $u_L = 200\\ \\mathrm{m/s}$\n- $\\gamma = 1.4$\nThe speed of sound is:\n$$\na_L = \\sqrt{\\gamma \\frac{p_L}{\\rho_L}} = \\sqrt{1.4 \\times \\frac{1.0 \\times 10^5\\ \\mathrm{Pa}}{1.0\\ \\mathrm{kg/m^3}}} = \\sqrt{1.4 \\times 10^5}\\ \\mathrm{m/s} = \\sqrt{140000}\\ \\mathrm{m/s}\n$$\n\nFor the right state ($R$):\n- $\\rho_R = 0.8\\ \\mathrm{kg/m^3}$\n- $p_R = 8.0 \\times 10^4\\ \\mathrm{Pa}$\n- $u_R = 150\\ \\mathrm{m/s}$\n- $\\gamma = 1.4$\nThe speed of sound is:\n$$\na_R = \\sqrt{\\gamma \\frac{p_R}{\\rho_R}} = \\sqrt{1.4 \\times \\frac{8.0 \\times 10^4\\ \\mathrm{Pa}}{0.8\\ \\mathrm{kg/m^3}}} = \\sqrt{1.4 \\times 10^5}\\ \\mathrm{m/s} = \\sqrt{140000}\\ \\mathrm{m/s}\n$$\nThe speed of sound is identical for both states, $a_L = a_R = \\sqrt{140000}\\ \\mathrm{m/s} \\approx 374.1657\\ \\mathrm{m/s}$. Let us denote this common speed of sound as $a$.\n\nNow, we determine the maximum characteristic speed for each side.\nFor the left state, the three characteristic speeds are $u_L=200$, $u_L+a=200+a$, and $u_L-a=200-a$. The maximum magnitude is:\n$$\nS_L = |u_L| + a = |200| + \\sqrt{140000} = 200 + \\sqrt{140000}\\ \\mathrm{m/s}\n$$\n\nFor the right state, the three characteristic speeds are $u_R=150$, $u_R+a=150+a$, and $u_R-a=150-a$. The maximum magnitude is:\n$$\nS_R = |u_R| + a = |150| + \\sqrt{140000} = 150 + \\sqrt{140000}\\ \\mathrm{m/s}\n$$\n\nThe overall maximum wave speed $S_{max}$ is the greater of $S_L$ and $S_R$:\n$$\nS_{max} = \\max(S_L, S_R) = \\max(200 + \\sqrt{140000}, 150 + \\sqrt{140000}) = 200 + \\sqrt{140000}\\ \\mathrm{m/s}\n$$\nNumerically, $S_{max} \\approx 200 + 374.1657 = 574.1657\\ \\mathrm{m/s}$.\n\nFinally, we use the CFL condition to compute the largest admissible time step $\\Delta t$.\nGiven:\n- $\\mathrm{CFL} = 0.5$\n- $\\Delta x = 0.01\\ \\mathrm{m}$\n- $S_{max} = 200 + \\sqrt{140000}\\ \\mathrm{m/s}$\n$$\n\\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{S_{max}} = 0.5 \\times \\frac{0.01\\ \\mathrm{m}}{200 + \\sqrt{140000}\\ \\mathrm{m/s}}\n$$\n$$\n\\Delta t = \\frac{0.005}{200 + \\sqrt{140000}}\\ \\mathrm{s} \\approx \\frac{0.005}{574.1657}\\ \\mathrm{s} \\approx 8.70822 \\times 10^{-6}\\ \\mathrm{s}\n$$\nThe problem asks to round the answer to four significant figures.\n$$\n\\Delta t \\approx 8.708 \\times 10^{-6}\\ \\mathrm{s}\n$$\nThis is the largest time step that can be used at $t=0$ while satisfying the CFL stability criterion with the given parameters.",
            "answer": "$$\\boxed{8.708 \\times 10^{-6}}$$"
        }
    ]
}