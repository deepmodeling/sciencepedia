{
    "hands_on_practices": [
        {
            "introduction": "本练习将重点介绍应用 Steger-Warming 通量分裂的基本步骤。通过解决经典的 Sod 激波管问题 ，你将计算该方法所必需的基本要素——声速、特征速度（即特征值），并最终得到分裂后的通量向量 $F^{+}$ 和 $F^{-}$。该练习旨在为你奠定坚实的计算基础，让你熟练掌握此格式所需的关键量。",
            "id": "3997168",
            "problem": "考虑用于计算流体力学 (CFD) 的一维无粘可压缩欧拉方程，其理想气体的比热比 $\\gamma$ 为常数。一个Sod激波管在时间 $t=0$ 时被初始化，其左侧状态为 $\\left(\\rho_L,u_L,p_L\\right)=\\left(1,0,1\\right)$，右侧状态为 $\\left(\\rho_R,u_R,p_R\\right)=\\left(0.125,0,0.1\\right)$，且 $\\gamma=1.4$。根据控制方程和理想气体关系的第一性原理推导，确定在 $t=0$ 时的以下物理量：\n- 声速 $a_L$ 和 $a_R$，\n- 在 $U_L$ 和 $U_R$ 处的三个特征速度（$x$方向通量雅可比矩阵的特征值），\n- Steger–Warming通量分裂向量 $F^{+}(U_L)$ 和 $F^{-}(U_R)$。\n\n假设采用标准守恒变量形式 $U=\\left(\\rho,\\rho u,\\rho E\\right)^{\\top}$ 和理想气体状态方程，并执行与Steger–Warming通量分裂一致的特征分解。提供精确值（不要四舍五入）。将您的最终结果表示为一个单行向量，按顺序包含，\n$\\left[a_L,\\ a_R,\\ \\lambda_{-}(U_L),\\ \\lambda_{0}(U_L),\\ \\lambda_{+}(U_L),\\ \\lambda_{-}(U_R),\\ \\lambda_{0}(U_R),\\ \\lambda_{+}(U_R),\\ \\left(F^{+}(U_L)\\right)_1,\\ \\left(F^{+}(U_L)\\right)_2,\\ \\left(F^{+}(U_L)\\right)_3,\\ \\left(F^{-}(U_R)\\right)_1,\\ \\left(F^{-}(U_R)\\right)_2,\\ \\left(F^{-}(U_R)\\right)_3\\right]$。不需要单位。",
            "solution": "用户希望根据给定的Sod激波管问题的初始条件，解决一个关于Steger-Warming通量分裂的问题。\n\n### 第1步：问题验证\n\n根据指定的验证标准检查问题。\n\n**1. 提取的已知条件：**\n- **控制方程：** 一维无粘可压缩欧拉方程。\n- **气体模型：** 理想气体，比热比为常数 $\\gamma = 1.4$。\n- **问题设置：** Sod激波管，时间 $t=0$。\n- **左侧状态：** $(\\rho_L, u_L, p_L) = (1, 0, 1)$。\n- **右侧状态：** $(\\rho_R, u_R, p_R) = (0.125, 0, 0.1)$。\n- **守恒变量：** $U = (\\rho, \\rho u, \\rho E)^{\\top}$。\n- **状态方程：** 理想气体，$p = (\\gamma - 1)(\\rho E - \\frac{1}{2}\\rho u^2)$。\n- **任务：** 使用Steger-Warming分裂法确定$a_L$、$a_R$、在$U_L$和$U_R$处的通量雅可比矩阵的特征值，以及通量分裂向量$F^{+}(U_L)$和$F^{-}(U_R)$。\n- **输出格式：** 一个包含14个指定量的单行向量。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题牢固地植根于流体力学的基本原理，特别是欧拉方程、理想气体物理学和特征线理论。Steger–Warming通量分裂格式是计算流体力学（CFD）中一个标准的、有据可查的方法。所有方面都具有科学合理性。\n- **适定性：** 初始条件已完全指定，待求量是这些条件和控制方程的直接、唯一结果。该问题是适定的。\n- **客观性：** 该问题使用精确、无歧义的数学和物理术语进行陈述。没有主观因素。\n- **缺陷清单：**\n    - 无科学或事实上的不合理之处。\n    - 与指定的Steger-Warming分裂主题直接相关。\n    - 设置是完整且一致的。\n    - 对于激波管问题，条件和数据是物理上现实的。\n    - 问题结构清晰，并导向唯一的解。\n    - 该问题是CFD理论的一个标准的、非平凡的应用。\n    - 所有结果都是科学上可验证的。\n\n**3. 结论与行动：**\n问题有效。将提供完整的解答。\n\n### 第2步：解答\n\n一维无粘可压缩流体的欧拉方程可以写成守恒形式：\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0\n$$\n其中 $U$ 是守恒变量向量，$F(U)$ 是通量向量：\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}, \\quad\nF(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (\\rho E + p)u \\end{pmatrix}\n$$\n这里，$\\rho$ 是密度，$u$ 是速度，$p$ 是压力，$E$ 是单位质量的总能量。对于理想气体，总能量为 $E = e + \\frac{1}{2}u^2$，其中 $e$ 是比内能。状态方程由 $p = \\rho (\\gamma-1)e$ 给出，它将压力与内能联系起来。这可以用守恒变量表示为：\n$$\np = (\\gamma-1) \\left(\\rho E - \\frac{1}{2}\\rho u^2\\right)\n$$\n理想气体中的声速 $a$ 由下式给出：\n$$\na = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\n\n**1. 声速 ($a_L$ 和 $a_R$)**\n\n我们已知在 $t=0$ 时左侧 ($L$) 和右侧 ($R$) 状态的原始变量，以及 $\\gamma = 1.4$。\n\n对于左侧状态：$(\\rho_L, u_L, p_L) = (1, 0, 1)$。\n声速为：\n$$\na_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 1}{1}} = \\sqrt{1.4}\n$$\n\n对于右侧状态：$(\\rho_R, u_R, p_R) = (0.125, 0, 0.1)$。\n声速为：\n$$\na_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 0.1}{0.125}} = \\sqrt{\\frac{0.14}{0.125}} = \\sqrt{1.12}\n$$\n\n**2. 特征速度（特征值）**\n\n特征速度是通量雅可比矩阵 $A(U) = \\frac{\\partial F}{\\partial U}$ 的特征值。对于一维欧拉方程，这些特征值是众所周知的，由下式给出：\n$$\n\\lambda_1 = u - a, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + a\n$$\n我们将它们表示为 $\\lambda_{-}$、$\\lambda_{0}$ 和 $\\lambda_{+}$。\n\n对于左侧状态 $U_L$，有 $u_L=0$ 和 $a_L=\\sqrt{1.4}$：\n$$\n\\lambda_{-}(U_L) = u_L - a_L = 0 - \\sqrt{1.4} = -\\sqrt{1.4}\n$$\n$$\n\\lambda_{0}(U_L) = u_L = 0\n$$\n$$\n\\lambda_{+}(U_L) = u_L + a_L = 0 + \\sqrt{1.4} = \\sqrt{1.4}\n$$\n\n对于右侧状态 $U_R$，有 $u_R=0$ 和 $a_R=\\sqrt{1.12}$：\n$$\n\\lambda_{-}(U_R) = u_R - a_R = 0 - \\sqrt{1.12} = -\\sqrt{1.12}\n$$\n$$\n\\lambda_{0}(U_R) = u_R = 0\n$$\n$$\n\\lambda_{+}(U_R) = u_R + a_R = 0 + \\sqrt{1.12} = \\sqrt{1.12}\n$$\n\n**3. Steger–Warming通量分裂**\n\nSteger–Warming格式将通量向量 $F$ 分裂为 $F^+$ 和 $F^-$，分别对应正特征值和负特征值。这之所以可能，是由于欧拉通量向量的齐次性，它允许我们写出 $F(U) = A(U)U$。雅可比矩阵 $A$ 可以被对角化为 $A=S\\Lambda S^{-1}$，其中 $\\Lambda$ 是特征值的对角矩阵，$S$ 是右特征向量矩阵。通量可以分解为特征场上的和：\n$$\nF = \\sum_{i=1}^{3} \\alpha_i \\lambda_i K_i\n$$\n其中 $K_i$ 是右特征向量，$\\alpha_i$ 是缩放系数。对于一维欧拉方程，这个分解明确地是：\n$$\nF = \\frac{\\rho}{2\\gamma} \\lambda_1 \\begin{pmatrix} 1 \\\\ u-a \\\\ H-ua \\end{pmatrix} + \\frac{\\rho(\\gamma-1)}{\\gamma} \\lambda_2 \\begin{pmatrix} 1 \\\\ u \\\\ u^2/2 \\end{pmatrix} + \\frac{\\rho}{2\\gamma} \\lambda_3 \\begin{pmatrix} 1 \\\\ u+a \\\\ H+ua \\end{pmatrix}\n$$\n其中 $H$ 是总焓，$H = E + p/\\rho = \\frac{a^2}{\\gamma-1} + \\frac{u^2}{2}$。\n分裂通量 $F^+$ 和 $F^-$ 分别通过对正特征值和负特征值的贡献求和得到：\n$$\nF^{+} = \\sum_{\\lambda_i > 0} (\\text{component for } \\lambda_i), \\quad F^{-} = \\sum_{\\lambda_i  0} (\\text{component for } \\lambda_i)\n$$\n注意，对于此问题，中间的特征值 $\\lambda_2=u$ 对于左、右两种状态都为零，因此我们不需要考虑它对任一分裂通量的贡献。\n\n**3a. $F^{+}(U_L)$的计算**\n\n对于左侧状态，特征值为 $\\lambda_-(U_L)=-\\sqrt{1.4}$、$\\lambda_0(U_L)=0$ 和 $\\lambda_+(U_L)=\\sqrt{1.4}$。唯一的正特征值是 $\\lambda_+$。因此，$F^+(U_L)$ 仅包含与 $\\lambda_3=\\lambda_+$ 相关的分量：\n$$\nF^{+}(U_L) = \\frac{\\rho_L}{2\\gamma} \\lambda_+(U_L) \\begin{pmatrix} 1 \\\\ u_L+a_L \\\\ H_L+u_L a_L \\end{pmatrix}\n$$\n我们有 $\\rho_L=1$，$u_L=0$，$\\gamma=1.4$，$\\lambda_+(U_L) = a_L = \\sqrt{1.4}$。首先，计算 $H_L$：\n$$\nH_L = \\frac{a_L^2}{\\gamma-1} + \\frac{u_L^2}{2} = \\frac{1.4}{1.4-1} + 0 = \\frac{1.4}{0.4} = 3.5\n$$\n现在，将这些值代入 $F^+(U_L)$ 的表达式中：\n$$\nF^{+}(U_L) = \\frac{1}{2(1.4)} (\\sqrt{1.4}) \\begin{pmatrix} 1 \\\\ 0+\\sqrt{1.4} \\\\ 3.5+0 \\end{pmatrix} = \\frac{\\sqrt{1.4}}{2.8} \\begin{pmatrix} 1 \\\\ \\sqrt{1.4} \\\\ 3.5 \\end{pmatrix}\n$$\n各分量为：\n$$\n(F^{+}(U_L))_1 = \\frac{\\sqrt{1.4}}{2.8}\n$$\n$$\n(F^{+}(U_L))_2 = \\frac{\\sqrt{1.4}}{2.8} \\times \\sqrt{1.4} = \\frac{1.4}{2.8} = 0.5\n$$\n$$\n(F^{+}(U_L))_3 = \\frac{\\sqrt{1.4}}{2.8} \\times 3.5 = \\frac{3.5}{2.8}\\sqrt{1.4} = 1.25\\sqrt{1.4}\n$$\n\n**3b. $F^{-}(U_R)$的计算**\n\n对于右侧状态，特征值为 $\\lambda_-(U_R)=-\\sqrt{1.12}$、$\\lambda_0(U_R)=0$ 和 $\\lambda_+(U_R)=\\sqrt{1.12}$。唯一的负特征值是 $\\lambda_-$。因此，$F^-(U_R)$ 仅包含与 $\\lambda_1=\\lambda_-$ 相关的分量：\n$$\nF^{-}(U_R) = \\frac{\\rho_R}{2\\gamma} \\lambda_-(U_R) \\begin{pmatrix} 1 \\\\ u_R-a_R \\\\ H_R-u_R a_R \\end{pmatrix}\n$$\n我们有 $\\rho_R=0.125$，$u_R=0$，$\\gamma=1.4$，$\\lambda_-(U_R) = -a_R = -\\sqrt{1.12}$。首先，计算 $H_R$：\n$$\nH_R = \\frac{a_R^2}{\\gamma-1} + \\frac{u_R^2}{2} = \\frac{1.12}{1.4-1} + 0 = \\frac{1.12}{0.4} = 2.8\n$$\n现在，将这些值代入 $F^-(U_R)$ 的表达式中：\n$$\nF^{-}(U_R) = \\frac{0.125}{2(1.4)} (-\\sqrt{1.12}) \\begin{pmatrix} 1 \\\\ 0-\\sqrt{1.12} \\\\ 2.8-0 \\end{pmatrix} = -\\frac{0.125\\sqrt{1.12}}{2.8} \\begin{pmatrix} 1 \\\\ -\\sqrt{1.12} \\\\ 2.8 \\end{pmatrix}\n$$\n各分量为：\n$$\n(F^{-}(U_R))_1 = -\\frac{0.125\\sqrt{1.12}}{2.8} = -\\frac{\\sqrt{1.12}}{22.4}\n$$\n$$\n(F^{-}(U_R))_2 = -\\frac{0.125\\sqrt{1.12}}{2.8} \\times (-\\sqrt{1.12}) = \\frac{0.125 \\times 1.12}{2.8} = 0.05\n$$\n$$\n(F^{-}(U_R))_3 = -\\frac{0.125\\sqrt{1.12}}{2.8} \\times 2.8 = -0.125\\sqrt{1.12}\n$$\n\n**4. 最终结果向量**\n\n我们按要求将计算出的14个量组合成一个单行向量。为保证精确性，我们酌情使用分数和根式形式。\n$\\gamma = 1.4 = \\frac{7}{5}$。\n$a_L = \\sqrt{1.4} = \\sqrt{\\frac{7}{5}}$。\n$a_R = \\sqrt{1.12} = \\sqrt{\\frac{28}{25}} = \\frac{2\\sqrt{7}}{5}$。\n$(F^{+}(U_L))_1 = \\frac{\\sqrt{1.4}}{2.8} = \\frac{\\sqrt{7/5}}{14/5} = \\frac{\\sqrt{7}/\\sqrt{5}}{14/5} = \\frac{\\sqrt{35}}{14}$。\n$(F^{+}(U_L))_2 = 0.5 = \\frac{1}{2}$。\n$(F^{+}(U_L))_3 = 1.25\\sqrt{1.4} = \\frac{5}{4}\\sqrt{\\frac{7}{5}} = \\frac{\\sqrt{25}}{4} \\frac{\\sqrt{7}}{\\sqrt{5}} = \\frac{\\sqrt{125 \\times 7 / 25}}{4} = \\frac{\\sqrt{35}}{4}$。\n$(F^{-}(U_R))_1 = -\\frac{\\sqrt{1.12}}{22.4} = -\\frac{2\\sqrt{7}/5}{112/5} = -\\frac{2\\sqrt{7}}{112} = -\\frac{\\sqrt{7}}{56}$。\n$(F^{-}(U_R))_2 = 0.05 = \\frac{1}{20}$。\n$(F^{-}(U_R))_3 = -0.125\\sqrt{1.12} = -\\frac{1}{8}\\frac{2\\sqrt{7}}{5} = -\\frac{\\sqrt{7}}{20}$。\n\n最终的向量元素为：\n$[\\sqrt{\\frac{7}{5}}, \\frac{2\\sqrt{7}}{5}, -\\sqrt{\\frac{7}{5}}, 0, \\sqrt{\\frac{7}{5}}, -\\frac{2\\sqrt{7}}{5}, 0, \\frac{2\\sqrt{7}}{5}, \\frac{\\sqrt{35}}{14}, \\frac{1}{2}, \\frac{\\sqrt{35}}{4}, -\\frac{\\sqrt{7}}{56}, \\frac{1}{20}, -\\frac{\\sqrt{7}}{20}]$。\n或者，使用问题陈述中提供的精确小数值：\n$[ \\sqrt{1.4}, \\sqrt{1.12}, -\\sqrt{1.4}, 0, \\sqrt{1.4}, -\\sqrt{1.12}, 0, \\sqrt{1.12}, \\frac{\\sqrt{1.4}}{2.8}, 0.5, 1.25\\sqrt{1.4}, -\\frac{\\sqrt{1.12}}{22.4}, 0.05, -0.125\\sqrt{1.12} ]$。\n两种形式都是精确的。考虑到科学计算的性质，基于小数的根式形式很常见，并且与输入值直接相关。最终答案将使用此形式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{1.4}  \\sqrt{1.12}  -\\sqrt{1.4}  0  \\sqrt{1.4}  -\\sqrt{1.12}  0  \\sqrt{1.12}  \\frac{\\sqrt{1.4}}{2.8}  0.5  1.25\\sqrt{1.4}  -\\frac{\\sqrt{1.12}}{22.4}  0.05  -0.125\\sqrt{1.12} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "掌握了基本计算之后，本练习将探讨一个特殊情况：两个超音速流的对称碰撞 。这个场景以一种极致而清晰的方式，突显了 Steger-Warming 格式的核心“迎风”思想，即信息仅从特征速度为正或为负的方向传来。通过计算界面通量 $F_{i+1/2} = F^{+}(U_{L}) + F^{-}(U_{R})$，你将直观地看到该格式如何正确地捕捉到在纯超音速流动中，通量贡献完全来自各自的上游一侧。",
            "id": "3997134",
            "problem": "考虑理想气体的一维无粘可压缩欧拉方程，其比热比为 $\\gamma$。守恒变量向量为 $U = [\\rho,\\ \\rho u,\\ E]^{\\mathsf{T}}$，对应的通量向量为 $F(U) = [\\rho u,\\ \\rho u^{2} + p,\\ u(E + p)]^{\\mathsf{T}}$。理想气体封闭关系将热力学压力与守恒变量关联起来，其表达式为 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$。在 Steger–Warming 通量分裂格式中，界面 $x_{i+1/2}$ 处的通量定义为 $F_{i+1/2} = F^{+}(U_{L}) + F^{-}(U_{R})$，其中上标表示基于通量雅可比矩阵特征值的正谱贡献和负谱贡献。\n\n给定界面两侧以下物理上一致的左右状态：\n- 单元 $i$ 中的左状态：$\\rho_{L} = 1.000\\ \\mathrm{kg/m^{3}}$，$u_{L} = 800\\ \\mathrm{m/s}$，$p_{L} = 100000\\ \\mathrm{Pa}$。\n- 单元 $i+1$ 中的右状态：$\\rho_{R} = 1.000\\ \\mathrm{kg/m^{3}}$，$u_{R} = -800\\ \\mathrm{m/s}$，$p_{R} = 100000\\ \\mathrm{Pa}$。\n- 比热比：$\\gamma = 1.4$。\n\n请严格地从控制方程和一维欧拉通量雅可比矩阵的谱分解出发，构建 Steger–Warming 分裂通量 $F_{i+1/2} = F^{+}(U_{L}) + F^{-}(U_{R})$，并计算其三个分量以用于初始化单元 $i$ 的有限体积法更新。使用国际单位制（SI）。将三个分量分别以 $\\mathrm{kg/(m^{2}\\,s)}$、$\\mathrm{Pa}$ 和 $\\mathrm{W/m^{2}}$ 为单位表示。将您的最终数值修约到四位有效数字。",
            "solution": "本题要求计算左状态 $U_L$ 和右状态 $U_R$ 之间界面处的 Steger-Warming 通量 $F_{i+1/2}$。该通量的公式为 $F_{i+1/2} = F^{+}(U_{L}) + F^{-}(U_{R})$，其中 $F^{+}$ 和 $F^{-}$ 分别表示与通量雅可比矩阵的正特征值和负特征值相关的通量向量部分。\n\n针对欧拉方程的 Steger-Warming 通量分裂的理论基础依赖于两个关键性质：通量雅可比矩阵的谱分解和通量向量的齐次性。通量雅可比矩阵为 $A(U) = \\frac{\\partial F}{\\partial U}$。作为一个实矩阵，如果它有一组完备的实特征值和对应的特征向量，它就可以被对角化。对于一维欧拉方程，情况正是如此。我们可以写出 $A = S \\Lambda S^{-1}$，其中 $\\Lambda$ 是由特征值组成的对角矩阵，$S$ 是其列向量为 $A$ 的右特征向量的矩阵。\n\n一维欧拉方程的雅可比矩阵 $A$ 的特征值为：\n$$ \\lambda_1 = u-a, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u+a $$\n其中 $u$ 是流体速度，$a$ 是声速，对于理想气体定义为 $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n\nSteger-Warming 格式将特征值矩阵 $\\Lambda$ 分裂成两部分：$\\Lambda^+$ 包含非负特征值，$\\Lambda^-$ 包含负特征值。\n$$ \\Lambda = \\Lambda^+ + \\Lambda^- $$\n其中 $\\Lambda^{\\pm}_{ii} = \\frac{1}{2}(\\lambda_i \\pm |\\lambda_i|)$。这会引起雅可比矩阵的分裂：\n$$ A^{\\pm} = S \\Lambda^{\\pm} S^{-1} $$\n使得 $A = A^+ + A^-$。\n\n欧拉通量向量 $F(U)$ 的一个关键性质是，它是一个关于守恒变量向量 $U=[\\rho, \\rho u, E]^{\\mathsf{T}}$ 的一次齐次函数。根据欧拉齐次函数定理，这意味着通量可以写成其雅可比矩阵和状态向量的乘积：\n$$ F(U) = A(U)U $$\n这个性质使得通量向量本身可以直接对应于雅可比矩阵的分裂而被分裂：\n$$ F^{\\pm}(U) = A^{\\pm}(U)U $$\n因此，任务是分析左右状态的特征值符号，计算相应的分裂通量 $F^{+}(U_{L})$ 和 $F^{-}(U_{R})$，并将它们相加。\n\n首先，我们分析左状态 $U_L$。\n给定的原始变量为 $\\rho_L = 1.0\\ \\mathrm{kg/m^3}$，$u_L = 800\\ \\mathrm{m/s}$ 和 $p_L = 100000\\ \\mathrm{Pa}$。比热比为 $\\gamma = 1.4$。\n左状态的声速为：\n$$ a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times 100000\\ \\mathrm{Pa}}{1.0\\ \\mathrm{kg/m^3}}} = \\sqrt{140000}\\ \\mathrm{m/s} \\approx 374.1657\\ \\mathrm{m/s} $$\n左状态的特征值为：\n$$ \\lambda_{1,L} = u_L - a_L = 800 - 374.1657 = 425.8343\\ \\mathrm{m/s} $$\n$$ \\lambda_{2,L} = u_L = 800\\ \\mathrm{m/s} $$\n$$ \\lambda_{3,L} = u_L + a_L = 800 + 374.1657 = 1174.1657\\ \\mathrm{m/s} $$\n由于 $u_L > a_L$，流动是超音速的，并且所有三个特征值都为正。这意味着 $\\Lambda_L^+ = \\Lambda_L$ 且 $\\Lambda_L^- = 0$。因此，$A^+(U_L) = A(U_L)$ 且 $A^-(U_L) = 0$。\n因此，左状态的分裂通量为 $F^+(U_L) = F(U_L)$ 和 $F^-(U_L) = 0$。\n为了计算 $F(U_L)$，我们首先计算单位体积总能量 $E_L$：\n$$ E_L = \\frac{p_L}{\\gamma - 1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{100000}{1.4 - 1} + \\frac{1}{2}(1.0)(800)^2 = 250000 + 320000 = 570000\\ \\mathrm{J/m^3} $$\n现在，我们计算通量向量 $F(U_L) = \\left[\\rho_L u_L, \\rho_L u_L^2 + p_L, u_L(E_L + p_L)\\right]^{\\mathsf{T}}$：\n$$ F(U_L)_1 = (1.0)(800) = 800\\ \\mathrm{kg/(m^2 s)} $$\n$$ F(U_L)_2 = (1.0)(800)^2 + 100000 = 640000 + 100000 = 740000\\ \\mathrm{Pa} $$\n$$ F(U_L)_3 = (800)(570000 + 100000) = (800)(670000) = 536000000\\ \\mathrm{W/m^2} $$\n所以，$F^+(U_L) = [800, 740000, 536000000]^{\\mathsf{T}}$。\n\n接下来，我们分析右状态 $U_R$。\n给定的原始变量为 $\\rho_R = 1.0\\ \\mathrm{kg/m^3}$，$u_R = -800\\ \\mathrm{m/s}$ 和 $p_R = 100000\\ \\mathrm{Pa}$。\n右状态的声速为：\n$$ a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times 100000\\ \\mathrm{Pa}}{1.0\\ \\mathrm{kg/m^3}}} = \\sqrt{140000}\\ \\mathrm{m/s} \\approx 374.1657\\ \\mathrm{m/s} $$\n右状态的特征值为：\n$$ \\lambda_{1,R} = u_R - a_R = -800 - 374.1657 = -1174.1657\\ \\mathrm{m/s} $$\n$$ \\lambda_{2,R} = u_R = -800\\ \\mathrm{m/s} $$\n$$ \\lambda_{3,R} = u_R + a_R = -800 + 374.1657 = -425.8343\\ \\mathrm{m/s} $$\n由于 $|u_R| > a_R$，流动是反向超音速的，并且所有三个特征值都为负。这意味着 $\\Lambda_R^+ = 0$ 且 $\\Lambda_R^- = \\Lambda_R$。因此，$A^+(U_R) = 0$ 且 $A^-(U_R) = A(U_R)$。\n因此，右状态的分裂通量为 $F^+(U_R) = 0$ 和 $F^-(U_R) = F(U_R)$。\n为了计算 $F(U_R)$，我们首先计算单位体积总能量 $E_R$：\n$$ E_R = \\frac{p_R}{\\gamma - 1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{100000}{1.4 - 1} + \\frac{1}{2}(1.0)(-800)^2 = 250000 + 320000 = 570000\\ \\mathrm{J/m^3} $$\n现在，我们计算通量向量 $F(U_R) = \\left[\\rho_R u_R, \\rho_R u_R^2 + p_R, u_R(E_R + p_R)\\right]^{\\mathsf{T}}$：\n$$ F(U_R)_1 = (1.0)(-800) = -800\\ \\mathrm{kg/(m^2 s)} $$\n$$ F(U_R)_2 = (1.0)(-800)^2 + 100000 = 640000 + 100000 = 740000\\ \\mathrm{Pa} $$\n$$ F(U_R)_3 = (-800)(570000 + 100000) = (-800)(670000) = -536000000\\ \\mathrm{W/m^2} $$\n所以，$F^-(U_R) = [-800, 740000, -536000000]^{\\mathsf{T}}$。\n\n最后，我们通过将相关的分裂通量贡献相加来计算界面通量 $F_{i+1/2}$：\n$$ F_{i+1/2} = F^{+}(U_{L}) + F^{-}(U_{R}) $$\n各分量为：\n$$ F_{i+1/2, 1} = F^{+}(U_L)_1 + F^{-}(U_R)_1 = 800 + (-800) = 0 $$\n$$ F_{i+1/2, 2} = F^{+}(U_L)_2 + F^{-}(U_R)_2 = 740000 + 740000 = 1480000 $$\n$$ F_{i+1/2, 3} = F^{+}(U_L)_3 + F^{-}(U_R)_3 = 536000000 + (-536000000) = 0 $$\n得到的界面通量向量为 $[0, 1480000, 0]^{\\mathsf{T}}$。\n题目要求将结果修约到四位有效数字。\n第一个分量恰好为 $0$。\n第二个分量是 $1480000$，写成四位有效数字的科学记数法是 $1.480 \\times 10^6$。\n第三个分量恰好为 $0$。\n三个分量的单位分别为 $\\mathrm{kg/(m^2 s)}$、$\\mathrm{Pa}$ 和 $\\mathrm{W/m^2}$。\nSteger-Warming 通量 $F_{i+1/2}$ 的三个分量是 $(0, 1.480 \\times 10^6, 0)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1.480 \\times 10^{6}  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "原始的 Steger-Warming 格式虽然简洁优美，但存在局限性，尤其是在特征值接近零时（例如，在声速点或静止的接触间断附近）。这种情况下可能会产生非物理解，例如膨胀激波。本练习  将深入探讨一个关键的改进方法，即“熵修正”。你将通过计算和分析，理解一个对分裂函数微小的修改如何确保数值格式的耗散性，从而抑制振荡并保证解的物理真实性，这是开发稳健 CFD 求解器的关键一步。",
            "id": "3997178",
            "problem": "考虑由理想气体欧拉方程控制的一维无粘可压缩流，其比热比为 $\\gamma$。守恒变量为 $U = [\\rho, \\rho u, \\rho E]^{\\top}$，对应的通量矢量为 $F(U) = [\\rho u, \\rho u^{2} + p, u(\\rho E + p)]^{\\top}$，其中 $p$ 是热力学压力，$u$ 是速度，$E$ 是比总能。雅可比矩阵 $\\partial F / \\partial U$ 有三个实特征值 $\\lambda_{1} = u - a、\\lambda_{2} = u$ 和 $\\lambda_{3} = u + a$，其中 $a$ 是声速。在 Steger–Warming 通量分裂中，分裂是基于特征速度的正部和负部进行的。在许多实现中，会应用熵修正，即将 $|\\lambda|$ 替换为一个平滑的幅值。假设熵修正根据 $|\\lambda| \\mapsto \\sqrt{\\lambda^{2} + \\epsilon^{2}}$ 来修改绝对值，其中 $\\epsilon = 0.1 a$。\n\n考虑一个均匀状态，其马赫数 $M = u/a = 0.05$，因此 $u = 0.05 a$。关注接触模式，其特征值为 $\\lambda_{2} = u$。定义未修正的正分裂速度为 $\\lambda_{2}^{+} = \\tfrac{1}{2}(\\lambda_{2} + |\\lambda_{2}|)$，熵修正后的正分裂速度为 $\\lambda_{2,\\epsilon}^{+} = \\tfrac{1}{2}(\\lambda_{2} + \\sqrt{\\lambda_{2}^{2} + \\epsilon^{2}})$。计算给定状态下的比率 $R = \\lambda_{2,\\epsilon}^{+} / \\lambda_{2}^{+}$。将最终比率表示为无量纲数，并将答案四舍五入到四位有效数字。\n\n除了计算 $R$ 之外，请用文字解释与未修正的分裂相比，熵修正如何改变接触模式附近的分裂通量。解释应基于欧拉方程的基本性质和特征分解，但除上述定义外，不要提供任何简化公式。",
            "solution": "问题陈述经过严格验证，具有科学依据、适定且客观。这是计算流体动力学数值方法分析中的一个标准问题，具体涉及欧拉方程的 Steger–Warming 通量矢量分裂。所有必要的定义和数据均已提供，没有矛盾或歧义。\n\n我们的任务是计算比率 $R = \\lambda_{2,\\epsilon}^{+} / \\lambda_{2}^{+}$ 并解释熵修正的作用。\n\n首先，我们计算数值比率 $R$。\n给定状态为均匀流，马赫数 $M = u/a = 0.05$。这意味着流体速度为 $u = 0.05 a$。\n接触模式的特征值由 $\\lambda_{2} = u$ 给出。因此，$\\lambda_{2} = 0.05 a$。\n\n未修正的正分裂速度 $\\lambda_{2}^{+}$ 定义为：\n$$\n\\lambda_{2}^{+} = \\frac{1}{2}(\\lambda_{2} + |\\lambda_{2}|)\n$$\n由于声速 $a$ 内在为正，$\\lambda_{2} = 0.05 a$ 是一个正值。因此，$|\\lambda_{2}| = \\lambda_{2}$。\n将其代入定义，我们得到：\n$$\n\\lambda_{2}^{+} = \\frac{1}{2}(\\lambda_{2} + \\lambda_{2}) = \\lambda_{2} = 0.05 a\n$$\n\n熵修正后的正分裂速度 $\\lambda_{2,\\epsilon}^{+}$ 是通过修改 $|\\lambda| \\mapsto \\sqrt{\\lambda^{2} + \\epsilon^{2}}$ 来定义的。其定义为：\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(\\lambda_{2} + \\sqrt{\\lambda_{2}^{2} + \\epsilon^{2}})\n$$\n我们已知熵修正参数为 $\\epsilon = 0.1 a$。\n现在，我们将 $\\lambda_{2}$ 和 $\\epsilon$ 的值代入此表达式：\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(0.05 a + \\sqrt{(0.05 a)^{2} + (0.1 a)^{2}})\n$$\n我们可以从平方根中提取因子 $a$：\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(0.05 a + \\sqrt{0.0025 a^{2} + 0.01 a^{2}}) = \\frac{1}{2}(0.05 a + \\sqrt{0.0125 a^{2}})\n$$\n$$\n\\lambda_{2,\\epsilon}^{+} = \\frac{1}{2}(0.05 a + a\\sqrt{0.0125}) = \\frac{a}{2}(0.05 + \\sqrt{0.0125})\n$$\n问题要求计算比率 $R = \\lambda_{2,\\epsilon}^{+} / \\lambda_{2}^{+}$。\n$$\nR = \\frac{\\frac{a}{2}(0.05 + \\sqrt{0.0125})}{0.05 a}\n$$\n项 $a$ 被消去，留下一个无量纲比率：\n$$\nR = \\frac{0.05 + \\sqrt{0.0125}}{2 \\times 0.05} = \\frac{0.05 + \\sqrt{0.0125}}{0.1}\n$$\n为了简化数值计算，我们可以用一个基准值来表示这些参数。设 $M=0.05$，则 $u=Ma$ 且 $\\epsilon = (0.1/0.05)Ma = 2Ma$。\n那么 $\\lambda_2^+ = Ma$。\n且 $\\lambda_{2,\\epsilon}^+ = \\frac{1}{2}(Ma + \\sqrt{(Ma)^2 + (2Ma)^2}) = \\frac{1}{2}(Ma + \\sqrt{M^2a^2 + 4M^2a^2}) = \\frac{1}{2}(Ma + \\sqrt{5M^2a^2}) = \\frac{Ma}{2}(1+\\sqrt{5})$。\n比率为：\n$$\nR = \\frac{\\frac{Ma}{2}(1+\\sqrt{5})}{Ma} = \\frac{1+\\sqrt{5}}{2}\n$$\n这是黄金比例 $\\phi$。\n现在我们计算其数值：\n$$\nR = \\frac{1 + \\sqrt{5}}{2} \\approx \\frac{1 + 2.2360679...}{2} = \\frac{3.2360679...}{2} \\approx 1.6180339...\n$$\n四舍五入到四位有效数字，我们得到 $R = 1.618$。\n\n接下来，我们对熵修正进行概念性解释。\n\nSteger–Warming 通量分裂方法建立在欧拉方程这类双曲系统的基于特征的性质之上。信息沿着特征线以通量雅可比矩阵的特征值给出的速度传播。该方法将通量矢量 $F$ 分裂为分量 $F^{+}$ 和 $F^{-}$，其中 $F^{+}$ 对应于向正方向移动的信息（与正特征值相关），而 $F^{-}$ 对应于向负方向移动的信息（与负特征值相关）。这允许进行迎风离散，从而恰当地遵循信号传播方向并增强数值稳定性。\n\n分裂是基于特征值 $\\lambda$ 的符号。未修正的分裂使用绝对值函数 $|\\lambda|$ 来分离正贡献和负贡献，例如，通过 $\\lambda^{+} = \\frac{1}{2}(\\lambda + |\\lambda|)$。函数 $|\\lambda|$ 在 $\\lambda=0$ 处不可微。分裂函数中的这种不光滑性是问题的根源。当一个特征值非常接近零时，例如，对于静止或缓慢移动的接触波，其中 $\\lambda_2 = u \\approx 0$，任何微小的数值扰动都可能导致其符号翻转。这种翻转会导致分裂通量的突变：与该特征相关的通量部分会突然从完全属于 $F^{-}$ 切换到完全属于 $F^{+}$。分裂通量作为流动状态函数时的这种不连续行为会引入数值振荡和非物理的解，例如膨胀激波，特别是在声速点或静止接触间断处。\n\n熵修正通过用一个连续可微的近似函数（例如 $\\sqrt{\\lambda^{2} + \\epsilon^{2}}$）替换非光滑函数 $|\\lambda|$ 来解决这个病态问题。这个修正后的函数处处光滑，包括在 $\\lambda=0$ 处。对于接触模式，当 $u \\approx 0$ 时，分裂速度 $\\lambda_{2,\\epsilon}^{+}$ 和 $\\lambda_{2,\\epsilon}^{-}$ 不再为零。例如，在 $u=0$ 时，未修正的分裂给出 $\\lambda_{2}^{+} = 0$ 和 $\\lambda_2^- = 0$。相比之下，熵修正后的分裂给出 $\\lambda_{2,\\epsilon}^{+} = \\epsilon/2$ 和 $\\lambda_{2,\\epsilon}^{-} = -\\epsilon/2$。\n\n这种修改的结果是引入了数值耗散（或人工粘性）。通过确保在 $\\lambda=0$ 附近的小区域内 $\\lambda_{\\epsilon}^{+}$ 和 $\\lambda_{\\epsilon}^{-}$ 均不为零，该格式即使对于近乎静止的波，也允许信息向两个方向“传播”或“弥散”。这种耗散抑制了振荡，并通过抹平由不连续分裂可能引起的尖锐、非物理特征来稳定数值解。本质上，熵修正确保了当特征速度穿过零时，数值格式能从迎风偏置平滑过渡到顺风偏置，从而恢复了正确的物理行为和数值鲁棒性。",
            "answer": "$$\n\\boxed{1.618}\n$$"
        }
    ]
}