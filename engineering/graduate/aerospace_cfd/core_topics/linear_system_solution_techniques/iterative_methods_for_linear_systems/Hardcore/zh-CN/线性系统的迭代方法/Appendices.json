{
    "hands_on_practices": [
        {
            "introduction": "要掌握迭代法的精髓，我们首先从一个基础练习开始。本题将带你手动执行雅可比法 (Jacobi method) 的几次迭代，这是一个经典的定点迭代格式。通过解决一个简单的二维线性系统 ，你将直观地感受到迭代法是如何从一个初始猜测出发，一步步逼近真实解的，从而为理解更复杂的迭代策略奠定坚实的基础。",
            "id": "2182317",
            "problem": "在一个简化的经济模型中，两种相互依存的产品（我们称之为产品1和产品2）的均衡价格由一个线性方程组描述。设 $p_1$ 为产品1的价格，$p_2$ 为产品2的价格。当以下方程组成立时，达到均衡条件：\n\n$$\n5p_1 - 2p_2 = 11\n$$\n$$\n-p_1 + 4p_2 = 7\n$$\n\n为了不直接对矩阵求逆来求解这些价格，可以使用一种迭代数值方法。从初始猜测值 $\\mathbf{p}^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始，执行两次完整的雅可比法迭代，以近似求解均衡价格。\n\n计算向量估计值 $\\mathbf{p}^{(2)} = \\begin{pmatrix} p_1^{(2)} \\\\ p_2^{(2)} \\end{pmatrix}$。你的答案应该是一个行矩阵，按顺序包含 $p_1^{(2)}$ 和 $p_2^{(2)}$ 两个分量，并以精确分数形式表示。",
            "solution": "我们将线性系统写成分量形式，并重新整理每个方程，以在左侧分离出变量：\n$$\n5p_{1}-2p_{2}=11 \\;\\;\\Rightarrow\\;\\; p_{1}=\\frac{11+2p_{2}}{5}, \\qquad -p_{1}+4p_{2}=7 \\;\\;\\Rightarrow\\;\\; p_{2}=\\frac{7+p_{1}}{4}.\n$$\n雅可比迭代仅使用前一次的迭代值来更新每个分量。使用初始猜测值 $\\mathbf{p}^{(0)}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$，第一次迭代为\n$$\np_{1}^{(1)}=\\frac{11+2p_{2}^{(0)}}{5}=\\frac{11+0}{5}=\\frac{11}{5}, \\qquad\np_{2}^{(1)}=\\frac{7+p_{1}^{(0)}}{4}=\\frac{7+0}{4}=\\frac{7}{4}.\n$$\n在第二次迭代中使用这些值，\n$$\np_{1}^{(2)}=\\frac{11+2p_{2}^{(1)}}{5}=\\frac{11+2\\cdot\\frac{7}{4}}{5}=\\frac{11+\\frac{7}{2}}{5}=\\frac{\\frac{22}{2}+\\frac{7}{2}}{5}=\\frac{\\frac{29}{2}}{5}=\\frac{29}{10},\n$$\n$$\np_{2}^{(2)}=\\frac{7+p_{1}^{(1)}}{4}=\\frac{7+\\frac{11}{5}}{4}=\\frac{\\frac{35}{5}+\\frac{11}{5}}{4}=\\frac{\\frac{46}{5}}{4}=\\frac{46}{20}=\\frac{23}{10}.\n$$\n因此，经过两次雅可比迭代后，\n$$\n\\mathbf{p}^{(2)}=\\begin{pmatrix}\\frac{29}{10} \\\\ \\frac{23}{10}\\end{pmatrix}.\n$$\n作为按顺序包含两个分量的行矩阵，结果是 $\\begin{pmatrix}\\frac{29}{10}  \\frac{23}{10}\\end{pmatrix}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{29}{10}  \\frac{23}{10} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在计算流体动力学 (CFD) 中，共轭梯度法 (Conjugate Gradient, CG) 是求解对称正定线性系统的首选方法之一。然而，盲目应用任何算法都可能导致错误，理解其理论边界至关重要。这个练习  设计了一个思想实验，通过将共轭梯度法应用于一个非正定矩阵，揭示当其核心假设被违背时算法为何会失效，从而加深你对迭代法适用条件的理解。",
            "id": "3245204",
            "problem": "考虑将共轭梯度（CG）法应用于线性方程组 $A x = b$，其中矩阵 $A$ 是对称但非正定的。CG 方法的经典定义是通过沿着搜索方向 $p_k$ 最小化二次泛函 $\\phi(x) = \\tfrac{1}{2} x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$ 来求解，其中残差为 $r_k = b - A x_k$，初始搜索方向为 $p_0 = r_0$。从基本原理出发，步长 $\\alpha_k$ 是通过关于标量 $\\alpha$ 最小化 $\\phi(x_k + \\alpha p_k)$ 来确定的。\n\n考虑以下具体例子\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}, \n\\quad \nb = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \n\\quad \nx_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n从 $\\phi(x)$ 的定义和沿 $p_k$ 方向最优性的方向导数条件出发，推导出步长 $\\alpha_0$ 关于 $p_0$ 和 $r_0$ 的表达式，并指出当 $A$ 是正定时，哪个分母必须为严格正数。然后，对于给定的 $A$、$b$ 和 $x_0$，计算标量 $p_0^{\\mathsf{T}} A p_0$，并用这个值解释在此情况下 CG 步是否是良定义的，以及为什么该方法对于这个非正定矩阵 $A$ 会失效。\n\n你最终报告的答案应该是 $p_0^{\\mathsf{T}} A p_0$ 的数值。无需四舍五入。",
            "solution": "该问题要求分析将共轭梯度（CG）法应用于线性方程组 $A x = b$ 的情况，其中矩阵 $A$ 是对称但非正定的。我们将首先从基本原理出发推导步长 $\\alpha_k$ 的通用公式，然后将其应用于所给的具体案例，以说明该方法的失效之处。\n\nCG 方法旨在通过最小化二次泛函 $\\phi(x) = \\frac{1}{2} x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$ 来找到解 $x$。该泛函的梯度为 $\\nabla \\phi(x) = A x - b$，即残差 $r = b - A x$ 的负值。该方法通过生成一系列近似解 $x_{k+1} = x_k + \\alpha_k p_k$ 来迭代进行，其中 $p_k$ 是搜索方向，$\\alpha_k$ 是为最小化 $\\phi(x_k + \\alpha_k p_k)$ 而选择的步长。\n\n为了推导 $\\alpha_k$，我们定义一个单变量 $\\alpha$ 的函数：\n$$f(\\alpha) = \\phi(x_k + \\alpha p_k) = \\frac{1}{2} (x_k + \\alpha p_k)^{\\mathsf{T}} A (x_k + \\alpha p_k) - b^{\\mathsf{T}} (x_k + \\alpha p_k)$$\n展开各项，我们得到：\n$$f(\\alpha) = \\frac{1}{2} (x_k^{\\mathsf{T}} A x_k + \\alpha x_k^{\\mathsf{T}} A p_k + \\alpha p_k^{\\mathsf{T}} A x_k + \\alpha^2 p_k^{\\mathsf{T}} A p_k) - b^{\\mathsf{T}} x_k - \\alpha b^{\\mathsf{T}} p_k$$\n由于 $A$ 是对称的，即 $A = A^{\\mathsf{T}}$，标量 $p_k^{\\mathsf{T}} A x_k = (x_k^{\\mathsf{T}} A^{\\mathsf{T}} p_k)^{\\mathsf{T}} = (x_k^{\\mathsf{T}} A p_k)^{\\mathsf{T}} = x_k^{\\mathsf{T}} A p_k$。我们可以按 $\\alpha$ 的幂次对各项进行分组：\n$$f(\\alpha) = \\left(\\frac{1}{2} x_k^{\\mathsf{T}} A x_k - b^{\\mathsf{T}} x_k\\right) + \\alpha (x_k^{\\mathsf{T}} A p_k - b^{\\mathsf{T}} p_k) + \\frac{1}{2} \\alpha^2 (p_k^{\\mathsf{T}} A p_k)$$\n第一项是 $\\phi(x_k)$。关于 $\\alpha$ 的线性项可以使用残差 $r_k = b - A x_k$ 进行改写。\n$$x_k^{\\mathsf{T}} A p_k - b^{\\mathsf{T}} p_k = -(b - A x_k)^{\\mathsf{T}} p_k = -r_k^{\\mathsf{T}} p_k$$\n因此，需要最小化的函数是：\n$$f(\\alpha) = \\phi(x_k) - \\alpha r_k^{\\mathsf{T}} p_k + \\frac{1}{2} \\alpha^2 p_k^{\\mathsf{T}} A p_k$$\n为了找到最小值，我们根据“最优性的方向导数条件”，求其关于 $\\alpha$ 的导数并令其为零：\n$$\\frac{df}{d\\alpha} = -r_k^{\\mathsf{T}} p_k + \\alpha p_k^{\\mathsf{T}} A p_k = 0$$\n求解 $\\alpha$ 得到步长 $\\alpha_k$：\n$$\\alpha_k = \\frac{r_k^{\\mathsf{T}} p_k}{p_k^{\\mathsf{T}} A p_k}$$\n对于第一次迭代（$k=0$），其中搜索方向 $p_0$ 被设置为初始残差 $r_0$，该式变为：\n$$\\alpha_0 = \\frac{r_0^{\\mathsf{T}} r_0}{r_0^{\\mathsf{T}} A r_0}$$\n此表达式中的分母是 $p_k^{\\mathsf{T}} A p_k$。为了使 CG 方法是良定义的，并且步长对应于 $\\phi$ 沿搜索方向的最小值， $f(\\alpha)$ 的二阶导数必须为正：\n$$\\frac{d^2f}{d\\alpha^2} = p_k^{\\mathsf{T}} A p_k > 0$$\n如果 $A$ 是对称正定（SPD）的，那么根据定义，对于任何非零向量 $v$，都有 $v^{\\mathsf{T}} A v > 0$。由于 CG 算法生成的搜索方向 $p_k$ 是非零的（除非已经找到精确解），因此当 $A$ 是 SPD 矩阵时，分母 $p_k^{\\mathsf{T}} A p_k$ 保证为严格正数。\n\n现在我们分析所给的具体案例：\n$$A = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n矩阵 $A$ 是对称的，但其特征值为 $1$ 和 $-1$，所以它不是正定的。\n首先，我们计算初始残差 $r_0$：\n$$r_0 = b - A x_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n初始搜索方向为 $p_0 = r_0$，所以 $p_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n问题要求计算标量 $p_0^{\\mathsf{T}} A p_0$，这是计算步长 $\\alpha_0$ 所需的分母。\n$$p_0^{\\mathsf{T}} A p_0 = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n首先，我们计算乘积 $A p_0$：\n$$A p_0 = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 0 \\cdot 1 \\\\ 0 \\cdot 1 + (-1) \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$$\n现在我们计算最终的内积：\n$$p_0^{\\mathsf{T}} (A p_0) = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = (1)(1) + (1)(-1) = 1 - 1 = 0$$\n因此，分母的值为 $p_0^{\\mathsf{T}} A p_0 = 0$。\n\nCG 步不是良定义的，因为计算步长 $\\alpha_0$ 需要除以这个量。分子是 $r_0^{\\mathsf{T}} p_0 = r_0^{\\mathsf{T}} r_0 = 1^2 + 1^2 = 2$。因此，$\\alpha_0 = \\frac{2}{0}$，这是无定义的。算法在第一次迭代时就失效了。\n\n出现这种失效是因为条件 $p_0^{\\mathsf{T}} A p_0 > 0$ 被违反了。当 $p_0^{\\mathsf{T}} A p_0 = 0$ 时，函数 $f(\\alpha) = \\phi(x_0 + \\alpha p_0)$ 不再是一个凸二次函数。它变成一个线性函数：\n$$f(\\alpha) = \\phi(x_0) - \\alpha (r_0^{\\mathsf{T}} p_0) = \\phi(x_0) - 2\\alpha$$\n一个非常数的线性函数在实数线上没有最小值。CG 方法之所以失败，是因为其核心假设——即它可以在搜索方向上找到二次泛函的最小值——没有得到满足。这揭示了标准 CG 方法仅限于具有对称正定矩阵的系统的根本原因。\n$p_0^{\\mathsf{T}} A p_0$ 的数值是 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "对于求解偏微分方程离散化后产生的大型稀疏线性系统，迭代法的收敛速度往往不尽人意，此时预条件技术便显得至关重要。不完全LU分解 (Incomplete LU factorization, ILU) 是一种基础且高效的预条件子。本练习  要求你为源于二维泊松方程的典型五点中心差分格式矩阵，推导其零填充不完全LU分解 (ILU(0)) 的结构，并计算其存储代价，这对于在实际CFD应用中设计和评估预条件策略是一项核心技能。",
            "id": "3969374",
            "problem": "考虑一个在航空航天计算流体力学(CFD)中用于不可压缩流的投影法所产生的压力泊松方程。该方程在一个矩形域上进行离散，使用均匀笛卡尔网格，其中$x$方向有$N_x$个内部点，$y$方向有$N_y$个内部点，并在边界上施加狄利克雷边界条件。\n\n二阶中心有限体积或有限差分离散导致一个稀疏线性系统 $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$，其中 $\\mathbf{A}$ 对应于标准的二维常系数五点模板。假设未知量采用自然逐行字典序排序，即索引先在行内沿$x$方向增加，然后在行间沿$y$方向增加。\n\n从离散拉普拉斯算子产生的五点模板和高斯消元过程的核心定义出发，为$\\mathbf{A}$构建零填充不完全LU分解，也称为零层级不完全LU分解（ILU），记作$\\text{ILU}(0)$。$\\text{ILU}(0)$的定义是：在执行标准LU分解的过程中，强制要求不保留超出$\\mathbf{A}$原始稀疏模式的任何填充元。设$\\mathbf{L}$的对角线为单位对角线，$\\mathbf{U}$包含分解后的对角线元素。\n\n推导由五点模板和指定排序所决定的$\\mathbf{L}$和$\\mathbf{U}$的非零结构，并仔细论证在无填充约束下，哪些相邻耦合会出现在$\\mathbf{L}$的严格下三角部分和$\\mathbf{U}$的严格上三角部分。然后，计算$\\mathbf{L}$和$\\mathbf{U}$中非零元的总数，记作$\\mathrm{nnz}(\\mathbf{L})+\\mathrm{nnz}(\\mathbf{U})$，并将其表示为关于$N_x$和$N_y$的闭式表达式。\n\n以单个闭式解析表达式的形式给出最终答案。无需四舍五入。该计数没有物理单位。",
            "solution": "该线性系统 $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$ 定义在一个包含 $N_x \\times N_y$ 个内部点的网格上。因此，未知量的总数，即方阵 $\\mathbf{A}$ 的维度，为 $N = N_x N_y$。未知量使用自然字典序方案进行排序，其中对于网格点 $(i,j)$（其中 $i \\in \\{1, \\dots, N_x\\}$，$j \\in \\{1, \\dots, N_y\\}$），其全局索引 $k$ 由 $k = (j-1)N_x + i$ 给出。\n\n矩阵 $\\mathbf{A}$ 代表使用五点模板的离散负拉普拉斯算子。对于一个全局索引为 $k$ 的给定点 $(i,j)$，它与其四个直接相邻的点耦合：\n*   西邻点：$(i-1, j)$，全局索引为 $k-1$（如果 $i > 1$）。\n*   东邻点：$(i+1, j)$，全局索引为 $k+1$（如果 $i  N_x$）。\n*   南邻点：$(i, j-1)$，全局索引为 $k-N_x$（如果 $j > 1$）。\n*   北邻点：$(i, j+1)$，全局索引为 $k+N_x$（如果 $j  N_y$）。\n\n因此，矩阵 $\\mathbf{A}$ 在其主对角线上有非零元素，并在四个偏离主对角线的位置（偏移量为 $\\pm 1$ 和 $\\pm N_x$）有非零元素。\n\n$\\text{ILU}(0)$ 分解 $\\mathbf{A} \\approx \\mathbf{L}\\mathbf{U}$ 的定义是，因子 $\\mathbf{L}$ 和 $\\mathbf{U}$ 的稀疏模式必须是矩阵 $\\mathbf{A}$ 稀疏模式的子集。这意味着在分解过程中，任何落在 $\\mathbf{A}$ 原始非零结构之外的“填充”元素都必须被丢弃。对于五点模板和自然排序，这导致 $\\mathbf{L}$ 和 $\\mathbf{U}$ 的稀疏模式与 $\\mathbf{A}$ 的下三角和上三角部分的稀疏模式完全相同。\n\n*   **$\\mathbf{L}$ 的结构**：$\\mathbf{L}$ 是一个单位下三角矩阵。它的非零元素包括：\n    1.  主对角线：所有元素为1。\n    2.  严格下三角部分：非零元素仅出现在与 $\\mathbf{A}$ 中西邻点和南邻点耦合对应的位置，即偏移量为 $-1$ 和 $-N_x$ 的对角线上。\n\n*   **$\\mathbf{U}$ 的结构**：$\\mathbf{U}$ 是一个上三角矩阵。它的非零元素包括：\n    1.  主对角线：包含分解产生的非零元素。\n    2.  严格上三角部分：非零元素仅出现在与 $\\mathbf{A}$ 中东邻点和北邻点耦合对应的位置，即偏移量为 $+1$ 和 $+N_x$ 的对角线上。\n\n现在我们来计算非零元素的总数 $\\mathrm{nnz}(\\mathbf{L}) + \\mathrm{nnz}(\\mathbf{U})$。\n\n1.  **$\\mathbf{A}$ 的非零元素总数**：\n    *   主对角线：$N = N_x N_y$ 个元素。\n    *   东西向耦合（偏移量 $\\pm 1$）：共有 $N_y$ 行，每行有 $N_x-1$ 个内部耦合对。总共 $2N_y(N_x-1)$ 个非零元素。\n    *   南北向耦合（偏移量 $\\pm N_x$）：共有 $N_x$ 列，每列有 $N_y-1$ 个内部耦合对。总共 $2N_x(N_y-1)$ 个非零元素。\n    *   $\\mathrm{nnz}(\\mathbf{A}) = N_x N_y + 2N_y(N_x-1) + 2N_x(N_y-1) = N_xN_y + 2N_xN_y - 2N_y + 2N_xN_y - 2N_x = 5N_xN_y - 2N_x - 2N_y$。\n\n2.  **$\\mathbf{L}$ 和 $\\mathbf{U}$ 的非零元素总数**：\n    *   $\\mathbf{L}$ 的非零元素：主对角线 ($N$ 个) + 严格下三角部分。\n    *   $\\mathbf{U}$ 的非零元素：主对角线 ($N$ 个) + 严格上三角部分。\n    *   由于 $\\text{ILU}(0)$ 的稀疏模式限制，$\\mathbf{L}$ 和 $\\mathbf{U}$ 的非对角元素之和等于 $\\mathbf{A}$ 的非对角元素之和。\n    *   $\\mathbf{A}$ 的非对角元素总数: $\\mathrm{nnz}(\\mathbf{A}) - N = 4N_xN_y - 2N_x - 2N_y$。\n    *   $\\mathrm{nnz}(\\mathbf{L})$ = (主对角线) + (严格下三角部分) = $N + \\frac{\\mathrm{nnz}(\\mathbf{A}) - N}{2} = N_xN_y + \\frac{4N_xN_y - 2N_x - 2N_y}{2} = N_xN_y + 2N_xN_y - N_x - N_y = 3N_xN_y - N_x - N_y$。\n    *   $\\mathrm{nnz}(\\mathbf{U})$ = (主对角线) + (严格上三角部分) = $N + \\frac{\\mathrm{nnz}(\\mathbf{A}) - N}{2} = 3N_xN_y - N_x - N_y$。\n    *   总数 $\\mathrm{nnz}(\\mathbf{L}) + \\mathrm{nnz}(\\mathbf{U}) = (3N_xN_y - N_x - N_y) + (3N_xN_y - N_x - N_y) = 6N_xN_y - 2N_x - 2N_y$。\n\n因此，$\\mathbf{L}$ 和 $\\mathbf{U}$ 中非零元的总数为 $6N_xN_y - 2N_x - 2N_y$。",
            "answer": "$$\n\\boxed{6N_x N_y - 2N_x - 2N_y}\n$$"
        }
    ]
}