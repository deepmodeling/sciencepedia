{
    "hands_on_practices": [
        {
            "introduction": "在应用任何迭代方法之前，我们必须首先确定它是否会收敛。这项练习  聚焦于迭代法收敛的根本条件——迭代矩阵的谱半径。通过为基础的雅可比法计算这一关键值，你将具体地理解为何某些迭代能够成功，而另一些则会发散，从而掌握评估迭代格式稳定性的核心技能。",
            "id": "2182298",
            "problem": "考虑线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中矩阵 $A$ 和向量 $\\mathbf{b}$ 由下式给出：\n$$\nA = \\begin{pmatrix} 5  2 \\\\ 1  -4 \\end{pmatrix}, \\quad \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 9 \\\\ -2 \\end{pmatrix}\n$$\n雅可比方法是一种用于近似求解该方程组的迭代算法。该方法的收敛性取决于其关联的迭代矩阵 $T_J$ 的谱半径。请计算给定矩阵 $A$ 所对应的谱半径 $\\rho(T_J)$。\n\n将您的最终答案表示为 $\\frac{\\sqrt{N}}{M}$ 形式的精确值，其中 $N$ 和 $M$ 是正整数。",
            "solution": "对于雅可比方法，我们将矩阵 $A$ 分解为 $A = D + R$，其中 $D$ 是 $A$ 的对角部分，而 $R = A - D$。雅可比迭代矩阵为\n$$\nT_{J} = -D^{-1}R = I - D^{-1}A.\n$$\n对于\n$$\nA = \\begin{pmatrix} 5  2 \\\\ 1  -4 \\end{pmatrix},\n$$\n我们有\n$$\nD = \\begin{pmatrix} 5  0 \\\\ 0  -4 \\end{pmatrix}, \\quad D^{-1} = \\begin{pmatrix} \\frac{1}{5}  0 \\\\ 0  -\\frac{1}{4} \\end{pmatrix}.\n$$\n计算\n$$\nD^{-1}A = \\begin{pmatrix} \\frac{1}{5}  0 \\\\ 0  -\\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} 5  2 \\\\ 1  -4 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{2}{5} \\\\ -\\frac{1}{4}  1 \\end{pmatrix},\n$$\n所以\n$$\nT_{J} = I - D^{-1}A = \\begin{pmatrix} 0  -\\frac{2}{5} \\\\ \\frac{1}{4}  0 \\end{pmatrix}.\n$$\n对于形如 $\\begin{pmatrix} 0  a \\\\ b  0 \\end{pmatrix}$ 的矩阵，其特征多项式为 $\\lambda^{2} - ab = 0$，因此特征值为 $\\lambda = \\pm \\sqrt{ab}$。这里 $a = -\\frac{2}{5}$ 且 $b = \\frac{1}{4}$，所以\n$$\nab = -\\frac{2}{20} = -\\frac{1}{10}, \\quad \\lambda^{2} = -\\frac{1}{10}, \\quad \\lambda = \\pm i \\frac{1}{\\sqrt{10}}.\n$$\n因此，谱半径是特征值的最大模，\n$$\n\\rho(T_{J}) = \\left| \\pm i \\frac{1}{\\sqrt{10}} \\right| = \\frac{1}{\\sqrt{10}} = \\frac{\\sqrt{10}}{10}.\n$$",
            "answer": "$$\\boxed{\\frac{\\sqrt{10}}{10}}$$"
        },
        {
            "introduction": "共轭梯度（CG）法是求解工程与物理学中常见的对称正定（SPD）线性方程组的强大工具。这项练习  超越了简单的公式应用，它要求你深入方法的理论根基，探索当关键的对称正定假设不成立时，算法为何会失效。理解这些限制是诊断和解决复杂数值模拟中问题的关键一步。",
            "id": "3245204",
            "problem": "考虑将共轭梯度 (CG) 法应用于线性系统 $A x = b$，其中 $A$ 是对称但非正定的。经典地，CG 方法定义为沿搜索方向 $p_k$ 最小化二次泛函 $\\phi(x) = \\tfrac{1}{2} x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$，其中残差为 $r_k = b - A x_k$，初始搜索方向为 $p_0 = r_0$。从基本原理出发，步长 $\\alpha_k$ 是通过最小化关于标量 $\\alpha$ 的 $\\phi(x_k + \\alpha p_k)$ 来确定的。\n\n使用以下具体例子：\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}, \n\\quad \nb = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \n\\quad \nx_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n从 $\\phi(x)$ 的定义和沿 $p_k$ 方向的方向导数最优性条件出发，推导步长 $\\alpha_0$ 关于 $p_0$ 和 $r_0$ 的表达式，并指出当 $A$ 是正定时，哪个分母必须严格为正。然后，对于给定的 $A$、$b$ 和 $x_0$，计算标量 $p_0^{\\mathsf{T}} A p_0$，并用该值解释在此情况下 CG 步是否是良定义的，以及为什么该方法对于这个非正定矩阵 $A$ 会失效。\n\n你最终报告的答案应该是 $p_0^{\\mathsf{T}} A p_0$ 的数值。无需四舍五入。",
            "solution": "该问题要求分析将共轭梯度 (CG) 法应用于线性系统 $A x = b$ 的情况，其中矩阵 $A$ 是对称但非正定的。我们将首先从基本原理出发推导步长 $\\alpha_k$ 的通用公式，然后将其应用于所提供的具体案例，以证明该方法的失效。\n\nCG 方法旨在通过最小化二次泛函 $\\phi(x) = \\frac{1}{2} x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$ 来找到解 $x$。该泛函的梯度是 $\\nabla \\phi(x) = A x - b$，即残差 $r = b - A x$ 的相反数。该方法通过生成一系列近似解 $x_{k+1} = x_k + \\alpha_k p_k$ 来迭代进行，其中 $p_k$ 是搜索方向，$\\alpha_k$ 是为最小化 $\\phi(x_k + \\alpha_k p_k)$ 而选择的步长。\n\n为了推导 $\\alpha_k$，我们定义一个单变量 $\\alpha$ 的函数：\n$$f(\\alpha) = \\phi(x_k + \\alpha p_k) = \\frac{1}{2} (x_k + \\alpha p_k)^{\\mathsf{T}} A (x_k + \\alpha p_k) - b^{\\mathsf{T}} (x_k + \\alpha p_k)$$\n展开各项，我们得到：\n$$f(\\alpha) = \\frac{1}{2} (x_k^{\\mathsf{T}} A x_k + \\alpha x_k^{\\mathsf{T}} A p_k + \\alpha p_k^{\\mathsf{T}} A x_k + \\alpha^2 p_k^{\\mathsf{T}} A p_k) - b^{\\mathsf{T}} x_k - \\alpha b^{\\mathsf{T}} p_k$$\n由于 $A$ 是对称的，即 $A = A^{\\mathsf{T}}$，标量 $p_k^{\\mathsf{T}} A x_k = (x_k^{\\mathsf{T}} A^{\\mathsf{T}} p_k)^{\\mathsf{T}} = (x_k^{\\mathsf{T}} A p_k)^{\\mathsf{T}} = x_k^{\\mathsf{T}} A p_k$。我们可以按 $\\alpha$ 的幂次对各项进行分组：\n$$f(\\alpha) = \\left(\\frac{1}{2} x_k^{\\mathsf{T}} A x_k - b^{\\mathsf{T}} x_k\\right) + \\alpha (x_k^{\\mathsf{T}} A p_k - b^{\\mathsf{T}} p_k) + \\frac{1}{2} \\alpha^2 (p_k^{\\mathsf{T}} A p_k)$$\n第一项是 $\\phi(x_k)$。关于 $\\alpha$ 的线性项可以使用残差 $r_k = b - A x_k$ 进行重写。\n$$x_k^{\\mathsf{T}} A p_k - b^{\\mathsf{T}} p_k = -(b - A x_k)^{\\mathsf{T}} p_k = -r_k^{\\mathsf{T}} p_k$$\n所以，要最小化的函数是：\n$$f(\\alpha) = \\phi(x_k) - \\alpha r_k^{\\mathsf{T}} p_k + \\frac{1}{2} \\alpha^2 p_k^{\\mathsf{T}} A p_k$$\n为了找到最小值，我们按照“方向导数最优性条件”的要求，对 $\\alpha$ 求导并令其为零：\n$$\\frac{df}{d\\alpha} = -r_k^{\\mathsf{T}} p_k + \\alpha p_k^{\\mathsf{T}} A p_k = 0$$\n解出 $\\alpha$ 得到步长 $\\alpha_k$：\n$$\\alpha_k = \\frac{r_k^{\\mathsf{T}} p_k}{p_k^{\\mathsf{T}} A p_k}$$\n对于第一次迭代 ($k=0$)，其中搜索方向 $p_0$ 被设置为初始残差 $r_0$，该式变为：\n$$\\alpha_0 = \\frac{r_0^{\\mathsf{T}} r_0}{r_0^{\\mathsf{T}} A r_0}$$\n该表达式中的分母是 $p_k^{\\mathsf{T}} A p_k$。为了使 CG 方法是良定义的，并使步长对应于 $\\phi$ 沿搜索方向的最小值， $f(\\alpha)$ 的二阶导数必须为正：\n$$\\frac{d^2f}{d\\alpha^2} = p_k^{\\mathsf{T}} A p_k  0$$\n如果 $A$ 是对称正定 (SPD) 的，那么根据定义，对于任何非零向量 $v$，都有 $v^{\\mathsf{T}} A v  0$。由于 CG 算法生成的搜索方向 $p_k$ 是非零的（除非已经找到精确解），因此当 $A$ 是 SPD 时，分母 $p_k^{\\mathsf{T}} A p_k$ 保证严格为正。\n\n现在我们分析所提供的具体案例：\n$$A = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n矩阵 $A$ 是对称的，但其特征值为 $1$ 和 $-1$，所以它不是正定的。\n首先，我们计算初始残差 $r_0$：\n$$r_0 = b - A x_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n初始搜索方向为 $p_0 = r_0$，所以 $p_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n问题要求计算标量 $p_0^{\\mathsf{T}} A p_0$，这是计算步长 $\\alpha_0$ 所需的分母。\n$$p_0^{\\mathsf{T}} A p_0 = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n首先，我们计算乘积 $A p_0$：\n$$A p_0 = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 0 \\cdot 1 \\\\ 0 \\cdot 1 + (-1) \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$$\n现在我们计算最终的内积：\n$$p_0^{\\mathsf{T}} (A p_0) = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = (1)(1) + (1)(-1) = 1 - 1 = 0$$\n因此，分母的值为 $p_0^{\\mathsf{T}} A p_0 = 0$。\n\nCG 步不是良定义的，因为计算步长 $\\alpha_0$ 需要除以这个量。分子是 $r_0^{\\mathsf{T}} p_0 = r_0^{\\mathsf{T}} r_0 = 1^2 + 1^2 = 2$。因此，$\\alpha_0 = \\frac{2}{0}$，这是未定义的。算法在第一次迭代时就失效了。\n\n出现这种失效是因为条件 $p_0^{\\mathsf{T}} A p_0  0$ 被违反了。当 $p_0^{\\mathsf{T}} A p_0 = 0$ 时，函数 $f(\\alpha) = \\phi(x_0 + \\alpha p_0)$ 不再是一个凸二次函数。它变成了一个线性函数：\n$$f(\\alpha) = \\phi(x_0) - \\alpha (r_0^{\\mathsf{T}} p_0) = \\phi(x_0) - 2\\alpha$$\n一个非常数线性函数在实数轴上没有最小值。CG 方法之所以失败，是因为其核心假设——即它可以在搜索方向上找到二次泛函的最小值——没有得到满足。这揭示了标准 CG 方法仅限于具有对称正定矩阵的系统的根本原因。\n$p_0^{\\mathsf{T}} A p_0$ 的数值是 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "对于计算流体力学（CFD）中的大规模问题，例如压力泊松方程，基础迭代方法的收敛速度往往不尽人意。预处理是提升其效率的关键。这项高级练习  让你为一个源于CFD离散化的典型稀疏矩阵构建不完全LU（ILU）预条件子，通过分析其稀疏结构，你将获得高性能科学计算中不可或缺的实践经验。",
            "id": "3969374",
            "problem": "考虑在航空航天计算流体力学（CFD）中不可压缩流的投影法中出现的压力泊松方程，该方程在一个矩形域上使用均匀笛卡尔网格进行离散，在$x$方向有$N_x$个内部点，在$y$方向有$N_y$个内部点，并且在边界上施加了Dirichlet边界条件。二阶中心有限体积或有限差分离散化导出一个稀疏线性系统$\\mathbf{A}\\mathbf{x}=\\mathbf{b}$，其中$\\mathbf{A}$对应于具有常系数的标准二维五点模板。假设未知数采用自然的按行字典序排序，即索引在行内首先沿$x$方向增加，然后在行间沿$y$方向增加。\n\n从五点模板和高斯消去法程序的核心定义出发，为$\\mathbf{A}$构造零填充不完全LU分解，即零级不完全LU分解（ILU），记为$\\text{ILU}(0)$。$\\text{ILU}(0)$的定义是执行标准的LU分解，同时强制要求在$\\mathbf{A}$的原始稀疏模式之外不保留任何填充（fill-in）。取$\\mathbf{L}$的对角线为单位元素，而$\\mathbf{U}$的对角线承载对角元素。\n\n根据五点模板和指定的排序，推导$\\mathbf{L}$和$\\mathbf{U}$的非零结构，并仔细论证在无填充约束下，哪些相邻耦合项出现在$\\mathbf{L}$的严格下三角部分和$\\mathbf{U}$的严格上三角部分。然后，计算$\\mathbf{L}$和$\\mathbf{U}$中非零项的总数，记为$\\mathrm{nnz}(\\mathbf{L})+\\mathrm{nnz}(\\mathbf{U})$，并将其表示为关于$N_x$和$N_y$的闭式表达式。\n\n请以单个闭式解析表达式的形式提供您的最终答案。无需四舍五入。此计数不附带物理单位。",
            "solution": "此问题要求计算零填充不完全LU分解（ILU(0)）的因子 $\\mathbf{L}$ 和 $\\mathbf{U}$ 中的非零元素总数。ILU(0)的核心思想是，$\\mathbf{L}$ 和 $\\mathbf{U}$ 的非零结构被限制为与原始矩阵 $\\mathbf{A}$ 的非零结构相同。\n\n首先，我们分析矩阵 $\\mathbf{A}$ 的结构。\n1.  **维度**: 矩阵 $\\mathbf{A}$ 的维度为 $N \\times N$，其中 $N = N_x N_y$ 是内部网格点的总数。\n2.  **稀疏结构**: $\\mathbf{A}$ 是一个由五点模板生成的稀疏矩阵。对于一个全局索引为 $k$ 的点，其在矩阵的第 $k$ 行中最多有5个非零项：\n    *   一个对角元素 $A_{k,k}$。\n    *   两个与水平相邻点（东/西）对应的非对角元素。对于自然的按行排序，这些元素是 $A_{k, k-1}$ 和 $A_{k, k+1}$（除非点在网格的左右边界上）。\n    *   两个与垂直相邻点（南/北）对应的非对角元素。对于自然的按行排序，这些元素是 $A_{k, k-N_x}$ 和 $A_{k, k+N_x}$（除非点在网格的上下边界上）。\n3.  **$\\mathbf{A}$ 中的非零元素总数 ($\\mathrm{nnz}(\\mathbf{A})$)**:\n    *   对角元素：$N = N_x N_y$ 个。\n    *   水平耦合（东西向）：在一个 $N_y$ 行的网格中，每行有 $N_x-1$ 对水平相邻点。总共有 $(N_x-1)N_y$ 对。每对贡献2个非零元（$A_{k,k+1}$ 和 $A_{k+1,k}$）。所以有 $2(N_x-1)N_y$ 个水平非对角元。\n    *   垂直耦合（南北向）：在一个 $N_x$ 列的网格中，每列有 $N_y-1$ 对垂直相邻点。总共有 $N_x(N_y-1)$ 对。每对贡献2个非零元（$A_{k,k+N_x}$ 和 $A_{k+N_x,k}$）。所以有 $2N_x(N_y-1)$ 个垂直非对角元。\n    *   总计: $\\mathrm{nnz}(\\mathbf{A}) = N_xN_y + 2(N_x-1)N_y + 2N_x(N_y-1) = N_xN_y + 2N_xN_y - 2N_y + 2N_xN_y - 2N_x = 5N_xN_y - 2N_x - 2N_y$。\n\n接下来，我们分析 ILU(0) 分解的因子 $\\mathbf{L}$ 和 $\\mathbf{U}$。\n1.  **结构**: 根据 ILU(0) 的定义，$\\mathbf{L}$ 的非零模式是 $\\mathbf{A}$ 的严格下三角部分加上对角线，而 $\\mathbf{U}$ 的非零模式是 $\\mathbf{A}$ 的上三角部分（包括对角线）。\n2.  **$\\mathbf{L}$ 中的非零元素**:\n    *   问题规定 $\\mathbf{L}$ 是单位下三角矩阵，所以其对角线上有 $N = N_xN_y$ 个1。\n    *   $\\mathbf{L}$ 的严格下三角部分的非零元与 $\\mathbf{A}$ 的严格下三角部分相同。由于 $\\mathbf{A}$ 是对称的（对于拉普拉斯算子），其非对角元素数量的一半在下三角部分。\n    *   $\\mathbf{A}$ 的非对角元素总数为 $\\mathrm{nnz}(\\mathbf{A}) - N = (5N_xN_y - 2N_x - 2N_y) - N_xN_y = 4N_xN_y - 2N_x - 2N_y$。\n    *   因此，$\\mathbf{L}$ 的严格下三角部分有 $\\frac{1}{2}(4N_xN_y - 2N_x - 2N_y) = 2N_xN_y - N_x - N_y$ 个非零元。\n    *   $\\mathrm{nnz}(\\mathbf{L}) = N + (2N_xN_y - N_x - N_y) = 3N_xN_y - N_x - N_y$。\n3.  **$\\mathbf{U}$ 中的非零元素**:\n    *   问题规定 $\\mathbf{U}$ 的对角线承载对角元素，所以其对角线上有 $N = N_xN_y$ 个非零元。\n    *   $\\mathbf{U}$ 的严格上三角部分的非零元与 $\\mathbf{A}$ 的严格上三角部分相同。其数量为 $2N_xN_y - N_x - N_y$。\n    *   $\\mathrm{nnz}(\\mathbf{U}) = N + (2N_xN_y - N_x - N_y) = 3N_xN_y - N_x - N_y$。\n4.  **$\\mathrm{nnz}(\\mathbf{L}) + \\mathrm{nnz}(\\mathbf{U})$ 的总数**:\n    *   我们将对角线元素在 $\\mathbf{L}$ 和 $\\mathbf{U}$ 中都计算了一次。所以简单相加会重复计算对角线。\n    *   一个更清晰的计算方法是：总数 = ($\\mathbf{L}$的对角线) + ($\\mathbf{U}$的对角线) + ($\\mathbf{L}$的非对角线) + ($\\mathbf{U}$的非对角线)。\n    *   ($\\mathbf{L}$的非对角线) + ($\\mathbf{U}$的非对角线) 就是 $\\mathbf{A}$ 的所有非对角线元素，共 $\\mathrm{nnz}(\\mathbf{A}) - N$ 个。\n    *   $\\mathrm{nnz}(\\mathbf{L}) + \\mathrm{nnz}(\\mathbf{U}) = \\mathrm{nnz}(\\text{diag}(\\mathbf{L})) + \\mathrm{nnz}(\\text{diag}(\\mathbf{U})) + (\\mathrm{nnz}(\\mathbf{A}) - N)$\n    *   $\\mathrm{nnz}(\\mathbf{L}) + \\mathrm{nnz}(\\mathbf{U}) = N + N + (\\mathrm{nnz}(\\mathbf{A}) - N) = N + \\mathrm{nnz}(\\mathbf{A})$\n    *   代入 $\\mathrm{nnz}(\\mathbf{A})$ 的表达式：\n    *   $\\mathrm{nnz}(\\mathbf{L}) + \\mathrm{nnz}(\\mathbf{U}) = N_xN_y + (5N_xN_y - 2N_x - 2N_y) = 6N_xN_y - 2N_x - 2N_y$。\n\n因此，$\\mathbf{L}$ 和 $\\mathbf{U}$ 的非零项总数为 $6N_xN_y - 2N_x - 2N_y$。",
            "answer": "$$\n\\boxed{6N_x N_y - 2N_x - 2N_y}\n$$"
        }
    ]
}