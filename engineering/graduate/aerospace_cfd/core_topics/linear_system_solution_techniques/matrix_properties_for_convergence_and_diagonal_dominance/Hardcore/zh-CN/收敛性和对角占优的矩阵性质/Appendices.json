{
    "hands_on_practices": [
        {
            "introduction": "我们如何将一个离散化的物理系统转化为一个其迭代解法能够保证收敛的线性系统？本练习将引导你完成构建一个鲁棒线性系统的全过程，并展示如何利用伪时间步等数值技术来强制实现严格对角占优这一理想性质 。",
            "id": "3975443",
            "problem": "在一个用于航空航天应用的隐式稳态计算流体动力学(CFD)求解器中，考虑一个一维管道段内由具有恒定物性的稳态对流扩散控制的被动标量输运。密度为 $\\rho$，均匀轴向速度为 $u>0$，有效扩散系数为 $\\Gamma$，横截面积为 $A$，均匀网格间距为 $\\Delta x$。在均匀网格上使用有限体积法(FVM)，其中控制体 $i$ 由西侧(west)和东侧(east)界面界定。设界面质量通量为 $F_{w}=\\rho u A$ 和 $F_{e}=\\rho u A$，扩散导率为 $D_{w}=\\Gamma A/\\Delta x$ 和 $D_{e}=\\Gamma A/\\Delta x$。对流通量采用一阶迎风插值，扩散通量采用中心差分。假设控制体内部没有物理体积源项，且界面质量通量恒定。\n\n1) 从控制体的稳态积分守恒律出发，离散化对流通量和扩散通量，得到内部节点的系数形式线性方程 $a_{P}\\,\\phi_{i}=a_{W}\\,\\phi_{i-1}+a_{E}\\,\\phi_{i+1}+b_{i}$，并在上述假设下，用 $F_{w}$、$F_{e}$、$D_{w}$ 和 $D_{e}$ 表示 $a_{W}$、$a_{E}$ 和 $a_{P}$。证明当 $u>0$ 且无物理源项时，可以得到 $a_{P}=a_{W}+a_{E}$。\n\n2) 为增强迭代求解器的对角占优性，在稳态残差中加入一个伪时间项，每个控制体产生一项 $\\rho V \\left(\\phi_{i}^{n+1}-\\phi_{i}^{n}\\right)/\\Delta t$，其中 $V=A\\,\\Delta x$ 且 $\\Delta t$ 是伪时间步长。证明关于 $\\phi_{i}^{n+1}$ 的线性化会在对角系数上增加一个量 $\\alpha=\\rho V/\\Delta t$，使得更新后的对角系数为 $a_{P}+\\alpha$，而非对角系数保持不变。\n\n3) 设 $A$ 为加入伪时间项后线性系统的系数矩阵，设 $D$ 为其对角矩阵，$D=\\mathrm{diag}(a_{P}+\\alpha)$。考虑通过逆对角矩阵进行左缩放，形成 $\\tilde{A}=D^{-1}A$。证明 $\\tilde{A}$ 的对角元素为1，并根据第(1)部分的假设，推导内部节点所在行 $\\tilde{A}$ 的非对角元素绝对值之和的表达式，即 $s_{i}=\\sum_{j\\neq i}\\left|\\tilde{A}_{ij}\\right|$。仅用 $a_{W}$、$a_{E}$、$a_{P}$ 和 $\\alpha$ 表示 $s_i$。\n\n4) 施加缩放后矩阵按行严格对角占优的充分条件，即对于给定的裕度 $0\\eta1$，有 $s_{i}\\leq 1-\\eta$。对于参数值 $\\rho=1.225$ kg/m$^{3}$、$u=200$ m/s、$\\Gamma=0.5$ kg/(m·s)、$A=1$ m$^{2}$、$\\Delta x=0.01$ m 和 $\\eta=0.2$，计算保证所有内部节点满足 $s_{i}\\leq 1-\\eta$ 的最大伪时间步长 $\\Delta t_{\\max}$。你必须：\n- 使用 $V=A\\,\\Delta x$、$F=\\rho u A$ 和 $D=\\Gamma A/\\Delta x$。\n- 以秒为单位表示 $\\Delta t_{\\max}$ 的最终答案。\n- 将答案四舍五入到四位有效数字。",
            "solution": "该问题被评估为有效，因为它科学地基于计算流体动力学(CFD)的原理，特别是针对对流扩散方程的有限体积法(FVM)。该问题是适定的，具有完整且一致的数据和约束条件，允许进行唯一的、逐步的推导并得出最终的数值答案。语言客观，是工程或物理学数值方法课程中的一个标准的、非平凡的练习题。\n\n**第1部分：离散化与系数推导**\n\n在控制体 $V$ 上，被动标量 $\\phi$ 的稳态守恒定律的积分形式由穿过其边界 $\\partial V$ 的对流通量和扩散通量的平衡给出：\n$$ \\oint_{\\partial V} \\rho \\phi \\vec{u} \\cdot d\\vec{S} - \\oint_{\\partial V} \\Gamma \\nabla\\phi \\cdot d\\vec{S} = 0 $$\n对于一个具有西侧($w$)和东侧($e$)界面的一维控制体 $i$，这简化为：\n$$ \\left( (\\rho u A) \\phi \\right)_e - \\left( (\\rho u A) \\phi \\right)_w - \\left( (\\Gamma A) \\frac{d\\phi}{dx} \\right)_e + \\left( (\\Gamma A) \\frac{d\\phi}{dx} \\right)_w = 0 $$\n使用给定的界面质量通量定义 $F = \\rho u A$ 和扩散导率定义 $D = \\frac{\\Gamma A}{\\Delta x}$，方程变为：\n$$ F_e \\phi_e - F_w \\phi_w - D_e (\\phi_{i+1} - \\phi_i) + D_w (\\phi_i - \\phi_{i-1}) = 0 $$\n这里，我们对扩散通量梯度应用了中心差分。对于对流通量，我们使用一阶迎风插值。由于轴向速度 $u>0$，流动方向是从西到东。因此，界面上的标量值取自上游（西侧）单元：\n- 在东侧界面 $e$，上游节点是 $i$，所以 $\\phi_e = \\phi_i$。\n- 在西侧界面 $w$，上游节点是 $i-1$，所以 $\\phi_w = \\phi_{i-1}$。\n\n将这些代入通量平衡方程：\n$$ F_e \\phi_i - F_w \\phi_{i-1} - D_e(\\phi_{i+1} - \\phi_i) + D_w(\\phi_i - \\phi_{i-1}) = 0 $$\n我们现在重新整理这些项，以匹配指定的形式 $a_{P}\\,\\phi_{i}=a_{W}\\,\\phi_{i-1}+a_{E}\\,\\phi_{i+1}+b_{i}$。按节点索引对各项进行分组：\n$$ (F_e + D_e + D_w)\\phi_i = (F_w + D_w)\\phi_{i-1} + D_e\\phi_{i+1} $$\n通过与所需形式进行比较，我们确定内部节点的系数：\n- $a_W = F_w + D_w$\n- $a_E = D_e$\n- $a_P = F_e + D_e + D_w$\n- $b_i = 0$，因为没有物理源项。\n\n为了证明 $a_P = a_W + a_E$，我们将推导出的非对角系数相加：\n$$ a_W + a_E = (F_w + D_w) + D_e = F_w + D_w + D_e $$\n问题陈述中提到“界面质量通量为 $F_{w}=\\rho u A$ 和 $F_{e}=\\rho u A$”。这意味着 $F_w = F_e$。将 $F_w = F_e$ 代入 $a_W + a_E$ 的表达式中：\n$$ a_W + a_E = F_e + D_w + D_e $$\n这与我们推导出的 $a_P$ 的表达式相同。因此，在给定假设下，对于内部节点，$a_P = a_W + a_E$。\n\n**第2部分：伪时间项与对角增强**\n\n节点 $i$ 的稳态残差为 $R_i = a_{W}\\,\\phi_{i-1}+a_{E}\\,\\phi_{i+1} - a_{P}\\,\\phi_{i}$。对于迭代解，通过添加一个伪瞬态项来修改方程 $R_i=0$：\n$$ \\frac{\\rho V}{\\Delta t} (\\phi_i^{n+1} - \\phi_i^n) = R_i^{n+1} = a_{W}\\,\\phi_{i-1}^{n+1}+a_{E}\\,\\phi_{i+1}^{n+1} - a_{P}\\,\\phi_{i}^{n+1} $$\n其中 $n$ 和 $n+1$ 是伪时间索引。令 $\\alpha = \\frac{\\rho V}{\\Delta t} = \\frac{\\rho A \\Delta x}{\\Delta t}$。重新整理方程，以形成关于 $n+1$ 层未知数的线性系统：\n$$ \\alpha \\phi_i^{n+1} - \\alpha \\phi_i^n = a_W \\phi_{i-1}^{n+1} + a_E \\phi_{i+1}^{n+1} - a_P \\phi_i^{n+1} $$\n将所有带上标 $n+1$ 的项移到左边，将来自 $n$ 层的已知项移到右边，得到：\n$$ a_P \\phi_i^{n+1} + \\alpha \\phi_i^{n+1} - a_W \\phi_{i-1}^{n+1} - a_E \\phi_{i+1}^{n+1} = \\alpha \\phi_i^n $$\n$$ (a_P + \\alpha) \\phi_i^{n+1} = a_W \\phi_{i-1}^{n+1} + a_E \\phi_{i+1}^{n+1} + \\alpha \\phi_i^n $$\n该方程的形式为 $a'_P \\phi_i^{n+1} = a'_W \\phi_{i-1}^{n+1} + a'_E \\phi_{i+1}^{n+1} + S_i^n$。关于 $\\phi^{n+1}$ 的线性系统的矩阵系数为：\n- 对角系数：$a'_P = a_P + \\alpha$。\n- 非对角系数：$a'_W = a_W$ 和 $a'_E = a_E$。\n这表明，添加伪时间项并对 $\\phi^{n+1}$ 进行线性化，会导致在主对角系数 $a_P$ 上增加一个量 $\\alpha$，而非对角系数保持不变。\n\n**第3部分：缩放矩阵的性质**\n\n关于 $\\phi^{n+1}$ 的线性系统可以写成 $A\\phi^{n+1}=b$。对于一个内部行 $i$，矩阵 $A$ 的非零元素为：\n$$ A_{i,i-1} = -a_W, \\quad A_{i,i} = a_P+\\alpha, \\quad A_{i,i+1} = -a_E $$\n对角矩阵 $D$ 定义为 $D_{ii} = A_{ii} = a_P+\\alpha$。左缩放矩阵为 $\\tilde{A} = D^{-1}A$。$\\tilde{A}$ 的第 $i$ 行的元素为：\n- 对角元素：$\\tilde{A}_{ii} = \\frac{A_{ii}}{D_{ii}} = \\frac{a_P+\\alpha}{a_P+\\alpha} = 1$。$\\tilde{A}$ 的对角元素确实为1。\n- 非对角元素：$\\tilde{A}_{i,i-1} = \\frac{A_{i,i-1}}{D_{ii}} = \\frac{-a_W}{a_P+\\alpha}$ 和 $\\tilde{A}_{i,i+1} = \\frac{A_{i,i+1}}{D_{ii}} = \\frac{-a_E}{a_P+\\alpha}$。\n\n第 $i$ 行非对角元素的绝对值之和为 $s_i = \\sum_{j\\neq i}|\\tilde{A}_{ij}|$。\n$$ s_i = |\\tilde{A}_{i,i-1}| + |\\tilde{A}_{i,i+1}| = \\left|\\frac{-a_W}{a_P+\\alpha}\\right| + \\left|\\frac{-a_E}{a_P+\\alpha}\\right| $$\n根据第1部分，$a_W = F_w + D_w$ 且 $a_E = D_e$。由于 $\\rho, u, A, \\Gamma, \\Delta x$ 均为正值，所以 $F_w, D_w, D_e$ 也为正值，这使得 $a_W>0$ 和 $a_E>0$。同样，$a_P = a_W+a_E > 0$ 且 $\\alpha > 0$。因此，可以去掉绝对值符号：\n$$ s_i = \\frac{a_W}{a_P+\\alpha} + \\frac{a_E}{a_P+\\alpha} = \\frac{a_W+a_E}{a_P+\\alpha} $$\n利用第1部分中对于内部节点 $a_P = a_W+a_E$ 的结果，我们可以仅用 $a_P$ 和 $\\alpha$ 来表示 $s_i$：\n$$ s_i = \\frac{a_P}{a_P+\\alpha} $$\n\n**第4部分：最大伪时间步长的计算**\n\n具有裕度 $\\eta$ 的严格对角占优条件是 $s_i \\leq 1-\\eta$。\n$$ \\frac{a_P}{a_P+\\alpha} \\leq 1-\\eta $$\n由于 $a_P > 0$ 且 $a_P+\\alpha > 0$，我们可以重新整理不等式而无需改变其方向：\n$$ a_P \\leq (1-\\eta)(a_P+\\alpha) \\implies a_P \\leq a_P + \\alpha - \\eta a_P - \\eta\\alpha \\implies \\eta a_P \\leq \\alpha(1-\\eta) $$\n由于 $0  \\eta  1$，我们有 $1-\\eta > 0$，因此可以除以它：\n$$ \\alpha \\geq \\frac{\\eta}{1-\\eta} a_P $$\n代入 $\\alpha = \\frac{\\rho A \\Delta x}{\\Delta t}$：\n$$ \\frac{\\rho A \\Delta x}{\\Delta t} \\geq \\frac{\\eta}{1-\\eta} a_P $$\n求解 $\\Delta t$，我们得到一个上界：\n$$ \\Delta t \\leq \\frac{\\rho A \\Delta x (1-\\eta)}{\\eta a_P} $$\n最大伪时间步长 $\\Delta t_{\\max}$ 对应于等式成立的情况：\n$$ \\Delta t_{\\max} = \\frac{\\rho A \\Delta x (1-\\eta)}{\\eta a_P} $$\n我们现在计算数值。给定值为 $\\rho=1.225\\,\\mathrm{kg}/\\mathrm{m}^{3}$、$u=200\\,\\mathrm{m}/\\mathrm{s}$、$\\Gamma=0.5\\,\\mathrm{kg}/(\\mathrm{m}\\cdot\\mathrm{s})$、$A=1\\,\\mathrm{m}^{2}$、$\\Delta x=0.01\\,\\mathrm{m}$ 和 $\\eta=0.2$。\n首先，计算 $F$ 和 $D$：\n$$ F = \\rho u A = (1.225\\,\\mathrm{kg}/\\mathrm{m}^{3})(200\\,\\mathrm{m}/\\mathrm{s})(1\\,\\mathrm{m}^{2}) = 245\\,\\mathrm{kg}/\\mathrm{s} $$\n$$ D = \\frac{\\Gamma A}{\\Delta x} = \\frac{(0.5\\,\\mathrm{kg}/(\\mathrm{m}\\cdot\\mathrm{s}))(1\\,\\mathrm{m}^{2})}{0.01\\,\\mathrm{m}} = 50\\,\\mathrm{kg}/\\mathrm{s} $$\n接下来，计算 $a_P = a_W+a_E$。对于所使用的迎风格式（$u>0$）：\n$$ a_W = F_w + D_w = F+D = 245 + 50 = 295\\,\\mathrm{kg}/\\mathrm{s} $$\n$$ a_E = D_e = D = 50\\,\\mathrm{kg}/\\mathrm{s} $$\n因此，$a_P = a_W + a_E = 295 + 50 = 345\\,\\mathrm{kg}/\\mathrm{s}$。\n项 $\\rho A \\Delta x$ 为：\n$$ \\rho A \\Delta x = (1.225\\,\\mathrm{kg}/\\mathrm{m}^{3})(1\\,\\mathrm{m}^{2})(0.01\\,\\mathrm{m}) = 0.01225\\,\\mathrm{kg} $$\n裕度为 $\\eta=0.2$，所以 $1-\\eta=0.8$。\n现在，将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$ \\Delta t_{\\max} = \\frac{(0.01225\\,\\mathrm{kg})(0.8)}{(0.2)(345\\,\\mathrm{kg}/\\mathrm{s})} = \\frac{0.0098}{69}\\,\\mathrm{s} \\approx 0.0001420289... \\,\\mathrm{s} $$\n四舍五入到四位有效数字，我们得到 $\\Delta t_{\\max} = 0.0001420\\,\\mathrm{s}$。用科学记数法表示，这是 $1.420 \\times 10^{-4}\\,\\mathrm{s}$。",
            "answer": "$$\n\\boxed{1.420 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "严格对角占优为许多迭代方法的收敛性提供了保证，但当一个线性系统仅满足*弱*对角占优时，会发生什么呢？这个练习基于一个周期性流动问题，提供了一个具体的反例，阐释了为什么“严格”这一条件至关重要，以及它的缺失会如何导致收敛停滞 。",
            "id": "3975445",
            "problem": "在计算流体动力学 (CFD) 中，考虑一个被动标量沿着一个封闭的、周期性的一维回路进行的稳态、对流主导输运过程，该回路模拟了航空航天系统中一个简化的放气再循环路径。该回路被离散为$3$个相等的控制体，索引为$i = 1, 2, 3$，并有恒定的正质量通量$F  0$沿$1 \\to 2 \\to 3 \\to 1$的方向输运该标量。假设没有源项和扩散，并使用一阶迎风有限体积法计算每个面上的对流通量。\n\n从每个控制体的守恒方程出发，推导$3 \\times 3$的线性系统矩阵$A$，使得$A \\mathbf{u} = \\mathbf{0}$，其中$\\mathbf{u} = (u_1, u_2, u_3)^{\\mathsf{T}}$是网格中心的未知量。使用矩阵$A$，完成以下任务：\n\n1.  证明$A$是行弱对角占优的，并计算其盖尔圆盘。证明这些圆盘的并集与原点重叠。\n2.  构建用于求解$A \\mathbf{u} = \\mathbf{b}$的雅可比迭代矩阵，并确定其谱半径$\\rho$。解释为什么在这种配置下雅可比方法的收敛可能会失败。\n\n请提供谱半径$\\rho$的值作为最终答案。无需四舍五入，不涉及物理单位。你的推理必须从离散守恒陈述和迎风通量近似开始，并展示所有数学推导过程。",
            "solution": "首先验证问题的科学性、自洽性和适定性。\n\n**步骤1：提取已知条件**\n- **系统**：稳态、对流主导的被动标量输运。\n- **区域**：封闭的、周期性的一维回路。\n- **离散化**：$3$个相等的控制体，索引为$i = 1, 2, 3$。\n- **流动**：恒定的正质量通量$F > 0$。\n- **流动方向**：$1 \\to 2 \\to 3 \\to 1$。\n- **物理**：无源项，无扩散。\n- **数值格式**：一阶迎风有限体积法。\n- **目标**：推导线性系统$A \\mathbf{u} = \\mathbf{0}$，其中$\\mathbf{u} = (u_1, u_2, u_3)^{\\mathsf{T}}$。\n- **任务1**：证明$A$是行弱对角占优的，计算其盖尔圆盘，并证明它们的并集与原点重叠。\n- **任务2**：求雅可比迭代矩阵$T_J$，确定其谱半径$\\rho$，并解释雅可比方法收敛可能失败的原因。\n- **最终答案**：谱半径$\\rho$的值。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础**：该问题在计算流体动力学 (CFD) 和数值线性代数原理方面有很好的基础。它使用了诸如有限体积法、迎风格式、对角占优、盖尔圆定理和雅可比迭代等标准概念。物理模型虽然是简化的，却是数值方法的标准测试案例。\n- **适定性**：该问题是适定的，提供了推导矩阵和执行所需分析的所有必要信息。问题具体，并能得出一个唯一的、有意义的答案。\n- **客观性**：语言精确、技术性强，没有主观论断。\n\n**步骤3：结论与行动**\n该问题是**有效的**。将提供完整解答。\n\n**系统矩阵$A$的推导**\n\n有限体积法基于应用于每个控制体 (CV) 的守恒原理。对于一个没有源项的稳态问题，控制体$i$中标量$u$的守恒定律指出，通过其所有面的通量之和为零。这里的通量仅由对流引起。\n\n控制体$i$的净通量是流经其所有面的通量之和。我们约定流出为正，流入为负。穿过一个面的对流通量由质量通量$F$和该面上的标量值$u_{\\text{face}}$的乘积给出。\n$$ \\sum_{\\text{faces}} F_{\\text{face}} u_{\\text{face}} = 0 $$\n在质量通量$F$恒定且流动方向为$1 \\to 2 \\to 3 \\to 1$的情况下，控制体$i$的方程为：\n$$ F u_{\\text{east face}} - F u_{\\text{west face}} = 0 $$\n一阶迎风格式规定，面上的标量值$u_{\\text{face}}$取自上游控制体的网格中心值。流动方向为从$i \\to i+1$。\n\n对于控制体$i$，其“东”面位于$i$和$i+1$之间，“西”面位于$i-1$和$i$之间。\n- 东面的上游网格是网格$i$。所以，$u_{\\text{east face}} = u_i$。\n- 西面的上游网格是网格$i-1$。所以，$u_{\\text{west face}} = u_{i-1}$。\n\n控制体$i$的通用离散方程是：\n$$ F u_i - F u_{i-1} = 0 $$\n\n将此应用于$3$个具有周期性边界条件的控制体：\n- **CV 1 ($i=1$)**：上游控制体是CV 3。因此，$u_{i-1} = u_3$。方程为$F u_1 - F u_3 = 0$。\n- **CV 2 ($i=2$)**：上游控制体是CV 1。因此，$u_{i-1} = u_1$。方程为$F u_2 - F u_1 = 0$。\n- **CV 3 ($i=3$)**：上游控制体是CV 2。因此，$u_{i-1} = u_2$。方程为$F u_3 - F u_2 = 0$。\n\n这个线性方程组可以写成矩阵形式$A \\mathbf{u} = \\mathbf{0}$：\n$$ \\begin{pmatrix} F  0  -F \\\\ -F  F  0 \\\\ 0  -F  F \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n因此，系统矩阵$A$为：\n$$ A = \\begin{pmatrix} F  0  -F \\\\ -F  F  0 \\\\ 0  -F  F \\end{pmatrix} $$\n\n**任务1：对角占优性和盖尔圆盘**\n\n如果对于所有行$i$，都有$|a_{ii}| \\ge \\sum_{j \\ne i} |a_{ij}|$，则矩阵$A$是行弱对角占优的。\n让我们考察矩阵$A$，假设$F > 0$：\n- **第1行**：$|a_{11}| = |F| = F$。非对角元素幅值之和为$\\sum_{j \\ne 1} |a_{1j}| = |0| + |-F| = F$。因此，$|a_{11}| = \\sum_{j \\ne 1} |a_{1j}|$。\n- **第2行**：$|a_{22}| = |F| = F$。非对角元素幅值之和为$\\sum_{j \\ne 2} |a_{2j}| = |-F| + |0| = F$。因此，$|a_{22}| = \\sum_{j \\ne 2} |a_{2j}|$。\n- **第3行**：$|a_{33}| = |F| = F$。非对角元素幅值之和为$\\sum_{j \\ne 3} |a_{3j}| = |0| + |-F| = F$。因此，$|a_{33}| = \\sum_{j \\ne 3} |a_{3j}|$。\n\n由于等式$|a_{ii}| = \\sum_{j \\ne i} |a_{ij}|$对所有行都成立，所以矩阵$A$是弱对角占优的。\n\n根据盖尔圆定理，$A$的每个特征值都位于其盖尔圆盘的并集之内。第$i$个圆盘$D_i$以$a_{ii}$为中心，半径为$R_i = \\sum_{j \\ne i} |a_{ij}|$。\n- **圆盘1 ($i=1$)**：中心$C_1 = a_{11} = F$。半径$R_1 = |a_{12}| + |a_{13}| = |0| + |-F| = F$。该圆盘在复平面中由$|z - F| \\le F$定义。\n- **圆盘2 ($i=2$)**：中心$C_2 = a_{22} = F$。半径$R_2 = |a_{21}| + |a_{23}| = |-F| + |0| = F$。该圆盘由$|z - F| \\le F$定义。\n- **圆盘3 ($i=3$)**：中心$C_3 = a_{33} = F$。半径$R_3 = |a_{31}| + |a_{32}| = |0| + |-F| = F$。该圆盘由$|z - F| \\le F$定义。\n\n所有三个圆盘都是相同的。圆盘的并集是位于实轴上，以$F$为中心、半径为$F$的单个圆盘。为了证明该圆盘与原点重叠，我们检查$z=0$是否在圆盘内：\n$$ |0 - F| \\le F \\implies |-F| \\le F \\implies F \\le F $$\n这个不等式是成立的。原点$z=0$位于圆盘的边界上。这与$A$是奇异的（每行的和为$0$，所以$\\lambda=0$是一个特征值）这一事实是一致的，并且所有特征值必须位于盖尔圆盘的并集内。\n\n**任务2：雅可比迭代与谱半径**\n\n用于求解$A\\mathbf{u} = \\mathbf{b}$的雅可比方法是一种迭代格式。我们将$A$分解为$A = D + L + U$，其中$D$是$A$的对角部分，$L$和$U$分别是严格下三角和上三角部分。迭代过程由下式给出：\n$$ \\mathbf{u}^{(k+1)} = -D^{-1}(L+U) \\mathbf{u}^{(k)} + D^{-1}\\mathbf{b} $$\n雅可比迭代矩阵是$T_J = -D^{-1}(L+U)$。\n\n从我们的矩阵$A$中得到：\n$$ D = \\begin{pmatrix} F  0  0 \\\\ 0  F  0 \\\\ 0  0  F \\end{pmatrix}, \\quad L+U = \\begin{pmatrix} 0  0  -F \\\\ -F  0  0 \\\\ 0  -F  0 \\end{pmatrix} $$\n对角矩阵$D$的逆矩阵是：\n$$ D^{-1} = \\begin{pmatrix} 1/F  0  0 \\\\ 0  1/F  0 \\\\ 0  0  1/F \\end{pmatrix} = \\frac{1}{F}I $$\n现在，我们计算雅可比矩阵$T_J$：\n$$ T_J = -D^{-1}(L+U) = -\\left( \\frac{1}{F}I \\right) \\begin{pmatrix} 0  0  -F \\\\ -F  0  0 \\\\ 0  -F  0 \\end{pmatrix} = -\\frac{1}{F} \\begin{pmatrix} 0  0  -F \\\\ -F  0  0 \\\\ 0  -F  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  1 \\\\ 1  0  0 \\\\ 0  1  0 \\end{pmatrix} $$\n谱半径$\\rho(T_J)$是$T_J$的特征值的最大绝对值。为了找到特征值$\\lambda$，我们求解特征方程$\\det(T_J - \\lambda I) = 0$：\n$$ \\det \\begin{pmatrix} -\\lambda  0  1 \\\\ 1  -\\lambda  0 \\\\ 0  1  -\\lambda \\end{pmatrix} = 0 $$\n$$ (-\\lambda) ((-\\lambda)(-\\lambda) - (0)(1)) - (0) + (1) ((1)(1) - (-\\lambda)(0)) = 0 $$\n$$ -\\lambda(\\lambda^2) + 1 = 0 $$\n$$ \\lambda^3 = 1 $$\n$T_J$的特征值是三个单位立方根：\n$$ \\lambda_1 = 1 $$\n$$ \\lambda_2 = \\exp\\left(\\frac{i2\\pi}{3}\\right) = -\\frac{1}{2} + i\\frac{\\sqrt{3}}{2} $$\n$$ \\lambda_3 = \\exp\\left(\\frac{i4\\pi}{3}\\right) = -\\frac{1}{2} - i\\frac{\\sqrt{3}}{2} $$\n每个特征值的绝对值都是$1$：\n$$ |\\lambda_1| = 1, \\quad |\\lambda_2| = \\sqrt{\\left(-\\frac{1}{2}\\right)^2 + \\left(\\frac{\\sqrt{3}}{2}\\right)^2} = 1, \\quad |\\lambda_3| = \\sqrt{\\left(-\\frac{1}{2}\\right)^2 + \\left(-\\frac{\\sqrt{3}}{2}\\right)^2} = 1 $$\n谱半径是这些值的最大值：\n$$ \\rho(T_J) = \\max\\{1, 1, 1\\} = 1 $$\n\n雅可比方法对于任意初始猜测都保证收敛的充分必要条件是其迭代矩阵的谱半径严格小于$1$（即$\\rho(T_J)  1$）。由于$\\rho(T_J) = 1$，该方法不保证收敛，并且通常会失败。这种失败是该问题的物理和数学性质的直接结果。矩阵$A$是奇异的，因为其对应的物理问题（封闭回路上的纯对流）是标量守恒的，这意味着没有唯一解。如果$\\mathbf{u}$是一个解，那么对于任意常数$c$，$\\mathbf{u} + c(1, 1, 1)^{\\mathsf{T}}$也是解。$A$的奇异性与$\\rho(T_J) = 1$这一事实是内在相关的。具体来说，$T_J$的特征值$\\lambda=1$对应一个稳态误差模式，阻止了向唯一解的收敛。",
            "answer": "$$ \\boxed{1} $$"
        },
        {
            "introduction": "线性系统的矩阵性质是所选离散格式的直接反映。本练习将演示一个不恰当的选择，例如在对流主导的高佩克莱数 ($Pe$) 流动中使用中心差分格式，会如何导致矩阵丧失对角占优性，并产生根本上不符合物理规律的解 。",
            "id": "3975490",
            "problem": "考虑航空航天计算流体动力学 (CFD) 中的一个一维稳态被动标量平流-扩散输运问题，该问题在无量纲区间 $x \\in [0,1]$ 上建模，并采用狄利克雷边界数据 $T(0)=1$ 和 $T(1)=0$。其控制方程是经典的常系数守恒律形式，\n$$ a \\,\\frac{dT}{dx} - \\varepsilon \\,\\frac{d^{2}T}{dx^{2}} = 0, $$\n其中 $a>0$ 是常数平流速度，$\\varepsilon>0$ 是常数扩散系数。在一个具有 $N=5$ 个节点、间距 $h=1/4$ 的均匀网格上，使用二阶中心差分来离散化一阶导数和二阶导数，内部未知数位于 $i=1,2,3$。对于这种离散化，节点 $i$ 处的内部代数方程具有以下通用形式：\n$$ \\left(-\\frac{\\varepsilon}{h^{2}} - \\frac{a}{2h}\\right)T_{i-1} + \\left(\\frac{2\\varepsilon}{h^{2}}\\right)T_{i} + \\left(-\\frac{\\varepsilon}{h^{2}} + \\frac{a}{2h}\\right)T_{i+1} = 0, $$\n边界值为 $T_{0}=1$ 和 $T_{4}=0$。使用参数值 $a=1$ 和 $\\varepsilon=0.01$。从守恒和离散近似的基本原理出发，为 $T_{1},T_{2},T_{3}$ 组装并求解得到的线性系统。然后，通过计算过冲量来量化离散极值原理的违背程度：\n$$ \\delta \\equiv \\max\\{T_{1},T_{2},T_{3}\\} - \\max\\{T_{0},T_{4}\\} $$\n将您的最终数值 $\\delta$ 四舍五入到四位有效数字，并以无单位形式表示。",
            "solution": "用户提供了一个关于计算流体动力学数值方法的有效、适定的问题。我将提供一个完整的解答。\n\n该问题要求分析定义在区域 $x \\in [0,1]$ 上的一个一维稳态平流-扩散方程：\n$$ a \\,\\frac{dT}{dx} - \\varepsilon \\,\\frac{d^{2}T}{dx^{2}} = 0 $$\n其狄利克雷边界条件为 $T(0)=1$ 和 $T(1)=0$。物理参数为平流速度 $a=1$ 和扩散系数 $\\varepsilon=0.01$。\n\n空间域使用一个均匀网格进行离散化，该网格有 $N=5$ 个节点，索引为 $i=0, 1, 2, 3, 4$。网格间距为 $h = \\frac{1}{N-1} = \\frac{1}{4} = 0.25$。未知温度位于内部节点 $T_1$、$T_2$ 和 $T_3$，对应位置为 $x_1=0.25$、$x_2=0.5$ 和 $x_3=0.75$。边界值给定为 $T_0 = T(x_0=0) = 1$ 和 $T_4 = T(x_4=1) = 0$。\n\n问题指定对两个导数都使用二阶中心差分，从而得到内部节点 $i$ 的以下通用代数方程：\n$$ \\left(-\\frac{\\varepsilon}{h^{2}} - \\frac{a}{2h}\\right)T_{i-1} + \\left(\\frac{2\\varepsilon}{h^{2}}\\right)T_{i} + \\left(-\\frac{\\varepsilon}{h^{2}} + \\frac{a}{2h}\\right)T_{i+1} = 0 $$\n这可以改写为：\n$$ C_{west} T_{i-1} + C_{center} T_i + C_{east} T_{i+1} = 0 $$\n其中 $C_{west} = -\\frac{\\varepsilon}{h^2} - \\frac{a}{2h}$，$C_{center} = \\frac{2\\varepsilon}{h^2}$，以及 $C_{east} = -\\frac{\\varepsilon}{h^2} + \\frac{a}{2h}$。\n\n一个重要的无量纲参数是网格佩克莱数，$Pe_h = \\frac{ah}{\\varepsilon}$。对于本问题，$Pe_h = \\frac{1 \\times 0.25}{0.01} = 25$。由于 $Pe_h > 2$，已知使用二阶中心差分格式可能会违背离散极值原理，导致非物理振荡，这正是本问题所研究的现象。\n\n我们首先使用给定的参数 $a=1$、$\\varepsilon=0.01$ 和 $h=0.25$ 来计算系数的数值：\n$$ \\frac{\\varepsilon}{h^2} = \\frac{0.01}{(0.25)^2} = \\frac{0.01}{0.0625} = 0.16 $$\n$$ \\frac{a}{2h} = \\frac{1}{2 \\times 0.25} = \\frac{1}{0.5} = 2 $$\n系数为：\n$$ C_{west} = -0.16 - 2 = -2.16 $$\n$$ C_{center} = 2 \\times 0.16 = 0.32 $$\n$$ C_{east} = -0.16 + 2 = 1.84 $$\n每个内部节点 $i$ 的离散方程为：\n$$ -2.16 T_{i-1} + 0.32 T_i + 1.84 T_{i+1} = 0 $$\n我们现在为未知数 $T_1$、$T_2$ 和 $T_3$ 组装线性代数方程组。\n\n对于节点 $i=1$：\n$$ -2.16 T_0 + 0.32 T_1 + 1.84 T_2 = 0 $$\n代入边界条件 $T_0=1$：\n$$ -2.16(1) + 0.32 T_1 + 1.84 T_2 = 0 \\implies 0.32 T_1 + 1.84 T_2 = 2.16 $$\n\n对于节点 $i=2$：\n$$ -2.16 T_1 + 0.32 T_2 + 1.84 T_3 = 0 $$\n\n对于节点 $i=3$：\n$$ -2.16 T_2 + 0.32 T_3 + 1.84 T_4 = 0 $$\n代入边界条件 $T_4=0$：\n$$ -2.16 T_2 + 0.32 T_3 + 1.84(0) = 0 \\implies -2.16 T_2 + 0.32 T_3 = 0 $$\n\n得到的关于 $(T_1, T_2, T_3)$ 的 $3 \\times 3$ 线性系统为：\n$$ \\begin{pmatrix} 0.32  1.84  0 \\\\ -2.16  0.32  1.84 \\\\ 0  -2.16  0.32 \\end{pmatrix} \\begin{pmatrix} T_1 \\\\ T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 2.16 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n为求解该系统，我们可以使用代入法。根据第三个方程：\n$$ 0.32 T_3 = 2.16 T_2 \\implies T_3 = \\frac{2.16}{0.32} T_2 = 6.75 T_2 = \\frac{27}{4} T_2 $$\n将此代入第二个方程：\n$$ -2.16 T_1 + 0.32 T_2 + 1.84 \\left(6.75 T_2\\right) = 0 $$\n$$ -2.16 T_1 + (0.32 + 12.42) T_2 = 0 $$\n$$ -2.16 T_1 + 12.74 T_2 = 0 \\implies T_1 = \\frac{12.74}{2.16} T_2 = \\frac{637}{108} T_2 $$\n现在将 $T_1$ 的表达式代入第一个方程：\n$$ 0.32 \\left(\\frac{637}{108} T_2\\right) + 1.84 T_2 = 2.16 $$\n$$ \\left( \\frac{0.32 \\times 637}{108} + 1.84 \\right) T_2 = 2.16 $$\n为了保持精度，我们可以使用初始系数的分数表示。将所有方程除以 $0.01$（或乘以 $100$）可以简化系数：\n$$ \\begin{pmatrix} 32  184  0 \\\\ -216  32  184 \\\\ 0  -216  32 \\end{pmatrix} \\begin{pmatrix} T_1 \\\\ T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 216 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n进一步简化，将每行除以最大公约数（此处，所有行均为 $8$）：\n$$ \\begin{pmatrix} 4  23  0 \\\\ -27  4  23 \\\\ 0  -27  4 \\end{pmatrix} \\begin{pmatrix} T_1 \\\\ T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 27 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n根据第三个方程：$4T_3 = 27T_2 \\implies T_3 = \\frac{27}{4}T_2$。\n根据第一个方程：$4T_1 = 27 - 23T_2 \\implies T_1 = \\frac{27-23T_2}{4}$。\n将两者代入第二个方程：\n$$ -27\\left(\\frac{27-23T_2}{4}\\right) + 4T_2 + 23\\left(\\frac{27}{4}T_2\\right) = 0 $$\n乘以 $4$：\n$$ -27(27-23T_2) + 16T_2 + 23(27T_2) = 0 $$\n$$ -729 + 621T_2 + 16T_2 + 621T_2 = 0 $$\n$$ (621+16+621)T_2 = 729 $$\n$$ 1258 T_2 = 729 \\implies T_2 = \\frac{729}{1258} $$\n现在我们求出 $T_1$ 和 $T_3$：\n$$ T_3 = \\frac{27}{4} T_2 = \\frac{27}{4} \\left(\\frac{729}{1258}\\right) = \\frac{19683}{5032} $$\n$$ T_1 = \\frac{27-23T_2}{4} = \\frac{1}{4}\\left(27 - 23\\left(\\frac{729}{1258}\\right)\\right) = \\frac{1}{4}\\left(\\frac{27 \\times 1258 - 23 \\times 729}{1258}\\right) $$\n$$ T_1 = \\frac{1}{4}\\left(\\frac{33966 - 16767}{1258}\\right) = \\frac{1}{4}\\left(\\frac{17199}{1258}\\right) = \\frac{17199}{5032} $$\n内部节点的离散解为：\n$$ T_1 = \\frac{17199}{5032} \\approx 3.417965... $$\n$$ T_2 = \\frac{729}{1258} \\approx 0.579491... $$\n$$ T_3 = \\frac{19683}{5032} \\approx 3.911526... $$\n在连续问题中，最高温度应出现在边界上，即 $\\max\\{T(x)\\} = T(0) = 1$。此数值解明显违背了极值原理，其中 $T_1$ 和 $T_3$ 超过了 $1$。\n\n过冲量 $\\delta$ 定义为：\n$$ \\delta \\equiv \\max\\{T_{1},T_{2},T_{3}\\} - \\max\\{T_{0},T_{4}\\} $$\n边界上的最大值为 $\\max\\{T_0, T_4\\} = \\max\\{1, 0\\} = 1$。\n内部节点上的最大值为 $\\max\\{T_1, T_2, T_3\\} = \\max\\{3.417..., 0.579..., 3.911...\\} = T_3$。\n$$ \\delta = T_3 - 1 = \\frac{19683}{5032} - 1 = \\frac{19683 - 5032}{5032} = \\frac{14651}{5032} $$\n我们现在计算其数值：\n$$ \\delta = \\frac{14651}{5032} \\approx 2.91152623624... $$\n问题要求将该值四舍五入到四位有效数字。前四位有效数字是 $2, 9, 1, 1$。第五位数字是 $5$，所以我们将第四位数字向上取整。\n$$ \\delta \\approx 2.912 $$",
            "answer": "$$\n\\boxed{2.912}\n$$"
        }
    ]
}