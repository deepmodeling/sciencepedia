{
    "hands_on_practices": [
        {
            "introduction": "The first step in solving a PDE with the Finite Volume Method is translating the continuous physics into a discrete algebraic system, $\\boldsymbol{A}\\boldsymbol{x}=\\boldsymbol{b}$. This exercise focuses on this fundamental process for a steady heat conduction problem. You will practice not only assembling the core matrix from physical flux balances but also implementing essential Dirichlet boundary conditions using both the elimination and penalty methods, gaining insight into how these choices affect the properties of the final system to be solved .",
            "id": "3944932",
            "problem": "Consider one-dimensional steady heat conduction in a slab of thickness $L$ with constant thermal conductivity $k$ governed by the conservation law $\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right)=0$. Using the Finite Volume Method (FVM), assemble the algebraic system on a uniform grid with three control volumes of width $h$ and cross-sectional area $A$, with unknown temperatures at cell centers $\\{T_1,T_2,T_3\\}$. Assume the left boundary at $x=0$ is subject to a Dirichlet condition $T(0)=T_D$, and the right boundary at $x=L$ is insulated, i.e., Neumann condition $-\\left.k\\frac{dT}{dx}\\right|_{x=L}=0$. Let the face-to-center distances be $h/2$ at the boundaries and $h$ between adjacent cell centers, and use linear (two-point) diffusive flux approximations at faces.\n\nYou will assemble the discrete matrix $\\boldsymbol{A}$ and right-hand side $\\boldsymbol{b}$ for two distinct treatments of the Dirichlet boundary:\n\n- Elimination method: enforce $T_1=T_D$ by row and column elimination in the global system, preserving symmetry by moving couplings into the right-hand side.\n- Penalty method: retain the original row and append a penalty term of strength $\\gamma>0$ at the Dirichlet degree of freedom.\n\nWork with nondimensionalized constants $k=1$, $h=1$, $A=1$ so that the interior diffusive conductances are unity. Begin from first principles of FVM flux balance to write the unmodified conduction stencil for the three control volumes, then:\n\n1. Using the elimination method, write the exact algebraic modifications to the matrix entries and the right-hand side. Provide the final assembled $\\boldsymbol{A}_{\\text{elim}}$ and $\\boldsymbol{b}_{\\text{elim}}$ explicitly in terms of $T_D$.\n2. Using the penalty method, write the exact algebraic modifications to the matrix entries and the right-hand side. Provide the final assembled $\\boldsymbol{A}_{\\text{pen}}$ and $\\boldsymbol{b}_{\\text{pen}}$ explicitly in terms of $T_D$ and $\\gamma$.\n3. For each assembled matrix, analyze the two-norm condition number $\\kappa_2(\\boldsymbol{A})$ based on the ratio of its largest to smallest eigenvalues. For the elimination method, compute $\\kappa_2(\\boldsymbol{A}_{\\text{elim}})$ exactly. For the penalty method, derive the leading-order asymptotic form of $\\kappa_2(\\boldsymbol{A}_{\\text{pen}})$ as $\\gamma\\to\\infty$, retaining only the dominant scaling in $\\gamma$.\n\nFinally, derive the leading-order asymptotic expression, as $\\gamma\\to\\infty$, of the ratio of condition numbers\n$$\n\\frac{\\kappa_2\\!\\left(\\boldsymbol{A}_{\\text{pen}}\\right)}{\\kappa_2\\!\\left(\\boldsymbol{A}_{\\text{elim}}\\right)}.\n$$\nExpress the final answer as a single closed-form analytic expression in terms of $\\gamma$ and radicals. No rounding is required and there are no physical units to report. Definitions: Finite Volume Method (FVM), Computational Fluid Dynamics (CFD).",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and internally consistent. It poses a standard, verifiable problem in the numerical analysis of partial differential equations using the Finite Volume Method. The problem is valid.\n\nWe begin by applying the Finite Volume Method (FVM) to the one-dimensional steady heat conduction equation, $\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right)=0$. Integrating over a control volume $V_i$ with cross-sectional area $A$ from its west face ($w$) to its east face ($e$) yields:\n$$ \\int_{V_i} \\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) dV = \\int_{x_w}^{x_e} A \\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) dx = A \\left[k \\frac{dT}{dx}\\right]_{x_w}^{x_e} = 0 $$\nThis gives the flux balance: $\\left(k A \\frac{dT}{dx}\\right)_e - \\left(k A \\frac{dT}{dx}\\right)_w = 0$. The heat flux at a face is $q = -k A \\frac{dT}{dx}$. So, the balance is $q_w - q_e = 0$.\n\nWe use a uniform grid of three control volumes, each of width $h$. The domain has total length $L=3h$. The cell centers are at $x_1 = h/2$, $x_2 = 3h/2$, and $x_3 = 5h/2$. The non-dimensional constants are $k=1$, $h=1$, $A=1$. Thus, $L=3$, and cell centers are at $x_1=0.5$, $x_2=1.5$, $x_3=2.5$. The faces are located at $x=0, 1, 2, 3$.\n\nThe flux at an internal face between cells $i$ and $i+1$ is approximated as:\n$$ q_{i+1/2} = -k_f A_f \\frac{T_{i+1}-T_i}{x_{i+1}-x_i} = -(1)(1)\\frac{T_{i+1}-T_i}{1} = -(T_{i+1}-T_i) $$\nThe diffusive conductance between interior cells is $C_{int} = kA/h = 1$.\n\nNow we assemble the equations for each control volume, which forms the basis for both required methods.\n\n**Control Volume 1 (centered at $x_1=0.5$):**\nThe west face is the boundary at $x=0$, where $T(0)=T_D$. The flux is $q_w = -kA \\frac{T_1 - T_D}{x_1 - 0} = - (1)(1) \\frac{T_1 - T_D}{0.5-0} = -2(T_1-T_D)$.\nThe east face is at $x=1$, between cells $1$ and $2$. The flux is $q_e = -(T_2-T_1)$.\nThe balance $q_w - q_e = 0$ gives: $-2(T_1-T_D) - (-(T_2-T_1)) = 0$, which simplifies to $-2T_1+2T_D+T_2-T_1=0$, or $3T_1-T_2 = 2T_D$.\n\n**Control Volume 2 (centered at $x_2=1.5$):**\nThe west face is at $x=1$, so $q_w = -(T_2-T_1)$.\nThe east face is at $x=2$, between cells $2$ and $3$, so $q_e = -(T_3-T_2)$.\nThe balance $q_w - q_e = 0$ gives: $-(T_2-T_1) - (-(T_3-T_2))=0$, which simplifies to $-T_2+T_1+T_3-T_2=0$, or $-T_1+2T_2-T_3=0$.\n\n**Control Volume 3 (centered at $x_3=2.5$):**\nThe west face is at $x=2$, so $q_w = -(T_3-T_2)$.\nThe east face is at the boundary $x=L=3$, which is insulated. The condition is $-\\left.k\\frac{dT}{dx}\\right|_{x=L}=0$, which implies the flux $q_e=0$.\nThe balance $q_w - q_e = 0$ gives: $-(T_3-T_2) - 0 = 0$, or $-T_2+T_3=0$.\n\nThe assembled system, which we will call the base system, is:\n$$\n\\begin{pmatrix}\n3 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nT_1 \\\\ T_2 \\\\ T_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2T_D \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\nLet this system be denoted $\\boldsymbol{A}_{\\text{base}}\\boldsymbol{T} = \\boldsymbol{b}_{\\text{base}}$.\n\n### 1. Elimination Method\n\nThe elimination method enforces the Dirichlet condition $T_1=T_D$ on the assembled system while preserving symmetry. We modify the system such that the first equation becomes $T_1=T_D$, and the coupling from $T_1$ to other equations is moved to the right-hand side.\n\nThe second equation is $-T_1+2T_2-T_3=0$. Substituting $T_1=T_D$, it becomes $2T_2-T_3 = T_D$. This is equivalent to updating the right-hand side: $b_2' = b_2 - A_{21}T_D = 0 - (-1)T_D = T_D$.\nThe third equation $ -T_2+T_3=0$ does not involve $T_1$, so it remains unchanged.\nThe first equation is replaced by the constraint $T_1=T_D$.\nTo maintain a symmetric matrix structure, we set the off-diagonal elements in the first row and first column to zero, and the diagonal element $A_{11}$ to $1$. The modified system $\\boldsymbol{A}_{\\text{elim}}\\boldsymbol{T} = \\boldsymbol{b}_{\\text{elim}}$ is:\n$$\n\\boldsymbol{A}_{\\text{elim}} =\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix},\n\\quad\n\\boldsymbol{b}_{\\text{elim}} =\n\\begin{pmatrix}\nT_D \\\\\nT_D \\\\\n0\n\\end{pmatrix}\n$$\n\n### 2. Penalty Method\n\nThe penalty method enforces the Dirichlet condition $T_1 \\approx T_D$ by adding a penalty term to the first equation. This is achieved by adding $\\gamma$ to the diagonal element $A_{11}$ and $\\gamma T_D$ to the right-hand side term $b_1$ of the base system.\nStarting with $\\boldsymbol{A}_{\\text{base}}$ and $\\boldsymbol{b}_{\\text{base}}$:\n$A_{11, \\text{pen}} = A_{11, \\text{base}} + \\gamma = 3+\\gamma$.\n$b_{1, \\text{pen}} = b_{1, \\text{base}} + \\gamma T_D = 2T_D + \\gamma T_D = (2+\\gamma)T_D$.\nThe other rows of the system are unchanged. The resulting system $\\boldsymbol{A}_{\\text{pen}}\\boldsymbol{T} = \\boldsymbol{b}_{\\text{pen}}$ is:\n$$\n\\boldsymbol{A}_{\\text{pen}} =\n\\begin{pmatrix}\n3+\\gamma & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix},\n\\quad\n\\boldsymbol{b}_{\\text{pen}} =\n\\begin{pmatrix}\n(2+\\gamma)T_D \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n\n### 3. Condition Number Analysis\n\nThe two-norm condition number is $\\kappa_2(\\boldsymbol{A}) = \\frac{|\\lambda_{\\max}|}{|\\lambda_{\\min}|}$.\n\n**Condition number of $\\boldsymbol{A}_{\\text{elim}}$:**\nThe eigenvalues $\\lambda$ of $\\boldsymbol{A}_{\\text{elim}}$ are found from $\\det(\\boldsymbol{A}_{\\text{elim}} - \\lambda\\boldsymbol{I}) = 0$.\n$$ \\det\\begin{pmatrix} 1-\\lambda & 0 & 0 \\\\ 0 & 2-\\lambda & -1 \\\\ 0 & -1 & 1-\\lambda \\end{pmatrix} = (1-\\lambda)[(2-\\lambda)(1-\\lambda) - 1] = 0 $$\nOne eigenvalue is $\\lambda_1=1$. The other two are roots of $\\lambda^2-3\\lambda+1=0$, which are $\\lambda_{2,3} = \\frac{3 \\pm \\sqrt{5}}{2}$.\nThe eigenvalues are $\\lambda_{\\max} = \\frac{3+\\sqrt{5}}{2}$, $\\lambda_{\\min} = \\frac{3-\\sqrt{5}}{2}$, and $1$.\nSo, $\\lambda_{\\max}(\\boldsymbol{A}_{\\text{elim}}) = \\frac{3+\\sqrt{5}}{2}$ and $\\lambda_{\\min}(\\boldsymbol{A}_{\\text{elim}}) = \\frac{3-\\sqrt{5}}{2}$.\n$$ \\kappa_2(\\boldsymbol{A}_{\\text{elim}}) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(3+\\sqrt{5})/2}{(3-\\sqrt{5})/2} = \\frac{3+\\sqrt{5}}{3-\\sqrt{5}} = \\frac{(3+\\sqrt{5})^2}{(3-\\sqrt{5})(3+\\sqrt{5})} = \\frac{9+6\\sqrt{5}+5}{9-5} = \\frac{14+6\\sqrt{5}}{4} = \\frac{7+3\\sqrt{5}}{2} $$\n\n**Asymptotic condition number of $\\boldsymbol{A}_{\\text{pen}}$ as $\\gamma \\to \\infty$:**\nThe characteristic equation is $\\det(\\boldsymbol{A}_{\\text{pen}} - \\lambda \\boldsymbol{I})=0$.\n$$ (3+\\gamma-\\lambda)((2-\\lambda)(1-\\lambda)-1) - (-1)(-(1-\\lambda)) = 0 $$\n$$ (3+\\gamma-\\lambda)(\\lambda^2-3\\lambda+1) - (1-\\lambda) = 0 $$\n$$ \\lambda^3 - (6+\\gamma)\\lambda^2 + (9+3\\gamma)\\lambda - (2+\\gamma) = 0 $$\nAs $\\gamma \\to \\infty$, we expect one large eigenvalue, $\\lambda_{\\max} \\sim O(\\gamma)$, and two smaller eigenvalues of order $O(1)$.\nFor the small eigenvalues, we divide the polynomial by $\\gamma$ and take the limit $\\gamma \\to \\infty$:\n$$ \\frac{\\lambda^3}{\\gamma} - (1+\\frac{6}{\\gamma})\\lambda^2 + (3+\\frac{9}{\\gamma})\\lambda - (1+\\frac{2}{\\gamma}) = 0 \\quad\\to\\quad -\\lambda^2+3\\lambda-1=0 $$\nThis gives $\\lambda^2-3\\lambda+1=0$, so the two smaller eigenvalues converge to $\\frac{3 \\pm \\sqrt{5}}{2}$. Thus, $\\lambda_{\\min}(\\boldsymbol{A}_{\\text{pen}}) \\to \\frac{3-\\sqrt{5}}{2}$.\nThe sum of eigenvalues is $\\lambda_1+\\lambda_2+\\lambda_3 = 6+\\gamma$. As $\\gamma\\to\\infty$, $\\lambda_{\\max} + \\frac{3+\\sqrt{5}}{2} + \\frac{3-\\sqrt{5}}{2} \\approx 6+\\gamma$.\n$\\lambda_{\\max} + 3 \\approx 6+\\gamma$, so $\\lambda_{\\max} \\approx \\gamma+3$.\nThe leading order term is $\\lambda_{\\max} \\sim \\gamma$.\nThe asymptotic condition number is:\n$$ \\kappa_2(\\boldsymbol{A}_{\\text{pen}}) \\sim \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} \\sim \\frac{\\gamma}{\\frac{3-\\sqrt{5}}{2}} = \\frac{2\\gamma}{3-\\sqrt{5}} = \\frac{2\\gamma(3+\\sqrt{5})}{9-5} = \\gamma\\frac{3+\\sqrt{5}}{2} $$\n\n**Ratio of Condition Numbers:**\nFinally, we compute the leading-order asymptotic expression for the ratio as $\\gamma \\to \\infty$:\n$$ \\frac{\\kappa_2(\\boldsymbol{A}_{\\text{pen}})}{\\kappa_2(\\boldsymbol{A}_{\\text{elim}})} \\sim \\frac{\\gamma\\frac{3+\\sqrt{5}}{2}}{\\frac{7+3\\sqrt{5}}{2}} = \\gamma \\frac{3+\\sqrt{5}}{7+3\\sqrt{5}} $$\nTo simplify the fraction, we rationalize the denominator:\n$$ \\gamma \\frac{3+\\sqrt{5}}{7+3\\sqrt{5}} \\times \\frac{7-3\\sqrt{5}}{7-3\\sqrt{5}} = \\gamma \\frac{(3+\\sqrt{5})(7-3\\sqrt{5})}{7^2 - (3\\sqrt{5})^2} = \\gamma \\frac{21 - 9\\sqrt{5} + 7\\sqrt{5} - 3(5)}{49 - 9(5)} $$\n$$ = \\gamma \\frac{21-15-2\\sqrt{5}}{49-45} = \\gamma \\frac{6-2\\sqrt{5}}{4} = \\gamma \\frac{3-\\sqrt{5}}{2} $$\nThe leading-order asymptotic expression for the ratio is $\\gamma \\frac{3-\\sqrt{5}}{2}$.",
            "answer": "$$\n\\boxed{\\gamma \\frac{3-\\sqrt{5}}{2}}\n$$"
        },
        {
            "introduction": "Most practical CFD problems involve nonlinearities, which require iterative solvers like the Newton method. Central to this process is the Jacobian matrix, which represents the linearization of the nonlinear system. This practice delves into this concept by examining a 1D advection problem discretized with a high-resolution scheme involving a nonlinear `minmod` flux limiter, a common technique for preventing oscillations. Your task is to compute a specific off-diagonal entry of the Jacobian, which demonstrates how the solution in one cell influences the residual in its neighbor through the nonlinear flux function .",
            "id": "3944939",
            "problem": "Consider the one-dimensional steady linear advection of a transported scalar in the context of Computational Fluid Dynamics (CFD), discretized by the Finite Volume Method (FVM) on a uniform grid. Let three consecutive control volumes be denoted by west, present, and east, with centers at $W$, $P$, and $E$, respectively, and uniform spacing $\\Delta x = 0.01\\,\\mathrm{m}$. The flow velocity is constant and positive, $u = 50\\,\\mathrm{m/s}$, density is $\\rho = 1\\,\\mathrm{kg/m^3}$, and face area is $S = 1\\,\\mathrm{m^2}$. The cell-centered values of the transported scalar are $\\phi_W = 1.0$, $\\phi_P = 2.0$, and $\\phi_E = 2.3$.\n\nStarting from conservation of mass for steady advection, the semi-discrete FVM balance over cell $P$ is constructed as the difference of convective fluxes through the east and west faces. For positive $u$, the upwind state at the east face is taken from the $P$ side and is reconstructed by a linear profile limited by the minmod limiter. Define the minmod-limited slope at $P$ as\n$$\ns_P = \\operatorname{minmod}\\!\\left(\\frac{\\phi_P - \\phi_W}{\\Delta x},\\, \\frac{\\phi_E - \\phi_P}{\\Delta x}\\right),\n$$\nand the reconstructed value on the $P$-side of the east face as\n$$\n\\phi_{e}^{-} = \\phi_P + s_P \\frac{\\Delta x}{2}.\n$$\nLet the mass flux at the east face be $F_e = \\rho\\,u\\,S$. The semi-discrete residual for cell $P$ is\n$$\nR_P = F_e\\,\\phi_{e}^{-} - F_w\\,\\phi_{w}^{-},\n$$\nwith $F_w = \\rho\\,u\\,S$ and $\\phi_w^{-}$ the upwind reconstruction at the west face (constructed analogously, but it will not be needed explicitly for the requested update).\n\nTreat the nonlinear convective flux implicitly via a Newton linearization, so that the east neighbor coefficient in the Jacobian row for cell $P$ is\n$$\na_E = \\frac{\\partial R_P}{\\partial \\phi_E}.\n$$\n\nUsing only the information and definitions above, compute:\n1. The limited east face value $\\phi_{e}^{-}$.\n2. The updated east neighbor coefficient $a_E$ due to the convective term.\n\nReport only the value of $a_E$ as your final answer, expressed in $\\mathrm{kg/s}$, and round your answer to three significant figures. State angles, if any appear, in radians; none are expected here.",
            "solution": "The objective is to compute the east neighbor coefficient $a_E$ of the Jacobian matrix, which is defined as the partial derivative of the semi-discrete residual for cell $P$, $R_P$, with respect to the east cell's scalar value, $\\phi_E$. The coefficient is given by\n$$\na_E = \\frac{\\partial R_P}{\\partial \\phi_E}\n$$\nThe residual for cell $P$ is defined as the net flux:\n$$\nR_P = F_e\\,\\phi_{e}^{-} - F_w\\,\\phi_{w}^{-}\n$$\nwhere $F_e = \\rho\\,u\\,S$ and $F_w = \\rho\\,u\\,S$ are the mass fluxes at the east and west faces, respectively. The term $\\phi_{e}^{-}$ is the reconstructed scalar value on the upwind side (the $P$-side) of the east face, and $\\phi_{w}^{-}$ is the reconstructed scalar value on the upwind side of the west face.\n\nTo compute the derivative for $a_E$, we have:\n$$\na_E = \\frac{\\partial}{\\partial \\phi_E} (F_e\\,\\phi_{e}^{-} - F_w\\,\\phi_{w}^{-})\n$$\nThe mass fluxes $F_e$ and $F_w$ are constant with respect to $\\phi_E$, as they depend on the constant density $\\rho$, velocity $u$, and area $S$. The reconstructed value at the west face, $\\phi_w^{-}$, is determined by the scalar values in cells to the west of or at cell $P$ (i.e., $\\phi_W$, $\\phi_P$, and the cell to the west of $W$), and thus does not depend on $\\phi_E$. Consequently, its partial derivative with respect to $\\phi_E$ is zero. The expression for $a_E$ simplifies to:\n$$\na_E = F_e \\frac{\\partial \\phi_{e}^{-}}{\\partial \\phi_E}\n$$\nThe reconstructed value $\\phi_{e}^{-}$ is defined as:\n$$\n\\phi_{e}^{-} = \\phi_P + s_P \\frac{\\Delta x}{2}\n$$\nwhere $s_P$ is the minmod-limited slope at cell $P$:\n$$\ns_P = \\operatorname{minmod}\\!\\left(\\frac{\\phi_P - \\phi_W}{\\Delta x},\\, \\frac{\\phi_E - \\phi_P}{\\Delta x}\\right)\n$$\nFirst, we compute the two arguments of the $\\operatorname{minmod}$ function using the provided values: $\\phi_W = 1.0$, $\\phi_P = 2.0$, $\\phi_E = 2.3$, and $\\Delta x = 0.01\\,\\mathrm{m}$.\nThe backward difference slope is:\n$$\ns_{PW} = \\frac{\\phi_P - \\phi_W}{\\Delta x} = \\frac{2.0 - 1.0}{0.01} = \\frac{1.0}{0.01} = 100\n$$\nThe forward difference slope is:\n$$\ns_{PE} = \\frac{\\phi_E - \\phi_P}{\\Delta x} = \\frac{2.3 - 2.0}{0.01} = \\frac{0.3}{0.01} = 30\n$$\nThe $\\operatorname{minmod}$ function is defined as $\\operatorname{minmod}(a, b) = \\operatorname{sgn}(a) \\min(|a|, |b|)$ if $\\operatorname{sgn}(a) = \\operatorname{sgn}(b)$, and $0$ otherwise. In our case, both arguments $s_{PW} = 100$ and $s_{PE} = 30$ are positive. Since $|30|  |100|$, the function returns the argument with the smaller absolute value.\n$$\ns_P = \\operatorname{minmod}(100,\\, 30) = 30\n$$\nThis means that for the given state, the limited slope $s_P$ is equal to the forward difference slope $s_{PE}$. This holds true as long as we are not at a \"kink\" in the function, i.e., $|s_{PE}| \\neq |s_{PW}|$. Since $30 \\neq 100$, the function is differentiable with respect to $\\phi_E$ at this state.\nSo, in a neighborhood of the given state, the expression for the slope is:\n$$\ns_P = \\frac{\\phi_E - \\phi_P}{\\Delta x}\n$$\nNow, we can compute the first requested value, the limited east face value $\\phi_{e}^{-}$:\n$$\n\\phi_{e}^{-} = \\phi_P + s_P \\frac{\\Delta x}{2} = 2.0 + (30) \\frac{0.01}{2} = 2.0 + 0.15 = 2.15\n$$\nTo find $a_E$, we differentiate $\\phi_{e}^{-}$ with respect to $\\phi_E$. First, we find the derivative of $s_P$:\n$$\n\\frac{\\partial s_P}{\\partial \\phi_E} = \\frac{\\partial}{\\partial \\phi_E} \\left( \\frac{\\phi_E - \\phi_P}{\\Delta x} \\right) = \\frac{1}{\\Delta x}\n$$\nNow, we find the derivative of $\\phi_e^-$:\n$$\n\\frac{\\partial \\phi_{e}^{-}}{\\partial \\phi_E} = \\frac{\\partial}{\\partial \\phi_E} \\left( \\phi_P + s_P \\frac{\\Delta x}{2} \\right) = \\frac{\\Delta x}{2} \\frac{\\partial s_P}{\\partial \\phi_E} = \\frac{\\Delta x}{2} \\left( \\frac{1}{\\Delta x} \\right) = \\frac{1}{2}\n$$\nNext, we compute the mass flux $F_e$:\n$$\nF_e = \\rho\\,u\\,S = (1\\,\\mathrm{kg/m^3}) \\times (50\\,\\mathrm{m/s}) \\times (1\\,\\mathrm{m^2}) = 50\\,\\mathrm{kg/s}\n$$\nFinally, we can compute the Jacobian coefficient $a_E$:\n$$\na_E = F_e \\frac{\\partial \\phi_{e}^{-}}{\\partial \\phi_E} = (50\\,\\mathrm{kg/s}) \\times \\frac{1}{2} = 25\\,\\mathrm{kg/s}\n$$\nThe problem requires the answer to be rounded to three significant figures. The exact value is $25$, which written to three significant figures is $25.0$.\nThe units are $\\mathrm{kg/s}$ as requested.\nThe second requested value, the updated east neighbor coefficient $a_E$, is $25.0\\,\\mathrm{kg/s}$.",
            "answer": "$$\n\\boxed{25.0}\n$$"
        },
        {
            "introduction": "Calculating the full Jacobian matrix is a critical and often computationally expensive part of a CFD solver. This hands-on problem compares two major strategies for this task: analytical differentiation (the basis for Automatic Differentiation, or AD) and the finite-difference approximation. By assembling a full Jacobian column for a convection-diffusion problem with a nonlinear source term, you will verify the sparsity pattern of the FVM stencil and discover an important result about the exactness of the finite-difference method for the polynomial nonlinearities often encountered in practice .",
            "id": "3944905",
            "problem": "Consider the one-dimensional, steady convectionâ€“diffusion equation with a nonlinear source over a uniform mesh, discretized by the Finite Volume Method (FVM). Let the computational domain be of length $L=1$ partitioned into $N=4$ equal control volumes of width $\\Delta x = L/N = 0.25$, with constant cross-sectional area $A=1$. The diffusivity is $\\Gamma=0.1$, the density is $\\rho=1$, and the uniform convection speed is $V=3$ directed from left to right. The left and right Dirichlet boundary values are $u_{L}=1$ and $u_{R}=0$, respectively. The nonlinear source term is $S(u) = k\\,u^{2}$ with $k=5$, so that the volumetric source integrated over cell $i$ is $k\\,A\\,\\Delta x\\,u_{i}^{2}$.\n\nDenote the vector of unknowns at the $N=4$ cell centers by $\\mathbf{u} = [u_{1},u_{2},u_{3},u_{4}]^{\\top}$. For each interior control volume $i \\in \\{1,2,3,4\\}$, define the residual $R_{i}(\\mathbf{u})$ as the net outflow of convective and diffusive fluxes plus the volumetric source:\n$$\nR_{i}(\\mathbf{u}) = \\big(F_{c,i+\\frac{1}{2}} - F_{c,i-\\frac{1}{2}}\\big) + \\big(F_{d,i+\\frac{1}{2}} - F_{d,i-\\frac{1}{2}}\\big) + k\\,A\\,\\Delta x\\,u_{i}^{2},\n$$\nwhere, for positive $V$, the upwind convective flux at face $i+\\frac{1}{2}$ is $F_{c,i+\\frac{1}{2}} = \\rho\\,V\\,A\\,u_{i}$, and at the left boundary face $\\frac{1}{2}$ it is $F_{c,\\frac{1}{2}}=\\rho\\,V\\,A\\,u_{L}$. The diffusive flux at face $i+\\frac{1}{2}$ is $F_{d,i+\\frac{1}{2}} = -\\Gamma\\,A\\,\\frac{u_{i+1}-u_{i}}{\\Delta x}$, with the boundary faces using $u_{L}$ and $u_{R}$ in place of $u_{0}$ and $u_{5}$.\n\nLet the current iterate be\n$$\n\\mathbf{u}^{(0)} = [0.8,\\,0.5,\\,0.2,\\,0.1]^{\\top}.\n$$\nLet $\\mathbf{J}(\\mathbf{u})$ denote the Jacobian matrix of $\\mathbf{R}(\\mathbf{u})$ with respect to $\\mathbf{u}$. Your task is to assemble the third column $\\mathbf{J}(:,3)$ of the Jacobian at $\\mathbf{u}^{(0)}$ by two methods:\n1. An analytic assembly consistent with Automatic Differentiation (AD) principles by differentiating the residual definition with respect to $u_{3}$.\n2. A central finite-difference approximation using a perturbation step $h = 10^{-6}$,\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) \\approx \\frac{\\mathbf{R}(\\mathbf{u}^{(0)} + h\\,\\mathbf{e}_{3}) - \\mathbf{R}(\\mathbf{u}^{(0)} - h\\,\\mathbf{e}_{3})}{2\\,h},\n$$\nwhere $\\mathbf{e}_{3}$ is the third standard basis vector in $\\mathbb{R}^{4}$.\n\nCompute both columns, discuss their sparsity patterns, and finally compute the Euclidean two-norm\n$$\n\\left\\| \\mathbf{J}_{\\mathrm{FD}}(:,3) - \\mathbf{J}(:,3) \\right\\|_{2}.\n$$\nProvide this norm as your final answer. No rounding is required. Express the final answer as a pure number without units.",
            "solution": "First, we establish the discretized residual equations for each of the $N=4$ control volumes. We define two key coefficients based on the given parameters:\nThe convective flux coefficient: $C = \\rho\\,V\\,A = 1 \\times 3 \\times 1 = 3$.\nThe diffusive flux coefficient: $D = \\frac{\\Gamma\\,A}{\\Delta x} = \\frac{0.1 \\times 1}{0.25} = 0.4$.\nThe source term coefficient for cell $i$ is $k\\,A\\,\\Delta x = 5 \\times 1 \\times 0.25 = 1.25$.\n\nThe residual for a general interior cell $i \\in \\{2, 3\\}$ is:\n$R_{i}(\\mathbf{u}) = (C\\,u_{i} - C\\,u_{i-1}) + \\left(-\\Gamma\\,A\\,\\frac{u_{i+1}-u_{i}}{\\Delta x} - (-\\Gamma\\,A\\,\\frac{u_{i}-u_{i-1}}{\\Delta x})\\right) + 1.25\\,u_{i}^{2}$\n$R_{i}(\\mathbf{u}) = C\\,u_{i} - C\\,u_{i-1} - D\\,u_{i+1} + 2\\,D\\,u_{i} - D\\,u_{i-1} + 1.25\\,u_{i}^{2}$\n$R_{i}(\\mathbf{u}) = -(C+D)u_{i-1} + (C+2D)u_{i} - D\\,u_{i+1} + 1.25\\,u_{i}^{2}$\n\nNow we write the specific residual equations for each cell, applying the boundary conditions.\nFor cell $i=1$: $u_{i-1}$ is replaced by $u_{L}=1$.\n$R_{1}(\\mathbf{u}) = (C\\,u_{1} - C\\,u_{L}) + \\left(-D(u_{2}-u_{1}) - (-D(u_{1}-u_{L}))\\right) + 1.25\\,u_{1}^{2}$\n$R_{1}(\\mathbf{u}) = (C+2D)u_{1} - D\\,u_{2} + 1.25\\,u_{1}^{2} - (C+D)u_{L}$\nSubstituting $C=3$, $D=0.4$, $u_{L}=1$:\n$R_{1}(\\mathbf{u}) = 3.8\\,u_{1} - 0.4\\,u_{2} + 1.25\\,u_{1}^{2} - 3.4$.\n\nFor cell $i=2$:\n$R_{2}(\\mathbf{u}) = -(C+D)u_{1} + (C+2D)u_{2} - D\\,u_{3} + 1.25\\,u_{2}^{2}$\n$R_{2}(\\mathbf{u}) = -3.4\\,u_{1} + 3.8\\,u_{2} - 0.4\\,u_{3} + 1.25\\,u_{2}^{2}$.\n\nFor cell $i=3$:\n$R_{3}(\\mathbf{u}) = -(C+D)u_{2} + (C+2D)u_{3} - D\\,u_{4} + 1.25\\,u_{3}^{2}$\n$R_{3}(\\mathbf{u}) = -3.4\\,u_{2} + 3.8\\,u_{3} - 0.4\\,u_{4} + 1.25\\,u_{3}^{2}$.\n\nFor cell $i=4$: $u_{i+1}$ is replaced by $u_{R}=0$.\n$R_{4}(\\mathbf{u}) = (C\\,u_{4} - C\\,u_{3}) + \\left(-D(u_{R}-u_{4}) - (-D(u_{4}-u_{3}))\\right) + 1.25\\,u_{4}^{2}$\n$R_{4}(\\mathbf{u}) = -(C+D)u_{3} + (C+2D)u_{4} + 1.25\\,u_{4}^{2} - D\\,u_{R}$\nSubstituting $C=3$, $D=0.4$, $u_{R}=0$:\n$R_{4}(\\mathbf{u}) = -3.4\\,u_{3} + 3.8\\,u_{4} + 1.25\\,u_{4}^{2}$.\n\n**1. Analytic Jacobian Column Assembly**\nThe Jacobian matrix is defined as $J_{ij}(\\mathbf{u}) = \\frac{\\partial R_{i}}{\\partial u_{j}}$. We need to compute the third column, $\\mathbf{J}(:,3)$, which consists of the derivatives of each residual component with respect to $u_{3}$.\n- $\\frac{\\partial R_{1}}{\\partial u_{3}}$: $R_{1}$ depends only on $u_{1}$ and $u_{2}$.\n  $$J_{13} = \\frac{\\partial R_{1}}{\\partial u_{3}} = 0$$\n- $\\frac{\\partial R_{2}}{\\partial u_{3}}$: From the expression for $R_{2}$, we differentiate with respect to $u_{3}$.\n  $$J_{23} = \\frac{\\partial R_{2}}{\\partial u_{3}} = \\frac{\\partial}{\\partial u_{3}} (-3.4\\,u_{1} + 3.8\\,u_{2} - 0.4\\,u_{3} + 1.25\\,u_{2}^{2}) = -0.4$$\n- $\\frac{\\partial R_{3}}{\\partial u_{3}}$: From the expression for $R_{3}$, we differentiate with respect to $u_{3}$.\n  $$J_{33} = \\frac{\\partial R_{3}}{\\partial u_{3}} = \\frac{\\partial}{\\partial u_{3}} (-3.4\\,u_{2} + 3.8\\,u_{3} - 0.4\\,u_{4} + 1.25\\,u_{3}^{2}) = 3.8 + 2.5\\,u_{3}$$\n- $\\frac{\\partial R_{4}}{\\partial u_{3}}$: From the expression for $R_{4}$, we differentiate with respect to $u_{3}$.\n  $$J_{43} = \\frac{\\partial R_{4}}{\\partial u_{3}} = \\frac{\\partial}{\\partial u_{3}} (-3.4\\,u_{3} + 3.8\\,u_{4} + 1.25\\,u_{4}^{2}) = -3.4$$\n\nWe evaluate this column at the given iterate $\\mathbf{u}^{(0)} = [0.8,\\,0.5,\\,0.2,\\,0.1]^{\\top}$. The only component that depends on $\\mathbf{u}^{(0)}$ is $J_{33}$, which depends on $u_{3}^{(0)}=0.2$.\n$J_{13} = 0$\n$J_{23} = -0.4$\n$J_{33} = 3.8 + 2.5 \\times 0.2 = 3.8 + 0.5 = 4.3$\n$J_{43} = -3.4$\nSo, the analytic third column of the Jacobian is $\\mathbf{J}(:,3) = [0, -0.4, 4.3, -3.4]^{\\top}$.\n\nThe sparsity pattern of this column, having non-zero entries only for rows $i=2,3,4$, is consistent with the tridiagonal structure of the Jacobian matrix, which arises from the nearest-neighbor stencil of the 1D FVM discretization. The derivative $\\frac{\\partial R_{i}}{\\partial u_{j}}$ is non-zero only for $j \\in \\{i-1, i, i+1\\}$. For column $j=3$, this implies non-zero entries only for rows $i \\in \\{2, 3, 4\\}$.\n\n**2. Finite-Difference Jacobian Column Assembly**\nThe central finite-difference approximation for the third column is given by:\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) = \\frac{\\mathbf{R}(\\mathbf{u}^{(0)} + h\\,\\mathbf{e}_{3}) - \\mathbf{R}(\\mathbf{u}^{(0)} - h\\,\\mathbf{e}_{3})}{2\\,h}\n$$\nThe Taylor series expansion of a centered difference approximation for a derivative $f'(x)$ is $f'(x) = \\frac{f(x+h) - f(x-h)}{2h} - \\frac{h^2}{6}f'''(x) - O(h^4)$. The approximation is exact if the third and higher derivatives of the function are zero. This is true for any polynomial of degree $2$ or less.\n\nLet's examine the functional form of each residual component $R_{i}$ with respect to the variable $u_{3}$:\n- $R_{1}(\\mathbf{u})$ is independent of $u_{3}$, i.e., a polynomial of degree $0$ in $u_{3}$.\n- $R_{2}(\\mathbf{u})$ is linear in $u_{3}$, i.e., a polynomial of degree $1$ in $u_{3}$.\n- $R_{3}(\\mathbf{u})$ is quadratic in $u_{3}$, i.e., a polynomial of degree $2$ in $u_{3}$.\n- $R_{4}(\\mathbf{u})$ is linear in $u_{3}$, i.e., a polynomial of degree $1$ in $u_{3}$.\n\nFor all $i \\in \\{1,2,3,4\\}$, the third derivative $\\frac{\\partial^3 R_{i}}{\\partial u_{3}^{3}}$ is zero. Therefore, the central difference formula provides the exact value of the derivative, not an approximation. The truncation error is zero.\nConsequently, $\\mathbf{J}_{\\mathrm{FD}}(:,3) = \\mathbf{J}(:,3)$.\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) = \\begin{pmatrix} 0 \\\\ -0.4 \\\\ 4.3 \\\\ -3.4 \\end{pmatrix}\n$$\n\n**Computation of the Euclidean Norm**\nThe final step is to compute the Euclidean two-norm of the difference between the finite-difference and analytic Jacobian columns.\nThe difference vector is:\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) - \\mathbf{J}(:,3) = \\begin{pmatrix} 0 \\\\ -0.4 \\\\ 4.3 \\\\ -3.4 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -0.4 \\\\ 4.3 \\\\ -3.4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe Euclidean norm of the zero vector is:\n$$\n\\left\\| \\mathbf{J}_{\\mathrm{FD}}(:,3) - \\mathbf{J}(:,3) \\right\\|_{2} = \\sqrt{0^{2} + 0^{2} + 0^{2} + 0^{2}} = 0\n$$",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}