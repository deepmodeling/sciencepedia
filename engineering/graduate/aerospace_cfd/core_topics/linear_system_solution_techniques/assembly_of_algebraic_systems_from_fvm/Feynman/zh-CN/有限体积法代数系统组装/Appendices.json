{
    "hands_on_practices": [
        {
            "introduction": "理论知识的掌握最终需要通过实践来检验。本节介绍的第一个动手实践是关于数值方法的验证，这是确保计算结果可靠性的基石。我们将使用“制造解方法”（Method of Manufactured Solutions, MMS）来评估有限体积离散格式的准确性，通过将精确解代入离散方程来计算截断误差。这项练习  不仅能帮助你验证代码实现的正确性，还能让你直观地理解离散格式在特定条件下（例如，在均匀网格上求解低阶多项式解时）如何能够达到零误差，从而实现“精确”。",
            "id": "3944917",
            "problem": "考虑一维线段域上的稳态扩散方程，其包含一个源项，\n$$ -\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right) = f(x), \\quad x \\in [0,1], $$\n其中扩散系数为常数 $\\kappa = 1$（无量纲），边界条件由域端点上给定的法向通量（诺伊曼条件）给出。令 $u(x)$ 是一个足够光滑的精确解。在正交网格上，有限体积法（FVM, Finite Volume Method）对每个控制体积强制执行守恒。对于单元 $i$，记东侧面的法向通量为 $\\phi_{i+1/2}$，西侧面的法向通量为 $\\phi_{i-1/2}$，则守恒定律可写为\n$$ \\phi_{i+1/2} - \\phi_{i-1/2} = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x)\\,dx. $$\n在具有单元中心 $x_i$ 和面位置 $x_{i\\pm 1/2}$ 的正交网格上，采用两点通量近似，通过内部面 $i+1/2$ 的离散面通量为\n$$ \\phi^{\\mathrm{disc}}_{i+1/2} = -\\frac{u(x_{i+1}) - u(x_i)}{x_{i+1} - x_i}, $$\n面 $i-1/2$ 的情况类似。对于诺伊曼边界面，精确的边界通量给定为\n$$ \\phi_{1/2} = -u'(0), \\quad \\phi_{N+1/2} = -u'(1). $$\n令 $N$ 为控制体积的数量。对于正交网格，定义面位置 $\\{x_{j+1/2}\\}_{j=0}^N$ 和单元中心 $\\{x_i\\}_{i=1}^N$，其中 $x_i = \\frac{1}{2}\\left(x_{i-1/2} + x_{i+1/2}\\right)$。为内部两点通量组装线性算子矩阵 $A \\in \\mathbb{R}^{N \\times N}$ 如下\n$$ A_{i,i} = \\begin{cases} \\frac{1}{x_i - x_{i-1}} + \\frac{1}{x_{i+1} - x_i},  1  i  N, \\\\ \\frac{1}{x_2 - x_1},  i = 1, \\\\ \\frac{1}{x_N - x_{N-1}},  i = N, \\end{cases} $$\n$$ A_{i,i-1} = \\begin{cases} -\\frac{1}{x_i - x_{i-1}},  1  i \\le N, \\\\ 0,  i = 1, \\end{cases} \\quad A_{i,i+1} = \\begin{cases} -\\frac{1}{x_{i+1} - x_i},  1 \\le i  N, \\\\ 0,  i = N. \\end{cases} $$\n使用源项在每个控制体积上的精确积分和给定的诺伊曼边界通量，构造右端向量 $b \\in \\mathbb{R}^N$：\n$$ b_i = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x)\\,dx + \\begin{cases} \\phi_{1/2},  i = 1, \\\\ 0,  1  i  N, \\\\ -\\phi_{N+1/2},  i = N. \\end{cases} $$\n对于多项式族 $u(x) = x$、$u(x) = x^2$ 和 $u(x) = x^3$ 中的人造精确解，取 $f(x) = -u''(x)$ 和 $\\phi_{1/2} = -u'(0)$，$\\phi_{N+1/2} = -u'(1)$。令 $u_c \\in \\mathbb{R}^N$ 为在单元中心处计算的精确解值的向量。定义离散截断误差向量\n$$ \\tau = A u_c - b. $$\n您的任务是编写一个程序，对于给定的网格和精确解集合，组装 $A$ 和 $b$，计算 $\\tau$，并为每个测试用例返回无穷范数 $\\|\\tau\\|_\\infty = \\max_i |\\tau_i|$。所有量均为无量纲。\n\n从守恒和两点通量定义出发，使用以下测试套件：\n\n- 测试用例 1（理想情况，线性解在均匀网格上的精确性）：$N = 6$，均匀面 $x_{j+1/2} = j/N$（其中 $j = 0,1,\\dots,N$），精确解 $u(x) = x$。\n- 测试用例 2（理想情况，二次解在均匀网格上的精确性）：$N = 6$，均匀面 $x_{j+1/2} = j/N$，精确解 $u(x) = x^2$。\n- 测试用例 3（非均匀网格，线性解在正交网格上的精确性）：$N = 6$，非均匀面 $x_{j+1/2} = (j/N)^2$，精确解 $u(x) = x$。\n- 测试用例 4（非均匀网格，二次解失去精确性）：$N = 6$，非均匀面 $x_{j+1/2} = (j/N)^2$，精确解 $u(x) = x^2$。\n- 测试用例 5（边界情况，均匀网格下最少的内部单元）：$N = 2$，均匀面 $x_{j+1/2} = j/N$，精确解 $u(x) = x$。\n- 测试用例 6（均匀网格，非精确三次解）：$N = 6$，均匀面 $x_{j+1/2} = j/N$，精确解 $u(x) = x^3$。\n\n对于每个测试用例，计算并报告单个浮点数 $\\|\\tau\\|_\\infty$。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[r1,r2,r3,r4,r5,r6]”）。这些浮点数必须进行数值计算，并使用 Python 默认的浮点数格式打印。不涉及角度；所有值均为无量纲。",
            "solution": "该问题是适定的、科学上合理的，并包含进行求解所需的所有必要信息。它要求计算一维稳态扩散方程的单元中心有限体积离散化中截断误差向量的无穷范数。\n\n控制方程为\n$$\n-\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right) = f(x), \\quad x \\in [0,1],\n$$\n其中扩散系数为常数 $\\kappa = 1$。边界条件为诺伊曼类型，规定了 $x=0$ 和 $x=1$ 处的法向通量。通量定义为 $\\phi = -\\kappa \\frac{du}{dx}$。当 $\\kappa=1$ 时，简化为 $\\phi = -\\frac{du}{dx}$。\n\n有限体积法（FVM）将域 $[0,1]$ 离散化为 $N$ 个连续的控制体积（单元）。令单元 $i$（$i=1, \\dots, N$）由区间 $[x_{i-1/2}, x_{i+1/2}]$ 定义。单元中心为 $x_i = \\frac{1}{2}(x_{i-1/2} + x_{i+1/2})$。在单元 $i$ 上对控制方程进行积分，得到守恒定律：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} -\\frac{d}{dx}\\left(\\frac{du}{dx}\\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\n$$\n-\\left[\\frac{du}{dx}\\right]_{x_{i-1/2}}^{x_{i+1/2}} = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\n$$\n\\left(-\\frac{du}{dx}\\bigg|_{x_{i+1/2}}\\right) - \\left(-\\frac{du}{dx}\\bigg|_{x_{i-1/2}}\\right) = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\n将精确的面通量记为 $\\phi_{i\\pm 1/2} = -u'(x_{i\\pm 1/2})$，则守恒定律为 $\\phi_{i+1/2} - \\phi_{i-1/2} = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx$。\n\n该问题对内部面使用两点通量近似，其中通量使用相邻单元中心的值来近似：\n$$\n\\phi^{\\mathrm{disc}}_{i+1/2} = -\\frac{u(x_{i+1}) - u(x_i)}{x_{i+1} - x_i}\n$$\n将这些离散通量代入内部单元 $i$（$1  i  N$）的守恒定律，得到：\n$$\n\\left(-\\frac{u_{i+1} - u_i}{x_{i+1} - x_i}\\right) - \\left(-\\frac{u_i - u_{i-1}}{x_i - x_{i-1}}\\right) \\approx \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\n其中 $u_i$ 是 $u(x_i)$ 的离散近似值。重新排列各项，将未知数 $u_i$ 组合在左侧，得到线性系统 $Au_h = b$ 的第 $i$ 行：\n$$\n-\\frac{1}{x_i - x_{i-1}}u_{i-1} + \\left(\\frac{1}{x_i - x_{i-1}} + \\frac{1}{x_{i+1} - x_i}\\right)u_i - \\frac{1}{x_{i+1} - x_i}u_{i+1} \\approx \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\n这对应于矩阵 $A$ 在 $1  i  N$ 时的定义。\n\n对于边单元，使用给定的诺伊曼通量。\n对于单元 $i=1$：$\\phi_{3/2} - \\phi_{1/2} = \\int_{x_{1/2}}^{x_{3/2}} f(x) dx$。通量 $\\phi_{1/2} = -u'(0)$ 是一个给定值。只有 $\\phi_{3/2}$ 被离散化：\n$$\n-\\frac{u_2 - u_1}{x_2 - x_1} - \\phi_{1/2} \\approx \\int_{x_{1/2}}^{x_{3/2}} f(x) dx \\implies \\frac{1}{x_2-x_1}u_1 - \\frac{1}{x_2-x_1}u_2 \\approx \\int_{x_{1/2}}^{x_{3/2}} f(x) dx + \\phi_{1/2}\n$$\n这与 $A$ 的第一行和 $b$ 的第一个分量的定义相匹配。\n\n对于单元 $i=N$：$\\phi_{N+1/2} - \\phi_{N-1/2} = \\int_{x_{N-1/2}}^{x_{N+1/2}} f(x) dx$。通量 $\\phi_{N+1/2} = -u'(1)$ 是给定的。\n$$\n\\phi_{N+1/2} - \\left(-\\frac{u_N - u_{N-1}}{x_N - x_{N-1}}\\right) \\approx \\int_{x_{N-1/2}}^{x_{N+1/2}} f(x) dx \\implies -\\frac{1}{x_N - x_{N-1}}u_{N-1} + \\frac{1}{x_N - x_{N-1}}u_N \\approx \\int_{x_{N-1/2}}^{x_{N+1/2}} f(x) dx - \\phi_{N+1/2}\n$$\n这与 $A$ 的最后一行和 $b$ 的最后一个分量的定义相匹配。\n\n截断误差向量 $\\tau$ 定义为将精确解 $u(x)$（在单元中心处取值）代入离散系统后得到的残差：$\\tau = A u_c - b$。这里，$u_c$ 是分量为 $(u_c)_i = u(x_i)$ 的向量。任务是为几个测试用例计算 $\\|\\tau\\|_\\infty = \\max_i |\\tau_i|$。\n\n源项由精确解人造得出，即 $f(x) = -u''(x)$。边界通量被一致地定义为 $\\phi_{1/2} = -u'(0)$ 和 $\\phi_{N+1/2} = -u'(1)$。\n\n对于由 $N$、网格生成规则和精确解 $u(x)$ 指定的给定测试用例，步骤如下：\n1. 根据给定的规则和 $N$ 生成面坐标 $\\{x_{j+1/2}\\}_{j=0}^N$。\n2. 计算单元中心坐标 $x_i = \\frac{1}{2}(x_{i-1/2} + x_{i+1/2})$（其中 $i=1, \\dots, N$）。\n3. 通过在每个单元中心 $x_i$ 处计算 $u(x_i)$ 来构造精确解向量 $u_c$。\n4. 使用提供的公式组装 $N \\times N$ 矩阵 $A$，这些公式依赖于单元中心之间的距离。\n5. 组装 $N \\times 1$ 向量 $b$。对于每个分量 $b_i$，这涉及两个部分：\n    a. 积分源项：$\\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} -u''(x) dx = -[u'(x)]_{x_{i-1/2}}^{x_{i+1/2}} = u'(x_{i-1/2}) - u'(x_{i+1/2})$。对于提供的多项式解，该积分可以精确计算。\n    b. 边界通量：将 $\\phi_{1/2} = -u'(0)$ 加到 $b_1$ 上，并从 $b_N$ 中减去 $\\phi_{N+1/2} = -u'(1)$。\n6. 计算截断误差向量 $\\tau = A u_c - b$。\n7. 求得所得向量的无穷范数 $\\|\\tau\\|_\\infty = \\max_{i} |\\tau_i|$。\n\n两点通量近似的性质预示了以下结果：\n- 对于线性解 $u(x) = ax+b$，导数的近似 $u'(x_{i+1/2}) \\approx \\frac{u(x_{i+1})-u(x_i)}{x_{i+1}-x_i}$ 是精确的。因此，离散通量在任何位置都与精确通量相同，对于任何正交网格，截断误差 $\\tau$ 都将为零。测试用例 1、3 和 5 应得出 $\\|\\tau\\|_\\infty = 0$。\n- 对于二次解 $u(x) = ax^2+bx+c$，当且仅当面 $x_{i+1/2}$ 是相邻单元中心 $x_i$ 和 $x_{i+1}$ 的几何中点时，该近似才是精确的。此条件对于均匀面网格成立。因此，对于测试用例 2（均匀网格），预期 $\\|\\tau\\|_\\infty = 0$。对于测试用例 4（非均匀网格），该条件被违反，预期会出现非零的截断误差。\n- 对于三次解 $u(x) = ax^3+\\dots$，即使在均匀网格上，该近似也不再精确。预期测试用例 6 会有非零的截断误差。\n\n实现将为每个测试用例精确遵循这些步骤，以计算 $\\|\\tau\\|_\\infty$ 的数值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n\n    def process_case(N, face_pos_fn, u_family_name):\n        \"\"\"\n        Processes a single test case to compute the infinity norm of the truncation error.\n        \n        Args:\n            N (int): Number of control volumes.\n            face_pos_fn (callable): A function `f(j, N)` that returns the position of face j.\n            u_family_name (str): The family of the exact solution ('x', 'x^2', 'x^3').\n        \n        Returns:\n            float: The infinity norm of the truncation error vector.\n        \"\"\"\n        # 1. Define manufactured solution functions based on the family name\n        if u_family_name == 'x':\n            u = lambda x: x\n            u_prime = lambda x: np.ones_like(x)\n            u_dprime = lambda x: np.zeros_like(x)\n        elif u_family_name == 'x^2':\n            u = lambda x: x**2\n            u_prime = lambda x: 2 * x\n            u_dprime = lambda x: 2 * np.ones_like(x)\n        elif u_family_name == 'x^3':\n            u = lambda x: x**3\n            u_prime = lambda x: 3 * x**2\n            u_dprime = lambda x: 6 * x\n        else:\n            raise ValueError(\"Unknown solution family\")\n\n        # 2. Generate mesh\n        # Face positions x_{j+1/2} for j = 0..N\n        # Using a direct mapping: x_faces[j] corresponds to the coordinate of the j-th face.\n        # Problem statement face indices {x_j+1/2}_j=0^N can map to array indices 0..N\n        # So x_{i-1/2} -> x_faces[i-1] and x_{i+1/2} -> x_faces[i]\n        x_faces = np.array([face_pos_fn(j, N) for j in range(N + 1)], dtype=np.float64)\n        \n        # Cell centers x_i for i = 1..N\n        # x_centers[i-1] corresponds to x_i\n        x_centers = 0.5 * (x_faces[:-1] + x_faces[1:])\n\n        # 3. Assemble matrix A\n        A = np.zeros((N, N), dtype=np.float64)\n        \n        # Distances between cell centers\n        d_centers = x_centers[1:] - x_centers[:-1]\n        \n        # Diagonal and off-diagonal entries\n        if N > 1:\n            # A_{i, i-1} for i=2..N\n            A.ravel()[N + 0::N+1] = -1.0 / d_centers\n            # A_{i, i+1} for i=1..N-1\n            A.ravel()[1::N+1] = -1.0 / d_centers\n\n        # Diagonal entries A_{i,i}\n        if N == 1:\n            # Special case for N=1, where A is just a 1x1 matrix of 0\n            pass\n        elif N > 1:\n            # For i=1\n            A[0, 0] = 1.0 / d_centers[0]\n            # For i=N\n            A[N-1, N-1] = 1.0 / d_centers[-1]\n            # For 1  i  N\n            for i in range(1, N - 1):\n                A[i, i] = (1.0 / d_centers[i-1]) + (1.0 / d_centers[i])\n        \n        # 4. Assemble RHS vector b\n        b = np.zeros(N, dtype=np.float64)\n        \n        # Source integrals: integral(-u''(x))dx from x_{i-1/2} to x_{i+1/2}\n        # This is -[u'(x)] from x_{i-1/2} to x_{i+1/2} = u'(x_{i-1/2}) - u'(x_{i+1/2})\n        source_integrals = u_prime(x_faces[:-1]) - u_prime(x_faces[1:])\n        b[:] = source_integrals\n        \n        # Boundary fluxes\n        phi_0 = -u_prime(x_faces[0])  # at x=0\n        phi_1 = -u_prime(x_faces[-1]) # at x=1\n        \n        b[0] += phi_0\n        if N > 0:\n            b[-1] -= phi_1\n            \n        # 5. Get exact solution vector at cell centers\n        u_c = u(x_centers)\n        \n        # 6. Compute truncation error vector and its infinity norm\n        tau = A @ u_c - b\n        tau_inf_norm = np.max(np.abs(tau)) if N > 0 else 0.0\n        \n        return tau_inf_norm\n\n    # Test cases from the problem statement\n    test_cases = [\n        {'N': 6, 'mesh': 'uniform', 'sol': 'x'},\n        {'N': 6, 'mesh': 'uniform', 'sol': 'x^2'},\n        {'N': 6, 'mesh': 'nonuniform', 'sol': 'x'},\n        {'N': 6, 'mesh': 'nonuniform', 'sol': 'x^2'},\n        {'N': 2, 'mesh': 'uniform', 'sol': 'x'},\n        {'N': 6, 'mesh': 'uniform', 'sol': 'x^3'},\n    ]\n\n    mesh_functions = {\n        'uniform': lambda j, N: j / N,\n        'nonuniform': lambda j, N: (j / N)**2,\n    }\n\n    results = []\n    for case in test_cases:\n        N = case['N']\n        face_pos_fn = mesh_functions[case['mesh']]\n        u_family_name = case['sol']\n        result = process_case(N, face_pos_fn, u_family_name)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "任何流动问题的求解都离不开边界条件的正确处理。在有限体积法中，如何将物理边界条件整合进全局代数系统是一个核心技术点。本练习将带你探索两种最常用的处理狄利克雷（Dirichlet）边界条件的方法：直接销元法（Elimination method）和罚函数法（Penalty method）。通过这个练习 ，你不仅能学会如何修改代数方程组以施加边界条件，还将深入分析这两种方法对系统矩阵条件数 $\\kappa_2(\\boldsymbol{A})$ 的影响，从而理解不同实现方式对数值稳定性和求解效率的深远影响。",
            "id": "3944932",
            "problem": "考虑一个厚度为 $L$、导热系数 $k$ 为常数的平板中的一维稳态热传导问题，其控制方程为守恒定律 $\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right)=0$。使用有限体积法 (FVM)，在一个均匀网格上建立代数系统，该网格包含三个宽度为 $h$、横截面积为 $A$ 的控制体积，单元中心的未知温度为 $\\{T_1,T_2,T_3\\}$。假设位于 $x=0$ 的左边界满足狄利克雷条件 $T(0)=T_D$，位于 $x=L$ 的右边界是绝热的，即满足诺伊曼条件 $-\\left.k\\frac{dT}{dx}\\right|_{x=L}=0$。设边界处的面到中心距离为 $h/2$，相邻单元中心之间的距离为 $h$，并在各个面上使用线性（两点）扩散通量近似。\n\n您将针对狄利克雷边界的两种不同处理方法，建立离散矩阵 $\\boldsymbol{A}$ 和右端项 $\\boldsymbol{b}$：\n\n- 消元法：通过在全局系统中进行行和列的消元来强制施加 $T_1=T_D$，并通过将耦合项移到右端项来保持对称性。\n- 罚函数法：保留原始行，并在狄利克雷自由度上附加一个强度为 $\\gamma0$ 的罚项。\n\n使用无量纲常数 $k=1$、$h=1$、$A=1$，使得内部扩散传导系数为1。从 FVM 通量平衡的第一性原理出发，写出三个控制体积的未修改的传导模板，然后：\n\n1. 使用消元法，写出对矩阵元素和右端项的精确代数修改。以 $T_D$ 的形式明确给出最终组装的 $\\boldsymbol{A}_{\\text{elim}}$ 和 $\\boldsymbol{b}_{\\text{elim}}$。\n2. 使用罚函数法，写出对矩阵元素和右端项的精确代数修改。以 $T_D$ 和 $\\gamma$ 的形式明确给出最终组装的 $\\boldsymbol{A}_{\\text{pen}}$ 和 $\\boldsymbol{b}_{\\text{pen}}$。\n3. 对每个组装的矩阵，基于其最大与最小特征值之比，分析其 2-范数条件数 $\\kappa_2(\\boldsymbol{A})$。对于消元法，精确计算 $\\kappa_2(\\boldsymbol{A}_{\\text{elim}})$。对于罚函数法，当 $\\gamma\\to\\infty$ 时，推导 $\\kappa_2(\\boldsymbol{A}_{\\text{pen}})$ 的主阶渐近形式，只保留 $\\gamma$ 的主导标度。\n\n最后，当 $\\gamma\\to\\infty$ 时，推导条件数之比的主阶渐近表达式\n$$\n\\frac{\\kappa_2\\!\\left(\\boldsymbol{A}_{\\text{pen}}\\right)}{\\kappa_2\\!\\left(\\boldsymbol{A}_{\\text{elim}}\\right)}.\n$$\n将最终答案表示为关于 $\\gamma$ 和根式的单个闭式解析表达式。无需四舍五入，也无需报告物理单位。定义：有限体积法 (FVM)，计算流体动力学 (CFD)。",
            "solution": "该问题陈述具有科学依据、是适定的、客观且内部一致的。它提出了一个在使用有限体积法进行偏微分方程数值分析领域的标准、可验证的问题。该问题是有效的。\n\n我们首先将有限体积法 (FVM) 应用于一维稳态热传导方程 $\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right)=0$。在一个横截面积为 $A$ 的控制体积 $V_i$ 上，从其西面 ($w$) 到东面 ($e$) 进行积分，得到：\n$$ \\int_{V_i} \\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) dV = \\int_{x_w}^{x_e} A \\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) dx = A \\left[k \\frac{dT}{dx}\\right]_{x_w}^{x_e} = 0 $$\n这给出了通量平衡：$\\left(k A \\frac{dT}{dx}\\right)_e - \\left(k A \\frac{dT}{dx}\\right)_w = 0$。一个面上的热通量为 $q = -k A \\frac{dT}{dx}$。因此，平衡关系为 $q_w - q_e = 0$。\n\n我们使用一个包含三个控制体积的均匀网格，每个控制体积的宽度为 $h$。区域的总长度为 $L=3h$。单元中心位于 $x_1 = h/2$，$x_2 = 3h/2$ 和 $x_3 = 5h/2$。无量纲常数为 $k=1$，$h=1$，$A=1$。因此，$L=3$，单元中心位于 $x_1=0.5$，$x_2=1.5$，$x_3=2.5$。各个面位于 $x=0, 1, 2, 3$。\n\n单元 $i$ 和 $i+1$ 之间的内界面上的通量近似为：\n$$ q_{i+1/2} = -k_f A_f \\frac{T_{i+1}-T_i}{x_{i+1}-x_i} = -(1)(1)\\frac{T_{i+1}-T_i}{1} = -(T_{i+1}-T_i) $$\n内部单元之间的扩散传导系数为 $C_{int} = kA/h = 1$。\n\n现在我们为每个控制体积建立方程，这构成了两种所需方法的基础。\n\n**控制体积 1 (中心位于 $x_1=0.5$)：**\n西面是位于 $x=0$ 的边界，其中 $T(0)=T_D$。通量为 $q_w = -kA \\frac{T_1 - T_D}{x_1 - 0} = - (1)(1) \\frac{T_1 - T_D}{0.5-0} = -2(T_1-T_D)$。\n东面位于 $x=1$，在单元 1 和 2 之间。通量为 $q_e = -(T_2-T_1)$。\n通量平衡 $q_w - q_e = 0$ 给出：$-2(T_1-T_D) - (-(T_2-T_1)) = 0$，化简为 $-2T_1+2T_D+T_2-T_1=0$，即 $3T_1-T_2 = 2T_D$。\n\n**控制体积 2 (中心位于 $x_2=1.5$)：**\n西面位于 $x=1$，所以 $q_w = -(T_2-T_1)$。\n东面位于 $x=2$，在单元 2 和 3 之间，所以 $q_e = -(T_3-T_2)$。\n通量平衡 $q_w - q_e = 0$ 给出：$-(T_2-T_1) - (-(T_3-T_2))=0$，化简为 $-T_2+T_1+T_3-T_2=0$，即 $-T_1+2T_2-T_3=0$。\n\n**控制体积 3 (中心位于 $x_3=2.5$)：**\n西面位于 $x=2$，所以 $q_w = -(T_3-T_2)$。\n东面位于边界 $x=L=3$ 处，该边界是绝热的。条件是 $-\\left.k\\frac{dT}{dx}\\right|_{x=L}=0$，这意味着通量 $q_e=0$。\n通量平衡 $q_w - q_e = 0$ 给出：$-(T_3-T_2) - 0 = 0$，即 $-T_2+T_3=0$。\n\n组装得到的系统，我们称之为基础系统，是：\n$$\n\\begin{pmatrix}\n3   -1  0 \\\\\n-1  2   -1 \\\\\n0   -1  1\n\\end{pmatrix}\n\\begin{pmatrix}\nT_1 \\\\ T_2 \\\\ T_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2T_D \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\n记该系统为 $\\boldsymbol{A}_{\\text{base}}\\boldsymbol{T} = \\boldsymbol{b}_{\\text{base}}$。\n\n### 1. 消元法\n\n消元法在组装的系统上强制施加狄利克雷条件 $T_1=T_D$，同时保持对称性。我们修改系统，使得第一个方程变为 $T_1=T_D$，并且从 $T_1$ 到其他方程的耦合项被移到右端项。\n\n第二个方程是 $-T_1+2T_2-T_3=0$。代入 $T_1=T_D$，它变为 $2T_2-T_3 = T_D$。这等价于更新右端项：$b_2' = b_2 - A_{21}T_D = 0 - (-1)T_D = T_D$。\n第三个方程 $ -T_2+T_3=0$ 不涉及 $T_1$，因此保持不变。\n第一个方程被约束条件 $T_1=T_D$ 替代。\n为了保持对称的矩阵结构，我们将第一行和第一列的非对角元素设为零，并将对角元素 $A_{11}$ 设为 1。修改后的系统 $\\boldsymbol{A}_{\\text{elim}}\\boldsymbol{T} = \\boldsymbol{b}_{\\text{elim}}$ 是：\n$$\n\\boldsymbol{A}_{\\text{elim}} =\n\\begin{pmatrix}\n1   0  0 \\\\\n0   2  -1 \\\\\n0   -1  1\n\\end{pmatrix},\n\\quad\n\\boldsymbol{b}_{\\text{elim}} =\n\\begin{pmatrix}\nT_D \\\\\nT_D \\\\\n0\n\\end{pmatrix}\n$$\n\n### 2. 罚函数法\n\n罚函数法通过向第一个方程添加一个罚项来强制施加狄利克雷条件 $T_1 \\approx T_D$。这是通过在基础系统的对角元素 $A_{11}$ 上加上 $\\gamma$ 并在右端项 $b_1$ 上加上 $\\gamma T_D$ 来实现的。\n从 $\\boldsymbol{A}_{\\text{base}}$ 和 $\\boldsymbol{b}_{\\text{base}}$ 开始：\n$A_{11, \\text{pen}} = A_{11, \\text{base}} + \\gamma = 3+\\gamma$。\n$b_{1, \\text{pen}} = b_{1, \\text{base}} + \\gamma T_D = 2T_D + \\gamma T_D = (2+\\gamma)T_D$。\n系统的其他行保持不变。得到的系统 $\\boldsymbol{A}_{\\text{pen}}\\boldsymbol{T} = \\boldsymbol{b}_{\\text{pen}}$ 是：\n$$\n\\boldsymbol{A}_{\\text{pen}} =\n\\begin{pmatrix}\n3+\\gamma   -1  0 \\\\\n-1  2   -1 \\\\\n0   -1  1\n\\end{pmatrix},\n\\quad\n\\boldsymbol{b}_{\\text{pen}} =\n\\begin{pmatrix}\n(2+\\gamma)T_D \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n\n### 3. 条件数分析\n\n2-范数条件数为 $\\kappa_2(\\boldsymbol{A}) = \\frac{|\\lambda_{\\max}|}{|\\lambda_{\\min}|}$。\n\n**$\\boldsymbol{A}_{\\text{elim}}$ 的条件数：**\n$\\boldsymbol{A}_{\\text{elim}}$ 的特征值 $\\lambda$ 通过 $\\det(\\boldsymbol{A}_{\\text{elim}} - \\lambda\\boldsymbol{I}) = 0$ 求得。\n$$ \\det\\begin{pmatrix} 1-\\lambda   0  0 \\\\ 0  2-\\lambda  -1 \\\\ 0  -1  1-\\lambda \\end{pmatrix} = (1-\\lambda)[(2-\\lambda)(1-\\lambda) - 1] = 0 $$\n一个特征值是 $\\lambda_1=1$。另外两个是 $\\lambda^2-3\\lambda+1=0$ 的根，即 $\\lambda_{2,3} = \\frac{3 \\pm \\sqrt{5}}{2}$。\n特征值为 $\\lambda_{\\max} = \\frac{3+\\sqrt{5}}{2}$、$\\lambda_{\\min} = \\frac{3-\\sqrt{5}}{2}$ 和 $1$。\n所以，$\\lambda_{\\max}(\\boldsymbol{A}_{\\text{elim}}) = \\frac{3+\\sqrt{5}}{2}$ 且 $\\lambda_{\\min}(\\boldsymbol{A}_{\\text{elim}}) = \\frac{3-\\sqrt{5}}{2}$。\n$$ \\kappa_2(\\boldsymbol{A}_{\\text{elim}}) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(3+\\sqrt{5})/2}{(3-\\sqrt{5})/2} = \\frac{3+\\sqrt{5}}{3-\\sqrt{5}} = \\frac{(3+\\sqrt{5})^2}{(3-\\sqrt{5})(3+\\sqrt{5})} = \\frac{9+6\\sqrt{5}+5}{9-5} = \\frac{14+6\\sqrt{5}}{4} = \\frac{7+3\\sqrt{5}}{2} $$\n\n**当 $\\gamma \\to \\infty$ 时 $\\boldsymbol{A}_{\\text{pen}}$ 的渐近条件数：**\n特征方程为 $\\det(\\boldsymbol{A}_{\\text{pen}} - \\lambda \\boldsymbol{I})=0$。\n$$ (3+\\gamma-\\lambda)((2-\\lambda)(1-\\lambda)-1) - (-1)(-(1-\\lambda)) = 0 $$\n$$ (3+\\gamma-\\lambda)(\\lambda^2-3\\lambda+1) - (1-\\lambda) = 0 $$\n$$ \\lambda^3 - (6+\\gamma)\\lambda^2 + (9+3\\gamma)\\lambda - (2+\\gamma) = 0 $$\n当 $\\gamma \\to \\infty$ 时，我们预期一个大特征值 $\\lambda_{\\max} \\sim O(\\gamma)$ 和两个量级为 $O(1)$ 的小特征值。\n对于小特征值，我们将多项式除以 $\\gamma$ 并取 $\\gamma \\to \\infty$ 的极限：\n$$ \\frac{\\lambda^3}{\\gamma} - (1+\\frac{6}{\\gamma})\\lambda^2 + (3+\\frac{9}{\\gamma})\\lambda - (1+\\frac{2}{\\gamma}) = 0 \\quad\\to\\quad -\\lambda^2+3\\lambda-1=0 $$\n这给出 $\\lambda^2-3\\lambda+1=0$，因此两个较小的特征值收敛于 $\\frac{3 \\pm \\sqrt{5}}{2}$。于是，$\\lambda_{\\min}(\\boldsymbol{A}_{\\text{pen}}) \\to \\frac{3-\\sqrt{5}}{2}$。\n对于大特征值，特征值之和为 $\\lambda_1+\\lambda_2+\\lambda_3 = 6+\\gamma$。当 $\\gamma\\to\\infty$ 时，$\\lambda_{\\max} + \\frac{3+\\sqrt{5}}{2} + \\frac{3-\\sqrt{5}}{2} \\approx 6+\\gamma$。\n$\\lambda_{\\max} + 3 \\approx 6+\\gamma$，所以 $\\lambda_{\\max} \\approx \\gamma+3$。\n主阶项是 $\\lambda_{\\max} \\sim \\gamma$。\n渐近条件数为：\n$$ \\kappa_2(\\boldsymbol{A}_{\\text{pen}}) \\sim \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} \\sim \\frac{\\gamma}{\\frac{3-\\sqrt{5}}{2}} = \\frac{2\\gamma}{3-\\sqrt{5}} = \\frac{2\\gamma(3+\\sqrt{5})}{9-5} = \\gamma\\frac{3+\\sqrt{5}}{2} $$\n\n**条件数之比：**\n最后，我们计算当 $\\gamma \\to \\infty$ 时该比值的主阶渐近表达式：\n$$ \\frac{\\kappa_2(\\boldsymbol{A}_{\\text{pen}})}{\\kappa_2(\\boldsymbol{A}_{\\text{elim}})} \\sim \\frac{\\gamma\\frac{3+\\sqrt{5}}{2}}{\\frac{7+3\\sqrt{5}}{2}} = \\gamma \\frac{3+\\sqrt{5}}{7+3\\sqrt{5}} $$\n为了化简分数，我们将分母有理化：\n$$ \\gamma \\frac{3+\\sqrt{5}}{7+3\\sqrt{5}} \\times \\frac{7-3\\sqrt{5}}{7-3\\sqrt{5}} = \\gamma \\frac{(3+\\sqrt{5})(7-3\\sqrt{5})}{7^2 - (3\\sqrt{5})^2} = \\gamma \\frac{21 - 9\\sqrt{5} + 7\\sqrt{5} - 3(5)}{49 - 9(5)} $$\n$$ = \\gamma \\frac{21-15-2\\sqrt{5}}{49-45} = \\gamma \\frac{6-2\\sqrt{5}}{4} = \\gamma \\frac{3-\\sqrt{5}}{2} $$\n该比值的主阶渐近表达式是 $\\gamma \\frac{3-\\sqrt{5}}{2}$。",
            "answer": "$$\n\\boxed{\\gamma \\frac{3-\\sqrt{5}}{2}}\n$$"
        },
        {
            "introduction": "对于求解稳态问题或处理包含刚性项的瞬态问题，隐式方法是不可或缺的，而这些方法的核心在于雅可比矩阵 $\\boldsymbol{J}$ 的构建。这项实践旨在揭示雅可比矩阵的组装过程，并比较两种获取其列向量的途径：解析方法（模拟自动微分的原理）和数值近似（有限差分法）。通过解决这个问题 ，你将清晰地看到有限体积法的计算模板如何直接决定了雅可比矩阵的稀疏结构，并会发现一个重要的特性：对于低阶多项式非线性项，中心差分近似可以得到与解析微分完全相同的结果，这为高效计算雅可比矩阵提供了深刻的见解。",
            "id": "3944905",
            "problem": "考虑在均匀网格上，使用有限体积法（FVM）离散的一维稳态对流扩散方程，该方程包含一个非线性源项。设计算域长度为 $L=1$，划分为 $N=4$ 个等大的控制体积，每个控制体积的宽度为 $\\Delta x = L/N = 0.25$，横截面积为常数 $A=1$。扩散系数为 $\\Gamma=0.1$，密度为 $\\rho=1$，均匀对流速度为 $V=3$，方向从左到右。左、右狄利克雷（Dirichlet）边界值分别为 $u_{L}=1$ 和 $u_{R}=0$。非线性源项为 $S(u) = k\\,u^{2}$，其中 $k=5$，因此在单元 $i$ 上的体积源项积分为 $k\\,A\\,\\Delta x\\,u_{i}^{2}$。\n\n将 $N=4$ 个单元中心的未知量向量表示为 $\\mathbf{u} = [u_{1},u_{2},u_{3},u_{4}]^{\\top}$。对于每个内部控制体积 $i \\in \\{1,2,3,4\\}$，将残差 $R_{i}(\\mathbf{u})$ 定义为对流通量和扩散通量的净流出量加上体积源项：\n$$\nR_{i}(\\mathbf{u}) = \\big(F_{c,i+\\frac{1}{2}} - F_{c,i-\\frac{1}{2}}\\big) + \\big(F_{d,i+\\frac{1}{2}} - F_{d,i-\\frac{1}{2}}\\big) + k\\,A\\,\\Delta x\\,u_{i}^{2},\n$$\n其中，对于正的 $V$，在面 $i+\\frac{1}{2}$ 处的迎风对流通量为 $F_{c,i+\\frac{1}{2}} = \\rho\\,V\\,A\\,u_{i}$，在左边界的面 $\\frac{1}{2}$ 处为 $F_{c,\\frac{1}{2}}=\\rho\\,V\\,A\\,u_{L}$。在面 $i+\\frac{1}{2}$ 处的扩散通量为 $F_{d,i+\\frac{1}{2}} = -\\Gamma\\,A\\,\\frac{u_{i+1}-u_{i}}{\\Delta x}$，在边界面上使用 $u_{L}$ 和 $u_{R}$ 代替 $u_{0}$ 和 $u_{5}$。\n\n设当前迭代值为\n$$\n\\mathbf{u}^{(0)} = [0.8,\\,0.5,\\,0.2,\\,0.1]^{\\top}.\n$$\n令 $\\mathbf{J}(\\mathbf{u})$ 表示 $\\mathbf{R}(\\mathbf{u})$ 相对于 $\\mathbf{u}$ 的雅可比（Jacobian）矩阵。你的任务是使用两种方法在 $\\mathbf{u}^{(0)}$ 处构建雅可比矩阵的第三列 $\\mathbf{J}(:,3)$：\n1. 通过对残差定义关于 $u_{3}$ 求导，进行与自动微分（AD）原理一致的解析构建。\n2. 使用扰动步长 $h = 10^{-6}$ 的中心有限差分近似，\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) \\approx \\frac{\\mathbf{R}(\\mathbf{u}^{(0)} + h\\,\\mathbf{e}_{3}) - \\mathbf{R}(\\mathbf{u}^{(0)} - h\\,\\mathbf{e}_{3})}{2\\,h},\n$$\n其中 $\\mathbf{e}_{3}$ 是 $\\mathbb{R}^{4}$ 中的第三个标准基向量。\n\n计算这两列，讨论它们的稀疏模式，并最终计算欧几里得（Euclidean）二范数\n$$\n\\left\\| \\mathbf{J}_{\\mathrm{FD}}(:,3) - \\mathbf{J}(:,3) \\right\\|_{2}.\n$$\n将此范数作为你的最终答案。无需四舍五入。最终答案以纯数字形式表示，不带单位。",
            "solution": "问题已根据指定标准进行验证。\n\n**步骤1：提取已知条件**\n- **区域与网格**：长度 $L=1$，控制体积数量 $N=4$，控制体积宽度 $\\Delta x = L/N = 0.25$，横截面积 $A=1$。\n- **物理常数**：扩散系数 $\\Gamma=0.1$，密度 $\\rho=1$，均匀对流速度 $V=3$ (正值)。\n- **边界条件**：狄利克雷（Dirichlet）类型，左边界值 $u_{L}=1$，右边界值 $u_{R}=0$。\n- **源项**：$S(u) = k\\,u^{2}$，其中 $k=5$。在单元 $i$ 上的积分源项为 $k\\,A\\,\\Delta x\\,u_{i}^{2}$。\n- **未知量与迭代值**：未知量向量 $\\mathbf{u} = [u_{1},u_{2},u_{3},u_{4}]^{\\top}$，当前迭代值 $\\mathbf{u}^{(0)} = [0.8,\\,0.5,\\,0.2,\\,0.1]^{\\top}$。\n- **残差定义**：对于单元 $i$，$R_{i}(\\mathbf{u}) = \\big(F_{c,i+\\frac{1}{2}} - F_{c,i-\\frac{1}{2}}\\big) + \\big(F_{d,i+\\frac{1}{2}} - F_{d,i-\\frac{1}{2}}\\big) + k\\,A\\,\\Delta x\\,u_{i}^{2}$。\n- **通量定义 (对于 $V0$ 使用迎风格式)**：\n  - 对流通量：在普通界面处为 $F_{c,i+\\frac{1}{2}} = \\rho\\,V\\,A\\,u_{i}$，在左边界处为 $F_{c,\\frac{1}{2}}=\\rho\\,V\\,A\\,u_{L}$。\n  - 扩散通量：$F_{d,i+\\frac{1}{2}} = -\\Gamma\\,A\\,\\frac{u_{i+1}-u_{i}}{\\Delta x}$。\n- **有限差分近似**：使用步长 $h = 10^{-6}$ 和中心差分公式的雅可比矩阵列近似：\n  $$\n  \\mathbf{J}_{\\mathrm{FD}}(:,3) \\approx \\frac{\\mathbf{R}(\\mathbf{u}^{(0)} + h\\,\\mathbf{e}_{3}) - \\mathbf{R}(\\mathbf{u}^{(0)} - h\\,\\mathbf{e}_{3})}{2\\,h}\n  $$\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了一个标准的、使用有限体积法离散的、带非线性源项的一维稳态对流扩散方程。这是计算流体动力学和传热学中一个基本且成熟的问题。\n- **适定性**：所有必需的参数、边界条件和本构关系（通量定义）均已提供。该问题是自洽的，在数学上没有歧义。\n- **客观性**：问题以精确的数学和工程术语陈述，没有主观性。\n\n未发现使问题无效的缺陷。该问题被视为有效。\n\n**步骤3：结论与行动**\n问题有效。解决方案将在下面提供。\n\n首先，我们为 $N=4$ 个控制体积中的每一个建立离散化的残差方程。根据给定参数，我们定义两个关键系数：\n对流通量系数：$C = \\rho\\,V\\,A = 1 \\times 3 \\times 1 = 3$。\n扩散通量系数：$D = \\frac{\\Gamma\\,A}{\\Delta x} = \\frac{0.1 \\times 1}{0.25} = 0.4$。\n单元 $i$ 的源项系数为 $k\\,A\\,\\Delta x = 5 \\times 1 \\times 0.25 = 1.25$。\n\n对于一个普通的内部单元 $i \\in \\{2, 3\\}$，其残差为：\n$R_{i}(\\mathbf{u}) = (C\\,u_{i} - C\\,u_{i-1}) + \\left(-\\Gamma\\,A\\,\\frac{u_{i+1}-u_{i}}{\\Delta x} - (-\\Gamma\\,A\\,\\frac{u_{i}-u_{i-1}}{\\Delta x})\\right) + 1.25\\,u_{i}^{2}$\n$R_{i}(\\mathbf{u}) = C\\,u_{i} - C\\,u_{i-1} - D\\,u_{i+1} + 2\\,D\\,u_{i} - D\\,u_{i-1} + 1.25\\,u_{i}^{2}$\n$R_{i}(\\mathbf{u}) = -(C+D)u_{i-1} + (C+2D)u_{i} - D\\,u_{i+1} + 1.25\\,u_{i}^{2}$\n\n现在我们为每个单元写出具体的残差方程，并应用边界条件。\n对于单元 $i=1$：$u_{i-1}$ 被替换为 $u_{L}=1$。\n$R_{1}(\\mathbf{u}) = (C\\,u_{1} - C\\,u_{L}) + \\left(-D(u_{2}-u_{1}) - (-D(u_{1}-u_{L}))\\right) + 1.25\\,u_{1}^{2}$\n$R_{1}(\\mathbf{u}) = (C+2D)u_{1} - D\\,u_{2} + 1.25\\,u_{1}^{2} - (C+D)u_{L}$\n代入 $C=3$, $D=0.4$, $u_{L}=1$：\n$R_{1}(\\mathbf{u}) = 3.8\\,u_{1} - 0.4\\,u_{2} + 1.25\\,u_{1}^{2} - 3.4$。\n\n对于单元 $i=2$：\n$R_{2}(\\mathbf{u}) = -(C+D)u_{1} + (C+2D)u_{2} - D\\,u_{3} + 1.25\\,u_{2}^{2}$\n$R_{2}(\\mathbf{u}) = -3.4\\,u_{1} + 3.8\\,u_{2} - 0.4\\,u_{3} + 1.25\\,u_{2}^{2}$。\n\n对于单元 $i=3$：\n$R_{3}(\\mathbf{u}) = -(C+D)u_{2} + (C+2D)u_{3} - D\\,u_{4} + 1.25\\,u_{3}^{2}$\n$R_{3}(\\mathbf{u}) = -3.4\\,u_{2} + 3.8\\,u_{3} - 0.4\\,u_{4} + 1.25\\,u_{3}^{2}$。\n\n对于单元 $i=4$：$u_{i+1}$ 被替换为 $u_{R}=0$。\n$R_{4}(\\mathbf{u}) = (C\\,u_{4} - C\\,u_{3}) + \\left(-D(u_{R}-u_{4}) - (-D(u_{4}-u_{3}))\\right) + 1.25\\,u_{4}^{2}$\n$R_{4}(\\mathbf{u}) = -(C+D)u_{3} + (C+2D)u_{4} + 1.25\\,u_{4}^{2} - D\\,u_{R}$\n代入 $C=3$, $D=0.4$, $u_{R}=0$：\n$R_{4}(\\mathbf{u}) = -3.4\\,u_{3} + 3.8\\,u_{4} + 1.25\\,u_{4}^{2}$。\n\n**1. 解析雅可比矩阵列的构建**\n雅可比矩阵定义为 $J_{ij}(\\mathbf{u}) = \\frac{\\partial R_{i}}{\\partial u_{j}}$。我们需要计算第三列 $\\mathbf{J}(:,3)$，它由每个残差分量对 $u_{3}$ 的导数组成。\n- $\\frac{\\partial R_{1}}{\\partial u_{3}}$: $R_{1}$ 仅依赖于 $u_{1}$ 和 $u_{2}$。\n  $$J_{13} = \\frac{\\partial R_{1}}{\\partial u_{3}} = 0$$\n- $\\frac{\\partial R_{2}}{\\partial u_{3}}$: 从 $R_{2}$ 的表达式出发，我们对 $u_{3}$ 求导。\n  $$J_{23} = \\frac{\\partial R_{2}}{\\partial u_{3}} = \\frac{\\partial}{\\partial u_{3}} (-3.4\\,u_{1} + 3.8\\,u_{2} - 0.4\\,u_{3} + 1.25\\,u_{2}^{2}) = -0.4$$\n- $\\frac{\\partial R_{3}}{\\partial u_{3}}$: 从 $R_{3}$ 的表达式出发，我们对 $u_{3}$ 求导。\n  $$J_{33} = \\frac{\\partial R_{3}}{\\partial u_{3}} = \\frac{\\partial}{\\partial u_{3}} (-3.4\\,u_{2} + 3.8\\,u_{3} - 0.4\\,u_{4} + 1.25\\,u_{3}^{2}) = 3.8 + 2.5\\,u_{3}$$\n- $\\frac{\\partial R_{4}}{\\partial u_{3}}$: 从 $R_{4}$ 的表达式出发，我们对 $u_{3}$ 求导。\n  $$J_{43} = \\frac{\\partial R_{4}}{\\partial u_{3}} = \\frac{\\partial}{\\partial u_{3}} (-3.4\\,u_{3} + 3.8\\,u_{4} + 1.25\\,u_{4}^{2}) = -3.4$$\n\n我们在给定的迭代值 $\\mathbf{u}^{(0)} = [0.8,\\,0.5,\\,0.2,\\,0.1]^{\\top}$ 处计算该列。唯一依赖于 $\\mathbf{u}^{(0)}$ 的分量是 $J_{33}$，它依赖于 $u_{3}^{(0)}=0.2$。\n$J_{13} = 0$\n$J_{23} = -0.4$\n$J_{33} = 3.8 + 2.5 \\times 0.2 = 3.8 + 0.5 = 4.3$\n$J_{43} = -3.4$\n因此，雅可比矩阵的解析第三列是 $\\mathbf{J}(:,3) = [0, -0.4, 4.3, -3.4]^{\\top}$。\n\n该列的稀疏模式（仅在行 $i=2,3,4$ 处有非零项）与雅可比矩阵的三对角结构一致，该结构源于一维有限体积法离散化的最近邻模板。导数 $\\frac{\\partial R_{i}}{\\partial u_{j}}$ 仅在 $j \\in \\{i-1, i, i+1\\}$ 时非零。对于列 $j=3$，这意味着非零项仅出现在行 $i \\in \\{2, 3, 4\\}$。\n\n**2. 有限差分雅可比矩阵列的构建**\n第三列的中心有限差分近似由下式给出：\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) = \\frac{\\mathbf{R}(\\mathbf{u}^{(0)} + h\\,\\mathbf{e}_{3}) - \\mathbf{R}(\\mathbf{u}^{(0)} - h\\,\\mathbf{e}_{3})}{2\\,h}\n$$\n导数 $f'(x)$ 的中心差分近似的泰勒级数展开为 $f'(x) = \\frac{f(x+h) - f(x-h)}{2h} - \\frac{h^2}{6}f'''(x) - O(h^4)$。如果函数的三阶及更高阶导数为零，则该近似是精确的。对于次数为2或更低的多项式，此条件成立。\n\n我们来考察每个残差分量 $R_{i}$ 相对于变量 $u_{3}$ 的函数形式：\n- $R_{1}(\\mathbf{u})$ 与 $u_{3}$ 无关，即关于 $u_{3}$ 的0次多项式。\n- $R_{2}(\\mathbf{u})$ 是 $u_{3}$ 的线性函数，即关于 $u_{3}$ 的1次多项式。\n- $R_{3}(\\mathbf{u})$ 是 $u_{3}$ 的二次函数，即关于 $u_{3}$ 的2次多项式。\n- $R_{4}(\\mathbf{u})$ 是 $u_{3}$ 的线性函数，即关于 $u_{3}$ 的1次多项式。\n\n对于所有 $i \\in \\{1,2,3,4\\}$，三阶导数 $\\frac{\\partial^3 R_{i}}{\\partial u_{3}^{3}}$ 均为零。因此，中心差分公式提供了导数的精确值，而不是近似值。截断误差为零。\n因此，$\\mathbf{J}_{\\mathrm{FD}}(:,3) = \\mathbf{J}(:,3)$。\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) = \\begin{pmatrix} 0 \\\\ -0.4 \\\\ 4.3 \\\\ -3.4 \\end{pmatrix}\n$$\n\n**欧几里得范数的计算**\n最后一步是计算有限差分和解析雅可比矩阵列之差的欧几里得二范数。\n差分向量为：\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) - \\mathbf{J}(:,3) = \\begin{pmatrix} 0 \\\\ -0.4 \\\\ 4.3 \\\\ -3.4 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -0.4 \\\\ 4.3 \\\\ -3.4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n零向量的欧几里得范数为：\n$$\n\\left\\| \\mathbf{J}_{\\mathrm{FD}}(:,3) - \\mathbf{J}(:,3) \\right\\|_{2} = \\sqrt{0^{2} + 0^{2} + 0^{2} + 0^{2}} = 0\n$$",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}