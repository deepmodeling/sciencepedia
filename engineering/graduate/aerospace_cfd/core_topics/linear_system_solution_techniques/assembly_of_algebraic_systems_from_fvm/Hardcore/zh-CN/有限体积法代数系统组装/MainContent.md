## 引言
在航空航天工程及更广泛的科学计算领域，[有限体积法](@entry_id:141374)（FVM）是模拟流体流动、热传递和相关物理现象的基石。其强大之处在于能够严格保证物理量的守恒性，即使在复杂的几何形状上也是如此。然而，从描述物理世界的连续[偏微分](@entry_id:194612)方程到计算机可以求解的离散[代数方程](@entry_id:272665)组，这一转化过程充满了理论和实践上的挑战。如何系统、准确且高效地完成这一转化，即“代数系统的组装”，是所有[计算流体动力学](@entry_id:142614)（CFD）从业者必须掌握的核心技能。

本文旨在全面阐述从[有限体积法](@entry_id:141374)组装代数系统的完[整流](@entry_id:197363)程。在“原理与机制”一章中，我们将深入探讨守恒定律积分形式的离散化，分析对流、扩散和源项的不同处理方式及其对系统性质的影响。接着，在“应用与交叉学科联系”一章中，我们将展示这一理论框架如何应用于解决真实世界中的复杂问题，包括[多物理场耦合](@entry_id:171389)、边界条件施加以及[并行计算](@entry_id:139241)。最后，在“动手实践”一章中，读者将有机会通过具体编程练习，将理论知识转化为实践能力。

本文将引导读者一步步构建起从物理原理到计算实践的桥梁，首先让我们从构建这一桥梁的基石——单个控制体积上的基本离散化原理——开始。

## 原理与机制

在[有限体积法](@entry_id:141374) (Finite Volume Method, FVM) 的框架内，将物理守恒定律转化为可解的[代数方程](@entry_id:272665)组，是[计算流体动力学](@entry_id:142614) (CFD) 的核心步骤。本章旨在系统地阐述这一转化过程背后的基本原理与关键机制。我们将从单个控制体积上[标量输运方程](@entry_id:1131253)的离散化入手，逐步深入到非结构化网格上的复杂几何处理、耦合流动方程的求解策略，最终形成一个完整的代数系统组装框架。

### [输运方程](@entry_id:174281)的基本离散化

我们首先考虑一个通用标量 $\phi$（例如温度或组分质量分数）的输运过程，其[守恒形式](@entry_id:1122899)的控制方程为[对流-扩散-反应方程](@entry_id:156456)。通过对其进行离散化，我们可以揭示代数系统组装的基石。

#### [积分守恒律](@entry_id:202878)

[有限体积法](@entry_id:141374)的出发点是将微分形式的守恒定律在空间中的一个有限区域——**控制体积** (control volume) $\Omega_P$——上进行积分。对于一个固定的控制体积，一个[守恒量](@entry_id:161475)（在[可压缩流](@entry_id:747589)中为 $\rho\phi$）的变化率等于通过其边界 $\partial\Omega_P$ 的净通量与体积内源项的总和。这构成了**[积分守恒律](@entry_id:202878)**。

对于一个包含对流、扩散和源项的通用标量 $\phi$，其在静止控制体积 $\Omega_P$ 上的积分守恒定律可以写作 ：

$$
\frac{d}{dt}\int_{\Omega_P}\rho \phi\,d\Omega + \oint_{\partial\Omega_P} (\rho \phi \mathbf{u} - \Gamma \nabla \phi)\cdot \mathbf{n}\,dS = \int_{\Omega_P} S(\phi)\,d\Omega
$$

其中，各项的物理意义如下：
- **非[稳态](@entry_id:139253)项 (Unsteady Term)**: $\frac{d}{dt}\int_{\Omega_P}\rho \phi\,d\Omega$ 是控制体积内 $\rho\phi$ 总量的累积速率。
- **对流通量 (Convective Flux)**: $\oint_{\partial\Omega_P} \rho \phi \mathbf{u} \cdot \mathbf{n}\,dS$ 是通过控制体积边界的净对流流出率。其中 $\mathbf{u}$ 是[流体速度](@entry_id:267320)矢量，$\mathbf{n}$ 是指向外部的单位法向矢量。
- **扩散通量 (Diffusive Flux)**: $\oint_{\partial\Omega_P} (-\Gamma \nabla \phi)\cdot \mathbf{n}\,dS$ 是通过控制体积边界的净扩散流出率。这里的表达式遵循**[菲克定律](@entry_id:155177) (Fick's law)**，即[扩散通量](@entry_id:748422)矢量与场量梯度方向相反，$\mathbf{q}_{\text{diff}} = -\Gamma \nabla\phi$，其中 $\Gamma$ 是扩散系数。
- **源项 (Source Term)**: $\int_{\Omega_P} S(\phi)\,d\Omega$ 是控制体积内 $\phi$ 的总体积生成（或消耗）率。

FVM 的核心任务就是将这个[积分方程](@entry_id:138643)近似为一组[代数方程](@entry_id:272665)，其中每个方程对应一个控制体积（或网格单元）。

#### 各项的离散化

为组装[代数方程](@entry_id:272665)，我们需要对[积分守恒律](@entry_id:202878)中的每一项进行离散近似。假设控制体积 $\Omega_P$ 的体积为 $V_P$，其边界由若干个平坦的面 $f$ 组成，每个面的面积为 $A_f$。

**非[稳态](@entry_id:139253)项**: 采用一阶**后向欧拉格式 (Backward Euler scheme)** 进行时间离散，并将体积积分近似为单元中心值的乘积，我们得到：
$$
\frac{d}{dt}\int_{\Omega_P}\rho \phi\,d\Omega \approx \frac{(\rho_P \phi_P V_P)^{n+1} - (\rho_P \phi_P V_P)^n}{\Delta t}
$$
其中上标 $n$ 和 $n+1$ 分别代表旧的和新的时间层，$\Delta t$ 是时间步长。为了线性化，通常将密度取在已知时间层 $n$ 的值，即 $\rho_P^n$。

**扩散项**: [扩散通量](@entry_id:748422)的离散化依赖于对界面上梯度法向分量的近似。对于连接单元 $P$ 与其相邻单元 $N$ 的面 $f$，采用**[中心差分](@entry_id:173198) (central differencing)** 近似，梯度法向分量为 $(\nabla\phi)_f \cdot \mathbf{n}_f \approx \frac{\phi_N - \phi_P}{d_{PN,f}}$，其中 $d_{PN,f}$ 是两单元中心在面[法线](@entry_id:167651)方向上的投影距离。因此，通过面 $f$ 的净[扩散通量](@entry_id:748422)为：
$$
-\Gamma_f ((\nabla\phi)_f \cdot \mathbf{n}_f) A_f \approx -\Gamma_f \frac{\phi_N - \phi_P}{d_{PN,f}} A_f = D_f(\phi_P - \phi_N)
$$
这里的 $D_f = \frac{\Gamma_f A_f}{d_{PN,f}}$ 被称为**扩散导纳 (diffusive conductance)**。它将两个相邻单元中心值的差异直接与通过它们之间界面的[扩散通量](@entry_id:748422)联系起来。

**对流项**: 对流通量的离散化核心在于如何确定界面上的值 $\phi_f$。这是一个关键步骤，因为它直接影响到数值解的稳定性和精度。
- **[中心差分格式](@entry_id:1122205) (Central Differencing)**，或称为**线性插值 (Linear Interpolation)**，将面上的值取为相邻单元中心值的线性组合，例如 $\phi_f = \lambda \phi_P + (1-\lambda)\phi_N$。在均匀网格中，$\lambda=0.5$。这种方法具有[二阶精度](@entry_id:137876)，但在对流占优的流动中（即扩散作用很弱时）会产生非物理的振荡。

- 这种振荡的产生可以通过**[佩克莱数](@entry_id:141791) (Peclet Number)** 来量化 。面佩克莱数定义为[对流通量](@entry_id:158187)与[扩散通量](@entry_id:748422)之比：$Pe_f = \frac{\dot{m}_f}{D_f}$，其中 $\dot{m}_f = (\rho \mathbf{u} \cdot \mathbf{n})_f A_f$ 是通过界面的质量通量。理论分析表明，为保证数值解的[单调性](@entry_id:143760)（无振荡），[中心差分格式](@entry_id:1122205)要求 $|Pe_f| \le 2$。当对流远大于扩散时，这个条件很容易被违反。

- 为了克服[中心差分](@entry_id:173198)的稳定性问题，**[一阶迎风格式](@entry_id:749417) (First-Order Upwind scheme)** 被广泛使用。其核心思想是“随波逐流”：界面上的值 $\phi_f$ 取决于流动方向，即取其上游单元的中心值。
  - 如果流出单元 $P$（即 $\dot{m}_f > 0$），则 $\phi_f = \phi_P$。
  - 如果流入单元 $P$（即 $\dot{m}_f  0$），则 $\phi_f = \phi_N$。
[迎风格式](@entry_id:756378)保证了[代数方程](@entry_id:272665)系数的优良性质（后文将详述），从而确保了数值解的无条件稳定，但其精度仅为一阶，会引入额外的**数值扩散 (numerical diffusion)**。

**源项**: 体积源项通常近似为单元中心值的函数与体积的乘积，即 $S(\phi_P)V_P$。当源项 $S(\phi)$ [非线性](@entry_id:637147)时，为进行隐式求解，需要对其进行线性化 。一个常见的线性化方法是泰勒展开的[一阶近似](@entry_id:147559)：
$$
S(\phi) \approx S(\phi^k) + \left(\frac{\partial S}{\partial \phi}\right)_{\phi^k} (\phi - \phi^k)
$$
其中 $\phi^k$ 是上一次迭代的值。这可以写成标准形式 $S(\phi) \approx S_U + S_P \phi$，其中 $S_P = (\partial S/\partial \phi)|_{\phi^k}$ 是斜率， $S_U = S(\phi^k) - S_P \phi^k$ 是截距。

线性化源项对[数值稳定性](@entry_id:175146)至关重要。在组装代数方程时，含 $\phi_P$ 的项 $S_P \phi_P V_P$ 会被移到方程的左边，贡献给主对角元。最终主对角系数的形式为 $a_P = \tilde{a}_P - S_P V_P$，其中 $\tilde{a}_P$ 来自通量项。为了增强**[对角占优](@entry_id:748380) (diagonal dominance)**，从而保证迭代求解的收敛性，我们需要使主对角元 $a_P$ 尽可能大。这意味着贡献项 $-S_P V_P$ 应当为正，即 $S_P \le 0$。如果源项本身是 $\phi$ 的减函数（例如，一个消耗过程），那么 $\partial S/\partial \phi$ 自然为负，直接使用该导数作为 $S_P$ 即可增强稳定性。但如果 $\partial S/\partial \phi > 0$（一个自催化过程），直接使用会削弱[对角占优](@entry_id:748380)，可能导致发散。一种稳健的策略是人为强制 $S_P \le 0$，例如取 $S_P = \min( (\partial S/\partial \phi)|_k, 0 )$，这既保证了稳定性，又维持了一阶的线性化精度。

#### [代数方程](@entry_id:272665)的组装

将上述所有离散项代入积分[守恒方程](@entry_id:1122898)，并将所有未知量（在 $n+1$ 时间层）移到方程左边，已知量（在 $n$ 时间层或来自边界条件）移到右边，即可得到一个关于单元 $P$ 中心值 $\phi_P$ 的代数方程：

$$
a_P \phi_P = \sum_{nb \in \mathcal{N}(P)} a_{nb} \phi_{nb} + b_P
$$

其中 $\mathcal{N}(P)$ 是单元 $P$ 的所有相邻单元集合。系数 $a_P$、 $a_{nb}$ 和 $b_P$ 是由离散化过程决定的。

我们通过一个具体的[稳态](@entry_id:139253)一维对流扩散问题来演示这个组装过程 。考虑一个单元 $P$，其左边是邻居 $N$，右边是狄利克雷 (Dirichlet) 边值 $\phi_B$。方程为 $a_P \phi_P = a_N \phi_N + b_P$。此处，我们定义通量为离开控制体积为正。

- **左界面 (L)**: 邻居为 $N$。给定质量通量 $\dot{m}_L  0$（即质量从$N$流入$P$）和扩散导纳 $D_L$。
  - [对流通量](@entry_id:158187)：由于是流入，[迎风格式](@entry_id:756378)取 $\phi_L = \phi_N$。离开 $P$ 的[对流通量](@entry_id:158187)为 $\dot{m}_L \phi_L = \dot{m}_L \phi_N$。（注意$\dot{m}_L$为负值）。
  - [扩散通量](@entry_id:748422)：离开 $P$ 的[扩散通量](@entry_id:748422)为 $D_L(\phi_P - \phi_N)$。
  - 总通量（离开 $P$）$J_L = \dot{m}_L \phi_N + D_L(\phi_P - \phi_N)$。

- **右界面 (R)**: 边界，邻居值为 $\phi_B$。给定质量通量 $\dot{m}_R > 0$（流出）和扩散导纳 $D_R$。
  - 对流通量：由于是流出，迎风格式取 $\phi_R = \phi_P$。离开 $P$ 的对流通量为 $\dot{m}_R \phi_P$。
  - 扩散通量：离开 $P$ 的扩散通量为 $D_R(\phi_P - \phi_B)$。
  - 总通量（离开 $P$）$J_R = \dot{m}_R \phi_P + D_R(\phi_P - \phi_B) = (\dot{m}_R + D_R)\phi_P - D_R \phi_B$。

- **源项**: 线性化为 $S_P^c \phi_P + S_P^p$，其中 $S_P^c \le 0$。

[稳态](@entry_id:139253)守恒方程为（净流出 = 生成） $J_L + J_R = S_P^c \phi_P + S_P^p$。代入表达式并整理：
$$
(\dot{m}_L \phi_N + D_L(\phi_P - \phi_N)) + ((\dot{m}_R + D_R)\phi_P - D_R \phi_B) = S_P^c \phi_P + S_P^p
$$
将含 $\phi_P$ 的项移到左边，其余项移到右边：
$$
(D_L + \dot{m}_R + D_R - S_P^c)\phi_P = (D_L - \dot{m}_L)\phi_N + (D_R \phi_B + S_P^p)
$$

由此，我们可以清晰地识别出各个系数：
- **主对[角系数](@entry_id:149598)**: $a_P = D_L + D_R + \dot{m}_R - S_P^c$
- **邻居系数**: $a_N = D_L - \dot{m}_L$
- **源/边界项**: $b_P = D_R \phi_B + S_P^p$

这个例子具体地展示了通量离散格式（迎风、中心差分）和[源项线性化](@entry_id:1131997)如何直接转化为最终代数方程的系数。

### 非结构化网格上的高等空间离散格式

在航空航天等领域的复杂几何问题中，通常采用**非结构化网格 (unstructured meshes)**。这对此前简化的离散格式提出了新的挑战，需要更精细的几何处理和数值方法。

#### 几何基础

在通用的多面体网格上，准确的离散化依赖于对网格几何量的精确描述 。几个核心的几何量包括：
- **面矢量 (Face Area Vector)** $\mathbf{S}_f$：定义为 $\mathbf{S}_f = A_f \hat{\mathbf{n}}_f$，其中 $A_f$ 是面 $f$ 的面积，$\hat{\mathbf{n}}_f$ 是指向控制体外部的[单位法向量](@entry_id:178851)。根据[高斯散度定理](@entry_id:188065)，任何矢量场 $\mathbf{F}$ 通过面 $f$ 的通量都可以表示为点积 $\mathbf{F}_f \cdot \mathbf{S}_f$。
- **单元/面形心 (Cell/Face Centroid)**：单元形心 $\mathbf{x}_P$ 和面形心 $\mathbf{x}_f$ 分别是控制体积和面的几何中心。它们是存储[离散变量](@entry_id:263628)和进行插值的几何基准。连接相邻单元形心的矢量 $\mathbf{d}_{PN} = \mathbf{x}_N - \mathbf{x}_P$ 是计算梯度和距离的基本度量。

#### [梯度重构](@entry_id:749996)

在[非结构化网格](@entry_id:756354)上，特别是为了计算[扩散通量](@entry_id:748422)或实现[高阶对流格式](@entry_id:750326)，精确地重构单元中心的梯度 $\nabla\phi_P$ 变得至关重要 。两种主流的方法是格林-高斯法和最小二乘法。

**[格林-高斯方法](@entry_id:750051) (Green-Gauss Method)**: 该方法直接源于[梯度的散度](@entry_id:270716)定理积分形式：$\int_V \nabla\phi \, dV = \oint_{\partial V} \phi \, d\mathbf{S}$。将其应用于控制体积 $\Omega_P$，单元平均梯度可以精确表示为：
$$
(\nabla\phi)_{avg,P} = \frac{1}{V_P} \sum_{f \in \partial \Omega_P} \phi_{f,avg} \mathbf{S}_f
$$
其中 $\phi_{f,avg}$ 是 $\phi$ 在面 $f$ 上的精确平均值。如果一个场的梯度是常数（即场是线性的 $\phi(\mathbf{x}) = \alpha + \boldsymbol{\beta} \cdot \mathbf{x}$），那么其在任意点的梯度都等于平均梯度。因此，**格林-高斯法对于线性场是精确的，前提是能够提供精确的界面平均值 $\phi_{f,avg}$**。在实践中，$\phi_{f,avg}$ 通常用相邻单元值的插值来近似，这会引入误差。

**[最小二乘法](@entry_id:137100) (Least-Squares Method)**: 该方法将[梯度重构](@entry_id:749996)视为一个拟合问题。它寻找一个梯度矢量 $\mathbf{g}_P \approx \nabla\phi_P$，使得基于泰勒展开的邻居值[预测误差](@entry_id:753692)最小。具体而言，它最小化以下加权[残差[平方](@entry_id:174395)和](@entry_id:161049)：
$$
\sum_{N \in \mathcal{N}(P)} w_{PN} \left( (\phi_N - \phi_P) - \mathbf{g}_P \cdot (\mathbf{x}_N - \mathbf{x}_P) \right)^2
$$
对于线性场 $\phi(\mathbf{x}) = \alpha + \boldsymbol{\beta} \cdot \mathbf{x}$，我们有 $\phi_N - \phi_P = \boldsymbol{\beta} \cdot (\mathbf{x}_N - \mathbf{x}_P)$。代入上式后可以发现，当 $\mathbf{g}_P = \boldsymbol{\beta}$ 时，[残差平方和](@entry_id:174395)为零，达到最小值。这个[最小二乘问题](@entry_id:164198)的解是唯一的，只要相邻单元的[位移矢量](@entry_id:262782) $\{\mathbf{x}_N - \mathbf{x}_P\}$ 能够张成整个空间（例如，在三维中，邻居点不共面）。因此，**只要邻居节点的[几何分布](@entry_id:154371)满足该秩条件，最小二乘法对于线性场总是精确的**，且与权重 $w_{PN}$ 的选择无关。

#### 处理非正交性与偏斜度

理想的网格中，连接相邻单元形心的直线 $\mathbf{d}_{PN}$ 会垂直于共享面 $f$。然而，在[非结构化网格](@entry_id:756354)中，这种情况很少见。
- **非正交性 (Non-orthogonality)** 指的是矢量 $\mathbf{d}_{PN}$ 与面法线 $\mathbf{n}_f$ 之间的夹角 $\theta_f$ 不为零。
- **偏斜度 (Skewness)** 指的是面形心 $\mathbf{x}_f$ 与线段 $\mathbf{d}_{PN}$ 的交点不重合。

[非正交性](@entry_id:192553)对扩散项的离散化影响尤为严重 。标准[中心差分近似](@entry_id:177025) $(\nabla\phi)_f \cdot \mathbf{n}_f \approx (\phi_N - \phi_P)/|\mathbf{d}_{PN}|$ 实际上近似的是梯度在 $\mathbf{d}_{PN}$ 方向的分量，而非所需的法向分量。为了精确并保持[数值稳定性](@entry_id:175146)，通常将法向梯度分为两部分：
$$
\nabla\phi \cdot \mathbf{n}_f = \underbrace{(\nabla\phi \cdot \mathbf{n}_f)_{\text{ortho}}}_{\text{隐式处理}} + \underbrace{(\nabla\phi \cdot \mathbf{n}_f)_{\text{non-ortho}}}_{\text{显式修正}}
$$
- **正交部分** 沿 $\mathbf{d}_{PN}$ 方向，可以直接用 $(\phi_N - \phi_P)$ 来近似，形成一个隐式的、连接单元 $P$ 和 $N$ 的项。这部分贡献构成了[扩散矩阵](@entry_id:182965)的对称主干。
- **非正交部分** 是剩余的[交叉扩散](@entry_id:1123226)项。若将其隐式处理，会引入非对称的矩阵项，破坏扩散算子的对称性。因此，该项通常作为**延迟修正 (deferred correction)**，使用上一迭代步的梯度值进行计算，并作为一个显式的源项加入方程右端。这种处理方式既提高了精度，又保持了主矩阵的对称性和稀疏性。

### 求[解耦](@entry_id:160890)合系统：流动方程

前面的讨论主要集中在单个[标量输运方程](@entry_id:1131253)上。然而，在CFD中，我们通常需要求[解耦](@entry_id:160890)合的[Navier-Stokes方程组](@entry_id:142275)，这引入了新的挑战，特别是压力与速度场的耦合。

#### [不可压缩流](@entry_id:140301)中的压力-速度耦合

对于[不可压缩流](@entry_id:140301)，[连续性方程](@entry_id:195013)为 $\nabla \cdot \mathbf{u} = 0$，动量方程中包含压力梯度项 $-\nabla p$。如何在这两个方程之间建立正确的离散耦合关系是核心难点。

**[同位网格](@entry_id:1122659)上的[压力-速度解耦](@entry_id:167545)**: 在**[同位网格](@entry_id:1122659) (collocated grid)** 上，所有变量（速度分量和压力）都存储在单元中心。如果采用简单的插值方法，会导致严重问题 。
- 考虑压力梯度项 $-\nabla p$ 的离散。在单元 $i$ 上，使用中心差分会得到压力梯度近似为 $(p_{i+1}-p_{i-1})/(2\Delta x)$。可以看出，这个表达式只关联了 $i+1$ 和 $i-1$ 的压力，而完全忽略了单元 $i$ 本身的压力 $p_i$。
- 同样，如果用于连续性方程的界面速度也由相邻单元速度[线性插值](@entry_id:137092)得到，它将只依赖于相邻单元的速度。
- 这种离散方式的结果是，[动量方程](@entry_id:197225)无法“看见”一种高频、交错的“棋盘格” (checkerboard) 压[力场](@entry_id:147325)，例如 $p_i = \hat{p}(-1)^i$。对于这样的压[力场](@entry_id:147325)，每个单元的离散压力梯度均为零，因此它不会对速度场产生任何作用。反过来，速度场也无法通过[连续性方程](@entry_id:195013)来修正这种病态的压[力场](@entry_id:147325)。这种现象被称为**[压力-速度解耦](@entry_id:167545) (pressure-velocity decoupling)**。

**Rhie-Chow 插值**: 为解决[解耦](@entry_id:160890)问题，必须在界面速度的计算中引入更强的[压力-速度耦合](@entry_id:155962)。**Rhie-Chow 插值**  正是为此设计的。其核心思想是，不直接插值速度，而是插值[动量方程](@entry_id:197225)中除压力梯度外的其余部分，然后再加上一个在界面上紧凑离散的压力梯度项。

对于界面 $i+1/2$，其速度表达式形如：
$$
u_{i+1/2} = \overline{(\dots)}_{\text{interp}} - D^p_{i+1/2} (p_{i+1} - p_i)
$$
这里的第二项是关键，它是一个人工引入的压力耗散项，$D^p_{i+1/2}$ 与动量方程的对[角系数](@entry_id:149598)有关。当这个界面速度代入离散的连续性方程 $\dot{m}_{i+1/2} - \dot{m}_{i-1/2} = 0$ 后，就会在最终的压力方程中产生形如 $a_{i,i+1}^p p_{i+1}$ 的项，直接将相邻单元的压力耦合起来。

例如，在无对流的均匀网格下，可以推导出[Rhie-Chow插值](@entry_id:154759)在压力方程中引入的邻居系数为 ：
$$
a_{i+1}^p = \frac{\rho A \Delta x}{2\mu}
$$
这个系数直接将 $p_{i+1}$ 和 $p_i$ 联系起来，有效地抑制了[棋盘格压力](@entry_id:164851)模式，恢复了压[力场](@entry_id:147325)的光滑性。

#### [非线性](@entry_id:637147)耦合系统的线性化策略

在[可压缩流](@entry_id:747589)或包含[复杂反应](@entry_id:166407)的流动中，所有控制方程（质量、动量、能量、组分）都是[非线性](@entry_id:637147)且紧密耦合的。例如，在对流项 $\nabla \cdot (\rho \mathbf{u} \phi)$ 中，密度 $\rho$ 和速度 $\mathbf{u}$ 本身也是待求解的未知量。求解这样的系统需要迭代方法，每次迭代都需要将非线性系统线性化 。

**Picard 线性化**: 也称为**滞后系数法 (lagged coefficients)** 或[定点迭代](@entry_id:137769)。它将[非线性](@entry_id:637147)项中的部分因子（通常是系数）视为已知，使用上一步迭代的值。对于对流项 $F_f \phi_f$（其中 $F_f$ 是质量通量），Picard法将 $F_f$ 使用上一迭代步的值 $F_f^{(k)}$，只将 $\phi_f$ 视为当前迭代步的未知量。
- **优点**: 这种方法将耦合系统[解耦](@entry_id:160890)。例如，在求解 $\phi$ 方程时，动量和能量方程的变量被固定。这使得可以对每个物理场**分步求解 (segregated solve)**，每个子系统的规模较小，矩阵组装和求解的单次迭代成本较低。
- **缺点**: 由于忽略了变量间的耦合导数，[收敛速度](@entry_id:636873)通常是线性的，对于强耦合问题可能会非常缓慢甚至发散。

**[牛顿线性化](@entry_id:1128718) (Newton Linearization)**: 该方法通过构建完整的**[雅可比矩阵](@entry_id:178326) (Jacobian matrix)** 来线性化系统。[雅可比矩阵](@entry_id:178326)的元素 $J_{ij} = \partial R_i / \partial W_j$ 是第 $i$ 个方程的残差对第 $j$ 个未知量 $W_j$ 的导数。对于对流项 $F_f \phi_f$，其对未知量 $W_Q$ 的导数根据[乘法法则](@entry_id:144424)为 $(\partial F_f / \partial W_Q)\phi_f + F_f(\partial \phi_f / \partial W_Q)$。
- **优点**: [牛顿法](@entry_id:140116)充分考虑了所有变量之间的耦合关系，因此在解的邻域内具有**二次收敛 (quadratic convergence)** 的特性，迭代次数远少于Picard法。
- **缺点**: 如果所有方程完全耦合求解，[雅可比矩阵](@entry_id:178326)将是一个庞大的**[块矩阵](@entry_id:148435) (block matrix)**，其组装和求解（特别是直接求解）的计算和内存成本非常高。例如，$\phi$ 方程的行中会包含对密度、速度等变量的导数项，形成非对角块。

当流动变量 $(\rho, \mathbf{u})$ 与标量 $\phi$ 无关时，$\partial F_f / \partial \phi_Q=0$，牛顿法中与 $\phi$ 相关的耦合项消失，其对 $\phi$ 方程的线性化效果退化为与Picard法相同的形式 。因此，[牛顿法](@entry_id:140116)的优势完全体现在其处理[非线性](@entry_id:637147)耦合的能力上。

### 综合组装算法

一个现代的FVM程序通常采用**面向面 (face-based)** 的循环来组装全局代数系统，这自然地保证了守恒性等关键属性 。其基本流程如下：

1.  **初始化**: 将全局矩阵 $A$ 和右端项向量 $b$ 的所有元素置零。
2.  **遍历内部面**: 对网格中的每一个内部面 $f$（连接单元 $i$ 和 $j$）执行以下操作：
    -   计算该面上的对流通量 $F_f^C$ 和扩散通量 $F_f^D$ 的离散表达式。这包括[迎风插值](@entry_id:756375)、[非正交修正](@entry_id:1128815)等。
    -   根据守恒原则，将通量贡献**相等且相反地**加到相邻两个单元的方程中。例如，如果通量 $F_f$ 从 $i$ 指向 $j$，则在第 $i$ 行方程中加入 $+F_f$ 的贡献，在第 $j$ 行方程中加入 $-F_f$ 的贡献。这确保了通过内部面的通量在全局范围内相互抵消，从而实现**严格的[离散守恒](@entry_id:1123819)**。
    -   对于扩散项，采用前述的[非正交修正](@entry_id:1128815)方法，将对称的隐式部分贡献给矩阵的 $A_{ii}, A_{ij}, A_{jj}, A_{ji}$ 项，将非正交的显式部分贡献给右端项 $b_i$ 和 $b_j$。
3.  **遍历边界面**: 对网格中的每一个边界面 $f$（属于单元 $i$）执行以下操作：
    -   根据边界条件的类型（如Dirichlet或Neumann）计算通量。
    -   将该通量贡献加到单元 $i$ 的方程中。例如，对于Dirichlet边界，通量通常表示为 $D_f(\phi_i - \phi_B)$，这会贡献给 $A_{ii}$ 和 $b_i$；对于Neumann边界，通量是已知的，直接加到 $b_i$ 上。
4.  **处理体积源项**: 遍历所有单元 $i$，将其体积源项 $S_P V_P$ 的贡献加入到 $A_{ii}$ 和 $b_i$ 中。

通过这种系统性的组装过程，[有限体积法](@entry_id:141374)成功地将复杂的物理守恒定律和数值离散策略，转化为一个大型[稀疏线性代数](@entry_id:755102)系统 $A\mathbf{x}=\mathbf{b}$，为后续的迭代求解奠定了坚实的基础。