{
    "hands_on_practices": [
        {
            "introduction": "Before attempting to solve a complex system of algebraic equations, it is paramount to ensure that the discretization itself is a faithful approximation of the underlying partial differential equation. This practice introduces the Method of Manufactured Solutions (MMS), a cornerstone of code verification, to quantitatively assess the accuracy of your Finite Volume Method implementation. By computing the discrete truncation error for known polynomial solutions, you will gain hands-on experience in verifying the theoretical order of accuracy of a numerical scheme .",
            "id": "3944917",
            "problem": "Consider the one-dimensional steady diffusion equation with a source term on a line segment domain,\n$$ -\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right) = f(x), \\quad x \\in [0,1], $$\nwith constant diffusivity $\\kappa = 1$ (dimensionless) and boundary conditions given by prescribed normal fluxes at the domain endpoints (Neumann conditions). Let $u(x)$ be a sufficiently smooth exact solution. The Finite Volume Method (FVM) on an orthogonal mesh enforces conservation over each control volume. For cell $i$, denoting the east face normal flux by $\\phi_{i+1/2}$ and the west face normal flux by $\\phi_{i-1/2}$, conservation reads\n$$ \\phi_{i+1/2} - \\phi_{i-1/2} = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x)\\,dx. $$\nIn the two-point flux approximation on an orthogonal mesh with cell centers at $x_i$ and face positions at $x_{i\\pm 1/2}$, the discrete face flux through an interior face $i+1/2$ is\n$$ \\phi^{\\mathrm{disc}}_{i+1/2} = -\\frac{u(x_{i+1}) - u(x_i)}{x_{i+1} - x_i}, $$\nand similarly for face $i-1/2$. For Neumann boundary faces, the exact boundary fluxes are prescribed as\n$$ \\phi_{1/2} = -u'(0), \\quad \\phi_{N+1/2} = -u'(1). $$\nLet $N$ be the number of control volumes. Define face positions $\\{x_{j+1/2}\\}_{j=0}^N$ and cell centers $\\{x_i\\}_{i=1}^N$ by $x_i = \\frac{1}{2}\\left(x_{i-1/2} + x_{i+1/2}\\right)$ for an orthogonal mesh. Assemble the linear operator matrix $A \\in \\mathbb{R}^{N \\times N}$ for the interior two-point fluxes as\n$$\nA_{i,i} = \\begin{cases}\n\\frac{1}{x_2 - x_1} & \\text{if } i = 1 \\\\\n\\frac{1}{x_i - x_{i-1}} + \\frac{1}{x_{i+1} - x_i} & \\text{if } 1 < i < N \\\\\n\\frac{1}{x_N - x_{N-1}} & \\text{if } i = N\n\\end{cases}\n$$\n$$\nA_{i,i-1} = \\begin{cases}\n0 & \\text{if } i = 1 \\\\\n-\\frac{1}{x_i - x_{i-1}} & \\text{if } 1 < i \\le N\n\\end{cases}\n$$\n$$\nA_{i,i+1} = \\begin{cases}\n-\\frac{1}{x_{i+1} - x_i} & \\text{if } 1 \\le i < N \\\\\n0 & \\text{if } i = N\n\\end{cases}\n$$\nConstruct the right-hand side vector $b \\in \\mathbb{R}^N$ using the exact integral of the source over each control volume and the prescribed Neumann boundary fluxes:\n$$\nb_i = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x)\\,dx + \\begin{cases}\n\\phi_{1/2} & \\text{if } i = 1 \\\\\n0 & \\text{if } 1 < i < N \\\\\n-\\phi_{N+1/2} & \\text{if } i = N\n\\end{cases}\n$$\nFor manufactured exact solutions from the polynomial family $u(x) = x$, $u(x) = x^2$, and $u(x) = x^3$, take $f(x) = -u''(x)$ and $\\phi_{1/2} = -u'(0)$, $\\phi_{N+1/2} = -u'(1)$. Let $u_c \\in \\mathbb{R}^N$ be the vector of exact solution values evaluated at cell centers. Define the discrete truncation error vector\n$$ \\tau = A u_c - b. $$\nYour task is to write a program that, for a given set of meshes and exact solutions, assembles $A$ and $b$, computes $\\tau$, and returns the infinity norm $\\|\\tau\\|_\\infty = \\max_i |\\tau_i|$ for each test case. All quantities are dimensionless.\n\nStart from conservation and two-point flux definitions, with the following test suite:\n\n- Test case 1 (happy path, uniform exactness for linear): $N = 6$, uniform faces $x_{j+1/2} = j/N$ for $j = 0,1,\\dots,N$, exact solution $u(x) = x$.\n- Test case 2 (happy path, uniform exactness for quadratic): $N = 6$, uniform faces $x_{j+1/2} = j/N$, exact solution $u(x) = x^2$.\n- Test case 3 (nonuniform mesh, exactness for linear on orthogonal mesh): $N = 6$, nonuniform faces $x_{j+1/2} = (j/N)^2$, exact solution $u(x) = x$.\n- Test case 4 (nonuniform mesh, loss of exactness for quadratic): $N = 6$, nonuniform faces $x_{j+1/2} = (j/N)^2$, exact solution $u(x) = x^2$.\n- Test case 5 (edge case, minimal interior with uniform mesh): $N = 2$, uniform faces $x_{j+1/2} = j/N$, exact solution $u(x) = x$.\n- Test case 6 (uniform mesh, non-exact cubic): $N = 6$, uniform faces $x_{j+1/2} = j/N$, exact solution $u(x) = x^3$.\n\nFor each test case, compute and report the single float $\\|\\tau\\|_\\infty$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., “[r1,r2,r3,r4,r5,r6]”). These floats must be computed numerically and printed with default Python float formatting. Angles are not involved; all values are dimensionless.",
            "solution": "The problem is well-posed, scientifically sound, and contains all necessary information to proceed with a solution. It asks for the computation of the infinity norm of the truncation error vector for a cell-centered finite volume discretization of a one-dimensional steady diffusion equation.\n\nThe governing equation is\n$$\n-\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right) = f(x), \\quad x \\in [0,1],\n$$\nwith a constant diffusivity $\\kappa = 1$. The boundary conditions are of Neumann type, prescribing the normal fluxes at $x=0$ and $x=1$. The flux is defined as $\\phi = -\\kappa \\frac{du}{dx}$. With $\\kappa=1$, this simplifies to $\\phi = -\\frac{du}{dx}$.\n\nThe finite volume method (FVM) discretizes the domain $[0,1]$ into $N$ contiguous control volumes (cells). Let cell $i$ (for $i=1, \\dots, N$) be defined by the interval $[x_{i-1/2}, x_{i+1/2}]$. The cell center is $x_i = \\frac{1}{2}(x_{i-1/2} + x_{i+1/2})$. Integrating the governing equation over cell $i$ yields the conservation law:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} -\\frac{d}{dx}\\left(\\frac{du}{dx}\\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\n$$\n-\\left[\\frac{du}{dx}\\right]_{x_{i-1/2}}^{x_{i+1/2}} = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\n$$\n\\left(-\\frac{du}{dx}\\bigg|_{x_{i+1/2}}\\right) - \\left(-\\frac{du}{dx}\\bigg|_{x_{i-1/2}}\\right) = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\nDenoting the exact face fluxes as $\\phi_{i\\pm 1/2} = -u'(x_{i\\pm 1/2})$, the conservation law is $\\phi_{i+1/2} - \\phi_{i-1/2} = \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx$.\n\nThe problem uses a two-point flux approximation for interior faces, where the flux is approximated using the values at adjacent cell centers:\n$$\n\\phi^{\\mathrm{disc}}_{i+1/2} = -\\frac{u(x_{i+1}) - u(x_i)}{x_{i+1} - x_i}\n$$\nSubstituting these discrete fluxes into the conservation law for an interior cell $i$ ($1 < i < N$) gives:\n$$\n\\left(-\\frac{u_{i+1} - u_i}{x_{i+1} - x_i}\\right) - \\left(-\\frac{u_i - u_{i-1}}{x_i - x_{i-1}}\\right) \\approx \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\nwhere $u_i$ is the discrete approximation of $u(x_i)$. Rearranging terms to group the unknown values $u_i$ on the left-hand side yields the $i$-th row of a linear system $Au_h = b$:\n$$\n-\\frac{1}{x_i - x_{i-1}}u_{i-1} + \\left(\\frac{1}{x_i - x_{i-1}} + \\frac{1}{x_{i+1} - x_i}\\right)u_i - \\frac{1}{x_{i+1} - x_i}u_{i+1} \\approx \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx\n$$\nThis corresponds to the definition of the matrix $A$ for $1 < i < N$.\n\nFor the boundary cells, the prescribed Neumann fluxes are used.\nFor cell $i=1$: $\\phi_{3/2} - \\phi_{1/2} = \\int_{x_{1/2}}^{x_{3/2}} f(x) dx$. The flux $\\phi_{1/2} = -u'(0)$ is a given value. Only $\\phi_{3/2}$ is discretized:\n$$\n-\\frac{u_2 - u_1}{x_2 - x_1} - \\phi_{1/2} \\approx \\int_{x_{1/2}}^{x_{3/2}} f(x) dx \\implies \\frac{1}{x_2-x_1}u_1 - \\frac{1}{x_2-x_1}u_2 \\approx \\int_{x_{1/2}}^{x_{3/2}} f(x) dx + \\phi_{1/2}\n$$\nThis matches the definitions of the first row of $A$ and the first component of $b$.\n\nFor cell $i=N$: $\\phi_{N+1/2} - \\phi_{N-1/2} = \\int_{x_{N-1/2}}^{x_{N+1/2}} f(x) dx$. The flux $\\phi_{N+1/2} = -u'(1)$ is given.\n$$\n\\phi_{N+1/2} - \\left(-\\frac{u_N - u_{N-1}}{x_N - x_{N-1}}\\right) \\approx \\int_{x_{N-1/2}}^{x_{N+1/2}} f(x) dx \\implies -\\frac{1}{x_N - x_{N-1}}u_{N-1} + \\frac{1}{x_N - x_{N-1}}u_N \\approx \\int_{x_{N-1/2}}^{x_{N+1/2}} f(x) dx - \\phi_{N+1/2}\n$$\nThis matches the definitions of the last row of $A$ and the last component of $b$.\n\nThe truncation error vector $\\tau$ is defined as the residual obtained by substituting the exact solution $u(x)$, evaluated at the cell centers, into the discrete system: $\\tau = A u_c - b$. Here, $u_c$ is the vector with components $(u_c)_i = u(x_i)$. The task is to compute $\\|\\tau\\|_\\infty = \\max_i |\\tau_i|$ for several test cases.\n\nThe source term is manufactured from the exact solution as $f(x) = -u''(x)$. The boundary fluxes are consistently defined as $\\phi_{1/2} = -u'(0)$ and $\\phi_{N+1/2} = -u'(1)$.\n\nFor a given test case specified by $N$, the mesh generation rule, and the exact solution $u(x)$, the procedure is as follows:\n1.  Generate the face coordinates $\\{x_{j+1/2}\\}_{j=0}^N$ based on the given rule and $N$.\n2.  Calculate the cell center coordinates $x_i = \\frac{1}{2}(x_{i-1/2} + x_{i+1/2})$ for $i=1, \\dots, N$.\n3.  Construct the exact solution vector $u_c$ by evaluating $u(x_i)$ for each cell center $x_i$.\n4.  Assemble the $N \\times N$ matrix $A$ using the formulae provided, which depend on the distances between cell centers.\n5.  Assemble the $N \\times 1$ vector $b$. For each component $b_i$, this involves two parts:\n    a. The integrated source term: $\\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} -u''(x) dx = -[u'(x)]_{x_{i-1/2}}^{x_{i+1/2}} = u'(x_{i-1/2}) - u'(x_{i+1/2})$. For the polynomial solutions provided, this integral can be computed exactly.\n    b. The boundary fluxes: add $\\phi_{1/2} = -u'(0)$ to $b_1$ and subtract $\\phi_{N+1/2} = -u'(1)$ from $b_N$.\n6.  Compute the truncation error vector $\\tau = A u_c - b$.\n7.  Find the infinity norm of the resulting vector, $\\|\\tau\\|_\\infty = \\max_{i} |\\tau_i|$.\n\nThe properties of the two-point flux approximation predict the following outcomes:\n-   For a linear solution $u(x) = ax+b$, the approximation for the derivative $u'(x_{i+1/2}) \\approx \\frac{u(x_{i+1})-u(x_i)}{x_{i+1}-x_i}$ is exact. Consequently, the discrete flux is identical to the exact flux at any location, and the truncation error $\\tau$ will be zero for any orthogonal mesh. Cases 1, 3, and 5 should yield $\\|\\tau\\|_\\infty = 0$.\n-   For a quadratic solution $u(x) = ax^2+bx+c$, the approximation is exact if and only if the face $x_{i+1/2}$ is the geometric midpoint of the adjacent cell centers $x_i$ and $x_{i+1}$. This condition holds for a uniform mesh of faces. Thus, for Case 2 (uniform mesh), $\\|\\tau\\|_\\infty = 0$ is expected. For Case 4 (non-uniform mesh), the condition is violated, and a non-zero truncation error is expected.\n-   For a cubic solution $u(x) = ax^3+\\dots$, the approximation is no longer exact, even on a uniform mesh. A non-zero truncation error is expected for Case 6.\n\nThe implementation will follow these steps precisely for each test case to calculate the numerical value of $\\|\\tau\\|_\\infty$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n\n    def process_case(N, face_pos_fn, u_family_name):\n        \"\"\"\n        Processes a single test case to compute the infinity norm of the truncation error.\n        \n        Args:\n            N (int): Number of control volumes.\n            face_pos_fn (callable): A function `f(j, N)` that returns the position of face j.\n            u_family_name (str): The family of the exact solution ('x', 'x^2', 'x^3').\n        \n        Returns:\n            float: The infinity norm of the truncation error vector.\n        \"\"\"\n        # 1. Define manufactured solution functions based on the family name\n        if u_family_name == 'x':\n            u = lambda x: x\n            u_prime = lambda x: np.ones_like(x)\n            u_dprime = lambda x: np.zeros_like(x)\n        elif u_family_name == 'x^2':\n            u = lambda x: x**2\n            u_prime = lambda x: 2 * x\n            u_dprime = lambda x: 2 * np.ones_like(x)\n        elif u_family_name == 'x^3':\n            u = lambda x: x**3\n            u_prime = lambda x: 3 * x**2\n            u_dprime = lambda x: 6 * x\n        else:\n            raise ValueError(\"Unknown solution family\")\n\n        # 2. Generate mesh\n        # Face positions x_{j+1/2} for j = 0..N\n        # Using a direct mapping: x_faces[j] corresponds to the coordinate of the j-th face.\n        # Problem statement face indices {x_j+1/2}_j=0^N can map to array indices 0..N\n        # So x_{i-1/2} -> x_faces[i-1] and x_{i+1/2} -> x_faces[i]\n        x_faces = np.array([face_pos_fn(j, N) for j in range(N + 1)], dtype=np.float64)\n        \n        # Cell centers x_i for i = 1..N\n        # x_centers[i-1] corresponds to x_i\n        x_centers = 0.5 * (x_faces[:-1] + x_faces[1:])\n\n        # 3. Assemble matrix A\n        A = np.zeros((N, N), dtype=np.float64)\n        \n        # Distances between cell centers\n        d_centers = x_centers[1:] - x_centers[:-1]\n        \n        # Diagonal and off-diagonal entries\n        if N > 1:\n            # A_{i, i-1} for i=2..N\n            A.ravel()[N + 0::N+1] = -1.0 / d_centers\n            # A_{i, i+1} for i=1..N-1\n            A.ravel()[1::N+1] = -1.0 / d_centers\n\n        # Diagonal entries A_{i,i}\n        if N == 1:\n            # Special case for N=1, where A is just a 1x1 matrix of 0\n            pass\n        elif N > 1:\n            # For i=1\n            A[0, 0] = 1.0 / d_centers[0]\n            # For i=N\n            A[N-1, N-1] = 1.0 / d_centers[-1]\n            # For 1 < i < N\n            for i in range(1, N - 1):\n                A[i, i] = (1.0 / d_centers[i-1]) + (1.0 / d_centers[i])\n        \n        # 4. Assemble RHS vector b\n        b = np.zeros(N, dtype=np.float64)\n        \n        # Source integrals: integral(-u''(x))dx from x_{i-1/2} to x_{i+1/2}\n        # This is -[u'(x)] from x_{i-1/2} to x_{i+1/2} = u'(x_{i-1/2}) - u'(x_{i+1/2})\n        source_integrals = u_prime(x_faces[:-1]) - u_prime(x_faces[1:])\n        b[:] = source_integrals\n        \n        # Boundary fluxes\n        phi_0 = -u_prime(x_faces[0])  # at x=0\n        phi_1 = -u_prime(x_faces[-1]) # at x=1\n        \n        b[0] += phi_0\n        if N > 0:\n            b[-1] -= phi_1\n            \n        # 5. Get exact solution vector at cell centers\n        u_c = u(x_centers)\n        \n        # 6. Compute truncation error vector and its infinity norm\n        tau = A @ u_c - b\n        tau_inf_norm = np.max(np.abs(tau))\n        \n        return tau_inf_norm\n\n    # Test cases from the problem statement\n    test_cases = [\n        {'N': 6, 'mesh': 'uniform', 'sol': 'x'},\n        {'N': 6, 'mesh': 'uniform', 'sol': 'x^2'},\n        {'N': 6, 'mesh': 'nonuniform', 'sol': 'x'},\n        {'N': 6, 'mesh': 'nonuniform', 'sol': 'x^2'},\n        {'N': 2, 'mesh': 'uniform', 'sol': 'x'},\n        {'N': 6, 'mesh': 'uniform', 'sol': 'x^3'},\n    ]\n\n    mesh_functions = {\n        'uniform': lambda j, N: j / N,\n        'nonuniform': lambda j, N: (j / N)**2,\n    }\n\n    results = []\n    for case in test_cases:\n        N = case['N']\n        face_pos_fn = mesh_functions[case['mesh']]\n        u_family_name = case['sol']\n        result = process_case(N, face_pos_fn, u_family_name)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "The assembly of a global algebraic system is not complete without the proper imposition of boundary conditions, a step that critically influences the solvability and stability of the final problem. This exercise explores two common techniques for handling Dirichlet boundary conditions—the elimination method and the penalty method—within a practical heat conduction scenario. By assembling the matrices for both approaches and analyzing their respective condition numbers, you will develop a deeper appreciation for how implementation choices directly impact the numerical health of the system you are trying to solve .",
            "id": "3944932",
            "problem": "Consider one-dimensional steady heat conduction in a slab of thickness $L$ with constant thermal conductivity $k$ governed by the conservation law $\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right)=0$. Using the Finite Volume Method (FVM), assemble the algebraic system on a uniform grid with three control volumes of width $h$ and cross-sectional area $A$, with unknown temperatures at cell centers $\\{T_1,T_2,T_3\\}$. Assume the left boundary at $x=0$ is subject to a Dirichlet condition $T(0)=T_D$, and the right boundary at $x=L$ is insulated, i.e., Neumann condition $-\\left.k\\frac{dT}{dx}\\right|_{x=L}=0$. Let the face-to-center distances be $h/2$ at the boundaries and $h$ between adjacent cell centers, and use linear (two-point) diffusive flux approximations at faces.\n\nYou will assemble the discrete matrix $\\boldsymbol{A}$ and right-hand side $\\boldsymbol{b}$ for two distinct treatments of the Dirichlet boundary:\n\n- Elimination method: enforce $T_1=T_D$ by row and column elimination in the global system, preserving symmetry by moving couplings into the right-hand side.\n- Penalty method: retain the original row and append a penalty term of strength $\\gamma>0$ at the Dirichlet degree of freedom.\n\nWork with nondimensionalized constants $k=1$, $h=1$, $A=1$ so that the interior diffusive conductances are unity. Begin from first principles of FVM flux balance to write the unmodified conduction stencil for the three control volumes, then:\n\n1. Using the elimination method, write the exact algebraic modifications to the matrix entries and the right-hand side. Provide the final assembled $\\boldsymbol{A}_{\\text{elim}}$ and $\\boldsymbol{b}_{\\text{elim}}$ explicitly in terms of $T_D$.\n2. Using the penalty method, write the exact algebraic modifications to the matrix entries and the right-hand side. Provide the final assembled $\\boldsymbol{A}_{\\text{pen}}$ and $\\boldsymbol{b}_{\\text{pen}}$ explicitly in terms of $T_D$ and $\\gamma$.\n3. For each assembled matrix, analyze the two-norm condition number $\\kappa_2(\\boldsymbol{A})$ based on the ratio of its largest to smallest eigenvalues. For the elimination method, compute $\\kappa_2(\\boldsymbol{A}_{\\text{elim}})$ exactly. For the penalty method, derive the leading-order asymptotic form of $\\kappa_2(\\boldsymbol{A}_{\\text{pen}})$ as $\\gamma\\to\\infty$, retaining only the dominant scaling in $\\gamma$.\n\nFinally, derive the leading-order asymptotic expression, as $\\gamma\\to\\infty$, of the ratio of condition numbers\n$$\n\\frac{\\kappa_2\\!\\left(\\boldsymbol{A}_{\\text{pen}}\\right)}{\\kappa_2\\!\\left(\\boldsymbol{A}_{\\text{elim}}\\right)}.\n$$\nExpress the final answer as a single closed-form analytic expression in terms of $\\gamma$ and radicals. No rounding is required and there are no physical units to report.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and internally consistent. It poses a standard, verifiable problem in the numerical analysis of partial differential equations using the Finite Volume Method. The problem is valid.\n\nWe begin by applying the Finite Volume Method (FVM) to the one-dimensional steady heat conduction equation, $\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right)=0$. Integrating over a control volume $V_i$ with cross-sectional area $A$ from its west face ($w$) to its east face ($e$) yields:\n$$ \\int_{V_i} \\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) dV = \\int_{x_w}^{x_e} A \\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) dx = A \\left[k \\frac{dT}{dx}\\right]_{x_w}^{x_e} = 0 $$\nThis gives the flux balance: $\\left(k A \\frac{dT}{dx}\\right)_e - \\left(k A \\frac{dT}{dx}\\right)_w = 0$. The heat flux at a face is $q = -k A \\frac{dT}{dx}$. So, the balance is $q_w - q_e = 0$.\n\nWe use a uniform grid of three control volumes, each of width $h$. The domain has total length $L=3h$. The cell centers are at $x_1 = h/2$, $x_2 = 3h/2$, and $x_3 = 5h/2$. The non-dimensional constants are $k=1$, $h=1$, $A=1$. Thus, $L=3$, and cell centers are at $x_1=0.5$, $x_2=1.5$, $x_3=2.5$. The faces are located at $x=0, 1, 2, 3$.\n\nThe flux at an internal face between cells $i$ and $i+1$ is approximated as:\n$$ q_{i+1/2} = -k_f A_f \\frac{T_{i+1}-T_i}{x_{i+1}-x_i} = -(1)(1)\\frac{T_{i+1}-T_i}{1} = -(T_{i+1}-T_i) $$\nThe diffusive conductance between interior cells is $C_{int} = kA/h = 1$.\n\nNow we assemble the equations for each control volume, which forms the basis for both required methods.\n\n**Control Volume 1 (centered at $x_1=0.5$):**\nThe west face is the boundary at $x=0$, where $T(0)=T_D$. The flux is $q_w = -kA \\frac{T_1 - T_D}{x_1 - 0} = - (1)(1) \\frac{T_1 - T_D}{0.5-0} = -2(T_1-T_D)$.\nThe east face is at $x=1$, between cells $1$ and $2$. The flux is $q_e = -(T_2-T_1)$.\nThe balance $q_w - q_e = 0$ gives: $-2(T_1-T_D) - (-(T_2-T_1)) = 0$, which simplifies to $-2T_1+2T_D+T_2-T_1=0$, or $3T_1-T_2 = 2T_D$.\n\n**Control Volume 2 (centered at $x_2=1.5$):**\nThe west face is at $x=1$, so $q_w = -(T_2-T_1)$.\nThe east face is at $x=2$, between cells $2$ and $3$, so $q_e = -(T_3-T_2)$.\nThe balance $q_w - q_e = 0$ gives: $-(T_2-T_1) - (-(T_3-T_2))=0$, which simplifies to $-T_2+T_1+T_3-T_2=0$, or $-T_1+2T_2-T_3=0$.\n\n**Control Volume 3 (centered at $x_3=2.5$):**\nThe west face is at $x=2$, so $q_w = -(T_3-T_2)$.\nThe east face is at the boundary $x=L=3$, which is insulated. The condition is $-\\left.k\\frac{dT}{dx}\\right|_{x=L}=0$, which implies the flux $q_e=0$.\nThe balance $q_w - q_e = 0$ gives: $-(T_3-T_2) - 0 = 0$, or $-T_2+T_3=0$.\n\nThe assembled system, which we will call the base system, is:\n$$\n\\begin{pmatrix}\n3 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nT_1 \\\\ T_2 \\\\ T_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2T_D \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\nLet this system be denoted $\\boldsymbol{A}_{\\text{base}}\\boldsymbol{T} = \\boldsymbol{b}_{\\text{base}}$.\n\n### 1. Elimination Method\n\nThe elimination method enforces the Dirichlet condition $T_1=T_D$ on the assembled system while preserving symmetry. We modify the system such that the first equation becomes $T_1=T_D$, and the coupling from $T_1$ to other equations is moved to the right-hand side.\n\nThe second equation is $-T_1+2T_2-T_3=0$. Substituting $T_1=T_D$, it becomes $2T_2-T_3 = T_D$. This is equivalent to updating the right-hand side: $b_2' = b_2 - A_{21}T_D = 0 - (-1)T_D = T_D$.\nThe third equation $ -T_2+T_3=0$ does not involve $T_1$, so it remains unchanged.\nThe first equation is replaced by the constraint $T_1=T_D$.\nTo maintain a symmetric matrix structure, we set the off-diagonal elements in the first row and first column to zero, and the diagonal element $A_{11}$ to $1$. The modified system $\\boldsymbol{A}_{\\text{elim}}\\boldsymbol{T} = \\boldsymbol{b}_{\\text{elim}}$ is:\n$$\n\\boldsymbol{A}_{\\text{elim}} =\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix},\n\\quad\n\\boldsymbol{b}_{\\text{elim}} =\n\\begin{pmatrix}\nT_D \\\\\nT_D \\\\\n0\n\\end{pmatrix}\n$$\n\n### 2. Penalty Method\n\nThe penalty method enforces the Dirichlet condition $T_1 \\approx T_D$ by adding a penalty term to the first equation. This is achieved by adding $\\gamma$ to the diagonal element $A_{11}$ and $\\gamma T_D$ to the right-hand side term $b_1$ of the base system.\nStarting with $\\boldsymbol{A}_{\\text{base}}$ and $\\boldsymbol{b}_{\\text{base}}$:\n$A_{11, \\text{pen}} = A_{11, \\text{base}} + \\gamma = 3+\\gamma$.\n$b_{1, \\text{pen}} = b_{1, \\text{base}} + \\gamma T_D = 2T_D + \\gamma T_D = (2+\\gamma)T_D$.\nThe other rows of the system are unchanged. The resulting system $\\boldsymbol{A}_{\\text{pen}}\\boldsymbol{T} = \\boldsymbol{b}_{\\text{pen}}$ is:\n$$\n\\boldsymbol{A}_{\\text{pen}} =\n\\begin{pmatrix}\n3+\\gamma & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix},\n\\quad\n\\boldsymbol{b}_{\\text{pen}} =\n\\begin{pmatrix}\n(2+\\gamma)T_D \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n\n### 3. Condition Number Analysis\n\nThe two-norm condition number is $\\kappa_2(\\boldsymbol{A}) = \\frac{|\\lambda_{\\max}|}{|\\lambda_{\\min}|}$.\n\n**Condition number of $\\boldsymbol{A}_{\\text{elim}}$:**\nThe eigenvalues $\\lambda$ of $\\boldsymbol{A}_{\\text{elim}}$ are found from $\\det(\\boldsymbol{A}_{\\text{elim}} - \\lambda\\boldsymbol{I}) = 0$.\n$$ \\det\\begin{pmatrix} 1-\\lambda & 0 & 0 \\\\ 0 & 2-\\lambda & -1 \\\\ 0 & -1 & 1-\\lambda \\end{pmatrix} = (1-\\lambda)[(2-\\lambda)(1-\\lambda) - 1] = 0 $$\nOne eigenvalue is $\\lambda_1=1$. The other two are roots of $\\lambda^2-3\\lambda+1=0$, which are $\\lambda_{2,3} = \\frac{3 \\pm \\sqrt{5}}{2}$.\nThe eigenvalues are $\\lambda_{\\max} = \\frac{3+\\sqrt{5}}{2}$, $\\lambda_{\\min} = \\frac{3-\\sqrt{5}}{2}$, and $1$.\nSo, $\\lambda_{\\max}(\\boldsymbol{A}_{\\text{elim}}) = \\frac{3+\\sqrt{5}}{2}$ and $\\lambda_{\\min}(\\boldsymbol{A}_{\\text{elim}}) = \\frac{3-\\sqrt{5}}{2}$.\n$$ \\kappa_2(\\boldsymbol{A}_{\\text{elim}}) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(3+\\sqrt{5})/2}{(3-\\sqrt{5})/2} = \\frac{3+\\sqrt{5}}{3-\\sqrt{5}} = \\frac{(3+\\sqrt{5})^2}{(3-\\sqrt{5})(3+\\sqrt{5})} = \\frac{9+6\\sqrt{5}+5}{9-5} = \\frac{14+6\\sqrt{5}}{4} = \\frac{7+3\\sqrt{5}}{2} $$\n\n**Asymptotic condition number of $\\boldsymbol{A}_{\\text{pen}}$ as $\\gamma \\to \\infty$:**\nThe characteristic equation is $\\det(\\boldsymbol{A}_{\\text{pen}} - \\lambda \\boldsymbol{I})=0$.\n$$ (3+\\gamma-\\lambda)((2-\\lambda)(1-\\lambda)-1) - (-1)(-(1-\\lambda)) = 0 $$\n$$ (3+\\gamma-\\lambda)(\\lambda^2-3\\lambda+1) - (1-\\lambda) = 0 $$\n$$ \\lambda^3 - (6+\\gamma)\\lambda^2 + (9+3\\gamma)\\lambda - (2+\\gamma) = 0 $$\nAs $\\gamma \\to \\infty$, we expect one large eigenvalue, $\\lambda_{\\max} \\sim O(\\gamma)$, and two smaller eigenvalues of order $O(1)$.\nFor the small eigenvalues, we divide the polynomial by $\\gamma$ and take the limit $\\gamma \\to \\infty$:\n$$ \\frac{\\lambda^3}{\\gamma} - (1+\\frac{6}{\\gamma})\\lambda^2 + (3+\\frac{9}{\\gamma})\\lambda - (1+\\frac{2}{\\gamma}) = 0 \\quad\\to\\quad -\\lambda^2+3\\lambda-1=0 $$\nThis gives $\\lambda^2-3\\lambda+1=0$, so the two smaller eigenvalues converge to $\\frac{3 \\pm \\sqrt{5}}{2}$. Thus, $\\lambda_{\\min}(\\boldsymbol{A}_{\\text{pen}}) \\to \\frac{3-\\sqrt{5}}{2}$.\nFor the large eigenvalue, the sum of eigenvalues is $\\lambda_1+\\lambda_2+\\lambda_3 = 6+\\gamma$. As $\\gamma\\to\\infty$, $\\lambda_{\\max} + \\frac{3+\\sqrt{5}}{2} + \\frac{3-\\sqrt{5}}{2} \\approx 6+\\gamma$.\n$\\lambda_{\\max} + 3 \\approx 6+\\gamma$, so $\\lambda_{\\max} \\approx \\gamma+3$.\nThe leading order term is $\\lambda_{\\max} \\sim \\gamma$.\nThe asymptotic condition number is:\n$$ \\kappa_2(\\boldsymbol{A}_{\\text{pen}}) \\sim \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} \\sim \\frac{\\gamma}{\\frac{3-\\sqrt{5}}{2}} = \\frac{2\\gamma}{3-\\sqrt{5}} = \\frac{2\\gamma(3+\\sqrt{5})}{9-5} = \\gamma\\frac{3+\\sqrt{5}}{2} $$\n\n**Ratio of Condition Numbers:**\nFinally, we compute the leading-order asymptotic expression for the ratio as $\\gamma \\to \\infty$:\n$$ \\frac{\\kappa_2(\\boldsymbol{A}_{\\text{pen}})}{\\kappa_2(\\boldsymbol{A}_{\\text{elim}})} \\sim \\frac{\\gamma\\frac{3+\\sqrt{5}}{2}}{\\frac{7+3\\sqrt{5}}{2}} = \\gamma \\frac{3+\\sqrt{5}}{7+3\\sqrt{5}} $$\nTo simplify the fraction, we rationalize the denominator:\n$$ \\gamma \\frac{3+\\sqrt{5}}{7+3\\sqrt{5}} \\times \\frac{7-3\\sqrt{5}}{7-3\\sqrt{5}} = \\gamma \\frac{(3+\\sqrt{5})(7-3\\sqrt{5})}{7^2 - (3\\sqrt{5})^2} = \\gamma \\frac{21 - 9\\sqrt{5} + 7\\sqrt{5} - 3(5)}{49 - 9(5)} $$\n$$ = \\gamma \\frac{21-15-2\\sqrt{5}}{49-45} = \\gamma \\frac{6-2\\sqrt{5}}{4} = \\gamma \\frac{3-\\sqrt{5}}{2} $$\nThe leading-order asymptotic expression for the ratio is $\\gamma \\frac{3-\\sqrt{5}}{2}$.",
            "answer": "$$\n\\boxed{\\gamma \\frac{3-\\sqrt{5}}{2}}\n$$"
        },
        {
            "introduction": "Solving the nonlinear systems that arise in CFD often relies on Newton-type methods, which require the assembly of a Jacobian matrix. This practice delves into the heart of this process by comparing an exact, analytical assembly with a numerical finite-difference approximation for a convection-diffusion problem with a nonlinear source. Through this comparison, you will uncover the conditions under which finite-differencing can be exact and learn a fundamental technique for verifying the correctness of your Jacobian implementation, a crucial skill for developing robust nonlinear solvers .",
            "id": "3944905",
            "problem": "Consider the one-dimensional, steady convection–diffusion equation with a nonlinear source over a uniform mesh, discretized by the Finite Volume Method (FVM). Let the computational domain be of length $L=1$ partitioned into $N=4$ equal control volumes of width $\\Delta x = L/N = 0.25$, with constant cross-sectional area $A=1$. The diffusivity is $\\Gamma=0.1$, the density is $\\rho=1$, and the uniform convection speed is $V=3$ directed from left to right. The left and right Dirichlet boundary values are $u_{L}=1$ and $u_{R}=0$, respectively. The nonlinear source term is $S(u) = k\\,u^{2}$ with $k=5$, so that the volumetric source integrated over cell $i$ is $k\\,A\\,\\Delta x\\,u_{i}^{2}$.\n\nDenote the vector of unknowns at the $N=4$ cell centers by $\\mathbf{u} = [u_{1},u_{2},u_{3},u_{4}]^{\\top}$. For each interior control volume $i \\in \\{1,2,3,4\\}$, define the residual $R_{i}(\\mathbf{u})$ as the net outflow of convective and diffusive fluxes plus the volumetric source:\n$$\nR_{i}(\\mathbf{u}) = \\big(F_{c,i+\\frac{1}{2}} - F_{c,i-\\frac{1}{2}}\\big) + \\big(F_{d,i+\\frac{1}{2}} - F_{d,i-\\frac{1}{2}}\\big) + k\\,A\\,\\Delta x\\,u_{i}^{2},\n$$\nwhere, for positive $V$, the upwind convective flux at face $i+\\frac{1}{2}$ is $F_{c,i+\\frac{1}{2}} = \\rho\\,V\\,A\\,u_{i}$, and at the left boundary face $\\frac{1}{2}$ it is $F_{c,\\frac{1}{2}}=\\rho\\,V\\,A\\,u_{L}$. The diffusive flux at face $i+\\frac{1}{2}$ is $F_{d,i+\\frac{1}{2}} = -\\Gamma\\,A\\,\\frac{u_{i+1}-u_{i}}{\\Delta x}$, with the boundary faces using $u_{L}$ and $u_{R}$ in place of $u_{0}$ and $u_{5}$.\n\nLet the current iterate be\n$$\n\\mathbf{u}^{(0)} = [0.8,\\,0.5,\\,0.2,\\,0.1]^{\\top}.\n$$\nLet $\\mathbf{J}(\\mathbf{u})$ denote the Jacobian matrix of $\\mathbf{R}(\\mathbf{u})$ with respect to $\\mathbf{u}$. Your task is to assemble the third column $\\mathbf{J}(:,3)$ of the Jacobian at $\\mathbf{u}^{(0)}$ by two methods:\n1. An analytic assembly consistent with Automatic Differentiation (AD) principles by differentiating the residual definition with respect to $u_{3}$.\n2. A central finite-difference approximation using a perturbation step $h = 10^{-6}$,\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) \\approx \\frac{\\mathbf{R}(\\mathbf{u}^{(0)} + h\\,\\mathbf{e}_{3}) - \\mathbf{R}(\\mathbf{u}^{(0)} - h\\,\\mathbf{e}_{3})}{2\\,h},\n$$\nwhere $\\mathbf{e}_{3}$ is the third standard basis vector in $\\mathbb{R}^{4}$.\n\nCompute both columns, discuss their sparsity patterns, and finally compute the Euclidean two-norm\n$$\n\\left\\| \\mathbf{J}_{\\mathrm{FD}}(:,3) - \\mathbf{J}(:,3) \\right\\|_{2}.\n$$\nProvide this norm as your final answer. No rounding is required. Express the final answer as a pure number without units.",
            "solution": "The problem is validated against the specified criteria.\n\n**Step 1: Extract Givens**\n- **Domain and Mesh**: Length $L=1$, number of control volumes $N=4$, control volume width $\\Delta x = L/N = 0.25$, cross-sectional area $A=1$.\n- **Physical Constants**: Diffusivity $\\Gamma=0.1$, density $\\rho=1$, uniform convection speed $V=3$ (positive).\n- **Boundary Conditions**: Dirichlet type, left value $u_{L}=1$, right value $u_{R}=0$.\n- **Source Term**: $S(u) = k\\,u^{2}$ with $k=5$. Integrated source over cell $i$ is $k\\,A\\,\\Delta x\\,u_{i}^{2}$.\n- **Unknowns and Iterate**: Vector of unknowns $\\mathbf{u} = [u_{1},u_{2},u_{3},u_{4}]^{\\top}$, current iterate $\\mathbf{u}^{(0)} = [0.8,\\,0.5,\\,0.2,\\,0.1]^{\\top}$.\n- **Residual Definition**: For cell $i$, $R_{i}(\\mathbf{u}) = \\big(F_{c,i+\\frac{1}{2}} - F_{c,i-\\frac{1}{2}}\\big) + \\big(F_{d,i+\\frac{1}{2}} - F_{d,i-\\frac{1}{2}}\\big) + k\\,A\\,\\Delta x\\,u_{i}^{2}$.\n- **Flux Definitions (Upwind for $V>0$)**:\n  - Convective flux: $F_{c,i+\\frac{1}{2}} = \\rho\\,V\\,A\\,u_{i}$ at general faces, $F_{c,\\frac{1}{2}}=\\rho\\,V\\,A\\,u_{L}$ at the left boundary.\n  - Diffusive flux: $F_{d,i+\\frac{1}{2}} = -\\Gamma\\,A\\,\\frac{u_{i+1}-u_{i}}{\\Delta x}$.\n- **Finite Difference Approximation**: Jacobian column approximation using step size $h = 10^{-6}$ and the central difference formula:\n  $$\n  \\mathbf{J}_{\\mathrm{FD}}(:,3) \\approx \\frac{\\mathbf{R}(\\mathbf{u}^{(0)} + h\\,\\mathbf{e}_{3}) - \\mathbf{R}(\\mathbf{u}^{(0)} - h\\,\\mathbf{e}_{3})}{2\\,h}\n  $$\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes a standard one-dimensional, steady-state convection-diffusion equation with a nonlinear source, discretized using the Finite Volume Method. This is a fundamental and well-established problem in computational fluid dynamics and heat transfer.\n- **Well-Posed**: All necessary parameters, boundary conditions, and constitutive relations (flux definitions) are provided. The problem is self-contained and mathematically unambiguous.\n- **Objective**: The problem is stated in precise mathematical and engineering terms, free from subjectivity.\n\nNo invalidating flaws are identified. The problem is deemed valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The solution will be provided below.\n\nFirst, we establish the discretized residual equations for each of the $N=4$ control volumes. We define two key coefficients based on the given parameters:\nThe convective flux coefficient: $C = \\rho\\,V\\,A = 1 \\times 3 \\times 1 = 3$.\nThe diffusive flux coefficient: $D = \\frac{\\Gamma\\,A}{\\Delta x} = \\frac{0.1 \\times 1}{0.25} = 0.4$.\nThe source term coefficient for cell $i$ is $k\\,A\\,\\Delta x = 5 \\times 1 \\times 0.25 = 1.25$.\n\nThe residual for a general interior cell $i \\in \\{2, 3\\}$ is:\n$R_{i}(\\mathbf{u}) = (C\\,u_{i} - C\\,u_{i-1}) + \\left(-\\Gamma\\,A\\,\\frac{u_{i+1}-u_{i}}{\\Delta x} - (-\\Gamma\\,A\\,\\frac{u_{i}-u_{i-1}}{\\Delta x})\\right) + 1.25\\,u_{i}^{2}$\n$R_{i}(\\mathbf{u}) = C\\,u_{i} - C\\,u_{i-1} - D\\,u_{i+1} + 2\\,D\\,u_{i} - D\\,u_{i-1} + 1.25\\,u_{i}^{2}$\n$R_{i}(\\mathbf{u}) = -(C+D)u_{i-1} + (C+2D)u_{i} - D\\,u_{i+1} + 1.25\\,u_{i}^{2}$\n\nNow we write the specific residual equations for each cell, applying the boundary conditions.\nFor cell $i=1$: $u_{i-1}$ is replaced by $u_{L}=1$.\n$R_{1}(\\mathbf{u}) = (C\\,u_{1} - C\\,u_{L}) + \\left(-D(u_{2}-u_{1}) - (-D(u_{1}-u_{L}))\\right) + 1.25\\,u_{1}^{2}$\n$R_{1}(\\mathbf{u}) = (C+2D)u_{1} - D\\,u_{2} + 1.25\\,u_{1}^{2} - (C+D)u_{L}$\nSubstituting $C=3$, $D=0.4$, $u_{L}=1$:\n$R_{1}(\\mathbf{u}) = 3.8\\,u_{1} - 0.4\\,u_{2} + 1.25\\,u_{1}^{2} - 3.4$.\n\nFor cell $i=2$:\n$R_{2}(\\mathbf{u}) = -(C+D)u_{1} + (C+2D)u_{2} - D\\,u_{3} + 1.25\\,u_{2}^{2}$\n$R_{2}(\\mathbf{u}) = -3.4\\,u_{1} + 3.8\\,u_{2} - 0.4\\,u_{3} + 1.25\\,u_{2}^{2}$.\n\nFor cell $i=3$:\n$R_{3}(\\mathbf{u}) = -(C+D)u_{2} + (C+2D)u_{3} - D\\,u_{4} + 1.25\\,u_{3}^{2}$\n$R_{3}(\\mathbf{u}) = -3.4\\,u_{2} + 3.8\\,u_{3} - 0.4\\,u_{4} + 1.25\\,u_{3}^{2}$.\n\nFor cell $i=4$: $u_{i+1}$ is replaced by $u_{R}=0$.\n$R_{4}(\\mathbf{u}) = (C\\,u_{4} - C\\,u_{3}) + \\left(-D(u_{R}-u_{4}) - (-D(u_{4}-u_{3}))\\right) + 1.25\\,u_{4}^{2}$\n$R_{4}(\\mathbf{u}) = -(C+D)u_{3} + (C+2D)u_{4} + 1.25\\,u_{4}^{2} - D\\,u_{R}$\nSubstituting $C=3$, $D=0.4$, $u_{R}=0$:\n$R_{4}(\\mathbf{u}) = -3.4\\,u_{3} + 3.8\\,u_{4} + 1.25\\,u_{4}^{2}$.\n\n**1. Analytic Jacobian Column Assembly**\nThe Jacobian matrix is defined as $J_{ij}(\\mathbf{u}) = \\frac{\\partial R_{i}}{\\partial u_{j}}$. We need to compute the third column, $\\mathbf{J}(:,3)$, which consists of the derivatives of each residual component with respect to $u_{3}$.\n- $\\frac{\\partial R_{1}}{\\partial u_{3}}$: $R_{1}$ depends only on $u_{1}$ and $u_{2}$.\n  $$J_{13} = \\frac{\\partial R_{1}}{\\partial u_{3}} = 0$$\n- $\\frac{\\partial R_{2}}{\\partial u_{3}}$: From the expression for $R_{2}$, we differentiate with respect to $u_{3}$.\n  $$J_{23} = \\frac{\\partial R_{2}}{\\partial u_{3}} = \\frac{\\partial}{\\partial u_{3}} (-3.4\\,u_{1} + 3.8\\,u_{2} - 0.4\\,u_{3} + 1.25\\,u_{2}^{2}) = -0.4$$\n- $\\frac{\\partial R_{3}}{\\partial u_{3}}$: From the expression for $R_{3}$, we differentiate with respect to $u_{3}$.\n  $$J_{33} = \\frac{\\partial R_{3}}{\\partial u_{3}} = \\frac{\\partial}{\\partial u_{3}} (-3.4\\,u_{2} + 3.8\\,u_{3} - 0.4\\,u_{4} + 1.25\\,u_{3}^{2}) = 3.8 + 2.5\\,u_{3}$$\n- $\\frac{\\partial R_{4}}{\\partial u_{3}}$: From the expression for $R_{4}$, we differentiate with respect to $u_{3}$.\n  $$J_{43} = \\frac{\\partial R_{4}}{\\partial u_{3}} = \\frac{\\partial}{\\partial u_{3}} (-3.4\\,u_{3} + 3.8\\,u_{4} + 1.25\\,u_{4}^{2}) = -3.4$$\n\nWe evaluate this column at the given iterate $\\mathbf{u}^{(0)} = [0.8,\\,0.5,\\,0.2,\\,0.1]^{\\top}$. The only component that depends on $\\mathbf{u}^{(0)}$ is $J_{33}$, which depends on $u_{3}^{(0)}=0.2$.\n$J_{13} = 0$\n$J_{23} = -0.4$\n$J_{33} = 3.8 + 2.5 \\times 0.2 = 3.8 + 0.5 = 4.3$\n$J_{43} = -3.4$\nSo, the analytic third column of the Jacobian is $\\mathbf{J}(:,3) = [0, -0.4, 4.3, -3.4]^{\\top}$.\n\nThe sparsity pattern of this column, having non-zero entries only for rows $i=2,3,4$, is consistent with the tridiagonal structure of the Jacobian matrix, which arises from the nearest-neighbor stencil of the 1D FVM discretization. The derivative $\\frac{\\partial R_{i}}{\\partial u_{j}}$ is non-zero only for $j \\in \\{i-1, i, i+1\\}$. For column $j=3$, this implies non-zero entries only for rows $i \\in \\{2, 3, 4\\}$.\n\n**2. Finite-Difference Jacobian Column Assembly**\nThe central finite-difference approximation for the third column is given by:\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) = \\frac{\\mathbf{R}(\\mathbf{u}^{(0)} + h\\,\\mathbf{e}_{3}) - \\mathbf{R}(\\mathbf{u}^{(0)} - h\\,\\mathbf{e}_{3})}{2\\,h}\n$$\nThe Taylor series expansion of a centered difference approximation for a derivative $f'(x)$ is $f'(x) = \\frac{f(x+h) - f(x-h)}{2h} - \\frac{h^2}{6}f'''(x) - O(h^4)$. The approximation is exact if the third and higher derivatives of the function are zero. This is true for any polynomial of degree $2$ or less.\n\nLet's examine the functional form of each residual component $R_{i}$ with respect to the variable $u_{3}$:\n- $R_{1}(\\mathbf{u})$ is independent of $u_{3}$, i.e., a polynomial of degree $0$ in $u_{3}$.\n- $R_{2}(\\mathbf{u})$ is linear in $u_{3}$, i.e., a polynomial of degree $1$ in $u_{3}$.\n- $R_{3}(\\mathbf{u})$ is quadratic in $u_{3}$, i.e., a polynomial of degree $2$ in $u_{3}$.\n- $R_{4}(\\mathbf{u})$ is linear in $u_{3}$, i.e., a polynomial of degree $1$ in $u_{3}$.\n\nFor all $i \\in \\{1,2,3,4\\}$, the third derivative $\\frac{\\partial^3 R_{i}}{\\partial u_{3}^{3}}$ is zero. Therefore, the central difference formula provides the exact value of the derivative, not an approximation. The truncation error is zero.\nConsequently, $\\mathbf{J}_{\\mathrm{FD}}(:,3) = \\mathbf{J}(:,3)$.\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) = \\begin{pmatrix} 0 \\\\ -0.4 \\\\ 4.3 \\\\ -3.4 \\end{pmatrix}\n$$\n\n**Computation of the Euclidean Norm**\nThe final step is to compute the Euclidean two-norm of the difference between the finite-difference and analytic Jacobian columns.\nThe difference vector is:\n$$\n\\mathbf{J}_{\\mathrm{FD}}(:,3) - \\mathbf{J}(:,3) = \\begin{pmatrix} 0 \\\\ -0.4 \\\\ 4.3 \\\\ -3.4 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -0.4 \\\\ 4.3 \\\\ -3.4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe Euclidean norm of the zero vector is:\n$$\n\\left\\| \\mathbf{J}_{\\mathrm{FD}}(:,3) - \\mathbf{J}(:,3) \\right\\|_{2} = \\sqrt{0^{2} + 0^{2} + 0^{2} + 0^{2}} = 0\n$$",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}