{
    "hands_on_practices": [
        {
            "introduction": "要掌握任何迭代方法，我们必须首先精通其核心机制。本练习的核心是从逐次超松弛（SOR）迭代的定义出发，亲手构建其迭代矩阵 $T_{\\omega}$。通过为一个简单的系统计算 $T_{\\omega}$ 及其谱半径 $\\rho(T_{\\omega})$，你将具体理解松弛因子 $\\omega$ 是如何影响决定迭代收敛性的矩阵的，从而为掌握SOR方法奠定坚实的理论基础。",
            "id": "3581656",
            "problem": "考虑线性系统 $A x = b$，其中\n$$\nA=\\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}, \n\\qquad \nb=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix},\n\\qquad \n\\omega=\\frac{3}{2}.\n$$\n从矩阵 $A$ 分解为其对角部分、严格下三角部分和严格上三角部分出发，并根据逐次超松弛（SOR）方法作为通过对高斯-赛德尔更新应用松弛参数而得到的定常迭代的定义，推导仿射形式 $x^{k+1}=T_{\\omega}\\,x^{k}+c_{\\omega}$ 的迭代，确定给定 $A$ 和 $\\omega$ 的 SOR 迭代矩阵 $T_{\\omega}$，并确定其谱半径（其特征值的最大绝对值）。你最终报告的答案必须是谱半径，一个精确的数字。不要四舍五入。",
            "solution": "首先对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- 线性系统为 $A x = b$。\n- 矩阵 $A$ 由 $A=\\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}$ 给出。\n- 向量 $b$ 由 $b=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$ 给出。\n- 松弛参数 $\\omega$ 由 $\\omega=\\frac{3}{2}$ 给出。\n- 任务是推导逐次超松弛（SOR）迭代矩阵 $T_{\\omega}$ 并计算其谱半径 $\\rho(T_{\\omega})$。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：该问题是数值线性代数中关于定常迭代方法，特别是 SOR 方法的一个标准练习。它基于成熟的数学原理。\n- **适定性**：该问题是适定的。矩阵 $A$ 和参数 $\\omega$ 有明确定义。寻找 SOR 迭代矩阵及其谱半径的任务是一个唯一定义的数学过程。矩阵 $A$ 是对称正定的（其特征值为 1 和 3），这保证了对于任何 $\\omega \\in (0, 2)$，SOR 方法都是收敛的。给定的值 $\\omega = \\frac{3}{2}$ 在此区间内。\n- **客观性**：问题使用精确、客观的数学语言陈述。\n- **完整性**：确定迭代矩阵 $T_{\\omega}$ 及其谱半径所需的所有信息都已提供。对于这个特定任务，向量 $b$ 不是必需的，但它的存在不会产生矛盾。\n\n**第 3 步：结论与行动**\n该问题被认为是**有效的**，因为它有科学依据、适定且完整。将提供完整的解法。\n\n逐次超松弛（SOR）方法是求解线性系统 $A x = b$ 的一种定常迭代方法。首先将矩阵 $A$ 分解为其对角分量 $D$、严格下三角分量 $-L$ 和严格上三角分量 $-U$，使得 $A = D - L - U$。\n\n对于给定的矩阵 $A = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}$，其分解为：\n$$D = \\begin{pmatrix}2  0 \\\\ 0  2\\end{pmatrix}, \\quad L = \\begin{pmatrix}0  0 \\\\ 1  0\\end{pmatrix}, \\quad U = \\begin{pmatrix}0  1 \\\\ 0  0\\end{pmatrix}$$\n\nSOR 迭代由以下方程定义：\n$$(D - \\omega L) x^{k+1} = \\big((1-\\omega)D + \\omega U\\big) x^{k} + \\omega b$$\n这可以写成仿射形式 $x^{k+1} = T_{\\omega} x^{k} + c_{\\omega}$，其中迭代矩阵 $T_{\\omega}$ 由下式给出：\n$$T_{\\omega} = (D - \\omega L)^{-1} \\big((1-\\omega)D + \\omega U\\big)$$\n常数向量 $c_{\\omega}$ 由 $c_{\\omega} = \\omega (D - \\omega L)^{-1} b$ 给出。我们的目标是求 $T_{\\omega}$ 的谱半径。\n\n给定 $\\omega = \\frac{3}{2}$。首先，我们计算矩阵 $(D - \\omega L)$：\n$$D - \\omega L = \\begin{pmatrix}2  0 \\\\ 0  2\\end{pmatrix} - \\frac{3}{2}\\begin{pmatrix}0  0 \\\\ 1  0\\end{pmatrix} = \\begin{pmatrix}2  0 \\\\ -\\frac{3}{2}  2\\end{pmatrix}$$\n\n接下来，我们求该矩阵的逆矩阵 $(D - \\omega L)^{-1}$：\n$$(D - \\omega L)^{-1} = \\frac{1}{(2)(2) - (0)(-\\frac{3}{2})} \\begin{pmatrix}2  0 \\\\ \\frac{3}{2}  2\\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix}2  0 \\\\ \\frac{3}{2}  2\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{2}  0 \\\\ \\frac{3}{8}  \\frac{1}{2}\\end{pmatrix}$$\n\n现在，我们计算矩阵 $\\big((1-\\omega)D + \\omega U\\big)$。由于 $\\omega = \\frac{3}{2}$，项 $(1-\\omega)$ 为 $1 - \\frac{3}{2} = -\\frac{1}{2}$。\n$$(1-\\omega)D + \\omega U = -\\frac{1}{2}\\begin{pmatrix}2  0 \\\\ 0  2\\end{pmatrix} + \\frac{3}{2}\\begin{pmatrix}0  1 \\\\ 0  0\\end{pmatrix} = \\begin{pmatrix}-1  0 \\\\ 0  -1\\end{pmatrix} + \\begin{pmatrix}0  \\frac{3}{2} \\\\ 0  0\\end{pmatrix} = \\begin{pmatrix}-1  \\frac{3}{2} \\\\ 0  -1\\end{pmatrix}$$\n\n最后，我们通过将两个结果矩阵相乘来计算 SOR 迭代矩阵 $T_{\\omega}$：\n$$T_{\\omega} = (D - \\omega L)^{-1} \\big((1-\\omega)D + \\omega U\\big) = \\begin{pmatrix}\\frac{1}{2}  0 \\\\ \\frac{3}{8}  \\frac{1}{2}\\end{pmatrix} \\begin{pmatrix}-1  \\frac{3}{2} \\\\ 0  -1\\end{pmatrix}$$\n$$T_{\\omega} = \\begin{pmatrix} (\\frac{1}{2})(-1) + (0)(0)  (\\frac{1}{2})(\\frac{3}{2}) + (0)(-1) \\\\ (\\frac{3}{8})(-1) + (\\frac{1}{2})(0)  (\\frac{3}{8})(\\frac{3}{2}) + (\\frac{1}{2})(-1) \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2}  \\frac{3}{4} \\\\ -\\frac{3}{8}  \\frac{9}{16} - \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2}  \\frac{3}{4} \\\\ -\\frac{3}{8}  \\frac{1}{16} \\end{pmatrix}$$\n\n为了求谱半径 $\\rho(T_{\\omega})$，我们需要通过求解特征方程 $\\det(T_{\\omega} - \\lambda I) = 0$ 来找到 $T_{\\omega}$ 的特征值。\n$$\\det\\begin{pmatrix} -\\frac{1}{2} - \\lambda  \\frac{3}{4} \\\\ -\\frac{3}{8}  \\frac{1}{16} - \\lambda \\end{pmatrix} = 0$$\n$$\\left(-\\frac{1}{2} - \\lambda\\right)\\left(\\frac{1}{16} - \\lambda\\right) - \\left(\\frac{3}{4}\\right)\\left(-\\frac{3}{8}\\right) = 0$$\n$$-\\frac{1}{32} + \\frac{1}{2}\\lambda - \\frac{1}{16}\\lambda + \\lambda^2 + \\frac{9}{32} = 0$$\n$$\\lambda^2 + \\left(\\frac{8}{16} - \\frac{1}{16}\\right)\\lambda + \\left(\\frac{9}{32} - \\frac{1}{32}\\right) = 0$$\n$$\\lambda^2 + \\frac{7}{16}\\lambda + \\frac{8}{32} = 0$$\n$$\\lambda^2 + \\frac{7}{16}\\lambda + \\frac{1}{4} = 0$$\n\n我们使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个关于 $\\lambda$ 的二次方程：\n$$\\lambda = \\frac{-\\frac{7}{16} \\pm \\sqrt{\\left(\\frac{7}{16}\\right)^2 - 4(1)\\left(\\frac{1}{4}\\right)}}{2(1)} = \\frac{-\\frac{7}{16} \\pm \\sqrt{\\frac{49}{256} - 1}}{2}$$\n$$\\lambda = \\frac{-\\frac{7}{16} \\pm \\sqrt{\\frac{49 - 256}{256}}}{2} = \\frac{-\\frac{7}{16} \\pm i\\frac{\\sqrt{207}}{16}}{2}$$\n两个特征值是一对共轭复数：\n$$\\lambda_{1,2} = -\\frac{7}{32} \\pm i\\frac{\\sqrt{207}}{32}$$\n\n谱半径 $\\rho(T_{\\omega})$ 是特征值的最大绝对值（模）。由于特征值是一对共轭复数，它们的模相等。我们计算其中一个特征值的模的平方：\n$$|\\lambda|^2 = \\left(-\\frac{7}{32}\\right)^2 + \\left(\\frac{\\sqrt{207}}{32}\\right)^2 = \\frac{49}{1024} + \\frac{207}{1024} = \\frac{49 + 207}{1024} = \\frac{256}{1024} = \\frac{1}{4}$$\n模是该值的平方根：\n$$|\\lambda| = \\sqrt{\\frac{1}{4}} = \\frac{1}{2}$$\n两个特征值的模都是 $\\frac{1}{2}$。因此，$T_{\\omega}$ 的谱半径是：\n$$\\rho(T_{\\omega}) = \\max(|\\lambda_1|, |\\lambda_2|) = \\frac{1}{2}$$",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "当我们理解了如何通过谱半径衡量收敛速度后，下一步自然是寻求优化。松弛因子 $\\omega$ 的选择对SOR方法的效率至关重要，本练习将挑战你找出能使迭代矩阵谱半径最小化的*最优*松弛因子 $\\omega_{opt}$。对于物理和工程领域中常见的特定矩阵（如本题中的矩阵），存在一个关于 $\\omega_{opt}$ 的解析公式；应用此公式，你将把SOR方法与更简单的Jacobi迭代法的性质联系起来，并体会到理论洞察力如何带来显著的性能提升。",
            "id": "2207379",
            "problem": "一位研究人员正在为一个耦合振子系统建模，这导出了一个线性方程组 $Ax=b$。相互作用矩阵 $A$ 由下式给出：\n$$A = \\begin{pmatrix} 3  -2  0 \\\\ -2  3  -2 \\\\ 0  -2  3 \\end{pmatrix}$$\n为了数值求解这个系统，该研究人员决定使用逐次超松弛（SOR）方法，这是一种依赖于松弛参数 $\\omega$ 的迭代技术。SOR的全称是逐次超松弛法。您的任务是找到最优松弛参数 $\\omega_{opt}$，它能为这个特定的矩阵 $A$ 带来最快的收敛速率。最优参数定义为在区间 $(0, 2)$ 内的 $\\omega$ 值，它能使SOR迭代矩阵的谱半径最小化。\n\n计算 $\\omega_{opt}$ 的精确数值。",
            "solution": "对于应用于对称正定且一致有序矩阵的逐次超松弛法，最优松弛参数由雅可比迭代矩阵的谱半径表示为\n$$\n\\omega_{\\text{opt}}=\\frac{2}{1+\\sqrt{1-\\rho(G_{J})^{2}}},\n$$\n其中 $G_{J}$ 是雅可比迭代矩阵。\n\n写出分裂 $A=D-L-U$，其中 $D=\\operatorname{diag}(A)$，并使用恒等式 $G_{J}=I-D^{-1}A$。对于给定的\n$$\nA=\\begin{pmatrix}\n3  -2  0\\\\\n-2  3  -2\\\\\n0  -2  3\n\\end{pmatrix},\n\\quad D=3I,\n$$\n所以\n$$\nG_{J}=I-D^{-1}A=I-\\frac{1}{3}A\n=\\begin{pmatrix}\n0  \\frac{2}{3}  0\\\\\n\\frac{2}{3}  0  \\frac{2}{3}\\\\\n0  \\frac{2}{3}  0\n\\end{pmatrix}.\n$$\n这是一个对角线元素为零、非对角线元素为常数 $c=\\frac{2}{3}$ 的三对角托普利茨矩阵。其特征值为\n$$\n\\lambda_{k}=2c\\cos\\!\\left(\\frac{k\\pi}{n+1}\\right),\\quad k=1,2,3,\\; n=3,\n$$\n即，\n$$\n\\lambda_{k}=\\frac{4}{3}\\cos\\!\\left(\\frac{k\\pi}{4}\\right)\\in\\left\\{\\frac{2\\sqrt{2}}{3},\\,0,\\,-\\frac{2\\sqrt{2}}{3}\\right\\}.\n$$\n因此\n$$\n\\rho(G_{J})=\\frac{2\\sqrt{2}}{3},\\qquad \\rho(G_{J})^{2}=\\frac{8}{9}.\n$$\n代入最优SOR公式，\n$$\n\\omega_{\\text{opt}}=\\frac{2}{1+\\sqrt{1-\\frac{8}{9}}}\n=\\frac{2}{1+\\sqrt{\\frac{1}{9}}}\n=\\frac{2}{1+\\frac{1}{3}}\n=\\frac{2}{\\frac{4}{3}}\n=\\frac{3}{2}.\n$$\n该值位于 $(0,2)$ 区间内，并且对于给定的矩阵 $A$，它使得SOR迭代矩阵的谱半径最小化。",
            "answer": "$$\\boxed{\\frac{3}{2}}$$"
        },
        {
            "introduction": "一位专业的实践者不仅知道何时以及如何使用一个工具，更重要的是知道何时*不*该使用它。SOR方法的收敛性在特定条件下是有保证的，但当这些条件不满足时会发生什么呢？这个计算实践将引导你探索当SOR方法应用于可能导致不定系统矩阵的亥姆霍兹型方程时的行为。通过数值方法研究当系统矩阵 $A$ 从正定过渡到不定时，谱半径 $\\rho(T_{\\omega})$ 如何变化，你将获得关于该方法局限性的实践经验，这在处理此类方程常见的高级计算流体力学（CFD）应用中是至关重要的一课。",
            "id": "3198971",
            "problem": "考虑在均匀网格上具有狄利克雷边界条件的一维亥姆霍兹型线性系统。连续算子是亥姆霍兹算子，离散化后得到形式为 $A = -\\Delta - k^2 I$ 的矩阵，其中 $-\\Delta$ 表示离散负拉普拉斯算子，$k^2$ 是一个非负标量位移。在区间 $[0,1]$ 上使用具有 $n$ 个内部点的二阶中心差分近似，均匀间距为 $h = \\frac{1}{n+1}$，矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是三对角矩阵，其对角线元素为 $a_{ii} = \\frac{2}{h^2} - k^2$，非对角线元素为 $a_{i,i\\pm 1} = -\\frac{1}{h^2}$。\n\n您的任务是：\n1. 从用于定常迭代的矩阵标准分裂出发，写出求解 $A x = b$ 的逐次超松弛 (SOR) 迭代的矩阵形式。定义分裂 $A = D - L - U$，其中 $D$ 是 $A$ 的对角部分，$L$ 是符号适当的严格下三角部分，$U$ 是符号适当的严格上三角部分。由此推导出 SOR 迭代作为线性迭代 $x^{(m+1)} = T_{\\mathrm{SOR}} x^{(m)} + c$，并确定 SOR 迭代矩阵 $T_{\\mathrm{SOR}}$ 为 $D$、$L$、$U$ 和松弛参数 $\\omega$ 的函数。\n2. 利用 $A$ 的特征结构，解释为什么增加 $k$ 会导致 $A$ 的不定性（即 $A$ 同时具有正负特征值）。将此不定性与谱半径 $\\rho(T_{\\mathrm{SOR}})$ 的行为以及 SOR 迭代的收敛或发散联系起来。\n3. 实现一个程序，对于每个给定的测试用例，按所述构造 $A$，形成 $T_{\\mathrm{SOR}}$，计算 $\\rho(T_{\\mathrm{SOR}})$，并将其作为四舍五入到六位小数的浮点数返回。使用矩阵 $M$ 的谱半径定义 $\\rho(M) = \\max_i |\\lambda_i(M)|$。\n\n在您的程序中，均匀网格上狄利克雷边界条件下 $-\\Delta$ 的最小特征值应使用经过充分测试的离散公式计算\n$$\n\\lambda_{\\min}(-\\Delta) = \\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right),\n$$\n然后设置 $k = \\sqrt{r \\, \\lambda_{\\min}(-\\Delta)}$，使得 $k^2 = r \\, \\lambda_{\\min}(-\\Delta)$，其中 $r$ 为一个预设的比率。这种选择提供了对 $A$ 不定性阈值的可控接近度。\n\n设计决策：\n- 精确定义逐次超松弛 (SOR) 方法（首次使用时给出缩写），并直接从分裂构造 SOR 迭代矩阵，不使用未从分裂定义中证明的快捷公式。\n- 程序必须以数值方式计算谱半径。\n- 不涉及物理单位或角度；所有输出均为纯数字。\n- 所有输出均表示为四舍五入到六位小数的浮点数。\n\n测试套件：\n使用以下测试用例，每个用例以三元组 $(n, \\omega, r)$ 的形式给出：\n- 案例 1：$(n, \\omega, r) = (50, 1.2, 0.0)$。\n- 案例 2：$(n, \\omega, r) = (50, 1.2, 0.5)$。\n- 案例 3：$(n, \\omega, r) = (50, 1.2, 0.99)$。\n- 案例 4：$(n, \\omega, r) = (50, 1.2, 1.01)$。\n- 案例 5：$(n, \\omega, r) = (50, 1.2, 2.0)$。\n- 案例 6：$(n, \\omega, r) = (50, 1.8, 0.5)$。\n- 案例 7：$(n, \\omega, r) = (10, 1.2, 1.01)$。\n- 案例 8：$(n, \\omega, r) = (100, 1.2, 1.01)$。\n- 案例 9：$(n, \\omega, r) = (100, 1.0, 1.01)$。\n\n覆盖理由：\n- 案例 1–3 是“理想路径”，其中 $A$ 是对称正定的，SOR 应该收敛，谱半径小于 1。\n- 案例 4 刚刚超过不定性阈值，预计显示 $\\rho(T_{\\mathrm{SOR}})$ 大于或等于 1。\n- 案例 5 测试一个更强的不定区域。\n- 案例 6 改变松弛参数 $\\omega$ 到接近上界，但仍在正定矩阵的理论可接受范围内。\n- 案例 7–9 测试在不定性条件下的规模敏感性和不同的 $\\omega$ 值。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，结果顺序与测试用例相同，每个条目等于计算出的谱半径 $\\rho(T_{\\mathrm{SOR}})$，四舍五入到六位小数。例如，格式必须完全像 $[x_1,x_2,\\dots,x_9]$，其中每个 $x_i$ 是一个保留六位小数的十进制数。",
            "solution": "### 1. 逐次超松弛 (SOR) 迭代矩阵的推导\n\n目标是使用迭代方法求解线性系统 $Ax = b$。逐次超松弛 (SOR) 方法是一种源于矩阵 $A$ 分裂的定常迭代方法。\n\n首先，将矩阵 $A$ 分解为其对角、严格下三角和严格上三角部分：\n$$\nA = D - L - U\n$$\n其中 $D$ 是包含 $A$ 对角元素的对角矩阵，$-L$ 是 $A$ 的严格下三角部分，$-U$ 是 $A$ 的严格上三角部分。\n\n系统 $Ax = b$ 可以写成 $(D - L - U)x = b$。\n\n高斯-赛德尔迭代是通过在计算第 $m+1$ 步的 $x_i$ 分量时，立即使用所有已计算的同一步的 $x_j$ ($ji$) 分量来定义的：\n$$\n(D - L) x^{(m+1)} = U x^{(m)} + b\n$$\n\nSOR 方法引入一个松弛参数 $\\omega$ 来加速或稳定迭代过程。新的迭代向量 $x^{(m+1)}$ 的每个分量是前一个迭代向量 $x^{(m)}$ 和当前高斯-赛德尔更新的加权平均：\n$$\nx_i^{(m+1)} = (1-\\omega) x_i^{(m)} + \\frac{\\omega}{a_{ii}} \\left( b_i - \\sum_{ji} a_{ij}x_j^{(m+1)} - \\sum_{ji} a_{ij}x_j^{(m)} \\right)\n$$\n将所有分量写成矩阵形式，我们将上式乘以 $a_{ii}$ 并重排：\n$$\na_{ii}x_i^{(m+1)} + \\omega \\sum_{ji} a_{ij}x_j^{(m+1)} = (1-\\omega)a_{ii}x_i^{(m)} - \\omega \\sum_{ji} a_{ij}x_j^{(m)} + \\omega b_i\n$$\n这可以整合为矩阵方程：\n$$\n(D - \\omega L) x^{(m+1)} = ((1-\\omega)D + \\omega U) x^{(m)} + \\omega b\n$$\n由此，我们可以得到 SOR 迭代的标准仿射形式 $x^{(m+1)} = T_{\\mathrm{SOR}} x^{(m)} + c$：\n$$\nx^{(m+1)} = (D - \\omega L)^{-1}((1-\\omega)D + \\omega U) x^{(m)} + \\omega (D - \\omega L)^{-1} b\n$$\n因此，SOR 迭代矩阵 $T_{\\mathrm{SOR}}$ 是：\n$$\nT_{\\mathrm{SOR}} = (D - \\omega L)^{-1}((1-\\omega)D + \\omega U)\n$$\n\n### 2. 不定性与收敛性分析\n\n矩阵 $A$ 的形式为 $A = -\\Delta - k^2 I$，其中 $-\\Delta$ 是离散拉普拉斯算子。由于有狄利克雷边界条件，$-\\Delta$ 是对称正定（SPD）的，其所有特征值 $\\lambda_i(-\\Delta)$ 都是正的。\n\n矩阵 $A$ 的特征值 $\\lambda_i(A)$ 与 $-\\Delta$ 的特征值相关：\n$$\n\\lambda_i(A) = \\lambda_i(-\\Delta) - k^2\n$$\n当 $k=0$ 时，$A = -\\Delta$ 是 SPD 的。随着 $k$ 的增加，$A$ 的所有特征值都会向左平移 $k^2$。令 $\\lambda_{\\min}(-\\Delta)$ 为 $-\\Delta$ 的最小特征值。当 $k^2$ 超过 $\\lambda_{\\min}(-\\Delta)$ 时，$A$ 的最小特征值 $\\lambda_{\\min}(A) = \\lambda_{\\min}(-\\Delta) - k^2$ 将变为负数。然而，只要 $k^2$ 不超过 $\\lambda_{\\max}(-\\Delta)$，矩阵 $A$ 的最大特征值 $\\lambda_{\\max}(A)$ 仍将是正数。因此，当 $k^2  \\lambda_{\\min}(-\\Delta)$ 时，$A$ 将同时拥有正特征值和负特征值，成为一个**不定矩阵**。\n\nSOR 方法的收敛性理论（如奥斯特洛夫斯基-赖希定理）为 SPD 矩阵提供了强有力的保证：当 $A$ 是 SPD 时，SOR 迭代对所有 $\\omega \\in (0, 2)$ 都会收敛，即 $\\rho(T_{\\mathrm{SOR}})  1$。然而，一旦 $A$ 变为不定矩阵，这个保证就不再成立。收敛性不再得到保证，迭代很可能会发散，表现为迭代矩阵的谱半径 $\\rho(T_{\\mathrm{SOR}})$ 大于或等于 1。测试用例中的比率 $r$ 就是用来控制 $k^2$ 与 $\\lambda_{\\min}(-\\Delta)$ 的相对大小的，当 $r  1$ 时，系统进入不定区域。\n\n### 3. 数值实现\n\n数值实现见于答案块中提供的 Python 代码。代码根据每个测试用例 $(n, \\omega, r)$ 构造相应的矩阵 $A$，然后构造 $T_{\\mathrm{SOR}}$ 矩阵，并数值计算其谱半径，最后按要求格式化输出结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by constructing the SOR iteration matrix for several\n    test cases and computing its spectral radius.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (n, omega, r)\n        (50, 1.2, 0.0),\n        (50, 1.2, 0.5),\n        (50, 1.2, 0.99),\n        (50, 1.2, 1.01),\n        (50, 1.2, 2.0),\n        (50, 1.8, 0.5),\n        (10, 1.2, 1.01),\n        (100, 1.2, 1.01),\n        (100, 1.0, 1.01),\n    ]\n\n    results = []\n    for case in test_cases:\n        n, omega, r = case\n\n        # 1. Calculate grid parameters\n        h = 1.0 / (n + 1)\n\n        # 2. Calculate k^2 based on the smallest eigenvalue of the discrete Laplacian\n        lambda_min_laplacian = (4.0 / h**2) * np.sin(np.pi / (2.0 * (n + 1)))**2\n        k_squared = r * lambda_min_laplacian\n\n        # 3. Construct the matrix A for the Helmholtz-type system\n        # A = -Delta - k^2 * I\n        diag_val = (2.0 / h**2) - k_squared\n        offdiag_val = -1.0 / h**2\n        \n        A = np.diag(np.full(n, diag_val))\n        A += np.diag(np.full(n - 1, offdiag_val), k=1)\n        A += np.diag(np.full(n - 1, offdiag_val), k=-1)\n\n        # 4. Decompose A into D, L, and U for the splitting A = D - L - U\n        # D is the diagonal of A\n        D = np.diag(np.diag(A))\n        # L is the strictly lower triangular part of A, with sign flipped\n        L = -np.tril(A, k=-1)\n        # U is the strictly upper triangular part of A, with sign flipped\n        U = -np.triu(A, k=1)\n\n        # 5. Construct the SOR iteration matrix T_SOR\n        # T_SOR = inv(D - omega*L) * ((1-omega)*D + omega*U)\n        P = D - omega * L\n        Q = (1.0 - omega) * D + omega * U\n        \n        try:\n            P_inv = np.linalg.inv(P)\n            T_SOR = P_inv @ Q\n        except np.linalg.LinAlgError:\n            # This should not happen for the given test cases as D-omega*L is invertible.\n            # D is diagonal with positive entries, L is strictly lower.\n            # The determinant of a triangular matrix is the product of its diagonal elements.\n            # det(P) = det(D) != 0.\n            results.append(float('nan'))\n            continue\n\n        # 6. Compute the spectral radius of T_SOR\n        # rho(M) = max(|lambda_i(M)|)\n        eigenvalues = np.linalg.eigvals(T_SOR)\n        spectral_radius = np.max(np.abs(eigenvalues))\n        \n        results.append(spectral_radius)\n\n    # Final print statement in the exact required format.\n    # Each value must be represented as a float with 6 decimal places.\n    formatted_results = [\"{:.6f}\".format(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}