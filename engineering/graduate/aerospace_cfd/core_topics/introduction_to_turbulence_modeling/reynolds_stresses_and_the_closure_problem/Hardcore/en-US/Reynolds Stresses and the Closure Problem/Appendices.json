{
    "hands_on_practices": [
        {
            "introduction": "To effectively model turbulence, we must first have a firm grasp of the fundamental quantities involved. This exercise grounds your understanding of the two-equation models' core variables—turbulent kinetic energy ($k$) and its dissipation rate ($\\varepsilon$)—by having you derive their physical dimensions from their definitions . Mastering this basic dimensional analysis is a crucial first step for verifying the consistency of complex turbulence model equations and correctly interpreting the results of a simulation.",
            "id": "3991446",
            "problem": "Consider an incompressible, Newtonian turbulent flow over an aerospace lifting surface, analyzed within the framework of Computational Fluid Dynamics (CFD) and the Reynolds-Averaged Navier–Stokes (RANS) equations. Employ the Reynolds decomposition for the velocity field into mean and fluctuating parts, and consider the definitions of turbulent kinetic energy and dissipation rate as follows: the turbulent kinetic energy is defined by $k=\\frac{1}{2}\\,\\overline{u'_{i}u'_{i}}$, and the dissipation rate by $\\varepsilon=2\\,\\nu\\,\\overline{\\frac{\\partial u'_{i}}{\\partial x_{j}}\\frac{\\partial u'_{i}}{\\partial x_{j}}}$, where $u'_{i}$ denotes the turbulent velocity fluctuation component, $x_{j}$ is the spatial coordinate, $\\nu$ is the kinematic viscosity, and the overbar denotes Reynolds averaging. Using dimensional analysis based only on the base dimensions of length $L$ and time $T$, and the definition of kinematic viscosity $\\nu$ as a material property, derive the dimensional forms $[k]$ and $[\\varepsilon]$ expressed as products of powers of $L$ and $T$. \n\nExpress your final answer as a single row matrix whose two entries are $[k]$ and $[\\varepsilon]$ in terms of powers of $L$ and $T$. No rounding is required. Do not express your answer using any specific physical units; write it entirely in terms of $L$ and $T$.",
            "solution": "The problem requires the derivation of the dimensional forms of turbulent kinetic energy, $k$, and its dissipation rate, $\\varepsilon$, using dimensional analysis based on the fundamental dimensions of length, $L$, and time, $T$. The analysis will proceed by examining the definitions provided for each quantity.\n\nFirst, we establish the dimensions of the primary variables involved.\nThe dimension of a spatial coordinate, $x_j$, is length:\n$$[x_j] = L$$\nThe dimension of a velocity component, $u'_i$, is length per unit time:\n$$[u'_i] = L T^{-1}$$\nThe problem specifies to use the definition of kinematic viscosity, $\\nu$, as a material property. In fluid dynamics, the dimensions of kinematic viscosity are standard and are given by length squared per unit time:\n$$[\\nu] = L^2 T^{-1}$$\nNumerical constants, such as the $\\frac{1}{2}$ in the definition of $k$ and the $2$ in the definition of $\\varepsilon$, are dimensionless and have a dimension of $1$. The Reynolds averaging operator, denoted by an overbar, is a statistical averaging process that does not alter the dimensions of the quantity being averaged. Therefore, for any quantity $A$, $[\\overline{A}] = [A]$.\n\nWith these foundational dimensions established, we can proceed to analyze $k$ and $\\varepsilon$.\n\n**1. Dimensional Analysis of Turbulent Kinetic Energy ($k$)**\n\nThe turbulent kinetic energy per unit mass, $k$, is defined as:\n$$k = \\frac{1}{2}\\,\\overline{u'_{i}u'_{i}}$$\nTo find its dimension, $[k]$, we analyze the dimensions of the terms on the right-hand side. The term $u'_{i}u'_{i}$ is a summation over the index $i$ (Einstein notation), representing $(u'_1)^2 + (u'_2)^2 + (u'_3)^2$. For dimensional consistency, all terms in a sum must have the same dimension.\nThe dimension of the product $u'_{i}u'_{i}$ is the square of the dimension of a single velocity component.\n$$[u'_{i}u'_{i}] = [u'_i]^2 = (L T^{-1})^2 = L^2 T^{-2}$$\nThe dimensions of $k$ are therefore:\n$$[k] = \\left[\\frac{1}{2}\\right] [\\overline{u'_{i}u'_{i}}] = (1) \\times [u'_{i}u'_{i}] = L^2 T^{-2}$$\nThus, the dimensional form of turbulent kinetic energy is $L^2 T^{-2}$. This is consistent with the physical interpretation of kinetic energy per unit mass, which has dimensions of (velocity)$^2$.\n\n**2. Dimensional Analysis of the Dissipation Rate ($\\varepsilon$)**\n\nThe dissipation rate of turbulent kinetic energy, $\\varepsilon$, is defined as:\n$$\\varepsilon=2\\,\\nu\\,\\overline{\\frac{\\partial u'_{i}}{\\partial x_{j}}\\frac{\\partial u'_{i}}{\\partial x_{j}}}$$\nTo find its dimension, $[\\varepsilon]$, we first determine the dimension of the velocity gradient term, $\\frac{\\partial u'_{i}}{\\partial x_{j}}$. The dimension of a derivative is the dimension of the numerator divided by the dimension of the denominator.\n$$\\left[\\frac{\\partial u'_{i}}{\\partial x_{j}}\\right] = \\frac{[u'_i]}{[x_j]} = \\frac{L T^{-1}}{L} = T^{-1}$$\nThe term $\\frac{\\partial u'_{i}}{\\partial x_{j}}\\frac{\\partial u'_{i}}{\\partial x_{j}}$ involves a summation over both indices $i$ and $j$. This term represents the squared magnitude of the tensor of velocity fluctuations' gradients. Its dimension is the square of the dimension of a single velocity gradient component.\n$$\\left[\\frac{\\partial u'_{i}}{\\partial x_{j}}\\frac{\\partial u'_{i}}{\\partial x_{j}}\\right] = \\left[\\frac{\\partial u'_{i}}{\\partial x_{j}}\\right]^2 = (T^{-1})^2 = T^{-2}$$\nNow we can combine the dimensions of all parts of the definition of $\\varepsilon$:\n$$[\\varepsilon] = [2] [\\nu] \\left[\\overline{\\frac{\\partial u'_{i}}{\\partial x_{j}}\\frac{\\partial u'_{i}}{\\partial x_{j}}}\\right]$$\nSubstituting the dimensions we have found:\n$$[\\varepsilon] = (1) \\times (L^2 T^{-1}) \\times \\left( T^{-2} \\right) = L^2 T^{-3}$$\nThus, the dimensional form of the dissipation rate is $L^2 T^{-3}$. This is consistent with its physical meaning as the rate of energy dissipation per unit mass, which is (energy per unit mass) per unit time, or $[k]/T = (L^2 T^{-2}) / T = L^2 T^{-3}$.\n\nThe derived dimensional forms for $k$ and $\\varepsilon$ are $[k] = L^2 T^{-2}$ and $[\\varepsilon] = L^2 T^{-3}$. The problem asks for these to be presented as a single row matrix.",
            "answer": "$$\\boxed{\\begin{pmatrix} L^2 T^{-2}  L^2 T^{-3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "A key challenge in turbulence modeling is ensuring that the predicted Reynolds stresses are physically realistic. This practice introduces the Lumley triangle, an essential tool for visualizing the state of turbulence anisotropy and diagnosing whether a model's predictions are physically plausible . By deriving the boundaries of this realizability domain and mapping a given stress state onto it, you will develop a tangible understanding of these theoretical constraints and learn how to construct a practical diagnostic for analyzing CFD simulation data.",
            "id": "3991418",
            "problem": "A compressible flow simulation solved using the Reynolds-Averaged Navier-Stokes (RANS) equations produces a predicted symmetric Reynolds stress anisotropy tensor $a_{ij}$ at a control volume. The Reynolds stress tensor is defined by $R_{ij} = \\overline{u_{i}^{\\prime} u_{j}^{\\prime}}$, and the turbulent kinetic energy is $k = \\tfrac{1}{2} R_{ii}$. The anisotropy tensor is defined as $a_{ij} = \\tfrac{R_{ij}}{2k} - \\tfrac{1}{3} \\delta_{ij}$. The physical realizability of $R_{ij}$ implies that the eigenvalues of $R_{ij}$ are non-negative, and therefore the eigenvalues of $a_{ij}$ satisfy lower bounds and sum to zero. The Lumley triangle represents the convex set of all physically realizable states of turbulence anisotropy in the plane of invariants of $a_{ij}$ and is spanned by three limiting states: three-component isotropic turbulence (3C), two-component turbulence (2C), and one-component turbulence (1C).\n\nAt a given location, the predicted anisotropy tensor is diagonal,\n$$\na_{ij} = \\begin{pmatrix}\n\\frac{7}{10}  0  0 \\\\\n0  -\\frac{1}{5}  0 \\\\\n0  0  -\\frac{1}{2}\n\\end{pmatrix},\n$$\nwhich satisfies $a_{ii} = 0$. Starting from the definitions of $R_{ij}$, $k$, and $a_{ij}$, and using the invariant definitions\n$$\n\\mathrm{II} = a_{ij} a_{ji} = \\mathrm{tr}(a^{2}), \\qquad \\mathrm{III} = a_{ik} a_{kj} a_{ji} = \\mathrm{tr}(a^{3}),\n$$\nperform the following:\n\n1. Compute the invariants $\\mathrm{II}$ and $\\mathrm{III}$ for the given $a_{ij}$.\n\n2. Using only physical realizability constraints (non-negative eigenvalues of $R_{ij}$) and core definitions, derive the coordinates in the $(\\mathrm{II}, \\mathrm{III})$ plane of the three vertices of the Lumley triangle corresponding to the limiting states 3C, 2C, and 1C.\n\n3. Construct a linear barycentric mapping from $(\\mathrm{II}, \\mathrm{III})$ to the triangle spanned by the three vertices derived in part 2. Specifically, determine weights $w_{3\\mathrm{C}}$, $w_{2\\mathrm{C}}$, and $w_{1\\mathrm{C}}$ such that\n$$\n(\\mathrm{II}, \\mathrm{III}) = w_{3\\mathrm{C}} (\\mathrm{II}_{3\\mathrm{C}}, \\mathrm{III}_{3\\mathrm{C}}) + w_{2\\mathrm{C}} (\\mathrm{II}_{2\\mathrm{C}}, \\mathrm{III}_{2\\mathrm{C}}) + w_{1\\mathrm{C}} (\\mathrm{II}_{1\\mathrm{C}}, \\mathrm{III}_{1\\mathrm{C}}),\n$$\nwith $w_{3\\mathrm{C}} + w_{2\\mathrm{C}} + w_{1\\mathrm{C}} = 1$.\n\n4. Design a scalar diagnostic $D(a)$ that flags unphysical excursions by measuring how far the mapped point lies outside the realizable region. Define\n$$\nD(a) = \\max\\left(0, \\, -\\min\\{w_{3\\mathrm{C}}, w_{2\\mathrm{C}}, w_{1\\mathrm{C}}\\}\\right),\n$$\nand evaluate $D(a)$ for the given $a_{ij}$. Express the final diagnostic value as an exact fraction, dimensionless. No rounding is required.",
            "solution": "The problem statement is parsed and validated. All definitions regarding Reynolds stresses, turbulent kinetic energy, the anisotropy tensor, its invariants, and the concept of physical realizability are standard and correct within the field of turbulence modeling. The problem provides a well-defined, self-contained set of tasks that are scientifically grounded, objective, and logically structured. No contradictions, ambiguities, or factual unsoundness are present. Therefore, the problem is deemed valid and a full solution is warranted.\n\nThe solution proceeds in four sequential parts as requested by the problem statement.\n\n**1. Computation of Invariants $\\mathrm{II}$ and $\\mathrm{III}$**\n\nThe given Reynolds stress anisotropy tensor is\n$$\na_{ij} = \\begin{pmatrix}\n\\frac{7}{10}  0  0 \\\\\n0  -\\frac{1}{5}  0 \\\\\n0  0  -\\frac{1}{2}\n\\end{pmatrix}\n$$\nThis tensor is diagonal, so its eigenvalues, denoted $\\lambda_1, \\lambda_2, \\lambda_3$, are its diagonal elements:\n$$\n\\lambda_1 = \\frac{7}{10}, \\quad \\lambda_2 = -\\frac{1}{5}, \\quad \\lambda_3 = -\\frac{1}{2}\n$$\nThe trace is $\\mathrm{tr}(a) = \\lambda_1 + \\lambda_2 + \\lambda_3 = \\frac{7}{10} - \\frac{2}{10} - \\frac{5}{10} = 0$, which is consistent with the definition of the anisotropy tensor.\n\nThe second invariant, $\\mathrm{II}$, is defined as $\\mathrm{II} = a_{ij}a_{ji} = \\mathrm{tr}(a^2)$. For a diagonal tensor, this is the sum of the squares of its eigenvalues:\n$$\n\\mathrm{II} = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2 = \\left(\\frac{7}{10}\\right)^2 + \\left(-\\frac{1}{5}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2\n$$\n$$\n\\mathrm{II} = \\frac{49}{100} + \\frac{1}{25} + \\frac{1}{4} = \\frac{49}{100} + \\frac{4}{100} + \\frac{25}{100} = \\frac{78}{100} = \\frac{39}{50}\n$$\nThe third invariant, $\\mathrm{III}$, is defined as $\\mathrm{III} = a_{ik}a_{kj}a_{ji} = \\mathrm{tr}(a^3)$. This is the sum of the cubes of the eigenvalues:\n$$\n\\mathrm{III} = \\lambda_1^3 + \\lambda_2^3 + \\lambda_3^3 = \\left(\\frac{7}{10}\\right)^3 + \\left(-\\frac{1}{5}\\right)^3 + \\left(-\\frac{1}{2}\\right)^3\n$$\n$$\n\\mathrm{III} = \\frac{343}{1000} - \\frac{1}{125} - \\frac{1}{8} = \\frac{343}{1000} - \\frac{8}{1000} - \\frac{125}{1000} = \\frac{343 - 133}{1000} = \\frac{210}{1000} = \\frac{21}{100}\n$$\nSo, the point in the invariant plane is $(\\mathrm{II}, \\mathrm{III}) = (\\frac{39}{50}, \\frac{21}{100})$.\n\n**2. Derivation of Lumley Triangle Vertices**\n\nThe physical realizability of the Reynolds stress tensor $R_{ij}$ requires that its eigenvalues, $\\lambda_i(R)$, are non-negative. The relationship between $R_{ij}$ and $a_{ij}$ is $R_{ij} = 2k(a_{ij} + \\frac{1}{3}\\delta_{ij})$. Since $a_{ij}$ and $R_{ij}$ differ by a multiple of the identity matrix, they share eigenvectors, and their eigenvalues are related by $\\lambda_i(R) = 2k(\\lambda_i(a) + \\frac{1}{3})$. As the turbulent kinetic energy $k \\ge 0$, the realizability constraint $\\lambda_i(R) \\ge 0$ implies $\\lambda_i(a) + \\frac{1}{3} \\ge 0$, or $\\lambda_i(a) \\ge -\\frac{1}{3}$. We analyze the three limiting states in the principal coordinate system of $a_{ij}$.\n\n**3C (Three-Component Isotropic) State:** This is the state of isotropic turbulence, where $R_{ij} = \\frac{2}{3}k\\delta_{ij}$.\n$$\na_{ij} = \\frac{R_{ij}}{2k} - \\frac{1}{3}\\delta_{ij} = \\frac{\\frac{2}{3}k\\delta_{ij}}{2k} - \\frac{1}{3}\\delta_{ij} = \\frac{1}{3}\\delta_{ij} - \\frac{1}{3}\\delta_{ij} = 0\n$$\nThe anisotropy tensor is the zero tensor. Its eigenvalues are all zero: $\\lambda_1 = \\lambda_2 = \\lambda_3 = 0$.\nThe invariants are:\n$\\mathrm{II}_{3\\mathrm{C}} = 0^2+0^2+0^2 = 0$\n$\\mathrm{III}_{3\\mathrm{C}} = 0^3+0^3+0^3 = 0$\nThe 3C vertex is $(\\mathrm{II}_{3\\mathrm{C}}, \\mathrm{III}_{3\\mathrm{C}}) = (0, 0)$.\n\n**1C (One-Component) State:** This is the limit where turbulence is a single shear wave. In the principal frame, only one velocity fluctuation component exists, e.g., $u'_1 \\neq 0$, $u'_2=u'_3=0$. This gives $R_{11} = 2k$ and $R_{22}=R_{33}=0$.\nThe components of the anisotropy tensor are:\n$a_{11} = \\frac{R_{11}}{2k} - \\frac{1}{3} = \\frac{2k}{2k} - \\frac{1}{3} = \\frac{2}{3}$\n$a_{22} = \\frac{0}{2k} - \\frac{1}{3} = -\\frac{1}{3}$\n$a_{33} = \\frac{0}{2k} - \\frac{1}{3} = -\\frac{1}{3}$\nThe eigenvalues are $\\lambda_1 = \\frac{2}{3}$, $\\lambda_2 = -\\frac{1}{3}$, $\\lambda_3 = -\\frac{1}{3}$. These satisfy the trace-zero and realizability conditions.\nThe invariants are:\n$\\mathrm{II}_{1\\mathrm{C}} = (\\frac{2}{3})^2 + (-\\frac{1}{3})^2 + (-\\frac{1}{3})^2 = \\frac{4}{9} + \\frac{1}{9} + \\frac{1}{9} = \\frac{6}{9} = \\frac{2}{3}$\n$\\mathrm{III}_{1\\mathrm{C}} = (\\frac{2}{3})^3 + (-\\frac{1}{3})^3 + (-\\frac{1}{3})^3 = \\frac{8}{27} - \\frac{1}{27} - \\frac{1}{27} = \\frac{6}{27} = \\frac{2}{9}$\nThe 1C vertex is $(\\mathrm{II}_{1\\mathrm{C}}, \\mathrm{III}_{1\\mathrm{C}}) = (\\frac{2}{3}, \\frac{2}{9})$.\n\n**2C (Two-Component Axisymmetric) State:** This is the limit where turbulence is confined to a plane ($u'_3=0$) and is axisymmetric in that plane ($\\overline{u_1'^2} = \\overline{u_2'^2}$). The condition $R_{33}=0$ implies $\\lambda_3(R)=0$, so $\\lambda_3(a) = -\\frac{1}{3}$. The axisymmetry condition implies $\\lambda_1(a) = \\lambda_2(a)$. The trace-zero condition $\\lambda_1+\\lambda_2+\\lambda_3=0$ gives $2\\lambda_1 - \\frac{1}{3} = 0$, so $\\lambda_1 = \\frac{1}{6}$.\nThe eigenvalues are $\\lambda_1 = \\frac{1}{6}$, $\\lambda_2 = \\frac{1}{6}$, $\\lambda_3 = -\\frac{1}{3}$. These satisfy the constraints.\nThe invariants are:\n$\\mathrm{II}_{2\\mathrm{C}} = (\\frac{1}{6})^2 + (\\frac{1}{6})^2 + (-\\frac{1}{3})^2 = \\frac{1}{36} + \\frac{1}{36} + \\frac{4}{36} = \\frac{6}{36} = \\frac{1}{6}$\n$\\mathrm{III}_{2\\mathrm{C}} = (\\frac{1}{6})^3 + (\\frac{1}{6})^3 + (-\\frac{1}{3})^3 = \\frac{1}{216} + \\frac{1}{216} - \\frac{8}{216} = -\\frac{6}{216} = -\\frac{1}{36}$\nThe 2C vertex is $(\\mathrm{II}_{2\\mathrm{C}}, \\mathrm{III}_{2\\mathrm{C}}) = (\\frac{1}{6}, -\\frac{1}{36})$.\n\n**3. Barycentric Mapping**\n\nWe need to find weights $w_{3\\mathrm{C}}, w_{2\\mathrm{C}}, w_{1\\mathrm{C}}$ such that:\n$$\n(\\mathrm{II}, \\mathrm{III}) = w_{3\\mathrm{C}} (\\mathrm{II}_{3\\mathrm{C}}, \\mathrm{III}_{3\\mathrm{C}}) + w_{2\\mathrm{C}} (\\mathrm{II}_{2\\mathrm{C}}, \\mathrm{III}_{2\\mathrm{C}}) + w_{1\\mathrm{C}} (\\mathrm{II}_{1\\mathrm{C}}, \\mathrm{III}_{1\\mathrm{C}})\n$$\nand $w_{3\\mathrm{C}} + w_{2\\mathrm{C}} + w_{1\\mathrm{C}} = 1$.\nSubstituting the vertex coordinates and the calculated invariants for the given tensor:\n$$\n\\left(\\frac{39}{50}, \\frac{21}{100}\\right) = w_{3\\mathrm{C}}(0,0) + w_{2\\mathrm{C}}\\left(\\frac{1}{6}, -\\frac{1}{36}\\right) + w_{1\\mathrm{C}}\\left(\\frac{2}{3}, \\frac{2}{9}\\right)\n$$\nThis yields a system of two linear equations for $w_{2\\mathrm{C}}$ and $w_{1\\mathrm{C}}$:\n1. $\\frac{39}{50} = \\frac{1}{6} w_{2\\mathrm{C}} + \\frac{2}{3} w_{1\\mathrm{C}}$\n2. $\\frac{21}{100} = -\\frac{1}{36} w_{2\\mathrm{C}} + \\frac{2}{9} w_{1\\mathrm{C}}$\n\nMultiply equation (1) by $6$: $\\frac{117}{25} = w_{2\\mathrm{C}} + 4w_{1\\mathrm{C}}$.\nMultiply equation (2) by $36$: $\\frac{189}{25} = -w_{2\\mathrm{C}} + 8w_{1\\mathrm{C}}$.\nAdding these two new equations gives:\n$$\n\\frac{117}{25} + \\frac{189}{25} = (w_{2\\mathrm{C}} - w_{2\\mathrm{C}}) + (4w_{1\\mathrm{C}} + 8w_{1\\mathrm{C}})\n$$\n$$\n\\frac{306}{25} = 12w_{1\\mathrm{C}} \\implies w_{1\\mathrm{C}} = \\frac{306}{12 \\cdot 25} = \\frac{51}{2 \\cdot 25} = \\frac{51}{50}\n$$\nSubstitute $w_{1\\mathrm{C}}$ back into $\\frac{117}{25} = w_{2\\mathrm{C}} + 4w_{1\\mathrm{C}}$:\n$$\nw_{2\\mathrm{C}} = \\frac{117}{25} - 4\\left(\\frac{51}{50}\\right) = \\frac{234}{50} - \\frac{204}{50} = \\frac{30}{50} = \\frac{3}{5}\n$$\nFinally, use the sum constraint $w_{3\\mathrm{C}} + w_{2\\mathrm{C}} + w_{1\\mathrm{C}} = 1$:\n$$\nw_{3\\mathrm{C}} = 1 - w_{2\\mathrm{C}} - w_{1\\mathrm{C}} = 1 - \\frac{3}{5} - \\frac{51}{50} = \\frac{50}{50} - \\frac{30}{50} - \\frac{51}{50} = -\\frac{31}{50}\n$$\nThe weights are $w_{3\\mathrm{C}} = -\\frac{31}{50}$, $w_{2\\mathrm{C}} = \\frac{3}{5}$, and $w_{1\\mathrm{C}} = \\frac{51}{50}$. The negative value of $w_{3\\mathrm{C}}$ indicates the point lies outside the physical Lumley triangle.\n\n**4. Evaluation of the Diagnostic $D(a)$**\n\nThe diagnostic for unphysical excursions is defined as:\n$$\nD(a) = \\max\\left(0, \\, -\\min\\{w_{3\\mathrm{C}}, w_{2\\mathrm{C}}, w_{1\\mathrm{C}}\\}\\right)\n$$\nFirst, we find the minimum of the weights:\n$$\n\\min\\left\\{-\\frac{31}{50}, \\frac{3}{5}, \\frac{51}{50}\\right\\} = \\min\\left\\{-\\frac{31}{50}, \\frac{30}{50}, \\frac{51}{50}\\right\\} = -\\frac{31}{50}\n$$\nNext, we substitute this into the definition of $D(a)$:\n$$\nD(a) = \\max\\left(0, \\, -\\left(-\\frac{31}{50}\\right)\\right) = \\max\\left(0, \\frac{31}{50}\\right)\n$$\nThis evaluates to:\n$$\nD(a) = \\frac{31}{50}\n$$\nThis non-zero value quantifies the extent to which the predicted tensor $a_{ij}$ violates physical realizability, measured in terms of barycentric coordinates relative to the Lumley triangle.",
            "answer": "$$\\boxed{\\frac{31}{50}}$$"
        },
        {
            "introduction": "The final link between a theoretical model and a reliable simulation is rigorous code verification. This hands-on coding exercise guides you through the Method of Manufactured Solutions (MMS), a cornerstone of quality assurance in computational science . By implementing a verification test for a model transport equation analogous to those used for Reynolds stresses, you will learn how to systematically confirm that your code is solving the equations with the expected order of accuracy and that all source terms are implemented correctly.",
            "id": "3991458",
            "problem": "Consider the transport of the Reynolds stress tensor components in the Reynolds-Averaged Navier–Stokes (RANS) framework. The exact Reynolds stress transport equation for a component $R_{ij}$ includes convection, turbulent diffusion, production, pressure–strain, and dissipation. To design a verification test that isolates spatial discretization and the implementation of a modeled source term under controlled conditions, consider the following simplified steady two-dimensional manufactured transport model for a generic component $R$:\n$$\nu\\,\\frac{\\partial R}{\\partial x} + v\\,\\frac{\\partial R}{\\partial y} - \\nu\\,\\left(\\frac{\\partial^2 R}{\\partial x^2} + \\frac{\\partial^2 R}{\\partial y^2}\\right) + \\lambda\\,R = S(x,y),\n$$\nwhere $u$ and $v$ are prescribed mean velocities (nondimensional), $\\nu$ is a positive diffusion coefficient (nondimensional eddy viscosity), and $\\lambda \\ge 0$ is a linear reaction coefficient that represents a simplified closure for combined pressure–strain and dissipation effects. The source term $S(x,y)$ is to be constructed by the Method of Manufactured Solutions (MMS) so that a chosen exact solution $R^{\\text{MS}}(x,y)$ satisfies the equation.\n\nYou will verify a second-order finite difference discretization for this equation on the unit square domain $[0,1]\\times[0,1]$ with Dirichlet boundary conditions set equal to the manufactured solution $R^{\\text{MS}}(x,y)$ on all boundaries. Use uniform grids with $N\\times N$ interior points (i.e., $N$ points in each direction excluding boundaries), spacing $h=1/(N+1)$, and standard second-order central differences for both first and second spatial derivatives. The discrete linear operator should reflect the continuous operator above. Assemble the linear system for the interior unknowns and solve it exactly (to linear solver tolerance) for $R$.\n\nDefine two smooth manufactured solutions:\n- $\\mathcal{R}_1(x,y) = \\sin(\\pi x)\\,\\sin(\\pi y)$,\n- $\\mathcal{R}_2(x,y) = \\cos(2\\pi x)\\,\\sin(\\pi y)$.\n\nFor a given choice of $u$, $v$, $\\nu$, and $\\lambda$, the correct manufactured source $S(x,y)$ must be derived so that the continuous equation is satisfied exactly by the chosen $\\mathcal{R}(x,y)$. In one of the test cases, deliberately implement an incorrect source that omits the reaction term $\\lambda\\,\\mathcal{R}(x,y)$, while keeping all other terms consistent, to assess sensitivity to source term errors.\n\nNumerically estimate the order of accuracy $p$ by computing the discrete $L^2$ error between the numerical solution and the exact manufactured solution over the interior grid for three refinement levels $N\\in\\{16,32,64\\}$:\n$$\ne_N = \\left(h^2\\,\\sum_{i=1}^{N}\\sum_{j=1}^{N}\\left(R_{ij}^{\\text{num}} - R^{\\text{MS}}(x_i,y_j)\\right)^2\\right)^{1/2},\n\\quad x_i = \\frac{i}{N+1},\\quad y_j = \\frac{j}{N+1},\n$$\nand then\n$$\np = \\frac{\\log\\left(e_{32}/e_{64}\\right)}{\\log(2)}.\n$$\nFor correctly implemented sources with a consistent second-order scheme, $p$ should be close to $2$. For the incorrect source case, the error will be dominated by the model inconsistency and will not decay with refinement, so $p$ should be close to $0$.\n\nTest Suite:\n- Case A (happy path): $u=0.5$, $v=0.3$, $\\nu=0.1$, $\\lambda=1.0$, manufactured solution $\\mathcal{R}_1$, correct source.\n- Case B (source error): $u=0.5$, $v=0.3$, $\\nu=0.1$, $\\lambda=1.0$, manufactured solution $\\mathcal{R}_1$, incorrect source that omits the $\\lambda\\,\\mathcal{R}$ term.\n- Case C (sign-varied advection): $u=0.25$, $v=-0.2$, $\\nu=0.08$, $\\lambda=0.7$, manufactured solution $\\mathcal{R}_2$, correct source.\n- Case D (degenerate advection, zero reaction): $u=0$, $v=0$, $\\nu=0.05$, $\\lambda=0$, manufactured solution $\\mathcal{R}_1$, correct source.\n\nYour program must:\n- Build and solve the discrete systems for $N=16$, $N=32$, and $N=64$ for each case.\n- Compute $p$ using the formula above for each case.\n- For each case, also compute a boolean pass/fail indicator defined as follows:\n  - If the source is correct, pass is true when $p \\in [1.8, 2.2]$.\n  - If the source is incorrect, pass is true when $p  0.5$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$[p_A,\\text{pass}_A,p_B,\\text{pass}_B,p_C,\\text{pass}_C,p_D,\\text{pass}_D]$,\nwhere each $p$ is a floating-point number and each pass is a boolean. No physical units are involved because the variables are nondimensional. Angles are not present. Percentages must not be used; all outputs are raw numbers or booleans.",
            "solution": "The problem is valid. It presents a well-posed, scientifically grounded verification task using the Method of Manufactured Solutions (MMS), a standard technique in computational fluid dynamics (CFD) and numerical analysis. All necessary data, equations, and criteria are provided, and there are no internal contradictions or factual errors.\n\n### 1. Problem Formulation\n\nThe task is to verify a numerical scheme for the steady, two-dimensional advection-diffusion-reaction equation:\n$$\nu\\,\\frac{\\partial R}{\\partial x} + v\\,\\frac{\\partial R}{\\partial y} - \\nu\\,\\left(\\frac{\\partial^2 R}{\\partial x^2} + \\frac{\\partial^2 R}{\\partial y^2}\\right) + \\lambda\\,R = S(x,y)\n$$\nThis equation is defined on the unit square domain $(x,y) \\in [0,1]\\times[0,1]$. The parameters $u$ and $v$ represent constant velocity components, $\\nu  0$ is a diffusion coefficient, and $\\lambda \\ge 0$ is a reaction coefficient. The term $S(x,y)$ is a source term.\n\n### 2. Method of Manufactured Solutions (MMS)\n\nThe core of the verification procedure is the MMS. We first define a \"manufactured\" solution, $R^{\\text{MS}}(x,y)$, which is a smooth function that satisfies the desired boundary conditions. We then substitute this solution into the governing differential operator to derive the corresponding source term $S(x,y)$ that makes the equation exact.\n\nLet the differential operator be denoted by $\\mathcal{L}$:\n$$\n\\mathcal{L}(R) \\equiv u\\,\\frac{\\partial R}{\\partial x} + v\\,\\frac{\\partial R}{\\partial y} - \\nu\\,\\nabla^2 R + \\lambda\\,R\n$$\nwhere $\\nabla^2 \\equiv \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ is the Laplace operator.\nThe manufactured source term is then calculated as $S(x,y) = \\mathcal{L}(R^{\\text{MS}}(x,y))$.\n\nTwo manufactured solutions are provided:\n\n**Case 1: $\\mathcal{R}_1(x,y) = \\sin(\\pi x)\\,\\sin(\\pi y)$**\nThe required partial derivatives are:\n$$ \\frac{\\partial \\mathcal{R}_1}{\\partial x} = \\pi \\cos(\\pi x)\\,\\sin(\\pi y) $$\n$$ \\frac{\\partial \\mathcal{R}_1}{\\partial y} = \\pi \\sin(\\pi x)\\,\\cos(\\pi y) $$\n$$ \\frac{\\partial^2 \\mathcal{R}_1}{\\partial x^2} = -\\pi^2 \\sin(\\pi x)\\,\\sin(\\pi y) = -\\pi^2 \\mathcal{R}_1(x,y) $$\n$$ \\frac{\\partial^2 \\mathcal{R}_1}{\\partial y^2} = -\\pi^2 \\sin(\\pi x)\\,\\sin(\\pi y) = -\\pi^2 \\mathcal{R}_1(x,y) $$\n$$ \\nabla^2 \\mathcal{R}_1 = -2\\pi^2 \\mathcal{R}_1(x,y) $$\nSubstituting these derivatives into the operator $\\mathcal{L}$ yields the source term $S_1(x,y)$:\n$$ S_1(x,y) = u\\,\\pi \\cos(\\pi x)\\sin(\\pi y) + v\\,\\pi \\sin(\\pi x)\\cos(\\pi y) - \\nu(-2\\pi^2 \\mathcal{R}_1(x,y)) + \\lambda \\mathcal{R}_1(x,y) $$\n$$ S_1(x,y) = u\\,\\pi \\cos(\\pi x)\\sin(\\pi y) + v\\,\\pi \\sin(\\pi x)\\cos(\\pi y) + (2\\nu\\pi^2 + \\lambda)\\sin(\\pi x)\\sin(\\pi y) $$\n\n**Case 2: $\\mathcal{R}_2(x,y) = \\cos(2\\pi x)\\,\\sin(\\pi y)$**\nThe required partial derivatives are:\n$$ \\frac{\\partial \\mathcal{R}_2}{\\partial x} = -2\\pi \\sin(2\\pi x)\\,\\sin(\\pi y) $$\n$$ \\frac{\\partial \\mathcal{R}_2}{\\partial y} = \\pi \\cos(2\\pi x)\\,\\cos(\\pi y) $$\n$$ \\frac{\\partial^2 \\mathcal{R}_2}{\\partial x^2} = -4\\pi^2 \\cos(2\\pi x)\\,\\sin(\\pi y) = -4\\pi^2 \\mathcal{R}_2(x,y) $$\n$$ \\frac{\\partial^2 \\mathcal{R}_2}{\\partial y^2} = -\\pi^2 \\cos(2\\pi x)\\,\\sin(\\pi y) = -\\pi^2 \\mathcal{R}_2(x,y) $$\n$$ \\nabla^2 \\mathcal{R}_2 = -5\\pi^2 \\mathcal{R}_2(x,y) $$\nSubstituting these into $\\mathcal{L}$ yields the source term $S_2(x,y)$:\n$$ S_2(x,y) = u(-2\\pi \\sin(2\\pi x)\\sin(\\pi y)) + v(\\pi \\cos(2\\pi x)\\cos(\\pi y)) - \\nu(-5\\pi^2 \\mathcal{R}_2(x,y)) + \\lambda \\mathcal{R}_2(x,y) $$\n$$ S_2(x,y) = -2u\\pi \\sin(2\\pi x)\\sin(\\pi y) + v\\pi \\cos(2\\pi x)\\cos(\\pi y) + (5\\nu\\pi^2 + \\lambda)\\cos(2\\pi x)\\sin(\\pi y) $$\n\n### 3. Finite Difference Discretization\n\nThe domain is discretized using a uniform grid with $N \\times N$ interior points. The grid spacing is $h = 1/(N+1)$, and coordinates are $x_i = i h$, $y_j = j h$ for $i,j \\in \\{0, 1, \\dots, N+1\\}$. The numerical solution $R_{i,j}$ is sought at the interior points where $i,j \\in \\{1, \\dots, N\\}$.\n\nStandard second-order central difference formulas are applied:\n$$ \\left.\\frac{\\partial R}{\\partial x}\\right|_{i,j} \\approx \\frac{R_{i+1,j} - R_{i-1,j}}{2h} $$\n$$ \\left.\\frac{\\partial^2 R}{\\partial x^2}\\right|_{i,j} \\approx \\frac{R_{i+1,j} - 2R_{i,j} + R_{i-1,j}}{h^2} $$\nAnalogous formulas apply for the $y$-derivatives. Substituting these into the governing equation at an interior point $(x_i, y_j)$ gives the discrete algebraic equation:\n$$ u\\left(\\frac{R_{i+1,j} - R_{i-1,j}}{2h}\\right) + v\\left(\\frac{R_{i,j+1} - R_{i,j-1}}{2h}\\right) - \\nu\\left(\\frac{R_{i+1,j} - 2R_{i,j} + R_{i-1,j}}{h^2} + \\frac{R_{i,j+1} - 2R_{i,j} + R_{i,j-1}}{h^2}\\right) + \\lambda R_{i,j} = S(x_i, y_j) $$\nRearranging the terms to group coefficients for each grid point gives:\n$$ \\left(\\frac{4\\nu}{h^2} + \\lambda\\right)R_{i,j} + \\left(\\frac{u}{2h} - \\frac{\\nu}{h^2}\\right)R_{i+1,j} + \\left(-\\frac{u}{2h} - \\frac{\\nu}{h^2}\\right)R_{i-1,j} + \\left(\\frac{v}{2h} - \\frac{\\nu}{h^2}\\right)R_{i,j+1} + \\left(-\\frac{v}{2h} - \\frac{\\nu}{h^2}\\right)R_{i,j-1} = S_{i,j} $$\n\n### 4. Linear System Assembly and Solution\n\nThe set of $N^2$ discrete equations for all interior points forms a large, sparse linear system of the form $A\\mathbf{R} = \\mathbf{b}$. The unknown vector $\\mathbf{R}$ is created by flattening the $N \\times N$ grid of values $R_{i,j}$ into a single vector of length $N^2$. Using a row-major ordering, the index $k$ for point $(i,j)$ is $k = (j-1)N + i-1$.\n\nThe matrix $A$ is an $N^2 \\times N^2$ pentadiagonal matrix. Its non-zero entries correspond to the coefficients of $R_{i,j}$ and its four neighbors.\nThe right-hand side vector $\\mathbf{b}$ contains the value of the source term $S(x_i, y_j)$ at each corresponding point. For points adjacent to the boundary (e.g., $i=1$, $i=N$, $j=1$, or $j=N$), the terms involving boundary values (e.g., $R_{0,j}$, $R_{N+1,j}$) are known from the Dirichlet condition $R(x,y) = R^{\\text{MS}}(x,y)$. These known terms are moved to the right-hand side, modifying the $\\mathbf{b}$ vector accordingly.\n\nThis linear system is then solved for $\\mathbf{R}$ to obtain the numerical solution $R^{\\text{num}}$.\n\n### 5. Verification and Order of Accuracy\n\nThe accuracy of the numerical solution is quantified by computing the discrete $L^2$ error, $e_N$, against the exact manufactured solution $R^{\\text{MS}}$:\n$$\ne_N = \\left(h^2\\,\\sum_{i=1}^{N}\\sum_{j=1}^{N}\\left(R_{ij}^{\\text{num}} - R^{\\text{MS}}(x_i,y_j)\\right)^2\\right)^{1/2}\n$$\nA grid refinement study is performed with $N\\in\\{16,32,64\\}$. The observed order of accuracy, $p$, is calculated using the errors from two successive grid refinements:\n$$\np = \\frac{\\log\\left(e_{32}/e_{64}\\right)}{\\log(2)}\n$$\nFor a correctly implemented second-order scheme with a consistent source term, the error should decrease quadratically with $h$ (i.e., $e_N \\propto h^2$), and thus $p$ should be close to $2$. When an incorrect source term is used, the discretization error is dominated by the modeling error (the difference between the correct and incorrect sources), which does not decrease with grid refinement. Consequently, the error $e_N$ tends toward a constant, leading to an order of accuracy $p \\approx 0$. The pass/fail criteria provided in the problem statement formalize these expectations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse import linalg\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n\n    def R1_func(x, y):\n        \"\"\"Manufactured solution R_1.\"\"\"\n        return np.sin(np.pi * x) * np.sin(np.pi * y)\n\n    def R2_func(x, y):\n        \"\"\"Manufactured solution R_2.\"\"\"\n        return np.cos(2 * np.pi * x) * np.sin(np.pi * y)\n\n    def S1_correct(x, y, u, v, nu, lam):\n        \"\"\"Correct source term for R_1.\"\"\"\n        pi = np.pi\n        term_u = u * pi * np.cos(pi * x) * np.sin(pi * y)\n        term_v = v * pi * np.sin(pi * x) * np.cos(pi * y)\n        term_nu_lam = (2 * nu * pi**2 + lam) * R1_func(x, y)\n        return term_u + term_v + term_nu_lam\n\n    def S1_incorrect(x, y, u, v, nu, lam):\n        \"\"\"Incorrect source for R_1, omitting the lambda term.\"\"\"\n        pi = np.pi\n        term_u = u * pi * np.cos(pi * x) * np.sin(pi * y)\n        term_v = v * pi * np.sin(pi * x) * np.cos(pi * y)\n        term_nu = (2 * nu * pi**2) * R1_func(x, y)\n        return term_u + term_v + term_nu\n\n    def S2_correct(x, y, u, v, nu, lam):\n        \"\"\"Correct source term for R_2.\"\"\"\n        pi = np.pi\n        term_u = u * (-2 * pi * np.sin(2 * pi * x) * np.sin(pi * y))\n        term_v = v * (pi * np.cos(2 * pi * x) * np.cos(pi * y))\n        term_nu_lam = (5 * nu * pi**2 + lam) * R2_func(x, y)\n        return term_u + term_v + term_nu_lam\n\n    def solve_case(params):\n        \"\"\"\n        Solves a single test case for multiple grid resolutions,\n        computes the order of accuracy p, and determines the pass/fail status.\n        \"\"\"\n        u, v, nu, lam, R_func, S_func, is_correct_source = params\n        errors = []\n        grid_sizes = [16, 32, 64]\n\n        for N in grid_sizes:\n            h = 1.0 / (N + 1)\n            \n            # Create grid coordinates for interior points\n            x_int = np.linspace(h, 1.0 - h, N)\n            y_int = np.linspace(h, 1.0 - h, N)\n            X, Y = np.meshgrid(x_int, y_int)\n\n            # Assemble the sparse matrix A and RHS vector b\n            num_unknowns = N * N\n            A = sparse.lil_matrix((num_unknowns, num_unknowns))\n            b = np.zeros(num_unknowns)\n\n            # Pre-calculate finite difference coefficients\n            coeff_center = 4 * nu / h**2 + lam\n            coeff_ip1 = u / (2 * h) - nu / h**2\n            coeff_im1 = -u / (2 * h) - nu / h**2\n            coeff_jp1 = v / (2 * h) - nu / h**2\n            coeff_jm1 = -v / (2 * h) - nu / h**2\n\n            for j in range(N):  # Index for y-direction\n                for i in range(N):  # Index for x-direction\n                    # Map 2D (i, j) grid index to 1D row index k\n                    k = j * N + i\n\n                    # Diagonal entry\n                    A[k, k] = coeff_center\n                    \n                    # Source term\n                    b[k] = S_func(X[j, i], Y[j, i], u, v, nu, lam)\n\n                    # Off-diagonal entries (j, i-1)\n                    if i  0:\n                        A[k, k - 1] = coeff_im1\n                    else:  # Boundary at x=0\n                        b[k] -= coeff_im1 * R_func(0, Y[j, i])\n\n                    # Off-diagonal entries (j, i+1)\n                    if i  N - 1:\n                        A[k, k + 1] = coeff_ip1\n                    else:  # Boundary at x=1\n                        b[k] -= coeff_ip1 * R_func(1, Y[j, i])\n\n                    # Off-diagonal entries (j-1, i)\n                    if j  0:\n                        A[k, k - N] = coeff_jm1\n                    else:  # Boundary at y=0\n                        b[k] -= coeff_jm1 * R_func(X[j, i], 0)\n\n                    # Off-diagonal entries (j+1, i)\n                    if j  N - 1:\n                        A[k, k + N] = coeff_jp1\n                    else:  # Boundary at y=1\n                        b[k] -= coeff_jp1 * R_func(X[j, i], 1)\n            \n            # Solve the linear system\n            A_csc = A.tocsc()\n            R_vec = linalg.spsolve(A_csc, b)\n            R_num = R_vec.reshape((N, N))\n\n            # Compute L2 error\n            R_exact = R_func(X, Y)\n            error_val = np.sqrt(h**2 * np.sum((R_num - R_exact)**2))\n            errors.append(error_val)\n        \n        # Calculate order of accuracy using N=32 and N=64 results\n        e32, e64 = errors[1], errors[2]\n        p = np.log(e32 / e64) / np.log(2) if e64  0 else 0.0\n\n        # Determine pass/fail status\n        if is_correct_source:\n            passed = 1.8 = p = 2.2\n        else:\n            passed = p  0.5\n            \n        return p, passed\n\n    test_cases = [\n        # Case A: happy path\n        (0.5, 0.3, 0.1, 1.0, R1_func, S1_correct, True),\n        # Case B: source error\n        (0.5, 0.3, 0.1, 1.0, R1_func, S1_incorrect, False),\n        # Case C: sign-varied advection\n        (0.25, -0.2, 0.08, 0.7, R2_func, S2_correct, True),\n        # Case D: degenerate advection, zero reaction\n        (0.0, 0.0, 0.05, 0.0, R1_func, S1_correct, True),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        p_val, pass_status = solve_case(case)\n        all_results.extend([p_val, pass_status])\n\n    # Final print statement in the exact required format.\n    formatted_results = [str(item) for item in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}