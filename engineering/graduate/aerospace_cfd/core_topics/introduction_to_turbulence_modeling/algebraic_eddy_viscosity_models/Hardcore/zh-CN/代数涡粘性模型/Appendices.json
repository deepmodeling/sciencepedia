{
    "hands_on_practices": [
        {
            "introduction": "理解代数模型的第一步是追溯其理论源头。本练习旨在通过连接路德维希·普朗特（Ludwig Prandtl）的混合长度物理直觉与布辛涅斯克（Boussinesq）假设的数学框架，来构建涡粘性的基本形式。完成这个推导，你将能亲身体会到“零方程”模型是如何将一个直观的物理概念转化为雷诺平均纳维-斯托克斯（RANS）方程中一个可用的数学表达式的 ()。",
            "id": "3943005",
            "problem": "考虑两平行平板间的统计定常、充分发展的不可压缩平面湍流槽道流，其平均速度为流向的 $U(y)$，且仅取决于法向坐标 $y$。设流体密度为 $\\rho$，运动粘度为 $\\nu$。假设采用雷诺平均纳维-斯托克斯 (RANS) 框架，并采纳 Boussinesq 涡粘性假设，其中湍流雷诺切应力 $-\\overline{u^{\\prime} v^{\\prime}}$ 被模化为 $-\\overline{u^{\\prime} v^{\\prime}} = \\nu_{t} \\, \\partial U / \\partial y$，$\\nu_{t}$ 为涡粘性系数。此外，对动量输运采纳 Prandtl 混合长度假设，并假设在对数区中，混合长度与壁面距离呈线性关系，即 $\\ell = \\kappa \\, y$，其中 $\\kappa$ 是 von Kármán 常数，$y$ 是与最近壁面的距离。\n\n仅从这些模型假设和基本定义出发，并要求模化的涡粘性系数 $ \\nu_{t}(y)$ 在槽道的两个半区内始终为非负值，推导涡粘性系数分布 $ \\nu_{t}(y)$ 关于 $\\kappa$、$y$ 和平均剪切 $ \\partial U / \\partial y$ 的解析表达式。你的最终答案必须是单一的闭式表达式。",
            "solution": "该问题陈述被认为是有效的，因为它科学地基于经典湍流模型的原理，是适定的、客观的且自洽的。所有给定的假设在壁湍流研究中都是标准的。我们现在开始推导。\n\n目标是基于所给假设推导涡粘性系数 $\\nu_{t}$ 的解析表达式。推导过程首先为雷诺切应力 $-\\overline{u^{\\prime} v^{\\prime}}$ 建立两个不同的模型，然后将它们相等以求解 $\\nu_{t}$。\n\n首先，我们考虑 Prandtl 混合长度假设。该模型用一个特征长度尺度，即混合长度 $\\ell$，和当地平均速度梯度来表示雷诺切应力。其核心思想是，湍流动量输运类似于分子输运，但是由宏观的流体“团块”或涡，在混合前移动一段距离 $\\ell$ 来完成。流向速度脉动的大小 $|u^{\\prime}|$ 被假设与该距离上的平均速度变化成比例：\n$$\n|u^{\\prime}| \\propto \\ell \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n该模型进一步假设法向脉动 $v^{\\prime}$ 与 $u^{\\prime}$ 具有相同的数量级，并且与它相关。这导出了 Prandtl 关于雷诺切应力大小 $\\tau_{t} = -\\rho \\overline{u^{\\prime} v^{\\prime}}$ 的模型：\n$$\n\\tau_{t} = \\rho \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\n项 $\\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}$ 正确地确保了切应力与平均应变率方向相反，即 $\\tau_{t}$ 与 $\\frac{\\partial U}{\\partial y}$ 符号相同，这是湍流生成项作为平均动能耗散汇的物理要求。此表达式可以通过注意到 $\\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y} = \\left(\\frac{\\partial U}{\\partial y}\\right)^2 \\text{sgn}\\left(\\frac{\\partial U}{\\partial y}\\right)$ 来重写。为了我们的目的，使用运动雷诺切应力 $-\\overline{u^{\\prime} v^{\\prime}} = \\tau_{t} / \\rho$ 更为方便。将上述方程除以密度 $\\rho$ 得到：\n$$\n-\\overline{u^{\\prime} v^{\\prime}} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\n\n其次，我们引用 Boussinesq 涡粘性假设，这在问题陈述中已明确给出。该假设将雷诺切应力张量模化为与平均应变率张量成线性比例，这类似于层流的牛顿应力-应变关系。对于平面槽道流这一特定情况，其中唯一非零的平均速度梯度是 $\\frac{\\partial U}{\\partial y}$，该假设简化为切应力分量的标量关系：\n$$\n-\\overline{u^{\\prime} v^{\\prime}} = \\nu_{t} \\frac{\\partial U}{\\partial y}\n$$\n这里，$\\nu_{t}$ 是湍流粘性或涡粘性系数，与分子运动粘度 $\\nu$ 不同，它不是流体属性，而是流动状态的属性。\n\n现在，我们将雷诺切应力 $-\\overline{u^{\\prime} v^{\\prime}}$ 的两个表达式相等：\n$$\n\\nu_{t} \\frac{\\partial U}{\\partial y} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\n为了求解 $\\nu_{t}$，我们可以将两边同时除以 $\\frac{\\partial U}{\\partial y}$。此操作在流场中 $\\frac{\\partial U}{\\partial y} \\neq 0$ 的区域是有效的。在湍流槽道流中，除了速度剖面对称的槽道中心线处，平均剪切在任何地方都非零。在远离中心线处，我们得到：\n$$\n\\nu_{t} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n\n最后一步是代入问题陈述中给出的对数区混合长度 $\\ell$ 的具体形式。假设是混合长度与距最近壁面的距离 $y$ 呈线性关系：\n$$\n\\ell = \\kappa y\n$$\n其中 $\\kappa$ 是 von Kármán 常数。将此代入我们关于 $\\nu_{t}$ 的表达式，得到：\n$$\n\\nu_{t}(y) = (\\kappa y)^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n此表达式可以简化为：\n$$\n\\nu_{t}(y) = \\kappa^{2} y^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n这就是根据给定参数得到的涡粘性系数分布的解析表达式。问题规定 $\\nu_{t}(y)$ 必须为非负。我们可以验证这个条件。von Kármán 常数 $\\kappa$ 是一个正实数（约 0.41），所以 $\\kappa^{2} > 0$。壁面距离 $y$ 根据定义是非负的，所以 $y^{2} \\ge 0$。任何实数的绝对值都是非负的，所以 $\\left| \\frac{\\partial U}{\\partial y} \\right| \\ge 0$。因此，这些非负项的乘积保证为非负，满足了约束条件。这个表达式被称为零方程模型（因为它不包含湍流量的输运方程），是代数湍流模型中的一个基础性结果。",
            "answer": "$$\n\\boxed{\\nu_t(y) = \\kappa^{2} y^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|}\n$$"
        },
        {
            "introduction": "理论模型必须经过实践的检验和修正才能应用于实际工程问题。基础的代数涡粘性模型，如之前推导的模型或相关的大涡模拟（LES）中的斯玛戈林斯基（Smagorinsky）模型，在靠近壁面的区域会失效，而这在航空航天应用中是至关重要的区域。本编码练习将引导你通过编程来量化展示该模型的近壁缺陷，并亲手实现经典的范德里斯特（van Driest）阻尼修正，这是任何计算流体动力学（CFD）从业者都必须掌握的一项核心技能 ()。",
            "id": "3942982",
            "problem": "考虑在航空航天计算流体动力学 (CFD) 中使用的壁湍流大涡模拟 (LES)。从雷诺分解和滤波方程中亚格子应力的 Boussinesq 涡粘性假设出发，该假设断言亚格子应力张量的偏量部分与可解尺度应变率张量成正比。使用量纲分析和核心定义来构建和分析一个代数涡粘性模型，然后修改该模型以反映近壁区的物理特性。\n\n您必须从第一性原理出发，完成以下任务：\n\n1. 使用 Boussinesq 涡粘性假设（即亚格子尺度应力与可解尺度应变率成正比）和基本量纲分析，推导出一个依赖于速度梯度尺度和长度尺度的涡粘性代数形式。证明涡粘性与特征滤波长度的平方和可解尺度应变率的量值成正比。使用一个无量纲常数使该比例关系在量纲上保持一致。不要先验地假设任何特定的预因子；应通过量纲推理来推导它。\n\n2. 对于位于 $y=0$ 且满足无滑移边界条件的平面壁面，利用壁面摩擦速度 $u_{\\tau}$ 的定义以及近壁区湍流脉动的行为，论证为何涡粘性必须满足当 $y \\to 0$ 时 $\\nu_t \\to 0$。使用您推导的代数模型，解析地证明如果可解尺度应变率的量值 $|S|$ 在壁面处保持有限，则未阻尼的代数模型预测的 $\\nu_t$ 在 $y=0$ 处不为零，因此会过高预测近壁区的涡粘性。给出当 $y \\to 0$ 时的极限行为。\n\n3. 引入一个 van Driest 型阻尼函数 $f_d(y^+)$，它依赖于无量纲壁面距离 $y^+$，并强制满足 $f_d(0)=0$ 和当 $y^+ \\to \\infty$ 时 $f_d(y^+)\\to 1$。定义摩擦雷诺数坐标 $y^+$ 为 $y^+ = \\frac{y\\,u_{\\tau}}{\\nu}$，其中 $y$ 是壁面法向坐标（单位为 $\\mathrm{m}$），$u_{\\tau}$ 是摩擦速度（单位为 $\\mathrm{m/s}$），$\\nu$ 是运动粘度（单位为 $\\mathrm{m^2/s}$）。使用一个由阻尼常数 $A^+$ 和控制近壁陡峭度的整数指数 $n$ 表征的指数形式 van Driest 型函数。您的实现必须确保阻尼涡粘性在 $y \\to 0$ 时恢复为 $\\nu_t \\to 0$，并在远离壁面时 $\\nu_t$ 接近未阻尼值。\n\n4. 实现一个程序，对每个测试用例计算：\n   - 根据任务1的推导计算出的未阻尼代数涡粘性，\n   - 无量纲壁面距离 $y^+$，\n   - van Driest 型阻尼 $f_d(y^+)$，\n   - 通过将 $f_d(y^+)$ 作为由指数 $n$ 控制的乘法因子应用于未阻尼模型而得到的阻尼涡粘性。\n\n所有涡粘性必须以 $\\mathrm{m^2/s}$ 为单位返回，并四舍五入到 $6$ 位小数。\n\n使用的定义：\n- $y^+ = \\frac{y\\,u_{\\tau}}{\\nu}$，其中 $y$ 的单位为 $\\mathrm{m}$，$u_{\\tau}$ 的单位为 $\\mathrm{m/s}$，$\\nu$ 的单位为 $\\mathrm{m^2/s}$。\n- van Driest 型阻尼函数 $f_d(y^+)$ 是一个关于 $y^+$ 的指数函数，其参数为 $A^+$ 和 $n$，使得 $f_d(0)=0$ 且当 $y^+ \\to \\infty$ 时 $f_d(y^+)\\to 1$。\n\n用于计算的模型参数：\n- 模型常数 $C_s$ 是无量纲的。\n- 滤波宽度 $\\Delta$ 的单位是 $\\mathrm{m}$。\n- 可解尺度应变率量值 $|S|$ 的单位是 $\\mathrm{s^{-1}}$。\n- 摩擦速度 $u_{\\tau}$ 的单位是 $\\mathrm{m/s}$。\n- 壁面法向距离 $y$ 的单位是 $\\mathrm{m}$。\n- 运动粘度 $\\nu$ 的单位是 $\\mathrm{m^2/s}$。\n- van Driest 常数 $A^+$ 是无量纲的。\n- 阻尼指数 $n$ 是一个整数。\n\n测试套件：\n为以下参数集提供输出。对于每个案例，计算并返回序对 $[\\nu_{t,\\mathrm{undamped}},\\,\\nu_{t,\\mathrm{damped}}]$，单位为 $\\mathrm{m^2/s}$，每个值都四舍五入到 $6$ 位小数。\n\n- 案例 1 (典型的近壁湍流)：\n  - $C_s = 0.17$，$\\Delta = 0.01\\,\\mathrm{m}$， $|S| = 200\\,\\mathrm{s^{-1}}$，$u_{\\tau} = 0.5\\,\\mathrm{m/s}$，$y = 0.001\\,\\mathrm{m}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，$A^+ = 26$，$n = 2$。\n\n- 案例 2 (正好在壁面，展示无阻尼时的过高预测)：\n  - $C_s = 0.17$，$\\Delta = 0.01\\,\\mathrm{m}$， $|S| = 200\\,\\mathrm{s^{-1}}$，$u_{\\tau} = 0.5\\,\\mathrm{m/s}$，$y = 0\\,\\mathrm{m}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，$A^+ = 26$，$n = 2$。\n\n- 案例 3 (非常靠近壁面，具有小的 $y^+$)：\n  - $C_s = 0.17$，$\\Delta = 0.01\\,\\mathrm{m}$， $|S| = 200\\,\\mathrm{s^{-1}}$，$u_{\\tau} = 0.5\\,\\mathrm{m/s}$，$y = 5\\times 10^{-6}\\,\\mathrm{m}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，$A^+ = 26$，$n = 2$。\n\n- 案例 4 (远离壁面，$y^+$ 很大：阻尼应可忽略不计)：\n  - $C_s = 0.17$，$\\Delta = 0.01\\,\\mathrm{m}$， $|S| = 200\\,\\mathrm{s^{-1}}$，$u_{\\tau} = 0.5\\,\\mathrm{m/s}$，$y = 0.1\\,\\mathrm{m}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，$A^+ = 26$，$n = 2$。\n\n- 案例 5 (高应变率量值敏感性)：\n  - $C_s = 0.17$，$\\Delta = 0.01\\,\\mathrm{m}$， $|S| = 5000\\,\\mathrm{s^{-1}}$，$u_{\\tau} = 0.5\\,\\mathrm{m/s}$，$y = 0.001\\,\\mathrm{m}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，$A^+ = 26$，$n = 2$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素对应一个测试用例，本身是一个形式为 $[\\nu_{t,\\mathrm{undamped}},\\nu_{t,\\mathrm{damped}}]$ 的双元素列表。例如，格式为 $[[r_1^{(u)},r_1^{(d)}],[r_2^{(u)},r_2^{(d)}],\\dots]$，其中所有 $r$ 值均四舍五入到 $6$ 位小数，并以 $\\mathrm{m^2/s}$ 为单位表示。",
            "solution": "所提出的问题具有科学依据、自成体系且适定。它展示了从第一性原理出发为大涡模拟（LES）开发亚格子尺度湍流模型的标准（尽管是简化的）过程，与计算流体动力学中的既定实践相符。所有必要的参数和定义都已提供，任务按逻辑顺序排列，从而得出一个唯一且可验证的解。因此，该问题是有效的。我们着手进行解答。\n\n解答按照问题陈述中所描述的四个部分呈现。\n\n**1. 代数涡粘性模型的推导**\n\n适用于 LES 的 Boussinesq 涡粘性假设假定，亚格子尺度（SGS）应力张量的各向异性部分 $\\tau_{ij}^{\\text{dev}}$ 与可解尺度应变率张量 $\\bar{S}_{ij}$ 线性成正比。该关系表示为：\n$$\n\\tau_{ij}^{\\text{dev}} = \\tau_{ij} - \\frac{1}{3}\\tau_{kk}\\delta_{ij} = -2\\nu_t \\bar{S}_{ij}\n$$\n此处，$\\tau_{ij}$ 是 SGS 应力张量，$\\tau_{kk}$ 是其迹，$\\delta_{ij}$ 是 Kronecker delta，$\\bar{S}_{ij} = \\frac{1}{2}(\\frac{\\partial \\bar{u}_i}{\\partial x_j} + \\frac{\\partial \\bar{u}_j}{\\partial x_i})$ 是滤波（可解）速度场 $\\bar{u}_i$ 的应变率张量，而 $\\nu_t$ 是标量亚格子尺度涡粘性。\n\n为了构建 $\\nu_t$ 的模型，我们进行量纲分析。涡粘性代表了不可解的亚格子尺度对可解流动的运动学效应。其量纲为长度的平方除以时间，即 $[\\nu_t] = L^2 T^{-1}$。在 LES 中，亚格子尺度的物理特性是基于最小的可解尺度来建模的。从可解场中可以获得两个基本特征尺度：\n1. 一个特征长度尺度，即滤波宽度 $\\Delta$。其量纲为 $[\\Delta] = L$。\n2. 一个特征时间尺度，它源自可解尺度应变率张量的量值 $|S| = (2\\bar{S}_{ij}\\bar{S}_{ij})^{1/2}$。其量纲为 $[|S|] = T^{-1}$。\n\n我们寻求 $\\Delta$ 和 $|S|$ 的一种组合，使其得到 $\\nu_t$ 的量纲。让我们假设一个如下形式的关系：\n$$\n\\nu_t \\propto \\Delta^a |S|^b\n$$\n其中 $a$ 和 $b$ 是待定指数。匹配量纲：\n$$\nL^2 T^{-1} = [L]^a [T^{-1}]^b = L^a T^{-b}\n$$\n对每个量纲的指数进行等价，得到一个包含两个线性方程的方程组：\n对于长度（$L$）：$a = 2$\n对于时间（$T$）：$-b = -1 \\implies b = 1$\n\n因此，量纲分析决定了涡粘性必须具有以下形式：\n$$\n\\nu_t \\propto \\Delta^2 |S|\n$$\n为了将此比例关系转换为方程，我们引入一个无量纲的比例常数。根据 Smagorinsky 模型中的惯例，该常数表示为 Smagorinsky 常数 $C_s$ 的平方。因此，代数涡粘性模型为：\n$$\n\\nu_t = C_s^2 \\Delta^2 |S|\n$$\n这就是从量纲推理得出的 Smagorinsky 模型的基本形式。\n\n**2. 未阻尼模型的近壁行为**\n\n在诸如 $y=0$ 平面之类的固定的静止壁面附近，无滑移边界条件要求所有流体速度分量都消失为零，即 $\\bar{u}_i(y=0) = 0$。壁面的存在物理上会阻尼湍流脉动。因此，所有湍流速度脉动在 $y \\to 0$ 时都必须趋近于零。涡粘性 $\\nu_t$ 模拟了这些湍流脉动引起的动量输运。由于脉动本身在壁面处被抑制，相关的输运系数也必须消失。物理上，在壁面的紧邻区域（粘性底层），动量输运由分子粘度 $\\nu$ 主导，而非湍流涡粘性。因此，任何物理上正确的模型都必须满足以下条件：\n$$\n\\lim_{y \\to 0} \\nu_t = 0\n$$\n现在让我们检验我们推导的代数模型 $\\nu_t = C_s^2 \\Delta^2 |S|$ 在 $y \\to 0$ 时的行为。\n参数 $C_s$ 和 $\\Delta$ 对于给定的模拟通常是常数（其中 $\\Delta$ 与壁面附近的固定网格分辨率有关）。因此，$\\nu_t$ 的行为由可解尺度应变率量值 $|S|$ 的行为决定。对于壁面剪切流，主导的平均速度分量平行于壁面（例如 $\\bar{u}_1(y)$）。粘性底层中的速度剖面是线性的：$\\bar{u}_1(y) = \\frac{\\tau_w}{\\mu}y$，其中 $\\tau_w$ 是壁面剪切应力，$\\mu$ 是动力粘度。使用定义 $\\tau_w = \\rho u_\\tau^2$ 和 $\\nu = \\mu/\\rho$，上式变为 $\\bar{u}_1(y) = \\frac{u_\\tau^2}{\\nu}y$。\n此时，应变率张量的主导分量是 $\\bar{S}_{12} = \\frac{1}{2} \\frac{d\\bar{u}_1}{dy} = \\frac{1}{2} \\frac{u_\\tau^2}{\\nu}$。因此，壁面处的应变率张量量值是有限且非零的：\n$$\n|S|_{y=0} = \\sqrt{2 \\cdot (2\\bar{S}_{12}^2)} = \\sqrt{4 \\left(\\frac{1}{2}\\frac{u_\\tau^2}{\\nu}\\right)^2} = \\left| \\frac{d\\bar{u}_1}{dy} \\right|_{y=0} = \\frac{u_\\tau^2}{\\nu} \\neq 0\n$$\n由于 $|S|$ 在 $y = 0$ 处保持有限，未阻尼的代数模型预测在壁面处存在一个有限的、非零的涡粘性：\n$$\n\\lim_{y \\to 0} \\nu_t = C_s^2 \\Delta^2 |S|_{y=0} > 0\n$$\n这与所需的物理行为相矛盾。该模型未能预测 $\\nu_t \\to 0$，表明它过高预测了近壁区域的涡粘性，因此有必要进行修正。\n\n**3. van Driest 阻尼的引入**\n\n为了强制实现正确的近壁物理特性，我们引入一个阻尼函数 $f_d$，它与未阻尼的涡粘性相乘。阻尼后的模型为 $\\nu_{t, \\text{damped}} = f_d \\cdot \\nu_{t, \\text{undamped}}$。该函数必须依赖于与壁面的距离，通常以无量纲形式 $y^+ = \\frac{y u_\\tau}{\\nu}$ 表示。阻尼函数所需的特性是：\n- 它必须在壁面处强制实现零粘性条件：$f_d(y^+=0) = 0$。\n- 它不能改变远离壁面处的模型，因为在远离壁面处原始公式更为合适：$\\lim_{y^+ \\to \\infty} f_d(y^+) = 1$。\n\n问题指定了一个指数形式的 van Driest 型阻尼函数 $f_d(y^+)$，其特征是一个无量纲常数 $A^+$ 和一个整数指数 $n$。满足这些要求的函数是：\n$$\nf_d(y^+) = \\left(1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right)^n\n$$\n让我们验证它的性质。在壁面处（$y=0 \\implies y^+=0$）：\n$$\nf_d(0) = \\left(1 - \\exp(0)\\right)^n = (1 - 1)^n = 0\n$$\n远离壁面处（$y \\to \\infty \\implies y^+ \\to \\infty$）：\n$$\n\\lim_{y^+ \\to \\infty} f_d(y^+) = \\left(1 - \\lim_{y^+ \\to \\infty} \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right)^n = (1 - 0)^n = 1\n$$\n该函数满足边界条件。指数 $n$ 控制了函数在近壁区的陡峭度。对于小的 $y^+$，泰勒展开给出 $1 - \\exp(-y^+/A^+) \\approx y^+/A^+$，因此 $f_d(y^+) \\approx (y^+/A^+)^n$。这确保了 $\\nu_{t, \\text{damped}}$ 以 $y^n$ 的形式趋近于零，从而提供了正确的渐近行为。\n\n**4. 模型实现**\n\n要实现的完整模型包括针对每组参数的以下计算：\n1.  计算未阻尼的涡粘性：$\\nu_{t, \\text{undamped}} = C_s^2 \\Delta^2 |S|$。\n2.  计算无量纲壁面距离：$y^+ = \\frac{y u_\\tau}{\\nu}$。\n3.  计算 van Driest 型阻尼函数：$f_d(y^+) = \\left(1 - \\exp(-y^+/A^+)\\right)^n$。\n4.  计算阻尼涡粘性：$\\nu_{t, \\text{damped}} = \\nu_{t, \\text{undamped}} \\times f_d(y^+)$。\n\n这些公式将用于处理给定的测试套件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes undamped and damped eddy viscosity for several test cases\n    based on an algebraic subgrid-scale model with van Driest damping.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a dictionary for clarity of parameters.\n    test_cases = [\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 0.001, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 0.0, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 5e-6, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \n            \"y\": 0.1, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n        {\n            \"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 5000, \"u_tau\": 0.5, \n            \"y\": 0.001, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        Cs = case[\"Cs\"]\n        Delta = case[\"Delta\"]\n        S_mag = case[\"S_mag\"]\n        u_tau = case[\"u_tau\"]\n        y = case[\"y\"]\n        nu = case[\"nu\"]\n        A_plus = case[\"A_plus\"]\n        n = case[\"n\"]\n        \n        # Task 1: Compute the undamped algebraic eddy viscosity\n        # nu_t_undamped = (Cs * Delta)^2 * |S| -> Cs is squared, not (Cs*Delta)\n        nu_t_undamped = (Cs**2) * (Delta**2) * S_mag\n        \n        # Task 2  3: Compute the damping function f_d(y^+)\n        # First, compute the non-dimensional wall distance y_plus\n        if nu == 0:\n            # Handle division by zero, though not expected from problem data\n            y_plus = float('inf') if y > 0 else 0\n        else:\n            y_plus = (y * u_tau) / nu\n        \n        # Second, compute the van Driest damping function f_d(y^+)\n        # f_d = (1 - exp(-y+/A+))^n\n        # The exponentiation is safe due to the negative sign.\n        # np.exp handles large negative arguments by returning 0.0\n        damping_factor_base = 1 - np.exp(-y_plus / A_plus)\n        f_d = damping_factor_base**n\n\n        # Task 4: Compute the damped eddy viscosity\n        nu_t_damped = nu_t_undamped * f_d\n        \n        # Round the results to 6 decimal places as required\n        nu_t_undamped_rounded = round(nu_t_undamped, 6)\n        nu_t_damped_rounded = round(nu_t_damped, 6)\n        \n        results.append([nu_t_undamped_rounded, nu_t_damped_rounded])\n\n    # Final print statement in the exact required format.\n    # Convert list of lists to string representation.\n    result_str = \",\".join([f\"[{u},{d}]\" for u, d in results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后一个练习将探讨一个更高级的主题：物理模型与数值求解器之间的相互作用。一个物理上合理的模型，如果其产生的模型系数（如涡粘性 $\\mu_t$）在空间上发生剧烈变化，可能会破坏求解过程的数值稳定性。本练习将深入分析这一问题的根源，并探讨为保证模拟的稳健性和准确性，在现代CFD代码中采用的先进平滑滤波技术，从而让你对湍流模型在实际应用中的复杂性有更深刻的理解 ()。",
            "id": "3942970",
            "problem": "考虑一个由雷诺平均纳维-斯托克斯 (RANS) 动量方程在 Boussinesq 涡粘性假设下描述的、具有恒定密度 $\\rho$ 和恒定动力粘度 $\\mu$ 的平面槽道流。在一维壁面法向坐标 $y$ 中，平均流向速度 $u(y)$ 满足\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left[\\left(\\mu + \\mu_t(y)\\right)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right] = -\\frac{\\mathrm{d}p}{\\mathrm{d}x},\n$$\n其中 $\\mu_t(y)$ 是由代数封闭在局部确定的代数涡粘性，而 $-\\mathrm{d}p/\\mathrm{d}x$ 是一个恒定的流向压力梯度。在平衡湍流边界层的对数律层中，平均速度满足对数律 $u^+ = \\left(1/\\kappa\\right)\\ln y^+ + B$，其中 $u^+ = u/u_\\tau$, $y^+ = y u_\\tau/\\nu$, $u_\\tau = \\sqrt{\\tau_w/\\rho}$ 是摩擦速度，$\\nu = \\mu/\\rho$，$\\kappa$ 是 von Kármán 常数，$B$ 是一个常数，$\\tau_w$ 是壁面剪切应力。与对数律的一致性意味着，在平衡对数层中，$\\mu_t(y)$ 局部地与 $y$呈线性关系，即 $\\mu_t(y) \\propto \\rho \\kappa u_\\tau y$。\n\n请您从第一性原理出发，分析 $\\mu_t(y)$ 的突兀空间变化对离散动量平衡的影响，并确定一种针对 $\\mu_t$ 的平滑策略，该策略既能保持可实现性（在线性涡粘性模型下，$\\mu_t$ 的非负性以及其隐含的雷诺应力的有界性），又不会干扰局部对数律的一致性。在您的推理中使用以下基本依据：\n- 微分乘法法则，它意味着对于一个足够光滑的系数 $a(y)$，有 $\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left[a(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right] = a(y)\\frac{\\mathrm{d}^2 u}{\\mathrm{d}y^2} + a'(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}$。\n- 在均匀网格上对一维变系数扩散算子进行有限体积离散化的结构，它在离散通量 $F_{i\\pm 1/2} = a_{i\\pm 1/2}\\left(u_{i\\pm 1} - u_i\\right)/\\Delta y$ 中使用面心系数 $a_{i\\pm 1/2}$，其中 $a(y) = \\mu + \\mu_t(y)$，$\\Delta y$ 是网格间距。\n\n哪个选项正确解释了 $\\mu_t(y)$ 的突兀空间变化在计算得到的 $u(y)$ 中引入数值振荡的机制，并提出了一种能够保持可实现性和局部对数律一致性的 $\\mu_t$ 平滑滤波器？\n\nA. $\\mu_t$ 的突变会产生大的系数 $a'(y)$，在变系数扩散算子中，它如同一个表观对流项 $a'(y)\\,\\mathrm{d}u/\\mathrm{d}y$。当这个表观对流在局部占主导地位并用中心差分进行离散时，可能会出现色散振荡，特别是在相邻面上 $a_{i+1/2}/a_{i-1/2}$ 高度倾斜的情况下。一种保持可实现性并与对数律一致的平滑方法由亥姆霍兹型滤波器给出\n$$\n\\left(I - \\ell^2 \\nabla^2\\right)\\mu_t^{\\,f} = \\mu_t,\n$$\n其局部长度尺度为 $\\ell = C_\\ell \\min\\!\\left(\\kappa y,\\, C_\\Delta \\Delta\\right)$，在固壁处采用齐次诺伊曼边界条件，并进行正性投影 $\\mu_t^{\\,f} \\leftarrow \\max\\!\\left(0,\\, \\mu_t^{\\,f}\\right)$。该滤波器不改变任何局部线性的 $\\mu_t(y)$（因此保留了对数律标度关系 $\\mu_t \\propto y$）并强制 $\\mu_t^{\\,f} \\geq 0$。\n\nB. 振荡的产生是因为 $\\mu_t$ 的突变使对流项 $\\rho u\\,\\mathrm{d}u/\\mathrm{d}x$ 不稳定，导致问题变为双曲型，需要对 $\\mu_t$ 采用迎风格式。一个合适的修正是使用马赫数相关的限制器对 $\\mu_t$ 进行迎风处理，并在一个5点模板上对 $\\mu_t$ 应用简单的算术平均。这种方法通过构造保持了可实现性，并且由于平均是局部的，所以维持了对数律。\n\nC. 根本原因是当 $\\mu_t$ 快速变化时伽利略不变性的丧失，这会注入伪动能。一个具有固定窗口大小 $L$ 的全局移动平均滤波器 $\\mu_t^{\\,f}(y) = \\left(1/L\\right)\\int_{y-L/2}^{y+L/2} \\mu_t(\\eta)\\,\\mathrm{d}\\eta$ 可以恢复不变性并自动确保 $\\mu_t$ 非负，同时其全局性可以再现正确的对数律标度关系。\n\nD. $\\mu_t$ 的突变在椭圆算子中产生刚性，但这不会引起振荡，只会减慢收敛速度。最好的补救措施是使用常数 $\\alpha$ 和在固壁处施加狄利克雷边界条件 $\\mu_t^{\\,f} = 0$ 的拉普拉斯平滑 $\\mu_t^{\\,f} = \\mu_t + \\alpha \\nabla^2 \\mu_t$。这通过边界强制来保证 $\\mu_t^{\\,f} \\geq 0$，并且因为 $\\alpha$ 是常数，所以不会影响近壁处的对数律标度关系。",
            "solution": "该问题在科学上是合理的、自洽的并且是适定的。它探讨了计算流体动力学中的一个重要高级主题：湍流模型系数的数值处理。\n\n**问题机理分析**\n\n问题的核心在于变系数扩散方程 $\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left[a(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right] = \\text{const}$ 的数值特性，其中 $a(y) = \\mu + \\mu_t(y)$ 是总有效粘度。\n1.  **振荡的根源**：根据微分乘法法则，该方程可展开为 $a(y)\\frac{\\mathrm{d}^2 u}{\\mathrm{d}y^2} + a'(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y} = \\text{const}$。当涡粘性 $\\mu_t(y)$ 发生剧烈空间变化时（例如，从湍流区到层流区，或由于网格突变），其导数 $a'(y) = \\frac{\\mathrm{d}\\mu_t}{\\mathrm{d}y}$ 会变得很大。这使得 $a'(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}$ 这一项变得显著。这个一阶导数项在数学上类似于一个对流项，其“对流速度”为 $a'(y)$。在数值离散化中，特别是当使用中心差分格式时，如果网格单元的佩克莱数（Péclet number）——一个衡量对流与扩散相对强度的无量纲数，在此处可类比为 $\\text{Pe} = \\frac{|a'|\\Delta y}{a}$ ——大于2，就会导致非物理的数值振荡。因此，$\\mu_t$ 的突变确实会通过引入一个强的“表观对流项”来引发数值振荡。\n\n**各选项分析**\n\n*   **选项 A**：\n    *   **诊断**：该选项准确地指出了问题的根源：$\\mu_t$ 的突变产生了大的 $a'(y)$，形成了一个表观对流项，当使用中心差分格式离散时，这会导致数值振荡。这个诊断是正确的。\n    *   **解决方案**：它提出使用亥姆霍兹（Helmholtz）型滤波器 $\\left(I - \\ell^2 \\nabla^2\\right)\\mu_t^{\\,f} = \\mu_t$ 进行平滑。这是一个低通滤波器，能有效滤除高频（剧烈变化）成分，使 $\\mu_t$ 场变得平滑。\n    *   **保持对数律**：亥姆霍兹算子有一个关键性质，即它能精确保持线性函数。由于在对数律区域，$\\mu_t \\propto y$ 是线性的，所以 $\\nabla^2(\\mu_t) = 0$。代入滤波器方程得到 $\\mu_t^{\\,f} = \\mu_t$。这意味着滤波器不会干扰对数律区域的物理一致性。\n    *   **可实现性**：滤波器本身不保证输出非负。因此，该选项合理地补充了一个正性投影步骤 $\\mu_t^{\\,f} \\leftarrow \\max(0, \\mu_t^{\\,f})$，这确保了模型的可实现性（$\\mu_t \\geq 0$）。\n    *   **自适应长度尺度**和**边界条件**：采用与壁面距离和网格尺寸相关的自适应长度尺度 $\\ell$ 以及齐次诺伊曼边界条件，都是先进且合理的数值实践。\n    *   **结论**：该选项的诊断和解决方案均正确且完整。\n\n*   **选项 B**：\n    *   **诊断**：将振荡归咎于物理对流项 $\\rho u\\,\\mathrm{d}u/\\mathrm{d}x$ 是错误的，因为在所给的一维方程中该项为零。\n    *   **解决方案**：对模型系数 $\\mu_t$ 采用“迎风格式”在概念上是无意义的。迎风格式适用于被输运的物理量，而不是方程的系数。因此，该选项不正确。\n\n*   **选项 C**：\n    *   **诊断**：将问题归因于“伽利略不变性的丧失”是错误的。伽利略不变性与坐标系变换有关，与此处的数值稳定性问题无关。\n    *   **解决方案**：一个具有固定窗口大小的全局移动平均滤波器是一种过于简单的平滑方法。它不是自适应的，可能会在近壁区域或网格变化区域引入不希望的平滑效应，破坏局部物理特性。虽然它能保持非负性（如果输入非负），但其性能远不如亥姆霍兹滤波器。因此，该选项不正确。\n\n*   **选项 D**：\n    *   **诊断**：该选项错误地否认了振荡的存在，声称$\\mu_t$的突变只会导致刚性并减慢收敛。虽然刚性确实会影响收敛，但振荡是一个独立的、与精度和稳定性相关的问题。\n    *   **解决方案**：提出的“拉普拉斯平滑” $\\mu_t^{\\,f} = \\mu_t + \\alpha \\nabla^2 \\mu_t$ (其中 $\\alpha > 0$) 实际上是一个锐化滤波器（反扩散），它会增强而非减弱梯度的剧烈变化，使问题恶化。狄利克雷边界条件 $\\mu_t^{\\,f} = 0$ 过于严苛，通常不适用于整个边界。因此，该选项不正确。\n\n综上所述，选项A提供了最准确的物理解释和最合适的数值处理策略。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}