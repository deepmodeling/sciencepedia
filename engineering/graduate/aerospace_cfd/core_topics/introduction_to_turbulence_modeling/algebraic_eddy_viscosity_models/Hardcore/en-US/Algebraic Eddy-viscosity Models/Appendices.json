{
    "hands_on_practices": [
        {
            "introduction": "Understanding algebraic eddy-viscosity models begins with their historical and conceptual roots. This first practice connects Prandtl's intuitive mixing-length theory, a cornerstone of early turbulence modeling, directly to the mathematical form of the eddy viscosity, $\\nu_t$. By working through this fundamental derivation , you will gain a concrete understanding of how a physical hypothesis about turbulent eddies translates into a practical, algebraic expression for the Reynolds stresses.",
            "id": "3943005",
            "problem": "Consider a statistically steady, fully developed, incompressible plane turbulent channel flow between two parallel plates, where the mean velocity is $U(y)$ in the streamwise direction and depends only on the wall-normal coordinate $y$. Let the fluid density be $\\rho$ and the kinematic viscosity be $\\nu$. Assume the Reynolds-averaged Navier–Stokes (RANS) framework and adopt the Boussinesq eddy-viscosity hypothesis, wherein the turbulent Reynolds shear stress $-\\overline{u^{\\prime} v^{\\prime}}$ is modeled as $-\\overline{u^{\\prime} v^{\\prime}} = \\nu_{t} \\, \\partial U / \\partial y$, with $\\nu_{t}$ the eddy viscosity. Further, adopt Prandtl’s mixing-length hypothesis for momentum transport, and assume that in the logarithmic region the mixing length scales linearly with the wall distance as $\\ell = \\kappa \\, y$, where $\\kappa$ is the von Kármán constant and $y$ is the distance from the nearest wall.\n\nStarting only from these modeling assumptions and fundamental definitions, and requiring that the modeled eddy viscosity $ \\nu_{t}(y)$ be nonnegative throughout both halves of the channel, derive the analytical expression for the eddy viscosity profile $ \\nu_{t}(y)$ in terms of $\\kappa$, $y$, and the mean shear $ \\partial U / \\partial y$. Your final answer must be a single closed-form expression.",
            "solution": "The problem statement is deemed valid as it is scientifically grounded in the principles of classical turbulence modeling, is well-posed, objective, and self-contained. All provided assumptions are standard in the study of wall-bounded turbulent flows. We will now proceed with the derivation.\n\nThe objective is to derive an analytical expression for the eddy viscosity, $\\nu_{t}$, based on the provided hypotheses. The derivation begins by establishing two distinct models for the Reynolds shear stress, $-\\overline{u^{\\prime} v^{\\prime}}$, and then equating them to solve for $\\nu_{t}$.\n\nFirst, we consider Prandtl’s mixing-length hypothesis. This model provides an expression for the Reynolds shear stress in terms of a characteristic length scale, the mixing length $\\ell$, and the local mean velocity gradient. The core idea is that turbulent momentum transport is analogous to molecular transport, but with macroscopic \"lumps\" of fluid, or eddies, moving over a distance $\\ell$ before mixing. The magnitude of the streamwise velocity fluctuation, $|u^{\\prime}|$, is assumed to scale with the change in mean velocity over this distance:\n$$\n|u^{\\prime}| \\propto \\ell \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\nThe model further posits that the wall-normal fluctuation, $v^{\\prime}$, is of the same order of magnitude as $u^{\\prime}$ and is correlated with it. This leads to Prandtl's model for the magnitude of the Reynolds shear stress, $\\tau_{t} = -\\rho \\overline{u^{\\prime} v^{\\prime}}$:\n$$\n\\tau_{t} = \\rho \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\nThe term $\\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}$ correctly ensures that the shear stress opposes the mean strain rate, meaning $\\tau_{t}$ has the same sign as $\\frac{\\partial U}{\\partial y}$, which is a physical requirement for turbulence production to be a sink of mean kinetic energy. This expression can be rewritten by noting that $\\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y} = \\left(\\frac{\\partial U}{\\partial y}\\right)^2 \\text{sgn}\\left(\\frac{\\partial U}{\\partial y}\\right)$. For our purposes, it is more convenient to use the kinematic Reynolds shear stress, $-\\overline{u^{\\prime} v^{\\prime}} = \\tau_{t} / \\rho$. Dividing the above equation by the density $\\rho$ gives:\n$$\n-\\overline{u^{\\prime} v^{\\prime}} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\n\nSecond, we invoke the Boussinesq eddy-viscosity hypothesis, which is explicitly provided in the problem statement. This hypothesis models the Reynolds shear stress tensor as being linearly proportional to the mean strain rate tensor, analogous to the Newtonian stress-strain relationship for laminar flow. For the specific case of a plane channel flow where the only non-zero mean velocity gradient is $\\frac{\\partial U}{\\partial y}$, the hypothesis simplifies to a scalar relationship for the shear component:\n$$\n-\\overline{u^{\\prime} v^{\\prime}} = \\nu_{t} \\frac{\\partial U}{\\partial y}\n$$\nHere, $\\nu_{t}$ is the turbulent or eddy viscosity, which, unlike the molecular kinematic viscosity $\\nu$, is not a fluid property but a property of the flow state.\n\nNow, we equate the two expressions for the Reynolds shear stress $-\\overline{u^{\\prime} v^{\\prime}}$:\n$$\n\\nu_{t} \\frac{\\partial U}{\\partial y} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y}\n$$\nTo solve for $\\nu_{t}$, we can divide both sides by $\\frac{\\partial U}{\\partial y}$. This operation is valid for regions of the flow where $\\frac{\\partial U}{\\partial y} \\neq 0$. In a turbulent channel flow, the mean shear is non-zero everywhere except at the channel centerline, where the velocity profile is symmetric. Away from the centerline, we obtain:\n$$\n\\nu_{t} = \\ell^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n\nThe final step is to substitute the specific form of the mixing length, $\\ell$, as given in the problem statement for the logarithmic region of the flow. The assumption is that the mixing length scales linearly with the distance from the nearest wall, $y$:\n$$\n\\ell = \\kappa y\n$$\nwhere $\\kappa$ is the von Kármán constant. Substituting this into our expression for $\\nu_{t}$ yields:\n$$\n\\nu_{t}(y) = (\\kappa y)^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\nThis expression can be simplified to:\n$$\n\\nu_{t}(y) = \\kappa^{2} y^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\nThis is the analytical expression for the eddy viscosity profile in terms of the given parameters. The problem stipulates that $\\nu_{t}(y)$ must be nonnegative. We can verify this condition. The von Kármán constant $\\kappa$ is a positive real number (approximately $0.41$), so $\\kappa^{2} > 0$. The wall distance $y$ is, by definition, nonnegative, so $y^{2} \\ge 0$. The absolute value of any real number is nonnegative, so $\\left| \\frac{\\partial U}{\\partial y} \\right| \\ge 0$. The product of these nonnegative terms is therefore guaranteed to be nonnegative, satisfying the constraint. This expression, known as a zero-equation model (as it contains no transport equations for turbulence quantities), is a foundational result in algebraic turbulence modeling.",
            "answer": "$$\n\\boxed{\\nu_t(y) = \\kappa^{2} y^{2} \\left| \\frac{\\partial U}{\\partial y} \\right|}\n$$"
        },
        {
            "introduction": "While foundational theories provide the basis for eddy viscosity, their direct application in simulations reveals important limitations, particularly near solid boundaries. This exercise  transitions from theory to practice, asking you to implement the classic Smagorinsky model and observe its failure to respect the no-slip condition at a wall. You will then implement the essential van Driest damping function, a widely used correction that ensures the model behaves physically correctly in the near-wall region.",
            "id": "3942982",
            "problem": "Consider Large-Eddy Simulation (LES) of wall-bounded turbulent flow as used in aerospace Computational Fluid Dynamics (CFD). Begin from the Reynolds decomposition and the Boussinesq eddy-viscosity hypothesis for the subgrid stress in filtered equations, which asserts that the deviatoric part of the subgrid stress tensor is proportional to the resolved strain-rate tensor. Use dimensional analysis and core definitions to construct and analyze an algebraic eddy-viscosity model and then modify it to respect near-wall physics.\n\nYou must carry out the following tasks, derived from first principles:\n\n1. Using the Boussinesq eddy-viscosity hypothesis, which states that the subgrid-scale stress is proportional to the resolved strain-rate, and basic dimensional analysis, derive an algebraic form for the eddy viscosity that depends on a velocity gradient scale and a length scale. Show that the eddy viscosity is proportional to the square of a characteristic filter length and the magnitude of a resolved strain-rate. Use a dimensionless constant to make the proportionality dimensionally consistent. Do not assume any particular prefactor a priori; deduce it from dimensional reasoning.\n\n2. For a plane wall at $y=0$ with the no-slip boundary condition, argue using the definition of wall friction velocity $u_{\\tau}$ and the behavior of turbulent fluctuations near the wall, why the eddy viscosity must satisfy $\\nu_t \\to 0$ as $y \\to 0$. Using your derived algebraic model, demonstrate analytically that if the resolved strain-rate magnitude $|S|$ remains finite at the wall, then the undamped algebraic model predicts $\\nu_t$ that does not vanish at $y=0$, hence overpredicts near-wall eddy viscosity. Provide the limiting behavior as $y \\to 0$.\n\n3. Introduce a van Driest-type damping function $f_d(y^+)$ that depends on the non-dimensional wall distance $y^+$ and enforces $f_d(0)=0$ and $f_d(y^+)\\to 1$ as $y^+ \\to \\infty$. Define the friction Reynolds coordinate $y^+$ by $y^+ = \\dfrac{y\\,u_{\\tau}}{\\nu}$, where $y$ is the wall-normal coordinate in $\\mathrm{m}$, $u_{\\tau}$ is the friction velocity in $\\mathrm{m/s}$, and $\\nu$ is the kinematic viscosity in $\\mathrm{m^2/s}$. Use an exponential van Driest-type form characterized by a damping constant $A^+$ and an integer exponent $n$ that controls the near-wall steepness. Your implementation must ensure that the damped eddy viscosity recovers $\\nu_t \\to 0$ as $y \\to 0$ and $\\nu_t$ approaches the undamped value far from the wall.\n\n4. Implement a program that, for each test case, computes:\n   - the undamped algebraic eddy viscosity from your derivation in Task $1$,\n   - the non-dimensional wall distance $y^+$,\n   - the van Driest-type damping $f_d(y^+)$,\n   - the damped eddy viscosity given by applying $f_d(y^+)$ to the undamped model as a multiplicative factor controlled by the exponent $n$.\n\nAll eddy viscosities must be returned in $\\mathrm{m^2/s}$ and rounded to $6$ decimal places.\n\nDefinitions to use:\n- $y^+ = \\dfrac{y\\,u_{\\tau}}{\\nu}$ with $y$ in $\\mathrm{m}$, $u_{\\tau}$ in $\\mathrm{m/s}$, and $\\nu$ in $\\mathrm{m^2/s}$.\n- A van Driest-type damping function $f_d(y^+)$ is an exponential function of $y^+$ with parameters $A^+$ and $n$ such that $f_d(0)=0$ and $f_d(y^+)\\to 1$ as $y^+ \\to \\infty$.\n\nModel parameters for computation:\n- The model constant $C_s$ is dimensionless.\n- The filter width $\\Delta$ is in $\\mathrm{m}$.\n- The resolved strain-rate magnitude $|S|$ is in $\\mathrm{s^{-1}}$.\n- The friction velocity $u_{\\tau}$ is in $\\mathrm{m/s}$.\n- The wall-normal distance $y$ is in $\\mathrm{m}$.\n- The kinematic viscosity $\\nu$ is in $\\mathrm{m^2/s}$.\n- The van Driest constant $A^+$ is dimensionless.\n- The damping exponent $n$ is an integer.\n\nTest suite:\nProvide outputs for the following parameter sets. For each case, compute and return the pair $[\\nu_{t,\\mathrm{undamped}},\\,\\nu_{t,\\mathrm{damped}}]$ in $\\mathrm{m^2/s}$, each rounded to $6$ decimal places.\n\n- Case $1$ (typical near-wall turbulent flow):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0.001\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- Case $2$ (exact wall, demonstrating overprediction without damping):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- Case $3$ (very near wall with small $y^+$):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 5\\times 10^{-6}\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- Case $4$ (far from wall, $y^+$ large: damping should be negligible):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 200\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0.1\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\n- Case $5$ (high strain-rate magnitude sensitivity):\n  - $C_s = 0.17$, $\\Delta = 0.01\\,\\mathrm{m}$, $|S| = 5000\\,\\mathrm{s^{-1}}$, $u_{\\tau} = 0.5\\,\\mathrm{m/s}$, $y = 0.001\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $A^+ = 26$, $n = 2$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case and is itself a two-element list of the form $[\\nu_{t,\\mathrm{undamped}},\\nu_{t,\\mathrm{damped}}]$. For example, the format is $[[r_1^{(u)},r_1^{(d)}],[r_2^{(u)},r_2^{(d)}],\\dots]$ with all $r$ rounded to $6$ decimal places and expressed in $\\mathrm{m^2/s}$.",
            "solution": "The posed problem is scientifically grounded, self-contained, and well-posed. It presents a standard, albeit simplified, progression in the development of a subgrid-scale turbulence model for Large-Eddy Simulation (LES) from first principles, consistent with established practices in computational fluid dynamics. All necessary parameters and definitions are provided, and the tasks are logically sequential, leading to a unique and verifiable solution. Therefore, the problem is valid. We proceed with the solution.\n\nThe solution is presented in four parts as delineated by the problem statement.\n\n**1. Derivation of the Algebraic Eddy-Viscosity Model**\n\nThe Boussinesq eddy-viscosity hypothesis, adapted for LES, posits that the anisotropic part of the subgrid-scale (SGS) stress tensor, $\\tau_{ij}^{\\text{dev}}$, is linearly proportional to the resolved-scale strain-rate tensor, $\\bar{S}_{ij}$. This relationship is expressed as:\n$$\n\\tau_{ij}^{\\text{dev}} = \\tau_{ij} - \\frac{1}{3}\\tau_{kk}\\delta_{ij} = -2\\nu_t \\bar{S}_{ij}\n$$\nHere, $\\tau_{ij}$ is the SGS stress tensor, $\\tau_{kk}$ is its trace, $\\delta_{ij}$ is the Kronecker delta, $\\bar{S}_{ij} = \\frac{1}{2}(\\frac{\\partial \\bar{u}_i}{\\partial x_j} + \\frac{\\partial \\bar{u}_j}{\\partial x_i})$ is the strain-rate tensor of the filtered (resolved) velocity field $\\bar{u}_i$, and $\\nu_t$ is the scalar subgrid-scale eddy viscosity.\n\nTo construct a model for $\\nu_t$, we perform a dimensional analysis. The eddy viscosity represents the kinematic effect of the unresolved, subgrid scales on the resolved flow. Its dimensions are length squared per unit time, $[\\nu_t] = L^2 T^{-1}$. In LES, the physics of the subgrid scales are modeled based on the smallest resolved scales. The two fundamental characteristic scales available from the resolved field are:\n1. A characteristic length scale, which is the filter width, $\\Delta$. Its dimension is $[\\Delta] = L$.\n2. A characteristic time scale, which is derived from the magnitude of the resolved strain-rate tensor, $|S| = (2\\bar{S}_{ij}\\bar{S}_{ij})^{1/2}$. Its dimension is $[|S|] = T^{-1}$.\n\nWe seek a combination of $\\Delta$ and $|S|$ that yields the dimensions of $\\nu_t$. Let us postulate a relationship of the form:\n$$\n\\nu_t \\propto \\Delta^a |S|^b\n$$\nwhere $a$ and $b$ are exponents to be determined. Matching the dimensions:\n$$\nL^2 T^{-1} = [L]^a [T^{-1}]^b = L^a T^{-b}\n$$\nEquating the exponents for each dimension yields a system of two linear equations:\nFor length ($L$): $a = 2$\nFor time ($T$): $-b = -1 \\implies b = 1$\n\nThus, dimensional analysis dictates that the eddy viscosity must be of the form:\n$$\n\\nu_t \\propto \\Delta^2 |S|\n$$\nTo convert this proportionality into an equation, we introduce a dimensionless constant of proportionality. By convention in the Smagorinsky model, this constant is denoted as the square of the Smagorinsky constant, $C_s$. Therefore, the algebraic eddy-viscosity model is:\n$$\n\\nu_t = C_s^2 \\Delta^2 |S|\n$$\nThis is the fundamental form of the Smagorinsky model, derived from dimensional reasoning.\n\n**2. Near-Wall Behavior of the Undamped Model**\n\nNear a solid, stationary wall, such as the plane at $y=0$, the no-slip boundary condition requires that all fluid velocity components vanish, i.e., $\\bar{u}_i(y=0) = 0$. The presence of the wall physically damps turbulent fluctuations. As a result, all turbulent velocity fluctuations must approach zero as $y \\to 0$. The eddy viscosity, $\\nu_t$, models the momentum transport by these turbulent fluctuations. Since the fluctuations themselves are quenched at the wall, the associated transport coefficient must also vanish. Physically, in the immediate vicinity of the wall (the viscous sublayer), momentum transport is dominated by molecular viscosity, $\\nu$, not turbulent eddy viscosity. Consequently, any physically correct model must satisfy the condition:\n$$\n\\lim_{y \\to 0} \\nu_t = 0\n$$\nLet us now examine the behavior of our derived algebraic model, $\\nu_t = C_s^2 \\Delta^2 |S|$, as $y \\to 0$.\nThe parameters $C_s$ and $\\Delta$ are typically constants for a given simulation (with $\\Delta$ being related to the fixed grid resolution near the wall). The behavior of $\\nu_t$ is therefore determined by the behavior of the resolved strain-rate magnitude, $|S|$. For a wall-bounded shear flow, the dominant mean velocity component is parallel to the wall (e.g., $\\bar{u}_1(y)$). The velocity profile in the viscous sublayer is linear: $\\bar{u}_1(y) = \\frac{\\tau_w}{\\mu}y$, where $\\tau_w$ is the wall shear stress and $\\mu$ is the dynamic viscosity. Using the definitions $\\tau_w = \\rho u_\\tau^2$ and $\\nu = \\mu/\\rho$, this becomes $\\bar{u}_1(y) = \\frac{u_\\tau^2}{\\nu}y$.\nThe dominant component of the strain-rate tensor is then $\\bar{S}_{12} = \\frac{1}{2} \\frac{d\\bar{u}_1}{dy} = \\frac{1}{2} \\frac{u_\\tau^2}{\\nu}$. The magnitude of the strain-rate tensor at the wall is therefore finite and non-zero:\n$$\n|S|_{y=0} = \\sqrt{2 \\left( 2 \\bar{S}_{12}^2 \\right)} = 2|\\bar{S}_{12}| = \\left| \\frac{d\\bar{u}_1}{dy} \\right|_{y=0} = \\frac{u_\\tau^2}{\\nu} \\neq 0\n$$\nSince $|S|$ remains finite at $y = 0$, the undamped algebraic model predicts a finite, non-zero eddy viscosity at the wall:\n$$\n\\lim_{y \\to 0} \\nu_t = C_s^2 \\Delta^2 |S|_{y=0} > 0\n$$\nThis contradicts the required physical behavior. The model's failure to predict $\\nu_t \\to 0$ demonstrates its overprediction of eddy viscosity in the near-wall region, necessitating a correction.\n\n**3. Introduction of van Driest Damping**\n\nTo enforce the correct near-wall physics, we introduce a damping function, $f_d$, that multiplies the undamped eddy viscosity. The damped model is $\\nu_{t, \\text{damped}} = f_d \\cdot \\nu_{t, \\text{undamped}}$. This function must depend on the distance from the wall, typically expressed in non-dimensional form as $y^+ = \\frac{y u_\\tau}{\\nu}$. The required properties of the damping function are:\n- It must enforce the zero-viscosity condition at the wall: $f_d(y^+=0) = 0$.\n- It must not alter the model far from the wall, where the original formulation is more appropriate: $\\lim_{y^+ \\to \\infty} f_d(y^+) = 1$.\n\nThe problem specifies an exponential van Driest-type damping function, $f_d(y^+)$, characterized by a dimensionless constant $A^+$ and an integer exponent $n$. A function that satisfies these requirements is:\n$$\nf_d(y^+) = \\left(1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right)^n\n$$\nLet us verify its properties. At the wall ($y=0 \\implies y^+=0$):\n$$\nf_d(0) = \\left(1 - \\exp(0)\\right)^n = (1 - 1)^n = 0\n$$\nFar from the wall ($y \\to \\infty \\implies y^+ \\to \\infty$):\n$$\n\\lim_{y^+ \\to \\infty} f_d(y^+) = \\left(1 - \\lim_{y^+ \\to \\infty} \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right)^n = (1 - 0)^n = 1\n$$\nThe function fulfills the boundary conditions. The exponent $n$ controls the steepness of the function near the wall. For small $y^+$, a Taylor expansion gives $1 - \\exp(-y^+/A^+) \\approx y^+/A^+$, so $f_d(y^+) \\approx (y^+/A^+)^n$. This ensures that $\\nu_{t, \\text{damped}}$ approaches zero as $y^n$, providing the correct asymptotic behavior.\n\n**4. Model Implementation**\n\nThe complete model to be implemented consists of the following calculations for each set of parameters:\n1.  Compute the undamped eddy viscosity: $\\nu_{t, \\text{undamped}} = C_s^2 \\Delta^2 |S|$.\n2.  Compute the non-dimensional wall distance: $y^+ = \\dfrac{y u_\\tau}{\\nu}$.\n3.  Compute the van Driest-type damping function: $f_d(y^+) = \\left(1 - \\exp(-y^+/A^+)\\right)^n$.\n4.  Compute the damped eddy viscosity: $\\nu_{t, \\text{damped}} = \\nu_{t, \\text{undamped}} \\times f_d(y^+)$.\n\nThese formulas will be used to process the given test suite.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes undamped and damped eddy viscosity for several test cases\n    based on an algebraic subgrid-scale model with van Driest damping.\n    \"\"\"\n    \n    test_cases = [\n        {\"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \"y\": 0.001, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2},\n        {\"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \"y\": 0.0, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2},\n        {\"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \"y\": 5e-6, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2},\n        {\"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 200, \"u_tau\": 0.5, \"y\": 0.1, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2},\n        {\"Cs\": 0.17, \"Delta\": 0.01, \"S_mag\": 5000, \"u_tau\": 0.5, \"y\": 0.001, \"nu\": 1.5e-5, \"A_plus\": 26, \"n\": 2},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Cs = case[\"Cs\"]\n        Delta = case[\"Delta\"]\n        S_mag = case[\"S_mag\"]\n        u_tau = case[\"u_tau\"]\n        y = case[\"y\"]\n        nu = case[\"nu\"]\n        A_plus = case[\"A_plus\"]\n        n = case[\"n\"]\n        \n        nu_t_undamped = (Cs**2) * (Delta**2) * S_mag\n        \n        if nu == 0:\n            y_plus = float('inf') if y > 0 else 0\n        else:\n            y_plus = (y * u_tau) / nu\n        \n        damping_factor_base = 1 - np.exp(-y_plus / A_plus)\n        f_d = damping_factor_base**n\n\n        nu_t_damped = nu_t_undamped * f_d\n        \n        nu_t_undamped_rounded = round(nu_t_undamped, 6)\n        nu_t_damped_rounded = round(nu_t_damped, 6)\n        \n        results.append([nu_t_undamped_rounded, nu_t_damped_rounded])\n\n    result_str = \",\".join([f\"[{u},{d}]\" for u, d in results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A robust turbulence model must not only be physically sound but also numerically well-behaved when discretized within a CFD solver. Abrupt spatial variations in the eddy viscosity, which can arise from algebraic models, can introduce non-physical oscillations and compromise the solution's accuracy. This final practice  challenges you to analyze this numerical artifact and explore a sophisticated filtering technique that smooths the eddy-viscosity field while preserving its physical integrity.",
            "id": "3942970",
            "problem": "Consider a plane channel flow with constant density $\\rho$ and constant dynamic viscosity $\\mu$ described by the Reynolds-Averaged Navier–Stokes (RANS) momentum equation under the Boussinesq eddy-viscosity assumption. In one-dimensional wall-normal coordinate $y$, the mean streamwise velocity $u(y)$ satisfies\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left[\\left(\\mu + \\mu_t(y)\\right)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right] = -\\frac{\\mathrm{d}p}{\\mathrm{d}x},\n$$\nwhere $\\mu_t(y)$ is the algebraic eddy viscosity determined locally by an algebraic closure and $-\\mathrm{d}p/\\mathrm{d}x$ is a constant streamwise pressure gradient. In the logarithmic layer of an equilibrium turbulent boundary layer, the mean velocity satisfies the log-law $u^+ = \\left(1/\\kappa\\right)\\ln y^+ + B$, where $u^+ = u/u_\\tau$, $y^+ = y u_\\tau/\\nu$, $u_\\tau = \\sqrt{\\tau_w/\\rho}$ is the friction velocity, $\\nu = \\mu/\\rho$, $\\kappa$ is the von Kármán constant, $B$ is a constant, and $\\tau_w$ is the wall shear stress. Consistency with the log-law implies that, locally, $\\mu_t(y)$ scales linearly with $y$ as $\\mu_t(y) \\propto \\rho \\kappa u_\\tau y$ in the equilibrium log layer.\n\nYou are asked to analyze, from first principles, the effect of abrupt spatial changes in $\\mu_t(y)$ on the discrete momentum balance and to identify a smoothing strategy for $\\mu_t$ that both preserves realizability (non-negativity of $\\mu_t$ and boundedness of the implied Reynolds stresses under the linear eddy-viscosity model) and does not disturb the local log-law consistency. Use the following fundamental bases in your reasoning:\n- The product rule for differentiation, which implies that $\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left[a(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right] = a(y)\\frac{\\mathrm{d}^2 u}{\\mathrm{d}y^2} + a'(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}$ for a sufficiently smooth coefficient $a(y)$.\n- The structure of the finite-volume discretization of a variable-coefficient diffusion operator in one dimension on a uniform grid, which uses face-centered coefficients $a_{i\\pm 1/2}$ in the discrete fluxes $F_{i\\pm 1/2} = a_{i\\pm 1/2}\\left(u_{i\\pm 1} - u_i\\right)/\\Delta y$, where $a(y) = \\mu + \\mu_t(y)$ and $\\Delta y$ is the grid spacing.\n\nWhich option correctly explains the mechanism by which abrupt spatial changes in $\\mu_t(y)$ can introduce numerical oscillations in the computed $u(y)$ and proposes a smoothing filter for $\\mu_t$ that preserves realizability and local log-law consistency?\n\nA. Abrupt jumps in $\\mu_t$ create large coefficients $a'(y)$ that act like an apparent convection term $a'(y)\\,\\mathrm{d}u/\\mathrm{d}y$ in the variable-coefficient diffusion operator. When this apparent convection dominates locally and is discretized with centered differences, dispersive oscillations can occur, particularly if $a_{i+1/2}/a_{i-1/2}$ is highly skewed across adjacent faces. A realizability-preserving and log-law-consistent smoothing is given by the Helmholtz-type filter\n$$\n\\left(I - \\ell^2 \\nabla^2\\right)\\mu_t^{\\,f} = \\mu_t,\n$$\nwith a local length scale $\\ell = C_\\ell \\min\\!\\left(\\kappa y,\\, C_\\Delta \\Delta\\right)$, homogeneous Neumann boundary condition at solid walls, and a positivity projection $\\mu_t^{\\,f} \\leftarrow \\max\\!\\left(0,\\, \\mu_t^{\\,f}\\right)$. This filter leaves any locally linear $\\mu_t(y)$ unchanged (hence preserves the log-law scaling $\\mu_t \\propto y$) and enforces $\\mu_t^{\\,f} \\geq 0$.\n\nB. Oscillations arise because abrupt changes in $\\mu_t$ destabilize the convective term $\\rho u\\,\\mathrm{d}u/\\mathrm{d}x$, making the problem hyperbolic and requiring upwinding of $\\mu_t$. A suitable fix is to upwind $\\mu_t$ using a Mach-number-dependent limiter and apply simple arithmetic averaging of $\\mu_t$ over a $5$-point stencil. This approach preserves realizability by construction and maintains the log-law because the averaging is local.\n\nC. The root cause is loss of Galilean invariance when $\\mu_t$ varies rapidly, which injects spurious kinetic energy. A global moving-average filter $\\mu_t^{\\,f}(y) = \\left(1/L\\right)\\int_{y-L/2}^{y+L/2} \\mu_t(\\eta)\\,\\mathrm{d}\\eta$ with fixed window size $L$ restores invariance and automatically ensures non-negative $\\mu_t$, while its global nature reproduces the correct log-law scaling.\n\nD. Abrupt $\\mu_t$ changes produce stiffness in the elliptic operator, but this does not cause oscillations; it only slows convergence. The best remedy is Laplacian smoothing $\\mu_t^{\\,f} = \\mu_t + \\alpha \\nabla^2 \\mu_t$ with a constant $\\alpha$ and Dirichlet boundary condition $\\mu_t^{\\,f} = 0$ at solid walls. This guarantees $\\mu_t^{\\,f} \\geq 0$ by boundary enforcement and, because $\\alpha$ is constant, does not affect the log-law scaling near the wall.\n\nSelect the correct option.",
            "solution": "The problem is scientifically well-posed, objective, and self-contained. It is grounded in the principles of numerical analysis for computational fluid dynamics, specifically addressing a known issue with algebraic turbulence models that can produce spatially noisy eddy viscosity fields. All definitions and governing equations are standard. We can therefore proceed with the analysis.\n\n**Analysis of the Oscillation Mechanism**\n\nThe core of the problem lies in the variable-coefficient diffusion term $\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left[a(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right]$, where $a(y) = \\mu + \\mu_t(y)$ is the total effective viscosity. Using the product rule for differentiation as suggested, we can expand this term:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left[a(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right] = a(y)\\frac{\\mathrm{d}^2 u}{\\mathrm{d}y^2} + a'(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\n$$\nwhere $a'(y) = \\frac{\\mathrm{d}a}{\\mathrm{d}y} = \\frac{\\mathrm{d}\\mu_t}{\\mathrm{d}y}$ since $\\mu$ is constant. The term $a'(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}$ has the form of a convection term with a variable \"convection velocity\" of $a'(y)$.\n\nWhen an algebraic model produces an eddy viscosity $\\mu_t(y)$ that changes abruptly or is noisy, the derivative $a'(y)$ can become very large. In a discrete numerical scheme (like finite difference or finite volume), if this apparent convection term becomes dominant over the diffusion term $a(y)\\frac{\\mathrm{d}^2 u}{\\mathrm{d}y^2}$, the local \"grid Péclet number\" becomes large. It is a classic result in numerical analysis that discretizing a convection-dominated equation with a centered scheme leads to non-physical, dispersive oscillations in the solution. This precisely explains the mechanism for numerical instability.\n\n**Evaluation of the Options**\n\n*   **Option A:** This option correctly identifies the mechanism: abrupt changes in $\\mu_t$ create a large $a'(y)$ term, which acts as an apparent convection term and causes oscillations when discretized with centered schemes. It then proposes a Helmholtz-type filter. Let's analyze this filter:\n    *   **Smoothing:** The operator $\\left(I - \\ell^2 \\nabla^2\\right)^{-1}$ is a low-pass (smoothing) filter, which is what is needed to reduce the noise in $\\mu_t$ and thus reduce the magnitude of its derivative $a'(y)$.\n    *   **Log-Law Consistency:** The problem states that consistency with the log-law requires $\\mu_t \\propto y$ in the log-layer. For a function that is linear in $y$, its second derivative is zero: $\\nabla^2(\\text{linear function}) = 0$. Therefore, if the raw $\\mu_t$ is linear, the filter equation becomes $(I - 0)\\mu_t^{\\,f} = \\mu_t$, which means $\\mu_t^{\\,f} = \\mu_t$. The filter correctly leaves the physically required linear profile unchanged, preserving log-law consistency.\n    *   **Realizability:** The filter itself does not guarantee non-negativity. However, the proposal includes an explicit projection step, $\\mu_t^{\\,f} \\leftarrow \\max(0, \\mu_t^{\\,f})$, which enforces non-negativity ($\\mu_t^{\\,f} \\ge 0$).\n    *   **Boundary Conditions  Length Scale:** A homogeneous Neumann boundary condition is appropriate for not artificially altering the gradient at a boundary. The adaptive length scale $\\ell$ is physically sound, scaling with the local turbulence length scale ($\\kappa y$) near the wall and the grid size ($\\Delta$) away from it.\n    *   This option provides a correct physical explanation and a sophisticated, appropriate, and fully specified numerical solution.\n\n*   **Option B:** The explanation is incorrect. The oscillations do not arise from the physical convective term $\\rho u\\,\\mathrm{d}u/\\mathrm{d}x$ (which is not present in the simplified 1D equation anyway) but from the variable coefficient in the diffusion term. The proposed fix, upwinding a model coefficient like $\\mu_t$, is conceptually nonsensical. One upwinds a transported quantity, not a material-like property.\n\n*   **Option C:** The explanation involving Galilean invariance is incorrect. Galilean invariance relates to the behavior of the governing equations under a transformation to a different inertial reference frame and is not the direct cause of this specific numerical oscillation. While a moving-average filter does smooth the data, a fixed window size $L$ is a crude approach that does not adapt to the local physical scales (like wall distance), potentially over-smoothing near the wall and under-smoothing in the outer layer, or vice versa.\n\n*   **Option D:** The explanation is incorrect. It wrongly claims that abrupt coefficients do not cause oscillations. They are a well-known cause of such issues. The proposed \"smoothing\" filter, $\\mu_t^{\\,f} = \\mu_t + \\alpha \\nabla^2 \\mu_t$, is actually a sharpening filter (an explicit discretization of the inverse of the Helmholtz operator), which would exacerbate the problem by amplifying high-frequency noise in $\\mu_t$. Furthermore, the claim that it guarantees non-negativity is false, and the Dirichlet boundary condition $\\mu_t^{\\,f} = 0$ is physically incorrect, as it would destroy the log-law profile near the wall.\n\n**Conclusion**\n\nOption A provides the only fully correct analysis of the physical mechanism causing the numerical oscillations and proposes a suitable, well-defined, and physically consistent smoothing strategy that preserves both realizability and log-law behavior.",
            "answer": "$$\n\\boxed{A}\n$$"
        }
    ]
}