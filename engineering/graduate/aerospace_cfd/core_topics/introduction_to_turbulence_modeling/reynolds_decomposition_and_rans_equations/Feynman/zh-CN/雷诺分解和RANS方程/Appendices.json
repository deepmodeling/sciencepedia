{
    "hands_on_practices": [
        {
            "introduction": "将雷诺平均Navier-Stokes（RANS）方程应用于像完全发展的槽道流这样的典型流动，是进行湍流分析的关键一步。这项练习旨在揭示一个基本原理：在槽道流中，总剪切应力与驱动流动的压力梯度之间存在着一种简单的线性关系。掌握这一关系对于理解和验证任何湍流模型都至关重要。",
            "id": "3990782",
            "problem": "考虑一种统计定常、不可压缩、充分发展的牛顿流体平面槽道湍流，其动力粘度 $\\mu$ 和密度 $\\rho$ 为常数。该槽道在 $y=0$ 处有一固壁，在 $y=h$ 处有一对称平面（半槽道模型）。设流向、壁面法向和展向坐标分别为 $x$、 $y$ 和 $z$。平均速度场为 $\\overline{\\boldsymbol{u}} = (U(y), 0, 0)$，平均压力为 $\\overline{p}(x)$。在 $y=0$ 处的壁面剪切应力（平均值）记为 $\\tau_{w} > 0$，定义为壁面传递给流体的总平均剪切力。这种典型设置在计算流体力学（CFD）中被广泛用于评估雷诺平均纳维-斯托克斯（RANS）方程的封闭模型。\n\n从不可压缩的纳维-斯托克斯方程出发，利用雷诺分解、时间平均和不可压缩性约束，推导适用于此典型流动的雷诺平均纳维-斯托克斯（RANS）动量方程的流向分量。仔细辨明因对非线性对流加速度进行平均而产生的附加项的来源和物理意义。利用充分发展槽道在 $y=h$ 处的对称性（即平均剪切和平均雷诺剪切应力在对称平面上为零），以及在壁面处 $\\tau_{w}$ 的定义，将得到的RANS动量平衡简化为关于 $y$ 的一阶常微分方程并对其进行积分。\n\n你的目标是推导出一个关于壁面剪切应力 $\\tau_{w}$ 和半槽道高度 $h$ 的恒定平均流向压力梯度 $\\frac{\\partial \\overline{p}}{\\partial x}$ 的闭式解析表达式。仅提供最终表达式。无需进行数值计算或四舍五入，也无需在最终表达式中报告物理单位。",
            "solution": "出发点是牛顿流体的不可压缩纳维-斯托克斯方程，\n$$\n\\frac{\\partial u_{i}}{\\partial x_{i}} = 0, \\qquad\n\\rho\\left(\\frac{\\partial u_{i}}{\\partial t} + u_{j}\\frac{\\partial u_{i}}{\\partial x_{j}}\\right) = -\\frac{\\partial p}{\\partial x_{i}} + \\mu \\frac{\\partial^{2} u_{i}}{\\partial x_{j}\\partial x_{j}}.\n$$\n我们进行雷诺分解，将每个流动变量写成平均值加脉动值的形式：\n$$\nu_{i} = \\overline{u}_{i} + u_{i}', \\qquad p = \\overline{p} + p',\n$$\n并将平均（上划线）定义为在统计平稳性假设下的适当时间平均。对于不可压缩流动，平均运算保留了无散约束：\n$$\n\\frac{\\partial \\overline{u}_{i}}{\\partial x_{i}} = 0.\n$$\n对动量方程进行平均并利用微分的线性性质，可得\n$$\n\\rho\\left(\\frac{\\partial \\overline{u}_{i}}{\\partial t} + \\overline{u}_{j}\\frac{\\partial \\overline{u}_{i}}{\\partial x_{j}} + \\frac{\\partial \\overline{u_{i}' u_{j}'}}{\\partial x_{j}}\\right) = -\\frac{\\partial \\overline{p}}{\\partial x_{i}} + \\mu \\frac{\\partial^{2} \\overline{u}_{i}}{\\partial x_{j}\\partial x_{j}},\n$$\n其中，项 $\\rho \\,\\frac{\\partial \\overline{u_{i}' u_{j}'}}{\\partial x_{j}}$ 是对非线性对流项 $\\rho\\, u_{j}\\frac{\\partial u_{i}}{\\partial x_{j}}$ 进行平均得到的，代表雷诺应力张量的散度。重写后，雷诺平均纳维-斯托克斯（RANS）动量方程变为\n$$\n\\rho\\,\\overline{u}_{j}\\frac{\\partial \\overline{u}_{i}}{\\partial x_{j}} = -\\frac{\\partial \\overline{p}}{\\partial x_{i}} + \\mu \\frac{\\partial^{2} \\overline{u}_{i}}{\\partial x_{j}\\partial x_{j}} - \\rho\\,\\frac{\\partial \\overline{u_{i}' u_{j}'}}{\\partial x_{j}}.\n$$\n在当前的典型流动中，平均场为 $\\overline{\\boldsymbol{u}} = (U(y), 0, 0)$，我们假设统计定常性，因此 $\\frac{\\partial \\overline{u}_{i}}{\\partial t} = 0$。充分发展条件意味着对于平均场有 $\\frac{\\partial}{\\partial x}(\\cdot) = 0$ 和 $\\frac{\\partial}{\\partial z}(\\cdot) = 0$，并且平均压力仅在 $x$ 方向上变化，即 $\\overline{p} = \\overline{p}(x)$。\n\n关注流向分量 $i=x$，对流项简化为\n$$\n\\rho\\,\\overline{u}_{j}\\frac{\\partial \\overline{u}_{x}}{\\partial x_{j}} = \\rho\\left(\\overline{u}_{x}\\frac{\\partial \\overline{u}_{x}}{\\partial x} + \\overline{u}_{y}\\frac{\\partial \\overline{u}_{x}}{\\partial y} + \\overline{u}_{z}\\frac{\\partial \\overline{u}_{x}}{\\partial z}\\right) = \\rho\\left(U \\cdot 0 + 0 \\cdot \\frac{dU}{dy} + 0 \\cdot 0\\right) = 0,\n$$\n因为 $\\frac{\\partial U}{\\partial x} = 0$，$\\overline{u}_{y} = 0$ 和 $\\frac{\\partial U}{\\partial z} = 0$。粘性项简化为\n$$\n\\mu \\frac{\\partial^{2} \\overline{u}_{x}}{\\partial x_{j}\\partial x_{j}} = \\mu \\frac{d^{2}U}{dy^{2}}.\n$$\n雷诺应力张量的散度仅通过雷诺剪切应力 $\\overline{u_{x}' u_{y}'} = \\overline{u'v'}$ 的壁面法向导数产生贡献：\n$$\n-\\rho\\,\\frac{\\partial \\overline{u_{x}' u_{j}'}}{\\partial x_{j}} = -\\rho\\,\\frac{d \\overline{u'v'}}{dy}.\n$$\n因此，流向的RANS动量平衡方程变为\n$$\n0 = -\\frac{\\partial \\overline{p}}{\\partial x} + \\mu \\frac{d^{2}U}{dy^{2}} - \\rho\\,\\frac{d \\,\\overline{u'v'}}{dy}.\n$$\n为方便起见，引入总平均剪切应力，\n$$\n\\tau_{\\text{tot}}(y) \\equiv \\mu \\frac{dU}{dy} - \\rho\\,\\overline{u'v'},\n$$\n它结合了粘性剪切和雷诺剪切。将 $\\tau_{\\text{tot}}(y)$ 对 $y$ 求导并使用前一个方程，\n$$\n\\frac{d \\tau_{\\text{tot}}}{dy} = \\mu \\frac{d^{2}U}{dy^{2}} - \\rho\\,\\frac{d \\,\\overline{u'v'}}{dy} = \\frac{\\partial \\overline{p}}{\\partial x}.\n$$\n对于充分发展的流动，右侧项与 $y$ 无关，因此 $\\frac{\\partial \\overline{p}}{\\partial x}$ 是一个常数。将 $\\frac{d \\tau_{\\text{tot}}}{dy} = \\frac{\\partial \\overline{p}}{\\partial x}$ 对 $y$ 积分，得到\n$$\n\\tau_{\\text{tot}}(y) = y\\,\\frac{\\partial \\overline{p}}{\\partial x} + C,\n$$\n其中 $C$ 是一个积分常数。我们通过槽道中心线的对称性来确定 $C$。在对称平面 $y=h$ 处，平均剪切为零，$\\frac{dU}{dy}\\big|_{y=h} = 0$，雷诺剪切应力也为零，$\\overline{u'v'}\\big|_{y=h} = 0$，因此\n$$\n\\tau_{\\text{tot}}(h) = 0.\n$$\n因此，\n$$\n0 = h\\,\\frac{\\partial \\overline{p}}{\\partial x} + C \\quad \\Rightarrow \\quad C = -\\,h\\,\\frac{\\partial \\overline{p}}{\\partial x}.\n$$\n在壁面 $y=0$ 处，总平均剪切等于壁面剪切应力 $\\tau_{w}$：\n$$\n\\tau_{\\text{tot}}(0) = \\tau_{w} = 0 \\cdot \\frac{\\partial \\overline{p}}{\\partial x} + C = C.\n$$\n结合这两个关于 $C$ 的关系式，得到\n$$\n\\tau_{w} = -\\,h\\,\\frac{\\partial \\overline{p}}{\\partial x} \\quad \\Rightarrow \\quad \\frac{\\partial \\overline{p}}{\\partial x} = -\\,\\frac{\\tau_{w}}{h}.\n$$\n这个结果表示了恒定平均流向压力梯度与壁面剪切应力和半槽道高度之间的关系。负号表示，当 $\\tau_{w} > 0$ 定义为壁面沿与平均流动相反方向传递给流体的剪切力大小时，$\\overline{p}$ 在流向方向上减小。",
            "answer": "$$\\boxed{-\\frac{\\tau_{w}}{h}}$$"
        },
        {
            "introduction": "基于先前推导出的理论应力平衡 ，本练习使用一组设定的测量数据来具体分析总剪切应力的内部构成。通过计算流场中某特定位置的粘性剪切和雷诺剪切（湍流剪切）的贡献，您将能定量地理解在湍流的核心区域，动量是如何主要通过湍流脉动来传递的。",
            "id": "3990764",
            "problem": "在计算流体动力学（CFD）的背景下，研究了空气在平面通道中的充分发展湍流。通道的半高为 $h$，垂直于壁面的坐标 $y$ 从下壁面 $y = 0$ 处量起，到中心线 $y = h$ 处。流动是稳态、不可压缩的，并由恒定的流向压力梯度驱动。在实验室条件下，空气的性质为密度 $\\rho$ 和动力粘度 $\\mu$。瞬时速度场和压力场满足不可压缩的Navier–Stokes方程，速度根据Reynolds分解被分解为平均部分和脉动部分。考虑以下数据：\n-   流体密度 $\\rho = 1.20\\ \\mathrm{kg\\,m^{-3}}$，\n-   动力粘度 $\\mu = 1.80 \\times 10^{-5}\\ \\mathrm{Pa\\,s}$，\n-   通道半高 $h = 1.00 \\times 10^{-2}\\ \\mathrm{m}$，\n-   恒定流向压力梯度 $\\frac{d \\overline{p}}{dx} = -1.20 \\times 10^{2}\\ \\mathrm{Pa\\,m^{-1}}$，\n-   在壁面法向位置 $y_{0} = 2.00 \\times 10^{-3}\\ \\mathrm{m}$ 处，测量得到平均速度梯度 $\\frac{d \\overline{U}}{dy}\\big|_{y_{0}} = 1.00 \\times 10^{3}\\ \\mathrm{s^{-1}}$ 和Reynolds剪切应力 $-\\rho\\,\\overline{u'v'}\\big|_{y_{0}} = 9.42 \\times 10^{-1}\\ \\mathrm{Pa}$。\n\n从瞬时不可压缩Navier–Stokes方程出发，应用Reynolds分解，推导适用于具有恒定压力梯度的稳态、充分发展的平面通道流的一维流向Reynolds平均Navier–Stokes方程（RANS）。根据该平衡关系，确定整个通道的总剪切应力分布表达式，并推导出壁面剪切应力 $\\tau_{w}$。定义摩擦速度 $u_{\\tau}$ 为 $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$。在位置 $y_{0}$ 处，定义粘性剪切应力 $\\tau_{v}(y_{0}) = \\mu \\left( \\frac{d \\overline{U}}{dy} \\right)\\big|_{y_{0}}$，湍流剪切应力 $\\tau_{t}(y_{0}) = -\\rho\\,\\overline{u'v'}\\big|_{y_{0}}$，以及总剪切应力 $\\tau_{\\text{tot}}(y_{0}) = \\tau_{v}(y_{0}) + \\tau_{t}(y_{0})$。计算分配分数 $\\beta = \\frac{\\tau_{t}(y_{0})}{\\tau_{\\text{tot}}(y_{0})}$。\n\n将您的最终答案以行矩阵的形式报告，依次包含摩擦速度和分配分数。将您的答案四舍五入至四位有效数字。摩擦速度以 $\\mathrm{m\\,s^{-1}}$ 为单位，分配分数为无单位小数。",
            "solution": "分析从验证问题陈述开始。\n\n### 步骤1：提取已知条件\n-   流体：空气\n-   流动类型：稳态、不可压缩、充分发展的平面通道湍流。\n-   几何形状：半高为 $h$ 的平面通道。\n-   坐标系：壁面法向坐标 $y$ 从下壁面（$y=0$）量至中心线（$y=h$）。流向坐标为 $x$。\n-   流体密度：$\\rho = 1.20\\ \\mathrm{kg\\,m^{-3}}$\n-   动力粘度：$\\mu = 1.80 \\times 10^{-5}\\ \\mathrm{Pa\\,s}$\n-   通道半高：$h = 1.00 \\times 10^{-2}\\ \\mathrm{m}$\n-   平均流向压力梯度：$\\frac{d \\overline{p}}{dx} = -1.20 \\times 10^{2}\\ \\mathrm{Pa\\,m^{-1}}$\n-   测量位置：$y_{0} = 2.00 \\times 10^{-3}\\ \\mathrm{m}$\n-   $y_0$ 处的平均速度梯度：$\\frac{d \\overline{U}}{dy}\\big|_{y_{0}} = 1.00 \\times 10^{3}\\ \\mathrm{s^{-1}}$\n-   $y_0$ 处的Reynolds剪切应力项：$-\\rho\\,\\overline{u'v'}\\big|_{y_{0}} = 9.42 \\times 10^{-1}\\ \\mathrm{Pa}$\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学上基于流体动力学的基本原理，特别是使用Reynolds平均Navier-Stokes（RANS）方程对湍流的研究。充分发展的平面通道湍流是该领域的一个经典问题。语言客观，问题提法得当，为推导所求量提供了足够的数据。\n\n为了检查内部一致性，我们可以将根据第一性原理（压力梯度）计算的 $y_0$ 处的总剪切应力与从提供的局部测量值获得的值进行比较。\n从第一性原理出发，总剪切应力分布是线性的：$\\tau_{\\text{tot}}(y) = (y - h) \\frac{d\\overline{p}}{dx}$。\n在 $y_0 = 2.00 \\times 10^{-3}\\ \\mathrm{m}$ 处：\n$\\tau_{\\text{tot}}(y_0) = (2.00 \\times 10^{-3}\\ \\mathrm{m} - 1.00 \\times 10^{-2}\\ \\mathrm{m}) \\times (-1.20 \\times 10^{2}\\ \\mathrm{Pa\\,m^{-1}})$\n$\\tau_{\\text{tot}}(y_0) = (-8.00 \\times 10^{-3}\\ \\mathrm{m}) \\times (-1.20 \\times 10^{2}\\ \\mathrm{Pa\\,m^{-1}}) = 0.960\\ \\mathrm{Pa}$。\n\n根据给定的局部测量值：\n粘性剪切应力：$\\tau_{v}(y_{0}) = \\mu \\left( \\frac{d \\overline{U}}{dy} \\right)\\big|_{y_{0}} = (1.80 \\times 10^{-5}\\ \\mathrm{Pa\\,s}) \\times (1.00 \\times 10^{3}\\ \\mathrm{s^{-1}}) = 0.0180\\ \\mathrm{Pa}$。\n湍流剪切应力：$\\tau_{t}(y_{0}) = -\\rho\\,\\overline{u'v'}\\big|_{y_{0}} = 0.942\\ \\mathrm{Pa}$。\n总剪切应力：$\\tau_{\\text{tot}}(y_0) = \\tau_v(y_0) + \\tau_t(y_0) = 0.0180\\ \\mathrm{Pa} + 0.942\\ \\mathrm{Pa} = 0.960\\ \\mathrm{Pa}$。\n这两个值完全相同，证实了问题数据的内部一致性。该问题是有效的。\n\n### 推导与求解\n\n瞬时不可压缩Navier-Stokes方程经过Reynolds分解，其中瞬时量被分解为平均部分和脉动部分：$u_i = \\overline{U_i} + u'_i$ 和 $p = \\overline{p} + p'$。代入并进行时间平均后，RANS动量方程的x分量为：\n$$ \\rho \\left( \\frac{\\partial \\overline{U}}{\\partial t} + \\overline{U}\\frac{\\partial \\overline{U}}{\\partial x} + \\overline{V}\\frac{\\partial \\overline{U}}{\\partial y} + \\overline{W}\\frac{\\partial \\overline{U}}{\\partial z} \\right) = -\\frac{\\partial \\overline{p}}{\\partial x} + \\mu \\nabla^2 \\overline{U} - \\rho \\left( \\frac{\\partial \\overline{u'u'}}{\\partial x} + \\frac{\\partial \\overline{u'v'}}{\\partial y} + \\frac{\\partial \\overline{u'w'}}{\\partial z} \\right) $$\n对于稳态、充分发展的平面通道流，适用以下简化：\n1.  **稳态流**：任何平均量的 $\\frac{\\partial}{\\partial t}$ 均为 $0$。\n2.  **充分发展流**：任何平均速度分量或统计量（如Reynolds应力）的 $\\frac{\\partial}{\\partial x}$ 均为 $0$。\n3.  **平面流**：流动在展向（$z$）方向上是统计均匀的，因此任何平均量或统计量的 $\\frac{\\partial}{\\partial z}$ 均为 $0$。平均速度场是一维的，$\\overline{\\mathbf{U}} = (\\overline{U}(y), 0, 0)$，因此 $\\overline{V} = \\overline{W} = 0$。\n\n将这些简化应用于x-RANS方程，得到：\n$$ 0 = -\\frac{d \\overline{p}}{dx} + \\mu \\frac{d^2 \\overline{U}}{dy^2} - \\rho \\frac{d \\overline{u'v'}}{dy} $$\n压力梯度 $\\frac{\\partial \\overline{p}}{\\partial x}$ 变为 $\\frac{d \\overline{p}}{dx}$，因为 $\\overline{p}$ 仅是 $x$ 的函数。这个方程可以通过组合应力项来重写：\n$$ \\frac{d}{dy} \\left( \\mu \\frac{d \\overline{U}}{dy} - \\rho \\overline{u'v'} \\right) = \\frac{d \\overline{p}}{dx} $$\n括号中的项是总剪切应力，$\\tau_{\\text{tot}}(y) = \\mu \\frac{d\\overline{U}}{dy} - \\rho\\overline{u'v'}$。这代表了平均粘性剪切应力 $\\tau_v(y) = \\mu \\frac{d\\overline{U}}{dy}$ 和湍流或Reynolds剪切应力 $\\tau_t(y) = -\\rho\\overline{u'v'}$ 的总和。\n因此，简化的RANS方程显示了总剪切应力的线性关系：\n$$ \\frac{d\\tau_{\\text{tot}}}{dy} = \\frac{d\\overline{p}}{dx} $$\n从中心线（$y=h$）到任意位置 $y$ 对 $y$ 进行积分：\n$$ \\int_h^y \\frac{d\\tau_{\\text{tot}}}{dy'} dy' = \\int_h^y \\frac{d\\overline{p}}{dx} dy' $$\n$$ \\tau_{\\text{tot}}(y) - \\tau_{\\text{tot}}(h) = (y-h) \\frac{d\\overline{p}}{dx} $$\n在中心线（$y=h$）处，由于对称性，平均速度梯度 $\\frac{d\\overline{U}}{dy}$ 和Reynolds剪切相关项 $\\overline{u'v'}$ 均为零。因此，$\\tau_{\\text{tot}}(h) = 0$。这给出了总剪切应力分布的表达式：\n$$ \\tau_{\\text{tot}}(y) = (y-h)\\frac{d\\overline{p}}{dx} $$\n壁面剪切应力 $\\tau_w$ 是下壁面（$y=0$）处的总剪切应力：\n$$ \\tau_w = \\tau_{\\text{tot}}(0) = (0-h)\\frac{d\\overline{p}}{dx} = -h\\frac{d\\overline{p}}{dx} $$\n使用给定的数值：\n$$ \\tau_w = -(1.00 \\times 10^{-2}\\ \\mathrm{m})(-1.20 \\times 10^{2}\\ \\mathrm{Pa\\,m^{-1}}) = 1.20\\ \\mathrm{Pa} $$\n摩擦速度 $u_\\tau$ 定义为 $u_\\tau = \\sqrt{\\tau_w/\\rho}$：\n$$ u_\\tau = \\sqrt{\\frac{1.20\\ \\mathrm{Pa}}{1.20\\ \\mathrm{kg\\,m^{-3}}}} = \\sqrt{1.00\\ \\mathrm{m^2\\,s^{-2}}} = 1.00\\ \\mathrm{m\\,s^{-1}} $$\n四舍五入到四位有效数字，$u_\\tau = 1.000\\ \\mathrm{m\\,s^{-1}}$。\n\n接下来，我们计算在 $y_0 = 2.00 \\times 10^{-3}\\ \\mathrm{m}$ 处的分配分数 $\\beta = \\frac{\\tau_t(y_0)}{\\tau_{\\text{tot}}(y_0)}$。\n$y_0$ 处的湍流剪切应力已知为 $\\tau_t(y_0) = -\\rho\\,\\overline{u'v'}\\big|_{y_{0}} = 9.42 \\times 10^{-1}\\ \\mathrm{Pa} = 0.942\\ \\mathrm{Pa}$。\n根据给定数据计算 $y_0$ 处的粘性剪切应力：\n$$ \\tau_v(y_0) = \\mu \\left( \\frac{d \\overline{U}}{dy} \\right)\\big|_{y_{0}} = (1.80 \\times 10^{-5}\\ \\mathrm{Pa\\,s}) \\times (1.00 \\times 10^{3}\\ \\mathrm{s^{-1}}) = 1.80 \\times 10^{-2}\\ \\mathrm{Pa} = 0.0180\\ \\mathrm{Pa} $$\n$y_0$ 处的总剪切应力是粘性分量和湍流分量之和：\n$$ \\tau_{\\text{tot}}(y_0) = \\tau_v(y_0) + \\tau_t(y_0) = 0.0180\\ \\mathrm{Pa} + 0.942\\ \\mathrm{Pa} = 0.960\\ \\mathrm{Pa} $$\n那么分配分数为：\n$$ \\beta = \\frac{\\tau_t(y_0)}{\\tau_{\\text{tot}}(y_0)} = \\frac{0.942}{0.960} = 0.98125 $$\n四舍五入到四位有效数字，$\\beta = 0.9813$。\n\n最终答案包括摩擦速度 $u_\\tau$ 和分配分数 $\\beta$。\n$u_\\tau = 1.000\\ \\mathrm{m\\,s^{-1}}$\n$\\beta = 0.9813$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.000 & 0.9813\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "RANS建模的最终目标是预测平均速度剖面，并对照高精度数据进行验证。这项综合性练习将引导您实现一个经典的湍流模型——带有van Driest阻尼的混合长度模型，以计算出著名的“壁面律”速度分布。通过将您的模型预测结果与直接数值模拟（DNS）和实验数据进行比较，您将体验到湍流模型开发与验证的核心工作流程，这是计算流体力学研究中的一项基本技能。",
            "id": "3990784",
            "problem": "考虑一个光滑壁面、不可压缩、平衡的湍流剪切流，该流动沿流向对齐，其一维平均变化发生在壁面法向坐标 $y$ 上。从不可压缩的 Navier–Stokes 方程出发，应用雷诺分解 $u_i = \\overline{u}_i + u'_i$ 和时间平均，得到雷诺平均 Navier–Stokes (RANS) 方程。在稳态、统计平稳、一维性和零平均压力梯度的假设下，推导以平均速度 $U(y)$ 和雷诺剪切应力 $\\overline{u'v'}(y)$ 表示的平均流向动量方程。定义摩擦速度 $u_\\tau$ 为 $\\tau_w = \\rho u_\\tau^2$，其中 $\\tau_w$ 是壁面剪切应力，$\\rho$ 是流体密度，运动粘度 $\\nu = \\mu / \\rho$。\n\n采用 Boussinesq 涡粘性假设 $\\overline{u'v'} = - \\nu_t \\, dU/dy$，其中 $\\nu_t$ 是涡粘性系数。假设一个带有 van Driest 阻尼的内层混合长度封闭模型，$\\ell(y) = \\kappa \\, y \\left[1 - \\exp\\left(- y^+/A^+\\right)\\right]$，其中 $\\kappa$ 是 von Kármán 常数，$A^+$ 是一个阻尼常数，$y^+ = y u_\\tau/\\nu$ 是壁面单位坐标。使用 $\\nu_t = \\ell^2 \\left| dU/dy \\right|$ 和在平衡内层中有效的恒定总剪切应力近似，来获得关于平均剪切 $S(y) = dU/dy$ 的非线性关系式。通过定义 $U^+ = U/u_\\tau$ 和 $S^+ = dU^+/dy^+$，将此关系式变换到壁面单位下。证明无量纲剪切 $G(y^+) \\equiv S^+ = dU^+/dy^+$ 满足一个以无量纲混合长度 $\\ell^+ = \\ell u_\\tau/\\nu$ 表示的二次代数方程。由此推导出 $G(y^+)$ 的显式表达式，并解释如何在无滑移边界条件 $U^+(0)=0$ 的约束下，对 $G(y^+)$ 进行数值积分以获得 $U^+(y^+)$。\n\n为验证所得的 RANS/混合长度模型对 $U^+(y^+)$ 的预测，请将其与两个独立的参考数据集进行比较：\n\n- 一个由 Spalding 光滑壁面壁律捕获的直接数值模拟 (DNS) 相关性，它通过以下方式隐式关联 $U^+$ 和 $y^+$\n$$\ny^+ = U^+ + \\exp(-\\kappa B) \\left[ \\exp(\\kappa U^+) - 1 - \\kappa U^+ - \\frac{(\\kappa U^+)^2}{2} - \\frac{(\\kappa U^+)^3}{6} \\right],\n$$\n其中包含常数 $\\kappa$ 和 $B$。\n\n- 一个实验合成剖面，它对 $y^+ \\leq 5$ 使用粘性子层 $U^+ = y^+$，对 $y^+ > 5$ 使用对数壁律 $U^+ = \\frac{1}{\\kappa} \\ln(y^+) + B$，其中 $\\kappa$ 和 $B$ 值相同。\n\n您的程序必须为每个测试用例实现以下步骤：\n\n1. 构建一个壁面单位网格 $y^+ \\in [0, y^+_{\\max}]$，包含 $N$ 个均匀间隔的点，其中 $y^+_{\\max} = \\min(\\operatorname{Re}_\\tau, 800)$ 且 $N = 801$。此处，摩擦雷诺数是 $\\operatorname{Re}_\\tau = u_\\tau \\delta / \\nu$，$\\delta$ 是一个特征外层长度尺度，每个测试用例都会提供 $\\operatorname{Re}_\\tau$。\n\n2. 通过以下方式计算 RANS/混合长度模型的预测 $U^+(y^+)$：\n   - 在网格上计算 $\\ell^+(y^+) = \\kappa \\, y^+ \\left[1 - \\exp\\left(- y^+/A^+\\right)\\right]$。\n   - 求解从内层恒定应力近似和混合长度封闭模型得到的关于 $G(y^+) = dU^+/dy^+$ 的二次代数关系式。\n   - 使用梯形法则对 $G(y^+)$ 关于 $y^+$ 进行数值积分，以获得满足 $U^+(0)=0$ 的 $U^+(y^+)$。\n\n3. 通过在每个网格点上使用一个具有物理一致性初始猜测的稳健求根方法，对 Spalding 定律进行数值反演，来计算 DNS 参考值 $U^+_{\\mathrm{DNS}}(y^+)$。\n\n4. 使用上面给出的分段复合定义计算实验参考值 $U^+_{\\mathrm{exp}}(y^+)$。\n\n5. 在网格上评估均方根 (RMS) 误差：\n$$\nE_{\\mathrm{DNS}} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left(U^+(y^+_i) - U^+_{\\mathrm{DNS}}(y^+_i)\\right)^2}, \\quad\nE_{\\mathrm{exp}} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left(U^+(y^+_i) - U^+_{\\mathrm{exp}}(y^+_i)\\right)^2}.\n$$\n\n测试套件：\n使用下面这组参数值，每个都以 $(\\operatorname{Re}_\\tau, \\kappa, B, A^+)$ 的形式指定：\n- 案例 1 (理想情况): $(180, 0.41, 5.2, 26)$。\n- 案例 2 (中高): $(550, 0.41, 5.0, 26)$。\n- 案例 3 (低 $\\operatorname{Re}_\\tau$ 边界): $(30, 0.41, 5.2, 26)$。\n- 案例 4 (高 $\\operatorname{Re}_\\tau$ 且常数不同): $(1000, 0.40, 5.3, 20)$。\n\n答案规格：\n- 对于每个测试用例，计算 $E_{\\mathrm{DNS}}$ 和 $E_{\\mathrm{exp}}$ 作为实数（无量纲，以壁面单位表示）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为\n$[E_{\\mathrm{DNS}}^{(1)}, E_{\\mathrm{exp}}^{(1)}, E_{\\mathrm{DNS}}^{(2)}, E_{\\mathrm{exp}}^{(2)}, E_{\\mathrm{DNS}}^{(3)}, E_{\\mathrm{exp}}^{(3)}, E_{\\mathrm{DNS}}^{(4)}, E_{\\mathrm{exp}}^{(4)}]$，\n其中上标表示从 1 到 4 的案例索引。\n\n本问题中的所有量都以壁面单位处理，因此都是无量纲的；不需要进行物理单位转换。问题中未出现角度。未使用百分比。",
            "solution": "该问题陈述是计算流体动力学领域中一个定义明确的练习，特别是在壁湍流的湍流建模背景下。所有提供的信息在科学上都是合理的、自洽的，并且足以推导出一个唯一的数值解。该问题是有效的。\n\n推导始于瞬时速度场 $u_i$ 和压力 $p$ 的不可压缩 Navier-Stokes 方程：\n$$\n\\frac{\\partial u_i}{\\partial t} + u_j \\frac{\\partial u_i}{\\partial x_j} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x_i} + \\nu \\frac{\\partial^2 u_i}{\\partial x_j \\partial x_j}\n$$\n我们应用雷诺分解，$u_i = \\overline{u}_i + u'_i$ 和 $p = \\overline{p} + p'$，并对该方程进行时间平均，以获得雷诺平均 Navier-Stokes (RANS) 方程：\n$$\n\\frac{\\partial \\overline{u}_i}{\\partial t} + \\overline{u}_j \\frac{\\partial \\overline{u}_i}{\\partial x_j} = -\\frac{1}{\\rho} \\frac{\\partial \\overline{p}}{\\partial x_i} + \\frac{\\partial}{\\partial x_j} \\left( \\nu \\frac{\\partial \\overline{u}_i}{\\partial x_j} - \\overline{u'_i u'_j} \\right)\n$$\n项 $-\\rho \\overline{u'_i u'_j}$ 是雷诺应力张量。\n\n我们现在应用平衡湍流剪切流的假设：\n1.  **稳态**：$\\frac{\\partial}{\\partial t} (\\cdot) = 0$。\n2.  **一维平均场**：平均流动仅存在于流向 $x$，且仅在壁面法向 $y$ 上变化。因此，$\\overline{\\boldsymbol{u}} = (U(y), 0, 0)$。\n3.  **零平均压力梯度**：$\\frac{\\partial \\overline{p}}{\\partial x} = 0$。\n\n将这些假设应用于 RANS 方程的流向 ($i=1$) 分量，由于一维性，所有涉及对 $x$ 和 $z$ 求导的项都消失了，平流项也因为 $\\overline{u}_j \\frac{\\partial U(y)}{\\partial x_j} = V \\frac{dU}{dy} = 0$ 而消失。方程显著简化为：\n$$\n0 = \\frac{d}{dy} \\left( \\nu \\frac{dU}{dy} - \\overline{u'v'} \\right)\n$$\n这个方程意味着总剪切应力 $\\tau_{total} = \\mu \\frac{dU}{dy} - \\rho \\overline{u'v'}$ 在整个流层中是恒定的。在内层，这个恒定的应力等于壁面上的应力 $\\tau_w$。\n$$\n\\mu \\frac{dU}{dy} - \\rho \\overline{u'v'} = \\tau_w\n$$\n两边同除以流体密度 $\\rho$，并使用运动粘度 $\\nu = \\mu/\\rho$ 和摩擦速度 $u_\\tau = \\sqrt{\\tau_w/\\rho}$ 的定义，我们得到：\n$$\n\\nu \\frac{dU}{dy} - \\overline{u'v'} = u_\\tau^2\n$$\n这代表了粘性剪切和湍流剪切之间的平衡。\n\n为了封闭此方程，我们引入 Boussinesq 涡粘性假设，该假设将雷诺剪切应力类比于粘性应力进行建模：\n$$\n-\\overline{u'v'} = \\nu_t \\frac{dU}{dy}\n$$\n其中 $\\nu_t$ 是涡粘性系数。将其代入应力平衡方程得到：\n$$\n\\nu \\frac{dU}{dy} + \\nu_t \\frac{dU}{dy} = u_\\tau^2 \\implies (\\nu + \\nu_t) \\frac{dU}{dy} = u_\\tau^2\n$$\n问题指定了涡粘性系数的混合长度模型，$\\nu_t = \\ell^2 |dU/dy|$。对于边界层剖面，$dU/dy > 0$，因此 $|dU/dy| = dU/dy$。于是，$\\nu_t = \\ell^2 \\frac{dU}{dy}$。\n\n接下来，我们将方程变换为无量纲壁面单位。我们定义 $y^+ = y u_\\tau / \\nu$ 和 $U^+ = U / u_\\tau$。平均速度梯度变为：\n$$\n\\frac{dU}{dy} = \\frac{d(u_\\tau U^+)}{d(\\nu y^+/u_\\tau)} = \\frac{u_\\tau^2}{\\nu} \\frac{dU^+}{dy^+}\n$$\n我们定义无量纲剪切为 $S^+ \\equiv G(y^+) = dU^+/dy^+$。有量纲的剪切是 $S = dU/dy = \\frac{u_\\tau^2}{\\nu}S^+$。\n将 $S$ 代入方程 $(\\nu + \\nu_t) S = u_\\tau^2$ 得到：\n$$\n(\\nu + \\nu_t) \\frac{u_\\tau^2}{\\nu} S^+ = u_\\tau^2 \\implies \\left(1 + \\frac{\\nu_t}{\\nu}\\right) S^+ = 1\n$$\n现在我们用壁面单位表示 $\\nu_t/\\nu$。使用 $\\nu_t = \\ell^2 S$：\n$$\n\\frac{\\nu_t}{\\nu} = \\frac{\\ell^2 S}{\\nu} = \\frac{\\ell^2}{\\nu} \\left(\\frac{u_\\tau^2}{\\nu} S^+\\right) = \\left(\\frac{\\ell u_\\tau}{\\nu}\\right)^2 S^+\n$$\n定义无量纲混合长度 $\\ell^+ = \\ell u_\\tau / \\nu$，我们有 $\\nu_t/\\nu = (\\ell^+)^2 S^+$。将其代入无量纲应力平衡方程得到：\n$$\n\\left(1 + (\\ell^+)^2 S^+\\right) S^+ = 1\n$$\n这可以重排为指定的关于 $S^+ = G(y^+)$ 的二次代数方程：\n$$\n(\\ell^+)^2 (S^+)^2 + S^+ - 1 = 0\n$$\n使用二次公式求解 $S^+$，$S^+ = \\frac{-1 \\pm \\sqrt{1 - 4(\\ell^+)^2(-1)}}{2(\\ell^+)^2}$。由于物理剪切 $S^+$ 必须为非负，我们取正根：\n$$\nG(y^+) = S^+ = \\frac{-1 + \\sqrt{1 + 4(\\ell^+)^2}}{2(\\ell^+)^2}\n$$\n为了数值稳定性，特别是当 $\\ell^+ \\to 0$ 时，我们对分子进行有理化：\n$$\nG(y^+) = \\frac{(-1 + \\sqrt{1 + 4(\\ell^+)^2})(1 + \\sqrt{1 + 4(\\ell^+)^2})}{2(\\ell^+)^2(1 + \\sqrt{1 + 4(\\ell^+)^2})} = \\frac{1 + 4(\\ell^+)^2 - 1}{2(\\ell^+)^2(1 + \\sqrt{1 + 4(\\ell^+)^2})} = \\frac{2}{1 + \\sqrt{1 + 4(\\ell^+)^2}}\n$$\n对于所有 $\\ell^+ \\geq 0$，这个形式都是稳健的。在壁面处（$y^+=0$），$\\ell^+=0$，且 $G(0) = S^+(0) = 2/(1+1) = 1$。\n\n混合长度 $\\ell$ 由 van Driest 阻尼模型给出：$\\ell(y) = \\kappa y \\left[1 - \\exp(-y^+/A^+)\\right]$。在壁面单位下，这变为：\n$$\n\\ell^+(y^+) = \\frac{\\ell u_\\tau}{\\nu} = \\kappa \\frac{y u_\\tau}{\\nu} \\left[1 - \\exp\\left(-y^+/A^+\\right)\\right] = \\kappa y^+ \\left[1 - \\exp\\left(-y^+/A^+\\right)\\right]\n$$\n为了获得平均速度剖面 $U^+(y^+)$，我们必须从壁面开始对无量纲剪切 $G(y^+)$ 进行积分，并满足无滑移条件 $U^+(0)=0$：\n$$\nU^+(y^+) = \\int_0^{y^+} G(\\eta^+) d\\eta^+\n$$\n该积分在 $y^+$ 值的离散网格上使用梯形法则进行数值计算。\n\n数值实现按以下步骤进行：\n1.  为 $y^+$ 构建一个从 $0$ 到 $y^+_{\\max}$、包含 $N$ 个点的均匀网格。\n2.  在每个网格点 $y^+_i$ 上，使用给定的公式以及常数 $\\kappa$ 和 $A^+$ 计算无量纲混合长度 $\\ell^+(y^+_i)$。\n3.  使用 $\\ell^+(y^+_i)$，通过上面推导的数值稳定公式计算无量纲剪切 $G(y^+_i)$。\n4.  从 $U^+(0)=0$ 开始，使用梯形法则对 $G(y^+)$ 的离散值关于 $y^+$ 进行数值积分，以获得速度剖面 $U^+(y^+)$。\n5.  在同一网格上计算两个参考剖面。对于 $U^+_{\\mathrm{DNS}}(y^+)$，Spalding 定律是给定 $y^+$ 时关于 $U^+$ 的一个隐式方程。这需要对每个 $y^+_i$ 使用数值求根算法。对于 $U^+_{\\mathrm{exp}}(y^+)$，则根据 $y^+_i \\leq 5$ 还是 $y^+_i > 5$ 来评估一个简单的分段函数。\n6.  最后，通过将 RANS/混合长度剖面与两个参考剖面在整个网格上进行比较，计算均方根 (RMS) 误差 $E_{\\mathrm{DNS}}$ 和 $E_{\\mathrm{exp}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the turbulent boundary layer problem for all test cases.\n    \"\"\"\n    # Test Suite: (Re_tau, kappa, B, A_plus)\n    test_cases = [\n        (180, 0.41, 5.2, 26),\n        (550, 0.41, 5.0, 26),\n        (30, 0.41, 5.2, 26),\n        (1000, 0.40, 5.3, 20),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Re_tau, kappa, B, A_plus = case\n        \n        # 1. Construct the wall-unit grid\n        N = 801\n        y_plus_max = min(Re_tau, 800)\n        y_plus_grid = np.linspace(0, y_plus_max, N)\n\n        # 2. Compute the RANS/mixing-length prediction U+(y+)\n        # Evaluate dimensionless mixing length l+\n        l_plus = kappa * y_plus_grid * (1 - np.exp(-y_plus_grid / A_plus))\n        \n        # Solve for dimensionless shear G(y+) = dU+/dy+\n        # Using the numerically stable formula G = 2 / (1 + sqrt(1 + 4*l_plus^2))\n        G_y_plus = 2 / (1 + np.sqrt(1 + 4 * l_plus**2))\n        \n        # Numerically integrate G(y+) to get U+(y+) using trapezoidal rule\n        # cumulative_trapezoid returns N-1 points, so we use initial=0 to get N points.\n        U_plus_rans = integrate.cumulative_trapezoid(G_y_plus, y_plus_grid, initial=0)\n\n        # 3. Compute the DNS reference U_plus_dns(y+) from Spalding's law\n        U_plus_dns = np.zeros(N)\n        \n        def spalding_func(U_p, y_p, k, b):\n            \"\"\"Spalding's law implicit function: f(U+) = 0.\"\"\"\n            exp_term = np.exp(k * U_p)\n            poly_term = 1 + k * U_p + (k * U_p)**2 / 2 + (k * U_p)**3 / 6\n            return y_p - U_p - np.exp(-k * b) * (exp_term - poly_term)\n\n        def spalding_fprime(U_p, y_p, k, b):\n            \"\"\"Derivative of Spalding's law function w.r.t. U+.\"\"\"\n            exp_term = np.exp(k * U_p)\n            poly_deriv = k + k**2 * U_p + k**3 * U_p**2 / 2\n            return -1 - np.exp(-k * b) * (k * exp_term - poly_deriv)\n\n        # The root at y_plus=0 is U_plus=0.\n        U_plus_dns[0] = 0.0\n        # For y_plus > 0, find roots numerically.\n        for i in range(1, N):\n            y_p = y_plus_grid[i]\n            # Initial guess for the root finder. U+ ~ y+ is a good guess.\n            U_guess = y_p\n            try:\n                # Use Newton's method for its speed, with derivative provided.\n                U_plus_dns[i] = optimize.newton(\n                    spalding_func, U_guess, fprime=spalding_fprime, args=(y_p, kappa, B)\n                )\n            except RuntimeError:\n                # Fallback to a bracketing method if Newton fails\n                U_plus_dns[i] = optimize.brentq(spalding_func, 0, 2*y_p, args=(y_p, kappa, B))\n\n\n        # 4. Compute the experimental reference U_plus_exp(y+)\n        # Composite profile: viscous sublayer + log-law\n        U_plus_exp = np.where(\n            y_plus_grid = 5,\n            y_plus_grid,\n            (1/kappa) * np.log(y_plus_grid) + B\n        )\n        \n        # 5. Evaluate the RMS errors\n        E_dns = np.sqrt(np.mean((U_plus_rans - U_plus_dns)**2))\n        E_exp = np.sqrt(np.mean((U_plus_rans - U_plus_exp)**2))\n        \n        results.append(E_dns)\n        results.append(E_exp)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}