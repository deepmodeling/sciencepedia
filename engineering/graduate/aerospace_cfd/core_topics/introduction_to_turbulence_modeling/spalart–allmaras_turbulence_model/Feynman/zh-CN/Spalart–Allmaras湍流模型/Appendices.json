{
    "hands_on_practices": [
        {
            "introduction": "Spalart-Allmaras模型的核心思想之一是它并不直接求解湍流涡粘性$ \\nu_t $，而是求解一个输运工作变量$ \\tilde{\\nu} $。这个练习旨在阐明模型中的关键一步：如何通过壁面阻尼函数$ f_{v1} $将$ \\tilde{\\nu} $转化为具有物理意义的$ \\nu_t $。通过这个基础计算，你将加深对壁面附近湍流抑制机理及其数学表达的理解 ()。",
            "id": "3995405",
            "problem": "考虑使用计算流体力学(CFD)分析的翼型截面上的稳态不可压缩外流。在单方程Spalart-Allmaras湍流模型中，模型引入了一个工作变量 $\\tilde{\\nu}$，通过一个单调阻尼函数，由此构造出物理上实现的湍流运动粘度 $\\nu_{t}$。该阻尼函数可确保正确的近壁行为，并在远离壁面的区域适当饱和。假设在边界层中的某一点，分子运动粘度为 $\\nu=1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，工作变量为 $\\tilde{\\nu}=3.0\\times 10^{-4}\\,\\mathrm{m^2/s}$，模型常数为 $c_{v1}=7.1$。利用阻尼函数必须满足的标准物理约束条件：（i）当比值 $\\chi=\\tilde{\\nu}/\\nu \\to 0$ 时，函数趋于零，其主导阶依赖关系反映了粘性抑制效应；（ii）当 $\\chi \\to \\infty$ 时，函数趋于1，同时保持为正且单调。请从第一性原理出发，推导粘性阻尼函数的形式，并获得无量纲比值 $\\chi$、阻尼函数 $f_{v1}$ 和湍流运动粘度 $\\nu_{t}$ 的表达式。然后，根据给定状态对它们进行数值计算。\n\n将 $\\chi$、$f_{v1}$ 和 $\\nu_{t}$ 的计算结果均四舍五入至四位有效数字。将 $\\nu_{t}$ 以 $\\mathrm{m^2/s}$ 为单位表示。仅按 $\\chi$、$f_{v1}$、$\\nu_{t}$ 的顺序列出最终数值（不带单位）。",
            "solution": "该问题是有效的。它在科学上基于成熟的Spalart-Allmaras湍流模型，内容自洽，并为获得唯一解提供了所有必要数据。关于从“第一性原理”“推导”阻尼函数的要求，应在湍流建模的背景下理解，即这类函数是根据经验构建的，旨在满足一系列物理约束。因此，此处的推导包括陈述标准的模型函数，并证明其满足所需约束。\n\nSpalart-Allmaras模型是一个单方程模型，它求解一个关于工作变量 $\\tilde{\\nu}$ 的输运方程。该变量与湍流运动粘度 $\\nu_t$ 相关，但并不等同于它。物理湍流粘度是通过一个包含近壁阻尼效应的关系式得到的。\n\n问题定义了以下关键量：\n- 分子运动粘度, $\\nu$。\n- 模型输运方程中的工作变量, $\\tilde{\\nu}$。\n- 湍流运动粘度, $\\nu_t$。\n- 无量纲比值 $\\chi \\equiv \\frac{\\tilde{\\nu}}{\\nu}$。\n- 一个粘性阻尼函数, $f_{v1}(\\chi)$。\n\n这些量之间的关系由模型结构给出：\n$$ \\nu_t = \\tilde{\\nu} f_{v1}(\\chi) $$\n函数 $f_{v1}$ 对于正确模拟湍流边界层中的粘性层和缓冲层至关重要，在这些层中，分子粘度的影响占主导地位并抑制湍流。问题给出了该函数必须满足的物理约束：\n1.  当 $\\chi \\to 0$ 时（即非常靠近固体壁面，此处 $\\tilde{\\nu} \\to 0$），函数必须趋于零，$f_{v1} \\to 0$，以表示粘性力对湍流的抑制作用。\n2.  当 $\\chi \\to \\infty$ 时（即远离壁面的完全湍流区），函数必须趋近于1，$f_{v1} \\to 1$，从而使湍流粘度与输运变量成正比，$\\nu_t \\to \\tilde{\\nu}$。\n3.  对于 $\\chi > 0$，函数必须为正且单调。\n\n一个满足这些约束的函数并非从基本物理定律推导而来，而是基于经验数据和期望的数学行为所做出的建模选择。在Spalart-Allmaras模型中使用的、包含了模型常数 $c_{v1}$ 的标准形式是：\n$$ f_{v1}(\\chi) = \\frac{\\chi^3}{\\chi^3 + c_{v1}^3} $$\n让我们验证此形式是否符合给定的约束。\n1.  当 $\\chi \\to 0$ 时的极限：\n    $$ \\lim_{\\chi\\to 0} f_{v1}(\\chi) = \\lim_{\\chi\\to 0} \\frac{\\chi^3}{\\chi^3 + c_{v1}^3} = \\frac{0}{0 + c_{v1}^3} = 0 $$\n    其主导阶依赖关系与 $\\chi^3$ 成正比，反映了强烈的粘性抑制。此约束得到满足。\n2.  当 $\\chi \\to \\infty$ 时的极限：\n    $$ \\lim_{\\chi\\to\\infty} f_{v1}(\\chi) = \\lim_{\\chi\\to\\infty} \\frac{\\chi^3}{\\chi^3 + c_{v1}^3} = \\lim_{\\chi\\to\\infty} \\frac{1}{1 + c_{v1}^3/\\chi^3} = \\frac{1}{1 + 0} = 1 $$\n    此约束得到满足。\n3.  对于 $\\chi > 0$ 时的正性和单调性：\n    对于 $\\chi > 0$ 和 $c_{v1} > 0$，分子 $\\chi^3$ 和分母 $\\chi^3 + c_{v1}^3$ 均为正，因此 $f_{v1}(\\chi) > 0$。为检验单调性，我们计算其关于 $\\chi$ 的导数：\n    $$ \\frac{df_{v1}}{d\\chi} = \\frac{(3\\chi^2)(\\chi^3 + c_{v1}^3) - (\\chi^3)(3\\chi^2)}{(\\chi^3 + c_{v1}^3)^2} = \\frac{3\\chi^5 + 3\\chi^2c_{v1}^3 - 3\\chi^5}{(\\chi^3 + c_{v1}^3)^2} = \\frac{3c_{v1}^3\\chi^2}{(\\chi^3 + c_{v1}^3)^2} $$\n    由于 $c_{v1} = 7.1 > 0$ 且 $\\chi^2 \\ge 0$，导数 $\\frac{df_{v1}}{d\\chi} \\ge 0$ 对所有 $\\chi$ 成立。因此该函数是单调不减的。此约束得到满足。\n\n在证明了 $f_{v1}$ 形式的合理性之后，我们现在列出所需的表达式：\n- $\\chi$ 的表达式：$\\chi = \\frac{\\tilde{\\nu}}{\\nu}$\n- $f_{v1}$ 的表达式：$f_{v1} = \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}$\n- $\\nu_t$ 的表达式：$\\nu_t = \\tilde{\\nu} f_{v1} = \\tilde{\\nu} \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}$\n\n现在，我们使用给定的数值来计算这些量：\n- 分子运动粘度：$\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n- 工作变量：$\\tilde{\\nu} = 3.0 \\times 10^{-4}\\,\\mathrm{m^2/s}$\n- 模型常数：$c_{v1} = 7.1$\n\n首先，我们计算无量纲比值 $\\chi$：\n$$ \\chi = \\frac{3.0 \\times 10^{-4}}{1.5 \\times 10^{-5}} = \\frac{3.0}{1.5} \\times 10^{-4 - (-5)} = 2.0 \\times 10^1 = 20 $$\n按要求四舍五入到四位有效数字，$\\chi = 20.00$。\n\n接下来，我们计算在该 $\\chi$ 值下的阻尼函数 $f_{v1}$：\n$$ f_{v1} = \\frac{20^3}{20^3 + 7.1^3} = \\frac{8000}{8000 + 357.911} = \\frac{8000}{8357.911} \\approx 0.957161... $$\n四舍五入到四位有效数字，$f_{v1} \\approx 0.9572$。\n\n最后，我们计算湍流运动粘度 $\\nu_t$：\n$$ \\nu_t = \\tilde{\\nu} f_{v1} = (3.0 \\times 10^{-4}) \\times (0.957161...) \\approx 2.87148... \\times 10^{-4}\\,\\mathrm{m^2/s} $$\n四舍五入到四位有效数字，$\\nu_t \\approx 2.871 \\times 10^{-4}\\,\\mathrm{m^2/s}$。\n\n最终的数值结果，按要求四舍五入到四位有效数字，是：\n- $\\chi = 20.00$\n- $f_{v1} = 0.9572$\n- $\\nu_t = 2.871 \\times 10^{-4}\\,\\mathrm{m^2/s}$",
            "answer": "$$\\boxed{\\begin{pmatrix} 20.00 & 0.9572 & 2.871 \\times 10^{-4} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在理解了与壁面相关的函数后，本练习将探讨在实际CFD模拟中一个常见且关键的误差来源：壁面距离$ d $的精确计算。Spalart-Allmaras模型中的耗散项对$ d $的取值高度敏感，不准确的$ d $会直接影响湍流预测的可靠性。这个定性分析练习将挑战你像CFD工程师一样思考，追踪一个不准确的输入如何通过模型物理最终影响到对边界层分离等关键现象的预测 ()。",
            "id": "3995382",
            "problem": "航空航天计算流体动力学依赖于雷诺平均纳维-斯托克斯 (Reynolds-Averaged Navier–Stokes, RANS) 封闭模型来模拟边界层中的湍流剪切。许多单方程模型，包括 Spalart-Allmaras 湍流模型，会根据到最近固体边界的距离（记为 $d$）来构造一个近壁长度尺度，以便在壁面附近抑制模拟的涡粘性，并强制壁面剪切应力具有正确的渐近行为。考虑一个绕 $2\\text{D}$ 翼型的不可压外部流动，翼型弦长为 $c$，攻角 $\\alpha = 8^\\circ$，基于弦长的雷诺数 $Re_c = 5\\times 10^6$，自由来流马赫数为 $M_\\infty = 0.2$。计算积分至壁面（无壁面函数）。进行了两次计算：一次使用通过求解程函方程 (Eikonal equation) $|\\nabla D| = 1$（在壁面上 $D=0$）计算得到的测地壁面距离场 $d(x,y)$，并设 $d=D$；另一次将 $d$ 替换为一个代数“光滑距离”，该距离在压力面 $x/c \\in [0.5,0.8]$ 的一个带状区域内低估了真实测地距离约 $20\\%$（这是由于在凹曲率处和尾缘附近的平滑处理所致）。假设外部流动在该带状区域上施加了逆压梯度。\n\n使用边界层原理和混合长度尺度分析，分析在逆压梯度区域低估 $d$ 会如何影响模拟的湍流剪切和最终的积分边界层行为，并找出适用于检测因使用近似 $d$ 而产生误差的诊断方法。使用以下定义：摩擦系数 $C_f(x) = 2\\tau_w(x)/(\\rho_\\infty U_\\infty^2)$，其中壁面剪切应力 $\\tau_w = \\mu (\\partial U/\\partial y)|_{w}$；位移厚度 $\\delta^\\*(x) = \\int_0^\\infty \\left(1 - U/U_e\\right)\\,\\mathrm{d}y$；动量厚度 $\\theta(x) = \\int_0^\\infty \\left(U/U_e\\right)\\left(1 - U/U_e\\right)\\,\\mathrm{d}y$；以及形状因子 $H(x) = \\delta^\\*/\\theta$。分离起始点由 $\\tau_w(x_s) \\to 0^+$ 且 $C_f(x)$ 改变符号的第一个位置 $x_s$ 确定。对于近壁诊断，使用 $u_\\tau(x) = \\sqrt{\\tau_w/\\rho_\\infty}$、$y^+ = y\\,u_\\tau/\\nu$ 和 $U^+ = U/u_\\tau$，并回想一个良好解析的湍流对数区满足 $U^+ \\approx (1/\\kappa)\\ln y^+ + B$（对于 $y^+ \\in [30,300]$），其中 $\\kappa$ 和 $B$ 是常数。\n\n哪个选项最好地描述了在 $x/c \\in [0.5,0.8]$ 区域用低估的代数“光滑距离”替换 $d$ 的预期定性影响，并提出了检测由此产生的误差的可靠诊断方法？\n\nA. 低估 $d$ 会降低近壁区和缓冲区的模拟涡粘性，在逆压梯度下削弱湍流的动量输运，从而增加 $H(x)$ 和 $\\delta^\\*(x)$，减小 $C_f(x)$，并使分离起始点向上游移动（$x_s$ 更小）。诊断方法应包括：通过求解 $|\\nabla D|=1$（在壁面上 $D=0$）来直接验证 $d$ 并将 $D$ 与代数 $d$ 进行比较；在附着流区域通过 $U^+(y^+)$ 评估近壁剖面，检查其是否偏离 $U^+ \\approx (1/\\kappa)\\ln y^+ + B$；以及沿弦长追踪 $H(x)$ 和 $C_f(x)$ 的非物理趋势。\n\nB. 低估 $d$ 会增加模拟的涡粘性，在逆压梯度下增强湍流的动量输运，从而减小 $H(x)$ 和 $\\delta^\\*(x)$，增加 $C_f(x)$，并使分离起始点向下游移动（$x_s$ 更大）。诊断方法可仅限于比较积分力，如升力 $C_L$ 和阻力 $C_D$，并确保 Courant–Friedrichs–Lewy 数保持在 1 以下。\n\nC. Spalart–Allmaras 模型对 $d$ 的选择不敏感，因此用代数“光滑距离”替换 $d$ 不会显著影响 $H(x)$、$\\delta^\\*(x)$、$C_f(x)$ 或 $x_s$。诊断只需确保第一个单元格高度处处满足 $y^+  1$ 并且残差单调下降。\n\nD. 使用低估的 $d$ 主要破坏无粘外部解，而边界层厚度 $\\delta(x)$、壁面摩擦 $C_f(x)$ 和分离起始点 $x_s$ 基本保持不变。诊断应关注远场压力系数 $C_p$ 和全局质量守恒，因为基于壁面的度量对 $d$ 的误差不敏感。\n\n选择唯一的最佳选项。",
            "solution": "该问题要求对在翼型流动模拟的特定区域中使用 Spalart–Allmaras (S-A) 湍流模型时，低估壁面距离 $d$ 的影响进行定性分析，并要求找出检测此类误差的适用诊断方法。\n\n### 第一步：问题验证\n\n根据科学原理和逻辑一致性对问题陈述进行验证。\n\n- **提取的已知条件：**\n  - **流动：** 不可压 ($M_\\infty = 0.2$)，绕 $2\\text{D}$ 翼型的外部流动。\n  - **条件：** 弦长 $c$，攻角 $\\alpha = 8^\\circ$，雷诺数 $Re_c = 5\\times 10^6$。\n  - **数值设置：** 壁面解析的雷诺平均纳维-斯托克斯 (RANS) 模拟（无壁面函数）。\n  - **建模误差：** 使用代数“光滑距离”作为壁面距离 $d$，该距离在压力面 $x/c \\in [0.5,0.8]$ 的区域内低估了真实测地距离约 $20\\%$。\n  - **流动物理：** 在指定的目标区域存在逆压梯度。\n  - **定义：** 提供了摩擦系数 $C_f(x)$、位移厚度 $\\delta^\\*(x)$、动量厚度 $\\theta(x)$、形状因子 $H(x)$、分离起始点 $x_s$ 以及壁面尺度变量 $u_\\tau, y^+, U^+$ 的标准定义。\n  - **参考行为：** 引用了湍流对数律 $U^+ \\approx (1/\\kappa)\\ln y^+ + B$ 作为良好解析的湍流边界层的基准。\n\n- **验证：**\n  1.  **科学依据：** 该问题牢固地根植于计算流体动力学 (CFD) 和湍流建模领域。Spalart–Allmaras 模型、其对壁面距离 $d$ 的依赖性、来自程函方程 $|\\nabla D|=1$ 的测地距离概念、逆压梯度下的边界层理论以及所提供的定义都是标准且符合事实的。\n  2.  **良态性：** 该问题对于定性分析是良态的（well-posed）。它清晰地定义了一个参考案例（真实的测地 $d$）和一个测试案例（低估的 $d$），并要求分析其物理后果和诊断方法。其因果关系可从第一性原理进行分析。\n  3.  **客观性：** 语言技术性强、精确且无主观性。使用近似壁面距离导致误差的情景是 CFD 中一个现实且实际的问题。\n\n- **结论：** 问题有效。它在科学上是合理的，问题定义明确，客观，并提出了一个植根于湍流模型实际应用的非平凡挑战。\n\n### 第二步：解的推导\n\n分析通过检查 Spalart–Allmaras 模型的结构及其与边界层物理的耦合来进行。\n\n1.  **壁面距离 ($d$) 在 Spalart–Allmaras 模型中的作用：**\n    S-A 模型为一个工作变量 $\\tilde{\\nu}$ 求解一个输运方程，该变量与湍流涡粘性 $\\nu_t$ 相关。$\\tilde{\\nu}$ 的输运方程形式如下：\n    $$ \\frac{D\\tilde{\\nu}}{Dt} = \\text{产生项} - \\text{破坏项} + \\text{扩散项} $$\n    主要在近壁区起作用的“破坏项”关键地依赖于壁面距离 $d$。该项表示为：\n    $$ \\text{破坏项} = C_{w1} f_w \\left(\\frac{\\tilde{\\nu}}{d}\\right)^2 $$\n    其中 $C_{w1}$ 是一个模型常数，$f_w$ 是一个混合函数。关键的依赖关系是 $(\\tilde{\\nu}/d)^2$ 因子。该项旨在当接近固体边界时减小湍流粘性，以确保正确的渐近行为。\n\n2.  **低估 $d$ 的影响：**\n    问题陈述指出，在目标区域，模拟中使用的代数距离 $d_{alg}$ 低估了真实的测地距离 $d_{geo}$，即 $d_{alg}  d_{geo}$。\n    - 由于 $d$ 出现在破坏项的分母中，低估 $d$（使用 $d_{alg}$）会导致对比例 $1/d$ 的高估。\n    - 因此，整个与 $(\\tilde{\\nu}/d)^2$ 成正比的破坏项被人为地 **增大** 了。\n\n3.  **对湍流粘性 ($\\nu_t$) 的影响：**\n    $\\tilde{\\nu}$ 的输运方程在产生项和破坏项之间取得平衡（在局部平衡区域）。一个被人为增大的破坏项会抑制所能维持的 $\\tilde{\\nu}$ 水平。较低的 $\\tilde{\\nu}$ 值直接导致较低的湍流涡粘性 $\\nu_t$ 值，因为在 S-A 模型中，$\\nu_t = \\tilde{\\nu} f_{v1}(\\chi)$，其中 $f_{v1}$ 是一个阻尼函数。\n    因此，低估 $d$ 会导致模拟的涡粘性 $\\nu_t$ **减小**。\n\n4.  **对逆压梯度 (APG) 下边界层的影响：**\n    湍流涡粘性 $\\nu_t$ 参数化了湍流剪切应力 $\\tau_t \\approx \\rho \\nu_t (\\partial U / \\partial y)$。该剪切应力代表了湍流脉动对动量的输运。\n    - 减小的 $\\nu_t$ 意味着 **湍流动量输运减弱**。湍流涡在将边界层外部的高动量流体与壁面附近的低动量流体混合方面的效率降低。\n    - 逆压梯度 ($dP/dx > 0$) 天然地会使边界层内的流动减速，使其更容易发生分离。湍流混合是通过为近壁流动重新注入能量来抵抗这种趋势的主要机制。\n    - 随着湍流混合的减弱，边界层抵抗 APG 的能力下降。这会导致：\n        - **近壁流体减速更迅速。** 速度剖面 $U(y)$ 变得不那么“饱满”。\n        - **位移厚度 $\\delta^\\*(x)$ 增加：** 随着剖面变得不那么饱满，速度亏损 $(1 - U/U_e)$ 增加，导致更大的 $\\delta^\\*(x) = \\int_0^\\infty (1 - U/U_e)\\,\\mathrm{d}y$。\n        - **形状因子 $H(x)$ 增加：** 形状因子 $H = \\delta^\\*/\\theta$ 是速度剖面饱满程度的直接度量。一个不那么饱满的剖面会导致更高的 $H$，表明流动更接近分离。\n        - **壁面剪切应力 $\\tau_w$ 和壁面摩擦系数 $C_f(x)$ 减小：** 一个不那么饱满的剖面在壁面 ($y=0$) 处的速度梯度 $(\\partial U/\\partial y)$ 更小，这直接减小了 $\\tau_w$ 和 $C_f$。\n        - **分离起始点 ($x_s$) 的上游移动：** 由于在受影响区域内各处的 $C_f(x)$ 都更低，$C_f(x)$ 降至零的点——即分离点 $x_s$——将会更早达到，即在更小的 $x/c$ 值处。分离被过早地预测。\n\n5.  **检测误差的适用诊断方法：**\n    一个严谨的实践者会采用多管齐下的方法来诊断此类问题。\n    - **直接输入验证：** 最基本的检查是验证模型的输入。在这种情况下，应该计算正确的测地距离场，例如通过求解程函方程 $|\\nabla D|=1$，并将其与模拟中实际使用的代数距离场 $d$ 进行比较。绘制两个场的等值线图将立即揭示差异。\n    - **基本物理验证：** S-A 模型与其他 RANS 模型一样，是为再现典型的湍流流动而校准的。一个关键基准是在附着流、平衡区域的壁面律 $U^+ \\approx (1/\\kappa)\\ln y^+ + B$。以壁面单位绘制速度剖面（$U^+$ vs. $y^+$）是一种标准且强大的诊断工具。$d$ 的误差会破坏 $\\nu_t$ 剖面，进而扭曲平均速度剖面。这种扭曲将表现为与预期对数律的偏离，从而表明湍流模型的应用存在问题。\n    - **工程量分析：** 上面推导出的物理后果——$C_f(x)$ 过早下降和 $H(x)$ 过早上升，以及提前分离——本身就是关键的诊断指标。沿翼型表面追踪这些量，并观察非物理趋势或与预期行为（或与修正后模拟）的显著偏差，是识别建模误差的主要方法。\n\n### 第三步：逐项分析选项\n\n-   **A. 低估 $d$ 会降低近壁区和缓冲区的模拟涡粘性，在逆压梯度下削弱湍流的动量输运，从而增加 $H(x)$ 和 $\\delta^\\*(x)$，减小 $C_f(x)$，并使分离起始点向上游移动（$x_s$ 更小）。诊断方法应包括：通过求解 $|\\nabla D|=1$（在壁面上 $D=0$）来直接验证 $d$ 并将 $D$ 与代数 $d$ 进行比较；在附着流区域通过 $U^+(y^+)$ 评估近壁剖面，检查其是否偏离 $U^+ \\approx (1/\\kappa)\\ln y^+ + B$；以及沿弦长追踪 $H(x)$ 和 $C_f(x)$ 的非物理趋势。**\n    该选项正确地指出了因果链：低估 $d \\implies$ 减小 $\\nu_t \\implies$ 混合减弱 $\\implies$ 分离趋势增加（更高的 $H, \\delta^*$；更低的 $C_f$；更小的 $x_s$）。它还提出了一套全面且专业可靠的诊断方法，涵盖了输入验证、基本物理检查以及积分工程量的分析。这与推导出的解决方案完全一致。\n    **结论：正确。**\n\n-   **B. 低估 $d$ 会增加模拟的涡粘性，在逆压梯度下增强湍流的动量输运，从而减小 $H(x)$ 和 $\\delta^\\*(x)$，增加 $C_f(x)$，并使分离起始点向下游移动（$x_s$ 更大）。诊断方法可仅限于比较积分力，如升力 $C_L$ 和阻力 $C_D$，并确保 Courant–Friedrichs–Lewy 数保持在 1 以下。**\n    初始前提有误。低估 $d$ 会 *减小* 而非增加涡粘性。因此，所有后续的物理后果都是相反的。所提议的诊断方法不足；像 $C_L$ 和 $C_D$ 这样的积分力可能会掩盖局部误差，而 CFL 数是一个数值稳定性判据，不是物理模型验证工具。\n    **结论：错误。**\n\n-   **C. Spalart–Allmaras 模型对 $d$ 的选择不敏感，因此用代数“光滑距离”替换 $d$ 不会显著影响 $H(x)$、$\\delta^\\*(x)$、$C_f(x)$ 或 $x_s$。诊断只需确保第一个单元格高度处处满足 $y^+  1$ 并且残差单调下降。**\n    这一说法根本上是错误的。S-A 模型通过其破坏项明确且敏感地依赖于 $d$。所提议的诊断方法（$y^+1$ 和收敛的残差）是良好模拟的必要条件，但完全不足以诊断此类物理建模误差。\n    **结论：错误。**\n\n-   **D. 使用低估的 $d$ 主要破坏无粘外部解，而边界层厚度 $\\delta(x)$、壁面摩擦 $C_f(x)$ 和分离起始点 $x_s$ 基本保持不变。诊断应关注远场压力系数 $C_p$ 和全局质量守恒，因为基于壁面的度量对 $d$ 的误差不敏感。**\n    $d$ 的误差是近壁建模误差，因此其主要影响 *在边界层上*，而不是无粘外部解。像 $C_f(x)$ 这样的壁面度量正是对这种误差最敏感的量。所提议的诊断方法是错误的。\n    **结论：错误。**\n\n基于详尽的分析，选项 A 提供了唯一科学正确的物理效应描述和适当的诊断程序。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在掌握了模型的物理概念及其实际应用中的敏感性之后，最后一个练习将深入探讨其数值求解过程的“幕后细节”。本练习聚焦于Spalart-Allmaras方程中具有特定非线性结构的扩散项。通过实践有限体积法离散化，你将学会如何处理可变系数和边界条件，并分析由此产生的矩阵系统特性，从而深入了解影响CFD求解器稳定性和效率的关键因素 ()。",
            "id": "3995359",
            "problem": "给定 Spalart–Allmaras (SA) 模型中修正的湍动运动粘度的稳态输运方程，该方程为一个二维 ($2$D) 区域上关于守恒变量 $\\tilde{\\nu}$ 的方程，其中扩散项包含一个变系数梯度的散度和一个非线性交叉扩散源。从散度定理和控制体表面通量的定义出发，推导作用于 $\\tilde{\\nu}$ 的扩散算子的有限体积、单元中心、正交笛卡尔离散格式，并假设系数场由前一个非线性迭代步冻结。具体来说，使用以下物理上合理且被广泛接受的 SA 模型和离散化基础：\n\n- SA 模型的扩散项可以写成\n$$\n\\frac{1}{\\sigma}\\nabla\\cdot\\left((\\nu+\\tilde{\\nu})\\nabla \\tilde{\\nu}\\right) + \\frac{c_{b2}}{\\sigma}\\left|\\nabla \\tilde{\\nu}\\right|^2,\n$$\n其中 $\\nu$ 是分子运动粘度，$\\sigma$ 和 $c_{b2}$ 是常数，$\\tilde{\\nu}$ 是修正的湍动运动粘度。当使用严格为正的系数场进行离散化时，散度项产生一个对称正定线性算子，而交叉扩散项产生一个非线性源。\n- 散度定理将控制体上的散度积分转换为面通量之和。\n- 对于间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀笛卡尔网格，两点通量近似对于正交网格是一致的，其中面法向梯度通过相邻单元中心点之间的距离上的差商来近似，面系数通过调和平均来计算，以保持通量连续性。\n- 狄利克雷边界条件通过消除虚拟单元值，并使用单元到边界的半间距来添加一致的对角项和源项贡献来施加，而齐次诺伊曼边界条件施加边界上的扩散通量为零。\n\n令冻结系数定义为\n$$\na(\\boldsymbol{x})=\\frac{\\nu+\\tilde{\\nu}(\\boldsymbol{x})}{\\sigma},\n$$\n其中 $\\sigma=\\frac{2}{3}$ 且 $\\nu$ 已指定。离散算子可以写成矩阵形式\n$$\n\\mathbf{A}\\,\\boldsymbol{\\phi}=\\boldsymbol{b},\n$$\n其中 $\\boldsymbol{\\phi}$ 汇集了 $\\tilde{\\nu}$ 的单元中心值，$\\mathbf{A}$ 是离散扩散矩阵，$\\boldsymbol{b}$ 是离散源向量，包括狄利克雷边界贡献和非线性交叉扩散源项\n$$\ns_{\\mathrm{cd}}=\\frac{c_{b2}}{\\sigma}\\left|\\nabla \\tilde{\\nu}\\right|^2,\n$$\n该项在单元中心使用中心差分计算。矩阵 $\\mathbf{A}$ 仅依赖于几何、连接关系和冻结系数 $a(\\boldsymbol{x})$，并且在结构化二维网格上具有典型的五点格式结构。\n\n你的任务是：\n\n- 使用两点通量近似，推导在间距为 $\\Delta x$ 和 $\\Delta y$ 的笛卡尔网格上，内部面和边界面上的格式系数。你的推导必须从散度定理开始，并为每个面生成矩阵贡献，包括在内部面正确使用调和平均，在狄利克雷边界正确使用半间距。\n- 解释为什么当施加至少一个狄利克雷边界条件时，对于严格为正的 $a(\\boldsymbol{x})$，得到的矩阵 $\\mathbf{A}$ 是对称正定的，以及为什么在纯齐次诺伊曼边界条件下它会变得奇异。同时，解释非线性交叉扩散源 $s_{\\mathrm{cd}}$ 的作用，以及为什么在非线性迭代过程中，它不应包含在线性求解器的 $\\mathbf{A}$ 中，而应包含在右端项 $\\boldsymbol{b}$ 中。\n- 实现一个程序，对于给定的冻结系数场 $a(\\boldsymbol{x})$ 和边界条件，在均匀笛卡尔网格上组装 $\\mathbf{A}$，然后计算量化诊断指标。\n\n使用以下常数和输入作为测试套件的三个测试用例：\n\n- 使用空气运动粘度 $\\nu=1.5\\times 10^{-5}\\ \\mathrm{m}^2/\\mathrm{s}$ 和 SA 常数 $\\sigma=\\frac{2}{3}$。对于交叉扩散源，使用 $c_{b2}=0.622$。\n- 用例 $1$ (理想情况，对称正定)：$\\Delta x=\\Delta y=0.01\\ \\mathrm{m}$，一个 $4\\times 4$ 网格，所有四个边界均为狄利克雷边界，$\\tilde{\\nu}=1.0\\times 10^{-5}\\ \\mathrm{m}^2/\\mathrm{s}$，以及一个均匀的冻结场 $\\tilde{\\nu}(\\boldsymbol{x})=5.0\\times 10^{-5}\\ \\mathrm{m}^2/\\mathrm{s}$，因此 $a(\\boldsymbol{x})$ 在空间上是常数。\n- 用例 $2$ (边界情况，纯诺伊曼条件)：与用例 $1$ 相同的网格和间距，但所有四个边界均为齐次诺伊曼边界（法向梯度为零），冻结场与用例 $1$ 相同；在此情况下，$\\mathbf{A}$ 应为奇异矩阵。\n- 用例 $3$ (系数对比，条件数)：$\\Delta x=0.01\\ \\mathrm{m}$，$\\Delta y=0.005\\ \\mathrm{m}$，一个 $6\\times 3$ 网格，所有四个边界均为狄利克雷边界，$\\tilde{\\nu}=1.0\\times 10^{-5}\\ \\mathrm{m}^2/\\mathrm{s}$，以及一个分段常数冻结场，定义为对于 $i < N_x/2$ 的单元 $\\tilde{\\nu}=1.0\\times 10^{-6}\\ \\mathrm{m}^2/\\mathrm{s}$，否则 $\\tilde{\\nu}=1.0\\times 10^{-3}\\ \\mathrm{m}^2/\\mathrm{s}$，其中 $i$ 是 $x$ 方向上从零开始的单元索引，$N_x$ 是 $x$ 方向的单元数。\n\n你的程序必须：\n\n- 使用五点格式组装每个用例的矩阵 $\\mathbf{A}$，其中内部面使用调和平均，狄利克雷边界使用半间距加权。将齐次诺伊曼边界视为空通量面，不产生矩阵或源项的贡献。不要在 $\\mathbf{A}$ 中包含 Spalart–Allmaras 模型的任何对流项或产生/耗散项；只有在计算交叉扩散项 $s_{\\mathrm{cd}}$ 时才将其放入右端项 $\\boldsymbol{b}$，但下面的诊断仅涉及 $\\mathbf{A}$。\n- 对于用例 $1$，计算相对对称偏差 $\\left\\|\\mathbf{A}-\\mathbf{A}^{\\mathsf{T}}\\right\\|_F/\\left\\|\\mathbf{A}\\right\\|_F$（无量纲）和 $\\mathbf{A}$ 的最小特征值（单位为 $\\mathrm{m}^2/\\mathrm{s}$）。\n- 对于用例 $2$，计算 $\\mathbf{A}$ 的最小特征值（单位为 $\\mathrm{m}^2/\\mathrm{s}$）和一个布尔值，当且仅当矩阵是数值奇异时为 $\\mathrm{True}$，这通过最小特征值是否小于最大对角线元素的 $10^{-12}$ 倍来确定。\n- 对于用例 $3$，计算谱条件数 $\\kappa(\\mathbf{A})=\\lambda_{\\max}/\\lambda_{\\min}$（无量纲），其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 分别是 $\\mathbf{A}$ 的最大和最小特征值。\n\n本问题中的所有特征值必须以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位表示，而相对对称偏差和条件数是无量纲的。你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，按以下顺序排列结果：\n$$\n\\left[\\text{symmetry\\_error\\_case1},\\ \\text{min\\_eig\\_case1},\\ \\text{min\\_eig\\_case2},\\ \\text{is\\_singular\\_case2},\\ \\text{cond\\_case3}\\right].\n$$",
            "solution": "该问题要求推导和实现 Spalart–Allmaras 湍流模型扩散算子的有限体积离散化，分析所得矩阵的性质，并为三个测试用例计算特定的数值诊断指标。\n\n### 有限体积离散化的推导\n\n修正的湍动运动粘度 $\\tilde{\\nu}$ 的稳态输运方程包含一个扩散项，为解决此问题，该项被分离为 $\\nabla \\cdot (a(\\boldsymbol{x}) \\nabla \\tilde{\\nu})$，其中系数 $a(\\boldsymbol{x}) = (\\nu + \\tilde{\\nu}(\\boldsymbol{x}))/\\sigma$ 被认为是冻结的。在推导中，场 $\\tilde{\\nu}$ 用通用变量 $\\phi$ 表示。\n\n我们应用有限体积法，将该项在一个通用控制体（单元）$\\Omega_P$ 上积分，其体积为 $V_P$：\n$$\n\\int_{\\Omega_P} \\nabla \\cdot (a \\nabla \\phi) \\, dV\n$$\n使用散度定理，此体积积分被转换为控制体各表面 $S_f$ 上的通量之和：\n$$\n\\int_{\\Omega_P} \\nabla \\cdot (a \\nabla \\phi) \\, dV = \\sum_{f} \\int_{S_f} (a \\nabla \\phi) \\cdot \\boldsymbol{n}_f \\, dS = \\sum_{f} F_f\n$$\n其中 $\\boldsymbol{n}_f$ 是面 $f$ 的向外法向量，$F_f$ 是通过该面的总通量。对于间距为 $\\Delta x$ 和 $\\Delta y$ 的二维笛卡尔网格，以 $P=(i,j)$ 为中心的单元的控制体是一个面积为 $V_P = \\Delta x \\Delta y$ 的矩形。其表面分别指定为东 (e)、西 (w)、北 (n) 和南 (s)。\n\n通过一个面的通量使用两点格式来近似。对于将单元 $P$ 与其东侧邻居 $E$ 分开的东面，其通量为：\n$$\nF_e = \\int_{S_e} (a \\nabla \\phi) \\cdot \\boldsymbol{n}_e \\, dS \\approx a_e (\\nabla \\phi)_e \\cdot \\boldsymbol{S}_e\n$$\n这里，$\\boldsymbol{S}_e = \\Delta y \\, \\boldsymbol{i}$ 是面矢量。法向梯度 $(\\nabla \\phi)_e \\cdot \\boldsymbol{n}_e$ 通过相邻单元中心之间的中心差分来近似：\n$$\n(\\nabla \\phi)_e \\cdot \\boldsymbol{n}_e \\approx \\frac{\\phi_E - \\phi_P}{\\Delta x}\n$$\n面上的系数 $a_e$ 使用单元中心值 $a_P$ 和 $a_E$ 的调和平均来计算，以确保在 $a(\\boldsymbol{x})$ 不连续时通量的连续性：\n$$\na_e = \\frac{2 a_P a_E}{a_P + a_E}\n$$\n结合这些，通过东面的通量为：\n$$\nF_e \\approx \\left(\\frac{2 a_P a_E}{a_P + a_E}\\right) \\frac{\\phi_E - \\phi_P}{\\Delta x} \\Delta y\n$$\n单元 $P$ 的离散方程将流出通量之和与积分源项 $s_P V_P$ 相等。离开单元 $P$ 的通量总和是 $F_e + F_w + F_n + F_s$。线性系统写作 $\\mathbf{A}\\boldsymbol{\\phi}=\\boldsymbol{b}$。单元 $P$ 的矩阵行是通过收集 $\\phi_P$ 及其邻居的系数形成的。从单元 $P$ 到邻居 $F$ 的通量项 $F_f$ 对通量和的贡献是一个与 $(\\phi_F - \\phi_P)$ 成正比的项。我们将系统写成 $\\sum (\\text{系数}) \\phi = \\text{源项}$，因此我们根据各项乘以哪个 $\\phi_j$ 来对它们进行分组。东面对单元 $P$ 方程的贡献是：\n$$\n- \\left[ \\left(\\frac{2 a_P a_E}{a_P + a_E}\\right) \\frac{\\Delta y}{\\Delta x} \\right] \\phi_E + \\left[ \\left(\\frac{2 a_P a_E}{a_P + a_E}\\right) \\frac{\\Delta y}{\\Delta x} \\right] \\phi_P\n$$\n第一项贡献给非对角矩阵元素 $A_{P,E}$，第二项贡献给对角元素 $A_{P,P}$。对一个内部单元 $P(i,j)$ 的所有四个面（东、西、南、北）的贡献求和，得到五点格式的系数：\n-   $A_{P,P} = \\left(\\frac{a_e \\Delta y}{\\Delta x}\\right) + \\left(\\frac{a_w \\Delta y}{\\Delta x}\\right) + \\left(\\frac{a_n \\Delta x}{\\Delta y}\\right) + \\left(\\frac{a_s \\Delta x}{\\Delta y}\\right)$\n-   $A_{P,E} = - \\frac{a_e \\Delta y}{\\Delta x}$\n-   $A_{P,W} = - \\frac{a_w \\Delta y}{\\Delta x}$\n-   $A_{P,N} = - \\frac{a_n \\Delta x}{\\Delta y}$\n-   $A_{P,S} = - \\frac{a_s \\Delta x}{\\Delta y}$\n其中 $a_e$、$a_w$、$a_n$、$a_s$ 分别是 $a_P$ 与 $a_E$、$a_W$、$a_N$、$a_S$ 的调和平均值。\n\n**边界条件：**\n\n-   **齐次诺伊曼边界：** 零法向梯度 $\\nabla\\phi\\cdot\\boldsymbol{n}=0$ 意味着通过边界面上的通量为零。对于处于此类边界（例如西边界）上的单元 $P$，通量 $F_w$ 为零。因此，该面对矩阵元素 $A_{P,P}$ 或 $A_{P,W}$ 没有贡献。这通过不对不存在的邻居计算通量来自然处理。\n\n-   **狄利克雷边界：** 对于邻近具有指定值 $\\phi_b$ 的边界的单元 $P$，通量在半间距 $\\Delta x/2$（对于东/西边界）上近似。对于西边界，通量为：\n    $$\n    F_w \\approx a_P \\frac{\\phi_P - \\phi_b}{\\Delta x/2} \\Delta y\n    $$\n    这里，面系数 $a_w$ 取为单元中心值 $a_P$。该通量对单元 $P$ 的离散方程有贡献。与 $\\phi_P$ 成正比的项修改了 $\\mathbf{A}$ 的对角元素，而与已知值 $\\phi_b$ 成正比的项则移到右端的源向量 $\\boldsymbol{b}$ 中。对对角元 $A_{P,P}$ 的贡献是增加 $a_P \\frac{2\\Delta y}{\\Delta x}$。对源向量 $b_P$ 的贡献是增加 $(a_P \\frac{2\\Delta y}{\\Delta x})\\phi_b$。\n\n### 矩阵性质与非线性项\n\n**A 的对称性：** 矩阵 $\\mathbf{A}$ 是对称的。考虑元素 $A_{P,E}$，它是单元 $P$ 方程中 $\\phi_E$ 的系数。它等于 $-a_e \\frac{\\Delta y}{\\Delta x}$。元素 $A_{E,P}$ 是单元 $E$ 方程中 $\\phi_P$ 的系数。它来自于通过单元 $E$ 的西面的通量，该面与单元 $P$ 的东面是同一个面。计算得出 $A_{E,P} = -a_e \\frac{\\Delta y}{\\Delta x}$。由于 $A_{P,E} = A_{E,P}$，并且由于调和平均的对称定义和网格的正交性，这对于所有相邻对都成立，所以矩阵 $\\mathbf{A}$ 是对称的。\n\n**正定性与奇异性：**\n对于一个严格为正的系数场 $a(\\boldsymbol{x})>0$，$\\mathbf{A}$ 的非对角元素均为非正值（对于 $P \\neq F$ 有 $A_{P,F} \\le 0$），而对角元素为正值（$A_{P,P} > 0$）。\n-   对于一个内部单元，对角元素是其所在行非对角元素绝对值之和：$A_{P,P} = \\sum_{F\\neq P} |A_{P,F}|$。\n-   当施加至少一个狄利克雷边界条件时，至少存在一个对应于边界单元的行，其中对角项严格大于非对角项绝对值之和。例如，对于位于西狄利克雷边界的单元 $P$，$A_{P,P} = |A_{P,E}| + |A_{P,N}| + |A_{P,S}| + a_P\\frac{2\\Delta y}{\\Delta x}$。这个性质，被称为不可约对角占优，保证了矩阵是非奇异的，并且其所有特征值都为正。一个所有特征值都为正的对称矩阵是正定的。\n-   在纯齐次诺伊曼边界条件下，每个边界面上的通量都为零。因此，对于矩阵中的每一行，对角元素都精确地等于非对角元素绝对值之和，即行和为零：$\\sum_F A_{P,F} = 0$。这意味着一个常数向量 $\\boldsymbol{\\phi}=(c, c, \\dots, c)^T$ 位于 $\\mathbf{A}$ 的零空间中，因为 $(\\mathbf{A}\\boldsymbol{\\phi})_P = \\sum_F A_{P,F} \\phi_F = c \\sum_F A_{P,F} = 0$。一个非平凡的零空间意味着矩阵是奇异的，并且至少有一个零特征值。\n\n**交叉扩散源项的作用：**\n项 $s_{\\mathrm{cd}}=\\frac{c_{b2}}{\\sigma}\\left|\\nabla \\tilde{\\nu}\\right|^2$ 是一个非线性源项。它与解变量 $\\tilde{\\nu}$ 的梯度呈二次方关系。目标是求解形如 $\\mathbf{A}\\boldsymbol{\\phi}=\\boldsymbol{b}$ 的线性系统，其中 $\\mathbf{A}$ 是一个常数矩阵。如果将 $s_\\mathrm{cd}$ 包含在左侧的算子中，得到的算子将是非线性的，即 $\\mathbf{A}(\\boldsymbol{\\phi})\\boldsymbol{\\phi}=\\boldsymbol{b}$，这无法用标准的线性求解器求解。为了处理这种非线性，使用了一种迭代方法（如 Picard 迭代）。非线性项被“滞后”处理，即使用前一次迭代的解 $\\tilde{\\nu}^{(k)}$ 来计算它们，并在求解当前迭代解 $\\tilde{\\nu}^{(k+1)}$ 时将其视为右端项 $\\boldsymbol{b}$ 中的已知源项。这在每个迭代步中都将问题线性化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef assemble_A(Nx, Ny, dx, dy, a_field, bc_types):\n    \"\"\"\n    Assembles the discrete diffusion matrix A for a 2D Cartesian grid.\n\n    Args:\n        Nx (int): Number of cells in x-direction.\n        Ny (int): Number of cells in y-direction.\n        dx (float): Grid spacing in x-direction.\n        dy (float): Grid spacing in y-direction.\n        a_field (np.ndarray): 2D array (Ny, Nx) of the frozen coefficient 'a'.\n        bc_types (dict): Dictionary specifying boundary conditions for 'north', 'south',\n                         'east', 'west'. 'D' for Dirichlet, 'N' for Neumann.\n\n    Returns:\n        np.ndarray: The assembled N x N matrix A, where N = Nx * Ny.\n    \"\"\"\n    N = Nx * Ny\n    A = np.zeros((N, N))\n\n    for j in range(Ny):\n        for i in range(Nx):\n            k = i + j * Nx  # Row-major index for cell (i, j)\n            ap = a_field[j, i]\n\n            # East face\n            if i  Nx - 1:\n                k_E = (i + 1) + j * Nx\n                a_E = a_field[j, i + 1]\n                a_e = 2 * ap * a_E / (ap + a_E)\n                coeff = a_e * dy / dx\n                A[k, k] += coeff\n                A[k, k_E] -= coeff\n            elif bc_types['east'] == 'D':\n                coeff = ap * 2 * dy / dx\n                A[k, k] += coeff\n\n            # West face\n            if i > 0:\n                k_W = (i - 1) + j * Nx\n                a_W = a_field[j, i - 1]\n                a_w = 2 * ap * a_W / (ap + a_W)\n                coeff = a_w * dy / dx\n                A[k, k] += coeff\n                A[k, k_W] -= coeff\n            elif bc_types['west'] == 'D':\n                coeff = ap * 2 * dy / dx\n                A[k, k] += coeff\n            \n            # North face\n            if j  Ny - 1:\n                k_N = i + (j + 1) * Nx\n                a_N = a_field[j + 1, i]\n                a_n = 2 * ap * a_N / (ap + a_N)\n                coeff = a_n * dx / dy\n                A[k, k] += coeff\n                A[k, k_N] -= coeff\n            elif bc_types['north'] == 'D':\n                coeff = ap * 2 * dx / dy\n                A[k, k] += coeff\n\n            # South face\n            if j > 0:\n                k_S = i + (j - 1) * Nx\n                a_S = a_field[j - 1, i]\n                a_s = 2 * ap * a_S / (ap + a_S)\n                coeff = a_s * dx / dy\n                A[k, k] += coeff\n                A[k, k_S] -= coeff\n            elif bc_types['south'] == 'D':\n                coeff = ap * 2 * dx / dy\n                A[k, k] += coeff\n    \n    return A\n\ndef solve():\n    nu = 1.5e-5  # m^2/s\n    sigma = 2.0 / 3.0\n    \n    results = []\n\n    # Case 1\n    Nx1, Ny1 = 4, 4\n    dx1, dy1 = 0.01, 0.01\n    bc1 = {'north': 'D', 'south': 'D', 'east': 'D', 'west': 'D'}\n    nu_tilde_frozen1 = 5.0e-5\n    a_field1 = np.full((Ny1, Nx1), (nu + nu_tilde_frozen1) / sigma)\n    \n    A1 = assemble_A(Nx1, Ny1, dx1, dy1, a_field1, bc1)\n    \n    sym_err1 = np.linalg.norm(A1 - A1.T, 'fro') / np.linalg.norm(A1, 'fro')\n    eigvals1 = np.linalg.eigvalsh(A1)\n    min_eig1 = np.min(eigvals1)\n    \n    results.extend([sym_err1, min_eig1])\n\n    # Case 2\n    Nx2, Ny2 = 4, 4\n    dx2, dy2 = 0.01, 0.01\n    bc2 = {'north': 'N', 'south': 'N', 'east': 'N', 'west': 'N'}\n    nu_tilde_frozen2 = 5.0e-5\n    a_field2 = np.full((Ny2, Nx2), (nu + nu_tilde_frozen2) / sigma)\n    \n    A2 = assemble_A(Nx2, Ny2, dx2, dy2, a_field2, bc2)\n    \n    eigvals2 = np.linalg.eigvalsh(A2)\n    min_eig2 = np.min(eigvals2)\n    \n    tol = 1e-12 * np.max(np.diag(A2))\n    is_singular2 = np.abs(min_eig2)  tol\n    \n    results.extend([min_eig2, is_singular2])\n\n    # Case 3\n    Nx3, Ny3 = 6, 3\n    dx3, dy3 = 0.01, 0.005\n    bc3 = {'north': 'D', 'south': 'D', 'east': 'D', 'west': 'D'}\n    \n    a_field3 = np.zeros((Ny3, Nx3))\n    nu_tilde_low = 1.0e-6\n    nu_tilde_high = 1.0e-3\n    a_low = (nu + nu_tilde_low) / sigma\n    a_high = (nu + nu_tilde_high) / sigma\n    \n    a_field3[:, :Nx3 // 2] = a_low\n    a_field3[:, Nx3 // 2:] = a_high\n    \n    A3 = assemble_A(Nx3, Ny3, dx3, dy3, a_field3, bc3)\n    \n    eigvals3 = np.linalg.eigvalsh(A3)\n    min_eig3 = np.min(eigvals3)\n    max_eig3 = np.max(eigvals3)\n    cond_num3 = max_eig3 / min_eig3\n    \n    results.append(cond_num3)\n\n    # Format and print the final output\n    print(f\"[{results[0]},{results[1]},{results[2]},{results[3]},{results[4]}]\")\n\nsolve()\n```"
        }
    ]
}