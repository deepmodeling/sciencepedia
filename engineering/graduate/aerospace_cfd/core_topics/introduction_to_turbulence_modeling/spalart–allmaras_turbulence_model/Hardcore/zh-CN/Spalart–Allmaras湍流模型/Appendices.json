{
    "hands_on_practices": [
        {
            "introduction": "Spalart-Allmaras模型的核心是求解一个输运方程，其求解的变量并非物理上的湍流粘度$\\nu_t$，而是一个工作变量$\\tilde{\\nu}$。本练习将引导你通过一个关键的粘性阻尼函数$f_{v1}$，将模型变量$\\tilde{\\nu}$转化为物理上真实的湍流粘度$\\nu_t$。掌握这一核心计算，是正确理解和分析S-A模型仿真结果的第一步。",
            "id": "3995405",
            "problem": "考虑使用计算流体动力学（CFD）分析的翼型截面上的稳态不可压缩外流。在单方程Spalart–Allmaras湍流模型中，该模型引入了一个工作变量 $\\tilde{\\nu}$，通过一个单调阻尼函数，由此构造出物理上实现的湍流运动粘度 $\\nu_{t}$。该阻尼函数可确保正确的近壁行为，并在远离壁面的区域适当饱和。假设在边界层中的某一点，分子运动粘度为 $\\nu=1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，工作变量为 $\\tilde{\\nu}=3.0\\times 10^{-4}\\,\\mathrm{m^2/s}$，模型常数为 $c_{v1}=7.1$。利用阻尼函数必须满足的标准物理约束：(i) 当比率 $\\chi=\\tilde{\\nu}/\\nu \\to 0$ 时，函数必须趋于零，其主阶依赖性反映了粘性抑制；(ii) 当 $\\chi \\to \\infty$ 时，函数必须趋于1，同时保持为正且单调。请基于第一性原理推导粘性阻尼函数的形式，并得到无量纲比 $\\chi$、阻尼函数 $f_{v1}$ 和湍流运动粘度 $\\nu_{t}$ 的表达式。然后在给定状态下对它们进行数值计算。\n\n将 $\\chi$、$f_{v1}$ 和 $\\nu_{t}$ 各自四舍五入到四位有效数字。以 $\\mathrm{m^2/s}$ 为单位表示 $\\nu_{t}$。仅按 $\\chi$、$f_{v1}$、$\\nu_{t}$ 的顺序提供最终数值（不带单位）。",
            "solution": "该问题是有效的。它在科学上基于成熟的Spalart–Allmaras湍流模型，内容自洽，并为获得唯一解提供了所有必要数据。关于从“第一性原理”“推导”阻尼函数的要求，应在湍流建模的背景下进行解读，其中此类函数是根据经验构建的，以满足一系列物理约束。因此，推导过程包括陈述标准模型函数并证明其满足所需约束。\n\nSpalart–Allmaras模型是一个单方程模型，它求解一个关于工作变量 $\\tilde{\\nu}$ 的输运方程。这个变量与湍流运动粘度 $\\nu_t$ 相关，但并不与之完全相同。物理上的湍流粘度是通过一个包含近壁阻尼效应的关系式得到的。\n\n问题定义了以下关键量：\n- 分子运动粘度, $\\nu$。\n- 模型输运方程中的工作变量, $\\tilde{\\nu}$。\n- 湍流运动粘度, $\\nu_t$。\n- 无量纲比 $\\chi \\equiv \\frac{\\tilde{\\nu}}{\\nu}$。\n- 粘性阻尼函数, $f_{v1}(\\chi)$。\n\n这些量之间的关系由模型结构给出：\n$$ \\nu_t = \\tilde{\\nu} f_{v1}(\\chi) $$\n函数 $f_{v1}$ 对于正确模拟湍流边界层的粘性层和缓冲层至关重要，在这些区域，分子粘度的影响占主导地位并抑制湍流。问题给出了该函数必须满足的物理约束：\n1.  当 $\\chi \\to 0$ 时（即非常靠近固体壁面，此时 $\\tilde{\\nu} \\to 0$），函数必须趋于零，即 $f_{v1} \\to 0$，以表示粘性力对湍流的抑制作用。\n2.  当 $\\chi \\to \\infty$ 时（即在完全湍流区远离壁面），函数必须趋于1，即 $f_{v1} \\to 1$，从而使湍流粘度与输运变量成正比，$\\nu_t \\to \\tilde{\\nu}$。\n3.  对于 $\\chi > 0$，函数必须为正且单调。\n\n满足这些约束的函数并非从基本物理定律推导而来，而是基于经验数据和期望的数学行为所做出的建模选择。在Spalart–Allmaras模型中使用的标准形式（其中包含了模型常数 $c_{v1}$）是：\n$$ f_{v1}(\\chi) = \\frac{\\chi^3}{\\chi^3 + c_{v1}^3} $$\n我们来验证这个形式是否遵循给定的约束。\n1.  当 $\\chi \\to 0$ 时的极限：\n    $$ \\lim_{\\chi\\to 0} f_{v1}(\\chi) = \\lim_{\\chi\\to 0} \\frac{\\chi^3}{\\chi^3 + c_{v1}^3} = \\frac{0}{0 + c_{v1}^3} = 0 $$\n    主阶依赖性与 $\\chi^3$ 成正比，反映了强烈的粘性抑制。此约束得到满足。\n2.  当 $\\chi \\to \\infty$ 时的极限：\n    $$ \\lim_{\\chi\\to\\infty} f_{v1}(\\chi) = \\lim_{\\chi\\to\\infty} \\frac{\\chi^3}{\\chi^3 + c_{v1}^3} = \\lim_{\\chi\\to\\infty} \\frac{1}{1 + c_{v1}^3/\\chi^3} = \\frac{1}{1 + 0} = 1 $$\n    此约束得到满足。\n3.  对于 $\\chi > 0$ 的正性和单调性：\n    对于 $\\chi > 0$ 和 $c_{v1} > 0$，分子 $\\chi^3$ 和分母 $\\chi^3 + c_{v1}^3$ 均为正，因此 $f_{v1}(\\chi) > 0$。为检验单调性，我们计算其对 $\\chi$ 的导数：\n    $$ \\frac{df_{v1}}{d\\chi} = \\frac{(3\\chi^2)(\\chi^3 + c_{v1}^3) - (\\chi^3)(3\\chi^2)}{(\\chi^3 + c_{v1}^3)^2} = \\frac{3\\chi^5 + 3\\chi^2c_{v1}^3 - 3\\chi^5}{(\\chi^3 + c_{v1}^3)^2} = \\frac{3c_{v1}^3\\chi^2}{(\\chi^3 + c_{v1}^3)^2} $$\n    由于 $c_{v1} = 7.1 > 0$ 且 $\\chi^2 \\ge 0$，导数 $\\frac{df_{v1}}{d\\chi} \\ge 0$ 对所有 $\\chi$ 成立。因此该函数是单调不减的。此约束得到满足。\n\n在证明了 $f_{v1}$ 形式的合理性之后，我们现在列出所要求的表达式：\n- $\\chi$ 的表达式：$\\chi = \\frac{\\tilde{\\nu}}{\\nu}$\n- $f_{v1}$ 的表达式：$f_{v1} = \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}$\n- $\\nu_t$ 的表达式：$\\nu_t = \\tilde{\\nu} f_{v1} = \\tilde{\\nu} \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}$\n\n现在，我们使用给定的数值来计算这些量：\n- 分子运动粘度：$\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n- 工作变量：$\\tilde{\\nu} = 3.0 \\times 10^{-4}\\,\\mathrm{m^2/s}$\n- 模型常数：$c_{v1} = 7.1$\n\n首先，我们计算无量纲比 $\\chi$：\n$$ \\chi = \\frac{3.0 \\times 10^{-4}}{1.5 \\times 10^{-5}} = \\frac{3.0}{1.5} \\times 10^{-4 - (-5)} = 2.0 \\times 10^1 = 20 $$\n按要求四舍五入到四位有效数字，$\\chi = 20.00$。\n\n接下来，我们计算在该 $\\chi$ 值下的阻尼函数 $f_{v1}$：\n$$ f_{v1} = \\frac{20^3}{20^3 + 7.1^3} = \\frac{8000}{8000 + 357.911} = \\frac{8000}{8357.911} \\approx 0.957161... $$\n四舍五入到四位有效数字， $f_{v1} \\approx 0.9572$。\n\n最后，我们计算湍流运动粘度 $\\nu_t$：\n$$ \\nu_t = \\tilde{\\nu} f_{v1} = (3.0 \\times 10^{-4}) \\times (0.957161...) \\approx 2.87148... \\times 10^{-4}\\,\\mathrm{m^2/s} $$\n四舍五入到四位有效数字，$\\nu_t \\approx 2.871 \\times 10^{-4}\\,\\mathrm{m^2/s}$。\n\n最终的数值结果，按要求四舍五入到四位有效数字，是：\n- $\\chi = 20.00$\n- $f_{v1} = 0.9572$\n- $\\nu_t = 2.871 \\times 10^{-4}\\,\\mathrm{m^2/s}$",
            "answer": "$$\\boxed{\\begin{pmatrix} 20.00  0.9572  2.871 \\times 10^{-4} \\end{pmatrix}}$$"
        },
        {
            "introduction": "像Spalart-Allmaras这样的RANS模型包含许多经验常数，但这些常数并非随意设定。本练习将揭示模型常数的校准过程，即要求模型能够精确再现经典的壁面律（logarithmic law of the wall）。通过亲手推导近壁破坏项的关键系数$c_{w1}$，你将深刻理解该模型如何植根于成熟的湍流理论，从而对其物理基础建立更强的信心。",
            "id": "3995423",
            "problem": "考虑光滑平板上稳态、完全发展的零压力梯度湍流边界层，该边界层在计算流体动力学 (CFD) 的雷诺平均 Navier-Stokes (RANS) 框架内，使用单方程 Spalart–Allmaras (SA) 湍流模型进行建模。在内部高雷诺数区域，假设修正涡粘性 $\\tilde{\\nu}$ 渐近等于湍流涡粘性，壁面距离为 $d \\approx y$，且壁面函数渐近线满足 $f_{w} \\to 1$。经典的壁面律对数律意味着平均剪切标度为 $S \\sim u_{\\tau}/(\\kappa y)$，其中 $u_{\\tau}$ 是摩擦速度，$\\kappa$ 是 von Kármán 常数。SA 输运方程包含一个与 $c_{b1}\\,S\\,\\tilde{\\nu}$ 成正比的产生项，一个由模型常数 $\\sigma$ 和 $c_{b2}$ 控制的扩散贡献，以及一个与 $c_{w1}(\\tilde{\\nu}/d)^{2}$ 成正比的近壁面耗散项。通过要求内层剖面 $\\tilde{\\nu}(y)=\\kappa\\,u_{\\tau}\\,y$ 在此区域是稳态一维 SA 输运方程的精确平衡解，推导壁面耗散系数 $c_{w1}$ 关于模型常数 $c_{b1}$、$c_{b2}$、$\\sigma$ 和 von Kármán 常数 $\\kappa$ 的显式表达式。然后，使用 $c_{b1}=0.1355$、$c_{b2}=0.622$、$\\sigma=2/3$ 和 $\\kappa=0.41$ 计算 $c_{w1}$ 的数值。将您的答案四舍五入至四位有效数字。将最终结果表示为无量纲数。此外，简要解释计算出的 $c_{w1}$ 的量级在内层中产生、扩散和耗散之间平衡的背景下的意义。",
            "solution": "该问题要求通过在湍流边界层的对数区域施加平衡条件来推导 Spalart–Allmaras (SA) 模型常数 $c_{w1}$。\n\n单方程 SA 模型输运修正的湍流粘性 $\\tilde{\\nu}$。对于稳态、完全发展的零压力梯度湍流边界层，$\\tilde{\\nu}$ 的输运方程可以通过只考虑沿壁面法向方向 $y$ 的变化来简化。在这种一维形式下，忽略对流，该方程表示产生项 ($\\mathcal{P}$)、耗散项 ($\\mathcal{D}$) 和湍流输运项 ($\\mathcal{T}$) 之间的局部平衡：\n$$\n\\mathcal{P} - \\mathcal{D} + \\mathcal{T} = 0\n$$\n在高雷诺数假设下（分子粘性 $\\nu$ 与 $\\tilde{\\nu}$ 相比可以忽略不计），这些项的标准形式为：\n- 产生项: $\\mathcal{P} = c_{b1} S \\tilde{\\nu}$\n- 耗散项: $\\mathcal{D} = c_{w1} f_w \\left(\\frac{\\tilde{\\nu}}{d}\\right)^2$\n- 输运项: $\\mathcal{T} = \\frac{1}{\\sigma}\\left[\\frac{\\partial}{\\partial y}\\left((\\nu+\\tilde{\\nu})\\frac{\\partial\\tilde{\\nu}}{\\partial y}\\right) + c_{b2}\\left(\\frac{\\partial\\tilde{\\nu}}{\\partial y}\\right)^2\\right] \\approx \\frac{1}{\\sigma}\\left[\\frac{\\partial}{\\partial y}\\left(\\tilde{\\nu}\\frac{\\partial\\tilde{\\nu}}{\\partial y}\\right) + c_{b2}\\left(\\frac{\\partial\\tilde{\\nu}}{\\partial y}\\right)^2\\right]$\n\n展开输运表达式中的类散度项得到：\n$$\n\\mathcal{T} = \\frac{1}{\\sigma}\\left[ \\left(\\frac{\\partial\\tilde{\\nu}}{\\partial y}\\right)^2 + \\tilde{\\nu}\\frac{\\partial^2\\tilde{\\nu}}{\\partial y^2} + c_{b2}\\left(\\frac{\\partial\\tilde{\\nu}}{\\partial y}\\right)^2 \\right] = \\frac{1}{\\sigma}\\left[ (1+c_{b2})\\left(\\frac{\\partial\\tilde{\\nu}}{\\partial y}\\right)^2 + \\tilde{\\nu}\\frac{\\partial^2\\tilde{\\nu}}{\\partial y^2} \\right]\n$$\n该问题为内部高雷诺数区域（对数律层）指定了以下条件和假设：\n1.  平均剪切由壁面律给出：$S \\approx |\\frac{\\partial u}{\\partial y}| = \\frac{u_{\\tau}}{\\kappa y}$，其中 $u_{\\tau}$ 是摩擦速度，$\\kappa$ 是 von Kármán 常数。\n2.  修正涡粘性遵循与对数律一致的线性剖面：$\\tilde{\\nu}(y) = \\kappa u_{\\tau} y$。\n3.  壁面距离 $d$ 由壁面法向坐标近似：$d \\approx y$。\n4.  壁面耗散函数 $f_w$ 趋近于 1：$f_w \\to 1$。\n\n我们需要将这个给定的 $\\tilde{\\nu}(y)$ 剖面代入平衡方程，并求解 $c_{w1}$。首先，我们计算 $\\tilde{\\nu}(y)$ 的必要导数：\n$$\n\\frac{\\partial\\tilde{\\nu}}{\\partial y} = \\frac{\\partial}{\\partial y}(\\kappa u_{\\tau} y) = \\kappa u_{\\tau}\n$$\n$$\n\\frac{\\partial^2\\tilde{\\nu}}{\\partial y^2} = \\frac{\\partial}{\\partial y}(\\kappa u_{\\tau}) = 0\n$$\n现在，我们将这些导数代入 $\\mathcal{P}$、$\\mathcal{D}$ 和 $\\mathcal{T}$ 的表达式中：\n\n- 产生项：\n$$\n\\mathcal{P} = c_{b1} S \\tilde{\\nu} = c_{b1} \\left(\\frac{u_{\\tau}}{\\kappa y}\\right) (\\kappa u_{\\tau} y) = c_{b1} u_{\\tau}^2\n$$\n\n- 耗散项：\n$$\n\\mathcal{D} = c_{w1} f_w \\left(\\frac{\\tilde{\\nu}}{d}\\right)^2 \\approx c_{w1} (1) \\left(\\frac{\\kappa u_{\\tau} y}{y}\\right)^2 = c_{w1} (\\kappa u_{\\tau})^2 = c_{w1} \\kappa^2 u_{\\tau}^2\n$$\n\n- 输运项：\n$$\n\\mathcal{T} = \\frac{1}{\\sigma}\\left[ (1+c_{b2})\\left(\\kappa u_{\\tau}\\right)^2 + (\\kappa u_{\\tau} y)(0) \\right] = \\frac{(1+c_{b2})\\kappa^2 u_{\\tau}^2}{\\sigma}\n$$\n将这些项代回平衡方程 $\\mathcal{P} - \\mathcal{D} + \\mathcal{T} = 0$ 中：\n$$\nc_{b1} u_{\\tau}^2 - c_{w1} \\kappa^2 u_{\\tau}^2 + \\frac{(1+c_{b2})\\kappa^2 u_{\\tau}^2}{\\sigma} = 0\n$$\n由于湍流边界层的 $u_{\\tau} \\neq 0$，我们可以将整个方程除以 $u_{\\tau}^2$：\n$$\nc_{b1} - c_{w1} \\kappa^2 + \\frac{(1+c_{b2})\\kappa^2}{\\sigma} = 0\n$$\n该方程提供了对数律平衡所需的模型常数之间的代数关系。我们现在求解 $c_{w1}$：\n$$\nc_{w1} \\kappa^2 = c_{b1} + \\frac{(1+c_{b2})\\kappa^2}{\\sigma}\n$$\n$c_{w1}$ 的显式表达式为：\n$$\nc_{w1} = \\frac{c_{b1}}{\\kappa^2} + \\frac{1+c_{b2}}{\\sigma}\n$$\n接下来，我们使用给定的常数计算 $c_{w1}$ 的数值：$c_{b1}=0.1355$、$c_{b2}=0.622$、$\\sigma=2/3$ 和 $\\kappa=0.41$。\n$$\nc_{w1} = \\frac{0.1355}{(0.41)^2} + \\frac{1+0.622}{\\frac{2}{3}}\n$$\n$$\nc_{w1} = \\frac{0.1355}{0.1681} + \\frac{1.622}{\\frac{2}{3}}\n$$\n$$\nc_{w1} = 0.806067816... + 1.622 \\times \\frac{3}{2}\n$$\n$$\nc_{w1} = 0.806067816... + 2.433\n$$\n$$\nc_{w1} = 3.239067816...\n$$\n四舍五入到四位有效数字，我们得到：\n$$\nc_{w1} \\approx 3.239\n$$\n这个值是无量纲的，表达式中所有的常数也都是无量纲的。\n\n为了进行解释，对数律层中的平衡是 $\\mathcal{D} = \\mathcal{P} + \\mathcal{T}$。$c_{w1}$ 的值经过校准以确保这种平衡。对平衡的相对贡献（由 $u_{\\tau}^2$ 归一化）是：$\\mathcal{P}/u_{\\tau}^2 = c_{b1} = 0.1355$ 和 $\\mathcal{T}/u_{\\tau}^2 = \\frac{(1+c_{b2})\\kappa^2}{\\sigma} \\approx 0.4090$。耗散项必须平衡它们的和：$\\mathcal{D}/u_{\\tau}^2 = c_{w1}\\kappa^2 = 0.1355 + 0.4090 = 0.5445$。推导出的 $c_{w1} \\approx 3.239$ 的值确保了耗散项，在乘以小因子 $\\kappa^2 \\approx 0.1681$ 后，足够大以抵消 $\\tilde{\\nu}$ 的直接产生，以及更重要的，抵消 $\\tilde{\\nu}$ 的强扩散输运（在此区域充当源项）。因此，$c_{w1}$ 的量级比其他常数（如 $c_{b1}$）大，是根据对数律进行校准以及耗散项特定数学形式的直接结果。",
            "answer": "$$\n\\boxed{3.239}\n$$"
        },
        {
            "introduction": "理解了模型的物理原理后，我们必须关注其在CFD求解器中的数值实现。本练习聚焦于S-A模型输运方程的求解，特别是对流项的离散方法。你将通过编程实践，对比一个简洁但数值不稳定的中心差分格式与一个能保证解的物理真实性（如粘度非负）的高级TVD格式，从而直观地认识到数值方法的选择对仿真结果的稳定性和准确性有多么重要。",
            "id": "3995388",
            "problem": "考虑 Spalart–Allmaras 湍流模型（Spalart–Allmaras, SA）的工作变量 $\\tilde{\\nu}$ 在周期性域上、均匀平均对流速度 $u$ 下的一维输运。忽略扩散项和源项，仅关注由线性平流方程控制的纯对流过程\n$$\n\\frac{\\partial \\tilde{\\nu}}{\\partial t} + u \\frac{\\partial \\tilde{\\nu}}{\\partial x} = 0,\n$$\n该方程建立在空间域 $x \\in [0,1]$ 上，并采用周期性边界条件。设计算网格为均匀网格，包含 $N$ 个单元，单元尺寸为 $\\Delta x = 1/N$，单元中心位于 $x_i = \\left(i+\\tfrac{1}{2}\\right)\\Delta x$（其中整数 $i \\in \\{0,1,\\dots,N-1\\}$），离散时间层为 $t^n$，时间步长为常数 $\\Delta t$。定义库朗数 $C = u \\Delta t / \\Delta x$。出于数值稳定性的考虑，$C$ 被限制为满足 $0  C \\le 1$。定义在时间 $t^n$ 的离散单元平均解为 $\\tilde{\\nu}_i^n \\approx \\frac{1}{\\Delta x}\\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} \\tilde{\\nu}(x,t^n)\\,dx$。\n\n你需要分析、实现并比较两种用于 $\\tilde{\\nu}$ 对流项更新的格式：\n1. 一种中心差分显式格式（时间向前，空间居中），其更新方式定义为\n$$\n\\tilde{\\nu}_i^{n+1} = \\tilde{\\nu}_i^n - \\frac{u \\Delta t}{2 \\Delta x}\\left(\\tilde{\\nu}_{i+1}^n - \\tilde{\\nu}_{i-1}^n\\right),\n$$\n这等价于在单元面上使用中心通量，\n$$\nF_{i+\\frac{1}{2}}^n = u \\left(\\frac{\\tilde{\\nu}_{i}^n + \\tilde{\\nu}_{i+1}^n}{2}\\right), \\quad \\tilde{\\nu}_i^{n+1} = \\tilde{\\nu}_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right).\n$$\n2. 一种带有斜率限制器的总变差递减（TVD）迎风格式，其通过使用 minmod 限制器在每个面上重构左右状态来定义，\n$$\n\\Delta_i^- = \\tilde{\\nu}_i^n - \\tilde{\\nu}_{i-1}^n, \\quad \\Delta_i^+ = \\tilde{\\nu}_{i+1}^n - \\tilde{\\nu}_i^n,\n$$\n$$\n\\text{minmod}(\\Delta_i^-,\\Delta_i^+) = \\begin{cases}\n\\operatorname{sign}(\\Delta_i^-)\\min\\left(|\\Delta_i^-|,|\\Delta_i^+|\\right),  \\text{if } \\Delta_i^-\\Delta_i^+  0,\\\\\n0,  \\text{otherwise,}\n\\end{cases}\n$$\n和\n$$\n\\tilde{\\nu}_{i+\\frac{1}{2},L}^n = \\tilde{\\nu}_i^n + \\frac{1}{2}\\,\\text{minmod}(\\Delta_i^-,\\Delta_i^+), \\quad\n\\tilde{\\nu}_{i+\\frac{1}{2},R}^n = \\tilde{\\nu}_{i+1}^n - \\frac{1}{2}\\,\\text{minmod}(\\Delta_{i+1}^-,\\Delta_{i+1}^+).\n$$\n采用迎风数值通量，\n$$\nF_{i+\\frac{1}{2}}^n = \n\\begin{cases}\nu\\,\\tilde{\\nu}_{i+\\frac{1}{2},L}^n,  \\text{if } u \\ge 0,\\\\\nu\\,\\tilde{\\nu}_{i+\\frac{1}{2},R}^n,  \\text{if } u  0,\n\\end{cases}\n$$\n更新方式为\n$$\n\\tilde{\\nu}_i^{n+1} = \\tilde{\\nu}_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right).\n$$\n\n从 $\\tilde{\\nu}$ 的基本守恒律和数值通量的标准定义出发，你必须：\n- 从第一性原理推导，为什么在均匀网格上使用时间向前、空间居中的中心差分格式处理对流项会导致伪色散振荡，并可能违反 $\\tilde{\\nu}$ 的正定性，具体方法是通过 Von Neumann 稳定性分析，得出非零波数的放大因子模大于1的结论。\n- 构建使用 minmod 限制器的 TVD 迎风格式，并从有界重构和单调通量的原理出发，证明在 $0  C \\le 1$ 和初始 $\\tilde{\\nu} \\ge 0$ 的条件下，该格式能保持 $\\tilde{\\nu}$ 的正定性。\n\n归一化和单位：令 $\\tilde{\\nu}^\\ast = \\tilde{\\nu}/\\tilde{\\nu}_{\\text{ref}}$ 表示由某个正参考粘度 $\\tilde{\\nu}_{\\text{ref}}$ 归一化后的无量纲形式。所有计算都必须针对无量纲的 $\\tilde{\\nu}^\\ast$ 进行。确保所有初始数据和报告的指标均为无量纲。\n\n将在周期性域上的离散场 $w_i$ 的总变差定义为\n$$\n\\operatorname{TV}(w) = \\sum_{i=0}^{N-1} \\left|w_{i+1} - w_i\\right|,\n$$\n其中使用周期性索引 $w_N = w_0$。\n\n在周期性域上实现这两种格式，并使用三个测试用例。对于每个用例，设置 $u = 1$，$N = 200$，并使用周期性边界条件。单元尺寸为 $\\Delta x = 1/N$。时间步长根据库朗数 $C$ 选择，即 $\\Delta t = C \\Delta x / |u|$。对于每个测试用例，按规定初始化 $t=0$ 时的 $\\tilde{\\nu}^\\ast$，执行固定数量的显式时间步，并计算以下四个指标：中心格式演化后 $\\tilde{\\nu}^\\ast$ 的最小值，TVD 格式演化后 $\\tilde{\\nu}^\\ast$ 的最小值，以及两个布尔值，分别表示中心格式和 TVD 格式的总变差是否相对于初始总变差有所增加。三个测试用例如下：\n\n- 测试用例 1（方波脉冲，中等库朗数）：$N = 200$，$C = 0.5$，步数 $N_s = 50$。初始条件\n$$\n\\tilde{\\nu}^\\ast(x) = \\begin{cases}\n1,  x \\in [0.2, 0.4],\\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n- 测试用例 2（光滑高斯分布，中等库朗数）：$N = 200$，$C = 0.5$，步数 $N_s = 50$。初始条件\n$$\n\\tilde{\\nu}^\\ast(x) = 0.2 + \\exp\\left(-\\left(\\frac{x - 0.5}{0.05}\\right)^2\\right).\n$$\n- 测试用例 3（不连续阶跃，高库朗数）：$N = 200$，$C = 0.9$，步数 $N_s = 20$。初始条件\n$$\n\\tilde{\\nu}^\\ast(x) = \\begin{cases}\n1,  x  0.5,\\\\\n0,  x \\ge 0.5.\n\\end{cases}\n$$\n\n你的程序必须：\n- 严格按照所述实现两种格式，并使用周期性索引。\n- 为每个测试用例计算并记录四个指标：\n    1. 中心格式经过 $N_s$ 步后 $\\min_i \\tilde{\\nu}^\\ast_i$。\n    2. TVD 格式经过 $N_s$ 步后 $\\min_i \\tilde{\\nu}^\\ast_i$。\n    3. 一个布尔值，表示中心格式的 $\\operatorname{TV}(\\tilde{\\nu}^\\ast)$ 是否比其初始值增加。\n    4. 一个布尔值，表示 TVD 格式的 $\\operatorname{TV}(\\tilde{\\nu}^\\ast)$ 是否比其初始值增加。\n- 将所有三个测试用例的结果聚合到指定的最终输出格式中。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含测试用例 1、测试用例 2 和测试用例 3 的结果，每个用例的四个指标连接如下\n$$\n\\left[\\min_{\\text{central},1},\\min_{\\text{TVD},1},\\Delta\\operatorname{TV}_{\\text{central},1}\\!0,\\Delta\\operatorname{TV}_{\\text{TVD},1}\\!0,\\min_{\\text{central},2},\\min_{\\text{TVD},2},\\Delta\\operatorname{TV}_{\\text{central},2}\\!0,\\Delta\\operatorname{TV}_{\\text{TVD},2}\\!0,\\min_{\\text{central},3},\\min_{\\text{TVD},3},\\Delta\\operatorname{TV}_{\\text{central},3}\\!0,\\Delta\\operatorname{TV}_{\\text{TVD},3}\\!0\\right],\n$$\n其中每个 $\\min$ 条目是浮点数，每个 $\\Delta\\operatorname{TV}\\!0$ 条目是布尔值。打印的行必须只包含此列表，不得有任何附加文本。",
            "solution": "该问题定义明确且科学上合理，提出了对线性平流方程两种数值格式的标准分析和比较。我们将首先提供所要求的理论推导，然后进行数值实现。\n\n该问题研究标量 $\\tilde{\\nu}$（Spalart–Allmaras 湍流模型的工作变量）的一维输运，其过程由线性平流方程控制：\n$$\n\\frac{\\partial \\tilde{\\nu}}{\\partial t} + u \\frac{\\partial \\tilde{\\nu}}{\\partial x} = 0\n$$\n其中 $u$ 是一个恒定速度。所有计算都是在无量纲变量 $\\tilde{\\nu}^\\ast$ 上进行的。为清晰起见，在推导中我们将省略上标 $\\ast$，但需理解我们处理的是归一化后的量。\n\n### 中心差分格式的分析\n\n第一种格式是时间向前、空间居中（FTCS）的显式方法。其离散更新方程为：\n$$\n\\tilde{\\nu}_i^{n+1} = \\tilde{\\nu}_i^n - \\frac{u \\Delta t}{2 \\Delta x}\\left(\\tilde{\\nu}_{i+1}^n - \\tilde{\\nu}_{i-1}^n\\right)\n$$\n使用库朗数定义 $C = u \\Delta t / \\Delta x$，方程变为：\n$$\n\\tilde{\\nu}_i^{n+1} = \\tilde{\\nu}_i^n - \\frac{C}{2}\\left(\\tilde{\\nu}_{i+1}^n - \\tilde{\\nu}_{i-1}^n\\right)\n$$\n为了分析其稳定性和色散特性，我们进行 Von Neumann 稳定性分析。我们考虑离散网格上解的单个傅里叶模式：\n$$\n\\tilde{\\nu}_j^n = G^n e^{\\mathrm{i} k j \\Delta x}\n$$\n其中 $j$ 是空间索引，$n$ 是时间索引，$k$ 是波数，$\\mathrm{i}$ 是虚数单位，$G$ 是每个时间步的复放大因子。将此代入格式中得到：\n$$\nG^{n+1} e^{\\mathrm{i} k j \\Delta x} = G^n e^{\\mathrm{i} k j \\Delta x} - \\frac{C}{2}\\left(G^n e^{\\mathrm{i} k (j+1) \\Delta x} - G^n e^{\\mathrm{i} k (j-1) \\Delta x}\\right)\n$$\n两边同除以 $G^n e^{\\mathrm{i} k j \\Delta x}$，得到放大因子 $G$：\n$$\nG = 1 - \\frac{C}{2}\\left(e^{\\mathrm{i} k \\Delta x} - e^{-\\mathrm{i} k \\Delta x}\\right)\n$$\n使用欧拉公式 $e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta} = 2\\mathrm{i}\\sin(\\theta)$，我们得到：\n$$\nG = 1 - \\frac{C}{2}\\left(2\\mathrm{i}\\sin(k \\Delta x)\\right) = 1 - \\mathrm{i} C \\sin(k \\Delta x)\n$$\n一个格式要稳定，其放大因子的模必须对所有波数 $k$ 满足 $|G| \\leq 1$。$G$ 的模的平方为：\n$$\n|G|^2 = 1^2 + (-C \\sin(k \\Delta x))^2 = 1 + C^2 \\sin^2(k \\Delta x)\n$$\n对于任何非零库朗数 $C > 0$ 和任何波数 $k$（只要 $k \\Delta x$ 不是 $\\pi$ 的整数倍，即对于周期性域上除常数模式或奈奎斯特频率外的任何模式），我们都有 $\\sin^2(k \\Delta x) > 0$。因此，$|G|^2 > 1$，这意味着 $|G| > 1$。\n\n这一结果证明，对于线性平流方程，FTCS 格式是**无条件不稳定**的。任何具有非零波数的傅里叶模式的振幅都会随时间指数增长。这种不稳定性表现为伪高频振荡，并最终污染整个解。由于 $\\tilde{\\nu}$ 代表一个必须为非负的物理量（与粘度相关），这些既有正值又有负值的振荡的增长将不可避免地导致非物理的负值出现，从而违反了正定性要求。该格式的纯虚数误差项表明其纯色散的性质，没有任何数值耗散来抑制这些伪振荡。\n\n### TVD 迎风格式的分析\n\n第二种格式是采用总变差递减（TVD）斜率限制器（minmod）的二阶迎风方法。对于 $u > 0$，更新方式为：\n$$\n\\tilde{\\nu}_i^{n+1} = \\tilde{\\nu}_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right)\n$$\n其中数值通量为 $F_{i+\\frac{1}{2}}^n = u\\,\\tilde{\\nu}_{i+\\frac{1}{2},L}^n$。在界面 $i+\\frac{1}{2}$ 处的左重构状态由下式给出：\n$$\n\\tilde{\\nu}_{i+\\frac{1}{2},L}^n = \\tilde{\\nu}_i^n + \\frac{1}{2}\\,\\text{minmod}(\\tilde{\\nu}_i^n - \\tilde{\\nu}_{i-1}^n, \\tilde{\\nu}_{i+1}^n - \\tilde{\\nu}_i^n)\n$$\n保持正定性的理由源于无振荡重构和单调通量的原理。\n\n1.  **有界重构**：minmod 限制器旨在防止产生新的极值，这是无振荡格式的一个关键特性。受限斜率 $\\sigma_i = \\text{minmod}(\\Delta_i^-, \\Delta_i^+)$ 确保了在单元边上重构的值 $\\tilde{\\nu}_{i,L/R}$ 不会“过冲”或“下冲”相邻单元的平均值。具体来说，单元 $i$ 内的分段线性重构（我们称之为 $p_i(x)$）满足：\n    $$\n    \\min(\\tilde{\\nu}_{i-1}^n, \\tilde{\\nu}_i^n, \\tilde{\\nu}_{i+1}^n) \\le p_i(x) \\le \\max(\\tilde{\\nu}_{i-1}^n, \\tilde{\\nu}_i^n, \\tilde{\\nu}_{i+1}^n) \\quad \\text{for } x \\in [x_{i-1/2}, x_{i+1/2}]\n    $$\n    这个属性是核心。如果初始数据是非负的，即对所有 $j$ 都有 $\\tilde{\\nu}_j^n \\ge 0$，那么任何三个相邻单元的局部最小值都是非负的。因此，整个重构剖面 $p(x)$（由所有 $p_i(x)$ 组成）在任何地方都保持非负。\n\n2.  **单调通量与更新**：单元平均值 $\\tilde{\\nu}_i$ 的更新可以解释为在时间步 $\\Delta t$ 内，将重构剖面 $p(x)$ 在一个向上游平移的区域上进行平均。平流方程的精确解为 $\\tilde{\\nu}(x, t^n+\\Delta t) = \\tilde{\\nu}(x - u\\Delta t, t^n)$。在单元 $i$ 上对此进行平均得到：\n    $$\n    \\tilde{\\nu}_i^{n+1} = \\frac{1}{\\Delta x}\\int_{x_{i-1/2}}^{x_{i+1/2}} \\tilde{\\nu}(x-u\\Delta t, t^n) dx = \\frac{1}{\\Delta x}\\int_{x_{i-1/2}-u\\Delta t}^{x_{i+1/2}-u\\Delta t} \\tilde{\\nu}(x', t^n) dx'\n    $$\n    数值格式通过在相同的平移区间上对其自身的重构剖面 $p(x)$ 进行平均来近似这个过程：\n    $$\n    \\tilde{\\nu}_i^{n+1} = \\frac{1}{\\Delta x}\\int_{x_{i-1/2}-u\\Delta t}^{x_{i+1/2}-u\\Delta t} p(x') dx'\n    $$\n    CFL 条件 $0  C = u\\Delta t/\\Delta x \\le 1$ 确保了该积分区间 $[x_{i-1/2}-C\\Delta x, x_{i+1/2}-C\\Delta x]$ 包含在 $[x_{i-1}, x_{i+1}]$ 内。由于如果初始单元平均值为非负，重构剖面 $p(x)$ 也保证为非负，因此 $p(x)$ 在任何子区间上的积分也必须是非负的。因此，$\\tilde{\\nu}_i^{n+1} \\ge 0$。\n\n这从第一性原理证明了，在给定的 CFL 条件下，带有 minmod 限制器的 TVD 迎风格式能够保持正定性。此外，这类格式被设计为总变差递减（或非增）的，即 $\\operatorname{TV}(\\tilde{\\nu}^{n+1}) \\le \\operatorname{TV}(\\tilde{\\nu}^{n})$。这一特性防止了振荡的增长，确保了解的稳定性和物理合理性，尽管相比（不稳定的）中心格式，它会引入更多的数值耗散。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and compares central-differencing and TVD schemes for the\n    1D linear advection equation, based on a simplified Spalart-Allmaras transport.\n    \"\"\"\n\n    def get_initial_condition(case_id, x_coords):\n        \"\"\"Generates the initial condition for each test case.\"\"\"\n        if case_id == 1:\n            # Case 1: Square pulse\n            return np.where((x_coords = 0.2)  (x_coords  0.4), 1.0, 0.0)\n        elif case_id == 2:\n            # Case 2: Smooth Gaussian\n            return 0.2 + np.exp(-((x_coords - 0.5) / 0.05)**2)\n        elif case_id == 3:\n            # Case 3: Discontinuous ramp (step function)\n            return np.where(x_coords  0.5, 1.0, 0.0)\n        else:\n            raise ValueError(\"Invalid case_id\")\n\n    def calculate_tv(w):\n        \"\"\"Calculates the Total Variation of a 1D array with periodic boundaries.\"\"\"\n        w_plus_1 = np.roll(w, -1)\n        return np.sum(np.abs(w_plus_1 - w))\n\n    test_cases = [\n        # (N, Courant, Num_steps, case_id)\n        (200, 0.5, 50, 1),\n        (200, 0.5, 50, 2),\n        (200, 0.9, 20, 3),\n    ]\n\n    all_results = []\n\n    for N, C, N_s, case_id in test_cases:\n        # 1. Setup grid, time step, and initial conditions\n        u = 1.0\n        dx = 1.0 / N\n        dt = C * dx / abs(u)\n        x = (np.arange(N) + 0.5) * dx\n\n        nu_initial = get_initial_condition(case_id, x)\n        nu_central = np.copy(nu_initial)\n        nu_tvd = np.copy(nu_initial)\n\n        tv_initial = calculate_tv(nu_initial)\n        \n        # 2. Time-stepping loop\n        for _ in range(N_s):\n            # --- Central Scheme Update (Forward Time, Central Space) ---\n            # nu_i^{n+1} = nu_i^n - C/2 * (nu_{i+1}^n - nu_{i-1}^n)\n            nu_central_im1 = np.roll(nu_central, 1)  # nu_{i-1}\n            nu_central_ip1 = np.roll(nu_central, -1) # nu_{i+1}\n            \n            nu_central = nu_central - 0.5 * C * (nu_central_ip1 - nu_central_im1)\n\n            # --- TVD Upwind Scheme with minmod limiter ---\n            # nu_i^{n+1} = nu_i^n - (dt/dx) * (F_{i+1/2} - F_{i-1/2})\n            # Since u=1  0, F_{i+1/2} = u * nu_{i+1/2, L}\n            # and dt/dx = C\n            \n            # Calculate slopes\n            nu_tvd_im1 = np.roll(nu_tvd, 1)  # nu_{i-1}\n            nu_tvd_ip1 = np.roll(nu_tvd, -1) # nu_{i+1}\n            \n            delta_minus = nu_tvd - nu_tvd_im1\n            delta_plus = nu_tvd_ip1 - nu_tvd\n\n            # Vectorized minmod limiter\n            s_minus = np.sign(delta_minus)\n            s_plus = np.sign(delta_plus)\n            min_abs = np.minimum(np.abs(delta_minus), np.abs(delta_plus))\n            \n            # minmod(a,b) = sign(a)*min(|a|,|b|) if a*b  0, else 0\n            sigma = np.where(s_minus * s_plus  0, s_minus * min_abs, 0.0)\n\n            # Reconstruct left states at interfaces i+1/2\n            # nu_{i+1/2,L} = nu_i + 0.5 * sigma_i\n            nu_L_at_ip_half = nu_tvd + 0.5 * sigma\n            \n            # Flux F_{i+1/2} (since u=1)\n            F_ip_half = u * nu_L_at_ip_half\n            \n            # Flux F_{i-1/2} by rolling\n            F_im_half = np.roll(F_ip_half, 1)\n            \n            # Update solution\n            nu_tvd = nu_tvd - C * (F_ip_half - F_im_half)\n\n        # 3. Compute final metrics\n        min_central = np.min(nu_central)\n        min_tvd = np.min(nu_tvd)\n        \n        tv_central_final = calculate_tv(nu_central)\n        tv_tvd_final = calculate_tv(nu_tvd)\n\n        # Use a small tolerance for the comparison to handle floating point inaccuracies\n        # A TVD scheme should have TV(n+1) = TV(n).\n        # We check if it strictly increased beyond a small tolerance.\n        tv_increased_central = tv_central_final  tv_initial\n        tv_increased_tvd = tv_tvd_final  tv_initial + 1e-9\n\n        all_results.extend([min_central, min_tvd, tv_increased_central, tv_increased_tvd])\n\n    # 4. Final print statement\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}