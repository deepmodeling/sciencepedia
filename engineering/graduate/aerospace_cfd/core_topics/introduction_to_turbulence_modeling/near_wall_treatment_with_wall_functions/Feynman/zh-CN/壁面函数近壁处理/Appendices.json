{
    "hands_on_practices": [
        {
            "introduction": "在任何壁面束缚的湍流模拟中，正确地模拟近壁区域对于获得准确结果至关重要。决定是解析粘性子层还是使用壁面函数并非随意而为，而是由网格分辨率决定的，我们通过无量纲壁面距离 $y^+$ 来衡量。这项基础练习旨在训练如何根据局部流动参数计算 $y^+$，这是分析和建立有效 RANS 模拟的关键第一步。",
            "id": "3994879",
            "problem": "在一个使用雷诺平均纳维-斯托克斯 (RANS) 框架内的 realizable $k$–$\\varepsilon$ 模型，对光滑圆形管道内空气的充分发展受热内部流动进行的计算流体动力学 (CFD) 模拟中，您正在某一特定轴向位置评估近壁面网格的充分性。根据壁面处的动量平衡和牛顿本构关系，壁面剪切应力决定了一个特征速度尺度，而内尺度 (粘性尺度) 变换则导出一个无量纲壁面距离，该距离用于指导近壁面处理方法的选择。在目标位置，摩擦速度为 $u_{\\tau} = 0.41\\,\\mathrm{m/s}$。从壁面到第一个离壁单元形心的法向距离为 $y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$。在当地的热物理状态下，空气的运动粘度为 $\\nu = 1.50 \\times 10^{-5}\\,\\mathrm{m^2/s}$。请仅使用壁面剪切应力、粘性长度尺度以及与壁面束缚湍流的内尺度变换一致的无量纲化方法的基本定义，计算此单元的内尺度壁面法向坐标 $y^{+}$。然后，根据与 realizable $k$–$\\varepsilon$ 封闭模型中粘性子层解析与对数律层壁面函数适用性相关的既定 $y^{+}$ 范围，说明哪种近壁面方法是合适的，并阐述您的选择理由。将您报告的 $y^{+}$ 值四舍五入至四位有效数字。以无量纲数（无单位）的形式报告 $y^{+}$。您的理由可以引用具有物理意义的范围，但不应包含在最终的数值答案中。",
            "solution": "该问题被验证为是自洽的、有科学依据且良态的。所有必要数据均已提供，其涉及的概念是计算流体动力学和湍流模拟领域的基础。\n\n主要任务是计算紧邻壁面的第一个计算单元的无量纲壁面距离，记为 $y^{+}$。这个量对于在雷诺平均纳维-斯托克斯 (RANS) 模拟中确定合适的近壁面模拟策略至关重要。\n\n在壁面束缚湍流理论中，固体边界附近的区域以流动变量的陡峭梯度为特征。内尺度变换（或称粘性尺度变换）用于对该区域内的变量进行无量纲化。特征尺度源自壁面处流体的性质。\n\n特征速度尺度是摩擦速度 $u_{\\tau}$。它由壁面剪切应力 $\\tau_w$ 和流体密度 $\\rho$ 定义为：\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}$$\n题目直接给出了摩擦速度的值为 $u_{\\tau} = 0.41\\,\\mathrm{m/s}$。\n\n近壁面区域的特征长度尺度是粘性长度尺度，有时也称为“壁面单位”。其定义为：\n$$\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}$$\n其中 $\\nu$ 是流体的运动粘度。\n\n无量纲壁面距离 $y^{+}$ 是指距壁面的物理法向距离 $y$ 用此粘性长度尺度 $\\delta_{\\nu}$ 进行归一化。因此，$y^{+}$ 的定义方程为：\n$$y^{+} = \\frac{y}{\\delta_{\\nu}} = \\frac{y}{\\left(\\frac{\\nu}{u_{\\tau}}\\right)} = \\frac{y u_{\\tau}}{\\nu}$$\n\n题目提供了以下数值：\n从壁面到单元形心的法向距离 $y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$。\n摩擦速度 $u_{\\tau} = 0.41\\,\\mathrm{m/s}$。\n运动粘度 $\\nu = 1.50 \\times 10^{-5}\\,\\mathrm{m^2/s}$。\n\n将这些数值代入 $y^{+}$ 的方程：\n$$y^{+} = \\frac{(5.0 \\times 10^{-5}\\,\\mathrm{m})(0.41\\,\\mathrm{m/s})}{1.50 \\times 10^{-5}\\,\\mathrm{m^2/s}}$$\n正如对无量纲量的预期，单位相互抵消：\n$$\\frac{[\\mathrm{m}] \\cdot [\\mathrm{m/s}]}{[\\mathrm{m^2/s}]} = \\frac{[\\mathrm{m^2/s}]}{[\\mathrm{m^2/s}]} = 1$$\n\n现在，我们计算其数值：\n$$y^{+} = \\frac{5.0 \\times 0.41}{1.50} = \\frac{2.05}{1.50} \\approx 1.3666...$$\n题目要求将结果四舍五入到四位有效数字。\n$$y^{+} \\approx 1.367$$\n\n任务的第二部分是根据这个 $y^{+}$ 值确定合适的近壁面处理方法。在像 realizable $k$–$\\varepsilon$ 模型这样的 RANS 湍流模型的背景下，对于近壁面区域主要有两种处理方法：\n\n$1$. **壁面解析法 (低雷诺数模拟)**：这种方法要求计算网格足够精细，以便能够一直解析到粘性子层内的流动物理。粘性子层是紧邻壁面的区域，在这里粘性效应占主导地位，速度剖面近似呈线性。当第一个离壁单元的形心位于 $y^{+} \\lesssim 5$ 时，通常需要采用这种方法，其中 $y^{+} \\approx 1$ 是一个理想的目标值。\n\n$2$. **壁面函数法**：这种方法使用半经验公式（壁面函数）来跨接近壁面区域，模拟壁面与第一个单元形心之间的速度和湍流剖面。这避免了解析粘性子层和缓冲层所需的高昂计算成本。这种方法仅在第一个单元的形心位于完全湍流的对数律层时才有效，这通常对应于 $30  y^{+}  300$ 的范围。\n\n第一个单元计算出的值为 $y^{+} \\approx 1.367$。这个值完全在粘性子层（$y^{+} \\lesssim 5$）内部。因此，壁面函数法是不合适的，会导致重大误差，因为壁面函数所依据的假设（对数速度剖面）不成立。正确的策略是使用壁面解析法。对于 realizable $k$–$\\varepsilon$ 模型，这通常意味着采用“增强壁面处理”或类似的将解通过粘性子层积分到壁面的两层模型。这确保了控制壁面剪切应力和传热的近壁面高梯度区域能够被精确捕捉。\n\n总而言之，计算出的 $y^{+}$ 约为 $1.367$ 表明，近壁面网格是为了解析粘性子层而设计的，合适的数值处理方法是一种不依赖于对数壁面函数的低雷诺数模拟方法。",
            "answer": "$$\\boxed{1.367}$$"
        },
        {
            "introduction": "在确定壁面函数是合适的处理方法后，CFD 求解器必须利用它来计算壁面剪切应力。这涉及到数值求解一个非线性超越方程，该方程通过一个复合壁面律将单元中心的流速与壁面摩擦速度 $u_\\tau$ 联系起来。这个动手编程实践要求您为此核心任务设计并实现一个鲁棒的迭代算法，从而深入了解壁面函数的实际应用以及数值稳定性的重要性。",
            "id": "3979547",
            "problem": "您需要设计并实现一个完整、鲁棒的算法，用于在一个采用带壁面函数的近壁处理方法的雷诺平均纳维-斯托克斯(RANS)求解器中，计算每个邻近壁面的计算面上的摩擦速度 $u_{\\tau}$。该算法必须源于第一性原理和经过充分检验的经验关系，并包含显式欠松弛以确保在各种输入范围内的数值鲁棒性。\n\n起点是摩擦速度和无量纲壁面变量的定义。令 $u_{\\tau} = \\sqrt{\\tau_w / \\rho}$ 为摩擦速度，其中 $\\tau_w$ 是壁面剪切应力，$\\rho$ 是流体密度。使用近壁单元中心的平行于壁面的速度大小 $U_P$、到单元中心的壁面法向距离 $y_P$ 以及单元处的运动粘度 $ \\nu_P $，定义无量纲速度 $U^+$ 和无量纲壁面距离 $y^+$：\n$$\nU^+ = \\frac{U_P}{u_{\\tau}}, \\qquad y^+ = \\frac{y_P u_{\\tau}}{\\nu_P}.\n$$\n对于完全湍流中的壁面函数处理，以壁面单位表示的平均速度遵循一个普适的近壁关系。为了用一个单一连续函数同时表示粘性子层和对数律层，使用一个复合公式，该公式通过平滑过渡将线性壁面律和对数律混合起来。令 $\\kappa$ 为 von Kármán 常数，B 为对数律的加法常数。使用一个无量纲混合系数 $\\alpha  0$，定义一个混合权重\n$$\nw(y^+) = \\exp(-\\alpha y^+).\n$$\n将复合速度函数 $F(y^+)$ 定义为\n$$\nF(y^+) = w(y^+)\\, y^+ + \\big(1 - w(y^+)\\big)\\left(\\frac{1}{\\kappa}\\ln(y^+) + B\\right),\n$$\n其中 $\\ln(y^+)$ 的计算要求 $y^+  0$；任何数值实现都必须能安全地处理极小的 $y^+$。在邻近壁面的计算面上需要强制执行的壁面函数关系即为以下非线性标量方程\n$$\n\\frac{U_P}{u_{\\tau}} = F\\!\\left(\\frac{y_P u_{\\tau}}{\\nu_P}\\right).\n$$\n您的任务是实现一个鲁棒的求解器，用于在给定单元格的 $(U_P, y_P, \\nu_P)$ 和湍流变量（特别是湍动能 $k_P$ 和耗散率 $\\varepsilon_P$）的情况下求解 $u_{\\tau}$。您必须：\n\n- 从上述定义和复合近壁关系出发，论证对于 $U_P \\ge 0$、$y_P  0$ 和 $\\nu_P  0$ 的情况，$u_{\\tau}$ 的标量方程存在一个唯一且具有物理意义的解。\n- 设计一个数值稳定的迭代算法来求解 $u_{\\tau}$，该算法使用区间限定、带保护的牛顿法或割线法步长以及显式欠松弛机制以避免发散。算法应自适应地结合基于导数的步长和二分法来保证收敛。\n- 使用湍流变量构建一个物理上合理的初始猜测值。在 $k$–$\\varepsilon$ 模型中一个广泛使用的关系是 $C_{\\mu} = 0.09$，由此可得一个合理的初始摩擦速度 $u_{\\tau,0} = C_{\\mu}^{1/4}\\sqrt{k_P}$。如果 $k_P$ 过小或缺失，则回退到一个根据 $U_P$、$y_P$ 和 $\\nu_P$ 推导出的、与壁面律极限情况一致的非零初始猜测值。\n- 如果 $U_P = 0$，物理上一致的解是 $u_{\\tau} = 0$；您的算法必须能检测到这种情况并无需迭代直接返回该值。\n\n使用的常数：$\\kappa = 0.41$，$B = 5.2$ 和 $\\alpha = 1/11$。您的解必须以国际单位制(SI)表示：$U_P$ 单位为 $\\mathrm{m/s}$，$y_P$ 单位为 $\\mathrm{m}$，$\\nu_P$ 单位为 $\\mathrm{m^2/s}$，$k_P$ 单位为 $\\mathrm{m^2/s^2}$，$\\varepsilon_P$ 单位为 $\\mathrm{m^2/s^3}$，输出的摩擦速度 $u_{\\tau}$ 单位为 $\\mathrm{m/s}$。将每个 $u_{\\tau}$ 值四舍五入到六位小数。\n\n在一个可运行的程序中实现该算法，以评估以下一组测试用例，每个用例指定为 $(U_P, y_P, \\nu_P, \\rho, k_P, \\varepsilon_P)$:\n\n1. $(20.0, 1.0 \\times 10^{-3}, 1.5 \\times 10^{-5}, 1.225, 2.0, 1.0)$\n2. $(0.05, 1.0 \\times 10^{-5}, 1.0 \\times 10^{-5}, 1.225, 1.0 \\times 10^{-3}, 1.0 \\times 10^{-4})$\n3. $(200.0, 2.0 \\times 10^{-3}, 1.5 \\times 10^{-5}, 1.225, 50.0, 10.0)$\n4. $(0.0, 1.0 \\times 10^{-3}, 1.5 \\times 10^{-5}, 1.225, 1.0, 1.0)$\n5. $(10.0, 1.0 \\times 10^{-3}, 1.0 \\times 10^{-4}, 1000.0, 1.0, 1.0)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，\"[result1,result2,result3,result4,result5]\"），每个结果是计算出的 $u_{\\tau}$（单位为 $\\mathrm{m/s}$），并四舍五入到六位小数。不允许有其他输出。",
            "solution": "所述问题是有效的。它在科学上基于湍流流体动力学的原理，特别是在雷诺平均纳维-斯托克斯(RANS)模拟中的近壁模化。该公式在数学上是适定的、客观的，为确定唯一解提供了所有必要的定义、常数和数据。因此，我们将着手开发所需的算法。\n\n问题的核心是找到满足以下非线性标量方程的摩擦速度 $u_{\\tau}  0$：\n$$\n\\frac{U_P}{u_{\\tau}} = F\\left(\\frac{y_P u_{\\tau}}{\\nu_P}\\right)\n$$\n其中 $U_P$ 是近壁速度，$y_P$ 是壁面距离，$\\nu_P$ 是运动粘度，$F$ 是复合壁面函数：\n$$\nF(y^+) = \\exp(-\\alpha y^+) y^+ + \\big(1 - \\exp(-\\alpha y^+) \\big)\\left(\\frac{1}{\\kappa}\\ln(y^+) + B\\right)\n$$\n其中 $y^+ = y_P u_{\\tau} / \\nu_P$。给定的常数为 $\\kappa = 0.41$，$B = 5.2$ 和 $\\alpha = 1/11$。\n\n我们可以将问题重新表述为求解一个残差函数 $g(u_{\\tau})$ 的根：\n$$\ng(u_{\\tau}) = u_{\\tau} F\\left(\\frac{y_P u_{\\tau}}{\\nu_P}\\right) - U_P = 0\n$$\n\n**1. 解的存在性与唯一性**\n\n在设计数值求解器之前，我们必须证明对于指定的条件（$U_P \\ge 0$，$y_P  0$，$ \\nu_P  0$），存在一个唯一且具有物理意义的解。\n\n首先，考虑 $U_P = 0$ 的平凡情况。物理情景是流体处于静止状态，这意味着壁面剪切应力为零，因此 $u_{\\tau} = \\sqrt{\\tau_w/\\rho} = 0$。函数 $F(y^+)$ 和变量 $y^+$ 的构造使得对于任何 $u_{\\tau}  0$，我们都有 $y^+  0$ 和 $F(y^+)  0$。因此，对于 $u_{\\tau}  0$，$u_{\\tau} F(y_P u_{\\tau} / \\nu_P)  0$。所以，当 $U_P = 0$ 时，$g(u_{\\tau}) = 0$ 的唯一可能解恰好是 $u_{\\tau}=0$。\n\n现在，考虑 $U_P  0$ 的非平凡情况。我们寻求一个 $u_{\\tau}  0$ 的解。让我们分析函数 $H(u_{\\tau}) = u_{\\tau} F(y_P u_{\\tau} / \\nu_P)$。我们需要证明方程 $H(u_{\\tau}) = U_P$ 有一个唯一的正解。\n\n*   **极限行为：**\n    *   当 $u_{\\tau} \\to 0^+$ 时，$y^+ = y_P u_{\\tau} / \\nu_P \\to 0^+$。在此极限下，复合函数 $F(y^+)$ 的行为类似于线性壁面律，$F(y^+) \\approx y^+$。\n        $$\n        \\lim_{u_{\\tau} \\to 0^+} H(u_{\\tau}) = \\lim_{u_{\\tau} \\to 0^+} u_{\\tau} \\left(\\frac{y_P u_{\\tau}}{\\nu_P}\\right) = \\lim_{u_{\\tau} \\to 0^+} \\frac{y_P}{\\nu_P} u_{\\tau}^2 = 0\n        $$\n    *   当 $u_{\\tau} \\to \\infty$ 时，$y^+ \\to \\infty$。在此极限下，复合函数 $F(y^+)$ 的行为类似于对数壁面律，$F(y^+) \\approx \\frac{1}{\\kappa}\\ln(y^+) + B$。\n        $$\n        \\lim_{u_{\\tau} \\to \\infty} H(u_{\\tau}) = \\lim_{u_{\\tau} \\to \\infty} u_{\\tau} \\left(\\frac{1}{\\kappa}\\ln\\left(\\frac{y_P u_{\\tau}}{\\nu_P}\\right) + B\\right) = \\infty\n        $$\n\n*   **单调性：** 我们考察 $H(u_{\\tau})$ 相对于 $u_{\\tau}$ 的导数。令 $c = y_P/\\nu_P$。则 $y^+ = c u_{\\tau}$。使用链式法则：\n    $$\n    \\frac{dH}{du_{\\tau}} = \\frac{d}{du_{\\tau}} \\left[ u_{\\tau} F(c u_{\\tau}) \\right] = F(c u_{\\tau}) + u_{\\tau} F'(c u_{\\tau}) \\cdot c = F(y^+) + y^+ F'(y^+)\n    $$\n    项 $F(y^+)$ 代表无量纲速度剖面 $U^+$，物理上要求对于 $y^+  0$ 其为正值。导数 $F'(y^+) = dU^+ / dy^+$ 代表该剖面的梯度。对于任何物理上真实的普适速度剖面，该梯度对于所有 $y^+  0$ 也都是严格为正的。因此，由于 $y^+  0$，$F(y^+)  0$ 且 $F'(y^+)  0$，可以得出对于所有 $u_{\\tau}  0$，$dH/du_{\\tau}  0$。\n\n由于 $H(u_{\\tau})$ 对于 $u_{\\tau} \\ge 0$ 是一个连续且严格单调递增的函数，从 $H(0)=0$ 开始并当 $u_{\\tau} \\to \\infty$ 时趋近于 $\\infty$，根据介值定理，对于任何给定的 $U_P  0$，都存在唯一一个正解 $u_{\\tau}$ 使得 $H(u_{\\tau}) = U_P$。因此，该问题是适定的。\n\n**2. 数值算法设计**\n\n我们需要设计一个鲁棒的迭代算法来找到 $g(u_{\\tau}) = 0$ 的根。该算法包含初始猜测、区间限定阶段和一个带欠松弛的、有保护的迭代求解器。\n\n*   **初始猜测值 ($u_{\\tau,0}$):**\n    1.  主要的初始猜测值源于湍动能 $k_P$，基于近壁边界层内局部平衡的假设。使用标准的 $k-\\varepsilon$ 模型常数 $C_{\\mu} = 0.09$：\n        $$\n        u_{\\tau,0} = C_{\\mu}^{1/4} \\sqrt{k_P} \\approx 0.5477 \\sqrt{k_P}\n        $$\n        当 $k_P$ 可用且具有物理意义的正值时，使用此方法。\n    2.  如果 $k_P$ 为非正值或不可用，则需要一个备用猜测值。可以通过假设流动处于粘性子层深处来推导一个与壁面律极限情况一致的猜测值，此时 $U^+ = y^+$。这得出：\n        $$\n        \\frac{U_P}{u_{\\tau}} = \\frac{y_P u_{\\tau}}{\\nu_P} \\implies u_{\\tau,0} = \\sqrt{\\frac{U_P \\nu_P}{y_P}}\n        $$\n\n*   **区间限定策略：**\n    为保证收敛，我们首先建立一个包含根的搜索区间 $[a, b]$，即 $g(a) \\cdot g(b)  0$。\n    1.  我们知道 $g(0) = -U_P  0$。我们可以将下界 $a$ 设置为一个非常小的正数（例如 $10^{-9}$）以避免在 $u_{\\tau}=0$ 处的数值问题，确保 $g(a)  0$。\n    2.  我们计算 $g(u_{\\tau,0})$。如果 $g(u_{\\tau,0})  0$，我们就找到了一个区间 $[a, u_{\\tau,0}]$。\n    3.  如果 $g(u_{\\tau,0}) \\le 0$，说明初始猜测值过低。我们将新的下界设为 $u_{\\tau,0}$，然后通过倍增区间（例如 $b = 2u_{\\tau,0}, 4u_{\\tau,0}, \\dots$）来迭代搜索一个上界，直到找到一个值 $b$ 使得 $g(b)  0$。$H(u_{\\tau})$ 的单调性保证了这样的 $b$ 存在。\n\n*   **迭代求解器：**\n    采用一种混合方法，它结合了割线法的快速收敛性和二分法的保证收敛性。这构成了一种带保护的方法。\n    1.  设当前区间为 $[a_k, b_k]$，当前迭代值为 $u_{\\tau,k}$。使用割线法计算一个新的试验值 $u_{\\tau, \\text{trial}}$：\n        $$\n        u_{\\tau, \\text{secant}} = u_{\\tau,k} - g(u_{\\tau,k}) \\frac{u_{\\tau,k} - u_{\\tau,k-1}}{g(u_{\\tau,k}) - g(u_{\\tau,k-1})}\n        $$\n    2.  **保护措施：** 我们检查割线法步长是否落在当前区间内，即 $a_k  u_{\\tau, \\text{secant}}  b_k$。如果满足，我们接受它：$u_{\\tau, \\text{trial}} = u_{\\tau, \\text{secant}}$。如果它落在区间外，或者割线法分母接近于零，则认为该步长不安全，我们回退到鲁棒的二分法：\n        $$\n        u_{\\tau, \\text{bisect}} = \\frac{a_k + b_k}{2}\n        $$\n        在这种情况下，我们设置 $u_{\\tau, \\text{trial}} = u_{\\tau, \\text{bisect}}$。\n    3.  **欠松弛：** 为了增强稳定性，尤其是在CFD求解的初始迭代阶段（此时场变量可能剧烈变化），应用一个显式欠松弛因子 $\\omega \\in (0, 1]$：\n        $$\n        u_{\\tau, k+1} = \\omega \\, u_{\\tau, \\text{trial}} + (1 - \\omega) \\, u_{\\tau, k}\n        $$\n        一个典型值，如 $\\omega=0.7$，是合适的。\n    4.  **更新区间：** 计算出新的迭代值 $u_{\\tau, k+1}$ 后，评估残差 $g(u_{\\tau, k+1})$。通过用 $u_{\\tau, k+1}$ 替换 $a_k$ 或 $b_k$ 来更新下一次迭代的区间 $[a_{k+1}, b_{k+1}]$，确保根始终被包含在区间内。\n\n*   **收敛判据：** 当 $u_{\\tau}$ 的相对变化量低于指定的容差 $\\epsilon_{\\text{rel}}$，或者达到最大迭代次数时，迭代终止。\n    $$\n    \\frac{|u_{\\tau, k+1} - u_{\\tau, k}|}{|u_{\\tau,k+1}|}  \\epsilon_{\\text{rel}}\n    $$\n    对于工程精度，容差 $\\epsilon_{\\text{rel}} = 10^{-8}$ 是合适的。\n\n*   **数值安全性：** $\\ln(y^+)$ 的计算要求 $y^+0$。该算法被设计为只在 $u_\\tau0$ 的范围内搜索，因此这一条件得到满足。为防止极小 $y^+$ 可能导致的浮点问题，在 $F(y^+)$ 的实现中对对数的参数强制施加一个下限值（例如 $10^{-12}$），这不会影响结果，因为在此区域混合函数会正确地过渡到线性剖面 $F(y^+) \\approx y^+$。\n\n这个综合算法提供了一种鲁棒且高效的计算摩擦速度的方法，遵循了问题陈述的所有要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\n# Global constants as defined in the problem statement\nKAPPA = 0.41\nB = 5.2\nALPHA = 1.0 / 11.0\nCMU = 0.09\n\ndef solve():\n    \"\"\"\n    Main function to solve for friction velocity for a suite of test cases.\n    \"\"\"\n\n    def F_composite(y_plus):\n        \"\"\"\n        Computes the value of the composite wall function F(y+).\n\n        Args:\n            y_plus (float): Dimensionless wall distance.\n\n        Returns:\n            float: Dimensionless velocity U+.\n        \"\"\"\n        # Safeguard against log(0) or log of a negative number. The algorithm ensures y_plus  0.\n        # A small floor value increases numerical stability for extremely small y_plus.\n        y_plus_safe = np.maximum(y_plus, 1e-12)\n        \n        # Blending weight\n        w = np.exp(-ALPHA * y_plus_safe)\n        \n        # Logarithmic law part\n        log_term = (1.0 / KAPPA) * np.log(y_plus_safe) + B\n        \n        # Composite formulation\n        return w * y_plus_safe + (1.0 - w) * log_term\n\n    def solve_utau_single_case(U_p, y_p, nu_p, rho, k_p, eps_p):\n        \"\"\"\n        Calculates the friction velocity u_tau for a single near-wall cell.\n\n        Args:\n            U_p (float): Velocity magnitude at cell center P.\n            y_p (float): Wall-normal distance from wall to cell center P.\n            nu_p (float): Kinematic viscosity at P.\n            rho (float): Density at P (unused in this formulation).\n            k_p (float): Turbulent kinetic energy at P.\n            eps_p (float): TKE dissipation rate at P (unused in this formulation).\n\n        Returns:\n            float: The calculated friction velocity u_tau.\n        \"\"\"\n        # Per problem statement, handle the trivial case of zero velocity.\n        if U_p  1e-9: # Use a tolerance for floating-point comparison\n            return 0.0\n\n        def g(utau):\n            \"\"\"Residual function g(u_tau) = u_tau * F(y^+(u_tau)) - U_p.\"\"\"\n            if utau = 0:\n                return -U_p\n            y_plus = y_p * utau / nu_p\n            return utau * F_composite(y_plus) - U_p\n\n        # --- Step 1: Initial Guess ---\n        if k_p > 1e-9: # Primary guess from TKE\n            utau_guess = (CMU**0.25) * np.sqrt(k_p)\n        else: # Fallback guess from viscous sublayer assumption\n            utau_guess = np.sqrt(U_p * nu_p / y_p)\n        # Ensure the guess is a small, positive number at minimum.\n        utau_guess = np.maximum(utau_guess, 1e-6)\n\n        # --- Step 2: Bracketing ---\n        low_bound, high_bound = 1e-9, utau_guess\n        g_low, g_high = g(low_bound), g(high_bound)\n\n        if np.abs(g_high)  1e-14:\n            return high_bound\n\n        if g_high > 0: # Root is bracketed by [low_bound, high_bound]\n            pass\n        else: # Initial guess is too low, expand bracket upwards\n            low_bound = high_bound\n            g_low = g_high\n            # Iteratively double the high_bound to find an upper bracket\n            for _ in range(10): # Limit search to prevent infinite loops\n                high_bound *= 2.0\n                g_high = g(high_bound)\n                if g_high > 0:\n                    break\n            else:\n                # This should not be reached if the function is monotonic.\n                # As a safe exit, return the best guess so far.\n                return low_bound\n\n        # --- Step 3: Iterative Solver (Safeguarded Secant with Under-Relaxation) ---\n        max_iter = 50\n        rel_tol = 1e-8\n        omega = 0.7  # Under-relaxation factor\n\n        utau_k = high_bound\n        utau_km1 = low_bound\n        g_k = g_high\n        g_km1 = g_low\n        \n        for _ in range(max_iter):\n            # Secant step\n            if np.abs(g_k - g_km1)  1e-14: # Denominator is too small, fallback to bisection\n                utau_trial = 0.5 * (low_bound + high_bound)\n            else:\n                utau_secant = utau_k - g_k * (utau_k - utau_km1) / (g_k - g_km1)\n                \n                # Safeguard: if secant step is out of bounds, fallback to bisection\n                if utau_secant > low_bound and utau_secant  high_bound:\n                    utau_trial = utau_secant\n                else:\n                    utau_trial = 0.5 * (low_bound + high_bound)\n            \n            # Apply under-relaxation\n            utau_next = omega * utau_trial + (1.0 - omega) * utau_k\n\n            # Check for convergence\n            if np.abs(utau_next - utau_k) / (np.abs(utau_next) + 1e-12)  rel_tol:\n                utau_k = utau_next\n                break\n\n            # Update state for next iteration\n            utau_km1 = utau_k\n            g_km1 = g_k\n            utau_k = utau_next\n            g_k = g(utau_k)\n\n            # Update bracket for next iteration\n            if g_k > 0:\n                high_bound = utau_k\n            else:\n                low_bound = utau_k\n        \n        return utau_k\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (U_p, y_p, nu_p, rho, k_p, eps_p)\n        (20.0, 1.0e-3, 1.5e-5, 1.225, 2.0, 1.0),\n        (0.05, 1.0e-5, 1.0e-5, 1.225, 1.0e-3, 1.0e-4),\n        (200.0, 2.0e-3, 1.5e-5, 1.225, 50.0, 10.0),\n        (0.0, 1.0e-3, 1.5e-5, 1.225, 1.0, 1.0),\n        (10.0, 1.0e-3, 1.0e-4, 1000.0, 1.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case.\n        result = solve_utau_single_case(*case)\n        # Format to six decimal places as required.\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "壁面函数不是一个孤立的组件，它必须与外部流动的湍流模型协同工作并保持一致性。我们可以通过推导对数律所隐含的湍流涡粘性 $\\nu_t$，并将其与湍流模型（如 $k-\\varepsilon$ 模型）中 $\\nu_t$ 的定义进行比较，来检验这种一致性。这最后一个高级练习将加深您对 RANS 建模理论基础的理解，揭示连接壁面函数和湍流模型的关键“局部平衡”假设。",
            "id": "3979548",
            "problem": "考虑一个光滑平板上稳态、零压力梯度、不可压缩的湍流边界层，该边界层使用雷诺平均Navier–Stokes (RANS) 方程、标准高雷诺数双方程封闭模型以及壁面函数方法进行建模。第一个离壁单元中心与壁面的法向距离为 $y_{p}$，该位置的平均流向速度为 $U_{p}$。流体的运动粘度为 $\\nu$。壁面函数假设在惯性子层中存在壁面律的对数律，即 $U^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$，其中 $U^{+} = \\frac{U}{u_{\\tau}}$，$y^{+} = \\frac{y u_{\\tau}}{\\nu}$，$u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$ 是摩擦速度，$\\tau_{w}$ 是壁面剪切应力，$\\rho$ 是密度，$\\kappa$ 是 von Kármán 常数，$B$ 是对数律截距。假设第一个单元完全位于对数区内，因此 $y_{p}^{+} \\gg 30$。\n\nBoussinesq 涡粘性假设将湍流剪切应力建模为 $\\tau_{t} = \\rho \\nu_{t} \\frac{\\partial U}{\\partial y}$，并且在高雷诺数壁面函数公式中，第一个离壁位置的近壁剪切应力被视为与壁面剪切应力匹配，即 $\\tau_{t}(y_{p}) \\approx \\tau_{w}$。\n\n请仅从这些定义和广为接受的关系式出发，不使用任何未提及的封闭捷径，推导在 $y_{p}$ 处的运动涡粘度 $\\nu_{t,p}$ 的解析表达式，该表达式需同时满足：\n- 在 $y_{p}$ 处的对数平均速度剖面，以及\n- 建模的近壁湍流剪切应力与壁面剪切应力相等。\n\n你的推导过程应首先从 $y_{p}$ 处的对数关系式求解摩擦速度 $u_{\\tau}$，然后使用湍流剪切应力匹配条件消去 $u_{\\tau}$。如果出现超越方程，你可以用一个标准的特殊函数来表示你的最终结果。\n\n将你的最终答案表示为关于 $U_{p}$、$y_{p}$、$\\nu$、$\\kappa$ 和 $B$ 的单个闭式解析表达式。不要进行数值计算。如果需要计算其值，单位将是平方米/秒，但你不需要提供数值。\n\n最后，给定模型常数 $C_{\\mu}$，通过推导对数层中 $k_{p}$ 和 $\\varepsilon_{p}$ 的隐含关系，评估所得的 $\\nu_{t,p}$ 是否与标准高雷诺数 $k$–$\\varepsilon$ 模型的平衡假设一致，并评论其相容性。你的讨论不需要得出数值结果。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- 流动条件：光滑平板上稳态、零压力梯度、不可压缩的湍流边界层。\n- 建模方法：雷诺平均Navier–Stokes (RANS)，采用标准高雷诺数双方程封闭模型和壁面函数处理。\n- 第一个离壁单元中心位置：$y_{p}$。\n- $y_{p}$ 处的平均流向速度：$U_{p}$。\n- 流体属性：运动粘度 $\\nu$，密度 $\\rho$。\n- 壁面律的对数律：$U^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$。\n- 无量纲变量：$U^{+} = \\frac{U}{u_{\\tau}}$，$y^{+} = \\frac{y u_{\\tau}}{\\nu}$。\n- 摩擦速度定义：$u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$，其中 $\\tau_{w}$ 是壁面剪切应力。\n- 常数：$\\kappa$ (von Kármán 常数)，$B$ (对数律截距)。\n- 假设：第一个单元位于对数区内，$y_{p}^{+} \\gg 30$。\n- Boussinesq 涡粘性假设：$\\tau_{t} = \\rho \\nu_{t} \\frac{\\partial U}{\\partial y}$。\n- 近壁剪切应力匹配条件：$\\tau_{t}(y_{p}) \\approx \\tau_{w}$。\n- 高雷诺数 $k–\\varepsilon$ 模型常数：$C_{\\mu}$。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的陈述进行有效性评估。\n- **科学依据**：该问题基于湍流流动建模中使用 RANS 的壁面函数理论，这是一个成熟且标准的理论，也是计算流体力学 (CFD) 的基石。所提供的所有原理和定义都是流体力学和湍流领域的标准。该问题在科学上是合理的。\n- **适定性**：问题要求基于一组明确定义的方程和假设，推导一个特定量 $\\nu_{t,p}$。这些约束条件足以确定一个唯一的解析解。该问题是适定的。\n- **客观性**：语言精确、专业，没有任何主观或基于观点的陈述。所有术语都是标准的工程和物理学术语。\n- **完整性与一致性**：所有必要信息（$\\nu$、$\\rho$、$U_p$、$y_p$、$\\kappa$、$B$、控制方程）均已提供。诸如在 $y_p$ 处对数律成立以及湍流应力与壁面应力匹配等假设，在标准壁面函数框架内是相互一致的。问题设定是完整且一致的。\n- **真实性**：该情景模拟了 CFD 中的一个典型问题，是用于开发和分析湍流模型的标准理想化方法。在其建模背景下，这是物理上可信且现实的。\n\n### 步骤3：结论与行动\n问题有效。将提供详细解答。\n\n### 涡粘度 $\\nu_{t,p}$ 的推导\n\n推导过程通过满足第一个离壁网格点 $y_{p}$ 处的两个主要条件来进行：平均速度的对数律以及湍流剪切应力与壁面剪切应力的匹配。\n\nBoussinesq 假设将湍流剪切应力 $\\tau_{t}$ 与平均速度梯度联系起来：\n$$\n\\tau_{t}(y) = \\rho \\nu_{t} \\frac{\\partial U}{\\partial y}\n$$\n问题陈述，在点 $p$ 处，局部湍流剪切应力被假定为等于壁面剪切应力，即 $\\tau_{t}(y_p) = \\tau_w$。壁面剪切应力通过摩擦速度 $u_{\\tau}$ 定义为 $\\tau_w = \\rho u_{\\tau}^2$。将它们结合起来得到：\n$$\n\\rho \\nu_{t,p} \\left. \\frac{\\partial U}{\\partial y} \\right|_{y=y_p} = \\rho u_{\\tau}^2\n$$\n其中 $\\nu_{t,p}$ 是 $y_p$ 处的运动涡粘度。通过除以 $\\rho$（非零）进行简化，得到：\n$$\n\\nu_{t,p} \\left. \\frac{\\partial U}{\\partial y} \\right|_{y=y_p} = u_{\\tau}^2 \\quad (*)\n$$\n对数层中的平均速度剖面 $U(y)$ 由下式给出：\n$$\nU(y) = u_{\\tau} \\left( \\frac{1}{\\kappa} \\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right) + B \\right)\n$$\n为了求速度梯度，我们将 $U(y)$ 对 $y$ 求导：\n$$\n\\frac{\\partial U}{\\partial y} = u_{\\tau} \\frac{\\partial}{\\partial y} \\left[ \\frac{1}{\\kappa} (\\ln(y) + \\ln(u_{\\tau}/\\nu)) + B \\right] = u_{\\tau} \\frac{1}{\\kappa y}\n$$\n在 $y = y_p$ 处计算该梯度：\n$$\n\\left. \\frac{\\partial U}{\\partial y} \\right|_{y=y_p} = \\frac{u_{\\tau}}{\\kappa y_p}\n$$\n现在，将此梯度表达式代回方程 $(*)$：\n$$\n\\nu_{t,p} \\left( \\frac{u_{\\tau}}{\\kappa y_p} \\right) = u_{\\tau}^2\n$$\n对于湍流，$u_{\\tau} \\neq 0$，所以我们可以除以 $u_{\\tau}$：\n$$\n\\nu_{t,p} = \\kappa y_{p} u_{\\tau} \\quad (**)\n$$\n这是对数层中涡粘度的标准表达式。为了获得以给定流动变量 ($U_p, y_p, \\nu$) 和常数 ($\\kappa, B$) 表示的 $\\nu_{t,p}$ 的最终表达式，我们必须消去 $u_{\\tau}$。我们使用在点 $p$ 处计算的对数律：\n$$\n\\frac{U_p}{u_{\\tau}} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_p u_{\\tau}}{\\nu}\\right) + B\n$$\n这是一个关于 $u_{\\tau}$ 的超越方程。为了求解 $u_{\\tau}$，我们重新排列方程：\n$$\n\\frac{\\kappa U_p}{u_{\\tau}} = \\ln\\left(\\frac{y_p u_{\\tau}}{\\nu}\\right) + \\kappa B = \\ln\\left(\\frac{y_p}{\\nu}\\right) + \\ln(u_{\\tau}) + \\kappa B\n$$\n让我们定义一个变量 $X = \\frac{\\kappa U_p}{u_{\\tau}}$。这意味着 $u_{\\tau} = \\frac{\\kappa U_p}{X}$。将其代入方程中：\n$$\nX = \\ln\\left(\\frac{y_p}{\\nu} \\frac{\\kappa U_p}{X}\\right) + \\kappa B = \\ln\\left(\\frac{\\kappa y_p U_p}{\\nu}\\right) - \\ln(X) + \\kappa B\n$$\n重新排列以组合包含 $X$ 的项：\n$$\nX + \\ln(X) = \\ln\\left(\\frac{\\kappa y_p U_p}{\\nu}\\right) + \\kappa B\n$$\n该方程的形式为 $z + \\ln(z) = C$，其解由 $z = W(\\exp(C))$ 给出，其中 $W$ 是 Lambert W 函数。令 $C = \\ln\\left(\\frac{\\kappa y_p U_p}{\\nu}\\right) + \\kappa B$。则：\n$$\n\\exp(C) = \\exp\\left(\\ln\\left(\\frac{\\kappa y_p U_p}{\\nu}\\right) + \\kappa B\\right) = \\exp\\left(\\ln\\left(\\frac{\\kappa y_p U_p}{\\nu}\\right)\\right) \\exp(\\kappa B) = \\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B)\n$$\n因此，$X$ 的解是：\n$$\nX = W\\left( \\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B) \\right)\n$$\n回顾定义 $X = \\frac{\\kappa U_p}{u_{\\tau}}$，我们可以解出 $u_{\\tau}$：\n$$\nu_{\\tau} = \\frac{\\kappa U_p}{X} = \\frac{\\kappa U_p}{W\\left(\\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B)\\right)}\n$$\n最后，我们将这个 $u_{\\tau}$ 的表达式代入我们的涡粘度方程，即方程 $(**)$：\n$$\n\\nu_{t,p} = \\kappa y_{p} u_{\\tau} = \\kappa y_{p} \\left( \\frac{\\kappa U_p}{W\\left(\\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B)\\right)} \\right)\n$$\n这简化为 $\\nu_{t,p}$ 的最终解析表达式：\n$$\n\\nu_{t,p} = \\frac{\\kappa^2 y_p U_p}{W\\left(\\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B)\\right)}\n$$\n\n### 与 $k$–$\\varepsilon$ 模型的一致性评估\n\n我们现在评估这个结果是否与高雷诺数 $k$-$\\varepsilon$ 模型在对数层中的标准平衡假设相一致。关键的假设和定义是：\n1.  涡粘度由 $\\nu_t = C_{\\mu} \\frac{k^2}{\\varepsilon}$ 定义。\n2.  在对数层中，存在湍流的局部平衡，意味着产生项 ($P_k$) 等于耗散项 ($\\varepsilon$)，即 $P_k \\approx \\varepsilon$。\n3.  湍动能的产生项由 $P_k = \\nu_t \\left(\\frac{\\partial U}{\\partial y}\\right)^2$ 给出。\n\n从这些假设中，我们可以推导出 $k$ 和 $\\varepsilon$ 的标准对数层剖面。\n结合(2)和(3)，我们有 $\\varepsilon \\approx \\nu_t \\left(\\frac{\\partial U}{\\partial y}\\right)^2$。使用先前推导的关系式 $\\nu_t = \\kappa y u_{\\tau}$ 和 $\\frac{\\partial U}{\\partial y} = \\frac{u_{\\tau}}{\\kappa y}$，我们找到 $\\varepsilon$ 的隐含剖面：\n$$\n\\varepsilon(y) = (\\kappa y u_{\\tau}) \\left(\\frac{u_{\\tau}}{\\kappa y}\\right)^2 = (\\kappa y u_{\\tau}) \\frac{u_{\\tau}^2}{\\kappa^2 y^2} = \\frac{u_{\\tau}^3}{\\kappa y}\n$$\n因此，在点 $p$ 处，我们有 $\\varepsilon_p = \\frac{u_{\\tau}^3}{\\kappa y_p}$。\n\n为了找到 $k$ 的隐含剖面，我们使用关系式(1)并代入我们关于 $\\nu_t$ 和 $\\varepsilon$ 的公式：\n$$\n\\nu_t = C_{\\mu} \\frac{k^2}{\\varepsilon} \\implies \\kappa y u_{\\tau} = C_{\\mu} \\frac{k^2}{u_{\\tau}^3 / (\\kappa y)}\n$$\n求解 $k^2$：\n$$\nk^2 = \\frac{(\\kappa y u_{\\tau}) (u_{\\tau}^3 / (\\kappa y))}{C_{\\mu}} = \\frac{u_{\\tau}^4}{C_{\\mu}}\n$$\n取平方根得到 $k$ 的隐含剖面：\n$$\nk(y) = \\frac{u_{\\tau}^2}{\\sqrt{C_{\\mu}}}\n$$\n这表明在平衡对数层中，$k$ 是一个常数。在点 $p$ 处，$k_p = \\frac{u_{\\tau}^2}{\\sqrt{C_{\\mu}}}$。\n\n为了检查相容性，我们可以将这些基于平衡的 $k_p$ 和 $\\varepsilon_p$ 表达式代回 $k$-$\\varepsilon$ 模型对涡粘度的定义(1)中：\n$$\n\\nu_{t,p} = C_{\\mu} \\frac{k_p^2}{\\varepsilon_p} = C_{\\mu} \\frac{\\left(u_{\\tau}^2 / \\sqrt{C_{\\mu}}\\right)^2}{u_{\\tau}^3 / (\\kappa y_p)} = C_{\\mu} \\frac{u_{\\tau}^4 / C_{\\mu}}{u_{\\tau}^3 / (\\kappa y_p)} = \\frac{u_{\\tau}^4}{u_{\\tau}^3} \\kappa y_p = \\kappa y_p u_{\\tau}\n$$\n这个结果 $\\nu_{t,p} = \\kappa y_p u_{\\tau}$ 与我们从问题的初始约束（对数律剖面和湍流应力匹配）中推导出的中间表达式，即方程 $(**)$，完全相同。这表明了完美的一致性。壁面函数公式施加的约束与从 $k$-$\\varepsilon$ 模型对数层中的局部平衡假设推导出的约束是相同的。因此，所推导的 $\\nu_{t,p}$ 解析表达式与标准高雷诺数 $k$-$\\varepsilon$ 模型完全相容。",
            "answer": "$$\n\\boxed{\\frac{\\kappa^2 y_p U_p}{W\\left(\\frac{\\kappa y_p U_p}{\\nu} \\exp(\\kappa B)\\right)}}\n$$"
        }
    ]
}