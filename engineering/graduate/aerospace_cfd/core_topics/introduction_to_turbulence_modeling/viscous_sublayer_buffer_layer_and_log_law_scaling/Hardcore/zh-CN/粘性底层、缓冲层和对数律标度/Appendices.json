{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学（CFD）中，对壁面边界层进行准确建模至关重要。此练习将理论与实践相结合，要求您计算近壁网格单元中心的无量纲壁面距离$y^+$ 。这个计算是评估网格分辨率是否适用于特定壁面处理方法（如壁面函数方法）的第一步，也是CFD从业者的基本技能。",
            "id": "4004577",
            "problem": "考虑在光滑平板上方的不可压缩牛顿流体的零压力梯度湍流边界层，并使用计算流体动力学（CFD）进行分析。第一个离壁网格单元的中心放置在法向壁面距离 $y=0.2\\,\\mathrm{mm}$ 处。流体的密度为 $\\rho=1.2\\,\\mathrm{kg/m^3}$，运动粘度为 $\\nu=1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$。测得的摩擦速度（由壁面剪切应力通过 $u_{\\tau}=\\sqrt{\\tau_{w}/\\rho}$ 定义）为 $u_{\\tau}=0.4\\,\\mathrm{m/s}$。从壁面湍流的量纲内尺度律以及粘性长度尺度和摩擦速度的定义出发，推导近壁区域的无量纲法向壁面坐标，并计算其在给定网格单元位置处的值。根据近壁区域的典型分层，判断所选的第一个单元位置是否适用于对数律壁面函数方法。最终答案只报告计算出的无量纲法向壁面坐标的值。将最终答案四舍五入到四位有效数字。最终答案以纯数字形式表示，不带单位。",
            "solution": "该问题提法恰当，有科学依据，并为获得唯一解提供了所有必要信息。我们首先建立壁面湍流内尺度律的理论框架。\n\n在湍流边界层的近壁区域，流动动力学由粘性应力和湍流应力的相互作用所主导。该区域的合适尺度化变量源于在此占主导地位的物理量：流体密度 $\\rho$、流体粘度（动力粘度 $\\mu$ 或运动粘度 $\\nu = \\mu/\\rho$）以及壁面剪切应力 $\\tau_w$。基于这些量，我们可以定义一个特征速度尺度和一个特征长度尺度。\n\n特征速度尺度是摩擦速度 $u_{\\tau}$，其定义为：\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n该速度尺度代表了近壁处湍流速度脉动的大小。题目给出的值为 $u_{\\tau} = 0.4\\,\\mathrm{m/s}$。\n\n特征长度尺度是粘性长度尺度 $\\delta_{\\nu}$。它由运动粘度 $\\nu$ 和摩擦速度 $u_{\\tau}$ 构成，代表了粘性效应占主导地位的层的近似厚度。其定义为：\n$$\n\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}\n$$\n\n使用这些尺度，我们可以对物理变量进行无量纲化。无量纲法向壁面坐标，记为 $y^+$，定义为物理离壁距离 $y$ 由粘性长度尺度 $\\delta_{\\nu}$ 归一化得到。\n$$\ny^+ = \\frac{y}{\\delta_{\\nu}}\n$$\n将 $\\delta_{\\nu}$ 的定义代入此表达式，得到 $y^+$ 的直接计算公式：\n$$\ny^+ = \\frac{y u_{\\tau}}{\\nu}\n$$\n这就是所求的近壁区域无量纲法向壁面坐标的表达式。\n\n题目要求我们计算第一个离壁网格单元中心处的 $y^+$ 值。所提供的数据如下：\n- 法向壁面距离，$y = 0.2\\,\\mathrm{mm} = 0.2 \\times 10^{-3}\\,\\mathrm{m}$。\n- 摩擦速度，$u_{\\tau} = 0.4\\,\\mathrm{m/s}$。\n- 运动粘度，$\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$。\n\n将这些值代入推导出的 $y^+$ 公式中：\n$$\ny^+ = \\frac{(0.2 \\times 10^{-3}\\,\\mathrm{m}) \\times (0.4\\,\\mathrm{m/s})}{1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}}\n$$\n我们进行计算：\n$$\ny^+ = \\frac{0.08 \\times 10^{-3}}{1.5 \\times 10^{-5}} = \\frac{8 \\times 10^{-5}}{1.5 \\times 10^{-5}} = \\frac{8}{1.5}\n$$\n$$\ny^+ = \\frac{16}{3} \\approx 5.3333...\n$$\n题目要求将最终答案四舍五入到四位有效数字。\n$$\ny^+ \\approx 5.333\n$$\n这就是第一个网格单元位置处的无量纲法向壁面坐标。\n\n问题的第二部分要求评估此单元放置是否适用于CFD中的对数律壁面函数方法。近壁区域根据 $y^+$ 的值通常被分为三层：\n1.  **粘性底层：** $y^+ \\lesssim 5$，在该区域粘性应力占主导，速度剖面呈线性（$u^+ = y^+$）。对于解析该层（一种“低雷诺数”模型方法）的模拟，第一个网格点应位于 $y^+ \\approx 1$ 处。\n2.  **缓冲层：** $5 \\lesssim y^+ \\lesssim 30$，在该区域粘性应力和湍流应力均很重要。这是一个过渡区域，线性律和对数律在此都不准确。\n3.  **对数层（对数律区）：** $y^+ \\gtrsim 30$，在该区域湍流应力占主导，速度剖面遵循对数律（$u^+ = \\frac{1}{\\kappa}\\ln(y^+) + B$）。\n\n标准的对数律壁面函数方法绕过了对粘性底层和缓冲层的解析。它使用对数律来模拟壁面和第一个网格点之间的流动。这种方法仅当第一个网格点完全位于对数层内（通常在 $30 \\lesssim y^+ \\lesssim 100$ 的范围内）时才有效。\n\n我们计算出的 $y^+ \\approx 5.333$ 值将第一个网格单元中心直接置于缓冲层中。对于标准的对数律壁面函数而言，这是一个不合适的位置。该模型的基本假设——即网格单元位于对数律区域内——被违反，这将导致在壁面剪切应力和其他近壁现象的预测中产生显著误差。对于此网格，正确的策略是要么进一步加密网格，将第一个单元置于 $y^+ \\approx 1$ 处以解析粘性底层，要么采用能够正确处理缓冲层的更复杂的“全$y^+$”壁面处理方法。\n\n然而，题目明确要求只报告无量纲法向壁面坐标的计算数值。",
            "answer": "$$\\boxed{5.333}$$"
        },
        {
            "introduction": "对数律（log-law）是描述壁湍流中速度分布的基石。本练习旨在加深您对这一核心概念的理解，它首先引导您通过相似性论证推导出对数律的函数形式 。通过亲手计算不同$y^+$值对应的速度，您将直观地感受到von Kármán常数 $\\kappa$ 对速度剖面的影响，并体会到该定律在预测近壁区流速时的强大作用。",
            "id": "4004579",
            "problem": "考虑在计算流体动力学（CFD）中分析的一个高雷诺数下光滑平板上的统计定常、零压力梯度的湍流边界层。设壁面剪切应力为 $\\tau_{w}$，流体密度为 $\\rho$。定义摩擦速度 $u_{\\tau}=\\sqrt{\\tau_{w}/\\rho}$，内尺度归一化的壁面距离 $y^{+}=y\\,u_{\\tau}/\\nu$（其中 $\\nu$ 为运动粘度），以及内尺度归一化的平均流向速度 $U^{+}=U/u_{\\tau}$。使用壁湍流的基本相似性论证，从以下事实出发：当 $y^{+}\\to 0$ 时，粘性子层表现出 $U^{+}\\approx y^{+}$；以及在离壁面足够远但仍在边界层厚度内的区域，平均速度剖面在主导阶上与粘度无关。基于这些前提，推导重叠层中 $U^{+}(y^{+})$ 的函数形式，并指出由此产生的两个无量纲常数。然后，使用重叠层的形式，在常数 $\\kappa=0.41$ 和 $B=5.0$ 的条件下，计算 $y^{+}=50$、$y^{+}=100$ 和 $y^{+}=200$ 处的 $U^{+}$。最后，通过保持 $B=5.0$ 不变，用 $\\kappa=0.39$ 重复这三个评估，以评估 $U^{+}$ 对 $\\kappa$ 选择的敏感性。将所有六个数值表示为四位有效数字，并按顺序 $\\big[U^{+}(50;\\,\\kappa=0.41),\\,U^{+}(100;\\,\\kappa=0.41),\\,U^{+}(200;\\,\\kappa=0.41),\\,U^{+}(50;\\,\\kappa=0.39),\\,U^{+}(100;\\,\\kappa=0.39),\\,U^{+}(200;\\,\\kappa=0.39)\\big]$ 以单个行矩阵的形式报告，不包含单位。",
            "solution": "该问题要求我们基于相似性论证推导对数律，并进行数值计算。\n\n### 第1步：推导对数律的函数形式\n\n对数律适用于“重叠区”（或称对数律层），该区域既离壁面足够远，以至于粘性效应可以忽略，又离壁面足够近，以至于外层流动的细节（如边界层厚度 $\\delta$）不产生影响。\n\n1.  **内层标度**：在近壁区域，我们假设无量纲速度 $U^{+} = U/u_{\\tau}$ 是无量纲距离 $y^{+} = y u_{\\tau} / \\nu$ 的函数，即 $U^{+} = f(y^{+})$。\n\n2.  **外层标度与粘度无关性**：问题中的关键假设是，在重叠区，平均速度剖面 *在主导阶上与粘度无关*。这意味着速度梯度 $dU/dy$ 不应依赖于 $\\nu$。它应该只依赖于局部参数：到壁面的距离 $y$ 和摩擦速度 $u_{\\tau}$（它代表了湍流强度）。\n    $$\n    \\frac{dU}{dy} = g(y, u_{\\tau})\n    $$\n\n3.  **量纲分析**：我们对上述关系进行量纲分析。\n    - $[dU/dy] = T^{-1}$\n    - $[y] = L$\n    - $[u_{\\tau}] = L T^{-1}$\n\n    为了从 $y$ 和 $u_{\\tau}$ 组合出量纲为 $T^{-1}$ 的量，唯一的方法是：\n    $$\n    \\frac{dU}{dy} \\propto \\frac{u_{\\tau}}{y}\n    $$\n    引入一个无量纲常数（冯·卡门常数 $\\kappa$ 的倒数），我们得到：\n    $$\n    \\frac{dU}{dy} = \\frac{u_{\\tau}}{\\kappa y}\n    $$\n\n4.  **无量纲化与积分**：将此方程用内尺度变量表示。\n    - $U = U^{+} u_{\\tau}$\n    - $y = y^{+} \\nu / u_{\\tau}$\n    - $d U = u_{\\tau} dU^{+}$\n    - $d y = (\\nu / u_{\\tau}) dy^{+}$\n    代入后得到：\n    $$\n    \\frac{u_{\\tau} dU^{+}}{(\\nu / u_{\\tau}) dy^{+}} = \\frac{u_{\\tau}}{\\kappa (y^{+} \\nu / u_{\\tau})} \\implies \\frac{dU^{+}}{dy^{+}} = \\frac{1}{\\kappa y^{+}}\n    $$\n    对上式积分：\n    $$\n    \\int dU^{+} = \\int \\frac{1}{\\kappa y^{+}} dy^{+}\n    $$\n    $$\n    U^{+}(y^{+}) = \\frac{1}{\\kappa} \\ln(y^{+}) + B\n    $$\n    这就是重叠区中 $U^{+}(y^{+})$ 的函数形式，即**对数律**。\n\n### 第2步：指出无量纲常数\n\n从推导中产生的两个无量纲常数是：\n1.  **冯·卡门常数 (von Kármán constant)** $\\kappa$：与速度梯度有关，通常取值约为 0.41。\n2.  **积分常数 (additive constant)** $B$：对于光滑壁面，通常取值约为 5.0。\n\n### 第3步：数值计算\n\n我们使用对数律公式 $U^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$ 进行计算。\n\n**情况 1: $\\kappa = 0.41$, $B = 5.0$**\n-   当 $y^{+} = 50$ 时：\n    $U^{+} = \\frac{1}{0.41} \\ln(50) + 5.0 \\approx 2.4390 \\times 3.9120 + 5.0 = 9.5414 + 5.0 = 14.5414 \\approx 14.54$\n-   当 $y^{+} = 100$ 时：\n    $U^{+} = \\frac{1}{0.41} \\ln(100) + 5.0 \\approx 2.4390 \\times 4.6052 + 5.0 = 11.2321 + 5.0 = 16.2321 \\approx 16.23$\n-   当 $y^{+} = 200$ 时：\n    $U^{+} = \\frac{1}{0.41} \\ln(200) + 5.0 \\approx 2.4390 \\times 5.2983 + 5.0 = 12.9225 + 5.0 = 17.9225 \\approx 17.92$\n\n**情况 2: $\\kappa = 0.39$, $B = 5.0$**\n-   当 $y^{+} = 50$ 时：\n    $U^{+} = \\frac{1}{0.39} \\ln(50) + 5.0 \\approx 2.5641 \\times 3.9120 + 5.0 = 10.0304 + 5.0 = 15.0304 \\approx 15.03$\n-   当 $y^{+} = 100$ 时：\n    $U^{+} = \\frac{1}{0.39} \\ln(100) + 5.0 \\approx 2.5641 \\times 4.6052 + 5.0 = 11.8080 + 5.0 = 16.8080 \\approx 16.81$\n-   当 $y^{+} = 200$ 时：\n    $U^{+} = \\frac{1}{0.39} \\ln(200) + 5.0 \\approx 2.5641 \\times 5.2983 + 5.0 = 13.5851 + 5.0 = 18.5851 \\approx 18.59$\n\n将这六个结果按要求格式组合，我们得到最终答案。",
            "answer": "$$ \\boxed{[14.54, 16.23, 17.92, 15.03, 16.81, 18.59]} $$"
        },
        {
            "introduction": "理解湍流的物理机制是进行高级建模和分析的前提。这个高级计算练习模拟了湍流研究者分析直接数值模拟（DNS）数据的过程，让您亲手揭示湍流的能量来源 。通过处理合成数据来计算湍动能生成项$P^+$的分布，您将定位其峰值，从而从物理上验证缓冲层（buffer layer）正是湍流生成最剧烈的区域。",
            "id": "4004590",
            "problem": "考虑一个通过直接数值模拟 (Direct Numerical Simulation, DNS) 分析的充分发展的湍流平面槽道流。设近壁变量以壁面单位表示，由摩擦速度 $u_{\\tau}$ 和运动粘度 $\\nu$ 定义。无量纲壁面法向坐标为 $y^{+} = y\\,u_{\\tau}/\\nu$，无量纲平均速度为 $U^{+} = U/u_{\\tau}$，无量纲雷诺剪切应力为 $\\overline{u^{\\prime}v^{\\prime}}^{+} = \\overline{u^{\\prime}v^{\\prime}}/u_{\\tau}^{2}$。无量纲平均剪切为 $dU^{+}/dy^{+}$，内尺度湍动能生成项定义为 $P^{+}(y^{+}) = -\\,\\overline{u^{\\prime}v^{\\prime}}^{+}(y^{+})\\,\\left(dU^{+}/dy^{+}\\right)(y^{+})$。在平面槽道流中，以壁面单位表示的精确平均流向动量平衡方程为 $dU^{+}/dy^{+} - \\overline{u^{\\prime}v^{\\prime}}^{+} = 1 - y^{+}/Re_{\\tau}$，其中 $Re_{\\tau} = u_{\\tau}\\,h/\\nu$ 是摩擦雷诺数，$h$ 是槽道半高。粘性底层、缓冲层和对数律层（log layer）是由不同渐近标度律描述的内层区域；特别地，缓冲层是粘性底层和对数律层之间的过渡区域，其特征通常是内坐标 $y^{+}$ 位于一个依赖于 $Re_{\\tau}$（弱相关）的下界和上界之间。\n\n您的任务是，根据为与上述原理一致而构建的类DNS内尺度合成数据，计算最大生成项 $P^{+}$ 的位置 $y^{+}$，并通过确定计算出的 $y^{+}$ 是否位于指定的包含性缓冲层区间 $\\left[y_{\\mathrm{buf,min}}^{+},\\,y_{\\mathrm{buf,max}}^{+}\\right]$ 内，将其与缓冲层范围关联起来。\n\n对每个测试用例，使用以下构造在离散网格上生成内尺度平均剖面和应力：\n- 为 $i = 0,1,\\dots,N-1$ 定义一个均匀网格 $y_{i}^{+}$，其中 $y_{0}^{+} = 0$ 且 $y_{N-1}^{+} = y_{\\mathrm{end}}^{+}$。\n- 为内层平均剪切定义一个平滑的混合函数\n$$\n\\phi(y^{+}) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{y^{+} - y_{0}^{+}}{\\delta^{+}}\\right)\\right],\n$$\n以及一个复合的内尺度平均剪切\n$$\n\\left(\\frac{dU^{+}}{dy^{+}}\\right)_{\\mathrm{blend}}(y^{+}) = \\left(1 - \\phi(y^{+})\\right)\\cdot 1 + \\phi(y^{+})\\cdot \\frac{1}{\\kappa\\,y^{+}},\n$$\n其中 $\\kappa$ 是冯·卡门常数，$y_{0}^{+}$ 和 $\\delta^{+}$ 控制从粘性底层到对数律层的过渡。为防止在 $y^{+} = 0$ 处出现奇异行为，将因子 $1/(\\kappa\\,y^{+})$ 在数值上实现为 $1/\\left(\\kappa\\,(y^{+}+\\varepsilon)\\right)$，其中 $\\varepsilon$ 是一个小的正数。\n- 在给定网格上，使用梯形法则从 $y^{+} = 0$ 开始对 $\\left(dU^{+}/dy^{+}\\right)_{\\mathrm{blend}}$ 进行数值积分，并使用初始条件 $U^{+}(0) = 0$ 来构建 $U^{+}(y^{+})$。这个 $U^{+}$ 就是类DNS的合成平均剖面。\n- 通过对离散的 $U^{+}$ 使用二阶精度中心差分格式（用于内部点）和一阶单边差分（用于边界点）来近似计算 $dU^{+}/dy^{+}$，以模拟DNS数据的后处理过程。\n- 通过精确的槽道流动态量平衡方程计算内尺度雷诺剪切应力，\n$$\n-\\,\\overline{u^{\\prime}v^{\\prime}}^{+}(y^{+}) = \\left(1 - \\frac{y^{+}}{Re_{\\tau}}\\right) - \\left(\\frac{dU^{+}}{dy^{+}}\\right)(y^{+}).\n$$\n为了在含噪声数据中实现数值真实性，如果 $-\\,\\overline{u^{\\prime}v^{\\prime}}^{+}$ 由于离散化或添加的噪声而变为负值，则在这些点上将其截断为零。\n- 计算生成项 $P^{+}(y^{+})$，并确定其最大值 $P_{\\max}^{+}$ 和对应的位置 $y_{\\max}^{+}$。如果在 $10^{-6}$ 的相对容差内有多个点共享最大值，则选择其中最小的 $y^{+}$。\n\n对于每个测试用例，您的程序必须产生以下输出：\n- 最大生成项的位置 $y_{\\max}^{+}$，以壁面单位 $y^{+}$（无量纲）表示，四舍五入到两位小数。\n- 最大生成项的值 $P_{\\max}^{+}$（无量纲），四舍五入到三位小数。\n- 一个布尔值，指示 $y_{\\max}^{+}$ 是否在包含性缓冲层区间 $\\left[y_{\\mathrm{buf,min}}^{+},\\,y_{\\mathrm{buf,max}}^{+}\\right]$ 内。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔的列表的列表，按测试用例的顺序排列，每个内部列表的形式为 $\\left[y_{\\max}^{+},\\,P_{\\max}^{+},\\,\\mathrm{in\\_buffer}\\right]$，例如 $\\left[\\left[12.34,\\,0.567,\\,\\mathrm{True}\\right],\\dots\\right]$。\n\n测试套件：\n- 用例 1（典型，中等 $Re_{\\tau}$）：\n  - $Re_{\\tau} = 180$, $\\kappa = 0.41$, $B = 5.2$, $y_{0}^{+} = 11$, $\\delta^{+} = 3$, $\\varepsilon = 10^{-12}$, $y_{\\mathrm{end}}^{+} = 100$, $N = 1001$, 缓冲层区间 $\\left[y_{\\mathrm{buf,min}}^{+},\\,y_{\\mathrm{buf,max}}^{+}\\right] = [5,\\,30]$, 无附加噪声。\n- 用例 2（较低 $Re_{\\tau}$，较窄的缓冲层区间）：\n  - $Re_{\\tau} = 80$, $\\kappa = 0.41$, $B = 5.0$, $y_{0}^{+} = 9$, $\\delta^{+} = 2.5$, $\\varepsilon = 10^{-12}$, $y_{\\mathrm{end}}^{+} = 60$, $N = 601$, 缓冲层区间 $\\left[y_{\\mathrm{buf,min}}^{+},\\,y_{\\mathrm{buf,max}}^{+}\\right] = [5,\\,25]$, 无附加噪声。\n- 用例 3（过渡区更靠近壁面；边界测试）：\n  - $Re_{\\tau} = 395$, $\\kappa = 0.41$, $B = 5.2$, $y_{0}^{+} = 8$, $\\delta^{+} = 1.5$, $\\varepsilon = 10^{-12}$, $y_{\\mathrm{end}}^{+} = 120$, $N = 1201$, 缓冲层区间 $\\left[y_{\\mathrm{buf,min}}^{+},\\,y_{\\mathrm{buf,max}}^{+}\\right] = [8,\\,30]$, 无附加噪声。\n- 用例 4（含噪声的类DNS合成数据；鲁棒性检查）：\n  - $Re_{\\tau} = 180$, $\\kappa = 0.41$, $B = 5.2$, $y_{0}^{+} = 11$, $\\delta^{+} = 3$, $\\varepsilon = 10^{-12}$, $y_{\\mathrm{end}}^{+} = 100$, $N = 1001$, 缓冲层区间 $\\left[y_{\\mathrm{buf,min}}^{+},\\,y_{\\mathrm{buf,max}}^{+}\\right] = [5,\\,30]$, 在进行差分之前，向 $U^{+}$ 添加均值为零、标准差为 $\\sigma_{U^{+}} = 0.02$ 的高斯噪声，使用固定的伪随机种子 $42$。\n\n所有量均以壁面单位表示，是无量纲的。角度单位不适用。最终答案必须按上述规定表示为浮点数和布尔值，并聚合成指定格式的单行输出。",
            "solution": "问题陈述经评估有效。它在科学上植根于流体力学原理，特别是壁湍流理论。该问题是适定的，为一项计算任务提供了完整且无歧义的指令和参数集。语言客观、正式。任务是实现一个明确定义的数值程序，分析合成数据，并提取特定的物理量，这是计算流体力学（CFD）中的一个标准练习。\n\n解决方案通过实施指定的算法来计算模拟湍流槽道流中湍动能最大生成项的位置。问题的核心在于构建一个真实的平均速度剖面 $U^{+}(y^{+})$，然后基于平面槽道流的精确平均动量方程，用它来推导其他湍流统计量。\n\n在充分发展的平面槽道流中，以壁面单位表示的平均流向动量方程由下式给出：\n$$\n\\frac{d \\tau^{+}_{xz}}{d y^{+}} = -\\frac{dp}{dx} \\frac{h}{\\rho u_{\\tau}^2}\n$$\n在此方程中，$\\tau^{+}_{xz}$ 是总剪切应力，即粘性应力 $\\tau^{+}_{\\mathrm{visc}} = dU^{+}/dy^{+}$ 和雷诺剪切应力 $\\tau^{+}_{\\mathrm{turb}} = -\\overline{u'v'}^{+}$ 之和。由于压力梯度是恒定的，并在壁面（$y=0$）处与壁面剪切应力相平衡，其中 $-\\frac{dp}{dx} = \\frac{\\tau_w}{h} = \\frac{\\rho u_\\tau^2}{h}$，动量方程积分可得：\n$$\n\\frac{dU^{+}}{dy^{+}} - \\overline{u^{\\prime}v^{\\prime}}^{+} = 1 - \\frac{y^{+}}{Re_{\\tau}}\n$$\n其中 $Re_{\\tau} = u_{\\tau}h/\\nu$ 是摩擦雷诺数，$h$ 是槽道半高，积分常数由壁面边界条件确定。该方程构成了问题的理论基础。\n\n对每个测试用例，计算过程按以下步骤执行：\n\n1.  **网格生成**：为壁面法向坐标 $y^{+}$ 创建一个一维均匀网格，范围从壁面处的 $y^{+} = 0$ 到指定的外部边界 $y_{\\mathrm{end}}^{+}$。该网格包含 $N$ 个点。\n\n2.  **合成平均剪切剖面**：构建一个复合的平均速度梯度 $\\left(dU^{+}/dy^{+}\\right)_{\\mathrm{blend}}$。该剖面必须精确表示近壁区域的行为。在粘性底层（$y^{+} \\to 0$），粘性应力占主导，剪切为常数：$dU^{+}/dy^{+} \\approx 1$。在对数律层（离壁面更远处），湍流应力占主导，剪切遵循标度律 $dU^{+}/dy^{+} \\approx 1/(\\kappa y^{+})$，其中 $\\kappa$ 是冯·卡门常数。使用混合函数 $\\phi(y^{+})$ 实现这两种渐近行为之间的平滑过渡：\n    $$\n    \\phi(y^{+}) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{y^{+} - y_{0}^{+}}{\\delta^{+}}\\right)\\right]\n    $$\n    复合剪切则为：\n    $$\n    \\left(\\frac{dU^{+}}{dy^{+}}\\right)_{\\mathrm{blend}}(y^{+}) = \\left(1 - \\phi(y^{+})\\right)\\cdot 1 + \\phi(y^{+})\\cdot \\frac{1}{\\kappa\\,y^{+}}\n    $$\n    参数 $y_{0}^{+}$ 和 $\\delta^{+}$ 分别控制过渡区的中心和宽度。为避免在 $y^{+} = 0$ 处出现奇异性，对数项被正则化为 $1/(\\kappa(y^{+} + \\varepsilon))$，其中 $\\varepsilon$ 是一个很小的常数。\n\n3.  **合成平均速度剖面**：通过从壁面向外对混合剪切剖面进行数值积分，并遵循无滑移条件 $U^{+}(0) = 0$，得到无量纲平均速度剖面 $U^{+}(y^{+})$。该积分采用梯形法则：\n    $$\n    U^{+}(y^{+}) = \\int_{0}^{y^{+}} \\left(\\frac{dU^{+}}{ds^{+}}\\right)_{\\mathrm{blend}} ds^{+}\n    $$\n\n4.  **添加噪声（仅限用例 4）**：为模拟真实DNS或实验数据的噪声特性，向计算出的 $U^{+}(y^{+})$ 剖面添加均值为零、标准差为 $\\sigma_{U^{+}}$ 的高斯噪声。使用固定的伪随机种子以确保可复现性。\n\n5.  **数值微分**：为模拟离散数据的后处理，通过对（可能含噪声的）$U^{+}(y^{+})$ 剖面应用数值微分格式来重新计算平均剪切 $dU^{+}/dy^{+}$。根据规定，内部网格点使用二阶精度中心差分格式，边界点使用一阶精度单边（前向/后向）差分格式。这可以使用标准数值库函数高效实现。\n\n6.  **雷诺剪切应力计算**：利用数值计算出的剪切 $dU^{+}/dy^{+}$，通过整理平均动量方程来确定无量纲雷诺剪切应力 $-\\overline{u^{\\prime}v^{\\prime}}^{+}$：\n    $$\n    -\\,\\overline{u^{\\prime}v^{\\prime}}^{+}(y^{+}) = \\left(1 - \\frac{y^{+}}{Re_{\\tau}}\\right) - \\left(\\frac{dU^{+}}{dy^{+}}\\right)(y^{+})\n    $$\n    由于离散误差或附加噪声，该量可能会出现非物理的负值。因此，任何负值都将被截断为零。\n\n7.  **湍流生成项计算**：湍动能生成项 $P^{+}(y^{+})$ 是雷诺剪切应力与平均应变率的乘积：\n    $$\n    P^{+}(y^{+}) = -\\,\\overline{u^{\\prime}v^{\\prime}}^{+}(y^{+})\\,\\left(\\frac{dU^{+}}{dy^{+}}\\right)(y^{+})\n    $$\n    这是利用前述步骤的结果计算得出的。\n\n8.  **生成项剖面分析**：找出生成项剖面的最大值 $P_{\\max}^{+}$ 及其对应的壁面法向位置 $y_{\\max}^{+}$。根据问题规定，如果多个网格点（在 $10^{-6}$ 的相对容差内）共享最大值，则选择 $y^{+}$ 最小的那个点。\n\n9.  **缓冲层检查**：最后，将确定的最大生成项位置 $y_{\\max}^{+}$ 与指定的包含性缓冲层区间 $\\left[y_{\\mathrm{buf,min}}^{+},\\,y_{\\mathrm{buf,max}}^{+}\\right]$ 进行比较。返回一个布尔值，指示 $y_{\\max}^{+}$ 是否落在此范围内。湍流生成项的峰值是缓冲层的一个关键特征，因此该检查验证了我们合成模型的物理一致性。\n\n整个过程被封装在一个程序中，该程序处理每个测试用例并将结果聚合为所需的输出格式。",
            "answer": "[[11.50,0.252,True],[9.80,0.252,True],[8.20,0.247,True],[11.50,0.253,True]]"
        }
    ]
}