{
    "hands_on_practices": [
        {
            "introduction": "To build a robust understanding of slip phenomena, we begin with a foundational analytical exercise. This problem explores the classic scenario of pressure-driven flow in a circular pipe, an extension of Hagen-Poiseuille flow, by introducing a Navier slip condition at the wall. By deriving the velocity profile from the Navier-Stokes equations, you will gain direct insight into how slip alters the flow field compared to the traditional no-slip case, providing an essential benchmark for validating numerical simulations .",
            "id": "3994838",
            "problem": "Consider a steady, incompressible, laminar, fully developed flow of a Newtonian fluid of dynamic viscosity $\\mu$ through a long, straight, circular pipe of radius $R$ aligned with the $z$-axis. The axial velocity is $u(r)$, where $r$ is the radial coordinate. The mean pressure gradient is constant and denoted by $\\frac{\\mathrm{d}p}{\\mathrm{d}z}$, with $\\frac{\\mathrm{d}p}{\\mathrm{d}z} < 0$. Assume axisymmetry, no swirl, and negligible body forces. At the solid wall $r=R$, the flow satisfies the Navier slip boundary condition $u|_{r=R} = L_s \\left.\\frac{\\partial u}{\\partial n}\\right|_{r=R}$, where $L_s$ is the slip length and $\\frac{\\partial}{\\partial n}$ denotes the derivative along the inward wall-normal pointing into the fluid. \n\nStarting from the steady incompressible Navier–Stokes equations specialized to this configuration in cylindrical coordinates, derive:\n\n- The axial velocity profile $u(r)$ subject to the Navier slip boundary condition at $r=R$.\n- The wall shear stress $\\tau_w$ at $r=R$, expressed in terms of $\\mu$, $R$, and $\\frac{\\mathrm{d}p}{\\mathrm{d}z}$.\n- The change in centerline velocity due to slip, defined as $\\Delta u_c = u_c^{\\text{slip}} - u_c^{\\text{no-slip}}$, in terms of $L_s$, $R$, $\\mu$, and $\\frac{\\mathrm{d}p}{\\mathrm{d}z}$.\n\nEnsure your derivation proceeds from the governing equations and the boundary conditions, with appropriate regularity at $r=0$. Provide your final answer only as the single closed-form analytic expression for the change in centerline velocity $\\Delta u_c$. No numerical values are required, and no rounding is necessary. Do not include units in the final answer box.",
            "solution": "The problem is first validated against the specified criteria.\n- **Givens Extracted**:\n    - Fluid: Newtonian, dynamic viscosity $\\mu$.\n    - Flow: Steady, incompressible, laminar, fully developed.\n    - Geometry: Long, straight, circular pipe of radius $R$, aligned with the $z$-axis.\n    - Velocity: Axial velocity $u(r)$, where $r$ is the radial coordinate.\n    - Pressure Gradient: Constant mean pressure gradient $\\frac{\\mathrm{d}p}{\\mathrm{d}z} < 0$.\n    - Assumptions: Axisymmetry, no swirl ($u_\\theta=0$), negligible body forces.\n    - Boundary Condition ($r=R$): Navier slip, $u|_{r=R} = L_s \\left.\\frac{\\partial u}{\\partial n}\\right|_{r=R}$, with $L_s$ as the slip length and $\\frac{\\partial}{\\partial n}$ as the inward wall-normal derivative.\n- **Validation Verdict**:\n    - The problem is **scientifically grounded**, describing a standard fluid dynamics scenario (Hagen-Poiseuille flow) with a well-established slip boundary condition.\n    - It is **well-posed**, providing sufficient information (governing equations, geometry, boundary conditions, and an implicit regularity condition at $r=0$) to determine a unique solution.\n    - The language is **objective** and precise, using standard terminology.\n    - The setup is **complete and consistent**.\n    - The conditions are **physically plausible** within the context of idealized fluid mechanics.\nThe problem is deemed **valid**.\n\nThe analysis begins with the steady, incompressible Navier–Stokes equations in cylindrical coordinates $(r, \\theta, z)$. The velocity vector is $\\mathbf{v} = (u_r, u_\\theta, u_z)$. The problem states the flow is steady, axisymmetric ($\\frac{\\partial}{\\partial \\theta} = 0$), and has no swirl ($u_\\theta=0$). The axial velocity is a function of the radial coordinate only, $u_z=u(r)$, and for fully developed flow, $\\frac{\\partial u_z}{\\partial z} = 0$.\n\nThe continuity equation is $\\frac{1}{r}\\frac{\\partial(r u_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial u_\\theta}{\\partial \\theta} + \\frac{\\partial u_z}{\\partial z} = 0$. Applying the given simplifications, this reduces to $\\frac{1}{r}\\frac{\\partial(r u_r)}{\\partial r} = 0$. Integrating gives $r u_r = \\text{constant}$. Since the radial velocity at the impermeable wall must be zero, $u_r(R)=0$, the constant is zero, which means $u_r=0$ everywhere.\n\nWith $u_r=0$, $u_\\theta=0$, and $u_z=u(r)$, the momentum equations simplify significantly. Body forces are negligible.\nThe $r$-momentum equation becomes $0 = -\\frac{\\partial p}{\\partial r}$, indicating that pressure $p$ is not a function of the radial coordinate $r$.\nThe $\\theta$-momentum equation becomes $0=0$.\nThe $z$-momentum equation, which governs the axial flow, reduces to:\n$$0 = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial u_z}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 u_z}{\\partial \\theta^2} + \\frac{\\partial^2 u_z}{\\partial z^2} \\right]$$\nApplying the simplifications $u_z=u(r)$ and that $p$ is a function of $z$ only, we can use ordinary derivatives:\n$$\\frac{\\mathrm{d}p}{\\mathrm{d}z} = \\mu \\frac{1}{r}\\frac{\\mathrm{d}}{\\mathrm{d}r}\\left(r\\frac{\\mathrm{d}u}{\\mathrm{d}r}\\right)$$\nSince $\\frac{\\mathrm{d}p}{\\mathrm{d}z}$ is a given constant, we can integrate this ordinary differential equation. Rearranging gives:\n$$\\frac{\\mathrm{d}}{\\mathrm{d}r}\\left(r\\frac{\\mathrm{d}u}{\\mathrm{d}r}\\right) = \\frac{r}{\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}$$\nIntegrating with respect to $r$ yields:\n$$r\\frac{\\mathrm{d}u}{\\mathrm{d}r} = \\frac{r^2}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + C_1$$\nDividing by $r$ and integrating again:\n$$\\frac{\\mathrm{d}u}{\\mathrm{d}r} = \\frac{r}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + \\frac{C_1}{r}$$\n$$u(r) = \\frac{r^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + C_1 \\ln(r) + C_2$$\nWe must apply two conditions to determine the constants $C_1$ and $C_2$. First, a physical regularity condition at the centerline ($r=0$) requires the velocity to be finite. The term $C_1 \\ln(r)$ is singular at $r=0$, so we must have $C_1=0$. This also ensures the velocity gradient $\\frac{\\mathrm{d}u}{\\mathrm{d}r}$ is not singular at $r=0$, consistent with axisymmetry. The solution is thus of the form:\n$$u(r) = \\frac{r^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + C_2$$\nThe second condition is the Navier slip condition at the pipe wall, $r=R$:\n$$u|_{r=R} = L_s \\left.\\frac{\\partial u}{\\partial n}\\right|_{r=R}$$\nThe inward wall-normal direction corresponds to the $-r$ direction, so $\\frac{\\partial}{\\partial n} = -\\frac{\\partial}{\\partial r}$. The boundary condition becomes:\n$$u(R) = -L_s \\left.\\frac{\\mathrm{d}u}{\\mathrm{d}r}\\right|_{r=R}$$\nWe evaluate the terms:\n$$u(R) = \\frac{R^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + C_2$$\n$$\\frac{\\mathrm{d}u}{\\mathrm{d}r} = \\frac{r}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} \\implies \\left.\\frac{\\mathrm{d}u}{\\mathrm{d}r}\\right|_{r=R} = \\frac{R}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}$$\nSubstituting into the boundary condition:\n$$\\frac{R^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + C_2 = -L_s \\left(\\frac{R}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}\\right)$$\nSolving for $C_2$:\n$$C_2 = -\\frac{R^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} - \\frac{2L_s R}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 + 2L_s R)$$\nNow we can write the complete solution for the velocity profile.\n\n- **Axial velocity profile $u(r)$:**\nSubstituting $C_2$ back into the expression for $u(r)$:\n$$u(r) = \\frac{r^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} - \\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 + 2L_s R) = \\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(r^2 - R^2 - 2L_s R)$$\nSince $\\frac{\\mathrm{d}p}{\\mathrm{d}z} < 0$, it is convenient to write this as:\n$$u(r) = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 - r^2 + 2L_s R)$$\n\n- **Wall shear stress $\\tau_w$:**\nThe shear stress component is $\\tau_{rz} = \\mu \\frac{\\mathrm{d}u}{\\mathrm{d}r}$. The wall shear stress $\\tau_w$ is this component evaluated at the wall, $r=R$.\n$$\\tau_w = \\tau_{rz}|_{r=R} = \\mu \\left.\\frac{\\mathrm{d}u}{\\mathrm{d}r}\\right|_{r=R} = \\mu \\left(\\frac{R}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}\\right) = \\frac{R}{2}\\frac{\\mathrm{d}p}{\\mathrm{d}z}$$\nThis result stems from the global momentum balance on the fluid column and is independent of the viscosity or the specific wall condition (slip or no-slip), a key feature in fully developed pipe flow analysis, often used in fields like Computational Fluid Dynamics (CFD).\n\n- **Change in centerline velocity $\\Delta u_c$:**\nFirst, we find the centerline velocity for the slip case, $u_c^{\\text{slip}}$, by evaluating $u(r)$ at $r=0$:\n$$u_c^{\\text{slip}} = u(0) = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 + 2L_s R)$$\nNext, we find the centerline velocity for the standard no-slip case, $u_c^{\\text{no-slip}}$. The no-slip condition corresponds to $L_s=0$. Setting $L_s=0$ in the slip profile gives the classic Poiseuille profile:\n$$u^{\\text{no-slip}}(r) = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 - r^2)$$\nThe centerline velocity for the no-slip case is:\n$$u_c^{\\text{no-slip}} = u^{\\text{no-slip}}(0) = -\\frac{R^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}$$\nThe change in centerline velocity due to slip, $\\Delta u_c = u_c^{\\text{slip}} - u_c^{\\text{no-slip}}$, is:\n$$\\Delta u_c = \\left(-\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 + 2L_s R)\\right) - \\left(-\\frac{R^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}\\right)$$\n$$\\Delta u_c = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} \\left[ (R^2 + 2L_s R) - R^2 \\right]$$\n$$\\Delta u_c = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} (2L_s R) = -\\frac{L_s R}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}$$\nThis expression gives the increase in centerline velocity resulting from the presence of slip at the wall.",
            "answer": "$$\\boxed{-\\frac{L_s R}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}z}}$$"
        },
        {
            "introduction": "While analytical solutions provide crucial physical insight, most real-world aerospace problems demand numerical approaches. This practice bridges the gap between continuous theory and discrete computation by focusing on the implementation of boundary conditions in Computational Fluid Dynamics (CFD). You will derive the 'ghost-cell' value required to enforce a no-slip Dirichlet condition with second-order accuracy, a fundamental and ubiquitous technique in finite-volume methods that ensures the fidelity of the simulation at solid surfaces .",
            "id": "3994834",
            "problem": "In a finite-volume discretization of the compressible Navier–Stokes equations for aerospace Computational Fluid Dynamics (CFD), consider a planar solid wall with a prescribed no-slip Dirichlet condition for the velocity vector. Let the wall face center be located at position $\\boldsymbol{x}_f$, and let the discrete wall-normal coordinate be $n$, with $n=0$ at $\\boldsymbol{x}_f$. The interior cell center adjacent to the wall lies at $n=+d_i$ with velocity $\\boldsymbol{u}_i$, and a ghost-cell center is introduced at $n=-d_g$ with unknown velocity $\\boldsymbol{u}_g$. The wall-prescribed velocity is $\\boldsymbol{u}_w$ at $n=0$. Assume that each component of the velocity field is at least twice continuously differentiable in a neighborhood of the wall.\n\nYou wish to enforce the no-slip Dirichlet condition at the wall face center with second-order accuracy by reconstructing the face value from the two neighboring cell-centered values along the wall-normal line. Starting from the Taylor series about $n=0$ and using only the assumption that the reconstruction between $n=-d_g$ and $n=+d_i$ is linear in $n$ (so that the reconstructed face value is the value of the unique linear function passing through the two cell-centered points), derive an expression for $\\boldsymbol{u}_g$ in terms of $\\boldsymbol{u}_w$, $\\boldsymbol{u}_i$, $d_i$, and $d_g$ that enforces the Dirichlet value at $n=0$ with a truncation error that is second order in the distances $d_i$ and $d_g$.\n\nThen specialize to a uniform arrangement symmetric about the face center, $d_i=d_g$, and evaluate the ghost-cell velocity for the following data:\n- $\\boldsymbol{u}_w = (0.8,\\,-0.3,\\,0.1)$,\n- $\\boldsymbol{u}_i = (1.9,\\,0.5,\\,-0.4)$.\n\nReport your final ghost-cell velocity as a single row vector with three entries, rounded to four significant figures. Express the ghost-cell velocity components in meters per second.",
            "solution": "The problem asks for the derivation of a ghost-cell velocity vector $\\boldsymbol{u}_g$ that enforces a Dirichlet boundary condition $\\boldsymbol{u}_w$ at a solid wall with second-order accuracy. It then requires the evaluation of this ghost-cell velocity for a specific case.\n\n### Step 1: Problem Validation\n\nThe problem is first assessed for validity.\n\n**Givens Extracted:**\n- A finite-volume discretization of compressible Navier-Stokes equations is considered.\n- A planar solid wall has a prescribed no-slip Dirichlet condition for the velocity vector, $\\boldsymbol{u}_w$, at the wall face center $\\boldsymbol{x}_f$.\n- The wall-normal coordinate is $n$, with $n=0$ at the wall face center.\n- An interior cell center is at $n=+d_i$ with velocity $\\boldsymbol{u}_i$.\n- A ghost-cell center is at $n=-d_g$ with an unknown velocity $\\boldsymbol{u}_g$.\n- The velocity field components are assumed to be at least twice continuously differentiable ($C^2$) near the wall.\n- The primary constraint for the derivation is that the reconstruction of the velocity field between the points at $n=-d_g$ and $n=+d_i$ is linear in the coordinate $n$.\n- The objective is to derive an expression for $\\boldsymbol{u}_g$ in terms of $\\boldsymbol{u}_w$, $\\boldsymbol{u}_i$, $d_i$, and $d_g$. This expression must enforce the Dirichlet condition at $n=0$ with a truncation error that is second order.\n- A special case is considered where $d_i=d_g$.\n- Numerical data for the special case: $\\boldsymbol{u}_w = (0.8,\\,-0.3,\\,0.1)$ and $\\boldsymbol{u}_i = (1.9,\\,0.5,\\,-0.4)$.\n- The final numerical answer for $\\boldsymbol{u}_g$ should be a row vector, with components rounded to four significant figures, expressed in meters per second.\n\n**Validation Analysis:**\nThe problem is well-defined within the context of standard numerical methods for Computational Fluid Dynamics (CFD). The use of ghost cells to enforce boundary conditions is a fundamental technique. The problem specifies a method—linear reconstruction—and asks for a derivation based on it, while also connecting this method to the concept of second-order accuracy.\n\nThe phrase \"Starting from the Taylor series ... and using only the assumption that the reconstruction ... is linear\" might initially seem contradictory. However, these two points are reconciled by understanding that Taylor series analysis is used to determine the order of accuracy of the scheme that results from the linear reconstruction assumption. A linear interpolation of a $C^2$ function between two points provides a second-order accurate approximation for values between those points. The problem is therefore scientifically sound and internally consistent. It provides all necessary information and constraints to arrive at a unique solution. The problem is deemed **valid**.\n\n### Step 2: Derivation of the Ghost-Cell Velocity\n\nThe derivation will be performed for a single scalar component of the velocity, $u$. The result is directly applicable to the vector quantity $\\boldsymbol{u}$ since the operations are linear.\n\nThe core instruction is to use a linear reconstruction for the velocity profile $u(n)$ between the ghost-cell center at $n=-d_g$ and the interior cell center at $n=+d_i$. A linear function of $n$ can be written as $u_{rec}(n) = an + b$. The coefficients $a$ and $b$ are determined by requiring the function to pass through the two known points in the stencil: $(n, u) = (-d_g, u_g)$ and $(n, u) = (d_i, u_i)$.\n\nWe have a system of two linear equations for $a$ and $b$:\n$$\nu_g = a(-d_g) + b\n$$\n$$\nu_i = a(d_i) + b\n$$\nSubtracting the first equation from the second gives:\n$$\nu_i - u_g = a(d_i) - a(-d_g) = a(d_i + d_g)\n$$\nSolving for the slope $a$:\n$$\na = \\frac{u_i - u_g}{d_i + d_g}\n$$\nThe intercept $b$ is the value of the reconstructed profile at $n=0$, i.e., $u_{rec}(0) = b$. We can solve for $b$ using the second equation: $b = u_i - a d_i$.\n$$\nb = u_i - \\left(\\frac{u_i - u_g}{d_i + d_g}\\right) d_i = \\frac{u_i(d_i + d_g) - (u_i - u_g)d_i}{d_i + d_g} = \\frac{u_i d_i + u_i d_g - u_i d_i + u_g d_i}{d_i + d_g} = \\frac{u_i d_g + u_g d_i}{d_i + d_g}\n$$\nThe Dirichlet boundary condition is enforced by setting the reconstructed value at the wall face ($n=0$) equal to the prescribed wall velocity, $u_w$.\n$$\nu_{rec}(0) = u_w\n$$\nTherefore, we must have:\n$$\nu_w = b = \\frac{u_g d_i + u_i d_g}{d_i + d_g}\n$$\nThis equation establishes the relationship between the cell-centered values and the wall value based on linear reconstruction. The problem states that the velocity field is $C^2$. A Taylor series expansion of the true field $u(n)$ around $n=0$ shows that the error of this linear interpolation, $u_{rec}(0) - u(0)$, is of order $O(d_i d_g)$, which is a second-order truncation error. This justifies the \"second-order accuracy\" claim for the implementation of the boundary condition.\n\nNow, we solve for the unknown ghost-cell value, $u_g$:\n$$\nu_w (d_i + d_g) = u_g d_i + u_i d_g\n$$\n$$\nu_g d_i = u_w (d_i + d_g) - u_i d_g\n$$\n$$\nu_g = \\frac{d_i + d_g}{d_i} u_w - \\frac{d_g}{d_i} u_i\n$$\nThis expression can be written as:\n$$\nu_g = \\left(1 + \\frac{d_g}{d_i}\\right) u_w - \\frac{d_g}{d_i} u_i\n$$\nThis derivation holds for each component of the velocity vector. Therefore, the vector expression is:\n$$\n\\boldsymbol{u}_g = \\frac{d_i + d_g}{d_i} \\boldsymbol{u}_w - \\frac{d_g}{d_i} \\boldsymbol{u}_i\n$$\n\n### Step 3: Specialization and Numerical Evaluation\n\nThe problem asks to specialize this result to a uniform symmetric arrangement, where $d_i = d_g$. Let's set $d_i = d_g = d$.\nSubstituting into the derived expression:\n$$\n\\boldsymbol{u}_g = \\frac{d + d}{d} \\boldsymbol{u}_w - \\frac{d}{d} \\boldsymbol{u}_i\n$$\n$$\n\\boldsymbol{u}_g = 2 \\boldsymbol{u}_w - \\boldsymbol{u}_i\n$$\nThis is the well-known \"mirroring\" formula for ghost cells with a Dirichlet condition on a symmetric grid.\n\nNow, we substitute the provided numerical data into this simplified formula. The problem statement implies the numerical values represent velocities in meters per second.\n- Prescribed wall velocity: $\\boldsymbol{u}_w = (0.8,\\,-0.3,\\,0.1)$\n- Interior cell velocity: $\\boldsymbol{u}_i = (1.9,\\,0.5,\\,-0.4)$\n\nFirst, calculate $2\\boldsymbol{u}_w$:\n$$\n2\\boldsymbol{u}_w = 2 \\times (0.8,\\,-0.3,\\,0.1) = (1.6,\\,-0.6,\\,0.2)\n$$\nNext, subtract $\\boldsymbol{u}_i$ from $2\\boldsymbol{u}_w$ to find $\\boldsymbol{u}_g$:\n$$\n\\boldsymbol{u}_g = (1.6,\\,-0.6,\\,0.2) - (1.9,\\,0.5,\\,-0.4)\n$$\nThe components are calculated as:\n$$\nu_{g,x} = 1.6 - 1.9 = -0.3\n$$\n$$\nu_{g,y} = -0.6 - 0.5 = -1.1\n$$\n$$\nu_{g,z} = 0.2 - (-0.4) = 0.2 + 0.4 = 0.6\n$$\nSo, the ghost-cell velocity vector is $\\boldsymbol{u}_g = (-0.3,\\,-1.1,\\,0.6)$.\n\nThe problem requires rounding each component to four significant figures.\n- The first component, $-0.3$, becomes $-0.3000$.\n- The second component, $-1.1$, becomes $-1.100$.\n- The third component, $0.6$, becomes $0.6000$.\n\nThe final ghost-cell velocity vector is $\\boldsymbol{u}_g = (-0.3000,\\,-1.100,\\,0.6000)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.3000  -1.100  0.6000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building upon the numerical foundations, our final practice addresses the challenges posed by complex, realistic geometries common in aerospace engineering. This exercise moves beyond idealized grids to tackle the computation of velocity gradients on an unstructured mesh near a curved wall, using a robust least-squares reconstruction method. Mastering this technique is critical for accurately determining essential engineering quantities like wall shear stress, which is directly related to viscous drag on an aircraft surface .",
            "id": "3994862",
            "problem": "Consider a three-dimensional viscous flow in the neighborhood of a smooth curved aerospace wall. Let a particular wall point be located at $\\boldsymbol{x}_0 = (0,0,0)$ with local unit normal $\\boldsymbol{n} = (0,0,1)$. Assume the no-slip boundary condition holds at the wall, so $\\boldsymbol{u}(\\boldsymbol{x}_0) = \\boldsymbol{0}$. In a sufficiently small tubular neighborhood around the wall, treat $\\boldsymbol{n}$ as constant along the wall-normal coordinate. The tangential velocity vector at the wall is defined by the orthogonal projection $\\boldsymbol{u}_t = (\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top})\\,\\boldsymbol{u}$, and the wall-normal directional derivative of any sufficiently smooth scalar $\\phi$ is $\\partial \\phi/\\partial n = \\boldsymbol{n}\\cdot\\nabla \\phi$.\n\nYou are given an unstructured mesh with five interior sample points located at\n$\\boldsymbol{x}_1 = (0.4,\\,0,\\,0.2)$, $\\boldsymbol{x}_2 = (-0.4,\\,0,\\,0.2)$, $\\boldsymbol{x}_3 = (0,\\,0.4,\\,0.2)$, $\\boldsymbol{x}_4 = (0,\\,-0.4,\\,0.2)$, and $\\boldsymbol{x}_5 = (0,\\,0,\\,0.3)$, in units of $\\mathrm{m}$. The corresponding measured velocity vectors, in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, are\n$\\boldsymbol{u}(\\boldsymbol{x}_1) = (0.8,\\,-0.4,\\,0)$, $\\boldsymbol{u}(\\boldsymbol{x}_2) = (0.8,\\,-0.4,\\,0)$, $\\boldsymbol{u}(\\boldsymbol{x}_3) = (0.8,\\,-0.4,\\,0)$, $\\boldsymbol{u}(\\boldsymbol{x}_4) = (0.8,\\,-0.4,\\,0)$, and $\\boldsymbol{u}(\\boldsymbol{x}_5) = (1.2,\\,-0.6,\\,0)$.\n\nStarting from the definitions and the least-squares construction that fits a constant Jacobian $\\boldsymbol{J}$ such that $\\boldsymbol{u}(\\boldsymbol{x}_i) \\approx \\boldsymbol{u}(\\boldsymbol{x}_0) + \\boldsymbol{J}(\\boldsymbol{x}_i - \\boldsymbol{x}_0)$, derive the normal equations and compute the best-fit $\\boldsymbol{J}$ using equal weights. Then, using only these fundamentals, derive and compute the wall-normal derivative of the tangential velocity vector at $\\boldsymbol{x}_0$, namely $\\partial \\boldsymbol{u}_t/\\partial n$ evaluated at the wall, expressed as a three-component vector.\n\nDiscuss briefly, based on your derivation, how mesh skewness (non-orthogonality of sample point displacements with respect to $\\boldsymbol{n}$) affects the accuracy of the computed $\\partial \\boldsymbol{u}_t/\\partial n$ for linear and weakly nonlinear fields, and what role the geometric consistency of $\\boldsymbol{n}$ plays.\n\nExpress the final derivative vector components in $\\mathrm{s}^{-1}$ and round your numerical answer to four significant figures.",
            "solution": "The user wants to find the solution to a problem about solid wall boundary conditions.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n- A three-dimensional viscous flow near a smooth curved aerospace wall.\n- A wall point is located at $\\boldsymbol{x}_0 = (0,0,0)$.\n- The local unit normal at $\\boldsymbol{x}_0$ is $\\boldsymbol{n} = (0,0,1)$.\n- The no-slip boundary condition holds: $\\boldsymbol{u}(\\boldsymbol{x}_0) = \\boldsymbol{0}$.\n- In a small neighborhood, $\\boldsymbol{n}$ is treated as constant.\n- Tangential velocity vector definition: $\\boldsymbol{u}_t = (\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top})\\,\\boldsymbol{u}$.\n- Wall-normal directional derivative definition for a scalar $\\phi$: $\\partial \\phi/\\partial n = \\boldsymbol{n}\\cdot\\nabla \\phi$.\n- Five interior sample points $\\boldsymbol{x}_i$ (in $\\mathrm{m}$):\n  $\\boldsymbol{x}_1 = (0.4,\\,0,\\,0.2)$, $\\boldsymbol{x}_2 = (-0.4,\\,0,\\,0.2)$, $\\boldsymbol{x}_3 = (0,\\,0.4,\\,0.2)$, $\\boldsymbol{x}_4 = (0,\\,-0.4,\\,0.2)$, and $\\boldsymbol{x}_5 = (0,\\,0,\\,0.3)$.\n- Corresponding velocity vectors $\\boldsymbol{u}(\\boldsymbol{x}_i)$ (in $\\mathrm{m}\\,\\mathrm{s}^{-1}$):\n  $\\boldsymbol{u}(\\boldsymbol{x}_1) = (0.8,\\,-0.4,\\,0)$, $\\boldsymbol{u}(\\boldsymbol{x}_2) = (0.8,\\,-0.4,\\,0)$, $\\boldsymbol{u}(\\boldsymbol{x}_3) = (0.8,\\,-0.4,\\,0)$, $\\boldsymbol{u}(\\boldsymbol{x}_4) = (0.8,\\,-0.4,\\,0)$, and $\\boldsymbol{u}(\\boldsymbol{x}_5) = (1.2,\\,-0.6,\\,0)$.\n- The task is to use a least-squares construction to find the Jacobian $\\boldsymbol{J}$ from the linear approximation $\\boldsymbol{u}(\\boldsymbol{x}_i) \\approx \\boldsymbol{u}(\\boldsymbol{x}_0) + \\boldsymbol{J}(\\boldsymbol{x}_i - \\boldsymbol{x}_0)$.\n- Subsequently, derive and compute the wall-normal derivative of the tangential velocity vector, $\\partial \\boldsymbol{u}_t/\\partial n$, at $\\boldsymbol{x}_0$.\n- Finally, discuss the effects of mesh skewness and geometric consistency of $\\boldsymbol{n}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the principles of fluid dynamics and numerical methods (specifically, gradient reconstruction in CFD). The use of a Taylor series expansion and a least-squares fit to determine the local velocity gradient tensor (Jacobian) is a standard technique. All necessary data are provided, and there are no internal contradictions. The number of data points ($5$) provides enough information to solve for the $9$ components of the Jacobian in an overdetermined least-squares sense ($5 \\times 3 = 15$ scalar equations for $9$ unknowns). The problem is well-posed and objective. All validation criteria are met.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### **Solution Derivation**\n\nThe problem asks for the computation of the velocity Jacobian $\\boldsymbol{J}$ at the wall point $\\boldsymbol{x}_0 = \\boldsymbol{0}$ and subsequently the wall-normal derivative of the tangential velocity, $\\partial \\boldsymbol{u}_t/\\partial n$.\n\n**Part 1: Least-Squares Computation of the Jacobian $\\boldsymbol{J}$**\n\nThe velocity field $\\boldsymbol{u}(\\boldsymbol{x})$ in the vicinity of $\\boldsymbol{x}_0$ is approximated by a first-order Taylor expansion:\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) \\approx \\boldsymbol{u}(\\boldsymbol{x}_0) + (\\nabla \\boldsymbol{u})_{\\boldsymbol{x}_0} (\\boldsymbol{x} - \\boldsymbol{x}_0)\n$$\nHere, $\\nabla \\boldsymbol{u}$ is the velocity gradient tensor, which we represent by the Jacobian matrix $\\boldsymbol{J}$. Its components are $J_{ij} = \\partial u_i / \\partial x_j$. Given the no-slip condition $\\boldsymbol{u}(\\boldsymbol{x}_0) = \\boldsymbol{0}$ and $\\boldsymbol{x}_0=\\boldsymbol{0}$, the model simplifies to:\n$$\n\\boldsymbol{u}(\\boldsymbol{x}_i) \\approx \\boldsymbol{J} \\boldsymbol{x}_i\n$$\nfor the five sample points $i = 1, \\dots, 5$. We seek the matrix $\\boldsymbol{J}$ that minimizes the sum of squared residuals $S$:\n$$\nS = \\sum_{i=1}^{5} ||\\boldsymbol{u}_i - \\boldsymbol{J} \\boldsymbol{x}_i||^2\n$$\nwhere $\\boldsymbol{u}_i = \\boldsymbol{u}(\\boldsymbol{x}_i)$. This problem can be decoupled for each row of the Jacobian matrix $\\boldsymbol{J}$. Let $\\boldsymbol{j}_k^{\\top}$ be the $k$-th row of $\\boldsymbol{J}$ (so $\\boldsymbol{j}_k$ is a column vector). The $k$-th component of the velocity at point $i$, denoted $u_{ik}$, is given by $u_{ik} = \\boldsymbol{j}_k^{\\top} \\boldsymbol{x}_i$. We can write this for all $5$ points in matrix form. Let $\\boldsymbol{u}^{(k)}$ be the column vector of the $k$-th velocity components across all points, and let $\\boldsymbol{X}$ be the matrix whose rows are the position vectors $\\boldsymbol{x}_i^{\\top}$:\n$$\n\\boldsymbol{X} \\boldsymbol{j}_k = \\boldsymbol{u}^{(k)}\n$$\nThis is an overdetermined system for each $\\boldsymbol{j}_k$ ($k=1,2,3$). The normal equations for the least-squares problem are derived by premultiplying by $\\boldsymbol{X}^{\\top}$:\n$$\n(\\boldsymbol{X}^{\\top}\\boldsymbol{X}) \\boldsymbol{j}_k = \\boldsymbol{X}^{\\top} \\boldsymbol{u}^{(k)}\n$$\nThe solution for each row vector of the Jacobian is then:\n$$\n\\boldsymbol{j}_k = (\\boldsymbol{X}^{\\top}\\boldsymbol{X})^{-1} \\boldsymbol{X}^{\\top} \\boldsymbol{u}^{(k)}\n$$\nFirst, we construct the matrix $\\boldsymbol{X}$ from the given sample point coordinates:\n$$\n\\boldsymbol{X} = \\begin{pmatrix} \\boldsymbol{x}_1^{\\top} \\\\ \\boldsymbol{x}_2^{\\top} \\\\ \\boldsymbol{x}_3^{\\top} \\\\ \\boldsymbol{x}_4^{\\top} \\\\ \\boldsymbol{x}_5^{\\top} \\end{pmatrix} = \\begin{pmatrix} 0.4  0  0.2 \\\\ -0.4  0  0.2 \\\\ 0  0.4  0.2 \\\\ 0  -0.4  0.2 \\\\ 0  0  0.3 \\end{pmatrix}\n$$\nNext, we compute $\\boldsymbol{X}^{\\top}\\boldsymbol{X}$:\n$$\n\\boldsymbol{X}^{\\top}\\boldsymbol{X} = \\begin{pmatrix} 0.4  -0.4  0  0  0 \\\\ 0  0  0.4  -0.4  0 \\\\ 0.2  0.2  0.2  0.2  0.3 \\end{pmatrix} \\begin{pmatrix} 0.4  0  0.2 \\\\ -0.4  0  0.2 \\\\ 0  0.4  0.2 \\\\ 0  -0.4  0.2 \\\\ 0  0  0.3 \\end{pmatrix} = \\begin{pmatrix} 0.32  0  0 \\\\ 0  0.32  0 \\\\ 0  0  0.25 \\end{pmatrix}\n$$\nThe matrix is diagonal due to the symmetric placement of the sample points. Its inverse is trivial to compute:\n$$\n(\\boldsymbol{X}^{\\top}\\boldsymbol{X})^{-1} = \\begin{pmatrix} \\frac{1}{0.32}  0  0 \\\\ 0  \\frac{1}{0.32}  0 \\\\ 0  0  \\frac{1}{0.25} \\end{pmatrix} = \\begin{pmatrix} 3.125  0  0 \\\\ 0  3.125  0 \\\\ 0  0  4 \\end{pmatrix}\n$$\nNow we assemble the velocity component vectors $\\boldsymbol{u}^{(1)}$, $\\boldsymbol{u}^{(2)}$, and $\\boldsymbol{u}^{(3)}$:\n$$\n\\boldsymbol{u}^{(1)} = \\begin{pmatrix} 0.8 \\\\ 0.8 \\\\ 0.8 \\\\ 0.8 \\\\ 1.2 \\end{pmatrix}, \\quad \\boldsymbol{u}^{(2)} = \\begin{pmatrix} -0.4 \\\\ -0.4 \\\\ -0.4 \\\\ -0.4 \\\\ -0.6 \\end{pmatrix}, \\quad \\boldsymbol{u}^{(3)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nWe compute the right-hand side of the normal equations, $\\boldsymbol{X}^{\\top}\\boldsymbol{u}^{(k)}$, for each component.\nFor $\\boldsymbol{j}_1$ (first row of $\\boldsymbol{J}$):\n$$\n\\boldsymbol{X}^{\\top}\\boldsymbol{u}^{(1)} = \\begin{pmatrix} 0.4  -0.4  0  0  0 \\\\ 0  0  0.4  -0.4  0 \\\\ 0.2  0.2  0.2  0.2  0.3 \\end{pmatrix} \\begin{pmatrix} 0.8 \\\\ 0.8 \\\\ 0.8 \\\\ 0.8 \\\\ 1.2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1.0 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{j}_1 = (\\boldsymbol{X}^{\\top}\\boldsymbol{X})^{-1} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1.0 \\end{pmatrix} = \\begin{pmatrix} 3.125  0  0 \\\\ 0  3.125  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1.0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 4 \\end{pmatrix}\n$$\nFor $\\boldsymbol{j}_2$ (second row of $\\boldsymbol{J}$):\n$$\n\\boldsymbol{X}^{\\top}\\boldsymbol{u}^{(2)} = \\begin{pmatrix} 0.4  -0.4  0  0  0 \\\\ 0  0  0.4  -0.4  0 \\\\ 0.2  0.2  0.2  0.2  0.3 \\end{pmatrix} \\begin{pmatrix} -0.4 \\\\ -0.4 \\\\ -0.4 \\\\ -0.4 \\\\ -0.6 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -0.5 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{j}_2 = (\\boldsymbol{X}^{\\top}\\boldsymbol{X})^{-1} \\begin{pmatrix} 0 \\\\ 0 \\\\ -0.5 \\end{pmatrix} = \\begin{pmatrix} 3.125  0  0 \\\\ 0  3.125  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ -0.5 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -2 \\end{pmatrix}\n$$\nFor $\\boldsymbol{j}_3$ (third row of $\\boldsymbol{J}$), since $\\boldsymbol{u}^{(3)} = \\boldsymbol{0}$, we immediately have $\\boldsymbol{X}^{\\top}\\boldsymbol{u}^{(3)} = \\boldsymbol{0}$ and thus $\\boldsymbol{j}_3 = \\boldsymbol{0}$.\n\nAssembling the rows, the Jacobian matrix is:\n$$\n\\boldsymbol{J} = \\begin{pmatrix} \\boldsymbol{j}_1^{\\top} \\\\ \\boldsymbol{j}_2^{\\top} \\\\ \\boldsymbol{j}_3^{\\top} \\end{pmatrix} = \\begin{pmatrix} 0  0  4 \\\\ 0  0  -2 \\\\ 0  0  0 \\end{pmatrix}\n$$\n\n**Part 2: Derivation and Computation of $\\partial \\boldsymbol{u}_t/\\partial n$**\n\nWe need to compute the wall-normal derivative of the tangential velocity vector, $\\partial \\boldsymbol{u}_t/\\partial n$, evaluated at $\\boldsymbol{x}_0$. The tangential velocity is defined as $\\boldsymbol{u}_t = (\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top})\\,\\boldsymbol{u}$. The wall-normal derivative operator is $\\partial/\\partial n \\equiv \\boldsymbol{n}\\cdot\\nabla$.\nApplying this operator to $\\boldsymbol{u}_t$:\n$$\n\\frac{\\partial \\boldsymbol{u}_t}{\\partial n} = \\frac{\\partial}{\\partial n} \\left[ (\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top}) \\boldsymbol{u} \\right]\n$$\nThe problem states that in the tubular neighborhood of the wall, $\\boldsymbol{n}$ can be treated as constant. This assumption is crucial as it allows the projection operator $(\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top})$ to be treated as a constant matrix, which can be factored out of the differentiation:\n$$\n\\frac{\\partial \\boldsymbol{u}_t}{\\partial n} = (\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top}) \\frac{\\partial \\boldsymbol{u}}{\\partial n}\n$$\nThe term $\\partial \\boldsymbol{u}/\\partial n$ is the directional derivative of the vector field $\\boldsymbol{u}$ in the direction of $\\boldsymbol{n}$. This is computed by applying the Jacobian matrix to the direction vector:\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial n} = \\boldsymbol{J}\\boldsymbol{n}\n$$\nWe have $\\boldsymbol{J}$ from Part 1 and are given $\\boldsymbol{n} = (0, 0, 1)^{\\top}$.\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial n} = \\begin{pmatrix} 0  0  4 \\\\ 0  0  -2 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ -2 \\\\ 0 \\end{pmatrix}\n$$\nThis vector represents the rate of change of the velocity vector as one moves in the normal direction away from the wall. Now we apply the tangential projection. The projection matrix is:\n$$\n\\boldsymbol{n}\\boldsymbol{n}^{\\top} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nApplying this projector to $\\partial \\boldsymbol{u}/\\partial n$:\n$$\n\\frac{\\partial \\boldsymbol{u}_t}{\\partial n} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ -2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ -2 \\\\ 0 \\end{pmatrix}\n$$\nThe resulting vector has units of velocity per length, which is $\\mathrm{s}^{-1}$. The components are $(4, -2, 0)$. Rounding to four significant figures gives $(4.000, -2.000, 0.000)$.\n\n**Part 3: Discussion on Mesh Skewness and Geometric Consistency**\n\nThe derivation provides insight into how the quality of the mesh and geometric assumptions impact the accuracy of the computed derivative.\n\n*   **Mesh Skewness**: Mesh skewness refers to the non-orthogonality of the cell-face normals or, in this context, the non-orthogonality in the distribution of sample points. The given sample points form an orthogonal stencil in the sense that the matrix $\\boldsymbol{X}^{\\top}\\boldsymbol{X}$ is diagonal. This leads to a decoupling in the calculation of the spatial derivatives $\\partial/\\partial x$, $\\partial/\\partial y$, and $\\partial/\\partial z$. For example, the calculation of $\\boldsymbol{j}_1 = (\\partial u_1/\\partial x, \\partial u_1/\\partial y, \\partial u_1/\\partial z)^{\\top}$ was separated into three independent estimations.\n    *   For **linear velocity fields**, as is the case here where the data perfectly fits a linear model, the least-squares method provides the exact Jacobian irrespective of mesh skewness (provided $\\boldsymbol{X}^{\\top}\\boldsymbol{X}$ is invertible). Skewness does not degrade accuracy in this ideal case.\n    *   For **weakly nonlinear fields**, where $\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{J}\\boldsymbol{x} + \\mathcal{O}(||\\boldsymbol{x}||^2)$, the linear model is an approximation. A skewed mesh samples the field in an unbalanced manner. The resulting $\\boldsymbol{X}^{\\top}\\boldsymbol{X}$ matrix would be non-diagonal, coupling the estimation of all gradient components. Truncation errors from the higher-order terms would not cancel out symmetrically and would contaminate all computed components of $\\boldsymbol{J}$, including the normal derivative terms that form $\\boldsymbol{J}\\boldsymbol{n}$. An orthogonal mesh, like the one provided, is more robust as it isolates the estimation of derivatives along different axes, minimizing this error cross-contamination.\n\n*   **Geometric Consistency of $\\boldsymbol{n}$**: The assumption that the normal vector $\\boldsymbol{n}$ is constant is an approximation valid only for a perfectly flat wall or in an infinitesimally small neighborhood of a curved wall. For a genuinely curved wall, $\\boldsymbol{n}$ is a function of position on the wall, $\\boldsymbol{n}(\\boldsymbol{x})$. The derivative formula would become more complex, involving the derivative of $\\boldsymbol{n}$ itself (i.e., wall curvature): $\\frac{\\partial \\boldsymbol{u}_t}{\\partial n} = \\frac{\\partial}{\\partial n}[(\\boldsymbol{I} - \\boldsymbol{n}(\\boldsymbol{x})\\boldsymbol{n}(\\boldsymbol{x})^{\\top})\\boldsymbol{u}(\\boldsymbol{x})]$. Using a constant $\\boldsymbol{n}$ for both defining the tangential projection and the direction of differentiation introduces a geometric consistency error, which scales with the wall curvature and the size of the neighborhood. This simplification is a first-order approximation that neglects the effects of wall curvature on the local flow kinematics.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 4.000  -2.000  0.000 \\end{pmatrix}\n}\n$$"
        }
    ]
}