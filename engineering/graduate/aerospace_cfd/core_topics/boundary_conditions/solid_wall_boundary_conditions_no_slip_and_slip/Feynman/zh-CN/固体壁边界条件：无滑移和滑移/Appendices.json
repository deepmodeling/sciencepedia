{
    "hands_on_practices": [
        {
            "introduction": "我们从一个经典的解析问题开始，以建立对滑移边界条件的基本物理理解。这个练习探讨了圆管中的Hagen-Poiseuille流动，这是流体动力学的一个基石，但我们对其应用了Navier滑移边界条件。通过从第一性原理推导速度剖面，您将具体理解滑移长度如何改变流动结构并与无滑移情况进行对比，从而为滑移现象奠定坚实的物理和数学基础。",
            "id": "3994838",
            "problem": "考虑一种动力粘度为 $\\mu$ 的牛顿流体，在半径为 $R$、与 $z$ 轴对齐的长直圆形管道中进行稳定、不可压缩、层流、充分发展的流动。轴向速度为 $u(r)$，其中 $r$ 是径向坐标。平均压力梯度是一个常数，记为 $\\frac{\\mathrm{d}p}{\\mathrm{d}z}$，且 $\\frac{\\mathrm{d}p}{\\mathrm{d}z}  0$。假设流动是轴对称、无旋流，且体积力可忽略不计。在固体壁面 $r=R$ 处，流动满足 Navier 滑移边界条件 $u|_{r=R} = L_s \\left.\\frac{\\partial u}{\\partial n}\\right|_{r=R}$，其中 $L_s$ 是滑移长度，$\\frac{\\partial}{\\partial n}$ 表示沿指向流体内部的壁面法线方向的导数。\n\n从适用于此构型的柱坐标系下的稳定不可压缩 Navier–Stokes 方程出发，推导：\n\n- 满足 $r=R$ 处 Navier 滑移边界条件的轴向速度剖面 $u(r)$。\n- $r=R$ 处的壁面剪切应力 $\\tau_w$，用 $\\mu$、$R$ 和 $\\frac{\\mathrm{d}p}{\\mathrm{d}z}$ 表示。\n- 由滑移引起的中心线速度变化，定义为 $\\Delta u_c = u_c^{\\text{slip}} - u_c^{\\text{no-slip}}$，用 $L_s$、$R$、$\\mu$ 和 $\\frac{\\mathrm{d}p}{\\mathrm{d}z}$ 表示。\n\n确保您的推导从控制方程和边界条件出发，并考虑在 $r=0$ 处的适当正则性条件。为清晰起见，在首次出现时定义计算流体力学（Computational Fluid Dynamics, CFD）这一缩写。仅提供中心线速度变化 $\\Delta u_c$ 的单个闭式解析表达式作为最终答案。无需提供数值，也无需进行四舍五入。不要在最终答案框中包含单位。",
            "solution": "首先根据指定标准对问题进行验证。\n- **已提取的已知条件**：\n    - 流体：牛顿流体，动力粘度 $\\mu$。\n    - 流动：稳定、不可压缩、层流、充分发展。\n    - 几何：长直圆形管道，半径为 $R$，与 $z$ 轴对齐。\n    - 速度：轴向速度 $u(r)$，其中 $r$ 为径向坐标。\n    - 压力梯度：恒定的平均压力梯度 $\\frac{\\mathrm{d}p}{\\mathrm{d}z}  0$。\n    - 假设：轴对称，无旋流（$u_\\theta=0$），体积力可忽略不计。\n    - 边界条件 ($r=R$): Navier 滑移，$u|_{r=R} = L_s \\left.\\frac{\\partial u}{\\partial n}\\right|_{r=R}$，其中 $L_s$ 为滑移长度，$\\frac{\\partial}{\\partial n}$ 为指向内部的壁面法向导数。\n- **验证结论**：\n    - 问题**具有科学依据**，描述了一个标准的流体动力学场景（Hagen-Poiseuille 流），并采用了公认的滑移边界条件。\n    - 问题是**适定的**，提供了足够的信息（控制方程、几何形状、边界条件以及在 $r=0$ 处的隐式正则性条件）以确定唯一解。\n    - 语言**客观**且精确，使用了标准术语。\n    - 设置是**完整且一致的**。\n    - 在理想流体力学的背景下，这些条件是**物理上合理的**。\n问题被判定为**有效**。\n\n分析始于柱坐标系 $(r, \\theta, z)$ 下的稳定、不可压缩 Navier–Stokes 方程。速度矢量为 $\\mathbf{v} = (u_r, u_\\theta, u_z)$。问题陈述流动是稳定的、轴对称的（$\\frac{\\partial}{\\partial \\theta} = 0$），并且无旋流（$u_\\theta=0$）。轴向速度仅是径向坐标的函数，$u_z=u(r)$，对于充分发展的流动，有 $\\frac{\\partial u_z}{\\partial z} = 0$。\n\n连续性方程为 $\\frac{1}{r}\\frac{\\partial(r u_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial u_\\theta}{\\partial \\theta} + \\frac{\\partial u_z}{\\partial z} = 0$。应用给定的简化条件，该方程简化为 $\\frac{1}{r}\\frac{\\partial(r u_r)}{\\partial r} = 0$。积分得到 $r u_r = \\text{constant}$。由于在不可渗透的壁面处径向速度必须为零，即 $u_r(R)=0$，因此该常数为零，这意味着处处都有 $u_r=0$。\n\n在 $u_r=0$、$u_\\theta=0$ 和 $u_z=u(r)$ 的条件下，动量方程得到显著简化。体积力可忽略不计。\n$r$ 方向动量方程变为 $0 = -\\frac{\\partial p}{\\partial r}$，表明压力 $p$ 不是径向坐标 $r$ 的函数。\n$\\theta$ 方向动量方程变为 $0=0$。\n控制轴向流动的 $z$ 方向动量方程简化为：\n$$0 = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial u_z}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 u_z}{\\partial \\theta^2} + \\frac{\\partial^2 u_z}{\\partial z^2} \\right]$$\n应用 $u_z=u(r)$ 以及 $p$ 仅为 $z$ 的函数的简化条件，我们可以使用常微分：\n$$\\frac{\\mathrm{d}p}{\\mathrm{d}z} = \\mu \\frac{1}{r}\\frac{\\mathrm{d}}{\\mathrm{d}r}\\left(r\\frac{\\mathrm{d}u}{\\mathrm{d}r}\\right)$$\n由于 $\\frac{\\mathrm{d}p}{\\mathrm{d}z}$ 是一个给定的常数，我们可以对这个常微分方程进行积分。整理后得到：\n$$\\frac{\\mathrm{d}}{\\mathrm{d}r}\\left(r\\frac{\\mathrm{d}u}{\\mathrm{d}r}\\right) = \\frac{r}{\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}$$\n对 $r$ 积分，得到：\n$$r\\frac{\\mathrm{d}u}{\\mathrm{d}r} = \\frac{r^2}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + C_1$$\n除以 $r$ 并再次积分：\n$$\\frac{\\mathrm{d}u}{\\mathrm{d}r} = \\frac{r}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + \\frac{C_1}{r}$$\n$$u(r) = \\frac{r^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + C_1 \\ln(r) + C_2$$\n我们必须应用两个条件来确定常数 $C_1$ 和 $C_2$。首先，中心线（$r=0$）处的物理正则性条件要求速度是有限的。$C_1 \\ln(r)$ 项在 $r=0$ 处是奇异的，因此必须有 $C_1=0$。这也确保了速度梯度 $\\frac{\\mathrm{d}u}{\\mathrm{d}r}$ 在 $r=0$ 处不是奇异的，这与轴对称性相符。因此，解的形式为：\n$$u(r) = \\frac{r^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + C_2$$\n第二个条件是管道壁面 $r=R$ 处的 Navier 滑移条件：\n$$u|_{r=R} = L_s \\left.\\frac{\\partial u}{\\partial n}\\right|_{r=R}$$\n指向内部的壁面法向对应于 $-r$ 方向，因此 $\\frac{\\partial}{\\partial n} = -\\frac{\\partial}{\\partial r}$。边界条件变为：\n$$u(R) = -L_s \\left.\\frac{\\mathrm{d}u}{\\mathrm{d}r}\\right|_{r=R}$$\n我们计算各项：\n$$u(R) = \\frac{R^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + C_2$$\n$$\\frac{\\mathrm{d}u}{\\mathrm{d}r} = \\frac{r}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} \\implies \\left.\\frac{\\mathrm{d}u}{\\mathrm{d}r}\\right|_{r=R} = \\frac{R}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}$$\n代入边界条件：\n$$\\frac{R^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} + C_2 = -L_s \\left(\\frac{R}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}\\right)$$\n求解 $C_2$：\n$$C_2 = -\\frac{R^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} - \\frac{2L_s R}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 + 2L_s R)$$\n现在我们可以写出速度剖面的完整解。\n\n- **轴向速度剖面 $u(r)$：**\n将 $C_2$ 代回 $u(r)$ 的表达式：\n$$u(r) = \\frac{r^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} - \\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 + 2L_s R) = \\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(r^2 - R^2 - 2L_s R)$$\n由于 $\\frac{\\mathrm{d}p}{\\mathrm{d}z}  0$，方便将其写成：\n$$u(r) = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 - r^2 + 2L_s R)$$\n\n- **壁面剪切应力 $\\tau_w$：**\n剪切应力分量为 $\\tau_{rz} = \\mu \\frac{\\mathrm{d}u}{\\mathrm{d}r}$。壁面剪切应力 $\\tau_w$ 是该分量在壁面 $r=R$ 处的值。\n$$\\tau_w = \\tau_{rz}|_{r=R} = \\mu \\left.\\frac{\\mathrm{d}u}{\\mathrm{d}r}\\right|_{r=R} = \\mu \\left(\\frac{R}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}\\right) = \\frac{R}{2}\\frac{\\mathrm{d}p}{\\mathrm{d}z}$$\n这个结果源于流体柱上的全局动量平衡，并且与粘度或具体的壁面条件（滑移或无滑移）无关，这是充分发展的管流分析中的一个关键特征，常用于计算流体力学（Computational Fluid Dynamics, CFD）等领域。\n\n- **中心线速度变化 $\\Delta u_c$：**\n首先，我们通过计算 $u(r)$ 在 $r=0$ 处的值来求得滑移情况下的中心线速度 $u_c^{\\text{slip}}$：\n$$u_c^{\\text{slip}} = u(0) = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 + 2L_s R)$$\n接下来，我们求标准无滑移情况下的中心线速度 $u_c^{\\text{no-slip}}$。无滑移条件对应于 $L_s=0$。在滑移剖面中令 $L_s=0$，得到经典的 Poiseuille 剖面：\n$$u^{\\text{no-slip}}(r) = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 - r^2)$$\n无滑移情况下的中心线速度为：\n$$u_c^{\\text{no-slip}} = u^{\\text{no-slip}}(0) = -\\frac{R^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}$$\n由滑移引起的中心线速度变化 $\\Delta u_c = u_c^{\\text{slip}} - u_c^{\\text{no-slip}}$ 为：\n$$\\Delta u_c = \\left(-\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}(R^2 + 2L_s R)\\right) - \\left(-\\frac{R^2}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}\\right)$$\n$$\\Delta u_c = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} \\left[ (R^2 + 2L_s R) - R^2 \\right]$$\n$$\\Delta u_c = -\\frac{1}{4\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z} (2L_s R) = -\\frac{L_s R}{2\\mu}\\frac{\\mathrm{d}p}{\\mathrm{d}z}$$\n此表达式给出了因壁面存在滑移而导致的中心线速度的增加量。",
            "answer": "$$\\boxed{-\\frac{L_s R}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}z}}$$"
        },
        {
            "introduction": "掌握了边界条件的解析理论后，我们将注意力转向其在计算流体动力学（CFD）中的实际应用。理论上的边界条件必须被转化为离散的代数约束，才能在数值模拟中实现。本练习将指导您推导在有限体积法中广泛用于施加狄氏（Dirichlet）边界条件（如无滑移）的“虚拟单元”方法，并理解如何通过线性重构来保证其二阶精度。",
            "id": "3994834",
            "problem": "在用于航空航天计算流体动力学 (CFD) 的可压缩纳维-斯托克斯方程的有限体积离散化中，考虑一个具有给定速度矢量无滑移狄利克雷条件的平面固壁。设壁面中心位于位置 $\\boldsymbol{x}_f$，离散的壁面法向坐标为 $n$，在 $\\boldsymbol{x}_f$ 处 $n=0$。与壁面相邻的内部单元中心位于 $n=+d_i$，其速度为 $\\boldsymbol{u}_i$，并在 $n=-d_g$ 处引入一个虚拟单元中心，其未知速度为 $\\boldsymbol{u}_g$。在 $n=0$ 处的壁面给定速度为 $\\boldsymbol{u}_w$。假设速度场的每个分量在壁面附近至少是二阶连续可微的。\n\n您希望通过沿壁面法向线利用两个相邻单元中心的值重构面上的值，从而在壁面中心以二阶精度施加无滑移狄利克雷条件。从 $n=0$ 处的泰勒级数出发，并仅使用 $n=-d_g$ 和 $n=+d_i$ 之间的重构是关于 $n$ 的线性函数的假设（因此重构的面值为通过两个单元中心点的唯一线性函数的值），推导出一个用 $\\boldsymbol{u}_w$、$\\boldsymbol{u}_i$、$d_i$ 和 $d_g$ 表示 $\\boldsymbol{u}_g$ 的表达式，该表达式在 $n=0$ 处施加狄利克雷值，其截断误差是关于距离 $d_i$ 和 $d_g$ 的二阶。\n\n然后，将其特化到关于面中心对称的均匀布置情况，即 $d_i=d_g$，并使用以下数据计算虚拟单元速度：\n- $\\boldsymbol{u}_w = (0.8,\\,-0.3,\\,0.1)$，\n- $\\boldsymbol{u}_i = (1.9,\\,0.5,\\,-0.4)$。\n\n将最终的虚拟单元速度以包含三个分量的单行矢量形式报告，四舍五入到四位有效数字。虚拟单元速度分量以米每秒为单位表示。",
            "solution": "该问题要求推导虚拟单元速度矢量 $\\boldsymbol{u}_g$，该矢量在固壁上以二阶精度施加狄利克雷边界条件 $\\boldsymbol{u}_w$。然后，要求针对一个特定情况计算该虚拟单元速度。\n\n### 步骤 1：问题验证\n\n首先对问题的有效性进行评估。\n\n**提取的已知条件：**\n- 考虑了可压缩纳维-斯托克斯方程的有限体积离散化。\n- 平面固壁在壁面中心 $\\boldsymbol{x}_f$ 处具有给定的速度矢量无滑移狄利克雷条件 $\\boldsymbol{u}_w$。\n- 壁面法向坐标为 $n$，壁面中心处 $n=0$。\n- 内部单元中心位于 $n=+d_i$，速度为 $\\boldsymbol{u}_i$。\n- 虚拟单元中心位于 $n=-d_g$，未知速度为 $\\boldsymbol{u}_g$。\n- 假设速度场分量在壁面附近至少是二阶连续可微的（$C^2$）。\n- 推导的主要约束是，在 $n=-d_g$ 和 $n=+d_i$ 两点之间，速度场的重构是关于坐标 $n$ 的线性函数。\n- 目标是推导用 $\\boldsymbol{u}_w$、$\\boldsymbol{u}_i$、$d_i$ 和 $d_g$ 表示 $\\boldsymbol{u}_g$ 的表达式。该表达式必须在 $n=0$ 处施加狄利克雷条件，且截断误差为二阶。\n- 考虑 $d_i=d_g$ 的特殊情况。\n- 特殊情况的数值数据：$\\boldsymbol{u}_w = (0.8,\\,-0.3,\\,0.1)$ 和 $\\boldsymbol{u}_i = (1.9,\\,0.5,\\,-0.4)$。\n- $\\boldsymbol{u}_g$ 的最终数值答案应为一个行矢量，其分量四舍五入到四位有效数字，单位为米每秒。\n\n**验证分析：**\n在计算流体动力学（CFD）的标准数值方法背景下，该问题定义明确。使用虚拟单元施加边界条件是一项基本技术。该问题指定了一种方法——线性重构，并要求基于此进行推导，同时也将该方法与二阶精度的概念联系起来。\n\n“从泰勒级数出发……并仅使用……重构是线性的假设”这一表述最初可能看似矛盾。然而，通过理解泰勒级数分析是用来确定由线性重构假设产生的格式的精度阶，这两点就得到了统一。对一个 $C^2$ 函数在两点之间进行线性插值，可以为这两点之间的值提供一个二阶精确的近似。因此，该问题在科学上是合理的，并且内部一致。它提供了得出唯一解所需的所有信息和约束。该问题被认为是**有效的**。\n\n### 步骤 2：虚拟单元速度的推导\n\n推导将针对速度的单个标量分量 $u$ 进行。由于运算是线性的，结果可直接应用于矢量 $\\boldsymbol{u}$。\n\n核心指令是使用线性重构来表示在虚拟单元中心 $n=-d_g$ 和内部单元中心 $n=+d_i$ 之间的速度剖面 $u(n)$。一个关于 $n$ 的线性函数可以写成 $u_{rec}(n) = an + b$。系数 $a$ 和 $b$ 通过要求该函数通过模板中的两个已知点来确定：$(n, u) = (-d_g, u_g)$ 和 $(n, u) = (d_i, u_i)$。\n\n我们得到一个关于 $a$ 和 $b$ 的二元线性方程组：\n$$\nu_g = a(-d_g) + b\n$$\n$$\nu_i = a(d_i) + b\n$$\n用第二个方程减去第一个方程，得到：\n$$\nu_i - u_g = a(d_i) - a(-d_g) = a(d_i + d_g)\n$$\n解出斜率 $a$：\n$$\na = \\frac{u_i - u_g}{d_i + d_g}\n$$\n截距 $b$ 是重构剖面在 $n=0$ 处的值，即 $u_{rec}(0) = b$。我们可以用第二个方程解出 $b$：$b = u_i - a d_i$。\n$$\nb = u_i - \\left(\\frac{u_i - u_g}{d_i + d_g}\\right) d_i = \\frac{u_i(d_i + d_g) - (u_i - u_g)d_i}{d_i + d_g} = \\frac{u_i d_i + u_i d_g - u_i d_i + u_g d_i}{d_i + d_g} = \\frac{u_i d_g + u_g d_i}{d_i + d_g}\n$$\n通过将壁面（$n=0$）处的重构值设为给定的壁面速度 $u_w$ 来施加狄利克雷边界条件。\n$$\nu_{rec}(0) = u_w\n$$\n因此，我们必须有：\n$$\nu_w = b = \\frac{u_g d_i + u_i d_g}{d_i + d_g}\n$$\n该方程基于线性重构建立了单元中心值和壁面值之间的关系。问题陈述速度场是 $C^2$ 的。真实场 $u(n)$ 在 $n=0$ 附近的泰勒级数展开表明，此线性插值的误差 $u_{rec}(0) - u(0)$ 是 $O(d_i d_g)$ 阶，这是一个二阶截断误差。这证明了边界条件实现具有“二阶精度”的说法是合理的。\n\n现在，我们求解未知的虚拟单元值 $u_g$：\n$$\nu_w (d_i + d_g) = u_g d_i + u_i d_g\n$$\n$$\nu_g d_i = u_w (d_i + d_g) - u_i d_g\n$$\n$$\nu_g = \\frac{d_i + d_g}{d_i} u_w - \\frac{d_g}{d_i} u_i\n$$\n这个表达式可以写成：\n$$\nu_g = \\left(1 + \\frac{d_g}{d_i}\\right) u_w - \\frac{d_g}{d_i} u_i\n$$\n这个推导对速度矢量的每个分量都成立。因此，矢量表达式为：\n$$\n\\boldsymbol{u}_g = \\frac{d_i + d_g}{d_i} \\boldsymbol{u}_w - \\frac{d_g}{d_i} \\boldsymbol{u}_i\n$$\n\n### 步骤 3：特化与数值计算\n\n问题要求将此结果特化到均匀对称布置的情况，即 $d_i = d_g$。我们设 $d_i = d_g = d$。\n代入推导出的表达式：\n$$\n\\boldsymbol{u}_g = \\frac{d + d}{d} \\boldsymbol{u}_w - \\frac{d}{d} \\boldsymbol{u}_i\n$$\n$$\n\\boldsymbol{u}_g = 2 \\boldsymbol{u}_w - \\boldsymbol{u}_i\n$$\n这就是在对称网格上对具有狄利克雷条件的虚拟单元使用的众所周知的“镜像”公式。\n\n现在，我们将提供的数值数据代入这个简化公式。问题陈述意味着这些数值代表以米每秒为单位的速度。\n- 给定壁面速度： $\\boldsymbol{u}_w = (0.8,\\,-0.3,\\,0.1)$\n- 内部单元速度： $\\boldsymbol{u}_i = (1.9,\\,0.5,\\,-0.4)$\n\n首先，计算 $2\\boldsymbol{u}_w$：\n$$\n2\\boldsymbol{u}_w = 2 \\times (0.8,\\,-0.3,\\,0.1) = (1.6,\\,-0.6,\\,0.2)\n$$\n接下来，从 $2\\boldsymbol{u}_w$ 中减去 $\\boldsymbol{u}_i$ 来求得 $\\boldsymbol{u}_g$：\n$$\n\\boldsymbol{u}_g = (1.6,\\,-0.6,\\,0.2) - (1.9,\\,0.5,\\,-0.4)\n$$\n各分量计算如下：\n$$\nu_{g,x} = 1.6 - 1.9 = -0.3\n$$\n$$\nu_{g,y} = -0.6 - 0.5 = -1.1\n$$\n$$\nu_{g,z} = 0.2 - (-0.4) = 0.2 + 0.4 = 0.6\n$$\n所以，虚拟单元速度矢量为 $\\boldsymbol{u}_g = (-0.3,\\,-1.1,\\,0.6)$。\n\n问题要求将每个分量四舍五入到四位有效数字。\n- 第一个分量 $-0.3$ 变为 $-0.3000$。\n- 第二个分量 $-1.1$ 变为 $-1.100$。\n- 第三个分量 $0.6$ 变为 $0.6000$。\n\n最终的虚拟单元速度矢量是 $\\boldsymbol{u}_g = (-0.3000,\\,-1.100,\\,0.6000)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.3000  -1.100  0.6000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后，我们处理在航空航天应用中常见的更复杂情况：非结构化网格和曲面边界。当几何形状复杂时，精确计算壁面附近的物理量（如壁面剪切应力）变得至关重要。此高级练习要求您使用最小二乘法，从一组非结构化的采样点数据中重构速度梯度张量，并讨论网格质量（如偏斜度）和几何近似对计算精度的影响。",
            "id": "3994862",
            "problem": "考虑一个光滑弯曲航空航天壁面附近的三维粘性流。设壁面上的一个特定点位于 $\\boldsymbol{x}_0 = (0,0,0)$，其局部单位法向量为 $\\boldsymbol{n} = (0,0,1)$。假设在壁面上满足无滑移边界条件，因此 $\\boldsymbol{u}(\\boldsymbol{x}_0) = \\boldsymbol{0}$。在壁面周围一个足够小的管状邻域内，将 $\\boldsymbol{n}$ 视为沿壁面法向坐标是恒定的。壁面上的切向速度矢量由正交投影定义为 $\\boldsymbol{u}_t = (\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top})\\,\\boldsymbol{u}$，任何足够光滑的标量 $\\phi$ 的壁面法向方向导数为 $\\partial \\phi/\\partial n = \\boldsymbol{n}\\cdot\\nabla \\phi$。\n\n给定一个非结构化网格，其中有五个内部采样点，位置分别为\n$\\boldsymbol{x}_1 = (0.4,\\,0,\\,0.2)$、$\\boldsymbol{x}_2 = (-0.4,\\,0,\\,0.2)$、$\\boldsymbol{x}_3 = (0,\\,0.4,\\,0.2)$、$\\boldsymbol{x}_4 = (0,\\,-0.4,\\,0.2)$ 和 $\\boldsymbol{x}_5 = (0,\\,0,\\,0.3)$，单位为 $\\mathrm{m}$。相应的测量速度矢量，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，分别为\n$\\boldsymbol{u}(\\boldsymbol{x}_1) = (0.8,\\,-0.4,\\,0)$、$\\boldsymbol{u}(\\boldsymbol{x}_2) = (0.8,\\,-0.4,\\,0)$、$\\boldsymbol{u}(\\boldsymbol{x}_3) = (0.8,\\,-0.4,\\,0)$、$\\boldsymbol{u}(\\boldsymbol{x}_4) = (0.8,\\,-0.4,\\,0)$ 和 $\\boldsymbol{u}(\\boldsymbol{x}_5) = (1.2,\\,-0.6,\\,0)$。\n\n从定义出发，并利用最小二乘法构建拟合一个恒定雅可比矩阵 $\\boldsymbol{J}$，使得 $\\boldsymbol{u}(\\boldsymbol{x}_i) \\approx \\boldsymbol{u}(\\boldsymbol{x}_0) + \\boldsymbol{J}(\\boldsymbol{x}_i - \\boldsymbol{x}_0)$，推导出正规方程并使用等权重计算最佳拟合的 $\\boldsymbol{J}$。然后，仅使用这些基本原理，推导并计算在 $\\boldsymbol{x}_0$ 处切向速度矢量的壁面法向导数，即在壁面处求值的 $\\partial \\boldsymbol{u}_t/\\partial n$，并表示为一个三分量矢量。\n\n根据您的推导，简要讨论网格偏斜度（采样点位移相对于 $\\boldsymbol{n}$ 的非正交性）如何影响在线性和弱非线性场中计算出的 $\\partial \\boldsymbol{u}_t/\\partial n$ 的精度，以及 $\\boldsymbol{n}$ 的几何一致性扮演什么角色。\n\n将最终导数矢量分量以 $\\mathrm{s}^{-1}$ 为单位表示，并将您的数值答案四舍五入到四位有效数字。",
            "solution": "用户想要找到一个关于固壁边界条件问题的解。\n\n### **问题验证**\n\n**步骤1：提取已知条件**\n- 光滑弯曲航空航天壁面附近的三维粘性流。\n- 壁面点位于 $\\boldsymbol{x}_0 = (0,0,0)$。\n- $\\boldsymbol{x}_0$ 处的局部单位法向量为 $\\boldsymbol{n} = (0,0,1)$。\n- 无滑移边界条件成立：$\\boldsymbol{u}(\\boldsymbol{x}_0) = \\boldsymbol{0}$。\n- 在小邻域内，$\\boldsymbol{n}$ 被视为常数。\n- 切向速度矢量定义：$\\boldsymbol{u}_t = (\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top})\\,\\boldsymbol{u}$。\n- 标量 $\\phi$ 的壁面法向方向导数定义：$\\partial \\phi/\\partial n = \\boldsymbol{n}\\cdot\\nabla \\phi$。\n- 五个内部采样点 $\\boldsymbol{x}_i$（单位为 $\\mathrm{m}$）：\n  $\\boldsymbol{x}_1 = (0.4,\\,0,\\,0.2)$、$\\boldsymbol{x}_2 = (-0.4,\\,0,\\,0.2)$、$\\boldsymbol{x}_3 = (0,\\,0.4,\\,0.2)$、$\\boldsymbol{x}_4 = (0,\\,-0.4,\\,0.2)$ 和 $\\boldsymbol{x}_5 = (0,\\,0,\\,0.3)$。\n- 相应的速度矢量 $\\boldsymbol{u}(\\boldsymbol{x}_i)$（单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$）：\n  $\\boldsymbol{u}(\\boldsymbol{x}_1) = (0.8,\\,-0.4,\\,0)$、$\\boldsymbol{u}(\\boldsymbol{x}_2) = (0.8,\\,-0.4,\\,0)$、$\\boldsymbol{u}(\\boldsymbol{x}_3) = (0.8,\\,-0.4,\\,0)$、$\\boldsymbol{u}(\\boldsymbol{x}_4) = (0.8,\\,-0.4,\\,0)$ 和 $\\boldsymbol{u}(\\boldsymbol{x}_5) = (1.2,\\,-0.6,\\,0)$。\n- 任务是使用最小二乘法从线性近似 $\\boldsymbol{u}(\\boldsymbol{x}_i) \\approx \\boldsymbol{u}(\\boldsymbol{x}_0) + \\boldsymbol{J}(\\boldsymbol{x}_i - \\boldsymbol{x}_0)$ 中找到雅可比矩阵 $\\boldsymbol{J}$。\n- 随后，推导并计算在 $\\boldsymbol{x}_0$ 处的切向速度矢量的壁面法向导数 $\\partial \\boldsymbol{u}_t/\\partial n$。\n- 最后，讨论网格偏斜度和 $\\boldsymbol{n}$ 的几何一致性的影响。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于流体动力学和数值方法（特别是CFD中的梯度重构）的原理。使用泰勒级数展开和最小二乘拟合来确定局部速度梯度张量（雅可比矩阵）是一种标准技术。所有必要的数据都已提供，并且没有内部矛盾。数据点的数量（$5$个）提供了足够的信息，可以在超定最小二乘的意义上求解雅可比矩阵的 $9$ 个分量（$5 \\times 3 = 15$ 个标量方程求解 $9$ 个未知数）。该问题是适定的、客观的。所有验证标准都已满足。\n\n**步骤3：结论与行动**\n问题有效。将提供完整的解答。\n\n### **解答推导**\n\n问题要求计算壁面点 $\\boldsymbol{x}_0 = \\boldsymbol{0}$ 处的速度雅可比矩阵 $\\boldsymbol{J}$，并随后计算切向速度的壁面法向导数 $\\partial \\boldsymbol{u}_t/\\partial n$。\n\n**第一部分：雅可比矩阵 $\\boldsymbol{J}$ 的最小二乘计算**\n\n在 $\\boldsymbol{x}_0$ 附近的速度场 $\\boldsymbol{u}(\\boldsymbol{x})$ 可通过一阶泰勒展开近似：\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) \\approx \\boldsymbol{u}(\\boldsymbol{x}_0) + (\\nabla \\boldsymbol{u})_{\\boldsymbol{x}_0} (\\boldsymbol{x} - \\boldsymbol{x}_0)\n$$\n这里，$\\nabla \\boldsymbol{u}$ 是速度梯度张量，我们用雅可比矩阵 $\\boldsymbol{J}$ 表示。其分量为 $J_{ij} = \\partial u_i / \\partial x_j$。给定无滑移条件 $\\boldsymbol{u}(\\boldsymbol{x}_0) = \\boldsymbol{0}$ 和 $\\boldsymbol{x}_0=\\boldsymbol{0}$，模型简化为：\n$$\n\\boldsymbol{u}(\\boldsymbol{x}_i) \\approx \\boldsymbol{J} \\boldsymbol{x}_i\n$$\n对于五个采样点 $i = 1, \\dots, 5$。我们寻求最小化残差平方和 $S$ 的矩阵 $\\boldsymbol{J}$：\n$$\nS = \\sum_{i=1}^{5} ||\\boldsymbol{u}_i - \\boldsymbol{J} \\boldsymbol{x}_i||^2\n$$\n其中 $\\boldsymbol{u}_i = \\boldsymbol{u}(\\boldsymbol{x}_i)$。这个问题可以对雅可比矩阵 $\\boldsymbol{J}$ 的每一行进行解耦。设 $\\boldsymbol{j}_k^{\\top}$ 是 $\\boldsymbol{J}$ 的第 $k$ 行（因此 $\\boldsymbol{j}_k$ 是一个列向量）。点 $i$ 处速度的第 $k$ 个分量，记为 $u_{ik}$，由 $u_{ik} = \\boldsymbol{j}_k^{\\top} \\boldsymbol{x}_i$ 给出。我们可以将所有 5 个点的关系写成矩阵形式。设 $\\boldsymbol{u}^{(k)}$ 是所有点第 $k$ 个速度分量的列向量，设 $\\boldsymbol{X}$ 是行向量为位置矢量 $\\boldsymbol{x}_i^{\\top}$ 的矩阵：\n$$\n\\boldsymbol{X} \\boldsymbol{j}_k = \\boldsymbol{u}^{(k)}\n$$\n对于每个 $\\boldsymbol{j}_k$ ($k=1,2,3$)，这是一个超定系统。最小二乘问题的正规方程是通过左乘 $\\boldsymbol{X}^{\\top}$ 推导出来的：\n$$\n(\\boldsymbol{X}^{\\top}\\boldsymbol{X}) \\boldsymbol{j}_k = \\boldsymbol{X}^{\\top} \\boldsymbol{u}^{(k)}\n$$\n雅可比矩阵的每个行向量的解则为：\n$$\n\\boldsymbol{j}_k = (\\boldsymbol{X}^{\\top}\\boldsymbol{X})^{-1} \\boldsymbol{X}^{\\top} \\boldsymbol{u}^{(k)}\n$$\n首先，我们根据给定的采样点坐标构造矩阵 $\\boldsymbol{X}$：\n$$\n\\boldsymbol{X} = \\begin{pmatrix} \\boldsymbol{x}_1^{\\top} \\\\ \\boldsymbol{x}_2^{\\top} \\\\ \\boldsymbol{x}_3^{\\top} \\\\ \\boldsymbol{x}_4^{\\top} \\\\ \\boldsymbol{x}_5^{\\top} \\end{pmatrix} = \\begin{pmatrix} 0.4  0  0.2 \\\\ -0.4  0  0.2 \\\\ 0  0.4  0.2 \\\\ 0  -0.4  0.2 \\\\ 0  0  0.3 \\end{pmatrix}\n$$\n接下来，我们计算 $\\boldsymbol{X}^{\\top}\\boldsymbol{X}$：\n$$\n\\boldsymbol{X}^{\\top}\\boldsymbol{X} = \\begin{pmatrix} 0.4  -0.4  0  0  0 \\\\ 0  0  0.4  -0.4  0 \\\\ 0.2  0.2  0.2  0.2  0.3 \\end{pmatrix} \\begin{pmatrix} 0.4  0  0.2 \\\\ -0.4  0  0.2 \\\\ 0  0.4  0.2 \\\\ 0  -0.4  0.2 \\\\ 0  0  0.3 \\end{pmatrix} = \\begin{pmatrix} 0.32  0  0 \\\\ 0  0.32  0 \\\\ 0  0  0.25 \\end{pmatrix}\n$$\n由于采样点的对称布置，该矩阵是对角矩阵。其逆矩阵很容易计算：\n$$\n(\\boldsymbol{X}^{\\top}\\boldsymbol{X})^{-1} = \\begin{pmatrix} \\frac{1}{0.32}  0  0 \\\\ 0  \\frac{1}{0.32}  0 \\\\ 0  0  \\frac{1}{0.25} \\end{pmatrix} = \\begin{pmatrix} 3.125  0  0 \\\\ 0  3.125  0 \\\\ 0  0  4 \\end{pmatrix}\n$$\n现在我们组合速度分量向量 $\\boldsymbol{u}^{(1)}$、$\\boldsymbol{u}^{(2)}$ 和 $\\boldsymbol{u}^{(3)}$：\n$$\n\\boldsymbol{u}^{(1)} = \\begin{pmatrix} 0.8 \\\\ 0.8 \\\\ 0.8 \\\\ 0.8 \\\\ 1.2 \\end{pmatrix}, \\quad \\boldsymbol{u}^{(2)} = \\begin{pmatrix} -0.4 \\\\ -0.4 \\\\ -0.4 \\\\ -0.4 \\\\ -0.6 \\end{pmatrix}, \\quad \\boldsymbol{u}^{(3)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n我们为每个分量计算正规方程的右侧，即 $\\boldsymbol{X}^{\\top}\\boldsymbol{u}^{(k)}$。\n对于 $\\boldsymbol{j}_1$（$\\boldsymbol{J}$ 的第一行）：\n$$\n\\boldsymbol{X}^{\\top}\\boldsymbol{u}^{(1)} = \\begin{pmatrix} 0.4  -0.4  0  0  0 \\\\ 0  0  0.4  -0.4  0 \\\\ 0.2  0.2  0.2  0.2  0.3 \\end{pmatrix} \\begin{pmatrix} 0.8 \\\\ 0.8 \\\\ 0.8 \\\\ 0.8 \\\\ 1.2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1.0 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{j}_1 = (\\boldsymbol{X}^{\\top}\\boldsymbol{X})^{-1} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1.0 \\end{pmatrix} = \\begin{pmatrix} 3.125  0  0 \\\\ 0  3.125  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1.0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 4 \\end{pmatrix}\n$$\n对于 $\\boldsymbol{j}_2$（$\\boldsymbol{J}$ 的第二行）：\n$$\n\\boldsymbol{X}^{\\top}\\boldsymbol{u}^{(2)} = \\begin{pmatrix} 0.4  -0.4  0  0  0 \\\\ 0  0  0.4  -0.4  0 \\\\ 0.2  0.2  0.2  0.2  0.3 \\end{pmatrix} \\begin{pmatrix} -0.4 \\\\ -0.4 \\\\ -0.4 \\\\ -0.4 \\\\ -0.6 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -0.5 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{j}_2 = (\\boldsymbol{X}^{\\top}\\boldsymbol{X})^{-1} \\begin{pmatrix} 0 \\\\ 0 \\\\ -0.5 \\end{pmatrix} = \\begin{pmatrix} 3.125  0  0 \\\\ 0  3.125  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ -0.5 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -2 \\end{pmatrix}\n$$\n对于 $\\boldsymbol{j}_3$（$\\boldsymbol{J}$ 的第三行），由于 $\\boldsymbol{u}^{(3)} = \\boldsymbol{0}$，我们立即得到 $\\boldsymbol{X}^{\\top}\\boldsymbol{u}^{(3)} = \\boldsymbol{0}$，因此 $\\boldsymbol{j}_3 = \\boldsymbol{0}$。\n\n组合各行，雅可比矩阵为：\n$$\n\\boldsymbol{J} = \\begin{pmatrix} \\boldsymbol{j}_1^{\\top} \\\\ \\boldsymbol{j}_2^{\\top} \\\\ \\boldsymbol{j}_3^{\\top} \\end{pmatrix} = \\begin{pmatrix} 0  0  4 \\\\ 0  0  -2 \\\\ 0  0  0 \\end{pmatrix}\n$$\n\n**第二部分：$\\partial \\boldsymbol{u}_t/\\partial n$ 的推导和计算**\n\n我们需要计算在 $\\boldsymbol{x}_0$ 处求值的切向速度矢量的壁面法向导数 $\\partial \\boldsymbol{u}_t/\\partial n$。切向速度定义为 $\\boldsymbol{u}_t = (\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top})\\,\\boldsymbol{u}$。壁面法向导数算子为 $\\partial/\\partial n \\equiv \\boldsymbol{n}\\cdot\\nabla$。\n将此算子应用于 $\\boldsymbol{u}_t$：\n$$\n\\frac{\\partial \\boldsymbol{u}_t}{\\partial n} = \\frac{\\partial}{\\partial n} \\left[ (\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top}) \\boldsymbol{u} \\right]\n$$\n问题陈述在壁面的管状邻域内，$\\boldsymbol{n}$ 可被视为常数。这个假设至关重要，因为它允许将投影算子 $(\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top})$ 视为一个常数矩阵，可以从微分中提出来：\n$$\n\\frac{\\partial \\boldsymbol{u}_t}{\\partial n} = (\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top}) \\frac{\\partial \\boldsymbol{u}}{\\partial n}\n$$\n项 $\\partial \\boldsymbol{u}/\\partial n$ 是矢量场 $\\boldsymbol{u}$ 在 $\\boldsymbol{n}$ 方向上的方向导数。这通过将雅可比矩阵应用于方向矢量来计算：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial n} = \\boldsymbol{J}\\boldsymbol{n}\n$$\n我们从第一部分得到了 $\\boldsymbol{J}$，并且已知 $\\boldsymbol{n} = (0, 0, 1)^{\\top}$。\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial n} = \\begin{pmatrix} 0  0  4 \\\\ 0  0  -2 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ -2 \\\\ 0 \\end{pmatrix}\n$$\n这个矢量表示当沿法向离开壁面时速度矢量的变化率。现在我们应用切向投影。投影矩阵是：\n$$\n\\boldsymbol{n}\\boldsymbol{n}^{\\top} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{I} - \\boldsymbol{n}\\boldsymbol{n}^{\\top} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n将此投影算子应用于 $\\partial \\boldsymbol{u}/\\partial n$：\n$$\n\\frac{\\partial \\boldsymbol{u}_t}{\\partial n} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ -2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ -2 \\\\ 0 \\end{pmatrix}\n$$\n所得矢量的单位是速度除以长度，即 $\\mathrm{s}^{-1}$。分量为 $(4, -2, 0)$。四舍五入到四位有效数字得到 $(4.000, -2.000, 0.000)$。\n\n**第三部分：关于网格偏斜度和几何一致性的讨论**\n\n该推导过程揭示了网格质量和几何假设如何影响计算出的导数的精度。\n\n*   **网格偏斜度**：网格偏斜度指的是单元面法线的不正交性，或者在此背景下，采样点分布的不正交性。给定的采样点形成一个正交模板，因为矩阵 $\\boldsymbol{X}^{\\top}\\boldsymbol{X}$ 是对角矩阵。这导致空间导数 $\\partial/\\partial x$、$\\partial/\\partial y$ 和 $\\partial/\\partial z$ 的计算解耦。例如，$\\boldsymbol{j}_1 = (\\partial u_1/\\partial x, \\partial u_1/\\partial y, \\partial u_1/\\partial z)^{\\top}$ 的计算被分成了三个独立的估计。\n    *   对于**线性速度场**，如此处数据完美拟合线性模型的情况，最小二乘法提供了精确的雅可比矩阵，而与网格偏斜度无关（只要 $\\boldsymbol{X}^{\\top}\\boldsymbol{X}$ 可逆）。在这种理想情况下，偏斜度不会降低精度。\n    *   对于**弱非线性场**，其中 $\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{J}\\boldsymbol{x} + \\mathcal{O}(||\\boldsymbol{x}||^2)$，线性模型是一个近似。偏斜的网格以不平衡的方式对场进行采样。由此产生的 $\\boldsymbol{X}^{\\top}\\boldsymbol{X}$ 矩阵将是非对角的，从而耦合了所有梯度分量的估计。来自高阶项的截断误差将不会对称地抵消，并且会污染 $\\boldsymbol{J}$ 的所有计算分量，包括构成 $\\boldsymbol{J}\\boldsymbol{n}$ 的法向导数项。像本题所提供的正交网格则更具鲁棒性，因为它隔离了沿不同坐标轴的导数估计，从而最大限度地减少了这种误差交叉污染。\n\n*   **$\\boldsymbol{n}$ 的几何一致性**：假设法向量 $\\boldsymbol{n}$ 是恒定的，这只是一个近似，仅对完全平坦的壁面或弯曲壁面的无穷小邻域有效。对于真正的弯曲壁面，$\\boldsymbol{n}$ 是壁面上位置的函数，即 $\\boldsymbol{n}(\\boldsymbol{x})$。导数公式将变得更加复杂，涉及到 $\\boldsymbol{n}$ 本身的导数（即壁面曲率）：$\\frac{\\partial \\boldsymbol{u}_t}{\\partial n} = \\frac{\\partial}{\\partial n}[(\\boldsymbol{I} - \\boldsymbol{n}(\\boldsymbol{x})\\boldsymbol{n}(\\boldsymbol{x})^{\\top})\\boldsymbol{u}(\\boldsymbol{x})]$。同时使用一个恒定的 $\\boldsymbol{n}$ 来定义切向投影和微分方向，会引入几何一致性误差，该误差与壁面曲率和邻域大小成比例。这种简化是一个忽略了壁面曲率对局部流动运动学影响的一阶近似。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 4.000  -2.000  0.000 \\end{pmatrix}\n}\n$$"
        }
    ]
}