{
    "hands_on_practices": [
        {
            "introduction": "Exploiting symmetry is a cornerstone of efficient computational modeling, allowing us to simulate a fraction of a domain while retaining the full physical picture. However, this requires specifying mathematically precise boundary conditions at the symmetry plane. This practice  will guide you through deriving the appropriate symmetry conditions for mean flow and turbulence model variables, starting from fundamental parity arguments, to ensure your simulation remains physically accurate and avoids spurious turbulence generation.",
            "id": "4000247",
            "problem": "Consider an incompressible, statistically steady flow governed by the Reynolds-Averaged Navier–Stokes (RANS) equations within a three-dimensional domain that is mirror-symmetric with respect to the plane $y=0$. Let $\\mathbf{x} = (x,y,z)$ and define the reflection map $\\mathcal{R}:(x,y,z)\\mapsto(x,-y,z)$. The mean velocity field is $\\mathbf{U}(\\mathbf{x}) = (u(\\mathbf{x}), v(\\mathbf{x}), w(\\mathbf{x}))$, the mean pressure is $p(\\mathbf{x})$, and the turbulent kinetic energy and dissipation rate in the standard $k$–$\\epsilon$ model are $k(\\mathbf{x})$ and $\\epsilon(\\mathbf{x})$, respectively. The turbulent kinetic energy and dissipation rate are defined as $k = \\tfrac{1}{2}\\,\\overline{u_{i}'u_{i}'}$ and $\\epsilon = \\nu\\,\\overline{\\partial u_{i}'/\\partial x_{j}\\,\\partial u_{i}'/\\partial x_{j}}$, where $\\nu$ is the kinematic viscosity, an overbar denotes Reynolds averaging, primes denote fluctuations, and indices follow the Einstein summation convention. The eddy viscosity closure takes the widely used form $\\nu_{t} = C_{\\mu}\\,k^{2}/\\epsilon$ with constant $C_{\\mu} > 0$. Let the mean strain-rate tensor be $S_{ij} = \\tfrac{1}{2}\\left(\\partial U_{i}/\\partial x_{j} + \\partial U_{j}/\\partial x_{i}\\right)$, and consider the turbulence production term $P_{k}$ entering the $k$ transport equation via the contraction of the turbulent stresses with mean gradients, which in eddy-viscosity closures is proportional to $S_{ij}S_{ij}$, namely $P_{k} = 2\\,\\nu_{t}\\,S_{ij}S_{ij}$.\n\nAssume the flow, the geometry, and the boundary and forcing configurations are such that the full RANS-$k$–$\\epsilon$ system is invariant under the reflection $\\mathcal{R}$, and that the mean fields satisfy reflection symmetry at $y=0$ in the sense that scalars are even and the vector components transform according to their geometric parity under $\\mathcal{R}$. Using only the fundamental laws and core definitions stated above, and enforcing the invariance of the governing equations under $\\mathcal{R}$, derive the minimal set of symmetry-consistent boundary conditions at the plane $y=0$ for the variables $\\mathbf{U}$, $p$, $k$, and $\\epsilon$ that maintain reflection symmetry and eliminate artificial turbulence production associated with normal-tangential coupling at the symmetry plane.\n\nYour derivation must:\n- Identify the parity (even/odd under $y\\mapsto -y$) of each field component required by reflection invariance.\n- Use these parities to deduce the corresponding boundary conditions at $y=0$ in terms of the values or normal derivatives of the fields.\n- Demonstrate that, with these boundary conditions, all mixed normal–tangential mean strain components at $y=0$ vanish, so that the local symmetry does not spuriously contribute to $P_{k}$ through normal–tangential coupling.\n\nExpress your final answer as the ordered vector\n$$\\left[v|_{y=0}\\,,\\,\\frac{\\partial u}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial w}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial p}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial k}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial \\epsilon}{\\partial y}\\bigg|_{y=0}\\right],$$\nwith the normal derivative understood as $\\partial/\\partial y$ at the plane $y=0$. There is no rounding requirement. No physical units should be included in the final answer.",
            "solution": "The problem is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Domain:** A three-dimensional domain, mirror-symmetric with respect to the plane $y=0$.\n- **Reflection Map:** $\\mathcal{R}:(x,y,z)\\mapsto(x,-y,z)$.\n- **Governing Equations:** Incompressible, statistically steady Reynolds-Averaged Navier–Stokes (RANS) equations.\n- **Variables:** Mean velocity $\\mathbf{U}(\\mathbf{x}) = (u(\\mathbf{x}), v(\\mathbf{x}), w(\\mathbf{x}))$, mean pressure $p(\\mathbf{x})$, turbulent kinetic energy $k(\\mathbf{x})$, and dissipation rate $\\epsilon(\\mathbf{x})$.\n- **Definitions:**\n    - Turbulent kinetic energy: $k = \\tfrac{1}{2}\\,\\overline{u_{i}'u_{i}'}$.\n    - Turbulent dissipation rate: $\\epsilon = \\nu\\,\\overline{\\partial u_{i}'/\\partial x_{j}\\,\\partial u_{i}'/\\partial x_{j}}$.\n    - Eddy viscosity: $\\nu_{t} = C_{\\mu}\\,k^{2}/\\epsilon$ with constant $C_{\\mu} > 0$.\n    - Mean strain-rate tensor: $S_{ij} = \\tfrac{1}{2}\\left(\\partial U_{i}/\\partial x_{j} + \\partial U_{j}/\\partial x_{i}\\right)$.\n    - Turbulence production: $P_{k} = 2\\,\\nu_{t}\\,S_{ij}S_{ij}$.\n- **Assumptions:**\n    - The RANS-$k$–$\\epsilon$ system is invariant under the reflection $\\mathcal{R}$.\n    - The mean fields satisfy reflection symmetry at $y=0$: scalars are even, and vector components transform according to their geometric parity under $\\mathcal{R}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly rooted in the standard theory of turbulence modeling (RANS, $k$–$\\epsilon$ model) and the application of symmetry principles in fluid dynamics, a core topic in computational fluid dynamics (CFD). The definitions and concepts are standard and factually correct.\n- **Well-Posed:** The problem is well-posed. It asks for the derivation of a specific set of boundary conditions based on clearly stated symmetry assumptions. The existence of a unique, meaningful solution is expected.\n- **Objective:** The problem is stated in precise, objective, and technical language, free from ambiguity or subjective claims.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist (e.g., scientific unsoundness, incompleteness, contradiction, etc.). It is a valid, formalizable problem in the specified field.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\n### Solution Derivation\n\nThe derivation proceeds by first establishing the parity of each field variable based on the specified reflection symmetry, and then deducing the corresponding boundary conditions at the symmetry plane $y=0$. Finally, it is demonstrated that these conditions eliminate spurious turbulence production from normal-tangential strain coupling.\n\n**1. Parity of Field Variables**\n\nThe problem states that the flow is mirror-symmetric with respect to the plane $y=0$, with the reflection map $\\mathcal{R}:(x,y,z)\\mapsto(x,-y,z)$. It is assumed that scalars are even under this reflection, and vector components transform according to their geometric parity.\n\nLet $\\phi(\\mathbf{x})=\\phi(x,y,z)$ be a generic field.\n- A scalar field $\\phi_{scalar}$ is **even** if it is invariant under reflection: $\\phi_{scalar}(x,-y,z) = \\phi_{scalar}(x,y,z)$.\n- A vector field $\\mathbf{U}=(u,v,w)$ transforms with geometric parity. The reflection $\\mathcal{R}$ negates the $y$ coordinate while leaving $x$ and $z$ unchanged. Thus, the vector component normal to the plane of symmetry ($v$) must be odd, while the tangential components ($u, w$) must be even.\n\nApplying these rules to the variables of interest:\n- The mean pressure $p(\\mathbf{x})$, turbulent kinetic energy $k(\\mathbf{x})$, and dissipation rate $\\epsilon(\\mathbf{x})$ are scalar quantities. Therefore, they are even functions with respect to $y$:\n  $$p(x,-y,z) = p(x,y,z)$$\n  $$k(x,-y,z) = k(x,y,z)$$\n  $$\\epsilon(x,-y,z) = \\epsilon(x,y,z)$$\n- The mean velocity components have the following parities:\n  - $u(x,y,z)$ (tangential) is **even**: $u(x,-y,z) = u(x,y,z)$.\n  - $v(x,y,z)$ (normal) is **odd**: $v(x,-y,z) = -v(x,y,z)$.\n  - $w(x,y,z)$ (tangential) is **even**: $w(x,-y,z) = w(x,y,z)$.\n\n**2. Derivation of Boundary Conditions at $y=0$**\n\nBoundary conditions at the plane $y=0$ are derived from the parity properties.\n\n- For any function $\\phi_{odd}(y)$ that is odd in $y$, we have $\\phi_{odd}(-y) = -\\phi_{odd}(y)$. Evaluating at $y=0$ gives $\\phi_{odd}(0) = -\\phi_{odd}(0)$, which implies $2\\phi_{odd}(0)=0$, so $\\phi_{odd}(0)=0$.\n- For any continuously differentiable function $\\phi_{even}(y)$ that is even in $y$, we have $\\phi_{even}(-y) = \\phi_{even}(y)$. Differentiating with respect to $y$ using the chain rule gives $-\\phi_{even}'(-y) = \\phi_{even}'(y)$. This shows that the derivative $\\phi_{even}'(y)$ is an odd function. Evaluating at $y=0$ yields $-\\phi_{even}'(0) = \\phi_{even}'(0)$, which implies $2\\phi_{even}'(0)=0$, so $\\phi_{even}'(0)=0$.\n\nApplying these mathematical facts to our fields at the symmetry plane $y=0$:\n\n- **$v$ component:** $v$ is an odd function of $y$. Therefore, its value at $y=0$ must be zero.\n  $$v|_{y=0} = 0$$\n- **$u$ component:** $u$ is an even function of $y$. Therefore, its partial derivative with respect to $y$ (the normal derivative) must be an odd function of $y$, and thus zero at $y=0$.\n  $$\\frac{\\partial u}{\\partial y}\\bigg|_{y=0} = 0$$\n- **$w$ component:** $w$ is an even function of $y$. Similar to $u$, its normal derivative must be zero at $y=0$.\n  $$\\frac{\\partial w}{\\partial y}\\bigg|_{y=0} = 0$$\n- **Pressure $p$:** $p$ is a scalar and an even function of $y$. Therefore, its normal derivative must be zero at $y=0$.\n  $$\\frac{\\partial p}{\\partial y}\\bigg|_{y=0} = 0$$\n- **Turbulent kinetic energy $k$:** $k$ is a scalar and an even function of $y$. Its normal derivative must be zero at $y=0$.\n  $$\\frac{\\partial k}{\\partial y}\\bigg|_{y=0} = 0$$\n- **Dissipation rate $\\epsilon$:** $\\epsilon$ is a scalar and an even function of $y$. Its normal derivative must be zero at $y=0$.\n  $$\\frac{\\partial \\epsilon}{\\partial y}\\bigg|_{y=0} = 0$$\n\n**3. Elimination of Artificial Turbulence Production**\n\nThe production of turbulent kinetic energy, $P_k$, is given by $P_k = 2\\,\\nu_{t}\\,S_{ij}S_{ij}$, where $S_{ij}$ is the mean strain-rate tensor. We must show that the boundary conditions derived above eliminate spurious production arising from the coupling of normal ($y$-direction, index $2$) and tangential ($x,z$-directions, indices $1,3$) velocity gradients. The relevant components of the strain-rate tensor are the mixed normal-tangential terms $S_{12}$ (also $S_{xy}$) and $S_{23}$ (also $S_{yz}$).\n\nThe components are defined as:\n$$S_{12} = \\frac{1}{2}\\left(\\frac{\\partial U_1}{\\partial x_2} + \\frac{\\partial U_2}{\\partial x_1}\\right) = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right)$$\n$$S_{23} = \\frac{1}{2}\\left(\\frac{\\partial U_2}{\\partial x_3} + \\frac{\\partial U_3}{\\partial x_2}\\right) = \\frac{1}{2}\\left(\\frac{\\partial v}{\\partial z} + \\frac{\\partial w}{\\partial y}\\right)$$\n\nWe evaluate these components at the symmetry plane $y=0$:\nFrom the boundary conditions derived in the previous section, we have:\n$$\\frac{\\partial u}{\\partial y}\\bigg|_{y=0} = 0 \\quad \\text{and} \\quad \\frac{\\partial w}{\\partial y}\\bigg|_{y=0} = 0$$\n\nNow we must evaluate the tangential derivatives of $v$ at $y=0$. Since $v(x,y,z)$ is an odd function of $y$, we have $v(x,y,z) = -v(x,-y,z)$. Taking the partial derivative with respect to a tangential coordinate, such as $x$, yields:\n$$\\frac{\\partial v}{\\partial x}(x,y,z) = \\frac{\\partial}{\\partial x}[-v(x,-y,z)] = -\\frac{\\partial v}{\\partial x}(x,-y,z)$$\nThis shows that $\\frac{\\partial v}{\\partial x}$ is also an odd function of $y$. As established, any odd function of $y$ must be zero at $y=0$. Therefore:\n$$\\frac{\\partial v}{\\partial x}\\bigg|_{y=0} = 0$$\nBy identical reasoning for the $z$-derivative:\n$$\\frac{\\partial v}{\\partial z}\\bigg|_{y=0} = 0$$\n\nSubstituting these results into the expressions for $S_{12}$ and $S_{23}$ at $y=0$:\n$$S_{12}\\bigg|_{y=0} = \\frac{1}{2}\\left(0 + 0\\right) = 0$$\n$$S_{23}\\bigg|_{y=0} = \\frac{1}{2}\\left(0 + 0\\right) = 0$$\n\nSince the mixed normal-tangential components of the mean strain-rate tensor are identically zero at the symmetry plane, their contribution to the production term $P_k$ (which is proportional to $S_{12}^2$ and $S_{23}^2$) is also zero. This confirms that the derived symmetry boundary conditions correctly prevent the generation of artificial turbulence at the symmetry plane due to normal-tangential strain coupling.\n\nThe minimal set of symmetry-consistent boundary conditions is thus given by the values derived above. The final answer is the ordered vector of these values.\n- $v|_{y=0} = 0$\n- $\\frac{\\partial u}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial w}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial p}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial k}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial \\epsilon}{\\partial y}\\big|_{y=0} = 0$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Many CFD solvers for incompressible flow rely on solving a pressure Poisson equation to enforce a divergence-free velocity field. When periodic boundary conditions are applied, this elliptic equation is only solvable if the source term satisfies a specific constraint. This exercise  delves into this fundamental mathematical requirement, guiding you to derive the compatibility condition from first principles and apply it to a concrete example, a critical skill for anyone developing or analyzing numerical methods for fluid dynamics.",
            "id": "4000231",
            "problem": "In Computational Fluid Dynamics (CFD), consider the incompressible Navier–Stokes equations for a fluid of constant density on a triply periodic domain $\\Omega \\subset \\mathbb{R}^{3}$ with period lengths $L_{x}$, $L_{y}$, and $L_{z}$ in the $x$, $y$, and $z$ directions, respectively. Let the velocity field be $\\boldsymbol{u}(\\boldsymbol{x},t)$ and the pressure be $p(\\boldsymbol{x},t)$, and suppose all fields are spatially periodic with the same periods as the domain. In a projection or fractional-step method, a pressure Poisson equation of the form\n$$\n\\nabla^{2} p(\\boldsymbol{x},t) \\;=\\; f(\\boldsymbol{x},t)\n$$\nis obtained from the momentum and continuity equations to enforce incompressibility. The unknown $p$ is defined modulo an additive constant under periodic boundary conditions.\n\nUsing only the incompressibility constraint, the momentum equation, and the periodicity of the fields, derive the necessary and sufficient compatibility condition on the source term $f$ for this Poisson equation to be solvable under periodic boundary conditions.\n\nThen, to quantify the impact of a nonzero-mean source, consider the one-dimensional version on $\\Omega = [0,2\\pi]$ with periodic boundary conditions, and let the source be\n$$\nf(x) \\;=\\; a \\;+\\; b \\cos(x) \\;+\\; c \\cos^{2}(x),\n$$\nwhere $a$, $b$, and $c$ are constants. Determine the unique value of $a$ (expressed in closed form in terms of $b$ and $c$) that must be chosen to satisfy the compatibility condition you derived so that the periodic Poisson problem is solvable. Express your final answer as a single closed-form analytic expression with no units.",
            "solution": "The problem is presented in two parts. The first part requires the derivation of the compatibility condition for a Poisson equation on a triply periodic domain. The second part requires applying this condition to a specific one-dimensional case to find a parameter value.\n\nPart 1: Derivation of the Compatibility Condition\n\nWe are given the pressure Poisson equation on a triply periodic domain $\\Omega \\subset \\mathbb{R}^{3}$:\n$$\n\\nabla^{2} p(\\boldsymbol{x},t) = f(\\boldsymbol{x},t)\n$$\nThe domain has periods $L_{x}$, $L_{y}$, and $L_{z}$ in the $x$, $y$, and $z$ directions, respectively. The fields $p$ and $f$ are periodic with these same periods.\n\nTo derive the compatibility condition for the existence of a solution $p$, we integrate both sides of the equation over the entire domain $\\Omega$:\n$$\n\\int_{\\Omega} \\nabla^{2} p \\,dV = \\int_{\\Omega} f \\,dV\n$$\nHere, $dV$ is the infinitesimal volume element.\n\nThe left-hand side of this equation can be transformed using the divergence theorem, which states that for a vector field $\\boldsymbol{F}$, $\\int_{V} (\\boldsymbol{\\nabla} \\cdot \\boldsymbol{F}) \\,dV = \\oint_{\\partial V} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\,dS$, where $\\partial V$ is the boundary of the volume $V$ and $\\boldsymbol{n}$ is the outward unit normal. We identify the Laplacian operator as the divergence of the gradient, $\\nabla^{2} p = \\boldsymbol{\\nabla} \\cdot (\\boldsymbol{\\nabla} p)$. Applying the divergence theorem with $\\boldsymbol{F} = \\boldsymbol{\\nabla} p$, we have:\n$$\n\\int_{\\Omega} \\nabla^{2} p \\,dV = \\int_{\\Omega} \\boldsymbol{\\nabla} \\cdot (\\boldsymbol{\\nabla} p) \\,dV = \\oint_{\\partial \\Omega} (\\boldsymbol{\\nabla} p) \\cdot \\boldsymbol{n} \\,dS\n$$\nThe boundary $\\partial \\Omega$ of the periodic box $\\Omega = [0, L_x] \\times [0, L_y] \\times [0, L_z]$ consists of three pairs of opposing faces (e.g., the face at $x=0$ and the face at $x=L_x$). Let's evaluate the surface integral over one such pair of faces, for instance, those perpendicular to the $x$-axis. The outward normal is $\\boldsymbol{n} = -\\boldsymbol{e}_x$ at $x=0$ and $\\boldsymbol{n} = \\boldsymbol{e}_x$ at $x=L_x$. The contribution from this pair of faces to the integral is:\n$$\n\\int_{0}^{L_z} \\int_{0}^{L_y} \\left[ (\\boldsymbol{\\nabla} p)|_{x=L_x} \\cdot \\boldsymbol{e}_x + (\\boldsymbol{\\nabla} p)|_{x=0} \\cdot (-\\boldsymbol{e}_x) \\right] dy \\,dz = \\int_{0}^{L_z} \\int_{0}^{L_y} \\left[ \\frac{\\partial p}{\\partial x}\\bigg|_{x=L_x, y, z} - \\frac{\\partial p}{\\partial x}\\bigg|_{x=0, y, z} \\right] dy \\,dz\n$$\nDue to the specified periodic boundary conditions, the pressure field $p$ and its derivatives must have the same value on opposing boundaries. Thus, for any $(y,z)$:\n$$\n\\frac{\\partial p}{\\partial x}(L_x, y, z) = \\frac{\\partial p}{\\partial x}(0, y, z)\n$$\nThis causes the integrand above to be zero everywhere, and consequently, the integral over this pair of faces is zero. The same reasoning applies to the pairs of faces in the $y$ and $z$ directions. Therefore, the entire surface integral vanishes:\n$$\n\\oint_{\\partial \\Omega} (\\boldsymbol{\\nabla} p) \\cdot \\boldsymbol{n} \\,dS = 0\n$$\nCombining our results, we have $\\int_{\\Omega} \\nabla^{2} p \\,dV = 0$. This leads directly to the compatibility condition on the source term $f$:\n$$\n\\int_{\\Omega} f(\\boldsymbol{x},t) \\,dV = 0\n$$\nThis is a necessary condition for a solution to exist. It is also a sufficient condition, a result from the Fredholm alternative. The operator $\\nabla^{2}$ with periodic boundary conditions is self-adjoint. Its null space is the set of constant functions. A solution to $\\nabla^{2}p = f$ exists if and only if $f$ is orthogonal to the null space of the adjoint operator. For the self-adjoint Laplacian, this means $f$ must be orthogonal to the constant functions, which is precisely the condition $\\int_{\\Omega} f \\cdot 1 \\,dV = 0$. This condition means that the spatial average of the source term over the domain must be zero.\n\nPart 2: Application to the One-Dimensional Case\n\nWe now consider the one-dimensional ($1$D) version of the problem on the domain $\\Omega = [0, 2\\pi]$ with periodic boundary conditions. The Poisson equation becomes:\n$$\n\\frac{d^{2}p}{dx^{2}} = f(x)\n$$\nThe source term is given as:\n$$\nf(x) = a + b \\cos(x) + c \\cos^{2}(x)\n$$\nwhere $a$, $b$, and $c$ are constants. The compatibility condition derived in Part $1$ reduces to:\n$$\n\\int_{0}^{2\\pi} f(x) \\,dx = 0\n$$\nWe substitute the expression for $f(x)$ and evaluate the integral:\n$$\n\\int_{0}^{2\\pi} \\left( a + b \\cos(x) + c \\cos^{2}(x) \\right) dx = 0\n$$\nWe can integrate term by term:\n$$\n\\int_{0}^{2\\pi} a \\,dx + \\int_{0}^{2\\pi} b \\cos(x) \\,dx + \\int_{0}^{2\\pi} c \\cos^{2}(x) \\,dx = 0\n$$\nThe first integral is:\n$$\n\\int_{0}^{2\\pi} a \\,dx = a[x]_{0}^{2\\pi} = 2\\pi a\n$$\nThe second integral is:\n$$\n\\int_{0}^{2\\pi} b \\cos(x) \\,dx = b[\\sin(x)]_{0}^{2\\pi} = b(\\sin(2\\pi) - \\sin(0)) = b(0-0) = 0\n$$\nFor the third integral, we use the trigonometric identity $\\cos^{2}(x) = \\frac{1}{2}(1 + \\cos(2x))$:\n$$\n\\int_{0}^{2\\pi} c \\cos^{2}(x) \\,dx = c \\int_{0}^{2\\pi} \\frac{1 + \\cos(2x)}{2} \\,dx = \\frac{c}{2} \\left[ x + \\frac{1}{2}\\sin(2x) \\right]_{0}^{2\\pi}\n$$\n$$\n= \\frac{c}{2} \\left[ \\left(2\\pi + \\frac{1}{2}\\sin(4\\pi)\\right) - \\left(0 + \\frac{1}{2}\\sin(0)\\right) \\right] = \\frac{c}{2} [ (2\\pi + 0) - (0 + 0) ] = c\\pi\n$$\nSubstituting these results back into the compatibility condition equation:\n$$\n2\\pi a + 0 + c\\pi = 0\n$$\nNow, we solve for $a$:\n$$\n2\\pi a = -c\\pi\n$$\n$$\na = -\\frac{c\\pi}{2\\pi} = -\\frac{c}{2}\n$$\nThus, for the periodic Poisson problem to be solvable, the constant $a$ must be equal to $-\\frac{c}{2}$. This choice ensures that the average value of the source term $f(x)$ over the period $[0, 2\\pi]$ is zero. The value of $b$ does not affect the compatibility condition because the average value of $\\cos(x)$ over a full period is zero.",
            "answer": "$$\\boxed{-\\frac{c}{2}}$$"
        },
        {
            "introduction": "In many advanced aerospace applications, such as turbomachinery simulations, periodic boundaries connect components with non-conforming, or mismatched, computational grids. Transferring data across these interfaces requires an algorithm that is both geometrically accurate and physically conservative. This practical exercise  simulates this real-world challenge, tasking you with designing and evaluating a nearest-neighbor search algorithm to couple mismatched periodic interfaces, and implementing a global scaling method to enforce conservation—a key technique in robust CFD software.",
            "id": "4000218",
            "problem": "Consider two discretized periodic interfaces used for coupling in Computational Fluid Dynamics (CFD), representing donor and receiver surfaces on a circular cylinder of constant radius. Let the donor interface be defined by the set of points $\\{(\\theta_i^d, z_i^d)\\}_{i=1}^{N_d}$ with radius $R$, and a scalar field $\\{q_i^d\\}_{i=1}^{N_d}$ representing a dimensionless face-integrated quantity (for instance, a mass flux per unit span, nondimensionalized). Let the receiver interface be defined by $\\{(\\theta_j^r, z_j^r)\\}_{j=1}^{N_r}$ with the same $R$. Angles are to be expressed in radians, and all distances are dimensionless because the radius $R$ is treated as a unit length. A periodic transformation between donor and receiver is specified by $(\\Delta\\theta, \\Delta z)$, which defines a helical periodicity: a receiver point at $(\\theta_j^r, z_j^r)$ should align with a donor point near $(\\theta_j^r - \\Delta\\theta, z_j^r - \\Delta z)$ modulo $2\\pi$ in the angular coordinate.\n\nYour task is to implement a robust nearest-neighbor search that, for each receiver point, selects the donor point that minimizes the Euclidean distance after compensating for the periodic shift. The search must be performed in three-dimensional space using the coordinates\n$$\nx = R\\cos\\theta, \\quad y = R\\sin\\theta, \\quad z = z,\n$$\nwith the receiver coordinates first shifted to\n$$\n\\theta_j^{r*} = \\operatorname{wrap}_{[0,2\\pi)}(\\theta_j^r - \\Delta\\theta), \\quad z_j^{r*} = z_j^r - \\Delta z,\n$$\nwhere $\\operatorname{wrap}_{[0,2\\pi)}(\\cdot)$ denotes wrapping an angle into the interval $[0,2\\pi)$.\n\nDefine the nearest-neighbor mapping $i(j)$ for each receiver index $j$ by minimizing the Euclidean distance\n$$\nd_{ij} = \\sqrt{(x_i^d - x_j^{r*})^2 + (y_i^d - y_j^{r*})^2 + (z_i^d - z_j^{r*})^2},\n$$\nwith a deterministic tie-breaking rule: if multiple donors achieve the same minimal distance for a given receiver, select the donor with the smallest index $i$. Using this mapping, compute the following metrics:\n\n1. The root-mean-square (RMS) geometric mismatch\n$$\n\\varepsilon_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N_r}\\sum_{j=1}^{N_r} d_{i(j),j}^2}.\n$$\n\n2. The maximum geometric mismatch\n$$\n\\varepsilon_{\\infty} = \\max_{j=1,\\dots,N_r} d_{i(j),j}.\n$$\n\n3. The maximum angular mismatch\n$$\n\\delta_{\\theta,\\infty} = \\max_{j=1,\\dots,N_r} \\min\\left(|\\theta_{i(j)}^d - \\theta_j^{r*}|,\\, 2\\pi - |\\theta_{i(j)}^d - \\theta_j^{r*}|\\right).\n$$\n\n4. A globally conservative coupling based on the nearest-neighbor map. First, assign the receiver field by nearest-neighbor transfer:\n$$\n\\widetilde{q}_j^r = q_{i(j)}^d.\n$$\nThen compute a global scaling factor\n$$\ns = \\frac{\\sum_{i=1}^{N_d} q_i^d}{\\sum_{j=1}^{N_r} \\widetilde{q}_j^r},\n$$\nand set the conservative receiver field\n$$\nq_j^{r,\\mathrm{cons}} = s\\,\\widetilde{q}_j^r.\n$$\nFinally, report the absolute conservation error\n$$\n\\Delta_{\\mathrm{cons}} = \\left|\\sum_{j=1}^{N_r} q_j^{r,\\mathrm{cons}} - \\sum_{i=1}^{N_d} q_i^d\\right|.\n$$\n\nAll outputs are dimensionless floats; angles must be in radians. Implement all computations with deterministic, reproducible formulas only; do not use any random numbers.\n\nTest Suite. Your program must compute the metrics $(\\varepsilon_{\\mathrm{RMS}}, \\varepsilon_{\\infty}, \\Delta_{\\mathrm{cons}}, \\delta_{\\theta,\\infty})$ for each of the following parameter sets. For each case, define donor and receiver points and fields as described.\n\nCase A (general helical periodicity, mismatched cardinalities):\n- $R = 1$.\n- $N_d = 64$, donor angles: $\\theta_i^d = \\frac{2\\pi i}{N_d}$ for $i=0,\\dots,N_d-1$; donor axial positions: $z_i^d = A_d\\sin(k_d \\theta_i^d)$ with $A_d = 0.05$, $k_d = 5$.\n- $N_r = 70$, receiver angles: $\\theta_j^r = \\frac{2\\pi j}{N_r} + \\gamma\\sin(\\lambda j)$ for $j=0,\\dots,N_r-1$, with $\\gamma = \\frac{2\\pi}{2N_r^2}$ and $\\lambda = 3$; receiver axial positions: $z_j^r = A_r\\sin(k_r \\theta_j^r)$ with $A_r = 0.05$, $k_r = 6$.\n- Periodic shift: $\\Delta\\theta = \\frac{\\pi}{7}$, $\\Delta z = 0.02$.\n- Donor scalar field: $q_i^d = 1 + \\alpha\\sin(m\\,\\theta_i^d) + \\beta\\cos(p\\,z_i^d)$ with $\\alpha = 0.1$, $m = 3$, $\\beta = 0.05$, $p = 10$.\n\nCase B (large wrap-around rotation, matched cardinalities, zero axial variation):\n- $R = 1$.\n- $N_d = 8$, donor angles: $\\theta_i^d = \\frac{2\\pi i}{N_d}$; donor axial positions: $z_i^d = 0$.\n- $N_r = 8$, receiver angles: $\\theta_j^r = \\frac{2\\pi j}{N_r}$; receiver axial positions: $z_j^r = 0$.\n- Periodic shift: $\\Delta\\theta = \\frac{15\\pi}{8}$, $\\Delta z = 0$.\n- Donor scalar field: $q_i^d = 1 + \\alpha\\sin(m\\,\\theta_i^d)$ with $\\alpha = 0.3$, $m = 4$.\n\nCase C (tie-breaking edge case, multiple receivers equidistant to two donors):\n- $R = 1$.\n- $N_d = 4$, donor angles: $\\theta_i^d \\in \\{0, \\frac{\\pi}{2}, \\pi, \\frac{3\\pi}{2}\\}$; donor axial positions: $z_i^d = 0$.\n- $N_r = 8$, receiver angles: $\\theta_j^r \\in \\left\\{\\frac{\\pi}{4}, \\frac{3\\pi}{4}, \\frac{5\\pi}{4}, \\frac{7\\pi}{4}, \\frac{\\pi}{4}, \\frac{3\\pi}{4}, \\frac{5\\pi}{4}, \\frac{7\\pi}{4}\\right\\}$; receiver axial positions: $z_j^r = 0$.\n- Periodic shift: $\\Delta\\theta = 0$, $\\Delta z = 0$.\n- Donor scalar field: $q_i^d = 1 + \\alpha\\cos(m\\,\\theta_i^d)$ with $\\alpha = 0.2$, $m = 2$.\n\nRequired Final Output Format. Your program should produce a single line of output containing the results for all cases as a comma-separated list of lists of floats, in the order Case A, Case B, Case C. Each inner list must be $[\\varepsilon_{\\mathrm{RMS}}, \\varepsilon_{\\infty}, \\Delta_{\\mathrm{cons}}, \\delta_{\\theta,\\infty}]$. The single output line must be of the form:\n$$\n[\\,[\\varepsilon_{\\mathrm{RMS}}^{(A)}, \\varepsilon_{\\infty}^{(A)}, \\Delta_{\\mathrm{cons}}^{(A)}, \\delta_{\\theta,\\infty}^{(A)}], [\\varepsilon_{\\mathrm{RMS}}^{(B)}, \\varepsilon_{\\infty}^{(B)}, \\Delta_{\\mathrm{cons}}^{(B)}, \\delta_{\\theta,\\infty}^{(B)}], [\\varepsilon_{\\mathrm{RMS}}^{(C)}, \\varepsilon_{\\infty}^{(C)}, \\Delta_{\\mathrm{cons}}^{(C)}, \\delta_{\\theta,\\infty}^{(C)}]\\,].\n$$\nAngles must be in radians. Distances are dimensionless. The conservation error must be reported as a float (dimensionless) and will be expected to be numerically close to $0$ due to the global scaling.",
            "solution": "We begin from the periodic boundary condition concept in Computational Fluid Dynamics (CFD), constrained by conservation laws. The fundamental principle is conservation of mass for steady flow across periodic interfaces. If two surfaces are periodic equivalents under a symmetry transformation, the net integral of a conserved flux must be invariant under that transformation. In the discrete setting, this motivates a coupling that preserves the sum of the discretized scalar field.\n\nFoundational basis: consider the integral conservation of a scalar flux $q$ across two surfaces $S_d$ and $S_r$ related by a symmetry transformation $T_{\\Delta\\theta,\\Delta z}$ defined by a rotation by $\\Delta\\theta$ and an axial translation by $\\Delta z$. For a conserved quantity under symmetry, we have\n$$\n\\int_{S_d} q\\,\\mathrm{d}A = \\int_{S_r} q\\circ T_{\\Delta\\theta,\\Delta z}^{-1}\\,\\mathrm{d}A.\n$$\nIn discrete form with control surfaces represented by points or faces, a conservative coupling seeks\n$$\n\\sum_{i=1}^{N_d} q_i^d \\approx \\sum_{j=1}^{N_r} q_j^r,\n$$\nwhere the mapping from donor data $q_i^d$ to receiver data $q_j^r$ respects the periodic symmetry. The challenge arises when the donor and receiver discretizations are mismatched ($N_d \\neq N_r$), necessitating an algorithm that both geometrically aligns points and constructs a conservative transfer.\n\nPeriodic geometry and nearest-neighbor principle: the donor and receiver sets are positioned on a circle of radius $R$, with angular coordinates and axial coordinates giving $(x,y,z)$ via\n$$\nx = R\\cos\\theta,\\quad y = R\\sin\\theta,\\quad z = z.\n$$\nTo enforce periodicity, receiver points are shifted by the inverse transformation to align in donor coordinates:\n$$\n\\theta_j^{r*} = \\operatorname{wrap}_{[0,2\\pi)}(\\theta_j^r - \\Delta\\theta), \\quad z_j^{r*} = z_j^r - \\Delta z.\n$$\nThe Euclidean distance in three-dimensional space between donor point $i$ and shifted receiver point $j$ is\n$$\nd_{ij} = \\sqrt{(x_i^d - x_j^{r*})^2 + (y_i^d - y_j^{r*})^2 + (z_i^d - z_j^{r*})^2}.\n$$\nThe nearest-neighbor mapping $i(j)$ is selected to minimize $d_{ij}$ for each $j$, with deterministic tie-breaking by smallest index. This approach is robust because it operates on the physical space metric and appropriately handles angular periodicity through $\\operatorname{wrap}_{[0,2\\pi)}(\\cdot)$.\n\nGeometric mismatch metrics: the mismatch distances $d_{i(j),j}$ quantify geometric misalignment. Two norms are relevant:\n\n- The root-mean-square (RMS) mismatch:\n$$\n\\varepsilon_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{N_r}\\sum_{j=1}^{N_r} d_{i(j),j}^2},\n$$\nwhich averages squared distances and is sensitive to distributed error.\n\n- The maximum mismatch:\n$$\n\\varepsilon_{\\infty} = \\max_{j=1,\\dots,N_r} d_{i(j),j},\n$$\nwhich identifies the worst-case misalignment.\n\nAdditionally, an angular mismatch measures the minimal periodic angular difference between a matched donor angle and the shifted receiver angle:\n$$\n\\delta_{\\theta,\\infty} = \\max_{j=1,\\dots,N_r} \\min\\left(|\\theta_{i(j)}^d - \\theta_j^{r*}|,\\, 2\\pi - |\\theta_{i(j)}^d - \\theta_j^{r*}|\\right).\n$$\nThis captures the angular component of the mismatch independent of axial offsets.\n\nConservative coupling via global scaling: nearest-neighbor assignment alone does not guarantee conservation when $N_d \\neq N_r$, because multiple receivers may map to the same donor, or some donors may be unmapped. A straightforward conservative correction is a global scaling factor $s$ that enforces equality of sums:\n$$\n\\widetilde{q}_j^r = q_{i(j)}^d,\\qquad s = \\frac{\\sum_{i=1}^{N_d} q_i^d}{\\sum_{j=1}^{N_r} \\widetilde{q}_j^r},\\qquad q_j^{r,\\mathrm{cons}} = s\\,\\widetilde{q}_j^r.\n$$\nBy construction,\n$$\n\\sum_{j=1}^{N_r} q_j^{r,\\mathrm{cons}} = s\\sum_{j=1}^{N_r} \\widetilde{q}_j^r = \\sum_{i=1}^{N_d} q_i^d,\n$$\nand thus the absolute conservation error\n$$\n\\Delta_{\\mathrm{cons}} = \\left|\\sum_{j=1}^{N_r} q_j^{r,\\mathrm{cons}} - \\sum_{i=1}^{N_d} q_i^d\\right|\n$$\nis theoretically zero (up to numerical roundoff in floating-point arithmetic). This global rescaling is a minimal adjustment that preserves nearest-neighbor locality while ensuring discrete conservation.\n\nAlgorithmic steps for each test case:\n\n1. Construct donor angles $\\theta_i^d$ and axial positions $z_i^d$ as specified, compute donor Cartesian coordinates $(x_i^d,y_i^d,z_i^d)$, and donor field $q_i^d$ using the provided deterministic formulas.\n\n2. Construct receiver angles $\\theta_j^r$ and axial positions $z_j^r$ as specified. Apply the periodic inverse transformation to obtain $(\\theta_j^{r*}, z_j^{r*})$ and compute $(x_j^{r*}, y_j^{r*}, z_j^{r*})$.\n\n3. For each receiver index $j$, compute all distances $\\{d_{ij}\\}_{i=1}^{N_d}$ and select $i(j) = \\arg\\min_i d_{ij}$ with tie-breaking by smallest $i$.\n\n4. Compute the geometric mismatch metrics: $\\varepsilon_{\\mathrm{RMS}}$ and $\\varepsilon_{\\infty}$ from the list $\\{d_{i(j),j}\\}_{j=1}^{N_r}$.\n\n5. Compute the angular mismatch $\\delta_{\\theta,\\infty}$ using the minimal periodic difference formula for each pair $(\\theta_{i(j)}^d, \\theta_j^{r*})$.\n\n6. Construct the nearest-neighbor receiver field $\\widetilde{q}_j^r = q_{i(j)}^d$ and the conservative field $q_j^{r,\\mathrm{cons}} = s\\,\\widetilde{q}_j^r$ with\n$$\ns = \\frac{\\sum_{i=1}^{N_d} q_i^d}{\\sum_{j=1}^{N_r} \\widetilde{q}_j^r}.\n$$\nCompute the absolute conservation error $\\Delta_{\\mathrm{cons}}$.\n\n7. Report the list $[\\varepsilon_{\\mathrm{RMS}}, \\varepsilon_{\\infty}, \\Delta_{\\mathrm{cons}}, \\delta_{\\theta,\\infty}]$ for the case.\n\nTest suite coverage rationale:\n\n- Case A exercises general helical periodicity with mismatched cardinalities and nontrivial axial and angular variations, testing robustness and typical CFD coupling conditions.\n\n- Case B tests a large rotation near wrap-around ($\\Delta\\theta = \\frac{15\\pi}{8}$), zero axial variation, and matched cardinalities, probing handling of angular periodicity and boundary angular cases.\n\n- Case C constructs exact ties in angular distance between receiver midpoints and adjacent donors, guaranteeing equal Euclidean distances (since $z=0$ and $R$ constant). The deterministic tie-breaking rule ensures reproducibility and tests the algorithm’s stability under symmetry-induced degeneracy.\n\nAll angles are in radians and all distances are dimensionless. The program must output a single line with the results for all three cases in the specified nested list format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef wrap_to_2pi(theta):\n    \"\"\"Wrap angle to [0, 2*pi).\"\"\"\n    twopi = 2.0 * np.pi\n    return theta % twopi\n\ndef minimal_angular_diff(a, b):\n    \"\"\"\n    Minimal periodic angular difference between angles a and b in radians.\n    Returns a value in [0, pi].\n    \"\"\"\n    twopi = 2.0 * np.pi\n    diff = np.abs(a - b) % twopi\n    return np.minimum(diff, twopi - diff)\n\ndef build_donor_case_A(Nd, R, Ad, kd, alpha, m, beta, p):\n    i = np.arange(Nd)\n    theta_d = (2.0 * np.pi * i) / Nd\n    z_d = Ad * np.sin(kd * theta_d)\n    x_d = R * np.cos(theta_d)\n    y_d = R * np.sin(theta_d)\n    q_d = 1.0 + alpha * np.sin(m * theta_d) + beta * np.cos(p * z_d)\n    return theta_d, z_d, x_d, y_d, q_d\n\ndef build_receiver_case_A(Nr, R, Ar, kr, gamma, lam):\n    j = np.arange(Nr)\n    theta_r = (2.0 * np.pi * j) / Nr + gamma * np.sin(lam * j)\n    z_r = Ar * np.sin(kr * theta_r)\n    x_r = R * np.cos(theta_r)\n    y_r = R * np.sin(theta_r)\n    return theta_r, z_r, x_r, y_r\n\ndef build_donor_case_B(Nd, R, alpha, m):\n    i = np.arange(Nd)\n    theta_d = (2.0 * np.pi * i) / Nd\n    z_d = np.zeros_like(theta_d)\n    x_d = R * np.cos(theta_d)\n    y_d = R * np.sin(theta_d)\n    q_d = 1.0 + alpha * np.sin(m * theta_d)\n    return theta_d, z_d, x_d, y_d, q_d\n\ndef build_receiver_case_B(Nr, R):\n    j = np.arange(Nr)\n    theta_r = (2.0 * np.pi * j) / Nr\n    z_r = np.zeros_like(theta_r)\n    x_r = R * np.cos(theta_r)\n    y_r = R * np.sin(theta_r)\n    return theta_r, z_r, x_r, y_r\n\ndef build_donor_case_C(R, alpha, m):\n    theta_d = np.array([0.0, 0.5 * np.pi, np.pi, 1.5 * np.pi])\n    z_d = np.zeros_like(theta_d)\n    x_d = R * np.cos(theta_d)\n    y_d = R * np.sin(theta_d)\n    q_d = 1.0 + alpha * np.cos(m * theta_d)\n    return theta_d, z_d, x_d, y_d, q_d\n\ndef build_receiver_case_C(R):\n    base = np.array([0.25 * np.pi, 0.75 * np.pi, 1.25 * np.pi, 1.75 * np.pi])\n    theta_r = np.concatenate([base, base])  # duplicates to enforce tie stress\n    z_r = np.zeros_like(theta_r)\n    x_r = R * np.cos(theta_r)\n    y_r = R * np.sin(theta_r)\n    return theta_r, z_r, x_r, y_r\n\ndef apply_periodic_shift(theta_r, z_r, dtheta, dz):\n    theta_rs = wrap_to_2pi(theta_r - dtheta)\n    z_rs = z_r - dz\n    return theta_rs, z_rs\n\ndef nearest_neighbor_metrics(theta_d, z_d, x_d, y_d, q_d,\n                             theta_r, z_r, x_r, y_r,\n                             dtheta, dz, R):\n    # Shift receiver to donor frame\n    theta_rs, z_rs = apply_periodic_shift(theta_r, z_r, dtheta, dz)\n    x_rs = R * np.cos(theta_rs)\n    y_rs = R * np.sin(theta_rs)\n\n    Nd = theta_d.size\n    Nr = theta_rs.size\n\n    # Compute distances: for each receiver j, compute distances to all donors i.\n    # Use broadcasting: donors (Nd,1), receivers (1,Nr)\n    dx = x_d[:, None] - x_rs[None, :]\n    dy = y_d[:, None] - y_rs[None, :]\n    dz_ = z_d[:, None] - z_rs[None, :]\n    dists = np.sqrt(dx * dx + dy * dy + dz_ * dz_)\n\n    # Argmin along donors for each receiver; numpy.argmin is deterministic and picks smallest index on ties.\n    idx = np.argmin(dists, axis=0)\n    min_dists = dists[idx, np.arange(Nr)]\n\n    # Geometric mismatch metrics\n    eps_rms = float(np.sqrt(np.mean(min_dists**2)))\n    eps_inf = float(np.max(min_dists))\n\n    # Angular mismatch (minimal periodic difference)\n    ang_diff = minimal_angular_diff(theta_d[idx], theta_rs)\n    delta_theta_inf = float(np.max(ang_diff))\n\n    # Nearest-neighbor transfer and global conservative scaling\n    q_tilde = q_d[idx]\n    sum_q_d = float(np.sum(q_d))\n    sum_q_tilde = float(np.sum(q_tilde))\n    # To avoid division by zero in pathological cases, handle sum_q_tilde == 0\n    if sum_q_tilde == 0.0:\n        s = 0.0\n    else:\n        s = sum_q_d / sum_q_tilde\n    q_cons = s * q_tilde\n    delta_cons = float(abs(np.sum(q_cons) - sum_q_d))\n\n    return [eps_rms, eps_inf, delta_cons, delta_theta_inf]\n\ndef solve():\n    results = []\n\n    # Case A parameters\n    R_A = 1.0\n    Nd_A = 64\n    Nr_A = 70\n    Ad_A = 0.05\n    kd_A = 5\n    Ar_A = 0.05\n    kr_A = 6\n    gamma_A = (2.0 * np.pi) / (2.0 * (Nr_A ** 2))\n    lam_A = 3\n    dtheta_A = np.pi / 7.0\n    dz_A = 0.02\n    alpha_A = 0.1\n    m_A = 3\n    beta_A = 0.05\n    p_A = 10\n\n    theta_d_A, z_d_A, x_d_A, y_d_A, q_d_A = build_donor_case_A(\n        Nd_A, R_A, Ad_A, kd_A, alpha_A, m_A, beta_A, p_A\n    )\n    theta_r_A, z_r_A, x_r_A, y_r_A = build_receiver_case_A(\n        Nr_A, R_A, Ar_A, kr_A, gamma_A, lam_A\n    )\n    res_A = nearest_neighbor_metrics(\n        theta_d_A, z_d_A, x_d_A, y_d_A, q_d_A,\n        theta_r_A, z_r_A, x_r_A, y_r_A,\n        dtheta_A, dz_A, R_A\n    )\n    results.append(res_A)\n\n    # Case B parameters\n    R_B = 1.0\n    Nd_B = 8\n    Nr_B = 8\n    dtheta_B = 15.0 * np.pi / 8.0\n    dz_B = 0.0\n    alpha_B = 0.3\n    m_B = 4\n\n    theta_d_B, z_d_B, x_d_B, y_d_B, q_d_B = build_donor_case_B(\n        Nd_B, R_B, alpha_B, m_B\n    )\n    theta_r_B, z_r_B, x_r_B, y_r_B = build_receiver_case_B(\n        Nr_B, R_B\n    )\n    res_B = nearest_neighbor_metrics(\n        theta_d_B, z_d_B, x_d_B, y_d_B, q_d_B,\n        theta_r_B, z_r_B, x_r_B, y_r_B,\n        dtheta_B, dz_B, R_B\n    )\n    results.append(res_B)\n\n    # Case C parameters\n    R_C = 1.0\n    dtheta_C = 0.0\n    dz_C = 0.0\n    alpha_C = 0.2\n    m_C = 2\n\n    theta_d_C, z_d_C, x_d_C, y_d_C, q_d_C = build_donor_case_C(\n        R_C, alpha_C, m_C\n    )\n    theta_r_C, z_r_C, x_r_C, y_r_C = build_receiver_case_C(R_C)\n    res_C = nearest_neighbor_metrics(\n        theta_d_C, z_d_C, x_d_C, y_d_C, q_d_C,\n        theta_r_C, z_r_C, x_r_C, y_r_C,\n        dtheta_C, dz_C, R_C\n    )\n    results.append(res_C)\n\n    # Final print statement in the exact required format.\n    # Ensure floats are printed with full precision as default str for clarity.\n    print(f\"[{','.join(str(list(map(float, r))) for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}