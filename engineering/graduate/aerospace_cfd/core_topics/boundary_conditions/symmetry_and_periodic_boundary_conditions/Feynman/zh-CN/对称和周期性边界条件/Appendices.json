{
    "hands_on_practices": [
        {
            "introduction": "在计算流体力学中，利用对称性来减小计算域和成本是一种常见且强大的技术，但这要求在对称面上施加正确的边界条件。本练习将指导您从基本物理原理出发，推导雷诺平均Navier-Stokes (RANS) 方程中各项（包括速度、压力以及$k$-$\\epsilon$ 湍流模型中的湍动能 $k$ 和耗散率 $\\epsilon$）在对称面上的边界条件。通过分析各物理量在反射变换下的奇偶性，您将学会如何系统地确定这些条件，并验证它们能够避免在对称面上产生非物理的湍流，从而确保模拟的准确性。",
            "id": "4000247",
            "problem": "考虑一个三维域内的不可压缩统计定常流，该流体由雷诺平均纳维-斯托克斯 (RANS) 方程控制，且该域关于平面 $y=0$ 镜像对称。令 $\\mathbf{x} = (x,y,z)$，并定义反射映射 $\\mathcal{R}:(x,y,z)\\mapsto(x,-y,z)$。平均速度场为 $\\mathbf{U}(\\mathbf{x}) = (u(\\mathbf{x}), v(\\mathbf{x}), w(\\mathbf{x}))$，平均压力为 $p(\\mathbf{x})$，标准 `$k$-$\\epsilon$` 模型中的湍动能和耗散率分别为 $k(\\mathbf{x})$ 和 $\\epsilon(\\mathbf{x})$。湍动能和耗散率定义为 $k = \\tfrac{1}{2}\\,\\overline{u_{i}'u_{i}'}$ 和 $\\epsilon = \\nu\\,\\overline{\\partial u_{i}'/\\partial x_{j}\\,\\partial u_{i}'/\\partial x_{j}}$，其中 $\\nu$ 是运动粘度，上划线表示雷诺平均，撇号表示脉动量，指标遵循爱因斯坦求和约定。涡粘性封闭采用广泛使用的形式 $\\nu_{t} = C_{\\mu}\\,k^{2}/\\epsilon$，其中 $C_{\\mu} > 0$ 为常数。令平均应变率张量为 $S_{ij} = \\tfrac{1}{2}\\left(\\partial U_{i}/\\partial x_{j} + \\partial U_{j}/\\partial x_{i}\\right)$，并考虑湍流生成项 $P_{k}$，该项通过湍流应力与平均梯度的缩并进入 $k$ 输运方程，在涡粘性封闭中，它与 $S_{ij}S_{ij}$ 成正比，即 $P_{k} = 2\\,\\nu_{t}\\,S_{ij}S_{ij}$。\n\n假设流动、几何形状以及边界和强迫配置使得完整的 RANS `$k$-$\\epsilon$` 系统在反射 $\\mathcal{R}$ 下保持不变，并且平均场在 $y=0$ 处满足反射对称性，即标量是偶函数，而矢量分量根据其在 $\\mathcal{R}$ 下的几何奇偶性进行变换。仅使用上述基本定律和核心定义，并强制控制方程在 $\\mathcal{R}$ 下的不变性，推导在平面 $y=0$ 处变量 $\\mathbf{U}$、$p$、$k$ 和 $\\epsilon$ 的最小对称性一致边界条件集，这些条件需维持反射对称性，并消除在对称面上由法向-切向耦合引起的人为湍流生成。\n\n您的推导必须：\n- 确定反射不变性所要求的每个场分量的奇偶性 (在 $y\\mapsto -y$ 变换下是偶还是奇)。\n- 利用这些奇偶性，推导出 $y=0$ 处的相应边界条件，用场的值或法向导数来表示。\n- 证明在这些边界条件下，所有在 $y=0$ 处的混合法向-切向平均应变分量均为零，从而使局部对称性不会通过法向-切向耦合对 $P_{k}$ 产生虚假贡献。\n\n将您的最终答案表示为有序向量\n$$\\left[v|_{y=0}\\,,\\,\\frac{\\partial u}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial w}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial p}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial k}{\\partial y}\\bigg|_{y=0}\\,,\\,\\frac{\\partial \\epsilon}{\\partial y}\\bigg|_{y=0}\\right],$$\n其中法向导数理解为在平面 $y=0$ 处的 $\\partial/\\partial y$。没有四舍五入要求。最终答案中不应包含物理单位。",
            "solution": "首先根据所需标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **域：** 一个三维域，关于平面 $y=0$ 镜像对称。\n- **反射映射：** $\\mathcal{R}:(x,y,z)\\mapsto(x,-y,z)$。\n- **控制方程：** 不可压缩、统计定常的雷诺平均纳维-斯托克斯 (RANS) 方程。\n- **变量：** 平均速度 $\\mathbf{U}(\\mathbf{x}) = (u(\\mathbf{x}), v(\\mathbf{x}), w(\\mathbf{x}))$，平均压力 $p(\\mathbf{x})$，湍动能 $k(\\mathbf{x})$，以及耗散率 $\\epsilon(\\mathbf{x})$。\n- **定义：**\n    - 湍动能：$k = \\tfrac{1}{2}\\,\\overline{u_{i}'u_{i}'}$。\n    - 湍流耗散率：$\\epsilon = \\nu\\,\\overline{\\partial u_{i}'/\\partial x_{j}\\,\\partial u_{i}'/\\partial x_{j}}$。\n    - 涡粘性：$\\nu_{t} = C_{\\mu}\\,k^{2}/\\epsilon$，其中常数 $C_{\\mu} > 0$。\n    - 平均应变率张量：$S_{ij} = \\tfrac{1}{2}\\left(\\partial U_{i}/\\partial x_{j} + \\partial U_{j}/\\partial x_{i}\\right)$。\n    - 湍流生成：$P_{k} = 2\\,\\nu_{t}\\,S_{ij}S_{ij}$。\n- **假设：**\n    - RANS `$k$-$\\epsilon$` 系统在反射 $\\mathcal{R}$ 下保持不变。\n    - 平均场在 $y=0$ 处满足反射对称性：标量是偶函数，矢量分量根据其在 $\\mathcal{R}$ 下的几何奇偶性进行变换。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于湍流模拟的标准理论（RANS、`$k$-$\\epsilon$` 模型）以及对称性原理在流体动力学中的应用，这是计算流体动力学 (CFD) 的一个核心课题。所用定义和概念均为标准且事实正确。\n- **适定性：** 该问题是适定的。它要求基于明确陈述的对称性假设推导出一组特定的边界条件。预期存在唯一且有意义的解。\n- **客观性：** 该问题以精确、客观和技术性的语言陈述，没有歧义或主观论断。\n\n该问题未表现出验证清单中列出的任何缺陷（例如，科学上不健全、不完整、矛盾等）。它是指定领域内一个有效且可形式化的问题。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### 解题推导\n\n推导过程首先根据指定的反射对称性确定每个场变量的奇偶性，然后推导出在对称平面 $y=0$ 上的相应边界条件。最后，证明这些条件消除了由法向-切向应变耦合引起的虚假湍流生成。\n\n**1. 场变量的奇偶性**\n\n问题陈述流体关于平面 $y=0$ 镜像对称，其反射映射为 $\\mathcal{R}:(x,y,z)\\mapsto(x,-y,z)$。假设在此反射下标量是偶的，矢量分量根据其几何奇偶性进行变换。\n\n设 $\\phi(\\mathbf{x})=\\phi(x,y,z)$ 为一个通用场。\n- 一个标量场 $\\phi_{scalar}$ 如果在反射下保持不变，则为**偶函数**：$\\phi_{scalar}(x,-y,z) = \\phi_{scalar}(x,y,z)$。\n- 一个矢量场 $\\mathbf{U}=(u,v,w)$ 按几何奇偶性进行变换。反射 $\\mathcal{R}$ 使 $y$ 坐标变号，而 $x$ 和 $z$ 坐标保持不变。因此，垂直于对称平面的矢量分量（$v$）必须是奇函数，而切向分量（$u, w$）必须是偶函数。\n\n将这些规则应用于我们关心的变量：\n- 平均压力 $p(\\mathbf{x})$、湍动能 $k(\\mathbf{x})$ 和耗散率 $\\epsilon(\\mathbf{x})$ 都是标量。因此，它们是关于 $y$ 的偶函数：\n  $$p(x,-y,z) = p(x,y,z)$$\n  $$k(x,-y,z) = k(x,y,z)$$\n  $$\\epsilon(x,-y,z) = \\epsilon(x,y,z)$$\n- 平均速度分量具有以下奇偶性：\n  - $u(x,y,z)$ (切向) 是**偶函数**：$u(x,-y,z) = u(x,y,z)$。\n  - $v(x,y,z)$ (法向) 是**奇函数**：$v(x,-y,z) = -v(x,y,z)$。\n  - $w(x,y,z)$ (切向) 是**偶函数**：$w(x,-y,z) = w(x,y,z)$。\n\n**2. $y=0$ 处边界条件的推导**\n\n平面 $y=0$ 处的边界条件由奇偶性推导得出。\n\n- 对于任何关于 $y$ 的奇函数 $\\phi_{odd}(y)$，我们有 $\\phi_{odd}(-y) = -\\phi_{odd}(y)$。在 $y=0$ 处取值，得到 $\\phi_{odd}(0) = -\\phi_{odd}(0)$，这意味着 $2\\phi_{odd}(0)=0$，所以 $\\phi_{odd}(0)=0$。\n- 对于任何关于 $y$ 的连续可微偶函数 $\\phi_{even}(y)$，我们有 $\\phi_{even}(-y) = \\phi_{even}(y)$。使用链式法则对 $y$ 求导，得到 $-\\phi_{even}'(-y) = \\phi_{even}'(y)$。这表明导数 $\\phi_{even}'(y)$ 是一个奇函数。在 $y=0$ 处取值，得出 $-\\phi_{even}'(0) = \\phi_{even}'(0)$，这意味着 $2\\phi_{even}'(0)=0$，所以 $\\phi_{even}'(0)=0$。\n\n将这些数学事实应用于我们在对称平面 $y=0$ 处的场：\n\n- **$v$ 分量：** $v$ 是关于 $y$ 的奇函数。因此，其在 $y=0$ 处的值必须为零。\n  $$v|_{y=0} = 0$$\n- **$u$ 分量：** $u$ 是关于 $y$ 的偶函数。因此，它对 $y$ 的偏导数（法向导数）必须是关于 $y$ 的奇函数，因而在 $y=0$ 处为零。\n  $$\\frac{\\partial u}{\\partial y}\\bigg|_{y=0} = 0$$\n- **$w$ 分量：** $w$ 是关于 $y$ 的偶函数。与 $u$ 类似，其法向导数在 $y=0$ 处必须为零。\n  $$\\frac{\\partial w}{\\partial y}\\bigg|_{y=0} = 0$$\n- **压力 $p$：** $p$ 是一个标量，且是关于 $y$ 的偶函数。因此，其法向导数在 $y=0$ 处必须为零。\n  $$\\frac{\\partial p}{\\partial y}\\bigg|_{y=0} = 0$$\n- **湍动能 $k$：** $k$ 是一个标量，且是关于 $y$ 的偶函数。其法向导数在 $y=0$ 处必须为零。\n  $$\\frac{\\partial k}{\\partial y}\\bigg|_{y=0} = 0$$\n- **耗散率 $\\epsilon$：** $\\epsilon$ 是一个标量，且是关于 $y$ 的偶函数。其法向导数在 $y=0$ 处必须为零。\n  $$\\frac{\\partial \\epsilon}{\\partial y}\\bigg|_{y=0} = 0$$\n\n**3. 消除人为的湍流生成**\n\n湍动能的生成项 $P_k$ 由 $P_k = 2\\,\\nu_{t}\\,S_{ij}S_{ij}$ 给出，其中 $S_{ij}$ 是平均应变率张量。我们必须证明，上面推导出的边界条件消除了由法向（$y$ 方向，指标2）和切向（$x,z$ 方向，指标1,3）速度梯度的耦合所引起的虚假生成。应变率张量的相关分量是混合法向-切向项 $S_{12}$ (也记作 $S_{xy}$) 和 $S_{23}$ (也记作 $S_{yz}$)。\n\n这些分量定义为：\n$$S_{12} = \\frac{1}{2}\\left(\\frac{\\partial U_1}{\\partial x_2} + \\frac{\\partial U_2}{\\partial x_1}\\right) = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right)$$\n$$S_{23} = \\frac{1}{2}\\left(\\frac{\\partial U_2}{\\partial x_3} + \\frac{\\partial U_3}{\\partial x_2}\\right) = \\frac{1}{2}\\left(\\frac{\\partial v}{\\partial z} + \\frac{\\partial w}{\\partial y}\\right)$$\n\n我们在对称平面 $y=0$ 处计算这些分量：\n根据前一节推导的边界条件，我们有：\n$$\\frac{\\partial u}{\\partial y}\\bigg|_{y=0} = 0 \\quad \\text{and} \\quad \\frac{\\partial w}{\\partial y}\\bigg|_{y=0} = 0$$\n\n现在我们必须计算 $v$ 在 $y=0$ 处的切向导数。由于 $v(x,y,z)$ 是关于 $y$ 的奇函数，我们有 $v(x,y,z) = -v(x,-y,z)$。对一个切向坐标（例如 $x$）求偏导数，得到：\n$$\\frac{\\partial v}{\\partial x}(x,y,z) = \\frac{\\partial}{\\partial x}[-v(x,-y,z)] = -\\frac{\\partial v}{\\partial x}(x,-y,z)$$\n这表明 $\\frac{\\partial v}{\\partial x}$ 也是关于 $y$ 的奇函数。如前所述，任何关于 $y$ 的奇函数在 $y=0$ 处都必须为零。因此：\n$$\\frac{\\partial v}{\\partial x}\\bigg|_{y=0} = 0$$\n通过对 $z$ 导数的相同推理：\n$$\\frac{\\partial v}{\\partial z}\\bigg|_{y=0} = 0$$\n\n将这些结果代入 $S_{12}$ 和 $S_{23}$ 在 $y=0$ 处的表达式中：\n$$S_{12}\\bigg|_{y=0} = \\frac{1}{2}\\left(0 + 0\\right) = 0$$\n$$S_{23}\\bigg|_{y=0} = \\frac{1}{2}\\left(0 + 0\\right) = 0$$\n\n由于平均应变率张量的混合法向-切向分量在对称面上恒为零，它们对生成项 $P_k$（与 $S_{12}^2$ 和 $S_{23}^2$ 成正比）的贡献也为零。这证实了所推导的对称边界条件正确地防止了由于法向-切向应变耦合而在对称面上产生人为的湍流。\n\n因此，对称性一致的最小边界条件集由上述推导出的值给出。最终答案是这些值的有序向量。\n- $v|_{y=0} = 0$\n- $\\frac{\\partial u}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial w}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial p}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial k}{\\partial y}\\big|_{y=0} = 0$\n- $\\frac{\\partial \\epsilon}{\\partial y}\\big|_{y=0} = 0$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  0  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在许多不可压流动的CFD求解器中，求解压力泊松方程是确保质量守恒的关键步骤，尤其是在处理周期性流动问题时。本练习旨在揭示一个深刻的数学约束：压力泊松方程在周期性边界条件下并非对任意源项都有解。您将通过应用高斯散度定理，从理论上推导出求解该方程所必须满足的相容性条件，并将其应用于一个具体的一维问题，从而深刻理解为何在周期性域中，物理模型的设定必须满足特定的数学平衡。",
            "id": "4000231",
            "problem": "在计算流体力学 (CFD) 中，考虑在三重周期域 $\\Omega \\subset \\mathbb{R}^{3}$ 上，对于一个密度恒定的流体，其不可压缩的 Navier–Stokes 方程。该域在 $x$、$y$ 和 $z$ 方向上的周期长度分别为 $L_{x}$、$L_{y}$ 和 $L_{z}$。设速度场为 $\\boldsymbol{u}(\\boldsymbol{x},t)$，压力为 $p(\\boldsymbol{x},t)$，并假设所有场都与该域具有相同的空间周期性。在投影法或分数步法中，为了强制不可压缩性，从动量和连续性方程中可以得到一个形如\n$$\n\\nabla^{2} p(\\boldsymbol{x},t) \\;=\\; f(\\boldsymbol{x},t)\n$$\n的压力泊松方程。在周期性边界条件下，未知量 $p$ 的定义可以相差一个可加的常数。\n\n仅使用不可压缩性约束、动量方程和场的周期性，推导该泊松方程在周期性边界条件下有解时，源项 $f$ 必须满足的充分必要相容性条件。\n\n然后，为量化非零均值源项的影响，考虑在具有周期性边界条件的域 $\\Omega = [0,2\\pi]$ 上的一维情况，并设源项为\n$$f(x) = a + b \\cos(x) + c \\cos^{2}(x),$$\n其中 $a$、$b$ 和 $c$ 是常数。确定必须选择的 $a$ 的唯一值（用 $b$ 和 $c$ 的封闭形式表达式表示），以满足您推导的相容性条件，从而使周期性泊松问题有解。将您的最终答案表示为不带单位的单个封闭形式解析表达式。",
            "solution": "该问题分为两部分。第一部分要求推导在三重周期域上的泊松方程的相容性条件。第二部分要求将此条件应用于一个特定的一维情况以求出参数值。\n\n第一部分：相容性条件的推导\n\n给定在三重周期域 $\\Omega \\subset \\mathbb{R}^{3}$ 上的压力泊松方程：\n$$\n\\nabla^{2} p(\\boldsymbol{x},t) = f(\\boldsymbol{x},t)\n$$\n该域在 $x$、$y$ 和 $z$ 方向上的周期分别为 $L_{x}$、$L_{y}$ 和 $L_{z}$。场 $p$ 和 $f$ 也具有相同的周期。\n\n为了推导解 $p$ 存在的相容性条件，我们在整个域 $\\Omega$ 上对该方程两边进行积分：\n$$\n\\int_{\\Omega} \\nabla^{2} p \\,dV = \\int_{\\Omega} f \\,dV\n$$\n此处，$dV$ 是无穷小体积元。\n\n该方程的左侧可以使用散度定理进行变换。散度定理指出，对于向量场 $\\boldsymbol{F}$，有 $\\int_{V} (\\boldsymbol{\\nabla} \\cdot \\boldsymbol{F}) \\,dV = \\oint_{\\partial V} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\,dS$，其中 $\\partial V$ 是体积 $V$ 的边界，$\\boldsymbol{n}$ 是向外的单位法向量。我们将拉普拉斯算子视为梯度的散度，即 $\\nabla^{2} p = \\boldsymbol{\\nabla} \\cdot (\\boldsymbol{\\nabla} p)$。应用散度定理，令 $\\boldsymbol{F} = \\boldsymbol{\\nabla} p$，我们得到：\n$$\n\\int_{\\Omega} \\nabla^{2} p \\,dV = \\int_{\\Omega} \\boldsymbol{\\nabla} \\cdot (\\boldsymbol{\\nabla} p) \\,dV = \\oint_{\\partial \\Omega} (\\boldsymbol{\\nabla} p) \\cdot \\boldsymbol{n} \\,dS\n$$\n周期性盒子 $\\Omega = [0, L_x] \\times [0, L_y] \\times [0, L_z]$ 的边界 $\\partial \\Omega$ 由三对相对的面组成（例如，$x=0$ 处的面和 $x=L_x$ 处的面）。让我们计算其中一对面上的面积分，例如垂直于 $x$ 轴的面。在 $x=0$ 处，向外的法向量是 $\\boldsymbol{n} = -\\boldsymbol{e}_x$，在 $x=L_x$ 处是 $\\boldsymbol{n} = \\boldsymbol{e}_x$。这对面在积分中的贡献为：\n$$\n\\int_{0}^{L_z} \\int_{0}^{L_y} \\left[ (\\boldsymbol{\\nabla} p)|_{x=L_x} \\cdot \\boldsymbol{e}_x + (\\boldsymbol{\\nabla} p)|_{x=0} \\cdot (-\\boldsymbol{e}_x) \\right] dy \\,dz = \\int_{0}^{L_z} \\int_{0}^{L_y} \\left[ \\frac{\\partial p}{\\partial x}\\bigg|_{x=L_x, y, z} - \\frac{\\partial p}{\\partial x}\\bigg|_{x=0, y, z} \\right] dy \\,dz\n$$\n由于指定的周期性边界条件，压力场 $p$ 及其导数在相对边界上必须具有相同的值。因此，对于任何 $(y,z)$：\n$$\n\\frac{\\partial p}{\\partial x}(L_x, y, z) = \\frac{\\partial p}{\\partial x}(0, y, z)\n$$\n这使得上述被积函数处处为零，因此，在这对面上的积分为零。同样的道理也适用于 $y$ 和 $z$ 方向上的对面。因此，整个面积分为零：\n$$\n\\oint_{\\partial \\Omega} (\\boldsymbol{\\nabla} p) \\cdot \\boldsymbol{n} \\,dS = 0\n$$\n综合我们的结果，我们有 $\\int_{\\Omega} \\nabla^{2} p \\,dV = 0$。这直接导出了源项 $f$ 的相容性条件：\n$$\n\\int_{\\Omega} f(\\boldsymbol{x},t) \\,dV = 0\n$$\n这是一个解存在的必要条件。根据 Fredholm 择一性原理，这也是一个充分条件。具有周期性边界条件的算子 $\\nabla^{2}$ 是自伴的。它的零空间是常数函数集。方程 $\\nabla^{2}p = f$ 有解的充要条件是 $f$ 与伴随算子的零空间正交。对于自伴的拉普拉斯算子，这意味着 $f$ 必须与常数函数正交，这正是条件 $\\int_{\\Omega} f \\cdot 1 \\,dV = 0$。这个条件意味着源项在整个域上的空间平均值必须为零。\n\n第二部分：在一维情况下的应用\n\n我们现在考虑在具有周期性边界条件的域 $\\Omega = [0, 2\\pi]$ 上问题的一维 ($1$D) 版本。泊松方程变为：\n$$\n\\frac{d^{2}p}{dx^{2}} = f(x)\n$$\n源项给出为：\n$$\nf(x) = a + b \\cos(x) + c \\cos^{2}(x)\n$$\n其中 $a$、$b$ 和 $c$ 是常数。在第一部分中推导的相容性条件简化为：\n$$\n\\int_{0}^{2\\pi} f(x) \\,dx = 0\n$$\n我们代入 $f(x)$ 的表达式并计算积分：\n$$\n\\int_{0}^{2\\pi} \\left( a + b \\cos(x) + c \\cos^{2}(x) \\right) dx = 0\n$$\n我们可以逐项积分：\n$$\n\\int_{0}^{2\\pi} a \\,dx + \\int_{0}^{2\\pi} b \\cos(x) \\,dx + \\int_{0}^{2\\pi} c \\cos^{2}(x) \\,dx = 0\n$$\n第一个积分是：\n$$\n\\int_{0}^{2\\pi} a \\,dx = a[x]_{0}^{2\\pi} = 2\\pi a\n$$\n第二个积分是：\n$$\n\\int_{0}^{2\\pi} b \\cos(x) \\,dx = b[\\sin(x)]_{0}^{2\\pi} = b(\\sin(2\\pi) - \\sin(0)) = b(0-0) = 0\n$$\n对于第三个积分，我们使用三角恒等式 $\\cos^{2}(x) = \\frac{1}{2}(1 + \\cos(2x))$：\n$$\n\\int_{0}^{2\\pi} c \\cos^{2}(x) \\,dx = c \\int_{0}^{2\\pi} \\frac{1 + \\cos(2x)}{2} \\,dx = \\frac{c}{2} \\left[ x + \\frac{1}{2}\\sin(2x) \\right]_{0}^{2\\pi}\n$$\n$$\n= \\frac{c}{2} \\left[ \\left(2\\pi + \\frac{1}{2}\\sin(4\\pi)\\right) - \\left(0 + \\frac{1}{2}\\sin(0)\\right) \\right] = \\frac{c}{2} [ (2\\pi + 0) - (0 + 0) ] = c\\pi\n$$\n将这些结果代回相容性条件方程：\n$$\n2\\pi a + 0 + c\\pi = 0\n$$\n现在，我们求解 $a$：\n$$\n2\\pi a = -c\\pi\n$$\n$$\na = -\\frac{c\\pi}{2\\pi} = -\\frac{c}{2}\n$$\n因此，为使周期性泊松问题有解，常数 $a$ 必须等于 $-\\frac{c}{2}$。这一选择确保了源项 $f(x)$ 在周期 $[0, 2\\pi]$ 上的平均值为零。$b$ 的值不影响相容性条件，因为 $\\cos(x)$ 在一个完整周期内的平均值为零。",
            "answer": "$$\\boxed{-\\frac{c}{2}}$$"
        },
        {
            "introduction": "在离散化的计算网格上实施周期性边界条件时，必须确保数值格式在边界处的精度和一致性。本练习提供了一个具体实践，用于分析在周期性边界上“环绕”的有限差分格式的准确性。您将运用泰勒级数展开来推导一个二阶中心差分格式在周期性边界上的截断误差，并通过一个傅里叶模式的具体案例，精确计算出离散梯度及其误差的解析表达式，从而深入理解数值方法如何在离散层面忠实地再现连续场的周期性。",
            "id": "4000273",
            "problem": "考虑一个用于计算流体力学 (CFD) 的一维流向周期性区域 $x \\in [0, L]$，对于任意足够光滑的标量场 $q(x)$，其边界条件为周期性的 $q(x+L) = q(x)$。该区域用一个包含 $N$ 个网格中心的均匀网格进行离散，这些网格中心位于 $x_i = i h$，其中 $i \\in \\{0,1,\\dots,N-1\\}$ 且 $h = L/N$。在周期性边界上，索引按模 $N$ 进行回卷，因此 $q_{N} \\equiv q_{0}$ 且 $q_{-1} \\equiv q_{N-1}$。网格点 $i$ 处的离散梯度由二阶中心差分格式近似，\n$$\nD_h q\\big|_{i} = \\frac{q_{i+1} - q_{i-1}}{2 h},\n$$\n我们约定该格式在边界附近周期性地回卷（例如，在 $i=0$ 处，使用 $q_{1}$ 和 $q_{N-1}$）。\n\n从导数的定义和 $q(x)$ 在 $x=0$ 处的泰勒级数展开式出发，对于这个均匀周期性网格上的一个通用光滑函数 $q(x)$，推导中心差分近似 $D_h q\\big|_{0}$ 的主阶截断误差项。然后，考虑傅里叶模态\n$$\nq(x) = \\sin(\\alpha x),\n$$\n其周期性条件为 $\\alpha L = 2 \\pi p$（其中 $p$ 为某个整数），这确保了 $q(x+L) = q(x)$。利用边界处的索引回卷，计算此 $q(x)$ 的离散梯度 $D_h q\\big|_{0}$（用 $\\alpha$ 和 $h$ 表示），并使用泰勒级数展开将 $x=0$ 处的主阶截断误差表示为关于 $\\alpha$ 和 $h$ 的显式解析表达式。\n\n你的最终答案必须是一个包含两个元素的行矩阵：离散梯度近似值 $D_h q\\big|_{0}$ 和主阶截断误差 $D_h q\\big|_{0} - q'(0)$，两者都用 $\\alpha$ 和 $h$ 表示。无需进行数值计算。无需单位。请精确表达最终答案，不要四舍五入。",
            "solution": "我们从导数的定义和通用光滑函数 $q(x)$ 在 $x=0$ 处的泰勒级数展开式开始。在间距为 $h$ 的均匀网格上，相邻点处的函数值可以展开为\n$$\nq(h) = q(0) + h q'(0) + \\frac{h^{2}}{2} q''(0) + \\frac{h^{3}}{6} q^{(3)}(0) + \\frac{h^{4}}{24} q^{(4)}(0) + \\mathcal{O}(h^{5}),\n$$\n$$\nq(-h) = q(0) - h q'(0) + \\frac{h^{2}}{2} q''(0) - \\frac{h^{3}}{6} q^{(3)}(0) + \\frac{h^{4}}{24} q^{(4)}(0) + \\mathcal{O}(h^{5}).\n$$\n在周期性设置下，对于邻近边界的网格点 $i=0$，索引回卷得到 $q_{1} = q(h)$ 和 $q_{N-1} = q(L - h)$。根据周期性，$q(L - h) = q(-h)$，因为 $q(x+L) = q(x)$ 意味着 $q(L - h) = q(-h + L) = q(-h)$。因此，$i=0$ 处的二阶中心差分近似为\n$$\nD_h q\\big|_{0} = \\frac{q_{1} - q_{N-1}}{2 h} = \\frac{q(h) - q(-h)}{2 h}.\n$$\n使用泰勒展开式，\n\\begin{align*}\nq(h) - q(-h) = \\left[q(0) + h q'(0) + \\frac{h^{2}}{2} q''(0) + \\frac{h^{3}}{6} q^{(3)}(0) + \\frac{h^{4}}{24} q^{(4)}(0) + \\mathcal{O}(h^{5})\\right] \\\\\n\\quad - \\left[q(0) - h q'(0) + \\frac{h^{2}}{2} q''(0) - \\frac{h^{3}}{6} q^{(3)}(0) + \\frac{h^{4}}{24} q^{(4)}(0) + \\mathcal{O}(h^{5})\\right] \\\\\n= 2 h q'(0) + \\frac{h^{3}}{3} q^{(3)}(0) + \\mathcal{O}(h^{5}),\n\\end{align*}\n所以\n$$\nD_h q\\big|_{0} = \\frac{q(h) - q(-h)}{2 h} = q'(0) + \\frac{h^{2}}{6} q^{(3)}(0) + \\mathcal{O}(h^{4}).\n$$\n因此，$x=0$ 处的主阶截断误差为\n$$\nE_{\\text{LO}} = D_h q\\big|_{0} - q'(0) = \\frac{h^{2}}{6} q^{(3)}(0),\n$$\n该误差是关于 $h$ 的二阶项，并且借助于周期性回卷，证明了该方法的一致性，包括在邻近边界的网格点上。\n\n接下来，考虑特定的傅里叶模态\n$$\nq(x) = \\sin(\\alpha x),\n$$\n其中 $\\alpha L = 2 \\pi p$，$p \\in \\mathbb{Z}$。在 $i=0$ 处所需的离散值为 $q_{1} = q(h) = \\sin(\\alpha h)$ 和 $q_{N-1} = q(L - h)$。使用周期性和三角恒等式，\n\\begin{align*}\nq(L - h) = \\sin(\\alpha (L - h)) = \\sin(\\alpha L - \\alpha h) \\\\\n= \\sin(\\alpha L) \\cos(\\alpha h) - \\cos(\\alpha L) \\sin(\\alpha h).\n\\end{align*}\n由于 $\\alpha L = 2 \\pi p$，我们有 $\\sin(\\alpha L) = 0$ 和 $\\cos(\\alpha L) = 1$，从而得到\n$$\nq(L - h) = - \\sin(\\alpha h).\n$$\n因此，$i=0$ 处的回卷中心差分为\n$$\nD_h q\\big|_{0} = \\frac{q_{1} - q_{N-1}}{2 h} = \\frac{\\sin(\\alpha h) - \\left[- \\sin(\\alpha h)\\right]}{2 h} = \\frac{\\sin(\\alpha h)}{h}.\n$$\n$x=0$ 处的精确梯度为\n$$\nq'(x) = \\alpha \\cos(\\alpha x) \\quad \\Rightarrow \\quad q'(0) = \\alpha.\n$$\n因此，$x=0$ 处的截断误差为\n$$\nD_h q\\big|_{0} - q'(0) = \\frac{\\sin(\\alpha h)}{h} - \\alpha.\n$$\n为提取主阶项，我们将 $\\sin(\\alpha h)$ 对小量 $h$ 进行展开，\n$$\n\\sin(\\alpha h) = \\alpha h - \\frac{(\\alpha h)^{3}}{6} + \\frac{(\\alpha h)^{5}}{120} + \\mathcal{O}(h^{7}).\n$$\n两边除以 $h$，\n$$\n\\frac{\\sin(\\alpha h)}{h} = \\alpha - \\frac{\\alpha^{3} h^{2}}{6} + \\frac{\\alpha^{5} h^{4}}{120} + \\mathcal{O}(h^{6}),\n$$\n所以\n$$\nD_h q\\big|_{0} - q'(0) = - \\frac{\\alpha^{3} h^{2}}{6} + \\mathcal{O}(h^{4}).\n$$\n这与一般结果 $E_{\\text{LO}} = \\frac{h^{2}}{6} q^{(3)}(0)$ 相符，因为 $q^{(3)}(x) = - \\alpha^{3} \\cos(\\alpha x)$，所以 $q^{(3)}(0) = - \\alpha^{3}$，从而得到\n$$\nE_{\\text{LO}} = \\frac{h^{2}}{6} \\left(- \\alpha^{3}\\right) = - \\frac{\\alpha^{3} h^{2}}{6}.\n$$\n因此，在周期性区域中，回卷的二阶中心差分在邻近边界的网格点上是一致且二阶精确的，对于所选的傅里叶模态，在 $x=0$ 处的离散梯度表达式为 $\\sin(\\alpha h)/h$，主截断误差为 $- \\alpha^{3} h^{2}/6$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\sin(\\alpha h)}{h}  -\\frac{\\alpha^{3} h^{2}}{6}\\end{pmatrix}}$$"
        }
    ]
}