{
    "hands_on_practices": [
        {
            "introduction": "这项练习将几何守恒律 (Geometric Conservation Law, GCL) 的抽象概念具体化到一个计算单元格中。通过手动计算一个闭合单元格的面积矢量之和，您将直接验证一个基本的离散恒等式，这对任何有限体积法都至关重要。本次实践旨在巩固自由流保持的几何基础。",
            "id": "3961207",
            "problem": "在航空航天计算流体动力学（CFD）的背景下，考虑一个由计算坐标 $(\\xi,\\eta) \\in [0,1] \\times [0,1]$ 参数化的单个四边形计算单元。物理坐标 $\\mathbf{r}(\\xi,\\eta) = (x(\\xi,\\eta), y(\\xi,\\eta))$ 由 $\\mathbb{R}^2$ 中的四个角点 $\\mathbf{P}_{00}$、$\\mathbf{P}_{10}$、$\\mathbf{P}_{01}$ 和 $\\mathbf{P}_{11}$ 的双线性映射给出：\n$$\n\\mathbf{r}(\\xi,\\eta) = (1-\\xi)(1-\\eta)\\,\\mathbf{P}_{00} \\;+\\; \\xi(1-\\eta)\\,\\mathbf{P}_{10} \\;+\\; (1-\\xi)\\eta\\,\\mathbf{P}_{01} \\;+\\; \\xi\\eta\\,\\mathbf{P}_{11}.\n$$\n将四个物理边分别视为直线 $\\eta=0$、$\\xi=1$、$\\eta=1$ 和 $\\xi=0$ 的像，每条边都沿单元边界逆时针方向遍历。对于每条边，将其外向面法向长度矢量（二维中的面积矢量）定义为外向单位法向量乘以该边上的微分弧长的线积分。仅从基本的几何和微积分定义（坐标映射、参数曲线的切向量、平面中的单位法向量和线积分）出发，计算四条边的外向面法向长度矢量的闭式表达式（用 $\\mathbf{P}_{00}$、$\\mathbf{P}_{10}$、$\\mathbf{P}_{01}$ 和 $\\mathbf{P}_{11}$ 表示），然后计算它们的和。在曲线网格上自由流守恒的背景下，离散度量恒等式要求对于一个闭合单元，这个和为零。\n\n以闭式形式将最终的和表示为单个行向量。使用单个 $\\mathrm{pmatrix}$ 行矩阵表示最终答案。不需要进行数值取整，最终答案中也无需包含物理单位。",
            "solution": "该问题陈述是有效的。它在科学上基于矢量微积分和计算流体动力学原理，是适定、客观的，并包含得出唯一解所需的所有必要信息。\n\n该问题要求计算由双线性映射定义的计算单元四条边的外向面法向长度矢量之和。这个和是闭合曲面上法向量面积分的离散表示，对于守恒律的评估至关重要。\n\n设物理坐标为 $\\mathbf{r}(\\xi,\\eta) = (x(\\xi,\\eta), y(\\xi,\\eta))$，物理空间中单元的四个角点为 $\\mathbf{P}_{00}$、$\\mathbf{P}_{10}$、$\\mathbf{P}_{01}$ 和 $\\mathbf{P}_{11}$。设 $\\mathbf{P}_{ij} = (x_{ij}, y_{ij})$。双线性映射由以下公式给出：\n$$ \\mathbf{r}(\\xi,\\eta) = (1-\\xi)(1-\\eta)\\mathbf{P}_{00} + \\xi(1-\\eta)\\mathbf{P}_{10} + (1-\\xi)\\eta\\mathbf{P}_{01} + \\xi\\eta\\mathbf{P}_{11} $$\n\n边的外向面法向长度矢量（我们记为 $\\mathbf{S}$）由线积分定义：\n$$ \\mathbf{S} = \\int_{\\text{edge}} \\mathbf{n} \\, ds $$\n其中 $\\mathbf{n}$ 是外向单位法向量，$ds$ 是微分弧长元。\n\n我们首先推导 $\\mathbf{S}$ 的一般表达式。设一条边由变量 $t$ 参数化，其路径由 $\\mathbf{r}(t) = (x(t), y(t))$ 描述。路径的切向量为 $\\mathbf{r}'(t) = \\frac{d\\mathbf{r}}{dt} = (\\frac{dx}{dt}, \\frac{dy}{dt})$。微分弧长为 $ds = ||\\mathbf{r}'(t)|| \\, dt$。\n\n对于（按规定）沿逆时针方向遍历的边界，外向单位法向量 $\\mathbf{n}$ 可以通过将单位切向量 $\\mathbf{T} = \\frac{\\mathbf{r}'(t)}{||\\mathbf{r}'(t)||}$ 顺时针旋转 $\\frac{\\pi}{2}$ 弧度（$90$ 度）得到。如果 $\\mathbf{T} = (T_x, T_y)$，顺时针旋转会得到向量 $(T_y, -T_x)$。因此，外向单位法向量为：\n$$ \\mathbf{n} = \\frac{1}{||\\mathbf{r}'(t)||} \\left(\\frac{dy}{dt}, -\\frac{dx}{dt}\\right) $$\n将 $\\mathbf{n}$ 和 $ds$ 的表达式代入 $\\mathbf{S}$ 的积分中：\n$$ \\mathbf{S} = \\int_{t_{\\text{start}}}^{t_{\\text{end}}} \\left( \\frac{1}{||\\mathbf{r}'(t)||} \\left(\\frac{dy}{dt}, -\\frac{dx}{dt}\\right) \\right) \\big( ||\\mathbf{r}'(t)|| \\, dt \\big) $$\n项 $||\\mathbf{r}'(t)||$ 消去，显著简化了被积函数：\n$$ \\mathbf{S} = \\int_{t_{\\text{start}}}^{t_{\\text{end}}} \\left(\\frac{dy}{dt}, -\\frac{dx}{dt}\\right) dt = \\int_{\\text{start}}^{\\text{end}} (dy, -dx) $$\n设边的起点为 $\\mathbf{P}_{\\text{start}} = (x_{\\text{start}}, y_{\\text{start}})$，终点为 $\\mathbf{P}_{\\text{end}} = (x_{\\text{end}}, y_{\\text{end}})$。对矢量积分的每个分量使用微积分基本定理：\n$$ \\mathbf{S} = \\left( \\int_{y_{\\text{start}}}^{y_{\\text{end}}} dy, -\\int_{x_{\\text{start}}}^{x_{\\text{end}}} dx \\right) = \\left( [y]_{y_{\\text{start}}}^{y_{\\text{end}}}, -[x]_{x_{\\text{start}}}^{x_{\\text{end}}} \\right) $$\n$$ \\mathbf{S} = (y_{\\text{end}} - y_{\\text{start}}, -(x_{\\text{end}} - x_{\\text{start}})) = (y_{\\text{end}} - y_{\\text{start}}, x_{\\text{start}} - x_{\\text{end}}) $$\n这个结果表明，面法向长度矢量仅取决于边端点的坐标。由双线性映射定义的单元的边是直线，因此这个公式是精确的。我们现在将其应用于逆时针遍历的四条边中的每一条。\n\n边 1（底边）：$\\eta=0$，$\\xi$ 从 $0$ 到 $1$。\n路径从 $\\mathbf{r}(0,0) = \\mathbf{P}_{00}$ 到 $\\mathbf{r}(1,0) = \\mathbf{P}_{10}$。\n$$ \\mathbf{S}_1 = (y_{10} - y_{00}, x_{00} - x_{10}) $$\n\n边 2（右边）：$\\xi=1$，$\\eta$ 从 $0$ 到 $1$。\n路径从 $\\mathbf{r}(1,0) = \\mathbf{P}_{10}$ 到 $\\mathbf{r}(1,1) = \\mathbf{P}_{11}$。\n$$ \\mathbf{S}_2 = (y_{11} - y_{10}, x_{10} - x_{11}) $$\n\n边 3（顶边）：$\\eta=1$，$\\xi$ 从 $1$ 到 $0$。\n路径从 $\\mathbf{r}(1,1) = \\mathbf{P}_{11}$ 到 $\\mathbf{r}(0,1) = \\mathbf{P}_{01}$。\n$$ \\mathbf{S}_3 = (y_{01} - y_{11}, x_{11} - x_{01}) $$\n\n边 4（左边）：$\\xi=0$，$\\eta$ 从 $1$ 到 $0$。\n路径从 $\\mathbf{r}(0,1) = \\mathbf{P}_{01}$ 到 $\\mathbf{r}(0,0) = \\mathbf{P}_{00}$。\n$$ \\mathbf{S}_4 = (y_{00} - y_{01}, x_{01} - x_{00}) $$\n\n问题要求这四个矢量的和，即 $\\mathbf{S}_{\\text{total}} = \\mathbf{S}_1 + \\mathbf{S}_2 + \\mathbf{S}_3 + \\mathbf{S}_4$。我们对各分量求和。\n\n和的第一个分量（x 分量）是：\n$$ S_x = (y_{10} - y_{00}) + (y_{11} - y_{10}) + (y_{01} - y_{11}) + (y_{00} - y_{01}) $$\n重新排列各项表明它们成对抵消：\n$$ S_x = (-y_{00} + y_{00}) + (y_{10} - y_{10}) + (y_{01} - y_{01}) + (y_{11} - y_{11}) = 0 $$\n\n和的第二个分量（y 分量）是：\n$$ S_y = (x_{00} - x_{10}) + (x_{10} - x_{11}) + (x_{11} - x_{01}) + (x_{01} - x_{00}) $$\n类似地，重新排列各项表明它们相互抵消：\n$$ S_y = (x_{00} - x_{00}) + (-x_{10} + x_{10}) + (-x_{01} + x_{01}) + (-x_{11} + x_{11}) = 0 $$\n\n因此，闭合单元的外向面法向长度矢量之和为零矢量。\n$$ \\mathbf{S}_{\\text{total}} = (0, 0) $$\n这个结果通常被称为几何守恒律（GCL），是数值格式在曲线网格上精确保持均匀流（自由流）的必要条件。它是散度定理恒等式 $\\oint_S \\mathbf{n} \\, dS = 0$ 在闭合曲面上对于一个常矢量场（在此情况下，与位置无关）的离散模拟。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从离散几何学过渡到连续分析，本问题探讨了坐标变换中产生的度量恒等式。您将通过一个具体的曲线坐标映射，解析地验证度量导数的特定组合为零，这是混合偏导数相等性质的直接结果。这项练习为您在连续理论和其在计算流体力学 (CFD) 代码中的应用之间架起了桥梁。",
            "id": "3961213",
            "problem": "考虑一个从计算空间 $(\\xi,\\eta)$ 到物理空间 $(x,y)$ 的光滑二维坐标映射，定义为 $x(\\xi,\\eta)=\\xi+\\epsilon\\sin\\xi\\sin\\eta$ 和 $y(\\xi,\\eta)=\\eta+\\epsilon\\sin\\xi\\sin\\eta$，其中 $\\epsilon$ 是一个小的无量纲参数，且 $|\\epsilon|\\ll 1$。在曲线网格上的计算流体动力学（CFD）背景下，均匀流保持特性要求坐标变换满足特定的度量恒等式。\n\n仅使用连续介质力学和映射的微分几何中的基本定义，令雅可比行列式定义为 $J=x_{\\xi}y_{\\eta}-x_{\\eta}y_{\\xi}$，逆变度量系数由雅可比矩阵的逆定义，从而得到\n$$\n\\xi_{x}=\\frac{y_{\\eta}}{J},\\quad \\xi_{y}=-\\frac{x_{\\eta}}{J},\\quad \\eta_{x}=-\\frac{y_{\\xi}}{J},\\quad \\eta_{y}=\\frac{x_{\\xi}}{J}.\n$$\n因此，伴随分量 $J\\,\\xi_{x}$、$J\\,\\xi_{y}$、$J\\,\\eta_{x}$ 和 $J\\,\\eta_{y}$ 由下式给出\n$$\nJ\\,\\xi_{x}=y_{\\eta},\\quad J\\,\\xi_{y}=-x_{\\eta},\\quad J\\,\\eta_{x}=-y_{\\xi},\\quad J\\,\\eta_{y}=x_{\\xi}.\n$$\n\n任务：\n1. 计算 $x_{\\xi}$、$x_{\\eta}$、$y_{\\xi}$、$y_{\\eta}$、雅可比行列式 $J$，然后计算 $J\\,\\xi_{x}$、$J\\,\\xi_{y}$、$J\\,\\eta_{x}$ 和 $J\\,\\eta_{y}$，结果精确到 $\\epsilon$ 的一阶。\n2. 使用这些结果，解析地计算标量\n$$\nD=\\frac{\\partial}{\\partial \\xi}\\!\\left(J\\,\\xi_{x}\\right)+\\frac{\\partial}{\\partial \\eta}\\!\\left(J\\,\\eta_{x}\\right)\n$$\n结果精确到 $\\epsilon$ 的一阶，并验证与曲线网格上均匀流保持相关的度量恒等式。\n\n答案要求：\n- 以单个闭式解析表达式的形式给出 $D$ 的最终答案，结果精确到 $\\epsilon$ 的一阶。\n- 无需四舍五入。\n- 该量是无量纲的；不要在最终的方框表达式中包含单位。",
            "solution": "我们从给定的光滑映射 $x(\\xi,\\eta)=\\xi+\\epsilon\\sin\\xi\\sin\\eta$ 和 $y(\\xi,\\eta)=\\eta+\\epsilon\\sin\\xi\\sin\\eta$ 开始。所有导数均是关于计算坐标 $(\\xi,\\eta)$ 求得，并且我们的计算在小参数 $\\epsilon$ 上始终保持一阶精度。\n\n步骤1：计算映射的一阶导数。\n偏导数如下：\n$$\nx_{\\xi}=\\frac{\\partial x}{\\partial \\xi}=1+\\epsilon\\frac{\\partial}{\\partial \\xi}\\left(\\sin\\xi\\sin\\eta\\right)=1+\\epsilon\\cos\\xi\\sin\\eta,\n$$\n$$\nx_{\\eta}=\\frac{\\partial x}{\\partial \\eta}=\\epsilon\\frac{\\partial}{\\partial \\eta}\\left(\\sin\\xi\\sin\\eta\\right)=\\epsilon\\sin\\xi\\cos\\eta,\n$$\n$$\ny_{\\xi}=\\frac{\\partial y}{\\partial \\xi}=\\epsilon\\frac{\\partial}{\\partial \\xi}\\left(\\sin\\xi\\sin\\eta\\right)=\\epsilon\\cos\\xi\\sin\\eta,\n$$\n$$\ny_{\\eta}=\\frac{\\partial y}{\\partial \\eta}=1+\\epsilon\\frac{\\partial}{\\partial \\eta}\\left(\\sin\\xi\\sin\\eta\\right)=1+\\epsilon\\sin\\xi\\cos\\eta.\n$$\n\n步骤2：计算雅可比行列式 $J=x_{\\xi}y_{\\eta}-x_{\\eta}y_{\\xi}$，精确到 $\\epsilon$ 的一阶。\n我们有\n$$\nJ=\\left(1+\\epsilon\\cos\\xi\\sin\\eta\\right)\\left(1+\\epsilon\\sin\\xi\\cos\\eta\\right)-\\left(\\epsilon\\sin\\xi\\cos\\eta\\right)\\left(\\epsilon\\cos\\xi\\sin\\eta\\right).\n$$\n按 $\\epsilon$ 展开并保留至一阶项，\n$$\nJ=1+\\epsilon\\cos\\xi\\sin\\eta+\\epsilon\\sin\\xi\\cos\\eta+\\mathcal{O}(\\epsilon^{2})=1+\\epsilon\\left(\\cos\\xi\\sin\\eta+\\sin\\xi\\cos\\eta\\right)+\\mathcal{O}(\\epsilon^{2}).\n$$\n使用三角恒等式 $\\sin(\\xi+\\eta)=\\sin\\xi\\cos\\eta+\\cos\\xi\\sin\\eta$，我们可以写出\n$$\nJ=1+\\epsilon\\sin(\\xi+\\eta)+\\mathcal{O}(\\epsilon^{2}).\n$$\n\n步骤3：计算伴随分量 $J\\,\\xi_{x}$、$J\\,\\xi_{y}$、$J\\,\\eta_{x}$ 和 $J\\,\\eta_{y}$，精确到 $\\epsilon$ 的一阶。\n根据伴随关系，\n$$\nJ\\,\\xi_{x}=y_{\\eta}=1+\\epsilon\\sin\\xi\\cos\\eta,\n$$\n$$\nJ\\,\\xi_{y}=-x_{\\eta}=-\\epsilon\\sin\\xi\\cos\\eta,\n$$\n$$\nJ\\,\\eta_{x}=-y_{\\xi}=-\\epsilon\\cos\\xi\\sin\\eta,\n$$\n$$\nJ\\,\\eta_{y}=x_{\\xi}=1+\\epsilon\\cos\\xi\\sin\\eta.\n$$\n这些表达式已经精确到 $\\epsilon$ 的一阶。\n\n步骤4：计算标量 $D=\\partial_{\\xi}(J\\,\\xi_{x})+\\partial_{\\eta}(J\\,\\eta_{x})$，精确到 $\\epsilon$ 的一阶。\n使用以上表达式，\n$$\n\\frac{\\partial}{\\partial \\xi}\\left(J\\,\\xi_{x}\\right)=\\frac{\\partial}{\\partial \\xi}\\left(1+\\epsilon\\sin\\xi\\cos\\eta\\right)=\\epsilon\\cos\\xi\\cos\\eta,\n$$\n以及\n$$\n\\frac{\\partial}{\\partial \\eta}\\left(J\\,\\eta_{x}\\right)=\\frac{\\partial}{\\partial \\eta}\\left(-\\epsilon\\cos\\xi\\sin\\eta\\right)=-\\epsilon\\cos\\xi\\cos\\eta.\n$$\n因此，\n$$\nD=\\epsilon\\cos\\xi\\cos\\eta-\\epsilon\\cos\\xi\\cos\\eta=0.\n$$\n\n解释与恒等式：\n$D$ 的值为零并非偶然；它是确保曲线网格上均匀流保持的度量恒等式的一种体现。更一般地，使用伴随关系 $J\\,\\xi_{x}=y_{\\eta}$ 和 $J\\,\\eta_{x}=-y_{\\xi}$，我们观察到\n$$\nD=\\frac{\\partial y_{\\eta}}{\\partial \\xi}-\\frac{\\partial y_{\\xi}}{\\partial \\eta}=y_{\\eta\\xi}-y_{\\xi\\eta}=0,\n$$\n由于混合偏导数的相等性，该式对于任何足够光滑的映射都精确成立。我们对给定的正弦扰动映射进行的精确到 $\\epsilon$ 一阶的显式计算，验证了这一恒等式。\n\n因此，在 $\\epsilon$ 的一阶精度下，标量 $D$ 为零，从而验证了本例中与均匀流保持相关的度量恒等式。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "最后的这项实践将理论付诸行动，展示了满足或违反离散度量恒等式的数值后果。您将为一个简单的守恒律在曲线网格上实现并比较两种不同的数值格式，并观察到只有采用一致差分格式的格式才能正确保持均匀流。这个编码练习为自由流保持为何是任何CFD求解器的关键测试提供了切实的证据。",
            "id": "3961177",
            "problem": "考虑物理坐标 $(x,y)$ 中的二维线性平流守恒律，其具有恒定速度分量 $(a,b)$ 和标量状态 $u(x,y,t)$，方程为 $\\partial u/\\partial t + \\partial (a u)/\\partial x + \\partial (b u)/\\partial y = 0$。设在计算域 $(\\xi,\\eta) \\in [0,1) \\times [0,1)$ 上定义一个光滑、周期的曲线映射 $(x(\\xi,\\eta), y(\\xi,\\eta))$，其中映射由 $x(\\xi,\\eta) = \\xi + \\alpha \\sin(2\\pi \\xi)\\sin(2\\pi \\eta)$ 和 $y(\\xi,\\eta) = \\eta + \\beta \\sin(2\\pi \\xi)\\sin(2\\pi \\eta)$ 指定，$\\alpha$ 和 $\\beta$ 为实数参数。令 $J(\\xi,\\eta) = x_\\xi y_\\eta - x_\\eta y_\\xi$ 表示映射的雅可比行列式，其中下标表示关于 $\\xi$ 和 $\\eta$ 的偏导数。在变换后的守恒形式中，方程变为 $\\partial (J u)/\\partial t + \\partial \\hat{F}/\\partial \\xi + \\partial \\hat{G}/\\partial \\eta = 0$，其中逆变通量为 $\\hat{F} = a u\\, y_\\eta - b u\\, x_\\eta$ 和 $\\hat{G} = b u\\, x_\\xi - a u\\, y_\\xi$。定义一个恒定的自由来流状态为 $u(\\xi,\\eta,t) = u_0$，其中 $u_0$ 是一个与 $(\\xi,\\eta,t)$ 无关的常数，并且对于此状态，空间算子的精确连续残差为零。\n\n您的任务是在周期性计算网格上，为恒定的自由来流状态 $u(\\xi,\\eta,t) = u_0$ 实现两种离散空间残差，并量化它们之间的差异：\n\n- 保守离散化：首先使用具有周期性边界条件的二阶中心差分沿每个计算方向计算度量导数 $x_\\xi$、$x_\\eta$、$y_\\xi$ 和 $y_\\eta$，然后使用上述公式和 $u_0 = 1$ 构建 $\\hat{F}$ 和 $\\hat{G}$，最后使用具有周期性边界条件的二阶中心差分计算散度 $\\partial \\hat{F}/\\partial \\xi + \\partial \\hat{G}/\\partial \\eta$，从而计算离散残差 $R_{\\mathrm{cons}}(\\xi_i,\\eta_j)$。使用均匀的计算间距 $\\Delta \\xi = 1/N_\\xi$ 和 $\\Delta \\eta = 1/N_\\eta$，其中 $N_\\xi$ 和 $N_\\eta$ 分别是 $\\xi$ 和 $\\eta$ 方向上的网格点数。\n\n- 非保守离散化：使用具有周期性边界条件的一阶单边差分计算度量导数，但每个方向的选择不一致：在计算 $x_\\xi$、$x_\\eta$、$y_\\xi$ 和 $y_\\eta$ 时，对 $\\partial/\\partial \\xi$ 使用后向差分，对 $\\partial/\\partial \\eta$ 使用前向差分。然后使用相同的公式和 $u_0=1$ 构建 $\\hat{F}$ 和 $\\hat{G}$，并使用具有周期性边界条件的二阶中心差分计算散度，从而计算离散残差 $R_{\\mathrm{non}}(\\xi_i,\\eta_j)$。这种不一致的度量近似有意违反了离散度量恒等式，并在曲线网格上模拟了关于自由来流保持的非保守离散化。\n\n对于两种离散化，使用以下覆盖所有网格点的度量来量化离散残差：均方根范数 $L_2 = \\sqrt{\\frac{1}{N_\\xi N_\\eta} \\sum_{i=0}^{N_\\xi-1} \\sum_{j=0}^{N_\\eta-1} R(i,j)^2}$ 和最大绝对值范数 $L_\\infty = \\max_{i,j} |R(i,j)|$。在所有计算中，将 $u_0 = 1$ 和 $(a,b)$ 视为给定的常数。没有物理单位；所有量都是无量纲的。\n\n请在指定环境中实现一个程序，为每个测试案例按顺序计算以下三个浮点输出：$(L_{2,\\mathrm{cons}}, L_{2,\\mathrm{non}}, L_{\\infty,\\mathrm{non}})$，其中 $L_{2,\\mathrm{cons}}$ 是 $R_{\\mathrm{cons}}$ 的 $L_2$ 范数，$L_{2,\\mathrm{non}}$ 是 $R_{\\mathrm{non}}$ 的 $L_2$ 范数，$L_{\\infty,\\mathrm{non}}$ 是 $R_{\\mathrm{non}}$ 的 $L_\\infty$ 范数。\n\n使用以下测试套件，该套件通过改变网格分辨率、曲率振幅和速度来探究一般行为、边界条件和边缘情况：\n\n- 案例 1（正常路径）：$N_\\xi = 64$, $N_\\eta = 64$, $\\alpha = 0.2$, $\\beta = -0.1$, $a = 1.0$, $b = 0.5$。\n- 案例 2（边界条件：均匀网格）：$N_\\xi = 32$, $N_\\eta = 32$, $\\alpha = 0.0$, $\\beta = 0.0$, $a = 1.0$, $b = 1.0$。\n- 案例 3（边缘情况：粗糙且高度弯曲）：$N_\\xi = 8$, $N_\\eta = 8$, $\\alpha = 0.3$, $\\beta = 0.25$, $a = 1.0$, $b = -0.4$。\n- 案例 4（各向异性分辨率）：$N_\\xi = 64$, $N_\\eta = 32$, $\\alpha = 0.15$, $\\beta = 0.05$, $a = -0.7$, $b = 1.3$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3,result4,result5,result6,result7,result8,result9,result10,result11,result12]”）。顺序必须严格为案例1、案例2、案例3、案例4的三元组 $(L_{2,\\mathrm{cons}}, L_{2,\\mathrm{non}}, L_{\\infty,\\mathrm{non}})$ 的串联。",
            "solution": "我们从物理坐标 $(x,y)$ 中的标量线性平流守恒律开始，其方程为 $\\partial u/\\partial t + \\partial (a u)/\\partial x + \\partial (b u)/\\partial y = 0$，其中 $(a,b)$ 是恒定的速度分量，$u(x,y,t)$ 是被平流的标量。该守恒律通过一个光滑映射 $(x(\\xi,\\eta),y(\\xi,\\eta))$ 变换到曲线计算坐标 $(\\xi,\\eta)$，其雅可比行列式为 $J(\\xi,\\eta) = x_\\xi y_\\eta - x_\\eta y_\\xi$。成熟的守恒形式变换得到 $\\partial (J u)/\\partial t + \\partial \\hat{F}/\\partial \\xi + \\partial \\hat{G}/\\partial \\eta = 0$，其中对于线性平流通量 $f = a u$ 和 $g = b u$，逆变通量为 $\\hat{F} = f\\, y_\\eta - g\\, x_\\eta = a u\\, y_\\eta - b u\\, x_\\eta$ 和 $\\hat{G} = -f\\, y_\\xi + g\\, x_\\xi = b u\\, x_\\xi - a u\\, y_\\xi$。这些公式源于变量变换下散度算子的变换，构成了计算流体动力学中广泛用于曲线网格上守恒律的基础。\n\n对于恒定的自由来流 $u(\\xi,\\eta,t) = u_0$ 和恒定的 $(a,b)$，空间算子的连续残差简化为 $\\partial \\hat{F}/\\partial \\xi + \\partial \\hat{G}/\\partial \\eta = u_0 \\big(a (y_{\\eta\\xi} - y_{\\xi\\eta}) + b (x_{\\xi\\eta} - x_{\\eta\\xi})\\big)$，由于混合偏导数可交换（即 $y_{\\eta\\xi} = y_{\\xi\\eta}$ 和 $x_{\\xi\\eta} = x_{\\eta\\xi}$），该式恒等于零。这种精确抵消是在任何光滑网格上，连续情况下自由来流保持的解析基础。\n\n在离散情况下，自由来流的保持取决于是否存在与连续混合偏导数可交换性类似的离散度量恒等式。设计算网格为均匀且周期性的，在 $\\xi$ 方向有 $N_\\xi$ 个点，在 $\\eta$ 方向有 $N_\\eta$ 个点，间距分别为 $\\Delta \\xi = 1/N_\\xi$ 和 $\\Delta \\eta = 1/N_\\eta$，索引为 $(i,j)$，其中 $0 \\le i \\le N_\\xi-1$ 和 $0 \\le j \\le N_\\eta-1$。定义映射为 $x(\\xi,\\eta) = \\xi + \\alpha \\sin(2\\pi \\xi)\\sin(2\\pi \\eta)$ 和 $y(\\xi,\\eta) = \\eta + \\beta \\sin(2\\pi \\xi)\\sin(2\\pi \\eta)$，对于任意实数 $\\alpha$ 和 $\\beta$，该映射是光滑且周期性的。为了计算离散导数，我们采用带周期性边界条件的标准有限差分算子。沿 $\\xi$ 的二阶中心差分为 $D_\\xi^{(c)} f_{i,j} = (f_{i+1,j} - f_{i-1,j})/(2 \\Delta \\xi)$，沿 $\\eta$ 的为 $D_\\eta^{(c)} f_{i,j} = (f_{i,j+1} - f_{i,j-1})/(2 \\Delta \\eta)$，其中索引对 $N_\\xi$ 和 $N_\\eta$ 取模。沿 $\\xi$ 的一阶单边差分为 $D_\\xi^{(f)} f_{i,j} = (f_{i+1,j} - f_{i,j})/\\Delta \\xi$ 和 $D_\\xi^{(b)} f_{i,j} = (f_{i,j} - f_{i-1,j})/\\Delta \\xi$，沿 $\\eta$ 的为 $D_\\eta^{(f)} f_{i,j} = (f_{i,j+1} - f_{i,j})/\\Delta \\eta$ 和 $D_\\eta^{(b)} f_{i,j} = (f_{i,j} - f_{i,j-1})/\\Delta \\eta$。\n\n保守离散化设计通过使用相同的二阶中心算子沿每个方向计算度量导数 $x_\\xi$、$x_\\eta$、$y_\\xi$ 和 $y_\\eta$ 来进行，得到 $x_\\xi \\approx D_\\xi^{(c)} x$、$x_\\eta \\approx D_\\eta^{(c)} x$、$y_\\xi \\approx D_\\xi^{(c)} y$ 和 $y_\\eta \\approx D_\\eta^{(c)} y$。然后，对于 $u_0 = 1$，在单元中心处构建逆变通量为 $\\hat{F}_{i,j} = a\\, y_{\\eta, i,j} - b\\, x_{\\eta, i,j}$ 和 $\\hat{G}_{i,j} = b\\, x_{\\xi, i,j} - a\\, y_{\\xi, i,j}$。接着，离散保守残差计算为 $R_{\\mathrm{cons},i,j} = D_\\xi^{(c)} \\hat{F}_{i,j} + D_\\eta^{(c)} \\hat{G}_{i,j}$。由于带周期性边界的中心差分的线性性和平移不变性，离散算子是可交换的，即 $D_\\xi^{(c)} D_\\eta^{(c)} = D_\\eta^{(c)} D_\\xi^{(c)}$，这在离散层面上复制了连续混合偏导数的恒等式。因此，对于恒定自由来流和光滑周期映射，$R_{\\mathrm{cons}}$ 预期在机器精度范围内为零。\n\n非保守离散化通过使用不一致的单边差分计算度量导数来模拟对离散度量恒等式的违反：使用 $x_\\xi \\approx D_\\xi^{(b)} x$、$x_\\eta \\approx D_\\eta^{(f)} x$、$y_\\xi \\approx D_\\xi^{(b)} y$ 和 $y_\\eta \\approx D_\\eta^{(f)} y$，同时仍然使用相同的公式构建 $\\hat{F}$ 和 $\\hat{G}$，并用中心差分计算散度。在这种构造中，计算为 $D_\\xi^{(b)} D_\\eta^{(f)}$ 和 $D_\\eta^{(f)} D_\\xi^{(b)}$ 的混合导数通常不可交换，即使在曲线网格上的恒定自由来流情况下也会产生伪残差。这是一种有原则的方法，用以展示自由来流保持对离散度量恒等式的敏感性。\n\n为量化残差，我们计算均方根范数 $L_2 = \\sqrt{\\frac{1}{N_\\xi N_\\eta} \\sum_{i,j} R_{i,j}^2}$ 和最大绝对值范数 $L_\\infty = \\max_{i,j} |R_{i,j}|$。每个测试案例的算法如下：\n\n- 分别用 $N_\\xi$ 和 $N_\\eta$ 个点构建 $\\xi$ 和 $\\eta$ 的均匀周期网格，间距为 $\\Delta \\xi = 1/N_\\xi$ 和 $\\Delta \\eta = 1/N_\\eta$。\n- 使用给定的 $\\alpha$ 和 $\\beta$ 和提供的映射来评估 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$。\n- 对保守离散化使用中心差分，对非保守离散化使用指定的后向和前向单边差分来计算度量导数 $(x_\\xi, x_\\eta, y_\\xi, y_\\eta)$。\n- 使用 $u_0 = 1$ 和给定的 $(a,b)$ 构建 $\\hat{F}$ 和 $\\hat{G}$。\n- 使用中心差分计算离散散度，以获得 $R_{\\mathrm{cons}}$ 和 $R_{\\mathrm{non}}$。\n- 计算 $L_{2,\\mathrm{cons}}$、$L_{2,\\mathrm{non}}$ 和 $L_{\\infty,\\mathrm{non}}$。\n\n对于测试套件，我们选择四个案例：案例1，$N_\\xi = 64$，$N_\\eta = 64$，$\\alpha = 0.2$，$\\beta = -0.1$，$a = 1.0$，$b = 0.5$，代表一个典型的光滑弯曲周期网格；案例2，$N_\\xi = 32$，$N_\\eta = 32$，$\\alpha = 0.0$，$\\beta = 0.0$，$a = 1.0$，$b = 1.0$，代表一个均匀网格，此时两种离散化都应产生接近零的残差；案例3，$N_\\xi = 8$，$N_\\eta = 8$，$\\alpha = 0.3$，$\\beta = 0.25$，$a = 1.0$，$b = -0.4$，用于探测粗糙分辨率和较大曲率导致较大非保守残差的情况；以及案例4，$N_\\xi = 64$，$N_\\eta = 32$，$\\alpha = 0.15$，$\\beta = 0.05$，$a = -0.7$，$b = 1.3$，用于探索各向异性分辨率效应。最终输出是每个案例的三个度量的串联列表，以规定格式单行打印。",
            "answer": "```python\nimport numpy as np\n\ndef central_diff(arr, axis, d):\n    \"\"\"\n    Second-order centered difference with periodic boundaries along given axis.\n    \"\"\"\n    roll_plus = np.roll(arr, -1, axis=axis)\n    roll_minus = np.roll(arr, 1, axis=axis)\n    return (roll_plus - roll_minus) / (2.0 * d)\n\ndef forward_diff(arr, axis, d):\n    \"\"\"\n    First-order forward difference with periodic boundaries along given axis.\n    \"\"\"\n    roll_plus = np.roll(arr, -1, axis=axis)\n    return (roll_plus - arr) / d\n\ndef backward_diff(arr, axis, d):\n    \"\"\"\n    First-order backward difference with periodic boundaries along given axis.\n    \"\"\"\n    roll_minus = np.roll(arr, 1, axis=axis)\n    return (arr - roll_minus) / d\n\ndef build_mapping(Nxi, Neta, alpha, beta):\n    \"\"\"\n    Construct periodic computational grid and smooth curved mapping.\n    \"\"\"\n    xi = np.linspace(0.0, 1.0, Nxi, endpoint=False)\n    eta = np.linspace(0.0, 1.0, Neta, endpoint=False)\n    XI, ETA = np.meshgrid(xi, eta, indexing='ij')\n    x = XI + alpha * np.sin(2.0 * np.pi * XI) * np.sin(2.0 * np.pi * ETA)\n    y = ETA + beta  * np.sin(2.0 * np.pi * XI) * np.sin(2.0 * np.pi * ETA)\n    return XI, ETA, x, y\n\ndef residuals_for_case(Nxi, Neta, alpha, beta, a, b):\n    \"\"\"\n    Compute L2 and Linf norms of residuals for conservative and non-conservative discretizations.\n    \"\"\"\n    XI, ETA, x, y = build_mapping(Nxi, Neta, alpha, beta)\n    dxi = 1.0 / Nxi\n    deta = 1.0 / Neta\n\n    # Conservative metrics: centered differences\n    x_xi_c   = central_diff(x, axis=0, d=dxi)\n    x_eta_c  = central_diff(x, axis=1, d=deta)\n    y_xi_c   = central_diff(y, axis=0, d=dxi)\n    y_eta_c  = central_diff(y, axis=1, d=deta)\n\n    # Contravariant fluxes with u0=1\n    F_cons = a * y_eta_c - b * x_eta_c\n    G_cons = b * x_xi_c  - a * y_xi_c\n\n    # Divergence with centered differences\n    divF_cons = central_diff(F_cons, axis=0, d=dxi)\n    divG_cons = central_diff(G_cons, axis=1, d=deta)\n    R_cons = divF_cons + divG_cons\n\n    # Non-conservative metrics: inconsistent one-sided differences\n    x_xi_nc  = backward_diff(x, axis=0, d=dxi)\n    x_eta_nc = forward_diff(x, axis=1, d=deta)\n    y_xi_nc  = backward_diff(y, axis=0, d=dxi)\n    y_eta_nc = forward_diff(y, axis=1, d=deta)\n\n    F_non = a * y_eta_nc - b * x_eta_nc\n    G_non = b * x_xi_nc  - a * y_xi_nc\n\n    divF_non = central_diff(F_non, axis=0, d=dxi)\n    divG_non = central_diff(G_non, axis=1, d=deta)\n    R_non = divF_non + divG_non\n\n    # Norms\n    l2_cons = float(np.sqrt(np.mean(R_cons**2)))\n    l2_non  = float(np.sqrt(np.mean(R_non**2)))\n    linf_non = float(np.max(np.abs(R_non)))\n\n    return l2_cons, l2_non, linf_non\n\ndef solve():\n    test_cases = [\n        # Case 1: Nxi, Neta, alpha, beta, a, b\n        (64, 64, 0.2, -0.1, 1.0, 0.5),\n        # Case 2: uniform grid\n        (32, 32, 0.0, 0.0, 1.0, 1.0),\n        # Case 3: coarse and highly curved\n        (8, 8, 0.3, 0.25, 1.0, -0.4),\n        # Case 4: anisotropic resolution\n        (64, 32, 0.15, 0.05, -0.7, 1.3),\n    ]\n\n    results = []\n    for case in test_cases:\n        Nxi, Neta, alpha, beta, a, b = case\n        l2c, l2n, linfn = residuals_for_case(Nxi, Neta, alpha, beta, a, b)\n        results.extend([l2c, l2n, linfn])\n\n    # Print single-line, comma-separated list enclosed in square brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}