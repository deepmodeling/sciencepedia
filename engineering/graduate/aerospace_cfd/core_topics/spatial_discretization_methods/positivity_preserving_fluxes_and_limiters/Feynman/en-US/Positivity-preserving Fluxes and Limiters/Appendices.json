{
    "hands_on_practices": [
        {
            "introduction": "Before delving into numerical algorithms, it is essential to grasp the physical constraints they must honor. This practice grounds the abstract concept of positivity in fundamental thermodynamics, directly linking it to measurable quantities like energy and pressure. By deriving the minimum total energy required to ensure pressure remains positive, you will establish a clear physical intuition for the bounds that robust numerical schemes must never violate .",
            "id": "3986171",
            "problem": "In the context of compressible inviscid flow modeled by the Euler equations for a calorically perfect gas, positivity-preserving fluxes and limiters must maintain strictly positive thermodynamic pressure. Consider a control volume with mass density $\\rho$, flow speed magnitude $|u|$, ratio of specific heats $\\gamma > 1$, and total energy per unit volume $E$. Use only the following fundamental bases: the ideal-gas thermodynamic relation $p = (\\gamma - 1)\\rho e$ relating pressure $p$ and specific internal energy $e$, and the definition of total energy per unit volume $E = \\rho e + \\frac{1}{2}\\rho |u|^2$.\n\nDerive from these bases the minimal total energy per unit volume $E_{\\min}$ that guarantees $p>0$. Then, for the given parameters $\\gamma = 1.4$, $\\rho = 0.2\\,\\text{kg}\\,\\text{m}^{-3}$, and $|u| = 30\\,\\text{m}\\,\\text{s}^{-1}$, compute $E_{\\min}$. Express the final numerical value of $E_{\\min}$ in $\\text{J}\\,\\text{m}^{-3}$. No rounding is required.\n\nFinally, justify mathematically how sensitive $E_{\\min}$ is to $|u|$ at fixed $\\rho$ by quantifying the local sensitivity and the fractional (logarithmic) sensitivity, but note that your final reported answer must be only the computed $E_{\\min}$ value.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Context**: Compressible inviscid flow, Euler equations, calorically perfect gas.\n- **Constraint**: Thermodynamic pressure must be strictly positive, $p>0$.\n- **Variables**: Mass density $\\rho$, flow speed magnitude $|u|$, ratio of specific heats $\\gamma > 1$, total energy per unit volume $E$.\n- **Fundamental Relations**:\n  1. Ideal-gas thermodynamic relation: $p = (\\gamma - 1)\\rho e$, where $e$ is the specific internal energy.\n  2. Definition of total energy per unit volume: $E = \\rho e + \\frac{1}{2}\\rho |u|^2$.\n- **Task 1**: Derive the minimal total energy per unit volume, $E_{\\min}$, that guarantees $p>0$.\n- **Task 2**: Compute the numerical value of $E_{\\min}$ for the parameters $\\gamma = 1.4$, $\\rho = 0.2\\,\\text{kg}\\,\\text{m}^{-3}$, and $|u| = 30\\,\\text{m}\\,\\text{s}^{-1}$.\n- **Task 3**: Justify mathematically the sensitivity of $E_{\\min}$ to $|u|$ at fixed $\\rho$. The final reported answer must be only the value of $E_{\\min}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the fundamental principles of thermodynamics and fluid dynamics, specifically the Euler equations for a perfect gas. The relations provided for pressure and total energy are standard definitions. The concept of positivity-preserving schemes is a cornerstone of modern numerical methods for solving hyperbolic conservation laws, such as the Euler equations. The problem is scientifically sound.\n- **Well-Posed**: The problem is clearly stated and provides all necessary information to derive a unique solution. The constraint $p>0$ is unambiguous. The task of finding a minimum value based on this constraint is well-defined.\n- **Objective**: The problem is articulated using precise, objective scientific language. All terms ($\\rho$, $E$, $p$, $\\gamma$, $e$, $|u|$) are standard in the field.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and contains no discernible flaws. A solution will be provided.\n\n### Solution Derivation\nThe objective is to find the minimum total energy per unit volume, $E_{\\min}$, required to ensure the thermodynamic pressure $p$ is strictly positive.\n\nThe problem provides two fundamental relationships:\n1. $p = (\\gamma - 1)\\rho e$\n2. $E = \\rho e + \\frac{1}{2}\\rho |u|^2$\n\nThe condition to be satisfied is $p > 0$. From the first relation, we analyze the terms on the right-hand side. The ratio of specific heats $\\gamma$ for a physically realistic gas is strictly greater than $1$, so $(\\gamma - 1) > 0$. The mass density $\\rho$ must be non-negative, and for a physical medium, it is strictly positive, $\\rho > 0$. Therefore, the condition $p > 0$ is mathematically equivalent to the condition that the specific internal energy $e$ must be strictly positive:\n$$ e > 0 $$\n\nNow, we use the second relation, which defines the total energy per unit volume $E$. We can express the specific internal energy $e$ in terms of $E$, $\\rho$, and $|u|$. First, rearrange the equation to solve for the term $\\rho e$:\n$$ \\rho e = E - \\frac{1}{2}\\rho |u|^2 $$\nThen, divide by $\\rho$ (since $\\rho > 0$) to find $e$:\n$$ e = \\frac{E}{\\rho} - \\frac{1}{2}|u|^2 $$\nApplying the positivity constraint $e > 0$:\n$$ \\frac{E}{\\rho} - \\frac{1}{2}|u|^2 > 0 $$\nTo satisfy this inequality, the total energy per unit volume $E$ must be greater than the kinetic energy per unit volume:\n$$ E > \\frac{1}{2}\\rho |u|^2 $$\nThe minimal total energy per unit volume, $E_{\\min}$, is the infimum of the set of all possible values for $E$ that satisfy this condition. This corresponds to the boundary case where the specific internal energy approaches zero, $e \\to 0^+$, and consequently the pressure approaches zero, $p \\to 0^+$. Thus, the minimal total energy is:\n$$ E_{\\min} = \\frac{1}{2}\\rho |u|^2 $$\nThis result signifies that for pressure to be positive, the total energy must at least account for the kinetic energy content of the flow. Any value of $E$ below this threshold would imply a negative specific internal energy, which is physically impossible and would result in negative pressure.\n\n### Numerical Calculation\nThe problem requires the calculation of $E_{\\min}$ for the given parameters:\n- $\\rho = 0.2\\,\\text{kg}\\,\\text{m}^{-3}$\n- $|u| = 30\\,\\text{m}\\,\\text{s}^{-1}$\n- $\\gamma = 1.4$ (Note that $E_{\\min}$ is independent of $\\gamma$)\n\nSubstituting the values for $\\rho$ and $|u|$ into the derived expression for $E_{\\min}$:\n$$ E_{\\min} = \\frac{1}{2} (0.2) (30)^2 $$\n$$ E_{\\min} = \\frac{1}{2} (0.2) (900) $$\n$$ E_{\\min} = (0.1) (900) $$\n$$ E_{\\min} = 90 $$\nThe units are derived from the calculation: $(\\text{kg}\\,\\text{m}^{-3}) \\times (\\text{m}\\,\\text{s}^{-1})^2 = \\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-2} = (\\text{kg}\\,\\text{m}\\,\\text{s}^{-2})\\,\\text{m}^{-2} = \\text{N}\\,\\text{m}^{-2} = \\text{Pa}$. Since $1\\,\\text{Pa} = 1\\,\\text{J}\\,\\text{m}^{-3}$, the final units are Joules per cubic meter, as required.\n\n### Sensitivity Analysis\nFinally, we analyze the sensitivity of $E_{\\min}$ to the flow speed magnitude $|u|$ while keeping the density $\\rho$ fixed. The relationship is $E_{\\min} = \\frac{1}{2}\\rho|u|^2$.\n\nThe local sensitivity is the rate of change of $E_{\\min}$ with respect to $|u|$, which is given by the partial derivative:\n$$ \\frac{\\partial E_{\\min}}{\\partial |u|} = \\frac{\\partial}{\\partial |u|} \\left( \\frac{1}{2}\\rho|u|^2 \\right) = \\frac{1}{2}\\rho (2|u|) = \\rho|u| $$\nThis linear relationship indicates that the absolute change in $E_{\\min}$ for a unit change in $|u|$ grows proportionally with both $\\rho$ and $|u|$.\n\nThe fractional or logarithmic sensitivity measures the percentage change in $E_{\\min}$ for a percentage change in $|u|$. It is defined as $\\frac{\\partial \\ln(E_{\\min})}{\\partial \\ln(|u|)}$. We can find this by taking the natural logarithm of the expression for $E_{\\min}$:\n$$ \\ln(E_{\\min}) = \\ln\\left(\\frac{1}{2}\\rho|u|^2\\right) = \\ln\\left(\\frac{1}{2}\\rho\\right) + \\ln(|u|^2) = \\ln\\left(\\frac{1}{2}\\rho\\right) + 2\\ln(|u|) $$\nNow, taking the derivative with respect to $\\ln(|u|)$:\n$$ \\frac{\\partial \\ln(E_{\\min})}{\\partial \\ln(|u|)} = \\frac{\\partial}{\\partial \\ln(|u|)} \\left[ \\ln\\left(\\frac{1}{2}\\rho\\right) + 2\\ln(|u|) \\right] = 2 $$\nA constant logarithmic sensitivity of $2$ demonstrates that $E_{\\min}$ has a quadratic dependence on $|u|$. This means that a $1\\%$ increase in $|u|$ will result in a $2\\%$ increase in $E_{\\min}$, regardless of the specific values of $\\rho$ or $|u|$. This high sensitivity underscores the critical importance of accurately resolving flow speed in numerical schemes, as small errors in $|u|$ can lead to much larger relative errors in the energy threshold required for positivity.",
            "answer": "$$\\boxed{90}$$"
        },
        {
            "introduction": "With the physical constraint established, the next step is to translate it into a practical rule for a numerical scheme. This exercise guides you through a cornerstone proof technique for first-order methods, demonstrating how to derive a positivity-preserving time-step condition from cell geometry and local wave speeds. Understanding this \"convex combination\" argument is fundamental to analyzing how schemes like the Rusanov flux maintain the physical admissibility of the solution .",
            "id": "3986109",
            "problem": "Consider the two-dimensional compressible Euler equations written in conservation form as $\\partial_t \\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$, where $\\boldsymbol{U}$ is the vector of conserved variables and $\\boldsymbol{F}(\\boldsymbol{U})$ is the flux tensor. Let $\\mathcal{G}$ denote the admissible set consisting of states with positive density and positive specific internal energy. A first-order explicit finite-volume method on an unstructured triangular mesh advances the cell-average $\\boldsymbol{U}_K^n$ over a triangular control volume $K$ of area $|K|$ via interface fluxes computed by the local Laxâ€“Friedrichs (Rusanov) numerical flux. For each face $f_i$ of $K$, let $\\ell_i$ be the face length, $\\boldsymbol{n}_i$ be the outward unit normal, and $a_i$ be an upper bound on the one-sided maximum signal speed (spectral radius of the flux Jacobian in the direction $\\boldsymbol{n}_i$) based on the states on both sides of $f_i$. Assume that along each face, a one-dimensional Rusanov update with Courant number not exceeding unity preserves membership in $\\mathcal{G}$.\n\nUsing only the conservation law, the finite-volume update with Rusanov flux, and the requirement that the update be representable as a convex combination of states known to lie in $\\mathcal{G}$, derive the condition on the time step $\\Delta t$ that ensures $\\boldsymbol{U}_K^{n+1}$ can be written as a convex combination of face-based intermediate states that belong to $\\mathcal{G}$. Then, for the specific triangular control volume with area $|K| = 0.0024\\,\\mathrm{m}^2$, face lengths $\\ell_1 = 0.06\\,\\mathrm{m}$, $\\ell_2 = 0.08\\,\\mathrm{m}$, and $\\ell_3 = 0.10\\,\\mathrm{m}$, and face wave-speed bounds $a_1 = 350\\,\\mathrm{m/s}$, $a_2 = 400\\,\\mathrm{m/s}$, and $a_3 = 450\\,\\mathrm{m/s}$, compute the maximal $\\Delta t$ that satisfies this condition so that the update remains a convex combination of admissible states in $\\mathcal{G}$. Round your final numerical answer to four significant figures and express it in seconds. The final answer must be a single real number.",
            "solution": "The problem requires the derivation of a condition on the time step $\\Delta t$ for a first-order explicit finite-volume scheme to be positivity-preserving, and then to calculate the maximum allowed $\\Delta t$ for a specific case. The scheme uses the local Lax-Friedrichs (Rusanov) numerical flux for the two-dimensional compressible Euler equations on an unstructured triangular mesh. The core of the proof relies on expressing the updated cell-average state $\\boldsymbol{U}_K^{n+1}$ as a convex combination of states that are known to be in the admissible set $\\mathcal{G}$, which consists of states with positive density and positive specific internal energy.\n\nLet $\\boldsymbol{U}_K^n$ be the cell-average of the conserved variables over a triangular control volume $K$ at time $t^n$. The first-order explicit finite-volume update is given by:\n$$ |K| \\boldsymbol{U}_K^{n+1} = |K| \\boldsymbol{U}_K^n - \\Delta t \\sum_{i=1}^{3} \\ell_i \\boldsymbol{F}_{i} $$\nwhere $|K|$ is the area of the triangle, $\\ell_i$ is the length of the $i$-th face, and $\\boldsymbol{F}_{i}$ is the numerical flux across that face. Dividing by $|K|$, we get:\n$$ \\boldsymbol{U}_K^{n+1} = \\boldsymbol{U}_K^n - \\frac{\\Delta t}{|K|} \\sum_{i=1}^{3} \\ell_i \\boldsymbol{F}_{i} $$\nThe Rusanov numerical flux $\\boldsymbol{F}_i$ between the state $\\boldsymbol{U}_K^n$ in cell $K$ and the state $\\boldsymbol{U}_{N_i}^n$ in the neighboring cell across face $i$ with outward unit normal $\\boldsymbol{n}_i$ is:\n$$ \\boldsymbol{F}_i = \\frac{\\boldsymbol{F}(\\boldsymbol{U}_K^n) \\cdot \\boldsymbol{n}_i + \\boldsymbol{F}(\\boldsymbol{U}_{N_i}^n) \\cdot \\boldsymbol{n}_i}{2} - \\frac{a_i}{2} (\\boldsymbol{U}_{N_i}^n - \\boldsymbol{U}_K^n) $$\nHere, $\\boldsymbol{F}(\\boldsymbol{U})$ is the physical flux tensor, and $a_i$ is an upper bound on the maximum signal speed at the interface.\n\nA crucial geometric identity for any closed control volume is that the sum of the outward-pointing normal vectors scaled by the face lengths is zero:\n$$ \\sum_{i=1}^{3} \\ell_i \\boldsymbol{n}_i = \\boldsymbol{0} $$\nSince the physical flux tensor $\\boldsymbol{F}(\\boldsymbol{U}_K^n)$ is constant within cell $K$, we can use this identity to state:\n$$ \\sum_{i=1}^{3} \\ell_i (\\boldsymbol{F}(\\boldsymbol{U}_K^n) \\cdot \\boldsymbol{n}_i) = \\boldsymbol{F}(\\boldsymbol{U}_K^n) \\cdot \\left(\\sum_{i=1}^{3} \\ell_i \\boldsymbol{n}_i\\right) = \\boldsymbol{0} $$\nWe can add this null term to the flux summation in the update scheme without changing its value:\n$$ \\boldsymbol{U}_K^{n+1} = \\boldsymbol{U}_K^n - \\frac{\\Delta t}{|K|} \\sum_{i=1}^{3} \\ell_i \\left( \\boldsymbol{F}_i - \\boldsymbol{F}(\\boldsymbol{U}_K^n) \\cdot \\boldsymbol{n}_i \\right) $$\nThe term inside the parenthesis represents the flux fluctuation. Let's define it as $\\boldsymbol{\\Phi}_i$:\n$$ \\boldsymbol{\\Phi}_i = \\boldsymbol{F}_i - \\boldsymbol{F}(\\boldsymbol{U}_K^n) \\cdot \\boldsymbol{n}_i = \\frac{\\boldsymbol{F}(\\boldsymbol{U}_{N_i}^n)\\cdot\\boldsymbol{n}_i - \\boldsymbol{F}(\\boldsymbol{U}_K^n)\\cdot\\boldsymbol{n}_i}{2} - \\frac{a_i}{2}(\\boldsymbol{U}_{N_i}^n - \\boldsymbol{U}_K^n) $$\nThe problem states that a one-dimensional Rusanov update with Courant number $\\le 1$ preserves membership in $\\mathcal{G}$. A one-dimensional update on a cell of size $h$ with state $\\boldsymbol{U}_K^n$ neighboring $\\boldsymbol{U}_{N_i}^n$ over a time step $\\Delta t_{1D}$ can be written as $\\boldsymbol{U}_{new} = \\boldsymbol{U}_K^n - \\frac{\\Delta t_{1D}}{h} \\boldsymbol{\\Phi}_i$. The associated Courant number is $\\frac{a_i \\Delta t_{1D}}{h}$. The assumption implies that if we choose $\\frac{\\Delta t_{1D}}{h} = \\frac{1}{a_i}$ (Courant number of $1$), the resulting state is in $\\mathcal{G}$. Let's define these face-based intermediate states:\n$$ \\boldsymbol{U}_{K,i}^* = \\boldsymbol{U}_K^n - \\frac{1}{a_i} \\boldsymbol{\\Phi}_i $$\nBy the problem's premise, $\\boldsymbol{U}_{K,i}^* \\in \\mathcal{G}$ for $i=1, 2, 3$.\n\nNow we rearrange the update for $\\boldsymbol{U}_K^{n+1}$ to express it as a convex combination of the states $\\boldsymbol{U}_K^n$ and $\\{\\boldsymbol{U}_{K,i}^*\\}$:\n$$ \\boldsymbol{U}_K^{n+1} = \\boldsymbol{U}_K^n - \\sum_{i=1}^{3} \\frac{\\Delta t \\ell_i}{|K|} \\boldsymbol{\\Phi}_i $$\nBy substituting $\\boldsymbol{\\Phi}_i = a_i (\\boldsymbol{U}_K^n - \\boldsymbol{U}_{K,i}^*)$, we get:\n$$ \\boldsymbol{U}_K^{n+1} = \\boldsymbol{U}_K^n - \\sum_{i=1}^{3} \\frac{\\Delta t \\ell_i a_i}{|K|} (\\boldsymbol{U}_K^n - \\boldsymbol{U}_{K,i}^*) $$\nGrouping the terms for $\\boldsymbol{U}_K^n$ and $\\boldsymbol{U}_{K,i}^*$:\n$$ \\boldsymbol{U}_K^{n+1} = \\left( 1 - \\sum_{i=1}^{3} \\frac{\\Delta t \\ell_i a_i}{|K|} \\right) \\boldsymbol{U}_K^n + \\sum_{i=1}^{3} \\frac{\\Delta t \\ell_i a_i}{|K|} \\boldsymbol{U}_{K,i}^* $$\nThis equation expresses $\\boldsymbol{U}_K^{n+1}$ as a linear combination of the states $\\boldsymbol{U}_K^n, \\boldsymbol{U}_{K,1}^*, \\boldsymbol{U}_{K,2}^*,$ and $\\boldsymbol{U}_{K,3}^*$. We know $\\boldsymbol{U}_K^n \\in \\mathcal{G}$ (by induction), and the problem guarantees $\\boldsymbol{U}_{K,i}^* \\in \\mathcal{G}$. Since $\\mathcal{G}$ is a convex set, any convex combination of these states will also be in $\\mathcal{G}$.\n\nFor the expression to be a convex combination, the coefficients must be non-negative and sum to $1$.\nLet $C_0 = 1 - \\sum_{i=1}^{3} \\frac{\\Delta t \\ell_i a_i}{|K|}$ and $C_i = \\frac{\\Delta t \\ell_i a_i}{|K|}$ for $i=1, 2, 3$.\nThe sum of the coefficients is $C_0 + C_1 + C_2 + C_3 = 1$, which is satisfied by construction.\nThe non-negativity conditions are:\n1. $C_i \\ge 0$: Since $\\Delta t > 0$, $\\ell_i > 0$, $a_i > 0$, and $|K| > 0$, this condition is always met.\n2. $C_0 \\ge 0$: This provides the condition on the time step.\n$$ 1 - \\sum_{i=1}^{3} \\frac{\\Delta t \\ell_i a_i}{|K|} \\ge 0 $$\n$$ 1 \\ge \\frac{\\Delta t}{|K|} \\sum_{i=1}^{3} \\ell_i a_i $$\nRearranging for $\\Delta t$, we obtain the condition:\n$$ \\Delta t \\le \\frac{|K|}{\\sum_{i=1}^{3} \\ell_i a_i} $$\nThis is the condition that ensures the update remains a convex combination of admissible states, thereby preserving positivity.\n\nNow, we compute the maximal allowed time step, $\\Delta t_{max}$, for the given numerical data:\n- Area $|K| = 0.0024\\,\\mathrm{m}^2$\n- Face lengths $\\ell_1 = 0.06\\,\\mathrm{m}$, $\\ell_2 = 0.08\\,\\mathrm{m}$, $\\ell_3 = 0.10\\,\\mathrm{m}$\n- Wave-speed bounds $a_1 = 350\\,\\mathrm{m/s}$, $a_2 = 400\\,\\mathrm{m/s}$, $a_3 = 450\\,\\mathrm{m/s}$\n\nFirst, we compute the sum in the denominator:\n$$ \\sum_{i=1}^{3} \\ell_i a_i = \\ell_1 a_1 + \\ell_2 a_2 + \\ell_3 a_3 $$\n$$ \\sum_{i=1}^{3} \\ell_i a_i = (0.06\\,\\mathrm{m})(350\\,\\mathrm{m/s}) + (0.08\\,\\mathrm{m})(400\\,\\mathrm{m/s}) + (0.10\\,\\mathrm{m})(450\\,\\mathrm{m/s}) $$\n$$ \\sum_{i=1}^{3} \\ell_i a_i = 21\\,\\mathrm{m^2/s} + 32\\,\\mathrm{m^2/s} + 45\\,\\mathrm{m^2/s} = 98\\,\\mathrm{m^2/s} $$\nThe maximal time step is then:\n$$ \\Delta t_{max} = \\frac{|K|}{\\sum_{i=1}^{3} \\ell_i a_i} = \\frac{0.0024\\,\\mathrm{m}^2}{98\\,\\mathrm{m}^2/\\mathrm{s}} $$\n$$ \\Delta t_{max} = \\frac{0.0024}{98}\\,\\mathrm{s} \\approx 0.0000244897959... \\,\\mathrm{s} $$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures are $2, 4, 4, 8$. The fifth significant figure is $9$, so we round up the eighth digit.\n$$ \\Delta t_{max} \\approx 0.00002449\\,\\mathrm{s} $$",
            "answer": "$$\\boxed{0.00002449}$$"
        },
        {
            "introduction": "High-resolution schemes achieve superior accuracy by adding corrective \"antidiffusive\" fluxes to a simpler, more robust low-order method. However, these corrections can introduce unphysical oscillations and violate positivity unless they are carefully controlled or \"limited.\" This advanced practice challenges you to design such a limiter from first principles, a core skill in the construction of modern, high-fidelity CFD solvers using methodologies like Flux-Corrected Transport (FCT) .",
            "id": "3986154",
            "problem": "Consider the scalar continuity equation for the mass density $\\rho(\\boldsymbol{x},t)$ with a given velocity field $\\boldsymbol{u}(\\boldsymbol{x},t)$ on a general conservative control-volume mesh:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla\\cdot\\left(\\rho\\,\\boldsymbol{u}\\right) = 0.\n$$\nLet $\\{V_i\\}$ denote the control-volume measures and $\\mathcal{N}(i)$ the set of face-adjacent neighbors of control-volume $i$. A first-order monotone low-order finite volume update with forward Euler time-stepping and time step $\\Delta t$ produces a provisional value $\\rho_i^{L}$ that is known to satisfy the lower bound $\\rho_i^{L} \\ge \\rho_{\\min}$ for all $i$. To increase accuracy, this low-order update is corrected by adding pairwise antidiffusive edge fluxes. Let $F_{ij}^{A}$ denote the antidiffusive mass flow rate into cell $i$ through the common face with neighbor $j\\in\\mathcal{N}(i)$. These fluxes satisfy antisymmetry $F_{ij}^{A} = -F_{ji}^{A}$ for all adjacent pairs $i$ and $j$. The correction to the cell-average density is\n$$\n\\rho_i^{n+1} \\;=\\; \\rho_i^{L} \\;+\\; \\frac{\\Delta t}{V_i}\\,\\sum_{j\\in\\mathcal{N}(i)} \\phi_{ij}\\,F_{ij}^{A},\n$$\nwhere $\\phi_{ij}\\in[0,1]$ are limiter coefficients to be chosen. Assume that $\\phi_{ij}=\\phi_{ji}$ is required to preserve pairwise conservation. The objective is to enforce the discrete positivity constraint $\\rho_i^{n+1}\\ge \\rho_{\\min}$ for all $i$, using only the already positivity-preserving low-order state $\\rho_i^{L}$ and the antidiffusive fluxes $F_{ij}^{A}$. No upper bound needs to be enforced in this problem.\n\nStarting from conservation in integral form over control volumes, the positivity of the low-order update, and the antisymmetry of antidiffusive fluxes, derive a closed-form expression for a local, symmetric limiter $\\phi_{ij}\\in[0,1]$ that guarantees $\\rho_i^{n+1}\\ge\\rho_{\\min}$ for every control volume. Your result must be expressed entirely in terms of $\\rho_i^{L}, \\rho_{\\min}, V_i, \\Delta t$, and the set $\\{F_{ij}^{A}\\}$. Express your final answer as a single closed-form analytic expression for $\\phi_{ij}$ (it may be piecewise-defined), and do not include any units.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the principles of computational fluid dynamics for conservation laws, specifically the development of high-resolution, property-preserving numerical schemes. It is well-posed, objective, and contains all necessary information to derive the requested limiter.\n\nThe objective is to find a symmetric limiter $\\phi_{ij} \\in [0,1]$ such that the updated cell-average density $\\rho_i^{n+1}$ satisfies the positivity constraint $\\rho_i^{n+1} \\ge \\rho_{\\min}$ for all control volumes $i$. The update formula is given by:\n$$\n\\rho_i^{n+1} = \\rho_i^{L} + \\frac{\\Delta t}{V_i}\\,\\sum_{j\\in\\mathcal{N}(i)} \\phi_{ij}\\,F_{ij}^{A}\n$$\nWe are given that the low-order update is already positivity-preserving, i.e., $\\rho_i^{L} \\ge \\rho_{\\min}$ for all $i$.\n\nThe constraint $\\rho_i^{n+1} \\ge \\rho_{\\min}$ can be substituted into the update formula:\n$$\n\\rho_i^{L} + \\frac{\\Delta t}{V_i}\\,\\sum_{j\\in\\mathcal{N}(i)} \\phi_{ij}\\,F_{ij}^{A} \\ge \\rho_{\\min}\n$$\nRearranging the inequality to isolate the contribution from the antidiffusive fluxes gives:\n$$\n\\frac{\\Delta t}{V_i}\\,\\sum_{j\\in\\mathcal{N}(i)} \\phi_{ij}\\,F_{ij}^{A} \\ge \\rho_{\\min} - \\rho_i^{L}\n$$\nMultiplying by the control-volume measure $V_i$, which is strictly positive, preserves the inequality:\n$$\n\\Delta t\\,\\sum_{j\\in\\mathcal{N}(i)} \\phi_{ij}\\,F_{ij}^{A} \\ge V_i(\\rho_{\\min} - \\rho_i^{L})\n$$\nThe term $V_i(\\rho_i^L - \\rho_{\\min})$ represents the total \"surplus\" mass in cell $i$ relative to the minimum allowed value, based on the low-order state. Let us define this quantity as $Q_i^{-}$:\n$$\nQ_i^{-} = V_i(\\rho_i^L - \\rho_{\\min})\n$$\nSince $\\rho_i^L \\ge \\rho_{\\min}$, we know that $Q_i^{-} \\ge 0$. This is the maximum amount of mass that can be removed from cell $i$ by the antidiffusive correction without violating the positivity constraint. The inequality can now be written as:\n$$\n\\Delta t\\,\\sum_{j\\in\\mathcal{N}(i)} \\phi_{ij}\\,F_{ij}^{A} \\ge -Q_i^{-}\n$$\nThe sum on the left-hand side represents the net change in mass in cell $i$ due to the limited antidiffusive fluxes. A positive flux $F_{ij}^{A}$ indicates mass flowing into cell $i$ from cell $j$, while a negative flux indicates mass flowing out of cell $i$ into cell $j$. The positivity constraint for cell $i$ is only endangered by fluxes that remove mass from it.\n\nLet us separate the sum into incoming and outgoing fluxes for cell $i$:\n$$\n\\Delta t \\left( \\sum_{j \\in \\mathcal{N}(i), F_{ij}^A > 0} \\phi_{ij} F_{ij}^A + \\sum_{j \\in \\mathcal{N}(i), F_{ij}^A  0} \\phi_{ij} F_{ij}^A \\right) \\ge -Q_i^{-}\n$$\nThe first summation term is always non-negative since $\\phi_{ij} \\ge 0$ and $F_{ij}^A > 0$. These are incoming fluxes that help satisfy the inequality. The most restrictive case for cell $i$ occurs when these incoming fluxes are maximally limited. However, we must construct a local limiter based on local information.\n\nA standard and robust approach, rooted in Flux-Corrected Transport (FCT), is to first determine, for each cell $i$, the maximum fraction of total outgoing antidiffusive flux that can be allowed without violating the local constraint. Let $P_i^{-}$ be the sum of all antidiffusive mass that would flow *out* of cell $i$ if all limiters were unity ($\\phi_{ij} = 1$):\n$$\nP_i^{-} = \\sum_{j \\in \\mathcal{N}(i)} \\max(0, -\\Delta t F_{ij}^A) = \\Delta t \\sum_{j \\in \\mathcal{N}(i)} \\max(0, -F_{ij}^A)\n$$\nNote that $-\\Delta t F_{ij}^A$ is positive when mass flows out of cell $i$. To guarantee positivity in cell $i$, the total limited mass leaving the cell, $\\sum_{j, F_{ij}^A  0} \\phi_{ij} (-\\Delta t F_{ij}^A)$, must not exceed the available mass surplus $Q_i^{-}$. A sufficient condition is to apply a uniform scaling factor, $R_i^{-}$, to all outgoing fluxes from cell $i$ such that $R_i^{-} P_i^{-} \\le Q_i^{-}$. With $R_i^{-} \\in [0,1]$, the most permissive (least diffusive) choice is:\n$$\nR_i^{-} = \\begin{cases} \\min\\left(1, \\frac{Q_i^{-}}{P_i^{-}}\\right)  \\text{if } P_i^{-} > 0 \\\\ 1  \\text{if } P_i^{-} = 0 \\end{cases}\n$$\nIf $P_i^{-} = 0$, no antidiffusive flux leaves cell $i$, so no limitation is needed, hence $R_i^{-}=1$. This expression for $R_i^{-}$ is a cell-centered correction factor for outgoing fluxes. No upper bound is considered, so the corresponding factor for incoming fluxes, $R_i^{+}$, is effectively $1$.\n\nThe problem requires a symmetric, edge-based limiter $\\phi_{ij} = \\phi_{ji}$. The flux $F_{ij}^A$ moves mass across the face between cells $i$ and $j$. If $F_{ij}^A > 0$, mass flows from cell $j$ to cell $i$. Cell $j$ is the donor and cell $i$ is the receiver. The flux must be acceptable to both: it must be limited by the donor's ability to give mass ($R_j^{-}$) and the receiver's capacity to accept it ($R_i^{+}=1$). To satisfy both, we take the minimum: $\\phi_{ij} = \\min(R_j^{-}, R_i^{+}) = R_j^{-}$.\nIf $F_{ij}^A  0$, mass flows from cell $i$ to cell $j$. Cell $i$ is the donor and cell $j$ is the receiver. The limiter must be $\\phi_{ij} = \\min(R_i^{-}, R_j^{+}) = R_i^{-}$.\nIf $F_{ij}^A = 0$, the flux is zero, and the value of $\\phi_{ij}$ is immaterial; we can set it to $1$.\n\nThis definition ensures symmetry. Consider the flux $F_{ji}^A = -F_{ij}^A$. If $F_{ij}^A > 0$, then $F_{ji}^A  0$. Our rule gives $\\phi_{ij} = R_j^{-}$. For the pair $(j,i)$, cell $j$ is the donor for the flux $F_{ji}^A  0$, so the rule gives $\\phi_{ji} = R_j^{-}$. Thus $\\phi_{ij} = \\phi_{ji}$.\n\nWe can now write the final expression for $\\phi_{ij}$ by substituting the definitions of $Q_k^{-}$ and $P_k^{-}$ into the expression for $R_k^{-}$:\n$$\nR_k^{-} = \\min\\left(1, \\frac{V_k (\\rho_k^L - \\rho_{\\min})}{\\Delta t \\sum_{l \\in \\mathcal{N}(k)} \\max(0, -F_{kl}^A)}\\right)\n$$\nIn this combined form, if the denominator is $0$, the fraction is treated as $+\\infty$, and the $\\min$ function correctly evaluates to $1$.\nThe final limiter $\\phi_{ij}$ is thus defined based on the sign of the flux $F_{ij}^A$:\n$$\n\\phi_{ij} = \\begin{cases} R_i^{-}  \\text{if } F_{ij}^A  0 \\\\ R_j^{-}  \\text{if } F_{ij}^A  0 \\\\ 1  \\text{if } F_{ij}^A = 0 \\end{cases}\n$$\nThis constitutes a closed-form, symmetric limiter that guarantees $\\rho_i^{n+1} \\ge \\rho_{\\min}$ for all cells $i$ and is expressed solely in terms of the given quantities.",
            "answer": "$$\n\\boxed{\n\\phi_{ij} = \\begin{cases} \\min\\left(1, \\frac{V_i (\\rho_i^L - \\rho_{\\min})}{\\Delta t \\sum_{l \\in \\mathcal{N}(i)} \\max(0, -F_{il}^A)}\\right)  \\text{if } F_{ij}^A  0 \\\\ \\min\\left(1, \\frac{V_j (\\rho_j^L - \\rho_{\\min})}{\\Delta t \\sum_{l \\in \\mathcal{N}(j)} \\max(0, -F_{jl}^A)}\\right)  \\text{if } F_{ij}^A  0 \\\\ 1  \\text{if } F_{ij}^A = 0 \\end{cases}\n}\n$$"
        }
    ]
}